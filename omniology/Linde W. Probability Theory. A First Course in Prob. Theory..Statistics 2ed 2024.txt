Werner Linde
Probability Theory

Also of Interest
Brownian Motion. A Guide to Random Processes and Stochastic Calculus
René L. Schilling, 2021
ISBN 978-3-11-074125-4, e-ISBN (PDF) 978-3-11-074127-8,
e-ISBN (EPUB) 978-3-11-074149-0
Probability Theory and Statistics with Real World Applications. Univariate and
Multivariate Models Applications
Peter Zörnig, 2024
ISBN 978-3-11-133220-8, e-ISBN (PDF) 978-3-11-133227-7,
e-ISBN (EPUB) 978-3-11-133232-1
Bitcoin: A Game-Theoretic Analysis
Micah Warren, 2023
ISBN 978-3-11-077283-8, e-ISBN (PDF) 978-3-11-077284-5,
e-ISBN (EPUB) 978-3-11-077305-7
Loss Data Analysis. The Maximum Entropy Approach
Henryk Gzyl, Silvia Mayoral, Erika Gomes-Gonçalves, 2023
ISBN 978-3-11-104738-6, e-ISBN (PDF) 978-3-11-104818-5,
e-ISBN (EPUB) 978-3-11-104970-0
Fractional Deterministic and Stochastic Calculus
Giacomo Ascione, Yuliya Mishura, Enrica Pirozzi, 2023
ISBN 978-3-11-077981-3, e-ISBN (PDF) 978-3-11-078001-7,
e-ISBN (EPUB) 978-3-11-078022-2

Werner Linde
Probability Theory
౩
A First Course in Probability Theory and Statistics
2nd edition

Mathematics Subject Classification 2020
Primary: 60-01, 62-01; Secondary: 60A05
Author
Prof. Dr. Werner Linde
Friedrich-Schiller-Universität Jena
Fakultät für Mathematik & Informatik
Institut für Stochastik
D-07737 Jena
Germany
Werner.Linde@mathematik.uni-jena.de
ISBN 978-3-11-132484-5
e-ISBN (PDF) 978-3-11-132506-4
e-ISBN (EPUB) 978-3-11-132517-0
Library of Congress Control Number: 2024931814
Bibliographic information published by the Deutsche Nationalbibliothek
The Deutsche Nationalbibliothek lists this publication in the Deutsche Nationalbibliografie;
detailed bibliographic data are available on the Internet at http://dnb.dnb.de.
© 2024 Walter de Gruyter GmbH, Berlin/Boston
Cover image: Density Diagram created by Werner Linde
Typesetting: VTeX UAB, Lithuania
Printing and binding: CPI books GmbH, Leck
www.degruyter.com

౩
To my wife Karin


Preface
This book is intended as an introductory course for students in mathematics, physical
sciences, engineering, or in other related fields. It is based on the experience of proba-
bility lectures taught during the past 25 years, where the spectrum reached from two-
hour introductory courses, over Measure Theory and advanced probability classes, to
such topics as Stochastic Processes and Mathematical Statistics. Until 2012 these lectures
were delivered to students at the University of Jena (Germany), and since 2013 to those
at the University of Delaware in Newark (USA).
The book is the completely revised version of the German edition “Stochastik für das
Lehramt,” which appeared in 2014 at De Gruyter. At most universities in Germany, there
exist special classes in Probability Theory for students who want to become teachers of
mathematics in high schools. Besides basic facts about Probability Theory, these courses
are also supposed to give an introduction into Mathematical Statistics. Thus, the original
main intention for the German version was to write a book that helps those students
understand Probability Theory better. But soon the book turned out to also be useful as
introduction for students in other fields, e. g., in mathematics, physics, and so on. Thus
we decided, in order to make the book applicable for a broader audience, to provide a
translation in the English language.
During numerous years of teaching, I learned the following:
–
Probabilistic questions are usually easy to formulate, generally have a tight relation
to everyday problems, and therefore attract the interest of the audience. Every stu-
dent knows the phenomena that occur when one rolls a die, plays cards, tosses a
coin, or plays a lottery. Thus, an initial interest in Probability Theory exists.
–
In contrast, after a short time many students have very serious difficulties with un-
derstanding the presented topics. Consequently, a common opinion among students
is that Probability Theory is a very complicated topic, causing a lot of problems and
troubles.
Surely there exist several reasons for the bad image of Probability Theory among stu-
dents. But, as we believe, the most important one is as follows. In Probability Theory, the
type of problems and questions considered, as well as the way of thinking, differs con-
siderably from the problems, questions, and thinking in other fields of mathematics, i. e.,
from fields with which the students became acquainted before attending a probability
course. For example, in Calculus a function has a well-described domain of definition;
mostly it is defined by a concrete formula, has certain properties as continuity, differen-
tiability, and so on. A function is something very concrete which can be made vivid by
drawing its graph. In contrast, in Probability Theory functions are mostly investigated
as random variables. They are defined on a completely unimportant, nonspecified sam-
ple space, and they generally do not possess a concrete formula for their definition. It
may even happen that only the existence of a function (random variable) is known. The
only property of a random variable which really matters is the distribution of its values.
https://doi.org/10.1515/9783111325064-201

VIII
౪
Preface
This and many other similar techniques make the whole theory something mysterious
and not completely comprehensible.
Considering this observation, we organized the book in a way that tries to make
probabilistic problems more understandable and that puts the focus more onto expla-
nations of the definitions, notations, and results. The tools we use to do this are exam-
ples; we present at least one before a new definition, in order to motivate it, followed
by more examples after the definition to make it comprehensible. Here we act upon the
maxim expressed by Einstein’s quote:1
Example isn’t another way to teach, it is the only way to teach.
Presenting the basic results and methods in Probability Theory without using results,
facts, and notations from Measure Theory is, in our opinion, as difficult as to square the
circle. Either one restricts oneself to discrete probability measures and random vari-
ables or one has to be imprecise. There is no other choice! In some places, it is possible
to avoid the use of measure-theoretic facts, such as the Lebesgue integral, or the exis-
tence of infinite product measures, and so on, but the price is high.2 Of course, I also
struggled with the problem of missing facts from Measure Theory while writing this
book. Therefore, I tried to include some ideas and results about σ-fields, measures, and
integrals, hoping that a few readers become interested and want to learn more about
Measure Theory. For those, we refer to the books [Coh13, Dud02], or [Bil12] as good
sources.
In this context, let us make some remark about the verification of the presented re-
sults. Whenever it was possible, we tried to prove the stated results. Times have changed;
when I was a student, every theorem presented in a mathematical lecture was proved –
really every one. Facts and results without proof were doubtful and soon forgotten. And
a tricky and elegant proof is sometimes more impressive than the proven result (at least
to us). Hopefully, some readers will like some of the proofs in this book as much as we
did.
One of most used applications of Probability Theory is Mathematical Statistics.
When I met former students of mine, I often asked them which kind of mathematics
they are mainly using now in their daily work. The overwhelming majority of them
answered that one of their main fields of mathematical work is statistical problems.
Therefore, we decided to include an introductory chapter about Mathematical Statis-
tics. Nowadays, due to the existence of good and fast statistical programs, it is very
easy to analyze data, to evaluate confidence regions, or to test a given hypothesis. But
1 See http://www.alberteinsteinsite.com/quotes/einsteinquotes.html
2 For example, several years ago, to avoid the use of the Lebesgue integral, I introduced the expected
value of a random variable as a Riemann integral via its distribution function. This is mathematically
correct, but at the end almost no students understood what the expected value really is. Try to prove that
the expected value is linear using this approach!

Preface
౪
IX
do those who use these programs also always know what they are doing? Since we
doubt that this is so, we stressed the focus in this chapter to the question of why the
main statistical methods work and on what mathematical background they rest. We
also investigate how precise statistical decisions are and what kinds of errors may
occur.
The organization of this book differs a little bit from those in many other first-course
books about Probability Theory. Having Measure Theory in the back of our minds causes
us to think that probability measures are the most important ingredient of Probability
Theory; random variables come in second. On the contrary, many other authors go ex-
actly the other way. They start with random variables, and probability measures then
occur as their distribution on their range spaces (mostly ℝ). In this case, a standard
normal probability measure does not exist, only a standard normal distributed random
variable. Both approaches have their advantages and disadvantages, but as we said, for
us the probability measures are interesting in their own right, and therefore we start
with them in Chapter 1, followed by random variables in Section 3.
The book also contains some facts and results that are more advanced and usu-
ally not part of an introductory course in Probability Theory. Such topics are, for exam-
ple, the investigation of product measures, order statistics, and so on. We have assigned
those more involved sections with a star. They may be skipped at a first reading without
loss in the following chapters.
At the end of each chapter, one finds a collection of some problems related to the
contents of the section. Here we restricted ourselves to a few problems in the actual task;
the solutions of these problems are helpful to the understanding of the presented topics.
The problems are mainly taken from our collection of homeworks and exams during the
past years. For those who want to work with more problems we refer to many books,
e. g., [GS01, Gha19, Pao06], or [Rss14], which contain a huge collection of probabilistic
problems, ranging from easy to difficult, from natural to artificial, from interesting to
boring.
Finally, I want to express my thanks to those who supported my work at the trans-
lation and revision of the present book. Many students at the University of Delaware
helped me improve my English and correct wrong phrases and expressions. To men-
tion all of them is impossible. But among them were a few students who read whole
chapters and, without them, the book would have never been finished (or readable).
In particular, I want to mention Emily Wagner and Spencer Walker. They both really
did a great job. Many thanks! Let me also express my gratitude to Colleen McInerney,
Rachel Austin, Daniel Atadan, and Quentin Dubroff, all students in Delaware and at-
tending my classes for some time. They also read whole sections of the book and cor-
rected my broken English. Finally, my thanks go to Professor Anne Leucht from the
Technical University in Braunschweig (Germany); her field of work is Mathematical
Statistics, and her hints and remarks about Chapter 8 in this book were important to
me.

X
౪
Preface
And last but not least, I want to thank the Department of Mathematical Sciences at
the University of Delaware for the excellent working conditions after my retirement in
Germany.
Newark, Delaware, June 6, 2016
Werner Linde
Changes in the second edition: The first edition of my textbook was well received by
scholars and students alike, and I would like to thank all of them for their comments
and positive criticisms.
There are a few changes to the second edition. For instance, I added more than 40
new examples, so that now the book contains about 280 of them. Among the new ones
are some classical examples as, e. g., the “Boy or Girl Paradox,” the “Secretary Problem,”
the “Two-Envelope Paradox,” or “Gambler’s Ruin,” which may be found in Sections 5.4
or 5.5, respectively. Other examples have been included for better understanding of the
general, sometimes quite abstract, topics.
Section 8 about Mathematical Statistics contains now three tables which summarize
the main tests and confidence regions for normal distributed populations. I hope that
these résumés help to get a quick overview about the most used techniques in Math-
ematical Statistics. Furthermore, there is a new Section 8.6.4 about confidence regions
for hypergeometric distributed samples, an important topic missing in the first edition.
A completely new ingredient in this edition are short summaries at the end of almost
every section. Here I give a compressed overview about basic notions and results pre-
sented in the preceding section. The aim of these abstracts is to tell the reader what were
the most important statements and what can possibly be omitted from the first reading.
I believe that graphical presentations of abstract mathematical statements are a
very helpful aid for better understanding, not only for beginners. Therefore, I added
more than 80 new figures, so that now the book contains more than 100 of them. The
increase is mainly due to the fact that there exist now powerful tools as, e. g., TikZ for
drawing convincing figures, tools which either did not yet exist or which I was not aware
of when writing the first edition.
Besides I added several new problems, updated the list of references, and completed
it by adding a few classical books about Measure Theory and Probability as, for example,
[Hal14, Kal21] or [Par05].
Some minor misprints or incorrect arguments have been eliminated, a few parts
were rewritten in order to make them, as I hope, clearer and better understandable.
Finally, I would like to thank my former student Frank Aurzada, TU Darmstadt, for
the fruitful discussions about some newly added examples. Last but not least, I want to
express my gratitude to Nadja Schedensack from De Gruyter for her advice and helpful
remarks concerning layout and TEX problems.
Jena, Germany, January 8, 2024
Werner Linde

Contents
Preface ౩VII
1
Probabilities ౩1
1.1
Probability spaces ౩1
1.1.1
Sample spaces ౩1
1.1.2
σ-fields of events∗౩3
1.1.3
Probability measures ౩6
1.2
Basic properties of probability measures ౩10
1.3
Discrete probability measures ౩15
1.4
Special discrete probability measures ౩20
1.4.1
Dirac measure ౩20
1.4.2
Uniform distribution on a finite set ౩21
1.4.3
Binomial distribution ౩27
1.4.4
Multinomial distribution ౩30
1.4.5
Poisson distribution ౩34
1.4.6
Hypergeometric distribution ౩36
1.4.7
Geometric distribution ౩41
1.4.8
Negative binomial distribution ౩43
1.5
Continuous probability measures ౩48
1.6
Special continuous distributions ౩52
1.6.1
Uniform distribution on an interval ౩52
1.6.2
Normal distribution ౩55
1.6.3
Gamma distribution ౩58
1.6.4
Exponential distribution ౩61
1.6.5
Erlang distribution ౩63
1.6.6
Chi-squared distribution ౩64
1.6.7
Beta distribution ౩65
1.6.8
Cauchy distribution ౩68
1.7
Distribution function ౩69
1.8
Multivariate continuous distributions ౩81
1.8.1
Multivariate density functions ౩81
1.8.2
Multivariate uniform distribution ౩83
1.9
Products of probability spaces∗౩90
1.9.1
Product σ-fields and measures ౩90
1.9.2
Product measures: discrete case ౩95
1.9.3
Product measures: continuous case ౩99
1.10
Problems ౩103
2
Conditional probabilities and independence ౩111
2.1
Conditional probabilities ౩111

XII
౪
Contents
2.2
Independence of events ౩120
2.3
Problems ౩127
3
Random variables and their distribution ౩131
3.1
Transformation of random values ౩131
3.2
Probability distribution of a random variable ౩133
3.3
Special random variables ౩143
3.4
Random vectors ౩145
3.5
Joint and marginal distributions ౩147
3.5.1
Marginal distributions: discrete case ౩149
3.5.2
Marginal distributions: continuous case ౩154
3.6
Independence of random variables ౩157
3.6.1
Independence of discrete random variables ౩161
3.6.2
Independence of continuous random variables ౩165
3.7
Order statistics∗౩169
3.8
Problems ౩176
4
Operations on random variables ౩180
4.1
Mappings of random variables ౩180
4.2
Linear transformations ౩185
4.3
Coin tossing versus uniform distribution ౩189
4.3.1
Binary fractions ౩189
4.3.2
Binary fractions of random numbers ౩191
4.3.3
Random numbers generated by coin tossing ౩193
4.4
Simulation of random variables ౩196
4.5
Addition of random variables ౩202
4.5.1
Sums of discrete random variables ౩204
4.5.2
Sums of continuous random variables ౩207
4.6
Sums of certain random variables ౩210
4.7
Products and quotients of random variables ౩222
4.7.1
Student’s t-distribution ౩226
4.7.2
F-distribution ౩228
4.8
Problems ౩231
5
Expected value, variance, and covariance ౩235
5.1
Expected value ౩235
5.1.1
Expected value of discrete random variables ౩235
5.1.2
Expected value of certain discrete random variables ౩238
5.1.3
Expected value of continuous random variables ౩242
5.1.4
Expected value of certain continuous random variables ౩245
5.1.5
Properties of the expected value ౩249
5.2
Variance ౩257

Contents
౪
XIII
5.2.1
Higher moments of random variables ౩257
5.2.2
Variance of random variables ౩261
5.2.3
Variance of certain random variables ౩263
5.3
Covariance and correlation ౩269
5.3.1
Covariance ౩269
5.3.2
Correlation coefficient ౩276
5.4
Some paradoxes and examples ౩279
5.4.1
Boy or girl paradox ౩279
5.4.2
Randomly chosen entries ౩282
5.4.3
Secretary problem ౩283
5.4.4
Two-envelope paradox ౩287
5.5
Gambler’s ruin ౩293
5.6
Problems ౩304
6
Normally distributed random vectors ౩310
6.1
Representation and density ౩310
6.2
Expected value and covariance matrix ౩318
6.3
Problems ౩324
7
Limit theorems ౩327
7.1
Laws of large numbers ౩327
7.1.1
Chebyshev’s inequality ౩327
7.1.2
Infinite sequences of independent random variables∗౩330
7.1.3
Borel–Cantelli lemma∗౩333
7.1.4
Weak law of large numbers ౩340
7.1.5
Strong law of large numbers ౩341
7.2
Central limit theorem ౩347
7.3
Problems ౩367
8
Mathematical statistics ౩370
8.1
Statistical models ౩370
8.1.1
Nonparametric statistical models ౩370
8.1.2
Parametric statistical models ౩374
8.2
Statistical hypothesis testing ౩376
8.2.1
Hypotheses and tests ౩376
8.2.2
Power function and significance tests ౩379
8.3
Tests for binomial distributed populations ౩386
8.4
Tests for normally distributed populations ౩391
8.4.1
Fisher’s theorem ౩392
8.4.2
Quantiles ౩395
8.4.3
Z-tests or Gauss tests ౩400
8.4.4
t-tests ౩404

XIV
౪
Contents
8.4.5
χ2-tests for the variance ౩406
8.4.6
Two-sample Z-tests ౩408
8.4.7
Two-sample t-tests ౩410
8.4.8
F-tests ౩412
8.5
Point estimators ౩414
8.5.1
Maximum likelihood estimation ౩416
8.5.2
Unbiased estimators ౩423
8.5.3
Risk function ౩427
8.6
Confidence regions and intervals ౩432
8.6.1
Construction of confidence regions ౩432
8.6.2
Normally distributed samples ౩435
8.6.3
Binomial distributed populations ౩438
8.6.4
Hypergeometric distributed populations ౩444
8.7
Problems ౩447
A
Appendix ౩451
A.1
Notations ౩451
A.2
Elements of set theory ౩451
A.2.1
Set operations ౩451
A.2.2
Preimages of sets ౩454
A.2.3
Problems ౩455
A.3
Combinatorics ౩456
A.3.1
Binomial coefficients ౩456
A.3.2
Drawing balls out of an urn ౩461
A.3.3
Multinomial coefficients ౩465
A.3.4
Problems ౩467
A.4
Vectors and matrices ౩468
A.5
Some analytic tools ౩472
Bibliography ౩479
Index ౩481

1 Probabilities
1.1 Probability spaces
The basic concern of Probability Theory is to model experiments involving randomness,
that is, experiments with nondetermined outcome, shortly called random experiments.
The Russian mathematician A. N. Kolmogorov established the modern Probability The-
ory in 1933 by publishing his book (cf. [Kol33]) Grundbegriffe der Wahrscheinlichkeit-
srechnung. In it, he postulated the following:
Random experiments are described by probability spaces (Ω, 𝒜, ℙ).
The triple (Ω, 𝒜, ℙ) comprises a sample space Ω, a σ-field 𝒜of events, and a mapping ℙ
from 𝒜to [0, 1], called probability measure or probability distribution.
Let us now explain the three different components of a probability space in detail.
We start with the sample space.
1.1.1 Sample spaces
Definition 1.1.1. The sample space Ω is a nonempty set that contains (at least) all possible outcomes of
the random experiment.
Remark 1.1.2. Due to mathematical reasons, sometimes it can be useful to choose Ω
larger than necessary. It is only important that the sample space contains all possible
results.
Example 1.1.3. When rolling a die one time, the natural choice for the sample space is
Ω = {1, . . . , 6}. However, it would also be possible to take Ω = {1, 2, . . . } or even Ω = ℝ. In
contrast, Ω = {1, . . . , 5} is not suitable for the description of the experiment.
Example 1.1.4. Roll a die until the number “6” shows up for the first time. Record the
number of necessary rolls until the first appearance of “6”. The suitable sample space in
this case is Ω = {1, 2, . . .}. Any finite set {1, 2, . . . , N} is not appropriate because, even if we
choose N very large, we can never be 100 % sure that the first “6” really appears during
the first N rolls.
Example 1.1.5. Suppose in a lottery 6 numbers out of 49 are chosen. If we record the 6
numbers in the way they are chosen, then a suitable sample space is
Ω = {(ω1, . . . , ω6) : 1 ≤ωi ≤49 , ωi
̸= ωj, i
̸= j} .
https://doi.org/10.1515/9783111325064-001

2
౪
1 Probabilities
But, in general, the chosen numbers are published ordered by their size. If this is so, as
corresponding sample space we may choose
Ω = {(ω1, . . . , ω6) : 1 ≤ω1 < ⋅⋅⋅< ω6 ≤49} .
Example 1.1.6. Say we have three urns, each containing white and black balls. Choose
one urn at random and take out a ball. Register if the chosen ball is white or black. Letting
Ω = {w, b} as sample space is not appropriate. It does not take into account which urn
we had chosen. One suitable sample space would be Ω = {(w, i), (b, i), i = 1, 2, 3}. Then,
for instance, (w, 1) occurs if we choose urn 1, take out a ball of this urn, and the chosen
ball is a white one.
Example 1.1.7. A light bulb is switched on at time zero and burns for a certain period
of time. At some random time t > 0, it burns out. To describe this experiment, we have
to take into account all possible times t > 0. Therefore, a natural choice for the sample
space in this case is Ω = (0, ∞), or, if we do not exclude that the bulb is defective from
the very beginning, then Ω = [0, ∞).
Example 1.1.8. Customers arrive at the counter of a bank at certain random times. So,
for example, the first customer shows up at time t1, the second at time t2 > t1, and so
on. Then the sample space consists of infinite sequences t1 < t2 < ⋅⋅⋅of positive real
numbers assuming hat at least one customer enters the bank that day. But, in fact, be-
cause the number of customers per day is finite, one may also choose
Ω = {(t1, . . . , tn) : 0 < t1 < ⋅⋅⋅< tn, n ∈ℕ} ∪{0},
where {0} occurs if no customer arrives at that day.
Subsets of the sample space Ω are called events. In other words, the powerset 𝒫(Ω)
is the collection of all possible events. For example, when we roll a die once there are
exactly 26 = 64 possible events, as, for example,
0, {1}, . . . , {6}, {1, 2}, . . . , {1, 6}, {2, 3}, . . . , {2, 6}, . . . , {1, 2, 3, 4, 5}, Ω .
Among all events, there are some of special interest, the so-called elementary events.
These are events containing exactly one element. In Example 1.1.3, the elementary events
are
{1}, {2}, {3}, {4}, {5}, and {6} .
Remark 1.1.9. Never confuse the elementary events with the points that they contain.
Look at Example 1.1.3. There we have 6 ∈Ω and for the generated elementary event
holds {6} ∈𝒫(Ω).
Let A ⊆Ω be an event. After executing the random experiment, one observes a
result ω ∈Ω. Then two cases are possible:

1.1 Probability spaces
౪
3
1.
The outcome ω belongs to A. In this case, we say that the event A occurred.
2.
If ω is not in A, that is, if ω ∈Ac, then the event A did not occur.
Example 1.1.10. Roll a die once and let A = {2, 4}. Say the outcome was number “6”.
Then A did not occur. But, if we obtained number “2,” then A occurred.
Example 1.1.11. Suppose we roll a die twice. The describing sample space consists of all
36 pairs of numbers from 1 to 6. If
A = {(1, 1), . . . , (6, 6)} ,
then A occurs if and only if the outcome of the first roll equals the that of the second roll.
Example 1.1.12. In Example 1.1.7, the occurrence of an event A = [T, ∞) tells us that the
light bulb burned out after time T or, in other words, at time T it was still shining.
Let us formulate some easy rules for the occurrence of events.
1.
By the choice of the sample space, the event Ω always occurs. Therefore, Ω is also
called the certain event.
2.
The empty set never occurs. Thus it is called the impossible event.
3.
An event A occurs if and only if the complementary event Ac does not, and vice
versa, A does not occur if and only if Ac does.
4.
If A and B are two events, then A ∪B occurs if at least one of the two events occurs.
Hereby we do not exclude that A and B may both occur.
5.
The event A ∩B occurs if and only if A and B both occur.
1.1.2 σ-fields of events∗
The basic aim of Probability Theory is to assign to each event A a number ℙ(A) in [0, 1],
which describes the likelihood of its occurrence. If the occurrence of an event A is very
likely, then ℙ(A) should be close to 1 while ℙ(A) close to zero suggests that the appear-
ance of A is very unlikely.1 The mapping A 󳨃→ℙ(A) must possess certain natural prop-
erties. Unfortunately, by mathematical reason it is not always possible to assign to each
event A a number ℙ(A) such that A 󳨃→ℙ(A) has the desired properties. The solution is
ingenious and one of the key observations in Kolmogorov’s approach: one chooses a sub-
set 𝒜⊆𝒫(Ω) such that ℙ(A) is only defined for A ∈𝒜. If A ∉𝒜, then ℙ(A) does not exist.
Of course, 𝒜should be chosen as large as possible and, moreover, at least “ordinary”
sets should belong to 𝒜.
1 If the weather forecast predicts a 70 % chance of rain, you will surely take your umbrella with you. On
the contrary, if the forecast is only 20 %, you will probably not do so. Why? In this case the probability
of the occurrence of the event A, “it rains,” is significantly less likely.

4
౪
1 Probabilities
In the case of “large” sample spaces, it is in general impossible to assign to each event a meaningful likelihood
of its occurrence. Consequently, for “large” sample spaces, as, for example, ℝor ℝn, the probability ℙ(A) is
defined only for certain special events A.
The collection 𝒜of events for which ℙ(A) is well defined has to satisfy some algebraic
conditions. More precisely, the following properties are supposed.
Definition 1.1.13. A collection 𝒜of subsets of Ω is called a σ-field if
(1)
0 ∈𝒜,
(2)
if A ∈𝒜then Ac ∈𝒜, and
(3)
for countably many A1, A2, . . . in 𝒜, it follows that ⋃∞
j=1 Aj ∈𝒜.
Let us verify some easy properties of σ-fields.
Proposition 1.1.14. Let 𝒜be a σ-field of subsets of Ω. Then the following are valid:
(i)
Ω ∈𝒜.
(ii) If A1, A2, . . . , An are finitely many sets in 𝒜, then ⋃n
j=1 Aj ∈𝒜.
(iii) If A1, A2, . . . belong to 𝒜, then so does ⋂∞
j=1 Aj.
(iv) Whenever A1, . . . , An ∈𝒜, then ⋂n
j=1 Aj ∈𝒜.
Proof. Assertion (i) is a direct consequence of 0 ∈𝒜combined with property (2) of
σ-fields.
To verify (ii), let A1, . . . , An be in 𝒜. Set An+1 = An+2 = ⋅⋅⋅= 0. Then for all j = 1, 2, . . . ,
we have Aj ∈𝒜and, by property (3) of σ-fields, also ⋃∞
j=1 Aj ∈𝒜. But note that we have
⋃∞
j=1 Aj = ⋃n
j=1 Aj, hence (ii) is valid.
To prove (iii), we first observe that Aj ∈𝒜yields Ac
j ∈𝒜, hence ⋃∞
j=1 Ac
j ∈𝒜. Another
application of (2) implies (⋃∞
j=1 Ac
j )c ∈𝒜. De Morgan’s rule asserts
(
∞
⋃
j=1
Ac
j )
c
=
∞
⋂
j=1
Aj,
which completes the proof of (iii).
Assertion (iv) may be derived from an application of (ii) to the complementary sets,
as we did in the proof of (iii). Or one can use the method in the proof of (ii), but this time
we choose An+1 = An+2 = ⋅⋅⋅= Ω.
Corollary 1.1.15. If sets A and B belong to a σ-field 𝒜, then so do A ∪B, A ∩B, A \ B, and
AΔB.
The easiest examples of σ-fields are either 𝒜= {0, Ω} or 𝒜= 𝒫(Ω). However, the
former σ-field is much too small for applications while the latter is generally too big,
at least if the sample space is uncountably infinite. We will shortly indicate how one
constructs suitable σ-fields in the case of “large” sample spaces as, for example, ℝor ℝn.

1.1 Probability spaces
౪
5
Proposition 1.1.16. Let 𝒞be an arbitrary nonempty collection of subsets of Ω. Then there
is a σ-field 𝒜possessing the following properties:
1.
It holds that 𝒞⊆𝒜or, verbally, each set C ∈𝒞belongs to the σ-field 𝒜.
2.
The σ-field 𝒜is the smallest one possessing this property. That is, whenever 𝒜′ is
another σ-field with 𝒞⊆𝒜′, then 𝒜⊆𝒜′.
Proof. Let Φ be the collection of all σ-fields 𝒜′ on Ω for which 𝒞⊆𝒜′, that is,
Φ := {𝒜′ ⊆𝒫(Ω) : 𝒞⊆𝒜′ , 𝒜′ is a σ-field} .
The collection Φ is nonempty because it contains at least one element, namely the pow-
erset of Ω. Of course, 𝒫(Ω) is a σ-field and 𝒞⊆𝒫(Ω) trivially, hence 𝒫(Ω) ∈Φ.
Next define 𝒜by
𝒜:= ⋂
𝒜′∈Φ
𝒜′ = {A ⊆Ω : A ∈𝒜′ , ∀𝒜′ ∈Φ} .
It is not difficult to prove that 𝒜is a σ-field with 𝒞⊆𝒜. Indeed, if C ∈𝒞, then C ∈𝒜′ for
all 𝒜′ ∈Φ, hence, by construction of 𝒜, we get C ∈𝒜.
Furthermore, 𝒜is also the smallest σ-field containing 𝒞. To see this, take an arbi-
trary σ-field
̃
𝒜containing 𝒞. Then
̃
𝒜∈Φ, which implies 𝒜⊆
̃
𝒜because 𝒜is the inter-
section over all σ-fields in Φ. This completes the proof.
Definition 1.1.17. Let 𝒞be an arbitrary nonempty collection of subsets of Ω. The smallest σ-field con-
taining 𝒞is called the σ-field generated by 𝒞. It is denoted by σ(𝒞).
Remark 1.1.18. The σ-field σ(𝒞) is characterized by the three following properties:
1.
σ(𝒞) is a σ-field.
2.
𝒞⊆σ(𝒞).
3.
If 𝒞⊆𝒜′ for some σ-field 𝒜′, then σ(𝒞) ⊆𝒜′.
Example 1.1.19. Let Ω be an arbitrary nonempty set. If 𝒞= {C1, . . . , Cn} where
Ci ∩Cj = 0
if i
̸= j
and
n
⋃
j=1
Cj = Ω ,
then σ(𝒞) consists of the empty set and any finite unions of the Cjs.
For example, if Ω = {1, . . . , 6} and C1 = {1, 2}, C2 = {3}, and C3 = {4, 5, 6}, then the
elements of the generated σ-field are the empty set 0 and C1, C2, C3, C1 ∪C2, C1 ∪C3,
C2 ∪C3, and Ω.

6
౪
1 Probabilities
Definition 1.1.20. Let 𝒞⊆𝒫(ℝ) be the collection of all finite closed intervals in ℝ, that is,
𝒞= {[a, b] : a < b , a, b ∈ℝ} .
The σ-field generated by 𝒞is denoted by ℬ(ℝ) and is called the Borel σ-field. If B ∈ℬ(ℝ), then it is said
to be a Borel set.
Remark 1.1.21. By construction, every closed interval in ℝis a Borel set. Furthermore,
the properties of σ-fields also imply that complements of such intervals, their countable
unions, and intersections are Borel sets. One might believe that all subsets of ℝare Borel
sets. This is not the case; for the construction of a non-Borel set, we refer to [Gha19,
Example 1.21] or [Dud02, pages 105–108].
Remark 1.1.22. There exist many other systems of subsets in ℝgenerating ℬ(ℝ). Let us
only mention two of them:
𝒞1 = {(−∞, b] : b ∈ℝ}
or
𝒞2 = {(a, ∞) : a ∈ℝ} .
Summary: There is a σ-field of subsets in ℝ(also in ℝn, as we will see later on), the collection of Borel sets,
for which we may always define their probability of occurrence. All sets of interest are Borel sets. Thus, in
fact, knowing probabilities only for those sets is necessary from a mathematical point of view, but for our
purposes this is only a theoretical restriction.
1.1.3 Probability measures
The occurrence of an event in a random experiment is not completely haphazard. Al-
though we are not able to predict the outcome of the next trial, the occurrence or nonoc-
currence of an event follows certain rules. Some events are more likely to occur, others
less. The degree of likelihood of an event A is described by a number ℙ(A), called the
probability of the occurrence of A (in short, probability of A). The most common scale
for probabilities is 0 ≤ℙ(A) ≤1, where the larger ℙ(A), the more likely A is to occur.
One could also think of other scales as 0 ≤ℙ(A) ≤100. In fact, this is even quite often
used; in this sense, a chance of 50 % equals a probability of 1/2.
What does it mean that an event A has probability ℙ(A)? For example, what does it
tell us that an event occurs with probability 1/2? Does this mean a half-occurrence of A?
Surely not.
To answer this question, we have to assume that we execute an experiment not
only once2 but several, say n, times. Thereby we have to ensure that the conditions of
2 It does not make sense to speak of the probability of an event that can be executed only once. For
example, it is (mathematically) absurd to ask for the probability that the Eiffel Tower will be in Paris for
yet another 100 years.

1.1 Probability spaces
౪
7
the experiment do not change and that the single results do not depend on each other.
Let
an(A) := Number of trials where A occurs.
The quantity an(A) is called the absolute frequency of the occurrence of A in n trials.
Observe that an(A) is a random number with 0 ≤an(A) ≤n. Next we set
rn(A) := an(A)
n
(1.1)
and name it the relative frequency of the occurrence of A in n trials. This number is
random as well, but now 0 ≤rn(A) ≤1.
Example 1.1.23. At www.westlotto.de/lotto-6aus49 one finds a summary of the 6223
drawings in the German lottery between 10/09/1955 and 06/21/2023. Every time there
were 6 numbers chosen out of 49. To describe the experiment, we take as sample space
Ω = {A ⊂{1, . . . , 49} : |A| = 6} .
Then we get |Ω| = (49
6 ). Given 1 ≤j ≤49, define the event 𝒮j as
𝒮j = {A ∈Ω : j ∈A}.
That is, 𝒮j occurs provided that the number j was among the chosen ones. Since
|𝒮j| = (48
5 ), we obtain
ℙ(𝒮j) =
(48
5 )
(49
6 ) = 6
49 ≈0.1224 .
In the above cited summary, one finds the absolute frequency of all events 𝒮j with
j = 1, . . . , 49. For example, the frequencies 𝒮6, 𝒮20, and 𝒮45 equal 825, 719, and 699, re-
spectively. That is, during the past n = 6223 drawings, the numbers 6, 20, and 45 appeared
825, 719, and 699 times, respectively. Thus, their relative frequencies are
rn(𝒮6) = 825
6223 ≈0.1326 ,
rn(𝒮20) = 719
6223 ≈0.1155,
and
rn(𝒮45) = 699
6223 ≈0.1123 .
One should compare these relative frequencies with the expected one (assumed that all
numbers are equally likely), given by
ℙ(𝒮j) = 6
49 = 0.1224 ,
j = 1, . . . , 49 .

8
౪
1 Probabilities
It is somehow intuitively clear3 that the relative frequencies of an event A converge
to a (nonrandom) number as n →∞. And this limit is exactly the desired probability
of the occurrence of the event A. Let us express this in a different way: say we execute
an experiment n times for some large n. Then, on average, we will observe n ⋅ℙ(A)
occurrences of A. For example, when rolling a fair die many times, an even number will
happen in approximately half the cases.
Or, in the setting of Example 1.1.23, on average each number from 1 to 49 should
approximately show up 6223⋅6
49 = 762 times. Thus, the observed frequencies tell us that
either the drawings were not fair (some numbers are more likely than others) or that
the number n = 6223 of drawings is still too small.
Which natural properties of A 󳨃→ℙ(A) may be deduced from rn(A) →
n→∞ℙ(A)?
1.
Since 0 ≤rn(A) ≤1, we conclude 0 ≤ℙ(A) ≤1.
2.
Because of rn(Ω) = 1 for each n ≥1, we get ℙ(Ω) = 1.
3.
The property rn(0) = 0 yields ℙ(0) = 0.
4.
Let A and B be two disjoint events. Then rn(A ∪B) = rn(A) + rn(B), hence the limits
should satisfy a similar relation, that is,
ℙ(A ∪B) = ℙ(A) + ℙ(B) .
(1.2)
Definition 1.1.24. A mapping ℙfulfilling eq. (1.2) for disjoint A and B is called finitely additive.
Remark 1.1.25. Applying eq. (1.2) successively leads to the following. If A1, . . . , An are
disjoint, then
ℙ(
n
⋃
j=1
Aj) =
n
∑
j=1
ℙ(Aj) .
Finite additivity is a very useful property of probabilities, and in the case of finite
sample spaces, it completely suffices to build a fruitful theory. But as soon as the sample
space is infinite, it is too weak. To see this, let us come back to Example 1.1.4. Assume we
want to evaluate the probability of the event A = {2, 4, 6, . . .}, that is, the first “6” appears
in an even number of trials. Then we have to split A into (infinitely) many disjoint events
{2}, {4}, . . . The finite additivity of ℙdoes not suffice to get ℙ(A) = ℙ({2}) + ℙ({4}) + ⋅⋅⋅. In
order to evaluate ℙ(A) in this way, we need the following stronger property of ℙ.
Definition 1.1.26. A mapping ℙis said to be σ-additive provided that for countably many disjoint
A1, A2, . . . in Ω we get
ℙ(
∞
⋃
j=1
Aj) =
∞
∑
j=1
ℙ(Aj).
3 We will discuss this question more precisely in Section 7.1.

1.1 Probability spaces
౪
9
Let us summarize what we have until now: a mapping ℙassigning each event its prob-
ability should possess the following natural properties:
1.
For all A, one has 0 ≤ℙ(A) ≤1.
2.
We have ℙ(0) = 0 and ℙ(Ω) = 1.
3.
The mapping ℙis σ-additive.
Thus, given a sample space Ω, we look for a function ℙdefined on 𝒫(Ω) satisfying the
previous properties. But, as already mentioned, if Ω is uncountable, for example, if Ω =
ℝ, then only very special4 ℙwith these properties exist.
To overcome these difficulties, in such cases we have to restrict ℙto a σ-field 𝒜⊆
𝒫(Ω).
Definition 1.1.27. LetΩbeasamplespaceandlet𝒜beaσ-fieldofsubsetsofΩ.Afunctionℙ: 𝒜→[0, 1]
is called a probability measure or probability distribution on (Ω, 𝒜) if
1.
ℙ(0) = 0 and ℙ(Ω) = 1.
2.
ℙis σ-additive, that is, for each sequence of disjoint sets Aj ∈𝒜, j = 1, 2, . . . , it follows that
ℙ(
∞
⋃
j=1
Aj) =
∞
∑
j=1
ℙ(Aj) .
(1.3)
Remark 1.1.28. Note that the left-hand side of eq. (1.3) is well defined. Indeed, since 𝒜
is a σ-field, Aj ∈𝒜implies ⋃∞
j=1 Aj ∈𝒜as well.
Now we are in a position to define probability spaces in the exact way.
Definition 1.1.29. A probability space is a triple (Ω, 𝒜, ℙ), where Ω is a sample space, 𝒜denotes a
σ-field consisting of subsets of Ω, and ℙ: 𝒜→[0, 1] is a probability measure.
Remark 1.1.30. Given A ∈𝒜, the number ℙ(A) describes its probability or, more pre-
cisely, its probability of occurrence. Subsets A of Ω with A ∉𝒜do not possess a proba-
bility.
Let us demonstrate a simple example on how to construct a probability space for a
given random experiment. Several other examples will follow soon.
Example 1.1.31. We ask for a probability space that describes rolling a fair die once. Of
course, Ω = {1, . . . , 6} and 𝒜= 𝒫(Ω). The mapping ℙ: 𝒫(Ω) →[0, 1] is given by
ℙ(A) = |A|
6 ,
A ⊆{1, . . . , 6} .
Recall that |A| denotes the cardinality of the set A.
4 Discrete ones as we will investigate in Section 1.3.

10
౪
1 Probabilities
Remark 1.1.32. Suppose we want to find a model for some concrete random experi-
ment. How do we do this? In most cases, the sample space is immediately determined
by the results we expect. If the question about Ω is settled, the choice of the σ-field de-
pends on the size of the sample space. If Ω is finite or countably finite, then we may
choose 𝒜= 𝒫(Ω). If Ω = ℝor even ℝn, we take the corresponding Borel σ-fields. The
challenging task is the determination of the probability measure ℙ. Here the following
approaches are possible:
1.
Theoretical considerations quite often lead to the determination of ℙ. For example,
since the faces of a fair die are all equally likely, this already describes ℙcompletely.
Similar arguments can be used for certain games or also for lotteries.
2.
If theoretical considerations are neither possible nor available then statistically
investigations may help. This approach is based on the fact that the relative fre-
quencies rn(A) converge to ℙ(A). Thus, one executes n trials of the experiment and
records the relative frequency of the occurrence of A. For example, one may ques-
tion n randomly chosen persons or do n independent measurements of the same
item. Then rn(A) may be used to approximate the value of ℙ(A).
3.
Sometimes also subjective or experience-based approaches can be used to find ap-
proximate probabilities. These may be erroneous, but they might give some hint for
the correct distribution. For example, if a new product is on the market, the distri-
bution of its lifetime is not yet known. At the beginning one uses data of an already
existing similar product. After some time, data about the new product become avail-
able, the probabilities can be determined more accurately.
Summary: A probability space (Ω, 𝒜, ℙ) is a triple where Ω is a nonempty set, called sample space, 𝒜de-
notes a σ-field of subsets of Ω, and, finally, ℙ: 𝒜→[0, 1] is a probability measure (or probability distri-
bution). The probability measure ℙpossesses the following properties: it is normalized so that ℙ(0) = 0
and ℙ(Ω) = 1, and it is σ-additive. Given an event A ∈𝒜, the number ℙ(A) describes the likelihood of its
occurrence.
1.2 Basic properties of probability measures
Probability measures obey many useful properties. Let us summarize the most impor-
tant ones in the next proposition.
Proposition 1.2.1. Let (Ω, 𝒜, ℙ) be a probability space. Then the following are valid:
(1) The measure ℙis also finitely additive.
(2) If A, B ∈𝒜satisfy A ⊆B, then ℙ(B \ A) = ℙ(B) −ℙ(A).
(3) We have ℙ(Ac) = 1 −ℙ(A) for A ∈𝒜.
(4) Probability measures are monotone, that is, if A ⊆B for some A, B ∈𝒜, then
ℙ(A) ≤ℙ(B).

1.2 Basic properties of probability measures
౪
11
(5) Probability measures are subadditive, that is, for all (not necessarily disjoint)
events5 Aj ∈𝒜,
ℙ(
∞
⋃
j=1
Aj) ≤
∞
∑
j=1
ℙ(Aj) .
(1.4)
(6) Probability measures are continuous from below, that is, whenever Aj ∈𝒜satisfy
A1 ⊆A2 ⊆⋅⋅⋅,
ℙ(
∞
⋃
j=1
Aj) = lim
j→∞ℙ(Aj) .
(7) In a similar way, each probability measure is continuous from above: if Aj ∈𝒜sat-
isfy A1 ⊇A2 ⊇⋅⋅⋅, then
ℙ(
∞
⋂
j=1
Aj) = lim
j→∞ℙ(Aj) .
Proof. To prove (1), choose disjoint A1, . . . , An in 𝒜and set An+1 = An+2 = ⋅⋅⋅= 0. Then
A1, A2, . . . are infinitely many disjoint events in 𝒜, hence the σ-additivity of ℙimplies
ℙ(
∞
⋃
j=1
Aj) =
∞
∑
j=1
ℙ(Aj) .
Observe that ⋃∞
j=1 Aj = ⋃n
j=1 Aj and ℙ(Aj) = 0 if j > n, so the previous equation reduces
to
ℙ(
n
⋃
j=1
Aj) =
n
∑
j=1
ℙ(Aj) ,
and ℙis finitely additive.
To prove (2), write B = A ∪(B \ A) and observe that this is a disjoint decomposition
of B. Hence, by the finite additivity of ℙ, we obtain
ℙ(B) = ℙ(A) + ℙ(B \ A) .
Relocating ℙ(A) to the left-hand side proves (2).
An application of (2) to Ω and A leads to
ℙ(Ac) = ℙ(Ω \ A) = ℙ(Ω) −ℙ(A) = 1 −ℙ(A) ,
which proves (3).
5 Estimate (1.4) is also known as Boole’s inequality.

12
౪
1 Probabilities
The monotonicity is an easy consequence of (2). Indeed,
ℙ(B) −ℙ(A) = ℙ(B \ A) ≥0,
implying ℙ(B) ≥ℙ(A).
To prove inequality (1.4), choose arbitrary A1, A2, . . . in 𝒜. Set B1 := A1 and, if j ≥2,
then
Bj := Aj \ (A1 ∪⋅⋅⋅∪Aj−1) .
Then B1, B2, . . . are disjoint subsets in 𝒜with ⋃∞
j=1 Bj = ⋃∞
j=1 Aj. Furthermore, by the
construction, Bj ⊆Aj, hence ℙ(Bj) ≤ℙ(Aj). An application of all these properties yields
ℙ(
∞
⋃
j=1
Aj) = ℙ(
∞
⋃
j=1
Bj) =
∞
∑
j=1
ℙ(Bj) ≤
∞
∑
j=1
ℙ(Aj) .
Thus (5) is proved.
Let us turn now to the continuity from below. Choose A1, A2, . . . in 𝒜satisfying
A1 ⊆A2 ⊆⋅⋅⋅. With A0 := 0, set
Bk := Ak \ Ak−1 ,
k = 1, 2, . . .
The Bks are disjoint and, moreover, ⋃∞
k=1 Bk = ⋃∞
j=1 Aj. Furthermore, because of Ak−1 ⊆Ak,
from (2) we get ℙ(Bk) = ℙ(Ak) −ℙ(Ak−1). When putting this all together, it follows that
ℙ(
∞
⋃
j=1
Aj) = ℙ(
∞
⋃
k=1
Bk) =
∞
∑
k=1
ℙ(Bk) = lim
j→∞
j
∑
k=1
ℙ(Bk)
= lim
j→∞
j
∑
k=1
[ℙ(Ak) −ℙ(Ak−1)] = lim
j→∞[ℙ(Aj) −ℙ(A0)] = lim
j→∞ℙ(Aj),
where we used ℙ(A0) = ℙ(0) = 0. This proves the continuity from below.
Thus it remains to prove (7). For this, choose Aj ∈𝒜with A1 ⊇A2 ⊇⋅⋅⋅. Then the
complementary sets satisfy Ac
1 ⊆Ac
2 ⊆⋅⋅⋅. The continuity from below lets us conclude
that
ℙ(
∞
⋃
j=1
Ac
j ) = lim
j→∞ℙ(Ac
j ) = lim
j→∞[1 −ℙ(Aj)] = 1 −lim
j→∞ℙ(Aj) .
(1.5)
But
ℙ(
∞
⋃
j=1
Ac
j ) = 1 −ℙ((
∞
⋃
j=1
Ac
j )
c
) = 1 −ℙ(
∞
⋂
j=1
Aj) ,

1.2 Basic properties of probability measures
౪
13
and plugging this into eq. (1.5) gives
ℙ(
∞
⋂
j=1
Aj) = lim
j→∞ℙ(Aj),
as asserted.
Remark 1.2.2. Property (2) becomes false without the assumption A ⊆B. But because of
B \ A = B \ (A ∩B) and A ∩B ⊆B, we always have
ℙ(B \ A) = ℙ(B) −ℙ(A ∩B) .
(1.6)
Another useful property of probability measures is as follows.
Proposition 1.2.3. Let (Ω, 𝒜, ℙ) be a probability space. Then for all A1, A2 ∈𝒜, it follows
that
ℙ(A1 ∪A2) = ℙ(A1) + ℙ(A2) −ℙ(A1 ∩A2) .
(1.7)
Proof. Write the union of the two sets as
A1 ∪A2 = A1 ∪[A2 \ (A1 ∩A2)]
and note that the two sets on the right-hand side are disjoint. Because of A1 ∩A2 ⊆A2,
property (2) of Proposition 1.2.1 applies and leads to
ℙ(A1 ∪A2) = ℙ(A1) + ℙ(A2 \ (A1 ∩A2)) = ℙ(A1) + [ℙ(A2) −ℙ(A1 ∩A2)] .
This completes the proof.
Given A1, A2, A3 ∈𝒜, an application of the previous proposition to A1 and A2 ∪A3
implies
ℙ(A1 ∪A2 ∪A3) = ℙ(A1) + ℙ(A2) + ℙ(A3)
−[ℙ(A1 ∩A2) + ℙ(A1 ∩A3) + ℙ(A2 ∩A3)]
+ ℙ(A1 ∩A2 ∩A3) .
Another application of eq. (1.7) to the second and third terms in the right-hand sum
proves the following result (compare Figure 1.1).
Proposition 1.2.4. Let (Ω, 𝒜, ℙ) be a probability space and let A1, A2, and A3 be in 𝒜. Then
ℙ(A1 ∪A2 ∪A3) = ℙ(A1) + ℙ(A2) + ℙ(A3)
−[ℙ(A1 ∩A2) + ℙ(A1 ∩A3) + ℙ(A2 ∩A3)]
+ ℙ(A1 ∩A2 ∩A3).

14
౪
1 Probabilities
Figure 1.1: The inclusion–exclusion formula for three sets.
Remark 1.2.5. A generalization of Propositions 1.2.3 and 1.2.4 from 2 or 3 to an arbitrary
number of sets can be found in Problem 1.7. It is the so-called inclusion–exclusion for-
mula. For example, if n = 4, this formula says, given events A1, A2, A3, A4, that
ℙ(
4
⋃
i=1
Ai) =
4
∑
i=1
ℙ(Ai) −
∑
1≤i<j≤4
ℙ(Ai ∩Aj) +
∑
1≤i<j<k≤4
ℙ(Ai ∩Aj ∩Ak) −ℙ(
4
⋂
i=1
Ai) .
Let us explain two easy examples of how the properties of probability measures
apply.
Example 1.2.6. Let (Ω, 𝒜, ℙ) be a probability space. Suppose two events A and B in 𝒜
satisfy
ℙ(A) = 0.5 ,
ℙ(B) = 0.4,
and
ℙ(A ∩B) = 0.2 .
Which probabilities do A ∪B, A \ B, Ac ∪Bc, and Ac ∩B possess?
Answer: An application of Proposition 1.2.4 gives
ℙ(A ∪B) = ℙ(A) + ℙ(B) −ℙ(A ∩B) = 0.4 + 0.5 −0.2 = 0.7 .
Furthermore, by eq. (1.6), one gets
ℙ(A \ B) = ℙ(A) −ℙ(A ∩B) = 0.5 −0.2 = 0.3 .
Finally, by De Morgan’s rules and another application of eq. (1.6), we get
ℙ(Ac ∪Bc) = 1 −ℙ(A ∩B) = 0.8
and
ℙ(Ac ∩B) = ℙ(B \ A) = ℙ(B) −ℙ(A ∩B) = 0.2 .
In summary, say one has to take two exams A and B. The probability of passing exam
A is 0.5, the probability of passing B equals 0.4, and to pass both it is 0.2. Then with
probability 0.7 one passes at least one of the exams, with 0.3 exam A, but not B, with
probability 0.8 one fails at least once, and, finally, the probability to pass B but not A
is 0.2.

1.3 Discrete probability measures
౪
15
Example 1.2.7. Choose at random (all numbers are equally likely) a number from 1
to 1000. How likely is it that the chosen number is neither divisible by 3, nor by 5,
nor by 7?
Answer: Let D be the set of numbers in {1, . . . , 1000} which are neither divisible by
3, nor by 5, nor by 7. Then it follows that
Dc = A ∪B ∪C
where A consists of multiples of 3, B contains numbers divisible by 5, and C comprises
multiples of 7. Moreover, the numbers in A∩B are multiples of 15, A∩C contains multiples
of 21, and B ∩C consists of multiples of 35. Finally, we note that A ∩B ∩C includes only
numbers divisible by 105. Easy calculations lead to
ℙ(A) = 0.333,
ℙ(B) = 0.2,
P(C) = 0.142,
ℙ(A ∩B) = 0.066,
ℙ(A ∩C) = 0.047,
ℙ(B ∩C) = 0.028,
and
ℙ(A ∩B ∩C) = 0.009.
This implies
ℙ(Dc) = ℙ(A) + ℙ(B) + ℙ(C)
−[ℙ(A ∩B) + ℙ(A ∩C) + ℙ(B ∩C)] + ℙ(A ∩B ∩C)
= 0.333 + 0.2 + 0.142 −0.066 −0.047 −0.028 + 0.009 = 0.543.
So we finally arrive at
ℙ(D) = 1 −ℙ(Dc) = 1 −0.543 = 0.457 .
1.3 Discrete probability measures
We start with the investigation of finite sample spaces. They describe random experi-
ments where only finitely many different results may occur, as, for example, rolling a
die n times, tossing a coin finitely often, and so on. Suppose the sample space contains
N different elements. Then we may enumerate these elements as follows:
Ω = {ω1, . . . , ωN} .
As σ-field we choose 𝒜= 𝒫(Ω).
Given an arbitrary probability measure ℙ: 𝒫(Ω) →ℝ, set
pj := ℙ({ωj}) ,
j = 1, . . . , N .
(1.8)
In this way we assign to each probability measure ℙnumbers p1, . . . , pN. Which proper-
ties do they possess? The answer to this question gives the following proposition.

16
౪
1 Probabilities
Proposition 1.3.1. If ℙis a probability measure on 𝒫(Ω), then the numbers pj defined by
eq. (1.8) satisfy
0 ≤pj ≤1
and
N
∑
j=1
pj = 1 .
(1.9)
Proof. The first property is an immediate consequence of having ℙ(A) ≥0 for all A ⊆Ω.
The second property of the pjs follows from
1 = ℙ(Ω) = ℙ(
N
⋃
j=1
{ωj}) =
N
∑
j=1
ℙ({ωj}) =
N
∑
j=1
pj .
Conclusion. Each probability measure ℙgenerates a sequence (pj)N
j=1 of real numbers
satisfying the properties (1.9). Moreover, if A ⊆Ω, then we have
ℙ(A) =
∑
{j:ωj∈A}
pj .
(1.10)
In particular, the assignment ℙ→(pj)N
j=1 is one-to-one.
Property (1.10) is an easy consequence of A = ⋃{j:ωj∈A}{ωj}. Furthermore, it tells us
that ℙis uniquely determined by the pjs. Note that two probability measures ℙ1 and ℙ2
on (Ω, 𝒜) coincide if ℙ1(A) = ℙ2(A) for all A ∈𝒜.
Now let us look at the reverse question. Suppose we are given an arbitrary sequence
(pj)N
j=1 of real numbers satisfying the conditions (1.9).
Proposition 1.3.2. Define ℙon 𝒫(Ω) by
ℙ(A) =
∑
{j:ωj∈A}
pj .
(1.11)
Then ℙis a probability measure satisfying ℙ({ωj}) = pj for all j ≤n.
Proof. The map ℙhas values in [0, 1] and ℙ(Ω) = 1 by ∑N
j=1 pj = 1. Since the summation
over the empty set equals zero, ℙ(0) = 0.
Thus it remains to show that ℙis σ-additive. Take disjoint subsets A1, A2, . . . of Ω.
Since Ω is finite, there are at most finitely many of the Ajs which are nonempty. Say, for
simplicity, these are the first n sets A1, . . . , An. Then we get
ℙ(
∞
⋃
k=1
Ak) = ℙ(
n
⋃
k=1
Ak) =
∑
{j:ωj∈⋃n
k=1 Ak}
pj
=
n
∑
k=1
∑
{j:ωj∈Ak}
pj =
∞
∑
k=1
∑
{j:ωj∈Ak}
pj =
∞
∑
k=1
ℙ(Ak) ,

1.3 Discrete probability measures
౪
17
hence ℙis σ-additive.
By the construction, ℙ({ωj}) = pj, which completes the proof.
Summary: If Ω = {ω1, . . . , ωN}, then probability measures ℙon 𝒫(Ω) can be identified
with sequences (pj)N
j=1 satisfying the conditions (1.9).
{Probability measures ℙon 𝒫(Ω)}
⇐⇒
{Sequences (pj)N
j=1 for which (1.9) hold}
Hereby the assignment from the left- to the right-hand side goes via pj = ℙ({ωj}) while
in the other direction ℙis given by eq. (1.11).
Example 1.3.3. Assume Ω = {1, 2, 3}. Then each probability measure ℙon 𝒫(Ω) is
uniquely determined by the three numbers p1 = ℙ({1}), p2 = ℙ({2}), and p3 = ℙ({3}).
These numbers satisfy p1, p2, p3 ≥0 and p1 + p2 + p3 = 1. Conversely, any three numbers
p1, p2, and p3 with these properties generate a probability measure on 𝒫(Ω) via (1.11).
For example, if A = {1, 3}, then ℙ(A) = p1 + p3.
Next we treat countably infinite sample spaces, that is, Ω = {ω1, ω2, . . . }. Also here we
may take 𝒫(Ω) as σ-field and, as in the case of finite sample spaces, given a probability
measure ℙon 𝒫(Ω), we set
pj := ℙ({ωj}) ,
j = 1, 2, . . .
Then (pj)∞
j=1 obeys the following properties:
pj ≥0
and
∞
∑
j=1
pj = 1 .
(1.12)
The proof is the same as in the finite case. The only difference is that here we have to use
the σ-additivity of ℙbecause this time Ω = ⋃∞
j=1{ωj}. By the same argument, it follows
for A ⊆Ω that
ℙ(A) =
∑
{j≥1 : ωj∈A}
pj .
Hence, again the pjs determine ℙcompletely.
Conversely, let (pj)∞
j=1 be an arbitrary sequence of real numbers with properties
(1.12).
Proposition 1.3.4. The mapping ℙdefined by
ℙ(A) =
∑
{j≥1 : ωj∈A}
pj
(1.13)
is a probability measure on 𝒫(Ω) with ℙ({ωj}) = pj, 1 ≤j < ∞.

18
౪
1 Probabilities
Proof. The proof is analogous to that of Proposition 1.3.2 with one important exception.
In the case |Ω| < ∞, we used that there are at most finitely many disjoint nonempty
subsets. This is no longer valid. Thus a different argument is needed.
Given disjoint subsets A1, A2, . . . , in Ω set
Ik = {j ≥1 : ωj ∈Ak} .
Then Ik ∩Il = 0 if k
̸= l, thus,
ℙ(Ak) = ∑
j∈Ik
pj
and
ℙ(
∞
⋃
k=1
Ak) = ∑
j∈I
pj,
where I = ⋃∞
k=1 Ik. Use that i ∈I if and only if there is some k ≥1 with i ∈Ik or,
equivalently, with ωi ∈Ak, that is, if and only if ωi ∈⋃∞
k=1 Ak.
Since pj ≥0, Remark A.5.6 applies and leads to
ℙ(
∞
⋃
k=1
Ak) = ∑
j∈I
pj =
∞
∑
k=1
∑
j∈Ik
pj =
∞
∑
k=1
ℙ(Ak) .
Thus ℙis σ-additive.
The equality ℙ({ωj}) = pj, 1 ≤j < ∞, is again a direct consequence of the definition
of ℙ.
Summary: If Ω = {ω1, ω2, . . . }, then probability measures ℙon 𝒫(Ω) can be identified
with (infinite) sequences (pj)∞
j=1 possessing the properties (1.12).
{Probability measures ℙon 𝒫(Ω)}
⇐⇒
{Sequences (pj)∞
j=1 satisfying (1.12)}
Again, the assignment from the left- to the right-hand side goes via pj = ℙ({ωj}) while
the other direction rests upon eq. (1.13).
Example 1.3.5. For Ω = ℕand j ≥1, let pj = 2−j. These pjs satisfy conditions (1.12) (check
this!). The generated probability measure ℙon 𝒫(ℕ) is then given by
ℙ(A) := ∑
j∈A
1
2j .
For example, if A = {2, 4, 6, . . .}, then we get
ℙ(A) = ∑
j∈A
1
2j =
∞
∑
k=1
1
22k =
1
1 −1/4 −1 = 1
3 .
Or, if B = {N + 1, N + 2, . . .} for a certain N ∈ℕ, then one obtains

1.3 Discrete probability measures
౪
19
ℙ(B) =
∞
∑
j=N+1
1
2j = 2−N−1
∞
∑
j=0
1
2j = 2−N−1 ⋅2 = 2−N .
Another way to evaluate the probability of B is
ℙ(B) = 1 −ℙ(Bc) = 1 −
N
∑
j=1
1
2j = 1 −[1 −2−N−1
1 −1
2
−1] = 2−N .
Example 1.3.6. Let Ω = ℤ\ {0}, that is, Ω = {1, −1, 2, −2, . . . }. With c > 0 specified later
on, assume
pk = c
k2 ,
k ∈Ω .
The number c > 0 has to be chosen so that the conditions (1.12) are satisfied, hence it has
to fulfill
1 = c
∑
k∈ℤ\{0}
1
k2 = 2 c
∞
∑
k=1
1
k2 .
But, as is well known,6
∞
∑
k=1
1
k2 = π2
6 ,
which implies c =
3
π2 . Thus ℙon 𝒫(Ω) is uniquely described by
ℙ({k}) = 3
π2
1
k2 ,
k ∈ℤ\ {0} .
For example, if A = ℕ, then
ℙ(A) = 3
π2
∞
∑
k=1
1
k2 = 3
π2
π2
6 = 1
2 .
Or if A = {2, 4, 6, . . . }, it follows that
ℙ(A) = 3
π2
∞
∑
k=1
1
(2k)2 = 1
4 ℙ(ℕ) = 1
8 .
For later purposes, we want to combine the two cases of finite and countably infinite
sample spaces and thereby introduce a slight generalization.
6 We refer to [Mor16], where one can find an easy proof of this fact. The problem to compute the value
of the sum is known as “Basel problem.” The first solution was found in 1734 by Leonhard Euler. Note
that ∑k≥1 1/k2 = ζ(2) with Riemann’s ζ-function.

20
౪
1 Probabilities
Let Ω be an arbitrary sample space. A probability measure ℙis said to be discrete
if there is an at most countably infinite set D ⊆Ω (i. e., either D is finite or countably
infinite) such that ℙ(D) = 1. Then for A ⊆Ω,
ℙ(A) = ℙ(A ∩D) = ∑
ω∈D
ℙ({ω}) .
Since ℙ(Dc) = 0, this says that ℙis concentrated on D. Of course, all previous results
for a finite or countably infinite sample space carry over to this more general setting.
Discrete probability measures ℙare concentrated on an at most countably infinite set D. They are uniquely
determined by the values ℙ({ω}), where ω ∈D.
Of course, if the sample space is either finite or countably infinite, then all probability
measures on this space are discrete. Nondiscrete probability measures will be intro-
duced and investigated in Section 1.5.
Example 1.3.7. We once more model a single rolling of a die, but now we take as sample
space Ω = ℝ. Define ℙ({ω}) = 1
6 if ω = 1, . . . , 6 and ℙ({ω}) = 0 otherwise. If D = {1, . . . , 6},
then ℙ(D) = 1, hence ℙis discrete. Given A ⊆ℝ, it follows that
ℙ(A) = |A ∩D|
6
.
For example, we have ℙ([−2, 2]) = 1
3 and ℙ([3, ∞)) = 2
3.
Another, maybe a little artificial, example is as follows.
Example 1.3.8. It is known that the set ℚof rational numbers is countably infinite.
Hence ℚ= {q1, q2, . . .} with rational numbers qk. Take any sequence (pk)∞
k=1 of positive
numbers with ∑∞
k=1 pk = 1. Then ℙdefined by
ℙ(A) =
∑
{k:qk∈A}
pk ,
A ⊆ℝ,
is a discrete probability measure on ℝwith ℙ(ℚ) = 1. The problem with this probability
measure is that it is completely impossible to evaluate ℙ(B) for almost all B ⊆ℝ, even if
the pks are known.
1.4 Special discrete probability measures
1.4.1 Dirac measure
The simplest discrete probability measure is concentrated at a single point. That is, there
exists an ω0 ∈Ω such that ℙ({ω0}) = 1. This probability measure is denoted by δω0.

1.4 Special discrete probability measures
౪
21
Consequently, for each A ∈𝒫(Ω), one has
δω0(A) = {1
if ω0 ∈A,
0
if ω0 ∉A.
(1.14)
Definition 1.4.1. The probability measure δω0 defined by eq. (1.14) is called the Dirac measure or point
measure at ω0.
Which random experiment does (Ω, 𝒫(Ω), δω0) model? It describes the experiment
where, with probability one, the value ω0 occurs. Thus, in fact it is a deterministic
experiment, not random.
Dirac measures are useful tools to represent general discrete probability measures.
Assume ℙis concentrated on D = {ω1, ω2, . . . } and let pj = ℙ({ωj}). Then we may write
ℙ=
∞
∑
j=1
pj δωj .
(1.15)
Conversely, if a measure ℙis represented as in eq. (1.15) with certain ωj ∈Ω and numbers
pj ≥0, ∑∞
j=1 pj = 1, then ℙis discrete with ℙ(D) = 1, where D = {ω1, ω2, . . .}.
1.4.2 Uniform distribution on a finite set
The sample space is finite, say Ω = {ω1, . . . , ωN}, and we assume that all elementary
events are equally likely, that is,
ℙ({ω1}) = ⋅⋅⋅= ℙ({ωN}) .
A typical example is a fair die, where Ω = {1, . . . , 6}.
Since 1 = ℙ(Ω) = ∑N
j=1 ℙ({ωj}), we immediately get ℙ({ωj}) = 1/N for all j ≤N. If
A ⊆Ω, an application of eq. (1.11) leads to
ℙ(A) = |A|
N = |A|
|Ω| .
(1.16)
Definition 1.4.2. The probability measure ℙdefined by eq. (1.16) is called the uniform distribution or
Laplace distribution on the finite set Ω.
The following formula may be helpful for remembrance. If ℙis the uniform distribution
on a finite sample space Ω, then
ℙ(A) = Number of cases favorable for A
Number of possible cases
,
A ⊆Ω .

22
౪
1 Probabilities
Example 1.4.3. In a lottery, 6 numbers are chosen out of 49 and each number appears
only once. What is the probability that the chosen numbers are exactly the six marked
on my lottery coupon?
Answer: Let us give two different approaches to answer this question.
Approach 1: We record the chosen numbers in the order they show up. As a sample
space, we may take
Ω := {(ω1, . . . , ω6) : ωi ∈{1, . . . , 49}, ωi
̸= ωj if i
̸= j} .
Then the number of possible cases is
|Ω| = 49 ⋅48 ⋅47 ⋅46 ⋅45 ⋅44 = 49!
43! .
Let A be the event that the numbers on my lottery coupon appear. Which cardinality
does A possess?
Say, for simplicity, that in our coupon the numbers 1, 2, . . . , 6 are marked. Then
it is favorable for A if these numbers appear in this order. But it is also favorable if
(2, 1, 3, . . . , 6) shows up, that is, any permutation of 1, . . . , 6 is favorable. Hence |A| = 6!,
which leads to7
ℙ(A) =
6!
49 ⋅⋅⋅44 =
1
(49
6 ) = 7.15112 × 10−8 .
Approach 2: We assume that the chosen numbers are already ordered by their size
(as they are published in a newspaper). In this case our sample space is
Ω := {(ω1, . . . , ω6) : 1 ≤ω1 < ⋅⋅⋅< ω6 ≤49},
and now
|Ω| = (49
6 ) .
Why? Any set of six different numbers may be written exactly in one way in increas-
ing order and thus choosing six ordered numbers is exactly the same as choosing a
(nonordered) set of six numbers. And there are (49
6 ) possibilities to choose six numbers.
In this setting, we have |A| = 1, thus also here we get
ℙ(A) =
1
(49
6 ) .
7 To get an impression about the size of this number, assume we buy lottery coupons with all possible
choices of the six numbers. If each coupon is 0.5-mm thick, then all coupons together have a size of
6.992 km, which is about 4.3 miles. And in this row of 4.3 miles there exists exactly one coupon with the
six numbers chosen in the lottery.

1.4 Special discrete probability measures
౪
23
Example 1.4.4. A fair coin is labeled with “0” and “1”. Toss it n times and record the
sequence of zeroes and ones in the order of their appearance. Thus,
Ω := {0, 1}n = {(ω1, . . . , ωn) : ωi ∈{0, 1}} ,
and |Ω| = 2n. The coin is assumed to be fair, hence each sequence of zeroes and ones is
equally likely. Therefore, whenever A ⊆Ω, one has
ℙ(A) = |A|
2n .
Take, for example, the event A where for some fixed i ≤n the ith toss equals “0”,
that is,
A = {(ω1, . . . , ωn) : ωi = 0} .
Then |A| = 2n−1 leads to the (not surprising) result
ℙ(A) = 2n−1
2n
= 1
2 .
Or let A occur if we observe for some given k ≤n exactly k times the number “1”. Then
|A| = (n
k), and we get
ℙ(A) = (n
k) ⋅1
2n .
Suppose n ≥2. How likely is it that the first and the last toss coincide? There are 2n−2
possibilities that the first and the last toss are both 0 and also 2n−2 ways for both tosses
to be 1. Hence, the probability of this event equals
2n−2 + 2n−2
2n
= 1
2 .
Example 1.4.5. We have k particles that we distribute randomly into n boxes. All possi-
ble distributions of the particles are assumed to be equally likely. How do we get ℙ(A)
for a given event A?
Answer: In this formulation, the question is not asked correctly because we did not
fix when two distributions of particles coincide. Compare Figures 1.2 and 1.3 to under-
stand why it is important whether or not the particles are anonymous or distinguishable.
Let us illustrate this problem in the case of two particles and two boxes. If the parti-
cles are not distinguishable (anonymous) then there are three different ways to distribute
the particles into the two boxes. Thus, assuming that all distributions are equally likely,
each elementary event has probability 1/3.

24
౪
1 Probabilities
On the other hand, if the particles are distinguishable, that is, they carry names, here
1 and 2, then there exist four different ways of distributing them, hence each elementary
event has probability 1/4.
Figure 1.2: Distributing two distinguishable particles into two boxes. Each event has probability 1/4.
Figure 1.3: Distributing two anonymous particles into two boxes. Each event occurs with probability 1/3.
Let us answer the above question in the two cases (distinguishable and anonymous)
separately.
Distinguishable particles: Recall that we have k particles and n boxes. So we may
enumerate the particles from 1 to k and each distribution of particles is uniquely de-
scribed by a sequence (a1, . . . , ak), where aj ∈{1, . . . , n}. For example, a1 = 3 means that
particle one is in box 3. Hence, a suitable sample space is
Ω = {(a1, . . . , ak) : 1 ≤ai ≤n} .
Since |Ω| = nk, for events A ⊆Ω, it follows that
ℙ(A) = |A|
nk .
Anonymous particles: We record how many of the k particles are in box 1, how many
are in box 2, and so on up to box n. Thus, as sample space we may choose
Ω = {(k1, . . . , kn) : 0 ≤kj ≤k, k1 + ⋅⋅⋅+ kn = k} .
The sequence (k1, . . . , kn) occurs if box 1 contains k1 particles, box 2 contains k2, and so
on. From the results in case 3 of Section A.3.2, we derive
|Ω| = (n + k −1
k
) .
Hence, if A ⊆Ω, then
ℙ(A) = |A|
|Ω| = |A| k! (n −1)!
(n + k −1)!.

1.4 Special discrete probability measures
౪
25
Summary: If we distribute k particles into n boxes and assume that all distributions are equally likely,8 then
in the case of distinguishable or of anonymous particles for any set A of distributions,
ℙ(A) = |A|
nk
or
ℙ(A) = |A| k! (n −1)!
(n + k −1)!,
respectively.
Let us evaluate ℙ(A) for some concrete event A in both cases. Suppose k ≤n and select
k of the n boxes. Set
A := {In each of the chosen k boxes, there is exactly one particle}.
(1.17)
To simplify the notation, assume that the first k boxes have been chosen. The general
case is treated in a similar way. Then in the “distinguishable case” the event A occurs if
and only if for some permutation π ∈Sk the sequence (π(1), . . . , π(k), 0, . . . , 0) appears.
Thus |A| = k! and
ℙ(A) = k!
nk .
(1.18)
In the “anonymous case,” it follows that |A| = 1 (why?). Hence here we obtain
ℙ(A) = k! (n −1)!
(n + k −1)! .
(1.19)
Additional question: For k ≤n, define the event B by
B := {Each of the n boxes contains at most 1 particle}.
Find ℙ(B) in both cases.
Answer: The event B is the (disjoint) union of the following events: the k particles are
distributed in a given collection of k boxes. The probability of this event was calculated
in eqs. (1.18) and (1.19), respectively. Since there are (n
k) possibilities to choose k boxes
out of n, we get ℙ(B) = (n
k)ℙ(A), with A as defined by (1.17), that is,
ℙ(B) = (n
k) ⋅k!
nk =
n!
(n −k)! nk
and
ℙ(B) = (n
k) ⋅k! (n −1)!
(n + k −1)! =
n! (n −1)!
(n −k)! (n + k −1)!,
(1.20)
respectively.
8 Compare Example 1.4.20 and the following remark.

26
౪
1 Probabilities
Example 1.4.6. Suppose we distribute 6 particles into 3 boxes such that all distributions
are equally likely. What is the probability that each of the three boxes contains exactly
two particles?
Answer: Let us first assume that the particles are distinguishable. If A is the event
that each box contains 2 particles, then it follows that
|A| = (
6
2, 2, 2) = 6!
23 = 90 .
Consequently, we obtain
ℙ(A) = |A|
36 = 10
81.
Let us turn now to the case of indistinguishable particles. Here we have |A| = 1 (why?),
hence in this case it follows that
ℙ(A) = 6!(3 −1)!
(3 + 6 −1)! = 2 ⋅6!
8!
= 1
28 .
Example 1.4.7. Let us check the validity of formula (1.20) by an easy test. In Exam-
ple A.3.15, we evaluate the number of tiles of a domino in the following way. There are 7
boxes and we place two particles into these boxes. Hereby, the particles are anonymous
and all distributions are equally likely. Then the event B defined by “at most one particle
in each box” corresponds to tiles with different numbers of dots. Now choose one of
the 28 tiles at random. Since there are 21 tiles with different numbers of dots, it follows
that
ℙ(B) = 21
28 = 3
4 .
On the other hand, formula (1.20) leads to (recall that n = 7 and k = 2)
ℙ(B) =
n! (n −1)!
(n −k)! (n + k −1)! = 7! ⋅6!
5! ⋅8! = 6
8 = 3
4 .
So we see, in this case formula (1.20) gives the correct value.
Example 1.4.8. Suppose the sample space Ω is given by
Ω = {(k1, . . . , k6) : k1 + ⋅⋅⋅+ k6 = 4, kj ∈ℕ0}
and endowed with the uniform distribution. That is, all possible representations of the
number 4 by six nonnegative integers are equally likely. So, for example, the occurrence
of (1, 2, 0, 0, 1, 0) is as likely as that of (0, 0, 0, 0, 0, 4) or that of (4, 0, 0, 0, 0, 0).
Questions:
(1) What is the cardinality of Ω?

1.4 Special discrete probability measures
౪
27
(2) How likely is it to observe those (k1, . . . , k6) ∈Ω for which 0 ≤kj ≤1?
Answers: An equivalent model is as follows: one has six boxes and places four anony-
mous particles into these boxes. In this way, kj describes the number of particles in box
j with 1 ≤j ≤6.
In the setting of case 3 of Section A.3.2, we have k = 4 and n = 6. Hence, the cardi-
nality of the sample space equals
|Ω| = (n + k −1
n −1 ) = (9
5) = 126 .
To answer the second question, note that all numbers kj satisfy kj ≤1 if and only if each
of the six boxes contains at most one particle. According to eq. (1.20), the probability of
this event is given by
n! (n −1)!
(n −k)! (n + k −1)! = 6! ⋅5!
2! ⋅9! = 5
42 ≈0.119048 .
Another (more direct) way to obtain the last result is as follows: there are (6
4) ways to
write 4 as a sum of six numbers which are either 0 or 1. Hence, the desired probability
equals
(6
4)
|Ω| = 15
126 = 5
42 .
Summary: The uniform distribution ℙon a sample space Ω = {ω1, . . . , ωN} is characterized by
ℙ({ω1}) = ⋅⋅⋅= ℙ({ωN}) = 1
N ,
or, equivalently, by
ℙ(A) = |A|
N = Number of cases favorable for A
Number of possible cases
,
A ⊆Ω .
1.4.3 Binomial distribution
The sample space is Ω = {0, 1, . . . , n} for some n ≥1 and p is a real number with 0 ≤p ≤1.
Proposition 1.4.9. There exists a unique probability measure Bn,p on 𝒫(Ω) satisfying
Bn,p({k}) = (n
k) pk(1 −p)n−k ,
k = 0, . . . , n .
(1.21)
Proof. In order to use Proposition 1.3.2, we have to verify Bn,p({k}) ≥0 and
∑n
k=0 Bn,p({k}) = 1. The first property is obvious because of 0 ≤p ≤1 and 0 ≤1 −p ≤1.
To prove the second, we apply the binomial theorem (Proposition A.3.8) with a = p and
with b = 1 −p. This leads to

28
౪
1 Probabilities
n
∑
k=0
Bn,p({k}) =
n
∑
k=0
(n
k) pk(1 −p)n−k = (p + (1 −p))
n = 1 .
Hence the assertion follows by Proposition 1.3.2 with pk = Bn,p({k}), k = 0, . . . , n.
Compare Figure 1.4 for the values of Bn,p({k}) in the case n = 9 and with, p = 1/2 and
p = 1/4, respectively.
Figure 1.4: Probabilities Bn,p({k}) with n = 9, p = 1/2, and p = 1/4, k = 0, . . . , 9.
Definition 1.4.10. The probability measure Bn,p defined by eq. (1.21) is called the binomial distribution
with parameters n and p.
Remark 1.4.11. Observe that Bn,p acts as follows. If A ⊆{0, . . . , n}, then
Bn,p(A) = ∑
k∈A
(n
k) pk(1 −p)n−k .
Furthermore, for p = 1/2, we get
Bn,1/2({k}) = (n
k) 1
2n .
As we saw in Example 1.4.4, this probability describes the k-fold occurrence of “1” when
tossing a fair coin n times.
Which random experiment describes the binomial distribution? To answer this
question, let us first look at the case n = 1. Here we have Ω = {0, 1} with
Bn,p({0}) = 1 −p
and
Bn,p({1}) = p .
If we identify “0” with failure and “1” with success, then the binomial distribution de-
scribes an experiment where either success or failure may occur, and the success proba-
bility is p. Now we execute the same experiment n times and every time we may observe
either failure or success. If we have k times success, then there are (n
k) ways to obtain

1.4 Special discrete probability measures
౪
29
these k successes during the n trials. The probability for success is p and for failure 1−p.
By the independence of the single trials, the probability for the sequence is pk(1 −p)n−k.
Multiplying this probability with the number of different positions of successes, we fi-
nally arrive at (n
k)pk(1 −p)n−k, the value of Bn,p({k}).
Example 1.4.12. An exam consists of 100 problems where each of the question may be
answered either with “yes” or “no.” To pass the exam, at least 60 questions have to be
answered correctly. Let p be the probability to answer a single question correctly. How
big does p have to be in order to pass the exam with a probability greater than 75 %?
Answer: The number p has to be chosen such that the following estimate is satis-
fied:
100
∑
k=60
(100
k )pk(1 −p)100−k ≥0.75 .
Numerical calculations show that this is valid if and only if p ≥0.62739.
Example 1.4.13. In an auditorium there are N students. Find the probability that at least
two of them have their birthday on April 1.
Answer: We do not take leap years into account and assume that there are no twins
among the students. Finally, we make the (probably unrealistic) assumption that all days
of a year are equally likely as birthdays. Say success occurs if a student has birthday on
April 1. Under the above assumptions, the success probability is 1/365. Hence the number
of students having birthday on April 1 is binomially distributed with parameters N and
p = 1/365. We ask for the probability of A = {2, 3, . . . , N}. This may be evaluated by
N
∑
k=2
(N
k )( 1
365)
k
(364
365)
N−k
= 1 −BN,1/365({0}) −BN,1/365({1})
= 1 −(364
365)
N
−N
365(364
365)
N−1
.
For example, N = 500 this probability is approximately 0.397895.
Example 1.4.14. In an urn there are 40 white balls and 60 black ones. One chooses balls
one after another from the urn with replacement. How often does one have to choose
balls in order to observe with probability greater than 0.5 at least 10 white balls?
Answer: The success probability is p = 40/100 = 2/5. So we ask for the minimal
number n ≥10 for which
Bn,p({10, 11, . . . , n}) ≥0.5
⇔
n
∑
k=10
(n
k)(2
5)
k
(3
5)
n−k
≥0.5 .
Numerical calculations give the following probabilities:

30
౪
1 Probabilities
n
Bn,p({10, 11, . . . , n})
20
0.244663
21
0.308558
22
0.375648
23
0.443771
24
0.510920
So we see that n = 24 is the minimal number of trials to obtain at least 10 white
balls with probability greater than or equal to 1/2. Of course, if we increase the number
of trials then it becomes more and more likely to get at least 10 white balls. For exam-
ple, if one takes out 40 balls, then the probability for at least 10 white balls is about
0.9845.
Summary: The binomial distribution describes the following setting. One executes n times independently
the same experiment where each time either success or failure may appear. The success probability is p. Then
Bn,p({k}) is the probability to observe exactly k successes or, equivalently, n −k failures.
1.4.4 Multinomial distribution
Given natural numbers n and m, the sample space for the multinomial distribution
is9
Ω := {(k1, . . . , km) ∈ℕm
0 : k1 + ⋅⋅⋅+ km = n} .
With certain nonnegative real numbers p1, . . . , pm satisfying p1 + ⋅⋅⋅+ pm = 1, set
ℙ({(k1, . . . , km)}) := (
n
k1, . . . , km
) pk1
1 ⋅⋅⋅pkm
m ,
(k1, . . . , km) ∈Ω .
(1.22)
Recall that the multinomial coefficients appearing in eq. (1.22) were defined in eq. (A.16)
as
(
n
k1, . . . , km
) =
n!
k1! ⋅⋅⋅km! .
The next result shows that eq. (1.22) defines a probability measure.
Proposition 1.4.15. There is a unique probability measure ℙon 𝒫(Ω) such that (1.22)
holds for all (k1, . . . , km) ∈Ω.
9 By case 3 in Section A.3.2, the cardinality of Ω is (n+m−1
n
).

1.4 Special discrete probability measures
౪
31
Proof. An application of the multinomial theorem (Proposition A.3.20) implies
∑
(k1,...,km)∈Ω
ℙ({(k1, . . . , km)}) =
∑
k1+⋅⋅⋅+km=n
ki≥0
(
n
k1, . . . , km
) pk1
1 ⋅⋅⋅pkm
m
= (p1 + ⋅⋅⋅+ pm)n = 1n = 1 .
Since ℙ({(k1, . . . , km)}) ≥0, the assertion follows by Proposition 1.3.2.
In view of the preceding proposition, the following definition is justified.
Definition 1.4.16. The probability measure ℙdefined by eq. (1.22) is called the multinomial distribu-
tion with parameters n, m, and p1, . . . , pm.
Remark 1.4.17. Sometimes it is useful to regard the multinomial distribution on the
larger sample space Ω = ℕm
0 . In this case we have to modify eq. (1.22) slightly as follows:
ℙ({(k1, . . . , km)}) = {(
n
k1,...,km) pk1
1 ⋅⋅⋅pkm
m
if k1 + ⋅⋅⋅+ km = n,
0
if k1 + ⋅⋅⋅+ km
̸= n.
Which random experiment does the multinomial distribution describe? To answer
this question, let us recall the model for the binomial distribution. In an urn there are
balls of two different colors, say white and red. The proportion of the white balls is p,
hence 1−p is the proportion of the red ones. If we choose n balls with replacement, then
Bn,p({k}) is the probability to observe exactly k white balls.
What happens if in the urn there are balls of more than two different colors, say of
m, and the proportions of the colored balls are p1, . . . , pm with p1 + ⋅⋅⋅+ pm = 1?
As in the model for the binomial distribution, we choose n balls with replacement.
Given integers kj ≥0, one asks now for the probability of the following event: balls of
the first color showed up k1 times, those of the second k2 times, and so on. Of course, this
probability is zero whenever k1 + ⋅⋅⋅+ km
̸= n. But if the sum is n, then pk1
1 ⋅⋅⋅pkm
m is the
probability for kj balls of color j in some fixed order. There are (
n
k1,...,km) ways to order the
balls without changing the frequency of the colors. Thus the desired probability equals
(
n
k1,...,km) pk1
1 ⋅⋅⋅pkm
m .
Remark 1.4.18. If m = 2, then p2 = 1−p1, as well as ( n
k1,k2) = (
n
k1,n−k1) = ( n
k1). Consequently,
in this case the multinomial distribution coincides with the binomial distribution Bn,p1.
Example 1.4.19. Suppose in an urn there are 3 white, 5 red, and 4 black balls. Choose 9
balls with replacement. How likely is it to observe three balls of each color.
Answer: The success probabilities are p1 = 3/12, p2 = 5/12, and p3 = 4/12. Hence, the
desired probability equals
(
9
3, 3, 3)( 3
12)
3
( 5
12)
3
( 4
12)
3
= 9! ⋅603
63 ⋅129 ≈0.0703286 .

32
౪
1 Probabilities
Additional question: How likely is it to observe no white ball among the 9 chosen
ones?
Answer: An approach via the multinomial distributions would be possible. Then
one has to sum over all possible choices of red and black balls. But the problem can be
handled in a more direct way. Say success occurs if the chosen ball is white and failure
if this is not so. Then the success probability is 3/12 = 1/4. Thus, we ask for a total of 9
failures which has the probability (3/4)9 ≈0.0750847.
Example 1.4.20. Suppose we have m boxes B1, . . . , Bm and n particles that we place suc-
cessively into these boxes. Thereby pj is the probability to place a single particle into box
Bj. What is the probability that after distributing all n particles there are k1 particles in
the first box, k2 in the second, and all the way up to km in the last one?
Answer: This probability is given by formula (1.22), that is,
ℙ{k1 particles are in B1, . . . , km particles are in Bm} = (
n
k1, . . . , km
) pk1
1 ⋅⋅⋅pkm
m .
For example, if we place 5 particles into 3 boxes with probabilities 1/2, 1/3, and 1/6, re-
spectively, then
ℙ{k1 are in B1, k2 are in B2, k3 are in B3} = (
5
k1, k2, k3
)(1
2)
k1
( 1
3)
k2
( 1
6)
k3
provided that k1 + k2 + k3 = 5.
Remark 1.4.21. In the case that all m possible different outcomes of an experiment are
equally likely, that is, we have
p1 = ⋅⋅⋅= pm = 1
m ,
then
ℙ({(k1, . . . , km)}) = (
n
k1, . . . , km
) 1
mn ,
k1 + ⋅⋅⋅+ km = n .
(1.23)
Example 1.4.22. Roll a fair die 12 times. How likely is it that each of the six possible
results appears exactly twice?
Answer: An equivalent formulation of the problem is as follows: there are 6 boxes
and 12 particles. Place these 12 particles randomly into the 6 boxes so that all boxes are
equally likely. Let the event A occur if in each of the six boxes there are two particles or,
equivalently, if each of the numbers from 1 to 6 appears twice. Then we get
ℙ(A) = (
12
2, 2, 2, 2, 2, 2)( 1
6)
12
=
12!
26 612 ≈0.00343829 .
Example 1.4.23. Suppose that in Example 1.4.20 all m boxes are chosen with probabil-
ity 1/m. Then, if n ≤m, one may ask for the probability that each of the first n boxes

1.4 Special discrete probability measures
౪
33
B1, . . . , Bn contains exactly one particle. By eq. (1.23), it follows that
ℙ({(1, . . . , 1
⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟
n
, 0, . . . , 0)}) = (
n
1, . . . , 1
⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟
n
, 0, . . . , 0) 1
mn = n!
mn .
(1.24)
Remark 1.4.24. From a different point of view, we investigated the last problem already
in Example 1.4.5. But why do we get in eq. (1.24) the same answer as in the case of distin-
guishable particles although the n distributed ones are anonymous?
Answer: The crucial point is that we assumed in the anonymous case that all parti-
tions of the particles are equally likely. And this is not valid when distributing the par-
ticles successively. To see this, assume n = m = 2. Then there exist three different ways
to distribute the particles, but they have different probabilities:
ℙ({(0, 2)}) = ℙ({(2, 0)}) = 1
4
while ℙ({(1, 1)}) = 1
2 .
Thus, although the distributed particles are not distinguishable, they get names due to
the successive distribution (first particle, second particle, etc.).
Example 1.4.25. Six people randomly enter a train with three coaches. Each person
chooses his wagon independently of the others and all coaches are equally likely to be
chosen. Find the probability that there are two people in each coach.
Answer: We have m = 3, n = 6, and p1 = p2 = p3 = 1
3. Hence the probability we are
looking for is
ℙ({(2, 2, 2)}) = (
6
2, 2, 2) 1
36 =
6!
2! 2! 2!
1
36 = 10
81 = 0.12345679 .
Check how this result is related to that presented in Example 1.4.6.
Example 1.4.26. In a country 40 % of the cars are gray, 20 % are black, and 10 % are red.
The remaining cars have different colors. Now we observe at random 10 cars. What is
the probability to see two gray cars, four black, and one red?
Answer: By assumption m = 4 (gray, black, red, and others), p1 = 2/5, p2 = 1/5,
p3 = 1/10, and p4 = 3/10. Thus the probability of the vector (2, 4, 1, 3) is given by
(
10
2, 4, 1, 3) (2
5)
2
(1
5)
4
( 1
10)
1
( 3
10)
3
=
10!
2! 4! 1! 3! ⋅22
52 ⋅1
54 ⋅1
10 ⋅33
103
= 0.00870912 .
Summary: The multinomial distribution is a generalization of the binomial distribution from two (failure or
success) to m ≥2 possible results. In each single experiment, m different results may occur (e. g., m different
colors of balls) and each time the jth result, 1 ≤j ≤m, shows up with probability pj. If one executes the
experiment n times, then the multinomial distribution describes the probability of the following event: the

34
౪
1 Probabilities
first result occurs k1 times, the second k2 times, and so on. Here k1, . . . , km are some nonnegative integers
with k1 + ⋅⋅⋅+ km = n.
1.4.5 Poisson distribution
The sample space for this distribution is ℕ0 = {0, 1, 2, . . . }. Furthermore, λ > 0 is a given
parameter.
Proposition 1.4.27. There exists a unique probability measure Poisλ on 𝒫(ℕ0) such that
Poisλ({k}) = λk
k! e−λ ,
k ∈ℕ0 .
(1.25)
Proof. Because of e−λ > 0, Poisλ({k}) > 0 follows. Thus it suffices to verify
∞
∑
k=0
λk
k! e−λ = 1 .
But this is a direct consequence of
∞
∑
k=0
λk
k! e−λ = e−λ
∞
∑
k=0
λk
k! = e−λ eλ = 1 .
Definition 1.4.28. The probability measure Poisλ on 𝒫(ℕ0) satisfying Eq. (1.25) is called the Poisson
distribution with parameter λ > 0.
Compare Figure 1.5 for the values of the Poison distribution in the case λ = 5. Most likely
are the events k = 4 and k = 5.
Figure 1.5: The values Pois5({k}), k = 0, . . . , 15.

1.4 Special discrete probability measures
౪
35
The Poisson distribution describes experiments where the number of trials is big, but
the single success probability is small. More precisely, the following limit theorem holds.
Proposition 1.4.29 (Poisson’s limit theorem). Let (pn)∞
n=1 be a sequence of numbers with
0 < pn ≤1 and
lim
n→∞n pn = λ
for some λ > 0. Then for all k ∈ℕ0,
lim
n→∞Bn,pn({k}) = Poisλ({k}) .
Proof. Write
Bn,pn({k}) = (n
k) pk
n(1 −pn)n−k
= 1
k!
n (n −1) ⋅⋅⋅(n −k + 1)
nk
(n pn)k (1 −pn)n (1 −pn)−k
= 1
k![ n
n ⋅n −1
n
⋅⋅⋅n −k + 1
n
] (n pn)k (1 −pn)n (1 −pn)−k ,
and investigate the behavior of the different parts of the last equation separately. Each
fraction in the left-hand brackets tends to 1, hence the whole factor in brackets tends
to 1. By assumption, we have n pn →λ, thus, limn→∞(n pn)k = λk. Moreover, because of
n pn →λ with λ > 0, we get pn →0, which implies limn→∞(1 −pn)−k = 1.
Thus, it remains to determine the behavior of (1 −pn)n as n →∞. Proposition A.5.1
asserts that if a sequence of real numbers (xn)n≥1 converges to x ∈ℝ, then
lim
n→∞(1 + xn
n )
n
= ex .
Setting xn := −npn, by assumption xn →−λ, hence
lim
n→∞(1 −pn)n = lim
n→∞(1 + xn
n )
n
= e−λ .
If we combine all the different parts, then this completes the proof due to
lim
n→∞Bn,pn({k}) = 1
k! λk e−λ = Poisλ({k}) .
The previous theorem allows two conclusions:
(1) Whenever n is large and p is small, without hesitation one may replace Bn,p by Poisλ,
where λ = n ⋅p. In this way, one avoids the (sometimes) difficult evaluation of the bino-
mial coefficients.

36
౪
1 Probabilities
Example 1.4.30. In Example 1.4.13, we found the probability that among N students
there are at least two having their birthday on April 1. We then used the binomial distri-
bution with parameters N and p = 1/365. Hence the approximating Poisson distribution
has parameter λ = N/365 and the corresponding probability is given by
Poisλ({2, 3, . . .}) = 1 −(1 + λ)e−λ = 1 −(1 + N
365) e−N/365 .
If again N = 500, hence λ = 500/365, the approximate probability equals 0.397719. Com-
pare this value with the “precise” probability 0.397895 obtained in Example 1.4.13.
(2) Poisson’s limit theorem explains why the Poisson distribution describes experiments
with many trials and small success probability. For example, if we look for a model for
the number of car accidents per year, then the Poisson distribution is a good choice.
There are many cars, but the probability10 that a single driver is involved in an accident
is quite small.
Similarly, the Poisson distribution is used to model the number of customers enter-
ing some shop, to describe the number of phone calls arriving at a call center, or the
number of daily accesses to a website. This is due to the fact that there are many poten-
tial customers but with small probability a single one enters the shop. In the same way,
there are many people possessing a phone, but the probability that a single one calls a
certain center is very small.
Later on we will investigate other examples where the Poisson distribution appears
in a natural way.
Summary: The Poisson distribution Poisλ occurs as the limit of the binomial distribution Bn,p in the following
sense: the number n oftrialstends toinfinity whileatthe sametime thesuccessprobability p becomessmaller
and smaller. In other words, for large n and small success probability p, it follows that Bn,p(A) ≈Poisλ(A) with
λ = n p.
1.4.6 Hypergeometric distribution
Among N delivered machines M are defective. One chooses n of the N machines ran-
domly and checks them. What is the probability to observe m defective machines in the
sample of size n?
First note that there are (N
n) ways to choose n machines for checking. In order to
observe m defective ones, these have to be taken from the M defective. The remaining
n−m machines are nondefective, hence they must be chosen from the N−M nondefective
ones. There are (M
m) ways to take the defective machines and (N−M
n−m) possibilities for the
nondefective ones.
10 To call it a “success” probability in this case is perhaps not quite appropriate.

1.4 Special discrete probability measures
౪
37
Thus the following approach describes this experiment:
HN,M,n({m}) :=
(M
m) (N−M
n−m)
(N
n)
,
0 ≤m ≤n .
(1.26)
Recall that in Section A.3.1 we agreed that (n
k) = 0 whenever k > n. This turns out be
useful in the definition of HN,M,n. For example, if m > M, then the probability to observe
m defective machines is, of course, zero.
We want to prove now that eq. (1.26) defines a probability measure.
Proposition 1.4.31. There exists a unique probability measure HN,M,n on the powerset of
{0, . . . , n} satisfying eq. (1.26).
Proof. Vandermonde’s identity (cf. Proposition A.3.9) asserts that for all k, m, and n
in ℕ0,
k
∑
j=0
(n
j )( m
k −j) = (n + m
k
) .
(1.27)
Now replace n by M, next m by N −M, then k by n, and, finally, j by m. Doing so, eq. (1.27)
leads to
n
∑
m=0
(M
m)(N −M
n −m ) = (N
n) .
But this implies
n
∑
m=0
HN,M,n({m}) =
1
(N
n) ⋅
n
∑
m=0
(M
m)(N −M
n −m ) =
1
(N
n) ⋅(N
n) = 1 .
Clearly, HN,M,n({m}) ≥0, which completes the proof by virtue of Proposition 1.3.2.
Definition 1.4.32. The probability measure HN,M,n defined by eq. (1.26) is called the hypergeometric dis-
tribution with parameters N, M, and n.
Example 1.4.33. A retailer gets a delivery of 100 machines; 10 of them are defective. He
chooses 8 machines at random and tests them. Find the probability that 2 or more of the
tested machines are defective.
Answer: The desired probability is
8
∑
m=2
(10
m)( 90
8−m)
(100
8 )
= 0.18195 .
See Figure 1.6 for another example of a hypergeometric distribution. There are 40
defective machines among 100 and one checks a sample of size 15.

38
౪
1 Probabilities
Figure 1.6: Probabilities H100,40,15({m}) with m = 0, . . . , 15. The maximal value is about 0.224 attained at
m = 6. That is, if there are 40 defective items among 100, most likely in a sample of 15 there are 6 defective
ones.
Remark 1.4.34. In the daily practice, the opposite question is more important. The size
N of the delivery is known and, of course, also the size of the tested sample. The number
M of defective machines is unknown. Now suppose we observed m defective machines
among the n tested. Does this (random) number m lead to some information about the
number M of defective machines in the delivery? We will investigate this problem in
Proposition 8.5.16.
Example 1.4.35. In a pond there are 200 fish. One day the owner of the pond catches
20 fish, marks them, and puts them back into the pond. After a while the owner catches
once more 20 fish. Find the probability that among these fish there is exactly one
marked.
Answer: We have N = 200, M = 20, and n = 20. Hence the desired probability is
H200,20,20({1}) =
(20
1 )(180
19 )
(200
20 )
= 0.26967 .
Remark 1.4.36. The previous example is not very realistic because in general the num-
ber N of fish is unknown. Known are M and n, the (random) number m was observed.
Also here one may ask whether the knowledge of m leads to some information about N.
This question will be investigated later in Proposition 8.5.18.
Example 1.4.37. In a lottery, 6 numbers are chosen randomly out of 49. Suppose we
bought a lottery coupon with six numbers. What is the probability that exactly k,
k = 0, . . . , 6, of our numbers appear in the drawing?
Answer: There are n = 6 numbers randomly chosen out of N = 49. Among the 49
numbers, M = 6 are “defective.” These are the six numbers on our coupon, and we ask

1.4 Special discrete probability measures
౪
39
for the probability that k of the “defective” are among the chosen six. The question is
answered by the hypergeometric distribution H49,6,6, that is, the probability of k correct
numbers on our coupon is given by
H49,6,6({k}) =
(6
k)( 43
6−k)
(49
6 )
,
k = 0, . . . , 6 .
The numerical values of these probabilities for k = 0, . . . , 6 are
k
H49,6,6({k})
0
0.435965
1
0.413019
2
0.132378
3
0.0176504
4
0.00096862
5
0.0000184499
6
7.15112 ⋅10−8
Remark 1.4.38. Another model for the hypergeometric distribution is as follows: in an
urn there are N balls, M of them are white, the remaining N −M are red. Choose n balls
out of the urn without replacing the chosen ones. Then HN,M,n({m}) is the probability to
observe m white balls among the n chosen.
If we do the same experiment, but now replacing the chosen balls, then this is de-
scribed by the binomial distribution. The success probability for a white ball is p = M/N,
hence now the probability for m white balls is given by
Bn,M/N({m}) = (n
m)(M
N )
m
(1 −M
N )
n−m
.
It is intuitively clear that for large N and M (and comparably small n) the difference
between both models (replacing and nonreplacing) is insignificant. Imagine there are
106 white and also 106 red balls in an urn. When choosing two balls, it does not matter
a lot whether the first ball was replaced or not.
The next proposition makes the previous observation more precise.
Proposition 1.4.39. If 0 ≤m ≤n and 0 ≤p ≤1, then
lim
N,M→∞
M/N→p
HN,M,n({m}) = Bn,p({m}) .
Proof. Suppose first 0 < p < 1. Then the definition of the hypergeometric distribution
yields

40
౪
1 Probabilities
lim
N,M→∞
M/N→p
HN,M,n({m}) = lim
N,M→∞
M/N→p
M⋅⋅⋅(M−m+1)
m!
(N−M)⋅⋅⋅(N−M−(n−m)+1)
(n−m)!
N(N−1)⋅⋅⋅(N−n+1)
n!
= lim
N,M→∞
M/N→p
(n
m)
[ M
N ⋅⋅⋅( M−m+1
N
)][(1 −M
N ) ⋅⋅⋅(1 −M−(n−m)+1
N
)]
(1 −1
N ) ⋅⋅⋅(1 −n+1
N )
= (n
m)pm(1 −p)n−m = Bn,p({m}) .
(1.28)
Note that if either m = 0 or m = n, then the first or the second brackets in the second
line of eq. (1.28) become 1, thus they do not appear.
The cases p = 0 and p = 1 have to be treated separately. For example, if p = 0, the
fraction in the second line of eq. (1.28) converges to zero provided that m ≥1. If m = 0,
then
lim
N,M→∞
M/N→0
(1 −M
N ) ⋅⋅⋅(1 −M−n+1
N
)
(1 −1
N ) ⋅⋅⋅(1 −n+1
N )
= 1 = Bn,0({0}) .
The case p = 1 is treated similarly. Hence, the proposition is also valid in the border
cases.
Example 1.4.40. Suppose there are N = 200 balls in an urn. In the first table, there are
M = 80 white balls. Choosing n = 10 balls with or without replacement, we get the
following numerical values. Note that p = M/N = 2/5. In the second table, we execute
the same experiment, but now there are 100 white balls among 200.
m
H200,80,10({m})
B10,0.4({m})
1
0.0372601
0.0403108
2
0.118268
0.120932
3
0.217696
0.214991
4
0.257321
0.250823
5
0.204067
0.200658
6
0.10995
0.111477
7
0.0397376
0.0424673
8
0.00921879
0.0106168
9
0.0012395
0.00157286
m
H200,100,10({m})
B10,0.5({m})
1
0.00847281
0.00976563
2
0.0410287
0.0439453
3
0.115292
0.117188
4
0.2082
0.205078
5
0.25247
0.246094
6
0.2082
0.205078
7
0.115292
0.117188
8
0.0410287
0.0439453
9
0.00847281
0.00976563
Let us shortly analyze the table on the right. Here 50 % of the balls are white. Draw-
ing 10 balls, it is more likely to observe 4, 5, or 6 white balls in the case of nonreplacement,
while it is the other way around in the remaining cases 1, 2, 3, 7, 8, and 9. Try to find a
heuristic explanation for this phenomenon.

1.4 Special discrete probability measures
౪
41
Summary: The hypergeometric distribution may be viewed as a counterpart to the binomial distribution in
the following sense: in an urn there are M white balls and N −M black. Choosing randomly n balls without
replacement,
HN,M,n({m}) :=
(M
m) (N−M
n−m)
(N
n)
is the probability to observe m white balls. In contrast, the binomial distribution Bn,p with p = M/N applies in
the case of replacing the chosen balls. Of course, in this case the number N of balls does not matter, only the
proportion of white balls is of interest.
1.4.7 Geometric distribution
At first glance, the model for the geometric distribution looks as that for the binomial dis-
tribution. In each single trial, we may observe “0” or “1”, that is, failure or success. Again
the success probability is a fixed number p. While in the case of the binomial distribu-
tion we executed a fixed number of trials, now this number is random. More precisely,
we execute the experiment until we observe success for the first time. Recorded is the
number of necessary trials until this first success shows up. Or, in other words, a number
k ≥1 occurs if and only if the first k −1 trials were all failures and the kth one is a suc-
cess, that is, we observe the sequence (0, . . . , 0
⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟
k−1
, 1). Since failure appears with probability
1 −p and success shows up with probability p, the following approach is plausible:
Gp({k}) := p (1 −p)k−1 ,
k ∈ℕ.
(1.29)
Proposition 1.4.41. If 0 < p < 1, then (1.29) defines a probability measure on 𝒫(ℕ).
Proof. Because of p (1−p)k−1 > 0, it suffices to verify ∑∞
k=1 Gp({k}) = 1. Using the formula
for the sum of a geometric series, this follows directly from
∞
∑
k=1
p (1 −p)k−1 = p
∞
∑
k=0
(1 −p)k = p
1
1 −(1 −p) = 1 .
Observe that by assumption 1 −p < 1, thus the formula for the geometric series
applies.
Definition 1.4.42. The probability measure Gp on 𝒫(ℕ) defined by Eq. (1.29) is called the geometric
distribution with parameter p.
If p = 0, then success will never show up, thus, Gp is not a probability measure. On
the other hand, for p = 1, success appears with probability one in the first trial, that is,
Gp = δ1. Therefore, this case is of no interest.

42
౪
1 Probabilities
Remark 1.4.43. Some authors define the geometric distribution in a slightly different
way. They ask for the probability for the first success in the (k+1)th trial. This is described
by
̃Gp({k}) := p (1 −p)k ,
k ∈ℕ0 .
To our opinion, the shift by 1 is a little bit confusing. Therefore, we decided to define the
geometric distribution as we did in eq. (1.29).
Example 1.4.44. Given a number n ∈ℕ, let An = {k ∈ℕ: k > n}. Find Gp(An).
Answer: We answer this question by two different approaches.
At first, we remark that An occurs if and only if the first success shows up strictly
after n trials or, equivalently, if and only if the first n trials were all failures. But this
event has probability Bn,p({0}) = (1 −p)n, hence Gp(An) = (1 −p)n.
In the second approach, we use eq. (1.29) directly and obtain
Gp(An) =
∞
∑
k=n+1
Gp({k}) = p
∞
∑
k=n+1
(1 −p)k−1 = p (1 −p)n
∞
∑
k=0
(1 −p)k
= p (1 −p)n
1
1 −(1 −p) = (1 −p)n .
Example 1.4.45. Roll a die until number “6” occurs for the first time. What is the prob-
ability that this happens in roll k?
Answer: The success probability is 1/6, hence the probability of the first occurrence
of “6” in the kth trial is (1/6)(5/6)k−1.
k
G1/6({k})
1
0.166667
2
0.138889
3
0.115741
...
...
12
0.022431
13
0.018693
Example 1.4.46. Roll a die until the first “6” shows up. What is the probability that this
happens at an even number of trials?
Answer: The first “6” has to appear in the second, or fourth, or sixth, and so on, trial.
Hence, the probability of this event is
∞
∑
k=1
G1/6({2k}) = 1
6
∞
∑
k=1
(5/6)2k−1 = 5
36
∞
∑
k=1
(5/6)2k−2 = 5
36
1
1 −(5/6)2 = 5
11 .

1.4 Special discrete probability measures
౪
43
Example 1.4.47. Play a series of games where p is the chance of winning. Whenever
you put x dollars into the pool you get back 2x dollars if you win. If you lose, then the x
dollars are lost.
Apply the following strategy. After losing, double the amount in the pool in the next
game. Say you start with $1 and lose, then next time put $2 into the pool, then $4, and
so on until you win for the first time. As easily seen, in the kth game, the stakes are 2k−1
dollars.
Suppose for some k ≥1 you lost k −1 games and won the kth one. How much money
did you lose? If k = 1, then you lost nothing, while for k ≥2 you spent
1 + 2 + 4 + ⋅⋅⋅+ 2k−2 = 2k−1 −1
dollars. Note that 2k−1 −1 = 0 if k = 1, hence for all k ≥1 the total loss is 2k−1 −1 dollars.
On the other hand, if you win the kth game, you gain 2k−1 dollars. Consequently, no
matter what the results are, you will always win 2k−1 −(2k−1 −1) = 1 dollar.11
Let X be the amount of money needed to follow this strategy. One needs 1 dollar to
play the first game, 1 + 2 = 3 dollars to play the second, until
1 + 2 + 4 + ⋅⋅⋅+ 2k−1 = 2k −1
to play the kth game. Thus, in this case we have X = 2k −1 and
ℙ{X = 2k −1} = ℙ{first win in game k} = p(1 −p)k−1 ,
k = 1, 2, . . .
In particular, if p = 1/2 then this probability equals 2−k. For example, if one starts the
game with 127 = 27 −1 dollars in the pocket, then one goes bankrupt if the first success
appears after game 7. The probability for this equals ∑∞
k=8 2−k = 2−7 = 0.0078125.
1.4.8 Negative binomial distribution
The geometric distribution describes the probability for having the first success in trial
k. Given a fixed n ≥1, we ask now for the probability that in trial k success appears not
for the first but for the nth time. Of course, this question makes only sense if k ≥n. But
how to determine this probability for those k?
Thus, take k ≥n and suppose we had success in trial k. When is this the nth one? This
is the case if and only if we had n−1 successes during the first k −1 trials or, equivalently,
k −n failures. There exist (k−1
k−n) possibilities to distribute the k −n failures among the
first k −1 trials. Furthermore, the probability for n successes is pn and for k −n failures
11 Starting the first game with x dollars, one will always win x dollars no matter what happens.

44
౪
1 Probabilities
it is (1 −p)k−n, hence the probability for observing the nth success in trial k is given by
B−
n,p({k}) := (k −1
k −n)pn (1 −p)k−n ,
k = n, n + 1, . . .
(1.30)
We still have to verify that there is a probability measure satisfying eq. (1.30).
Proposition 1.4.48. By
B−
n,p({k}) = (k −1
k −n)pn (1 −p)k−n ,
k = n, n + 1, . . . ,
a probability measure B−
n,p on 𝒫({n, n + 1, . . . }) is defined.
Proof. Of course, B−
n,p({k}) ≥0. Hence it remains to show
∞
∑
k=n
B−
n,p({k}) = 1
or, equivalently,
∞
∑
k=0
B−
n,p({k + n}) = 1 .
(1.31)
Because of Proposition A.3.11, we get
B−
n,p({k + n}) = (n + k −1
k
) pn (1 −p)k
= (−n
k )pn (−1)k (1 −p)k = (−n
k )pn (p −1)k ,
(1.32)
where the generalized binomial coefficient is defined in eq. (A.14) as
(−n
k ) = −n(−n −1) ⋅⋅⋅(−n −k + 1)
k!
.
In Proposition A.5.2, we proved for |x| < 1 that
∞
∑
k=0
(−n
k ) xk =
1
(1 + x)n .
(1.33)
Note that 0 < p < 1, hence eq. (1.33) applies with x = p −1 and leads to
∞
∑
k=0
(−n
k ) (p −1)k = 1
pn .
(1.34)
Combining eqs. (1.32) and (1.34) implies
∞
∑
k=0
B−
n,p({k + n}) = pn
∞
∑
k=0
(−n
k ) (p −1)k = pn 1
pn = 1 ,
thus the equations in (1.31) are valid and this completes the proof.

1.4 Special discrete probability measures
౪
45
Definition 1.4.49. The probability measure B−
n,p with
B−
n,p({k}) := (k −1
k −n)pn (1 −p)k−n = (k −1
n −1)pn (1 −p)k−n,
k = n, n + 1, . . .
is called the negative binomial distribution with parameters n ≥1 and p ∈(0, 1). Of course, B−
1,p = Gp.
Remark 1.4.50. We saw in eq. (1.32) that
B−
n,p({k + n}) = (n + k −1
k
)pn (1 −p)k = (−n
k )pn (p −1)k .
(1.35)
Alternatively, one may define the negative binomial distribution also via Eq. (1.35). Then
it describes the event that the nth success appears in trial n + k. The advantage of this
approach is that now k ∈ℕ0, that is, the restriction k ≥n is no longer needed. Its
disadvantage is that we are interested in what happens in trial k, not in trial k + n.
Example 1.4.51. Roll a die successively. Determine the probability that in the 20th trial
number “6” appears for the fourth time.
Answer: We have p = 1/6, n = 4, and k = 20. Therefore, the probability for this event
is given by
B−
4,1/6({20}) = (19
16) ( 1
6)
4
(5
6)
16
= 0.0404407 .
Let us ask now for the probability that the fourth success appears (strictly) before trial
21. This probability is given by
20
∑
k=4
(k −1
3 )( 1
6)
4
(5
6)
k−4
= 0.433454 .
Example 1.4.52. There are two urns, say U0 and U1, each containing N balls. Choose one
of the two urns at random and take out a ball. Hereby U0 is chosen with probability 1−p,
hence U1 with probability p. Repeat the procedure until we choose the last (the Nth) ball
out of one of the urns. What is the probability that there are m balls left in the other urn,
where m = 1, . . . , N?
Answer: For m = 1, . . . , N let Am be the event that there are still m balls in one of the
urns when choosing the last ball out of the other. Then Am splits into the disjoint events
Am = A0
m ∪A1
m, where
–
A0
m occurs if we take the last ball out of U0 and U1 contains m balls, and
–
A1
m occurs choosing the Nth ball out of U1 with m balls remaining in U0.
Let us start with evaluating the probability of A1
m. Say success occurs if we choose urn U1.
Thus, if we take out the last ball of urn U1, then success occurred for the Nth time. On
the other hand, if there are still m balls in U0, then failure had occurred N −m times.

46
౪
1 Probabilities
Consequently, there are still m balls left in urn U0 if and only if the Nth success shows
up in trial N + (N −m) = 2N −m. Therefore, we get
ℙ(A1
m) = B−
N,p({2N −m}) = (2N −m −1
N −m
) pN (1 −p)N−m .
(1.36)
The probability of A0
m may be derived from that of A1
m by interchanging p and 1 −p
(success occurs now with probability 1 −p). This yields
ℙ(A0
m) = B−
N,1−p({2N −m}) = (2N −m −1
N −m
) pN−m (1 −p)N .
(1.37)
Adding eqs. (1.36) and (1.37) leads to
ℙ(Am) = (2N −m −1
N −m
)[pN (1 −p)N−m + pN−m (1 −p)N] ,
for m = 1, . . . , N.
If p = 1/2, that is, both urns are equally likely, the previous formula simplifies to
ℙ(Am) = (2N −m −1
N −m
) 2−2N+m+1 = (2N −m −1
N −1
) 2−2N+m+1 .
(1.38)
Remark 1.4.53. The case p = 1/2 in the previous problem is known as Banach’s match-
box problem. In each of two matchboxes, there are N matches. One chooses randomly a
matchbox (both boxes are equally likely) and takes out a match. What is the probability
that there are still m matches left in the other box when taking the last match out of one
of the boxes? The answer is given by eq. (1.38).
Remark 1.4.54. There exists a slightly different version of Banach’s matchbox problem.
Here one asks for the probability of the event ̃Am which occurs provided that there are
m matches left in one of the boxes when choosing for the first time an empty one. Note
that in this setting also m = 0 makes sense. To answer this modified problem, one has to
ask in the previous calculations for the (N +1)th success instead of the Nth one. In doing
so, one obtains
ℙ( ̃Am) = (2N −m
N −m ) 2−2N+m = (2N −m
N
) 2−2N+m ,
m = 0, . . . , N .
See Figure 1.7 for the values of these probabilities in the case N = 20.
What is more likely at the moment when choosing for the first time an empty box:
the unchosen box contains one match or it contains none?
The answer is that both events are equally likely. This follows from
ℙ( ̃A0) = (2N
N ) 2−2N = (2N)!
(N!)2 2−2N = 2N
N
(2N −1)!
N!(N −1)! 2−2N
= (2N −1
N −1 ) 2−2N+1 = ℙ( ̃A1) .

1.4 Special discrete probability measures
౪
47
Figure 1.7: Probabilities for 0 ≤m ≤20 matches left in one box when choosing for the first time an empty
one. At the beginning, both boxes contained N = 20 matches.
Example 1.4.55. We continue Example 1.4.52 with 0 < p < 1 and ask the following ques-
tion: What is the probability that U1 becomes empty before U0?
Answer: This happens if and only if U0 is nonempty when choosing U1 for the Nth
time, that is, when in U0 there are m balls left for some m = 1, . . . , N. Because of eq. (1.36),
this probability is given by
N
∑
m=1
ℙ(A1
m) = pN
N
∑
m=1
(2N −m −1
N −m
) (1 −p)N−m
= pN
N−1
∑
k=0
(N + k −1
k
) (1 −p)k .
(1.39)
Remark 1.4.56. Formula (1.39) leads to an interesting (known) property of the binomial
coefficients. Since ∑N
m=1 ℙ(Am) = 1 , by eqs. (1.39) and (1.37), we obtain
N−1
∑
k=0
(N + k −1
k
)[pN (1 −p)k + (1 −p)N pk] = 1
or, setting n = N −1, to
n
∑
k=0
(n + k
k
)[pn+1 (1 −p)k + (1 −p)n+1 pk] = 1 .
In particular, if p = 1/2, this yields
n
∑
k=0
(n + k
k
) 1
2k = 2n ,
n = 0, 1, 2, . . .

48
౪
1 Probabilities
Summary: One executes independently arbitrarily many experiments where either success or failure may
occur. Hereby, the success probability equals 0 < p < 1. The probability to observe the nth success in trial
k ≥n is given by the negative binomial distribution B−
n,p defined by
B−
n,p({k}) := (k −1
k −n)pn (1 −p)k−n = (k −1
n −1)pn (1 −p)k−n ,
k = n, n + 1, . . .
Equivalently, when one asks for the nth success in trial n + ℓ, then
B−
n,p({n + ℓ}) = (−n
ℓ)pn (p −1)ℓ,
ℓ= 0, 1, 2, . . .
If n = 1, that is, one looks for the first success, then Gp = B−
1,p is called the geometric distribution, and
Gp({k}) = p (1 −p)k−1 ,
k = 1, 2, . . .
1.5 Continuous probability measures
Discrete probability measures are inappropriate for the description of random experi-
ments where uncountably many different results may appear. Typical examples of such
experiments are the lifetime of an item, the duration of a phone call, the measuring
result of workpiece, and so on.
Discrete probability measures are concentrated on a finite or countably infinite set
of points. An extension to larger sets is impossible. For example, there is no12 probability
measure ℙon [0, 1] with ℙ({t}) > 0 for t ∈[0, 1].
Consequently, in order to describe random experiments with “many” possible dif-
ferent outcomes, another approach is needed. To explain this “new” approach, let us
shortly recall how we evaluated ℙ(A) in the discrete case. If Ω is either finite or count-
ably infinite and if p(ω) = ℙ({ω}), ω ∈Ω, then with this p : Ω →ℝwe have
ℙ(A) = ∑
ω∈A
p(ω) .
(1.40)
If the sample space is ℝor ℝn, then such a representation is no longer possible. Indeed, if
ℙis not discrete, then, we will have p(ω) = 0 for all possible observations ω. Therefore,
the sum in eq. (1.40) has to be replaced by an integral over a more general function.
We start with introducing functions p, which may be used for representing ℙ(A) via an
integral.
12 Compare with Problem 1.38.

1.5 Continuous probability measures
౪
49
Definition 1.5.1. A Riemann integrable function p : ℝ→ℝis called a probability density function, or
simply a density function, if
p(x) ≥0 , x ∈ℝ,
and
∞
∫
−∞
p(x) dx = 1 .
(1.41)
Remark 1.5.2. Let us formulate more precisely the second condition for p in the previ-
ous definition. For all finite intervals [a, b] in ℝ, the function p is Riemann integrable on
[a, b] and, moreover,
lim
a→−∞
b→∞
b
∫
a
p(x) dx = 1 .
The density functions we will use later on are either continuous or piecewise continu-
ous, that is, they are compositions of finitely many continuous functions. These functions
are Riemann integrable, hence in this case it remains to verify the two conditions (1.41).
Example 1.5.3. Define p on ℝby p(x) = 0 if x > 0 and by p(x) = e−x if x ≥0. Then p is
piecewise continuous, p(x) ≥0 if x ∈ℝ, and it satisfies
∞
∫
−∞
p(x)dx = lim
b→∞
b
∫
0
e−x dx = lim
b→∞[−e−x]
b
0 = 1 −lim
b→∞e−b = 1 .
Hence, p is a density function.
Definition 1.5.4. Let p be a probability density function. Given a finite interval [a, b], its probability (of
occurrence) is defined by
ℙ([a, b]) :=
b
∫
a
p(x)dx .
A graphical presentation of the previous definition is as follows. As visualized in Fig-
ure 1.8, the probability ℙ([a, b]) is the area under the graph of the density p, taken from
a to b.
Let us illustrate Definition 1.5.4 with the density function regarded in Example 1.5.3.
Then
ℙ([a, b]) =
b
∫
a
e−xdx = [−e−x]
b
a = e−a −e−b
whenever 0 ≤a < b < ∞. On the other hand, if a < b < 0, then ℙ([a, b]) = 0 while for
a < 0 ≤b the probability of [a, b] is calculated by
ℙ([a, b]) = ℙ([0, b]) = 1 −e−b .

50
౪
1 Probabilities
Figure 1.8: The size of the gray shaded area defines the probability of the interval [a, b].
Remark 1.5.5. Definition 1.5.4 of the probability measure ℙdoes not fit into the scheme
presented in Section 1.1.3. Why? Probability measures are defined on σ-fields. But the
collection of finite intervals in ℝis not a σ-field. It is neither closed under taking com-
plements nor is the union of intervals in general again an interval. Furthermore, it is far
from being clear in which sense ℙshould be σ-additive.
The next result justifies the approach in Definition 1.5.4. Its proof rests upon an ex-
tension theorem in Measure Theory (cf. [Bau01, Coh13] or [Dud02]).
Proposition 1.5.6. Let ℬ(ℝ) be the σ-field of Borel sets introduced in Definition 1.1.20.
Then for each density function p, there exists a unique probability measure ℙon ℬ(ℝ)
such that
ℙ([a, b]) =
b
∫
a
p(x) dx
for all a < b .
(1.42)
Definition 1.5.7. A probability measure ℙon ℬ(ℝ) is said to be continuous provided that there exists a
density function p such that for a < b,
ℙ([a, b]) =
b
∫
a
p(x) dx .
(1.43)
The function p is called a density function, or simply density, of ℙ.
Remark 1.5.8. The mathematically correct name would be “absolutely continuous”. But
since we do not treat so-called “singularly continuous” probability measures, there is
no need to distinguish between them, and we may shorten the notation to “continu-
ous.”
Remark 1.5.9. Note that changing the density function at finitely many points does not
change the generated probability measure. For instance, if we define p(x) = 0 if x ≤0
and p(x) = e−x if x > 0, then this density function is different from that in Example 1.5.3
but, of course, generates the same probability measure.

1.5 Continuous probability measures
౪
51
Moreover, observe that eq. (1.43) is valid for all a < b if and only if for each t ∈ℝ,
ℙ((−∞, t]) =
t
∫
−∞
p(x) dx .
(1.44)
Consequently, ℙis continuous if and only if there is a density p with eq. (1.44) for t ∈ℝ.
Proposition 1.5.10. Let ℙ: ℬ(ℝ) →[0, 1] be a continuous probability measure with den-
sity p. Then the following are valid:
1.
ℙ(ℝ) = 1.
2.
For each t ∈ℝ, one has ℙ({t}) = 0. More generally, if A ⊆ℝis either finite or countably
infinite, then ℙ(A) = 0.
3.
For all a < b, we have
ℙ((a, b)) = ℙ((a, b]) = ℙ([a, b)) = ℙ([a, b]) =
b
∫
a
p(x) dx .
Proof. Let us start with proving ℙ(ℝ) = 1. For n ≥1, set An := [−n, n] and note that
A1 ⊆A2 ⊆⋅⋅⋅, as well as ⋃∞
n=1 An = ℝ. Thus we may use that ℙis continuous from below
and, by the properties of the density p, we obtain
ℙ(ℝ) = lim
n→∞ℙ(An) = lim
n→∞
n
∫
−n
p(x) dx =
∞
∫
−∞
p(x) dx = 1 .
To verify the second property, fix t ∈ℝand define for each n ≥1 the intervals Bn by
Bn := [t, t + 1
n]. Now we have B1 ⊇B2 ⊇⋅⋅⋅and ⋂∞
n=1 Bn = {t}. Use this time the continuity
from above. Then we get
ℙ({t}) = lim
n→∞ℙ(Bn) = lim
n→∞
t+ 1
n
∫
t
p(x) dx = 0 .
If A = {t1, t2, . . .}, then the σ-additivity of ℙ, together with ℙ({tj}) = 0, gives
ℙ(A) =
∞
∑
j=1
ℙ({tj}) = 0,
as asserted.
The third property is an immediate consequence of the second. Observe
[a, b] = (a, b) ∪{a} ∪{b} ,
hence ℙ([a, b]) = ℙ((a, b))+ℙ({a})+ℙ({b}), proving (1.43) due to ℙ({a}) = ℙ({b}) = 0.

52
౪
1 Probabilities
Remark 1.5.11. Say a set C ⊆ℝcan be represented as C = ⋃∞
j=1 Ij with disjoint (open or
half-open or closed) intervals Ij, then
ℙ(C) =
∞
∑
j=1
∫
Ij
p(x) dx := ∫
C
p(x) dx .
More generally, if a set B may be written as B = ⋂∞
n=1 Cn where the Cns are unions of
disjoint intervals and satisfy C1 ⊇C2 ⊇⋅⋅⋅, then
ℙ(B) = lim
n→∞ℙ(Cn) .
In this way, one may evaluate ℙ(B) for a large class of subsets B ⊆ℝ.
Summary: There are two completely different types of probability measures:
[ℙdiscrete
⇔
ℙ([a, b]) =
∑
a≤ω≤b
ℙ({ω})]
and
[
[
ℙcontinuous
⇔
ℙ([a, b]) =
b
∫
a
p(x) dx]
]
.
1.6 Special continuous distributions
1.6.1 Uniform distribution on an interval
Let I = [α, β] be a finite interval of real numbers. Define a function p : ℝ→ℝby
p(x) := {
1
β−α
if x ∈[α, β],
0
if x ∉[α, β].
(1.45)
Proposition 1.6.1. The mapping p defined by eq. (1.45) is a probability density function.
Proof. Note that p is piecewise continuous, hence Riemann integrable. Moreover,
p(x) ≥0 for x ∈ℝand
∞
∫
−∞
p(x) dx =
β
∫
α
1
β −α dx =
1
β −α(β −α) = 1 .
Consequently, p is a probability density.
Definition 1.6.2. The probability measure ℙgenerated by the density in eq. (1.45) is called the uniform
distribution on the interval I = [α, β].

1.6 Special continuous distributions
౪
53
How is ℙ([a, b]) evaluated for some interval [a, b]? Let us first treat the case that
[a, b] ⊆I. Then
ℙ([a, b]) =
b
∫
a
1
β −α dx = b −a
β −α = Length of [a, b]
Length of [α, β] .
(1.46)
This explains why ℙis called the “uniform distribution.” The probability of an interval
[a, b] ⊆I depends only on its length, not on its position. Shifting [a, b] inside I does not
change its probability of occurrence (compare Figure 1.9).
Figure 1.9: If ℙis the uniform distribution on [α, β], then ℙ([a, b]) = ℙ([a′, b′]).
If [a, b] is arbitrary, not necessarily contained in I, then ℙ([a, b]) can be easily cal-
culated by
ℙ([a, b]) = ℙ([a, b] ∩I) .
Example 1.6.3. Let ℙbe the uniform distribution on [0, 1]. Which probabilities do
[−1, 0.5], [0, 0.25] ∪[0.75, 1], (−∞, t] if t ∈ℝ, and A ⊆ℝ, where A = ⋃∞
n=1[
1
2n+1/2 , 1
2n ], have?
Answer: The first two intervals have probability 1
2. If t ∈ℝ, then
ℙ((−∞, t]) =
{
{
{
{
{
{
{
0
if t < 0,
t
if 0 ≤t ≤1,
1
if t > 1.
Finally, observe that the intervals [
1
2n+1/2 , 1
2n ] are disjoint subsets of [0, 1]. Hence we get
ℙ(A) =
∞
∑
n=1
[ 1
2n −
1
2n+1/2 ] = (1 −2−1/2)
∞
∑
n=1
1
2n = 1 −2−1/2.
Example 1.6.4. A stick of length L is randomly broken into two pieces. Find the proba-
bility that the size of one piece is at least twice that of the other.
Answer: This event happens if and only if the point at which the stick is broken is
either in [0, L/3] or in [2L/3, L]. Assuming that the point at which the stick is broken is
uniformly distributed on [0, L], the desired probability is 2
3. Another way to get this result
is as follows. The size of each piece is less than twice as that of the other if the point at

54
౪
1 Probabilities
which the stick is broken is in [L/3, 2L/3]. Hence, the probability of the complementary
event is 1/3, leading again to 2/3 for the desired probability.
Example 1.6.5. Choose at random a real number uniformly distributed in [−1, 1]. How
likely is it that its square is less than 1/4?
Answer: A number x ∈[−1, 1] satisfies x2 ≤1/4 if and only if −1/2 ≤x ≤1/2. Hence,
if A is the event that the square is less than 1/4, then
ℙ(A) =
Length of [−1
2, 1
2]
Length of [−1, 1] = 1
2 .
Example 1.6.6. Let C0 := [0, 1]. Extract from C0 the interval ( 1
3, 2
3), thus there remains
C1 = [0, 1
3] ∪[ 2
3, 1]. To construct C2, extract from C1 the two middle intervals ( 1
9, 2
9) and
( 7
9, 8
9), hence C2 = [0, 1
9] ∪[ 2
9, 1
3] ∪[ 2
3, 7
9] ∪[ 8
9, 1].
Suppose that through this method we already got the set Cn which is a union of
2n disjoint closed intervals of length 3−n. In order to construct Cn+1, split each of the 2n
intervals into three intervals of length 3−n−1 and erase the middle one. In this way, we
get Cn+1, which consists of 2n+1 disjoint intervals of length 3−n−1. Finally, one defines
C =
∞
⋂
n=1
Cn .
The set C is known as the Cantor set. Let ℙbe the uniform distribution on [0, 1]. Which
value does ℙ(C) have?
Answer: First observe that C0 ⊃C1 ⊃C2 ⊃⋅⋅⋅, hence, using that ℙis continuous
from above, it follows that
ℙ(C) = lim
n→∞ℙ(Cn) .
(1.47)
The set Cn is a disjoint union of 2n intervals of length 3−n. Consequently, it follows that
ℙ(Cn) = 2n
3n , which by eq. (1.47) implies ℙ(C) = 0.
One might conjecture that C = 0. On the contrary, C is even uncountably infinite. To
see this, we have to make the construction of the Cantor set a little bit more precise.
Given n ≥1, let
An = {α = (α1, . . . , αn) : α1, . . . , αn−1 ∈{0, 2}, αn = 1} .
If α = (α1, . . . , αn) ∈An, set xα = ∑n
k=1
αk
3k and Iα = (xα, xα + 1
3n ). In this notation,
I(1) = ( 1
3, 2
3),
I(0,1) = ( 1
9, 2
9),
I(2,1) = (7
9, 8
9),
and
I(0,0,1) = ( 1
27, 2
27).
Then, if C0 = [0, 1], for n ≥1 we have

1.6 Special continuous distributions
౪
55
Cn = Cn−1 \ ⋃
α∈An
Iα,
hence C = [0, 1] \
∞
⋃
n=1
⋃
α∈An
Iα .
Take now any sequence x1, x2, . . . with xk ∈{0, 2} and set x = ∑∞
k=1
xk
3k . Then x cannot
belong to any Iα because otherwise at least one of the xks should satisfy xk = 1. Thus
x ∈C, and the number of x that may be represented by xks with xk ∈{0, 2} is uncountably
infinite.
Summary: The uniform distribution ℙon an interval I = [α, β] is characterized by the following property: if
[a, b] ⊆I, then
ℙ([a, b]) =
b
∫
a
1
β −α dx = b −a
β −α = Length of [a, b]
Length of [α, β] .
1.6.2 Normal distribution
This section is devoted to the most important probability measure, the normal distribu-
tion. Before we can introduce it, we need the following result.
Proposition 1.6.7. We have
∞
∫
−∞
e−x2/2 dx = √2 π.
(1.48)
Proof. Set
a :=
∞
∫
−∞
e−x2/2 dx
and note that a > 0. Then we get
a2 = (
∞
∫
−∞
e−x2/2 dx) (
∞
∫
−∞
e−y2/2 dy) =
∞
∫
−∞
∞
∫
−∞
e−(x2+y2)/2 dx dy .
Change the variables in the right-hand double integral as follows: x := r cos θ and
y := r sin θ, where 0 < r < ∞and 0 ≤θ < 2π. Observe that
dx dy = 󵄨󵄨󵄨󵄨D(r, θ)󵄨󵄨󵄨󵄨dr dθ
with
D(r, θ) = det (
𝜕x
𝜕r
𝜕x
𝜕θ
𝜕y
𝜕r
𝜕y
𝜕θ
) = det ( cos θ
−r sin θ
sin θ
r cos θ ) = r cos2 θ + r sin2 θ = r .

56
౪
1 Probabilities
Using x2 + y2 = r2 cos2 θ + r2 sin2 θ = r2, this change of variables leads to
a2 =
2π
∫
0
∞
∫
0
r e−r2/2 dr dθ =
2π
∫
0
[−e−r2/2]
∞
0 dθ = 2π ,
which, due to a > 0, implies a = √2π. This completes the proof.
Given μ ∈ℝand σ > 0, let
pμ,σ(x) :=
1
√2πσ
e−(x−μ)2/2σ2
,
x ∈ℝ.
(1.49)
Remark 1.6.8. The graph of the function x 󳨃→pμ,σ(x) is “bell-shaped,” has its maximal
value 1/√2πσ at x = μ, attains only positive values, and is symmetric around x = μ. If
x →∞or x →−∞, then pμ,σ(x) tends to zero very rapidly. The bigger the σ > 0, the
flatter the graph of pμ,σ. Nevertheless, as we will show in the next proposition, the area
under the graph of pμ,σ always equals 1, no matter how big or small σ > 0 is (compare
also Figure 1.10).
Figure 1.10: The function pμ,σ with parameters μ = 0, 1, 2, 3 and σ = 0.5, 0.75, 0.9, 1.1.
Proposition 1.6.9. If μ ∈ℝand σ > 0, then pμ,σ is a probability density function.
Proof. We have to verify
∞
∫
−∞
pμ,σ(x) dx = 1,
or
∞
∫
−∞
e(x−μ)2/2σ2
dx = √2π σ .
Setting u := (x −μ)/σ, it follows that dx = σ du, hence Proposition 1.6.7 leads to
∞
∫
−∞
e(x−μ)2/2σ2
dx = σ
∞
∫
−∞
e−u2/2 du = σ √2π .
This completes the proof.

1.6 Special continuous distributions
౪
57
Definition 1.6.10. The probability measure generated by pμ,σ is called the normal distribution with
expected value μ and variance σ2. It is denoted by 𝒩(μ, σ2), that is, for all a < b,
𝒩(μ, σ2)([a, b]) =
1
√2πσ
b
∫
a
e−(x−μ)2/2σ2
dx .
Remark 1.6.11. At this moment, the numbers μ ∈ℝand σ > 0 are nothing else than pa-
rameters. Why they are called “expected value” and “variance” will become clear after
we introduce these notations in Section 5.
Definition 1.6.12. The probability measure 𝒩(0, 1) is called the standard normal distribution. It is
given by
𝒩(0, 1)([a, b]) =
1
√2π
b
∫
a
e−x2/2 dx .
Figure 1.11: The area of the gray shaded region coincides with 𝒩(0, 1)([a, b]).
For example, we have
𝒩(0, 1)([−1, 1]) =
1
√2π
1
∫
−1
e−x2/2 dx = 0.682689,
or
𝒩(0, 1)([2, 4]) =
1
√2π
4
∫
2
e−x2/2 dx = 0.0227185 .
Summary: The normal distribution with expected value μ ∈ℝand variance σ2 > 0 acts as
𝒩(μ, σ2)([a, b]) =
1
√2πσ
b
∫
a
e−(x−μ)2/2σ2
dx .
The probability measure 𝒩(0, 1) is called the standard normal distribution.

58
౪
1 Probabilities
1.6.3 Gamma distribution
Euler’s gamma function is a mapping from (0, ∞) to ℝdefined by
Γ(x) :=
∞
∫
0
sx−1e−sds ,
x > 0 .
The graph of the gamma function for small entries is drawn in Figure 1.12.
Figure 1.12: The graph of the gamma function.
Let us summarize the main properties of the gamma function.
Proposition 1.6.13.
1.
The gamma function maps (0, ∞) continuously to (0, ∞) and possesses continuous
derivatives of any order.
2.
If x > 0, then
Γ(x + 1) = x Γ(x) .
(1.50)
3.
For n ∈ℕ, it follows that Γ(n) = (n −1)!. In particular,
Γ(1) = Γ(2) = 1
and
Γ(3) = 2 .
4.
One has Γ(1/2) = √π, which implies
Γ(n + 1
2) = (2n −1)!!
2n
√π ,
n = 1, 2, . . .
(1.51)
Here the double factorial is defined by (2n −1)!! = (2n −1)(2n −3) ⋅⋅⋅3 ⋅1.
Proof. For the proof of the continuity and differentiability, we refer to [Art64].
The proof of eq. (1.50) is carried out by integration by parts as follows:
Γ(x + 1) =
∞
∫
0
sx e−sds = [−sx e−s]
∞
0 +
∞
∫
0
x sx−1e−sds = x Γ(x) .

1.6 Special continuous distributions
౪
59
Note that sxe−s = 0 if s = 0 or s →∞.
From
Γ(1) =
∞
∫
0
e−sds = 1
and eq. (1.50), it follows, as claimed, that
Γ(n) = (n −1)Γ(n −1) = (n −1)(n −2)Γ(n −2) = ⋅⋅⋅= (n −1) ⋅⋅⋅1 ⋅Γ(1) = (n −1)! .
To prove the fourth assertion, we use Proposition 1.6.7. Because of
√2π =
∞
∫
−∞
e−t2/2dt = 2
∞
∫
0
e−t2/2dt,
it follows that
∞
∫
0
e−t2/2dt = √π
2 .
(1.52)
Substituting s = t2/2, thus ds = tdt, by eq. (1.52), the integral for Γ(1/2) transforms
into
Γ(1/2) =
∞
∫
0
s−1/2e−sds =
∞
∫
0
√2
t e−t2/2 t dt = √2
∞
∫
0
e−t2/2dt = √π .
Formula (1.51) follows by a repeated application of eq. (1.50). Indeed, then we get
Γ(n + 1
2) = 2n −1
2
⋅Γ(n −1
2)
= 2n −1
2
⋅2n −3
2
⋅Γ(n −3
2) = ⋅⋅⋅= (2n −1)!!
2n
Γ(1
2) .
This completes the proof.
If x →∞, then Γ(x) increases very rapidly. More precisely, the following is valid
(cf. [Art64]):
Proposition 1.6.14 (Stirling’s formula for the gamma function). For x > 0, there exists a
number θ ∈(0, 1) such that
Γ(x) = √2π
x (x
e )
x
eθ/12x .
(1.53)

60
౪
1 Probabilities
In view of
n! = Γ(n + 1) = nΓ(n),
formula (1.53) leads to13 the following.
Corollary 1.6.15 (Stirling’s formula for n-factorial). For each natural number n, there is
some θ ∈(0, 1) depending on n such that
n! = √2πn (n
e )
n
eθ/12n .
(1.54)
In particular, we have
lim
n→∞
en
nn+1/2 n! = √2π .
Our next aim is to introduce a continuous probability measure with density tightly
related to the Γ-function. Given α, β > 0, define pα,β from ℝto ℝby (see Figure 1.13 for
some examples)
pα,β(x) :=
{
{
{
0
if x ≤0,
1
αβ Γ(β) xβ−1e−x/α
if x > 0.
(1.55)
Figure 1.13: The functions p1,β with β = 0.5, 1, 1.5, 2 and 2.5 from top left to bottom left.
Proposition 1.6.16. For all α, β > 0, the function pα,β in eq. (1.55) is a probability density.
Proof. Of course, pα,β(x) ≥0. Thus it remains to verify
∞
∫
−∞
pα,β(x) dx = 1 .
(1.56)
13 cf. also [Spi08, Chapter 27, Problem 19].

1.6 Special continuous distributions
౪
61
By the definition of pα,β, we have
∞
∫
−∞
pα,β(x) dx =
1
αβ Γ(β)
∞
∫
0
xβ−1e−x/α dx .
Substituting in the right-hand integral u := x/α, thus dx = αdu, the right-hand side
becomes
1
Γ(β)
∞
∫
0
uβ−1e−u du =
1
Γ(β) Γ(β) = 1 .
Hence eq. (1.56) is valid, and pα,β is a probability density function.
Definition 1.6.17. The probability measure Γα,β with density function pα,β is called the gamma distribu-
tion with positive parameters α and β. For all 0 ≤a < b < ∞,
Γα,β([a, b]) =
1
αβ Γ(β)
b
∫
a
xβ−1e−x/α dx .
(1.57)
Remark 1.6.18. Since pα,β(x) = 0 for x ≤0, it follows that Γα,β((−∞, 0]) = 0. Hence, if
a < b are arbitrary, then
Γα,β([a, b]) = Γα,β([0, ∞) ∩[a, b]) .
Remark 1.6.19. If β ∉ℕ, then the integral in eq. (1.57) cannot be expressed by elemen-
tary functions. Only numerical evaluations are possible.
1.6.4 Exponential distribution
An important special gamma distribution is the exponential distribution. This probabil-
ity measure is defined as follows.
Definition 1.6.20. For λ > 0, let Eλ := Γλ−1,1 be the exponential distribution with parameter λ > 0.
Remark 1.6.21. The probability density function pλ of Eλ is given by
pλ(x) = {0
if x ≤0,
λ e−λx
if x > 0.

62
౪
1 Probabilities
Consequently, if 0 ≤a < b < ∞, then the probability of [a, b] can be evaluated by
Eλ([a, b]) = λ
b
∫
a
e−λx dx = e−λa −e−λb .
Moreover,
Eλ([t, ∞)) = e−λt ,
t ≥0 .
See Figure 1.14 for certain graphs of densities generating exponential distributions.
Figure 1.14: The densities of Eλ with λ = 1, 1/2, 1/3, and 1/4.
Remark 1.6.22. The exponential distribution plays an important role for the descrip-
tion of lifetimes. For instance, it is used to determine the probability that the lifetime of
a component part or the duration of a phone call exceeds a certain time T > 0. Further-
more, it is applied to describe the time between the arrivals of customers at a counter
or in a shop.
Example 1.6.23. Suppose that the duration of phone calls is exponentially distributed
with parameter λ = 0.1. What is the probability that a call lasts less than two time units?
Or what is the probability that it lasts between one and two units? Or more than five
units?
Answer: These probabilities are evaluated by
E0.1([0, 2]) = 1 −e−0.2 = 0.181269 ,
E0.1([1, 2]) = e−0.1 −e−0.2 = 0.08611 ,
E0.1([5, ∞)) = e−0.5 = 0.60653 .

1.6 Special continuous distributions
౪
63
1.6.5 Erlang distribution
Another important class of gamma distributions is that of Erlang distributions defined
as follows.
Definition 1.6.24. For λ > 0 and n ∈ℕ, let Eλ,n := Γλ−1,n. This probability measure is called the Erlang
distribution with parameters λ and n.
Remark 1.6.25. The density pλ,n of the Erlang distribution is (see also Figure 1.15)
pλ,n(x) = {0
if x ≤0,
λn
(n−1)! xn−1 e−λx
if x > 0.
Figure 1.15: The densities of the Erlang distribution with λ = 3 and n = 2, 3, 4, and 5.
Of course, Eλ,1 = Eλ. Thus, the Erlang distribution may be viewed as generalized expo-
nential distribution.
An important property of the Erlang distribution is as follows.
Proposition 1.6.26. If t > 0, then
Eλ,n([t, ∞)) =
n−1
∑
j=0
(λt)j
j!
e−λt .
Proof. We have to show that for t > 0,
∞
∫
t
pλ,n(x) dx =
λn
(n −1)!
∞
∫
t
xn−1 e−λx dx =
n−1
∑
j=0
(λt)j
j!
e−λt .
(1.58)

64
౪
1 Probabilities
This is done by induction over n.
If n = 1, then eq. (1.58) is valid due to
∞
∫
t
pλ,1(x) dx =
∞
∫
t
λ e−λx dx = e−λt .
Suppose now eq. (1.58) is proven for some n ≥1. Next, we have to show that it is also
valid for n + 1. Thus, we know
λn
(n −1)!
∞
∫
t
xn−1 e−λx dx =
n−1
∑
j=0
(λt)j
j!
e−λt
(1.59)
and want
λn+1
n!
∞
∫
t
xn e−λx dx =
n
∑
j=0
(λt)j
j!
e−λt .
(1.60)
Let us integrate the integral in eq. (1.60) by parts as follows. Set u := xn, hence u′ = n xn−1,
and v′ = e−λx, thus v = −λ−1 e−λx. Doing so and using eq. (1.59), the left-hand side of
eq. (1.60) becomes
λn+1
n!
∞
∫
t
xn e−λx dx = [−λn
n! xn e−λx]
∞
t
+
λn
(n −1)!
∞
∫
t
xn−1 e−λx dx
= (λt)n
n!
e−λt +
n−1
∑
j=0
(λt)j
j!
e−λt =
n
∑
j=0
(λt)j
j!
e−λt .
This proves eq. (1.60) and, consequently, eq. (1.58) is valid for all n ≥1.
1.6.6 Chi-squared distribution
Another important class of gamma distributions is that of χ2-distributions. These prob-
ability measures play a crucial role in Mathematical Statistics (cf. Chapter 8).
Definition 1.6.27. For n ≥1, let
χ2
n := Γ2,n/2 .
This probability measure is called the χ2-distribution with n degrees of freedom.
Remark 1.6.28. At the moment, the integer n ≥1 in Definition 1.6.27 is only a parameter.
The term “degree of freedom” will become clear when we apply the χ2-distribution to
statistical problems.

1.6 Special continuous distributions
౪
65
Remark 1.6.29. The density p of a χ2
n-distribution is given by (compare Figure 1.16)
p(x) = {0
if x ≤0,
xn/2−1e−x/2
2n/2Γ(n/2)
if x > 0,
i. e., if 0 ≤a < b, then
χ2
n([a, b]) =
1
2n/2Γ(n/2)
b
∫
a
xn/2−1 e−x/2 dx .
Figure 1.16: Density functions of χ2
n-distributions, n = 1, 3, 5, and n = 7.
Summary: For each α, β > 0, the probability measure Γα,β is given by
Γα,β([a, b]) =
1
αβ Γ(β)
b
∫
a
xβ−1e−x/α dx ,
0 ≤a < b < ∞.
Of special interest are the exponential distribution Eλ = Γλ−1,1, the Erlang distribution defined by Eλ,n = Γλ−1,n,
and the chi-squared distribution χ2
n = Γ2,n/2. Here λ > 0 and n ∈ℕ.
1.6.7 Beta distribution
Tightly connected with the gamma function is Euler’s beta function B. It maps (0, ∞)2
to ℝand is defined by

66
౪
1 Probabilities
B(x, y) :=
1
∫
0
sx−1(1 −s)y−1 ds ,
x, y > 0 .
(1.61)
The link between the gamma and beta functions is the following important identity:
B(x, y) = Γ(x) ⋅Γ(y)
Γ(x + y) ,
x, y > 0 .
(1.62)
For a proof of eq. (1.62), we refer to Problem 1.34.
Let us summarize further properties of the beta function. They are either easy to
prove or follow via eq. (1.62) by the properties of the gamma function.
Proposition 1.6.30.
1.
The beta function is continuous on (0, ∞) × (0, ∞) with values in (0, ∞).
2.
For x, y > 0, one has B(x, y) = B(y, x).
3.
If x, y > 0, then
B(x + 1, y) =
x
x + y B(x, y) .
(1.63)
4.
For x > 0, one has B(x, 1) = 1/x.
5.
If m, n ≥1 are integers, then
B(m, n) = (m −1)! (n −1)!
(m + n −1)!
.
6.
It holds
B(1
2, 1
2) = π .
(1.64)
Definition 1.6.31. Let α, β > 0. The probability measure ℬα,β defined by
ℬα,β([a, b]) :=
1
B(α, β)
b
∫
a
xα−1(1 −x)β−1 dx ,
0 ≤a < b ≤1 ,
is called the beta distribution with parameters α and β.
That is, the density function qα,β of ℬα,β is given by
qα,β(x) = {
1
B(α,β) xα−1(1 −x)β−1
if 0 < x < 1,
0
otherwise.
Compare Figure 1.17 for the densities of beta distributions with certain pairs of parame-
ters α, β > 0. Note that the densities are bounded provided that α, β ≥1 and unbounded
whenever one of the parameters is less than 1.

1.6 Special continuous distributions
౪
67
Figure 1.17: Density functions of the beta distribution with parameters (0.5, 1.5), (1.5, 2.5), (2.5, 2), (1.5, 2),
(2, 1.5), and (2.5, 2.5).
Remark 1.6.32. It is easy to see that qα,β is a density function. Of course, it is nonnegative
and, moreover, we have
∞
∫
−∞
qα,β(x) dx =
1
B(α, β)
1
∫
0
xα−1(1 −x)β−1 dx = B(α, β)
B(α, β) = 1 .
Furthermore, since qα,β(x) = 0 if x ∉[0, 1], the probability measure ℬα,β is concentrated
on [0, 1], that is, ℬα,β([0, 1]) = 1 or, equivalently, ℬα,β(ℝ\ [0, 1]) = 0.
Example 1.6.33. Choose independently n numbers x1, . . . , xn in [0, 1] according to the
uniform distribution. Ordering these numbers by their size, we get x∗
1 ≤⋅⋅⋅≤x∗
n . In
Example 3.7.11, we will show that the kth largest number x∗
k is ℬk,n−k+1-distributed. In
other words, if 0 ≤a < b ≤1, then
ℙ{a ≤x∗
k ≤b} = ℬk,n−k+1([a, b]) =
n!
(k −1)! (n −k)!
b
∫
a
xk−1(1 −x)n−k dx .
Among the beta distributions ℬα,β, the one with α = β = 1
2 is of special interest. It
plays an important role in the investigation of the symmetric random walk as well as of
the Brownian motion (see Proposition 5.5.19).
Proposition 1.6.34. The density q of the beta distribution ℬ1/2,1/2 is given by
q(x) =
{
{
{
1
π
1
√x(1−x)
if 0 < x < 1,
0
otherwise.
(1.65)
Furthermore, if 0 ≤a < b ≤1, then it follows that
ℬ1/2,1/2([a, b]) = 2
π [arcsin(√b) −arcsin(√a)] .
(1.66)

68
౪
1 Probabilities
Proof. Using eq. (1.64), representation (1.65) of the density easily follows from
q(x) =
1
B(1/2, 1/2) x
1
2 −1(1 −x)
1
2 −1 = 1
π
1
√x(1 −x)
,
0 < x < 1 .
Assertion (1.66) is a consequence of
2
π
d
dx arcsin(√x) = 2
π
1
√1 −(√x)2
⋅
1
2√x = 1
π
1
√x(1 −x)
,
0 < x < 1 ,
in view of the fundamental theorem of Calculus. See Figure 1.18 for the graph of the
density q.
Figure 1.18: The density of the arcsine distribution.
Definition 1.6.35. The probability measure ℬ1/2,1/2 is called the arcsine distribution. Its density is given
by eq. (1.65), and for any 0 < a ≤1 it follows that
ℬ1/2,1/2([0, a]) = 2
π arcsin(√a) .
(1.67)
1.6.8 Cauchy distribution
We start with the following statement.
Proposition 1.6.36. The function p defined by
p(x) = 1
π ⋅
1
1 + x2 ,
x ∈ℝ,
(1.68)
is a probability density.

1.7 Distribution function
౪
69
Proof. Of course, p(x) > 0 for x ∈ℝ. Let us now investigate ∫
∞
−∞p(x) dx. Because of
limb→∞arctan(b) = π/2 and lima→−∞arctan(a) = −π/2, it follows that
∞
∫
−∞
p(x) dx = 1
π
lim
a→−∞lim
b→∞
b
∫
a
1
1 + x2 dx = 1
π
lim
a→−∞lim
b→∞[arctan x]b
a = 1 .
Thus, as asserted, p is a probability density.
Definition 1.6.37. The probability measure ℙwith density p from Eq. (1.68) is called the Cauchy distri-
bution. It is characterized by
ℙ([a, b]) = 1
π
b
∫
a
1
1 + x2 dx = 1
π [arctan(b) −arctan(a)] ,
−∞< a < b < ∞.
Figure 1.19: The density function of the Cauchy distribution.
Remark 1.6.38. Comparing the density function of the Cauchy distribution in Figure 1.19
with that of the standard normal distribution in Figure 1.11, at a first glance both func-
tions look very similar. But, in fact they differ significantly. While the density of the stan-
dard normal distribution tends to 0 exponentially as x →∞, the convergence of the
density of the Cauchy distribution is only of quadratic order. That is, events lying far
away from zero possess an essentially greater probability for the Cauchy distribution as
they do in the case of the normal. This property of the Cauchy distribution is sometimes
expressed by saying that it is a distribution possessing “heavy tails.”
1.7 Distribution function
In this section we always assume that the sample space is ℝ, even if the random exper-
iment has only finitely or countably infinitely many different outcomes. For example,

70
౪
1 Probabilities
rolling a die once is modeled by (ℝ, 𝒫(ℝ), ℙ), where ℙ({k}) = 1/6, k = 1, . . . , 6, and
ℙ({x}) = 0 whenever x ∉{1, . . . , 6}.
Thus, let ℙbe a probability measure either defined on ℬ(ℝ) (continuous case) or on
𝒫(ℝ) (discrete case).
Definition 1.7.1. The function F : ℝ→[0, 1] defined by
F(t) := ℙ((−∞, t]) ,
t ∈ℝ,
(1.69)
is called the (cumulative) distribution function of ℙ.
Remark 1.7.2. To shorten the notation, we will mostly call F in (1.69) the “distribution
function” instead of, as is often done in the literature, the “cumulative distribution func-
tion,” abbreviated CDF.
Remark 1.7.3. If ℙis discrete, that is, ℙ(D) = 1 for some D = {x1, x2, . . . }, then its distri-
bution function can be evaluated by
F(t) = ∑
xj≤t
ℙ({xj}) = ∑
xj≤t
pj ,
where pj = ℙ({xj}), while for a continuous ℙwith probability density p,
F(t) =
t
∫
−∞
p(x) dx .
Example 1.7.4. Let ℙbe the uniform distribution on {1, . . . , 6}. Then
F(t) =
{
{
{
{
{
{
{
0
if t < 1,
k
6
if k ≤t < k + 1 , k ∈{1, . . . , 5},
1
if t ≥6 .
(See Figure 1.20.)
Example 1.7.5. The distribution function of the binomial distribution Bn,p is given by
F(t) = ∑
0≤k≤t
(n
k)pk(1 −p)n−k ,
0 ≤t < ∞,
and F(t) = 0 if t < 0. (See Figure 1.21.)
Example 1.7.6. The distribution function of the exponential distribution Eλ is (see Fig-
ure 1.22 for an example)
F(t) = {0
if t < 0,
1 −e−λt
if t ≥0.

1.7 Distribution function
౪
71
Figure 1.20: Distribution function of the uniform distribution on {1, . . . , 6}.
Figure 1.21: Distribution function of the binomial distribution B25,0.4.
Figure 1.22: Distribution function of E0.5.

72
౪
1 Probabilities
Example 1.7.7. How does the distribution function F of the Erlang distribution Eλ,n look
like? In view of Proposition 1.6.26, it follows that F(t) = 0 if t < 0 and
F(t) = 1 −
n−1
∑
j=0
(λt)j
j!
e−λt ,
0 ≤t < ∞.
In the case n = 1, we rediscover the function stated in Example 1.7.6. Compare Figure 1.23
for certain distribution functions of the Erlang distribution.
Figure 1.23: Distribution functions of E2,n, where from the left to the right n = 2, 4, 6, 8.
Example 1.7.8. The distribution function of the standard normal distribution is de-
noted14 by Φ, therefore also called Gaussian Φ-function (see Figure 1.24),
Φ(t) =
1
√2π
t
∫
−∞
e−x2/2 dx ,
t ∈ℝ.
(1.70)
Remark 1.7.9. The Gaussian Φ-function is tightly related to the Gaussian error func-
tion defined by (compare Figure 1.25)
erf(t) =
2
√π
t
∫
0
e−x2
dx ,
t ∈ℝ.
Observe that erf(−t) = −erf(t).
14 Sometimes also denoted as “norm(⋅).”

1.7 Distribution function
౪
73
Figure 1.24: Distribution function of the standard normal distribution (Φ-function).
Figure 1.25: The Gaussian error function t 󳨃→erf(t).
The link between the Φ and the error function is
Φ(t) = 1
2[1 + erf( t
√2
)]
and
erf(t) = 2Φ(√2 t) −1 ,
t ∈ℝ.
(1.71)
Example 1.7.10. Let ℙbe the uniform distribution on the interval [α, β]. Then its distri-
bution function (cf. Figure 1.26) is
F(t) =
{
{
{
{
{
{
{
0
if t < α,
t−α
β−α
if α ≤t ≤β,
1
if t > β.

74
౪
1 Probabilities
In particular, for the uniform distribution on [0, 1], one obtains
F(t) =
{
{
{
{
{
{
{
0
if t < 0,
t
if 0 ≤t ≤1,
1
if t > 1.
Figure 1.26: Distribution function of the uniform distribution on [−1, 2].
Example 1.7.11. In view of eq. (1.67), the distribution function of the arcsine distribution
(see Definition 1.6.35) is given by (compare Figure 1.27)
F(t) =
{
{
{
{
{
{
{
0
if −∞< t < 0,
2
π arcsin(√t)
if 0 ≤t ≤1,
1
if 1 < t < ∞.
Figure 1.27: The distribution function of the arcsine distribution.

1.7 Distribution function
౪
75
Example 1.7.12. The distribution function of the Cauchy distribution is (compare Fig-
ure 1.28)
F(t) = 1
π
t
∫
−∞
1
1 + x2 dx = arctan x
π
+ 1
2 ,
t ∈ℝ.
Figure 1.28: The distribution function of the Cauchy distribution.
The next proposition lists the main properties of distribution functions.
Proposition 1.7.13. Let F be the distribution function of a probability measure ℙon ℝ,
discrete or continuous. Then F possesses the following properties:
(1) Function F is nondecreasing.
(2) It holds
F(−∞) = lim
t→−∞F(t) = 0
and
F(∞) = lim
t→∞F(t) = 1 .
(3) Function F is continuous from the right.
Proof. Suppose s < t. This implies (−∞, s] ⊂(−∞, t], hence, since ℙis monotone, we
obtain
F(s) = ℙ((−∞, s]) ≤ℙ((−∞, t]) = F(t) .
Thus F is nondecreasing.
Take any sequence (tn)n≥1 that decreases monotonically to −∞. Set An := (−∞, tn].
Then A1 ⊇A2 ⊇⋅⋅⋅, as well as ⋂∞
n=1 An = 0. Since ℙis continuous from above, it fol-

76
౪
1 Probabilities
lows that
lim
n→∞F(tn) = lim
n→∞ℙ(An) = ℙ(0) = 0 .
This being true for any sequence (tn)n≥1 tending to −∞implies F(−∞) = 0.
The proof of F(∞) = 1 is very similar. In this case, let (tn)n≥1 be a sequence which
increases monotonically to ∞. If as before An := (−∞, tn], this time we get A1 ⊆A2 ⊆⋅⋅⋅
and ⋃∞
n=1 An = ℝ. By the continuity of ℙfrom below, now we obtain
lim
n→∞F(tn) = lim
n→∞ℙ(An) = ℙ(ℝ) = 1 .
Again, since the tns were arbitrary, F(∞) = 1.
Thus it remains to prove that F is continuous from the right. To do this, we take
t ∈ℝand a decreasing sequence (tn)n≥1 tending to t. We have to show that if n →∞,
then F(tn) →F(t).
As before set An := (−∞, tn]. Again A1 ⊇A2 ⊇⋅⋅⋅, but now ⋂∞
n=1 An = (−∞, t].
Another application of the continuity from above yields
F(t) = ℙ((−∞, t]) = lim
n→∞ℙ(An) = lim
n→∞F(tn) .
This is valid for each t ∈ℝ, hence F is continuous from the right.
Properties (1), (2), and (3) in Proposition 1.7.13 characterize distribution functions.
More precisely, the following result is true. Its proof is based on an extension theorem
in Measure Theory (cf. [Bau01]). Therefore, we can show here only its main ideas.
Proposition 1.7.14. Let F : ℝ→ℝbe an arbitrary function possessing the properties
stated in Proposition 1.7.13. Then there exists a unique probability measure ℙon ℬ(ℝ)
such that
F(t) = ℙ((−∞, t]) ,
t ∈ℝ.
Idea of the proof: If a < b, set
ℙ0((a, b]) := F(b) −F(a) .
In this way, we get a mapping ℙ0 defined on the collection of all half-open intervals
{(a, b] : a < b}. The key point is to verify that ℙ0 can be uniquely extended to a proba-
bility measure ℙon ℬ(ℝ). One way to do this is to introduce a so-called outer measure
ℙ∗defined on 𝒫(ℝ) by
ℙ∗(B) := inf{
∞
∑
i=1
ℙ0((ai, bi]) : B ⊆
∞
⋃
i=1
(ai, bi]} .

1.7 Distribution function
౪
77
Generally, this outer measure is not σ-additive. Therefore, one restricts ℙ∗to ℬ(ℝ). If ℙ
denotes this restriction, the most difficult part of the proof is to verify that ℙis σ-additive.
After this has been done, by the construction, ℙis the probability measure possessing
distribution function F.
The uniqueness of ℙfollows by a general uniqueness theorem for probability mea-
sures (see Theorem 5.7 in [Sch17] for a proof) asserting the following:
Let ℙ1 and ℙ2 be two probability measures on (Ω, 𝒜) and let ℰ⊆𝒜be a collection
of events closed under taking intersections and generating 𝒜. If ℙ1(E) = ℙ2(E) for all
E ∈ℰ, then ℙ1 = ℙ2. In our case ℰ= {(−∞, t] : t ∈ℝ} and 𝒜= ℬ(ℝ).
Conclusion. If the outcomes of a random experiment are real numbers, then this ex-
periment can also be described by a function F : ℝ→ℝpossessing the properties in
Proposition 1.7.13. Then F(t) is the probability to observe a result that is less than or
equal to t.
Let us state further properties of distribution functions.
Proposition 1.7.15. If F is the distribution function of a probability measure ℙ, then for
all a < b,
F(b) −F(a) = ℙ((a, b]) .
Proof. Observing that (−∞, a] ⊆(−∞, b], this is an immediate consequence of
F(b) −F(a) = ℙ((−∞, b]) −ℙ((−∞, a]) = ℙ((−∞, b] \ (−∞, a]) = P((a, b]) .
Since F is nondecreasing and bounded, for each t ∈ℝthe left-hand limit
F(t −0) := lim
s→t
s<t
F(s)
exists and, moreover, F(t −0) ≤F(t). Furthermore, by the right continuity of F, one has
F(t −0) = F(t) if and only if F is continuous at the point t.
If this is not so, then h = F(t) −F(t −0) > 0, that is, F possesses at t ∈ℝa jump of
height h > 0. This height is directly connected with the value of ℙ({t}).
Proposition 1.7.16. The distribution function F of a probability measure ℙhas a jump of
height h ≥0 at t ∈ℝif and only if ℙ({t}) = h.
Proof. Let (tn)n≥1 be a sequence of real numbers increasing monotonically to t. Then,
using that ℙis continuous from above, it follows that
h = F(t) −F(t −0) = lim
n→∞[F(t) −F(tn)] = lim
n→∞ℙ((tn, t]) = ℙ({t}) .
Observe that ⋂∞
n=1(tn, t] = {t}. This proves the assertion. See Figure 1.29 for a visualiza-
tion of the result.

78
౪
1 Probabilities
Figure 1.29: The height h of the jump of F at t0 coincides with the probability ℙ({t0}).
Corollary 1.7.17. The function F is continuous at t ∈ℝif and only if ℙ({t}) = 0.
Proof. Since F is nondecreasing and continuous from the right, it is continuous at some
point t ∈ℝif and only if F(t −0) = F(t). But, in view of Proposition 1.7.16, this happens
if and only if ℙ({t}) = 0.
Example 1.7.18. Suppose the function F is defined by
F(t) =
{
{
{
{
{
{
{
{
{
{
{
{
{
{
{
{
{
{
{
0
if t < −1,
1/3
if −1 ≤t < 0,
1/2
if 0 ≤t < 1,
2/3
if 1 ≤t < 2,
1
if t ≥2 .
Then F fulfills the assumptions of Proposition 1.7.14. Hence there is a probability mea-
sure ℙwith F(t) = ℙ((−∞, t]). What does ℙlook like?
Answer: The function F has jumps at −1, 0, 1, and 2 with heights 1/3, 1/6, 1/6, and 1/3,
respectively. Therefore,
ℙ({−1}) = 1/3 ,
ℙ({0}) = 1/6 ,
ℙ({1}) = 1/6,
and
ℙ({2}) = 1/3,
hence ℙis the discrete probability measure concentrated on D = {−1, 0, 1, 2} with ℙ({t}),
t ∈D, given above.
Suppose now that ℙis continuous with density function p. Recall that then
F(t) = ℙ((−∞, t]) =
t
∫
−∞
p(x) dx ,
t ∈ℝ.
(1.72)
In particular, since F is a function of the upper bound in an integral, it is continu-
ous.

1.7 Distribution function
౪
79
Next we investigate the question whether we may evaluate the density p knowing
the distribution function F.
Proposition 1.7.19. Suppose p is continuous at some t ∈ℝ. Then F is differentiable at t
with
F′(t) = d
dt F(t) = p(t) .
Proof. This follows immediately by an application of the fundamental theorem of cal-
culus to representation (1.72) of F.
Remark 1.7.20. Let F be the distribution function of a probability measure ℙ. If F is
continuous, then ℙ({t}) = 0 for all t ∈ℝ. But does this also imply that ℙis continuous,
that is, that ℙhas a density? The answer is negative. There exist probability measures ℙ
on (ℝ, ℬ(ℝ)) with a continuous distribution function but without possessing a density.
Such probability measures are called singularly continuous.
To get an impression of how such probability measures look, let us shortly sketch
the construction of an example. Let C be the Cantor set introduced in Example 1.6.6. The
basic idea is to transfer the uniform distribution on [0, 1] to a probability measure ℙwith
ℙ(C) = 1. The transformation is done by the function f defined as follows. If x ∈[0, 1] is
represented as x = ∑∞
k=1
xk
2k with xk ∈{0, 1}, then f (x) = ∑∞
k=1
2xk
3k . Note that f maps [0, 1]
into C. If ̃ℙdenotes the uniform distribution on [0, 1], define the probability measure ℙ
by
ℙ(B) =
̃ℙ{x ∈[0, 1] : f (x) ∈B} .
Then for all t ∈ℝ, we have ℙ({t}) = 0, but since ℙ(C) = 1, ℙcannot have a density.
Indeed, such a density should vanish outside C. But, as we saw, the probability of C with
respect to the uniform distribution is zero. Hence the only possible density would be
p(t) = 0, t ∈ℝ. This contradiction shows that ℙis not continuous in our sense.
Assuming a little bit more than the continuity of F, the corresponding probability
measure possesses a density (cf. [Coh13]).
Proposition 1.7.21. Let F be the distribution function of a probability measure ℙ. If F is
continuous and continuously differentiable with the exception of at most finitely many
points, then ℙis continuous. That is, there is a density function p such that
F(t) = ℙ((−∞, t]) =
t
∫
−∞
p(x) dx ,
t ∈ℝ.
Remark 1.7.22. Proposition 1.7.19 implies p(t) = F′(t) for those t where F′(t) exists. If F
is not differentiable at t, define p(t) arbitrarily, for example, p(t) = 0.

80
౪
1 Probabilities
Example 1.7.23. For some α, β > 0, define F by
F(t) = {0
if t ≤0,
1 −e−α tβ
if t > 0.
It is easy to see that this function satisfies the conditions of Proposition 1.7.13. Moreover,
it is continuous and continuously differentiable on ℝ\ {0}. By Proposition 1.7.21, the
corresponding probability measure ℙis continuous and, since
F′(t) = {0
if t < 0,
α β tβ−1 e−αtβ
if t > 0,
a suitable density function is p(t) = F′(t), t
̸= 0, and p(0) = 0.
Example 1.7.24. For some α > 0, let
Fα(t) = {0
if t ≤1,
1 −t−α
if t > 1.
Then Fα is continuous, nondecreasing with Fα(−∞) = 0 and Fα(∞) = 1. Hence, it is a
distribution function of a probability measure ℙα. Moreover, at each point t
̸= 1, the
function Fα is continuously differentiable with derivative
pα(t) = {0
if t < 1,
αt−α−1
if t > 1.
So we see that pα is a density of ℙα where we may define, for example, pα(1) = 0.
How does one get ℙα([a, b]) for some 1 ≤a < b < ∞? There is no need to evaluate
the integral ∫
b
a pα(x)dx. The much easier way is to use
ℙα([a, b]) = Fα(b) −Fα(a) = 1
aα −1
bα .
Summary: Let ℙbe a probability measure (discrete or continuous) on the Borel sets of ℝ. Then its (cumula-
tive) distribution function F is defined by
F(t) = ℙ{x ∈ℝ: x ≤t} ,
t ∈ℝ.
Distribution functions are characterized by the three properties stated in Proposition 1.7.13. Two probability
measures coincide if and only if they possess the same distribution function.

1.8 Multivariate continuous distributions
౪
81
1.8 Multivariate continuous distributions
1.8.1 Multivariate density functions
In this section we suppose that Ω = ℝn. A subset Q ⊂ℝn is called a (closed, n-dimensional)
box15 provided that for some real numbers ai < bi, 1 ≤i ≤n,
Q = {(x1, . . . , xn) ∈ℝn : ai ≤xi ≤bi , 1 ≤i ≤n} .
(1.73)
Definition 1.8.1. A Riemann integrable function p : ℝn →ℝis said to be an n-dimensional probability
density function, or simply n-dimensional density function, if p(x) ≥0 for x ∈ℝn and, furthermore,
∫
ℝn
p(x) dx :=
∞
∫
−∞
⋅⋅⋅
∞
∫
−∞
p(x1, . . . , xn) dxn ⋅⋅⋅dx1 = 1 .
Suppose a box Q is represented with certain ai < bi as in eq. (1.73). Then we set
ℙ(Q) = ∫
Q
p(x) dx =
b1
∫
a1
⋅⋅⋅
bn
∫
an
p(x1, . . . , xn) dxn ⋅⋅⋅dx1.
(1.74)
In analogy to Definition 1.1.20, we introduce now the Borel σ-field ℬ(ℝn).
Definition 1.8.2. Let 𝒞be the collection of all boxes in ℝn. Then σ(𝒞) := ℬ(ℝn) denotes the Borel σ-field.
Recall that the existence of σ(𝒞) was proven in Proposition 1.1.16. In other words, ℬ(ℝn) is the smallest
σ-field containing all (closed) boxes in ℝn. Sets in ℬ(ℝn) are called (n-dimensional) Borel sets.
Remark 1.8.3. As in the univariate case, there exist several other collections of subsets
in ℝn generating ℬ(ℝn). For example, one may choose the collection of open boxes or
the sets which may be written as
(−∞, t1] × ⋅⋅⋅× (−∞, tn] ,
t1, . . . , tn ∈ℝ.
With the previous notations, the following multivariate extension theorem is valid.
Compare with Proposition 1.5.6 for the univariate case.
Proposition 1.8.4. Let ℙbe defined on boxes by eq. (1.74). Then ℙadmits a unique exten-
sion to a probability measure ℙon ℬ(ℝn).
Definition 1.8.5. A probability measure ℙon ℬ(ℝn) is called continuous provided that there exists a
probability density p : ℝn →ℝsuch that ℙ(Q) = ∫Q p(x) dx for all boxes Q ⊆ℝn. The function p is said to
be the density function, or simply density, of ℙ.
15 Also called “hyperrectangle.”

82
౪
1 Probabilities
Remark 1.8.6. It is easy to see that the validity of eq. (1.74) for all boxes is equivalent to
the following. If tj ∈ℝand Bt1,...,tn := (−∞, t1] × ⋅⋅⋅× (−∞, tn], then
ℙ(Bt1,...,tn) =
∫
Bt1,...,tn
p(x) dx =
t1
∫
−∞
⋅⋅⋅
tn
∫
−∞
p(x1, . . . , xn) dxn ⋅⋅⋅dx1 .
(1.75)
Thus ℙis continuous if and only if eq. (1.75) is satisfied for all tj ∈ℝ.
Let us first give an example of a multivariate probability density function.
Example 1.8.7. Consider p : ℝ3 →ℝdefined by
p(x1, x2, x3) = {48 x1 x2 x3
if 0 ≤x1 ≤x2 ≤x3 ≤1,
0
otherwise.
Of course, p(x) ≥0 for x ∈ℝ3. Moreover,
∫
ℝ3
p(x) dx = 48
1
∫
0
x3
∫
0
x2
∫
0
x1x2x3 dx1dx2dx3
= 48
1
∫
0
x3
∫
0
x3 x3
2
2
dx2 dx3 = 48
1
∫
0
x5
3
8 dx3 = 1 ,
hence it is a density function on ℝ3. For example, if ℙis the generated probability mea-
sure, then
ℙ([0, 1/2]3) = 48
1/2
∫
0
x3
∫
0
x2
∫
0
x1x2x3 dx1dx2dx3 = 1
26 = 1
64 .
There exists a quite general approach to construct multivariate density functions.
Proposition 1.8.8. Let p1, . . . , pn be (univariate) density functions. Define a function
p : ℝn →ℝby
p(x) = p1(x1) ⋅⋅⋅pn(xn) ,
x = (x1, . . . , xn) ∈ℝn .
(1.76)
Then p is a multivariate distribution density.
Proof. Of course, we have p(x) ≥0 for all x ∈ℝn. Moreover, an application of Proposi-
tion A.5.5 (note that all pj are nonnegative) implies that
∫
ℝn
p(x)dx =
∞
∫
−∞
⋅⋅⋅
∞
∫
−∞
[p1(x1) ⋅⋅⋅pn(xn)] dxn ⋅⋅⋅dx1

1.8 Multivariate continuous distributions
౪
83
= (
∞
∫
−∞
p1(x1)dx1) ⋅⋅⋅(
∞
∫
−∞
pn(xn)dxn) = 1 ⋅⋅⋅1 = 1 .
Thus, p is a density as asserted.
Remark 1.8.9. Observe that not all multivariate densities p may be represented as a
product of univariate ones as stated in eq. (1.76). As can be seen easily, the function p
in Example 1.8.7 may not be written as a product of three univariate densities. We will
investigate this and related problems more thoroughly in Section 1.9.3.
1.8.2 Multivariate uniform distribution
Our next aim is the introduction and investigation of a special multivariate distribution,
the uniform distribution on a set K in ℝn. To do so, we remember how we defined the
uniform distribution on an interval I in ℝ. Its density p is given by
p(s) = {
1
|I|
if s ∈I,
0
if s ∉I.
Here |I| denotes the length of the interval I. Let now K ⊂ℝn be bounded. In order to in-
troduce a similar density for the uniform distribution on K, the length of the underlying
set has to be replaced by the n-dimensional volume, which we will denote by voln(K).
But how is this volume defined? To answer this question, let us first investigate a box
Q represented as in eq. (1.73). It is immediately clear that its n-dimensional volume is
evaluated by
voln(Q) =
n
∏
i=1
(bi −ai) .
If n = 1, then Q is an interval and its one-dimensional volume is nothing else as its
length. For n = 2 the box Q is the rectangle [a1, b1] × [a2, b2] and
vol2(Q) = (b1 −a1)(b2 −a2)
coincides with the area of Q. If n = 3, then vol3(Q) is the ordinary volume of bodies in ℝ3.
For arbitrary K ⊂ℝn, the definition of its volume voln(K) is more involved. Let us
shortly sketch one way how this can be done. Setting
voln(K) := inf{
∞
∑
j=1
voln(Qj) : K ⊆
∞
⋃
j=1
Qj , Qj box} ,
(1.77)
at least for Borel sets K ⊆ℝn, a suitable volume is defined. Compare Figure 1.30 to get
an impression how the two-dimensional volume of an ellipse is evaluated.

84
౪
1 Probabilities
Figure 1.30: An ellipse K covered by boxes, here squares. The smaller the covering boxes, the better the
approximation of vol2(K).
In the case of “ordinary” sets such as balls, ellipsoids, or similar bodies, this ap-
proach leads to the known values. The reason is the basic formula
voln(K) = ∫⋅⋅⋅∫
K
1 dxn ⋅⋅⋅dx1
(1.78)
valid for Borel sets K ⊆ℝn. For example, if K is the square in ℝ2 (see Figure 1.31) with
corner points (1, 0), (0, 1), (−1, 0), and (0, −1), then
vol2(K) = ∬
K
1 dx2dx1 =
0
∫
−1
1+x1
∫
−x1−1
dx2dx1 +
1
∫
0
1−x1
∫
x1−1
dx2dx1
= 2
0
∫
−1
(x1 + 1)dx1 + 2
1
∫
0
(1 −x1)dx1
= 2[x2
1
2 + x1]
0
−1
+ 2[x1 −x2
1
2 ]
1
0
= 2 .
Figure 1.31: The square K ⊆ℝ2 with corner points (1, 0), (0, 1), (−1, 0), and (0, −1).

1.8 Multivariate continuous distributions
౪
85
Remark 1.8.10. The n-dimensional volume shares several important properties:
1.
It is invariant under shifts. That is, if
K + z = {x + z : x ∈K}
denotes the shift of K by z ∈ℝn, then it follows that
voln(K + z) = voln(K) ,
z ∈ℝn .
2.
Unitary transformations of a set do not change its volume. More precisely, if
U : ℝn →ℝn is a unitary transformation (cf. (A.24) for the definition), then
voln(U(K)) = voln(K) .
3.
The n-dimensional volume is homogeneous of power n under dilation. Thus, given
α > 0, let α K = {α x : x ∈K} be the stretched (if α > 1) or shrunk (if α < 1) set K.
Then it follows that
voln(α K) = αn voln(K) .
Example 1.8.11. Let Kn(r) be the n-dimensional ball of radius r > 0, that is,
Kn(r) = {x ∈ℝn : |x| ≤r} = {(x1, . . . , xn) ∈ℝn : x2
1 + ⋅⋅⋅+ x2
n ≤r2} .
If
Vn(r) := voln(Kn(r)) ,
r > 0 ,
denotes the n-dimensional volume of this ball, property (3) in Remark 1.8.10 implies
Vn(r) = Vn ⋅rn, where Vn = Vn(1). But for Kn = Kn(1), eq. (1.78) gives
Vn = ∫⋅⋅⋅∫
Kn
1 dxn ⋅⋅⋅dx1 =
1
∫
−1
[
∫⋅⋅⋅∫
{x2
2+⋅⋅⋅+x2
n≤1−x2
1}
1 dxn ⋅⋅⋅dx2]dx1
=
1
∫
−1
Vn−1(√1 −x2
1) dx1 =
1
∫
−1
Vn−1(√1 −s2) ds .
Hence, due to Vn−1(r) = rn−1 Vn−1(1) = rn−1 Vn−1, we obtain
Vn = Vn−1 ⋅
1
∫
−1
(1 −s2)
(n−1)/2 ds = 2 Vn−1 ⋅
1
∫
0
(1 −s2)
(n−1)/2 ds .

86
౪
1 Probabilities
The change of the variables s = y1/2, thus ds = 1
2 y−1/2 dy, yields
Vn = Vn−1 ⋅
1
∫
0
y−1/2(1 −y)(n−1)/2 dy = Vn−1 B(1
2 , n + 1
2
)
= √π Vn−1
Γ( n+1
2 )
Γ( n
2 + 1) .
Hereby we used eq. (1.62), as well as Γ(1/2) = √π. Starting with V1 = 2, a recursive
application of the last formula finally leads to
voln(Kn(r)) = Vn(r) =
πn/2
Γ( n
2 + 1) rn = 2 πn/2
n Γ( n
2 ) rn ,
r > 0 .
If we distinguish between even and odd dimensions, properties of the Γ function
imply
V2k(r) = πk
k! r2k
and
V2k+1(r) =
2k+1πk
(2k + 1)!! r2k+1,
where (2k + 1)!! = 1 ⋅3 ⋅5 ⋅⋅⋅(2k −1)(2k + 1). The first volumes are (see Figure 1.32)
V1 = 2,
V2 = π,
V3 = 4 π
3 ,
V4 = π2
2 ,
V5 = 8 π2
15 ,
V6 = π3
6 ,
V7 = 16 π3
105 ,
V8 = π4
24 .
Figure 1.32: The volume of the unit ball as a function of the dimension. It attains its maximal value in di-
mension 5.

1.8 Multivariate continuous distributions
౪
87
After the question about the volume is settled, we are now in the position to in-
troduce the uniform distribution on bounded Borel sets in ℝn. Thus let K ⊆ℝn be a
bounded Borel set in ℝn with volume voln(K) > 0. Define p : ℝn →ℝby
p(x) := {
1
voln(K)
if x ∈K,
0
if x ∉K.
(1.79)
Proposition 1.8.12. The function p defined by eq. (1.79) is an (n-dimensional) probability
density function.
Proof. By virtue of eq. (1.78), one has
∫
ℝn
p(x) dx = ∫
K
1
voln(K) dx =
1
voln(K) ∫⋅⋅⋅∫
K
1 dxn ⋅⋅⋅dx1
= voln(K)
voln(K) = 1 .
Since p(x) ≥0 if x ∈ℝn, as asserted, p is a probability density function.
Definition 1.8.13. The probability measure ℙon (ℝn, ℬ(ℝn)) with density p given by eq. (1.79) is said to
be the (multivariate) uniform distribution on K.
Let ℙbe the uniform distribution on K. How do we get ℙ(B) for a Borel set B? Let us first
assume B ⊆K. Then
ℙ(B) = ∫
B
p(x) dx =
1
voln(K) ∫⋅⋅⋅∫
B
1 dxn ⋅⋅⋅dx1 = voln(B)
voln(K) .
If B ⊆ℝn is arbitrary, that is, B is not necessarily a subset of K, from ℙ(B) = ℙ(B ∩K) it
follows that
ℙ(B) = voln(B ∩K)
voln(K)
.
If n = 1 and K is an interval, the latter formula coincides with eq. (1.46).
Example 1.8.14. Two friends agree to meet in a restaurant between 1 and 2 pm. Both
friends go to the restaurant randomly during this hour. After they arrive, they wait 20
minutes each. What is the probability that they meet each other?
Answer: Let t1 be the moment when the first of the two friends enters the restaurant,
while t2 is the arrival time of the second one. They arrive independently of each other,
thus we may assume that the point t := (t1, t2) is uniformly distributed in the square
Q := [1, 2]2. Observing that 20 minutes are a third of an hour, they meet each other if and
only if 1 ≤t1, t2 ≤2 and |t1 −t2| ≤1/3.

88
౪
1 Probabilities
Setting B := {(t1, t2) ∈ℝ2 : |t1 −t2| ≤1/3}, it is easy to see that vol2(B ∩Q) = 5/9
(see Figure 1.33). Hence, if ℙis the uniform distribution on Q, because of vol2(Q) = 1, it
follows that ℙ(B) = 5/9. Therefore, the probability that the friends meet is 5/9.
Figure 1.33: The two friends meet if (t1, t2) belongs to the gray region.
Example 1.8.15. Place n particles independently of each other into a ball KR of radius
R > 0 according to the uniform distribution. Let Kr be a smaller ball of radius r > 0
contained in KR. Find the probability that exactly k of the n particles are inside Kr for
some k = 0, . . . , n.
Answer: In the first step, we determine the probability that a single particle is in Kr.
Since we assumed that the particles are uniformly distributed in KR, this probability
equals
p := vol3(Kr)
vol3(KR) = (4/3)πr3
(4/3)πR3 = ( r
R)
3
.
For each of the n particles, this p is the “success” probability to be inside Kr, hence the
number of particles in Kr is Bn,p-distributed with p = (r/R)3. Thus,
ℙ{k particles in Kr} = Bn,p({k}) = (n
k)( r
R)
3k
(R −r
R
)
3(n−k)
,
k = 0, . . . , n .
If the number n of particles is big and r is much smaller than R, then the number of
particles in Kr is approximately Poisλ distributed, where λ = n p = nr3
R3 . In other words,
ℙ{k particles in Kr} ≈1
k!(nr3
R3 )
k
e−nr3/R3
.
Example 1.8.16 (Buffon’s needle test). Take a needle of length a < 1 and throw it ran-
domly on a lined sheet of paper. Say the distance between two lines on the paper is 1.
Find the probability that the needle cuts a line.

1.8 Multivariate continuous distributions
౪
89
Answer: What is random in this experiment? Choose the two lines such that between
them the midpoint of the needle lies. Let x ∈[0, 1] be the distance of the midpoint of the
needle to the lower line. Furthermore, denote by θ ∈[−π/2, π/2] the angle of the needle
to a line perpendicular to the lines on the paper. For example, if θ = 0, then the needle
is perpendicular to the lines on the paper while for θ = ±π/2 it lies parallel.
Hence, to throw a needle randomly is equivalent to choosing a point (θ, x) uniformly
distributed in K = [−π/2, π/2] × [0, 1].
The needle cuts the lower line (compare Figure 1.34) if and only if a
2 cos θ ≥x, and
it cuts the upper line provided that a
2 cos θ ≥1 −x. If the set A is as in Figure 1.35 defined
by
A = {(θ, x) ∈[−π/2, π/2] × [0, 1] : x ≤a
2 cos θ or 1 −x ≤a
2 cos θ} ,
then we get
ℙ{the needle cuts a line} = ℙ(A) = vol2(A)
vol2(K) = vol2(A)
π
.
Figure 1.34: A needle of length a < 1 hits the lower line. Here 0 ≤x ≤1 denotes the distance of its
midpoint to the lower line and θ is its angle to the perpendicular line.
But it follows that
vol2(A) = 2
π/2
∫
−π/2
a
2 cos θ dθ = 2a ,
hence
ℙ(A) = 2a
π .

90
౪
1 Probabilities
Figure 1.35: The set A where the needle cuts the lower or upper line, respectively. Since a < 1, the lower
and upper parts of A do not overlap.
Remark 1.8.17. Suppose we throw the same needle n times. Let rn be the relative fre-
quency of the occurrence of A, that is,
rn = Number of throws where the needle cuts a line
n
.
As mentioned in Section 1.1.3, if n →∞, then rn approaches ℙ(A) = 2a
π . Thus for large n,
we have rn ≈2a
π or, equivalently, π ≈2a
rn . Consequently, throwing the needle sufficiently
often, 2a
rn should be close16 to π.
Summary: The uniform distribution ℙon a bounded Borel set K ⊆ℝn with voln(K) > 0 is defined by
ℙ(B) = voln(B ∩K)
voln(K)
,
B ∈ℬ(ℝn) .
1.9 Products of probability spaces∗
1.9.1 Product σ-fields and measures
Suppose we execute n (maybe different) random experiments so that the outcomes do
not depend on each other. In order to describe these n experiments, two different ap-
proaches are possible. Firstly, we record each single result separately, that is, we have n
16 For example, in 1901 Mr. Lazzerini threw a needle of length a = 5/6 exactly 3408 times. In 1808 of the
cases, the needle cut a line, leading to 3.1416 as an approximate value of π.

1.9 Products of probability spaces∗
౪
91
(maybe different) probability spaces (Ω1, 𝒜1, ℙ1) to (Ωn, 𝒜n, ℙn) modeling the outcomes
of the first up to the nth experiment.
A second possible approach is that we combine the n experiments into a single one.
Thus, instead of n different outcomes ω1 to ωn, we observe now a single vector ω =
(ω1, . . . , ωn). The sample space in this approach is given by Ω = Ω1 × ⋅⋅⋅× Ωn.
Example 1.9.1. When rolling a die n times, the outcome is a series of n numbers ω1 to
ωn, each in {1, . . . , 6}. Now, imagine we have a die with 6n equally likely faces. On these
faces, all possible sequences of length n with entries from {1, . . . , 6} are written. Roll this
die once. The first experiment may be described by n probability spaces, one for each
roll. The second experiment involves only one probability space. Nevertheless, both ex-
periments lead to the same result, a random sequence of numbers from 1 to 6.
It is intuitively clear that both approaches to this experiment (rolling a die n
times) are equivalent; they differ only by the point of view. But how to come from
one model to the other? One direction is immediately clear. If the random result is a
vector ω = (ω1, . . . , ωn), then its coordinates may be taken as the results of the single
experiments.17 But how about the other direction? That is, we are given n probability
spaces (Ω1, 𝒜1, ℙ1), . . . , (Ωn, 𝒜n, ℙn) and have to construct a model for the joint execution
of these experiments.
Of course, the “new” sample space is
Ω = Ω1 × ⋅⋅⋅× Ωn ,
(1.80)
but what are 𝒜and ℙ? We start with the construction of the product σ-field.
Definition 1.9.2. Let 𝒜j be σ-fields on Ωj, 1 ≤j ≤n. Set Ω = Ω1 × ⋅⋅⋅× Ωn. Then
𝒜= σ{A1 × ⋅⋅⋅× An : Aj ∈𝒜j}
is called the product σ-field of 𝒜1 to 𝒜n, denoted by 𝒜= 𝒜1 ⊗⋅⋅⋅⊗𝒜n.
Remark 1.9.3. In other words, 𝒜is the smallest σ-field containing measurable rectangle
sets, that is, sets of the form A1 × ⋅⋅⋅× An with Aj ∈𝒜j, 1 ≤j ≤n.
It is easy to see that 𝒫(Ω1) ⊗⋅⋅⋅⊗𝒫(Ωn) = 𝒫(Ω). A more complicated example is as
follows.
Proposition 1.9.4. Suppose Ω1 = ⋅⋅⋅= Ωn = ℝ, hence Ω = ℝn. Then the σ-field ℬ(ℝn) of
Borel sets in ℝn is the n-fold product of the σ-fields ℬ(ℝ) of Borel sets in ℝ, that is,
17 Of course, one still has to verify that the distribution of the coordinates is the same as in the single
experiments. But before we can do this, we need a probability measure describing the distribution of
the vectors (cf. Proposition 1.9.10).

92
౪
1 Probabilities
ℬ(ℝn) = ℬ(ℝ) ⊗⋅⋅⋅⊗ℬ(ℝ)
⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟
n times
.
Proof. We only give a sketch of the proof. Let Q be a box as in eq. (1.73). Then we have
Q = A1 × ⋅⋅⋅× An, where the Ajs are intervals, hence in ℬ(ℝ). By the construction of the
product σ-field, it follows that Q ∈ℬ(ℝ) ⊗⋅⋅⋅⊗ℬ(ℝ). But ℬ(ℝn) is the smallest σ-field
containing all boxes, which lets us conclude
ℬ(ℝn) ⊆ℬ(ℝ) ⊗⋅⋅⋅⊗ℬ(ℝ) .
The inclusion in the other direction may be proved as follows: fix a2 < b2 to an < bn and
let
𝒞1 = {C ∈ℬ(ℝ) : C × [a2, b2] × ⋅⋅⋅× [an, bn] ∈ℬ(ℝn)} .
It is not difficult to prove that 𝒞1 is a σ-field. If C = [a1, b1], then
C × [a2, b2] × ⋅⋅⋅× [an, bn]
is a box, thus in ℬ(ℝn). Consequently, 𝒞1 contains closed intervals, hence, since ℬ(ℝ)
is the smallest σ-field with this property, it follows 𝒞1 = ℬ(ℝ). This tells us that for all
B1 ∈ℬ(ℝ) and all aj < bj,
B1 × [a2, b2] × ⋅⋅⋅× [an, bn] ∈ℬ(ℝn) .
In a next step, fix B1 ∈ℬ(ℝ) and a3 < b3 up to an < bn, and set
𝒞2 = {C ∈ℬ(ℝ) : B1 × C × [a3, b3] × ⋅⋅⋅× [an, bn] ∈ℬ(ℝn)} .
By the same arguments as before, but now using the first step, we get 𝒞2 = ℬ(ℝ), that is,
B1 × B2 × [a3, b3] × ⋅⋅⋅× [an, bn] ∈ℬ(ℝn)
for all B1, B2 ∈ℬ(ℝ) and aj < bj.
Iterating further, we finally obtain that for all Bj ∈ℬ(ℝ) it follows that
B1 × ⋅⋅⋅× Bn ∈ℬ(ℝn) .
Since ℬ(ℝ) ⊗⋅⋅⋅⊗ℬ(ℝ) = σ{B1 × ⋅⋅⋅× Bn : Bj ∈ℬ(ℝ)} is the smallest σ-field containing
sets B1 × ⋅⋅⋅× Bn, this implies
ℬ(ℝ) ⊗⋅⋅⋅⊗ℬ(ℝ) ⊆ℬ(ℝn)
and completes the proof.

1.9 Products of probability spaces∗
౪
93
Let us now turn to the probability measure ℙon (Ω, 𝒜) that describes the combined
experiment.
Definition 1.9.5. Let (Ω1, 𝒜1, ℙ1) to (Ωn, 𝒜n, ℙn) be n probability spaces. Define Ω by eq. (1.80) and en-
dow it with the product σ-field 𝒜= 𝒜1 ⊗⋅⋅⋅⊗𝒜n. A probability measure ℙon (Ω, 𝒜) is called the product
measure of ℙ1, . . . , ℙn if
ℙ(A1 × ⋅⋅⋅× An) = ℙ1(A1) ⋅⋅⋅ℙn(An)
for all Aj ∈𝒜j .
(1.81)
We write ℙ= ℙ1 ⊗⋅⋅⋅⊗ℙn and if ℙ1 = ⋅⋅⋅= ℙn = ℙ0 set
ℙ⊗n
0 := ℙ0 ⊗⋅⋅⋅⊗ℙ0
⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟
n times
.
It is not clear at all whether product measures exist and, if this is so, whether condition
(1.81) determines them uniquely. The next result shows that the answer to both ques-
tions is affirmative. Unfortunately, the proof is too complicated to be presented here.
The idea is quite similar to that used in the introduction of volumes in eq. (1.77). The
boxes appearing there have to be replaced by rectangle sets A1 × ⋅⋅⋅× An with Aj ∈𝒜j
and the volume of the boxes by ℙ1(A1) to ℙn(An), respectively. We refer to [Dur19, Sec-
tion 1.7], [Kle20] or [Coh13], for a detailed proof for the existence (and uniqueness) of
product measures.
Proposition 1.9.6. Let (Ω1, 𝒜1, ℙ1), . . . , (Ωn, 𝒜n, ℙn) be probability spaces. Define Ω by
eq. (1.80) and let 𝒜be the product σ-field of the 𝒜js. Then there is a unique probability
measure ℙon (Ω, 𝒜) satisfying
ℙ(A1 × ⋅⋅⋅× An) = ℙ1(A1) ⋅⋅⋅ℙn(An)
for all Aj ∈𝒜j .
(1.82)
Hence, the product measure ℙ= ℙ1 ⊗⋅⋅⋅⊗ℙn always exists and is uniquely determined
by (1.82).
Remark 1.9.7. While the product measure of rectangle sets can be evaluated directly by
eq. (1.82), it is more complicated to determine the probability for arbitrary non-rectangle
sets. Compare Figures 1.36 and 1.37.
Example 1.9.8. Let Ω1 = Ω2 = {1, . . . , 6} be endowed with the uniform distributions ℙ1
and ℙ2. That is, ℙ1({ω}) = ℙ2({ω}) = 1
6 for all ω = 1, . . . , 6. Then
Ω = Ω1 × Ω2 = {(ω1, ω2) : ω1, ω2 ∈{1, . . . , 6}} ,
and we get
(ℙ1 ⊗ℙ2)(A1 × A2) = ℙ1(A1) ⋅ℙ2(A2) = |A1|
6
⋅|A2|
6
= |A1 × A2|
36

94
౪
1 Probabilities
Figure 1.36: The product measure ℙ1 ⊗ℙ2 applied to rectangle sets in Ω1 × Ω2.
Figure 1.37: How to evaluate (ℙ1 ⊗ℙ2)(K) ? Cover it in an optimal way by unions of rectangles.
for all A1 ⊆Ω1 and A2 ⊆Ω2. So we see that
(ℙ1 ⊗ℙ2)(B) = |B|
36 = ℙ(B)
whenever B = A1 × A2 is a rectangle set and where ℙdenotes the uniform distribution
on Ω = {1, . . . , 6}2. Since ℙ1 ⊗ℙ2 is uniquely determined by its values at rectangle sets, it
follows that the product measure is nothing else as the uniform distribution on Ω. For
example, this implies that
(ℙ1 ⊗ℙ2)({(1, 1), (2, 2), . . . , (6, 6)}) = 6
36 = 1
6 .
Note that {(1, 1), . . . , (6, 6)} is no rectangle set, hence in this case, formula (1.82) does not
apply.
Corollary 1.9.9. Let ℙ1, . . . , ℙn be probability measures on (ℝ, ℬ(ℝ)). Then there is a
unique probability measure ℙon (ℝn, ℬ(ℝn)) such that
ℙ(B1 × ⋅⋅⋅× Bn) = ℙ1(B1) ⋅⋅⋅ℙn(Bn)
for all Bj ∈ℬ(ℝ) .
Proof. The proof is a direct consequence of Propositions 1.9.6 and 1.9.4. Indeed, take
ℙ= ℙ1 ⊗⋅⋅⋅⊗ℙn and observe that ℬ(ℝn) = ℬ(ℝ) ⊗⋅⋅⋅⊗ℬ(ℝ).

1.9 Products of probability spaces∗
౪
95
Let us shortly come back to the question asked at the beginning of this section. Sup-
pose we observe a vector ω = (ω1, . . . , ωn). How are the coordinates distributed?
Proposition 1.9.10. Let (Ω, 𝒜, ℙ) be the product probability space of (Ω1, 𝒜1, ℙ1) to
(Ωn, 𝒜n, ℙn). If j ≤n and A ∈𝒜j, then
ℙ{(ω1, . . . , ωn) ∈Ω : ωj ∈A} = ℙj(A) .
Proof. Observe that
{(ω1, . . . , ωn) ∈Ω : ωj ∈A} = Ω1 × ⋅⋅⋅× Ωj−1 × A × Ωj+1 × ⋅⋅⋅× Ωn ,
thus eq. (1.81) implies (see Figure 1.38)
ℙ{(ω1, . . . , ωn) ∈Ω : ωj ∈A}
= ℙ1(Ω1) ⋅⋅⋅ℙj−1(Ωj−1) ⋅ℙj(A) ⋅ℙj+1(Ωj+1) ⋅⋅⋅ℙn(Ωn) = ℙj(A),
as asserted.
Figure 1.38: The product measure ℙ1 ⊗ℙ2 applied to the cylindrical shaped sets A × Ω2 and Ω1 × B.
How do we get product measures in concrete cases? We answer this question for
discrete and continuous probability measures separately.
1.9.2 Product measures: discrete case
Let Ω1 to Ωn be either finite or countably infinite sets. Given probability measures ℙj
defined on 𝒫(Ωj), 1 ≤j ≤n, the following result characterizes the product measure of
the ℙjs.

96
౪
1 Probabilities
Proposition 1.9.11. Probability measure ℙis the product measure of ℙ1, . . . , ℙn if and
only if
ℙ({ω}) = P1({ω1}) ⋅⋅⋅ℙn({ωn})
for all ω = (ω1, . . . , ωn) ∈Ω .
(1.83)
Proof. One direction is easy. Indeed, if ℙ= ℙ1 ⊗⋅⋅⋅⊗ℙn, given ω = (ω1, . . . , ωn) ∈Ω set
A = {ω} and Aj = {ωj}. Then A = A1 × ⋅⋅⋅× An, hence
ℙ({ω}) = ℙ(A) = ℙ1(A1) ⋅⋅⋅ℙn(An) = P1({ω1}) ⋅⋅⋅ℙn({ωn}),
proving eq. (1.83).
To verify the other implication, let ℙbe a probability measure on (Ω, 𝒫(Ω)) satisfy-
ing (1.83). We have to show that ℙfulfills eq. (1.81). Thus choose arbitrary Aj ⊆Ωj and set
A = A1 × ⋅⋅⋅× An. By applying eq. (1.83), it follows that
ℙ(A) = ∑
ω∈A
ℙ({ω}) =
∑
(ω1,...,ωn)∈A
ℙ({(ω1, . . . , ωn)})
=
∑
ω1∈A1,...,ωn∈An
P1({ω1}) ⋅⋅⋅ℙn({ωn})
= ∑
ω1∈A1
ℙ1({ω1}) ⋅⋅⋅∑
ωn∈An
ℙn({ωn}) = ℙ1(A1) ⋅⋅⋅ℙn(An) .
This being true for all Aj ⊆Ωj shows that ℙ= ℙ1 ⊗⋅⋅⋅⊗ℙn, and the proof is complete.
Summary: In the discrete case, the product measure is characterized as follows. Given A ⊆Ω,
(ℙ1 ⊗⋅⋅⋅⊗ℙn)(A) =
∑
(ω1,...,ωn)∈A
ℙ1({ω1}) ⋅⋅⋅ℙn({ωn}) .
Example 1.9.12. Suppose two players, say U and V, each simultaneously toss a biased
coin. On both coins, “0” (failure) appears with probability 1 −p and “1” (success) with
probability p. Whoever gets the first “1” wins.
A pair (k, l) ∈ℕ2 occurs if player U has his first success in trial k and player V in
trial l. Each single experiment is described by the geometric distribution Gp, hence the
model for the combined experiment is (ℕ2, 𝒫(ℕ2), G⊗2
p ). Here
G⊗2
p (A) =
∑
(k,l)∈A
Gp({k})Gp({l}) =
∑
(k,l)∈A
p2(1 −p)k+l−2 ,
A ⊆ℕ2 .
If A = {(k, k) : k ≥1}, that is, the game ends in a draw, then
G⊗2
p (A) = p2
∞
∑
k=1
(1 −p)2k−2 =
p2
1 −(1 −p)2 =
p
2 −p .

1.9 Products of probability spaces∗
౪
97
Consequently, with probability
1 −
p
2 −p = 2 −2p
2 −p ,
either U or V wins. Since both players have the same chance to win, it follows that U
wins with probability 1−p
2−p and the same is true for V.
If we analyze the result, then we see that we have three possible outcomes of the
game: U wins or V wins, each with probability 1−p
2−p, or the game ends in a draw with
probability
p
2−p. In the case of a fair coin, that is, if p = 1/2, these three outcomes each
occur with probability 1/3. In the general setting, the following is true: the bigger the
success probability p, the more likely the game ends in a draw. On the contrary, if p is
near zero, then with great probability there will be a winner of the game.
Example 1.9.13. Toss a biased coin n times. Say the coin is labeled with “0” and “1”
and p ∈[0, 1] is the probability of the occurrence of “1.” Recording each single result
separately, the describing probability spaces are ({0, 1}, 𝒫({0, 1}), ℙj), 1 ≤j ≤n, with
ℙj({1}) = p. Which probability space does the combined result describe?
Answer: Of course, the sample space is {0, 1}n endowed with σ-field 𝒫(Ω). Let ω =
(ω1, . . . , ωn) be an arbitrary vector in Ω. Then by Proposition 1.9.11, the product measure
ℙof the ℙjs is characterized by
ℙ({ω}) = ℙ1({ω1}) ⋅⋅⋅ℙn({ω}) = pk(1 −p)n−k
where k = |{j ≤n : ωj = 1}| = ∑n
j=1 ωj .
For example, tossing the coin five times, the sequence (0, 0, 1, 1, 0) occurs with prob-
ability p2(1 −p)3.
In the general case, let A be the set of sequences possessing exactly k times the num-
ber “1.” Then
(ℙ1 ⊗⋅⋅⋅⊗ℙn)(A) =
∑
(ω1,...,ωn)∈A
ℙ1({ω1}) ⋅⋅⋅ℙn({ωn})
= |A| ⋅pk(1 −p)n−k = (n
k)pk(1 −p)n−k .
This is another justification for the model described by the binomial distribution Bn,p.
Example 1.9.14. Suppose we have two urns, both containing the same proportion of
white balls. Choose from each urn n balls with replacement. How likely is it to take out
the same number of white balls from each of the two urns?
Answer: The experiment is described by the product measure B⊗2
n,p where p denotes
the proportion of white balls in each urn. Hence, the probability to observe k white balls
from the first urn and ℓfrom the second one equals
(n
k)(n
ℓ)pk+ℓ(1 −p)2n−k−ℓ,
0 ≤k, ℓ≤n .

98
౪
1 Probabilities
Consequently, if A is the event that one chooses the same number of white balls, then
B⊗2
n,p(A) =
n
∑
k=0
(n
k)
2
p2k(1 −p)2n−2k .
(1.84)
Look at Figure 1.39 to get an impression how the probability of the event A depends on
the success probability p. For example, if either p = 0 or p = 1, then, of course, we will
for sure see the same number of white balls out of the two urns. Argue why we get the
same probability for A when we replace p by 1 −p.
Figure 1.39: The probability to observe the same number of white balls, when choosing 20 balls, depend-
ing on the proportion p. The minimal value is 0.125371 attained at p = 0.5.
If p = 1/2, then eq. (1.84) reduces to (use formula (A.19))
1
22n
n
∑
k=0
(n
k)
2
=
1
22n (2n
n ) .
Remark 1.9.15. Stirling’s formula (Corollary 1.6.15) implies
1
2
1
√πn <
1
22n (2n
n ) <
1
√πn ,
n = 1, 2, . . .
Hence, if in both urns the number of white balls equals that of black, then for large n the
probability to observe from both urns the same number of white balls is approximately
1/√πn.

1.9 Products of probability spaces∗
౪
99
1.9.3 Product measures: continuous case
Here we assume Ω1 = ⋅⋅⋅= Ωn = ℝ, hence the product sample space is Ω = ℝn. Further-
more, each Ωj = ℝis endowed with the Borel σ-field. Because of Proposition 1.9.4, the
product σ-field on Ω = ℝn is given by ℬ(ℝn).
The next proposition characterizes the product measure of continuous probability
measures.
Proposition 1.9.16. Let ℙ1, . . . , ℙn be probability measures on (ℝ, ℬ(ℝ)) with respective
density functions p1, . . . , pn, that is,
ℙj([a, b]) =
b
∫
a
pj(x)dx ,
1 ≤j ≤n .
Define p : ℝn →[0, ∞) by
p(x) = p1(x1) ⋅⋅⋅pn(xn) ,
x = (x1, . . . , xn) ∈ℝn .
(1.85)
Then the product measure ℙ1⊗⋅⋅⋅⊗ℙn is continuous with (n-dimensional) density p defined
by (1.85). In other words, for each Borel set A ⊆ℝn,
(ℙ1 ⊗⋅⋅⋅⊗ℙn)(A) = ∫⋅⋅⋅∫
⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟
A
p1(x1) ⋅⋅⋅pn(xn) dxn ⋅⋅⋅dx1 = ∫
A
p(x) dx .
Proof. First note that p is a density of the product measure ℙ1 ⊗⋅⋅⋅⊗ℙn if
(ℙ1 ⊗⋅⋅⋅⊗ℙn)(Q) = ∫
Q
p(x) dx
for all boxes Q = [a1, b1] × ⋅⋅⋅× [an, bn]. But this is an immediate consequence of
∫
Q
p(x)dx =
b1
∫
a1
⋅⋅⋅
bn
∫
an
p1(x1) ⋅⋅⋅pn(xn)dxn ⋅⋅⋅dx1
= (
b1
∫
a1
p1(x1)dx1) ⋅⋅⋅(
bn
∫
an
pn(xn)dxn) = ℙ1([a1, b1]) ⋅⋅⋅ℙn([an, bn])
= (ℙ1 ⊗⋅⋅⋅⊗ℙn)([a1, b1] × ⋅⋅⋅× [an, bn]) = (ℙ1 ⊗⋅⋅⋅⊗ℙn)(Q).
This completes the proof.
Because of its importance, let us explain through several examples how Proposi-
tion 1.9.16 applies. Further applications, for example, the characterization of indepen-
dent random variables, will follow in Sections 3 and 8.

100
౪
1 Probabilities
Example 1.9.17. Let the probability measures ℙj, 1 ≤j ≤n, be uniform distributions on
[αj, βj]. Thus
pj(x) =
{
{
{
1
βj−αj
if αj ≤x ≤βj,
0
otherwise,
henceforth, if x = (x1, . . . , xn), then
p(x) = p1(x1) ⋅⋅⋅pn(xn) =
{
{
{
1
∏j≤n(βj−αj)
if x ∈K,
0
otherwise.
Here K ⊆ℝn is the box [α1, β1]×⋅⋅⋅×[αn, βn]. Since ∏j≤n(βj −αj) = voln(K), it follows
that the product measure ℙ1 ⊗⋅⋅⋅⊗ℙn is nothing else as the (n-dimensional) uniform
distribution on K as introduced in18 Definition 1.8.13.
Summary: The product measure of n uniform distributions on intervals [αj, βj] is the uniform distribution
on the box [α1, β1] × ⋅⋅⋅× [αn, βn].
Example 1.9.18. Let ℙbe the uniform distribution on the unit sphere
K = {(x1, x2) ∈ℝ2 : x2
1 + x2
2 ≤1} .
That is,
ℙ(A) = vol2(A ∩K)
π
,
A ∈ℬ(ℝ2) .
The density p of ℙis given by
p(x1, x2) = {
1
π
if x2
1 + x2
2 ≤1,
0
otherwise.
Then there are no functions p1, p2 on ℝfor which
p(x1, x2) = p1(x1) ⋅p2(x2) ,
x1, x2 ∈ℝ.
Indeed, if such a representation were to exist, then p2(x2) = 0 if x2
1 > 1 −x2
1 for all
−1 ≤x1 ≤1. Hence, p2(x2) = 0 for all x2. This contradicts the representation of the
density p. Consequently, ℙis not a product measure.
18 This result was already used in Example 1.8.14. Indeed, the arrival times t1 and t2 were described
by the uniform distributions on [1, 2], thus the pair t = (t1, t2) is distributed according to the product
measure, which is the uniform distribution on [1, 2] × [1, 2]. Similarly, in Example 1.8.16, we applied that
the pair (θ, x) is uniformly distributed on [−π/2, π/2] × [0, 1].

1.9 Products of probability spaces∗
౪
101
Example 1.9.19. Assume now ℙ1 = ⋅⋅⋅= ℙn = Eλ, that is, we want to describe the
product of n exponential distributions with parameter λ > 0. Since pj(s) = λe−λs if s ≥0
and pj(s) = 0 if s < 0, their product measure E⊗n
λ
possesses the density
p(s1, . . . , sn) = {λn e−λ(s1+⋅⋅⋅+sn)
if s1, . . . , sn ≥0,
0
otherwise.
Which random experiment does E⊗n
λ
describe? Suppose we have n light bulbs of the
same type with lifetime distributed according to Eλ. Switch on all n bulbs at once and
record the times t1, . . . , tn where the first bulb, the second, and so on, burns out. If
t = (t1, . . . , tn) ∈ℝn denotes the generated vector of these times, then for Borel sets
A ⊆[0, ∞)n,
ℙ{t ∈A} = E⊗n
λ (A) = λn ∫
A
e−λ(s1+⋅⋅⋅+sn)ds1 ⋅⋅⋅dsn .
For example, if we want to compute the probability of
A := {(t1, . . . , tn) : 0 ≤t1 ≤⋅⋅⋅≤tn} ,
that is, that the second bulb burns longer than the first, the third longer than the second,
and so on, then
E⊗n
λ (A) = λn
∞
∫
0
e−λsn
sn
∫
0
e−λsn−1
sn−1
∫
0
⋅⋅⋅
s3
∫
0
e−λs2
s2
∫
0
e−λs1 ds1 ⋅⋅⋅dsn .
Iterative integration leads to E⊗n
λ (A) = 1/n!. This is more or less obvious by the following
observation. Each ordering of the failure times is equally likely. And since there are n!
different ways to order these times, each ordering has probability 1/n!. In particular, this
is true for the ordering t1 ≤⋅⋅⋅≤tn.
Next we ask how likely is it that all n bulbs still burn at time T > 0. That is, we ask
for the probability E⊗n
λ (B) where B = [T, ∞)n. The properties of product measures imply
that
E⊗n
λ (B) = Eλ([T, ∞)) ⋅⋅⋅Eλ([T, ∞))
⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟
n
= enλT .
Consequently, the probability that at least one of the n bulbs burns out before time T > 0
equals 1 −enλT. In other words, if we say that the system of n bulbs becomes defective if
at least one bulb burns out, then the lifetime of this system is exponentially distributed
with parameter nλ.
Next we give another example of a product measure that will play a crucial role in
Sections 6 and 8.

102
౪
1 Probabilities
Example 1.9.20. Let ℙ1, . . . , ℙn be standard normal distributions. The corresponding
densities are
pj(xj) =
1
√2π
e−x2
j /2 ,
1 ≤j ≤n .
Thus, by eq. (1.85), the density p of their product 𝒩(0, 1)⊗n coincides with
p(x) =
1
(2π)n/2 e−∑n
j=1 x2
j /2 =
1
(2π)n/2 e−|x|2/2 ,
where |x| = (∑n
j=1 x2
j )1/2 denotes the Euclidean distance of the vector x to 0 (see Sec-
tion A.4).
See Figure 1.40 for the visualization of the density p in the case n = 2.
Figure 1.40: The density of the two-dimensional standard normal distribution.
Definition 1.9.21. The probability measure 𝒩(0, 1)⊗n on ℬ(ℝn) is called the n-dimensional, or multi-
variate, standard normal distribution. It is described by
𝒩(0, 1)⊗n(B) =
1
(2π)n/2 ∫
B
e−|x|2/2 dx .
For example, if K ⊆ℝ2 denotes a circle of radius 1, then this leads to the following
integral:
𝒩(0, 1)⊗2(K) = 1
2π ∬
K
e−x2
1/2e−x2
2/2dx1dx2
= 1
π
1
∫
−1
e−x2
1/2
√1−x2
1
∫
0
e−x2
2/2dx2dx1
= 2
π
1
∫
0
e−x2
1/2
√1−x2
1
∫
0
e−x2
2/2dx2dx1 ≈0.393 .

1.10 Problems
౪
103
Example 1.9.22. Finally, we describe the n-fold product measure of general normal dis-
tributions 𝒩(μj, σ2
j ) with μj ∈ℝand σj
2 > 0. The densities are
pj(xj) =
1
√2π σj
e−(xj−μj)2/2σ2
j ,
1 ≤j ≤n .
Hence, the product measure 𝒩(μ1, σ2
1) ⊗⋅⋅⋅⊗𝒩(μn, σ2
n) possesses the density
p(x) =
1
(2π)n/2σ1 ⋅⋅⋅σn
exp(−
n
∑
j=1
(xj −μj)2
2σ2
j
) ,
x = (x1, . . . , xn) ∈ℝn .
In particular, if 𝒩(μ1, σ2
1) = ⋅⋅⋅= 𝒩(μn, σ2
n) = 𝒩(μ, σ2) by
n
∑
j=1
(xj −μj)2
2σ2
j
= |x −⃗μ|2
2σ2
,
where ⃗μ = (μ, . . . , μ), the n-fold product measure of 𝒩(μ, σ2) acts as follows:
𝒩(μ, σ2)
⊗n(B) =
1
(2π)n/2σn ∫
B
e−|x−⃗μ|2/2σ2
dx ,
B ∈ℬ(ℝn) .
(1.86)
Summary: Let (Ω1, 𝒜1, ℙ1) up to (Ωn, 𝒜n, ℙn) be probability spaces. Then there exists a unique probability
measure ℙ= ℙ1 ⊗⋅⋅⋅⊗ℙn (the product measure) on Ω = Ω1 × ⋅⋅⋅× Ωn such that
ℙ(A1 × ⋅⋅⋅× An) = ℙ1(A1) ⋅⋅⋅ℙn(An) ,
Aj ∈𝒜j .
In the discrete case, the product measure ℙis described by
ℙ(A) =
∑
(ω1,...,ωn)∈A
ℙ1({ω1}) ⋅⋅⋅ℙn({ωn}) ,
A ⊆Ω ,
while for continuous ℙj with densities pj the product measure is given by
ℙ(B) = ∫⋅⋅⋅∫
B
p1(x1) ⋅⋅⋅pn(xn) dxn ⋅⋅⋅dx1 ,
B ∈ℬ(ℝn) .
1.10 Problems
Problem 1.1. Let A, B, and C be three events in a sample space Ω. Express the following
events in terms of these sets:
–
Only A occurs.
–
A and B occur, but C does not.
–
At least one of the three events occurs.

104
౪
1 Probabilities
–
At least two of the events occur.
–
At most one of the three events occurs.
–
None of the events occur.
–
Not more than two of the events occur.
–
Exactly two of the events occur.
Problem 1.2. Suppose an urn contains black and white balls. Successively one draws n
balls out of the urn. The event Aj occurs if the ball drawn in the jth trial is white. Hereby
1 ≤j ≤n. Express the following events B1, . . . , B4 in terms of the Ajs:
B1 = {All drawn balls are white},
B2 = {At least one of the balls is white},
B3 = {Exactly one of the drawn balls is white},
B4 = {All n balls possess the same color}.
Determine the cardinalities |Bj|, j = 1, . . . , 4.
Problem 1.3. Argue why for every t ∈ℝthe elementary event {t} is a Borel set. What is
wrong in the following argument? Since for any set B ⊆ℝone has
B = ⋃
t∈B
{t} ,
every subset B of ℝis union of Borel sets. Because ℬ(ℝ) is a σ-field, the union of Borel
sets is a Borel set as well. Thus, any B ⊆ℝis a Borel set.
Problem 1.4. Suppose ℙis a σ-additive mapping from a σ-field 𝒜to [0, 1] with ℙ(Ω) = 1.
Show that then necessarily ℙ(0) = 0. Consequently, whenever a σ-additive mapping ℙ
satisfies ℙ(Ω) = 1, then it is a probability measure.
Problem 1.5. Let ℙbe a probability measure on (Ω, 𝒜). Given A, B ∈𝒜, show that
ℙ(AΔB) = ℙ(A) + ℙ(B) −2ℙ(A ∩B) .
Problem 1.6. The events A and B possess the probabilities ℙ(A) = 1/3 and ℙ(B) = 1/4.
Moreover, we know that ℙ(A ∩B) = 1/6. Compute ℙ(Ac), ℙ(Ac ∪B), ℙ(A ∪Bc), ℙ(A ∩Bc),
ℙ(AΔB), and ℙ(Ac ∪Bc).
Problem 1.7 (Inclusion–exclusion formula). Let (Ω, 𝒜, ℙ) be a probability space and let
A1, . . . , An ∈𝒜be some (not necessarily disjoint) events. Prove that
ℙ(
n
⋃
j=1
Aj) =
n
∑
k=1
(−1)k+1
∑
1≤j1<⋅⋅⋅<jk≤n
ℙ(Aj1 ∩⋅⋅⋅∩Ajk) .
Hint: One way to prove this is by induction over n, thereby using Proposition 1.2.3.

1.10 Problems
౪
105
Problem 1.8. Use Problem 1.7 to investigate the following question: The numbers from
1 to n are ordered randomly. All orderings are equally likely. What is the probability that
there exists an integer m ≤n so that m is at position m of the ordering? Determine the
limit of this probability as n →∞.
Another version of this problem is as follows. Suppose n persons attend a Christmas
party. Each of the n participants brings a present with him. These presents are collected,
mixed, and then randomly distributed among the guests. Compute the probability that
at least one of the participants gets his own present.
Problem 1.9. Suppose there are N balls in an urn; k are white, l are red, and m are black.
Thus, k +l +m = N. Choose n balls out of the urn. Find a formula for the probability that
among the n chosen balls are those of all three colors. Investigate this problem if
1.
the chosen ball is always replaced and
2.
if n ≤N and the balls are not replaced.
Hint: If A is the event that all three colors appear then compute ℙ(Ac). To this end, write
Ac = A1 ∪A2 ∪A3 with suitable Ajs and apply Proposition 1.2.4.
Problem 1.10. As in Example 1.4.19, choose 9 balls with replacement out of an urn con-
taining 3 white, 5 red and 4 black balls. How likely is it that among the 9 chosen balls are
those of all three colors?
Problem 1.11. Suppose events A and B occur both with probability 1/2. Prove that then
ℙ(A ∪B) = ℙ(Ac ∪Bc) .
(1.87)
Does (1.87) remain valid assuming ℙ(A) + ℙ(B) = 1 instead of ℙ(A) = ℙ(B) = 1
2?
Problem 1.12. Three men and three women sit down randomly on six chairs in a row.
Find the probability that the three men and the three women sit side by side. What is
the probability that next to each woman sits a man (to the right or to the left)?
Problem 1.13. Let (Ω, 𝒜, ℙ) be a probability space. Prove the following: Whenever
events A1, A2, . . . in 𝒜satisfy ℙ(A1) = ℙ(A2) = ⋅⋅⋅= 1, then this implies
ℙ(
∞
⋂
j=1
Aj) = 1 .
Problem 1.14 (Paradox of Chevalier de Méré). Chevalier de Méré mentioned that when
rolling three fair indistinguishable dice there are 6 different possibilities for obtaining
either 11 or 12 as the sum. Thus he concluded that both events (sum equals 11 or sum
equals 12) should be equally likely. But experiments showed that this is not the case.
Why was he wrong and what are the correct probabilities for both events?

106
౪
1 Probabilities
Problem 1.15. A man has forgotten an important phone number. He only remembers
that the seven-digit number contained three times “1,” and “4” and “6” twice each. He
dials the seven numbers in random order. Find the probability that he dialed the correct
one.
Problem 1.16. In an urn there are n black and m red balls. One successively draws all
n + m balls (without replacement). What is the probability that the ball chosen last is
red?
Problem 1.17. A man has in his pocket n keys to open a door. Only one of the keys fits. He
tries the keys one after another until he has chosen the correct one. Given an integer k,
compute the probability that the correct key is the one chosen in the kth trial.
Evaluate this probability in each of the two following cases:
–
The man always discards wrong keys.
–
The man does not discard them, that is, he puts back wrong keys.
Problem 1.18 (Monty Hall problem). At the end of a quiz, the winner has the choice be-
tween three doors, say A, B, and C. Behind two of the doors there is a goat, behind the
third one is a car. His prize is what is behind the chosen door.
Say the winner has chosen door A. Then the quizmaster (who knows what is behind
each of the three doors) opens one of the two remaining doors (in our case either door
B or door C) and shows that there is a goat behind it. After that the quizmaster asks the
candidate whether or not he wants to revise his decision, that is, for example, if B was
opened, to switch from A to C, or if he furthermore chooses door A.
Find the probabilities to win the car in both cases (switching or nonswitching).
Problem 1.19. In a lecture room there are N students. Evaluate the probability that at
least two of the students were born on the same day of a year (day and month of their
births are the same, but not necessarily the year). Hereby disregard leap years and as-
sume that all days in a year are equally likely. How big must N be in order that this
probability is greater than 1/2?
Hint: Try to evaluate the probability of the complementary event.
Problem 1.20. In an urn there are balls labeled from 0 to 6 so that all numbers are
equally likely. Choose successively and with replacement three balls. Find the proba-
bility that the three observed numbers sum up to 6.
Problem 1.21. As in Example 1.4.25, six persons enter independently of each other a
train with three coaches. How likely is it that no coach remains empty? Find the proba-
bility that there are exactly four persons in one of the three coaches.
Problem 1.22. When sending messages from A to B, on average 3 % are transmitted
falsely. Suppose 300 messages are sent. What is the probability that at least three mes-
sages are transmitted falsely? Evaluate the exact probability by using the binomial

1.10 Problems
౪
107
distribution as well as the approximate probability by using the Poisson distribution.
Compute the probability (exact and approximate one) that all messages arrive cor-
rectly.
Problem 1.23 (C. Huygens, 1657). How often does one have to roll two fair dice in order
to observe the sum 12 with a probability greater than or equal to 1/2?
Problem 1.24. Suppose you are given 11 tiles labeled with letters. One tile is labeled with
“M,” two with “P” four tiles are labeled with “I,” and, finally, also four with “S.” Order
the tiles randomly in a row so that all orders are equally likely. Find the probability to
end up with the word “MISSISSIPPI.”
Problem 1.25. The number of accidents in a city per week is assumed to be Poisson
distributed with parameter 5. Find the probability that next week there will be either
two or three accidents. How likely is it that there will be no accidents?
Problem 1.26. In a room there are 12 men and 8 women. One randomly chooses 5 of the
20 persons. Given k ∈{0, . . . , 5}, what is the probability that among the five chosen are
exactly k women? How likely is it that among the five persons are more women than
men?
Problem 1.27. Two players A and B take turns rolling a die. The first to roll a “6” wins.
Player A starts. Find the probability that A wins. Suppose now there is a third player C
and the order of rolling the die is given by ABCABCA. . . Find each player’s probability of
winning.
Problem 1.28. Two players, say A and B, toss a biased coin where “head” appears with
probability 0 < p < 1. Whoever gets the first “head” wins. Player A starts, then B tosses
twice, then again A once, B twice, and so on. Determine the number p for which the
game is fair, that is, the probability that A (or B) wins is 1/2.
Problem 1.29. In an urn there are 50 white and 200 red balls.
(1) Take out 10 balls with replacement. What is the probability to observe four white
balls? Give the exact value via the binomial distribution as well as the approximate
one using the related Poisson distribution.
(2) Next choose 10 balls without replacement. What is the probability to get four white
balls in this case?
(3) The number of balls in the urn is as above. But now we choose the balls with re-
placement until for the first time a white ball shows up. Find the probability of the
following events:
(a) The first white ball shows up in the fourth trial.
(b) The first white ball appears strictly after the third trial.
(c) The first white ball is observed in an even number of trials, that is, in the second,
or in the fourth, or in the sixth, and so on, trial.

108
౪
1 Probabilities
Problem 1.30. Place successively and independently four particles into five boxes.
Thereby each box is equally likely. Find the probabilities of the following events:
–
A := {Each box contains at most one particle} and
–
B := {All 4 particles are in the same box}.
Problem 1.31. Four students did not attend at an exam because they were on vacation
and drove home too late. Their excuse for missing the test was that they had a flat tire
on their way back. The professor tells them: “no problem, you can make up your exam
today”. He puts the four students in separate rooms and gives each a sheet of paper with
exactly one question: “Which of the four tires was flat?” How likely is it that the four
students gave the same answer?
Problem 1.32. Investigate the following generalization of Example 1.4.52: in urn U0
there are M balls and in urn U1 there are N balls for some N, M ≥1. Choose U0 with
probability 1 −p and U1 with probability p, and take out a ball from the chosen urn.
Given 1 ≤m ≤M, find the probability that there are m balls left in U0 when choosing the
last ball out of U1. How do these probabilities change when 1 ≤m ≤N, and we assume
that there are m balls in U1 when choosing the last ball from U0?
Problem 1.33. Let n ∈ℕ. Use properties of the gamma function to evaluate the follow-
ing integrals:
∞
∫
0
x2n e−x2/2 dx
and
∞
∫
0
x2n+1 e−x2/2 dx .
Problem 1.34. Prove formula (1.62) that relates the beta and gamma functions.
Hint: Start with
Γ(x)Γ(y) =
∞
∫
0
∞
∫
0
ux−1vy−1e−u−v dudv
and change the variables as follows: u = f (z, t) = zt and v = g(z, t) = z(1 −t), where
0 ≤z < ∞and 0 ≤t ≤1.
Problem 1.35. Prove that for integers n and k with 0 ≤k ≤n,
(n
k) =
1
(n + 1)B(n −k + 1, k + 1)
where B(⋅, ⋅) denotes Euler’s beta function (cf. formula (1.61)).
Problem 1.36. Write x ∈[0, 1) as finite or infinite decimal fraction x = 0.x1x2 . . . with
xj ∈{0, . . . , 9}. Fix some m ∈{0, . . . , 9} and set
Aj = {x ∈[0, 1) : xj = m} .

1.10 Problems
౪
109
That is, Aj contains those real numbers for which the jth digit in its decimal expansion
equals m. For example, if m = 4, then x = 0.2534114 . . . belongs to A4 and A7. Let ℙbe the
uniform distribution on [0, 1]. Evaluate
ℙ(Aj)
as well as
ℙ(
∞
⋂
j=1
Aj) .
Problem 1.37. If γ > 0 and x0 ∈ℝ, set
fx0,γ(x) = 1
π [
γ
(x −x0)2 + γ2 ] ,
x ∈ℝ.
Show that fx0,γ is a probability density. Why is the generated probability measure a gen-
eralization of the Cauchy distribution as introduced in Definition 1.6.37? Compute the
distribution function of the probability measure with density fx0,γ.
Problem 1.38. Let F : ℝ→[0, 1] be the distribution function of a probability measure.
Show that F possesses at most countably many points of discontinuity. Conclude from
this and Proposition 1.7.16 the following: If ℙis a probability measure on ℬ(ℝ), then
there are at most countably infinitely many t ∈ℝsuch that ℙ({t}) > 0.
Problem 1.39. Let Φ be the distribution function of the standard normal distribution
introduced in eq. (1.70). Show the following properties of Φ:
1.
Φ(0) = 1
2.
2.
For t ∈ℝ, one has Φ(−t) = 1 −Φ (t).
3.
If a > 0, then
𝒩(0, 1)([−a, a]) = 2 Φ(a) −1 .
4.
Prove formulas (1.71), that is,
Φ(t) = 1
2[1 + erf( t
√2
)]
and
erf(t) = 2Φ(√2 t) −1 ,
t ∈ℝ.
5.
Compute
lim
t→∞
1 −Φ(t)
t−1e−t2/2 .
Problem 1.40 (Bertrand paradox). Consider an equilateral triangle inscribed in a circle
of radius r > 0. Suppose a chord of the circle is chosen at random. What is the probability
that the chord is longer than a side of the triangle?
In this form, the problem allows different answers. Why? Because we did not define
in which way the random chord is chosen.
1.
The “random endpoints” method: Choose independently two uniformly distributed
random points on the circumference of the circle and draw the chord joining them.

110
౪
1 Probabilities
2.
The “random radius” method: Choose a radius of the circle, that is, choose a random
angle in [0, 2π], choose independently a point on the radius according to the uniform
distribution on [0, r], and construct the chord through this point and perpendicular
to the radius.
3.
The “random midpoint” method: Choose a point within the circle according to the
uniform distribution on the circle and construct a chord with the chosen point as
its midpoint.
Answer the above question about the length of the chord in each of the three cases.
Problem 1.41. A stick of length L > 0 is randomly broken into three pieces. Hereby
we assume that both break points are uniformly distributed on [0, L] and independent
of each other. What is the probability that these three parts piece together to form a
triangle?

2 Conditional probabilities and independence
2.1 Conditional probabilities
In order to motivate the definition of conditional probabilities, let us start with the fol-
lowing easy example.
Example 2.1.1. Roll a fair die twice. The probability of the event “sum of both rolls
equals 5” is 1/9. Suppose now we were told that the first roll was an even number. Does
this additional information make the event “sum equals 5” more likely? Or does it even
diminish the probability of its occurrence? To answer this question, we apply the so-
called technique of “restricting the sample space.” Since we know that the event B =
{First roll is even} had occurred, we may rule out elements in Bc and restrict our sam-
ple space. Choose B as the new sample space. Its cardinality is 18. Moreover, under this
condition, an event A occurs if and only if A ∩B does. Hence, the “new” probability of A
under condition B, written ℙ(A|B), is given by
ℙ(A|B) = |A ∩B|
|B|
= |A ∩B|
18
.
(2.1)
In the question above, we asked for ℙ(A|B), and have
A = {Sum of both rolls equals 5} = {(1, 4), (2, 3), (3, 2), (4, 1)}.
Since A ∩B = {(2, 3), (4, 1)}, we obtain ℙ(A|B) = 2/18 = 1/9. Consequently, in this case,
condition B does not change the probability of the occurrence of A.
Define now A as a set of pairs adding to 6. Then ℙ(A) = 5/36, while the conditional
probability remains 1/9. Note that now A∩B = {(2, 4), (4, 2)}. Thus, in this case, condition
B makes the occurrence of A less likely.
Before we state the definition of conditional probabilities in the general case, let us
rewrite eq. (2.1) as follows:
ℙ(A|B) = |A ∩B|
|B|
= |A ∩B|/36
|B|/36
= ℙ(A ∩B)
ℙ(B)
.
(2.2)
Equation (2.2) gives us a hint how to introduce conditional probabilities in the general
setting.
Definition 2.1.2. Let (Ω, 𝒜, ℙ) be a probability space. Given events A, B ∈𝒜with ℙ(B) > 0, the proba-
bility of A under condition B is defined by
ℙ(A|B) = ℙ(A ∩B)
ℙ(B)
.
(2.3)
https://doi.org/10.1515/9783111325064-002

112
౪
2 Conditional probabilities and independence
Remark 2.1.3. If we know the values of ℙ(A ∩B) and ℙ(B), then formula (2.3) allows us
to evaluate ℙ(A|B). Sometimes it happens that we know the values of ℙ(B) and ℙ(A|B)
and want to calculate ℙ(A ∩B). In order to do this, we rewrite eq. (2.3) as
ℙ(A ∩B) = ℙ(B) ℙ(A|B).
(2.4)
In this way, we get the desired value of ℙ(A ∩B). Formula (2.4) is called the law of mul-
tiplication.
The next two examples show how this law applies.
Example 2.1.4. In an urn there are two white and two black balls. Choose two balls
without replacing the first. We want to evaluate the probability of occurrence of a
black ball in the first draw and of a white in the second. Let us first find a suitable
mathematical model that describes this experiment. The sample space is given by
Ω = {(b, b), (b, w), (w, b), (w, w)}, and we consider the events
A = {Second ball is white} = {(b, w), (w, w)}
and
B = {First ball is black} = {(b, b), (b, w)} .
The event of interest is then A ∩B = {(b, w)}.
Which probabilities can be directly determined? Of course, the probability of oc-
currence of B equals 1/2 because the number of white and black balls is the same. Fur-
thermore, if B had occurred, then in the urn two white balls and one black ball have re-
mained. Under this condition, event A occurs with probability 2/3, that is, ℙ(A|B) = 2/3.
Using eq. (2.4), we obtain
ℙ({(b, w)}) = ℙ(A ∩B) = ℙ(B) ⋅ℙ(A|B) = 1
2 ⋅2
3 = 1
3.
Example 2.1.5. Among three indistinguishable coins, there are two fair and one biased.
Tossing the biased coin, “heads” appears with probability 1/3, hence “tails” appears with
probability 2/3. We choose at random one of the three coins and toss it. Find the proba-
bility to observe “tails” at the biased coin.
To solve this problem, let us first mention that the sample space Ω = {H, T} is not
adequate to describe that experiment. Why? Because the event {H} may have different
probabilities depending on the occurrence using a biased or a fair coin. We have to dis-
tinguish between the appearance of “heads” or “tails” for the different types of coin.
Hence, an adequate choice of the sample space is
Ω := {(H, B), (T, B), (H, F), (T, F)}.
Here, B stands for the biased and F for the fair coin. The event of interest is {(T, B)}. Set
T := {(T, B), (T, F)}
and
B := {(H, B), (T, B)}.

2.1 Conditional probabilities
౪
113
Then T occurs if “tails” appears regardless of the type of the coin while B occurs if we
have chosen the biased coin. Of course, it follows that {(T, B)} = T ∩B. Since only one
of the three coins is biased, we have ℙ(B) = 1/3. By assumption, ℙ(T|B) = 2/3, hence an
application of eq. (2.4) leads to
ℙ({(T, B)}) = ℙ(B) ℙ(T|B) = 1
3 ⋅2
3 = 2
9.
Next, we present two examples where formula (2.3) applies directly.
Example 2.1.6. Roll a die twice. One already knows that the first number is not “6”. What
is the probability that the sum of both rolls is greater than or equal to “10”?
Answer: The model for this experiment is Ω = {1, . . . , 6}2 endowed with the uniform
distribution ℙon 𝒫(Ω). The event B := {First result is not “6”} contains 30 elements,
namely
{(1, 1), . . . , (5, 1), . . . , (1, 6), . . . , (5, 6)},
and if A consists of pairs with the sum equal to or larger than 10, then
A = {(4, 6), (5, 6), (6, 6), (5, 5), (6, 5), (6, 4)},
hence A ∩B = {(4, 6), (5, 6), (5, 5)}.
Therefore, it follows that
ℙ(A|B) = ℙ(A ∩B)
ℙ(B)
= 3/36
30/36 = 1
10.
In the case that all elementary events are equally likely, there exists a more direct
way to evaluate ℙ(A|B). We reduce the sample space as we already did in Example 2.1.1.
Proposition 2.1.7 (Reduction of the sample space). Suppose the sample space Ω is finite
and let ℙbe the uniform distribution on 𝒫(Ω). Then for all events A and a nonempty B
in Ω, we have
ℙ(A|B) = |A ∩B|
|B|
.
(2.5)
Proof. This easily follows from
ℙ(A|B) = ℙ(A ∩B)
ℙ(B)
= |A ∩B|/|Ω|
|B|/|Ω|
= |A ∩B|
|B|
.
Example 2.1.8. We want to investigate Example 2.1.6 once more, this time using for-
mula (2.5) directly. Since |A ∩B| = 3 and |B| = 30, we get as before
ℙ(A|B) = |A ∩B|
|B|
= 3
30 = 1
10.

114
౪
2 Conditional probabilities and independence
Remark 2.1.9. It is important to state that Proposition 2.1.7 becomes false for general
probabilities ℙon 𝒫(Ω). Formula (2.5) is only valid in the case that ℙis the uniform
distribution on 𝒫(Ω).
Example 2.1.10. Toss a fair coin 5 times. How likely is it to observe 3 times “1” under the
condition that the first toss was a “1”?
Answer: The event A occurs if among the five tosses there are three with “1,” while
B occurs provided the first toss is “1.” Then |B| = 24 = 16 while |A ∩B| = (4
2) = 6. Since by
assumption all sequences of zeroes and ones are equally likely, Proposition 2.1.7 applies
and leads to
ℙ(A|B) = |A ∩B|
|B|
= 6
16 = 3
8 .
Suppose now that the coin is no longer fair. Say “1” occurs with probability p and “0”
with probability 1 −p. Then we can no longer evaluate the conditional probability by
reducing the sample space. In this case one has to apply directly the definition of the
conditional probabilities and obtains
ℙ(B) = p ,
ℙ(A ∩B) = (4
2)p3(1 −p)2
⇒
ℙ(A|B) = ℙ(A ∩B)
ℙ(B)
= 6 p2(1 −p)2 .
Example 2.1.11. The duration of a telephone call is exponentially distributed with pa-
rameter λ > 0. Find the probability that a call does not last more than 5 minutes provided
it already lasted 2 minutes.
Solution: Let A be the event that the call does not last more than 5 minutes, that is,
A = [0, 5]. We know it already lasted 2 minutes, hence event B = [2, ∞) has occurred.
Thus, under condition B, it follows that
Eλ(A|B) = Eλ(A ∩B)
Eλ(B)
= Eλ([2, 5])
Eλ([2, ∞)) = e−2λ −e−5λ
e−2λ
= 1 −e−3λ.
Note the interesting fact that this conditional probability equals Eλ([0, 3]). What does
this tell us? It says that the probability that a call lasts no more than another 3 minutes
is independent of the fact that it has already lasted 2 minutes. This means that the dura-
tion of a call has not “become older.” Independent of the fact that it has already lasted
2 minutes, the probability for talking no more than another 3 minutes remains the same.
Let us come back to the general case. Fix an event B ∈𝒜with ℙ(B) > 0. Then
A 󳨃→ℙ(A|B) ,
A ∈𝒜,
is a well-defined mapping from 𝒜to [0, 1]. Its main properties are summarized in the
next proposition.
Proposition 2.1.12. Let (Ω, 𝒜, ℙ) be an arbitrary probability space. For each B ∈𝒜with
ℙ(B) > 0, the mapping A 󳨃→ℙ(A|B) is a probability measure on 𝒜. It is concentrated on B,

2.1 Conditional probabilities
౪
115
that is,
ℙ(B|B) = 1
or, equivalently,
ℙ(Bc|B) = 0.
Proof. Of course, one has
ℙ(0|B) = ℙ(0 ∩B)/ℙ(B) = 0
and
ℙ(Ω|B) = ℙ(Ω ∩B)/ℙ(B) = ℙ(B)/ℙ(B) = 1 .
Thus, it remains to prove that ℙ(⋅|B) is σ-additive. To this end, choose disjoint A1, A2, . . .
in 𝒜. Then also A1 ∩B, A2 ∩B, . . . are disjoint and, using the σ-additivity of ℙleads to
ℙ(
∞
⋃
j=1
Aj|B) =
ℙ([⋃∞
j=1 Aj] ∩B)
ℙ(B)
=
ℙ(⋃∞
j=1(Aj ∩B))
ℙ(B)
=
∑∞
j=1 ℙ(Aj ∩B)
ℙ(B)
=
∞
∑
j=1
ℙ(Aj ∩B)
ℙ(B)
=
∞
∑
j=1
ℙ(Aj|B).
Consequently, as asserted, ℙ( ⋅|B) is a probability. Since the identity ℙ(B|B) = 1 is obvi-
ous, this ends the proof.
Definition 2.1.13. The mapping ℙ( ⋅|B) is called the conditional probability or also conditional distri-
bution (under condition B).
Remark 2.1.14. The main advantage of Proposition 2.1.12 is that it implies that condi-
tional probabilities share all the properties of “ordinary” probability measures. For ex-
ample, it holds that
ℙ(A2\A1|B) = ℙ(A2|B) −ℙ(A1|B)
provided that A1 ⊆A2,
or
ℙ(A1 ∪A2|B) = ℙ(A1|B) + ℙ(A2|B) −ℙ(A1 ∩A2|B).
But note, there do not exist similar rules for ℙ(A|B) independent of the event B and with
A fixed.
We come now to the so-called law of total probability. It allows us to evaluate the
probability of an event A knowing only its conditional probabilities ℙ(A|Bj) for certain
Bj ∈𝒜. More precisely, the following is valid.
Proposition 2.1.15 (Law of total probability). Let (Ω, 𝒜, ℙ) be a probability space and let
B1, . . . , Bn in 𝒜be disjoint with ℙ(Bj) > 0 and ⋃n
j=1 Bj = Ω. Then for each A ∈𝒜, one has
ℙ(A) =
n
∑
j=1
ℙ(Bj) ℙ(A|Bj).
(2.6)

116
౪
2 Conditional probabilities and independence
Proof. Let us start with the investigation of the right-hand side of eq. (2.6). By the defi-
nition of the conditional probability, this expression may be rewritten as
n
∑
j=1
ℙ(Bj) ℙ(A|Bj) =
n
∑
j=1
ℙ(Bj)
ℙ(A ∩Bj)
ℙ(Bj)
=
n
∑
j=1
ℙ(A ∩Bj).
(2.7)
The sets B1, . . . , Bn are disjoint, hence so are A ∩B1, . . . , A ∩Bn. Thus, the finite additivity
of ℙimplies
n
∑
j=1
ℙ(A ∩Bj) = ℙ(
n
⋃
j=1
(A ∩Bj)) = ℙ((
n
⋃
j=1
Bj) ∩A) = ℙ(Ω ∩A) = ℙ(A).
Together with eq. (2.7), this proves eq. (2.6).
A first example illustrates how the law of total probability applies.
Example 2.1.16. Suppose we have n urns, each containing a certain (maybe different)
number of white and black balls. Choose urn Uj with probability ℙ(Uj), 1 ≤j ≤n, and
take out one ball of the chosen urn. Let W occur if the chosen ball is white. Then the law
of total probability asserts that
ℙ(W) = ℙ(U1)ℙ(W|U1) + ⋅⋅⋅+ ℙ(Un)ℙ(W|Un) ,
where ℙ(W|Uj) is the proportion of white balls in urn Uj, 1 ≤j ≤n. In particular, if all
urns are equally likely, then one gets
ℙ(W) = 1
n
n
∑
j=1
ℙ(W|Uj) .
Example 2.1.17. A fair coin is tossed four times. Suppose we observe exactly k “heads”
for some k = 0, . . . , 4. According to the observed k, we take k dice and roll them. Find
the probability of the event A = {Number “6” does not show up}. Note that k = 0 means
that we do not roll a die, hence in this case “6” cannot appear.
Solution: As sample space, we choose Ω = {(k, Y), (k, N) : k = 0, . . . , 4}, where
(k, Y) means that we rolled k dice and at least on one of them we got a “6”. In the
same way, (k, N) stands for k dice and no “6”. Let N = {(0, N), . . . , (4, N)} and let Bk =
{(k, Y), (k, N)}, k = 0, . . . , 4. Then Bk occurs if we observed k “heads.” The conditional
probabilities equal
ℙ(N|B0) = 1 ,
ℙ(N|B1) = 5/6 ,
. . . ,
ℙ(N|B4) = (5/6)4 ,
while
ℙ(Bk) = (4
k) 1
24 ,
k = 0, . . . , 4.

2.1 Conditional probabilities
౪
117
The events B0, . . . , B4 satisfy the assumptions of Proposition 2.1.15, thus Eq. (2.6) applies
and leads to
ℙ(A) = 1
24
4
∑
k=0
(4
k) (5/6)k = 1
24 (5
6 + 1)
4
= (11
12)
4
= 0.706066743.
Example 2.1.18. Three different machines, M1, M2 and M3, produce light bulbs. In a sin-
gle day, M1 produces 500 bulbs, M2 yields 200, and M3 provides 100. The quality of the
produced bulbs depends on the machines: Among the light bulbs produced by M1, 5 %
are defective; among those from M2, 10 % are defective; and only 2 % are defective from
M3. At the end of a day, a controller chooses 1 of the 800 produced light bulbs at random
and tests it. Determine the probability that the checked bulb is defective.
Solution: The probabilities that the checked bulb was produced by M1, M2, or M3
are 5/8, 1/4, and 1/8, respectively. The conditional probabilities for choosing a defective
bulb produced by M1, M2 or M3 were given as 1/20, 1/10, and 1/50, respectively. If D is
the event that the tested bulb was defective, then the law of total probability yields
ℙ(D) = 5
8 ⋅1
20 + 1
4 ⋅1
10 + 1
8 ⋅1
50 = 47
800 = 0.05875.
Let us look at Example 2.1.18 from a different point of view. When choosing a light
bulb out of the 800 produced, there were certain fixed probabilities of whether it was
produced by M1, M2, or M3, namely 5/8, 1/4, and 1/8. These are the probabilities before
checking a bulb. Therefore, they are called a priori probabilities. After checking a bulb,
we obtained additional information that it was defective. Does this additional informa-
tion change the probabilities which of the machines M1, M2, and M3 produced it? More
precisely, if the D above occurs when the tested bulb is defective, then we now ask for
the conditional probabilities ℙ(M1|D), ℙ(M2|D), and ℙ(M3|D). To understand that these
probabilities may differ considerably from the a priori probabilities, imagine that, for
example, M1 produces almost no defective bulbs. Then it will be very unlikely that the
tested bulb has been produced by M1, although ℙ(M1) may be big.
Because ℙ(M1|D), ℙ(M2|D), and ℙ(M3|D) are the probabilities after executing the
random experiment (choosing and testing the bulb), they are called a posteriori proba-
bilities.
Let us now introduce the exact and general definition of a priori and a posteriori
probabilities.
Definition 2.1.19. Suppose there is a probability space (Ω, 𝒜, ℙ) and there are disjoint events
B1, . . . , Bn ∈𝒜satisfying Ω = ⋃n
j=1 Bj. Then we call ℙ(B1), . . . , ℙ(Bn) the a priori probabilities of B1, . . . , Bn.
Let A ∈𝒜with ℙ(A) > 0 be given. Then the conditional probabilities ℙ(B1|A), . . . , ℙ(Bn|A) are said to be
the a posteriori probabilities, that is, those after the occurrence of A.
To calculate the a posteriori probabilities, the next proposition turns out to be very use-
ful.

118
౪
2 Conditional probabilities and independence
Proposition 2.1.20 (Bayes’ formula). Suppose we are given disjoint events B1 to Bn satis-
fying ⋃n
j=1 Bj = Ω and ℙ(Bj) > 0. Let A be an event with ℙ(A) > 0. Then for each j ≤n the
following equation holds:
ℙ(Bj|A) =
ℙ(Bj) ℙ(A|Bj)
∑n
i=1 ℙ(Bi)ℙ(A|Bi).
(2.8)
Proof. Proposition 2.1.15 implies
n
∑
i=1
ℙ(Bi)ℙ(A|Bi) = ℙ(A).
Hence, the right-hand side of eq. (2.8) may also be written as
ℙ(Bj)ℙ(A|Bj)
ℙ(A)
=
ℙ(Bj)
ℙ(A∩Bj)
ℙ(Bj)
ℙ(A)
=
ℙ(A ∩Bj)
ℙ(A)
= ℙ(Bj|A),
and the proposition is proven.
Remark 2.1.21. In the case ℙ(A) is already known, Bayes’ formula simplifies to
ℙ(Bj|A) =
ℙ(Bj)ℙ(A|Bj)
ℙ(A)
,
j = 1, . . . , n.
(2.9)
Remark 2.1.22. Let us treat the special case of two sets partitioning Ω. If B1 = B, then
necessarily B2 = Bc, hence Ω = B ∪Bc. Then formula (2.8) looks as follows:
ℙ(B|A) =
ℙ(B)ℙ(A|B)
ℙ(B)ℙ(A|B) + ℙ(Bc)ℙ(A|Bc)
(2.10)
and
ℙ(Bc|A) =
ℙ(Bc)ℙ(A|Bc)
ℙ(B)ℙ(A|B) + ℙ(Bc)ℙ(A|Bc).
(2.11)
Again, if the probability of A is known, the denominators in Eqs. (2.10) and (2.11) may be
replaced by ℙ(A).
Example 2.1.23. Let us use Bayes’ formula to calculate the a posteriori probabilities in
Example 2.1.18. Recall that D occurs if the tested bulb is defective. We already know
ℙ(D) = 47/800, hence we may apply eq. (2.9). Doing so, we get
ℙ(M1|D) = ℙ(M1)ℙ(D|M1)
ℙ(D)
= 5/8 ⋅1/20
47/800
= 25/47,
ℙ(M2|D) = ℙ(M2)ℙ(D|M2)
ℙ(D)
= 1/4 ⋅1/10
47/800
= 20/47,
ℙ(M3|D) = ℙ(M3)ℙ(D|M3)
ℙ(D)
= 1/8 ⋅1/50
47/800
= 2/47.

2.1 Conditional probabilities
౪
119
By assignment of the problem, the a priori probabilities were given by ℙ(M1) = 5/8,
ℙ(M2) = 1/4, and ℙ(M3) = 1/8. In the case that the tested light bulb was defective,
these probabilities changed to 25/47, 20/47, and 2/47. This tells us that it becomes less
likely that the tested bulb was produced by M1 or M3; their probabilities diminish by
0.0930851 and 0.0824468, respectively. On the other hand, the probability of M2 increases
by 0.175532.
Finally, note that Proposition 2.1.12 implies that the sum of the a posteriori proba-
bilities has to be 1. Because of 25/47 + 20/47 + 2/47 = 1, this is true in that example.
Example 2.1.24. In order to figure out whether or not a person suffers from a certain
disease, say disease X, a test is assumed to give a clue. If the tested person is sick, then
the test is positive in 96 % of cases. If the person is well, then with 94 % accuracy the test
will be negative. Furthermore, it is known that 0.4 % of the population suffers from the
disease X.
Now a person, chosen at random, is tested. Suppose the result was positive. Find the
probability that this person really suffers from X.
Solution: As sample space, we may choose
Ω = {(X, p), (X, n), (Xc, p), (Xc, n)},
where, for example, (X, n) means that the person suffers from X and the test was nega-
tive. Set A := {(X, p), (Xc, p)}. Then A occurs if and only if the test turned out to be positive.
Furthermore, event B := {(X, p), (X, n)} occurs in the case that the tested person suffers
from X. Known are
ℙ(A|B) = 0.96, ℙ(A|Bc) = 0.06,
and
ℙ(B) = 0.004 ,
hence ℙ(Bc) = 0.996.
Therefore, by eq. (2.10), the probability we asked for can be calculated as follows:
ℙ(B|A) =
ℙ(B)ℙ(A|B)
ℙ(B)ℙ(A|B) + ℙ(Bc)ℙ(A|Bc)
=
0.004 ⋅0.96
0.004 ⋅0.96 + 0.996 ⋅0.06 = 0.00384
0.0636 = 0.0603774.
This tells us that it is quite unlikely that a randomly chosen person with a positive test
is really sick. The chance for this being true is only about 6 %.
Summary: Given two events A and B in a probability space (Ω, 𝒜, ℙ) with ℙ(B) > 0, the probability of A
under the condition of the occurrence of B is given by
ℙ(A|B) = ℙ(A ∩B)
ℙ(B)
or, equivalently, by
ℙ(A ∩B) = ℙ(B) ℙ(A|B) .
The basic properties of the conditional probability are summarized in the “Law of total probability” and in
“Bayes’ formula” (Propositions 2.1.15 and 2.1.20).

120
౪
2 Conditional probabilities and independence
2.2 Independence of events
What does it mean that two events are independent or, more precisely, that they occur
independently of each other? To get an idea, let us look at the following example.
Example 2.2.1. Roll a fair die twice. Event B occurs if the first number is even while
event A consists of all pairs (x1, x2), where x2 = 5 or x2 = 6. It is intuitively clear that these
two events occur independently of each other. But how to express this mathematically?
To answer this question, think about the probability of A under the condition B. The
fact whether or not B has occurred has no influence on the occurrence of A. For the
occurrence or nonoccurrence of A, it is completely insignificant what happened in the
first roll. Mathematically, this means that ℙ(A|B) = ℙ(A). Let us check whether this is
true in this concrete case. Indeed, it holds that ℙ(A) = 1/3, as well as
ℙ(A|B) = ℙ(A ∩B)
ℙ(B)
= 6/36
1/2 = 1/3.
The previous example suggests that the independence of A of B could be described
by
ℙ(A) = ℙ(A|B) = ℙ(A ∩B)
ℙ(B)
.
(2.12)
But formula (2.12) has a disadvantage, namely we have to assume ℙ(B) > 0 to ensure
that ℙ(A|B) exists. To overcome this problem, rewrite eq. (2.12) as
ℙ(A ∩B) = ℙ(A) ℙ(B).
(2.13)
In this form, we may take eq. (2.13) as the basis for the definition of independence.
Definition 2.2.2. Let (Ω, 𝒜, ℙ) be a probability space. Two events A and B in 𝒜are said to be (stochasti-
cally) independent provided
ℙ(A ∩B) = ℙ(A) ⋅ℙ(B).
(2.14)
In the case that eq. (2.14) does not hold, the events A and B are called (stochastically) dependent.
Remark 2.2.3. In the sequel, we use the notations “independent” and “dependent” with-
out adding the word “stochastically.” Since we will not use other versions of indepen-
dence, there should be no confusion.
Example 2.2.4. A fair die is rolled twice. Event A occurs if the first roll is either “1” or
“2” while B occurs if the sum of both rolls equals 7. Are A and B independent?
Answer: We have ℙ(A) = 1/3, ℙ(B) = 1/6, and ℙ(A ∩B) = 2/36 = 1/18. Hence, we get
ℙ(A ∩B) = ℙ(A) ⋅ℙ(B) and so A and B are independent.
Question: Are A and B also independent if A is as before and B is defined as a set of
pairs with sum 4?

2.2 Independence of events
౪
121
Example 2.2.5. In an urn, there are n ≥2 white balls and also n black balls. One chooses
two balls without replacing the first. Let A be the event that the second ball is black while
B occurs if the first ball was white. Are A and B independent?
Answer: The probability of B equals 1/2. To calculate ℙ(A), we use Proposition 2.1.15.
Then we get
ℙ(A) = ℙ(B)ℙ(A|B) + ℙ(Bc)ℙ(A|Bc) = 1
2 ⋅
n
2n −1 + 1
2 ⋅n −1
2n −1 = 1
2 ,
hence ℙ(A) ⋅ℙ(B) = 1/4.
On the other hand, we have
ℙ(A ∩B) = ℙ(B)ℙ(A|B) = 1
2 ⋅
n
2n −1 =
n
4n −2
̸= 1
4.
Consequently, A and B are dependent.
Remark 2.2.6. Note that if n →∞, then
ℙ(A ∩B) =
n
4n −2 →1
4 = ℙ(A) ℙ(B).
This tells us the following: if n is big, then A and B are “almost” independent or, equiv-
alently, the degree of dependence between A and B is very small. This question will be
investigated more thoroughly in Chapter 5 when a measure for the degree of depen-
dence is available.
Next, we prove some properties of independent events.
Proposition 2.2.7. Let (Ω, 𝒜, ℙ) be a probability space.
1.
For any A ∈𝒜, the events A and 0, as well as A and Ω, are independent.1
2.
If A and B are independent, then so are A and Bc, as well as Ac and Bc.
Proof. We have
ℙ(A ∩0) = ℙ(0) = 0 = ℙ(A) ⋅0 = ℙ(A) ⋅ℙ(0) ,
hence A and 0 are independent.
In the same way, the independence of A and Ω follows from
ℙ(A ∩Ω) = ℙ(A) = ℙ(A) ⋅1 = ℙ(A) ⋅ℙ(Ω).
To prove the second part, assume that A and B are independent. Our aim is to show that
A and Bc are independent as well. We know that
1 For a more general result, see Problem 2.15.

122
౪
2 Conditional probabilities and independence
ℙ(A ∩B) = ℙ(A) ℙ(B)
and want to show that
ℙ(A ∩Bc) = ℙ(A) ℙ(Bc).
Let us start with the right-hand side of the latter equation. Using the independence of A
and B and the fact A ∩B ⊆B, it follows that
ℙ(A) ℙ(Bc) = ℙ(A)(1 −ℙ(B)) = ℙ(A) −ℙ(A) ⋅ℙ(B)
= ℙ(A) −ℙ(A ∩B) = ℙ(A\(A ∩B)).
(2.15)
Since A\(A ∩B) = A\B = A ∩Bc, using eq. (2.15), we derive
ℙ(A) ⋅ℙ(Bc) = ℙ(A ∩Bc).
Consequently, as asserted, A and Bc are independent.
If A and B are independent, then so are B and A, and as seen above, so are B and Ac.
Another application of the first step, this time with Ac and B, shows that also Ac and Bc
are independent. This completes the proof.
Suppose we are given n events A1, . . . , An in 𝒜. We want to figure out when they are
independent. A first possible approach could be as follows.
Definition 2.2.8. Events A1, . . . , An are said to be pairwise independent if, whenever i
̸= j,
ℙ(Ai ∩Aj) = ℙ(Ai) ⋅ℙ(Aj).
In other words, for all 1 ≤i < j ≤1 the events Ai and Aj are independent.
Unfortunately, for many purposes, the property of pairwise independence is too weak.
For example, as we will see next, in general it does not imply the important equation
ℙ(A1 ∩⋅⋅⋅∩An) = ℙ(A1) ⋅⋅⋅ℙ(An).
(2.16)
Example 2.2.9. Roll a die twice and define events A1, A2, and A3 as follows:
A1 := {2, 4, 6} × {1, . . . , 6},
A2 := {1, . . . , 6} × {1, 3, 5},
A3 := {2, 4, 6} × {1, 3, 5} ∪{1, 3, 5} × {2, 4, 6}.
Verbally this says that A1 occurs if the first roll is even, A2 occurs if the second one is
odd, and A3 occurs if either the first number is odd while the second is even or vice
versa.

2.2 Independence of events
౪
123
Direct calculations give ℙ(A1) = ℙ(A2) = ℙ(A3) = 1/2, as well as
ℙ(A1 ∩A2) = ℙ(A1 ∩A3) = ℙ(A2 ∩A3) = 1
4.
Hence, A1, A2, and A3 are pairwise independent.
Since
A1 ∩A2 ∩A3 = A1 ∩A2,
it follows that
ℙ(A1 ∩A2 ∩A3) = ℙ(A1 ∩A2) = 1
4
̸= 1
8 = ℙ(A1) ⋅ℙ(A2) ⋅ℙ(A3).
So, we found three pairwise independent events for which eq. (2.16) is not valid.
After mentioning that pairwise independence of A1, . . . , An does not imply
ℙ(A1 ∩⋅⋅⋅∩An) = ℙ(A1) ⋅⋅⋅ℙ(An),
(2.17)
it makes sense to ask whether or not pairwise independence can be derived from
eq. (2.17). The next example shows that, in general, this is also not true.
Example 2.2.10. Let Ω = {1, . . . , 12} be endowed with the uniform distribution ℙ, that is,
for any A ⊆Ω we have ℙ(A) = |A|/12. Define events A1, A2, and A3 as A1 := {1, . . . , 9},
A2 := {6, 7, 8, 9}, and A3 := {9, 10, 11, 12}. Direct calculations give
ℙ(A1) = 9
12 = 3
4 ,
ℙ(A2) = 4
12 = 1
3,
and
ℙ(A3) = 4
12 = 1
3 .
Moreover, we have
ℙ(A1 ∩A2 ∩A3) = ℙ({9}) = 1
12 = 3
4 ⋅1
3 ⋅1
3 = ℙ(A1) ⋅ℙ(A2) ⋅ℙ(A3) ,
hence eq. (2.17) is valid. But, because of
ℙ(A1 ∩A2) = ℙ(A2) = 1
3
̸= 1
4 = ℙ(A1) ⋅ℙ(A2) ,
the events A1, A2, and A3 are not pairwise independent.
Remark 2.2.11. Summing up, Examples 2.2.9 and 2.2.10 show that neither pairwise inde-
pendence nor eq. (2.17) are suitable to define the independence of more than two events.
Why? On the one hand, independence should yield eq. (2.17) and, on the other hand,
whenever A1, . . . , An are independent, then so should be any subcollection of them. In
particular, independence should imply pairwise independence.
A reasonable definition of independence of n events is as follows.

124
౪
2 Conditional probabilities and independence
Definition 2.2.12. The events A1, . . . , An are said to be independent provided that for each subset
I ⊆{1, . . . , n} we have
ℙ(⋂
i∈I
Ai) = ∏
i∈I
ℙ(Ai).
(2.18)
Remark 2.2.13. Of course, it suffices that eq. (2.18) is valid for sets I ⊆{1, . . . , n} satisfying
|I| ≥2. Indeed, if |I| = 1, then eq. (2.18) holds trivially.
Remark 2.2.14. Another way to introduce independence is as follows: For all m ≥2 and
1 ≤i1 < ⋅⋅⋅< im ≤n, it follows that
ℙ(Ai1 ∩⋅⋅⋅∩Aim) = ℙ(Ai1) ⋅⋅⋅ℙ(Aim).
Identify I with {i1, . . . , im} to see that both definitions are equivalent.
At a first glance, the previous Definition 2.2.12 looks complicated; in fact, it is not.
To see this, let us once more investigate the case n = 3. Here exist exactly four different
subsets I ⊆{1, 2, 3} with |I| ≥2. These are I = {1, 2}, I = {1, 3}, I = {2, 3}, and I = {1, 2, 3}.
Consequently, three events A1, A2, and A3 are independent if and only if the four follow-
ing conditions hold at once:
ℙ(A1 ∩A2) = ℙ(A1) ⋅ℙ(A2),
ℙ(A1 ∩A3) = ℙ(A1) ⋅ℙ(A3),
ℙ(A2 ∩A3) = ℙ(A2) ⋅ℙ(A3),
as well as
ℙ(A1 ∩A2 ∩A3) = ℙ(A1) ⋅ℙ(A2) ⋅ℙ(A3).
Examples 2.2.9 and 2.2.10 show that all four equations are really necessary. None of them
is a consequence of the other three.
The independence of n events provides the following properties:
Proposition 2.2.15.
1.
Let A1, . . . , An be independent. For any J ⊆{1, . . . , n}, the events {Aj : j ∈J} are inde-
pendent as well. In particular, independence implies pairwise independence.
2.
For each permutation π of {1, . . . , n}, the independence of A1, . . . , An implies that of2
Aπ(1), . . . , Aπ(n).
3.
Suppose for each 1 ≤j ≤n either Bj = Aj or Bj = Ac
j holds. Then the independence of
A1, . . . , An implies that of B1, . . . , Bn.
Proof. The first two properties are an immediate consequence of the definition of inde-
pendence.
2 For example, in the case n = 3 with A1, A2, A3 also A3, A2, A1 and A2, A3, A1 are independent.

2.2 Independence of events
౪
125
To prove the third assertion, reorder A1, . . . , An such that3 B1 = Ac
1. In the first step,
we show that Ac
1, A2, . . . , An are independent as well, that is, we have B1 = Ac
1, B2 = A2,
and so on. Given I ⊆{1, . . . , n}, it has to hold that
ℙ(⋂
i∈I
Bi) = ∏
i∈I
ℙ(Bi).
In the case 1 ∉I, this follows by the independence of A1, . . . , An. If 1 ∈I, we apply Propo-
sition 2.2.7 with4 A1 and C = ⋂i∈I\{1} Ai = ⋂i∈I\{1} Bi. Then Ac
1 = B1 and C are independent
as well. Hence, by the independence of A2, . . . , An, we get
ℙ(⋂
i∈I
Bi) = ℙ(B1 ∩C) = ℙ(B1) ⋅ℙ(C) = ℙ(B1) ⋅∏
i∈I\{1}
ℙ(Bi) = ∏
i∈I
ℙ(Bi).
The general case then follows by reordering the Ajs and by an iterative application of
the first step. This is exactly the procedure we did in the proof of Proposition 2.2.7 when
verifying the independence of Ac and Bc for independent A and B.
The next two examples show how independence of more than two events appears
in a natural way.
Example 2.2.16. Toss a fair coin n times. Let us assume that the coin is labeled with “0”
and “1.” Choose a fixed sequence (aj)n
j=1 of numbers in {0, 1} and suppose that the event
Aj occurs if in the jth trial aj comes up.
We claim now that A1, . . . , An are independent. To verify this, choose a subset
I ⊆{1, . . . , n} with |I| = k for some k = 2, . . . , n. The cardinality of ⋂i∈I Ai equals 2n−k.
Why? At k positions, the values of the tosses are fixed; at n −k positions, they still may
be either “0” or “1”. Consequently,
ℙ(⋂
i∈I
Ai) = 2n−k
2n
= 2−k.
(2.19)
The same argument as before gives |Aj| = 2n−1, hence ℙ(Aj) = 1/2, 1 ≤j ≤n. Conse-
quently, it follows that
∏
i∈I
ℙ(Ai) = (1
2)
|I|
= 2−k.
(2.20)
Combining Eqs. (2.19) and (2.20) gives
3 If all Bj = Aj, there is nothing to prove.
4 Why are A1 and C independent? Give a short proof.

126
౪
2 Conditional probabilities and independence
ℙ(⋂
i∈I
Ai) = ∏
i∈I
ℙ(Ai),
and since I was arbitrary, the sets A1, . . . , An are independent.
Remark 2.2.17. Even the simple Example 2.2.16 shows that it might be rather compli-
cated to verify the independence of n given events. For example, if we modify the pre-
vious example by taking a biased coin, then the Ajs remain independent, but the proof
becomes more complicated.
Example 2.2.18. A machine consists of n components. These components break down
with certain probabilities p1, . . . , pn. Moreover, we assume that they break down inde-
pendently of each other. Find the probability that a chosen machine stops working. Be-
fore answering this question, we have to determine the conditions.
Case 1: The machine stops working provided at least one component breaks down.
Let M be the event that the machine stops working. If j ≤n, assume Aj occurs if
component j breaks down. By assumption, ℙ(Aj) = pj. Since
M =
n
⋃
j=1
Aj,
by the independence5 it follows that
ℙ(M) = 1 −ℙ(Mc) = 1 −ℙ(
n
⋂
j=1
Ac
j ) = 1 −
n
∏
j=1
ℙ(Ac
j ) = 1 −
n
∏
j=1
(1 −pj).
(2.21)
Case 2: The machine stops working provided all n components break down.
Using the same notation as in case 1, we now have
M =
n
⋂
j=1
Aj.
Hence, by the independence we obtain
ℙ(M) = ℙ(
n
⋂
j=1
Aj) =
n
∏
j=1
pj.
(2.22)
Remark 2.2.19. Formula (2.21) tells us the following: If among the n components there
is one of bad quality, say component j0, then pj0 is close to one; hence, 1 −pj0 is close to
zero, and so is ∏n
j=1(1−pj). Because of eq. (2.21), ℙ(M) is large, and so the machine breaks
down with a large probability.
5 In fact, we also have to use Proposition 2.2.15.

2.3 Problems
౪
127
In the second case, the conclusion is as follows: if among the n components there
is one of high quality, say component j0, then pj0 is small and so is ∏n
j=1 pj. By eq. (2.22),
ℙ(M) is also small, hence it is very unlikely that the machine stops working.
Summary: Two events A and B in a probability space (Ω, 𝒜, ℙ) are said to be (stochastically) independent if
ℙ(A ∩B) = ℙ(A) ⋅ℙ(B) .
In general, events A1, . . . , An are (stochastically) independent provided that for all 2 ≤m ≤n and all choices
of indices 1 ≤i1 < ⋅⋅⋅< im ≤n one has
ℙ(Ai1 ∩⋅⋅⋅∩Aim) = ℙ(Ai1) ⋅⋅⋅ℙ(Aim) .
In particular, then the Ajs are pairwise independent and ℙ(A1 ∩⋅⋅⋅∩An) = ℙ(A1) ⋅⋅⋅ℙ(An).
2.3 Problems
Problem 2.1 (Willem Jacob’s Gravesande, 1736). On a ship there are 84 passengers from
Belgium, 12 from England, and 4 from Germany.
1.
One passengers leaves the ship. How likely is it that he or she is
(i) Belgian,
(ii) German,
(iii) Belgian or German?
2.
Two people leave the ship. How likely is it that at least one of them is Belgian?
Problem 2.2. The chance to win a certain game is 50 %. One plays six games. Find the
probability to win exactly four games. Evaluate the probability of this event under the
condition to win at least two games. Suppose one had won exactly one of the two first
games. Which probability does the event “winning 4 games” have under this condition?
Problem 2.3. Toss a fair coin six times. Define events A and B as follows:
A = {“Heads” appears exactly 3 times},
B = {The first and the second toss are “heads”}.
Evaluate ℙ(A), ℙ(A|B), and ℙ(A|Bc).
Problem 2.4. Let A and B be as in Problem 1.30, that is, A occurs if each box contains at
most one particle while B occurs if all four particles are in the same box.
Find now ℙ(A|C) and ℙ(B|C) with C = {The first box remains empty}.
Problem 2.5. Justify why Propositions 2.1.15 and 2.1.20 (Law of total probability and
Bayes’ formula) remain valid for infinitely many disjoint sets B1, B2, . . . satisfying
ℙ(Bj) > 0 and ⋃∞
j=1 Bj = Ω.
Prove that Proposition 2.1.15 also holds without assuming ⋃n
j=1 Bj = Ω. But then we
have to suppose A ⊆⋃n
j=1 Bj.

128
౪
2 Conditional probabilities and independence
Problem 2.6. To go to work, a man can either use a train, a bus, or his car. He chooses
the train 50 %, the bus 30 %, and the car 20 % of workdays. If he takes the train, he arrives
on time with probability 0.95. By bus, he is on time with probability 0.8, and by car with
probability 0.7.
(a) Evaluate the probability that the man is at work on time.
(b) How big is this probability given the man does not use the car?
(c) Assume the man arrived at work on time. What are then the probabilities that he
came by train, bus, or car?
Problem 2.7. Let U1, U2, and U3 be three urns containing five balls each. Urn U1 contains
four white balls and one black ball, U2 has three white balls and two black balls and,
finally, U3 contains two white balls and three black balls. Choose one urn at random
(each urn is equally likely) and, without replacing the first ball, take two balls out of the
chosen urn.
(a) Give a suitable sample space for this random experiment.
(b) Find the probability to observe two balls of different color.
(c) Assume the chosen balls were of different color. What are the probabilities that the
balls were taken out of U1, U2, or U3?
Problem 2.8. Suppose we have three indistinguishable dice. Two of them are fair, the
remaining one is biased. For the latter, the number “6” appears with probability 1/5 while
all other numbers have probability 4/25. We choose at random one of the dice and roll
it.
(a) Find a suitable sample space for the description of this experiment.
(b) Give the probability of occurrence of {1} to {6} in that experiment.
(c) Suppose we have observed the number “2” on the chosen die. Find the probability
that this die was the biased one.
Problem 2.9 (P. S. Laplace, 1774). Two urns U1 and U2 contain w1 white and b1 black balls
and w2 white and b2 black balls, respectively. Choose one of the two urns at random and
take out n balls without replacement. Among the n chosen balls, w are white and b are
black. Find a formula for the probability that we took off the balls from U1?
Find the numerical value for the likelihood of U1 in the case that there are 8 white
and 7 black balls in U1, 5 white and 15 black balls in U2, and that we chose 6 balls, with 4
of them white, hence 2 black.
Problem 2.10 (P. S. Laplace, 1786). In an urn there are three balls which are known to be
either white or black. Choosing n balls with replacement, we observe that all of them
were white. How likely is it that 0, 1, or 2 of the three balls are black? How likely is it that
the next chosen ball, the (n + 1)th, is white as well?
Problem 2.11. Let A and B be two events in a probability space with ℙ(A) > 0 and
ℙ(B) > 0. Under which conditions, do we have

2.3 Problems
౪
129
ℙ(A|B) = ℙ(B|A) ?
Problem 2.12. Let A and B certain events in a probability space with ℙ(B) > 0. Do we
have
ℙ(A ∪B|B) = ℙ(A)
and/or
ℙ(A ∩B|B) = ℙ(A ∩B) ?
Give a proof or a counterexample.
Problem 2.13.
(a) Let (Ω, 𝒜, ℙ) be a probability space. Suppose we are given events A1, . . . , An with
ℙ(A1 ∩⋅⋅⋅∩An−1) > 0. Prove the following chain rule for conditional probabilities:
ℙ(A1 ∩⋅⋅⋅∩An) = ℙ(A1)ℙ(A2|A1) ⋅⋅⋅ℙ(An|A1 ∩A2 ∩⋅⋅⋅∩An−1).
Argue why all occurring conditional probabilities are well defined.
(b) Choose at random three numbers from 1 to 10 without replacement. Find the proba-
bility that the first number is even, the second one is odd, and the third one is again
even.
(c) Compare this probability with that of the following event: among three randomly
chosen numbers in {1, . . . , 10}, there are exactly two even and one odd.
Problem 2.14. Three persons, say X, Y, and Z, stand randomly in a row. All orderings
are assumed to be equally likely. Event A occurs if Y stands on the right-hand side of
X while B occurs in the case that Z is on the right-hand side of X. Hereby, we do not
suppose that Y and X or that Z and X stand directly next to each other. Are events A and
B independent or dependent?
Problem 2.15. Prove the following generalization of part 1 in Proposition 2.2.7. Let A ∈𝒜
be an event with either ℙ(A) = 0 or ℙ(A) = 1. Then for any B ∈𝒜, the events A and B
are independent.
Problem 2.16. Let (Ω, 𝒜, ℙ) be a probability space. Given independent events A1, . . . , An
in 𝒜, prove that
ℙ(
n
⋃
j=1
Aj) = 1 −
n
∏
j=1
(1 −ℙ(Aj)).
(2.23)
Use 1 −x ≤e−x, x ≥0, to derive from eq. (2.23) the following:
If independent events6 A1, A2, . . . satisfy ∑∞
j=1 ℙ(Aj) = ∞, then ℙ(⋃∞
j=1 Aj) = 1.
Problem 2.17. An electric circuit (see Fig. 2.1) contains four switches A, B, C, and D. Each
of the switches is independently open or closed (then electricity flows). The switches are
6 Compare with Definition 7.1.17: for each n ∈ℕ, the events A1, . . . , An are independent.

130
౪
2 Conditional probabilities and independence
open with probability 1 −p and closed with probability p. Here, 0 ≤p ≤1 is given. Find
the probability that electricity flows from the left to the right.
Figure 2.1: An electric circuit with four switches.
Problem 2.18. Let (Ω, 𝒜, ℙ) be a probability space. Suppose A and B are disjoint events
with ℙ(A) > 0 and P(B) > 0. Is it possible that A and B are independent?
Problem 2.19. Let A, B, and C be three independent events.
1.
Show that A ∩B and C are independent as well.
2.
Even more, show that the independence of A, B, and C implies that of the events
A ∪B and C.
Problem 2.20.
1.
Suppose that A and C, as well as B and C, are independent. Furthermore, assume
A ∩B = 0. Show that A ∪B and C are independent as well.
2.
Give an example showing that the preceding assertion becomes false without the
assumption A ∩B = 0.
Hint: To construct such an example, because of Problem 2.19, the events A, B, and C
cannot be chosen to be independent. Therefore, the sets defined in Example 2.2.9 are
natural candidates for such an example.
Problem 2.21. Suppose ℙ(A|B) = ℙ(A|Bc) for some events A and B with 0 < ℙ(B) < 1.
Does this imply that A and B are independent?
Problem 2.22. Is it possible that an event A is independent of itself? If yes, which events
A have this property? Similarly, which A are independent of Ac?
Problem 2.23. Let A, B, and C be three independent events with
ℙ(A) = ℙ(B) = ℙ(C) = 1
3.
Evaluate
ℙ((A ∩B) ∪(A ∩C)).

3 Random variables and their distribution
3.1 Transformation of random values
Assume the probability space (Ω, 𝒜, ℙ) describes a certain random experiment, for ex-
ample, rolling a die or tossing a coin. If the experiment is executed, a random result
ω ∈Ω shows up. In a second step, we transform this observed result via a mapping
X : Ω →ℝ. In this way we obtain a (random) real number X(ω). Let us point out that X
is a fixed, nonrandom function from Ω into ℝ; the randomness of X(ω) stems from the
input ω ∈Ω.
Example 3.1.1. Toss a fair coin, labeled on one side with “0” and on the other side with
“1,” exactly n times. The appropriate probability space is (Ω, 𝒫(Ω), ℙ), where Ω = {0, 1}n
and ℙis the uniform distribution on Ω. The result of the experiment is a vector ω =
(ω1, . . . , ωn) with ωj = 0 or ωj = 1. Let X from Ω to ℝbe defined by
X(ω) = X(ω1, . . . , ωn) = ω1 + ⋅⋅⋅+ ωn .
Then X(ω) tells us how often “1” occurred, but we do no longer know in which order this
happened. Of course, X(ω) is random because, if one tosses the coin another n times, it
is very likely that X attains a value different from that in the first trial.
Here we state the most important question in this topic: how are the values of X
distributed? As we know, in this case X attains a value k ≤n with probability (n
k)2−n.
Example 3.1.2. Roll a fair die twice. The sample space describing this experiment con-
sists of pairs ω = (ω1, ω2), where ω1, ω2 ∈{1, . . . , 6}. Now define the mapping X : Ω →ℝ
by X(ω) := max{ω1, ω2}. Thus, instead of recording the values of both rolls, we are only
interested in the larger one.
Other possible transformations are, for example, X1(ω) := min{ω1, ω2} or also
X2(ω1, ω2) := ω1 + ω2.
Let A ∈𝒜be an event. Recall that this event A occurs if and only if we observe an
ω ∈A. Suppose now X : Ω →ℝis a given mapping from Ω into ℝand let B ⊆ℝbe some
event. When do we observe an ω ∈Ω for which we have X(ω) ∈B or, equivalently, when
does the event
{X ∈B} := {ω ∈Ω : X(ω) ∈B}
occur? To answer this question, let us recall the definition of the preimage of B with
respect to X as given in eq. (A.2):
X−1(B) := {ω ∈Ω : X(ω) ∈B} .
We observe an ω ∈Ω for which X(ω) ∈B if and only if ω ∈X−1(B). In other words, the
event {X ∈B} occurs if and only if X−1(B) does. Consequently, the probability to observe
https://doi.org/10.1515/9783111325064-003

132
౪
3 Random variables and their distribution
an ω ∈Ω with X(ω) ∈B should be ℙ(X−1(B)). But to this end, we have to know that
X−1(B) ∈𝒜; otherwise ℙ(X−1(B)) is not defined at all. Thus, a natural condition for X is
X−1(B) ∈𝒜for “sufficiently many” subsets B ⊆ℝ. The precise mathematical condition
reads as follows.
Definition 3.1.3. Let (Ω, 𝒜, ℙ) be a probability space. A mapping X : Ω →ℝis called a (real-valued) ran-
dom variable (sometimes also random real number), provided that it satisfies the following condition:
B ∈ℬ(ℝ)
always implies
X−1(B) ∈𝒜.
(3.1)
Verbally, this condition says that for each Borel set B ⊆ℝ, its preimage X−1(B) has to be an element of
the σ-field 𝒜.
Remark 3.1.4. Condition (3.1) is purely technical and will not be important later on. But,
in general, it cannot be avoided, at least if 𝒜
̸= 𝒫(Ω). On the contrary, if 𝒜= 𝒫(Ω), for
example, if either Ω is finite or countably infinite, then every mapping X : Ω →ℝis
a random variable. Indeed, in this case the condition X−1(B) ∈𝒜is trivially always
satisfied.
Remark 3.1.5. In order to verify that a given mapping X : Ω →ℝis a random variable,
it is not necessary to show X−1(B) ∈𝒜for all Borel sets B ⊆ℝ. It suffices to prove this
only for some special Borel sets B. More precisely, the following proposition holds.
Proposition 3.1.6. A function X : Ω →ℝis a random variable if and only if, for all t ∈ℝ,
we have
X−1((−∞, t]) = {ω ∈Ω : X(ω) ≤t} ∈𝒜.
(3.2)
The assertion remains valid when we replace the intervals (−∞, t] with intervals of the
form (−∞, t), or we may take intervals [t, ∞) and also (t, ∞).
Proof. Suppose first that X is a random variable. Given t ∈ℝ, the interval (−∞, t] is a
Borel set, hence X−1((−∞, t]) ∈𝒜. Thus, each random variable satisfies condition (3.2).
To prove the converse implication, let X be a mapping from Ω to ℝsatisfying condi-
tion (3.2) for each t ∈ℝ. Set
𝒞:= {C ∈ℬ(ℝ) : X−1(C) ∈𝒜}.
In the first step, one proves1 that 𝒞is a σ-field. Moreover, (3.2) implies (−∞, t] ∈𝒞for
each t ∈ℝ. But ℬ(ℝ) is the smallest σ-field containing all these intervals. Since 𝒞is
another σ-field containing the intervals (−∞, t], it has to be larger2 than the smallest one,
that is, we have 𝒞⊇ℬ(ℝ). In other words, every Borel set belongs to 𝒞or, equivalently,
1 Use Proposition A.2.1 to verify this.
2 By the construction of 𝒞, it even coincides with ℬ(ℝ).

3.2 Probability distribution of a random variable
౪
133
for all B ∈ℬ(ℝ) it follows that X−1(B) ∈𝒜. Thus, as asserted, X is a random variable.
The proof for intervals of the other types goes along the same lines. Here one has to use
that these intervals generate the σ-field of Borel sets as well.
Summary: Let (Ω, 𝒜, ℙ) be a probability space. A function X : Ω →ℝis a random variable provided that it
satisfies the following (purely technical) condition: for any Borel set B ⊆ℝ,
X−1(B) = {ω ∈Ω : X(ω) ∈B} ∈𝒜.
This is equivalent to the property that for all t ∈ℝone has
{ω ∈Ω : X(ω) ≤t} ∈𝒜.
3.2 Probability distribution of a random variable
Suppose we are given a random variable X : Ω →ℝ. We define now a mapping ℙX from
ℬ(ℝ) to [0, 1] as follows:
ℙX (B) := ℙ(X−1(B)) = ℙ{ω ∈Ω : X(ω) ∈B} ,
B ∈ℬ(ℝ) .
Observe that ℙX is well defined. Indeed, since X is a random variable, for all Borel sets
B ⊆ℝwe have X−1(B) ∈𝒜, hence ℙ(X−1(B)) makes sense.
To simplify the notation, given B ∈ℬ(ℝ), we will often write
ℙ{X ∈B} = ℙ{ω ∈Ω : X(ω) ∈B} .
This is generally used and does not lead to any confusion. Having said this, we may now
define ℙX also by
ℙX(B) = ℙ{X ∈B} .
A first easy example shows how ℙX is calculated in concrete cases. Other more interest-
ing examples will follow after some necessary preliminary considerations.
Example 3.2.1. Toss a fair coin, labeled on one side by “0” and on the other side by “1”,
three times. The sample space is Ω = {0, 1}3 with the uniform distribution ℙdescribing
probability measure. Let the random variable X on Ω be defined by
X(ω) := ω1 + ω2 + ω3
whenever ω = (ω1, ω2, ω3) ∈Ω .
It follows that
ℙX({0}) = ℙ{X = 0} = ℙ({(0, 0, 0)}) = 1
8,

134
౪
3 Random variables and their distribution
ℙX({1}) = ℙ{X = 1} = ℙ({(1, 0, 0), (0, 1, 0), (0, 0, 1)}) = 3
8,
ℙX({2}) = ℙ{X = 2} = ℙ({(1, 1, 0), (0, 1, 1), (1, 0, 1)}) = 3
8,
ℙX({3}) = ℙ{X = 3} = ℙ({(1, 1, 1)}) = 1
8 .
Of course, these values describe the distribution of X completely. Indeed, whenever
B ⊆ℝ,
ℙX(B) =
3
∑
k=0
k∈B
ℙX({k}) .
For example, we have
ℙX([−1, 1]) = ℙX({0}) + ℙX({1}) = 1
8 + 3
8 = 1
2 .
So, with probability 1/2, we observe an ω = (ω1, ω2, ω3) for which
−1 ≤ω1 + ω2 + ω3 ≤1 .
The proof of the next result heavily depends on properties of the preimage proved
in Proposition A.2.1.
Proposition 3.2.2. Let (Ω, 𝒜, ℙ) be a probability space. For a random variable X : Ω →ℝ,
the mapping ℙX : ℬ(ℝ) →[0, 1] is a probability measure.
Proof. Using property (1) in Proposition A.2.1, one easily gets
ℙX(0) = ℙ(X−1(0)) = ℙ(0) = 0,
as well as
ℙX(ℝ) = ℙ(X−1(ℝ)) = ℙ(Ω) = 1 .
Thus it remains to verify the σ-additivity of ℙX. Take any sequence of disjoint Borel sets
B1, B2, . . . in ℝ. Then also X−1(B1), X−1(B2), . . . are disjoint subsets of Ω. To see this, apply
Proposition A.2.1, which, if i
̸= j, implies
X−1(Bi) ∩X−1(Bj) = X−1(Bi ∩Bj) = X−1(0) = 0 .
Another application of Proposition A.2.1 and of the σ-additivity of ℙfinally gives
ℙX(
∞
⋃
j=1
Bj) = ℙ(X−1(
∞
⋃
j=1
Bj)) = ℙ(
∞
⋃
j=1
X−1(Bj))

3.2 Probability distribution of a random variable
౪
135
=
∞
∑
j=1
ℙ(X−1(Bj)) =
∞
∑
j=1
ℙX(Bj) .
Hence, ℙX is a probability measure, as asserted.
Definition 3.2.3. The probability measure ℙX on (ℝ, ℬ(ℝ)) defined by
ℙX(B) := ℙ(X−1(B)) = ℙ{ω ∈Ω : X(ω) ∈B} = ℙ{X ∈B} ,
B ∈ℬ(ℝ),
is called the probability distribution of X (with respect to ℙ) or, in short, the distribution of X.
Remark 3.2.4. The distribution ℙX is the most important characteristic of a random
variable X. In general, it is completely unimportant how a random variable is defined
analytically; only its distribution matters. Thus, two random variables with identical
distributions may be regarded as equivalent because they describe the same random
experiment.
Remark 3.2.4 leads us to the following definition:
Definition 3.2.5. Two random variables X1 and X2 are said to be identically distributed provided that
ℙX1 = ℙX2. Hereby, it is not necessary that X1 and X2 be defined on the same sample space. Only their
distributions have to coincide. In the case of identically distributed X1 and X2, one writes X1
d= X2 .
Example 3.2.6. Toss a fair coin, labeled on each side by “0” or “1,” twice. Let X1 be the
value of the first toss and X2 that of the second. Then
ℙ{X1 = 0} = ℙ{X2 = 0} = 1
2 = ℙ{X1 = 1} = ℙ{X2 = 1} .
Hence, X1 and X2 are identically distributed, or X1
d= X2. Both random variables describe
the same experiment, namely a single toss of a fair coin. Now, toss the coin a third time
and let X3 be the result of the third trial. Then we also have X1
d= X3, but note that X1 and
X3 are defined on different sample spaces.
Next, we state and prove some general rules for evaluating the probability distri-
bution of a given random variable. Here we have to distinguish between two different
types of random variables, namely between discrete and continuous ones. Let us start
with the discrete case.
Definition 3.2.7. A random variable X is discrete provided there exists an at most countably infinite set
D ⊂ℝsuch that X: Ω →D.
In other words, a random variable is discrete if it attains at most countably infinitely many different
values.

136
౪
3 Random variables and their distribution
Remark 3.2.8. If a random variable X is discrete with values in D ⊂ℝ, then, of course,
ℙX(D) = ℙ{X ∈D} = 1 .
Consequently, in this case its probability distribution ℙX is a discrete probability mea-
sure on ℝ. In general, the converse is not valid as the next example shows.
Example 3.2.9. We model the experiment of rolling a fair die by the probability space
(ℝ, 𝒫(ℝ), ℙ), where ℙ({1}) = ⋅⋅⋅= ℙ({6}) = 1/6 and ℙ({x}) = 0 provided that x
̸= 1, . . . , 6.
If X : ℝ→ℝis defined by X(s) = s2 then, of course, ℙX is discrete. Indeed, we have
ℙX(D) = 1, where D = {1, 4, 9, 16, 25, 36}. On the other hand, X does not attain values in a
countably infinite set; its range is [0, ∞).
Remark 3.2.10. If we look at Example 3.2.9 more thoroughly, then it becomes immedi-
ately clear that the values of X outside of {1, . . . , 6} are completely irrelevant. With a
small change of X, it will attain values in D. More precisely, let
̃X(ω) = 1 if ω
̸= 1, . . . , 6
and ̃X(k) = k2, k = 1, . . . , 6; then X
d=
̃X and ̃X has values in {1, 4, 9, 16, 25, 36}.
This procedure is also possible in general: if ℙX is discrete with ℙX(D) = 1 for some
countable set D, then we may change X to
̃X such that X
d=
̃X and
̃X : Ω →D. Indeed,
choose some fixed d0 ∈D and set ̃X(ω) = X(ω) if ω ∈X−1(D) and ̃X(ω) = d0 otherwise.
Then ℙX = ℙ̃X and ̃X has values in D.
Convention 3.1. Without losing generality, we may always assume the following: if a
random variable X has a discrete probability distribution, that is, ℙ{X ∈D} = 1 for some
finite or countably infinite set D, then X attains values in D.
The second type of random variables we investigate is that of continuous ones.3
Definition 3.2.11. A random variable X is said to be continuous provided that its distribution ℙX is a
continuous probability measure. That is, ℙX possesses a density p. This function p is called the density
function or, in short, the density of the random variable X.
Remark 3.2.12. One should not confuse the continuity of a random variable with the
continuity of a function as taught in Calculus. The latter is an (analytic) property of a
function, while the former is a property of its distribution. Moreover, whether or not
a random variable X is continuous depends not only on X, but also on the underlying
probability space.
Remark 3.2.13. Another way to express that a random variable is continuous is as fol-
lows: there exists a function p : ℝ→[0, ∞) (the density of X) such that
ℙ{ω ∈Ω : X(ω) ≤t} = ℙ{X ≤t} =
t
∫
−∞
p(x) dx ,
t ∈ℝ,
3 The precise term would be “absolutely continuous”; but for simplicity let us call them “continuous.”

3.2 Probability distribution of a random variable
౪
137
or, equivalently, for all real numbers a < b,
ℙ{ω ∈Ω : a ≤X(ω) ≤b} = ℙ{a ≤X ≤b} =
b
∫
a
p(x) dx .
How do we determine the probability distribution of a given random variable? To
answer this question, let us first consider the case of discrete random variables.
Thus, let X be discrete with values in D = {x1, x2, . . . } ⊂ℝ. Then, as observed above,
it follows that ℙX(D) = 1, and, consequently, ℙX is uniquely determined by the numbers
pj := ℙX({xj}) = ℙ{X = xj} = ℙ{ω ∈Ω : X(ω) = xj} ,
j = 1, 2, . . .
(3.3)
Moreover, for any B ⊆ℝit follows that
ℙ{ω ∈Ω : X(ω) ∈B} = ℙX(B) = ∑
xj∈B
pj .
Consequently, in order to determine ℙX for discrete X, it completely suffices to deter-
mine the pjs defined by eq. (3.3). If we know (pj)j≥1, then the probability distribution ℙX
of X is completely described.
Remark 3.2.14. In the literature, quite often, one finds a slightly different approach for
the description of ℙX. Define p : ℝ→[0, 1] by
p(x) = ℙ{X = x} ,
x ∈ℝ.
(3.4)
This function p is then called the probability mass function of X. Note that p(x) = 0
whenever x ∉D. This function p satisfies p(x) ≥0, ∑x∈ℝp(x) = 1, and
ℙ{X ∈B} = ∑
x∈B
p(x) .
In this setting, the numbers pj in eq. (3.3) coincide with p(xj).
Example 3.2.15. Roll a fair die twice. Let X on {1, . . . , 6}2 be defined by
X(ω) = X(ω1, ω2) := ω1 + ω2 ,
ω = (ω1, ω2) .
Which distribution does X possess?
Answer: The very first question one has to answer is always about the possible val-
ues of X. In our case, X attains values in D = {2, . . . , 12}, thus it suffices to determine
ℙX({k}) = ℙ{X = k} = ℙ{(ω1, ω2) ∈Ω : X(ω1, ω2) = k} ,
k = 2, . . . , 12 .
One easily gets

138
౪
3 Random variables and their distribution
ℙX({2}) = ℙ{(ω1, ω2) : ω1 + ω2 = 2} = |{(1, 1)}|
36
= 1
36,
ℙX({3}) = ℙ{(ω1, ω2) : ω1 + ω2 = 3} = |{(1, 2), (2, 1)}|
36
= 2
36,
...
ℙX({7}) = ℙ{(ω1, ω2) : ω1 + ω2 = 7} = |{(1, 6), . . . , (6, 1)}|
36
= 6
36,
...
ℙX({12}) = ℙ{(ω1, ω2) : ω1 + ω2 = 12} = |{(6, 6)}|
36
= 1
36,
hence ℙX is completely described. For example, it follows that
ℙ{X ≤4} = ℙX((−∞, 4]) = ℙX({2}) + ℙX({3}) + ℙX({4}) = 1
36 + 2
36 + 3
36 = 1
6 .
Example 3.2.16. A biased coin is labeled on one side by “0” and on the other side by
“1”: for some p ∈[0, 1], number “1” shows up with probability p, thus “0” appears with
probability 1 −p. We toss the coin n times. The result is a sequence ω = (ω1, . . . , ωn),
where ωi ∈{0, 1}, hence the describing sample space is
Ω = {0, 1}n = {ω = (ω1, . . . , ωn) : ωi ∈{0, 1}} .
For i ≤n, let Xi : Ω →ℝbe defined by Xi(ω) := ωi. That is, Xi(ω) is the value of the ith
trial. What distribution does Xi possess?
Answer: In Example 1.9.13, we determined the probability measure ℙon 𝒫(Ω),
which describes the n-fold tossing of a biased coin. This probability measure was given
by
ℙ({ω}) = pk (1 −p)n−k ,
k =
n
∑
j=1
ωj
where ω = (ω1, . . . , ωn) .
(3.5)
The random variable Xi only attains the values “0” and “1.” Thus, in order to determine
ℙXi, it suffices to evaluate ℙXi({0}) = ℙ{ω ∈Ω : ωi = 0}. Let ω ∈Ω be a sequence with
ωi = 0. Then it may contain the value “1” at most n −1 times. Given k ≤n −1, there are
exactly (n−1
k ) such sequences ω with ωi = 0 and with k times “1.” Therefore, we obtain
ℙXi({0}) = ℙ{ω ∈Ω : ωi = 0} =
n−1
∑
k=0
ℙ{ω ∈Ω : ωi = 0 , ω1 + ⋅⋅⋅+ ωn = k}
=
n−1
∑
k=0
(n −1
k ) pk (1 −p)n−k = (1 −p)
n−1
∑
k=0
(n −1
k ) pk (1 −p)n−1−k
= (1 −p)[p + (1 −p)]
n−1 = 1 −p .
Of course, this also implies ℙXi({1}) = p.

3.2 Probability distribution of a random variable
౪
139
Remark 3.2.17. Note that all X1, . . . , Xn possess the same distribution, that is,
X1
d= ⋅⋅⋅
d= Xn .
Example 3.2.18. Roll a fair die twice and let ω1 and ω2 be the results of the first and
second toss, respectively. Define the random variable X by
X(ω1, ω2) = |ω1 −ω2| ,
ω1, ω2 ∈{1, . . . , 6} .
In a first step, we observe that X has values in D = {0, . . . , 5}. Hence, it suffices to deter-
mine PX({k}) = ℙ(X = k) for k = 0, . . . , 5. Doing so, we easily get
ℙX({0}) = 1
6
and
ℙX({1}) = 5
18,
. . . ,
ℙX({5}) = 1
18 .
Summary: Let X : Ω →ℝbe a discrete random variable. In order to describe its distribution ℙX, one has to
do two things:
(1)
Determine the finite or countably infinite set D ⊂ℝfor which ℙ{X ∈D} = 1.
(2)
For each x ∈D, evaluate
ℙX({x}) = ℙ{X = x} = ℙ{ω ∈Ω : X(ω) = x} .
If B ⊆ℝ, then it follows that
ℙ{X ∈B} = ∑
x∈B∩D
ℙX({x}) = ∑
x∈B∩D
ℙ{X = x} .
How do we determine the probability distribution of a random variable if it is contin-
uous? For each x ∈ℝ, ℙ{X = x} = 0, hence the values of ℙ{X = x} cannot be used
to describe ℙX as they did in the discrete case. Consequently, a different approach is
needed, and this approach is based on the use of distribution functions.
Definition 3.2.19. Let X be a random variable, either discrete or continuous. Then its (cumulative) dis-
tribution function FX : ℝ→[0, 1] is defined by
FX(t) := ℙX((−∞, t]) = ℙ{X ≤t} ,
t ∈ℝ.
(3.6)
Remark 3.2.20. Observe that for discrete and continuous random variables the distri-
bution function equals
FX(t) = ∑
xj≤t
pj
and
FX(t) =
t
∫
−∞
p(x) dx,
respectively. Here, in the discrete case, the xjs and pjs are as in eq. (3.3), while p denotes
the density of X in the continuous case.

140
౪
3 Random variables and their distribution
Furthermore, note that FX is nothing else than the distribution function of the prob-
ability measure ℙX, as it was introduced in Definition 1.7.1. Consequently, it possesses all
properties of a “usual” distribution function as stated in Proposition 1.7.13.
Summary: Let X be a random variable on a probability space (Ω, 𝒜, ℙ). The probability measure ℙX defined
by
ℙX(B) = ℙ{ω ∈Ω : X(ω) ∈B} ,
B ∈ℬ(ℝ) ,
denotes the probability distribution of X and
FX(t) = ℙ{ω ∈Ω : X(ω) ≤t} ,
t ∈ℝ,
is its (cumulative) distribution function.
Proposition 3.2.21. Let FX be defined by eq. (3.6). Then it possesses the following proper-
ties:
(1) The function FX is nondecreasing.
(2) It follows FX(−∞) = 0 as well as FX(∞) = 1.
(3) The function FX is continuous from the right.
Furthermore, if t ∈ℝ, then
ℙ{X = t} = FX(t) −FX(t −0) .
In particular, if X is continuous, then FX is a continuous function from ℝto [0, 1].
Remark 3.2.22. Note that the converse of the last implication does not hold. Indeed,
there exist random variables X for which FX is continuous, but X does not possess a
density. Such random variables are said to be singularly continuous. These are exactly
those random variables for which the probability measure ℙX is singularly continuous
in the sense of Remark 1.7.20.
The next result shows that under slightly stronger conditions about FX a density of
X exists.
Proposition 3.2.23. Let FX be continuous and continuously differentiable with the excep-
tion of at most finitely many points. Then X is continuous with density p(t) =
d
dt FX(t).
Hereby the values of p may be chosen arbitrarily at points where the derivative does not
exist; for example, set p(t) = 0 for those points.
Proof. The proof follows from the corresponding properties of distribution functions
for probability measures. Recall that FX is the distribution function of ℙX.
The previous proposition provides us with a method to determine the density of a
given random variable X. Evaluate the distribution function FX and differentiate it. The
obtained derivative is the density function we are looking for.

3.2 Probability distribution of a random variable
౪
141
The next three examples demonstrate how this method applies.
Example 3.2.24. Let ℙbe the uniform distribution on a sphere K of radius 1. That is, for
each Borel set B ∈ℬ(ℝ2), we have
ℙ(B) = vol2(B ∩K)
vol2(K)
= vol2(B ∩K)
π
.
Define the random variable X : ℝ2 →ℝby X(x1, x2) := x1. Of course, FX(t) = 0 whenever
t < −1 and FX(t) = 1 when t > 1. Thus, it suffices to determine FX(t) if −1 ≤t ≤1. For
those t ∈ℝ, we obtain
FX(t) = vol2(St ∩K)
π
where St is the half-space {(x1, x2) ∈ℝ2 : x1 ≤t} (compare Figure 3.1).
Figure 3.1: The gray shaded set represents the intersection between K and the half-space St.
If |t| ≤1, then
vol2(St ∩K) = 2
t
∫
−1
√1 −x2 dx ,
hence,
FX(t) = 2
π
t
∫
−1
√1 −x2 dx ,
|t| ≤1 ,
and by the fundamental theorem of Calculus, we finally get

142
౪
3 Random variables and their distribution
p(t) = d
dt FX(t) = 2
π
√1 −t2 ,
|t| ≤1 .
Summing up, the random variable X has the density p with
p(t) = {
2
π √1 −t2
if |t| ≤1 ,
0
if |t| > 1 .
(3.7)
Example 3.2.25. The probability space is the same as in Example 3.2.24, but this time we
define X by
X(x1, x2) := √x2
1 + x2
2 ,
(x1, x2) ∈ℝ2 .
Of course, it follows FX(t) = 0 if t < 0 while FX(t) = 1 if t > 1. Take t ∈[0, 1]. Then
FX(t) = vol2(K(t))
vol2(K(1)) = t2π
π
= t2 ,
where K(t) denotes a sphere of radius t. Differentiating FX with respect to t gives the
density
p(t) = {2 t
if 0 ≤t ≤1,
0
otherwise.
Example 3.2.26. Let ℙbe the uniform distribution on [0, 1] and define the random vari-
able X by X(s) = min{s, 1 −s}, s ∈ℝ. Find the probability distribution of X.
Answer: It is not difficult to see that
ℙ{X ≤t} = 0
if t < 0
and
ℙ{X ≤t} = 1
if t > 1/2 .
Thus it remains to evaluate FX(t) for 0 ≤t ≤1/2. Here we obtain
FX(t) = ℙ{X ≤t} = ℙ{s ∈[0, 1] : 0 ≤s ≤t or 1 −t ≤s ≤1}
= ℙ{s ∈[0, 1] : 0 ≤s ≤t} + ℙ{s ∈[0, 1] : 1 −t ≤s ≤1} = 2t .
Differentiating gives F′
X(t) = 2 if 0 ≤t ≤1/2 and F′
X(t) = 0 otherwise. Hence ℙX is the
uniform distribution on [0, 1/2].
Summary: To determine the density of a continuous random variable, proceed as follows:
1.
Evaluate (if possible) the distribution function FX(t) = ℙ{X ≤t}.
2.
Differentiate FX. If the derivative p(t) = F′
X(t) is piecewise continuous, then p is the desired density of X.

3.3 Special random variables
౪
143
3.3 Special random variables
We agree upon the following notation: a random variable X is said to be ABC-distributed
(or distributed according to ABC) if its probability distribution is a probability measure
of type ABC. For example, a random variable is said to be Bn,p-distributed (or distributed
according to Bn,p) if ℙX = Bn,p, that is, if
ℙ{X = k} = (n
k)pk(1 −p)n−k ,
k = 0, . . . , n .
Remark 3.3.1. To shorten the notation, at a few places we also write X ∼ABC whenever
ℙX is the probability measure ABC. So, for example, X ∼Bn,p tells us that
ℙ{X = k} = Bn,p({k}),
k = 0, . . . , n .
In this way, we define the following random variables of special type: X is
–
uniformly distributed on {x1, . . . , xN} if
ℙ{X = x1} = ⋅⋅⋅= ℙ{X = xN} = 1
N ,
–
Poisson distributed or Poisλ-distributed if
ℙ{X = k} = λk
k! e−λ ,
k = 0, 1, . . . ,
–
hypergeometrically distributed if
ℙ{X = m} =
(M
m) (N−M
n−m)
(N
n)
,
m = 0, . . . , n,
–
Gp-distributed or geometrically distributed if
ℙ{X = k} = p (1 −p)k−1 ,
k = 1, 2, . . . ,
–
B−
n,p-distributed or negative binomial distributed if
ℙ{X = k} = (k −1
k −n) pn(1 −p)k−n = (k −1
n −1) pn(1 −p)k−n ,
k = n, n + 1, . . . ,
or, equivalently, if
ℙ{X = n + k} = (−n
k ) pn (p −1)k ,
k = 0, 1, 2, . . .
Remark 3.3.2. In view of Convention 3.1, we may suppose that all random variables of
the preceding type are discrete. More precisely, we even may assume that X has values in

144
౪
3 Random variables and their distribution
the (at most countably infinite) set D with ℙX(D) = 1. For example, if X is Bn,p-distributed,
we may suppose that X has values in {0, . . . , n}.
In quite similar way, we denote specially distributed continuous random variables.
A real-valued random variable X is said to be
–
uniformly distributed on [α, β] if ℙX is the uniform distribution on [α, β]. That is, if
[a, b] ⊆[α, β], then
ℙ{a ≤X ≤b} = b −a
β −α ,
–
normally distributed or 𝒩(μ, σ2)-distributed if
ℙ{a ≤X ≤b} =
1
√2πσ
b
∫
a
e−(x−μ)2/2σ2
dx ,
–
standard normally distributed if it is 𝒩(0, 1)-distributed, that is,
ℙ{a ≤X ≤b} =
1
√2π
b
∫
a
e−x2/2 dx ,
–
gamma distributed or Γα,β-distributed if for 0 ≤a < b < ∞,
ℙ{a ≤X ≤b} =
1
αβ Γ(β)
b
∫
a
xβ−1 e−x/α dx ,
–
Eλ,n-distributed or Erlang distributed if it is Γλ−1,n-distributed, that is, whenever
0 ≤a < b < ∞, then
ℙ{a ≤X ≤b} =
λn
(n −1)!
b
∫
a
xn−1 e−λx dx ,
or if, equivalently, for any t ≥0,
ℙ{X ≥t} =
n−1
∑
j=0
(λt)j
j!
e−λt .
–
Eλ-distributed or exponentially distributed if for 0 ≤a < b < ∞,
ℙ{a ≤X ≤b} = λ
b
∫
a
e−λx dx = e−λa −e−λb ,

3.4 Random vectors
౪
145
–
arcsine distributed if, given 0 ≤a < b ≤1,
ℙ{a ≤X ≤b} = 1
π
b
∫
a
1
√x(1 −x)
dx = 2
π [arcsin(√b) −arcsin(√a)] .
–
Cauchy distributed if
ℙ{a ≤X ≤b} = 1
π
b
∫
a
dx
1 + x2 = 1
π [arctan b −arctan a] .
Remark 3.3.3. If a random variable X possesses a special distribution, then all proper-
ties of ℙX carry over to X. For example, in this language we may now formulate Poisson’s
limit theorem (Proposition 1.4.29) as follows.
Let Xn be Bn,pn-distributed and suppose that n pn →λ > 0 as n →∞. Then
lim
n→∞ℙ{Xn = k} = ℙ{X = k} ,
k = 0, 1, . . . ,
where X is Poisλ-distributed.
Or if X is gamma distributed, then ℙ{X > 0} = ℙX((0, ∞)) = 1, and so on.
Remark 3.3.4. A common question is how does one get a random variable X possessing
a certain given distribution. For example, how do we construct a binomial or a normally
distributed random variable? Suppose we want to model the rolling of a die by a random
variable X, which is uniformly distributed on {1, . . . , 6}. The easiest solution is to take
Ω = {1, . . . , 6} endowed with the uniform distribution ℙand define X by X(ω) = ω. But
this is not the only way to get such a random variable. One may also roll the die n times
and choose X as the value of the first (or of the second, etc.) roll. In a similar way, random
variables with other probability distributions may be constructed. Further possibilities
to model random variables will be investigated in Section 4.4.
Summary: There are two ways to model a random experiment. The classical approach is to construct a
probability space that describes this experiment. For example, if we toss a fair coin n times and record the
number of “heads,” then this may be described by the sample space {0, . . . , n} endowed with the probability
measure Bn,1/2. Another way to model a certain random experiment is to choose a random variable X so that
the probability of the occurrence of an event B ⊆ℝequals ℙ{X ∈B}. For example, the above experiment of
tossing a coin may also be described by a binomial random variable X (with parameters n and 1/2).
3.4 Random vectors
Suppose we are given n random variables X1, . . . , Xn defined on a sample space Ω. Our
objective is to combine these n variables into a single variable. More precisely, we will
investigate the following type of vector-valued mappings.

146
౪
3 Random variables and their distribution
Definition 3.4.1. Let ⃗X be a mapping from Ω →ℝn represented as
⃗X(ω) = (X1(ω), . . . , Xn(ω)) ,
ω ∈Ω.
Then, ⃗X is said to be an (n-dimensional) random vector or vector valued random variable, provided
that each of the Xjs is a (real-valued) random variable. The random variables Xj, 1 ≤j ≤n, are called the
coordinate mappings of ⃗X.
Instead of ⃗X, we may also write (X1, . . . , Xn), that is,
(X1, . . . , Xn)(ω) = (X1(ω), . . . , Xn(ω)) ,
ω ∈Ω .
A random vector
⃗X maps Ω into ℝn, that is, we assign to each observed ω ∈Ω a vector
⃗X(ω). The mapping ⃗X is again fixed and nonrandom. The randomness of ⃗X(ω) is caused
by the input.
Example 3.4.2. Roll a die two times. Let X1 be the maximum value, X2 the mini-
mum, and X3 the sum of both rolls. The three-dimensional vector
⃗X = (X1, X2, X3) maps
Ω = {1, . . . , 6}2 into ℝ3. For example, the pair (2, 5) is mapped to (5, 2, 7) or the image of
(5, 6) is (6, 5, 11).
Example 3.4.3. Suppose there are N people in an auditorium. Enumerate them from 1
to N and choose one person according to the uniform distribution on {1, . . . , N}. Say we
have chosen person k. Let X1(k) be the height of this person and X2(k) his or her weight.
As a result, we get a random two-dimensional vector (X1, X2) mapping k to the vector
(X1(k), X2(k)) in ℝ2.
Example 3.4.4. We place n balls into m urns successively. Hereby, each urn is equally
likely. If Xj denotes the number of balls in urn j, then we get an m-dimensional vector
⃗X = (X1, . . . , Xm). Observe that the values of ⃗X lie in the set
D = {(k1, . . . , km) : k1 + ⋅⋅⋅+ km = n} ⊆ℕm
0 .
Remark 3.4.5. The preceding examples suggest that the values of the coordinate map-
pings depend on each other. For instance, in Example 3.4.3 larger values of X1 make also
those of X2 more likely, and vice versa. A basic aim of the following sections is to confirm
this guess, that is, we want to find a mathematical formulation that describes whether
or not two or more random variables are dependent or independent.
Summary: Let (Ω, 𝒜, ℙ) be a probability space. A mapping ⃗X : Ω →ℝn is said to be an (n-dimensional)
random vector if ⃗X(ω) = (X1(ω), . . . , Xn(ω)) with random variables Xj : Ω →ℝ.

3.5 Joint and marginal distributions
౪
147
3.5 Joint and marginal distributions
The values of the vector ⃗X are randomly distributed in ℝn. Consequently, as in the case
of random variables, events of the form { ⃗X ∈B} occur with certain probabilities. But, in
contrast to the case of random variables, the event B is now a subset of ℝn, not of ℝas
before. More precisely, for events B ⊆ℝn, we are interested in the following quantity:4
ℙ{ω ∈Ω :
⃗X(ω) ∈B} = ℙ{ω ∈Ω : (X1(ω), . . . , Xn(ω)) ∈B} .
(3.8)
The next definition gives the exact formulation of the problem.
Definition 3.5.1. Let ⃗X : Ω →ℝn be a random vector with coordinate mappings X1, . . . , Xn. For each
Borel set B ∈ℬ(ℝn), we set
ℙ⃗X(B) = ℙ(X1,...,Xn)(B) = ℙ{ ⃗X ∈B} .
(3.9)
The mapping ℙ⃗X from ℬ(ℝn) into [0, 1] is said to be the probability distribution, or, in short, the distri-
bution of ⃗X. Often, ℙ⃗X = ℙ(X1,...,Xn) will also be called the joint distribution of X1, . . . , Xn.
In eq. (3.9), we used the shorter expression
ℙ{ ⃗X ∈B} = ℙ{ω ∈Ω :
⃗X(ω) ∈B} .
As for random variables, the following is also valid in the case of random vectors.
Proposition 3.5.2. The mapping ℙ⃗X is a probability measure defined on ℬ(ℝn).
Proof. The proof is completely analogous to that of Proposition 3.2.2. Therefore, we de-
cided not to present it here.
Let us evaluate ℙ⃗X(B) for special Borel sets B ⊆ℝn. If Q is a box in ℝn as in eq. (1.73),
that is, for certain real numbers ai < bi we have
Q = [a1, b1] × ⋅⋅⋅× [an, bn] ,
then it follows that
ℙ⃗X(Q) = ℙ{ ⃗X ∈Q} = ℙ{ω ∈Ω : a1 ≤X1(ω) ≤b1, . . . , an ≤Xn(ω) ≤bn} .
The later expression may also be written as
ℙ{a1 ≤X1 ≤b1, . . . , an ≤Xn ≤bn} .
4 For random vectors
⃗X and B ∈ℬ(ℝn), it follows that
⃗X−1(B) ∈𝒜. This can be proved by similar
methods as we used in the proof of Proposition 3.1.6. Thus, if B ∈ℬ(ℝn), then eqs. (3.8) and (3.9) are well
defined.

148
౪
3 Random variables and their distribution
Hence, for each box Q = [a1, b1] × ⋅⋅⋅× [an, bn], we obtain
ℙ⃗X(Q) = ℙ{a1 ≤X1 ≤b1, . . . , an ≤Xn ≤bn} .
Thus the quantity ℙ⃗X(Q) is the probability of the occurrence of the following event: X1
attains a value in [a1, b1], and at the same time X2 attains a value in [a2, b2], and so on up
to Xn attains a value in [an, bn].
Example 3.5.3. Roll a fair die three times. Let X1, X2, and X3 be the observed values in
the first, second, and third roll. If Q = [1, 2] × [0, 1] × [3, 4], then
ℙ⃗X(Q) = ℙ{X1 ∈{1, 2}, X2 = 1, X3 ∈{3, 4}} = 1
54 .
Remark 3.5.4. The previous considerations can easily be generalized to sets B ⊆ℝn of
the form B = B1 × ⋅⋅⋅× Bn with Bj ∈ℬ(ℝ). Then
ℙ⃗X(B) = ℙ{X1 ∈B1, . . . , Xn ∈Bn}.
(3.10)
Next we introduce the notion of marginal distributions of a random vector.
Definition 3.5.5. Let
⃗X = (X1, . . . , Xn) be a random vector. The n probability measures ℙX1 to ℙXn are
called the marginal distributions of ⃗X.
Observe that each marginal distribution ℙXj is a probability measure on ℬ(ℝ), while the
joint distribution ℙ(X1,...,Xn) is a probability measure defined on ℬ(ℝn).
In this context, the following important question arises: does the joint distribution
determine the marginal distributions and/or can the joint distribution be derived from
the marginal ones?
The next proposition gives the first answer.
Proposition 3.5.6. Let ⃗X = (X1, . . . , Xn) be a random vector. If 1 ≤j ≤n and B ∈ℬ(ℝ), then
ℙXj(B) = ℙ(X1,...,Xn)(ℝ× ⋅⋅⋅× B
⏟⏟⏟⏟⏟⏟⏟
j
× ⋅⋅⋅× ℝ) .
In particular, the joint distribution determines the marginal ones.
Proof. The proof is a direct consequence of formula (3.10). Let us apply it to Bi = ℝif
i
̸= j and Bj = B. Then, as asserted,
ℙ(X1,...,Xn)(ℝ× ⋅⋅⋅× B
⏟⏟⏟⏟⏟⏟⏟
j
× ⋅⋅⋅× ℝ)
= ℙ{X1 ∈ℝ, . . . , Xj ∈B, . . . , Xn ∈ℝ} = ℙ{Xj ∈B} = ℙXj(B) .
The question whether or not the marginal distributions determine the joint distri-
bution is postponed for a moment. It will be investigated in Example 3.5.8 and, more

3.5 Joint and marginal distributions
౪
149
thoroughly, in Section 3.6. Before, let us derive some concrete formulas to evaluate the
marginal distributions. Here we consider the two cases of discrete and continuous ran-
dom variables separately.
3.5.1 Marginal distributions: discrete case
To make the results in this subsection easier to understand, we only consider the case of
two-dimensional vectors. That is, we investigate two random variables and show how
their distributions may be derived from their joint one. We indicate later on how this
approach extends to more than two random variables.
In order to avoid confusing notations with many indices, given a two-dimensional
random vector, we denote its coordinate mappings by X and Y and not by X1 and X2.
This should not lead to mix-ups. Thus, we investigate the random vector (X, Y) with joint
distribution ℙ(X,Y) and marginal distributions ℙX and ℙY. This random vector maps Ω
into ℝ2 and acts as follows:
(X, Y)(ω) = (X(ω), Y(ω)) ,
ω ∈Ω .
Suppose now that X and Y are discrete. Then, there are finite or countably infinite sets
D = {x1, x2, . . . } and E = {y1, y2, . . . } such that X : Ω →D as well as Y : Ω →E. Con-
sequently, the vector (X, Y) maps Ω into the (at most countably infinite) set D × E ⊂ℝ2.
Observe that
D × E = {(xi, yj) : i, j = 1, 2, . . . } ,
hence ℙ(X,Y) is discrete as well and uniquely described by the numbers
pij := ℙ(X,Y)({(xi, yj)}) = ℙ{X = xi, Y = yj} ,
i, j = 1, 2, . . .
(3.11)
More precisely, given B ⊆ℝ2, we have
ℙ(X,Y)(B) = ℙ{(X, Y) ∈B} =
∑
{(i,j):(xi,yj)∈B}
pij .
We turn now to the description of the marginal distributions ℙX and ℙY. These are
uniquely determined by the numbers
qi := ℙX({xi}) = ℙ{X = xi}
and
rj := ℙY({yj}) = ℙ{Y = yj} .
(3.12)
In other words, if B, C ⊆ℝ, then it follows that
ℙX(B) = ℙ{X ∈B} =
∑
{i:xi∈B}
qi
and
ℙY(C) = ℙ{Y ∈C} =
∑
{j:yj∈C}
rj .

150
౪
3 Random variables and their distribution
The next proposition is nothing else than a reformulation of Proposition 3.5.6 in the
case of discrete random variables.
Proposition 3.5.7. Let the probabilities pij, qi, and rj be defined by eqs. (3.11) and (3.12),
respectively. Then the qis and rjs may be evaluated by the following equations:
qi =
∞
∑
j=1
pij
for i = 1, 2, . . .
and
rj =
∞
∑
i=1
pij
for j = 1, 2, . . .
Proof. As already mentioned, Proposition 3.5.7 is a direct consequence of Proposi-
tion 3.5.6. But for better understanding, we prefer to give a direct proof.
By virtue of the σ-additivity of ℙ, it follows that
qi = ℙ{X = xi} = ℙ{X = xi, Y ∈E} = ℙ{X = xi, Y ∈
∞
⋃
j=1
{yj}}
=
∞
∑
j=1
ℙ{X = xi, Y ∈{yj}} =
∞
∑
j=1
ℙ{X = xi, Y = yj} =
∞
∑
j=1
pij .
This proves the first part. The proof for the rjs follows exactly along the same line. Here,
one uses
rj = ℙ{Y = yj} = ℙ{X ∈D, Y = yj} =
∞
∑
i=1
ℙ{X = xi, Y = yj} =
∞
∑
i=1
pij .
This completes the proof.
The equations in Proposition 3.5.7 may be represented in table form as follows:
Y\X
x1
x2
x3
. . .
y1
p11
p21
p31
. . .
r1
y2
p12
p22
p32
. . .
r2
y3
p13
p23
p33
. . .
r3
...
...
...
...
...
...
q1
q2
q3
. . .
1
The entries in the above matrix are the corresponding probabilities. For example, the
entry p32 is put into the row marked by x3 and into the column where one finds y2 on
the left-hand side. This tells us p32 is the probability that X attains the value x3 and, at
the same time, Y equals y2. On the right and in the lower margins,5 one finds the cor-
responding sums of the columns and of the rows, respectively. These numbers describe
the marginal distributions (that of X at the bottom and that of Y in the right margin).
5 This explains the name “marginal” for the distribution of the coordinate mappings.

3.5 Joint and marginal distributions
౪
151
Finally, the number “1” at the right lower corner says that both the right column and
bottom row have to add up to “1.”
Example 3.5.8. There are four balls in an urn, two labeled with “0” and another two
labeled with “1.” Choose two balls without replacing the first. Let X be the value of the
first ball and Y that of the second. Direct calculations (use the law of multiplication) lead
to
ℙ{X = 0, Y = 0} = 1
6 ,
ℙ{X = 0, Y = 1} = 1
3,
ℙ{X = 1, Y = 0} = 1
3 ,
ℙ{X = 1, Y = 1} = 1
6.
In tabular form, this result reads as follows:
Y\X
0
1
0
1
6
1
3
1
2
1
1
3
1
6
1
2
1
2
1
2
1
Now suppose that we replace the first ball. This time we denote the values of the first
and second ball by X′ and Y ′, respectively. The corresponding table may now be written
as follows:
Y ′\X′
0
1
0
1
4
1
4
1
2
1
1
4
1
4
1
2
1
2
1
2
1
Let us look at Example 3.5.8 more thoroughly. In both cases (nonreplacing and re-
placing), the marginal distributions coincide, that is, ℙX = ℙX′ and ℙY = ℙY ′. But, on
the other hand, the joint distributions are different, that is, we have ℙ(X,Y)
̸= ℙ(X′,Y ′).
Conclusion. The marginal distributions do not, in general, determine the joint distribu-
tion. Recall that Proposition 3.5.6 asserts the converse implication: The marginal distri-
butions can be derived from the joint distribution.
Example 3.5.9. Roll a fair die twice. Let X be the minimum value of both rolls and Y the
maximum. Then, if k, l = 1, . . . , 6, it is easy to see that
ℙ{X = k, Y = l} =
{
{
{
{
{
{
{
{
{
0
if k > l,
1
36
if k = l,
1
18
if k < l.

152
౪
3 Random variables and their distribution
Hence, the joint distribution in table form looks as follows:
Y\X
1
2
3
4
5
6
1
1
36
0
0
0
0
0
1
36
2
1
18
1
36
0
0
0
0
3
36
3
1
18
1
18
1
36
0
0
0
5
36
4
1
18
1
18
1
18
1
36
0
0
7
36
5
1
18
1
18
1
18
1
18
1
36
0
9
36
6
1
18
1
18
1
18
1
18
1
18
1
36
11
36
11
36
9
36
7
36
5
36
3
36
1
36
1
If, for example, B
=
{(4, 5), (5, 4), (6, 5), (5, 6)}, then the values in the table imply
ℙ(X,Y)(B) = 1/9. In the same way, one gets ℙ{2 ≤X ≤4} = (9 + 7 + 5)/36 = 7/12.
To finish, we shortly go into the case of more than two discrete random variables.
Thus, let X1, . . . , Xn be random variables with Xj : Ω →Dj, where the sets Dj are either
finite or countably infinite. The set D defined by
D = D1 × ⋅⋅⋅× Dn = {(x1, . . . , xn) , xj ∈Dj}
is at most countably infinite and ⃗X : Ω →D. Consequently, ℙ⃗X is uniquely described by
the probabilities
px1,...,xn = ℙ{X1 = x1, . . . , Xn = xn} ,
xj ∈Dj .
Proposition 3.5.10. For 1 ≤j ≤n and x ∈Dj,
ℙ{Xj = x} = ∑
x1∈D1
⋅⋅⋅
∑
xj−1∈Dj−1
∑
xj+1∈Dj+1
⋅⋅⋅∑
xn∈Dn
px1,...,xj−1,x,xj+1,...,xn .
Proof. The proof is as that of Proposition 3.5.7. Therefore, we omit it.
Next, we want to state an important example that shows how Proposition 3.5.10
applies. To do so we need the following definition.
Definition 3.5.11. Let n and m be integers with m ≥2 and let p1, . . . , pm be certain success probabilities
satisfying pj ≥0 and p1+⋅⋅⋅+pm = 1. An m-dimensional random vector ⃗X = (X1, . . . , Xm) has multinomial
distribution with parameters n and p1, . . . , pm if, whenever k1 + ⋅⋅⋅+ km = n,
ℙ{X1 = k1, . . . , Xm = km} = (
n
k1, . . . , km
) pk1
1 ⋅⋅⋅pkm
m .
Equivalently, a random vector ⃗X has multinomial distribution if and only if its probabil-
ity distribution ℙ⃗X is a multinomial distribution as introduced in Definition 1.4.16.

3.5 Joint and marginal distributions
౪
153
Remark 3.5.12. The m-dimensional random vector
⃗X in Example 3.4.4 is multinomial
distributed with parameters n and pj = 1/m. That means
ℙ{X1 = k1, . . . , Xm = km} = (
n
k1, . . . , km
)( 1
m)
n
,
k1 + ⋅⋅⋅+ km = n .
Example 3.5.13. Let
⃗X : Ω →ℝn be a multinomial random vector with parameters n
and p1, . . . , pm. What are the marginal distributions of ⃗X?
Answer: To simplify the calculations, we only determine the probability distribu-
tion of Xm. The other cases follow in the same way. First note that in the notation of
Proposition 3.5.10,
pk1,...,km = {(
n
k1,...,km)pk1
1 ⋅⋅⋅pkm
m
if k1 + ⋅⋅⋅+ km = n,
0
if k1 + ⋅⋅⋅+ km
̸= n.
Consequently, Proposition 3.5.10 leads to
ℙ{Xm = k} =
n
∑
k1=0
⋅⋅⋅
n
∑
km−1=0
pk1,...,km−1,k
=
∑
k1+⋅⋅⋅+km−1=n−k
n!
k1! ⋅⋅⋅km−1! k! pk1
1 ⋅⋅⋅pkm−1
m−1pk
m
=
n!
k! (n −k)! pk
m
∑
k1+⋅⋅⋅+km−1=n−k
(n −k)!
k1! ⋅⋅⋅km−1! pk1
1 ⋅⋅⋅pkm−1
m−1
= (n
k)pk
m
∑
k1+⋅⋅⋅+km−1=n−k
(
n −k
k1, . . . , km−1
) pk1
1 ⋅⋅⋅pkm−1
m−1
= (n
k)pk
m (p1 + ⋅⋅⋅+ pm−1)n−k = (n
k)pk
m (1 −pm)n−k .
Hereby, in the last step, we used the multinomial theorem (Proposition A.3.20) with m−1
summands, with power n −k and entries p1, . . . , pm−1. Thus Xm is binomial distributed
with parameters n and pm. In the same way, one gets that each Xj is Bn,pj-distributed.
Remark 3.5.14. The previous result can also be seen more directly without using Propo-
sition 3.5.10. Assume we place n particles into m boxes, where pj is the probability to put
a single particle into box j. Fix some j ≤m and let success occur if a particle is placed
into box j. Then Xj equals the number of successes, hence it is Bn,pj-distributed. Note that
failure occurs if the particle is not placed into box j, and the probability for this is given
by 1 −pj = ∑n
i=1
i ̸=j pi.
Summary: Let (xi)i≥1 and (yj)j≥1 be the values of the (discrete) random variables X and Y, respectively. If the
joint distribution of (X, Y) is given by
pij := ℙ(X,Y)({(xi, yj)}) = ℙ{X = xi, Y = yj} ,
i, j = 1, 2, . . . ,

154
౪
3 Random variables and their distribution
then the marginal distributions are described by
qi = ℙX({xi}) = ℙ{X = xi} =
∞
∑
j=1
pij
and
rj = ℙY({yj}) = ℙ{Y = yj} =
∞
∑
i=1
pij .
3.5.2 Marginal distributions: continuous case
Let us turn now to the continuous case. Analogous to Definition 3.2.7, a random vector is
said to be continuous whenever it possesses a density.6 More precisely, we suppose that
a random vector shares the following property.
Definition 3.5.15. A random vector ⃗X = (X1, . . . , Xn) is said to be continuous if there is a function p :
ℝn →ℝsuch that, for all numbers aj < bj, 1 ≤j ≤n,
ℙ{a1 ≤X1 ≤b1, . . . , an ≤Xn ≤bn} =
b1
∫
a1
⋅⋅⋅
bn
∫
an
p(x1, . . . , xn) dxn ⋅⋅⋅dx1 .
An equivalent formulation is: for all real numbers t1, . . . , tn, one has
ℙ{X1 ≤t1, . . . , Xn ≤tn} =
t1
∫
−∞
⋅⋅⋅
tn
∫
−∞
p(x1, . . . , xn) dxn ⋅⋅⋅dx1 .
The function p is called the density function of ⃗X or the joint density of X1, . . . , Xn.
Remark 3.5.16. Observe that a random vector
⃗X is continuous if and only if its prob-
ability distribution ℙ⃗X is such, that is, the joint distribution of X1, . . . Xn is a continuous
probability measure on ℬ(ℝn) in the sense of Definition 1.8.5. Moreover, its density func-
tion coincides with the density of ℙ⃗X.
In the case of continuous random variables, the marginal distributions are evalu-
ated by the following rule.
Proposition 3.5.17. If a random vector ⃗X = (X1, . . . , Xn) has density p : ℝn →ℝ, then for
each j ≤n the random variable Xj is continuous with density
pj(xj) =
∞
∫
−∞
⋅⋅⋅
∞
∫
−∞
⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟
n−1 integrals
p( . . . , xj−1, xj, xj+1, . . .)dxn ⋅⋅⋅dxj+1 dxj−1 ⋅⋅⋅dx1 .
(3.13)
6 The following is true: for continuous random variables, the generated vector possesses a density. The
proof is far outside the scope of this book. Furthermore, we do not need this assertion because we assume
⃗X to be continuous, not the Xjs.

3.5 Joint and marginal distributions
౪
155
Proof. Fix an integer j ≤n. An application of Proposition 3.5.6 implies
ℙXj([a, b]) = ℙ⃗X(ℝ× ⋅⋅⋅× [a, b]
⏟⏟⏟⏟⏟⏟⏟⏟⏟
j
× ⋅⋅⋅× ℝ)
=
∞
∫
−∞
⋅⋅⋅
b
∫
a
⏟⏟⏟⏟⏟⏟⏟
j
⋅⋅⋅
∞
∫
−∞
p(x1, . . . , xn) dxn ⋅⋅⋅dx1
=
b
∫
a
[
∞
∫
−∞
⋅⋅⋅
∞
∫
−∞
p(. . . , xj−1, xj, xj+1, . . .)dxn ⋅⋅⋅dxj+1 dxj−1 ⋅⋅⋅dx1] dxj
=
b
∫
a
pj(xj) dxj
with pj defined by eq. (3.13). The interchange of the integrals was justified by Fubini’s
theorem (Proposition A.5.5); note that p is a density, hence it is nonnegative. Since the
preceding equation holds for all real numbers a < b, the function pj has to be the density
of ℙXj. This completes the proof.
Inthecasen = 2,formula(3.13)assertsthefollowing.Letp : ℝ2 →ℝbethejointdensityofthe2-dimensional
vector (X1, X2). Then the functions p1 and p2 defined by
p1(x1) =
∞
∫
−∞
p(x1, x2) dx2
and
p2(x2) =
∞
∫
−∞
p(x1, x2) dx1
are densities of X1 and X2, respectively.
Remark 3.5.18. Another way to formulate Proposition 3.5.17 is as follows: if the function
p : ℝn →ℝis a joint density of ⃗X = (X1, . . . , Xn), then p1, . . . , pn defined in eq. (3.13) are
densities of the random variables X1, . . . , Xn, respectively.
Example 3.5.19. Choose by random a point x = (x1, x2, x3) in the unit ball of ℝ3. How are
the coordinates x1, x2, and x3 distributed?
Answer: Let ⃗X = (X1, X2, X3) be uniformly distributed on the unit ball
K = {(x1, x2, x3) : x2
1 + x2
2 + x2
3 ≤1} .
Then the joint density is given by7
7 Recall that vol3(K) = 4
3 π.

156
౪
3 Random variables and their distribution
p(x) = {
3
4π
if x ∈K,
0
if x ∉K.
An application of Proposition 3.5.17 leads to p1(x1) = 0 whenever |x1| > 1 and, if |x1| ≤1,
then it follows that
p1(x1) = 3
4π
∬
x2
2+x2
3≤1−x2
1
dx2dx3 = 3
4π (1 −x2
1)π = 3
4(1 −x2
1) .
Hence, X1 has the density (compare Figure 3.2)
p1(s) = {
3
4(1 −s2)
if −1 ≤s ≤1,
0
otherwise.
(3.14)
Of course, by symmetry, X2 and X3 possess exactly the same distribution densities.
Figure 3.2: The density p1 defined by eq. (3.14).
Example 3.5.20. Suppose the two-dimensional random vector (X1, X2) has the density p
defined by8
p(x1, x2) := {8 x1x2
if 0 ≤x1 ≤x2 ≤1,
0
otherwise.
(3.15)
Then, the density p1 of X1 is given by
p1(x1) =
∞
∫
−∞
p(x1, x2) dx2 = 8 x1
1
∫
x1
x2 dx2 = 4(x1 −x3
1) ,
0 ≤x1 ≤1 ,
and p1(x1) = 0 if x1 ∉[0, 1].
8 Check that p is indeed a probability density.

3.6 Independence of random variables
౪
157
In the case of p2, the density of X2, it follows that
p2(x2) =
∞
∫
−∞
p(x1, x2) dx1 = 8 x2
x2
∫
0
x1 dx1 = 4 x3
2 ,
0 ≤x2 ≤1 ,
and p2(x2) = 0 if x2 ∉[0, 1]. See Figure 3.3 for the joint density of the random vector
(X1, X2) and its marginal distributions.
Figure 3.3: The two-dimensional density p defined by eq. (3.15) with marginal densities p1 and p2.
Remark 3.5.21. For p1 : ℝ→ℝand p2 : ℝ→ℝas in Example 3.5.20, define ̃p : ℝ2 →ℝ
by
̃p(x1, x2) = p1(x1) ⋅p2(x2) ,
(x1, x2) ∈ℝ2 .
In view of Proposition 1.8.8, the function ̃p is a (two-dimensional) density and, moreover,
as can be seen easily, its marginal distributions are p1 and p2 as well. But note that p
̸= ̃p.
Thus, this is another example showing that the marginal distributions of a random vec-
tor do not determine its joint distribution.
Summary: Let ⃗X = (X1, . . . , Xn) be a random (n-dimensional) vector. The probability distribution ℙ⃗X on ℬ(ℝn)
is said to be the joint distribution of X1, . . . , Xn while the probability measures ℙXj, 1 ≤j ≤n, denote the
marginal distributions of ⃗X. The joint distribution determines the n marginal distributions. In general, the
converse implication does not hold.
3.6 Independence of random variables
The central question considered in this section is as follows: when are n given random
variables independent? Surely everybody has an intuitive idea about the independence
or dependence of random values. But how do we express this property by a mathemat-
ical formula? Let us try to approach a solution of this problem with an example.

158
౪
3 Random variables and their distribution
Example 3.6.1. Roll a fair die twice and define the two random variables X1 and X2 as the
results of the first and second roll, respectively. These random variables are intuitively
independent of each other. But what property of these random variables does this ex-
press? Take two subsets B1, B2 ⊆{1, . . . , 6} and look at their preimages A1 = X−1
1 (B1) and
A2 = X−1
2 (B2). Then A1 occurs if the first result belongs to B1 while the same is true for
A2 whenever the second result belongs to B2. For example, A1 might indicate that the
first result is an even number while A2 could occur if the second result equals “4.” The
basic observation is that no matter how B1 and B2 were chosen, the occurrence of their
preimages A1 and A2 only depends on the first or second roll, respectively. Therefore,
they should be independent (as events) in the sense of Definition 2.2.2, that is, the fol-
lowing equation should hold:
ℙ{X1 ∈B1, X2 ∈B2} = ℙ(X−1
1 (B1) ∩X−1
2 (B2)) = ℙ(A1 ∩A2)
= ℙ(A1) ⋅ℙ(A2) = ℙ(X−1
1 (B1)) ⋅ℙ(X−1
2 (B2)) = ℙ{X1 ∈B1} ⋅ℙ{X2 ∈B2} .
This observation leads us to the following definition of independence.
Definition 3.6.2. Let X1, . . . , Xn be n random variables mapping Ω into ℝ. These variables are said to be
(stochastically) independent if, for all Borel sets Bj ⊆ℝ,
ℙ{X1 ∈B1, . . . , Xn ∈Bn} = ℙ{X1 ∈B1} ⋅⋅⋅ℙ{Xn ∈Bn} .
(3.16)
Remark 3.6.3. By virtue of Remark 3.5.4, eq. (3.16) may also be written as
ℙ(X1,...,Xn)(B1 × ⋅⋅⋅× Bn) = ℙX1(B1) ⋅⋅⋅ℙXn(Bn) ,
Bj ∈ℬ(ℝ) .
Before proceeding further, we shortly recall Corollary 1.9.9.
Corollary 3.6.4. Given n probability measures ℙ1, . . . , ℙn defined on ℬ(ℝ), there exists
a unique probability measure ℙon ℬ(ℝn), the product measure, which is denoted by
ℙ= ℙ1 ⊗⋅⋅⋅⊗ℙn, such that for all Borel sets Bj ⊆ℝ,
ℙ(B1 × ⋅⋅⋅× Bn) = ℙ1(B1) ⋅⋅⋅ℙn(Bn) .
(3.17)
Now, we are prepared to state the characterization of independent random vari-
ables by properties of their distributions.
Proposition 3.6.5. The random variables X1, . . . , Xn are independent if and only if their
joint distribution coincides with the product probability of the marginal distributions.
That is, if and only if
ℙ(X1,...,Xn) = ℙX1 ⊗⋅⋅⋅⊗ℙXn .
Proof. In view of Corollary 3.6.4, the product probability ℙof ℙX1, . . . , ℙXn is the unique
probability measure on ℬ(ℝn) satisfying

3.6 Independence of random variables
౪
159
ℙ(B1 × ⋅⋅⋅× Bn) = ℙX1(B1) ⋅⋅⋅ℙXn(Bn) ,
Bj ∈ℬ(ℝ) .
On the other hand, by Remark 3.6.3, the Xjs are independent if and only if
ℙ(X1,...,Xn)(B1 × ⋅⋅⋅× Bn) = ℙX1(B1) ⋅⋅⋅ℙXn(Bn) ,
Bj ∈ℬ(ℝ) .
(3.18)
Consequently, eq. (3.18) holds for all Borel sets Bj if and only if ℙ(X1,...,Xn) is the product
probability ℙX1 ⊗⋅⋅⋅⊗ℙXn. This completes the proof.
Corollary 3.6.6. If X1, . . . , Xn are independent, the joint distribution ℙ(X1,...,Xn) is uniquely
determined by its marginal distributions ℙX1, . . . , ℙXn.
Proof. Proposition 3.6.5 asserts that ℙ(X1,...,Xn) = ℙX1 ⊗⋅⋅⋅⊗ℙXn. Hence, the joint distribu-
tion is uniquely described by the marginal ones.
Another application of Proposition 3.6.5 deals with the existence of independent
random variables possessing given distributions.
Proposition 3.6.7. Let ℙ1, . . . , ℙn be given probability measures on the real line, discrete
or continuous. Then there is a probability space (Ω, 𝒜, ℙ) and there are independent ran-
dom variables Xj : Ω →ℝsuch that ℙXj = ℙj, 1 ≤j ≤n. In other words, for all Borel sets
B1, . . . , Bn we have
ℙ{X1 ∈B1, . . . , Xn ∈Bn} = ℙ{X1 ∈B1} ⋅⋅⋅ℙ{Xn ∈Bn} = ℙ1(B1) ⋅⋅⋅ℙn(Bn) .
Proof. Choose Ω = ℝn and endow it with the probability distribution (product measure)
ℙ= ℙ1 ⊗⋅⋅⋅⊗ℙn. Next we define random variables Xj : ℝn →ℝby
Xj(ω) = Xj(ω1, . . . , ωn) = ωj ,
1 ≤j ≤n .
Thus,
⃗X = (X1, . . . , Xn) is the identity, hence ℙ⃗X = ℙ. Consequently, Proposition 1.9.10
implies ℙXj = ℙj, 1 ≤j ≤n, and, moreover, by the choice of ℙit follows that
ℙ(X1, ... ,Xn) = ℙ⃗X = ℙ= ℙ1 ⊗⋅⋅⋅⊗ℙn = ℙX1 ⊗⋅⋅⋅⊗ℙXn .
So, in view of Proposition 3.6.5 the random variables X1 up to Xn are independent, as
asserted.
Example 3.6.8. Suppose we want to construct n independent Poisλ-distributed random
variables X1 up to Xn. To do so, choose Ω = ℕn
0 endowed with the product measure ℙof
n different Poisλ measures. That is,
ℙ({ ⃗k}) = λk1+⋅⋅⋅+kn
k1! ⋅⋅⋅kn!e−nλ ,
⃗k = (k1, . . . , kn) ∈ℕn
0 .
Then the random variables Xj : Ω →ℕ0 with

160
౪
3 Random variables and their distribution
Xj( ⃗k) = kj ,
⃗k = (k1, . . . , kn) ∈ℕ0 ,
are the independent n random variables distributed according to Poisλ.
The next proposition clarifies the relation between the properties “independence of
events” and “independence of random variables.” At a first glance, the assertion looks
trivial or self-evident, but it is not at all. The reason is that the definition of independence
for more than two events, as given in Definition 2.2.12, is more complicated than in the
case of two events.
Proposition 3.6.9. The random variables X1, . . . , Xn are independent if and only if for all
Borel sets B1, . . . , Bn in ℝthe events
X−1
1 (B1), . . . , X−1
n (Bn)
are stochastically independent in (Ω, 𝒜, ℙ).
Proof. When are X−1
1 (B1), . . . , X−1
n (Bn) independent? According to Definition 2.2.12, this
holds if for all subsets I ⊆{1, . . . , n},
ℙ(⋂
i∈I
X−1
i (Bi)) = ∏
i∈I
ℙ(X−1
i (Bi)) .
(3.19)
On the other hand, by Definition 3.6.2, X1, . . . , Xn are independent if
ℙ(
n
⋂
i=1
X−1
i (Bi)) = ℙ{X1 ∈B1, . . . , Xn ∈Bn}
=
n
∏
i=1
ℙ{Xi ∈Bi} =
n
∏
i=1
ℙ(X−1
i (Bi)) .
(3.20)
Of course, eq. (3.19) implies eq. (3.20); use eq. (3.19) with I = {1, . . . , n}. But it is far from
clear why, conversely, eq. (3.20) should imply eq. (3.19). As we saw in Example 2.2.10, for
fixed sets Bj this is even false. The key observation is that eq. (3.19) has to be valid for all
Borel sets Bj. This allows us to choose the Borel sets in an appropriate way.
Thus let us assume the validity of eq. (3.20) for all Borel sets in ℝ. Given Bj ∈ℬ(ℝ)
and a subset I of {1, . . . , n}, we introduce “new” B′
1, . . . , B′
n as follows: B′
i = Bi if i ∈I and
B′
i = ℝif i ∉I. This choice of the B′
j implies X−1
i (B′
i) = Ω whenever i ∉I. An application
of (3.20) to B′
1, . . . , B′
n leads to (recall X−1
i (B′
i) = Ω if i ∉I)
ℙ(⋂
i∈I
X−1
i (Bi)) = ℙ(
n
⋂
i=1
X−1
i (B′
i)) =
n
∏
i=1
ℙ(X−1
i (B′
i)) = ∏
i∈I
ℙ(X−1
i (Bi)) .
This proves eq. (3.19) for any subset I of {1, . . . , n}. So, X−1
1 (B1), . . . , X−1
n (Bn) are indepen-
dent as asserted.

3.6 Independence of random variables
౪
161
Remark 3.6.10. To verify the independence of X1, . . . , Xn, it is not necessary to check
eq. (3.16) for all Borel sets Bj. It suffices if this is valid for real intervals [aj, bj]. In other
words, X1, . . . , Xn are independent if and only if, for all aj < bj,
ℙ{a1 ≤X1 ≤b1, . . . , an ≤Xn ≤bn} = ℙ{a1 ≤X1 ≤b1} ⋅⋅⋅ℙ{an ≤Xn ≤bn}.
Furthermore, it also suffices to choose the Borel sets as intervals (−∞, tj] for tj ∈ℝ, i. e.,
X1, . . . , Xn are independent if and only if, for all tj ∈ℝ,
ℙ{X1 ≤t1, . . . , Xn ≤tn} = ℙ{X1 ≤t1} ⋅⋅⋅ℙ{Xn ≤tn} .
3.6.1 Independence of discrete random variables
As in Section 3.5.1, we restrict ourselves to the case of two random variables. The exten-
sion to more than two variables is straightforward and will be shortly considered at the
end of this section. We use the same notation as in Section 3.5.1. That is, the two random
variables are denoted by X and Y, and they map Ω into D = {x1, x2, . . .} and E = {y1, y2, . . .},
respectively. The joint distribution of (X, Y), as well as the marginal distributions, that
is, the distributions of X and Y, are described as in eqs. (3.11) and (3.12) by
pij = ℙ{X = xi, Y = yj} ,
qi = ℙ{X = xi},
and
rj = ℙ{Y = yj} .
With these notations the following result is valid.
Proposition 3.6.11. For the independence of two random variables X and Y, it is necessary
and sufficient that
pij = qi ⋅rj ,
1 ≤i, j < ∞.
Proof. The assertion is an immediate consequence of Propositions 1.9.11 and 3.6.5. But,
because of the importance of the result, we give an alternative proof avoiding the direct
use of product probabilities; only the techniques are similar.
Let us first show that the condition is necessary. Therefore, choose indices i and j,
and put B1 := {xi} and B2 := {yj}. Then {X ∈B1} occurs if and only if X = xi, and, in the
same way, the occurrence of {Y ∈B2} is equivalent to Y = yj. Since X and Y are assumed
to be independent, as claimed,
pij = ℙ{X = xi, Y = yj} = ℙ{X ∈B1, Y ∈B2} = ℙ{X ∈B1} ⋅ℙ{Y ∈B2}
= ℙ{X = xi} ⋅ℙ{Y = yj} = qi ⋅rj .
To prove the converse implication, assume we have pij = qi ⋅rj for all pairs (i, j) of
integers. Let B1 and B2 be two arbitrary subsets of ℝ. Then

162
౪
3 Random variables and their distribution
ℙ{X ∈B1, Y ∈B2} = ℙ(X,Y)(B1 × B2) =
∑
{(i,j):(xi,yj)∈B1×B2}
pij
=
∑
{(i,j):xi∈B1, yj∈B2}
qi ⋅rj =
∑
{i:xi∈B1}
∑
{j:yj∈B2}
qi ⋅rj
= ( ∑
{i:xi∈B1}
qi) ⋅( ∑
{j:yj∈B2}
rj) = ℙX(B1) ⋅ℙY(B2)
= ℙ{X ∈B1} ⋅ℙ{Y ∈B2} .
Since B1 and B2 were arbitrary, the random variables X and Y are independent. This
completes the proof.
Remark 3.6.12. The previous proposition implies again that for (discrete) independent
random variables the joint distribution is determined by the marginal ones. Indeed, in
order to know the pijs, it suffices to know the qis and rjs.
Let us represent the assertion of Proposition 3.6.11 graphically. It tells us that the
random variables X and Y are independent if and only if the table describing their joint
distribution may be represented as follows:
Y\X
x1
x2
x3
. . .
y1
q1r1
q2r1
q3r1
. . .
r1
y2
q1r2
q2r2
q3r2
. . .
r2
y3
q1r3
q2r3
q3r3
. . .
r3
...
...
...
...
...
...
q1
q2
q3
. . .
1
Example 3.6.13. Proposition 3.6.11 lets us conclude that X and Y in Example 3.5.8 (with-
out replacing) are dependent while X′ and Y ′ (with replacement) are independent. Fur-
thermore, by the same argument, the random variables X and Y in Example 3.5.9 (min-
imum and maximum value when rolling a die twice) are dependent as well.
Example 3.6.14. Let X and Y be two independent Poisλ-distributed random variables.
Then the joint distribution of the vector (X, Y) is determined by
ℙ{X = k, Y = ℓ} = λk+l
k! ℓ! e−2λ ,
(k, ℓ) ∈ℕ0 × ℕ0 .
For example, applying this for ℙ(X,Y)(B) with B = {(k, ℓ) : k = ℓ} leads to
ℙ{X = Y} =
∞
∑
k=0
ℙ{X = k, Y = k} =
∞
∑
k=0
λ2k
(k!)2 e−2λ .
Example 3.6.15. Suppose X and Y are two independent geometrically distributed ran-
dom variables, with parameters p and q, respectively. Evaluate ℙ{X ≤Y}.

3.6 Independence of random variables
౪
163
Solution: By the independence of X and Y,
ℙ{X ≤Y} =
∞
∑
k=1
ℙ{X = k, Y ≥k} =
∞
∑
k=1
ℙ{X = k} ⋅ℙ{Y ≥k}
=
∞
∑
k=1
p(1 −p)k−1
∞
∑
ℓ=k
q(1 −q)ℓ−1
= p q (
∞
∑
k=0
(1 −p)k)(
∞
∑
ℓ=k+1
(1 −q)ℓ−1)
= p q (
∞
∑
k=0
(1 −p)k)(
∞
∑
ℓ=k
(1 −q)ℓ)
= p q (
∞
∑
k=0
(1 −p)k(1 −q)k)(
∞
∑
ℓ=0
(1 −q)ℓ)
=
p
1 −(1 −p)(1 −q) =
p
p + q −pq .
In Example 1.9.12, we investigated the case p = q from a different point of view. The
results obtained there let us conclude that
ℙ{X ≤Y} = ℙ{X < Y} + ℙ{X = Y} =
p
2 −p + 1 −p
2 −p =
1
2 −p,
which coincides with what we got above if p = q.
Example of application: Player A rolls a die and, simultaneously, player B tosses two
fair coins labeled with “0” and “1.” Find the probability that player A observes the num-
ber “6” for the first time strictly before player B gets a “1” at both coins.
Answer: Let {Y = k} be the event that player A observes his first “6” in trial k. Sim-
ilarly, {X = k} occurs if player B has his first two “1” in trial k. Then we ask for the
probability ℙ{Y < X}. Note that X is geometrically distributed with parameter p = 1/4,
while the success probability for Y is q = 1/6. Hence, by the above calculations,
ℙ{Y < X} = 1 −ℙ{X ≤Y} = 1 −
1/4
1/4 + 1/6 −1/24 = 1
3 .
The next objective is to investigate in which cases two quite special random vari-
ables are independent. To this end, we need the following notation.
Definition 3.6.16. Let Ω be a set and A ⊆Ω. Then the indicator function 1A : Ω →ℝof A is defined
by
1A(ω) := {1
if ω ∈A,
0
if ω ∉A.
(3.21)

164
౪
3 Random variables and their distribution
Let us state some basic properties of indicator functions.
Proposition 3.6.17. Let (Ω, 𝒜, ℙ) be a probability space.
(1) The indicator function of a set A ⊆Ω is a random variable if and only if A ∈𝒜.
(2) If A ∈𝒜, then 1A is B1,p-distributed (binomial) where p = ℙ(A).
(3) If A, B ∈𝒜, then the random variables 1A and 1B are independent if and only if the
events A and B are independent.
Proof. Given t ∈ℝ, the event {ω ∈Ω : 1A(ω) ≤t} is either empty, Ac, or Ω whenever
t < 0, 0 ≤t < 1, or t ≥1, respectively. Consequently, the set {ω ∈Ω : 1A(ω) ≤t} is in 𝒜
for all t ∈ℝif and only if Ac ∈𝒜. But this happens if and only if A ∈𝒜, which proves
the first assertion.
To prove the second claim, we first observe that 1A attains only the values “0” and
“1.” Since
ℙ{1A = 1} = ℙ{ω ∈Ω : 1A(ω) = 1} = ℙ(A) = p ,
it is B1,p-distributed with p = ℙ(A) as claimed.
Let us turn to the last assertion. Given A, B ∈𝒜, their joint distribution in table form
is9
1B\1A
0
1
0
ℙ(Ac ∩Bc)
ℙ(A ∩Bc)
ℙ(Bc)
1
ℙ(Ac ∩B)
ℙ(A ∩B)
ℙ(B)
ℙ(Ac)
ℙ(A)
Consequently, by Proposition 3.6.11, the random variables 1A and 1B are independent if
and only if the following equations are valid:
ℙ(Ac ∩Bc) = ℙ(Ac) ⋅ℙ(Bc) ,
ℙ(Ac ∩B) = ℙ(Ac) ⋅ℙ(B),
ℙ(A ∩Bc) = ℙ(A) ⋅ℙ(Bc) ,
ℙ(A ∩B) = ℙ(A) ⋅ℙ(B) .
Because of Proposition 2.2.7, these four equations are satisfied if and only if the events
A and B are independent. This proves the third assertion.
Finally, let us shortly discuss the independence of more than two discrete random
variables. Hereby we use the same notation as in Proposition 3.5.10, that is, the random
variables X1, . . . , Xn satisfy Xj : Ω →Dj, where Dj is either finite or countably infinite.
Then the following generalization of Proposition 3.6.11 is valid. Its proof is almost iden-
tical to that for two variables. Therefore, we omit it.
9 Use, for example, that 1A(ω) = 0 and 1B(ω) = 0 if and only if ω ∈Ac ∩Bc.

3.6 Independence of random variables
౪
165
Proposition 3.6.18. The random variables X1, . . . , Xn are independent if and only if for all
xj ∈Dj,
ℙ{X1 = x1, . . . , Xn = xn} = ℙ{X1 = x1} ⋅⋅⋅ℙ{Xn = xn} .
Example 3.6.19. Let us consider the problem of tossing a biased coin n times. The sam-
ple space is Ω = {0, 1}n, and the describing probability measure ℙis as in eq. (3.5). The
random variables Xj are defined as results of toss j. Then Xj : Ω →Dj, where Dj = {0, 1}.
If we choose arbitrary xj ∈Dj, then either xj = 0 or xj = 1. Let k be the number of those
xj, which equals 1, that is, k = x1 + ⋅⋅⋅+ xn. Formula (3.5) implies
ℙ{X1 = x1, . . . , Xn = xn} = ℙ{(x1, . . . , xn)} = pk(1 −p)n−k .
On the other hand, as shown in Example 3.2.16, the probability distribution of each Xj
satisfies
ℙ{Xj = 0} = 1 −p
and
ℙ{Xj = 1} = p .
Since exactly k of the xjs are “1” and n −k are “0,”, this implies
ℙ{X1 = x1} ⋅⋅⋅ℙ{Xn = xn} = pk(1 −p)n−k .
Summing up, for all xj ∈Dj,
ℙ{X1 = x1, . . . , Xn = xn} = pk(1 −p)n−k = ℙ{X1 = x1} ⋅⋅⋅ℙ{Xn = xn} ,
that is, X1, . . . , Xn are independent.
Summary: Two discrete random variables X and Y with values (xi)i≥1 and (yj)j≥1, respectively, are indepen-
dent if and only if for all 1 ≤i, j < ∞,
ℙ{X = xi, Y = yj} = ℙ{X = xi} ⋅ℙ{Y = yj} .
3.6.2 Independence of continuous random variables
We will consider the question of when continuous random variables are independent.
Thus, let X1, . . . , Xn be continuous random variables with distribution densities p1, . . . , pn,
that is, for 1 ≤j ≤n and real numbers a < b,
ℙXj([a, b]) = ℙ{a ≤Xj ≤b} =
b
∫
a
pj(x) dx .
With this notation, the independence of the Xjs may be characterized as follows.

166
౪
3 Random variables and their distribution
Proposition 3.6.20. For random variables X1, . . . , Xn with densities p1, . . . , pn, we define a
function p : ℝn →ℝby
p(x1, . . . , xn) := p1(x1) ⋅⋅⋅pn(xn) ,
(x1, . . . , xn) ∈ℝn .
(3.22)
Then the Xjs are independent if and only if p defined by eq. (3.22) is a distribution density
of the random vector ⃗X = (X1, . . . , Xn).
Proof. As in the discrete case, the result follows directly from Propositions 1.9.16 and
3.6.5. Without using product probabilities, we may argue as follows.
First, we observe that p defined by eq. (3.22) is a distribution density of ⃗X if and only
if for all aj < bj,
ℙ{a1 ≤X1 ≤b1, . . . , an ≤Xn ≤bn} =
b1
∫
a1
⋅⋅⋅
bn
∫
an
p1(x1) ⋅⋅⋅pn(xn) dxn ⋅⋅⋅dx1.
(3.23)
The right-hand side of eq. (3.23) coincides with
(
b1
∫
a1
p1(x1) dx1) ⋅⋅⋅(
bn
∫
an
pn(xn) dxn) = ℙ{a1 ≤X1 ≤b1} ⋅⋅⋅ℙ{an ≤Xn ≤bn} .
From this we derive that eq. (3.23) is valid for all aj < bj if and only if
ℙ{a1 ≤X1 ≤b1, . . . , an ≤Xn ≤bn} = ℙ{a1 ≤X1 ≤b1} ⋅⋅⋅ℙ{an ≤Xn ≤bn} .
By Remark 3.6.10, this is equivalent to the independence of the Xjs, completing the
proof.
Example 3.6.21. Throw a dart to a target, which is a circle of radius 1. The center of the
circle is the point (0, 0) and (x1, x2) ∈K denotes the point where the dart hits the target.
We assume that the point hit is uniformly distributed on K. The question is whether
or not the coordinates x1 and x2 of the point hit are dependent or independent of each
other.
Answer: Let ℙbe the uniform distribution on K, and define two random variables
X1 and X2 by X1(x1, x2) = x1 and X2(x1, x2) = x2. In this notation, the above question is
whether the random variables X1 and X2 are independent. The density p1 of X1 was found
in eq. (3.7). By symmetry, p2, the density of X2, coincides with p1, that is, we have
p1(x1) =
{
{
{
2
π √1 −x2
1
if |x1| ≤1,
0
if |x1| > 1,
and
p2(x2) =
{
{
{
2
π √1 −x2
2
if |x2| ≤1,
0
if |x2| > 1 .
But p1(x1) ⋅p2(x2) cannot be a distribution density of ℙ(X1,X2). Indeed, the vector
⃗X =
(X1, X2) is uniformly distributed on K, thus its (correct) density is p with

3.6 Independence of random variables
౪
167
p(x1, x2) = {
1
π
if x2
1 + x2
2 ≤1,
0
otherwise.
Thus, we conclude that X1 and X2 are dependent, hence also the coordinates x1 and x2 of
the point hit.
Example 3.6.22. We suppose now that the dart does not hit a circle but some rectangle
set R := [α1, β1] × [α2, β2]. Again we assume that the point (x1, x2) ∈R is uniformly dis-
tributed on R. The posed question is the same as in Example 3.6.21, namely whether x1
and x2 are independent of each other.
Answer: Define X1 and X2 as in the previous example. By assumption, the vector
⃗X = (X1, X2) is uniformly distributed on R, hence its distribution density p is given by
p(x1, x2) = {
1
vol2(R)
if (x1, x2) ∈R,
0
if (x1, x2) ∉R .
For the density p1 of X1, we get
p1(x1) =
∞
∫
−∞
p(x1, x2) dx2 = β2 −α2
vol2(R) =
1
β1 −α1
provided that α1 ≤x1 ≤β1. Otherwise, we have p1(x1) = 0. This tells us that X1 is uni-
formly distributed on [α1, β1]. In the same way, we obtain for x2 ∈[α2, β2] that
p2(x2) =
1
β2 −α2
and p2(x2) = 0 otherwise. Hence, X2 is also uniformly distributed, but this time on
[α2, β2]. From the equations for p1 and p2 it follows that for the joint density p one has
p(x1, x2) = p1(x1) ⋅p(x2) ,
(x1, x2) ∈ℝ2 .
Consequently, by Proposition 3.6.20, the random variables X1 and X2 are independent,
and so are the coordinates x1 and x2 of the point hit.
Example 3.6.23. Let us look at Example 3.6.22 from the opposite side. Now we assume
that the coordinates are uniformly distributed, not the vector. Thus let U1, . . . , Un be
independent random variables with Uj uniformly distributed on the interval [αj, βj],
1 ≤j ≤n. Then the random vector
⃗U = (U1, . . . , Un) is (multivariate) uniformly dis-
tributed on the box K = [α1, β1] × ⋅⋅⋅× [αn, βn]. This is an immediate consequence of
Example 1.9.17 combined with Proposition 3.6.5. A direct proof of this fact, without us-
ing product measures, is as follows.
The density of Uj is pj =
1
βj−αj 1[αj,βj], hence by Proposition 3.6.20 the joint density p
of
⃗U is given by

168
౪
3 Random variables and their distribution
p(x) = p1(x1) ⋅⋅⋅pn(xn) =
n
∏
j=1
(βj −αj)−1 =
1
voln(K) ,
x = (x1, . . . , xn) ∈K ,
and p(x) = 0 if x ∉K. Therefore,
ℙ{ ⃗U ∈B} = ∫
B
p(x) dx = voln(K ∩B)
voln(K)
,
B ∈ℬ(ℝn) ,
and
⃗U is uniformly distributed on K as asserted.
Example 3.6.24. Let X1, . . . , Xn be independent standard normally distributed. Which
joint density does the vector ⃗X = (X1, . . . , Xn) possess?
Answer: The density pj of the Xj, for j = 1, . . . , n, is
pj(x) =
1
√2π
e−x2/2 ,
x ∈ℝ.
Consequently, by the independence of the Xjs, the joint density p equals
p(x) = p1(x1) ⋅⋅⋅pn(xn) =
1
(2π)n/2 e−(x2
1+⋅⋅⋅+x2
n)/2
=
1
(2π)n/2 e−|x|2/2 ,
x = (x1, . . . , xn) .
This tells us that ℙ⃗X = 𝒩(0, 1)⊗n (cf. Definition 1.9.21) or, equivalently, ⃗X is n-dimensional
standard normally distributed.
Example 3.6.25. If X1, . . . , Xn are independent Eλ-distributed, then
pj(t) = {0
if t < 0,
λe−λt
if t ≥0,
hence, the random vector ⃗X = (X1, . . . , Xn) has the joint density
p(t) = λne−λ(t1+⋅⋅⋅+tn) ,
t = (t1, . . . , tn) ,
tj ≥0 ,
and p(t) = 0 if one of the tjs is negative.
Example 3.6.26. Suppose two random variables X1 and X2 are independent and Eλ (ex-
ponentially) and uniformly on [0, 1] distributed, respectively. Which distribution does
the vector ⃗X = (X1, X2) possess?
The density p of ⃗X equals
p(t, s) = {λe−λt ⋅1[0,1](s)
if t ≥0,
0
otherwise.

3.7 Order statistics∗
౪
169
For example, if B = {(t, s) : 0 ≤t ≤s ≤1}, then
ℙ{ ⃗X ∈B} = λ
1
∫
0
s
∫
0
e−λtdt ds =
1
∫
0
(1 −e−λs) ds = 1 + 1
λ(e−λ −1) .
When does this event B occur? Say the lifetime of a component is exponentially dis-
tributed with parameter λ > 0. Then the event B occurs if the component stops working
before a randomly chosen time s ∈[0, 1]. This number s is taken uniformly distributed
on [0, 1] and, moreover, independent of the lifetime of the component. For example, first
choose the number s ∈[0, 1], then check whether or not the component becomes defec-
tive before time s ∈[0, 1].
Summary: The random variables X1, . . . , Xn are independent if for all Borel sets B1, . . . , Bn in ℝit follows that
ℙ{X1 ∈B1, . . . , Xn ∈Bn} = ℙ{X1 ∈B1} ⋅⋅⋅ℙ{Xn ∈Bn} .
In other words, the joint distribution ℙ(X1,...,Xn) has to coincide with the product measure of the marginal
distributions ℙXj, 1 ≤j ≤n. Another equivalent condition for the independence is: for all real numbers
t1, . . . , tn, it follows that
ℙ{X1 ≤t1, . . . , Xn ≤tn} = ℙ{X1 ≤t1} ⋅⋅⋅ℙ{Xn ≤tn} .
If X1, . . . , Xn are continuous random variables with densities p1, . . . , pn, then they are independent if and only
if
p(x1, . . . , xn) = p1(x1) ⋅⋅⋅⋅⋅pn(xn) ,
(x1, . . . , xn) ∈ℝn ,
is a density of the random n-dimensional vector ⃗X = (X1, . . . , Xn).
3.7 Order statistics∗
This section is devoted to a quite practical problem. Suppose we execute independently
of each other the same random experiment n times. Say the results are the real numbers
x1, . . . , xn. For example, one may think of n different measurements of the same item,
and x1, . . . , xn are the observed values. After getting the xjs, we reorder them by their
size. These “new” numbers are denoted by x∗
1 , . . . , x∗
n and satisfy x∗
1 ≤⋅⋅⋅≤x∗
n . In other
words, the numbers are the same as before but now in nondecreasing order.
A slightly more precise way to introduce the ordered sample x∗
1 , . . . , x∗
n is as follows:
There exists at least one permutation π of order n (maybe more than one if some of the
xjs are equal) for which xπ(1) ≤xπ(2) ≤⋅⋅⋅≤xπ(n) . Setting
x∗
1 = xπ(1) ,
x∗
2 = xπ(2),
up to
x∗
n = xπ(n) ,

170
౪
3 Random variables and their distribution
the new sample x∗
1 , . . . , x∗
n consists of the same values as x1, . . . , xn, but now these values
are ordered by their size.
For example, if x1 = 8.5, x2 = 7.1, and x3 = 7.9, then we obtain x∗
1 = 7.1, x∗
2 = 7.9, and
x∗
3 = 8.5.
In order to apply this ordering procedure to random observations, one needs an
algorithm for constructing the x∗
j s. This is easy if xi
̸= xj for i
̸= j. Then
x∗
1 = min{xi : 1 ≤i ≤n}
while
x∗
k = min{xi : xi > x∗
k−1}
if k ≥2 .
For general values, that is, not necessarily different ones, the construction is slightly
more complicated. The basic observation is that the ordered values possess the following
property: given t ∈ℝ, for all 1 ≤k ≤n,
x∗
k ≤t
⇔
Number of xi ≤t is at least k
⇔
󵄨󵄨󵄨󵄨{i ≤n : xi ≤t}󵄨󵄨󵄨󵄨≥k .
(3.24)
This implies that
x∗
k = inf{t ∈ℝ: 󵄨󵄨󵄨󵄨{i ≤n : xi ≤t}󵄨󵄨󵄨󵄨≥k} = inf{t ∈ℝ:
n
∑
i=1
1(−∞,t](xi) ≥k} .
(3.25)
For better understanding, here an easy example.
Example 3.7.1. Assume our sample is
x1 = 3 ,
x2 = 1 ,
x3 = 3,
and
x4 = 2 .
Then we get
󵄨󵄨󵄨󵄨{i ≤4 : xi ≤t}󵄨󵄨󵄨󵄨=
{
{
{
{
{
{
{
{
{
{
{
{
{
0
if −∞< t < 1,
1
if 1 ≤t < 2,
2
if 2 ≤t < 3,
4
if 3 ≤t < ∞,
which implies
inf{t ∈ℝ: 󵄨󵄨󵄨󵄨{i ≤4 : xi ≤t}󵄨󵄨󵄨󵄨≥k} =
{
{
{
{
{
{
{
{
{
{
{
{
{
1
if k = 1,
2
if k = 2,
3
if k = 3,
3
if k = 4.
So we finally arrive at x∗
1 = 1, x∗
2 = 2, x∗
3 = 3, and x∗
4 = 3.
The basic question treated in this section is now as follows. Suppose the values
x1, . . . , xn were obtained by n random experiments, independently and according to a

3.7 Order statistics∗
౪
171
known distribution. How are then the ordered x∗
k s distributed? For example, one rolls
a fair die 10 times and observes x1, . . . , x10 in {1, . . . , 6}. Then, for instance, one may ask
how likely it is that the third smallest value x∗
3 equals 5. Or which probability does the
event {x∗
4 = 3} possess?
The precise mathematical formulation of this problem is as follows: let X1, . . . , Xn
be n independent identically distributed random variables defined on a sample space
Ω. Define random variables X∗
1 , . . . , X∗
n as its values ordered by their size. One possible
way to define these new random variables is by, for example, using eq. (3.25). That is,
given k ≤n and ω ∈Ω,
X∗
k (ω) = inf{t ∈ℝ: 󵄨󵄨󵄨󵄨{i ≤n : Xi(ω) ≤t}󵄨󵄨󵄨󵄨≥k}
= inf{t ∈ℝ:
n
∑
i=1
1(−∞,t](Xi(ω)) ≥k}.
In particular, we get
X∗
1 = min{X1, . . . , Xn}
and
X∗
n = max{X1, . . . , Xn} .
Remark 3.7.2. Those to whom the definition of the X∗
k s looks too complicated may use
the following construction: for each fixed ω ∈Ω, one chooses a permutation π of order
n, depending on ω, for which
Xπ(1)(ω) ≤Xπ(2)(ω) ≤⋅⋅⋅≤Xπ(n)(ω) .
Then one gets the X∗
k s by setting
X∗
1 (ω) = Xπ(1)(ω) ,
X∗
2 (ω) = Xπ(2)(ω),
up to
X∗
n (ω) = Xπ(n)(ω) .
In this connection, it is important that there are at most finitely many (not more than n!)
different permutations π, depending on ω, for ordering the values X1(ω) up to Xn(ω) by
their size. Thus, our sample space splits into at most n! subsets where in each of them
one special permutation orders all Xj(ω) in nondecreasing order.
Definition 3.7.3. The ordered random variables X∗
1 , . . . , X∗
n are called the order statistics of X1, . . . , Xn.
Similarly, if x1, . . . , xn are observed random real numbers, the ordered x∗
k s are the order statistics of
the xjs.
Remark 3.7.4. By construction, the random variables X∗
k satisfy X∗
1 ≤⋅⋅⋅≤X∗
n . But note
that they are no longer independent nor are identically distributed.
Remark 3.7.5. Order statistics play an important role in Mathematical Statistics. For ex-
ample, suppose at time t = 0 we switch on n light bulbs of the same type. Let us record
the times 0 < t∗
1 < t∗
2 < ⋅⋅⋅< t∗
n, where some of the n bulbs burn out. Then these times

172
౪
3 Random variables and their distribution
are nothing else than the order statistics of the lifetimes t1, . . . , tn of the first, second, and
so on, light bulb.
Before we state and prove the main result of this section, let us recall that the Xjs
are assumed to be identically distributed. Consequently, all of them possess the same
distribution function F. That is, for all j ≤n, we have
F(t) = ℙ{Xj ≤t} ,
t ∈ℝ,
Proposition 3.7.6. Let X1, . . . , Xn be independent identically distributed random variables
with distribution function F. Then for each k ≤n, we have
ℙ{X∗
k ≤t} =
n
∑
i=k
(n
i)F(t)i (1 −F(t))
n−i ,
t ∈ℝ.
(3.26)
Proof. Fix t ∈ℝ. When does the event {X∗
k ≤t} occur? To answer this, for i ≤n introduce
disjoint sets Ai as follows: the event Ai occurs if and only if exactly i of the Xjs attain a
value in (−∞, t]. More precisely,
Ai = {ω ∈Ω : 󵄨󵄨󵄨󵄨{j ≤n : Xj(ω) ≤t}󵄨󵄨󵄨󵄨= i} .
Using eq. (3.24), the event {X∗
k ≤t} occurs if and only if at least k of the Xjs attain a value
in (−∞, t]. Thus, by the definition of the Ais, the event {X∗
k ≤t} coincides with ⋃n
i=k Ai.
Consequently, since the Ais are disjoint, it follows that
ℙ{X∗
k ≤t} =
n
∑
i=k
ℙ(Ai) .
(3.27)
Let Yj = 1(−∞,t](Xj). Then Yj = 1 if and only if Xj ≤t while Yj = 0 otherwise. Hence, the
Yjs are binomial distributed with parameters 1 and p, where
p = ℙ{Yj = 1} = ℙ{Xj ≤t} = F(t) .
Since the Xjs are independent, so are the Yjs and their sum10 Y1 + ⋅⋅⋅+ Yn is binomial
distributed with parameters n and p = F(t). Note that the event Ai occurs if and only if
Y1 + ⋅⋅⋅+ Yn = i, which implies
ℙ(Ai) = ℙ{Y1 + ⋅⋅⋅+ Yn = i} = (n
i)pi(1 −p)n−i = (n
i)F(t)i(1 −F(t))
n−i .
(3.28)
Plugging eq. (3.28) into eq. (3.27) proves eq. (3.26).
10 Here we already use a result, which will be proved later on in Proposition 4.6.1.

3.7 Order statistics∗
౪
173
Example 3.7.7. Let us choose independently and according to the uniform distribution
n numbers x1, . . . , xn out of {1, . . . , N}. Here, the same number may be chosen more than
once. Given integers m ≤N and k ≤n, find the probability that the kth largest number
x∗
k equals m.
Answer: The distribution function F of the uniform distribution on {1, . . . , N} satis-
fies
F(m) = m
N ,
m = 1, . . . , N .
Thus Proposition 3.7.6 implies
ℙ{x∗
k ≤m} =
n
∑
i=k
(n
i)(m
N )
i
(1 −m
N )
n−i
.
(3.29)
In particular,
ℙ{x∗
n = 1} = ℙ{x∗
n ≤1} = ( 1
N )
n
and
ℙ{x∗
k ≤N} = 1 ,
k = 1, . . . , n .
Because of {x∗
k = m} = {x∗
k ≤m} \ {x∗
k ≤m −1}, we obtain
ℙ{x∗
k = m} = ℙ{x∗
k ≤m} −ℙ{x∗
k ≤m −1}
=
n
∑
i=k
(n
i)[(m
N )
i
(1 −m
N )
n−i
−(m −1
N
)
i
(1 −m −1
N
)
n−i
] .
(3.30)
Here the right-hand expression vanishes in the case m = 1. For instance, we get
ℙ{x∗
1 = 1} =
n
∑
i=1
(n
i)( 1
N )
i
(1 −1
N )
n−i
= 1 −(1 −1
N )
n
.
Another, more direct, approach for this result is as follows: One has x∗
1 > 1 if and only if
all xjs satisfy xj ≥2. And among all possible Nn ways to choose the xjs, there are (N −1)n
possible ones to choose the xjs in {2, . . . , N}.
Example 3.7.8. Roll a die four times and order the results in nondecreasing order as
x∗
1 ≤x∗
2 ≤x∗
3 ≤x∗
4 . What is the probability that x∗
3 equals m for some 1 ≤m ≤6?
Answer: Let us apply formula (3.29) with N = 6, k = 3, and n = 4. For m ∈{1, . . . , 6},
this implies
ℙ{x∗
3 ≤m} =
4
∑
i=3
(4
i)(m
6 )
i
(6 −m
6
)
4−i
,
hence
ℙ{x∗
3 = m} =
4
∑
i=3
(4
i)[(m
6 )
i
(6 −m
6
)
4−i
−(m −1
6
)
i
(6 −m + 1
6
)
4−i
] .

174
౪
3 Random variables and their distribution
The probabilities are
m
ℙ{x∗
3 ≤m}
1
0.0162037
2
0.111111
3
0.3125
4
0.592593
5
0.868056
6
1
and
m
ℙ{x∗
3 = m}
1
0.0162037
2
0.0949074
3
0.201389
4
0.280093
5
0.275463
6
0.131944
Thus, the most likely value of x∗
3 is the number “4.”
Remark 3.7.9. If we choose as in a lottery 6 numbers out of 49, then Proposition 3.7.6
and/or Example 3.7.7 do not apply. Why? Let x1, . . . , x6 be the numbers chosen first, sec-
ond, and so on. Then they are identically distributed on {1, . . . , 49}, but they are not inde-
pendent. For example, the probability that the second choice is number “2” given the first
number was “1” is not 1/49. This would be the case if the chosen number were replaced
after each choice. We refer to Problem 3.5 for the distribution of the order statistics in
the case of lottery numbers.
Let us now turn to the case of continuous random variables. That is, we assume that
the random variables Xj possess a distribution density p satisfying
ℙ{Xj ≤t} =
t
∫
−∞
p(x) dx ,
t ∈ℝ.
Again we remark that the preceding formula holds for all j ≤n. Indeed, the Xjs are
identically distributed, hence they all have the same density. A natural question arises:
what distribution density does X∗
k possess?
Proposition 3.7.10. Suppose p is the common density of the Xjs. Let X∗
1 ≤⋅⋅⋅≤X∗
n be the
order statistics of the Xj. Then the distribution density pk of X∗
k is given by
pk(t) =
n!
(k −1)!(n −k)! p(t) F(t)k−1(1 −F(t))
n−k .
Proof. It holds that
pk(t) = d
dt ℙ{X∗
k ≤t} = d
dt
n
∑
i=k
(n
i)F(t)i (1 −F(t))
n−i
=
n
∑
i=k
i(n
i) p(t)F(t)i−1(1 −F(t))
n−i −
n
∑
i=k
(n −i)(n
i) p(t)F(t)i (1 −F(t))
n−i−1.
(3.31)

3.7 Order statistics∗
౪
175
In fact, the index i in the second sum of eq. (3.31) runs only from k to n−1. Hence, shifting
it by 1, this sum becomes
n
∑
i=k+1
(n −i + 1) ( n
i −1) p(t) F(t)i−1 (1 −F(t))
n−i .
Because of
i (n
i) =
n!
(i −1)!(n −i)! = (n −i + 1) ( n
i −1),
both sums in eq. (3.31) cancel out for i = k + 1, . . . , n. Thus, we obtain
pk(t) = k (n
k) p(t) F(t)k−1(1 −F(t))
n−k
=
n!
(k −1)!(n −k)! p(t) F(t)k−1(1 −F(t))
n−k,
as asserted.
Example 3.7.11. Let us choose independently and according to the uniform distribution
on [0, 1] numbers x1, . . . , xn. After reordering them, we get 0 ≤x∗
1 ≤⋅⋅⋅≤x∗
n ≤1. Which
distribution does x∗
k possess?
Answer: The density p of the uniform distribution on [0, 1] is 1[0,1]. Furthermore, its
distribution function F is given by F(t) = t for 0 ≤t ≤1. Thus, by Proposition 3.7.10, the
density pk coincides with
pk(t) =
n!
(k −1)!(n −k)! tk−1(1 −t)n−k ,
0 ≤t ≤1 .
As already mentioned in Example 1.6.33, this is nothing else than the density of a beta dis-
tribution with parameters k and n −k + 1. Hence, for all k = 1, . . . , n and all 0 ≤a < b ≤1,
it follows that
ℙ{a ≤x∗
k ≤b} = ℬk,n−k+1([a, b]) =
n!
(k −1)! (n −k)!
b
∫
a
xk−1(1 −x)n−k dx .
Example 3.7.12. Let us investigate here the example that was already mentioned in Re-
mark 3.7.5. At time t = 0, we switch on n electric bulbs of the same type. The times
0 < t∗
1 ≤⋅⋅⋅≤t∗
n are those where we observe that some of the bulbs burn out. If we as-
sume that the lifetime of each bulb is exponentially distributed, what can we say about
the distribution of the t∗
k s?
Answer: Let X1, . . . , Xn be the lifetimes of the n light bulbs. By assumption, they are
independent and exponentially distributed with some parameter λ > 0. Then the distri-
bution of t∗
k is that of X∗
k . Furthermore, we have p(t) = λe−λt and F(t) = 1 −e−λt for t ≥0.

176
౪
3 Random variables and their distribution
By Proposition 3.7.10, the distribution density pk of X∗
k equals
pk(t) = λ
n!
(k −1)!(n −k)! (1 −e−λt)
k−1 e−λt(n−k+1) ,
t ≥0 .
For example, for t∗
1 , the time when we observe the first burnout of any of the bulbs, this
implies
p1(t) = λ n e−λtn ,
t ≥0 ,
that is, t∗
1 is Eλn-distributed.
Another case of interest is the behavior of t∗
n which is the time of the last outage of
one of the n bulbs. Its density is
pn(t) = λn(1 −e−λt)
n−1e−λt ,
t > 0 .
If Fn(t) = (1 −e−λt)n, t > 0, then F′
n(t) = pn(t). Moreover, Fn(0) = 0 and Fn(∞) = 1, which
implies that Fn is a distribution function and pn is its density. That is,
ℙ{t∗
n ≤t} = (1 −e−λt)
n ,
t > 0 .
Note that there is a more direct way to determine the distribution of t∗
n: use
ℙ{t∗
n ≤t} = ℙ{X1 ≤t, . . . , Xn ≤t}
and the independence of X1, . . . , Xn.
Summary: Let X1, . . . , Xn be independent identically distributed random variables with distribution function
F : ℝ→ℝ. If X∗
1 ≤⋅⋅⋅≤X∗
n is the sequence of the ordered values, then
ℙ{X∗
k ≤t} =
n
∑
i=k
(n
i )F(t)i (1 −F(t))
n−i ,
t ∈ℝ.
Moreover, if the Xjs are continuous with density p, then for 1 ≤k ≤n, the density pk of X∗
k equals
pk(t) =
n!
(k −1)!(n −k)! p(t) F(t)k−1(1 −F(t))
n−k ,
t ∈ℝ.
3.8 Problems
Problem 3.1. For n ≥1, let Sn be the set of permutations of order n. Suppose ℙis the
uniform distribution on Sn. That is, all permutations are equally likely. Define now a
mapping X from Sn to {1, . . . , n} by X(π) = π(n), π ∈Sn. Determine the probability distri-
bution ℙX of X. What happens if one defines X by X(π) = π(k) for some fixed k ≤n?

3.8 Problems
౪
177
Problem 3.2. Roll a fair die twice. Let ω = (ω1, ω2) be the observed values. Define two
random variables X1 and X2 by
X1(ω) = max{ω1, ω2}
and
X2(ω) = ω1 + ω2 .
Find the joint distribution of the random vector (X1, X2), as well as its marginal ones.
Argue why X1 and X2 are not independent.
Problem 3.3. The joint distribution of a random vector ⃗X = (X1, X2) is described by
X2\X1
0
1
0
1
10
2
5
1
2
5
1
10
Define another vector
⃗Y = (Y1, Y2) by Y1 := min{X1, X2} and Y2 := max{X1, X2}. Find the
probability distribution of ⃗Y = (Y1, Y2). Are Y1 and Y2 independent?
Problem 3.4. Let ⃗X = (X1, X2) be uniformly distributed on the square in ℝ2 with corner
points (0, 1), (1, 0), (0, −1), and (−1, 0). Find the marginal distributions of ⃗X.
Problem 3.5. In a lottery, six numbers are chosen out of {1, . . . , 49}. As usual in lotter-
ies, chosen numbers are not replaced. Let X1, . . . , X6 be the chosen numbers as they ap-
peared. That is, X1 is the number chosen first while X6 is the number, which appeared
last.
1.
Determine the joint distribution of the vector
⃗X = (X1, . . . , X6), as well its marginal
distributions.
2.
Argue why X1, . . . , X6 are not independent.
3.
Reordering the six chosen numbers leads to the order statistics X∗
1 < ⋅⋅⋅< X∗
6 . Find
the joint distribution of the vector (X∗
1 , . . . , X∗
6 ), as well as its marginal distribu-
tions.
Problem 3.6. A random variable X is geometrically distributed. Given natural numbers
k and n, show that
ℙ{X = k + n | X > n} = ℙ{X = k} .
Why is this property called “lack of memory property”?
Problem 3.7. A random variable is exponentially distributed. Prove
ℙ{X > s + t | X > s} = ℙ{X > t}
for all t, s ≥0. Why is this called the “nonaging property” of exponentially distributed
lifetimes?

178
౪
3 Random variables and their distribution
Problem 3.8. Two random variables X and Y are independent and geometrically dis-
tributed with parameters p and q for some 0 < p, q < 1. Evaluate ℙ{X ≤Y ≤2X}.
Problem 3.9. Suppose two independent random variables X and Y satisfy
ℙ{X = k} = ℙ{Y = k} = 1
2k ,
k = 1, 2, . . .
Find the probabilities ℙ{X ≤Y} and ℙ{X = Y}.
Problem 3.10. Choose two numbers b and c independently, the number b according to
the uniform distribution on [−1, 1] and c according to the uniform distribution on [0, 1].
Find the probability that the equation
x2 + bx + c = 0
does not possess a real solution.
Problem 3.11. Use Problem 1.38 to prove the following: If X is a random variable, then
the number of points t ∈ℝwith ℙ{X = t} > 0 is at most countably infinite.
Problem 3.12. Suppose a fair coin is labeled with “0” and “1.” Toss the coin n times. Let
X be the maximum observed value and Y the sum of the n values. Determine the joint
distribution of (X, Y). Argue that X and Y are not independent.
Problem 3.13. Suppose a random vector (X, Y) has the joint density function p defined
by
p(u, v) := {c ⋅u v
if u, v ≥0, u + v ≤1,
0
if otherwise.
(a) Find the value of the constant c so that p becomes a density function.
(b) Determine the density functions of X and Y.
(c) Evaluate ℙ{X + Y ≤1/2}.
(d) Are X and Y independent?
Problem 3.14. Gambler A has a biased coin with “heads” having probability p for some
0 < p < 1, and gambler B’s coin is biased with “heads” having probability q for some
0 < q < 1. Gamblers A and B toss their coins simultaneously. Whoever gets “heads” first
wins. If both gamblers observe “heads” at the same time, then the game ends in a draw.
Evaluate the probability that A wins and the probability that the game ends in a draw.
Problem 3.15. Randomly choose two integers x1 and x2 from 1 to 10. Let X be the mini-
mum of x1 and x2. Determine the distribution and the probability mass functions of X in
the two following cases:

3.8 Problems
౪
179
–
The number chosen first is replaced.
–
The first number is not replaced.
Evaluate in both cases ℙ{2 ≤X ≤3} and ℙ{X ≥8}.
Problem 3.16. There are four balls labeled with “0” and three balls are labeled with “2”
in an urn. Choose three balls without replacement. Let X be the sum of the values on the
three chosen balls. Find the distribution of X.
Problem 3.17. As in Example 3.7.7, choose independently n numbers uniformly dis-
tributed in {1, . . . , N}. How likely is it that the largest of the chosen n numbers equals
N? Answer this question by applying formula (3.30). Give also a direct argument for the
obtained result.
Problem 3.18. Roll a fair die 5 times. How likely is it that the fourth largest number
equals m for some m = 1, . . . , 6?

4 Operations on random variables
4.1 Mappings of random variables
This section is devoted to the following problem: let X : Ω →ℝbe a random variable
and let f : ℝ→ℝbe some function. Set Y := f (X), that is, for all ω ∈Ω we have
Y(ω) = f (X(ω)). Suppose the distribution of X is known. Then the following task arises:
Determine the distribution of Y = f(X) for a given function f : ℝ→ℝ.
For example, if f (t) = t2, and we know the distribution of X, then we ask for the proba-
bility distribution of X2. Is it possible to compute this by easy methods?
At the moment it is not clear at all whether Y = f (X) is a random variable. Only if
this is valid, the probability distribution ℙY is well defined. For arbitrary functions f ,
this need not to be true, they have to satisfy the following additional property.
Definition 4.1.1. A function f : ℝ→ℝis called measurable if for B ∈ℬ(ℝ) the preimage f −1(B) is a
Borel set as well.
Remark 4.1.2. As all previous assumption about σ-fields, random variables, Borel sets,
and so on, also this is a purely technical condition for f , which will not play an important
role later on. All functions of interest, for example, piecewise continuous, monotone,
pointwise limits of continuous functions, and so on, are measurable.
The measurability of f cannot be avoided because it is needed to prove the following
result.
Proposition 4.1.3. Let X : Ω →ℝbe a random variable. If f : ℝ→ℝis measurable, then
Y = f (X) is a random variable as well.
Proof. Take a Borel set B ∈ℬ(ℝ). Then
Y −1(B) = X−1(f −1(B)) = X−1(B′),
with B′ := f −1(B). We assumed f to be measurable, which implies B′ ∈ℬ(ℝ), and hence,
since X is a random variable, we conclude Y −1(B) = X−1(B′) ∈𝒜. The Borel set B was
arbitrary, thus, as asserted, Y is a random variable.
So let Y = f (X) for some measurable function f : ℝ→ℝand some random vari-
able X. Unfortunately, there does not exist a general method for the description of ℙY
in terms of ℙX. Only for some special functions f , for example, for linear functions or
for f being strictly monotone and differentiable, there exist general rules for the com-
putation of ℙY. Nevertheless, quite often we are able to determine ℙY directly. Mostly
the following two approaches turn out to be helpful.
https://doi.org/10.1515/9783111325064-004

4.1 Mappings of random variables
౪
181
If X is discrete with values in D := {x1, x2, . . . }, then Y = f (X) maps the sample space
Ω into f (D) = {f (x1), f (x2), . . . }. Problems arise if f is not one-to-one. In this case one has
to combine those xjs that are mapped onto the same element in f (D). For example, if X
is uniformly distributed on D = {−2, −1, 0, 1, 2} and f (x) = x2, then Y = X2 has values in
f (D) = {0, 1, 4}. Combining −1 and 1, as well as −2 and 2, leads to
ℙ{Y = 0} = ℙ{X = 0} = 1
5 ,
ℙ{Y = 1} = ℙ{X = −1} + ℙ{X = 1} = 2
5 ,
ℙ{Y = 4} = ℙ{X = −2} + ℙ{X = 2} = 2
5 .
The case of one-to-one functions f is easier to handle because then
ℙ{Y = f (xj)} = ℙ{X = xj} ,
j = 1, 2, . . . ,
and the distribution of Y can be directly computed from that of X.
For continuous X, one tries to determine the distribution function FY of Y. Recall
that this was defined as
FY(t) = ℙ{Y ≤t} = ℙ{f (X) ≤t} .
If we are able to compute FY, then we are almost done because then we get the distribu-
tion density q of Y as the derivative of FY.
For instance, if the continuous function f is increasing, one gets FY easily by
FY(t) = ℙ{X ≤f −1(t)} = FX(f −1(t))
with the inverse function f −1 (cf. Problem 4.16).
The following examples demonstrate how we compute the distribution of f (X) in
some special cases.
Example 4.1.4. Assume the random variable X is 𝒩(0, 1)-distributed. Which distribu-
tion does Y := X2 possess?
Answer: Of course, FY(t) = ℙ{Y ≤t} = 0 when t ≤0. Consequently, it suffices to
determine FY(t) for t > 0. Then
FY(t) = ℙ{X2 ≤t} = ℙ{−√t ≤X ≤√t} =
1
√2π
√t
∫
−√t
e−s2/2 ds
=
2
√2π
√t
∫
0
e−s2/2 ds = h(√t) ,
where

182
౪
4 Operations on random variables
h(u) := √2
√π
u
∫
0
e−s2/2 ds ,
u ≥0 .
Differentiating FY with respect to t, the chain rule and the fundamental theorem of Cal-
culus lead to
q(t) = F′
Y(t) = d
dt (√t) h′(√t) = t−1/2
2
⋅√2
√π e−t/2
=
1
21/2Γ(1/2) t
1
2 −1 e−t/2 ,
t > 0 .
Hereby, in the last step, we used Γ(1/2) = √π. Consequently, Y possesses the density
function
q(t) = {0
if t ≤0,
1
21/2Γ(1/2) t−1/2e−t/2
if t > 0 .
But this is the density of a Γ2, 1
2 -distribution. Therefore, we obtained the following result,
which we, because of its importance, state as a separate proposition.
Proposition 4.1.5. If X is 𝒩(0, 1)-distributed, then X2 is Γ2, 1
2 -distributed or, equivalently,
distributed according to χ2
1.
Example 4.1.6. Let U be uniformly distributed on [0, 1]. Which distribution does the
random variable Y = 1/U possess?
Answer: Again we determine FY. From ℙ{X ∈(0, 1]} = 1, we derive ℙ{Y ≥1} = 1,
thus, FY(t) = 0 if t < 1. Therefore, we only have to regard numbers t ≥1. Here we have
FY(t) = ℙ{ 1
U ≤t} = ℙ{U ≥1
t } = 1 −1
t .
Hence, the density function q of Y is given by
q(t) = F′
Y(t) = {0
if t < 1,
1
t2
if t ≥1.
Example 4.1.7 (Random walk on ℤ). A particle is located at the point 0 of ℤ. In the first
step, it moves either to −1 or to +1. In the second step, it jumps, independently of the
first move, again to the left or to the right. Thus, after two steps it is located either at
−2, 0, or 2. Hereby we assume that p is the probability for jumps to the right, hence
1 −p for jumps to the left. This procedure is repeated arbitrarily often. Let Sn be the
position of the particle after n jumps or, equivalently, after n steps.1 The (random) se-
1 The value of Sn can also be viewed as the loss or win after n games, where p is the probability to win
one dollar in a single game, while 1 −p is the probability to lose one dollar.

4.1 Mappings of random variables
౪
183
quence (Sn)n≥0 is called a (next-neighbor) random walk on ℤ, where by the construction
ℙ{S0 = 0} = 1. See Figure 4.1 for a path of a random walk. Note that it is random, thus,
very likely it will look completely different in another experiment.
Figure 4.1: The (joined) points (n, Sn), n = 0, . . . , 400, of a symmetric random walk Sn.
After n steps, the possible positions of the particle are in
Dn = {−n, −n + 2, . . . , n −2, n} .
Note that an integer k belongs to Dn if and only if |k| ≤n and, furthermore, n + k (or
equivalently, n −k) is even.
Thus, Sn is a random variable with values in Dn. Which distribution does Sn possess?
To answer this question define
Yn := 1
2 (Sn + n) .
The random variable Yn attains values in {0, 1, . . . , n} and, moreover, Yn = m if the posi-
tion of the particle after n steps is 2m −n, that is, if it jumped m times to the right and
n−m times to the left. To see this, take m = 0, hence Sn = −n, which can only be achieved
if all jumps were to the left. If m = 1, then Sn = −n + 2, that is, there were n −1 jumps to
the left and 1 to the right. The same argument applies for all m ≤n.
This observation tells us that Yn is Bn,p-distributed, that is,
ℙ{Yn = m} = (n
m)pm(1 −p)n−m ,
m = 0, . . . , n .

184
౪
4 Operations on random variables
Since Yn = 1
2 (Sn + n), if k ∈Dn, then it follows that
ℙ{Sn = k} = ℙ{Yn = 1
2 (k + n)} = ( n
n+k
2
) p(n+k)/2 (1 −p)(n−k)/2 .
(4.1)
For even n, we have 0 ∈Dn, thus one may ask for the probability of Sn = 0, that is,
for the probability that the particle returns to its starting point after n steps. Applying
eq. (4.1) with k = 0 gives for even n that
ℙ{Sn = 0} = (n
n
2
)pn/2 (1 −p)n/2 .
Hence, if p = 1/2 (in this case the walk is said to be symmetric), then for even n we obtain
ℙ{Sn = 0} = (n
n
2
) 2−n =
n!
((n/2)!)2 2−n .
An application of Stirling’s formula (1.54) implies
lim
n→∞
n even
n1/2 ℙ{Sn = 0} = lim
n→∞
n even
n1/2
√2πn (n/e)n
[√πn (n/2e)n/2]2 2−n = √2
π ,
that is, if n →∞, then for even n it follows that ℙ{Sn = 0} ∼√2
π n−1/2. Another way to
formulate this is
ℙ{S2n = 0} ∼
1
√πn .
Example 4.1.8. Suppose X is B−
n,p-distributed, that is,
ℙ{X = k} = (k −1
k −n) pn(1 −p)k−n ,
k = n, n + 1, . . .
Let Y = X −n. Which probability distribution does Y possess?
Answer: An easy transformation (see formula (1.35)) leads to
ℙ{Y = k} = ℙ{X = k + n} = (n + k −1
k
)pn (1 −p)k = (−n
k )pn (p −1)k
(4.2)
for all k = 0, 1, . . .
Additional question: Which random experiment does Y describe?
Answer: We perform a series of random trials where each time we may obtain either
failure or success. Hereby, the success probability is p ∈(0, 1). Then the event {Y = k}
occurs if and only if we observe the nth success in trial k + n.
We conclude this section with the investigation of the following problem. Suppose
X1, . . . , Xn are independent random variables. Given n measurable functions f1, . . . , fn
from ℝto ℝ, we define “new” random variables Y1, . . . , Yn by

4.2 Linear transformations
౪
185
Yi := fi(Xi) ,
1 ≤i ≤n .
It is intuitively clear that then Y1, . . . , Yn are also independent; the values of Yi only de-
pend on those of Xi, thus the independence should be preserved. For example, if X1 and
X2 are independent, then this should also be valid for X2
1 and 2X2.
The next result shows that this is indeed true.
Proposition 4.1.9. Let X1, . . . , Xn be independent random variables and let (fi)n
i=1 be mea-
surable functions from ℝto ℝ. Then f1(X1), . . . , fn(Xn) are independent as well.
Proof. Choose arbitrary Borel sets B1, . . . , Bn in ℝand set Ai := f −1
i (Bi), 1 ≤i ≤n. With
this notation, an ω ∈Ω satisfies fi(Xi(ω)) ∈Bi if and only if Xi(ω) ∈Ai. Hence, an appli-
cation of the independence of Xi (use eq. (3.16) with the Xi’s and the Ai’s) leads to
ℙ{f1(X1) ∈B1, . . . , fn(Xn) ∈Bn} = ℙ{X1 ∈A1, . . . , Xn ∈An}
= ℙ{X1 ∈A1} ⋅⋅⋅ℙ{Xn ∈An}
= ℙ{f1(X1) ∈B1} ⋅⋅⋅ℙ{fn(Xn) ∈Bn} .
The Bis were chosen arbitrarily, thus the random variables f1(X1), . . . , fn(Xn) are in-
dependent as well.
Remark 4.1.10. Without proof we still mention that the independence of random vari-
ables is preserved whenever they are put together into disjoint groups. For example, if
X1, . . . , Xn are independent, then so are f (X1, . . . , Xk) and g(Xk+1, . . . , Xn) for suitable func-
tions f and g. Assume we roll a die five times and let X1, . . . , X5 be the results. Then these
random variables are independent, but so are the two random variables max{X1, X2}
and X3 + X4 + X5, or the three X1, max{X2, X3}, and min{X4, X5}.
4.2 Linear transformations
Let a and b real numbers with a
̸= 0. Given a random variable Y = aX+b, that is, Y arises
from X by a linear transformation. We ask now for the probability distribution of Y.
Proposition 4.2.1. Define Y = aX + b with a, b ∈ℝand a
̸= 0.
(a) Depending on whether a > 0 or a < 0,
FY(t) = FX(t −b
a
)
or
FY(t) = 1 −ℙ{X < t −b
a
} .
If a < 0 and FX is continuous at t−b
a , then
FY(t) = 1 −FX(t −b
a
) .
(b) Let X be a continuous random variable with density p. Then Y is also continuous with
density q given by

186
౪
4 Operations on random variables
q(t) = 1
|a| p(t −b
a
) ,
t ∈ℝ.
(4.3)
Proof. Let us first treat the case a > 0. Then we get
FY(t) = ℙ{aX + b ≤t} = ℙ{X ≤t −b
a
} = FX(t −b
a
),
as asserted.
In the case a < 0, we conclude as follows:
FY(t) = ℙ{aX + b ≤t} = ℙ{X ≥t −b
a
} = 1 −ℙ{X < t −b
a
} .
If FX is continuous at t−b
a , then ℙ{X = t−b
a } = 0, hence
1 −ℙ{X < t −b
a
} = 1 −ℙ{X ≤t −b
a
} = 1 −FX(t −b
a
) ,
completing the proof of part (a).
Suppose now that p is a density function of X, that is,
FX(t) = ℙ{X ≤t} =
t
∫
−∞
p(x)dx ,
t ∈ℝ.
If a > 0, by part (a) and after the change of variables x = y−b
a , we get
FY(t) = FX(t −b
a
) =
t−b
a
∫
−∞
p(x)dx =
t
∫
−∞
1
a p(y −b
a
)dy =
t
∫
−∞
q(y) dy .
Thus, q is a density of Y.
If a < 0, the same change of variables2 leads to
FY(t) = 1 −FX(t −b
a
) =
∞
∫
t−b
a
p(x)dx = −
t
∫
−∞
1
a p(y −b
a
)dy
=
t
∫
−∞
1
−a p(y −b
a
)dy =
t
∫
−∞
1
|a| p(y −b
a
)dy =
t
∫
−∞
q(y) dy .
This being true for all t ∈ℝcompletes the proof.
2 Observe that now a < 0, hence the order of integration changes and a minus sign appears.

4.2 Linear transformations
౪
187
Example 4.2.2. Let X be 𝒩(0, 1)-distributed. Given a
̸= 0 and μ ∈ℝ, we ask for the
distribution of Y = aX + μ.
Answer: The random variable X is known to be continuous with density
p(t) =
1
√2π
e−t2/2 .
We apply eq. (4.3) with b = μ to deduce that the density q of Y equals
q(t) = 1
|a| p(t −μ
|a| ) =
1
√2π |a|
e−(t−μ)2/2a2
.
That is, the random variable Y is 𝒩(μ, |a|2)-distributed. In particular, if σ > 0 and μ ∈ℝ,
then σX + μ is distributed according to 𝒩(μ, σ2).
Additional question: Suppose Y is 𝒩(μ, σ2)-distributed. Which probability distribu-
tion does X := Y−μ
σ
possess?
Answer: Formula (4.3) immediately implies that X has a standard normal distribu-
tion.
Because of the importance of the previous observation, we formulate it as proposi-
tion.
Proposition 4.2.3. Suppose μ ∈ℝand σ > 0. Then the following are equivalent:
X is 𝒩(0, 1)-distributed
⇐⇒
σX + μ is distributed according to 𝒩(μ, σ2).
Corollary 4.2.4. Let Φ be the Gaussian Φ-function introduced in eq. (1.70). For each inter-
val [a, b],
𝒩(μ, σ2)([a, b]) = Φ(b −μ
σ
) −Φ(a −μ
σ
) .
Proof. This is a direct consequence of Proposition 4.2.3. Indeed, if X has a standard nor-
mal distribution, then
𝒩(μ, σ2)([a, b]) = ℙ{a ≤σX + μ ≤b} = ℙ{a −μ
σ
≤X ≤b −μ
σ
}
= Φ(b −μ
σ
) −Φ(a −μ
σ
),
as asserted.
Let X be an 𝒩(μ, σ2)-distributed random variable. The next result shows that X with
high probability (more than 99.7 %) attains values in [μ−3 σ, μ+3 σ]. Therefore, in most
cases, one may assume that X maps into [μ −3 σ, μ + 3 σ]. This observation is usually
called “Three Sigma Rule”.

188
౪
4 Operations on random variables
Corollary 4.2.5 (Three Sigma Rule). If X is distributed according to 𝒩(μ, σ2), then
ℙ{|X −μ| ≤2 σ} ≥0.954
and
ℙ{|X −μ| ≤3 σ} ≥0.997 .
Proof. By virtue of Corollary 4.2.4, for each c > 0,
ℙ{|X −μ| ≤c σ} = Φ(c) −Φ(−c) ,
hence the desired estimates follow from
Φ(2) −Φ(−2) = 2Φ(2) −1 > 0.9545
and
Φ(3) −Φ(−3) = 2Φ(3) −1 > 0.9973 .
Example 4.2.6. Let U be uniformly distributed on [0, 1]. What is the probability distri-
bution of aU + b if a
̸= 0 and b ∈ℝ?
Answer: The distribution density p of U is given by p(t) = 1 if 0 ≤t ≤1 and p(t) = 0
otherwise. Therefore, the density q of aU + b equals
q(t) = {
1
|a|
if 0 ≤t−b
a ≤1,
0
otherwise .
Assume first a > 0. Then q(t) = 1/a if and only if b ≤t ≤a+b and q(t) = 0 otherwise.
Consequently, aU + b is uniformly distributed on [b, a + b].
If, in contrast, a < 0, then q(t) = 1/|a| if and only if a + b ≤t ≤b and q(t) = 0
otherwise. Hence, now aU + b is uniformly distributed on [a + b, b].
It is easy to see that the reversed implications are also true. That is, we have
U uniformly distributed on [0, 1]
⇔
aU + b uniformly distributed on {[b, a + b]
if a > 0,
[a + b, b]
if a < 0.
Corollary 4.2.7. A random variable U is uniformly distributed on [0, 1] if and only if
1 −U is such. In other words, for a uniformly distributed U on [0, 1] it follows that
U
d= 1 −U.
Example 4.2.8. Suppose a random variable X is Γα,β-distributed for some α, β > 0 and
let a > 0. Which distribution does aX possess?
Answer: The distribution density p of X satisfies p(t) = 0 if t ≤0 and, if t > 0, then
p(t) =
1
αβ Γ(β) tβ−1 e−t/α .
An application of eq. (4.3) implies that the density q of aX is given by q(t) = 0 if t ≤0
and, if t > 0, then

4.3 Coin tossing versus uniform distribution
౪
189
q(t) = 1
a p( t
a) =
1
a αβ Γ(β)( t
a)
β−1
e−t/aα =
1
(aα)β Γ(β)tβ−1 e−t/aα .
Thus, aX is Γaα,β-distributed.
In particular, we have that X is Γ1,β-distributed if and only if for some (each) α > 0
it follows that αX is Γα,β-distributed.
In the case of the exponential distribution Eλ = Γ1/λ,1, the previous result implies the
following: if a > 0, then a random variable X is Eλ-distributed if and only if aX possesses
an Eλ/a distribution.
4.3 Coin tossing versus uniform distribution
4.3.1 Binary fractions
We start this section with the following statement: each real number x ∈[0, 1) may be
represented as binary fraction x = 0.x1x2 . . . , where xk ∈{0, 1}. This is a shortened way
to express that
x =
∞
∑
k=1
xk
2k .
The representation of x as binary fraction is in general not unique. For example,
1
2 = 0.10000 . . . ,
but also
1
2 = 0.01111 . . .
Check this by computing the infinite sums in both cases.
It is not difficult to prove that two different representations admit exactly those
x ∈[0, 1) which may be written as x = k/2n for some n ∈ℕand some k = 1, 3, 5, . . . , 2n−1.
Those numbers are usually called dyadic rational numbers.
To make the binary representation unique, we declare the following:
Convention 4.1. If a number x ∈[0, 1) admits the representations
x = 0.x1 . . . xn−11000 . . .
and
x = 0.x1 . . . xn−10111 . . . ,
then we always choose the former one. In other words, there do not exist numbers
x ∈[0, 1) whose binary representation consists only of 1s from a certain point onward.
How do we get the binary fraction for a given x ∈[0, 1)?
The procedure is not difficult. First, one checks whether x <
1
2 or x ≥
1
2. In the
former case, one takes x1 = 0 and in the latter x1 = 1.
With this choice, it follows that 0 ≤x −x1
2 < 1
2. In the next step, one asks whether
x −x1
2 < 1
4 or x −x1
2 ≥1
4. Depending on this, one chooses either x2 = 0 or x2 = 1. This

190
౪
4 Operations on random variables
choice implies 0 ≤x −x1
2 −x2
22 < 1
4, and if this difference belongs either to [0, 1
8) or [ 1
8, 1
4),
then x3 = 0 or x3 = 1, respectively. Proceeding further in this way leads to the binary
fraction representing x.
After this heuristic method, we now present a mathematically more exact way. To
this end, for each n ≥1, we divide the interval [0, 1) into 2n intervals of length 2−n.
We start with n = 1 and divide [0, 1) into two intervals,
I0 := [0 , 1
2 )
and
I1 := [1
2 , 1) .
In the second step, we divide each of the two intervals I0 and I1 further into two parts of
equal length. In this way, we obtain the four intervals
I00 := [0 , 1
4 ) ,
I01 := [ 1
4, 1
2 ) ,
I10 := [ 1
2 , 3
4 ),
and
I11 := [ 3
4, 1 ) .
Observe that the left end point of Ia1,a2 equals a1/2 + a2/4, that is,
Ia1a2 = [
2
∑
j=1
aj
2j ,
2
∑
j=1
aj
2j + 1
22 ),
a1, a2 ∈{0, 1} .
It is clear now how to proceed. Given n ≥1 and numbers a1, . . . , an ∈{0, 1}, set
Ia1...an = [
n
∑
j=1
aj
2j ,
n
∑
j=1
aj
2j + 1
2n ).
(4.4)
In this way, we obtain 2n disjoint intervals of length 2−n where the left corner points
are 0.a1a2 . . . an (see Figure 4.2 for the first dyadic intervals).
Figure 4.2: The first dyadic intervals of [0, 1).
The following lemma makes the above heuristic method more precise.
Lemma 4.3.1. For all a1, . . . , an ∈{0, 1}, the intervals in (4.4) are characterized by
Ia1...an = {x ∈[0, 1) : x = 0.a1a2 . . . an . . . } .
Verbally, a number in [0, 1) belongs to Ia1⋅⋅⋅an if and only if its first n digits in the binary
fraction are a1, . . . , an.

4.3 Coin tossing versus uniform distribution
౪
191
Proof. Assume first x ∈Ia1...an. If a := 0.a1 ⋅⋅⋅an denotes the left end point of Ia1...an, by
definition a ≤x < a+ 1/2n or, equivalently, 0 ≤x−a < 1/2n. Therefore, the binary fraction
of x −a is of the form 0.00 . . . 0bn+1 . . . with certain numbers bn+1, bn+2, . . . ∈{0, 1}. This
yields
x = a + (x −a) = 0.a1 . . . anbn+1 . . .
Thus, as asserted, the first n digits in the representation of x are a1, . . . , an.
Conversely, if x can be written as x = 0.x1x2 . . . with x1 = a1, . . . , xn = an, then a ≤x
where, as above, a denotes the left end point of Ia1...an. Moreover, by Convention 4.1, at
least one of the xks, k > n, has to be zero. Consequently,
x −a =
∞
∑
k=n+1
xk
2k <
∞
∑
k=n+1
1
2k = 1
2n ,
that is, we have a ≤x < a + 1
2n or, equivalently, x ∈Ia1...an as asserted.
A direct consequence of Lemma 4.3.1 is as follows.
Corollary 4.3.2. For each n ≥1, the 2n sets Ia1...an form a disjoint partition of [0, 1), that is,
⋃
a1,...,an∈{0,1}
Ia1...an = [0, 1)
and
Ia1...an ∩Ia′
1...a′
n = 0
provided that (a1, . . . , an)
̸= (a′
1, . . . , a′
n). Furthermore,
{x ∈[0, 1) : xk = 0} =
⋃
a1,...,ak−1∈{0,1}
Ia1...ak−10 .
4.3.2 Binary fractions of random numbers
We saw above each number x ∈[0, 1) admits a representation x = 0.x1x2 . . . with certain
xk ∈{0, 1}. What does happen if we choose a number x randomly, say according to the
uniform distribution on [0, 1]? Then the xks in the binary fraction are also random, with
values in {0, 1}. How are they distributed?
The mathematical formulation of this question is as follows: let U : Ω →ℝbe a
random variable uniformly distributed on [0, 1]. If ω ∈Ω, write3
U(ω) = 0.X1(ω)X2(ω) . . . =
∞
∑
k=1
Xk(ω)
2k
.
(4.5)
In this way, we obtain infinitely many random variables Xk : Ω →{0, 1}.
3 Note that ℙ{U ∈[0, 1)} = 1. Thus, without losing generality, we may assume U(ω) ∈[0, 1).

192
౪
4 Operations on random variables
Which distribution do these random variables possess? Answer gives the next
proposition.
Proposition 4.3.3. If k ∈ℕ, then
ℙ{Xk = 0} = ℙ{Xk = 1} = 1
2 .
(4.6)
Furthermore, given n ≥1, the random variables X1, . . . , Xn are independent.
Proof. By assumption, ℙU is the uniform distribution on [0, 1]. Thus, the finite additivity
of ℙU, Corollary 4.3.2 and eq. (1.46) imply
ℙ{Xk = 0} = ℙU(
⋃
a1,...,ak−1∈{0,1}
Ia1...ak−10)
=
∑
a1,...,ak−1∈{0,1}
ℙU(Ia1...ak−10) =
∑
a1,...,ak−1∈{0,1}
1
2k = 2k−1
2k
= 1
2 .
Since Xk attains only two different values, ℙ{Xk = 1} = 1/2 as well, proving the first part.
We want to verify that for all n ≥1 the random variables X1, . . . , Xn are indepen-
dent. Equivalently, according to Proposition 3.6.18, the following has to be proven: if
a1, . . . , an ∈{0, 1}, then
ℙ{X1 = a1, . . . , Xn = an} = ℙ{X1 = a1} ⋅⋅⋅ℙ{Xn = an} .
(4.7)
By eq. (4.6), the right-hand side of eq. (4.7) equals
ℙ{X1 = a1} ⋅⋅⋅ℙ{Xn = an} = 1
2 ⋅⋅⋅1
2
⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟
n
= 1
2n .
To compute the left-hand side of eq. (4.7), note that Lemma 4.3.1 implies that we have
X1 = a1 up to Xn = an if and only if U attains a value in Ia1...an. The intervals Ia1...an are of
length 2−n, hence by eq. (1.46) (recall that ℙU is the uniform distribution on [0, 1]),
ℙ{X1 = a1, . . . , Xn = an} = ℙ{U ∈Ia1...an} = ℙU(Ia1...an) = 1
2n .
Thus, for all a1, . . . , an ∈{0, 1}, eq. (4.7) is valid, and, as asserted, the random variables
X1, . . . , Xn are independent.
To formulate the previous result in a different way, let us introduce the following
notation.
Definition 4.3.4. An infinite sequence X1, X2, . . . of random variables is said to be independent provided
that any finite collection of the Xks is independent.

4.3 Coin tossing versus uniform distribution
౪
193
Remark 4.3.5. Since any subcollection of independent random variables is independent
as well, the independence of X1, X2, . . . is equivalent to the following. For all n ≥1, the
random variables X1, . . . , Xn are independent, that is, for all n ≥1 and all Borel sets
B1, . . . , Bn, it follows that
ℙ{X1 ∈B1, . . . , Xn ∈Bn} = ℙ{X1 ∈B1} ⋅⋅⋅ℙ{Xn ∈Bn} .
Remark 4.3.6. In view of Definition 4.3.4, the basic observation in Example 3.6.19 may
now be formulated in the following way. If we toss a (maybe biased) coin, labeled with
“0” and “1,” infinitely often and let X1, X2, . . . be the results of the single tosses, then
this infinite sequence of random variables is independent with ℙ{Xk = 0} = 1 −p and
ℙ{Xk = 1} = p. In particular, for a fair coin, the Xks possess the following properties:
1.
If k ∈ℕ, then ℙ{Xk = 0} = ℙ{Xk = 1} = 1/2.
2.
X1, X2, . . . is an infinite sequence of independent random variables.
This observation leads us to the following definition.
Definition 4.3.7. An infinite sequence X1, X2, . . . of independent random variables with values in {0, 1}
satisfying
ℙ{Xk = 0} = ℙ{Xk = 1} = 1/2 ,
k = 1, 2, . . . ,
is said to be a model for tossing a fair coin infinitely often.
Consequently, Proposition 4.3.3 asserts that the random variables X1, X2, . . . defined by
eq. (4.5) serve as a model for tossing a fair coin infinitely often.
Example 4.3.8. Suppose a randomly chosen number in [0, 1) is x = 0.1657432763. Its bi-
nary expansion is 0.0010101001101110001001101011111100111101100010 . . . Thus, translat-
ing this into a result of tossing a coin, the first observations are 0, 0, 1, 0, 1, . . . Of course,
since x is only approximately chosen uniformly, also only the first finitely many digits
of the binary expansion simulate the tossing of a fair coin.
Summary: Let U be some random variable distributed according to the uniform distribution on [0, 1]. Rep-
resent the values of U as binary fraction 0.X1X2 . . . where the Xjs attain values in {0, 1}. Then the random
variables Xjs are independent with ℙ{Xj = 0} = ℙ{Xj = 1} = 1
2. Thus, in order to generate an infinite inde-
pendent sequence of equiprobable zeroes and ones, choose a number uniformly distributed on [0, 1] and
expand it as a binary fraction.
4.3.3 Random numbers generated by coin tossing
We saw in Proposition 4.3.3 that choosing a random number in [0, 1] leads to a model
for tossing a fair coin infinitely often. Our aim is now to investigate the opposite ques-
tion. That is, we are given an infinite random sequence of zeroes and ones and want to

194
౪
4 Operations on random variables
construct a uniformly distributed number in [0, 1]. The precise mathematical question
is as follows: suppose we are given an infinite sequence (Xk)k≥1 of independent random
variables with
ℙ{Xk = 0} = ℙ{Xk = 1} = 1/2 ,
k = 1, 2, . . .
(4.8)
Is it possible to construct from these Xks a uniformly distributed U? The next propo-
sition answers this question to the affirmative.
Proposition 4.3.9. Let X1, X2, . . . be an arbitrary sequence of independent random vari-
ables satisfying eq. (4.8). If U is defined by
U(ω) :=
∞
∑
k=1
Xk(ω)
2k
,
ω ∈Ω ,
then this random variable is uniformly distributed on [0, 1].
Proof. In order to prove that U is uniformly distributed on [0, 1], we have to show that,
if t ∈[0, 1), then
ℙ{U ≤t} = t .
(4.9)
We start the proof of eq. (4.9) with the following observation: suppose the binary
fraction of some t ∈[0, 1) is 0.t1t2 . . . for certain ti ∈{0, 1}. If s = 0.s1s2 . . . , then s < t if
and only if there is an n ∈ℕso that the following is satisfied:4
s1 = t1, . . . , sn−1 = tn−1 ,
sn = 0,
and
tn = 1 .
Fix t ∈[0, 1) for a moment and set
An(t) := {s ∈[0, 1) : s1 = t1, . . . , sn−1 = tn−1, sn < tn} .
Of course, An(t) ∩Am(t) = 0 whenever n
̸= m and, moreover, An(t)
̸= 0 if and only if
tn = 1. Furthermore, by the previous remark
[0, t) =
∞
⋃
n=1
An(t) =
⋃
{n:tn=1}
An(t) .
Finally, if An(t)
̸= 0, that is, if tn = 1, then
ℙ{U ∈An(t)} = ℙ{X1 = t1, . . . , Xn−1 = tn−1, Xn = 0}
= ℙ{X1 = t1} ⋅⋅⋅ℙ{Xn−1 = tn−1} ⋅ℙ{Xn = 0} = 1
2n .
4 In the case n = 1, this says s1 = 0 and t1 = 1.

4.3 Coin tossing versus uniform distribution
౪
195
In the last step, we used both properties of the Xks, that is, they are independent and
satisfy ℙ{Xk = 0} = ℙ{X = 1} = 1/2.
Summing up, we get
ℙ{U < t} = ℙ{U ∈
⋃
{n:tn=1}
An(t)} =
∑
{n:tn=1}
ℙ{U ∈An(t)}
=
∑
{n:tn=1}
1
2n =
∞
∑
n=1
tn
2n = t .
This “almost” proves eq. (4.9). It remains to show that ℙ{U < t} = ℙ{U ≤t} or, equiva-
lently, ℙ{U = t} = 0. To verify this, we use the continuity of ℙfrom above. Then
ℙ{U = t} = ℙ{X1 = t1, X2 = t2, . . .}
= lim
n→∞ℙ{X1 = t1, . . . , Xn = tn} = lim
n→∞
1
2n = 0 .
Consequently, eq. (4.9) holds for all t ∈[0, 1) and, as asserted, U is uniformly distributed
on [0, 1].
Remark 4.3.10. Another possibility to write U is as binary fraction
U(ω) = 0.X1(ω)X2(ω) . . . ,
ω ∈Ω .
Consequently, in order to construct a random number u in [0, 1] one may proceed as
follows: toss a fair coin with “0” and “1” infinitely often and take the obtained sequence
as binary fraction of u. The u obtained in this way is uniformly distributed on [0, 1].
Of course, in practice one tosses a coin not infinitely often. One stops the procedure
after N trials for some “large” N. In this way, one gets a number u, which is “almost”
uniformly distributed on [0, 1].
Example 4.3.11. Suppose tossing a fair coin led to the sequence 0, 1, 1, 0, 0, 1, 0, 1. Then
the generated number u ∈[0, 1] equals u = 0.39453125. In the same way, the sequence
1, 1, 1, 0, 1, 1, 0, 1 when tossing leads to 0.92578125 as a randomly chosen number in [0, 1].
Then how does one construct n independent numbers u1, . . . , un, all uniformly dis-
tributed on [0, 1]? The answer is quite obvious. Take n coins and toss them. As functions
of independent observations the generated u1, . . . , un are independent as well and, by
construction, each of these numbers is uniformly distributed on [0, 1]. Another way is to
toss the same coin n times “infinitely often,” thus getting n infinite sequences of zeroes
and ones.
Summary: If X1, X2, . . . is an arbitrary sequence of independent random variables such that ℙ{Xj = 0} =
ℙ{Xj = 1} =
1
2, then U = ∑∞
k=1
Xk
2k = 0.X1X2 . . . is uniformly distributed on [0, 1]. Thus, in order to obtain
a number u uniformly distributed on [0, 1], toss a fair coin “infinitely” often and define u as binary fraction
according to the observed sequence of zeroes and ones.

196
౪
4 Operations on random variables
4.4 Simulation of random variables
Proposition 4.3.9 provides us with a technique to simulate a uniformly distributed ran-
dom variable U by tossing a fair coin. The aim of this section is to find a suitable function
f : [0, 1] →ℝ, so that the transformed random variable X = f (U) possesses a given prob-
ability distribution.
Remark 4.4.1. Typical questions of this kind are as follows:
–
Find a function f so that X = f (U) is standard normally distributed.
–
Does there exist a function g : [0, 1] →ℝfor which g(U) is Bn,p-distributed?
Suppose for a moment we already found such functions f and g. According to Re-
mark 4.3.10, we construct independent numbers u1, . . . , un, uniformly distributed on
[0, 1], and set xi = f (ui) and yi = g(ui). In this way, we get either n standard normally
distributed numbers x1, . . . , xn or n binomial distributed numbers y1, . . . , yn. Moreover,
by Proposition 4.1.9, these numbers are independent. In this way, we may simulate in-
dependent random numbers possessing a given probability distribution.
We start with simulating discrete random variables. Thus suppose we are given real
numbers x1, x2, . . . and pk ≥0 with ∑∞
k=1 pk = 1, and we look for a random variable
X = f (U) such that
ℙ{X = xk} = pk ,
k = 1, 2, . . .
One possible way to find such a function f is as follows: divide [0, 1) into disjoint intervals
I1, I2, . . . of length |Ik| = pk where k = 1, 2, . . . Since ∑∞
k=1 pk = 1, such intervals exist. For
example, take I1 = [0, p1) and
Ik = [
k−1
∑
i=1
pi ,
k
∑
i=1
pi) ,
k = 2, 3, . . .
With these intervals Ik, we define f : [0, 1] →ℝby
f (x) := xk
if x ∈Ik ,
(4.10)
or, equivalently,
f (x) =
∞
∑
k=1
xk 1Ik(x) .
(4.11)
Then the following is true.
Proposition 4.4.2. Let U be uniformly distributed on [0, 1], and set X = f (U) with f de-
fined by eq. (4.10) or eq. (4.11). Then
ℙ{X = xk} = pk ,
k = 1, 2, . . .

4.4 Simulation of random variables
౪
197
Proof. Using that U is uniformly distributed on [0, 1], this is an easy consequence of
eq. (1.46) in view of
ℙ{X = xk} = ℙ{f (U) = xk} = ℙ{U ∈Ik} = |Ik| = pk .
Remark 4.4.3. Note that the concrete shape of the intervals5 Ik is not important at all.
They only have to satisfy |Ik| = pk for all k = 1, 2, . . . Moreover, these intervals need
not necessarily be disjoint; a “small” overlap does not influence the assertion. Indeed,
it suffices that ℙ{U ∈Ik ∩Il} = 0 whenever k
̸= l. For example, if always |Ik ∩Il| < ∞,
k
̸= l, then the construction works as well. In particular, we may choose also I1 = [0, p1]
and Ik = [∑k−1
i=1 pi , ∑k
i=1 pi] if k ≥2.
Example 4.4.4. We want to simulate a random variable X, which is uniformly dis-
tributed on {x1, . . . , xN}. How to proceed?
Answer: Divide the interval [0, 1) into N intervals I1, . . . , IN of length 1
N . For exam-
ple, choose Ik := [ k−1
N , k
N ), k = 1, . . . , N. If f = ∑N
k=1 xk 1Ik, then X = f (U) is uniformly
distributed on {x1, . . . , xN}.
Example 4.4.5. Suppose we want to simulate a number k
∈
ℕ0, which is Poisλ-
distributed. Set
Ik := [
k−1
∑
j=0
λj
j! e−λ,
k
∑
j=0
λj
j! e−λ) ,
k = 0, 1, . . . ,
where the left-hand sum is supposed to be zero if k = 0. Choose randomly a number
u ∈[0, 1] and take the k with u ∈Ik. Then k is the number we are interested in.
Example 4.4.6. Finally, let us simulate Bn,p-distributed random numbers. One possible
way is to divide [0, 1) into n + 1 disjoint intervals as follows:
Ik = [
k−1
∑
j=0
(n
j )pj(1 −p)n−j,
k
∑
j=0
(n
j )pj(1 −p)n−j) ,
k = 0, . . . , n .
If k = 0, the left-hand sum is taken as zero, that is, I0 = [0, (1 −p)n). Next choose a
random number u uniformly distributed on [0, 1]. For example, use the technique pre-
sented in Remark 4.3.10. If this u ∈Ik, then k ∈{0, . . . , n} is the desired Bn,p-distributed
integer.
For instance, if p = 1/2 and n = 4, the five intervals are
I0 = [0, 1
16),
I1 = [ 1
16, 5
16),
I2 = [ 5
16, 11
16),
I3 = [ 11
16, 15
16),
I4 = [15
16, 1).
5 They do not even need to be intervals.

198
౪
4 Operations on random variables
After fixing the intervals, let us sufficiently often toss a fair coin labeled with “0” and
“1.” Say we observed the sequence 0, 1, 1, 0, 1, 0. Since the dyadic number 0.011010 equals
u = 0.40625 in decimal representation, one notes that u ∈I2. Thus, the randomly chosen
number is k = 2. It is distributed according to B4,0.5. Which number k ∈{0, 1, 2, 3, 4} do
we select if we toss 1, 1, 0, 1, 1, 1?
Our next aim is to simulate continuous random variables. More precisely, suppose
we are given a probability density p. Then we look for a function f : [0, 1] →ℝsuch that
p is the density of X = f (U), that is, we have to have
ℙ{f (U) ≤t} = ℙ{X ≤t} =
t
∫
−∞
p(x) dx ,
t ∈ℝ.
(4.12)
To this end, set
F(t) =
t
∫
−∞
p(x) dx ,
t ∈ℝ.
(4.13)
Thus, F is the distribution function of the random variable X, which we are going to
construct.
Suppose first that F is one-to-one on a finite or infinite interval (a, b), so that F(x) = 0
if x < a, and F(x) = 1 if x > b. For example, this is valid if p(t) > 0 for all t ∈(a, b). Since
F is continuous, the inverse function F−1 exists and maps (0, 1) to (a, b).
Proposition 4.4.7. Let p be a probability density and define F by eq. (4.12). Suppose F sat-
isfies the above condition. If X = F−1(U), then
ℙ{X ≤t} =
t
∫
−∞
p(x) dx ,
t ∈ℝ,
that is, p is a density of X.
Proof. First note that the assumptions about F imply that it is increasing on (a, b). Hence,
if t ∈ℝ, then
ℙ{X ≤t} = ℙ{F−1(U) ≤t} = ℙ{U ≤F(t)} = F(t) =
t
∫
−∞
p(x) dx ,
t ∈ℝ.
Here we used 0 ≤F(t) ≤1 and ℙ{U ≤s} = s whenever 0 ≤s ≤1. This completes the
proof.

4.4 Simulation of random variables
౪
199
But what do we do if F does not satisfy the above assumption? For example, this
happens if p(x) = 0 on an interval I = (α, β) and p(x) > 0 on some left- and right-hand
intervals6 of I. In this case F−1 does not exist, and we have to modify the construction.7
Definition 4.4.8. Let F be defined by eq. (4.13). Then we set
F−(s) = inf{t ∈ℝ: F(t) = s} ,
0 ≤s < 1 .
The function F−, mapping [0, 1) to [−∞, ∞), is called the pseudoinverse of F.
Remark 4.4.9. If 0 < s < 1, then F−(s) ∈ℝwhile F−(0) = −∞. Moreover, if F is increas-
ing on some interval I, then F−(s) = F−1(s) for s ∈I.
Lemma 4.4.10. The pseudoinverse function F−possesses the following properties:
1.
If s ∈(0, 1) and t ∈ℝ, then
F(F−(s)) = s
and
F−(F(t)) ≤t .
2.
Given t ∈(0, 1), we have
F−(s) ≤t
⇐⇒
s ≤F(t) .
(4.14)
Proof. The equality F(F−(s)) = s is a direct consequence of the continuity of F. Indeed,
if there are tn ↘F−(s) with F(tn) = s, then
s = lim
n→∞F(tn) = F(F−(s)) .
The second part of the first assertion follows by the definition of F−.
Now let us come to the proof of property (4.14). If F−(s) ≤t, then the monotonicity
of F and F(F−(s)) = s lead to s = F(F−(s)) ≤F(t).
Conversely, if s ≤F(t), then F−(s) ≤F−(F(t)) ≤t by the first part, thus, property
(4.14) is proved.
Now choose a uniformly distributed U and set X = F−(U). Since ℙ{U = 0} = 0, we
may assume that X attains values in ℝ.
Proposition 4.4.11. Let p be a probability density, that is, we have p(x)
≥
0 and
∫
∞
−∞p(x)dx = 1. Define F by eq. (4.13) and let F−be its pseudoinverse. Take U to be
uniformly distributed on [0, 1] and set X = F−(U). Then p is a distribution density of the
random variable X.
6 Take, for instance, p with p(x) = 1
2 if x ∈[0, 1] and if x ∈[1, 2], and p(x) = 0 otherwise.
7 All subsequent distribution functions F possess an inverse function on a suitable interval (a, b). Thus,
Proposition 4.4.7 applies in almost all cases of interest. Therefore, if the statements about pseudoinverse
functions look too complicated, you may skip them.

200
౪
4 Operations on random variables
Proof. Using property (4.14), it follows that
FX(t) = ℙ{X ≤t} = ℙ{ω ∈Ω : F−(U(ω)) ≤t}
= ℙ{ω ∈Ω : U(ω) ≤F(t)} = F(t),
which completes the proof.
Remark 4.4.12. Since F−= F−1 whenever the inverse function exists, Proposition 4.4.7
is a special case of Proposition 4.4.11.
Example 4.4.13. Let us simulate an 𝒩(0, 1)-distributed random variable, that is, we are
looking for a function f : (0, 1) →ℝsuch that for a uniformly distributed U,
ℙ{f (U) ≤t} =
1
√2π
t
∫
−∞
e−x2/2 dx ,
t ∈ℝ.
The distribution function
Φ(t) =
1
√2π
t
∫
−∞
e−x2/2 dx
is one-to-one from ℝ→(0, 1), hence Proposition 4.4.7 applies, and Φ−1(U) is a standard
normal random variable.
How does one get an 𝒩(μ, σ2)-distributed random variable? If X is standard nor-
mal, by Proposition 4.2.3 the transformed variable σX +μ is 𝒩(μ, σ2)-distributed. Conse-
quently, σΦ−1(U) + μ possesses the desired distribution.
How do we find n independent 𝒩(μ, σ2)-distributed numbers x1, . . . , xn? To achieve
this, choose u1, . . . , un in [0, 1] according to the construction presented in Remark 4.3.10
and set xi = σ Φ−1(ui) + μ, 1 ≤i ≤n.
Example 4.4.14. Our next aim is to simulate an Eλ-distributed (exponentially dis-
tributed) random variable. Here
F(t) = {0
if t ≤0,
1 −e−λt
if t > 0,
which satisfies the assumptions of Proposition 4.4.7 on the interval (0, ∞). Its inverse
F−1 maps (0, 1) to (0, ∞) and equals
F−1(s) = −ln(1 −s)
λ
,
0 < s < 1 .
Therefore, if U is uniformly distributed on [0, 1], then X = −ln(1−U)
λ
is Eλ-distributed. This
is true for any uniformly distributed random variable U. By Corollary 4.2.7, the random
variable 1 −U has the same distribution as U, hence, setting

4.4 Simulation of random variables
౪
201
Y = −ln(1 −(1 −U))
λ
= −ln(U)
λ
,
the random variable Y is Eλ-distributed as well.
Example 4.4.15. Let us simulate a random variable with Cauchy distribution (see Defi-
nition 1.6.37). The distribution function F is given by
F(t) = 1
π
t
∫
−∞
1
1 + x2 dx = 1
π arctan(t) + 1
2 ,
t ∈ℝ,
hence X := tan(πU −π
2 ) possesses a Cauchy distribution.
Example 4.4.16. Finally, let us give an example where Proposition 4.4.11 applies and
Proposition 4.4.7 does not. Suppose we want to simulate a random variable X with dis-
tribution function F defined by
F(t) =
{
{
{
{
{
{
{
{
{
{
{
{
{
{
{
{
{
{
{
{
{
0
if t < 0,
t
2
if 0 ≤t < 1,
1
2
if 1 ≤t < 2,
1
2 + t−2
2
if 2 ≤t < 3,
1
if t ≥3.
(4.15)
Direct computations imply (see Figure 4.3) that
F−(s) =
{
{
{
{
{
{
{
2s
if 0 < s < 1
2,
1
if s = 1
2,
2s + 1
if 1
2 < s ≤1 .
Figure 4.3: The functions F and F−in Example 4.4.16.
Hence, if X is defined by
X = F−(U) = 2U 1[0, 1
2 ](U) + (2U + 1) 1( 1
2 ,1](U) ,

202
౪
4 Operations on random variables
then ℙ{X ≤t} = F(t) with F defined by eq. (4.15). In other words, X is acting as follows.
Choose by random a number u ∈[0, 1]. If u ≤1
2, then X(u) = 2u, while for u > 1
2 we take
X(u) = 2u + 1.
Summary: Let ℙbe a probability measure on the Borel sets of ℝ. In order to simulate n independent num-
bers x1, . . . , xn distributed according to ℙ, one proceeds in the following way. In the first step, one constructs n
independent numbers u1, . . . , un uniformly distributed on [0, 1]. To this end, one tosses a fair coin sufficiently
often as explained in Remark 4.3.10.
The second step is then as follows: If ℙis discrete, one defines the numbers x1, . . . , xn by xj = f(uj) with
the function f constructed in (4.11). The probability that one (or each) xj belongs to a set B equals ℙ(B). In
case of continuous ℙ, define xj as F−1(uj) provided the distribution function F of ℙis invertible. Otherwise
replace F−1 by the pseudoinverse F−introduced in Definition 4.4.8. As before, the xjs are independent and
distributed according to the given ℙ.
4.5 Addition of random variables
Suppose we are given two random variables X and Y, both mapping from Ω into ℝ. As
usual, their sum X + Y is defined by
(X + Y)(ω) := X(ω) + Y(ω) ,
ω ∈Ω .
The main question we investigate in this section is as follows: suppose we know the
probability distributions of X and Y. Is there a way to compute the distribution of X +Y?
For example, if we roll a die twice, X is the result of the first roll, Y that of the second,
then we know ℙX and ℙY. But how do we get ℙX+Y?
Before we treat this question, we have to be sure that X+Y is also a random variable.
This is not obvious at all. Otherwise, the probability distribution of X + Y is not defined
and our question does not make sense.
Proposition 4.5.1. If X and Y are random variables, then so is X + Y.
Proof. We start the proof with the following observation. For two real numbers a and b,
one has a < b if and only if there is a rational number q ∈ℚsuch that a < q and b > q.
Therefore, given t ∈ℝ, it follows that
{ω ∈Ω : X(ω) + Y(ω) < t} = {ω ∈Ω : X(ω) < t −Y(ω)}
= ⋃
q∈ℚ
[{ω : X(ω) < q} ∩{ω : q < t −Y(ω)}] .
(4.16)
By assumption, X and Y are random variables. Hence, for each q ∈ℚ,
Aq := {ω : X(ω) < q} ∈𝒜
and
Bq := {ω : Y(ω) < t −q} ∈𝒜,

4.5 Addition of random variables
౪
203
which, by the properties of σ-fields, implies Cq := Aq ∩Bq ∈𝒜. With this notation, we
may write eq. (4.16) as
{ω ∈Ω : X(ω) + Y(ω) < t} = ⋃
q∈ℚ
Cq .
The σ-field 𝒜is closed under taking countable unions, thus, since ℚis countably infinite
and Cq ∈𝒜, it follows that ⋃q∈ℚCq ∈𝒜. Therefore, we have proven that, if t ∈ℝ, then
{ω ∈Ω : X(ω) + Y(ω) < t} ∈𝒜.
Proposition 3.1.6 lets us conclude that, as asserted, X + Y is a random variable.
Remark 4.5.2. In view of Proposition 4.5.1, the following question makes sense: does
there exist a general approach to evaluate ℙX+Y by virtue of ℙX and of ℙY?
Answer: Such a general way does not exist. The deeper reason behind this is that,
in order to get ℙX+Y, one has to know the joint distribution of (X, Y). And as we saw in
Section 3.5, in general, the knowledge of ℙX and ℙY does not suffice to determine their
joint distribution, hence generally we also do not know ℙX+Y.
The next example emphasizes the previous remark.
Example 4.5.3. Let X, Y, X′, and Y ′ be as in Example 3.5.8, that is, we choose two balls
out of an urn where two balls are labeled by “0” and two by “1,” once without replacing
the first ball and once with replacing. The joint distributions of (X, Y) and (X′, Y ′) are
ℙ{X = 0, Y = 0} = 1
6 ,
ℙ{X = 0, Y = 1} = 1
3,
ℙ{X = 1, Y = 0} = 1
3 ,
ℙ{X = 1, Y = 1} = 1
6,
ℙ{X′ = 0, Y ′ = 0} = 1
4 ,
ℙ{X′ = 0, Y ′ = 1} = 1
4,
ℙ{X′ = 1, Y ′ = 0} = 1
4 ,
ℙ{X′ = 1, Y ′ = 1} = 1
4 .
Then ℙX = ℙX′ and ℙY = ℙY ′, but
ℙ{X + Y = 0} = 1
6 ,
ℙ{X + Y = 1} = 2
3,
and
ℙ{X + Y = 2} = 1
6 ,
while
ℙ{X′ + Y ′ = 0} = 1
4 ,
ℙ{X′ + Y ′ = 1} = 1
2,
and
ℙ{X′ + Y ′ = 2} = 1
4 .
Consequently, if we do not replace the chosen ball, the probability that the sum of both
choices equals “1” is 2/3 while it is 1/2 if we replace the first ball. And this happens al-
though in both cases the numbers “0” and “1” occur every time with probability 1/2.

204
౪
4 Operations on random variables
On the other hand, as we saw in Proposition 3.6.5, the joint distribution is uniquely
determined by the marginal ones, provided the random variables are independent.
Therefore, for independent random variables X and Y, the distribution of X + Y is
determined by those of X and Y. The question remains, how ℙX+Y can be computed.
4.5.1 Sums of discrete random variables
We first consider an important special case, namely that X and Y attain values in ℤ.
Here we have
Proposition 4.5.4 (Convolution formula for ℤ-valued random variables). Let X and Y be
two independent random variables with values in ℤ. If k ∈ℤ, then
ℙ{X + Y = k} =
∞
∑
i=−∞
ℙ{X = i} ⋅ℙ{Y = k −i} .
Proof. Fix k ∈ℤand define Bk ⊆ℤ× ℤby
Bk := {(i, j) ∈ℤ× ℤ: i + j = k} .
Then we get
ℙ{X + Y = k} = ℙ{(X, Y) ∈Bk} = ℙ(X,Y)(Bk)
(4.17)
with joint distribution ℙ(X,Y). Proposition 3.6.11 asserts that for independent X and Y
and B ⊆ℤ× ℤ,
ℙ(X,Y)(B) = ∑
(i,j)∈B
ℙX({i}) ⋅ℙY({j}) = ∑
(i,j)∈B
ℙ{X = i} ⋅ℙ{Y = j} .
We apply this formula with B = Bk and, from eq. (4.17), obtain
ℙ{X + Y = k} =
∑
(i,j)∈Bk
ℙ{X = i} ⋅ℙ{Y = j}
=
∑
{(i,j) : i+j=k}
ℙ{X = i} ⋅ℙ{Y = j}
=
∞
∑
i=−∞
ℙ{X = i} ⋅ℙ{Y = k −i} ,
as asserted.
Example 4.5.5. Two independent random variables X and Y are distributed according
to ℙ{X = j} = ℙ{Y = j} = 1/2j, j = 1, 2, . . . Determine the probability distribution of X −Y.

4.5 Addition of random variables
౪
205
Solution: First note that ℙ{X = j} = ℙ{Y = j} = 0 for j ≤0. Hence, given k ∈ℤ, an
application of Proposition 4.5.4 to X and −Y yields
ℙ{X −Y = k} =
∞
∑
i=−∞
ℙ{X = i} ⋅ℙ{−Y = k −i} =
∞
∑
i=1
ℙ{X = i} ⋅ℙ{Y = i −k} .
If k ≥0, then ℙ{Y = i −k} = 0 for i ≤k, thus
ℙ{X −Y = k} =
∞
∑
i=k+1
ℙ{X = i} ⋅ℙ{Y = i −k} =
∞
∑
i=k+1
1
2i ⋅
1
2i−k
= 2k
∞
∑
i=k+1
1
22i = 2k ⋅2−2k−2 ⋅
∞
∑
i=0
1
22i = 2−k−2 ⋅4
3 = 2−k
3 .
For k < 0, it follows that
ℙ{X −Y = k} =
∞
∑
i=1
1
2i ⋅
1
2i−k = 2k
∞
∑
i=1
1
22i = 2k
∞
∑
i=1
1
4i = 2k
3 .
We combine both cases and obtain
ℙ{X −Y = k} = 2−|k|
3
,
k ∈ℤ.
Which random experiment does X −Y describe? Suppose player A and B both toss a fair
coin. Let X be the number of necessary trials for A to observe the first “heads.” Similarly,
Y describes how often B has to toss his coin to get the first “heads.” Thus, the value of
X −Y tells us how many trials later (or earlier if X −Y is negative) player A got his first
“heads” compared to B.
For example, if B got his first “heads” one trial earlier than A, then X −Y = 1. The
probability that this occurs equals 1/6.
One special case of Proposition 4.5.4 is of particular interest.
Proposition 4.5.6 (Convolution formula for ℕ0-valued random variables). Let X and Y be
two independent random variables with values in ℕ0. If k ∈ℕ0, then it follows that
ℙ{X + Y = k} =
k
∑
i=0
ℙ{X = i} ⋅ℙ{Y = k −i} .
Proof. Regard X and Y as ℤ-valued random variables with ℙ{X = i} = ℙ{Y = i} = 0 for
all i = −1, −2, . . . If k ∈ℕ0, then Proposition 4.5.4 lets us conclude that
ℙ{X + Y = k} =
∞
∑
i=−∞
ℙ{X = i} ⋅ℙ{Y = k −i} =
k
∑
i=0
ℙ{X = i} ⋅ℙ{Y = k −i} .

206
౪
4 Operations on random variables
Here we used ℙ{X = i} = 0 for i < 0 and ℙ{Y = k −i} = 0 if i > k. For k < 0, it follows
that ℙ{X + Y = k} = 0 because in this case ℙ{Y = k −i} = 0 for all i ≥0. This completes
the proof.
Example 4.5.7. Let X and Y be two independent random variables, both uniformly dis-
tributed on {1, 2, . . . , N}. Which probability distribution does X + Y possess?
Answer: Of course, X + Y attains only values in the set {2, 3, . . . , 2N}. Hence,
ℙ{X + Y = k} is only of interest for 2 ≤k ≤2N. Here we get
ℙ{X + Y = k} = |Ik|
N2 ,
(4.18)
where Ik is defined by
Ik := {i ∈{1, . . . , N} : 1 ≤k −i ≤N} = {i ∈{1, . . . , N} : k −N ≤i ≤k −1} .
To verify eq. (4.18), use that for i ∉Ik either ℙ{X = i} = 0 or ℙ{Y = k −i} = 0. It is not
difficult to prove that
|Ik| = {k −1
if 2 ≤k ≤N + 1,
2N −k + 1
if N + 1 < k ≤2N,
which leads to
ℙ{X + Y = k} =
{
{
{
{
{
{
{
{
{
k−1
N2
if 2 ≤k ≤N + 1,
2N−k+1
N2
if N + 1 < k ≤2N,
0
otherwise
If N = 6, then X+Y may be viewed as the sum of two rolls of a die. Here the above formula
leads to the values of ℙ{X +Y = k}, k = 2, . . . , 12, which we, by a direct approach, already
computed in Example 3.2.15. For another example with N = 8 see Figure 4.4.
Figure 4.4: The sum of independent X and Y, both uniformly distributed on {1, . . . , 8}.
Finally, let us shortly discuss the case of two arbitrary independent discrete random
variables. Assume that X and Y have values in at most countable infinite sets D and E,

4.5 Addition of random variables
౪
207
respectively. Then X + Y maps into
D + E := {x + y : x ∈D , y ∈E} .
Note that D + E is also at most countably infinite.
Under these assumptions, the following is valid.
Proposition 4.5.8. Suppose X and Y are two independent discrete random variables with
values in the (at most) countably infinite sets D and E, respectively. For z ∈D+E, it follows
that
ℙ{X + Y = z} =
∑
{(x,y)∈D×E : x+y=z}
ℙ{X = x} ⋅ℙ{Y = y} .
Proof. For a fixed z ∈D + E define Bz ⊆D × E by Bz := {(x, y) : x + y = z}. Using this
notation, we get
ℙ{X + Y = z} = ℙ{(X, Y) ∈Bz} = ℙ(X,Y)(Bz) ,
where again ℙ(X,Y) denotes the joint distribution of X and Y. Now we may proceed as in
the proof of Proposition 4.5.4. The independence of X and Y implies
ℙ(X,Y)(Bz) =
∑
{(x,y)∈D×E:x+y=z}
ℙ{X = x} ⋅ℙ{Y = y} ,
proving the proposition.
Remark 4.5.9. If D = E = ℤ, then Proposition 4.5.8 implies Proposition 4.5.4, while for
D = E = ℕ0 we rediscover Proposition 4.5.6.
Example 4.5.10. Suppose X is uniformly distributed on D = {1, 2, 3, 4} while Y is uni-
formly distributed on E = {5, 6, 7, 8}. Their sum attains its values in {6, . . . , 12}. If X and
Y are independent, then, for example,
ℙ{X + Y = 7} =
∑
x∈D, y∈E
x+y=7
ℙ{X = x}ℙ{Y = y}
= ℙ{X = 1} ⋅ℙ{Y = 6} + ℙ{X = 2} ⋅ℙ{Y = 5}
= 1
4 ⋅1
4 + 1
4 ⋅1
4 = 1
8 .
4.5.2 Sums of continuous random variables
In this section we investigate the following question: let X and Y be two continuous
random variables with density functions p and q. Is X + Y continuous as well, and if this
is so, how do we compute its density?

208
౪
4 Operations on random variables
To answer this question, we need a special type of composing two functions.
Definition 4.5.11. Let f and g be two Riemann integrable functions from ℝto ℝ. Their convolution f ⋆g
is defined by
(f ⋆g)(x) :=
∞
∫
−∞
f(x −y) g(y) dy ,
x ∈ℝ.
(4.19)
Remark 4.5.12. The convolution is a commutative operation, that is,
f ⋆g = g ⋆f .
This follows by the change of variables u = x −y in eq. (4.19), thus
(f ⋆g)(x) =
∞
∫
−∞
f (x −y) g(y) dy =
∞
∫
−∞
f (u) g(x −u) du = (g ⋆f )(x) ,
x ∈ℝ.
Remark 4.5.13. For general functions f and g, the integral in eq. (4.19) does not always
exist for all x ∈ℝ. The investigation of this question requires facts and notations8 from
Measure Theory; therefore, we will not treat it here. We only state a special case, which
suffices for our later purposes. Moreover, for concrete functions f and g, it is mostly easy
to check for which x ∈ℝthe value (f ⋆g)(x) exists.
Proposition 4.5.14. Let p and q be two probability densities and suppose that at least one
of them is bounded. Then (p ⋆q)(x) exists for all x ∈ℝ.
Proof. Say p is bounded, that is, there is a constant c ≥0 such that 0 ≤p(z) ≤c for all
z ∈ℝ. Since q(y) ≥0, if x ∈ℝ, then
0 ≤
∞
∫
−∞
p(x −y)q(y) dy ≤c
∞
∫
−∞
q(y) dy = c < ∞.
This proves that (p ⋆g)(x) exists for all x ∈ℝ.
Since p ⋆q = q ⋆p, the same argument applies if q is bounded.
The next result provides us with a formula for the evaluation of the density function
of X + Y for independent continuous X and Y.
Proposition 4.5.15 (Convolution formula for continuous random variables). Let X and Y
be two independent random variables with distribution densities p and q. Then X + Y is
continuous as well, and its density r may be computed by
8 For example, “exists almost everywhere.”

4.5 Addition of random variables
౪
209
r(x) = (p ⋆q)(x) =
∞
∫
−∞
p(y) q(x −y) dy.
Proof. We have to show that r = p ⋆q satisfies
ℙ{X + Y ≤t} =
t
∫
−∞
r(x) dx ,
t ∈ℝ.
(4.20)
Fix t ∈ℝfor a moment and define Bt ⊆ℝ2 by
Bt := {(u, y) ∈ℝ2 : u + y ≤t} .
Then we get
ℙ{X + Y ≤t} = ℙ{(X, Y) ∈Bt} = ℙ(X,Y)(Bt) .
(4.21)
To compute the right-hand side of eq. (4.21), we use Proposition 3.6.20. It asserts that
the joint distribution ℙ(X,Y) of independent X and Y has density (u, y) 󳨃→p(u)q(y), that
is, if B ⊆ℝ2, then
ℙ(X,Y)(B) = ∬
B
p(u)q(y) dy du .
Choosing B = Bt in the last formula, eq. (4.21) may now be written as
ℙ{X + Y ≤t} = ∬
Bt
p(u) q(y) dy du =
∞
∫
−∞
[
t−y
∫
−∞
p(u) du] q(y) dy .
(4.22)
Next we change the variables in the inner integral as follows:9 u = x −y, hence
du = dx. Then the right-hand integrals in eq. (4.22) coincide with
∞
∫
−∞
[
t
∫
−∞
p(x −y) dx] q(y) dy =
t
∫
−∞
[
∞
∫
−∞
p(x −y) q(y) dy] dx
=
t
∫
−∞
(p ⋆q)(x) dx .
Hereby we used that p and q are nonnegative, so that we may interchange the integrals
by virtue of Proposition A.5.5. Thus, eq. (4.20) is satisfied, which completes the proof.
9 Note that in the inner integral y is a constant.

210
౪
4 Operations on random variables
4.6 Sums of certain random variables
Let us start with the investigation of the sum of independent binomial distributed ran-
dom variables. Here the following is valid.
Proposition 4.6.1. Let X and Y be two independent random variables, accordingly
Bn,p- and Bm,p-distributed for some n, m ≥1, and some p ∈[0, 1]. Then X + Y is
Bn+m,p-distributed.
Proof. By Proposition 4.5.6, we get that for 0 ≤k ≤m + n,
ℙ{X + Y = k} =
k
∑
j=0
[(n
j ) pj (1 −p)n−j] ⋅[( m
k −j) pk−j (1 −p)m−(k−j)]
= pk (1 −p)n+m−k
k
∑
j=0
(n
j )( m
k −j) .
To evaluate the sum, we apply Vandermonde’s identity (Proposition A.3.9), which
asserts
k
∑
j=0
(n
j )( m
k −j) = (n + m
k
) .
This leads to
ℙ{X + Y = k} = (n + m
k
) pk (1 −p)m+n−k ,
and X + Y is Bn+m,p-distributed.
Interpretation: In the first experiment, we toss a biased coin n times and in the sec-
ond m times. We combine these two experiments into one and toss the coin now n + m
times. Then we observe “heads” exactly k times during the n + m trials if there is some
j ≤k so that we had j “heads” among the first n trials and k −j among the second m.
Finally, we have to sum the probabilities of all these events over j ≤k.
Corollary 4.6.2. Let X1, . . . , Xn be independent B1,p-distributed, that is,
ℙ{Xj = 0} = 1 −p
and
ℙ{Xj = 1} = p ,
j = 1, . . . , n .
Then their sum X1 + ⋅⋅⋅+ Xn is Bn,p-distributed.
Proof. Apply Proposition 4.6.1 successively, first to X1 and X2, then to X1 +X2 and X3, and
so on.
Remark 4.6.3. Observe that
X1 + ⋅⋅⋅+ Xn = 󵄨󵄨󵄨󵄨{j ≤n : Xj = 1}󵄨󵄨󵄨󵄨.

4.6 Sums of certain random variables
౪
211
Corollary 4.6.2 justifies the interpretation of the binomial distribution given in Sec-
tion 1.4.3. Indeed, the event {Xj = 1} occurs if in trial j we observe success. Thus, the
sum X1 + ⋅⋅⋅+ Xn describes the number of successes in n independent trials. Hereby, the
success probability is ℙ{Xj = 1} = p.
In the literature, the following notion is common.
Definition 4.6.4. A finite or infinite sequence X1, X2, . . . of independent B1,p-distributed random variables
is called a Bernoulli trial or Bernoulli process, or also binomial trial, with success probability p ∈[0, 1].
With these notations, Corollary 4.6.2 may now be formulated as follows:
Let X1, X2, . . . , be a Bernoulli trial with success probability p. Then for n ≥1,
ℙ{X1 + ⋅⋅⋅+ Xn = k} = (n
k) pk (1 −p)n−k ,
k = 0, . . . , n .
Let X and Y be two independent Poisson distributed random variables. Which distribu-
tion does X + Y possess? The next result answers this question.
Proposition 4.6.5. Let X and Y be independent Poisλ- and Poisμ-distributed for some λ > 0
and μ > 0, respectively. Then X + Y is Poisλ+μ-distributed.
Proof. Proposition 4.5.6 and the binomial theorem (see Proposition A.3.8) imply
ℙ{X + Y = k} =
k
∑
j=0
[λj
j! e−λ][ μk−j
(k −j)! e−μ]
= e−(λ+μ)
k!
k
∑
j=0
k!
j! (k −j)!λj μk−j
= e−(λ+μ)
k!
k
∑
j=0
(k
j )λj μk−j = (λ + μ)k
k!
e−(λ+μ) .
Consequently, as asserted, X + Y is Poisλ+μ-distributed.
Interpretation: The numbers of phone calls arriving per day at some call centers A
and B are Poisson distributed with parameters10 λ and μ. Suppose that these two centers
have different customers, that is, we assume that the number of calls in A and B is in-
dependent of each other. Proposition 4.6.5 asserts that the number of calls arriving per
day either in A or in B is again Poisson distributed, but now with parameter λ + μ.
Example 4.6.6. This example deals with the distribution of raisins in a set of dough.
More precisely, suppose we have N pounds of dough and therein are n uniformly dis-
10 Later on, in Proposition 5.1.16, we will see that λ and μ are the mean values of arriving calls per day.

212
౪
4 Operations on random variables
tributed raisins. Choose at random a one-pound piece of dough. Find the probability that
there are k ≥0 raisins in the chosen piece.
Approach 1: Since the raisins are uniformly distributed in the dough, the probability
that a single raisin is in the chosen piece equals 1/N. Hence, if X is the number of raisins
in that piece, it is Bn,p-distributed with p = 1/N. Assuming that N is big, the random
variable X is approximately Poisλ-distributed with λ = n/N, that is,
ℙ{X = k} = λk
k! e−λ ,
k = 0, 1, . . .
Note that λ = n/N coincides with the average number of raisins per pound dough.
Approach 2: Assume that we took in the previous model N →∞, that is, we have
an “infinite” amount of dough and “infinitely” many raisins. Which distribution does X,
the number of raisins in a one-pound piece, now possess?
First, we have to determine what it means that the amount of dough is “infinite” and
that the raisins are uniformly distributed11 therein. This is expressed by the following
conditions:
(a) The mass of dough is unbelievably huge, hence, whenever we choose two different
pieces, the numbers of raisins in the pieces are independent of each other.
(b) The fact that the raisins are uniformly distributed is expressed by the following
condition: suppose the number of raisins in a one-pound piece is n ≥0. If this piece is
split into two pieces, say K1 and K2 of weight α and 1−α pounds, then the probability
that a single raisin (out of n) is in K1 equals α, and the probability that it is in K2 is
1 −α.
Fix 0 < α < 1 and choose in the first step a piece K1 of α pounds and in the second one
another piece K2 of weight 1−α. Let X1 and X2 be the numbers of raisins in each of the two
pieces. By condition (a), the random variables X1 and X2 are independent. If X = X1 + X2,
then X is the number of raisins in a randomly chosen one-pound piece. Suppose now
X = n, that is, there are n raisins in the one-pound piece. Then by condition (b), the
probability for k raisins in K1 is described by the binomial distribution Bn,α. Recall that
the success probability for a single raisin is α, thus, X1 = k means, we have k successes.
This may be formulated as follows: for all 0 ≤k ≤n,
ℙ{X1 = k|X = n} = Bn,α({k}) = (n
k)αk(1 −α)n−k .
(4.23)
Rewriting eq. (4.23) leads to
ℙ{X1 = k, X2 = n −k} = ℙ{X1 = k, X = n}
11 Note that the multivariate uniform distribution only makes sense (cf. Definition 1.8.13) if the under-
lying set has a finite volume.

4.6 Sums of certain random variables
౪
213
= ℙ{X1 = k|X = n} ⋅ℙ{X = n} = ℙ{X = n} ⋅(n
k)αk(1 −α)n−k .
(4.24)
Observe that in contrast to eq. (4.23), eq. (4.24) remains valid also if ℙ{X = n} = 0.
Indeed, if ℙ{X = n} = 0, by Proposition 4.5.6, the event {X1 = k, X2 = n −k} has zero
probability as well.
The independence of X1 and X2 and eq. (4.24) imply that, if n = 0, 1, 2, . . . and k =
0, . . . , n, then
ℙ{X1 = k} ⋅ℙ{X2 = n −k} = ℙ{X = n} ⋅(n
k)αk(1 −α)n−k .
Setting k = n, we get
ℙ{X1 = n} ⋅ℙ{X2 = 0} = ℙ{X = n} ⋅αn ,
(4.25)
while for n ≥1 and k = n −1 we obtain
ℙ{X1 = n −1} ⋅ℙ{X2 = 1} = ℙ{X = n} ⋅n ⋅αn−1 (1 −α) .
(4.26)
In particular, from eq. (4.25) ℙ{X2 = 0} > 0 follows. If this probability were zero,
then this would imply ℙ{X = n} = 0 for all n ∈ℕ0, which is impossible in view of
ℙ{X ∈ℕ0} = 1.
In the next step, we solve eqs. (4.25) and (4.26) with respect to ℙ{X = n} and make
them equal. Doing so, for n ≥1 we get
ℙ{X1 = n} = α
n (1 −α)−1 ⋅ℙ{X2 = 1}
ℙ{X2 = 0} ⋅ℙ{X1 = n −1}
= αλ
n ⋅ℙ{X1 = n −1} ,
(4.27)
where λ ≥0 is defined by
λ := (1 −α)−1 ⋅ℙ{X2 = 1}
ℙ{X2 = 0} .
(4.28)
Do we have λ > 0? If λ = 0, then ℙ{X2 = 1} = 0 and, by eq. (4.26), ℙ{X = n} = 0 for
n ≥1. Consequently, ℙ{X = 0} = 1, which says that there are no raisins in the dough. We
exclude this trivial case, thus it follows that λ > 0.
Finally, successive application of eq. (4.27) implies for n ∈ℕ0
12 that
ℙ{X1 = n} = (αλ)n
n!
⋅ℙ{X1 = 0} ,
(4.29)
12 If n = 0, the equation holds trivially.

214
౪
4 Operations on random variables
leading to
1 =
∞
∑
n=0
ℙ{X1 = n} = ℙ{X1 = 0} ⋅
∞
∑
n=0
(αλ)n
n!
= ℙ{X1 = 0} eαλ ,
that is, we have ℙ{X1 = 0} = e−αλ. Plugging this into eq. (4.29) gives
ℙ{X1 = n} = (αλ)n
n!
e−αλ ,
and so X1 is Poisson distributed with parameter αλ.
Let us interchange now the roles of X1 and X2, hence also of α and 1 −α. An applica-
tion of the first step to X2 tells us that it is Poisson distributed, but now with parameter
(1 −α)λ′, where in view of eq. (4.28) λ′ is given by13
λ′ = α−1 ⋅ℙ{X1 = 1}
ℙ{X1 = 0} = α−1 αλ e−αλ
e−αλ
= λ .
Thus, X2 is Pois(1−α)λ-distributed.
Since X1 and X2 are independent, Proposition 4.6.5 applies, hence X = X1 + X2 is
Poisλ-distributed or, equivalently,
ℙ{There are k raisins in a one-pound piece} = λk
k! e−λ .
Remark 4.6.7. Which role does the parameter λ > 0 play in this model? As already
mentioned, Proposition 5.1.16 will tell us that λ is the average number of raisins per
pound dough. Thus, if ρ > 0 and we ask for the number of raisins in a piece of ρ pounds,
then this number is Poisρλ-distributed,14 that is,
ℙ{k raisins in ρ pounds of dough} = (ρλ)k
k!
e−ρλ .
Assume that dough contains on average 20 raisins per pound. Let X be the number of
raisins in a piece of bread baked from five pounds of dough. Then X is Pois100-distributed
and
ℙ({95 ≤X ≤105}) = 0.4176 ,
ℙ({90 ≤X ≤110}) = 0.7065 ,
ℙ({85 ≤X ≤115}) = 0.8793 ,
ℙ({80 ≤X ≤120}) = 0.9599 ,
ℙ({75 ≤X ≤125}) = 0.9892 ,
ℙ({70 ≤X ≤130}) = 0.9976 .
13 Observe that we have to replace X2 by X1 and 1 −α by α.
14 Because on average there are ρλ raisins in a piece of ρ pounds.

4.6 Sums of certain random variables
౪
215
Additional question: Suppose we buy two loaves of bread baked from ρ pounds dough
each. What is the probability that one of these two loaves contains more than twice as
many raisins as the other?
Answer: Let X be the number of raisins in the first loaf, and Y the number of raisins
in the second. By assumption, X and Y are independent, and both are Poisρλ-distributed,
where as before λ > 0 is the average number of raisins per pound dough. The probability
we are interested in is (use Proposition 1.2.4 as well as that (X, Y)
d= (Y, X))
ℙ{X > 2Y or Y > 2X} = ℙ{X > 2Y} + ℙ{Y > 2X} = 2 ℙ{X > 2Y}
= 2
∞
∑
k=0
ℙ{Y = k, X > 2k} = 2
∞
∑
k=0
ℙ{Y = k} ⋅ℙ{X > 2k}
= 2
∞
∑
k=0
ℙ{Y = k} ⋅
∞
∑
j=2k+1
ℙ{X = j} = 2 e−2ρλ
∞
∑
k=0
(ρλ)k
k!
∞
∑
j=2k+1
(ρλ)j
j!
.
If the average number of raisins per pound is λ = 20, and if the loaves are baked from
ρ = 5 pounds dough, then this probability is approximately
ℙ{X > 2Y or Y > 2X} ≈3.17061 × 10−6 .
If ρ = 1, that is, the loaves are made from one-pound dough each, then
ℙ{X > 2Y or Y > 2X} ≈0.0430079 .
Next we investigate the distribution of the sum of two independent negative binomial
distributed random variables. Recall that X is B−
n,p-distributed if
ℙ{X = k} = (k −1
k −n) pn (1 −p)k−n ,
k = n, n + 1, . . .
Proposition 4.6.8. Let X and Y be independent and respectively B−
n,p- and B−
m,p-distributed
for some m, n ≥1. Then X + Y is B−
n+m,p-distributed.
Proof. We derive from Example 4.1.8 that, if k ∈ℕ0, then
ℙ{X −n = k} = (−n
k ) pn (p −1)k
and
ℙ{Y −m = k} = (−m
k ) pm (p −1)k .
An application of Proposition 4.5.6 to X −n and Y −m implies
ℙ{X + Y −(n + m) = k} =
k
∑
j=0
[(−n
j )pn(p −1)j] [( −m
k −j)pm(p −1)k−j]
= pn+m(p −1)k
k
∑
j=0
(−n
j )( −m
k −j) .

216
౪
4 Operations on random variables
To compute the last sum, we use Proposition A.5.3, which asserts that
k
∑
j=0
(−n
j )( −m
k −j) = (−n −m
k
) .
Consequently, for each k ∈ℕ0,
ℙ{X + Y −(n + m) = k} = (−n −m
k
)pn+m(p −1)k .
Another application of eq. (4.2) (this time with n + m) leads to
ℙ{X + Y = k} = (
k −1
k −(n + m)) pn+m (1 −p)k−(n+m) ,
k = n + m, n + m + 1, . . . ,
completing the proof.
Corollary 4.6.9. Let X1, . . . , Xn be independent Gp-distributed (geometrically distributed)
random variables. Then their sum X1 + ⋅⋅⋅+ Xn is B−
n,p-distributed.
Proof. Use Gp = B−
1,p and apply Proposition 4.6.8 n times.
Interpretation: The following two experiments are completely equivalent: one is to
play the same game until one observes success for the nth time. The other experiment
is, after each success to start a new game, until one observes success in the nth (and
last) game. Here we assume that all n games are executed independently and possess
the same success probability.
Let U and V be two independent random variables, both uniformly distributed on
[0, 1]. Which distribution density does U + V possess?
Proposition 4.6.10. The sum of two independent random variables U and V, uniformly
distributed on [0, 1], has the density r defined by
r(x) =
{
{
{
{
{
{
{
x
if 0 ≤x < 1,
2 −x
if 1 ≤x ≤2,
0
otherwise .
(4.30)
Proof. The distribution densities p and q of U and V are given by p(x) = q(x) = 1 if
0 ≤x ≤1 and p(x) = q(x) = 0 otherwise. Proposition 4.5.15 asserts that U +V has density
r = p ⋆q computed by
r(x) =
∞
∫
−∞
p(x −y) q(y) dy =
1
∫
0
p(x −y) dy .
But p(x −y) = 1 if and only if 0 ≤x −y ≤1 or, equivalently, if and only if x −1 ≤y ≤x.
Taking into account the restriction 0 ≤y ≤1, it follows that p(x −y)q(y) = 1 if and only

4.6 Sums of certain random variables
౪
217
if y ∈[max{x −1, 0}, min{x, 1}]. In particular, r(x) = 0 for x ∉[0, 2], and if 0 ≤x ≤2, then
r(x) = min{x, 1} −max{x −1, 0} .
It is not difficult to see (treat the cases 0 ≤x ≤1 and 1 ≤x ≤2 separately) that r(x) may
be written as stated in eq. (4.30). This completes the proof.
Application. Suppose we choose independently and according to the uniform distribu-
tion two numbers u1 and u2 in [0, 1]. Then the probability that a ≤u1 + u2 ≤b equals
∫
b
a r(x) dx with r given by eq. (4.30). For example (see Figure 4.5),
ℙ{1
2 ≤u1 + u2 ≤3
2} =
1
∫
1/2
x dx +
3/2
∫
1
(2 −x) dx = 3
4 .
Figure 4.5: The area of the gray-shaded set equals ℙ{1/2 ≤U + V ≤3/2}. Here the random variables U and
V are independent and both uniformly distributed on [0, 1].
We investigate now the sum of two gamma distributed random variables. Recall that
the density of a Γα,β-distributed random variable is given by
pα,β(x) =
1
αβ Γ(β) xβ−1 e−x/α
if x > 0, while pα,β(x) = 0 otherwise.
Proposition 4.6.11. Let X1 and X2 be two independent random variables distributed ac-
cording to Γα,β1 and Γα,β2, respectively. Then X1 + X2 is Γα,β1+β2-distributed.
Proof. If r denotes the density of X1 + X2, Proposition 4.5.15 implies
r(x) = (pα,β1 ⋆pα,β2)(x) =
∞
∫
−∞
pα,β1(x −y)pα,β2(y) dy ,
x ∈ℝ,
(4.31)
and we have to show that r = pα,β1+β2.

218
౪
4 Operations on random variables
It is easy to see that r(x) = 0 if x ≤0, hence it suffices to evaluate eq. (4.31) for x > 0.
Since pα,β2(x −y) = 0 if y > x,
r(x) =
1
αβ1+β2Γ(β1)Γ(β2)
x
∫
0
yβ1−1(x −y)β2−1 e−y/α e−(x−y)/α dy
=
1
αβ1+β2Γ(β1)Γ(β2) xβ1+β2−2 e−x/α
x
∫
0
( y
x )
β1−1
(1 −y
x )
β2−1
dy .
Changing the variable as u := y/x, hence dy = x du, we obtain
r(x) =
1
αβ1+β2Γ(β1)Γ(β2) xβ1+β2−1 e−x/α
1
∫
0
uβ1−1(1 −u)β2−1du
=
B(β1, β2)
αβ1+β2 Γ(β1) Γ(β2) ⋅xβ1+β2−1 e−x/α ,
(4.32)
where B denotes the beta function defined by eq. (1.61). Equation (1.62) yields
B(β1, β2)
Γ(β1) Γ(β2) =
1
Γ(β1 + β2) ,
(4.33)
hence, if x > 0, then, from eqs. (4.32) and (4.33), it follows that r(x) = pα,β1+β2(x). This
completes the proof.
Recall that the Erlang distribution is defined as Eλ,n = Γλ−1,n. Thus, Proposition 4.6.11
implies the following corollary.
Corollary 4.6.12. Let X and Y be independent and distributed according to Eλ,n and Eλ,m,
respectively. Then their sum X + Y is Eλ,n+m-distributed.
Another corollary of Proposition 4.5.15 (or of Corollary 4.6.12) describes the sum of
independent exponentially distributed random variables.
Corollary 4.6.13. Let X1, . . . , Xn be independent Eλ-distributed random variables. Then
their sum X1 + ⋅⋅⋅+ Xn is Erlang distributed with parameters λ and n.
Proof. Recall that Eλ = Eλ,1. By Corollary 4.6.12, the sum X1 + X2 is distributed according
to Eλ,2. Proceeding in this way, every time applying Corollary 4.6.12 leads to the desired
result.
Example 4.6.14. The lifetime of light bulbs is assumed to be Eλ-distributed for a certain
λ > 0. At time zero, we switch on the first bulb. At the moment it burns out, we replace
it by the second one of the same type. If the second burns out, we replace it by the third,
and so on. Let Sn be the moment when the nth light bulb burns out. Which distribution
does Sn possess?

4.6 Sums of certain random variables
౪
219
Answer: Let X1, X2, . . . be the lifetimes of the first, second, and so on, light bulb. Then
Sn = X1 + ⋅⋅⋅+ Xn. Since the light bulbs are assumed to be of the same type, the random
variables Xj are all Eλ-distributed. Furthermore, the different lifetimes do not influence
each other, thus, we may assume that the Xjs are independent. Now Corollary 4.6.13 lets
us conclude that Sn is Erlang distributed with parameters λ and n, hence, if t > 0, by
Proposition 1.6.26, we get
ℙ{Sn ≤t} =
λn
(n −1)!
t
∫
0
xn−1 e−λx dx = 1 −
n−1
∑
j=0
(λt)j
j!
e−λt .
(4.34)
Example 4.6.15. We continue the preceding example, but ask now a different question.
How often do we have to change light bulbs before some given time T > 0?
Answer: Let Y be the number of changes necessary until time T. Then for n ≥0 the
event {Y = n} occurs if and only if Sn ≤T, but Sn+1 > T. Hereby, we use the notation of
Example 4.6.14. In other words,
ℙ{Y = n} = ℙ{Sn ≤T, Sn+1 > T} = ℙ({Sn ≤T} \ {Sn+1 ≤T}) ,
n = 0, 1, . . .
Since {Sn+1 ≤T} ⊆{Sn ≤T}, from eq. (4.34) it follows that
ℙ{Y = n} = ℙ{Sn ≤T} −ℙ{Sn+1 ≤T}
= [1 −
n−1
∑
j=0
(λT)j
j!
e−λT] −[1 −
n
∑
j=0
(λT)j
j!
e−λT]
= (λT)n
n!
e−λT = PoisλT({n}) .
Summing up, the number of necessary replacements of burned out light bulbs until time
T > 0 is Poisson distributed with parameter λT where 1/λ > 0 is the average lifetime of
a single bulb (compare with Example 5.1.30).
Let us still mention an important equivalent random “experiment”: customers ar-
rive at the post office randomly. We assume that the times between their arrivals are in-
dependent and Eλ-distributed. Then Sn is the time when the nth customer arrives. Hence,
under these assumptions, the number of arriving customers until a certain time T > 0
is Poisson distributed with parameter λT.
We investigate now the sum of two independent chi-squared distributed random
variables. Recall Definition 1.6.27: A random variable X is χ2
n-distributed if it is Γ2, n
2 -
distributed. Hence, Proposition 4.6.11 implies the following result.
Proposition 4.6.16. Suppose that X is χ2
n-distributed and that Y is χ2
m-distributed for some
n, m ≥1. If X and Y are independent, then X + Y is χ2
n+m-distributed.
Proof. Because of Proposition 4.6.11, the sum X + Y is Γ2, n
2 + m
2 = χ2
n+m-distributed. This
proves the assertion.

220
౪
4 Operations on random variables
Proposition 4.6.16 has the following important consequence.
Proposition 4.6.17. Let X1, . . . , Xn be a sequence of independent 𝒩(0, 1)-distributed ran-
dom variables. Then X2
1 + ⋅⋅⋅+ X2
n is χ2
n-distributed.
Proof. Proposition 4.1.5 asserts that the random variables X2
j are χ2
1-distributed. Further-
more, because of Proposition 4.1.9, they are also independent. Thus successive applica-
tion of Proposition 4.6.16 proves the assertion.
Our next and final aim in this section is to investigate the distribution of the sum of
two independent normally distributed random variables. Here the following important
result is valid.
Proposition 4.6.18. Let X1 and X2 be two independent random variables distributed ac-
cording to 𝒩(μ1, σ2
1) and 𝒩(μ2, σ2
2). Then X1 + X2 is 𝒩(μ1 + μ2, σ2
1 + σ2
2)-distributed.
Proof. In the first step, we treat a special case, namely μ1 = μ2 = 0 and σ1 = 1. To simplify
the notation, set λ = σ2. Thus we have to prove the following: if X1 and X2 are 𝒩(0, 1)-
and 𝒩(0, λ2)-distributed, then X1 + X2 is 𝒩(0, 1 + λ2)-distributed.
Let p0,1 and p0,λ2 be the corresponding densities introduced in eq. (1.49). Then we
have to prove that
p0,1 ⋆p0,λ2 = p0,1+λ2 .
(4.35)
To verify this start with
(p0,1 ⋆p0,λ2)(x) =
1
2π λ
∞
∫
−∞
e−(x−y)2/2 e−y2/2λ2
dy
=
1
2π λ
∞
∫
−∞
e−1
2 (x2−2xy+(1+λ−2)y2) dy .
(4.36)
We use
x2 −2xy + (1 + λ−2) y2
= ((1 + λ−2)
1/2y −(1 + λ−2)
−1/2 x)
2 −x2(
1
1 + λ−2 −1)
= ((1 + λ−2)
1/2y −(1 + λ−2)
−1/2 x)
2 +
x2
1 + λ2
= (αy −x
α)
2
+
x2
1 + λ2
with α := (1 + λ−2)1/2. Plugging this transformation into eq. (4.36) leads to

4.6 Sums of certain random variables
౪
221
(p0,1 ⋆p0,λ2)(x) = e−x2/2(1+λ2)
2π λ
∞
∫
−∞
e−(αy−x
α )2/2 d y .
(4.37)
Next change the variables by u := αy −x/α, thus, d y = d u/α, and observe that
αλ = (1 + λ2)1/2. Then the right-hand side of eq. (4.37) transforms to
(p0,1 ⋆p0,λ2)(x) =
e−x2/2(1+λ2)
2π (1 + λ2)1/2
∞
∫
−∞
e−u2/2 du = p0,1+λ2(x) .
Hereby, we used Proposition 1.6.7 asserting ∫
∞
−∞e−u2/2 du = √2π. This proves the validity
of eq. (4.35).
In the second step, we treat the general case, that is, X1 is 𝒩(μ1, σ2
1 )- and X2 is
N(μ2, σ2
2)-distributed. Set
Y1 := X1 −μ1
σ1
and
Y2 := X2 −μ2
σ2
.
By Proposition 4.2.3, the random variables Y1 and Y2 are standard normal and, moreover,
because of Proposition 4.1.9, also independent. Thus, the sum X1+X2 may be represented
as
X1 + X2 = μ1 + μ2 + σ1Y1 + σ2Y2 = μ1 + μ2 + σ1 Z,
where Z = Y1 + λY2 with λ = σ2/σ1.
An application of the first step shows that Z is 𝒩(0, 1 + λ2)-distributed. Hence,
Proposition 4.2.3 implies the existence of a standard normally distributed Z0 such that
Z = (1 + λ2)1/2Z0. Summing up, X1 + X2 may now be written as
X1 + X2 = μ1 + μ2 + σ1 (1 + λ2)
1/2 Z0 = μ1 + μ2 + (σ2
1 + σ2
2)
1/2 Z0 ,
and another application of Proposition 4.2.3 lets us conclude that, as asserted, the sum
X1 + X2 is 𝒩(μ1 + μ2, σ2
1 + σ2
2)-distributed.
Summary: Let X and Y be independent random variables. As we agreed upon in Remark 3.3.1, by “∼” we
mean that X, Y, and X + Y posses the stated distribution. Then the following are valid:
1.
X ∼Bm,p and Y ∼Bn,p
⇒
X + Y ∼Bm+n,p.
2.
X ∼Poisλ and Y ∼Poisμ
⇒
X + Y ∼Poisλ+μ.
3.
X ∼B−
m,p and Y ∼B−
n,p
⇒
X + Y ∼B−
m+n,p.
4.
X ∼Γα,β1 and Y ∼Γα,β2
⇒
X + Y ∼Γα,β1+β2.
5.
X ∼Eλ,m and Y ∼Eλ,n
⇒
X + Y ∼Eλ,m+n.
6.
X ∼χ2
m and Y ∼χ2
n
⇒
X + Y ∼χ2
m+n.
7.
X ∼𝒩(μ1, σ2
1 ) and Y ∼𝒩(μ2, σ2
2)
⇒
X + Y ∼𝒩(μ1 + μ2, σ2
1 + σ2
2).
8.
X1, . . . , Xn independent and 𝒩(0, 1)-distributed
⇒
X2
1 + ⋅⋅⋅+ X2
n ∼χ2
n.

222
౪
4 Operations on random variables
4.7 Products and quotients of random variables
Let X and Y be two random variables mapping a sample space Ω into ℝ. Then their
product X ⋅Y and their quotient X/Y (assume Y(ω)
̸= 0 for ω ∈Ω) are defined by
(X ⋅Y)(ω) := X(ω) ⋅Y(ω)
and
(X
Y )(ω) := X(ω)
Y(ω) ,
ω ∈Ω .
The aim of this section is to investigate the distribution of such products and quotients.
We restrict ourselves to continuous X and Y because, later on, we will only deal with
products and quotients of those random variables. Furthermore, we omit the proof of
the fact that products and fractions are random variables as well. The proofs of these
permanent properties are not complicated and follow the ideas used in the proof of
Proposition 4.5.1. Thus, our interest are products X⋅Y and quotients X/Y for independent
X and Y, where, to simplify the computations, we suppose ℙ{Y > 0} = 1.
We start with the investigation of products of continuous random variables. Thus, let
X and Y be two random variables with distribution densities p and q. Since we assumed
ℙ{Y > 0} = 1, we may choose the density q such that q(x) = 0 if x ≤0.
Proposition 4.7.1. Let X and Y be two independent random variables possessing the
stated properties. Then X ⋅Y is continuous as well, and its density r may be calculated by
r(x) =
∞
∫
0
p(x
y ) q(y)
y
dy ,
x ∈ℝ.
(4.38)
Proof. For t ∈ℝ, we evaluate ℙ{X ⋅Y ≤t}. To this end, fix t ∈ℝand set
At := {(u, y) ∈ℝ× (0, ∞) : u ⋅y ≤t} .
(4.39)
As in the proof of Proposition 4.5.15, it follows that
ℙ{X ⋅Y ≤t} = ℙ(X,Y)(At) =
∞
∫
0
[
t/y
∫
−∞
p(u) du] q(y) dy .
(4.40)
In the inner integral of eq. (4.40), we change the variables by x = uy, hence we get
dx = y du. Notice that in the inner integral y is a constant. After this change of variables,
the right-hand integral in eq. (4.40) becomes15
∞
∫
0
[
t
∫
−∞
p(x
y ) dx]q(y)
y
dy =
t
∫
−∞
[
∞
∫
0
p(x
y )q(y)
y
dy] dx =
t
∫
−∞
r(x) dx .
This being valid for all t ∈ℝ, the function r is a density of X ⋅Y.
15 The interchange of the integrals is justified by Proposition A.5.5. Note that p and q are nonnegative.

4.7 Products and quotients of random variables
౪
223
Example 4.7.2. Let U and V be two independent random variables uniformly dis-
tributed on [0, 1]. Which probability distribution does U ⋅V possess?
Answer: We have p(y) = q(y) = 1 if 0 ≤y ≤1, and p(y) = q(y) = 0 otherwise.
Furthermore, 0 ≤U ⋅V ≤1, hence its density r satisfies r(x) = 0 if x ∉[0, 1]. For
x ∈[0, 1], we apply formula (4.38) and obtain (see Figure 4.6)
r(x) =
∞
∫
0
p(x
y ) q(y)
y
dy =
1
∫
x
1
y dy = −ln(x) = ln( 1
x ) ,
0 < x ≤1 .
(4.41)
Figure 4.6: The density r of U ⋅V given by eq. (4.41).
Consequently, if 0 < a < b ≤1, then
ℙ{a ≤U ⋅V ≤b} = −
b
∫
a
ln(x) dx = −[x ln x −x]b
a = a ln(a) −b ln(b) + b −a .
In particular, it follows that
vol2(Bt) = ℙ{U ⋅V ≤t} = t −t ln t ,
0 < t ≤1 .
(4.42)
Here Bt is defined as in Fig. 4.7. That is,
Bt = {(u, y) ∈[0, 1]2 : u y ≤t} ,
0 ≤t ≤1 .
In other words, Bt = At ∩[0, 1]2 with At defined by eq. (4.39). Furthermore, the random
vector (U, V) is uniformly distributed on [0, 1]2, so we get
ℙ{(U, V) ∈At} = ℙ{(U, V) ∈Bt} = vol2(Bt) .

224
౪
4 Operations on random variables
Figure 4.7: The set Bt = {(u, y) ∈[0, 1]2 : u y ≤t} for a given 0 < t < 1.
Our next objective are quotients of random variables X and Y. We denote their den-
sities by p and q, thereby assuming q(x) = 0 if x ≤0. Then we get
Proposition 4.7.3. Let X and Y be independent with ℙ{Y > 0} = 1. Then their quotient
X/Y has the density r given by
r(x) =
∞
∫
0
y p(x y) q(y) dy ,
x ∈ℝ.
Proof. The proof of Proposition 4.7.3 is similar to that of Proposition 4.7.1. Therefore, we
present only the main steps. Setting now
At := {(u, y) ∈ℝ× (0, ∞) : u ≤t y} ,
we obtain
ℙ{(X/Y) ≤t} = ℙ(X,Y)(At) =
∞
∫
0
[
ty
∫
−∞
p(u) du] q(y) dy .
(4.43)
We change the variables in the inner integral of eq. (4.43) by putting x = u/y. After
that, we interchange the integrals and arrive at
ℙ{(X/Y) ≤t} =
t
∫
−∞
r(x) dx
for all t ∈ℝ. This proves that r is the density of X/Y.
Example 4.7.4. Let U and V be as in Example 4.7.2. We investigate now their quotient
U/V. By Proposition 4.7.3, its density r can be computed by
r(x) =
∞
∫
0
y p(xy)q(y) dy =
1
∫
0
yp(xy)dy =
1
∫
0
y dy = 1
2

4.7 Products and quotients of random variables
౪
225
in the case 0 ≤x ≤1. If 1 ≤x < ∞, then p(xy) = 0 if y > 1/x, and it follows that
r(x) =
1/x
∫
0
y dy =
1
2x2
for those x. Combining both cases, the density r of U/V may be written as (see Figure 4.8)
r(x) =
{
{
{
{
{
{
{
{
{
1
2
if 0 ≤x ≤1,
1
2x2
if 1 < x < ∞,
0
otherwise .
(4.44)
Figure 4.8: The density r defined by eq. (4.44).
Question: Does there exist an easy geometric explanation for r(x) =
1
2 in the case
0 ≤x ≤1?
Answer: If t > 0, then
FU/V(t) = ℙ{U/V ≤t} = ℙ{U ≤t V} = ℙ(U,V)(Bt) ,
where now
Bt := {(u, v) ∈[0, 1]2 : 0 ≤u ≤v t} .
(4.45)
If 0 < t ≤1, then Bt is a triangle in [0, 1]2 with area vol2(Bt) = t
2. The independence of U
and V implies (cf. Example 3.6.23) that ℙ(U,V) is the uniform distribution on [0, 1]2, hence
FU/V(t) = ℙ(U,V)(Bt) = vol2(Bt) = t
2 ,
0 < t ≤1 ,

226
౪
4 Operations on random variables
leading to r(t) = F′
U/V(t) = 1
2 for those t. See Figure 4.9 for a geometric explanation of
this fact.
Figure 4.9: The set Bt, defined in eq. (4.45). Here 0 ≤t ≤1 in the left-hand figure, and 1 < t < ∞in the
right-hand one. The area of Bt is either t
2 or 1 −1
2t , respectively.
4.7.1 Student’s t-distribution
Let us use Proposition 4.7.3 to compute the density of a distribution which plays a crucial
role in Mathematical Statistics.
Proposition 4.7.5. Let X be 𝒩(0, 1)-distributed and Y be independent of X and χ2
n-dis-
tributed for some n ≥1. Define the random variable Z as
Z :=
X
√Y/n
.
Then Z possesses the density r given by (see Figure 4.10 for the graphs of these functions
in the cases n = 1,, n = 2, and n = 8)
r(x) =
Γ( n+1
2 )
√n π Γ( n
2 ) (1 + x2
n )
−n/2 −1/2
,
x ∈ℝ.
(4.46)
Proof. In the first step, we determine the density of √Y with Y distributed according
to χ2
n. If t > 0, then
F√Y(t) = ℙ{√Y ≤t} = ℙ{Y ≤t2} =
1
2n/2 Γ( n
2 )
t2
∫
0
xn/2 −1 e−x/2 dx .
Thus, if t > 0, then the density q of √Y equals
q(t) = d
dt F√Y(t) =
1
2n/2 Γ( n
2 ) (2t) tn−2 e−t2/2 =
1
2n/2 −1 Γ( n
2 ) tn−1 e−t2/2 .
(4.47)

4.7 Products and quotients of random variables
౪
227
Figure 4.10: From bottom to top, these are the densities of t1, t2, and t8 distributions.
Of course, we have q(t) = 0 if t ≤0.
In the second step, we determine the density ̃r of ̃Z = Z/√n = X/√Y. An application
of Proposition 4.7.3 for p(x) =
1
√2π e−x/2 and q given in eq. (4.47) leads to
̃r(x) =
∞
∫
0
y[
1
√2π
e−(xy)2/2][
1
2n/2 −1 Γ( n
2 ) yn−1 e−y2/2] dy
=
1
√π 2n/2 −1/2 Γ( n
2 )
∞
∫
0
yn e−(1+x2)y2/2 dy .
(4.48)
Change the variables in the last integral by setting v = y2
2 (1 + x2). Then y =
√2v
(1+x2)1/2
and, consequently, dy =
1
√2 v−1/2 (1 + x2)−1/2 dv. Inserting this into eq. (4.48) shows that
̃r(x) =
1
√π 2n/2 Γ( n
2 )
∞
∫
0
2n/2 vn/2 −1/2 e−v
(1 + x2)n/2 +1/2 dv
=
Γ( n+1
2 )
√π Γ( n
2 ) (1 + x2)
−n/2 −1/2 .
(4.49)
In the third step, we finally obtain the density r of Z. Since Z = √n ̃Z, formula (4.3)
applies with b = 0 and a = √n. Thus, by eq. (4.49) for ̃r, as asserted,
r(x) =
1
√n
̃r( x
√n) =
Γ( n+1
2 )
√n π Γ( n
2 ) (1 + x2
n )
−n/2 −1/2
.

228
౪
4 Operations on random variables
Definition 4.7.6. The probability measure on (ℝ, ℬ(ℝ)) with density r, given by eq. (4.46), is called the
tn-distribution or Student’s t-distribution with n degrees of freedom. A random variable Z is said to
be tn-distributed (or t-distributed with n degrees of freedom), provided its probability distribution is a
tn-distribution, that is, for a < b,
ℙ{a ≤Z ≤b} =
Γ( n+1
2 )
√n π Γ( n
2 )
b
∫
a
(1 + x2
n )
−n/2 −1/2
dx .
Remark 4.7.7. The t1-distribution coincides with the Cauchy distribution introduced in
Section 1.6.8. Observe that Γ(1/2) = √π and Γ (1) = 1.
In view of Definition 4.7.6, we may now formulate Proposition 4.7.5 as follows.
Proposition 4.7.8. If X and Y are independent and 𝒩(0, 1) and χ2
n distributed, then
X
√Y/n
is tn-distributed.
Proposition 4.6.17 leads still to another version of Proposition 4.7.5.
Proposition 4.7.9. If X, X1, . . . , Xn are independent 𝒩(0, 1)-distributed, then
X
√1
n ∑n
i=1 X2
i
is tn-distributed.
Corollary 4.7.10. If X and Y are independent and 𝒩(0, 1)-distributed, then X/|Y| pos-
sesses a Cauchy distribution.
Proof. An application of Proposition 4.7.9 with n = 1 and X1 = Y implies that X/|Y| is
t1-distributed. We saw in Remark 4.7.7 the t1 and the Cauchy distributions coincide, thus,
X/|Y| is also Cauchy distributed.
4.7.2 F-distribution
We present now another important class of probability measures or probability distri-
butions playing a central role in Mathematical Statistics.
Proposition 4.7.11. For two natural numbers m and n, let X and Y be independent and
χ2
m- and χ2
n-distributed. Then Z := X/m
Y/n has the distribution density r defined by
r(x) =
{
{
{
0
if x ≤0,
mm/2 nn/2 ⋅
Γ( m+n
2 )
Γ( m
2 )Γ( n
2 ) ⋅
xm/2−1
(mx+n)(m+n)/2
if x > 0.
(4.50)
Proof. We first evaluate the density ̃r of ̃Z = X/Y. To this end, we apply Proposition 4.7.3
with functions p and q given by

4.7 Products and quotients of random variables
౪
229
p(x) =
1
2m/2 Γ(m/2) xm/2 −1 e−x/2
and
q(y) =
1
2n/2 Γ(n/2) yn/2 −1 e−y/2
whenever x, y > 0. Then we get
̃r(x) =
1
2(m+n)/2 Γ(m/2) Γ(n/2)
∞
∫
0
y (xy)m/2 −1 yn/2 −1 e−xy/2 e−y/2 dy
=
xm/2 −1
2(m+n)/2 Γ(m/2) Γ(n/2)
∞
∫
0
y(m+n)/2 −1 e−y(1+x)/2 dy .
(4.51)
We replace in eq. (4.51) the variable y by u = y(1 + x)/2, thus, dy =
2
1+x du. Inserting
this into eq. (4.51), the last expression transforms to
̃r(x) =
xm/2 −1
Γ(m/2) Γ(n/2) (1 + x)−(n+m)/2
∞
∫
0
u(m+n)/2 −1 e−u du
=
Γ( m+n
2 )
Γ( m
2 )Γ( n
2 ) ⋅
xm/2 −1
(1 + x)(m+n)/2 .
Because of Z = n
m ⋅̃Z, we obtain the density r of Z by Proposition 1.7.21. Indeed, then
r(x) = m
n
̃r(mx
n ) = mm/2 nn/2 ⋅
Γ( m+n
2 )
Γ( m
2 )Γ( n
2 ) ⋅
xm/2 −1
(mx + n)(m+n)/2 ,
as asserted.
Remark 4.7.12. Using relation (1.62) between the beta and gamma functions, the density
r of Z may also be written as
r(x) = mm/2 nn/2
B( m
2 , n
2 ) ⋅
xm/2 −1
(mx + n)(m+n)/2 ,
x > 0 .
For the behavior of r(x) as x →0, we refer to Problem 4.17. For certain parameters m
and n the graphs of these densities can be found in Figure 4.11.
Definition 4.7.13. The probability measure on (ℝ, ℬ(ℝ)) with density r defined by eq. (4.50) is called the
Fisher–Snecedor distribution or F-distribution (with m and n degrees of freedom).
A random variable Z is F-distributed (with m and n degrees of freedom), provided its probability
distribution is an F-distribution. Equivalently, if 0 ≤a < b, then
ℙ{a ≤Z ≤b} = mm/2 nn/2 ⋅
Γ( m+n
2 )
Γ( m
2 )Γ( n
2 )
b
∫
a
xm/2 −1
(mx + n)(m+n)/2 dx .
The random variable Z is also said to be Fm,n-distributed.

230
౪
4 Operations on random variables
Figure 4.11: Densities of F2,3 , F3,1, and F4,6 distributed random variables.
With this notation, Proposition 4.7.11 may now be formulated as follows:
Proposition 4.7.14. If two independent random variables X and Y are χ2
m and χ2
n dis-
tributed, then X/m
Y/n is Fm,n-distributed.
Finally, Proposition 4.6.17 implies the following version of the previous result.
Proposition 4.7.15. Let X1, . . . , Xm, Y1, . . . , Yn be independent 𝒩(0, 1)-distributed. Then
Z = (X2
1 + ⋅⋅⋅+ X2
m)/m
(Y 2
1 + ⋅⋅⋅+ Y 2
n)/n =
1
m ∑m
i=1 X2
i
1
n ∑n
j=1 Y 2
j
is Fm,n-distributed.
Corollary 4.7.16. If a random variable Z is Fm,n-distributed, then 1/Z possesses an Fn,m
distribution.
Proof. This is an immediate consequence of Proposition 4.7.11.
Summary: A random variable X is tn-distributed provided that for all a < b we have
ℙ{a ≤X ≤b} =
Γ( n+1
2 )
√n π Γ( n
2 )
b
∫
a
(1 + x2
n )
−n/2 −1/2
dx .
If X, X1, . . . , Xn are independent 𝒩(0, 1)-distributed, then
X
√1
n ∑n
i=1 X2
i
is tn-distributed.
A random variable X is Fm,n-distributed if, whenever 0 ≤a < b < ∞, one has

4.8 Problems
౪
231
ℙ{a ≤X ≤b} = mm/2 nn/2 ⋅
Γ( m+n
2 )
Γ( m
2 )Γ( n
2 )
b
∫
a
xm/2 −1
(mx + n)(m+n)/2 dx .
If X1, . . . , Xm, Y1, . . . , Yn are independent 𝒩(0, 1)-distributed, then
1
m ∑m
i=1 X2
i
1
n ∑n
j=1 Y2
j
is Fm,n-distributed.
4.8 Problems
Problem 4.1. Let U be uniformly distributed on [0, 1]. Which distributions do the fol-
lowing random variables possess:
min{U, 1 −U},
max{U, 1 −U},
|2U −1|,
and
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
U −1
3
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
?
Problem 4.2 (Generating functions). Let X be a random variable with values in ℕ0. For
k ∈ℕ0, let pk = ℙ{X = k}. Then its generating function φX is defined by
φX(t) =
∞
∑
k=0
pk tk .
1.
Show that φX(t) exists if |t| ≤1.
2.
Let X and Y be two independent random variables with values in ℕ0. Prove that
then
φX+Y = φX ⋅φY .
3.
Compute φX in each of the following cases:
(a) X is uniformly distributed on {1, . . . , N} for some N ≥1.
(b) X is Bn,p-distributed for some n ≥1 and p ∈[0, 1].
(c) X is Poisλ-distributed for some λ > 0.
(d) X is Gp-distributed for a certain 0 < p < 1.
(e) X is B−
n,p-distributed.
Problem 4.3. Roll two dice simultaneously. Let X be the result of the first die and Y that
of the second. Is it possible to falsify these two dice in such a way that X +Y is uniformly
distributed on {2, . . . , 12}? It is not assumed that both dice are falsified in the same way.
Hint: One possible way to answer this question is as follows: investigate the gener-
ating functions of X and Y and compare their product with the generating function of
the uniform distribution on {2, . . . , 12}.
Problem 4.4. Let X1, . . . , Xn be a sequence of independent identically distributed ran-
dom variables with common distribution function F and distribution density p, that is,

232
౪
4 Operations on random variables
ℙ{Xj ≤t} = F(t) =
t
∫
−∞
p(x) dx ,
j = 1, . . . , n .
Define random variables X∗and X∗by
X∗:= min{X1, . . . , Xn}
and
X∗:= max{X1, . . . , Xn} .
1.
Determine the distribution functions and densities of X∗and X∗directly, that is,
without using general results about order statistics.
2.
Describe the distribution of the random variables X∗and X∗in the case that the Xjs
are exponentially distributed with parameter λ > 0.
3.
Suppose now the Xjs are uniformly distributed on [0, 1]. Describe the distribution
of X∗and X∗in this case.
Problem 4.5. Let F be the distribution function of the uniform distribution on {1, . . . , N}
for some N ∈ℕ. Determine its pseudoinverse function F−. Do the same if F is either
the distribution function of a binomial or a Poisson distribution. Given U uniformly
distributed on [0, 1], how is F−(U) distributed in each of these cases?
Problem 4.6. Find a function f from (0, 1) to ℝsuch that
ℙ{f (U) = k} = 1
2k ,
k = 1, 2, . . .
for U uniformly distributed on [0, 1].
Problem 4.7. Let U be uniform distributed on [0, 1]. Find functions f and g such that
X = f (U) and Y = g(U) have the distribution densities p and q with
p(x) := {0
if x ∉(0, 1],
x−1/2
2
if x ∈(0, 1]
and
q(x) :=
{
{
{
{
{
{
{
0
if |x| > 1,
x + 1
if −1 ≤x ≤0,
1 −x
if 0 < x ≤1.
Problem 4.8. Let X and Y be independent random variables with
ℙ{X = k} = ℙ{Y = k} = 1
2k ,
k = 1, 2, . . .
How is X + Y distributed?
Problem 4.9. The number of customers visiting a shop per day is Poisson distributed
with parameter λ > 0. The probability that a single customer buys something equals p
for a given 0 ≤p ≤1. Let X be the number of customers per day buying some goods.
Determine the distribution of X.

4.8 Problems
౪
233
Remark: We assume that the decision whether or not a single customer buys some-
thing is independent of the number of daily visitors.
A different way to formulate the above question is as follows: let X0, X1, . . . be inde-
pendent random variables with ℙ{X0 = 0} = 1,
ℙ{Xj = 1} = p,
and
ℙ{Xj = 0} = 1 −p ,
j = 1, 2, . . . ,
for a certain p ∈[0, 1]. Furthermore, let Y be a Poisson-distributed random variable with
parameter λ > 0, independent of the Xjs. Determine the distribution of
X :=
Y
∑
j=0
Xj .
Hint: Use the “infinite” version of the law of total probability as stated in Problem 2.5.
Problem 4.10. Suppose X and Y are independent and exponentially distributed with
parameter λ > 0. Find the distribution densities of X −Y and X/Y.
Problem 4.11. Two random variables U and V are independent and uniformly dis-
tributed on [0, 1]. Given n ∈ℕ, find the distribution density of U + nV.
Problem 4.12. Let X and Y be independent random variable distributed according to
Poisλ and Poisμ, respectively. Given n ∈ℕ0 and some k ∈{0, . . . , n}, prove
ℙ{X = k | X + Y = n} = (n
k) (
λ
λ + μ)
k
(
μ
λ + μ)
n−k
= Bn,p({k})
with p =
λ
λ+μ.
Reformulation of the preceding problem: An owner of two stores, say store A and
store B, observes that the number of customers in each of these stores is independent
and Poisλ and Poisμ distributed. One day he was told that there were n customers in both
stores together. What is the probability that k of the n customers were in store A, hence
n −k in store B?
Problem 4.13. Let X and Y be independent standard normal variables. Show that X/Y
is Cauchy distributed.
Hint: Use Corollary 4.7.10 and the fact that the vectors (X, Y), (−X, Y), (X, −Y), and
(−X, −Y) are identically distributed. Note that the probability distribution of each of
these two-dimensional vectors is the (two-dimensional) standard normal distribution.
Problem 4.14. Let X and Y be independent Gp-distributed. Find the probability distri-
bution of X −Y.
Hint: Compare with Example 4.5.5. There we evaluated the distribution of X −Y in
the case p = 1
2.

234
౪
4 Operations on random variables
Problem 4.15. Let U and V be independent random variables, both uniformly dis-
tributed on [−1, 1]. Determine the density of U ⋅V.
Hint: Use the technique presented in Example 4.7.2 and its geometric explanation
in Figure 4.7. To this end, treat the cases UV > 0 and UV ≤0 separately.
Problem 4.16. Suppose X is a random variable with values in (a, b) ⊆ℝand with den-
sity p. Let f from (a, b) →ℝbe (strictly) monotone and differentiable. Give a formula
for q, the density of f (X).
Use your result to evaluate the densities of eX and e−X where X is distributed ac-
cording to 𝒩(0, 1).
Problem 4.17. Let r be the density of an Fm,n-distributed random variable given by
eq. (4.50). Argue why r(x) →∞as x →0 if m = 1 and n ≥1. Why do we have r(0) = 1 if
m = 2 and n ≥1? Evaluate r(0) if n = 1, 2, . . . and m ≥3.

5 Expected value, variance, and covariance
5.1 Expected value
5.1.1 Expected value of discrete random variables
What is an expected value (also called mean value or expectation) of a random variable?
How is it defined? Which property of the random variable does it describe and how it
can be computed? Does every random variable possess an expected value? To answer
these questions, let us start with an example.
Example 5.1.1. Suppose N students attend a certain exam. The number of possible
points is 100. Given j = 0, 1, . . . , 100, let nj be the number of students who achieved j
points. Now choose randomly, according to the uniform distribution (a single student
is chosen with probability 1/N), one student. Name him or her ω, and define X(ω) as
the number of points that the chosen student achieved. Then X is a random variable
with values in D = {0, 1, . . . , 100}. How is X distributed? Since X has values in D, its
distribution is described by the probabilities
pj = ℙ{X = j} =
nj
N ,
j = 0, 1, . . . , 100 .
(5.1)
As expected value of X, we take the average number A of points in this exam. How is A
evaluated? The easiest way to do this is
A = 1
N
100
∑
j=0
j ⋅nj =
100
∑
j=0
j ⋅
nj
N =
100
∑
j=0
j ⋅pj ,
where the pjs are defined by eq. (5.1). If we write 𝔼X for the expected value (or mean
value) of X, and if we assume that this value coincides with A, then the preceding equa-
tion says
𝔼X =
100
∑
j=0
j pj =
100
∑
j=0
j ℙ{X = j} =
100
∑
j=0
xj ℙ{X = xj} ,
where the xj = j with j = 0, . . . , 100 denote the possible values of X.
In view of this example, the following definition for the expected value of a dis-
crete random variable X looks feasible. Suppose X has values in D = {x1, x2, . . . }, and let
pj = ℙ{X = xj}, j = 1, 2, . . . . Then the expected value 𝔼X of X is given by
𝔼X =
∞
∑
j=1
xj pj =
∞
∑
j=1
xj ℙ{X = xj} .
(5.2)
Unfortunately, the sum in eq. (5.2) does not always exist. In order to overcome this diffi-
culty, let us recall some basic facts about infinite series of real numbers.
https://doi.org/10.1515/9783111325064-005

236
౪
5 Expected value, variance, and covariance
A sequence (αj)j≥1 of real numbers is called summable, provided its sequence of
partial sums (sn)n≥1 with sn = α1 + ⋅⋅⋅+ αn converges in ℝ. Then one defines
∞
∑
j=1
αj = lim
n→∞sn = lim
n→∞
n
∑
j=1
αj .
If the sequence of partial sums diverges, nevertheless, in some cases we may assign to
the infinite series a limit. If either limn→∞sn = −∞or limn→∞sn = ∞, then we write
∑∞
j=1 αj = −∞or ∑∞
j=1 αj = ∞, respectively. In particular, if αj ≥0 for j ∈ℕ, then the
sequence of partial sums is nondecreasing, which implies that only two different cases
may occur: Either ∑∞
j=1 αj < ∞(in this case the sequence is summable) or ∑∞
j=1 αj = ∞.
Let (αj)j≥1 be an arbitrary sequence of real numbers. If ∑∞
j=1 |αj| < ∞, then it is called
absolutely summable. Note that each absolutely summable sequence is summable.
This is a direct consequence of Cauchy’s convergence criterion. The converse implica-
tion is wrong, as can be seen by considering ((−1)n/n)n≥1.
Now we are prepared to define the expected value of a nonnegative random vari-
able.
Definition 5.1.2. Let X be a discrete random variable with values in {x1, x2, . . . } for some xj ≥0. Equiva-
lently, the random variable X is discrete with X ≥0. Then the expected value of X is defined by
𝔼X :=
∞
∑
j=1
xj ℙ{X = xj} .
(5.3)
Remark 5.1.3. Since xj ℙ{X = xj} ≥0 for nonnegative X, for those random variables
the sum in eq. (5.3) is always well defined, but may be infinite. That is, each nonnegative
discrete random variable X possesses an expected value 𝔼X ∈[0, ∞].
Let us now turn to the case of arbitrary (not necessarily nonnegative) random vari-
ables. The next example shows which problems may arise.
Example 5.1.4. We consider the probability measure introduced in Example 1.3.6 and
choose a random variable X with values in ℤdistributed according to the probability
measure in this example. In other words,
ℙ{X = k} = 3
π2
1
k2 ,
k ∈ℤ\{0} .
If we try to evaluate the expected value of X by formula (5.2), then this leads to the
undetermined expression
3
π2
∞
∑
k=−∞
k ̸=0
k
k2 = 3
π2 lim
n→∞
m→∞
n
∑
k=−m
1
k = 3
π2 [ lim
n→∞
n
∑
k=1
1
k + lim
m→∞
1
∑
k=−m
1
k ]
= 3
π2 [ lim
n→∞
n
∑
k=1
1
k −lim
m→∞
m
∑
k=1
1
k ] = ∞−∞.

5.1 Expected value
౪
237
To exclude phenomenons as in Example 5.1.4, we suppose that a random variable
has to meet the following condition.
Definition 5.1.5. Let X be discrete with values in {x1, x2, . . . } ⊂ℝ. Then the expected value of X exists,
provided that
𝔼|X| =
∞
∑
j=1
|xj| ℙ{X = xj} < ∞.
(5.4)
We mentioned above that an absolutely summable sequence is summable. Hence, under
assumption (5.4), the sum in the subsequent definition is a well-defined real number.
Definition 5.1.6. Let X be a discrete random variable satisfying 𝔼|X| < ∞. Then its expected value is
defined as
𝔼X =
∞
∑
j=1
xj ℙ{X = xj} .
(5.5)
As before, the numbers x1, x2, . . . in formula (5.5) are the possible values of X. For exam-
ple, if X attains values in {1, 4, 9}, then we may choose x1 = 1, x2 = 4, and x3 = 9. But we
could also take x1 = 4, x2 = 9, and x3 = 1, and so on. Every time we get the same expected
value.
Example 5.1.7. We start with an easy example that demonstrates how to compute the
expected value in concrete cases. If the distribution of a random variable X is defined as
ℙ{X = −1} = 1/6, ℙ{X = 0} = 1/8, ℙ{X = 1} = 3/8, and ℙ{X = 2} = 1/3, then its expected
value equals
𝔼X = (−1) ⋅ℙ{X = −1} + 0 ⋅ℙ{X = 0} + 1 ⋅ℙ{X = 1} + 2 ⋅ℙ{X = 2}
= −1
6 + 3
8 + 2
3 = 7
8 .
Example 5.1.8. The next example shows that 𝔼X = ∞may occur even for quite natural
random variables. Thus, let us come back to the model presented in Example 1.4.47.
There we developed a strategy how to always win one dollar in a series of games. The
basic idea was, after losing a game, next time one doubles the amount in the pool. As
in Example 1.4.47, let X(k) be the amount of money needed when winning for the first
time in game k. We obtained
ℙ{X = 2k −1} = p(1 −p)k−1 ,
k = 1, 2, . . .
Recall that 0 < p < 1 is the probability to win a single game. We ask for the expected
value of money needed to apply this strategy. It follows that
𝔼X =
∞
∑
k=1
(2k −1)ℙ{X = 2k −1} = p
∞
∑
k=1
(2k −1)(1 −p)k−1 .
(5.6)

238
౪
5 Expected value, variance, and covariance
If the game is fair, that is, if p = 1/2, then this leads to
𝔼X =
∞
∑
k=1
2k −1
2k
= ∞,
because of (2k −1)/2k →1 as k →∞. This yields 𝔼X = ∞for all1 p ≤1/2.
Let us sum up: if p ≤1/2 (which is the case in all provided games), the obtained
result tells us that the average amount of money needed, to use this strategy, is arbitrarily
large. The owners of gambling casinos know this strategy as well. Therefore, they limit
the possible amount of money in the pool. For example, if the largest possible stakes is
N dollars, then the strategy breaks down as soon as one loses n games for some n with
2n > N. And, as our calculations show, on average this always happens.
Remark 5.1.9. If p > 1/2, then the average amount of money needed is finite, and it can
be calculated by
𝔼X = p
∞
∑
k=1
(2k −1)(1 −p)k−1 = 2p
∞
∑
k=0
(2 −2p)k −p
∞
∑
k=0
(1 −p)k
=
2p
1 −(2 −2p) −
p
1 −(1 −p) =
2p
2p −1 −1 =
1
2p −1 .
5.1.2 Expected value of certain discrete random variables
The aim of this section is to compute the expected value of the most interesting discrete
random variables. We start with uniformly distributed ones.
Proposition 5.1.10. Let X be uniformly distributed on the set {x1, . . . , xN} of real numbers.
Then it follows that
𝔼X = 1
N
N
∑
j=1
xj .
(5.7)
That is, 𝔼X is the arithmetic mean of the xjs.
Proof. This is an immediate consequence of ℙ{X = xj} = 1/N, implying
𝔼X =
N
∑
j=1
xj ⋅ℙ{X = xj} =
N
∑
j=1
xj ⋅1
N .
Remark 5.1.11. For general discrete random variables X with values x1, x2, . . . , their ex-
pected value 𝔼X may be regarded as a weighted (the weights are the pjs) mean of the xjs.
1 If p ≤1/2 then 1 −p ≥1/2, hence the sum in eq. (5.6) becomes bigger and, therefore, it also diverges.

5.1 Expected value
౪
239
Example 5.1.12. Let X be uniformly distributed on {1, . . . , 6}. Then X is a model for
rolling a fair die. Its expected value is, as is well known,
𝔼X = 1 + ⋅⋅⋅+ 6
6
= 21
6 = 7
2 .
Next we determine the expected value of a binomial distributed random variable.
Proposition 5.1.13. Let X be binomial distributed with parameters n and p. Then we get
𝔼X = n p .
(5.8)
Proof. The possible values of X are 0, . . . , n. Thus, it follows that
𝔼X =
n
∑
k=0
k ⋅ℙ{X = k} =
n
∑
k=1
k ⋅(n
k) pk(1 −p)n−k
=
n
∑
k=1
n!
(k −1)! (n −k)! pk(1 −p)n−k
= n p
n
∑
k=1
(n −1)!
(k −1)!(n −k)! pk−1(1 −p)n−k .
Shifting the index from k −1 to k in the last sum implies
𝔼X = np
n−1
∑
k=0
(n −1)!
k! (n −1 −k)! pk(1 −p)n−1−k
= np
n−1
∑
k=0
(n −1
k )pk(1 −p)n−1−k = np [p + (1 −p)]
n−1 = np .
This completes the proof.
Remark 5.1.14. The previous result tells us the following: if we perform n independent
trials of an experiment with success probability 0 ≤p ≤1, then on average we will
observe np successes.
Example 5.1.15. One kilogram of a radioactive material consists of N atoms. The atoms
decay independently of each other and, moreover, the lifetime of each of the atoms is
exponentially distributed with some parameter λ > 0. We ask for the time T0 > 0, at
which, on average, half of the atoms are decayed; T0 is usually called radioactive half-
life.
Answer: If T > 0, then the probability that a single atom decays before time T is
given by
p(T) = Eλ([0, T]) = 1 −eλT.

240
౪
5 Expected value, variance, and covariance
Since the atoms decay independently, the number of atoms decaying before time T is
BN,p(T)-distributed. Therefore, by Proposition 5.1.13, the expected value of decayed atoms
equals N ⋅p(T) = N(1 −eλT). Hence, T0 has to satisfy
N(1 −e−λT0) = N
2 ,
leading to T0 = ln 2/λ. Conversely, if we know T0 and want to determine λ, then λ =
ln 2/T0. Consequently, the probability that a single atom decays before time T > 0 can
also be described by
Eλ([0, T]) = 1 −e−T ln 2/T0 = 1 −2−T/T0 .
Next, we determine the expected value of Poisson distributed random variables.
Proposition 5.1.16. For some λ > 0, let X be distributed according to Poisλ. Then it follows
that 𝔼X = λ.
Proof. The possible values of X are 0, 1, . . . Hence, the expected value is given by
𝔼X =
∞
∑
k=0
k ⋅ℙ{X = k} =
∞
∑
k=1
k λk
k! e−λ = λ
∞
∑
k=1
λk−1
(k −1)! e−λ ,
which transforms by a shift of the index to
λ [
∞
∑
k=0
λk
k! ] e−λ = λ[eλ] e−λ = λ ,
proving the assertion.
Interpretation: Proposition 5.1.16 explains the role of the parameter λ in the defi-
nition of the Poisson distribution. Whenever certain numbers are Poisson distributed,
then λ > 0 is the average of the observed values. For example, if the number of accidents
per week is known to be Poisλ-distributed, then the parameter λ is determined by the
average number of accidents per week in the past. Or, as we already mentioned in Ex-
ample 4.6.6, the number of raisins in a piece of ρ pounds of dough is Poisλρ-distributed,
where λ is the proportion of raisins per pound dough, hence λρ is the average number
of raisins per ρ pounds.
Example 5.1.17. Let us once more take a look at Example 4.6. There we considered light
bulbs with Eλ-distributed lifetime. Every time a bulb burned out, we replaced it by a new
one of the same type. It turned out that the number of necessary replacements until time
T > 0 was PoisλT-distributed. Consequently, by Proposition 5.1.16, on average, until time
T we have to change the light bulbs λT times.

5.1 Expected value
౪
241
Finally, we compute the expected value of a negative binomial distributed random
variable. According to Definition 1.4.49, a random variable X is B−
n,p-distributed if
ℙ{X = k} = (k −1
k −n)pn (1 −p)k−n ,
k = n, n + 1, . . .
or, equivalently, if
ℙ{X = k + n} = (−n
k )pn (p −1)k ,
k = 0, 1, . . .
(5.9)
Proposition 5.1.18. Suppose X is B−
n,p-distributed for some n ≥1 and p ∈(0, 1). Then
𝔼X = n
p .
Proof. Using eq. (5.9), the expected value of X is computed as
𝔼X =
∞
∑
k=n
k ℙ{X = k} =
∞
∑
k=0
(k + n) ℙ{X = k + n}
= pn
∞
∑
k=1
k (−n
k ) (p −1)k + n pn
∞
∑
k=0
(−n
k ) (p −1)k .
(5.10)
To evaluate the two sums in eq. (5.10), we use Proposition A.5.2, which asserts
1
(1 + x)n =
∞
∑
k=0
(−n
k ) xk
(5.11)
for |x| < 1. Applying this with x = p −1 (recall 0 < p < 1) yields
n pn
∞
∑
k=0
(−n
k ) (p −1)k = n pn
1
(1 + (p −1))n = n .
(5.12)
Next we differentiate eq. (5.11) with respect to x and obtain
−n
(1 + x)n+1 =
∞
∑
k=1
k (−n
k ) xk−1 ,
which, multiplying both sides by x, gives
−nx
(1 + x)n+1 =
∞
∑
k=1
k (−n
k ) xk .
(5.13)
Letting x = p −1 in eq. (5.13), the first sum in eq. (5.10) becomes
pn
∞
∑
k=1
k (−n
k ) (p −1)k = pn
−n(p −1)
(1 + (p −1))n+1 = n(1 −p)
p
.
(5.14)

242
౪
5 Expected value, variance, and covariance
Finally, we combine eqs. (5.10), (5.12), and (5.14) to obtain
𝔼X = n(1 −p)
p
+ n = n
p,
as claimed.
Remark 5.1.19. Proposition 5.1.18 asserts that, on average, the nth success occurs in trial
n/p. For example, rolling a die, on average, the first appearance of number “6” will be
in trial 6, the second one in trial 12, and so on.
Corollary 5.1.20. If X is geometrically distributed with parameter p, then
𝔼X = 1
p .
(5.15)
Proof. Recall that Gp = B−
1,p, hence X is B−
1,p-distributed, and 𝔼X =
1
p by Proposi-
tion 5.1.18.
Because of its beauty, let us give another, more direct proof of Corollary 5.1.20.
Suppose X is Gp-distributed. Then we write
𝔼X = p
∞
∑
k=1
k(1 −p)k−1 = p
∞
∑
k=0
(k + 1)(1 −p)k
= (1 −p)
∞
∑
k=0
k p (1 −p)k−1 + p
∞
∑
k=0
(1 −p)k = (1 −p) 𝔼X + 1 .
Solving this equation with respect to 𝔼X proves eq. (5.15), as asserted. Observe that this
alternative proof is based upon the knowledge of 𝔼X < ∞. Otherwise, we could not
solve the equation for 𝔼X. But, because of 0 < p < 1, this fact is an easy consequence of
𝔼X = p
∞
∑
k=1
k(1 −p)k−1 < ∞.
Summary: Let X be a discrete random variable with values x1, x2, . . . Then
𝔼X =
∞
∑
j=1
xj ℙ{X = xj}
provided that
𝔼|X| =
∞
∑
j=1
|xj| ℙ{X = xj} < ∞.
5.1.3 Expected value of continuous random variables
Let X be a continuous random variable with distribution density p, that is, if t ∈ℝ,
then

5.1 Expected value
౪
243
ℙ{X ≤t} =
t
∫
−∞
p(x) dx .
How to define 𝔼X in this case?
To answer this question, let us present formula (5.3) in an equivalent way. Suppose
X maps Ω into a set D ⊂ℝ, which is either finite or countably infinite. Let p : ℝ→[0, 1]
be the probability mass function of X introduced in eq. (3.4). Then the expected value of
X may also be written as
𝔼X = ∑
x∈ℝ
x p(x) .
In this form, the preceding formula suggests that in the continuous case the sum should
be replaced by an integral. This can made more precise by approximating continuous
random variables by discrete ones. But this is only a heuristic explanation; for a precise
approach, deeper convergence theorems for random variables are needed. Therefore,
we do not give more details here, we simply replace sums by integrals.
Doing so, for continuous random variables the following approach for the definition
of 𝔼X might be taken. If p : ℝ→[0, ∞) is the distribution density of X, set
𝔼X :=
∞
∫
−∞
x p(x) dx .
(5.16)
However, here we have a similar problem as in the discrete case, namely that the integral
in eq. (5.16) need not exist. Therefore, let us give a short digression about the integrability
of real functions.
Let f : ℝ→ℝbe a function such that for all a < b the integral ∫
b
a f (x)dx is a
well-defined real number. Then
∞
∫
−∞
f (x) dx := lim
a→−∞
b→∞
b
∫
a
f (x) dx ,
(5.17)
provided both limits on the right-hand side of eq. (5.17) exist. In this case we call f inte-
grable (in the Riemann sense) on ℝ.
Remark 5.1.21. Let us point out that the numbers a and b in eq. (5.17) tend indepen-
dently to −∞and ∞, respectively. For instance, as the example f (x) = x shows, it does
not suffice that limb→∞∫
b
−b f (x) dx exists. Another way to express the existence of the
integral in eq. (5.17) is as follows: the two limits
lim
a→−∞
0
∫
a
f (x) dx
and
lim
b→∞
b
∫
0
f (x) dx
(5.18)

244
౪
5 Expected value, variance, and covariance
have to exist, and if this is so, the integral ∫
∞
−∞f (x) dx is defined as the sum of the two
limits in eq. (5.18).
If f (x) ≥0, x ∈ℝ, then the limit lim a→−∞
b→∞∫
b
a f (x) dx always exists in a generalized
sense, that is, it may be finite (then f is integrable) or infinite, then this is expressed by
∫
∞
−∞f (x) dx = ∞.
If ∫
∞
−∞|f (x)| dx < ∞, then f is said to be absolutely integrable, and as in the case
of infinite series, absolutely integrable function are integrable. Note that x 󳨃→sin x/x is
integrable, but not absolutely integrable.
After this preparation, we come back to the definition of the expected value for
continuous random variables.
Definition 5.1.22. Let X be a random variable with distribution density p. If p(x) = 0 for x < 0, or, equiv-
alently, ℙ{X ≥0} = 1, then the expected value of X is defined by
𝔼X :=
∞
∫
0
x p(x) dx .
(5.19)
Observe that under these conditions on p or X, we have xp(x) ≥0. Therefore, the in-
tegral in eq. (5.19) is always well defined, but might be infinite. In this case we write
𝔼X = ∞.
Let us turn now to the case of ℝ-valued random variables. The following example
shows that the integral in eq. (5.16) may not exist, hence, in general, without an addi-
tional assumption the expected value cannot be defined by eq. (5.16).
Example 5.1.23. A random variable X is supposed to possess the density (check that this
is indeed a density function)
p(x) = {0
if −1 < x < 1,
1
2 x2
if |x| ≥1.
If we try to evaluate 𝔼X by virtue of eq. (5.16), then, because of
∞
∫
−∞
x p(x)dx = lim
a→∞
b→∞
b
∫
−a
x p(x) dx = 1
2[ lim
b→∞
b
∫
1
dx
x + lim
a→∞
−1
∫
−a
dx
x ]
= 1
2[ lim
b→∞
b
∫
1
dx
x −lim
a→∞
a
∫
1
dx
x ] = ∞−∞,
we observe an undetermined expression. Thus, there is no meaningful way to introduce
an expected value for X.

5.1 Expected value
౪
245
We enforce the existence of the integral by the following condition.
Definition 5.1.24. Let X be a (real-valued) random variable with distribution density p. We say the ex-
pected value of X exists, provided p satisfies the following integrability condition:
𝔼|X| :=
∞
∫
−∞
|x| p(x) dx < ∞.
(5.20)
Remark 5.1.25. At this point, it is not clear that the right-hand integral in (5.20) is indeed
the expected value of |X|. This will follow later on by Proposition 5.1.38. Nevertheless,
we use this notation before giving a proof.
Condition (5.20) says nothing but that f (x) := xp(x) is absolutely integrable. Hence,
as mentioned above, f is integrable, and the integral in the following definition is well
defined.
Definition 5.1.26. Suppose condition (5.20) is satisfied. Then the expected value of X is defined by
𝔼X :=
∞
∫
−∞
x p(x) dx .
Summary: Let X be a continuous random variable with density p : ℝ→ℝ. Then
𝔼X =
∞
∫
−∞
x p(x) dx
provided that
𝔼|X| =
∞
∫
−∞
|x| p(x) dx < ∞.
5.1.4 Expected value of certain continuous random variables
We start with computing the expected value of a uniformly distributed (continuous) ran-
dom variable.
Proposition 5.1.27. Let X be uniformly distributed on the finite interval I = [α, β]. Then
𝔼X = α + β
2
,
that is, the expected value is the midpoint of the interval I.
Proof. The distribution density of X is the function p defined as p(x) = (β −α)−1 if x ∈I,
and p(x) = 0 if x ∉I. Of course, X possesses an expected value,2 which can be evaluated
by
2 The product |x|p(x) is bounded and nonzero only on a finite interval.

246
౪
5 Expected value, variance, and covariance
𝔼X =
∞
∫
−∞
xp(x) dx =
β
∫
α
x
β −α dx =
1
β −α[x2
2 ]
β
α
= 1
2 ⋅β2 −α2
β −α = α + β
2
.
This proves the proposition.
Next we determine the expected value of a gamma distributed random variable.
Proposition 5.1.28. Suppose X is Γα,β-distributed with α, β > 0. Then its expected value is
𝔼X = α β .
Proof. Because of ℙ{X ≥0} = 1, its expected value is well defined and computed by
𝔼X =
∞
∫
0
xp(x) dx =
1
αβ Γ(β)
∞
∫
0
x ⋅xβ−1 e−x/α dx
=
1
αβ Γ(β)
∞
∫
0
xβ e−x/α dx .
(5.21)
The change of variables u := x/α transforms eq. (5.21) into
𝔼X =
αβ+1
αβ Γ(β)
∞
∫
0
uβ e−u du =
αβ+1
αβ Γ(β) ⋅Γ(β + 1) = α β ,
where we used eq. (1.50) in the last step. This completes the proof.
Corollary 5.1.29. Let X be Eλ-distributed for a certain λ > 0. Then
𝔼X = 1
λ .
Proof. Note that Eλ = Γλ−1,1.
Example 5.1.30. The lifetime of a special type of light bulbs is exponentially distributed.
Suppose the average lifetime constitutes 100 units of time. This implies λ = 1/100, hence,
if X describes the lifetime, then
ℙ{X ≤t} = 1 −e−t/100 ,
t ≥0 .
For example, the probability that the light bulb burns longer than 200 time units equals
ℙ{X ≥200} = e−200/100 = e−2 = 0.135335 . . .
Remark 5.1.31. If we evaluate in the previous example
ℙ{X ≥𝔼X} = ℙ{X ≥100} = e−1 ,

5.1 Expected value
౪
247
then we see that in general ℙ{X ≥𝔼X}
̸= 1/2. Thus, in this case, the expected value is
different from the median of X defined as a real number M satisfying ℙ{X ≥M} ≥1/2
and ℙ{X ≤M} ≥1/2. In particular, if FX satisfies the condition of Proposition 4.4.7, then
the median is uniquely determined by M = F−1
X (1/2), i. e., by ℙ{X ≤M} = 1/2. It is easy
to see that the above phenomenon appears for all exponentially distributed random
variables. Indeed, if X is Eλ-distributed, then M = ln 2/λ while, as we saw, 𝔼X = 1/λ,
compare Figure 5.1.
Figure 5.1: The expected value 𝔼X = 1/λ and the median M = ln 2/λ of an Eλ-distributed random variable X.
Corollary 5.1.32. If X is χ2
n-distributed, then
𝔼X = n .
Proof. Since χ2
n = Γ2,n/2, by Proposition 5.1.28 it follows that 𝔼X = 2 ⋅n/2 = n.
Which expected value does a beta distributed random variable possess? The next
proposition answers this question.
Proposition 5.1.33. Let X be ℬα,β-distributed for certain α, β > 0. Then
𝔼X =
α
α + β .
Proof. Using eq. (1.63), from eq. (5.19) we obtain, as asserted,
𝔼X =
1
B(α, β)
1
∫
0
x ⋅xα−1(1 −x)β−1 dx
=
1
B(α, β)
1
∫
0
xα(1 −x)β−1 dx = B(α + 1, β)
B(α, β)
=
α
α + β .
Example 5.1.34. Suppose we choose independently n numbers x1, . . . , xn uniformly
distributed on [0, 1] and order them by their size. Then we get the order statistics

248
౪
5 Expected value, variance, and covariance
0 ≤x∗
1 ≤⋅⋅⋅≤x∗
n ≤1. According to Example 3.7.11, if 1 ≤k ≤n, then the number x∗
k is
ℬk,n−k+1-distributed. Thus Proposition 5.1.33 implies that the average value of x∗
k , that is,
of the kth largest number, equals
k
k + (n −k + 1) =
k
n + 1 .
In particular, the expected value of the smallest number is
1
n+1 while that of the largest
one is
n
n+1.
Does a Cauchy distributed random variable possess an expected value? Here we
obtain the following.
Proposition 5.1.35. If X is Cauchy distributed, then 𝔼X does not exist.
Proof. First, observe that we may not use Definition 5.1.22. The distribution density of X
is given by p(x) = 1
π ⋅
1
1+x2 , hence, it does not satisfy p(x) = 0 for x < 0. Consequently, we
have to check whether condition (5.20) is satisfied. Here we get
𝔼|X| = 1
π
∞
∫
−∞
|x|
1 + x2 dx = 2
π
∞
∫
0
x
1 + x2 dx = 1
π [ln(1 + x2)]
∞
0 = ∞.
Thus, 𝔼|X| = ∞, that is, X does not possess an expected value.
Finally, we determine the expected value of normally distributed random variables.
Proposition 5.1.36. If X is 𝒩(μ, σ2)-distributed, then
𝔼X = μ .
Proof. First, we check whether the expected value exists. The density of X is given by
eq. (1.49), hence
∞
∫
−∞
|x| pμ,σ(x) dx =
1
√2π σ
∞
∫
−∞
|x| e−(x−μ)2/2σ2
dx =
1
√π
∞
∫
−∞
|√2σu + μ| e−u2
du
≤σ 2√2
√π
∞
∫
0
u e−u2
du + |μ| 2
√π
∞
∫
0
e−u2
du < ∞,
where we used the well-known fact3 that for all k ∈ℕ0,
∞
∫
0
uk e−u2
du < ∞.
3 See either [Spi08] or use that for all k ≥1 one has supu>0 uk e−u < ∞.

5.1 Expected value
౪
249
The expected value 𝔼X is now evaluated in a similar way as
𝔼X =
∞
∫
−∞
x pμ,σ(x) dx =
1
√2π σ
∞
∫
−∞
x e−(x−μ)2/2σ2
dx
=
1
√2π
∞
∫
−∞
(σv + μ) e−v2/2 dv
= σ
1
√2π
∞
∫
−∞
v e−v2/2 dv + μ
1
√2π
∞
∫
−∞
e−v2/2 dv .
(5.22)
The function f (v) := ve−v2/2 is odd, that is, f (−v) = −f (v), thus ∫
∞
−∞f (v) dv = 0, and the
first integral in eq. (5.22) vanishes. To compute the second integral, use Proposition 1.6.7
and obtain
μ
1
√2π
∞
∫
−∞
e−v2/2 dv = μ
1
√2π
√2π = μ .
This completes the proof.
Remark 5.1.37. Proposition 5.1.36 justifies the notation “expected value” for the param-
eter μ in the definition of the probability measure 𝒩(μ, σ2).
Summary: Let X be some random variable. Using the notation introduced in Remark 3.3.1, the following are
valid:
1.
X uniformly distributed on {x1, . . . , xN}
⇒
𝔼X = x1+⋅⋅⋅+xN
N
.
2.
X ∼Bn,p
⇒
𝔼X = n p.
3.
X ∼Poisλ
⇒
𝔼X = λ.
4.
X ∼B−
n,p
⇒
𝔼X = n
p.
5.
X ∼Gp
⇒
𝔼X = 1
p.
6.
X uniformly distributed on [α, β]
⇒
𝔼X = α+β
2 .
7.
X ∼Γα,β
⇒
𝔼X = αβ.
8.
X ∼Eλ,n
⇒
𝔼X = n
λ .
9.
X ∼χ2
n
⇒
𝔼X = n.
10.
X ∼ℬα,β
⇒
𝔼X =
α
α+β .
11.
X ∼𝒩(μ, σ2)
⇒
𝔼X = μ.
12.
X Cauchy distributed
⇒
𝔼X does not exist.
5.1.5 Properties of the expected value
In this section we summarize the main properties of the expected value. They are
valid for both discrete and continuous random variables. But, unfortunately, within

250
౪
5 Expected value, variance, and covariance
the framework of this book it is not possible to prove most of them in full generality.
To do so, one needs an integral (Lebesgue integral) ∫Ω f dℙof functions f : Ω →ℝfor
some probability space (Ω, 𝒜, ℙ). Then 𝔼X = ∫Ω Xdℙ, and all subsequent properties of
X 󳨃→𝔼X follow from those of the (Lebesgue) integral. We refer to [LG22] for a thorough
presentation of this (wonderful) topic.
Proposition 5.1.38. The expected value of random variables has the following properties:
(1) The expected value of X only depends on its probability distribution ℙX, not on the way
how X is defined. That is, if X
d= Y for two random variables X and Y, then 𝔼X = 𝔼Y.
(2) If X is constant with probability one, that is, there is some c ∈ℝwith ℙ{X = c} = 1,
then 𝔼X = c.
(3) The expected value is linear: let X and Y be two random variables possessing an ex-
pected value and let a, b ∈ℝ. Then 𝔼(aX + bY) exists as well and, moreover,
𝔼(aX + bY) = a 𝔼X + b 𝔼Y.
(4) Suppose X is a discrete random variable with values x1, x2, . . . Given a function f from
ℝto ℝ, the expected value 𝔼f (X) exists if and only if
∞
∑
i=1
󵄨󵄨󵄨󵄨f (xi)󵄨󵄨󵄨󵄨ℙ{X = xi} < ∞,
and, moreover, then
𝔼f (X) =
∞
∑
i=1
f (xi) ℙ{X = xi} .
(5.23)
(5) If X is continuous with density p, then for any measurable function f : ℝ→ℝthe
expected value 𝔼f (X) exists if and only if
∞
∫
−∞
󵄨󵄨󵄨󵄨f (x)󵄨󵄨󵄨󵄨p(x) dx < ∞.
In this case it follows that
𝔼f (X) =
∞
∫
−∞
f (x) p(x) dx .
(5.24)
(6) For independent X and Y possessing an expected value, the expected value of their
product4 X Y exists as well and, moreover,
𝔼[X Y] = 𝔼X ⋅𝔼Y.
4 Recall that (XY)(ω) = X(ω) ⋅Y(ω) for all ω ∈Ω.

5.1 Expected value
౪
251
(7) Write X ≤Y provided that X(ω) ≤Y(ω) for all ω ∈Ω. If in this sense |X| ≤Y for some
Y with 𝔼Y < ∞, then 𝔼|X| < ∞and, hence, 𝔼X exists.
(8) Suppose 𝔼X and 𝔼Y exist. Then X ≤Y implies 𝔼X ≤𝔼Y. In particular, if X ≥0, then
𝔼X ≥0.
Proof. We only prove properties (1), (2), (4), and (8). Some of the other properties are not
difficult to verify in the case of discrete random variables, for example, (3), but because
the proofs are incomplete, we do not present them here. We refer to [Bil12, Dur19] or
[Kho07] for the proofs of the remaining properties.
We begin with the proof of (1). If X and Y are identically distributed, then either
both are discrete or both are continuous. If they are discrete, and ℙX(D) = 1 for an at
most countably infinite set D, then X
d= Y implies ℙY(D) = 1. Moreover, by the same
argument ℙX({x}) = ℙY({x}) for any x ∈D. Hence, in view of Definition 5.1.2, 𝔼X exists
if and only if 𝔼Y does. Moreover, if this is valid, then 𝔼X = 𝔼Y by the same argument.
In the continuous case, we argue as follows. Let p be a density of X. Due to X
d= Y, it
follows that
t
∫
−∞
p(x) dx = ℙX((−∞, t]) = ℙY((−∞, t]) ,
t ∈ℝ.
Thus, p is also a distribution density of Y and, consequently, in view of Definition 5.1.24,
the expected value of X exists if and only if this is the case for Y. Moreover, by Defini-
tion 5.1.26, we get 𝔼X = 𝔼Y.
Next we show that (2) is valid. Thus, suppose ℙ{X = c} = 1 for some c ∈ℝ. Then X
is discrete with ℙX(D) = 1 where D = {c}, and by Definition 5.1.2 we obtain
𝔼X = c ⋅ℙ{X = c} = c ⋅1 = c,
as asserted.
To prove (4), we assume that X has values in D = {x1, x2, . . . }. Then Y = f (X) maps
into f (D) = {y1, y2, . . . }. Given j ∈ℕ, let Dj = {xi : f (xi) = yj}. Thus,
ℙ{Y = yj} = ℙ{X ∈Dj} = ∑
xi∈Dj
ℙ{X = xi} .
Consequently, since Dj ∩Dj′ = 0 if j
̸= j′, due to ⋃∞
j=1 Dj = D, we get
𝔼|Y| =
∞
∑
j=1
|yj|ℙ{Y = yj} =
∞
∑
j=1
∑
xi∈Dj
|yj|ℙ{X = xi}
=
∞
∑
j=1
∑
xi∈Dj
󵄨󵄨󵄨󵄨f (xi)󵄨󵄨󵄨󵄨ℙ{X = xi} =
∞
∑
i=1
󵄨󵄨󵄨󵄨f (xi)󵄨󵄨󵄨󵄨ℙ{X = xi} .

252
౪
5 Expected value, variance, and covariance
This proves the first part of (4). The second part follows by exactly the same arguments
(replace |yj| by yj). Therefore, we omit its proof.
We finally prove (8). To this end, we first show the second part, that is, 𝔼X ≥0 for
X ≥0. If X is discrete, then X attains values in D, where D consists only of nonnegative
real numbers. Hence, xjℙ{X = xj} ≥0, which implies 𝔼X ≥0. If X is continuous, in
view of X ≥0, we may choose its density p such that p(x) = 0 if x < 0. Then 𝔼X =
∫
∞
0 p(x)dx ≥0.
Suppose now X ≤Y. Setting Z = Y −X, from the first step we get 𝔼Z ≥0. But,
property (3) implies 𝔼Z = 𝔼Y −𝔼X, from which we derive 𝔼X ≤𝔼Y, as asserted. Note
that by assumption 𝔼X and 𝔼Y are real numbers, so that 𝔼Y−𝔼X is not an undetermined
expression.
Remark 5.1.39. Properties (4) and (5) of the previous proposition, applied with the func-
tion f (x) = |x|, lead to
𝔼|X| =
∞
∑
j=1
|xj|ℙ{X = xj}
or
𝔼|X| =
∞
∫
−∞
|x| p(x) dx ,
as we already stated in conditions (5.4) and (5.20), respectively.
Corollary 5.1.40. If 𝔼X exists, then shifting X by μ = 𝔼X, it becomes centralized. In other
words, if μ = 𝔼X, then
𝔼(X −μ) = 0 .
Proof. If Y = X −μ, then properties (2) and (3) of Proposition 5.1.38 imply
𝔼Y = 𝔼(X −μ) = 𝔼X −𝔼μ = μ −μ = 0 ,
as asserted.
An important consequence of (8) in Proposition 5.1.38 reads as follows.
Corollary 5.1.41. If 𝔼X exists, then
|𝔼X| ≤𝔼|X| .
Proof. For all ω ∈Ω, it follows that
−󵄨󵄨󵄨󵄨X(ω)󵄨󵄨󵄨󵄨≤X(ω) ≤󵄨󵄨󵄨󵄨X(ω)󵄨󵄨󵄨󵄨,
that is, we have −|X| ≤X ≤|X|. We apply now (3) and (8) of Proposition 5.1.38 and
conclude that
−𝔼|X| = 𝔼(−|X|) ≤𝔼X ≤𝔼|X| .
(5.25)

5.1 Expected value
౪
253
Since |a| ≤c for a, c ∈ℝis equivalent to −c ≤a ≤c, the desired estimate is a conse-
quence of inequalities (5.25) with a = 𝔼X and c = 𝔼|X|.
We now present some examples that show how Proposition 5.1.38 may be used to
evaluate certain expected values.
Example 5.1.42. Suppose we roll n fair dice. Let Sn be the sum of the observed values.
What is the expected value of Sn?
Answer: If Xj denotes the value of the jth die, then X1, . . . , Xn are uniformly dis-
tributed on {1, . . . , 6} with 𝔼Xj = 7/2 and, moreover, Sn = X1 + ⋅⋅⋅+ Xn. Thus, property (3)
lets us conclude that
𝔼Sn = 𝔼(X1 + ⋅⋅⋅+ Xn) = 𝔼X1 + ⋅⋅⋅+ 𝔼Xn = 7n
2 .
Example 5.1.43. In Example 4.1.7, we investigated the random walk of a particle on ℤ.
Each time it jumped with probability p either one step to the right or with probability
1−p one step to the left. There Sn denoted the position of the particle after n steps. What
is the expected position after n steps?
Answer: We proved that Sn = 2Yn −n with a Bn,p-distributed random variable Yn.
Proposition 5.1.13 implies 𝔼Yn = np, hence the linearity of the expected value leads to
𝔼Sn = 2 𝔼Yn −n = 2np −n = n(2p −1) .
(5.26)
For p = 1/2, we obtain the (not very surprising) result 𝔼Sn = 0. But note that eq. (5.26)
can also be proved directly by using 𝔼Xj = (−1)(1 −p) + 1 ⋅p = 2p −1.
Remark 5.1.44. If we regard Sn as the position of a particle after n jumps, then since
2p −1 > 0 if p > 1/2 it follows that in this case the particle drifts on average to ∞. On the
contrary, if p < 1/2, the particle tends on average to −∞.
On the other hand, if we interpret Sn as the loss or win after n games, we get the
following conclusion: whenever one plays a series of games with success probability
p < 1/2 (for example, roulette), in the long run one will lose on average an arbitrarily
big amount of money.
The next example demonstrates how property (4) of Proposition 5.1.38 may be used.
Example 5.1.45. Let X be Poisλ-distributed. Find 𝔼X2.
Solution: Property (4) of Proposition 5.1.38 implies
𝔼X2 =
∞
∑
k=0
k2 ℙ{X = k} =
∞
∑
k=1
k2 λk
k! e−λ = λ
∞
∑
k=1
k
λk−1
(k −1)! e−λ .
We shift the index of summation in the right-hand sum by 1 and get
𝔼X2 = λ
∞
∑
k=0
(k + 1) λk
k! e−λ = λ
∞
∑
k=0
k λk
k! e−λ + λ
∞
∑
k=0
λk
k! e−λ .

254
౪
5 Expected value, variance, and covariance
By Proposition 5.1.16, the first sum coincides with λ 𝔼X = λ2, while the second gives
λ Poisλ(ℕ0) = λ ⋅1 = λ. Adding both values leads to
𝔼X2 = λ2 + λ .
The next example rests upon an application of properties (3), (4), and (6) in Propo-
sition 5.1.38.
Example 5.1.46. Compute 𝔼X2 for X being Bn,p-distributed.
Solution: Let X1, . . . , Xn be independent B1,p-distributed random variables. Then
Corollary 4.6.2 asserts that X = X1 + ⋅⋅⋅+ Xn is Bn,p-distributed. Therefore, it suffices to
evaluate 𝔼X2 with X = X1 + ⋅⋅⋅+ Xn. Thus, property (3) of Proposition 5.1.38 implies
𝔼X2 = 𝔼(X1 + ⋅⋅⋅+ Xn)2 =
n
∑
i=1
n
∑
j=1
𝔼XiXj .
If i
̸= j, then Xi and Xj are independent, hence property (6) applies and yields
𝔼XiXj = 𝔼Xi ⋅𝔼Xj = p ⋅p = p2 .
For i = j, property (4) gives
𝔼X2
j = 02 ⋅ℙ{Xj = 0} + 12 ⋅ℙ{Xj = 1} = p .
Combining both cases leads to
𝔼X2 = ∑
i ̸=j
𝔼Xi ⋅𝔼Xj +
n
∑
j=1
𝔼X2
j = n(n −1) p2 + n p = n2 p2 + n p(1 −p) .
Example 5.1.47. Let X be Gp-distributed. Compute 𝔼X2.
Solution: We claim that
𝔼X2 = 2 −p
p2
.
(5.27)
To prove this, let us start with
𝔼X2 =
∞
∑
k=1
k2 ℙ{X = k} = p
∞
∑
k=1
k2(1 −p)k−1 .
(5.28)
We evaluate the right-hand sum by the following approach. If |x| < 1, then
1
1 −x =
∞
∑
k=0
xk .

5.1 Expected value
౪
255
Differentiating both sides of this equation leads to
1
(1 −x)2 =
∞
∑
k=1
k xk−1 .
Next we multiply this equation by x and arrive at
x
(1 −x)2 =
∞
∑
k=1
k xk .
Another differentiation of both functions on {x ∈ℝ: |x| < 1} implies
1
(1 −x)2 +
2x
(1 −x)3 =
∞
∑
k=1
k2xk−1 .
If we use the last equation with x = 1 −p, then, by eq. (5.28),
𝔼X2 = p[
1
(1 −(1 −p))2 +
2(1 −p)
(1 −(1 −p))3 ] = 2 −p
p2
,
as we claimed in eq. (5.27).
In the next example we us property (5) of Proposition 5.1.38.
Example 5.1.48. Let U be uniformly distributed on [0, 1]. Which expected value does
√U possess?
Solution: By property (5), it follows that
𝔼√U =
∞
∫
−∞
√x ⋅1[0,1](x) dx =
1
∫
0
√x dx = 2
3[x3/2]
1
0 = 2
3 .
Another approach is as follows. Because of
F√U(t) = ℙ{√U ≤t} = ℙ{U ≤t2} = t2
for 0 ≤t ≤1, the density q of √U is given by q(x) = 2x, 0 ≤x ≤1, and q(x) = 0 otherwise.
Thus,
𝔼√U =
1
∫
0
x 2x dx = 2[x3
3 ]
1
0
= 2
3 .
Let us present now an interesting example called Coupon collector’s problem.
It was first mentioned in 1708 by A. De Moivre. We formulate it in a present-day lan-
guage.

256
౪
5 Expected value, variance, and covariance
Example 5.1.49. A company produces cornflakes. Each pack contains a picture. We as-
sume that there are n different pictures and that they are equally likely. That is, when
buying a pack, the probability to get a certain fixed picture is 1/n. How many packs of
cornflakes have to be bought on average before one gets all possible n pictures?
An equivalent formulation of the problem is as follows. In an urn there are n balls
numbered from 1 to n. One chooses balls out of the urn with replacement. How many
balls have to be chosen on average before one observes all n numbers?
Answer: Assume we already have k different pictures for some k = 0, 1, . . . , n −1.
Let Xk be the number of necessary purchases to obtain a new picture, that is, to get one
which we do not have. Since each pack contains a picture,
ℙ{X0 = 1} = 1 .
If k ≥1, then there are still n−k pictures that one does not possess. Hence, Xk is geomet-
rically distributed with success probability pk = (n −k)/n. If Sn = X0 + ⋅⋅⋅+ Xn−1, then Sn
is the totality of necessary purchases. By Corollary 5.1.20, we obtain
𝔼Xk = 1
pk
=
n
n −k ,
k = 0, . . . , n −1 .
Note that 𝔼X0 = 1, thus the previous formula also holds in this case. Then the linearity
of the expected value implies
𝔼Sn = 1 + 𝔼X1 + ⋅⋅⋅+ 𝔼Xn−1 = 1 + 1
p1
+ ⋅⋅⋅+
1
pn−1
= 1 +
n
n −1 +
n
n −2 + ⋅⋅⋅+ n
1 = n
n
∑
k=1
1
k .
Consequently, on average, one needs n ∑n
k=1
1
k purchases to obtain a complete collection
of all pictures.
For example, if n = 50, on average, we have to buy 225 packs; if n = 100, then 519; for
n = 200, on average, there are 1176 purchases necessary; if n = 300, then 1885; if n = 400,
we have to buy 2628 packs; and, finally, if n = 500, we need to buy 3397.
Remark 5.1.50. As n →∞, the harmonic series ∑n
k=1
1
k behaves like ln n. More precisely
(cf. [Lag13] or [Spi08], Problem 12, Chapter 22)
lim
n→∞[
n
∑
k=1
1
k −ln n] = γ ,
(5.29)
where γ denotes Euler’s constant, which is approximately 0.57721. Therefore, for large n,
the average number of necessary purchases is approximately n[ln n + γ]. For example,
if n = 300, then the approximative value is 1884.29, leading also to 1885 necessary pur-
chases.

5.2 Variance
౪
257
Summary: The most important properties of the expected value are (we assume that all expected values
are well defined):
1.
For all X, Y and a, b ∈ℝ, it follows that 𝔼[aX + bY] = a 𝔼X + b 𝔼Y.
2.
If f : ℝ→ℝ, then 𝔼[f(X)] = ∑∞
k=1 f(xk)ℙ{X = xk}, resp. 𝔼[f(X)] = ∫
∞
−∞f(x) p(x)dx.
3.
For all random variables X, it follows that |𝔼X| ≤𝔼|X|.
4.
If X and Y are independent, then 𝔼[X Y] = 𝔼X ⋅𝔼Y.
5.2 Variance
5.2.1 Higher moments of random variables
Definition 5.2.1. Let n ≥1 be some integer. A random variable X possesses an nth moment, provided
that 𝔼|X|n < ∞. We also say X has a finite absolute nth moment. If this is so, then 𝔼Xn exists, and it is
called the nth moment of X.
Remark 5.2.2. Because of |X|n = |Xn|, the assumption 𝔼|X|n < ∞implies the existence
of the nth moment 𝔼Xn.
Note that a random variable X has a first moment if and only if the expected value
of X exists, cf. conditions (5.4) and (5.20). Moreover, then the first moment coincides with
𝔼X.
Proposition 5.2.3. Let X be either a discrete random variable with values in {x1, x2, . . .}
and with pj = ℙ{X = xj}, or let X be continuous with density p. If n ≥1, then
𝔼|X|n =
∞
∑
j=1
|xj|n ⋅pj
or
𝔼|X|n =
∞
∫
−∞
|x|n p(x) dx .
(5.30)
Consequently, X possesses a finite absolute nth moment if and only if either the sum or the
integral in eq. (5.30) are finite. If this is satisfied, then these moments are given by
𝔼Xn =
∞
∑
j=1
xn
j ⋅pj
or
𝔼Xn =
∞
∫
−∞
xn p(x) dx .
Proof. Apply properties (4) and (5) in Proposition 5.1.38 with f (x) = |x|n or with f (x) = xn,
respectively.
Example 5.2.4. Let U be uniformly distributed on [0,1]. Then
𝔼|U|n = 𝔼Un =
1
∫
0
xn dx =
1
n + 1 .
For the subsequent investigations, we need the following elementary lemma.

258
౪
5 Expected value, variance, and covariance
Lemma 5.2.5. If 0 < α < β, then for all x ≥0,
xα ≤xβ + 1 .
Proof. If 0 ≤x ≤1, from xβ ≥0 it follows that
xα ≤1 ≤xβ + 1 ,
and the inequality is valid.
If x > 1, then α < β implies xα < xβ, hence also for those x we arrive at
xα < xβ ≤xβ + 1 ,
which proves the lemma.
Proposition 5.2.6. Suppose a random variable X has a finite absolute nth moment. Then
X possesses all mth moments with m < n.
Proof. Suppose 𝔼|X|n < ∞and choose an m < n. For a fixed ω ∈Ω, we apply
Lemma 5.2.5 with α = m, β = n, and x = |X(ω)|. Doing so, we obtain
󵄨󵄨󵄨󵄨X(ω)󵄨󵄨󵄨󵄨
m ≤󵄨󵄨󵄨󵄨X(ω)󵄨󵄨󵄨󵄨
n + 1 ,
and this being true for all ω ∈Ω implies |X|m ≤|X|n + 1. Hence, property (7) of Proposi-
tion 5.1.38 yields
𝔼|X|m ≤𝔼(|X|n + 1) = 𝔼|X|n + 1 < ∞.
Consequently, as asserted, X possesses also an absolute mth moment.
Remark 5.2.7. There exist much stronger estimates between different absolute mo-
ments of X. For example, Lyapunov’s inequality, a special case of Jensen’s inequality,
asserts that for any 0 < α ≤β,
[𝔼|X|α]
1/α ≤[𝔼|X|β]
1/β .
The case n = 2 and m = 1 in Proposition 5.2.6 is of special interest. Here we get the
following useful result.
Corollary 5.2.8. If X possesses a finite second moment, then 𝔼|X| < ∞, that is, its ex-
pected value exists.
Let us state another important consequence of Proposition 5.2.6.
Corollary 5.2.9. Suppose X has a finite absolute nth moment. Then for any b ∈ℝ, we also
have 𝔼|X + b|n < ∞.

5.2 Variance
౪
259
Proof. An application of the binomial theorem (Proposition A.3.8) implies
|X + b|n ≤(|X| + |b|)
n =
n
∑
k=0
(n
k) |X|k |b|n−k .
Hence, using properties (3) and (7) of Proposition 5.1.38, we obtain
𝔼|X + b|n ≤
n
∑
k=0
(n
k)|b|n−k 𝔼|X|k < ∞.
Note that Proposition 5.2.6 implies 𝔼|X|k < ∞for all k < n. This ends the proof.
Example 5.2.10. Let X be Γα,β-distributed with parameters α, β > 0. Which moments
does X possess, and how can they be computed?
Answer: In view of X ≥0, it suffices to investigate 𝔼Xn. For all n ≥1, it follows that
𝔼Xn =
1
αβΓ(β)
∞
∫
0
xn+β−1 e−x/α dx =
αn+β
αβΓ(β)
∞
∫
0
yn+β−1 e−y dy
= αn Γ(β + n)
Γ(β)
= αn (β + n −1)(β + n −2) ⋅⋅⋅(β + 1)β .
In particular, X has moments of any order n ≥1.
In the case of an Eλ-distributed random variable X, we have α = 1/λ and β = 1, hence
𝔼Xn = n!
λn .
Example 5.2.11. Suppose a random variable is tn-distributed. Which moments does X
possess?
Answer: We already know that a t1-distributed random variable does not possess a
first moment. Recall that X is t1-distributed if it is Cauchy distributed. And in Proposi-
tion 5.1.35 we proved 𝔼|X| = ∞for Cauchy distributed random variables.
But what can be said if n ≥2?
According to Definition 4.6, the random variable X has the density p with
p(x) =
Γ( n+1
2 )
√n π Γ( n
2 ) (1 + x2
n )
−n/2 −1/2
,
x ∈ℝ.
If m ∈ℕ, then
𝔼|X|m =
Γ( n+1
2 )
√n π Γ( n
2 )
∞
∫
−∞
|x|m (1 + x2
n )
−n/2 −1/2
dx .

260
౪
5 Expected value, variance, and covariance
Hence, X has an mth moment if and only if the integral
∞
∫
−∞
|x|m (1 + x2
n )
−n/2 −1/2
dx = 2
∞
∫
0
xm (1 + x2
n )
−n/2 −1/2
dx
(5.31)
is finite. Note that
lim
x→∞xn+1 (1 + x2
n )
−n/2 −1/2
= lim
x→∞(x−2 + 1
n)
−n/2 −1/2
= nn/2+1/2 ,
thus, there are constants 0 < c1 < c2 (depending on n, but not on x) such that
c1
xn−m+1 ≤xm (1 + x2
n )
−n/2 −1/2
≤
c2
xn−m+1
(5.32)
for large x, that is, if x > x0 for a suitable x0 ∈ℝ.
Recall that ∫
∞
1
x−α dx < ∞if and only if α > 1. Having this in mind, in view of
eq. (5.31) and by the estimates in (5.32), we get 𝔼|X|m < ∞if and only if n −m + 1 > 1,
that is, if and only if m < n.
Summing up, a tn-distributed random variable has moments of order 1, . . . , n −1,
but no moments of order greater than or equal to n.
Finally, let us investigate the moments of normally distributed random variables.
Example 5.2.12. How do we calculate 𝔼Xn for an 𝒩(0, 1)-distributed random variable?
Answer: Well-known properties of the exponential function imply
𝔼|X|n =
1
√2π
∞
∫
−∞
|x|n e−x2/2 dx =
2
√2π
∞
∫
0
xn e−x2/2 dx < ∞
for all n ∈ℕ. Thus, a normally distributed random variable possesses moments of any
order. These moments are evaluated by
𝔼Xn =
∞
∫
−∞
xn p0,1(x) dx =
1
√2π
∞
∫
−∞
xn e−x2/2 dx .
If n is an odd integer, then x 󳨃→xn e−x2/2 is an odd function, hence 𝔼Xn = 0 for odd
integers n.
Therefore, it suffices to investigate even n = 2m with m ∈ℕ. Here we get
𝔼X2m = 2 ⋅
1
√2π
∞
∫
0
x2m e−x2/2 dx ,
which, by the change of variables y := x2/2, thus x = √2y with dx =
1
√2 y−1/2 dy, trans-
forms into

5.2 Variance
౪
261
𝔼X2m =
1
√π 2m
∞
∫
0
ym−1/2 e−y dy = 2m
√π Γ(m + 1
2).
Since Γ(1/2) = √π and by an application of eq. (1.50), we finally obtain
𝔼X2m = 2m
√π (m −1
2)Γ(m −1
2) = 2m
√π (m −1
2)(m −3
2)Γ(m −3
2)
= 2mΓ(1/2) ⋅1/2 ⋅3/2 ⋅⋅⋅(m −1/2)
√π
= (2m −1)(2m −3) ⋅⋅⋅3 ⋅1 = (2m −1)!! .
Summary: A random variable X possess an nth moment if 𝔼|X|n < ∞. Then its nth moment is defined by
𝔼Xn =
∞
∑
j=1
xn
j ℙ{X = xj}
or
𝔼Xn =
∞
∫
−∞
xn p(x)dx ,
respectively. Here the xjs are in the discrete case the possible values of X or p denotes in the continuous case
its density.
If X possesses an nth moment, then this also so for all moments of order m ≤n. In particular, for each
random variable with second moment its expected value exists.
5.2.2 Variance of random variables
Let X be a random variable with finite second moment. As we saw in Corollary 5.2.8,
then its expected value μ := 𝔼X exists. Furthermore, letting b = −μ, by Corollary 5.2.9,
we also have 𝔼|X −μ|2 < ∞. After this preparation, we can introduce the variance of a
random variable.
Definition 5.2.13. Let X be a random variable possessing a finite second moment. If μ := 𝔼X, then its
variance is defined as
𝕍X := 𝔼|X −μ|2 = 𝔼|X −𝔼X|2 .
Interpretation: The expected value μ of a random variable is its main characteristic. It
tells us around which value the observations of X have to be expected. But it does not tell
us how far away from μ these observations will be on average. Are they concentrated
around μ or are they widely dispersed? This behavior is described by the variance. It is
defined as the average quadratic distance of X to its mean value. If 𝕍X is small, then we
will observe realizations of X quite near to its mean. Otherwise, if 𝕍X is large, then it is
very likely to observe values of X far away from its expected value.
How do we evaluate the variance in concrete cases? We answer this question for
discrete and continuous random variables separately.

262
౪
5 Expected value, variance, and covariance
Proposition 5.2.14. Let X be a random variable with finite second moment and let μ ∈ℝ
be its expected value. Then it follows that
𝕍X =
∞
∑
j=1
(xj −μ)2 ⋅pj
and
𝕍X =
∞
∫
−∞
(x −μ)2 p(x) dx
(5.33)
in the discrete and continuous case, respectively. Hereby, x1, x2, . . . are the possible values
of X and pj = ℙ{X = xj} in the discrete case, while p denotes the density of X in the
continuous case.
Proof. The assertion follows directly by an application of properties (4) and (5) of Propo-
sition 5.1.38 to f (x) = (x −μ)2.
Before we present concrete examples, let us state and prove certain properties of
the variance, which will simplify the calculations later on.
Proposition 5.2.15. Assume X and Y are random variables with finite second moment.
Then the following are valid:
(i)
We have
𝕍X = 𝔼X2 −(𝔼X)2 .
(5.34)
(ii) If ℙ{X = c} = 1 for some c ∈ℝ, then5 𝕍X = 0.
(iii) For a, b ∈ℝfollows that
𝕍(a X + b) = a2 𝕍X .
(iv) In the case of independent X and Y, one has
𝕍(X + Y) = 𝕍X + 𝕍Y .
Proof. Let us begin with the proof of (i). With μ = 𝔼X, we obtain
𝕍X = 𝔼(X −μ)2 = 𝔼[X2 −2μX + μ2] = 𝔼X2 −2μ𝔼X + μ2
= 𝔼X2 −2μ2 + μ2 = 𝔼X2 −μ2 .
This proves (i).
To verify (ii), we use property (2) in Proposition 5.1.38. Then μ = 𝔼X = c, hence
ℙ{X −μ = 0} = 1. Another application of property (2) leads to
𝕍X = 𝔼(X −μ)2 = 0
as asserted.
5 The converse implication is also true. If 𝕍X = 0, then X is constant with probability 1.

5.2 Variance
౪
263
Next we prove (iii). If a, b ∈ℝ, then 𝔼(aX + b) = a𝔼X + b by the linearity of the
expected value. Consequently,
𝕍(aX + b) = 𝔼[aX + b −(a 𝔼X + b)]
2 = a2 𝔼(X −𝔼X)2 = a2 𝕍X .
Thus (iii) is valid.
To prove (iv), observe that, if μ := 𝔼X and ν := 𝔼Y, then 𝔼(X + Y) = μ + ν, and hence
𝕍(X + Y) = 𝔼[(X −μ) + (Y −ν)]
2
= 𝔼(X −μ)2 + 2 𝔼[(X −μ)(Y −ν)] + 𝔼(Y −ν)2
= 𝕍X + 2 𝔼[(X −μ)(Y −ν)] + 𝕍Y .
(5.35)
By Proposition 4.1.9, the independence of X and Y implies that of X −μ and Y −ν. There-
fore, from property (6) in Proposition 5.1.38, we derive
𝔼[(X −μ)(Y −ν)] = 𝔼(X −μ) ⋅𝔼(Y −ν) = (𝔼X −μ) ⋅(𝔼Y −ν) = 0 ⋅0 = 0 .
Plugging this into eq. (5.35) completes the proof of (iv).
Summary: Let X be a random variable with finite second moment. If μ denotes the expected value of X,
its variance is defined by 𝕍X = 𝔼(X −μ)2 = 𝔼X2 −(𝔼X)2 . The variance may be evaluated in the discrete,
respectively continuous case as follows:
𝕍X =
∞
∑
k=1
(xk −μ)2 ℙ{X = xk}
and
𝕍X =
∞
∫
−∞
(x −μ)2 p(x)dx .
Here the xks and p are the possible values of X and its density, respectively. The basic properties are
𝕍(aX + b) = a2𝕍X and 𝕍[X + Y] = 𝕍X + 𝕍Y for independent X and Y.
5.2.3 Variance of certain random variables
Our first objective is to describe the variance of a random variable uniformly distributed
on a finite set.
Proposition 5.2.16. If X is uniformly distributed on {x1, . . . , xN}, then
𝕍X = 1
N
N
∑
j=1
(xj −μ)2 ,
where μ is given by μ = 1
N ∑N
j=1 xj .
Proof. Because of pj = 1
N , 1 ≤j ≤N, this is a direct consequence of eq. (5.33). Recall that
μ was computed in eq. (5.7).

264
౪
5 Expected value, variance, and covariance
Example 5.2.17. Suppose X is uniformly distributed on {1, . . . , 6}. Then 𝔼X = 7/2, and
we get
𝕍X =
(1 −7
2)2 + (2 −7
2)2 + (3 −7
2)2 + (4 −7
2)2 + (5 −7
2)2 + (6 −7
2)2
6
=
25
4 + 9
4 + 1
4 + 1
4 + 9
4 + 25
4
6
= 35
12 .
Thus, when rolling a die once, the variance is given by 35
12.
Now assume that we roll the die n times. Let X1, . . . , Xn be the results of the single
rolls. The Xjs are independent, hence, if Sn = X1 + ⋅⋅⋅+ Xn denotes the sum of the n trials,
then, by (iv) in Proposition 5.2.15, it follows that
𝕍Sn = 𝕍(X1 + ⋅⋅⋅+ Xn) = 𝕍X1 + ⋅⋅⋅+𝕍Xn = 35 n
12 .
The next proposition examines the variance of binomial distributed random vari-
ables.
Proposition 5.2.18. If X is Bn,p-distributed, then
𝕍X = np(1 −p) .
(5.36)
Proof. Let X be Bn,p-distributed. In Example 5.1.47, we found 𝔼X2 = n2p2 + np (1 −p).
Moreover, 𝔼X = np by Proposition 5.1.13. Thus, using formula (5.34) we derive
𝕍X = 𝔼X2 −(𝔼X)2 = n2p2 + np(1 −p) −(np)2 = np(1 −p),
as asserted.
Remark 5.2.19. An alternative proof of Proposition 5.2.18 is as follows: if n = 1, then we
get
𝕍X = (1 −p)(0 −p)2 + p(1 −p)2 = p(1 −p)[p + (1 −p)] = p(1 −p) .
Thus, if X = X1 + ⋅⋅⋅+ Xn with Xjs independent B1,p-distributed, then, on the one hand, X
is Bn,p-distributed and, on the other hand, we obtain
𝕍X = 𝕍(X1 + ⋅⋅⋅+ Xn) = 𝕍X1 + ⋅⋅⋅+ 𝕍Xn = n𝕍X1 = np(1 −p) .
Corollary 5.2.20. Binomial distributed random variables have maximal variance (with n
fixed) if p = 1/2.
Proof. The function p 󳨃→np(1 −p) becomes maximal for p = 1
2. In the extreme cases
p = 0 and p = 1, the variance is zero.

5.2 Variance
౪
265
Corollary 5.2.21. Let (Sn)n≥0 be a random walk, that is, S0 = 0 and Sn = X1 + ⋅⋅⋅+ Xn if
n ≥1 where the Xis are independent and attaining the values −1 and 1 with probabilities
1 −p and p, respectively. Then, if n ≥1, it follows that
𝕍Sn = 4np(1 −p) .
(5.37)
Proof. As shown in Example 4.1.7, the random variables Yn = (Sn + n)/2 are Bn,p-
distributed. Applying (iii) of Proposition 5.2.15, together with eq. (5.36), implies
𝕍Sn = 𝕍(2Yn −n) = 4𝕍Yn = 4np(1 −p),
as asserted.
Next we determine the variance of Poisson distributed random variables.
Proposition 5.2.22. Let X be Poisλ-distributed for some λ > 0. Then
𝕍X = λ .
Proof. In Example 5.1.45, we computed 𝔼X2 = λ2 +λ. Furthermore, by Proposition 5.1.16,
we know that 𝔼X = λ. Thus, by eq. (5.34), we obtain, as asserted,
𝕍X = 𝔼X2 −(𝔼X)2 = λ2 + λ −λ2 = λ .
Next, we compute the variance of a geometrically distributed random variable.
Proposition 5.2.23. Let X be Gp-distributed for some 0 < p < 1. Then its variance equals
𝕍X = 1 −p
p2
.
Proof. In Example 5.1.47, we found 𝔼X2 = 2−p
p2 , and by eq. (5.15) we have 𝔼X = 1
p. Conse-
quently, formula (5.34) implies
𝕍X = 2 −p
p2
−( 1
p)
2
= 1 −p
p2
,
as asserted.
Corollary 5.2.24. If X is B−
n,p-distributed, then
𝕍X = n 1 −p
p2
Proof. Let X1, . . . , Xn be independent Gp-distributed random variables. By Corollary 4.6,
their sum X = X1 + ⋅⋅⋅+ Xn is B−
n,p-distributed, hence property (iv) in Proposition 5.2.15

266
౪
5 Expected value, variance, and covariance
lets us conclude that
𝕍X = 𝕍(X1 + ⋅⋅⋅+ Xn) = 𝕍X1 + ⋅⋅⋅+ 𝕍Xn = n 𝕍X1 = n 1 −p
p2
.
Interpretation: The smaller the p, the bigger the variance of a geometrically or neg-
ative binomial distributed random variable (for n fixed). This is not surprising, because
the smaller the p, the larger the expected value, and so the values of X may be very far
from 1/p (success is very unlikely).
We consider now variances of continuous random variables. Let us begin with uni-
formly distributed ones.
Proposition 5.2.25. Let X be uniformly distributed on an interval [α, β]. Then it follows
that
𝕍X = (β −α)2
12
.
Proof. We know by Proposition 5.1.27 that 𝔼X = (α + β)/2. In order to apply formula
(5.34), we still have to compute the second moment 𝔼X2. Here we obtain
𝔼X2 =
1
β −α
β
∫
α
x2 dx = 1
3 ⋅β3 −α3
β −α
= β2 + αβ + α2
3
.
Consequently, formula (5.34) lets us conclude that
𝕍X = 𝔼X2 −(𝔼X)2 = β2 + αβ + α2
3
−(α + β
2
)
2
= β2 + αβ + α2
3
−α2 + 2αβ + β2
4
= α2 −2αβ + β2
12
= (β −α)2
12
.
This completes the proof.
In the case of gamma distributed random variables, the following is valid.
Proposition 5.2.26. If X is Γα,β-distributed, then
𝕍X = α2β .
Proof. Recall that 𝔼X = αβ by Proposition 5.1.28. Furthermore, in Example 5.2.10 we
evaluated 𝔼Xn for a gamma distributed X. Taking n = 2 yields
𝔼X2 = α2 (β + 1) β ,

5.2 Variance
౪
267
and, hence, by eq. (5.34),
𝕍X = 𝔼X2 −(𝔼X)2 = α2 (β + 1) β −(αβ)2 = α2β,
as asserted.
Corollary 5.2.27. If X is Eλ-distributed, then
𝕍X = 1
λ2 .
Proof. Because of Eλ = Γ 1
λ ,1, this directly follows from Proposition 5.2.26.
Corollary 5.2.28. For a χ2
n-distributed X, it holds that
𝕍X = 2n .
Proof. Let us give two alternative proofs of the assertion. The first uses Proposition 5.2.26
and χ2
n = Γ2, n
2 .
The second proof is longer, but maybe more interesting. Let X1, . . . , Xn be indepen-
dent 𝒩(0, 1)-distributed random variables. Proposition 4.6.10 implies that X2
1 + ⋅⋅⋅+X2
n is
χ2
n-distributed, thus property (iv) of Proposition 5.2.15 applies and leads to
𝕍X = 𝕍X2
1 + ⋅⋅⋅+ 𝕍X2
n = n𝕍X2
1 .
In Example 5.2.12, we evaluated the moments of an 𝒩(0, 1)-distributed random variable.
In particular, 𝔼X2
1 = 1 and 𝔼(X2
1 )2 = 𝔼X4
1 = 3!! = 3, hence
𝕍X = n 𝕍X2
1 = n (𝔼X4
1 −(𝔼X2
1 )
2) = (3 −1)n = 2n,
as claimed.
Finally, we determine the variance of a normal random variable.
Proposition 5.2.29. If X is 𝒩(μ, σ2)-distributed, then it follows that
𝕍X = σ2 .
Proof. Of course, this could be proven by computing the integral
𝕍X =
∞
∫
−∞
(x −μ)2pμ,σ(x)dx .
We prefer a different approach that avoids the calculation of integrals. Because of Propo-
sition 4.2.3, the random variable X may be represented as X = σX0 + μ for a standard
normal X0. Applying (iii) in Proposition 5.2.15 gives

268
౪
5 Expected value, variance, and covariance
𝕍X = σ2 𝕍X0 .
(5.38)
But 𝔼X0 = 0, and by Example 5.2.12 we have 𝔼X2
0 = 1, thus
𝕍X0 = 1 −0 = 1 .
Plugging this into eq. (5.38) proves 𝕍X = σ2.
Remark 5.2.30. The previous result explains why the parameter σ2 is called the “vari-
ance” of an 𝒩(μ, σ2)-distributed random variable. Recall that the other parameter μ de-
notes its expected value. Moreover, it shows that the smaller the σ2 > 0, the more are the
values of an 𝒩(μ, σ2)-distributed random variable concentrated around the expected
value μ; see Figure 5.2.
Figure 5.2: Densities of normal distributions with mean value 0 and variances (from bottom to top)
σ2 = 1.7, σ2 = 1, and σ2 = 0.7. The larger the σ2, the more likely are events away from zero.
Summary: Let X be some random variable. Then we have
1.
X uniformly distributed on {x1, . . . , xN}
⇒
𝕍X = (x1−μ)2+⋅⋅⋅+(xN−μ)2
N
with μ = 𝔼X.
2.
X ∼Bn,p
⇒
𝕍X = n p(1 −p).
3.
X ∼Poisλ
⇒
𝕍X = λ.
4.
X ∼B−
n,p
⇒
𝕍X = n(1−p)
p2
.
5.
X uniformly distributed on [α, β]
⇒
𝕍X = (β−α)2
12
.
6.
X ∼Γα,β
⇒
𝕍X = α2β.
7.
X ∼Eλ,n
⇒
𝕍X = n
λ2 .
8.
X ∼χ2
n
⇒
𝕍X = 2n.
9.
X ∼𝒩(μ, σ2)
⇒
𝕍X = σ2.

5.3 Covariance and correlation
౪
269
5.3 Covariance and correlation
5.3.1 Covariance
Suppose we know or conjecture that two given random variables X and Y are depen-
dent. The aim of this section is to introduce a quantity that measures their degree of
dependence. Such a quantity should tell us whether the random variables are strongly
or only weakly dependent. Furthermore, we want to know what kind of dependence we
observe. Do larger values of X trigger larger values of Y or is it the other way round? To
illustrate these questions, let us come back to the experiment presented in Example 2.2.5.
Example 5.3.1. In an urn are n balls labeled with “0” and another n balls labeled with
“1.” Choose two balls out of the urn without replacement. Let X be the number appearing
on the first ball and Y that on the second. Then X and Y are dependent (check this), but
it is intuitively clear that if n becomes larger, then their dependence diminishes. We ask
for a quantity that tells us their degree of dependence. This measure should decrease as
n increases and it should tend to zero as n →∞.
Moreover, if X = 1 occurred, then there remained in the urn more balls with “0”
than with “1,” and the probability of the event Y = 0 increases. Thus, larger values of X
make smaller values of Y more likely.
Before we are able to introduce such a “measure of dependence,” we need some
preparation.
Proposition 5.3.2. If two random variables X and Y possess a finite second moment, then
the expected value of their product XY exists.
Proof. We use the elementary estimate |ab| ≤a2+b2
2
valid for a, b ∈ℝ. Thus, if ω ∈Ω,
then
󵄨󵄨󵄨󵄨X(ω)Y(ω)󵄨󵄨󵄨󵄨≤X(ω)2
2
+ Y(ω)2
2
,
that is, we have
|XY| ≤X2
2 + Y 2
2 .
(5.39)
By assumption,
𝔼[X2
2 + Y 2
2 ] = 1
2[𝔼X2 + 𝔼Y 2] < ∞,
consequently, because of estimate (5.39), property (7) in Proposition 5.1.38 applies and
tells us that 𝔼|XY| < ∞. Thus, 𝔼[XY] exists as asserted.

270
౪
5 Expected value, variance, and covariance
How do we compute 𝔼[XY] for given X and Y? In Section 4.5 we observed that the
distribution of X + Y does not only depend on the distributions of X and Y. We have to
know their joint distribution, that is, the distribution of the vector (X, Y). And the same
is true for products and the expected value of the product.
Example 5.3.3. Let us again investigate the random variables X, Y, X′, and Y ′ intro-
duced in Example 3.5.8. Recall that they satisfied
ℙ{X = 0, Y = 0} = 1
6 ,
ℙ{X = 0, Y = 1} = 1
3 ,
ℙ{X = 1, Y = 0} = 1
3 ,
ℙ{X = 1, Y = 1} = 1
6 ,
ℙ{X′ = 0, Y ′ = 0} = 1
4 ,
ℙ{X′ = 0, Y ′ = 1} = 1
4 ,
ℙ{X′ = 1, Y ′ = 0} = 1
4 ,
ℙ{X′ = 1, Y ′ = 1} = 1
4.
Then ℙX = ℙX′ and ℙY = ℙY ′, but
𝔼[XY] = 1
6 (0 ⋅0) + 1
3 (1 ⋅0) + 1
3 (0 ⋅1) + 1
6 (1 ⋅1) = 1
6
and
𝔼[X′Y ′] = 1
4 (0 ⋅0) + 1
4 (1 ⋅0) + 1
4 (0 ⋅1) + 1
4 (1 ⋅1) = 1
4 .
This example tells us that we have to know the joint distribution in order to compute
𝔼[XY]. The knowledge of the marginal distributions does not suffice.
To evaluate 𝔼[XY], we need the following two-dimensional generalization of for-
mulas (5.23) and (5.24).
Proposition 5.3.4. Let X and Y be two random variables and let f : ℝ2 →ℝbe some
function.
1.
Suppose X and Y are discrete with values in {x1, x2, . . .} and in {y1, y2, . . .}. Set
pij = ℙ{X = xi, Y = yj}. If
𝔼󵄨󵄨󵄨󵄨f (X, Y)󵄨󵄨󵄨󵄨=
∞
∑
i,j=1
󵄨󵄨󵄨󵄨f (xi, yj)󵄨󵄨󵄨󵄨pij < ∞,
(5.40)
then 𝔼f (X, Y) exists and can be computed by
𝔼f (X, Y) =
∞
∑
i,j=1
f (xi, yj) pij .
2.
Let f : ℝ2 →ℝbe continuous.6 If p : ℝ2 →ℝis the joint density of (X, Y) (as intro-
6 In fact, we need only a measurability in the sense of Definition 4.1.1, but this time for functions f from
ℝ2 to ℝ. For our purposes “continuity” of f suffices.

5.3 Covariance and correlation
౪
271
duced in Definition 3.5.15), then
𝔼󵄨󵄨󵄨󵄨f (X, Y)󵄨󵄨󵄨󵄨=
∞
∫
−∞
∞
∫
−∞
󵄨󵄨󵄨󵄨f (x, y)󵄨󵄨󵄨󵄨p(x, y) dxdy < ∞
(5.41)
implies the existence of 𝔼f (X, Y), which can be evaluated by
𝔼f (X, Y) =
∞
∫
−∞
∞
∫
−∞
f (x, y) p(x, y) dxdy .
(5.42)
Remark 5.3.5. The previous formulas extend easily to higher dimensions. That is, if
⃗X = (X1, . . . , Xn) is an n-dimensional random vector with (joint) distribution density
p : ℝn →ℝ, then for continuous7 f : ℝn →ℝone has
𝔼f ( ⃗X) = 𝔼f (X1, . . . , Xn) = ∫
ℝn
f (x1, . . . , xn) p(x1, . . . , xn) dxn ⋅⋅⋅dx1
provided the integral exists. The case of discrete X1, . . . , Xn is treated in a similar way. If
⃗X maps into the finite or countably infinite set D ⊂ℝn, then
𝔼f ( ⃗X) = 𝔼f (X1, . . . , Xn) = ∑
x∈D
f (x)ℙ{ ⃗X = x} .
If we apply Proposition 5.3.4 with f : (x, y) 󳨃→x ⋅y, then we obtain the following
formulas for the evaluation of 𝔼[XY]. Hereby, we assume that conditions (5.40) or (5.41)
are satisfied.
Corollary 5.3.6. In the notation of Proposition 5.3.4, the following are valid:
𝔼[XY] =
∞
∑
i,j=1
(xi ⋅yj)pij
and
𝔼[XY] =
∞
∫
−∞
∞
∫
−∞
(x ⋅y) p(x, y) dxdy
in the discrete and continuous case, respectively.
After all these preparations, we are now in a position to introduce the covariance
of two random variables.
Definition 5.3.7. Let X and Y be two random variables with finite second moments. Setting μ = 𝔼X and
ν = 𝔼Y, the covariance of X and Y is defined as
Cov(X, Y) = 𝔼[(X −μ)(Y −ν)] .
7 Compare with the footnote for n = 2 in part 2 of Proposition 5.3.4.

272
౪
5 Expected value, variance, and covariance
Remark 5.3.8. Apply Corollary 5.2.9 and Proposition 5.3.2 to see that the covariance is
well defined for random variables with a finite second moment. Furthermore, in view
of Proposition 5.3.4, the covariance may be computed as
Cov(X, Y) =
∞
∑
i,j=1
(xi −μ)(yj −ν) pij
in the discrete case (recall that pij = ℙ{X = xi, Y = yj}), and as
Cov(X, Y) =
∞
∫
−∞
∞
∫
−∞
(x −μ) (y −ν) p(x, y) dxdy
in the continuous case.
Example 5.3.9. Let us once more consider the random variables X, Y, X′, and Y ′ in Ex-
ample 3.5.8 or Example 5.3.3, respectively. Each of the four random variables has the
expected value 1/2. Therefore, we obtain
Cov(X, Y) = 1
6 (0 −1
2) ⋅(0 −1
2) + 1
3 (1 −1
2) ⋅(0 −1
2)
+ 1
3 (0 −1
2) ⋅(1 −1
2) + 1
6 (1 −1
2) ⋅(1 −1
2) = −1
12 ,
while
Cov(X′, Y ′) = 1
4 (0 −1
2) ⋅(0 −1
2) + 1
4 (1 −1
2) ⋅(0 −1
2)
+ 1
4 (0 −1
2) ⋅(1 −1
2) + 1
4 (1 −1
2) ⋅(1 −1
2) = 0 .
The following proposition summarizes the main properties of the covariance.
Proposition 5.3.10. Let X and Y be random variables with finite second moments. Then
the following are valid:
(1) Cov(X, Y) = Cov(Y, X).
(2) Cov(X, X) = 𝕍X.
(3) The covariance is bilinear, that is, for X1, X2 and real numbers a1 and a2,
Cov(a1X1 + a2X2, Y) = a1Cov(X1, Y) + a2Cov(X2, Y)
and, analogously,
Cov(X, b1Y1 + b2Y2) = b1Cov(X, Y1) + b2Cov(X, Y2),
for random variables Y1, Y2 and real numbers b1, b2.

5.3 Covariance and correlation
౪
273
(4) The covariance may also evaluated by
Cov(X, Y) = 𝔼[XY] −(𝔼X)(𝔼Y) .
(5.43)
(5) Cov(X, Y) = 0 for independent X and Y.
Proof. Properties (1) and (2) follow directly from the definition of the covariance.
Let us verify (3). Setting μ1 = 𝔼X1 and μ2 = 𝔼X2, the linearity of the expected value
implies
𝔼(a1X1 + a2X2) = a1μ1 + a2μ2 .
Hence, if ν = 𝔼Y, then
Cov(a1X1 + a2X2, Y) = 𝔼[(a1(X1 −μ1) + a2(X2 −μ2))(Y −ν)]
= a1𝔼[(X1 −μ1)(Y −ν)] + a2𝔼[(X2 −μ2)(Y −ν)]
= a1Cov(X1, Y) + a2Cov(X2, Y) .
This proves the first part of (3). The second part can be proven in the same way or one
uses Cov(X, Y) = Cov(Y, X) and the first part of (3).
Next we prove eq. (5.43). With μ = 𝔼X and ν = 𝔼Y, from
(X −μ)(Y −ν) = XY −μY −νX + μν ,
we get that
Cov(X, Y) = 𝔼[XY −μY −νX + μν] = 𝔼[XY] −μ𝔼Y −ν𝔼X + μν
= 𝔼[XY] −μν .
This proves (4) by the definition of μ and ν.
Finally, we verify (5). If X and Y are independent, then, by Proposition 4.1.9, this is
also true for X −μ and Y −ν. Thus, property (6) of Proposition 5.1.38 applies and leads to
Cov(X, Y) = 𝔼[(X −μ)(Y −ν)] = 𝔼(X −μ) 𝔼(Y −ν) = [𝔼X −μ] [𝔼Y −ν] = 0 .
Therefore, the proof is completed.
Remark 5.3.11. Quite often the computation of Cov(X, Y) can be simplified by the use
of eq. (5.43). For example, consider X and Y in Example 3.5.8. In Example 5.3.3 we found
𝔼[XY] = 1/6. Since 𝔼X = 𝔼Y = 1/2, from eq. (5.43) we immediately get
Cov(X, Y) = 1
6 −1
4 = −1
12 .
We obtained the same result in Example 5.3.9 with slightly more effort.

274
౪
5 Expected value, variance, and covariance
Property (5) in Proposition 5.3.10 is of special interest. It asserts Cov(X, Y) = 0 for in-
dependent X and Y. One may ask now whether this characterizes independent random
variables. More precisely, are the random variables X and Y independent if and only if
Cov(X, Y) = 0?
The answer is negative as the next example shows.
Example 5.3.12. The joint distribution of X and Y is given by the following table:
Y\X
−1
0
1
−1
1
10
1
10
1
10
3
10
0
1
10
2
10
1
10
2
5
1
1
10
1
10
1
10
3
10
3
10
2
5
3
10
Of course, 𝔼X = 𝔼Y = 0 and, moreover,
𝔼[XY] = 1
10((−1)(−1) + (−1)(+1) + (+1)(−1) + (+1)(+1)) = 0 ,
which by eq. (5.43) implies Cov(X, Y) = 0. On the other hand, Proposition 3.6.11 tells us
that X and Y are not independent. For example,
ℙ{X = 0, Y = 0} = 1
5
while ℙ{X = 0}ℙ{Y = 0} = 4
25.
Example 5.3.12 shows that Cov(X, Y) = 0 is, in general, weaker than the indepen-
dence of X and Y. Therefore, the following definition makes sense.
Definition 5.3.13. Two random variables X and Y satisfying Cov(X, Y) = 0 are said to be uncorrelated.
Otherwise, if Cov(X, Y)
̸= 0, then X and Y are correlated.
More generally, a sequence X1, . . . , Xn of random variables is called (pairwise) uncorrelated, if
Cov(Xi, Xj) = 0 whenever i
̸= j.
Using this notation, property (5) in Proposition 5.3.10 may now be formulated in the
following way:
X and Y independent
󳨐⇒
̸
⇐󳨐
X and Y uncorrelated.
Example 5.3.14. Let A, B ∈𝒜be two events in a probability space (Ω, 𝒜, ℙ) and let 1A
and 1B be their indicator functions as introduced in Definition 3.6.16. How can we com-
pute Cov(1A, 1B)?

5.3 Covariance and correlation
౪
275
Answer: Since 𝔼1A = ℙ(A), we get
Cov(1A, 1B) = 𝔼[1A 1B] −(𝔼1A)(𝔼1B) = 𝔼1A∩B −ℙ(A) ℙ(B)
= ℙ(A ∩B) −ℙ(A) ℙ(B) .
This tells us that 1A and 1B are uncorrelated if and only if the events A and B are in-
dependent. But as we saw in Proposition 3.6.17, this happens if and only if the random
variables 1A and 1B are independent. In other words, two indicator functions are inde-
pendent if and only if they are uncorrelated.
Finally, we consider the covariance of two continuous random variables.
Example 5.3.15. Suppose a random vector (X, Y) is uniformly distributed on the unit
ball of ℝ2. Then the joint density of (X, Y) is given by
p(x, y) = {
1
π
if x2 + y2 ≤1,
0
if x2 + y2 > 1 .
We proved in Example 3.5.19 that X and Y possess the distribution densities
q(x) = {
2
π √1 −x2
if |x| ≤1,
0
if |x| > 1
and
r(y) =
{
{
{
2
π √1 −y2
if |y| ≤1,
0
if |y| > 1.
The function y 󳨃→y (1−y2)1/2 is odd. Consequently, because we integrate over an interval
symmetric around the origin,
𝔼X = 𝔼Y = 2
π
1
∫
−1
y (1 −y2)
1/2 dy = 0 .
By the same argument, we obtain
𝔼[XY] =
∞
∫
−∞
∞
∫
−∞
(x ⋅y) p(x, y) dx dy = 1
π
1
∫
−1
y[
√1−y2
∫
−√1−y2
x dx]dy = 0 ,
and these two assertions imply Cov(X, Y) = 0. Hence, X and Y are uncorrelated, but as
we already observed in Example 3.6.21, they are not independent.
Summary: Let X and Y be two random variables with second moment and expected values μ and ν, respec-
tively. Then
Cov(X, Y) = 𝔼[(X −μ)(Y −ν)] = 𝔼[X Y] −(𝔼X)(𝔼Y)

276
౪
5 Expected value, variance, and covariance
denotes the covariance of X and Y. It can be evaluated in the discrete case as follows:
Cov(X, Y) =
∞
∑
i,j=1
(xi −μ)(yj −ν)ℙ{X = xi, Y = yj} .
If X and Y are continuous with joint density p, then
Cov(X, Y) =
∞
∫
−∞
∞
∫
−∞
(x −μ)(y −ν)p(x, y) dxdy .
5.3.2 Correlation coefficient
The question arises whether or not the covariance is the quantity that we are looking
for, that is, which measures the degree of dependence. The answer is only partially af-
firmative. Why? Suppose X and Y are dependent. If a is a nonzero real number, then a
natural demand is that the degree of dependence between X and Y should be the same
as that between aX and Y. But
Cov(aX, Y) = a Cov(X, Y) ,
thus, if a
̸= 1, then the measure of dependence would increase or decrease. To overcome
this drawback, we normalize the covariance in the following way.
Definition 5.3.16. Let X and Y be random variables with finite second moments. Furthermore, we as-
sume that neither X nor Y are constant with probability 1, that is, we have 𝕍X > 0 and 𝕍Y > 0. Then the
quotient
ρ(X, Y) :=
Cov(X, Y)
(𝕍X)1/2(𝕍Y)1/2
(5.44)
is called the correlation coefficient of X and Y.
To verify a crucial property of the correlation coefficient, we need the following version
of the Cauchy–Schwarz inequality.
Proposition 5.3.17 (Cauchy–Schwarz inequality). For any two random variables X and Y
with finite second moments, it follows that
󵄨󵄨󵄨󵄨𝔼(XY)󵄨󵄨󵄨󵄨≤(𝔼X2)
1/2 (𝔼Y 2)
1/2 .
(5.45)
Proof. By property (8) of Proposition 5.1.38, we have
0 ≤𝔼(|X| −λ|Y|)
2 = 𝔼X2 −2λ𝔼|XY| + λ2 𝔼Y 2
(5.46)

5.3 Covariance and correlation
౪
277
for any λ ∈ℝ. To proceed further, we have to assume8 𝔼X2 > 0 and 𝔼Y 2 > 0. The latter
assumption allows us to choose λ as
λ := (𝔼X2)1/2
(𝔼Y 2)1/2 .
If we apply inequality (5.46) with this λ, then we obtain
0 ≤EX2 −2 (𝔼X2)1/2
(𝔼Y 2)1/2 𝔼|XY| + 𝔼X2 = 2 EX2 −2 (𝔼X2)1/2
(𝔼Y 2)1/2 𝔼|XY| ,
which easily implies (recall that we assumed 𝔼X2 > 0)
𝔼|XY| ≤(𝔼X2)
1/2 (𝔼Y 2)
1/2 .
To complete the proof, we use Corollary 5.1.41 and get
󵄨󵄨󵄨󵄨𝔼(XY)󵄨󵄨󵄨󵄨≤𝔼|XY| ≤(𝔼X2)
1/2 (𝔼Y 2)
1/2,
as asserted.
Remark 5.3.18. An analogue inequality as (5.45) for vectors in ℝn is as follows: let
x = (x1, . . . , xn) and y = (y1, . . . , yn) be two elements in ℝn. Then one has
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
n
∑
j=1
xjyj
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
≤(
n
∑
j=1
x2
j )
1/2
(
n
∑
j=1
y2
j )
1/2
.
In the language of scalar products and Euclidean distance, this says
󵄨󵄨󵄨󵄨⟨x, y⟩󵄨󵄨󵄨󵄨≤|x| |y| .
Corollary 5.3.19. The correlation coefficient satisfies
−1 ≤ρ(X, Y) ≤1 .
Proof. Let as before μ = 𝔼X and ν = 𝔼Y. Applying inequality (5.45) to X −μ and Y −ν
leads to
󵄨󵄨󵄨󵄨Cov(X, Y)󵄨󵄨󵄨󵄨= 󵄨󵄨󵄨󵄨𝔼(X −μ)(Y −ν)󵄨󵄨󵄨󵄨≤(𝔼(X −μ)2)
1/2 (𝔼(Y −ν)2)
1/2
= (𝕍X)1/2 (𝕍Y)1/2 ,
8 The Cauchy–Schwarz inequality remains valid for 𝔼X2 = 0 or 𝔼Y 2 = 0. In this case, it follows that
ℙ{X = 0} = 1 or ℙ{Y = 0} = 1, hence ℙ{XY = 0} = 1 and 𝔼[XY] = 0.

278
౪
5 Expected value, variance, and covariance
or, equivalently,
−(𝕍X)1/2 (𝕍Y)1/2 ≤Cov(X, Y) ≤(𝕍X)1/2 (𝕍Y)1/2 .
By the definition of ρ(X, Y) given in eq. (5.44), this implies −1 ≤ρ(X, Y) ≤1, as as-
serted.
Interpretation: For uncorrelated X and Y, we have ρ(X, Y) = 0. In particular, this is
valid if X and Y are independent. On the contrary, ρ(X, Y)
̸= 0 tells us that X and Y are
dependent. Thereby, values near to zero correspond to weak dependence, while ρ(X, Y)
near 1 or −1 indicate a strong dependence. The strongest possible dependence is when
Y = aX for some a
̸= 0. Then ρ(X, Y) = 1 if a > 0 while ρ(X, Y) = −1 for a < 0.
Definition 5.3.20. Two random variables X and Y are said to be positively correlated if ρ(X, Y) > 0. In
the case that ρ(X, Y) < 0, they are said to be negatively correlated.
Interpretation: Random variables X and Y are positively correlated, provided that larger
(or smaller) values of X make larger (or smaller) values of Y more likely. This does not
mean that a larger X-value always implies a larger Y-value, only that the probability for
those larger values increases. And in the same way, if X and Y are negatively correlated,
then larger values of X make smaller Y-values more likely.
Let us explain this with two typical examples. Choose by random a person ω in the
audience. Let X(ω) be his or her height and Y(ω) his or her weight. Then X and Y will
surely be positively correlated. But this does not necessarily mean that each taller per-
son has a bigger weight. Another example of negatively correlated random variables
could be as follows: X is the average number of cigarettes that a randomly chosen per-
son smokes per day and Y is his lifetime.
Example 5.3.21. Let us come back to Example 5.3.1: in an urn there are n balls labeled
with “0” and n labeled with “1.” One chooses two balls without replacement. Then X is
the value of the first ball, Y that of the second. How does the correlation coefficient of X
and Y depend on n?
Answer: The joint distribution of X and Y is given by the following table:
Y\X
0
1
0
n−1
4n−2
n
4n−2
1
2
1
n
4n−2
n−1
4n−2
1
2
1
2
1
2
Direct computations show 𝔼X = 𝔼Y = 1/2 and 𝕍X = 𝕍Y = 1/4. Moreover, it easily
follows 𝔼[XY] =
n−1
4n−2, hence
Cov(X, Y) = n −1
4n −2 −1
4 =
−1
8n −4 ,

5.4 Some paradoxes and examples
౪
279
and the correlation coefficient equals
ρ(X, Y) =
−1
8n−4
√1
4√1
4
=
−1
2n −1 .
If n →∞, then ρ(X, Y) is of order −1
2n. Hence, if n is large, then the random variables X
and Y are “almost” uncorrelated.
Since ρ(X, Y) < 0, the two random variables are negatively correlated. Why? This
was already explained in Example 5.3.1: an occurrence of X = 1 makes Y = 0 more likely,
while the occurrence of X = 0 increases the likelihood of Y = 1. In the case n = 1, the
value of Y is completely determined by that of X, expressed by ρ(X, Y) = −1.
Summary: Let X and Y be two random variables with finite second moment. Then
ρ(X, Y) :=
Cov(X, Y)
(𝕍X)1/2(𝕍Y)1/2
is said to be their correlation coefficient. The random variables are said to be positively correlated if
ρ(X, Y) > 0, negatively correlated if ρ(X, Y) < 0, and uncorrelated if ρ(X, Y) = 0. The basic properties
are −1 ≤ρ(X, Y) ≤1 and ρ(X, Y) = 0 for independent X and Y. But note that uncorrelated X and Y need not
be independent.
5.4 Some paradoxes and examples
The aim of this section is to present a few more comprehensive examples of special
interest having a long history.
5.4.1 Boy or girl paradox
In 1959 Martin Gardner9 phrased the following two questions:
1.
Mr. Jones has two children. The older child is a girl. What is the probability that both
children are girls?
2.
Mr. Smith has two children. At least one of them is a boy. What is the probability
that both children are boys?
The basic assumptions for answering these questions are:
(a) Each child is either a boy or a girl.
9 Martin Gardner, Problems involving questions of probability and ambiguity, Scientific American, Octo-
ber 1959.

280
౪
5 Expected value, variance, and covariance
(b) Boys and girls occur equally likely.
(c) The gender of the two children is independent of each other.
Answers: There are 4 different possibilities for the gender of the two children:
(G, G),
(B, G),
(G, B),
and
(B, B) .
For example, (B, G) means that the older child is a boy while the younger one is a girl.
In view of the basic assumptions, all 4 elementary events are equally likely, hence their
probability is 1/4.
Solution of the first question: Here one asks for the probability of {(G, G)} under the
condition {(G, B), (G, G)}. So we get
ℙ({(G, G)}|{(G, B), (G, G)}) =
ℙ({(G, G)})
ℙ({(G, B), (G, G)}) = 1/4
1/2 = 1
2 .
First solution of the second question: One chooses by random a family with two children.
Let the event A occur if the chosen family has at least one boy. That is,
A = {(B, G), (G, B), (B, B)} ,
hence ℙ(A) = 3/4. In question 2, we asked for the probability of the occurrence of {(B, B)}
under the condition A. Then we get
ℙ({(B, B)}|A) = ℙ({(B, B)})
ℙ(A)
= 1/4
3/4 = 1
3 .
We obtained this result by restricting the sample space and ruling out families with two
girls.
Alternative solution of the second question: We split the problem into two steps. In the
first step, one chooses at random a family with two children. But we do not have any
information about the gender of these children. Any of the four configurations (G, G),
(G, B), (B, G), and (B, B) is possible, each occurring with probability 1/4.
Next, in the second step, we choose equiprobable one of the two children of the
family, that is, of the family chosen in the first step. The result may be “B” or “G.” Set
S = {Second step leads to “B”} .
Thus, if the randomly chosen family with two children has a boy and a girl, then the
second step will lead equally likely to “B” and to “G.” Consequently,
ℙ(S|{(B, G)}) = ℙ(S|{(G, B)}) = 1
2 .

5.4 Some paradoxes and examples
౪
281
On the other hand, if the chosen family has either two girls or two boys, then it follows
that
ℙ(S|{(G, G)}) = 0
or
ℙ(S|{(B, B)}) = 1 ,
respectively.
By symmetry (recall that “B” and “G” are equally likely), one should have that ℙ(S) =
1/2. A rigorous proof is based on the law of total probability. It implies
ℙ(S) = ℙ{(G, G)} ⋅ℙ(S|(G, G)) + ℙ{(B, G)} ⋅ℙ(S|(B, G))
+ ℙ{(G, B)} ⋅ℙ(S|(G, B)) + ℙ{(B, B)} ⋅ℙ(S|(B, B))
= 1
4 ⋅0 + 1
4 ⋅1
2 + 1
4 ⋅1
2 + 1
4 ⋅1 = 1
2 .
This lets us conclude that
ℙ({(B, B)}|S) = ℙ(S|{(B, B)}) ⋅ℙ({(B, B)})
ℙ(S)
= 1 ⋅1/4
1/2 = 1
2 .
Consequently, the answer to the second question is: the probability for both children
being boys knowing that at least one child is a boy equals 1/2.
For the sake of completeness, we also state the other probabilities. These are
ℙ({(G, G)}|S) = 0 and
ℙ({(G, B)}|S) = ℙ({(B, G)}|S) = ℙ(S|{(B, G)}) ⋅ℙ({(B, G)})
ℙ(S)
= 1
2 ⋅1/4
1/2 = 1
4 .
The obtained result may also be phrased as follows: the a priori probabilities of getting
(G, G), (G, B), (B, G), and (B, B) (the probabilities before choosing randomly a child) are
all 1/4 while the a posteriori probabilities (after observing a “B” in the second step) are
0, 1/4, 1/4, and 1/2, respectively.
Remark 5.4.1. One may wonder how it is possible that the answer to question 2 is at
the same time 1/3 and 1/2. Maybe there is some error in the calculations. This is not so.
The reason lies in the ambiguity of the way to use the information “At least one child
is a boy.” In the first approach, we use this information to rule out families with two
girls from the very beginning. That is, if we chose at random a family with two girls, we
discard it and make another trial.
The alternative approach looks more natural, at least to us. Choose at random any
family with two children. Then all four possibilities of the distribution of boys and girls
may occur. Having the family fixed, we check whether or not a randomly chosen child
(maybe the older, maybe the younger) is a boy. For example, we chose the family of Mr.
Smith, and we see him walking with one of his children who is a boy. There is a 50 %
chance that this is his older child, but, of course, it also could be the younger one.

282
౪
5 Expected value, variance, and covariance
5.4.2 Randomly chosen entries
Let us extend the boy or girl paradox to a more general setting. It reads as follows: toss
a fair coin labeled by “0” and “1” exactly n ≥2 times, without recording the obtained
results. After that, one gets the information that one of n the entries equals one. Given
some 1 ≤k ≤n, the question is now how likely is it that the observed sequence contains
exactly k times the number “1.”
Note that in the case n = k = 2 this is exactly question 2 in Section 5.4.1. To see this
link “B” with “1” and “G” with “0.”
But also here, in this generalized setting, the information that one of the entries
equals “1” can be interpreted in different ways.
One possible interpretation of the problem is to discard from the very beginning
sequences without “1.” So the restricted sample space contains 2n −1 elements. Conse-
quently, if Ak is the event to observe k times “1,” then
ℙ(Ak|{At least one “1”}) =
(n
k)
2n −1
k = 1, . . . , n .
Of course, ℙ(A0|{At least one “1”}) = 0.
Another interpretation of the problem is as follows: one chooses at random a se-
quence x = (x1, . . . , xn) of “0”s and “1”s. The probability of its occurrence is 1/2n. Next one
fixes the observed x = (x1, . . . , xn) and chooses at random one of its entries (all entries
are equally likely), say xj for some j ≤n. Then the event xj = 1 occurs with probability
k/n, where k is the number of “1”s in the chosen sequence x. Thus, if
S := {The randomly chosen entry equals “1”} ,
it follows that
ℙ(S|{x}) = k
n
whenever x ∈Ak .
Recall that Ak denotes the set of all sequences of “0” and “1” with k times “1.” The law
of total probability yields (see the proof of Proposition 5.1.13 for the evaluation of the
sum)
ℙ(S) =
n
∑
k=1
∑
x∈Ak
ℙ({x}) ⋅ℙ(S|{x}) =
n
∑
k=1
∑
x∈Ak
1
2n ⋅k
n
=
1
n2n
n
∑
k=1
k (n
k) =
1
n2n ⋅(n2n−1) = 1
2 .
This result is not surprising at all and could also obtained heuristically. Indeed, by sym-
metry the occurrence of “0” and “1” has to be equally likely.

5.4 Some paradoxes and examples
౪
283
Consequently, if x ∈Ak, then
ℙ({x}|S) = ℙ(S|{x}) ⋅ℙ({x})
ℙ(S) = k
n ⋅1
2n ⋅1
2−1 =
k
n 2n−1 .
Finally, since |Ak| = (n
k), the additivity of conditional probabilities leads to
ℙ(Ak|S) = (n
k) ⋅
k
n 2n−1 = (n −1
k −1) ⋅
1
2n−1 ,
k = 1, . . . , n .
Summing up, we received the following result.
Proposition 5.4.2. Let n ≥1. Tossing a fair coin n times, then for all 1 ≤k ≤n it follows
that
ℙ{Observe k times “1” | Randomly chosen entry is “1”} = (n −1
k −1) ⋅
1
2n−1 .
Example 5.4.3. If we apply Proposition 5.4.2 to the case n = k = 2, we rediscover the
answer given in Section 5.4.1. Indeed, then
ℙ{Both children are boys | A randomly chosen child is a boy} = 1
2 .
Another case of interest is as follows: one asks for the probability that a family with
three children has two boys, provided a randomly chosen child is a boy. Then n = 3
and k = 2, hence the probability for this event equals 2 ⋅1/4 = 1/2. Equivalently, under
the given condition, each of the events {(G, B, B)}, {(B, G, B)}, and {(B, B, G)} occurs with
probability 1/6. On the other hand, if a randomly chosen child of the three ones is a boy,
the occurrence of three boys possesses the probability 1/4. Without that knowledge, the
probability of {(B, B, B)} equals 1/8.
Remark 5.4.4. Proposition 5.4.2 tells us that the left-hand probability coincides with that
of the occurrence of k−1 times “1” when tossing a fair coin n−1 times. There is a straight-
forward explanation of this coincidence. In the presented setting, we first toss the coin
and next choose randomly an entry of the observed sequence of zeroes and ones. But
we could do it also the other way round: first choosing randomly a number from 1 to n
and after that tossing the coin. We leave the details as problem for the interested reader
(see Problem 5.25).
5.4.3 Secretary problem
This is a well-known problem in Probability Theory, also called “marriage problem” or
the “sultan’s dowry problem.”
A company wants to hire a secretary. There are n applicants interviewed in random
order. Immediately after the interview, the administrator decides whether or not the

284
౪
5 Expected value, variance, and covariance
candidate is rejected or hired. Once rejected, the candidate cannot be recalled. The goal
of the company is to get the best applicant. To this end, every interviewed candidate is
ranked in a linear order. But note that the administrator has no information about the
quality of the unseen applicants.
Now the strategy of the administrator is a follows: Choose a number 0 ≤r ≤n −1,
interview the first r applicants and reject them all. After that choose the first candidate
who is better than all of the r rejected ones. If r = 0, then nobody is interviewed and the
first applicant is hired.
Questions: How likely is it that this strategy leads to the employment of the overall
best candidate? What is the optimal choice of the number r?
Before proceeding further, let us explain the problem with an easy example. Sup-
pose there are three candidates enumerated by 1, 2, and 3. We assume that applicant
2 is better than 1 and that candidate 3 is better than 2. Then there are 3! = 6 ways of
interviewing the applicants:
a = (1, 2, 3),
b = (1, 3, 2),
c = (2, 1, 3),
d = (2, 3, 1),
e = (3, 1, 2),
f = (3, 2, 1) .
If r = 0, only orderings (e) and (f ) lead to the best candidate. So, the chance for hiring
the best one is 2/6 = 1/3.
In the case r = 1, the company hires the best one in the cases (b), (c), and (d). Hence, the
chance to get the best one equals 1/2.
Finally, if r = 2, only (a) and (c) are successful. Thus, also here the chance to get the best
applicant is 1/3.
Summing up, if n = 3, then the optimal strategy is to choose r = 1. That is, reject
the first applicant and then choose the next one who is better than the first. Of course,
it may happen that there is nobody better than the first, which occurs in the cases (e)
and (f ). Then nobody is hired and the administrator failed to get the best applicant.
Let us transform the general problem into a mathematical setting. Name the can-
didates by numbers from 1, . . . , n and, without losing generality, let us assume that the
applicant n is the best, that applicant n −1 is the second best, and so on. Suppose now
the candidates are interviewed in the order π(1), π(2), . . . , π(n) for some permutation
π ∈Sn. In this context, the best applicant appears at position k if and only if π(k) = n or,
equivalently, π−1(n) = k.
It is assumed that all orderings of the applicants are equally likely, so we have to
endow the set Sn of permutations with the uniform distribution ℙ. That is, for all A ⊆Sn
we have
ℙ(A) = |A|
|Sn| = |A|
n! .
In particular, if
Ak := {π ∈Sn : π(k) = n},

5.4 Some paradoxes and examples
౪
285
it follows that
ℙ(Ak) = (n −1)!
n!
= 1
n ,
k = 1, . . . , n .
(5.47)
Recall that π ∈Ak if and only if the best applicant is at position k in the queue of candi-
dates.
Let P(r) be the probability to hire the best candidate when choosing the strategy of
rejecting the first r candidates.
If r = 0, then the best candidate is hired if and only if π(1) = n or, equivalently, if
and only if π ∈A1. Hence, we get in this case
P(0) = ℙ(A1) = 1
n .
Consider now an arbitrary 1 ≤r ≤n −1 and suppose that π ∈Ak for a certain 1 ≤k ≤n,
that is, the permutation satisfies π(n) = k. When does the administrator choose the best
applicant? This happens if and only if k > r and, moreover,
π(r + 1), . . . , π(k −1) < max{π(1), . . . , π(r)} .
(5.48)
Another way to formulate property (5.48) is as follows:
If
π(a) = max{π(1), . . . , π(k −1)},
then necessarily 1 ≤a ≤r .
(5.49)
This may also be expressed as follows: whenever π ∈Ak for some k ≥2, then the second
best candidate among the first k candidates has to be at position a for some a ≤r. Recall
that the best one occurs at position k. Compare the three possible situations discussed
in Figure 5.3.
Figure 5.3: In case (a), the company hires the best secretary while it fails to do so in the cases (b) and (c).
To proceed further, given 1 ≤a ≤k −1, define disjoint subsets Sa
k of Sn by
Sa
k := {π ∈Sn : π(a) = max{π(1), . . . , π(k −1)}} .

286
౪
5 Expected value, variance, and covariance
Verbally said, a permutation π belongs to Sa
k if and only if it attains its maximal value in
{1, . . . , k −1} at the given number a.
We claim now that if 2 ≤k ≤n, then
ℙ(Sa
k|Ak) =
1
k −1 ,
a = 1, . . . , k −1 .
(5.50)
Of course,10 ℙ(S1
k|Ak) = ⋅⋅⋅= ℙ(Sk−1
k
|Ak). Moreover, because k ≥2, there always exists a
best candidate among positions 1 and k −1, thus
1 = ℙ(
k−1
⋃
a=1
Sa
k|Ak) =
k−1
∑
a=1
ℙ(Sa
k|Ak) .
Clearly, these two properties prove eq. (5.50).
Summing up, in view of assertion (5.49), for a given order π(1), . . . , π(n) the strategy
leads to the best candidate if and only if
∃k > r,
∃1 ≤a ≤r ,
π ∈Sa
k ∩Ak
⇔
π ∈
n
⋃
k=r+1
[Ak ∩(
r
⋃
a=1
Sa
k)] .
(5.51)
Now we are prepared to evaluate P(r), the probability to choose the best applicant when
rejecting the first r candidates. Using (5.51), an application of the law of multiplication
together with eqs. (5.47) and (5.50) implies (recall that the Aks and the Sa
ks are disjoint
for fixed k)
P(r) = ℙ(
n
⋃
k=r+1
[Ak ∩(
r
⋃
a=1
Sa
k)]) =
n
∑
k=r+1
r
∑
a=1
ℙ(Ak ∩Sa
k)
=
n
∑
k=r+1
r
∑
a=1
ℙ(Sa
k|Ak)ℙ(Ak) = r
n
n
∑
k=r+1
1
k −1 = r
n
n−1
∑
k=r
1
k .
Conclusion: The optimal choice of the number 1 ≤r < n is that for which
r 󳨃→r
n
n−1
∑
k=r
1
k
(5.52)
becomes maximal. For example, if n = 30, the maximal value is attained at r = 11 and one
has P(11) = 0.378651. But note that also choices of r near to 11 lead to reasonably large
probabilities. For example, we have P(9) = 0.373139, P(10) = 0.377562, P(12) = 0.376711,
and P(13) = 0.371992. One should compare these values with the random choice of a
single candidate where the probability to get the best applicant equals 1/30 = 0.0 ̄3. See
also Figure 5.4.
10 If 1 ≤a, b ≤k −1, define a bijection between Sa
k and Sb
k by π 󳨃→π ∘ia,b where ia,b is the inversion of a
and b.

5.4 Some paradoxes and examples
౪
287
Figure 5.4: The values of P(r), 1 ≤r ≤29, in the case of 30 applicants.
Remark 5.4.5. For large numbers n, it might be quite difficult to find the number r < n
for which the function in (5.52) becomes maximal. Here assertion (5.29) may be helpful.
Using
r
n
n−1
∑
k=r
1
k = r
n
n−1
∑
k=1
1
k −r
n
r−1
∑
k=1
1
k ≈r
n(ln n −ln r) = r
n ln(n
r ) = −r
n ln( r
n) ,
it follows that for large n the optimal choice of r is r
n ∼x0 where x 󳨃→−x ln x becomes
maximal at x0. Methods from Calculus imply x0 = 1/e ≈0.367879. Thus, a rough choice
of the optimal r is 37 % of n. In the literature, this is quite often called the 37 %-rule.
If as above n = 30, then 30/e ≈11.0364 while 37 % of n = 30 gives 11.1. Thus, this also
leads to r = 11 as the optimal choice. Check Figure 5.5 to see that for large n one has
P(r) ≈−(r/n) ln(r/n).
5.4.4 Two-envelope paradox
We finally present a famous paradox in Probability Theory called the “two-envelope
paradox” or the “envelope exchange paradox.” Imagine you may choose one of two in-
distinguishable envelopes, both containing a certain amount of money. You do not know
how much money is in the envelopes, but you have the information that one of the two
envelopes contains twice as much as the other. Having chosen an envelope at will, you
inspect it, and find x dollars. Hence, the other unopened envelope contains either 2x or
x/2 dollars, depending on whether the chosen envelope was that with the smaller or
larger sum.

288
౪
5 Expected value, variance, and covariance
Figure 5.5: The values of P(r) for 30 applicants. The upper dots are the “correct” values while the lower
ones are the values of the approximation r 󳨃→−(r/30) ln(r/30).
After that you are given the chance to swap envelopes. Should you use this opportu-
nity? If you do not swap, then you keep the x dollars. Otherwise, you either double your
amount or halve it, both with probability 1/2. Thus, if E is the expected amount after
switching, it follows that
E = (2x) ⋅1
2 + (x
2 ) ⋅1
2 = 5
4 ⋅x .
Consequently, on average, by switching you gain x/4 dollars. Imagine, for example, the
chosen envelope contains $100. Then by switching one either loses $50 or one wins $100,
both with probability 1/2. Of course, this contradicts the common sense. But what is
wrong?
First, there is a misinterpretation of the observed amount. The observed x is a ran-
dom value, not the expected value of the money you get. Say for some c > 0, the en-
velopes contain c and 2c dollars. Denote by X the money you get without switching,
then it follows that
ℙ{X = c} = ℙ{X = 2c} = 1
2 .
And after switching the new random variable ̃X also satisfies
ℙ{ ̃X = c} = ℙ{X = 2c} = 1
2
and
ℙ{ ̃X = 2c} = ℙ{X = c} = 1
2 .
Hence, it follows that 𝔼X = 𝔼̃X = 3 c/2, and on average there is no advantage by switch-
ing, exactly as one expects.
But there is still another missing information in the scenario. In which way are the
sums in the envelopes chosen? Are these, as assumed above, always (in each experiment)

5.4 Some paradoxes and examples
౪
289
fixed amounts c and 2c? Or is there a positive random variable Y such that the envelopes
contain Y and 2Y dollars? In other words, before you take one of the two envelopes
at random, the included sums are chosen by another independent random experiment
described by a random variable Y. But, and this suggests the formulation of the problem,
thereby it is impossible to do it in a way such that all possible amounts of integers (or
positive real numbers) are equally likely.
Let us explain this (random) setting with an example. Assume the master of cer-
emonies rolls a die and, depending on the observed number k ∈{1, . . . , 6}, he puts 2k
dollars into one envelope and 2k+1 into the other. In the above setting, the random vari-
able Y satisfies
ℙ{Y = 2k} = 1
6 ,
k = 1, . . . , 6 ,
(5.53)
and if X denotes the obtained amount, then11
ℙ{X = 2} = 1
2 ⋅ℙ{Y = 1} = 1
12 ,
ℙ{X = 128} = 1
2 ⋅ℙ{Y = 6} = 1
12
and
ℙ{X = 2k} = 1
6 ⋅ℙ{X = 2k|Y = k −1} + 1
6 ⋅ℙ{X = 2k|Y = k} = 1
6 ,
k = 2, . . . , 6 .
So we get
𝔼X = 2 ⋅1
12 + 1
6 ⋅
6
∑
k=2
2k + 128 ⋅1
12 = 31.5 .
(5.54)
If ̃X denotes the obtained amount after always switching, then
ℙ{ ̃X = 2k} = ℙ{X = 2k} ,
k = 1, . . . , 7 ,
hence nothing changes by always swapping.
But what happens if one swaps only in the case that the opened envelope contains
a “small” amount? Say, one swaps in the above example if there are less than $60 in the
envelope and otherwise one does not. Then the probability to get $32 diminishes to 1/12
while the probability of obtaining $64 increases to 3/12. Thus, after eventually swapping,
the average of the amount ̄X equals
𝔼̄X = 2 1
12 + 4 1
6 + 8 1
6 + 16 1
6 + 32 1
12 + 64 3
12 + 128 1
12 = 34.1 ̄6 .
11 The possible pairs of included amounts are
(2, 4),
(4, 8),
(8, 16),
(16, 32),
(32, 64),
and
(64, 128) .

290
౪
5 Expected value, variance, and covariance
So we see, this strategy improves the average of the money obtained. Moreover, the op-
timal case occurs if there are $32 and $64 in the envelopes12 and, furthermore, one had
chosen the envelope containing the smaller amount. Then by swapping one gets extra
$32. The probability that this happens equals 1/12.
But note that this strategy heavily depends on some foreknowledge about the size
of the amount in the envelopes. For example, if one decides to switch provided there are
less than $200 in the opened envelope,13 then there is no improvement of 𝔼X.
Let us finally shortly discuss the case of general (discretely) distributed amounts in
the envelopes.14 So suppose there are certain positive numbers x1, x2, . . . and nonnega-
tive pks with ∑∞
k=1 pk = 1. Choose a random variable Y for which
ℙ{Y = xk} = pk ,
k = 1, 2, . . .
Put with probability pk into one envelope xk and into the other 2xk dollars. After that,
choose equally likely one envelope at random.15 Then we get for the expected amount
X that
ℙ{X = xk} = pk
2
and
ℙ{X = 2xk} = pk
2 .
This implies
𝔼X =
∞
∑
k=1
xk
pk
2 +
∞
∑
k=1
(2xk)pk
2 = 3
2
∞
∑
k=1
pkxk = 3
2 𝔼Y .
For example, choosing Y as in eq. (5.53), it follows that
𝔼Y = 1
6
6
∑
k=1
2k = 21
⇒
𝔼X = 3
2 ⋅𝔼Y = 3
2 ⋅21 = 31.5 .
This coincides with the result obtained in eq. (5.54).
If, as before, ̃X denotes the obtained amount after switching, then
ℙ{ ̃X = xk} = ℙ{X = 2xk} = pk
2
and
ℙ{ ̃X = 2xk} = ℙ{X = xk} = pk
2 ,
so nothing has changed and 𝔼̃X = 𝔼X = 3 𝔼Y/2.
12 The result of rolling the die was “5.”
13 We encourage the reader to evaluate 𝔼̄X when swapping in the case that there are either less than 20
or less than 10 dollars in the chosen envelope. Find the optimal threshold for switching and nonswitching.
14 One may also choose continuous distributions of the included amounts, but this is more involved and
uses facts not included in the present book.
15 Note that the previous example fits into this setting. There we had xk = 2k as well as p1 = ⋅⋅⋅= p6 =
1/6 and pk = 0 if k > 6.

5.4 Some paradoxes and examples
౪
291
Thus, always swapping does not yield any advantage. But what happens if we use
the following strategy: Choose a threshold N > 0. If the amount x in the chosen envelope
satisfies x < N, then switch. Otherwise, if x ≥N, do not do so. For simplicity, we answer
this question only for special distributions of the amounts.
So suppose that for a certain k = 0, 1, 2, . . . one envelope contains 2k dollars and
the other 2k+1, and that the probability to choose this pair equals pk where pk ≥0 and
∑∞
k=0 pk = 1. That is, the contents of one envelope is Y, that of the other 2Y where
ℙ{Y = 2k} = pk ,
k = 0, 1, 2, . . .
This leads to
𝔼X = 3
2 ⋅𝔼Y = 3
2
∞
∑
k=0
pk2k ,
which implies that 𝔼X < ∞if and only if ∑∞
k=0 pk 2k < ∞.
If 𝔼X = ∞, it does not make sense to ask whether 𝔼X increases or decreases by
swapping or nonswapping. So let us assume that the expected gained amount is finite.
Choose a threshold N > 1. Swap if the amount in the chosen envelope is less than N. Do
not swap otherwise. Does this improve the expected value of gained money?
To answer this question take the integer ℓ≥0 for which 2ℓ< N ≤2ℓ+1. Let
̄X be
the obtained amount after switching those envelopes where one observes an amount
smaller than N. Then the only change of the distribution of X occurs in the case where
2ℓand 2ℓ+1 dollars are in the two envelopes. No matter if one were to choose the envelop
with the smaller or with the larger amount, in this case one would always get that with
2ℓ+1 dollars. Hence, it follows that
𝔼̄X −𝔼X = pℓ
2 (2ℓ+1 −2ℓ) = pℓ2ℓ−1 .
This is the good news. But what is the bad? Since we assumed that the expected value of
X exists, it follows that
lim
ℓ→∞pℓ2ℓ= 0 .
That is, the larger the threshold N, the less the expected advantage by choosing this
strategy.
Another way to formulate the result is as follows: choosing the threshold N such
that 2ℓ< N ≤2ℓ+1, by switching one may gain 2ℓ+1 −2ℓ= 2ℓdollars, maybe a huge
amount. But the likelihood that this happens is pℓ/2, a very small number. Recall that is
so if and only if, firstly, there are 2ℓand 2ℓ+1 dollars in the envelopes and, secondly, one
had chosen the envelope containing the smaller amount.

292
౪
5 Expected value, variance, and covariance
To illustrate the obtained results, choose pk = 2/3k+1, k = 0, 1, . . . That is,
ℙ{Y = 2k} =
2
3k+1 ,
k = 0, 1, 2, . . .
In this case,
𝔼Y =
∞
∑
k=0
(2
3)
k+1
= 2
⇒
𝔼X = 3
2 ⋅𝔼Y = 3 .
If the chosen threshold N satisfies 2ℓ< N ≤2ℓ+1, then by switching envelopes with small
amounts, the expected value increases to
𝔼̄X = 3 + 2ℓ
3ℓ+1 .
Note that the maximal expected advantage of 1/3 occurs if ℓ= 0.
Remark 5.4.6. There exists an interesting tightly related version of the two envelopes
paradox, sometimes called the two-number problem. A person writes two different
numbers on two slips of paper, one on each, so that you cannot see what is written. Next
you choose at random one of these two slips, turn it around and read the number stated
there. After that you may decide whether you keep the chosen slip or you better switch
and choose the other. At the end, after switching or nonswitching, you lose the game
if you have chosen the slip with the smaller number. Otherwise you win. It looks like
that your chance of winning is 50 %. But there exists a strategy to increase your chance
slightly. Take an arbitrary probability distribution ℚon ℝsatisfying ℚ([a, b]) > 0 for
all a < b. Simulate a random real number z distributed according to ℚ. If your number
x at the chosen slip satisfies x < z, then switch. Otherwise, if z < x, keep the chosen
slip.
Let us heuristically explain why this strategy improves your chance of winning. Sup-
pose the two numbers on the slips are a ∈ℝand b ∈ℝwith a < b. If the simulated num-
ber z satisfies z < a, then, no matter which of the two slips you chose, you do not switch.
Hence, in this case your chance of winning remains 50 % as it was at the beginning. Sim-
ilarly, if z > b, then you always switch, and your chance of winning remains 50 % as it
was before switching. But what happens in the case a < z < b? If you have chosen the
slip with a on it, you switch and win. Otherwise, if your choice was already the larger
number b, you do not switch and you win as well. Due to the assumption about the un-
derlying probability distribution ℚ, no matter how big/small a < b are, with probability
ℚ([a, b]) > 0 the simulated number z will satisfy a < z < b, a case where the strategy
always leads to a win. Putting together all three cases, the chance of winning becomes
slightly greater than 50 %. We refer to [Sam04] for a precise presentation. Note that we
did not say anything about the rules for the choice of the numbers a < b. Recall that
there is no probability distribution ℙon ℝsuch that ℙ({a}) = ℙ({b}) for all a < b.

5.5 Gambler’s ruin
౪
293
Summary: In the previous section, we presented three famous examples in Probability Theory: The “Boy or
Girl Paradox,” the “Secretary Problem,” and the “Envelope Exchange Paradox.” We gave full solutions and
discussed some generalizations of these classical problems.
5.5 Gambler’s ruin
Two players, say player A and his opponent B, play a series of independent games. Player
A wins each single game with probability p, hence the success probability for B equals
1 −p. Here and later on, we always assume 0 < p < 1 because otherwise either A or B
always win. Each time the winner gets $1 from the loser. At the beginning, A has a ≥1
dollars in his wallet, B possesses b ≥1 dollars. The gamblers decide to play as long as
one of them lost all of his money.
The basic question is how likely is it that A and/or B go bankrupt. To answer this
question, we use the technique of random walks as presented in Example 4.1.7. There
we investigated walks starting at zero. But, of course, this easily extends to walks starting
at an arbitrary integer k ∈ℤ.
Definition 5.5.1. Given an independent sequence (Xi)i≥1 with
ℙ{Xi = 1} = p
and
ℙ{Xi = −1} = 1 −p ,
i = 1, 2, . . .
Let S0 = k and Sn = k + X1 + ⋅⋅⋅+ Xn if n ≥1. Then (Sn)n≥0 is a (simple) random walk starting at k ∈ℤ.
In this setting, player A wins if a random walk (Sn)n≥0 starting at a ≥1 satisfies Sn = a+b
for some n ≥0 and, moreover, Sj > 0 if 0 ≤j ≤n. Note that Sn is the amount of money
which owns player A after n games. Compare Figure 5.6.
Figure 5.6: Players A and B start their series of games with a ≥1 and b ≥1 dollars, respectively.
Let 0 ≤k ≤a + b be an arbitrary integer. Set
Ak = {(Sn)n≥0 starts at k , and ∃n ≥0, Sn = a + b and Sj > 0 , j ≤n} .

294
౪
5 Expected value, variance, and covariance
In other words, the event Ak occurs if player A starts with k dollars, at some time he
reaches level a + b and before that he does not go bankrupt.
The basic properties of ℙ(Ak) are as follows:
ℙ(A0) = 0
and
ℙ(Aa+b) = 1 ,
and if 1 ≤k < a + b, then
ℙ(Ak) = ℙ(Ak|X1 = 1)ℙ{X1 = 1} + ℙ(Ak|X1 = −1)ℙ{X1 = −1}
= p ℙ(Ak+1) + (1 −p)ℙ(Ak−1) .
To see the last property, imagine A and B play one (their first) game and after that they
start a new series of games where now, depending on the result in the first game, player
A either owns k + 1 or k −1 dollars.
Letting xk = ℙ(Ak), and setting q = 1 −p, for any 0 < k < a + b we get
xk+1 = 1
p xk −q
p xk−1 ,
x0 = 0,
and
xa+b = 1 .
(5.55)
So we obtained for the xks a linear recurrence formula of second order with two bound-
ary conditions at k = 0 and k = a + b. The technique to solve such recurrence formulas
is well known; see, for example, page 41 in [CL23]. A basic role play the zeroes or roots
of the characteristic equation, which in the case of eq. (5.55) is given by
z2 −1
p z + q
p = 0 .
If p
̸= q, that is, if p
̸= 1/2, then this equation has two different roots which are z1 = 1
and z2 = q/p (recall that q = 1 −p). Thus, there are constants c and d such that
xk = c ⋅1k + d(q
p)
k
= c + d(q
p)
k
,
k = 0, . . . , a + b .
The boundary conditions tell us that c + d = 0 and c + d(q/p)a+b = 1, hence
c =
−1
( q
p)a+b −1
and
d =
1
( q
p)a+b −1
,
leading to
ℙ(Ak) = xk =
( q
p)k −1
( q
p)a+b −1
,
k = 0, . . . , a + b .
If p = q = 1/2, the characteristic equation becomes
z2 −2z + 1 = 0

5.5 Gambler’s ruin
౪
295
with root z0 = 1 of multiplicity 2. In this case, see, for example, page 43 in [CL23], one
gets
xk = c 1k + d k 1k = c + d k
with certain constants c and d. The boundary conditions imply c + d ⋅0 = 0 as well as
c + d(a + b) = 1, hence c = 0 and d = 1/(a + b). So we finally conclude that
ℙ(Ak) = xk =
k
a + b ,
k = 0, . . . , a + b .
Choosing in both cases k = a, we obtain the following result.
Proposition 5.5.2. Suppose A and B play a series of games where every time A wins one
dollar with probability p, hence B wins one dollar with probability q = 1 −p. If the initial
amounts of money are a ≥1 and b ≥1, respectively, then
ℙ{B goes bankrupt} = ℙ{A wins} =
{
{
{
{
{
( q
p )a−1
( q
p )a+b−1
if p
̸= 1
2,
a
a+b
if p = 1
2.
What happens if both players start the series of games with identical amount a > 0?
The following corollary gives the answer.
Corollary 5.5.3. Suppose both players A and B start their games with the same amount
a > 0. As before, p and q = 1 −p are the success probabilities of players A and B, respec-
tively. Then it follows that
ℙ{B goes bankrupt} = ℙ{A wins} =
1
1 + ( q
p)a .
Proof. The result is obviously true if p = 1/2, that is, if p = q. So let us assume that p
̸= q.
Hence it follows that x := (q/p)a
̸= 1. We apply now Proposition 5.5.2 with b = a and
obtain
ℙ{A wins} =
( q
p)a −1
( q
p)2a −1
= x −1
x2 −1 =
1
1 + x =
1
1 + ( q
p)a ,
as asserted.
Remark 5.5.4. The previous corollary shows the not very surprising fact that the
chances of player A are less than 1/2 whenever q > p, that is, if 0 < p < 1/2. More-
over, in this case one observes the following: the bigger the initial amount a > 0, the less
the probability for A to win.

296
౪
5 Expected value, variance, and covariance
Example 5.5.5. Suppose player A wins a single game with probability p = 0.49 and both
players A and B start their games with the same amount of a dollars. Then Corollary 5.5.3
applies and we get
ℙ{A wins} =
1
1 + ( 51
49)a .
For example, if a = 50, this probability equals 0.119175 while for a = 100 one gets
0.0179768. See Figure 5.7 for other probabilities with respect to the sums a = 1, . . . , 100.
Figure 5.7: The probability that A wins when both players start with a dollars, a = 1, . . . , 100. Here player A
wins a single game with probability p = 0.49.
Example 5.5.6. Let us play roulette where in every game we either win or lose $1 (for ex-
ample, put every time $1 either on red or on black). The chance of winning is p = 18/37,
hence q = 19/37. Say one stops gambling if either one had lost $10 or if one had won
$100. So, in the previous notation a = 10 and b = 100. Hence we get
ℙ{Win $100, starting with $10} =
( 19
18)10 −1
( 19
18)110 −1
= 0.00187859 .
(5.56)
Does it considerably improve the chance of winning $100 if one accepts in between a
bigger loss? Not really. For example, if one goes bankrupt after loosing $100, then the
chance of winning $100 equals 0.00446628. Note that this probability equals 1/2 in the
case of a fair game. Thus, even the small disadvantage of 1/18 changes the chance of
winning dramatically. See Figure 5.8 for the probabilities to win $100 starting with $10
up to $30, respectively.

5.5 Gambler’s ruin
౪
297
Figure 5.8: The probability to win $100 starting with a = 10, . . . , 30 dollars when playing roulette. Each time
one wins or loses $1.
Another interesting numerical example is a = b = 10 and p = 18/37. That is, the
game is terminated when either one has lost or won $10. Here Corollary 5.5.3 leads to
0.368031 as probability for winning $10. In other words, playing roulette 100 times with
initial amount $10, on average in about 37 of the cases you will win $10, but in 63 of the
cases you are going to lose your initial sum.
Let us now come back to the general case of players A and B with success probabil-
ities p and q = 1 −p, owning at the beginning a and b dollars, respectively.
How likely is it that B wins? To answer this question, we use Proposition 5.5.2 but
turn the tables. Interchange A and B, p and q, as well as a and b. Doing so, we obtain the
following:
Proposition 5.5.7. Suppose A and B play a series of games where every time A wins with
probability p, hence B with probability q = 1 −p. If the initial amounts of money are a
and b, respectively, then
ℙ{A goes bankrupt} = ℙ{B wins} =
{
{
{
{
{
( p
q )b−1
( p
q )a+b−1
if p
̸= 1
2,
b
a+b
if p = 1
2.
An interesting question remained unanswered until now: is it possible that the se-
ries of games between A and B lasts forever? In other words, may it happen that neither
A nor B wins?
The following result shows that the answer is negative.
Proposition 5.5.8. Under the previous assumptions, it follows that
ℙ{A wins} + ℙ{B wins} = 1 .

298
౪
5 Expected value, variance, and covariance
In particular, this implies
ℙ{The game lasts forever} = 0 .
Proof. If p = 1/2, by Propositions 5.5.2 and 5.5.7, one gets
ℙ{A wins} + ℙ{B wins} =
a
a + b +
b
a + b = 1 ,
completing the proof in this case.
Thus, let us assume now p
̸= q. To simplify the calculations, set x = q/p and
y = 1/x = p/q. Note that both numbers are by assumption different from 1. With these
notations, Propositions 5.5.2 and 5.5.7 may be written as
ℙ{A wins} =
xa −1
xa+b −1 = yb −ya+b
1 −ya+b
and
ℙ{B wins} =
yb −1
ya+b −1 .
Consequently, the assertion follows from
yb −ya+b
1 −ya+b + yb −1
ya+b −1 = ya+b −yb + yb −1
ya+b −1
= ya+b −1
ya+b −1 = 1 .
In view of Proposition 5.5.8, the following natural question arises: Let Ta,b be the
number of rounds that A and B play. That is, given a random walk (Sn)n≥0 starting at
zero, for some a, b ∈ℕset
Ta,b = min{n ≥0 : Sn = −a or Sn = b} .
(5.57)
What is the expected value of Ta,b? In other words, how long does the series of games
last on average. The answer is as follows (for a proof, we refer to [Sti03] or [Fel68]; the
basic idea is similar to that used in the proof of Proposition 5.5.2, namely conditioning
on the first step which leads to a linear recurrence formula for 𝔼Ta,b).
Proposition 5.5.9. Let a, b, p, and q = 1 −p be as before. If Ta,b denotes the number of
rounds before one of the players goes bankrupt, then
𝔼Ta,b =
{
{
{
a
q−p −a+b
q−p
( q
p )a−1
( q
p )a+b−1
if p
̸= 1
2,
a ⋅b
if p = 1
2.
(5.58)
Remark 5.5.10. In the case b = a, the first formula in eq. (5.58) simplifies to
𝔼Ta,a =
a
q −p[
( q
p)a −1
( q
p)a + 1
] ,
p
̸= 1
2 .
The proof goes along the same lines as that of Corollary 5.5.3. Furthermore, as can be
easily seen, the expected value of Ta,a does not change if one interchanges p and q, or,

5.5 Gambler’s ruin
౪
299
equivalently, players A and B. This is, of course, because the length of the game does
not depend on who players A and B are, provided both start with the same amount of
money.
Note that in the case p
̸= 1/2, it follows that
lim
a→∞
1
a 𝔼Ta,a =
1
|p −q| .
So in the long run, the expected time of the game is of order a/|p−q|. Compare this with
the case p = 1/2 where the expected time behaves like a2.
Example 5.5.11. If the game is fair and both players start either with $50 or $100, then on
average the gamblers have to play either 2500 or 10, 000 rounds before there is a winner.
The situation changes drastically if the success probability of one player is diminished
to 0.49. That is, the game is “almost” fair. In this case the average number of necessary
rounds equals either 1904.13 or 4820.23, respectively.
Let us finally treat a related problem, sometimes called “the monkey at the cliff.”
A monkey is standing one step from the edge of a cliff and takes repeated independent
steps; forward, with probability p, or backward, with probability q = 1 −p. What is the
probability that the monkey, sooner or later, will fall off the cliff?
The mathematical formulation is as follows: let (Sn)n≥0 be a random walk starting
at zero jumping with probability p to the right and with probability q = 1 −p to the left.
How likely is it that there exists an n ≥1 such that Sn = 1. More generally, one may ask
for the existence of an n ≥1 with Sn = b for a given integer b ≥1. The answer is as
follows:
Proposition 5.5.12. Let (Sn)n≥1 be as before. Then for any integer b ≥1 it follows that
ℙ{Sn = b for some n ≥1} = {1
if p ≥1
2,
( p
q)b
if p < 1
2.
Proof. Fix b ≥1. Given a ≥1, define events Ba as follows: Ba occurs if there is an n ≥1
for which Sn = b and, at the same time, Sj > −a if 1 ≤j < n. Then A1 ⊆A2 ⊆⋅⋅⋅and,
moreover,
{Sn = b for some n ≥1} =
∞
⋃
a=1
Ba .
To see this, suppose Sn = b and choose a ≥1 such that min1≤j≤n Sj > −a.
Hence, by the continuity of probability measures from below (see property (6) in
Proposition 1.2.1), we obtain
ℙ{Sn = b for some n ≥1} = lim
a→∞ℙ(Ba) .

300
౪
5 Expected value, variance, and covariance
Now Proposition 5.5.2 applies and leads to
ℙ{Sn = b for some n ≥1} = lim
a→∞
{
{
{
{
{
( q
p )a−1
( q
p )a+b−1
if p
̸= 1
2,
a
a+b
if p = 1
2.
Of course,
lim
a→∞
a
a + b = 1
and
lim
a→∞
( q
p)a −1
( q
p)a+b −1
= 1
if
q
p < 1 .
Recall that xa 󳨀→
a→∞0 provided that 0 < x < 1.
It remains to investigate the case q > p or, equivalently, p < 1/2. As before set
x = q/p > 1 and y = 1/x < 1. Doing so, we get
lim
a→∞
xa −1
xa+b −1 = lim
a→∞
yb −ya+b
1 −ya+b = yb = (p
q)
b
,
which completes the proof in the remaining case.
Remark 5.5.13. Proposition 5.5.12 asserts that in the case p ≥1/2, the monkey will fall
off the cliff with probability one, even if it is not only 1 but b > 1 steps away from the
cliff. On the other hand, if p < 1/2 and the monkey is b steps away from the cliff, then
with probability 1 −(p/q)b the monkey will be safe. Since in this case p/q < 1, hence
(p/q)b →0 as b →∞, the situation of the monkey improves considerably as soon as it
is further away from the cliff.
Still another way to formulate Proposition 5.5.12 is as follows. Say player A has an
unlimited amount of money while his opponent starts with b dollars. Then A will win
with probability one provided his success probability p satisfies p ≥1/2. On the other
hand, in the case of p < 1/2 his chance of winning equals (p/q)b < 1.
Example 5.5.14. Let us investigate how likely it is to win b ≥1 dollars in a roulette
provided one has an unlimited amount of money. As before, every time the chance to
win one dollar is p = 18/37 while one loses one dollar with probability q = 19/37. Hence,
in this case we obtain
ℙ{Win $b} = (18
19)
b
.
For example, the chance to win $100 possessing an infinite amount of money equals
ℙ{Win $100} = (18
19)
100
≈0.00448632 .
Compare this result with eq. (5.56) where we got 0.00187859 for the probability to win
$100 when starting with an initial amount of $10 or with the probability 0.00446628

5.5 Gambler’s ruin
౪
301
when starting with $100. So one sees, in order to win $100, it does not make a big dif-
ference whether one starts to play with $100 or with an unlimited amount of money.
The result will be the same in both cases: very likely one is going to lose a lot of money.
Compare Figure 5.9 for the probabilities to win b = 1, . . . , 30 dollars playing roulette
possessing an unlimited amount of money.
Figure 5.9: The probability to win b = 1, . . . , 30 dollars playing roulette possessing an unlimited amount of
money.
Suppose now one does not bet $1 each time, but $10. How likely is it now to win $100?
The answer is at follows: the likelihood to win $100 by $10 steps coincides with that to win
$10 by steps of size $1. Hence, the probability of this event equals (18/19)10 ≈0.582357.
Remark 5.5.15. It might be of interest to compare this with the probability 0.368031 in
the case of an initial deposit of $10. This tells us that it is not unlikely to lose at some time
more than $10 before one finally wins $10. For example, the chance to win $10 becomes
for the first time greater than 1/2 if one starts gambling with an amount of $24. Then the
probability to win at some time $10 without going bankrupt equals 0.503344.
But note that this does not mean that one has an advantage. In the case of success,
one wins $10 while one loses $24 in the case of failure. Thus, on average there will be a
loss, no matter how big the initial amount was.
Remark 5.5.16. The symmetric (fair) case p = 1/2 is of special interest. By symmetry,
given b ≥1, with probability one there also exists an n ≥1 such that Sn = −b. Thus, with
probability one, a symmetric random walk attains any value in ℤ. See Example 7.2.15
for further asymptotic properties of symmetric walks.
In view of Proposition 5.5.12 and the previous remark, the following question arises:
let (Sn)n≥1 be a random walk starting at zero. Given b ∈ℕ, how long does it take on
average before the walk reaches level b? To make it more precise, given b ≥1, let

302
౪
5 Expected value, variance, and covariance
Tb = {min{n ≥0 : Sn = b}
if there is an n ≥0 with Sn = b,
∞
otherwise.
Then Proposition 5.5.12 may be rephrased as follows:
ℙ{Tb < ∞} = {1
if p ≥1
2,
( p
q)b
if p < 1
2.
Proposition 5.5.17. Let (Sn)n≥1 be a random walk starting at zero. Given b ∈ℕ,
𝔼Tb = {
b
p−q
if p > 1
2,
∞
if p ≤1
2.
Proof. If p < 1/2, then ℙ{Tb = ∞} = 1 −(p/q)b > 0, hence 𝔼Tb = ∞as asserted.
The case 1/2 ≤p is more involved and may be found in [Sti03, Section 5.6]. Basic
ingredient is the so-called hitting time theorem asserting
ℙ{Tb = n} = b
n ℙ{Sn = b}
and
𝔼Tb = b
∞
∑
n=1
ℙ{Sn = b} ,
b ≥1 .
(5.59)
A heuristic proof of Proposition 5.5.17 (without using the hitting time theorem) can
be given by using eq. (5.58). Assume we know that
𝔼Tb = lim
a→∞𝔼Ta,b
(which is true and can be made precise). Then, if p > 1/2, hence q/p < 1, it follows that
𝔼Tb = lim
a→∞[
a
q −p −a + b
q −p
( q
p)a −1
( q
p)a+b −1
] =
b
p −q .
The case p = 1/2 is even easier to handle and follows by evaluating the infinite sum in
the right-hand formula of (5.59) or from
𝔼Tb = lim
a→∞𝔼Ta,b = lim
a→∞a ⋅b = ∞.
Remark 5.5.18. Most interesting in Proposition 5.5.17 is the case p = 1/2. Assume players
A and B play a series of fair games. Player A has an unlimited amount of money while B
starts with $1. Then A wins with probability 1, but on average it takes an arbitrarily long
time until B goes bankrupt.
Similarly, in the symmetric case, for sure the monkey will fall off the cliff, but on
average it takes a lot of time before this happens.

5.5 Gambler’s ruin
౪
303
Final remark: There exist many other interesting results about random walks not
included in the present book. For example, what can be said about the behavior of
max{Sk : 0 ≤k ≤n}? How are the zeroes of a symmetric walk (Sn)n≥0 distributed? How
about recurrence or transience? How many changes of signs exist until a given time n?
Or what happens if, as in our case, the barriers are not absorbing but reflecting? Neither
did we treat random walks in the more general setting of jumping particles in ℤd. We
refer to [Fel68], to [Rev13], or to [Sti03] for further reading about this highly interesting
topic.
But let us shortly discuss one property of the symmetric walk, which, in our opinion,
is very surprising. Let (Sn)n≥0 be a symmetric random walk starting at zero. If
L+
n = 󵄨󵄨󵄨󵄨{k ≤n : Sk > 0}󵄨󵄨󵄨󵄨,
(5.60)
then L+
n is the number of the times until n where the symmetric walk is located in the
positive half-space or, equivalently, where player A is ahead of player B provided both
players start with an unlimited amount of money. Probably everybody will guess that
for large n, player A will be about half of the time ahead B, and during the other half, B
will be ahead A. Recall that the walk is symmetric, hence jumps to the right are as likely
as those to the left.
The following result shows that this is not so. It is much more likely that most of
the time one of the players is ahead of the other. To verify this, one investigates the
proportion L+
n/n of times where the walk is above zero. Here the following holds (see
[Sti03, Section 6.8]):
Proposition 5.5.19 (Arcsine law for random walks). Let L+
n be defined by (5.60). Then for
any 0 < t < 1 it holds that
lim
n→∞ℙ{L+
n
n ≤t} = 2
π arcsin(√t) = 1
π
t
∫
0
1
√x(1 −x)
dx .
Thus, the random variables (L+
n/n)n≥1 converge in distribution, that is, in the sense
of Definition 7.2.1, to an arcsine distribution. Recall that the arcsine distribution was
introduced in Definition 1.6.35.
Corollary 5.5.20. If 0 ≤a < b ≤1, then for sufficiently large n we have
ℙ{a ≤L+
n
n ≤b} ≈2
π [arcsin(√b) −arcsin(√a)] .
The numerical values in the cases a = 0.1, a = 0.2, and a = 0.5 are
ℙ{0.05 ≤L+
n /n ≤0.15}
ℙ{0.15 ≤L+
n /n ≤0.25}
ℙ{0.45 ≤L+
n /n ≤0.55}
≈0.1096
≈0.0802
≈0.06377

304
౪
5 Expected value, variance, and covariance
These values, as well as Figure 5.10, tell us that it is much more likely that L+
n/n is
near zero or one than near 0.5. Recall that L+
n/n is the proportion of those times k ≤n
where Sk > 0. Hence, the event that L+
n/n near 0.5 occurs if the walk is about half of the
time positive and the other half it is negative.
Figure 5.10: The approximate probabilities ℙ{a −0.05 ≤L+
n /n ≤a + 0.05} with a ∈[0.05, 0.95].
Summary: Two persons A and B play a series of games as long as one of them goes bankrupt. Hereby, in
every single game the loser has to pay $1 to the winner. The describing mathematical model is a random
walk starting at zero and with absorbing barriers at −a and b. Here a and b are the initial amounts of A and
B, respectively. Equivalently, one may regard a random walk starting at a and with barriers at 0 and a + b. Let
p be the success probability of player A, thus q = 1 −p is that of player B. Then the basic result asserts
ℙ{B goes bankrupt} = ℙ{A wins} =
{
{
{
{
{
( q
p )a−1
( q
p )a+b−1
if p
̸= 1
2,
a
a+b
if p = 1
2.
5.6 Problems
Problem 5.1.
1.
Put successively and independently of each other n particles into N boxes. Thereby,
each box is equally likely. How many boxes remain empty on average?
Hint: Define random variables X1, . . . , XN as follows: set Xi = 1 if box i remains empty,
and Xi = 0 otherwise.
2.
Fifty persons write randomly (according to the uniform distribution), and indepen-
dently of each other, one of the 26 letters in the alphabet on a sheet of paper. On
average, how many different letters appear?

5.6 Problems
౪
305
3.
In a factory with N ≥1 employees, every day of the year on which one of the em-
ployees has a birthday is a holiday. Let EN be the expected number of working days,
that is, the expected number of days which are not a holiday. For which N ≥1 does
N ⋅EN (the expected total working time) become maximal? Hereby one assumes that
all 365 days of the year are equally likely to be birthdays.
Problem 5.2 (A. E. Lawrance, 1969). An urn contains eight white balls and two black.
Choose one after another a ball without replacing the chosen one. Let 1 ≤r ≤9 be the
number of that choice where for the first time a black ball occurs. Which number r is
most likely for the appearance of the first black ball? Evaluate the average value over
all possible numbers r ≤9.
Answer the same questions in the case that n ≥2 balls are in the urn where 2 are
black and n −2 are white.
Problem 5.3 (De Moivre, 1756). A man rolls a fair die six times. He gets an amount of M
francs, every time he
1.
rolls a “1” or
2.
if he rolls at least one “1.”
Evaluate in both cases the expected amount of money he gets.
Problem 5.4. Let (Ω, 𝒜, ℙ) be a probability space. Given (not necessarily disjoint) events
A1, . . . , An in 𝒜and real numbers α1, . . . , αn, define X : Ω →ℝby16
X :=
n
∑
j=1
αj1Aj .
1.
Why is X a random variable?
2.
Prove
𝔼X =
n
∑
j=1
αjℙ(Aj)
and
𝕍X =
n
∑
i,j=1
αiαj[ℙ(Ai ∩Aj) −ℙ(Ai)ℙ(Aj)].
How does 𝕍X simplify for independent events A1, . . . , An?
Problem 5.5. Suppose a fair “die” has k faces labeled by the numbers from 1 to k.
1.
How often one has to roll the die on the average before the first “1” shows up?
2.
Suppose one rolls the die exactly k times. Let pk be the probability that “1” ap-
pears exactly once and qk is the probability that “1” shows up at least once. Com-
pute pk and qk and determine their behavior as k →∞, that is, find limk→∞pk and
limk→∞qk.
16 For the definition of indicator functions 1Ai, see eq. (3.21).

306
౪
5 Expected value, variance, and covariance
Problem 5.6.
1.
Let X be a random variable with values in ℕ0 = {0, 1, 2, . . . }. Prove that
𝔼X =
∞
∑
k=1
ℙ{X ≥k} .
2.
Suppose now that X is continuous with ℙ{X ≥0} = 1. Verify
∞
∑
k=1
ℙ{X ≥k} ≤𝔼X ≤1 +
∞
∑
k=1
ℙ{X ≥k} .
Problem 5.7. Let X be an ℕ0-valued random variable with
ℙ{X = k} = q−k,
k = 1, 2, . . .
for some q ≥2.
(a) Why do we have to suppose q ≥2, although ∑∞
k=1 q−k < ∞for q > 1?
(b) Determine ℙ{X = 0}?
(c) Compute 𝔼X by the formula in Problem 5.6.
(d) Compute 𝔼X directly by 𝔼X = ∑∞
k=0 k ℙ{X = k}.
Problem 5.8. Two independent random variables X and Y with finite third moment
satisfy 𝔼X = 𝔼Y = 0. Prove that then
𝔼(X + Y)3 = 𝔼X3 + 𝔼Y 3 .
Problem 5.9. A random variable X is Poisλ-distributed for some λ > 0. Evaluate
𝔼(
1
1 + X )
and
𝔼(
X
1 + X ).
Problem 5.10. In a lottery, 6 of 49 numbers are randomly chosen. Let X be the largest
number of the 6. Show that
𝔼X = 6 ⋅43!
49!
49
∑
k=6
k(k −1)(k −2)(k −3)(k −4)(k −5) = 42.8571 .
Evaluate 𝔼X if X is the smallest number of the 6 chosen.
Hint: Either one modifies the calculations for the maximal value suitably or one
reduces the second problem to the first by an easy algebraic operation.
Problem 5.11. A fair coin is labeled by “0” on one side and with “1” on the other. Toss it
four times. Let X be the sum of the first two tosses and Y be the sum of all four. Determine
the joint distribution of X and Y. Evaluate Cov(X, Y), as well as ρ(X, Y).

5.6 Problems
౪
307
Problem 5.12. In an urn there are five balls, two labeled by “0” and three by “1.” Choose
two balls without replacement. Let X be the number on the first ball and Y that on the
second.
1.
Determine the distribution of the random vector (X, Y) and its marginal distribu-
tions.
2.
Compute ρ(X, Y).
3.
Which distribution does X + Y possess?
Problem 5.13. Among 40 students there are 30 men and 10 women. Also, 25 of the 30
men and 8 of the 10 women passed an exam successfully. Choose randomly, according
to the uniform distribution, one of the 40 students. Let X = 0 if the chosen person is a
man, and X = 1 if it is a woman. Furthermore, set Y = 0 if the person failed the exam,
and Y = 1 if she or he passed.
1.
Find the joint distribution of X and Y.
2.
Are X and Y independent? If not, evaluate Cov(X, Y).
3.
Are X and Y negatively or positively correlated? What does it express, when X and
Y are positively or negatively correlated?
Problem 5.14. Let (Ω, 𝒜, ℙ) be a probability space. Prove, for any two events A and B
in 𝒜, the estimate
󵄨󵄨󵄨󵄨ℙ(A ∩B) −ℙ(A) ℙ(B)󵄨󵄨󵄨󵄨≤1
4 .
Is it possible to improve the upper bound 1
4?
Problem 5.15 (Problem of Luca Pacioli in 1494; the first correct solution was found by Blaise
Pascal in 1654). Two players, say A and B, are playing a fair game consisting of several
rounds. The first player who wins six rounds wins the game and the stakes of 20 taler17
that have been bet throughout the game. However, one day the game is interrupted and
must be stopped. If player A has won five rounds and player B has won three rounds,
how should the stakes be divided fairly among the players?
Problem 5.16 (B. Pascal, 1654). Three players, say A, B, and C, play a series of fair games.
Whoever first wins three games is the winner. One day the series of games had to be
stopped before one of the three players had won three games. Player A still needs one
win, B and C still need two wins each. How to distribute the stakes in this case in a fair
way?
Problem 5.17. In Example 5.1.49, we computed the average number of necessary pur-
chases to get all n pictures. Let m be an integer with 1 ≤m < n. How many purchases
are necessary on average to possess m of the n pictures?
17 Former German currency, root of the word “dollar.”

308
౪
5 Expected value, variance, and covariance
For n even, choose m = n/2, and for n odd take m = (n −1)/2. Let Mn be the av-
erage number of purchases to get m pictures, that is, to get half of the pictures. Deter-
mine
lim
n→∞
Mn
n .
Hint: Use eq. (5.29).
Problem 5.18. Compute 𝔼|X|2n+1 for a standard normal distributed X and n = 0, 1, . . .
Problem 5.19. Suppose X has the density
p(x) = {0
if x < 1,
cα xα
if x ≥1,
for some α < −1.
1.
Determine cα such that p is a density.
2.
For which n ≥1 does X possess an nth moment?
Problem 5.20. Let U be uniform distributed on an interval [α, β]. Show that for n ≥1,
𝔼Un = βn + αβn−1 + ⋅⋅⋅+ αn−1β + αn
n + 1
.
Problem 5.21. Let X1, . . . , Xn be random variables with finite second moment and with
𝔼Xj = 0. Show that
𝔼[X1 + ⋅⋅⋅+ Xn]2 =
n
∑
i,j=1
Cov(Xi, Xj) =
n
∑
j=1
𝕍Xj + 2
∑
1≤i<j≤n
Cov(Xi, Xj) .
Problem 5.22. Show that
𝔼X = nM
N
for a hypergeometrically distributed random variable X with
ℙ{X = m} =
(M
m) (N−M
n−m)
(N
n)
,
m = 0, . . . , n .
Problem 5.23. Let X be 𝒩(0, 1)-distributed. Determine 𝕍X3 and 𝕍X4.
Problem 5.24. Given a nonnegative random variable X, define φX from [0, 1] to [0, 1] by
φX(t) = 𝔼tX. Then φX is called the generating function of X (see [GS20, Section 5.1]).
(1) Suppose X has values in ℕ0. Show that, if t ≥0, then this “new” definition of the
generating function coincides with that given in Problem 4.2.

5.6 Problems
౪
309
(2) Let X1, . . . , Xn be independent and nonnegative. For αj ≥0, 1 ≤j ≤n, let
X = α1X1 + ⋅⋅⋅+ αnXn .
Prove
φX(t) = φX1(tα1) ⋅⋅⋅φXn(tαn) .
(3) Find φX for an exponentially distributed X.
Problem 5.25. Complete the arguments stated in Remark 5.4.4. That is, argue why the
following questions are equivalent:
1.
Toss a fair coin n times and choose after that at random a number 1 ≤j ≤n. Suppose
the jth toss was a “1.” What is the probability that under this condition the observed
sequence has k “1”s for some 1 ≤k ≤n?
2.
One tosses a fair coin n −1 times. How likely is the appearance of k −1 “1”s?

6 Normally distributed random vectors
6.1 Representation and density
In Example 3.4.3 we considered a two-dimensional random vector (X1, X2), where X1 was
the height of a randomly chosen person and X2 was his weight. From experience and in
view of the central limit theorem (cf. Section 7.2), it is quite reasonable to assume that X1
and X2 are normally distributed. Suppose we are able to determine their expected values
and their variances. However, this is not sufficient to describe the experiment. Why? The
random variables X1 and X2 are surely dependent, and the most interesting problem is to
describe their degree of dependence. This cannot be done based only on the knowledge
of their distributions. What we really need to know is their joint distribution. Therefore,
we not only have to suppose X1 and X2 to be normal, but the generated vector (X1, X2)
has to be as well.
But what does it mean that a random vector is normally distributed? This section is
devoted to answer this and related questions.
Let us first recall the univariate case, investigated in Example 4.2.2 and in the subse-
quent Proposition 4.2.3. The main observation was that a random variable Y is normally
distributed if and only if it may be written as
Y = aX + μ
(6.1)
for some a
̸= 0, μ ∈ℝ, and a standard normal random variable X.
Let now ⃗Y = (Y1, . . . , Yn) be an n-dimensional random vector. We want to represent
it in the same way as Y in eq. (6.1). Consequently, we have to replace X by a multivariate
standard normal vector and the function x 󳨃→ax + μ by a suitable mapping from ℝn
to ℝn. But which kind of mapping should this be and what is an n-dimensional standard
normal vector?
Let us begin by answering the second question. Therefore, recall the definition of
the multivariate standard normal distribution 𝒩(0, 1)⊗n introduced in Definition 1.9.21.
This probability measure on (ℝn, ℬ(ℝn)) acts as follows: if B ∈ℬ(ℝn), then its probability
equals
𝒩(0, 1)⊗n(B) =
1
(2π)n/2 ∫
B
e−|x|2/2 dx
=
1
(2π)n/2 ∫⋅⋅⋅∫
⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟
B
e−(x2
1+⋅⋅⋅+x2
n)/2 dxn ⋅⋅⋅dx1.
Thus, a random vector ⃗X should be standard normally distributed whenever its proba-
bility distribution is 𝒩(0, 1)⊗n. Let us formulate this as a definition.
https://doi.org/10.1515/9783111325064-006

6.1 Representation and density
౪
311
Definition 6.1.1. A random vector ⃗X = (X1, . . . , Xn) is standard normally distributed (or is standard
normal) if its probability distribution satisfies ℙ⃗X = 𝒩(0, 1)⊗n.
To make this definition more descriptive, let us state some equivalent properties.
Proposition 6.1.2. For a random vector ⃗X = (X1, . . . , Xn), the following are equivalent:
1.
⃗X is standard normal.
2.
If B ∈ℬ(ℝn), then
ℙ{ ⃗X ∈B} =
1
(2π)n/2 ∫
B
e−|x|2/2 dx .
3.
The coordinate mappings X1, . . . , Xn are (univariate) standard normally distributed
and independent. That is, for all tj ∈ℝ, 1 ≤j ≤n,
ℙ{X1 ≤t1, . . . , Xn ≤tn} = ℙ{X1 ≤t1} ⋅⋅⋅ℙ{Xn ≤tn}
= (
1
√2π
t1
∫
−∞
e−x2
1/2dx1) ⋅⋅⋅(
1
√2π
tn
∫
−∞
e−x2
n/2dxn) .
Proof. Taking into account the definition of 𝒩(0, 1)⊗n, this is an immediate consequence
of Propositions 3.6.5 and 3.6.20. Compare also the considerations in Example 3.6.24.
Remark 6.1.3. The density of the n-dimensional standard normal distribution possesses
nice properties: it attains its maximal value (2π)−n/2 at zero, it is invariant under rota-
tions of the arguments and its level sets are circles. See Figure 6.1 for the graph of this
density in the case n = 2.
Figure 6.1: The density of a 2-dimensional standard normal vector.
An adequate substitute for x 󳨃→ax + μ in representation (6.1) is still undetermined.
Which mappings in ℝn should be considered?

312
౪
6 Normally distributed random vectors
Observe that x 󳨃→ax +μ is affine linear from ℝto ℝ. The counterpart in ℝn is of the
form x 󳨃→Ax + μ, where A is a linear mapping in ℝn and μ ∈ℝn. Linear mappings in ℝn
are described by n × n matrices A = (αij)n
i,j=1 and act as follows:
Ax = (
n
∑
j=1
α1jxj, . . . ,
n
∑
j=1
αnjxj) ,
x = (x1, . . . , xn) ∈ℝn .
Consequently, the suitable generalization of x 󳨃→ax + μ is the mapping x 󳨃→Ax + μ with
an n × n matrix A and μ ∈ℝn. The condition a
̸= 0 transfers to det(A)
̸= 0 or, equivalently,
A has to be regular, that is, the generated mapping is one-to-one from ℝn onto ℝn. Here
and in the sequel we will use results and notations as presented in Section A.4.
Now we are in position to define normally (distributed) random vectors.
Definition 6.1.4. A random vector
⃗Y is said to be normally distributed (or simply, normal) provided
there exists a regular n × n matrix A and a vector μ ∈ℝn such that
⃗Y = A ⃗X + μ
(6.2)
for some standard normal ⃗X.
Remark 6.1.5. Let us reformulate Definition 6.1.4 due to its importance. A random vec-
tor
⃗Y = (Y1, . . . , Yn) is normally distributed if and only if there exists a regular matrix
A = (αij)n
i,j=1 and a vector μ = (μ1, …, μn) such that
Yi =
n
∑
j=1
αijXj + μi ,
1 ≤i ≤n ,
with X1, . . . , Xn independent 𝒩(0, 1)-distributed.
Example 6.1.6. Suppose the three-dimensional random vector ⃗Y = (Y1, Y2, Y3) is defined
by
Y1 = 2X1 + X2 −X3 + 4 ,
Y2 = X1 −2X2 + X3 −2,
and
Y3 = X1 −2X3 + 5
with 𝒩(0, 1)-distributed independent X1, X2, X3. Then ⃗Y is normally distributed. Observe
that it may be represented in the form of eq. (6.2) with A given by
A = (
2
1
−1
1
−2
1
1
0
−2
)
and with μ = (4, −2, 5). Moreover, we have det(A) = 9, hence A is regular.
Remark 6.1.7. If the n-dimensional vector ⃗Y is represented as ⃗Y = A ⃗X + μ with ⃗X stan-
dard normal, μ ∈ℝn and a nonregular n × n-matrix A, then ⃗Y may also be regarded as

6.1 Representation and density
౪
313
normal, yet in a more general setting. In this case it follows that ℙ{ ⃗Y ∈range(A) +μ} = 1
where range(A) is a strict subspace of ℝn. For example, if Y1 = X1 + X2 and Y2 = −X1 −X2,
then ℙ{ ⃗Y ∈E} = 1 with E = {(t, −t) : t ∈ℝ}. Thus, ℙ⃗Y is concentrated on the subspace
E
̸= ℝ2. Here and in the sequel, we want to exclude such “degenerated” normal vectors
by assuming that the generating matrix A is regular.
Given a normal vector
⃗Y, how do we get the standard normal
⃗X in representa-
tion (6.2)? The next proposition answers this question.
Proposition 6.1.8. A random vector ⃗Y = (Y1, . . . , Yn) is normal if and only if there exists a
regular n × n matrix B = (βij)n
i,j=1 and a vector ν = (ν1, . . . , νn) ∈ℝn such that the random
variables Xi, defined by
Xi :=
n
∑
j=1
βijYj + νi ,
1 ≤i ≤n ,
are independent standard normal.
Proof. This is a direct consequence of the following observation. One has ⃗Y = A ⃗X + μ if
and only if ⃗X may be represented as ⃗X = A−1 ⃗Y −A−1μ. Therefore, the assertion follows
by choosing B and ν such that B = A−1 and ν = −A−1μ.
Example 6.1.9. For the random vector
⃗Y investigated in Example 6.1.6, the generated
independent standard normal random variables X1, X2, and X3 may be represented as
follows:
X1 = 1
9(4Y1 + 2Y2 −Y3 + 7),
X2 = 1
9(Y1 −Y2 −Y3 + 1),
X3 = 1
9(2Y1 + Y2 −5Y3 −19).
Suppose ⃗Y = A ⃗X+μ is a normal vector. How can we evaluate its distribution density?
To answer this question, we introduce the following function. Let R > 0 be an n×n-matrix
and μ ∈ℝn. The inverse matrix of R is R−1, and to simplify the notation, set |R| = det(R).
Observe that R > 0 implies |R| > 0. With these notations, we define a function pμ,R from
ℝn to ℝby
pμ,R(x) :=
1
(2π)n/2|R|1/2 e −⟨R−1(x−μ),(x−μ)⟩/2 ,
x ∈ℝn .
(6.3)
Note that the expression in the exponent may be written as follows. If R−1 = ( ̃rij)n
i,j=1 is
the inverse matrix of R, then one gets
⟨R−1(x −μ), (x −μ)⟩/2 = 1
2
n
∑
i,j=1
̃rij(xi −μi)(xj −μj) .
Now we are prepared to answer the above question about the density of ⃗Y.

314
౪
6 Normally distributed random vectors
Proposition 6.1.10. Suppose the normal vector ⃗Y is represented as in eq. (6.2) with regular
A and μ ∈ℝn. Define the positive matrix R by R = AAT. Then pμ,R, as given in eq. (6.3), is
the distribution density of ⃗Y. In other words, if B ∈ℬ(ℝn), then
ℙ{ ⃗Y ∈B} =
1
(2π)n/2|R|1/2 ∫
B
e −⟨R−1(x−μ),(x−μ)⟩/2 dx .
Proof. Because ⃗Y = A ⃗X + μ with ⃗X standard normal, Proposition 6.1.2 implies
ℙ{ ⃗Y ∈B} = ℙ{A ⃗X + μ ∈B} = ℙ{ ⃗X ∈A−1(B −μ)}
=
1
(2π)n/2
∫
A−1(B−μ)
e−|y|2/2 dy
for any Borel set B ⊆ℝn. Hereby, B−μ denotes the set {b−μ : b ∈B}. In the next step, we
change the variables by setting x = Ay + μ. Then dx = | det(A)|dy, where by assumption
det(A) ̸= 0 and, moreover, we have y ∈A−1(B −μ) if and only if x ∈B. Therefore, the last
integral transforms to
ℙ{ ⃗Y ∈B} =
1
(2π)n/2
󵄨󵄨󵄨󵄨det(A)󵄨󵄨󵄨󵄨
−1 ∫
B
e−|A−1(x−μ)|2/2 dx .
(6.4)
Proposition A.4.1 implies R > 0 and, moreover,
|R| = det(R) = det(AAT) = det(A) ⋅det(AT) = det(A)2 .
Since |R| = det(R) > 0, this leads to |R|1/2 = | det(A)|, that is, to
󵄨󵄨󵄨󵄨det(A)󵄨󵄨󵄨󵄨
−1 = |R|−1/2 .
(6.5)
Note that
󵄨󵄨󵄨󵄨A−1(x −μ)󵄨󵄨󵄨󵄨
2 = ⟨A−1(x −μ), A−1(x −μ)⟩= ⟨(A−1)
TA−1(x −μ), (x −μ)⟩,
which, due to
(A−1)
T ∘A−1 = (AT)
−1 ∘A−1 = (A ∘AT)
−1 = R−1,
implies
󵄨󵄨󵄨󵄨A−1(x −μ)󵄨󵄨󵄨󵄨
2 = ⟨R−1(x −μ), (x −μ)⟩.
(6.6)
Plugging eqs. (6.5) and (6.6) into eq. (6.4), we get

6.1 Representation and density
౪
315
ℙ{ ⃗Y ∈B} = ∫
B
pμ,R(x) dx
with pμ,R as in eq. (6.3). This completes the proof.
Remark 6.1.11. How does Proposition 6.1.10 look like for n = 1? Here Y = aX + μ, that is,
A = (a), and since A has to be regular, this implies a
̸= 0. Hence we get R = AAT = (a2),
R−1 = (a−2), and |R|1/2 = |a|. Thus, the density of Y is given by
pμ,R(x) =
1
(2π)1/2|R|1/2 e −⟨R−1(x−μ),x−μ⟩/2 =
1
(2π)1/2|a|e −(x−μ)2/2a2
,
x ∈ℝ.
This coincides with the result obtained in Example 4.2.2.
In view of Proposition 6.1.10, we will use the following notation.
Definition 6.1.12. A normal vector ⃗Y is said to be 𝒩(μ, R)-distributed if pμ,R is its density, that is, if
ℙ{ ⃗Y ∈B} =
1
(2π)n/2|R|1/2 ∫
B
e −⟨R−1(x−μ),(x−μ)⟩/2 dx .
Remark 6.1.13. It follows from Proposition A.4.2 that, given any μ ∈ℝn and any R > 0,
there exists a normal vector ⃗Y that is 𝒩(μ, R)-distributed. Indeed, write R > 0 as R = AAT
and set
⃗Y = A ⃗X + μ with
⃗X standard normal. Then
⃗Y is 𝒩(μ, R)-distributed by Proposi-
tion 6.1.10.
{Distributions of ℝn-valued normal vectors}
⇔
{(μ, R) : μ ∈ℝn, n × n matrix R > 0}.
Example 6.1.14. Assume
Y1 = X1 −X2 + 3
and
Y2 = 2X1 + X2 −2
for X1, X2 independent 𝒩(0, 1)-distributed. Then we get
μ = (3, −2)
and
A = ( 1
−1
2
1 ) ,
which implies
R = AAT = ( 1
−1
2
1
) ⋅(
1
2
−1
1
) = ( 2
1
1
5
) .
(6.7)
Thus, ⃗Y is 𝒩(μ, R)-distributed with μ = (3, −2) and R as in eq. (6.7).
Which density does ⃗Y possess? To answer this, we have to compute det(R) and R−1.
One easily gets det(R) = 9. The inverse matrix of R equals

316
౪
6 Normally distributed random vectors
R−1 = 1
9 (
5
−1
−1
2 ) .
Therefore, the distribution density pμ,R of ⃗Y = (Y1, Y2) is given by (see Fig. 6.2)
pμ,R(x1, x2) = 1
6π exp(−1
2⟨R−1(x1 −3, x2 + 2), (x1 −3, x2 + 2)⟩)
= 1
6π exp(−1
18[5(x1 −3)2 −2(x1 −3)(x2 + 2) + 2(x2 + 2)2]) .
(6.8)
Figure 6.2: The density given by eq. (6.8). It attains its maximal value 1/6π at the point (3, −2).
For later purposes, we have to name the probability measures on (ℝn, ℬ(ℝn)) ap-
pearing as distributions of normal vectors.
Definition 6.1.15. Given μ ∈ℝn and R > 0, the probability measure 𝒩(μ, R) on (ℝn, ℬ(ℝn)) is defined
by
𝒩(μ, R)(B) = ∫
B
pμ,R(x) dx =
1
(2π)n/2|R|1/2 ∫
B
e−1
2 ⟨R−1(x−μ),(x−μ)⟩dx .
Measure 𝒩(μ, R) is called a multivariate normal distribution with expected value μ and covariance
matrix R.
According to Definition 6.1.15, we may now formulate Proposition 6.1.10 as follows:
Proposition 6.1.16. Let ⃗Y be a random vector. Then the following are equivalent:
1.
⃗Y is 𝒩(μ, R)-distributed.
2.
ℙ⃗Y = 𝒩(μ, R).
3.
There is a regular n × n matrix A with R = AAT such that for some standard normal
⃗X one has ⃗Y = A ⃗X + μ.
Remark 6.1.17. If
⃗Y is 𝒩(μ, R)-distributed, the representing matrix A in (3) is not
unique; compare Remark A.4.3. This is already so in the univariate case where an

6.1 Representation and density
౪
317
𝒩(μ, σ2)-distributed random variable Y may either be represented as Y = σX + μ or as
Y = (−σ)X′ + μ for some standard normal random variables X and X′.
Remark 6.1.18. The case R = In (as in Section A.4, we denote the identity matrix in ℝn
by In) and μ = 0 is of special interest. Because I−1
n = In and det(In) = 1, we get
p0,In(x) =
1
(2π)n/2 e−|x|2/2 ,
x ∈ℝn .
This tells us that 𝒩(0, In) is nothing else as the multivariate standard normal distribution
introduced in Definition 1.9.21. Written as formula, this means
𝒩(0, 1)⊗n = 𝒩(0, In) .
More generally, in view of eq. (1.86), it follows that
𝒩(μ, σ2)
⊗n = 𝒩( ⃗μ, σ2 In)
where ⃗μ = (μ, . . . , μ) ∈ℝn and σ > 0. In other words,
𝒩(μ, σ2)
⊗n(B) = 𝒩( ⃗μ, σ2 In)(B) =
1
(2π)n/2σn ∫
B
e−|x−⃗μ|2/2σ2
dx .
(6.9)
For later purposes, the next result is of importance.
Proposition 6.1.19. Suppose a normal vector ⃗Y = (Y1, . . . , Yn) may be written as
⃗Y = U ⃗X
with an 𝒩(0, In)-distributed (standard normal)
⃗X and a unitary matrix U. Then its coor-
dinate mappings Y1, . . . , Yn are independent standard normal random variables.
Proof. The random vector ⃗Y is 𝒩(0, UUT)-distributed. But U is unitary, hence, UUT = In
and ⃗Y is 𝒩(0, In) or, equivalently, standard normally distributed. Then the assertion fol-
lows by Proposition 6.1.2.
Remark 6.1.20. The previous result may be phrased also as follows: If B is a Borel set in
ℝn and B′ = U(B) = {U(x) : x ∈B} for some unitary transformation U, then this implies
𝒩(0, In)(B) = 𝒩(0, In)(B′) .
That is, the n-dimensional standard normal distribution is invariant under unitary
transformations as, e. g., rotations or reflections.
Example 6.1.21. For θ ∈[0, 2π), define the 2 × 2 matrix U by
U = (
cos θ
sin θ
−sin θ
cos θ ) .

318
౪
6 Normally distributed random vectors
The matrix U is unitary (it is a rotation by the angle θ) and, due to Proposition 6.1.19, the
vector ⃗Y = U ⃗X is standard normal. In other words, given independent standard normal
X1 and X2, for each θ ∈[0, 2π) the random variables
Y1 := cos θ X1 + sin θ X2
and
Y2 = −sin θ X1 + cos θ X2
are independent and standard normally distributed as well. That is, if a1 < b1 and
a2 < b2, then we obtain
ℙ{a1 ≤Y1 ≤b1, a2 ≤Y2 ≤b2} = 1
2π (
b1
∫
a1
e−x2
1/2dx1)(
b2
∫
a2
e−x2
2/2dx2)
= 1
2π
∬
[a1,b1]×[a2,b2]
e−|x|2/2dx .
6.2 Expected value and covariance matrix
We start with the following definition.
Definition 6.2.1. Let ⃗Y = (Y1, . . . , Yn) be a random vector such that 𝔼|Yj| < ∞for all 1 ≤j ≤n. Then the
vector
𝔼⃗Y := (𝔼Y1, . . . , 𝔼Yn) = (μ1, . . . , μn)
is called the (multivariate) expected value of ⃗Y.
If 𝔼Y2
j < ∞, 1 ≤j ≤n, then the matrix
Cov ⃗Y := (Cov(Yi, Yj))
n
i,j=1 = (𝔼(Yi −μi)(Yj −μj))
n
i,j=1
is said to be the covariance matrix of ⃗Y.
Remark 6.2.2. It is important to notice that both 𝔼⃗Y and the covariance matrix Cov ⃗Y
depend only on the distribution of ⃗Y. That is, whenever ℙ⃗Y1 = ℙ⃗Y2, then
𝔼⃗Y1 = 𝔼⃗Y2
and
Cov ⃗Y1 = Cov ⃗Y2 .
The next proposition describes the (multivariate) expected value and the covari-
ance matrix of a normally distributed vector.
Proposition 6.2.3. Assume ⃗Y = A ⃗X+μ for some regular matrix A, with ⃗X standard normal
and μ ∈ℝn. Define R = (rij)n
i,j=1 as R = AAT. Then the following are valid:
(1) We have 𝔼⃗Y = μ and Cov ⃗Y = (Cov(Yi, Yj))n
i,j=1 = R.
(2) Given a ∈ℝn, a
̸= 0, then ⟨⃗Y, a⟩is a normal random variable with expected value
⟨μ, a⟩and variance ⟨Ra, a⟩.

6.2 Expected value and covariance matrix
౪
319
(3) The coordinate mappings Y i are 𝒩(μi, rii)-distributed, 1 ≤i ≤n, that is, the marginal
distributions of ⃗Y are the probability measures 𝒩(μi, rii).
Proof. By assumption,
Yi =
n
∑
j=1
αijXj + μi ,
i = 1, . . . , n ,
(6.10)
hence, the linearity of the expected value and 𝔼Xj = 0 imply
𝔼Yi =
n
∑
j=1
αij 𝔼Xj + μi = μi ,
1 ≤i ≤n .
This proves 𝔼⃗Y = (𝔼Y1, . . . , 𝔼Yn) = μ.
Let us now verify the second part of property (1). Using μj = 𝔼Yj, from representa-
tion (6.10) we get
Cov(Yi, Yj) = 𝔼[(Yi −μi)(Yj −μj)] = 𝔼(
n
∑
k=1
αikXk)(
n
∑
ℓ=1
αjℓXℓ)
=
n
∑
k,ℓ=1
αikαjℓ𝔼XkXℓ.
The Xjs are independent 𝒩(0, 1)-distributed, hence
𝔼XkXℓ= {1
if k = ℓ,
0
if k
̸= ℓ,
leading to
Cov(Yi, Yj) =
n
∑
k=1
αikαjk = rij .
To see this, recall that R = AAT, hence rij = ∑n
k=1 αikαjk. This proves Cov ⃗Y = R, as asserted.
To verify property (2), we first treat a special case, namely that the random vector
is standard normally distributed. So suppose that ⃗X is 𝒩(0, In)-distributed. In this case,
property (2) asserts the following. For any b ∈ℝn, b
̸= 0, we have
⟨⃗X, b⟩is distributed according to 𝒩(0, |b|2) .
(6.11)
If b = (b1, . . . , bn), then
⟨⃗X, b⟩=
n
∑
j=1
bjXj =
n
∑
j=1
Zj

320
౪
6 Normally distributed random vectors
with Zj
=
bjXj. The random variables Z1, . . . , Zn are independent and, moreover,
by Proposition 4.2.3, the Zjs are 𝒩(0, b2
j )-distributed. Proposition 4.6.11 implies that
∑n
j=1 Zj is distributed according to 𝒩(0, ∑n
j=1 b2
j ). In view of ∑n
j=1 b2
j = |b|2, this proves
assertion (6.11).
Let us now turn to the general case. Recall that
⃗Y = A ⃗X + μ
and R = AAT. If a ∈ℝn is a nonzero vector, then we take the scalar product with respect
to a on both sides of the last equation and obtain
⟨⃗Y, a⟩= ⟨A ⃗X, a⟩+ ⟨μ, a⟩= ⟨⃗X, ATa⟩+ ⟨μ, a⟩.
An application of statement (6.11) with b = ATa lets us conclude that ⟨⃗X, ATa⟩is
𝒩(0, |ATa|2)-distributed, that is, ⟨⃗Y, a⟩is 𝒩(⟨μ, a⟩, |ATa|2)-distributed. Here we used
that A, hence also AT, is regular, so that a
̸= 0 yields b = ATa
̸= 0, and statement (6.11)
applies. Assertion (2) follows now from
󵄨󵄨󵄨󵄨ATa󵄨󵄨󵄨󵄨
2 = ⟨ATa, ATa⟩= ⟨AATa, a⟩= ⟨Ra, a⟩.
Property (3) is an immediate consequence of the second. An application of property (2)
to the ith unit vector ei = (0, . . . , 0, 1
⏟⏟⏟⏟⏟⏟⏟
i
, 0, . . . , 0) in ℝn leads, on the one hand, to
⟨⃗Y, ei⟩= Yi ,
1 ≤i ≤n ,
and, on the other hand, to
⟨Rei, ei⟩= rii
and
⟨μ, ei⟩= μi ,
1 ≤i ≤n .
Thus, by property (2), for each i ≤n the random variable Y i is 𝒩(μi, rii)-distributed. This
completes the proof.
Corollary 6.2.4. If ⃗Y is 𝒩(μ, R)-distributed, then 𝔼⃗Y = μ and Cov ⃗Y = R.
Proof. Choose any regular n × n matrix ̃A such that R =
̃A ̃AT. The existence of such an ̃A
is proved in Proposition A.4.2. Set ⃗Z =
̃A ⃗X + μ for some standard normal vector ⃗X. Then
⃗Y and ⃗Z are both 𝒩(μ, R)-distributed, hence ⃗Z
d=
⃗Y. Proposition 6.2.3 implies 𝔼⃗Z = μ and
Cov ⃗Z = R. Consequently, by Remark 6.2.2, it follows that
𝔼⃗Y = 𝔼⃗Z = μ
and
Cov ⃗Y = Cov ⃗Z = R ,
which completes the proof.
In view of property Corollary 6.2.4, we will use the following notation.

6.2 Expected value and covariance matrix
౪
321
Definition 6.2.5. If ⃗Y is 𝒩(μ, R)-distributed, then the parameters μ and R are called the (multivariate)
expected value and the covariance matrix of ⃗Y, respectively.
Remark 6.2.6. We proved above that, for any normal vector ⃗Y, the coordinate mappings
Yi = ⟨⃗Y, ei⟩are normal as well. The converse is not valid. There are random vectors
⃗Y
with all random variables ⟨⃗Y, ei⟩normal, 1 ≤i ≤n, but ⃗Y is not normal.
In contrast to this remark, the following is valid.
Proposition 6.2.7. If ⟨⃗Y, a⟩is normal for all nonzero a ∈ℝn, then ⃗Y is normal as well.
Idea of the proof. By assumption, for each a
̸= 0 there are real numbers μa and σa > 0
such that ⟨⃗Y, a⟩is 𝒩(μa, σ2
a)-distributed. In order to prove the proposition, one has to
show that there are a μ ∈ℝn with μa = ⟨μ, a⟩and an R > 0 such that σ2
a = ⟨Ra, a⟩,
a ∈ℝn. The existence of the vector μ easily follows from
μαa+βb = 𝔼⟨⃗Y, αa + βb⟩= α𝔼⟨⃗Y, a⟩+ β⟨⃗Y, b⟩= αμa + βμb ,
using the fact that each linear mapping from ℝn to ℝis of the form a 󳨃→⟨a, μ⟩for a
suitable μ ∈ℝn.
The existence of an R > 0 with σ2
a = ⟨Ra, a⟩is consequence of a representation
theorem for positive quadratic forms on ℝn. To this end, one has to show that a 󳨃→σ2
a is
a positive quadratic form, which follows by using σ2
a = 𝔼⟨⃗Y, a⟩2.
As we saw above (see Proposition 5.3.10), independent random variables are un-
correlated. On the other hand, Examples 5.3.12 and 5.3.15 showed the existence of un-
correlated variables that are not independent. Thus, in general, the property of being
uncorrelated is weaker than that of being independent.
One of the basic features of normal vectors is that for them uncorrelated coordinate
mappings are already independent. This somehow explains why in the common speech
these properties are synonyms.
Proposition 6.2.8. Let ⃗Y = (Y1, . . . , Yn) be a normally distributed vector. Then the follow-
ing are equivalent:
(1) Y1, . . . , Yn are independent.
(2) Y1, . . . , Yn are uncorrelated.
(3) The covariance matrix Cov ⃗Y is a diagonal matrix.
Proof. The implication (1) ⇒(2) follows by Proposition 5.3.10. If the Yjs are uncorre-
lated, then this tells us that Cov(Yi, Yj) = 0 whenever i
̸= j. Thus, Cov ⃗Y is a diagonal
matrix, which proves (2) ⇒(3).
It remains to verify (3) ⇒(1). Thus assume that
⃗Y is 𝒩(μ, R)-distributed, where
R > 0 is a diagonal matrix. Let r11, . . . , rnn be the entries of R at the diagonal. Define A
as diagonal matrix with r1/2
11 , . . . , r1/2
nn on the diagonal. Note that R > 0 implies rii > 0,
hence A is well defined. Of course, then AAT = R, hence ⃗Y has the same distribution as

322
౪
6 Normally distributed random vectors
the vector (Z1, . . . , Zn) with
Zi = r1/2
ii Xi + μi ,
1 ≤i ≤n ,
where X1, . . . , Xn are independent standard normal. Proposition 4.1.9 lets us conclude
that Z1, . . . , Zn are independent normal random variables. But since ⃗Y
d=
⃗Z, the random
variables Y1, . . . , Yn are independent as well.1
Remark 6.2.9. Another property, being equivalent to those in Proposition 6.2.8, is as
follows. The density function of ⃗Y with independent coordinates equals
pμ,R(x) =
1
(2π)n/2|R|1/2 e−∑n
j=1(xj−μj)2/2rjj ,
x = (x1, . . . , xn) .
Note that |R| = det(R) = r11 ⋅⋅⋅rnn.
Finally, we investigate the case of two-dimensional normal vectors more thoroughly.
Thus assume ⃗Y = (Y1, Y2) is a normal vector. Then the covariance matrix R is given by
R = (
𝕍Y1
Cov(Y1, Y2)
Cov(Y1, Y2)
𝕍Y2
) .
Let σ2
1 and σ2
2 be the variances of Y1 and Y2, respectively, and let ρ = ρ(Y1, Y2) be their
correlation coefficient.2 Because of
Cov(Y1, Y2) = (𝕍Y1)1/2(𝕍Y2)1/2 ρ(Y1, Y2) = σ1σ2 ρ,
we may rewrite R as
R = (
σ2
1
ρσ1σ2
ρσ1σ2
σ2
2
) .
This implies det(R) = σ2
1σ2
2(1 −ρ2). Since σ2
1 > 0, the matrix R is positive if and only if
|ρ| < 1. The inverse matrix R−1 can be computed by Cramer’s rule as
R−1 =
1
σ2
1σ2
2(1 −ρ2) (
σ2
2
−ρσ1σ2
−ρσ1σ2
σ2
1
) =
1
1 −ρ2 (
1
σ2
1
−ρ
σ1σ2
−ρ
σ1σ2
1
σ2
2
) .
Consequently,
1 Indeed, use the characterization of independent random variables given in Proposition 3.6.5. The con-
dition stated there depends only on the joint distribution.
2 Recall that ρ describes the degree and the way of the dependence between Y1 and Y2. These two random
variables are positively correlated if ρ > 0, negatively if ρ < 0, strongly dependent if ρ is near 1 or −1,
and only weakly dependent in the case that ρ is near zero.

6.2 Expected value and covariance matrix
౪
323
⟨R−1x, x⟩=
1
1 −ρ2 ( x2
1
σ2
1
−2ρ x1x2
σ1σ2
+ x2
2
σ2
2
),
x = (x1, x2) ∈ℝ2 .
If μ = (μ1, μ2) = (𝔼Y1, 𝔼Y2) denotes the expected value of ⃗Y, then for a1 < b1 and a2 < b2,
ℙ{a1 ≤Y1 ≤b1, a2 ≤Y2 ≤b2} =
1
2π(1 −ρ2)1/2σ1σ2
×
b1
∫
a1
b2
∫
a2
exp(−
1
2(1 −ρ2)[(x1 −μ1)2
σ2
1
−2ρ (x1 −μ1)(x2 −μ2)
σ1σ2
+ (x2 −μ2)2
σ2
2
])dx2 dx1 .
(6.12)
Compare this with the case of independent Y1 and Y2 or, equivalently, with the case ρ = 0.
Here it follows that
ℙ{a1 ≤Y1 ≤b1, a2 ≤Y2 ≤b2}
=
1
2πσ1σ2
b1
∫
a1
b2
∫
a2
exp(−1
2[(x1 −μ1)2
σ2
1
+ (x2 −μ2)2
σ2
2
])dx2 dx1 .
(6.13)
It is worthwhile to mention that in both cases (dependent and independent) the mar-
ginal distributions are the same, namely 𝒩(μ1, σ2
1) and 𝒩(μ2, σ2
2). A comparison of
eqs. (6.12) and (6.13) shows clearly the influence of the correlation coefficient to the
density (see Fig. 6.3).
Summary: An n-dimensional random vector ⃗Y = (Y1, . . . , Yn) is said to be normal (or the Yjs are called jointly
normal) if there are a regular n × n matrix A = (αij)n
i,j=1 and a vector μ = (μ1, . . . , μn) ∈ℝn such that with
independent 𝒩(0, 1)-distributed X1, . . . , Xn,
Yi =
n
∑
j=1
αijXj + μi ,
1 ≤i ≤n .
Equivalently, ⃗Y is normal if and only if there are a positive n × n matrix R = (rij)n
i,j=1 and a μ ∈ℝn such that
ℙ{ ⃗Y ∈B} =
1
(2π)n/2|R|1/2 ∫
B
e −⟨R−1(x−μ),(x−μ)⟩/2 dx .
The matrices A and R are linked by R = AAT. If ⃗Y is normal, the coordinates Y1, . . . , Yn are normal (univariate)
random variables (the converse is in general not true) with
𝔼Yi = μi
and
Cov(Yi, Yj) = rij ,
1 ≤i, j ≤n .
Let ⃗Y be a normal vector. Then the Yjs are pairwise uncorrelated if and only if they are independent:
Y1, . . . , Yn independent
⇔
Cov(Yi, Yj) = 0, 1 ≤i < j ≤n .

324
౪
6 Normally distributed random vectors
Figure 6.3: The 2-dimensional densities of a normal vector with μ1 = μ2 = 0, σ1 = 2, σ2 = 1, and
ρ = 0, 0.25, 0.75, −0.5 from top left to bottom right. Thus, the coordinates of normal vectors with these
densities are either independent (ρ = 0), weakly (ρ = 0.25) or strongly (ρ = 0.75) positively correlated. In
the last case (ρ = −0.5), they are moderately negatively correlated; values in the regions {x > 0, y < 0} and
{x < 0, y > 0} become more likely.
6.3 Problems
Problem 6.1. Let ⃗Y = (Y1, . . . , Yn) be an arbitrary (not necessarily normal) random vec-
tor.
1.
Show that 𝔼|Yj| < ∞, 1 ≤j ≤n, if and only if 𝔼| ⃗Y| < ∞. Here | ⃗Y| denotes the
Euclidean distance of ⃗Y.
2.
Let A be an arbitrary n × n matrix. Prove that
𝔼(A ⃗Y) = A(𝔼⃗Y)
provided that 𝔼| ⃗Y| < ∞.
3.
Show that 𝔼|Yj|2 < ∞, 1 ≤j ≤n, if and only if 𝔼| ⃗Y|2 < ∞.
4.
Suppose 𝔼| ⃗Y|2 < ∞. Let Cov ⃗Y be the covariance matrix of
⃗Y. Prove that Cov ⃗Y is
nonnegative definite, that is,
⟨Cov ⃗Yx, x⟩≥0 ,
x ∈ℝn .
Problem 6.2. Roll a fair die two times. Let X1 be the greater of the two rolls and X2 de-
notes the smaller one. Evaluate the expected value μ ∈ℝ2 and the covariance matrix of
the random vector ⃗X = (X1, X2).

6.3 Problems
౪
325
Problem 6.3. Let X1 and X2 be two independent standard normal random variables.
Define Y1 and Y2 by
Y1 = 2X1 −2X2 + 1
and
Y2 = 3X1 + X2 −2 .
1.
Find μ ∈ℝ2 and the positive 2 × 2 matrix R such that
⃗Y = (Y1, Y2) is 𝒩(μ, R)-
distributed.
2.
Determine Cov ⃗Y and the correlation coefficient ρ = ρ(Y1, Y2). Are Y1 and Y2 posi-
tively or negatively correlated?
3.
Which distribution do Y1 + Y2 and Y1 −Y2 posses?
4.
Evaluate the distribution density of ⃗Y.
Problem 6.4. Let ⃗X = (X1, X2) be a two-dimensional standard normal vector. Compute
ℙ{| ⃗X| ≤1} = ℙ{X2
1 + X2
2 ≤1} .
Hint: Compare with the proof of Proposition 1.6.7.
Problem 6.5. Let X1, . . . , Xn+m be a sequence of independent standard normal random
variables. For an n × n matrix A = (αij)n
i,j=1 and an m × m matrix B = (βkl)m
k,l=1, define two
normal vectors ⃗Y and ⃗Z by
Yi =
n
∑
j=1
αijXj
and
Zk =
m
∑
l=1
βklXl+n ,
with 1 ≤i ≤n and 1 ≤k ≤m. Let ( ⃗Y, ⃗Z) be the (n + m)-dimensional vector
( ⃗Y, ⃗Z) = (Y1, . . . , Yn, Z1, . . . , Zm) .
Why is ( ⃗Y, ⃗Z) normal? Show that the covariance matrix Cov( ⃗Y, ⃗Z) is given by
Cov( ⃗Y, ⃗Z) = ( Cov ⃗Y
0
0
Cov ⃗Z
) .
Problem 6.6. Let X1, X2, and X3 be three standard normal independent random vari-
ables. Define the random vector ⃗Y by
⃗Y := (X1 −1, X1 + X2 −1, X1 + X2 + X3 −1) .
1.
Argue why
⃗Y is normal. Determine its expected value, covariance matrix, and the
correlation coefficients ρ(Yi, Yj), 1 ≤i < j ≤3.
2.
Determine the distribution density of ⃗Y.

326
౪
6 Normally distributed random vectors
Problem 6.7. The random vector ⃗Y = (Y1, . . . , Yn) is 𝒩(μ, R)-distributed for some μ ∈ℝn
and R > 0. Determine the distribution of Y1 + ⋅⋅⋅+ Yn.
Problem 6.8. Prove the following assertion: If ⃗Y is 𝒩(0, R)-distributed, then there exist
an orthonormal basis (fj)n
j=1 in ℝn, positive numbers λ1, . . . , λn and independent 𝒩(0, 1)-
distributed ξ1, . . . , ξn such that
⃗Y =
n
∑
j=1
λjξj fj .
(6.14)
Hint: Use the principal axis transformation for symmetric matrices and the fact that
unitary matrices map an orthonormal basis onto an orthonormal basis.
Conclude from eq. (6.14) the following: If
⃗Y is 𝒩(0, R)-distributed, then there are
a1, . . . , an in ℝn such that ⟨⃗Y, a1⟩, . . . , ⟨⃗Y, an⟩is a sequence of independent standard nor-
mal random variables.
Problem 6.9. The n-dimensional vector ⃗Y is distributed according to 𝒩(μ, R). For some
regular n × n matrix S, define
⃗Z by
⃗Z := S ⃗Y. Is
⃗Z normal? If this is so, determine the
expected value and the covariance matrix of ⃗Z.
Problem 6.10. Let ⃗X = (X1, X2) be standard normal. Define random variables Y1 and Y2
by
Y1 :=
1
√2
(X1 + X2)
and
Y2 :=
1
√2
(X1 −X2) .
Why are Y1 and Y2 also independent and standard normal?

7 Limit theorems
Probability Theory does not have the ability to predict the occurrence or nonoccurrence
of a single event in a random experiment; besides, this event occurs either with prob-
ability one or with probability zero. For example, Probability Theory does not give any
information about the next result when rolling a die, it does not predict the numbers
appearing next week on the lottery nor is it able to foresee the lifetime of a component
in a machine. Such statements are impossible within the theory. The theory is only able
to say that some events are more likely and others are less likely. For instance, when
rolling a die twice, it is more likely that the sum of both rolls will be “7” than “2.” Never-
theless, next when we roll the die the sum may be “2,” not “7.” The event “the sum is 2”
is not impossible, only less likely.
In contrast, Probability Theory provides us with very precise and far-reaching in-
formation about the behavior of the results when we execute “many” identical random
experiments. As already said, we cannot tell anything about the expected number on a
die when we roll it once, but we are able to say a lot about the frequency of the number
“6” when rolling a die many times, namely that, on average, this number will appear in
one of six cases (provided the die is fair). In this example, certain laws of Probability The-
ory, which we will present in this section, are operating. These laws are only applicable
in the case of many experiments, not in that of a single one.
Limit theorems in Probability Theory belong to the most beautiful and most im-
portant assertions within this theory. They are always the highlight of a lecture about
advanced Probability Theory. However, their proofs require a longer comprehensive
mathematical explanation, which is impossible to give here within the framework of
this book. Those who are interested in knowing more about this topic may look into one
of the more advanced books, such as [Bil12, Dur19] or [Kho07]. Although the proofs of
the limit theorems are mostly quite complicated, they are very important, and their con-
sequences influence our daily lives. Moreover, great parts of Mathematical Statistics are
based on these results. Therefore, we decided to state here the crucial assertions with-
out proving most of them. Thus, our main focus is to present the most important limit
theorems, to explain them in detail, and to give examples that show how they apply. If
possible, we give some hint as to how the results are derived, but mostly we must resign
to prove them.
7.1 Laws of large numbers
7.1.1 Chebyshev’s inequality
Our first objective is to prove Chebyshev’s inequality. To do so, we need the following
lemma.
https://doi.org/10.1515/9783111325064-007

328
౪
7 Limit theorems
Lemma 7.1.1. Let Y be a nonnegative random variable. Then for each λ > 0 it follows that
ℙ{Y ≥λ} ≤𝔼Y
λ .
(7.1)
Proof. Let us first treat the case that Y is discrete. Since Y ≥0, its possible values
y1, y2, . . . are nonnegative real numbers. Therefore, we get
𝔼Y =
∞
∑
j=1
yj ℙ{Y = yj} ≥∑
yj≥λ
yj ℙ{Y = yj}
≥λ ∑
yj≥λ
ℙ{Y = yj} = λℙ{Y ≥λ} .
Solving the inequality for ℙ{Y ≥λ} proves inequality (7.1).
The proof of estimate (7.1) for continuous Y uses similar methods. If q denotes the
distribution density of Y, by Y ≥0 we may suppose q(y) = 0 for y < 0. Then, as in the
discrete case, we conclude that
𝔼Y =
∞
∫
0
yq(y) dy ≥
∞
∫
λ
yq(y) dy ≥λ
∞
∫
λ
q(y) dy = λℙ{Y ≥λ} .
From this inequality, (7.1) follows directly.
Remark 7.1.2. Sometimes it is useful to apply inequality (7.1) in a slightly modified way.
For example, if Y ≥0 and α > 0, then one derives
ℙ{Y ≥λ} = ℙ{Y α ≥λα} ≤𝔼Y α
λα .
Or, if Y is real valued, then for λ ∈ℝwe obtain
ℙ{Y ≤λ} = ℙ{e−Y ≥e−λ} ≤𝔼e−Y
e−λ
= eλ 𝔼e−Y .
Now we are in a position to state and to prove Chebyshev’s inequality.
Proposition 7.1.3 (Chebyshev’s inequality). Let X be a random variable with finite second
moment. Then, if c > 0, it follows that
ℙ{|X −𝔼X| ≥c} ≤𝕍X
c2 .
(7.2)
Proof. Setting Y := |X −𝔼X|2, we have Y ≥0 and 𝔼Y = 𝕍X. Now apply inequality (7.1)
to Y with λ = c2. This leads to
ℙ{|X −𝔼X| ≥c} = ℙ{|X −𝔼X|2 ≥c2} = ℙ{Y ≥c2} ≤𝔼Y
c2 = 𝕍X
c2 ,
and estimate (7.2) is proven.

7.1 Laws of large numbers
౪
329
Interpretation: Inequality (7.2) quantifies the interpretation of 𝕍X as a measure for
the dispersion of X. The smaller the 𝕍X, the less the probability that the values of X are
far away from its expected value 𝔼X.
Remark 7.1.4. Another way to formulate inequality (7.2) is as follows. If κ > 0, then
ℙ{|X −𝔼X| ≥κ (𝕍X)1/2} ≤1
κ2 .
To see this, apply inequality (7.2) with c = κ (𝕍X)1/2.
Example 7.1.5. Roll a fair die n times. If, for example, A = {6}, we are interested in the
relative frequency rn(A) of the occurrence of A. Recall that this frequency was defined
in eq. (1.1). Moreover, we claimed in this section that limn→∞rn(A) = ℙ(A) =
1
6. Is it
possible to estimate the probability for |rn(A) −1
6| being bigger than some given c > 0?
Answer: Define the random variable X as the absolute frequency of the occurrence
of A, that is, we have X = k for some k = 0, . . . , n provided that A occurred exactly k
times. Then X is binomial distributed with parameters n and p = 1/6. To see this, define
“success” as appearance of “6.” Consequently, the relative frequency can be represented
as rn(A) = X
n . An application of eqs. (5.8) and (5.36) gives
𝔼rn(A) = 1
n 𝔼X = np
n = p = 1
6
and
𝕍rn(A) = np(1 −p)
n2
=
5
36 n .
Thus, inequality (7.2) leads to
ℙ{
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
rn(A) −1
6
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
≥c} ≤
5
36 c2 n .
If, for example, n = 103, and if we choose c = 1/36, then Chebyshev’s inequality yields
ℙ{ 5
36 < r103(A) < 7
36} ≥1 −9
50 = 0.82 .
For the absolute frequency, this means
ℙ{139 ≤a103(A) ≤194} ≥0.82 .
Let us interpret the result. Suppose we roll a fair die 1000 times. Then, with a probability
of at least 82 %, the frequency of “6” will be between 139 and 194.
Let us present a second quite similar example.
Example 7.1.6. Roll a fair die n times and let Sn be the sum of the n results. Then Sn =
X1 + ⋅⋅⋅+ Xn, where X1, . . . , Xn are uniformly distributed on {1, . . . , 6} and independent.
By Example 5.2.17, we know that
𝔼Sn = 𝔼X1 + ⋅⋅⋅+ 𝔼Xn = 7n
2
and
𝕍Sn = 𝕍X1 + ⋅⋅⋅+ 𝕍Xn = 35n
12 ,

330
౪
7 Limit theorems
hence
𝔼(Sn
n ) = 7
2
and
𝕍(Sn
n ) = 35
12n .
An application of inequality (7.2) leads then to
ℙ{
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
Sn
n −7
2
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
≥c} ≤
35
12nc2 .
For example, if n = 103 and c is chosen as c = 0.1, then
ℙ{3.4 < S103
103 < 3.6} ≥0.709 .
The interpretation of this result is as in the previous example. With a probability larger
than 70 % the sum of 1000 rolls of a fair die will be a number between 3400 and 3600.
This looks like to be a pretty rough estimate and, indeed, this is so. Sharper bounds
follow by using the central limit theorem as we will see in Example 7.2.14.
Summary: Let X be a random variable with finite second moment. Then Chebyshev’s inequality asserts that
for any c > 0,
ℙ{|X −𝔼X| ≥c} ≤𝕍X
c2 .
This inequality clarifies once more the role of the variance 𝕍X. The smaller the 𝕍(X), the more likely the
random observations are concentrated around 𝔼X.
7.1.2 Infinite sequences of independent random variables∗
Whenever one wants to describe the limit behavior of random variables or random
events, one needs a model for the infinite performance of random experiments. Oth-
erwise, we cannot investigate limits or other related quantities. This is comparable with
similar investigations in Calculus. In order to analyze limits, infinite sequences are nec-
essary, not finite ones. Thus, for the examination of limits of random variables we need
an infinite sequence X1, X2, . . . of random variables, which are, on the one hand, inde-
pendent in the sense of Definition 4.3.4 and, on the other hand, possess some given prob-
ability distributions.
Example 7.1.7. In order to describe the infinite tossing of a fair coin, we need indepen-
dent random variables X1, X2, . . . such that ℙ{Xj = 0} = ℙ{Xj = 1} = 1
2. Or, similarly, for
a model of rolling a die infinitely often, we need infinitely many independent random
variables all uniformly distributed on {1, . . . , 6}.

7.1 Laws of large numbers
౪
331
In Proposition 4.3.3, we presented the construction of independent (Xj)∞
j=1 dis-
tributed according to B1,1/2. This technique can be extended to more general sequences
of random variables, but it is quite complicated. Another, much smarter way is to use
so-called infinite product measures.1 Their existence follows by a deep theorem due
to A. N. Kolmogorov. As a consequence, one gets the following result, which cannot be
proven within the framework of this book. We refer to [Kho07, Chapter 5, § 2] or [Ros06,
Theorem 7.1.1] for proofs.
Proposition 7.1.8. Let ℙ1, ℙ2, . . . be arbitrary probability measures on (ℝ, ℬ(ℝ)). Then
there are a probability space (Ω, 𝒜, ℙ) and an infinite sequence of random variables
Xj : Ω →ℝsuch that the following hold:
1.
The probability distribution of Xj is ℙj, j = 1, 2, . . . That is, for all j ≥1 and all B ∈ℬ(ℝ),
it follows that
ℙ{Xj ∈B} = Pj(B) .
2.
The random variables X1, X2, . . . are independent in the sense of Definition 4.3.4. This
says, for all n ≥1 and all Bj ∈ℬ(ℝ), it follows that
ℙ{X1 ∈B1, . . . , Xn ∈Bn} = ℙ{X1 ∈B1} ⋅⋅⋅ℙ{Xn ∈Bn}
= ℙ1(B1) ⋅⋅⋅ℙn(Bn) .
Of special interest is the case ℙ1 = ℙ2 = ⋅⋅⋅= ℙ0 for a certain probability measure
ℙ0 on ℝ. Then the previous proposition implies the following.
Corollary 7.1.9. Given an arbitrary probability measure ℙ0 on ℬ(ℝ), there are random
variables X1, X2, . . ., defined on some probability space (Ω, 𝒜, ℙ), such that for all n ≥1
and all Bj ∈ℬ(ℝ),
ℙ{X1 ∈B1, . . . , Xn ∈Bn} = ℙ0(B1) ⋅⋅⋅ℙ0(Bn) .
Example 7.1.10. Choosing as ℙ0 the uniform distribution on [0, 1], the previous corol-
lary ensures the existence of (independent) random variables X1, X2, . . . such that for all
n ≥1 and all 0 ≤aj < bj ≤1,
ℙ{a1 ≤X1 ≤b1, . . . , an ≤Xn ≤bn} =
n
∏
j=1
(bj −aj) .
The sequence X1, X2, . . . models the independent choosing of infinitely many numbers
uniformly distributed in [0, 1].
1 Compare with Proposition 3.6.7 for the construction of finitely many independent random variables
possessing given distributions. There we used finite product measures to obtain independent random
variables possessing given distributions ℙ1, . . . , ℙn.

332
౪
7 Limit theorems
Remark 7.1.11. One may ask whether the kind of independence in Definition 4.3.4 suf-
fices for later purposes. Recall, we only require X1, . . . , Xn to be independent for all (fi-
nite) n ≥1. Maybe one would expect a condition that involves the whole infinite se-
quence, not only a finite part of it. The answer is that such a condition for the whole
sequence is a consequence of Definition 4.3.4. Namely, if B1, B2, . . . are Borel sets in ℝ,
then, by the continuity of probability measures from above, it follows that
ℙ{X1 ∈B1, X2 ∈B2, . . .} = lim
n→∞ℙ{X1 ∈B1, . . . , Xn ∈Bn}
= lim
n→∞ℙ{X1 ∈B1} ⋅⋅⋅ℙ{Xn ∈Bn}
= lim
n→∞
n
∏
j=1
ℙ{Xj ∈Bj} =
∞
∏
j=1
ℙ{Xj ∈Bj} .
In particular, if aj < bj, j = 1, 2, . . ., this implies
ℙ{a1 ≤X1 ≤b1, a2 ≤X2 ≤b2, . . . } =
∞
∏
j=1
ℙ{aj ≤Xj ≤bj} .
(7.3)
Example 7.1.12. Let X1, X2, . . . be a sequence of independent Eλ-distributed random vari-
ables for some λ > 0. Given real numbers αj > 0, we ask for the probability of
ℙ{X1 ≤α1, X2 ≤α2, . . .} .
Answer: If we apply eq. (7.3) with aj = 0 and with bj = αj, then we get
ℙ{X1 ≤α1, X2 ≤α2, . . .} =
∞
∏
j=1
ℙ{Xj ≤αj} =
∞
∏
j=1
[1 −e−λαj].
Of special interest are sequences (aj)j≥1 such that the infinite product converges, that is,
for these sequences (aj)j≥1 we have ∏∞
j=1[1 −e−λαj] > 0. This happens if and only if
ln(
∞
∏
j=1
[1 −e−λαj]) =
∞
∑
j=1
ln[1 −e−λαj] > −∞.
(7.4)
Because of
lim
x→0
ln(1 −x)
−x
= 1 ,
by the limit comparison test for infinite series, condition (7.4) holds if and only if
∞
∑
j=1
e−λαj < ∞.

7.1 Laws of large numbers
౪
333
If, for example, aj = c ⋅ln(j + 1) for some c > 0, then
∞
∑
j=1
e−λαj =
∞
∑
j=1
1
(j + 1)λc .
This sum is known to be finite if and only if λc > 1, that is, if c > 1/λ.
Another way to formulate this observation is as follows. One has
ℙ{sup
j≥1
Xj
ln(j + 1) ≤c} = ℙ{Xj ≤c ln(j + 1) , ∀j ≥1} =
∞
∏
j=1
(1 −
1
(j + 1)λc ),
and this probability is positive if and only if c > 1/λ.
Summary: An infinite sequence X1, X2, . . . of random variables is said to be independent if for each n ≥1 the
finite sequence X1, . . . , Xn is independent. In particular, this implies for all ai < bi that
ℙ{ai ≤Xi ≤bi , i = 1, 2, . . .} =
∞
∏
i=1
ℙ{ai ≤Xi ≤bi} .
Given probability measures ℙ1, ℙ2, . . . on ℝ, there are independent random variables X1, X2, . . . on a proba-
bility space (Ω, 𝒜, ℙ) so that ℙXj = ℙj, j = 1, 2, . . . That is, for all Borel sets B in ℬ(ℝ) and j = 1, 2, . . ., we
have
ℙ{ω ∈Ω : Xj(ω) ∈B} = ℙ{Xj ∈B} = ℙj(B) .
For example, there are infinitely many independent random variables Xj such that
ℙ{Xj = 1} = ⋅⋅⋅= ℙ{Xj = 6} = 1
6 .
These Xjs may serve as model for rolling a die infinitely often.
7.1.3 Borel–Cantelli lemma∗
The aim of this section is to present one of the most useful tools for the investigation of
the limit behavior of infinite sequences of random variables and events. Let (Ω, 𝒜, ℙ)
be a probability space and let A1, A2, . . . be a sequence of events in 𝒜. Then two typical
questions arise. What is the probability that there exists some n ∈ℕsuch that all events
Am with m ≥n occur? The other related question asks for the probability that infinitely
many of the events An occur.
To explain why these questions are of interest, let us once more regard Example 4.1.7
of the random walk. Here Sn denotes the integer where the particle is located after n
random jumps. For example, letting An := {ω ∈Ω : Sn(ω) > 0}, then the existence of an
n ∈ℕsuch that Am occurs for all m ≥n says that the particle from a certain (random)

334
౪
7 Limit theorems
moment attains only positive numbers and never goes back to the negative ones. Or, if
we investigate the events Bn := {ω ∈Ω : Sn(ω) = 0}, then the Bns occur infinitely often if
and only if the particle returns to zero infinitely often. Equivalently, there are (random)
n1 < n2 < ⋅⋅⋅with Snj(ω) = 0.
To formulate the two previous questions more precisely, let us introduce the follow-
ing two events.
Definition 7.1.13. Let A1, A2, . . . be subsets of Ω. Then
lim inf
n→∞An :=
∞
⋃
n=1
∞
⋂
m=n
Am
and
lim sup
n→∞An :=
∞
⋂
n=1
∞
⋃
m=n
Am
are called the lower and upper limit of the Ans.
Remark 7.1.14. Let us characterize when the lower and the upper limit occur.
1.
An element ω ∈Ω belongs to lim infn→∞An if and only if there is an n ∈ℕsuch
that ω ∈⋂∞
m=n Am, that is, if it is an element of Am for m ≥n. In other words, the
lower limit occurs if there is an2 n ∈ℕsuch that after n the events Am always occur.
Therefore, we say that lim infn→∞An occurs if the Ans finally always (abbreviated
as f. a.) occur. Thus,
ℙ{ω ∈Ω : ∃n such that ω ∈Am , m ≥n} = ℙ(lim inf
n→∞An).
2.
An element ω ∈Ω belongs to lim supn→∞An if and only if for each n ∈ℕthere is
an m ≥n such that ω ∈Am. But this is nothing else as saying that the number of
Ans with ω ∈An is infinite. Therefore, the upper limit consists of those elements for
which we have infinitely often (abbreviated as i. o.) ω ∈An. Note that also these
events may be different for different ω. Thus,
ℙ{ω ∈Ω : ω ∈An for infinitely many n} = ℙ(lim sup
n→∞An).
Example 7.1.15. Suppose a fair coin is labeled on one side with “0” and on the other side
with “1.” We toss it infinitely often. Let An occur if the nth toss is “1.” Then lim infn→∞An
occurs if after a certain number of tosses “1” always shows up. On the other hand,
lim supn→∞An occurs if and only if the number “1” appears infinitely often. The sub-
sequent results imply that the probability of the lower limit of these Ans equals zero,
while with probability one the they will occur infinitely often.
Let us formulate and prove some easy properties of the lower and upper limit.
2 Note that this n is random, that is, it may depend on the chosen ω ∈Ω.

7.1 Laws of large numbers
౪
335
Proposition 7.1.16. If A1, A2, . . . are subsets of Ω, then
(1)
lim inf
n→∞An ⊆lim sup
n→∞An ,
(2)
(lim sup
n→∞An)
c
= lim inf
n→∞Ac
n
and
(lim inf
n→∞An)
c
= lim sup
n→∞Ac
n .
Proof. We prove these properties in the interpretation of the lower and upper limit
given in Remark 7.1.14.
Suppose that ω ∈lim infn→∞An. Then for some n ≥1 it follows that ω ∈Am,
m ≥n. Of course, then the number of events with ω ∈An is infinite, which implies
ω ∈lim supn→∞An. This proves (1).
Observe that we have ω ∉lim supn→∞An if and only if ω ∈An for only finitely many
n ∈ℕ. Equivalently, there is an n ≥1 such that whenever m ≥n, then ω ∉Am, or, that
ω ∈Ac
m. In other words, this happens if and only if ω ∈lim infn→∞Ac
n. This proves the
left-hand identity in (2). The right-hand one follows by the same arguments. One may
also prove this by applying the left-hand identity with Ac
n.
Before we can formulate the main result in this section, we have to define when an
infinite sequence of events is independent.
Definition 7.1.17. A sequence of events A1, A2, . . . in 𝒜is said to be independent provided that for all
n ≥1 the events A1, . . . , An are independent in the sense of Definition 2.2.12. An equivalent formulation is
a follows: given m ≥1 and indices i1 < i2 < ⋅⋅⋅< im, then this implies
ℙ(Ai1 ∩⋅⋅⋅∩Aim) = ℙ(Ai1) ⋅⋅⋅ℙ(Aim) .
Remark 7.1.18. Using the method for the proof of eq. (7.3), one may deduce the following
“infinite” version of independence. For independent A1, A2, . . . follows that
ℙ(
∞
⋂
n=1
An) =
∞
∏
n=1
ℙ(An) .
Remark 7.1.19. According to Proposition 3.6.9, the independence of random variables
and events are linked as follows. The random variables X1, X2, . . . are independent in
the sense of Definition 4.3.4 if and only if for all Borel sets B1, B2, . . . in ℝthe preimages
X−1
1 (B1), X−1
2 (B2), . . . are independent events as introduced in Definition 7.1.17.
Now we are in the position to state and prove the main result of this section.
Proposition 7.1.20 (Borel–Cantelli lemma). Let (Ω, 𝒜, ℙ) be a probability space and let
An ∈𝒜, n = 1, 2, . . .
1.
If ∑∞
n=1 ℙ(An) < ∞, then
ℙ(lim sup
n→∞An) = 0 .
(7.5)

336
౪
7 Limit theorems
2.
For independent A1, A2, . . ., the following is valid. If ∑∞
n=1 ℙ(An) = ∞, then
ℙ(lim sup
n→∞An) = 1 .
Proof. We start with proving the first assertion. Thus, take arbitrary subsets An ∈𝒜
satisfying ∑∞
n=1 ℙ(An) < ∞. Write
lim sup
n→∞An =
∞
⋂
n=1
Bn
with Bn := ⋃∞
m=n Am. Since B1 ⊇B2 ⊇⋅⋅⋅, property (7) in Proposition 1.2.1 applies and,
together with (5) in the same proposition, leads to
ℙ(lim sup
n→∞An) = lim
n→∞ℙ(Bn) ≤lim inf
n→∞
∞
∑
m=n
ℙ(Am) .
(7.6)
If α1, α2, . . . are nonnegative numbers with ∑∞
n=1 αn < ∞, then it is known that
∑∞
m=n αm →0 as n →∞. Applying this observation to αn = ℙ(An), assertion (7.5) is
a direct consequence of estimate (7.6). Thus, the first part is proven.
To prove the second assertion, we investigate the probability of the complementary
event. Here we have
(lim sup
n→∞An)
c
=
∞
⋃
n=1
∞
⋂
m=n
Ac
m .
An application of (5) in Proposition 1.2.1 implies
ℙ((lim sup
n→∞An)
c
) ≤
∞
∑
n=1
ℙ(
∞
⋂
m=n
Ac
m) .
(7.7)
Fix n ∈ℕand for k ≥n set Bk := ⋂k
m=n Ac
m. Then Bn ⊇Bn+1 ⊇⋅⋅⋅, hence by property (7)
in Proposition 1.2.1 it follows that
ℙ(
∞
⋂
m=n
Ac
m) = ℙ(
∞
⋂
k=n
Bk) = lim
k→∞ℙ(Bk) = lim
k→∞
k
∏
m=n
(1 −ℙ(Am)) .
Here in the last step we used that, due to Proposition 2.2.15, the events Ac
1, Ac
2, . . . are
independent as well. Next we apply the elementary inequality
1 −x ≤e−x ,
0 ≤x ≤1 ,
for x = ℙ(Am) and, because of ∑∞
m=n ℙ(Am) = ∞, we arrive at

7.1 Laws of large numbers
౪
337
ℙ(
∞
⋂
m=n
Ac
m) ≤lim sup
k→∞
exp(−
k
∑
m=n
ℙ(Am)) = 0 .
Plugging this into estimate (7.7) finally yields
ℙ((lim sup
n→∞An)
c
) = 0 ,
hence ℙ(lim sup
n→∞An) = 1,
as asserted.
Remark 7.1.21. The second assertion in Proposition 7.1.20 remains valid under the
weaker condition of pairwise independence. But then the proof becomes more compli-
cated (see Examples 6.4 and 6.5 in [Bil12] or Lemma 11.1 in [Bau96]).
Corollary 7.1.22. Let An ∈𝒜be independent events. Then the following are equivalent:
ℙ(lim sup
n→∞An) = 0
⇔
∞
∑
n=1
ℙ(An) < ∞,
ℙ(lim sup
n→∞An) = 1
⇔
∞
∑
n=1
ℙ(An) = ∞.
Example 7.1.23. Suppose we play a series of independent games where the success
probability in the nth game is pn for some given p1, p2, . . . How likely is it to win in-
finitely many of the games?
Answer: Let the event An occur if one wins game n. By the choice of the pns, it follows
that ℙ(An) = pn. Thus, the Borel–Cantelli lemma asserts that one wins with probability
1 infinitely many games if and only if ∑∞
n=1 pn = ∞. On the other hand, if ∑∞
n=1 pn < ∞,
then with probability 1 one loses all games after a finite random number of games. So,
for example, if pn = 1/n, then with probability 1 one wins infinitely often although the
success probability becomes smaller and smaller. On the contrary, in the case pn = 1/n2
there will be an N ∈ℕso that one loses all games after the Nth one.
Example 7.1.24. Let (Un)n≥1 be a sequence of independent random variables, uniformly
distributed on [0, 1]. Given positive real numbers (αn)n≥1, we define events An by setting
An := {Un ≤αn}. Since the Uns are independent, so are the events An, and Corollary 7.1.22
applies. Because of ℙ(An) = αn, this leads to
ℙ{Un ≤αn i. o.} = {0
if ∑∞
n=1 αn < ∞,
1
if ∑∞
n=1 αn = ∞,
or, equivalently, to
ℙ{Un > αn f. a.} = {0
if ∑∞
n=1 αn = ∞,
1
if ∑∞
n=1 αn < ∞.

338
౪
7 Limit theorems
For example, we have
ℙ{Un ≤1/n i. o.} = 1
and
ℙ{Un ≤1/n2 i. o.} = 0 .
Example 7.1.25. Let (Xn)n≥1 be a sequence of independent 𝒩(0, 1)-distributed random
variables and let cn > 0. What probability does the event to observe {|Xn| ≥cn} infinitely
often possess?
Answer: It holds that
∞
∑
n=1
ℙ{|Xn| ≥cn} =
2
√2π
∞
∑
n=1
∞
∫
cn
e−x2/2 dx =
2
√2π
∞
∑
n=1
φ(cn) ,
where
φ(t) :=
∞
∫
t
e−x2/2 dx ,
t ∈ℝ.
Setting ψ(t) := t−1e−t2/2, t > 0, one obtains
φ′(t) = −e−t2/2
and
ψ′(t) = −(1 + 1
t2 )e−t2/2 ,
hence l’Hôpital’s rule implies
lim
t→∞
φ′(t)
ψ′(t) = 1 ,
thus lim
t→∞
φ(t)
ψ(t) = 1 .
The limit comparison test for infinite series tells us that ∑∞
n=1 φ(cn) < ∞if and only if
∑∞
n=1 ψ(cn) < ∞. Thus, by the definition of ψ, the following are equivalent:
∞
∑
n=1
ℙ{|Xn| ≥cn} < ∞
⇐⇒
∞
∑
n=1
e−c2
n/2
cn
< ∞.
In other words, we have
ℙ{|Xn| ≥cn i. o.} =
{
{
{
{
{
0
if ∑∞
n=1
e−c2n/2
cn
< ∞,
1
if ∑∞
n=1
e−c2n/2
cn
= ∞.
For example, if cn = c√ln n for some c > 0, then
∞
∑
n=1
e−c2
n/2
cn
= 1
c
∞
∑
n=1
1
nc2/2 √ln n
< ∞

7.1 Laws of large numbers
౪
339
if and only if c > √2. In particular, this yields the following interesting fact:
ℙ{|Xn| ≥√2 ln n i. o.} = 1 ,
while for each c > 2,
ℙ{|Xn| ≥√c ln n i. o.} = 0 .
From this, we derive
ℙ{ω ∈Ω : lim sup
n→∞
|Xn(ω)|
√ln n
= √2} = 1 .
Example 7.1.26. In a lottery, 6 of 49 numbers are randomly chosen. Find the probability
to have infinitely often the six chosen numbers on your lottery ticket.
Answer: Let An be the event to have in the nth drawing the six chosen numbers on
the ticket. We saw (see Example 1.4.3) that
ℙ(An) =
1
(49
6 ) := δ > 0 .
Consequently, it follows that ∑∞
n=1 ℙ(An) = ∞and, since the Ans are independent, Propo-
sition 7.1.20 implies
ℙ{The Ans occur i. o.} = 1 .
Therefore, the event to win infinitely often has probability 1. One does only not play long
enough!
Remark 7.1.27. Corollary 7.1.22 shows in particular that for independent Ans either
ℙ(lim sup
n→∞An) = 0
or
ℙ(lim sup
n→∞An) = 1 .
Because of Proposition 7.1.16, the same is valid for the lower limit. Here the so-called
0–1 laws operate, which, roughly speaking, assert the following. Whenever the occur-
rence or nonoccurrence of an event is independent of the first finitely many results,
then such events occur either with probability 0 or 1. For example, the occurrence or
nonoccurrence of the lower or upper limit is completely independent of what had hap-
pened during the first n results, n ≥1.
Summary: Let A1, A2, . . . be a sequence of events in a probability space (Ω, 𝒜, ℙ). A basic question in Prob-
ability Theory is how likely the occurrence of infinitely many of the events An is. This question is answered by
the Borel–Cantelli Lemma. It asserts
∞
∑
n=1
ℙ(An) < ∞
⇒
ℙ{The Ans occur i. o.} = 0 .

340
౪
7 Limit theorems
Conversely, if the Ans are independent events, then it follows that
∞
∑
n=1
ℙ(An) = ∞
⇒
ℙ{The Ans occur i. o.} = 1 .
In particular, if the events A1, A2, . . . are independent, then the Ans occur infinitely often either with probability
0 or 1.
7.1.4 Weak law of large numbers
Given random variables X1, X2, . . ., let
Sn := X1 + ⋅⋅⋅+ Xn
(7.8)
be the sum of the first n values. One of the most important questions in Probability
Theory is that about the behavior of Sn as n →∞. Suppose we play a series of games
and Xj denotes the loss or the gain in game j ≥1. Then Sn is nothing else than the total
loss or gain after n games. Also recall the random walk presented in Example 4.1.7. Set
Xj = −1 if in step j the particle jumps to the left, and Xj = 1 otherwise. Then Sn is the
point in ℤwhere the particle is located after n jumps.
Let us come back to the general case. We are given arbitrary independent and iden-
tically distributed random variables X1, X2, . . . Recall that “identically distributed” says
that they all possess the same probability distribution. Set Sn = X1 + ⋅⋅⋅+ Xn. The first re-
sult gives some information about the behavior of the arithmetic mean Sn/n as n →∞.
Proposition 7.1.28 (Weak law of large numbers). Let X1, X2, . . . be independent identically
distributed random variables with (common) expected value μ ∈ℝ. If ε > 0, then it follows
that
lim
n→∞ℙ{
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
Sn
n −μ
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
≥ε} = 0 .
Proof. We prove the result only with an additional condition, namely that X1 and hence
all Xj possess a finite second moment. The result remains true without this condition,
but then its proof becomes significantly more complicated.
From (3) in Proposition 5.1.38, we derive
𝔼(Sn
n ) = 𝔼Sn
n
= 𝔼(X1 + ⋅⋅⋅+ Xn)
n
= 𝔼X1 + ⋅⋅⋅+ 𝔼Xn
n
= nμ
n = μ .
Furthermore, by the independence of the Xjs, property (iv) in Proposition 5.2.15 also
gives
𝕍(Sn
n ) = 𝕍Sn
n2
= 𝕍X1 + ⋅⋅⋅+ 𝕍Xn
n2
= 𝕍X1
n
.

7.1 Laws of large numbers
౪
341
Consequently, inequality (7.2) implies
ℙ{
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
Sn
n −μ
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
≥ε} ≤𝕍(Sn/n)
ε2
= 𝕍X1
nε2 ,
and the desired assertion follows from
lim sup
n→∞ℙ{
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
Sn
n −μ
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
≥ε} ≤lim
n→∞
𝕍X1
nε2 = 0 .
Remark 7.1.29. The type of convergence appearing in Proposition 7.1.28 is usually called
convergence in probability. More precisely, given random variables Y1, Y2, . . ., they
converge in probability to some random variable Y provided that for each ε > 0,
lim
n→∞ℙ{|Yn −Y| ≥ε} = 0 .
Hence, in this language the weak law of large numbers asserts that Sn/n converges in
probability to a random variable Y, which is the constant μ.
Interpretation of Proposition 7.1.28. Fix ε > 0 and define events An, n ≥1, by
An := {ω ∈Ω :
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
Sn(ω)
n
−μ
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
< ε} .
Then Proposition 7.1.28 implies limn→∞ℙ(An) = 1. Hence, given δ > 0, there is an
n0 = n0(ε, δ) such that ℙ(An) ≥1 −δ whenever n ≥n0. In other words, if n is suffi-
ciently large, then with high probability (recall, μ is the expected value of the Xjs)
μ −ε ≤1
n
n
∑
j=1
Xj ≤μ + ε .
This confirms once more the interpretation of the expected value as (approximate) arith-
metic mean of the observed values, provided that we execute the same experiment ar-
bitrarily often and the results do not depend on each other.
7.1.5 Strong law of large numbers
Proposition 7.1.28 does not imply Sn/n →μ in the usual sense. It only asserts the conver-
gence of Sn/n in probability, which, in general, does not imply pointwise convergence.
The following theorem due to A. N. Kolmogorov shows that, nevertheless, a strong type
of convergence takes place. The proof of this result is much more complicated than that
of Proposition 7.1.28. Therefore, we cannot present it in the scope of this book, and we
refer to [Dur19, Section 2.4] or [Ros06, Chapter 5] for a proof.

342
౪
7 Limit theorems
Proposition 7.1.30 (Strong law of large numbers). Let X1, X2, . . . be a sequence of indepen-
dent identically distributed random variables with expected value μ = 𝔼X1. If Sn is defined
by eq. (7.8), then
ℙ{ω ∈Ω : lim
n→∞
Sn(ω)
n
= μ} = 1 .
Remark 7.1.31. Given random variables Y1, Y2, . . . and Y, one says that the Yns converge
to Y almost surely, if
ℙ{ lim
n→∞Yn = Y} = ℙ{ω ∈Ω : lim
n→∞Yn(ω) = Y(ω)} = 1 .
Thus, Proposition 7.1.30 asserts that Sn/n converges almost surely to a random vari-
able Y, which is a constant μ.
Remark 7.1.32. Proposition 7.1.30 allows the following interpretation. There exists a
subset Ω0 in the sample space Ω with ℙ(Ω0) = 1 such that for all ω ∈Ω0 and all ε > 0,
there is an n0 = n0(ε, ω) with
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
Sn(ω)
n
−μ
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
< ε
whenever n ≥n0.
In other words, with probability one the following happens: given ε > 0, there is
a certain n0 depending on ω, hence random, such that for n ≥n0 the arithmetic mean
Sn/n is in an ε-neighborhood of μ and never leaves it again.
Let us emphasize once more that Sn/n is random, hence Sn/n may attain different
values for a different series of experiments. Nevertheless, starting from a certain point,
which may be different for different experiments, the arithmetic mean of the first n
results will be in (μ −ε, μ + ε).
When we introduced probability measures in Section 1.1.3, we claimed that the num-
ber ℙ(A) may be regarded as the limit of the relative frequencies of the occurrence of
the event A. As the first consequence of Proposition 7.1.30, we show that this is indeed
true.
Proposition 7.1.33. Suppose a random experiment is described by a probability space
(Ω, 𝒜, ℙ). Execute this experiment arbitrarily often. Given an event A ∈𝒜, let rn(A) be
the relative frequency of A in n trials as defined in eq. (1.1). Then almost surely
lim
n→∞rn(A) = ℙ(A) .
Proof. Define random variables X1, X2, . . . as follows. Set Xj = 1 if A occurs in trial j,
while Xj = 0 otherwise. Since the experiments are executed independently of each other,

7.1 Laws of large numbers
౪
343
the Xjs are independent as well. Moreover, we execute every time exactly the same ex-
periment, hence the Xjs are also identically distributed.
By the definition of the Xjs,
Sn
n = rn(A) .
Thus, it remains to evaluate μ = 𝔼Xj. To this end observe that the Xjs are B1,p-distributed
with success probability p = ℙ(A). Recall that Xj = 1 if and only if A occurs in experi-
ment j, and since the experiment is described by (Ω, 𝒜, ℙ), the probability for Xj being 1
is ℙ(A). Consequently, 𝔼Xj = ℙ(A).
Proposition 7.1.30 now implies that almost surely
lim
n→∞rn(A) = lim
n→∞
Sn
n = 𝔼X1 = ℙ(A) .
This completes the proof.
What happens in the case when the Xjs do not possess an expected value? Does
then Sn/n converge nevertheless? If this is so, could we take this limit as a “generalized”
expected value? The next proposition shows that such an approach does not work. For
a proof, see [Dur19, Theorem 2.4.5]; see also [Eri73] for further reading.
Proposition 7.1.34. Let X1, X2, . . . be independent and identically distributed with
𝔼|X1| = ∞. Then it follows that
ℙ{ω ∈Ω : Sn(ω)
n
diverges} = 1 .
For example, if we take an independent sequence (Xj)j≥1 of Cauchy distributed ran-
dom variables, then their arithmetic means Sn/n will diverge almost surely.
Remark 7.1.35. Why does one need a weak law of large numbers when there ex-
ists a strong one? This question is justified and, in fact, in the situation described in
this book the weak law is a consequence of the strong one, thus, it is not necessarily
needed.
The situation is different if one investigates independent, but not necessarily iden-
tically distributed, random variables. Then there are sequences X1, X2, . . . satisfying the
weak law but not the strong one.3
Let us state two applications of Proposition 7.1.30, one taken from Numerical Math-
ematics, the other from Number Theory.
3 In the case of nonidentically distributed Xjs, one investigates if 1
n ∑n
j=1(Xj −𝔼Xj) converges to zero
either in probability (weak law) or almost surely (strong law).

344
౪
7 Limit theorems
Example 7.1.36 (Monte Carlo method for integrals). Suppose we are given a quite “com-
plicated” function f : [0, 1]n →ℝ. The task is to find the numerical value of
∫
[0,1]n
f (x) dx =
1
∫
0
. . .
1
∫
0
f (x1, . . . , xn) dxn ⋅⋅⋅dx1 .
For large n, this can be a highly nontrivial problem. One way to overcome this difficulty
is to use a probabilistic approach that is based on the strong law of large numbers.
To this end, choose an independent sequence
⃗U1, ⃗U2, . . . of random vectors uni-
formly distributed on [0, 1]n. For example, such a sequence can be constructed as fol-
lows. Take independent U1, U2, . . . uniformly distributed on4 [0, 1] and build random
vectors by
⃗U1 = (U1, . . . , Un),
⃗U2 = (Un+1, . . . , U2n), and so on.
Proposition 7.1.37. As above, let ⃗U1, ⃗U2, . . . be independent random vectors uniformly dis-
tributed on [0, 1]n. Given an integrable function f : [0, 1]n →ℝ, with probability one,
lim
N→∞
1
N
N
∑
j=1
f ( ⃗Uj) = ∫
[0,1]n
f (x) dx .
Proof. Set Xj := f ( ⃗Uj), j = 1, 2, . . . By construction, the Xjs are independent and iden-
tically distributed random variables. Proposition 3.6.20 implies (compare also with
Example 3.6.23) that the distribution densities of the random vectors
⃗Uj are given
by
p(x) = {1
if x ∈[0, 1]n,
0
if x ∉[0, 1]n.
As already mentioned in Remark 5.3.5, formula (5.42), stated for a function of two vari-
ables, also holds for functions of n variables, n ≥1 arbitrary. This implies
𝔼X1 = 𝔼f ( ⃗U1) = ∫
ℝn
f (x) p(x) dx = ∫
[0,1]n
f (x) dx .
Thus, Proposition 7.1.30 applies and leads to
ℙ{ lim
N→∞
1
N
N
∑
j=1
f ( ⃗Uj) = ∫
[0,1]n
f (x) dx} = ℙ{ lim
N→∞
1
N
N
∑
j=1
Xj = 𝔼X1} = 1,
as asserted.
4 Use the methods developed in Section 4.4 to construct such Ujs.

7.1 Laws of large numbers
౪
345
Remark 7.1.38. The numerical application of the preceding proposition is as follows.
Choose independent numbers u(j)
i , 1 ≤i ≤n, 1 ≤j ≤N, uniformly distributed on [0, 1]
and set
RN(f ) := 1
N
N
∑
j=1
f (u(j)
1 , . . . , u(j)
n ) .
Proposition 7.1.37 asserts that RN(f ) converges almost surely to ∫[0,1]n f (x) dx. Thus,
if N ≥1 is large, then RN(f ) may be taken as approximate value for ∫[0,1]n f (x) dx.
If we apply Proposition 7.1.37 to the indicator function of a Borel set B ⊆[0, 1]n, that
is, we choose f = 1B with 1B as in Definition 3.6.16, then with probability 1 it follows that
voln(B) = ∫
[0,1]n
1B(x) dx = lim
N→∞
1
N
N
∑
j=1
1B( ⃗Uj) = lim
N→∞
|{j ≤N :
⃗Uj ∈B}|
N
.
This provides us with a method to determine the volume voln(B), even for quite “com-
plicated” Borel sets B ⊆ℝn.
Example 7.1.39. A way to approximate π/4 by the described method is as follows: draw
a quadrant Q of a circle with radius 1 inside a square S of side length 1. Next choose
independently points u1, u2, . . . , un uniformly distributed in [0, 1]2. Then, as n →∞,
|{j ≤n : uj ∈Q}|
|{j ≤n; uj ∈S}|
converges to vol2(Q)/vol2(S) = π/4. See Fig. 7.1.
Figure 7.1: As n →∞, he proportion of the randomly chosen points inside the quadrant Q converges to
π/4. In the above figure, there are 26 of the 32 points inside Q. This gives 0.8125 as an approximation of
π/4 ≈0.7854.
Example 7.1.40 (Normal numbers). As we saw in Section 4.3.1, each x ∈[0, 1) admits a
representation as binary fraction x = 0.x1x2 . . . with xj ∈{0, 1}. Take some fixed x ∈[0, 1)

346
౪
7 Limit theorems
with binary representation x = 0.x1x2 . . . Then one may ask whether in the binary rep-
resentation of x one of the numbers 0 or 1 occurs more frequently than the other. Or do
both numbers possess the same frequency, at least on average?
To investigate this question, for n ∈ℕset
a0
n(x) := 󵄨󵄨󵄨󵄨{k ≤n : xk = 0}󵄨󵄨󵄨󵄨
and
a1
n(x) := 󵄨󵄨󵄨󵄨{k ≤n : xk = 1}󵄨󵄨󵄨󵄨,
x = 0.x1x2 . . .
Thus, a0
n(x) is the frequency of the number 0 among the first n positions in the represen-
tation of x.
Definition 7.1.41. An x ∈[0, 1) is said to be normal (with respect to base 2) if
lim
n→∞
a0
n(x)
n
= lim
n→∞
a1
n(x)
n
= 1
2 .
In other words, a number x ∈[0, 1) is normal with respect to base 2 if, on average, in its
binary representation the frequency of 0, and hence also of 1, equals 1/2. Are there many
normal numbers as, for example, x = 0.0101010 . . ., or are there maybe only a few? The
next proposition gives the answer.
Proposition 7.1.42. Let ℙbe the uniform distribution on [0, 1]. Then there is a subset
M ⊆[0, 1) with ℙ(M) = 1 such that all x ∈M are normal with respect to base 2.
Proof. Define random variables Xk : [0, 1) →ℝ, k = 0, 1, . . . , by Xk(x) := xk whenever
x = 0.x1x2 . . . Proposition 4.3.3 tells us that the Xks are independent with ℙ{Xk = 0} = 1/2
and ℙ{Xk = 1} = 1/2. Recall that the underlying probability measure ℙon [0, 1] is the
uniform distribution. By the definition of the Xks it follows that
Sn(x) := X1(x) + ⋅⋅⋅+ Xn(x) = 󵄨󵄨󵄨󵄨{k ≤n : Xk(x) = 1}󵄨󵄨󵄨󵄨= a1
n(x) .
Since 𝔼X1 = 1/2, Proposition 7.1.30 implies the existence of a subset M ⊆[0, 1) with
ℙ(M) = 1 such that for x ∈M it follows that
lim
n→∞
a1
n(x)
n
= lim
n→∞
Sn(x)
n
= 𝔼X1 = 1
2 .
Since a0
n(x) = n −a1
n(x), this completes the proof.
Remark 7.1.43. The previous considerations do not depend on the fact that the base
of the representation was 2. It extends easily to representations with respect to any
base b ≥2. Here, the definition of normal numbers has to be extended slightly. Fix
b ≥2. Each x ∈[0, 1) admits the representation x = 0.x1x2 . . . where xj ∈{0, . . . , b −1}
provided that x = ∑∞
k=1
xk
bk . To make this representation unique, we do not allow rep-
resentations x = 0.x1x2 . . . where for some k0 ∈ℕwe have xk = b −1 whenever
k ≥k0.

7.2 Central limit theorem
౪
347
Then a number x is said to be normal with respect to the base b ≥2 if for all
ℓ= 0, . . . , b −1,
lim
n→∞
|{j ≤n : xj = ℓ}|
n
= 1
b ,
x = 0.x1x2 . . .
Similar methods as used in the proof of Proposition 7.1.42 show that there is a set
Mb ⊆[0, 1] with ℙ(Mb) = 1 such that all x ∈Mb are normal with respect to base b.
Letting M = ⋂∞
b=2 Mb, then property (5) (Boole’s inequality) in Proposition 1.2.1 easily
gives ℙ(M) = 1. Numbers x ∈M are completely normal, which says that they are
normal for any base b ≥2. Again we see that with respect to the uniform distribution
on [0, 1] almost all numbers are completely normal.
Summary: Laws of large numbers are among the most important assertions in Probability Theory.5 Verbally
said, these laws assert the following: if x1, x2, . . . are the random results of identical experiments, obtained
independently of each other, then the sequence of arithmetic means (x1 + ⋅⋅⋅+ xn)/n converges in a weak,
as well as in a strong sense, to the expected value of the xjs, provided the expected value exists.
In particular, these laws justify regarding the probability ℙ(A) of an event A as the limit of the relative
frequencies rn(A) of its occurrence, as we claimed in Section 1.1.3. We emphasize once more, the arithmetic
mean, as well as the relative frequency, is random, thus may be different in different trials, but the expected
value and ℙ(A) are both fixed nonrandom real numbers.
7.2 Central limit theorem
Why does the normal distribution play such an important role in Probability Theory and
why are so many observed random phenomena normally distributed? The reason for
this is the central limit theorem, which we are going to present in this section.
Consider a sequence of independent and identically distributed random variables
(Xj)j≥1 with finite second moment. As in eq. (7.8), let Sn be the sum of X1, . . . , Xn. For exam-
ple, if Xj is the loss or gain in the jth game, then Sn is the total loss or gain after n games.
Which probability distribution does Sn possess? Theoretically, this can be evaluated by
the convolution formulas stated in Section 4.5. But practically, this is mostly impossible;
imagine, we want to determine the distribution of the sum of 100 rolls with a fair die.
Therefore, one is very interested in asymptotic statements about the distribution of Sn.
To get a clue about possible asymptotic distributions of Sn, take independent
B1,p-distributed Xjs. In this case, the distribution of Sn is known to be Bn,p.
For example, if p = 0.4 and n = 30, then ℙ{Sn = k} = Bn,p({k}), k = 0, . . . , 30, may be
described in Fig. 7.2.
5 Sometimes it is said that the strong law of large numbers is one of the three pearls in Probability
Theory. The two other are the central limit theorem and the so-called law of iterated logarithm, shortly
discussed in Remark 7.2.16.

348
౪
7 Limit theorems
Figure 7.2: Probability mass function of Bn,p, n = 30 and p = 0.4.
The peak of the diagram occurs at k = 12, which is the expected value of S30. Enlarg-
ing the number of trials leads to a shift of the peak to the right. At the same time, the
height of the peak becomes smaller.
The shape of the diagram in Fig. 7.2 lets us suggest that sums of independent, identi-
cally distributed random variables are “almost” normally distributed. If this is so, which
expected value and which variance will the approximating normal distribution possess?
Let us investigate this question in the general setting. Thus, we are given a sequence
(Xj)j≥1 of independent identically distributed random variables with finite second mo-
ment and with μ = 𝔼X1 and σ2 = 𝕍X1 > 0. If, as before, Sn = X1 + ⋅⋅⋅+ Xn, then
𝔼Sn = nμ
and
𝕍Sn = nσ2 .
Consequently, if we conjecture that Sn is “approximately” normally distributed, then the
normalized sum (Sn −nμ)/σ√n should be “approximately” 𝒩(0, 1)-distributed. Recall
that Propositions 5.1.38 and 5.2.15 imply
𝔼(Sn −nμ
σ√n ) = 0
and
𝕍(Sn −nμ
σ√n ) = 1 .
The question about the possible limit of the normalized sums (Sn −nμ)/σ√n remained
open for long time. In 1718 Abraham de Moivre investigated the limit behavior for a spe-
cial case of binomial distributed random variables. As limit he found some infinite se-
ries, not a concrete function. In 1808 the American scientist and mathematician Robert
Adrain published a paper where for the first time the normal distribution occurred.
A year later, independently of the former work, Carl Friedrich Gauß used the normal dis-
tribution for error estimates. In 1812 Pierre-Simon Laplace proved that the normalized
sums of independent binomial distributed random variables approximate the normal
distribution. Later on, Andrei Andreyevich Markov, Aleksandr Mikhailovich Lyapunov,

7.2 Central limit theorem
౪
349
Jarl Waldemar Lindeberg, Paul Lévy, and other mathematicians continued the work of
De Moivre and Laplace. In particular, they showed that the normal distribution occurs
always as a limit, not only for binomial distributed random variables. The only assump-
tion is that the random variables possess a finite second moment. We refer to the very
interesting book [Fis11] for further reading about the history of normal approximation.
It remains the question in which sense does (Sn −nμ)/σ√n converge to the standard
normal distribution. To answer this, we have to introduce the concept of the convergence
in distribution.
Definition 7.2.1. Let Y1, Y2, . . . and Y be random variables with distribution functions F1, F2, . . . and F, re-
spectively. The sequence (Yn)n≥1 converges to Y in distribution provided that
lim
n→∞Fn(t) = F(t)
for all t ∈ℝ
at which F is continuous.
(7.9)
In this case, one writes Yn
𝒟
󳨀→Y .
Remark 7.2.2. An alternative way to formulate property (7.9) is as follows:
lim
n→∞ℙ{Yn ≤t} = ℙ{Y ≤t}
for all t ∈ℝwith ℙ{Y = t} = 0 .
Without proof, we state two other characterizations of convergence in distribution.
Proposition 7.2.3. One has Yn
𝒟
󳨀→Y if and only if for all bounded continuous functions
f : ℝ→ℝ,
lim
n→∞𝔼f (Yn) = 𝔼f (Y) .
Furthermore, this is also equivalent to
lim sup
n→∞ℙ{Yn ∈A} ≤ℙ{Y ∈A}
for all closed subsets A ⊆ℝ, or also to
lim inf
n→∞ℙ{Yn ∈G} ≥ℙ{Y ∈G}
whenever G ⊆ℝis an open set.
Remark 7.2.4. Note that in general Yn
𝒟
󳨀→Y does not imply
lim
n→∞ℙ{Yn ∈B} = ℙ{Y ∈B}
for all Borel sets B ⊆ℝ. For example, if ℙ{Yn = 1/n} = 1 and ℙ{Y = 0} = 1, then the
Yns converge to Y in distribution (check this), but if B = (0, 1), then ℙ{Yn ∈B} does not
converge to ℙ{Y ∈B}.

350
౪
7 Limit theorems
If the distribution function of Y is continuous, that is, we have ℙ{Y = t} = 0 for all
t ∈ℝ, then Yn
𝒟
󳨀→Y is equivalent to limn→∞Fn(t) = F(t) for all t ∈ℝ. Besides, in this
case, the type of convergence is stronger as the next proposition shows.
Proposition 7.2.5. Let Y1, Y2, . . . and Y be random variables with ℙ{Y = t} = 0 for all
t ∈ℝ. Then Yn
𝒟
󳨀→Y implies that the distribution functions converge uniformly:
lim
n→∞sup
t∈ℝ
󵄨󵄨󵄨󵄨ℙ{Yn ≤t} −ℙ{Y ≤t}󵄨󵄨󵄨󵄨= 0 ,
hence also
lim
n→∞sup
a<b
󵄨󵄨󵄨󵄨ℙ{a ≤Yn ≤b} −ℙ{a ≤Y ≤b}󵄨󵄨󵄨󵄨= 0 .
We have now all notations and definitions that are necessary to formulate the cen-
tral limit theorem. Mostly, this theorem is proved via properties of the so-called charac-
teristic functions (see Chapter 3 of [Dur19] for such a proof). For alternative proofs using
properties of moment generating functions, we refer to [Rss14] and [Gha19].
Proposition 7.2.6 (Central limit theorem). Let (Xj)j≥1 be a sequence of independent identi-
cally distributed random variables with finite second moment. Let μ be the expected value
of the Xjs and let σ2 > 0 be their variance. Then for the sums Sn = X1+⋅⋅⋅+Xn it follows that
Sn −nμ
σ√n
𝒟
󳨀→Z .
(7.10)
Here Z is an 𝒩(0, 1)-distributed random variable.
Since the limit Z in statement (7.10) is a continuous random variable, Proposi-
tion 7.2.5 applies, and the central limit theorem may also be formulated as follows.
Proposition 7.2.7. Suppose (Xj)j≥1 and Sn are as in Proposition 7.2.6. Then it follows that
lim
n→∞sup
t∈ℝ
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
ℙ{Sn −nμ
σ√n
≤t} −
1
√2π
t
∫
−∞
e−x2/2 dx
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
= 0
and
(7.11)
lim
n→∞sup
a<b
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
ℙ{a ≤Sn −nμ
σ√n
≤b} −
1
√2π
b
∫
a
e−x2/2 dx
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
= 0 .
(7.12)
Remark 7.2.8. Recall that Φ denotes the distribution function of the standard normal
distribution as introduced in eq. (1.70). Thus, another way to write eq. (7.11) is as follows:
if Fn(t) = ℙ{Sn ≤t} denotes the distribution function of Sn, then
sup
t∈ℝ
󵄨󵄨󵄨󵄨Fn(σ√n t + nμ) −Φ(t)󵄨󵄨󵄨󵄨= sup
t∈ℝ
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
ℙ{Sn −nμ
σ√n
≤t} −Φ(t)
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
󳨀→
n→∞0 .
(7.13)
Example 7.2.9. Suppose X1, X2, . . . are independent Pois1-distributed. Hence, their sum
Sn = X1 + ⋅⋅⋅+ Xn is a Poisn-distributed random variable, and

7.2 Central limit theorem
౪
351
Fn(t) = ℙ{Sn ≤t} = ∑
0≤k≤t
nk
k! e−n .
Since μ = σ = λ = 1, eq. (7.13) tells us that (compare Figure 7.3)
Fn(√n t + n) =
∑
0≤k≤√n t+n
nk
k! e−n 󳨀→
n→∞Φ(t) .
(7.14)
Moreover, the convergence takes place uniformly in t ∈ℝ.
Figure 7.3: The approximation of Φ(t) in eq. (7.14) with n = 30.
Our next objective is another reformulation of eq. (7.12). If we set a′ = a σ√n + nμ
and b′ = b σ√n + nμ, then these numbers depend on n ∈ℕ. But since the convergence
in eq. (7.12) is uniform, we may replace a and b by a′ and b′, respectively and obtain
lim
n→∞sup
a′<b′
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
ℙ{a′ ≤Sn ≤b′} −ℙ{a′ −nμ
σ√n
≤Z ≤b′ −nμ
σ√n }
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
= 0 .
(7.15)
Here, as before, Z denotes a standard normally distributed random variable. For a final
reformulation, set
Zn := σ√n Z + nμ .
Then eq. (7.15) is equivalent to
lim
n→∞sup
a′<b′
󵄨󵄨󵄨󵄨ℙ{a′ ≤Sn ≤b′} −ℙ{a′ ≤Zn ≤b′}󵄨󵄨󵄨󵄨= 0 .
(7.16)
By Proposition 4.2.3, the random variables Zn are 𝒩(nμ, nσ2)-distributed, which allows
us to interpret eq. (7.15), or eq. (7.16), as follows. If μ = 𝔼Xj and σ2 = 𝕍Xj, then for large n,
the sum Sn is “approximately” 𝒩(nμ, nσ2)-distributed.

352
౪
7 Limit theorems
In other words, for −∞≤a < b ≤∞it follows that
ℙ{a ≤Sn ≤b} ≈Φ(b −nμ
σ√n ) −Φ(a −nμ
σ√n ) .
Interpretation: We emphasize once more that the central limit theorem is valid for all
sequences of independent identically distributed random variables possessing a second
moment. For example, it is true for Xjs that are binomial distributed, for Xjs being expo-
nentially distributed, and so on. Thus, no matter how the random variables with second
moment are distributed, all their normalized sums possess the same limit, the normal
distribution. This explains the outstanding role of the normal distribution.
The deeper reason for this phenomenon is that Sn may be viewed as the superpo-
sition of many “small” independent errors or perturbations, all of the same kind.6 Al-
though each perturbation is distributed according to ℙX1, the independent superposition
of the perturbations leads to the fact that the final result is approximately normally dis-
tributed. This explains why so many random phenomena may be described by normally
distributed random variables.
Remark 7.2.10 (Continuity correction). A slight technical problem arises in the case of
discrete random variables Xj. Then the Sns are discrete as well, hence their distribution
functions Fn have jumps. If these noncontinuous functions Fn approximate the continu-
ous function Φ, then certain errors occur at the points where the jumps of Fn are (com-
pare Figure 7.4).
Figure 7.4: A sequence of noncontinuous functions (here a sequence of distribution functions of binomial
random variables) approximates the continuous function Φ.
6 The central limit theorem also holds for not necessarily identically distributed random variables pro-
vided that all “errors” become uniformly small. That is, one has to exclude that certain errors are domi-
nating the others.

7.2 Central limit theorem
౪
353
To understand the problem, assume that the Xjs possess values in ℤ, then Sn is also
ℤ-valued, hence for any 0 ≤h < 1, and all integers k < ℓ, it follows that (see Figure 7.5)
ℙ{k ≤Sn ≤ℓ} = ℙ{k −h ≤Sn ≤ℓ+ h} .
Figure 7.5: If Sn has values in ℤ, then for any 0 ≤h < 1 one has k ≤Sn ≤ℓif and only if k −h ≤Sn ≤ℓ+ h.
Thus, both events possess the same probability.
Consequently, for each such number h, the value
Φ(ℓ+ h −nμ
σ√n
) −Φ(k −h −nμ
σ√n
)
may be taken as normal approximation of the above probability. Which number h < 1
should be chosen?
To answer this question, observe the following. If k < m < ℓ, then
ℙ{k ≤Sn ≤ℓ} = ℙ{k ≤Sn ≤m} + ℙ{m + 1 ≤Sn ≤ℓ} ,
which, after choosing h in [0, 1), is approximated by
Φ(ℓ+ h −nμ
σ√n
) −Φ(m + 1 −h −nμ
σ√n
) + Φ(m + h −nμ
σ√n
) −Φ(k −h −nμ
σ√n
) .
Thus, in order to get neither an overlap nor a gap between m + 1 −h −nμ and m + h −nμ,
it is customary to choose h = 0.5. This leads to the following definition.
Definition 7.2.11. Suppose X1, X2, . . . are independent identically distributed with values in ℤ. Then the
corrected normal approximation is given by
ℙ{k ≤Sn ≤ℓ} ≈Φ(ℓ+ 0.5 −nμ
σ√n
) −Φ(k −0.5 −nμ
σ√n
) .
It is called the continuity correction or histogram correction for the normal approximation. In a similar
way, one corrects the approximation for infinite intervals by
ℙ{Sn ≤ℓ} ≈Φ(ℓ+ 0.5 −nμ
σ√n
)
and by
ℙ{Sn ≥k} ≈1 −Φ(k −0.5 −nμ
σ√n
) = Φ(nμ −k + 0.5
σ√n
) .
(7.17)

354
౪
7 Limit theorems
The next result tells us that the continuity correction is only needed for small values of
n ≥1.
Proposition 7.2.12. For all x ∈ℝand h ∈ℝ, it follows that
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
Φ(x + h −nμ
σ√n
) −Φ(x −nμ
σ√n )
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
≤
|h|
σ√2πn
.
Proof. The mean value theorem of Calculus implies the existence of an intermediate
value ξ in ( x−|h|−nμ
σ√n
, x+|h|−nμ
σ√n
) such that
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
Φ(x + h −nμ
σ√n
) −Φ(x −nμ
σ√n )
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
= |h| Φ′(ξ)
σ√n .
Using
Φ′(ξ) =
1
√2π
e−ξ2/2 ≤
1
√2π
,
this proves the asserted estimate.
Remark 7.2.13. An application of Proposition 7.2.12 with x = k and/or x = ℓ, and with
h = ±0.5, shows that the improvement by the continuity correction is at most of order
n−1/2. Thus, it is no longer needed for large n.
Example 7.2.14. Roll a fair die n times. Let Sn be the sum of the n rolls. In view of
eq. (7.16), this sum Sn is approximately 𝒩( 7n
2 , 35n
12 )-distributed. In other words, it follows
that
lim
n→∞ℙ{a ≤Sn −7n/2
√35n/12
≤b} =
1
√2π
b
∫
a
e−x2/2 dx = Φ(b) −Φ(a) .
Moreover, this convergence takes place uniformly for all a < b. Therefore, at least for
large n, the right-hand side of the last equation may be taken as an approximate value
of the left-hand one.
At first, we consider an example with a small number of trials. We roll a die three
times and ask for the probability of the event {7 ≤S3 ≤8}. Let us compare the exact
value
ℙ{7 ≤S3 ≤8} = 1
6 = 0.1 ̄6
with that we get by applying the central limit theorem. Without continuity correction,
the approximate value is
Φ( 8 −21/2
√3 ⋅35/12
) −Φ( 7 −21/2
√3 ⋅35/12
) ≈0.08065 ,

7.2 Central limit theorem
౪
355
while an application of the continuity correction leads to
Φ(8 + 0.5 −21/2
√3 ⋅35/12
) −Φ(7 −0.5 −21/2
√3 ⋅35/12
) ≈0.16133 .
We see an improvement using the continuity correction.
Next we treat an example with large n. Let us investigate once more Example 7.1.6,
but this time from the point of view of the central limit theorem. Choose again n = 103,
a = −100 √12
√35000, and b = 100 √12
√35000. Then it follows that
ℙ{3400 ≤Sn ≤3600} ≈
1
√2π
b
∫
a
e−x2/2 dx ≈0.93592 .
As we see, the use of the central limit theorem improves considerably the bound 0.709
obtained by Chebyshev’s inequality.
Example 7.2.15. The aim of this example is to apply the central limit theorem for the
investigation of the asymptotic behavior of random walks as they were introduced in
Example 4.1.7 and Section 5.5. Recall that we suppose S0 = 0 and, if n ≥1, then Sn =
X1+⋅⋅⋅+Xn, where the Xis are independent and attain the values −1 and 1 with probability
1 −p and p, respectively. In eqs. (5.26) and (5.37), we got
𝔼Sn = n(2p −1)
and
𝕍Sn = 4np(1 −p) .
Consequently, the central limit theorem leads in this case to the following: for all real
numbers a < b, we have
lim
n→∞ℙ{a ≤Sn −n(2p −1)
2√np(1 −p)
≤b} = Φ(b) −Φ(a) .
In the case of a symmetric walk, that is, p = 1/2, this simplifies to
lim
n→∞ℙ{a ≤Sn
√n ≤b} = Φ(b) −Φ(a) =
1
√2π
b
∫
a
e−x2/2 dx .
For instance, if a = −2 and b = 2, then it follows that
lim
n→∞ℙ{−2√n ≤Sn ≤2√n} =
1
√2π
2
∫
−2
e−x2/2 dx ≈0.954 .
Keep in mind that the possible values of Sn are between −n and n. But in reality, if n is
large enough, then with probability greater than 0.95, the value of Sn will be in the much
smaller interval [−2√n, 2√n] (see Figure 7.6 for a graphically presentation of this fact).

356
౪
7 Limit theorems
Figure 7.6: Two independent symmetric random walks compared with t 󳨃→±2 √t.
On the other hand, if we ask for the probability that Sn is between −√n and √n, we
obtain
lim
n→∞ℙ{−√n ≤Sn ≤√n} =
1
√2π
1
∫
−1
e−x2/2 dx ≈0.6827 .
Maybe more impressive than the previous statements is the following fact: for any c > 0,
it holds that
lim
n→∞ℙ{Sn ≥c√n} = 1 −Φ(c) =
1
√2π
∞
∫
c
e−t2/2dt .
Remark 7.2.16. More precise statements about the asymptotic behavior of symmetric
random walks are available. For example, the central limit theorem implies
ℙ{lim sup
n→∞
Sn
√n ≥c} > 0
(7.18)
for any c > 0. A zero–one law tells us that the probability in (7.18) is not only positive,
but equals 1. This leads to
ℙ{lim sup
n→∞
Sn
√n = ∞} = 1
and
ℙ{lim inf
n→∞
Sn
√n = −∞} = 1 .
Thus, √n is not the right scaling factor for Sn. Some other, bigger, sequence is needed.
On the other hand, a scaling of Sn by n is also not appropriate. Why? Observe that
the strong law of large numbers asserts that
ℙ{ lim
n→∞
Sn
n = 0} = 1 .

7.2 Central limit theorem
౪
357
Hence, an appropriate scaling of the Sns should be a sequence lying between √n and n.
Surprisingly, the correct sequence of normalization is √2n log log n. The law of iterated
logarithm due to Hartman and Wintner (see, e. g., [Bil12, Theorem 9.5], or [Kle20]) im-
plies
ℙ{lim sup
n→∞
Sn
√2n log log n
= 1} = ℙ{lim inf
n→∞
Sn
√2n log log n
= −1} = 1 .
Consequently, for any ε > 0 one gets
ℙ{Sn ≥(1 −ε)√2n log log n i. o.} = 1,
while
ℙ{Sn ≥(1 + ε)√2n log log n i. o.} = 0 .
Example 7.2.17 (Round-off errors). Many calculations in a bank, for instance, of interest,
lead to amounts that are not integral in cents. In this case the bank rounds the calculated
value either up or down, whether the remainder is larger or smaller than 0.5 cent. For
example, if the calculations lead to $12.837, then the bank transfers $12.84. Thus, in this
case, the bank loses 0.3 cent. This seems to be a small amount, but if, for example, the
bank performs 106 calculations per day, the total loss or gain could sum up to an amount
of $5000.00. But does this really happen?
Answer: Theoretically, the rounding procedure could lead to huge losses or gains of
the bank. But, as the central limit theorem shows, in reality such a scenario is extremely
unlikely. To make this more precise, we use the following model. Let Xj be the loss or
gain (in cents) of the bank in calculation j. Then the Xj are independent and uniformly
distributed on [−0.5, 0.5]. Thus, the total loss or gain after n calculations equals Sn =
X1 + ⋅⋅⋅+ Xn. By Propositions 5.1.27 and 5.2.25, we know that
μ = 𝔼X1 = 0
and
σ2 = 𝕍X1 = 1
12 ,
hence, if a < b, the central limit theorem implies
lim
n→∞ℙ{a√n
√12
≤Sn ≤b√n
√12
} =
1
√2π
b
∫
a
e−x2/2 dx .
For example, if n = 106, then taking a = √12 and b = ∞, this leads to
ℙ{Sn ≥$10} = ℙ{Sn ≥103 cents} ≈
1
√2π
∞
∫
√12
e−x2/2 dx ≈0.00026603 ,

358
౪
7 Limit theorems
which is an extremely small probability. By symmetry, it also follows that
ℙ{Sn ≤−$10} ≈
1
√2π
−√12
∫
−∞
e−x2/2 dx ≈0.00026603 .
In a similar way, one obtains
ℙ{Sn ≥$1} ≈0.364517 ,
ℙ{Sn ≥$2} ≈0.244211,
ℙ{Sn ≥$5} ≈0.0416323
and
ℙ{Sn ≥$20} ≈2.1311 × 10−12 .
This shows that even for many calculations, in our case 106, the probability for a loss
or gain of more than $5 is very unlikely. Recall that theoretically an amount of $5000.00
would be possible.
Example 7.2.18. Suppose n people choose independently of each other an integer in
{0, . . . , 9}. Thereby, each of the 10 numbers is equally likely. Of course, the expected value
of the chosen numbers is μ = 9/2. Moreover, the variance of a single choice can be eval-
uated by
σ2 = 1
10
9
∑
k=0
(k −9/2)2 = 33
4 .
Let Sn be the sum of the chosen n numbers. Then the strong law of large numbers yields
that with probability 1,
lim
n→∞
Sn
n = 9
2 .
We ask now how far or near we may expect Sn/n to 9/2, of course, depending on n.
To answer this question, we apply the central limit theorem. It asserts that, given
a < b,
ℙ{a ≤2 Sn −9n/2
√33 n
≤b} ≈Φ(b) −Φ(a) .
Equivalently, this is
ℙ{a√33
2√n ≤Sn
n −9
2 ≤b√33
2√n } ≈Φ(b) −Φ(a) .
Setting a = −2c/√33 and b = 2c/√33, an application of Corollary 4.2.5 leads to
ℙ{
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
Sn
n −9
2
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
≤
c
√n} ≈Φ( 2c
√33
) −Φ(−2c
√33
) ≥0.9973
provided that 2c/√33 ≥3, that is, if c > 8.17.

7.2 Central limit theorem
౪
359
We refer to Problem 7.8 for a general approach to the question treated in this
example.
Special cases of the central limit theorem
Binomial distributed random variables. In 1738 De Moivre, and later on in 1812 Laplace,
investigated the normal approximation of binomial distributed7 random variables. This
was the starting point for the investigation of general central limit theorems. Let us state
their result.
Proposition 7.2.19 (De Moivre–Laplace theorem). Let the Xjs be independent B1,p-dis-
tributed random variables. Then their sums Sn = X1 + ⋅⋅⋅+ Xn satisfy
lim
n→∞ℙ{a ≤
Sn −np
√np(1 −p)
≤b} =
1
√2π
b
∫
a
e−x2/2 dx .
(7.19)
Proof. Recall that for a B1,p-distributed random variable X, we have μ = 𝔼X = p and
σ2 = 𝕍X = p(1 −p). Consequently, Proposition 7.2.7 applies and leads to eq. (7.19).
Remark 7.2.20. By Corollary 4.6.2, we know that Sn = X1 + ⋅⋅⋅+ Xn is Bn,p-distributed.
Consequently, eq. (7.19) may also be written as
lim
n→∞∑
k∈In,a,b
(n
k)pk (1 −p)n−k =
1
√2π
b
∫
a
e−x2/2 dx,
where
In,a,b := {k ≥0 : a ≤
k −np
√np(1 −p)
≤b} .
Another way to formulate the De Moivre–Laplace theorem is as follows. For “large” n,
Sn is approximative 𝒩(np, np(1 −p))-distributed. That is, if 0 ≤ℓ< m ≤n, then
m
∑
k=ℓ
(n
k)pk(1 −p)n−k ≈Φ(
m −np
√np(1 −p)
) −Φ(
ℓ−np
√np(1 −p)
).
(7.20)
Since the sums Sn are integer-valued, the continuity correction should be applied for n
small, that is, on the right-hand side of eq. (7.20) the numbers m and ℓshould be replaced
by m + 0.5 and by ℓ−0.5, respectively.
Example 7.2.21. Play a series of games with success probability 0 < p < 1. Let α ∈(0, 1)
be a given security probability, and m ∈ℕis some integer. How many games does one
7 De Moivre investigated sums of B1,1/2-distributed random variables while Laplace treated B1,p-
distributed ones for general 0 ≤p ≤1.

360
౪
7 Limit theorems
have to play in order to have with probability greater than or equal to 1 −α at least m
successes?
Answer: Define random variables Xj by setting Xj = 1 when winning game j, while
Xj = 0 in the case of losing it. Then the Xjs are independent and B1,p-distributed. Hence,
if Sn = X1 + ⋅⋅⋅Xn, then the above question may be formulated as follows. What is the
smallest n ∈ℕfor which
ℙ{Sn ≥m} ≥1 −α ?
(7.21)
By Corollary 4.6.2, the sum Sn is Bn,p-distributed and, therefore, the estimate in (7.21)
transforms to
n
∑
k=m
(n
k)pk(1 −p)n−k ≥1 −α .
(7.22)
Thus, the “exact” answer to the above question is as follows. Choose the minimal n ≥1
for which estimate (7.22) is valid.
Remark 7.2.22. For large m, it may be a difficult task to determine the minimal n satis-
fying estimate (7.22). Therefore, one looks for an “approximate” approach via Proposi-
tion 7.2.19. Rewriting estimate (7.21) as
ℙ{
Sn −np
√np(1 −p)
≥
m −np
√np(1 −p)
} ≥1 −α ,
an “approximate” condition for n is
1 −α ≤1 −Φ(
m −np
√np(1 −p)
) = Φ(
np −m
√np(1 −p)
).
Given β ∈(0,1), let us define8 zβ by Φ(zβ) = β. Consequently, an approximate solution of
the above question is to choose the minimal n ≥1 satisfying
np −m
√np(1 −p)
≥z1−α .
(7.23)
For “small” n, we have to modify the previous approach slightly. Here we have to use
the continuity correction. In view of eq. (7.17), the condition is now
1 −α ≤Φ(np −m + 0.5
√np(1 −p)
) ,
8 Later on, in Proposition 8.4.3, these numbers zβ will play an important role; compare also with Defi-
nition 8.4.8.

7.2 Central limit theorem
౪
361
leading to
np −m + 0.5
√np(1 −p)
≥z1−α .
(7.24)
Let us explain Remark 7.2.22 with the help of a concrete example.
Example 7.2.23. Find the minimal n ≥1 such that, rolling a fair die n times, one observes
with probability greater than or equal to 0.9 at least 100 times the number 6?
For the “exact” answer choose the minimal n ≥1 satisfying
n
∑
k=100
(n
k)( 1
6)
k
(5
6)
n−k
≥0.9 .
Numerical calculations give that the left-hand side equals 0.897721 if n = 670, and it
is 0.900691 if n = 671. Thus, in order to observe, with probability greater than 0.9, the
number 6 at least 100 times, one has to roll the die at least 671 times.
Let us compare this result with that we obtained by the approximation approach.
First, we approximate Sn directly, that is, without applying the continuity correction.
Here estimate (7.23) says that we have to look for the minimal n ≥1 satisfying
n
6 −m
√1
6 ⋅5
6 ⋅n
= n −600
√5n
≥z0.9 = 1.28155 .
(7.25)
Since
665 −600
√5 ⋅665
= 1.12724
and
666 −600
√5 ⋅666
= 1.4373 ,
the smallest n satisfying estimate (7.25) is 666.
Applying the continuity correction, by estimate (7.24), condition (7.25) has to be re-
placed by
n
6 −m + 0.5
√1
6 ⋅5
6 ⋅n
= n −600 + 3
√5n
≥z0.9 = 1.28155 .
The left-hand side equals 1.27757 for n = 671 and 1.29387 if n = 672. Consequently, this
type of approximation gives the (more precise) value n = 672 for the minimal number
of necessary rolls of the die.
Poisson distributed random variables. Let X1, X2, . . . be independent and Poisλ-dis-
tributed. By Propositions 5.1.16 and 5.2.22, we know
𝔼X1 = λ
and
𝕍X1 = λ .
Thus, in this case Proposition 7.2.7 reads as follows.

362
౪
7 Limit theorems
Proposition 7.2.24. Let (Xj)j≥1 be independent Poisλ-distributed random variables. Then
the sums Sn = X1 + ⋅⋅⋅+ Xn satisfy
lim
n→∞ℙ{a ≤Sn −nλ
√nλ
≤b} =
1
√2π
b
∫
a
e−x2/2 dx .
(7.26)
Remark 7.2.25. By Proposition 4.6.5, the sum Sn is Poisλn-distributed, hence eq. (7.26)
transforms to
lim
n→∞∑
k∈Jn,a,b
(λn)k
k!
e−λn =
1
√2π
b
∫
a
e−x2/2 dx ,
(7.27)
where
Jn,a,b := {k ∈ℕ0 : a ≤k −nλ
√nλ
≤b} .
Another way to express this is as follows. If 0 ≤ℓ< m < ∞, then
m
∑
k=ℓ
(λn)k
k!
e−λn ≈Φ(m −nλ
√nλ
) −Φ(ℓ−nλ
√nλ
) .
Remark 7.2.26. Choosing in eq. (7.27) the numbers as a = −∞, b = 0, and λ = 1, we get
lim
n→∞e−n
n
∑
k=0
nk
k! = 1
2 ,
which is interesting in its own right. Taking = −∞and bn = √n yields
lim
n→∞
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
e−n
2n
∑
k=0
nk
k! −
1
√2π
bn
∫
−∞
e−x2/2 dx
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
= 0 ,
hence, because of
lim
n→∞
1
√2π
√n
∫
−∞
e−x2/2 dx = 1 ,
we obtain
lim
n→∞e−n
2n
∑
k=0
nk
k! = 1 .
Gamma distributed random variables. Finally, we investigate sums of gamma distributed
random variables. Here the central limit theorem leads to the following result.

7.2 Central limit theorem
౪
363
Proposition 7.2.27. Let X1, X2, . . . be independent Γα,β-distributed random variables. Then
their sums Sn = X1 + ⋅⋅⋅+ Xn satisfy
lim
n→∞ℙ{a ≤Sn −nαβ
α√nβ
≤b} =
1
√2π
b
∫
a
e−x2/2 dx .
(7.28)
Proof. Propositions 5.1.28 and 5.2.26 tell us that the expected value and the variance of
the Xjs are given by μ = 𝔼X1 = αβ and σ2 = 𝕍X1 = α2β. Therefore, eq. (7.28) follows by
an application of Proposition 7.2.7.
Remark 7.2.28. Note that Proposition 4.6.4 implies that Sn is Γα,nβ-distributed. Thus, set-
ting
In,a,b := {x ≥0 : a ≤x −nαβ
α√nβ
≤b} ,
eq. (7.28) leads to
lim
n→∞
1
αnβΓ(nβ) ∫
In,a,b
xnβ−1 e−x/α dx =
1
√2π
b
∫
a
e−x2/2 dx .
Another way to express this is as follows. If 0 ≤a < b, then
1
αnβΓ(nβ)
b
∫
a
xnβ−1 e−x/α dx ≈Φ(b −nαβ
α√nβ
) −Φ(a −nαβ
α√nβ
) .
Two cases of Proposition 7.2.27, or Remark 7.2.28, are of special interest.
(a) For n ≥1, let Sn be a χ2
n-distributed random variable. Then it follows that
lim
n→∞ℙ{a ≤Sn −n
√2n
≤b} =
1
√2π
b
∫
a
e−x2/2 dx .
Another way to express this as follows: if the Sns are χ2
n-distributed, then for t ∈ℝ
and n sufficiently large,
ℙ{Sn ≤√2n t + n} ≈
1
√2π
t
∫
−∞
e−x2/2dx = Φ(t) .
In Fig. 7.7, one sees how good the approximation of Φ is even for small n.

364
౪
7 Limit theorems
Figure 7.7: The normalized and shifted distribution function ℙ{Sn ≤√2n t + n} of a χ2
n-distributed random
variable Sn. We chose n = 5 (upper graph at zero) and n = 16 (middle graph), in comparison with the
approximated Φ(t) (lower graph).
(b) If Sn is distributed according to the Erlang distribution Eλ,n, then we get
lim
n→∞ℙ{a ≤λSn −n
√n
≤b} =
1
√2π
b
∫
a
e−x2/2 dx .
For λ = 1, this implies (set a = −∞and b = 0) that
lim
n→∞
1
Γ(n)
n
∫
0
xn−1 e−x dx =
1
√2π
0
∫
−∞
e−x2/2 dx = 1
2 .
Additional remarks
(1) We play a series of the same game. Suppose in each game we may lose or win
a certain amount of money. A natural condition for these games (among friends) is
whether it should be fair. But what does it mean that a series of games is fair? Is this the
case
(i)
if the average loss or gain in each single game is zero, or
(ii) if the probability that, after n games, the total loss or gain is positive, tends to 1/2 as
n tends to infinity?
The mathematical formulation of the previous question is as follows. Let X1, X2, . . . de-
note the win or loss in the first game, the second, and so on. Then the Xjs are independent
identically distributed random variables. The above question reads now as follows. Is
the game fair
(i)
if the expected value μ = 𝔼X1 satisfies μ = 0, or

7.2 Central limit theorem
౪
365
(ii) if the sum Sn := X1 + ⋅⋅⋅+ Xn fulfills
lim
n→∞ℙ{Sn ≤0} = lim
n→∞ℙ{Sn ≥0} = 1
2 ?
(7.29)
In the sequel, we have to exclude the trivial case ℙ{Xj = 0} = 1, that is, in each game one
neither wins nor loses some money. Of course, then eq. (7.29) does not hold.
At a first glance, one might believe that the two possible definitions of fairness de-
scribe the same fact. But this is not so as one may see in an example in [Fel68, Chapter X,
Section 4]. There one finds a sequence of independent random variables X1, X2, . . . with
𝔼X1 = 0, however,
lim
n→∞ℙ{Sn ≤0} = 1 .
In particular, this tells us that, in general, condition (i) does not imply condition (ii).
The next result clarifies the relation between these two definitions of fairness in the
case that the random variables possess a finite second moment.
Proposition 7.2.29. Let X1, X2, . . . be independent and identically distributed with ex-
pected value μ. Assume ℙ{Xj = 0} < 1.
1.
Then eq. (7.29) always implies μ = 0. That is, a fair game in the sense of (ii) also
satisfies condition (i).
2.
Conversely, if 𝔼|X1|2 < ∞, then (ii) is a consequence of (i). Hence, assuming the exis-
tence of a second moment, conditions (i) and (ii) are equivalent.
Proof. We prove the contraposition of the first statement. Thus, suppose that (i) does not
hold, that is, we have μ
̸= 0. Without losing generality, we may assume μ > 0. Otherwise,
investigate −X1, −X2, . . . An application of Proposition 7.1.28 with ε = μ/2 yields
lim
n→∞ℙ{
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
Sn
n −μ
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
≤μ
2 } = 1 .
(7.30)
Since | Sn
n −μ| ≤μ/2 implies Sn
n ≥μ/2, hence Sn ≥0, it follows that
ℙ{
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
Sn
n −μ
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
≤μ
2 } ≤ℙ{Sn ≥0} .
Consequently, from eq. (7.30) we derive
lim
n→∞ℙ{Sn ≥0} = 1 ,
hence eq. (7.29) cannot be valid. This proves the first part of the proposition.
We prove now the second assertion. Thus, suppose μ = 0 as well as the existence of
the variance σ2 = 𝕍X1. Note that σ2 > 0. Why? If a random variable X satisfies 𝔼X = 0

366
౪
7 Limit theorems
and 𝕍X = 0, then necessarily ℙ{X = 0} = 1. But, since we assumed ℙ{X1 = 0} < 1, we
cannot have σ2 = 𝕍X1 = 0.
Thus, Proposition 7.2.7 applies and leads to
lim
n→∞ℙ{Sn ≥0} = lim
n→∞{ Sn
σ√n ≥0} =
1
√2π
∞
∫
0
e−x2/2 dx = 1
2 .
The proof for ℙ{Sn ≤0} →1/2 follows in the same way, thus eq. (7.29) is valid. This
completes the proof.
(2) How fast does Sn−nμ
σ√n converge to a normally distributed random variable? Before
we answer this question, we have to determine how this speed is measured. In view of
Proposition 7.2.7, we use the following quantity depending on n ≥1:
sup
t∈ℝ
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
ℙ{Sn −nμ
σ√n
≤t} −
1
√2π
t
∫
−∞
e−x2/2 dx
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
.
Doing so, the following classical result holds (see [Dur19, Section 3.4.4], for a proof).
Proposition 7.2.30 (Berry–Esséen theorem). Let X1, X2, . . . be independent identically dis-
tributed random variables with finite third moment, that is, with 𝔼|X1|3 < ∞. If μ = 𝔼X1
and σ2 = 𝕍X1 > 0, then it follows that
sup
t∈ℝ
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
ℙ{Sn −nμ
σ√n
≤t} −
1
√2π
t
∫
−∞
e−x2/2 dx
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
≤C ⋅𝔼|X1|3
σ3
n−1/2 .
(7.31)
Here C > 0 denotes a universal constant.
Remark 7.2.31. The order n−1/2 in estimate (7.31) is optimal and cannot be improved.
This can be seen by the following example. Take independent random variables X1, X2, . . .
with ℙ{Xj = −1} = ℙ{Xj = 1} = 1/2. Hence, in this case μ = 0 and σ2 = 1. Then one has
lim inf
n→∞n1/2 sup
t∈ℝ
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
ℙ{ Sn
√n ≤t} −
1
√2π
t
∫
−∞
e−x2/2 dx
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
> 0 .
(7.32)
Assertion (7.32) is a consequence of the fact that, if n is even, then the function t 󳨃→
ℙ{ Sn
√n ≤t} has a jump of order n−1/2 at zero. This follows by the calculations in Exam-
ple 4.1.7. On the other hand, t 󳨃→Φ(t) is continuous, hence the maximal difference be-
tween these two functions is at least half of the height of the jump.
Remark 7.2.32. The exact value of the constant C > 0 appearing in estimate (7.31) is, in
spite of intensive investigations, still unknown. At present, the best-known estimates are
0.40973 < C < 0.4748.

7.3 Problems
౪
367
Summary: The central limit theorem belongs to the most important mathematical results. It explains why so
many random observations in nature, community or business, etc., are distributed according to the normal
distribution.
The precise statement of the central limit theorem is as follows: if X1, X2, . . . are independent identically
distributed random variables with expected value μ and variance σ2 > 0, then their sum Sn = X1 + ⋅⋅⋅+ Xn is
approximative 𝒩(nμ, nσ2)-distributed. After normalizing the sum Sn in the right way, this says that
ℙ{a ≤Sn −nμ
σ√n
≤b} 󳨀→
n→∞Φ(b) −Φ(a) =
1
√2π
b
∫
a
e−x2/2dx .
In case of integer valued Xjs and small n the continuity correction improves the approximation of Sn by the
normal distribution as follows: if k ≤ℓare integers, then one uses as approximation
ℙ{k ≤Sn ≤ℓ} ≈Φ(ℓ+ 0.5 −nμ
σ√n
) −Φ(k −0.5 −nμ
σ√n
) .
7.3 Problems
Problem 7.1. Let A1, A2, . . . and B1, B2, . . . be two sequences of events in a probability
space (Ω, 𝒜, ℙ). Prove that
lim sup
n→∞(An ∪Bn) = lim sup
n→∞(An) ∪lim sup
n→∞(Bn) .
Is this also valid for the intersection? That is, does one have
lim sup
n→∞(An ∩Bn) = lim sup
n→∞(An) ∩lim sup
n→∞(Bn) ?
Problem 7.2. Let A1, A2, . . . be a sequence of subsets in Ω. Show that
1{lim inf An} = lim inf
n→∞1An
and
1{lim sup An} = lim sup
n→∞
1An .
Here 1A denotes the indicator function of a set A as introduced in Definition 3.6.16.
Problem 7.3. Let (Xn)n≥1 be a sequence of independent Eλ-distributed random vari-
ables. Characterize sequences (cn)n≥1 of positive real numbers for which
ℙ{Xn ≥cn i. o.} = 1?
Problem 7.4. Let f : [0, 1] →ℝbe a continuous function. Its Bernstein polynomial Bf
n
of degree n is defined by
Bf
n(x) :=
n
∑
k=0
f (k
n)(n
k)xk(1 −x)n−k ,
0 ≤x ≤1 .

368
౪
7 Limit theorems
Show that Proposition 7.1.30 implies the following. If ℙis the uniform distribution
on [0, 1], then
ℙ{x ∈[0, 1] : lim
n→∞Bf
n(x) = f (x)} = 1 .
Remark: Using methods from Calculus, one may even show the uniform conver-
gence, that is,
lim
n→∞sup
0≤x≤1
󵄨󵄨󵄨󵄨Bf
n(x) −f (x)󵄨󵄨󵄨󵄨= 0 .
Problem 7.5. Roll a fair die 180 times. What is the probability that the number “6” occurs
at most 25 times. Determine this probability by the following three methods:
–
Directly via the binomial distribution.
–
Approximately by virtue of the central limit theorem.
–
Approximately by applying the continuity correction.
Problem 7.6. Toss a fair coin 16 times. Compute the probability to observe exactly eight
times “heads” by the following methods:
–
Directly via the binomial distribution.
–
Approximately by applying the continuity correction.
Why does one not get a reasonable result using the normal approximation directly, that
is, without continuity correction?
Problem 7.7. Let X1, X2, . . . be a sequence of independent Gp-distributed random vari-
ables, that is, for some 0 < p < 1 one has
ℙ{Xj = k} = p(1 −p)k−1 ,
k = 1, 2, . . .
1.
What does the central limit theorem tell us in this case about the behavior of the
sums Sn = X1 + ⋅⋅⋅+ Xn?
2.
For two real numbers a < b, set
In,a,b := {k ≥0 : a ≤pk −n(1 −p)
√n(1 −p)
≤b} .
Argue why
lim
n→∞∑
k∈In,a,b
(−n
k )pn(1 −p)k =
1
√2π
b
∫
a
e−x2/2dx .
Hint: Use Corollary 4.6 and investigate Sn −n.

7.3 Problems
౪
369
Problem 7.8. Extend the question treated in Example 7.2.18 to the general setting. That
is, given independent, identically distributed random variables X1, X2, . . . with expected
value μ and variance σ2, find c > 0 depending on σ2 such that for sufficiently large n it
follows that
ℙ{
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
X1 + ⋅⋅⋅+ Xn
n
−μ
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
≤
c
√n} ≥Φ(3) −Φ(−3) ≈0.9973 .

8 Mathematical statistics
8.1 Statistical models
8.1.1 Nonparametric statistical models
The main objective of Probability Theory is to describe and analyze random experi-
ments by means of a suitable probability space (Ω, 𝒜, ℙ). Here it is always assumed that
the probability space is known, in particular, that the describing probability measure,
ℙ, is identified.
Probability Theory:
Description of a random experiment and its properties by a probability space. The distribution of the out-
comes is assumed to be known.
Mathematical Statistics deals mainly with the reverse question: one executes an exper-
iment, that is, one draws a sample (e. g., one takes a series of measurements of an item
or one questions several people), and, on the basis of the observed sample, one wants
to derive as much information as possible about the (unknown) underlying probability
measure ℙ. Sometimes the precise knowledge of ℙis not needed; it may suffice to know
a certain parameter of ℙ.
Mathematical Statistics:
As a result of a statistical experiment, a (random) sample is observed. On its basis, conclusions are drawn
about the unknown underlying probability distribution.
Let us state the mathematical formulation of the task: first, we mention that it is stan-
dard practice in Mathematical Statistics to denote the describing probability space by
(𝒳, ℱ, ℙ). As before, 𝒳is the sample space (the set that contains all possible outcomes
of the experiment), and ℱis a suitable σ-field of events. The probability measure ℙde-
scribes the experiment, that is, ℙ(A) is the probability of observing a sample belonging
to A, but recall that ℙis unknown.
Based on theoretical considerations or on long-time experience, quite often we are
able to restrict the entirety of probability measures in question. Mathematically, this
means that we choose a set P of probability measures on (𝒳, ℱ) which contains what
we believe to be the “correct” ℙ. Thereby, it is not impossible that P is the set of all
probability measures, but for most statistical methods it is very advantageous to take P
as small as possible. On the other hand, the set P cannot be chosen too small, because
we have to be sure that the “correct” ℙis really contained in P. Otherwise, the obtained
results are either false or imprecise.
https://doi.org/10.1515/9783111325064-008

8.1 Statistical models
౪
371
Definition 8.1.1. A subset P of probability measures on (𝒳, ℱ) is called a distribution assumption, that
is, one assumes that the underlying (unknown) ℙbelongs to the collection P.
After having fixed the distribution assumption P, one now regards only probability mea-
sures ℙ∈P or, equivalently, measures not in P are discarded.
To get information about the unknown probability measure, one performs a statisti-
cal experiment or analyzes some given data. In both cases, the result is a random sample
x ∈𝒳. The task of Mathematical Statistics is to get information about ℙ∈P, based on
the observed sample x ∈𝒳. A suitable way to describe the problem is as follows.
Definition 8.1.2. A (nonparametric) statistical model is a collection of probability spaces (𝒳, ℱ, ℙ) with
ℙ∈P. Here, 𝒳and ℱare fixed, and ℙvaries through the distribution assumption P. One writes for the
model
(𝒳, ℱ, ℙ)ℙ∈P
or
{(𝒳, ℱ, ℙ) : ℙ∈P} .
Let us illustrate the previous definition with two examples.
Example 8.1.3. In an urn there are white and black balls of an unknown ratio. Let θ ∈
[0, 1] be the (unknown) proportion of white balls, hence 1−θ is that of the black ones. In
order to get some information about θ, one randomly chooses n balls with replacement.
The result of this experiment, or the sample, is a number k ∈{0, . . . , n}, the frequency
of observed white balls. Thus, the sample space is 𝒳= {0, . . . , n} and as σ-field we may
choose, as always for finite sample spaces, the powerset 𝒫(𝒳). The possible probability
measures describing this experiment are binomial distributions Bn,θ with 0 ≤θ ≤1.
Consequently, the distribution assumption is
P = {Bn,θ : θ ∈[0, 1]} .
Summing up, the statistical model describing the experiment is
(𝒳, 𝒫(𝒳), ℙ)ℙ∈P
where 𝒳= {0, . . . , n}
and
P = {Bn,θ : 0 ≤θ ≤1} .
Next, we consider an important example from quality control.
Example 8.1.4. A buyer obtains from a trader a delivery of N machines. Among them
M ≤N are defective. The buyer does not know the value of M. To determine it, he
randomly chooses n machines from the delivery and checks them. The result, or the
sample, is the number 0 ≤m ≤n of defective machines among the n tested.
Thus, the sample space is 𝒳= {0, . . . , n}, ℱ= 𝒫(𝒳), and the probability measures
in question are hypergeometric ones. Therefore, the distribution assumption is
P = {HN,M,n : M = 0, . . . , N} ,
where HN,M,n denotes the hypergeometric distribution with parameters N, M, and n, as
introduced in Definition 1.4.32.

372
౪
8 Mathematical statistics
Before we proceed further, we consider a particularly interesting case of statisti-
cal model, which describes the n-fold independent repetition of a single experiment. To
explain this model, let us investigate the following easy example.
Example 8.1.5. We are given a die that looks biased. To check this, we roll it n times
and record the sequence of numbers appearing in each of the trials. Thus, our sample
space is 𝒳= {1, . . . , 6}n, and the observed sample is x = (x1, . . . , xn), with 1 ≤xk ≤6.
Let θ1, . . . , θ6 be the probabilities for 1 to 6. Then we want to check whether or not
θ1 = ⋅⋅⋅= θ6 =
1
6, that is, whether ℙ0 given by ℙ0({k}) = θk, 1 ≤k ≤6, is the uni-
form distribution. What are the possible probability measures on (𝒳, 𝒫(𝒳)) describing
the statistical experiment? Since the results of different rolls are independent, the de-
scribing measure ℙis of the form ℙ= ℙ⊗n
0 with
ℙ⊗n
0 ({x}) = ℙ0({x1}) ⋅⋅⋅ℙ0({xn}) = θm1
1 ⋅⋅⋅θm6
6 ,
x = (x1, . . . , xn) ,
and where the mks denote the frequency of the number 1 ≤k ≤6 in the sequence x.
Consequently, the natural distribution assumption is
P = {ℙ⊗n
0
: ℙ0 probability measure on {1, . . . , 6}} .
Suppose we are given a probability space (𝒳0, ℱ0, ℙ0) with unknown ℙ0 ∈P0. Here,
P0 denotes a set of probability measures on (𝒳0, ℱ0), hopefully containing the “cor-
rect” ℙ0. We call (𝒳0, ℱ0, ℙ0)ℙ0∈P0 the initial model. In Example 8.1.5, the initial model
is 𝒳0 = {1, . . . , 6}, while P0 is the set of all probability measures on (𝒳0, 𝒫(ℱ0)).
In order to determine ℙ0, we execute n independent trials according to ℙ0. The
result, or the observed sample, is a vector x = (x1, . . . , xn) with xi ∈𝒳0. Consequently,
the natural sample space is 𝒳= 𝒳n
0 .
Which statistical model does this experiment describe? To answer this question,
let us recall the basic results in Section 1.9, where exactly those problems have been
investigated. As σ-field ℱ, we choose the n-fold product σ-field of ℱ0, that is,
ℱ= ℱ0 ⊗⋅⋅⋅⊗ℱ0
⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟
n times
,
and the describing probability measure ℙis of the form ℙ⊗n
0 , that is, it is the n-fold prod-
uct of ℙ0. Recall that, according to Definition 1.9.5, the product ℙ⊗n
0 is the unique proba-
bility measure on (𝒳, ℱ) satisfying
ℙ⊗n
0 (A1 × ⋅⋅⋅× An) = ℙ0(A1) ⋅⋅⋅ℙ0(An) ,
whenever Aj ∈ℱ0. Since we assumed ℙ0 ∈P0, the possible probability measures are
ℙ⊗n
0 with ℙ0 ∈P0.
Let us summarize what we obtained until now.

8.1 Statistical models
౪
373
Definition 8.1.6. The statistical model for the n-fold independent repetition of an experiment, deter-
mined by the initial model (𝒳0, ℱ0, ℙ0)ℙ0∈P0, is given by
(𝒳, ℱ, ℙ⊗n
0 )ℙ0∈P0
where 𝒳= 𝒳n
0 , ℱdenotes the n-fold product σ-field of ℱ0, and ℙ⊗n
0 is the n-fold product measure of ℙ0.
Remark 8.1.7. Of course, the main goal in the model of n-fold repetition is to get some
knowledge about ℙ0. To obtain the desired information, we perform n independent tri-
als, each time observing a value distributed according to ℙ0. Altogether, the sample is a
vector x = (x1, . . . , xn), which is now distributed according to ℙ⊗n
0 .
The two following examples explain Definition 8.1.6.
Example 8.1.8. A coin is labeled on one side with “0” and on the other side with “1.”
There is some evidence that the coin is biased. To check this, let us execute the follow-
ing statistical experiment: toss the coin n times and record the sequence of zeroes and
ones. Thus, the observed sample is an x = (x1, . . . , xn), with each xk being either “0”
or “1.”
Our initial model is given by 𝒳0 = {0, 1} and ℙ0 = B1,θ for a certain (unknown)
θ ∈[0, 1]. Then the experiment is described by 𝒳= {0, 1}n and P = {B⊗n
1,θ : 0 ≤θ ≤1}.
Note that
B⊗n
1,θ({x}) = θk(1 −θ)n−k ,
k = x1 + ⋅⋅⋅+ xn .
Example 8.1.9. A company produces a new type of light bulb with an unknown distri-
bution of the lifetime. To determine it, n light bulbs are switched on at the same time.
Let t = (t1, . . . , tn) be the times when the bulbs burn out. Then our sample is the vector
t ∈(0, ∞)n.
From long-time experience, one knows the lifetime of each light bulb is exponen-
tially distributed. Thus, the initial model is (ℝ, ℬ(ℝ), P0) with P0 = {Eλ : λ > 0}. Conse-
quently, the experiment of testing n light bulbs is described by the model
(ℝn, ℬ(ℝn), ℙ⊗n)ℙ∈P0 = (ℝn, ℬ(ℝn), E⊗n
λ )λ>0 ,
where P0 = {Eλ : λ > 0}. Recall that E⊗n
λ
is the probability measure on (ℝn, ℬ(ℝn)) with
density p(t1, . . . , tn) = λne−λ(t1 + ⋅⋅⋅+ tn) for tj ≥0.
Summary: The basic problem in Mathematical Statistics is as follows: One observes a random sample x
belonging to a sample space 𝒳and, depending on this observed x, one wants to get as much information
as possible about the underlying unknown probability measure ℙ. The statistical model to describe this task
is a triple
(𝒳, ℱ, ℙ)ℙ∈P
or
{(𝒳, ℱ, ℙ) : ℙ∈P} .

374
౪
8 Mathematical statistics
Here 𝒳is the sample space, ℱdenotes a σ-field of subsets of 𝒳, mostly 𝒫(𝒳) or ℬ(ℝ), and P is a certain set
of probability measures defined on ℱ. The collection P of probability measures is said to be the distribution
assumption. One conjectures or knows by theoretical considerations that the underlying unknown probability
measure ℙbelongs to P.
8.1.2 Parametric statistical models
In all of our previous examples, there was a parameter that parametrized the proba-
bility measures in P in natural way. In Example 8.1.3, this is the parameter θ ∈[0, 1],
in Example 8.1.4, the probability measures are parametrized by M ∈{0, . . . , N}, in Ex-
ample 8.1.8 the parameter is also θ ∈[0, 1], and, finally, in Example 8.1.9 the natural
parameter is λ > 0. Therefore, from now on, we assume that there is a parameter set Θ
such that P may be represented as
P = {ℙθ : θ ∈Θ} .
Definition 8.1.10. A parametric statistical model is defined as
(𝒳, ℱ, ℙθ)θ∈Θ
with parameter set Θ. Equivalently, we suppose that the distribution assumption P, appearing in Defini-
tion 8.1.2, may be represented as P = {ℙθ : θ ∈Θ} .
In this notation, the parameter sets in Examples 8.1.3, 8.1.4, 8.1.8, and 8.1.9 are Θ = [0, 1],
Θ = {0, . . . , N}, Θ = [0, 1], and Θ = (0, ∞), respectively.
Remark 8.1.11. It is worthwhile mentioning that the parameter can be quite general;
for example, it can be a vector θ = (θ1, . . . , θk), so that in fact there are k unknown pa-
rameters θj, combined into a single vector θ. For instance, in Example 8.1.5, the unknown
parameters are θ1, . . . , θ6, thus, the parameter set is given by
Θ = {θ = (θ1, . . . , θ6) : θk ≥0 , θ1 + ⋅⋅⋅+ θ6 = 1} .
Let us present two further examples with slightly more complicated parameter sets.
Example 8.1.12. We are given an item of unknown length. It is measured by an instru-
ment of an unidentified precision. We assume that the instrument is unbiased, that is,
on average, it shows the correct value. In view of the central limit theorem, we may sup-
pose that the measurements are distributed according to a normal distribution 𝒩(μ, σ2).
Here μ is the “correct” length of the item, and σ > 0 reflects the precision of the measur-
ing instrument. A small σ > 0 says that the instrument is quite precise, while a large σ > 0
corresponds to an inaccurate instrument. Consequently, by the distribution assumption
the initial model is given as

8.1 Statistical models
౪
375
(ℝ, ℬ(ℝ), 𝒩(μ, σ2))μ∈ℝ, σ2>0 .
In order to determine μ (and maybe also σ), we measure the item n times by the same
method. As a result, we obtain a random sample x = (x1, . . . , xn) ∈ℝn. Thus, our model
describing this experiment is
(ℝn, ℬ(ℝn), 𝒩(μ, σ2)
⊗n)(μ,σ2)∈ℝ×(0,∞) .
Because of eq. (6.9), the model may also be written as
(ℝn, ℬ(ℝn), 𝒩( ⃗μ, σ2In))(μ,σ2)∈ℝ×(0,∞)
with ⃗μ = (μ, . . . , μ) ∈ℝn, and with diagonal matrix σ2In. The unknown parameter is
(μ, σ2), taken from the parameter set ℝ× (0, ∞).
Example 8.1.13. Suppose now we have two different items of lengths μ1 and μ2. We take
m measurements of the first item and n of the second. Thereby, we use different instru-
ments with maybe different degrees of precision. All measurements are taken indepen-
dently of each other. As a result, we get a vector (x, y) ∈ℝm+n, where x = (x1, . . . , xm)
are the values of the first m measurements and y = (y1, . . . , yn) those of the other n. As
before we assume that the xis are distributed according to 𝒩(μ1, σ2
1), and the yjs accord-
ing to 𝒩(μ2, σ2
2). We neither know μ1 and μ2 nor σ2
1 and σ2
2. Thus, the sample space is
ℝm+n and the vectors (x, y) are distributed according to 𝒩(( ⃗μ1, ⃗μ2), Rσ2
1 ,σ2
2 ) with diagonal
matrix Rσ2
1 ,σ2
2 having σ2
1 as its first m entries and σ2
2 as the remaining n.
Note that by Definition 1.9.5,
𝒩(( ⃗μ1, ⃗μ2), Rσ2
1 ,σ2
2 ) = 𝒩(μ1, σ2
1)
⊗m ⊗𝒩(μ2, σ2
2)
⊗n .
This is valid because, if A ∈ℬ(ℝm) and B ∈ℬ(ℝn), then it follows that
𝒩(( ⃗μ1, ⃗μ2), Rσ2
1 ,σ2
2 )(A × B) = 𝒩(μ1, σ2
1)
⊗m(A) ⋅𝒩(μ2, σ2
2)
⊗n(B) .
The parameter set in this example is given as ℝ2 × (0, ∞)2, hence the statistical model
may be written as
(ℝm+n, ℬ(ℝm+n), 𝒩(μ1, σ2
1)
⊗m ⊗𝒩(μ2, σ2
2)
⊗n)(μ1,μ2,σ2
1 ,σ2
2)∈ℝ2×(0,∞)2 .
Summary: A parametric statistical model is a statistical model represented as (𝒳, ℱ, ℙθ)θ∈Θ . Equivalently,
the distribution assumption may be written as P = {ℙθ : θ ∈Θ} with a suitable index set Θ. A typical example
is 𝒳= {0, . . . , n}, ℱ= 𝒫(𝒳), Θ = [0, 1], and ℙθ = Bn,θ.

376
౪
8 Mathematical statistics
8.2 Statistical hypothesis testing
8.2.1 Hypotheses and tests
We start with a parametric statistical model (𝒳, ℱ, ℙθ)θ∈Θ. Suppose the parameter set Θ
is split up into disjoint subsets Θ0 and Θ1. The aim of a test is to decide, on the basis of
the observed sample, whether or not the “true” parameter θ belongs to Θ0 or to Θ1.
Let us explain the problem with two examples.
Example 8.2.1. Consider once more the situation described in Example 8.1.4. Assume
there exists a critical value M0 ≤N such that the buyer accepts the delivery if the num-
ber M of defective machines satisfies M ≤M0. Otherwise, if M > M0, the buyer re-
jects it and sends the machines back to the trader. In this example the parameter set is
Θ = {0, . . . , N}. Letting Θ0 = {0, . . . , M0} and Θ1 = {M0 + 1, . . . , N}, the question about
acceptance or rejection of the delivery is equivalent to whether M ∈Θ0 or M ∈Θ1. As-
sume now the buyer checked n of the N machines and found m defective. On the basis of
this observation, the buyer has to decide about acceptance or rejection, or, equivalently,
about M ∈Θ0 or M ∈Θ1.
Example 8.2.2. Let us consider once more Example 8.1.13. There we had two measuring
instruments, both being unbiased. Consequently, the expected values μ1 and μ2 are the
correct lengths of the two items. The parameter set was Θ = ℝ2 × (0, ∞)2. Suppose we
conjecture that both items are of equal length, that is, we conjecture μ1 = μ2. Letting
Θ0 := {(μ, μ, σ2
1, σ2
2) : μ ∈ℝ, σ2
1, σ2
2 > 0}
and Θ1 = Θ \ Θ0, to prove or disprove the conjecture, we have to check whether
(μ1, μ2, σ2
1, σ2
2) belongs to Θ0 or Θ1.
On the other hand, if we want to know whether or not the first item is smaller than
the second, then we have to choose
Θ0 := {(μ1, μ2, σ2
1, σ2
2) : −∞< μ1 ≤μ2 < ∞, σ2
1, σ2
2 > 0}
and to check whether or not (μ1, μ2, σ2
1, σ2
2) belongs to Θ0.
An exact mathematical formulation of the previous problems is as follows.
Definition 8.2.3. Let (𝒳, ℱ, ℙθ)θ∈Θ be a parametric statistical model and suppose Θ = Θ0 ∪Θ1 with
Θ0 ∩Θ1 = 0.
Then the hypothesis or, more precisely, null hypothesis ℍ0 says that for the “correct” θ ∈Θ one
has θ ∈Θ0. This is expressed by writing ℍ0 : θ ∈Θ0 .
The alternative hypothesis ℍ1 says θ ∈Θ1. Thus, ℍ1 : θ ∈Θ1, and we have to check
ℍ0 : θ ∈Θ0
against
ℍ1 : θ ∈Θ1 .

8.2 Statistical hypothesis testing
౪
377
After the hypothesis is set, one executes a statistical experiment. Here the order is im-
portant: first, one has to set the hypothesis, then test it, not vice versa. If the hypothesis
is chosen on the basis of the observed results, then, of course, the sample will confirm
it.
Say the result of the experiment is some sample x ∈𝒳. One of the fundamental
problems in Mathematical Statistics is to decide, on the basis of the observed sample,
about acceptance or rejection of ℍ0. The mathematical formulation of the problem is as
follows.
Definition 8.2.4. A (hypothesis) test T for checking ℍ0 (against ℍ1) is a disjoint partition T = (𝒳0, 𝒳1)
of the sample space 𝒳. The set 𝒳0 is called the region of acceptance while 𝒳1 is said to be the critical
region, sometimes also called critical section or region of rejection. By mathematical reasoning, we
have to assume 𝒳0 ∈ℱ, which of course implies 𝒳1 ∈ℱas well.
Remark 8.2.5. A hypothesis test T = (𝒳0, 𝒳1) operates as follows: if the statistical ex-
periment leads to a sample x ∈𝒳1, then we reject ℍ0. But, if we get an x ∈𝒳0, then
this does not contradict the hypothesis, and for now we may furthermore work with
it.
Important comment: If we observe an x ∈𝒳0, then this does not say that ℍ0 is correct.
It only asserts that we failed to reject it or that there is a lack of evidence against it.
Let us illustrate the procedure with Example 8.2.1.
Example 8.2.6. By the choice of Θ0 and Θ1, the hypothesis ℍ0 is given by
ℍ0 : 0 ≤M ≤M0 ,
hence ℍ1 : M0 < M ≤N .
To test ℍ0 against ℍ1, the sample space 𝒳= {0, . . . , n} is split up into the two regions
𝒳0 := {0, . . . , m0} and 𝒳1 := {m0 + 1, . . . , n} with some (for now) arbitrary number m0 ∈
{0, . . . , n}. If among the checked n machines m are defective with some m > m0, then
m ∈𝒳1, hence one rejects ℍ0. In this case the buyer refuses to take the delivery and
sends it back to the trader. On the other hand, if m ≤m0, then m ∈𝒳0, which does not
contradict ℍ0, and the buyer will accept the delivery and pay for it. Of course, the key
question is how to choose the value m0 in a proper way.
Remark 8.2.7. Sometimes tests are also defined as mappings φ : 𝒳→{0, 1}. The link
between these two approaches is immediately clear. Starting with φ, the hypothesis test
T = (𝒳0, 𝒳1) is constructed by 𝒳0 = {x ∈𝒳: φ(x) = 0} and 𝒳1 = {x ∈𝒳: φ(x) = 1}.
Conversely, if T = (𝒳0, 𝒳1) is a given test, then set φ(x) = 0 if x ∈𝒳0 and φ(x) = 1
for x ∈𝒳1. The advantage of this approach is that it allows us to define the so-called
randomized tests. Here φ : 𝒳→[0, 1]. Then, as before, 𝒳0 = {x ∈𝒳: φ(x) = 0} and
𝒳1 = {x ∈𝒳: φ(x) = 1}. If 0 < φ(x) < 1, then
φ(x) = ℙ{reject ℍ0 if x is observed} .

378
౪
8 Mathematical statistics
That is, for certain observations x ∈𝒳, an additional random experiment (e. g., tossing
a coin) decides whether we accept or reject ℍ0. Randomized tests are useful in the case
of finite or countably infinite sample spaces.
When applying a test T = (𝒳0, 𝒳1) to check the null hypothesis ℍ0 : θ ∈Θ0, two
different types of errors may occur.
Definition 8.2.8. An error of the first kind or type I error occurs if ℍ0 is true but one observes a sample
x ∈𝒳1, hence rejects ℍ0.
Type I error = incorrect rejection of a true null hypothesis
In other words, a type I error happens if the “true” θ is in Θ0, but we observe an x ∈𝒳1.
Definition 8.2.9. An error of the second kind or type II error occurs if ℍ0 is false, but the observed
sample lies in 𝒳0, hence we do not reject the false hypothesis ℍ0.
Type II error = failure to reject a false null hypothesis
Consequently, a type II error occurs if the “true” θ is in Θ1, but the observed sample is
an element of the region of acceptance 𝒳0.
Example 8.2.10. In the context of Example 8.2.6, a type I error occurs if the delivery was
good, but among the checked machines more than m0 were defective, so that the buyer
rejected the delivery. Since the trader was not able to sell a proper delivery, this error is
also called the risk of the trader.
On the other hand, a type II error occurs if the delivery is not in good order, but
among the checked machines only a few were defective (at most m0). Thus, the buyer
accepted the bad delivery and paid for it. Therefore, this type of error is also called the
risk of the buyer.
Summary: Let (𝒳, ℱ, ℙθ)θ∈Θ be a parametric statistical model and suppose Θ = Θ0 ∪Θ1 with Θ0 ∩Θ1 = 0.
Then the hypotheses ℍ0 and ℍ1 are
ℍ0 : θ ∈Θ0
against
ℍ1 : θ ∈Θ1 .
A (hypothesis) test T for checking ℍ0 (against ℍ1) is a disjoint partition T = (𝒳0, 𝒳1) of the sample
space 𝒳. The set 𝒳0 is called the region of acceptance while 𝒳1 is said to be the critical region. If the
observed sample x ∈𝒳1, one rejects ℍ0. If x ∈𝒳0, we cannot reject ℍ0 and have to work with it further-
more.
Type I error = incorrect rejection of a true null hypothesis
⇔
x ∈𝒳1 and θ ∈Θ0,
Type II error = failure to reject a false null hypothesis
⇔
x ∈𝒳0 and θ ∈Θ1.

8.2 Statistical hypothesis testing
౪
379
Verbally said:1 A type I error is the mistaken rejection of a null hypothesis that is actually true; for example,
“due to a false witness report, an innocent person is convicted.” A type II error is the failure to reject a null
hypothesis that is actually false; for example, “due to the lack of evidence, a guilty person is not convicted.”
8.2.2 Power function and significance tests
The power of a test is described by its power function defined as follows.
Definition 8.2.11. Let T = (𝒳0, 𝒳1) be a test for ℍ0 : θ ∈Θ0 against ℍ1 : θ ∈Θ1. The function βT from
Θ to [0, 1] defined as
βT(θ) := ℙθ(𝒳1)
is called the power function of the test T.
Remark 8.2.12. If θ ∈Θ0, that is, if ℍ0 is true, then βT(θ) = ℙθ(𝒳1) is the probability
that 𝒳1 occurs or, equivalently, that a type I error happens.
On the contrary, if θ ∈Θ1, that is, ℍ0 is false, then 1−βT(θ) = ℙθ(𝒳0) is the probability
that 𝒳0 occurs or, equivalently, that a type II error appears.
Thus, a “good” test should satisfy the following conditions: the power function βT
attains small values on Θ0 and/or 1 −βT has small values on Θ1. Then the probabilities
for the occurrence of type I and/or type II errors are not too big.2
Example 8.2.13. What is the power function of the test presented in Example 8.2.6? Re-
call that Θ = {0, . . . , N} and 𝒳1 = {m0 + 1, . . . , n}. Hence, βT maps {0, . . . , N} to [0, 1] in the
following way:
βT(M) = HN,M,n(𝒳1) =
n
∑
m=m0+1
(M
m)(N−M
n−m)
(N
n)
.
(8.1)
If the hypotheses are
ℍ0 : 0 ≤M ≤M0
against
ℍ1 : M0 < M ≤N ,
then the maximal probability for a type I error is given by
max
0≤M≤M0
βT(M) = max
0≤M≤M0
n
∑
m=m0+1
(M
m)(N−M
n−m)
(N
n)
,
(8.2)
1 See [Fsh71].
2 In the literature, the power function is sometimes defined in a slightly different way. If θ ∈Θ0, then it
is as in our Definition 8.2.11 while for θ ∈Θ1 one defines it as 1 −βT(θ). Moreover, for 1 −βT one finds
the notion of the operation characteristics or oc-function.

380
౪
8 Mathematical statistics
while the maximal probability for a type II error equals
max
M0<M≤N(1 −βT(M)) =
max
M0<M≤N
m0
∑
m=0
(M
m)(N−M
n−m)
(N
n)
.
(8.3)
Let us give a concrete example for the power function in eq. (8.1). Suppose the trader
submits a delivery of 30 machines. Hence, N = 30 and Θ = {0, . . . , 30}. The buyer chooses
randomly 10 machines and tests them. That is, n = 10. Assume, the test is T = (𝒳0, 𝒳1)
where 𝒳0 = {0, 1, 2, 3, 4}, hence 𝒳1 = {5, 6, 7, 8, 9, 10}. Thus, m0 = 4. In other words, if
there are at most 4 defective machines among the tested 10, then the buyer accepts the
delivery. Otherwise, he rejects it.
Then the power function of the test T equals
βT(M) =
10
∑
m=5
(M
m)(30−M
10−m)
(30
10)
,
M = 0, . . . , 30 .
(8.4)
Note that
βT(0) = ⋅⋅⋅= βT(4) = 0
while βT(25) = ⋅⋅⋅= βT(30) = 1 .
Why is this so? First, if there are only 4 or less defective machines among the delivered, it
is impossible to observe 5 or more defective machines among the 10 chosen. On the other
hand, if there are 25 or more defective machines among 30, then at most 5 machines are
nondefective. Hence, among the 10 chosen there are at least 5 defective.
Some other interesting values of βT are (see also Figure 8.1)
M
5
6
7
8
9
10
11
βT(M)
0.001768
0.008842
0.02564
0.05632
0.1037
0.1687
0.2500
These values of βT tell us the following: if, for example, there are 11 defective ma-
chines in the delivery, then there is a 25 % chance to observe in the sample 5 or more
defective. Equivalently, the probability to observe at most 4 defective machines is still
75 %. Thus, in this case the likelihood of a type II error is rather big. The situation changes
drastically for larger M. If, for example, the number of defective machines is 18, among
100 trials the sample will on average 88.2 times contain 5 or more defective items.
Remark 8.2.14. Formulas (8.2) and (8.3) already illustrate the dilemma of hypothesis
testing. To minimize the type I error, one has to choose m0 as large as possible. But
increasing m0 enlarges the type II error.
This dilemma occurs always in the theory of hypothesis testing. In order to mini-
mize the probability of a type I error, the critical region 𝒳1 has to be chosen as small as
possible. But making 𝒳1 smaller enlarges 𝒳0, hence the probability for the occurrence

8.2 Statistical hypothesis testing
౪
381
Figure 8.1: The power function βT in eq. (8.4).
of a type II error increases. In the extreme case, if 𝒳1 = 0, hence 𝒳0 = 𝒳, then a type I
error cannot occur at all. In the context of Example 8.2.6 that means the buyer accepts
all deliveries and the trader takes no risk.
On the other hand, to minimize the occurrence of a type II error, the region of ac-
ceptance 𝒳0 has to be as small as possible. In the extreme case, if we choose 𝒳0 = 0, then
a type II error cannot occur because we always reject the hypothesis. In the context of
Example 8.2.6, this says the buyer rejects all deliveries. In this way he avoids buying any
delivery of bad quality, but he also never gets a proper one. Thus the buyer takes no risk.
It is pretty clear that both extreme cases presented above are absurd. Therefore, one
has to find a suitable compromise. The approach for such a compromise is as follows: in
the first step, one chooses tests where the probability of a type I error is bounded from
above. And in the second step, among all these tests satisfying this bound, one takes that
which minimizes the probability of a type II error. More precisely, we will investigate
tests satisfying the following condition.
Definition 8.2.15. Suppose we are given a number α ∈(0, 1), the so-called significance level. A test
T = (𝒳0, 𝒳1) for testing the hypothesis ℍ0 : θ ∈Θ0 against ℍ1 : θ ∈Θ1 is said to be an α-significance
test (or simply α-test), provided the probability for the occurrence of a type I error is bounded by α. That
is, the test has to satisfy
sup
θ∈Θ0
βT(θ) = sup
θ∈Θ0
ℙθ(𝒳1) ≤α .
Interpretation: The significance level α is assumed to be small. Typical choices are α =
0.1 or α = 0.01. Let T be an α-significance test and assume that ℍ0 is true. If we observe
now a sample in the critical region 𝒳1, then an event occurred with probability less than
or equal to α, that is, a very unlikely event has been observed. Therefore, we can be very

382
౪
8 Mathematical statistics
sure that this could not have happened provided ℍ0 had been true, and we reject this
hypothesis. The probability that we made a mistake is less than or equal to the chosen
α > 0, hence very small.
Recall that α-significance tests admit no bound for the probability of a type II error.
Therefore, we look for those α-significance tests that minimize the probability for a type
II error.
Definition 8.2.16. Let T1 and T2 be two α-significance tests for checking ℍ0 against ℍ1. If their power
functions satisfy
βT1(θ) ≥βT2(θ) ,
θ ∈Θ1 ,
then we say that T1 is (uniformly) more powerful than T2.
A (uniformly) most powerful α-test T is that which is more powerful than all other α-tests.
Remark 8.2.17. Note that βT1(θ) ≥βT2(θ) implies 1−βT1(θ) ≤1−βT2(θ), hence if T1 is more
powerful than T2, then, according to Remark 8.2.12, the probability for the occurrence
of a type II error is smaller for T1 than it is for T2. Therefore, a most powerful α-test is
that which minimizes the probability of occurrence of a type II error.
Remark 8.2.18. The question about existence and uniqueness of most powerful α-tests
is treated in the Neyman–Pearson lemma and its consequences. We will not discuss that
problem here; instead, we will construct most powerful tests in concrete situations. See
[CB02, Chapter 8.3.2] for a detailed discussion of the Neyman–Pearson lemma and its
consequences.
We start with the construction of such tests in the hypergeometric case. Here we
have the following.
Proposition 8.2.19. If the statistical model equals (𝒳, 𝒫(𝒳), HN,M,n)M=0,...,N with 𝒳=
{0, . . . , n}, then the most powerful α-test for testing M ≤M0 against M > M0 is given
by T = (𝒳0, 𝒳1), where 𝒳0 = {0, . . . , m0}, and m0 is defined by
m0 := max{k ≤n :
n
∑
m=k
(M0
m )(N−M0
n−m )
(N
n)
> α}
= min{k ≤n :
n
∑
m=k+1
(M0
m )(N−M0
n−m )
(N
n)
≤α} .
Proof. The proof of Proposition 8.2.19 needs the following lemma.
Lemma 8.2.20. The power function, defined by eq. (8.1), is a nondecreasing function on
the set {0, . . . , N}.
Proof. Suppose we get a delivery of N machines containing M defective. Now there are
not only defective machines within the delivery, but also
̃M −M false ones for some
̃M ≥M. We take a sample of size n and test these machines. Let X be the number of

8.2 Statistical hypothesis testing
౪
383
defective machines and let
̃X be the number of machines that are either defective or
false. Of course, we have X ≤
̃X implying ℙ(X > m0) ≤ℙ( ̃X > m0). Note that X is HN,M,n-
distributed while ̃X is distributed according to HN, ̃M,n. These observations lead to
βT(M) = HN,M,n({m0 + 1, . . . , n}) = ℙ{X > m0} ≤ℙ{ ̃X > m0}
= HN, ̃M,n({m0 + 1, . . . , n}) = βT( ̃M) .
This being true for all M ≤
̃M proves that βT is nondecreasing.
Let us come back to the proof of Proposition 8.2.19. Set 𝒳0 := {0, . . . , m0}, thus 𝒳1 =
{m0 + 1, . . . , n} for some (at the moment arbitrary) m0 ≤n. Because of Lemma 8.2.20, the
test T = (𝒳0, 𝒳1) is an α-significance test if and only if it satisfies
n
∑
m=m0+1
(M0
m )(N−M0
n−m )
(N
n)
= HN,M0,n(𝒳1) = sup
M≤M0
HN,M,n(𝒳1) ≤α .
To minimize the probability for the occurrence of a type II error, we have to choose 𝒳1
as large as possible or, equivalently, m0 as small as possible, that is, if we replace m0 by
m0 −1, then the new test is no longer an α-test. Thus, in order that T is an α-test that
minimizes the probability for a type II error, the number m0 has to be chosen such that
n
∑
m=m0+1
(M0
m )(N−M0
n−m )
(N
n)
≤α
and
n
∑
m=m0
(M0
m )(N−M0
n−m )
(N
n)
> α .
This completes the proof.
Example 8.2.21. A buyer gets a delivery of 100 machines. In the case that there are
strictly more than 10 defective machines in the delivery, he will reject it. Thus, his hy-
pothesis is ℍ0 : M ≤10. In order to test ℍ0, he chooses 15 machines and checks them.
Let m be the number of defective machines among the checked. For which m does he
reject the delivery with a significance level α = 0.01?
Answer: We have N = 100, M0 = 10, and n = 15. Since α = 0.01, from
15
∑
m=5
(10
m)( 90
15−m)
(100
15 )
= 0.0063 . . . < α
and
15
∑
m=4
(10
m)( 90
15−m)
(100
15 )
= 0.04 . . . > α ,
it follows that the optimal choice is m0 = 4. Consequently, we have 𝒳0 = {0, . . . , 4}, thus,
𝒳1 = {5, . . . , 15}. If there are 5 or even more defective machines among the tested 15,
then the buyer should reject the delivery. The probability that his decision is wrong is
less than or equal to 0.01.
What can be said about the probability for a type II error? For this test, we have
βT(M) =
15
∑
m=5
(M
m)(100−M
15−m )
(100
15 )
,
(8.5)

384
౪
8 Mathematical statistics
hence
1 −βT(M) =
4
∑
m=0
(M
m)(100−M
15−m )
(100
15 )
.
Since βT is nondecreasing, 1 −βT is nonincreasing, and the probability for a type II
error becomes maximal for M = 11. Recall that Θ0 = {0, . . . , 10} and, therefore, Θ1 =
{11, . . . , 100}. Thus, an upper bound for the probability of a type II error is given by
1 −βT(M) ≤1 −βT(11) =
4
∑
m=0
(11
m)( 89
15−m)
(100
15 )
= 0.989471 ,
M = 11, . . . , 100 .
This tells us that even in the case of most powerful tests the likelihood for a type II error
may be quite large. Even if the number of defective machines is big, this error may occur
with higher probability. For example, we have 1 −βT(20) = 0.853089 and 1 −βT(40) =
0.197057. See also Figure 8.2.
Figure 8.2: The power function βT defined by eq. (8.5).
If one is willing to take a greater risk and chooses α = 0.1, then, since
15
∑
m=4
(10
m)( 90
15−m)
(100
15 )
= 0.0063 . . . < α
and
15
∑
m=3
(10
m)( 90
15−m)
(100
15 )
= 0.1705 . . . > α,
one may take 𝒳0 = {0, 1, 2, 3} as the region of acceptance. Thus, in this case the buyer will
reject the delivery if there are 4 defective machines among the 15 tested. The probability
that this is a wrong decision is less than 0.1, but greater than 0.01.
Remark 8.2.22 (Important!). An α-significance test provides us with quite precise infor-
mation when rejecting the hypothesis ℍ0. In contrast, when we observe a sample x ∈𝒳0,

8.2 Statistical hypothesis testing
౪
385
the only information we get is that we failed to reject ℍ0, thus, we must continue to re-
gard it as true. Consequently, whenever fixing the null hypothesis, we have to fix it in a
way that either a type I error has the most serious consequences or that we can attain
the most information by rejecting ℍ0. Let us explain this with two examples.
Example 8.2.23. A certain type of food sometimes contains a special kind of poison.
Suppose there are μ milligrams of poison in one kilogram of the food. If μ > μ0, then
eating this becomes dangerous while for μ ≤μ0 it is unproblematic. How do we success-
fully choose the hypothesis when testing some sample of the food? We could take either
ℍ0 : μ > μ0 or ℍ0 : μ ≤μ0. Which is the right choice?
Answer: The correct choice is ℍ0 : μ > μ0. Why? If we reject ℍ0, then we can be very
sure that the food is not poisoned and may be eaten. The probability that someone will
be poisoned is less than α. A type II error occurs if the food is harmless, but we discard
it because our test tells us that it is poisoned. That results in a loss for the company that
produced it, but no one will suffer from poisoning. If we were to choose ℍ0 : μ ≤μ0,
then a type II error would occur if ℍ0 is false, that is, the food is poisoned, but our test
says that it is eatable. Of course, this error is much more serious, and we have no control
in regards to its probability.
Example 8.2.24. Suppose the height of 18-year-old males in the US is normally dis-
tributed with expected value μ and variance σ2 > 0. We want to know whether the
average height is above or below 6 feet. There is strong evidence that we will have
μ ≤6, but we cannot prove this. To do so, we execute a statistical experiment and
choose randomly n males of age 18 and measure their height. Which hypothesis should
be checked? If we take ℍ0 : μ ≤6, then it is very likely that our experiment will lead
to a result that does not contradict this hypothesis, resulting in a small amount of in-
formation gained. But, if we work with the hypothesis ℍ0 : μ > 6, then a rejection of
this hypothesis tells us that ℍ0 is very likely wrong, and we may say the conjecture is
true with high probability, namely that we have μ ≤6. Here the probability that our
conclusion is wrong is very small.
Summary: The power function of a test T = (𝒳0, 𝒳1) for ℍ0 : θ ∈Θ0 against ℍ1 : θ ∈Θ1 is defined by
βT(θ) = ℙθ(𝒳1) ,
θ ∈Θ .
If T is a “good” test, then the power function βT should be small on Θ0 and near to one on Θ1. Given α > 0,
an α-significance test T satisfies
sup
θ∈Θ0
βT(θ) = sup
θ∈Θ0
ℙθ(𝒳1) ≤α .
That is, if T is an α-test, the probability of a type I error is bounded by α.

386
౪
8 Mathematical statistics
8.3 Tests for binomial distributed populations
Because of their importance, we present tests for binomial distributed populations in a
separate section. The starting point is the problem described in Examples 8.1.3 and 8.1.8.
In a single experiment, we may observe either “0” or “1,” but we do not know the prob-
abilities for the occurrence of these events. To obtain some information about the un-
known probabilities, we execute n independent trials and record how often “1” occurs.
This number is Bn,θ-distributed for some 0 ≤θ ≤1. Hence, the describing statistical
model is given by
(𝒳, 𝒫(𝒳), Bn,θ)θ∈[0,1]
where 𝒳= {0, . . . , n} .
(8.6)
Two-sided tests: We want to check whether the unknown parameter θ satisfies θ = θ0
or θ
̸= θ0 for some given θ0 ∈[0, 1]. Thus, Θ0 = {θ0} and Θ1 = [0, 1] \ {θ0}. In other words,
the null and the alternative hypothesis are
ℍ0 : θ = θ0
and
ℍ1 : θ
̸= θ0,
respectively.
To construct a suitable α-significance test for checking ℍ0, we introduce two num-
bers n0 and n1 as follows. Note that these numbers depend on θ0 and, of course, also
on α. The numbers are defined by
n0 := min{k ≤n :
k
∑
j=0
(n
j )θj
0(1 −θ0)n−j > α/2}
= max{k ≤n :
k−1
∑
j=0
(n
j )θj
0(1 −θ0)n−j ≤α/2}
(8.7)
and
n1 := max{k ≤n :
n
∑
j=k
(n
j )θj
0(1 −θ0)n−j > α/2}
= min{k ≤n :
n
∑
j=k+1
(n
j )θj
0(1 −θ0)n−j ≤α/2} .
(8.8)
Proposition 8.3.1. Consider the statistical model (8.6) and let 0 < α < 1 be a significance
level. The hypothesis test T = (𝒳0, 𝒳1) with
𝒳0 := {n0, n0 + 1, . . . , n1 −1, n1}
and
𝒳1 = {0, . . . , n0 −1} ∪{n1 + 1, . . . , n}
(8.9)
is an α-significance test to check ℍ0 : θ = θ0 against ℍ1 : θ
̸= θ0. Here n0 and n1 are
defined as in eqs. (8.7) and (8.8).

8.3 Tests for binomial distributed populations
౪
387
Proof. Since Θ0 consists only of the point {θ0}, an arbitrary test T = (𝒳0, 𝒳1) is an
α-significance test if and only if Bn,θ0(𝒳1) ≤α. Now let T be as in the formulation of
the proposition. By the definition of the numbers n0 and n1, we obtain
Bn,θ0(𝒳1) =
n0−1
∑
j=0
(n
j )θj
0(1 −θ0)n−j +
n
∑
j=n1+1
(n
j )θj
0(1 −θ0)n−j ≤α
2 + α
2 = α ,
that is, as claimed, the test T := (𝒳0, 𝒳1) is an α-significance test.
Remark 8.3.2. In this test the critical region 𝒳1 consists of two parts or tails. Therefore,
this type of hypothesis test is called a two-sided test.
Remark 8.3.3. By the choice of n0 and n1, the regions 𝒳0 and 𝒳1 in eq. (8.9) are optimal
in the following sense: If ̃T = ( ̃
𝒳0,
̃
𝒳1) with
̃
𝒳0 := {n0 + 1, . . . , n1 −1}
and
̃
𝒳1 = {0, . . . , n0} ∪{n1, . . . , n} ,
then
Bn,θ0( ̃
𝒳1) =
n0
∑
j=0
(n
j )θj
0(1 −θ0)n−j +
n
∑
j=n1
(n
j )θj
0(1 −θ0)n−j > α
2 + α
2 = α .
Hence,
̃T is no longer an α-significance test. But note that we cannot exclude that the
tests with either
̃
𝒳0 := {n0, . . . , n1 −1}
or
̃
𝒳0 := {n0 + 1, . . . , n1}
are still α-significance tests.
Example 8.3.4. In an urn there is an unknown number of white and black balls. Let
θ ∈[0, 1] be the proportion of white balls. We conjecture that there are as many white as
black balls in the urn. That is, the null hypothesis is ℍ0 : θ = 0.5. To test this hypothesis,
we choose one after another 100 balls with replacement. In order to determine n0 and
n1 in this situation, let φ be defined as
φ(k) :=
k
∑
j=0
(100
j ) ⋅(1
2)
100
= B100,0.5({0, . . . , k}) .
Numerical calculations give
φ(36) = 0.00331856,
φ(37) = 0.00601649,
φ(38) = 0.0104894,
φ(39) = 0.0176001,
φ(40) = 0.028444,
φ(41) = 0.044313,
φ(42) = 0.0666053,
φ(43) = 0.096674,
φ(44) = 0.135627,
φ(45) = 0.184101,
φ(46) = 0.242059,
φ(47) = 0.30865,
φ(48) = 0.382177,
φ(49) = 0.460205 .

388
౪
8 Mathematical statistics
If the significance level is chosen as α = 0.1, we see that φ(41) ≤0.05, but φ(42) > 0.05.
Hence, by the definition of n0 in eq. (8.7), it follows that n0 = 42. Either by symmetry
or by similar calculations, for n1 defined in eq. (8.8), we get n1 = 58. Consequently, the
regions of acceptance and rejection are given by
𝒳0 = {42, 43, . . . , 57, 58}
and
𝒳1 = {0, . . . , 41} ∪{59, . . . , 100} .
For example, if we observe during 100 trials k white balls for some k < 42 or some k > 58,
then we may be quite sure that our null hypothesis is wrong, that is, the numbers of
white and black balls are significantly different. This assertion is 90 % sure. The power
function of this test (see Fig. 8.3) is given by
βT(θ) =
41
∑
k=0
(100
k )θk(1 −θ)100−k +
100
∑
k=59
(100
k )θk(1 −θ)100−k ,
0 < θ < 1 .
(8.10)
Figure 8.3: The power function βT in eq. (8.10) with significance level α = 0.1.
If we want to be more certain about the conclusion, we have to choose a smaller
significance level. For example, if we take α = 0.01, the values of φ imply n0 = 37 and
n1 = 63, hence in this case we conclude that
𝒳0 = {37, 38, . . . , 62, 63}
and
𝒳1 = {0, . . . , 36} ∪{64, . . . , 100} .
Again we see that a smaller bound for the probability of a type I error leads to an en-
largement of 𝒳0, thus, to an increase of the chance for a type II error.

8.3 Tests for binomial distributed populations
౪
389
One-sided tests: Now the null hypothesis is ℍ0 : θ ≤θ0 for some θ0 ∈[0, 1]. In the
context of Example 8.1.3, we claim that the proportion of white balls in the urn does not
exceed θ0. For instance, if θ0 = 1/2, then we want to test whether or not the number of
white balls is less than or equal to that of black.
Before we present a most powerful test for this situation, let us define a number n0
depending on θ0 and on the significance level 0 < α < 1, namely
n0 = max{k ≤n :
n
∑
j=k
(n
j )θj
0(1 −θ0)n−j > α}
= min{k ≤n :
n
∑
j=k+1
(n
j )θj
0(1 −θ0)n−j ≤α} .
(8.11)
Now we are in a position to state the most powerful one-sided α-test for a binomial dis-
tributed population.
Proposition 8.3.5. Suppose 𝒳= {0, . . . , n}, and let (𝒳, 𝒫(𝒳), Bn,θ)θ∈[0,1] be the statistical
model describing a binomial distributed population. Given 0 < α < 1, define n0 by (8.11)
and set 𝒳0 = {0, . . . , n0}, hence 𝒳1 = {n0 + 1, . . . , n}. Then T = (𝒳0, 𝒳1) is the most powerful
α-test to check the null hypothesis ℍ0 : θ ≤θ0 against ℍ1 : θ > θ0.
Proof. Fixing an arbitrary 0 ≤m ≤n, we define the region of acceptance 𝒳0 of a test T
by 𝒳0 = {0, . . . , m}. Its power function is given by
βT(θ) = Bn,θ(𝒳1) =
n
∑
j=m+1
(n
j )θj (1 −θ)n−j ,
0 ≤θ ≤1 .
(8.12)
To proceed further, we need the following lemma.
Lemma 8.3.6. The power function (8.12) is nondecreasing in [0, 1].
Proof. Suppose in an urn there are white, red, and black balls. Their proportions are θ1,
θ2 −θ1 and 1 −θ2 for some 0 ≤θ1 ≤θ2 ≤1. Choose n balls with replacement. Let X be the
number of chosen white balls, and Y the number of balls that were either white or red.
Then X is Bn,θ1-distributed, while Y is distributed according to Bn,θ2. Moreover, X ≤Y,
hence it follows that ℙ(X > m) ≤ℙ(Y > m), which leads to
βT(θ1) = Bn,θ1({m + 1, . . . , n}) = ℙ(X > m) ≤ℙ(Y > m)
= Bn,θ2({m + 1, . . . , n}) = βT(θ2) .
This being true for all θ1 ≤θ2 completes the proof of the lemma.

390
౪
8 Mathematical statistics
An application of Lemma 8.3.6 implies that the above test T is an α-significance test
if and only if
n
∑
j=m+1
(n
j )θj
0(1 −θ0)n−j = βT(θ0) = sup
θ≤θ0
βT(θ) ≤α .
In order to minimize the probability of a type II error, we have to choose 𝒳0 as small as
possible. That is, if we replace m by m −1, the modified test is no longer an α-test. Thus,
the optimal choice is m = n0 where n0 is defined by eq. (8.11). This completes the proof
of Proposition 8.3.5.
Example 8.3.7. Let us come back to the problem investigated in Example 8.1.3. Our null
hypothesis is ℍ0 : θ ≤1/2, that is, we claim that at most half of the balls are white. To test
ℍ0, we choose 100 balls and record their color. Let k be the number of observed white
balls. For which k must we reject ℍ0 with a confidence of 90 %?
Answer: Since
100
∑
k=56
(100
k )2−100 = 0.135627
and
100
∑
k=57
(100
k )2−100 = 0.096674 ,
for α = 0.1 the number n0 in eq. (8.11) equals n0 = 56. Consequently, the region of ac-
ceptance for the best 0.1-test is given by 𝒳0 = {0, . . . , 56}. Thus, whenever there are 57 or
more white balls among the chosen 100, the hypothesis has to be rejected. The probabil-
ity for a wrong decision is less than or equal to 0.1. The power function of this test T is
given by (compare Figure 8.4)
βT(θ) =
100
∑
k=57
(100
k )θk(1 −θ)100−k ,
0 < θ < 1 .
(8.13)
Figure 8.4: The power function βT in eq. (8.13) with significance level α = 0.1.

8.4 Tests for normally distributed populations
౪
391
Making the significance level smaller, for example, taking α = 0.01, since
100
∑
k=62
(100
k )2−100 = 0.0104894
and
100
∑
k=63
(100
k )2−100 = 0.00601649 ,
we obtain n0 = 62. Hence, if the number of white balls is 63 or larger, a rejection of ℍ0
is 99 % sure.
Remark 8.3.8. Example 8.3.7 emphasizes once more the dilemma of hypothesis testing.
The price one pays for higher confidence when rejecting ℍ0 is the increase of the like-
lihood of a type II error. For instance, replacing α = 0.1 by α = 0.01 in the previous
example leads to an enlargement of 𝒳0 from {0, . . . , 56} to {0, . . . , 62}. Thus, if we observe
60 white balls, we reject ℍ0 in the former case, but we cannot reject it in the latter one.
This once more stresses the fact that an observation of an x ∈𝒳0 does not guarantee
that ℍ0 is true. It only means that the observed sample does not allow us to reject the
hypothesis with high probability.
Summary: The model for testing binomial distributed populations is (𝒳, 𝒫(𝒳), Bn,θ)θ∈[0,1] where
𝒳= {0, . . . , n} . Given θ0 ∈[0, 1], the hypotheses in the two-sided case are ℍ0 : θ = θ0 against ℍ1 : θ
̸= θ0 .
If
n0 = min{k ≤n : Bn,θ0({0, . . . , k}) > α
2 }
and
n1 = max{k ≤n : Bn,θ0({k, . . . , n}) > α
2 } ,
then 𝒳0 = {n0, . . . , n1} is the region of acceptance of an α-test checking ℍ0 against ℍ1.
In the one-sided case ℍ0 : θ ≤θ0 against ℍ1 : θ > θ0 choose 𝒳0 = {0, . . . , n0} where now
n0 = max{k ≤n : Bn,θ0({k, . . . , n}) > α} .
8.4 Tests for normally distributed populations
In this section we always assume 𝒳= ℝn. That is, our samples are vectors x = (x1, . . . , xn)
with xj ∈ℝ. Given a sample x ∈ℝn, we derive from it the following quantities that will
soon play a crucial role.
Definition 8.4.1. If x = (x1, . . . , xn) ∈ℝn, then we set
̄x := 1
n
n
∑
j=1
xj ,
s2
x :=
1
n −1
n
∑
j=1
(xj −̄x)2,
and
σ2
x := 1
n
n
∑
j=1
(xj −̄x)2 .
(8.14)
The number ̄x is said to be the sample mean of x, while s2
x and σ2
x are said to be the unbiased sample
variance and the (biased) sample variance of the vector x, respectively.

392
౪
8 Mathematical statistics
Analogously, if X = (X1, . . . , Xn) is an n-dimensional random vector,3 then we define the
corresponding expressions pointwise. For instance, we have
̄X(ω) := 1
n
n
∑
j=1
Xj(ω)
and
s2
X(ω) :=
1
n −1
n
∑
j=1
(Xj(ω) −̄X(ω))
2 .
8.4.1 Fisher’s theorem
We are going to prove important properties of normally distributed populations. They
turn out to be the basis for all hypothesis tests in the normally distributed case. The
starting point is a crucial lemma going back to Ronald Aylmer Fisher (1890–1962).
Lemma 8.4.2 (Fisher’s lemma). Let Y1, . . . , Yn be independent 𝒩(0, 1)-distributed random
variables and let B = (βij)n
i,j=1 be a unitary n × n matrix. The random variables Z1, . . . , Zn
are defined as
Zi :=
n
∑
j=1
βijYj ,
1 ≤i ≤n .
They possess the following properties:
(i)
The variables Z1, . . . , Zn are also independent and 𝒩(0, 1)-distributed.
(ii) For m < n, let the (random) quadratic form Q on ℝn be defined by
Q :=
n
∑
j=1
Y 2
j −
m
∑
i=1
Z2
i .
Then Q is independent of all Z1, . . . , Zm and, moreover, distributed according to χ2
n−m.
Proof. Assertion (i) was already proven in Proposition 6.1.19.
Let us verify (ii). The matrix B is unitary, thus it preserves the length of vectors in ℝn.
Applying this to Y = (Y1, . . . , Yn) and Z = BY gives
n
∑
i=1
Z2
i = |Z|2
2 = |BY|2
2 = |Y|2
2 =
n
∑
j=1
Y 2
j ,
which leads to
Q = Z2
m+1 + ⋅⋅⋅+ Z2
n .
(8.15)
3 To simplify the notation, now and later on, we denote random vectors by X, not by ⃗X as we did before.
This should not lead to confusion. For example, ⃗X does not look very nice.

8.4 Tests for normally distributed populations
౪
393
By virtue of (i), the random variables Z1, . . . , Zn are independent, hence by eq. (8.15) and
Remark 4.1.10 the quadratic form Q is independent of Z1, . . . , Zm.
Recall that Zm+1, . . . , Zn are independent 𝒩(0, 1)-distributed. Thus, in view of
eq. (8.15), Proposition 4.6.10 implies that Q is χ2
n−m-distributed. Observe that Q is the
sum of n −m squares.
Now we are in a position to state and prove one of the most important results in
Mathematical Statistics.
Proposition 8.4.3 (Fisher’s theorem). Suppose X1, . . . , Xn are independent and distributed
according to 𝒩(μ, σ2) for some μ ∈ℝand some σ2 > 0. Then the following are valid:
√n
̄X −μ
σ
is 𝒩(0, 1)-distributed;
(8.16)
(n −1) s2
X
σ2
is χ2
n−1-distributed;
(8.17)
√n
̄X −μ
sX
is tn−1-distributed, where sX := +√s2
X .
(8.18)
Furthermore, ̄X and s2
X are independent random variables.4
Proof. Let us begin with the proof of assertion (8.16). Since the Xjs are independent
and 𝒩(μ, σ2)-distributed, by Proposition 4.6.11 their sum X1 + ⋅⋅⋅+ Xn possesses an
𝒩(nμ, nσ2) distribution. Consequently, an application of Proposition 4.2.3 implies that
̄X is 𝒩(μ, σ2/n)-distributed, hence, another application of Proposition 4.2.3 tells us that
̄X−μ
σ/√n is standard normal. This completes the proof of statement (8.16).
We turn now to the verification of the remaining assertions. Letting
Yj :=
Xj −μ
σ
,
1 ≤j ≤n ,
(8.19)
the random variables Y1, . . . , Yn are independent 𝒩(0, 1)-distributed. Moreover, their
(unbiased) sample variance may be calculated by
s2
Y =
1
n −1
n
∑
j=1
(Yj −̄Y)2 =
1
n −1{
n
∑
j=1
Y 2
j −2 ̄Y
n
∑
j=1
Yj + n ̄Y 2}
=
1
n −1{
n
∑
j=1
Y 2
j −2n ̄Y 2 + n ̄Y 2} =
1
n −1{
n
∑
j=1
Y 2
j −(√n ̄Y)2}.
(8.20)
4 Recall that
̄X = 1
n
n
∑
j=1
Xj
and
s2
X =
1
n −1
n
∑
j=1
(Xj −̄X)2 .

394
౪
8 Mathematical statistics
To proceed further, set b1 := (n−1/2, . . . , n−1/2), and note that b1 is a normalized n-dimen-
sional vector, that is, we have |b1|2 = 1. Let E ⊆ℝn be the (n −1)-dimensional sub-
space consisting of elements that are perpendicular to b1. Choosing an orthonormal
basis b2, . . . , bn in E, by the choice of E, the vectors b1, . . . , bn form an orthonormal ba-
sis in ℝn. If bi = (βi1, . . . , βin), 1 ≤i ≤n, let B be the n × n-matrix with entries βij,
that is, the vectors b1, . . . , bn are the rows of B. Since (bi)n
i=1 are orthonormal, B is uni-
tary.
As in Lemma 8.4.2, define Z1, . . . , Zn by
Zi :=
n
∑
j=1
βijYj ,
1 ≤i ≤n ,
and the quadratic form Q (with m = 1) as
Q :=
n
∑
j=1
Y 2
j −Z2
1 .
Because of Lemma 8.4.2, the quadratic form Q is χ2
n−1-distributed and, furthermore, it is
independent of Z1. By the choice of B and b1,
β11 = ⋅⋅⋅= β1n = n−1/2 ,
hence Z1 = n1/2 ̄Y and, due to eq. (8.20), this leads to
Q =
n
∑
j=1
Y 2
j −(n1/2 ̄Y)
2 = (n −1) s2
Y .
This observation implies (n −1) s2
Y is χ2
n−1-distributed and, moreover, (n −1)s2
Y and Z1 are
independent, thus also s2
Y and Z1.
The choice of the Yjs in eq. (8.19) immediately implies ̄Y =
̄X−μ
σ , hence
(n −1) s2
Y =
n
∑
j=1
(Yj −̄Y)2 =
n
∑
j=1
(
Xj −μ
σ
−
̄X −μ
σ
)
2
= s2
X
σ2 (n −1) ,
which proves assertion (8.17).
Recall that Z1 = n1/2 ̄Y = n1/2 ̄X−μ
σ , which leads to
̄X = n−1/2 σZ1 + μ. Thus, because
of Proposition 4.1.9, the independence of s2
Y = s2
X/σ2 and Z1 implies that s2
X and
̄X are
independent as well.
It remains to prove statement (8.18). We already know that V := √n
̄X−μ
σ
is stan-
dard normal, and W := (n −1) s2
X/σ2 is χ2
n−1-distributed. Since they are independent, by
Proposition 4.6, applied with n −1, we get

8.4 Tests for normally distributed populations
౪
395
√n
̄X −μ
sX
=
V
√1
n−1 W
is tn−1-distributed .
This implies assertion (8.18) and completes the proof of the proposition.
Remark 8.4.4. It is important to mention that the random variables X1, . . . , Xn satisfy
the assumptions of Proposition 8.4.3 if and only if the vector (X1, . . . , Xn) is 𝒩(μ, σ2)⊗n-
distributed or, equivalently, if its probability distribution is 𝒩( ⃗μ, σ2In).
Summary: Let X1, . . . , Xn be independent and 𝒩(μ, σ2)-distributed. Then
√n
̄X −μ
σ
∼𝒩(0, 1),
(n −1) s2
X
σ2 ∼χ2
n−1,
√n
̄X −μ
sX
∼tn−1 .
Furthermore, ̄X and s2
X are independent random variables.
8.4.2 Quantiles
Let X be a (real-valued) random variable. Given a number 0 < β < 1, a uβ ∈ℝis said to
be a β-quantile of X provided that
ℙ{X ≤uβ} ≥β
and
ℙ{X ≥uβ} ≥1 −β .
Another way to write this is
ℙX((−∞, uβ]) ≥β
and
ℙX([uβ, ∞)) ≥1 −β .
In particular, this implies that the quantile only depends on the distribution of a random
variable, not on the way it is defined. Since
ℙ{X ≥uβ} = 1 −ℙ{X < uβ} ,
the condition for the quantile may also be formulated as
ℙ{X ≤uβ} ≥β
and
ℙ{X < uβ} ≤β .
Example 8.4.5. Suppose that ℙ{X = 0} = ℙ{X = 1} = 1
2. Then there is no β-quantile in
the case β
̸= 1
2. Why? This is due to the fact that the distribution function t 󳨃→ℙ{X ≤t}
attains only the values 0, 1
2, and 1. If β = 1/2, then every number u ∈[0, 1) satisfies
ℙ{X ≤u} ≥1
2
and
ℙ{X < u} ≤1
2 ,
hence each u ∈[0, 1) is a (1/2)-quantile of X.

396
౪
8 Mathematical statistics
This example tells us two facts: quantiles do not always exist and, moreover, if they
exist, then they need not be unique.
The situation becomes completely different if X possesses a positive distribution
density.
Proposition 8.4.6. Suppose that there this a positive density p such that
FX(t) = ℙ{X ≤t} =
t
∫
−∞
p(x)dx ,
t ∈ℝ.
Then for each β ∈(0, 1), there is a unique β-quantile uβ. That is, there is a unique uβ ∈ℝ
for which
FX(uβ) = ℙ{X ≤uβ} =
uβ
∫
−∞
p(x)dx = β .
(8.21)
Proof. Under these assumptions about X, its distribution function FX is a one-to-one
mapping from ℝonto (0, 1). Hence, its inverse function F−1
X exists and uβ = F−1
X (β) is the
unique number satisfying (8.21).
Remark 8.4.7. Of course, Proposition 8.4.6 remains valid if there are a ∈ℝand/or b ∈ℝ
such that the density p satisfies p(x) = 0 if x < a and/or p(x) = 0 if x > b. In this case the
quantile uβ satisfies either uβ > a or uβ < b, respectively.
Let us now introduce some quantiles which will play an important later on. The first
quantiles we consider are those of the standard normal distribution.
Definition 8.4.8. Let Φ be the distribution function of 𝒩(0, 1), as it was introduced in Definition 1.6.2.
For a given β ∈(0, 1), the β-quantile zβ of the standard normal distribution is the unique real number
satisfying
Φ(zβ) = β
or, equivalently,
zβ = Φ−1(β) .
Another way to define is as follows. Let X be a standard normal random variable. Then
zβ is the unique real number such that
ℙ{X ≤zβ} = β .
The following properties of zβ will be used later on. Compare also Figure 8.5 for the
assertions.
Proposition 8.4.9. Let X be standard normally distributed. Then the following are valid:
1.
We have z1/2 = 0 , zβ < 0 for 0 < β < 1/2 , and zβ > 0 for 1/2 < β < 1 .
2.
For all 0 < β < 1, it follows that ℙ{X ≥zβ} = 1 −β .
3.
If 0 < β < 1, then z1−β = −zβ .
4.
For 0 < α < 1 we have ℙ{|X| ≥z1−α/2} = α .

8.4 Tests for normally distributed populations
౪
397
Figure 8.5: The assertions of Proposition 8.4.9.
Proof. The first property easily follows from Φ(0) = 1/2, hence Φ(t) > 1/2 if and only if
t > 0.
Let X be standard normal. Then ℙ{X ≥zβ} = 1 −ℙ{X ≤zβ} = 1 −β, which proves
the second assertion.
Since −X is standard normal as well, by property 2 it follows that
ℙ{X ≤−zβ} = ℙ{−X ≥zβ} = ℙ{X ≥zβ} = 1 −β = ℙ{X ≤z1−β} ,
hence z1−β = −zβ as asserted.
To prove the fourth assertion, note that properties 2 and 3 imply
ℙ{|X| ≥z1−α/2} = ℙ{X ≤−z1−α/2
or
X ≥z1−α/2}
= ℙ{X ≤−z1−α/2} + ℙ{X ≥z1−α/2}
= ℙ{X ≤zα/2} + ℙ{X ≥z1−α/2} = α/2 + α/2 = α .
Here we used 1 −α/2 > 1/2 implying z1−α/2 > 0, hence the events {X ≤−z1−α/2} and
{X ≥z1−α/2} are disjoint.
To get an impression about the size of the quantiles zβ, let us state a few of them.
β
0.999
0.995
0.99
0.95
0.9
0.8
0.75
zβ
3.0902
2.5758
2.3263
1.6449
1.2816
0.8416
0.6745

398
౪
8 Mathematical statistics
The values for small β > 0 follow by z1−β = −zβ. So, for example,
z0.1 = −z0.9 = −1.2816 .
The next quantiles, needed later on, are those of a χ2
n distribution.
Definition 8.4.10. Let X be distributed according to χ2
n and let 0 < β < 1. The unique (positive) number
χ2
n;β satisfying
ℙ{X ≤χ2
n;β} = β
is called the β-quantile of the χ2
n distribution.
Two other, equivalent, ways to introduce these quantiles are as follows:
1.
If X, . . . , Xn are independent standard normal, then
ℙ{X2
1 + ⋅⋅⋅+ X2
n ≤χ2
n;β} = β .
2.
The quantile χ2
n;β satisfies
1
2n/2Γ(n/2)
χ2
n;β
∫
0
xn/2−1 e−x/2dx = β .
For later purposes, we mention also the following property. If 0 < α < 1, then for any
χ2
n-distributed random variable X (see Figure 8.6),
ℙ{X ∉[χ2
n;α/2 , χ2
n;1−α/2]} = α .
(8.22)
Figure 8.6: Graphic presentation of formula (8.22) for χ2
4.
In a similar way, we define now the quantiles of Student’s tn and of Fisher’s Fm,n distri-
butions. For their descriptions, we refer to Definitions 4.7.6 and 4.7.13, respectively.

8.4 Tests for normally distributed populations
౪
399
Definition 8.4.11. Let X be tn-distributed and let Y be distributed according to Fm,n. For β ∈(0, 1) the
β-quantiles tn;β and Fm,n;β of the tn and Fm,n distributions are the unique numbers satisfying
ℙ{X ≤tn;β} = β
and
ℙ{Y ≤Fm,n;β} = β .
Remark 8.4.12. Let X be tn-distributed. Then −X is tn-distributed as well, hence
ℙ{X ≤s} = ℙ{−X ≤s} for s ∈ℝ. Therefore, as in the case of the normal distribution, we
get −tn;β = tn;1−β,and also
ℙ{|X| > tn;1−α/2} = ℙ{|X| ≥tn;1−α/2} = α .
(8.23)
Remark 8.4.13. Another possibility to introduce the β-quantile of the tn distribution is
as follows: if X and X1, . . . , Xn are independent standard normal variables, then
ℙ{
X
√1
n ∑n
i=1 X2
i
≤tn;β} = β .
Similarly, one may characterize the quantiles of the Fm,n distribution in the follow-
ing way. Let X and Y be independent and distributed according to χ2
m and χ2
n, respec-
tively. Then the β-quantile Fm,n;β is the unique number satisfying
ℙ{X/m
Y/n ≤Fm,n;β} = β .
Note that the quantiles Fm,n;β are positive numbers while the tn;β are negative if
0 < β < 1/2 and positive in the case 1/2 < β < 1.
If s > 0, then
ℙ{X/m
Y/n ≤s} = ℙ{ Y/n
X/m ≥1
s} = 1 −ℙ{ Y/n
X/m ≤1
s} ,
which immediately implies
Fm,n;β =
1
Fn,m;1−β
.
Summary: The following β-quantiles will play an important role later on:
X ∼𝒩(0, 1)
⇒
ℙ{X ≤zβ} = β,
X ∼χ2
n
⇒
ℙ{X ≤χn;β} = β,
X ∼tn
⇒
ℙ{X ≤tn;β} = β,
X ∼Fm,n
⇒
ℙ{X ≤Fm,n;β} = β.

400
౪
8 Mathematical statistics
8.4.3 Z-tests or Gauss tests
Suppose we have an item of unknown length. In order to get some information about its
length, we measure the item n times with an instrument of known accuracy. As sample
we get a vector x = (x1, . . . , xn), where xj is the value obtained in the jth measurement.
These measurements were executed independently, thus, we may assume that the xjs
are independent 𝒩(μ, σ2
0)-distributed with known σ2
0 > 0 and unknown length μ ∈ℝ.
Therefore, the describing statistical model is
(ℝn, ℬ(ℝn), 𝒩(μ, σ2
0)
⊗n)μ∈ℝ= (ℝn, ℬ(ℝn), 𝒩( ⃗μ, σ2
0In))μ∈ℝ.
From the hypothesis, two types of test apply in this case. We start with the so-called one-
sided Z-test (also called one-sided Gauss test). Here the null hypothesis is ℍ0 : μ ≤μ0,
where μ0 ∈ℝis a given real number. Consequently, the alternative hypothesis is
ℍ1 : μ > μ0, that is, Θ0 = (−∞, μ0] while Θ1 = (μ0, ∞). In the above context, this
says that we claim that the length of the item is less than or equal to a given μ0, and to
check this we measure the item n times.
Proposition 8.4.14. Let α ∈(0, 1) be a given significance level. Then T = (𝒳0, 𝒳1) with5
𝒳0 := {x ∈ℝn : ̄x ≤μ0 + n−1/2 σ0 z1−α}
and with
𝒳1 := {x ∈ℝn : ̄x > μ0 + n−1/2 σ0 z1−α}
is an α-significance test to check ℍ0 : μ ≤μ0 against ℍ1 : μ > μ0. Here z1−α denotes the
(1 −α)-quantile introduced in Definition 8.4.8.
Proof. The assertion of Proposition 8.4.14 says that
sup
μ≤μ0
ℙμ(𝒳1) = sup
μ≤μ0
𝒩(μ, σ2
0)
⊗n(𝒳1) ≤α .
To verify this, let us choose an arbitrary μ ≤μ0 and define S : ℝn →ℝby
S(x) := √n ̄x −μ
σ0
,
x ∈ℝn .
(8.24)
Regard S as a random variable on the probability space (ℝn, ℬ(ℝn), 𝒩(μ, σ2
0)⊗n). We
claim that S is a standard normally distributed random variable. This fact is crucial.
Therefore, let us give a more detailed reasoning.
5 Recall that ̄x denotes the arithmetic mean of an vector x = (x1, . . . , xn) in ℝn.

8.4 Tests for normally distributed populations
౪
401
Define random variables Xj on the probability space (ℝn, ℬ(ℝn), 𝒩(μ, σ2
0)⊗n) by
Xj(x) = xj, where x = (x1, . . . , xn). Then the random vector X = (X1, . . . , Xn) is the identity
on ℝn, hence 𝒩(μ, σ2
0)⊗n-distributed. In view of Remark 8.4.4 and since
S(x) = √n
̄X(x) −μ
σ0
,
assertion (8.16) applies for S, that is, it is 𝒩(0, 1)-distributed. Consequently,
𝒩(μ, σ2
0)
⊗n{x ∈ℝn : S(x) > z1−α} = α .
(8.25)
Since μ ≤μ0, we have
𝒳1 = {x ∈ℝn : ̄x > μ0 + n−1/2 σ0 z1−α}
⊆{x ∈ℝn : ̄x > μ + n−1/2 σ0 z1−α} = {x ∈ℝn : S(x) > z1−α} ,
hence, by eq. (8.25), it follows that
𝒩(μ, σ2
0)
⊗n(𝒳1) ≤𝒩(μ, σ2
0)
⊗n{x ∈ℝn : S(x) > z1−α} = α .
This completes the proof.
How does the power function of the Z-test in Proposition 8.4.14 look like? If S is as
in eq. (8.24), then, according to Definition 8.2.11,
βT(μ) = 𝒩(μ, σ2
0)
⊗n(𝒳1) = N(μ, σ2
0)
⊗n{x ∈ℝn : √n ̄x −μ0
σ0
> z1−α}
= 𝒩(μ, σ2
0)
⊗n{x ∈ℝn : S(x) > z1−α + (μ0 −μ) √n
σ0
}
= 1 −Φ(z1−α + (μ0 −μ) √n
σ0
) = Φ(zα + (μ −μ0) √n
σ0
) .
In particular, βT is increasing on ℝwith βT(μ0) = α. Moreover, we see that βT(μ) < α if
μ < μ0, and βT(μ) > α for μ > μ0. See Figure 8.7 for an example of the power function.
While the critical region of a one-sided Z-test is an interval, in the case of the two-
sided Z-test it is the union of two intervals. Here the null hypothesis is ℍ0 : μ = μ0,
hence the alternative hypothesis is given as ℍ1 : μ
̸= μ0.
Proposition 8.4.15. The test T = (𝒳0, 𝒳1), where
𝒳0 := {x ∈ℝn : μ0 −n−1/2 σ0 z1−α/2 ≤̄x ≤μ0 + n−1/2 σ0 z1−α/2}
= {x ∈ℝn : √n | ̄x −μ0|
σ0
≤z1−α/2}
and 𝒳1 = ℝn \ 𝒳0, is an α-significance test for ℍ0 : μ = μ0 against ℍ1 : μ
̸= μ0.

402
౪
8 Mathematical statistics
Figure 8.7: Power function of the one-sided Z-test T with α = 0.1, μ0 = 2, σ0 = 1, and n = 10.
Proof. Since here Θ0 = {μ0}, the proof becomes easier than in the one-sided case. We
only have to verify that
𝒩(μ0, σ2
0)
⊗n(𝒳1) ≤α .
(8.26)
Regarding S, defined by
S(x) := √n ̄x −μ0
σ0
,
as a random variable on (ℝn, ℬ(ℝn), 𝒩(μ0, σ2
0)⊗n), by the same arguments as in the pre-
vious proof, it is standard normally distributed. Thus, using assertion (4) of Proposi-
tion 8.4.9, we obtain
𝒩(μ0, σ2
0)
⊗n(𝒳1) = 𝒩(μ0, σ2
0)
⊗n{x ∈ℝn : 󵄨󵄨󵄨󵄨S(x)󵄨󵄨󵄨󵄨> z1−α/2} = α .
Of course, this completes the proof.
Recall that βT(μ) is the probability to observe an x = (x1, . . . , xn) in the critical region
𝒳1 provided μ is the “true” mean value. As can be seen in Fig. 8.8, this probability is small
(equal α) if μ = μ0 and becomes rapidly big for μ different of the suggested μ0.
Remark 8.4.16 (Important!). How to apply the one- or two-sided Z-test in a concrete sit-
uation? If the hypothesis is either ℍ0 : μ ≤μ0 or ℍ0 : μ = μ0, then the regions 𝒳1 of
rejection are either
{x ∈ℝn : √n ̄x −μ0
σ0
> z1−α}
or
{x ∈ℝn : √n | ̄x −μ0|
σ0
> z1−α/2} .

8.4 Tests for normally distributed populations
౪
403
Figure 8.8: Power function of the two-sided Z-test T with α = 0.1, μ0 = 2, σ0 = 1, and n = 10.
By the definition of the quantile, the former is equivalent to
Φ(√n ̄x −μ0
σ0
) > 1 −α
⇔
Φ(√n μ0 −̄x
σ0
) < α .
Similarly, in the two-sided test, one has x ∈𝒳1 if and only if either
Φ(√n ̄x −μ0
σ0
) < α/2
or
Φ(√n μ0 −̄x
σ0
) < α/2 .
Suppose now we observed n values x = (x1, . . . , xn) which are independent and 𝒩(μ, σ2
0)-
distributed for some unknown μ ∈ℝ. If
Φ(√n μ0 −̄x
σ0
) < α
⇒
reject
ℍ0 : μ ≤μ0 .
Similarly, we have to reject ℍ0 : μ = μ0 if either
Φ(√n ̄x −μ0
σ0
) < α/2
or
Φ(√n μ0 −̄x
σ0
) < α/2 .
In both cases (one- and two-sided test) the probability for an erroneous decision is
bounded by α > 0.
Example 8.4.17. Suppose the hypothesis is ℍ0 : μ ≤μ0 and our calculations lead to
√n μ0 −̄x
σ0
= −2.13 .
Since Φ(−2.13) ≈0.0165858, we may reject ℍ0 with significance level α whenever
α > 0.0165858. But we cannot reject it with smaller risk. For example, if α = 0.01, then

404
౪
8 Mathematical statistics
the result does not contradict the hypothesis. There is a great likelihood that ℍ0 is
wrong, but if we want to be very sure that this is so, we cannot derive this from the
obtained result.
8.4.4 t-tests
The problem is similar to that considered in the case of the Z-test. But there is one im-
portant difference. We do no longer assume that the variance is known, which will be
so in most cases. Therefore, this test is more realistic than the Z-test.
The starting point is the statistical model
(ℝn, ℬ(ℝn), 𝒩(μ, σ2)
⊗n)(μ,σ2)∈ℝ×(0,∞) .
Observe that the unknown parameter is now a vector (μ, σ2) ∈ℝ× (0, ∞). We begin by
investigating the one-sided t-test. Given some μ0 ∈ℝ, the null hypothesis is as before,
that is, we have ℍ0 : μ ≤μ0. In the general setting, this means Θ0 = (−∞, μ0] × (0, ∞),
while Θ1 = (μ0, ∞) × (0, ∞).
To formulate the next result, let us shortly recall the following notations. If s2
x de-
notes the unbiased sample variance, as defined in eq. (8.14), set sx := +√s2
x. Further-
more, tn−1;1−α denotes the (1 −α)-quantile of the tn−1-distribution, as introduced in Defi-
nition 8.4.11.
Proposition 8.4.18. Given α ∈(0, 1), the regions 𝒳0 and 𝒳1 in ℝn are defined by
𝒳0 := {x ∈ℝn : √n ̄x −μ0
sx
≤tn−1;1−α}
and 𝒳1 = ℝn \ 𝒳0. With this choice of 𝒳0 and 𝒳1, the test T = (𝒳0, 𝒳1) is an α-significance
test for ℍ0 : μ ≤μ0 against ℍ1 : μ > μ0.
Proof. Given μ ≤μ0, define the random variable S on (ℝn, ℬ(ℝn), 𝒩(μ, σ2)⊗n) as
S(x) := √n ̄x −μ
sx
,
x ∈ℝn .
Property (8.18) implies that S is tn−1-distributed, hence by the definition of the quantile
tn−1;1−α, it follows that
𝒩(μ, σ2)
⊗n{x ∈ℝn : S(x) > tn−1;1−α} = α .
From μ ≤μ0, we easily derive
𝒳1 ⊆{x ∈ℝn : S(x) > tn−1;1−α} ,

8.4 Tests for normally distributed populations
౪
405
thus, as asserted,
sup
μ≤μ0
𝒩(μ, σ2)
⊗n(𝒳1) ≤𝒩(μ, σ2)
⊗n{x ∈ℝn : S(x) > tn−1;1−α} = α .
As in the case of the Z-test, the null hypothesis of the two-sided t-test is ℍ0 : μ = μ0
for some μ0 ∈ℝ. Again, we do not assume that the variance is known.
A two-sided t-test with significance level α may be constructed as follows.
Proposition 8.4.19. Given α ∈(0, 1), define regions 𝒳0 and 𝒳1 in ℝn by
𝒳0 := {x ∈ℝn : √n
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
̄x −μ0
sx
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
≤tn−1;1−α/2}
and 𝒳1 = ℝn \ 𝒳0. Then T = (𝒳0, 𝒳1) is an α-significance test for ℍ0 : μ = μ0 against
ℍ1 : μ
̸= μ0.
Proposition 8.4.19 is proven by similar methods, as we have used for the proofs of
Propositions 8.4.15 and 8.4.18. Therefore, we decline to prove it here.
Example 8.4.20. We claim a certain workpiece has a length of 22 inches. Thus, the null
hypothesis is ℍ0 : μ = 22. To check ℍ0, we measure the piece 10 times under the same
conditions. The 10 values we obtained are (in inches)
22.17,
22.11,
22.10,
22.14,
22.02,
21.95,
22.02,
22.08,
21.98,
22.15
Do these values allow us to reject the hypothesis or do they confirm it? We have
̄x = 22.072
and
sx = 0.07554248 ,
hence √10
̄x −22
sx
= 3.013986 .
If we choose the significance level α = 0.05, we have to investigate the quantile t9;0.975,
which equals t9;0.975 = 2.26. This lets us conclude the observed vector x = (x1, . . . , x10)
belongs to 𝒳1, and we may reject ℍ0. Consequently, with a confidence of 95 % we may
say, μ
̸= 22.
Another way to argue is as follows: Let S(x) =
̄x−22
sx
= 3.013986. Then we have S(x) ≤
t9,0.975 if and only if for a t9-distributed X it follows that
FX(S(x)) = ℙ{X ≤S(x)} ≤0.975 .
But in our case FX(S(x)) = 0.992687. So, we also get by this argument that ℍ0 has to be
rejected.
Remark 8.4.21. If we plug these 10 values, together with μ0 = 22, into a mathematical
program, the result will be a number α0 = 0.00128927. What does this number tell us?
It says the following. If we have chosen a significance level α > α0, then we have to

406
౪
8 Mathematical statistics
reject ℍ0. But, if the chosen α satisfies α < α0, then we fail to reject ℍ0. In our case we
had α = 0.05 > 0.00128927 = α0, hence we may reject ℍ0.
Thus, the price we pay for choosing a higher certainty and taking α < α0 is that
we are no longer able to reject the hypothesis ℍ0. It is as in the daily life: if one
wants to be 99.9 %-sure of not having a car accident, the best way is to avoid driving a
car.
8.4.5 χ2-tests for the variance
The aim of this section is to get some information about the (unknown) variance of a
normal distribution. Again we have to distinguish between the following two cases. The
expected value is known or, otherwise, the expected value is unknown.
Let us start with the former case, that is, we assume that the expected value is known
to be some μ0 ∈ℝ. Then the statistical model is
(ℝn, ℬ(ℝn), 𝒩(μ0, σ2)
⊗n)σ2>0.
In the one-sided χ2-test, the null hypothesis is ℍ0 : σ2 ≤σ2
0, for some given σ2
0 > 0,
while in the two-sided χ2-test we claim that ℍ0 : σ2 = σ2
0.
Proposition 8.4.22. In the one-sided setting, an α-significance χ2-test T = (𝒳0, X1) is given
by
𝒳0 := {x ∈ℝn :
n
∑
j=1
(xj −μ0)2
σ2
0
≤χ2
n;1−α} .
For the two-sided case, choose
𝒳0 := {x ∈ℝn : χ2
n;α/2 ≤
n
∑
j=1
(xj −μ0)2
σ2
0
≤χ2
n;1−α/2} ,
(8.27)
to obtain an α-significance test. In both cases, the critical region is 𝒳1 := ℝn \ 𝒳0.
Proof. We prove the assertion only in the (slightly more difficult) one-sided case. For an
arbitrarily chosen σ2 ≤σ2
0, let 𝒩(μ0, σ2)⊗n be the underlying probability measure. We
define now the random variables Xj : ℝn →ℝas Xj(x) = xj for x = (x1, . . . , xn). Then
the Xjs are independent 𝒩(μ0, σ2)-distributed. The normalization Yj :=
Xj−μ0
σ
leads to
independent standard normal Yjs. Thus, if
S :=
n
∑
j=1
(Xj −μ0)2
σ2
=
n
∑
j=1
Y 2
j ,

8.4 Tests for normally distributed populations
౪
407
then, by Proposition 4.6.10, the random variable S is χ2
n-distributed. By the definition of
quantile, we arrive at
𝒩(μ0, σ2)
⊗n{x ∈ℝn : S(x) > χn;1−α} = α .
Since σ2 ≤σ2
0, it follows that
𝒳1 ⊆{x ∈ℝn : S(x) > χn;1−α} ,
hence 𝒩(μ0, σ2)⊗n(𝒳1) ≤α. This proves, as asserted, that T = (𝒳0, 𝒳1) is an α-significance
test.
Let us now turn to the case where the expected value is unknown. Here the statistical
model is given by
(ℝn, ℬ(ℝn), 𝒩(μ, σ2)
⊗n)(μ,σ2)∈ℝ×(0,∞) .
In the one-sided case, the null hypothesis is ℍ0 : θ ≤θ0. Thus, the parameter set
Θ = ℝ× (0, ∞) splits into Θ = Θ0 ∪Θ1 with
Θ0 = ℝ× (0, σ2
0]
and
Θ1 = ℝ× (σ2
0, ∞) .
In the two-sided case, the null hypothesis is ℍ0 : θ = θ0. Hence, in this case we have
Θ0 = ℝ× {σ2
0}
and
Θ1 = ℝ× [(0, σ2
0) ∪(σ2
0, ∞)] .
Proposition 8.4.23. In the one-sided case, an α-significance test T = (𝒳0, X1) is given by
𝒳0 := {x ∈ℝn : (n −1) s2
x
σ2
0
≤χ2
n−1;1−α} .
In the two-sided case, choose the region of acceptance as
𝒳0 := {x ∈ℝn : χ2
n−1;α/2 ≤(n −1) s2
x
σ2
0
≤χ2
n−1;1−α/2}
(8.28)
to get an α-significance test. Again, the critical regions are given by 𝒳1 := ℝn \ 𝒳0.
Proof. The proof is very similar to that of Proposition 8.4.22, but with some important
difference. Here we have to set
S(x) := (n −1) s2
x
σ2 ,
x ∈ℝn .
Then property (8.17) applies, and it lets us conclude that S is χ2
n−1-distributed, provided
that 𝒩(μ, σ2)⊗n is the true probability measure. After that observation the proof is com-
pleted as that of Proposition 8.4.22.

408
౪
8 Mathematical statistics
Summary: The most important one-sample α-significance tests for normally distributed
populations are
Name
Parameters
Hypotheses
Critical region 𝒳1
One-sided Z-test
σ2 > 0 known
ℍ0 : μ ≤μ0
ℍ1 : μ > μ0
{x ∈ℝn : √n
̄x−μ0
σ
> z1−α}
Two-sided Z-test
σ2 > 0 known
ℍ0 : μ = μ0
ℍ1 : μ
̸= μ0
{x ∈ℝn : |√n
̄x−μ0
σ | > z1−α/2}
One-sided t-test
σ2 > 0 unknown
ℍ0 : μ ≤μ0
ℍ1 : μ > μ0
{x ∈ℝn : √n
̄x−μ0
sx
> tn−1; 1−α}
Two-sided t-test
σ2 > 0 unknown
ℍ0 : μ = μ0
ℍ1 : μ
̸= μ0
{x ∈ℝn : |√n
̄x−μ0
sx | > tn−1; 1−α/2}
One-sided χ2-test with
known mean value
μ ∈ℝknown
ℍ0 : σ2 ≤σ2
0
ℍ1 : σ2 > σ2
0
{x ∈ℝn : ∑n
i=1
(xi−μ)2
σ2
0
> χ2
n; 1−α}
Two-sided χ2-test with
known mean value
μ ∈ℝknown
ℍ0 : σ2 = σ2
0
ℍ1 : σ2
̸= σ2
0
{x ∈ℝn : ∑(xi−μ)2
σ2
0
< χ2
n; α/2} ∪
{x ∈ℝn : ∑(xi−μ)2
σ2
0
> χ2
n; 1−α/2}
One-sided χ2-test with
unknown mean value
μ ∈ℝunknown
ℍ0 : σ2 ≤σ2
0
ℍ1 : σ2 > σ2
0
{x ∈ℝn : ∑(xi−̄x)2
σ2
0
> χ2
n−1; 1−α}
Two-sided χ2-test with
unknown mean value
μ ∈ℝunknown
ℍ0 : σ2 = σ2
0
ℍ1 : σ2
̸= σ2
0
{x ∈ℝn : ∑(xi−̄x)2
σ2
0
< χ2
n−1; α/2} ∪
{x ∈ℝn : ∑(xi−̄x)2
σ2
0
> χ2
n−1; 1−α/2}
8.4.6 Two-sample Z-tests
The two-sample Z-test compares the parameters of two different populations. Suppose
we are given two different series of data, say x = (x1, . . . , xm) and y = (y1, . . . , yn), which
were obtained independently by executing m experiments of the first kind and n exper-
iments of the second. Combine both series to a single vector (x, y) ∈ℝm+n.
A typical example for the described situation is as follows. A farmer grows grain on
two different lots. On one lot he added fertilizer, on the other he did not. Now he wants
to figure out whether or not adding fertilizer influenced the amount of grain gathered.
Therefore, he measures the amount of grain on the first lot at m different spots and that
on the second lot at n spots. The aim is to compare the mean values in both series of
experiments.
We suppose that the samples x1, . . . , xm of the first population are independent
and N(μ1, σ2
1)-distributed, while the y1, . . . , yn of the second population are indepen-
dent and 𝒩(μ2, σ2
2)-distributed. Typical questions are as follows. Do we have μ1 = μ2

8.4 Tests for normally distributed populations
౪
409
or, maybe, only μ1 ≤μ2? One may also ask whether or not σ2
1 = σ2
2 or, maybe, only
σ2
1 ≤σ2
2.
To apply the two-sample Z-test, one has to suppose that the variances σ2
1 and σ2
2 are
known. This reduces the number of parameters from 4 to 2, namely to μ1 and μ2 in ℝ.
Thus, the describing statistical model is given by
(ℝm+n, ℬ(ℝm+n), 𝒩(μ1, σ2
1)
⊗m ⊗𝒩(μ2, σ2
2)
⊗n)(μ1,μ2)∈ℝ2 .
(8.29)
Recall that 𝒩(μ1, σ2
1)⊗m ⊗𝒩(μ2, σ2
2)⊗n denotes the multivariate normal distribution with
expected value (μ1, . . . , μ1
⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟
m
, μ2, . . . , μ2
⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟
n
) and covariance matrix R = (rij)m+n
i,j=1 , where rii = σ2
1
if 1 ≤i ≤m, and rii = σ2
2 if m < i ≤m + n. Furthermore, rij = 0 if i
̸= j.
Proposition 8.4.24. The statistical model is that in (8.29). To test ℍ0 : μ1 ≤μ2 against
ℍ1 : μ1 > μ2, set
𝒳0 := {(x, y) ∈ℝm+n : √
mn
nσ2
1 + mσ2
2
( ̄x −̄y) ≤z1−α}
and 𝒳1 = ℝm+n \ 𝒳0. Then the test T = (𝒳0, 𝒳1) is an α-significance test for checking ℍ0
against ℍ1. To test ℍ0 : μ1 = μ2 against ℍ1 : μ1
̸= μ2, let
𝒳0 := {(x, y) ∈ℝm+n : √
mn
nσ2
1 + mσ2
2
| ̄x −̄y| ≤z1−α/2}
and 𝒳1 = ℝm+n \ 𝒳0. Then the test T = (𝒳0, 𝒳1) is an α-significance test for checking ℍ0
against ℍ1.
Proof. Since the proof of the two-sided case is very similar to that of the one-sided,
we only prove the first assertion. Thus, let us assume that ℍ0 is valid, that is, we have
μ1 ≤μ2. Then we have to verify that
𝒩(μ1, σ2
1 )
⊗m ⊗𝒩(μ2, σ2
2)
⊗n(𝒳1) ≤α .
(8.30)
To prove this, we investigate the random variables Xi and Yj defined as Xi(x, y) = xi and
Yj(x, y) = yj. Since the underlying probability space is
(ℝm+n, ℬ(ℝm+n), 𝒩(μ1, σ2
1)
⊗m ⊗𝒩(μ2, σ2
2)
⊗n) ,
these random variables are independent and distributed according to 𝒩(μ1, σ2
1) and
𝒩(μ2, σ2
2), respectively. Consequently,
̄X is 𝒩(μ1, σ2
1
m )-distributed, while
̄Y is distributed
according to 𝒩(μ2, σ2
2
n ). By the construction, ̄X and ̄Y are independent as well, and, more-
over, since −̄Y is 𝒩(−μ2, σ2
2
n )-distributed, we conclude that the distribution of ̄X−̄Y equals
𝒩(μ1 −μ2, σ2
1
m + σ2
2
n ). Therefore, the mapping S : ℝm+n →ℝdefined by

410
౪
8 Mathematical statistics
S(x, y) := (σ2
1
m + σ2
2
n )
−1/2
[( ̄X(x, y) −̄Y(x, y)) −(μ1 −μ2)]
is standard normal. By the definition of the quantile, this leads to
𝒩(μ1, σ2
1)
⊗m ⊗𝒩(μ2, σ2
2)
⊗n{(x, y) ∈ℝm+n : S(x, y) > z1−α} = α .
(8.31)
Since we assumed ℍ0 to be correct, that is, we suppose μ1 ≤μ2, it follows that
S(x, y) ≥(σ2
1
m + σ2
2
n )
−1/2
[ ̄X(x, y) −̄Y(x, y)] = √
mn
nσ2
1 + mσ2
2
[ ̄X(x, y) −̄Y(x, y)] .
Hence
𝒳1 ⊆{(x, y) ∈ℝm+n : S(x, y) > z1−α} ,
which by eq. (8.31) implies estimate (8.30). This completes the proof of this part of the
proposition.
8.4.7 Two-sample t-tests
The situation is similar as in the two-sample Z-test, yet with one important difference.
The variances σ2
1 and σ2
2 of the two populations are no longer known. Instead, we have
to assume that they coincide, that is, we suppose
σ2
1 = σ2
2 := σ2 .
Therefore, there are three unknown parameters, the expected values μ1, μ2, and the
common variance σ2. Thus, the statistical model describing this situation is given by
(ℝm+n, ℬ(ℝm+n), 𝒩(μ1, σ2)
⊗m ⊗𝒩(μ2, σ2)
⊗n)(μ1,μ2,σ2)∈ℝ2×(0,∞) .
(8.32)
To simplify the formulation of the next statement, introduce T : ℝm+n →ℝas
T(x, y) := √(m + n −2) m n
m + n
̄x −̄y
√(m −1)s2
x + (n −1)s2
y
,
(x, y) ∈ℝm+n .
(8.33)
Proposition 8.4.25. Let the statistical model be as in (8.32). If
𝒳0 := {(x, y) ∈ℝm+n : T(x, y) ≤tm+n−2;1−α}
and 𝒳1 = ℝm+n \ 𝒳0, then T = (𝒳0, 𝒳1) is an α-significance test for ℍ0 : μ1 ≤μ2 against
ℍ1 : μ1 > μ2.

8.4 Tests for normally distributed populations
౪
411
On the other hand, the test T = (𝒳0, 𝒳1) with
𝒳0 := {(x, y) ∈ℝm+n : 󵄨󵄨󵄨󵄨T(x, y)󵄨󵄨󵄨󵄨≤tm+n−2;1−α/2}
and 𝒳1 = ℝm+n \ 𝒳0 is an α-significance test for ℍ0 : μ1 = μ2 against ℍ1 : μ1
̸= μ2.
Proof. This time we prove the two-sided case, that is, the null hypothesis is given by
ℍ0 : μ1 = μ2.
Let the random vectors X = (X1, . . . , Xm) and Y = (Y1, . . . , Yn) on ℝm+n be defined
with Xis and Yjs as in the proof of Proposition 8.4.24, that is, we have X(x, y) = x and
Y(x, y) = y. Then by Proposition 4.1.9 and Remark 4.1.10, the unbiased sample variances
s2
X =
1
m −1
m
∑
i=1
(Xi −̄X)2
and
s2
Y =
1
n −1
m
∑
j=1
(Yj −̄Y)2
are independent as well. Furthermore, by virtue of statement (8.17), the random vari-
ables
(m −1)s2
X
σ2
and
(n −1)s2
Y
σ2
are distributed according to χ2
m−1 and χ2
n−1, respectively. Proposition 4.6.9 implies that
S2
(X,Y) := 1
σ2 {(m −1)s2
X + (n −1)s2
Y}
is χ2
m+n−2-distributed. Since s2
X and
̄X, as well as s2
Y and
̄Y, are independent, by Propo-
sition 8.4.3, this is also so for S2
(X,Y) and
̄X −
̄Y. As in the proof of Proposition 8.4.24, it
follows that ̄X −̄Y is distributed according to 𝒩(μ1 −μ2, σ2
m + σ2
n ). Assume now that ℍ0
is true, that is, we have μ1 = μ2. Then the last observation implies that
√mn
σ√m+n( ̄X −
̄Y)
is a standard normally distributed random variable and, furthermore, independent of
S2
(X,Y). Thus, by Proposition 4.6, the distribution of the quotient
Z := √m + n −2
√mn
σ√m+n( ̄X −̄Y)
S(X,Y)
,
where S(X,Y) := +√S2
(X,Y), is tm+n−2-distributed. If T is as in eq. (8.33), then it is not difficult
to prove that Z = T(X, Y). Therefore, by the definition of X and Y, the mapping T is a
tm+n−2-distributed random variable on ℝm+n, endowed with the probability measure
ℙμ1,μ2,σ2 = 𝒩(μ1, σ2)⊗m ⊗𝒩(μ2, σ2)⊗n. By eq. (8.23), this implies
ℙμ1,μ2,σ2(𝒳1) = ℙμ1,μ2,σ2{(x, y) ∈ℝm+n : 󵄨󵄨󵄨󵄨T(x, y)󵄨󵄨󵄨󵄨> tm+n−2;1−α/2} = α ,
as asserted.

412
౪
8 Mathematical statistics
8.4.8 F-tests
In this final section about tests, we compare the variances of two normally distributed
sample series. Since the proofs of the assertions follow the schemes presented in the
previous propositions, we decline to verify them here. We only mention the facts that
play a crucial role during the proofs.
1.
If X1, . . . , Xm and Y1, . . . , Yn are independent and distributed according to 𝒩(μ1, σ2
1)
and 𝒩(μ2, σ2
2), then
V := 1
σ2
1
m
∑
i=1
(Xi −μ1)2
and
W := 1
σ2
2
n
∑
j=1
(Yj −μ2)2
are χ2
m and χ2
n-distributed and independent. Consequently, the quotient V/m
W/n is
Fm,n-distributed.
2.
For X1, . . . , Xm and Y1, . . . , Yn independent and standard normal, the random vari-
ables
(m −1) s2
X
σ2
1
and
(n −1) s2
Y
σ2
2
are independent and distributed according to χ2
m−1 and χ2
n−1, respectively. Thus, as-
suming σ1 = σ2, the quotient s2
X/s2
Y possesses an Fm−1,n−1-distribution.
When applying an F-test, as before, two different cases have to be considered.
(K) The expected values μ1 and μ2 of the two populations are known. Then the statistical
model is given by
(ℝm+n, ℬ(ℝm+n), 𝒩(μ1, σ2
1)
⊗m ⊗𝒩(μ2, σ2
2)
⊗n)(σ2
1 ,σ2
2)∈(0,∞)2 .
(U) The expected values are unknown. This case is described by the statistical model
(ℝm+n, ℬ(ℝm+n), 𝒩(μ1, σ2
1 )
⊗m ⊗𝒩(μ2, σ2
2)
⊗n)(μ1,μ2,σ2
1 ,σ2
2)∈R2×(0,∞)2 .
In both cases, the null hypothesis may either be ℍ0 : σ2
1 ≤σ2
2 in the one-sided case or
ℍ0 : σ2
1 = σ2
2 in the two-sided one. The regions of acceptance in each of the four different
cases are given by the following subsets of ℝm+n, and always 𝒳1 = ℝm+n \ 𝒳0.
Case 1: ℍ0 : σ2
1 ≤σ2
2 and μ1, μ2 are known. Then
𝒳0 := {(x, y) ∈ℝm+n :
1
m ∑m
i=1(xi −μ1)2
1
n ∑n
j=1(yj −μ2)2 ≤Fm,n;1−α}.
Case 2: ℍ0 : σ2
1 = σ2
2 and μ1, μ2 are known. Then

8.4 Tests for normally distributed populations
౪
413
𝒳0 := {(x, y) ∈ℝm+n : Fm,n;α/2 ≤
1
m ∑m
i=1(xi −μ1)2
1
n ∑n
j=1(yj −μ2)2 ≤Fm,n;1−α/2}.
Case 3: ℍ0 : σ2
1 ≤σ2
2 and μ1, μ2 are unknown. Then
𝒳0 := {(x, y) ∈ℝm+n : s2
x
s2
y
≤Fm−1,n−1;1−α}.
Case 4: ℍ0 : σ2
1 = σ2
2 and μ1, μ2 are unknown. Then
𝒳0 := {(x, y) ∈ℝm+n : Fm−1,n−1;α/2 ≤s2
x
s2
y
≤Fm−1,n−1;1−α/2}.
Example 8.4.26. Suppose there exist two different methods to measure certain items.
Some evidence lets us suggest that method 2 is more precise than method 1. That is, we
believe that the variance of the measurements by method 2 is smaller than the one by
method 1.
To check this we measure some given item 39 times by method 1 and a maybe dif-
ferent item 28 times by method 2. As result we get x = (x1, . . . , x39) values obtained by
method 1 and another 28 values y = (y1, . . . , y28) by method 2. Thus, in order to apply an
F-test, we have m = 39 and n = 28.
Assume the unbiased variances of the samples x and y are
s2
x = 109.63
and
s2
y = 65.99 ,
hence s2
x
s2
y
= 1.66 .
Let σ2
1 and σ2
2 be the unknown variances of the xis and yjs, respectively. To obtain as
much information as possible, let us choose as hypotheses
ℍ0 : σ2
1 ≤σ2
2
and
ℍ1 : σ2
1 > σ2
2 .
(8.34)
Take α = 0.1 as a significance level. If s2
x/s2
y > F38,27;0.9, then an application of the one-
sided F-test implies that we may reject ℍ0. Note that m −1 = 38 and n −1 = 27.
Let X be an F38,27-distributed random variable. Then
s2
x/s2
y > F38,27;0.9
⇔
ℙ{X ≤s2
x
s2
y
} > 0.9 .
Tables or mathematical programs give
ℙ{X ≤s2
x
s2
y
} = ℙ{X ≤1.66} = 0.91402 > 0.9 = 1 −α .

414
౪
8 Mathematical statistics
So we may reject ℍ0 and conclude that σ2
2 < σ2
1. That is, with probability greater than
0.9 we may say that method 2 is more precise than method 1.
Let us one more time emphasize the importance of the choice of the hypotheses
in (8.34). If we were to choose ℍ0 : σ2
2 ≤σ2
1, then our test would confirm ℍ0, but we
could not say that ℍ0 is valid with a likelihood of at least 90 %.
Summary: The most important two-sample α-significance tests for normally distributed
populations are
Name
Parameter
Hypotheses
Critical region 𝒳1
One-sided Z-test
σ2
1, σ2
2 known
ℍ0 : μ1 ≤μ2
ℍ1 : μ1 > μ2
{(x, y) ∈ℝm+n :
√mn
√nσ2
1+mσ2
2
⋅( ̄x −̄y) > z1−α}
Two-sided Z-test
σ2
1, σ2
2 known
ℍ0 : μ1 = μ2
ℍ1 : μ1
̸= μ2
{(x, y) ∈ℝm+n :
√mn
√nσ2
1+mσ2
2
⋅| ̄x −̄y| > z1−α/2}
One-sided t-test
σ2
1 = σ2
2 > 0 unknown
ℍ0 : μ1 ≤μ2
ℍ1 : μ1 > μ2
{(x, y) ∈ℝm+n :
√(m+n−2)mn
√m+n
×
̄x−̄y
√(m−1)s2x +(n−1)s2y
> tm+n−2; 1−α}
Two-sided t-test
σ2
1 = σ2
2 > 0 unknown
ℍ0 : μ1 = μ2
ℍ1 : μ1
̸= μ2
{(x, y) ∈ℝm+n :
√(m+n−2)mn
√m+n
×
| ̄x−̄y|
√(m−1)s2x +(n−1)s2y
> tm+n−2; 1−α/2}
One-sided F-test
μ1, μ2 known
ℍ0 : σ2
1 ≤σ2
2
ℍ1 : σ2
1 > σ2
2
{(x, y) ∈ℝm+n :
1
m ∑m
i=1(xi−μ1)2
1
n ∑n
j=1(yj−μ2)2 > Fm,n; 1−α}
Two-sided F-test
μ1, μ2 known
ℍ0 : σ2
1 = σ2
2
ℍ1 : σ2
1
̸= σ2
2
{(x, y) ∈ℝm+n :
1
m ∑m
i=1(xi−μ1)2
1
n ∑n
j=1(yj−μ2)2 > Fm,n; 1−α/2}
∪{(x, y) ∈ℝm+n :
1
n ∑n
j=1(yj−μ2)2
1
m ∑m
i=1(xi−μ1)2 > Fn,m; 1−α/2}
One-sided F-test
μ1, μ2 ∈ℝunknown
ℍ0 : σ2
1 ≤σ2
2
ℍ1 : σ2
1 > σ2
2
{(x, y) ∈ℝm+n : s2
x/s2
y > Fm−1,n−1; 1−α}
Two-sided F-test
μ1, μ2 ∈ℝunknown
ℍ0 : σ2
1 = σ2
2
ℍ1 : σ2
1
̸= σ2
2
{(x, y) ∈ℝm+n : s2
x/s2
y > Fm−1,n−1; 1−α/2}
∪{(x, y) ∈ℝm+n : s2
y/s2
x > Fn−1,m−1; 1−α/2}
8.5 Point estimators
Starting point is a parametric statistical model (𝒳, ℱ, ℙθ)θ∈Θ. Assume we execute a sta-
tistical experiment and observe a sample x ∈𝒳. The aim of this section is to show how
this observation leads to a “good” estimate of the unknown parameter θ ∈Θ.
Example 8.5.1. Suppose the statistical model is (ℝn, ℬ(ℝn), 𝒩(μ, σ2
0)⊗n)μ∈ℝfor some
known σ2
0 > 0. Thus, the unknown parameter is the expected value μ ∈ℝ. To estimate
it, we execute n independent measurements and get x = (x1, . . . , xn) ∈ℝn. Knowing this

8.5 Point estimators
౪
415
vector x, what is a “good” estimate for μ? An intuitive approach is to define the point
estimator ̂μ : ℝn →ℝas
̂μ(x) = 1
n
n
∑
j=1
xj = ̄x ,
x = (x1, . . . , xn) ∈ℝn .
In other words, if the observed sample is x, then we take its sample mean ̂μ(x) =
̄x as
an estimate for μ. An immediate question is whether ̂μ is a “good” estimator for μ. Or do
there exist maybe “better” (more precise) estimators for μ?
Before we investigate such and similar questions, the problem has to be generalized
slightly. Sometimes it happens that we are not interested in the concrete value of the
parameter θ ∈Θ. We only want to know the value γ(θ) derived from θ. Thus, for some
function γ : Θ →ℝwe want to find a “good” estimator ̂γ : 𝒳→ℝfor γ(θ). In other
words, if we observe a sample x ∈𝒳, then we take ̂γ(x) as an estimate for the (unknown)
value γ(θ). However, in most cases the function γ is not needed. That is, here we have
γ(θ) = θ, and we look for a good estimator ̂θ : 𝒳→Θ for θ.
Let us state an example where a nontrivial function γ plays a role.
Example 8.5.2. Let (ℝn, ℬ(ℝn), 𝒩(μ, σ2)⊗n)(μ,σ2)∈ℝ×(0,∞) be the statistical model. Thus,
the unknown parameter is the two-dimensional vector (μ, σ2). But, in fact, we are only
interested in μ, not in the pair (μ, σ2). That is, if
γ(μ, σ2) := μ ,
(μ, σ2) ∈ℝ× (0, ∞) ,
then we want to find an estimate for γ(μ, σ2).
Analogously, if we only want an estimate for σ2, then we choose γ as
γ(μ, σ2) := σ2 ,
(μ, σ2) ∈ℝ× (0, ∞) .
After these preliminary considerations, we state now the precise definition of an
estimator.
Definition 8.5.3. Let (𝒳, ℱ, ℙθ)θ∈Θ be a parametric statistical model and let γ : Θ →ℝbe a function of
the parameter. A mapping ̂γ : 𝒳→ℝis said to be a point estimator (or simply estimator) for γ(θ) if,
given t ∈ℝ, the set {x ∈𝒳: ̂γ(x) ≤t} belongs to the σ-field ℱ. In other words, ̂γ is a random variable
defined on 𝒳.
The interpretation of this definition is as follows. If one observes the sample x ∈𝒳, then
̂γ(x) is an estimate for γ(θ). For example, if one measures a workpiece four times and gets
22.03, 21.87, 22.11, and 22,15 inches as results, then using the estimator ̂μ in Example 8.5.2,
the estimate for the mean value equals 22.04 inches.

416
౪
8 Mathematical statistics
8.5.1 Maximum likelihood estimation
Let (𝒳, ℱ, ℙθ)θ∈Θ be a parametric statistical model. There exist several methods to con-
struct “good” point estimators for the unknown parameter θ. In this section we present
the probably most important of these methods, the so-called maximum likelihood
principle.
To understand this principle, the following easy example may be helpful.
Example 8.5.4. Suppose the parameter set consists of two elements, say Θ = {0, 1}. More-
over, also the sample space 𝒳has cardinality two, that is, 𝒳= {a, b}. Then the problem
is as follows. Depending on the observation a or b, we have to choose either 0 or 1 as an
estimate for θ.
For example, let us assume that ℙ0({a}) = 1/4, hence ℙ0({b}) = 3/4, and
ℙ1({a}) = ℙ1({b}) = 1/2. Say, an experiment has outcome “a.” What would be a good
estimate for θ in this case? Should we take “0” or “1”? The answer is that we should
choose “1.” Why? Because the sample “a” fits ℙ1 better than ℙ0. By the same argument,
we should take “0” as an estimate if we observe “b.” Thus, the point estimator for θ is
given by ̂θ(a) = 1 and ̂θ(b) = 0.
Example 8.5.5. Let us transform the previous example into one of daily life. Say your
friend is planning to visit you. He will either arrive by train or by car. If he comes by
train, he will be on time with probability 3/4, and by car with probability 1/2. Say he
arrived on time. What would be your estimate for his choice? Do you guess he came by
train or do you conjecture that he used the car? Justify your answer. What if your friend
arrived late?
Which property characterizes the estimator ̂θ in Example 8.5.4? To answer this ques-
tion, fix x ∈𝒳and look at the function
θ 󳨃→ℙθ({x}) ,
θ ∈Θ .
(8.35)
If x = a, this function becomes maximal for θ = 1, while for x = b it attains its maximal
value at θ = 0. Consequently, the estimator ̂θ could also be defined as follows. For each
fixed x ∈𝒳, choose as an estimate the θ ∈Θ for which the function (8.35) becomes
maximal. But this is exactly the approach of the maximum likelihood principle.
In order to describe this principle in the general setting, we have to introduce the
notion of the likelihood function. Let us first assume that the sample space 𝒳consists of
at most countably many elements.
Definition 8.5.6. The function p from Θ × 𝒳to ℝdefined as
p(θ, x) := Pθ({x}) ,
θ ∈Θ ,
x ∈𝒳,
is called the likelihood function of the statistical model (𝒳, 𝒫(𝒳), ℙθ)θ∈Θ.

8.5 Point estimators
౪
417
We come now to the case where all probability measures ℙθ are continuous. Thus, we
assume that the statistical model is (ℝn, ℬ(ℝn), ℙθ)θ∈Θ and, moreover, each ℙθ is contin-
uous, that is, it has a density, mapping ℝn to ℝ. This density is not only a function of
x ∈ℝn, it also depends on the probability measure ℙθ, hence on θ ∈Θ. Therefore, we
denote the densities by p(θ, x). In other words, for each θ ∈Θ and each box Q ⊆ℝn as
in eq. (1.73) we have
ℙθ(Q) = ∫
ℚ
p(θ, x) dx =
b1
∫
a1
⋅⋅⋅
bn
∫
an
p(θ, x1, . . . , xn) dxn ⋅⋅⋅dx1 .
(8.36)
Definition 8.5.7. The function p : Θ × ℝn →ℝsatisfying eq. (8.36) for all boxes Q and all θ ∈Θ is said
to be the likelihood function of the statistical model (ℝn, ℬ(ℝn), ℙθ)θ∈Θ.
For a better understanding of Definitions 8.5.6 and 8.5.7, let us give some examples of
likelihood functions.
1.
First take (𝒳, 𝒫(𝒳), Bn,θ)0≤θ≤1 with 𝒳= {0, . . . , n} from Section 8.3. Then its likeli-
hood function equals
p(θ, k) = (n
k)θk(1 −θ)n−k ,
θ ∈[0, 1] ,
k ∈{0, . . . , n} .
(8.37)
2.
Consider the statistical model (𝒳, 𝒫(𝒳), HN,M,n)M=0,...,N investigated in Example 8.1.4.
Then its likelihood function is given by
p(M, m) =
(M
m)(N−M
n−m)
(N
n)
,
M = 0, . . . , N ,
m = 0, . . . , n .
(8.38)
3.
The likelihood function of the model (ℕn
0, 𝒫(ℕn
0), Pois⊗n
λ )λ>0 investigated in Exam-
ple 8.5.22 is
p(λ, k1, . . . , kn) = λk1+⋅⋅⋅+kn
k1! ⋅⋅⋅kn! e−λn ,
λ > 0 ,
kj ∈ℕ0 .
(8.39)
4.
The likelihood function of (ℝn, ℬ(ℝn), 𝒩(μ, σ2)⊗n)(μ,σ2)∈ℝ×(0,∞) from Example 8.1.12
can be calculated by
p(μ, σ2, x) =
1
(2π)n/2σn exp(−|x −⃗μ|2
2σ2
) ,
μ ∈ℝ,
σ2 > 0 .
(8.40)
Here, as before, let ⃗μ = (μ, . . . , μ).
5.
The likelihood function of (ℝn, ℬ(ℝn), E⊗n
λ )λ>0 from Example 8.1.9 may be repre-
sented as
p(λ, t1, . . . , tn) = {λn e−λ(t1+⋅⋅⋅+tn)
if tj ≥0 , λ > 0,
0
otherwise.
(8.41)

418
౪
8 Mathematical statistics
Definition 8.5.8. Let (𝒳, ℱ, ℙθ)θ∈Θ be a parametric statistical model with likelihood function
p : Θ × 𝒳→ℝ. An estimator
̂θ : 𝒳→Θ is said to be a maximum likelihood estimator (MLE) for
θ ∈Θ provided that, for each x ∈𝒳, the following is satisfied:
p( ̂θ(x), x) = max
θ∈Θ p(θ, x)
Remark 8.5.9. Another way to define the MLE is as follows:6
̂θ(x) = arg max
θ∈Θ
p(θ, x) ,
x ∈𝒳.
How does one find the MLE for concrete statistical models? One observation is that
the logarithm is an increasing function. Thus, the likelihood function p(⋅, x) becomes
maximal at a certain parameter θ ∈Θ if its logarithm ln p(⋅, x) does.
Definition 8.5.10. Let (𝒳, ℱ, ℙθ)θ∈Θ be a statistical model and let p : Θ × 𝒳→ℝbe its likelihood
function. Suppose p(θ, x) > 0 for all (θ, x). Then the function
L(θ, x) := ln p(θ, x) ,
θ ∈Θ ,
x ∈𝒳,
is called the log-likelihood function of the model.
Thus, ̂θ is an MLE if and only if
̂θ(x) = arg max
θ∈Θ
L(θ, x) ,
x ∈𝒳,
or, equivalently, if
L( ̂θ(x), x) = max
θ∈Θ L(θ, x) .
Example 8.5.11. If p is the likelihood function in eq. (8.37), then the log-likelihood func-
tion equals
L(θ, k) = c + k ln θ + (n −k) ln(1 −θ) ,
0 ≤θ ≤1 ,
k = 0, . . . , n .
(8.42)
Here c ∈ℝdenotes a certain constant independent of θ.
Example 8.5.12. The log-likelihood function of p in eq. (8.41) is well defined for λ > 0
and tj ≥0. For those λs and tjs, it is given by
L(λ, t1, . . . , tn) = n ln λ −λ(t1 + ⋅⋅⋅+ tn) .
6 If f is a real-valued function with domain A, then x = arg max
y∈A
f (y) if x ∈A and f (x) ≥f (y) for all
y ∈A. In other words, x is one of the points in the domain A where f attains its maximal value.

8.5 Point estimators
౪
419
To proceed further, we assume now that the parameter set Θ is a subset of ℝk for
some k ≥1. That is, each parameter θ consists of k unknown components, that is, it
may be written as θ = (θ1, . . . , θk) with θj ∈ℝ. Furthermore, suppose that for each fixed
x ∈𝒳the log-likelihood function L(⋅, x) is continuously differentiable7 on Θ. Then points
θ∗∈Θ where L(⋅, x) becomes maximal must satisfy
𝜕
𝜕θi
L(θ, x)
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨θ=θ∗= 0 ,
i = 1, . . . , k .
(8.43)
In particular, this is true for the MLE ̂θ(x). If for each x ∈𝒳, the log-likelihood function
L(⋅, x) is continuously differentiable on Θ ⊆ℝk, then the MLE ̂θ satisfies
𝜕
𝜕θi
L(θ, x)
󵄨󵄨󵄨󵄨󵄨󵄨󵄨θ= ̂θ(x) = 0 ,
i = 1, . . . , k .
Example 8.5.13. Let us determine the MLE for the log-likelihood function in eq. (8.42).
Here we have Θ = [0, 1] ⊆ℝ, hence the MLE ̂θ : {0, . . . , n} →[0, 1] has to satisfy
𝜕
𝜕θL( ̂θ(k), k) =
k
̂θ(k)
−
n −k
1 −̂θ(k)
= 0 .
This easily gives ̂θ(k) = k
n, that is, the MLE in this case is defined by
̂θ(k) = k
n ,
k = 0, . . . , n .
Let us interpret this result. In an urn there are white and black balls of unknown pro-
portion. Let θ be the proportion of white balls. To estimate θ, draw n balls out of the urn,
with replacement. Assume k of the chosen balls are white. Then ̂θ(k) = k
n is the MLE for
the unknown proportion θ of white balls.
Example 8.5.14. The logarithm of the likelihood function p in eq. (8.40) equals
L(μ, σ2, x) = L(μ, σ2, x1, . . . , xn) = c −n
2 ⋅ln σ2 −
1
2σ2
n
∑
j=1
(xj −μ)2
with some constant c ∈ℝ, independent of μ and of σ2. Thus, here Θ ⊆ℝ2, hence, if
θ∗= (μ∗, σ2∗) denotes the pair satisfying eq. (8.43), then
𝜕
𝜕μL(μ, σ2, x)
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨(μ,σ2)=(μ∗,σ2∗)
= 0
and
𝜕
𝜕σ2 L(μ, σ2, x)
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨(μ,σ2)=(μ∗,σ2∗)
= 0 .
7 The partial derivatives exist and are continuous.

420
౪
8 Mathematical statistics
Now
𝜕
𝜕μL(μ, σ2, x) = 1
σ2
n
∑
j=1
(xj −μ) = 1
σ2 [
n
∑
j=1
xj −nμ],
which implies μ∗= 1
n ∑n
j=1 xj = ̄x.
The derivative of L with respect to σ2, taken at μ∗= ̄x, equals
𝜕
𝜕σ2 L( ̄x, σ2, x) = −n
2 ⋅1
σ2 + 1
σ4
n
∑
j=1
(xj −̄x)2 .
It becomes zero at σ2∗satisfying
σ2∗= 1
n
n
∑
j=1
(xj −̄x)2 = σ2
x ,
where σ2
x was defined in eq. (8.14). Combining these observations, we see that the only
pair θ∗= (μ∗, σ2∗) satisfying eq. (8.43) is given by ( ̄x, σ2
x). Consequently, as MLE for θ =
(μ, σ2) we obtain
̂μ(x) = ̄x
and
̂
σ2(x) = σ2
x ,
x ∈ℝn .
Remark 8.5.15. Similar calculations as in the previous examples show that the MLE for
the likelihood functions in eqs. (8.39) and (8.41) coincide with
̂λ(k1, . . . , kn) = 1
n
n
∑
i=1
ki
and
̂λ(t1, . . . , tn) =
1
1
n ∑n
i=1 ti
.
Finally, we present two likelihood functions where we have to determine their max-
imal values directly. Note that the above approach via the log-likelihood function does
not apply if the parameter set Θ is either finite or countably infinite. In this case a deriva-
tive of L(⋅, x) does not make sense, hence we cannot determine points where it vanishes.
The first problem is that discussed in Remark 1.4.33. A retailer gets a delivery of N
machines. Among the N machines are M defective. Since M is unknown, the retailer
wants a “good” estimate for it. Therefore, he chooses at random n machines and tests
them. Suppose he observes m defective machines among the tested. Does this lead to
an estimate of the number M of defective machines? The next proposition answers this
question.
Proposition 8.5.16. The statistical model is given by (𝒳, 𝒫(𝒳), HM,N,n)M=0,...,N. Then the
MLE
̂M for M is of the form
̂M(m) = {⌊m(N+1)
n
⌋
if m < n,
N
if m = n.

8.5 Point estimators
౪
421
Here ⌊x⌋denotes the floor function (integer part) of a real number x. For example, ⌊1.2⌋= 1
and ⌊π⌋= 3.
Proof. The likelihood function p was determined in eq. (8.38) as
p(M, m) =
(M
m)(N−M
n−m)
(N
n)
,
M = 0, . . . , N ,
m = 0, . . . , n .
First note that p(M, m)
̸= 0 if and only if M ∈{m, . . . , N −n+m} and, therefore, it suffices
to investigate p(M, m) for Ms in this region. Thus, if M −1 ≥m, then easy calculations
lead to
p(M, m)
p(M −1, m) =
M
M −m ⋅N −M + 1 −(n −m)
N −M + 1
.
(8.44)
By eq. (8.44), it follows that we have p(M, m) ≥p(M −1, m) if and only if
M(N −M + 1 −(n −m)) ≥(M −m)(N −M + 1) .
Elementary transformations show the last estimate is equivalent to
−nM ≥−mN −m ,
which happens if and only if M ≤m(N+1)
n
.
Consequently, M 󳨃→p(M, m) is nondecreasing on {0, . . . , ⌊m(N+1)
n
⌋}, and it is nonin-
creasing on {⌊m(N+1)
n
⌋, . . . , N}. Thus, if m < n, then the likelihood function M 󳨃→p(M, m)
becomes maximal for M∗= ⌊m(N+1)
n
⌋, and the MLE is given by
̂M(m) = ⌊m(N + 1)
n
⌋,
m = 0, . . . , n −1 .
If m = n, then M 󳨃→p(M, m) is nonincreasing on {0, . . . , N}, hence in this case the likeli-
hood function attains its maximal value at M = N, that is,
̂M(n) = N.
Example 8.5.17. A retailer gets a delivery of 100 TV sets for further selling. He chooses at
random 15 sets and tests them. If there is exactly one defective TV set among the 15 tested,
then the estimate for the number of defective sets in the delivery is 6. If he observes 2
defective sets, the estimate is 13, for 4 it is 26, and if there are even 6 defective TV sets
among the 15 chosen, then the estimate is that 40 sets of the delivery are defective.
Finally, we come back to the question asked in Remark 1.4.36. In order to estimate
the number N of fish in a pond, one catches M of them, marks them and puts them back
into the pond. After some time one catches fish again, this time n of them. Among them
m are marked. Does this number m lead to a “good” estimate of the number of fish in
the pond? To describe this problem, we choose as statistical model

422
౪
8 Mathematical statistics
(𝒳, ℙ(𝒳), HN,M,n)N=0,1,...
where 𝒳= {0, . . . , n}. Here HN,M,n denotes the hypergeometric probability measure in-
troduced in Definition 1.4.32. Thus, in this case the likelihood function is given by
p(N, m) =
(M
m)(N−M
n−m)
(N
n)
,
N = 0, 1, . . . ,
m = 0, . . . , n .
In the sequel, we have to exclude m = 0; in this case, there does not exist a reasonable
estimate for N.
Proposition 8.5.18. If 1 ≤m ≤n, then the MLE
̂N for N is
̂N(m) = ⌊Mn
m ⌋.
(8.45)
Proof. The proof is quite similar to that of Proposition 8.5.16. Since
p(N, m)
p(N −1, m) = N −M
N
⋅
N −n
N −M −(n −m) ,
it easily follows that the inequality p(N, m) ≥p(N −1, m) is valid if and only if N ≤Mn
m .
Therefore, N 󳨃→p(N, m) is nondecreasing if N ≤⌊Mn
m ⌋and nonincreasing for the re-
maining N. This immediately shows that the MLE is given by eq. (8.45).
Example 8.5.19. An unknown number of balls are in an urn. In order to estimate this
number, we choose 50 balls from the urn and mark them. We put back the marked balls
and mix the balls in the urn thoroughly. Then we choose another 30 balls from the urn.
If there are 7 marked among the 30, then the estimate for the number of balls in the urn
is 214. In the case of two marked balls, the estimate equals 750 while in the case of 16
marked balls we estimate that there are 93 balls in the urn.
Summary: Let (𝒳, ℱ, ℙθ)θ∈Θ be a parametric statistical model. A function ̂θ : 𝒳→Θ is said to be a point
estimator for the unknown parameter θ. That is, observing a sample x ∈𝒳, then ̂θ(x) is our estimate for θ.
The basic idea of the maximum likelihood estimator (MLE) is as follows: observing an x ∈𝒳, one chooses
that θ for which the likelihood function p(θ, x) = ℙθ({x}) becomes maximal. This works well in the case of
discrete ℙθs. In the case of continuous ℙθs, one asks for the maximum of the densities p(θ, x) of the ℙθs.
Thus, if x ∈𝒳, then ̂θ(x) = arg max
θ∈Θ
p(θ, x) defines the MLE for this model. The logarithm is an increasing
function, so that this is equivalent to
̂θ(x) = arg max
θ∈Θ
L(θ, x) ,
x ∈𝒳,
where the log-likelihood function L is defined by L(θ, x) = ln p(θ, x).

8.5 Point estimators
౪
423
8.5.2 Unbiased estimators
Let us come back to the general setting. We are given a function γ : Θ →ℝand look
for a “good” estimate for γ(θ). If ̂γ(x) is the estimate, in most cases it will not be the
correct value γ(θ). Sometimes the estimate is larger than γ(θ), sometimes one observes
an x ∈𝒳for which ̂γ(x) is smaller than the true value. For example, if the retailer in
Example 8.5.17 gets every week a delivery of 100 TV sets, then sometimes his estimate
for the number of defective sets will be bigger than the true value, sometimes smaller.
Since he only pays for the nondefective sets, sometimes he pays too much, sometimes not
enough. Therefore, a crucial condition for a good estimator should be that, on average,
it meets the correct value. That is, in the long run, the loss and gain of the retailer should
balance. In other words, the estimator should not be biased by a systematic error.
In view of Proposition 7.1.30, this condition for the estimator ̂γ may be formulated
as follows. If θ ∈Θ is the “true” parameter, then the expected value of ̂γ should be γ(θ).
To make this more precise,8 we need the following notation.
Definition 8.5.20. Let (𝒳, ℱ, ℙθ)θ∈Θ be a statistical model and let X : 𝒳→ℝbe a random variable. We
write 𝔼θX whenever the expected value of X is taken with respect to ℙθ. Similarly, in this case define
𝕍θX = 𝔼θ|X −𝔼θX|2
as variance of X. Of course, we have to assume that the expected value and/or the variance exist.
Remark 8.5.21. If X is discrete with values in {t1, t2, . . .}, then
𝔼θX =
∞
∑
j=1
tj ℙθ{X = tj} .
The case of continuous X is slightly more difficult because here we have to describe the
density function of X with respect to ℙθ.
To become acquainted with Definition 8.5.20, the two following examples may be
helpful. The first deals with the discrete case, while the second with the continuous
one.
Example 8.5.22. Suppose the daily number of customers in a shopping center is Pois-
son distributed with unknown parameter λ > 0. To estimate this parameter, we record
the number of customers on n different days. Thus, the sample we obtain is a vector
⃗k = (k1, . . . , kn) with kj ∈ℕ0, where kj is the number of customers on day j. The de-
scribing statistical model is given by (ℕn
0, 𝒫(ℕn
0), Pois⊗n
λ )λ>0 with distribution Poisλ. Let
X : ℕn
0 →ℝbe defined by
8 How the expected value is defined? Note that we do not have only one probability measure, but many
different ones.

424
౪
8 Mathematical statistics
X( ⃗k) = X(k1, . . . , kn) := 1
n
n
∑
j=1
kj ,
⃗k = (k1, . . . , kn) ∈ℕn
0 .
Which value does 𝔼λX possess?
Answer: If we choose Pois⊗n
λ
as probability measure, then all Xjs defined by
Xj(k1, . . . , kn) := kj are Poisλ-distributed (and independent, but this is not needed here).
Note that Xj is nothing else as the number of customers at day j. Hence, by Proposi-
tion 5.1.16, the expected value of Xj is λ, and since X = 1
n ∑n
j=1 Xj, we finally obtain
𝔼λX = 𝔼λ( 1
n
n
∑
j=1
Xj) = 1
n
n
∑
j=1
𝔼λXj = 1
n nλ = λ .
Example 8.5.23. Take
(ℝn, ℬ(ℝn), 𝒩(μ, σ2)
⊗n)(μ,σ2)∈ℝ×(0,∞)
as the statistical model. Thus, the parameter is of the form (μ, σ2) for some μ ∈ℝand
σ2 > 0. Define X : ℝn →ℝby X(x) =
̄x. If the underlying measure is 𝒩(μ, σ2)⊗n, then9
X is 𝒩(μ, σ2/n)-distributed. Consequently, in view of Propositions 5.1.36 and 5.2.29, we
obtain
𝔼μ,σ2X = μ
and
Vμ,σ2X = σ2
n .
Using the notation introduced in Definition 8.5.20, the above-mentioned require-
ment for “good” estimators may now be formulated more precisely.
Definition 8.5.24. An estimator ̂γ : 𝒳→ℝis said to be an unbiased estimator for γ : Θ →ℝprovided
that for each θ ∈Θ,
𝔼θ| ̂γ| < ∞
and
𝔼θ ̂γ = γ(θ) .
Remark 8.5.25. In view of Proposition 7.1.30, an estimator ̂γ is unbiased if it possesses
the following property: observe N independent samples x1, . . . , xN of a statistical ex-
periment. Suppose that θ ∈Θ is the “true” parameter (according to which the xjs are
distributed). Then
ℙ{ lim
N→∞
1
N
N
∑
j=1
̂γ(xj) = γ(θ)} = 1 .
Thus, on average, the estimator ̂γ approximately meets the correct value.
9 Compare with the first part of the proof of Proposition 8.4.3.

8.5 Point estimators
౪
425
Example 8.5.26. Let us investigate whether the estimator in Example 8.5.13 is unbiased.
The statistical model is (𝒳, 𝒫(𝒳), Bn,θ)0≤θ≤1, where 𝒳= {0, . . . , n} and the estimator ̂θ
acts as
̂θ(k) = k
n ,
k = 0, . . . , n .
Setting Z := n ̂θ, then Z is the identity on 𝒳, hence Bn,θ-distributed. Proposition 5.1.13
implies 𝔼θZ = n θ, thus,
𝔼θ ̂θ = 𝔼θ(Z/n) = 𝔼θZ/n = θ .
(8.46)
Equation (8.46) holds for all θ ∈[0, 1], that is, ̂θ is an unbiased estimator for θ.
Example 8.5.27. Next we come back to the problem presented in Example 8.5.22. The
number of customers per day is Poisλ-distributed with an unknown parameter λ > 0.
The data of n days are combined into a vector ̂k = (k1, . . . , kn) ∈ℕn
0. Then the parameter
λ > 0 is estimated by ̂λ defined as
̂λ( ⃗k) = ̂λ(k1, . . . , kn) := 1
n
n
∑
j=1
kj .
Is this estimator for λ unbiased?
Answer: Yes, it is unbiased. Observe that ̂λ coincides with the random variable X
investigated in Example 8.5.22. There we proved 𝔼λ = λ, hence, if λ > 0, then we have
𝔼λ ̂λ = λ .
Example 8.5.28. We are given certain data x1, . . . , xn, which are known to be normally
distributed and independent, and where the expected value μ and the variance σ2 of the
underlying probability measure are unknown. Thus, the describing statistical model is
(ℝn, ℬ(ℝn), 𝒩(μ, σ2)
n)(μ,σ2)∈Θ
with Θ = ℝ× (0, ∞) .
The aim is to find unbiased estimators for μ and for σ2. Let us begin with estimating μ.
That is, if γ is defined by γ(μ, σ2) = μ, then we want to construct an unbiased estimator
̂γ for γ. Let us take the MLE ̂γ defined as
̂γ(x) := ̄x = 1
n
n
∑
j=1
xj ,
x = (x1, . . . , xn) .
Due to the calculations in Example 8.5.23, we obtain
𝔼μ,σ2 ̂γ = μ = γ(μ, σ2) .
This holds for all μ and σ2, hence ̂γ is an unbiased estimator for μ = γ(μ, σ2).

426
౪
8 Mathematical statistics
How to find a suitable estimator for σ2? This time the function γ has to be chosen as
γ(μ, σ2) := σ2. With s2
x defined in eq. (8.14), set
̂γ(x) := s2
x =
1
n −1
n
∑
j=1
(xj −̄x)2 ,
x ∈ℝn .
Is this an unbiased estimator for σ2? To answer this, we use property (8.17) of Proposi-
tion 8.4.3. It asserts that the random variable x 󳨃→(n −1) s2
x
σ2 is χ2
n−1-distributed, provided
it is defined on (ℝn, ℬ(ℝn), 𝒩(μ, σ2)⊗n). Consequently, by Corollary 5.1.32, it follows that
𝔼μ,σ2[(n −1) s2
x
σ2 ] = n −1 .
Using the linearity of the expected value, we finally obtain
𝔼μ,σ2 ̂γ = 𝔼μ,σ2 s2
x = σ2 .
Therefore, ̂γ(x) = s2
x is an unbiased10 estimator for σ2.
Remark 8.5.29. Taking the estimator ̂γ(x) = σ2
x in the previous example, then, in view
of σ2
x = n−1
n s2
x, it follows that
𝔼μ,σ2 ̂γ = n −1
n
σ2 .
Thus, the estimator ̂γ(x) = σ2
x is biased. But note that
lim
n→∞
n −1
n
σ2 = σ2 ,
hence, if the sample size n is big, then this estimator is “almost” unbiased. One says in
this case the sequence of estimators (in dependence on n) is asymptotically unbiased.
The next example is slightly more involved, but of great interest in application.
Example 8.5.30. The lifetime of light bulbs is supposed to be exponentially distributed
with some unknown parameter λ > 0. To estimate λ, we switch on n light bulbs and
record the times t1, . . . , tn when they burn out. Thus, the observed sample is a vector
t = (t1, . . . , tn) in (0, ∞)n. As an estimator for λ we choose
̂λ(t) :=
n
∑n
j=1 tj
= 1/ ̄t .
Is this an unbiased estimator for λ?
10 This explains why s2
x is called the unbiased sample variance.

8.5 Point estimators
౪
427
Answer: The statistical model describing this experiment is
(ℝn, ℬ(ℝn), E⊗n
λ )λ>0.
If the random variables Xj are defined by Xj(t) := tj, then they are independent and
Eλ-distributed. Because of Proposition 4.6.6, their sum X := ∑n
j=1 Xj possesses an Erlang
distribution with parameters n and λ. An application of eq. (5.24) in Proposition 5.1.38
for f (x) := n
x implies
𝔼λ ̂λ = 𝔼λ( n
X ) =
∞
∫
0
n
x
λn
(n −1)!xn−1e−λx dx .
A change of variables s = λx transforms the latter integral into
λn
(n −1)!
∞
∫
0
sn−2 e−s ds =
λn
(n −1)! Γ(n −1) =
λn
(n −1)! ⋅(n −2)! = λ ⋅
n
n −1 .
This tells us that ̂λ is not an unbiased estimator for λ. But, as mentioned in Remark 8.5.29
for σ2
x, the sequence of estimators is asymptotically unbiased as n →∞.
Remark 8.5.31. If we replace the estimator in Example 8.5.30 by
̂λ(t) := n −1
∑n
j=1 tj
=
1
1
n−1 ∑n
j=1 tj
,
t = (t1, . . . , tn) ,
then the previous calculations imply
𝔼λ ̂λ = n −1
n
⋅λ ⋅
n
n −1 = λ .
Hence, from this small change we get an unbiased estimator ̂λ for λ.
Observe that the calculations in Example 8.5.30 were only valid for n ≥2. If n = 1,
then the expected value of ̂λ does not exist.
Summary: Suppose we want to estimate the value γ(θ) for some function γ : Θ →ℝ. Let ̂γ : 𝒳→ℝbe
some point estimator for γ(θ). A basic property of a good estimator ̂γ is that it should be unbiased. That is,
on average, it should give us the correct value γ(θ), no matter which θ ∈Θ is the right one. In formulas, this
means that an estimator ̂γ is unbiased if given θ ∈Θ, 𝔼θ ̂γ = γ(θ).
8.5.3 Risk function
Let (𝒳, ℱ, ℙθ)θ∈Θ be a parametric statistical model. Furthermore, γ : Θ →ℝis a func-
tion of the parameter and ̂γ : 𝒳→Θ is an estimator for γ. Suppose θ ∈Θ is the true

428
౪
8 Mathematical statistics
parameter and we observe some x ∈𝒳. Then, in general, we will have γ(θ)
̸= ̂γ(x), and
the quadratic error |γ(θ) −̂γ(x)|2 occurs. Other ways to measure the error are possible
and useful, but we restrict ourselves to the quadratic distance. In this way, we get the
so-called loss function L : Θ × 𝒳→ℝof ̂γ defined by
L(θ, x) := 󵄨󵄨󵄨󵄨γ(θ) −̂γ(x)󵄨󵄨󵄨󵄨
2 .
In other words, if θ is the correct parameter and our sample is x ∈𝒳, then, using ̂γ as
the estimator, the (quadratic) error or loss will be L(θ, x). On average, the (quadratic)
loss is evaluated by 𝔼θ|γ(θ) −̂γ|2 .
Definition 8.5.32. The function R describing this average loss of ̂γ is said to be the risk function of the
estimator ̂γ. It is defined by
R(θ, ̂γ) := 𝔼θ
󵄨󵄨󵄨󵄨󵄨γ(θ) −̂γ󵄨󵄨󵄨󵄨󵄨
2 ,
θ ∈Θ .
Before giving some examples of risk functions, let us rewrite R as follows.
Proposition 8.5.33. If θ ∈Θ, then it follows that
R(θ, ̂γ) = 󵄨󵄨󵄨󵄨γ(θ) −𝔼θ ̂γ󵄨󵄨󵄨󵄨
2 + 𝕍θ ̂γ .
(8.47)
Proof. The assertion is a consequence of
R(θ, ̂γ) = 𝔼θ[γ(θ) −̂γ]
2 = 𝔼θ[(γ(θ) −𝔼θ ̂γ) + (𝔼θ ̂γ −̂γ)]
2
= 󵄨󵄨󵄨󵄨γ(θ) −𝔼θ ̂γ󵄨󵄨󵄨󵄨
2 + 2(γ(θ) −𝔼θ ̂γ) 𝔼θ(𝔼θ ̂γ −̂γ) + 𝕍θ ̂γ .
Because of
𝔼θ(𝔼θ ̂γ −̂γ) = 𝔼θ ̂γ −𝔼θ ̂γ = 0 ,
this implies eq. (8.47).
Definition 8.5.34. The function θ 󳨃→|γ(θ) −𝔼θ ̂γ|2, appearing in eq. (8.47), is said to be the bias or the
systematic error of the estimator ̂γ.
Corollary 8.5.35. A point estimator ̂γ is unbiased if and only if for all θ ∈Θ its bias is
zero. Moreover, if this is so, then its risk function is given by
R(θ, ̂γ) = 𝕍θ ̂γ ,
θ ∈Θ .
Remark 8.5.36. Another way to formulate eq. (8.47) is as follows. The risk function of an
estimator consists of two parts. One part is the systematic error, which does not occur
for unbiased estimators. And the second part is given by 𝕍θ ̂γ. Thus, the smaller the bias

8.5 Point estimators
౪
429
and/or 𝕍θ ̂γ, the smaller the risk to get a wrong estimate for γ(θ), and the better the
estimator.
Example 8.5.37. Let us determine the risk functions for the two estimators presented
in Example 8.5.28. The estimator ̂γ for μ was given by ̂γ(x) = ̄x. Since this is an unbiased
estimator, by Corollary 8.5.35, its risk function is computed as
R((μ, σ2), ̂γ) = V(μ,σ2) ̂γ .
The random variable x 󳨃→̄x is 𝒩(μ, σ2/n)-distributed, hence
R((μ, σ2), ̂γ) = σ2
n .
There are two interesting facts about this risk function. First, it does not depend on the
parameter μ that we want to estimate. And secondly, if n →∞, then the risk tends to
zero. In other words, the bigger the sample size, the less the risk for a wrong estimate.
Next we evaluate the risk function of the estimator ̂γ(x) = s2
x. As we saw in Exam-
ple 8.5.30, this ̂γ is also an unbiased estimator for σ2, hence
R((μ, σ2), ̂γ) = V(μ,σ2) ̂γ .
From eq. (8.17), we know that n−1
σ2 s2
x is χ2
n−1-distributed, hence Corollary 5.2.28 implies
𝕍(μ,σ2)[n −1
σ2
s2
x] = 2 (n −1) .
From this, one easily derives
R((μ, σ2), ̂γ) = 𝕍(μ,σ2)s2
x = 2 (n −1) ⋅
σ4
(n −1)2 = 2σ4
n −1 .
Here, the risk function depends heavily on the parameter σ2 that we want to estimate.
Furthermore, if n →∞, then also in this case the risk tends to zero.
Example 8.5.38. Finally, consider the statistical model (𝒳, 𝒫(𝒳), Bn,θ)0≤θ≤1, where
𝒳= {0, . . . , n}. In order to estimate θ ∈[0, 1], we take, as in Example 8.5.26, the estimator
̂θ(k) = k
n. There it was shown that the estimator is unbiased, hence, by Corollary 8.5.35,
it follows that
R(θ, ̂θ) = 𝕍θ ̂θ ,
0 ≤θ ≤1 .
If X is the identity on 𝒳, by Proposition 5.2.18, its variance equals 𝕍θX = n θ(1−θ). Since
̂θ = X
n , this implies
R(θ, ̂θ) = 𝕍θ(X/n) = 𝕍θX
n2
= θ(1 −θ)
n
.

430
౪
8 Mathematical statistics
Consequently, the risk function becomes maximal for θ = 1/2, while for θ = 0 and θ = 1
it vanishes.
We saw in Corollary 8.5.35 that R(θ, ̂γ) = 𝕍θ ̂γ for unbiased ̂γ. Thus, for such estima-
tors inequality (7.2) implies
ℙθ{x ∈𝒳: 󵄨󵄨󵄨󵄨γ(θ) −̂γ(x)󵄨󵄨󵄨󵄨> c} ≤𝕍θ ̂γ
c2 ,
that is, the smaller the Vθ ̂γ, the greater the chance to estimate a value near the correct
one. This observation leads to the following definition.
Definition 8.5.39. Let ̂γ1 and ̂γ2 be two unbiased estimators for γ(θ). Then ̂γ1 is said to be uniformly
better than ̂γ2 provided that
Vθ ̂γ1 ≤𝕍θ ̂γ2
for all θ ∈Θ .
An unbiased estimator ̂γ∗is called the uniformly best estimator if it is uniformly better than all other
unbiased estimators for γ(θ).
Example 8.5.40. We observe values that, for some b > 0, are uniformly distributed on
[0, b]. But the number b > 0 is unknown. In order to estimate it, one executes n indepen-
dent trials and obtains as sample x = (x1, . . . , xn). As point estimators for b > 0 one may
either choose
̂b1(x) := n + 1
n
max
1≤i≤n xi
or
̂b2(x) := 2
n
n
∑
i=1
xi .
According to Problem 8.4, the estimators ̂b1 and ̂b2 are both unbiased. Furthermore, not
too difficult calculations show that
𝕍b ̂b1 =
b2
n(n + 2)
and
𝕍b ̂b2 = b2
3n2 .
Therefore, 𝕍b ̂b1 ≤𝕍b ̂b2 for all b > 0. This tells us that ̂b1 is uniformly better than ̂b2.
Remark 8.5.41. A very natural question is whether there exists a lower bound for the
precision of an estimator. In other words, are there estimators for which the risk func-
tion becomes arbitrarily small? The answer depends heavily on the inherent informa-
tion in the statistical model. To explain this, let us come back once more to Example 8.5.4.
Suppose we had ℙ0({a}) = 1 and ℙ1({b}) = 1. Then the occurrence of “a” would tell us
with 100 % confidence that θ = 0 is the correct parameter. The risk for the corresponding
estimator is then zero. On the contrary, if ℙ0({a}) = ℙ1({b}) = 1/2, then the occurrence
of “a” or “b” does us tell nothing about the correct parameter.
To make the previous observation more precise, we have to introduce some quantity
that measures the information contained in a statistical model.

8.5 Point estimators
౪
431
Definition 8.5.42. Let (𝒳, ℱ, ℙθ)θ∈Θ be a statistical model with log-likelihood function L introduced in
Definition 8.5.10. For simplicity, assume Θ ⊆ℝ. Then the function I : Θ →ℝdefined by
I(θ) := 𝔼θ( 𝜕L
𝜕θ )
2
is called the Fisher information of the model. Of course, we have to suppose that the derivatives and
the expected value exist.
Example 8.5.43. Let us investigate the Fisher information for the model treated in Ex-
ample 8.5.14. There we had
L(μ, σ2, x) = L(μ, σ2, x1, . . . , xn) = c −n
2 ln σ2 −
1
2σ2
n
∑
j=1
(xj −μ)2 .
Fix σ2 and take the derivative with respect to μ. This leads to
𝜕L
𝜕μ = n ̄x −nμ
σ2
,
hence
(𝜕L
𝜕μ)
2
= n2
σ4 | ̄x −μ|2 .
Recall that ̄x is 𝒩(μ, σ2/n)-distributed, hence the expected value of | ̄x −μ|2 is nothing
else than the variance of ̄x, that is, it is σ2/n. Consequently,
I(μ) = 𝔼μ,σ2(𝜕L
𝜕μ)
2
= n2
σ4
σ2
n = n
σ2 .
The following result answers the above question: how precise can an estimator be-
come at the most?
Proposition 8.5.44 (Rao–Cramér–Frechet). Let (𝒳, ℱ, ℙθ)θ∈Θ be a parametric model for
which the Fisher information I : Θ →ℝexists. If ̂θ is an unbiased estimator for θ, then
𝕍θ ̂θ ≥
1
I(θ) ,
θ ∈Θ .
(8.48)
Remark 8.5.45. Estimators ̂θ that attain the lower bound in estimate (8.48) are said to
be efficient. That is, for those estimators 𝕍θ ̂θ = 1/I(θ) for all θ ∈Θ. In other words,
efficient estimators possess the best possible accuracy.
In view of Examples 8.5.37 and 8.5.43, for normally distributed populations the esti-
mator ̂μ(x) = ̄x is an efficient estimator for μ. Other efficient estimators are those inves-
tigated in Examples 8.5.27 and 8.5.13. On the other hand, the estimator for σ2 in Exam-

432
౪
8 Mathematical statistics
ple 8.5.28 is not efficient. But it can be shown that s2
x is a uniformly best estimator for σ2,
that is, there do not exist efficient estimators in this case.
Summary: Let ̂γ : 𝒳→ℝbe a point estimator for γ(θ). Using ̂γ as estimator for γ(θ), the mean quadratic
error is measured by the risk function defined by
R(θ, ̂γ) := 𝔼θ
󵄨󵄨󵄨󵄨󵄨γ(θ) −̂γ󵄨󵄨󵄨󵄨󵄨
2 ,
θ ∈Θ .
The smaller the risk function, the better the estimator ̂γ. It holds that
R(θ, ̂γ) = 󵄨󵄨󵄨󵄨󵄨γ(θ) −𝔼θ ̂γ󵄨󵄨󵄨󵄨󵄨
2 + 𝕍θ ̂γ .
The first term is the systematic error which vanishes in the case of unbiased estimators, hence then R(θ, ̂γ) =
𝕍θ ̂γ. It depends on inner properties of the model (𝒳, ℱ, ℙθ)θ∈Θ how small 𝕍θ ̂γ can be chosen at most.
Estimators attaining this lower bound are said to be efficient.
8.6 Confidence regions and intervals
8.6.1 Construction of confidence regions
Point estimations provide us with a single value θ ∈Θ. Further work or necessary deci-
sions are then based on this estimated parameter. The disadvantage of this approach is
that we have no knowledge about the precision of the obtained value. Is the estimated
parameter far away from the true one or maybe very near? To explain the problem, let
us come back to the situation described in Example 8.5.17. If the retailer observes 4 de-
fective TV sets among 15 tested, then he estimates that there are 26 defective sets in the
delivery of 100. But he does not know how precise his estimate of 26 is. Maybe there are
much more defective sets in the delivery, or maybe less than 26. The only information
he has is that the estimates are correct on average. But this does not say anything about
the accuracy of a single estimate.
This disadvantage of point estimators is avoided when estimating a certain set of
parameters, not only a single point. Then the true parameter is contained with great
probability in this randomly chosen region. In most cases, these regions will be intervals
of real or natural numbers.
Definition 8.6.1. Suppose the parametric statistical model is (𝒳, ℱ, ℙθ)θ∈Θ. A mapping C : 𝒳→𝒫(Θ)
is called an interval estimator, provided for fixed θ ∈Θ,
{x ∈𝒳: θ ∈C(x)} ∈ℱ.
(8.49)
Remark 8.6.2. A better notation for the mapping C would be region or set estimator
because C(x) ⊆Θ may be an arbitrary subset, not necessarily an interval, but “interval
estimator” is commonly accepted, therefore, we use it here also.

8.6 Confidence regions and intervals
౪
433
Remark 8.6.3. Condition (8.49) is quite technical and will play no role later on. But it is
necessary because otherwise the next definition does not make sense.
Definition 8.6.4. Let α be a real number in (0, 1). Suppose an interval estimator C : 𝒳→𝒫(Θ) satisfies,
for each θ ∈Θ, the condition
ℙθ{x ∈𝒳: θ ∈C(x)} ≥1 −α .
(8.50)
Then C is said to be a 1 −α interval estimator (also 1 −α estimator). The sets C(x) ⊆Θ with x ∈𝒳are
called 1 −α confidence regions or confidence intervals (sometimes also called 100(1 −α)% confidence
regions or intervals).
How does an interval estimator apply? Suppose θ ∈Θ is the “true” parameter. In a statis-
tical experiment, one obtains some sample x ∈𝒳distributed according to ℙθ. Depend-
ing on the observed sample x, we choose a set C(x) of parameters. Then with probability
greater than or equal to 1 −α, the observed x ∈𝒳leads to a region C(x) of parameters
which contains the true parameter θ.
Remark 8.6.5. It is important to say that the set C(x) is random, not the unknown pa-
rameter θ ∈Θ. Metaphorically speaking, a fish (the true parameter θ) is in a pond at
some fixed but unknown spot. We execute a certain statistical experiment to get some
information about the place where the fish is situated. Depending on the result of the ex-
periment, we throw a net into the pond. Doing so, we know that with probability greater
than or equal to 1 −α, the result of the experiment leads to a net that catches the fish. In
other words, the position of the fish is not random, it is the observed sample, hence also
the thrown net.
Remark 8.6.6. It is quite self-evident that one should try to choose the confidence sets
as small as possible, without violating condition (8.50). If we are not interested in “small”
confidence sets, then we could always chose C(x) = Θ. This is not forbidden, but com-
pletely useless because we do not get any information about the true value θ.
Construction of confidence regions via significance tests: For a better understanding of
the subsequent construction, let us shortly recall the main assertions about hypothesis
tests from a slightly different point of view.
Let (𝒳, ℱ, ℙϑ)ϑ∈Θ be a statistical model. We choose a fixed, but arbitrary, θ ∈Θ. With
this chosen θ, we formulate the null hypothesis as ℍ0 : ϑ = θ. The alternative hypothesis
is then ℍ1 : ϑ
̸= θ. Let T = (𝒳0, 𝒳1) be an α-significance test for ℍ0 against ℍ1. Because
the hypothesis, hence also the test, depends on the chosen θ ∈Θ, we denote the null
hypothesis by ℍ0(θ) and write T(θ) = (𝒳0(θ), 𝒳1(θ)) for the test. That is, ℍ0(θ) : ϑ = θ
and T(θ) is an α-significance test for ℍ0(θ). With this notation set (compare Figure 8.9)
C(x) := {θ ∈Θ : x ∈𝒳0(θ)} .
(8.51)

434
౪
8 Mathematical statistics
Figure 8.9: The equivalence between x ∈𝒳0(θ) and θ ∈C(x).
Remark 8.6.7. Verbally said, an index θ ∈Θ belongs to C(x) provided the observation
of x ∈𝒳supports the hypothesis that θ is the correct parameter. For example, assume
that there are only finitely many indices θ1, . . . , θn. Then one may formulate n different
hypothesis, namely ℍ0(θ1) : ϑ = θ1 up to ℍ0(θn) : ϑ = θn. Applying to each of these
hypotheses an α-significance test, we obtain n regions 𝒳0(θ1) up to 𝒳0(θn) of acceptance.
Now, observing x ∈𝒳, we choose those θj for which x ∈𝒳0(θj). That is, observing x ∈𝒳,
for those θj this would not lead to a rejection of ℍ0(θj). So we set
C(x) = {θj : x ∈𝒳0(θj)} .
Example 8.6.8. Choose the hypothesis and the test as in Proposition 8.4.15. The statis-
tical model is then given by (ℝn, ℬ(ℝn), 𝒩(ν, σ2
0)⊗n)ν∈ℝ, where this time we denote the
unknown expected value by ν. For some fixed, but arbitrary, μ ∈ℝlet
ℍ0(μ) : ν = μ
and
ℍ1(μ) : ν
̸= μ .
The α-significance test T(μ) constructed in Proposition 8.4.15 possesses the region of ac-
ceptance
𝒳0(μ) = {x ∈ℝn : √n
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
̄x −μ
σ0
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
≤z1−α/2} .
Thus, in this case, the set C(x) in eq. (8.51) consists of those μ ∈ℝthat satisfy the estimate
√n | ̄x−μ
σ0 | ≤z1−α/2. That is, given x ∈ℝn, then C(x) is the interval
C(x) = [ ̄x −σ0
√n z1−α/2 ,
̄x + σ0
√n z1−α/2] .
Let us come back to the general situation. The statistical model is (𝒳, ℱ, ℙϑ)ϑ∈Θ.
Given θ ∈Θ, let T(θ) be an α-significance test for ℍ0(θ) against ℍ1(θ) where ℍ0(θ) is the
hypothesis ℍ0(θ) : ϑ = θ. Given x ∈𝒳, define C(x) ⊆Θ by eq. (8.51). Then the following
is valid.
Proposition 8.6.9. Let T(θ) be as above an α-significance test for ℍ0(θ) against ℍ1(θ).
Define C(x) by eq. (8.51) where 𝒳0(θ) denotes the region of acceptance of T(θ). Then the

8.6 Confidence regions and intervals
౪
435
mapping x 󳨃→C(x) from 𝒳into 𝒫(Θ) is a 1 −α interval estimator. Hence, {C(x) : x ∈𝒳} is
a collection of 1 −α confidence regions.
Proof. By assumption, T(θ) is an α-significance test for ℍ0(θ). The definition of those
tests tells us that
ℙθ(𝒳1(θ)) ≤α ,
hence ℙθ(𝒳0(θ)) ≥1 −α .
Given θ ∈Θ and x ∈𝒳, by the construction of C(x), one has θ ∈C(x) if and only if
x ∈𝒳0(θ). Combining these two observations, given θ ∈Θ, then it follows that
ℙθ{x ∈𝒳: θ ∈C(x)} = ℙθ{x ∈𝒳: x ∈𝒳0(θ)} = ℙθ(𝒳0(θ)) ≥1 −α .
This completes the proof.
Summary: Suppose the parametric statistical model is (𝒳, ℱ, ℙθ)θ∈Θ. To each x ∈𝒳, we assign a subset
C(x) ⊆Θ such that for a given α > 0 the following holds: if ℙθ is the true probability measure, then with
probability greater than 1 −α we observe an x ∈𝒳such that θ ∈C(x). That is, for all θ ∈Θ it follows
that
ℙθ{x ∈𝒳: θ ∈C(x)} ≥1 −α .
The (random) sets C(x) are called 1 −α confidence sets.
There exists a tight relation between the construction of the confidence sets C(x) and hypothesis tests.
If T(θ) = (𝒳0(θ), 𝒳1(θ)) is an α-test for the hypothesis ℍ0 : “θ is the true parameter,” then
C(x) = {θ ∈Θ : x ∈𝒳0(θ)}
are 1−α confidence sets. Verbally said, a parameter θ belongs to C(x) if the occurrence of x does not contradict
the hypotheses that θ is the correct parameter.
Test of a hypothesis ℍ0
⇒
fixed region 𝒳0 ⊆𝒳of acceptance,
Confidence regions
⇒
random region C(x) ⊆Θ of probable parameters.
8.6.2 Normally distributed samples
The aim of this section is to apply Proposition 8.6.9 to transform results about two-sided
significance tests for normally distributed samples into assertions about confidence in-
tervals.
We start with the application of the two-sided Z-test for 𝒩(μ, σ2
0)-distributed sam-
ples with known variance σ2
0 > 0.
Proposition 8.6.10. Let x = (x1, . . . , xn) be a sample of n independent 𝒩(μ, σ2
0) distributed
numbers. Here μ ∈ℝis unknown while σ2
0 is known. Then with probability greater than

436
౪
8 Mathematical statistics
1 −α the observed sample x ∈ℝn leads to11
̄x −σ0
√n z1−α/2 ≤μ ≤̄x + σ0
√n z1−α/2 .
Recall that zβ denotes the β-quantile of the standard normal distribution.
Proof. This is a direct consequence of applying Proposition 8.6.9 to the result presented
in Example 8.6.8.
Example 8.6.11. Choose α = 0.05 and suppose we observed the nine values
10.1 ,
9.2 ,
10.2 ,
10.3 ,
10.1 ,
9.9 ,
10.0 ,
9.7 ,
9.8 ,
then ̄x = 9.9222. The variance σ0 is known to be σ2
0 = 0.330824. That is, we assume that
s2
x is the correct variance. Because of z1−α/2 = z0.975 = 1.95996, with a confidence of 95 %
our sample of nine numbers leads to
9.7061 ≤μ ≤10.1384 .
In the next result we describe the confidence intervals generated by the t-test
treated in Proposition 8.4.15.
Proposition 8.6.12. Let x = (x1, . . . , xn) be a sample of n independent 𝒩(μ, σ2) distributed
numbers. Here μ ∈ℝand σ2 are both unknown. Then with probability greater than 1 −α
the observed sample x ∈ℝn leads to
̄x −sx
√n tn−1;1−α/2 ≤μ ≤
̄x + sx
√n tn−1;1−α/2 .
Recall that tn−1;β denotes the β-quantile of the Student tn−1-distribution.
Proof. This is a direct consequence of
𝒳0(μ) = {x ∈ℝn : √n
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
̄x −μ
sx
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
≤tn−1;1−α/2} ,
hence Proposition 8.6.9 implies that, given x ∈ℝn, then
C(x) = {μ ∈ℝ: √n
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
̄x −μ
sx
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
≤tn−1;1−α/2}
= [ ̄x −sx
√n tn−1;1−α/2 ,
̄x + sx
√n tn−1;1−α/2] .
11 We want to point this out again: not μ is random but the chosen interval is such. And 1 −α is the
probability to observe an x for which the random interval contains the correct μ.

8.6 Confidence regions and intervals
౪
437
Example 8.6.13. Let us explain the previous result by the concrete sample investigated
in Example 8.4.20. There we had ̄x = 22.072, sx = 0.07554248, and n = 10. If α = 0.05,
the quantile of t9 equals t9;0.975 = 2.26. From this, we derive [22.016, 22.126] as the 95 %
confidence interval.
Verbally this says that with a confidence of 95 % we observed those x1, . . . , x10 for
which μ ∈C(x) = [22.016, 22.126].
Finally, let us construct 1 −α confidence intervals for the unknown variance of a
normal sample.
Proposition 8.6.14. Let x = (x1, . . . , xn) be a sample of n independent 𝒩(μ, σ2) distributed
numbers. If μ is known, then with probability greater than 1−α the observed sample x ∈ℝn
leads to
nσ2
x
χ2
n;1−α/2
≤σ2 ≤nσ2
x
χ2
n;α/2
where, in contrast to eq. (8.14),
σ2
x = 1
n
n
∑
j=1
(xj −μ)2 .
(8.52)
If, on the contrary, μ is unknown, then with probability greater than 1 −α the observed
sample x ∈ℝn gives
(n −1) s2
x
χ2
n−1;1−α/2
≤σ2 ≤(n −1) s2
x
χ2
n−1;α/2
.
Here s2
x is as in Definition 8.4.1 and χ2
n;β denotes the β-quantile of a χ2
n distribu-
tion.
Proof. Both assertions easily follow from eqs. (8.27) and (8.28). Recall that they imply for
known mean value μ that
𝒳0(σ2) = {x ∈ℝn : χ2
n;α/2 ≤
n
∑
j=1
(xj −μ)2
σ2
≤χ2
n;1−α/2}
while in the case of unknown μ one has
𝒳0(σ2) = {x ∈ℝn : χ2
n−1;α/2 ≤(n −1) s2
x
σ2 ≤χ2
n−1;1−α/2}.
Letting in both cases C(x) = {σ2 > 0 : x ∈𝒳0(σ2)} completes the proof.
Example 8.6.15. A measuring instrument possesses an unknown precision. In order to
get some information about it, we measure a certain item 9 times. The obtained re-

438
౪
8 Mathematical statistics
sults are
10.1,
10.3,
10.2,
10.7,
9.9,
10.0,
10.9,
8.9
and
11.0 .
Let x = (x1, . . . , x9) be the collection of these measurements. Then the mean value equals
̄x = 10.222, hence the unbiased variance of the observed sample is calculated by
s2
x = 1
8
9
∑
j=1
(xj −̄x)2 = 0.4019 .
If we choose α = 0.1 as a significance level, then, in order to determine a 90 % confidence
interval, we need the 0.05 and 0.95 quantiles of a χ2
8 distribution. They are
χ2
8;0.05 = 2.73264
and
χ2
8;0.95 = 15.5073 .
So we finally obtain that there is chance of 90 % that the unknown variance σ2 of the
measuring instrument satisfies
8 ⋅0.4019
15.5073
= 0.207334 ≤σ2 ≤8 ⋅0.4019
2.73264
= 1.17659 .
Note that another n measurements by this instrument, of this or of a different item, will
surely lead to different bounds for σ2.
To conclude this section, let us summarize the most important confidence intervals
for normally distributed samples. Here σ2
x and s2
x are defined by eqs. (8.52) and (8.14),
respectively.
Name
Parameters
1 −α Confidence Intervals
Confidence intervals for the mean value
σ2 > 0 known
[ ̄x −
σ
√n z1−α/2 ,
̄x +
σ
√n z1−α/2]
Confidence intervals for the mean value
σ2 > 0 unknown
[ ̄x−sx
√n tn−1;1−α/2 ,
̄x+ sx
√n tn−1;1−α/2]
Confidence intervals for the variance
μ ∈ℝknown
[
n σ2
x
χ2
n;1−α/2
,
n σ2
x
χ2
n;α/2
]
Confidence intervals for the variance
μ ∈ℝunknown
[ (n−1) s2
x
χ2
n−1;1−α/2
,
(n−1) s2
x
χ2
n−1;α/2
]
8.6.3 Binomial distributed populations
The aim of this section is to show how Proposition 8.6.9 applies in the case of binomial
distributed populations. Thus, we execute n independent trials where every time occurs
either success or failure. Hence, the number of successes is Bn,θ-distributed for a certain

8.6 Confidence regions and intervals
౪
439
θ ∈[0, 1]. But, in contrast to the investigations in Section 1.4.3, now the parameter θ is
unknown.
Say we observed 0 ≤k ≤n times success. Then we look for a confidence interval
C(k) ⊆[0, 1] such that very likely θ ∈C(k). More precisely, given 0 < α < 1, we want that
for any parameter θ ∈[0, 1],
Bn,θ{k ≤n : θ ∈C(k)} ≥1 −α .
That is, with probability greater than 1 −α the observation of k successes leads to an
interval C(k) containing the correct parameter θ.
Proposition 8.6.16. The statistical model is (𝒳, 𝒫(𝒳), Bn,θ)0≤θ≤1 where the sample space
is 𝒳= {0, . . . , n}. Given α > 0 and k = 0, . . . , n, define sets C(k) ⊆[0, 1] as follows:
C(k) = {θ : Bn,θ({0, . . . , k}) > α/2} ∩{θ : Bn,θ({k, . . . , n}) > α/2}.
(8.53)
Then for each k ≤n, the set C(k) is an 1 −α confidence interval for θ ∈[0, 1].
Proof. In order to get these confidence regions, we use Proposition 8.6.9. As shown in
Proposition 8.3.1, the region of acceptance 𝒳0(θ) of an α-significance test T(θ), where
ℍ0 : ϑ = θ, is given by
𝒳0(θ) = {n0(θ), . . . , n1(θ)} .
Here, the numbers n0(θ) and n1(θ) were defined by
n0(θ) := min{k ≤n :
k
∑
j=0
(n
j )θj(1 −θ)n−j > α/2}
and
n1(θ) := max{k ≤n :
n
∑
j=k
(n
j )θj(1 −θ)n−j > α/2} .
Applying Proposition 8.6.9, the sets
C(k) := {θ ∈[0, 1] : k ∈𝒳0(θ)} = {θ ∈[0, 1] : n0(θ) ≤k ≤n1(θ)} ,
k = 0, . . . , n ,
are 1 −α confidence regions. By the definition of n0(θ) and n1(θ), given k ≤n, then a
number θ ∈[0, 1] satisfies n0(θ) ≤k ≤n1(θ) if and only if at the same time
Bn,θ({0, . . . , k}) =
k
∑
j=0
(n
j )θj(1 −θ)n−j > α/2
and
Bn,θ({k, . . . , n}) =
n
∑
j=k
(n
j )θj(1 −θ)n−j > α/2 .

440
౪
8 Mathematical statistics
Thus, as claimed,
C(k) = {θ : Bn,θ({0, . . . , k}) > α/2} ∩{θ : Bn,θ({k, . . . , n}) > α/2}
are 1 −α confidence sets.
It remains to prove that these are indeed intervals, which by the definition of the
sets C(k) is not so obvious. We know by Lemma 8.3.6 that the function
f{≥k} : θ 󳨃→
n
∑
j=k
(n
j )θj(1 −θ)n−j
(8.54)
is nondecreasing for any k ≥0. Hence,
f{≤k} : θ 󳨃→
k
∑
j=0
(n
j )θj(1 −θ)n−j = 1 −
n
∑
j=k+1
(n
j )θj(1 −θ)n−j
(8.55)
is nonincreasing. Letting
θ−
k = inf{θ : f{≥k}(θ) > α
2 }
and
θ+
k = sup{θ : f{≤k}(θ) > α
2 } ,
it follows that C(k) = (θ−
k, θ+
k). This completes the proof.
Remark 8.6.17. The intervals C(k) = (θ−
k, θ+
k) are usually called 100(1 −α)% Clopper–
Pearson intervals or also exact confidence intervals for the binomial distribution.
Since the functions f{≤k} and f{≥k} are continuous on [0, 1], in the case 1 < k < n, the
numbers θ−
k and θ+
k are also characterized by
f{≥k}(θ−
k) = α
2
and
f{≤k}(θ+
k) = α
2 .
In other words, if 1 < k < n, then the endpoints of the Clopper–Pearson intervals are
the unique solution θ ∈(0, 1) of
n
∑
j=k
(n
j )θj(1 −θ)n−j = α
2
or
k
∑
j=0
(n
j )θj(1 −θ)n−j = α
2 ,
respectively. For the cases k = 0 and k = n, we refer to Problem 8.6.
Example 8.6.18. Suppose we execute n = 20 trials and observe k = 5 successes. What
can be said about the underlying success probability θ? The functions in eqs. (8.54)
and (8.55) are in this case given by
f{≥5}(θ) =
20
∑
j=5
(20
j )θj(1 −θ)20−j
and
f{≤5}(θ) =
5
∑
j=0
(20
j )θj(1 −θ)20−j .

8.6 Confidence regions and intervals
౪
441
If α = 0.1, then numerical calculations lead to (see also Fig. 8.10)
θ−
5 = inf{θ : f{≥5}(θ) > 0.05} ≈0.1041
and
θ+
5 = sup{θ : f{≤5}(θ) > 0.05} ≈0.4566 .
Figure 8.10: The increasing function f{≥5} and the decreasing one f{≤5}, both taken with for n = 20. The
horizontal line marks the significance level α/2 = 0.05.
Consequently, with the probability of 90 % our observation of five successes implies that
the underlying success probability θ satisfies
0.1041 < θ < 0.4566 .
(8.56)
The estimates for θ obtained in (8.56) are quite rough. This is mainly due to the fact
that the number n = 20 of trials is pretty small. Also different numbers of success do not
yield significantly tighter bounds. So, for example, if one observes 10 successes, then as
the 90 % confidence interval one gets
0.30196 < θ < 0.69804 .
The next example provides sharper bounds for larger n ≥1.
Example 8.6.19. In an urn there are white and black balls with an unknown proportion
θ of white balls. In order to get some information about θ, we choose randomly 500 balls
with replacement. Say 220 of the chosen balls are white. What is the 90 % confidence
interval for θ based on this observation?
Answer: We have n = 500 and observed k = 220 white balls. Consequently, a 90 %
confidence interval C(220) consists of those θ ∈[0, 1] for which at the same time
f{≥220}(θ) > α/2 = 0.05
and
f{≤220}(θ) > α/2 = 0.05 .

442
౪
8 Mathematical statistics
Note that in this case
f{≤220}(θ) =
220
∑
j=0
(500
j )θj(1 −θ)500−j
and
f{≥220}(θ) =
500
∑
j=220
(500
j )θj(1 −θ)500−j .
Numerical calculations tell us that
θ−
220 ≈0.4028
and
θ+
220 ≈0.4777 .
Therefore, a 90 % confidence interval C(220) is given by
C(220) = (0.4028, 0.4777) .
For n = 1000 and 440 observed white balls, the calculations lead to the smaller, hence
more significant, interval C(440) = (0.4139, 0.4664) .
Remark 8.6.20. The previous example already indicates that the determination of the
Clopper–Pearson intervals becomes quite complicated for large n. Therefore, one looks
for “approximate” intervals. Background for the construction is the central limit theo-
rem in the form presented in Proposition 7.2.19. For Sns distributed according to Bn,θ, it
implies
lim
n→∞ℙ{
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
Sn −nθ
√nθ(1 −θ)
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
≤z1−α/2} = 1 −α ,
or, equivalently,
lim
n→∞Bn,θ{k ≤n :
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
k −nθ
√nθ(1 −θ)
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
≤z1−α/2} = 1 −α .
Here z1−α/2 is the 1 −α/2 quantile introduced in Definition 8.4.8. Thus, an “approximate”
region of acceptance, testing the hypothesis “the unknown parameter is θ,” is given
by
𝒳0(θ) = {k ≤n :
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
k
n −θ
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
≤z1−α/2√θ(1 −θ)
n
} .
(8.57)
An application of Proposition 8.6.9 leads to certain confidence regions, but mostly they
cannot be described explicitly. Due to the term √θ(1 −θ) on the right-hand side of
eq. (8.57), it is not possible, for a given k ≤n, to determine those θs for which k ∈𝒳0(θ).
To overcome this difficulty, we change 𝒳0(θ) yet again by replacing θ on the right-hand
side by its MLE ̂θ(k) = k
n. That is, we replace eq. (8.57) by

8.6 Confidence regions and intervals
౪
443
̃
𝒳0(θ) = {k ≤n :
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
k
n −θ
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
≤z1−α/2√
k
n(1 −k
n)
n
} .
Doing so, an application of Proposition 8.6.9 leads to the “approximate” confidence in-
tervals ̃C(k), k = 0, …, n, defined as
̃C(k) = [k
n −z1−α/2 √
k
n(1 −k
n)
n
, k
n + z1−α/2 √
k
n(1 −k
n)
n
] .
(8.58)
Example 8.6.21. We investigate once more Example 8.6.19. Among 500 chosen balls we
observed 220 white. This observation led to the “exact” 90 % confidence interval C(220) =
(0.4028, 0.4777).
Let us compare this result with the interval we get by using the approximative ap-
proach. Since the quantile z1−α/2 for α = 0.1 equals z0.95 = 1.64485, the left and the right
endpoints of the interval (8.58) with k = 220 are evaluated by
220
500 −1.64485 ⋅√220 ⋅280
5003
= 0.4035
and
220
500 + 1.64485 ⋅√220 ⋅280
5003
= 0.4765 .
Thus, the “approximate” 90 % confidence interval is
̃C(220) = (0.4035, 0.4765), which
does not differ too much from C(220) = (0.4028, 0.4777).
In the case of 1000 trials and 440 white balls, the endpoints of a confidence interval
are evaluated by
440
1000 −1.64485 ⋅√440 ⋅560
10003
= 0.414181
and
440
1000 + 1.64485 ⋅√440 ⋅560
10003
= 0.4645819 .
That is, ̃C(440) = (0.4142, 0.4659) compared with C(440) = (0.4139, 0.4664).
Example 8.6.22. A few days before an election, 1000 randomly chosen people are ques-
tioned whom they will vote for next week, either candidate A or candidate B. Suppose
540 of the interviewed people answered that they would vote for candidate A, the re-
maining 460 favored candidate B. Find a 90 % confidence interval for the expected result
of candidate A in the election.
Solution: We have n = 1000, k = 540, and α = 0.1. The quantile of level 0.95 of
the standard normal distribution equals z0.95 = 1.64485 (see Example 8.6.21). This leads
to [0.514, 0.566] as “approximate” 90 % confidence interval for the expected result of
candidate A.

444
౪
8 Mathematical statistics
If one questions another 1000 randomly chosen people, another confidence inter-
val will occur. But, on average, in 9 of 10 cases questioning 1000 people will lead to an
interval containing the correct value.
Summary: The statistical model is (𝒳, 𝒫(𝒳), Bn,θ)0≤θ≤1 with 𝒳= {0, . . . , n}. Given α > 0 and k = 0, . . . , n,
define numbers θ−
k and θ+
k by
θ−
k = inf
{
{
{
θ ∈[0, 1] :
n
∑
j=k
(n
j )θj(1 −θ)n−j > α
2
}
}
}
,
θ+
k = sup
{
{
{
θ ∈[0, 1] :
k
∑
j=0
(n
j )θj(1 −θ)n−j > α
2
}
}
}
.
Letting C(k) = [θ−
k , θ+
k ], the C(k)s, 0 ≤k ≤n, are 1 −α confidence intervals for the unknown θ ∈[0, 1]. That
is, for all θ ∈[0, 1],
Bn,θ{k ≤n : θ ∈C(k)} ≥1 −α .
For large n ≥1, the central limit theorem applies and leads to the approximate 1 −α confidence intervals
̃C(k) = [ k
n −z1−α/2 √
k
n(1 −k
n)
n
, k
n + z1−α/2 √
k
n(1 −k
n)
n
] .
8.6.4 Hypergeometric distributed populations
Finally, we construct confidence intervals for hypergeometric distributed populations.
Since the technique is quite similar to that used in the case of binomial distribution, we
will not state all details. We refer everybody interested in them to Problem 8.7, to add
missing details in the construction.
So assume that in an urn there are N balls, colored white and black. Among them
there are M ≤N white balls, hence N −M are black. Hereby, the number M is unknown.
We choose now at random n ≤N balls. Denote by m ≤n the number of chosen white
balls. The aim is to determine for each m ≤n a set C(m) ⊆{0, . . . , N} so that
HN,M,n{m ≤n : M ∈C(m)} > 1 −α ,
0 ≤M ≤N .
Of course, thereby the confidence sets should be chosen as small as possible.
Before we can introduce confidence intervals for hypergeometric distributed sam-
ples, we first have to extend Proposition 8.2.19 to the case of two-sided tests. Since the
proof of this two-sided case is very similar to that for binomial distributed samples in
Proposition 8.3.1, we omit it. Furthermore, we formulate the two-sided tests already in
a way appropriate for later use.

8.6 Confidence regions and intervals
౪
445
Proposition 8.6.23. Let the statistical model be (𝒳, 𝒫(𝒳), HN,K,n)K=0,...,N with the sample
space 𝒳= {0, . . . , n}. Given an arbitrary M ≤N, an α-test for testing K = M against
K
̸= M is given by T(M) = (𝒳0(M), 𝒳1(M)) where the region of acceptance equals 𝒳0(M) =
{m0(M), . . . , m1(M)} with m0(M) and m1(M) defined by
m0(M) = min{k ≤n :
k
∑
m=0
(M
m)(N−M
n−m)
(N
n)
> α/2}
and
m1(M) := max{k ≤n :
n
∑
m=k
(M
m)(N−M
n−m)
(N
n)
> α/2} .
Before proceeding further, let us introduce two functions similar to those in
eqs. (8.54) and (8.55). For each k = 0, . . . , n and M ≤N, set
f{≥k}(M) =
n
∑
m=k
(M
m)(N−M
n−m)
(N
n)
= HN,M,n({k, . . . , n})
and
f{≤k}(M) =
k
∑
m=0
(M
m)(N−M
n−m)
(N
n)
= HN,M,n({0, . . . , k}) .
Lemma 8.2.20 implies that f{≥k} is nondecreasing, hence f{≤k} is nonincreasing. Verbally
said, if there are M white balls in the urn, then f{≥k}(M) is the probability to observe at
least k white in the sample of size n, while f{≤k}(M) tells us how likely it is for us to get k
or less white balls.
Given k = 0, . . . , n, define two numbers M−
k and M+
k (depending on α) by
M−
k = min{M : f{≥k}(M) > α
2 }
and
M+
k = max{M : f{≤k}(M) > α
2 } .
Compare Figure 8.11 for an example with N = 60, n = 15, and α = 0.1.
Proposition 8.6.24. Let the statistical model be (𝒳, 𝒫(𝒳), HN,M,n)M=0,...,N with the sample
space 𝒳= {0, . . . , n}. Given an arbitrary α > 0, for each 0 ≤k ≤n, the sets
C(k) = [M−
k , M+
k ] = {M ≤N : f{≥k}(M) > α
2 } ∩{M ≤N : f{≤k}(M) > α
2 }
are 1 −α confidential intervals for the unknown parameter M ≤N.
Proof. Applying Propositions 8.6.9 and 8.6.23, for each k ≤n, the sets
{M ≤N : k ∈𝒳0(M)} = {M ≤N : m0(M) ≤k ≤m1(M)} ,
k = 0, . . . , n ,
are 1 −α confidential sets. But by the definition of m0(M) and m1(M), we have
m0(M) ≤k ≤m1(M) if and only if

446
౪
8 Mathematical statistics
Figure 8.11: The increasing function f{≥4} and the decreasing f{≤4} in the case N = 60 and sample size
n = 15. The horizontal line marks the significance level α/2 = 0.05.
f{≥k}(M) > α
2
and
f{≤k}(M) > α
2 .
This proves that
C(k) := {M ≤N : f{≥k}(M) > α
2 } ∩{M ≤N : f{≤k}(M) > α
2 }
are 1 −α confidence sets. Finally, since f{≥k} and f{≤k} are monotone, we observe that
M−
k ≤M ≤M+
k if and only if f{≥k}(M) > α
2 and f{≤k}(M) > α
2 . Hence, C(k) = [M−
k , M+
k ],
which completes the proof.
Example 8.6.25. In an urn there are 200 balls. We choose randomly a sample of 60 balls.
Among them 25 are white. What can be said about the number of white balls in the urn?
Answer: We are asking for a 90 % confidence set for the unknown number M of
white balls in the urn. In this case the functions of interest are
f{≤25}(M) =
25
∑
m=0
(M
m)(200−M
60−m )
(200
60 )
and
f{≥25}(M) =
60
∑
m=25
(M
m)(200−M
60−m )
(200
60 )
.
Since
f{≥25}(65) = 0.0508,
f{≥25}(64) = 0.0408,
and
f{≤25}(103) = 0.048,
f{≤25}(102) = 0.0507,
we conclude that M−
k = 65 and M+
k = 102, hence C(25) = [65, 102] is a 90 % confidence
interval for the unknown number M of white balls. If one asks for sharper bounds,
one has to relax the significance level. So, for example, as 80 % confidence interval one
gets [68, 98].

8.7 Problems
౪
447
Note that Proposition 8.5.16 gives in this case
̂M(25) = 83 as a point estimator which
is in the middle of both confidence intervals.
If there are only 10 white balls among the chosen 60, the 90 % confidence region
is [20, 50].
Remark 8.6.26. Proposition 1.4.39 shows the tight connection between the binomial and
hypergeometric distributions. Hence, it could be of interest what happens if we replace
in the preceding example the hypergeometric distribution by the binomial. To do so,
the unknown success probability equals M/200. In other words, instead taking 60 balls
without replacement we choose now 60 balls and replace every time the chosen ball.
Applying eq. (8.58) with n = 60 and k = 25, our observation of 25 white balls leads to the
90 %-sure estimates
0.311977 < M
200 < 0.521356 .
Compare this with the hypergeometric case where we got the 90 %-sure estimates
0.325 = 65
200 < M
200 < 102
200 = 0.51 .
Thus, in this case nonreplacing of chosen balls leads to sharper bounds for the unknown
number of white balls than the bounds one gets in the case of replacing. Of course, one
has to assume that in both cases the number of chosen white balls coincides.
Summary: The statistical model is (𝒳, 𝒫(𝒳), HN,M,n)M=0,...,N with 𝒳= {0, . . . , n}. If
M−
k = min
{
{
{
0 ≤M ≤N :
n
∑
m=k
(M
m)(N−M
n−m)
(N
n)
> α
2
}
}
}
,
M+
k = max
{
{
{
0 ≤M ≤N :
k
∑
m=0
(M
m)(N−M
n−m)
(N
n)
> α
2
}
}
}
,
then for k = 0, . . . , n the sets C(k) = [M−
k , M+
k ] are 1 −α confidence intervals for the unknown parameter
M ≤N.
8.7 Problems
Problem 8.1. For some b > 0, let ℙb be the uniform distribution on [0, b]. The precise
value of b > 0 is unknown. We claim that b ≤b0 for a certain b0 > 0. Thus, the hypotheses
are
ℍ0 : b ≤b0
and
ℍ1 : b > b0 .
To test ℍ0, we chose randomly n numbers x1, . . . , xn distributed according to ℙb. Suppose
the region of acceptance 𝒳0 of a hypothesis test Tc is given by

448
౪
8 Mathematical statistics
𝒳0 := {(x1, . . . , xn) : max
1≤i≤n xi ≤c}
for some c > 0.
1.
Determine those c > 0 for which Tc is an α-significance test of level α < 1.
2.
Suppose Tc is an α-significance test. For which of those c > 0 does the probability
for a type II error become minimal?
3.
Determine the power function of the α-test Tc that minimizes the probability of the
occurrence of a type II error.
Problem 8.2. For θ > 0, let ℙθ be the probability measure with density pθ defined by
pθ(s) = {θsθ−1
if s ∈(0, 1],
0
otherwise.
1.
Check whether the pθs are probability density functions.
2.
In order to get information about θ, we execute n independent trials according to ℙθ.
Which statistical model describes this experiment?
3.
Find the maximum likelihood estimator for θ.
Problem 8.3. The lifetime of light bulbs is exponentially distributed with unknown pa-
rameter λ > 0. In order to determine λ, we switch on n light bulbs and record the number
of light bulbs that burn out until a certain time T > 0. Determine a statistical model that
describes this experiment. Find the MLE for λ.
Problem 8.4. Consider the statistical model in Example 8.5.40, that is, we have
(ℝn, ℬ(ℝn), ℙ⊗n
b )b>0 with uniform distribution ℙb on [0, b]. There are two natural es-
timators for b > 0, namely ̂b1 and ̂b2, defined by
̂b1(x) := n + 1
n
max
1≤i≤n xi
and
̂b2(x) := 2
n
n
∑
i=1
xi ,
x = (x1, . . . , xn) ∈ℝn .
Prove that ̂b1 and ̂b2 possess the following properties:
1.
The estimators ̂b1 and ̂b2 are unbiased.
2.
One has
𝕍b ̂b1 =
b2
n(n + 2)
and
𝕍b ̂b2 = b2
3n2 .
Problem 8.5. In a questionnaire, out of 2000 randomly chosen people 1420 answered
that they regularly use the Internet. Find an “approximate” 90 % confidence interval for
the proportion of people using the Internet regularly. Determine the inequalities that
describe the exact intervals in eq. (8.53).

8.7 Problems
౪
449
Problem 8.6. How do the confidence intervals C(k) in eq. (8.53) look like for k = 0 and
k = n? Is it possible that for some k = 0, . . . , n and n ≥1 it follows that 0 ∈C(k) or
1 ∈C(k)? If so, when does this happen?
Problem 8.7. Suppose the statistical model is (𝒳, 𝒫(𝒳), HN,M,n)M≤N with the sample
space 𝒳= {0, . . . , n} and with the hypergeometric distributions HN,M,n introduced in
Definition 1.4.32.
1.
For some M0 ≤M, the hypotheses are ℍ0 : M = M0 against ℍ1 : M
̸= M0. Find
(optimal) numbers 0 ≤m0 ≤m1 ≤n such that 𝒳0 = {m0, . . . , m1} is the region of
acceptance of an α-significance test T for ℍ0 against ℍ1.
Hint: Modify the methods developed in Proposition 8.2.19 and compare the construc-
tion of two-sided tests for a binomial distributed population.
2.
Use Proposition 8.6.9 to derive from 𝒳0 confidence intervals C(k), 0 ≤k ≤n, of level
1 −α for the unknown parameter M.
Hint: Follow the methods in Proposition 8.6.16 for the binomial distribution.


A Appendix
A.1 Notations
Throughout the book, we use the following standard notations:
1.
The natural numbers starting at 1 are always denoted by ℕ. In the case 0 is in-
cluded, we write ℕ0.
2.
As usual, the integers ℤare given by ℤ= {. . . , −2, −1, 0, 1, 2, . . .}.
3.
By ℝwe denote the field of real numbers endowed with the usual algebraic opera-
tions and its natural order. The subset ℚ⊂ℝis the union of all rational numbers,
that is, of numbers m/n where m, n ∈ℤand n
̸= 0.
4.
Given n ≥1, let ℝn be the n-dimensional Euclidean vector space, that is,
ℝn = {x = (x1, . . . , xn) : xj ∈ℝ} .
Addition and scalar multiplication in ℝn are carried out coordinate-wise,
x + y = (x1, . . . , xn) + (y1, . . . , yn) = (x1 + y1, . . . , xn + yn)
and if α ∈ℝ, then
α x = (αx1, . . . , αxn) .
A.2 Elements of set theory
A.2.1 Set operations
Given a set M, its powerset 𝒫(M) consists of all subsets of M. In the case that M is finite,
we have |𝒫(M)| = 2|M|, where |A| denotes the cardinality (number of elements) of a
finite set A.
If A and B are subsets of M, written as A, B ⊆M or also as A, B ∈𝒫(M), their union
and their intersection are, as usual, defined by (compare Figure A.1)
A ∪B = {x ∈M : x ∈A or x ∈B}
and
A ∩B = {x ∈M : x ∈A and x ∈B} .
Of course, it always holds that
A ∩B ⊆A ⊆A ∪B
and
A ∩B ⊆B ⊆A ∪B .
In the same way, given subsets A1, A2, . . . of M their union ⋃∞
j=1 Aj and intersection ⋂∞
j=1 Aj
is the set of those x ∈M that belong to at least one of the Aj or that belong to all Aj,
respectively.
https://doi.org/10.1515/9783111325064-009

452
౪
A Appendix
Figure A.1: The Venn diagrams of the union A ∪B and the intersection A ∩B.
Quite often we use the distributive law for intersection and union. This asserts
A ∩(
∞
⋃
j=1
Bj) =
∞
⋃
j=1
(A ∩Bj) .
Two sets A and B are said to be disjoint1 provided that A ∩B = 0. A sequence of sets
A1, A2, . . . is called disjoint2 whenever Ai ∩Aj = 0 if i
̸= j.
An element x ∈M belongs to the set difference A \ B provided that x ∈A but x ∉B.
Using the notion of the complementary set Bc := {x ∈M : x ∉B}, the set difference
may also be written as (compare Figure A.2)
A \ B = A ∩Bc .
Figure A.2: The Venn diagrams of the set difference A \ B and of the complement Ac of A with respect to a
superset M.
Another useful identity is
A \ B = A \ (A ∩B) .
Conversely, the complementary set may be represented as the set difference Bc = M \ B.
We still mention the obvious (Bc)c = B.
1 Sometimes called “mutually exclusive.”
2 More precisely, one should say “pairwise disjoint.”

A.2 Elements of set theory
౪
453
Finally, we introduce the symmetric difference AΔB of two sets A and B as (see
Figure A.3)
AΔB := (A \ B) ∪(B \ A) = (A ∩Bc) ∪(B ∩Ac) = (A ∪B) \ (A ∩B) .
(A.1)
Note that an element x ∈M belongs to AΔB if and only if x belongs exactly to one of the
sets A or B.
Figure A.3: The symmetric difference AΔB.
De Morgan’s rules are very important and assert the following:
(
∞
⋃
j=1
Aj)
c
=
∞
⋂
j=1
Ac
j
and
(
∞
⋂
j=1
Aj)
c
=
∞
⋃
j=1
Ac
j .
Given sets A1, . . . , An, their Cartesian product A1 × ⋅⋅⋅× An is defined by (see Fig-
ure A.4 for an example of the Cartesian product)
A1 × ⋅⋅⋅× An := {(a1, . . . , an) : aj ∈Aj}
with
(a1, . . . , an) = (b1, . . . , bn)
⇔
a1 = b1, . . . , an = bn .
Note that |A1 × ⋅⋅⋅× An| = |A1| ⋅⋅⋅|An|.
Figure A.4: The Cartesian product {a, b, c} × {a, b}.

454
౪
A Appendix
A.2.2 Preimages of sets
Let S be another set, for example, S = ℝ, and let f : M →S be some mapping from M to
S. Given a subset B ⊆S, we denote the preimage of B with respect to f by
f −1(B) := {x ∈M : f (x) ∈B} .
(A.2)
In other words, an element x ∈M belongs to f −1(B) if and only if its image with respect
to f is an element of B (compare Figure A.5).
Figure A.5: Only elements from f −1(B) are mapped to B. All other elements in M have to have their image
outside B. But not every element in B needs to be the image of an element in M.
We summarize some crucial properties of the preimage in a proposition.
Proposition A.2.1. Let f : M →S be a mapping from M into another set S.
(1) f −1(0) = 0 and f −1(S) = M.
(2) For any subsets Bj ⊆S, the following equalities are valid:
f −1(⋃
j≥1
Bj) = ⋃
j≥1
f −1(Bj)
and
f −1(⋂
j≥1
Bj) = ⋂
j≥1
f −1(Bj).
(A.3)
Proof. We only prove the left-hand equality in eq. (A.3). The right-hand one is proved by
the same methods. Furthermore, assertion (1) follows immediately.
Take x ∈f −1(⋃j≥1 Bj). This happens if and only if
f (x) ∈⋃
j≥1
Bj
(A.4)
is satisfied. But this is equivalent to the existence of a certain j0 ≥1 with f (x) ∈Bj0.
By definition of the preimage, the last statement may be reformulated as follows: there
exists a j0 ≥1 such that x ∈f −1(Bj0). But this implies
x ∈⋃
j≥1
f −1(Bj) .
(A.5)
Consequently, an element x ∈M satisfies condition (A.4) if and only if property (A.5)
holds. This proves the left-hand identity in formulas (A.3).

A.2 Elements of set theory
౪
455
A.2.3 Problems
Problem A.1. For any three sets A, B, and C, prove the following assertions:
A \ (B ∪C) = (A \ B) ∩(A \ C)
and
(A ∩B) ∪C = (A ∪C) ∩(B ∪C) .
Problem A.2. For any sets A, B ⊆M, prove that
(B \ A)c ∩B = A ∩B
and
(A ∪B)c ∩B = 0 .
Problem A.3. Let A and B two finite sets. Show that
|A ∪B| = |A| + |B| −|A ∩B| .
Let C be another finite set. Find a similar formula for |A ∪B ∪C| and prove it.
Problem A.4. Prove that all three expressions in eq. (A.1) define the symmetric differ-
ence of two sets. That is, show that
(A \ B) ∪(B \ A) = (A ∩Bc) ∪(B ∩Ac) = (A ∪B) \ (A ∩B)
for all sets A and B.
Problem A.5. Let A, B, and C be three sets. Show that an element x belongs to AΔBΔC if
and only if x belongs either to all three sets or to exactly one of those. In other words,
x ∉AΔBΔC if and only if x is either in none of the three sets or exactly in two of them.
Problem A.6. Let A and B be two subsets of a set M. Which of the following equations
are valid? Prove the correct identities, give counterexamples for the false ones:
(A × B)c = Ac × Bc ,
(A × B)c = (Ac × Bc) ∪(Ac × M) ∪(M × Bc),
(A × B)c = (Ac × B) ∪(A × Bc),
(A × B)c = (Ac × M) ∪(M × Bc).
Problem A.7. Define f from ℕto ℤby
f (n) = {0
if n is even,
1
if n is odd.
Describe f −1(B) for all B ⊆ℤ.
Problem A.8. Determine
f −1([0, 5])
and
f −1([0, ∞))

456
౪
A Appendix
where f : ℝ→ℝdenotes the floor function. That is,
f (x) = ⌊x⌋,
x ∈ℝ.
A.3 Combinatorics
A.3.1 Binomial coefficients
A one-to-one mapping π from {1, . . . , n} to {1, . . . , n} is called a permutation (of order
n). Any permutation reorders the numbers from 1 to n as π(1), π(2), . . . , π(n) and, vice
versa, each reordering of these numbers generates a permutation. One way to write a
permutations is
π = (
1
2
. . .
n
π(1)
π(2)
. . .
π(n) ) .
For example, if n = 3, then π = ( 1 2 3
2 3 1 ) is equivalent to the order 2, 3, 1 or to π(1) = 2,
π(2) = 3, and π(3) = 1.
Let Sn be the set of all permutations of order n. Then one may ask for |Sn| or, equiv-
alently, for the number of possible orderings of the numbers {1, . . . , n}.
To treat this problem, we need the following definition.
Definition A.3.1. For n ∈ℕ, we define n-factorial by setting
n! = 1 ⋅2 ⋅⋅⋅(n −1) ⋅n.
Furthermore, let 0! = 1.
Now we may answer the question about the cardinality of Sn.
Proposition A.3.2. We have
|Sn| = n!
(A.6)
or, equivalently, there are n! different ways to order n distinguishable objects.
Proof. The proof is done by induction over n. If n = 1 then |S1| = 1 = 1! and eq. (A.6) is
valid.
Now suppose that eq. (A.6) is true for n. In order to prove eq. (A.6) for n + 1, we split
Sn+1 as follows:
Sn+1 =
n+1
⋃
k=1
Ak,
where

A.3 Combinatorics
౪
457
Ak = {π ∈Sn+1 : π(n + 1) = k} ,
k = 1, . . . , n + 1 .
Each π ∈Ak
generates a one-to-one mapping
̃π from {1, . . . , n} onto the set
{1, . . . , k −1, k +1, . . . , n+1} by letting ̃π(j) = π(j), 1 ≤j ≤n. Vice versa, each such ̃π defines
a permutation π ∈Ak by setting π(j) =
̃π(j), j ≤n, and π(n + 1) = k. Consequently, since
eq. (A.6) holds for n, we get |Ak| = n!. Furthermore, the Aks are disjoint, and
|Sn+1| =
n+1
∑
k=1
|Ak| = (n + 1) ⋅n! = (n + 1)! ,
hence eq. (A.6) also holds for n + 1. This completes the proof.
Next we treat a tightly related problem. Say we have n different objects and we want
to distribute them into two disjoint groups, one having k elements, the other n−k. Hereby
it is of no interest in which order the elements are distributed, only the composition of
the two sets matters.
Example A.3.3. There are 52 cards in a deck that are distributed to two players, so that
each of them gets 26 cards. For this game, it is only important which cards each player
has, not in which order the cards were received. Here n = 52 and k = n −k = 26.
The main question is: how many ways can n elements be distributed, say the num-
bers from 1 to n, into one group of k elements and into another of n −k elements? In
the above example, that is how many ways can 52 cards be distributed into two groups
of 26.
To answer this question, we use the following auxiliary model. Let us take any per-
mutation π ∈Sn. We place the numbers π(1), . . . , π(k) into group 1 and the remaining
π(k + 1), . . . , π(n) into group 2. In this way, we obtain all possible distributions but many
of them appear several times. Say that two permutations π1 and π2 are equivalent if (as
sets)
{π1(1), . . . , π1(k)} = {π2(1), . . . , π2(k)} .
Of course, this also implies
{π1(k + 1), . . . , π1(n)} = {π2(k + 1), . . . , π2(n)} ,
and two permutations generate the same partition if and only if they are equivalent.
Equivalent permutations are achieved by taking one fixed permutation π, then permut-
ing {π(1), . . . , π(k)} and also {π(k +1), . . . , π(n)}. Consequently, there are exactly k!(n−k)!
permutations that are equivalent to a given one. Summing up, we get that there are
n!
k!(n−k)! different classes of equivalent permutations. Let
(n
k) =
n!
k! (n −k)! .

458
౪
A Appendix
There are (n
k) different ways to distribute n objects into one group of k and into another one of n−k elements.
For any n ≥0, we set (n
0) = 1 and (n
k) = 0 in case of k > n or k < 0.
Definition A.3.4. The numbers
(n
k) =
n!
k! (n −k)! ,
n = 0, 1, . . . and k = 0, . . . , n ,
are called binomial coefficients, read “n choose k.”
Example A.3.5. A digital word of length n consists of n zeroes or ones. Since at every
position we may have either “0” or “1”, there are 2n different words of length n. How
many of these words possess exactly k ones or, equivalently, n −k zeroes? To answer
this, put all positions where there is a “1” into a first group and those where there is a
“0” into a second one. In this way, the numbers from 1 to n are divided into two different
groups of size k and n −k, respectively. But we already know how many such partitions
exist, namely (n
k). As a consequence, we get
There are (n
k) words of length n possessing exactly k ones and n −k zeroes.
The next proposition summarizes some crucial properties of binomial coeffi-
cients.
Proposition A.3.6. Let n be a natural number, k = 0, . . . , n, and let r ≥1 be an integer.
Then the following equations hold:
(n
k) = ( n
n −k),
(A.7)
(n
k) = (n −1
k ) + (n −1
k −1),
and
(A.8)
(n + r
n ) =
n
∑
j=0
(n + r −j −1
n −j
) =
n
∑
j=0
(r + j −1
j
) .
(A.9)
Proof. Equations (A.7) and (A.8) follow immediately by the definition of the binomial
coefficients. Note that eq. (A.8) also holds if k = n because we agreed that (n−1
n ) = 0.
If k < n, then an iteration of eq. (A.8) leads to
(n
k) =
k
∑
j=0
(n −j −1
k −j ) .
Replacing in the last equation n by n + r, as well as k by n (note that n + r > n), we obtain
the left-hand identity (A.9). The right-hand equation follows by inverting the summation,

A.3 Combinatorics
౪
459
that is, one replaces j by n −j. Observe that (A.9) becomes wrong in the case r = 0. Then
the left-hand side is 1 while the right-hand one equals 0.
Remark A.3.7. Equation (A.8) allows a graphical interpretation by Pascal’s triangle.
The coefficient (n
k) in the nth row follows by summing the two values (n−1
k−1) and (n−1
k )
above (n
k) in the (n −1)th row. Look at Figure A.6 for a visualization of the triangle.
Figure A.6: Pascal’s triangle.
Next we state and prove an important binomial theorem.
Proposition A.3.8 (Binomial theorem). For real numbers a, b, and any n ∈ℕ0,
(a + b)n =
n
∑
k=0
(n
k) ak bn−k .
(A.10)
Proof. The binomial theorem is proved by induction over n. If n = 0, then eq. (A.10)
holds trivially.
Suppose now that eq. (A.10) has been proven for n −1. Our aim is to verify that it is
also true for n. Using that the expansion holds for n −1, we get
(a + b)n = (a + b) (a + b)n−1 = (a + b)
n−1
∑
k=0
(n −1
k )akbn−1−k
=
n−1
∑
k=0
(n −1
k )ak+1bn−1−k +
n−1
∑
k=0
(n −1
k )akbn−k
= an +
n−2
∑
k=0
(n −1
k )ak+1bn−1−k + bn +
n−1
∑
k=1
(n −1
k )akbn−k
= an + bn +
n−1
∑
k=1
[(n −1
k −1) + (n −1
k )]akbn−k =
n
∑
k=0
(n
k) ak bn−k ,
where we used eq. (A.8) in the last step.

460
౪
A Appendix
The following property of binomial coefficients plays an important role when in-
troducing the hypergeometric distribution (see Proposition 1.4.31). It is also used during
the investigation of sums of independent binomial distributed random variables (see
Proposition 4.6.1).
Proposition A.3.9 (Vandermonde’s identity). If k, m, and n are all in ℕ0, then
k
∑
j=0
(n
j )( m
k −j) = (n + m
k
) .
(A.11)
Proof. An application of the binomial theorem leads to
(1 + x)n+m =
n+m
∑
k=0
(n + m
k
) xk ,
x ∈ℝ.
(A.12)
On the other hand, another use of Proposition A.3.8 implies3
(1 + x)n+m = (1 + x)n(1 + x)m
= [
n
∑
j=0
(n
j )xj][
m
∑
i=0
(m
i )xi] =
n
∑
j=0
m
∑
i=0
(n
j )(m
i )xi+j
=
n+m
∑
k=0
[ ∑
i+j=k
(n
j )(m
i )]xk =
n+m
∑
k=0
[
k
∑
j=0
(n
j )( m
k −j)]xk .
(A.13)
The coefficients in an expansion of a polynomial are unique. Hence, in view of eqs. (A.12)
and (A.13), we get for all k ≤m + n the identity
(n + m
k
) =
k
∑
j=0
(n
j )( m
k −j) .
Hereby note that both sides of eq. (A.11) become zero whenever k > n+m. This completes
the proof.
Remark A.3.10. Another, more heuristic, way to prove Vandermonde’s identity is as fol-
lows. Suppose one has n + m fruits, n apples and m oranges. There are (n+m
k ) ways to
choose k fruits out of the n + m ones. These possibilities split into the following k + 1
disjoint events: among the chosen k fruits there are zero apples and k oranges, or one
apple and k −1 oranges up to k apples and zero oranges. If the number of apples in the
sample is j, then there are (n
j) ways to choose the apples and ( m
k−j) ways to choose the
3 When passing from line 2 to line 3, the order of summation is changed. One no longer sums over the
rectangle [0, m] × [0, n]. Instead, one sums along the diagonals, where i + j = k.

A.3 Combinatorics
౪
461
oranges, respectively. Summing over all possibilities j = 0, . . . , k proves Vandermonde’s
identity.
Our next objective is to generalize the binomial coefficients. In view of
(n
k) = n (n −1) ⋅⋅⋅(n −k + 1)
k!
for k ≥1 and n ∈ℕ, the generalized binomial coefficient is introduced as
(−n
k ) := −n (−n −1) ⋅⋅⋅(−n −k + 1)
k!
.
(A.14)
The next lemma shows the tight relation between generalized and “ordinary” binomial
coefficients.
Lemma A.3.11. For k ≥1 and n ∈ℕ,
(−n
k ) = (−1)k (n + k −1
k
) .
Proof. By definition of the generalized binomial coefficient, we obtain
(−n
k ) = (−n) (−n −1) ⋅⋅⋅(−n −k + 1)
k!
= (−1)k (n + k −1) (n + k −2) ⋅⋅⋅(n + 1) n
k!
= (−1)k(n + k −1
k
) .
This completes the proof.
For example, Lemma A.3.11 implies (−1
k ) = (−1)k and (−n
1 ) = −n.
A.3.2 Drawing balls out of an urn
Assume that there are n balls labeled from 1 to n in an urn. We draw k balls out of the urn,
thus observing a sequence of length k with entries from {1, . . . , n}. How many different
results (sequences) may be observed? To answer this question, we have to decide on the
arrangement of drawing. Do we or do we not replace the chosen ball? Is it important in
which order the balls were chosen or is it only of importance which balls were chosen at
all? Thus, we see that there are four different ways to answer this question (replacement
or nonreplacement, recording the order or nonrecording).
Example A.3.12. Let us regard the drawing of two balls out of four, that is, n = 4 and
k = 2. Depending on the different arrangements, the following results may be observed.
Note, for example, that in the two latter cases (nonrecording of the order) the pair (3, 2)
does not appear because it is identical to (2, 3).

462
౪
A Appendix
Replacement and the
order is important
(1, 1)
(1, 2)
(1, 3)
(1, 4)
(2, 1)
(2, 2)
(2, 3)
(2, 4)
(3, 1)
(3, 2)
(3, 3)
(3, 4)
(4, 1)
(4, 2)
(4, 3)
(4, 4)
16 different results
Nonreplacement and
the order is important
⋅
(1, 2)
(1, 3)
(1, 4)
(2, 1)
⋅
(2, 3)
(2, 4)
(3, 1)
(3, 2)
⋅
(3, 4)
(4, 1)
(4, 2)
(4, 3)
⋅
12 different results
Replacement and the
order is not important
(1, 1)
(1, 2)
(1, 3)
(1, 4)
⋅
(2, 2)
(2, 3)
(2, 4)
⋅
⋅
(3, 3)
(3, 4)
⋅
⋅
⋅
(4, 4)
10 different results
Nonreplacement and the
order is not important
⋅
(1, 2)
(1, 3)
(1, 4)
⋅
⋅
(2, 3)
(2, 4)
⋅
⋅
⋅
(3, 4)
⋅
⋅
⋅
⋅
6 different results
Let us come back now to the general situation of n different balls from which we
choose k at random:
Case 1. Drawing with replacement and taking the order into account. We have n different
possibilities for the choice of the first ball and, since the chosen ball is placed back, there
are also n possibilities for the second one, and so on. Thus, there are n possibilities for
each of the k balls, leading to the following result.
The number of different results in this case is nk.
Example A.3.13. Letters in Braille, a scripture for blind people, are generated by dots or
nondots at six different positions. How many letters may be generated in that way?
Answer: It holds that n = 2 (dot or no dot) at k = 6 different positions. Hence, the
number of possible representable letters is 26 = 64. In fact, there are only 63 possibilities
because we have to rule out the case of no dots at all 6 positions.
Case 2. Drawing without replacement and taking the order into account. This case only
makes sense if k ≤n. There are n possibilities to choose the first ball. After that there are
still n −1 balls in the urn. Hence there are only n −1 possibilities for the second choice,
n −2 for the third, and so on. Summing up, we get the following.
The number of possible results in this case equals n(n −1) ⋅⋅⋅(n −k + 1) =
n!
(n −k)!.

A.3 Combinatorics
౪
463
Example A.3.14. In a lottery, 6 numbers are chosen out of 49. Of course, the chosen
numbers are not replaced. If we record the numbers as they appear (not putting them
in order), how many different sequences of six numbers exist?
Answer: Here we have n = 49 and k = 6. Hence the wanted number equals
49!
43! = 49 ⋅⋅⋅44 = 10, 068, 347, 520.
Case 3. Drawing with replacement not taking the order into account. This case is more
complicated and requires a different point of view. We count how often each of the n
balls was chosen during the k trials. Let k1 ≥0 be the frequency of the first ball, k2 ≥0
that of the second one, and so on. In this way we obtain n nonnegative integers k1, . . . , kn
satisfying
k1 + ⋅⋅⋅+ kn = k .
Indeed, since we choose k balls, the frequencies have to sum to k. Consequently, the
number of possible results when drawing k of n balls with replacement and not taking
the order into account coincides with
󵄨󵄨󵄨󵄨{(k1, . . . , kn), kj ∈ℕ0, k1 + ⋅⋅⋅+ kn = k}󵄨󵄨󵄨󵄨.
(A.15)
In order to determine the cardinality (A.15), we use the following auxiliary model:
Let B1, . . . , Bn be n boxes. Given n nonnegative integers k1, . . . , kn, summing to k, we
place exactly k1 dots into B1, k2 dots into B2, and so on. At the end we distributed k indis-
tinguishable dots into n different boxes. Thus, we see that the value of (A.15) coincides
with the number of different possibilities to distribute k indistinguishable dots into n
boxes. Now assume that the boxes are glued together; on the very left we put box B1,
on its right we put box B2, and continue in this way up to box Bn on the very right. In
this way, we obtain n + 1 dividing walls, two outer and n −1 inner ones. Now we get all
possible distributions of k dots into n boxes by shuffling the k dots and the n −1 inner
dividing walls. For example, if we get the order d, d, d, w, w, d, w, . . . then this means that
there are three dots in B1, none in B2, and one in B3, and so on (compare Figure A.7 for
a slightly more general example).
Figure A.7: The case k1 = 3, k2 = 0, k3 = 1, . . . , kn−1 = 2, kn = 0: k dots and n −1 inner walls.
Summing up, we have N = n + k −1 objects, k of them are dots and n −1 are walls.
As we know, there are (N
k) different ways to order these N objects. Hence we arrived at
the following result.

464
౪
A Appendix
The number of possibilities to distribute k anonymous dots into n boxes equals
(n + k −1
k
) = (n + k −1
n −1 ) .
It coincides with |{(k1, . . . , kn) , kj ∈ℕ0 , k1 + ⋅⋅⋅+ kn = k}|, as well as with the number of different results
when choosing k balls out of n with replacement and not taking order into account.
Example A.3.15. Dominoes are marked on each half either with no dots, one dot, or up
to six dots. Hereby the dominoes are symmetric, that is, a tile with three dots on the left-
hand side and two ones on the right-hand side is identical with that having two dots on
the left-hand side and three dots on the right-hand side. How many different dominoes
exist?
Answer: It holds4 n = 7 and k = 2, hence the number of different dominoes
equals
(7 + 2 −1
2
) = (8
2) = 28 .
Case 4. Drawing without replacement not taking the order into account. Here we also
have to assume k ≤n. We already investigated this case when we introduced the bino-
mial coefficients. The k chosen numbers are put in group 1, the remaining n −k balls
in group 2. As we know, there are (n
k) ways to split the n numbers into such two groups.
Hence we obtained the following.
The number of different results in this case is (n
k).
Example A.3.16. If the order of the six numbers is not taken into account in Exam-
ple A.3.14, that is, we ignore which number was chosen first, which second, and so on,
the number of possible results equals
(49
6 ) = 49 ⋅⋅⋅43
6!
= 13, 983, 816.
Let us summarize the four different cases in a table. Here O and NO stand for record-
ing or nonrecording of the order while R and NR represent replacement or nonreplace-
ment, and one chooses k balls out of n possible.
4 There are 7 boxes B0 up to B6 and two particles distributed into these 7 boxes. The number of the box
containing a particle corresponds to the number of dots on the tile. For example, if one particle is in box
B2 and the other in B4, then the corresponding tile is that with 2 and 4 dots on it. Or both particles in B6
means that our tile has 6 dots at each side. Another possibility to describe these tiles is to represent 2 as
2 = 0 + 0 + 1 + 0 + 1 + 0 + 0 or 2 = 0 + 0 + 0 + 0 + 0 + 0 + 2, respectively.

A.3 Combinatorics
౪
465
R
NR
O
nk
n!
(n−k)!
NO
(n+k−1
k
)
(n
k)
A.3.3 Multinomial coefficients
The binomial coefficient (n
k) describes the number of possibilities to distribute n objects
into two groups of k and n −k elements. What happens if we have not only two groups
but m ≥2? Say the first group has k1 elements, the second has k2 elements, and so on,
up to the mth group that has km elements. Of course, if we distribute n elements the kjs
have to satisfy
k1 + ⋅⋅⋅+ km = n .
Using exactly the same arguments as in the case where m = 2, we get the following.
There exist exactly
n!
k1!⋅⋅⋅km! different ways to distribute n elements into m groups of sizes k1, k2, . . . , km where
k1 + ⋅⋅⋅+ km = n.
In accordance with the binomial coefficient, we write
(
n
k1, . . . , km
) :=
n!
k1! ⋅⋅⋅km! ,
k1 + ⋅⋅⋅+ km = n ,
(A.16)
and call (
n
k1,...,km) a multinomial coefficient, read “n chose k1 up to km.”
Remark A.3.17. If m = 2, then k1 + k2 = n, and
( n
k1, k2
) = (
n
k1, n −k1
) = ( n
k1
) = ( n
k2
) .
Example A.3.18. A deck of cards for playing skat consists of 32 cards. Three players each
gets 10 cards; the remaining two cards (called “skat”) are placed on the table. How many
different distributions of the cards exist?
Answer: Let us first define what it means for two distribution of cards to be iden-
tical. Say this happens if each of the three players has exactly the same cards as in the
previous game. Therefore, the remaining two cards on the table are also identical. Hence
we distribute 32 cards into 4 groups possessing 10, 10, 10, and 2 elements. Consequently,
the number of different distributions equals5
5 The huge size of this number explains why playing skat never becomes boring.

466
౪
A Appendix
(
32
10, 10, 10, 2) =
32!
(10!)3 2! = 2.753294409 × 1015 .
Remark A.3.19. One may also look at multinomial coefficients from a different point of
view. Suppose we are given n balls of m different colors. Say there are k1 balls of the first
color, k2 balls of the second color, up to km balls of color m where, of course, we have
k1 + ⋅⋅⋅+ km = n. Then there exist
(
n
k1, . . . , km
)
different ways to order these n balls. This is followed by the same arguments as we used
in Example A.3.5 for m = 2.
For instance, given 3 blue, 4 red, and 2 white balls, there are
(
9
3, 4, 2) =
9!
3! 4! 2! = 1260
different ways to order them.
Finally, let us still mention that in the literature one sometimes finds another
(equivalent) way of introducing the multinomial coefficients. Given nonnegative inte-
gers k1, . . . , km with k1 + ⋅⋅⋅+ km = n, it follows that
(
n
k1, . . . , km
) = ( n
k1
) (n −k1
k2
) (n −k1 −k2
k3
) ⋅⋅⋅(n −k1 −⋅⋅⋅−km−1
km
).
(A.17)
A direct proof of this fact is easy and left as an exercise.
There is a combinatorial interpretation of the expression on the right-hand side of
eq. (A.17). To reorder n balls of m different colors, one chooses first the k1 positions for
balls of color 1. There are ( n
k1) ways to do this. Thus, there remain n−k1 possible positions
for balls of color 2, and there are (n−k1
k2 ) possible choices for this, and so on. Note that at
the end there remain km positions for balls of color m; hence, the last term on the right-
hand side of eq. (A.17) equals 1.
Let us come now to the announced generalization of Proposition A.3.8.
Proposition A.3.20 (Multinomial theorem). Let n ≥0. Then for any m ≥1 and real num-
bers x1, . . . , xm,
(x1 + ⋅⋅⋅+ xm)n =
∑
k1+⋅⋅⋅+km=n
ki≥0
(
n
k1, . . . , km
) xk1
1 ⋅⋅⋅xkm
m .
(A.18)
Proof. Equality (A.18) is proved by induction. In contrast to the proof of the binomial
theorem, now induction is done over m, the number of summands.
If m = 1, the assertion is valid due to trivial reasons.

A.3 Combinatorics
౪
467
Suppose now eq. (A.18) holds for m, all n ≥1, and all real numbers x1, . . . , xm. We
have to show the validity of eq. (A.18) for m + 1 and all n ≥1. Given real numbers
x1, . . . , xm+1 and n ≥1 set y := x1 + ⋅⋅⋅+ xm. Using Proposition A.3.8, by the validity of
eq. (A.18) for m and all n −j, 0 ≤j ≤n, we obtain
(x1 + ⋅⋅⋅+ xm+1)n = (y + xm+1)n =
n
∑
j=1
n!
j! (n −j)! xj
m+1yn−j
=
n
∑
j=1
n!
j! (n −j)!
∑
k1+⋅⋅⋅+km=n−j
ki≥0
(n −j)!
k1! ⋅⋅⋅km! xk1
1 ⋅⋅⋅xkm
m xj
m+1 .
Replacing j by km+1 and combining both sums leads to
(x1 + ⋅⋅⋅+ xm+1)n =
∑
k1+⋅⋅⋅+km+1=n
ki≥0
n!
k1! ⋅⋅⋅km+1! xk1
1 ⋅⋅⋅xkm+1
m+1 ,
hence eq. (A.18) is also valid for m + 1. This completes the proof.
Remark A.3.21. The number of summands in eq. (A.18) equals6 (n+m−1
n
).
Example A.3.22. Let w, x, y, and z be four real numbers. Then we get
(w + x + y + z)5 =
∑
k1+⋅⋅⋅+k4=5
(
5
k1, k2, k3, k4
)wk1xk2yk3zk4 .
So, for example, the coefficient of w2xyz is (
5
2,1,1,1) = 60 or that of w2x2y equals
(
5
2,2,1,0) = 30.
A.3.4 Problems
Problem A.9. Given a set M of cardinality n ≥1. Argue why there are exactly (n
k) subsets
A ⊆M with cardinality k ≤n.
Problem A.10. Determine, with proof, the number of ordered triples (A1, A2, A3) of sets
such that
A1 ∪A2 ∪A3 = {1, 2, 3, 4, 5, 6, 7, 8, 9, 10}
and
A1 ∩A2 ∩A3 = 0.
Problem A.11. Prove that
n
∑
k=0
(n
k)
2
= (2n
n ) .
(A.19)
6 Compare with Case 3 in Section A.3.2.

468
౪
A Appendix
Problem A.12. Let n be a natural number. Prove that
22n
2n + 1 < (2n
n ) < 22n
and
22n+1
2n + 2 < (2n + 1
n
) = (2n + 1
n + 1 ) < 22n+1.
Problem A.13. Let n be a natural number. Give proofs of the identities
(n
0) + (n
1) + ⋅⋅⋅+ (n
n) = 2n
and
(n
0) −(n
1) + ⋅⋅⋅+ (−1)n(n
n) = 0.
Problem A.14. Given r ∈ℕand an integer n ≥r, show that
(r
r) + (r + 1
r ) + ⋅⋅⋅+ (n
r) = (n + 1
r + 1) .
For example, if n ≥4, then
(4
4) + (5
4) + ⋅⋅⋅+ (n
4) = (n + 1
5 ) .
Problem A.15. What is the coefficient of x2 in (3x2−2x−1)7 where x
̸= 0 is some variable?
Problem A.16. Given integers n ≥1 and k ≥n, how many vectors (k1, . . . , kn) of integers
exist for which kj ≥1 and k1 + ⋅⋅⋅+ kn = k. How about if we ask for kjs with kj ≥M,
1 ≤j ≤n, for some integer M ≥1? Of course, this question makes only sense if k ≥n M.
Problem A.17. Give an algebraic proof of equation (A.17).
A.4 Vectors and matrices
The aim of this section is to summarize results and notations about vectors and matrices
used throughout this book. For more detailed reading, we refer to any book about Linear
Algebra, for example, [Axl15].
Given two vectors x and y in ℝn, their7 scalar product is defined as
⟨x, y⟩:=
n
∑
j=1
xjyj,
x = (x1, . . . , xn), y = (y1, . . . , yn).
If x ∈ℝn, then
7 Sometimes also called “dot-product.”

A.4 Vectors and matrices
౪
469
|x| := ⟨x, x⟩1/2 = (
n
∑
j=1
x2
j )
1/2
denotes the Euclidean distance from x to 0. Thus, |x| may also be regarded as the length
of the vector x ∈ℝn. In particular, we have |x| > 0 for all nonzero x ∈ℝn.
Any matrix A = (αij)n
i,j=1 of real numbers αij generates a linear8 mapping (also de-
noted by A) via
Ax = (
n
∑
j=1
α1jxj, . . . ,
n
∑
j=1
αnjxj),
x = (x1, . . . , xn) ∈ℝn .
(A.20)
Conversely, any linear mapping A : ℝn →ℝn defines a matrix (αij)n
i,j=1 by representing
Aej ∈ℝn as
Aej = (α1j, . . . , αnj) ,
j = 1, . . . , n .
Here ej = (0, . . . , 0, 1
⏟⏟⏟⏟⏟⏟⏟
j
, 0 . . . , 0) denotes the jth unit vector in ℝn. With this generated
matrix (αij)n
i,j=1, the linear mapping A acts as stated in eq. (A.20). Consequently, we may
always identify linear mappings in ℝn with n × n-matrices (αij)n
i,j=1.
Given two n × n matrices A = (αij)n
i,j=1 and B = (βij)n
i,j=1, their product A ∘B, or A B in
short, is the matrix C = (γij)n
i,j=1 where
γij =
n
∑
k=1
αikβkj ,
1 ≤i, j ≤n .
Note that in general A B
̸= B A. An important formula for the determinant of the product
of two matrices is
det(A B) = det(A) ⋅det(B) .
(A.21)
An n × n matrix A is said to be regular9 if the generated linear mapping is one-to-
one, that is, if Ax = 0 implies x = 0. This is equivalent to the fact that the determinant
det(A) is nonzero.
Let A = (αij)n
i,j=1 be an n × n matrix. Then its transposed matrix is defined as
AT := (αji)n
i,j=1. With this notation, it follows for x, y ∈ℝn that
⟨Ax, y⟩= ⟨x, ATy⟩.
Moreover, we have (A B)T = BTAT for any two n × n matrices A and B, and, of course,
8 A mapping A : ℝn →ℝn is said to be linear if A(αx + βy) = αAx + βAy for all α, β ∈ℝand x, y ∈ℝn.
9 Sometimes also called nonsingular or invertible.

470
౪
A Appendix
(AT)T = A. The following property of the transposed matrix is crucial:
det(AT) = det(A) .
In particular, the matrix A is regular if and only if AT is regular.
A matrix A with A = AT is said to be symmetric. Equivalently, A satisfies
⟨Ax, y⟩= ⟨x, Ay⟩,
x, y ∈ℝn.
An n × n matrix R = (rij)n
i,j=1 is positive definite (or positive in short) provided it is
symmetric and
⟨Rx, x⟩=
n
∑
i,j=1
rijxixj > 0,
x = (x1, . . . , xn)
̸= 0.
We will write R > 0 in this case. In particular, each positive matrix R is regular and its
determinant satisfies det(R) > 0.
Let A = (αij)n
i,j=1 be an arbitrary regular n × n matrix. Set
R := AAT ,
(A.22)
that is, the entries rij of R are computed by
rij =
n
∑
k=1
αikαjk ,
1 ≤i, j ≤n .
Proposition A.4.1. Suppose the matrix R is defined by eq. (A.22) for some regular A. Then
it follows that R > 0.
Proof. Because of
RT = (AAT)
T = (AT)
TAT = AAT = R ,
the matrix R is symmetric. Furthermore, for x ∈ℝn with x
̸= 0, we obtain
⟨Rx, x⟩= ⟨AATx, x⟩= ⟨ATx, ATx⟩= 󵄨󵄨󵄨󵄨ATx󵄨󵄨󵄨󵄨
2 > 0.
Hereby we used that for a regular A, the transposed matrix AT is regular, too. Conse-
quently, if x ̸= 0, then ATx ̸= 0, and thus |ATx| > 0. This completes the proof.
The identity matrix In is defined as the n × n matrix with entries δij, 1 ≤i, j ≤n,
where
δij = {1
if i = j,
0
if i
̸= j.
(A.23)

A.4 Vectors and matrices
౪
471
Of course, Inx = x for x ∈ℝn and, moreover, det(In) = 1.
Given a regular n × n matrix A, there is a unique matrix B such that AB = In. The
matrix B is called the inverse matrix of A and denoted by A−1. Recall that also A−1A = In
and, moreover, (AT)−1 = (A−1)T. Equation (A.21) lets us conclude that for any regular
matrix A, it follows that
1 = det(In) = det(AA−1) = det(A) ⋅det(A−1)
⇒
det(A−1) =
1
det(A) .
An n × n matrix U is said to be unitary or orthogonal provided that
UUT = UTU = In
(A.24)
with identity matrix In. Another way to express this is either that UT = U−1 or, equiva-
lently, that U satisfies
⟨Ux, Uy⟩= ⟨x, y⟩,
x, y ∈ℝn .
In particular, for each x ∈ℝn it follows that
|Ux|2 = ⟨Ux, Ux⟩= ⟨x, x⟩= |x|2 ,
that is, U preserves the length of vectors in ℝn. Indeed, this property characterizes uni-
tary matrices. It is a nice task to prove this.
It is easy to see that an n × n matrix U is unitary if and only if its column vectors
u1, . . . , un form an orthonormal basis in ℝn. That is, ⟨ui, uj⟩= δij with δijs as in (A.23). This
characterization of unitary matrices remains valid when we take the column vectors
instead of those generated by the rows.
We saw in Proposition A.4.1 that each matrix R of the form (A.22) is positive. Next
we prove that conversely, each R > 0 may be represented in this way.
Proposition A.4.2. Let R be an arbitrary positive n×n matrix. Then there exists a regular
matrix A such that R = AAT.
Proof. Since R is symmetric, we may apply the principal axis transformation for sym-
metric matrices. It asserts that there exists a diagonal matrix10 D and a unitary matrix
U such that
R = UDUT .
Let δ1, . . . , δn be the entries of D at its diagonal. From R > 0 we derive δj > 0, 1 ≤j ≤n.
To see this fix j ≤n and set x := Uej where as above ej denotes the jth unit vector in ℝn.
Then UTx = ej, hence
10 The entries dij of D satisfy dij = 0 if i
̸= j.

472
౪
A Appendix
0 < ⟨Rx, x⟩= ⟨UDUTx, x⟩= ⟨DUTx, UTx⟩= ⟨Dej, ej⟩= δj .
Because of δj > 0, we may define D1/2 as diagonal matrix with entries δ1/2
j
on its diagonal.
Setting A := UD1/2 and because (D1/2)T = D1/2, it follows that
R = (UD1/2)(UD1/2)
T = AAT .
Since
det(A)2 = det(A)det(A) = det(A)det(AT) = det(A AT) = det(R) > 0 ,
the matrix A is regular, and this completes the proof.
Another way to argue without using properties of determinants is as follows. As-
sume the matrix A is not regular. Then this is also true for AT. Hence there is a nonzero
vector x ∈ℝn such that ATx = 0. But this implies Rx = A(ATx) = A(0) = 0 which
contradicts the regularity of R. Thus, A has to be regular.
Remark A.4.3. Note that representation (A.22) is not unique. Indeed, if R = A AT, then
we also have R = (AV)(AV)T for any unitary matrix V.
A.5 Some analytic tools
The aim of this section is to present some special results of Calculus that play an impor-
tant role in the book. Hereby we restrict ourselves to those topics that are maybe less
known and that are not necessarily taught in a basic Calculus course. For a general intro-
duction to Calculus, including those topics as convergence of power series, fundamental
theorem of Calculus, mean-value theorem, and so on, we refer to the books [Spi08] and
[Ste15].
We start with a result that is used in the proof of Poisson’s limit theorem (Theo-
rem 1.4.22). From Calculus, it is well known that for x ∈ℝ,
lim
n→∞(1 + x
n)
n
= ex .
(A.25)
The probably easiest proof of this fact is via the approach presented in [Spi08]. There
the logarithm function is defined by ln t = ∫
t
1
1
sds, t > 0. Hence, l’Hôpital’s rule implies
lim
t→∞t ln(1 + x
t ) = x ,
x ∈ℝ.
From this, eq. (A.25) easily follows by the continuity of the exponential function.
The next proposition may be viewed as a slight generalization of eq. (A.25).

A.5 Some analytic tools
౪
473
Proposition A.5.1. Let (xn)n≥1 be a sequence of real numbers with limn→∞xn = x for
some x ∈ℝ. Then we get
lim
n→∞(1 + xn
n )
n
= ex .
Proof. Because of eq. (A.25), it suffices to verify that
lim
n→∞
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
(1 + xn
n )
n
−(1 + x
n)
n󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
= 0 .
(A.26)
Since the sequence (xn)n≥1 is convergent, it is bounded. Consequently, there is a c > 0
such that for all n ≥1, we have |xn| ≤c. Of course, we may also assume |x| ≤c. Fix for a
moment n ≥1 and set
a := 1 + xn
n
and
b := 1 + x
n .
The choice of c > 0 yields |a| ≤1 + c/n, as well as |b| ≤1 + c/n. Hence it follows
󵄨󵄨󵄨󵄨an −bn󵄨󵄨󵄨󵄨= |a −b| 󵄨󵄨󵄨󵄨an−1 + an−2b + ⋅⋅⋅+ abn−2 + bn−1󵄨󵄨󵄨󵄨
≤|a −b| (|a|n−1 + |a|n−2|b| + ⋅⋅⋅+ |a||b|n−2 + |b|n−1)
≤|a −b| n (1 + c
n)
n−1
≤C n |a −b| .
Here C > 0 is some constant that exists since (1+c/n)n−1 converges to ec. By the definition
of a and b,
󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
(1 + xn
n )
n
−(1 + x
n)
n󵄨󵄨󵄨󵄨󵄨󵄨󵄨󵄨
≤C n |xn −x|
n
= C |x −xn| .
Since xn →x, this immediately implies eq. (A.26) and proves the proposition.
Our next objective is to present some properties of power series and functions gen-
erated by them. Hereby we restrict ourselves to such assertions that we will use in this
book. For further reading, we refer to Part IV in [Spi08].
Let (ak)k≥0 be a sequence of real numbers. Then its radius of convergence r ∈[0, ∞]
is defined by
r :=
1
lim supk→∞|ak|1/k .
Hereby we let 1/0 := ∞and 1/∞:= 0. If 0 < r ≤∞and |x| < r, then the infinite series
f (x) :=
∞
∑
k=0
ak xk
(A.27)

474
౪
A Appendix
converges (even absolutely). Hence the function f generated by eq. (A.27) is well defined
on its region of convergence {x ∈ℝ: |x| < r}. We say that f is represented as a power
series on {x ∈ℝ: |x| < r}.
The function f defined by eq. (A.27) is infinitely often differentiable on its region of
convergence and (compare with [Spi08, Chapter 27, Theorem 6])
f (n)(x) =
∞
∑
k=n
k (k −1) ⋅⋅⋅(k −n + 1) ak xk−n
=
∞
∑
k=0
(k + n) (k + n −1) ⋅⋅⋅(k + 1) ak+n xk
= n!
∞
∑
k=0
(n + k
k
) ak+n xk .
(A.28)
The coefficients n!(n+k
k ) an+k in the series representation of the nth derivative f (n)
possess the same radius of convergence as the original sequence (ak)k≥0. This is easy to
see for n = 1. The general case then follows by induction.
Furthermore, eq. (A.28) implies an = f (n)(0)/n!, which, in particular, tells us that
given f , the coefficients (ak)k≥0 in representation (A.27) are unique.
Proposition A.5.2. If n ≥1 and |x| < 1 then
1
(1 + x)n =
∞
∑
k=0
(−n
k ) xk .
(A.29)
Proof. Using the formula to add a geometric series and applying (−1
k ) = (−1)k yields for
|x| < 1 that
1
1 + x =
∞
∑
k=0
(−1)k xk =
∞
∑
k=0
(−1
k )xk .
Consequently Proposition A.5.2 holds for n = 1.
Assume now we have proven the proposition for n −1, that is, if |x| < 1, then
1
(1 + x)n−1 =
∞
∑
k=0
(−n + 1
k
)xk .
Differentiating this equality in the region {x : |x| < 1} implies
−
n −1
(1 + x)n =
∞
∑
k=1
(−n + 1
k
) k xk−1 =
∞
∑
k=0
(−n + 1
k + 1 ) (k + 1) xk .
(A.30)

A.5 Some analytic tools
౪
475
Direct calculations give
−k + 1
n −1 (−n + 1
k + 1 ) = −k + 1
n −1 ⋅(−n + 1)(−n) ⋅⋅⋅(−n + 1 −(k + 1) + 1)
(k + 1)!
= (−n)(−n −1) ⋅⋅⋅(−n −k + 1)
k!
= (−n
k ) ,
which, together with eq. (A.30), leads to
1
(1 + x)n =
∞
∑
k=0
(−n
k ) xk .
This completes the proof of Proposition A.5.2.
The next proposition may be viewed as a counterpart to eq. (A.11) in the case of
generalized binomial coefficients.
Proposition A.5.3. For k ≥0 and m, n ∈ℕ,
k
∑
j=0
(−n
j )( −m
k −j) = (−n −m
k
) .
Proof. The proof is similar to that of Proposition A.3.9. Using Proposition A.5.2, we rep-
resent the function (1+x)−n−m as a power series in two different ways. On the one hand,
for |x| < 1, we have the representation
1
(1 + x)n+m =
∞
∑
k=0
(−n −m
k
) xk
(A.31)
and, on the other hand,
1
(1 + x)n+m = [
∞
∑
j=0
(−n
j ) xj][
∞
∑
l=0
(−m
l ) xl]
=
∞
∑
k=0
[ ∑
j+l=k
(−n
j )(−m
l )] xk =
∞
∑
k=0
[
k
∑
j=0
(−n
j )( −m
k −j)] xk .
(A.32)
As observed above, the coefficients in a power series are uniquely determined. Thus,
the coefficients in eqs. (A.31) and (A.32) have to coincide, which implies
k
∑
j=0
(−n
j )( −m
k −j) = (−n −m
k
),
as asserted.

476
౪
A Appendix
Let f : ℝn →ℝbe a function. How does one define the integral ∫ℝn f (x) dx? To sim-
plify the notation, let us restrict ourselves to the case n = 2. The main problems already
become clear in this case and the obtained results easily extend to higher dimensions.
The easiest way to introduce the integral of a function of two variables is as follows:
∫
ℝ2
f (x) dx :=
∞
∫
−∞
[
∞
∫
−∞
f (x1, x2) dx2]dx1 .
In order for this double integral to be well defined, we have to assume the existence
of the inner integral for each fixed x1 ∈ℝand then the existence of the integral of the
function
x1 󳨃→
∞
∫
−∞
f (x1, x2) dx2 .
In doing so, the following question arises immediately: why do we not define the integral
in reversed order, that is, first integrating with respect to x1 and then with respect to x2?
To see the difficulties that may appear, let us consider the following example.
Example A.5.4. The function f : ℝ2 →ℝis defined as follows (see Fig. A.8): If either
x1 < 0 or x2 < 0 set f (x1, x2) = 0. If x1, x2 ≥0 define f by
f (x1, x2) :=
{
{
{
{
{
{
{
+1
if x1 ≤x2 < x1 + 1,
−1
if x1 + 1 ≤x2 ≤x1 + 2,
0
otherwise.
We immediately see that
∞
∫
0
f (x1, x2) dx2 = 0
for all x1 ∈ℝ,
hence
∞
∫
0
[
∞
∫
0
f (x1, x2) dx2]dx1 = 0 .
On the other hand, it follows
∞
∫
0
f (x1, x2) dx1 =
{
{
{
{
{
{
{
{
{
∫
x2
0 (+1) dx1 = x2
if 0 ≤x2 < 1,
∫
x2−1
0
(−1) dx1 + ∫
x2
x2−1(+1) dx1 = 2 −x2
if 1 ≤x2 ≤2,
∫
x2
x2−2 f (x1, x2) dx1 = 0
if 2 < x2 < ∞,
leading to
∞
∫
0
[
∞
∫
0
f (x1, x2) dx1] dx2 =
1
∫
0
x2 dx2 +
2
∫
1
(2 −x2) dx2 = 1 .

A.5 Some analytic tools
౪
477
Thus, in this case
∞
∫
0
[
∞
∫
0
f (x1, x2) dx1] dx2
̸=
∞
∫
0
[
∞
∫
0
f (x1, x2) dx2] dx1 .
Figure A.8: On the left-hand side, one first integrates f over x2 with x1 fixed. On the right-hand side, the
integration of f is done over x1 with x2 fixed. In this case three different regions for the choice of x2 have to
be considered.
Example A.5.4 shows that neither the definition of the integral of functions of several
variables nor the interchange of integrals are unproblematic. Fortunately, we have the
following positive result (see [Dur19, Section 1.7], for more information).
Proposition A.5.5 (Fubini’s theorem). If f (x1, x2) ≥0 for all (x1, x2) ∈ℝ2, then one may
interchange the order of integration. In other words,
∞
∫
−∞
[
∞
∫
−∞
f (x1, x2) dx1] dx2 =
∞
∫
−∞
[
∞
∫
−∞
f (x1, x2) dx2] dx1 .
(A.33)
Hereby we do not exclude that one of the two, hence also the other, iterated integral is
infinite.
Furthermore, in the general case (the function f may attain also negative values)
equality (A.33) holds provided that one of the iterated integrals, for example,
∞
∫
−∞
[
∞
∫
−∞
󵄨󵄨󵄨󵄨f (x1, x2)󵄨󵄨󵄨󵄨dx1] dx2
is finite. Due to the first part, then we also have
∞
∫
−∞
[
∞
∫
−∞
󵄨󵄨󵄨󵄨f (x1, x2)󵄨󵄨󵄨󵄨dx2] dx1 < ∞.

478
౪
A Appendix
Whenever a function f on ℝ2 satisfies one of the two assumptions in Proposi-
tion A.5.5, by
∫
ℝ2
f (x) dx :=
∞
∫
−∞
[
∞
∫
−∞
f (x1, x2) dx1] dx2 =
∞
∫
−∞
[
∞
∫
−∞
f (x1, x2) dx2] dx1
the integral of f is well defined. Given a subset B ⊆ℝ2, we set
∫
B
f (x) dx := ∫
ℝ2
f (x) 1B(x) dx ,
provided the integral exists. Recall that 1B denotes the indicator function of B introduced
in eq. (3.21).
For example, let K1 be the unit circle in ℝ2, that is, K1 = {(x1, x2) : x2
1 + x2
2 ≤1}, then
it follows
∫
K1
f (x) dx =
1
∫
−1
√1−x2
1
∫
−√1−x2
1
f (x1, x2) dx2 dx1 .
Or, if B = {(x1, x2, x3) ∈ℝ3 : x1 ≤x2 ≤x3}, we have
∫
B
f (x) dx =
∞
∫
−∞
x3
∫
−∞
x2
∫
−∞
f (x1, x2, x3) dx1 dx2 dx3 .
Remark A.5.6. Proposition A.5.5 is also valid for infinite double series. Let αij be real
numbers either satisfying αij ≥0 or ∑∞
i=0 ∑∞
j=0 |αij| < ∞, then this implies
∞
∑
i=0
∞
∑
j=0
αij =
∞
∑
j=0
∞
∑
i=0
αij =
∞
∑
i,j=0
αij .
Even more generally, if the sets Ik ⊆ℕ2
0, k ∈ℕ0, form a disjoint partition of ℕ2
0, then
∞
∑
i,j=0
αij =
∞
∑
k=0
∑
(i,j)∈Ik
αij .
For example, if Ik = {(i, j) ∈ℕ2 : i + j = k}, then
∞
∑
i,j=0
αij =
∞
∑
k=0
∑
(i,j)∈Ik
αij =
∞
∑
k=0
k
∑
i=0
αi k−i .

Bibliography
[Art64]
Emil Artin. The Gamma Function. Athena Series: Selected Topics in Mathematics, Holt, Rinehart and
Winston, New York, Toronto, London, 1964.
[Axl15]
Sheldon Axler. Linear Algebra Done Right. Springer International Publishing, Cham Heidelberg,
New York, Dordrecht, London, 3rd edition, 2015.
[Bau96]
Heinz Bauer, Probability Theory. De Gruyter Studies in Mathematics, Walter de Gruyter & Co.,
Berlin, 1996.
[Bau01]
Heinz Bauer. Measure and Integration Theory. De Gruyter Studies in Mathematics, Walter de
Gruyter & Co., Berlin, 2001.
[Bil12]
Patrick Billingsley. Probability and Measure. John Wiley and Sons, Inc., Hoboken, 4th edition, 2012.
[CB02]
George Casella and Roger L. Berger. Statistical Inference. Duxburg Press, Pacific Grove, CA, 2nd
edition, 2002.
[CL23]
Sebastian M. Cioabă and Werner Linde. A Bridge to Advanced Mathematics: From Natural to Complex
Numbers. Pure and Applied Undergraduate Texts, 58, American Mathematical Society, Providence,
RI, 2023.
[Coh13]
Donald L. Cohn. Measure Theory. Birkhäuser Advanced Texts, Birkhäuser, Springer, New York, 2nd
edition, 2013.
[Dud02] Richard M. Dudley. Real Analysis and Probability. Cambridge University Press, Cambridge, 2002.
[Dur19]
Richard Durrett. Probability: Theory and Examples. Cambridge University Press, New York, 5th
edition, 2019.
[Eri73]
Bruce K. Erickson. The strong law of large numbers when the mean is undefined. Trans. Amer. Math.
Soc. 185 (1973), 371–381.
[Fel68]
William Feller. An Introduction to Probability Theory and its Applications, volume 1. John Wiley and
Sons, New York, London, Sydney, 3rd edition, 1968.
[Fis11]
Hans Fischer. A History of the Central Limit Theorem. Ergebnisse der Mathematik und ihrer
Grenzgebiete, Springer, New York, 2011.
[Fsh71]
Ronald Aymer Fisher. The Design of Experiments. Hafner Press, London, 9th edition, 1971.
[Gha19]
Saeed Ghahramani. Fundamentals of Probability. Pearson Education, Inc., Upper Saddle River, NJ,
4th edition, 2019.
[GS01]
Geoffrey R. Grimmett and David R. Stirzacker. One Thousand Exercises in Probability. Oxford
University Press, Oxford, New York, 1st edition, 2001.
[GS20]
Geoffrey R. Grimmett and David R. Stirzacker. Probability and Random Processes. Oxford University
Press, Oxford, New York, 4th edition, 2020.
[Hal14]
Paul R. Halmos. Measure Theory. Springer, New York, NY, 2014.
[Kal21]
Olav Kallenberg. Foundations of Modern Probability. Probability Theory and Stochastic Modeling,
99, Springer, Cham, 3rd edition, 2021.
[Kho07]
Davar Khoshnevisan. Probability. Graduate Studies in Mathematics, 80, American Mathematical
Society, New York, 2007.
[Kle20]
Achim Klenke. Probability Theory – A Comprehensive Course. Universitext, Springer, Cham, 3rd
edition, 2020.
[Kol33]
Andrey Nikolajewitsch Kolmogorov. Grundbegriffe der Wahrscheinlichkeitsrechnung. Ergebnisse der
Mathematik und ihrer Grenzgebiete, Julius Springer, Berlin, 1933.
[Lag13]
Jeffrey C. Lagarias. Euler’s constant: Euler’s work and modern developments. Bull. Amer. Math. Soc.
(N. S.) 50 (2013), 527–628.
[LG22]
Jean-François Le Gall. Measure Theory, Probability, and Stochastic Processes. Graduate Texts in
Mathematics, Springer, Cham, 2022.
[Mor16]
Samuel G. Moreno. A Short and elementary proof of the Basel problem. College Math. J. 47 (2016),
134–135.
https://doi.org/10.1515/9783111325064-010

480
౪
Bibliography
[Pao06]
Marc S. Paolella. Fundamental Probability. A Computational Approach. John Wiley and Sons,
Chichester, 2006.
[Par05]
Kalyanapuram Rangachari Parthasarathy. Introduction to Probability and Measure. Texts and
Readings in Mathematics, 33, Corrected reprint of the 1977 original, Hindustan Book Agency,
New Delhi, 2005.
[Rev13]
Pál Révész. Random Walk in Random and Non-random Environments. World Scientific Publishing Co.
Pte. Ltd., Hackensack, NJ, 3rd edition, 2013.
[Ros06]
Jeffrey S. Rosenthal. A First Look at Rigorous Probability Theory. World Scientific Publishing Co. Pte.
Ltd., Hackensack, NJ, 2nd edition, 2006.
[Rss14]
Sheldon Ross. A First Course in Probability. Pearson Education Limited, Essex, 9th edition, 2014.
[Sam04] Dov Samet, Iddo Samet and David Schmeidler. One observation behind two-envelope puzzles. Amer.
Math. Monthly 111 (2004), 347–351.
[Sch17]
René L. Schilling. Measures, Integrals and Martingales. Cambridge University Press, Cambridge,
2nd edition, 2017.
[Spi08]
Michael Spivak. Calculus. Publish or Perish, Houston, TX, 4th edition, 2008.
[Ste15]
James Stewart. Calculus. Cengage Learning, Boston, 8th edition, 2015.
[Sti03]
David R. Stirzaker. Elementary Probability. Cambridge University Press, Cambridge, 2nd edition,
2003.

Index
Absolute nth moment
– of a random variable 257
α-significance test 381
– most powerful 382
Arcsine distribution 68
Arcsine law
– for random walks 303
ℬα,β, beta distribution 66
Banach’s matchbox problem 46
Basel problem 19
Bayes’ formula 118
Bernoulli trial 211
Bernstein polynomial 367
Berry–Esséen theorem 366
Bertrand paradox 109
Beta distribution 66
Beta function 65
Bias
– of an estimator 428
Binary fraction 189
Binomial coefficient 458
– generalized 461
Binomial distribution 28
Binomial theorem 459
Bn,p, binomial distribution 28
B−
n,p, negative binomial distribution 45
Boole’s inequality 11
Borel σ-field
– on ℝ6
– on ℝn 81
Borel set
– in ℝ6
– in ℝn 81
Borel–Cantelli lemma 335
Box
– n-dimensional 81
Boy or girl paradox 279
Buffon’s needle test 88
Cantor set 54
Cardinality of a set 451
Cartesian product 453
Cauchy distribution 69
– general 109
Cauchy–Schwarz inequality 276
CDF 70
Central limit theorem 350
– for Γ-distributed random variables 363
– for binomial random variables 359
– for Poisson random variables 361
Chain rule
– for conditional probabilities 129
Chebyshev’s inequality 328
χ2-distribution 64
χ2-tests
– known expected value 406
– unknown expected value 407
Clopper–Pearson intervals 440
Complementary set 452
Completely normal numbers 347
Conditional distribution 115
Conditional probability 115
Confidence intervals 433
– for binomial populations 438
– approximative ones 443
– exact ones 440
– for hypergeometric populations 444
– for normal populations 435
Confidence regions 433
Continuity correction
– for normal approximation 353
Continuity of a probability measure
– from above 11
– from below 11
Convergence
– almost surely 342
– in distribution 349
– in probability 341
Convolution
– of two functions 208
Convolution formula
– ℕ0-valued random variables 205
– ℤ-valued random variables 204
– continuous random variables 208
Coordinate mappings
– of a random vector 146
Correlated random variables 274
Correlation coefficient 276
Coupon collector’s problem 255
Covariance
– of two random variables 271
– properties 272
https://doi.org/10.1515/9783111325064-011

482
౪
Index
Covariance matrix
– of a normal vector 320
– of a random vector 318
Critical region 377
Cumulative distribution function
– of a probability measure 70
– of a random variable 139
De Morgan’s rules 453
Density
– of a probability measure
– multivariate 81
– univariate 50
Density function
– of a probability measure
– multivariate 81
– univariate 49
– of a random variable 136
– of a random vector 154
Dependence of events 120
Dilemma
– of hypothesis testing 380
Dirac measure 21
Discrete random variable 136
Disjoint sets 452
Distributing particles 23, 32
– anonymous ones 24
– distinguishable ones 24
Distribution
– of a random variable 135
– of a random vector 147
Distribution assumption 371
Distribution density
– of a random variable 136
– of a random vector 154
Distribution function
– of a probability measure 70
– of a random variable 139
Distributive law
– intersection and union 452
Double factorial 58
Drawing with replacement
– no order 463
– with order 462
Drawing without replacement
– no order 463
– with order 462
Dyadic rational number 189
Eλ, exponential distribution 61
Eλ,n, Erlang distribution 63
Elementary event 2
Envelope exchange paradox 287
Erlang distribution 63
Error
– of the first kind 378
– of the second kind 378
Error function
– Gaussian 72
Estimator 415
– efficient 431
– maximum likelihood 418
– unbiased 424
– uniformly best 430
Euclidean distance
– in ℝn 468
Euler’s constant 256
Event 2
– certain 3
– elementary 2
– impossible 3
Expected value
– of continuous random variables 245
– of discrete random variables 235
– of nonnegative random variables
– continuous case 243
– discrete case 236
– of random vectors 318
– properties 250
Exponential distribution 61
F-distribution 229
F-tests 412
f. a. 334
Factorial 456
Finite additivity 8
Fisher information 431
Fisher–Snecedor distribution 229
Fisher’s
– lemma 392
– theorem 393
Floor function 456
Frequency
– absolute 7
– relative 7
Fubini’s theorem 477
Function
– absolutely integrable 244

Index
౪
483
– integrable 243
– measurable 180
Gambler’s ruin 293
Γα,β, gamma distribution 61
Gamma function 58
Gauss test
– one-sided 400
– two-sided 401
Gaussian Φ-function 72
Gaussian error function 72
Generalized binomial coefficient 461
Generated σ-field 4
Generating function
– of a nonnegative random variable 308
– of an ℕ0-valued random variable 231
Geometric distribution 41
Gp, geometric distribution 41
Histogram correction
– for normal approximation 353
Hitting time theorem 302
HN,M,n, hypergeometric distribution 39
Hypergeometric distribution 39
Hypothesis
– alternative 376
– null 376
Hypothesis test 377
Identically distributed 135
Identity matrix 470
Inclusion–exclusion formula 14, 104
Independence
– of infinitely many events 335
– of n events 123
– of two events 120
Independent random variables 157
– continuous case 165
– discrete case 161
– infinitely many 193
Independent repetition
– of an experiment 372
Indicator function
– of a set 164
Inequality
– Boole’s 11
– Cauchy–Schwarz 276
– Chebyshev’s 328
– Lyapunov’s 258
Initial model
– of a statistical experiment 372
Intersection
– of sets 451
Interval estimator 432
i. o. 334
Joint density
– of n random variables 154
Joint distribution
– of n random variables 147
Laplace distribution 21
Law
– of iterated logarithm 357
– of multiplication 112
– of total probability 115
Lemma
– Borel–Cantelli 335
– Fisher’s 392
Likelihood function
– continuous case 417
– discrete case 417
Log-likelihood function 418
Loss function
– of an estimator 427
Lower limit
– of events 333
Marginal distributions
– of a random vector 148
– continuous case 154
– discrete case 150
Marriage problem 283
Matchbox problem 46
Matrix
– identity 470
– inverse 471
– invertible 469
– nonsingular 469
– orthogonal 471
– positive definite 470
– regular 469
– symmetric 470
– transposed 469
– unitary 471
Maximum likelihood estimator 418
Measurable function 180

484
౪
Index
Median
– of a random variable 247
MLE 418
Moments
– of a random variable 257
Monkey at the cliff 299
Monte Carlo method 344
Monty Hall problem 106
Multinomial
– coefficient 465
– random vector 152
– theorem 466
Multinomial distribution 31
ℕ, natural numbers 451
Needle test 88
Negative binomial distribution 45
Negatively correlated 278
𝒩(μ, R), normal distribution
– multivariate 316
𝒩(μ, σ2), normal distribution
– univariate 57
Normal distribution
– multivariate 316
– univariate 57
Normal numbers 346
ℕ0, natural numbers with zero 451
Occurrence
– of an event 3
Occurrence of events
– finally always 334
– infinitely often 334
Order statistics 171
– density 174
– distribution function 172
Pairwise independence 122
Paradox
– boy or girl 279
– envelope exchange 287
– of Bertrand 109
– of Chevalier de Méré 105
Parameter set 374
Pascal’s triangle 459
Permutation 456
Point estimator 415
Point measure 21
Poisλ, Poisson distribution 34
Poisson distribution 34
Poisson’s limit theorem 35
Positively correlated 278
Power function
– of a test 379
Power series 473
Powerset 451
Preimage 454
Principal axis transformation 471
Probabilities
– a posteriori 117
– a priori 117
Probability density function
– multivariate 81
– univariate 49
Probability distribution 9
– of a random variable 135
– continuous case 139
– discrete case 137
– of a random vector 147
Probability mass function 137
Probability measure 9
– continuous
– multivariate 81
– univariate 50
– discrete 20
Probability space 9
Product σ-field 91
Product measure 93
– of continuous probabilities 99
– of discrete probabilities 95
Pseudoinverse
– of a distribution function 199
ℚ, rational numbers 451
Quantile
– Fm,n-distribution 399
– χ2
n-distribution 398
– tn-distribution 399
– general setting 395
– standard normal distribution 396
ℝ, real numbers 451
Radius of convergence 473
Raisins in dough 211
Random experiment 1
Random real number 132
Random variable 132
– continuous 136

Index
౪
485
– discrete 136
– real-valued 132
– singularly continuous 140
– vector valued 146
Random variables
– identically distributed 135
– independent 157
Random vector 146
– 𝒩(μ, R)-distributed 315
– continuous 154
– discrete 149
– multinomial distributed 152
– normally distributed 312
– standard normally distributed 311
Random walk
– limit behavior 355
– (next neighbor) on ℤ183
– starting at an integer 293
– symmetric 184
Randomized test 377
Reduction
– of the sample space 113
Region
– of acceptance 377
– of rejection 377
Region of convergence
– of a power series 474
Risk
– of the buyer 378
– of the trader 378
Risk function
– of an estimator 427
ℝn, n-dimensional Euclidean space 451
Roulette
– chance of winning 296
Round-off errors 357
Sample
– random 371
Sample mean 391
Sample space 1
Sample variance
– biased 391
– unbiased 391
Scalar product
– of two vectors 468
Secretary problem 283
Sequence
– absolutely summable 236
– summable 236
Set difference 452
σ-additivity 8
σ-field 4
– generated 5
Significance level 381
Significance test 381
– for a binomial population
– one-sided 389
– two-sided 386
– for a hypergeometric population
– one-sided 382
– two-sided 449
Simulation
– of a random variable
– continuous case 198
– discrete case 196
Standard normal distribution
– multivariate 102, 317
– univariate 57
Statistical model
– nonparametric 371
– parametric 374
Stirling’s formula
– for n-factorial 60
– for the Γ-function 59
Strong law of large numbers 342
Student’s t-distribution 228
Success probability 30
Sultan’s dowry problem 283
Symmetric difference 453
Systematic error
– of an estimator 428
t-distribution 228
t-test
– one-sided 405
– two-sided 405
Theorem
– Berry–Esséen 366
– binomial 459
– De Moivre–Laplace 359
– Fisher’s 393
– Fubini’s 477
– multinomial 466
– Poisson’s limit 35
– Rao–Cramér–Frechet 431
37 % rule 287
Three sigma rule 187

486
౪
Index
Tossing a coin
– infinitely often 193
Two-envelope paradox 287
Two-number problem 292
Two-sample t-tests 410
Two-sample Z-tests 408
Type I error 378
Type II error 378
Unbiased estimator 424
Uncorrelated random variables 274
Uniform distribution
– on a finite set 21
– on a set in ℝn 87
– on an interval 52
Uniformly best estimator 430
Union
– of sets 451
Upper limit
– of events 333
Vandermonde’s identity 460
Variance
– of a random variable 261
– properties 262
Volume
– n-dimensional 83
Weak law of large numbers 341
ℤ, integers 451
Z-test
– one-sided 400
– two-sided 401

