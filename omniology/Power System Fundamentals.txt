
Power System
Fundamentals


CRC Press is an imprint of the
Taylor & Francis Group, an informa business
Boca Raton   London   New York
Pedro Ponce • Arturo Molina • Omar Mata
Luis Ibarra • Brian MacCleery
Power System
Fundamentals

CRC Press
Taylor & Francis Group
6000 Broken Sound Parkway NW, Suite 300
Boca Raton, FL 33487-2742
© 2018 by Taylor & Francis Group, LLC 
CRC Press is an imprint of Taylor & Francis Group, an Informa business
No claim to original U.S. Government works
Printed on acid-free paper
Version Date: 20171114
International Standard Book Number-13:  978-1-138-55443-6 (Hardback)
This book contains information obtained from authentic and highly regarded sources. Reasonable efforts have 
been made to publish reliable data and information, but the author and publisher cannot assume responsibility 
for the validity of all materials or the consequences of their use. The authors and publishers have attempted to 
trace the copyright holders of all material reproduced in this publication and apologize to copyright holders if 
permission to publish in this form has not been obtained. If any copyright material has not been acknowledged 
please write and let us know so we may rectify in any future reprint.
Except as permitted under U.S. Copyright Law, no part of this book may be reprinted, reproduced, transmit-
ted, or utilized in any form by any electronic, mechanical, or other means, now known or hereafter invented, 
including photocopying, microfilming, and recording, or in any information storage or retrieval system, without 
written permission from the publishers.
For permission to photocopy or use material electronically from this work, please access www.copyright.com 
(http://www.copyright.com/) or contact the Copyright Clearance Center, Inc. (CCC), 222 Rosewood Drive, Dan-
vers, MA 01923, 978-750-8400. CCC is a not-for-profit organization that provides licenses and registration for a 
variety of users. For organizations that have been granted a photocopy license by the CCC, a separate system of 
payment has been arranged.
Trademark Notice: Product or corporate names may be trademarks or registered trademarks, and are used only 
for identification and explanation without intent to infringe.
Visit the Taylor & Francis Web site at
http://www.taylorandfrancis.com 
and the CRC Press Web site at
http://www.crcpress.com
eResources are available for this title at https://www.crcpress.com/9781138554436

To my mother Margarita, my children Pedro and
Jamie, and my wife, Norma – Pedro
To my lovely wife Silvia and children
Julio and Monse – Arturo
To my mother Fabiola, and
my father Omar – Omar
To my wife, Zyan Zavaleta – Luis
To Eva Jane MacCleery – Brian
Para Eva MacCleery, mi media
naranja – Brian MacCleery


Contents
Preface
xiii
Acknowledgments
xv
1
Linear Electric Circuits
1
1.1
Passive elements in electric circuits
. . . . . . . . . . . . . .
1
1.2
Type of connection of passive elements
. . . . . . . . . . . .
3
1.2.1
Series combination . . . . . . . . . . . . . . . . . . . .
3
1.2.2
Parallel combination . . . . . . . . . . . . . . . . . . .
4
1.3
Frequency-domain analysis
. . . . . . . . . . . . . . . . . . .
5
1.3.1
Phasors . . . . . . . . . . . . . . . . . . . . . . . . . .
5
1.3.2
Impedances . . . . . . . . . . . . . . . . . . . . . . . .
7
1.3.3
Phasor diagrams . . . . . . . . . . . . . . . . . . . . .
8
1.3.4
Phasor measurement unit . . . . . . . . . . . . . . . .
8
1.3.5
Experimental exercises . . . . . . . . . . . . . . . . . .
11
1.4
AC power analysis . . . . . . . . . . . . . . . . . . . . . . . .
12
1.4.1
Instantaneous power . . . . . . . . . . . . . . . . . . .
12
1.4.2
Average power . . . . . . . . . . . . . . . . . . . . . .
14
1.4.3
Eﬀective values or RMS values . . . . . . . . . . . . .
14
1.4.4
Apparent power and power factor . . . . . . . . . . . .
15
1.4.5
Complex power . . . . . . . . . . . . . . . . . . . . . .
16
1.4.6
Power factor correction
. . . . . . . . . . . . . . . . .
17
1.4.7
Exercises
. . . . . . . . . . . . . . . . . . . . . . . . .
19
1.5
Polyphase circuits
. . . . . . . . . . . . . . . . . . . . . . . .
22
1.5.1
Single-phase three-wire systems . . . . . . . . . . . . .
23
1.5.2
Balanced three-phase voltages . . . . . . . . . . . . . .
23
1.5.3
Balanced Y-Y connection . . . . . . . . . . . . . . . .
26
1.5.4
Balanced Y-∆connection . . . . . . . . . . . . . . . .
28
1.5.5
Balanced ∆-∆connection . . . . . . . . . . . . . . . .
29
1.5.6
Balanced ∆-Y connection . . . . . . . . . . . . . . . .
29
1.5.7
Unbalanced three-phase systems
. . . . . . . . . . . .
31
1.5.8
Power in three-phase systems . . . . . . . . . . . . . .
32
1.5.9
Exercises
. . . . . . . . . . . . . . . . . . . . . . . . .
33
1.6
Harmonics
. . . . . . . . . . . . . . . . . . . . . . . . . . . .
37
1.6.1
Power factor with nonlinear loads . . . . . . . . . . . .
39
1.6.2
Exercises
. . . . . . . . . . . . . . . . . . . . . . . . .
40
vii

viii
Contents
1.7
Theoretical problems
. . . . . . . . . . . . . . . . . . . . . .
41
1.8
Homework problems . . . . . . . . . . . . . . . . . . . . . . .
46
1.9
Simulation
. . . . . . . . . . . . . . . . . . . . . . . . . . . .
52
2
Power Flow and Electric Machinery Basics
55
2.1
A glance into power ﬂow
. . . . . . . . . . . . . . . . . . . .
55
2.1.1
Generators
. . . . . . . . . . . . . . . . . . . . . . . .
55
2.1.2
Transformers . . . . . . . . . . . . . . . . . . . . . . .
56
2.1.3
Power lines . . . . . . . . . . . . . . . . . . . . . . . .
57
2.1.4
Protective devices
. . . . . . . . . . . . . . . . . . . .
58
2.1.5
Sensing transformers . . . . . . . . . . . . . . . . . . .
59
2.2
Modeling basics
. . . . . . . . . . . . . . . . . . . . . . . . .
59
2.2.1
Mechanical perspective
. . . . . . . . . . . . . . . . .
59
2.2.2
Magnetics perspective . . . . . . . . . . . . . . . . . .
61
2.2.3
Magnetically coupled circuits . . . . . . . . . . . . . .
69
2.2.4
Electromechanical energy conversion and losses . . . .
71
2.3
Machine parameters
. . . . . . . . . . . . . . . . . . . . . . .
73
2.3.1
Exercise generator load test . . . . . . . . . . . . . . .
82
2.3.2
Exercise generator no-load test . . . . . . . . . . . . .
86
2.4
Mathematical models of electric machinery
. . . . . . . . . .
90
2.4.1
Power transformer . . . . . . . . . . . . . . . . . . . .
90
2.4.2
Asynchronous machine . . . . . . . . . . . . . . . . . .
94
2.4.3
Brushless motor
. . . . . . . . . . . . . . . . . . . . .
100
2.4.4
Brushless exercise
. . . . . . . . . . . . . . . . . . . .
105
2.5
Theoretical problems
. . . . . . . . . . . . . . . . . . . . . .
107
2.6
Homework problems . . . . . . . . . . . . . . . . . . . . . . .
110
2.7
Simulation
. . . . . . . . . . . . . . . . . . . . . . . . . . . .
113
2.7.1
Transfomers programs . . . . . . . . . . . . . . . . . .
113
2.7.2
Synchronous generator . . . . . . . . . . . . . . . . . .
120
3
Hydroelectricity
123
3.1
Overall characteristics and operation
. . . . . . . . . . . . .
124
3.1.1
Exercises
. . . . . . . . . . . . . . . . . . . . . . . . .
131
3.2
Integration with the inﬁnite bus
. . . . . . . . . . . . . . . .
135
3.2.1
Exercises
. . . . . . . . . . . . . . . . . . . . . . . . .
138
3.3
Theoretical problems
. . . . . . . . . . . . . . . . . . . . . .
139
3.4
Homework problems . . . . . . . . . . . . . . . . . . . . . . .
142
3.5
Simulation
. . . . . . . . . . . . . . . . . . . . . . . . . . . .
145
4
Wind Energy
149
4.1
Wind turbine basic structure
. . . . . . . . . . . . . . . . . .
149
4.2
Worldwide eolic energy production . . . . . . . . . . . . . . .
151
4.3
Basics of wind energy
. . . . . . . . . . . . . . . . . . . . . .
151
4.4
Aerodynamics of wind turbines . . . . . . . . . . . . . . . . .
155
4.4.1
Airfoils
. . . . . . . . . . . . . . . . . . . . . . . . . .
155

Contents
ix
4.5
Constant-speed versus variable-speed turbines
. . . . . . . .
158
4.6
Wind energy resource
. . . . . . . . . . . . . . . . . . . . . .
159
4.7
Power generation system
. . . . . . . . . . . . . . . . . . . .
161
4.7.1
Fixed-speed wind turbines . . . . . . . . . . . . . . . .
162
4.7.2
Variable-speed wind turbines . . . . . . . . . . . . . .
164
4.7.3
The back-to-back converters . . . . . . . . . . . . . . .
165
4.8
Mathematical model of back-to-back converter
. . . . . . . .
166
4.8.1
Left side of back-to-back converter . . . . . . . . . . .
168
4.8.2
Right side of back-to-back converter . . . . . . . . . .
168
4.8.3
DC bus
. . . . . . . . . . . . . . . . . . . . . . . . . .
168
4.8.4
Steady-state model . . . . . . . . . . . . . . . . . . . .
168
4.8.5
Example back-to-back converter
. . . . . . . . . . . .
169
4.8.6
Exercises
. . . . . . . . . . . . . . . . . . . . . . . . .
171
4.9
Economic factors . . . . . . . . . . . . . . . . . . . . . . . . .
172
4.10 Homework problems . . . . . . . . . . . . . . . . . . . . . . .
177
4.11 Simulation
. . . . . . . . . . . . . . . . . . . . . . . . . . . .
180
5
Solar Energy
183
5.1
Capturing solar energy
. . . . . . . . . . . . . . . . . . . . .
184
5.2
Introduction to photo-voltaics
. . . . . . . . . . . . . . . . .
186
5.2.1
Solar arrangements . . . . . . . . . . . . . . . . . . . .
190
5.2.2
Solar cell types . . . . . . . . . . . . . . . . . . . . . .
192
5.3
Photo-voltaic panel modeling . . . . . . . . . . . . . . . . . .
194
5.3.1
Modeling cells arrangements . . . . . . . . . . . . . . .
196
5.3.2
Maximum power . . . . . . . . . . . . . . . . . . . . .
198
5.4
A brief example: Solar umbrella monitoring with LabVIEW .
200
5.5
Exercises
. . . . . . . . . . . . . . . . . . . . . . . . . . . . .
201
5.6
Homework problems . . . . . . . . . . . . . . . . . . . . . . .
206
5.7
Simulation
. . . . . . . . . . . . . . . . . . . . . . . . . . . .
209
6
Electric Power Transmission
211
6.1
Generic structure of a transmission tower
. . . . . . . . . . .
211
6.2
Transmission line parameters . . . . . . . . . . . . . . . . . .
213
6.2.1
Electric resistance
. . . . . . . . . . . . . . . . . . . .
213
6.2.2
Inductance
. . . . . . . . . . . . . . . . . . . . . . . .
214
6.2.2.1
Inductance due to internal ﬂux linkage
. . .
215
6.2.2.2
Inductance due to external ﬂux linkage
. . .
217
6.2.2.3
Total inductance . . . . . . . . . . . . . . . .
217
6.2.2.4
Inductance in a point P due to an N conduc-
tors system . . . . . . . . . . . . . . . . . . .
218
6.2.2.5
Inductance in the inﬁnite . . . . . . . . . . .
218
6.2.2.6
Inductance of a monophasic system
. . . . .
219
6.2.2.7
Inductance of a three-phase system
. . . . .
219
6.2.3
Geometric mean radius and geometric mean distance .
221
6.2.4
Inductance of three-phase double circuit lines . . . . .
223

x
Contents
6.2.5
Capacitance of transmission lines . . . . . . . . . . . .
224
6.2.5.1
Capacitance of a single-phase line
. . . . . .
226
6.2.5.2
Capacitance of a three-phase line . . . . . . .
226
6.2.5.3
Eﬀect of earth on the capacitance of conduc-
tors . . . . . . . . . . . . . . . . . . . . . . .
228
6.2.6
Exercises
. . . . . . . . . . . . . . . . . . . . . . . . .
230
6.3
Transmission line mathematical model . . . . . . . . . . . . .
233
6.3.1
Exact ABCD model of a transmission line . . . . . . .
233
6.3.2
Equivalent π circuit
. . . . . . . . . . . . . . . . . . .
236
6.3.3
Exercises
. . . . . . . . . . . . . . . . . . . . . . . . .
236
6.4
Power ﬂow analysis
. . . . . . . . . . . . . . . . . . . . . . .
239
6.4.1
Exercises
. . . . . . . . . . . . . . . . . . . . . . . . .
240
6.5
Theoretical problems
. . . . . . . . . . . . . . . . . . . . . .
247
6.6
Homework problems . . . . . . . . . . . . . . . . . . . . . . .
252
6.7
Simulation
. . . . . . . . . . . . . . . . . . . . . . . . . . . .
255
7
Power Distribution System, Unsymmetrical Failures, and
Power System Protections
257
7.1
Types of distribution systems . . . . . . . . . . . . . . . . . .
258
7.1.1
Radial networks
. . . . . . . . . . . . . . . . . . . . .
258
7.1.2
Ring networks
. . . . . . . . . . . . . . . . . . . . . .
263
7.1.3
Mesh networks . . . . . . . . . . . . . . . . . . . . . .
263
7.1.4
Exercise . . . . . . . . . . . . . . . . . . . . . . . . . .
264
7.2
Faults on power systems
. . . . . . . . . . . . . . . . . . . .
266
7.2.1
Symmetrical components
. . . . . . . . . . . . . . . .
269
7.2.2
Sequence networks of electric machinery . . . . . . . .
272
7.2.3
Coupled circuits for unsymmetrical faults . . . . . . .
274
7.2.3.1
Single line-to-ground fault
. . . . . . . . . .
275
7.2.3.2
Line-to-line fault . . . . . . . . . . . . . . . .
276
7.2.3.3
Double line to ground . . . . . . . . . . . . .
277
7.2.3.4
Summary of coupled circuits . . . . . . . . .
278
7.2.4
Exercises
. . . . . . . . . . . . . . . . . . . . . . . . .
278
7.2.4.1
Line-to-earth fault protection . . . . . . . . .
278
7.2.4.2
Undervoltage and overvoltage protection
. .
282
7.3
Electric protections
. . . . . . . . . . . . . . . . . . . . . . .
287
7.3.1
Types of faults and relays . . . . . . . . . . . . . . . .
290
7.3.2
Relay operation . . . . . . . . . . . . . . . . . . . . . .
292
7.3.3
Overcurrent protection . . . . . . . . . . . . . . . . . .
295
7.3.4
Overvoltage protection . . . . . . . . . . . . . . . . . .
298
7.3.5
Undervoltage protection . . . . . . . . . . . . . . . . .
303
7.3.6
Load unbalance protection . . . . . . . . . . . . . . . .
305
7.3.7
Distance protection . . . . . . . . . . . . . . . . . . . .
308
7.4
Power line carrier
. . . . . . . . . . . . . . . . . . . . . . . .
312
7.5
Theoretical problems
. . . . . . . . . . . . . . . . . . . . . .
313
7.6
Homework problems . . . . . . . . . . . . . . . . . . . . . . .
317

Contents
xi
7.7
Simulation
. . . . . . . . . . . . . . . . . . . . . . . . . . . .
319
8
Renewable Energy
321
8.1
Energy sources and resources . . . . . . . . . . . . . . . . . .
322
8.2
Types of energy
. . . . . . . . . . . . . . . . . . . . . . . . .
323
8.3
Types of renewable energy
. . . . . . . . . . . . . . . . . . .
324
8.4
Advantages and disadvantages
. . . . . . . . . . . . . . . . .
325
8.5
Storage
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
326
8.5.1
Pumped hydro . . . . . . . . . . . . . . . . . . . . . .
327
8.5.2
Compressed air . . . . . . . . . . . . . . . . . . . . . .
328
8.5.3
Flywheels . . . . . . . . . . . . . . . . . . . . . . . . .
328
8.5.4
Batteries
. . . . . . . . . . . . . . . . . . . . . . . . .
329
8.5.5
Rokkasho-Futamata Wind Farm
. . . . . . . . . . . .
329
8.6
Energy and society
. . . . . . . . . . . . . . . . . . . . . . .
330
8.6.1
Use of energy . . . . . . . . . . . . . . . . . . . . . . .
331
8.7
Economics
. . . . . . . . . . . . . . . . . . . . . . . . . . . .
332
8.8
Solutions
. . . . . . . . . . . . . . . . . . . . . . . . . . . . .
332
8.9
Theoretical problems
. . . . . . . . . . . . . . . . . . . . . .
334
8.10 Homework problems . . . . . . . . . . . . . . . . . . . . . . .
335
8.11 Summary
. . . . . . . . . . . . . . . . . . . . . . . . . . . . .
337
9
Smart Grid
341
9.1
Beneﬁts of the smart grid . . . . . . . . . . . . . . . . . . . .
343
9.2
Cyber-security
. . . . . . . . . . . . . . . . . . . . . . . . . .
350
9.3
Exercises
. . . . . . . . . . . . . . . . . . . . . . . . . . . . .
351
9.3.1
Contribution of solar energy . . . . . . . . . . . . . . .
351
9.3.2
Contribution of wind plant
. . . . . . . . . . . . . . .
354
9.4
Homework problems . . . . . . . . . . . . . . . . . . . . . . .
357
9.5
Simulation
. . . . . . . . . . . . . . . . . . . . . . . . . . . .
359
10 Power
Electronics
in
Power
Systems
Using
LabView,
LabView-FPGA, and Multisim
361
10.1 Introduction
. . . . . . . . . . . . . . . . . . . . . . . . . . .
361
10.2 Co-simulation LabVIEW and Multisim
. . . . . . . . . . . .
365
10.3 Case study: Intelligent wind turbine control with LabVIEW
378
10.3.1 Wind turbine operation . . . . . . . . . . . . . . . . .
379
10.3.2 Wind turbine per unit (P. U.) model . . . . . . . . . .
380
10.3.3 Fault model of the wind turbine converter circuit . . .
382
10.3.4 Artiﬁcial neural networks for fault detection . . . . . .
384
10.4 Co-simulation LabVIEW FPGA and Multisim
. . . . . . . .
392
10.5 Case study: A half-bridge inverter control . . . . . . . . . . .
397
10.5.1 Background . . . . . . . . . . . . . . . . . . . . . . . .
397
10.5.2 Procedure . . . . . . . . . . . . . . . . . . . . . . . . .
401
10.6 Case study: the phase-lock loop (PLL)
. . . . . . . . . . . .
406
10.6.1 Summary . . . . . . . . . . . . . . . . . . . . . . . . .
406

xii
Contents
10.6.2 Background . . . . . . . . . . . . . . . . . . . . . . . .
409
Bibliography
415
Index
421

Preface
Power systems are changing in the world because the conventional electric grid
systems cannot face ecological and technological demands from the end-user
of the electric grid. However, control systems, communication technologies,
digital systems, and power electronics are opening new electric grids called
smart grids. The Smart Grid has advanced engineering concepts that improve
the eﬃciency inside the smart grid but at present there are new challenges
that need to be solved; for instance, the real-time communication to meet
customer electrical demand in the smart grid system.
This book shows the fundamentals of power systems that are the basic
elements for understanding the smart grid technology, based on theoretical and
experimental challenges in which the conventional and advanced electric grids
have to be understood in undergraduate and graduate courses. Moreover, this
book also describes the technological knowledge that has to be understood by
the new generations of electrical engineers when they are dealing with power
systems and smart grid technologies.
Although conventional electrical energy is a well-known engineering area,
there are topics that have to be presented in a diﬀerent manner because new
technologies have arisen such as power electronics and digital systems. On the
other hand, smart grid is a new concept for integrating several areas such as
renewable energy, transmission lines, conventional electric sources, communi-
cations, SCADA systems, and so on. Smart grid will bring new possibilities to
solve generation, distribution, and consumption problems of power systems.
On the other hand, one of the main challenges is to generate engineers who
understand power systems, so it is important to present in a clear and friendly
manner the principles that drive modern power systems. As a result, this book
illustrates step by step the topics that are needed to cover power systems, an
introduction to smart grid courses.
The content of the book moves from electric circuits to renewable electric
energy in order to connect the concepts that are needed; the book shows the-
oretical and experimental exercises so the reader can compare the simulation,
co-simulation, experimental, and theoretical results. For additional material,
visit https://www.crcpress.com/9781138554436
xiii


Acknowledgments
This book is a product of the Project 266632 “Laboratorio Binacional para
la Gesti´on Inteligente de la Sustentabilidad Energ´etica y la Formaci´on Tec-
nol´ogica” [“Bi-National Laboratory on Smart Sustainable Energy Manage-
ment and Technology Training”], funded by the CONACYT SENER Fund
for Energy Sustainability (Agreement: S0019-2014-01).
Also, we thank Tecnol´ogico de Monterrey and National Instruments which
always provide us with support in our research projects.
Finally, we thank the people who helped in the consummation of this
project:
Antonio Rosales, Arturo Soriano, Eduardo Torres, Iv´an Villanueva,
and David Balderas
Tecnologico de Monterrey
Mexico City, Mexico
The extraordinary editorial team of Taylor & Francis Group.
xv


1
Linear Electric Circuits
1.1
Passive elements in electric circuits
An active element is deﬁned as an element that is capable of furnishing an
average power greater than zero to a particular device. However, a passive
element cannot supply an average power that is greater than zero over an
inﬁnite time interval.
The resistor is the simplest passive element and is based on the statement
of the fundamental relationship called Ohm’s law. It states that the voltage
across conducting materials is directly proportional to the current ﬂowing
through it,
v = Ri,
(1.1)
where the constant of proportionality R is called resistance. Its unit is called
ohm, which is 1 [V/A], and it is abbreviated by the Greek letter Ω.
Equation (1.1) is a linear equation; therefore it is considered to be the
deﬁnition of a linear resistor. The linear resistor is an idealized circuit element;
the voltage-current ratios of these physical devices are constant only within
certain ranges of current, voltage, or power, and also depend on temperature
and other external factors.
Resistors can be connected in series or parallel so the total resistance can
be calculated according to the following expressions: series connection (R =
R1 + R2 + R3 + ...), parallel connection (1 / R = 1 / R1 + 1 / R2 + 1 / R3
+...). Figure 1.1 shows a series connection.
Another passive element used in electric circuits is the capacitor. The
capacitance C is deﬁned as the following voltage-current relationship
i = C dv
dt ,
(1.2)
where v and i are functions of time that satisfy the conventions for a passive
element. Therefore the unit of capacitances is an ampere-second per volt, or
coulomb per volt. So a farad [F] is deﬁned as one coulomb per volt and used
as unit of capacitance.
A capacitor consists of two conducting surfaces separated by a thin insu-
lating material with a very large resistance, in which electric charge may be
stored.
1

2
1 Linear Electric Circuits
Some of the characteristics of the capacitor are obtained from Equation
(1.2). A constant voltage across a capacitor gives zero current passing through
it; thus it can be seen as an “open circuit to DC voltage.” Another character-
istic comes to notice in the case of a sudden jump in the voltage; an inﬁnite
current is required, and since this is impossible, an instant change of voltage
across a capacitor is prohibited.
The capacitor voltage may be expressed in terms of current by integrating
the equation and solving for v(t) (1.2)
dv
=
1
C i(t)dt
v(t)
=
1
C
ˆ t
t0
i(t) dt.
(1.3)
In real problems, the initial voltage across the capacitor often cannot be
discerned. In this case it is convenient to set t0 = −∞and v(−∞) = 0, so
that
v(t) = 1
C
ˆ t
−∞
i(c) dt′.
(1.4)
The last passive element is the inductor, and as the capacitor, its induc-
tance L is deﬁned by a voltage-current equation:
v = Ldi
dt.
(1.5)
The unit in which inductance is measured is the henry [H]. The operating
principle of the inductor began with Michael Faraday, when he discovered that
a changing magnetic ﬁeld could induce a voltage, proving that this voltage was
proportional to the time rate of change of current producing the magnetic ﬁeld.
Equation (1.5) is the mathematical model of an ideal inductor. A physical
inductor can be constructed by winding a length of wire into a coil. Some
electrical characteristics can be obtained through this equation. First it is
shown that the voltage across an inductor is proportional to the time rate of
change of the current through it, therefore for a constant current there is no
voltage across the inductor, so it can be viewed as a “short circuit to DC.”
Another fact is that a sudden or discontinuous change in the current must
be associated with an inﬁnite voltage across the inductor, but in reality an
inﬁnite voltage does not exists.
The inductor current may be expressed in terms of voltage, solving Equa-
tion (1.5) for i(t):
di
=
1
Lvdt
i(t)
=
1
L
ˆ t
−∞
vdt′ + t(t0).
(1.6)

1.2 Type of connection of passive elements
3
FIGURE 1.1
Series combination of N resistors
Solving a realistic problem, as was done for the capacitor, t0 is considered
−∞to ensure no current or energy is in the inductor:
i(t) = 1
L
ˆ t
−∞
vdt′.
(1.7)
1.2
Type of connection of passive elements
When working with multiple elements of the same kind in a circuit, it is
possible to replace complicated element combinations with a single equivalent
element of the same kind. This technique is useful when the current, voltage,
or power associated to each element is not needed; instead the voltage, current,
or power of the whole circuit is of interest. There are two types of connections
in which passive elements can be combined.
1.2.1
Series combination
The simpliﬁcation or combination of multiple elements into an equivalent one
can be applied only to one kind of passive element at the same time. Consider
the series combination of N resistors as shown in Figure 1.1.
To simplify the circuit of N resistors in series, the equivalent resistor is
obtained as the algebraic sum of all the resistors:
Req = R1 + R2 + · · · + RN.
(1.8)
All resistors share the same current, so the current in the equivalent resistor
must be the same. On the other hand, the voltage of the source is divided in
each of the resistors, so the voltage in the equivalent resistor must be the sum
of all individual resistor voltages.
Inductors connected in series can also be combined into one equivalent
inductor as shown in Figure 1.2.
In the same way an equivalent resistor is obtained, the equivalent inductor
is equal to the sum of each inductor in the series connection:
Leq = L1 + L2 + · · · + LN.
(1.9)

4
1 Linear Electric Circuits
FIGURE 1.2
Series combination of N inductors
FIGURE 1.3
Series combination of N capacitors
In case the capacitors are connected in series (see Figure 1.3), the way to
obtain its equivalent value is not the same as for the previous passive elements.
The equivalent capacitor for a series connection is obtained as the inverse
sum of each capacitor inversed:
1
Ceq
= 1
C1
+ 1
C2
+ · · · +
1
CN
.
(1.10)
1.2.2
Parallel combination
A parallel connection between the same kinds of passive elements is deﬁned
when two or more elements share two common nodes. Consider the parallel
combination of N resistors as shown in Figure 1.4.
To simplify the circuit into one equivalent resistor, it must be noticed that
the sum of all currents of each resistor must be equal to the current given by
FIGURE 1.4
Parallel combination of N resistors

1.3 Frequency-domain analysis
5
FIGURE 1.5
Parallel combination of N inductors
FIGURE 1.6
Parallel combination of N capacitors
the source, and substituting with ohm’s law, this can be obtained:
1
Req
= 1
R1
+ 1
R2
+ · · · +
1
RN
.
(1.11)
For inductor elements, the equivalent circuit is obtained the same way as
for the resistors.
The equation of the equivalent inductor, represented in Figure 1.5, for a
parallel connection is
1
Leq
= 1
L1
+ 1
L2
+ · · · +
1
LN
.
(1.12)
Finally, for N capacitors in a parallel combination as shown in Figure 1.6,
the equation of the equivalent capacitor is not the same as the last two, but
the algebraic sum of the capacitors in parallel.
The equation of the equivalent capacitor for a parallel connection is
Ceq = C1 + C2 + · · · + CN.
(1.13)
1.3
Frequency-domain analysis
1.3.1
Phasors
A sinusoidal signal like voltage or current at a given frequency is characterized
by two parameters, amplitude and a phase angle. Consider the sinusoidal

6
1 Linear Electric Circuits
Re
Vm
-Vm
Vm
to
to
Im
t
v(t) = Re(Vmej(wt+θ))
θ
FIGURE 1.7
Frequency domain representation and time domain representation
voltage
v(t) = Vm cos (ωt + θ),
(1.14)
where V m is the amplitude of the sinusoid, ω the angular frequency in [rad/s],
and θ is the phase in [rad].
Equation (1.14) can also be expressed as the real part of a complex quantity
accordingly to Euler’s identity
v(t) = Re{Vmej(ωt+θ)}.
(1.15)
Thus, a phasor is a complex number that represents the amplitude and
phase of a sinusoid, the factor ejωt contains no useful information, and the
voltage can be simpliﬁed to the expression
V = Vmejθ.
(1.16)
Since a complex number can also be represented in a polar form, the phasor
is generally represented as
V = Vm∠θ.
(1.17)
To diﬀerentiate a complex number from one that is not, it will be printed
as boldface type.
This process is called a phasor transformation, in which a function is taken
from a time-domain representation to a frequency-domain representation. It
is noted that the frequency-domain expression of a voltage or a current does
not implicitly include the frequency, as the time-domain expression does.
To obtain the sinusoid corresponding to a given phasor V , it has to be
multiplied by the time factor ejωt and just the real part is taken; see Figure 1.7.
The importance of the phasor in electrical engineering lies in the fact that
it is possible to deﬁne algebraic relationships between the voltage and current
for each of the three passive elements instead of using diﬀerential equations
[80]. The simplest case to begin with is the resistor, where
v(t) = Ri(t).

1.3 Frequency-domain analysis
7
Applying complex voltage and current so that
Vmej(ωt+θ) = RImej(ωt+θ),
and dividing by ejωt, the phasor relation for a resistor is found:
Vmejθ = RImejθ ⇒V = RI.
(1.18)
The second passive element is the inductor. Its deﬁning equation in a time-
domain is
v(t) = Ldi(t)
dt .
It can be shown that the derivate of the voltage or the current is trans-
formed to the phasor domain as jωX, thus the complex expression for the
inductor is
Vmej(ωt+θ) = jωLImej(ωt+θ),
and dividing by ejωt, the phasor relation for an inductor is found:
Vmejθ = jωLImejω ⇒V = jωLI.
(1.19)
Finally, the time-domain current voltage relationship for the capacitor is
i(t) = C dv(t)
dt ,
and doing the same procedure as for the inductor, the phasor relation for a
capacitor is
I = jωCV.
(1.20)
1.3.2
Impedances
An impedance can be deﬁned as the ratio of the phasor voltage to the phasor
current that represents the opposition that the circuit exhibits to the ﬂow
of sinusoidal current. Therefore an impedance can be treated, in a circuit
analysis, as a resistance with the exception that the impedance is a complex
quantity and its algebraic manipulation must be the one for a complex number
[27].
Previously, the phasor relation for the three passive elements, Equations
(1.5–1.7), were obtained,
V = RI, V = jωLI, V =
I
jωC .
Writing Equations (1.5–1.7) in terms of the ratio of the phasor voltage to
the phasor current, the impedance of each element is obtained:
V
I = ZR = R, V
I = ZL = jωL, V
I = ZC =
1
jωC .

8
1 Linear Electric Circuits
The impedance is symbolized by the letter Z and has dimensions of ohms
[Ω]. It is important to note that the impedance is not a phasor, because it is
not a sinusoidal varying quantity; hence it cannot be transformed to the time
domain by multiplying by ejωt and taking the real part. Instead, these three
passive elements can be seen as resistance, inductance, and capacitance in the
time domain and in the frequency domain as their respective impedances R,
jωL, 1/jωC.
Since the impedance can be treated as a resistance, the combinations in
serial or parallel of impedances have the same rules established for the resis-
tances. The equivalent impedance of a series combination is
Zeq = Z1 + Z2 + · · · + Zn,
(1.21)
and the equivalent impedance of a parallel combination is
1
Zeq
= 1
Z1
+ 1
Z2
+ · · · + 1
Zn
.
(1.22)
1.3.3
Phasor diagrams
Previously, the voltage and current phasors were introduced as a complex
number that represents the magnitude and phase of the sinusoidal waveform
for either the voltage or current. Hence, a phasor behaves as a vector whose
graphical representation in the complex plane is known as a phasor diagram.
Let’s take a complex voltage in its rectangular form, V1 = 4 + j3 [V ].
The desired voltage is located in the complex plane by an arrow drawn from
the origin to a point marked in the x axis with the real part of the voltage
and in the y axis with the imaginary part of the voltage. Another way to
represent the same voltage is to transform the complex voltage into its polar
form, V1 = 5∠36.87◦[V ], so it can be represented as a vector of magnitude 5
and an angle of 36.87◦counterclockwise with respect to the x axis, as shown
in Figure 1.8.
Since a phasor behaves as a vector, it is compliant with all the linear alge-
bra operations on vectors. Thus, phasors may be easily added or subtracted
in a phasor diagram as shown in Figure 1.9, and as for the multiplication and
division, may result in the addition and subtraction of angles and change in
amplitude [80]
In addition, if both voltage and current are plotted in the same phasor
diagram, it is easy to determine which waveform is leading and which is lag-
ging. It is said that a signal is leading another if it is in the counterclockwise
direction; however, if it is in the clockwise direction it is instead lagging; see
Figure 1.10.
1.3.4
Phasor measurement unit
A phasor measurement unit (PMU) is deﬁned by the IEEE as a device that
produces synchronized phasor estimates from voltage and/or current signals at

1.3 Frequency-domain analysis
9
FIGURE 1.8
Phasor diagram for V1
V1
V2
V1+V2
FIGURE 1.9
Phasorial addition of two phasors

10
1 Linear Electric Circuits
Vm
Im
V
I
-θ
Φ
Real axis
Imaginary axis
Leading direction
Lagging direction
w
w
FIGURE 1.10
Leading or lagging direction of phasors
microprocessor
converter
FIGURE 1.11
Phasor measurement unit (PMU)
a high sampling rate and a time synchronizing signal to determine the health
of the electricity distribution system. In Figure 1.11, PMU is represented in a
block diagram.
From the voltage and current measured with the PMU, typically at a rate
of 48 samples per cycle, the magnitudes and phase angles of the signals are
calculated in the phasor microprocessor. A phase-lock oscillator along with
the clock signal of the global positioning system (GPS) is used to provide
high-speed synchronized sampling with 1 microsecond accuracy for adding
a timestamp to every measured point. The measured phasors are known as
synchrophasors [44].
When data from multiple PMUs are combined together, the information
provides a global behavioral view of the interconnection. This made possible
some applications like the automation in power systems for smart grids, in-

1.3 Frequency-domain analysis
11
creasing the reliability of the power grid by detecting faults early, prevention
of power outages, increasing power quality, etc.
1.3.5
Experimental exercises
Diﬀerent types of loads can be found in household appliances. These loads may
be resistive, inductive, capacitive, or a combination of them. An example of a
resistive load can be any heater or toaster. An inductive load is a device that
includes motors or ﬂuorescent lights. While a purely capacitive load is diﬃcult
to ﬁnd, they are useful to counteract inductive loads, as will be reviewed in
the next sections.
Recommended equipment and connections:
• Three-phase supply unit
• Maximum demand meter
• Inductive load
• Resistive load
• Capacitive load
• LCR meter
With an LCR meter, measure three values of resistance R[Ω], capacitance
C[F], and inductance L[H] from the respective load modules used, and ﬁnd
their impedance Z [Ω] (assume a 60 Hz frequency operation).
R[Ω]
ZR
C[F]
Zc[Ω]
L[H]
ZL[Ω]
1
1074.2
1074.2
2.465µ
-j1076.1
2.636
j993.75
2
761.2
761.2
4.056µ
-j654
1.847
j696.3
3
445.7
445.7
6.294µ
-j421.4
1.158
j436.5
Calculate the current I for the three measured impedances if the voltage
is 226∠0◦[Vrms]. (V = IZ).
Feed the three modules individually with 220 [Vrms] from the three-phase
supply unit and measure the current drawn with the maximum demand meter
(see Diagram 1.1). Write down your results.
Draw a phasor diagram and write R, C, L next to the corresponding phasor
current according to its nature and your previous calculations. Also write if
it is lagging, leading, or in phase with the voltage phasor.
The current phasor of a capacitive load leads its corresponding voltage
phasor while the current phasor of an inductive load lags the voltage phasor.
In this exercise the 90◦shift of the capacitive load and the −90◦shift of the
inductive load can be noticed.
When the resistive load phasors are in phase, it means that there is no
shift between the current phasor and voltage phasor.

12
1 Linear Electric Circuits
Resistive
Capacitive
Inductive
Theory
Practical
Theory
Practical
Theory
Practical
I[A] 210mΩ
210mΩ
210mΩ
∠90◦
212mΩ
227mΩ
∠−90◦
158mΩ
I[A] 297mΩ
298mΩ
345mΩ
∠90◦
345mΩ
324mΩ
∠−90◦
226mΩ
I[A] 507mΩ
506mΩ
536mΩ
∠90◦
546mΩ
517mΩ
∠−90◦
382mΩ
1.4
AC power analysis
1.4.1
Instantaneous power
One of the most important parts of circuit analysis is to calculate either power
delivered or power absorbed. First, a power analysis in time-domain will be
made to obtain the instantaneous and average power. Then some other power
concepts will be introduced to ﬁnally get to a frequency-domain analysis where
all the relevant power information is gathered.
It is known that the instantaneous power p(t) delivered to any element
is the product of the instantaneous voltage v(t) across the element and the
instantaneous current i(t) through it,
p(t) = v(t)i(t).
(1.23)
Since an AC power analysis is being made, let the voltage and current at
the terminals of the circuit be
v(t) = Vm cos(ωt + θv),
i(t) = Im cos(ωt + θi).
The instantaneous power absorbed by the circuit in the sinusoidal steady
state is
p(t) = VmIm cos(ωt + θv) cos(ωt + θi).
Applying the trigonometric identity
cos A cos B = 1
2[cos(A −B) + cos(A + B)]
to p(t), an instantaneous power expression made of two terms is obtained:
p(t) = 1
2VmIm cos(θv −θi) + 1
2VmIm cos(2ωt + θv + θi).
(1.24)
The ﬁrst term of Equation (1.24) is not a function of time, this is constant

1.4 AC power analysis
13
Diagram 1.1
Connections for diﬀerent loads
FIGURE 1.12
Instant power function

14
1 Linear Electric Circuits
and depends on the phase diﬀerence between voltage and current. The second
term of equation (1.24) is a sinusoidal function that has a cyclic variation at
twice the applied frequency.
In Figure 1.12, it can be observed that p(t) has a period of T/2 due to
the second term and a vertical shift due to the ﬁrst term of the instantaneous
power expression. Also noted is that the function is positive in some parts and
negative in others, which means that in the positive parts power is absorbed
by the circuit while in the negative parts power is absorbed by the source.
1.4.2
Average power
The instantaneous power changes over time, so it is diﬃcult to measure. The
average power is more convenient to measure because it is the average of the
instantaneous power within an interval of time, the period of the function [27].
The average power P may be obtained by integrating p(t) over its period
and dividing the result by the same period of time,
P = 1
T
ˆ T
0
p(t)dt.
(1.25)
The average value is denoted by the capital letter P; it is not a function
of time and its dimensions are in watts. Substituting the instantaneous power
p(t) for a sinusoidal steady state into the average power equation (1.25) gives
P = 1
T
ˆ T
0
1
2VmIm cos(θv −θi)dt + 1
T
ˆ T
0
1
2VmIm cos(2ωt + θv + θi)dt.
Since the ﬁrst term of P is a constant, independent of t, the average value
must be that constant itself. The second term of P is a cosine function whose
average value over a period is zero. Thus,
P = 1
2VmIm cos(θvθi).
(1.26)
Consider two special cases. When θv = θi the circuit is purely resistive,
meaning that a resistive load absorbs power at all times:
P = 1
2VmIm;
and when θv–θi = ±90◦the circuit is purely reactive, meaning that an induc-
tive or capacitive load absorbs no average power at all:
P = 1
2VmIm cos 90◦= 0.
1.4.3
Eﬀective values or RMS values
In Mexico, most of the household power outlets available deliver a sinusoidal
voltage with a frequency of 60 Hz and a voltage of 127 [V ]. This voltage can

1.4 AC power analysis
15
be measured with a voltmeter, and it is certainly not the instantaneous value,
because the voltage is not constant, nor is the average voltage, because it must
be zero, and neither is the amplitude Vm that appeared in all of the equations
mentioned before. So, what kind of value is this 127 [V ]? It is the eﬀective
value of the sinusoidal voltage. An eﬀective value identiﬁes the eﬀectiveness
of a voltage or current source in delivering power to a resistive load [27]. For
a periodic waveform, either voltage or current, the eﬀective value is the direct
current or voltage that delivers the same average power to the resistor as does
the periodic waveform. The RMS value for any periodic function x(t) is given
by
Xrms =
s
1
2
ˆ T
0
x2dt.
(1.27)
Let the sinusoidal voltage to be
v(t) = Im cos(ωt + θv),
so that the RMS value is
Vrms =
s
1
T
ˆ T
0
I2m cos2(ωt + θ)dt =
Vm
p
(2)
.
(1.28)
Similarly, for i(t) = Im cos (ωt + θi), it can be proven that
Irms = Im
√
2.
(1.29)
Therefore, it can be said that the eﬀective value of a sinusoidal waveform is
a real quantity numerically equal to 1/
√
2 times the amplitude of the waveform
and furthermore is independent of the phase angle. This is only true when the
periodic function is sinusoidal.
1.4.4
Apparent power and power factor
Let’s take the average power P and put it in terms of eﬀective values:
P = 1
2VmIm cos(θv −θi) = VrmsIrms cos(θv −θi).
This expression involves a new term called apparent power:
S = VrmsIrms.
(1.30)
The apparent power is the product of the eﬀective values of the voltage
and current for sinusoidal waveforms. It is called apparent because of its re-
semblance to the average power if the voltage and current responses had been
DC quantities [27]. It is measured in volt-amperes [V A] to distinguish it from
other kinds of power already seen.

16
1 Linear Electric Circuits
The ratio of the average power to the apparent power is called the power
factor (PF), so it is the cosine of the phase diﬀerence between voltage and
current,
PF = P
S = cos(θv −θi).
(1.31)
The PF may be seen as the factor that relates the apparent power to
the average power. Its importance lies in the eﬀectiveness in which power is
transferred and therefore it aﬀects the consumption cost of electricity. For
a low power factor (≈0) a load draws more current than for a high power
factor (≈1) with the same load, so the utility company may charge more to
a customer with a low power factor.
1.4.5
Complex power
So far, all the power quantities have been expressed with real numbers. By
making the power a complex quantity, the power relations are made simpler.
For the power to become a complex quantity, an imaginary term is added, the
reactive power. The complex power became important because it contains all
the information pertaining to the power delivered to a given load.
For a voltage v(t) and current i(t) whose phasor representations are V =
Vm∠θv and I = Im∠θi, the complex power S delivered to a load is
S = 1
2V I∗.
(1.32)
In terms of eﬀective values:
S = VrmsI∗
rms.
(1.33)
Since S is a complex quantity it can also be expressed in rectangular form,
S = P + jQ,
(1.34)
where P is the average power and Q is the new imaginary term, reactive
power. The dimensions of Q have to be the same for P and S, but in order to
avoid confusion, the unit of Q is deﬁned as volt-ampere-reactive [VAr]. While
P is the actual power dissipated by the load, Q is a measure of the energy
exchange between the reactive components of the load and the source.
A physical interpretation can be made based on three cases for the reactive
power Q [27]; see Figure 1.13.
1. Q = 0 represents resistive loads (unity PF)
2. Q > 0 represents capacitive loads (leading PF)
3. Q < 0 represents inductive loads (lagging PF)

1.4 AC power analysis
17
Inductive loads
Resistive loads
Capacitive loads
+Q
Q = 0
-Q
Im
Re
FIGURE 1.13
Power triangle with diﬀerent reactive powers
It was said before that the complex power contains all the relevant power
information in a given load, which is shown in the next recap:
Complex power = S = VrmsI∗
rms = P + jQ = VrmsIrms∠(θv −θi)
Average power = P = Re(s) = S cos(θv −θi)
Reactive power = Q = Im(S) = S sin(θv −θi)
Apparent power = S = |S| =
p
P 2 + Q2 = VrmsIrms
Power factor = P
S = cos(θv −θi)
1.4.6
Power factor correction
Most of the household appliances are inductive loads that operate at a low lag-
ging power factor. As mentioned before, low power factors draw more current,
therefore power companies have to build larger current-carrying capacity gen-
erators to provide this larger current to the consumers, making electric power
more expensive. Although the inductive nature of the household loads can-
not be changed, it is possible to increase the power factor of the system in
which they are connected. The process of increasing the power factor without
altering the voltage or current to the original load is known as power factor
correction [27].
Let’s say an inductive circuit is formed by a resistor and an inductor has
a voltage V that draws a current IL. Making a phasor diagram for the induc-
tive load shows that the circuit has a power factor of cos (θ1), as shown in
Figure 1.14.

18
1 Linear Electric Circuits
V
IL
θ1
IL
V
FIGURE 1.14
Circuit with an RL load
V
IL
θ1
IL
V
IC
I
θ2
I
IC
FIGURE 1.15
Circuit with an RL load in parallel with a capacitor
If a capacitor C is added in parallel with the load into the circuit, a new
current IC is generated so that the total current drawn from the generator
becomes I = IC + IL. Again, making the phasor diagram, it can be seen that
the power factor is increased by the reduction of the phase angle between the
supplied voltage and the current from θ1 to θ2; see Figure 1.15.
Let us note that the magnitude of current I is less than the current IL with
the same supplied voltage. So, the reason to make a power factor correction
is to reduce the current drawn from the generators, representing savings for
both the power companies and the consumer.
To determine the value of the required capacitor for improving the PF of a
circuit, it is necessary to take into consideration that the supplied real power
has to remain the same.
From the power triangle for an inductive load with an apparent power S1
(see Figure 1.16),
P = S1 cos(θ1), Q1 = S1 sin(θ1) = P tan(θ1).
Therefore, the modiﬁed reactive power has to be
Q2 = P tan(θ2).
So, the reduction in reactive power QC is due to a shunt capacitance C

1.4 AC power analysis
19
θ1
θ2
S1
S2
P
Qc
Q2
Q1
FIGURE 1.16
Power triangle with Q reduction
determined as
C =
Q
ωV 2
rms
= P(tan(θ1 −θ2))
ωV 2
rms
,
(1.35)
where P = supplied real power, tan(θ1) = present power factor, tan(θ2) =
target power factor, ω = frequency of operation, Vrms = eﬀective voltage.
1.4.7
Exercises
Most of the household appliances are a combination of inductive and resistive
loads. In this exercise a comparison between an inductive-resistive load and a
capacitive-resistive load will be made regarding their power consumption and
power factor. Finally, a correction in power factor for the inductive-resistive
load will be made to improve the power stats.
Recommended equipment and connections:
• Three-phase supply unit
• Maximum demand meter
• Inductive load
• Resistive load
• Capacitive load
• Switchable capacitor battery
• LCR meter

20
1 Linear Electric Circuits
With an LCR meter, measure one value of resistance R [Ω], capacitance C
[F], and inductance L [H] from the load modules used and ﬁnd their impedance
Z (assume a 60 Hz frequency operation).
R [Ω]
ZR[Ω]
C [F]
Zc[Ω]
L [H]
ZL[Ω]
1
761.2
761.2
6.294µ
-j421.4
2.636
j993.75
For a series combination of the previously selected resistor and capacitor,
calculate the current I of the circuit if it has a voltage of 226∠0◦[Vrms]. Then
obtain the total complex power of the load and ﬁll the next table.
Parameter
Number
Unit
Complex power (rectangular)
51.36 −j28.43
[VA]
Complex power (polar)
58.7∠−28.97◦
[VA]
Apparent power
58.7
[VA]
Average power
51.36
[W]
Reactive power
-28.43
[VAr]
Power factor
0.875
Connect the previously selected resistive load and capacitive load in series,
then feed them with 220 [Vrms] from the three-phase supply unit. Measure
all the power parameters of the load with the maximum demand meter and
compare your results (see Diagram 1.2).
Parameter
Theoretical
Practical
Apparent power
58.7
59
Average power
51.36
51
Reactive power
-28.43
-20
Power factor
0.875
0.87
Now, for a series combination of the previously selected resistor and induc-
tor, calculate the current I of the circuit if it has a voltage of 226∠0◦[Vrms].
Then obtain the total complex power of the load and ﬁll the next table:
Parameter
Number
Unit
Complex power (rectangular)
24.81 + j32.39
VA
Complex power (polar)
40.8∠52.55◦
VA
Apparent power
40.8
VA
Average power
24.81
W
Reactive power
32.39
VAr
Power factor
Connect the previously selected resistive load and inductive load in series,

1.4 AC power analysis
21
Diagram 1.2
RC load connection
Diagram 1.3
RL load connection
then feed them with 220 [Vrms] from the three-phase supply unit. Measure
all the power parameters of the load with the maximum demand meter and
compare your results (see Diagram 1.3).
Parameter
Number
Unit
Complex power (rectangular)
24.81 + j32.39
[VA]
Complex power (polar)
40.8∠52.55◦
[VA]
Apparent power
40.8
[VA]
Average power
24.81
[W]
Reactive power
32.39
[VAr]
Power factor
For the RL load that is already connected, calculate the value of the ca-
pacitor that has to be added in parallel to improve the power factor to 0.97.
C = 1.36 [µF].
Finally, connect the switchable capacitor battery module in parallel with
the RL load (see Diagram 1.4). Activate the ﬁrst switch from left to right;
this will add a 2 µF capacitor to the circuit. Observe the new power factor

22
1 Linear Electric Circuits
Diagram 1.4
RL load with power factor correction
in the maximum demand meter: is it improved? Activate diﬀerent capacitors
and combinations of them and observe their eﬀect in the power factor.
As seen in Subsection 1.4.6, a capacitor is used to improve the power factor
of an inductive load. In this exercise, when the 2 µF capacitor is added, an
increase of power factor can be noticed, reaching almost a unitary factor. If
the other available capacitors are also activated, the power factor will begin
to decrease because the load is now more capacitive.
1.5
Polyphase circuits
So far, every AC analysis made consisted of a generator connected through a
pair of wires to a load. A polyphase circuit or system instead refers to multiple
AC sources operating at the same frequency but in diﬀerent phases. The most
common polyphase systems are a balanced three-phase system followed by the
single-phase three-wire system (although it is called single-phase, actually it
is a balanced two-phase system).
Before beginning with the description of the polyphase systems, it is im-
portant to know the double-subscript notation. This notation describes the
path a current ﬂows or the voltage existent between two points, by two letters
in subscript notation. For example, the voltage of point a with respect to point
b is Vab while the current that ﬂows from point a to point b is Iab [80].

1.5 Polyphase circuits
23
a
n
b
Vp Φ
Vp Φ
FIGURE 1.17
Single-phase three-wire system
1.5.1
Single-phase three-wire systems
In North America a normal household system is a single-phase three-wire
system, permitting the operation of both 110 [V ] and 220 [V ] appliances at 60
[Hz]. This kind of system is deﬁned as a source with three output terminals
(a, n, and b) and two identical sources Vp∠φ where Vp is the RMS magnitude
of the source and φ is the phase, as shown in Figure 1.17.
As mentioned before, the voltages Van and Vnb must have the same ampli-
tude and phase, but if seen between the outer wires and the central wire they
are exactly 180◦out of phase. From this point of view it is strictly a balanced
two-phase system; however, the two-phase system refers to two voltage sources
in which one lags the other by 90◦.
1.5.2
Balanced three-phase voltages
Three-phase voltages are produced with an AC generator that consists of three
separate windings or coils placed 120◦apart around the stator. As the rotor
rotates, the magnetic ﬁeld induces voltages equal in magnitude in each coil
but out of phase by 120◦because of their placement around the stator [27]. In
Figure 1.18, a cross-sectional view from a generator is shown along with the
generated voltages.
A three-phase system is equivalent to three single-phase circuits because
each coil of the generator can be regarded as a single-phase generator. This
means that a typical three-phase system consists of three voltage sources that
can be either Y-connected or ∆-connected, as shown in Figure 1.19.
Let’s consider only balanced three-phase sources, which implies that
Van + Vbn + Vcn = 0,
(1.36)
|Van| = |Vbn| = |Vcn|,
(1.37)
where Van, Vbn, Vcn are respectively between lines a, b, and c, and the neu-

24
1 Linear Electric Circuits
a
b
c
n
N
S
a
b
c
a’
b’
c’
0
120°
240°
Van
Vbn
Vcn
wt
FIGURE 1.18
A three-phase generator with generated voltages
a
b
c
n
Van
Vbn
Vcn
a
b
c
Vca
Vab
Vbc
FIGURE 1.19
Y-connected and ∆-connected source voltages

1.5 Polyphase circuits
25
a
b
c
n
ZY
ZY
ZY
a
b
c
Z∆
Z∆
Z∆
FIGURE 1.20
Y-connected and ∆-connected loads
tral line n known as phase voltages. Since the three voltages are 120◦out of
phase and arbitrarily Van is chosen as the reference, there are two possible
combinations of sequence:
1. Van = Vp∠0◦, Vbn = Vp∠−120◦, Vcn = Vp∠−240◦;
2. Van = Vp∠0◦, Vbn = Vp∠120◦, Vcn = Vp∠240◦.
The ﬁrst one is called positive phase sequence and the second one is the
negative phase sequence. The phase sequence of a physical three-phase source
depends on the choice order of the tree terminals to be named a, b, and c in
which the voltages pass through their respective maximum values [27, p. 507].
Working with a physical generator, it is common to choose the terminals for
a positive phase sequence.
As the voltage sources, a three-phase load can be either Y-connected or
∆-connected. As shown in Figure 1.20, a neutral line in a Y-connected load
may or may not appear, depending on whether the system is three- or four-
wire. A load is balanced if the phase impedances are equal in magnitude and
phase.
For a balanced Y-connected load, the impedance per phase is written ZY :
Za = Zb = Zc = ZY ;
(1.38)
and similarly for a balanced ∆-connected load, the impedance per phase is
written Z∆:
ZA = ZB = ZC = Z∆.
(1.39)
In this way any balanced load can be transformed from Y-connected to
∆-connected and vice versa using the next equations:
ZY = 1
3Z∆, or Z∆= 3ZY .
(1.40)

26
1 Linear Electric Circuits
Van
Vbn
Vcn
a
a
c
b
A
B
C
n
N
ZY
ZY
ZY
IaA
InN
IbB
IcC
FIGURE 1.21
Balanced Y-Y circuit
Since the three-phase source and the three-phase load can be either Y-
connected or ∆-connected, four diﬀerent connections can be made [27, p. 508]:
1. Y-Y connection (Y-connected source and Y-connected load)
2. Y-∆connection (Y-connected source and ∆-connected load)
3. ∆-Y connection (∆-connected source and Y-connected load)
4. ∆-∆connection (∆-connected source and ∆-connected load).
1.5.3
Balanced Y-Y connection
This is the most important system because any balanced three-phase system
can be reduced to an equivalent Y-Y system. Consider a balanced four-wire
Y-Y system where the impedance ZY is the total load impedance per phase,
which includes the line impedance Zl and the load impedance ZL in series;
see Figure 1.21.
Assuming a positive sequence, the line voltages can be obtained with the
relation of phase voltages,
Vab = Van −Vbn = Vp∠0◦−Vp∠−120◦=
√
3Vp∠0◦.
Similarly, for the other line voltages,
Vbc =
p
(3) −90◦,
Vca =
√
3Vp∠−210◦.

1.5 Polyphase circuits
27
30°
Van
Vbn
Vcn
Vca
Vab
Vbc
120°
FIGURE 1.22
Phasor diagram for a Y-Y circuit
Thus, it can be observed that the magnitude of the line voltages VL is
√
3
the magnitude of Vp:
VL =
√
3Vp.
(1.41)
It can also be noted that the line voltages are 120◦out of phase between
each other and 30◦out of phase between their corresponding phase voltages.
This is shown in the phasor diagram of Figure 1.22.
Now let’s apply KVL to each phase to obtain the line currents IaA, IbB,
and IcC.
IaA = Van
Zy
,
IbB = Vbn
Zy
= IaA∠−120◦,
IcC = Vcn
Zy
= IaA∠−240◦.
Therefore,
InN = IaA + IbB + IcC = 0.
(1.42)
Thus, no current ﬂows through the neutral line if the source and the load
are both balanced. This means that as long as the system is balanced, no
matter the size of the impedance inserted in the neutral line, the neutral
current will remain zero.
In this kind of system, the magnitude of the line voltage is diﬀerent from
the phase voltage by a factor of
√
3 while the line current is the same as the
phase current.

28
1 Linear Electric Circuits
Z∆
Z∆
Z∆
Van
Vbn
Vcn
a
a
c
b
n
IaA
IbB
IcC
IAB
IBC
ICA
A
B
C
FIGURE 1.23
Balanced Y-∆circuit
1.5.4
Balanced Y-∆connection
This system consists of a balanced Y-connected source and a balanced ∆-
connected load. This conﬁguration is very common because of the ease of
physical connection of the load impedances, and does not possess a neutral
connection from source to load; see Figure 1.23.
Assuming a positive sequence, the phase voltages and line voltages are the
same as for a Y-Y connection,
Van = Vp∠0◦,
Vbn = Vp∠−120◦,
Vcn = Vp∠−240◦;
Vab =
√
3Vp∠30◦,
Vbc =
√
3Vp∠−90◦,
Vca =
p
(3)Vp∠−210◦.
It is noted by inspection that the line voltages are equal to the voltages
across the load impedances, making it possible to obtain the phase currents
as
IAB = Vab
Z∆
, IBC = Vbc
Z∆
, ICA = Vca
Z∆
.
(1.43)
Applying KCL at nodes A, B, and C, the line currents are obtained from
the phase current previously calculated,
IaA = IAB −ICA, IbB = IBC −IAB, IcC = ICA −IBC.
Since it is a balanced system, the three-phase currents have the same
amplitude, so it can be shown that
IL =
√
3Ip,
(1.44)
while the line current lags the corresponding phase currents by 30◦, as shown
in the phasor diagram of Figure 1.24.

1.5 Polyphase circuits
29
Van
Vbn
Vcn
VCA
VAB
VBC
IaA
IcC
IbB
IAB
ICA
IBC
FIGURE 1.24
Phasor diagram for a Y-∆circuit
1.5.5
Balanced ∆-∆connection
This system consists of a balanced ∆-connected source and a balanced ∆-
connected load, as shown in Figure 1.25.
Assuming a positive sequence, the phase voltages and line voltages are the
same as long as there are no line impedances due to losses in the lines,
Vab = VAB = Vp∠0◦, Vbc = VBC = Vp∠−120◦, Vca = VCA = Vp∠240◦.
Therefore, the phase currents can be obtained as for a ∆-Y connection
system,
IAB = Vab
Z∆
, IBC = Vbc
Z∆
, ICA = Vca
Z∆
.
(1.45)
Also, as for a ∆-Y connection system, each line current lags the corre-
sponding phase current by 30◦and is related by the factor
p
(3),
IL =
√
3Ip.
(1.46)
1.5.6
Balanced ∆-Y connection
The circuit ∆-Y consists of a balanced ∆-connected source feeding a balanced
Y-connected load. In Figure 1.26, it can be noticed that the line voltages are
the same as the phase voltages.

30
1 Linear Electric Circuits
Z∆
Z∆
Z∆
IAB
IBC
ICA
A
B
C
Vca
Vab
Vbc
IaA
IbB
IcC
a
c
b
FIGURE 1.25
Balanced ∆-∆circuit
A
B
C
N
ZY
ZY
ZY
Vca
Vab
Vbc
a
c
b
IaA
IbB
IcC
FIGURE 1.26
Balanced ∆-Y circuit

1.5 Polyphase circuits
31
Assuming a positive sequence
Vab = Vp∠0◦, Vbc = Vp∠−120◦, Vca = Vp∠−240◦,
one way to obtain the line currents is to apply KVL to the loop that involves
IaA and IbB:
ZY IaA −ZY IbB = Vab.
Thus,
IaA −IbB = Vp∠0◦
Zy
,
Since it is a balanced system in positive sequence, the line current IbB
must be the same as the current IaA but 120◦out of phase. Hence,
IaA −IbB = IaA
√
3∠30◦.
Substituting into the last equation, the line current is obtained:
IaA =
Vp
√
3∠−30◦
Zy
.
(1.47)
Therefore, the other two line currents may be found by lagging 120◦the
current IaA.
Another way to ﬁnd the line currents is to either replace the ∆-connected
source with an equivalent Y-connected source or to replace the Y-connected
load with a ∆-connected load. Both cases were covered in the previous sec-
tions.
1.5.7
Unbalanced three-phase systems
Previously, four types of three-phase systems were analyzed, but all of them
were balanced. It is said that a system is unbalanced if either one of two
conditions is not fulﬁlled:
1. The source voltages must be equal in magnitude and their diﬀerence in
phase must be symmetrical.
2. The load impedances must be the same for all phases.
Let us assume a balanced source voltage but an unbalanced Y-connected
load, as shown in Figure 1.27. Since the load is unbalanced, each impedance
is diﬀerent, so the system is solved by direct application of mesh and nodal
analysis.
The line currents are therefore determined by
IaA = VAN
ZA
, IbB = VBN
ZB
, IcC = VCN
ZC
.
(1.48)

32
1 Linear Electric Circuits
A
B
C
N
ZA
ZC
ZB
IaA
InN
IbB
IcC
VAN
VBN
VCN
FIGURE 1.27
Unbalanced Y-connected loads
For a balanced system, it was said that the current in the neutral line
must be zero, hence it could be removed. In this case each of the line currents
produces a current though the neutral line, and applying KCL at node N, the
neutral line current is obtained:
InN = −(IaA + IbB + IcC).
(1.49)
To ﬁnd the line currents for any of the other three-wire systems ∆-Y, Y-∆,
and ∆-∆, a mesh analysis has to be made, taking into account that phase and
line voltages and currents are no longer necessarily related by a
√
3 factor,
nor a diﬀerence in phase of 120◦.
1.5.8
Power in three-phase systems
As seen in previous sections, the complex power for an AC circuit is
S = VrmsI∗
rms.
To obtain the total complex power on a three-phase system, each load’s
power has to be analyzed independently per phase, whether for a Y-connected
load or for a ∆-connected load, to later add each of them to get the total power.
The simplest case to begin with is the balanced three-phase system. Let a
Y-connected load with IL = Ip and VL =
√
3Vp, or a ∆-connected load with
IL =
√
3Ip and VL = Vp; see Figure 1.28. Each of the loads has to have the
same power as the others, so the total complex power is easily calculated as
three times the power of any of the loads:
Stotal = 3Sp = 3VpI∗
p = 3I2
pZp = 3V 2
p
Z∗p
.
(1.50)

1.5 Polyphase circuits
33
Sp
Sp
Sp
A
B
C
N
Sp
Sp
Sp
A
B
C
OR
=
3Sp
A
C
B
FIGURE 1.28
Power calculation for a balanced three-phase system
S1
S2
S3
A
B
C
N
S1
S2
S3
A
B
C
OR
=
S1+S2+S3
A
C
B
FIGURE 1.29
Power calculation for an unbalanced three-phase system
In the case for an unbalanced system, the total complex power cannot be
obtained as three times the power of any of the loads because they are no
longer equal; rather, the total complex power is the sum of the three loads
(see Figure 1.29),
Stotal = S1 + S2 + S3.
(1.51)
It is important to notice that the relation of phase voltages to line voltages
and phase currents to line currents by the factor
√
3 is no longer valid, therefore
a mesh analysis is required to obtain the power of each phase.
An advantage of a three-phase system for power distributions is that uses
a lesser amount of wire than the single-phase system for the same line voltage
and the same absorbed power [27, p. 521].
1.5.9
Exercises
In some apartment buildings or condos, a three-phase motor is used to pump
water from the underground deposit to a water tank in the roof. This motor
can be connected in either a Y or ∆connection. In this exercise a comparison
between these two connections can be made by measuring the power absorbed
by the three-phase load circuit.
Recommended equipment and connections:

34
1 Linear Electric Circuits
• Three-phase supply unit
• Maximum demand meter
• Inductive load
• Resistive load
• Capacitive load
• LCR meter
With an LCR meter, measure one value of resistance and inductance from
the resistive load and inductive load modules, respectively, and ﬁnd their
impedance (assume a 60 Hz frequency operation).
R[Ω]
ZR[Ω]
L[H]
ZL
1
761.2
761.2
2.636
j993.75
Connect a balanced three-phase Y-Y circuit (see Figure 1.30) where each
source’s phase is taken from the three phase supply unit and each load is an
RL combination of the previous values chosen. Note that each phase has to
have the same loads (see Diagram 1.5).
Van
Vbn
Vcn
a
a
c
b
A
B
C
n
N
ZY
ZY
ZY
IaA
InN
IbB
IcC
FIGURE 1.30
Three-phase Y-Y circuit electric diagram
Calculate the current IaA of the circuit if it has a voltage Van = 226∠0◦
[Vrms]. Then obtain the power of the load ZY (S = V I∗):
SY = 24.81 + j32.39[V A].

1.5 Polyphase circuits
35
Diagram 1.5
Three-phase Y-Y circuit with RL load
This power corresponds to the absorbed power by the load of one of the
three phases. Since it is a balanced three-phase circuit, the total absorbed
power is obtained by multiplying the previous power by 3:
ST OT AL = 74.43 + j97.17[V A].
With the maximum demand meter, measure the real power absorbed for
each phase and the total power, and then compare your results.
SY
STOTAL
Power (S)
16+j27
50+j80
Finally, modify the values of the loads for the second and third phase, now
the circuit is unbalanced. With the maximum demand meter, measure the
power being absorbed for each phase and the total.
SY
SY2
SY3
STOTAL
Power (S)
16+j26
26+j31
12+j32
55+j89
Note that the total power absorbed now is obtained by the sum of each
phase power.
Connect a balanced three-phase Y-∆circuit (see Figure 1.31) where each
source’s phase is taken from the three-phase supply unit and each load is an
RL combination of the previous values chosen. Note that each phase has to
have the same loads (see Diagram 1.6).
With the ﬁrst maximum demand meter (the one on the left side in Dia-
gram 1.6), measure each of the line currents.
IaA
IbB
IcC
Current (I)
0.412
0.412
0.412

36
1 Linear Electric Circuits
Z∆
Z∆
Z∆
Van
Vbn
Vcn
a
a
c
b
n
IaA
IbB
IcC
IAB
IBC
ICA
A
B
C
FIGURE 1.31
Three-phase Y-∆circuit electric diagram
Diagram 1.6
Three-phase Y-∆circuit with RL load
Now, with the second module maximum demand meter (the one on the
right side of Diagram 1.6), measure each of the phase currents.
IAB
IBC
ICA
Current (I)
0.238
0.238
0.238
Note that in a balanced Y-∆system, the phase current is related to its
corresponding line current by a
√
3 factor.
Finally, modify the values of the loads for the second and third phase
for the circuit to be unbalanced. Again, with the maximum demand meters,
measure the phase and line currents.
Note that in an unbalanced Y-∆system, the phase currents are no longer
related to their corresponding line current by a
√
3 factor.

1.6 Harmonics
37
IaA
IbB
IcC
Current (I)
0.238
0.238
0.238
IAB
IBC
ICA
Current (I)
0.238
0.304
0.260
1.6
Harmonics
So far it has been assumed that the voltage supplied to the loads is a perfectly
sinusoidal signal, but this is not necessarily true in reality. Mainly because of
the increasing use of nonlinear loads, the voltage and current waveforms suﬀer
from distortions, often expressed as harmonic distortion [50, p. 1].
Harmonics in AC power systems are components of a periodic current or
voltage waveform which have frequencies that are integer multiples of the
fundamental frequency of the system. A harmonic waveform is a perfectly
sinusoidal signal that is added to another sinusoidal waveform, which results
in a distorted waveform, as shown in Figure 1.32.
Figure 1.32 (left) shows the main waveform and its 3th, 5th, and 7th
harmonics, which can be expressed as
v1 = Vm1 sin(ωt)
(1.52)
v3 = Vm3 sin(3ωt + δ3)
(1.53)
v5 = Vm5 sin(5ωt + δ5)
(1.54)
v7 = Vm7 sin(7ωt + δ7)
(1.55)
FIGURE 1.32
60 Hz signal and its 3th, 5th and 7th harmonics
Figure 1.32 (right) shows the resultant distorted waveform, which can be

38
1 Linear Electric Circuits
expressed as
vtotal = Vm1 sin (ωt) + Vm3 sin (3ωt + δ3) + Vm5 sin (5ωt + δ5)
+ Vm7 sin (7ωt + δ7).
(1.56)
The frequency of any harmonic can be easily found with the expression
fn = n(fundamental frequency),
(1.57)
where fn = is the n-th harmonic frequency, and n is an integer that represents
the number of the harmonic.
The Fourier series represents an eﬀective way to study and analyze har-
monic distortion because it describes periodic functions and their contribution
of sinusoidal functions of diﬀerent frequencies. In this way, it allows inspecting
the various constituents of a distorted waveform through decomposition [79,
p. 7].
Any periodic waveform can be expanded by a Fourier series as
f(t) = A0 +
∞
X
h=1
[Ah cos (hω0t) + Bh sin (hω0t)]
= A0 +
∞
X
h=1
Ch sin (hω0t + ψh),
(1.58)
where C1 sin (ω0t + ψ1) represents the fundamental component, Ch sin(hω0t+
ψh) represents the hth armonic, and the coeﬃcients are given by,
A0 = 1
T
ˆ T
0
f(t)dt,
(1.59)
Ah = 2
T
ˆ T
0
f(t) cos(hω0t)dt,
(1.60)
Bh = 2
T
ˆ T
0
f(t) sin(hω0t)dt,
(1.61)
Ch =
q
A2
h + B2
h,
(1.62)
psih = tan−1
Ah
Bh

.
(1.63)
The harmonic spectrum is a bar plot of the magnitudes of harmonics de-
scribed in the Fourier series. Let us take the waveform from Figure 1.32, and
by applying an FFT we ﬁnd the harmonic spectrum presented in Figure 1.33.
The total harmonic distortion (THD) is one of the power quality indices
that exist; another one was previously introduced as the power factor. The
THD is used to describe power quality issues in transmission and distribution
systems [60, p. 28]. It measures the harmonic distortion present in a signal

1.6 Harmonics
39
V
V/3
V/5
V/7
1
2
3
4
5
6
7
Harmonic order
FIGURE 1.33
Harmonic spectrum
and is deﬁned as the ratio between RMS values of signals, including harmonics
and signals considering only the fundamental frequency:
THDF = 1
F1
v
u
u
t
∞
X
h=2
F 2
h,
(1.64)
where F represents the function either voltage or current.
1.6.1
Power factor with nonlinear loads
As explained before, nonlinear loads distort the current waveform instead of
typically just shifting it (lagging or leading), so the method revised for power
factor correction is no longer always valid.
For nonlinear loads, the power triangle explained before becomes a three-
dimensional relation with Q and P producing the apparent power and H as
the distortion reactive power, as shown in Figure 1.34.
The true power factor (TPF) then becomes the combination of displace-
ment power factor (dPF), which is still equal to cos φ where φ is the angle
between the fundamental current and voltage, and distortion power factor
(hPF). Distortion PF is the true power factor divided by displacement PF.
This is shown in (1.65).
pf = P
S = [kW]
[kVA] ̸= cos φ
(1.65)
S =
p
P 2 + Q2 + H2
[kV A] =
q
[kW]2 + [kVAr]2 + [kVAr]2
H

40
1 Linear Electric Circuits
S=kVA
H=kVARH
Q=kVAR
P=kW
Φ
FIGURE 1.34
Power vector relation
Unlike displacement PF, distortion PF is neither leading nor lagging.
Therefore, to improve a poor power factor with nonlinear loads, the harmonics
have to be removed, so adding a capacitor is no longer the solution as they
can resonate with the power system inductance.
Having a poor power factor not only implies a waste of energy or a damage
to the electrical installation, but electrical utilities commonly charge a penalty
for low PF to their customers within the demand charge. Since there is not
a standard for charging this kind of penalty, each electrical utility has its
own rules. In Mexico, CFE, an electrical utility, penalizes companies with PF
lower than 90% with up to 120% of charges calculated, as shown in (1.66),
and rewards companies with PF higher than 90% with a discount calculated
as in (1.67).
Penalty = 3
5
 90
F.P. −1

x 100
(1.66)
Reward = 1
4

1 −90
F.P.

x 100
(1.67)
1.6.2
Exercises
In a “healthy” electric installation, the AC current has a sinusoidal waveform,
but due to nonlinear loads, this waveform can be distorted by some harmonics
introduced in the signal. In this exercise, a sinusoidal waveform is going to
be observed in an oscilloscope with and without harmonics to appreciate the
distortion in the signal.
Recommended equipment and connections:
• Lamps for photovoltaic trainer
• Photovoltaic inclinable module

1.7 Theoretical problems
41
• Inverter grid
• Electrical power digital measuring unit
• Maximum demand meter
• Three-phase supply unit
• Resistive load
• Oscilloscope with current clamp
Connect the lamps and head the light towards the photovoltaic panel (90◦);
the lamps act as the light source. The photovoltaic panel is then connected to
the inverter grid, and this module is then connected in series to the thermo-
magnetic diﬀerential switch to activate or deactivate the load. The electric
power digital meter is connected to the switch in order to measure the output
power coming from the inverter.
Finally, connect the three-phase supply unit, which will act as the “ideal”
power generator, to the maximum demand meter and then to the load (see
Diagram 1.7)
1. Set the resistive load to the 2nd value
2. Set the lamps to 100% of light intensity
3. Put the solar panel in front of the light at 90◦degrees
4. Deactivate the switch of the circuit breaker so the load only receives energy
from the generator. With the oscilloscope, observe the waveform of the
current delivered to the load (see Figure 1.35). Is the waveform almost a
perfect sine? Does it have any distortion? Why?
5. Activate the switch of the circuit breaker so the load now also receives
energy from the solar panel. With the oscilloscope, observe the waveform
of the current delivered to the load (see Figure 1.36). What diﬀerence can
be noticed from the previous waveform? Does this new waveform have
harmonics?
1.7
Theoretical problems
Problem 1.1. Find the current Ix of the circuit of Figure 1.37 (assume all
values in RMS).

42
1 Linear Electric Circuits
Diagram 1.7
Connection for harmonic distortion exercise

1.7 Theoretical problems
43
FIGURE 1.35
Current waveform in the oscilloscope
FIGURE 1.36
Current waveform with harmonics
FIGURE 1.37
Theoretical problem circuit

44
1 Linear Electric Circuits
FIGURE 1.38
Theoretical problem reduced circuit
Solution 1.1. Let’s begin reducing the circuit to one equivalent impedance
with a voltage source (see Figure 1.38). First note that the impedances of
4 [Ω] and –j6 [Ω] are in parallel with the impedances of 3 [Ω] and j4 [Ω]:
Z1 =
(4 −j6)(3 + j4)
(4 −j6) + (3 + j4) = 4.83 + j1.094Ω.
So, the equivalent impedance is zeq = 6.83 + j1.094. To obtain the current
Ix that corresponds to the source current, the source voltage is divided by the
equivalent impedance according to Ohm’s law:
Ix =
(120∠10◦)
(6.83 + j1.094) = 17.34∠0.897◦[A].
Problem 1.2. From the circuit of Problem 1.1, obtain the apparent, average,
and reactive power supplied to the impedances and the power factor of the
source.
Solution 1.2. The power supplied refers to the power delivered by the source.
To obtain the average power, Equation (1.26) is used:
P = VRMSIRMS cos(θv −φi) = (120)(17.34) cos(10 −0.8987)
P = 2054.9 [W].
But the easiest way to obtain the three parameters at the same time is by
getting the complex power. According to Equation (1.33):
S = VRMSI∗
RMS = (120∠10◦)(17.34∠−0.897◦) = 2080.8∠9.103◦[V A],
where apparent power is |S| = 2080.8 [V A], and average power is ReS =
2054.59 [W], and reactive power is ImS = 329.20 [V Ar].
Now, the power factor can be easily obtained by the cosine of the angle of
the complex power or by Equation (1.31):
PF =
P
VRMSIRMS
= cos(θv −φi) = 0.9874.

1.7 Theoretical problems
45
Problem 1.3. An AC motor can be seen as a load of ZL = 4.2 + j3.6 [Ω]
and it is fed with 220 [VRMS] 60 [Hz]. Find its PF and the capacitor needed
to achieve a PF = 1.
Solution 1.3. To calculate the capacitor needed for the power factor correc-
tion, Equation (1.35) is used:
C = P(tan(θ1 −θ2))
ωV 2
RMS
.
Note that the average power and the power factors of the source are re-
quired. First, let’s obtain the complex power:
S = 220

220
4.2 + j3.6
∗
= 6643.13 + j5694.12 = 8749.52∠40.6◦.
Hence, the power factor is PF = cos(40.6) = 0.7593.
The required capacitor connected in parallel to increase the power factor to
1 is:
C = 6643.13(tan(40.6◦−tan(0◦)))
377(2202)
= 312µ[F].
Problem 1.4. A 4 wire three-phase Y-Y unbalanced system with negative
sequence has the following characteristics: Van = 220∠0◦[V ], Z1 = 10+j8 [Ω],
Z2 = 8 + j6 [Ω], Z3 = 5 −j5 [Ω]. Obtain the three-phase current and the total
average power absorbed by the loads.
Solution 1.4. Since the sequence of the voltages is negative:
Van = 220∠0◦,
Vbn = 220∠120◦,
Vcn = 220∠240◦.
Despite the system being unbalanced, it is easy to obtain the current of each
phase because of the fourth wire (the neutral one). The system can be analyzed
with three independent loops, each one having one of the source voltages and
its corresponding phase load:
IaA = 220∠0◦
10 + 8j
IaA = 17.18∠−38.66◦[A];
IbB = 220∠120◦
8 + 6j
IbB = 22∠83.13◦[A];
IcC = 220∠240◦
5 + 5j
IcC = 31.11∠−75◦[A].

46
1 Linear Electric Circuits
To obtain the total average power, let’s get the complex power for all three
phases and then add just the real part of them:
S1 = VanI∗
aA
S1 = 2951.36 + j2361.10 [V A];
S2 = VbnI∗
bB
S2 = 3872 + j2904 [V A];
S3 = VcnI∗
cC
S3 = 4839.58 −j4839.58 [V A].
The total average power is
PT = 11, 662.94 [W].
1.8
Homework problems
Problem 1.5. Consider a given system to consume i(t) = 2 cos(377t + 0.75)
fed with v(t) = 380 cos(377t). Based on the average power equation, derive the
active, reactive, and apparent power consumed by the system. Compare the ﬁrst
term of the instantaneous power equation and its graphical representation with
the average power equation and the active power.
Solution 1.5. The oﬀset term of the instantaneous power equation must co-
incide with the average power equation, as they both resemble the same char-
acteristic of the resulting power function. If such an oﬀset term is computed,
it leads to
1
2VmIm cos(θv −θi) = 1
2(380)(2) cos(−0.75) = 278.04 [W].
This also matches the active power calculation:
Vrms = 380
√
2 [V ] and Irms =
2
p
(2)
[A], so S = VrmsIrms = 380 [V A],
PF = cos(θv −θi) = cos(−0.75) = cos(0.75),
P = S(PF) = 380 cos(0.75) = 278.04 [W].
On the other hand, the instantaneous power equation leads to
p(t)
=
1
2VmIm cos(θv −θi) + 1
2VmIm cos(2ωt + θv + θi)
=
278.04 + 380 cos(754t + 0.75).

1.8 Homework problems
47
Its average leads to
1
T
ˆ T
0
278.04 + 380 cos(754t + 0.75)dt.
The ﬁrst part of the function is known, so only the second part needs to be
computed. It can be written as
380377
2π
ˆ
2π
377
0
cos(754t + 0.75)dt,
having
ˆ
cos(ωt + φ) = 1
ω (cos(ωt) sin(φ) + cos(φ) sin(ωt)) , then,
ˆ
cos(ωt + φ)|t=0 = sin(φ)
ω
and
ˆ
cos(ωt + φ)|t=T = sin(φ)
ω
,
and implying
380377
2π
ˆ
2π
377
0
cos(754t + 0.75)dt = 0, so,
1
T
ˆ T
0
p(t)dt = 1
2VmIm cos(θv −θi) = 278.04 [W].
Up to this point, we have already calculated the apparent power and active
power. The reactive power can then be obtained by any known method:
Q = S sin(0.75) = 259 [V Ar], or
Q =
p
S2 −P 2 = 259 [V Ar].
Problem 1.6. Consider an inductive load connected to a variable frequency
voltage source. If the inductance magnitude is L and it is fed by Vm sin(ωt),
ﬁnd the equation that describes ||i(ω)||.
Solution 1.6. The inductance can be described by
V
i = ZL = jωL.
So, easily, the current can be derived from the above equation as
V (ω)
jωL = i(ω),
and accordingly,

V (ω)
vωL
 = ∥i(ω)∥.

48
1 Linear Electric Circuits
FIGURE 1.39
Current plot
Simplifying:
irms(ω) = Vrms
ωL ,
which can be plotted as shown in Figure 1.39.
As ω →0, the inductance behaves as a short-circuit (its DC behavior).
Problem 1.7. Consider a capacitive load connected to a variable frequency
voltage source. If the capacitance magnitude is C and it is fed by Vm sin(ωt),
ﬁnd the equation that describes ∥i(ω)∥.
Solution 1.7. The capacitance can be described by
V
i = ZC =
1
jωC .
So, easily, the current can be derived from the above equation as
V (ω)jωC = i(ω),
and, accordingly,
∥V (ω)jωC∥= ∥i(ω)∥.
Simplifying:
irms(ω) = VrmsωC,
which can be plotted as shown in Figure 1.40. As ω →0, the capacitance
behaves as an open-circuit (its DC behavior).
Problem 1.8. Power factor correction implies a current balancing between
the inductive part of the load and the added capacitor. If a load of ZL =
4.2 + j3.6 [Ω] is fed with 220 [Vrms] at 60 [Hz], ﬁnd the required capacitor to
obtain a PF= 1 without using Equation (1.22). Hint: see Figure 1.9.
Solution 1.8. We ﬁrst need to ﬁnd the current due to the inductive part of
the load:
220 [Vrms]
4.2 + j3.6[Ω] = 30.20 −j25.88 [Arms].

1.8 Homework problems
49
FIGURE 1.40
Current plot
A parallel capacitor is needed to compensate such current, so:
∥iC∥= VrmsωC,
leading to 25.88/220(377) = 312[µF].
It can also be solved as follows. Adding a parallel capacitor implies that the
resulting impedance will be of:
Z =
(4.2 + j3.6)
1
jωC
(4.2 + j3.6) +
1
jωC
=
(4.2 + j3.6)
1 −1.36C + j1.58C =
5.53∠40.6◦
√
1 −2.72C + 4.35C2∠arctan

1.58C
1−1.36C
.
A PF = 1 implies the current’s phase angle is zero, so the angle of the
impedance must be zero to achieve it. The magnitude can be disregarded, so:
∠40.6◦
arctan

1.58C
1−1.36C
 = 0◦,
implies that (in radians):
0.709 = arctan

1.58C
1 −1.36C

.
Having
0.858 × 10−3 =
1.58C
1 −1.36C
results in:
C = 0.858 × 10−3
2.75
= 312 [µF].
It can also be graphically solved as follows (see above homework problems
1.6 and 1.7):

50
1 Linear Electric Circuits
200
250
300
350
377
400
450
500
Frequency [rad/s]
20
25.88
30
40
50
Current [A]
Inductance behavior
FIGURE 1.41
Inductance behavior
The inductance is of 9.55 mH, so around 377 [rad/s] its behavior is iL(ω)
(notice that the resistive part has been subtracted from the voltage as VR =
iRR, and iR is in phase with Vin):
∥ıL(ω)∥=

VL
jωL
 =

220 −(30.2 × .2)
377 × 9.55 × 10−3)
 ,
as shown in Figure 1.41.
A matching parallel capacitor’s current must then intersect inductor’s cur-
rent line at 377rad/s.
∥iC(ω)∥= ∥VCjωC∥= 220ωC.
Sweeping capacitance values, C = 312 µF can be found (see Figure 1.42).
200
250
300
350
377
400
450
500
Frequency [rad/s]
20
25.88
30
40
50
Current [A]
Inductor's current
C=312 µF
C=250 µF
C=370 µF
FIGURE 1.42
Sweeping capacitance values
Problem 1.9. There are many buildings that take power from a three-phase

1.8 Homework problems
51
installation and later perform a single-phase distribution throughout the diﬀer-
ent loads. To preserve balanced operating conditions, each set of single-phase
loads must be balanced regarding the other phases; not doing so results in volt-
age variations and cables overheating. Suppose that, for the sake of simplicity,
some building installation is distributed as follows:
Phase 1: Illumination (30 [kV A])
Phase 2: Computers (10 [kV A])
Phase 3: Heavy electrical equipment (140 [kV A])
Find the voltage at each phase, considering the input electrical connection
to be taken from a standard Y-225 kV A transformer, assuming 208 VLL, a
series resistor of 1.6 [mΩ], and resistive load conditions.
Solution 1.9. First, the electric input is to be represented as a simpliﬁed volt-
age source, which can eﬀectively account for the previously made assumptions
(see Figure 1.43). On the other hand, each load is assumed to only exhibit
resistive behavior, so they can be “transformed” to:
Illumination: 480 [mΩ]
Computers: 1.44 [Ω]
Heavy electrical equipment: 102.9 [mΩ].
Each circuit can be solved separately, deriving: ia = 246.71∠0◦[A], ib =
82.96∠120◦[A], and ic = 1097.90∠240◦[A]. Thus, the neutral current is of
in = 943.78∠−111.36◦[A].
This unbalancing condition has several implications that must be addressed:
• The load at phase A will “see” a voltage of 480 [mΩ] × ia = 118.42 [V ]
• The load at phase B will “see” a voltage of 1.44[Ω]×ib = 119.46∠120◦[V ]
• The load at phase C will “see” a voltage of 102.9[mΩ] × ic
=
112.97∠240◦[V ]
• There will be an unwanted voltage at the load neutral point of 4.8 [mΩ] ×
in = 4.53∠−111.36◦[V ], accountable for the above unbalancing.
The power at the neutral line is of 4.28 kW, which is absolutely transformed
into heat.

52
1 Linear Electric Circuits
+
-
+
-
+
-
FIGURE 1.43
Electric circuit
1.9
Simulation
It is possible to analyze the eﬀects of balanced or unbalanced loads in terms of
voltage and current (see Figure 1.44). Besides the fact that unbalanced loads
and harmonic eﬀects will be a detriment to a grid’s performance, it is diﬃcult
to ﬁnd voltage variations due to the source’s stiﬀness. However, current is
directly aﬀected, so it is more eﬀective to measure current disturbances if
some faulty source or load is being evaluated.
Furthermore, an unbalanced load will account for a diﬀerentiated power
factor per phase. As the power factor is commonly measured as an average
value, it will not represent the grid’s reality for unbalanced networks. It is
important to acknowledge the possible variations regarding unbalanced loads
and harmonic distortion, and link their eﬀects to common electric measure-
ments.

1.9 Simulation
53
FIGURE 1.44
Load unbalancing simulation


2
Power Flow and Electric Machinery Basics
As a ﬁrst step into the electric grid, the fundamental topics about power
generation, transmission, distribution, and consumption must be established.
Each phase must then be ﬁrst described and appropriately placed among
the others so the power ﬂow is thoroughly understood. This chapter aims to
introduce the electric grid by presenting how the power ﬂow occurs and by
oﬀering the modeling basics around its major electromagnetic components.
An electric machine is a device that can convert either mechanical energy
to electrical energy or electrical energy to mechanical energy. When such a
device is used to convert mechanical energy to electrical energy, it is called
a generator. When it converts electrical energy to mechanical energy, it is
called a motor. Since any given electric machine can convert power in either
direction, any machine can be used as either a generator or a motor. Almost
all practical motors and generators convert energy through the interaction of
a magnetic ﬁeld, and only machines using magnetic ﬁelds to perform such
conversions are considered in this book.
Many concepts must be established before performing any analysis of elec-
tric machines. The principle of electromechanical energy conversion is the
most important law of machine analysis. This theory allows us to establish
an expression of electromagnetic torque in terms of machine variables, like
the currents and the displacement of the mechanical system. In this chapter,
basic principles that will be mentioned are the equivalent circuit representa-
tions of magnetically coupled circuits, the concept of a sinusoidally distributed
winding, and the winding inductances, among others.
2.1
A glance into power ﬂow
2.1.1
Generators
The generators produce the electrical energy distributed by a power system.
Almost all of the generators in use today produce electrical energy by convert-
ing mechanical energy to electrical energy through the action of a magnetic
ﬁeld. The mechanical energy comes from a prime mover, which is the device
that spins the generator. Prime movers are usually some form of steam or
55

56
2 Power ﬂow basics
water turbines, but diesel engines are sometimes used in remote locations.
Modern generators generate electrical power at voltages of 13.8 −24 [kV ].
To construct an electric generator, the principle of “electromagnetic in-
duction” is used, as one of the fundamental elements of matter is precisely
the electromagnetic charge composed of a magnetic ﬁeld and an associated
particle-motion electric ﬁeld. A bosons generator uses a magnetic ﬁeld to en-
ergize electrons kinetically and cause an interaction with other electrons, which
results in the generation of electric current and a voltage. Manipulating an
electromagnetic force may induce the displacement or movement of electrons,
and as a result, an electric current will ﬂow.
As the rotor rotates at high speeds thanks to external mechanical energy
from the turbine, current ﬂows occur in the stator copper wires (1 [A] is equal
to 6.25 × 1018 electrons moving through a wire per second). All power plants
have turbines and generators. Some turbines are powered by wind, water, and
steam from the earth or from the combustion of biomass, fossil fuels, and
other forms of energy. The electricity produced by a generator is transmitted
through the transmission lines, taking the power from plants to homes, schools,
and industry. Large-scale power generation requires huge power plants, com-
posed of many turbines.
A speciﬁc view of modern generation technologies is portrayed in some
chapters throughout this book: Hydroelectric generation is covered in Chap-
ter 3, Chapter 4 introduces wind power, and Chapter 5 deals with photo-
voltaic solar power generation. On the other hand, the basic tools to perform
electric analyses of transformers and electric machinery are provided in the
remainder of this chapter.
2.1.2
Transformers
Transformers convert AC electrical energy at one voltage magnitude into AC
electrical energy at another voltage magnitude. They are essential for the
operation of a modern power system, since transformers allow power to be
transmitted with minimal losses over long distances. Transformers are the
“connection” that holds the entire system together by increasing line voltages
and reducing currents for transmission over long distances, and then reducing
the voltages to the levels required by the end-users. They make modern power
systems possible, and furthermore, they do it with very high eﬃciency.
The invention of the transformer and the current development of AC power
sources forever eliminated range and power-level restrictions of power systems.
A transformer ideally changes one AC voltage level to another without aﬀect-
ing the actual power supplied. If the transformer steps up the voltage level
of a circuit, it decreases the current due to energy conservation. Therefore,
AC electric power can be generated at one central location and stepped up
for transmission over long distances (exhibiting very low losses), to ﬁnally be
stepped down for its ﬁnal use. Since the transmission losses in the lines of a
power system are proportional to the square of the current in the lines, raising

2.1 A glance into power ﬂow
57
the transmission voltage and reducing the resulting transmission currents by
a factor of 10 reduces power transmission losses by a factor of 100. Without
the transformer, it would not be possible to use electric power in many of the
ways it is used today.
In modern power systems, transformers are literally found everywhere.
Electric power is generated at voltages of 12 −25 [kV ]. Transformers at the
output of the generators step up the voltage to 110 −1000 [kV ] for transmis-
sion. Substation transformers then step down the voltage to the 13−34.5 [kV ]
range, and distribution transformers ﬁnally permit the power to be used safely
in homes, oﬃces, and factories at voltages as low as 120 [V ].
2.1.3
Power lines
Power lines connect generators to loads, transmitting electrical power from
one to the other with minimal losses. Power lines are usually divided into two
categories: transmission lines and distribution lines. Transmission lines are
designed to transmit electrical power eﬃciently over long distances. They run
at very high voltages to reduce the resistive (I2R) losses in the lines. Once
the power reaches the vicinity of the user, its voltage is stepped down, and
the power is supplied through distribution lines to the ﬁnal customers. Dis-
tribution lines carry much less power than transmission lines, and for shorter
distances, so they can operate at lower power voltages without prohibitive
losses.
Generator and load are connected together through transmission lines,
which transport electric power from the place where it is generated to the place
where it is used. Eﬃcient transmission lines are very important to modern
power systems, because power generation is usually done at large electric
generating stations located a long way from the cities and industries where
the power is consumed. Most electric power consumers use small amounts of
power, and they are scattered over wide areas. Transmission lines must take
the bulk power from the generators, transmit it to the locality where it will
be used, and then distribute it to the individual homes and factories.
As a rule of thumb, the power-handling capability of a transmission line
is proportional to the square of the voltage on the line. Therefore, very high
voltage transmission lines are used to transmit electric power over long dis-
tances to the areas where it will be used. Once the power reaches the area
where it will be used, its voltage is stepped down into distribution substations,
and then delivered to the individual customers on lower-voltage transmission
lines called distribution lines.
There are two types of power transmission lines: overhead lines and buried
cables. An overhead transmission line usually consists of three conductors
or bundles of conductors containing the three phases of the power system.
The conductors are usually aluminum cable steel reinforced (ACSR), with
a steel core and aluminum conductors wrapped around the core. The steel
core provides strength, while the aluminum conductors have a low resistance

58
2 Power ﬂow basics
to minimize the losses in the transmission line. In an overhead transmission
line, the conductors are suspended from a pole or tower via insulators. In
addition to the phase conductors, a transmission line usually includes one or
two steel wires known as ground or shield wires. These wires are electrically
connected to the tower and the ground, and are thus at ground potential. In
large transmission lines, these wires are located above the phase conductors,
shielding them from lightning strikes, etc.
Cable lines are designed to be placed underground or under the water.
In cables, the conductors are insulated from one another and surrounded by
a protective sheath. Cable lines tend to be more expensive than overhead
transmission lines, and they are harder to maintain and repair. Furthermore,
cable lines have capacitance problems that prevent them from being used over
very long distances. Nevertheless, they are increasingly popular in new urban
areas where overhead transmission lines are considered an eyesore.
Transmission lines are characterized by a series resistance and inductance
per unit length, and by a shunt capacitance per unit length. These values
control the power-carrying capacity of each transmission line, and the voltage
drop in the transmission line at full load. The inductance and capacitance
calculations for three-phase transmission lines with varying geometries and
conductor bundle sizes will be covered in Chapter 6.
2.1.4
Protective devices
There is a wide variety of devices designed to protect the system, including
current, voltage, power sensors, relays, fuses, and circuit breakers. There are
two common types of failures in a power system: overloads and faults. Over-
loads are conditions in which some or all components in the power system are
supplying more power than they can safely handle. Overloads can happen be-
cause the total demand on the power system simply exceeds the ability of the
system to supply power. However, it is more common for overloads to occur in
localized parts of the power system because of changes elsewhere within the
system.
For example, two parallel transmission lines may be sharing the task of
providing power to a city. If one of them is disconnected for some reason, the
remaining line will supply the total power needed by the city. This may cause
the line to be overloaded. If an overload occurs on a power system, it should be
corrected, but power systems are robust enough for operators to have several
minutes to correct the problem before severe damage occurs.
Faults are conditions in which one or more of the phases in a power system
are shorted to ground or to each other. Faults also occur if a phase is open
circuited. When a short circuit occurs, very large currents ﬂow and these cur-
rents can damage the power system unless they are stopped quickly. Unlike
overloads, faults must be cleared immediately, so relays are designed to auto-
matically open circuit breakers and isolate faults as soon as they are detected.

2.2 Modeling basics
59
Chapter 7 is devoted to providing a deeper view regarding fault conditions
and protection systems.
2.1.5
Sensing transformers
A potential transformer (PT) is an especially sound transformer with a high-
voltage primary and a low-voltage secondary. It has a very low power rating,
and its sole purpose is to provide a sample of the power system’s voltage to the
instruments monitoring it. Since the principal purpose of the transformer is
voltage sampling, it must be very accurate so as not to distort the true voltage
values. Potential transformers of several accuracy classes may be purchased,
depending on how accurate the readings must be for a given application.
On the other hand, current transformers (CT) measure the current in a line
and reduce it to a safe and measurable level. The current transformer consists
of a secondary winding wrapped around a ferromagnetic ring, with the single
primary line running through the center of the ring. The ferromagnetic ring
holds and concentrates a small sample of the ﬂux from the primary line. That
ﬂux then induces a voltage and current in the secondary winding.
A current transformer diﬀers from the other transformers described in this
chapter as its windings are loosely coupled. Unlike all the other transformers,
the mutual ﬂux ΦM is smaller than the leakage ﬂux ΦL. Because of the
loose coupling, the voltage and current ratios do not hold. Nevertheless, the
secondary current in a current transformer is directly proportional to the
much larger primary current, and the device can provide an accurate sample
of a line’s current for measurement purposes. Current transformer ratings are
given as ratios of primary to secondary current. A typical current transformer
ratio might be 600 : 5, 800 : 5 or 1000 : 5. A 5 [A] rating is standard on the
secondary of a current transformer.
It is important to keep a current transformer short-circuited at all times,
since extremely high voltages can appear across its open secondary terminals.
In fact, most relays and other devices using the current from a current trans-
former have a shorting interlock, which must be shut before the relay can be
removed for inspection or adjustment. Without this interlock, very dangerous
high voltages will appear at the secondary terminals as the relay is removed
from its socket.
2.2
Modeling basics
2.2.1
Mechanical perspective
Almost all electric machines rotate about an axis, called the shaft of the ma-
chine. In general, a three-dimensional vector is required to completely describe

60
2 Power ﬂow basics
the rotation of an object in space. However, machines normally turn on a ﬁxed
shaft, so their rotation is restricted to one angular dimension. Relative to a
given end of the machine’s shaft, the direction of rotation can be described as
either clockwise (CW) or counterclockwise (CCW). A CCW angle rotation is
assumed to be positive and a CW is assumed to be negative.
The angular position θ of an object is the angle at which it is oriented
if measured from some arbitrary reference point. Angular position is usually
measured in [rad] or [◦]. It corresponds to the linear concept of distance along
a line.
Similarly, angular velocity is the rate of change in angular position with
respect to time. It is assumed positive if the rotation is in a CCW direction.
Angular velocity is the rotational analog of the concept of velocity on a line.
So, it is deﬁned as the rate of change of the angular displacement with respect
to time:
ω = dθ
dt .
(2.1)
Angular acceleration is the rate of change in angular velocity with respect
to time. It is assumed positive if the angular velocity is increasing in an al-
gebraic sense. Angular acceleration is the rotational analog of the concept of
acceleration on a line. It is deﬁned as
α = dω
dt .
(2.2)
In linear mechanics, a force applied to an object causes its velocity to
change. In the absence of a net force on the object, its velocity is constant. The
greater the force applied to the object, the more rapidly its velocity changes.
There exists a similar concept for rotation. When an object is rotating, its
angular velocity is constant unless a torque is present on it. The greater the
torque on the object, the faster the angular velocity of the object changes.
The torque depends on the magnitude of the applied force and the distance
between the axis of rotation and the line of action of the force.
For objects moving along a straight line, the following equation describes
the relationship between the force applied toward its resulting acceleration:
F = ma,
(2.3)
where F is the net force applied to an object, m represents the mass of the
object, and a is the acceleration. A similar equation describes the relationship
between the torque applied to an object and its resulting angular acceleration.
This relationship is given by
τ = Jα,
(2.4)
where τ is the net applied torque, α is the resulting angular acceleration, and
the term J serves the same purpose as an object’s mass in linear motion, and
is called the moment of inertia of the object.

2.2 Modeling basics
61
For linear motion, work W is deﬁned as the application of a force through
a distance:
W =
ˆ
Fdr.
(2.5)
It is assumed that the force is collinear with the direction of motion. For
the special case of a constant force applied collinearly with the direction of
motion, this equation becomes
W = Fdr.
(2.6)
For rotational motion, work is the application of a torque through an angle:
W =
ˆ
τdθ,
(2.7)
and if the torque is constant, we will get
W = τdθ.
(2.8)
Power is the change of work in time,
P = dW
dt ,
(2.9)
and it is usually measured in joules per second (Watts [J/s] = [W]), but also
it can be measured in foot-pounds per second or in horsepower [hP]. By this
deﬁnition and assuming that force is constant and collinear with the direction
of motion, power is given by
P = dW
dt = d
dt (Fr) = F
dr
dt

= Fv.
(2.10)
Similarly, assuming constant torque, power in rotational motion is given
by
P = dW
dt = d
dt (τθ) = τ
dθ
dt

= τω.
(2.11)
Equation (2.11) is very important in the study of electric machinery be-
cause it can describe the mechanical power on the shaft of a motor or genera-
tor. This equation is the correct relationship among power, torque, and speed
if power is measured in [W], torque in [Nm], and speed in [rad/s].
2.2.2
Magnetics perspective
Electric machines are made of either magnetic materials or materials that have
magnetic properties, so it is important to review the main magnetic princi-
ples, which are used in electric machines. The energy density of the magnetic
core aﬀects the size of the electric machine. Thus, ferromagnetic materials are

62
2 Power ﬂow basics
used in electric machines because higher permeability gives a higher energy
density. Usually the materials can be divided into ferromagnetic and nonmag-
netic according to the magnetization curve, which is the relationship between
the magnetic ﬁeld intensity H (A/m) and the magnetic ﬂux density B. This
relationship is described by a curve that is well-known as the magnetization
B-H curve. If this curve is a linear representation, the curve represents a
nonmagnetic material. If this curve is a nonlinear description, it represents a
ferromagnetic material [24].
Magnetic ﬁelds are the fundamental mechanism by which energy is con-
verted from one form to another in motors, generators, and transformers. Four
basic principles describe how magnetic ﬁelds are used in these devices:
• A current carrying wire produces a magnetic ﬁeld in the area around it
• A time changing magnetic ﬁeld induces a voltage in a coil of wire if it
passes through that coil, which is the basis of transformer action
• A current carrying wire in the presence of a magnetic ﬁeld has a force
induced on it, which is the basis of motor action
• A moving wire in the presence of a magnetic ﬁeld has a voltage induced
in it, which is the basis of the generator action
One of the most important mathematical expressions that describe the
magnetic ﬁeld is the Gauss’s law for magnetic ﬁelds. This expression describes
the magnetic ﬂux in a closed surface. It is important to remember that a
magnetic ﬁeld cannot be isolated in the south or north pole (monopoles);
always, they are together in pairs. Thus, the integral form of Gauss can be
deﬁned as (2.12) and the result is zero (the dot product indicates how to
determine the magnetic ﬁeld parallel to ˆn that is perpendicular to the surface).
˛
S
−→
B· ˆn da = 0,
(2.12)
where ˆB is the magnetic ﬁeld in Teslas [T], ˆn is the unit vector normal to the
surface, and da is a change in the area in [m2].
There are three cases for calculating the magnetic ﬁeld. The ﬁrst one is
when the magnetic ﬁeld vector is uniform and perpendicular to S. Thus, the
magnetic ﬂux is calculated by (2.13).
φB = −→
B × A,
(2.13)
where A is the area of the surface.
The second case is the magnetic ﬁeld, uniform and at an angle to S ().
φB = −→
B· ˆn × A.
(2.14)

2.2 Modeling basics
63
I
B
Current - carrying
straight wire
(a) Current in a
wire
N
S
B
Bar magnet
(b) Magnetic bar
N
N
N
N
magnetic field lines
(c) Interaction between
magnetic bars
FIGURE 2.1
Magnetic ﬁelds
The third case is the magnetic ﬁeld that is non-uniform and at a variable
angle to S:
˛
S
−→
B· ˆn da = 0
(2.15)
The basic considerations for sketching magnetic ﬁelds are [61]:
• They form close loops because they do not begin and end on speciﬁc
charges
• The magnetic ﬁeld lines begin on the north pole and terminate on the
south pole, and they are continuous loops
• The magnetic ﬁeld can be deﬁned as a vector so it can be added when two
or more sources overlap at the same point. Thus, a total magnetic ﬁeld at
this point is generated.
Examples of magnetic ﬁelds are presented in Figure 2.1. It shows that
the magnitude of the current is proportional to the magnitude of B but the
magnitude of B is inversely proportional to the distance from the conductor.
In addition, Faraday’s law deals with magnetic ﬂux when it is changing.
Furthermore, this equation oﬀers a link between the change of magnetic ﬁeld
and the induced EMF. This law is expressed in (2.16). It is important to
observe that the change of magnetic ﬁeld can be generated under the following
assumptions [61]:
• The strength of the magnetic ﬁeld decreases or increases
• The angle between −→
B and the surface normal changes
• The area of the surface S changes
Also, a combination of those assumptions can pop up. As a result, the
right hand principle of Faraday’s law will not be zero.

64
2 Power ﬂow basics
0
-1
1
I
I
Magnet moves up
toward coil
(a) Magnet moving
up toward coil
0
-1
1
I
I
Magnet moves up
toward coil
(b) Magnet moves
down
N
S
I
(c) Field interaction
FIGURE 2.2
Lenz law deﬁnes the direction of the current
˛
C
−→
E · −→
dl = −d
dt
ˆ
S
−→
B· ˆn da,
(2.16)
where the electric ﬁeld is expressed by −→
E that is a vector, and the increment
segment of the path C is −→
dl.
The sign of the right-hand side of Faraday’s law is deﬁned by the Lenz
law according to Figure 2.2. The EMF is produced when the magnetic ﬂux is
changing, so a current is generated. This current generates a magnetic ﬁeld
opposing the ﬂux change that produced it. The Lenz law can be deﬁned using
the energy conservation principle because the direction of the current opposes
the change. When the change appears, the current appears to limit it. Thus,
the current avoids an increment of the change that induces a bigger current
that increases the change.
An electrical charge in motion experiences a force when an electromagnetic
ﬁeld is an area of inﬂuence of this electromagnetic ﬁeld. The Lorentz equation
is deﬁned by (2.17) in which the force direction and magnitude are described
by the cross-product [61].
F = qu × B,
(2.17)
where F is the force [N], Q is the value of the electric charge [C], u is the
velocity of the charge [m/s], and B is the magnetic ﬂux density [T].
If it is supposed that a current of magnitude I ﬂows in a conductor of
length l within a uniform magnetic ﬁeld, it is possible to rewrite Equation
(2.17) and get Equation (1.7)
F = lI × B.
(2.18)
A wire experiences a force when a current is ﬂowing through it and an
external magnetic ﬁeld is acting across that current ﬂow. The force is per-
pendicular to the magnetic ﬁeld and the current as it is shown in Figure 2.3,

2.2 Modeling basics
65
Motion
Field
Current
FIGURE 2.3
Fleming’s left-hand rule
which depicts Fleming’s left-hand rule [61] for determining the direction of
the force (motion).
Another basic law governing the generation of a magnetic ﬁeld by some
current is Ampere’s law:
˛
H · dl = Inet,
(2.19)
where H is the magnetic ﬁeld intensity produced by the current Inet , and dl
is a diﬀerential element of length along the path of integration.
The magnetic ﬁeld intensity H is, in a sense, a measure of the eﬀort that
current is putting into the establishment of the magnetic ﬁeld. The strength
of the magnetic ﬁeld ﬂux produced in the core also depends on the material
of the core. The relationship between the magnetic ﬁeld intensity H and the
resulting magnetic ﬂux density B produced within a material is given by
B = µH,
(2.20)
where µ is the magnetic permeability of the material. The actual magnetic
ﬂux density produced in a piece of material is thus given by a product of
two terms: H, representing the eﬀort exerted by the current to establish a
magnetic ﬁeld, as well as µ, representing the relative ease of establishing a
magnetic ﬁeld in a given material.
The permeability of any other material compared to the permeability of
free space is called its relative permeability and it is deﬁned as
µr = µ
µ0
.
(2.21)
Relative permeability is a convenient way to compare the “magnetizabil-
ity” of materials. For example, the steels used in modern machines have rela-
tive permeability of 2000 to 6000 (or even more). This means that, for a given

66
2 Power ﬂow basics
FIGURE 2.4
Magnetizing B-H curve
amount of current, 2000 to 6000 times more ﬂux is established in a piece of
steel than in a corresponding area of air. The permeability of air is essentially
the same as the permeability of free space (µ0 = 4π × 10−7 [H/m]). Usually,
the magnetizing B-H curve shows a linear region and saturation region. The
transition between the saturation and the linear region is called the knee (see
Figure 2.4).
Obviously, the metal core in a transformer or electric machine plays an
extremely important part in increasing and concentrating the magnetic ﬂux
in the device. Also, because the permeability of iron is so much higher than
that of air, the great majority of the ﬂux in an iron core, as in Figure 2.8,
remains inside the core instead of traveling through the surrounding air, which
has much lower permeability. The small ﬂux that does leave the iron core is
very important in determining the ﬂux linkages between coils and the self-
inductances of coils in transformers and motors. In a core such as the one
shown in Figure 2.8, the magnitude of the ﬂux density is given by
B = µH = µNi
lc
.
(2.22)
Now, the total ﬂux in a given area is given by
φ =
ˆ
A
B · dA,
(2.23)
where dA is the diﬀerential unit of area. If the ﬂux density vector is perpen-
dicular to a plane of area A, and if the ﬂux density is constant throughout
the area, then this equation reduces to
φ = BA.
(2.24)

2.2 Modeling basics
67
200
400
800
600
1000
0.5
1.0
1.5
2.0
H
B
a
b
c
d
e
f
Saturation
(Ho, Bo)
Residual
Magnetism
Coersive
Force
(-Ho, -Bo)
0
FIGURE 2.5
Hysteresis
Thus, the total ﬂux in the core in Figure 2.8 due to the current i in the
winding is
φ = BA = µNi
lc
,
(2.25)
where A is the cross sectional area of the core.
An important eﬀect called hysteresis is presented when the magnetic ﬁeld
increases from positive to negative value. Hysteresis is characterized by the
residual magnetism and the coercive force that appear in the B-H curve (see
Figure 2.5). This magnetizing curve is determined according to the ferromag-
netic material.
To study magnetic circuits, analogies between magnetic and electric cir-
cuits can be created. Those analogies allow us to describe the magnetic circuit
and solve it using the same laws as for electric circuits. Table 2.1 shows a com-
parison of electric and magnetic circuits that was presented by [24]. In this
table, the reluctance is one of the most important quantities that is deter-
mined using the material permeability, the mean length, and the area. The
reluctance is an analog to the resistance.
Using the information of Table 2.1, an electric circuit can be created by
the magnetic circuit (see Figure 2.6). Electric circuits can represent complex
magnetic circuits, so the laws of current and voltages can be used for solving
such circuits.
Example 2.1. Consider Figure 2.7 to represent a quadrangular piece of ma-
terial with B = 1 [T], Lc=0.8 [m], Lg = 0.8 × 10−3 [m], µR=3000, and a
transversal area Ag = Ac = 16 × 10−4 [m2]. Calculate the current necessary
to hold B.
First we can calculate the reluctances of the metallic part of the circuit and

68
2 Power ﬂow basics
TABLE 2.1
Analogies between electric and magnetic quantities [24]
Electrical
Magnetic
Voltage
V
[V]
mmf
F
[A-t]
Current
I
[A]
Flux
φ
[Wb]
Resistance
R
[Ω]
Reluctance
R
[H−1]
Electric ﬁeld
intensity
E
[V/m]
Magnetic ﬁeld
intensity
H
[A-
t/m]
Current density
J
[A/m2] Flux density
B
[T]
Conductivity
σ
[S/m]
Permeability
µ
[H/m]
Ohm’s law
V = IR
F = φR
Flow density
J = σE
B = µH
Admitance
R =
l
σA = 1
G
R =
l
µA =
1
P
V
R
I
Electrical
Magnetic
FIGURE 2.6
Analogy between electric and magnetic circuits
FIGURE 2.7
Schematic for Example 2.1

2.2 Modeling basics
69
the air-gap:
Rg =
Lg
µ0Ag
=
0.8 × 10−3
(4π × 10−7) (16 × 10−4) = 3.98 × 105,
Rc =
Lc
µ0µRAc
=
0.8
(4π × 10−7) (3000) (16 × 10−4) = 1.33 × 105.
The ﬂux can be directly calculated as follows:
Φ = B· A = (1)
 16 × 10−4
= 1.6 × 10−4 [Wb],
and the mmf can be obtained as the ﬂux was previously computed:
F = (Rg + Rc) Φ = 84.88 [A −t].
With the previous results, the current can be directly computed as:
I = F
N = 84.88 [A −t]
600 [t]
= 0.1415 [A].
(2.26)
2.2.3
Magnetically coupled circuits
Magnetically coupled electric circuits are central to the operation of trans-
formers and electric machines. In the case of transformers, stationary circuits
are magnetically coupled for the purpose of changing the voltage and current
levels. Circuits in relative motion are magnetically coupled for the purpose
of transferring energy between mechanical and electrical systems. Since mag-
netically coupled circuits play such an important role in power transmission
and conversion, it is important to establish the equations that describe their
behavior and to express these equations in a form convenient for analysis.
Two stationary electric circuits are magnetically coupled as shown in Fig-
ure 2.8. The two coils consist of turns N1 and N2 wound on a common core,
which is a ferromagnetic material with large permeability relative to that of
air. This scheme of the circuit represents the main function of a transformer
in which coupled inductors are assumed to have perfect coupling and zero
power loss. The transformer is a device that uses magnetic coupling between
two inductors. These devices are used to step up or step down AC voltages
and currents, commonly used to reduce the voltages and to isolate one circuit
from another.
The permeability of free space is 4π × 10−7 [H/m]. This permeability
is represented by µ0, in which the permeability of other materials can be
expressed as µ = µrµ0 where µr is the relative permeability. In the case of
transformer steel the relative permeability may be as high as 2000 to 4000.
The ﬂux produced by each coil, for better analysis, can be separated into
two components: a leakage component denoted with an l and a magnetizing

70
2 Power ﬂow basics
FIGURE 2.8
Magnetically coupled circuit
component denoted by an m. Each of the components are depicted by a single
streamline with the positive direction determined by applying the right-hand
rule to the directions of current ﬂow in the coil. It is very important to take
into account that transformer analysis, i2, is selected positive out of the top
of coil 2 and a dot placed at that terminal. The ﬂux linking each coil may be
expressed as
Φ1 = Φl1 + Φm1 + Φm2,
(2.27)
Φ2 = Φl2 + Φm2 + Φm1.
(2.28)
The leakage ﬂux Φl1 is produced by current ﬂowing in coil 1 and it links
only the turns of coil 1. Likewise, the leakage ﬂux Φl2 is produced by current
ﬂowing in coil 2 and it links only the turns of coil 2. The magnetizing ﬂux
Φm1 is produced by current ﬂowing in coil 1 and it links all turns of coils 1
and 2. Similarly, the magnetizing ﬂux Φm2 is produced by current ﬂowing in
coil 2 and it also links all turns of coils 1 and 2.
With the selected positive direction of current ﬂow and the way in which
the coils are wound, the magnetizing ﬂux produced by positive current in one
coil adds to the magnetizing ﬂux produced by positive current in the other
coil. In other words, if both currents are actually ﬂowing in the same direction,
the magnetizing ﬂuxes produced by each coil are in the same direction, making
the total magnetizing ﬂux or the total core ﬂux the sum of the instantaneous
magnitudes of the individual magnetizing ﬂuxes. If the actual currents are in
opposite directions, the magnetizing ﬂuxes are in opposite directions. In this
case, one coil is said to be magnetizing the core, the other demagnetizing.
All of the leakage ﬂux may not link all the turns of the coil producing it.
Likewise, all of the magnetizing ﬂux of one coil may not link all of the turns
of the other coil. The number of turns is considered an equivalent number
rather than the actual number. The inductances of the electric circuit resulting
from the magnetic coupling are generally determined from tests. The voltage

2.2 Modeling basics
71
Electrical 
 system
Coupling
     ﬁeld
Mechanical
    system
FIGURE 2.9
Block diagram of an electromechanical system
equations are expressed in matrix form as
v = ri + dλ
dt ,
(2.29)
(f)T = [f1f2],
(2.30)
where r = diag[r1 r2], and f represents voltage, current of ﬂux linkage.
The resistance r1 and r2, and the ﬂux linkages λ1 y λ2 are related to coils
1 and 2. Since it is assumed that Φ1 links the equivalent turns of coil 1 and
Φ2 links the equivalent turns of coil 2, the ﬂux linkages are written as
λ1 = N1Φ1,
(2.31)
λ2 = N2Φ2,
(2.32)
where Φ1 and Φ2 are given by Equations (2.27) and (2.28) respectively.
2.2.4
Electromechanical energy conversion and losses
Electromechanical devices are used in many systems, and machines are the
most common. A block diagram of an elementary electromechanical system is
shown in Figure 2.9.
Electromechanical systems are comprised of an electrical system. The elec-
trical and mechanical systems can interact. Interaction can take place through
any and all electromagnetic and electrostatic ﬁelds that are common to both
systems, and energy is transferred from one system to the other as a result
of this interaction. Both electrostatic and electromagnetic coupling ﬁelds may
exist simultaneously, and the electromechanical system may have any number
of electrical and mechanical systems.
However, before considering an involved system, it is helpful to analyze the
electromechanical system in a simpliﬁed form. An electromechanical system
with one electrical system, one mechanical system, and one coupling ﬁeld is
shown in Figure 2.9. Electromagnetic radiation is neglected, and it is assumed
that the electrical system operates at a frequency suﬃciently low so that the
electrical system may be considered a lumped-parameter system.
Losses occur in all components of the electromechanical system. Heat loss
will occur in the mechanical system due to friction and the electrical system
will dissipate heat through the resistance of the current-carrying conductors.
Eddy currents and hysteresis losses occur in the ferromagnetic material of all

72
2 Power ﬂow basics
magnetic ﬁelds while dielectric losses occur in all electric ﬁelds. Eddy currents
are electric currents produced by the changing magnetic ﬁeld in the conductor
while hysteresis is the dependence of the output of a system on its current
input and past inputs.
If WE is the total energy supplied by the electrical source and WM the
total energy supplied by the mechanical source, then the energy distribution
could be expressed as
WE = We + WeL + WeS,
(2.33)
WM = Wm + WmL + WmS.
(2.34)
In Equation (2.33), WeS is the energy stored in the electric or magnetic
ﬁelds that are not coupled with the mechanical system. The energy WeL is
the heat loss associated with the electrical system. These losses occur because
of the resistance of the current-carrying conductors as well as the energy
dissipated from these ﬁelds in the form of heat due to hysteresis, eddy currents,
and dielectric losses. The energy WE is the energy transferred to the coupling
ﬁeld by the electrical system. The energies common to the mechanical system
are deﬁned in a similar manner.
In Equation (2.34), WmS is the energy stored in the moving member and
compliances of the mechanical system, WmL is the energy loss of the me-
chanical system in the form of heat, and Wm is the energy transferred to the
coupling ﬁeld. It is important to note that with the convention adopted, the
energy supplied by either source is considered positive. Therefore, WE(WM) is
negative when energy is supplied to the electrical source (mechanical source).
If WF is deﬁned as the total energy transferred to the coupling ﬁeld, then
we obtain
WF = Wf + WfL,
(2.35)
where Wf is the energy stored in the coupling ﬁeld and WfL is the energy
dissipated in the form of heat due to losses within the coupling ﬁeld. In this
case, these losses could be the hysteresis, eddy currents, or dielectric losses,
as mentioned before. The electromechanical system must obey the law of con-
servation of energy, thus the next equation is expressed as
Wf + WfL = (WE −WeL −WeS) + (WM −WmL −WmS) .
(2.36)
From Equations (2.33), (2.34), and (2.36) we simplify, so Equation 2.37
can be written:
Wf + WfL = We + Wm.
(2.37)
This energy relationship is shown schematically in Figure 2.10.
The actual process of converting electrical energy to mechanical energy, or
vice versa, is independent of:
• The loss of energy in either the electrical or the mechanical system, ex-
pressed as WeL −WmL

2.3 Machine parameters
73
Σ
+
-
-
Σ
+
-
-
WE
We
Wm
WM
WeS
WeL
Σ
+
+
-
-
WfL
Wf
WmL
WmS
Electrical System
Coupling Field
Mechanical System
FIGURE 2.10
Energy balance
• The energies stored in the electric or magnetic ﬁeld that are not common
to both systems, denoted by WeS
• The energies stored in the mechanical system, shown as WmS. If the losses
of the coupling ﬁeld are neglected, then the ﬁeld is conservative and be-
comes
Wf = We + Wm.
(2.38)
The examples of elementary electromechanical systems are shown in Figure
2.11, representing a magnetic coupling ﬁeld, while the electromechanical sys-
tem shown in Figure 2.12, employs an electric ﬁeld as a means of transferring
energy between the electrical and mechanical systems.
2.3
Machine parameters
The stator windings of the synchronous machine are embedded in slots around
the inside circumference for the stationary member. In the 2-pole machine,
each phase winding of the 3-phase stator winding is displaced 120◦with respect
to each other, as illustrated in Figure 2.13. The ﬁeld of fd winding is wound on
the rotating member. The as, bs, cs, and fd axes denote the positive direction
of the ﬂux produced by each of the windings. The as, bs, and cs windings are
identical so that each winding has the same resistance and the same number
of turns.
When a machine has three identical stator windings arranged as shown
in Figure 2.13, it is often referred to as a machine with symmetrical stator
windings. The symmetrical induction machine has identical multiphase stator
windings and identical multiphase rotor windings. An unsymmetrical induc-
tion machine has non-identical multiphase stator windings, which generally
are 2-phase, and symmetrical multiphase rotor windings.

74
2 Power ﬂow basics
+
-
+
-
ef
v
L
r
M
D
f
fe
K
x
x0
i
Φ
FIGURE 2.11
Electromechanical system with magnetic ﬁeld
M
+
-
+
-
ef
v
L
r
-q
+q
D
f
fe
K
x
x0
i
FIGURE 2.12
Electromechanical system with electric ﬁeld

2.3 Machine parameters
75
bs axis
as axis
ωr
Θr
Φr
cs axis
fd axis
c1’
c1
b3
b2’
a1
a1’
f1
f1’
b1
f2’
f3’
f4’
b2
b4
f3
f2
f4
a4
a3
a2
c2’
c3’
c4’
b4’
b3’
b1’
c2
c3
c4
a2’
a3’
a4’
FIGURE 2.13
Elementary 2-pole, 3-phase, Y-connected salient-pole synchronous machine
It is assumed that each coil spans π radians of the stator for a 2-pole
machine. One side of the coil (coil side) is represented by ⊗, indicating that
the assumed positive direction of the current is down the length of the stator
(like if it were moving into this page). The point inside the circle, ⊙, indicates
that the assumed positive direction of the current is ﬂowing from the inside
of this page. Each coil contains nc conductors, each of which makes up an
individual single conductor coil within the main coil. Thus the number of
turns of each winding is determined by the product of nc and the number of
coils’ sides carrying current in the same direction.
The winding conﬁguration shown in Figure 2.13 is an oversimpliﬁcation of
a practical machine. The coil sides of each phase winding are considered to
be distributed uniformly over 60◦of the stator circumference. Generally, the
coil sides of each phase are distributed over a larger area, perhaps as much
as 120◦, in which case it is necessary for some of the coil sides of two of the
phase windings to occupy the same slot.
In some cases, the coil sides may not be distributed uniformly over the
part of the circumference that the coil occupies. The windings span π radians
for the 2-pole machine. This is referred to as full-pitch winding. In order to
reduce voltage and current harmonics, the windings are often wound so that
they span slightly less than π radians for a 2-pole machine. This is referred to
as a fractional-pitch winding.
A salient-pole synchronous machine is selected for consideration since the
analysis of this type of machine may be easily modiﬁed to account for other
machine types. However, a salient-pole synchronous machine would seldom be
a 2-pole machine except in the case of small reluctance machines, which are

76
2 Power ﬂow basics
FIGURE 2.14
A synchronous machine
of the synchronous class but do not have a ﬁeld winding. Generally, 2- and 4-
pole machines are round-rotor machines with the ﬁeld winding embedded in a
solid steel (nonlaminated) rotor. Salient-pole machines generally have a large
number of poles composed of laminated steel whereupon the ﬁeld winding is
wound around the poles similar to that shown in Figure 2.13.
After directly measuring stator resistances and ﬁnding the coils’ distribu-
tion, the next step is to determine the self- and mutual inductances of the ma-
chine windings. It is advantageous to use the elementary 2-pole, 3-phase syn-
chronous machine to explain these inductance relationships. This procedure
can be readily modiﬁed to account for additional windings (damper windings)
placed on the rotor of the synchronous machine or for a synchronous machine
with a uniform air gap (round rotor). These inductance relationships are easily
altered to describe the winding inductances of an induction machine.
Figure 2.13 and Figure 2.15 are redrawn with the windings portrayed as
sinusoidally distributed windings. In a magnetically linear system, the self-
inductance of a winding is the ratio of the ﬂux linked by a winding to the
current ﬂowing in the winding with all other winding currents zero. A syn-
chronous machine is shown in Figure 2.14.
Mutual inductance is the ratio of ﬂux linked by one winding due to current
ﬂowing in a second winding with all other winding currents zero, including
the winding for which the ﬂux linkages are being determined. For this analysis

2.3 Machine parameters
77
it is assumed that the air-gap length is approximated as
g(Φr) =
1
α1 −α1 cos2(Φr),
(2.39)
g(Φs −θr) =
1
α1 −α1 cos2(Φs −θr).
(2.40)
bs axis
as axis
ar axis
ωr
Θr
Φr
cs axis
fd axis
cs’
cs
bs
bs’
as
as’
fd
fd’
FIGURE 2.15
Elementary 2-pole, 3phase, Y-connected salient-pole synchronous machine
The winding arrangement of a 2-pole, 3-phase, Y-connected symmetrical
induction machine is shown in Figure 2.17. The stator windings are identical
with equivalent turns Ns and resistance rs. The rotor windings, which may be
wound or forged as a squirrel cage winding, can be approximated as identical
windings with equivalent turns Nr and resistance rr. The air gap of an induc-
tion machine is uniform and it is assumed that the stator and rotor windings
are approximated as sinusoidally distributed windings. An induction machine
is shown in Figure 2.16.
In nearly all industrial applications, the induction machine is operated as
a motor with the stator windings connected to a balanced 3-phase source and
the rotor windings short-circuited. The principle of operation in this mode
is quite easily deduced. With balanced 3-phase current ﬂowing in the stator
windings, a rotating air-gap MMF (magnetomotive force) is established, as
in the case of the synchronous machine, which rotates about the air gap at
a speed determined by the frequency of the stator currents and the num-
ber of poles. If the rotor speed is diﬀerent from the speed of this rotating
MMF, balanced 3-phase currents will be induced (thus the name induction)

78
2 Power ﬂow basics
FIGURE 2.16
Induction machine
bs axis
br axis
cs axis
cr axis
as a
ar a
ωr
Θr
Φr
cr’
cs’
ar
ar’
as
as’
cs
cr
br’
br
bs
bs’
FIGURE 2.17
Two-pole, 3-phase, Y-connected symmetrical induction machine

2.3 Machine parameters
79
FIGURE 2.18
Wound rotor and squirrel cage rotor
in the short–circuited rotor windings. The frequency of the rotor currents cor-
responds to the diﬀerence in the speed of the rotating MMF due to the stator
currents and the speed of the rotor.
The induced rotor currents will in turn produce an air-gap MMF that
rotates relative to the rotor at a speed corresponding to the frequency of the
rotor currents. The speed of the rotor air-gap MMF superimposed upon the
rotor speed is the same speed as that of the air-gap MMF established by the
currents ﬂowing in the stator windings. These two air-gap MMFs rotating
in unison may be thought of as two synchronously rotating sets of magnetic
poles. Torque is produced due to an interaction of these magnetic poles. It
is clear, however, that torque is not produced when the rotor is running in
synchronism with the air-gap MMF due to the stator currents since in this
case currents are not induced into the short-circuited rotor windings.
The winding inductance of the induction machine is expressed from the
inductance relationships given for the salient-pole synchronous machine. In
the case of the induction machine, the air gap is uniform. Thus, 2θr variations
in the self- and mutual inductances do not occur. These variations can be
eliminated by setting α2 = 0 in the inductance relationship given for a salient-
pole synchronous machine.
An induction machine can be a squirrel cage or wound rotor, as shown in
Figure 2.18.
The squirrel cage is the most-employed electric machine due to its robust-
ness, high eﬃciency, and low cost, while the wound rotor allows access to the
rotor windings to modify its torque and speed curve, or even feed the electric
machine to the rotor in order to increase its speed controllability. The disad-
vantage is that its maintenance is high due to the weathering of the brushes;

80
2 Power ﬂow basics
FIGURE 2.19
Frontal view slip-rings induction machine
in addition, friction of the brushes decreases the eﬃciency of the machine. In
order to access a wound rotor, rings of displacement are needed, as shown in
Figure 2.19.
The whole induction machine assembly is shown in Figure 2.20.
The test load of an induction machine measures the rotational losses of the
motor and provides information about its magnetizing current. The test circuit
is shown in Figure 2.21, where wattmeters, voltmeter, and three ammeters are
connected. The test is performed on voltage (VTSC) and frequency.
On the other hand, the “locked rotor test” locks the rotor so that it cannot
move, a voltage is applied to the motor and the voltage, the current, and the
resulting power are measured. Figure 2.22 shows the connections for the test.
First, the current ﬂow value to be approximately full-loaded is set. When the
current value is at full load, voltage, current, and power ﬂowing in the motor
are measured.
This test presents a problem. During normal operation, the stator fre-
quency is the line frequency of the power system (50 or 60 [Hz]). In starting
conditions, the rotor also has the line frequency. However, in normal operating
conditions, the slip in most engines is only 2 to 4% and the resulting frequency
of the rotor is in the range of 1 to 3 [Hz]. This creates a problem because the
frequency of the line does not represent normal operating conditions of the ro-
tor. A typical solution for class B and C motors (resistance versus frequency)
is to use a frequency equal to or less than 25% of the nominal frequency. This
test is performed to reach nominal current.

2.3 Machine parameters
81
FIGURE 2.20
Induction machine assembly
P1
P2
A
A
A
IA
IB
IC
Three-phase
power source
voltage and 
frequency
variables
V
Load
Test
FIGURE 2.21
Load test circuit
Three-phase
power source
voltage and 
andjustable
frequency
A
A
A
V
P
P
Locked
Rotor
a
b
c
IA
IB
IC
FIGURE 2.22
Locked rotor test circuit

82
2 Power ﬂow basics
2.3.1
Exercise generator load test
The generator will be connected to a varying load; thus the electrical pa-
rameters can be monitored. A manual change on the load will be applied
to graphically monitor the electrical parameter changes. Use all the modules
shown in the cabling diagram of the exercise and check that the power is oﬀ
before connecting. The required material is at the end of the exercise and sug-
gested connections appear in Diagram 2.1. Follow the instructions illustrated
by Figures 2.23, 2.24, 2.25, and 2.26.
FIGURE 2.23
SCADA representation of the water governor to increase and decrease gener-
ator speed
Turn on the brushless driver. Increment the speed of the driver up to
1800 [rpm].
FIGURE 2.24
SCADA representation of the switch that connects the generator to the loads
Close the correct bus bar R1 to connect the load R-L. The load R-L has
to be set to the position 0.
Increment the excitation current to reach the nominal armature voltage
Us.
Change the resistive load in a balanced way and observe the variations of
VL12, V23, and VL31 due to the variation of load. Increment the excitation
current Ie to level the output voltage Us.

2.3 Machine parameters
83
FIGURE 2.25
Excitation voltage
FIGURE 2.26
Loads
Change the inductive load in a balanced way and observe the variations of
VL12, V23, and VL31 due to load variation. Increment the excitation current
Ie to level the output voltage Us.
Register the data and draw a graph relating the excitation current Ie to
the variation of a purely resistive load and inductive load.
Table 2.2 has been plotted in Graphs 2.1 and 2.2.
Table 2.3 has been plotted in Graphs 2.3 and 2.4.
Suggested material:
• Brushless driver for generating mechanical energy
• Power circuit breaker
• Feeder manager relay
• Module for measuring the electric power
• Three-phase asynchronous generator
• Programmable automatic power supply unit
• RS485 communication
• Resistive load
• Inductive load

84
2 Power ﬂow basics
Graph 2.1
Resistive load with constant Us
Graph 2.2
Inductive load with constant Us
Graph 2.3
Resistive load with constant Ie

2.3 Machine parameters
85
Diagram 2.1
Suggested connection to load test

86
2 Power ﬂow basics
TABLE 2.2
Data registered with Us[VVRMS] constant, having Ie as the excitation current,
Iarm as the armature current, and US as the supplied voltage
Resistive Load
Inductive Load
Balanced
Ie[mA] Iarm[mA] Us[VRMS] Ie[mA] Iarm[mA] Us[VRMS]
Oﬀ
364
0
380
x
x
380
R1
390
202
380
442
150
380
R2
403
285
380
478
218
380
R3
450
490
380
550
366
380
R4
516
704
380
640
536
380
R5
615
990
380
745
740
380
TABLE 2.3
Data registered with Ie[mA] constant, having Ie as the excitation current,
Iarm as the armature current, and US as the supplied voltage
Resistive Load
Inductive Load
Balanced
Iarm[mA] Us[VRMS] Ie[mA] Iarm[mA] Us[VRMS] Ie[mA]
Oﬀ
0
380
365
0
0
365
R1
192
360
365
130
326
365
R2
262
350
365
176
307
365
R3
410
318
365
260
269
365
R4
522
281
365
326
233
365
R5
618
236
365
390
206
365
R6
692
186
365
458
176
365
R7
722
161
365
492
156
365
2.3.2
Exercise generator no-load test
Start the alternator by using an excitation system and a drive motor. The
alternator will not be connected to any load. There is the option to change
the speed of the driver motor and the excitation of the generator to verify the
behavior of electrical parameters. Use all the modules shown in the cabling
diagram of the exercise. Check that the power is oﬀbefore connecting. The
required material is described below and the suggested connection is shown
in Diagram 2.2. Follow the instructions illustrated by Figures 2.27 and 2.28.
You should obtain similar results as the ones shown in Table 2.4 and Graph
2.5.
Turn on the brushless driver. Increment the speed of the brushless up to
1800 [rpm].
Now, with the alternator set at nominal speed, increment the excitation
current to obtain the nominal voltage.
Monitor the diﬀerent parameters (Varmature, Iarmature, W, Var, S, Iexc,

2.3 Machine parameters
87
Graph 2.4
Inductive load with constant Ie
FIGURE 2.27
SCADA representation of the water governor to increase and decrease gener-
ator speed
FIGURE 2.28
Excitation of the generator
Vexc). Modify the excitation voltage and observe the armature voltage varia-
tion. Register the data in a table and draw the graph.
Sugested Material:
• Brushless control
• Power circuit breaker

88
2 Power ﬂow basics
TABLE 2.4
Data registered with three diﬀerent speeds, having Us, Ut, and Uw as the
voltage of each of the three phases
Speed (min-1)
1800
1000
700
Ie(mA)
(Us,Ut,Uw) Vrms
(Us,Ut,Uw) Vrms
(Us,Ut,Uw) Vrms
100
117
63
46
150
172
95
69
200
225
124
88
250
275
154
107
300
323
181
126
350
366
202.6
143
400
408
225
158
450
440
243
170
500
467
259
181
550
487
274
192
Graph 2.5
Graph from Table 2.4
• Feeder manager relay
• Module for measuring the electric power
• Three-phase asynchronous generator
• Programmable automatic power supply unit
• Resistive load
• Inductive load

2.3 Machine parameters
89
Diagram 2.2
Suggested connection to load test

90
2 Power ﬂow basics
2.4
Mathematical models of electric machinery
2.4.1
Power transformer
Transformers are commonly used to step up/down a given AC voltage in or-
der to achieve eﬃcient transmission or safe usage. Schematically, they consist
of a very simple magnetic circuit involving two windings associated through
a common low-reluctance magnetic path. The aforementioned path is com-
monly manufactured with iron and the windings are classiﬁed as primary or
secondary depending on the direction the power is desired to ﬂow (always
from primary to secondary).
1
lφ
2
lφ
1i
2i
2
φ
+
1
φ
=
m
φ
FIGURE 2.29
Transformer schematic view
Besides transformers’ magnetic circuit representation’s being simple, there
are many considerations related to their actual construction, which forces
modeling to consider complex ﬂux paths. As shown in Figure 2.29, the actual
ﬂuxes of both windings would be given by
Φ1 =Φl1 + Φm
Φ2 =Φl2 + Φm,
where Φli stands for the leakage ﬂux of winding i. It is called leakage ﬂux as
it can be considered as a loss, because it is not used for core magnetization.
In this way, the linked ﬂux λi of the ith winding is
λi = NiΦi = Ni(Φl1 + Φm),
where N stands for the number of turns of the winding. It is possible to
substitute the ﬂuxes’ magnitudes with their current equivalent, related to

2.4 Mathematical models of electric machinery
91
magnetic permeability. In this way, currents are solved as
λ1 = N1


N1i1Pl1
| {z }
Φli
+ (N1i1 + N2i2)Pm
|
{z
}
Φm


=


N 2
1 Pl1 + N 2
1 Pm
|
{z
}
L11


i1+N1N2Pm
|
{z
}
L12
i2.
The linkage ﬂux can be given in terms of system’s inductances. The sub-
scripts related to each inductance Lij stand for the relation such inductance
keeps towards each coil. For instance, L11 focuses on those ﬂuxes going ex-
clusively through winding 1, and is called self-inductance. On the other hand,
any Lij, i ̸= j takes into account the ﬂux going through two diﬀerent windings
and thus, it is called mutual inductance. Our two-windings transformer can
be described by two equations as
λ1 =L11i1 + L12i2
λ2 =L21i1 + L22i2.
Physically, the self-inductance of both windings is due to the leakage and
the actual magnetizing component Lmi (only due to current ii). In order to
calculate both inductances, the opposite current is considered to be zero, so
L11 = λi|ij=0
ii
= N1(Φli + Φmi)
ii
= N 2
1 Pli
| {z }
Ll1
+ N 2
1 Pm)
| {z }
Llm
.
We can now ﬁnd the ratio between both magnetization inductances as
Lm2
Lm1
= N2
N1
.
So, each linked ﬂux can be given as a function of current through its own
magnetizing inductance, as
N1Φm = N1 (Φm1 + Φm2) = N1
Lm1i1
N1
+ Lm2i2
N2

= Lm1

i1 + N1
N2
i2

.
It is possible to link the transformer equations presented so far with its
windings’ voltage as the voltage is equal to the linked ﬂux derivative. As in
the preceding equations, the mutual inductance can be seen from the primary
by using the turns relation:
e1 = dλ1
dt = L11
di1
dt + L12
di2
dt = Ll1
di1
dt + Lm1
di1
dt
|
{z
}
self-inductance
+ Lm1
d (i2N2/N1)
dt
|
{z
}
mutual-inductance
.
This can be associated by solving for the magnetization inductance of the
primary
e1 = Ll1
di1
dt + Lm1
d (i1 + i2N2/N1)
dt
= Ll1
di1
dt + Lm1
d

i1 + i(1)
2

dt
,

92
2 Power ﬂow basics
where i(1)
2
represents the secondary current referred to the primary. Likewise,
the secondary voltage can be found to be
e1 = Ll2
di2
dt + Lm2
d (i1N1/N2 + i2)
dt
= Ll2
di2
dt + Lm2
d

i(2)
1
+ i2

dt
.
Referred quantities scale their associated magnitudes to preserve equa-
tions’ balance whether their associated winding was thought to have as many
turns as the opposite one. In this way, all variables related to the secondary
can, for instance, be referred to the primary and vice versa. Hence, the sec-
ondary voltage can be referred to the primary by multiplying all its terms by
N1/N2.
e1 = L(1)
l2
di(1)
2
dt
+ Lm2
d
dt
 N1
N2
2
i1
N1
N2
i2
!
= L(1)
l2
di(1)
2
dt
+
N1
N2
2
Lm2
|
{z
}
Lm1
d
dt






i1
N2
N1
i2
| {z }
i(1)
2






= L(1)
l2
di(1)
2
dt
+ Lm1
d
dt

i1i(1)
2

.
The induced voltages are not the same as the terminal ones because the
windings themselves exhibit some resistance. Thus, the terminal voltage is the
algebraic sum of the induced voltage plus the voltage drop at the winding.
vi = iiri + ei = iiri + Lli
dii
dt + Lmi
d

ii + i(i)
j

dt
.
So, having the terminal voltage of winding i referred to winding j would
be
v(j)
i
= i(j)
i r(j)
i
+ L(j)
li
di(j)
i
dt
+ Lmj
d

ij + i(j)
i

dt
.
If both windings are seen from the primary side, the equations describing
the behavior of the transformer are
v1 = i1r1 + Ll1
di1
dt + Lm1
d

i1 + i(1)
2

dt
,
v2 = i2r2 + Ll2
di2
dt + Lm1
d

i1 + i(1)
2

dt
.
It is quite clear that the right-hand side of both equations is the same, phys-
ically implying that both voltages are inﬂuenced by a common inductance. As

2.4 Mathematical models of electric machinery
93
1
r
1
l
L
1
m
L
2
(1)
r
2
l
(1)
L
1i
2
(1)
i
1
e
m
e
2
(1)
e
2
(1)
v
1
v
2
v
2
N
1
N
Ideal
Transformer
2i
FIGURE 2.30
Transfomer equivalent circuit
a result, it can be seen that the magnetization ﬂux is due to a current i1 +i(1)
2 .
Both primary and secondary voltages share a common path to ground, pro-
vided by Lm1. This voltage drop is later followed by two branches with a single
series resistive-inductive load, respectively. The preceding description points
to the equivalent circuit shown in Figure 2.30.
It is important to notice that the magnetization inductance is not con-
stant as the current rises. As the magnetic core gets saturated, the inductance
value will decrease as permeability does. It is also important to notice that
the equivalent circuit does not consider a load connected to the secondary
terminals. The output voltage can be associated to an electric load as it can
be deﬁned as an impedance, so a current can be calculated and used to modify
transformer’s operating conditions. On the other hand, a full reformulation
of the transformer model can be performed for generic impedance consider-
ations as secondary loads; however, this process could lead to unnecessary
complexity.
It is noteworthy that a full grid simulation conformed by many subsystems
will impose unconsidered variations. However, a full descriptive model of the
transformer could consider the electric source connected to the primary to have
an associated series impedance (i.e., a Thevenin equivalent), while its output
at the secondary would have a generic load. A diﬀerent approach could lead to
a step-by-step simulation where values at each stage are needed to recalculate
the system’s performance.
A three-phase transformer would require new considerations to be taken as
the ﬂux linked by each winding depends on the other two phases. However, if
all three phases are balanced, the same monophasic approach used so far can
be used to estimate threefold electric-magnetic relations by neglecting new
mutual inductances.
It is clear that the application of arbitrary voltages to the primary can be
modeled by the simple equivalent circuit shown in Figure 2.30; however, trans-
formers are mostly connected to well-deﬁned three-phase distribution systems,
so no arbitrary voltages are applied and the electric relation between phases
is determined in a standard manner. For instance, a three-phase transformer

94
2 Power ﬂow basics
A
V
B
V
C
V
A
B
C
a
b
c
N
n
r
Magnetic
Coupling
To Load
FIGURE 2.31
Y-Y connected transformer
A
r
A
l
L
1
m
L
a
(A)
r
a
l
(A)
L
A
i
a
(A)
i
A
a
v
a
N
A
N
Ideal
Transformer
ai
n
r
N
FIGURE 2.32
Equivalent circuit of Y-Y connected transformer for phase A-a
will be connected in delta (∆) or “wye” (Y ) so their behavior can be modeled
straightforwardly.
A Y-Y connected transformer schematic is shown in Figure 2.31. The
equivalent circuit in Figure 2.32 shows the electric relations found for a single
phase if the equivalent circuit is again used. Notice that the neutral connec-
tion adds a resistance to the primary loop as the primary is connected to a Y
source.
Similarly, a ∆-Y connected transformer will schematically look like Fig-
ure 2.33. Notice that no neutral resistance is now added on the primary;
however, it could be added in the secondary whenever the load is also Y con-
nected. The equivalent circuit for this case is shown in Figure 2.34, where the
currents iCA and iBC are connected to other equivalent circuits. A simulation
would be complex in this case as voltage sources and phase coupling is needed
in order to attain adequate results.
2.4.2
Asynchronous machine
An induction motor is ideal for use in machine tools because it keeps a fairly
constant rate (0 −5% slip) within its rated operating range, does not need
to be synchronized to connect to the grid, and has a low price relative to
other machines. Also, its maintenance can be minimal, since it does not need
brushes as DC motors do, and its eﬃciency is above 80%. Induction motors

2.4 Mathematical models of electric machinery
95
A
V
B
V
C
V
A
B
C
N
a
b
c
Magnetic
Coupling
To Load
A
i
B
i
C
i
FIGURE 2.33
∆-Y transformer connection
A
r
A
l
L
1
m
L
a
(A)
r
a
l
(A)
L
AB
i
BC
i
a
(A)
i
a
v
a
N
A
N
Ideal
Transformer
ai
N
A
V
B
V
N
CA
i
FIGURE 2.34
Equivalent circuit of ∆-Y connected transformer for phase A-a
are classiﬁed depending on the number of voltage lines, rated power, NEMA
design, and speed (number of poles and operating frequency).
An induction motor can be understood as a transformer with rotating sec-
ondary; if the rotor is locked, the motor behaves as a short-circuited power
transformer. This implies that the transformer modeling presented in Sec-
tion 2.4.1 is useful to derive a steady-state model of the motor.
This machine can be represented by an equivalent electrical circuit to de-
scribe its behavior (see Figure 2.35). This circuit has a variable load dependent
on rotor’s slip. The sliding of an engine is the basis of an asynchronous machine
operation,
s = nsync −nm
nsync
,
(2.41)
nsync = 120fe
p
[rpm],
(2.42)
where nsync is the maximum engine’s speed-dependent electrical frequency
and number of poles, and nm is the actual speed of the rotor.
The equivalent circuit of induction motor (shown in Figure 2.36) in Fig-
ure 2.35 can be reduced to the Thevenin equivalent circuit in Figure 2.37,
neglecting some electric interactions, where
VT H ≈Vin
Xm
Xs + Xm
,
(2.43)

96
2 Power ﬂow basics
FIGURE 2.35
Equivalent circuit of induction motor
t
V
λab
λbc
λac
λab
λbc
λac
λab
λbc
λac
λfa
λfb
λfc
λfa
λfb
λfc
λfa
λfb
λfc
Va
Vb
Vc
Va
Vb
Vc
Va
Vb
Vc
Va
Vb
Vc
Fs
Fs
Fs
(a) Stator ﬂux linkage at three diﬀerent voltage stages
Fs
Fs
Fr
θr
Fsa
a-
c+
b-
a+
c-
b+
Fsb
Fsc
Fr
Va
Vb
Vc
Va
Vb
Vc
(b) Induced rotor’s magnetomotive force
FIGURE 2.36
Graphical representation of asynchronous motor auto-induction

2.4 Mathematical models of electric machinery
97
FIGURE 2.37
Thevenin equivalent circuit
RT H ≈Rs

Xm
Xs + Xm
2
,
(2.44)
XT H ≈Xs.
(2.45)
Then, the torque motor with sliding is calculated as
τind =
3×V 2
T H×R2
s
sωsync × [(RT H + R2
s )2 + (XT H + X2)2].
(2.46)
By knowing the machine’s parameters, it is possible to graph its speed-
torque relation, as shown in Figure 2.38. The most important point of the
graph is the maximum torque, because as its name indicates, the engine will
not be able to exceed this value.
The National Electrical Manufacturers Association (NEMA) has standard-
ized the design of electric motors to establish certain characteristics and re-
quirements that must be met by manufacturers. The main characteristics of
the engines as designed are:
Design A The standard design has a current of moderate start, and an
equally medium torque, and small slip in the range of nominal operation.
The maximum permissible slip is 5% and must be less than that of type B
design. The maximum torque is 200 to 300% nominal torque and slippage
occurs at less than 20%, while the starting torque for this engine is rated
at 60% for large motors and 200% or more for small engines. The main
drawback for this type of engine is the large amount of current required
to start the line (usually 5 −7 times the rated current), and if there is
sensitive equipment connected to the same equipment, it can be damaged
by voltage drop. Very large motors should be started at reduced voltage to
mitigate the problem of voltage drop. Typical applications for this engine
are: pumps, machine tools, blowers, compressors, fans.

98
2 Power ﬂow basics
em
T
Braking
Motoring
Generating
s
s
ω
max
s
em
T
max
r
ω
starting torque
1
−
1
2
0
0
s
ω
−
FIGURE 2.38
Induction motor operating modes
Design B This type of engine has a medium starting torque, but with a lower
starting current (about 25% less than design A), little slip in the operating
range, and minimum torque of 200% nominal torque, although this is less
than design A because it has a higher resistance rotor (this also reduces
its eﬃciency). The applications are very similar to design A. Design B has
shifted to this design because of its lower starting current.
Design C Design C is for high starting torques (over 250% nominal torque)
and low starting current, slippage less than 5% in nominal operation, and
maximum torque is slightly lower than design A. As shown in Figure 2.39,
the pattern C has a design performance between A and B. The disad-
vantage of this engine is cost, because achieving this behavior requires
manufacturing of dual cage rotors. These engines respond very well for
jobs that require motor starting loaded, loaded as pumps, compressors,
and conveyors.
Design D These motors have a very large starting torque; some motors even
have maximum torque at start-up (275% over the nominal torque) and a
small current boot, but they have a huge slide in nominal operation (7 to
11−17%) and a very poor eﬃciency (because it requires a lot of resistance
in the rotor to get the boot with little current). These motors are used
to start moving large inertial mass; for example, panels that open the
ﬂoodgates of dams which require a lot of torque to reach full speed. After
performing a task, these engines are left oﬀuntil their next operation is
required.

2.4 Mathematical models of electric machinery
99
150
300
0
10
20
30
40
50
60
70
80
90
100
450
Speed (% of synchronous speed)
Torque (% of full load torque)
Design A
Design D
Design C
Design B
FIGURE 2.39
Torque-speed curves of diﬀerent NEMA standard motors
TABLE 2.5
Rotor stopped
Rotor stopped
NEMA Code
[kVA/hp]
NEMA Code
[kVA/hp]
A
0-3.15
L
9.00-10.00
B
3.15-3.55
M
10.00-11.00
C
3.55-4.00
N
11.20-12.50
D
4.00-4.50
P
12.50-14.00
E
4.50-5.00
R
14.00-16.00
F
5.00-5.60
S
16.00-18.00
G
5.60-6.30
T
18.00-20.00
H
6.30-7.10
U
20.00-22.40
J
7.20-8.00
V
M´as de 22.40
K
8.00-9.00
Given the above descriptions, the best design for the implementation of the
retroﬁt design is A, because it has the greatest eﬃciency in nominal operation
and weakness can be mitigated with start control.
To know more precisely what the starting current at the plate will be,
NEMA code determines which will be the starting power full motor voltage.
Table 2.5 shows the values of the constant that is multiplied by the engine
power design for the PTO:
With the design constant, we obtain the initial complex power S,
Sstart = (rated horsepower)(code letter factor),
(2.47)
and the starting current
Istart =
Sstart
√
3 × Vτ
.
(2.48)

100
2 Power ﬂow basics
FIGURE 2.40
Brushless motor
2.4.3
Brushless motor
The construction of brushless motors is very similar to that of AC motors.
The rotor is a permanent magnet element, and the stator is made up as an
AC motor with several phases. The big diﬀerence between these two types of
motors is how to detect the position of the rotor in order to know how to ﬁnd
the magnetic poles and generate the control signal using power transistors.
These sensing and power electronics elements are commonly integrated (or
sold together) with the machine.
The position sensing is normally done with Hall eﬀect sensors. The Hall
eﬀect is the appearance of an electric ﬁeld (the Hall ﬁeld) in a conductor when
it is crossed by a magnetic ﬁeld. The Hall eﬀect-based sensors comprise a con-
ductive or semiconductive element and a magnet element. Thus, the proximity
of an object can be determined if it is a ferromagnetic material. Brushless mo-
tors can also use optical sensors or encoders to determine the position at which
the rotor is located. A brushless motor is shown in Figure 2.40.
Like all electric machines, a brushless motor is based on two basic principles
of electromagnetic force induced in a conducting wire in the presence of a
magnetic ﬁeld (deduction of Lorentz force law),
F = Bli,
(2.49)
where B is the magnetic ﬁeld density, l is the conductor length, and i is
the current intensity ﬂowing through the conductor. The voltage induced in
a conductor in the presence of an alternating magnetic ﬁeld (deduction of
Faraday’s Law) is
eb = dλ
dt = Blv [V ],
(2.50)
where v is the relative velocity between the ﬁeld and the conductor. To deter-
mine the torque generated by the engine, you will have to build a circuit to

2.4 Mathematical models of electric machinery
101
Φr
Φr
Rm
Rm
Rr
Rl
Rs
2Rg
Φl
Φg
Φ
N
S
N
S
(a)
2Rm
Φr
2KrRg
Φ
(b)
FIGURE 2.41
a) Magnetic circuit model, b) magnetic circuit simpliﬁed
determine the magnetic ﬂux linkage, then the generated electromotive force
(EMF), and ﬁnally the induced torque. The ﬂow exits the north pole of the
rotor magnet, passes through the air gap by the stator, and travels through
the gap again to reach the south pole of a magnet. Finally it closes the cir-
cuit in the inner part of the rotor. A small part of the stream does not ﬂow
through the stator, representing the leakage ﬂow in parallel with reluctance
(Rl) coupled with the ﬂow through the return gap. This is the reason why the
circuit of Figure 2.41(a) has 2Rg, the magnetic circuit, which is in series with
the stator. Figure 2.41(b) represents the ﬁrst circuit model that describes the
direction of the magnetic ﬂux (only one pole pair).
Permanent magnets are represented by sources with their respective reluc-
tance ﬂow in parallel. The metallic inner part of the rotor, the air gap, and the
stator are represented as reluctances, and the elements that make the circuit
are: Rm, is the reluctance of the magnet, Rs, is the reluctance of the stator,
g, is the air gap reluctance, and Rr, is the reluctance of the metal part of the
rotor.
The airgap ﬂux can be written in terms of the total ﬂow Φg = klΦr where
Kl is known as factor binding, usually close to 1. Thus, we can eliminate the
air-gap ﬂux and simplify the magnetic circuit by removing Rl, then you can
add Rs, Rr, and 2RG, since they are in series and the magnets can be repre-
sented by one in parallel with a resistor of 2WD value, shown in Equation 2.50.
Considering also that the reluctance of the air gap is greater than the stator
and rotor, then we can simplify these two reluctances representing circuit (Rr
and Rs) as factor Kr reluctances, multiplying the air gap reluctance Rg. Kr
is typically slightly larger than 1. With the simpliﬁed circuit Figure 2.41(b),

102
2 Power ﬂow basics
the ﬂow link is as follows:
Φ =
2Rm
2Rm + 2KrRg
=
1
1 + Kr
Rg
Rm
[Wb].
(2.51)
If we substitute the value of reluctances
Rm =
lm
µRµ0Am
,
Rg =
g
µ0Ag
[A −turns],
(2.52)
where lm is the magnetic length, µR is the relative permeability, µ0 the per-
meability of vacuum, Am is the magnetic cross-sectional area, and g and Ag
are the distance of the gap and the area of the air gap, respectively. Also, con-
sider that the airgap ﬂux is a part of the total ﬂux Φ, obtaining the following
expression:
Φg = KlΦr =
Kl
1 + Kr
Rg
Rm
Φr [Wb].
(2.53)
Equation 2.53 describes the link ﬂow engine. Taking into account that
there is more than one winding, the expression of the total ﬂow is
λ = NΦg [Wb −turns].
(2.54)
Equation 2.53 depends only on the angular position of the motor. In Fig-
ure 2.42(a), the magnetic ﬂux of the magnet pole is opposite to that generated
by the stator winding sense, so that the ﬂow is equal to λ = −NΦg. Moreover,
in Figure 2.42(b), the stator is 90 electrical degrees, so that the ﬂow goes in
and out, resulting in a ﬂow of λ = 0. Figure 2.42(c) shows that the ﬂux of the
rotor magnet coincides with that generated by the stator winding current, so
that ﬂow is λ = NΦg.
Considering that the ﬂow varies linearly with respect to the angular posi-
tion, we get the graph shown in Figure 2.43; for the induced EMF in Equa-
tion (2.53), we apply Faraday’s law.
In Figure 2.43(a), the waveform of inductive coupling is shown when it is
pursuing a counter electromotive force at π. The electromotive force opposes
the passage of electrical current in an inductor, in this case the rotor, which will
tend to slow down. In Figure 2.43(b), the square waveform of the electromotive
force due to the triangular waveform applied to the inductive coupling is shown
at π. If we consider the law of conservation of energy,
ebi = Tωn,
(2.55)
clearing the pair T of the expression,
T = ebi
ωn
= Keωni
ωn
= Kei.
(2.56)
This approach does not consider magnetic saturation in the material or

2.4 Mathematical models of electric machinery
103
Estator
Rotor
N
N
S
S
θe = 0
(a)
Estator
Rotor
N
N
S
S
θe = π/2
(b)
Estator
Rotor
N
N
S
S
θe = π
(c)
FIGURE 2.42
a) Motor with a fractional step, b) motor with 90◦E, c) motor with 180◦E
the energy necessary to re-align the magnetic domains, which are diﬀerent
groups of magnetic currents within a magnetic ﬁeld. A more realistic graph
of an engine is shown in Figure 2.44, where it can be seen that actually EMF
is trapezoid.
Traditional conductors have an electrical resistance that is proportional to
the length of the conductor and inversely proportional to the cross-sectional
area through which electric current ﬂows. In the case of electric motors, the
windings contain a varnish layer that isolates the cables and prevents shorting
of windings in the stator. Thus, the resultant electric resistance is equal to
R = ρl
A ,
(2.57)
where ρ is a constant known as electrical resistivity of the material, l is the

104
2 Power ﬂow basics
N Φg
-N Φg
π
π/2
2π
θe
λ
(a)
π
2π
θe
Eb
eb
(b)
FIGURE 2.43
a) Waveform of the inductive coupling in π, b) square waveform of the elec-
tromotive force
π
π/2
2π
N Φg
-N Φg
λ
Θe
(a)
π
2π
Θe
eb
(b)
FIGURE 2.44
a) Inductive coupling in its trapezoidal shape, b) electromotive force in its
trapezoidal shape
length of the conductor, and A is the cross sectional area of the conductor.
The electrical conductivity of the metals varies approximately linearly with
respect to temperature, thus
ρ(T) = ρ(T0) [a + α(T −T0)] ,
(2.58)
where α is the coeﬃcient of thermal resistivity and T0 is the base temperature.
The magnetic ﬂux is related to the current through a constant, modeled by
an inductance, so it should be included in the model brushless motor,
L = λ
i .
(2.59)
If we consider the magnetic circuit of Figure 2.45, we can notice that Fr
contains a value point “potential” of 0, then the circuit is balanced. Moreover,
each ﬂow Φ is equal to
Φ1 = Φ2 = Φ3 = Φ4 = Rg + Rm
(2.60)
so that the total ﬂow is
Φ1 + ΦN(2 + Φ3 + Φ4) =
NmN 2
i
Rg + Rm
λ.
(2.61)

2.4 Mathematical models of electric machinery
105
 
Ni
Ni
Ni
Ni
Rm
Rm
Rm
Rm
Rg
Rg
Rg
Rg
φ1
φ2
φ3
φ4
Fr
FIGURE 2.45
Magnetic circuit
Thus, the inductance is equal to
L =
NmN 2
i
Rg + Rm
λ.
(2.62)
2.4.4
Brushless exercise
Using three diﬀerent methods, this system will be used in the next exercise to
simulate a turbine; thus, it will be able to track diﬀerent speed changes. Check
that the power is oﬀbefore connecting. It is necessary to have a brushless
control and a brushless motor.
Switch the Power ON and check the LEDs Mains and OK. If the LED
OK is oﬀ, check the green cable connection to the brushless motor. Press the
combo box “control speed” and select ANALOG, always press “apply” to
conﬁrm every change, as shown in Figures 2.46 and 2.47.
FIGURE 2.46
Digital control speed display

106
2 Power ﬂow basics
Press the “Torque” and “Enable” buttons to enable the torque to the shaft.
Set the knob to the minimum and set the “Volt” switch to the ON position,
as shown in Figure 2.47
FIGURE 2.47
Analog control speed
Adjust the speed by varying the knob Volt. Check the actual speed on the
graphic. Reduce the speed to 0 [rpm] and switch OFF the level of the analog
control, as shown in Figure 2.47.
FIGURE 2.48
Software driven control speed
Press the combo box “control speed” and select SOFTWARE and then
press Apply to conﬁrm (see Figure 2.48).
Press the “Control Type” combo box to select “Speed control”. Press the
“Set Ramp” combo box to select “Trapezoidal”. Set the acceleration/deceler-
ation proﬁles to 0, which implies a slow speed increase toward the speed set
point.
Increment the acceleration by using the buttons INC & DEC. Connect the
three-phase induction generator and check the mechanical parameters.
Measure the Mechanical power with the load to determine the power loss.
Type in the red block the speed at < 3000 and check the speed plot. Observe
the time delay of the actual speed with respect to the target speed. A similar
graph is shown in Figure 2.50.

2.5 Theoretical problems
107
FIGURE 2.49
Actual speed
FIGURE 2.50
Speed graph
2.5
Theoretical problems
Problem 2.1. Figure 2.51 shows a conductor moving with a velocity of
10 [m/s] to the right in a magnetic ﬁeld. The ﬂux density is 0.5 [T], out
of the page, and the wire is 1 [m] in length, oriented as shown. What are the
magnitude and polarity of the resulting induced voltage?
Solution 2.1. The direction of the quantity v × B is down. The wire is not
oriented on an up-down line, so choose the direction of l as shown to make
the smallest possible angle with the direction of v × B. The voltage is positive
at the bottom of the wire with respect to the top of the wire. The magnitude
of the voltage is
eind = (v × B) ˙I
= (vBsin90◦)/cos30◦
= (10m/s)(0.5T)(1m)cos30◦
= 4.33 [V ].

108
2 Power ﬂow basics
+
-
eind
i
v
. . . . . .
. . .  
 
.
. .  
 
. .
.  
 
. . .
. . . . . .
. . . . . .
v x B
FIGURE 2.51
Movement of a conductor
Problem 2.2. Figure 2.52 shows a coil of wire wrapped around an iron core.
If the ﬂux in the core is given by the equation Φ = 0.05sin377t [Wb], and if
there are 100 [turns] on the core, what voltage is produced at the terminals of
the coil? Of what polarity is the voltage during the time when ﬂux is increasing
in the reference direction shown in the ﬁgure? Assume that all the magnetic
ﬂux stays within the core (assume that the ﬂux leakage is zero).
FIGURE 2.52
Wire wrapped around an iron core

2.5 Theoretical problems
109
Solution 2.2. The direction of the voltage while the ﬂux is increasing in the
reference direction must be positive to negative. The magnitude of the voltage
is given by:
eind = N dΦ
dt
= 377t0.05sin(100turns) d
dt
= 1885cos377t,
or alternatively,
eind = 1885sin(377t + 90◦) [V ].
Problem 2.3. Find the relative permeability of the typical ferromagnetic ma-
terial at H = 50 [A −turns/m].
Solution 2.3. The permeability of a material is given by
µ = BH,
and the relative permeability is given by
µr = µ
µ0
.
Thus, it is easy to determine the permeability at any given magnetizing
intensity. At H = 50 [A −turn/m] and B = 0.25 [T], so
µ = BH =
0.25 [T]
50 [A −turn/m] = 0.005
H
m

,
and
µr = µ
µ0
=
0.005
 H
m

4π × 10−7  H
m
 = 3980.
Problem 2.4. A square magnetic core has a mean path length of 55 [cm] and a
cross-sectional area of 150 [cm2]. A 200 [turn] coil of wire is wrapped around
one leg of the core. The core is made of a material that has a magnetizing
intensity of H = 115 [A −turn/m]. How much current is required to produce
0.012 [Wb] of ﬂux in the core?
Solution 2.4. The required ﬂux density in the core is
B = ΦA = 1.012 [Wb]
0.015 [m2] = 0.8 [T].
The magnetomotive force needed to produce this magnetizing intensity is
F = HLc = (115 [A −turn/m])(0.55 [m]) = 63.25 [A −turn].
So the required current is
i = F/N = 63.25[A −turn]
200 [turn] = 0.316 [A].

110
2 Power ﬂow basics
Problem 2.5. From Problem 2.4, calculate the core’s relative permeability at
that current level and its reluctance.
Solution 2.5. The core’s permeability at this current is
µ = BH =
0.8T
115A −turns/m = 0.00696H
m.
Therefore, the relative permeability is
µr = µ
µ0
=
0.00696H/m
4π × 10−7H/m = 5540.
The reluctance of the core is
R = F
Φ = 63.25A −turns
0.012Wb
= 5270
A −turns
Wb

.
2.6
Homework problems
Problem 2.6. Suppose there is a one-phase transformer that exhibits the
following results after performing open-circuit and short-circuit tests:
• OC: V = 120∠0◦[Vrms], I = 0.169∠−89.98◦[Arms]
• SC: V = 5∠0◦[Vrms], I = 12.501∠−16.259◦[Arms], and I(1)
out = 12.5∠−
16.248◦[Arms]
Estimate all transformer parameters with respect to its primary side. The
short-circuit measurements are given regarding the primary side as well. Pre-
serve calculation precision up to the thousandth.
Solution 2.6. Note: Rounding heavily aﬀects these results.
The open circuit test reveals a direct relation for the ﬁrst mesh as follows:
120
0.1693∠−89.98◦= R1 + j(X1 + Xm) = 0.248 + j710.059 [Ω].
So, R1 = 0.248 [Ω] and X1 + Xm = 10.0597 [Ω].
The short-circuit measured magnitudes can provide the missing informa-
tion through the following mesh analysis:
5 = i1(R1 + jX1) + jXm(i1 −i(1)
2 )
0 = i2(R(1)
2
+ jX(1)
2 ) + jXm(i(1)
2
−i1)
X1 + Xm = 710.059.
So, using the ﬁrst and third equation together with short-circuit data:
L1 = 146 [µH],
and
Lm = 1.883 [µH].

2.6 Homework problems
111
The voltage through Xm can be easily calculated as VXm = jXm(i1−i(1)
2 ) =
1.846∠6.367◦, so the second mesh impedance can be easily computed as: R(1)
2 +
jX(1)
2
= VXmi(1)
2
= 0.136 −j0.056 [Ω].
So: R(1)
2
= 0.136 [Ω], and L(1)
2
= 151 [µH].
Problem 2.7. Take the transformer from Problem 2.6 and assume that, to-
gether with the open-circuit and the short-circuit measured values, the DC
resistances were also acquired:
• R1 = 0.25 [Ω], R2 = 0.268 [Ω]
Estimate the missing impedances and compare the results with those from
Problem 2.6, considering the transformer’s ratio is 1:2.
Solution 2.7. The open-circuit test can yield the value of X1 and Xm directly.
As the resistance is known, only the imaginary part of the equation provides
new information: Im( 120
i1 ) = 710.059 [Ω] = X1 + Xm. The real part does
not match with the measured resistance. Such remainder is due to numeric
approximation issues.
For the short-circuit situation, the equivalent circuit can be solved through:
5 = i1(R1 + jX1) + jXm(i1 −i(1)
2 )
0 = i2(R(1)
2
+ jX(1)
2 ) + jXm(i2(1) −i1)
X1 + Xm = 710.059
So, all the three inductances can be solved directly (remember to use R(1)
2
instead of R2) X1 = 659 [µΩ] + jω204.8 [µH], Xm = 659 [µΩ] + jω1.88 [H],
X2(1) = 362 [µΩ] + jω204.9 [µH].
Regarding the ﬁrst problem, there are some diﬀerences regarding the values
of the inductances. Notice that those diﬀerences are due to numerical preci-
sion, so conclusively, the common tests performed on transformers require high
measuring precision and calculation consistency.
Problem 2.8. Assuming a transformer with the following parameters, draw
the RMS value of the output voltage, from 1/3 to 3 times its nominal power
value.
• V = 120 [Vrms], Vout = 240 [Vrms], Pn = 1500 [V A]
• R1 = 0.25 [Ω], L1 = 148.5 [µH], Lm = 1.88 [H]
• R2(1) = 0.134 [Ω], L2(1) = 148.5 [µH]
Estimate the missing impedances and compare the results with those from
the ﬁrst problem, considering the transformer’s ratio is 1:2.

112
2 Power ﬂow basics
FIGURE 2.53
Voltage - Power curve
Solution 2.8. The circuit equivalent of the transformer can be used to ﬁnd
its eﬃciency for some set of output loads. The equations that depict such
interaction are as follows:
V = i1(R1 + jωL1) + jωLm(i1 −i(1)
2 ),
0 = i(1)
2 (R(1)
2
+ R(1)
L + jωL(1)
2 ) + jωLm(i(1)
2
−i1),
where R(1)
L
is the load resistance seen from the primary. By sweeping through
diﬀerent resistance values, the following curve can be drawn:
Notice that there is a loss of about 5 [V ] when the transformer is consuming
1500 [W]. Such loss is seen as a 10 [V ] loss if seen from the secondary winding.
Problem 2.9. Some self-made inductance has a circular sectional area of
49 [mm2] and is made of iron (6.3 × 10−3  H
m

), and a mean path length of
l = 5 [cm]. How many turns are required to generate a 3 [mH] inductance?
Solution 2.9. B = Φ
A, and L = NΦ
i , so B =
Li
NA.
In addition, F = Ni = Hl, so
B
H =
Ll
N2A = µ, and ﬁnally
L(N) = µN2A
l
= (6.3×10−3)(49×10−6)N 2
0.05
= 6.17 × 10−6N 2.
So, for a 3 [mH] inductance, only 22 [turns] are needed.
Problem 2.10. How strong will the ﬂux be if a current of 3 [A] is passed
through a 3 [mH] cylindrical inductance (r = 7 [mm], l = 5 [cm]), made with
electrical steel (5 × 10−3  H
m

)? Do not consider saturation.
Solution 2.10. B = Φ
A, L = NΦ
i
∴B =
Li
NA.
F = Ni = Hl ∴H = Ni
l .
µ = B
H =
Li
NAH =
Ll
N2A.
As N = Li
Φ , µ =
Ll
( Li
Φ )2A =
lΦ2
Li2A ∴Φ =
q
µLi2A
l
.
Substituting: Φ =
q
(5×10−3)(3×10−3)(9)(154×10−6)
0.05
= 644.8 × 10−6 [Wb].

2.7 Simulation
113
FIGURE 2.54
Resulting hysteresis curve
2.7
Simulation
2.7.1
Transfomers programs
Problem 2.11. Hysteresis test
Plot the hysteresis phenomena of a monophasic transformer, with the fol-
lowing features: V = 120 [V ], V = 24 [V ], and I = 1.2 [A]. The measurement
of voltage and current of transformer are in the ﬁles “CurrentTransformerFil-
Pas.csv” and “VoltageTransformaderInteger.csv,” respectively. The MATLAB
program has been developed to get hysteresis phenomena in a plot and the code
is shown below.
Solution 2.11. After running the code, the resulting plot should be as shown
in Figures 2.54 and 2.55.
clc , clear;
% Read Data
data_corriente = csvread('CurrentTransformerFilPas .
csv', 9, 0)
data_voltage = csvread('VoltageTransformaderInteger .
csv', 9, 0)

114
2 Power ﬂow basics
-0.02
-0.01
0
0.01
0.02
Time (s)
-40
-20
0
20
40
Voltage (V)
Voltage Output Transformer
-0.02
-0.01
0
0.01
0.02
Time (s)
-0.03
-0.025
-0.02
-0.015
-0.01
Current (A)
Current Input Transformer
FIGURE 2.55
Resulting voltage and current
var1 = data_corriente (170:1956 ,1);
var2 = data_corriente (170:1956 ,2);
var3 = data_corriente (170:1956 ,3);
var4 = data_corriente (170:1956 ,4);
var5 = data_voltage (170:1956 ,1);
var6 = data_voltage (170:1956 ,2);
var7 = data_voltage (170:1956 ,3);
var8 = data_voltage (170:1956 ,4);
% Plot
Hystesis
figure
ax1 = subplot (2,1,1);
ax2 = subplot (2,1,2);
% Voltage
Output
Transformer
plot(ax1 ,var1 ,var2)
title(ax1 ,'Voltage
Output
Transformer ')
ylabel(ax1 ,'Voltage (V)')
xlabel(ax1 ,'Time (s)')
% Current
Input
Transformer

2.7 Simulation
115
plot(ax2 ,var1 ,var3)
title(ax2 ,'Current
Input
Transformer ')
ylabel(ax2 ,'Current (A)')
xlabel(ax2 ,'Time (s)')
% Plot
Results
figure
axy1 = subplot (2 ,2 ,[1 ,3]);
axy2 = subplot (2,2,2);
axy3 = subplot (2,2,4);
% Hysteresis
Transformer
plot(axy1 ,var4 ,var8)
title(axy1 ,'Hysteresis in Transformer ')
ylabel(axy1 ,'Voltage (V)')
xlabel(axy1 ,'Current (A)')
% Integration of signal
Voltage
Output of Transformer
plot(axy2 ,var5 ,var8)
title(axy2 ,'Integration of signal
Voltage
Output of
Transformer ')
ylabel(axy2 ,'Voltage (V)')
xlabel(axy2 ,'Time (s)')
Problem 2.12. Parameters’ determination test
Through a short-circuit test and open-circuit test, get the parameters of a
transformer that operates with windings and core at normal operating temper-
atures, these tests are to 480 −240 [V A] and 25 [kV A]. The next MATLAB
program has been developed to get the parameters of the transformer.
% open -circuit & short -circuit
test
clear;
V1 =480; V2 =240; n=V1/V2;
% Rated
voltage
values
Vsc =37.2; Isc =51.9; Psc =750;
% Test data
Voc =240; Ioc =9.7; Poc =720;
% dc resistance of windings - if not known , set R1dc=
R2dc =1
R1dc =0.110;
R2dc =0.029;
Voc=n*Voc; Ioc=Ioc/n;
Req=Psc/Isc ^2; R1=R1dc; R2=Req -R1dc;
Zsc=Vsc/Isc; X1=sqrt(Zsc^2-Req ^2) /2; X2=X1/n^2;
Rc=Voc ^2/ Poc; Xm=Voc/sqrt(Ioc^2-(Voc/Rc)^2);
disp(' '); disp (['
TRANSFORMER
EQUIVALENT
CIRCUIT
PARAMETERS - ',...
date ]);

116
2 Power ﬂow basics
disp('
Classical
Data
Reduction ');
disp(' '); disp(' ')
disp ([ blanks (3) 'R1(ohm)' blanks (8) 'R2(ohm)' blanks
(8) 'X1(ohm)' ...
blanks (8) 'X2(ohm)']);
disp ([ blanks (3)
num2str(R1) blanks (9)
num2str(R2) ...
blanks (8)
num2str(X1) blanks (9)
num2str(X2)]);
disp(' ');
disp ([ blanks (3) 'Rc(ohm)' blanks (8) 'Xm']);
disp ([ blanks (4)
num2str(Rc) blanks (8)
num2str(Xm)]);
% Refinement of data
reduction
thetoc=acos(Poc/Voc/Ioc); Eoc=abs(Voc -(R1+j*X1)*Ioc*
exp(-j*thetoc));
Poc=Poc -Ioc ^2*R1; Qoc=Voc*Ioc*sin(thetoc)-Ioc ^2*X1;
Rc=Eoc ^2/ Poc; Xm=Eoc ^2/ Qoc;
thetsc=acos(Psc/Vsc/Isc); Esc=abs(Vsc -(R1+j*X1)*Isc*
exp(-j*thetsc));
Psc=Psc -Esc ^2/Rc; Qsc=Vsc*Isc*sin(thetsc)-Esc ^2/Xm;
Req=Psc/Isc ^2; R1=Req*R1dc /( R1dc+n^2* R2dc); R2=(Req -
R1)/n^2;
X1=Qsc/Isc ^2/2; X2=X1/n^2;
disp(' '); disp (['
TRANSFORMER
EQUIVALENT
CIRCUIT
PARAMETERS - ',...
date ]);
disp('
Refined
Data
Reduction ');
disp(' '); disp(' ')
disp ([ blanks (3) 'R1(ohm)' blanks (8) 'R2(ohm)' blanks
(8) 'X1(ohm)' ...
blanks (8) 'X2(ohm)']);
disp ([ blanks (3)
num2str(R1) blanks (9)
num2str(R2) ...
blanks (8)
num2str(X1) blanks (9)
num2str(X2)]);
disp(' ');
disp ([ blanks (3) 'Rc(ohm)' blanks (8) 'Xm']);
Problem 2.13. Cost analysis
Analyze the diﬀerence between a low-cost transformer and a loss-optimized
transformer, making the following assumptions:
• The transformers are operated continuously.
• The transformers operate at partial load, but this partial load is constant.
• Additional cost and inﬂation factors are not considered.
• Demand charges are based on 100% load

2.7 Simulation
117
The total cost of owning and operating the transformer for one year is thus
deﬁned as follows:
• Capital cost (Cc), taking into account the purchase price (Cp), the interest
rate (p), and the depreciation period (n).
• Cost of no-load loss (CP 0), based on the no-load loss (P0)and energy cost
(Ce).
• Cost of load loss (CP k), based on the load loss(Pk), the equivalent annual
load factor (a) and energy cost (Ce).
• Cost resulting from demand charges (Cd), based on the amount set by the
utility and the total kW of connected load.
The next MATLAB program have been developed for analyzing a low-cost
transformer and a loss-optimized transformer.
clc;
clear;
% Transformer
Loss
Evaluation
% Distribution
tranformer
whith a low -cost
transformer
% Data:
%
Depreciation
period
n = 20
years
%
Interest
rate
p = 12 %
p.a.
%
Energy
charge
Ce = 0.25
Euro/kWh
%
Demand
charge
Cd = 350
Euro /(kW.year)
%
Equivalent
annual
load
factor
alpha =
0.8
% Cc
Capital
Cost
% where:
%
Cp
Purcharse
price
%
r
Depreciation
factor
%
q
Interest
factor
%
p
Interest
rate
%
n
Depretation
period
n = 20;
% Years
p = 12;
% 12% p.a.
Ce = 0.25;
% Euro/kWh
Cd = 350;
% Euro /(kW.year)

118
2 Power ﬂow basics
alpha = 0.8;
% Equivalent
annual
load
factor
Po = 19;
% kW No -load loss
Pk = 167;
% kW Load loss
Cp = 521000;
% Purcharse
price
($)
q = p/(100) +1
r = (p*(q^n))/((q^n) -1)
Cc = (Cp*r)/100
% Capital
cost per year ($/ year)
% Cpo
Cost of no -load loss
% Ce
Energy
Cost
% where
8760 are hours in a year (hr/year)
% Po
No -load loss
Cpo = Ce *8760* Po
% Cost of no -load loss ($/ year)
% Cpk
Cost of load loss
% Pk
Load loss
% a
annual
load
factor
Cpk = Ce *8760*( alpha ^2)*Pk
% Cost of load loss ($/
year)
% CD
Cost
resulting
from
demand
charge
% Cd
Demand
charges
amount /(kW*year)
CD = Cd*(Po+Pk)
% Cost
resulting
from
demand
charge ($/ year)
% Total
cost of owning and
operating
this
transformer
Total_Low = Cc+Cpo+Cpk+CD.
clc;
clear;
% Transformer
Loss
Evaluation
% Distribution
tranformer
whith a loss -optimized
transformer
% Data:
%
Depreciation
period
n = 20
years
%
Interest
rate
p = 12 %
p.a.

2.7 Simulation
119
%
Energy
charge
Ce = 0.25
Euro/kWh
%
Demand
charge
Cd = 350
Euro /(kW.year)
%
Equivalent
annual
load
factor
alpha =
0.8
% Cc
Capital
Cost
% where:
%
Cp
Purcharse
price
%
r
Depreciation
factor
%
q
Interest
factor
%
p
Interest
rate
%
n
Depretation
period
n = 20;
% Years
p = 12;
% 12% p.a.
Ce = 0.25;
% Euro/kWh
Cd = 350;
% Euro /(kW.year)
alpha = 0.8;
% Equivalent
annual
load
factor
Po = 16;
% kW No -load loss
Pk = 124;
% kW Load loss
Cp = 585000;
% Purcharse
price
($)
q = p/(100) +1
r = (p*(q^n))/((q^n) -1)
Cc = (Cp*r)/100
% Capital
cost per year ($/ year)
% Cpo
Cost of no -load loss
% Ce
Energy
Cost
% where
8760 are hours in a year (hr/year)
% Po
No -load loss
Cpo = Ce *8760* Po
% Cost of no -load loss ($/ year)
% Cpk
Cost of load loss
% Pk
Load loss
% a
annual
load
factor
Cpk = Ce *8760*( alpha ^2)*Pk
% Cost of load loss ($/
year)
% CD
Cost
resulting
from
demand
charge

120
2 Power ﬂow basics
% Cd
Demand
charges
amount /(kW*year)
CD = Cd*(Po+Pk)
% Cost
resulting
from
demand
charge ($/ year)
% Total
cost of owning and
operating
this
transformer
Total_Loss = Cc+Cpo+Cpk+CD
2.7.2
Synchronous generator
It is important to be familiar with those electrical eﬀects dependent on elec-
tric machinery which, in a broader sense, are required to understand their
performance while connected to an electric network. A synchronous machine
(see Figure 2.56), for example, can be evaluated as a stand-alone device to
understand the eﬀects of varying the input mechanical power or the voltage
ﬁeld in terms of output voltage. If the machine is later connected as a gener-
ator whose voltage is leaded by the inﬁnite bus, no variations of voltage will
occur, but of power.
If the generator’s behavior is known, its integration to a complex grid will
be transparent to the electrical engineer and undesired eﬀects will be avoided.

2.7 Simulation
121
FIGURE 2.56
Power manipulation through a synchronous generator


3
Hydroelectricity
Generation of electricity based on water power is called hydroelectricity. Water
potential or kinetic energy can be used to this purpose due to water height or
ﬂow, respectively [33]. About 99% of world energy is produced from primary
sources, which are water, fossil fuel, and nuclear fuel [32, p. 53], making hy-
droelectricity paramount in overall energy usage. Hydroelectric generation can
be broadly separated into conventional hydroelectric technologies and emerg-
ing hydrokinetic technologies; new techniques involve ocean tidal currents,
wave energy, and thermal/salinity gradients in water, and represent a small
but promising full-renewable energy source. On the other hand, conventional
methods guarantee high energy production but have negative consequences
on the ecosystem [57, p. 98].
As energy generation depends on the water cycle, numerous factors aﬀect
a hydroelectric power plant: rainfall intensity, the location’s topography, etc.
[33, p. 177]. Water is also required for crops, cattle, human consumption, and
ecosystem balance, so a power plant’s establishment and management imply a
high-resources exhaustive-planning project. Besides those restrictions, hydro-
electric plants have an average lifetime of 50 years, require no fuel, have low
operation/maintenance costs, represent a negligible contribution to air pollu-
tion, and allow parallel operation, such as navigation, ﬂood control, irrigation,
etc. [33, p. 180]. Conventional hydroelectricity is one of the least expensive
power plants; however, the change in environmental conditions have disabled
many prime water sources [57, p. 98].
Hydroelectricity is considered to be renewable, as it depends on the ever-
lasting water cycle; nonetheless, many variables must be taken into account
since changes in water supply for a given location can decrease performance.
Environmental drawbacks are varied and some of them are severe; the ef-
fects due to a hydroelectric power plant are not consistent with sustainability
premises, and activists look forward to forcing removal of dams and returning
rivers to their free-running conditions [57, p. 103].
Only conventional hydroelectric power plants are considered in this chap-
ter, as they provide large amounts of energy to actual energy distribution in-
stallations, while emerging technologies are mostly low-power proposals that
are rarely integrated in real distribution systems [57, pp. 99–103].
123

124
3 Hydroelectricity
3.1
Overall characteristics and operation
Hydroelectric plants’ basic operating principle implies the utilization of the
accumulated potential energy due to a raised water body as a high-pressure
ﬂow when released [33, p. 177]. Whenever water is allowed to run from its
initial position to a lower one, potential energy (proportional to the height
diﬀerence between initial to ﬁnal points) will be converted into kinetic energy;
a high-energy ﬂow can then propel an electrical turbine permitting electric
generation from mechanical energy [32, p. 53]. Some variations can also achieve
energy generation from low height diﬀerences by managing a river ﬂow [32,
p. 54].
Hydroelectric power plants can be classiﬁed under three diﬀerent categories
[32, pp. 53–54]:
• Impoundment hydroelectric: Most common type, large generation capacity,
needs a big raised reservoir behind the dam
• Diversion hydroelectric: Manages the river ﬂow (tide) to propel the tur-
bine, does not need a reservoir, low generation capacity
• Pump storage hydroelectric: Similar to impoundment hydroelectric, pumps
water back to the reservoir when demand is low for later use
They can also be classiﬁed by their power generation capacity as [35,
p. 103]:
• Micro: Generates less than 100 [kW]
• Small: From 100kW to 30 [MW]
• Large: Greater than 30 [MW]
Other alternative classiﬁcations are made about ﬂow control, load condi-
tions, and head altitude [33, pp. 214–218].
Impoundment hydroelectric generators (Figure 3.1) use the most basic op-
eration principle, as they are based on converting potential energy of raised
accumulated water into a quick ﬂow to move a generator’s propeller. There are
six fundamental components in this type of power plant: dam, reservoir, pen-
stock, turbine, generator and governor [32, p. 55]. Other secondary elements
are machine room, internal pipelines, and oscillation tanks [33, p. 183].
The dam is the concrete wall that holds the water in the reservoir and
allows potential energy to be accumulated. In order to move the turbine at-
tached to the generator, the governor (control valve) must allow the water
to ﬂow through the penstock; once the water has completed its trajectory, it
is released to the outlet, which is an open water body. The head represents
the height diﬀerence between the reservoir surface and the water outlet. This

3.1 Overall characteristics and operation
125
Governor
Dam
Reservoir
Penstock
Generator
Transformer
Transmision lines
Outlet
d
a
e
H
FIGURE 3.1
Impoundment hydroelectic power plant representation
measurement is useful to calculate total potential energy; however, due to en-
ergy losses in the penstock, an eﬀective head is often considered to include
eﬀects of friction and turbulence [35, p. 101].
The way in which rivers and lakes are connected along the whole water
path from the mountain top to the sea oﬀers many opportunities to install
hydroelectric plants as it goes downhill. Total water height (and thus, total
potential energy) can be seized by successive dams in order to take full ad-
vantage of the same water body. Terrain’s topography and path’s conditions
are paramount if dams are planned to be located this way. Generated elec-
tric energy of an impoundment power plant depends on some key parameters,
such as the water behind the dam, reservoir capacity, ﬂow rate of the water
inside the penstock, and the eﬃciencies of penstock, turbine, and generator
[32, p. 57].
Example dimensions of two large impoundment hydroelectric plants are
shown in Table 3.1. The Three Gorges dam in China is 22.5 [GW] power
capacity rated, while the Grand Coulee dam in Washington is 7.0 [GW]. Both
plants are large; nonetheless, their physical sizes are quite diﬀerent.
Short term projects (2020) include the expansion of conventional hy-
dropower and the technology deployment of design-enhanced turbines to im-
prove ﬁsh passage and water quality; furthermore, medium term projects
(2035) foresee a higher use in emerging technologies focusing on avoiding
ecosystem damages, while in the long term (>2035), depending on technology
improvements, large-scale installations of emerging technologies are expected,
as well as their integration to the main grid; however, large scale projects are

126
3 Hydroelectricity
TABLE 3.1
Example features of two large impoundment hydroelectric plants [32, p. 56]
Feature
Grand Coulee
Three Gorges
Length of dam [km]
1.6
2.34
Height of dam [m]
170
185
Width at river base [m]
150
115
Width at crest [m]
9
40
Volume of concrete [m3]
9.16 × 106
28 × 106
Surface area of reservoir
behind dam [km2]
320
72, 128
those implying deployment in issues related to workforce, capital, and other
industrial matters [57, pp. 101–103].
A hydroelectric power plant needs two main analyses to plan and man-
age electric load capabilities. Hydrology allows the total water ﬂow into the
reservoir to be known, considering rainfall, evaporation, and water runoﬀ.
Hydrography studies water ﬂow variations due to rainfall patterns, and the
location’s geology and topography, vegetation, and atmospheric conditions
[33, pp. 189–191].
Water runoﬀ= total rainfall −evaporation
(3.1)
As the reservoir’s head depends on water runoﬀ, its ﬂow [m3/time] must
be analyzed for at least 20 years to precisely know its energy capacity. The
minimum ﬂow and reservoir’s size determine the primary available power,
which is the power the plant can provide constantly. Secondary power repre-
sents the possible energy ﬂow under runoﬀsurplus and determines the outlet
drain dimensions. Average water ﬂow helps in deciding plant’s nominal power
[33, p. 190].
Figure 3.2 represents hydrographic analyses’ results compared to expected
demand line. The months April, May, October, and November present runoﬀ
deﬁciencies that would make the plant provide suboptimal operation, and
the energy demand would be unreached. This is the main reason why a dam
is built: to provide an artiﬁcial water reservoir that can accumulate water
surpluses from other months. The total reservoir capacity, then, must be cal-
culated based on expected deﬁciencies and a risk factor that provides a safety
gap for continuous operation.
The reservoir must provide enough water to cover deﬁciencies; however,
it does not need a capacity for holding the total surplus as the water can
be allowed to run free in case of overpassing. According to the examples
given in Figure 3.2 and Figure 3.3, the power plant will need water reserves
33.3% of the year. Both deﬁciency blocks imply a lack of 400 [m3/s] and
500 [m3/s], respectively; nonetheless, they can be covered with past months’

3.1 Overall characteristics and operation
127
0
500
1000
1500
2000
J 
F 
M 
A 
M 
J 
J 
A 
S 
O 
N 
D
Months
Water runoﬀ [m /s]
3
FIGURE 3.2
Water runoﬀexample graph
surpluses. The reservoir must at least hold 200 [m3/s-month] for October and
300 [m3/s-month] for November, which results in a total minimum capacity of
1.31 × 109 [m3]. However, power consumption is not constant and in this case
has been only estimated as a mean demand value; moreover, hydrographical
data is not the same every year and the reservoir must be prepared to hold a
bigger amount of water. Previous calculations were only demonstrative.
Considering the mean water load value of the previous example, a prelim-
inary nominal power value can be assigned to the impoundment hydroelectric
plant. Assume the plant’s head is 90 [m], with 20% in losses due to friction,
turbulence, and generator eﬃciency,
Wn = mghη = δQghη,
(3.2)
where m is the mean mass ﬂow, calculated as water density by its mean ﬂow
(δQ), g stands for gravity acceleration, h is the dam’s head, and η the eﬃ-
ciency. Using Equation (3.2), a nominal average power of 759 [MW] can be
constantly provided by the plant during a whole year. Calculations shown be-
fore are very simple and obviously cannot represent the actual characteristics
of a plant; nevertheless, they can approximately oﬀer some values to show
how large a plant is and how powerful. The previous procedure is similar to
the one shown by Enr´ıquez [33, pp. 193–199].
The power plant energy losses are due to penstock friction and turbu-
lence, and turbine and generator eﬃciencies. Particularly speaking, turbines
are normally rated over 90% eﬃcient under full charge condition and can run
from 100 [rpm] and 1000 [rpm] [33, p. 219]. Depending on their construction,
they can be classiﬁed as impulse or reaction turbines. Impulse turbines (Fig-
ure 3.4(a)) rotate thanks to water receiving cups located all the way around

128
3 Hydroelectricity
0
20
40
60
80
100
600
700
800
900
1000
1100
1200
1300
1400
1500
1600
1700
1800
Water Load [m /s]
3
Time availability [%]
33.3%
Mean water load
Demand line
FIGURE 3.3
Water load through time example graph
the turbine axis. The momentum gained by each cup makes the runner turn
at constant speed if mechanical load equals the gained momentum through
time; regulation must be made by the governor valve in order to modify the
amount of water and its speed through turbine nozzles.
In order to prevent the water jet from arbitrarily splashing in the cup and
canceling the axial momentum of the runner, a diﬀerent design, which consid-
ers two attached cups (Figure 3.5), can be used so the reﬂected water takes
a known path. The harnessed momentum equals mi(vi −vc), where subscript
i represents the water jet and c, the cup. On the other hand, the remaining
momentum (lost) is mr(vr + vc), where subscript r stands for reﬂected water.
Notice that both speeds are added as their direction is opposite; at last, the
total momentum acquired by the cup is the diﬀerence between the gained
momentum and the lost one. The mass of incoming water must be equal to
that of the reﬂected one as well as its speed [32, pp. 58–59].
∆M = 2mi(vi −vc)
(3.3)
From Newton’s second law, the equation above can yield to turbine power
as F = ∆M/t and P = Fvc. So, the power obtained from each cup can be
estimated under steady state conditions due to water pressure and power plant
design. If the power equation is derived in terms of the incoming water speed,
an optimal operation point can be obtained if vi = 2vc [32, p. 60]. Optimal

3.1 Overall characteristics and operation
129
C
u
p
 
B
u
c
k
e
t
s
Runner
Nozzle
Volute
Chamber
Water ﬂow
(a) Impulse turbine
High pressure water
Water
ﬂow
Blades
(b) Reaction turbine
FIGURE 3.4
Turbine types schematics
Cup
Cup
Water Jet
Reﬂected Jet
Reﬂected Jet
Cup speed
FIGURE 3.5
Improved cup design and water jets indication

130
3 Hydroelectricity
operation can be achieved at constant speed, also related to output frequency,
consistent with synchronous machine operation.
Impulse turbines take the water into the volute chamber, so that water jets
of pressure are injected from all of several nozzles, transferring momentum to
the turbine cups and moving the runner attached to the generator’s shaft.
Impulse turbines like Pelton turbines operate with big heads and a low
amount of water as the potential energy accumulated behind the dam is con-
verted to kinetic energy through the nozzles, i.e., the restricted nozzle output
permits high pressures in the volute chamber. Once used, water is directed to
the output drain [33, p. 222].
A reaction turbine like the one shown in Figure 3.4(b) is completely im-
mersed in water and its drain is located at the center, forcing the water ﬂux
to move the blades on its way down. The energy taken by the blades is the
diﬀerence between the input water energy minus the output water energy,
assuming this energy gap is absorbed by the blades [32, p. 62].
Many simpliﬁcations are done to calculate energy harnessing of a reaction
turbine. First, changes in volume or mass are considered to be zero, as well
as the water speed inside the turbine (as it is immersed in the water), so
kinetic energy is small compared to potential energy; secondly, output water
is considered to be at a very low pressure, letting the blade absorb E = PrV ,
where Pr stands for the incoming pressure from the penstock and V for the
volume of water in which the turbine is immersed. In this way, the developed
power can be written as P = PrV/t = Prf, where f is the water ﬂow [32,
pp. 63–65].
Some known reaction turbine designs are the Francis and Kaplan turbines,
the ﬁrst one being suitable for mid to high heads (80 [m] – 500 [m]) and the
second one for low heads (1.5 [m] – 80 [m]) [32, p. 65]. The output drain of
a reaction turbine is always placed deep in the water outage so stability of
water disposal can be achieved [33, p. 227]. Francis turbines are sensitive to
cavitation as the water spins inside the turbine body.
Another reaction turbine type is the Kaplan turbine, which is designed for
low heads and large amounts of water. It is capable of adjusting the blades’
orientation so that high eﬃciency can be obtained under diﬀerent load con-
ditions; the water passes axially through the turbine, hitting the blades as it
goes down to the drain outage, so no cavitation occurs [33, p. 229]. A summary
is oﬀered in Table 3.2, obtained from [33, p. 229].
The hydroelectric power ﬂow from the reservoir to the generator can be
seen in Figure 3.6. There are four main losses along the whole process, which
are penstock losses (friction and turbulence), hydro losses (turbulence and
viscosity), turbine losses (like those discussed above), and generator losses.
Every step in the power ﬂow process has an inherent eﬃciency that captures
the eﬀect of the total losses; consequently, the power delivered by the plant
considering an initial potential energy coming from the reservoir behind the
dam is [32, p. 68].

3.1 Overall characteristics and operation
131
TABLE 3.2
Turbine types summary
Type
Max.
Head [m]
Max. Power
[MW]
Max.
Diameter [m]
Francis
2000
>250
5.5
Pelton
500
>750
10
Kaplan
70
>225
10
Pout = Pinηpηhηtηg.
(3.4)
3.1.1
Exercises
Based on the nominal supply of 380 [VL-L] 60 [Hz], achieve a steady no-
load operating point for the hydroelectric generator. Attain desired frequency
by modifying the governor position using the SCADA system and set the
output voltage to 380 [V ] manually (without an automatic controller). Use
Diagram 3.1 for connections.
Speed [rpm]
Excitation
Voltage [V]
Attained
Frequency [Hz]
Attained
Voltage [V]
1820
80
60.1
380
Recommended equipment and connections:
• Synchronous generator
• Motor-driven power supply
• Module for measuring the electric power
If the generator is to be connected alone to some changing load (separated
from the inﬁnite bus), variations in performance are expected as load is mod-
iﬁed. Connect the hydraulic generator to resistive loads Y-Y and describe the
operating point changes due to resistive variations; assume a normal opera-
tion of 380 [VLL] 60 [Hz]. (First, take the generator to steady operation and
modify its excitation through the manual knob in the controller if needed.)
Recommended equipment and connections
• Synchronous generator
• Motor-driven power supply
• Module for measuring the electric power

132
3 Hydroelectricity


FIGURE 3.6
Power ﬂow of a hydroelectric plant
Diagram 3.1
Testing synchronous generator’s void operation

3.1 Overall characteristics and operation
133
Load level
Current
[mA]
Output Volt.
[VRMS]
Excitation
Volt. [V ]
Torque
[Nm]
No load
0
380
80
0.6
1
200
380
90.6
1.5
2
280
380
93
1.8
3
500
380
103
2.6
What happens if the current is taken over 500 [mA]? Why?
The generator decelerates and stops. Simulated water ﬂow cannot provide
enough torque to operate, so the relation between input mechanical power,
eﬃciency, and output electrical power cannot be attained.
• Resistive load
Make the hydraulic generator operate steadily at 380 [VL−L] 60 [Hz] at full
load conditions (lowest resistive load value possible) and measure delivered
power. Use Diagram 3.2 for connections. If the didactic generator is scaled
1:1000 and represents a hydroelectric power plant, answer and justify the
type of plant it would be, the needed water ﬂow at full-load conditions, and
the potential energy needed at the dam to attain an operation of 1 month (30
days) at maximum rating (estimate total losses to be of 20% and the head of
50 [m]).
Max. Power [W]
× 1000
Type
Water ﬂow [m3/s]
Energy [GJ]
332
332 [kW]
Small
0.846
860
Recommended equipment and connections
• Synchronous generator
• Motor-driven power supply
• Module for measuring the electric power
• Resistive load
• Maximum demand meter
Make the hydraulic generator operate steadily at 380 [VL−L] 60 [Hz] at
average load conditions and measure delivered power. Use Diagram 3.3 for
connections. If the didactic generator is scaled 1:1000 and represents a hy-
droelectric power plant, answer and justify the amount of water needed at
the reservoir to operate 3 months (90 days) without water runoﬀ, the type
of turbine needed for such a plant, and the average water ﬂux. Considering

134
3 Hydroelectricity
Diagram 3.2
Synchronous generator with resistive loads
Diagram 3.3
Instrumented operation

3.2 Integration with the inﬁnite bus
135
the average demand line, estimate the needed mean water load if a risk factor
of 20% is desired. Use a mean resistive value as the average consumption.
(Estimate total losses to be of 20% and the head of 50 [m].)
Without risk factor:
Avg Power
[W]
× 1000
Reservoir
[m3]
Turbine
Avg. water
ﬂux [m3/s]
189
189 [kW]
3.74 × 106
Kaplan
0.481
With risk factor:
Avg Power
[W]
× 1000
Reservoir
[m3]
Turbine
Avg. water
ﬂux [m3/s]
226.8
226.8 [kW]
4.49 × 106
Kaplan
0.577
3.2
Integration with the inﬁnite bus
Electric generators are rarely connected to a single load; in fact, they are
parallel added to a supply system called an inﬁnite bus or grid [68, p. 299].
The inﬁnite bus is formed by all generators connected together through trans-
mission lines to load centers and distribution transformers; obviously, all gen-
erators integrated into the power grid provide the same voltage magnitude
and frequency, provoking the inﬁnite bus to have very low variations as it is
sourced by many generators [68, p. 299]. It is present at main transmission
lines at high voltages of hundreds of kilovolts to maintain high eﬃciency power
distribution at 60 [Hz] (America) or 50 [Hz] (Europe).
Synchronous generators, as those in hydroelectric power plants, work at
tens of kilovolts, so transformers are needed to match the inﬁnite bus volt-
age; likewise, load centers like domestic or industrial facilities typically need
600/480/230/115 [V ], so various conversion transformer steps are needed to
lower the voltage provided. A representation of the inﬁnite bus is shown in
Figure 3.7.
If a generator is to be added to the inﬁnite bus, it must have the same
voltage amplitude, frequency, phase sequence, and phase [68, p. 300]. If any
of the preceding conditions is not met and the connection is done anyway, the
generating nature of the newly added alternator will not be respected, so it
can be seen as a load by the inﬁnite bus, and high risk is expected at generator
facilities, with disastrous consequences.
Phase sequence “is the time order in which the voltages pass through their

136
3 Hydroelectricity
Transformer
Transformer
Transformer
Transformer
Transformer
Transformer
Pole
transformer
Transformer
44 kV
4.16 kV
600/480 V
Industrial
230V
115V
Transformer
Transformer
Pole
transformer
Transformer
44 kV
4.16 kV
600/480 V
Industrial
230V
115V
Gen 1
Gen 2
Gen 3
Gen n
Inﬁnite Bus
230 kV
Load Center 1
Load Center m
FIGURE 3.7
Inﬁnite bus representation
respective maximum values” in a polyphase AC system [14, p. 507]. If the
phasor diagram of a three-phase system is assumed to rotate CCW (as its
phase voltage changes periodically) as shown in Figure 3.8, whether or not
an observer is placed in the position o, the maximum observed values will be
sequentially abc for the positive phase sequence and acb for the negative phase
sequence. The preceding reasoning implies that for a rotating generator, the
phase sequence can be modiﬁed only by interchanging two of its phases.
However, as polyphase systems’ phases are commonly labeled arbitrar-
ily, the connection of a generator to the inﬁnite bus cannot be made just
by matching phases’ names, and previous checking process is needed before
connection.
There is a method that easily shows if the previously mentioned conditions
are attained in order to achieve successful connection to the inﬁnite bus. The
synchronization lamps are literally lamps connected in parallel to the circuit
breaker, as shown in Figure 3.9.
Although speciﬁc equipment is used to conﬁrm the generator’s valid con-
ﬁguration in real plants, the method proposed in Figure 3.9 is an eﬀective
laboratory arrangement for connection validation. Diﬀerent equipment like a
synchronoscope (obsolete) or an automatic breaker can provide enough infor-
mation to decide the moment when the connection is made; some equipment
can actually connect the generator automatically when the sensed conditions
are suitable.
In order to attain proper connection conditions, diﬀerent synchronous gen-

3.2 Integration with the inﬁnite bus
137
Van
Vcn
Vbn
1
2
0
°
1
2
0
°
1
2
0
°
ω
o
Van
Vbvn
Vcn
1
2
0
°
1
2
0
°
1
2
0
°
ω
o
FIGURE 3.8
Positive and negative phase sequences
Generator
Prime
Mover
Breaker
Synch Lamps
A
B
C
Vb
Vg
FIGURE 3.9
Schematic of integration of a generator to the inﬁnite bus

138
3 Hydroelectricity
erator parameters need to be adjusted: shaft speed, ﬁeld current, and phase
sequence. The shaft speed shall be adjusted so the output voltage frequency
is 60/50 [Hz]; similarly, the ﬁeld current must be set so both Vb and Vg read
the same; if the phase sequence or phase are not correct, the lamps will never
hold a brightness level [68, p. 301].
There are four possible scenarios considering Figure 3.9 as described by
Sen [68, pp. 301–303]. The following list assumes all other parameters are the
same; obviously, if all voltages are exactly the same all lamps would be totally
oﬀ.
1. Voltages are diﬀerent
All lamps’ brightness will be steady and equal. Adjustments must be made
in the generator’s ﬁeld current.
2. Frequencies are diﬀerent
All lamps brighten and darken simultaneously (change speed depends on
how diﬀerent the frequencies are). Shaft speed must be modiﬁed by using
the prime mover (Coaxial electric machine connected to the shaft of the
generator — Figure 3.9) of a diﬀerent breaking/accelerating device. If shaft
speed is changed, the output voltage also will change, so adjustments in
the ﬁeld current will also be necessary.
3. Phase sequences are diﬀerent
Lamps will glow and fade independently. Phase connections must be in-
terchanged between two of them, e.g., A with B.
4. Phases are diﬀerent
All lamps glow with the same intensity. Generator speed must be slightly
modiﬁed so the lamps slowly fade; the connection must be made when
all of them are totally dark. Once the generator is connected, its speed
will be held constant by the inﬁnite bus; however, the delivered active and
reactive powers can be controlled by adjusting the prime mover power and
the ﬁeld current.
As told before, lamps usage is suitable for laboratory test conditions. Mod-
ern development in electronics and digital systems has made it possible to pro-
duce automatic breakers and ﬁeld control systems that enable the automatic
connection to the inﬁnite bus.
3.2.1
Exercises
A synchronous generator is to be incorporated to the inﬁnite bus. Achieve a
successful connection through the generator synchronizing relay and measure
the generator’s contribution to the grid under various R-L load conditions and
water ﬂow. Use Diagram 3.4 for connections.
Start the generator and make its voltage through the power transformer

3.3 Theoretical problems
139
equal to the grid’s voltage, and attain a speed such that output frequency is
60 [Hz]. Varying the brushless servo speed in very little amounts will slowly
make the phase of both grid and generator match, and the automatic re-
lay will close the connection automatically. Be very careful with phase
sequence; make sure the rotation direction is consistent with the
grid’s sequence before starting.
L stands for line — G stands for generator
LOAD
Speed
[RMS]
PL vs PG
[W]
QL vs QG
[VAr]
SL vs SG
[VA]
R2
1818
110.08 / 144.8
-556.1 / 632
566.88 / 648.3
R2
1845
92.2 / 157.2
-498.38 / 573.3
506.82 / 594.2
R4
1845
280.86 / 160.8
-350.56 / 552.4
449.64 / 575
...
Recommended equipment and connections
• Synchronous generator
• Motor-driven power supply
• Module for measuring the electric power
• Power circuit breaker
• Feeder manager relay
• Synchronizing relay
• Programmable automatic power supply unit
• Synchronization indicator
• Phase sequence indicator
• Three-phase transformer
3.3
Theoretical problems
Problem 3.1. Broadly propose the parameters of a new hydroelectric plant
based on Figure 3.2. Suppose the risk factor has been set at 50%, the head is
90 [m], and there is a 20% loss.

140
3 Hydroelectricity
Diagram 3.4
Hydroelectrical power plant synchronization connections

3.3 Theoretical problems
141
Graph 3.1
Water load vs time availability graph
Solution 3.1. Average power can be calculated as follows:
J
F
M
A
M
J
J
A
S
O
N
D
1200
1000
900
650
800
1200
1750
1750
900
750
650
1400
1000
m3
s

× 2[month]

30 day
month
 
24 h
day
 
60min
h
 h
60 s
min
i
× 1.15 =
1.79 × 109 
m3
.
Due to power capacity, this plant is large and needs a Pelton turbine due
to head restrictions. So results are:
Avg Power
[W]
Reservoir
[m3]
Type
Turbine
Water ﬂow
[m3/s]
600 × 106
1.79 × 109
Large
Pelton
850
Problem 3.2. Plot the water load vs time availability for the conditions de-
scribed below. Plot the mean water load and demand lines (550 [m3/s]). All
values in [m3/s]
J
F
M
A
M
J
J
A
S
O
N
D
500
600
600
400
600
800
900
700
700
500
400
500
Solution 3.2. Should look like Graph 3.1

142
3 Hydroelectricity
Problem 3.3. How tall does the head need to be so an average power of
300 [MW] could be taken from a hydroelectrical plant, considering 350 [m3/s]
mean water ﬂow and an overall eﬃciency of 75%?
Solution 3.3.
300[MW]
1000
h
kg
m3
i
× 350
 m3
s

× 9.81
 m
s2

× 0.75
= 116[m].
Problem 3.4. Considering the data provided in Problem 3.2, what is the total
amount of deﬁciencies expected in a whole year?
Solution 3.4. Whole year = −450 [m3/s] and the longest gap = −300 [m3/s].
Problem 3.5. Considering the data provided in Problem 3.2, calculate the
reservoir capacity considering a demand line of 600 [m3/s].
Solution 3.5. The longest gap deﬁciency is −500 [m3/s], in a period of 4
months, so:
500
m3
s

× 4 [month] ×

30 day
month
 
24 h
day
 
60min
h
 h
60 s
min
i
=
5.18 × 109 
m3
.
3.4
Homework problems
Problem 3.6. Consider a location where the water runoﬀhas been measured
to be (in [m3/s]):
J
F
M
A
M
J
J
A
S
O
N
D
700
750
900
800
900
1200
1300
1200
1000
800
700
650
Calculate the overall required eﬃciency of the plant if the average demand
is about 935 [MW] and the head is 140 [m].
Solution 3.6. The mean can be easily computed to be 908.33 [m3/s]. Con-
sidering a head of 140 [m], the power generation can be expressed as Wn =
δQghη, implying:
935 MW =

100
 kg
m3
 
908.33
m3
s
 
9.81
hm
s2
i
(140 [m]) η.
So, η = 0.749.

3.4 Homework problems
143
Problem 3.7. Suppose there is a small town fed by a single hydroelectric
plant. This town increases its peak power consumption over time, while the
water runoﬀhas been measured to be decreasing. Both relations are shown
below. It is known that the plant is being used at 22.8% of its capacity, and
that when it was installed 10 years back, it was used at 2.5% of its total
capacity.
Find the time at which the town will be at risk of a power shortage.
• Wt(t) = 20e(0.6t) [MW], with t in years
•
∆Q
∆t = −2t
h
m3
s
i
, with t in years
Solution 3.7. At the present time (t = 0) the town takes 20 [MW] from
the plant, implying the plant’s rated power is Wn(0) = 87.72 [MW] at the
present water runoﬀ. On the other hand, the town used to consume 2.7 [MW]
ten years back, which was known to be 2.5% of the plant’s capacity given the
water runoﬀat that time.
The plant’s speciﬁc parameters are unknown; however, the water’s density,
gravity acceleration, head, and eﬃciency can be considered constant over time,
so Wn = kQ, and Wn(t) = k(Q0 −2t).
So, Wn(−10) = 2.7 [MW ]
0.025
= 108 [MW] = k(Q0 + 20), leading to
108 [MW] = k(Q0 + 20), and 87.72 [MW] = kQ0.
So, it can be solved that Q0 = 86.5 [m3/s], and k = 1.014 × 106 h
kg
ms2
i
.
Now both power equations can be solved together:
Wn(tf) = k(Q0 −2tf) = Wt(tf) = 20e(0.6tf ), leading to
tf = 24.13 years Wt = 38.78 [MW].
Problem 3.8. Suppose a hydroelectric plant exhibits the following perfor-
mance (ﬁrst row shows water runoﬀ[m3/s], while the second one shows re-
quired average power during that month [MW]):
J
F
M
A
M
J
J
A
S
O
N
D
700
750
900
800
900
1200
1300
1200
1000
800
700
650
620
500
440
490
580
720
800
700
650
600
600
710
If its head is 90 [m] and its overall eﬃciency is 0.8, build a table to show
how much water must be released during each month, considering the initial
reserved water to be 500 × 106 [m3], and the total dam capacity to be 1 ×
109 [m3]. Report whether a power shortage is possible.
Solution 3.8. It would be useful to calculate the available power per month,
considering each month separately. In addition, calculate the diﬀerence regard-
ing the available power and ﬁnally, the compensating runoﬀ.
The generated power and equivalent runoﬀcan be easily computed by fol-
lowing the equation W = δQghη.

144
3 Hydroelectricity
Dam status can be easily calculated considering C = Q(3600 [h/s] ×
24 [day/h] × 30 [month/day]). All aforementioned computations are reported
in Table 3.3.
The dam capacity is not enough to compensate for December consumption,
so the plant will fail to deliver the required power.
Problem 3.9. Consider the problem described in Problem 3.8 and calculate
the required reservoir size to enable continuous operation throughout the year.
Solution
3.9. The required average power throughout the year is of
618 [MW]. The equation Wn = δQghη can be used over the monthly re-
mainder. Such remainders imply the following requirements:
• A water reserve of at least 774 × 106 [m3] is needed before January starts
• A water reserve of at least 192 × 106 [m3] is needed to compensate April
• A water reserve of at least 1230 × 106 [m3] is needed to compensate the
last three months of the year
January, February, and the last three months of the year need to be seen as
a single unit, so having 2×109 [m3] is required in the reservoir before October.
This can be eﬀectively taken from the preceding surplus of 3.18 × 109 [m3],
collected from May to September. In addition, April’s required surplus of 192×
106 [m3] can be taken partly from March (66.7 × 106 [m3]) but 125 × 106 [m3]
will still be missing.
This implies that 2.13×109 [m3] is the maximum amount of required water
for a single time period during the year. If a 15% risk factor is considered,
the reservoir must be of 2.45 × 109 [m3], and must be entirely ﬁlled during the
summer.
Problem 3.10. Plot a curve representing the size or the reservoir versus the
overall eﬃciency for a dam with a maximum deﬁciency of 30 [MW] for 2
months, and a head of h = 140 [m].
Solution 3.10. Both dam equations can be combined as follows:
W = δQghη,
W
δghη = Q,
Cmonth =
W
δghη(3600 × 24 × 30 × 2),
C(η) = W 5.18×106
δghη
= 113.15×106
η
.

3.5 Simulation
145
3.5
Simulation
Once a hydraulic power plant is connected to the inﬁnite bus, the behavior
and characteristics of the generator will depend on clear parameters. As the
voltage is led by the bus because it dominates the generator (in terms of power
capacity), variations of input mechanical power (water power) or ﬁeld voltage
will not exhibit a direct eﬀect on output voltage. However, they will enable
the power ﬂow to/from the inﬁnite bus.
A synchronous machine can provide its own magnetization between stator
and rotor so it can provide reactive power to the network. As the relation
between active/reactive power is clearly dominated by ﬁeld current and me-
chanical power, respectively, this generator can quickly manage both types of
grid variations. The diagram of such simulated system is shown in Figure 3.10.

146
3 Hydroelectricity
FIGURE 3.10
Generator interconnection to the inﬁnite bus simulation

3.5 Simulation
147
TABLE 3.3
Computations to solve Problem 3.8
J
F
M
A
M
J
J
A
S
O
N
D
Runoﬀ
[m3/s]
700.00
750.00
900.00
800.00
900.00
1200.00 1300.00 1200.00 1000.00 800.00
700.00
650.00
Gen Power
[MW]
494.42
529.74
635.69
565.06
635.69
847.58
918.22
847.58
706.32
565.06
494.42
459.11
Req Power
[MW]
620.00
500.00
440.00
490.00
580.00
720.00
800.00
700.00
650.00
600.00
600.00
710.00
OverPower
[MW]
−125.58
29.74
195.69
75.06
55.69
127.58
118.22
147.58
56.32
−34.94
−105.58
−250.89
OverRunoﬀ
[m3/s]
−177.79
42.11
277.05
106.26
78.84
180.63
167.37
208.95
79.74
−49.47
−149.47
−355.21
Compensate
×108[m3]
−4.61
1.09
7.18
2.75
2.04
4.68
4.34
5.42
2.07
−1.28
−3.87
−9.21
Dam status
×108[m3]
3.92
1.48
8.66
1.00
1.00
1.00
1.00
1.00
1.00
8.72
4.84
−4.36
Release
×108[m3]
0.00
0.00
0.00
−1.42
−2.04
−4.68
−4.34
−5.42
−2.07
0.00
0.00
0.00


4
Wind Energy
Wind energy has been exploited for thousands of years. Its principal ancient
applications are extracting water from wells, cutting lumber, grinding grain
for making ﬂour, and other mechanical power applications. Nowadays wind is
employed mostly for electric power generation. Wind generators are also called
wind turbines, because their function is similar to the gas and steam turbines
that are used for electric energy generation. Since the end of the nineteenth
century, attempts at electric generation from wind power have been made;
nevertheless, combustion-based turbines had much greater development and
applications due to their higher reliability and the possibility of being used
whenever necessary. Due to oil crises in the 1970s, wind energy has been
growing and has been the subject of major investment in Europe and North
America, and more recently, in China. In the 1980s, the power electronics
technology and aerodynamics of wind turbines were suﬃciently mature to
begin large-scale manufacturing of wind turbines for commercial use. Today,
wind energy is one of the most cost-eﬀective methods of electricity generation
and it is the most important in terms of power capacity installed as a renewable
energy source.
4.1
Wind turbine basic structure
A wind turbine is a device that transforms the kinetic energy coming from
the air stream into electrical energy; this conversion requires a mechanical
step and then an electrical one. The element that extracts the energy from
the wind is the rotor, and the rotor drives the electrical machine, usually
through a gearbox. After that, the generator converts the mechanical power
into electrical power.
Many designs of wind turbines have been developed over the years. Here
we are not studying the historical survey of the wind conversion systems, but
an interesting resume can be found in [11]. Basically there are two conﬁgu-
rations: vertical axis and horizontal axis wind turbines, the latter ones being
more popular due to their better eﬃciency. Today for onshore and oﬀshore
applications almost all of the manufactured turbines are horizontal axis with
two or three blades. Figure 4.1 presents a horizontal axis wind turbine and
149

150
4 Wind Energy
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
1. Blades
2. Rotor
3. Pitch
4. Brake
5. Low-speed shaft
6. Gearbox
7. Generator 
8. Controller
9. Anemometer 
10. Wind Vane
11. Nacelle
12. High-speed shaft
13. Yaw drive
14. Yaw motor
15. Tower
FIGURE 4.1
Wind turbine structure
its elements. The wind speed increases with the height, and therefore a tower
is used to elevate the turbine. The energy conversion chain can be organized
into:
• Aerodynamic system, consisting of the turbine rotor, which is composed
of blades, supported by a hub and mounted on the rotor.
• A transmission system composed of a low-speed shaft, connected directly
to the rotor, a gearbox that increases the speed of the low-speed shaft, and
the high-speed shaft, which drives the power to the electrical generator.
Some designs avoid the transmission system by incrementing the number
of poles of the electrical generator.
• The electromagnetic system formed by an electrical machine (synchronous
or induction generator).
• The electric system, which includes the grid connection.
• The yaw mechanism, which moves the nacelle so the blades are perpen-
dicular to the wind direction.
• A control system that manages the rest of systems via an anemometer
for measuring the speed of the wind, and a wind vane that indicates the
direction of the wind.

4.3 Worldwide eolic energy production
151
0  GW
50  GW
100  GW
150  GW
200  GW
250  GW
300  GW
350  GW
2013
2012
2011
2010
2009
2008
2007
2006
2005
2004
2003
2002
2001
2000
1999
1998
1997
1996
FIGURE 4.2
Global cumulative installed wind capacity from 1996 to 2013, modiﬁed from
[29]
4.2
Worldwide eolic energy production
Wind energy has become an important issue for European nations, and polit-
ical measures are implemented in many nations in order to encourage its use.
In 2007 the European Union established the target to achieve 20% of energy
production from renewable energy sources, while in the United States the re-
newable portfolio standard (RPS) has established an objective of obtaining at
least 15% of total energy from renewable sources [16].
Figure 4.2 shows the annual growth of installed wind capacity, with data
taken from the Global Wind Energy Council’s report of 2013. The global
capacity has grown from 6,100 [MW] installed in 1996 to 318,110 [MW] in
2013. Figure 4.3 shows the new installed capacity; it can be seen that up to
today the trend is to continue installing new eolic generators. The enthusiasm
of the countries that produce a greater percentage of their consumption by
wind energy comes from government reforms that encourage the population
to invest in renewable production for injecting energy to the grid.
4.3
Basics of wind energy
The kinetic energy contained in any material element is
E = 1
2mv2,
(4.1)
where m is the mass of the element, and v is the speed. If we consider that mass
is ﬂowing thought a cylinder equal to the wind turbine area, it is convenient

152
4 Wind Energy
0  GW
10  GW
20  GW
30  GW
40  GW
50  GW
FIGURE 4.3
Global new installed wind capacity from 1996 to 2013, modiﬁed from [29]
to express the kinetic energy equation in terms of power ﬂow,
˙E = 1
2 ˙mv2.
(4.2)
If we substitute mass ﬂux as m = ρAv, where ρ is the density of the ﬂuid,
A is the cross-sectional area of the turbine, and v is the velocity of the ﬂuid,
total power available on the wind is
˙E = P = 1
2ρAv3.
(4.3)
It is not possible to extract all this energy from wind. In 1919 the German
physicist Albert Betz demonstrated that the maximum percentage of energy
that can be captured by a turbine is 16/27 ≈0.593, basing his analysis on
mass conservation and momentum of the air stream:
From Newton’s second law, the rate of change of momentum in a control
volume is equal to the sum of all forces acting on it. Consider the wind turbine
of Figure 4.4, with the following assumptions:
• The pressure forces at point 1 and point 4 are equal
• There are no shear forces on the x direction
• Only on points 1 and 4 is there momentum loss or gain
So, the equation of momentum for the large volume control (from point 1
to point 4) becomes
FR = ˙m(V4 −V1).
(4.4)
Consider the volume of control from point 2 to point 3. A2 = A3, and V2 =
V3, because the turbine is thin and the velocity cannot change its magnitude
dramatically. Nevertheless, the energy extracted is evidenced by the pressure

4.3 Basics of wind energy
153
Patm
Patm
V1
V2 
V4
P2
P3
V3 
Streamline
1
2
3
4
FIGURE 4.4
Control volumes for the analysis of a wind turbine

154
4 Wind Energy
gradient. Conservation of momentum applied to volume of control from 2 to
3 yields
FR = P3A −P2A = (P3 −P2)A.
(4.5)
The Bernoulli equation is valid when there is no energy change, so we can
apply it from point 1 to point 2, and from point 3 to point 4 as well:
P1
ρg + V 2
1
2g + z1 = P2
ρg + V 2
2
2g + z2,
(4.6)
and
P3
ρg + V 2
3
2g + z3 = P4
ρg + V 2
4
2g + z4.
(4.7)
If we add Equations (4.6) and (4.7) considering z1 = z2 = z3 = z4, V2 = V3,
and P1 = P4 = Patm, this is obtained:
V 2
4 −V 2
1
2
= P3 −P2
ρ
.
(4.8)
If ˙m = ρAV2 = ρAV is substituted in Equation 4.8,
V2 = V1 + V4
2
.
(4.9)
Now let’s consider the speed of point 2 as a fraction of the speed: V2 =
(1 −2a)V1; if we substitute this in Equation 4.9 it yields
V4 = (1 −2a)V1,
(4.10)
while the mass ﬂux is computed as
˙m = ρAV2 = ρAV1(1 −a).
(4.11)
The power extracted is equal to the energy diﬀerence between point 1 and
point 4, that is
P = ˙m(V 2
1 −V 2
4 )
2
= AV1(1 −a)[V 2
1 −V 2
1 (1 −2a)2]
2
=
2ρAV 3
1 a(1 −a)2,
(4.12)
ηturbine =
P
Pmax
= 2ρAV 3
1 a(1 −a)2
1
2ρAv3
.
(4.13)
Eﬃciency is maximum when a =
1
3 if this value is substituted in the
eﬃciency equation (4.13), ηmax = 16
27 ≈0.593. Maximum eﬃciency of modern
wind turbines is normally about 0.3.

4.4 Aerodynamics of wind turbines
155
Upper surface
Leading edge
Lower surface
Chord line
Trailing edge
Symmetrical Airfoil
Unsymmetrical Airfoil
Upper surface
Leading edge
Lower surface
Trailing edge
Chord line
Shoulder
FIGURE 4.5
Symmetrical and unsymmetrical airfoil terminology and shape
4.4
Aerodynamics of wind turbines
Wind is unpredictable, and it is very hard to establish a complete mathemati-
cal model for a turbine; normally, experimental results arranged and organized
with dimensionless parameters are used for calculations. Yet it is very impor-
tant to understand the basic physical principles for lifting and dragging forces
on airfoils, for understanding many design characteristics of blades.
4.4.1
Airfoils
An airfoil is the cross-sectional area of a turbine’s blade. There are many
designs of airfoils, depending on the characteristics of the operating environ-
ment. Figure 4.5 shows a scheme of an airfoil. The chord line is an imaginary
line that connects the leading edge with the trailing edge. The shoulder is the
point of higher thickness.
On a symmetrical airfoil, when the airﬂow comes parallel to the chord line,
the lift force equals zero, because as the upper and lower surfaces are identical,
the air will ﬂow at the same speed and the pressure gradients are equal. On
the other hand, unsymmetrical airfoils have a larger area and are designed to
have a greater velocity of air on the upper surface; this provokes a decrease of
pressure on the upper side that tends to lift the airfoil (see Figure 4.6).
The angle of the chord line with respect to the airﬂow is known as the angle
of attack (α). Lift and drag force are functions of the angle of attack; as a
convention, lift force is perpendicular to the direction of air and drag is parallel
to it. The physical explanation of lifting is the curvature of streamlines around
the curve, as indicated in Figure 4.7. From ﬂuid mechanics a pressure gradient
is necessary to curve the streamlines: δp
δr = P V 2
r , where r is the curvature of
streamlines, V is the velocity of the ﬂuid, and ρ is the density. The pressure
diﬀerence between the upper surface and the lower surface gives a force acting
like a centripetal force from the circular motion of the particles. The dragging
force at low attack angles is mainly caused by the friction of the surface with
the blade.

156
4 Wind Energy
α
Lift Force
Drag Force
R
V
FIGURE 4.6
Lifting and dragging force in an airfoil
Low pressure 
High pressure 
Decreasing pressure 
Increasing pressure 
P0
P0
FIGURE 4.7
Generation of lift

4.4 Aerodynamics of wind turbines
157
0.0
0.15
0.30
0.45
0.60
0.75
0.90
1.05
1.20
0°
10°
20°
30°
40°
50°
60°
70°
80°
90° α
Cl
Cd
FIGURE 4.8
Lift and drag coeﬃcient as functions of attack angle
A dimensionless coeﬃcient relating the lift generated to the density of the
ﬂuid is known as the lift coeﬃcient Cl, while the dragging coeﬃcient relates
the drag force to the density of the ﬂuid. Lift and drag forces are usually
expressed as
L = 1
2ρSV 2
0 Cl,
(4.14)
D = 1
2ρSV 2
0 Cd,
(4.15)
where S is the area of the airfoil (chord length c multiplied by the length of
the blade), V0 is the velocity of the free stream, and ρ is the density of the
ﬂuid.
For small values of the attack angle, the relation between the drag force and
lift coeﬃcient is linear; in Figure 4.8 a graph of force coeﬃcients is presented. It
can be seen that the characterized airfoil is symmetrical, because the starting
lift force is zero; for an unsymmetrical shape the lift coeﬃcient will start at
a little oﬀset. There is an ideal angle of attack so that the lifting force is
maximum while the dragging is minimum.
Up to now we have seen the airfoil as a ﬁxed structure. Nevertheless, the
blades of the turbine are rotating; this rotation gives another component to
the original velocity of the wind, and this component is due to the angular
velocity and the distance from the center of the section of the blade. It is
convenient to establish a new velocity known as the relative velocity of the
airfoil. Vrel =
p
V 2 + (ωr)2, where V is the velocity of the air and ωr is the
tangential velocity of the blade.
In Figure 4.9 we notice the eﬀect of the tangential velocity on the relative
velocity, as seen by an observer located in the airfoil. γ is the angle of the
relative velocity, while φ is the orientation of the chord, also known as pitch
angle. As mentioned previously, there is an attack angle α that gives the best
performance of the turbine for maintaining it constant with respect to the

158
4 Wind Energy
α
Φ
Φ
α
γ
V
Vtan
Vrel
Vrel
Vtan
V
Direction of rotation
Direction of rotation
a)
b)
γ
FIGURE 4.9
Velocity of the blade relative to the blade at two diﬀerent locations from the
center
relative velocity; there is the necessity of twisting the turbine, which is the
reason for the form of large blades.
4.5
Constant-speed versus variable-speed turbines
As shown in the previous section, the power available in the wind is
P = 1
2CpρAV 3,
(4.16)
where CP is known as the power coeﬃcient (eﬃciency), ρ is the density of the
ﬂuid, A is the cross-sectional area, and V is the speed of the wind. The power
coeﬃcient CP represents the eﬃciency of the turbine and is a function of the
tip speed ratio (λ) and pitch angle φ. The tip speed ratio is deﬁned as follows,
λ = ωR
V ,
(4.17)
where ω is the rotational speed of the blades, R is the rotor’s radium, and v
is the normal component of the wind speed. Figure 4.10 shows the CP −λ
characteristics of an ideal airfoil. It can be seen that there is a speciﬁc λ
where the turbine extracts the maximum energy from wind, so it is important
to maintain the factor ω/V constant. The angle β is modiﬁed in some ﬁxed-
speed wind turbines in order to maintain the energy production below the
maximum power capacity of the system in case of high wind periods, otherwise
this will result in damage to the electric generator.

4.6 Wind energy resource
159
-0.1
0.0
0.1
0.2
0.3
0.4
0.5
Φ=0°
Φ=5°
Φ=10°
Φ=15°
Φ=20°
3
6
9
12
Cp
λ
Nominal operation point
FIGURE 4.10
Cp −λ characteristic for diﬀerent values of pitch angle
Variable-speed turbines can provide greater eﬃciency that ﬁxed ones, and
in a large period of time, it is economically viable to implement a variable
speed control for obtaining maximum wind energy. The speed control strategy
consists of obtaining the maximum power point of the Cp −λ curve at any
time, as shown in Figure 4.11.
4.6
Wind energy resource
The ﬁrst step in a wind energy project is to evaluate the potential of the zone
in which it is proposed to locate the eolic park, the life-cycle costs, the reduc-
tion in greenhouse gases emission, and the proper wind turbine design (large
turbines, small-scale turbines with diesel hybrid systems, etc.) The most im-
portant factor for evaluating a project is the average wind speed, because the
available energy varies as the cubed wind-speed, and many studies have been
made in order to characterize the wind. The variability in time of the wind
can be divided into three scales according to [19], which are: large time scales
(variation of the wind speed in periods of years), medium time scale (variation
of the speed in periods up to a year), and the short time scale (variation of the

160
4 Wind Energy
0
P1
P2
P3
P4
Pn
Excracted Power
Rotor Speed
V1
V2
V3
V4
V5
Vn
Nominal Power 
ω1 ω2  . . .      ωn 
FIGURE 4.11
Wind energy conversion system maximum power extraction
wind speed during the day). The short time scale is very diﬃcult to predict
due to the high variability of the resource. On the other hand, medium and
large scale are much more predictable; therefore, the wind generation projects
are studied usually in terms of monthly variations covering one year. This
variation is typically characterized in terms of statistical analysis; one of the
most common distributions employed is the Weibull distribution [19]. This
probability function expresses the probability of having certain average wind
speed vi during a year,
p(vi) =
k
c
 vi
c
k−1
exp

−
vi
c
k
,
(4.18)
where c is the Weibull scale parameter and has the units of the wind speed,
k is the unitless shape parameter, and vi is a particular wind speed. The
cumulative distribution function is expressed as follows:
p(v < vi) =
n
1 −exp
h
−
vi
c
xio
.
(4.19)
The Weibull distribution parameters and the average wind speed are re-
lated with the complete gamma function
v = c · Γ

1 + 1
k

,
(4.20)

4.7 Power generation system
161
where v is the average wind speed, c is again the scale parameter, and k is
the shape parameter. When k = 2, the Weibull distribution becomes a special
case known as Rayleigh distribution, and the gamma function has a value of
p π
2 ≈0.8862.
The variation of the hourly mean speed around the annual mean speed is
small, as the shape parameter k is higher while the scale factor shows how
windy (how high the average annual wind speed) a location is. An optimal
scenario for an eolic park location is a place having high scale factor and a
reduced shape factor. The two parameters can be estimated by the maximum
likelihood method [12],
k =
Pn
i=1 vk
i ln(vi)
Pn
i=1 vk
i
−
Pn
i=1 ln(vi)
n
−1
,
(4.21)
c =
 
1
n
n
X
i=1
vk
i
! 1
k
,
(4.22)
where n is the number of non-zero data points, vi is the wind speed in the time
i. Equations 4.21 and 4.22 must be solved using an iterative procedure; some
authors [56] recommend starting with the guess of k = 2. Another important
deﬁnition that sometimes is employed is the wind power density (WPD), a
quantitative indicator of the wind energy potential of a particular zone. This
value is a combination of the eﬀects of wind speeds, wind speed distribution,
and the density of the air.
The WPD is deﬁned as
WPD =
vi=25
X
vi=0
0.5ρv3
i ,
(4.23)
where ρ is the air density, P(vi) is the probability to have a wind speed vi
during the year.
If we substitute the expression of the mean wind speed v = Pvi=25
vi=0 viP(vi);
WPD = 0.5ρv3
i .
(4.24)
Figure 4.12 shows a mean wind speed map obtained from statistical studies
[43].
4.7
Power generation system
The electrical power generated needs to be connected to the electrical grid. The
electrical system has a ﬁxed frequency and voltage; therefore, for attaching
new power sources, some requirements must be covered. Those requirements
are:

162
4 Wind Energy
< 9 m/s
Wind classes at 80 m
> 3 m/s
 4 m/s
 5 m/s
 7 m/s
 8 m/s
 6 m/s
FIGURE 4.12
Global wind speed at 80m
• Equal sequence: The sequence of an electric three-phase machine is deﬁned
by the internal conﬁguration of the windings and the rotating direction
of the shaft It is very important to establish a sequence convention for
coupling the generator in the same sequence of the grid.
• Equal voltage: The potential diﬀerence magnitude between the generated
power and the electrical grid has to be close to zero in order to avoid
damage by over-current when attachment is made.
• Equal phase shift: Not only the magnitude has to be equal but also the
displacement. In other words, the instantaneous value of voltage has to be
equal.
In the next subsection we review the most common conﬁgurations of wind
turbines. First the ﬁxed-speed turbines are explained, and then the variable-
speed wind turbines are presented.
4.7.1
Fixed-speed wind turbines
As the electrical grid needs a ﬁxed frequency and voltage magnitude, the
easiest way to satisfy those requirements is by mounting an electric generator
rotating at ﬁxed speed. The ﬁrst designs of wind turbines were made for being
connected directly to the electrical grid like a motor through a soft starter,
usually a variable step resistor. In Figure 4.13 is shown the general structure of
a ﬁxed-speed generator; a capacitor bank is used to compensate the inductive
nature of the electric machine. This conﬁguration was developed and used in
Denmark [41], and because of that is known as the “Danish concept.”
The induction generator used for this conﬁguration is the squirrel cage,

4.7 Power generation system
163
AC Grid 
Induction 
generator
Gearbox
Capacitive 
compensator 
Softstarter
FIGURE 4.13
General structure of a ﬁxed-speed wind turbine
because it is the roughest machine and also the most economical. After the
turbine is rotating at the synchronous speed, the blades are positioned at
their maximum eﬃciency attack angle and are left for extracting some me-
chanical power from the wind stream. When the induction machine is working
like a generator, the rotational speed exceeds the synchronous speed and the
electromagnetic torque is negative, inverting the current ﬂux. The mechanical
speed is very close to the synchronous speed, and the wind induces only small
variations on it.
As shown in Figure 4.11, the aerodynamic eﬃciency has only a maximum
at certain wind speeds, for the remaining wind speeds, the machine will op-
erate at a point corresponding to the synchronous speed on the x axis of the
curve. Another disadvantage is the incapability of the system to deal with the
mechanical stress resulting from large wind gusts.
On the other hand, ﬁxed-speed wind turbines are mechanically simple and
have a low maintenance cost; there are no power electronic devices and their
eﬃciency is high despite the ﬁxed speed.
In order to increase the speed range of the generator, old designs are used to
employ two winding sets: one for low wind speed, typically made of eight poles,
and the second one for medium and large wind speeds (typically six or four
poles). As seen in Chapter 2, the synchronous speed is inversely related to the
number of poles. This design made the stator very big and expensive, therefore
the wound rotor induction generator (WRIG) with access to the rotor windings
represented the evolution of the multi-pole induction generators. The rotor
of the WRIG was controlled by a variable resistance, controlled in turn by
power electronics, depending on the measured speed of the wind, changing
the torque-speed characteristic curve of the machine, and modifying the slip
for certain values of extracted torque. The general scheme of this conﬁguration
is shown in Figure 4.14.
Obviously, the range of controllability remains very limited: about 10%

164
4 Wind Energy
Control System
Rotor-Side 
Converter 
Grid-Side 
Converter 
AC Grid 
PMSG
Gearbox
Pref
Pitch angle
Qref
FIGURE 4.14
General structure of a full-converter variable-speed wind turbine
of the synchronous speed. The WRIG and the multi-pole design were the
ﬁrst attempts at variable speed wind turbines. The next subsection presents
the modern techniques employed for increasing the speed range of the wind
generators.
4.7.2
Variable-speed wind turbines
Nowadays, variable-speed wind turbines are the most used and manufactured
wind energy systems. The variable operation requires power converters that
partially or totally decouple the connection of the electric machine with the
electrical grid. There are principally two types of conﬁgurations: the ﬁrst one
requires a complete power conversion from AC variable frequency and voltage,
to a DC link that maintains a constant voltage, and back to AC at ﬁxed voltage
and frequency. The second one is the doubly-fed induction generator (DFIG),
which decouples only the rotor part of the electric machine, keeping the stator
ﬁxed to the electrical grid.
Full-power converter schemes are very ﬂexible in terms of type of genera-
tion implemented. In Figure 4.14 an induction generator is shown; neverthe-
less, synchronous generators, either wound rotor or permanent magnet, are
equally valid. The permanent magnet and induction squirrel cage generators
are the most popular in the industry, due to the absence of brushes and the
disadvantages that this entails.
The rotor side inverter ensures the rotational speed of the electric ma-
chine. The principal advantage of controlling the speed is to adjust the speed
according to the measured wind speed, in order to obtain at any point the
maximum available power, as shown in Figure 4.11. On the other hand, the
grid-side power converter attempts to transfer all the active power generated
to the electrical grid while the reactive power is cancelled. For synchronous
generators this is especially important, due to the inductive nature of this
machine.
The DFIG is in reality a WRIG but with the rotor windings connected
to a voltage converter, shown in Figure 4.15. The stator windings are con-

4.7 Power generation system
165
Control System
Rotor-Side 
Converter 
Grid-Side 
Converter 
AC Grid 
DFIG
Gearbox
Pref
Pitch angle
Qref
FIGURE 4.15
General structure of a DFIG-scheme wind turbine
nected directly to the electric grid; the advantage of doing this is that only
a portion of the total power (about 30% according to [22]) ﬂows through the
power electronics devices. The DFIG allows variable-speed operation over a
range typically about ±40% of the synchronous speed [13], and the size of
the converter is directly related to the range of speed. The power electronics
at the rotor side are responsible for controlling the active and reactive power
entering or leaving the electric machine, while the converter connector to the
grid side controls the DC-link voltage and ensures operation at large power
factor.
The DFIG wind turbines are highly controllable and allow maximum power
extraction at a wide range of wind velocity. In addition, the active and reactive
power control is fully decoupled because of the independent control of the rotor
current. When the turbine is operating at sub-synchronous speed, the current
ﬂows into the rotor, consuming power from the grid, and is turned back with
the stator windings, while for super-synchronous speeds, both currents from
the rotor and stator ﬂow in the grid direction. The speed of the rotor inﬂuence,
the ﬁxed stator speed, and the rotational speed of the electric machine are
shown with the following equation:
fstator = nrotor × Npoles
120
± frotor,
(4.25)
where n is the rpm speed of the rotor, N is the number of poles of the machine,
and frotor is the electrical frequency of the current that ﬂows through the rotor.
4.7.3
The back-to-back converters
Variable-speed operation is possible due to the power electronic convert-
ers’ interface, allowing a partial decoupling from the grid. The back-to-back
(B2B) converters consist simply of a force-commutated rectiﬁer and a force-
commutated inverter connected with a common DC-link, as shown in Fig-
ure 4.16.
The B2B converter has the following properties [21]:

166
4 Wind Energy
e1
e2
e3
3
~
FIGURE 4.16
Back-to-back converter
• line-side converter (inverter) is controlled to produce near-sinusoidal out-
put currents
• DC-link voltage is regulated by controlling the power ﬂow to the AC grid
• inverter operates on the boosted DC-link, making it possible to increase
the output power of a connected machine over its rated power
Particularly for the wind energy conversion system (WECS), one side of
the converter is the rotor side, which ensures the rotational speed is adjusted
within a large range, whereas the other side is the grid side, which trans-
fers the active power to the grid and attempts to cancel the reactive power
consumption.
Actually, power delivery can be controlled by focusing on the rotor’s cur-
rents. If seen from a rotational d-q reference frame, modifying its d current
would aﬀect both active power (proportionally) and reactive power (inversely);
however, its eﬀect over the active power is much higher than that over the
reactive power. On the other hand, varying the q current has a similar eﬀect
but is higher in magnitude. This analysis is shown in [73], which stands as
a ﬁrst step in a deeper analysis regarding how the behavior of some wind
turbines can be manipulated, depending on power, speed, or torque demands.
4.8
Mathematical model of back-to-back converter
Consider the one phase B2B converter of Figure 4.17, where the back-to-back
(B2B) converter is divided into 3 subsystems: the left side represents the ﬁrst
voltage source inverter, the right side represents the second voltage source
inverter, and the central subsystem is the DC bus.
The equivalent circuits for each subsystem of Figure 4.17 are represented
in Figure 4.18.

4.8 Mathematical model of back-to-back converter
167
R1
R2
L2
L1
C
V1
V2
FIGURE 4.17
Back-to-back converter based on voltage source converters (VSC)
+
-
+
-
+
-
+
-
Rp
C
u1iL1
u2iL2
u1Vc
u2Vc
L1
R1
IL1
V1
R2
L2
V2
IL2
FIGURE 4.18
Equivalent circuits of back-to-back converter

168
4 Wind Energy
4.8.1
Left side of back-to-back converter
Replacing the inverter by a controlled voltage source (see Figure 4.18), where
u1 = 2u(V CS1) −1 and u(V CS1) = [0, 1], the control voltage u1 = [−1, 1].
Then, applying Kirchhoﬀ’s laws, the equation
v1 = VL1 + VR1 + u1
(4.26)
is obtained. Substituting the voltages VL1 = L1
 diL1
dt diL1

and VR1 = R1iR1
of inductor L1 and resistor R1, respectively, and the current iR1 = iL1 in
Equation 4.26, the model of the left side of the B2B converter is
v1 = L1
diL1
dt + R1iL1 + u1Vc.
(4.27)
4.8.2
Right side of back-to-back converter
Using the procedure applied to get Equation 4.27, and considering the equiv-
alent circuit of Figure 4.18, the model of the right side of the B2B converter
is
v2 = L2
diL2
dt + R2iL2 + u2Vc.
(4.28)
4.8.3
DC bus
The left and right converters are replaced by the voltage source 1 and voltage
source 2, respectively. Then, applying Kirchhoﬀ’s current law,
ic = iRp = u1iL1 + u2iL2,
(4.29)
and replacing ic = C dVc
dt , iRp =
VRp
Rp , and VC = VRp, in Equation 4.28, the
model of the DC bus remains as
C dVc
dt + VRp
Rp
−u1iL1 + u2iL2 = 0.
(4.30)
4.8.4
Steady-state model
Deﬁning x1 = iL1, x2 = iL2 and x3 = VC as state variables, the steady-state
model of the B2B converter is
L1 ˙x1 + R1x1 + u1x3 = v1,
L2 ˙x2 + R2x2 + u2x3 = v2,
(4.31)
C ˙x3 + 1
Rp
x3 −u1x1 −u2x2 = v1.
The model of the B2B converter in (4.31) is a discontinuous model since the

4.8 Mathematical model of back-to-back converter
169
FIGURE 4.19
Simulation of tracking control of current i1
inputs u1 and u2 are discontinuous. In order to analyze the B2B converter with
tools for continuous systems, an average model is required. Average models of
B2B converters are obtained by replacing the discontinuous controls u1 and
u2 by pulse with modulated (PWM) signals.
The continuous model of the B2B converter is represented by
L1 ˙x1 + R1x1 + µ1x3 = v1,
L2 ˙x2 + R2x2 + µ2x3 = v2,
(4.32)
C ˙x3 + 1
Rp
x3 −µ1x1 −µ2x2 = v1,
where µ1 and µ2 are continuous signals equivalent to the discrete signals u1
and u2.
4.8.5
Example back-to-back converter
Consider a B2B converter modelled by Equation 4.32, where the parameters
are L1 = 13 [mH], L2 = 7 [mH], R1 = R2 = 0.1 [Ω], C = 1500 [µF],
v1 = 20sin2π(60)t, v1 = 20sin2π(50)t, and Rp = 100 [Ω].
In order to have the desired currents ir1 = 10sin2π(60)t and ir2 =
8sin2π(60)t in the left and right sides of the B2B converter, respectively,
a simple feedback control is applied. Currents i1 and i2 are compared with
the references ir1 and ir2 using feedback. Then, a control gain is designed for
i1 and i2, track ir1, and ir2.
Simulations of the B2B converter are presented in Figures 4.19 through
4.21. It can be observed in Figure 4.19 that current i1(i2) tracks ir1(ir2).
Furthermore, voltage in the DC bus is maintained quasi-constant, as is shown
in Figure 4.21.

170
4 Wind Energy
FIGURE 4.20
Simulation of tracking control for current i2
FIGURE 4.21
Simulation voltage in DC bus, Vc
FIGURE 4.22
Pitch angle vs power extracted exercise

4.8 Mathematical model of back-to-back converter
171
4.8.6
Exercises
The objective of this exercise is to obtain a pitch angle versus a power ex-
tracted characteristic curve for the simulated aero-generator and observe the
power extraction depending on the wind speed.
Press ON the buttons “Torque and Enable” on the CH2 AD1 modulus.
Press the Button START to simulate a force of wind of 18 [m/s]. Control
the pitch of the blades to regulate the shaft speed to 1800 [rpm]. Observe the
mechanical power with respect to the Pitch Angle.
Wind
Speed
[m/s]
Pitch
Angle [◦]
Mechanical
Power [W]
Torque
[Nm]
High
Speed
Shaft
[rpm]
Low
Speed
Shaft
[rpm]
18
0
0
0
0
0
18
20
4.4
0.3
154
1.5
18
22.5
18.4
0.6
443
4
18
27
63
0.6
1222
12
18
31.5
92.3
0.6
1483
15
18
40.5
92
0.6
1490
15
With the obtained data, graph the mechanical power versus pitch angle to
obtain the optimal angle of the blades (see Graph 4.1). When the induction
Graph 4.1
Pitch angle vs power extracted graph
machine is rotating at 1800 rpm, close the relay R2 for mounting the electric
generator with the grid.
Once the electric generator and the grid are coupled, increment the speed

172
4 Wind Energy
Wind Speed
[m/s]
Mechanical
Power [W]
Electrical Power
[W]
Conversion
Eﬃciency [%]
18
92.3
82
88.8
20
94.1
85
90.3
22
96.7
87
89.9
24
100.3
92
91.7
of the wind and measure the mechanical power extracted from the wind and
the electrical power delivered to the grid. Keep the pitch angle at the optimal
value (31.5◦).
Use Diagram 4.1 for connections. Recommended equipment:
• Induction machine
• Brushless control
• Power circuit breaker
• Feeder manager relay
• Three-phase power meter
• Three-phase slip-ring asynchronous machine
• Three-phase supply unit
4.9
Economic factors
The most important factor for the development and application of a new
technology is the economical one. Government agencies are employed for cal-
culating energy cost of the most important renewable energy sources in order
to determine the best choice for investment and evaluate national projects or
supporting companies and the civil population’s projects. The most important
number for evaluating a renewable energy project is the levelized cost of en-
ergy, which is an indicator of the cost of the generated energy in present value
in dollars per megawatt-hour, considering the entire life of the wind turbine,
the costs of installation maintenance and operation of the wind project, and
the rate of charge of the project. In this section, information extracted from
[74] is presented; this information is based on installed land-based projects in
the United States and estimated values for oﬀ-shore projects. The next table
resumes the costs of installed capacity and energy production based on a 20-
year operational life project. The conditions for calculating the total power
produced were presented in Table 4.1.

4.9 Economic factors
173
Diagram 4.1
Suggested electric connection for wind generation

174
4 Wind Energy
TABLE 4.1
Wind properties
Wind
Wind parameter
Land based
Oﬀshore
Annual average speed at 80 [m]
7.75 [m/s]
8.9 [m/s]
Weibull K
2
2.1
Shear exponent
0.143
0.1
Air density
1.163 [kg/m3]
1.225 [kg/m3]
Turbine
Turbine parameter
Land based
Oﬀshore
Turbine hub height
80 [m]
80 [m]
Rotor net Cp
0.39
0.39
Rotor diameter
82.5 [m]
107 [m]
Turbine capacity
1.5 [MW]
3.6 [MW]
With this data, let’s obtain the net energy production for year of each
power conversion system, using Equation 4.16:
Land based:
P =

1
2 × 106

(0.39)(1.165)
π(82.5)2
4

(7.75)3 = 0.564 [MW].
Oﬀshore:
P =

1
2 × 106

(0.39)(1.225)
π(107)2
4

(8.9)3 = 1.513 [MW].
The net annual energy production is deﬁned as the total energy produced
per installed capacity.
AEPnet =
[MW]
Project capacity(365)(24) =
[MW](8760)
Project capacity
(4.33)
Now, applying Equation 4.33 to the previous power calculation:
Land based:
AEPnet = (0.564)(8760)
1.5
= 3293.8.
Oﬀshore:
AEPnet = (1.513)(8760)
3.6
= 3684.68.
On the other hand, the cost of installed projects is summed up in the
following table. For land, project costs were calculated with data from an
old project, observed in Figure 4.23. Considering a market adjustment for

4.9 Economic factors
175
TABLE 4.2
Installed capital costs for land and oﬀshore wind projects
Element cost
Land-installation based on a 1.5 [MW] turbine
Oﬀ-shore based on a 3.6 [MW] turbine
Installed capacity cost
[$/kW]
Energy production
cost [$/MWh]
Installed capacity cost
[$/kW]
Energy production
cost [$/MWh]
Turbine cost
Rotor
283.7
8.16
384.9
13.32
Drive train
699.7
20.13
706.3
24.48
Tower
302.6
8.71
697.71
24.18
Total
1286
37
1789
62
Installation cost
Assembly, transport,
& install
116.3478
5
1122.308
38.846
Electrical
infrastructure
155.1304
2.5
562.1548
19.423
Support structure
77.565
4.5
1010.077
34.962
Development and
project management
58.174
0.75
168.346
5.827
Others
38.783
0.25
56.115
1942
Total
446
13
2918
101
Soft costs
Construction ﬁnance
57.333
1.667
167.437
5.812
Contingency
114.667
3.333
445.5
15.5
Insurance and surety
bond
0
0
279.06
9.687
Total
172
5
893
31
Market price
adjustment
195
6
0
0

176
4 Wind Energy
FIGURE 4.23
Installed capital cost for land-base and oﬀ-shore wind turbine projects
the price of typical payment in the 2011 market, the energy installation and
production costs estimated were as shown in Table 4.2.
The total installed capacity cost considering the market price adjustment
is:
Land based:
ICC = 1286 + 446 + 172 + 195 = 2099.
Oﬀshore:
ICC = 1789 + 2918 + 893 = 5600.
For calculating the levelized cost of energy in [$/MWh], the formula
LCOE = (ICC × FCR) + AOE
AEPne/1000
can be used, where
ICC Installed capacity cost [$/kW]
FCR Fixed charge rate [%]
AOE Annual operating expenses including taxes [$/kW/yr]
AEP Annual energy production [MWh/MW/yr]
The ICC and AEPnet have been calculated previously. The ﬁxed charge
rate (FCR) is deﬁned by [74] as the amount of revenue required to pay the
carrying charges (return on debt, return on equity, taxes, depreciation, and
insurance) on an investment while capturing expected plant life, and is calcu-
lated by
FCR =
d(1 + d)n
(1 + d)n −1 × 1 −(T × PVdep)
(1 −T)
.
(4.34)
Table 4.3 shows an example of data related to some carrying charges.
Where d is the discount rate, n is the number of operational years, T is
the tax rate, and PCdep is the present value of depreciation.

4.10 Homework problems
177
TABLE 4.3
Data for FCR calculation
Data
Land based
Oﬀshore
Discount rate (d)
8 %
10.5 %
Number of operational years (n)
20
20
Eﬀective taxes (T)
38.9 %
38.9 %
Present value depreciation (PVdep)
81.1 %
77.8%
The FCR data used in the Tegen’s report is:
Land based:
FCR = 9.5%.
Oﬀshore:
FCR = 11.8%.
Finally, the annual operating cost is estimated from company’s data and
estimated for oﬀshore projects, and presented in current time:
Land based:
AOE = 35
"
$
kW
yr
#
.
Oﬀshore:
AOE = 136
"
$
kW
yr
#
.
Using Equation 4.34 and the data obtained, the levelized cost of energy
for the wind projects is:
Land based:
LCOE = 72

$
MWh

.
Oﬀshore:
LCOE = 225

$
MWh

.
According to [31], the expectancies for levelized cost to 2019 are as shown
in Table 4.4.
4.10
Homework problems
Problem 4.1. Broadly propose the parameters of a new eolic plant based on
the graph below. Suppose the risk factor has been set as 50%, the head is 90 [m]
and there are 20% in losses.

178
4 Wind Energy
TABLE 4.4
U.S. levelized cost of energy expectancies for 2019
Plant type
Levelized capital cost [$/MWh]
Conventional coal
60
Conventional gas combined cycle
14.3
Conventional combustion turbine
27.3
Advanced nuclear
71.4
Geothermal
34.2
Biomass
47.3
Wind
64.1
Wind oﬀshore
175.4
Solar thermal
195
Solar PV
114
Hydroelectrical
72
Solution 4.1. From the kinetic energy equation:
˙E = 1
2ρAv3 = 1
2

1.225
 kg
m3
  
π
23 [m]
2
2! 
6
hm
s
i3
=
54.97 × 103 [W].
However, only 59.3% of such power can be taken, as pointed out by physi-
cists Albert Betz, so:
W = 32.6 [kW].
Problem 4.2. Suppose some given wind park is subject to a wind speed proﬁle
that rises as much as 18 [m/s] and sinks as low as 9 [m/s] (evenly) throughout
a full operational day. If a mean power consumption of 3 [MW] is desired,
how many 314 [m2] ideal wind turbines are needed to reach the mean power
requirement?
Solution 4.2. As both speeds are said to be distributed evenly, the mean wind
speed is 13.5 [m/s]. By using the kinetic energy equation, it is possible to
calculate the individual power of each turbine.
˙E = 1
2ρAv3 = 1
2

1.225
 kg
m3
  314 [m2]
 
13.5
hm
s
i3
=
473.2 × 103 [W].
Due to maximum power extraction by Betz, each turbine can generate an
ideal average of 280.61 [kW].
So, there are 11 turbines required.

4.10 Homework problems
179
Problem 4.3. Using the data from Problem 4.2 and Figure 4.8 (lift and drag
coeﬃcients graph), determine the optimal dimensions of each blade (3 blades)
considering a 20◦attack angle, an overall design limit of 72.63 [kNm] torque,
and 457 [N] drag force.
Solution 4.3. The 20◦attack angle exhibits a peak lift coeﬃcient of about
1.22, while the drag coeﬃcient is as small as 0.08. Both force equations can
be written as follows (the maximum wind gusts rise up to 18 [m/s]):
L = 1
2ρSV 2
0 Cl = 1
2

1.2225
 kg
m3

S

18
hm
s
i2
(1.22) = 241.11S,
D = 1
2ρSV 2
0 Cd = 1
2

1.2225
 kg
m3

S

18
hm
s
i2
(0.08) = 15.88S.
Knowing that S = c×l, and that the blades are 10 [m] long, both the above
equations can be constrained to determine the chord length (all three blades
contribute equally to such forces):
72.63 × 103 [Nm]
3 [blade] × 10 [m] = 241.11S = (242.11)(10 [m])c ∴c = 1 [m],
457 [N]
3 [blade] = 15.88S = (15.88)(10 [m])c ∴c = 1 [m].
Therefore, due to design constraints, the chord length must be 96 [cm].
Problem 4.4. For constant torque operation, an attack angle controller is
installed on a wind turbine that operates under the same conditions as in
Problem 4.2. Consider the airfoil area to be S = (10 [m])(0.96 [m]), the attack
angle to be constrained between 0◦and 15◦, and the lift coeﬃcient to behave
linearly between (0◦, 0) and (15◦, 1). Find the attack angle interval in which
the generator must operate to compensate wind variations.
Solution 4.4.
L(V0, Cl) = 1
2ρSV 2
0 Cl = 1
2

1.225
 kg
m3

(9.6 [m2])V 2
0 Cl = 5.88
kg
m

V 2
0 Cl.
This leads to the maximum (18 [m/s]) and minimum (9 [m/s]) operating
points:
Lmax = 1.91 × 103Cl ∴Tmax = 57.3 × 103Cl,
Lmin = 476.3Cl ∴Tmin = 14.29 × 103Cl.
The behavior of Cl is also known: Cl(d) =
d
15. So, the highest attack angle
must compensate for slow wind as follows:
Tmin = 14.29 × 103
 d
15

d→15◦= 14.29 [kNm] @15◦.

180
4 Wind Energy
This forces the angle to move at fast winds operation:
Tmax = 57.3 × 103
 d
15

= 14.29 [kNm] leading to d = 3.74◦.
Problem 4.5. Measure the wind power density (WPD) for a place where the
wind speed follows the Weibull distribution with parameters k = 2 and c = 9.
Solution 4.5. The Weibull distribution can be solved for these parameters as
follows:
P(vi) =
k
c
 vi
c
k−1
e−(
vi
c )
k
= (0.22)
vi
9

e−(
vi
9 )
2
.
This can be used on the WPD equation:
WPD =
vi=25
X
vi=0
1
2

ρv3
i P(vi) = 589.64
 W
m2

.
4.11
Simulation
As wind exhibits diﬀerent speed-rates, the incorporation of an asynchronous
machine is quite transparent, as shown in Figure 4.24 . Its rotor is not neces-
sarily moving at the synchronous speed, so every speed surplus can be taken as
active power generation. However, in the case of a squirrel-cage asynchronous
generator, the magnetization ﬁeld is taken from the grid, so the machine will
always require reactive power, making necessary the incorporation of parallel
capacitors to compensate for its inductive nature. In addition, speed varia-
tions could lead to an improper power proﬁle, which cannot be amended if
the access to the rotor’s currents is restricted.
This has led to more complex asynchronous machine designs (together
with increasingly complex power electronics boards), such as the wound rotor
double fed induction machine, WR DFIG, which is actually leading the wind
generation industry.

4.11 Simulation
181
FIGURE 4.24
Asynchronous machine integration to the bus simulation


5
Solar Energy
The sun is a huge source of energy that keeps most environmental processes
running. Its light and heat are also paramount for diﬀerent human activities,
even economic ones like agriculture. However, most of the available energy
delivered by the sun (about 700×106 [TWh] daily) over the Earth’s surface
is not purposely transformed into useful forms of energy, so its enormous
potential is hindered by the inability to capture it.
Besides, it would be impossible to actually take most of the sun’s energy.
Yet there are lots of opportunities to take advantage of it. Its heat can be
directly used in water heaters, and its light can be used thanks to the photo-
voltaic eﬀect of some semiconductors. This has led to a whole industry that
develops technology regarding the diﬀerent ways in which the sun’s energy
can be converted, mostly to electrical energy.
There are two main ways to use solar energy. Firstly, the sun’s light can
be redirected to a single spot, greatly increasing the amount of energy per
unit area. This can boil or pre-heat water if the light is directed to a metallic
container. Secondly, and perhaps more importantly, the light can be captured
through photo-voltaic cells, directly transforming light’s energy into electric-
ity. Both techniques are referred to as thermal and photovoltaic solar energy
sources, respectively [76].
Although the sun can provide huge amounts of usable energy, there are
still some issues to address regarding its availability. The sun’s power is only
available during the daytime, and can only be used fully for a limited part
of the day and depending on the weather. This makes solar energy subject
to sometimes unknown factors, leading to an intermittent performance, which
make such systems depend on energy storage technologies.
Some of these issues are partially solved by forecasting the amount of
energy on a speciﬁc place on earth. Hence, solar power plants can be installed
depending on the potential [ kW h/m2
year
] of that location, and assuming a 10%
overall eﬃciency [33, p. 300]. It is also noteworthy that solar panels’ eﬃciency
will drop to their 80% to 88% nominal performance in 25 years.
It is clear that besides the amount of available energy the sun provides, it
is nonsense to estimate its thorough usage as a justiﬁcation for solar energy’s
incorporation to daily life. The sun provides (some hundreds of thousands
of times) more energy than what is needed by humans, but such energy is
not readily available, it is intermittent, and the means used to “catch” it are
expensive, polluting, and mostly ineﬃcient. Thus, solar energy should be seen
183

184
5 Solar Energy
not as a ﬂawless solution but a promising area in which all kinds of resources
must be invested so that solar power is taken advantage of eﬀectively.
In the same spirit, this chapter shows data regarding solar energy avail-
ability, and deals speciﬁcally with photo-voltaic solar panels to introduce their
behavior, modeling techniques, and the areas in which they can be improved.
5.1
Capturing solar energy
Independent from the technique used to extract energy from the sun, there
are some natural eﬀects that must be acknowledged before any consideration
can be made regarding solar power. Solar radiation should be understood as
the part of the sunlight that reaches earth’s atmosphere, carrying most of
the sun’s available energy. However, diﬀerent particles like carbon dioxide,
methane, ozone, and water vapor can be hit by such rays before they get to
the earth’s surface [76, p. 211].
Once particles are hit, the light can be “ﬁltered” (only some speciﬁc wave-
lengths of the light can go through the particle) or re-directed. The aforemen-
tioned eﬀects are called dispersion and reﬂection, respectively. In addition,
particles are also capable of transforming sun’s radiation into heat; hence,
part of the available energy is absorbed by those particles [76, pp. 211–212].
The above principles explain how solar radiation can warm up the air
and how it can be reﬂected inside earth’s atmosphere. Overall, 30% of such
radiation is reﬂected back to space. The remaining energy is responsible for
the water cycle, ocean currents, and wind courses. Alternatively, radiation can
also be absorbed by the earth’s surface as heat, or it can be converted into
electricity.
As introduced above, there are two diﬀerent ways in which solar energy
can be used. If photo-voltaic (photo = light) devices are used, the sun’s light
energy is directly converted into electricity; otherwise, it is the solar heat
(thermal radiation) that is taken into account [33, p. 302]. The basic principle
regarding solar heat redirection is shown in Figure 5.1.
Photo-voltaic cells and panels operate quite diﬀerently. Broadly, the photo-
voltaic eﬀect refers to the phenomenon of electron emission from a material
after it has been hit by light. The light’s energy ejects the electrons oﬀthe
material, so the energy conversion is straightforward from light to electricity.
Such electromotive force (voltage) will depend on diﬀerent factors regarding
the material’s properties. Only some kinds of materials can produce enough
electromotive force to be useful in the process of energy transfer.
It is clear that the performance of any device intended to capture solar
power will depend on how eﬀectively the light or heat is acquired. The direc-
tion of the sunlight and its power due to weather conditions (and the device’s
cleanliness) are paramount operating factors. The sun changes its position as

5.1 Capturing solar energy
185
FIGURE 5.1
Solar reﬂectors as heaters — basic principle
the day goes by, so the incidence of the light rays is not always the same,
and to guarantee maximum conversion eﬀectiveness, the reﬂectors or panels
should move optimally. In addition, the unpredictable conditions of the useful
rays make any control system devoted to solar power extraction operate over
always-changing operating points.
However, most solar panels’ installations are ﬁxed (they do not orient to
face the sun directly), and clouds, leaves, dirt, etc., can shade them (even
partially). This implies that a solar power plant depends on many conditions
that make the system not as reliable as other traditional power sources. So,
their application is sometimes better as complementary systems to help the
energy transfer process of another (more dependable) plant.
For instance, solar thermal facilities are commonly used as a pre-heater for
the incoming water to a thermal power plant. Any amount of energy taken
from the sun will reduce the required combustible material needed to boil the
water. This process is not intended to work on its own as it depends on the
same solar power’s intermittent nature, which, anyway, reduces the required
fuel and pollutant gases.
The above description corresponds to that of many applications of alterna-
tive power sources. Some geothermal units and photo-voltaic systems are also
used in that way. The main beneﬁt of such a cooperative interconnection is
that the required electrical reliability and dependability are still obtained, and
the intermittent drawbacks of the aforementioned technologies are eliminated.
A diﬀerent way to build reliable solar power plants is to speciﬁcally forecast
“ideal” zones where the light incidence can be guaranteed for a speciﬁc amount
of minimum energy capacity. Installation of power plants in deserts (e.g., the
Atacama desert at Chile) and oﬀ-shore locations make a successful integration

186
5 Solar Energy
FIGURE 5.2
Diﬀerent solar power technologies [76, pp. 238–240]
possible. A brief schematic about diﬀerent solar power technologies is shown
in Figure 5.2.
Solar irradiation can be estimated statistically, or directly measured at
diﬀerent locations to obtain an overall [kWh/m2] metric. It is known that
there are two latitudinal high irradiation bands throughout the earth over the
tropics, at about 23◦north and south, respectively. Such zones can reach up to
a 2800 [kWh/m2] accumulated energy for a year. Figure 5.3 shows the world
zones where sunlight energy is higher than 2500 [kWh/m2/yr].
5.2
Introduction to photo-voltaics
As introduced above, the photo-voltaic eﬀect is not exclusive of semicon-
ductors; however, these materials permit suﬃcient electromotive force to en-
able power transfer to a load. Electric current will appear whenever sunlight
photons hit the material strongly enough to separate electrons and holes,
both with negative and positive charges, respectively. Such interactions en-
able charged particles to ﬂow, as shown in Figure 5.4.
However, de-attached electrons cannot ﬂow just as they “jump” oﬀthe
material because recombination occurs. A p-n junction is needed so the hole-
electron separation becomes possible and recombination is prevented. The

5.2 Introduction to photo-voltaics
187
FIGURE 5.3
World zones where sun iradiance is higher than 2500 [kWh/m2/yr]
FIGURE 5.4
Schematic representation of a solar cell [51, pp. 65–69]

188
5 Solar Energy
voltage present at the terminals of the solar cell is actually a consequence of
the p-n junction band [51, p. 66].
Figure 5.4 shows a schematic representation of both aforementioned elec-
tronic interactions. Firstly, the p-n junction behaves as a common diode, which
implies that the electronically charged materials will attract each other, de-
veloping a forbidden band where electrons and holes are “clogged” together:
both try to reach the other side, at the same time blocking the path to do so.
The aggregation of such particles build up a voltage that can be measured at
the cell’s terminals.
Secondly, as the photons touch the solar cell, electrons and holes are sep-
arated and their transit through the cell is enabled. This implies there are
two currents interacting in the solar cell: the photo-current IL due to the
photo-voltaic eﬀect, and the diode current ID related to the recombination
process [51, pp. 66–67]. Those eﬀects behave inversely, as more light power
would increase IL but would also reduce the forbidden band. Hence, the volt-
age dependent on such a band, necessary for power transfer, will be reduced
whenever IL increases.
The voltage-current relation of a solar cell (which will be modeled later)
can be foreseen from the aforementioned observations; consider a constant
light power to be delivered to the cell. If no load is connected to the cell, the
terminal voltage will be that of the p-n junction. Such voltage will never be
higher if a load is connected, as the current ﬂow will diminish the forbiden
band. If too much current is required, then the voltage will drop to zero as
the junction potential will decay accordingly.
It is important to notice that the electrical behavior of the solar cell is de-
pendent on light power but also on the connected load. This means that even
having great solar incidence, the cell could deliver small amounts of energy if
the optimal V-I operating point is disregarded. In fact, there is only one equiv-
alent load for which the power transfer is maximum, so power electronics are
needed to be attached to the cell’s output to match such optimal impedance,
achieving load independence. For instance, MPPT (maximum power point
tracking) algorithms have been widely studied in this regard to eﬀectively
control the voltage converters used in solar power applications.
Figure 5.4 also shows the metallic conductors attached to each side of the
cell’s body. Those metallic terminals are needed to catch and transmit moving
particles; however, the top metallic layer would also impede solar radiation in
reaching the semiconductor material. It is a common practice to design the
top metallic layer as separated (but interconnected) strips, which allow solar
radiation to pass while partially touching the cell, so transmission occurs. On
the contrary, the backplane metal layer can be placed continuously.
Solar cells are built from diﬀerent semiconductor materials. Silicon (Si),
galium arsenide (GaAs), and germanium (Ge) are three popular components
of solar cells. Each material exhibits a distinctive characteristic regarding junc-
tion potentials and how much power they can absorb depending on the light’s

5.2 Introduction to photo-voltaics
189
FIGURE 5.5
Simple setting of solar photovoltaic panel
wavelength components. A typical crystalline Si cell presents a 0.5–1.0 [V]
potential and current density of 20–40 [mA/cm2] [65].
As can be easily foreseen, the only possible way of obtaining higher voltages
from solar power is to combine more than one cell in series. On the other hand,
if the current is desired to be increased, more than one cell must be arranged
in parallel. Such distribution commonly holds up to 60 or 72 cells, forming a
single solar panel [65, p. 6].
Solar panels deliver DC current, which can be directly used by very speciﬁc
devices. However, most electric appliances take AC inputs, so a voltage con-
version (currently available at up to 95% eﬃciency) is needed even for local (or
stand-alone) applications. In addition, due to intermittent power availability,
a storage system is required. MPPT, storage management, and output voltage
regulation are tasks covered by a load controller (see Figure 5.5).
Load controllers are power electronics devices comprised of diﬀerent DC-
DC converters, capable of managing a regulated output partially independent
from the panel’s variability. Such independence is guaranteed by a storage
system that is controlled so that it takes additional power when available
and delivers power if required. Constant operation will be guaranteed if the
average solar power can cover load requirements.
DC-DC converters are made of semiconductors together with passive de-
vices intended to “convert” from a voltage input magnitude to another at high
eﬃciency (about 96%). Such conversion is achieved by switching one or a set
of transistors, taking portions of the input power depending on the desired
output. Passive elements attached to such a switching device are commonly
used as ﬁlters to provide a smooth, regulated output. Traditional converters
include the Buck, intended to step down the input voltage, the Boost, used
if the voltage is required to rise above the input magnitude, and the Buck-
Boost, which can perform both operations. Such devices can be voltage or

190
5 Solar Energy
FIGURE 5.6
Schematic view of a panel arrangement
current controlled, enabling the load controller operation and allowing diﬀer-
ent sources to be merged on the same DC bus almost regardless of the original
electrical conditions of each device.
Once the output has been regulated, there are two options for available
power usage. For stand-alone operation, the solar panel acts like the only
power provider so that diﬀerent loads can be connected directly to the load
controller if their required DC input matches that of the controller. If AC is
required, an inverter is needed. Stand-alone operation can be seen in Figure 5.5
if the PLL block is disregarded, and the power bus is considered to be only
locally available.
The second option is called grid-connected, and implies that the solar power
is directly injected into the inﬁnite bus. As the public electric grid is AC
driven, the AC inverter is required. In addition, the electric grid operates at
ﬁxed-frequency and ﬁxed-amplitude voltage, so a phase-locked loop (PLL) is
required to drive the inverter. This means the inverter’s generated AC voltage
must match the voltage already present in the power bus, so current injection
can occur. Figure 5.5 shows this operation if the power bus is considered to
be the public electric grid.
5.2.1
Solar arrangements
For the sake of clarity, a fully functional solar array is shown in Figure 5.6. This
ﬁgure tries to clarify some of the most used names for diﬀerent hierarchical
components of a solar generator. Each solar array is comprised of a number
of solar panels, each made with a certain amount of modules that incorporate
diﬀerent solar cells. Cells are clustered in modules because the electrical output
of the panel is desired to have speciﬁc voltage-current ratings. Modules are
also arranged so the desired electrical output is furnished to meet required
characteristics.
On ideal operation, a module behaves (electrically) as a cell, with increased
voltage or current ratings. Likewise, the panel itself can be modeled as a cell,
having the combined eﬀect of all connected modules. Solar arrangements can
be clustered in series or parallel to increase their output voltage or current,

5.2 Introduction to photo-voltaics
191
(a) Series arrangement
(b) Parallel arrangement
FIGURE 5.7
Solar cells/panels arrangements — ideal behavior
FIGURE 5.8
Partial shading eﬀects on electric output
respectively. A hybrid connection is common among cells within the same
panel, while a solar array is often comprised of parallel connected panels.
These relations are graphically shown in Figure 5.7.
However, the actual electric behavior of interconnected cells is not the
same as that of a single cell. Individual cells’ output depends on irradiation
and temperature; hence, a cell’s arrangement will depend on the individual
sunlight and heat conditions. This implies that if one only cell is shaded, the
module will exhibit a diﬀerent voltage-current as a whole.
Figure 5.8 shows how the individual interaction of each cell makes the
overall operation of a bigger arrangement exhibit an unwanted behavior. The
only way in which a bigger arrangement could operate as a single cell is if
the light and temperature conditions are the same for the whole arrangement.
There are many issues around the partial shading eﬀect, mostly due to the
diﬃculties in ﬁnding the optimal operating point regarding power extraction.
Solar arrangements are partially shaded by clouds, birds, leaves, sand,
dust, dry salt, etc., depending on their location. It’s hard to consider an ever-
lasting operational solar arrangement operating ideally. Hence, maintenance
is normally low, but required. The association of solar cells commonly requires

192
5 Solar Energy
(a) Module inverter
(b) String inverter
(c) Central inverter
FIGURE 5.9
Diﬀerent topologies regarding inverters’ connections
the use of additional diodes to avoid panel damage; this is further explained
in Section 5.3.1.
In addition, solar arrangements intended for AC use require inverter mod-
ules to eﬀectively provide or interact with an AC bus. There are diﬀerent
topologies in which these modules are added to the panels’ arrangements.
Figure 5.9 shows three ways of connecting solar panels to an AC bus.
Notice that the diﬀerent AC connections represented in Figure 5.9 mainly
diﬀer in the amount of power the inverter module manipulates. Figure 5.9(a)
shows individual inverters associated to a single panel each. This implies that
the power through the inverter is minimal but the synchronization with the
power grid must be performed individually. Figure 5.9(b) presents a “string”
topology that takes series-connected panels into a single inverter module. In
this case, the inverter modules need to manipulate higher power but the syn-
chronization to the power grid is performed considering “blocks” of solar pan-
els. Finally, Figure 5.9(c) shows a single inverter which, regardless of the pan-
els’ arrangement behind it, performs a full-power conversion. Evidently, the
inverter required for “central” operation is the one that processes the maxi-
mum amount of power among topologies; however, it is the only module to
be synchronized to the power grid.
5.2.2
Solar cell types
The most general classiﬁcation for solar cells is performed in terms of the
nature of the material used in their construction. This classiﬁcation speciﬁcally
separates organic and inorganic cells depending on the materials used to take
advantage of the photoelectric eﬀect. Broadly speaking, inorganic cells use
semiconductor materials like those introduced above, while organic cells use
organic polymers or molecules.
Organic cells work under a similar concept regarding charges separation
due to sunlight power. However, instead of having impure semiconductors,

5.2 Introduction to photo-voltaics
193
TABLE 5.1
Some characteristics of diﬀerent cell types, adapted from [72]
Cell type
Required space [m2/kW]
Eﬃciency [%]
Monocrystalline
7 to 9
17–22
Polycrystalline
9 to 11
13–18
Amorphous
16 to 20
7–13
electron donor and acceptor polymers are built and placed together so the
current ﬂux is possible. Organic cells can be further classiﬁed depending on
the disposition of both diﬀerent polymers and other characteristics that can
be parallel furnished to their ﬁnishing, such as transparency, light weight,
ﬂexibility, etc.
Besides, organic cells are a promising technique, mostly due to their low
fabrication costs and cleaner deposition, but they also exhibit low eﬃciency
(about 1/3 toward silicon ones) and chemical degradation [52]. This has hin-
dered their usage in applications where inorganic cells are commonly used.
Organic cells are the subject of current research and are undoubtedly a
topic that will be developed in the years to come; however, inorganic cells
have also made themselves a place in power generation, so a more speciﬁc
classiﬁcation around them is needed as they dominate the current solar power
panorama.
Inorganic solar cells are classiﬁed broadly as crystalline and thin-ﬁlm. Crys-
talline cells are made from semiconductor “patches” sliced from bigger blocks.
Such blocks are normally required to be thick (hundreds of [µm]) due to man-
ufacturing obstacles. Thin-ﬁlm cells are made through a chemical process that
ends with a semiconductor under 10 [µm] [72, p. 377].
The above classiﬁcation clearly points to the thickness of the ﬁnal semi-
conductor block to be used. However, additional features must be considered
as part of such diﬀerentiation. For instance, silicon can be arranged to exhibit
a mono-crystalline structure (continuous crystal lattice structure throughout
the block) only for crystalline cell types, while thin-ﬁlm can only incorporate
amorphous arrangements. Some electrical characteristics in this regard are
shown in Table 5.1.
Table 5.1 and the above classiﬁcation clearly show the main trade-oﬀre-
lated to solar cell selection. A heavier, more expensive crystalline cell will
exhibit better electric characteristics, while a lighter, cheaper one will make
a poorer use of light incidence. It is worth mentioning that organic cells can
be found to exhibit eﬃciencies around 9%; however, they still cannot replace
thin-ﬁlm cells due to some existing issues regarding their operational stability.

194
5 Solar Energy
Current dependent
on sunlight
p-n junction
Parasitic
capacitance
Shunt
resistance
Series
resistance
Load
FIGURE 5.10
Solar cell equivalent circuit
5.3
Photo-voltaic panel modeling
As introduced in Section 5.2, the large-scale behavior of a solar cell involves
a typical p-n junction as a diode. Sunlight will make electrons and holes get
separated, making a certain amount of current available to ﬂow through the
load. The diode will not allow any current to pass through it unless its ter-
minals’ voltage goes beyond the forbidden band potential, so the generated
current will be made available to the load unless the voltage exceeds the p-n
junction limit. This interaction will generate a voltage-current characteristic
like those shown in Figures 5.7 and 5.8.
There are additional non-idealistic eﬀects inside the solar cell, which can be
foreseen directly from Figure 5.4. The particles moving throughout the cell’s
body will not ﬂow freely, and the movement through the terminals will also
ﬁnd electronic interferences. Both aforementioned eﬀects can be accounted
for with two equivalent resistors, one in series and one parallel to the current
ﬂow. Also, the particles’ location and their clear block separation resembles a
parallel capacitance. These interactions can be depicted through an equivalent
circuit as the one shown in Figure 5.10.
For the sake of simplicity, the parasitic capacitance and the shunt resistor
are commonly disregarded. Such simpliﬁcation is still useful for many big-
scale analyses and provides an easy way to fulﬁll the cell’s model. If the series
resistor Rs and a resistive RL are considered together with the p-n junction
and the sunlight current, the circuit can be easily solved by using Kirchoﬀ’s
law:
IL = IG −ID,
(5.1)
where IL is the load current, IG is the generated photo-current, and ID is the
current ﬂowing through the diode. The diode’s current can be easily known
by using Shockely’s equation, shown in (5.2),
ID = I0

exp
 VD
nVT

−1

,
(5.2)

5.3 Photo-voltaic panel modeling
195
where I0 is the reverse bias saturation current, VD is the diode’s voltage, n is
the ideality factor, and VT is the “thermal voltage,” deﬁned as:
VT = kT
q ,
(5.3)
where k is the Boltzmann’s constant, T the absolute temperature in [K], and
q is the charge of a single electron.
It is known that
k = 1.38064852 × 10−23 [m2 kg s−2 K−1],
q = 1.60217662 × 10−19 [C],
so VT ≈26 [mV ] at 300 [K].
The above equations can be put together after substituting the diode’s
terminals’ voltage VD = Vout + ILRs as follows:
IL = IG −I0

exp
h
q
AKT (Vout + ILRs)
i
−1

.
(5.4)
This simpliﬁed model allows the designer to easily know some voltage-
current parameters. For instance, the open circuit voltage VOC can be com-
puted if IL = 0, so
IG + I0
I0
= exp
 qVout
AKT

,
Vout = ln
IG + I0
I0
AKT
q
.
(5.5)
Similarly, short-circuit conditions imply Vout = 0, so the equation is re-
duced to simply
ISC = IG.
(5.6)
Equation (5.4) is a simpliﬁed form for computing the electric character-
istics of a solar cell, and it is normally accepted as a good approximation of
solar cells’ operation. However, if a more precise model is desired, the leakage
current through the shunt resistance can be easily accounted for as:
IL = IG −I0

exp
h
q
AKT (Vout + ILRs)
i
−1

−Vout + ILRs
Rp
.
(5.7)
The generated current IG can be calculated depending on manufacturer’s
test results over the cell. Such parameters are referred to as standard test
conditions (STC) and account for the cell’s behavior at G∗= 1000 [W/m2]
light power and T ∗= 25◦C temperature. Manufacturer’s tests result in a
standard generated current I∗
G and a temperature coeﬃcient µSC in [A/◦C].
Such parameters allow the user to calculate
IG = G
G∗(I∗
G + µSC∆T) ,
(5.8)

196
5 Solar Energy
where G and G∗stand for present and STC irradiance, respectively, and ∆T =
T −T ∗. If (5.8) is used together with (5.4) or (5.7), the behavior of a solar
cell can be fully computed for any given electric condition.
It is noteworthy that the previously mentioned ideality factor accounts for
manufacturing issues regarding the p-n junction or materials variability. This
variable is A = 1 for an ideal junction and can go as high as 2 or even more
depending on the manufacturer’s speciﬁcations. It can be seen mathematically
that a higher A would result in a “slower” rise of the diode’s current due to an
identical voltage. The solar cell’s model will be clearly aﬀected by this variable
as the current will drop faster for higher As.
Another commonly neglected issue is related to the scale current I0, some-
times called “reverse bias saturation current.” Any p-n junction will exhibit
a negative current ﬂow if inversely biased. Alternatively, the exponential be-
havior presented in (5.2) uses −I0 to eﬀectively account for such a negative
current, making the exponential equation reach −I0 instead of 0 at −∞(that
is why it is also referred to as “scale” current). It is important to mention that
a p-n junction cannot hold too long before breaking if inversely biased; hence,
there is a negative threshold voltage after which (5.2) cannot hold anymore.
Solar cells (panels) commonly incorporate a blocking diode at their positive
terminal. This diode prevents the cell for being inversely biased, so the junction
will be protected and I0 will be a mere scale factor. Parallel diodes can also
be used to bypass solar arrangements subjected to partial or full shading,
allowing other connected solar cells/panels to deliver power continuously.
Finally, it is important to notice a feature present in Equations (5.4) and
(5.7). The load current IL can be found on both sides of the equation, mak-
ing it hard to fulﬁll a voltage-current separation. This diﬃculty is due to the
exponential nature of the equation, which hinders analytical solving possibili-
ties. For instance, the cell model is usually computed by taking IL(t−) as the
current inside the exponential part of the equation, using software capable of
variables feedback.
It is possible to ﬁnd numerical results for the above-presented models by
using a successive approximation method. Such a method can be as simple
as equation balancing (substituting IL until both sides become equal), or it
can be automated through a numeric solver. An analytic alternative is also
possible if the Lambert function W(z), z ∈C (5.9) is used. In this case the
exponential can be directly solved and the voltage and current decoupled;
however, a way to calculate W(z) must be available.
z = W(z)eW (z).
(5.9)
5.3.1
Modeling cells arrangements
In the preceding sections, the series and parallel arrangements of solar cells
have been discussed. It is clear that a sum is enough to account for a collective
behavior of solar cells, depending on their actual connection (see Figure 5.7).

5.3 Photo-voltaic panel modeling
197
In this way, for series connected cells,
Vout =
N
X
i=1
V (i)
out
(5.10)
will hold, having a total amount of N series connected cells. On the other
hand,
IL =
N
X
i=1
I(i)
L
(5.11)
will exhibit the behavior of N parallel connected cells.
The above equations are valid if all conforming cells are assumed to be
equal, and to operate under equal conditions. This makes it possible to simply
multiply the current or voltage by N for parallel or series operation, respec-
tively. In this case (the ideal case), Equation (5.4) can be modiﬁed for both
cases as in (5.12) and (5.13).
IL = IG −I0

exp

q
AKT
Vout
N
+ ILRs

−1

series,
(5.12)
IL = NIG −NI0

exp

q
AKT

Vout + ILRs
N

−1

parallel.
(5.13)
However, cells are not ideal and partial shading may occur in cell arrange-
ments. This forces such solar modules to commonly incorporate bypass diodes,
as shown in Figure 5.11. Suppose the third cell is shaded as shown, so the cur-
rent ﬂowing through it would be much less than the current the remaining
cells could provide. This behavior will make the shaded cell to be seen as a
load, actually exhibiting an inverse polarization. Whether or not a diode is
placed in parallel, the current is free to ﬂow avoiding the shaded panel.
If no bypass diodes are used in series arrangements, a problem commonly
referred to as a hot spot can occur [51, p. 110]. The shaded cell will heat as a
result of its load behavior (power absorption). Panel manufacturers commonly
provide intermediate connections at the output to allow the addition of bypass
diodes for sets of series connected cells. Such sets of cells are commonly rated
under 24 [V] as a rule of thumb [51, p. 113].
As can be foreseen from the above comments, a similar issue regarding
parallel connection will also exist. If two cells or panels are connected in par-
allel and their behavior is diﬀerent, it is possible to have one of the modules
absorb the energy the other one generates. Figure 5.12 shows this situation
assuming the second module has been somehow partially shaded.
The voltage-current behavior of both the aforementioned modules is also
shown in Figure 5.12. Notice that the diﬀerence between both modules is not
large; however, in open circuit operation, the parallel output voltage would
make one of the modules operate at I(1) and the other at I(2). This clearly
shows that the second module will be taking I(2) = I(1). A blocking diode can

198
5 Solar Energy
FIGURE 5.11
Bypass diode in series cell arrangements
FIGURE 5.12
Blocking diodes used for parallel connection
be used to prevent the undesired incoming current ﬂow, as is also shown in
Figure 5.12.
The graph in Figure 5.12 also shows that such behavior is unlikely. Actu-
ally, blocking diodes are mostly disregarded in everyday operation and become
necessary only if, as a rule of thumb, the connection implies a common bus
higher than 120 [V] [51, p. 114].
5.3.2
Maximum power
Solar cells and panels do not operate optimally in terms of power extraction.
Actually, the highest eﬃciency will depend on the load connected at the out-
put. In fact, if a load is directly connected to a solar cell, the voltage at its
terminals and the resulting current ﬂowing through the load will match a
single point in the voltage-current curve discussed so far.

5.3 Photo-voltaic panel modeling
199
Current [A]
Power [W]
Voltage[V]
(a) Graphical view of maximum power point of a solar cell
MPPT
algorithm
+
V
A
Environmental
variables
(b) Schematic view of MPPT alternative
FIGURE 5.13
Maximum power extraction concept
Such a point depends on the cell’s characteristics and can be estimated
by using its equivalent circuit (see Figure 5.10). This implies that the power
obtained from the cell, P = V I, will be dominated by the cell’s parameters,
and subjected to the speciﬁc connected load. In most applications, the solar
generators are expected to be load independent, and actually, to be connected
to the power grid, which can ideally take any amount of current.
It is then important to guarantee that the power extracted from sunlight
will be “maximum,” i.e., at the cell’s highest eﬃciency. This issue was in-
troduced in Section 5.2 where the load controller was told to enable MPPT
(maximum power point tracking) operation. In addition, Figure 5.5 shows a
schematic regarding solar panel usage considering load independence.
MPPT implies that a DC-DC converter can behave as a varying load, con-
trolled by a supervisory algorithm. Such an algorithm seeks for an equivalent
impedance (seen from the panel as a connected load) that fulﬁlls maximum
power extraction. The voltage-power relation is shown in Figure 5.13(a) where
the aforementioned point is marked as MPP. The MPPT schematic view is
shown in Figure 5.13(b).
There is a common misunderstanding regarding MPPT that must be eluci-

200
5 Solar Energy
dated promptly. The voltage-current and voltage-power curves shown through-
out this chapter are not known during operation. Such curves depend on the
actual sunlight power being captured by the panel, its temperature, possi-
ble non-idealities (shading or panel degradation), and cells’ interconnection.
Moreover, only one voltage-current point will be known at each time instant.
This implies that deriving the panel’s curves would require sweeping all pos-
sible output voltages and capturing all resulting currents (e.g., by varying the
connected load) at diﬀerent time-instants.
As the curves cannot be known for sure beforehand and the voltage sweep-
ing is operationally unavailable, it would be impossible to know if the panel’s
operation is optimal, having only one measured operating point. MPPT algo-
rithms oﬀer an alternative to eﬀectively seeking for PMPP, by “intelligently”
moving through the curve. This indeed can take advantage of knowing the
panel’s parameters and can be seen as a sweeping in itself, but it is an eﬃ-
cient one. The design of better MPPT algorithms is a research endeavor of
diﬀerent groups around the world, who are trying to face fast-changing con-
ditions, partial shading (as the curve could be swept incorrectly), and power
electronics eﬃciency.
As a ﬁnal comment, the gray rectangle shown in Figure 5.13(a) with base
Vm and height Im has an area equivalent to the delivered power. This means
that ﬁnding the maximum power point is equivalent to ﬁnding the circum-
scribed rectangle with the largest area. In this spirit, a parameter commonly
referred to as ﬁll factor, referring to the quality of the solar panel, measures
how completely the aforementioned rectangle “ﬁlls” the voltage-current curve,
as shown in (5.14).
FF = VmIm
VOCISC
(5.14)
5.4
A brief example: Solar umbrella monitoring with
LabVIEW
The goal of this project was to study the behavior of electric consumption
of small electronic devices, as well as the characteristics of solar generated
energy at common spaces inside universities. The prototype consisted of three
ﬂexible solar panels, mounted over an outdoor umbrella, with a battery-based
storage system, a load manager to power small electronic devices through an
inverter, a weather station, current sensors, LED lights for illumination, and
a communication interface, as shown in Figure 5.14.
The current sensors detect the current generated by the solar panel as well
as the current delivered by the inverter. The weather station is a set of sensors
of humidity, temperature, and light, to identify the exact conditions at which
the solar energy is generated. A strip of LEDs was mounted in the inside of

5.5 Exercises
201
FIGURE 5.14
Block diagram of the solar umbrella monitoring system
the umbrella, so the intensity of the LEDs was dependent on the amount of
ambient light detected. Finally, all the information collected was sent to a
remote computer wirelessly via X-Bee protocol. The remote computer uses
LabVIEW to show the information and analyze it, as shown in Figure 5.15.
This allowed the tracking of the electrical consumption of devices con-
nected to the inverter in real time. This information was used for didactic
purposes in courses of engineering. Also, for research purposes, information
about the eﬃciency of the solar panel in diﬀerent weather conditions was
gathered.
5.5
Exercises
Assume that there is a factory connected to a three-phase generator, and the
possibility to add a source of solar energy to reduce the consumption of energy
from the generator. The solar panel will be tilted to recreate the movement
of the sun during the day to observe the diﬀerences in power.
Recommended equipment and connections:
• Lamps for photovoltaic trainer
• Photovoltaic inclinable module
• Inverter grid
• Electrical power digital measuring unit

202
5 Solar Energy
FIGURE 5.15
Information on remote computer
• Maximum demand meter
• Three-phase supply unit
• Resistive load
Connect the lamps and point the light towards the photovoltaic panel
(90◦); the lamps act as the light source. The photovoltaic panel is then con-
nected to the inverter grid, and this module is then connected in series to the
thermo-magnetic diﬀerential switch to activate or deactivate the load. The
electric power digital meter module is connected to the switch in order to
measure the output power coming from the inverter.
Finally, connect the three-phase supply unit, assuming it is the power
generator of the factory, to the maximum demand meter and then to the
Y-connected load (see Diagram 5.1).
1. Set the three resistive loads to the 2nd value
2. Set the lamps to 100% of light intensity
3. Put the solar panel in front of the light at 90◦degrees. Then vary the
angle by 10◦degrees until the contribution of the solar panel is 0 [W].
For every position of the solar panel, write down the voltage and current
generated and calculate the power; this can be obtained in the screen of
the electrical power digital measuring unit. Results should be similar to
those shown in Table 5.2.
4. Measure with the maximum demand meter the active power provided by
each of the lines in the source for each of the previous positions of the
solar panel. Results should look like those preseted in Table 5.3.

5.5 Exercises
203
Diagram 5.1
Solar energy exercise
TABLE 5.2
Panel’s dependency on incidence angle
Position [deg]
Voltage [V]
Current [A]
Power [W]
90◦
18.4
1.06
19.504
80◦
15.3
1.08
16.524
70◦
14
0.9
12.6
60◦
15.3
0.86
13.158
50◦
17.9
0.728
13.0312
40◦
17.9
0.656
11.7424
30◦
15.8
0.55
8.69
20◦
15.1
0.358
5.4058
5. Repeat steps 3 and 4 but modifying the light intensity of the lamps to
75%. Write down the results as shown in Table 5.4.
A solar panel is exposed directly to the sunlight to obtain the most energy
from the sun and convert it to electricity, but there is a downside for this. As
the solar panel is in direct contact with the sunlight, it begins to heat up and
its eﬃciency starts to degenerate. In this exercise the lamps will act as the
light source, and at the same time, they will heat the panels. Measurements
will be taken every ﬁve minutes to observe the eﬃciency.
Recommended equipment and connections:
• Lamps for photovoltaic trainer
• Photovoltaic inclinable module
• Inverter grid

204
5 Solar Energy
TABLE 5.3
One-phase solar contribution
Position [deg]
Line 1 [W]
Line 2 [W]
Line 3 [W]
90◦
268
292
292
80◦
232
288
292
70◦
240
288
288
60◦
244
288
292
50◦
248
288
288
40◦
256
292
288
30◦
260
288
288
20◦
272
288
288
TABLE 5.4
Results considering 75% of original light power
Position
[deg]
Voltage
[V]
Current
[A]
Power
[W]
Line 1
[W]
Line 2
[W]
Line 3
[W]
90◦
16.9
0.552
9.3288
264
288
288
80◦
17.8
0.544
9.6832
264
292
288
70◦
16.8
0.57
9.576
264
288
288
60◦
14.4
0.528
7.6032
268
288
288
50◦
13.3
0.52
6.916
268
288
288
40◦
14.8
0.344
5.0912
276
288
288
30◦
14.1
0.304
4.2864
276
288
288
20◦
14.7
<0.300
-
284
288
288

5.5 Exercises
205
Diagram 5.2
Solar energy exercise connection diagram
TABLE 5.5
Panel’s power dependency on temperature
Time [min]
Voltage [V]
Current [A]
Power [W]
Temp. [C]
0
18.4
1.134
20.8656
35◦
5
17.5
1.168
20.44
62.6◦
10
17
1.168
19.856
75.5◦
15
16.8
1.167
19.6056
79.4◦
• Electrical power digital measuring unit
• Resistive load
• Laser thermometer
Connect the lamps and point the light towards the photovoltaic panel (90°);
the lamps act as the light source. The photovoltaic panel is then connected
to the inverter grid module; this module is then connected in series to the
thermo-magnetic diﬀerential switch to activate or deactivate the load. The
electric power digital meter is connected to the switch in order to measure the
output power coming from the inverter (as seen in Diagram 5.2).
1. Set the resistive load to the 2nd value
2. Set the lamps to 100% of light intensity
3. Put the solar panel in front of the light at 90◦degrees. Take 4 measure-
ments every 5 minutes of the voltage and current generated by the solar
panel, and take the temperature of the panel with the thermometer. Write
down the results as shown in Table 5.5

206
5 Solar Energy
5.6
Homework problems
Problem 5.1. Estimate the short-circuit current of a solar panel with form
factor A = 2 and reverse saturation diode current of I0 = 1 [µA], if an open-
circuit voltage VOC = 0.81 [V ] is measured at standard test conditions.
Solution 5.1. The open-circuit equation can be used:
VOC = 0.81 = AKT
q
ln
IL −I0
I0

=
2
 1.38 × 10−24  J
K

(298 [K])
1.6022 × 10−19[C]
ln
IL −1 × 10−6 [A]
1 × 10−6 [A]

.
So, a direct evaluation can lead to IL = 7.07 [A].
Problem 5.2. Estimate the series resistance Rs parameter of a solar cell
model with A = 3 and I0 = 1 [µA], if it is known to exhibit the following pairs
at the same irradiance: (10 [V],3 [A]) and (20 [V],1.5 [A]).
Solution 5.2. Substituting in the panel equation:
I = IL −I0

exp
h
q
AKT

(V + IRs)
i
−1

.
Ii = IL −1 × 10−6

exp

q
3K(298)

(Vi + IiRs)

−1

.
Thus, for both pairs:
IL = 3 + 1 × 10−6 (exp [(12.986)(10 + 3Rs)] −1) ,
IL = 1.5 + 1 × 10−6 (exp [(12.986)(20 + 1.5Rs)] −1) .
Solving the above equations is not easy, analytically speaking; however, a
numerical algorithm like the “bisection” can be used to identify Rs as precisely
as required. Some iterations of a basic search procedure are shown in the table
below. So, Rs = 6.6665039 [Ω].

5.6 Homework problems
207
Rs
Eq1
Eq2
6.0000000
8.18E+151
3.57E+157
7.0000000
6.80E+168
1.03E+166
6.5000000
2.36E+160
6.06E+161
6.7500000
4.00E+164
7.90E+163
6.6250000
3.07E+162
6.92E+162
6.6875000
3.51E+163
2.34E+163
6.6562500
1.04E+163
1.27E+163
6.6718750
1.91E+163
1.72E+163
6.6640625
1.41E+163
1.48E+163
6.6679688
1.64E+163
1.60E+163
6.6660156
1.52E+163
1.54E+163
6.6669922
1.58E+163
1.57E+163
6.6665039
1.55E+163
1.55E+163
Problem 5.3. Draw the V-I curve of a panel composed of 20 series cells
with the following parameters (each) and at standard test conditions: A = 3,
Rs = 0.06 [Ω], Isc = 3 [A], I0 = 1 [µA].
Solution 5.3. The cell panel equation can be better processed (after substi-
tuting) in the following form:
i = 3 −1 × 10−6 exp

778.83 × 10−3i + 12.98 v
20

.
Notice that the voltage has been divided by the number of series cells to
depict series cells connection.
This can be solved through the Lambert equation. However, it can also be
solved numerically for diﬀerent voltages. The table below shows some iterations
of a simple search method.
Voltage [V]
Calculated
Current
[A]
Test
Current
[A]
0
2.99999
2.99999
5
2.99973
2.99973
10
2.99322
2.99322
14
2.91453
2.91453
15
2.84506
2.84506
18
2.29342
2.29343
20
1.54992
1.54993
22.98015
0.00002
0
The V-I curve can be then plotted if multiple voltage values are solved as
shown in the above table.

208
5 Solar Energy
Problem 5.4. Using the same data from Problem 5.3, plot the eﬀect of chang-
ing the form factor as follows: A = [1, 5] ∈Z.
Solution 5.4. As the form factor intervenes in the weighing of both voltage
and current inside the diode equation, the limit at which the equivalent diode
will start to take current is modiﬁed.
The same considerations for the solution of Problem 5.3 hold. However,
it will be necessary to solve numerically for each form factor. Results can be
seen in the graph below.
Problem 5.5. Find the optimal operating point (maximum power point) of
the panel described in Problem 5.3.
Solution 5.5. The panel equation can be substituted to derive
i = 3 −1 × 10−6 exp

778.83 × 10−3i + 12.98 v
20

.
Power can be calculated directly as P = vi, so the preceding equation leads
to
P = 3v −v(1 × 10−6) exp

778.83 × 10−3 P
v + 12.98 v
20

.

5.7 Simulation
209
Again, this equation could be solved directly by using the Lambert equation;
however, a numerical approximation is also possible, as shown in the table
below. Hence, the maximum power point can be found at about 16.25 [V] and
2.69 [A]. An analytical solution leads to v = 16.29275 [V] and i = 2.684 [A].
Voltage
[V]
Calculated
Power
[W]
Test
Power
[W]
Voltage
[V]
Calculated
Power
[W]
Test
Power
[W]
5
14.99867
14.99867
15
42.67585
42.67585
8
23.98514
23.98513
16
43.6656
43.66561
11
32.85804
32.85803
17
43.33859
43.33859
14
40.80342
40.80341
18
41.28162
41.28162
17
43.33859
43.33859
19
37.20969
37.20968
21
22.64282
22.64282
Voltage
[V]
Calculated
Power
[W]
Test
Power
[W]
Voltage
[V]
Calculated
Power
[W]
Test
Power
[W]
15.5
43.30722
43.30722
16.75
43.56792
43.56792
16
43.6656
43.66561
16.5
43.69448
43.69448
16.5
43.69448
43.69447
16.25
43.72476
43.72475
5.7
Simulation
Solar panels can be seen as a direct current source, similar to a battery. This
implies they require an AC inverter so they can be integrated to an electric
network. In addition, their electric output varies depending on temperature
and light irradiance, so their power proﬁle must be manipulated by voltage
converter circuits to guarantee the maximum power extraction and the proper
synchronization to the grid.
Even though automatic control and power electronics are currently inte-
grated in commercial solutions to install solar panels domestically, it is im-
portant to understand the eﬀects of power tracking, cooling, and solar panel
variations with respect to reported nominal characteristics.
The block diagram shown in Figure 5.16 exhibits a solar panel as a simple
block. This model could be used to sweep the desired environmental parame-
ters to test panel’s performance.

210
5 Solar Energy
FIGURE 5.16
Simulation of a solar panel

6
Electric Power Transmission
Transmission of electric power is the key for the development of the modern
electric system in the world. The necessity of carrying power at high voltage
through tall steel towers that cross countries in all directions has enhanced
the analysis of the transmission lines with equivalent circuits (inductances,
resistance, and capacitance). There are underground transmission lines and
overhead ones; in this chapter, the latter will be analyzed due to their greater
popularity.
A network of transmission lines is referred as “power grids.” Traditional
power grids transmit three-phase alternating current at voltages from 69 [kV ]
to 765 kV from the generators to the load. Less impressive but not less impor-
tant are the city’s and railway’s power lines, which transmit power generated
to the loads.
In this chapter, series resistance, series inductance, and shunt capacitance
for three-phase power lines will be analyzed, after which, the ABCD model of
transmission lines is presented and its π equivalent circuit.
6.1
Generic structure of a transmission tower
The transmission system consists mainly of aluminum or copper conductors,
isolation strings, a tower for supporting the components, and shield or over-
head ground wires. Figure 6.1 shows a waist-type tower for high voltage trans-
mission. Shield cables aim to protect the system from lightning and the tower is
made of a conductor material (steel) for discharging electricity to the ground.
Traditional conductors are arranged in strands because they are easy to
manufacture by adding layers for a larger conductor area, and are ﬂexible and
easy to handle compared with an equivalent-area solid conductor.
Although copper is a better conductor, the abundant and less expensive
aluminum has replaced it in most overhead transmission lines. For giving
strength to aluminum conductors, strands of steel are commonly added; these
conductors are known as aluminum-conductor steel-reinforced cable (ACSR).
Other common conductors are all-aluminum conductor (AAC), all aluminum-
alloy conductor (AAAC), and aluminum conductor alloy reinforced (ACAR).
Often, high voltage lines have many conductors per phase, or a bundle.
211

212
6 Electric Power Transmission
Overhead groud
wire
Conductor bundle
Insulator string
Beam
Tower base
Waist
Legs
Tower window
FIGURE 6.1
Waist-type power tower components

6.2 Transmission line parameters
213
Figure 6.1 shows a transmission line of four conductors per phase, decreasing
the strength of the electric ﬁend at the surface in order to reduce the losses
due to the corona eﬀect.
Insulator strings of discs, made mainly of porcelain, are used to suspend
transmission lines and separate them from the tower. Figure 6.1 shows a V-
shaped arrangement in the middle bundle for avoiding swings due to air cur-
rents. The porcelain discs are designed to support mechanical loads of about
7500 [kgf].
The transmission tower is the supporting unit for overhead transmission
lines carrying the transmission cables at a safe height from the ground. Many
designs are implemented according to economic factors, the ambient condi-
tions, and mechanical loads (wind loads, weight of cables, etc.).
Although high voltage towers are made of steel, the transmission lines of
cities can be made of wood and concrete because they are not designed for
discharging energy to the ground.
6.2
Transmission line parameters
For modeling transmission lines, it is necessary to establish physics that give
them their electrical characteristics, so a precise model can be developed. In
this section, resistance, inductance, and capacitance for a solid non-magnetic
conductor are discussed.
6.2.1
Electric resistance
The resistance model presented follows these assumptions:
• Electric resistance varies linearly with the temperature
• No presence of “skin eﬀect”
• Spiraling of the conductors does not aﬀect its resistance
Electric resistance is typically presented as a DC value dependent on the
temperature, directly proportional to the conductor length, and inversely pro-
portional to the cross-sectional area of the conductor,
Rdc = ρT × l
A
,
(6.1)
where ρT is the conductor resistivity dependent on the temperature, l is the
length, and A is the cross-sectional area.
The resistivity of the conductor varies linearly over traditional operation
ranges according to
ρT T2 = ρT T1
T2 + T
T1 + T

,
(6.2)

214
6 Electric Power Transmission
TABLE 6.1
Resistivity and temperature constant of some conductor metals
Material
Resistivity at 20◦C
[Ωm] × 108
Temperature
constant (◦C)
Annealed copper
1.72
234.5
Hard-drawn copper
1.78
241.5
Aluminum
2.85
228.3
Silver
1.59
243
Brass
6–9
480
Iron
10
180
Steel
12–88
180–980
where ρT 2 is the resistivity at temperature 2 (T2). ρT 1 is the resistivity at
temperature 1 (T1). T is the temperature constant of the material. T2 and
T1 have the same units as constant T.
In Table 6.1, some metals’ temperature constant and resistivity at 20◦C
are presented.
Electric resistance increases due to the “skin eﬀect.” On an alternating
current, the distribution of charge is not uniform, tending to crowd toward
the conductor surface, with smaller current density at the conductor center
[39]. At a higher frequency, the skin eﬀect increases; for nominal frequency of
power systems (60 [Hz] or 50 [Hz]), the conductors’ manufacturers provide
the percentage of electric resistance due to this phenomenon.
6.2.2
Inductance
To model the three-phase inductance of a transmission line, let’s start with the
solid cylindrical conductor inductance model. Inductance is present due to the
permeability µ of the medium. The permeability of the air is very close to the
vacuum’s permeability, µ0 = 4π × 10−7 [H/m], and also, the permeability of
non-ferromagnetic materials is very close to µ0, 0.999 and 1.000022 for copper
and aluminum, respectively.
The steps followed for determining the inductance due to both the internal
and external magnetic ﬂuxes are:
1. Obtain the magnetic ﬁeld intensity due to the current ﬂowing through the
conductor (Ampere’s law)
˛
H dl = Ienclosed.
(6.3)
2. Obtain the magnetic ﬂux density B
B = µH.
(6.4)

6.2 Transmission line parameters
215
3. Obtain the magnetic ﬂux
φ = BA.
(6.5)
4. Obtain magnetic linkage ﬂux
λ = fraction of the ﬂowing current × φ.
(6.6)
5. Obtain the inductance from linkage ﬂux
L = λ/I.
(6.7)
Assumptions:
• Current distributes uniformly through the cross-sectional area of the con-
ductor (no skin eﬀect)
• Conductor material is non-magnetic(µ = µ0)
• Electric conductors are made of a single solid bar (or bundle of bars)
Consider the electric conductor shown in Figure 6.2. The current is ﬂowing
out to the page, r is the radius of the cross sectional area, and the lined internal
circle is the path of integration for obtaining the magnetic ﬁeld. Also consider
that the conductor has a length l.
6.2.2.1
Inductance due to internal ﬂux linkage
The ﬁrst step is to obtain the magnetic ﬁeld H implementing Ampere’s law,
Equation (6.3). The path of integration is the circumference of radius x < r,
˛
Hx dl = Hx(2πx) = Ienclosed.
(6.8)
As mentioned in the assumptions, the current Ienclosed is distributed uni-
formly,
Ienclosed = πx2
πr2 I =
x
r
2
I.
(6.9)
The magnetic ﬁeld is equal to
Hx =
xl
2πr2 .
(6.10)
The next step is to obtain the magnetic ﬂux density
Bx = µ0Hx = µ0I
2πx = 2 × 10−7 I
x.
(6.11)

216
6 Electric Power Transmission
x
r
D1
D2
external
internal
I
l
FIGURE 6.2
Solid cylindrical conductor and paths of integration
Once we have obtained the magnetic ﬂux density, let’s consider the lined
area shown in Figure 6.2 for obtaining the diﬀerential magnetic ﬂux dφ:
dφx = Bxldx = µ0xl
2πr2 ldx.
(6.12)
For obtaining the diﬀerential ﬂux linkage dλ it is important to remember
that only the enclosed fraction of the current proportional to (x/r)2 is linked.
So, the actual diﬀerential internal linkage ﬂux is
dλint =
x
r
2
dφx = µ0x3I
2πr4 ldx.
(6.13)
Integrating the diﬀerential linkage ﬂux from 0 to r,
λint = µ0I
2πr4 l
ˆ r
0
x3dx = µ0I
8π l.
(6.14)
Finally, the inductance is calculated as
Lint = λint
I
= µ0l
8π = 1 × 10−7
2
l.
(6.15)

6.2 Transmission line parameters
217
6.2.2.2
Inductance due to external ﬂux linkage
Similarly, consider the external path of integration of Figure 6.2, that is, x > r.
Applying the Ampere’s law again,
Hx =
1
2πx.
(6.16)
The magnetic permeability of air is equal to µ0 = 4π ×10−7 [H/m], so the
magnetic ﬂux density is computed as
Bx = µ0Hx = µ0I
2πx = 2 × 10−7 I
x.
(6.17)
For the external ﬂux, the total current is linked, so the ﬂux is equal to the
linkage ﬂux, calculating the diﬀerential linkage ﬂux:
dφ = dλext = Bxldx = 2 × 10−7 I
xldx.
(6.18)
Observe points D1 and D2 in Figure 6.2. For calculating the actual linkage
ﬂux, it is necessary to integrate Equation (6.18) from D1 to D2,
λext =
ˆ D2
D1
2 × 10−7 I
xldx = 2 × 10−7I ln
D2
D1

l.
(6.19)
Then, the inductance of external ﬂux is
Lext = λext
I
= µ0l
8π = 2 × 10−7 ln
D2
D1

l.
(6.20)
6.2.2.3
Total inductance
The total linkage ﬂux from the center of the conductor to an arbitrary point
of
λtotal = λint + λext = 2 × 10−7Il
1
4 + ln
D2
D1

=
2 × 10−7Il

ln e
1
4 + ln
D
r

.
λtotal = 2 × 10−7Il ln
 D
re−1
4

= 2 × 10−7Il ln
D
r′

.
(6.21)
r′ = re−1
4 .
(6.22)
Ltotal = 2 × 10−7l ln
D
r′

.
(6.23)

218
6 Electric Power Transmission
D1p
D2p
D3p
Dnp
I1
I3
D1n
D2n
D3n
I2
Ik
p
FIGURE 6.3
Array of N conductors
6.2.2.4
Inductance in a point P due to an N conductors system
Once the linkage ﬂux of a conductor is known for some given point in space,
its ﬂux linkage can be known relative to other conductors. The ﬂux linking
conductor n to point P, due to its own current n (see Figure 6.3), is
λnP = 2 × 10−7Il ln
Dn
r′n

.
(6.24)
The inductance of a conductor is due to its own current but also to the
current of adjacent conductors. So the total inductance of a conductor n to a
point in the space P due to all the currents k is
λnP = 2 × 10−7l
K
X
k=1
Ik ln
DP k
Dnk

.
(6.25)
In Equation (6.25), when n = k, Dnn = r′
n = re−1
4 .
6.2.2.5
Inductance in the inﬁnite
Now let’s consider an inﬁnite distance between the electric conductors and
the point P. Also consider that the total current of the electric system is zero
PK
k=1 Ik = 0.
If we algebraically manipulate Equation (6.25), representing it as a sub-
traction of natural logarithms, we obtain
λnP = 2 × 10−7l
 K
X
k=1
Ik ln DP k −
K
X
k=1
Ik ln Dnk
!
.
(6.26)
Then we separate the last element of the positive part:
λnP = 2 × 10−7l
 
IK ln DP K +
K−1
X
k=1
Ik ln DP k −
K
X
k=1
Ik ln Dnk
!
.
(6.27)

6.2 Transmission line parameters
219
On the other hand, if the sum of currents equals zero,
IK = −
K−1
X
k=1
Ik.
(6.28)
If we substitute Equation (6.28) into Equation (6.27), we obtain
λnP = 2 × 10−7l
 K−1
X
k=1
Ik ln DP K −
K−1
X
k=1
Ik ln DP k −
K
X
k=1
Ik ln Dnk
!
,
λnP = 2 × 10−7l
 K−1
X
k=1
Ik ln DP k
DP K
+
K
X
k−1
Ik ln
1
Dnk
!
.
(6.29)
Now consider an inﬁnite length of point P, then DP k = DP K and ln 1 = 0.
Finally, the inductance of a conductor referred to the inﬁnite is only the
last part of Equation (6.29),
λn = 2 × 10−7l
K
X
k=1
Ik ln
1
Dnk
.
(6.30)
6.2.2.6
Inductance of a monophasic system
Applying Equation (6.30) to a single phase system, considering conductor 1
is positive (I1 = I) and conductor 2 is negative (I2 = −I),
λ1 = 2 × 10−7l

I ln 1
r′
1
−I ln
1
D12

= 2 × 10−7lI ln D12
r′
1
,
(6.31)
λ2 = 2 × 10−7l

I ln
1
D21
−I ln 1
r′
2

= −2 × 10−7lI ln D21
r′
2
,
(6.32)
and the total inductance is
L1 = λ1
I1
= 2 × 10−7l ln D12
r′
1
,
(6.33)
L2 = λ2
I2
= 2 × 10−7l ln D21
r′
2
,
(6.34)
Ltotal = L1 + L2 = 2 × 10−7l

ln D12
r′
1
+ ln D21
r′
2

,
= 2 × 10−7l
D12
p
r′
1 + r′
2
.
(6.35)
6.2.2.7
Inductance of a three-phase system
Assumptions:
• The system is totally transposed

220
6 Electric Power Transmission
FIGURE 6.4
Transposition tower
• The conductors are identical (r’ is equal for the three phases)
Let’s consider only phase “a” of the system: in three-phase balanced sys-
tems usually analysis is reduced and represented as a single-phase-per-unit
system,
λa = 2 × 10−7l

Ia ln
1
Daa
+ Ib ln
1
Dab
+ Ic ln
1
Dac

.
(6.36)
If distances between conductors are not equal, inductances per phase are
diﬀerent and as this is not convenient for a power system, a technique called
transposition is implemented. Transposition consists of interchanging posi-
tions of the phases in order to maintain an average constant distance between
them.
In Figure 6.4 with a scheme of a transposition tower is shown, a double-
circuit line, which conductors of the same phase usually place opposite each
other, on the left side. Previous to the transposition the phases from top to
bottom could be A-B-C, while on the right, C’-B’-A’. Then, phases of the left
side are transposed to C-A-B, while the right side changes to B’-A’-C’. The
opposite phase issue is made in order to reduce the inductance because the
ﬂuxes counteract each other.
Assume a complete transposed line. From Equation (6.36) let’s obtain the

6.2 Transmission line parameters
221
l/3
l/3
l/3
phase a
phase b
phase c
Dab
Dac
Dbc
FIGURE 6.5
Transposed three-phase line
average linkage ﬂux taking phase a of Figure 6.5,
λa1 = 2 × 10−7l

Ia ln 1
r′a
+ Ib ln
1
Dab
+ Ic ln
1
Dac

,
(6.37)
λa2 = 2 × 10−7l

Ia ln 1
r′a
+ Ib ln
1
Dbc
+ Ic ln
1
Dab

,
(6.38)
λa3 = 2 × 10−7l

Ia ln 1
r′a
+ Ib ln
1
Dac
+ Ic ln
1
Dbc

.
(6.39)
Obtaining the average:
λaverage = λa1 + λa2 + λa3
3
=
2 × 10−7l
3

3Ia ln 1
r′a
+ Ib ln
1
DabDbcDac
+ Ic ln
1
DabDbcDac

.
(6.40)
Total current is zero, so −Ia = Ib + Ic,
λaverage = 2 × 10−7l
3

3Ia ln 1
r′a
−Ia ln
1
DabDbcDac

,
λaverage = 2 × 10−7l

Ia ln
3√DabDbcDac
r′a

.
(6.41)
As all the phases have the same average distance, inductance of any of
them will be
L = 2 × 10−7l

ln
3√DabDbcDac
r′a

.
(6.42)
6.2.3
Geometric mean radius and geometric mean distance
Up to now, we have considered conductors as solid cylinders. Nevertheless, real
transmission lines are typically formed by a bunch of conductors distributed
in strands so that inductance decreases. Hence the concepts of geometric mean
distance and geometric mean radius are very useful for simplifying a power

222
6 Electric Power Transmission
Conductor a
Conductor b
1
a
. .
.
N
. .
.
1’
M’
Da1
2’
Da1’
FIGURE 6.6
Single-phase system with composite conductors
transmission line into an equivalent single-conductor-per-phase system. For
standard stranded conductors, manufacturers provide the geometric mean ra-
dius, which is equivalent to r′ of a solid conductor.
Consider a single-phase system conformed by N identical sub-conductors
for conductor a and M identical sub-conductors for conductor b.
Assumptions:
• Sub-conductors are identical and carry the same amount of current
Now, if we calculate the total ﬂux φa of sub-conductor “a” shown in Fig-
ure 6.6, we obtain
φx = 2 × 10−7l
"
1
N
N
X
n=1
ln
1
Dxn
−1
M
M
X
m=1
ln
1
Dxm
#
.
(6.43)
In this case, the linking ﬂux λa is not equal to the total ﬂux, because only
the fraction of current 1/N is linked by the magnetic ﬂux, so the actual linkage
ﬂux is
λx = 2 × 10−7l 1
N
"
1
N
N
X
n=1
ln
1
Dxn
−1
M
M
X
m=1
ln
1
Dxm
#
=
2 × 10−7lI
"
1
N 2
N
X
n=1
ln
1
Dxn
−
1
MN
M
X
m=1
ln
1
Dxm
#
.
(6.44)
Finally, by logarithms laws we obtain:
λx = 2 × 10−7lI ln
MNqQN
x=1
QM
m=1 Dxm
N2qQN
x=1
QN
n=1 Dxn
.
(6.45)

6.2 Transmission line parameters
223
Phase A
Phase B
Phase C
C’
B’
A’
FIGURE 6.7
Double circuit line
If
GMD =
MN
v
u
u
t
N
Y
x=1
M
Y
m=1
Dxm,
(6.46)
GMR =
N2
v
u
u
t
N
Y
x=1
N
Y
n=1
Dxn,
(6.47)
then
Lx = 2 × 10−7l ln GMD
GMR.
(6.48)
The same procedure can be made for a three-phase system. From the
previous section we know the inductance of a three-phase system. Replacing
r′
a by GMR in Equation (6.42) for a complete solution, we get:
L = 2 × 10−7l

ln
3√DabDbcDac
GMR

.
(6.49)
6.2.4
Inductance of three-phase double circuit lines
As shown in Figure 6.4, some transmission lines are formed by two identi-
cal three-phase circuits, in parallel; however, some lines are placed opposite
each other as shown in Figure 6.7. In this conﬁguration the distance between
phases is not obvious, so we need to calculate it. Again consider that lines are
completely transposed so the average inductance is balanced.
It is convenient to obtain equivalent distances between phases as follows:
DAB =
4p
DabDab′Da′bDa′b′,
(6.50)
DBC =
4p
DbcDbc′Db′cDb′c′,
(6.51)
DAC =
4p
DacDac′Da′cDa′c′.
(6.52)

224
6 Electric Power Transmission
Then, the equivalent geometric mean distance per phase is
GMD =
3p
DABDBCDAC.
(6.53)
Similarly, we can obtain the equivalent radius of each phase for the GMR:
GMRA =
4p
(r′aDaa′)2 =
p
r′aDaa′,
(6.54)
GMRB =
q
r′
bDbb′,
(6.55)
GMRC =
p
r′cDcc′.
(6.56)
where r′
a is re−1
4 for a solid conductor and the geometric mean radius of a
stranded conductor.
For a complete transposed line, the average GMR is
GMRaverage =
3p
GMRAGMRBGMRC.
(6.57)
Finally, the inductance per phase to neutral is
L = 2 × 10−7l

ln
GMD
GMRaverage

v(t) = Vm cos (wt + θ).
(6.58)
6.2.5
Capacitance of transmission lines
Capacitance of transmission lines comes from the electric ﬁeld resulting from
a charging charge ﬂowing through conductors. An electric ﬁeld describes a
resulting force per unit charge and has units of Newton per Coulomb, which
is equivalent to volts per meter. The potential diﬀerence between conductors
and the relationship between the charge and the potential diﬀerence deﬁne
the capacitance of the conductors. The ground also plays an important role
because capacitance also comes from diﬀerent potential between phases and
ground. The units of the capacitance are the Faradays, represented by [F],
which is deﬁned as the amount of capacitance present when a coulomb pro-
duces a potential diﬀerence of one volt [23].
The steps followed for determining the capacitance due to the charge of
conductors are:
1. Obtain the electric ﬁeld strength from Gauss’s law:
‹
S
E · dA = Q
ϵ .
(6.59)
2. Obtain the voltage between conductors (or ground) from the electric ﬁeld:
V =
ˆ D2
D1
Exdx.
(6.60)

6.2 Transmission line parameters
225
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
l
x
r
P1
P2
V12
+
–
Electric Field 
D1
D2
FIGURE 6.8
Solid cylindrical conductor with uniform charge distribution and Gaussian
surface of integration
3. Obtain the capacitance:
C = q
V .
(6.61)
Assumptions:
• Conductor is uniformly charged, solid, and cylindrical
• Conductor is very long and end eﬀects are negligible
• Resistivity of the conductor is zero, so there is no electrical ﬁeld inside it
• Permittivity of the air is ϵ0 = 8.854 × 10−12 [F/m]
Consider the electric conductor shown in Figure 6.8. The electric charge
is distributed uniformly thought the conductor, r is the radius of the cross
sectional area of the conductor, and the external circle is the Gaussian surface
of integration for obtaining the electric ﬁeld. Consider also that the conduc-
tor has a length l, and the electric ﬁeld lines exit radially outward from the
conductor in all directions.
The ﬁrst step is to calculate the electric ﬁeld resulting from the electric
charge q of the cylindrical conductor. The Gauss law states that the electric
ﬁeld crossing the closed surface is equal to the electric ﬂux. Electric ﬂux is
equal to the total charge divided by the permittivity of the free space,
‹
S
E · dA = Q
ϵ .
(6.62)
The electric ﬁeld inside the conductors equals zero, because we have estab-
lished that we are analyzing a perfect conductor. The electric ﬁeld outside can

226
6 Electric Power Transmission
be determined by selecting a Gaussian surface with radius x > r and length
equal to the conductor length l. As all the electric ﬁeld lines are parallel to the
area of the surface, the cosine of the dot product equals one and the integral
of the electric ﬁeld equation (6.62) yields
Ex2πxl = q
ϵ0
,
Ex =
q
ϵ02πxl.
(6.63)
Once the electric ﬁeld has been calculated, the potential diﬀerence between
concentric cylinders at distances D1 and D2 from the center of the conductor
is
V12 =
ˆ D2
D1
Exdx =
ˆ D2
D1
q
ϵ02πxldx =
q
2πϵ0l ln D2
D1
.
(6.64)
Finally, the capacitance of the conductor between point 1 and 2 is
C12 =
q
V12
= 2πϵl
ln D1
D2
v(t) = Vm cos (wt + θ).
(6.65)
6.2.5.1
Capacitance of a single-phase line
Let’s start with a single, phase-single, conductor power system. The charge of
positive conductors is uniform q and the negative conductors, by conservation
of charge, will have an equal but negative charge –q. From the previous section
we know how to compute the voltage:
Vxy =
q
2πϵol

ln Dyx
Dxx
−ln Dyy
Dxy

=
q
2πϵ0l

ln DyxDxy
DxxDyy

.
(6.66)
As Dxy = Dyx and Dxx = rx, Dyy = ry, Equation (6.66) yields:
Vxy =
q
2πϵol
"
ln D2
xy
rxry
#
=
q
πϵ0l

ln Dxy
√rxry

.
(6.67)
The capacitance of the single line is:
Cxy =
πϵ0l
ln
D
√rxry
.
(6.68)
6.2.5.2
Capacitance of a three-phase line
Now consider a three-phase system neglecting the eﬀect of neutral conductors
and earth. Again, by conservation of charge, consider qa + qb + qc = 0. The
voltage from phase “a” to a point in space P is
VaP =
1
2πϵ0l

qa ln DaP
ra
+ qb ln DbP
Dab
+ qc ln DcP
Dac

.
(6.69)

6.2 Transmission line parameters
227
a
b
c
P
Dab
Dac
Dbc
DbP
DaP
DcP
c
a
b
P
Dab
Dac
Dbc
DbP
DaP
DcP
b
c
a
P
Dab
Dac
Dbc
DbP
DaP
DcP
FIGURE 6.9
Unsymmetrically spaced, complete transposed 3-phase transmission line
Considering a complete transposed line as in Figure 6.9 to calculate the
average voltage between conductor “a” and point “P” due to all the charges,
VaP1 =
1
2πϵ0l

qa ln DaP
ra
+ qb ln DbP
Dab
+ qc ln DcP
Dac

,
VaP2 =
1
2πϵ0l

qa ln DbP
ra
+ qb ln DcP
Dbc
+ qc ln DaP
Dab

,
VaP3 =
1
2πϵ0l

qa ln DcP
ra
+ qb ln DaP
Dac
+ qc ln DbP
Dbc

.
So, the average is
VaP average = Vab1Vab2Vab3
3
=
1
6πϵ0l

qa ln DaP DbP DcP
r3a
+ qb ln DaP DbP DcP
DabDbcDac
+ qc ln DaP DbP DcP
DabDbcDac

.
(6.70)
Substituting −qa = qb + qc in Equation (6.70),
VaP average =
1
6πϵ0l

qa ln DaP DbP DcP
r3a
−qa ln DaP DbP DcP
DabDbcDac

=
qa
6πϵ0l

ln DaP DbP DcP
r3a

,
VaP average =
qa
2πϵ0l ln
3√DabDbcDac
ra
= Va.
(6.71)
The capacitance to neutral is
Can = qa
Va
=
2πϵ0l
ln
3√DabDbcDac
ra
.
(6.72)
Similarly to the inductance section, if we have bundled conductors with no

228
6 Electric Power Transmission
a
b
c
a’
b’
c’
Daa’
Dbb’
Dcc’
FIGURE 6.10
Image method for a three phase transmission line
uniform distribution, the geometric mean distance and geometric mean radius
remain valid.
So, for bundled conductors with well-deﬁned distance between phases, the
equation
Can = qa
Va
=
2πϵ0l
ln
3√DabDbcDac
GMR
(6.73)
is a good approximation, while the exact model used for not-well-deﬁned dis-
tance between phases, as that of double-line transmission lines, is
Can = qa
Va
=
2πϵ0l
ln
GMD
GMRaverage
.
(6.74)
Equations (6.46), (6.47) and from (6.50) to (6.57) of the inductance section
are valid for obtaining the GMD and GMR in Equation (6.74). The only
diﬀerence is that the distance of a conductor with respect to itself is the
radius (Dxx = rx) instead of r′
x = re(−1/4). This comes from the assumption
that the electric ﬁeld within the conductor is zero, while for the magnetic ﬁeld
this is not valid because all the conductors have a magnetic permeability.
6.2.5.3
Eﬀect of earth on the capacitance of conductors
The electric ﬂux lines of a conductor have an end placed on an equipotential
conductor, such that, according to the images method (see Figure 6.10) which
models the earth plane as a perfect conductor, a charge at certain height above
the plane will induce an opposite charge inside the earth at a distance of twice
the height from the original conductor.
Again, consider a point P far from the system for calculating the voltage

6.2 Transmission line parameters
229
from phase “a” to this point,
VaP =
1
2πϵ0l

qa

ln DaP
ra
−ln Da′P
Daa′

+ qb

ln DbP
Dab
−ln Db′P
Dab′

+qc

ln DcP
Dac
−ln Dc′P
Dac′

.
(6.75)
Considering an inﬁnite distance of point P, it is valid to assume:
Da′P = DaP , Db′P = DbP , Dc′P = DcP .
And equation (6.75) yields:
VaP =
1
2πϵ0l

qa

ln Daa′
ra

+ qb

ln Dab′
Dab

+ qc

ln Dac′
Dac

.
(6.76)
For a complete transposed line:
VaP1 =
1
2πϵ0l

qa

ln Daa′
ra

+ qb

ln Dab′
Dab

+ qc

ln Dac′
Dac

,
VaP2 =
1
2πϵ0l

qa

ln Dbb′
ra

+ qb

ln Dbc′
Dbc

+ qc

ln Dba′
Dba

,
VaP3 =
1
2πϵ0l

qa

ln Dcc′
ra

+ qb

ln Dca′
Dca

+ qc

ln Dcb′
Dcb

.
The average voltage is
Va =
1
6πϵ0l

qa ln Daa′Dbb′Dcc′
r3a
+ qb ln Dab′Dbc′Dca′
DabDbcDca
+
qc ln Dac′Dba′Dcb′
DabDbcDca

.
(6.77)
Since Dab′ = Dba′; Dbc′ = Dcb′; Dca′ = Dac′,
Va =
1
6πϵ0l

qa ln Daa′Dbb′Dcc′
r3a
−qa ln Dab′Dbc′Dca′
DabDbcDca

,
Va =
qa
6πϵ0l ln
DabDbcDca
r3a
· Daa′Dbb′Dcc′
Dab′Dbc′Dca′

.
(6.78)
Finally, the capacitance is equal to:
C = qa
Va
=
2πϵ0l
ln
h 3√DabDbcDca
ra
·
3q
Daa′Dbb′Dcc′
Dab′Dbc′Dca′
i.
(6.79)

230
6 Electric Power Transmission
6.2.6
Exercises
Calculate the following transmission line parameters for the transmission line
modules.
Consider a 360 [km] transmission formed by bundles of conductors. The
bundles have the following parameters:
Resistance [Ω/km]
Equivalent
Diameter [m]
Geometric Mean
Radius [m]
0.03611
0.1160
0.2769
The transmission line is completely transposed and has the conﬁguration
shown in Figure 6.11
12 m
12 m
FIGURE 6.11
Length of transmission lines
Obtain the resistance in [Ω], the inductance in [mH], and the capacitance
in [µF].
Obtain the π equivalent circuit placing half of the total capacitance at
each end of the transmission line and the total impedance and resistance in
the middle.
Insert all bridging plugins to the capacitance of the transmission line
model, and with an impedances meter, obtain the capacitance of one end
of the transmission line with respect to neutral and compare it with the cal-
culated value.
Also obtain the inductance of one line and compare your result with the
inductance calculated.
Calculate the transmission line parameters for the second module with the
conﬁguration shown in Figure 6.12 and the following parameters:
Resistance [Ω/km]
Equivalent
Diameter [m]
Geometric Mean
Radius [m]
0.033
0.1148
0.1960
Do the same procedure as that employed for calculating the parameters of
the ﬁrst module.
Connect the equipment as shown in the connection Diagram 6.1.
With an LCR meter, measure three values of capacitance and induc-
tance from capacitive loads and inductive loads, respectively, and ﬁnd their
impedance (assume a 60 [Hz] frequency operation).

6.2 Transmission line parameters
231
Diagram 6.1
Connections for diﬀerent loads

232
6 Electric Power Transmission
2.5 m
2.5 m
FIGURE 6.12
Length of transmission lines
Position
Capacitance
Inductance
1
1.5 [µF]
2.6 [H]
2
2.5 [µF]
1.814 [H]
Insert all bridging plugs connecting the capacitances to the line, then close
the Relay R1 and check the output voltage coming from the secondary trans-
former.
Close the Relay R2 and monitor the electrical parameters.
Set the load R and L, C to zero and take measurements of the power
consumed with the maximum demand meter by the shunt capacitance of the
line.
Measure the reactive power consumed.
Increment the capacitive and inductive load in a balanced way and observe
the increment of the current consumed and the reactive power.
Inductive
load
Capacitive
load
Reactive
power [VAr]
Current [A]
Power factor
1.27 [H]
3 [µF]
175
0.34
0.7
Compare the measured charging reactive power with that which it requires
according to the calculation:
QC = ωCanV 2
LL,
QL = ωLLI2
L,
QLoad = QL −QC.
Fill the following table from the previous table and the above calculations.
Load
Reactive power
measured
Reactive power
calculated QL −QC
Error %
1.27 [H], 3 [µF]
175
346 −180.95 = 165.05
5.7 %
Recommended equipment and connections:
• Resistive load
• Inductive load

6.3 Transmission line mathematical model
233
• Capacitive load
• Overhead line model — Long
• Overhead line model — Medium
• Power circuit breaker
• Three-phase power meter
• Three-phase transformer
• Three-phase supply unit
• Feeder manager relay
6.3
Transmission line mathematical model
In the previous section we obtained the parameters for transmission lines.
Nevertheless, it is important to know that every single tranche of the trans-
mission line can be modeled as a series impedance with its correspondent
shunt capacitance. In this section, the equivalent ABCD model, which relates
the voltage and current of one side of the transmission line with the voltage
and current of the other side, is presented. The ABCD model is convenient for
presenting the exact model of a transmission line because the ABCD matrix
can relate non-linear relationships between inputs and outputs.
Some simpliﬁed models just ignore the diﬀerential equations that represent
the exact model of the transmission line and approximate the model as a T
circuit, assuming that all the capacitance is located at half the transmission
line distance, or as a pi circuit that takes half of the total capacitance at
each end of the transmission line. This is valid for medium length (more than
80 [km] and less than 250 [km]), while for short length lines (less than 80 [km]),
according to [39] even the shunt capacitance can be neglected.
For medium and long transmission lines, the π circuit is widely used to
analyze power ﬂow because many computer programs are designed for a circuit
representation of components, and the ABCD parameter of the network is a
matrix operation. In this section, the exact ABCD parameter is presented
ﬁrst (see Figure 6.14), and then the equivalent pi circuit is presented (see
Figure 6.15). This last form will be used in the following section for power
ﬂow analysis.
6.3.1
Exact ABCD model of a transmission line
Consider a transmission line with the following series impedance conformed
by a resistance and an inductance, and a shunt admittance formed by a ca-

234
6 Electric Power Transmission
+
–
z∆x
y∆x
V(x)
+
–
V(x+∆x)
I(x+∆x)
I(x)
x
x+∆x
FIGURE 6.13
Diﬀerential section of a transmission line
pacitance:
z = R + jωL [Ω/m],
y = jωC [S/m].
The voltage on the left side of Figure 6.13 is
V (x + ∆x) = V (x) + (z∆x)I(x).
(6.80)
Rearranging:
zI(x) = V (x + ∆x) −V (x)
∆x
.
(6.81)
If ∆x →0,
zI(x) = dv(x)
dx .
(6.82)
On the other hand, for the current, the KCL equation gives
I(x + ∆x) = I(x) + (y∆x) × V (x + ∆x).
(6.83)
Rearranging and assuming ∆x →0,
yV (x) = I(x + ∆x) −V (x)
∆x
= dI(x)
dx .
(6.84)
Diﬀerentiating and substituting the current derivative,
yV (x) = 1
z
d2V (x)
dx2
,
(6.85)
which can be expressed as
d2V (x)
dx2
−yzV (x) = 0.
(6.86)

6.3 Transmission line mathematical model
235
+
–
+
–
VS
IS
VR
IR
A B C D
FIGURE 6.14
ABCD representation of a transmission line
If the diﬀerential equation is solved, the solution has the form
V (x) = A1eγx + A2e−γx,
(6.87)
where γ = √yz, also called propagation constant. On the other hand, substi-
tuting the solution (6.87) into (6.82),
I(x) = A1eγx + A2e−γx
ZC
,
(6.88)
where ZC =
q
z
y is called the characteristic impedance. Now, solve A1 and
A2 with the following boundary conditions: x = 0 →V (0) = VR = A1 + A2,
I(0) = IR = A1−A2
ZC
.
Substituting A1 and A2 leads to
V (x) = eγx + e−γx
2
VR + ZC
eγx −e−γx
2

IR,
(6.89)
I(x) =
1
ZC
eγx −e−γx
2

VR +
eγx + e−γx
2

IR.
(6.90)
Representing in matrix form, recognizing the hyperbolic function cosh and
sinh, and considering a length l,
VS
IS

=
A
B
C
D
 VR
IR

=
 cosh γl
ZC sinh γl
1
ZC sinh γl
cosh γl
 VR
IR

,
(6.91)
where
γ = √yz, Zc =
rz
y .
(6.92)

236
6 Electric Power Transmission
+
–
+
–
VS
IS
VR
IR
Z’
Y’/2
Y’/2
FIGURE 6.15
Transmission line equivalent pi circuit
6.3.2
Equivalent π circuit
Most power ﬂow programs use the equivalent π circuit because they were
created for representing power system elements as impedances connected to-
gether. So, an equivalent circuit was created identical in structure to a nominal
π circuit (where the impedance is all in the center of the model and half of
the admittance is situated at each end of the transmission line), but with
the following corrections for obtaining the exact transmission line model. In
[78, 47] the mathematical formulation of the π circuit can be found,
Z′ = ZC sinh (γl) = ZF1 = Z sinh (γl)
γl
,
(6.93)
Y ′
2 = tanh (γl/2)
ZC
= Y
2 F2 = Y
2
tanh (γl/2)
γl/2
.
(6.94)
Here we are just showing the resulting equations.
6.3.3
Exercises
Assemble Diagram 6.2 using the large transmission line model and connect
all the plugins in the transmission line model. Set the primary side of the
three-phase transformer in ∆connection 380 [V ] and set the secondary-side
to Y UN −5%.
Take measure of the voltage V, current I, and power consumed (both active
P and reactive Q) of the entire power system (including transmission lines) and
the voltage and current after the transmission lines. Fill the following table,
where 1 is the input measure of the transmission line and 2 is the measure at
the output of the transmission line.
Observe the increase in reactive power due to the increment of current
ﬂowing through the transmission line’s inductor. Also, observe the voltage
drop due to the transmission line impedance and how it increments with the
current.

6.3 Transmission line mathematical model
237
Diagram 6.2
Connections for matched-load practice

238
6 Electric Power Transmission
R
V1 [V ]
I1 [A]
P1 [W]
Q1 [VAr]
V2 [V ]
I2 [A]
R1
405.6
0.21
148.52
9
404.6
0.21
R2
403.9
0.29
148.52
7.32
401
0.29
R3
399.5
0.46
148.52
62.8
390.3
0.45
R4
395.5
0.61
148.52
135.58
380
0.61
R5
391.5
0.78
148.52
237.58
366.4
0.75
R6
388.2
0.97
148.52
375
351.4
0.96
R7
388
1.05
148.52
452.8
343.6
1.03
The inductive eﬀect of the transmission line is always much larger than
the capacitive eﬀect, so the reactive power will be inductive even with a very
low current ﬂowing through the transmission line.
Power companies must maintain the voltage supplied to the users within
a range typically ±5% of the nominal voltage, maintain the load impedance
constant (R4 = 312 [Ω]), and obtain the power and voltage drop of the trans-
mission line model.
Supply
voltage
V1
[V ]
I1
[A]
P1
[W]
V2
[V ]
I2
[A]
P2
[W]
∆P
[W]
η
Voltage
drop [%]
UN+5%
409.4 0.73
519.5 398.2 0.73
508.1 11.4
0.978
97.264
UN
392.6
0.7
478.2 382.3
0.7
466
12.2
0.974
97.376
UN–5%
376.3 0.67
432.9
364
0.67
422
10.9
0.975
96.731
UN–10% 354.9 0.64
391.2 345.8 0.64
381.7
9.5
0.976
97.436
UN–15% 336.4
0.6
351.5 327.7
0.6
342.1
9.4
0.973
97.414
Recommended equipment and connections:
• Resistive load
• Inductive load
• Capacitive load
• Overhead line model — Long
• Power circuit breaker
• Three-phase power meter
• Three-phase transformer
• Three-phase supply unit
• Feeder manager relay

6.4 Power ﬂow analysis
239
6.4
Power ﬂow analysis
In power system analysis, it is very common to visualize the system as ﬂow
of power. The objective is to compute voltage and phase at each bus. One
bus can be seen as a point of connection between elements (a node). As a
result of the calculation the real and reactive power can be obtained, and
you can visualize the total load ﬂowing through a conductor. The objective of
this calculation is to operate the system at its maximum eﬃciency point and
maintain the voltage range of all the buses at an ideal range. The power ﬂow
is analyzed from the single-line diagram of a power system; the input data is
the bus, transmission line, and transformers data.
For buses with loads and/or generators connected, the convention is that
the power generated is positive while the power consumed is negative,
Pk = PGk −PLk,
(6.95)
Qk = QGk −QLk,
(6.96)
where k is the number of the bus.
Buses can be classiﬁed into three types:
• Swing bus: Is set as the reference, and it is convenient to establish a value
of 1.0∠0◦per unit. The unknown is the power ﬂow P1 and Q1.
• Load bus: The input data is Pk and Qk, and load buses are the most
frequent buses on power system. The unknown is the voltage of the bus
and its angle Vk∠δ◦
k.
• Voltage controlled bus: These buses represent generator, switched shunt
capacitor, or voltage regulated buses. The input data is Pk and Vk and
the unknowns are the Qk and δk.
Transmission lines and electric machines parameters are represented as
admittances. An admittance matrix is calculated for convenience as
Ybus =


Y11
· · ·
Y1n
...
...
...
Yn1
· · ·
Ynn

,
where the diagonal elements Ykk are the sum of admittances connected to the
bus k. The oﬀ-diagonal elements Ykn, where k ̸= n, are the negative of the
sum of the admittances connected between bus k and bus n.
The negative signs are present because for convention, it is assumed that
all the currents are leaving the bus,
I = YbusV.
(6.97)

240
6 Electric Power Transmission
Using the Ybus matrix, the currents can be calculated from
Ik =
N
X
n=1
Y : knVn.
(6.98)
For each bus, the complex power ﬂow of the bus k is
Sk = Pk + jQk = VkI∗
k,
(6.99)
where I∗
k is the conjugate of the current of node k. If we substitute I∗
k with
the current of each bus, we get
Sk = Pk + jQk = Vk
" N
X
n=1
TknVn
#∗
.
(6.100)
By using polar notation, Vn = Vnejδn; Ykn = Yknejθkn, and separating real
and imaginary parts, we get
Pk = Vk
N
X
n=1
YknVn cos (δk −δn −θkn),
(6.101)
Qk = Vk
N
X
n=1
YknVn sin (δk −δn −θkn).
(6.102)
There are several methods for solving the power ﬂow problem. One of
the most popular because of its simplicity is the Gauss-Seidel method. This
iterative method can be computed as
Vk(i + 1) =
1
Ykk
"
Pk −jQk
V ∗
k (i)
−
k−1
X
n=1
YknVn(i + 1) −
k−1
X
n=k+1
YknVn(i)
#
, (6.103)
Pk = Vk(i)
N
X
n=1
YknVn(i) cos (δk(i) −δn(i) −θkn),
(6.104)
Qk = Vk(i)
N
X
n=1
YknVn(i) sin (δk(i) −δn(i) −θkn).
(6.105)
6.4.1
Exercises
This set of exercises requires a connection like the one shown in Diagram 6.3.
Obtain the active and reactive power consumed by an RL load. Enter the
measured values into the following table:

6.4 Power ﬂow analysis
241
L4 = 1.27 H
V1 [V ]
I1 [A]
P1 [W]
Q1 [VAr]
V2 [V ]
I2 [A]
cos φ2
R1
420
0.57
172.8
374.2
389.3
0.6
0.4
R2
418.2
0.6
228.1
377.6
386
0.63
0.51
R3
413.8
0.72
356
372
378.5
0.75
0.7
R4
408.7
0.87
481
380
371.3
0.89
0.81
L5 = 0.9 H
V1 [V ]
I1 [A]
P1 [W]
Q1 [VAr]
V2 [V ]
I2 [A]
cos φ2
R1
418.6
0.74
174.7
505.4
378.5
0.77
0.31
R2
418.1
0.76
226.9
501.7
376.8
0.8
0.41
R3
412.2
0.85
349
497.5
369.2
0.82
0.59
R4
408.7
0.97
469
501.2
362.3
0.99
0.71
L6 = 0.64 H
V1 [V ]
I1 [A]
P1 [W]
Q1 [VAr]
V2 [V ]
I2 [A]
cos φ2
R1
418.2
0.97
177.1
681.3
364.2
1.01
0.24
R2
417
1.02
225.6
674
361.6
1.02
0.31
R3
412.1
1.01
338.5
663.2
355.8
1.08
0.47
R4
407.1
1.13
448.7
659
349.1
1.16
0.59
Now remove the connection to the resistive load and repeat the measure-
ment for L4 = 1.27 [H].
V1 [V ]
I1 [A]
P1 [W]
Q1 [VAr]
V2 [V ]
I2 [A]
cos{φ 2}
424.6
0.52
31.82
383.2
394
0.56
0.06
The inductive load also consumes active power due to ohmic resistance and
iron losses of the inductor.
Now observe the power consumption due to RC loads. Enter the measured

242
6 Electric Power Transmission
Diagram 6.3
Connections for RC and RL power consumed practice

6.4 Power ﬂow analysis
243
values into the following table:
C1 = 2 [µF]
V1 [V ]
I1 [A]
P1 [W]
Q1 [VAr]
V2 [V ]
I2 [A]
cos φ2
R1
423.1
0.29
171.9
128.3
428.2
0.27
0.84
R2
420.2
0.37
237.4
121.2
423.7
0.35
0.91
R3
414.1
0.56
391.5
100.5
414
0.55
0.96
R4
408.8
0.77
540.4
69.9
405
0.76
0.98
C2 = 3 [µF]
V1 [V ]
I1 [A]
P1 [W]
Q1 [VAr]
V2 [V ]
I2 [A]
cos φ2
R1
423.8
0.36
176.8
195.2
433
0.34
0.7
R2
420.6
0.42
243.7
187.3
428.8
0.4
0.8
R3
414.6
0.6
400.2
162.2
418.5
0.59
0.92
R4
408.8
0.8
551.2
129.7
409.2
0.79
0.95
C3 = 5 [µF]
V1 [V ]
I1 [A]
P1 [W]
Q1 [VAr]
V2 [V ]
I2 [A]
cos φ2
R1
423.5
0.5
185.1
309.6
441.2
0.46
0.51
R2
420.4
0.54
254.8
299
430.8
0.51
0.64
R3
414.7
0.69
416.4
268.8
427.1
0.67
0.82
R4
407.7
0.87
573.2
228
416.4
0.85
0.89
Remove the connections to the resistive load and repeat the measurements
for C3 = 5[µF].
V1 [V ]
I1 [A]
P1 [W]
Q1 [VAr]
V2 [V ]
I2 [A]
cos φ2
430.5
0.45
3.5
329.3
452.7
0.41
0
Unlike inductors, capacitors demonstrate practically no losses, so almost
no active power is consumed.
Recommended equipment and connections:
• Resistive load
• Inductive load
• Capacitive load
• Overhead line model — Long
• Power circuit breaker
• Three-phase power meter
• Three-phase transformer
• Three-phase supply unit
• Feeder manager relay

244
6 Electric Power Transmission
Naturally, the loads have an inductive and resistive nature. In the indus-
try, it is important to keep the power factor within a certain limit to avoid
economic penalties. Capacitor banks are used for this purpose.
Recommended equipment and connections:
• Resistive load
• Inductive load
• Capacitive load
• Overhead line model — Long
• Overhead line model — Medium
• Power circuit breaker
• Three-phase power meter
• Reactive power controller
• Switchable capacitor battery
• Three-phase transformer
• Three-phase supply unit
• Feeder manager relay
Assemble the electric connections shown in Diagram 6.4 and Diagram 6.5.
Set all the loads to zero position, power on the three-phase supply unit, and
close Relay 3, Relay 1, and Relay 2.
Increment the inductive load in a balanced way, step by step, and observe
the cos φ variation.
Observe the compensator to know the value of the capacitance connected
to the power lines, and calculate the reactive power supplied for each step of
the capacitor bank.
Observe the compensator to know the value of the capacitance connected
to the power lines, and calculate the reactive power supplied for each step of
the capacitor bank.
Q = 3 × 2πfCV 3
LL.
Fill the following table with the measured data:

6.5 Power ﬂow analysis
245
Diagram 6.4
Connections for capacitive compensation 1/2

246
6 Electric Power Transmission
Diagram 6.5
Connections for capacitive compensation 2/2

6.5 Theoretical problems
247
Resistance
Inductance
Capacitance
[µF]
Line to line
voltage [V ]
Reactive
power [V A]
R2
L2
2
381
328
L5
8
363.1
1192.9
L6
10
349.87
1384.4
Resistance
Inductance
Capacitance
[µF]
Line to line
voltage [V ]
Reactive
power [V A]
R7
L2
6
336
766
L5
10
323.89
1186.4
L6
12
316.96
1363.46
6.5
Theoretical problems
Problem 6.1. Consider a copper stranded conductor formed by 19 strands of
0.1055 [in] in diameter. Calculate the DC resistance per unit length in [Ω/km]
for this conductor at 50◦C. Use the hard-drawn copper data of Table 6.1
for the resistivity and the temperature constant (ρ20◦= 1.78 [Ωm] × 10−8,
T = 241.5◦C). Consider 2% increase of electric resistance due to spiraling.
Solution 6.1. From Equation (6.2) we obtain the resistivity at 50◦C:
ρ50◦= 1.78 × 10−8 [Ω/m]
50◦+ 241.5◦
20◦+ 241.5◦

= 1.98 × 10−8 [Ω/m].
The area of the conductor is:
A = 19 ×
π

0.1055 [in]
1 [m]
39.37 [in]
2
4
= 1.0716 × 10−4 [m2],
and the electric resistance is obtained from (6.1):
Rdc = 1.98 × 10−8 [Ω/m]
1.0716 × 10−4 [m2] = 1.8478 × 10−4
 Ω
m

.
Considering 2% of resistance increase and expressing the result in Ω/km:
R∗
dc = 1.02

1.8478 × 10−4
 Ω
m

× 1000 [m]
1 [km]
= 0.1884
 Ω
km

.
Problem 6.2. The electric conductor calculated is a 4/0 A.W.G. hard-drawn
copper conductor. From datasheets of the conductor we known that the elec-
tric resistance at 50◦C is as shown below. Calculate the percent increase in
resistance at 60 [Hz] versus DC.

248
6 Electric Power Transmission
Electric Resistance
(Ω/ Conductor / km)
DC
50 [Hz]
60 [Hz]
0.188
0.189
0.2
Solution 6.2.
% Increase =
0.2
0.1884 × 100 = 106.16%.
Problem 6.3. Consider a complete transposed 60 [Hz] bundled transmis-
sion line conformed by two ACSR “Drake” conductors with the characteris-
tics below. Calculate the inductance and series reactance per [km] for a ﬂat
conﬁguration with horizontal spacing between phases of 10 [m] (ab = 10 [m],
bc = 10 [m]). Also consider a bundle spacing of 0.5 [m] (d = 0.5 [m]).
A
B
C
d
ab
bc
Outside
Diameter [cm]
GMR
[m]
Resistance
60 [Hz]
50◦C ([Ω/km])
Current
Capacity [A]
2.8143
0.01143
0.08
900
Solution 6.3. Let’s call the GMD of each single conductor Ds, then the geo-
metric mean distance of each phase bundle is:
GMR =
N2
v
u
u
t
N
Y
x=1
N
Y
n=1
Dxn =
4p
(d × DS)2 =
p
(d × DS) =
√
0.5 × 0.01143 = 0.0756 [m].
From Equation (6.49)
L = 2 × 10−7l

ln
3√10 × 10 × 20
0.0756

= 1.024 × 10−6l [H].
If we express the result in [H/km]:
L′ = 1.024 × 10−3 [H/km].
The inductive reactance per km is:
X′
a = 2πfL′ = 0.386 [Ω/km].

6.5 Theoretical problems
249
The series reactance is formed by the resistance and the inductive reac-
tance:
X = 0.08||0.08 + j0.386 [Ω/km] = 0.04 + j0.386 [Ω/km].
Problem 6.4. Now consider a double circuit line formed by the same con-
ductors with the following distances between conductors. Calculate the induc-
tance and reactance. Calculate the inductance and series reactance per km
and obtain the inductive reactance percentage reduction compared with the ﬂat
conﬁguration.
ab [m]
ac’ [m]
ab’ [m]
aa’ [m]
10
10
14.14
22.36
A
B
C
A'
B'
C'
ac'
ab'
aa'
ab
Solution 6.4. First, let’s obtain the GMD from Equations (6.50) to (6.57):
GMRA =
√
0.01143 × 22.36 = 0.506 [m],
GMRB =
√
0.01143 × 10 = 0.3381 [m],
GMRC =
√
0.01143 × 22.36 = 0.506 [m],
GMRaverage =
3p
0.5062 × 0.3381 = 0.4424 [m].
Finally, the inductance per [km] is:
L′ = 2 × 10−7(1000)

ln 12.5971
0.4424

= 6.698 × 10−4 [H/km].
The inductive reactance is:
X′
a = 2πfL′ = 0.2525 [Ω/km].
The percentage of reduction is:
% reduction =

1 −0.2525
0.386

× 100% = 34.58%.

250
6 Electric Power Transmission
Problem 6.5. For Problem 6.4, obtain the capacitance with reference to neu-
tral in [F/km] and the shunt admittance in [Siemens/km].
Solution 6.5. For the ﬂat conﬁguration, the radius of the conductor is:
r = 0.02814 m
2
= 0.01407 [m].
Then, the GMR for the bundle is:
GMR =
√
d × r =
√
0.5 × 0.01407 = 0.08387 [m].
From Equation (6.72), the capacitance is equal to:
Can = 2π × 8.854 × 10−12 × l
ln
3√10×10×20
0.08387
= 1.1099 × 10−11 × l [F].
If the result is expressed in [F/km]:
C′
an = 1.1099 × 10−8 [F/km].
The admitance is equal to:
Y = jωCan = j(2π × 60)(1.1099 × 10−8) = 4.18422 × 10−6 [S/km].
For the double circuit line, the GMRaverage is:
GMRA =
√
0.01407 × 22.36 = 0.5609 [m],
GMRB =
√
0.01407 × 10 = 0.3751 [m],
GMRC =
√
0.01143 × 22.36 = 0.5609 [m],
GMRaverage =
3p
0.56092 × 0.3751 = 0.4905 [m],
From (6.73), the capacitance is:
Can = 2π × 8.854 × 10−12 × l
ln 12.5971
0.4905
= 1.7139 × 10−11 × l [F].
If the result is expressed in [F/km],
C′
an = 1.7139 × 10−8 [F/km].
Then, the admitance is equal to:
Y = jωCan = j(2π × 60)(1.1099 × 10−8) = 6.4614 × 10−6 [S/km].
Problem 6.6. A three-phase system of 500 [km] is completely transposed and

6.5 Theoretical problems
251
has the following impedance and admittance (solutions of Section 6.2.6 for the
double circuit line series impedance and shunt admittance):
z = 0.04 + j0.2525
 Ω
km

y = j6.4614 × 10−6 [S/km].
Calculate the exact ABCD model of the transmission line and present the
result in matrix form. Note: To obtain the square root of a complex number,
it is convenient to employ DeMoivre’s identity: (cos x + j sin x)n = cos nx +
j sin nx.
Solution 6.6. To use Equation (6.91),
γ =
p
(j6.4614 × 10−6) × (0.04 + j0.2525) =
p
1.6518 × 10−6∠171◦
= 1.2852 × 10−3∠85.5◦,
Zc =
s
0.04 + j0.2525
j6.4614 × 10−6 =
√
39565.5252∠−9◦= 198.9108∠4.5◦.
Now, calculating cosh (γl) and sinh (γl):
γl = 0.0504 + j0.6406,
eγl = e0.0504 × ej0.6406 = 1.0517 × (0.8017 + j0.5977) = 0.8431 + j0.6286,
e−γl = e−0.0504 × e−j0.6406 = 0.7623 −j0.5683,
cosh γl = eγl + e−γl
2
= 0.8027 + j0.03015,
sinh γl = eγl −e−γl
2
= 0.0404 + j0.59845.
Then,
VS
IS

=

0.8027 + j0.03015
−1.3284 + j199.3017
(4.3853 + j29.8342) × 10−4
0.8027 + j0.03015
 VR
IR

.
Problem 6.7. For Problem 6.6, obtain the nominal π circuit and then cal-
culate the exact π circuit model. Compare the nominal circuit with the exact
model.
Solution 6.7. The nominal model is obtained by directly substituting the
impedance and shunt admittance of the line.
Z = (0.04 + j0.2525) × 500 = 20 + j126.51Ω= 128.08∠81.016◦[Ω],
Y
2 = (j6.4614 × 10−6) × 250 = j1.61535 × 10−3 [S] = 1.61535 × 10−3∠90◦[S],
Z′ = Z sinh (γl)
γl
= 128.08∠81.016◦0.0404 + j0.59845
0.0504 + j0.6406 = 119.56∠81.65◦.

252
6 Electric Power Transmission
Then,
γl
2 = 0.0504 + j0.6406 = 0.0252 + j0.3203,
eγl = e0.0252 × ej0.3203 = 0.9733 + j0.3229,
e−γl = e−0.0252 × e−j0.3203 = 0.9255 −j0.3070.
So,
tanh γl
2 = eγl −e−γl
eγl + e−γl = 0.02795 + j0.3315,
Y ′
2 = Y
2
tanh (γl/2)
γl/2
= 1.6726 × 10−3∠89.679◦.
Let’s obtain the percentage of diﬀerence between the magnitudes of the
exact and approximated models:
% of diﬀerence Z =
 
|Z −Z′|
Z+Z′
2
!
× 100% = 6.881%,
% of diﬀerence Y
2 =


 Y
2 −Y ′
2

Y
2 + Y ′
2
2

× 100% = 3.48%.
The transmission line modeled is considered to be a long transmission line,
and therefore it is not recommended to use the nominal π circuit. Nevertheless,
for medium and short length transmission lines, the percentage of diﬀerence
will be less than 2% and the nominal model can be employed.
6.6
Homework problems
Problem 6.8. Suppose an annealed copper conductor 4/0 is installed at some
building. Calculate the DC resistance if it is known that it will be used at
maximum 60◦C, and that the containing duct is of about 100 [m].
Solution 6.8. The 4/0 cable has a diameter of 0.46 [in], a 20◦C resistivity
of ρ20◦C = 1.72 × 10−8 [Ωm], and a temperature constant of 234.5◦C (from
Table 6.1).
Then,
ρ60◦C = ρ20◦C
60◦+ 234.5◦
20◦+ 234.5◦

= 1.99 × 10−8 [Ωm].

6.6 Homework problems
253
In addition,
A = πr2 = π
0.46 [in]
2
1 [m]
39.37 [in]
2
= 107.22 × 10−6 [m2],
Rdc = ρ60◦C
A
= 1.99 × 10−8 [Ωm]
107.22 × 10−6 [m2] = 185.6 × 10−6
 Ω
m

.
So, for 100 [m], the total resistancec is 18.56 [mΩ].
Problem 6.9. Consider the conductor of Problem 6.8 to be used in a three-
phase conﬁguration. All the conductors are individually isolated through a
0.2 [in] plastic skin and are touching each other throughout their trajectory.
Calculate the inductance of one of these conductors in terms of the distance.
Solution 6.9. The conductor’s radius is 0.23 [in] + 0.1 [in]. As all conduc-
tors are touching each other, the distance from one of them to any other is
2(0.23 [in] + 0.2 [in]) = 0.86 [in] = 21.84 × 10−3 [m]. The equivalent inner
radius is then: r′ = r exp (−0.25) = 4.55 × 10−3 m. So, it can be directly
computed:
L
l = 2 × 10−7 ln D
r′a
= 314
nH
m

.
Problem 6.10. Consider a conductor to be arranged and installed so it ex-
hibits a DC resistance of Rdc = 185.6 × 10−6 [Ω/m], and an inductance of
L = 314 [nH/m]. Calculate the reactance in terms of the distance of such a
conductor for 50 [Hz] and 60 [Hz] operation. Use the following information
to measure resistance:
DC
50 [Hz]
60 [Hz]
100%
100.532%
106.383%
Solution 6.10. The reactance can be calculated for each frequency as follows:
Xf = Rf + j2πfL.
Thus,
X50
m = 186.59 × 10−6 + j98.65 × 10−6 [Ω/m],
X60
m = 197.45 × 10−6 + j118.38 × 10−6 [Ω/m].
Problem 6.11. Consider a transmission line that exhibits the following pa-
rameters:
• Series impedance Z = 0.02 + j0.3 [Ω/km]

254
6 Electric Power Transmission
• Shunt admittance Y = j3.21 × 10−6 [S/km]
If a single resistive load of RL = 5 [Ω] is placed at the end of the line
(110 [km]), calculate the voltage at the load’s terminals.
Solution 6.11. Two mesh equations can be solved, considering the shunt
admittance to face the power source:
Vin =
i1 −i2
j3.21 × 10−6 [S],
0 =
i2 −i1
j3.21 × 10−6 [S] + i2(7.2 + j33 [Ω]).
The solution leads to:
i2 = 6.31 × 10−3 −j28.92 × 10−3.
So, the voltage at the load will only be of 0.149 Vin.
Problem 6.12. For a trasmission line with the following known parameters:
• Line resistance of 13 [Ω]
• Line inductance of 290 [mH]
• Earth capacitance 2 [µF] (both ends)
Calculate the active power delivered to RL at (75, 100, 125, 150, 200) [Ω].
Solution 6.12. The above description leads to a 3-mesh circuit that can be
solved by the following equations:
Vin =
i1 −i2
j753.98 × 10−6 [S],
0 =
i2 −i1
j753.98 × 10−6 [S] + i2(13 + j109.33 Ω) +
i2 −i3
j753.98 × 10−6 [S],
0 =
i3 −i2
j753.98 × 10−6 [S] + i3RL.
We can solve for i3 only so the resulting equation describes the speciﬁc
current in relation to active power (fed voltage can be considered unitary).
i3(RL) =
1.09 −j0.012
RL + 15.44 + j118.99.
As the load is purely resistive, the current’s magnitude can be used:
∥i3(RL)∥=
1.1
p
(RL + 15.44)2 + 1192 .
Power can be calculated through
∥i3∥2 RL =
1.21RL
(RL + 15.44)2 + 1192 .
So, evaluating diﬀerent values of the load would result in the shown plot
in Figure 6.16.

6.7 Simulation
255
FIGURE 6.16
Power vs load plot
6.7
Simulation
Transmission lines can be seen as a load themselves due to the non-ideal ef-
fects they impose on the network see Figure 6.17). A pure resistive load will
consume pure active power; however, whenever it is placed after a transmis-
sion line, the generators will have demands for reactive power as well. The
transmission lines also permit the voltage levels to be diﬀerent at their termi-
nals, so compensation must occur for the systems to reach desired electrical
magnitudes.
Transmission lines increase network complexity and make it more suscep-
tible to failure; they also make an automatic control system to be required.
However, electric distribution needs transmission lines despite their shortcom-
ings. Depending on their total length, a generator sees non-ideal loads while
the load sees a non-ideal power source. In order to improve network perfor-
mance, short transmission lines are implemented in micro-grid systems, which
generates and consumes energy in a “close” or “local” geographical area.

256
6 Electric Power Transmission
FIGURE 6.17
Transmission lines simulation

7
Power Distribution System, Unsymmetrical
Failures, and Power System Protections
Roughly speaking, power systems are composed of generators, and transmis-
sion and distribution systems for loads. An electric distribution system aims
to provide energy at a minimum voltage variation and as few interruptions
as possible if a failure on an element occurs (transmission lines short circuit,
transformer’s overload, etc.). Distribution systems’ networks take electricity
from the high voltage transmission lines and condition energy for consumers
and are designed to maintain a ﬁxed voltage regardless of the power ﬂow of
the load. Moreover, if an emergency condition occurs (transmission line short
circuit, transformer’s overload, etc.), distribution systems are able to make
the adjustments necessary to continue providing energy to the loads.
System planning is a major subject for satisfying the electricity demand
of the consumers. The impact of the distribution system is directly related
to economical, comfort, and safety issues of consumers. Generation plans are
made by electric companies in order to supply reliable well-quality energy and
maintain the optimal operation point of generators, which directly aﬀects the
cost of production.
The distribution substations are in strategic places so they distribute the
power ﬂow at the maximum cost-eﬀectiveness, minimizing transmission losses
while considering service reliability. The distribution system design starts at
the consumer level by analyzing the demand type, the power factor, and other
load characteristics. It continues with distribution transformer, that step down
the tension from primary voltage, and then the demands of the primary distri-
bution system are computed and assigned to substations that step down the
voltage from the long high-voltage transmission lines. Finally, the last step
is the generation: some generators are ﬁxed and always operating at their
nominal operation point as coal based power plants, while others are turned
on according to the generation plan. Some of the secondary plants are hydro-
electrical and diesel-based generators.
The factors that need to be considered for a power system design are
many, and some of them are very complex. For example, the designers need
to consider transformers and other electric machines’ impedances, dispatch
of generation, rates of charges for consumers, and an analysis for predicting
future levels of load and insulation. There are also more complex issues like
257

258
7 Distribution, failures, and protections
time and location of energy demands, duration and frequency of outages, and
the always-important economic factors.
In Figure 7.1, the basic structure of a power distribution system is shown.
This is the simplest structure where the load is unidirectional from the gener-
ators to the loads. The most basic elements of a distribution scheme are also
presented: electric generators, transformers, circuit breakers, and disconnector
switches. The principal diﬀerence between circuit breakers and disconnectors
is that the former are used to protect the circuit from overloads and short cir-
cuit conditions, while the disconnection switches are employed when a circuit
is required to be disconnected from the power supply. This element does not
have any protection at high voltages and it requires a circuit breaker before
the switch blades are opened.
7.1
Types of distribution systems
There are three basic schemes for power distribution systems:
• Radial networks
• Ring networks
• Mesh networks
Those systems are the most commonly employed, and in the next sections
they will be described based on functionality and advantages and disadvan-
tages with respect to other schemes. Distribution systems can also be a com-
bination of schemes, and for large power systems the line diagram will be
incredibly complex.
7.1.1
Radial networks
This is the most basic structure where the power ﬂows directly from the source
to the load; the path is unique and does not have a return. The power ﬂows to
each branch where a load is connected. In Figure 7.2 a basic scheme is shown.
There are many arrangements depending on the requirements of the power
system. The advantages of radial topology are: economical cost and little
equipment, while the principal disadvantages are the necessity of interrupting
the operation of the loads when maintenance is given to equipment like circuit
breakers, and the low reliability of this architecture; if a failure occurs at the
main power supply this failure will damage all the loads. This topology is
installed on both subterranean and aerial circuits, to be explained next.
Aerial radial networks are normally implemented in urban and rural zones
(see Figure 7.3). The main power supply comes from the substation and the
distribution is made with electricity poles situated near the loads and holding

7.1 Types of distribution systems
259
FIGURE 7.1
Basic structure of a power system

260
7 Distribution, failures, and protections
FIGURE 7.2
Basic radial distributions

7.1 Types of distribution systems
261
FIGURE 7.3
Aerial radial network
electric transformers. In rural areas the distribution is typically pure radial,
while for urban areas with great population density and therefore high load
density, interconnecting points are open for use whenever it is necessary to
feed the electric lines with a secondary net and continue operating.
Houses do not represent signiﬁcant loads; therefore, disadvantages of the
radial topology can be tempered by the economic advantages of this scheme.
Subterranean radial networks are implemented in urban zones with high
or medium population density, and where the environment is not favorable
for aerial networks. The subterranean networks have a lower failure rate than
aerial networks but the installation and maintenance have higher costs.
When a failure occurs on a subterranean network it is hard to locate, and
the repair requires more time and cost than with an aerial network. So, this

262
7 Distribution, failures, and protections
FIGURE 7.4
Subterranean radial networks
kind of network needs switches for interconnecting one branch with the oth-
ers for maintenance or emergency issues. This ﬂexibility makes subterranean
networks more reliable than aerial networks.
The disadvantages of this conﬁguration are the higher cost of installation
and maintenance, and overdesign, so that the lines can handle the overload
when a contingency occurs.
Nowadays the popularity of subterranean installations has increased for
residential suburban areas. Typically, the power supplies consist of ring net-
works taken from an aerial line. Step-down transformers are connected to the
ring and then the loads. In Figure 7.4 a diagram of a subterranean radial
network is shown.

7.1 Types of distribution systems
263
FIGURE 7.5
Ring network
7.1.2
Ring networks
Ring networks surround the complete area where the loads are placed and
return to the starting point, which makes it possible to feed the loads from two
sides. The complete cycle allows isolating certain zones for giving maintenance,
or in case of failure while the rest of the circuit continues to be supplied.
The ring conﬁguration is widely used for industrial networks because it
is designed to continue operating in a contingency; furthermore, the voltage
regulation is better that on a radial conﬁguration. If a failure occurs on a load,
the two adjacent interrupters are opened, but the lines continue to be energized
from the two sides, and then the remaining loads continue operating. The
principal disadvantage is the major initial cost and the problems in connecting
new elements to the circuits, because two new lines need to be prepared.
7.1.3
Mesh networks
The mesh conﬁguration provides greater reliability that the previous ones
because two power sources are used for feeding the entire loads. The power

264
7 Distribution, failures, and protections
FIGURE 7.6
Mesh network
ﬂow of any of the energy sources can be incremented in order to supply the
entire system. This type of conﬁguration is implemented when failures are
critical; for example, on a smelter or in a hospital, because all the loads are
connected to at least two power sources. The obvious disadvantages are the
high cost and overdesign of the power system. Figure 7.6 shows a scheme of a
mesh network.
7.1.4
Exercise
Consider the electric installation of a metallurgical plant, where the power
supply is critical and the power factor has to be regulated in order to avoid
penalty taxes. Build the circuit shown in Diagram 7.1 by connecting as shown

7.1 Types of distribution systems
265
Diagram 7.1
Mesh network
in Diagrams 7.2 and 7.3. Notice that the incoming high voltage has to be
reduced. Also observe the connection of the automatic power factor compen-
sator, and take care to have the same order for the phases on both ends of
the transmission lines.
Set all loads to zero position, close the relay, and connect the transmission
lines in parallel, increment the resistance in a balanced way, and observe the
portion of the power that ﬂows for each transmission line:
LOAD
P1 [W]
Q2 [VAr]
P2 [W]
Q2 [VAr]
R1
119
-70
37
71
R2
165
-70
50
70
R3
274
-70
82
68
R4
377
-70
112
66
Now activate the capacitive compensator for power factor correction and
increase the inductance load in a balanced way while keeping the resistance
ﬁxed and observing the value of correction. Finally, imagine that a power line
is undergoing maintenance. Deactivate one power relay and observe the power
ﬂow increment in one line.
Recommended equipment and connections:
• Resistive load

266
7 Distribution, failures, and protections
• Inductive load
• Capacitive load
• Overhead line model — Long
• Overhead line model — Medium
• Power circuit breaker
• Three-phase power meter
• Reactive power controller
• Switchable capacitor battery
• Three-phase transformer
• Three-phase supply unit
• Feeder manager relay
7.2
Faults on power systems
There are two main ideas behind fault analysis. When designing a power sys-
tem, all possible scenarios must be foreseen and quantiﬁed so proper operation
and management is planed prior to daily service. On the other hand, protective
systems are based on fault theoretical analysis, so their design and application
necessarily follows from it. As three-phase systems are those actually used in
most real life application, their analysis is presented next. Common motor
faults can be listed (statistically increasing) as follows [36, p. 244]:
• Faulty protection (5%)
• Other causes (19%)
• Rotor or bearing fault (20%)
• Long-time overheating (26%)
• Insulation fault (30%)
Most of the mentioned motor faults (81%) could be avoided if an eﬀective
relay was used [36, p. 244]. The main aim of protective relays is to extend
the electrical life of machinery and equipment, so understanding the main
protection techniques becomes paramount.
Most common electrical failures are due to insulation problems related to
short-circuit states among phases and/or ground. They can be summarized as
follows [53, pp. 239–240]:

7.2 Faults on power systems
267
Diagram 7.2
Connections for mesh network 1/2

268
7 Distribution, failures, and protections
Diagram 7.3
Connections for mesh network 2/2

7.2 Faults on power systems
269
ω
I1A
I1C
I1B
ω
ω
I2A
I0A
I0B
I0C
I2B
I2C
+
+
=
Positive Sequence
Negative Sequence
Zero Sequence
Real
System
FIGURE 7.7
Symmetrical components explanation
• Phase to ground
• Phase to phase
• Two phases to ground
• Three phases to ground
• Three phases
• Phase to ground with electric arc
7.2.1
Symmetrical components
A commonly used technique to analyze polyphasic unbalanced systems is
called symmetrical components. Many protective devices are based on this
methodology, so its understanding becomes a paramount tool [49, p. 75]. It
was discovered by Charles L. Fortescue while he was investigating unbalanced
conditions of induction motors in 1913; however, it was not until 1918 that
his technique was published [49, p. 75]. This methods separates a three-phase
system into three diﬀerent components which, when superimposed, form the
actual phasor representation of the real system [53, p. 247]. System separa-
tion is done as shown in Figure 7.7, where the three components are known
as positive sequence, negative sequence, and zero sequence.
• Positive sequence component is a phasor diagram that presents an A-B-C
sequence
• Negative sequence component is a phasor diagram that represents an A-
C-B sequence
• Zero sequence component is a phasor diagram of three equal-magnitude
parallel coaxial phasors
Whether or not the real system is balanced, it will present only a positive

270
7 Distribution, failures, and protections
ω
I1A
IA
I1C
IB
I1B
IC
ω
I0A
I0B
I0C
ω
I2A
I2B
I2C
+
=
ω
FIGURE 7.8
Equivalence between an unbalanced system and its components
or negative sequence symmetric representation; however, an unbalanced sys-
tem needs more than one component to be described. Conversion from a real
unbalanced system to its components’ representation can be understood by
the opposite process, as shown in Figure 7.8.
Any phase current or voltage can be derived from its components by using
the following equations,
IA = I1A + I2A + I0A = I1 + I2 + I0,
IB = I1B + I2B + I0B = a2I1 + aI2 + I0,
(7.1)
IC = I1B + I2B + I0B = aI1 + a2I2 + I0,
where a = ej2π/3 and a2 = aj4π/3 represent phase shifts of 120◦and 240◦,
respectively. Notice that every symmetrical component is equally phase shifted
(by 120◦multiples) and has equal magnitude Ii; i = 0, 1, 2; consequently,
construction of real phase characteristics can be made by using a with respect
to A phase. The equations shown above are also valid for voltage magnitudes.
In matrix form,
Ts =


1
1
1
1
a2
a
1
a
a2

,
(7.2)
where Ts is called the symmetrical component transformation matrix [53,
p. 250]. The magnitudes of each component can be computed by inverting Ts
as follows:
T −1
s
= adj(Ts)
|Ts|
,
(7.3)

7.2 Faults on power systems
271
where
adj(Ts) =


a4 −a2
a −a2
a −a2
a −a2
a2 −1
1 −a
a −a2
1 −a
a2 −1

,
(7.4)
|Ts| = a4 −a2 −a2 −a −a −a2 = a4 −3a2 + 2a.
Before performing the calculations to attain the inverse, some properties
of a should be taken into account:
a4 = ej8π/3 = ej2π/3 = a,
(7.5)
a3 = ej2π.
(7.6)
Using the properties above, some useful equivalences can be computed,
a4 −a2 = a −a2,
(7.7)
a2(a −a2) = a3 −a4 = 1 −a,
(7.8)
a(a −a2) = a2 −a3 = a2 −1.
(7.9)
Inverse calculation can be restated and easily solved as


I0
I1
I2

= T −1
s


IA
IB
IC

= 1
3


1
1
1
1
a
a2
a
a2
a




IA
IB
IC

,
(7.10)
|Ts| = 3(a −a2).
The preceding equation is the basis for determining whether or not the
symmetrical components exist, taking as input the direct measurements of
phases’ electrical magnitudes [49, p. 79].
In three-wire systems, all instantaneous voltages and currents must sum to
zero, as there is no neutral connection. Whether or not the neutral connection
exists, single-phase currents can ﬂow; otherwise, zero phase-sequence must be
substituted as zero in previous equations [53, p. 250]. As single-phase currents
ﬂow through the neutral connection, it can be easily calculated as
I0 = IA + IB + IC
3
= IN
3 .
(7.11)
Another analysis permits the inclusion of impedance variations between
symmetrical systems,


VA
VB
VC

=


ZA
0
0
0
ZB
0
0
0
Zc

[Ts]


I0
I1
I2

.
(7.12)
The preceding equation allows the analysis of some faults like phase dis-
connection (open circuit) [53, p. 250].

272
7 Distribution, failures, and protections
3ZN
+
–
+
–
+
–
+
–
+
–
+
–
+
–
+
–
ZN
ZN
+
–
+
–
e       :     1
j30°
+
–
+
–
ZN
3ZN
3ZN
Zero sequence
Positive/negative 
e       :     1
-j30°
Transformer type 
of connection
FIGURE 7.9
Sequence networks for Y-Y, Y-∆, and ∆-∆transformers
7.2.2
Sequence networks of electric machinery
Based on the Fortescue symmetrical components theory, electric machinery
used in power systems can be decoupled of its symmetrical components with
the objective of analyzing a complete power system under unbalanced condi-
tions. In this section the decomposition of transformers, transmission lines, a
synchronous machine, and an asynchronous machine is presented.
Transformers are the major component of power systems, and their type
of connection is essential to determining their behavior in a fault condition.
There are essentially three types of connections: Y-Y, Y-∆, and ∆-∆. For
Y-Y and ∆-∆transformers, the phase angle between voltage exchanges is 0◦.
In Figure 7.9, voltage phasor diagrams are represented as a per-unit system.
As the reader can see, the zero positive and negative sequence are the same
(equivalent circuit of a transformer), which is always valid for non-rotating
machines.
For a Y-∆transformer for the positive sequence, the high voltage side leads
the corresponding low voltage side by 30◦, while for the negative sequence the
high voltage lags the low voltage, as shown in Figure 7.10. In power system
notation it is common to label the high voltage side as H and the low voltage
as X. The displacement is obtained from phasor analysis when the ∆side is
converted into an equivalent Y for a simpler model. Figure 7.10 shows how
if the actual ∆is converted to an equivalent Y, the resulting voltage will lag
the high voltage side by 30◦. This is not a special problem because it can be
ignored when exhaust analysis is not required; for example: for calculating the
value of circuit breakers and fuses the approximation is good enough. Indeed,
we will not learn anything valuable by shifting the quantities in phase by ±30◦
[15].
For a ∆the zero sequence currents cannot enter or leave the windings, so
the equivalent circuit is represented as an open circuit. Usually, the impedance

7.2 Faults on power systems
273
X2
X3
X1
H3
H2
H1
FIGURE 7.10
Voltage phasor diagram for a ∆-Y step-up transformer with HV side leading
by 30◦
due to the magnetizing currents and reactance are ignored because they are
much larger than leakage reactance and resistance of windings.
In Figure 7.11 the sequence networks for transformers are presented.
Synchronous generators are usually grounded through an impedance Zn.
The impedances of electric machines are not equal for all the sequence net-
works as for transformers; an important problem emerges, since rotating ma-
chines are complex to describe mathematically and many assumptions are
made for delivering impedances’ values. To give the reader a sense, the phe-
nomena considered for obtaining the equivalent circuits are the degree of satu-
ration of the core, the linearity of the magnetic circuit, and the rotating speed,
and others must be considered.
For the positive-sequence network, the magnetomotive force produced by
the positive sequence current rotates at the synchronous speed, and a high
quantity of ﬂux crosses the rotor, such that the saturation provokes a high
value positive-sequence impedance. For the negative-sequence network, the
magnetomotive force rotates opposite to the synchronous speed and then its
speed with respect to the rotor is twice the synchronous speed. In this case,
currents are induced for preventing the magnetic ﬂux from penetrating the ro-
tor, and the negative sequence impedance is smaller than the positive sequence
impedance. The zero sequence impedance is generated because of leakage ﬂux,
harmonic ﬂux, and end turns, and its magnitude is smaller than positive and
negative sequence impedances. Exhaustive analysis can be found in many
classic books on the subject [46, 64, 34].
Also, it is important to know that the impedances needed for analyz-
ing failure conditions in rotating machines are the subtransient ones, which
are smaller than synchronous and transient impedances. The synchronous
impedances are used for normal, steady-state conditions analysis while the
transient impedances are used for stability studies. For transmission lines, it
is obvious that the negative and positive sequence networks are equal be-
cause those are passive, bilateral devices. As explained previously, for com-
plete transposed lines, the average impedance of the phases is equal. For

274
7 Distribution, failures, and protections
3ZN
+
–
Zero sequence
Positive sequence
Synchronous machine
Asynchronous machine
Zm0
+
–
Zm1
Negative sequence
~
Em1
+
–
+
–
Zm2
3ZN
+
–
Zm0
+
–
Zm1
+
–
Zm2
Transmission line
+
–
Zl0
+
–
Zl1
+
–
Zl2=Zl1
FIGURE 7.11
Sequence networks for rotating machinery and transmission lines
the zero sequence network the currents in each phase are identical in mag-
nitude and phase. Those currents have to return by both the ground and the
ground wires grounded at towers. The magnetic ﬁeld patterns caused by zero-
sequence currents is very diﬀerent from those caused by positive or negative
sequences where the currents have a phase diﬀerence of 120◦. The zero se-
quence impedance of transmission lines usually ranges from 2 to 3.4 times the
positive sequence impedance [30].
Figure 7.11 shows simpliﬁed models for network sequences, which do not
consider saturation eﬀects, magnetic losses, machine saliency, etc. Neverthe-
less, these networks are accurate enough for power system studies [38].
Once we have transformed a power system into three-sequence equivalent
circuits, we can obtain the Th´evenin equivalent on the failure point of the
power system. As we have studied, the zero and the negative sequence do not
have power sources, and the voltage sources of generators are only present in
the positive sequence. So the Th´evenin equivalents of negative and positive
are only an impedance, while for the positive there is a voltage source in series
with an impedance, as shown in Figure 7.12.
7.2.3
Coupled circuits for unsymmetrical faults
A very common application of symmetrical components is the calculation of
fault currents, which, because of the nature of the faults, generate a non-
balanced system.
For doing this, the interconnected sequence network formed from the

7.2 Faults on power systems
275
+
–
Zero sequence
Positive sequence
Thévenin equivalents
Zth0
+
–
Zth1
Negative sequence
~
+
–
+
–
Zth2
Vth
FIGURE 7.12
Thev´enin equivalents of sequence networks
Th´evenin equivalents of the sequence networks are used. The currents Ia0,
Ia1, and Ia2 are calculated and then transformed to phase currents by Equa-
tion (7.1):


I
′′
a
I
′′
b
I
′′
c

=


1
1
1
1
a2
a
1
a
a2




Ia0
Ia1
Ia2

v(t) = Vm cos(ωt + θ).
In this section the most common symmetrical faults of coupled circuits are
presented.
7.2.3.1
Single line-to-ground fault
Phase-to-earth fault implies one of the phases is short-circuited to ground,
and can be represented as in Figure 7.13, where the other phases are open-
circuited. The approach shown is like the one in [53, pp. 253–254].
From the equations derived above,


I0
I1
I2

= 1
3


1
1
1
1
a2
a
1
a
a2




IA
0
0

= 1
3


IA
IA
IA

.
(7.13)
Also,
VA = E −I1Z1 −I2Z2 −I0Z0 = E −I1(Z1 + Z2 + Z0) = 0,
(7.14)

276
7 Distribution, failures, and protections
E
a2E
aE
n
ZA
ZB
ZC
IA
IF
IF
IB
IC
A
B
C
FIGURE 7.13
Phase-to-ground fault
E
a2E
aE
n
ZA
ZB
ZC
IA
IF
IB
IC
A
B
C
FIGURE 7.14
Phase-to-phase fault
leading to
I1 =
E
Z1 + Z2 + Z3
.
(7.15)
The fault current is that ﬂowing through phase A, which in this case is
If = IA = 3I1.
(7.16)
7.2.3.2
Line-to-line fault
Another common fault is the phase-to-phase fault, which consists of two of
the three phases short-circuited (Figure 7.14). Again, the approach made is
similar to the one in [53, p. 256].

7.2 Faults on power systems
277
E
a2E
aE
n
ZA
ZB
ZC
IA
IB
IC
A
B
C
FIGURE 7.15
Phase-to-phase to ground fault
It can be quickly seen that
IA = 0,
(7.17)
IB = −IC,
(7.18)
VB = VC ̸= 0.
(7.19)
So,
I0 = 0,
(7.20)
I1 = 1
3IB(a −a2),
(7.21)
I2 = 1
3IB(a2 −a),
(7.22)
I1 = −I2.
(7.23)
Matching phases voltages:
a2E −a2I1Z1 −aI2Z2 = aE −aI1Z1 −a2I2Z2,
(7.24)
E(a2 −a) = I1(−aZ1 + a2Z2 + a2Z1 −aZ2)
= I1(Z1(a2) + Z2(a2 −a)).
(7.25)
Leading to:
I1 =
E
Z1 + Z2
.
(7.26)
7.2.3.3
Double line to ground
If both phases are not only short-circuited between them but with ground,
the analysis becomes diﬀerent (Figure 7.15) [53, pp. 257–258].

278
7 Distribution, failures, and protections
Statement of the problem is as follows:
IA = I1 + I2 + I0 = 0,
(7.27)
VB = VC = 0.
(7.28)
So, a linear equation system can be built by:
a2Z1I1 + aZ2I2 + Z0I0 = a2E,
(7.29)
aZ1I1 + a2Z2I2 + Z0I0 = aEc,
(7.30)
I1 + I2 + I3 = 0.
(7.31)
Solving for each current:
I1 =
E
Z1 +
h
Z2Z0
Z2+Z0
i,
(7.32)
I2 = −
I1Z0
Z2 + Z0
,
(7.33)
I0 = −
I1Z2
Z2 + Z0
.
(7.34)
7.2.3.4
Summary of coupled circuits
Based on the analysis made in the three previous sub-sections, it is convenient
to obtain the Th´evenin equivalent of each of the sequence networks and re-
couple them for calculating the current of the symmetrical component, and
then calculate the actual failure current.
In Figure 7.16 the schemes of the most common faults and the intercon-
nected network are presented for the most common types of faults. In addition
to the single and double line-to-ground and line-to-line failure, the three-phase
or symmetrical fault is represented. Obviously, as this is not an unsymmetri-
cal failure, the zero, negative and positive sequence networks are completely
decoupled.
7.2.4
Exercises
7.2.4.1
Line-to-earth fault protection
In this exercise, the feeder manager relay will be programmed in order to break
the circuit when a fault condition appears: in this case a solid fault-to-earth
fault in one phase of the transmission line.
Connect Diagram 7.4 proposed for the fault-to-earth and start the practice
shown in Figure 7.17.
Close contactor 1 and notice the measured voltages of the capacitors’ cur-
rents. Close contactor 2 and observe that the voltage in one phase becomes
zero with respect to earth, as will occur in a phase-to-earth fault condition.
The next step is to conﬁgure the feeder manager relay for opening the

7.2 Faults on power systems
279
Single line to ground
Zth1
~
+
–
Zth2
Vth
Zth0
3Zf
a
b
c
Zf
Diagram of a SLG fault
Sequence network connection for a SLG fault
Double line to ground
Zth1
~
+
–
Zth2
Vth
Zth0
3Zf
a
b
c
Zf
Diagram of a DLG fault
Sequence network connection for a DLG fault
Line to line
a
b
c
Diagram of a LL fault
Zth1
~
+
–
Zth2
Vth
Zth0
3Zf
Three lines to ground
Ia0
Ia2
Ia1
Ia1
Ia2
Ia1
Ia0
Ia2
Ia0=0
Sequence network connection for a LL fault
a
b
c
Diagram of a TLG fault
Zf
Zth1
~
+
–
Vth
Zf
Ia1
Sequence network connection for a TLG fault
Zth2 Ia2
Zth0
Ia0
Zf
Zf
FIGURE 7.16
Diagram of the electric fault and interconnected sequence network for most
commons faults

280
7 Distribution, failures, and protections
FIGURE 7.17
Connection diagram
power supply when a fault occurs. Close the smart grid SCADA program for
avoiding communication problems with the MSCom conﬁguration program.
Open the MSCom 2.exe and click on search −> on the serial port. In the
emerging window select COM 3 and a Baud rate of 9600 (see Figure 7.18).
Once the device is connected, open the function settings (see Figure 7.19).
Conﬁgure the 2Is current with the following info; this allows you to set up
the failure condition as a percentage of the In value (also conﬁgurable) and
the time of continuous failure state measured before the device does an action
(see Figure 7.20).
Then conﬁgure the action that the device will do when the fault state is
triggered. You can ﬁnd the do conﬁguration in the menu in Figure 7.21.
Now link the current fault condition with its corresponding time for trigger
with an AND logic function (see Figure 7.22).
Close the MSCOM 2 program and again open the smart grid’s SCADA
program, and connect relays 1 and 2. Observe how the device starts counting
and then open the circuit (see Figure 7.23).

7.2 Faults on power systems
281
FIGURE 7.18
Baud rate conﬁguration
FIGURE 7.19
Function settings

282
7 Distribution, failures, and protections
FIGURE 7.20
2Is current conﬁguration
Recommended equipment and connections:
• Overhead line model — Long
• Power circuit breaker
• Three-phase power meter
• Module for measuring the electric power
• Three-phase transformer
• Three-phase supply unit
• Feeder manager relay
7.2.4.2
Undervoltage and overvoltage protection
Connect a circuit in which failure conditions can be triggered, as in Dia-
gram 7.5.
Conﬁgure the feeder manager relay for an undervoltage condition following
the procedure in Section 7.2.4.1, and conﬁguring the function settings with
the information in Figure 7.24.
Also conﬁgure the do menu as in Figure 7.25.
Now feed the power system and generate an undervoltage condition. For
example, you can take oﬀone bridge of the line model as shown in Figure
7.26.
Finally, observe how the device breaks the circuit when the time has
elapsed. For the overvoltage condition, conﬁgure the function settings and
the do menus as in Figure 7.27 and Figure 7.28.
In order to generate the overvoltage, you can carefully disconnect one phase

7.2 Faults on power systems
283
Diagram 7.4
Connections for line-to-ground fault

284
7 Distribution, failures, and protections
FIGURE 7.21
Conﬁguring the action
FIGURE 7.22
Linking the fault condition
of the transformer and connect it to the +10% voltage (shown in Figure 7.29).
Observe how the failure condition is triggered.
Recommended equipment and connections:
• Resistive load
• Inductive load

7.2 Faults on power systems
285
FIGURE 7.23
Device tripped
FIGURE 7.24
Conﬁguring function settings
• Capacitive load
• Overhead line model — Long
• Overhead line model — Medium
• Power circuit breaker

286
7 Distribution, failures, and protections
FIGURE 7.25
Conﬁguration of do menu
FIGURE 7.26
Example
FIGURE 7.27
Conﬁguring function settings
FIGURE 7.28
DO conﬁguration
• Three-phase power meter
• Three-phase transformer

7.3 Electric protections
287
FIGURE 7.29
Generating overvoltage
• Three-phase supply unit
• Feeder manager relay
7.3
Electric protections
Every step in the power system requires meeting public demands in suﬃcient
quantity, and being reliable and safe, so the huge investment ﬁrst made can be
eﬀectively exploited by supplying a continuous service [36, p. 1]. In order to
maintain these requirements without major problems, there are two possible
paths to take:
• Implement a system using only non-failing components, which require nil
maintenance
• Foresee possible failures, design the whole system with isolable modules,
and install detection equipment to manage it
The ﬁrst presented option is obviously infeasible (if not impossible) and
highly expensive. The second option pretends to use a simpler system that

288
7 Distribution, failures, and protections
Diagram 7.5
Connections for undervoltage and overvoltage faults

7.3 Electric protections
289
cannot guarantee whole-time operation; however, the use of protective equip-
ment (also referred to as protective relay) enables many possibilities regarding
security issues:
• Maintenance can be eﬀectively programmed and given
• Big failures can be avoided by isolating the faulty module
• Small failures can be avoided by parallel devices or control modules
• Service can be provided continuously
• The system can be fully monitored
• Resulting system is safe to a high extent
• Quick restoration time after failure
A protective relay is a device that instructs the system to disconnect a
faulty module, letting other parts still operate without risk of being aﬀected
by the former failure. As the protective equipment allows the power system to
be operative with minimum interruptions, and enhancing restoration time, its
use is evidently very vital [36, p. 1]. In other words, its “fundamental objective
is to provide isolation of a problem area in the power system quickly, so that
the shock to the rest of the system is minimized and as much as possible is
left to continue service” [49, p. 18].
The perspective of protective devices is not to anticipate faults or troubles;
they act only at the presence of abnormal operation whenever the operation
limits have been surpassed. Although protective equipment implies the “pre-
vention” of fatal failures, it cannot actually prevent (anticipate) the unwanted
state from happening. It can only minimize and limit further damage in equip-
ment, facilities, or employees. [49, p. 18].
Protective equipment must have the following characteristics [49, p. 18],
[36, p. 2]:
Reliability: A certain degree of conﬁdence in the correct behavior of the
protection.
Dependable: It must depend on the trip conditions
Secure: It must not trip if there is no faulty scenario
Selectivity: Detection and isolation of the problematic module.
Speed: Minimum time between the occurrence of the fault and the protection
action.
Sensitivity: To react even towards the smallest fault.
Simplicity: Minimum equipment and equipment requirements to achieve
protection goals.

290
7 Distribution, failures, and protections
Stability: Guarantee continuous operation of adjacent system modules.
Economics: Maximum protection at minimal cost
The characteristics listed above imply a challenge for designers at all levels,
from the electronics and instrumentation layers to the integration at automa-
tion works. One of the most recurrent obstacles to system protection is that
it is not directly refundable as it is not required for normal system operation
and failures are infrequent [49, p. 23]. However, occurrence and magnitude of
failures are unpredictable and could force a new big investment if the system
is damaged; in this way, protection is needed to minimize the failure eﬀects,
hoping it will never be used.
Some systems diﬀerent from relays are also used to manage power ﬂow
as per a modern trend and pursuit of stable service and energy management.
Flexible AC transmission systems (FACTS) are able to provide a real-time
control of power ﬂows [53, p. 467] by incorporating condensers in series/shunts
to avoid voltage drops in transmission lines as well as to correct power factor
in an automatic manner. A FACTS can be deﬁned as “a power electronic
based system and other static equipment that provide control of one or more
AC transmission system parameters to enhance controllability and increase
power transfer capability” [10].
A particular type of FACTS is the STATCOM (Static Synchronous Com-
pensator), also known as a static synchronous condenser, as it is based on a
DC capacitor that provides power through a voltage source converter (VSC).
Whenever the STATCOM voltage is under the bus voltage, it sinks reactive
power; otherwise, it provides reactive power. Controlling the VSC based on
measured voltages allows the STATCOM to regulate power ﬂow.
While FACTS are not precisely protective, they are actually preventive,
especially because of their real-time compensating capabilities. Similar sys-
tems are considered to be a new trend capable of changing the conventional
philosophy in power systems operation and development [77, p. 466].
7.3.1
Types of faults and relays
Faults can be classiﬁed depending on three parameters: immediacy of current
ﬂow, consequences’ permanence, and the polyphasic conditions [36, pp. 7–9].
Active: Implies current ﬂowing from one phase to other phase or to ground.
Solid: It results from an immediate insulation breakdown. It is destructive
and is usually accompanied by explosions and ﬂashing: e.g., a rockfall
crushes a cable.
Incipient: It starts mildly. If the fault develops further with time it can
become solid: corona eﬀect.
Passive: They are not actually faults but conditions that will lead to them.

7.3 Electric protections
291
Commonly related to taking the system to operating points it was not
designed to attain. Some examples are:
• Overload
• Overvoltage
Transient: They do not imply permanent damage to the system or its insu-
lation. The system can be used again after a transient fault.
Permanent: System insulation is damaged and its operation is compromised.
Repairs must be made before the system can be re-energized.
Symmetrical: In three-phase systems a symmetrical fault is balanced, so it
can be considered to be at steady state.
Asymmetrical: If the fault shows oﬀsets and decays, an unbalance condition
is assumed, so the system is called to present an asymmetrical fault.
The most common way to classify relays is by their function [49, pp. 25–26].
Protective: They become active if the system faces an intolerable condition.
Regulating: They attempt to control the electric levels whose variation is
due to load changes. They are not used for fault conditions.
Reclosing, Synchronism Check: They are used to reconnect the system
after an outage.
Monitoring: They do not directly detect the faults but their related vari-
ables. Lamps and alarms could be considered monitoring relays.
Auxiliary: They can take the eﬀect of a given relay to apply over other
modules of the system. They provide other relays with the ability to reach
multiple objectives or higher voltages/currents.
Protective relays can also be classiﬁed depending on the technology they
use as the main means of energy ﬂow interruption. In a board sense, they
are electromechanical or static, where static implies the omission of moving
mechanical parts [36, p. 108]. Both analogic and digital electronic relays are
static and have displaced the traditional ones for many reasons. They are more
cost-convenient, accurate, ﬂexible, sensible, fast, and reliable; moreover, recent
improvements in silicon integration and power management ICs (integrated
circuits) have minimized sizes and enabled designers to integrate various pro-
tection systems within a single board. Usage of traditional relays together with
static ones is a common practice that attempts to incorporate a cost-beneﬁt
congruent protection system.
Along with analogic electronics improvements, microprocessors and mi-
crocontrollers are quickly incorporating more functions and capabilities, al-
lowing designers to determine the relay’s behavior through pre-programmed

292
7 Distribution, failures, and protections
instructions and calculations (algorithms) [36, p. 108]. Digital relaying implies
data acquisition and conversion (analog to digital), numerical processing, and
power electronics coupling. Depending on the application, the time needed to
acquire the signals and process the instructions will become paramount when
using a microprocessor-based relay; if the desired characteristic to capture is
fast, like current peaks, the time restriction became important for the relay’s
correct operation. However, a typical sampling time of 1 [ms] is enough for
taking 10 samples of every half cycle of a 50 [Hz] wave, which is convenient
in many protection applications. Whenever the reaction time is desired to be
short, solid-state electronics protections are preferred.
Digital protections are commonly attached to output mechanical relays
that take 10 −15 [ms] to respond [36, p. 113]. This implies that the fault will
be attended tardily from its detection; nonetheless, it is totally comparable
to traditional protections with standard performance, also including several
better characteristics like self-supervision, communication protocols, and con-
ﬁgurability (magnitudes/times).
The term intelligent electronic device IED is commonly used for digital
microcontroller-based power systems that achieve protection and regulation
of electric magnitudes. A single IED can integrate around a dozen functions,
including conﬁgurability, communication protocols, and automation capabili-
ties.
7.3.2
Relay operation
One principal protection paradigm is diﬀerential protection; the electrical
magnitudes that go in and out from a black-box system are compared in or-
der to ﬁnd diﬀerences that reveal malfunctioning inside the system. Although
equal magnitudes are not to be sensed as the system has losses, a fault can
be detected if this diﬀerence exceeds a certain threshold (Figure 7.30). The
system can eﬀectively detect faults as current changes drastically whenever a
fault condition is met, so the associated relays can be triggered [49, p. 181].
The preceding principle can be applied to individual modules or sets of
modules, making the fault detection capable of localizing the fault sources.
The relay shown in Figure 7.30 represents a coil whose activation depends
on current ﬂow; its contact can be placed in line with the module input so a
failure detection makes the contact open.
There are some basic electromechanical relays that have been used since
the early twentieth century [49, p. 186], and that represent the protective relay
area foundations. While their use has been relegated to modern solid state and
digital units, knowing their operating principles makes it easier to understand
how the problem was solved traditionally and why they are being replaced.
Beyond the classical still-in-use clapper and plunger relays, the overcurrent
relay (based on induction disc) and the cylinder relay (based on induction
cup) were once the main solution to the protective relay problem.
The induction disc shown in Figure 7.31 receives an AC voltage or current

7.3 Electric protections
293
Protected system
or module
Iin
Ie’
Ie’  - Ie’’
Ie’’
Iout
Relay
FIGURE 7.30
Diﬀerential principle
Keeper
Disc
Electromagnet
Lag
Coil
Input
Spring
Contact
Stop
Movable
Contact
FIGURE 7.31
Induction disc relay
on its input coil, which generates magnetic ﬂux along the electromagnet and
the keeper. The lag short-circuited coil present in one of the electromagnet
legs lags the magnetic ﬂux linked to it, making the movable disc rotate. The
disc is attached to a movable contact on its top, which moves radially with
disc rotation. If the fault condition takes long enough to allow both contacts to
join, the relay is triggered and further equipment can be enabled or disabled.
The disc includes a radial spring on its center that opposes contact movement
and returns to the stop condition if the fault is not present anymore [49,
pp. 186–189].
These relays were commonly known as time-overcurrent relays. Their op-
eration can be understood quite straightforwardly for overcurrent conditions,
where a high current would move the disc quickly while a low current would
take some time before the contact reaches the active state. The stop position
can also be used as a normally closed contact, so two actions can be performed
by the same relay at once.
There are cases in which it is important to know the direction of the
current or the relation towards a certain reference. Whenever the measured
electrical magnitude’s direction is desired as a means of protection, a cylinder

294
7 Distribution, failures, and protections
Electromagnet
Magnetic
Core
Contacts
2nd Coil
1st Coil
FIGURE 7.32
Cylinder relay
relay based on an induction cup (Figure 7.32) can be used. Imagine that for
a given system, the current is known to lag by 30◦phase A voltage; whether
or not voltage is connected to the ﬁrst coil and current to the second coil of
cylindrical relay, the magnetic core at the center will orientate axially to the
magnetic ﬂux generated, moving a contact to a certain operation position.
Whenever the current changes in magnitude or phase, the moving contact
will also move itself towards a contact, announcing the fault condition [49,
pp. 191–192].
Cylinder relays were extensively used for directional sensing, which in-
cludes among its applications phase and polarity fault detection. Its use to-
gether with time-overcurrent relays covered many fault scenarios and was the
prime option in protective relaying during the ﬁrst half of the twentieth cen-
tury.
Besides the two most common and useful relays mentioned above, there is
another that presents a way to compare magnitudes and calculate tolerable
impedances. Distance relays (Figure 7.33) compare two magnitudes between
its contacts through an electromagnetic bar that is inﬂuenced by both of
them, and can tilt depending on the magnitude of each one over a ﬁxed pivot.
If voltage and current are connected to the relay and it is adjusted so it reaches
equilibrium at a certain threshold condition, a change in impedance can be
detected as Z = V/I [49, pp. 192–193].

7.3 Electric protections
295
V
I
Pivot
Contacts
FIGURE 7.33
Distance relay
As mentioned before, traditional relays that allow measurement and com-
parison are no longer used and have been replaced by static systems; however,
electromechanical devices in continuity applications are commonly attached
to sensing/monitoring systems to intervene in electric line connection.
7.3.3
Overcurrent protection
Most transmission line protection equipment includes coverage of diﬀerent
faulty scenarios, making it possible to address other electrical issues diﬀerently
from distance protection. Besides the trip polygon’s being capable of detecting
many electrical problems on the overhead lines, diﬀerentiation over fault origin
allows an improved performance decision-making, thus providing the system
with alternative paths through localized disconnection, a history log of speciﬁc
events, and a better understanding of the causes and consequences of the fault,
among other things.
In this particular case, overcurrent protection will be our ﬁrst step into
the operation of the distance protection equipment in terms of conﬁguration,
as well as connection and integration with the other smart grid modules.
This type of relay is the simplest and cheapest type of protection. However,
when the system changes, they need to be readjusted, or in the worst scenario,
replaced. The typical applications are phase and ground fault protection on
distribution circuits, and electric utility in industrial and household applica-
tions where the cost of distance relay is not justiﬁed. Overcurrent relays have
been slowly replaced by distance relaying, but they continue to be extensively
used; therefore it is worthwhile to study those systems.
The most important reasons for suiting them to overcurrent relaying on
distribution systems are its low price and simplicity, the fact that very often
relaying does not need to be directional, and that reactor or capacitor tripping
may be used.
As the name implies, overcurrent relays are designed to operate when more
than a speciﬁed amount of current ﬂows through the protection, and there are
two types of overcurrent relays: time delay and instantaneous. Instantaneous

296
7 Distribution, failures, and protections
Time [s]
Current amplitude [A]
Instantaneous
Inverse
Very
Inverse
Extremely
Inverse
FIGURE 7.34
Distance relay
needs to be as quick as possible for commercial protection. The operation
time may be from 0.016 [s] to 0.1 [s] and the characteristics are illustrated in
Figure 7.34.
Time-delay protection has the characteristic of a trigger inversely to the
current ﬂowing in the relay. This typical characteristic is shown in Figure 7.34.
The most common time-delay relay’s characteristics are: inverse, very inverse,
and extremely inverse, which describe the rate as the time delay decreases
with the increase of the current.
Overcurrent relays are used primarily on distribution systems where the
low cost of the components is important. They can be installed along the
distribution systems, placing the fastest relays near to loads and time-delay
relays near the distribution substation.
Instantaneous relaying is used mainly in situations when the short circuit
current is substantially greater than any other possible situation. The adjust-
ment of sensitivity is based on the calculation of the short circuit current of
the far end of the protected line, and conﬁgured for a 25% higher current.
Usually, the instantaneous relay conﬁgured as previously described will cover
80% of the line section.
An important disadvantage of overcurrent relays is that during the low
periods of power consumption, diesel and gas-based turbines are usually shut
down, while at high-load periods the system may split into several parts.
Whatever the case, the short-circuit current will vary with the amount of
generators.
Pickup and time-delay settings need to be conﬁgured on time-delay relays;
those characteristics refer to:
Pickup settings: The pickup value is the minimum value of the operating

7.3 Electric protections
297
Time
Distance
3
2
2
1
1
Generator
Fault
FIGURE 7.35
Time-delay in trigger characteristic of overcurrent relays
current or other input quantity that is considered hazardous to operation
of the line. First we need to determine which values of minimum current
trigger the relay, and the maximum current that shall trigger the circuit
breaker immediately. Those values must be calculated for the protection
of all short circuit types in the line section protected. Whenever possible,
the settings should give additional protection to the next lines or adjoining
equipment, but it is important to remember that the primary function is
to protect the line itself and not compromise backup features.
Time-delay settings: The purpose of time delay is to coordinate relays with
each other, so the closest relay to the fault will open ﬁrst, and if the
problem is not ﬁxed, the next circuit breaker should be triggered. As there
are more line sections in series, the tripping time increases at the source
end. This is done to avoid catastrophic blackouts in the power system.
Figure 7.35 shows the time response of the relays according to the distance
at which the fault is generated. As can be seen, relay 1 is conﬁgured to
trigger immediately, the second one has a small time delay, and the relay
closest to the generator has a bigger time delay. This characteristic of
triggering was traditionally based on a rotating disc that closes a contact.
The larger the area that the rotating disc traveled, the larger the triggering
time. Modern relays use a digital timer to reach this action.
Example 7.1. Determine the CT ratio, pickup, and time-delay settings for
the transformer at circuit breaker 1 assuming non-pilot relaying. Assume that
nominal current is 60 [A], minimum fault current is 300 [A], and maximum
fault current is 600 [A]. Select the CT ratio in order to give 1 [A] at the
secondary current for the maximum load (see Figure 7.36).
The current ratio shall be 60:1, since we want to reduce the trigger signal
from 60 [A] to 1 [A]. Some authors recommend conﬁguring the relay settings
as twice the maximum load and one third of the minimum fault divided by 60.
The resulting conﬁguration is: [1.66, 20].
The operation current is 60 [A] and the minimum current of triggering is
set to be 1.66 × 60 = 100, giving 1.66 pu to prevent false operation. Assuming
no coordination, the relay shall trigger at its fastest conﬁguration.

298
7 Distribution, failures, and protections
A
R
1
F1
FIGURE 7.36
Example diagram
Magnitude
Time
Current
Voltage
Current
interruption
FIGURE 7.37
Overvoltage caused by current interruption in a transmission line
7.3.4
Overvoltage protection
Whenever the grid system presents an abnormal or unexpected rise in voltage,
this can be detected by parallel connected protection equipment so that the
grid can be disconnected in order to prevent damage to connected loads and
generators.
In this lab, a slight overvoltage condition will be generated to test protec-
tion against this particular condition, considering a diﬀerent relay-logic ap-
proach, and the “reset level” parameter commonly found in protection equip-
ment.
Internal overvoltage occurs when overvoltage is generated by the system
itself; for example, in switching operations, fault conditions, resonance phe-
nomena, and sudden changes in system parameters.
Switching operation: When transformers or other electric machines are
switched out, the magnetizing current may remain before the instanta-
neous value of the current reaches zero, because it cannot be dissipated

7.3 Electric protections
299
immediately. Instead, the energy will be dissipated in a damped oscillation
due to the reactive nature of the transformer together with the capacitance
of the connections. The magnetic energy at the instant of chopping the
current is (Im2 × L/2), where Im is the magnetizing current and L is the
electric machine inductance. In a similar way, the electric energy is equal
to V 2
0 × C/2, where V0 is the peak value of the voltage and C is the ca-
pacitance of the windings and connections to the electric machine. At the
moment of chopping, the voltage induced magnitude is: V0 = Im
p
(L/C)
with a natural frequency of fn = 1/(2π
√
LC). Figure 7.37 illustrates the
induced voltage at the moment of current chopping.
Resonance: This phenomenon occurs in an electric circuit when the admit-
tance and reactance of a series RLC circuit have the same magnitude and
therefore cancel each other because of the 180◦phase displacement. A sit-
uation like that may arise in a partially open circuit (faulty circuit breaker
or broken conductor) when one phase remains connected while the other
two are opened. As shown in Figure 7.38, if the phase c remains connected
while the other two are opened, a resulting circuit and the inductive re-
actance (ωL + ωL/2) are equal to the capacitive reactance (1/2ωC). It
is important to notice that a condition for a possible resonance is not to
clamp the neutral point of the load, despite the fact that the neutral point
of the generator is clamped.
Sudden loss of load: The most common reason for overvoltage in power
systems is the sudden disconnection of some heavy loads. Since the current
of the synchronous generator decreases, the voltage at the terminals will
increase because the internal voltage generated is dependent on the speed
of the machine and the excitation current of the ﬁeld. Considering that
there is no regulation device for the ﬁeld current, the internal voltage of
the synchronous generator will remain constant; therefore, the voltage at
the end terminals will increase. Although this problem is easy to solve, if
no action is taken, overvoltage may damage the transformers, and other
equipment connected to the generator. Figure 7.39 shows a synchronous
generator as a simpliﬁed static model to illustrate the issue described.
Most electric machinery operates close to the knee point of ferromagnetic
material. Therefore, a small overvoltage is reﬂected in a large increase in ex-
citation current that may cause overheating and permanent damage to equip-
ment.
Table 7.1 summarizes the typical permissible overvoltage at no load for
generators and transformers, with data taken from [49]:
It is important to avoid long overvoltage conditions. Traditional overvolt-
age relays were designed based on inverse time tripping characteristics, as
shown in Figure 7.40.
Example 7.2. Review questions

300
7 Distribution, failures, and protections
Phase a
Phase b
Phase c
Phase c
FIGURE 7.38
Faulted circuit breaker and resulting remaining circuit
+
-
+
-
FIGURE 7.39
Synchronous generator equivalent circuit
TABLE 7.1
Electric machinery maximum operation time at overvoltage conditions
Generators
Transformers
Percentage of
overvoltage
Permissible time
of operation
Percentage of
overvoltage
Permissible time
of operation
105
Continuous
110
Continuous
110
30 minutes
115
30 minutes
115
5 minutes
120
5 minutes
125
2 minutes
130
3 minutes
1. What does the “Time Delay” parameter imply? It makes the system wait
for the amount of time speciﬁed to trip after a fault is detected.
2. What is the use of a trip delay on a protection system? It permits the sys-
tem to continue working if the fault detected was momentary or a bad mea-
surement. If the system remains in a faulty condition for a given amount
of time, then there will be no doubt of a faulty scenario. It is like a digital
anti-bump device.
3. What does the “ResetRatio” parameter achieve at step 9? It works like
a hysteresis latch by permitting the system to release the trip only if the
measured magnitude is below a predeﬁned percent from the trip condition.

7.3 Electric protections
301
Time [s]
Percentage of rated voltage [%]
18
16
14
12
10
8
6
4
2
0
120
140
160
180
200
FIGURE 7.40
Tripping characteristics of overvoltage relay

302
7 Distribution, failures, and protections
So, the system will trip beyond a given voltage but will release the fault
state only if the voltage is measured below the “ResetRatio” percent.
4. What are your conclusions about relay logic in this exercise? How would it
be changed if the relay used was R3? Applied relay logic allows the system
to hold the contactor open even if a malfunction occurs, and disconnects
the grid whenever the protection module is not able to continue working.
R3 has an opposite normal state, so it would let the grid be connected even
in fault scenarios.
Example 7.3. A synchronous generator with the following characteristics is
being used as power supply to an industrial plant:
• 480 [V ] (∆connected)
• 60 [Hz]
• Synchronous impedance: 0.015 + j0.1 [Ω]
• Full load current: 1200 [A] at 0.8 inductive PF
• Friction losses: 40 [kW]
• Core losses: 30 [kW]
If the generator is supplying current at full load and then the load is sud-
denly disconnected, how much voltage will be at the generator terminals in
volts and in percentage of the nominal voltage? According to the recommen-
dations in the text, for how much time will the generator be able to continue
operating?
If the load is disconnected, the terminals voltage of the generator will be
the internal voltage of the electric machine, since the current will stop ﬂowing
and no voltage will be dropt at the impedance of the generator:
EA = Vφ + IA(ZA),
where:
• EA is the internal voltage generated at phase a, which will also be the
voltage at the terminals because the electric machine is connected in ∆
• Vφ is the external voltage
• IA is the phase a current
• ZA is the generator impedance of phase a
IA = 1200
√
3 ∠−arccos 0.8A = 692.82∠−36.87◦,
EA = 480 + (692.82∠−36.87◦) × (0.015 + j0.1) = 532.161∠5.304◦.

7.3 Electric protections
303
The percentage of overvoltage is:
%overvoltage = 532.16V
480V
= 1.1086.
The overvoltage will be 10%, so the generator could continue rotation dur-
ing 30 minutes without permanent damage.
7.3.5
Undervoltage protection
It is possible that the generating system suddenly disconnects one or more lines
or simply reduces the voltage magnitude in one of them due to unexpected
failures, such as a short-circuit to ground or between lines.
In this lab, an undervoltage condition will be generated to test protection
against phases’ disconnection or abnormal voltage reduction.
Undervoltage protection is important in motors, since low voltage opera-
tion results in high current demand or failure to start, running at low speed,
and even pullout. The torque equation of the motor is directly proportional
to the voltage applied to the terminals; the reduction in torque by low voltage
is described by the following equation:
τavg =
 V
VR

τR −τL,
where:
• τavg is the average torque produced
• V is the applied voltage
• VR is the rated voltage of the electric machine
• τR is the rated torque
• τL is the load torque
It is clear that if the applied voltage is small enough, the load torque may
be higher than the average torque, resulting in full braking of the electric ma-
chine, high current demand (locked rotor), and possible damage to the motor
windings. When undervoltage is presented for several seconds, motors should
be disconnected, making undervoltage relays ideal for tripping motors. For 50
to 70% of rated voltage, instantaneous tripping is recommended, since accord-
ing to the previous equation, the output torque for a 50% applied voltage will
be just 25% of the rated torque.
The main reason for using undervoltage protection in industrial applica-
tions is to ensure tripping of circuit breakers on a loss of supply. If the motors
are not disconnected, the system may overload in the moment of reconnection
because of the starting of several induction machines at the same time. High
starting demand of induction motors may trip overcurrent protection of feeder
transformers and overheat power conductors.

304
7 Distribution, failures, and protections
Example 7.4. Review questions:
1. What happens whenever any phase is disconnected from the measuring
unit of the protection (VT4)? As soon as one phase is loose, the other two
voltage measuring transformers report wrong voltages.
2. What diﬀerence does it make to conﬁgure the system as “2 out of 3” or
“1 out of 3”? As voltage measurements are unbalanced and incorrect, the
system trips another phase along with the one actually disconnected, so
both conﬁgurations do the same.
3. If the generator is subjected to load, what happens with its output voltage?
It is reduced, so more excitation voltage is needed to maintain the desired
output level.
Example 7.5. A 6-pole induction motor connected in Y with a nominal ten-
sion of 440 [V ] and 60 [Hz] has the equivalent circuit shown in Figure 7.41
(all values are in [Ω]).
The motor is used for pumping oil and has a constant load of 50 [Nm]. At
nominal voltage, the torque speed characteristic is shown in Figure 7.42.
FIGURE 7.41
Equivalent circuit
What will be the minimum voltage that can be applied to the motor before
pullout?
The pullout torque is 110 [Nm] with the conditions imposed, applying the
torque reduction formula of the text:
τavg =
 V
VR

τR −τL.

7.3 Electric protections
305
FIGURE 7.42
Torque speed characteristic
For a pullout condition:
0 =
 V
VR

110 −50,
V
VR
=
r
50
110 = 0.674.
So, with an applied voltage of V = 0.674×440 = 296.65, the pullout torque
of the motor will be 50 [Nm], run-in verifying the torque speed characteristic
shown in Figure 7.43.
FIGURE 7.43
Torque speed characteristic
7.3.6
Load unbalance protection
Whenever there is phase unbalance from the generation system or the triphasic
load, a parasitic ﬂow of current appears at the neutral connection. Other

306
7 Distribution, failures, and protections
conditions may lead to residual current ﬂow, such as harmonic distortion; its
eﬀects must be detected and restricted as representing a power leakage derived
from unwanted variations on energy consumption and generation, which may
damage the system.
This protection is used in equipment or a networks component in which
direction of ﬂow could change as a result of a fault in the power system; for
example, when a short circuit occurs between phases or phases to ground, the
natural direction of the current may change since the location of the fault has
zero voltage.
Residual overcurrent protection is used for feeders with a capacitive current
of the same order of magnitude as the earth fault current. In those circuits, the
phase-to-earth capacitance is high enough for a zero-sequence current to be
detected by a non-directional protection when a short circuit occurs. There-
fore, directional protection and overcurrent protection are complementary.
In order to determine the direction of a fault, a reference (or polarizing
quantity) needs to be provided to the relay. The polarizing variable can be a
zero-sequence voltage or zero-sequence current. In this case we are studying
the current polarization.
Current polarization: The current in the neutral line of a power circuit
can be used as a polarization value. This type of polarization has the impor-
tant advantage of only requiring one current transformer, while the voltage
polarization requires 3 VT. Another advantage is the possibility of measuring
high currents with a much more economical device. The main disadvantages
are: the saturation of CT when a short circuit occurs, producing a false value
in the false residual current. When there are mutually coupled lines, current
reversal may occur.
The zero-sequence current can be deﬁned as:
I0 = 1
3(Ia + Ib + Ic),
where Ia, Ib, and Ic are the currents of phase a, phase b, and phase c, respec-
tively.
The direction of the fault can be determined with the phase displacement
between the current and the zero sequence current. When the angle of the
phase’s currents exceeds 90◦of the characteristic angle of the directional relay,
the relay is tripped. The characteristic angle must be determined so that only
changes in current direction trip the relay. Figure 7.44 shows a characteristic
curve of a directional overcurrent protection device.
Example 7.6. Review questions:
1. Why does a new current appear when the loads are unbalanced? The new
current is the one that ﬂows through the neutral line due to load unbalanc-
ing.

7.3 Electric protections
307
Non-tripping
zone
Characteristic angle
Zero-sequence current
Tripping
zone
FIGURE 7.44
Tripping characteristic of directional relay
2. How can you know if the unbalancing has occurred on the generator/load
side? The phase (angle) of the current is opposed to that of its corre-
sponding phase whether or not the fault is found on the load side; on the
other hand, the neutral current can have the same direction (angle) as the
corresponding phase’s current if the fault is found on the generator’s side.
3. Why does the disconnection of a generator’s phase trigger the residual
overcurrent fault? The protection is conﬁgured to detect the magnitude of
neutral current; in this way, it does not matter if the fault is found at any
side. Brieﬂy, this fault detection is not directed.
4. What happens at s 8 and 9? Why? The resulting neutral current is directed
to a composite angle conformed by both generator and load unbalancing.
This angle depends on which phase is actually faulty and on which side it
is. Knowledge about the neutral current’s angle may lead to a fully opera-
tive directed protection.
5. Why does a new current appear when the loads are unbalanced? The new
current is the one that ﬂows through the neutral line due to load unbalanc-
ing.
6. How can you know if the unbalancing has occurred on the generator or
the load side? The phase (angle) of the current is opposed to that of its
corresponding phase whether or not the fault is found on the load side; on
the other hand, the neutral current can have the same direction (angle) as
the corresponding phase’s current if the fault is found on the generator’s
side.

308
7 Distribution, failures, and protections
7. Why does the disconnection of a generator’s phase trigger the residual
overcurrent fault? The protection is conﬁgured to detect the magnitude of
neutral current; in this way, it does not matter if the fault is found at any
side. Brieﬂy, this fault detection is not directed.
8. What happens at s 8 and 9? Why? The resulting neutral current is directed
to a composite angle conformed by both generator and load unbalancing.
This angle depends on which phase is actually faulty and on which side it
is. Knowledge about the neutral current’s angle may lead to a fully opera-
tive directed protection.
7.3.7
Distance protection
Detection of a given fault is not enough; the approximate location of the fault
is also expected to be known in order to make decisions that let the actual
fault be isolated while its surrounding grid elements remain unaltered.
Additionally, the direction of the fault with respect to the protection loca-
tion is also important: Imagine that a new generator is added in parallel to a
previously installed one. In that case, current conditions will change, making
a certain protection consider erroneous data; hence, a protection aware of the
fault’s direction and distance, and with isolation capabilities, is needed.
This type of protection is reliable when the distance between line termi-
nals is relatively far. The principle of operation is to measure the impedance
between the relay location and the fault location. Since the impedance of trans-
mission lines is almost constant when a failure occurs, this can be detected as
a change in the impedance of the faulted line. For distance impedance the R-X
(real and imaginary part of impedance) diagram is the basic tool. The dis-
tance protection is not as accurate as comparing the current entering a circuit
and leaving the circuit, since both voltage and current change dramatically
during a fault. However, distance protection is economically viable for long
transmission lines since it does not require current measurements at every load
point and communication between power measurement devices. Those are the
principal reasons for the extended application of distance relaying protection.
The typical settings of the distance relay depend on the programed zone
of protection; see Figure 7.34.
Zone 1: This is also called the instantaneous zone because the relay opens
as fast as it can when a measured impedance is within the protection
zone of the R-X diagram. For modern digital distance relays, this zone is
conﬁgured for a distance of about 85% of the total length until the next
relay. This is made in order to avoid overreaching the protected line due
to possible errors in measuring of current and voltage.
Zone 2: The remaining 15% of the line must be covered by the second zone, as
seen in Figure 7.45. It is recommended that the second zone be conﬁgured
to at least 120% of the protected line. In the traditional relays, zone 2

7.3 Electric protections
309
Zone 1
Zone 2
Zone 3
Triggering
time
Zone of protection
FIGURE 7.45
Zones of protection and time to trigger the circuit breaker
was activated by a timer signal trigger, but in the modern devices this is
implemented in software. Some authors recommend setting the zone to up
to 50% of the length of the adjacent transmission line, to ensure that zone
2 does not extend beyond zone 1 of the next relay.
Zone 3: Also known as remote back-up protection, usually set at least 1.2
times the impedance that will be measured for a fault at the remote end of
the second line section. When there are interconnected power systems, the
impedance measured will be much greater than the actual fault impedance;
therefore, more than three protection zones will be unpractical.
In polygonal relays it is possible to work with zero and negative sequence
voltages and currents, making fault resistance results less sensitive to the
positive sequence load. There is no advantage to extending the R2 zone to
the left as in MHO relays; although for convenience, many times it is deﬁned
as equal to R1, the impedance of the line is set in the center of the relay’s
X-R characteristic, and the quadrilateral is aligned with the line angle. The
resistance lines are parallel to the line angle because the fault resistance in a
quadrilateral relay is computed independently of the line resistance.
Quadrilateral elements can detect phase and ground faults by applying
mathematical computation. They can be conﬁgured in all directions to pro-
vide the desired sensitivity and can be combined with conventional MHO
relays to maintain the advantages of the well-known MHO relay and provide
additional protection to the arc resistance zone. Diﬀerences in the source and
line impedances may cause the reactance element to overreach or underreach.
It is common to reduce the reactive reach for covering high fault resistance
and use the MHO characteristics for giving a nice protection along the line
and avoiding overreaching and underreaching (see Figure 7.46).
Example 7.7. Review questions:

310
7 Distribution, failures, and protections
Line
angle
R1
ZL1
R2
B
X
R
Carrier start zone
FIGURE 7.46
Quadrilateral relay R-X characteristic
1. What is the main diﬀerence between overcurrent protection and distance
protection? Overcurrent protection measures the current directly and re-
acts depending on current thresholds, while distance protection calculates
the complex load based on voltage and current. Calculating the directed
resistance and reactance can account for diﬀerent faults as they reach the
inner area of the polygon, even at diﬀerent particular points. Coverage is
bonded in this way.
2. The process of step 4 is not possible for real overhead lines, so how can this
be done on real lines? Lines information is available so its resistance and
reactance can be calculated at a certain distance; thus, you can conﬁgure
the zone polygon. In addition, equivalent arc resistance or humidity fault
conditions can be integrated to the calculus.
3. Measured impedances are not the same as known resistance and reactance
of lines; why? The current and voltage ratios of instrumentation trans-
formers change the numerical value of calculated impedance. Indeed, the
calculation loops of module DL 2108T22 are designed to measure line-to-
line magnitudes.
4. Measured distance to fault is not consistent with expected results; why? We
are using an inductor to emulate phase-to-ground faults. A short-circuit
condition assumes much lower resistances/reactances between faulty lines,
so calculations will never be accurate. Moreover, an inductor adds an un-
expected reactance to the line measurements, hence distance is not properly
calculated.
Example 7.8. Consider a power system represented by Figure 7.47.

7.3 Electric protections
311
Bus A
Fault
FIGURE 7.47
Electric diagram
At bus A there is a distance relay. The nominal voltage of the system is
380 [V ] and the nominal apparent power is 1.1 [kV A]. The transmission line
impedances are 13 + j109 [Ω] from the power source to the relay at bus A
and 3.3 + j30.16 [Ω] from bus A to the fault location. Consider that positive
and negative sequence impedances are equal, and zero sequence impedances
are 30 + j190 [Ω] and 10 + j60 [Ω] for the ﬁrst and second transmission lines,
respectively.
For a three-phase fault, if the system is balanced, only the positive sequence
current exists. So, calculating the phase “a” current considering a solid three-
phase to ground fault:
Ia = I1 =
380
√
3
(13 + j94.25)(3.3 + j30.16) = 0.227 −j1.734
[A].
The voltage of phase “a” referred to neutral at the relay location is equal
to:
Va = 380
√
3 −(0.227 −j1.734) × (13 + j94.25) = 53.038 + j1.129
[V ].
So, the impedance seen by the relay at point A is equal to:
Zf = Va
Ia
= 3.3 + j30.16.
Considering that a solid line-to-line fault occurs between phase “a” and
phase “b,” the positive and negative sequence currents are equal to:
I1 = −I2 =
380/
√
3
2 × (13 + j94.25)(3.3 + j30.16) = 0.1135 −j0.867
[A].
Applying Fortescue’s transformation to obtain the phase currents:


Ia
Ib
Ic

=


1
1
1
1
a2
a
1
a
a2




I0
I1
I2

=


0
−1.5017 −j0.1966
1.5017 + j0.1966

.
Calculating the fault sequence voltages:
V1 = 380
√
3 −(0.1135 −j0.867) × (13 + j94.25) = 136.20 + j0.57362
[V ],
V2 = (−0.1135 + j0.867) × (13 + j94.25) = −83.1902 + j0.57362
[V ],

312
7 Distribution, failures, and protections
and obtaining the phase “a” and “b” voltages:


Va
Vb
Vc

=


1
1
1
1
a2
a
1
a
a2




V0
V1
V2

=


53.01 + j0.0115
−26.5 −j190.57
−26.5 + j124.39


Zf = Vb −Vc
Ib −Ic
=
−j380
2 × (−1.5017 −0.1966j) = 16.285 + j124.39.
7.4
Power line carrier
The power transmission system provides an extremely large interconnected
network, so the potential of employing this hardware for communication issues
has been a very attractive research topic for electric and telecommunications
engineers around the world. The power line carrier (PLC) was introduced in
1919 as a communication technique based on high-frequency signals (between
20 [kHz] and 300 [kHz]) ﬂowing through the power transmission system. Yet
the explosion of high-bandwidth technology and optic ﬁber made PLC a dying
technology for many years. Nowadays, this communication system is mainly
employed for protective relaying, voice and signal transmission, and SCADA
systems.
If only communication is needed for protective relaying, PLC is the obvious
choice. Maintenance is one of the principal disadvantages for PLC applications
because in some economic architectures the transmission line must stop oper-
ating before maintenance service starts.
Amplitude modulation (AM), frequency modulation (FM), single side
band (SSB), and frequency shift keying (FSK) are the most common tech-
niques implemented in PLC to encode information. Typically, the transmis-
sion takes place via coupling equipment to the transmission lines where carrier
signals of 10 [ms] blocks of carrier and 10 [ms] blocks of no carrier are trans-
mitted. The receiver needs to decouple the communication signal from the
combined signal. For doing this, a coupling capacitor and tuner separate the
desired frequency-range for obtaining the communication signal, and a de-
modulator extracts the information. For large transmission lines, line traps
are needed to prevent the carrier from travelling down undesired paths.
The development of the complex frequency modulation process and the
advances in highly integrated inexpensive electronics has enabled us to reach
data transmission rates of about 1 [Mbps], which is about 12 times faster than
the ISDN capacity. The correct implementation of this technique will make
it possible to transmit phone and Internet signals over transmission lines and
provide customers with a reliable communication service. The potential of
this technology goes far beyond this; other interesting applications are long-
distance monitoring of power consumption, control of intelligent household

7.5 Theoretical problems
313
appliances, and monitoring of air-conditioning systems, alarm systems, and
many others.
The advancing privatization and the international energy market compe-
tition, added to the liberalism of the telecommunication market, will enhance
the commercialization of power lines for communication issues, and traditional
network operators will ﬁnd a very strong competitor.
7.5
Theoretical problems
The single line diagram of a power system is shown below. The neutral line
of the generator is solidly grounded, while the motor is grounded through a
reactance of Xn = 0.02835 pu; the transformers are both solidly grounded. The
prefault voltage at bus 2 is 1.00 pu. The motor is an induction machine. The
following table sums up the principal characteristics of the electric machinery:
Element
Power and
voltage base
X1
X2
X0
Generator 1
1000 [MV A],
20 [kV ]
0.1 pu
0.15 pu
0.05 pu
Motor 1
800 [MV A],
18 [kV ]
0.162 pu
0.1785 pu
0.0648 pu
Transformer 1
1000 [MV A],
20 [kV ]∆/Y
400 [kV ]
0.1 pu
0.1 pu
0.1 pu
Transformer 2
800 [MV A],
400 [kV ]Y/∆
18 [kV ]
0.081 pu
0.081 pu
0.081 pu
Transmission Line
20 [Ω]
20 [Ω]
60 [Ω]
The line diagram of the power system is shown in Figure 7.48.
FIGURE 7.48
Line diagram
Problem 7.1. Obtain the per-unit equivalent circuit for the zero, positive,
and negative sequence networks taking the generator’s base.

314
7 Distribution, failures, and protections
Solution 7.1. First, let’s obtain the impedances at a common base with the
following equation:
Xnew = Xold
 Vold
Vnew
2
×
Snew
Sold

,
where “new” refers to the desired base for the voltage and power, and “old” is
the original base.
Xm1 = 0.162
18 [kV ]
18 [kV ]
2
×
1000 [MV A]
800 [MV A]

= 0.2025,
Xn = 0.02835
18 [kV ]
18 [kV ]
2
×
1000 [MV A]
800 [MV A]

= 0.03544,
XT 1 = 0.1
20 [kV ]
20 [kV ]
2
×
1000 [MV A]
1000 [MV A]

= 0.1,
XT 2 = 0.081
18 [kV ]
18 [kV ]
2
×
1000 [MV A]
800 [MV A]

= 0.10125.
For the transmission line, the impedance base is at the high voltage side:
Zbase = V 2
base
Sbase
=
400 [kV ]2
1000 [MV A] = 160 [Ω],
XT L = 20
160 = 0.125.
Calculating the resting impedances and updating the table’s parameters to
a 1000 [MV A], 20 [kV ] base:
Base:
1000 [MV A], 20 [kV ]
Impedance
X1
Impedance
X2
Impedance
X0
Generator 1
0.1 pu
0.15 pu
0.05 pu
Motor 1
0.2020 pu
0.2226 pu
0.081 pu
Transformer 1
0.1 pu
0.1 pu
0.1 pu
Transformer 2
0.10125 pu
0.10125 pu
0.10125 pu
Transmission Line
0.125 pu
0.125 pu
0.375 pu
Problem 7.2. Obtain the Th´evenin equivalent for each of the sequences seen
from bus 2.
Solution 7.2. The sequence networks can be obtained from Figure 7.9 and
Figure 7.11. The Th´evenin equivalent for the zero sequence is Zth0 = j0.081+
j0.03544.

7.5 Theoretical problems
315
For the positive sequence: Zth1 = j0.2020(j0.1+j0.1+j0.125+j0.10125),
while the Th´evenin voltage is always the prefault voltage at the failure point.
Considering the no-load condition, the voltage will be equal to the generator
voltage = 1 pu.
The negative sequence impedance is calculated as follows: Zth2
=
j0.2226(j0.15 + j0.1 + j0.125 + j0.10125). The resulting systems are shown in
Figure 7.49.
+
-
+
-
Zero sequence
Zero sequence
Positive sequence
Positive sequence
Negative sequence
Negative sequence
+
-
+
-
+
-
1
2
1
2
1
2
Sequence networks
Thévenin equivalent
FIGURE 7.49
Negative sequence impedance
Problem 7.3. If a single line-to-ground fault from phase “a” occurs at bus 2
of the system described in Problem 7.2, calculate the fault current in per unit
and in amperes, and the voltages at bus 2.
Solution 7.3. From the previous exercise we know the Th´evenin equivalent
for each sequence network viewed from bus 2. From Figure 7.16 we know that:
Ia0 = Ia1 = Ia2 =
1
(0.1516 + 0.1371 + 0.1164)j = −j2.468.
From Equation 7.1, the subransient currents are:


Ia
Ib
Ic

=


1
1
1
1
a2
a
1
a
a2




−j2.468
−j2.468
−j2.468

=


−j7.406
0
0

.

316
7 Distribution, failures, and protections
The current base at failure point is:
Ibase =
S
√
3 [V ] = 1000 [MV A]
√
3 × 18 [kV ] = 32075.01 [A],
Ia = j7.406 × 32075.01 [A] = 237.547 [kA].
The voltages in the sequence domain are:


V0
V1
V2

=


0
1
0

−


j0.1164
0
0
0
j0.1371
0
0
0
j0.1517




−j2.468
−j2.468
−j2.468

=


−0.2873
0.6616
−0.3744

.
Transforming to phase domain:


Va
Vb
Vc

=


1
1
1
1
a2
a
1
a
a2




−0.2873
0.6616
−0.3744

=


0
1∠−115.65◦
1∠115.65◦

pu.
Problem 7.4. Now consider a solid line-to-line fault at half the transmission
line length. Calculate the voltages of the fault at buses 1 and 2 and the current
of the fault in pu. Note: It is convenient to create a new bus halfway along the
transmission line.
Solution 7.4. From previous problems we know the sequence networks for
the power system. The ﬁrst step is to obtain the Th´evenin equivalent viewed
from half the transmission line:
Zth0 =

j0.1 + j0.375
2


j0.10125 + j0.375
2

= j0.1441,
Zth1 =

j0.2 + j0.125
2


j0.2020 + j0.10125 + j0.125
2

= j0.1528,
Zth2 =

j0.25 + j0.125
2


j0.2226 + j0.10125 + j0.125
2

= j0.1728.
From Figure 7.16, we know that
Ia0 = 0,
Ia1 = −Ia2 =
1
(0.1528 + 0.1728)j = −j3.0712.
The subransient currents in the phase domain are:


Ia
Ib
Ic

=


1
1
1
1
a2
a
1
a
a2




0
−j3.0712
j3.0712

=


0
−5.32
5.32

.

7.6 Homework problems
317
The current base at the failure point is:
Ibase =
S
√
3 [V ] = 1000 [MV A]
√
3
× 400 [kV ] = 1443.37 [A],
Ib = −5.32 × 1443.37 [A] = −7678.76 [A] = −Ic.
The voltages in the sequence domain are:


V0
V1
V2

=


0
1
0

−


j0.1441
0
0
0
j0.1528
0
0
0
j0.1728




0
−j3.0712
−j3.0712

=


0
0.5307
0.5307

.
Transforming to phase domain:


Va
Vb
Vc

=


1
1
1
1
a2
a
1
a
a2




0
0.5307
0.5307

=


1.06
0.53∠180◦
0.53∠180◦

pu.
7.6
Homework problems
Problem 7.5. Consider an unbalanced system whose phase currents are
known to be:
• IA = 3.42∠2◦[A]
• IB = 3.3∠121.23◦[A]
• IC = 3.6∠242◦[A]
Calculate the symmetrical components.
Solution 7.5. By directly applying the inverse Fortesquieu transform:


I0
I1
I2

= 1
3


1
1
1
1
a
a2
1
a2
a




IA
IB
IC

,
the result can be computed as:


I0
I1
I2

=


79 × 10−3∠−86◦
97 × 10−3∠−74◦
3.44∠1.75◦

.
Problem 7.6. The symmetrical current components were acquired for some
loads and are provided below. If those currents were acquired for 28 [Ω] loads
and the substation voltage is known to be a stiﬀ120 [Vrms] source, estimate
the distribution reactances responsible for such unbalancing.

318
7 Distribution, failures, and protections


I0
I1
I2

=


79 × 10−3∠−86◦
97 × 10−3∠−74◦
3.44∠1.75◦

.
Solution 7.6. This can be computed directly from the following equation:


VA
VB
VC

=


ZA
0
0
0 ZB
0
0
0 ZC

Ts


I0
I1
I2

=


ZA + 28
0
0
0
ZB + 28
0
0
0
ZC + 28




3.6∠242◦
3.3∠121.23◦
3.6∠242◦

.
It is necessary to solve as follows:


120∠0◦
120∠120◦
120∠240◦

=


ZA + 28
0
0
0
ZB + 28
0
0
0
ZC + 28




3.6∠242◦
3.3∠121.23◦
3.6∠242◦

.
The above system leads to:
ZA →7.07 −j1.22[Ω]
ZB →8.36 −j0.78[Ω]
ZC →5.31 −j1.16[Ω].
Problem 7.7. The load unbalancing of a building has led to an abnormal
voltage distribution among phases. Those voltages are measured to be:
• VA = 124∠0◦
• VB = 128∠123◦
• VC = 126∠241◦
If the neutral terminal is known to have a reactance of 0.03 + j0.12 [Ω],
calculate the power lost through it.
Solution 7.7.


V0
V1
V2

= 1
3


1
1
1
1
a
a2
1
a2
a




VA
VB
VC

.
So, V0 = −2.27 −j0.95 [V ], and the power is
P = V 2
0
X∗n
= 48.84∠−58.5◦[V A].
Problem 7.8. Consider a system to be furnished to trip a current protection
whenever the neutral line reaches a current of 5 [Arms]. Starting from a three-
phase balanced reactance of 10 + j3 [Ω], ﬁnd how ZB should decrease (both
parts proportionally) so the protection trips.

7.7 Simulation
319
Solution 7.8. It is necessary to calculate the current of the neutral line from
the symmetrical components analysis equations:


I0
I1
I2

= 1
3


1
1
1
1
a
a2
1
a2
a




IA
IB
IC

.
I0 = IA + IB + IC
3
=

VA
10+j3 [Ω]

+

VB
(10+j3 [Ω])p

+

VC
10+j3 [Ω]

3
=
0.93

1 −1
p

+ j3.95
1
p −1

.
RMS current can be obtained as the magnitude of the above calculated
current, so:
∥I0∥= 5 =
s
0.93
p −1
p
2
+

3.95
1 −p
p
2
,
25 = 16.46(1 −2p−1 + 1p−2).
The B phase load must be of p = 0.448 its original value to trigger the
protection.
Problem 7.9. Suppose that some symmetrical analysis triggers due to a fault.
After checking the system’s status, all symmetric components are the same.
What happened to the system before triggering?
Solution 7.9. The only possibility is a phase-to-earth fault, as:


I0
I1
I2

= 1
3T −1
S


IA
0
0

= 1
3


IA
IA
IA

.
7.7
Simulation
Electric networks, besides being quite complex, are also subject to failures.
There are some common types of faults, mostly related to transmission lines,
which involve the short-circuit of a combination of conductors. Once a short-
circuit appears, the system must disconnect the faulty section of the grid in
order to prevent further damage to loads and generators.
It is important to notice that current protections and power analyzers are
not fully capable of identifying the fault’s origin, and sometimes, a distance
protection is needed. After all, the full model of the grid must be taken into
account in order to eﬀectively detect the type of fault, its location, and the
correction that can be performed in order to keep the power ﬂowing to users
(see Figure 7.50).

320
7 Distribution, failures, and protections
FIGURE 7.50
Simulation of transmission faults

8
Renewable Energy
The provision of energy or related energy services involves a huge variety of
environmental impacts that are increasingly less tolerated by society. This is
why the energy problem in conjunction with the underlying environmental
problem continues to be a major topic in energy engineering, as well as in
the energy and environmental policies around the world. From the current
viewpoint, this attitude is not expected to change within the near future; the
worldwide controversy about the potential risks of the anthropogenic green-
house eﬀect is only one example. On the other side, in view of the increasing
knowledge and recognition of the eﬀects associated with energy utilization in
the broadest sense of the term, increasing complexity has to be expected.
According to Max Planck, energy is deﬁned as the ability of a system
to cause external action. Many forms of energy are distinguished: mechanical
energy, thermal, electric and chemical energy, nuclear energy, and solar energy.
In practical energy appliances the ability to perform work becomes visible by
force, heat, and light. The ability to perform work from chemical energy, as
well as nuclear and solar energy, is only given if these forms of energy are
transformed into mechanical and thermal energy.
The term energy carrier, thus a carrier of the above-deﬁned energy, is a
substance that could be used to produce useful energy, either directly or by
one or several conversion processes. According to the degree of conversion,
energy carriers are classiﬁed as primary or secondary energy carriers and as
ﬁnal energy carriers, explained below:
• Primary energy carriers are substances that have not yet undergone any
technical conversion, whereby the term primary energy refers to the energy
content of the primary energy carriers and the primary energy ﬂows. From
this energy, a secondary energy carrier can either be produced directly or
by one or several conversion steps.
• Secondary energy carriers are energy carriers that are produced from pri-
mary energy carriers, either directly or by several steps, whereby the sec-
ondary energy refers to the energy content of the secondary energy carrier
and the corresponding energy ﬂow. This processing of primary energy is
subject to conversion and distribution losses. Secondary energy carriers
and secondary energies are available to be converted into other secondary
or ﬁnal energy carriers or energies by the consumers.
• Final energy carriers and ﬁnal energy, respectively, are energy streams di-
321

322
8 Renewable Energy
Primary Energy
(hard coal, lignite, crude oil, 
natural gas, uranium, hydro-
power, solar radiation, forest 
wood)
- Conversion losses
- Distribution losses
- Self-consumption
- Non-energetic 
   consumption
Secondary Energy
(coke, briquettes, gas, 
biodiesel, heating oil, power, 
wood logs, district heating)
Useful Energy
(heat, power, light)
Final Energy
(briquettes, gas, heating oil, 
power, wood chips, natural 
gas, district heating)
- Conversion losses
- Distribution losses
- Self-consumption
- Non-energetic 
   consumption
- Conversion losses
- Distribution losses
- Self-consumption
- Non-energetic 
   consumption
Consumer
losses
FIGURE 8.1
Energy conversion chain
rectly consumed by the ﬁnal user. They result from secondary and possibly
from primary energy carriers, or energies, minus conversion and distribu-
tion losses, self-consumption of the conversion system, and non-energetic
consumption. They are available for the conversion into useful energy.
• Useful energy refers to the energy available to the consumer after the last
conversion step to satisfy the respective requirements or energy demands.
It is produced from the ﬁnal energy carrier, reduced by losses of this last
conversion.
The entire energy quantity available to humans is referred to as energy
basis. It is composed of the energy of the energy resources and the energy
sources. In Figure 8.1 the scheme of the energy carriers is presented.
8.1
Energy sources and resources
In terms of energy resources, generally fossil and recent resources are distin-
guished. Fossil energy resources are stocks of energy that have formed during
ancient geologic ages by biologic and geologic processes. They are further
subdivided into fossil biogenous energy resources and fossil mineral energy re-
sources. The former include, among others, hard coal, natural gas, and crude
oil deposits, whereas the latter comprise, for instance, the energy contents of
uranium deposits and resources to be used for nuclear fusion processes. Recent

8.2 Types of energy
323
resources are energy resources that are currently generated, for instance, by
biological processes.
Energy sources, by contrast, provide energy streams over a long period of
time; they are thus regarded as almost inexhaustible in terms of human time.
But these energy ﬂows are released by natural and technically uncontrollable
processes from exhaustible fossil energy resources. Even if such processes take
place within very long time periods, and are unlimited in human time, they
are nevertheless exhaustible. The available energies can be further subdivided
into fossil biogenous, fossil mineral, and renewable energy carriers.
8.2
Types of energy
There are many possible energy sources for the prime mover. The most com-
mon sources are water, coal, natural gas, oil, and nuclear energy. Water power
is perhaps the best source, since it is nonpolluting and there is no cost for the
fuel. Hydroelectric power is a renewable resource. Almost all desirable sites
for dams have already been developed, so there is not much scope for future
growth in water power.
Nuclear power is also an excellent source of nonpolluting energy. Nuclear
power plants are extremely expensive to build, and they require elaborate
safety systems and expensive training. Once built, though, the cost of the
nuclear fuel is low and nuclear power produces no hydrocarbon emissions to
pollute the atmosphere. Unfortunately, the future of nuclear power is clouded
by concerns over nuclear reactor safety. Few nuclear plants are being built,
and that situation will not change for the foreseeable future.
Coal is the most common source of energy for electrical power generation.
Coal is a relatively cheap fuel, but it is also one of the most polluting fuel
sources. Natural gas is a much better and cleaner energy source than coal.
It is relatively cheap and it burns cleanly with little pollution. The principal
disadvantage of natural gas is that it is relatively hard to transport over long
distances. Oil is a bit more polluting than natural gas, but it is easier to
transport; however, it is also much more expensive. Coal, oil, and gas all have
the additional disadvantage that they are nonrenewable energy sources.
Other sources of electric power include wind turbines and solar energy.
These are both renewable resources, but they are not yet economical compared
to other sources of electrical energy. Fuel cells and nuclear fusion are also
possibilities on the distant horizon.
Unfortunately, there is no perfect source of energy for electricity gener-
ation. All possible sources have their advantages and disadvantages, and all
will be used in varying degrees for the foreseeable future.

324
8 Renewable Energy
8.3
Types of renewable energy
Provision of ﬁnal or useful energy using renewable energies is based on energy
ﬂows originated by the movement and gravitation of planets, heat stored and
released by the earth, and in particular, energy radiated by the sun. There is
thus a great variety of renewable energies in terms of energy density, varia-
tions of the available forms of energy and the related secondary or ﬁnal energy
carriers, and ﬁnal energy to be provided. Each technical option for utilizing
the described renewable energy ﬂows must be adapted to the corresponding
characteristics of the available renewable energy. There is a broad range of cur-
rent and also future technical processes and methods to exploit the renewable
energy options most successfully.
The three sources of renewable energy give rise to a multitude of very
diﬀerent energy ﬂows and carriers due to various energy conversion processes
occurring in nature. In this respect, for instance, wind energy and hydropower,
as well as ocean current energy and solid or liquid biofuels, all represent, more
or less, conversions of solar energy.
The energy ﬂows available on earth that directly or indirectly result from
these renewable energy sources vary, for instance, in terms of energy density or
with regard to spatial and time variations. In general, the renewable energies
are:
• Solar radiation
• Wind energy
• Hydropower
• Bioenergy
• Photosynthetically ﬁxed energy
• Geothermal energy
• Gravitation and motion of planets, tides and waves
Solar energy is referred to as renewable or sustainable energy because it will
be available as long as the sun continues to shine. Estimates for the remaining
life of the main stage of the sun are another 4 to 5 billion years. The energy
from the sun, electromagnetic radiation, is referred to as insolation. Wind
energy is derived from the uneven heating of the surface of the earth due
to more heat input at the equator, with the accompanying transfer of water
and thermal energy by evaporation and precipitation. In this sense, rivers and
dams for hydro energy are stored solar energy. The third major aspect of solar
energy is the conversion of solar energy into biomass by photosynthesis.
Animal products such as oil from fat and biogas from manure are derived
from solar energy. Another renewable energy is geothermal energy due to

8.4 Advantages and disadvantages
325
heat from the earth from decay of radioactive particles, and residual heat
from gravitation during formation of the earth. Volcanoes are ﬁery examples
of geothermal energy reaching the surface from the interior, which is hotter
than the surface. Tidal energy is primarily due to the gravitational interaction
of the earth and the moon.
Overall, 14% of the world’s energy comes from bioenergy, primarily wood
and charcoal, but also crop residue and even animal dung for cooking and some
heating. This contributes to deforestation and the loss of topsoil in developing
countries. Production of ethanol from biomass is now a contributor to liquid
fuels for transportation. In contrast, fossil fuels are stored solar energy from
past geological ages. Even though the quantities of oil, natural gas, and coal
are so large they are inﬁnite and for the long term of hundreds of years, they
are not sustainable.
Due to the great variety of possibilities for using renewable energy sources
with the aim of fulﬁlling the demand for end or useful energy, it is very diﬃcult
to present the diﬀerent possibilities in a similar manner.
The possibilities and boundaries for converting renewable energies into
end or useful energy largely depend on the respective physical and technical
conditions. Whenever possible, also among others the theoretically maximum
achievable eﬃciencies and technical availabilities among others will also be
indicated. These technical key ﬁgures are deﬁned below:
• Eﬃciency, which is deﬁned as the ratio of useful power output to the power
input, depends on the respective operating conditions of the conversion
plant, as well as a series of other factors, which vary over time.
• Utilization ratio is deﬁned as the ratio of the total output of useful energy
to the total energy input within a certain period of time. The observed
time periods may include part load periods and breaks as well as start-up
and shutdown times. Utilization ratios are thus usually smaller compared
to the eﬃciency of conversion plants indicated to the design point at full
load.
• Technical availability describes that portion of the time period under ob-
servation, within which a plant has actually been available for its intended
purpose and thus considers time periods during which the plant has been
unavailable due to malfunctions.
8.4
Advantages and disadvantages
The advantages of renewable energy are that they are sustainable (nonde-
pletable), ubiquitous (found everywhere across the world), and essentially
nonpolluting. Note that wind turbines and photovoltaic panels do not need

326
8 Renewable Energy
water for the generation of electricity, in contrast to steam plants ﬁred by
fossil fuels and nuclear power.
The disadvantages of renewable energy are variability and low density,
which in general results in higher initial cost. For diﬀerent forms of renewable
energy, other disadvantages or perceived problems are visual pollution, odor
from biomass, avian and bat mortality with wind turbines, and brine from
geothermal energy. Wherever a large renewable facility is to be located, there
will be perceived and real problems for the local people. For conventional
power plans using fossil fuels, for nuclear energy, and even for renewable en-
ergy, there is the problem of “not in my backyard.”
8.5
Storage
Energy on demand means stored energy, and the most common means of
storage are water in dams, batteries, and biomass. Fossil fuels are stored solar
energy from past geological ages. Storage is a billion dollar idea. Economical
storage would mean no new electric power plants would have to be constructed
for many years, as energy could be stored from existing power plants during
periods of low demand.
Energy cannot be created or destroyed, only transformed from one form
to another, so in reality there are only two forms for storage: as kinetic energy
and potential energy.
Storage as kinetic energy could be as ﬂywheels, and thermal storage could
be as heat. For example, a passive solar home would use concrete or rock and
maybe water for 2–4 days of thermal storage, and a ground source heat pump
would use the earth as seasonal thermal storage. Compressed air is king of
a mixture; it is mechanical, but there is a thermal change. Super ﬂywheels
with high revolutions per minute and composite materials for strength have
been designed and are used in uninterrupted power supplies and prototypes
on buses.
Potential energy is due to generalized interactions, of which we consider
gravitational and electromagnetic for storage systems. The gravitational po-
tential energy is primarily water: dams, tidal basins, and pumped storage.
The electromagnetic interactions include chemical, phase change, magnetic,
electric, and mechanical interactions. Chemical storage is by batteries, pho-
tosynthesis, production of methane and hydrogen, fertilizer, and other types.
The storage of gas requires high pressure, converting it to liquid or as a chemi-
cal compound, or, for example, storing hydrogen in metal hydrides. Of course,
lots of solar energy is stored in chemical compounds as food and ﬁber.
Thermal storage could be thermal mass, ice, molten salt, cryogenic, earth,
solar pound, and phase change. Molten salt for thermal storage is being used
in combined heat and power systems. The main components for considera-

8.5 Storage
327
tion of diﬀerent storage systems are: energy density, eﬃciency and rate of
charge/discharge, duration or lifetime (number of cycles), and economics.
Diﬀerent storage technologies can be utilized for power or energy. Energy
density and then size and weight for some applications are important factors.
Liquid fuels have large energy density, while hydrogen gas has low energy den-
sity. In general, storage eﬃciencies range from 50% to 80%, and the lifetimes
vary widely, from 100 years for dams, to 5 to 10 years for lead acid batteries
in a photovoltaic system, to less than an hour for nonrechargeable batteries.
The maximum rate and best rate of charging and discharging the storage
is related to type and use of storage. Whether energy storage is included in an
application and the type of storage are driven by economics and speciﬁc power
and energy. An electric car that takes 6 hours to charge its batteries could
not be used on a cross-country trip, even if charging stations were available.
Thus, it can be seen how versatile liquid fuels are for transportation. Also,
the storage requirements for high power over a short time is diﬀerent from
energy storage for a few days. For utilities, the only large storage systems are
pumped storage and compressed air energy systems; however, battery systems
for power shaving, conditioning and reducing the variability from renewable
energy sources have been installed. Both pumped hydro and compressed sys-
tems have long life and a large number of cycles. For remote village power
systems and stand-alone systems, batteries are the most common means of
storage.
The electricity produced by a generator cannot be stored; energy minus
energy losses is the demand, so the generation supplies that amount of de-
mand, which varies by time of day and season. In addition, a utility system
must meet peak demands and have spinning reserve for unforeseen conditions.
If demand exceeds capacity, then users are taken oﬀthe grid. In some parts
of the world, there are rolling blackouts, or electricity is only available for
certain time periods. Finally, extreme events may force shutdown of the total
grid. A good source for information on storage for electricity is provided by
the Electricity Storage Association.
8.5.1
Pumped hydro
Pumped storage has two reservoirs, and the same motor/generator can be
used to pump water to the upper reservoir during periods of low demand and
then generate electricity during periods of high demand, just as any other
hydroelectric plant with a reservoir. The pumped hydro levels the load for
other generators on the grid. The need for a pump-priming head places the
motor/generator below the water level of the lower reservoir. Pumped stor-
age systems generally have a high head to reduce the size of the reservoirs.
Pumped storage can respond to full power within minutes, and if operated in
the spinning mode, which uses less than 1% of their rated power, they can
be changed to a pump or generator mode within 10s. Nuclear power plants
can only change load slowly, and other base load plants can be operated at

328
8 Renewable Energy
maximum eﬃciency through the use of pumped storage to absorb their out-
put at night during low demand. There are motor/generator, friction, and
evaporation losses, so the overall eﬃciency of a storage cycle is around 75%.
The advantages are: improved energy regulation and operation of the sup-
ply grid, ancillary services such as standby and reserve, black-station star,
frequency control, and ﬂexible reactive loading. The disadvantages are the
high capital cost due to fairly large reservoirs, and, as for other dams, the
land area needed, and the fact that collapse could happen.
8.5.2
Compressed air
Compressed air energy storage (CAES) is a peaking power plant that con-
sumes 40% less natural gas than a conventional gas turbine, which uses about
two-thirds of the input fuel compressed air. In a CAES plant, air is compressed
during oﬀ-peak periods and then is utilized during peak periods. The com-
pressed air can be stored in underground mines or salt caverns, which take
1.5 to 2 years to create by dissolving the salt. For an ideal gas, the amount of
energy for an isothermal process from a pressure diﬀerence is
E = (mR)(T)ln
PA
PR

= (P)(V )ln
PA
PR

[J],
(8.1)
where P is the absolute pressure, V is the volume, m is the amount of gas, R
is the ideal gas constant, and T is the absolute temperature in degrees kelvin.
The approximation is (100)(PA/PB)
 kJ
m3

for gas at around atmospheric pres-
sure.
8.5.3
Flywheels
Flywheels store energy due to rotational kinetic energy, which is proportional
to the mass and the square of the rotational speed,
E = (0.5)(I)(ω2) [J],
(8.2)
where I is the moment of inertia (kg m2), and ω is the angular velocity
(radians/s). For a mass M and radius R, the moment of inertia for a ring is
I = MR2, and for a homogeneous disk it is
I = (0.5)(M)(R2).
(8.3)
Increasing the revolutions per minute increases the energy density, so high-
speed ﬂywheels have revolutions per minute in tens of thousands. Low-speed
ﬂywheels are made from steel, and high-speed ﬂywheels are made from carbon
ﬁber or ﬁberglass. High-speed ﬂywheels are housed in a low vacuum and use
magnetic bearings to reduce or eliminate frictional losses. Advances in power
electronics, magnetic bearings, and materials have resulted in direct current

8.5 Storage
329
(DC) ﬂywheels. Note that if there is material failure, the container has to
retain that energy inside. Cycle eﬃciency is around 80%. Flywheels have been
used in trains, cars, and buses; however, they were primarily experimental or
prototypes. In the past, there were ﬂywheels on tractors to smooth out the
rotation of the crankshaft of two-cylinder engines. A hybrid vehicle could use
ﬂywheels for acceleration in conjunction with a smaller internal combustion
engine, much like hybrid vehicles with batteries. In a car, the ﬂywheel is a
gyroscope, which will change the handling.
8.5.4
Batteries
Batteries are common all over the world, as lead-acid batteries are used for ve-
hicles. Batteries are used for low-power and low-energy applications for lights,
radio, TV, and electronic devices. Photovoltaic (PV) with rechargeable bat-
teries has now replaced batteries for very low-power applications. Batteries
convert chemical energy into electrical energy using electrodes immersed in
a medium (liquids, gels, and even solids) that supports the transport of ions
or electrolyte reactions at the two electrodes. Individual cells are placed in
series for higher voltage and in parallel for higher current. Since there is an
internal resistance and because of other factors, there are losses in charging
and discharging a battery.
The power is the product of the voltage and current; however, batteries are
generally speciﬁed by volts and storage capacity (battery charge CB), which
is related to stored energy. CB is the amount of charge that a battery can
deliver to a load. It is not an exact number because it depends on the age
of the battery (number of cycles), temperature, state of charge, and rate of
discharge. If a lead-acid battery is discharged to essentially zero a few times,
it drastically reduced its lifetime. As a ﬁrst approximation, the energy is
E = (V )(CB) [J],
(8.4)
where V is the voltage and CB is the battery capacity [Ah]. Decreased tem-
perature results in less battery capacity, and for a lead-acid battery, storage
capacity decreases around 1% for every 1◦C drop in temperature. Explosions
due to short circuits and generation of hydrogen plus disposal of used batteries
and toxic chemicals are problems.
8.5.5
Rokkasho-Futamata Wind Farm
This energy storage farm has its location in Rokkasho, Aomori, Japan, and it
is the largest and ﬁrst combined wind generation plant, which produces about
51 [MW]. Also, its energy storage goes to about 34 [MW], so that the sum of
both quantities gives 85 [MW] of total energy storage. This facility is one of the
world’s largest sodium sulfur battery assemblies. This project was integrally
developed with energy storage capacity of 34 [MW], using NGK Insulators’

330
8 Renewable Energy
sodium-sulfur (NaS) batteries for load leveling, enabling the storage of low-
cost oﬀ-peak wind power for sale and/or distribution during peak demand
times. The sodium sulfur battery sets are charged primarily at night when
demand for power is lower. The stored electricity is then supplied to the utility
grid, along with power directly generated by the wind turbines, during peak
demand times. This system ensures a steady supply of power to the grid even
during those periods when wind generation falls as a result of low wind speeds.
To control the transmission of power from the Rokkasho-Futamata Wind
Farm to the national power grid, a smart grid monitoring and control sys-
tem from Yokogawa Electric Corporation systems was installed. The system
includes STARDOM network-based controllers and FA-M3 range-free con-
trollers. The Yokogawa system factors in ﬂuctuations in power production as
a result of varying wind conditions and develops a power generation operation
plan. With over 200 [MW] of NaS battery storage devices installed through-
out the world, the company has leveraged their expertise with ceramics and
electrical insulation systems to become a world leader in the development of
sodium sulfur batteries. NGK NaS battery technology is typically used to sta-
bilize intermittent renewable energy, provide emergency power, and as part of
stand-alone power systems for small islands and isolated grids. NaS batteries
have a high energy density, high eﬃciency of charge-discharge (89–92%), long
cycle life, and they are fabricated from inexpensive materials. However, be-
cause of the operating temperatures of 300 to 350◦C and the highly corrosive
nature of sodium polysulﬁdes, NaS battery technology is primarily suited for
large-scale, non-mobile applications such as grid energy storage.
8.6
Energy and society
Industrialized societies run on energy, a tautological statement in the sense
that it is obvious. Population, gross domestic product (GDP), consumption
and production of energy, and production of pollution for the world and the
United States are interrelated. The United States has less that 5% of the
population of the world; however, in the world, the United States generates
around 25% of the gross production and 22% of the carbon dioxide emissions,
and is at 22% for energy consumption. Notice that countries such as China,
India, Europe, the United States, Brazil, Russia, and Japan consume around
75% of the energy and produce 75% of the world’s GDP and carbon dioxide
emissions. The developed countries consume the most energy and produce
the most pollution, primarily due to the increase in the amount of energy per
person. On a person basis, the United States is the worst for energy consumed
and carbon dioxide emitted.
The energy consumption in the United States increased from 32 [quad] in
1950 to 101 [quad] in 2009. One [quad] is equal to 1015 British thermal units

8.6 Energy and society
331
[Btu]. There was an increase in eﬃciency in the industrial sector, primarily
due to the shock of the oil crisis of 1973. However, you must remember that
correlation between GDP and energy consumption does not mean cause and
eﬀect. The oil crisis of 1973 showed that eﬃciency is a major component in
gross national product and the use of energy.
A thought on energy and GDP: solar clothes drying (a clothesline) does
not add to the GDP, but every electric and gas dryer contributes; however,
they both do the same function. We may need to think in terms of results
and eﬃcient ways to accomplish a function or process and the actual life-
cycle cost. The underdeveloped part of the world, primarily the two largest
countries in terms of population (China 1.3 × 109 and India 1.1 × 109) are
beginning to emulate resources and greenhouse gas emissions. One dilemma
in the developing world is that a large number of villages and others in rural
areas do not have electricity.
Just as there is growth in the population, it is necessary to improve the
technology, not only because fossil fuels are running out but because actual
technology is a contaminant and therefore not eﬃcient. The Organisation for
Economic Co-operation and Development (OECD) will support the develop-
ment of electric cars, to contribute in the eﬃcient use of energy and promote
the use of renewable energy. It is believed that in 2030 half of the vehicles
will be electric, so that by 2050 there will no longer be internal combustion
engines.
8.6.1
Use of energy
It is a physical impossibility to have exponential growth of any product or
exponential consumption of any physical resource in a ﬁnite system. There
are numerous historical examples of growth: population, which increases 2–3%
per year; gasoline consumption, 3%; world production of oil, 5–7%; electrical
consumption, 7% per year. The U.N. projects over 9 billion people by 2050,
with the assumption that the growth rate will decrease from 1.18% in 2008 to
0.34% in 2050.
However, even with diﬀerent rates for growth, the ﬁnal result is still the
same. When consumption grows exponentially, enormous resources do not
last long. This is the fundamental ﬂaw in terms of ordinary economics and
stating growth in terms of percentages. The theme is that all we need is
economic development and the world’s problems will be solved. However, the
global economic crisis of 2008 and environmental problems have made some
economists have second thoughts on continued growth.

332
8 Renewable Energy
8.7
Economics
Business entities always couch their concerns in terms of economics, such as
claiming that we cannot have a clean environment because it is uneconomical.
The thought here is that renewable energy is not economical in comparison
to coal, oil, and natural gas. The diﬀerent types of economics to consider
are pecuniary, social, and physical. Pecuniary is what everybody thinks of as
economics, or money. On that note, we look at life-cycle costs rather than our
ordinary way of doing business, low initial costs. Life-cycle costs refer to all
costs over the lifetime of the system.
Social economics are those costs borne by everybody, and many businesses
want the general public to pay for their environmental costs. A good example
is the use of coal in China, where there are laws for clean air, but they are not
enforced. The cost will be paid in the future in terms of health problems. The
estimates of pollution costs for generation of electricity by coal range from
$0.005 to $0.1/[kWh].
Physical economics are the energy costs and the eﬃciency of the process.
There are fundamental limitations in nature due to physical laws. Energetics,
which is the energy input versus energy in the ﬁnal product for any source,
should be positive. For example, production of ethanol from irrigated corn
has close to zero energetics. So, physical economics is the ﬁnal arbitrator in
energy production and consumption. What each entity wants are subsidies for
itself and penalties for its competitors. Penalties come in the form of taxes
and environmental and other regulations, while incentives come in the form
of subsidies, breaks on taxes, lack of social costs to pay on the product, and
governmental funding of research and development. It is estimated that we use
energy sources in direct proportion to the incentives that source has received
in the past.
There are many examples of incentives and penalties for all types of energy
production and use.
8.8
Solutions
We do not have an energy crisis, since we know that energy cannot be created
or destroyed. We have an energy dilemma because of the ﬁnite amount of
readily available fossil fuels, which are our main energy source today. The
problem is the overpopulation and overconsumption. The world population is
so large that we are doing an uncontrolled experiment on the environment of
the earth. However, the developed countries were also major contributors to
this uncontrolled experiment in terms of consumption. The solution depends
on world, national, and local policies and what policies to implement, and

8.8 Solutions
333
even individual actions, like reducing consumption, having zero population
growth, shifting to renewable energy, and reducing greenhouse gas emissions,
environmental pollution, and military expenditures.
Continued exponential growth is a physical impossibility in a ﬁnite system,
and the earth is a ﬁnite system. Previous calculations made about the future
are just estimations, and possible solutions to our energy dilemma are as
follows:
• Conservation and more eﬃcient use of energy. Since the ﬁrst energy crisis,
this has been the most cost-eﬀective mode of operation. It is much cheaper
to save a barrel of oil than to discover new oil.
• Reducing demand, transitioning to zero population growth, and being a
steady-state society.
• Redeﬁne the size of the solar system and colonize the planets and space;
however, this will not alleviate the problem on earth. From our present
viewpoint, the resources of the solar system are inﬁnite, and our galaxy
contains over 100 trillion stars.
Because the earth is ﬁnite for population and our use of the earth’s re-
sources is also limited, a change to a sustainable society, which depends pri-
marily on renewable energy, becomes imperative on a long timescale. In order
of priority for the next 25 years:
1. Implement conservation and eﬃciency
2. Substantially increase the use of renewable energy
3. Reduce dependence on oil and natural gas
4. Use clean coal, which has to include all social costs
5. Make use of nuclear energy
6. Reduce environmental impact, especially greenhouse gases
7. Implement policies that emphasize items 1 and 2
State and local policies must be the same. Eﬃciency can be improved in
all the major sectors: residential, commercial, industrial, transportation, and
even the primary electrical utility industry. National, state, and even local
building codes would improve energy eﬃciency in buildings. Finally, there are
a number of things that you as an individual can do about conservation and
energy eﬃciency.
For a few ﬁnal comments, the possible future for human society involves
conservation eﬃciency, with an orderly transition to sustainable energy and
a steady state with no growth, catastrophe or with some revival. As over-
population and overconsumption are aﬀecting the earth, as an uncontrolled
experiment, the most probable future for the population is catastrophe or
catastrophe with some revival.

334
8 Renewable Energy
8.9
Theoretical problems
Problem 8.1. Calculate the kinetic energy of a car that has a mass of
1000 [kg] moving at 10 [m/s].
Solution 8.1. The kinetic energy of moving objects is calculated by:
KE = 0.5 mv2.
Thus, KE = 5000 [J].
Problem 8.2. A 12 [V ] battery is rated at 100 [Ah]. It could deliver 5 [Ah]
for 20 [h], E = 1×0 [Wh], or 1.2 [kWh]. However, at a faster discharge rate,
the values would be lower: 85 [Ah] for 10 [h], 70 [Ah] for 5 [h]. Explain this
behavior.
Solution 8.2. Decreased temperature results in less battery capacity, and for
a lead-acid battery, storage capacity decreases around 1% for every 1◦C drop
in temperature. Explosions due to short circuits, and generation of hydrogen
plus disposal of used batteries and toxic chemicals are problems.
Problem 8.3. High-speed ﬂywheels are made from composite material. A
ﬂywheel is a ring with 3 [m] radius, mass = 50 [kg], 20000 [rpm]. How much
energy is stored in the ﬂywheel?
Solution 8.3. We have the following equations:
I = 0.5(M)(R)2,
I = 0.5(50)(3)2 [Kgm2],
and
E = 0.5(I)(ω)2 [J],
200 [rpm] ≈2094.395 [rad/s],
E = 0.5(I)(2094.395)2 [J].
Problem 8.4. Compare kinetic energy storage to batteries in terms of energy
density and installed costs. Consider both systems to have the same amount
of energy capacity.
Solution 8.4. There is no precise solution to this problem.
Problem 8.5. Find any commercial chemical capacitor storage system; note
the source, company, and any other useful speciﬁcations. How much energy
can it store?
Solution 8.5. There is no precise solution to this problem.

8.10 Homework problems
335
8.10
Homework problems
Problem 8.6. There is no single entirely “clean” energy generation method.
Perform some brief research and ﬁnd the drawbacks of the following systems
regarding the environment and their byproducts during production/establish-
ment, usage/operation, and disposal/cessation of the operational phases
• PV solar
• Wind
• Hydro
• Batteries
Solution 8.6. There are some key concepts any report regarding environmen-
tal issues around renewable energy should include:
• PV solar
– Production and deposition imply the use and further treatment of
silicon
– Domestic usage of solar panels leads to serious issues of harmonic
contents and phase unbalancing
– Their eﬃciency is quite low, just like their lifespan. It is hard to weigh
how eﬀective they are as they are commonly used with batteries (and
power electronics)
– They are susceptible to cleansing issues regarding dust, salt (in the
sea), and objects (like leaves), which makes them require maintenance
• Wind
– The location of a wind farm needs to be entirely modiﬁed as aﬀecting
endogenous species and conditions
– Oﬀ-shore windmills disturb the local habitat and demand complex
transport and maintenance tasks that might be polluting
– The intermittent nature of the wind makes batteries necessary, as well
as power electronics
• Hydro
– Their location implies the entire modiﬁcation of the natural zone
– Huge amounts of artiﬁcially-placed water can result in geological is-
sues
• Batteries

336
8 Renewable Energy
– Their components are highly polluting
– Their deposition is normally incorrect
– They degrade quite easily; bad usage leads to early deposition
Problem 8.7. Suppose that a ﬂywheel is about to be used to store excess
energy from a power plant. Surpluses have been calculated to be about 456 [kW]
on average for 30 [min] intervals. Calculate the dimensions of a low-speed steel
ﬂywheel (180 [rpm]) that is 80% eﬃcient, and 3 [m] tall.
Solution 8.7. In order to take the total amount of surpluses, an average
amount of energy of
E = 456 [kW] ×

30 [min]60 [s]
[min]

= 821 [MJ]
is required to be captured. We can use ﬂywheel equations directly, by incorpo-
rating steel’s density as follows:
E = 0.5(I)(ω)2η = 0.5(0.5δπr4h)

180 [rpm]

[s]−1
60 [rpm]
 2π [rad/s]
[s]−1
2
η.
Steel density is δ = 8050
h
kg
m3
i
, so
821 × 106 [J] = 0.5(37.93 × 103r4)(355.3)(0.8) = 5.39 × 106r4.
The radius can be solved:
r =
4
r
821 × 106
5.39 × 106 = 3.51 [m].
Problem 8.8. Capacitors are also known as energy storing elements. Cal-
culate the capacitance of a capacitor array that can hold 1 [MJ] @ 100 [V ].
Consider capacitor’s stored energy to be represented by
E = 1
2CV 2.
Solution 8.8. The capacitance value can be directly taken from the above
equation:
1 [MJ] = 1
2C(100)2 = 200 [F].
Problem 8.9. Considering Problem 8.7 and taking its parameters, how fast
should a ﬁberglass ﬂywheel rotate to deliver the same amount of energy, having
3.5 [m] radius? Consider its density to be 0.055
 lb
in3

.
Solution 8.9. Fiberglass density is of about
δ = 0.055
 lb
in3

[in3]
(25.4 × 10−3[m])3
0.4535 [kg]
[lb]
= 1522.1
 kg
m3

.

8.11 Summary
337
The energy equations are as follows:
E = 456 [kW] × (30 [min]60 [s]
[min]) = 821 [MJ],
E = 0.5(I)(ω)2η = 0.5(0.5(1522.1)π(3.5)43)ω2(0.8),
E = 430.5 × 103 ω2.
So,
ω =
r
821 × 106
430 × 103 = 43.69
rad
s

,
ω = 417 [rpm].
Problem 8.10. Perform some brief research regarding the latest lithium-based
batteries. List their characteristics regarding energy density, power density,
charge/discharge regimes, and lifespan.
Solution 8.10. There is no precise solution to this problem.
8.11
Summary
The integration of diﬀerent energy sources can be seen as complementary and
should commonly obey a local energy plan, as shown in Figures 8.2 and 8.3.
This means that not all the types of energy are suitable to being applied in
a particular place due to their natural restrictions and storage requirements.
Transmission lines and phase unbalancing also need to be considered so that
the whole integration fulﬁlls energy usage objectives.
Some types of generators can be seen as complementary in very speciﬁc
senses. For example, an induction generator with a squirrel cage rotor will
consume reactive power that can be provided by a synchronous machine. A
capacitive bank can also be used to compensate the requested reactive power
but will add complexity to the transients of the generating device. Broadly,
the eﬀects of unbalanced loads, faulty systems, and potential complementary
generators must be measured and controlled. In the same spirit, a smart grid
is required to manage complex networks, as it provides a means to deal with
full-scale integration of electric devices.

338
8 Renewable Energy
FIGURE 8.2
Integration of various sources 1/2

8.11 Summary
339
FIGURE 8.3
Integration of various sources 2/2


9
Smart Grid
The smart grid appeared as the response to human energy needs, and uses a
communication system, that allows improvement of electric energy conditions.
A new professional curriculum is a vital element for the future electrical
power industry. Diﬀerent engineering topics need to be created to face the
smart grid’s technological obstacles. The development of educational programs
requires skills and technologies outside of power engineering.
The electric system curriculum requires theory and experimental work in
numerous areas, with a major focus on the following basic topics:
• Electric machines
• Power electronics
• Control systems
• Telecommunications
• Cybersecurity
• Automation
• Instrumentation
• Digital systems
• Economics
• Prediction
• Signal processing
Diﬀerent authors have deﬁned the smart grid system as [9]: Green Energy
Act (Canada): “A nickname for an ever widening palette of utility applications
that enhance and automate the monitoring and control of electrical distribu-
tion.” “An automated, widely distributed energy delivery network character-
ized by a two-way ﬂow of electricity and information, capable of monitoring
and responding to changes in everything from power plants to customer pref-
erences to individual appliances.” “A smart grid is the electricity delivery
system (from point of generation to point of consumption) integrated with
communications and information technology.” In fact, the smart grid concept
341

342
9 Smart Grid
Who?
Who?
What?
Electric utilities
Prosumers/consumers
at?
Smart
Grid
Utilities
How?
Receiver
Why?
What?
Sender
Why?
When?
Renewable energy 
Renewable energy 
Conventional electricity
generation
FIGURE 9.1
Supply chain for describing a smart grid
brings an active consumer participation in which the consumer is informed and
the demand response and distribution energy are also reduced. The topology
of conventional central generation has many problems when energy renewal
resources are included in the interconnection system, so the smart grid dis-
tributes energy sources with plug and play conveniences’ focus on renewable
energy; thus, new services and products are in the market. In the case of nat-
ural disasters, severe damage is limited to relatively small areas, which gives
the possibility of swift response.
For facing the areas that the new concept of smart grid has to solve, key
factors have to be characterized in diﬀerent models to get a complete idea;
some of them are designed as per a well-known theory, such as the supply
chain model proposed by [69]. When the electric grid is shown as a closed-
loop supply chain model, presented in Figure 9.1, it is possible to recognize
the main actors of the electric system answering the questions who, when,
why, how, and what [66]. In this new topology, new areas will play a crucial
role in the smart grid topology and it is clear that cybersecurity is in the top
of the energy control system layers for supervising the grid.
A conventional electric grid is not able to handle all the electrical energy
necessities of today; hence, some energy alternatives appeared to ﬁnd new
solutions. The traditional electric grid covers the central generation system,
transmission, distribution, and end user. One of the main problems is stor-
ing energy from renewable sources of energy, like wind or solar energy, and
the production of energy using renewable energy being prioritized in the dis-
tribution system. There are diﬀerent technological conditions that have to be
accomplished to construct a smart grid system. Figure 9.2 illustrates the main
technological groups that form the smart grid concept.
When a smart grid is developed, it is expected that the smart grid can
fulﬁll the following general attributes under operation:
• Evaluate grid health in real time
• Predict normal performance

9.1 Beneﬁts of the smart grid
343
Computer
intelligence
Power system
enhancement
Communication
and standards
Testbed
Environment
and economics
Smart Grid
FIGURE 9.2
Key groups of the smart grid technology
• Anticipate energy emergencies and demands
• Adapt to new energy requirements
• Distribute resources and renewable energy
• Handle stochastic events
• Provide auto-correction and reconﬁguration
9.1
Beneﬁts of the smart grid
The U.S. Department of Energy provides a list of beneﬁts regarding the smart
grid:
• Economic factors
– Optimized generator operation
– Deferred generation capacity investments
– Reduced ancillary service cost
– Reduced congestion cost
– Deferred transmission (T) capacity investments
– Deferred distribution (D) capacity investments

344
9 Smart Grid
– Reduced equipment failures
– Reduced T&D equipment maintenance cost
– Reduced T&D operations cost
– Reduced meter reading cost
– Reduced electricity cost and losses
– Reduced electricity theft
• Reliability factors
– Reduced sustained outages
– Reduced major outages
– Reduced restoration cost
– Reduced momentary outages
– Reduced sags and swells
• Environmental
– Reduced CO2 emissions
– Reduced SOX, NOX, and PM-2.5 emissions
• Security
– Reduced oil usage
– Reduced wide-scale blackouts
Since the smart grid has shown its energy potential, it is important to
make a prediction about the cost of upgrading the traditional electric grid
presented in Figure 9.3 to a smart grid. As an example, the Electric Power
Research Institute forecast that the cost to upgrade the U.S. electric grid to a
smart grid could be between $338 billion and $476 billion, and could generate
beneﬁts of between $1,294 billion and $2,028 billion; as result, the upgrade
of the electric grid is possible and beneﬁcial for the utility system and end
user. Some of the key drawbacks when a traditional grid is used are: centralized
architecture and control, passive transmission and distribution, very extensive
network (long paths and many components), lack of diversity.
As it could be observed, the communication systems inside a smart grid are
very important and have to be restructured in order to get the communication
system working properly. Figure 9.4 shows how the smart grid communication
has to be adjusted.
The micro-grids are local and independent electrical grids that could in-
tegrate energy resources, transmission, distribution, and end-user. A local is-
land that can operate as a stand-alone or grid-connected system is deﬁned as
a micro-grid. Normally, gas turbines or renewable resources power it and an

9.1 Beneﬁts of the smart grid
345
Power plant
Tower
Very high-voltage
Transmission line
smissio
smissio
smissio
smissio
smissio
Tower
Tower
y 
n
y
n
y
n
y
n
To
Tower
ry
ry
n
ry
nnnnn
a
To
Tower
r
a
r
a
r
a
r
Ver
a
e
a
e
a
Ve
Ve
r
e
r
Ve
Ve
Ve
Ve
Ve
Ve
TrTrTrTrTr
V
Circuit 
breaker
Transformer
Distribution 
Transformer
Medium-voltage
Distribution line
Medium-voltage
Distribution line
Low voltage
FIGURE 9.3
Conventional electric grid
FIGURE 9.4
Communication in a smart grid system

346
9 Smart Grid
Source side energy 
storage
Electric grid
Power electronics 
interface
Power electronics 
interface
Photovoltaic 
modules
Wind generators
Fuel cells
Fuel supply
Microturbines
Fuel supply
Controller
Microgrid power 
distribution
Energy storage
Power electronics 
interface
Loads
FIGURE 9.5
Basic topology of a micro-grid
inverter is included in order to connect it to the main grid. In addition, har-
monics are ﬁlters that are used to improve the power quality. The micro-grid
has advanced control systems and the smart grid includes complex decision
support systems. Figure 9.5 shows a micro-grid. A conventional grid-tied sys-
tem is not a micro-grid; one of the main limitations in a conventional grid-tie
is the photovoltaic systems in which the operation at home is based on IEEE
standard 1547, in which the inverter cannot power the home when the grid is
disconnected.
The end-user is regulated at home by diﬀerent IEEE standards. Figure 9.6
illustrates the IEEE standards that have to be taken into account.
In the United States, the transmission and distribution systems still use
older digital communication and control technology. Advanced communica-
tion systems for distribution automation, such as remote terminal unit (RTU)
and SCADA (supervisory control and data acquisition) systems, are under
development, as are innovative tools and software that will communicate with
appliances at home. The SCADA system is deﬁned as a system that works
with coded signals over communication channels, so it could provide remote
equipment control. SCADA systems for electrical energy are digitally con-
trolled and they can monitor and control the complete energy cycle.
Clearly, the smart grid system needs a revision of standards and protocols
for the secure transmission of critical and sensitive information within the
proposed communication topology.
In the case of a smart grid, the costs of communication systems are signif-
icant and sometimes an impediment, so an evaluation between the total cost
and the overall performance is needed. In the communication system, main-
taining the security between the control center and ﬁeld devices is one of the
most important problems that have to be faced.
Smart meters are a new kind of electrical meter (Figure 9.7) that measure

9.1 Beneﬁts of the smart grid
347
Smart Grid into
Home Devices
Standards
Home Networking
Standards
Electric Vehicle
Standards
Smart Metering
Standards
Home Networking
Standards
Smart Grid into
Home Devices
Standards
Distributed energy
interconnection, Solar, Wind,
storage, etc.
(Vehicular communications)
FIGURE 9.6
IEEE standards at home
energy usage in real-time, just as the old ones did. But, they also send infor-
mation back to the utility by wireless signals. Instead of using a utility meter
reader who goes to the property and manually does the periodical electric
service reading, the information is send automatically to the utility. To im-
prove the overall performance of the smart meters, a new group of appliances
has been developed. Smart appliances like the toaster, the microwave, and
even the refrigerator are based on micro-chips that allow your appliances to
communicate with the smart meters to control the energy usage.
Smart meters are part of a global plan to upgrade the world electrical grid
to a smart grid, which reduces energy consumption. The smart grid is being
implemented in both Canada and Mexico in order to communicate with the
United States. Designers are working on new standards that will integrate all
of North America into a single, uniﬁed smart grid system. There is an initiative
to generate a global smart grid to cover a continent, as presented in Figure 9.8.
The Global Energy Network Institute (GENI) shows this Dymaxion (tm) Map
of the world from the perspective of the North Pole, to reveal the global grid
currently under construction. The lines are high-voltage electrical transmission
lines that are capable of transferring large amounts of energy from continent
to continent.

348
9 Smart Grid
70°F
Displays, interfaces and controller devices
Enabled PC 
Smart TV
Wireless 
remote
Wireless display
Mobile 
devices
Home theater controller
Wireless 
switch
Wireless 
water sensor
Wireless 
contact sensor
Wireless 
dimmer
Wireless 
thermostat
Meter/HAN
Transactions over utility 
infrastructure
TDSP
WEB 
page
Internet
Meter/HAN
Services
FIGURE 9.7
Smart meter and smart home

9.1 Beneﬁts of the smart grid
349
FIGURE 9.8
Global smart grid

350
9 Smart Grid
9.2
Cyber-security
The presence of information and communication technologies (ICT), e.g., com-
puters, networks, programs, and data, gives ﬂexibility and eﬃciency to the
smart grid operation. However, the vulnerability of ICT to threats must be
considered [71].
Smart-grid cyber security focuses on protecting ICT from unintended or
unauthorized access, changes, or destruction. By default, all the components
in the smart grid have protection against intruders, but hackers are always
looking for the weakest and most vulnerable link that designers overlooked.
For example, in 2015 a couple of hackers attacked during a self-drive car test,
and were able to remotely modify the a/c and radio stereo of the car. In
fact, they could modify the acceleration, brakes, or steering, but these hackers
didn’t. The same attacks could be done on the smart grid elements, resulting
in a big risk for both power distribution and people.
Cyberattacks can be classiﬁed as [25]:
Malware: Malicious software designed by hackers to run in a speciﬁc system.
Viruses, worms, Trojan horses, ransomware, spyware, rootkit, etc. are ex-
amples of malware. Stuxnet is an example of malware aﬀecting SCADA
and PLC systems.
Denial-of-Service or Distributed Denial-of-Service: Makes a networked
system busy and unavailable to its users by overloading the system with
a huge amount of requests.
Zero-Day: This is an unpatched computer system vulnerability that is not
yet disclosed to the public. The name refers to the vendor of the aﬀected
computer systems having zero days to ﬁx it after the vulnerability has
been disclosed.
Advance Persistent Threats: This is a generalized term for a group of
professional hackers targeting a system continuously over a long period of
time.
Cyberattacks are presented all the time, so a secure smart grid should have
enough protection to limit adversary access. Furthermore, if the cyber-security
is broken, the smart grid should contain elements that minimize or eliminate
the eﬀect of the attacks.
Cybersecurity is one of the 20 metrics for measuring progress toward im-
plementation of smart-grid technologies, practices, and services, proposed by
the U.S Department of Energy in [8]. Six major characteristics of a smart grid
are proposed in [8]:
1. Enables informed participation by customers
2. Accommodates all generation and store options

9.3 Exercises
351
3. Enables new products, services, and markets
4. Provides the power quality for the range of needs
5. Optimizes asset utilization and operating eﬃciency
6. Operates resiliently during disturbances, attacks, and natural disasters
Cybersecurity is deﬁned as an emphasized metric of the smart grid operat-
ing resiliently during disturbances, attacks, and natural disasters. Resiliency
refers to the ability of a system to react to events such that problematic con-
sequences are isolated with minimal impact to the remaining system, and
the overall system is restored to normal operation as soon as practical. This
robustness reduces interruption of services, providing a direct beneﬁt to con-
sumers and service providers. Protection against all hazards, whether acciden-
tal or malicious, and the ability to span natural disasters, deliberate attacks,
equipment failures, and human error, are included in resiliency. Operational
resiliency has three essential properties: a) ability to change (adapt, expand,
conform, contort) when a force is enacted; b) ability to perform adequately or
minimally while the force is in eﬀect; and c) ability to return to a predeﬁned,
expected normal state whenever the force relents or is rendered ineﬀective.
The study and research of vulnerabilities is necessary to quantify cyber-
security issues. Laboratories and test-bed environments are needed, consider-
ing the actual ﬁeld conditions. Then, plenty of cyber-attacks should be char-
acterized in order to understand or estimate the possible response of the smart
grid when a cyber-attack is presented.
9.3
Exercises
9.3.1
Contribution of solar energy
Assume that there is demand for energy from a distant point and there is solar
energy to be exploited. In this exercise, the student will intervene by reducing
the consumption of energy from an older generation plant, using the surplus
energy produced by solar photovoltaic systems.
The reduction of even a minimum of absorbed energy will certainly have
an impact on environmental pollution produced by a plant of the older gen-
eration.
Set the resistive load to the second value and close the R2 relay to supply
energy coming from the coal plan (see Figure 9.9).
Close R4 relay to transfer energy coming from the plant to the load and
observe the power consumption in the maximum demand meter.
In this situation you can see active power required from the resistive load

352
9 Smart Grid
FIGURE 9.9
Solar energy global panel
FIGURE 9.10
Transformer panel
Resistive load
Active power [W]
Reactive power [VAr]
2
207.64
52.32
3
310
101
and a minimum of reactive power required from the primary of the step-down
transformer (see Figure 9.10).
Insert the hydroelectrical energy to the network using the hydroelectrical
plant simulator.

9.3 Exercises
353
Observe the brushless motor starting, and after that, enter in the procedure
for the automatic synchronization connection (see Figure 9.11).
FIGURE 9.11
Automatic synchronization connection
Increment the speed to 1800 [rpm] and then increment the excitation ﬁeld
until the delta output of the generator goes up to 230 [V ].
Look at the AC display phase-to-phase voltage in the electrical power
digital measuring unit. Check, at the same time, either the secondary voltage
or frequency on the software; the level has to be equal to that of the network
400 [V ].
Look to the display of the generator synchronizing relay and reduce the
speed angle shift and the angle at under 20 degrees (see Figure 9.12).
When the hydroelectrical part is connected to the grid, you have to pay
attention to stabilizing the system, incrementing the active power consump-
tion from the load, and stabilize the system regulating the speed and exci-
tation. Check the LED near the turbine; it has to be green and stable (see
Figure 9.13).
Observe the reducing of power coming from the coal plant when you in-
troduce active power to the network.

354
9 Smart Grid
FIGURE 9.12
Display panel
The hydroelectrical contribution, in this case, also permits you to reduce
energy supplied from old plant generators. Observe the meter near the coal
plant simulator.
Grid Side
Synchronous Gen.
Load
Resistive
Load
Active
Power
[W]
Reactive
Power
[VAr]
Active
Power
[W]
Reactive
Power
[VAr]
Active
Power
[W]
Reactive
Power
[VAr]
2
111
-540
145.4
593
-235
-68
4
281
-350
160
550
-400
-180
ω=1818 [rpm], I= 1.76 [A]
9.3.2
Contribution of wind plant
Assume that there is demand for energy from a distant point and there is a
wind power plant near that point.

9.3 Exercises
355
FIGURE 9.13
Stabilizing the system
A wind power plant is going to be connected to a network oriented to
reducing coal plant power consumption.
Set the resistive load to the second value and close the R2 relay to supply
energy coming from the coal plant. Close the R4 relay to transfer energy
coming from the coal plant to load and observe the power consumption in the
maximum demand meter (see Figure 9.14).
In this situation you can see the active power required from the resistive
load and a bit of reactive power required from the primary of the step-down
transformer. Insert the energy to the network using the wind-system plant
simulator.
Check to see if the brushless motor is starting (see Figure 9.15).
Increment the speed to 1800 [rpm] and press the button “Procedure” (see
Figure 9.16).
Close the relay R3 only when the speed is 1800 [rpm]. Increment the speed
of the brushless wind generator to increment the active power contribution
(see Figure 9.17).
Observe the reducing of power coming from the coal plant when you in-
troduce active power to the network.
The wind power plant’s electrical contribution also, in this case, permit

356
9 Smart Grid
FIGURE 9.14
Transfer power panel
FIGURE 9.15
Starting the motor
the reduction of energy coming from old plant generators. Observe the meter
near the coal plat simulator.

9.4 Homework problems
357
FIGURE 9.16
Speed increment
FIGURE 9.17
Wind generator increment
9.4
Homework problems
Problem 9.1. Navigate to the carbon footprint calculator from myclimate.org
and perform a calculation of your personal footprint. ht tp s: // co 2. my cl im
at e. or g/ en /f oo tp ri nt _c al cu la to rs /n ew ?g cl id =C jw KE Aj wu tX IB
RD V7-S Dv di Ns Uo SJ AC Il Tq li h61Z 9b JP 4c rT Bt qQ 1o PF Lf W6p AU t2m az
sl pj U3s Vx oC -A Tw _w cB

358
9 Smart Grid
Grid Side
Induction Gen.
Load
Resistive
Load
Active
Power
[W]
Reactive
Power
[VAR]
Active
Power
[W]
Reactive
Power
[VAR]
Active
Power
[W]
Reactive
Power
[VAR]
2
187
1526
48
-1455
205
-52
4
384
1653
35
-1467
-389
-179
Wind speed = 3000
Solution 9.1. There is no speciﬁc solution to this problem. The teacher would
ask the student to write about resources usage.
Problem 9.2. Visit the Smartrid.gov site and ﬁnd at least 5 reported smart-
grid or micro-grid projects throughout the available documents. Report them,
taking into account the funding required and the expected outcomes.
Solution 9.2. There is no speciﬁc solution to this problem. However, students
can be asked to be as speciﬁc as desired. Projects at the proposed site are
thoroughly explained and presented, so their technical issues, economic factors,
and follow-up inquiries are also available.
Problem 9.3. The smart grid is mostly supported by one key concept: ad-
vanced metering infrastructure (AMI). Perform some brief research about such
systems and conclude about their pertinence toward actual smart-grid integra-
tion.
Solution 9.3. AMI is a framework on which the smart grid is to be supported.
It is composed of electronic devices that perform precise and real-time mea-
surements so the electric grid can be monitored and key decisions can become
possible during operation. In addition, the digital systems required to make
their information available at a supervisory level are also part of an AMI.
AMI goes beyond smart meters. Brieﬂy, the whole infrastructure is mostly
oriented to data analysis and its translation into information.
Problem 9.4. Another big concept behind smart-grid integration is the energy
management system (EMS). Perform some brief research about such systems
and conclude about their pertinence toward actual smart-grid development.
Solution 9.4. EMS is not a new concept and is commonly related to SCADA
systems. As the smart grid can easily move beyond a simple human-machine
interface conceptually, the EMS is a concept that makes smart-grid deﬁnition
easier, as it states the foundations where the smart-grid is to be implemented.
Problem 9.5. The smart grid approach to energy management has not been
thoroughly developed. There are many issues precluding its ﬁnal realization.
Perform some brief research and determine the top ﬁve issues that hinder
smart grid realization. Provide an explanation for each concept.

9.5 Simulation
359
Solution 9.5. There are many obstacles regarding smart-grid integration to
the current grid. Some of them are listed here so they can be used as a refer-
ence:
• Even though there are some related projects, how the technology is to be
integrated is not clear yet
• Most parts of the world are grid-unautomated, e.g., North America is below
40% automated
• Corporations are already developing grid products even if the smart-grid
has not been technically deﬁned
• Smart-grid projects are substantially more expensive than common electric
projects
• The electric grid is not available for testing, so R&D eﬀorts have been
obscured
9.5
Simulation
It is important to consider that most assumptions made regarding system
interconnections depend on the inﬁnite bus stiﬀness, which is considered to
be inﬁnite indeed. This implies that it can give/take any amount of active
or reactive power while holding the voltage characteristics of the network.
Although this is known to be unrealistic, it will be accurate as long as the bus
surpasses other sources in terms of installed capacity.
In addition, the incorporation of new sources should normally follow from
local needs and must be calculated so their power capacity is as required. If
a generator is not fully used, its eﬃciency will drop. On the other hand, the
incorporation of many generators will decimate the eﬃciency of the inﬁnite
bus as its generators will require less energy (see Figure 9.18).
Energy projects must then be preceded by exhaustive analysis before their
application. Undoubtedly, the incorporation of new “domestic power” sources
to the grid should be regulated and measured, so the already installed systems
and the new ones ﬁt a known consumption proﬁle.

360
9 Smart Grid
FIGURE 9.18
Power contribution of diﬀerent power sources

10
Power Electronics in Power Systems Using
LabView, LabView-FPGA, and Multisim
10.1
Introduction
“Today, approximately 30 percent of all power generation utilizes power elec-
tronics between the point of generation and consumption. By 2030, it is ex-
pected that up to 80 percent of all generated electricity will utilize power elec-
tronics” [59]. Moreover, the power electronic stages have reduced their losses
(see Figure 10.1), so they are very attractive for controlling power systems.
Hence, it is very important to design power electronic stages using software
tools such as LabVIEW.
Not only are National Instruments customers completing more projects
on time (http://forums.ni.com/t5/Power-Electronics-Development/g
p-p/grp-1891), but they’re doing it in less time with fewer resources than
those who are following the traditional design approaches. This is made possi-
ble by using a platform-based approach that can fusion the best of build and
the best of buy, as well as leveraging high-level software with ﬂexible oﬀ-the-
shelf hardware. These are integrated together, so that you get the opportunity
to focus on innovation, not your implementation. Graphical system design and
the LabVIEW reconﬁgurable inputs and outputs (RIO) architecture provide
quality products and the conﬁdence to innovate, while getting your project
done in less time. The RIO relationship between price-performance and num-
ber of systems deployed is presented in Figure 10.2.
The two main goals of the power electronics design using simulation tools
are the following. A traditional power electronics design is done using a V
process that is shown in Figure 10.3. This process starts with co-simulation
that allows us to move to prototype in a fast manner because the design V
process is highly improved, such that co-simulation provides real results that
are much closer to the experimental design (see Figure 10.4).
Embedded systems are used in the V process for designing power electron-
ics systems. Thus, the availability of heterogeneous ﬁeld programmable gate
array (FPGA) hardware contains an array of integrated digital signal proces-
sor (DSP) cores capable of eﬃciently executing ﬂoating-point math operations,
so that the co-simulation and the deployment process can be improved. On
the other hand, these modern FPGAs are actually hybrid devices containing
361

362
10 LabVIEW-FPGA-Multisim co-Simulation
FIGURE 10.1
Generations of power electronics and power losses

10.1 Introduction
363
FIGURE 10.2
NI-RIO deployment curve

364
10 LabVIEW-FPGA-Multisim co-Simulation
FIGURE 10.3
Design V process

10.2 Co-simulation LabVIEW and Multisim
365
FIGURE 10.4
Co-simulation, interface board, and commercial deployment
hard-core DSP processing elements, integrated within the reconﬁgurable com-
puting fabric, and capable of achieving MHz speeds for simulation and control,
so the design process requires less time. This FPGAs can be combined with
technology to analyze electric circuit, power electronics, and power system
models in order to get results that allow us to deploy controllers in power
electronic stages (see Figure 10.5).
10.2
Co-simulation LabVIEW and Multisim
As power electronics is one of the most important topics in power systems
(http://www.ni.com/power/electronics/), it is enormously important to
understand and to design it [3]. Besides, there are several simulations tools
that can improve the design of power electronics in power systems. As a re-
sult, LabVIEW (http://www.ni.com/manuals/) has several tools that allow
us to create simulations, co-simulations, and hardware in the loop systems.
In addition, the conventional power electronics performance can be improved
when a software design is done. Power electronics has become an essential part
of power systems (see Figure 10.6). The basic elements in power electronics
are the semiconductors that are electronic switches (IGBTs, GTO, MOSFET,

366
10 LabVIEW-FPGA-Multisim co-Simulation
FIGURE 10.5
Automatic Multisim to LabVIEW FPGA conversion enables this power sys-
tem model to be simulated at 2 MHz speeds using heterogeneous FPGA hard-
ware

10.2 Co-simulation LabVIEW and Multisim
367
FIGURE 10.6
Power system with power electronics elements
etc.). Those components can either conduct or block the electric current in
the power system when a control signal is provided. They are very eﬀective
for controlling power systems since the time to change their conductivity con-
dition is in the range of microseconds. Thus, a power electric system can be
controlled using power electronic stages. When the power electronic stages
are designed for power systems, it is important to use simulation tools that
help to design the power electronic stage in a precise manner and to save time
and economic resources. As a result, the faster way to move from simulations
to commercial deployments, and product generation, is the co-simulation in
which the subsystems are linked as a coupled problem that is simulated in a
distributed manner. One of the most important industrial and academic tools
is the co-simulation that is a closer representation of the real system in which
the power electronic stage can be analyzed in a comprehensive manner (see
Figure 10.6). This chapter deals with the LabVIEW FPGA and Multisim co-
simulation tools to understand the power electronics design and fundamentals
for power systems. In this chapter, you will gain a basic understanding of
how the LabVIEW graphical system design tool chain can be used to allow
for power electronics control. Figure 10.7 illustrates a block diagram about
designing power electronics using LabVIEW FPGA and Multisim as the ﬁrst
step in the power electronic design [54]. This diagram can be determined by
the design V process (see Figure 10.3).
One of the most important advantages of using Multisim (Multisim Man-
ual) and LabVIEW in co-simulation is designing and analyzing a complete
power electronic system, including applications such as wind turbines. Thus,
co-simulation helps to eﬀectively design across both the analog and digital
domains. Traditional platforms are unable to accurately simulate both analog
and digital together, so design errors cascade to the physical prototype and
lead to an ineﬀective and lengthy design approach. With the new co-simulation

368
10 LabVIEW-FPGA-Multisim co-Simulation
FIGURE 10.7
Design block diagram for power electronics based on LabVIEW FPGA, Mul-
tisim, and LabVIEW

10.2 Co-simulation LabVIEW and Multisim
369
Defining the
electric circuit in
Multisim
Include the
LabVIEW co-
simulation
terminals
Create the
LabVIEW
program
Include the
LabVIEW external
model for
connecting
LabVIEW
Run the
co-simulation
FIGURE 10.8
Basic block diagram for running a co-simulation
capabilities between Multisim and LabVIEW, a power electronic circuit with
accurate, closed-loop point-by-point simulation and an entire analog and dig-
ital system can be designed. Hence, LabVIEW and Multisim take advantage
of two distinct simulation engines [54]: Multisim simulation for the accuracy
of analog and mixed-signal circuitry, and LabVIEW for the eﬀective design
and implementation of control logic. This is made possible by a unique time-
step negotiation between both simulators using the external model interface
in LabVIEW. The following programs have to be installed for running a power
electronics co-simulation.
1. Install LabVIEW Full or Professional version
2. LabVIEW Control Design and Simulation Module
3. Multisim
Figure 10.8 shows a general ﬂow diagram for designing a co-simulation
program of an R-L-C electric circuit between LabVIEW and Multisim. As
observed, the process is very easy and friendly.
The following example shows an R-L-C circuit that is modeled using co-
simulation between LabVIEW and Multisim [2]. The steps necessary to com-
plete a co-simulation are presented below.
Step 1: Place the R-L-C electric circuit and the voltage source in the topology in
Multisim, as shown in Figure 10.9.
Step 2: This circuit will be able to send and receive data to and from the Lab-
VIEW simulation engine when the communication terminals are placed.
These terminals in Multisim are hierarchical block or sub-circuit (HB/SC)
terminals. Right-click and select Place on the schematic ≫HB/SC connec-
tor from the shortcut menu, or simply type <Ctrl-I>. Place one HB/SC
connector above and to the left of the schematic and another connector

370
10 LabVIEW-FPGA-Multisim co-Simulation
FIGURE 10.9
Components placed in Multisim
above and to the right of the schematic. Rotate the second connector 180
degrees by holding Ctrl and tapping R twice. Connect the HB connectors
to the circuit by selecting them from the context menu (see Figure 10.10.)
To conﬁgure the HB/SC connector as an input or output to LabVIEW, the
LabVIEW Co-simulation Terminals window must be opened. Nav-
igate to View≫LabVIEW Co-simulation Terminals. Notice that the
HB/SC connectors placed earlier appear in this window. To conﬁgure each
connector as an input or output, select the desired choice from the Mode
settings. Then conﬁgure each connector as a voltage or current input/out-
put by selecting the Type. Finally, if it has placed two input or output
terminals that are needed to function as a diﬀerential pair, a Negative
Connection can be selected. Conﬁgure IO1 as an Input and IO2 as an
Output. You can immediately see the shape of the connector changing
on the schematic based on whether it’s an input or an output connector
(see Figure 10.11). The ﬁnal electric circuit in Multisim can be seen in
Figure 10.12.
Step 3: Creating a Digital Controller in LabVIEW is the last step for connecting
LabVIEW and Multisim. To pass data back and forth between LabVIEW
and Multisim, you must use a Control & Simulation Loop in LabVIEW.
Navigate to the block diagram in LabVIEW (white window), right-click
to open the Functions Palette, and navigate to Control Design &
Simulation≫Simulation≫Control & Simulation Loop. Left-click
and drag the loop onto the block diagram (see Figure 10.13). Now add
the Halt Simulation function to your VI to stop the Control & Simu-
lation Loop. Right-click the block diagram and navigate to Control
Design & Simulation ≫Simulation ≫Utilities ≫Halt Simulation.
Left-click to place the Halt Simulation function on the block diagram and
then right-click the Boolean input of the Halt Simulation VI and select
Create ≫Control. This creates a Boolean control on the front panel
that you can use to halt, or stop, the simulation while it is running. Next,
place the Multisim Design VI that facilitates the communication between
the LabVIEW and Multisim simulation engines. Right-click the block di-

10.2 Co-simulation LabVIEW and Multisim
371
FIGURE 10.10
HB connectors in Multisim
FIGURE 10.11
Input or output section

372
10 LabVIEW-FPGA-Multisim co-Simulation
FIGURE 10.12
Electric circuit (R-L-C)
FIGURE 10.13
Selecting the simulation loop

10.2 Co-simulation LabVIEW and Multisim
373
FIGURE 10.14
Selecting the simulation block diagram in Multisim
agram and navigate to Control Design & Simulation ≫Simulation
≫External Models ≫Multisim ≫Multisim Design, and left-click to
place the VI within the Control & Simulation Loop; it must be placed
within the loop. The Select a Multisim Design dialog box appears af-
ter you position the Multisim Design VI. You now need to either specify
the ﬁle path or browse to the location by clicking the Browse button and
locating the ﬁle on your hard disk.The Multisim Design VI now populates
the terminals, identically to the Multisim Design VI Preview within the
Multisim environment, with the proper inputs and outputs. Left-click on
the double down-arrow and expand the terminals if they are not visible.
Figure 10.14 shows the selection of a Multisim ﬁle in LabVIEW. To pass
data to the Multisim design, you must ﬁrst create a numeric control on the
front panel. To easily accomplish this, right-click on the input, V oltageIn,
and select Create≫Control. This places a numeric control terminal on
the block diagram that is already wired to the input of the Multisim VI.
The block diagram terminal for the control has a corresponding control on
the front panel, which is the user interface in LabVIEW. To quickly navi-
gate between the block diagram and front panel, simply press <Ctrl-E>
(see Figure 10.15).
Using the same design process, it is possible to generate more complex
co-simulations such as DC-DC converters. One of the most well-known
DC-DC converters is the Buck converter, which is designed to supply elec-
trical energy from a power source with a higher voltage VDC to the load
with a lower voltage Vout (see Figure 10.16). When the semiconductor
switch Q1 is on, the electrical energy is delivered from the source VDC
through switch Q1 and inductor L2 to the load. When the output volt-
age (Vout) is high enough, this energy link will be shut down by turning
oﬀQ1. Energies stored in L2 and C2 will maintain the load voltage Vout.
The electrical current in the circuit is sensed using XCP1. Figure 10.17
shows the co-simulation diagram in which a conventional PID controller
is included in order to reach the set point of voltage. Figure 10.18 depicts

374
10 LabVIEW-FPGA-Multisim co-Simulation
(a)
(b)
FIGURE 10.15
Block diagram LabVIEW simulation (a) and frontal panel (b)

10.2 Co-simulation LabVIEW and Multisim
375
FIGURE 10.16
Buck converter designed in Multisim
FIGURE 10.17
Co-simulation diagram between LabVIEW and Multisim
the results when the controller is adjusting the PWM command and the
output voltage reaches the set point of voltage.
A Boos DC-DC converter can also be analyzed using co-simulation. The
topology of a Boost converter is shown in Figure 10.19, and the co-
simulation is presented in Figure 10.20. The input voltage Vin is lower
than the output voltage Vout. When Q1 is on, the diode (D2A) is reversed-
biased and the output stage is isolated. Hence, the inductor receives energy
from Vin. On the other hand, when Q1 is oﬀ, the output stage receives
energy from the inductor as well as Vin; thus, the output voltage (Vout)
is increased. The general relationship between the duty ratio (d), Vin,
and Vout is deﬁned by Equation 10.1, when the DC-DC converter is in
continuous-conduction mode. When the PWM command is changed, the
output voltage is directly aﬀected (see Figure 10.21).
Vout =
Vin
1 −d.
(10.1)

376
10 LabVIEW-FPGA-Multisim co-Simulation
FIGURE 10.18
Co-simulation results using a conventional PID controller
FIGURE 10.19
DC-DC boost converter in Multisim
FIGURE 10.20
Co-simulation block diagram

10.2 Co-simulation LabVIEW and Multisim
377
(a)
(b)
FIGURE 10.21
Results of Boost converter for a PWM command of 0.89 (a) and 0.3 (b)

378
10 LabVIEW-FPGA-Multisim co-Simulation
10.3
Case study: Intelligent wind turbine control with
LabVIEW simulation
Nowadays, wind energy only supplies a fraction of the total power demand in
the world, but it is growing very fast, while the cost per watt of the electricity
produced falls proportionally. The progress of wind power in recent years has
exceeded all expectations, with Europe leading the global market [17, 20], and
global installed capacity increasing 14, fold from 2000 to 2011, suﬃcient to
cover 3% of the world’s electricity demand. In the near future, many countries
around the world are likely to increase the level of wind energy generation.
Wind turbines produce no CO2 emissions and could help to reduce global
greenhouse gas emissions. The cost of the electricity provided by wind en-
ergy facilities has been dropping since the 1980s, which makes wind power
an interesting economical alternative energy source for developing regions of
the world compared to fossil fuel-based generation. The cost reduction is due
to new technologies and higher production scales, leading to larger and more
reliable wind turbines. Hence, control systems have a key role in wind energy
systems since the performance and reliability of the turbine can be signif-
icantly enhanced by intelligent control systems [18]. However, the inherent
variability of the wind resource creates diﬃculties in forecasting the energy
production of wind farms, which makes management of the renewable resource
more challenging. This variability of the wind energy resource production is
in contrast to the consistency of the power output from conventional fossil
fuel-based energy sources, but can be mitigated through the use of intelli-
gent control, energy forecasting, and smart grid technologies, such as energy
storage systems located by the wind farm. The eﬃciency of the wind turbine
power generation can be maximized if the rotational speed is such that the
ratio between the blades’ tip speed and wind speed, called the tip-speed ratio,
is the optimal one at any time (λopt). One popular turbine topology in recent
years has been the doubly-fed induction generator, which has the following
features:
• It generates power at constant frequency while operating at variable
speeds.
• The slip power is recovered and injected into the grid by the power con-
verter.
• It can generate power with good eﬃciency over a reasonable speed range.
• Since only a fraction of the power goes through the switched-mode power
converter, its rating is signiﬁcantly smaller than in variable speed/variable
frequency schemes in which all of the turbine power is transferred through
a back-to-back AC-to-DC converter and DC-to-AC inverter.

10.3 Case study: Intelligent wind turbine control with LabVIEW
379
Classical wind turbines are characterized by lower inertia than classical power
plants. In the case of back-to-back converter/inverter topologies, common with
permanent magnet synchronous machine (PMSM) type turbines, the interme-
diate DC-voltage bus creates an electrical decoupling between machine and
grid. This decoupling can lead to a reduced amount of stored kinetic energy
in the turbine, but the eﬀect can be compensated for through suitable imple-
mentations of machine control. In the case of variable-speed wind generators,
[42] suggested using the blade and machine inertia as a kinetic energy storage
system to participate in regulation of primary frequency control. However,
releasing or storing kinetic energy can only be considered as a portion of the
primary control scheme. Since wind persistence is limited, the power reserve
cannot be guaranteed for the long term.
It is also suggested in [17] to maintain a power reserve with the help of the
pitch control when the wind generator works close to rated power. It is also
possible to obtain a power reserve with the help of generator torque control
but at a cost with regards to overall turbine power eﬃciency. In the case of
the doubly-fed induction machine (DFIG), the power captured by the wind
turbine is converted into electrical power by the induction generator and it
is transmitted to the grid by both the stator and the rotor windings. The
control system generates the pitch angle command and the voltage command
signals at the rotor in order to control the power of the wind turbine, the
DC bus voltage, and the voltage and frequency at the grid terminals. This
section shows an intelligent control system that is proposed for DFIG wind
turbines, which is intended to be cost eﬀective and provide pitch control while
reducing the mechanical stresses. In the near future the power rating of the
wind turbines will increase further, especially in oﬀshore applications. Doubly
fed induction generator machines can be designed to work over a reasonable
speed range for improving overall power quality and system eﬃciency.
An important factor in the design of variable-speed wind turbine controls
is the random excitation of the system caused by wind turbulence. Obtaining
an optimal control design that balances all of these requirements, constraints,
and challenges requires high-performance digital control systems.
Intelligent control (IC) systems have the ability to work well when the
operation point of the system is changing, because the IC system can imple-
ment its derived control laws from a number of diﬀerent sources, including
human knowledge. Fuzzy logic systems, for example, are able to synthesize
information from human experts. Also, artiﬁcial neural networks can imple-
ment complex non-linear control laws that are automatically derived from the
desired input-to-output response mapping of the overall wind turbine system.
10.3.1
Wind turbine operation
According to [17], the double-fed induction generator can be explained by the
power ﬂow shown in Figure 10.22. The input is the mechanical power from the
spinning blades and the main power output is the electrical power ﬂowing from

380
10 LabVIEW-FPGA-Multisim co-Simulation
the stator windings. Since the generator is an asynchronous machine, the value
of the slip, s, deﬁned as the ratio ωr
ωs between the slip and synchronous angular
frequency, is lower than 1 and, consequently, the rotor power, Pr, is only a
fraction of the stator power, Ps. The sign of Pr is a function of the slip sign
when the mechanical torque applied to the rotor is positive. The synchronous
speed, ωs, is normally a positive constant for generation with a constant grid
voltage. Thus, the slip power can ﬂow in both directions: to the rotor from
the supply, and from the supply to the rotor. The speed of the machine can
be controlled from either the rotor- or stator-side converter in both super-
and sub-synchronous speed ranges. Thus, the machine can be controlled as a
generator or a motor in both super- and sub-synchronous operating modes,
yielding all four quadrants of operation [17]. Below the synchronous speed in
the motoring mode and above the synchronous speed in the generating mode,
a rotor-side converter operates as a rectiﬁer and a stator-side converter as an
inverter, whereby slip power is returned to the stator. Below the synchronous
speed in the generating mode and above the synchronous speed in the mo-
toring mode, the rotor-side converter operates as an inverter and stator-side
converter as a rectiﬁer, whereby slip power is supplied to the rotor. At the
synchronous speed, slip power is taken from the supply to excite the rotor
windings, and in this case the machine behaves as a synchronous machine.
The following conditions can occur in the induction generator:
1. Pr is positive for negative slip (speed greater than synchronous speed).
2. Pr is negative for positive slip (speed lower than synchronous speed).
3. Pr is transmitted to the DC bus capacitor and raises the DC voltage for
super-synchronous speed operation.
4. Pr is taken out of the DC bus capacitor and decreases the DC voltage for
sub-synchronous speed operation.
The grid-tied power converter, Cgrid, is used to generate or absorb the
power ﬂowing to the grid, Pgc, in order to keep the DC voltage constant. In
steady-state for a theoretical lossless AC/DC/AC converter, Pgc is equal to Pr
and the speed of the wind turbine is determined by the power, Pr, absorbed or
generated by the rotor-tied converter, Crotor. The phase-sequence of the AC
voltage generated by Crotor is positive for sub-synchronous speed and negative
for super-synchronous speed. The frequency of this voltage is equal to the
product of the grid frequency and the absolute value of the slip. A beneﬁcial
feature for utility grid operation is that Crotor and Cgrid have the capability
for generating or absorbing reactive power and can be used to control the
reactive power or the voltage at the grid terminals [37].
10.3.2
Wind turbine per unit (P. U.) model
Figure 10.23 shows the simulation model of the wind, control system, and
wind generator. The turbine simulation model was designed using the National

10.3 Case study: Intelligent wind turbine control with LabVIEW
381
(a)
(b)
(c)
FIGURE 10.22
Wind turbine simulation results (a and b) and wind turbine model in Lab-
VIEW (d)

382
10 LabVIEW-FPGA-Multisim co-Simulation
FIGURE 10.23
Wind turbine complete simulation model using LabVIEW block diagram
Instruments LabVIEW control design and simulation module [62]. This model
does not include the following eﬀects:
• Magnetic saturation
• Airgap harmonics
• Skin eﬀects
The dynamic equations for the induction machine in reference frame k are
deﬁned below. The reference frame, k, can be stationary or rotating.
V k
s ejθk = Ik
s ejθkRs + jωkΨ k
s ejθk + ejθk d
diΨ k
s
V k
r = Ik
r Rr + j(ωk −ωr)Ψ k
r + d
diΨ k
r
Ψ k
s = LsIk
s + LmIk
r
Ψ k
r = LrIk
r + LmIk
s
Tm −TL = Jm
dωr
dt
Tm = (Ψsαisβ −Ψsβisα)
10.3.3
Fault model of the wind turbine converter circuit
Since the converter circuit model of the doubly fed wind turbine is strongly
nonlinear, it is usually diﬃcult to perform online fault diagnostics. However,
the input-to-output mapping of neural networks is also nonlinear and features
the beneﬁt of a strong capacity for learning and generalization of error symp-
toms. The mapping relation between the fault information, the fault type, or
the cause of the fault in the wind turbine converter circuit can be learned
and saved by a neural network. This enables the automatic online diagnosis of

10.3 Case study: Intelligent wind turbine control with LabVIEW
383
faults locally within the turbine control system itself. Taking, for example, the
power converter of Figure 10.1, a possible fault condition is the disconnection
of one converter bridge arm. In this scenario, the fault status of the converter
can be divided into ﬁve basic types.
1. Primary fault condition 001: There are no faults detected in the electric
power electronics components. The converter is operating normally.
2. Primary fault condition 010: A fault is detected in only one converter.
This fault can be sub-classiﬁed into six types:
a. Fault detected in component 1 (001)
b. Fault detected in component 2 (010)
c. Fault detected in component 3 (011)
d. Fault detected in component 4 (100)
e. Fault detected in component 5 (101)
f. Fault detected in component 6 (110)
3. Primary fault condition 011: A fault is detected in the same phase of two
converters. These faults can be sub-classiﬁed into three types:
a. Fault detected in components 1 and 4 (001)
b. Fault detected in components 2 and 5 (010)
c. Fault detected in components 3 and 6 (011)
4. Primary fault condition 100: A fault is detected in two components of a
half-bridge. These faults can be sub-classiﬁed into six types:
a. Fault detected in components 1 and 3 (001)
b. Fault detected in components 2 and 4 (010)
c. Fault detected in components 3 and 5 (011)
d. Fault detected in components 4 and 6 (100)
e. Fault detected in components 5 and 1 (101)
f. Fault detected in components 6 and 2 (110)
5. Primary fault condition 101: A fault is detected in two crossing compo-
nents. These faults can be sub-classiﬁed into six types:
a. Fault detected in components 1 and 2 (001)
b. Fault detected in components 2 and 3 (010)
c. Fault detected in components 3 and 4 (011)
d. Fault detected in components 4 and 5 (100)
e. Fault detected in components 5 and 6 (101)

384
10 LabVIEW-FPGA-Multisim co-Simulation
TABLE 10.1
Tasks commonly solved by artiﬁcial neural networks (ANNs)
Task
Description
Function approximation
Linear and nonlinear functions can
be approximated by neural
networks. The ANN performs a
model or curve ﬁtting function.
Classiﬁcation
1) Data classiﬁcation: The ANN
assigns data to a speciﬁc class or
subclass. Useful for identifying
patterns.
2) Signal classiﬁcation: Time-series
data is classiﬁed into subsets or
classes. Useful for identifying the
signal source.
Unsupervised clustering
Identiﬁes order in data. Creates
clusters of data of unknown classes.
Forecasting
Predict the next values in a
time-series waveform.
Control systems
ANN commonly performs function
approximation, classiﬁcation,
unsupervised clustering, and
forecasting. Also, ANNs are used in
model identiﬁcation and analysis of
open and closed loop systems.
f. Fault detected in components 6 and 1 (110)
An 8-bit coding scheme is used to describe the fault whereby the eighth bit
distinguishes converter 1 from converter 2 (a value of 0 indicates converter 1),
the primary fault type is encoded from the seventh bit to the ﬁfth bit, the
sub-classiﬁcation type code is indicated with the fourth bit to the second bit,
and an odd or even checksum is located in the ﬁrst bit.
10.3.4
Artiﬁcial neural networks for fault detection
Artiﬁcial neural networks (ANNs) are applied in several problems [63], but
there are typically around ﬁve main problems in which the performance of
artiﬁcial neural networks stands out. Those problems are listed in Table 10.1.
Hebbian neural networks are an unsupervised and competitive ANN and
they can be applied to diﬀerent associative problems such as fault detection.
As unsupervised networks, these ANNs only have information about the in-
put space. Their training is based on the fact that neuron weights store the

10.3 Case study: Intelligent wind turbine control with LabVIEW
385
TABLE 10.2
Hebbian learning procedure
Algorithm
Hebbian learning procedure
Step 1
Determine the input space.
Specify the number of iterations
iterNum and initialize t = 0
Generate small random values of
weights wi
Step 2
Evaluate the Hebbian neural
network and obtain the outputs xi
Step 3
Apply the updating rule (4)
Step 4
If t = iterNum then STOP
Otherwise, go to Step 2
fault detection information. The weights stored in the ANN can only be rein-
forced if the input stimulus provides suﬃcient output response values. In this
way, weights change proportionally to just the output signals. By this fact,
neurons compete to be a dedicated reaction to a part of the input. Hebbian
neural networks are thus considered the ﬁrst self-organizing nets. The learn-
ing procedure is based on the following statement pronounced by Hebb: As
A becomes more eﬃcient at stimulating B during training, A sensitizes B to
its stimulus, and the weight on the connection from A to B increases during
training as B becomes sensitized to A.
Then, Steven Grossberg developed a mathematical model for this sentence
[63]:
wnew
AB = wold
AB + βxBxA,
where wAB is the weight between the interaction of two neurons A and B, xi
is the output signal of the i neuron. xBxA is so called the Hebbian learning
term. The next algorithm gives the Hebbian learning procedure (Table 10.2).
Figure 10.24 shows a Hebbian network for a classiﬁcation problem of 8-bit
input signal based on LabVIEW. In the same way, a key point signal can be
supplied in order to get its classiﬁcation process about the fault diagnosis.
In fact, one of the main signals to observe in fault diagnosis is the direct
current pulse voltage Vd of the three phases commute circuit and look at the
output port of inductance load that contains the information about whether
the transistor is fault or not, according to the fault model. If the fault type is
diﬀerent, the wave of Vd is diﬀerent, and the fault type can only be analyzed by
the six spectrum quantity, containing the direct current a0 quantity of voltage,
the 1,2,3-harmonic amplitude value (A1 A2,A3), and the 1,2-harmonic phase
(P1, P2); as a result, Vd is the main point signal in the wave method. Since
the phase information is needed in fault diagnosis, the time π
6 with phase A
voltage passing the zero acts as a reference point at every diagnosis. For the

386
10 LabVIEW-FPGA-Multisim co-Simulation
(a)
(b)
FIGURE 10.24
(a) Hebbian network 8-bit classiﬁcation and classiﬁcation using generated fault
signals (b)

10.3 Case study: Intelligent wind turbine control with LabVIEW
387
Collect N points of Vd as neural
network input
Get data of Vd and Va
Get RMS of
phase voltage
Get the neural network
output as fault code
Get the information about the
fault point
FIGURE 10.25
Fault diagnosis process using neural networks
FIGURE 10.26
Results using Hebbian artiﬁcial neural network
wave method, the N pieces of unitary data collected in a period are directly
input into the neural networks. A simple ﬂow chart of the fault diagnostic
process is presented in Figure 10.25.
The results obtained using Hebbian artiﬁcial neural networks when a fault
signal was generated are presented in Figure 10.26. The angle β acts like a
sampler at ﬁxed intervals (8◦), the result presented was getting the angle β =
45◦for a big-type fault. The results show a good classiﬁcation and recognition
system. So, the use of neural networks for detecting all the fault signals of the
converter presented below gets zero error.
Using a control topology based on intelligent control systems, the perfor-
mance of the wind turbine can be improved. The proposed control system [62]
includes a fuzzy logic controller for the pitch angle, a grey system for predict-
ing the wind proﬁle, and two ANFIS for controlling the generator currents.
Figure 10.27 shows the proposed topology in which the fuzzy logic controller
is a PI fuzzy logic controller [63]). The ANFIS was tuned with constant out-
puts; for tuning the ANFIS controller, the hybrid training was applied. The
simulation results are presented in Figures 10.27, 10.28, and 10.29.
The above results were obtained without the power electronics stage (in-
verter) that is one of the main stages in the simulation of a wind generator.

388
10 LabVIEW-FPGA-Multisim co-Simulation
(a)
(b)
(c)
FIGURE 10.27
(a) Main control and simulation loop, (b) model estimation process, and (c)
detailed view of the fuzzy controller

10.3 Case study: Intelligent wind turbine control with LabVIEW
389
FIGURE 10.28
Wind speed controller

390
10 LabVIEW-FPGA-Multisim co-Simulation
FIGURE 10.29
ANFIS incorporation to rotor voltage computation

10.3 Case study: Intelligent wind turbine control with LabVIEW
391
FIGURE 10.30
Frontal panel of grey predictor results (real wind, grey predictor, and predic-
tion error)
Thus, the following test was done, including the power electronic stage, using
a space vector modulation and ideal switches. The parameters of the controller
were kept constant, using the previous tuning (without the inverter). As the
results show, the controllers can deal with the pulse distortion generated for
the power electronic stage. The selection of SPWM helps to decrease the har-
monics and also increase the DC bus energy that can be used. Figure 10.31
presents the rotor voltage using the space pulse width modulation (SPWM),
and Figure 10.32 shows the performance of the wind turbine using intelligent
control systems.
(a)
(b)
FIGURE 10.31
Rotor voltage: (a) reference signals and rotor voltage and (b) three-rotor volt-
age using the SPWM

392
10 LabVIEW-FPGA-Multisim co-Simulation
FIGURE 10.32
Controller performance including the power electronic stage using space pulse
width modulation
10.4
Co-simulation LabVIEW FPGA and Multisim
When a designer is using a conventional simulation as a tool for making power
electronic stages, there are multiple problems that have to be addressed before
a ﬁnal prototype is achieved. Thus, the time and design eﬀort are large and
the simulation can be far from the experimental prototype. The ﬂow diagram
for designing has one direction when conventional simulation is used. On the
other hand, when a co-simulation between LabVIEW FPGA and Multisim is
implemented, a bidirectional way is established (see Figure 10.33). Hence, the
validation of the design is more accurate [54].
The co-simulation between LabVIEW FPGA and Multisim is divided in
two parts. The ﬁrst one is modeled in Multism and the second one is the
control program designed in LabVIEW FPGA. This co-simulation has a big
advantage in that it is a time-adaptive synchronized co-simulation (TASCS),
so the simulation runs with a variable simulation step that is adjusted ac-
cording to the requirements of the simulation. Figure 10.34 illustrates a co-
simulation between LabVIEW FPGA and Multisim. Hence, TASCS enables
accurate, time-synchronized co-simulation of the FPGA and switched-mode
power electronics, automatically adapting for fast transient events such as
faults and short-circuits (see Figure 10.35). Moreover, the co-simulation gives
results that are closer to the experimental ones; for instance, in electric ma-
chines the power electronic stage can be included and thermal eﬀects could
be analyzed (see Figure 10.36).
The next exercise is a basic co-simulation between LabVIEW FPGA and
Multisim. It gives a basic introduction about co-simulation [54]. The ﬁrst part
of the exercise is to show oﬀthe project explorer window hierarchy, now with
two new targets, the RT controller and FPGA, and then jump into the VI

10.4 Co-simulation LabVIEW FPGA and Multisim
393
FIGURE 10.33
Reducing the simulation to deployment cycle from weeks to hours

394
10 LabVIEW-FPGA-Multisim co-Simulation
FIGURE 10.34
Co-simulation between LabVIEW FPGA and Multisim

10.4 Co-simulation LabVIEW FPGA and Multisim
395
FIGURE 10.35
Co-Simulation ﬂow diagram

396
10 LabVIEW-FPGA-Multisim co-Simulation
(a)
(b)
FIGURE 10.36
Induction motor drive (inverter A) and grid synchronized inverter (inverter
B), frontal panel (a), and Multisim diagram (b)

10.5 Case study: A half-bridge inverter control
397
front panel and block diagram, highlighting the diﬀerences from LabVIEW
programming on Windows (see Figure 10.37). Follow the next basic steps in
order to create and connect the co-simulation. Install the required software
using the Measurements and Automation Explorer (see Figure 10.38) and
connect the hardware (see Figure 10.39). Finally, the co-simulation ﬁle using
LabVIEW FPGA can be created (see Figure 10.40).
1. Disable WiFi
2. Launch NI MAX
3. Refresh remote systems
4. Format disk
5. Install ﬁrmware: LabVIEW RT Add-Ons
6. LabVIEW PID and Fuzzy Logic Toolkit
7. NI system conﬁguration
8. System State Publisher / Network I/O
9. Network Streams/ Protocols and Buses
10. NI-Watchdog
11. Set LV Project IP address
12. Connect
10.5
Case study: A half-bridge inverter control
This example will present how an application running on the FPGA using the
desktop execution node is deployed. The application switches two IGBTs in
order to produce an analog signal.
10.5.1
Background
The ﬁeld-programmable gate array (FPGA) allows a user to perform a variety
of tasks, including signal processing, at higher speeds than most processors.
The FPGA desktop execution node allows a user to run an FPGA appli-
cation on the development computer with simulated I/O. By specifying the
desired FPGA clock speed, as well as the number of ticks before inputs are
read and outputs are written, a user can determine the functionality of their
FPGA application without needing to compile and deploy the application to

398
10 LabVIEW-FPGA-Multisim co-Simulation
FIGURE 10.37
Project explorer
FIGURE 10.38
Measurements and automation explorer

10.5 Case study: A half-bridge inverter control
399
FIGURE 10.39
Connect the GPIC inverter board

400
10 LabVIEW-FPGA-Multisim co-Simulation
FIGURE 10.40
FPGA — Multisim co-simulation for manual IGBT control using LabVIEW
FPGA and Multisim

10.5 Case study: A half-bridge inverter control
401
the FPGA hardware [54]. Figure 10.41 shows the FPGA co-simulation. To ef-
fectively simulate an FPGA design using the FPGA desktop execution node,
you must understand two time paradigms, real-world time and simulated time.
Real-world time is the physical amount of time that elapses while something
occurs. Because an FPGA is a programmable circuit, it takes a ﬁxed amount
of real-world time to execute such a circuit. To simulate a design, you can
create a model that reﬂects the functional behavior of the FPGA and execute
this model on a computer processor. However, such a model does not have the
same real-world timing as the FPGA. To create a model that has the same
real-world timing as the FPGA, you must use simulated time. Simulated time
is an event-driven model of real-world time. When LabVIEW executes block
diagram nodes, the execution causes simulated time to advance a certain num-
ber of steps. Clock ticks are the unit of simulated time where one clock tick
is representative of a single cycle of the referenced FPGA clock [6].
For this exercise, you will need to use the LabVIEW FPGA in order to
control the power inverter. A power inverter consists of a voltage source, two
insulated-gate bipolar transistors (IGBTS), an inductor, a capacitor, and a
resistor (see Figure 10.42). The IGBTs switch in order to change the current
ﬂowing through the resistive load while the inductor and capacitor ﬁlter and
smooth the output signal. The power inverter performs DC-to-AC conversion.
10.5.2
Procedure
To run the half-bridge inverter control, a Multisim ﬁle and two TestBench
VIs are needed. As shown in Figure 10.43, a project was designed. On the
other hand, the Multisim ﬁle is used for studying the thermal conditions in
the semiconductors, as shown in Figure 10.44. This Multisim ﬁle has to be
constructed in order to create the co-simulation. In the Multisim editor envi-
ronment, if you do not see the LabVIEW Co-Simulation Terminals pane
(red box in the screenshot above), go to the View menu, select it, and then
position it in the desired location (see Figure 10.45).
It is necessary to deﬁne a LabVIEW project. This ﬁle is the front panel of
the half-bridge IGBT controller. In the LabVIEW project (see Figure 10.46),
double-click on [TestBench] Half-Bridge IGBT Control - Starting
Point.vi.
The goal of this example is to control the IGBTs (switches) in such a
way as to avoid damaging the hardware. In addition to the switches, other
controls include a slider for the modulation index and a button for stopping
the program. Important indicators include the IGBT temperatures, a dial for
the output voltage, both instant and RMS, as well as a chart that plots various
waveforms from the circuit. Open the block diagram by pressing CTRL+E or
by navigating to Window≫Show Block Diagram and observe the layout.
Press CTRL+H to open the Context Help window and place the mouse
over the blue box that reads Desktop Execution Node. This will cause the
Context Help window to display information about the desktop execution

402
10 LabVIEW-FPGA-Multisim co-Simulation
FIGURE 10.41
To enable high ﬁdelity co-simulation, the LabVIEW FPGA desktop execution
node interfaces to the LabVIEW FPGA application while the Multisim co-
simulation interface connects to the power electronics circuit model. A desktop
testbench application is shown.

10.5 Case study: A half-bridge inverter control
403
(a)
(b)
FIGURE 10.42
The Multisim power electronics circuit (a) and LabVIEW FPGA control ap-
plication (b) are co-simulated with a common sense of simulated time

404
10 LabVIEW-FPGA-Multisim co-Simulation
FIGURE 10.43
The project design for a half-bridge IGBT
FIGURE 10.44
Thermal analysis of IGBTs using Multisim

10.5 Case study: A half-bridge inverter control
405
FIGURE 10.45
LabVIEW co-simulation terminals

406
10 LabVIEW-FPGA-Multisim co-Simulation
FIGURE 10.46
LabVIEW half-bridge IGBT control ﬁle
node (see Figure 10.47). The desktop execution node allows users to run FPGA
VIs on the development computer with simulation I/O.
To run the program and experiment with the IGBT switches, navigate to
the front panel of [TestBench] Half-Bridge IGBT Control - Starting
Point.vi. Run the application by pressing the Run button on the toolbar.
Check the box Close on successful completion. Select Close once the
deployment is complete (see Figure 10.48.)
The application will take a moment to begin running. Once running, the
waveforms will begin to be plotted on the graph. While the program is run-
ning, open the front panel to [FPGA] Half-Bridge Inverter Control.vi.
Left-click the top switch to close it. Observe the graph on the front panel of
the [TestBench] Half-Bridge IGBT Control - Starting Point.vi. (See
Figure 10.49.)
It is very important to understand that co-simulation using FPGA can
gives results closer to the experimental ones, as shown in Figure 10.50, in
which experimental and simulation results are compared.
10.6
Case study: the phase-lock loop (PLL)
10.6.1
Summary
In this example, you will be creating your own 3-phase phase-locked loop
(PLL) in order to understand how one might be implemented in a 3-phase

10.6 Case study: the phase-lock loop (PLL)
407
FIGURE 10.47
Desktop execution node
FIGURE 10.48
Deployment process

408
10 LabVIEW-FPGA-Multisim co-Simulation
(a)
(b)
FIGURE 10.49
Frontal panel (a) and block diagram (b) of the co-simulation

10.6 Case study: the phase-lock loop (PLL)
409
FIGURE 10.50
Comparing simulated against experimental results
inverter. Phase-locked loops are important to grid-tied power because in order
to supply power to a grid, the inverter output must be phase locked to the
grid frequency. Tasks you will do to complete this exercise include [54]):
• Implementing a 3-phase PLL
• Simulating a PLL application using the desktop execution node
• Experimenting by varying the input and outputs to your PLL application
10.6.2
Background
Phase-locked loops are a form of feedback control. A PLL produces an oscil-
lating output, which begins operating with a set frequency. An input is then
passed to the PLL to serve as a reference point. The PLL adjusts the output to
then closely match the input phase. The longer the PLL runs, the more closely
the PLL output is able to track the input, given that the input is stable. PLLs
are useful in a variety of synchronous applications. Such applications include
clock multipliers, demodulation, and power-grid phase locking. In order to
connect an inverter to the grid, the inverter output’s phase must be within a
few degrees of the grid signal phase. This is where the PLL will be applied.
By using the grid signal as a reference, the PLL is capable of generating a
waveform that will be phase-locked to the grid signal. This output can then
be used to drive PWM in order to generate the inverter output, as shown in
Figure 10.51.
For creating a three-phase PLL, a project has to be created. There are a
Multisim ﬁle and three VIs in the project, as shown in Figure 10.52.
The VI includes a front panel of the PLL application in which a vertical

410
10 LabVIEW-FPGA-Multisim co-Simulation
FIGURE 10.51
Frontal panel of a three-phase PLL
FIGURE 10.52
PLL ﬁles in the project

10.6 Case study: the phase-lock loop (PLL)
411
slider on the left to control frequency of the simulated power grid waveforms
is added, as shown in Figure 10.53.
The Desktop Execution Node to open up the FPGA application
[FPGA] PLL Testbench.vi is presented in Figure 10.54. For this appli-
cation, the Clock Ticks setting is set to 325 ticks. Thus, for every 325 ticks
of the 40 MHz FPGA clock, every 8.125 microseconds of simulated time, the
Desktop Execution Node will return the register values for the items chosen
in the Selected Resources dialogue (see Figure 10.55). Note that the FPGA
resources you can choose from include both front panel controls and indica-
tors as well as I/O resources. In this case, no changes to the conﬁguration are
necessary, so click Cancel to exit.
When the TestBench application is run, the PLL frequency is initially 30
Hz and takes a half cycle to begin tracking the noisy simulated grid waveforms.
You can see the frequency of PLL in the indicator labeled PLL Frequency.
Due to the noisy nature of the 3-phase grid waveforms and the aggressive tun-
ing of the PLL proportional-integral (PI) control system, the PLL Frequency
oscillates around the correct grid frequency (see Figure 10.56).
As it was presented, the cos-simulation is a powerful tool for designing
power electronics in power systems which has to be considered during the
creating process in power electronics. As a result, extremely complex systems
can be created, such as the micro-grid experimental laboratory shown in Fig-
ure 10.57.

412
10 LabVIEW-FPGA-Multisim co-Simulation
(a)
(b)
FIGURE 10.53
Front panel (a) and block diagram (b) for the PLL co-simulation

10.6 Case study: the phase-lock loop (PLL)
413
FIGURE 10.54
PLL control loop
FIGURE 10.55
Conﬁgure desktop execution node

414
10 LabVIEW-FPGA-Multisim co-Simulation
FIGURE 10.56
PLL Co-simulation results
FIGURE 10.57
Micro-grid experimental laboratory [54]

Bibliography
[1] GE: GE wind turbine technology selected for new wind power station
in Japan. http://site.ge-energy.com/about/press/en/2003_press/
100103.htm. (Accessed 05/19/2017).
[2] NI multisim user manual — National Instruments. http://www.ni.com
/pdf/manuals/374483d.pdf. (Accessed 05/19/2017).
[3] Simulation fundamentals: Cosimulation in NI multisim — National In-
struments.
http://www.ni.com/white-paper/6369/en/.
(Accessed
05/19/2017).
[4] Stardom and fa-m3 ensure smooth supply of power to grid by wind farm
equipped with large-capacity NAS batteries — Yokogawa Electric Cor-
poration.
https://www.yokogawa.com/library/resources/referen
ces/stardom-and-fa-m3-ensure-smooth-supply-of-power-to-gri
d-by-wind-farm-equipped-with-large-capacity-nas-batteries/.
(Accessed 05/19/2017).
[5] Storage boosts the power of renewable energy — Renewable Energy
World.
http://www.renewableenergyworld.com/articles/2008/
06/storage-boosts-the-power-of-renewable-energy-52716.html.
(Accessed 05/19/2017).
[6] Using the LabVIEW FPGA desktop execution node — National In-
struments.
http://www.ni.com/white-paper/51859/en/.
(Accessed
05/19/2017).
[7] www.cir-strategy.com/uploads/kuhrt.pdf. http://www.cir-strategy.
com/uploads/Kuhrt.pdf. (Accessed 05/19/2017).
[8] Smart grid system report. Technical report, U.S. Department of Security,
July 2009. Accessed: 2017-05-18.
[9] IEEE draft guide for smart grid interoperability of energy technology and
information technology operation with the electric power system (EPS),
and end-use applications and loads. P2030/D6.0, July 2011. Inactive-
Draft.
[10] M.H. Baker L. Bohmann K. Clark K. Habashi L. Gyugyi J. Lemay A.S.
Mehraban A.K. Myers J. Reeve F. Sener D.R. Torgerson R.R. Wood.
415

416
Bibliography
A-A. Edris, R. Adapa.
Proposed terms and deﬁnitions for ﬂexible ac
transmission system FACTS.
IEEE transacitions on Power Delivery,
12(4):1848 – 1853, 1997.
[11] Thomas Ackermann. Wind power in power systems. John Wiley & Sons,
2005.
[12] SA Ahmed and HO Mahammed. A statistical analysis of wind power
density based on the Weibull and Ralyeigh models of “Penjwen Region”
Sulaimani/Iraq. Jordan Journal of Mechanical and Industrial Engineer-
ing, 6(2):135–140, 2012.
[13] Vladislav Akhmatov. Induction generators for wind power. Multi-Science
Pub., 2005.
[14] C. K. Alexander and M. Sadiku.
Fundamentals of Electric Circuits.
McGraw-Hill, 4th edition, 2009.
[15] P. M Anderson. Analysis of faulted power systems. IEEE Press, New
York, 1995.
[16] European Wind Energy Association. Pure power-wind energy targets for
2020 and 2030. EWEA, 2011.
[17] Fernando D Bianchi, Ricardo J Mantz, and Hern´an De Battista. The
Wind and Wind Turbines. Springer, 2007.
[18] B.K. Bose. Modern Power Electronics and AC Drives. Eastern Economy
Edition. Prentice Hall PTR, 2002.
[19] Tony Burton, Nick Jenkins, David Sharpe, and Ervin Bossanyi. Wind
Energy Handbook. 2nd edition, 2011.
[20] Natural Resources Canada. Wind energy. http://www.nrcan.gc.ca/en
ergy/renewables/wind/7299, October 2016. (Accessed 2017-10-03).
[21] Anders Carlsson. The back-to-back converter. Lund: Department of In-
dustrial Electrical Engineering and Automation Lund Institute of Tech-
nology, 7, 1998.
[22] Juan Manuel Carrasco, Leopoldo Garcia Franquelo, Jan T Bialasiewicz,
Eduardo Galv´an, Ram´on Carlos PortilloGuisado, MA Martin Prats,
Jos´e Ignacio Le´on, and Narciso Moreno-Alfonso. Power-electronic sys-
tems for the grid integration of renewable energy sources: A survey. IEEE
Transactions on industrial electronics, 53(4):1002–1016, 2006.
[23] J. Casazza, J. Casazza, and F. Delea. Understanding electric power sys-
tems: an overview of the technology and the marketplace, volume 13. John
Wiley & Sons, 2003.

Bibliography
417
[24] J. J. Cathey. Electric machines: analysis and design applying MATLAB.
McGraw-Hill Higher Education, 2000.
[25] Joe C.L. Chan and Duncan S. Wong. Cyber attacks and the smart grid.
IEEE Smart Grid Newsletter.
[26] Stephen J Chapman. Electric machinery and power system fundamentals.
McGraw-Hill, 2002.
[27] Alexander C.K. and Sadiku M.N.O. Fundamentals of electric circuits.
McGraw-Hill, Boston, USA, 2009.
[28] Leon Clarke, James Edmonds, Henry Jacoby, Hugh Pitcher, John Reilly,
and Richard Richels. Scenarios of greenhouse gas emissions and atmo-
spheric concentrations. US Department of Energy Publications, page 6,
2007.
[29] Global Wind Energy Council and Global Wind Statistics.
Electronic
resource.
European Commission. Mode of access: <http://ec.europa.
eu/energy/international/russia/dialogue/doc/2012 eu russian members
council.pdf>. Date of access, 25, 2013.
[30] Kothari D. Modern power system analysis. Tata McGraw-Hill Education,
2003.
[31] US DoE. Annual energy outlook 2014 with projections to 2040. Wash-
ington, DC: US Energy Information Administration, US Department of
Energy, 2014.
[32] M. A. El-Sharkawi. Electric Energy: An introduction. CRC Press, Boca
Raton, FL, 3rd edition, 2013.
[33] H. Enr´ıquez. Tecnolog´ıas de generaci´on de energ´ıa el´ectrica. Limusa,
Mexico, 1st edition, 2009.
[34] Wagner C. F. and Evans R. D. Symmetrical components. McGraw-Hill
Education, 1931.
[35] J. R. Fanchi. Energy in the 21st century. World Scientiﬁc Publishing Co.,
Singapore, 1st edition, 2006.
[36] Hewitson L. G., Brown M., and Balakrishnan R. Practical power systems
protection. Oxford, 2005.
[37] Richard Gagnon, Gilbert Sybille, Serge Bernard, Daniel Par´e, Silvano
Casoria, and Christian Larose. Modeling and real-time simulation of a
doubly-fed induction generator driven by a wind turbine. In Intl. Con-
ference on Power Systems Transients, Canada, 2005.
[38] J. D. Glover, M. S. Sarma, and T. J. Overbye. Power System Analysis
& Design. Cengage Learning, 2011.

418
Bibliography
[39] J. D. Glover, M. S. Sarma, and T. J. Overbye. Power System Analysis
& Design, SI Version. Cengage Learning, 2011.
[40] Duane C Hanselman. Brushless permanent magnet motor design. The
Writers’ Collective, 2003.
[41] Lars Henrik Hansen, Peter Hauge Madsen, F Blaabjerg, HC Christensen,
U Lindhard, and K Eskildsen. Generators and power electronics technol-
ogy for wind turbines. In Industrial Electronics Society, 2001. IECON’01.
The 27th Annual Conference of the IEEE, volume 3, pages 2000–2005.
IEEE, 2001.
[42] L Holdsworth, XG Wu, Janaka Bandara Ekanayake, and Nick Jenkins.
Comparison of ﬁxed speed and doubly-fed induction wind turbines during
power system disturbances. IEE Proceedings-Generation, Transmission
and Distribution, 150(3):343–352, 2003.
[43] J Hossain. World wind resource assessment report. Technical report,
World Wind Energy Association, 2014.
[44] Ekanayake J.B. Smart grid: technology and applications. Wiley, West
Sussex, UK, 2012.
[45] Martin Kaltschmitt, Wolfgang Streicher, and Andreas Wiese.
Renew-
able energy: technology, economics and environment. Springer Science &
Business Media, 2007.
[46] E. W. Kimbark. Power System Stability. IEEE Press, 1995.
[47] D. P. Kothari and I. J. Nagrath. Modern power system analysis. Tata
McGraw-Hill Education, 2003.
[48] Paul C Krause, Oleg Wasynczuk, Scott D Sudhoﬀ, and Steven Pekarek.
Analysis of electric machinery and drive systems, volume 75. John Wiley
& Sons, 2013.
[49] Blackburn J. L.
Protective relaying: principles and applications.
M.
Dekker, 1987.
[50] De la Rosa F.C. Harmonics and power systems. Taylor & Francis, Boca
Raton, FL, 2006.
[51] E. Lorenzo and E.L. Pigueiras. Electricidad solar: ingenier´ıa de los sis-
temas fotovoltaicos.
Universidad Polit´ecnica de Madrid, Instituto de
Enereg´ıa Solar, Spain, 1994.
[52] Joachim Luther, Michael Nast, M. Norbert Fisch, Dirk Christoﬀers, Fritz
Pﬁsterer, Dieter Meissner, and Joachim Nitsch. Solar Technology. In Ull-
mann’s Encyclopedia of Industrial Chemistry. Wiley-VCH Verlag GmbH
& Co. KGaA, 2000.

Bibliography
419
[53] Weedy B. M., Cory B. J., N. Jenkins, Ekanayake J. B., and G. Strbac.
Electric power systems. John Wiley & Sons, 2012.
[54] Brian MacCleery. NI power electronics control design v training workshop
co-simulation — National Instruments. http://www.ni.com/white-pap
er/6369/en/, June 2014. (Accessed 05/19/2017).
[55] Patricia Ross McCubbin. EPA’s endangerment ﬁnding for greenhouse
cases and the potential duty to adopt national ambient air quality stan-
dards to address global climate change. S. Ill. ULJ, 33:437, 2008.
[56] Iulian Munteanu, Antoneta Iuliana Bratcu, N Cutululis, and E Ceanga.
Optimal control of wind energy systems: towards a global approach. IEEE
Control Systems Magazine, 2009.
[57] (U. S.) National Research Council and (U. S.) National Academy of En-
gineering.
Electricity from renewable resources: Status, prospects, and
impediments. National Academic Press, 1st edition, 2010.
[58] Vaughn C Nelson and Kenneth L Starcher. Introduction to renewable
energy. CRC Press, Boca Raton, FL, 2015.
[59] Oﬃce of Energy Eﬃciency & Renewable Energy. Power america. https:
//energy.gov/eere/amo/power-america. (Accessed 2017-10-03.)
[60] John Paschal. Practical guide to power factor correction and harmonics
and your electric bill. Ec and M Books, Overland Park, KS, 2001.
[61] G. L. Pollack and D. R. Stump.
Electromagnetism.
Addison-Wesley,
2002.
[62] Pedro Ponce, Arturo Molina, and Brian MacCleery. Integrated intelligent
control and fault system for wind generators. Intelligent Automation &
Soft Computing, 19(3):373–389, 2013.
[63] Pedro Ponce-Cruz and Fernando D Ram´ırez-Figueroa. Intelligent Control
Systems with LabVIEWTM. Springer Science & Business Media, 2009.
[64] Neumann R.
Symmetrical Component Analysis of Unsymmetrical
Polyphase Systems. Sir I. Pitman & Sons, 1939.
[65] Power Regen.
Solar photovoltaic power system handbook.
Technical
report, REGEN power, Western Australia, 2011.
[66] Andre Richter, Erwin van der Laan, Wolfgang Ketter, and Konstantina
Valogianni. Transitioning from the traditional to the smart grid: Lessons
learned from closed-loop supply chains. In 2012 International Conference
on Smart Grid Technology, Economics and Policies (SG-TEP). IEEE,
December 2012.

420
Bibliography
[67] Maurice George Say. Alternating current machines. Halsted Press, 1976.
[68] P. C. Sen. Principles of electric machines and power electronics. John
Wiley & Sons, New York, 2nd edition, 1996.
[69] Marcelo Godoy Simoes, Robin Roche, Elias Kyriakides, Sid Surya-
narayanan, Benjamin Blunier, Kerry D. McBee, Phuong H. Nguyen,
Paulo F. Ribeiro, and Abdellatif Miraoui. A comparison of smart grid
technologies and progresses in Europe and the U.S. IEEE transacitions
on industrial electronics, 48(4):1154 – 1162, 2012.
[70] Susan Solomon. Climate change 2007—the physical science basis: Work-
ing group I contribution to the fourth assessment report of the IPCC,
volume 4. Cambridge University Press, 2007.
[71] Siddharth Sridhar, Adam Hahn, and Manimaran Govindarasu.
Cy-
ber–physical system security for the electric power grid. In Proceedings
of the IEEE, volume 100. IEEE, 2012.
[72] R. Strzelecki and G. Benysek.
Power Electronics in Smart Electrical
Energy Networks, volume 1 of Power Systems.
Springer, London, 1st
edition, 2008.
[73] Aman Abdulla Tanvir, Adel Merabet, and Rachid Beguenane. Real-time
control of active and reactive power for doubly fed induction genera-
tor (DFIG)-based wind energy conversion system. Energies, 8(9):10389–
10408, 2015.
[74] S Tegen, E Lantz, M Hand, B Maples, A Smith, and P Schwabe. Cost of
wind energy review, National Renewable Energy Laboratory. Technical
report, Technical Report, 2011.
[75] DM Triezenberg.
Electric power systems.
Perdue University: West
Lafayette, IN, 1978.
[76] Juan Carlos Vega de Kuyper and Santiago Ram´ırez Morales. Fuentes de
energ´ıa, renovables y no renovables. Aplicaciones. 2014.
[77] Blume S. W. Electric power system basics: for the nonelectrical profes-
sional. Wiley-Interscience; IEEE Press, 2007.
[78] C. L. Wadhwa. Electrical power systems. New Age International, 2005.
[79] G.J. Wakileh.
Power systems harmonics: fundamentals, analysis, and
ﬁlter design. Springer, New York, 2001.
[80] Hayt W.H. Engineering circuit analysis. McGraw-Hill Higher Education,
Boston, 2006.
[81] David C White and Herbert H Woodson. Electromechanical energy con-
version. Wiley, 1959.

Index
A
AAAC, see All aluminum-alloy
conductor
AAC, see All-aluminum conductor
ABCD model (transmission line),
233–235
ACAR, see Aluminum conductor
alloy reinforced
AC power analysis, 12–22
apparent power and power
factor, 15–16
average power, 14
complex power, 16–17
eﬀective values or RMS values,
14–15
exercises, 19–22
instantaneous power, 12–14
power factor correction, 17–19
ACSR, see Aluminum-conductor
steel-reinforced cable
Advanced metering infrastructure
(AMI), 358
Advance persistent threats, 350
Airfoils, 155–158
All aluminum-alloy conductor
(AAAC), 211
All-aluminum conductor (AAC), 211
Aluminum conductor alloy reinforced
(ACAR), 211
Aluminum-conductor steel-reinforced
cable (ACSR), 57, 211
AMI, see Advanced metering
infrastructure
Ampere’s law, 214
Amplitude modulation (AM), 312
Angle of attack, 115
Animal products, 324
Apparent power, 15
Artiﬁcial neural networks (ANNs),
384
Asynchronous machine, 94–99
B
Back-to-back (B2B) converters, 165,
166
Batteries, 329
Blocking diode (solar energy), 196,
197
Boost DC-DC converter, 375
Brushless motor, 100–104
C
Cable lines, 58
Compressed air energy storage
(CAES), 328
Counterclockwise (CCW) angle
rotation, 60
Current transformers (CT), 59
Cybersecurity, 350–351
D
DC ﬂywheels, see Direct current
ﬂywheels
Denial-of-service attack, 350
DFIG, see Doubly-fed induction
generator
Digital signal processor (DSP), 361
Direct current (DC) ﬂywheels,
328–329
Displacement power factor (dPF), 39
Distortion power factor (hPF), 39
Diversion hydroelectric power plants,
124
Double line to ground fault, 277–278
421

422
Index
Doubly-fed induction generator
(DFIG), 164
dPF, se Displacement power factor
DSP, see Digital signal processor
E
Electric machinery basics,see Power
ﬂow and electric machinery
basics
Electric power transmission, 211–256
Ampere’s law, 214
capacitance of transmission
lines, 224–226
capacitor banks, 244
eﬀect of earth on capacitance of
conductors, 228–229
electric resistance, 213–214
exact ABCD model of
transmission line, 233–235
external ﬂux linkage, inductance
due to, 217
Gauss law, 225
geometric mean radius and
geometric mean distance,
221–223
homework problems, 252–255
inductance, 214–221
internal ﬂux linkage, inductance
due to, 215–216
monophasic system, inductance
of, 219
power ﬂow analysis, 239–247
simulation, 255–256
single-phase line, capacitance of,
226
theoretical problems, 247–252
three-phase double circuit lines,
inductance of, 223–224
three-phase line, capacitance of,
226–228
three-phase system, inductance
of, 219–221
total inductance, 217
transmission line mathematical
model, 233–238
transmission line parameters,
213–233
transmission tower, generic
structure of, 211–213
transposition, 220
Electromechanical energy conversion
and losses, 71–73
Electromotive force (EMF), 63, 101
Energy management system (EMS),
358
Exercises
AC power analysis, 19–22
contribution of solar energy,
351–354
contribution of wind plant,
354–357
electric power transmission,
230–233
frequency-domain analysis,
11–12
generator load test, 82–85
generator no-load test, 86–89
harmonics, 40–41
hydroelectricity, 131–135,
138–139
line-to-earth fault protection,
278–282
mathematical model of
back-to-back converter,
171–172
polyphase circuits, 33–37
power distribution system types,
264–266
power ﬂow analysis, 240–247
solar energy, 201–205
transmission line mathematical
model, 236–238
undervoltage and overvoltage
protection, 282–287
F
Factor binding, 101
FACTS, see Flexible AC
transmission systems
Faraday’s law, 63, 100

Index
423
Faults on power systems, 266–287
coupled circuits for
unsymmetrical faults,
274–278
double line to ground, 277–278
exercises, 278–287
line-to-earth fault protection,
278–282
line-to-line fault, 276–277
sequence networks of electric
machinery, 272–274
single line-to-ground fault,
275–276
symmetrical components,
269–271
undervoltage and overvoltage
protection, 282–287
Field programmable gate array
(FPGA), 361, 397,see also
LabVIEW,
LabVIEW-FPGA, and
Multisim (power electronics
in power systems using)
Fixed charge rate (FCR), 176
Fixed-speed wind turbines, 162–164
Flexible AC transmission systems
(FACTS), 290
Fractional-pitch winding, 75
Francis turbine, 131
Frequency-domain analysis (linear
electric circuits), 5–12
Euler’s identity, 6
experimental exercises, 11–12
impedances, 7–8
phasor diagrams, 8
phasor measurement unit, 8–11
phasors, 5–7
phasor transformation, 6
Frequency modulation (FM), 312
Frequency shift keying (FSK), 312
Full-pitch winding, 75
G
Gauss law, 225
GDP, see Gross domestic product
Generator load test, exercise, 82–85
Generator no-load test, exercise,
86–89
Generators, 55–56
Global Energy Network Institute
(GENI), 347
Global positioning system (GPS), 10
Global smart grid, 349
Global Wind Energy Council, 151
GPS, see Global positioning system
Gross domestic product (GDP), 330
H
Hall eﬀect sensors, 100
Harmonics, 37–41
Hierarchical block or sub-circuit
(HB/SC) terminals, 369
Homework problems
electric power transmission,
252–255
hydroelectricity, 142–145
linear electric circuits, 46–52
power distribution system,
unsymmetrical failures, and
power system protections,
317–319
power ﬂow and electric
machinery basics, 110–112
renewable energy, 335–337
smart grid, 357–359
solar energy, 206–209
wind energy, 177–180
Hot spot, 197
hPF, see Distortion power factor
Hydroelectricity, 123–147
exercises, 131–135, 138–139
homework problems, 142–145
impulse turbines, 130
instrumented operation, 134
integration with inﬁnite bus,
135–139
overall characteristics and
operation, 124–135
power ﬂow, 132

424
Index
power plants, classiﬁcation of,
124
simulation, 145
synchronous generator with
resistive loads, 134
theoretical problems, 139–142
turbine types, 129, 131
water load vs time availability
graph, 141
water runoﬀexample graph, 127
Hysteresis, magnetic ﬁeld and, 67
I
Impoundment hydroelectric power
plants, 124
Inductance, see Electric power
transmission
Insulated-gate bipolar transistors
(IGBTS), 401
K
Kaplan turbine, 131
Kinetic energy, 326
L
LabVIEW, LabVIEW-FPGA, and
Multisim (power electronics
in power systems using),
361–414
Boost DC-DC converter, 375
case study (half-bridge inverter
control), 397–406
case study (intelligent wind
turbine control with
LabVIEW), 378–392
case study (phase-lock loop),
406–413
co-simulation LabVIEW FPGA
and Multisim, 392–397
co-simulation LabVIEW and
Multisim, 365–377
design V process, 361, 364
digital signal processor, 361
generations of power electronics
and power losses, 362
hierarchical block or sub-circuit
terminals, 369
insulated-gate bipolar
transistors, 401
reconﬁgurable inputs and
outputs architecture, 361
time-adaptive synchronized
co-simulation, 392
Leakage ﬂux of winding, 90
Left-hand rule (Fleming), 65
Linear electric circuits, 1–53
AC power analysis, 12–22
apparent power and power
factor, 15–16
average power, 14
balanced ∆-∆connection, 29
balanced ∆-Y connection, 29–31
balanced three-phase voltages,
23–26
balanced Y-∆connection, 28
balanced Y-Y connection, 26–27
complex power, 16–17
eﬀective values or RMS values,
14–15
frequency-domain analysis, 5–12
harmonics, 37–41
homework problems, 46–52
impedances, 7–8
instantaneous power, 12–14
Ohm’s law, 1
passive elements in electric
circuits, 1–3
phasor measurement unit, 8–11
phasors, 5–7
polyphase circuits, 22–37
power factor correction, 17–19
power in three-phase systems,
32–33
simulation, 52–53
single-phase three-wire systems,
23
theoretical problems, 41–46
type of connection of passive
elements, 3–5

Index
425
unbalanced three-phase systems,
31–32
Line-to-earth fault protection,
278–282
Line-to-line fault, 276–277
Liquid fuels, 327
Locked rotor test, 80
M
Magnetically coupled circuits, 69–71
Magnetization B-H curve, 62
Magnetomotive force (MMF), 77
Malware, 350
Mathematical models (back-to-back
converter), 166–172
DC bus, 168
example back-to-back converter,
169
exercises, 171–172
left side of back-to-back
converter, 168
pulse with modulated signals,
169
right side of back-to-back
converter, 168
steady-state model, 168–169
Mathematical models (electric
machinery), 90–107
asynchronous machine, 94–99
brushless exercise, 105–107
brushless motor, 100–104
factor binding, 101
leakage ﬂux of winding, 90
power transformer, 90–94
self-inductance, 91
Thevenin equivalent, 93
Mathematical models (transmission
line), 233–238
characteristic impedance, 235
equivalent π circuit, 236
exact ABCD model of
transmission line, 233–235
propagation constant, 235
Maximum power point tracking
(MPPT) algorithms, 188
Mesh networks, 263–264
Micro-grids, 344, 346
MMF, see Magnetomotive force
MPPT algorithms, see Maximum
power point tracking
algorithms
Multisim, see LabVIEW,
LabVIEW-FPGA, and
Multisim (power electronics
in power systems using)
N
National Electrical Manufacturers
Association (NEMA), 97
O
Ohm’s law, 1
Organisation for Economic
Co-operation and
Development (OECD), 331
P
Passive element connections, 3–5
parallel combination, 4–5
series combination, 3–4
Pelton turbines, 130, 131
PF, see Power factor
Phase-locked loop (PLL), 190,
406–413
Phasor measurement unit (PMU),
8–11
Photo-voltaics, 186–193,see also
Solar energy
forbidden band, 188
grid-connected operation, 190
inorganic solar cells, 193
load controller, 189
mono-crystalline structure, 193
organic solar cells, 192, 193
phase-locked loop, 190
photo-current, 188
solar arrangements, 190–192
solar cell types, 192–193
solar energy sources, 183
stand-alone operation, 190

426
Index
Photo-voltaics, panel modeling,
194–200
blocking diode, 196, 197
hot spot, 197
maximum power, 198–200
modeling cells arrangements,
196–198
reverse bias saturation current,
196
standard test conditions, 195
PLC, see Power line carrier
PLL, see Phase-locked loop
PMU, see Phasor measurement unit
Polyphase circuits, 22–37
balanced ∆-∆connection, 29
balanced ∆-Y connection, 29–31
balanced three-phase voltages,
23–26
balanced Y-∆connection, 28
balanced Y-Y connection, 26–27
exercises, 33–37
negative phase sequence, 26
positive phase sequence, 25
power in three-phase systems,
32–33
single-phase three-wire systems,
23
unbalanced three-phase systems,
31–32
Potential energy, 326
Potential transformer (PT), 59
Power distribution system,
unsymmetrical failures, and
power system protections,
257–320
distance protection, 308–312
distribution systems, types of,
258–266
double line to ground, 277–278
electric protections, 287–312
faults on power systems,
266–287
faults and relays, types of,
290–292
ﬂexible AC transmission
systems, 290
homework problems, 317–319
line-to-earth fault protection,
278–282
line-to-line fault, 276–277
load unbalance protection,
305–308
mesh networks, 263–264
overcurrent protection, 295–297
overvoltage protection, 298–303
power line carrier, 312–313
protective relay, 289
radial networks, 258–262
relay operation, 292–295
ring networks, 263
simulation, 319–320
single line-to-ground fault,
275–276
theoretical problems, 313–317
time-overcurrent relays, 293
undervoltage and overvoltage
protection, 282–287
undervoltage protection,
303–305
unsymmetrical faults, coupled
circuits for, 274–278
voltage source converter, 290
Power factor (PF), 16
Power ﬂow and electric machinery
basics, 55–121
asynchronous machine, 94–99
brushless exercise, 105–107
brushless motor, 100–104
cable lines, 58
counterclockwise angle rotation,
60
electromechanical energy
conversion and losses, 71–73
factor binding, 101
fractional-pitch winding, 75
full-pitch winding, 75
generator load test, 82–85
generator no-load test, 86–89
generators, 55–56

Index
427
ground or shield wires, 58
homework problems, 110–112
hysteresis, 67
leakage ﬂux of winding, 90
left-hand rule (Fleming), 65
locked rotor test, 80
machine parameters, 73–89
magnetically coupled circuits,
69–71
magnetic ﬂux linkage, 115
magnetics perspective (modeling
basics), 61–69
magnetization B-H curve, 62
mathematical models of electric
machinery, 90–107
mechanical perspective
(modeling basics), 59–61
modeling basics, 59
moment of inertia, 60
power lines, 57–58
power transformer, 90–94
protective devices, 58–59
right-hand rule, 70
self-inductance, 91
sensing transformers, 59
simulation, 113–121
synchronous generator, 120–121
theoretical problems, 107–110
Thevenin equivalent, 93
transformers, 56–57
transformers programs, 113–120
Power line carrier (PLC), 312–313
PT, see Potential transformer
Pulse with modulated (PWM)
signals, 169
Pumped hydro storage, 124, 327–328
PWM signals, see Pulse with
modulated signals
R
Radial networks, 258–262
Reconﬁgurable inputs and outputs
(RIO) architecture, 361
Remote terminal unit (RTU), 346
Renewable energy, 321–339
advantages and disadvantages,
325–326
batteries, 329
capacitors, 336
compressed air, 328
economics, 332
energy sources and resources,
322–323
ﬂywheels, 328–329
homework problems, 335–337
kinetic energy, 326
liquid fuels, 327
potential energy, 326
pumped hydro, 327–328
Rokkasho-Futamata wind farm,
329–330
society, energy and, 330–331
solar energy, 324
solutions, 332–333
storage, 326–330
technical availability, 325
theoretical problems, 334
thermal storage, 326–327
tidal energy, 325
types of energy, 323
types of renewable energy,
324–325
use of energy, 331
utilization ratio, 325
Renewable portfolio standard (RPS),
151
Right-hand rule, 70
Ring networks, 263
RIO architecture, see Reconﬁgurable
inputs and outputs
architecture
RPS, see Renewable portfolio
standard
RTU, see Remote terminal unit
S
SCADA (supervisory control and
data acquisition) systems,
346
Self-inductance, 91

428
Index
Sensing transformers, 59
Simulation
electric power transmission,
255–256
hydroelectricity, 145
linear electric circuits, 52–53
power distribution system,
unsymmetrical failures, and
power system protections,
319–320
power ﬂow and electric
machinery basics, 113–121
smart grid, 359–360
solar energy, 209–210
wind energy, 180–181
Single line-to-ground fault, 275–276
Single side band (SSB), 312
Smart grid, 341–360
advanced metering
infrastructure, 358
attributes, 342–343
beneﬁts, 343–349
cyber-security, 350–351
deﬁnition, 341
economic factors, 343–344
energy management system, 358
environmental factors, 344
exercises, 351–357
global smart grid, 349
homework problems, 357–359
micro-grids, 344, 346
reliability factors, 344
SCADA systems, 346
security factors, 344
simulation, 359–360
supply chain, 342
Society, energy and, 330–331
Solar cell types, 192–193
inorganic solar cells, 193
mono-crystalline structure, 193
organic solar cells, 192, 193
Solar energy, 183–210
availability, 324
blocking diode, 196, 197
capture, 184–186
dispersion, 184
example (solar umbrella
monitoring with
LabVIEW), 200–201
exercises, 201–205
homework problems, 206–209
hot spot, 197
photo-voltaic panel modeling,
194–200
photo-voltaics, 186–193
photovoltaic solar energy
sources, 183
reﬂection, 184
reverse bias saturation current,
196
simulation, 209–210
solar arrangements, 190–192
solar cell types, 192–193
thermal solar energy sources,
183
SSB, see Single side band
Standard test conditions (STC), 195
STATCOM (Static Synchronous
Compensator), 290
Static synchronous condenser, 290
Synchronous generator, 120–121
Systems planning, see Power
distribution system,
unsymmetrical failures, and
power system protections
T
TASCS, see Time-adaptive
synchronized co-simulation
THD, see Total harmonic distortion
Theoretical problems
electric power transmission,
247–252
hydroelectricity, 139–142
linear electric circuits, 41–46
power distribution system,
unsymmetrical failures, and
power system protections,
313–317

Index
429
power ﬂow and electric
machinery basics, 107–110
renewable energy, 334
Thermal solar energy sources, 183
Thermal storage, 326–327
Tidal energy, 325
Time-adaptive synchronized
co-simulation (TASCS), 392
Time-overcurrent relays, 293
Total harmonic distortion (THD), 38
TPF, see True power factor
Transformers, 56–57
Transformers programs, 113–120
True power factor (TPF), 39
U
Unsymmetrical failures, see Faults on
power systems
Utilization ratio (renewable energy),
325
V
Variable-speed wind turbines,
164–165
Voltage source converter (VSC), 290
W
WECS, see Wind energy conversion
system
Wind energy, 149–181
aerodynamics of wind turbines,
155–158
airfoils, 155–158
angle of attack, 155
back-to-back converters,
165–166
basics, 151–154
Bernoulli equation, 154
constant-speed versus
variable-speed turbines,
158–159
conversion system (WECS), 166
DC bus, 168
economic factors, 172–177
energy conversion chain, 150
ﬁxed charge rate, 176
ﬁxed-speed wind turbines,
162–164
generation of lift, 156
homework problems, 177–180
mathematical model of
back-to-back converter,
166–172
power generation system,
161–166
renewable portfolio standard,
151
resource, 159–161
simulation, 180–181
variable-speed wind turbines,
164–165
Weibull distribution parameters,
160
wind power density, 161
wind turbine basic structure,
149–150
worldwide eolic energy
production, 151
Wind power density (WPD), 161
Wind turbine control with
LabVIEW, 378–392
artiﬁcial neural networks for
fault detection, 384–392
fault model of wind turbine
converter circuit, 382–384
wind turbine operation, 379–380
wind turbine per unit model,
380–382
Wound rotor induction generator
(WRIG), 163
WPD, see Wind power density
WRIG, see Wound rotor induction
generator
Y
Yokogawa Electric Corporation
systems, 330
Z
Zero-day attack, 350


