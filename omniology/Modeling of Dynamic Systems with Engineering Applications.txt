
Modeling of 
­Dynamic ­Systems with 
­Engineering Applications


Modeling of 
­Dynamic ­Systems with 
­Engineering Applications
Clarence W. de Silva

MATLAB® is a trademark of The MathWorks, Inc. and is used with permission. The MathWorks does not warrant the 
accuracy of the text or exercises in this book. This book’s use or discussion of MATLAB® software or related products 
does not constitute endorsement or sponsorship by The MathWorks of a particular pedagogical approach or particular 
use of the MATLAB® software.
CRC Press
Taylor & Francis Group
6000 Broken Sound Parkway NW, Suite 300
Boca Raton, FL 33487-2742
© 2018 by Taylor & Francis Group, LLC
CRC Press is an imprint of Taylor & Francis Group, an Informa business
No claim to original U.S. Government works
Printed on acid-free paper
International Standard Book Number-13: 978-1-4987-9848-8 (Hardback)
This book contains information obtained from authentic and highly regarded sources. Reasonable efforts have been 
made to publish reliable data and information, but the author and publisher cannot assume responsibility for the 
validity of all materials or the consequences of their use. The authors and publishers have attempted to trace the copy-
right holders of all material reproduced in this publication and apologize to copyright holders if permission to publish 
in this form has not been obtained. If any copyright material has not been acknowledged please write and let us know 
so we may rectify in any future reprint.
Except as permitted under U.S. Copyright Law, no part of this book may be reprinted, reproduced, transmitted, or 
utilized in any form by any electronic, mechanical, or other means, now known or hereafter invented, including pho-
tocopying, microfilming, and recording, or in any information storage or retrieval system, without written permission 
from the publishers.
For permission to photocopy or use material electronically from this work, please access www.copyright.com (http://
www.copyright.com/) or contact the Copyright Clearance Center, Inc. (CCC), 222 Rosewood Drive, Danvers, MA 
01923, 978-750-8400. CCC is a not-for-profit organization that provides licenses and registration for a variety of users. 
For organizations that have been granted a photocopy license by the CCC, a separate system of payment has been 
arranged.
Trademark Notice: Product or corporate names may be trademarks or registered trademarks, and are used only for 
identification and explanation without intent to infringe.
Visit the Taylor & Francis Web site at
http://www.taylorandfrancis.com
and the CRC Press Web site at
http://www.crcpress.com

To all my teachers, some of whom are unknown to me.
“In experimental philosophy, we are to look upon propositions inferred by general 
induction from phenomena as accurately or very nearly true, notwithstanding any 
contrary hypotheses that may be imagined, till such time as other phenomena occur 
by which they may either be made more accurate or liable to exceptions.”
Sir Isaac Newton


vii
Contents
Preface............................................................................................................................................ xiii
Acknowledgments......................................................................................................................xvii
Author............................................................................................................................................ xix
	 1.	 Introduction to Modeling......................................................................................................1
Chapter Highlights...................................................................................................................1
1.1	
Objectives........................................................................................................................1
1.2	
Importance and Applications of Modeling................................................................3
1.2.1	
Modeling in Control.........................................................................................4
1.2.2	
Modeling in Design..........................................................................................5
1.3	
Dynamic Systems and Models.....................................................................................7
1.3.1	
Terminology......................................................................................................7
1.3.2	
Model Complexity............................................................................................8
1.4	
Model Types.................................................................................................................. 11
1.4.1	
Advantages of Analytical Models................................................................12
1.4.2	
Mechatronic Systems......................................................................................13
1.4.3	
Steps of Analytical Model Development.....................................................15
1.4.4	
Modeling Criteria and Equivalent Models................................................. 16
1.5	
Organization of the Book............................................................................................17
Summary Sheet.......................................................................................................................20
Steps of Analytical Model Development.............................................................................21
Problems...................................................................................................................................21
	 2.	 Basic Model Elements...........................................................................................................25
Chapter Highlights.................................................................................................................25
2.1	
 Introduction..................................................................................................................25
2.1.1	
Lumped Elements and Analogies................................................................26
2.1.2	
Across-Variables and Through-Variables....................................................26
2.2	
Mechanical Elements...................................................................................................27
2.2.1	
Inertia Element................................................................................................27
2.2.2	
Spring (Stiffness or Flexibility) Element......................................................29
2.2.3	
Damping (Dissipation) Element...................................................................30
2.3	
Electrical Elements.......................................................................................................31
2.3.1	
Capacitor Element...........................................................................................31
2.3.2	
Inductor Element.............................................................................................33
2.3.3	
Resistor (Dissipation) Element......................................................................34
2.4	
Fluid Elements..............................................................................................................34
2.4.1	
Fluid Capacitor or Accumulator (A-Type Element)....................................35
2.4.2	
Fluid Inertor (T-Type Element)......................................................................35
2.4.3	
Fluid Resistor (D-Type Element)...................................................................35
2.4.4	
Derivation of Constitutive Equations..........................................................36
2.5	
Thermal Elements........................................................................................................44
2.5.1	
Thermal Capacitor..........................................................................................45
2.5.2	
Thermal Resistor.............................................................................................46

viii
Contents
Biot Number.................................................................................................................50
Linearized Radiation Resistor....................................................................................53
2.6	
Domain Analogies.......................................................................................................54
2.6.1	
Natural Oscillations.......................................................................................55
Summary Sheet.......................................................................................................................55
Problems...................................................................................................................................57
	 3.	 Analytical Modeling.............................................................................................................63
Chapter Highlights.................................................................................................................63
3.1	
Introduction..................................................................................................................63
3.2	
Types of Analytical Models........................................................................................64
3.2.1	
Properties of Linear Systems.........................................................................66
3.2.2	
Discrete-Time Systems...................................................................................66
3.2.3	
Lumped Model of a Distributed System.....................................................70
Heavy Spring...................................................................................................70
Kinetic Energy Equivalence..........................................................................72
Natural Frequency Equivalence...................................................................73
3.3	
Analytical Model Development................................................................................. 74
3.3.1	
Steps of Model Development........................................................................75
3.4	
State Models and Input–Output Models.................................................................. 76
3.4.1	
Properties of State-Space Models................................................................. 76
State Space.......................................................................................................77
Properties of State Models.............................................................................77
3.4.2	
Linear State Equations...................................................................................78
Time-Invariant Systems.................................................................................80
3.4.3	
Input–Output Models from State-Space Models........................................80
3.5	
Modeling Examples ....................................................................................................83
3.5.1	
Systematic Development of a State Model..................................................83
3.5.2	
Modeling in Mechanical Domain................................................................84
3.5.3	
Modeling in the Fluid Domain.....................................................................89
Commutativity of Series Resistor and Inertor Elements...........................90
3.5.4	
Modeling in the Thermal Domain.............................................................100
Summary Sheet..................................................................................................................... 106
Problems................................................................................................................................. 108
	 4.	 Model Linearization........................................................................................................... 121
Chapter Highlights............................................................................................................... 121
4.1	
Introduction................................................................................................................ 121
4.2	
Properties of Nonlinear Systems.............................................................................122
4.2.1	
Static Nonlinearity........................................................................................122
4.2.2	
Nonlinear Characteristics of Practical Devices........................................123
4.2.3	
Nonlinear Electrical Elements....................................................................126
Capacitor........................................................................................................126
Inductor���������������������������������������������������������������������������������������������������������126
Resistor����������������������������������������������������������������������������������������������������������127
4.3	
Analytical Linearization Using Local Slopes.........................................................127
4.3.1	
Analytical Linearization about an Operating Point................................128
Equilibrium State..........................................................................................128
4.3.2	
Nonlinear Functions of One Variable........................................................128

ix
Contents
4.3.3	
Nonlinear Functions of Two Variables......................................................130
4.4	
Nonlinear State-Space Models................................................................................. 131
4.4.1	
Linearization of State Models..................................................................... 132
4.4.2	
Mitigation of System Nonlinearities..........................................................133
4.5	
Linearization Using Experimental Data................................................................. 163
4.5.1	
Torque-Speed Curves of Motors................................................................. 163
4.5.2	
Experimental Linear Model for Motor Control........................................ 165
4.5.3	
Experimental Linear Model of a Nonlinear System................................ 166
4.6	
Other Methods of Model Linearization.................................................................. 171
4.6.1	
The Calibration Curve Method...................................................................172
4.6.2	
The Equivalent Model Approach of Linearization.................................. 173
4.6.3	
The Describing Function Method.............................................................. 176
4.6.4	
Feedback Linearization................................................................................ 178
Summary Sheet.....................................................................................................................180
Problems................................................................................................................................. 182
	 5.	 Linear Graphs.......................................................................................................................199
Chapter Highlights...............................................................................................................199
5.1	
Introduction................................................................................................................199
5.2	
Variables and Sign Conventions..............................................................................200
5.2.1	
Through-Variables and Across-Variables..................................................201
Sign Conventions..........................................................................................201
5.3	
Linear-Graph Elements.............................................................................................204
5.3.1	
Single-Port Elements....................................................................................204
5.3.2	
Source Elements............................................................................................205
Interaction Inhibition by Source Elements................................................206
5.3.3	
Two-Port Elements........................................................................................207
Transformer...................................................................................................207
Gyrator����������������������������������������������������������������������������������������������������������209
5.4	
Linear-Graph Equations............................................................................................ 211
5.4.1	
Compatibility (Loop) Equations................................................................. 212
Sign Conventions.......................................................................................... 212
Number of “Primary” Loops...................................................................... 213
5.4.2	
Continuity (Node) Equations...................................................................... 215
Primary Node Equations............................................................................. 215
5.4.3	
Series and Parallel Connections................................................................. 217
5.5	
State Models from Linear Graphs............................................................................ 218
5.5.1	
Sketching of a Linear Graph........................................................................ 219
5.5.2	
State Models from Linear Graphs.............................................................. 219
System Order.................................................................................................220
Sign Conventions..........................................................................................221
Steps of Obtaining a State Model...............................................................221
5.5.3	
Characteristics of Linear Graphs................................................................222
LG Variables and Relations.........................................................................222
Topological Result.........................................................................................223
5.6	
Linear-Graph Examples in Mechanical Domain...................................................224
5.7	
Linear-Graph Examples in Electrical Domain.......................................................233
5.7.1	
Amplifiers......................................................................................................235
Linear-Graph Representation......................................................................235

x
Contents
5.7.2	
Power-Information Transformer................................................................236
5.7.3	
dc Motor.........................................................................................................236
5.8	
Linear-Graph Examples in Fluid Domain..............................................................242
5.9	
Linear-Graph Examples in Thermal Domain........................................................249
5.9.1	
Model Equations...........................................................................................249
5.10	 Linear-Graph Examples in Mixed Domains..........................................................254
Summary Sheet.....................................................................................................................262
Problems.................................................................................................................................264
	 6.	 Frequency-Domain Models...............................................................................................285
Chapter Highlights...............................................................................................................285
6.1	
Introduction................................................................................................................285
6.1.1  Transfer-Function Models...............................................................................286
6.2	
Laplace and Fourier Transforms..............................................................................287
6.2.1	
Laplace Transform........................................................................................287
Laplace Transform of a Derivative.............................................................288
Laplace Transform of an Integral................................................................289
6.2.2	
Fourier Transform.........................................................................................290
6.3	
Transfer Function....................................................................................................... 291
6.3.1	
Transfer-Function Matrix............................................................................293
6.4	
Frequency-Domain Models......................................................................................298
6.4.1	
Frequency Transfer Function (Frequency Response Function).............298
Response to a Harmonic Input...................................................................298
Magnitude (Gain) and Phase......................................................................299
Observations..................................................................................................300
6.4.2	
Bode Diagram (Bode Plot) and Nyquist Diagram...................................300
6.4.3	
Bode Diagram Using Asymptotes..............................................................304
6.5	
Mechanical Impedance and Mobility.....................................................................308
6.5.1	
Transfer Functions in Mechanical Systems..............................................308
Mechanical Transfer Functions................................................................... 310
Mechanical Impedance and Mobility........................................................ 311
6.5.2	
Interconnection Laws................................................................................... 311
Interconnection Laws for Mechanical Impedance and Mobility........... 312
Interconnection Laws for Electrical Impedance and Admittance.......... 312
A-Type Transfer Functions and T-Type Transfer Functions................... 312
6.5.3	
Transfer Functions of Basic Elements........................................................ 313
6.6	
Transmissibility Function......................................................................................... 319
6.6.1	
Force Transmissibility.................................................................................. 319
6.6.2	
Motion Transmissibility............................................................................... 319
6.6.3	
Vibration Isolation........................................................................................326
Force Isolation and Motion Isolation.........................................................326
6.6.4	
Maxwell’s Reciprocity Property.................................................................332
Maxwell’s Reciprocity Property in Other Domains.................................334
Summary Sheet.....................................................................................................................334
Problems.................................................................................................................................337
	 7.	 Transfer-Function Linear Graphs.....................................................................................345
Chapter Highlights...............................................................................................................345
7.1	
Introduction................................................................................................................345

xi
Contents
7.2	
Circuit Reduction and Equivalent Circuits............................................................347
7.2.1	
Thevenin’s Theorem for Electrical Circuits...............................................347
Circuit Partitioning.......................................................................................348
Thevenin and Norton Equivalent Circuits................................................348
7.2.2	
Justification of Circuit Equivalence............................................................352
7.2.3	
Extension into Other Domains...................................................................353
7.3	
Equivalent TF LGs.....................................................................................................353
7.3.1	
Transfer-Function LGs.................................................................................353
7.3.2	
Equivalent Mechanical Circuit Analysis Using LGs...............................356
7.3.3	
Summary of Thevenin Approach for Mechanical Circuits....................364
General Steps.................................................................................................364
7.4	
Multidomain TF LGs.................................................................................................365
7.4.1	
Conversion into an Equivalent Single Domain........................................365
Transformer-Coupled Systems...................................................................366
Gyrator-Coupled Systems...........................................................................367
7.4.2	
Illustrative Examples....................................................................................368
Summary Sheet.....................................................................................................................380
Problems.................................................................................................................................381
	 8.	 Simulation Block Diagrams..............................................................................................393
Chapter Highlights...............................................................................................................393
8.1	
Introduction................................................................................................................393
8.2	
Block Diagrams and State-Space Models...............................................................394
8.2.1	
Transfer Functions and Block Diagrams...................................................394
8.2.2	
State-Space Models and Block Diagrams..................................................395
8.3	
Block-Diagram Manipulation...................................................................................397
8.3.1	
Block-Diagram Manipulation and Reduction..........................................397
8.4	
Simulation Block Diagrams......................................................................................399
8.4.1	
Principle of Superposition...........................................................................399
8.4.2	
Superposition Method.................................................................................401
8.4.3	
Grouping Like-Derivatives Method...........................................................404
8.4.4	
Factored Transfer-Function Method..........................................................406
8.4.5	
Partial-Fraction Method............................................................................... 410
8.5	
Causality and Physical Realizability.......................................................................420
8.5.1	
Proof of Causality and Physical Realizability..........................................420
Summary Sheet.....................................................................................................................420
Problems.................................................................................................................................422
	 9.	 Response Analysis and Simulation.................................................................................427
Chapter Highlights...............................................................................................................427
9.1	
Introduction................................................................................................................427
9.2	
Analytical Solution....................................................................................................428
9.2.1	
Homogeneous Solution................................................................................428
Repeated Poles..............................................................................................429
9.2.2	
Particular Solution........................................................................................429
9.2.3	
Impulse Response Function........................................................................431
Convolution Integral....................................................................................431
9.2.4	
Stability...........................................................................................................433
9.3	
 First- and Second-Order Systems...........................................................................434

xii
Contents
9.3.1	
First-Order Systems......................................................................................434
9.3.2	
Second-Order Systems.................................................................................436
Free Response of an Undamped Oscillator...............................................436
Free Response of a Damped Oscillator......................................................438
9.4	
Forced Response of a Damped Oscillator..............................................................443
9.4.1	
Impulse Response.........................................................................................444
9.4.2	
The Riddle of Zero ICs.................................................................................445
9.4.3	
Step Response................................................................................................446
9.4.4	
Response to Harmonic Excitation..............................................................447
9.5	
Response Using Laplace Transform........................................................................454
9.5.1	
Step Response Using Laplace Transforms................................................454
9.5.2	
Incorporation of ICs......................................................................................455
Step Response of a First-Order System......................................................455
Step Response of a Second-Order System.................................................455
9.6	
Determination of ICs for Step Response................................................................457
9.7	
Computer Simulation................................................................................................465
9.7.1	
Use of Simulink in Computer Simulation.................................................466
Starting Simulink..........................................................................................466
Basic Elements...............................................................................................466
Building an Application...............................................................................467
Running a Simulation..................................................................................468
Summary Sheet.....................................................................................................................471
Problems................................................................................................................................. 474
Appendix A: Practical Elements and Components..............................................................485
Appendix B: Bond Graphs........................................................................................................539
Appendix C: Graph Tree Concepts for Linear Graphs........................................................555
Appendix D: Transform Techniques......................................................................................571
Appendix E: Software Tools.....................................................................................................589
Appendix F: Review of Linear Algebra.................................................................................. 613
Appendix G: Advanced Response Analysis.........................................................................633
Index..............................................................................................................................................657

xiii
Preface
This book concerns modeling of engineering dynamic systems. It systematically cov-
ers methodologies of understanding and analytical representation of the dynamics of a 
physical engineering system, using proper principles of science. However, the presented 
concepts and approaches are applicable in nonengineering processes such as biological, 
economic, and social systems as well.
The book has all the features of a course textbook and is primarily intended for a course 
at the undergraduate level (typically, third or fourth year) or at the early graduate level. 
In many engineering curricula, a course in modeling is a prerequisite for the first course 
in control systems. In some other curricula, modeling is taught as a foundation course or 
as the first part of a control systems course. Also, it is an indispensable component of a 
curriculum in mechatronics. Since the book contains a wealth of practical information on 
the subject, it is a valuable reference tool as well, primarily for researchers and practicing 
professionals. Even though the primary emphasis of the book is on the engineering prob-
lem of model development rather than response analysis and simulation once a model is 
available, these latter aspects are also covered in the book. The book distinguishes itself 
from the existing books on modeling in view of the following primary features:
•	 It provides systematic approaches that lead to unique models (thereby removing 
doubt on what method should be used in a given problem and the validity of the 
end result of modeling).
•	 It presents modeling approaches that are applicable to problems in many physical 
domains (e.g., electrical, mechanical, fluid, and thermal) and to problems of mul-
tiple domains (mixed systems).
•	 The presented “unified” and “integrated” approaches are rapidly becoming the 
standard in the modeling of mechatronic engineering systems, and of any engi-
neering system, for that matter.
•	 Modeling approaches that are commonly and effectively used in electrical engi-
neering are extended to other domains, particularly mechanical, fluid, and ther-
mal domains, so that those methods can also be applied to multidomain (e.g., 
mechatronic or electromechanical or mixed) systems.
•	 Equivalence or approximate equivalence (to the actual physical system or to 
another type of model) is considered as the primary basis in developing “equiva-
lent models” and in “model reduction” using various criteria of equivalence.
Background
In the late 1970s, I taught a mandatory undergraduate course in dynamic system model-
ing at Carnegie Mellon University. The popular textbook Introduction to System Dynamics 
by Shearer, Murphy, and Richardson (Addison-Wesley, 1971) was used in this course. 
This excellent classic has not been revised to date (The late Professor Arthur Murphy had 

xiv
Preface
contacted me to undertake the revision, but that project did not materialize due to my 
other commitments and the untimely death of Professor Murphy). After I moved to the 
University of British Columbia (UBC) in the late 1980s, I continued to teach the course. 
During this process, I had developed a vast amount of material (including new approaches, 
extensions to existing approaches, new examples, problems, and projects). Subsequently, at 
UBC, there was a demand for an introductory graduate-level course as well in the subject, 
which materialized about 15 years ago.
At UBC, for teaching the course on modeling in the beginning, I used my own notes and 
a booklet on Control System Modeling, which I had prepared for the company Measurements 
& Data Corporation (Pittsburgh, PA) and serialized in their magazine (Measurements and 
Control) as a professional course. Subsequently, by incorporating as well the material that 
I had developed while teaching undergraduate and graduate courses in control systems, 
I published the book Modeling and Control of Engineering Systems, (Taylor & Francis/CRC 
Press, 2009). Yet, I constantly felt the need for a single textbook on the subject of modeling 
of dynamic engineering systems that carries the features I have listed above. The present 
book satisfies that need.
Scope of the Book
Through this book, the student will learn to understand and model mechanical, thermal, 
fluid, electrical, and multidomain (mixed) systems in a systematic, unified, and integrated 
manner. For example, in the book I explore the identification of lumped elements such as 
generalized sources (input elements), generalized capacitors (across-type energy storage 
elements), generalized inductors (through-type energy storage elements), and generalized 
resistors (energy dissipation elements) in different types of physical systems. I study anal-
ogies among the four main types of systems: mechanical, thermal, fluid, and electrical, 
in terms of these basic lumped elements and in terms of the system variables. I introduce 
and apply concepts of through- and across-variables and flow and effort variables. I study 
multidomain (or mixed) systems, which consist of two or more of the basic system types 
(or physical domains), as well.
I discuss tools of modeling and model representation such as linear graphs, bond graphs, 
and block diagrams. A focus is to develop a unique state–space model for a given system 
(Note: Generally, the state–space representation is not unique; many different state–space 
models may be presented for the same system). I examine important considerations of 
input, output, causality, and system order.
The linear graph model representation is extended to the frequency domain. I study 
Thevenin and Norton equivalent circuits and their application in nonelectrical (mechani-
cal, fluid, and thermal) systems using linear graphs. I study the conversion of a mixed-
domain system model into an equivalent model in a single domain and illustrate its 
application in practical systems using examples.
Even though the emphasis of the book is on lumped-parameter models, I address the 
treatment of distributed-parameter systems and their representation in the lumped-
parameter form. I give an overview of the response analysis of dynamic systems. I address 
computer simulation of dynamic systems using graphical and numerical methodologies 
and algorithms and also through the use of such software tools as Simulink®. The main 
treatment of the book is of linear systems. However, where needed, I develop nonlinear 
models. I present their linearization using several general techniques (analytical, experi-
mental, and graphical).

xv
Preface
Main Features
In the present context, modeling concerns understanding and analytical representation 
of the dynamics of a physical engineering system, using sound principles of science and 
systematic and unified/generalized approaches. The developed model must be suitable 
for meeting the subsequent purposes and tasks. For example, identification and selec-
tion of system components, system analysis and computer simulation, conceptual design, 
detailed design, prototyping, instrumentation, control, tuning (adjusting system param-
eters to obtain the required performance), testing, performance evaluation, and product 
qualification all are important tasks in engineering practice, and modeling plays a crucial 
role in all these tasks.
The main objective of the book is to provide a convenient, useful, and affordable text-
book in the subject of Modeling of Dynamic Systems with Engineering Applications. The mate-
rial presented in the book serves as a firm foundation for the subsequent building up of 
expertise in various aspects of engineering such as design, prototyping, control, instru-
mentation, experimentation, and performance analysis.
The book consists of nine chapters and seven appendices. To maintain clarity and focus 
and to maximize the usefulness, the book presents its material in a manner that will be 
useful to anyone with a basic engineering background, be it civil, electrical, mechanical, 
manufacturing, material, mechatronic, mining, aerospace, or biomechanical. Complete 
solutions to the end-of-chapter problems are provided in a Solutions Manual, which is avail-
able to instructors who adopt the book.
In addition to presenting standard material on the modeling of dynamic engineering 
systems in a student-friendly and interest-arousing manner, the book somewhat deviates 
from other books on the subject in the following ways:
•	 The book presents systematic approaches of modeling that lead to unique models 
(thereby removing the doubts on what method should be used in a given problem 
and the validity of the end result of modeling).
•	 The book provides modeling approaches that are equally applicable to problems 
in many domains (electrical, mechanical, fluid, and thermal) and to problems of 
multiple domains (mixed systems). Since similar (analogous) approaches are used 
for modeling different domains, the presented methodologies are “unified.” Also, 
in a multidomain system, since all physical domains can be modeled concur-
rently (simultaneously), while taking into account any dynamic coupling (inter-
actions) among the domains, the presented methodologies are “concurrent” (or 
“integrated”).
•	 Popular modeling approaches that are commonly and effectively used in electri-
cal engineering are extended to other domains, particularly mechanical, fluid, and 
thermal domains, so that they can also be applied to multidomain (e.g., mecha-
tronic or electromechanical) systems. Hence, the presented methods are “unified.”
•	 I present both bond graph and linear graph approaches of model development. 
The latter approach is used more extensively.
•	 I present physical principles and analytical methods using simple mathematics.
•	 I provide a large number of worked examples, analytical examples, numerical 
examples, simulations, case studies, and end-of-chapter problems (with solutions) 

xvi
Preface
throughout the book, and relate them to real-life situations and practical engineer-
ing applications.
•	 I summarize the key issues presented in the book in point form at various places 
in each chapter, for easy reference, recollection, and presentation in PowerPoint 
form.
•	 I indicate the topics covered in each chapter at the beginning of the chapter. I pro-
vide the key material, formulas, and results in each chapter in a Summary Sheet 
at the end of the chapter.
•	 I give the useful material that cannot be conveniently integrated into the chapters 
in a concise form as separate appendices at the end of the book.
•	 The book uses and illustrates popular software tools such as Simulink throughout.
•	 The book is concise, avoiding unnecessarily lengthy and uninteresting discus-
sions, for easy reference and comprehension.
•	 There is adequate material in the book for two 12-week courses, one at the under-
graduate level and the other at the graduate level.
•	 In view of the practical considerations and techniques, tools, design issues, and 
engineering information presented throughout the book, and in view of the sim-
plified and snapshot style presentation, including more advanced theory and 
techniques, the book serves as a useful reference tool for engineers, technicians, 
project managers, and other practicing professionals in industry and research 
institutions.
Clarence W. de Silva
 Vancouver, Canada
MATLAB® is a registered trademark of The MathWorks, Inc. For product information, 
please contact: 
The MathWorks, Inc.
3 Apple Hill Drive
Natick, MA, 01760-2098 USA
Tel: 508-647-7000
Fax: 508-647-7001
E-mail: info@mathworks.com
Web: www.mathworks.com

xvii
Acknowledgments
Many individuals have assisted in the preparation of this book, but it is not practical to 
acknowledge all such assistance here. First, I wish to recognize the contributions, both direct 
and direct, of my graduate students, research associates, and technical staff. Particular 
mention should be made of Peter Jiahong Chen, my research associate, who assisted with 
some of the graphics in the book. I am particularly grateful to Jonathan W. Plant, exec-
utive editor, CRC Press/Taylor & Francis Group, for his great enthusiasm and support 
throughout the project. This project would not have been possible if not for his constant 
encouragement, advice, and drive. Richard Tressider of CRC Press and Mathi Ganesan of 
codeMantra should be acknowledged here for their contribution in the ­production of the 
book. Finally, I wish to acknowledge here the unwavering love and ­support of my wife 
and children.


xix
Author
Dr. Clarence W. de Silva, P.E., Fellow ASME and Fellow IEEE, is a professor of mechanical 
engineering at the University of British Columbia, Vancouver, Canada. He has occupied 
the following chair professorships:
•	 Senior Canada Research Chair professorship in mechatronics and industrial 
automation
•	 NSERC-BC Packers Research Chair in industrial automation
•	 Mobil Endowed Chair Professorship
He has served as a faculty member at Carnegie Mellon University (1978–87) and as a 
Fulbright Visiting Professor at the University of Cambridge (1987/88).
He has earned PhD degrees from Massachusetts Institute of Technology (1978) and the 
University of Cambridge, England (1998), and an honorary D.Eng. degree from University 
of Waterloo (2008); Honorary Professorship of Xiamen University, China; and Honorary 
Chair Professorship of National Taiwan University of Science and Technology.
Other Fellowships: Fellow, Royal Society of Canada; Fellow, Canadian Academy of 
Engineering; Lilly Fellow at Carnegie Mellon University; NASA-ASEE Fellow; Senior 
Fulbright Fellow at Cambridge University; Fellow of the Advanced Systems Institute of 
BC; Killam Fellow; Erskine Fellow at University of Canterbury; Professorial Fellow at 
University of Melbourne; and Peter Wall Scholar at the University of British Columbia.
Awards: Paynter Outstanding Investigator Award and Takahashi Education Award, 
ASME Dynamic Systems & Control Division; Killam Research Prize; Outstanding 
Engineering Educator Award, IEEE Canada; Lifetime Achievement Award, World 
Automation Congress; IEEE Third Millennium Medal; Meritorious Achievement Award, 
Association of Professional Engineers of BC; and Outstanding Contribution Award, IEEE 
Systems, Man, and Cybernetics Society. Also, he has made 40 keynote addresses at inter-
national conferences.
Editorial Duties: Served on 14 journals including IEEE Trans. Control System Technology 
and Journal of Dynamic Systems, Measurement & Control, Trans. ASME; editor-in-chief, 
International Journal of Control and Intelligent Systems; editor-in-chief, International Journal 
of Knowledge-Based Intelligent Engineering Systems; senior technical editor, Measurements 
and Control; and regional editor, North America, Engineering Applications of Artificial 
Intelligence—IFAC International Journal.
Publications: 24 technical books, 19 edited books, 51 book chapters, 245 journal articles, 
and over 270 conference papers.
Recent Books: Sensor Systems (Taylor & Francis/CRC, 2017); Sensors and Actuators: 
Engineering System Instrumentation (2nd Edition, Taylor & Francis/CRC, 2016); Mechanics of 
Materials (Taylor & Francis/CRC, 2014), Mechatronics: A Foundation Course (Taylor & Francis/
CRC, 2010); Modeling and Control of Engineering Systems (Taylor & Francis/CRC, 2009); 
Vibration: Fundamentals and Practice, 2nd Ed. (Taylor & Francis/CRC, 2007); Mechatronics; An 
Integrated Approach (Taylor & Francis/CRC, 2005); and Soft Computing and Intelligent Systems 
Design: Theory, Tools, and Applications (Addison Wesley, 2004).


1
1
Introduction to Modeling
1.1  Objectives
This book concerns modeling of engineering dynamic systems. In this context first we 
need to explore what a dynamic system is; what is meant by modeling; and how to model a 
dynamic system. We will address all three topics in detail throughout the book. In brief, a 
dynamic system is a system where the “rates of changes” of its response (output) cannot be 
neglected. A model is a “representation” of a system. There are many types of engineering 
dynamic systems and many types of models, as we will learn. The book primarily con-
cerns analytical modeling. We will learn a systematic way to develop an analytical model 
for an engineering dynamic system.
The main learning objectives of the book are the following:
•	 Understand the formal meanings of a dynamic system, control system, mecha-
tronic system, and multidomain (mixed) system.
•	 Recognize different types of models (e.g., physical, analytical, computer, experi-
mental) and their importance, usage, comparative advantages and disadvantages.
Chapter Highlights
•	 Objectives of the Chapter
•	 Importance and Applications of Modeling
•	 Modeling in Control
•	 Modeling in Design
•	 Dynamic Systems and Models
•	 Model Complexity
•	 Model Types
•	 Analytical Models
•	 Mechatronic Systems
•	 Steps of Analytical Model Development

2
Modeling of Dynamic Systems with Engineering Applications
•	 Learn the concepts of input (excitation), output (response), causality (cause-effect, 
what are inputs and what are outputs), and order (dynamic size) in the context of 
a dynamic system (or dynamic model).
•	 Understand the concepts of through-variables, across-variables, flow variables, 
and effort variables, and their relationship to state variables.
•	 Recognize similarities and analogies among the four system domains: mechani-
cal, electrical, fluid, and thermal.
•	 Understand the “mechatronic” approach (i.e., the “integrated” or “concurrent” 
approach) to modeling a multidomain (i.e., mixed) system, which consists of two 
or more basic system domains: all domains are modeled simultaneously.
•	 Understand the “unified” approach to modeling a multidomain system: similar 
(i.e., analogous) methods are used to model the different domains
•	 Understand the key steps of development of a unified, integrated, and systematic 
approach for modeling an engineering dynamic system.
•	 Apply in a systematic manner, the unified and integrated approach of modeling to 
develop a state-space model.
•	 Obtain a linear model of a nonlinear dynamic system, both analytically and 
experimentally
•	 Apply the concepts of block diagram in modeling a dynamic system.
•	 Understand and apply a graphical approach (linear graph or bond graph) for mod-
eling; in particular, to develop a state-space model.
•	 Understand the frequency-domain concepts of modeling; particularly, the concepts 
of “generalized” impedance, equivalent circuits, and circuit reduction of electrical 
systems and apply them to mechanical, fluid, thermal, and mixed systems.
•	 Study the response analysis of a linear dynamic model.
•	 Understand the analytical and computational basis of computer simulation of a 
dynamic system
•	 Apply a common tool of computer simulation to an engineering dynamic system.
Design, development, modification, operation, control, and performance monitoring/
evaluation of an engineering system require a sufficient understanding of the system 
and a suitable “representation” of the system. In other words, a “model” of the system 
is required for these practical activities. Any model is an idealization of the actual sys-
tem. Properties established and results derived in various “model-based approaches” 
are associated with the model rather than the actual system, whereas the excitations 
(inputs) are applied to and the responses (outputs) are observed or measured from the 
actual system. This distinction is very important particularly in the context of the pres-
ent treatment.
An engineering system may consist of several different physical types of components, 
belonging to such physical “domains” as mechanical, electrical, fluid, and thermal. It is 
termed a multidomain (or mixed) system. Furthermore, it may contain multifunctional compo-
nents; for example, a piezoelectric component, which can function as both a sensor and an 
actuator, is a multifunctional device. It is useful to use analogous procedures for modeling 
multidomain and multifunctional components. Then the domain models or functional models 
can be can be developed in a “unified” and “concurrent” manner, and systematically “inte-
grated” to obtain the overall model.

3
Introduction to Modeling
Analytical models may be developed for mechanical, electrical, fluid, and thermal sys-
tems in a rather analogous manner, because some clear analogies are present among these 
four types of systems. This is a focus of the book. In view of the existing analogy, then, a 
unified (analogous), integrated (concurrent), and systematic (having clear steps) approach 
may be adopted in the modeling, analysis, design, control, and evaluation of an engineer-
ing system. The integrated approach is indeed the “mechatronic” approach to model-
ing. The unified approach goes beyond that and exploits domain similarities (analogies). 
In summary then, the studies and developments of the present book target a modeling 
approach that has the following characteristics:
•	 Realization of a “unique” model (the modeling procedure leads to a single model)
•	 Physically meaningful (e.g., the system variables, particularly the state variables, 
have physical meaning)
•	 Systematic (follows a clearly indicated sequence of modeling steps)
•	 Integrated (concurrent; considers all physical domains of the system simultane-
ously, while including “coupling” or “dynamic interactions” that exist among 
them)
•	 Unified (exploits analogies or similarities among different physical domains and 
uses similar/analogous procedures to model the dynamics in those domains)
1.2  Importance and Applications of Modeling
A dynamic model may be indispensable in a variety of engineering applications. The 
types of uses of a dynamic model include the following:
•	 Analysis of a dynamic system (particularly using mathematical methods and 
tools, even when the actual system is not available or developed yet)
•	 Computer simulation, which can incorporate various types of models including 
mathematical (analytical) dynamic models
•	 Design of a dynamic system (prior to building the system; it may assist making the 
decision to build or not)
•	 Modification of a dynamic system (or its model or design, prior to the actual task 
of physical modification of the system)
•	 Instrumentation of a dynamic system. Instruments (such as sensors, actuators, 
signal conditioning, and component interconnecting hardware) needed for the 
operation and/or performance improvement of a dynamic system may be estab-
lished, selected/sized, and analyzed through modeling and simulation
•	 Control or assistance in the physical operation of a dynamic system (e.g., for model-
based control and for generating control/performance specifications)
•	 Testing of a dynamic system (where a test regiment is simulated and evalu-
ated through analytical and computational means), and in product qualification 
(where, an available good-quality product is further tested and evaluated to deter-
mine whether it is suitable for a specialized application (e.g., seismic qualification 
of components of a nuclear power plant; qualification of computer hardware)

4
Modeling of Dynamic Systems with Engineering Applications
•	 Performance evaluation (including on-line monitoring) of a system to detect 
deviations and diagnose malfunctions and faults (using a model as the refer-
ence for good performance).
Dynamic modeling is applicable in all branches of engineering (aerospace, biomechani-
cal, chemical, civil, electrical and computer, manufacturing, material, mechanical, mecha-
tronic, mining, etc.). Analytical models are quite useful in predicting the dynamic behavior 
(response) of a system for various types of excitations (inputs). For example, vibration is a 
dynamic phenomenon and its analysis, practical utilization, and effective control require 
a good understanding (model) of the vibrating system. Computer-based studies (e.g., com-
puter simulation) may be carried out using analytical models while incorporating suit-
able values for the system parameters (mass, stiffness, damping, capacitance, inductance, 
resistance, and so on). A model may be employed for designing an engineering system for 
proper performance. Therefore, the system is first developed (designed) using a model, 
which is much easier (quick, flexible, inexpensive) to modify than a physical system. In the 
context of product testing, for example, analytical models are commonly used to develop 
test specifications and the input signals that are applied to the exciter in the test procedure. 
Dynamic effects and interactions in the test object, the excitation system, and their inter-
faces may be studied in this manner. Product qualification is the procedure that is used to 
establish the capability of a good-quality product to withstand a specified set of operating 
conditions, in a specialized application. In product qualification by testing, the operating 
conditions are generated and applied to the test object by an exciter (e.g., shaker). In prod-
uct qualification by analysis, a suitable analytical model of the product replaces the physi-
cal test specimen that is used in product qualification by testing. In the area of automatic 
control, models are used in a variety of ways, as discussed next.
1.2.1  Modeling in Control
The ways models are used in automatic control include the following:
•	 An analytical model of the control system is needed for representation, mathemat-
ical analysis and computer simulation of the system
•	 A model of the system to be controlled (i.e., plant, process) may be used to develop 
the performance specifications, based on which a controller is developed for the 
system. For example, in model-referenced adaptive control, a “reference model” dic-
tates the desired behavior that is expected under control (see Figure 1.1). This is 
an implicit way of using a model to represent performance specifications. Then 
the controller seeks (by changing—adapting the controller parameters) to drive 
the actual behavior of the plant toward the desired behavior as dictated by the 
reference model
•	 In model-based control, a dynamic model of the actual process is employed to 
develop the necessary control schemes
•	 In the early stages of design of a control system, some (or all) parts of the desired 
system may not exist. In this context, a model of the anticipated system, particu-
larly an analytical model or a computer model, can be very useful, economical, 
and time efficient in the design of the control system. In view of the complexity of 
a design process, particularly when striving for an optimal design, it is useful to 
incorporate system modeling as a tool for design iteration.

5
Introduction to Modeling
In general, modeling is an “optimistic” approach where we attempt to accurately repre-
sent the system by a model, possibly optimize the model, and then use it to design, imple-
ment (or modify), and evaluate the system expecting (optimistically) that the implemented 
system will operate faithfully as represented by the model. On the other hand, control is 
a “pessimistic” approach where we suspect that the system will not behave according to 
the requirements (possibly as specified by a model) and then use sensing/monitoring and 
feedback control to make sure that the system performance meets the expectations.
1.2.2  Modeling in Design
Modeling and design can go hand-in-hand, in an iterative manner. Of course, in the begin-
ning of a design process, the desired system does not exist. Then, a model of the antici-
pated system can be very useful. In view of the complexity of a design process, particularly 
when striving for an optimal design, it is useful to incorporate system modeling as a tool 
for design iteration particularly because prototyping can become very costly and time-
consuming. Initially, by knowing some information about the system (e.g., intended func-
tions, performance specifications, past experience and knowledge of related or similar 
systems) and using the design objectives, it is possible to develop a model of sufficient 
(low to moderate) detail and complexity. Through mathematical analysis and by carrying 
out computer simulations of the model it will be possible to generate useful information 
that will guide the design process (e.g., generation of a preliminary design). In this man-
ner, iteratively, design decisions can be made and the model can be refined using the avail-
able (improved) design. This iterative link between modeling and design is schematically 
shown in Figure 1.2.
It is expected that an integrated (i.e., mechatronic) and unified (i.e., use of analogous 
methodologies for different physical domains) approach for modeling and design will 
result in higher quality of products and services, improved performance, and increased 
reliability, while approaching some form of optimality. This will enable the development 
and production of multidomain or mixed (e.g., electromechanical) systems efficiently, rap-
idly, and economically. When performing an integrated design of a multidomain system, 
System
inputs
Feedback
controller
Parameter
adjustment
Error
signal e
System
outputs
–
Drive
controller
Plant
(process)
Reference
model
FIGURE 1.1
The scheme of model-referenced adaptive control.

6
Modeling of Dynamic Systems with Engineering Applications
the concepts of energy/power present a unifying thread. The reasons are clear. First, in 
a multidomain system, ports of power/energy transfer exist, which link the dynamics of 
various domains (mechanical, electrical, fluid, and thermal). Hence, modeling, analysis, 
and optimization of a multidomain system can be carried out using a hybrid-system for-
mulation (a model) that integrates various aspects of different domains of the system in 
a unified manner. Second, an optimal design may aim for minimal energy dissipation 
and maximum energy efficiency. There are related implications; for example, greater dis-
sipation of energy will mean reduced overall efficiency and increased thermal problems, 
noise, vibration, malfunctions, wear and tear, and increased environmental impact. Again, 
a hybrid model that presents an accurate picture of the energy/power flow within the 
system will present an appropriate framework for the multidomain design. We can use 
linear graph models in particular, as discussed in Chapter 5, for this purpose, in an effec-
tive manner.
A design may use excessive safety factors and worst-case specifications (e.g., for mechan-
ical loads and electrical loads). This will not provide an optimal design and may not lead 
to the most efficient performance. Designing for optimal performance may not necessar-
ily lead to the most economical (least costly) design, however. When arriving at a truly 
optimal design, an objective function that takes into account all important factors (perfor-
mance, quality, cost, speed, ease of operation, safety, environmental impact, etc.) has to be 
optimized. A complete design process for an engineering system should generate the nec-
essary details for production or assembly of the system. It is clear from this discussion that 
what is preferred is a “unified” and “integrated” approach of modeling-design-control.
Note: Traditionally, an “integrated” approach that treats all domains concurrently is 
termed a “mechatronic” approach. However, in this book we will call a modeling approach 
that is both integrated and unified (i.e., one that exploits domain similarities/analogies) as 
mechatronic modeling. A formal definition of mechatronics is “synergistic application of 
mechanics, electronics, control engineering, and computer science in the development of 
electromechanical products and systems, through integrated design.”
System
model
Design 
refinement
System
design 
Model 
refinement
Purpose, performance
specifications, past
knowledge, etc.
Performance 
prediction
Design objectives/
specifications 
Design 
decisions
FIGURE 1.2
Link between modeling and design.

7
Introduction to Modeling
1.3  Dynamic Systems and Models
Each interacted component or element of an engineering system will possess an input-
output (or cause-effect, or causal) relationship. A dynamic system is one whose response 
variables (which are functions of time) have non-negligible “rates” of change. Also, its 
present output depends not only on the present input but also on some historical infor-
mation (e.g., previous input or output). A more formal mathematical definition can be 
given, but it is adequate to state here that a typical engineering system, which needs to 
be controlled, is a dynamic system. A model is some form of representation of a practical 
system. In particular, an analytical model (or mathematical model) comprises equations (e.g., 
differential equations) or an equivalent set of information, which represents the system 
to a required degree of accuracy. Alternatively, a set of curves, digital data (e.g., arrays or 
tables, files) stored in a computer or in some medium, and other numerical data—rather 
than a set of equations—may be termed a model, strictly a numerical model. In particular, 
an experimental model is a (numerical) model obtained from a set of test data (input–output 
data) through physical experimentation of the actual system. A representative analytical 
model can be established or “identified” from a numerical model (or from experimental 
input–output data). The related subject is called “model identification” or “system iden-
tification” in the field of automatic control. A dynamic model is a representation of a 
dynamic system.
1.3.1  Terminology
A general schematic representation of a dynamic system is shown in Figure 1.3. The sys-
tem is demarcated by a boundary, which may be either real (physical) or imaginary (vir-
tual). What is outside this boundary is the environment of the system. There are inputs, 
which enter the system from the environment and there are outputs, which are generated 
by the system and provided to the environment. Some useful terms concerning dynamic 
systems are defined below.
System: Collection of interacting components of interest, demarcated by a system 
boundary.
Dynamic System: A system whose rates of changes of response/state variables can-
not be neglected.
Plant or Process: The system to be controlled.
Inputs: Excitations (known or unknown; deliberate/desired or undesired) applied 
to the system.
Outputs: Responses (desired or undesired) of the system.
State Variables: A minimal set of variables that completely identify the “dynamic” 
state of a system. Note: If the state variables at one state in time and the inputs from 
that state up to a future state in time are known, the future state can be completely 
determined.
Control System: A system that includes at least the plant and its controller. It may 
include other subsystems and components (e.g., sensors, signal conditioning and 
modification devices).

8
Modeling of Dynamic Systems with Engineering Applications
Dynamic systems are not necessarily engineering, physical, or man-made systems even 
though the focus of the present book is on engineering systems. Examples of dynamic 
systems with some inputs and outputs are given in Table 1.1. Exercise: add to this list some 
other inputs and outputs.
1.3.2  Model Complexity
It is unrealistic to attempt to develop a “universal model” that will incorporate all con-
ceivable aspects of the system. For example, an automobile model that simultaneously 
represents ride quality, power, speed, energy consumption, traction characteristics, han-
dling, structural strength, capacity, load characteristics, cost, safety, and so on is not very 
practical and can be intractably complex. The model should be as simple as possible, and 
may address only a few specific aspects of interest in the particular study or application. 
Approximate modeling and model reduction are relevant topics in this context.
System
boundary 
Inputs
(excitations)
Outputs
(response)
Dynamic system
(Physical laws, state
variables, system
parameters)
Environment
FIGURE 1.3
Nomenclature of a dynamic system.
TABLE 1.1
Examples of Dynamic Systems
System
Examples of Inputs
Examples of Outputs
Human body
Neuroelectric pulses (due to external stimuli), 
desirable stimuli, distractions
Muscle contractions, body movements, 
cursing, unlawful activity
Company
Information that is used for operation, decisions that 
represent executive commands, etc., weakening of 
stock market, price increase of raw material, drop 
in demand or product market value (e.g., due to 
deteriorated product quality)
Information that constitutes company 
product, decisions that represent output 
information, finished products, wastage, 
product quality deterioration
Power plant
Fuel rate, change in environmental conditions (e.g., 
temperature), increase in operating costs
Electric power, pollution rate, drop in 
production, noise
Automobile
Steering wheel movement, road disturbances, effect 
of an accident on the automobile, weather 
deterioration
Front wheel turn, direction of heading, 
ride quality deterioration, noise, motion 
causing an accident
Robot
Voltage to joint motors, external force on end 
effector (e.g., from a collision), noise component in 
input signal
Joint motions, end effector motion, 
wrong pose/heading (response error)
Note:	 These will also depend on the system boundary, as considered in the particular example. Then categorize 
them as: known and deliberately applied inputs; unknown and/or undesirable inputs (e.g., distur-
bances); desirable (or deliberate) outputs; and undesirable outputs, for each of these systems.

9
Introduction to Modeling
As an example, consider a hard-disk drive (HDD) unit, as shown in Figure 1.4a. If the 
objective is vibration analysis and control, a simplified model such as the one shown 
in Figure 1.4b or c may be used. In particular, Figure 1.4b provides a two-dimensional, 
multi-degree-of-freedom mechanical model where some of the inertia effects are modeled 
as lumped masses and the flexibility effects are represented by rectilinear springs. The 
mounting frame and the disk may be modeled as plates. Energy dissipation (damping) is 
not modeled. Figure 1.4c is a further simplified, one-dimensional, two-degree-of-freedom 
mechanical model. It is an entirely lumped-parameter model, and again energy dissipa-
tion is not modeled.
As another example, consider the innovative elevated-guideway transit system shown 
in Figure 1.5a. This is an automated transit system that is operated without drivers. The 
ride quality, which depends on the vibratory motion of the vehicle, may be analyzed using 
an appropriate model. Usually the dynamics (inertia, flexibility, and energy dissipation) 
of the guideway as well as the vehicle have to be incorporated into such a model. First, 
the system is simplified by incorporating just one car of the train, as shown in Figure 1.5b. 
A simplified model of it that may be used in a ride quality study is shown in Figure 1.5c. 
This is a lumped-parameter model where the distributed characteristics (e.g., mass) are 
(c)
(a)
(b)
md
ma
kd
ka
fd = fo cos ωt
yd
ya
Fixed
housing
Shock
mounts
HDD mass
(excluding
housing mass and
absorber mass)
Absorber
mounts
Absorber
mass
Spindle
motor
Head slider
Disk
Mounting
frame
Arm motor
stator
Tracks
Arm rotor
Arm
Control
circuit
Mounting frame
(for disk, actuators,
and other components)
Shock mount
(flexible)
Rigid
housing
Arm actuator
(voice-coil motor)
Absorber mount
(flexible)
Absorber mass
Read/write
arm
Disk
Spindle
motor
FIGURE 1.4
(a) A hard-disk drive (HDD) unit of a computer; (b) components for a simplified model; and (c) a simplified 
model for vibration control.

10
Modeling of Dynamic Systems with Engineering Applications
Car
Pier
Guideway
(b)
(a)
(c)
Roll
(Heave)
(Roll)
(Pitch)
k2/2
c2/2
k1/2
c1/2
k3/2
c3/2
k4/2
c4/2
u
v
φ
y
z
Elevation
x
y
la
Guideway
Car
Front
ξ
θ
Rear
Plan
(Yaw)
(Lateral)
FIGURE 1.5
(a) An innovative elevated guideway transit system; (b) a simplified system that incorporates a single car; and 
(c) a model for determining the ride quality of the mass transit system.

11
Introduction to Modeling
approximated by lumped elements. Furthermore, the model does not consider the dynam-
ics of the guideway.
As the third example, consider the industrial machine shown in Figure 1.6a, which has 
been developed by us for the head removal of salmon. The conveyor, driven by an ac 
motor, indexes the fish in an intermittent manner. The image of each fish, obtained using 
a digital camera, is processed to determine the geometric features, which in turn establish 
the proper cutting location. A two-axis hydraulic drive unit positions the cutter accord-
ingly, and the cutting blade is operated using a pneumatic actuator. Position sensing of the 
hydraulic manipulator is done using linear magnetostrictive displacement transducers. 
A set of six gauge-pressure transducers are installed to measure the fluid pressure in the 
head and rod sides of each hydraulic cylinder, and also in the supply lines. A high-level 
imaging system determines the cutting quality, according to which adjustments may be 
made on-line, to the parameters of the control system so as to improve the machine per-
formance. Clearly, this is a multidomain system, which involves at least the mechanical, 
electrical, and fluid domains. A model that sufficiently represents the characteristics of 
these domains is shown in Figure 1.6b.
1.4  Model Types
One way to analyze a system is to apply excitations (inputs) to the system, measure the 
resulting responses (outputs) of the system, and fit the input–output data obtained in this 
manner to a suitable analytical model. This is known as experimental modeling or model 
identification or system identification. A model that is determined in this manner is called 
an experimental model. Another way to analyze a system is by using an analytical model of 
the system, which originates from the physical (constitutive) equations of the constituent 
components or processes of the system. Analytical models include state-space models and 
input–output models. An important category of input–output models is the transfer function 
models (in the Laplace domain in general and in the frequency-domain in particular).
Graphical techniques such as linear graphs, bond graphs, and block diagrams can assist 
in the development of analytical models. Since developing a physical model (or a proto-
type) of a system and testing it is often far less economical, flexible, quick or practical than 
analyzing or computer-simulating an analytical model of the system, analytical models 
are commonly used in practical applications, particularly during the pre-prototyping 
stage. Instrumentation (exciters, measuring devices and analyzers) and computer sys-
tems for experimental modeling (e.g., modal testing and analysis systems) are commer-
cially available. Experimental modeling is done frequently, if less often than analytical 
modeling.
As discussed, in general, models may be grouped into the following categories:
•	 Physical models or prototypes
•	 Analytical models (mathematical models)
•	 Computer models or numerical models (computer programs, files, data tables and 
arrays, multidimensional graphs, etc.)
•	 Experimental models (where input–output experimental data are used for model 
“identification”).

12
Modeling of Dynamic Systems with Engineering Applications
In the present book, the main focus is on analytical models with a secondary focus on 
computer models.
1.4.1  Advantages of Analytical Models
Normally, mathematical definitions for a dynamic system are given with reference to an 
analytical model of the system; for example, a state-space model or an input–output model. 
(a)
Secondary 
camera
Primary 
camera
Vertical
cutter blade
Discharge
hopper
Electro-hydraulic
manipulator
Power subsystem
ir
iy
Variable
displacement
pump
Oil reservior
Position
transducer
Cutter blade
table
M
X position
Position
transducer
Load subsystem
Y position
Servo valve subsystem
Control, I/O
computer
Mother
board
IEEE 1394
Board
NI FPGA
DAQ Board
Lab VIEW
program
No. 1 CCD
camera
No. 2 CCD
camera
Visual signal
Fish cutting machine
(b)
Hydraulic cutting table
M
Conveyor (fish motion mechanism)
Limit switch
Limit switch
Pneumatic cutter
Synchronization
(conveyor and cutter)
Control signals (hydraulic cutting table and
pneumatic cutter)
Fish
holding
stabilizer
FIGURE 1.6
(a) An intelligent iron butcher and (b) a multidomain model of the Iron Butcher.

13
Introduction to Modeling
There are many advantages of analytical models over other types of models. The main 
advantages of analytical models (and computer models) over physical models include the 
following:
•	 Modern, high-capacity, high-speed computers can handle complex analytical 
models at high speed and low cost.
•	 Physical principles are easily and directly included in analytical models.
•	 Analytical methods are more precise.
•	 Analytical models and computer models can be modified conveniently and at 
high speed and low cost.
•	 Analytical models provide much flexibility in making structural and paramet-
ric changes of a dynamic system/model. (Note: Structural changes are those that 
modify how the system components are interconnected—series, parallel, etc. 
Parametric changes are changes to the parameter values of the system components)
•	 Analytical models are directly applicable in computer simulation.
•	 Analytical models can be easily integrated with computer/numerical/­experimental 
models, to generate “hybrid” models (e.g., in hardware-in-the-loop computer 
simulations).
•	 Analytical modeling can be conveniently done well before a prototype is built (In 
fact this step can be crucial in deciding whether to prototype).
1.4.2  Mechatronic Systems
The systematic approach to modeling, as presented in this book, is quite similar to and 
even goes beyond what is formally known the “mechatronic” approach. In particular, 
the mechatronic approach is a systematic and integrated (concurrent) approach while 
the approach that is presented in this book is systematic, integrated, and unified (uses 
­analogous/similar approaches for modeling different physical domains). Since mecha-
tronic systems are multidomain systems, the approach in the book is particularly suitable 
for mechatronic systems. In this backdrop, it is useful to have some understanding of 
mechatronic systems.
A typical mechatronic system consists of a mechanical skeleton, actuators, sensors, 
controllers, signal conditioning/modification devices, computer/digital hardware and 
software, interface devices, and power sources. Different types of sensing, information 
acquisition and transfer are involved among all these various types of components. For 
example, a servomotor, which is a motor with the capability of sensory feedback for 
accurate generation of complex motions, consists of mechanical, electrical, and elec-
tronic components. The main mechanical components are the rotor, stator, and the bear-
ings. The electrical components include the circuitry for the field windings and rotor 
windings (not in the case of permanent-magnet rotors), and circuitry for power trans-
mission and commutation (if needed). Electronic components include those needed for 
sensing (e.g., optical encoder for displacement and speed sensing and tachometer for 
speed sensing). The overall design of a servomotor can be improved by taking a mecha-
tronic approach.
The humanoid robot shown in Figure 1.7a is a more complex and “intelligent” mecha-
tronic system. It may involve many servomotors and a variety of mechatronic components, 
as is clear from the sketch in Figure 1.7b. A mechatronic approach can greatly benefit the 

14
Modeling of Dynamic Systems with Engineering Applications
modeling, analysis, design, development, and control of a complex electromechanical (or 
multidomain) system of this nature.
Technology issues of a general mechatronic system are indicated in Figure 1.8. It is seen 
that they span the traditional fields of mechanical engineering, electrical and electronic 
engineering, control engineering, and computer engineering. Each aspect or issue within 
(a)
Six-axis force sensor
Six-axis force sensor
Wireless receiver
Gyro G-force
sensor
Battery
CPU
Antenna
Camera
Actuator auxiliary
processing units
Actuator auxiliary
processing units
(b)
FIGURE 1.7
(a) A humanoid robot is a complex and “intelligent” mechatronic system and (b) components of a humanoid 
robot. (Courtesy of American Honda Motor Co. Inc., Torrance, CA.)

15
Introduction to Modeling
the system may take a multidomain character. For example, as noted before, an actuator 
(e.g., dc servo motor) alone may represent a mechatronic device within a larger mecha-
tronic system such as an automobile or a robot.
Study of mechatronic engineering should include all stages of modeling, design, devel-
opment, integration, instrumentation, control, testing, operation, and maintenance of a 
mechatronic system.
1.4.3  Steps of Analytical Model Development
In a “systematic” approach to modeling, it is necessary to indicate its key steps. As a pre-
view of what yet to be presented, we give below the key steps of the systematic approach 
that is presented in the book.
	
1.	Identify the system of interest (e.g., purpose, components, system boundary).
	
2.	Identify/specify the variables of interest (e.g., excitations/inputs, responses/outputs).
	
3.	Approximate various segments (components, processes, phenomena) by ideal 
elements, suitably interconnected. Draw a structural diagram for the system (e.g., 
mechanical circuit, electrical circuit, linear graph, bond graph), showing the struc-
ture (element/component interconnection) of the system.
Modeling, analysis
integrated design
testing, and refinement
Sensors and transducers
Structural
components
Electronics
(analog/digital)
Actuators
Controllers
Energy 
sources
Software
Hydraulic and
pneumatic
devices
Signal
processing
Thermal
devices
Input/output
hardware
Mechanical
engineering
Electrical and
computer engineering
System
development
tasks
Mechatronic
system
FIGURE 1.8
Concepts and technologies of a mechatronic system.

16
Modeling of Dynamic Systems with Engineering Applications
	
4.	Using the structural diagram:
	
a.	 Write constitutive equations (physical laws) for elements (other than the “input 
elements” or “sources”).
	
b.	 Write continuity equations (or conservation equations) for through-variables (those 
variable that do not change through an element) at junctions (nodes), which 
connect two or more elements (e.g., equilibrium of forces at mechanical joints; 
current balance at circuit nodes).
	
c.	 Write compatibility equations (or loop equations) for across-variables (potential 
variables, path variables), which are measured across an element, in closed 
paths (loops) (e.g., for velocities—geometric connectivity; for voltages—­
potential balance). Why is compatibility automatically satisfied (and hence, 
compatibility equations do not have to be written) for mechanical systems? 
(the answer is found elsewhere in the book).
	
d.	 Eliminate auxiliary variables (unwanted variables).
	
5.	Express boundary conditions and initial conditions using system variables.
Note: It should be clear that boundary conditions are needed only for distributed param-
eter systems (they are automatically satisfied in lumped-parameter models).
In this book we will primarily focus the following types of analytical models:
•	 State Models (State-Space Models): They use state variables (e.g., velocity of 
a lumped mass, force in a spring, current through an inductor, voltage across 
a capacitor) to represent the state of the system, in terms of which the system 
response can be expressed. These are time-domain lumped-parameter models, 
with time t as the independent variable.
•	 Transfer-Function Models (Particularly Frequency-Domain Models): These 
are a type of input–output models expressed using transfer functions. A transfer 
function is the Laplace transform of the output variable divided by the Laplace 
transform of the input variable. Laplace variable s is the independent variable. 
A frequency-domain model, expressed using frequency transfer functions, is a 
very practical transfer function model. It can be directly obtained from a Laplace 
transfer function simply by setting s = jω. Then, the independent variable is fre-
quency ω.
In the development and application of these analytical models, we will use such graphical 
representations of models as linear graphs and bond graphs. In a linear graph, a line rep-
resents a basic component (element) of the system, with one end as the point of action and 
the other end as the point of reference. In a bond graph, a line emerges from an element 
(hence, a line joins two elements in the form of a “bond”). These techniques are presented 
in the book (see Chapters 5 and 7 for linear graph techniques; an introduction to the bond-
graph approach of modeling is given in Appendix B).
1.4.4  Modeling Criteria and Equivalent Models
The book pays particular attention to equivalent models. Notably, approximate models concern 
approximate equivalence of models. A model itself is “approximately equivalent” to the actual 
system. Indeed, various types of models (physical, analytical, computer, experimental, etc.) 

17
Introduction to Modeling
are approximately equivalent to the actual system. In the process of modeling, first, an 
equivalence is established based on such considerations as:
•	 The needs of the specific application (purpose of the model: design, analysis, con-
trol, etc., of what aspects?)
•	 Available resources for modeling: physical information, analytical methodologies, 
physical system, computer resources, accessibility and ability to acquire experi-
mental data, ability to develop a physical prototype, past information, etc.
•	 The required accuracy and the limit on model complexity.
The decision to develop an analytical model can be made based on such considerations.
In the development of an analytical model for a system, we have to first establish some 
criteria of equivalence or approximate equivalence of models. For example, we may consider 
the conversion of:
•	 A distributed-parameter system (model) into a lumped-parameter model
•	 A nonlinear system (model) into a linear model
•	 A time-domain system (model) into a transfer function (particularly, frequency-
domain transfer function of FTF) model
•	 A component-based, detailed transfer-function model into a reduced TF model
•	 A complex and extensive subsystem of the system into a simple “equivalent model” 
such that: the dynamic interactions (of the original model and of the equivalent 
model) with the remaining “simple segment of interest” of the system are the 
same.
In each case, we (explicitly or implicitly) use some criteria of equivalence; e.g., energy 
equivalence, modal (natural-frequency) equivalence, analytical equivalence, computer-
simulation (discrete-time or digital) equivalence, physical equivalence, or dynamic equiv-
alence with respect to a “simple segment of interest” of the system. In the book, we will 
study all these types of equivalent models.
1.5  Organization of the Book
The present book, consisting of nine chapters and six appendices, is devoted to theory, 
techniques, and application of analytical modeling of engineering dynamic systems. The 
chapters systematically cover the process of understanding and the analytical representa-
tion of an engineering dynamic system, using proper principles of science. The subject of 
computer simulation is addressed as well.
Chapter 1 introduces the subject of modeling with a focus on multidomain engineering 
dynamic systems. The importance of dynamic modeling in various applications is indi-
cated. The use of modeling in the design and control of a dynamic system is highlighted. 
The terminology of dynamic systems and models is clarified. Common types of models 
and modeling techniques are introduced and their comparative advantages and disadvan-
tages are indicated. Different types of dynamic systems and models are introduced. The 

18
Modeling of Dynamic Systems with Engineering Applications
subject of Mechatronics is introduced and a pertinent approach for the dynamic modeling 
in Mechatronics is emphasized. The main and systematic steps of developing an analytical 
model of a dynamic system are given. This introductory chapter sets the tone for the study, 
which spans the remaining eight chapters.
Chapter 2 identifies the basic elements of linear, lumped-parameter analytical mod-
els in the mechanical, electrical, fluid, and thermal domains. The across-variables and 
through-variables that are used in the physical equations of these elements are discussed, 
while identifying their analogies (similarities) across domains. The considered element 
categories are the sources (input elements), energy storage elements, and energy dissipa-
tion elements. The identification of proper and physically meaningful state variables is 
discussed in an analogous manner. Specifically, capacitor-type energy storage elements 
(called A-type elements) use their across-variables as the state variable while inductor-
type energy storage elements (called T-type elements) use their through-variables as the 
state variables. Resistor-type elements are energy dissipation elements (called D-type ele-
ments). Natural oscillations in a dynamic system are a manifestation of the presence of 
two types of energy storage elements (A-type and T-type). Further types of mechanical/
electrical/electronic elements and components are presented in Appendix A.
Chapter 3 introduces the subject of modeling of a dynamic system. Emphasized in the 
chapter are model types, and the tasks of “understanding” and analytical modeling of 
mechanical, electrical, fluid, and thermal systems. Various types of analytical models are 
introduced and compared. In particular, a comparative study of continuous-time systems 
(models) and discrete-time systems (models) is given. As well, a comparative study of 
distributed-parameter systems (models) and lumped-parameter systems (models) is pre-
sented. Analytical models may be developed for mechanical, electrical, fluid, and thermal 
systems in a rather analogous manner, because clear analogies exist among these four 
types of systems (physical domains). The systematic development of state-space models 
and input–output models of engineering systems in these four domains is studied with 
numerous illustrative examples.
Chapter 4 studies linearization of a nonlinear system/model in a restricted range of 
operation about an operating point. Real systems are nonlinear and they are represented 
by nonlinear analytical models consisting of nonlinear differential equations. Linear sys-
tems (models) are in fact idealized representations, and are represented by linear differen-
tial equations. First linearization of analytical models, particularly state-space models and 
input–output models, is treated. Then, linearization of experimental models (experimental 
data) is addressed.
Chapter 5 presents linear graphs—an important graphical tool for developing and rep-
resenting a model of a dynamic system. State-space models of lumped-parameter dynamic 
systems, regardless of whether they are mechanical, electrical, fluid, thermal, or multido-
main (mixed) systems, can be conveniently developed by using linear graphs. The chapter 
systematically studies the use of linear graphs in the development of analytical models 
for mechanical, electrical, fluid, and thermal systems. More advanced concepts of linear 
graphs, particularly the graph-tree concepts, are presented in Appendix C.
Chapter 6 treats transfer-function models and the frequency-domain analysis of dynamic 
systems. Both Laplace-domain concepts and frequency-domain concepts are presented on 
the basis of the Laplace transform and the Fourier transform (also see Appendix D). A lin-
ear, constant-coefficient (time-invariant) time-domain model can be converted into a trans-
fer function, and vice versa, in a simple and straightforward manner. A unified approach 
is presented for the use of the transfer function approach in the modeling and analysis of 
multidomain (e.g., mechanical and electrical) systems. In this context, mechanical circuits 

19
Introduction to Modeling
are introduced (similar to electrical circuits), which make use such mechanical transfer 
functions as mobility, mechanical impedance, force transmissibility and motion trans-
missibility. Their practical applications are discussed. Maxwell’s reciprocity principle is 
given for dynamic systems, and is generalized for various physical domains (particularly 
mechanical and electrical domains).
Chapter 7 extends the concepts of equivalent circuits (Thevenin equivalence and Norton 
equivalence) to other physical domains such as mechanical and fluid domains. Frequency-
domain linear graphs, called “transfer-function linear graphs,” are introduced. They are 
integrated with Thevenin and Norton equivalence, giving rise to linear graph reduction 
and equivalent linear graphs. Their application in various physical domains is illustrated. 
The conversion of a multidomain (mixed) dynamic system into an equivalent single 
domain is presented. The methods of equivalent linear graphs are used to analyze the 
converted single-domain models.
Chapter 8 presents the use of block diagrams to represent dynamic systems. The rela-
tionships between input–output differential equation models, transfer function mod-
els, block diagrams, and state-space models are illustrated. Various types of simulation 
block diagrams are presented, which are particularly useful in the computer simulation 
of dynamic systems. The representation of an input–output model as a simulation block 
diagram, and the formulation of a state-space model using it are presented, with illustra-
tive examples.
Chapter 9 concerns response analysis and simulation. In particular, it studies how a 
system responds when excited by an initial condition—free, natural response, or when a 
specific excitation (i.e., input) is applied—forced response. Such a study may be carried out 
by the solution of differential equations (analytical) or by computer simulation (numeri-
cal). The chapter addresses both approaches. In the latter case, in particular, the use of 
Simulink® is illustrated. Further use of software tools is provided in Appendix E. Some 
advanced concepts of response analysis are presented in Appendix G. Relevant linear 
algebra is given in Appendix F.
Appendix A presents some useful practical components in the mechanical and ­electrical/
electronic domains. This provides an enhancement to the treatment given in Chapter 2.
Appendix B introduces the bond-graph approach to modeling. It is an alternative graph-
ical approach to modeling of dynamic system, in the same class as linear graphs.
Appendix C presents the graph-tree approach, which broadens the application of linear 
graphs. Some issues concerning linear graphs that are not addressed in Chapter 5 are dis-
cussed and illustrated in this appendix.
Appendix D gives techniques and other useful information on Laplace transform and 
Fourier transform. The application of the transfer-function approach and particularly the 
frequency-transfer function approach (or, the frequency response approach) is illustrated 
using these two transforms.
Appendix E introduces several popular software tools and environments that are avail-
able for simulation and control engineering both at the learning level and at the application 
level. Presented and illustrated in the appendix are Simulink—a graphical environment 
for modeling, simulation, and analysis of dynamic systems; MATLAB® with its Control 
Systems Toolbox and Fuzzy Logic Toolbox; and LabVIEW, which is a graphical program-
ming language and a program development environment for data acquisition, processing, 
display, and instrument control.
Appendix F reviews linear algebra—the algebra of sets, vectors, and matrices. It is 
useful in the study of control systems in general and the state-space approach in par-
ticular. The underlying mathematical methods are particularly useful in the analysis of 

20
Modeling of Dynamic Systems with Engineering Applications
multi-input–multi-output (MIMO) models and state-space models, and in the advanced 
response analysis of dynamic systems.
Appendix G presents some advanced considerations of response analysis. The presented 
methodologies complement those presented in Chapter 9.
Summary Sheet
Book Objectives: Learn the theory and application of a systematic, unified, and inte-
grated approach to analytical modeling; learn computer simulation of a dynamic 
system.
Uses/Applications of Modeling: Dynamic system analysis, computer simulation, 
design, modification/restructuring, instrumentation, control, testing, and perfor-
mance evaluation.
Uses of a Model in Control: (1) Mathematical analysis and computer simulation; 
(2)  as a reference model for performance specification; (3) to develop a control 
scheme (in model-based control); (4) to design a control system.
Uses of a Model in Design: (1) To represent the desired design of the entire system 
or part of it (particularly in the absence of a physical system or prototype); (2) to 
analyze and optimize a design; (3) to develop integrated and unified design 
approaches of design (e.g., in mechatronic design); (4) to assist in instrumen-
tation (which may be considered as an integral part of design) of a dynamic 
system.
System: Interacting components of interest, demarcated by system boundary.
Dynamic System: A system where rates of changes of response/state variables are 
not negligible.
Plant or Process: The system to be controlled.
Inputs: Excitations (known or unknown; desired/deliberate or undesired) applied 
to the system.
Outputs: Responses (desired or undesired) of the system.
State Variables: A minimal set of variables that completely identify the “dynamic” 
state of the system. If the state variables at one state and the inputs from that state 
up to a future state are known, the future state can be completely and uniquely 
determined.
Control System: Includes at least the plant and its controller. May include other sub-
systems and components (e.g., sensors or signal conditioning and modification 
devices).
Universal Model: Incorporates all conceivable aspects of the system. Unrealistic. Too 
complex. Not practical.
Model Types: Physical models (prototypes); analytical models (mathematical mod-
els); computer models or numerical models (computer programs, files, data tables 
and arrays, multidimensional graphs, etc.); experimental models (input–output 
experimental data are used for model “identification”).

21
Introduction to Modeling
Advantages of Analytical Models: Computers can handle complex analytical mod-
els at high speed and low cost; physical principles are easily and directly included 
in them; more precise; can be modified conveniently and at high speed and low 
cost; more flexible in making structural and parametric changes (Note: Structural 
changes: modify component interconnection—series, parallel, etc. Parametric 
changes: change the parameter values—mass, capacitance, etc.); directly useful 
and applicable in computer simulation; can be easily integrated with computer/
numerical/experimental models → “hybrid” models; can be developed well before 
a prototype is built (can be crucial in deciding whether to prototype).
Steps of Analytical Model Development
	
1.	Identify the system of interest (e.g., purpose, system boundary)
	
2.	Identify/specify the variables of interest (e.g., excitations/inputs, responses/outputs)
	
3.	Approximate various segment by ideal elements, suitably interconnected. Draw a 
structural diagram (e.g., mechanical circuit, electrical circuit, linear graph, or bond 
graph), showing the system structure (element/component interconnection)
	
4.	Using the structural diagram
	
a.	 Write constitutive equations (physical laws) for elements (other than the “input 
elements” or “sources”)
	
b.	 Write continuity equations (or conservation equations) for through-variables (those 
variable that do not change through an element) at junctions (nodes), which 
connect two or more elements (e.g., equilibrium of forces at mechanical joints; 
current balance at circuit nodes)
	
c.	 Write compatibility equations (or loop equations) for across-variables (potential 
variables, path variables), which are measured across an element in closed 
paths (loops) (e.g., for velocities—geometric connectivity; for voltages—­
potential balance)
	
d.	 Eliminate auxiliary variables (unwanted variables)
	
5.	Express boundary conditions and initial conditions using system variables.
Problems
1.1	
The modeling approach that is presented in the book is said to be: (1) integrated, 
(2) unified, and (3) systematic. Define these three terms in the present context.
1.2	
A typical input variable is identified for each of the following examples of dynamic 
systems. Give at least one output variable for each system.
	
(a)	 Human body: neuroelectric pulses
	
(b)	 Company: information

22
Modeling of Dynamic Systems with Engineering Applications
	
(c)	 Power plant: fuel rate
	
(d)	 Automobile: steering wheel movement
	
(e)	 Robot: voltage to joint motor
	
(f)	 Highway bridge: vehicle force.
1.3	
The use of solar energy is a sustainable way to generate electric power for houses. A 
schematic arrangement is shown in Figure P1.3a. Radiation from the sun is received 
at a solar panel, which consists of photovoltaic cells to convert solar energy to elec-
tric energy in the form of direct current (dc). Using an inverter, the dc power is 
converted into alternating current (ac) power of appropriate frequency (60 or 50 Hz) 
for household use. This electrical supply is connected through a two-way meter to 
the supply line of the house and to the main electricity grid (Figure 1.3b). In this 
manner, any excess power from the solar panels can be sold to the grid and when 
the supply from the solar panel is not adequate (e.g., during cloudy days or at night) 
electricity can be purchased from the grid. The ac power is used for various house-
hold purposes such as operation of appliances, heating, and cooling.
	
(a)	 Explain why this is a multidomain (i.e., mixed) system.
	
(b)	 Identify several key components of the system (Note: Some are shown in the fig-
ure). Discuss various processes within the components that may be categorized 
(a)
Solar radiation
Solar panel
2-Way
Meterr
Inverter
Applicances
Power grid
Sun
(b)
Photovoltaic
cells
Inverter
(dc/ac
converter)
Two-way
electricity
meter
Home
Power
grid
FIGURE P1.3
(a) A solar-powered house and (b) schematic diagram of the ac power supply.

23
Introduction to Modeling
into the mechanical, electrical, fluid, and thermal domains. Indicate applicable 
modeling issues for the overall system.
	
(c)	 Sketch the energy flow of the system, indicating relevant stages of energy 
conversion.
1.4	
What is a system and what is a “dynamic” system?
1.5	
Give four categories of uses of dynamic modeling.List advantages and disadvan-
tages of experimental modeling over analytical modeling.
1.6
	
(a)	 Give logical steps of the analytical modeling process for a general physical 
system.
	
(b)	 Once a dynamic model is derived, what other information would be needed 
for analyzing its time response (or for computer simulation)?
	
(c)	 A system is divided into two subsystems, and models are developed for these 
subsystems. What other information would be needed to obtain a model for 
the overall system?
1.7	
Various possibilities of model development for a physical system are shown in 
Figure P1.7. Give advantages and disadvantages of the SM approach of developing 
an approximate model in comparison to a combined DM+MR approach.
1.8	
Indicate several sources of error in a model-based approach. Your answer should 
be rather general even though specific application areas such as system analysis, 
computer simulation, and control may be considered.
1.9	
Consider the model of a hard-disk drive unit, as shown in Figure 1.4b. Indicate, 
giving reasons, what other aspects may be modeled.
1.10	 Consider the model of an elevated guideway transit system, as shown in Figure 1.5c. 
Indicate, giving reasons, what other aspects may be modeled.
Physical
system
A
Accurate
model
B
Approximate
model
C
Detail
modeling
(DM)
Simplified
modeling
(SM)
Model
reduction
(MR)
FIGURE P1.7
Approaches of model development.


25
2
Basic Model Elements
2.1   Introduction
An engineering physical dynamic system often consists of a mixture of different types 
of processes and components (e.g., those involving the four physical domains: mechani-
cal, electrical, fluid, and thermal). Such a system is called a multidomain or mixed dynamic 
system. In modeling such a system, an integrated approach is desirable where all physical 
domains are modeled together (i.e., a concurrent treatment), and also a unified approach is 
desirable, where similar approaches are used to analyze all physical domains (i.e., an analo-
gous treatment). In this context, it is important to recognize the analogies that exist among 
various physical domains. In this chapter, we will study these analogies at the “­element” 
level, which we will incorporate in model development in the subsequent chapters, at 
the “system” level. In particular, we will identify the basic elements of linear lumped-
parameter analytical models in the mechanical, electrical, fluid, and thermal domains, in 
a systematic manner. The considered element categories are the sources (input elements), 
Chapter Highlights
•	 Lumped Elements and Analogies
•	 Across-Variables and Through-Variables
•	 Energy Storage Elements
•	 Energy Dissipating Elements
•	 Input Elements
•	 Mechanical Elements (Mass or Inertia Element, Spring or Stiffness Element, and 
Damper or Dissipation Element)
•	 Electrical Elements (Capacitor, Inductor, and Resistor)
•	 Fluid Elements (Capacitor or Accumulator, Inertor or Inductor, and Resistor)
•	 Fluid Capacitance due to: Fluid Compressibility, Container Flexibility, and Gravity 
Head
•	 Thermal Elements (Capacitor and Resistor)
•	 Thermal Resistance due to: Conduction, Convection, and Radiation
•	 Natural Oscillations

26
Modeling of Dynamic Systems with Engineering Applications
energy storage elements, and energy dissipation elements. For the energy storage elements, 
we will give particular consideration to their energy characteristics, input-output (causal) 
behavior, and governing variables (e.g., through- and across-variables; state variables), 
while identifying their analogies (similarities) across domains. In particular, the identi-
fication of proper and physically meaningful state variables is discussed in an analogous 
manner. Specifically, capacitor-type energy storage elements (called A-type elements) use 
their across-variables as the state variable while inductor-type energy storage elements 
(called T-type elements) use their through-variables as the state variables. Resistor-type 
elements are energy dissipation elements (called D-type elements) and they don’t intro-
duce state variables. Natural oscillations in a dynamic system are a manifestation of the 
presence of two types of energy storage elements (A-type and T-type). Further types of 
mechanical/electrical/electronic elements and components are presented in Appendix A.
2.1.1  Lumped Elements and Analogies
A system may possess various physical characteristics that arise from various physical 
domains; particularly, mechanical, electrical, thermal, and fluid processes. The procedure 
of model development will be facilitated by understanding the similarities (analogies) 
that exist among these domains and also among the basic physical elements of these 
domains.
The basic physical elements in an engineering system can be divided into two broad 
groups:
Energy storage elements
Energy dissipation elements.
The dynamic “state” of a system is determined by its “independent” energy storage ele-
ments and their state variables. Depending on the type of the energy storage element, we 
can use either an across-variable or a through-variable as its state variable. As we will see, 
energy dissipation elements do not introduce state variables. Their states are determined 
by the state variables of the independent energy storage elements.
Independent Energy Storage Elements: Two energy storage elements are inde-
pendent if they cannot be completely represented by a single equivalent energy 
­storage element.
Input Elements: In addition to the energy storage elements and energy dissipat-
ing elements, an engineering dynamic system will have input elements, which 
­perform actuation (including control) functions of the system.
2.1.2  Across-Variables and Through-Variables
An across-variable is measured across an element, as the difference in the values at the two 
ends of the element. In other words, it is represented by the value at one end of the element 
with respect to the value at the other end. Velocity, voltage, pressure, and temperature are 
across-variables. If the across-variable of an element is an appropriate state variable for 
that element, it is termed an A-type element.
A through-variable represents a property that appears to pass through an element, unal-
tered. Force, current, fluid flow rate, and heat transfer rate are through-variables. If the 

27
Basic Model Elements
through-variable of an element is an appropriate state variable for that element, it is termed 
a T-type element.
Energy Dissipating Element: An energy dissipating element is called a D-type ele-
ment. Unlike an independent energy storage element, it does not introduce a state 
variable. The variables (or the dynamic state) of a D-type element in an engineer-
ing system are completely determined by the independent energy storage ele-
ments (A-type and T-type) in the system.
Analogies exist among mechanical, electrical, hydraulic, and thermal systems/processes. 
Next, we state the physical equations (i.e., constitutive equations) of the basic elements in 
these four domains, identify and justify the appropriate state variables, and recognize 
analogies that exist across these domains.
2.2  Mechanical Elements
Energy Storage Elements: For mechanical elements, we will show that the velocity 
(across-variable) of each independent inertia element (e.g., mass) and the force or 
torque (through-variable) of each independent flexibility element (e.g., spring) are 
the appropriate state variables (or response variables or output variables). Hence, 
mass is an A-type element and spring is a T-type element. These are energy ­storage 
elements that store either kinetic energy or potential energy. The corresponding 
constitutive equations form the “state-space shell” for an analytical model. These 
equations will directly lead to a state-space model of the system, as we will illustrate.
Energy Dissipating Element: The energy dissipating element in a mechanical sys-
tem is the damper (a D-type element).
Input Elements: There are two types of input elements (or source elements) for a 
mechanical system: A-type source and T-type source. A velocity source is an A-type 
source because its independent variable is an across-variable (velocity). The indepen-
dent variable of a source is not be affected by the changes in the system. For a 
velocity source, the associated force or torque variable—the dependent ­variable—
will be affected by the changes in the system. A force source (or torque source) 
is a T-type source because its independent variable is a through-variable (force 
or torque), which is not affected by the changes in the system (while the associ-
ated velocity variable—the dependent variable—will be affected). These are ideal 
sources since in practice the source variable will be affected to some extent by the 
dynamics of the system (this effect is known as “loading”), and is not completely 
“independent.”
2.2.1  Inertia Element
Consider the mass element shown in Figure 2.1a. The constitutive equation (the physical 
law) of the element is given by Newton’s second law:
	
=
m dv
dt
f
	
(2.1)

28
Modeling of Dynamic Systems with Engineering Applications
Here, v denotes the velocity of mass m, measured relative to an inertial reference (fixed on 
earth or moving at constant velocity), and f is the force applied “through” the mass. Since 
power = fv = rate of change of energy, the energy of the element may be determined by 
­integrating it (after substituting Equation 2.1):
	
∫
∫
∫
=
=
=
E
fvdt
m dv
dt vdt
mvdv
or
	
=
E
mv
Energy
1
2
2
	
(2.2)
This is the well-known kinetic energy.
Next, by integrating Equation 2.1, we obtain
	
∫
=
+
−
−
v t
v
m
f dt
( )
(0 )
1
t
0
	
(2.3)
By setting =
+
t
0  in Equation 2.3, we see that if the applied force f is finite (which is a 
­realistic assumption), we have
	
=
+
−
v
v
(0 )
(0 )	
(2.4)
f
m 
v
Position
reference 
mv = f
x, v 
v 
k
f
(a) 
(b)
f
f = bv
b
f = kv
(c) 
FIGURE 2.1
Basic mechanical elements: (a) inertia element (mass); (b) stiffness/flexibility element (spring); and (c) ­dissipation 
element (damper).

29
Basic Model Elements
Note: 
−
0  denotes the time instant just before t = 0 and 
+
0  denotes the time instant just 
after t = 0.
In view of these observations, we may state the following facts:
	
1.	An inertia is an energy storage element. It stores kinetic energy.
	
2.	The velocity across an inertia element cannot change instantaneously unless an 
infinite force/torque is applied to it (not practical). In other words, a finite force/
torque input cannot cause an infinite acceleration (or step change in velocity) in an 
inertia element. Conversely, a finite instantaneous (step) change in velocity in an 
inertia element will need an infinite force/torque, which is not realistic. Hence, 
velocity v is a natural output (or response) variable for an inertia element, which 
can represent its dynamic state (i.e., state variable), and force/torque f is a natural 
input variable for an inertia element.
	
3.	The fact that velocity is most appropriate to represent the “dynamic” state of an iner-
tia element is justified by several reasons: The first justification is Item 2 above; the 
second, from Equation 2.3, the velocity of an inertia element at any time t can be 
completely determined with the knowledge of the initial velocity and the applied 
force/torque during the time interval 0 to t (Note: As we will see in Chapter 3, this is 
indeed the formal definition of state); and the third, from Equation 2.2, the energy of 
an inertia element can be represented by the variable v alone (kinetic energy).
	
4.	Since its state variable (velocity) is an across-variable, an inertia is an A-type 
element.
	
	 Note: In the present development we used mass (in “translatory” motion) to rep-
resent the inertia element. The associate across-variable is the “rectilinear veloc-
ity” and the associated through-variable is the force. However, we could consider 
moment of inertia (in “rotatory” motion) as the inertia element, leading to the 
same observations as before. The associate across-variable is the “angular veloc-
ity” and the associated through-variable is the torque. In general then, we can 
consider an inertia element having a “generalized force” (which includes torque) 
and a “generalized velocity” (which includes angular velocity).
2.2.2  Spring (Stiffness or Flexibility) Element
Consider the spring element (linear) shown in Figure 2.1b. The constitutive equation 
­(physical law) for a spring is given by Hooke’s law:
	
=
df
dt
kv
	
(2.5)
Here, k is the stiffness (inverse of “flexibility”) of the spring.
Note: We have differentiated the familiar force-deflection Hooke’s law, in order to use 
variables that are consistent with the variable choice for an inertia element (i.e., velocity 
and force).
Now following the same steps as for the inertia element, the energy of a spring element 
can be expressed as follows:
	
∫
∫
∫
=
=
=
E
fvdt
f k
df
dt dt
k f df
1
1

30
Modeling of Dynamic Systems with Engineering Applications
or
	
=
E
f
k
Energy 
1
2
2
	
(2.6)
This is the well-known (elastic) potential energy.
Also
	
∫
=
+
−
−
f t
f
k
vdt
( )
(0 )
t
0
	
(2.7)
Furthermore, assuming that the applied velocity v is finite (which is a realistic ­assumption), 
we have
	
=
+
−
f
f
(0 )
(0 )	
(2.8)
Through these results, we can state the following facts:
	
1.	A spring is an energy storage element. It stores elastic potential energy.
	
2.	The force through a spring element cannot change instantaneously unless an infi-
nite velocity is applied to it (not practical). In other words, a finite velocity input 
cannot cause a step change in force in a spring element. Conversely, a finite instan-
taneous (step) change in force in a spring will need an infinite velocity, which is 
not realistic. Hence, force f is a natural output (or response) variable for a spring 
element, which can represent its dynamic state (i.e., state variable), and velocity v 
is a natural input variable for a spring element.
	
3.	The fact that force is most appropriate to represent the “dynamic” state of a 
spring element is justified by several reasons: The first justification is Item 2 
above; the second, from Equation 2.7, the force of a spring element at any time 
t can be completely determined with the knowledge of the initial force and the 
applied velocity during the time interval 0 to t (Note: As we will see in Chapter 
3, this is the formal definition of state); and the third, from Equation 2.6, the 
energy of a spring element can be represented by the variable f alone (elastic 
potential energy).
	
4.	Since its state variable (force) is a through-variable, a spring is a T-type element.
Note: As stated under the inertia element, the term “force” in the context of a spring 
element represents a “generalized” force, which includes torque. In other words, 
the same treatment as given above applies to a torsional (rotatory) spring whose 
variables are torque and angular velocity.
2.2.3  Damping (Dissipation) Element
Consider the mechanical damper (linear viscous damper or dashpot) shown in 
Figure 2.1c. It is a D-type element (energy dissipating element). Its constitutive equation 
(physical law) is
	
=
f
bv	
(2.9)

31
Basic Model Elements
Here, b is the damping constant. Equation 2.9 is an algebraic equation. Hence, either f or 
v can serve as the natural output variable for a damper, and either one can determine its 
dynamic state. However, since the state variables v and f are established by an independent 
inertial element and an independent spring element, respectively, a damper will not intro-
duce a new state variable. Its state is established by the states of the independent energy 
storage elements (inertia and spring elements) in the system.
In summary:
	
1.	A mechanical damper is an energy dissipating element (D-type element).
	
2.	Either force f or velocity v may represent its dynamic state (it is established by the 
states of the independent energy storage elements in the system).
	
3.	No new state variable is introduced by a damper.
	
	 Note: Again, the term “force” in the context of a damper represents a “generalized” 
force, which includes torque. In other words, the same treatment as given above 
applies to a torsional (rotatory) damper whose variables are torque and angular 
velocity.
2.3  Electrical Elements
In electrical systems, the capacitor is the A-type element, with voltage (across-variable) as 
its state variable; and the inductor is the T-type element, with current (through-­variable) 
as its state variable. These are energy storage elements and their constitutive equations 
are differential equations. The resistor is the energy dissipater (D-type element) and as 
usual, with an algebraic constitutive equation; it does not define a new state variable. 
These three elements are discussed below. The input elements (or source elements) of 
an electrical system are the voltage source, where its voltage is the independent vari-
able, which is not affected by the changes in the system (while the associated current 
variable—the dependent variable—will be affected); and the current source, where its 
current is the independent variable, which is not affected by the changes in the sys-
tem (while the associated voltage variable—the dependent variable—will be affected). 
These are “ideal” sources since in practice the source variable will be affected to some 
extent by the dynamics of the system (this effect is known as “loading”), and is not 
completely “independent.”
2.3.1  Capacitor Element
Consider the capacitor element shown in Figure 2.2a. Its constitutive equation (the physical 
law) is given by the differential equation:
	
=
C dv
dt
i
	
(2.10)
Here, v denotes the voltage “across” the capacitor with capacitance C, and i is the current 
“through” the capacitor. Since power is given by the product iv, the energy in a capacitor 
may be obtained by substituting Equation 2.10 in this product and integrating it, as

32
Modeling of Dynamic Systems with Engineering Applications
	
∫
∫
∫
=
=
=
E
ivdt
C dv
dt vdt
Cvdv
or
	
=
E
Cv
Energy 
1
2
2
	
(2.11)
This is the familiar electrostatic energy of a capacitor.
Also
	
∫
=
+
−
−
v t
v
C
idt
( )
(0 )
1
t
0
	
(2.12)
Hence, for a capacitor with a finite current, we have (as for a mechanical inertia element)
	
=
+
−
v
v
(0 )
(0 )	
(2.13)
Using these results, we can state the following facts:
	
1.	A capacitor is an energy storage element. It stores electrostatic energy.
	
2.	The voltage across a capacitor element cannot change instantaneously unless an 
infinite current is applied to it (which is not practical). Specifically, a finite current 
cannot cause a step change in voltage in a capacitor element. Conversely, a finite 
instantaneous (step) change in voltage in a capacitor element will need an infi-
nite current input (which is not realistic). Hence, voltage v is a natural output (or 
response) variable for a capacitor element, which can represent its dynamic state 
(i.e., voltage is a proper state variable), and current i is a natural input variable for 
a capacitor element.
	
3.	The fact that voltage is most appropriate to represent the “dynamic” state of a 
capacitor element can be justified by several reasons: The first justification is Item 
2 above; the second, from Equation 2.12, the voltage of a capacitor element at any 
time t can be completely determined with the knowledge of the initial voltage 
and the applied current during the time interval 0 to t (Note: As we will see in 
Chapter 3, this is the formal definition of state); and the third, from Equation 2.11, 
the energy of a capacitor element can be represented by the variable v alone (elec-
trostatic energy).
(a)
i
v
C
+
–
dv
C
i
dt =
(b)
i
v
L
+
–
di
L
v
dt =
(c)
i
v
v
Ri
=
R
+
–
FIGURE 2.2
Basic electrical elements: (a) capacitor; (b) inductor; and (c) resistor.

33
Basic Model Elements
	
4.	Since its state variable (voltage) is an across-variable, a capacitor is an A-type 
element.
2.3.2  Inductor Element
Consider the inductor element shown in Figure 2.2b. Its constitutive equation (the physical 
law) is given by the differential equation:
	
=
L di
dt
v
	
(2.14)
Here, L is the inductance of the inductor. As before, it can be easily shown that energy in an 
inductor is given by
	
=
E
Li
1
2
2
	
(2.15)
This is the well-known electromagnetic energy of an inductor.
Also, by integrating Equation 2.14, we obtain
	
∫
=
+
−
−
i t
i
L
vdt
( )
(0 )
1
t
0
	
(2.16)
Hence, for an inductor with a finite voltage (realistic case), we have (as for a spring)
	
=
+
−
i
i
(0 )
(0 )	
(2.17)
Through these results, we can state the following facts:
	
1.	An inductor is an energy storage element. It stores electromagnetic energy.
	
2.	The current through an inductor element cannot change instantaneously unless 
an infinite voltage is applied to it (not practical). In other words, a finite ­voltage 
cannot cause a step change in current in an inductor element. Conversely, a finite 
instantaneous (step) change in current in a spring will need an infinite voltage 
input (which is not realistic). Hence, current i is a natural output (or response) 
variable for an inductor element, which can represent its dynamic state (i.e., state 
variable), and voltage v is a natural input variable for an ­inductor element.
	
3.	The fact that current is most appropriate to represent the “dynamic” state of an induc-
tor element may be justified by several reasons: The first justification is Item 2 above; 
the second, from Equation 2.16, the current of an inductor element at any time t can 
be completely determined with the knowledge of the initial current and the applied 
voltage during the time interval 0 to t (Note: As we will see in Chapter 3, this is the 
formal definition of state); and the third, from Equation 2.15, the energy of an induc-
tor element can be represented by the variable i alone (electromagnetic energy).
	
4.	Since its state variable (current) is a through-variable, an inductor is a T-type 
element.

34
Modeling of Dynamic Systems with Engineering Applications
2.3.3  Resistor (Dissipation) Element
Consider the resistor element shown in Figure 2.2c. It is a D-type element (energy dissipat-
ing element). The constitutive equation (physical law) is the well-known Ohm’s law:
	
=
v
Ri	
(2.18)
Here, R is the resistance of the resistor. Equation 2.18 is an algebraic equation. Hence, either 
v or i can serve as the natural output variable for a resistor, and either one can determine 
its dynamic state. However, since the state variables v and i are established by the indepen-
dent capacitor elements and independent inductor elements of the system, a resistor will 
not introduce a new state variable.
In summary:
	
1.	An electrical resistor is an energy dissipating element (D-Type Element).
	
2.	Either current i or voltage v may represent its state.
	
3.	No new state variable is introduced by a resistor element.
2.4  Fluid Elements
In a fluid component, pressure (P) is the across-variable and the volume flow rate (Q) is the 
through-variable. The three basic fluid elements are shown in Figure 2.3 and discussed 
below. Note the following:
	
1.	The elements are usually distributed, but lumped-parameter approximations are 
used here.
	
2.	The elements are usually nonlinear (particularly, the fluid resistor), but linear 
models are used here.
The input elements (or source elements) of a fluid system are the pressure source, where its 
pressure is the independent variable, which is not affected by the changes in the system 
(while the associated flow rate variable—the dependent variable—will be affected); and 
the flow source, where its flow rate is the independent variable, which is not affected by the 
changes in the system (while the associated pressure variable—the dependent variable—
will be affected).
Q
P1
P2
P = P2 – P1
f
dP
Q
C dt
=
(a)
(b)
(c)
P2
P1
Q
f
dQ
P
I
dt
=
Q
P2
P1
P = Rf Q
FIGURE 2.3
Basic fluid elements: (a) capacitor; (b) inertor; and (c) resistor.

35
Basic Model Elements
2.4.1  Fluid Capacitor or Accumulator (A-Type Element)
Consider a rigid container with a single inlet through which fluid is pumped in at the vol-
ume flow rate Q, as shown in Figure 2.3a. The pressure inside the container with respect to 
the outside is P. We can write the linear constitutive equation
	
=
C dP
dt
Q
f
	
(2.19)
Here, Cf = fluid capacitance (capacity). Several special cases of fluid capacitor will be 
­discussed later.
A fluid capacitor stores potential energy, given by 
C P
1
2
f
2. Hence, this element is like 
a fluid spring. However, it is an A-type element, and the appropriate state variable is the 
pressure difference (across-variable) P. Contrast here that the mechanical spring is a T-type 
element.
2.4.2  Fluid Inertor (T-Type Element)
A fluid inertor is sometimes called a fluid “inductor” in view of its analogy to an electric 
inductor. Consider a conduit carrying an accelerating flow of fluid, as shown in Figure 2.3b. 
The associated linear constitutive equation can be written as follows:
	
=
I dQ
dt
P
f
	
(2.20)
Here, If = fluid inertance. It should be clear that this parameter represents fluid inertia (not 
fluid spring) yet it is analogous to electrical inductance or mechanical spring.
To explain further, a fluid inertor stores kinetic energy, given by 
I Q
1
2
f
2. Hence, this 
element is a fluid inertia. The appropriate state variable is the volume flow rate (through-
variable) Q. Hence, fluid inertor is a T-type element, just like an electrical inductor or 
mechanical spring. Contrast here that mechanical inertia is an A-type element.
Energy exchange between a fluid capacitor and a fluid inertor leads to oscillations (e.g., 
water hammer) in fluid systems, analogous to oscillations in mechanical and electrical 
systems.
2.4.3  Fluid Resistor (D-Type Element)
Consider the flow of fluid through a narrow element such as a thin pipe, orifice, or valve. 
The associated flow will result in energy dissipation due to fluid friction. The linear con-
stitutive equation is (see Figure 2.3c)
	
=
P
R Q
f
	
(2.21)
Here, 
=
R
fluid resistance
f
.

36
Modeling of Dynamic Systems with Engineering Applications
2.4.4  Derivation of Constitutive Equations
We now indicate the derivation of the constitutive equations for fluid elements.
	
1.	Fluid Capacitor
	
	 The capacitance in a fluid element may originate from
	
a.	 Bulk modulus (compressibility) effect of liquids
	
b.	 Compressibility effect of gases
	
c.	 Flexibility of the fluid container
	
d.	 Gravity head of a fluid column.
	
	 The derivation of the associated constitutive equations is outlined next.
(a)	 Capacitance Due to Liquid Compressibility (Bulk Modulus)
	
	 Consider a rigid container. A liquid is pumped in at the volume flow rate Q. An 
increase of the pressure in the container will compress the liquid volume, thereby 
letting in more liquid (see Figure 2.4a). From calculus, we have
	
= ∂
∂
dP
dt
P
V
dV
dt
Here, V is the control volume of liquid. The volume flow rate (into the container) 
is given by
	
= −
Q
dV
dt  
.
Note: The liquid volume V has to decrease (i.e., a negative increase) for a flow into 
the ­container (positive) to take place.
The bulk modulus of liquid is defined by
	
β
∆
∆
= −
= −
∂
∂
∆
→
P
V V
V
P
V
lim
/
V
0
	
(2.22)
Note: When the pressure increases, the liquid volume decreases. Hence, the 
­negative sign in this expression.
P1
(a)
(b)
(c)
P2
P = P2 –P1
V
P2
A
Q
Q
P1
k
x0
x
Q
A
P1
P2
h
FIGURE 2.4
Three types of fluid capacitor: (a) compressible fluid (liquid bulk modulus or gas compressibility); (b) flexible 
container; and (c) liquid column with gravity head.

37
Basic Model Elements
	
Or,
 
β = −
=
V dP
dt
dV
dt
V dP
dt
Q
Hence
	
β
=
V dP
dt
Q
	
(2.23)
The associated fluid capacitance is
	
β
=
C
V
bulk
	
(2.24)
(b)	 Capacitance due to Gas Compressibility
A perfect (ideal) gas is governed by the gas law:
	
=
PV
nRT	
(2.25a)
Here
P = pressure (in units of pascals: 1 Pa = 1 N/m2)
V = volume (in units of m3)
T = absolute temperature (in units of K or Kelvin)
=
=
n
Mass of gas (kg)
Molecular mass of the gas (kg)
number of moles  of gas in the volume
“
”
R = 8.3145 J/mol/K = universal gas constant (same value for any ideal gas)
Note: 1 J = 1 joule = 1 Nm; 1 kJ = 1000 J
Equation 2.25a can also be expressed as follows:
	
=
PV
mR T
sp 	
(2.25b)
Here
m = mass of the volume of gas (kg)
Rsp = specific (or individual) gas constant (J/kg/K).
By comparing Equations 2.25a and 2.25b and using the definition of n, it is easy to 
see that
	
=
R
R
Molecular mass of the gas
sp
For example, for oxygen, whose molecular mass is 32 g = 32 × 10−3 kg, the specific gas 
­constant is

38
Modeling of Dynamic Systems with Engineering Applications
	
=
×
=
−
R
8.3145
32
10
259.8J/kg/K
sp
3
Note: Clearly, the specific gas constant depends on the molecular mass of the gas, and 
hence varies from gas to gas. The specific gas constants of some common gas are given in 
Table 2.1.
Isothermal Case: Consider a slow flow of gas into a rigid container (see Figure 2.4a) so 
that the heat transfer is allowed to maintain the temperature constant (i.e., isothermal con-
dition). Differentiate Equation 2.25 keeping T constant (i.e., RHS is constant):
	
+
=
P dV
dt
V dP
dt
0
In the case of a liquid in a rigid container, 
	
= −
Q
dV
dt
.
Substitute this and Equation 2.25b into the above equation. We obtain
	
=
=
V
P
dP
dt
mR T
P
dP
dt
Q
sp
2
	
(2.26)
TABLE 2.1
Specific Gas Constants of Common Gases
Gas
Specific Gas Constant Rsp (J/kg/K)
Molecular Mass (kg)
Air
286.9
×
−
29
10 3
Argon
208
×
−
40
10 3
Ammonia
488
×
−
17
10 3
Carbon dioxide
188.9
×
−
44
10 3
Carbon monoxide
297
×
−
28
10 3
Helium
2077
×
−
4
10 3
Hydrogen
4154
×
−
2
10 3
Methane
518.3
×
−
16
10 3
Nitrogen
296.8
×
−
28
10 3
Oxygen
259.8
×
−
32
10 3
Propane
189
×
−
44
10 3
Sulfur dioxide
130
×
−
64
10 3
Water vapor
461.5
×
−
18
10 3

39
Basic Model Elements
Hence, the corresponding fluid capacitance is given by
	
=
=
C
V
P
mR T
P
comp
sp
2
	
(2.27)
Adiabatic Case: Consider a fast flow of gas (see Figure 2.4a) into a rigid (and possibly 
­thermally insulated) container so that there is no time (or possibility) for heat transfer 
(Note: Adiabatic ⇒ zero heat transfer). The associated gas law is known to be
	
=
=
PV
c
k
c
c
 with 
/
k
P
V	
(2.28)
Here
	
cp = specific heat when the pressure is maintained constant
	
cv = specific heat when the volume is maintained constant
	
c = constant
	
k = ratio of specific heats
Note: Specific heat = amount of heat transfer that results in a unity change in tempera-
ture in an object of unity mass.
Differentiate Equation 2.28
	
+
=
−
PkV
dV
dt
V dP
dt
0
k
k
1
Divide by Vk
	
+
=
Pk
V
dV
dt
dP
dt
0
Now use 
= −
Q
dV
dt  as usual, and also substitute Equation 2.25:
	
=
=
V
kP
dP
dt
mR T
kP
dP
dt
Q
sp
2
	
(2.29)
The corresponding fluid capacitance is
	
=
=
C
V
kP
mR T
kP
comp
sp
2 	
(2.30)
	
(c)	
Effect of Flexible Container
	
	
Without loss of generality, consider a cylinder of cross-sectional area A with a 
spring-loaded wall (of stiffness k), as shown in Figure 2.4b. As a fluid (assumed 
incompressible, but this can be relaxed, as noted later) is pumped into the 
­cylinder, the flexible wall will move through x.

40
Modeling of Dynamic Systems with Engineering Applications
	
=
+
=
Q
d A x
x
dt
A dx
dt
Conservation of flow:
( (
))
0
	
(i)
	
−
=
=
A P
P
kx
x
A
k P
Equilibrium of spring:
(
)
or
2
1
	
(ii)
Note: P2 = interior pressure (of the fluid); P1 = exterior (ambient) pressure; and x0 = length of 
the cylinder interior when P2 = P1
Substituting (ii) in (i), we obtain
	
=
A
k
dP
dt
Q
2
	
(2.31)
The corresponding capacitance is
	
=
C
A
k
flex
2
	
(2.32)
Note: For an elastic container and a liquid having bulk modulus, the combined capacitance 
will be additive:
	
=
+
C
C
C
eq
bulk
flex
This is true because the pressure difference P is the same with respect to the change in the 
fluid and container volumes, while the volume flow rates due to the two effects are addi-
tive. In other words, the capacitors of the two cases are connected in parallel, and hence 
the capacitances are additive.
A similar result holds for a compressible gas and a flexible container; i.e., 
=
+
C
C
C
eq
comp
flex
Example 2.1
A container that carries a liquid has flexible walls. The wall flexibility is not uniform 
and can be represented as in Figure 2.5, where there are three segments with area Ai  
Q
k1
P
A1
A3
A2
k2
k3
FIGURE 2.5
Model of a flexible container of liquid.

41
Basic Model Elements
and stiffness 
=
k i,
1,2,3
i
. Liquid can enter the container through its opening at the 
­volume flow rate Q. The internal pressure in the container is assumed uniform at P 
with respect to the ambient pressure.
(a)	 Derive an expression for the fluid capacitance of the container 
­(disregarding the compressibility of the liquid or assuming the liquid to be 
incompressible).
	
Note: Capacitance due to liquid compressibility can be incorporated separately 
(this corresponds to a parallel connection of the two capacitor elements, one for 
the container flexibility and the other for the liquid compressibility).
(b)	 Discuss why the present model (of three area segments) cannot be generalized 
to a case with a large number of area segments with different flexibilities.
Solution
(a)	 Suppose that when the springs are not compressed (i.e., when the outside pres-
sure = inside pressure, where 
=
P
0) the volume of the liquid in the container is 
V0. As more liquid enters the container, the inside pressure rises and the three 
walls deflect through x1, x2, and x3.
The new volume of the liquid is
	
∑
=
+
+
+
=
+
=
V
V
A x
A x
A x
V
A x
i
i
i
0
1
1
2
2
3
3
0
1
3
	
(i)
Also, force balance for each wall gives (this neglects the wall weight or assumes that the 
forces are horizontal)
	
=
=
=
PA
k x
PA
k x
PA
k x
;
;
1
1
1
2
2
2
3
3
3
or
	
=
=
PA
k x
i
,
1,2,3
i
i
i
	
(ii)
Differentiate (i) w.r.t. time
	





∑
=
=
+
+
=
=
V
Q
A x
A x
A x
A x
i
i
i
1
1
2
2
3
3
1
3
Differentiate (ii) and substitute
	




=
+
+
=
+
+




Q
A
k
P
A
k
P
A
k
P
A
k
A
k
A
k
P
1
2
1
2
2
2
3
2
3
1
2
1
2
2
2
3
2
3
Hence, the equivalent fluid capacitance is
	
∑
=
+
+
=
=
C
A
k
A
k
A
k
A
k
flex
i
i
i
1
2
1
2
2
2
3
2
3
2
1
3

42
Modeling of Dynamic Systems with Engineering Applications
	 (b)	 This result “cannot” be generalized as 
∑
=
=
C
A
k
flex
i
i
i
n
2
1
 for large n and continuous 
wall.
	
One reason is that the wall segments are interconnected and are not inde-
pendent unlike the three-segment model in Figure 2.5. Hence, the stiffness 
values of the different segments are not independent. Also, the force balance 
­equations for the different segments are not independent.
■
	 (d)	 Gravity Head of a Fluid Column
	
Consider a uniform liquid column (uniform tank) having area of cross-section 
A, height h, and mass density ρ, as shown in Figure 2.4c. A liquid is pumped 
into the tank at the volume rate Q. As a result, the liquid level rises.
	
Relative pressure (w.r.t. the ambience) at the foot of the column 
ρ
=
−
=
P
P
P
gh
2
1
 
or 
ρ
=




dP
dt
g dh
dt
	
=
=
Q
d Ah
dt
A dh
dt
Flow rate:
(
)
Direct substitution gives
	
ρ
=
A
g
dP
dt
Q
	
(2.33)
The corresponding capacitance is
	
ρ
=
C
A
g
grav
	
(2.34)
	
2.	Fluid Inertor
First assume an “ideal” flow of fluid in a conduit, with a uniform velocity 
­distribution across it. Along a “small” element of length Δx of fluid, as shown 
in Figure 2.6, the pressure difference is 
−
=
P
P
P
2
1
, and the volume flow rate is Q 
(neglect the change ΔQ, over small distance Δx).
	
Mass density of the fluid = ρ
	
Area of cross-section f the tank = A
	
Mass of the fluid element = ρAΔx
	
Net force in the direction of flow = PA
	
Velocity of flow (assumed uniform) = Q/A
P2
P1
Q
Q + ∆Q
∆x
FIGURE 2.6
A fluid flow element.

43
Basic Model Elements
Note: Since the fluid element (small), over its length in the conduit is uniform è A 
is constant.
	
= A
dQ
dt
Fluid acceleration
1
From Newton’s second law
	
ρ
∆
=
PA
A x A
dQ
dt
(
) 1
or
	
ρ∆
=
x
A
dQ
dt
P
	
(2.35)
Hence
	
ρ∆
=
I
x
A
Fluid inertance f
	
(2.36a)
Using this result (applicable to a small element), for a nonuniform conduit with the area of 
cross-section A = A(x) and length L, we can express the inertance as follows: 
	
∫
ρ
=
I
A x dx
( )
f
L
0
	
(2.36b)
In a general (nonideal) flow, the velocity profile in a cross-section is not uniform, and a 
boundary layer may be present. The fluid velocity will be zero at the wall of the conduit, 
and will increase over the boundary layer. Then, we can modify the result (Equation 2.36a) 
as follows:
	
α ρ∆
=
I
x
A
f
	
(2.36)
Here, α is a correction factor.
Note: It should be that α > 1 in general. To verify this, note that the flow rate Q that is 
used in the constitutive equation of an inertor corresponds to the average velocity (as 
given by Q/A) which is equal to the actual velocity only if the velocity profile (across the 
conduit) is uniform. The actual inertia force is governed by the local velocity (strictly, 
local acceleration) which is not uniform. In fact in the core of the fluid flow, it is quite 
higher than the average value. Hence, the I f that assumes uniform velocity should be 
corrected up.
It can be shown that for a conduit of circular cross-section and a parabolic velocity pro-
file (a case of laminar flow, the opposite of turbulent flow), the inertance is given by
	
ρ∆
=
I
x
A
2
f
	
(2.36c)

44
Modeling of Dynamic Systems with Engineering Applications
Laminar Flow: This corresponds to low-velocity, high-viscosity flow where the flowing 
fluid moves in smooth and continuous layers that slide over one another. In fact, this is the 
case of low Reynolds number (Re), which is given by
	
υ
ρ
µ
=
=
vL
vL
Re
	
(2.37)
Here
	
L = length of the pipe segment
	
ρ = absolute viscosity of the fluid (dynamic viscosity)
	
υ
µ
ρ
=
=
/
kinematic viscosity
	
v = fluid velocity along the pipe.
Note: Fluid stress = µ dv
dy , where du
dy is the velocity gradient across the pipe, and it
governs the viscous force in the fluid.
	
3.	Fluid Resistor
	
(a)	
Laminar Flow
	
	
For the ideal case of viscous, laminar flow, we have the linear relationship for 
a fluid resistor (Figure 2.3c)
	
=
P
R Q
f
	
(2.38)
The fluid resistance given by
µ
π
=
R
L
d
128
f
4  for a circular pipe of diameter d
µ
=
R
L
wb
12
f
3  with b = w for a pipe of rectangular cross-section of width w and height b.
Here
	
L = length of the pipe segment
	
μ = absolute (dynamic) viscosity of the fluid.
	
(b)	
Turbulent Flow
	
	 For turbulent flow (i.e., high Reynolds number flow), the resistance ­equation 
will be nonlinear, and is given by
	
=
P
K Q
R
n	
(2.39)
2.5  Thermal Elements
For a thermal element, temperature (T) is the across-variable, as it is measured with respect 
to some reference (e.g., ambient temperature) or as a temperature difference across an ele-
ment, and heat transfer (flow) rate (Q) is the through-variable. Heat source and temperature 

45
Basic Model Elements
source are the two types of source elements (input elements) in a thermal system. However, 
heat source is much more common than temperature source. A temperature source may 
correspond to a large reservoir whose temperature is hardly affected by heat transfer into 
or out of it.
There is only one type of energy (thermal energy) in a thermal system. The corresponding 
energy storage element is a thermal capacitor with the associated state variable, ­temperature. 
Hence, this is an A-type element. There is no T-type element in a thermal ­system (i.e., there are 
no thermal inductors). As a direct consequence of the absence of two different types of energy 
storage elements (unlike the case of mechanical, electrical, and fluid systems), a pure thermal 
system cannot exhibit natural oscillations. It can exhibit “forced” oscillations, however, when 
excited by an oscillatory input source or if it is ­coupled with a system in another domain (e.g., 
a fluid system resulting in a thermo-fluid system) that can oscillate.
Constitutive Equations
The constitutive equations in a thermal system are the physical equations for thermal capac-
itors (A-type elements) and thermal resistors (D-type elements). There are no T-type thermal 
elements. The constitutive equations of the basic thermal elements are discussed now.
2.5.1  Thermal Capacitor
A thermal capacitor has the “capacity” to store thermal energy. Consider a control volume 
of an object with various heat transfer processes Qi taking place at the boundary of the 
object (see Figure 2.7). The amount of thermal energy in the object = ρVcT, where
	
T = temperature of the object (assumed uniform)
	
V = volume of the object
	
ρ = mass density of the object
	
c = specific heat of the object.
Note: Specific heat = amount of heat transfer that results in a unity change in temperature 
in an object of unity mass.
Since the net heat inflow (transfer) is equal to the rate of change (increase) of thermal 
energy, the associated constitutive relation is
	
∑
ρ
=
Q
Vc dT
dt
i
	
(2.40)
It is assumed that ρVc is constant. We write the result (Equation 2.40) as follows:
	
=
C dT
dt
Q
h
	
(2.41)
V
c
Q1
Q4
Q3
Q2
ρ
FIGURE 2.7 
A control volume representing a thermal capacitor.

46
Modeling of Dynamic Systems with Engineering Applications
Here, 
ρ
=
=
C
Vc
mc
h
 = thermal capacitance; with m = ρV = mass of the element.
2.5.2  Thermal Resistor
A thermal resistor provides resistance to heat transfer in a body or a medium. There are 
three general types of thermal resistance:
•	 Conduction
•	 Convection
•	 Radiation
We now give the constitutive relations for each of the three types of thermal resistors.
	 (a)	 Conduction
	
	 In the conduction heat transfer in a medium, the molecules of the medium itself 
do not move to carry the thermal energy (heat) from one place to another. Instead, 
heat transfer takes place due to collision of adjoining microscopic particles and 
associated energy transfer (e.g., change in the spinning speed of electrons). 
Conduction heat transfer takes place from a point of higher temperature to one of 
lower temperature. Specifically, heat conduction rate is proportional to the nega-
tive temperature gradient, and is given by the Fourier equation:
	
= −
∂
∂
Q
kA T
x 	
(2.42a)
Here
	
x = direction of heat transfer
	
A = area of cross-section of the path (element) of heat transfer
	
k = thermal conductivity
The (Fourier) Equation 2.42 is a “local” equation. If we consider a finite object of 
length Δx and area of cross-section A, with temperatures T2 and T1 at the two 
ends, as shown in Figure 2.8a, the one-dimensional heat transfer rate Q can be 
written according to Equation 2.42 as follows:
	
∆
∆
=
−
=
Q
kA T
T
x
kA
x T
(
)
2
1
	
(2.42b)
Here 
=
−
T
T
T
2
1 = temperature drop along the element. Or
	
=
T
R Q
k
	
(2.42)
with
	
∆
=
=
R
x
kA
 conductive thermal resistance
k
	
(2.43)
	
	 Nominal thermal conductivities of some useful material are given in Table 2.2.

47
Basic Model Elements
(a)
(b)
(c)
A
∆x
Q
T2
T1
Wall
Fluid
Q
A
Tf
Tw
Receiver
T1, A
Source
T2
Vacuum
FIGURE 2.8 
Three types of thermal resistance: (a) an element of 1D heat conduction; (b) a control volume for heat transfer by 
convection; and (c) heat transfer by radiation.
TABLE 2.2
Thermal Conductivities of Some Materials (at 25°C)
Material
Thermal Conductivity (W/m/°C)
Acrylic
0.2
Air
0.025
Aluminum
210
Asphalt
0.75
Bitumen
0.17
Brass, bronze
110
Brick
0.75
Cast iron
58
Cement, mortar
1.7
Chalk
0.09
Coal
0.2
Cobalt
70
Concrete
1.0
Copper
401
Cork
0.07
Glass, Pyrex
1.0
Gold
310
Granite, marble
2.5
Paper
0.05
Rubber
0.07
Silver
430
Steel, structural
43
Steel, stainless
16
Water
0.6
Wood
0.15

48
Modeling of Dynamic Systems with Engineering Applications
	
Three-Dimensional Conduction
	
In general, the conditions (and parameters) of heat transfer will change from 
location to location. Then, we need to introduce one or more space variables as 
independent variables, in addition to time t. In other words, we will need a distrib-
uted-parameter model.
	
	
Equation 2.42a represents a one-dimensional (1D) distributed parameter model, 
with the location x as an independent variable. This is further confirmed by 
the use of the partial derivative ∂
∂
T
x
, giving a “local” condition with respect to 
x. Extending this, conduction heat transfer in a continuous 3D medium is repre-
sented by a distributed-parameter model, with partial derivatives w.r.t. all three 
dimensions. Then, the Fourier equation 2.42a is applicable in each of the three 
orthogonal ­directions (x, y, z). To obtain the corresponding model, we use the 
thermal­ capacitance Equation 2.40 as well.
	
	
Consider the small 3D model element of sides δx, δy, and δz, in a conduction 
medium, as shown in Figure 2.9. Heat transfer into the element through the bot-
tom surface (δx × δy) in the z-direction, according to Equation 2.42a, is: 
δ δ
−
∂
∂
k x y T
z .
	
	
Since the temperature gradient at the top (δx × δy) surface is ∂
∂
+ ∂
∂
T
z
T
z dz
2
2
 (which 
includes the “increment” over the distance δz, from calculus), the heat transfer 
out of this surface is δ δ
δ
∂
∂
+ ∂
∂




k x y
T
z
T
z
z
2
2
. Hence, the net heat transfer into the 
element  in the z-direction is δ δ
δ
∂
∂
k x y
T
z
z
2
2
 or δ δ δ
∂
∂
k x y z
T
z
2
2 . Similarly, the  net 
heat  transfer in the x- and y-directions are δ δ δ
∂
∂
k x y z
T
x
2
2  and δ δ δ
∂
∂
k x y z
T
y
2
2 , 
respectively.
	
	
The thermal energy of the element is ρδ δ δ
x y zcT, where ρδ δ δ
x y z is the mass 
of the ­element and c is the specific heat (at constant pressure). Hence, the capaci-
tance Equation 2.40 gives
	
δ δ δ
ρδ δ δ
∂
∂
+ ∂
∂
+ ∂
∂



=
∂
∂
k x y z
T
x
T
y
T
z
x y zc T
t
2
2
2
2
2
2
x
y
z
δy
δx
δz
FIGURE 2.9
A 3D heat conduction element.

49
Basic Model Elements
	
or
	
α
∂
∂
+ ∂
∂
+ ∂
∂
=
∂
∂
T
x
T
y
T
z
T
t
1
2
2
2
2
2
2
	
(2.44)
	
where α
ρ
= k
c
= thermal diffusivity.
	
Equation 2.44 is called the Laplace equation.
	
	
Note that partial derivatives are applicable because T is a function of many 
independent variables (space x, y, z, and time t); and derivatives with respect to 
each of them would be needed in the model equations. In summary, distributed-­
parameter models in 3D have spatial variables (x, y, z) as well as the temporal 
variable (t) as independent variables, and are represented by partial differential 
equations, not ordinary differential equations.
	 (b)	 Convection
	
In convection, the heat transfer takes place by the physical movement of the heat-­
carrying molecules in the medium (i.e., through mass transfer). An example is 
the case of fluid flowing against a wall, as shown in Figure 2.8b. The constitutive 
equation is
	
=
−
Q
h A T
T
(
)
c
w
f 	
(2.45a)
	
Here
	
Tw = wall temperature
	
Tf = fluid temperature at the wall interface
	
A = area of cross-section of the fluid control volume across which the heat 
transfer Q takes place through mass transfer
	
hc = convection heat transfer coefficient.
	
	
In practice, hc may depend on the temperature itself, and hence Equation 2.45a 
is nonlinear in general. But, by approximating to a linear constitutive equation, 
we can write
	
−
=
T
T
R Q
(
)
w
f
c 	
(2.45b)
	
or
	
=
T
R Q
c 	
(2.45)
	
Here, 
=
−
T
T
T
w
f and
	
=
=
R
h A
1
 convective thermal resistance
c
c
	
(2.46)
	
In natural convection, the particles in the heat transfer medium move naturally 
(e.g., due to change in density). In forced convection, the mass transfer is forced by 
an actuator such as a fan or pump.

50
Modeling of Dynamic Systems with Engineering Applications
Biot Number
Biot number (Bi) is a nondimensional parameter given by the ratio:
	




Conductive resistance
Convective resistance .
Now from Equations 2.43 and 2.46, we obtain
	
∆
=
=
R
R
xh A
kA
Bi
k
c
c
c
k
	
(2.47a)
Here, we have allowed for the general case where the area of cross-section for the conduc-
tion (Ak) may be different from the area of cross-section for the convection (Ac). If the areas 
are equal, we have
	
∆
= h
x
k
Bi
c
	
(2.47b)
The Biot number may be used as the basis for approximating a distributed-parameter 
model for heat transfer (e.g., Equation 2.44) by an appropriate lumped-parameter model. 
Specifically, we divide the continuous conduction medium into slices of thickness Δx and 
use a lumped model for each slice. If for each slice, the Biot number ≤ 0.1 (as a rule of 
thumb), the used lumped-parameter model is adequate for that slice.
Rationale for Using Bi to Guide Lumped-parameter Modeling: The Biot number is 
an index of how the temperature varies within a body (through conduction) as heat is 
supplied into or taken out of the body through its outer surface (through convection). 
Specifically,
	
Smaller Bi è smaller temperature variation è better lumped-model approximation
This may be justified as follows: For a given convective resistance Rc and temperature 
gradient of convection (i.e., for a given heat transfer rate into or out of the body through 
convection), smaller Bi means smaller Rk. This in turn means smaller temperature gradient 
(i.e., smaller temperature variation) for heat transfer in conduction.
Rationale using for Bi the expression 
∆
h
x
k
c
 (Equation 2.47b), which assumes the same 
area for both conductive and convective heat transfer:
	
1.	Smaller ∆x è smaller length for variation in T (while other parameters 
are unchanged) è better accuracy
	
2.	Smaller hc è smaller heat transfer into body (while other parameters are unchanged) 
è smaller variation in T è better accuracy
	
3.	Larger k è smaller resistance to conduction heat transfer in the body (while other 
parameters are unchanged) è smaller variation in T è better accuracy

51
Basic Model Elements
Example 2.2
A heat sink is a heat exchanger that is typically used for cooling electronic devices. 
Generally, it consists of a heat transfer base on which a bank of pins is mounted 
(see  Figure 2.10a). The base of the heat sink is firmly attached to the object whose 
­thermal energy is to be removed in order to avoid consequences of high temperature 
in the object. Air (or some other fluid) is forced across the bank of pins to facilitate the 
heat transfer.
Assume that each pin is a uniform solid cylinder of length ℓ and radius of cross-
section a (see Figure 2.10b). The following variables and parameters are defined:
Th = temperature of the object to be cooled
Tp = average temperature inside a pin
Ta = ambient temperature (of the cross-flow air)
h = convective heat transfer coefficient of the pin surface exposed to air
k = thermal conductivity of a pin
ρ = mass density of a pin
c = specific heat of a pin
(a)	 Obtain a lumped-parameter dynamic model for a single-pin system. What 
are the system inputs?
(b)	 If ℓ = 0.02 m, a = 0.001 m, k = 150 W/m/°C, and h = 30 W/m2/°C, compute 
the appropriate Biot number for the single-pin system. On that basis, is the 
lumped model in Part (a) acceptable?
Cooling air
Heat transfer pins
Heat sink base
Hot body
(solid or fluid)
(a)
Tp
l/2
2a
Ta
Heat transfer
=
=
(b)
k
Th
Heat transfer
h
(c)  
Tp
Th
1 (
)
Qk
Th – Tp
Rk
1 (
Qc
Tp – Ta)
Rc
Ta
(k,
ρ,c)
l
FIGURE 2.10
(a) A heat sink for cooling an object; (b) details of a pin of the heat sink; and (c) heat transfer diagram for a pin.

52
Modeling of Dynamic Systems with Engineering Applications
Solution
(a)
See Figure 2.10c.
Represent the temperature of the pin as the average value Tp at the centroid of the pin 
(Note: This is a common assumption in the modeling of thermal systems).
Conductive heat transfer into a pin (from the object):
	
=
−
Q
R
T
T
1 (
)
k
k
h
p 	
(i)
where
	
R
kA
= conductive thermal resistance = /2
k
k
ℓ
	
(ii)
	
π
A
a
= sectional area of conductive heat transfer = 
k
2	
(iii)
Convective heat transfer from the pin to the ambient air:
	
=
−
Q
R
T
T
1 (
)
c
c
p
a 	
(iv)
where
	
R
hA
= convective thermal resistance = 1
c
c 	
(v)
	
π
π
+
A
a
a
= surface area of conductive heat transfer = 2
c
2
ℓ
	
(vi)
	
π
ρ
=
m
a
Mass of the pin 
p
2ℓ	
(vii)
	
=
C
m c
Thermal capacitance of the pin 
t
p 	
(viii)
Constitutive equation for the pin:
	
=
−
C dT
dt
Q
Q
t
p
k
c	
(ix)
Substitute (i) and (iv) into (ix).
System equation:
	
=
−
−
−
→
= −
+




+
+
C dT
dt
R
T
T
R
T
T
C dT
dt
R
R
T
R T
R T
1 (
)
1 (
)
1
1
1
1
t
p
k
h
p
c
p
a
t
p
k
c
p
k
h
c
a

53
Basic Model Elements
Tp = state variable
Th and Ta are the inputs.
Ct is given by (viii) and (vii).
Rk is given by (ii) and (iii).
Rc is given by (v) and (iv).
(b)
	
π
π
π
=
=
→
=
+
=
+
R
R
hA
kA
lh
al
a
k a
lh
l
a
ka
Biot number Bi
/2
Bi
(2
)
2
(2
)
2
k
c
c
k
2
2
ℓ
Substitute numerical values:
	
=
×
×
×
+
×
×
=
×
×
+
=
<
Bi
0.02
30
(2
0.02
0.001)
2
150
0.001
0.01
5
(2
20
1)
0.082
0.1
	
⇒The lumped model is acceptable.
■
	 (c)	 Radiation
	
	 In radiation, the heat transfer takes place from a higher temperature object (source) 
to a lower temperature object (receiver) through energy radiation, without need-
ing a physical medium between the two objects (unlike in conduction and convec-
tion). This situation is shown in Figure 2.8c. The associated constitutive equation 
is the Stefan–Boltzmann law:
	
σ
=
−
Q
c c A T
T
(
)
e r
s
r
4
4 	
(2.48a)
Here
Ts = temperature of the radiation source
Tr = temperature of the receiver
A = effective (normal) area of the receiver
ce = effective emissivity of the source
cr = shape factor of the receiver
σ = Stefan–Boltzmann constant (=5.7×10−8 W/m2/K4).
The relationship (Equation 2.48a) corresponds to a nonlinear thermal resistor. Heat 
transfer rate is measured in watts (W), the area in square meters (m2), and the 
temperature is in Kelvin (K).
Linearized Radiation Resistor
The nonlinear relation (Equation 2.48a) may be linearized in several ways, as discussed in 
Chapter 4, giving the linear relationship
	
−
=
T
T
R Q
(
)
s
r
r 	
(2.48b)
where Rr = radiation thermal resistance.

54
Modeling of Dynamic Systems with Engineering Applications
For example, in Equation 2.48a, we may use 
−
=
+
+
−
T
T
T
T
T
T
T
T
(
)(
)(
)
s
r
s
r
s
r
s
r
4
4
2
2
. Then, for 
small temperature changes about some operating condition (T T
,
r
s), we may use the 
­following approximate expression for thermal resistance in Equation 2.48b:
	
σ
=
+
+
R
c c A T
T
T
T
1
(
)(
)
r
e r
s
r
s
r
2
2
	
(2.49a)
Note: The over-bar denotes a representative state (operating condition).
2.6  Domain Analogies
Table 2.3 summarizes the linear constitutive relationships that describe the behavior 
of the basic translatory-mechanical, electrical, thermal, and fluid elements. In particu-
lar, the analogy used in Table 2.3 between mechanical and electrical elements is known as 
the force–current analogy, and is given in Table 2.4. This follows from the fact that both force 
and current are through-variables, which do not change through an element. They are 
analogous as well to the fluid flow rate through a pipe and the heat transfer rate through 
a thermal element. Furthermore, both velocity and voltage are across-variables, which are 
measured across an element, with respect to one end, as in the case of fluid pressure along 
a pipe or temperature across a thermal element. This analogy is more logical than a force–
voltage analogy, because the structure of component interconnection is preserved across 
TABLE 2.3
Some Linear Constitutive Relations
Constitutive Relations
System
Energy Storage Elements
Energy Dissipating 
Element
Type
A-Type
(Across) Element
T-Type
(Through) Element
D-Type
(Dissipative) Element
Mechanical (translatory):
v = velocity
f = force
Mass
=
m dv
dt
f
(Newton’s 2nd law)
m = mass
Spring
=
k
df
dt
v
1
(Hooke’s law)
k = stiffness
Viscous damper
=
v
b f
1
b = damping constant
Electrical:
v = voltage
i = current
Capacitor
=
C dv
dt
i
C = capacitance
Inductor
=
L di
dt
v
L = inductance
Resistor
=
v
Ri
R = resistance
Thermal:
T = temperature difference
Q = heat transfer rate
Thermal capacitor
=
C dT
dt
Q
t
Ct = thermal capacitance
None
Thermal resistor
=
T
R Q
t
Rt = thermal resistance
Fluid:
P = pressure
 difference
Q = volume flow rate
Fluid capacitor
=
C dP
dt
Q
f
Cf = fluid capacitance
Fluid inertor (inductor)
=
I dQ
dt
P
f
If = inertance
Fluid resistor
=
P
R Q
f
Rf = fluid resistance

55
Basic Model Elements
domains, through this analogy (i.e., a parallel connection between elements remains a 
parallel connection across domains, and a series connection between elements remains a 
series connection across domains). The correspondence between the parameter pairs given 
in Table 2.4 follows from the constitutive relations given in Table 2.3. A rotational (rotatory) 
mechanical element possesses constitutive relations between torque and angular velocity, 
which can be treated as a generalized force and a generalized velocity, respectively. Hence, 
a separate entry is not needed in Table 2.3 for rotatory mechanical elements.
2.6.1  Natural Oscillations
Mechanical systems can produce natural (free) oscillatory responses (or, free vibrations) 
because they can possess two types of energy (kinetic and potential energies).When one 
type of stored energy is converted into the other type repeatedly and naturally, back and 
forth, the resulting response is a free oscillation. Of course, in practice, some of the energy 
will dissipate (through the dissipative mechanism of a D-type element or damper) and the 
free natural oscillations will decay as a result. Similarly, electrical circuits and fluid systems 
can exhibit free, natural oscillatory responses due to the presence of two distinct types of 
energy storage mechanism, where energy can “flow” back and forth repeatedly between 
the two types of elements. But, thermal systems have only one type of energy storage ele-
ment (A-type) with only one type of energy (thermal energy). Hence, purely thermal sys-
tems cannot produce natural oscillations. Oscillations are possible, however, when forced 
by external means, or integrated with other types of systems that can produce natural oscil-
lations (e.g., integrating with a fluid system resulting in a thermo-fluid system).
Summary Sheet
Lumped Elements: Energy storage elements, energy dissipation elements, input 
elements
Across-Variable: Measured across an element (e.g., velocity, voltage, pressure, and 
temperature)
Through-Variable: Passes through an element, unaltered (e.g., force, current, fluid 
flow rate, and heat transfer rate)
A-Type Element: An element whose state variable is an across-variable (e.g., mass, 
electric capacitor, fluid capacitor, and thermal capacitor)
TABLE 2.4
Force-Current Analogy
System Type
Mechanical
Electrical
System-response variables:
Through-variable
Force f
Current i
Across-variable
Velocity v
Voltage v
System parameters
M
C
1/k
L
1/b
R

56
Modeling of Dynamic Systems with Engineering Applications
T-Type Element: An element whose state variable is a through-variable (e.g., spring, 
inductor, and fluid inertor/inductor). There is no thermal T-type element
D-Type Element: An energy dissipating element. It does not introduce a state ­variable. 
State variables are introduced by independent A-type and T-type elements
A-Type Source: An input element whose independent variable is an across-variable 
(e.g., velocity source, voltage source, pressure source, temperature source). Note: 
The independent variable of a source is not be affected by system dynamics
T-Type Source: An input element whose independent variable is a through-variable 
(e.g., force source, current source, flow source, heat transfer source)
Mass (Inertia) Element: State is velocity v; constitutive equation
∫
=
→
=
+
−
−
m dv
dt
f
v t
v
m
f dt
( )
(0 )
1
;
t
0
 
=
E
mv
kinetic energy
1
2
;
2  v cannot change
 instantaneously
Spring (Stiffness) Element: State is force f; constitutive equation
∫
=
→
=
+
−
−
df
dt
kv
f t
f
k
v dt
( )
(0 )
;
t
0
 potential (elastic) energy =
E
f
k
1
2
;
2
 f cannot
 change instantaneously
Damping (Dissipation) Element: 
=
f
bv; no new state variables are introduced
Electric Capacitor: State is voltage v; constitutive equation 
= →
C dv
dt
i
v t( )
∫
=
+
−
−
v
C
idt
(0 )
1
;
t
0
Electrostatic energy =
E
Cv
1
2
;
2  v cannot change instantaneously
Electric Inductor: State is current i; constitutive equation 
=
→
L di
dt
v
i t( )
∫
=
+
−
−
i
L
v dt
(0 )
1
;
t
0
Electromagnetic energy =
E
Li
1
2
;
2  i cannot change instantaneously
Electric Resistor: =
v
Ri; no new state variables are introduced
Fluid Capacitor or Accumulator (A-Type Element): 
=
C dP
dt
Q;
f
 capacitance due to: 
(a) liquid bulk modulus (β): 
β
=
C
V ;
bulk
 (b) gas compressibility effect: isothermal 
=
=
C
V
P
mR T
P
;
comp
sp
2
 adiabatic 
=
=
C
V
kP
mR T
kP
comp
sp
2  with ratio of specific heats at 
­constant pressure to constant volume =
k
c
c
/
P
V; (c) container flexibility (stiffness 
k, area A): 
=
C
A
k ;
flex
2
 and (d) liquid gravity head (liquid column area A, mass den-
sity ρ): 
ρ
=
C
A
g
grav

57
Basic Model Elements
Fluid Inertor or Fluid Inductor: 
=
I dQ
dt
P,
f
 inertance: 
∫
ρ
=
I
A x dx
( )
,
f
L
0
 
α ρ∆
=
I
x
A ,
f
 α = 2 for laminar flow with parabolic 
velocity profile; Reynolds number 
υ
ρ
µ
=
=
vL
vL
Re
, μ = absolute viscosity of fluid 
(dynamic viscosity), υ
µ
ρ
=
 = kinematic viscosity, v = fluid velocity along the pipe
Fluid Resistor: 
=
P
R Q
f
, for viscous, laminar flow: 
µ
π
=
R
L
d
128
f
4  for a circular pipe
	
of diameter d and length L, 
µ
=
R
L
wb
12
,
f
3  with b
w
≪
 for a pipe of ­rectangular
	
cross-section of width w and height b; for turbulent flow (i.e., high Re flow) =
P
K Q
R
n
Thermal Capacitor: 
=
C dT
dt
Q,
h
 thermal capacitance 
ρ
=
=
C
Vc
mc,
h
 c = specific heat
Thermal Resistor: Conduction 
= −
∂
∂
Q
kA T
x , conductive resistance 
∆
=
R
x
kA
k
 with 
	
A = path area of X-section, k = thermal conductivity, Δx = conduction length; Laplace 
equation 
α
∂
∂
+ ∂
∂
+ ∂
∂
=
∂
∂
T
x
T
y
T
z
T
t
1
,
2
2
2
2
2
2
 α
ρ
= k
c = thermal diffusivity; convection
	
=
−
Q
h A T
T
(
)
c
w
f
 with hc = convection heat transfer coefficient, convective
	
­resistance 
=
R
h A
1
c
c
Biot Number: 
∆
=
=
R
R
xh A
kA
Bi
;
k
c
c
c
k
 
∆
= h
x
k
Bi
c
 if 
=
A
A
c
k; for lumped-parameter
	
approximation, we need Bi ≤ 0.1
Radiation: 
σ
(
)
=
−
Q
c c A T
T
e r
s
r
4
4 , Ts = source temperature, Tr = receiver ­temperature, 
A= effective (normal) area of receiver, ce = effective emissivity of source, cr = 
shape factor of receiver, σ = Stefan–Boltzmann constant (=5.7  ×  10−8 W/m2/K4);
	
­linearized radiation resistance 
σ
=
+
+
R
c c A T
T
T
T
1
(
)(
)
r
e r
s
r
s
r
2
2
 or 
=
R
KT
1
4
r
0
3  with 
σ
=
K
c c A
e r
Natural Oscillations: Need two different types of energy storage elements (A-type 
and T-type). Thermal systems have A-type only.
Problems
	 2.1
	
(a)	
Briefly explain/justify why: (i) voltage and not current is the natural state vari-
able for an electrical capacitor; and (ii) current and not voltage is the natural 
state variable for an electrical inductor.

58
Modeling of Dynamic Systems with Engineering Applications
	
(b)	 List several advantages of using as state variables, the across-variables of 
independent A-type energy storage elements and through-variables of inde-
pendent T-type energy storage elements, in the development of a state-space 
model for an engineering system.
2.2	
What are the basic lumped elements of:
	
(i)	 A mechanical system?
	
(ii)	 An electrical system?
2.3
	
(a)	 Why are analogies important in the modeling of dynamic systems?
	
(b)	 In the force–current analogy, what mechanical element corresponds to an 
­electrical capacitor?
	
(c)	 In the velocity–pressure analogy, is the fluid inertia element analogous to the 
mechanical inertia element?
2.4
	
(a)	 What are through-variables in mechanical, electrical, fluid, and thermal 
system?
	
(b)	 What are across-variables in mechanical, electrical, fluid, and thermal systems?
	
(c)	 Can the velocity of a mass changes instantaneously?
	
(d)	 Can the voltage across a capacitor change instantaneously?
	
(e)	 Can the force in a spring change instantaneously?
	
(f)	 Can the current in an inductor change instantaneously?
	
(g)	 Can purely thermal systems oscillate?
2.5
	
	 A spherical thin shell is used as a liquid storage tank. The volume flow rate into 
the rank is Q and the internal pressure (with respect to the ambient ­condition—
atmospheric pressure) is P (see Figure P2.5).
	
The following parameters are given:
	
r = internal radius of the tank
	
b = wall thickness of the tank
	
E = Young’s modulus of the tank material
	
υ = Poisson’s ratio of the tank material
(a)
Flow rate
Q
(b)
b
r
P
Pressure
FIGURE P2.5
(a) Spherical shell for liquid storage; and (b) cross-sectional details.

59
Basic Model Elements
Determine an expression for the fluid capacitance of the tank in terms of the given 
parameters.
Hints:
When the liquid pressure in the tank increases by ∆P, the internal radius of the rank 
increases by ∆
υ ∆
=
−
r
r
Eb
P
(1
)
2
2
.
The volume of a sphere of radius r is 
π
=
V
r
4
3
3.
2.6
	 (a)	 Consider an overhead water storage tank of internal radius R at its base, as shown 
in Figure P2.6a. The inclination of the tank wall (w.r.t. the base) is θ. The outlet 
valve is closed and the inlet valve provides an inflow at the rate Q (volume/s). At 
a given instant, the water level in the tank is h. Obtain an expression for the fluid 
capacitance C f  at that instant, in terms of h,R,θ, mass density ρ of water, and accel-
eration due to gravity (g).
Note: C f  varies with h.
Hint:
Gage pressure (w.r.t. the atmosphere pressure) of water at the tank base 
ρ
=
P
gh
Let r = radius of the water surface (at height h)
If a water volume (incremental) δV enters the tank, the water level will rise by δh. 
Then,
	
δ
π
δ
=
⋅
V
r
h
2
Divide throughout by the incremental time δt
	
δ
δ
π
δ
δ
π
⇒
=
⇒
=
V
t
r
h
t
dV
dt
r dh
dt
2
2
	 (b)	 From your result in Part (b), show that for a cylindrical tank 
θ
π
=




i.e.,
2  of
	
	 constant X-sectional radius R (see Figure P2.6b), we have the standard result
(a)  
Q
θ
R
h
Closed
(b)
Q
R
h
Closed
FIGURE P2.6
(a) Conical water tank with water level h and (b) cylindrical water tank with water level h.

60
Modeling of Dynamic Systems with Engineering Applications
	
π
ρ
ρ
=
=
=
C
R
g
A
g
constant
f
2
	
Note: A = constant area of X-section of the tank
2.7
	
(a)	 Suppose that the volume V of a fluid is a nonlinear function V P
( ) of its pres-
sure P. Show that its fluid capacitance C f is given by 
=
C
dV
dP
f
 which itself is a 
function of P.
	
(b)	 Using this, verify the result obtained in Problem 2.6, Part (b).
2.8
	
	 A cylindrical thin shell is used as a liquid storage tank. The volume flow rate into 
the tank is Q and the internal pressure of the cylinder (with respect to the ambient 
condition—external pressure) is P. The tank has a middle uniform segment and 
two hemispherical ends (see Figure P2.8).
	
The following parameters are given:
	
L = length of the uniform middle segment of the tank
	
r = internal radius of the end hemispheres (and the middle segment) of the tank
	
b = wall thickness of the tank
	
E = Young’s modulus of the tank material
	
υ = Poisson’s ratio of the tank material
	
Determine an expression for the fluid capacitance C f of the tank due to the flex-
ibility of its walls, in terms of the given parameters.
	
Hint: when the pressure in the tank increases by ∆P, the internal radius of the tank 
increases by ∆
υ
∆
=
−
r
r
Eb
P
(1
/2)
2
 and the length of the uniform middle segment of 
the 
	
tank increases by ∆
υ ∆
=
−




L
rL
Eb
P
1
2
.
2.9
	
	 In the electro-thermal analogy of thermal systems, where voltage is analogous 
to temperature and current is analogous to heat transfer rate, explain why there 
exists a thermal capacitor but not a thermal inductor. What is a direct consequence 
2r
L
Q
P
b
b
Inlet
Exit valve (closed)
FIGURE P2.8
Sectional details of a thin-shell liquid storage tank.

61
Basic Model Elements
of this fact with regard to the natural (free or unforced) response of a purely 
­thermal system?
2.10
	
	 Consider a hollow cylinder of length l, inside diameter di, and the outside diameter 
do. If the conductivity of the material is k, what the conductive thermal resistance 
of the cylinder in the radial direction? Figure P2.10 shows the cylinder in which 
the ends are thermally insulated, the inside temperature is uniform at Ti and the 
outside temperature is uniform at To.
2.11
	
	 A uniform metal bar length l and area of X-section A is heated to temperature Tb 
and placed in a thermally insulated compartment with one end exposed to the 
atmosphere of temperature Ta< Tb. This may be considered as a part of heat treat-
ment process.
	
(a)	 Obtain a differential equation (dynamic model) for the subsequent cooling 
process of the bar (see Figure P2.11).
	
	
Also given
ρ = mass density of the bar
cp = specific heat (as constant pressure) of the bar
hc = convective heat transfer coefficient at the end exposed to the atmosphere.
l
di
do
T  hermal
insulation
Termal
insulation
To
Ti
k
FIGURE P2.10
A cylinder conducting heat from the interior to the exterior.
l
Atmosphere
temperature Ta
Area = A
Convective heat
transfer coefficient = hc
Metal bar
temperature Tb
Thermal insulation
FIGURE P2.11
Heated metal bar in an insulated compartment.

62
Modeling of Dynamic Systems with Engineering Applications
	
(b)	
Suppose that the following numerical values are known:
	
=
=
=
l
A
h
0.2m,
1.0cm ,
100.0W/m /°C
c
2
2
	
Conductive heat transfer coefficient =
k
125.0W/m/°C
	
Compute the Biot number Bi for the system.
	
From the result, determine whether the lumped-parameter model obtained in 
Part (a) is acceptable.

63
3
Analytical Modeling
Chapter Highlights
•	 Types of Analytical Models
•	 Properties of Linear Systems (Principle of Superposition, etc.)
•	 Discrete-Time Models
•	 Lumped Model of a Distributed System (Heavy Spring)
•	 Analytical Model Development (Systematic, Unified, and Integrated)
•	 State-Space Models and Input–Output Models
•	 Properties of State-Space Models
•	 Steps for State Model Development
•	 Mechanical, Fluid, and Thermal Examples of State-Space Models
3.1  Introduction
The main focus of the present chapter is the systematic, unified, and integrated develop-
ment of analytical models. In Chapter 1 we identified several types of models, giving par-
ticular attention to practical types of models. In Chapter 2, we presented the basic elements 
(components) in the mechanical, electrical, fluid, and thermal domains and their proper-
ties. In particular, we studied properties of these elements and established proper “state 
variables” for the (energy storage) elements in various physical domains. The properties 
of a dynamic model depend on the constituent basic components and the “structure” in 
which these components are interconnected. It is pertinent that the use of across-variables 
and through-variables to represent the behavior of basic elements (or components) of a 
system (see Chapter 2) is quite advantageous in this regard. This is because these variables 
naturally show the way that the components are interconnected (whether connected in 
parallel or in series). Specifically, 
•	 Components connected in parallel have a common across-variable.
•	 Components connected in series have a common through-variable.

64
Modeling of Dynamic Systems with Engineering Applications
Another advantage that stems from the use of these variables is the retention of structural 
analogy across physical domains. For example, a parallel connection mechanical elements 
will be analogous to a parallel connection (not a series connection) of the corresponding 
electrical elements. 
In the present chapter we concentrate on the integration (interconnection) of elements 
(components) of various physical domains to form analytical models. In particular, state-
space models and input–output models are studied with examples. Prior to that, various 
types of analytical models are identified in a comparative manner. While comparing linear 
models and nonlinear models (more details are found in Chapter 4), some salient proper-
ties of linear models are discussed. Also, some important forms of discrete-time models are 
studied. In the comparison of lumped-parameter models and distributed-parameter mod-
els, some methods of approximating a distributed-parameter model by a lumped-­parameter 
models are presented, specifically through illustrative examples of a heavy spring. 
Since the main focus of the chapter is state-space models, some definitions and key prop-
erties of state-space models are discussed. Integrated into the same discussion are input-
output models. Systematic development of linear lumped-parameter state-space models in 
the four physical domains, mechanical, electrical, fluid, and thermal, is illustrated using 
many examples. 
3.2  Types of Analytical Models
In an analytical model, the response (output) to an applied excitation (input) may be 
expressed in:
	
1.	The time-domain, where the response value is expressed a function of time (i.e., the 
independent variable is time t)
	
2.	The frequency domain, where the amplitude and the phase angle of the response are 
expressed as functions of frequency (i.e., the independent variable is frequency)
The time-domain response generally involves the solution of a set of differential equa-
tions (e.g., state equations). The frequency domain analysis is a special case of the Laplace 
transform analysis (in the Laplace domain) where the independent variable is the Laplace 
variable s. The corresponding analytical model is a set of transfer functions. A transfer 
function is the ratio of the Laplace transform of the output variable divided by the Laplace 
transform of the input variable. In the special case of the frequency domain we have s = jω. 
The subject of frequency domain models is studied in Chapter 6.
In summary, the main types of analytical models considered in the present book are the 
following:
	
1.	Time-domain model: It consists of differential equations whose independent 
variable is with time t. Examples are state state-space model (a set of first-order 
differential equations in time, called state equations) and input–output model 
(input–output differential equations in time)
	
2.	Transfer function model: A transfer function is given by the Laplace transform of 
an output variable divided by the Laplace transform of an input variable. The model 

65
Analytical Modeling
is a set of such transfer functions (algebraic equations with the Laplace variable s 
as the independent variable) for various input–output pairs. This is also an input-
output model
	
3.	Frequency domain model: Frequency transfer function (or frequency response func-
tion) is a special case of Laplace transfer function, where s = jω. The independent 
variable is frequency ω. The corresponding model is a set of frequency transfer 
functions
In considering various types of analytical models it is particularly useful to consider them 
comparatively, in pairs, one type being a special (or approximate) version of the other. 
Typically, the approximate version is easier to analyze and implement. Such pairs of com-
mon model types are listed below.
	
1.	Nonlinear models and linear models
	
2.	Continuous time models and discrete-time models
	
3.	Distributed (continuous) parameter models and lumped-parameter models
	
4.	Time-varying (or non-stationary or non-autonomous) models and time-invariant 
(or stationary or autonomous) models
	
5.	Random (or stochastic or probabilistic) models and deterministic models
Some salient features of these classes of models are indicated in Table 3.1.
Next we consider several key types of systems (models) and explore their characteristics.
TABLE 3.1
Comparison of Different Types of Analytical Dynamic Models
Model Type
Key Properties
Nonlinear
Nonlinear differential equations in time; principle of superposition does not hold
Linear
Linear differential equations in time; principle of superposition holds
Continuous-time
Differential equations in time; time variable is continuously defined; Laplace transform 
produces a transfer function model; Fourier transform produces a frequency transfer 
function model
Discrete-time
Difference equations in time; time variable is defined by discrete values as a sequence of 
time points; z-transform produces a discrete transfer function (z-transform transfer 
function) which is equal to the z-transform of the discrete-time output divided by the 
z-transform of the discrete-time input
Distributed
Partial differential equations in time and space (dependent variables are functions of both 
time and space)
Lumped
Ordinary differential equations (dependent variables are functions of time only, not space)
Time-varying
Differential equations with time-varying coefficients (model parameters vary with time)
Time-invariant
Differential equations with constant coefficients (model parameters are constants)
Stochastic
Stochastic differential equations in time; variables and/or parameters have some 
randomness and are governed by probability distributions; experiments repeated under 
same conditions do not produce identical results in general 
Deterministic
Non-stochastic differential equations in time; there is no randomness in the system 
parameters or variables; experiments repeated under identical conditions produce 
identical results

66
Modeling of Dynamic Systems with Engineering Applications
3.2.1  Properties of Linear Systems
At the outset it is important to emphasize that by “linear system” we mean “linear model” 
(i.e., a system that is represented by a linear model). All practical systems are nonlinear 
to some degree. If the nonlinearity is negligible for the situation that is being considered 
(modeled), the system may be represented by a linear model. Since linear systems/models 
are far easier to handle (analyze, simulate, design, control, etc.) than nonlinear systems/
models, a linear model of the system may be developed (or an available nonlinear model of 
the system may be linearized) for the purpose at hand. A linear model may be valid only 
for a limited range or set of conditions of operation. Linearization of nonlinear systems/
models is treated in Chapter 4. Two key properties that are responsible for the analytical 
convenience of linear systems are outlined next.
Principle of Superposition: All linear systems (linear models) satisfy the principle 
of superposition. Specifically, a system is linear if and only if the principle of super-
position is satisfied. For a multi-input–multi-output (MIMO) system (or, multivariable 
system) this principle states that, if y1 is the output vector (with many components) of 
the system when the input (vector) to the system is u1, and if y2 is the output vector of 
the system when the input vector to the system is u2, then 
y
y
1
1
2
2
α
α
+
 is the output vec-
tor when the input vector is 
u
u
1
1
2
2
α
α
+
, where 
1
α  and 
2
α  are any real constants. This 
property is graphically represented in Figure 3.1a. What is shown is the MIMO case 
where the inputs and outputs both are vectors (having multiple components) and hence 
represented by thick lines. 
Example 3.1
An example illustration of the principle of superposition in an MIMO system is shown 
in Figure 3.1b. Here the system has two (scalar) inputs (u
u
 and 
1
2) and three (scalar) out-
puts y
y
y
, 
, and 
.
1
2
3  First, suppose that only the input u1 is applied. The corresponding 
three outputs are shown in the figure. Next, suppose that only the input u2 is applied. 
The corresponding three outputs are shown as well. Finally, if the linear combination 
u
u
 and 
1
1
2
2
α
α
 of the inputs is applied (where 
1
α  and 
2
α  are arbitrary real constants), 
the corresponding three outputs will have the same linear combination, as shown in 
Figure 3.1b.
▪
Interchangeability in Series Connection: Another important property that is satisfied 
by a linear system is the interchangeability (commutativity) in series connection. This 
is illustrated in Figure 3.1c. What is shown is the case of vector inputs and vector out-
puts (represented by thick lines and bold characteristics). Specifically, sequentially con-
nected linear systems (or subsystems or components or elements) may be interchanged 
without affecting the output of the overall system for a given input. 
Note: Interchangeability in parallel connection is a trivial fact, which is satisfied by 
both linear and nonlinear systems.
3.2.2  Discrete-Time Systems
A discrete-time signal is defined at a sequence of discrete time points. Typically it is 
obtained by discretizing (sampling) an analog signal, which is defined continuously in 
time (see Figure 3.2). Reading (or sampling) an analog signal at discrete time points is not 
the only way to generate a discrete-time signal. For example, a physical switching device 
may be activated in a discrete time sequence to generate discrete-time data. The time 
interval between two successive data points is the sampling period T
∆. In typical practical 

67
Analytical Modeling
(a)
and
(b)
and
Input α1u1 + α2u2 
Output α1y1 + α2y2 
System
Input u1
System
System
Input u2 
Output y1
Output y2
u1
u2
System
u2 = 0
u1 = 0
α1u1
α2u2
y11
y21
y31
y12
y22
y32
System
System
α1y11 + α2y12
α1y21 + α2y22
α1y31 + α2y32
(c)
Input u 
y΄
System A
Output y
System B
Input u 
y˝
System B
Output y 
System A 
FIGURE 3.1
Properties of a linear system: (a) principle of superposition (vector inputs); (b) a two-input example; and (c) 
interchangeability in series connection.
(a)
(b)
Analog
signal
Discrete
(sampled)
signal
Continuous time
Discrete time
FIGURE 3.2
(a) An analog signal and (b) the corresponding discrete-time signal (sampled data).

68
Modeling of Dynamic Systems with Engineering Applications
situations such as digital hardware (or digital computer) the sampling period is a constant. 
The sampling rate fs is the inverse of the sampling period:
	
f
T
1
s
∆
=
	
(3.1)
Z-transform: Consider an analog signal x t( ). If it is sampled at constant the sampling 
period T
∆, we obtain the data sequence:
	
…
…
x
x
x
x x
,
,
,
,
,
k
k
k
0
1
1
{ } {
}
=
+
	
(3.2)
where x
x k
T
(
)
k
∆
=
⋅
. This sequence can be represented by a polynomial function of the 
complex variable z as:
	
X z
x z
k
k
k 0∑
( ) =
−
=
∞
	
(3.3)
Then, X z
( ) is termed the z-transform of the sequence { }
xk .
Difference Equations: In a discrete-time system, the input signals and the output signals 
both are discrete-time sequences. The system equation (discrete-time model) can be repre-
sented by a set of difference equations. These difference equations relate the discrete output 
signals to the discrete input signals of the system. Consider, in particular, a single-input 
single-output (SISO) system. The input is the sequence uk
{ } and the output is the sequence 
yk
{ }. The corresponding discrete-time model may be expressed by the nth order linear 
difference equation:
	


a y
a y
a y
b u
b u
b u
k
k
n
k n
k
k
m
k m
0
1
1
0
1
1
+
+
+
=
+
+
+
−
−
−
−	
(3.4)
It is clear from Equation 3.4 that if the input sequence uk
{ } is known, the output sequence 
yk
{ } can be computed starting with the first n values of the output sequence, which should 
be known. These initial n values are the initial conditions, which are required to determine 
the complete solution of a difference equation. In general, the model parameters ai and bi in 
Equation 3.4 depend on the sampling period T
∆.
Discrete Transfer Function: The discrete-time model (Equation 3.4) may also be repre-
sented by the discrete transfer function:
	


G z
Y z
U z
b
b z
b z
a
a z
a z
m
m
n
n
0
1
1
0
1
1
( )
( )
( )
=
=
+
+
+
+
+
+
−
−
−
−	
(3.5)
This is analogous to representing a linear, input–output differential equation with respect 
to time (i.e., an analog system or input–output model in the time-domain) by a transfer func-
tion (in the Laplace domain or frequency domain).
Aliasing Distortion due to Signal Sampling: Aliasing distortion (or, sampling error) is 
an important consideration when dealing with discrete-time data that are sampled from 
a continuous (analog) signal. Shannon’s sampling theorem is relevant here, which is pre-
sented now.
Sampling Theorem: If a time signal x(t) is sampled at equal time periods of T
∆, no infor-
mation regarding its frequency spectrum X(f) can be obtained for frequencies higher than

69
Analytical Modeling
	
f
T
f
1
2
1
2
c
s
∆
=
=
	
(3.6)
This limiting (cutoff) frequency in the spectrum (of the sampled data) is called the Nyquist 
frequency.
It can be shown signal sampling causes folding of the high-frequency segment of the 
signal frequency spectrum beyond the Nyquist frequency onto the low-frequency seg-
ment of the spectrum. The aliasing error is caused by this spectral folding, as illustrated 
in Figure 3.3. The aliasing error becomes more and more prominent for frequencies of the 
spectrum closer to the Nyquist frequency. In signal analysis, a sufficiently small sample 
step ∆T should be chosen in order to reduce aliasing distortion in the frequency domain, 
depending on the highest frequency of interest in the analyzed signal. This however, 
increases the amount of sampled data, which increases the signal processing time and 
the computer storage requirements (and signal communication time, in a networked sys-
tem), which are undesirable particularly in real-time analysis. It can also result in stability 
problems in numerical computations. The Nyquist sampling criterion requires that the 
sampling rate (1/∆T) for a signal should be at least twice the highest frequency of inter-
est. Instead of making the sampling rate very high, a moderate value that satisfies the 
Nyquist sampling criterion is used in practice, together with an antialiasing filter to remove 
the frequency components in the original signal that would distort the spectrum of the 
computed signal.
Antialiasing Filter: It should be clear from Figure 3.3 that if the original signal was low-
pass, filtered at a cutoff frequency equal to the Nyquist frequency, then the aliasing dis-
tortion caused by sampling would not occur. A filter of this type is called an antialiasing 
filter. Analog hardware filters may be used for this purpose. In practice, it is not possible to 
achieve perfect filtering. Hence, some aliasing could remain even after using an antialias-
ing filter, further reducing the valid frequency range of the computed signal. Typically, 
Folded
high-frequency
spectrum
(a)
Spectral
magnitude
Frequency f  
fc
0
(b)
Spectral
magnitude
Frequency f  
fc
0
Aliasing
fc = Nyquist frequency
Original
spectrum
FIGURE 3.3
Aliasing distortion of a frequency spectrum: (a) original spectrum and (b) distorted spectrum due to aliasing.

70
Modeling of Dynamic Systems with Engineering Applications
the useful frequency limit of a sampled data set is fc/1.28, and the last 20% of the spectral 
points near the Nyquist frequency should be neglected. Hence, typically, the filter cut-
off frequency is chosen to be somewhat lower than the Nyquist frequency, for example, 
f
f
/1.28 (
0.8
)
c
c
≅
. In this case, the computed spectrum is accurate up to the filter cutoff 
frequency 0.8fc and not up to the Nyquist frequency fc.
3.2.3  Lumped Model of a Distributed System
As noted before, lumped-parameter models and distributed-parameter models are two broad 
categories of models for dynamic systems. In a lumped-parameter model, various charac-
teristics of the system are lumped into representative elements located at a discrete set of 
points in a geometric space. The corresponding analytical models are ordinary differential 
equations. Lumped-parameter models are the main focus of the present book. In most 
physical systems, however, the properties (physical parameters such as mass and electri-
cal resistance) are continuously distributed in various components or segments; they have 
distributed-parameter (or continuous) components. To represent system parameters that 
are continuously distributed in space, we need spatial coordinates. 
Since the distributed-parameter dynamic systems have time (t) and space coordinates 
(e.g., x, y, and z) as the independent variables, the corresponding analytical models are par-
tial differential equations with respect to time and space). For analytical convenience, we 
may attempt to approximate such distributed-parameter models into lumped-parameter 
ones. The accuracy of the model can be improved by increasing the number of discrete 
elements in such a model; for example, by using finite element techniques. In view of their 
convenience, lumped-parameter models are more commonly employed than continuous-
parameter models. Furthermore, continuous-parameter elements may be included into 
otherwise lumped-parameter models in order to improve the model accuracy. Next, we 
will address some pertinent issues by considering the example of a heavy spring.
Heavy Spring
A coil spring has a mass, an elastic (spring, flexibility) effect, and an energy dissipation 
characteristic, each of which is distributed over the entire coil. These characteristics are 
distributed phenomena, in general. The distributed mass of the spring has the capacity 
to store kinetic energy by acquiring velocity. Stored kinetic energy can be recovered as 
work done through a process of deceleration. Furthermore, in view of the distributed flex-
ibility of the coil, each small element in the coil has the capacity to store elastic potential 
energy through reversible (elastic) deflection. If the coil was moving in the vertical direc-
tion, there would be changes in gravitational potential energy, but we can disregard this 
in dynamic-response studies if the deflections are measured from the static equilibrium 
position of the system (because in the static equilibrium configuration, the gravitational 
forces are balanced by the elastic forces). The coil will undoubtedly get warmer, make 
creaking noises, and over time will wear out at the joints, clear evidence of its capacity to 
dissipate energy. A further indication of damping is provided by the fact that when the coil 
is pressed and released it will eventually come to rest: the work done by pressing the coil 
is completely dissipated. Even though these effects are distributed in the actual system, a 
discrete or lumped-parameter model is usually sufficient to predict the system response to 
a forcing function. Further approximations are possible under certain circumstances. For 
instance, if the maximum kinetic energy is small in comparison with the maximum elastic 
potential energy in general (particularly true for light stiff coils, and at low frequencies 

71
Analytical Modeling
of oscillation), and if in addition the rate of energy dissipation is relatively small (deter-
mined with respect to the time span of interest), the coil can be modeled by just a discrete 
(lumped) stiffness (spring) element. These are modeling decisions.
In an analytical model, the individual distributed characteristics of inertia, flexibility, 
and dissipation of a heavy spring can be approximated (lumped) by a separate mass ele-
ment, a spring element, and a damper element, which are interconnected in some parallel-
series configuration (structure), thereby producing a lumped-parameter model. Since a 
heavy spring has its mass continuously distributed throughout its body, it has an infi-
nite number of degrees of freedom. A single coordinate cannot represent its motion. But, 
for many practical purposes, a lumped-parameter approximation with just one or two 
lumped masses to represent the inertial characteristics of the spring would be sufficient. 
Such an approximation may be obtained by using one of several approaches. One is the 
energy approach. Another approach is equivalence of natural frequency. We will consider 
the energy approach first. Here we represent a distributed-parameter spring by a lumped-
parameter “model” such that the original spring (distributed) and the model (lumped) 
have the same net kinetic energy and the same potential energy. This energy equivalence 
is used in deriving the lumped parameters in the model. In particular, kinetic energy 
equivalence is used to determine the mass parameters for the model. Even though damp-
ing (energy dissipation) is neglected in the present analysis, it is not difficult to incorporate 
that as well in the model (through, for example, energy-dissipation equivalence).
Potential Energy Equivalence: Consider a linear coil spring AB, as shown in Figure 3.4a. 
If an axial force F is applied at end B while end A is fixed, the end B will move axially 
through distance δ. During that extension, the axial spring force will vary from 0 (in the 
beginning) to F (at the end of the extension). The axial force in the spring will be F any-
where along it (Note: F is a through-variable). The work done by force F during the exten-
sion of the spring is 
F
1
2 δ  and this is indeed the elastic potential energy (PE) stored in the 
spring due to the work done. Also, the final spring force is F
kδ
=
 where k is the stiffness of 
the spring. Substituting, we have, 
(a)
(b)
x
δx
l
k, ms
v
Velocity
v
Heavy spring
(mass ms, stiffness k)
l
x
A
B
FIGURE 3.4
(a) A uniform heavy spring and (b) analytical representation.

72
Modeling of Dynamic Systems with Engineering Applications
	
k
Elastic PE
1
2
2
δ
=
	
(3.7)
Note: Stiffness k = force that is needed to push or pull the spring through a unit distance. It 
is clear that, even though the stiffness (or flexibility) is distributed along AB, the elastic PE 
of the spring is represented accurately by a single (lumped) stiffness parameter k. Hence, 
from the flexibility point of view, a distributed spring of overall stiffness k can be precisely 
represented by a lumped spring of stiffness k. Regardless of the velocity (dynamics) of 
the spring during its deformation, the PE expression remains the same as given before. In 
other words, stiffness is a “static” property. Hence, for “mechanical” energy equivalence 
only the kinetic energy equivalence needs to be considered. 
Kinetic Energy Equivalence
Consider again the uniform, heavy spring shown in Figure 3.4a. One end (A) of the spring 
is fixed and the other end moving at velocity v. 
Note: ms = mass of spring; k = stiffness of spring; and l = length of spring.
Assume a linear distribution of the speed along the spring, with zero speed at the fixed 
end and the maximum speed v at the free end (Figure 3.4b). The local speed of an infini-
tesimal element δx of the spring is given by x
l v. Element mass = m
l
x
s δ . Hence, the element 
kinetic energy KE
m
l
x x
l v
1
2
s
2
δ
=



. In the limit, we have δx → dx. Accordingly, by perform-
ing the necessary integration, we obtain
	
KE
m
l dx x
l v
m v
l
x dx
m v
Total
1
2
1
2
1
2
3
s
l
s
l
s
2
0
2
3
2
0
2
∫
∫
=



=
=
Hence, 
	
Equivalent lumped mass concentrated at the free end = 1
3
spring mass
×
	
(3.8)
Note: This derivation assumes that one end of the spring is fixed, the conditions are uni-
form along the spring, and furthermore the spring velocity is distributed uniformly along 
the spring.
An example of utilizing this result is shown in Figure 3.5. Here a system with a heavy 
spring and a lumped mass, is approximated by a light spring (having the same stiffness) 
and a lumped mass. 
m
k, ms
=
3
ms
m+
k
FIGURE 3.5
Lumped-parameter approximation for an oscillator with heavy spring.

73
Analytical Modeling
Natural Frequency Equivalence
Now consider the approach of natural frequency equivalence. Here, we derive an equiva-
lent lumped-parameter model by equating the fundamental (lowest) natural frequency of 
the distributed-parameter system to the lowest natural frequency of the lumped-parameter 
model. Next, we illustrate this approach by using an example for the one-degree-of-freedom 
case. The method can be easily extended to multi-degree-of-freedom lumped-parameter 
models as well (see the related problem at the end of the chapter). 
Example 3.2
A heavy spring of mass ms and stiffness ks with one end fixed and the other end attached 
to a smoothly sliding mass m, is shown in Figure 3.6a. If the mass m is sufficiently larger 
than ms, then at relatively high frequencies the mass will virtually stand still. Under 
these conditions we have the configuration shown in Figure 3.6b where the two ends 
of the spring are fixed. Also, we can approximate the distributed mass by an equiva-
lent mass me at the midpoint of the spring. Then, each spring segment has double the 
stiffness of the original spring (why?). Hence, the overall stiffness is 4ks. The natural 
frequency of the lumped-model is
	
k
m
4
e
s
e
ω =
	
(3.9)
It is known from a complete analysis of a heavy (distributed-mass) spring (which is 
beyond the present scope) that the exact natural frequency for the fixed–fixed configu-
ration is
	
n
k
m
s
s
s
ω
π
=
	
(3.10)
where n is the mode number. Then, for the fundamental (first) mode (i.e., n = 1), the 
natural frequency equivalence gives 
k
m
k
m
4
s
e
s
s
π
=
(c) 
m
ms , ks
(a)
(b)
me
2ks
2ks
m
me
2ks
2ks
FIGURE 3.6
(a) A lumped mass with a distributed-parameter system; (b) a lumped-parameter model of the system for large 
end mass; and (c) overall lumped-parameter model.

74
Modeling of Dynamic Systems with Engineering Applications
or
	
m
m
m
4
0.4
e
s
s
2
π
=
≈
	
(3.11)
The overall model, with the end mass included, is shown in Figure 3.6c. This result is 
valid when 
≫
m
ms. 
Note: Since the effect of inertia decreases with increasing frequency this model is 
valid for high frequencies as well, and it is not necessary to separately consider the case 
of high frequencies.
LEARNING OBJECTIVES
•	 An alternative approach (natural frequency equivalence) for approximating a 
distributed-parameter model by a lumped-parameter one
•	 Illustration that the result is not identical (but close) to what is obtained 
through energy equivalence
•	 The significance of natural frequency of a system and its connection to excita-
tion frequency
•	 Lumped-parameter approximation of a heavy spring
▪
The natural frequency equivalence may be generalized as an eigenvalue equivalence (pole 
equivalence) for any linear dynamic system in any domain (including electrical systems). 
In this general approach, the eigenvalues of the lumped-parameter model are equated 
to the “corresponding eigenvalues” of the distributed-parameter system, and the model 
parameters are determined accordingly.
3.3  Analytical Model Development
We have been able to make the following observations concerning analytical dynamic 
models:
•	 A dynamic model is a representation of a dynamic system.
•	 It is useful in analysis, simulation, design, modification, instrumentation, and con-
trol of a system.
•	 Analogies exist in mechanical, electrical, fluid, and thermal systems.
•	 In view of the analogous multidomain nature of practical engineering systems, 
integrated and unified development of models is desirable. Then, all domains 
are modeled together/concurrently (i.e., integrated) using similar/analogous 
approaches (i.e., unified). This is the essence of mechatronic modeling.
•	 Incorporation of multifunctional devices (e.g., piezoelectric elements which work 
as both sensors and actuators) into the modeling framework is also facilitated by 
an integrated and unified approach to modeling.
The modeling approach should be systematic as well, consisting of a clearly identified set 
of steps. A systematic procedure for the development of a lumped-parameter analytical 
model of a dynamic system primarily involves the formulation of three types of equations:

75
Analytical Modeling
	
1.	Constitutive equations (physical laws for the lumped elements)
	
2.	Continuity equations (or node equations or equilibrium equations) for the 
through-variables
	
3.	Compatibility equations (or loop equations or path equations) for the 
across-variables 
Among these, the constitutive equations have been studied in Chapter 2. 
A continuity equation is the equation written for the through-variables at a junction (i.e., 
a node) that connects several lumped elements in the system. It dictates the fact that there 
cannot be any accumulation (storage) or disappearance (dissipation) or generation (source) 
of the through-variables at a junction (i.e., what comes in must go out) because a node is 
not an element but a junction that connects elements. Summation of forces (force balance 
or equilibrium), currents (Kirchhoff’s current law), fluid flow rates (flow continuity equa-
tion), or heat transfer rates at a junction to zero provides a continuity equation. Clearly, 
the through-variables of the source elements (input elements) in the system should be 
included as well in writing the node equations.
A compatibility equation is the equation written for the across-variables around a closed 
path (i.e., a loop) connecting several lumped elements in the system. It dictates the fact that 
at a given instant, the value of the across variable at a point in the system should be unique 
(i.e., it cannot have two or more different values). This guarantees the requirement that 
a closed path is indeed a closed path; there is no breakage of the loop (i.e., compatible). 
Summation of velocities, voltages (Kirchhoff’s voltage law), pressures, or temperatures 
to zero around a loop of elements provides a compatibility equation. Again, the across-­
variable of the source elements in the system should be included as well in writing the 
loop equations.
3.3.1  Steps of Model Development
The development of a suitable analytical model for a large and complex system particu-
larly requires a systematic approach. Tools are available to aid this process. The process of 
modeling can be made simple by following a systematic sequence of steps. The desirable 
main steps of modeling are listed below:
	
1.	Identify the system of interest by defining its purpose, operation, and the system 
boundary (physical or virtual).
	
2.	Identify/determine the variables of interest. These include inputs (forcing func-
tions or excitations), outputs (response), and state variables (when possible).
	
3.	Approximate (or model) various segments (components or processes or phenom-
ena) in the system by ideal elements, which are suitably interconnected.
	
4.	Draw a structural diagram (e.g., electrical circuit, mechanical circuit, free-body 
diagram, linear graph, bond graph) showing the individual elements of the system 
and their interconnection (structure).
	
5.	
	
(a)	 Write the constitutive equations (physical laws) for the elements.
	
(b)	 Write the continuity (or conservation) equations for through-variables (equilib-
rium of forces or torques at joints; current balance at nodes, fluid flow balance, 
etc.) at junctions (nodes) of the system.

76
Modeling of Dynamic Systems with Engineering Applications
	
(c)	 Write the compatibility equations for across-(potential or path) variables around 
closed paths that link elements. These are loop equations for velocities (geo-
metric connectivity), voltage (potential balance), pressure drop, etc.
	
(d)	 Eliminate the auxiliary variables, which are redundant and not needed to 
define the model.
	
6.	Express the system boundary conditions (for distributed-parameter models) and 
response initial conditions using system variables. 
These steps should be self-explanatory, and should be integral with the particular model-
ing technique that is used. The associated procedures will be elaborated in the subsequent 
sections and chapters where many illustrative examples are provided as well.
3.4  State Models and Input–Output Models
In the present section we study some key properties and characteristics of state-space 
models and input–output models, in the time-domain. Also we observe the relationship 
between these two types of models and learn how to convert one type of model into the 
other. Examples of analytical model development in various physical domains will be pre-
sented in in the subsequent section.
Input–Output Models: More than one variable may be needed to represent the response 
of a dynamic system. Furthermore, there may be more than one input variable in a system. 
Then we have a multivariable system or an MIMO system. A time-domain analytical model 
may be developed as a set of differential equations relating the response variables to the 
input variables. This is specifically a multivariable input-output model. Generally, this set of 
system equations is coupled, so that more than one response variable appears in each dif-
ferential equation, and each equation cannot be analyzed, solved, or computer simulated 
separately/independently. 
State-Space Models: A particularly useful time-domain representation for a dynamic 
system is a state-space model. The state variables are a minimal set of variables that can 
define the dynamic state of a system. In the state-space representation, the dynamics of 
an nth-order system is represented by n first-order differential equations, which generally 
are coupled. This is called a state-space model or simply a state model. An entire set of state 
equations can be written as a single vector-matrix state equation. 
3.4.1  Properties of State-Space Models
A state-space model (or simply a state model) is formulated using state variables. The 
choice of state variables is not unique: many choices are possible for a given system. Proper 
selection of state variables is crucial in developing an analytical model (state model) for a 
dynamic system. As presented in Chapter 2, a meaningful, systematic, unified, and gen-
eral approach is to use across-variables of the independent A-type (or, across-type) energy 
storage elements and the through-variables of the independent T-type (or, through-type) 
energy storage element as the state variables. Note that if any two elements are not inde-
pendent (for example, if two spring elements are directly connected in series or parallel) 

77
Analytical Modeling
then only a single state variable should be used to represent both elements. New state vari-
ables are not needed to represent D-type (dissipative) elements because their response can 
be represented in terms of the state variables of the energy storage elements (A-type and 
T-type). In other words, D-type elements do not introduce new state variables. State-space 
models and their characteristics are discussed in more detail now. 
State Space
The concept of state was introduced in Chapter 2. The word “state” refers to the dynamic 
status or condition of a dynamic system. A complete description of the state will require all 
the variables that are associated with the time-evolution of the system response (i.e., both 
“magnitude” and “direction” of the response trajectory with respect to time). The state is 
a vector. The vector space in which all possible values the state vector can be defined is the 
state space. As a dynamic system responds, its state vector traces out a trajectory in the state 
space. For example, a second-order system requires a two-dimensional (2D or plane) state 
space, a third-order system requires a three-dimensional (3D) state space, and so on. 
Properties of State Models
A state vector x is a column vector, which contains a minimum set of state variables 
(x1, x2, …, xn) which completely determine the “dynamic state” of a dynamic system. The 
required minimum number of states variables (n), which is the order of the state vector, is 
the order of the system.
Property 1
The state vector x(t0) at time t0 and the input (excitation) u[t0, t1] over the time interval [t0, t1], will 
uniquely determine the state vector x(t1) any future time t1. In other words, a transformation g can 
be defined such that
	
x
g
x
u
t
t t
t
t t
, ,
,
,
1
0
1
0
0
1
(
)
( )
( )
=

	
(3.12)
By the causality property of a dynamic system, future states can be determined if all the inputs 
from the initial time up to that future time are known. This means that the transformation g 
is nonanticipative (i.e., inputs beyond t1 are not needed to determine x(t1). Each forcing function 
u[t0, t1] determines the corresponding “trajectory” of the state vector—the state trajectory. The 
n-dimensional vector space formed by all possible state trajectories is the state space.
Property 2
The state x(t1) and the input u(t1) at any time t1 will uniquely determine the system output 
(or response) vector y(t1) at that time. This can be expressed as
	
y
h
x
u
t
t
t
t
,
,
1
1
1
1
(
)
( )
( )
( )
=
	
(3.13)
This states that the system response (output) at time t1 depends on the time, the input, and 
the state vector at that particular time.
The transformation h has no memory—the response at a previous time cannot be deter-
mined through the knowledge of the present state and the present input. 
Note: In general, the system outputs (y) are not identical to the system states (x) even 
though the former can be uniquely determined by the later.

78
Modeling of Dynamic Systems with Engineering Applications
A state model (in the time-domain) consists of a set of n first-order state equations. They 
are ordinary differential equations, which are coupled (i.e., inter-related or interacting). 
Also, a state model has m output equations. In the vector form, a state model is expressed 
as follows:
	
x
f x u t
( , , )
=
	
(3.14)
	
y
h x u t
( , , )
=
	
(3.15)
Equation 3.14 represents the n state equations (first-order ordinary differential equations) 
and Equation 3.15 represents the m algebraic output equations. If f is a nonlinear vector func-
tion, then the state model is nonlinear, which is the general case. 
Summarizing:
•	 A state model is a set of n first-order differential equations (coupled) using n state 
variables (an nth-order system).
•	 State equations define the dynamic state of a system.
•	 Required minimum set of state variables x1, x2, … xn forms the state vector x.
•	 The state vector traces out a trajectory in the state space.
•	 To complete the state model, it must include the output equations (a set of m alge-
braic equations relating the output vector to the state vector). Sometimes, these 
output equations contain input variables as well.
3.4.2  Linear State Equations
Nonlinear state models are difficult to analyze and simulate. Often linearization is neces-
sary, through various forms of approximations and assumptions. Linearization is studied 
in Chapter 4. An nth-order linear state model is given by the following state equations 
(differential): 
	










x
a x
a x
a x
a x
b u
b u
b u
x
a x
a x
a x
a x
b u
b u
b u
x
a x
a x
a x
a x
b u
b u
b u
n
n
r
r
n
n
r
r
n
n
n
n
nn
n
n
n
nr
r
1
11
1
12
2
13
3
1
11
1
12
2
1
2
21
1
22
2
23
3
2
21
1
22
2
2
1
1
2
2
3
3
1
1
2
2
=
+
+
+
+
+
+
+
+
=
+
+
+
+
+
+
+
+
=
+
+
+
+
+
+
+
+
	
(3.16a)
and the following output equations (algebraic):
	







y
c x
c x
c x
c x
d u
d u
d u
y
c x
c x
c x
c x
d u
d u
d u
y
c
x
c
x
c
x
c
x
d
u
d
u
d u
n
n
r
r
n
n
r
r
m
m
m
m
mn
n
m
m
mr
r
1
11
1
12
2
13
3
1
11
1
12
2
1
2
21
1
22
2
23
3
2
21
1
22
2
2
1
1
2
2
3
3
1
1
2
2
=
+
+
+
+
+
+
+
+
=
+
+
+
+
+
+
+
+
=
+
+
+
+
+
+
+
+
	
(3.17a)

79
Analytical Modeling
Here, x
dx dt
=
; x1, x2, …, xn are the n state variables; u1, u2, …, ur are the r input variables; and 
y1, y2, …, ym are the m input variables. Equation 3.16 simply states that a change in any of the 
n state variables and the r inputs of the system will affect the rate of change of any given 
state variable. Both the state equations given by Equation 3.16a and the output equations 
given by Equation 3.17a are needed for a complete representation of the state model. The 
output equations in general contain the input variables, as indicated in Equation 3.17a. 
We will see that this is the case of a system with “feedforward input” characteristic. More 
often, however, the input variables are not present in this set of output equations (i.e., the 
coefficients dij are all zero in Equation 3.17a).
This state model may be rewritten in the compact vector-matrix form as follows:
	
x
Ax
Bu
=
+
	
(3.16b)
	
y
Cx
Du
=
+
	
(3.17b)
A bold-type upper-case letter represents a matrix, and a bold-type lower-case letter repre-
sents a vector, typically a column vector. Specifically, we have
	






























x
x
A
B
C
D
x
x
x
x
x
x
a
a
a
a
a
a
a
a
a
b
b
b
b
b
b
b
b
b
c
c
c
c
c
c
c
c
c
d
d
d
d
d
d
d
d
d
;
;
;
;
;
n
n
n
n
n
n
nn
r
r
n
n
nr
n
n
m
m
mn
r
r
m
m
mr
1
2
1
2
11
12
1
21
22
2
1
2
11
12
1
21
22
2
1
2
11
12
1
21
22
2
1
2
11
12
1
21
22
2
1
2
=














=














=














=














=














=














Also

x
x
x
xn
T
1
2
= 
 = state vector (nth order) 
	

u
u
u
ur
T
1
2
= 
 = input vector (rth order)
	

y
y
y
ym
T
1
2
= 
 = output vector (mth order)
A = system matrix (n × n)
B = input distribution matrix (n × r)
C = output (or measurement) gain matrix (m × n)
D = feed-forward input gain matrix (m × r)
Note: []T denotes the transpose of a matrix or vector. The system matrix A tells us how the 
system responds naturally in the absence of any external input, but it is needed as well to 
determine the system response in the presence of an external input. The input distribu-
tion matrix B tells us how the input u affects (i.e., how it is amplified and distributed when 
reaching) the system. 

80
Modeling of Dynamic Systems with Engineering Applications
Time-Invariant Systems
The functions f and h in Equations 3.14 and 3.15 show explicit dependence on time t. Then 
the corresponding dynamic system (state model) is said to be time-variant (or nonstationary 
or non-autonomous). That means, the system parameters (such as mass, stiffness, capaci-
tance, inductance) vary with time. If the system parameters do not change with time, the 
functions f and h will not have an explicit t in its representation. Then, the corresponding 
system (state model) is said to be time-invariant, or stationary, or autonomous. In this case, 
the system behavior does depend on the time origin, for a given initial state and input 
function. In particular, a linear system is time-invariant if the matrices A, B, C, and D (in 
Equations 3.16 and 3.17) are constants. 
3.4.3  Input–Output Models from State-Space Models
Once a state-space is obtained it is easy to convert it into a time-domain input–output model. 
In the general, nonlinear case, suppose Equations 3.15 are substituted into Equation 3.14 
to eliminate x and x, and get a set of differential equations for y (with u and its derivatives 
present). The result is the input–output model, in the time-domain. If these input–output 
differential equations are nonlinear, then the system (or strictly, the input-output model) 
is nonlinear. 
The analytical procedure of achieving this for a linear, time-invariant state model is as 
follows:
	
1.	Differentiate Equations 3.17 to get 


y
Cx
Du
=
+
	
2.	Eliminate x by substituting Equations 3.16. We get 

y
CAx
CBu
Du
=
+
+
	
3.	Use these equations and Equations 3.17 to eliminate x. A matrix expression cannot 
be given for this last step. It has to be obtained by using the actual equations. 
Example 3.3
The concepts of state, output, and order of a system, and the importance of the system’s 
initial state, can be shown using a simple example. Consider the rectilinear (translatory) 
motion of a particle of mass m subject to an input force u(t) (Figure 3.7).
By Newton’s second law, its velocity v can be expressed as the first-order differential 
equation:
	

m dv
dt
u t
v
m u
( ) or
1
=
=
	
(i)
u
m
v
Inertial
reference
FIGURE 3.7
Point mass in rectilinear motion under a force.

81
Analytical Modeling
This is a first-order model, which is completely represented by a single state equation 
with the state variable v. Furthermore, it satisfies the formal definition of a state (state 
vector in general, but a scalar in the present example) as stated before. Specifically, by 
integrating (i), we obtain:
	
v
v
m
u dt
1
t
0
0∫
=
+
⋅
	
(ii)
where v0 = velocity at t = 0.
Equation ii is consistent with the formal definition of state because it says that we can 
determine v at time t by knowing the v at time 0 and the input u from time 0 to t.
Next we can show that the position x of the mass does not constitute a complete state 
of it. To show that we integrate Equation ii, again from t = 0 to t. We obtain
	
x
x
v t
m
u d
dt
1
t
0
0
0
0 ∫∫
τ
=
+
+
⋅
⋅
τ
	
(iii)
Note: We have introduced a dummy variable τ for time, for the first integration, which is 
independent of the second integration.
Equation (ii) says that to determine x at time t we need to know both x and v at time 0 
(not just x at time 0) and the input u from time 0 to t. This is not consistent with the 
formal definition of state, and hence x alone cannot completely represent the state of a 
point mass. If we need to know x as an output, we have to introduce v as well. Then we 
have a second-order state vector:
	
x
x v
T
= 

The corresponding state equations are as follows:
	


x
v
v
m u t
1
( )
=
=
The associated model matrices are as follows:
	
A
B
C
m
0
1
0
0
;
0
1/
;
1
0
= 





=






= 

This is not a natural choice of states for this system (a mass particle in translatory 
motion) since we know that the system is first-order. Because we seek an unnatural 
output (position x) for the mass, we get the unnatural result of a second-order model for 
a first-order system (having a single energy storage element). This further supports our 
previous assertion (see Chapter 2) that the natural state variable for a mass (an A-type 
element) is its across-variable, which is v.
LEARNING OBJECTIVES
•	 Simple investigation into the concepts of state and order of a system/model.
•	 The natural choice of state variable may have to be modified depending on the 
required output.
•	 The system order may have to be modified depending on the required output.
▪

82
Modeling of Dynamic Systems with Engineering Applications
Example 3.4
Consider again the particle of mass m subject to an input force u(t) as shown in Figure 3.7. 
By Newton’s second law, its position x can be expressed by the second-order differential 
equation:
	

=
−
=
m d x
dt
u t
mx
u
( ) or
0
2
2
	
(i)
We now develop state models and input–output (I–O) models for the following three 
cases:
Case 1: Position x is the output.
Case 2: Velocity  =
x
v is the output.
Case 3: Both position x and velocity  =
x
v are outputs.
Case 1: Here output y = x. From Equation (i) 
=
m d y
dt
u t( )
2
2
, which is indeed the I–O 
model (a second-order model).
Case 2: Here output 

=
=
y
x
v. From Equation (i) 
=
m dy
dt
u t( ), which is the I–O 
model for this case (a first-order model).
Case 3: Here the two outputs are y1 = x, 

=
=
y
x
v
2
. From Equation (i), the I–O 
model is
	
=
m d y
dt
u t( )
2
1
2
	
=
m dy
dt
u t( )
2
This is also a second-order model.
ANOTHER STATE-SPACE MODEL
For system (i), define the two state variables according to 
= −
x
x
6
1
 and 

= −
x
x
1
2
2
1
Then, one state equation is given by one of the definitions itself, and the other state 
equation is obtained by substituting the two definitions into (i). We have
State Equations: 


= −
=
x
x
x
m u t
2
3
( )
1
2
2
If x is the output, the output equation becomes = −
y
x
1
6
1
If both x and v are outputs, the output equations are








=
−
















y
y
x
x
1/6
0
0
1/3
1
2
1
2
FURTHER OBSERVATIONS:
	
1.	 In this example, the three variables 

x x
, , and x do not form a state vector 
because this is not a minimal set. Specifically, x is redundant as it is completely 
known from u.
	
2.	 When the output is velocity, just one initial condition v0 is adequate, whereas if 
the output is position, two initial conditions x
v
 and 
0
0 are needed, to determine 

83
Analytical Modeling
the complete response. In the latter case, just one initial state does not uniquely 
generate a state trajectory corresponding to a given forcing input. This intui-
tively clear fact, nevertheless, constitutes an important property of a dynamic 
system: the number of initial conditions needed to determine the system 
response = order of the system.
	
3.	 The choice of state variables non-unique. 
▪
SYSTEM ORDER
The “order” of a dynamic system (model) indicates the dynamic “size” of it. The order 
may be defined/indicated in many ways, but all of them indicate the same thing. The 
following are some common indicators of the model order:
•	 Number of independent energy storage elements
•	 Number of state variables (i.e., order of the state vector)
•	 Order of system matrix A
•	 Number of initial conditions required to determine the system response
•	 Order of the input–output differential equation (time-domain I–O model)
•	 Order of denominator polynomial of system transfer function (frequency-
domain I–O model—see Chapter 6)
•	 Number of eigenvalues of A (or poles—roots of the denominator equation of 
the transfer function—see Chapter 6)
Some of these indicators are general (e.g., 1, 2, 4, 5) while some others assume a linear 
or linear and time-invariant system (e.g., 3 assumes linear system while 6 and 7 assume 
linear time-invariant system).
3.5  Modeling Examples 
From the foregoing discussions and illustrative examples, the following statements can be 
made:
•	 State vector is a least (minimal) set of variables that completely determines the 
dynamic state of system. Hence, a state variable cannot be expressed as a linear 
combination of the remaining state variables.
•	 State vector is not unique. Many choices are possible for a given system.
•	 Output (response) variables can be completely determined from any choice of 
state variables.
•	 State variables may or may not have a physical interpretation.
3.5.1  Systematic Development of a State Model
The steps for developing an analytical models have been identified. At this stage it useful 
to focus on state-space models. Specifically, the key steps in our systematic approach for 
formulating a state-space model given now.
Note: We assume that the inputs (u) and the outputs (y) of the system are specified or 
identified.

84
Modeling of Dynamic Systems with Engineering Applications
Step 1: Identify the elements/components in the system (e.g., energy storage ele-
ments, energy dissipative elements, input/source elements) and draw a structural 
diagram (circuit diagram, linear graph—Chapter 5, bond graph—Appendix B, 
etc.) to show how they are interconnected.
Step 2: State-variable (x) selection: Across-variables of independent A-type energy 
storage elements and through-variables of independent T-type energy storage 
elements.
Step 3: Write constitutive equations for all the elements in the system (including all 
energy storage elements, all energy dissipative elements, and two-port elements—
see Chapter 5).
Step 4: Write continuity equations for the through-variables at each node (node is a 
point connecting two or more system components).
Step 5: Write compatibility equations for across-variables around each loop (a loop is 
a closed path that is formed by two or more system components).
Step 6: State-space shell: Constitutive equations for the independent energy storage 
elements. Eliminate the redundant/unwanted variables in the state-space shell 
(by using the remaining equations).
Note: We keep only the state variables and the input variables. Any other variable 
is a redundant variable in the shell equations.
Step 6: Express the outputs in terms of the state variables.
Note: Sometimes (i.e., in the presence of feed-forward character), an output equation may 
have to include one or more input variables.
Now, we present several examples in the mechanical, fluid, and thermal domains for the 
systematic development of a state-space model. The present focus is these three domains 
because the used methodologies are straightforward adaptations of those use in the elec-
trical domain. In some examples, the conversion from a state-space model to an input-
output model is illustrated as well. 
3.5.2  Modeling in Mechanical Domain 
In the mechanical domain, the modeling approach is facilitated by the use of a structural 
diagram similar to the circuit diagram that is used in the electrical domain. Furthermore, 
generally, the loop equations are automatically satisfied because the reference for an iner-
tia element or a source element is the inertial reference (ground). These facts are illustrated 
in the following example.
Example 3.5
The rigid output shaft of a diesel engine prime mover is running at known angular 
velocity Ω(t). It is connected through a friction clutch to a flexible shaft, which in turn 
drives a hydraulic pump (see Figure 3.8a). A linear model for this system is shown 
schematically in Figure 3.8b. The clutch is represented by a viscous rotatory damper of 
damping constant B1 (units: torque/angular velocity). The stiffness of the flexible shaft 
is K (units: torque/rotation). The pump is represented by a wheel of moment of inertia J 
(units: torque/angular acceleration) and viscous damping constant B2. 

85
Analytical Modeling
	 (a)	 Write the two state equations relating the state variables T and ω to the input 
Ω, where T = torque in flexible shaft and ω = pump speed.
Use the following simpler approach:
	
(i)	
Free body diagram for the shaft is shown in Figure 3.8c, where ω1 is the 
angular speed at the left end of the shaft. To get one state equation, write 
the “torque balance” and “constitutive” relations for the shaft and elimi-
nate ω1.
	
(ii)	
Free body diagram for the wheel J is shown in Figure 3.8d. To get the other 
state equation, use D’Alembert’s principle.
	 (b)	 Express the state equations in the vector-matrix form.
	 (c)	 To complete the state-space model, determine the output equation for: (i) out-
put = ω; (ii) output = T; and (iii) output = ω1.
	 (d)	 Which one of the translatory systems given in Figure 3.9 is the system in 
Figure 3.8b analogous to?
	 (e)	 Comment on why the compatibility equations and continuity equations are 
not explicitly used in the development of the state equations.
	 (f)	 Present a more detailed and systematic approach for the development of the 
state-space model in this example. 
(d)
J
B2
K
B1
ω
ω1
Ω
ω
ω
ω1
Ω
K
B1
J
B2
(a)
(b)
K
T
(c)
J
T
T2 = B2ω
T
T2 = B2ω
ω
ω1
T = B1(Ω–ω1)
ω
FIGURE 3.8
(a) Diesel engine; (b) linear model; (c) free-body diagram of the shaft; and (d) free-body diagram of the wheel.

86
Modeling of Dynamic Systems with Engineering Applications
Solution
	 (a)	 See Figure 3.8c.
	
ω
ω
=
−
K dT
dt
K
Constitutive relation for
:
(
)
1
	
(i)
	
Ω
ω
=
−
B
T
B
Constitutive relation for
:
(
)
1
1
1 	
(ii)
Substitute (ii) into (i):
	
ω
Ω
= −
−
+
dT
dt
K
B T
K
K
1
	
(iii)
This is one state equation.
See Figure 3.8d.
Constitutive equation for J (D’Alembert’s principle):
	
ω =
−
J
T
T2	
(iv)
Note: In practice, the rotatory inertia J of the pump includes the true rotatory 
­inertia of the impeller of the pump and also the “added-mass effect” of the 
fluid that is transmitting through the pump. 
	
ω
=
B
T
B
Constitutive relation for
:
2
2
2
	
(v)
	
ω
ω
= −
+
d
dt
B
J
J T
Substitute (v) in (iv):
1
2
	
(iv)
This is the second state equation.
	 (b)	 The vector-matrix form of the state equations (iii) and (iv) is:
	
ω
ω
Ω












=
−
−
−



















+ 





dT
dt
d
dt
K
B
K
J
B
J
T
K
1
0
1
2
State vector 
ω
=
x
T
[    
]T and the input 
Ω
=
u
[
].
(b)
(a)
(c)
FIGURE 3.9
Three translatory mechanical systems.

87
Analytical Modeling
The corresponding matrices are:
	
=
−
−
−














= 





A
B
K
B
K
J
B
J
K
1
;
0
1
2
	 (c)	
	
(i)	
=
=
C
D
[0   1];
[0]
	
(ii)	
=
=
C
D
[1   0];
[0]
	
(iii)	
Here we use the continuity equation to express the output as ω
Ω
=
−T
B
1
1
.
	
Then, the corresponding matrices are 
= −
=
C
D
B
[ 1/
   0];
[1]
1
	
In this case, we notice a direct “feed-forward” of the input Ω into the out-
put ω1 through the clutch B1. Furthermore, as will be clear from the material 
in Chapter 6, now the system transfer function will have its numerator order 
equal to the denominator order (= 2). This is a characteristic of systems with 
direct feed-forward of inputs into the outputs. 
	 (d)	 The translatory system in Figure 3.9a is analogous to the given rotatory 
system.
	 (e)	
	
For this example, it is not necessary to write the continuity equations separately 
because they are already taken into account when writing the constitutive 
equations. The compatibility equations are implicitly satisfied in mechanical 
systems because the reference end of an inertia element is the ground. These 
facts are illustrated in detail in the next part of the answer. 
	 (f)	
	
For a detailed and systematic derivation of the state-space model, we use the 
structural (mechanical circuit) diagram of the system, as shown in Figure 3.10a. 
It shows the two primary loops in the system.
Note: An inertia element also has two ends (just like a spring element and 
a damping element). However, the two ends are not physically connected 
in an inertia element, and the reference end is always the ground (inertial 
reference).
Figure 3.10b separates the elements of the system, showing its nodes. It is 
essentially, a detailed free-body diagram.
LOOP EQUATIONS
We have two loop equations for the two primary loops in the system (Figure 3.19a). Use 
the sign convention where “velocity increase,” shown by an arrow, is taken positive, 
going in the counter-clockwise (ccw) direction. 
ω
ω
ω
ω
ω
Ω
ω
Ω
−
=
+
−
+
−
−
=
t
t
Loop 1:
0
Loop 2 :
( 1
)
(
( )
1)
( )
0
It is seen that the loop equations are automatically satisfied, as noted before, for this 
“mechanical” system. 
Note: Another loop can be identified, which encloses both Loop 1 and Loop 2. This is 
not an independent loop because the corresponding loop equation is simply the sum of 
the equations of the other two loops.

88
Modeling of Dynamic Systems with Engineering Applications
NODE EQUATIONS
Five nodes can be identified for this system, as shown in Figure 3.10b. Only four node 
equations should be written, however, because the equation of the remaining node is 
the sum of the equations of the first four nodes.
Using the nomenclature for the torques, as indicated in Figure 3.10b, we write the fol-
lowing node equations.
	
Ω
−
+
=
=
−
+
=
−
+
=
−
−
=
−
+
=
T
T
Note T
t
T
T
T
T
T
T
T
Note
J
T
T
T
Node 0 :
0
(
:
torque in the velocity source 
( ))
Node 1:
0
Node 2 :
0
Node 3 :
0
(
: This is the node representing all the torques that are 
                                             applied to the inertia , and 
 is the inertia torque)
Node 4 :
0
V
d
V
d
J
J
J
J
J
J
d
1
1
1
1
2
2
2
(a)
(b)  
SV
Loop 1
Velocity
source
Loop 2
Ω(t)
Ω–ω1
ω1–ω
B1
K
J
B2
Inertial reference
(Velocity = 0)
Node 5
B1
K
Td1
Td1
T
T
TJ
J
TJ2
TJ1
Td2
Td2
B2
Node 0
Node 1
Node 2
Node 3
Node 4
Inertial
reference
SV
TV
TV
TJ
Td2
Virtual
inertia
torque
path of J
ω
FIGURE 3.10
(a) Structural (circuit) diagram of the system; (b) Free-body diagrams of the system components.

89
Analytical Modeling
As a check, we write the equation for Node 5: 
+
−
=
T
T
T
0.
d
J
V
2
This equation is obtained just by combining the previous four node equations, and 
hence, it is not independent.
Note: Torques are vectors. So, the proper direction (as shown in Figure 3.10b, according 
to right-hand corkscrew rule) has to be used in the node equations.
CONSTITUTIVE EQUATIONS






ω
ω
ω
Ω
ω
ω
=
−
=
=
−
=
K
dT
dt
K
J J d
dt
TJ
B
Td
B
B
Td
B
For
:
( 1
)
For
:
 state-space shell
For 1 :
1
1(
(t)
1)
For
2 :
2
2
Eliminate the auxiliary variables ω
T
(
and
)
J
1
 in the state-space shell. We have
ω
Ω
Ω
=
−
=
−
t
Td
B
t
T
B
B
1
( )
1
1
( )
1
(from the equation for 1 and the Node 1 equation)
ω
=
−
=
−
=
−
TJ
TJ
TJ
T
Td
T
B
B
1
2
2
2
(from the equations for Node 2, Node 4, and
2)
STATE EQUATIONS
Finally, we have the state-space equations,
	
Ω
ω
ω
ω
=
−
−
=
−
dT
dt
K
K T
B
K
d
dt
T
J
B
J
1
2
LEARNING OBJECTIVES
•	 Proper choice of state variables
•	 Systematic development of a state-space model
•	 Modeling of mechanical systems
•	 Analogous mechanical models (translatory and rotatory)
▪
IMPORTANT COMMENTS
•	 Generally, some of the continuity equations (node equations) and compat-
ibility equations (loop equations) are automatically satisfied by the particular 
choice of variables. Then, we do not have to write the corresponding equations.
•	 Some of the node equations and/or loop equations may not be needed for the 
elimination of the auxiliary variable in the state-space shell.
•	 In mechanical systems, compatibility equations are automatically satisfied 
because the reference for the inertia elements and the input elements is the 
ground (inertial reference). 
3.5.3 Modeling in the Fluid Domain
First, we present some important concepts in the development of lumped-parameter fluid 
models. Next, we indicate several special considerations that can be made when modeling 

90
Modeling of Dynamic Systems with Engineering Applications
pneumatic systems, which have elements that are more compressible than hydraulic ele-
ments. We end the treatment with illustrative examples.
Commutativity of Series Resistor and Inertor Elements
Consider the case of a pipe flow represented by the two lumped elements: Fluid resistor (R) 
and fluid inertor (I), driven by the pressure source Ps(t), feeding into a uniform storage 
tank, as shown in Figure 3.11a. This is called Case 1. When the two lumped elements are 
interchanged, we get the model in Figure 3.11b. This is called Case 2, where the conditions 
change to those marked with ()’.
Note: The variable P represents the pressure drop (an across-variable) not the absolute 
pressure.
Element (Constitutive) Equations for Case 1:
	
=
RQ
PR
	
=
I dQ
dt
PI
	
+
=
+
=
=
−
⇒
+
=
−
RQ
I dQ
dt
P
P
P
P
P
RQ
I dQ
dt
P
P
Add: 
R
I
s
h
s
h	
(3.18)
	
=
C
dP
dt
Q
with
grv
h
	
(3.19)
(a)
PR
I
Q
PI
R
Ph
Ps(t)
h
(Input)
(Output)
P = Ps – Ph
(b) 
I
Q΄
PI΄
PR΄
R
Ph΄
Ps(t)
h΄
(Input)
(Output)
P΄ = Ps – Ph΄
FIGURE 3.11
Lumped model of fluid flow through a pipe into a tank. (a) Case 1 and (b) case 2 (with elements interchanged).

91
Analytical Modeling
By substituting Equation 3.19 into Equation 3.19 we get the input–output system equation 
(a second-order differential equation in Ph). Specifically
	
+
+
=
IC
d P
dt
RC
dP
dt
P
P t( )
grv
h
grv
h
h
s
2
2
	
(3.20)
Element (Constitutive) Equations for Case 2:
	
′ =
′
I dQ
dt
PI
	
′ =
′
RQ
PR
	
′ +
′ =
′+
′ =
−
′ =
′
⇒
′ +
′ =
−
′
RQ
I dQ
dt
P
P
P
P
P
RQ
I dQ
dt
P
P
Add:
I
R
s
h
s
h 	
(3.18′)
	
′ =
′
C
dP
dt
Q
with
grv
h
	
(3.19′)
By substituting Equation (3.19′) into Equation (3.18′) we get the input–output system equa-
tion (a second-order differential equation in Ph). Specifically
	
′ +
′ +
′ =
IC
d P
dt
RC
dP
dt
P
P t( )
grv
h
grv
h
h
s
2
2
	
(3.20′)
From Equations 3.20 and 3.20′ it is seen that we get the same overall system equation 
(input–output model) in the two cases. 
⟹ The inertor and resistor elements are commutative (interchangeable), and the two 
systems shown in Case 1 and Case 2 are equivalent.
In particular, for the same input Ps(t) we will get the same output ⇒
′ =
′ =
P
P
Q
Q
and
h
h
Furthermore, since the element parameters (R or I) and the fluid volume flow rate (Q) 
are the same in the two cases, we must have the pressure drops across the corresponding 
elements in the two cases: ′ =
′ =
P
P
P
P
and
R
R
I
I
Note: By induction, we can prove that this property of commutativity is satisfied by any 
number of R and I elements that are in series (i.e., having a common through variable).
Example 3.6
The R and I elements in the system of Figure 3.12a may be regrouped as in Figure 3.12b. 
This is accomplished simply by interchanging the elements Iv and Rh, which are com-
mutative according the result obtained before. Then, the like elements may be combined 
to give the equivalent parameters:
	
+
=
+
=
R
R
R
I
I
I
v
h
v
h

▪

92
Modeling of Dynamic Systems with Engineering Applications
GENERAL STEPS FOR COMBINING SERIES R AND I ELEMENTS:
	
1.	 Group together the elements of the same type.
	
2.	 Add the resistances to give the equivalent resistance Req.
	
3.	 Add the inertances to give the equivalent intertance Ieq.
PRESSURE HEAD IN A VERTICAL PIPE
Consider the vertical pipe segment as shown in Figure 3.13. For the present discussion, 
neglect inertance and resistance.
If we ignore the capacitance due to gravity head of the vertical pipe segment (because 
the area of cross-section of the pipe can be considerably small compared to that of the 
PRh
PRv
Iv
Rh
Q
PIv
PIh
Ih
Rv
Iv
Rh
Ih
Rv
(a)
Ph
Ph
Ps(t)
Ps(t)
Q
(b)
FIGURE 3.12
An example of commutativity of series elements. (a) Original model and (b) equivalent model.
Pg = ρgH
H
Ph
Ps(t)
Pump
FIGURE 3.13
Effect of the gravity head from a vertical pipe.

93
Analytical Modeling
tank; Note: Gravity head capacitance is ρ
A
g ), then the flow rate Q = 0. Consequently, the 
pressure drop in the vertical pipe segment, 
−
=
P
P
constant
s
h
.
Then, we can include this constant pressure drop (gravity head) as a constant pres-
sure input rather than a capacitance.
Specifically, with 
ρ
=
P
gH
g
, we modify the pressure source as 
−
P
P
s
g
where H = height of the pipe segment.
Note: Nevertheless, any pressure drops that are due to fluid resistance or inertance 
have to be included separately, if they are present in the actual pipe segment. 
PARALLEL CONNECTION OF FLUID CAPACITORS
Consider the situation of compressible fluid flow into a tank of flexible (deformable) 
wall, as shown in Figure 3.14.
Here, the overall fluid flow (volume) rate Q into the tank can be considered to come 
from three separate flow rates:
•	 Compression of the fluid bulk
•	 Expansion of the tank
•	 Gravity head of the fluid column
However, we cannot use 
=
C
dP
dt
Q
bulk
1 for the effect 1; neither can we use 
=
C
dP
dt
Q
elastic
2 
for effect 2 because the pressure is not uniform within the fluid in the tank unless h is 
relatively very small.
Nevertheless, we can use 
=
C
dP
dt
Q
grav
3 for effect 3 because here, P represents the pres-
sure at the bottom of the tank (w.r.t. the atmospheric conditions).
THIN FLUID LAYER APPROXIMATION
Suppose that h is very small, and assume that the pressure difference 
=
−
P
P
Pa
1
 can 
represent the pressure in the entire fluid (w.r.t. the ambience). Then P is common to all 
three flows listed above, where
	
P1 = pressure at the bottom of the tank
	
Pa = ambient pressure
Adding the individual flow components we have
Pa
P = P1 – Pa
h
P1
Q
Pressure drop
Pa
Flexible
tank
Compressible
fluid
FIGURE 3.14
Flow of compressible liquid into a flexible tank.

94
Modeling of Dynamic Systems with Engineering Applications
	
+
+
=
+
+
C
dP
dt
C
dP
dt
C
dP
dt
Q
Q
Q
bulk
elastic
grav
1
2
3
	
=
+
+
=
+
+
Q
Q
Q
Q
C
dP
dt
Q
C
C
C
C
with
Hence
=
with
eq
eq
bulk
elastic
grav
1
2
3
This is a case of parallel connection (pressure is common and flow rate is additive).
Note: If h is not small, we have to partition the fluid in the tank into many layers and 
write equations for each layer separately (or, integrate the effects of infinitesimal lay-
ers). This case is considered under linear-graph modeling, in Chapter 5. The situation 
is complicated by the fact that due to the tank flexibility, the area of cross-section of the 
tank changes with the fluid pressure.
Note: An example of two fluid capacitors in series is the case of an incompressible 
liquid column (Cgrav) in a rigid tank with a flexible (spring-loaded) cap or accumulator 
(Celastic). Then the equivalent capacitance (Ceq) is given by 
=
+
C
C
C
1
1
1
eq
elastic
grav
 (see Problem 
3.14 and problem 3.15).
PNEUMATIC SYSTEMS
For pneumatic (gas) systems, pressure is the across-variable (as for hydraulic systems). 
However, in view of the relatively high compressibility of the flowing fluid (gas), it is 
desirable to use the mass flow rate Qm as the through-variable (unlike in hydraulic sys-
tems where the volume flow rate Q is the through-variable). This modified representa-
tion of the through-variable, in pneumatic systems, is considered now.
A-TYPE PNEUMATIC ELEMENT (FLUID CAPACITOR):
For a hydraulic system: 
=
C dP
dt
Q
f
	
ρ
ρ
⇒
=
=
=
C dP
dt
Q
Q
mass flow rate
f
m
	
=
C
dP
dt
Q
For a pneumatic system we use:
mf
m	
(3.21)
	
ρ
=
C
C
Hence, pneumatic capacitance
mf
f	
(3.22)
T-TYPE PNEUMATIC ELEMENT (FLUID INERTOR)
For a hydraulic system: 
ρ
=
⇒
=
I dQ
dt
P
I dQ
dt
P
1
f
f
m
	
=
I
dQ
dt
P
For a pneumatic system we use :
mf
m
	
(3.23)
	
ρ
=
I
I
1
mf
f
	
(3.24)
Note: 
ρ
ρ
ρ
=
=
+
dQ
dt
d
Q
dt
dQ
dt
Q d
dt
(
)
m
. Hence, the equation 
ρ
=
dQ
dt
dQ
dt
1
m  is strictly valid only 
when the mass density ρ is a constant. However, if we assume that the rate of change of 
ρ is much smaller than the rate of change Q, this equation holds. 

95
Analytical Modeling
Another way to approach this issue is by considering the constitutive equation for a 
pneumatic inertor (linear) on its own, as given by Equation 3.23, without starting from 
the constitutive equation of a hydraulic inertor. Then, however, the relation 
ρ
=
I
I
1
mf
f 
does not generally hold. 
D-TYPE PNEUMATIC ELEMENT (FLUID RESISTOR):
For a hydraulic system: 
ρ
=
=
P
R Q
R Q
f
f
m
	
=
P
R Q
For a pneumatic system we use:
mf
m	
(3.25)
	
ρ
=
R
R
Hence, pneumatic resistance:
1
mf
f
	
(3.26)
Example 3.7
Consider two water tanks joined by a horizontal pipe with an on-off valve. With the 
valve closed, the water levels in the two tanks were initially maintained unequal. When 
the valve was suddenly opened, some oscillations were observed in the water levels of 
the tanks. Suppose that the system is modeled as two gravity-type capacitors linked by 
a fluid resistor. Would this model exhibit oscillations in the water levels when subjected 
to an initial-condition excitation? Clearly explain your answer.
A centrifugal pump is used to pump water from a well into an overhead tank. This 
fluid system is schematically shown in Figure 3.15a. The pump is considered as a pres-
sure source Ps(t) and the water level h in the overhead tank is the system output. The 
ambient pressure is denoted by Pa. The following system parameters are given:
Overhead
tank
Ps(t)
+
Pa
Exit valve
(closed)
Area = At
Pa
Lh
I.D. = dh
_
Well
Centrifugal
pump
I.D. = dv
Lv
(a)
(b)
1
2
3
Pa
Pa
Ps(t)
Q
Req
Ieq
Cgrv
h
FIGURE 3.15
(a) A system for pumping water from a well into an overhead tank; and (b) a lumped-parameter model of the 
fluid system.

96
Modeling of Dynamic Systems with Engineering Applications
Lv, dv = length and internal diameter of the vertical segment of pipe
Lh, dh = length and internal diameter of the horizontal segment of pipe
At = area of cross-section of overhead tank (uniform)
ρ = mass density of water
μ = dynamic viscosity of water
g = acceleration due to gravity.
Suppose that this fluid system is approximated by the lumped-parameter model shown 
in Figure 3.15b. Rationalize this approximation.
	 (a)	 Give expressions for the equivalent linear fluid resistance of the overall pipe 
(i.e., combined vertical and horizontal segments) Req, the equivalent fluid iner-
tance within the overall pipe Ieq, and the gravitational fluid capacitance of the 
overhead tank Cgrv, in terms of the given system parameters.
	 (b)	 Treating = 

x
P
Q
a
T
3
 as the state vector,
	
	
where P3a = pressure head of the overhead tank, and Q = volume flow 
rate through the pipe, develop a complete state-space model for the system. 
Specifically, obtain the matrices A, B, C, and D. 
	 (c)	 Obtain the input–output differential equation of the system. 
Solution
Since the inertia effects are neglected in the model, and only capacitors are used as the 
energy storage elements, there exists only one type of energy in this system. Hence, 
this model cannot provide an oscillatory response to an initial condition excitation (i.e., 
natural oscillations are not possible). But the actual physical system has fluid inertia, 
and hence, the system can exhibit an oscillatory response. 
The pressure of the vertical pipe segment in Figure 3.15a may be included in the pres-
sure source. Then, after replacing P t( )
s
 by 
ρ
−
P t
gl
( )
s
v, we can use the model shown in 
Figure 3.15b. In the following analysis, assume that P t( )
s
 has this modified form.
	 (a)	 Assuming a parabolic velocity profile, the fluid inertance in a pipe of uniform 
cross-section A and length L, is given by 
ρ
=
I
L
A
2
	
	
Since the same volume flow rate Q is present in both segments of piping 
(continuity), we have, for series connection, 
	
ρ
ρ
ρ
π
=
+
=
+




π
π
I
L
d
L
d
L
d
L
d
2
2
8
eq
v
v
h
h
v
v
h
h
4
2
4
2
2
2
	
The linear fluid resistance in a circular pipe is 
µ
π
=
R
L
d
128
4  where d denotes 
the internal diameter. Again, since the same Q exists in both segments of the 
series-connected pipe
	
µ
π
=
+




R
L
d
L
d
128
eq
v
v
h
h
4
4
	
Also
	
ρ
=
C
A
g
grv
t

97
Analytical Modeling
	 (b)	 State-space Shell
	
=
=
C
dP
dt
Q
I
dQ
dt
P
grv
a
eq
3
23
Remaining Constitutive Equation:
	
=
P
R Q
eq
12
Note: Continuity (node) equations are automatically satisfied.
Compatibility (Loop) Equations:
	
ρ
=
+
+
=
=
P
P
P
P
P
P t
P
gh
with
( ) and 
a
a
a
s
a
1
12
23
3
1
3
Now eliminate the auxiliary variable P23 in the state-space shell, using the remain-
ing equations. We obtain
	
=
−
−
=
−
−
P
P
P
P
P t
R Q
P
( )
a
a
s
eq
a
23
1
12
3
3
Hence, the state-space model is given as follows.
State Equations:
	
=
dP
dt
C
Q
1
a
grv
3
	
(i)
	
=
−
−


dQ
dt
I
P t
P
R Q
1
( )
eq
s
a
eq
3
	
(ii)
	
ρ
=
h
g P
Output Equation:
1
a
3
	
(iii)
Corresponding matrices are:
	
ρ
=
−
−








=








=








=
A
B
C
D
C
I
R
I
I
g
0
1
1
;
0
1
;
1
0
;
0
grv
eq
eq
eq
eq
	 (c)	 Substitute Equation (i) into (ii):
	
=
−
−
I C
d P
dt
P t
P
R C
dP
dt
( )
eq
grv
a
s
a
eq
grv
a
2
3
2
3
3
Now substitute Equation iii for P3a:
	
ρ
+
+
=
I C
d h
dt
R C
dh
dt
h
g P t
1
( )
eq
grv
eq
grv
s
2
2
This is the input–output model.

98
Modeling of Dynamic Systems with Engineering Applications
LEARNING OBJECTIVES
•	 Modeling of fluid systems
•	 Compensation for gravity head in a vertical pipe
•	 Proper choice of state variables
•	 Development of a state-space model
•	 Development of an input–output model
▪
Example 3.8
Consider the pneumatic system shown in Figure 3.16a. The pressure source (pressure-
controlled pump) of gauge pressure Ps generates a gauge pressure Pl at a distant location, 
which drives a load. Suppose that the load is not defined yet. There is a bellows unit of 
gauge pressure Pb, which acts as a pneumatic capacitor (due to the compressibility of the 
gas and the flexibility of the bellows). The pipeline from the pump to the bellows has 
pneumatic inertance Imf  and pneumatic resistance Rmf. The branch from the bellows to 
the load has pneumatic resistance Rml. The absolute pressures at various locations of the 
pneumatic system are indicated in Figure 3.16a. Also, Qm = mass flow rate of gas from the 
pump; Pa = ambient pressure.
	 (a)	 Taking Qm and Pb as the state variables, obtain a state-space model for the pneu-
matic system. What are system inputs?
	 (b)	 Suppose that the load is a pneumatic cylinder of area A, which drives a 
mechanical system represented by mass m, spring of stiffness k and viscous 
damper of damping constant b, as shown in Figure 3.16b. Enhance the state-
space model to incorporate this specific load, by including the additional state 
variables: Pl, v = velocity of the piston, and fk = stiffness of the spring.
(a) 
Pa
Pa
Bellows (Pb)
Pa
P3
Qmb
Qn
P2
P1
Imf
Rmf
Rml
P4, Qml to load (Pl)
Pump (Ps)
Cmb
(b)
k
v
m
b
Area A
P4, Qml
Cml
(c) 
k
b
Pl A
m
v
fk
fb
fk
fb
v
fk
fb
0
FIGURE 3.16
(a) Pneumatic system; (b) details of the load; and (c) free-body diagrams of the load elements.

99
Analytical Modeling
Solution
	 (a)	 Constitutive equations:
	
=
C
dP
dt
Q
Bellows (capacitor):
mb
b
mb	
(i)
where Q
= mass flow rate into the bellows
mb
Note: Cmb represents the capacitance due to both gas compressibility and bel-
lows flexibility.
	
=
−
I
dQ
dt
P
P
Inertor:
mf
m
1
2	
(ii)
	
−
=
R
P
P
R Q
Resistor
:
mf
mf
m
2
3
	
(iii)
	
−
=
R
P
P
R Q
Resistor
:
ml
ml
ml
3
4
	
(iv)
Note: Equations (i) and (ii) represent the state-space shell.
	
−
−
=
Q
Q
Q
Node Equation:
0
m
mb
ml
	
(v)
Compatibility Equations:
	
−
−
−
−
−
−
−
=
⇐
=
−
=
−
P
P
P
P
P
P
P
P
P
P
P
P
P
P
Loop 1:
(
)
(
)
(
)
0
satisfied
Note:
,
a
a
s
a
b
a
1
1
2
2
3
3
1
3
	
(vi)
	
−
−
−
−
−
−
−
−
−
=
⇐
=
−
P
P
P
P
P
P
P
P
P
P
P
P
P
Loop 2:
(
)
(
)
(
)
(
)
0
satisfied
Note:
a
a
l
a
1
1
2
2
3
3
4
4
4
	
(vii)
Eliminate Auxiliary Variables:
	
=
−
=
−
−
=
−
−
−
−
=
−
−
Q
Q
Q
Q
R
P
P
Q
R
P
P
P
P
Q
R
P
P
1 (
)
1 [(
)
(
)]
1 (
)
mb
m
ml
m
ml
m
ml
a
a
m
ml
b
l
3
4
3
4
This gives the state equation:
	
=
−
−
C
dP
dt
Q
R
P
P
1 (
)
mb
b
m
ml
b
l
	
(viii)
	
−
=
−
−
−
−
−
=
−
−
−
=
−
−
P
P
P
P
P
P
P
P
P
P
P
P
P
R Q
P
(
)
(
)
from (vi)
(
)
from (iii)
a
a
s
b
s
mf
m
b
1
2
1
2
3
3
2
3
This gives the state equation:
	
=
−
−
I
dQ
dt
P
R Q
P
mf
m
s
ml
m
b	
(ix)

100
Modeling of Dynamic Systems with Engineering Applications
Equations (viii) and (ix) are the state equation
This is a second-order system. Ps and Pl are the inputs.
	 (b)	 The load is shown in Figure 3.16b. The free-body diagrams of the mass, spring, 
and damper elements are shown in Figure 3.16c.
	
ρ
=
−
−
=
=
−
=
m dv
dt
PA
f
f
df
dt
kv
f
bv
Q
Av
C
dP
dt
Mass:
Spring:
Damper:
Cylinder:
l
k
b
k
b
ml
ml
l
	
	 where Cml = pneumatic capacitance of gas in cylinder.
Substitute (from before): 
=
−
Q
R
P
P
1 (
)
ml
ml
b
l
Additional (3) state equations:
	
=
−
−
m dv
dt
PA
f
bv
l
b
	
(x)
	
=
df
dt
kv
k
	
(xi)
	
ρ
=
−
−
C
dP
dt
R
P
P
Av
1 (
)
ml
l
ml
b
l
	
(xii)
Now we have a fifth-order state-space model given by equations (viii)–(xii). 
LEARNING OBJECTIVES
•	 Modeling of pneumatic systems
•	 The use of mass flow rate (rather than volume flow rate)
•	 System modeling under unknown load conditions
•	 Dependence of the system order on the load dynamics
▪
3.5.4  Modeling in the Thermal Domain
In the thermal domain, modeling is somewhat simplified by the fact that there is no ther-
mal inductor (there exist only a thermal capacitor and thermal resistor). Now, we present 
illustrative examples for modeling in the thermal domain.
Example 3.9
A simplified model of a hot water heating system is shown in Figure 3.17.
Pertinent nomenclature is as follows.
Qs = rate of heat supplied by the furnace to the water heater (= 1000 kW)
Ta = ambient temperature (°C)
Th = temperature of water in the water heater – assumed uniform (°C)

101
Analytical Modeling
To = temperature of the water leaving the radiator (°C)
Qr = rate of heat transfer from the radiator to the ambience (kW)
M = mass of water in the water heater (= 500 kg)
m  = mass flow rate of water through the radiator (= 25 kg/min)
c = specific heat of water (= 4200 J/kg/°C).
The radiator satisfies the equation:
	
−
=
T
T
R Q
h
a
r
r
where Rr = thermal resistance of the radiator 
×
°
−
(2
10
C/kW)
3
	 (a)	 What are the inputs to the system?
	 (b)	 Using Th as a state variable, develop a state-space model for the system.
	 (c)	 Give output equations for Qr and To. Discuss their characteristics.
Solution
	 (a)	
	
Qs is the deliberate input to the system. Since Ta varies and affects the response 
of the system as a result, it is also an input. In fact it is an unintentional input, 
and it can be considered as a disturbance input.
	
Input vector = 

u
Q
T
s
a
T
	 (b)	
	
Constitutive Equation of the Thermal Capacitor (Water Heater):
Rate of increase of thermal energy = Net heat inflow rate into the heater
Thermal capacitance of the water heater, 
=
C
Mc
h
Rate of heat supplied to the water by the furnace = Qs
Rate of heat carried out by the water from the heater = dm
dt cTh
Rate of heat brought back with water returning into the heater = dm
dt cTo
Hence, the constitutive equation of the water heater is
	

=
−
−
Mc dT
dt
Q
mc T
T
(
)
h
s
h
o 	
(i)
Radiator Rr
Outlet water
(To)
Heated space
(Ta)
Qr
˙
Mass flow (m)
Water
heater
Furnace
Qs(t)
Th , M, c
FIGURE 3.17
A household heating system.

102
Modeling of Dynamic Systems with Engineering Applications
Constitutive Equation of the Thermal Resistor (Radiator):
	
−
=
T
T
R Q
(
)
h
a
r
r	
(ii)
Continuity Equation (Node Equation) of the Radiator:
Net heat inflow rate into the radiator = 0 
We have,
	

−
−
=
mc T
T
Q
(
)
0
h
o
r
	
(iii)
We need to eliminate the auxiliary variable To in (i), in order to obtain the state equation 
for the present first-order thermal system. We accomplish this by substituting (ii) into 
(iii). We obtain
	

−
=
=
−
mc T
T
Q
T
T
R
(
)
(
)
h
o
r
h
a
r
Substitute this result into (i):
	
= −
+
+
Mc dT
dt
T
R
Q
T
R
h
h
r
s
a
r
Note the single state variable and the two inputs.
	 (c)	
From Part (ii):
	
=
−
Q
T
T
R
(
)
r
h
a
r
and
	

−
=
−
mc T
T
T
T
R
(
)
(
)
h
o
h
a
r
On algebraic manipulation, we get the two output equations:
	
=
−
Q
T
R
T
R
r
h
r
a
r
	


=
−




+
T
R mc T
R mc T
1
1
1
o
r
h
r
a
Now, 
State vector = 

x
Th
Input vector = 

u
Q
T
s
a
T
Output vector 
= 

y
Q
T
r
o
T
We have the complete state-space model: 
	
 =
+
=
+
x
Ax
Bu
y
Cx
Du

103
Analytical Modeling
where
	


= 



=








=
−














=
−














A
B
C
D
McR
Mc
McR
R
mcR
R
mcR
1
;
1
1
;
1
1
1
;
0
1
0
1
r
r
r
r
r
r
Note: The non-null D matrix is present because of the feed-forward path of one of the 
inputs (Ta) to both outputs.
LEARNING OBJECTIVES
•	 Modeling of thermal systems
•	 Proper formulation of constitutive equations and continuity equations
•	 The number of outputs can be greater than the number of states
•	 The presence of “feed-forward” terms in the output equations, and their 
­implications.
▪
Example 3.10
A simplified model of an active chilled beam air conditioning system is sketched in 
Figure 3.18.
The heat exchanger is represented by a copper slab of thermal capacitance Ch. Its aver-
age temperature is Th. The air that is pumped into the system (possibly recirculated 
from the cooled space) enters the heat exchanger at temperature Tai and leaves it (into 
the cooled space) at temperature Tao.
Chiller
(Chilled beam)
Thermal insulation
Air handling
unit
Heat exchanger slab
Two
Qw
Twi
Tao
Tai
Qa
ha, Aa
hw, Aw
Th, Ch
ca
ma
mw
cw
Cooled space
Water pump
Thermal insulation
˙
˙
FIGURE 3.18
An active chilled beam air conditioning system.

104
Modeling of Dynamic Systems with Engineering Applications
The water that is pumped into the system from the chiller enters the heat exchanger 
at temperature Twi and leaves it at temperature Two. The following parameters are given:
	
ma = mass flow rate of air
	
mw = mass flow rate of water
	
ca = specific heat of air (at constant pressure)
	
cw = specific heat of water
	
Ch = thermal capacitance of the heat exchanger
	
ha = convective heat transfer coefficient at the air-side of the heat exchanger, 
with effective area Aa
	
hw = convective heat transfer coefficient at the water-side of the heat exchanger, 
with effective area Aw
	 (a)	 What are the inputs and what are the outputs of the system?
	 (b)	 Develop a complete state-space model for the system. Indicate some character-
istics of this model.
Solution
	 (a)	 The inputs of the system are Twi (a deliberate input) and Tai (an unintentional or 
disturbance input).
	
	
The outputs of the system are Tao (the desired output), Two, and Th. Of course 
it is up to the engineer (model developer) to decide which outputs among these 
should be included in the model.
	 (b)	 The constitutive equations are given below.
	
	
Heat exchanger slab (thermal capacitor):
	
=
−
C dT
dt
Q
Q
h
h
a
w	
(i)
where
	
Qa = heat transfer rate from the air into the heat exchanger
	
Qw = heat transfer rate from the heat exchanger into the water
Air-side wall (thermal resistor):
	
=
−
Q
h A T
T
(
)
a
a
a
a
h 	
(ii)
with 
=
+
T
T
T
2
a
ai
ao  (This is a common approximation in modeling HVAC system 
equations)
Thermal resistance 
=
R
h A
1
a
a
a
Water-side wall (thermal resistor):
	
=
−
Q
h A
T
T
(
)
w
w
w
h
w 	
(iii)
with 
=
+
T
T
T
2
w
wi
wo  (as commonly approximated in this type of models)
Thermal resistance 
=
R
h A
1
w
w
w
Note: In general heat exchangers, 
≠
A
A
a
w
Node equation (thermal energy conservation) for air flow:
	


−
=
m c T
m c T
Q
a
a
ai
a
a
ao
a	
(iv)

105
Analytical Modeling
Node equation (thermal energy conservation) for water flow:
	


+
=
m c T
Q
m c T
w w
wi
w
w w
wo	
(v)
Now we eliminate the auxiliary variables to obtain the state equation (first-order 
system) from the state-space shell equation (i).
Substitute (ii) and (iii) into (i):
	
=
−
−
−
⇒
+
+




=
+
=
×
+
+
×
+
C dT
dt
R
T
T
R
T
T
C dT
dt
R
R
T
R T
R T
R
T
T
R
T
T
1 (
)
1 (
)
1
1
1
1
1
2
1
2
h
h
a
a
h
w
h
w
h
h
a
w
h
a
a
w
w
a
ai
ao
w
wi
wo
	
(i)
Substitute (ii) into (iv):
	



=
−
=
−
−
=
−
+
−




=
⇒
+
=
−
+
→
=
−
+
+
+
T
T
Q
m c
T
h A
m c
T
T
T
p
T
T
T
p
h A
m c
p
T
p
T
p T
T
p
p
T
p
p
T
(
)
2
where
(1
/2)
(1
/2)
(1
/2)
(1
/2)
(1
/2)
ao
ai
a
a
a
ai
a
a
a
a
a
h
ai
a
ai
ao
h
a
a
a
a
a
a
ao
a
ai
a
h
ao
a
a
ai
a
a
h
	
(vi)
Note: This is indeed an output equation.
Substitute (iii) into (v):
	



=
+
=
+
−
=
+
−
+




=
⇒
+
=
−
+
→
=
−
+
+
+
T
T
Q
m c
T
h A
T
T
m c
T
p
T
T
T
p
h A
m c
p
T
p
T
p T
T
p
p
T
p
p
T
(
)
2
where
(1
/2)
(1
/2)
(1
/2)
(1
/2)
(1
/2)
wo
wi
w
w w
wi
w
w
h
w
w w
wi
w
h
wi
wo
w
w
w
w w
w
wo
w
wi
w
h
wo
w
w
wi
w
w
h
	
(vii)
Note: This is another output equation.
Substitute (vi) and (vii) into (i)* to eliminate the auxiliary variables Tao and Two.
	
+
+




=
−
+
+
+




+
−
+
+
+



+
+
⇒
+
+
−
+
−
+




=
−
+
+




+
−
+
+




C dT
dt
R
R
T
R
p
p
T
p
p
T
R
p
p
T
p
p
T
T
R
T
R
C dT
dt
R
R
p
R
p
p
R
p
T
p
p
R T
p
p
R T
1
1
1
2
(1
/2)
(1
/2)
(1
/2)
1
2
(1
/2)
(1
/2)
(1
/2)
2
2
1
1
2
(1
/2)
2
(1
/2)
(1
/2)
(1
/2)
1
1
2
(1
/2)
(1
/2)
1
1
2
h
h
a
w
h
a
a
a
ai
a
a
h
w
w
w
wi
w
w
h
ai
a
wi
w
h
h
a
w
a
a
a
w
w
w
h
a
a
a
ai
w
w
w
wi

106
Modeling of Dynamic Systems with Engineering Applications
We now have the state-space equation:
	
+
+
+
+






=
+
+
+
C dT
dt
R
p
R
p
T
R
p
T
R
p
T
2
1
(2
)
1
(2
)
2
(2
)
2
(2
)
h
h
a
a
w
w
h
a
a
ai
w
w
wi
The output equations are (vi) and (vii). The state variable Th is also an output.
LEARNING OBJECTIVES
•	 Modeling of thermal systems
•	 Proper formulation of constitutive equations and continuity equations
•	 The number of outputs can be greater than the number of states
•	 The presence of “feed-forward” terms in the output equations.
▪
Summary Sheet
Types of Analytical Models: Time-domain model (differential equations with time t as 
the independent variable, e.g., state state-space model—a set of first-order differential 
equations in time, and input–output model—input–output differential equations in time); 
Transfer function model (This is an input–output model. Set of transfer functions: [Laplace 
transform of output]/[Laplace transform of input], independent variable is Laplace variable 
s); Frequency domain model (Frequency transfer function or frequency response function. 
A special case of Laplace transfer function, with s = jω. Independent variable is frequency 
ω). Discrete-time forms of these models are used in digital computer implementation and 
simulation. Notable: Difference equations (discretized differential equations), correspond-
ing z-transform transfer functions 
Analytical Model Simplification: Nonlinear → linear (principle of superposition and 
interchangeability in series connection hold; continuous time → discrete time; distributed 
(continuous) parameter → lumped-parameter; time-varying (or non-stationary or non-
autonomous) → time-invariant (or stationary or autonomous); Random (or stochastic or 
probabilistic) → deterministic models
Discrete-time Systems: Sampling rate 
∆
=
f
T
1
s
, sampling period = ∆T; sampled data at 
constant ∆T: 
…
…
{ } {
}
=
+
x
x
x
x x
,
,
,
,
,
k
k
k
0
1
1
, Its z-transform 
∑
( ) =
−
=
∞
X z
x z
k
k
k 0
; nth order linear 
difference equation: 


+
+
+
=
+
+
+
−
−
−
−
a y
a y
a y
b u
b u
b u
k
k
n
k n
k
k
m
k m
0
1
1
0
1
1
 → discrete transfer 
function: 


( )
( )
( )
=
=
+
+
+
+
+
+
−
−
−
−
G z
Y z
U z
b
b z
b z
a
a z
a z
m
m
n
n
0
1
1
0
1
1
, u = input, y = output.
Sampling Theorem: In sampled data, no information regarding frequency spectrum X(  f  ) 
is found for frequencies → Nyquist (cut-off) frequency 
∆
=
=
f
T
f
1
2
1
2
c
s
Aliasing Error: Caused by sampling → folding of high-frequency segment of frequency 
spectrum beyond Nyquist frequency onto the low-frequency segment. Method of reducing 

107
Analytical Modeling
it: (1) Increase sampling frequency (increased data) and (2) Use an anti-aliasing filter of cut-
off at <
f
1
2
s
Lumped Model of Heavy Spring: One end fixed, equivalent lumped mass at other end. 
(1) Energy equivalence → 
×
1
3
spring mass and (2) Energy equivalence → 
×
0.4
spring mass
Properties of State Models: (1) State x(t0) at time t0 and input u[t0, t1] over time interval [t0, 
t1], uniquely determine state x(t1) time t1 ⇒ Non-anticipative g: x(t1) = g(t0, t1, x(t0), u[t0, t1]); 
i.e., inputs beyond t1 are not needed and (2) x(t1) and u(t1) at t1 will uniquely determine 
output ( ) ⇒
y t1
 Memory-less h: y(t1) = h(t1, x(t1), u(t1))
Nonlinear State Model:  =
x
f x u t
( , , ), 
=
y
h x u t
( , , )
Linear State Model:  =
+
x
Ax
Bu, 
=
+
y
Cx
Du
Properties: (1) State model: n first-order differential equations (coupled) using n state vari-
ables (nth-order); (2) Determines dynamic state x of system; (3) n state variables x1, x2, …, 
xn are the required minimum and maximum number (minimal set) ⇒ a state variable 
cannot be expressed as a linear combination of the remaining state variables; (4) x traces 
a trajectory in state space (vector space of x); (5) x is not unique. Many choices are possible; 
(6) x may or may not have a physical interpretation; and (7) Output (response) variables 
can be completely determined from any choice of state variables. To complete state model, 
include output equations (m algebraic equations relating outputs to states; Sometimes con-
tain inputs as well—feedforward case)
Steps of Developing of a State Model: Assume that inputs (u) and outputs (y) are 
specified/identified. (1) Identify system elements/components (e.g., energy storage ele-
ments, energy dissipative elements, input/source elements). Draw a structural diagram 
(circuit diagram, linear graph, bond graph, etc.) to show their interconnection; (2) State-
variable (x) Selection: Across-variables of independent A-type energy storage elements 
and through-variables of independent T-type energy storage elements; (3) Write constitu-
tive equations for all elements in the system (energy storage elements, energy dissipa-
tive elements, two-port elements); (4) Write continuity equations for through-variables at 
each node (points connecting two or more components); (5) Write compatibility equations 
for across-variables around each loop (closed path that is formed by two or more system 
components); (6) State-space Shell: Constitutive equations for the independent energy stor-
age elements. Eliminate redundant/unwanted variables in state-space shell (by using the 
remaining equations); and (7) Express outputs in terms of state variables (in the presence 
of feed-forward character, input variables will have to be included)
Comments: (1) Some continuity (node) equations and compatibility (loop) equations may 
be automatically satisfied by the choice of variables; (2) Some node equations and/or loop 
equations may not be needed for the elimination of auxiliary variable in the state-space 
shell (e.g., dependent variables of sources); and (3) In mechanical systems, compatibility 
equations are automatically satisfied because inertial reference (ground) is used for inertia 
elements and input elements 
Input–Output Model from State Model: (1) Differentiate output equations → 


=
+
y
Cx
Du; 
(2) Eliminate x by substituting state equations → 

=
+
+
y
CAx
CBu
Du; and (3) Use these and 
output equations to eliminate x. 

108
Modeling of Dynamic Systems with Engineering Applications
Problems
	 3.1	 Indicate whether a distributed-parameter method is needed or a lumped-parame-
ter model is adequate in the study of following dynamic systems:
	
(a)	 Vehicle suspension system (motion)
	
(b)	 Elevated vehicle guideway (transverse motion)
	
(c)	
Oscillator circuit (electrical signals)
	
(d)	 Environment (weather) system (temperature)
	
(e)	 Aircraft (motion and structural stresses)
	
(f)	
Large transmission cable (electrical capacitance and inductance).
	 3.2	 Indicate two approaches of determining the parameters of a lumped-parameter 
model that is (approximately) equivalent to a distributed-parameter (i.e., continu-
ous) dynamic system.
	
	
One end of a heavy spring of mass ms and stiffness ks is attached to a lumped mass 
m. The other end is attached to a support that is free to move, as shown in Figure P3.2. 
	
	
Using the method of natural frequency equivalence, determine an equiva-
lent lumped-parameter model for the spring where the equivalent lumped 
mass is located at the free end (support end) of the system. The natural frequen-
cies of a heavy spring with one end fixed and the other end free are given by 
ω
π
=
−
n
k
m
2 (2
1)
n
s
s
, where n is the mode number.
	 3.3	 What are some of the limitation in using the equivalent lumped-mass model, 
through energy equivalence (specifically, kinetic energy equivalence, because 
potential energy equivalence is automatically satisfied through the stiffness 
parameter, which is the same for the heavy spring and its lumped model), for a 
heavy spring (with distributed mass)? 
	 3.4	 One end of a heavy, uniform, helical spring of mass ms and stiffness k is fixed and 
the other end is attached to an object of mass M, which is free to move on rollers 
(see Figure P3.4a). Using the method of natural frequency equivalence determine 
equivalent lumped masses, one to be located at the midpoint of the spring and the 
other at the free end (see Figure P3.4b) in an equivalent lumped-parameter model.
m
Free end
ms, ks
FIGURE P3.2
A mechanical system with a heavy spring and attached mass.

109
Analytical Modeling
	
	
Hint: The natural frequencies of a heavy helical spring with one end fixed and 
the other end free are given by ω
π
=
−
n
k
m
2 (2
1)
n
s
, where n is the mode number. 
Use only the first two modes (i.e., n = 1 and 2) in this example.
	 3.5	 Answer the following questions true or false:
	
(a)	
A state-space model is unique
	
(b)	 The number of state variables in a state vector is equal to the order of the 
system
	
(c)	
The outputs of a system are always identical to the state variables
	
(d)	 Outputs can be expressed in terms of state variables
	
(e)	
State model is a time-domain model.
	 3.6	 List three things to which the order of an electromechanical dynamic system is 
equal.
	
Write down the order of the systems shown in Figure P3.6.
	 3.7	 Real systems are nonlinear. Under what conditions a linear model is sufficient in 
studying a real system?
	
Consider the following system equations:
k, ms
M
L
(a)
m1
m2 + M
2
L
2
L
(b)
FIGURE P3.4
(a) A system with a uniform heavy spring and (b) an approximate lumped-parameter model.
u(t)
(a)
(b)
(c)
(d)
FIGURE P3.6
Models of four mechanical systems

110
Modeling of Dynamic Systems with Engineering Applications
	
(a)	 

ω
+
+
+
=
y
t
y
y
u t
(2sin
3)
5
( )
	
(b)	
 −
=
y
y
u t
3
2
( )
	
(c)	


+
+
=
y
y
y
u t
3
2
( )
3
	
(d)	


+
+
=
y
y
y
u t
5
2
3
5 ( )
	
(i)	 Which ones of these are linear?
	
(ii)	 Which ones are nonlinear?
	
(iii)	 Which ones are time-variant?
	 3.8	 Identify some dynamic characteristics in the flowing five state-space models. Also 
tabulate the matrices A, B, C, and D for the five models.
	
(a)
	


=
+
+
=
−
−
=
+
x
x
x
u
x
x
x
u
y
x
x
2
3
2
1
1
2
1
2
1
2
2
1
2
	
(b)
	


=
+
+
=
−
=
+
x
x
x
u
x
x
x
y
x
x
2
3
2
1
1
2
2
1
2
1
2
	
(c)
	


=
+
=
−
=
+
x
x
x
x
x
x
y
x
x
2
3
2
1
1
2
2
1
2
1
2
	
(d)
	


=
+
=
−
=
x
x
u
x
x
x
y
x
2
1
1
2
1
2
1
	
(e)
	


=
+
+
=
−
−
=
+
+
x
x
x
u
x
x
x
u
y
x
x
u
2
3
2
3
1
1
2
1
2
1
2
2
1
2
1
	 3.9	 Consider a system given by the state equations:
	


=
+
= −
+
x
x
x
x
x
u
2
2
1
1
2
2
1
	
in which x1 and x2 are the state variables and u is the input variable. Suppose that 
the output y is given by: y = 2x1 – x2. 
	
(a)	 Write this state-space model in the vector-matrix form:
	
 =
+
x
Ax
Bu
	
=
y
Cx

111
Analytical Modeling
	
and identify the elements of the matrices A, B, and C.
	
(b)	 What is the order of the system?
	3.10	Consider the mass-spring system shown in Figure P3.10.
	
The mass m is supported by a spring of stiffness k and is excited by the 
dynamic force f(t).
	
(a)	 Taking f(t) as the input, and position and speed of the mass as the two outputs, 
obtain a state-space model for the system.
	
(b)	 What is the order of the system?
	
(c)	 Repeat the problem, this time taking the compression force in the spring as 
the only output.
	
(d)	 How many initial conditions are needed to determine the complete response 
of the system?
	3.11	A torsional dynamic model of a pipeline segment is shown in Figure P3.11a. The 
free-body diagram (FBD) in Figure P3.11b shows the internal torques acting at 
sectioned inertia junctions for free motion.
Develop a state model for this system by using the generalized velocities (angu-
lar velocities Ωi) of the independent inertia elements and the generalized forces 
(torques Ti) of the independent elastic (torsional spring) elements as the state vari-
ables. A minimum set of states that is required for a complete representation of the 
system dynamics determines the system/model order.
Spring
Mass
m
k
Position y 
Force f(t) 
FIGURE P3.10
A mechanical system.
k1
k2
k3
T1
T2
T3
I1
I2
(a)
T2
T3
(b)
T1
T1
T2
T2
T2
T3
Ω1
Ω2
FIGURE P3.11
(a) Dynamic model of a pipeline segment and (b) free body diagram.

112
Modeling of Dynamic Systems with Engineering Applications
	3.12	A one-quarter model of a vehicle is shown in Figure P3.12a. Since the gravita-
tional forces (of the masses m1 and m2) are balanced by the static deflections of 
the springs, they can be ignored in the model, assuming that the deflections are 
measured with respect to these static positions of the springs. The corresponding 
horizontal model is shown in Figure P3.12b.
	
(a)	 For a systematic and unified (domain-independent) procedure in the develop-
ment of a state-space model of the system, identify the nodes and the loops of 
the model, and indicate the relevant through-variables and across-variables.
	
(b)	 Write: loop equations (and show that they are implicitly satisfied); node equa-
tions; and constitutive equations.
(a)   
m2
m1
1/4  mass of car body
Suspension system
Wheel + axle
Tire
v2
v1
v(t)
k2
k1
b2
b1
Velocity input from
road irrequilarilies
(b)   
m1
m2
k1
k2
b1
b2
v(t)
v1
v2
FIGURE P3.12
(a) Quarter model of a vehicle and (b) horizontal model (gravity balanced by static deflection of spring). 

113
Analytical Modeling
	
(c)	 By eliminating the auxiliary variables, determine a state-space model for the 
system.
	
	
Note: Take the velocities of the independent masses and the compressive 
forces in the independent springs as the state variables. The input to the vehi-
cle model is the velocity v t( ) that is imparted on the tires in the vertical direc-
tion, due to the irregularities of the road surface as the vehicle moves at some 
speed.
	
(d)	 Complete the state-space model by developing the output equation for the 
three cases: 
	
(i)	 The outputs (two) are the heave velocity of the passenger compartment and 
the suspension force (spring and damper combined).
	
(ii)	 The output is the vertical (heave) displacement of the car body with respect 
to the wheel axle.
	
(iii)	 The output is the absolute vertical displacement of the car body. 
	
3.13
	
(a)	 It is desirable to have a modeling approach that is integrated, unified, and 
systematic. Briefly explain the meanings of these three terms in the present 
context.
	
(b)	 A flow-controlled pump supplies a liquid to the bottom of a uniform tank. 
The bottom of this tank is connected to the bottom of a second uniform tank 
through a long uniform pipe. See Figure P3.13.
Given: 
Mass density of the liquid = ρ 
Volume flow rate of the supply pump (system input) = Q t( )
s
Area of cross-section of the first tank = A1
Area of cross-section of the second tank = A2
Gauge pressure at the bottom of the first tank = P1
Gauge pressure at the bottom of the second tank = P2
Volume flow rate of the liquid in the connecting pipe = Q f
Fluid resistance in the pipe = R f
Fluid inertance in the pipe = I f
Qs(t)
Flow-controlled
pump
In flow
Qf
Tank 2
Tank 1
ρ, A1
ρ, A2
h1
h2
P1
P2
Rf
If
FIGURE P3.13
A pump-controlled two-tank system.

114
Modeling of Dynamic Systems with Engineering Applications
Using
=
u
Q t
[
( )]
s
 as the input
= 

x
P
Q
P
f
T
1
2
 as the state vector
= 

y
h
h
T
1
2
 as the output vector
	
	 determine a complete state-space model for the system. In particular, determine 
the matrices A B C
,
,  and D.
	
	 Acceleration due to gravity = g
Note 1: Express your results only in terms of the given system parameters 
ρ
A A
I
R
,
, ,
,
.
f
f
1
2
Note 2: Gauge pressure is the pressure that is measured with respect to the ambient 
pressure.
	3.14	Figure P3.14 shows a spring-loaded accumulator for liquid. The following param-
eters are given:
A = area of cross-section (uniform) of the accumulator cylinder
K = spring stiffness of the accumulator piston
ρ = mass density of the liquid.
	
	 Assume that the liquid is incompressible. The following variables are important:
=
−
P
P
P
21
2
1 = pressure at the inlet of the accumulator with respect to that at the top 
(flexible) wall (P1)
=
−
P
P
P
r
r
1
1
 = pressure at the top of the accumulator (flexible wall) with respect to 
the ambient reference (Pr)
Q = volume flow rate of liquid into the accumulator
h = height of the liquid column in the accumulator.
	
	 Note: The piston (wall) of the accumulator can move against the spring, thereby 
varying h. 
Considering the effects of the movement of the spring loaded accumulator wall 
and also the gravity head of the liquid in the accumulator, obtain an expression 
for the equivalent fluid capacitance Ceq of the accumulator in terms of k, A, ρ, and g. 
Are the two capacitors that contribute to Ceq (i.e., wall stretching of the accumula-
tor wall at the top of the liquid column and gravity head of the liquid column) 
connected in parallel or in series?
Spring
k
Air
Accumulator
Area A 
Liquid
Liquid
h
1
2
r
Q
FIGURE P3.14
Model of a liquid accumulator.

115
Analytical Modeling
Note: Neglect the effect of the bulk modulus (compressibility) of the liquid.
	
3.15
	
(a)	
Briefly explain why a purely thermal system typically cannot have a natural 
(free) oscillatory response whereas a fluid system can.
	
(b)	
Figure P3.15 shows a pressure-regulated system that can provide a high-speed 
jet of liquid. The system consists of a pump, a spring-loaded accumulator, and 
a fairly long section of piping, which ends with a nozzle. The pump is consid-
ered as a flow source of value Qs. The following parameters are important:
A = area of cross-section (uniform) of the accumulator cylinder
K = spring stiffness of the accumulator piston
L = length of the section of piping from the accumulator to the nozzle
Ap = area of cross-section (uniform, circular) of the piping
Ao = discharge area of the nozzle
Cd = discharge coefficient of the nozzle
ρ = mass density of the liquid.
Assume that the liquid is incompressible. The following variables are important:
Spring
k
Air
Accumulator
Area A
Liquid
Pump
Nozzle
Liquid
sump
Ao , cd , ρ
Q
2
1
L
Ap
h
Qs
4
FIGURE P3.15
Pressure regulated liquid jet system.

116
Modeling of Dynamic Systems with Engineering Applications
=
−
P
P
P
21
2
1 = pressure at the inlet of the accumulator with respect to the ambient 
reference Pr
Q = volume flow rate through the nozzle
h = height of the liquid column in the accumulator.
Note: The piston (wall) of the accumulator can move against the spring, thereby 
varying h. 
	
(i)	
Considering the effects of the movement of the spring loaded accumulator wall 
and also the gravity head of the liquid, obtain an expression for the equivalent 
fluid capacitance Ca of the accumulator in terms of k, A, ρ, and g. 
	
(ii)	
Note: Neglect the effect of the bulk modulus (compressibility) of the liquid.
	
(iii)	
Considering the capacitance Ca, the inertance I of the fluid volume in the piping 
(length L and cross-section area Ap), and the resistance of the nozzle only, develop 
a nonlinear state-space model for the system. The state vector x = 

P
Q
r
T
1
, and 
the input u = Q
[
]
s .
For the liquid flow in the (circular) pipe with a parabolic velocity profile, the iner-
tance 
ρ
=
I
L
A
2
p
, and for the discharge through the nozzle 
ρ
=
Q
A c
P
2
o d
r
2 , in which 
	
	
P2r = pressure inside the nozzle with respect to the outside reference (Pr)
	
	
cd = discharge coefficient.
	3.16	A model for the automatic gauge control (AGC) system of a steel rolling mill is 
shown in Figure P3.16. The rollers are pressed using a single acting hydraulic actu-
ator with a valve displacement of u. The rollers are displaced through y, thereby 
pressing the steel that is being rolled. For a given y, the rolling force F is completely 
known from the steel parameters. Identify the inputs and the controlled variable 
in this control system.
	
(i)	
In terms of the variables and system parameters indicated in Figure P3.16, 
write dynamic equations for the system, while including valve nonlinearities.
	
(ii)	
What is the order of the system? Identify the response variables.
	
(iii)	
What variables would you measure (and fed back through a suitable control-
ler) in order to improve the performance of the control system?
	3.17	An integrated-circuit (IC) package consists primarily of a wafer of crystalline sili-
con substrate on which a film of minute amounts of silicon dioxide, etc. is depos-
ited. It is heat treated at high temperature as an intermediate step in the production 
of IC chips. An approximate model of the heating process is shown in Figure P3.17. 
	
	
The package is placed inside a heating chamber whose walls are uniformly 
heated by a distributed heating element. The associated heat transfer rate into the 
wall is Qi. The interior of the chamber contains a gas of mass mc and specific heat 
cc, and is maintained at uniform temperature Tc. The temperature of silicon chip 
is Ts and that of the chamber wall is Tw. The outside environment is maintained at 
temperature To. The specific heats of the silicon package and the wall are denoted 
by cs and cw, respectively, and the corresponding masses are denoted by ms and 
mw, as shown. The convective heat transfer coefficient at the interface of silicon 
and gas inside the chamber is hs, and the effective surface area is As. Similarly, hi 

117
Analytical Modeling
and ho denote the convective heat transfer coefficients at the inside and outside 
surfaces of the chamber wall, and the corresponding surface areas are Ai and Ao, 
respectively.
	
(a)	 Using Ts, Tc, and Tw as the state variables, write state equations for the process.
	
(b)	 Express these equations in terms of the parameters 
=
C
m c
hs
s s, 
=
C
m c
hc
c c, 
=
C
m c
hw
w w, 
=
R
h A
1
s
s
s
, 
=
R
h A
1
i
i
i
, and 
=
R
h A
1
o
o
o
. Explain the electrical analogy 
and the physical significance of these parameters.
	
(c)	 What are the inputs to the process? If Ts is the output of importance, obtain the 
matrices A, B, C, and D of the state-space model.
	
(d)	 Comment on the accuracy of the model in the context of the actual physical 
process of producing IC chips.
mp
Area = A
Volume = V
Pressure = Ph
ρ
Ps – Ph
Q = ubcd
Valve
u
Flexible line (ignore
stiffness and
damping)
Q
Supply
Ps
km
cm
kr
cr
mr
y
Steel
plate
Rollers
yp
yc
Cylinder
F
F
mc
Piston
Damping
cp
FIGURE P3.16
Automatic gauge control (AGC) system of a steel rolling mill.

118
Modeling of Dynamic Systems with Engineering Applications
	3.18	A uniform metal bar of length l and area of cross-section A is heated to tempera-
ture Tb and placed in a thermally insulated compartment with one end exposed to 
the atmosphere of temperature Ta < Tb. Consider this as a part of a heat treatment 
process.
Given:
ρ = mass density of the bar
cp = specific heat (as constant pressure) of the bar
hc = convective heat transfer coefficient at the end exposed to the atmosphere
Qi
Tc
mc , cc
To
Ao
Heating
chamber
Silicon
package
Uniform
heating
element
Chamber
wall
ho
Ai
hi
Tw
mw
cw
As
hs
ms ,Cs
Ts
FIGURE P3.17
A model of the heat treatment of a IC package of silicon.
l/2
l/2
A, hc
Tb1
Tb2
k
•
•
Termal insulation
Atmospheric
temperature Ta
FIGURE P3.18
Improved model for the cooling bar.

119
Analytical Modeling
	
Divide the metal bar into two equal segments of length l/2. Taking the tempera-
tures in these two segments to be uniform at Tb1 and Tb2 (see Figure P3.18) obtain 
a state-space model for the cooling process of the bar.
The following numerical values are known:
	
	
=
=
=
l
A
h
0.2 m,
1.0 cm ,
100.0 W/m /°C
c
2
2
, conductive heat transfer coefficient 
=
k
125.0W/m/°C
	3.19	A simplified version of a counter-flow heat-exchanger tube is shown in Figure P3.19. 
Its outside is thermally insulated. The tubular core duct of radius ra and length L 
carries air, to be heated, in one direction, at the steady mass flow rate ma. Thick 
copper tubing of exterior radius rw (interior radius ra) and length L separates the 
air flow (core) from the counter-flow of water at the steady mass flow rate mw. A 
thermal insulation tube, which is placed outside the copper tube, forms an annular 
path for the water flow.
	
	
Hot water from the boiler enters the heat exchanger tube at temperature Twi and 
leaves it at temperature Two. The air flow enters the heat exchanger tube at tempera-
ture Tai and leaves it at temperature Tao.
	
	 In addition, the following parameters are given (known):
ρ = mass density of the heat exchanger (copper) tube
c = specific heat of the copper tube
cw = specific heat of water
Two
hw
Twi
Tai
Hot
water in
Hot air
out
Thermal insulation
Copper tube
Boiler
mw cw
p, c, Th
ha
Tao
L
Water out
Thermal insulation
Air in
Water out
mw
Air in
ma ca
˙
˙
Heat-exchanger
(copper) tube
(a)
(b)
(c)
rw
ra
˙
FIGURE P3.19
A counter-flow heat-exchanger unit. (a) Perspective view; (b) sectional side view; and (c) sectional end view. 

120
Modeling of Dynamic Systems with Engineering Applications
ca = specific heat of air (at constant pressure)
hw = convective heat transfer coefficient at the water-side wall of the heat-exchanger 
tube
ha = convective heat transfer coefficient at the air-side wall of the heat-exchanger 
tube
	
	 Also, let Th be the average temperature of the heat exchanger tube (copper).
	
(a)	 In terms of the given parameters, obtain expressions for:
	
(i)	 Thermal capacitance Ch of the heat exchanger (copper) tube 
	
(ii)	 Convective thermal resistance Rw at the water-side wall of the heat-
exchanger tube 
	
(iii)	 Convective thermal resistance Ra at the air-side wall of the heat-exchange 
tube
	
(b)	 What are the inputs and possible outputs of this system? 
	
(c)	 Taking Th as the state variable, develop a complete state-space model (includ-
ing the output equations) for this system.

121
4
Model Linearization
Chapter Highlights
•	 Common Nonlinearities and Properties
•	 Nonlinear Electrical Elements
•	 Analytical Linearization Using Local Slope
•	 Operating Conditions and Equilibrium State
•	 Linearization of State-Space Model
•	 Linearization of Input–Output Model
•	 Reduction of System Nonlinearities
•	 Linearization Using Experimental Data
•	 Experimental Model for Actuator Control
•	 Calibration Curve Method
•	 Equivalent Model Approach
•	 Describing Function Method
•	 Feedback Linearization
4.1  Introduction
Real systems are nonlinear and they are represented by nonlinear analytical models. 
Linear systems (models) are in fact idealized representations, and they are represented by 
linear differential equations in the time domain or by analytical transfer functions (ratio 
of polynomials) in the frequency domain. Clearly, it is far more convenient to analyze, 
simulate, design, and use/implement linear models. For such reasons, nonlinear systems 
are often “approximated” by linear models.
It is not possible to represent a highly nonlinear system by a single linear model in its 
entire range of operation. For small “changes” in response about some operating condi-
tion, a linear model may be used, which is valid in the neighborhood of the operating 
condition. Commonly, linearization about an operating condition is done based on the 
“local slope” of the nonlinearity at the operating condition. Such linearization is not 

122
Modeling of Dynamic Systems with Engineering Applications
always feasible or satisfactory, for reasons which we will highlight later. Then, problem-
specific and ad hoc approaches may have to be used to deal with system nonlinearities. 
In this chapter, we study linearization of a nonlinear system/model. The studied topics 
are as follows:
•	 Slope-based analytical linearization over a limited range of operation about an 
operating condition (for both state-space models and input–output models)
•	 Slope-based linearization using experimental models (experimental input–output 
data)
•	 Static linearization through recalibration or rescaling
•	 Linearization based on an equivalent model (using some criterion of equivalence 
such as energy)
•	 Describing function method of linearization (this method also uses a criterion of 
equivalence—fundamental frequency component of output)
•	 Feedback linearization
Examples are given to illustrate these methods of linearization.
4.2  Properties of Nonlinear Systems
In analytical and dynamic sense, a device is considered linear if it can be modeled by a set 
of linear differential equations with time t as the independent variable or by a set of ana-
lytical transfer functions (ratios of polynomials) with frequency ω as the independent vari-
able. The analytical transfer-function representation of a device implicitly assumes linear 
and constant-parameter (i.e., time-invariant) device. A useful property of a linear system 
is the satisfaction of the principle of superposition, as discussed in Chapter 3. Conversely, a 
nonlinear system does not obey the principle of superposition. In this section, we discuss 
some characteristic properties of nonlinear systems/devices/models, which distinguish 
them from linear systems/devices/models.
4.2.1  Static Nonlinearity
If the input–output relation of a device is a nonlinear “algebraic” equation, it represents 
a static nonlinearity. Such nonlinearity can be handled (or linearized) simply by using a 
proper calibration or rescaling curve. If, on the contrary, the input–output relation of a 
device is a nonlinear differential equation of time, it represents a dynamic nonlinearity. Then 
the analysis usually becomes more complex.
According to industrial and commercial terminology, a “linear” device (e.g., a measuring 
instrument) has its output proportional to the input (e.g., a measured value varies linearly 
with the value of the measurand—the variable that is measured). This is consistent with 
the definition of static linearity and is appropriate because for those commercial devices 
it is typically required that the operating range is outside the region where the dynamics 
appreciably affect the device output.

123
Model Linearization
4.2.2  Nonlinear Characteristics of Practical Devices
All physical devices are nonlinear to some degree. Broadly speaking, the nonlinear behav-
ior in devices may be classified into two types:
•	 Geometric (including kinematic) nonlinearity, specifically in a “mechanical” 
device
•	 Physical (including kinetic) nonlinearity
Geometric nonlinearity of a mechanical device stems primarily from large deflections or 
large motions of the device resulting in the introduction of nonlinear terms (e.g., trigo-
nometric terms such as sine, cosine, and tan) in the representation of its input–output 
behavior. Kinematic relations of a robotic arm are an example of geometric nonlinearity. 
Physical nonlinearity of a device results from the deviation from the linear (ideal) behavior 
of its physical relations due to such causes as electrical and magnetic saturation, deviation 
from Hooke’s law in elastic elements, Coulomb and Stribeck friction, creep at joints, aero-
dynamic damping, backlash in gears and other loose components, and component wear-
out. Nonlinear Newton’s second law equation (i.e., kinetic nonlinearity) in a mechanical 
system also falls into the category of physical nonlinearity.
Nonlinearities (particularly, physical nonlinearities) in devices are often manifested as 
some peculiar characteristics. Some examples are given as follows:
Saturation: Nonlinear devices may exhibit saturation (see Figure 4.1a). When saturated, 
the device output remains unchanged even when the input changes. This may be the result 
of causes such as magnetic saturation, which is common in magnetic induction devices 
 Device output
 Device output
 Device output
Transfer-function
magnitude
Transfer-function
magnitude
Saturation
level
Device input
Linear
range
Saturation
level
Device
input
d
–d
Device input
Frequency
Hardening nonlinearity
A
(Jump)
C
(Jump)
B
D
D
C
(Jump)
A
(Jump)
B
Frequency
Softening nonlinearity
Speed
Displacement
Limit cycle
(stable)
(a)
(b)
(c)
(d)
(e)
FIGURE 4.1
Common manifestations of nonlinearity in devices: (a) Saturation, (b) dead zone, (c) hysteresis, (d) jump phe-
nomenon, and e) limit cycle response.

124
Modeling of Dynamic Systems with Engineering Applications
and transformer-like devices (e.g., differential transformers), electronic saturation (e.g., in 
amplifiers), plasticity in mechanical components, and nonlinear springs.
Ideal relay: A special, ideal case of saturation is the two-state switching function or an 
ideal relay. In this case, the device saturates at two different (usually opposite) states and 
does not have a linear (or variable) region in between. Hence, the device can only switch 
between these two states (a relay).
Dead zone: A dead zone is a region in which a device would not respond to an excitation 
(input). Stiction in mechanical devices with Coulomb friction is a good example. Because 
of stiction, a component will not move until the applied force (input) reaches some mini-
mum value. Once the motion is initiated, subsequent behavior can be either linear or non-
linear. Another example is the backlash in loose components such as meshed gear wheels 
(where the rotation is the input and the transmitted torque is the output). Bias signal in 
electronic devices is a third example. In them, until the bias signal reaches a specific level, 
the circuit action will not take place (e.g., reverse bias in a diode until breakdown). A dead 
zone with subsequent linear behavior is shown in Figure 4.1b.
Note: In the case of stiction or Coulomb friction, if the input of the device is a motion 
(displacement or velocity) and the output is the corresponding force in the device, then 
the behavior corresponds to an ideal relay (see under saturation) rather than a dead zone.
Hysteresis: Nonlinear devices may produce hysteresis. In hysteresis, the value of the 
input–output curve at a particular point is different depending on the direction of the 
input (see Figure 4.1c), resulting in a hysteresis loop. This behavior is common in loose 
components such as gears, which have backlash; in components with nonlinear damping, 
such as Coulomb friction; and in magnetic devices with ferromagnetic media and vari-
ous dissipative mechanisms (e.g., eddy current dissipation). For example, consider a coil 
wrapped around a ferromagnetic core. If a dc current is passed through the coil, a mag-
netic field is generated. As the current is increased from zero, the field strength will also 
increase. Now, if the current is decreased back to zero, the field strength will not return 
to zero because of the residual magnetism in the ferromagnetic core. A negative current 
has to be applied to demagnetize the core. It follows that the field strength versus current 
curve looks somewhat like Figure 4.1c. This is magnetic hysteresis.
The presence of a hysteresis loop alone does not imply that the device is nonlinear. For 
example, linear viscous damping also exhibits a hysteresis loop in its force–displacement 
curve. This is a property of any mechanical component that dissipates energy (Area within 
the hysteresis loop gives the energy dissipated in one cycle of motion.). This topic is further 
explored in a problem at the end of the chapter. In general, if force in a device depends on 
the displacement (as in the case of a spring) and the velocity (as in the case of a damping 
element), the value of force at a given value of displacement will change depending on 
the direction of the velocity. In particular, the force when the component is moving in one 
direction (say, positive velocity) will be different from the force at the same location when 
the component is moving in the opposite direction (negative velocity), thereby producing 
a hysteresis loop in the force–displacement plane. If the relationship of the displacement 
and velocity to the force is linear (as in viscous damping), the hysteresis effect is linear. If, 
on the contrary, the relationship is nonlinear (as in Coulomb damping and aerodynamic 
damping), the resulting hysteresis is nonlinear.
Hysteresis loop and energy dissipation: When the two axes represent “force” and “dis-
placement,” it is known that the area of the hysteresis loop gives the net work done (or 
­dissipated energy) in one cycle of movement. In this case, the input is the force and the 
output is the displacement. Note the loop arrows in Figure 4.1c. Since “work done” is given 
by the integral of “force” × “incremental displacement,” the area projected on to the y-axis 

125
Model Linearization
(i.e., output axis or displacement axis) gives the work done. It is clear from Figure 4.1c that 
this area is greater in the forward direction of the loop (forward arrow) than in the back-
ward movement. Hence, the net area is positive and is equal to the area of the hysteresis 
loop, indicating an overall net work done (or energy dissipation).
Jump phenomenon: Some nonlinear devices exhibit an instability known as the jump 
phenomenon (or fold catastrophe) in the frequency response (transfer) function curve that 
is determined experimentally. This is shown in Figure 4.1d. As the frequency increases, 
the jump occurs from A to B; as the frequency decreases, it occurs from C to D. In par-
ticular, note the bending of the resonant peak, corresponding to either a hardening device 
(resonant frequency increases from the linear value; the peak bends forward) or a softening 
device (resonant frequency decreases from the linear value; the peak bends backward). 
Furthermore, the experimentally determined transfer function of a nonlinear device may 
depend on the magnitude of the input excitation (The experimental transfer function of 
a linear device does not depend on the magnitude of the input.). Also, read Section 4.6.3.
Limit cycles: A notable property of a nonlinear system is that its stability may depend 
on the system inputs and/or initial conditions. In particular, nonlinear devices may pro-
duce limit cycles. An example is given in Figure 4.1e on the phase plane (2D) of velocity 
versus displacement. A limit cycle is a closed trajectory in the state space that corresponds 
to sustained oscillations at a specific frequency and amplitude, without decay or growth. 
The amplitude of these oscillations is independent of the initial location from which the 
response started. In addition, an external input is not needed to sustain a limit cycle oscil-
lation. In the case of a stable limit cycle, the response will move onto the limit cycle irrespec-
tive of the location in the neighborhood of the limit cycle from which the response was 
initiated (see Figure 4.1e). In the case of an unstable limit cycle, the response will move away 
from it with the slightest disturbance.
Frequency creation: A linear device, when excited by a sinusoidal signal, will generate at 
steady state a response at the same frequency as the excitation. However, at steady state, a 
nonlinear device may create frequencies that are not present in the excitation signals. These 
created frequencies might be harmonics (integer multiples of the excitation frequency), sub-
harmonics (integer fractions of the excitation frequency), or nonharmonics (usually rational 
fractions of the excitation frequency). An example for this behavior is given next.
Example 4.1
Consider a nonlinear device that is modeled by the differential equation 



=
dy
dt
u t( ),
1/2
 
where u(t) is the input and y is the output. Show that this device creates frequency com-
ponents that are different from the excitation frequencies.
Solution
First, we express the given system equation as ∫
=
+
y
u t dt
y
( )
(0)
t
2
0
.
Now, for an input given by 
ω
ω
=
+
u t
a
t
a
t
( )
sin
sin
1
1
2
2 , straightforward integration 
using properties of trigonometric functions gives the following response:
	
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
(
)
(
)
(
)
=
+
−
−
+
−
−
−
+
+
−
y
a
a
t
a
t
a
t
a a
t
a a
t
y
2
4
sin 2
4
sin 2
2(
) sin
2(
) sin
(0)
1
2
2
2
1
2
1
1
2
2
2
2
1 2
1
2
1
2
1 2
1
2
1
2

126
Modeling of Dynamic Systems with Engineering Applications
Note: 
θ
θ
θ
θ
θ
θ
θ
θ
=
−
=
−
−
+
sin
(1
cos 2 )/2;
2sin
sin
cos(
)
cos(
)
2
1
2
1
2
1
2
It is seen that the discrete frequency components 2ω1, 2ω2, (ω1 − ω2), and (ω1 + ω2) are cre-
ated by the nonlinear device. Additionally, there is a continuous spectrum contributed 
by the linear function of t that is present in the response (but not in the input).
■
4.2.3  Nonlinear Electrical Elements
The three lumped-parameter passive elements in an electrical system are a capacitor (an 
A-type element with the across-variable voltage as the state variable), an inductor (a T-type 
element with the through-variable current as the state variable), and a resistor (a D-type ele-
ment representing energy dissipation; no specific state variable is associated with it). The 
linear versions of these elements are discussed in Chapter 2. Now let us briefly look into 
the general, nonlinear versions of these elements.
Capacitor
Electrical charge (q) is a function of the voltage (v) across a capacitor, as given by the non-
linear constitutive equation:
	
=
q
q v
( )	
(4.1a)
For the linear case, we have
	
=
q
Cv	
(4.1b)
where C is the capacitance. Then the current i, given by dq
dt, is obtained by differentiating 
Equation 4.1b as
	
=
+
i
C dv
dt
v dC
dt
	
(4.2a)
Here, we have allowed for a time-varying capacitance. If C is assumed constant, we have 
the familiar linear constitutive equation:
	
=
i
C dv
dt
	
(4.2b)
Inductor
Magnetic flux linkage (λ) of an inductor is a function of the current (i) passing through the 
inductor, as given by the nonlinear constitutive equation:
	
λ
λ( )
=
i 	
(4.3a)
For the linear case, we have
	
λ = Li	
(4.3b)

127
Model Linearization
where L is the inductance. The voltage induced in an inductor is equal to the rate of change 
of the flux linkage. Hence, by differentiating Equation 4.3b, we obtain
	
=
+
v
L di
dt
i dL
dt
	
(4.4a)
Assuming that the inductance is constant, we have the familiar linear constitutive equation:
	
=
v
L di
dt
	
(4.4b)
Resistor
In general, the voltage across a (nonlinear) resistor is a function of the current through the 
resistor, as given by
	
( )
=
v
v i 	
(4.5a)
In the linear case, we have the familiar Ohm’s law:
	
=
v
Ri	
(4.5b)
where R is the resistance, which can be time varying in general. In most cases, however, we 
assume R to be a constant.
4.3  Analytical Linearization Using Local Slopes
Real systems are nonlinear and may be more accurately represented by nonlinear ana-
lytical models. Analytical techniques (e.g., response analysis, frequency-domain analysis, 
eigenvalue problem analysis, simulation, control) commonly employ linear models, which 
are far more convenient to use.
Popularly, nonlinear devices are linearized by considering small excursions about an 
operating point. In other words, a “linear local model” is used. If a single such model has 
sufficient accuracy over the entire operating range of the device, it is an indication that the 
device is linear (over the entire operating range). If not, a series of local linear models may 
have to be used over the operating range.
A nonlinear analytical model may contain one or more nonlinear terms. The approach 
taken in the local slope method is to linearize each nonlinear term by using the first-order 
Taylor series approximation, which involves only the first derivative of the nonlinear term 
(or the “slope” in its graphical representation). A nonlinear term may be a function of 
more than one independent variable. Then, the first derivatives with respect to all its inde-
pendent variables (i.e., the slopes along all orthogonal directions of the coordinate axes, 
which represent the independent variables) are needed in the linearization process. In this 
section, we study “analytical” linearization of a system using local derivatives (slopes) of 
the nonlinear terms in the system. In Section 4.4, we consider local linearization through 

128
Modeling of Dynamic Systems with Engineering Applications
experimental data (by determining the local slopes of experimental data that correspond 
to the nonlinear terms).
4.3.1  Analytical Linearization about an Operating Point
In the approach described now, linearization is carried out by determining the derivatives 
of the nonlinear terms, with respect to the independent variables, at a suitable operating 
point. Typically, this linearizing point is the normal operating condition of the system. Of 
necessity, the normal operating condition is the steady state or the equilibrium state.
Equilibrium State
In a steady state, by definition, the rates of changes of the system variables are zero. Hence, 
the steady state (equilibrium state) is determined by setting the time-derivative terms in 
the system equations to zero and then solving the resulting algebraic equations. This may 
lead to more than one solution, since the steady-state (algebraic) equations themselves are 
nonlinear. The real (i.e., non-complex) steady-state (equilibrium) solutions will correspond 
to one of the following three types:
•	 Stable (Here, given a slight shift, the system response eventually returns to the 
original steady state).
•	 Unstable (Here, given a slight shift, the system response continues to move in the 
direction of the shift, away from the original steady state).
•	 Neutral (Here, given a slight shift, the system response will remain in the shifted 
condition).
These three types of equilibrium are schematically shown in Figure 4.2.
4.3.2  Nonlinear Functions of One Variable
Consider a nonlinear function f(x) of the independent variables x. Its Taylor series approxi-
mation about an operating point ( )o, up to the first derivative, is given by
	
δ
δ
≈
+
=
+
f x
f x
df x
dx
x
x
x
x
( )
(
)
(
)
with
o
o
o
	
(4.6a)
Here δx represents a small change from the operating point.
Now denote the operating condition by (   ) and the small increment about that condi-
tion by ( ˆ  ). We have
	
+
≈
+
f x
x
f x
df x
dx
x
(
ˆ)
( )
( ) ˆ	
(4.6b)
(a)
(b)
(c)
FIGURE 4.2
Equilibrium types. (a) Stable equilibrium; (b) neutral equilibrium; and (c) unstable equilibrium.

129
Model Linearization
From Equation 4.6 it is seen that the increment of the function, due to the increment in its 
independent variable, is given by
	
δ
δ
=
−
≈
f
f x
f x
df x
dx
x
( )
(
)
(
)
o
o
	
(4.7a)
or
	
=
+
−
≈
f
f x
x
f x
df x
dx
x
ˆ
(
ˆ)
( )
( ) ˆ	
(4.7b)
Equation 4.7 is a linear relationship between the increment of the independent variable (xˆ) 
and the increment of the function (fˆ). In other words, we have linearized the nonlinear 
function about an operating point (denoted by f x
(
)
o  or f x
( )). A graphical illustration of this 
linearization approach is given in Figure 4.3.
The error resulting from this linear approximation is
	
=
+
−
+




e
f x
x
f x
df x
dx
x
Error  
 (
ˆ)
( )
( ) ˆ 	
(4.8)
This error decreases:
•	 If the nonlinear function is more linear
•	 By making the increment xˆ from the operating point smaller
Note: If the function is already linear, we have: 
=
f
ax
where a is a constant coefficient. The corresponding incremental relation is
	
δ
δ
=
f
a x	
(4.9a)
Independent
variable
Function 
(dependent variable)
f (x)
Nonlinear
curve
Linear
approximation
x
x
xˆ
+
Operating point: 
,
( )
x f x
Slope = df (x)
dx
ˆ
(
)
f x
x
+
( )
ˆ
( )
df x
f x
x
dx
x
+
×
FIGURE 4.3
Linearization about an operating point.

130
Modeling of Dynamic Systems with Engineering Applications
or
	
=
f
ax
ˆ
ˆ	
(4.9b)
As expected, the incremental relation is also linear because the original relation is linear. 
In this case, however, no error is introduced through the process of linearization.
Commutativity of Increment and Derivative: The increment of a time derivative is 
equal to the time derivative of the increment. Hence
	


δ
=
=
x
dx
dt
x
ˆ
ˆ	
(4.10)
Now, if we set 

=
x
z in Equation 4.10, we get 



δ
=
=
=
z
dz
dt
dz
dt
d z
dt
( )
ˆ
ˆ
ˆ
2
2 . The second equality is 
obtained in view of Equation 4.10. Then, by replacing z by x in the final result, we have
	


δ
=
=
x
d x
dt
x
ˆ
ˆ
2
2
	
(4.11)
4.3.3  Nonlinear Functions of Two Variables
The process of linearization of a function, as presented for one independent variable, can 
be easily extended to functions of more than one independent variable. For illustration, 
consider a nonlinear function f(x,y) of two independent variables x and y. Its first-order 
Taylor series approximation is
	
δ
δ
δ
δ
≈
+ ∂
∂
+ ∂
∂
=
+
=
+
f x y
f x y
f x y
x
x
f x y
y
y
x
x
x
y
y
y
( , )
(
,
)
(
,
)
(
,
)
with
,
o
o
o
o
o
o
o
o
	
(4.12a)
or
	
+
+
≈
+ ∂
∂
+ ∂
∂
f x
x y
y
f x y
f x y
x
x
f x y
y
y
(
ˆ,
ˆ)
( , )
( , ) ˆ
( , ) ˆ	
(4.12b)
where (   ) denotes the operating condition and ( ˆ  ) denotes a small increment about that 
condition, as indicated before.
From Equation 4.12 it is seen that the increment of the nonlinear function, due to the 
increments of its independent variables, is given by
	
δ
δ
δ
=
−
≈∂
∂
+ ∂
∂
f
f x y
f x y
f x y
x
x
f x y
y
y
( , )
(
,
)
(
,
)
(
,
)
o
o
o
o
o
o
	
(4.13a)
or
	
=
+
+
−
≈∂
∂
+ ∂
∂
f
f x
x y
y
f x y
f x y
x
x
f x y
y
y
ˆ
(
ˆ,
ˆ)
( , )
( , ) ˆ
( , ) ˆ	
(4.13b)
Equation 4.13 is a linear relationship between the increments of the independent vari-
ables (xˆ and yˆ) and the increment of the function ( fˆ ). In other words, we have linearized 

131
Model Linearization
the nonlinear function, about an operating point (denoted by f x y
(
,
)
o
o  or f x y
( , )). In the 
present case, for the process of linearization, we need to use two local slopes (derivatives) 
∂
∂
f x y
x
( , ) and ∂
∂
f x y
y
( , ) along the two directions (orthogonal) of the independent variables 
x and y.
From these illustrations it should be clear that linearization of a nonlinear system (model) 
is carried out by replacing each term in the system equation by its increment, about an 
operating point. We summarize the steps of local slope-based analytical linearization of a 
system (model) about an operating point as folllows:
	
1.	Select the operating point (or, reference condition). This is typically a steady state, 
which can be determined by setting the time derivative terms in the system equa-
tions to zero and solving the resulting nonlinear algebraic equations.
	
2.	Determine the slopes (first order derivatives) of each nonlinear term (function) in 
the systems equation at the operating point, with respect to (i.e., along) each inde-
pendent variable.
	
3.	Consider each term in the system equation. If a term is nonlinear, replace it by its 
slope (at the operating point) times the corresponding incremental variable. If a 
term is linear, replace it by its coefficient (which is indeed the constant slope of the 
linear term) times the corresponding incremental variable.
4.4  Nonlinear State-Space Models
Consider a general nonlinear, time-variant, nth-order system represented by n first-order 
differential equations, which generally are coupled, as given by
	
…
…
…
…

…
…
(
)
(
)
(
)
=
=
=
dq
dt
f
q q
q r r
r t
dq
dt
f
q q
q r r
r t
dq
dt
f
q q
q r r
r t
,
,
,
, ,
,
,
,
,
,
,
, ,
,
,
,
,
,
,
, ,
,
,
,
n
m
n
m
n
n
n
m
1
1
1
2
1
2
2
2
1
2
1
2
1
2
1
2
	
(4.14a)
The state vector is
	
…
= 

q
q q
q
,
,
,
n
T
1
2
	
(4.15)
and the input vector is
	
=
…


r
r r
r
,
,
, m
T
1
2
	
(4.16)
Equation 4.14a may be written in the vector notation:
	
 =
t
( , , )
q
f q r
	
(4.14b)

132
Modeling of Dynamic Systems with Engineering Applications
Note: The explicit presence of the time variable “t” as an argument in the function f indi-
cates that the parameters of the function vary with time (i.e., it is a time-variant model).
4.4.1  Linearization of State Models
Now we linearize the nonlinear state-space model given by Equation 4.14 about its 
­equilibrium state (an operating point). An equilibrium state of the state-space model 
(Equation 4.14) corresponds to the condition when the rates of changes of the state vari-
ables are all zero. Specifically, we set
	
=
q
0	
(4.17)
This is true because in an equilibrium state the system response remains steady and hence 
its rate of change is zero. Consequently, the equilibrium states q are obtained by solving 
the set of n nonlinear algebraic equations:
	
(
) =
f q r t
0
, ,
	
(4.18)
for a particular steady input r. Usually, under steady conditions, a system operates at one 
of one of its “stable” equilibrium states. To study the stability of various equilibrium states 
of a nonlinear dynamic system, it is first necessary to linearize the system model about a 
general equilibrium state as given by Equation 4.18.
As noted before, Equation 4.14 can be linearized for small variations δq and δr of the 
states and the inputs, about an equilibrium point q r
( , ), by employing up to only the first 
derivative term (i.e., O(1) term) in the Taylor series expansion of the nonlinear function f. 
The higher-order terms are negligible for small δq and δr. As explained before, this method 
yields the linear model
	
δ
∂
∂
δ
∂
∂
δ
=
+
q
f
q q r
q
f
r q r
r
t
t
( , , )
( , , )
	
(4.19)
Denote the state vector and the input vector of the linearized model by
	
δ
=
= 

…
q
x
x x
x
,
,
,
n
T
1
2
	
(4.20)
	
δ
=
= 

…
r
u
u u
u
,
,
,
m
T
1
2
	
(4.21)
This results in the linear model
	
=
+
x
Ax
Bu	
(4.22)
The linear system matrix A(t) and the input distribution (gain) matrix B(t) are given by
	
∂
∂
( ) =
A
f
q q r
t
t
( , , )	
(4.23a)
	
∂
∂
( ) =
B
f
r q r
t
t
( , , )	
(4.24a)

133
Model Linearization
The elements of these matrices are explicitly given by
	
=
∂
∂
∂
∂
∂
∂
∂
∂
∂
∂
∂
∂
∂
∂
∂
∂
∂
∂








































A
f
q
f
q
f
q
f
q
f
q
f
q
f
q
f
q
f
q
n
n
n
n
n
n
1
1
1
2
1
2
1
2
2
2
1
2
	
(4.23b)
	
=
∂
∂
∂
∂
∂
∂
∂
∂
∂
∂
∂
∂






































B
f
r
f
r
f
r
f
r
f
r
f
r
m
m
n
n
m
1
1
1
2
1
2
1
	
(4.24b)
If it is a constant-parameter (i.e., stationary or time-invariant) dynamic system, or if it can be 
assumed as such for the time period of interest, then A and B are constant matrices.
4.4.2  Mitigation of System Nonlinearities
Under steady conditions (i.e., in the static case), system nonlinearities can be removed 
through calibration. Under dynamic conditions, however, the task becomes far more dif-
ficult. The following approaches may be used to remove nonlinearities:
•	 Calibration and rescaling (e.g., log) of the output (in the static case)
•	 Use of linearizing elements (e.g., resistors, amplifiers in bridge circuits) to neutral-
ize the nonlinear effects
•	 Use of nonlinear feedback (feedback linearization)
The following precautions can be taken to reduce nonlinear behavior in dynamic systems:
•	 Avoid operating the device over a wide range of inputs or signal levels.
•	 Avoid operation over a wide frequency band.
•	 Use devices that do not generate large deformations (e.g., deviation from Hooke’s 
law—a physical nonlinearity) or large mechanical motions (e.g., introduction of 
trigonometric terms—a geometric or kinematic nonlinearity).
•	 Minimize nonlinear friction (e.g., Coulomb, Stribeck), stiction, wear and tear (e.g., 
through proper lubrication).

134
Modeling of Dynamic Systems with Engineering Applications
•	 Avoid loose joints, gear coupling, etc., which can cause backlash (e.g., use direct-
drive mechanisms, harmonic drives, etc.).
•	 Minimize sensitivity to undesirable influences (e.g., environmental influences 
such as temperature).
Next, we illustrate model linearization and operating condition analysis using several 
examples, which involve state-space models and input-output models in various physical 
domains.
Example 4.2
The robotic spray painting system of an automobile assembly plant employs an induc-
tion motor and pump combination to supply paint at an overall peak rate of 15 gal/min 
to a cluster of spray-paint heads in several painting booths. The painting booths are an 
integral part of the production line in the plant. The pumping and filtering stations are 
in the ground level of the building and the painting booths are in an upper level. Not all 
booths or painting heads operate at a given time. The pressure in the paint supply line 
is maintained at a desired level (approximately 275 psi or 1.8 MPa) by controlling the 
pump speed, which is achieved through a combination of voltage control and frequency 
control of the induction motor. An approximate model for the paint pumping system is 
shown in Figure 4.4a.
(a)   
(b)    
bmωm
Tm
Jm
Tg
kp
Tp
rωm
Tp
Jp
Tp
bm
Jm
Tm
Induction
motor
r
Gear
transmission
(light)
Paint load
bp
Tp
1
kp
Flexible
shaft
Jp
Pump
ωm
ωm
ωp
ωp
ωp
bpωp
FIGURE 4.4
(a) A model of a paint pumping system in an automobile assembly plant and (b) free-body dia-
grams of the energy storage elements.

135
Model Linearization
The induction motor is linked to the pump through a gear transmission of efficiency η 
and speed ratio 1:r (typically, a speed reducer is used, with r < 1), and a flexible shaft of 
torsional stiffness kp. The moments of inertia of the motor rotor and the pump impeller 
are denoted by Jm and Jp, respectively. Note: The pump inertia Jp may include the “added-
mass effect” of the paint. The gear inertia is neglected (or lumped with Jm). The mechan-
ical dissipation in the motor and its bearings is modeled as a linear viscous damper 
of damping constant bm. The load on the pump (i.e., much of the paint load plus any 
mechanical dissipation) is also modeled by a viscous damper, and its equivalent damp-
ing constant is bp. The magnetic torque Tm generated by the induction motor is given by
	
ω ω
ω
ω
ω
=
−
−
T
T q
q
(
)
(
)
m
m
m
0
0
0
0
2
2
	
 (4.25)
Here, ω m is the motor speed; the parameter T0 depends directly (quadratically) on the 
phase (ac) voltage supplied to the motor; the second parameter ω 0 is directly propor-
tional to the line frequency of the ac supply; the third parameter q is positive and greater 
than unity, and this parameter is assumed constant in the control system.
	 (a)	 Comment on the accuracy of the model shown in Figure 4.4a.
	 (b)	 Taking the motor speed ω m, the pump-shaft torque Tp, and the pump speed ω p 
as the state variables, systematically derive the three state equations for this 
(nonlinear) model. Clearly explain all steps involved in the derivation. What 
are the inputs to the system?
	 (c)	 What do the motor parameters ω 0 and T0 represent, with regard to the motor 
behavior? Obtain the partial derivatives 
ω
∂
∂
Tm
m
, ∂
∂
T
T
m
0
 and ω
∂
∂
Tm
0
 and verify that the 
first of these three expressions is negative and the other two are positive. Note: 
Under normal operating conditions, for an induction motor, 
ω
ω
<
<
0
m
0
	 (d)	 Consider the steady-state operating point where the motor speed is steady at 
ω m. Obtain expressions for ω p, Tp, and T0 (at this operating point), in terms of ω m 
and ω 0.
	 (e)	 Suppose that 
ω
∂
∂
= −
T
b
m
m
, 
β
∂
∂
=
T
T
m
0
1, and ω
β
∂
∂
=
Tm
0
2 at the operating point given in 
Part (d). Note: Voltage control is achieved by varying T0 and frequency control 
by varying ω 0. Linearize the state model obtained in Part (b) about the operat-
ing point and express it in terms of the incremental variables ωˆ m, Tˆ
p, ωˆ p, Tˆ
0, and 
ωˆ 0. Suppose that the (incremental) output variables are the incremental pump 
speed ωˆ p and the incremental angle of twist of the pump shaft. Express the 
linear state space model in the usual form and obtain the associated matrices 
A, B, C, and D.
	 (f)	 For the case of frequency control alone (i.e., Tˆ
0 = 0) obtain the input–output 
model (differential equation) relating the incremental output ωˆ p to the incre-
mental input ωˆ 0. Using this equation, show that if ωˆ 0 is suddenly changed by a 
step of ∆ωˆ 0 then 
ω
d
dt
ˆ p
3
3  will instantaneously change by a step of β
∆ω
rk
J J
ˆ
p
m p
2
0, but 
the lower derivatives of ωˆ p will not change instantaneously.
Solution
	
a.	
•	 Backlash and inertia of the gear transmission have been neglected in the 
model. This is not accurate in general. Also, the gear efficiency η, which is 
assumed constant here usually varies with the gear speed.

136
Modeling of Dynamic Systems with Engineering Applications
•	 Usually there is some flexibility in the shaft (coupling) that connects the 
gear to the drive motor.
•	 Energy dissipation (in the pump load and in various bearings) has been 
lumped into a single linear viscous-damping element. In practice, this 
energy dissipation is nonlinear and distributed.
•	 At least part of the pump load may be included as an “added inertia” to the 
pump rotor (usually this not a constant). Alternatively, the pump load may 
be more accurately represented by a torque vs speed curve.
	
b.	
	
Let Tg = reaction torque on the motor from the gear. Output speed of the gear 
transmission is ω
r
m. Also, power = torque × speed. Hence, by definition, the 
gear efficiency is given by
	
η
ω
ω
=
= T r
T
Output power
Input power
p
m
g
m
This gives
	
η
=
T
r T
g
p	
(i)
	
The free-body diagrams for the energy storage elements are shown in Figure 
4.4b. There are two independent A-type elements and one T-type element. The 
following three constitutive equations can be written:
Newton’s second law (Torque = Inertia × Angular Acceleration) for the motor:
	
ω
ω
ω
η
= −
+
−
= −
+
−

J
b
T
T
b
T
r T
m
m
m
m
m
g
m
m
m
p	
(ii)
Note: We have substituted (i).
Hooke’s law (Torque rate = torsional stiffness × twisting speed) for the flexible 
shaft:
	
ω
ω
=
−
T
k r(
)
p
p
m
p 	
(iii)
Newton’s second law for the pump:
	
ω
ω
=
−

J
T
b
p
p
p
p
p	
(iv)
Equations (ii) through (iv) are the three state equations, with the state vector 
ω
ω


T
m
p
p
T.
	
These equations appears as a “linear” state-space model whose input is Tm. 
Strictly, the system is nonlinear with two inputs, in view of the torque-speed 
characteristic curve of the motor as given by Equation 4.25 and sketched in 
Figure 4.5. It also indicates the fractional slip S of the induction motor as given by
	
ω
ω
ω
=
−
S
(
)
m
0
0
	
(4.26)
The two inputs are: ω0 = speed of the rotating magnetic field (proportional to the line 
frequency), and T0, which depends quadratically on the phase voltage.

137
Model Linearization
c.	
From Equation 4.25 we note the following:
When ω
= 0
m
 we have 
=
T
T
m
0. Hence, T0 = starting torque of the motor.
When 
=
T
0
m
, we have ω
ω
=
m
0. Hence, ω 0 = no-load speed. This is the synchronous 
speed—under no-load conditions, there is no slip in the induction motor (i.e., 
actual speed of the motor is equal to the speed ω 0 of the rotating magnetic field).
Differentiate Equation 4.25 separately with respect to T0, ω 0, and ω m. We obtain
	
ω ω
ω
ω
ω
β
∂
∂
=
−
−
=
T
T
q
q
(
)
(
)
(say)
m
m
m
0
0
0
0
2
2
1
	
(4.27)
	
ω
ω
ω
ω
ω
ω ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
β
∂
∂
=
−
−
−
−
−
=
−
+
−
−
=
T
T q q
q
q
T q
q
q
[(
)(2
)
(
)2
]
(
)
[(
)
(
1)
]
(
)
 (say)
m
m
m
m
m
m
m
m
0
0
0
2
2
0
0
0
0
0
2
2
2
0
0
2
0
2
0
2
2
2
2
	
(4.28)
	
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
∂
∂
=
−
−
−
−
−
−
= −
−
+
−
−
= −
T
T q
q
q
T q
q
q
b
[(
)( 1)
(
)( 2
)]
(
)
[(
1)
(
) ]
(
)
 (say)
m
m
m
m
m
m
m
m
e
0
0
0
2
2
0
0
2
2
2
0
0
0
2
0
2
0
2
2
2
	
(4.29)
Since q > 1, we have β1 > 0; β2 > 0; and be > 0.
Note: be = electrical damping constant of the motor
d.	
At a steady-state operating point, the rates of changes of the state variables are 
zero. Hence, set ω
ω
=
=
=



T
0
m
p
p in Equations (ii) through (iv). We obtain
	
ω
η
=
−
−
T
b
r T
0
m
m
m
p
Motor rotor speed
Motor torque T
0
Full slip
ωf
No slip
ωm
S = 0 
S = 1
Ts
Tmax
Unstable
region
Stable
region
Increasing field voltage
magnitude vf
FIGURE 4.5
Torque-speed characteristic curve of an induction motor.

138
Modeling of Dynamic Systems with Engineering Applications
	
ω
ω
=
−
k r
0
(
)
p
m
p
	
ω
=
−
T
b
0
p
p
p
Hence
	
ω
ω
= r
p
m	
(v)
	
ω
=
T
b r
p
p
m	
(vi)
	
ω
ω
η
ω ω
ω
ω
ω
=
+
=
−
−
T
b
r b
T q
q
(
)
(
)
(from Equation 4.25)
m
m
m
p
m
m
m
2
0
0
0
0
2
2
or
	
ω
η
ω
ω
ω ω
ω
=
+
−
−
T
b
r b
q
q
(
)(
)
(
)
m
m
p
m
m
0
2
0
2
2
0
0
	
(vii)
	Strictly, we need to express the operating values of the state variables: 
ω
ω


T
m
p
p
T in terms of the operating values (known) of the two inputs: 
ω


T
T
0
0
. In theory, this can be done because we have three Equations (v) 
through (vii) in the three unknowns. The specific procedure to accomplish this is 
as follows:
	
1.	 Solve the “cubic equation” (vii) to express ω m in terms of the known quanti-
ties 
ω
T  and 
0
0. We should get at least one stable solution—see Figure 4.5. 
Pick the stable solution.
	
2.	 Once we know ω m, we can express ω
T
 and 
p
p in terms of the known quanti-
ties 
ω
T  and 
0
0 (using (v) and (vi)).
Hint: The cubic equation in this case is of the form 
−
+
=
ax
bx
c
0
3
 with 
ω
=
x
m. Its 
three roots are:
	
=
−




−










+
−




−










x
c
a
b
a
c
a
b
a
c
a
b
a
c
a
4
27
2
3
4
27
2
1
2
2
3
3
1
2
1
3
2
2
3
3
1
2
1
3
	
= −
−




−










−
−




−










+
−




−










−
−




−
































x
c
a
b
a
c
a
b
a
c
a
b
a
c
a
j
c
a
b
a
c
a
b
a
c
a
b
a
c
a
1
2
4
27
2
6
4
27
2
3
2
4
27
2
3
4
27
2
2
2
2
3
3
1
2
1
3
2
2
3
3
1
2
1
3
2
2
3
3
1
2
1
3
2
2
3
3
1
2
1
3

139
Model Linearization
	
= −
−




−










−
−




−










−
−




−










−
−




−
































x
c
a
b
a
c
a
b
a
c
a
b
a
c
a
j
c
a
b
a
c
a
b
a
c
a
b
a
c
a
1
2
4
27
2
6
4
27
2
3
2
4
27
2
3
4
27
2
3
2
2
3
3
1
2
1
3
2
2
3
3
1
2
1
3
2
2
3
3
1
2
1
3
2
2
3
3
1
2
1
3
It is seen that the first root is positive and it is the valid root for ω m. The other two 
roots are complex conjugates and are not valid.
MATLAB® Code:
	
syms a b c x
	
eqn = a*x^3-b*x+c==0
	
solve(eqn, x)
e.	
The linearized nonlinear expression for the motor torque has been determined 
before. Specifically, the increment of the motor torque from the operating point is:
	
ω
ω
ω
ω
ω
β
β ω
= ∂
∂
+ ∂
∂




+ ∂
∂




= −
+
+
T
T
T
T
T
T
b
T
ˆ
ˆ
ˆ
ˆ
ˆ
ˆ
ˆ
m
m
m
m
m
m
e
m
0
0
0
0
1 0
2
0	
(viii)
Take the increments of the state Equations (ii) through (iv), and substitute Equation 
viii. We obtain the following linear state-space model:
	
ω
ω
ω
β
β ω
η
= −
−
+
+
−

J
b
b
T
r T
ˆ
ˆ
ˆ
ˆ
ˆ
ˆ
m
m
m
m
e
m
p
1 0
2
0
	
(ix)
	
ω
ω
=
−
T
k r
ˆ
( ˆ
ˆ )
p
p
m
p 	
(x)
	
ω
ω
=
−

J
T
b
ˆ
ˆ
ˆ
p
p
p
p
p	
(xi)
	
ω
ω
= 

x
T
State vector
ˆ
ˆ
ˆ
m
p
p
T
	
ω
= 

u
T
Input vector
ˆ
ˆ
T
0
0
	
ω
= 

y
T
k
Output vector
ˆ
ˆ
p
p
p
T
Note: The second output is the angle of twist of the pump shaft. Its incremental 
value is T
k
ˆ
p
p .

140
Modeling of Dynamic Systems with Engineering Applications
We have
	
η
β
β
=
−
+
−
−
−












=










A
B
b
b
J
r
J
k r
k
J
b
J
J
J
(
)
(
)
0
0
0
1
;
0
0
0
0
e
m
m
m
p
p
p
p
p
m
m
1
2
	
=








=
C
D
k
0
0
0
1
0
1
0
;
p
Note:
be = electrical damping constant of the motor
bm = mechanical damping constant of the motor
f.	
For frequency control, we have 
=
Tˆ
0
0
.
To get the linear I–O differential equation, we should eliminate the state variables 
ω
T
ˆ  and ˆ
m
p from the state Equations (ix) through (xi). The general procedure for 
this is as follows:
	
1.	 Pick an equation where a variable to be eliminated occurs by itself, only in 
a single term.
	
2.	 Substitute that equation into the remaining equations to eliminate the 
variable.
	
3.	 Repeat the preceding two steps for the remaining variables that need to be 
eliminated.
In the present example, we use this approach as follows:
	
1.	 Substitute Equation x into Equation ix in order to eliminate ωˆ m
	
2.	 Substitute Equation xi into the preceding result in order to eliminate Tˆ
p.
On simplification, we get the following input–output model (differential equation):
	
ω
ω
η
ω
η
ω
β
ω
(
)
+
+
+


+
+



+
+








+
+
+




=
J J d
dt
J b
J
b
b
d
dt
k
J
r J
b b
b
d
dt
k
r b
b
b
rk
ˆ
ˆ
(
)
ˆ
ˆ
ˆ
m p
p
m
p
p
m
e
p
p
m
p
p
m
e
p
p
p
m
e
p
p
3
3
2
2
2
2
2
0
(xii)
This is a third-order differential equation, as expected, since the system is third-
order. Also, as we have seen, the state-space model is also third-order.
Observation from Equation xii:
When ωˆ 0 is changed by the “finite” step ∆ωˆ 0, the RHS of Equation xii will change 
by a finite amount. Hence, the LHS will also change by a finite amount.
In this process, suppose that lowest-order term ωˆ p instantaneously changes by a 
finite amount. That means the higher-order terms (higher derivatives) ω
d
dt
ˆ p  and 
ω
d
dt
ˆ p
2
2  have to change by “infinite” amounts, instantaneously (Note: The deriva-
tive of a step is an impulse—infinite). Then the LHS will change by an “infinite” 
amount, which violates the equation.

141
Model Linearization
Hence, only the highest derivative 
ω




d
dt
ˆ p
3
3
 will change instantaneously. The lower 
derivatives will not change instantaneously.
Further Verification: In fact, ωˆ p, ω
d
dt
ˆ p , and 
ω
d
dt
ˆ p
2
2  constitute another choice of state 
variables, for this system. We know that state variables cannot change instanta-
neously (see Chapter 2) as this will violate causality.
For the instantaneous c hange, set all the lower-order terms on the LHS of Equation 
xii to zero. Then, we can determine the change of the highest order term 
ω
d
dt
ˆ p
3
3  as: 
β
∆ω
rk
J J
ˆ
p
m p
2
0.
The following somewhat general observations can be made from this example:
•	 Mechanical damping constant bm comes from bearing friction and other 
mechanical sources.
•	 Electrical damping constant be comes from the electromagnetic interactions in 
the motor.
•	 The two damping parameters must occur together (and should be treated 
together in model analysis, simulation, design, control, etc.). For example, 
whether the response is underdamped or overdamped depends on the sum 
+
b
b
m
e and not the individual parameters. This is a consequence of electro-
mechanical coupling.
Note: If the characteristic curve corresponding to Equation 4.25 is experimentally 
determined, the damping parameter “b” that is determined from the curve will con-
tain mechanical damping (e.g., in bearings) as well.
LEARNING OBJECTIVES
	
1.	 The effect of electro-mechanical coupling on damping.
	
2.	 Mechanical damping and electrical damping should be treated together. 
System behavior depends on the combined effect ← a case for integrated anal-
ysis, simulation, design, control, etc.
	
3.	 System nonlinearity can come from nonlinear coupling of inputs and state 
variables.
	
4.	 A state variable cannot change instantaneously.
	
5.	 When an input changes instantaneously, the highest derivative of the output in 
the I–O differential equation changes with it (instantaneously); and the lower 
derivatives of the output do not change.
Note: These lower derivatives may be taken as state variables of the system.	
▪
Example 4.3
An automated wood-cutting system contains a cutting unit, which consists of a dc 
motor and a cutting blade, linked by a flexible shaft and a coupling. The purpose of the 
flexible shaft is to position the blade unit at any desirable configuration, away from the 
motor itself. The coupling unit helps with the shaft alignment (compensates for possible 
misalignment). A simplified, lumped-parameter, dynamic model of the cutting device 
is shown in Figure 4.6.

142
Modeling of Dynamic Systems with Engineering Applications
The following parameters and variables are shown in the figure:
Jm = axial moment of inertia of the motor rotor
bm = equivalent viscous damping constant of the motor bearings
k = torsional stiffness of the flexible shaft
Jc = axial moment of inertia of the cutter blade
bc = equivalent viscous damping constant of the cutter bearings
Tm = magnetic torque of the motor
ωm = motor speed
Tk = torque transmitted through the flexible shaft
ωc = cutter speed
TL = load torque on the cutter from the workpiece (wood)
In comparison with the flexible shaft, the coupling unit is assumed rigid, and is also 
assumed light. The cutting load is given by
	
ω ω
=
T
c
L
c
c	
(4.30)
The parameter c, which depends on such factors as the depth of cut and the material 
properties of the workpiece, is assumed constant in the present analysis.
	 (a)	 Using Tm as the input, TL as the output, and ω
ω


T
m
k
c
T as the state vec-
tor, develop a complete (nonlinear) state-space model for the system shown in 
Figure 4.6. What is the order of the system?
	 (b)	 Using the state model derived in Part (a), obtain a single input–output differen-
tial equation for the system, with Tm as the input and ω c as the output.
	 (c)	 Consider the steady operating conditions where 
=
T
T
m
m, ω
ω
=
m
m, 
=
T
T
k
k, 
ω
ω
=
c
c, 
=
T
T
L
L are all constants. Express the operating point values ω m, Tk, ω ,
c  
and TL in terms of the steady input Tm and the model parameters only. You 
must consider both cases Tm > 0 and Tm < 0.
	 (d)	 Now consider an incremental change Tˆ
m in the motor torque and the corre-
sponding changes ωˆ m, Tˆ
k, ωˆ c, and Tˆ
L in the system variables. Determine a linear 
state model (A, B, C, D) for the incremental dynamics about the operating point 
Coupling
Bearing
Magnetic 
torque
ωc ωc
TL = c
Tm
Jm
ωm
bm
bc
k
Torque Tk
Wood load
Cutter 
blade
Jc
Motor
Flexible
shaft
ωc
FIGURE 4.6
A wood-cutting machine.

143
Model Linearization
of the system, using 
ω
ω
= 

x
T
ˆ
ˆ
ˆ
m
k
c
T
 as the state vector, = 

u
Tˆ
m  as the input, 
and 
= 

y
Tˆ
L  as the output.
	 (e)	 In the incremental model (see Part (d)), if the angle of twist of the flexible shaft 
(i.e., θ
θ
−
m
c) is used as the output, what will be a suitable state model? What is 
the system order then?
	 (f)	 In the incremental model, if the angular position θc of the cutter blade is used 
as the output variable, explain how the state model obtained in Part (d) should 
be modified. What is the system order in this case?
Hints for Part (b):
	
ω ω
ω ω
=

d
dt (
)
2
c
c
c
c	
(4.31)
	
ω ω
ω ω
ω
ω
=
+

d
dt (
)
2
2
sgn(
)
c
c
c
c
c
c
2
2
2
	
(4.32)
These results may be derived as follows: since ω
ω
ω
=
sgn
c
c
c, we have
	
ω ω
ω
ω
ω ω
ω
ω ω
=
=
=


d
dt
d
dt
(
)
(
sgn
)
2
sgn
2
c
c
c
c
c
c
c
c
c
2
and
	
ω ω
ω ω
ω ω
ω
ω
=
=
+



d
dt
d
dt
(
)
(2
)
2
2
sgn(
)
c
c
c
c
c
c
c
c
2
2
2
Note: Since 
ω
ω
ω
= +
>
−
<
sgn(
)
1 for 
0; =
1 for 
0;
c
c
c
 it is a constant and its time deriva-
tive is zero (except at ω = 0
c
, which is not important here as it corresponds to the static 
condition).
Solution
a.	 The free-body diagram of the system is shown in Figure 4.7a.
Constitutive equations of the three elements:
	
ω
ω
=
−
−

J
T
b
T
m
m
m
m
m
k	
(i)
	
ω
ω
=
−
T
k(
)
k
m
c 	
(ii)
	
ω
ω
ω ω
=
−
−

J
T
b
c
c
c
k
c
c
c
c	
(iii)
These are indeed the state equations, with
State vector = ω
ω


T
m
k
c
T
Input vector = 

Tm
Output vector = 

TL  = ω ω
c
c
c
This is a third-order system (three state variables; three state equations).
b.	 Substitute (ii) and its time derivative into (i), to eliminate ω m and ω m:
	
ω
ω
+
=
−
+
−



J
T k
T
b
T k
T
[
]
[
]
m
k
c
m
m
k
c
k

144
Modeling of Dynamic Systems with Engineering Applications
Next, substitute (iii) and its time derivatives into this result, to eliminate Tk and its 
time derivatives (use Equations 4.31 and 4.32 to carry out the differentiations of the 
nonlinear terms). The time derivatives of Tk are:
	
ω
ω
ω ω
=
+
+




T
J
b
c
2
k
c
c
c
c
c
c
	
ω
ω
ω ω
ω
ω
=
+
+
+





T
J
b
c
c
2
2
sgn(
)
k
c
c
c
c
c
c
c
c
2
We obtain
	
ω
ω
ω ω
ω
ω
ω
ω
ω
ω ω
ω
ω
ω
ω ω
+
+
+

+
=
−
+
+

−
−
+
+











J
k
J
b
c
c
J
T
b
k
J
b
c
b
J
b
c
2
2
sgn(
)
2
m
c
c
c
c
c
c
c
c
m
c
m
m
c
c
c
c
c
c
m
c
c
c
c
c
c
c
2
This can be rearranged as the input–output model (differential equation)
	
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω ω
(
)
(
)
(
)
+
+
+
+
+
+
+
+



+
+
+
=
J J d
dt
J b
J b
d
dt
cJ
d
dt
J k
J k
b b
d
dt
b c
d
dt
cJ
d
dt
k b
b
kc
kT
2
2
2
sgn(
)
m c
c
m
c
c
m
c
m
c
c
m
c
m
c
c
m
c
c
m
c
c
m
c
c
c
c
m
3
3
2
2
2
2
2
(c)	At the operating point, rates of changes of the state variables are zero. Hence, from (i) 
through (iii) we have
(a)  
(b)  
0
x
x x
1
2 x
1
2 x
Jm
Tm
Tk
bmθm
Tk
kL
Tk
Jc
Tk
TL
c
θm
ωm
ωm
ωc
ωc ωc
ωc
bcθc
=
FIGURE 4.7
(a) Free-body diagram of the system and (b) the nature of the nonlinearity.

145
Model Linearization
	
ω
=
−
−
T
b
T
0
m
m
m
k	
(iv)
	
ω
ω
=
−
k
0
(
)
m
c 	
(v)
	
ω
ω ω
=
−
−
T
b
c
0
k
c
c
c
c	
(vi)
Case 1: 
ω
>
⇒
>
T
0
0
m
c
Eliminate Tk using (iv) and (vi): 
ω
ω
ω
=
−
−
−
T
b
b
c
0
m
m
m
c
c
c
2
Since ω
ω
=
m
c, we get ω
ω
+
+
−
=
c
b
b
T
(
)
0
c
m
c
c
m
2
By solving the quadratic equation, we get ω = −
+
±
+
+
b
b
b
b
cT
c
(
)
(
)
4
2
c
m
c
m
c
m
2
Since Tm > 0, we use the positive root: ω
ω
=
+
+
−
+
=
b
b
cT
c
b
b
c
(
)
4
2
(
)
2
c
m
c
m
m
c
m
2
From Equation iv: 
=
−
+
+
−
+








T
T
b
b
b
cT
c
b
b
c
(
)
4
2
(
)
2
k
m
m
m
c
m
m
c
2
From Equation vi: 
ω ω
=
=
−
+
+
+
−
+








T
c
T
b
b
b
b
cT
c
b
b
c
(
)
(
)
4
2
(
)
2
L
c
c
m
m
c
m
c
m
m
c
2
Case 2: 
ω
<
⇒
<
T
0
0
m
c
In this case, 
ω
ω
ω
ω
ω
=
−
−
+
→
−
+
+
=
T
b
b
c
c
b
b
T
0
(
)
0
m
m
c
c
c
c
c
m
c
c
m
2
2
Roots: ω =
+
±
+
−
b
b
b
b
cT
c
(
)
(
)
4
2
c
m
c
m
c
m
2
Since Tm < 0, we use the negative root: ω =
+
−
+
−
b
b
c
b
b
cT
c
(
)
2
(
)
4
2
c
m
c
m
c
m
2
The rest will follow as in Case 1.
Note: From the symmetry of the problem (rotatory system), the results for Case 2 can 
be easily obtained from those of Case 1. Specifically, ω c will have the same magnitude 
but negative sign. So, in the expression for ω c in Case 1, change the sign of Tm and then 
change the sign of the entire result.
(d)	In linearizing (i) through (iii), we note that the only nonlinear term is ω ω
c
c
c, whose 
slope (derivative) is 
ω
ω ω
ω
ω
ω
ω
ω
ω
=
=
=
d
d
d
d
(
)
(
sgn
)
2
sgn
2
c
c
c
c
c
c
c
c
c
2
This slope is non-negative, as shown in Figure 4.7b.
Consequently, by writing the increment of each term in (i) through (iii), we get the linear 
state model:
	
ω
ω
=
−
−

J
T
b
T
ˆ
ˆ
ˆ
ˆ
m
m
m
m
m
k
	
ω
ω
=
−
T
k
ˆ
( ˆ
ˆ )
k
m
c
	
ω
ω
ω ω
=
−
−

J
T
b
c
ˆ
ˆ
ˆ
2
ˆ
c
c
k
c
c
c
c
with the output equation: 
ω ω
=
T
c
ˆ
2
ˆ
L
c
c
State vector 
ω
ω
= 

x
T
ˆ
ˆ
ˆ
m
k
c
T
; input vector = 

u
Tˆ
m ; output vector 
= 

y
Tˆ
L
The corresponding state-model matrices are

146
Modeling of Dynamic Systems with Engineering Applications
	
ω
=
−
−
−
−
+










=










A
B
b
J
J
k
k
J
b
c
J
J
1
0
0
0
1
(
2
)
;
1
0
0
m
m
m
c
c
c
c
m
	
ω
= 



= 
C
D
c
0
0
2
;
0
c
e.	 The angle of twist of the flexible shaft is 
θ
θ
=
−
=
y
T
k
m
c
k
This gives a new output equation: =
y
T
k
k
Since no new state variables are introduced for this case, the same state equations as 
before are applicable, along with this new output equation.
System order = 3
f.	 The new output equation: 
θ
=
y
c
Since θc cannot be expressed as an algebraic equation of the three previous state vari-
ables, a new state variable θc has to be defined. This results in the additional state equa-
tion: θ
ω
=
d
dt
c
c
Now the system order becomes 4, in view of the extra state variable (and extra state 
equation).
DISCUSSION
Physically, the new output θc is obtained by placing an integrator in front of the old 
output ω c. Hence
	
=
+
New system
old system
integrator at the output
From this series configuration of the old system and an integrator, it should be clear 
that, even though the system order has increased to four due to the new integrator, the 
basic dynamics of the system is still governed by the original third-order system. In 
particular, with the unified choice of across-variables of independent A-type elements 
and through-variables of independent T-type elements as the state variables, we end up 
with a unique third-order state-space model for this system, which does not allow θc as 
a natural output. To provide the “unnatural” output θc there is no other option but to 
include a new integrator, which increases the system order by 1. The new state-space 
model has the matrices:
	
=
















=












= 

= 
×
×
A
A
B
B
C
D
0
0
0
0
0
1
0
;  
0
;  
0
0
0
1 ;  
0
old
old
4 4
4 1
with the state vector 
ω
ω
θ
= 

x
T
ˆ
ˆ
ˆ
ˆ
m
k
c
c
T
.
LEARNING OBJECTIVES
	
1.	 Analysis of nonlinearities that involve the signum function (sgn(.)).
	
2.	 Determination of a state model and a corresponding input–output model.
	
3.	 Proper choice of state variables.
	
4.	 The natural state variable for a rigid-body mode is velocity (not position). 
When this is violated, inconsistency in system order may result.
▪

147
Model Linearization
Example 4.4
An object of mass m is propelled vertically upward by a rocket with force F t( ). When 
it is at height (elevation) Y from the earth’s surface, the gravitational pull Fg is given by 
=
+




F
mg
R
R
Y
g
2
, where R is the average radius of the earth (approximately 6370 km). 
See Figure 4.8a.
Note: When the force is a function of the position of the object on which it is applied, it 
may be interpreted as a “generalized spring force.” In the present example, it is a gravi-
tational spring, which is nonlinear. Also, in this example, we neglect the aerodynamic 
forces such as drag. This amounts to considering the behavior of the object at very high 
elevations only, where the aerodynamic forces are negligible.
	 (a)	 Taking the velocity ν and the gravitational spring force Fg as the state vari-
ables (Note: This is the systematic and unified approach where we choose the 
across-variable ν of the A-type element—mass, and the through-variable Fg of 
the T-type element—spring, as the state variables) and F t( ) as the input vari-
able, develop a state-space model for the mass dynamics.
	 (b)	 From the nonlinear state-space model, determine the nonlinear input–output 
(I–O) model, with v as the output.
	 (c)	 For the condition of constant upward velocity νo of the object, determine the 
corresponding propelling force F t( ) and the gravitational force Fgo.
	 (d)	 Linearize the state-space model obtained in Part (a), about the operating condi-
tion established in Part (c).
	 (e)	 Linearize the I–O model obtained in (b) about the operating condition deter-
mined in Part (c). Also, obtain the linear I–O model by using the linear state-
space model of Part (d). Compare the two results.
	 (f)	 Compare the linearized I–O model of Part (e) with a simple (linear) mass-
spring-damper system subjected to an external force.
Solution
(a)	Constitutive equations (state-space shell):
	
= −
+

mv
F
F t
Mass:
( )
g
	
(i)
(a)  
(b) 
Object
v
Earth
Y
F(t)
Fg
m
R
k
v
k
m
(t)
f
b
FIGURE 4.8
(a) Propelled object subjected to gravitational force. (b) Forced mass-spring system.

148
Modeling of Dynamic Systems with Engineering Applications
	
=
+




F
mg
R
R
Y
Gravitational Spring:
g
2	
(ii)
	
⇒
+
=




R
Y
R mg
Fg
1/2
	
(iii)
Note: The +ve root is taken for obvious reasons.
	
−
+
= −



F
mgR
R
Y
Y
F
F
v
R mg
Differentiate (ii) :
=
2
(
)
Substitute (iii) :
2
    
g
g
g
2
3
3/2
	
(iv)
Equations (i) and (iv) represent the state-space model.
	
=
=
X
U
v F
F t
Sate vector
[ ,
]
Input vector
[ ( )]
g
T
	  (b)	 Differentiate (i) and substitute the result along with (i) into (iv). We obtain
	
−
+
= −
−
+



mv
F t
mv
F t
v
R mg
( )
2(
( ))3/2
The input–output model is
	
−
−
+
=



mv
mv
F t
v
R mg
F t
2(
( ))
( )
3/2
	
(v)
	  (c)	 For constant v, (i) gives
	
=
F t
F
( )
go 	
(vi)
	
( )
= −
dF
dt
F
v
R mg
Equation iv gives :
2
g
go
o
3/2
o
	
(iv*)
	
→ 
= −
dF
F
v
R mg
dt
2
g
g
o
3/2
o
o
	
Integrate: −
= −
+
−
F
v
R mg
t
C
( 2)
2
go
o
1/2
The constant of integration C is determined by using the initial condition: at 
=
=
⇒
=
=
t
Y
F
F
mg
0,
0
(0)
go
 (from (ii)) →
= −
C
mg
2
	
(
)
⇒
=
+
→
=
+
−
F
v
R mg
t
mg
F
mg
v t R
1
/
1
g
go
o
1/2
0
2
0
	
(vii)
The operating conditions are given by given by 
(
)
=
=
=
+
v
v
F t
F
mg
v t R
and ( )
/
1
o
go
o
2
Note: The same result can be obtained much more easily from the I–O Equation v by 
setting =
=
=


v
v
v
v
,
0 and
0.
o
 We get −
= 
F t
v
R mg
F t
2( ( )
( )
o
3/2
. This result is identical 

149
Model Linearization
to what we obtained from the state-space model, for steady operation, where 
=
F t
F
( )
go (see iv*). This gives 
(
)
=
+
F t
mg
v t R
( )
/
1
o
2  at steady state.
Easier Method: Actually, we do not need to go to all this trouble! The propulsion 
force in the steady operating condition can be obtained very quickly (and 
directly) from (ii) by substituting 
=
Y
v t
o  (which corresponds to the operating 
state).
(d)	 	 The state equation (i) is already linear. To linearize the state equation (iv), first 
we need to differentiate the term F
v
g
3/2  in (iv) w.r.t. F
v
and
g
, separately (i.e., 
differentiation of a product).
Specifically, ∂
∂
=
∂
∂
=
F
v
v
F
F
v
F
vF
(
)
,
(
)
3
2
g
g
g
g
g
3/2
3/2
3/2
1/2
Hence, the term-by-term linearization of (i) and (iv) gives
	
= −
+

mx
x
u
1
2
	
(viii)
	
= −
+




x
R mg
F
x
F
v x
2
3
2
g
g
o
2
3/2
1
1/2
2
o
o
	
(iv)
	
δ
δ
=
=
x
x
x
v
F
State vector
[
, 
] 
[
, 
] 
T
g
T
1
2
	
Here, Fgo is given by Equation vii, which decreases with time.
(e)	 First, we find the relevant partial derivatives at the operating condition
	
∂
∂
−
+
= −
−
+
= −



v
mv
F t
v
R mg
m
mv
F t
v
R mg
m F
v
R mg
2(
( ))
3 (
( ))
3 (
)
o
o
go
o
3/2
1/2
1/2
	
∂
∂
−
+
=
−
+
=


F
mv
F t
v
R mg
mv
F t
v
R mg
F
v
R mg
2(
( ))
3(
( ))
3(
)
o
o
go
o
3/2
1/2
1/2
	
	 Also, 
−
+
=

mv
F t
R mg
F
R mg
2(
( ))
2(
)
o
go
3/2
3/2
Now, linearize the input–output Equation v, which has been determined in Part (b), term 
by term, about the operating point (where v is constant).
We get 
+
−
=
+



mx
m F
v
R mg
x
F
R mg
x
F
v
R mg
u
u
3 (
)
2(
)
3(
)
go
o
go
go
o
1
1/2
1
3/2
1
1/2
or
	
+
−
=
+



mx
mv
R
F
mg x
F
R mg
x
v
R
F
mg u
u
3
2(
)
3
o
go
go
o
go
1
1
3/2
1
	
(x)
Now, consider the linear state-space model obtained in Part (d). To convert this into the 
I–O form, differentiate Equation viii and substitute the result along with Equation viii 
into Equation ix. We obtain
	
−
= −
+
−



u
mx
R mg
F
x
F
v u
mx
(
)
2
(
3
2
[
])
go
go
o
1
3/2
1
1/2
1
δ
=
=
u
u
F t
Input vector
[
]
[
( )]
1

150
Modeling of Dynamic Systems with Engineering Applications
or
	



mx
mv
R
F
mg x
F
R mg
x
v
R
F
mg u
u
3
2(
)
3
o
go
go
o
go
1
1
3/2
1
+
−
=
+
This is identical to Equation x. It follows that both approaches produce the same input-
output model.
(f)	 Consider the mass-spring-damper system shown in Figure 4.8b.
Using, f
spring force,
k =
 the state equations are
	


mv
bv
f
f t
f
kv
( )
k
k
= −
−
+
=
With x
u
x x
v f
f t
[
 
] 
[
] ;  
[ ( )]
T
k
T
1
2
=
=
=
We have
	


mx
bx
x
u
x
kx
1
1
2
2
1
= −
−
+
=
This gives the I–O model: 


mx
bx
kx
u
1
1
1
+
+
=
Comparing this with the result in Part (e), it is seen that the previous, linearized system 
(space object) has a negative stiffness for the gravitational spring, as given by
	
k
F
R mg
2
g
g
3/2
o
= −
This is an indication of the unstable nature of the system (in the absence of the input—
the propulsion force).
Also, Fgo decreases with time, as given by Equation vii, and R is large. Hence, kg is rela-
tively small. The gravitational damping coefficient is given by
	
b
v
R
mF
g
3
g
o
go
=
LEARNING OBJECTIVES
	
1.	 Handling of gravitational pull as a nonlinear spring → Two state variables: 
velocity of inertia and force of nonlinear spring. Compare this with a sim-
ple pendulum (which needs two state variables: velocity and position corre-
sponding to the nonlinear spring that represents the gravitational pull), and 
free-­falling mass under gravity (which needs only one state variable: velocity; 
gravity appears as a constant external force, not a nonlinear spring).
	
2.	 Time-varying operating state.
	
3.	 Linearization concepts, applied to both state-space models and input–output 
models.
	
4.	 (a) Linearize the nonlinear state model and convert it to I–O model (linear); 
(b) Convert the nonlinear state model into nonlinear I–O, and linearize the I–O 
model. These two approaches give the same result (same linear I–O model).
	
5.	 Comparison to a linear equivalent model.
▪
Example 4.5
A simplified representation of the vertical dynamics of a hovercraft is shown in Figure 4.9.

151
Model Linearization
A flow-controlled pump produces air flow at the volume rate Q t( )
s
. This air enters the 
cylindrical space between the hovercraft and the ground, at gauge pressure Pf, and exits 
to the atmosphere (zero gauge pressure).
Note: Gauge pressure = Absolute pressure – Atmospheric pressure
The following parameters are known:
	
M = mass of the hovercraft
	
A = cross-sectional area of the cylindrical space underneath the hovercraft
	
h = height of the interior wall of the cylindrical space
The following analytical model may be used to study the vertical dynamics of the 
hovercraft:
	

Mv
AP
Mg
f
=
−
	
(i)
	
C dP
dt
Q
f
f
f
=
	
(ii)
	
P
k Q
f
r
e
2
=
	
(iii)
	
Q t
Q
Av
Q
( )
0
s
e
f
−
−
−
= 	
(iv)
Here
	
Qe = volume flow rate of air exiting from the bottom edge of the hovercraft into 
the atmosphere
	
y = height of the bottom edge of the hovercraft from the ground
	
v = vertical upward velocity of the hovercraft = dy
dt
	
kr = a known flow parameter
(a)	 Among the Equations (i) through (iv), which ones represent the following: state-
space shell, remaining constitutive equation, node equation?
Hovercraft body
(Mass = M)
Pressure Pf
Ground
Pump
(Flow source)
Qs(t)
Air ﬂow
Area of cylindrical
volume = A
h
y
FIGURE 4.9
A simplified model for vertical dynamics of a hovercraft.

152
Modeling of Dynamic Systems with Engineering Applications
	 (b)	 In Equation ii, what do Q f and C f represent? If the air in the cylindrical space 
below the hovercraft obeys the gas law 
=
P V
c
constant
f
f
k
, where k is the adia-
batic constant, give an expression for C f (without derivation) in terms of Vf , k 
and Pf.
Note: Vf  = volume of air in the cylindrical space underneath the hovercraft
	 (c)	 Give a linearized state-space model for the system for small vertical motions 
about the steady state. The steady state is when 
=
=
Q t
Q
( )
constant
s
0
, 
=
=
y
y
constant
0
, and 
=
dP
dt
0
f
Note: Express the model in terms of the parameters A h y
k M g
k
, , 
, , 
, , and r
0
.
Solution
	 (a)	 State vector =
x
v P
[ , 
]
f
T
These are the across-variables of the independent A-type elements: mass, fluid 
capacitor.
	
State-space shell: Equations (i) and (ii)
	
Remaining constitutive equation (for fluid resistor): Equation (iii)
	
Node equation (for the balance of fluid flow rates): Equation (iv)
	 (b)	
= −
Q
dV
dt
f
f  = additional flow rate into the cylindrical space due to fluid 
compressibility
	
C f = fluid capacitance (due to compressibility)
For a gas under adiabatic (i.e., no heat transfer, very rapid process) conditions, 
we have 
=
P V
constant
f
f
k
	
where =
k
c c
/
p
v = ratio of specific heats at constant pressure and constant volume.
	
Then (see Chapter 2), fluid capacitance due to compressibility is
	
=
=
×
+
C
V
kP
A
h
y
kP
(
)
f
f
f
f
	
(v)
where
	
=
×
+
=
V
A
h
y
(
)
volume of the cylindrical space under the hovercraft
f
	
(vi)
	 (c)	 Steady state: 
=
=
Q t
Q
( )
constant
s
0
, =
=
y
y
constant
0
; and 
=
dP
dt
0
f
=
→
=
⇒
y
y
v
 
 
0  
0
 From Equation i: 
=
=
=
P
Mg
A
P
constant
(say)
f
0
=
⇒
dP
dt
0
f
 From Equation ii: 
=
Q
0
f
	
( )
⇒
=
=
=
Q t
Q
Q
From iv :
( )
constant
s
e
0
	
⇒
=
=
P
k Q
Mg
A
From (iii):
r
0
0
2
	
(vii)
	
=
×
+
V
A
h
y
(vi) :
(
) at steady state
f
0
	
⇒
=
×
+
=
+
C
A
h
y
kP
A h
y
kMg
(v):
(
)
(
) at steady state
f
0
0
2
0
	
(viii)
From Equation (iii): Fluid resistance 
=
=
=
=
R
dP
dQ
k Q
k Q
k
Mg
Ak
2
2
2
f
f
e
r
e
r
r
r
0
 at steady 
state

153
Model Linearization
	
⇒ 
=
R
k Mg
A
2
at steady state
f
r
	
(ix)
Now we can obtain the linearized model about the steady-state operating point 
by taking the increments (ˆ.) of Equations (i) through (iv):
	


=
=
=
Mv
AP
C P
Q
P
R Q
ˆ
ˆ
ˆ
ˆ
ˆ
ˆ
f
f
f
f
f
f
e
	
−
−
−
=
Q t
Q
Av
Q
ˆ ( )
ˆ
ˆ
ˆ
0
s
e
f
	
→
=
−
−
=
−
−
Q
Q t
Q
Av
Q t
P
R
Av
ˆ
ˆ ( )
ˆ
ˆ
ˆ ( )
ˆ
ˆ
f
s
e
s
f
f
On substitution, we get the linear state-space model:
	
 =
Mv
AP
ˆ
ˆ
f
	
 =
−
−
C P
Q t
P
R
Av
ˆ
ˆ ( )
ˆ
ˆ
f
f
s
f
f
where =
=
x
u
v P
Q t
[ˆ, ˆ ] ,
[ ˆ ( )]
f
T
s
and C f and R f  are given by (viii) and (ix)
The state equations are of the form  =
+
x
Ax
Bu with
	
=
−
−












=










A
B
A
M
A
C
R C
C
0
1
;
0
1
f
f
f
f
where 
=
+
C
A h
y
kMg
(
)
f
2
0  and 
=
R
k Mg
A
2
f
r
.
LEARNING OBJECTIVES
	
1.	 Systematic state-space modeling of pneumatic systems
	
2.	 Linearization of nonlinear models about an operating point
	
3.	 Identification of lumped parameters
▪
Example 4.6
A model of a mechanical load driven by an actuator and supported by an airspring 
is shown in Figure 4.10a. The following parameters and variables of the system are 
defined:
m = mass of the mechanical load
f(t) = actuator force
P1, P2 = air pressures on the two sides of the piston
V1, V2 = volumes of the two compartment of the cylinder, separated by the piston

154
Modeling of Dynamic Systems with Engineering Applications
x, v = displacement and velocity of the mechanical load
A = area of the piston (or cylinder cross section)
L = length of each compartment of the cylinder under the static conditions: 
P1 = P2 = P0; V1 = V2; f(t) = 0; x = 0
γ = c c
/
p
v = ratio of the specific heats of air at constant pressure and constant volume
Note: There is sufficient thermal insulation around the cylinder.
	 (a)	 What assumptions may be in dynamic modeling of the system?
	 (b)	 Derive a compete (nonlinear) state-space model for the system. Plot the char-
acteristic curve of the nonlinear airspring (force fs versus displacement x) in 
the non-dimensional form: f
AP
s
0
 versus x
L. Show that it is a one-to-one relation-
ship (i.e., there are no multiple values for the other variable corresponding to a 
value of one variable).
	 (c)	 Linearize the state-space model. Discuss how you can adjust the stiffness of 
the linearized spring.
Solution
	 (a)	
Assumptions:
•	 Flexibility of the piston rod is negligible.
•	 Mass of the piston is included in m.
•	 Area of cross section of the piston rod is negligible compared to A.
•	 Friction (damping) in the moving parts is negligible.
(a)
Area = A
m
f (t)
x, v
Air seal
Air seal
Termal
insulation
P1, V1
P2,V2
L + x
L – x
(b)
m
f(t)
v
fs
FIGURE 4.10
(a) A mechanical system with an airspring. (b) Free-body diagram of the piston and the load.

155
Model Linearization
•	 Seals of the moving parts are airtight.
•	 Air in the cylinder obeys an adiabatic process (i.e., fully insulated; no heat 
transfer).
	 (b)	
A free-body diagram of the piston and the mechanical load is shown in 
Figure 4.10b.
	
 = −
+
mv
f
f t
Newton’s second Law :
( )
s
	
(i)
where fs = resisting force of the airspring
	
=
−
f
P A
P A
Also,
s
2
1
	
(ii)
Gas laws (for adiabatic processes):
	
=
γ
γ
PV
P V
1
1
0
0 	
(iii)
	
=
γ
γ
P V
P V
2
2
0
0 	
(iv)
where γ = c c
/
p
v
The constitutive equation for the airspring is derived now.
Note: Air capacitance is analogous to a mechanical spring.
(ii): 
=
−
=
−




γ
γ
γ
f
A P
P
AP V
V
V
(
)
1
1
s
2
1
0
0
2
1
 (From (iii) and (iv))
Substitute the following into Equation ii:
	
=
+
V
A L
x
(
)
1
	
(v)
	
=
−
V
A L
x
(
)
2
	
(vi)
We obtain
	
=
−
−
+
=
−




−
+


















γ
γ
γ
γ
f
AP V
A L
x
A L
x
AP V
AL
x
L
x
L
[
1
[ (
)]
1
[ (
)] ]
(
)
1
1
1
1
s
r
r
r
0
0
0
0
	
=
V
AL
Substitute :
0
	
(vii)
	
=
−




−
+


















γ
γ
f
AP
x
L
x
L
We obtain
1
1
1
1
s
0
	
(4.33)
Equation 4.33 represents the constitutive relation of the airspring (nonlinear). 
This is plotted in the non-dimensional form, in Figure 4.11a, for air (γ = 1.4).
From Figure 4.11a it is observed that the relation Equation 4.33 is one-to-one. 
Hence, it can be inverted to obtain the one-to-one relation (nonlinear):
	
=
x
F f(
)
s 	
(viii)
For the state-space model, use the following state variables (in the unified, 
systematic approach): =
q
v f
[ ,
]
s
T

156
Modeling of Dynamic Systems with Engineering Applications
Input: =
r
f t
[ ( )]
Clearly, one state equation is given by Equation i. The other state equation is 
obtained as follows.
Differentiate Equation 4.33 with respect to lime t:
	
 =
×
=
f
df
dx
dx
dt
df
dx v
s
s
s
	
(ix)
(a)
–1
–0.8
–0.6
–0.4
–0.2
0
0.2
0.4
0.6
0.8
1
–10
–5
0
5
10
Spring force
Displacement x
L
fs
AP0
Linear
stiffness at 0
γ = 1.4
(b)
–10
–8
–6
–4
–2
0
2
4
6
8
10
0
10
20
30
40
50
60
L
γAP0
fs
AP0
Spring force
Stiffness
γ = 1.4
fs
AP0
Spring force
γ = 1.4
(c)
–3
–2
–1
0
1
2
3
0
1
2
3
4
5
6
7
8
9
ks
L
γAP0
Stiffness
ks
FIGURE 4.11
(a) Non-dimensional characteristic curve of the airspring for γ = 1.4. (b) Stiffness characteristic of 
the airspring for γ = 1.4. (c) Stiffness characteristic of the airspring for γ = 1.4 (finer resolution near 
static region).

157
Model Linearization
Differentiate Equation 4.33 with respect to x:
	
γ
=
−




+
+


















=
γ
γ
+
+
df
dx
AP
L
x
L
x
L
k
f
1
1
1
1
(
)
s
s
s
0
1
1
	
(4.34)
Note: This expression (slope of the airspring characteristic) represents the nonlin-
ear stiffness ks, which is a function of fs in view of the fact that x is a one-to-one 
function of fs, as given by Equation viii.
	
Substitute Equation 4.34 into Equation ix. We obtain the second state equation
	
 =
f
k
f v
(
)
s
s
s
	
(x)
The stiffness of the airspring is plotted as a function of the spring force, in the 
non-dimensional form, in Figure 4.11b. A zoomed-in curve near the region of 
static conditions is shown in Figure 4.11c.
Note: The nondimensional data for this plot may be obtained as follows: For 
a range of values (say 201) of 
=
z
x L
/  in the interval −1.0 to +1.0, compute (see 
Equation 4.34):
	
−
+
+




γ
γ
+
+
z
z
1
(1
)
1
(1
)
1
1 	
(a)
and (see Equation 4.33):
	
−
−
+




γ
γ
z
z
1
(1
)
1
(1
)
	
(b)
Then, plot the values of Equation a against the corresponding values of Equation b.
Note: Loop equations and node equations are not explicitly written in the pres-
ent model development (for the sake of simplicity). However, they are implicitly 
satisfied.
	  (c)	
Simply by inspecting (i) and (x) we can write the linearized state-space equations 
(by linearizing each term, one by one).
	
 = −
+
mv
f
f t
ˆ
ˆ
ˆ( )
s
	
 =
f
k
f
v
ˆ
(
)| ˆ
s
s
s
0
where 
∧
( ) denotes the incremental variables about an operating point.
Note: Strictly, the second state equation is  =
+ 





f
k
f
v
dk
f
df
v
f
ˆ
(
)| ˆ
(
)
ˆ
s
s
s
s
s
s
s
0
0
. But, the 
second term drops out because =
v
0
0
 at the operating point.
	
If we take as the operating point x = 0, which is the static equilibrium point, 
then from Equation 4.34, the linearized stiffness is
	
γ
=
k
AP
L
2
s0
0 	
(xi)

158
Modeling of Dynamic Systems with Engineering Applications
Hence, the linearized state-space model is
	
 = −
+
mx
x
u t( )
1
2
	
(xii)
	

γ
=
x
AP
L
x
2
2
0
1
	
(xii)
State vector =
x
v f
[ˆ, ˆ ]
s
T, input vector =
u
f t
[ ˆ( )]
Note: x1 and x2 may be taken as the outputs of the system.
Then
	
x
Ax
Bu
=
+
	
y
Cx
Du
=
+
with
	
γ
=












=










=
A
B
D
m
AP
L
m
C
= 0
0
1
2
0
;
1
0
;
[1
1];
0
From (xi), it is observed that the stiffness of the airspring can be increased by 
increasing P0, for particular gas (γ) and system size (A and L).
Note: The parameter γ is fixed by the gas characteristic (γ = 1.4 for air) and can 
only be adjusted by changing the gas. The parameters A and L are fixed by the 
dimensions of the piston and the cylinder, and cannot be changed in a constructed 
system. These parameters can be adjusted in the design stage, for stiffness, before 
construction of the system. Specifically, stiffness can be increased by increasing A 
and decreasing L, and by using a gas of higher γ.
LEARNING OBJECTIVES
	
1.	 Modeling of a pneumatic system (airspring).
	
2.	 Adiabatic process.
	
3.	 Ways to adjust the stiffness of an airspring.
	
4.	 Application of the systematic and unified approach for modeling a nonlinear 
pneumatic system.
	
5.	 Linearization of a nonlinear system.
▪
Example 4.7
Radiation heat transfer may be expressed by the nonlinear relationship 
(
)
=
−
Q
K T
T
1
4
2
4
Here
Q = heat transfer rate (W)
T1 = heat source temperature (K)
T2 = heat receiver temperature (K)
K = a system constant
Consider the reference condition Q0, T10, and T20, which satisfies 
(
)
=
−
Q
K T
T
0
10
4
20
4
Change in heat transfer rate from the reference value is given by
	
δ
(
)
(
)
=
−
=
−
−
−
Q
Q
Q
K T
T
K T
T
0
1
4
2
4
10
4
20
4

159
Model Linearization
Non-dimensional “change” in the heat transfer rate:
	
δ
=
=
−
−
−
−
=
−
−
−
q
Q
Q
K T
T
K T
T
K T
T
T
T
T
T
(
)
(
)
(
)
1
0
1
4
2
4
10
4
20
4
10
4
20
4
1
4
2
4
10
4
20
4
	
(4.35)
Several approaches may be used to express the change δQ of the heat transfer rate 
from the reference value (Q0) as the temperature changes from the reference condition. 
Specifically, consider the following four approaches:
	 (a)	
(i)	 Suppose δ
=
−
T
T
T
1
10; 
=
T
T
2
20 and define the non-dimensional temperature 
change (of the heat source) as 
δ
=
−
r
T
T
T
10
20
. Then, study the variation of q with 
respect to r for a chosen pair of reference temperature values T10 and T20 in K
Note: First, graph the curve q vs. r for the chosen T10 and T20, and then discuss the 
nature of this curve.
(ii)  Suppose δ
=
−
T
T
T
20
2; 
=
T
T
1
10 and define the non-dimensional temperature 
change (of the heat receiver) as 
δ
=
−
r
T
T
T
10
20
. Then study the variation of q with 
respect to r for the same pair of reference temperature values T10 and T20 as 
before
Note: As before, start by graphing the curve q vs. r.
	 (b)	
(i)	 Local slope ∂
∂
=
Q
T
KT
4
1
1
3 for the source temperature variation δ
=
−
T
T
T
1
10
Then, using δ
δ
= ∂
∂
Q
Q
T
T we have, in the neighborhood of the reference point:
	
δ
δ
δ
δ
≅
−
⋅
=
−
−
⋅
−
=
+
+
⋅
−
Q
Q
KT
K T
T
T
T
T
T
T
T
T
T
T
T
T
T
T
T
T
T
T
4
(
)
4
(
)
(
)
4
(
)(
) (
)
0
10
3
10
4
20
4
10
3
10
20
10
4
20
4
10
20
10
3
10
20
10
2
20
2
10
20
or,
	
≅
+
+
q
T
T
T
T
T
r
4
(
)(
)
10
3
10
20
10
2
20
2
Study the variation of q with respect to r for the same chosen pair of reference 
temperature values T
T
and
10
20 as before.
Note: As usual, start by graphing q vs. r for the chosen T
T
and
10
20.
(ii)	 Local slope ∂
∂
= −
Q
T
KT
4
2
2
3 for the receiver temperature variation δ
=
−
T
T
T
20
2
Then in the neighborhood of the reference point: δ
δ
≅
⋅
−
⋅
Q
Q
K T
K T
T
T
4
(
)
0
20
3
10
4
20
4
As before, we have ≅
+
+
q
T
T
T
T
T
r
4
(
)(
)
20
3
10
20
10
2
20
2
Study the variation of q with respect to r for the same chosen pair of values
T
T
and
10
20 as before.
Note: As for the previous cases, first graph q vs. r for the chosen T
T
and
10
20.
(c)	 Compare and discuss the four cases (given under (a) and (b) above) particularly with 
respect to the corresponding thermal resistance values (near the reference condition).

160
Modeling of Dynamic Systems with Engineering Applications
Solution
	  (a)	
	
δ
δ
=
=
−
−
−
=
−
q
Q
Q
T
T
T
T
r
T
T
T
1,
0
1
4
2
4
10
4
20
4
10
20
Case (i):
	
δ
=
−
=
T
T
T
T
T
;
1
10
2
20
	
δ
⇒
=
+
−
−
−
=
+
−
−
−
−
=
+
−
+
−
+
−
+
−
−
−
q
T
T
T
T
T
T
T
T
r
T
T
T
T
T
T
T
r
T
T
T
r
T
T
T
r
T
T
r
T
T
T
(
)
(
)
1
[
(
) ]
(
)
1
[
4
(
)
6
(
)
4
(
)
(
)
]
(
)
10
4
20
4
10
4
20
4
10
10
20
4
20
4
10
4
20
4
10
4
10
3
10
20
10
2
10
20
2
2
10
10
20
3
3
10
20
4
4
20
4
10
4
20
4
	
⇒
=
+
+
+
q
Ar
Br
Cr
Dr
2
3
4	
(4.36)
with 
=
−
−
=
−
−
=
−
−
=
−
−
A
T
T
T
T
T
B
T
T
T
T
T
C
T
T
T
T
T
D
T
T
T
T
4
(
)
(
)
;
6
(
)
(
)
;
4
(
)
(
)
;
(
)
(
)
10
3
10
20
10
4
20
4
10
2
10
20
2
10
4
20
4
10
10
20
3
10
4
20
4
10
20
4
10
4
20
4
Note: 
>
>
>
>
A
B
C
D
0,
0,
0,
0
Reference point: =
=
q
r
0,
0
Non-dimensional thermal resistance =
=
dq dr
A
1
1  at the reference point.
=
=
−
=
−
=
−
×
−
−
−
=
R
dQ dT
T
T
Q
dq dr
T
T
Q A
T
T
T
T
K T
T
T
T
T
KT
Thermal resistance
1
(
)
1
(
)
(
)
(
)
(
)4
(
)
1
4
T
10
20
0
10
20
0
10
20
10
4
20
4
10
4
20
4
10
3
10
20
10
3
at the reference point.
Case (ii):
	
δ
=
−
=
T
T
T
T
T
;
21
2
1
10	
	
δ
⇒
=
−
−
−
−
=
−
−
−
−
−
=
−
−
−
+
−
−
−
+
−
−
−
q
T
T
T
T
T
T
T
T
T
r
T
T
T
T
T
T
T
r
T
T
T
r
T
T
T
r
T
T
r
T
T
(
)
(
)
1
[
(
) ]
(
)
1
{
[(
4
(
)
6
(
)
4
(
)
(
)
]}
(
)
1
10
4
20
4
10
4
20
4
10
4
20
10
20
4
10
4
20
4
20
4
10
4
20
3
10
20
20
2
10
20
2
2
20
10
20
3
3
10
20
4
4
10
4
20
4
	
⇒
=
′ −
′
+
′
−
′
q
A r
B r
C r
D r
2
3
4	
(4.37)
with
	
′ =
−
−
= 



′ =
−
−
= 



′ =
−
−
= 



′ =
−
−
=
A
T
T
T
T
T
T
T
A
B
T
T
T
T
T
T
T
B
C
T
T
T
T
T
T
T
C
D
T
T
T
T
D
4
(
)
(
)
;      
6
(
)
(
)
;
4
(
)
(
)
;       
(
)
(
)
20
3
10
20
10
4
20
4
20
10
3
20
2
10
20
2
10
4
20
4
20
10
2
20
10
20
3
10
4
20
4
20
10
10
20
4
10
4
20
4

161
Model Linearization
Note: ′ >
′ >
′ >
′ >
A
B
C
D
0,
0,
0,
0
As in Case (i),
Non-dimensional thermal resistance =
=
′
dq dr
A
1
1
ref
Thermal resistance 
=
R
dQ dT
1
T
ref
	
=
−
=
−
=
−
×
−
−
−
=
T
T
Q
dq dr
T
T
Q A
T
T
T
T
K T
T
T
T
T
KT
(
)
1
(
)
(
)
(
)
(
)4
(
)
1
4
ref
10
20
0
10
20
0
'
10
20
10
4
20
4
10
4
20
4
20
3
10
20
20
3
	  (b)	
Case (i):
From the result in (a)(i), the linearized relation is
	
=
q
Ar	
(4.38)
	
=
−
−
=
+
+
A
T
T
T
T
T
T
T
T
T
T
with
4
(
)
(
)
4
(
)(
)
10
3
10
20
10
4
20
4
10
3
10
20
10
2
20
2
Non-dimensional thermal resistance = A
1
Thermal resistance 
=
R
KT
1
4
T
10
3
Case (ii):
From the result in (a)(ii), the linearized relation is
	
=
′
q
A r	
(4.39)
with ′ =
−
−
=
+
+
A
T
T
T
T
T
T
T
T
T
T
4
(
)
(
)
4
(
)(
)
20
3
10
20
10
4
20
4
20
3
10
20
10
2
20
2
Non-dimensional thermal resistance =
′
A
1
Thermal resistance 
=
R
KT
1
4
T
20
3
	  (c)	 For the four approaches, the thermal resistances at the reference point (operat-
ing point) are given in Table 4.1.
TABLE 4.1
Expressions for Thermal Resistance
Case
Thermal Resistance
(a)(i)
KT
1
4
10
3
(a)(ii)
KT
1
4
20
3
(b)(i)
KT
1
4
10
3
(b)(ii)
KT
1
4
20
3

162
Modeling of Dynamic Systems with Engineering Applications
The curves of q versus r (non-dimensional) are plotted in Figure 4.12 for the operat-
ing condition 
Κ
Κ
=
=
T
T
310
,
290
10
20
.
Comparison:
	
1.	 Cases (a)(i) and (ii) are general and are not linearized relations. The corre-
sponding thermal resistances are determined by the slope at the reference 
point =
=
q
r
0,
0.
	
2.	 Cases (b)(i) and (ii) are the linearized versions of (a)(i) and (ii), respectively. 
Hence, the corresponding thermal resistances are the same as those for Part (a), 
at the reference point. 
	
	 Note: Thermal resistance is defined locally (linear).
	
3.	 The larger the T10, the smaller the thermal resistance, because for a given T20, a 
larger T10 produces a greater heat transfer rate.
	
4.	 The larger the T20, the larger the thermal resistance, because for a given T10, a 
larger T20 produces a smaller heat transfer rate.
(a)
(b)
–1
–0.8
–0.6
–0.4
–0.2
0
0.2
0.4
0.6
0.8
1
–1
–0.8
–0.6
–0.4
–0.2
0
0.2
0.4
0.6
0.8
1
Non-dimensional heat transfer change q
(a)(i)
(a)(ii)
(b)(i)
(b)(ii)
Non-dimensional temperature change  r
–10
–8
–6
–4
–2
0
2
4
6
8
10
–10
–20
–10
0
10
20
30
FIGURE 4.12
Non-dimensional curves of q versus r for the four cases: (a) Local details and (b) global view.

163
Model Linearization
LEARNING OBJECTIVES
	
1.	 Modeling of a nonlinear thermal system
	
2.	 Characteristics of radiation heat transfer
	
3.	 Linearization of radiation heat transfer
	
4.	 The local concept of thermal resistance
▪
4.5  Linearization Using Experimental Data
Linearization of nonlinear analytical models was studied in the previous sections. In some 
situations, an accurate analytical model may not be readily available for an existing physical 
system. Furthermore, as noted before, slope-based local linearization may not be possible with 
some analytical models. If a prototype of the system is available, another option for develop-
ing a linear model is through the use of experimental data. This is called experimental modeling 
(or model identification or system identification), and may be achieved in several ways including:
•	 Model identification of the entire dynamic system using input–output test data. 
This is what is commonly known as system identification. It is a complex process, 
particularly for high order systems, because the data must be fitted to all important 
dynamic characteristics of the system
•	 Testing only a key part or component of the system, which may be nonlinear, 
under steady-state conditions. Since steady-state test data are used, even if the 
entire system is tested, some characteristics of the dynamics (e.g., inertia forces/
torques) will not be present in the data. Hence, some dynamics (e.g., inertia) of the 
system have to be integrated into the model separately (and analytically).
It is the second approach (a special case of the first approach) that is presented in the pres-
ent section. In this approach, experiments are conducted on the system (or its subsystem) 
at steady state, to determine the operating curves. These operating curves, which typically 
are nonlinear, are used in deriving a linear model. This approach is discussed now, first 
taking an electric motor as the example system and then extending it to an example in the 
thermo-fluid domain. The approach is as follows:
	
1.	Linearization is done by finding the local slopes (derivatives with respect to the 
independent variables) of the experimental characteristic curves.
	
2.	For reasons of experimental feasibility, the curves are determined by varying 
one variable at a time (keeping the other variables constant at some operating 
condition).
	
3.	On a two-axis coordinate frame, only two such variables can be represented.
	
4.	Typically, the experiments are conducted at steady state. Dynamics (particularly, 
inertial dynamics) is incorporated separately into the model, using the corre-
sponding analytical terms.
4.5.1  Torque-Speed Curves of Motors
The speed-versus-torque curves of motors under steady conditions (i.e., steady-state oper-
ating curves) are available from the motor manufacturers (data sheets). These curves have 

164
Modeling of Dynamic Systems with Engineering Applications
the characteristic shape that they decrease slowly up to a point and then drop rapidly 
to zero. One simple reason for this characteristic is the power supply constraint, which 
requires a drop in speed in order to achieve a greater torque. We have already discussed 
an example that uses the nonlinear characteristic curve of an ac induction motor (see 
Figure 4.5). The operating curves of dc motors take a similar, but not identical, characteris-
tic form. Figure 4.13 presents three characteristic curves of a dc motor that has both stator 
windings (field windings) and rotor windings (armature windings). In order to be pow-
ered by a single input (dc voltage), the two sets of windings have to be connected together. 
Commonly, they are connected
•	 In parallel (i.e., shunt-wound)
•	 In series (i.e., series-wound)
•	 With part of the stator windings connected in series and the remaining part con-
nected in parallel with the rotor windings (i.e., compound-wound)
It can be seen from Figure 4.13 that the interconnection arrangement between the stator 
windings and the rotor windings determines the shape of the characteristic curves.
The torque at zero speed is the braking torque or starting torque or stalling torque. The speed 
at zero torque is the no-load speed, which, for an ac induction motor, is also the synchronous 
speed (when the motor speed equals the speed of the rotating magnetic field, giving the 
condition of no slip).
Typically, measurement of the characteristic curves of a dc motor with a common input 
for exciting both stator and rotor, is done as follows:
	
1.	Keep the supply voltage to the motor windings at a known constant value.
	
2.	Apply a constant known load (torque) to the motor shaft.
(a)
(b)
Speed ωm
Motor Torque Tm
Small 
slope
v
Tm
v
Ts
Tm
v
Ts
(c)
ωo
ωo
ωm
ωm
FIGURE 4.13
Torque-speed operating curves of dc motors. (a) Shunt-wound; (b) series-wound; and (c) compound-wound.

165
Model Linearization
	
3.	Once the conditions of the motor become steady (i.e., reaches a constant speed) 
measure the motor speed.
	
4.	Repeat the steps 2 and 3 for increments of torques within an appropriate practical 
range. This gives one operating curve, for a specified supply voltage.
	
5.	Go to Step 1, change the supply voltage by a suitable increment, to another con-
stant value and repeat the steps 2 through 4, to get another operating curve.
	
6.	Repeat the steps 1 through 5 to get the required number of operating curves.
It should be noted that the motor speed is maintained steady in these experiments as they 
are carried out at “steady” operating conditions. That means the motor inertia (inertial 
torque) is not accounted for in these curves, while mechanical damping is. Hence, motor 
inertia has to be introduced separately when using these curves to determine a “dynamic” 
model for a motor. Since mechanical damping is included in the measurements, it should 
not be introduced again. Also, electrical damping is inherent in the operating curves. Of 
course, if the motor is connected to an external load, the damping, inertia, and flexibility 
of the load all have to be accounted for separately, by a suitable analytical model, when 
using experimental operating curves of motors in developing models for motor-integrated 
dynamic systems.
Note: Some characteristics of the load connected to the motor also may be experimentally 
determined and represented by operating curves rather than by an analytical model.
4.5.2  Experimental Linear Model for Motor Control
Consider an experimental set of steady-state operating curves for a motor, each obtained at 
a constant supply/control voltage. In particular, consider one curve (primary curve, which 
passes through the normal operating point O) measured at voltage vc. Also, two other 
curves adjacent to (enclosing) this curve, and measured at voltages vc + Δ1vc and vc − Δ2vc, 
where Δvc =Δ1vc + Δ2vc, and ∆Tm is the voltage increment between these adjacent curves at 
O, as shown in Figure 4.14.
Draw a tangent to the primary curve at the normal operating point O. The slope of the 
tangent is negative, as shown. Its magnitude b is given by
	
ω
= −∂
∂
=
=
b
T
O
Damping constant
slope magnitude at
m
m v
 constant
c
	
(4.40)
Motor torque 
Tm
Motor speed ωm
∆Tm
vc + ∆1vc
∆vc = ∆1vc + ∆2vc
b
vc
1 O
vc – ∆2vc
FIGURE 4.14
Two steady-state operating curves of a motor at constant input voltage.

166
Modeling of Dynamic Systems with Engineering Applications
It should be clear that b represents an equivalent rotary damping constant (Torque/
Angular Speed) that includes both electromagnetic and mechanical damping effects in the 
motor. The included mechanical damping comes primarily from the friction of the motor 
bearings and aerodynamic effects. Since a specific load is not considered in the operating 
curve, load damping is not included.
Draw a vertical line through the operating point O to intersect the two adjacent operat-
ing curves. We obtain
∆Tm = torque intercept between the two curves
Since a vertical line is a constant speed line, we have
	
Voltage gain 
∆
∆
= ∂
∂
=
ω
=
k
T
v
T
v
v
m
c
m
c
 constant
m
	
(4.41)
Since the motor torque Tm is a function of both motor speed ω m and the input voltage vc (i.e., 
ω
=
T
T
v
(
,
)
m
m
m
c ) we write from basic calculus:
	
δ
ω
δω
δ
= ∂
∂
+ ∂
∂
ω
T
T
T
v
v
m
m
m v
m
m
c
c
c
m
	
(4.42a)
or
	
δ
δω
δ
= −
+
T
b
k
v
m
m
v
c	
(4.42b)
where the motor damping constant b and the voltage gain kv are given by Equations 4.40 
and 4.41, respectively.
Equation 4.42 represents a linearized model of the motor. The torque that is needed to 
drive the rotor inertia of the motor is not included in this equation (because steady-state 
curves are used in determining the model parameters). The inertia term should be explic-
itly present in the mechanical equation of the motor rotor, as given by Newton’s second 
law (see Figure 4.15), in the linearized (incremental) form:
	
δω
δ
δ
=
−
J
d
dt
T
T
m
m
m
L	
(4.43)
where Jm = moment of inertia of the motor rotor and TL = load torque (equivalent torque 
applied on the motor by the load that is driven by the motor).
Note that mechanical damping of the motor, as shown in Figure 4.15, is not included 
in Equation 4.43 because it (along with electro-magnetic damping) is already included in 
Equations 4.40 and 4.42.
4.5.3  Experimental Linear Model of a Nonlinear System
The method of obtaining the experimental model of a motor and its linearization 
are presented in the previous section. Now consider any nonlinear dynamic system. 
Experimentally obtaining its steady operating curve and its linearization for incorporat-
ing into a linear dynamic model are outlined now. Assuming only two independent vari-
ables in the characteristic function, the relevant steps are given below:
	
1.	Keep one variable constant at some operating condition and vary the other vari-
able in steps.
	
2.	Plot the data curve.

167
Model Linearization
	
3.	Repeat steps 1 and 2 by changing the operating condition of the first variable by a 
small increment. Obtain a series of characteristic curves in this manner.
	
4.	Linearization: For a specific operating condition, find the slope of the curve that 
passes through it (i.e., with the first variable kept constant); also find the vertical 
increment of two adjacent curves enclosing the operating point (i.e., with the sec-
ond variable kept constant).
	
5.	Slopes with respect to the two independent variables are obtained from the two 
values in Step 4.
Once the local slopes of the nonlinear characteristic function with respect to the two inde-
pendent variables are determined at the operating condition, they can be easily incorpo-
rated into a linear model (as in the method of analytical linearization). An example is given 
now.
Example 4.8
A gas turbine drives a centrifugal pump through a long shaft, as shown in Figure 4.16a. 
The variables and parameters of the system are identified in the figure.
For Gas Turbine:
	
= Q
Fuel input rate
(gal/s)
	
=
=
⋅
J
Moment of inertia of the rotor
0.1k
m
t
g
2
(
) =
=
⋅
b
Mechanical damping constant external, due to bearings, etc.
0.5 N m/rad/s
t
For Shaft:
	
=
=
⋅
k
Torsional stiffness
20.0 N m/rad
	
= T
Torque in the shaft
k
For Centrifugal Pump:
Moment of inertia of the rotor (may include added mass due to fluid load)
	
=
=
⋅
J
0.05k
m
p
g
2
Load shaft
Damping
Magnetic
torque
Jm
Load torque
TL
Tm
Motor rotor
bm
FIGURE 4.15
Mechanical system of the motor.

168
Modeling of Dynamic Systems with Engineering Applications
Mechanical damping constant (linear viscous) of pump (may partly include fluid load)
	
=
=
⋅
b
3.0 N m/rad/s
t
The torque vs. speed curves of the turbine, at steady state, for different values of the fuel 
input rate are shown in Figure 4.16b.
Note: Torque is measured on the turbine shaft prior to the bearings. Speed Ω is given 
in rpm, not rad/s.
The system output is the pump speed.
	 (a)	 Determine a complete state-space model for the system using 
Ω
T
Q
(
,
) as the 
generated torque of the turbine and Ω
Ω
T
,
and
k
p as the state variables; Q as the 
input variable; and Ωp  as the output.
	 (b)	 Linearize the model about an operating point, for incremental variables of the 
states and the input, given by
	
δΩ
ω δ
τ
δΩ
ω
δ
=
=
=
=
T
Q
q
,
,
, and
k
k
p
p
First use the given symbols for the model parameters. Next, substitute the numerical 
values that are given and those extracted from the experimental curves. Take 
=
Q
8gal/s 
and Ω= 400 as the operating point.
(a)
T(Ω, Q)
Jt
bt
k
Tk
Ω
Jp
bp
Q
Fuel rate
Gas turbine
Centrifugal pump
Water in
Water out
(b)
0
20
60
80
100
120
140
160
200
400
600
800
40
4
5
6
7
8
9
10
Q (gal/s)
(rpm)
Ω
Speed
Torque T(N.m)
Fuel input
Rate
Ωp
FIGURE 4.16
(a) Gas turbine operating a water pump and (b) steady-state operating curves of the gas turbine.

169
Model Linearization
Solution
	  (a)	
Consider the free-body diagrams of the turbine rotor, shaft, and the pump rotor, 
as shown in Figure 4.17a.
Constitutive Equations:
	
Ω
Ω
Ω
=
−
−
J
T
Q
b
T
Turbine Rotor:
(
,
)
t
t
m	
(i*)
	
 =
T
k
Shaft:
k
	
(ii)
	
Ω
Ω
=
−
J
T
b
Pump Rotor:
p
p
p
p
p	
(iii*)
Node equations at the motor-shaft interface and shaft-pump interface:
	
−
T
T = 0
m
k
	
(iv)
	
−
T
T = 0
k
p
	
(v)
Substitute (iv) in (i*):
	
Ω
Ω
Ω
=
−
−
J
T
Q
b
T
(
,
)
t
t
k	
(i)
Gas turbine rotor
Shaft
Pump rotor
(a)
Jt
btΩ
Ω
Ω
Tm
Tk
k
Ωp
Ωp
Tk
Tp
Jp
bpΩp
(b)
0
20
60
80
100
120
140
160
200
400
600
800
40
Torque T(N.m)
(rpm)
Ω
Speed
T(Ω, Q)
FIGURE 4.17
(a) Free-body diagrams and (b) Linear parameter estimation using experimental curves.

170
Modeling of Dynamic Systems with Engineering Applications
Substitute (v) in (iii*):
	
Ω
Ω
=
−
J
T
b
p
p
k
p
p	
(iii)
(i) through (iii) are the state equations, with
	
Ω
Ω
=
X
State vector
T
[
,
,
]
k
p
T
	
=
U
Q
Input vector
[ ] 
	
Ω
=
Y
Output vector
[
]
p
	  (b)	 Linearize
	



δΩ
δ
δΩ
δ
δ
δΩ
δΩ
δΩ
δ
δΩ
=
−
−
=
−
=
−
J
T
b
T
T
k
J
T
b
(
)
t
t
k
k
p
p
p
k
p
p
with δ
Ω
δΩ
δΩ
= ∂
∂
+ ∂
∂
= −
+
∂
T
T
T
Q
b
k
Q
q
0
0
where 
Ω
= −∂
∂
b
T
(vi)
o
; and 
(
)
= ∂
∂
k
T
Q
vii
q
o
Substitute the given notation. We obtain the linear state equations
	



ω
ω
ω
τ
τ
ω
ω
ω
τ
ω
= −
+
−
−
=
−
=
−
J
b
k q
b
k
J
b
(
)
t
q
t
k
k
p
p
p
k
p
p
	
(viii)
where the incremental state vector and the incremental input vector are
	
ω
τ
ω
= 

=
x
u
q
;
[ ]
k
p
T
In the vector-matrix form we have
	
 =
+
=
+
x
Ax
Bu
y
Cx
Du
=
−
+
−
−
−










=










= 

=
A
B
C
D
b
b
J
J
k
k
J
b
J
k
J
with,
(
)/
1/
0
0
0
1/
/
;
/
0
0
;   
0
0
1 ;
[0]
t
t
t
p
p
p
q
t
Now we estimate b and kq (Equations (vi) and (vii)) from the given operating curves, as 
shown in Figure 4.17b:

171
Model Linearization
	
π
π
=
=
=
−
⋅
−
×
=
×
=
⋅
b
Q
slope at the operating point on the
8 gal/s curve
(130
80)(N m)
(560
200)
2
60 (rad/s)
50
360
2
60
1.326 N m/rad/s
kq = increment of T over the change in Q from 7 to 9 gal/s with Ω kept constant at 
=
−
⋅
−
=
⋅
400 rpm
(110
92)(N m)
(9
7)(gal/s)
9.0N m/gal/s
Substitute the given parameter values:
	
+
=
+
=
=
⋅
=
=
⋅
=
=
=
⋅
⋅
=
−
−
−
−
b
b
J
J
J
b
J
k
J
1.326
0.5
0.1
18.26s ;
1
10.0 (kg m ) ;
1
1
0.05
20.0 (kg m )
3.0
0.05
60.0s ;
9.0(N m/gal/s)
0.1(kg m )
90.0gal/s
t
t
t
p
p
p
q
t
1
2
1
2
1
1
2
3
	
=
−
−
−
−










=










= 

=
A
B
C
D
We have
18.26
10.0
0
20.0
0
20.0
0
20.0
60.0
;
90.0
0
0
;
0
0
1 ;
[0]
LEARNING OBJECTIVES
	
1.	 Use of test data in model development of a dynamic system
	
2.	 Modeling of a multidomain (thermo-fluid and mechanical) system
	
3.	 Model linearization using test data
	
4.	 Integration of analytical and experimental models
	
5.	 Incorporation of system dynamics with steady-state characteristics.
▪
4.6  Other Methods of Model Linearization
As we have studied, popular methods of linearization of a nonlinear device employ 
the local behavior of the device over a small operating range. This local linearization is 
straightforward but is not generally applicable. In particular, local slope-based lineariza-
tion (whether analytical or experimental) of a dynamic system may fail (or may not be 
feasible) due to such reasons as the following:
•	 The operating conditions can change considerably and a single local slope may not 
be valid over the entire range.
•	 Multiple local slopes may exist at the same operating condition (e.g., switching 
from one slope value to another at the same value of the independent variable).
•	 The local slope may not exist or may be insignificant compared to the O(2) terms 
of the Taylor series expansion (e.g., Coulomb friction).
•	 In some nonlinear systems, the use of local slopes (e.g., negative damping in a con-
trol law) may lead to undesirable consequences (e.g., instability).

172
Modeling of Dynamic Systems with Engineering Applications
In such situations, other problem-specific or ad-hoc approaches may have to be used. For 
example, several different linear models may be used over the operating range of the 
system.
On the other hand, methods are available to reduce or eliminate nonlinear behavior in 
devices. They include the use of calibration curves (in the static case), linearizing elements 
(e.g., resistors and amplifiers in bridge circuits) to neutralize the nonlinear effects, and 
nonlinear feedback (feedback linearization) to eliminate the nonlinear characteristics in the 
system. Also, methods other than the local slope-based methods are available for devel-
oping linear models. They include the use of an equivalent linear model based on some 
criterion of equivalence such as energy per operating cycle, and the describing function 
method (which extends the transfer function method to nonlinear systems and is based 
on the equivalence of the fundamental frequency response). Several of these methods are 
outlined now.
4.6.1  The Calibration Curve Method
A static nonlinearity corresponds to a nonlinear algebraic (rather than differential-equa-
tion) relationship between the input and the output. Typically, this “static nonlinearity” 
(rather than “dynamic nonlinearity”) occurs under steady-state conditions. A significant 
consequence of a static nonlinearity is the algebraic distortion of the output. This can be 
removed (linearized) by recalibration or rescaling. This approach is explained now using an 
example.
Example 4.9
Suppose that the steady-state input–output behavior of a device is given by 
=
y
kepu, 
where u is the input and y is the output. Consider a sinusoidal input 
ω
=
u
u
t
sin
0
. The 
corresponding output is =
ω
y
ke pu
t
sin
0
, which is far from sinusoidal.
Note: In a linear system, the steady-state output also will be sinusoidal at the same 
frequency (ω).
Now let us “transform” the problem as 
=
+
y
pu
k
log( )
log( ). In this manner, the input-
output relationship is “exactly” linearized by simply using a log scale for the output 
and also adding a constant offset of −
k
log( ). In this recalibrated form, the output for a 
sinusoidal input will be purely sinusoidal at the same frequency (ω) with the amplitude 
magnified by p. The phase angle does not change.
To illustrate this behavior numerically, use the parameter values: k = 2.0, p = 1.5, 
u0 = 2.0, and ω = 1.0. We use the following MATLAB function to determine the input-
output behavior of this numerical example (Figure 4.18a) and the corresponding two 
signals (Figure 4.18b):
% Response of nonlinear device
u0=2.0;k=2.0;p=1.5;
t=0:0.01*pi:4*pi;
u=sin(t);
y=k*exp(p*u);
y2=log(y);
% plot the results
plot(u,y,'-',u,y2,'-',u,y2,'o')
plot(t,u,'-',t,y,'-',t,y,'o',t,y2,'-',t,y2,'+')
It is seen that the actual nonlinear function considerably distorts the input sine signal. 
Using a log scale for the output, however, conveniently and accurately linearizes the 
behavior, giving an undistorted output. Furthermore, by using the log output shown 

173
Model Linearization
in Figure 4.18a, we can extract the two parameters p and k from the slope and the 
y-­intercept of the linear curve. Specifically, p = slope = 3.0/2.0 = 1.5; Log k = 0.7 → k = 2.0.
LEARNING OBJECTIVES
	
1.	 Removal of static nonlinearity
	
2.	 Calibration (rescaling) method
	
3.	 Parameter extraction from static input–output data
▪
4.6.2  The Equivalent Model Approach of Linearization
Another way to linearize a nonlinear model is through some criterion of equivalence. 
Specifically, a linear model that is equivalent to the nonlinear model is determined, 
based on some criterion. As in the example of approximating a distributed-parameter 
model by a lumped-parameter model (see Chapter 3), energy equivalence is a practi-
cal and convenient criterion of equivalence for the present approach of linearization. 
Specifically, the energy absorbed (or energy dissipated, or work done) in an operating 
cycle is used as the criterion of model equivalence. This approach is illustrated now 
using an example.
(a) 
(b) 
–1
–0.8
–0.6
–0.4
–0.2
0
0.2
0.4
0.6
0.8
1
–1
0
1
2
3
4
5
6
7
8
9
Input u
Output y
Behavior of nonlinear device (p = 1.5)
Nonlinear output
Log output
0
2
4
6
8
10
12
14
–1
0
1
2
3
4
5
6
7
8
9
Time (s)
Signal
Signals (p = 1.5)
Input
Output
Log output
FIGURE 4.18
Static sine response of a nonlinear device. (a) Input–output behavior; (b) Signals.

174
Modeling of Dynamic Systems with Engineering Applications
Example 4.10
Consider the nonlinear damper (e.g., fluid damper) model shown in Figure 4.19a. The 
constitutive relation of the damper is 
 
=
f
cx x
| | where
	
f  = damping force
	
x = relative displacement of the damper
	
x = relative velocity of the damper
	
c = damping parameter
Suppose that the harmonic force 
ω
=
f
f
t
sin
0
 is applied to the damper. At steady state, 
take the harmonic component (dominant component) of the displacement x as
	
ω
φ
=
+
x
x sin(
t
)
0
	 (a)	 Determine the energy dissipation in one cycle of motion (i.e., in the period 
π ω
=
T
2 / ). Express your result in terms of 
ω
c x
,
and
0
.
	 (b)	 Now consider the linear viscous damper model shown in Figure 4.19b. Here, 
the constitutive relation is 

=
f
bx where 
=
b  viscous damping coefficient. 
Following the same procedure as for the nonlinear damper, determine the 
energy dissipation in one cycle of motion of the linear damper. Express your 
result in terms of 
ω
b x
,
, and
0
.
	 (c)	 From the two results, give an equivalent linear viscous damping coefficient 
beq that results in the same energy dissipation per cycle as for the nonlinear 
damper. Express your result in terms of 
ω
c x
,
and
0
.
	 (d)	 Comment on the limitations in the use of this method of linearization.
Solution
	  (a)	
	
 
=
f
cx x	
(i)
	
ω
=
f
f
t
sin
0
	
(ii)
	
ω
φ
=
+
x
x
t
sin(
)
0
	
(iii)
	

ω
ω
φ
=
+
x
x
t
cos(
)
0
	
(iv)
Energy dissipation per cycle of excitation, 
∫
∫
∆=
=
u
f dx
f dx
dt dt
cycle
cycle
Substitute (i) and (iv): 


∫
∫
∆
ω
ω
φ
ω
φ
=
=
+
+
φ ω
π
φ ω
−
−
u
c
x x dt
cx
t
t
dt
 
cos (
) cos(
)
cycle
2
0
3
3
2
/
(2
)
x
x
( )
f t
( )
f t
| x |
cx
bx
(a)
(b)
FIGURE 4.19
(a) A nonlinear fluid damper; (b) A linear viscous damper.

175
Model Linearization
Change variables: θ
ω
φ
=
+
t
. Then,
	
φ
ω
θ
π
φ
ω
θ
π
θ
ω
= −
=
=
−
=
=
t
t
d
dt
At
,
0
At
(2
) ,
2
Also,
	
Substitute:
	
∫
∫
∫
∆
ω
θ
θ
θ
ω
θ θ
θ
θ
π
ω
θ
θ
θ
ω
θ
θ
ω
∆
ω
=
=
≥
=




=
−
=
−




=
−




→
=
π
π
π
π
u
cx
d
cx
d
Note
cx
d
cx
cx
u
cx
cos
cos
4
cos
: cos
0 when
0 to 2
4
cos (1
sin
)
4
sin
1
3 sin
4
1
1
3
8
3
0
3
2
2
0
2
0
3
2
3
0
/2
0
3
2
0
/2
2
0
3
2
3
0
2
0
3
2
0
3
2
	 (b)	
	

=
f
bx	
(iʹ)
As before,
∫
∫
∫
∫
∆
ω
ω
φ
ω
θ θ
ω
θ
θ
ω θ
θ
ω
π
∆
π
ω
′ =
=
+
=
=
+


=
+




=
×
+


→
′ =
φ ω
π
φ ω
π
π
π
−
−
u
b
x dt
bx
t
dt
bx
d
bx
d
bx
bx
u
bx
cos (
)
cos
1
2 1
cos 2
1
2
1
2 sin 2
1
2
2
0
   
cycle
2
0
2
2
2
/
(2
)
0
2
2
0
2
0
2
0
2
0
2
0
2
0
2
0
2
	 (c)	
For the equivalence of energy dissipation in one cycle, we must satisfy ∆
∆
=
′
u
u  
for =
b
beq
	
π
ω
ω
π
ω
→
=
→
=
b x
cx
b
cx
            
8
3
            
8
3
eq
eq
0
2
0
3
2
0
	  (d)	
The equivalent damping constant depends on both excitation frequency and the 
response amplitude (hence on the excitation amplitude. This is a common 
characteristic of a nonlinear system, as pointed out before, and also seen in 
the describing function method, which is considered next). Therefore, the 
­parameters of the equivalent linear model have to be changed depending on 
the excitation parameters.

176
Modeling of Dynamic Systems with Engineering Applications
LEARNING OBJECTIVES
	
1.	 Energy equivalence method of linearization
	
2.	 Dependence of the linearized model on the excitation amplitude
	
3.	 Limitations of energy-equivalence linearization
	
4.	 Change of variables to simplify analysis
▪
Depending on the situation, other criteria of equivalence may be used for ­determining 
the equivalent linear model. The describing function method of linearization, for exam-
ple, uses the criterion of “fundamental frequency equivalence,” which is presented next.
4.6.3  The Describing Function Method
Nonlinear systems can be analyzed in the frequency domain by using the describing func-
tion approach. As observed before, when a sinusoidal input (at a specific frequency) is 
applied to a nonlinear device, the resulting output at steady state will have a component 
at this fundamental frequency and also components, typically harmonics, at other fre-
quencies (as a result of the property of “frequency creation” by the nonlinear device). The 
response may be represented by a Fourier series, which will have a signal component at 
this input frequency (fundamental frequency) and also at integer multiples of the input 
frequency. The describing function approach neglects all the higher frequency compo-
nents (harmonics) in the output and retains only the fundamental component (i.e., the 
component at the input frequency). This output component, when divided by the input, 
produces the describing function of the device. In this manner, we obtain a “transfer func-
tion model” called the describing function for the nonlinear device. But, unlike for a linear 
device, the gain and the phase shift of a describing function will vary with the input 
amplitude in general.
Clearly, the describing function method of linearization is a method of equivalent model 
(see previous section). Here the equivalence criterion is the fundamental frequency com-
ponent of the output (response). The obtained equivalent model is a frequency-domain 
model (a transfer function—see Chapter 6), not a time-domain model. As in the case 
of energy equivalence, however, the equivalent model in the present case (describing 
­function) will depend in general on the excitation amplitude and the excitation frequency. 
We now ­illustrate the method using an example.
Example 4.11
The ideal relay is a two-state switching function. Its input–output behavior is given by 
the analytical relationship
	
=
y
y
u
sgn( )
0
	
(i)
where “sgn” denotes the signum (sign) function. Specifically, if the input takes a posi-
tive value, the output switches to y0 and if the input takes a negative value, the output 
switches to −y0. When u = 0, the output value is not strictly defined, but we will take it 
to be 0 as well. Consider a sinusoidal input, given by
	
ω
=
u
u
t
sin
0
The output is a pulse with the same frequency (same period) as the input, as shown in 
Figure 4.20a.

177
Model Linearization
Determine a describing function N for this ideal relay, which can be represented by 
the block diagram in Figure 4.20b.
Solution
First, we need to determine the signal component of frequency ω in the output signal. 
This can be obtained by the Taylor series expansion of the output signal. We have
	
∑
ω
ω
ω
=
=
+
+
=
∞
y
y
t
b
a
i t
b
i t
sgn(sin
)
(
sin
cos
)
i
i
i
0
0
1
	
(iv)
First, by setting t = 0 in (iv), we note that 
=
b
0
0
. Then, we only need to determine 
a
b
and
,
1
1  one of which can be made zero (without loss of generality) from the nature of 
the nonlinear function. To determine a1, multiply both sides of (iv) by 
ωt
sin
 and inte-
grate w.r.t. time t, over a full cycle of the signal (i.e., from 0 to π ω
2 / ). It is easy to see that 
all the terms on the RHS of (iv), except the term containing a1, go to zero because they 
have identical positive and negatives halves over the integration period. Then we have
	
∫
∫
ω
ω
ω
ω
=
π ω
π ω
y
t
t dt
t a
t dt
sin
sgn(sin
)
(sin
)(
sin
)
0
0
2 /
1
0
2 /
	
∫
∫
∫
ω
ω
ω
→
=
=
−
π ω
π ω
π ω
y
tdt
a
tdt
a
t dt
2
sin
sin
1
2 (1
cos 2
)
0
0
/
1
2
0
2 /
1
0
2 /
(a)
Input u
–y0
y0
y
π
ω
0
2π
ω
3π
ω
Time t
u
π
ω
0
2π
ω
3π
ω Time t
Output y
0
u0
u0
–
(b)
Output y
N
Input u
FIGURE 4.20
(a) The output of an ideal relay for a sine input and (b) the describing function representation of 
a nonlinear device.

178
Modeling of Dynamic Systems with Engineering Applications
ω
ω
ω
ω
→
−


=
−




π ω
π ω
y
t
a
t
t
2
cos
1
2
1
2
sin 2
0
0
/
1
0
2 /
 → ω
π
ω
=
y
a
4
0
1
We have 
π
=
a
y
4
1
0 .
In the same way, we can show that 
=
b
0
1
. This means the fundamental component of 
the output y is 
ω
π
ω
=
a
t
y
t
sin
4
sin
1
0
.
We get the describing function by dividing this output component by the input signal 
ω
=
u
u
t
sin
0
. Specifically
	
π
=
N
y
u
4
0
0
Clearly, this function depends on the input amplitude u0, which is a characteristic of a 
nonlinear system.
▪
More details of the describing function approach can be found in textbooks that deal 
with nonlinear control theory.
4.6.4  Feedback Linearization
Feedback linearization is used in a control system to make a nonlinear plant (i.e., the pro-
cess or the system that is being controlled) behave like a linear plant. This is done primarily 
to make a linear control method effective in a nonlinear system. However, nonlinearities 
and dynamic coupling must be compensated faster than the control speed. In the feedback 
linearization technique (FLT), this is accomplished by implementing a linearizing and decou-
pling controller inside the direct control loops. Feedback linearization of a nonlinear and 
coupled mechanical dynamic systems (e.g., robotic manipulator) is outlined now.
Consider a mechanical dynamic system (plant) given by:
	

( )
(
)
( )
=
+
M q
q
n q q
f t
d
dt
,
2
2
	
(4.44)
in which:

=














=
f
f
f
fr
1
2
 vector of input forces at various locations of the system
	

=














q
q
q
qr
1
2
 = vector of response variables (e.g., positions) at the forcing locations of the 
system
	
( )
M q  = inertia matrix (nonlinear)

(
)
n q q
,
 = a vector of nonlinear effects in the system (e.g., damping, backlash, Coriolis and 
centrifugal accelerations, gravitational effects)
Now, suppose that we can model M by Mˆ  and n by nˆ. Then, we can compute Mˆ  using 
the Mˆ  model and the on-line measurement q. Similarly, we can compute nˆ using the model 

179
Model Linearization
and the on-line measurements q and q. With the use of these computed values of Mˆ  and nˆ, 
the following linearizing feedback controller can be implemented:
	
∫
=
+
−



−
−
f
MK e
T
e
T
q
n
dt
d
dt
ˆ
ˆ
i
d
1
	
(4.45)
in which
	
=
−
=
=
e
q
q
q
error (correction) vector
desired response
d
d
and K, Ti, and Td are constant control parameter matrices. This control scheme is shown 
in Figure 4.21.
To show that this is indeed a linearizing controller, substitute the controller Equation 
4.45 into the plant Equation 4.44. We obtain
	
∫
=
−
+
+
−




−
M
q
n
n
MK e
T
e
T
q
d
dt
dt
d
dt
ˆ
ˆ
i
d
2
2
1
	
(4.46)
If our models are exact, we have 
=
M
Mˆ  and =
n
nˆ. Then, because the inverse of matrix Mˆ  
exists in general (because the inertia matrix is positive definite), we obtain
	
∫
=
+
−




−
q
K e
T
e
T
q
d
dt
dt
d
dt
i
d
2
2
1
	
(4.47)
Clearly, Equation 4.47 represents a linear, constant parameter system with proportional-
integral-derivative (PID) control. In other words, the controller has linearized the system. 
The proportional control parameters are the elements of the gain matrix K, the integral 
Desired
input
–1
1
+
i
s T
I
K
ˆM
Mechanical
system
(Plant)
e
f0
qd
Linearizing
feedback
Measured
response
Response
q, q
Measured q
n(q, q)
Measured q
Td
Measured q
–
–
–f
Integral
controller
Diagonal
structure
Estimated
inertia
matrix
Derivative
controller
Unknown
forcing
disturbances
Proportional
controller
FIGURE 4.21
The structure of a linearizing feedback control system.

180
Modeling of Dynamic Systems with Engineering Applications
control parameters are the elements of the matrix Ti, and the derivative control parameters 
are the elements of the matrix Td. We are free to select these parameters so as to achieve 
the desired response. In particular, if these three parameter matrices are chosen to be 
diagonal, then the control system, as given by Equation 4.47 and shown in Figure 4.21, are 
uncoupled (i.e., one input affects only one output) and will not have dynamic interactions. In 
summary, this controller can both linearize and decouple the system. Its main drawback is 
that accurate models are needed for the nonlinearities.
Instead of using analytical modeling, the parameters in Mˆ  and nˆ may be obtained through 
the measurement of various input–output pairs. This is the method of model identification, as 
discussed before. Strictly, nonlinear model identification is needed. It can cause further com-
plications in terms of instrumentation and data processing speed, particularly because the 
system is nonlinear and also some of the model parameters must be estimated in real time.
Summary Sheet
Useful Method of Linearization: (1) Slope-based analytical linearization; (2) ­slope-based 
linearization using experimental models; (3) static linearization through recalibration or 
rescaling; (4) linearization based on an equivalent model; (5) describing function method; 
and (6) feedback linearization.
Static Nonlinearity: Nonlinear, algebraic, steady-state, and input–output relation.
Geometric Nonlinearity: Nonlinear trigonometric (kinematic) terms (cos, sine, tan, etc.) 
due to large deflections or large motions of a mechanical device.
Physical Nonlinearity: Nonlinear physical relations (e.g., nonlinear kinetic relations—
Newton’s second law with nonlinear accelerations).
Manifestations of Physical Nonlinearity: Saturation (output remains unchanged when 
the input changes); dead zone (region with no output to an input); hysteresis (a loop in the 
input–output curve); jump phenomenon (frequency response function jumps from one 
value to another at the same frequency); limit cycles (sustained oscillations at a specific 
frequency and amplitude, independent of the initial condition); and frequency creation 
(at steady state creates frequency components not present in the input).
Nonlinear Electrical Elements: Capacitor: =
q
q v
( ); inductor: λ
λ( )
=
i ; and resistor: v = v(i); 
q = charge, λ = flux linkage, v = voltage, i = current.
Steady-state Operating Condition: Rates of changes of system variables are zero. Solve 
the resulting algebraic equations; stable (given a shift, system returns to original state); 
unstable (given a shift, the system continues to move away); and neutral (given a slight 
shift, system remains in the shifted condition).
Slope-based Linearization: For one independent variable, 
=
+
−
≈
f
f x
x
f x
df x
dx
x
ˆ
(
ˆ)
( )
( ) ˆ, 
=
+
−
+
e
f x
x
f x
df x
dx
x
Error  
 (
ˆ)
[ ( )
( ) ˆ]; 
for 
two 
independent 
variables, 
=
f
f
ˆ
 
+
+
−
x
x y
y
f x y
(
ˆ,
ˆ)
( , ) ≈∂
∂
+ ∂
∂
f x y
x
x
f x y
y
y
( , ) ˆ
( , ) ˆ; 

δ
=
=
x
dx
dt
x
ˆ
ˆ, 

δ
=
=
x
d x
dt
x
ˆ
ˆ.
2
2
Slope-based Linearization Procedure: (1) Select operating point (steady state: set time deriv-
atives to zero and solve the nonlinear algebraic equations); (2) determine first-order deriva-
tives of each nonlinear term w.r.t. each independent variable; and (3) replace nonlinear term 
by its slope × incremental variable, and linear term by its coefficient × incremental variable.

181
Model Linearization
Nonlinear State-Space Model: 
…
…
(
)
=
=
dq
dt
f q q
q r r
r t
i
n
,
,
,
, ,
,
,
,
,
1,2,..,
i
i
n
m
1
2
1
2
 or
 =
q
f q r t
( , , ); state vector 
…
= 

q
q q
q
,
,
,
,
n
T
1
2
 input vector 
…
= 

r
r r
r
,
,
,
;
m
T
1
2
 “t” in ­argument 
→ time-variant system.
Linearization:  =
q
0 → f(q, r, t) = 0 → Equilibrium states; incremental state equations: 

δ
∂
∂
δ
∂
∂
δ
=
+
q
q q r t
q
f
r q r
r;
f
t
( , , )
( , , )
 
…
δ
=
= 

q
x
x x
x
,
,
,
,
n
T
1
2
 
…
δ
=
= 

r
u
u u
u
,
,
,
;
m
T
1
2
 
or 
 =
+
x
Ax
Bu with 
∂
∂
( ) =
A
f
q q r
t
t
( , , ) and 
∂
∂
( ) =
B
f
r q r t
t
( , , );
	






























=
∂
∂
∂
∂
∂
∂
∂
∂
∂
∂
∂
∂
∂
∂
∂
∂
∂
∂
























=
∂
∂
∂
∂
∂
∂
∂
∂
∂
∂
∂
∂
























A
B
f
q
f
q
f
q
f
q
f
q
f
q
f
q
f
q
f
q
f
r
f
r
f
r
f
r
f
r
f
r
;
n
n
n
n
n
n
m
m
n
n
m
1
1
1
2
1
2
1
2
2
2
1
2
1
1
1
2
1
2
1
A and B are constant in time-invariant systems.
Mitigation of System Nonlinearities: Calibrate/rescale (e.g., log) the output; use lineariz-
ing elements (e.g., resistors, amplifiers in bridge circuits); use feedback linearization; avoid 
operation over wide input ranges, signal levels, or frequency bands; avoid large defor-
mations (e.g., deviation from Hooke’s law—a physical nonlinearity) or large mechanical 
motions (e.g., trigonometric terms—a geometric or kinematic nonlinearity); minimize 
nonlinear friction (e.g., Coulomb, Stribeck), stiction, wear and tear (e.g., through proper 
lubrication); avoid loose joints, gear coupling, etc. → backlash (e.g., use direct-drive mech-
anisms, harmonic drives, etc.); and minimize sensitivity to undesirable influences (e.g., 
environmental influences such as temperature).
Linearization Using Experimental Data: (1) Determine steady-state characteristic curves 
by varying one independent variable at a time (keeping the other variables constant); (2) 
determine local slopes (with respect to independent variables) of the experimental char-
acteristic curves at operating point; and (3) dynamics (particularly, inertial dynamics) is 
incorporated separately into the model, using analytical terms.
Experimental Linear Model for Motor Control: (1) Determine a set of characteristic 
curves 
ω
=
T
T
v
(
,
)
m
m
m
c  for motor. (2) Draw a tangent to primary curve at operating point 
O. Damping constant 
ω
= −∂
∂
=
b
Tm
m v
 constant
c
 = slope magnitude at O (includes both electro-
magnetic damping and mechanical damping). (3) Draw vertical line through O to intersect 
two adjacent other operating curves. ∆Tm = torque intercept between the two curves, Δvc = 
voltage increment between the two adjacent curves. Voltage gain 
∆
∆
= ∂
∂
=
ω
=
k
T
v
T
v ;
v
m
c
m
c
 constant
m
 
(4) δ
ω
δω
δ
= ∂
∂
+ ∂
∂
ω
T
T
T
v
v
m
m
m v
m
m
c
c
c
m
 → δ
δω
δ
= −
+
T
b
k
v .
m
m
v
c  (5) Linear dynamic model 
δ
δω
δ
= −
+
T
b
k
v ;
m
m
v
c  motor torque = T ,
m  motor speed = ω ,
m  input voltage = vc, moment of 
inertia of motor rotor = J ,
m  and load torque = T .
L

182
Modeling of Dynamic Systems with Engineering Applications
Linearization by Calibration: Example: 
=
y
kepu (nonlinear input u-output y ­relation) → 
=
+
y
pu
k
log( )
log( ) (linear).
Linearization through Energy Equivalence: Example: Nonlinear damper 
 
=
f
cx x
| | → 
equivalent linear damper 

=
f
b x
eq  where 
π
ω
=
b
cx
8
3
eq
0
 (for same energy dissipation in a 
cycle; Note: Dependence on excitation amplitude); f  = damping force, x = relative displace-
ment of damper, x = relative velocity of damper, ω = frequency of oscillation, =
c
 nonlinear 
damping parameter, and beq = equivalent ­linear viscous damping constant.
Describing Function: A frequency-domain equivalent model of a nonlinear system. Uses 
the equivalence criterion: fundamental frequency component in the output. Example: 
Ideal relay =
y
y
u
sgn( )
0
. “sgn” is the signum (sign) function. Output switches between y0 
and −y0 depending on the input sign. Input 
ω
=
u
u
t
sin
0
 → y is a pulse of amplitude y0 and 
same frequency. Describing function 
π
=
N
y
u
4
0
0
 (depends on the input amplitude u0).
Feedback Linearization: Use feedback to remove nonlinear effects in a dynamic system. 
After that, we can effectively use linear techniques for the system. Example: Mechanical 
dynamic system 


( )
(
)
( )
=
+
M q q
n q q
f t
,
, f = vector pf input froces, q = vector of move-
ments at the forcing locations, 
( ) =
M q
inertia matrix, 

(
) =
n q q
,
nonlinear effects. Linearizing 
feedback 
controller: 
∫
=
+
−



−
−
f
MK e
T
e
T
q
n
dt
d
dt
ˆ
ˆ;
i
d
1
 
=
−
=
e
q
q
 error (correction)
d
 
=
q
vector, 
 desired response
d
, Mˆ  = model of M, nˆ = model of n; K, Ti, and Td are proportional, 
integral, derivative control parameter matrices. → 


∫
=
−
+
+
−




−
Mq
n
n
MK e
T
e
T
q
dt
d
dt
ˆ
i
d
1
→ 
∫
=
+
−




−
q
K e
T
e
T
q
d
dt
dt
d
dt
i
d
2
2
1
 (if models are exact—a shortcoming of the method).
Problems
	
4.1	
Read about the following nonlinear phenomena:
	
(i)	 Saturation
	
(ii)	 Hysteresis
	
(iii)	 Jump phenomena
	
(iv)	 Frequency creation
	
(v)	 Limit cycle
	
(vi)	 Deadband
	
Often, the local slopes (derivatives) of a nonlinear function with respect to its inde-
pendent variables are used in linearizing the function. Indicate situations where 
this approach is not appropriate.
	
4.2	 What precautions may be taken in developing and operating a mechanical sys-
tem, in order to reduce system nonlinearities?
	
Two types of nonlinearities are shown in Figure P4.2.
	
In each case, indicate the difficulties of developing an analytical for operation near:

183
Model Linearization
	
(i)	 Point O
	
(ii)	 Point A
	
4.3	 An excitation was applied to a system and its response was observed. Next, the 
excitation was doubled. It was found that the response also doubled as a result. 
Is the system linear? What kind of useful conclusion may be reached from a 
single test of this nature?
	
4.4
	
(a)	 Determine the derivative d
dx x x .
	
(b)	 Determine an expression for the value of each of the following terms at a 
point that is away from the steady-state operating point =
=
x
x
2 by a small 
increment δ
=
x
xˆ:
	

( )
( )
( )
x
x
x
i 3
ii
iii
3
2
	
4.5	 A nonlinear device obeys the relationship y = y(u) and has an operating curve 
(characteristic curve) as shown in Figure P4.5.
	
(i)	 Is this device a dynamic system?
	
A linear model of the form y = ku is to be determined for operation of the device:
	
(ii)	 In a small neighborhood of point B
	
(iii)	 Over the entire range from A to B
	
	
Suggest a suitable value for k in each case.
	
4.6	 A nonlinear damper is connected to a mechanical system as shown in Figure 
P4.6. The force f, which is exerted by the damper on the system, is 
−
c v
v
(
)
2
1
2 
where c is a constant parameter.
	
(i)	 Give an analytical expression for f in terms of v1, v2, and c, which will be 
generally valid.
	
(ii)	 Give an appropriate linear model.
	
(iii)	 If the operating velocities v1 and v2 are equal, what will be the linear model 
about (in the neighborhood of) this operating point?
Device output
Device input
(b)
O
A
Device input
Device
output
O
A
(a)
FIGURE P4.2
Two types of nonlinearities: (a) Ideal saturation and (b) hysteresis.

184
Modeling of Dynamic Systems with Engineering Applications
	
4.7	
Suppose that a system is in equilibrium under the forces Fi and Fo, as shown in 
Figure P4.7. If the point of application of Fi is given a small “virtual” displace-
ment x in the same direction as the force, suppose that the location of Fo moves 
through y = k x in the direction opposite to Fo.
	
(i)	 Determine Fo in terms of Fi (This is based on the “principle of virtual 
work”).
	
(ii)	 What is the relationship between the small changes Fˆi and Fˆ ,
o  about the 
operating conditions Fi and Fo, assuming that the system is in equilibrium?
	
4.8	 A simplified model of an elevator is shown in Figure P4.8.
	
The model parameters are:
J = moment of inertia of the cable pulley
r = radius of the pulley
k = stiffness of the cable
m = mass of the car and its occupants
	
(a)	 Which system parameters are variable? Explain.
	
(b)	 Suppose that the damping torque 
ω
T ( )
d
 at the bearing of the pulley is a 
nonlinear function of the angular speed ω of the pulley. Let:
State vector 
ω
= 

x
f
v
T, with
f = tension force in the cable
f
Nonlinear
(quadratic) 
damper
System
v1
v2
FIGURE P4.6
A nonlinear mechanical system.
B
Input
Output
A
0
FIGURE P4.5
The characteristic curve of a nonlinear device.

185
Model Linearization
v = velocity of the car (taken positive upwards),
	
	
Input vector =
u
T
[
]
m , with
Tm = torque applied by the motor to the pulley
(positive in the direction indicated in Figure 3.6)
	
	
Output vector y = [v]
	
	
Obtain a complete, nonlinear, state-space model for the system.
	
(c)	 With Tm as the input and v as the output, convert the state-space model into 
a nonlinear input–output differential equation model. What is the order of 
the system?
System
in equilibrium
Fo
Fi
x
FIGURE P4.7
Virtual displacement of a system in equilibrium.
v
f
Cable
k
Car
m
Pulley
J
Tm
Td
r
ω
Drive
motor
FIGURE P4.8
A simplified model of an elevator.

186
Modeling of Dynamic Systems with Engineering Applications
	
(d)	
Give an equation whose solution provides the steady-state operating speed v 
of the elevator car.
	
(e)	
Linearize the nonlinear input–output differential-equation model obtained in 
Part (c) for small changes Tˆm of the input and vˆ of the output, about an operating 
point.
	
	
Note: Tm = steady-state operating-point torque of the motor (known).
	
	
Hint: Denote ω
dT
d
d  by b(ω).
	
(f)	
Linearize the state-space model obtained in Part (b) and give the model matri-
ces A, B, C, and D in the usual notation. Obtain the linear input–output dif-
ferential equation from this state-space model and verify that it is identical to 
what was obtained in Part (e).
	
4.9	
A rocket-propelled spacecraft of mass m is fired vertically up (in the y-direction) 
from the earth’s surface (see Figure P4.9). The vertical distance of the centroid of 
the spacecraft, measured from the earth’s surface, is denoted by y. The upward 
thrust force of the rocket is f(t). The gravitational pull on the spacecraft is given 
by 
+




mg
R
R
y
2
, where g is the acceleration due to gravity at the earth’s surface 
and R is the “average” radius of earth (about 6370 km). The magnitude of the 
aerodynamic drag force resisting the motion of the spacecraft is approximated 
by 
−
ky e y r
2
 where k and r are positive and constant parameters and  =
y
dy
dt
. Here, 
the exponential term represents the loss of air density at higher elevations.
	
(a)	
Treating f as the input and y as the output, derive the input–output differential 
equation for the system.
	
(b)	
The spacecraft accelerates to a height of yo and then maintains a constant speed 
vo, still moving in the same vertical (Y) direction. Determine an expression 
Horizontal on earth’s surface
Vertical 
direction
Y
X
Rocket 
thrust f(t)
Spacecraft
mass m
(X, Y)
FIGURE P4.9
Coordinate system for the spacecraft problem.

187
Model Linearization
for the rocket force that is need for this constant-speed motion. Express your 
answer in terms of yo, vo, time t, and the system parameters m, g, R, r, and k. 
Show that this force decreases as the spacecraft ascends.
	
(c)	
Linearize the input–output model (Part (a)) about the steady operating condi-
tion (part (b)), for small variations yˆ yand yˆ in the position and speed of the 
spacecraft, due to a force disturbance f t
ˆ( ).
	
(d)	
Treating y and y as state variables and y as the output, derive a complete 
(nonlinear) state-space model for the vertical dynamics of the spacecraft.
	
(e)	
Linearize the state-space model in (d) about the steady conditions in (b) for 
small variations yˆ and yˆ in the position and speed of the spacecraft, due to 
force disturbance f t
ˆ( ).
	
(f)	
From the linear state model (Part (e)) derive the linear input–output model and 
show that the result is identical to what you obtained in Part (c).
	
(g)	
Solve this problem by using the systematic unified approach (where across-
variables of independent A-type elements and through-variables of the inde-
pendent T-type variables are used as the state variables.
	
4.10	 Characteristic curves of an armature-controlled dc motor are as shown in Figure 
P4.10. These are torque versus speed curves, measured at a constant armature 
voltage, at steady state. For the neighborhood of point P, a linear model of the 
form ω =
ˆ
 
+
k v
k T
ˆ
ˆ
1
2  needs to be determined, for use in motor control. The follow-
ing information is given:
	
The slope of the curve at P = −a
	
The voltage change in the two adjacent curves at point P = ΔV
	
Corresponding speed change (at constant load torque through P) = Δω.
	
Estimate the parameters k1 and k2.
	
4.11	 An air circulation fan system of a building is shown in Figure P4.11a, and a sim-
plified model of the system may be developed, as represented in Figure P4.11b.
	
The induction motor is represented as a torque source τ(t). The speed ω of the fan, 
which determines the volume flow rate of air, is of interest. The moment of inertia of 
the fan impeller is J. The energy dissipation in the fan is modeled as a linear viscous 
damping component (of damping constant b) and a quadratic aerodynamic damp-
ing component (of coefficient d).
Speed ω
Load
torque
T
Curves at constant 
armature voltage
P
V
V + ∆V
∆ω
FIGURE P4.10
Characteristic curves of an armature-controlled dc motor.

188
Modeling of Dynamic Systems with Engineering Applications
	
(a)	
Show that the system equation may be given by
	
ω
ω
ω ω
τ
+
+
=
J
b
d
t( )
	
(b)	
Suppose that the motor torque is given by
	
τ
τ
τ
Ω
=
+
t
t
( )
ˆ sin
a
	
	
in which τ  is the steady torque and τˆa is a very small amplitude (compared to 
τ ) of the torque fluctuations at frequency Ω. Determine the steady-state operat-
ing speed ω (which is assumed positive) of the fan.
	
(c)	
Linearize the model about the steady-state operating conditions and express it 
in terms of the speed fluctuations ωˆ. From this, estimate the amplitude of the 
speed fluctuations.
	
4.12	 Consider the double pendulum (or a two-link robot arm with revolute joints) 
having link lengths l1 and l2, and the end masses m1 and m2, as shown in 
Figure  P4.12.Obtain the equations of motion for this nonlinear mechani-
cal system in terms of the absolute angles of swing θ1 and θ2 about the verti-
cal equilibrium configuration. Linearize the equations for small motions of 


θ θ θ
θ
,
,
and 
1
1
2
2.
	
Note: This is an example of geometric nonlinearity.
	
4.13
(a)
(b)
Fan
Air in
Speed ω
Induction
motor
Air
out
Impeller
inertia
J
Motor torque
ω
τ (t)
FIGURE P4.11
(a) A motor-fan combination of a building ventilation system and (b) a simplified model of the ventilation fan.

189
Model Linearization
	
(a)	
Linearized models of nonlinear systems are commonly used in model-based 
control of processes. What is a primary assumption that is made in using a 
linearized model to represent a nonlinear system?
	
(b)	
A three-phase induction motor is used to drive a centrifugal pump for incom-
pressible fluids. To reduce misalignment and associated problems such as 
vibration, noise, and wear, a flexible coupling is used for connecting the motor 
shaft to the pump shaft. A schematic representation of the system is shown in 
Figure P4.13.
Assume that the motor is a “torque source” of torque Tm, which is being 
applied to the motor of rotor inertia Jm. Also, the following variables and 
parameters are defined for the system:
Jp = moment of inertia of the pump impeller assembly
Ωm = angular speed of the motor rotor and shaft
Ωp = angular speed of the pump impeller and shaft
m1
l1
l2
m2
θ1
θ2
FIGURE P4.12
A double pendulum (robot arm with revolute joints).
Flow out
Q = VpΩp
Flow in
Flexible
coupling
Induction
motor
Centrifugal
pump
Jm, bm
Jp
bp
k
Ωm
Ωp
FIGURE P4.13
A centrifugal pump driven by an inductor motor.

190
Modeling of Dynamic Systems with Engineering Applications
k = torsional stiffness of the flexible coupling
Tf = torque transmitted through the flexible coupling
Q = volume flow rate of the pump
bm = equivalent viscous damping constant of the motor rotor
Also, assume that the net torque required at the ump shaft, to pump fluid steadily 
at a volume flow rate Q, is given by Ω
bp
p, where
	
Ω
=
Q
Vp
p
and Vp = volumetric parameter of the pump (assumed constant).
Using Tm as the input and Q as the output of the system, develop a complete 
state-space model for the system. Identify the model matrices A, B, C, and D in 
the usual notation, in this model. What is the order of the system?
	
(c)	
In Part (a) suppose that the motor torque is given by 
=
+


T
aSV
S S
1
(
)
m
f
b
2
2
where the fractional slip S of the motor is defined as 
Ω
Ω
=
−
S
1
m
s
Note that a and Sb are constant parameters of the motor. Also
Ωs = no-load (i.e., synchronous) speed of the motor
Vf = amplitude of the voltage applied to each phase winding (field) of the motor
In voltage control Vf is the input, and in frequency control Ωs is the input. For com-
bined voltage control and frequency control, derive a linearized state-space 
model, using the incremental variables 
Ω
V  and 
f
s, about the operating values 
Ω
V  and 
f
s, as the inputs to the system, and the incremental flow Qˆ as the output.
	
4.14	 A system that is used to pump an incompressible fluid from a reservoir into 
an open overhead tank is schematically shown in Figure P4.14. The tank has a 
uniform across section of area A.
The pump is considered as a pressure source of pressure difference P(t). A 
valve of constant kv is placed near the pump in the long pipe line, which leads 
to the overhead tank. The valve equation is 
=
−
Q
k
P
P
v
1
2  in which Q is the 
volume flow rate of the fluid. The resistance to the fluid flow in the pipe may be 
modeled as 
=
−
Q
k
P
P
p
2
3  in which kp is a pipe flow constant. The effect of the 
accelerating fluid is represented by the linear equation 
=
−
I dQ
dt
P
P
3
4 in which I 
denotes the fluid inertance. Pressures P1, P2, P3, and P4 are as marked along the 
pipe length, in Figure P4.14. Also, P0 denotes the ambient pressure.
	
(i)	
Using Q and P40 as the state variables, the pump pressure P(t) as the input vari-
able, and the fluid level H in the tank as the output variable, obtain a complete 
(nonlinear) state-space model for the system. Note: P40 = P4 − P0. Mass density of 
the fluid = ρ.
	
(ii)	
Lienarize the state equations about an operating point given by flow rate Q. 
Determine the model matrices A, B, C, and D for the linear model.
	
(iii)	
What is the combined linear resistance of the valve and the piping?

191
Model Linearization
	
4.15	 (a) A local water storage tank with internal radius R at its base is shown in 
Figure P4.15a. The inclination of the tank wall (with respect to the base) is θ. The 
outlet valve is closed and the inlet valve provides an inflow at the volumetric 
rate Q. At a given instant, the water level in the tank is h. Obtain an expression 
for the fluid capacitance C f at that instant, in terms of h, R, θ, mass density ρ of 
water, and acceleration due to gravity (g).
Note: C f varies with h.
Hint: Gauge pressure (w.r.t the atmosphere pressure) of water at the tank base 
ρ
=
P
gh.
Let r = radius of the water surface (at height h)
If a water volume (incremental) δV enters the tank, the water level will rise by δh. 
Then, δ
π
δ
=
⋅
V
r
h
2
Divide throughout by the incremental time δt
Tank
cross-sectionA
H
P(t)
+
Q
P1
kv
P2
kp
P3
I
P4
P0
P0
FIGURE P4.14
A pumping system for an overhead tank.
(a)  
Q
θ
R
h
Closed
(b)  
Q
R
h
Closed
FIGURE P4.15
(a) Conical water tank with water level h and (b) cylindrical water tank with water level h.

192
Modeling of Dynamic Systems with Engineering Applications
	
δ
δ
π
δ
δ
π
⇒
=
⇒
=
V
t
r
h
t
dV
dt
r dh
dt
2
2
	
(b)	
From your result, show that for a cylindrical tank (i.e., θ
π
= 2 ) of con-
stant X-sectional radius R (see Figure P4.15b), we have the standard result 
π
ρ
ρ
=
=
=
C
R
g
A
g
constant
f
2
	
	
Note: A = constant area of X-section of the tank.
	
4.16	 Suppose that the volume V of a fluid is a nonlinear function V P
( ) of its pressure 
P. Show that its fluid capacitance C f is given by 
=
C
dV
dP
f
, which itself is a func-
tion of P.
Using this expression, verify the result obtained in Problem 4.15.
	
4.17	 Figure P4.17a shows a liquid pump driven by a dc motor through a flexible 
shaft. The moment of inertia of the motor rotor is J and the torsional stiffness of 
the flexible shaft is K. The torque T generated by the motor is a function of its 
speed Ω and the input voltage V. The steady-state characteristics of the motor, 
measured at the motor output shaft as curves of 
Ω
T
V
(
, ) with respect to Ω for 
different constant values of V, are shown in Figure P4.17b. The speed of the 
pump is Ωp. The load torque of the pump varies quadratically with the speed, 
and is given by ΩΩ
d
p
p, where d is a pump constant. The loading on the system 
is shown in Figure P4.17c.
	
Note: Take the output of the system as Ωp.
	
(a)	
Show that the constitutive equations of the system are
	
Ω
Ω
Ω
Ω
ΩΩ
=
−
=
−
=
J
d
dt
T
V
T
dT
dt
K
T
d
Motor Rotor:       
(
, )
Flexible Shaft:   
(
)
Pump:                
M
K
K
p
p
p
p
and the node equation at the shaft-pump joint is: 
−
=
T
T
0
K
p
where 
=
T
torque in the flexible shaft
K
; 
=
T
drive torque of the pump
p
.
	
(b)	
Linearize the system about the steady-state operating point: Ω= 300 rpm
o
 and Vo 
= 18 V, and determine the elements of the corresponding matrices A, B, C, and D.
	
	
Note: First, express the matrix elements in terms of the given parameters (i.e., 
their symbols) and then compute their numerical values using the parameter 
values.
	
	
Given: =
⋅
=
⋅
=
⋅
J
K
d
0.005 kg m ,
10.0N m/rad,
5.0 N m/rad /s
2
2
2
	
	
Incremental variables for the linear model are denoted as: 
	
δΩ
ω
δ
τ
δ
δΩ
ω
=
=
=
T
V
v
 = 
,
,
,
K
K
p
p

193
Model Linearization
State vector: 
ω τ
= 

x
,
K
T; Input vector: 
ν
=
u
[ ], which is a scalar; and
Output vector: 
ω
=
u
[
]
p , which is a scalar. 
	
4.18	 An electromechanical motion system is sketched in Figure P4.18a. It consists of 
an armature-controlled dc motor, which drives a load of moment of inertia JL 
through a flexible shaft of torsional stiffness kL. The shaft that carries the load 
has a set of bearings, which also provides damping, assumed to be linear vis-
cous with the overall damping constant bL. The moment of inertia of the motor 
(a)
dc motor
Flexible shaft
Liquid out
Liquid in
Pump
(b)
0
20
60
80
100
120
140
160
150
300
450
600
40
Speed Ω (rpm)
Torque T (N.m)
Input
Voltage
o t
p
g
V l
(c)  
T
Motor rotor
TK
K
Flexible shaft
Pump
d Ωp Ωp
Ωp
Ω
FIGURE P4.17
(a) Schematic diagram of a dc motor-driven pump; (b) steady-state torque versus speed characteristics of the 
motor; and (c) loading on the system.

194
Modeling of Dynamic Systems with Engineering Applications
rotor is JM. The torque T generated by the motor is a function of its speed Ω 
and the input armature voltage V. The steady-state characteristics of the motor, 
measured at the motor output shaft as curves of 
Ω
T
V
(
, ) versus Ω for different 
constant values of V, are shown in Figure P4.18b. The speed of the load is ΩL.
	
(a)	
Determine a state-space model for the system.
	
(b)	
Linearize the system about the steady-state operating point: Ω= 1000  rpm
o
 and 
Vo = 16 V and express the corresponding matrices: A and B. Give the numerical 
values of the elements of these matrices.
Given: JM = 0.005kg · m2,  JL = 0.010kg · m2,  KL = 10.0N · m/rad,  bL = 1.0N · m/rad/s 
Incremental variables in the linear model are: δΩω δΩ
ω
δ
τ
δ
=
=
=
T
V
v
=
,
,
,
L
L
K
K
State vector: 
ω ω
τ
= 

x
,
,
L
K
T
Input vector: 
ν
=
u
[ ], which is a scalar
	
4.19	 A thermistor (a semiconductor-based temperature sensor) is modeled as
	
β
=
−










R
R
T
T
exp
1
1
o
o
	
where
R = resistance of the thermistor at temperature T; and To, Ro and β are model 
parameters, whose values are known.
(a)
Jm
T
Armature
voltage
V
Motor rotor
JL
TK
kL
Flexible shaft
Load inertia
Load
bearing
Load
bearing
bL
(b)
0
10
30
40
50
60
70
80
500
1000
1500
2000
20
Speed Ω (rpm)
Torque T (N.m)
Ω
ΩL

195
Model Linearization
Typically, the resistance R is measured and from it the corresponding tem-
perature T is computed using the model (or read using a calibration curve).
	
(a)	
What is the input and what is the output of this model? Justify your answer.
	
(b)	
Is this a static model or a dynamic model? Justify your answer.
	
(c)	
What do the model parameters To and Ro represent? Explain.
	
(d)	
By determining the derivative of the expression on the right-hand side of the 
model equation, determine a linear model about some operating point (
)
T R
,
. 
Use the incremental variables Tˆ and Rˆ  to express your linear model.
	
(e)	
Typically, the linearized model is valid only over a small range about the oper-
ating point. Suggest another method to linearize the given thermistor model 
so that it will be accurate for any value of T and R.
Hint: 
=
d e
dx
ae
(
)
ax
ax
	
4.20	 List several response characteristics of nonlinear systems that are not exhibited 
by linear systems in general.
	
Determine the response y of the nonlinear system 
( )




=
dy
dt
u t
1/3
	
when excited by the input 
ω
ω
( ) =
+
u t
a
t
a
t
sin
sin
1
1
2
2 .
	
What characteristic of a nonlinear system does this result illustrate?
	
4.21	 A mechanical component, whose response is x, is governed by the relationship
	

(
)
=
f
f x x
,
where f denotes the applied (input) force and x denotes the velocity response 
(output). Consider the following four special cases:
	
(a)  Linear spring: 
=
f
kx
	
(b)  Viscous damper: 

=
f
bx
	
(c)  Linear spring with a viscous damper: 

=
+
f
kx
bx
	
(d)  Linear spring with Coulomb friction: 

=
+
f
kx
f
x
sgn( )
c
	
Suppose that a harmonic excitation of the form 
ω
=
f
f
t
sin
o
 is applied in each case. 
Sketch the force-displacement curves for the four cases at steady state. Which com-
ponents exhibit hysteresis? Which components are nonlinear? Discuss your answers.
	
4.22	 Consider Coulomb friction-type damper model given by 

=
f
f
x
sgn( )
c
 where
	
f  = damping force
	
x = relative displacement of the damper
	
x = relative velocity of the damper
	
fc = magnitude (constant) of the damping force
	
Suppose that the harmonic force 
ω
=
f
f
t
sin
0
 is applied to the damper. At steady 
state, take the harmonic component (dominant component) of the displacement x a
	
ω
φ
=
+
x
x sin(
t
)
0

196
Modeling of Dynamic Systems with Engineering Applications
(a)  Determine the energy dissipation of the Coulomb damper in one cycle 
of motion (i.e., in the period 
π ω
=
T
2 / ). Express your result in terms of 
ω
f
x
,
and
c
0
 (as necessary).
	(b)  Now consider the linear viscous damper model given by 

=
f
bx where 
=
b
 viscous damping coefficient. Following the same procedure as for the 
Coulomb damper, determine the energy dissipation in one cycle of motion 
of the linear damper. Express your result in terms of 
ω
b x
,
and
0
.
	(c)  From the two results, give an equivalent linear viscous damping coefficient 
beq that results in the same energy dissipation per cycle as for the nonlinear 
damper. Express your result in terms of f
x
,
c
0 and ω.
	(d)  Comment on the limitations in the use of this method of linearization.
	
4.23	 The input–output behavior of a relay (two-state switching function) with 
­hysteresis is shown in Figure P4.23. Specifically, consider a sinusoidal input, 
given by 
ω
=
u
u
t
sin
0
.
	
u0 = amplitude of the input
	
ω = frequency of the input
	
y0 = amplitude of the output
h = hysteresis threshold at the input
	
Determine a describing function for this nonlinearity.
	
4.24	 Discuss why feedback linearization could be very useful in controlling com-
plex mechanical systems with nonlinear and coupled dynamics. What are the 
shortcomings of linearizing feedback control?
	
Consider the two-link manipulator that carries a point load (weight W) at the end 
effector, as shown in Figure P4.24. Its dynamics can be expressed as: 
τ
Iq
b
+
=
y
0
u
0
Time t
Output y
h
u0
Input u
–y0
–h
h
y0
0
π
ω
2π
ω
Time t
+
π
ω
φ
φ
φ
+
3π
ω +φ
π
ω
2π
ω
3π
ω
φ
FIGURE P4.23
The output of a relay with hysteresis for a sine input.

197
Model Linearization
where
q = vector of (relative rotations) q1 and q2
τ = vector of drive torques τ1 and τ2 at the two joints, corresponding to the coordi-
nates q1 and q2
I = second-order inertia matrix = 








I
I
I
I
11
12
21
22
b = vector of joint-friction, gravitational, centrifugal, and Coriolis torques (compo-
nents are b1 and b2)
	
Neglecting joint friction, and with zero payload (W = 0), we can write the following 
expressions for the model parameters:
ℓ
ℓ
ℓ
ℓ

ℓ
 
ℓ

(
)
(
)
(
)
=
+
+
+
+
+
=
+
+
+
=
+
=
+
+
+

−
−
=
+
+
I
m d
I
I
m
d
d
d
q
I
I
I
m d
m d
q
I
I
m d
b
m gd
q
m g d
q
d
q
q
m
d q
q
m
d q q
q
b
m gd
q
q
m
d q
q
cos
cos
cos
cos
cos
sin
2
sin
cos
sin
11
1
1
2
1
2
2
1
2
2
2
1
2
2
12
21
2
2
2
2
2
2
2
22
2
2
2
2
1
1
1
1
2
1
1
2
1
2
2
1
2
2
2
2
2
1
2 1 2
2
2
2
2
1
2
2
1
2 1
2
2
x
y
q1
q2
m2g
m1g
W
Payload
End
effector
I2
I1
d1
l2
d2
l1
FIGURE P4.24
A two-link robotic manipulator.

198
Modeling of Dynamic Systems with Engineering Applications
	
=
=
I
I
m
m
where ,
 moments of inertia of the links about their centroids
,
 masses of the links
1
2
1
2
The geometric parameters ℓ
ℓ
d
d
,
,
, and 
1
2
1
2 are as defined in Figure P4.24.
What variables have to be measured for linearizing feedback control? Noting that the ele-
ments of b are more complex (even after neglecting joint friction, backlash, and payload) 
than the elements of I, justify using linearizing feedback control for this system, which 
uses both a nonlinear model and on-line measurements.

199
5
Linear Graphs
Chapter Highlights
•	 Benefits of Linear Graphs (LGs)
•	 Sign Conventions
•	 Use of Through- and Across-variables
•	 Action and Reference Points of a Branch
•	 Linear-graph Elements (A-type, T-type, and D-type)
•	 Sources (A-source and T-source)
•	 Multi-port Elements (Transformer and Gyrator)
•	 LG Topological Relation
•	 LG Solvability
•	 State Model Development (Constitutive, Node, and Loop Equations)
•	 Examples in Mechanical, Electrical, Fluid, Thermal, and Mixed Domains
5.1  Introduction
In the previous chapters, we presented a systematic, unified, and integrated approach 
for developing an analytical model, particularly a state-space model, of an engineering 
dynamic system. A starting step of that approach involves sketching a structural diagram 
(e.g., circuit diagram, schematic diagram, or free-body diagrams) of the system to show 
how the elements or components of the system are interconnected. Such a graphical rep-
resentation can immensely facilitate the process of model formulation. We assert that the 
particular graphical approach also should be:
•	 Systematic
•	 Consistent with the modeling approach (e.g., should be unified and integrated)
There are several graphical approaches for representing the structure of a lumped-param-
eter analytical model of an engineering dynamic system. Leading among them are:
•	 Linear graphs
•	 Bond graphs

200
Modeling of Dynamic Systems with Engineering Applications
The present chapter presents the approach of linear graphs. Appendix B presents the 
approach of bond graphs. The focus of Chapters 5, 6, and 7 is on linear graphs in view of 
the advantages of the approach, as highlighted in the book. More advanced concepts and 
material on linear graphs is found under graph trees, in Appendix C.
State-space models of lumped-parameter dynamic systems, regardless of whether they 
are mechanical, electrical, fluid, thermal, or multidomain (mixed), can be conveniently 
developed by linear graphs (LGs). In other words, linear graphs support the multidomain, 
“unified” (or analogous) and “integrated” (or concurrent) approach of model develop-
ment, as presented in Chapter 3. Interconnected line segments (called branches) connected 
at nodes, are used in a linear graph to represent a dynamic model. In this regard, LGs 
have the particular advantage that the model structure is analogous across domains. For 
example, two electrical components (say, an inductor and a resistor) connected in parallel 
and two analogous mechanical components (a spring and a damper) connected in parallel 
are represented by similar linear graphs (i.e., two branches in parallel). The term “linear 
graph” stems from this use of “line” segments, and does not mean that the system itself 
has to be linear.
Note: Nonlinear models can be represented by linear graphs.
Particular characteristics and advantages of linear graphs in model development and 
representation include the following:
•	 Applicable for lumped-parameter engineering dynamic systems.
•	 Line segments (branches) are used to represent model elements.
•	 By interconnecting branches at “nodes,” an LG provides a graphical representation of 
a model (it allows visualization of the system structure prior to model formulation).
•	 LGs facilitate an integrated (i.e., concurrent è all physical domains can be represented 
in a single LG and analyzed together) methodology for multidomain systems.
•	 LGs facilitate a unified (i.e., analogous methodology is used in multiple domains) 
modeling approach.
•	 The model structure is retained across domains (i.e., interconnected compo-
nents in one domain and similarly interconnected analogous elements in another 
domain have the same LG).
•	 LGs help identify similarities (in domain, structure, behavior, etc.) in systems.
•	 LGs facilitate the development of computer-based modeling tools and software 
(systematic, unified, integrated, graphical).
•	 A different treatment is not needed when modeling multi-functional devices (e.g., 
a piezoelectric device, which can function as both a sensor and an actuator, can be 
represented simply by a reversible source).
This chapter presents the use of linear graphs in the development of analytical models (par-
ticularly, state-space models) for mechanical, electrical, fluid, thermal, and mixed systems.
5.2  Variables and Sign Conventions
Linear graphs systematically use through-variables and across-variables in providing a 
unified approach for the modeling of dynamic systems in multiple domains (mechanical, 

201
Linear Graphs
electrical, fluid, thermal, and any mixture of these). In accomplishing this objective it is 
important to adhere to standard and uniform conventions so that that there will be no 
ambiguities in a given linear-graph representation. In particular, a standard sign conven-
tion must be established. These issues are discussed in the present section.
5.2.1  Through-Variables and Across-Variables
Each branch (a line segment) in the linear graph model has one through-variable (f) and 
one across-variable (v) associated with it. Typically, their product is the power variable. 
For instance, in a hydraulic or pneumatic system, a pressure “across” an element causes 
some change of fluid flow “through” the element. The across-variable is the pressure, 
the through-variable is the flow. The ordered variable pair (f, v) of the branch should be 
marked on one side of the branch. Table 5.1 lists the through- and across-variable pairs for 
the four domains that are considered in the present treatment.
Sign Conventions
Reference Point and Action Point: Consider Figure 5.1, where a general basic element 
(strictly, a single-port element, as will be discussed later) of a “mechanical” dynamic sys-
tem is shown. In the linear-graph representation, as shown in Figure 5.1b, the element is 
drawn as a branch (i.e., a line segment). One end of the branch is selected as the point of 
reference and the other end automatically becomes the point of action (see Figure 5.1a and c). 
The choice is somewhat arbitrary in many situations. However, it may reflect how other 
TABLE 5.1
Through- and Across-Variable Pairs in Several Domains
System Type (Domain)
Through-Variable
Across-Variable
Hydraulic/Pneumatic
Flow Rate
Pressure
Electrical
Current
Voltage
Mechanical
Force/Torque
Velocity/Angular Velocity
Thermal
Heat-Transfer Rate
Temperature
Element
1
2
f
f
v1
v2
v = v2 – v1
Point of action
(power in)
Point of reference
(power out)
Energy stored
or dissipated
(a)
f, v
1
2
(b)
v1
v2
v = v2 – v1
Element
1
2
f
f
(c)
FIGURE 5.1
Sign convention for a linear graph: (a) A basic (mechanical) element and positive directions of its variables; (b) 
linear-graph branch of the element; and (c) an alternative sign convention.

202
Modeling of Dynamic Systems with Engineering Applications
elements are connected to the particular element and the physics of the actual system 
(Note: For an inertia element, the point of reference is always the ground—the inertial 
reference).
An oriented branch is one to which a direction is assigned, using an arrowhead, as in 
Figure 5.1b. The arrowhead denotes the positive direction of power flow at each end of 
the element. By convention, the positive direction of power is taken as “into” the ele-
ment at the point of action, and “out of” the element at the point of reference. According 
to this convention, the arrowhead of a branch is always pointed from the point of action 
toward the point of reference. Then, the arrowhead also represents the direction of the 
“drop of the across-variable.” In this manner the point of reference and the point of 
action are easily identified. (Note: There is an exception—the T-source, as will be dis-
cussed later).
Figure 5.1 specifically concerns a mechanical element for the following reason. The 
through-variable “force” at the point of action is applied in the direction of the “veloc-
ity” (across-variable) so that their product, power, is going into the element at that point. 
At the point of reference, the force on the element is in fact the “reaction” from the 
elements to which this element is connected there. Hence, at the point of reference, 
the force is in the direction opposite to the velocity so that the power is coming out 
of the element (positive) at that point. For an electrical element, the through-variable is 
the current. At the point of action, the current flows into the element and at the point 
of reference the current flows out of the element. Hence, current, unlike force, has to be 
marked in the same direction at the point of reference, so that the power (the product 
of current and voltage), is coming out at the point of reference (positive) just like in a 
mechanical element.
Through-variable and Across-variables: The through-variable f and the across-variable 
v are indicated as an ordered pair (f, v) on one side of the branch, as in Figure 5.1b. The 
across-variable of a branch is always given relative to the point of reference. The relation-
ship between f and v (the constitutive relation or physical relation, as discussed in Chapters 2 
and 3) can be linear or nonlinear. The parameter of the element (e.g., mass, capacitance) is 
shown on the other side of the branch. It should be noted that the direction of a branch 
does not represent the positive direction of f or v. For example, when the positive directions 
of both f and v are reversed, as in Figure 5.1a and c, the linear graph remains unchanged, as 
in Figure 5.1b, because the positive direction of power flow is unchanged. In a given prob-
lem, the positive direction of any one of the two variables f and v should be pre-established 
for each branch. Then the corresponding positive direction of the other variable is auto-
matically determined by the convention used to orient linear graphs. It is customary to 
assign the same positive direction for f (and v) and the power flow in at the point of action 
(i.e., the convention shown in Figure 5.1a, not Figure 5.1c, is customary). Based on that, the 
positive directions of the variables at the point of reference are automatically established 
(because the power flows out there).
Note: In a branch (line segment), the through-variable (f) is transmitted through the ele-
ment with no change in value. The absolute value of the across-variable, however, changes 
across the element (from v2 to v1, in Figure 5.1a). However, it is this change ( =
−
v
v
v
2
1) 
across the element (i.e., the value at the point of action with respect to that at the point of 
reference) that is called the across-variable. For example, v2 and v1 may represent electric 
potentials at the two ends of an electric element (e.g., a resistor) and then v represents the 
voltage across the element. In other words, the across-variable is measured relative to the 
point of reference of the particular element. The special case is an inertia (mass) element, 
whose point of reference is always the inertial reference (where 
=
v
0
1
).

203
Linear Graphs
Note: Since the absolute value of the across-variable drops from the point of action to the 
point of reference, it should be clear that the arrow also indicates the direction of “drop” 
in the across-variable. There is an exception to this convention, in the case of T-source, as 
discussed later.
According to the sign convention shown in Figure 5.1, the work done (by an external 
device) on the element at the point of action is positive (i.e., power flows in there), and the 
work done (on an external load or environment) by the element at the point of reference is 
positive (i.e., power flows out there). The difference of the work done on the element and 
the work done by the element (i.e., the difference in the work flow at the point of action 
and the point of reference) is either stored as energy (e.g., kinetic energy of a mass; poten-
tial energy of a spring; electrostatic energy of a capacitor; electromagnetic energy of an 
inductor—see Chapter 2), which has the capacity to do additional work; or dissipated (e.g., 
mechanical damper; electrical resistor) through various mechanisms that are manifested 
as heat transfer, noise, and other phenomena. In summary
•	 An element (a single-port element) is represented by a line segment (branch). One 
end is the point of action and the other end is the point of reference.
•	 The through-variable f is the same at the point of action and the point of reference 
of an element; the across-variable differs, and it is this difference (value relative to 
the point of reference) that is called the across-variable v.
•	 The variable pair (f, v) of the element is shown on one side of the branch. Their 
relationship (constitutive relation) can be linear or nonlinear. The parameter of the 
element is shown on the other side of the branch.
•	 Generally, power flow p is the product of the through-variable and the across-
variable. By convention, at the point of action, f and p (power flow in) are taken to 
be positive in the same direction; at the point of reference, f is positive in the direc-
tion corresponding to power flowing out of the element.
•	 The positive direction of power flow p (or energy or work) is into the element at the 
point of action; and out of the element at the point of reference. This direction is 
shown by an arrow on the linear-graph branch (an oriented branch).
•	 The difference in the energy flows at the two ends of the element is either stored 
(with capacity to do further work) or dissipated, depending on the element type.
Linear-graph representation is particularly useful in understanding the rates of energy 
transfer (power) associated with various phenomena. In particular, dynamic interactions 
in a physical system (mechanical, electrical, fluid, etc.) can be interpreted in terms of power 
transfer. Power is the product of a through-variable (a generalized force or current) and 
the corresponding across-variable (a generalized velocity or voltage). For example, con-
sider a mechanical system. The total work done on the system is, in part, used as stored 
energy (kinetic and potential) and the remainder is dissipated. Stored energy can be com-
pletely recovered when the system is brought back to its original state (i.e., when the cycle 
is completed). Such a process is said to be reversible. On the other hand, dissipation corre-
sponds to irreversible energy transfer, which cannot be recovered by returning the system 
to its initial state. (A fraction of the mechanical energy that is lost in dissipation could be 
recovered, in principle, by operating a heat engine, but we shall not go into these thermo-
dynamic details, which are beyond the present scope). Energy dissipation may appear 
in many forms, including temperature rise (a molecular phenomenon), noise (an acoustic 
phenomenon), or work used up in wear mechanisms.

204
Modeling of Dynamic Systems with Engineering Applications
5.3  Linear-Graph Elements
Many types of basic elements exist, which can be used in the development of a linear 
graph for a dynamic system. In this section, we discuss two types of basic elements under 
the categories of single-port elements and two-port elements. Analogous elements in these 
categories exist across the domains (mechanical, electrical, fluid, and thermal) for the most 
part. Also, general multi-port elements can be identified as well. However, for typical mod-
eling situations, single-port and two-port elements are adequate.
5.3.1  Single-Port Elements
Single-port (or, single energy port) elements are those that can be represented by a single 
branch (single line segment) of a linear graph. These elements possess only one power 
(or energy) variable (the product of the through-variable and the across-variable, which 
is the difference between the input power and the output power). This power is “ported” 
through a single branch; hence the name “single-port.” They have two terminals (the point 
of action and the point of reference) as noted before. The general form of a single-port 
linear-graph element is shown in Figure 5.1b.
Mechanical Elements: In modeling a mechanical system, we require three passive sin-
gle-port elements, as shown in Figure 5.2. These lumped-parameter mechanical elements 
are mass (or inertia), spring, and damper (dashpot). Although translatory mechanical ele-
ments are presented in Figure 5.2, corresponding rotary elements are easy to visualize. In 
the latter case, f denotes the torque through the element and v is the relative angular veloc-
ity in the same direction at the point of action.
Note: The linear graph of an inertia element has a broken line segment. This is because 
in an inertia element there is no direct physical link between the point of action (lumped 
m
f
v2 = v
v1 = 0
v = v2 – v1
v = v2 – v1
f
f, v
Energy storage element (inertia/mass)
mass = m
k
f
f
v2
v2
v1
v1
f
f
b
f = kx
Energy storage element (spring)
stiffness = k
Energy dissipation element (damper)
damping constant = b
m
f, v
k
f, v
b
f = bv
f = kx = kv
v = (1/m)f
f = mx = mv
FIGURE 5.2
Single-port mechanical elements and their linear-graph representations.

205
Linear Graphs
inertia element) and the point of reference (ground reference). The “inertia force” does 
not directly travel from the point of action to the point of reference. However, this force 
is received indirectly (and “felt”) at the point of reference. For example, the “source” that 
applies the force to the inertia element, which generates the “inertia force,” will have its 
other end at the ground. Hence, there will be an equal force transmitted to the ground. 
Imagine the situation where you are pushing a mass, causing it to accelerate (and creat-
ing an inertial force equal to the product of mass and acceleration). Then your feet on the 
ground will transmit an equal force to the ground. This issue will be further discussed in 
Example 5.1.
Analogous single-port electrical elements may be represented in a similar manner. 
These are shown in Figure 5.3.
5.3.2  Source Elements
In linear-graph models, system inputs are represented by source elements. There are two 
types of sources, as shown in Figure 5.4.
T-Type Source (e.g., Force Source, Current Source): For a T-source, the independent 
variable (i.e., the source output, which is the system input) is the through-variable f. The 
arrow head indicates the positive direction of f.
Note: For a T-source, the sign convention that the arrow gives the positive direction of f 
still holds. However, the sign convention that the arrow is from the point of action to the 
point of reference (or the direction of the drop in the across-variable) does not hold.
A-Type Source (e.g., Velocity Source, Voltage Source): For an A-source, the indepen-
dent variable is the across-variable v. The arrow head indicates the direction of the “drop” 
in v. The + and – signs are indicated as well for an A-type source, where the drop in v 
occurs from the + terminal to the – terminal.
i,v
Energy storage element (capacitor)
capacitance = 
Energy storage element (inductor)
inductance = 
Energy dissipation element (resistor )
resistance = 
dv
C      = i
dt
di
L      = v
dt
R
L
i
v
–
+
i
v
–
+
C
i
v
–
+
L
C
i, v
i, v
R
v = Ri
FIGURE 5.3
Single-port electrical system elements and their linear-graph representations.

206
Modeling of Dynamic Systems with Engineering Applications
Note: For an A-type source, the sign convention that the arrow is from the point of action 
to the point of reference (or the direction of the drop in the across-variable) holds. However, 
the sign convention that the arrow gives the positive direction of f does not hold.
In an ideal force source (a through-variable source), the force variable (the independent 
variable) is not affected by interactions of the source with the rest of the system. The cor-
responding relative velocity across the force source, however, will vary as determined by 
the dynamics of the overall system. It should be clear that the direction of f(t) as shown in 
Figure 5.4a is the applied force. The reaction on the source would be in the opposite direc-
tion. An ideal velocity source (across-variable source) supplies a velocity without being 
affected by the dynamics of the system to which it is applied. Hence, velocity of the source 
is the independent variable. The corresponding force is, of course, determined by the sys-
tem dynamics.
Interaction Inhibition by Source Elements
As we have noted, the source variable (independent variable or input variable) of a source 
is unaffected by the dynamics of the system to which the source is connected. But the 
­co-variable (dependent variable) will change. A related property of a source element is 
identified now. Source elements can serve as means of inhibiting dynamic interactions 
between systems. Specifically, it follows from the definition of an ideal source that the 
dynamic behavior of a system is not affected by connecting a system in series with a 
T-source (e.g., force source or current source) or in parallel with an A-source (e.g., velocity 
source or voltage source).
Corollary: Components can be connected in series with a T-source, or a series-connected 
component can be removed from a T-type source without affecting the dynamics of the 
resulting system. Similarly, components can be connected in parallel with an A-source, or a 
parallel-connected component can be removed from an A-type source without affecting the 
dynamics of the resulting system. Examples of these two situations are given in Figure 5.5.
Another interpretation of these situations is that a source can uncouple (decouple) sub-
systems in a system. Specifically, two systems in each case of Figure 5.5 are uncoupled. In 
other words, the original system and the new system in Figure 5.5 are two (uncoupled) 
subsystems driven by the same input source. In this sense, the order of the overall system 
is the sum of the orders of the individual (uncoupled) subsystems.
f (t)
f (t)
v(t)
v(t)
Point of action
v
(a)
Reference
g
(b)
Point of action
(c)
f
Point of action
(d)
Reference
g
Point of action
+
–
FIGURE 5.4
(a) T-source (through-variable source); (b) linear-graph representation of a T-source; (c) A-source; and (d) linear-
graph representation of an A-source.

207
Linear Graphs
Note: In general, linking (networking) a subsystem will change the order of the overall 
system (because new dynamic interactions are introduced).
5.3.3  Two-Port Elements
A two-port element has two points of action (with two corresponding energy ports) and 
two coupled branches corresponding to them. A two-port element can be interpreted as a 
pair of single-port elements, with a common point of reference, whose net power is zero. 
A transformer (mechanical, electrical, fluid, etc.) is a two-port element. Also, a mechani-
cal gyrator is a two-port element. An example of a translatory mechanical transformer is 
a lever. An example of rotatory mechanical transformer is a meshed pair of gear wheels. 
A gyrator is typically an element that possesses gyroscopic properties. We shall consider 
only the linear cases; i.e., ideal transformer and ideal gyrator. The extension to the nonlin-
ear case should be clear.
Transformer
In an ideal transformer, the across-variables in the two ports (branches) are changed 
according some relationship (parameter) without dissipating or storing energy in the pro-
cess. Hence the through-variables in the two ports will also change accordingly. Examples 
of mechanical, electrical, and fluid transformers are shown in Figure 5.6a through d. The 
linear-graph representation of a transformer is given in Figure 5.6e.
In Figure 5.6e, as for a single-port passive element, the arrow goes from the point of 
action to the point of reference, in each of the two branches (line segments). It shows the 
positive direction of power flow (i.e., when the product of the through-variable and the 
f(t)
System 2
System 1
(a)
=
f(t)
System 1
f(t)
+
System 2
(b)
=
–
+
System 1
System 2
+
–
System 1
+
–
+
System 2
v(t)
v(t)
v(t)
FIGURE 5.5
(a) Two systems connected in series with a T-source and (b) two systems connected in parallel with an A-source.

208
Modeling of Dynamic Systems with Engineering Applications
across-variable for that segment is positive). One of the two ports (branches) may be con-
sidered the input port and the other branch the output port. Let
vi and fi = across- and through-variables at the input port
vo and fo = across- and through-variables at the output port
The (linear) transformation ratio r of the transformer is given by
	
=
v
rv
o
i	
(5.1)
Due to the conservation of power, we have
	
+
=
f v
f v
0
i
i
o
o
	
(5.2)
By substituting Equation 5.1 into Equation 5.2 we obtain
	
= −
f
r f
1
o
i	
(5.3)
Here r is a non-dimensional parameter because the input domain and the output domain 
are the same. A two-domain transformer will have a dimensional r. The two constitutive 
relations of a transformer are given by Equations 5.1 and 5.3.
fo
fi
(a)
vo
vi
fo
(b)
fi
vi
(c)
Primary turns Ni
Secondary turns N0
v0
i0
vi
ii
Ni
N0
r =
= vi
v0
(d)
Area
Vent
Area
Frictionless
A0
Pi
Po
Qi
Ai
Q
Pi Ai =  Po Ao 
Ao
Ai
r =
= Pi
Po
Po = rPi ; Qo = –
r
1 Qi
(e)
r
Reference
g
fo = – r
1 fi
fo , vo
vo = rvi
fi , vi
v0
FIGURE 5.6
Transformer. (a) Lever; (b) meshed gear wheels; (c) electrical transformer; (d) fluid transformer; and (e) linear-
graph representation.

209
Linear Graphs
Electrical Transformer: As shown in Figure 5.6c, an electrical transformer has a primary 
coil, which is energized by an alternating-current (ac) voltage (vi), a secondary coil in which 
an ac voltage (vo) is induced, and a common core, which helps the linkage of magnetic flux 
between the two coils. A transformer converts vi to vo without making use of an external 
power source. Hence it is a passive device, just like a capacitor, inductor, or resistor. The turn 
ratio of the transformer is
	
=
r
N
N
number of turns in the secondary coil (
)
number of turns in the primary coil (
)
o
i
	
(5.4)
Note: In Figure 5.6c, the two dots on the top side of the two coils indicate that the two coils 
are wound in the same direction.
In a pure and ideal transformer, there will be full flux linkage without any dissipation of 
energy. Then, the flux linkage will be proportional to the number of turns. Hence
	
λ
λ
= r
o
i	
(5.5)
where λ denotes the flux linkage in each coil. By differentiating Equation 5.5, while noting 
that the induced voltage in the coil is given by the rate of charge of flux, we get Equation 5.1. 
In an ideal electrical transformer, there is no energy dissipation and also the signals will be 
in phase.
Gyrator
A gyrator converts the through-variable at the input port into the across-variable at the 
output port according to some relationship (and correspondingly, the across-variable at 
the input port into the through-variable at the output port) without any energy storage or 
dissipation. Mixed-domain gyrators where the input and the output are in different physi-
cal domains are available. First, we consider a single-domain gyrator where the input and 
the output both are in the mechanical domain.
Mechanical Gyrator: A mechanical gyrator is an ideal gyroscope (Figure 5.7a). It is sim-
ply a spinning top that rotates about its own axis at a high angular speed ω (positive in 
the x-direction), which is assumed to remain unaffected by other small motions that are 
present. If the moment of inertia about this axis of rotation (x in the shown configuration) 
is J, the corresponding angular momentum is h = Jω, and this vector is also directed in the 
positive x-direction, as shown in Figure 5.7b.
Suppose that the angular momentum vector h is given an incremental rotation δθ about 
the positive z-axis, as shown. As a result, the free end of the gyroscope will move in the 
positive y-direction. The resulting change in the angular momentum vector is δ
ωδθ
=
h
J
 
in the positive y-direction, as shown in Figure 5.7b. Hence, the rate of change of angular 
momentum is
	
δ
δ
ωδθ
δ
=
h
t
J
t 	
(i)
where δt is the time increment of the motion. In the limit (as δ →
t
0), the rate of change of 
angular momentum is

210
Modeling of Dynamic Systems with Engineering Applications
	
ω θ
=
dh
dt
J
d
dt 	
(ii)
If the velocity given to the free end of the gyroscope, in the positive y-direction, is vi to 
generate this motion (which will result in a force fi at that point, in the positive y-direction) 
the corresponding angular velocity about the positive z-axis is
	
θ =
d
dt
v
L
i
	
(iii)
Here, L is the length of the gyroscope. Substitute (iii) into (ii). The rate of change of angular 
momentum is
	
ω
=
dh
dt
J v
L
i
	
(5.6)
about the positive y-direction. By Newton’s second law, to sustain this rate of change of 
angular momentum, a torque equal to ω
J v L
i
 is required in the same direction. If the 
corresponding force at the free end of the gyroscope is denoted by fo in the positive 
z-­direction, the corresponding torque is foL acting about the negative y-direction. It follows 
that 
ω
−
=
f L
J v
L
o
i . This may be expressed as
	
= −
f
M v
1
o
i	
(5.7)
By the conservation of power (Equation 5.2) for an ideal gyroscope, it follows from 
Equation 5.7 that
	
=
v
Mf
o
i	
(5.8)
(b)
h
Jω
=
h
h
J
δ
δθ
ωδθ
=
=
δθ
J
ω
x
y
z
fi, vi
fo, vo
(a)
L
M
fi, vi
fo, vo
Reference
g
(c)
1
of
vi
M
= −
(d)  
iP
i
Q
o
v
o
f
1
M
A
=
Area = A
vo = M fi
FIGURE 5.7
(a) Mechanical gyrator (gyroscope or spinning top)—a two-port element; (b) derivation of the constitutive equa-
tions; (c) linear-graph representation; and (d) hydraulic-mechanical gyrator.

211
Linear Graphs
The corresponding gyroscope parameter is
	
ω
=
M
L
J
2
	
(5.9)
Note: For a “mechanical gyrator” M is a “mobility” parameter (velocity/force), as ­discussed 
in Chapter 6.
Equations 5.7 and 5.8 are the constitutive equations of a gyrator. The linear-graph repre-
sentation of a gyrator is shown in Figure 5.7c.
Note: The same constitutive relations can be obtained using a different approach (this 
time getting Equation 5.8 first. For that, give the angular momentum vector h an incre-
mental rotation δθ about the positive y axis. The free end of the gyroscope will move 
in the negative z direction as a result. The resulting change in the angular momentum 
vector is δ
ωδθ
=
h
J
 as before (but in the negative z direction). Hence, the rate of change of 
angular momentum is 
ω
= −
dh
dt
J v
L
o . The torque that sustains this rate of change of angular 
momentum (in the negative z direction) is −fiL. Hence, we have (from Newton’s second 
law) 
ω
−
=
→
=
J v
L
f L
v
Mf
–
o
i
o
i.
Hydraulic-Mechanical Gyrator: An example of a mixed-domain gyrator is a hydraulic-
mechanical gyrator, which consists of a piston and a cylinder of fluid (see Figure 5.7d). The 
fluid flow at the volume rate Qi into the cylinder is accommodated by the movement of the 
piston (area = A) at velocity vo. We have
	
=
Q
Av
i
o	
(i)
Force on the piston due to the fluid pressure Pi is APi. The corresponding force on the 
­piston rod is fo. Then, the force balance of the piston gives
	
+
=
AP
f
0
i
o
	
(ii)
From (i) and (ii) we have the constitutive equations of the hydraulic-mechanical (mixed-
domain) gyrator:
	
=
v
MQ
o
i	
(5.10)
	
= −
f
M P
1
o
i	
(5.11)
	
=
M
A
with the gyrator parameter 
1
	
(5.12)
5.4  Linear-Graph Equations
As discussed in Chapter 3, in our systematic approach for formulating a state-space model 
of an engineering dynamic system, three types of equations have to be written. In using 

212
Modeling of Dynamic Systems with Engineering Applications
a linear graph to facilitate this formulation, the same three types of equations are written, 
using the linear graph, and further manipulated:
	
1.	Constitutive equations for independent energy storage elements (this forms the 
state-space shell)
	
2.	Constitutive equations for the remaining elements that are not sources (inputs)
	
3.	Compatibility equations (loop equations) using across-variables for all the 
­independent closed paths (primary loops) formed by two or more branches
	
4.	Continuity equations (node equations) using through-variables for all the 
­independent junctions (nodes) of two or more branches
	
5.	Using equations in Items 2, 3, and 4, eliminate unnecessary (auxiliary) variables in 
Item 1.
Note: Auxiliary variables are those other than the state variables and the input variables.
Constitutive equations of elements have been discussed in detail in Chapter 2 and 
Chapter 3, and also in the beginning of the present chapter. In the examples in Chapter 3, 
not all compatibility equations and continuity equations were stated explicitly because 
sometimes the system variables were chosen to satisfy these two types of equations implic-
itly. In the modeling of complex dynamic systems, systematic approaches, which can be 
computer-automated, will be useful. In that context, approaches are necessary to explicitly 
write the compatibility equations and continuity equations even when they seem obvious 
or unnecessary in a manual process of model formulation. The related approaches and 
issues are discussed next.
5.4.1  Compatibility (Loop) Equations
A loop in a linear graph is a closed path formed by two or more branches. A loop equa-
tion (compatibility equation) is obtained by algebraically (i.e., taking into account the 
proper sign) summing all the across-variables along the branches of the loop to zero. 
This is a necessary condition because at a given point in the linear graph there must be a 
unique absolute value for the across-variable at a given time. In other words, in a system, 
a component connected at a point (node) must not be broken off causing discontinuity in 
the across-­variable there. For example, a mass and an end of a spring connected to the 
same point must remain connected (and hence, must have the same velocity at a particular 
time instant). Since this point must be intact (i.e., does not break or snap thereby separating 
the connected components), the system is said to remain “compatible.”
Sign Conventions
	
1.	In writing a loop equation, go in the counter-clockwise (ccw) direction of the loop, 
starting from a convenient node.
	
2.	The across-variable drops in the direction of a branch arrow. This direction is 
taken to be positive (i.e., the associated across-variable is positive). Note: The excep-
tion is a T-source (through-variable source), where the arrow direction indicates 
the increasing direction of the across-variable.
The arrow in each branch is important in writing a loop equation. Clearly, we cannot 
always go in the direction of the arrow in a branch that forms a loop. If we go opposite to 
the arrow, a negative sign is used with the associated across-variable.

213
Linear Graphs
Number of “Primary” Loops
Primary loops are a “minimal” set of loops from which any other loop in the linear graph 
can be formed. Hence, a set of primary loops is a complete and “independent” set. Such a 
set is not unique (different sets of primary loops can be formed). Regardless, a primary set 
of loops will generate all the independent loop equations, and also can generate any other 
loop in the linear graph.
Note: Loops closed by broken-line branches (i.e., of inertia elements) should be included 
as well in determining the primary loops.
Not all “primary” loop equations are useful in the development of state equations (i.e., 
in the elimination of auxiliary variables). Specifically, the equations of loops that include 
one or more T-sources are not useful. This is because the across-variable of a T-source is the 
dependent variable of the source and should not remain in the state equations (because it is 
neither a state variable nor an input variable. It is an auxiliary variable).
Example 5.1
Figure 5.8 shows a mass-spring-damper system and its linear graph. Each element in 
the linear graph forms a branch. As noted before, an inertia element always is (virtu-
ally) connected to the ground reference point (g) by a partially dotted line (or a partially 
broken line). This is because the velocity (across-variable) of a mass is given with respect 
to the ground reference (which has zero velocity) but it is not directly connected to the 
ground. The ground is always the reference point of a mass element, and it “indirectly 
feels” the inertia force of the mass. To understand this further, suppose that we push an 
unconstrained mass upwards by our hands, imparting it an acceleration. The pushing 
force of the hands is equal to the inertia force, which is the product of mass and accelera-
tion. An equal force is transmitted to the ground though our feet. Clearly, the mass itself 
is not directly connected to the ground, yet the force applied to the mass (or the inertia 
force) is “felt” at the ground (indirectly transmitted to the ground). Hence, the force 
“appears” to travel directly from the “lumped” mass element to the ground.
Note: If you think that in this example, human body is a solid link between the mass 
and the ground, imagine applying a magnetic force to a magnetic mass using a “mag-
netic bearing” (the housing of the magnetic bearing/actuator is fixed to the ground, but 
it is not directly connected to the pushed mass element).
Similarly, in Figure 5.8, the input force from the “force source” also travels to (or “felt 
at”) the ground reference point.
Reference g
2
1
m
k
b
f1, v1
f2, v2
f(t),v
Loop
1
Loop
2
Loop
3
(b)
f3, v3
m
k
f(t)
b
v2
Reference g
(a)
FIGURE 5.8
(a) A mass-spring-damper system and (b) a linear graph having two nodes and three primary 
loops.

214
Modeling of Dynamic Systems with Engineering Applications
In this example, there are three primary loops. These three loops are not unique and 
can be chosen in many ways.
Note: A set of primary loops is an “independent set.” Any loop in that set cannot be 
formed by combining the remaining loops. Any other loop can be formed by combining 
the primary loops.
In this example, we have chosen the set of three primary loops as marked in Figure 5.8:
Loop 1: (k, m)
Loop 2: (m, b)
Loop 3: (m, s)
Note: “s” denotes the source element.
OBSERVATIONS
•	 Every loop includes the branch corresponding to the A-type element (mass). 
Hence, every loop equation will contain its across-variable, which is known to 
be a state variable (which must be retained in the state equations).
•	 The loop that contains the T-source (i.e., m, s loop) is not useful (even though it 
is a primary loop) because the across-variable of a T-source is the “dependent 
variable.” It is an “auxiliary variable” and should not be retained in the state 
equations.
•	 Many other primary sets of three loops can be chosen. Three other possible 
sets of primary loops are: [(k, b), (m, b), (b, s)], [(k, b), (m, s), (m, b)], and [(k, b), (m, s), 
(k, s)]. But the corresponding loop equations will require more manipulation in 
the development of the state equations (i.e., in the elimination of the auxiliary 
variables) than what is needed with the choice shown in Figure 5.8. 
LOOP EQUATIONS (GO CCW)
Loop 1: v1 − v2 = 0
Loop 2: v2 − v3 = 0
Loop 3: v2 − v = 0 (not useful because v is an unwanted variable)
Once we select a set of primary loops (three loops in this example), any other loop can 
be formed by combining this primary set. For example, the loop (k, b) can be obtained by 
combining the loops (k, m) and (m, b). In particular, its loop equation can be obtained by 
algebraically adding the loop equations of the latter two loops. Specifically
	
−
=
−
+
−
v
v
v
v
v
v
(
)
(
)
1
3
1
2
2
3
LEARNING OBJECTIVES
	
1.	 Use of the sign convention (go ccw in a loop; arrow indicates A-variable drop, 
except in a T-source)
	
2.	 Appropriate choice of primary loops (pick loops that have A-type state 
­variables and/or A-sources)
	
3.	 Identification of primary loops that are not useful (a loop with a T-source)
◾
GENERAL OBSERVATIONS
•	 A set of primary loops is a “minimal” and “independent” set: (1) Any other 
loop can be formed by combining the loops in this set and (2) no loop in the set 
can be formed by combining the remaining loops in the set.
•	 Many choices are available in selecting the primary loop set.

215
Linear Graphs
•	 The set of primary loops provide all the independent loop equations.
•	 The best choice of primary loops will include A-type energy storage elements 
(providing A-type state variables) and A-sources (providing A-type input vari-
ables). Such a choice will minimize the necessary mathematical manipulations 
in the development of state variables (in the process of eliminating auxiliary 
variables).
•	 All primary loops (and their loop equations) may not be useful in the devel-
opment of a state model (i.e., in the elimination of the auxiliary variables). 
Specifically, (1) ignore the branches that correspond to T-type sources (because 
their across-variables are dependent variables, which should not be in the state 
equations) and (2) form a primary subset of loops from the remaining branches. 
The corresponding loop equations are the set of useful loop equations.
5.4.2  Continuity (Node) Equations
A node is a “junction” where two or more branches meet. A node equation (or, continuity 
equation) is created by equating to zero the algebraic sum of all the through-variables at 
a node. This equation holds in view of the fact that a node can neither store nor dissipate 
energy; in effect it amounts to “what goes in must come out.” Hence, a node equation dic-
tates the continuity of the through-variables at a node. For this reason, one must use proper 
signs for the variables when writing node equations.
Sign Convention: A through-variable going “into” the node is positive (and coming out 
of the node is negative).
The meaning of a node equation in various domains is indicated below.
Mechanical Systems: Force balance; equilibrium equation; Newton’s third law; etc.
Electrical Systems: Current balance; Kirchoff’s current law; conservation of 
charge; etc.
Hydraulic Systems: Conservation of fluid
Thermal Systems: Conservation of thermal energy
Primary Node Equations
If a linear graph has n nodes, the number of primary nodes is n − 1. This is because the 
equation for any node can be obtained by algebraically combining the equations for the 
other n − 1 nodes.
As in the case of loop equations, not all “primary” node equations are useful in the devel-
opment of state equations (i.e., in the elimination of auxiliary variables). Specifically, the 
equation for a node that connects an A-sources is not useful. This is because the through-
variable of an A-source is the dependent variable of the source and should not remain in the 
state equations (because it is neither a state variable nor an input variable. It is an auxiliary 
variable).
Example 5.2
Revisit the problem given in Figure 5.8. The system has two nodes. The corresponding 
node equations are identical, as given below.
Node 2 Equation: −f1 − f2 − f3 + f = 0
Node 1 Equation: f1 + f2 + f3 − f = 0

216
Modeling of Dynamic Systems with Engineering Applications
Note: The equation of Node 1 is obtained simply by reversing the signs in the Node 2 
equation. Hence, there is only one independent (primary) node in this example.
This node equation is clearly a useful equation. It contains “f” which is an input vari-
able and should be retained in the state equations. Also, it contains f1, which is a state 
variable. Hence, this node equation is useful in the elimination of the auxiliary vari-
ables f2 and f3, when generating the state equations.
LEARNING OBJECTIVES
	
1.	 Application of the sign convention for node equations
	
2.	 Required number of node equations = Total number of nodes − 1
	
3.	 Identification of useful node equations
◾
GENERAL OBSERVATIONS
•	 For a linear graph with n nodes, there are only n − 1 primary (independent) 
node equations. The remaining node equation is the algebraic sum of the first 
n − 1 node equations.
•	 All primary node equations may not be useful in the development of a state model 
(i.e., in the elimination of the auxiliary variables). Specifically, the equation of a 
node that connects an A-type source is not useful (because the through-­variable 
of and A-type source is a dependent variable, which should not be present in a 
state equation (it is an auxiliary variable, which should be eliminated).
Example 5.3
Consider the L–C–R electrical circuit shown in Figure 5.9a. Its linear graph is drawn in 
Figure 5.9b. The system has three primary loops; one primary node; and a voltage source 
(an A-source). It should be clear that this system is “not” analogous to the mechanical 
system of Figure 5.8, because that system has a force source (a T-source).
LOOP EQUATIONS
There are many choices for the three primary loops. However, the best choices (which 
yield loop equations that require minimal manipulation in eliminating auxiliary vari-
ables, in the generation of state equations) have the following properties:
	
1.	 Loops that contain A-sources are desirable (because their across-variables are 
input variables, which must be retained in the state equations).
	
2.	 Loops that contain A-type (energy storage) elements are desirable (because 
their across-variables are state variables, which must be retained in the state 
equations).
	
3.	 Loops that contain T-sources should be avoided (because their across-variables 
are the dependent variables, which must not be present in the state equations).
L
C
R
v(t)
(a)
–
+
+
i, v(t)
L
C R
i1, v1
i2, v2
i3, v3
(b)
Loop
1
Loop
2
Loop
3
.
1
2
FIGURE 5.9
(a) An L–C–R circuit and (b) its linear graph.

217
Linear Graphs
According to these criteria, in Figure 5.9b we have selected the following set of primary 
loops:
Loop 1: (s, L)
Loop 2: (L, C)
Loop 3: (C, R)
The corresponding loop equations (three) are given as follows, with the standard sign 
convention:
Loop 1: v − v1 = 0
Loop 2: v1 − v2 = 0
Loop 3: v2 − v3 = 0
We may select many other sets of three loops as primary loops. Some examples are: 
[(s, L), (L, C), (s, R)] or [(s, C), (L, C), (C, R)] or [(s, L), (s, C), (s, R)]. No matter what primary 
set is chosen, it will include all the branches of the linear graph, and the resulting loop 
equations will be complete.
NODE EQUATIONS
In this example, there are two nodes. Their equations (according to the standard sign 
convention) are
Node 1: i − i1 − i2 − i3 = 0
Node 2: −i + i1 + i2 + i3 = 0
Since the Node 2 equation can be obtained simply by reversing the signs of the terms in 
the Node 1 equation, there is only one independent (primary) node equation.
Note: This node equation has the dependent variable i of the source (which is an aux-
iliary variable, which should not be present in the state equations). Hence, this primary 
node equation is in fact not a useful equation (in the generation of state equations).
LEARNING OBJECTIVES
	
1.	 Selection of a proper set of primary loops
	
2.	 Selection of the independent (primary) nodes
	
3.	 Sign convention in writing loop equations
	
4.	 Sign convention in writing node equations
	
5.	 Identification of the useful/useless loop equations
	
6.	 Identification of the useful/useless node equations
◾
5.4.3  Series and Parallel Connections
If two or more elements are connected in series, their through-variables are the same but 
the across-variables are not the same (they add algebraically). If two or more elements are 
connected in parallel, their across-variables are the same but the through-variables are not 
the same (they add algebraically). These facts are given in Table 5.2.
TABLE 5.2
Series-Connected Components and Parallel-Connected Components
Components in Series
Components in Parallel
Through-variables are the same 
Across-variables are not the same (they add 
algebraically)
Across-variables are the same 
Through-variables are not the same (they add 
algebraically)

218
Modeling of Dynamic Systems with Engineering Applications
Let us consider two systems with a spring (k) and a damper (b), and an applied force (f(t)). 
In Figure 5.10a, they are connected in parallel, and in Figure 5.10b, they are connected in 
series. Their linear graphs are as shown in the corresponding figures. The linear graph in a 
has two primary loops (two elements in parallel with the force source), whereas in b there 
is only one loop, because all the elements are in series with the force source. From Table 5.2 
we can appreciate the nature of the node equations and the loop equations in these two 
cases, without even having to write these equations.
Another important consequence of the interconnection structure of components with 
source elements has been observed before. Specifically
	
1.	Components connected in series with a T-source have no dynamic interactions (i.e., 
they are uncoupled, and can be treated separately; a component can be removed 
without affecting the rest of the system).
	
2.	Components connected in parallel with an A-source have no dynamic interac-
tions (i.e., they are uncoupled, and can be treated separately; a component can be 
removed without affecting the rest of the system).
5.5  State Models from Linear Graphs
In Chapter 3, we presented a systematic way to develop a unique state-space model of an 
engineering dynamic system. In that approach, an initial step is to sketch a ­“structural” 
diagram of the system showing how the components (or basic elements) are intercon-
nected. A powerful graphic representation that not only provides the model structure but 
also the nature of the interconnected components, model variables and parameters (in 
short, the complete dynamic model) is a linear graph (LG). Another comparable graphic 
representation is provided by bond graphs (see Appendix B). The focus of the present 
chapter is linear graphs. An LG presents:
•	 The “structure” of the system (how the components are interconnected)
•	 The nature/type of the components (e.g., A-type and T-type elements and sources, 
D-type elements, multi-port elements)
•	 Variables and parameters of the elements (through-variable and across-variable 
pair for each element or port; characteristic parameters of the model elements, 
which are needed to formulate the constitutive equations)
k
f(t)
b
k
b
f(t)
(a)
(b)
f(t)
k
b
f(t)
FIGURE 5.10
Spring-damper systems with a force source and their linear graphs. (a) Elements in parallel and (b) elements 
in series.

219
Linear Graphs
•	 Directions (according to some sign convention) of the variables (through-variables, 
across-variables, power flow)
Once the linear graph of a dynamic system is sketched, we use the same systematic proce-
dure as presented in Chapter 3, albeit facilitated by the linear graph, to obtain a state-space 
model of the system.
5.5.1  Sketching of a Linear Graph
A linear graph is indeed a model of a dynamic system because it contains all the informa-
tion about the system, particularly what is needed to formulate a state-space model. In 
developing a linear graph, we sketch a branch starting from its point of reference and con-
nect it to other branches, according to the specific model structure, until all the branches 
(elements/components) of the system are included. Next, we orient the graph (i.e., insert 
the arrows for all the branches). Finally, we indicate the through-across variable pair of 
each branch on one side of the branch and the parameter of the branch on the other side. 
A systematic way to sketch a linear graph is as follows:
	
1.	Identify the energy storage elements, energy dissipation elements, and source ele-
ments in the system (these are single-port elements, each represented by 1 branch).
	
2.	Identify any multi-port elements (e.g., transformers, gyrators) which ned more 
than one branch.
	
3.	Recognize how the elements (branches) are interconnected (series or parallel and 
to what elements) and sketch a schematic diagram (e.g., circuit diagram). This is 
the parent graph from which the LG is generated.
	
4.	Where possible or clear, identify the terminals of each element or branch (i.e., the 
point of action and the point of reference).
	
5.	Starting from a convenient node point (typically, the ground reference) draw a 
branch (typically, for a source), link it to another appropriate branch through a 
node (this automatically determines the point of action of the linked branch), and 
so on, to form a loop.
	
6.	Repeat Step 5 until the entire system is completed (i.e., all the elements/branches 
in the system are included and connected).
	
7.	Orient each branch of the linear graph (this may have been done in an earlier step).
	
8.	Write the corresponding through-across variable pair on one side of each branch 
and the corresponding element parameter on the other side (this may have been 
done in an earlier step). Note: For an ideal source, we can only indicate the variable 
pair, not a parameter, because one variable is independent.
Once the linear graph is developed in this manner, a state-space model of the system can 
be formulated using it.
5.5.2  State Models from Linear Graphs
As discussed in Chapters 2 and 3, in the systematic approach of formulating a state-space 
model (now using linear graphs) we use as
	 (a)	 State Variables: Across-variables of independent A-type (energy storage) elements 
and through-variables of independent T-type (energy storage) elements

220
Modeling of Dynamic Systems with Engineering Applications
	 (b)	 Input Variables: Across-variables of A-sources and through-variables of T-sources. 
These are the “independent variables” of the source elements.
Note: When there are several “dependent” energy storage elements, a single common state 
variable should be used to represent the dynamic state of all of them. A systematic way to 
identify dependent elements (or “conflicts”) in a linear graph is provided by the graph tree 
approach, which is presented in Appendix C.
In obtaining an analytical model from the linear graph of a system, we write three types 
of equations:
	
1.	Constitutive equations for all the independent energy storage elements. This 
forms the state-space shell.
	
2.	Constitutive equations for the remaining branches, excluding the source (input) 
elements.
	
3.	Compatibility equations for the independent (primary) loops. (As noted before, 
some of these loop equations may not be useful).
	
4.	Continuity equations for the independent nodes (As noted before, some of these 
node equations may not be useful).
This approach will be further elaborated in the present section.
System Order
As we know, A-type elements and T-type elements are energy storage elements. The system 
order is given by any one of the following:
•	 The number of independent energy storage elements in the system
•	 Number state variables
•	 The order of the state-space model (the order of the system matrix A in the linear 
case, and the number of state equations in general)
•	 The number of initial conditions required to solve the response of the analytical 
model
•	 The order of the input–output differential equation model
Note: In the Laplace (or frequency) domain (see Chapter 6), the system order is also equal 
to (for a linear system):
•	 The order of the characteristic polynomial (denominator of the transfer function)
•	 The number of poles (or eigenvalues) in the system (counting any repeated poles 
separately)
As noted before, the total number of energy storage elements in a system can be 
greater than the system order because some of these elements might not be indepen-
dent. Any dependent elements can be identified in an ad-hoc manner (see Example 5.7) 
or using the graph tree approach (see Appendix C). The dependent energy storage ele-
ments can be represented by a single equivalent element with a corresponding single 
state variable.

221
Linear Graphs
Sign Conventions
The important first step of developing a state-space model using linear graphs is indeed to 
draw a linear graph for the considered system. A sign convention should be established for 
this purpose, as discussed before. In summary, the sign convention which we use is as follows:
•	 Power flows into the point of action and out of the point of reference of an element 
(branch). This direction is shown by the branch arrow (a branch with an arrow is 
called an oriented branch). Exception: In a source element, power flows out of the 
point of action and into the element connected to the source.
•	 Through-variable (f), across-variable (v), and power flow (fv) are taken to be posi-
tive in the same direction at a point of action point. Note: v is measured at the point 
of action with respect to the point of reference, because it is the across-variable. 
Once the direction of f is known at the point of action, its direction is also known 
at the point of reference because it is the through-variable.
•	 In writing a node equation: Flow into a node is positive.
•	 In writing a loop equation: (a) Go in the counter-clockwise (ccw) direction of the 
loop, starting from a convenient node and (b) an A-variable is positive in the direc-
tion of branch arrow (A-variable “drops” from the point of action to the point of 
reference; i.e., in the direction of the arrow, because it is measured wrt the point of 
reference). Exception: In a T-source, the arrow is in the “negative” direction of its 
A-variable (i.e., the increasing direction).
Note: Once the sign convention is established, the actual values of the variables can be posi-
tive or negative depending on their actual direction.
Steps of Obtaining a State Model
The systematic steps for obtaining state equations (i.e., a state-space model) from a lin-
ear graph are the same as those presented in Chapter 3. The only difference is, now the 
method is assisted by the linear graph. The key steps are:
	
1.	Choose as state variables: across-variables for independent A-type elements and 
through-variables for independent T-type elements.
	
2.	Write the constitutive equations for the independent energy storage elements. 
This set of equations is called the state-space shell. Note: If the dependent ele-
ments cannot be identified at this stage, you may write constitutive equations for 
all the energy storage elements. A formal method of identifying the dependent 
elements is the graph-tree approach (see Appendix C).
	
3.	Write the constitutive equations for the remaining elements (dependent energy 
storage elements, dissipation—D-type elements, two-port elements, etc.).
	
4.	Write compatibility equations for the primary loops. Note: If a particular primary 
loop equation is not useful (e.g., the loop has a T-source), you may skip it.
	
5.	Write continuity equations for the independent (primary) nodes (total number of 
nodes − 1). Note: If a particular primary node equation is not useful (e.g., the node 
has an A-source), you may skip it.
	
6.	In the state space shell, retain the state variables and the input variables only. 
Eliminate all other variables (called auxiliary variables) using the loop and node 
equations and the additional constitutive equations.

222
Modeling of Dynamic Systems with Engineering Applications
5.5.3  Characteristics of Linear Graphs
Being a graphical representation (or a network) a linear graph possesses some topological 
relations with regard to the:
Number of nodes (n)
Number of branches (b)
Number of primary loops (ℓ)
Also, being a representation of an engineering dynamic system, it must be the case (for the 
system to be solvable) that:
Number of unknown variables = number of equations
In particular, the number of unknown variables must be related to b and:
Number of sources (s)
The total number of equations must be equal to the sum of:
•	 Number of constitutive equations
•	 Number of compatibility equations
•	 Number continuity equations
These three equation numbers must be related to b, s, ℓ, and n.
We now establish these two relations (1. relation concerning system dynamics (solvabil-
ity), and 2. topological relation of an LG (a network containing branches, nodes, and loops)) 
and show them that they are the same.
LG Variables and Relations
Each source branch has one unknown variable (because one variable is the known input 
to the system—the independent variable of the source) and all other passive branches have 
two unknown variables each. Hence, we have
Total number of unknown variables = 2b − s
Since the source branches do not have a constitutive equation (their independent variable 
is the known input to the system) and the remaining branches provide one constitutive 
equation each, we have
Number of constitutive equations = b − s
Also, each primary loop gives a compatibility equation. Hence
Number of loop (compatibility) equations = ℓ
Since one of n nodes does not provide an extra independent node equation, we have
Number of node (continuity) equations = n − 1
Hence, total number of equations = (b − s) + ℓ + (n − 1) = b + ℓ + n − s − 1
To uniquely solve the analytical model we must have
Number of unknowns = Number of equations → 2b − s = b + ℓ + n − s − 1

223
Linear Graphs
Hence, we have the result
	
=
−
+
b
n
1
ℓ
	
(5.13)
Even though this relation was obtained by considering the variables and the equations of 
the dynamic system (specifically, considering “solvability” of the system), it is indeed a 
topological result (relating the number of loops, nodes and branches), which must be sat-
isfied by any linear graph (network). Hence, we should be able to obtain the relationship 
(Equation 5.13) from purely topological considerations, as we will do next.
Topological Result
Now a topological relationship is determined for a linear graph (a network) in terms of its 
geometric (topological) characteristics (nodes, loops, branches) only. Consequently, we will 
observe that this relationship is identical to Equation 5.13 that we obtained before. We use 
mathematical induction to carry out the related proof.
Consider Figure 5.11. Using the earlier notation, we proceed with the following steps of 
mathematical induction:
Step 1: Start with the basic graph shown in Figure 5.11a: For this graph: = 1
ℓ
, b = 2, n = 2. 
Hence, Equation 5.13 is satisfied by this basic graph.
Step 2: To the basic graph in Figure 5.11a, add a new loop by connecting m + 1 new 
branches in series, which will require m new nodes. This step is shown in Figure 5.11b. For 
this new graph, we have: ℓ = 2; n = 2 + m; and b = 2 + m + 1 = m + 2. Hence, Equation 5.13 is still 
satisfied by this new graph.
Note: m = 0 is a special case (where we connect only 1 new branch to the existing two 
nodes, in parallel, to form the new loop, without needing new nodes)
Step 3: Start with a general linear graph having ℓ loops, b ranches, and n nodes that satis-
fies Equation 5.13. This is the general case of Step1—Figure 5.11a.
Add a new loop by using m nodes and m + 1 branches (as in Step 2 above).
Then we have: ℓ + 1 loops; n + m nodes; and b + m + 1 branches.
Substitute these into Equation 5.13: 
+ = +
+ −
+
+
=
−
+
→= −
+
b
m
n
m
b
n
b
n
1
1
(
)
1
2
1
?
?
ℓ
ℓ
. 
Indeed, this is Equation 5.13, and it is still satisfied by the new values.
Then, by mathematical induction, Equation 5.13 is true in general (because: (1) It was 
true for the initial basic case; (2) it was true for a general increment to the basic case; and 
(3) assuming that it is true for some general case, it is true for the next general increment 
 it must be true for a second general increment to the basic graph  it must be true for a 
third general increment to the basic graph, and so on. We can continue this process until 
we form any required LG. Hence, Equation 5.13 holds for that LG.
Next, we present several examples on using linear graphs to develop state models, in dif-
ferent physical domains. Since the LG approach is unified across various physical domains, 
(a)
(b)
FIGURE 5.11
Proof of the topological result for an LG. (a) Basic LG (single loop with two branches) and (b) adding new gen-
eral branches to create a new loop.

224
Modeling of Dynamic Systems with Engineering Applications
the same approach is applicable in mechanical, electrical, fluid, thermal, and multidomain 
(i.e., mixed) systems, as we will illustrate.
5.6  Linear-Graph Examples in Mechanical Domain
Linear graphs can be used to develop state-space models in different physical domains. 
Specifically, since the approach is a unified one across various physical domains, the same 
approach is applicable in mechanical, electrical, fluid, and thermal domains, and also in 
multidomain (i.e., mixed) systems. Several examples in the mechanical domain are given 
now to illustrate the use of linear graphs in the systematic development of state-space 
models. Examples in other physical domains and in multiple domains are given in subse-
quent sections.
Example 5.4
Let us develop a state-space model for the system shown in Figure 5.8, using its linear 
graph. There are b = 4 branches and s = 1 source. Thus there are 2b − s = 7 unknown vari-
ables. Hence, we need seven equations to solve for unknowns. The b − s = 3 non-source 
branches gives three constitutive equations. In Figure 5.8, there are ℓ = 3 primary loops, 
which give three loop equations. Since there are two nodes, we can write n − 1 = 1 node 
equation. In this manner, we have the necessary 3 + 3 + 1 = 7 equations. Hence, the system 
is solvable (seven unknowns and seven equations).
The unknown variables are: v1, f1, v2, f2, v3, f3, v
Note: f(t), the input variable, is known
The steps of obtaining the state-space model are given now.
Step 1. Select state variables: Velocity v1 of mass m (A-type energy storage element) 
and force f2 of spring k (T-type energy storage element) are the state variables  x1 = f1, 
x2 = v2.
Input variable u = applied force (independent variable of the T-source) = force f(t).
Step 2. Constitutive equations for k and m: These generate the state-space shell 
(model skeleton):
	
=
f
kv
Hooke’s law for spring: 1
1

	
(i)
	
=
v
m f
From Newton’s second law:
(1
)
2
2

	
(ii)
Step 3. Remaining constitutive equation (for damper):
	
=
f
bv
3
3	
(iii)
Step 4. Node and loop equations:
	
(
)
−
−
−
=
f
f
f
f
Node equation for Node 2 :
0
1
2
3
	
(iv)
	
−
=
v
v
Equation for loop 1:
0
1
2
	
(v)
	
=
v
v
Equation for loop 2 :
–
0
2
3
	
(vi)

225
Linear Graphs
Equation for loop 3: v3 − v = 0 (not useful as it contains the dependent variable v of 
the source, which should not remain in the state equations).
Step 5: Eliminate auxiliary variables:
To obtain the state model, eliminate the auxiliary variables vl and f2 from the state-
space shell (Equations (i) and (ii)).
v1 = v2 (from (v))
= −
−
+
= −
−
+
f
f
bv
f
f
bv
f
2
1
3
1
2
 (from (iv), (iii), and (vi))
Substituting these into the state-space shell (Equations (i) and (ii)), we get the state 
model:
	
=
= −
−
+
→
f
kv
v
m f
b
m v
m f
1
1
1
2
2
1
2


with the state vector = 
= 

x
x
x
f
v
T
T
1
2
1
2
 and the input vector = 

u
f t( ) .
The model matrices, in the usual notation, are
	
=
−
−








=








A
B
k
m
b m
m
0
1
;
0
1
OBSERVATIONS
•	 This is a second-order system, as clear from the fact that the state vector x is a 
second-order vector and, further, from the fact that the system matrix A is a 2 × 2 
matrix.
•	 In this system, the input vector u has only one element, f(t). Hence it is actually a 
scalar variable, not a vector.
•	 The velocity (v) of the force source is not a state variable (it is the dependent vari-
able of the source, and it is an auxiliary variable, which should be eliminated). We 
did not need/use the corresponding loop equation (even though it was a primary 
loop equation).
•	 f(t) is positive in the direction of the source arrow in the LG. When the source 
velocity v is positive (upwards in the schematic diagram), then the power flow 
is also positive (in the direction of the source arrow) and flows into node 2 (and 
goes to the elements k, m, and b, at their action point). If the signs of both f(t) and v 
are reversed (i.e., downwards in the schematic diagram), still the power flow will 
remain positive (again, in the direction of the source arrow) and will flow “into” 
node 2 (and to the elements k, m, and b, at their action point).
LEARNING OBJECTIVES
	
1.	 Procedure for checking the solvability of a dynamic model (i.e., the number of 
unknown variables = the number of independent equations)
	
2.	 Selection of proper state variables
	
3.	 Formulation of the constitutive equations, starting from the state-space shell

226
Modeling of Dynamic Systems with Engineering Applications
	
4.	 Selection of the primary loops and identification of the primary loops that can 
be skipped in the formulation
	
5.	 Sign conventions
	
6.	 Model order
	
7.	 Systematic development of a state-space model for a mechanical system
◾
Example 5.5
A dynamic absorber is a passive device for vibration suppression and is mounted at the 
vibrating area of a dynamic system. By properly tuning (selecting the parameters of) the 
absorber, it is possible to “absorb” most of the power supplied by an unwanted excitation 
(e.g., support motion, imbalance in rotating parts) by sustaining the absorber motion 
such that, in steady operation, the vibratory motions of the main system are inhibited. 
In practice, some damping should be present in the absorber to dissipate the energy 
that flows into the absorber without generating excessive motions in the absorber mass. 
In the example shown in Figure 5.12a, the main system and the absorber are modeled 
as simple oscillators with parameters (m2, k2, b2) and (ml, kl, bl), respectively. The linear 
graph of this system can be drawn in the usual manner, as shown in Figure 5.12b. The 
external excitation (system input) is the velocity u(t) of the support (an A-type source).
Note: The LG is oriented starting from the source element. It acts on the two elements 
k2 and b2, determining their points of action. That automatically determines the points 
of reference of these two elements, which become the points of action of the elements 
connected to those two elements. We proceed in this manner until all the branches are 
oriented.
We observe the following:
Number of branches = b = 7
Number of nodes = n = 4
Number of sources = s = 1
Number of independent loops = l = 4
Number of unknowns = 2b – s = 13
Number of constitutive equations = b – s = 6
Number of (primary) node equations = n – 1 = 3
Number of (primary) loop equations = 4
(a)
m1
m2
b2
b1
v1
Reference g
k1
k2
(b)
f1, v1
f2, v2
f4, v4
f5, v5
f3, v3
f6, v6
m1
m2
b2
b1
k2
+
–
Reference g
k1
Loop 1
Loop 2
Loop 3
Loop 4
f, u(t)
u(t)
v2
FIGURE 5.12
(a) A mechanical system with a shock absorber and (b) linear graph of the system.

227
Linear Graphs
The four loop equations are provided by using four independent (primary) loops from 
the linear graph.
Check: Number of unknowns = 2b – s = 13
Number of equations = (b – s) + (n – 1) + l = 6 + 3 + 4 = 13.
Hence the analytical model is solvable.
Now we formulate the state-space model systematically, through the following 
sequence of steps:
Step 1. Since the system has four independent energy storage elements (ml, m2, kl, k2), it is 
a fourth-order system. The state variables are chosen as the across-variables of the two 
masses (velocities v1 and v2) and the through-variables of the two springs (forces f1 and f2):
State vector = 
= 

x
x
x
x
x
v
v
f
f
,
,
T
T
1
2
3
4
1
2
3
4
Input (A-source velocity) = [u(t)]
Step 2. The skeleton state equations (state-space shell):
Newton’s second law for mass m1: 
=
v
m f
1
1
1
1

Newton’s second law for mass m2: 
=
v
m
f
1
2
2
2

Hooke’s law for springs k1: 
=
f
k v
3
1
3

Hooke’s law for springs k2: 
=
f
k v
4
2
4

Step 3. The remaining constitutive equations:
	
For damper b1: 
=
f
b v
5
1
5	
(i)
	
For damper b2: 
=
f
b v
6
2
6	
(ii)
Step 4. The node equations:
We leave out one node (the ground node) and take the remaining three nodes as the 
independent (primary) nodes. The corresponding equations are
	
−
+
+
=
f
f
f
0
1
3
5
	
(iii)
	
−
−
−
+
+
=
f
f
f
f
f
0
3
5
2
4
6
	
(iv)
	
−
−
+
=
f
f
f
f
0 (not useful because of )
4
6
	
(v)
The loop equations:
The four primary loops are chosen, as in Figure 5.12b, with the goal of including 
as many desirable across-variables as possible in a loop while skipping undesirable/
unwanted across-variables. The corresponding equations are
	
Loop 1: 
−
+
=
v
u
v
0
2
4
	
(vi)
	
Loop 2: 
−
+
=
v
u
v
0
2
6
	
(vii)
	
Loop 3: 
−
+
=
v
v
v
0
1
2
3
	
(viii)
	
Loop 4: 
−
+
=
v
v
v
0
1
2
5
	
(ix)
Step 5. Eliminate the auxiliary variables in the state-space shell.
	
=
+
=
+
=
+
−
f
f
f
f
b v
f
b v
v
(
) 
1
3
5
3
1
5
3
1
2
1   (from (iii), (i), and (ix))
	
= −
−
+
+
= −
−
−
+
+
= −
−
−
+
−
−
f
f
b v
f
b v
f
b v
v
f
b v
f
b v
v
f
b v
u
(
)
(
)
(
)
2
3
1
5
4
2
6
3
1
2
1
4
2
6
3
1
2
1
4
2
2
	
(from (iv), (i), (ii), (ix), and (vii))
	
= −
+
v
v
v
3
1
2   (from (viii))

228
Modeling of Dynamic Systems with Engineering Applications
	
= −
+
v
v
u
4
2
  (from (vi)
The following state equations are obtained:
	
(
)
(
)
(
)
(
)
(
)
(
)
(
)
(
)
= −
+
+
=
−
+


−
+
+
= −
+
= −
+
v
b m v
b m v
m
f
v
b m
v
b
b
m
v
m
f
m
f
b
m
u t
f
k v
k v
f
k v
k u t
1
1
1
( )
( )
1
1
1
1
1
1
2
1
3
2
1
2
1
1
2
2
2
2
3
2
4
2
2
3
1
1
1
2
4
2
2
2




These correspond to:
System matrix:
	
=
−
−
+
−
−
−














A
b m
b m
m
b m
b
b
m
m
m
k
k
k
1
0
(
)
1
1
0
0
0
0
0
1
1
1
1
1
1
2
1
2
1
2
2
1
1
2
Input distribution matrix:
	
=














B
b
m
k
0
0
2
2
2
LEARNING OBJECTIVES
	
1.	 Checking the solvability of a dynamic model (i.e., the number of unknown 
variables = the number of independent equations)
	
2.	 Selection of proper state variables
	
3.	 Formulation of the constitutive equations, starting from the state-space shell
	
4.	 Selection of primary loops and identification of primary loops that can be 
skipped in the formulation
	
5.	 Selection of independent (primary) nodes and identification of the indepen-
dent node equations that can be skipped in the formulation
	
6.	 Sign conventions
	
7.	 Systematic development of a state-space model for a mechanical system
◾
Example 5.6
A turbine is used to drive a rotational device through a long shaft and a reduction gear 
unit, as indicated in Figure 5.13.
The turbine may be considered as a velocity source ω t( )
s
. Also
	Tk = torque in the long shaft
	 p = speed reduction ratio (p:1 with p > 1)
	 k = torsional stiffness of the shaft
	 Jl = moment of inertia of the rotational load
	 bl = rotational damping constant at the load
	ωl = angular speed of the load

229
Linear Graphs
	 (a)	 Sketch an oriented linear graph for the system and mark all the parameters 
and variables on it.
	 (b)	 Write the state-space shell equations, remaining constitutive equations, node 
equations, and the loop equations.
	 (c)	 Taking ωl as the output variable, derive a complete state-space model for the 
system. Note: In particular, obtain the matrices A,B,C, and D.
Solution
	 (a)	 The LG is sketched in Figure 5.14.
	 (b)	 State-space shell:
	
ω
ω
=
=
T
k
J
T
k
k
l
l
l


Remaining constitutive equations:
	
ω
ω
= p
1
2
1
	
(i)
	
= −
T
pT
2
1	
(ii)
	
ω
=
T
b
b
l
b	
(iii)
k
Tk
Turbine
(velocity source)
(p : 1)
Step-down
gear
Load
Long shaft
ωs(t)
ωl
jl
bl
FIGURE 5.13
A load driven by a turbine through a long shaft and step-down gear.
Tk, ωk
Tl, ωl
Tb, ωb
T1, ω1
T2, ω2
Ts, ωs(t)
1
p
Jj
k
bl
Loop 1
Loop
   2
Loop
    3
Node 1
+
–
Node 2
Node 3
FIGURE 5.14
Linear graph.

230
Modeling of Dynamic Systems with Engineering Applications
Node equations:
	
−
=
T
T
T
Node 1:
0   (not useful because of 
)
s
k
s 	
(iv)
	
−
=
T
T
Node 2 :
0
k
1
	
(v)
	
−
−
−
=
T
T
T
Node 3 :
0
l
b
2
	
(vi)
Loop equations:
	
ω
ω
ω
−
−
+
=
t
Loop 1: 
( )
0
k
1
s
	
(vii)
	
ω
ω
−
+
=
Loop 2: 
0
l
2
	
(viii)
	
ω
ω
−
+
=
Loop 3: 
0
b
l
	
(ix)
	 (c)	 Eliminate auxiliary variables:
	
ω
ω
ω
ω
ω
ω
ω
=
−
=
−
=
−
p
p
k
s
s
s
l
1
2
  (from (vii), (i), and (viii))
	
ω
ω
= −
−
=
−
=
−
T
T
T
pT
b
pT
b
l
b
l
b
k
l
l
2
1
  (from (vi), (ii), (v), (iii), and (ix))
Note: Node 1 equation is not useful because it contains the dependent variable Ts of 
the A-source.
We have the state equations:
	
ω
ω
=
×
−
T
k
t
p
[
( )
]
k
s
l

	
ω
ω
=
−
J
pT
b
l
l
k
l
l

State vector 
ω
=
x
T
[
,
]
k
l
T
Input 
ω
=
u
t
[
( )]
s
Output 
ω
=
y
[
]
l
State model: =
+
=
+
x
Ax
Bu y
Cx
Du
;

with
	
(
)
( )
=
−
−










=






=
=
A
B
C
D
kp
p
J
b
J
k
0
;
0
;
0 1 ;
0
l
l
l
LEARNING OBJECTIVES
	
1.	 Selection of proper state variables
	
2.	 Formulation of the constitutive equations, starting from the state-space shell
	
3.	 Selection of primary loops
	
4.	 Identification of primary nodes that can be skipped in the formulation
	
5.	 Sign conventions
	
6.	 Systematic development of a state-space model for a mechanical system
◾
Example 5.7
Commercial motion controllers are digitally controlled (using microcontrollers with soft-
ware or digital hardware controllers) high-torque devices that are capable of applying a 
prescribed motion to a system. Such a controlled actuator may be considered as a velocity 

231
Linear Graphs
source. Consider an application where a rotatory motion controller is used to position an 
object, which is coupled through a gear transmission. The system is modeled as in Figure 
5.15a. Develop a state-space model for this system using the linear-graph approach.
Solution
The linear graph of the system is sketched in Figure 5.15b. The steps of the model devel-
opment are given now.
Step 1. It is easy to notice that the two inertia elements m1 and m2 are not independent. 
Together they comprise a single (equivalent) storage element. Thus, along with the stiff-
ness element, there are only two independent energy storage elements. Hence the sys-
tem is second order.
Note: A formal and systematic way to identify such dependent elements is through the 
graph tree approach, which is described in Appendix C.
Let us choose as state variables v1—the across-variable of one of the inertia elements 
(because the other inertia is “dependent”) and f2—the through-variable of the spring.
With 
=
=
x
v
x
f
and
1
1
2
2
State vector 
= 

x
x
v
f
T
T
1
2
1
2
Step 2. The constitutive equations for m1 and k (state-space shell):
	
=
=
v
m f
f
kv
1
;
1
1
2
2


Step 3. The remaining constitutive equations:
	
For damper: 
=
f
bv
3
3	
(i)
	
For the “dependent” inertia m2: 
=
v
m
f
1
4
2
4

	
(ii)
For the transformer (pair of meshed gear wheels):
	
=
v
rv
6
5	
(iii)
	
= −
f
r f
1
6
5	
(iv)
Step 4. Node equations (three independent nodes):
	
−
−
=
f
f
Node 1:
0
6
1
	
(iv)
	
−
−
−
=
f
f
f
f
Node 2 :  
0
2
3
4
5
	
(iv)
	
−
=
f
f
Node 3 :  
0
(not useful)
2
	
(iv)
(a)
(r)
m2
m1
v1
b
u(t)
(b)
Reference
g
r
+
–
k
b
m2
m1
f, u(t)
Loop
1
Loop
2
Loop
3
Loop
4
Node
2
Node
1
Node
3
f2, v2
f5, v5
f1, v1
f6, v6
f4, v4
f3, v3
FIGURE 5.15
(a) Rotary-motion system with a gear transmission and (b) linear graph of the system.

232
Modeling of Dynamic Systems with Engineering Applications
Note: The node 3 equation is not useful because it has the dependent variable f of the 
A-source (which is an auxiliary variable and should not remain in the state equations)
Loop equations (for the four primary loops):
	
−
=
v
v
Loop 1: 
0
6
1
	
(viii)
	
−
=
v
v
Loop 2: 
0
4
5
	
(ix)
	
−
=
v
v
Loop 3 :
0
3
4
	
(x)
	
−
+
−
=
v
u t
v
Loop 4 :
( )
0
2
4
	
(xi)
Step 5. Eliminate the auxiliary variables.
Using equations from steps 3 and 4, the auxiliary variable fl can be expressed as
	
= −
=
=
−
−
=
−
−
=
−
−
=
−
−



=
−
−




f
f
r f
r f
f
f
r f
bv
m v
r f
bv
m v
r
f
b
r v
m
r v
r
f
b
r v
m
r v
1
1(
)
1(
)
1(
)
1
1
1
6
5
2
3
4
2
3
2
4
2
5
2
5
2
6
2
6
2
1
2
1




(obtained by substituting node equations, loop equations, and the additional constitu-
tive equations).
The auxiliary variable v2 can be expressed as
	
=
−
=
−
=
−
= −
+
v
u t
v
u t
v
u t
r v
r v
u t
( )
( )
( )
1
1
( )
2
4
5
6
1
(obtained by substituting node equations, loop equations, and additional constitutive 
equations).
By substituting these equations into the state-space shell we obtain the following two 
state equations:
	
(
)
(
)
= −
+








+
+








= −
+
v
b
m r
m
v
r
m r
m
f
f
k
r v
ku t( )
1
1
2
2
1
1
2
2
2
2
1


Note: The system is second-order; only two state equations are present.
State model: =
+
x
Ax
Bu

The corresponding system matrix and the input-gain matrix (input distribution matrix) 
are
	
=
−
−








= 





A
B
b m
r m
k r
k
0
0
where 
=
+
m
m r
m
1
2
2 = equivalent inertia of ml and m2 when determined at the location of 
the inertia m2.
Note: Strictly, the output equation also should be included in the state model.

233
Linear Graphs
LEARNING OBJECTIVES
	
1.	 Dealing with situations where the energy storage elements are dependent
	
2.	 Selection of proper state variables
	
3.	 Formulation of the constitutive equations, starting from the state-space shell
	
4.	 Selection of primary loops
	
5.	 Identification of primary nodes that can be skipped in the formulation
	
6.	 Sign conventions
	
7.	 Systematic development of a state-space model for a mechanical system
◾
5.7  Linear-Graph Examples in Electrical Domain
In the previous section, we illustrated the use of linear graphs in the modeling of lumped-
parameter mechanical systems—systems with mass/inertia, flexibility, and mechanical 
energy dissipation. In view of the “unified” nature of the approach, the same procedures 
may be extended (in an “analogous” manner) to the other three physical domains (electri-
cal, fluid, and thermal). In this section, we illustrate the use of linear graphs to formulate 
state-space models of electrical dynamic systems. Also, we introduce two practical compo-
nents, amplifier and dc motor, which are useful in electrical, electromechanical, and other 
types of multidomain systems.
Example 5.8
Figure 5.16a shows an electrical circuit with a current source and the passive elements 
L, C, and R.
	 (a)	 Sketch a complete linear graph for this circuit.
	 (b)	 Show that the topological relation =
−
+
l
b
n
1 is satisfied in this linear graph. 
Also, show that the number of unknown variables is equal to the number of 
independent equations that can be written for the linear graph.
	 (c)	 Write the constitutive equations (state-space shell equations and the remain-
ing constitutive equations), loop equations, and node equations. By eliminat-
ing the auxiliary variables, systematically determine a state-space model for 
the system.
Solution
	 (a)	 The linear graph of the circuit is shown in Figure 5.16b.
	 (b)	 Number of loops =
l
3
Number of branches =
b
4
Number of nodes =
n
2
⇒=
−
+
l
b
n
1 is satisfied.
Number of sources =
s
1
Number of unknown variables =
−
=
b
s
2
7
Number of constitutive equations =
−
=
b
s
3
Number of (primary) loop equations = =
l
3
Number of (independent) node equations =
−
=
n
1
1
Total number of equations =
+
+
=
3
3
1
7
⇒ Number of unknowns = number of equations
Hence, the system is solvable.

234
Modeling of Dynamic Systems with Engineering Applications
	 (c)	 Constitutive Equations
	
	 State-space shell:
	
	 Inductor: 
=
L di
dt
v
1
1
	
	 Capacitor: 
=
C dv
dt
i
2
2
	
	 State vector =
x
i v
[ ,
]T
1
2 ; Input vector u
i t
= [ ( )]
	
	 Other constitutive equation:
	
	 Resistor: 
=
v
Ri
3
3
	
	 Loop equations
	
	 Loop 1: −
+
=
v
v
0
2
 (not useful)
	
	 Loop 2: −
+
=
v
v
0
2
1
	
	 Loop 3: −
+
=
v
v
0
3
2
Note: The loop 1 equation is not useful because it has the dependent variable v of 
the T-source (which is an auxiliary variable and should not remain in the state 
equations).
Node equation (Node 2): 
−
−
−
=
i t
i
i
i
( )
0
1
2
3
Eliminate auxiliary variables: 
=
v
v
1
2
	
=
−
−
=
−
−
=
−
−
i
i t
i
i
i t
i
v
R
i t
i
v
R
( )
( )
( )
2
1
3
1
3
1
2
State equations:
	
=
L di
dt
v
1
2
	
= −
−
+
C dv
dt
i
v
R
i t( )
2
1
2
State model: =
+
x
Ax
Bu

	
⇒
=
−
−












=










A
 ; B
L
C
RC
C
0
1
1
1
0
1
Note: Strictly, the output equation also should be in the state model.
(a)
i(t)
R
C
L
i(t), v
(b)
Loop 1
i3 , v3
i2, v2
i1, v1
Loop
2
Loop 3
Node 2
1
L
C
R
FIGURE 5.16
(a) An electrical circuit with a current source and (b) linear graph of the circuit.

235
Linear Graphs
LEARNING OBJECTIVES
	
1.	 Checking the solvability of a dynamic model
	
2.	 Systematic development of a state-space model for an electrical system
	
3.	 Selection of proper state variables
	
4.	 Formulation of the constitutive equations, starting from the state-space shell
	
5.	 Selection of primary loops
	
6.	 Identification of primary loops that can be skipped in the formulation
	
7.	 Sign conventions
◾
5.7.1  Amplifiers
An electrical amplifier is a common component in a practical electrical system. Purely 
mechanical, fluid, and thermal amplifiers have been either developed or envisaged as well. 
Common characteristics of an amplifier are
•	 They accomplish tasks of signal amplification.
•	 They are active devices (i.e., they need external power to operate).
•	 They are not affected (ideally) by the load that they drive (i.e., loading effects are 
negligible).
•	 They have a decoupling effect on the systems (this is a desirable effect that reduces 
the dynamic interactions between components).
The electrical signals: voltage, current, and power are amplified using voltage amplifiers, 
current amplifiers, and power amplifiers, respectively. Operational amplifiers (op-amps) 
are the basic building block in constructing these amplifiers. An op-amp has a very high 
input impedance, low output impedance, and a very high open-loop gain. But, in the open-
loop form, an op-amp is not a practical (stable) device. However, an op-amp with feedback 
provides the desirable characteristics of
•	 Very high input impedance
•	 Low output impedance
•	 Stable operation
For example, due to its impedance characteristics, the output of a good amplifier is not 
affected by the device (load) that is connected to it. Furthermore, due to its high input 
impedance, an amplifier does not distort the signal that is coming into it from an electri-
cal device. In other words electrical loading errors can be greatly reduced by an amplifier.
Analogous to electrical amplifiers, a mechanical amplifier can be designed to provide 
force amplification (a T-type amplifier) or a fluid amplifier can be designed to provide pres-
sure amplification (an A-type amplifier). In these situations, typically, the device is active, 
and an external power source is needed to operate the amplifier (e.g., to drive a combina-
tion of motor and a mechanical load).
Linear-Graph Representation
In its linear-graph representation, an amplifier is considered a Dependent Source element or 
a Modulated Source element. Specifically, the amplifier output depends on (modulated by) 
the amplifier input, and is not affected by the dynamics of the devices that are connected 

236
Modeling of Dynamic Systems with Engineering Applications
to the output of the amplifier (i.e., the load of the amplifier). This is the ideal case. In prac-
tice some loading error will be present (i.e., the amplifier output will be affected by the 
load that it drives).
The linear-graph representations of an A-type amplifier (e.g., voltage amplifier, pres-
sure amplifier) and a T-type amplifier (e.g., current amplifier, force amplifier) are shown 
in Figure 5.17a and b, respectively. The pertinent constitutive equations in the general and 
linear cases are given as well in the figures.
5.7.2  Power-Information Transformer
An amplifier is a power-power transformer. Another transformer that is useful in model-
ing engineering dynamic systems is a power-information transformer. For example, in con-
trol and communication of an engineering system, data streams and control sequences are 
in fact information signals, which are present in sensors, data acquisition systems, control-
lers, and communication networks. On the other hand, the signals in the physical domains 
(mechanical, electrical, fluid, and thermal) are power signals, with associated through-
variables and across-variables. Thus far we have used only the power signals in our linear-
graph models, as these models represent the four specific physical domains. However, to 
incorporate such aspects as sensing, control and communication into an LG model, we 
need means for power-to-information transformation and information-to-power trans-
formation. For this purpose, the concept of modulated source, as in the LG representa-
tion of an amplifier, may be extended. Then we have information sources and power sources 
with power signals (same as those used thus far in our models) and information signals 
(those needed in data acquisition, control, and communication purposes) as their respec-
tive modulating signals. This aspect is revisited in Problem 5.21.
5.7.3  dc Motor
The dc motor is a popular electrical actuator. It converts direct current (dc) electrical energy 
into mechanical energy. The principle of operation is based on the fact that when a conduc-
tor carrying current is placed in a magnetic field, a force is generated (Lorentz’s law). This 
force results from the interaction of two magnetic fields, and is available as the magnetic 
torque at the rotor of the motor.
A dc motor has a stator and a rotor (armature) with windings, which are excited by 
a field voltage vf and an armature voltage va, respectively. The equivalent circuit of a dc 
motor is shown in Figure 5.18a, where the field circuit and the armature circuit are shown 
separately, with the corresponding supply voltages. This is the separately excited case. If the 
+
–
(a)
io,vo(t)
ii, vi
(Linear amplifier)
vo = f (vi)
vo = kvi
(b)
io(t), vo
ii, vi
(Linear amplifier)
io = f (ii)
io = kii
FIGURE 5.17
Linear-graph representation of (a) an A-type amplifier and (b) a T-type amplifier.

237
Linear Graphs
stator filed is provided by a permanent magnet, then the stator circuit that is shown in 
Figure 5.18a is simply an equivalent circuit, where the stator current if can be assumed 
constant. Similarly, if the rotor is a permanent magnet, what is shown in Figure 5.18a is an 
equivalent circuit where the armature current ia can be assumed constant. The magnetic 
torque of the motor is generated by the interaction of the stator field (proportional to if) and 
the rotor field (proportional to ia) and is given by
	
=
T
ki i
m
f a	
(5.14)
A back-electromotive force (back e.m.f.) is generated in the rotor (armature) windings to 
oppose its rotation when these windings rotate in the magnetic field of the stator (Lenz’s 
law). This voltage is given by
	
ω
= ′
v
k i
b
f
m	
(5.15)
where if = field current; ia = armature current; ω m = angular speed of the motor.
Note: For perfect conversion of electrical energy into mechanical energy in the rotor we 
need
	
ω
=
T
i v
m
m
a
b	
(5.16)
This corresponds to an ideal electromechanical transformer.
	
Field circuit equation: 
=
+
v
R i
L di
dt
f
f f
f
f 
(5.17)
where vf = supply voltage to stator; Rf = resistance of the field windings; Lf = inductance of 
the field windings.
	
=
+
+
v
R i
L di
dt
v
Armature (rotor) circuit equation:
a
a a
a
a
b	
(5.18)
where va = armature supply voltage; Ra = armature winding resistance; La = armature leak-
age inductance.
Suppose that the motor drives a load whose equivalent torque is TL. Then, from Figure 5.18b
	
Mechanical (load) equation: 
ω
ω
=
−
−
J
d
dt
T
T
b
m
m
m
L
m
m
(5.19)
where Jm = moment of inertia of the rotor; bm = equivalent (mechanical) damping constant 
for the rotor; TL = load torque.
+
−
+
−
Stator (field circuit)
Rotor (armature circuit)
If
Lf
Rf
La
Tm
TL
ωm
Ra
Ia
va
vf
vb
Load shaft
Damping
Magnetic
torque
Jm
bm
Load
TL
(a)
(b)
Armature
Tm
FIGURE 5.18
(a) Equivalent circuit of a dc motor (separately excited) and (b) armature mechanical loading.

238
Modeling of Dynamic Systems with Engineering Applications
In the field control of the motor, the armature supply voltage va is kept constant and the 
field voltage vf is controlled. In the armature control of the motor, the field supply voltage 
vf is kept constant and the armature voltage va is controlled.
Example 5.9
A classic problem in robotics is the case of a robotic hand gripping and turning a door-
knob to open a door. The mechanism is schematically shown in Figure 5.19a. Suppose 
that the actuator of the robotic hand is an armature-controlled dc motor. The associated 
circuit is shown in Figure 5.19b. The field circuit provides a constant magnetic field 
to the motor, and is not important in the present problem. The armature circuit (with 
motor rotor windings) has a back e.m.f. vb, a leakage inductance La, and a resistance Ra. 
The input signal to the robotic hand is the armature voltage va(t), as shown. The rotation 
of the motor (at an angular speed ω m) in the two systems of magnetic field generates 
a torque Tm (Note: In the LG representation, this torque is negative by convention, as 
marked in Figure 5.19b, because power is considered to be positive when going in at 
either port of the electromechanical transformer). This torque (magnetic torque) is avail-
able to turn the doorknob, and is resisted by the inertia force (with moment of inertia 
Jd), the friction (modeled as a linear viscous damper of damping constant bd) and the 
flexibility (of stiffness kd) of the hand-knob-lock combination. A mechanical model is 
shown in Figure 5.19c. The dc motor may be considered as an ideal electromechanical 
transducer, which is represented by a transformer in the linear graph. The associated 
equations are
	
ω
= k
v
1
m
m
b
	
(5.20)
	
= −
T
k i
m
m b	
(5.21)
Note: As mentioned before, the negative sign in Equation 5.21 arises due to the specific 
sign convention in linear graphs. Specifically, power is assumed to go “into” the elec-
tromechanical transformer at either port. In reality, however, a motor takes in electrical 
power and supplies mechanical power.
The linear graph may be easily drawn, as shown in Figure 5.19d, for the electrical side 
of the system.
Answer the following questions:
	 (a)	 Complete the linear graph by including the mechanical side of the system.
	 (b)	 Give the number of branches (b), nodes (n), and the independent loops (l) in the 
complete linear graph.
	 (c)	 Take the current through the inductor (ia), the speed of rotation of the door 
knob (ω d), and the resisting torque of the spring within the door lock (Tk) as the 
state variables, the armature voltage va(t) as the input variable, and ω d and Tk as 
the output variables. Write the constitutive equations, independent node equa-
tions, and independent loop equations for the completed linear graph. Clearly 
show the state-space shell. Also verify that the number of unknown variables 
is equal to the number of equations obtained in this manner (i.e., the problem 
is solvable).
	 (d)	 Eliminate the auxiliary variables and obtain a complete state-space model for 
the system, using the equations written in Part (c) above.
Solution
	 (a)	 The complete linear graph is shown in Figure 5.20.

239
Linear Graphs
	 (b)	 b = 8, n = 5, l = 4 for this linear graph. It satisfies the topological relationship l = b 
– n + 1
	 (c)	
Constitutive equations:
	
ω
ω
=
=
=









L di
dt
v
J d
dt
T
dT
dt
k
State-space shell
a
a
L
d
d
d
k
d
k
La
Tm
Ra
+
–
va(t)
ωm
Constant
field
Armature circuit
(b)
Input
voltage
vL
ia
vb
vR
(a)
Controller
Robot
hand
Door with
knob
ωm
Tm
(c)
Jd
bd
kd
La
Ra
Tm,  ωm
ia, vL
iR, vR
i, va(t)
+
–
b
b v
i ,
km
1
Electrical side
(complete)
Mechanical side
(incomplete)
Electro-mechanical
transformer
(d)
FIGURE 5.19
(a) Robotic hand turning a doorknob; (b) armature-controlled dc motor of the robotic hand; (c) 
mechanical model of the hand-doorknob system; and (d) incomplete linear graph.
+
_
a
R
1
Jd
kd
Loop
1
Loop
3
Loop
4
Loop
2
Node 1
Node 3
Node 2
Node 4
bd
La
km
Tm, ωm
Tk, ωk
Td, ωd
Tb, ωb
iR, vR
i, va(t)
ia, vL
ib,vb
FIGURE 5.20
The complete linear graph of the system.

240
Modeling of Dynamic Systems with Engineering Applications
Other constitutive equations:
	
=
v
R i
Resistor :
R
a R	
(i)
	
ω
=
T
b
Mechanical damper :
b
d
b	
(ii)
Electromechanical transformer:
	
ω
= k
v
1
m
m
b
	
(iii)
	
= −
T
k i
m
m b	
(iv)
Node equations:
There are five nodes, which provide four independent node equations:
	
−
=
i
i
Node 1:
0
(not used)
R
	
(v)
	
−
=
i
i
Node 2:
0
R
a
	
(vi)
	
−
=
i
i
Node 3:
0
a
b
	
(vii)
	
−
−
−
−
=
T
T
T
T
Node 4:
0
m
d
b
k
	
(viii)
Note: The node 1 equation is not useful because it has the dependent variable i of the 
A-source (which is an auxiliary variable and should not remain in the state 
equations).
Loop equations:
There are four primary loops, generating the independent loop equations:
	
−
−
−
=
v t
v
v
v
Loop 1:
( )
0
a
R
L
b
	
(ix)
	
ω
ω
−
=
Loop 2:
0
m
d
	
(x)
	
ω
ω
−
=
Loop 3:
0
d
b
	
(xi)
	
ω
ω
−
=
Loop 4:
0
d
k
	
(xii)
Note: There are fifteen unknown variables (i, iR, ia, ib, Tm, Td, Tb, Tk, vR, vL, vb, ωm, ωd, ωb, 
ωk) and fifteen equations (including the three shell equations). Specifically,
Number of unknown variables = 2b − s = 2 × 8 − 1 = 15
Number of independent node equations = n − 1 = 5 − 1 = 4
Number of independent loop equations = l = 4
Number of constitutive equations = b − s = 8 − 1 = 7
Check: 15 = 4 + 4 + 7
	 (d)	 Eliminate the auxiliary variables from the sate-space shell, by substitution:
	
ω
ω
=
−
−
=
−
−
=
−
−
v
v t
v
v
v t
R i
k
v t
R i
k
( )
( )
( )
L
a
R
b
a
a a
m
m
a
a a
m
d

241
Linear Graphs
(from (ix), (i), (iii), and (x)
	
ω
ω
= −
−
−
= −
+
−
=
−
−
T
T
T
T
T
k i
b
k i
b
T
d
k
m
b
k
m b
d
b
m a
d
d
k
(from (iv), (ii), (vii), and (xi)
	
ω
ω
=
k
d (from (xii))
Hence, we have the state-space equations:
	
ω
ω
ω
ω
= −
−
+
=
−
−
=
L di
dt
R i
k
v t
J d
dt
k i
b
T
dT
dt
k
( )
a
a
a a
m
d
a
d
d
m a
d
d
k
k
d
d
With
State vector 
ω
=
x
i
T
[
]
a
d
k
T 
Input vector = 

u
v t( )
a
Output vector 
ω
= 

y
T
d
k
T
we have the state-space model
	
x = Ax +Bu
y = Cx + Du

The model matrices are
	
=
−
−
−
−












=










= 





=
A
B
C
D
R
L
k
L
k
J
b
J
J
k
L
0
1
0
0
;
1
0
0
;
0
1
0
0
0
1
;
[0]
a
a
m
a
m
d
d
d
d
d
a
;
OBSERVATIONS
•	 This is a multidomain (electromechanical) model.
•	 Multi-functional devices (e.g., a piezoelectric device that serves as both 
­actuator and sensor) may be modeled similarly, using an electromechanical 
transformer (or, through the use of the “reciprocity principle”).
LEARNING OBJECTIVES
	
1.	 Checking the solvability of a dynamic model
	
2.	 Selection of proper state variables
	
3.	 Formulation of the constitutive equations, starting from the state-space shell
	
4.	 Selection of primary loops
	
5.	 Identification of primary nodes that can be skipped in the formulation

242
Modeling of Dynamic Systems with Engineering Applications
	
6.	Sign conventions
	
7.	Systematic development of a state-space model for an electromechanical (two-
domain) system
◾
5.8  Linear-Graph Examples in Fluid Domain
The linear-graph approach is unified across various physical domains, and hence the same 
approach is applicable in mechanical, electrical, fluid, and thermal domains. Now several 
examples in the fluid domain are given to illustrate the use of linear graphs in the system-
atic development of state-space models.
Example 5.10
A pump supplies water to a tank through a long narrow pipe. The tank is connected to 
a second tank through a short pipe with a valve. There is an outflow valve in the second 
tank. A schematic diagram of the system is shown in Figure 5.21. The pump may be 
considered as a pressure source of absolute pressure P t( )
s
.
The following parameters are given:
	
R = fluid resistance of the long pipe
	
L = fluid inertance of the long pipe
	
C1 = fluid capacitance of the first tank
	
C2 = fluid capacitance of the second tank
	
R1 = fluid resistance of the first valve
	
R2 = fluid resistance of the second valve
	 (a)	 Draw a linear graph for the system.
	 (b)	 Determine a complete state-space model for the system using the state 
variables:
	
QI = volume flow rate through the fluid inertor (I)
	
P1 = gauge pressure at the bottom of Tank 1
	
P2 = gauge pressure at the bottom of Tank 2
Inertance
I
R1
R2
P2
P1
C1
C2
Q4
QI
Water
reservoir
Pump
Resistance
R
Long pipe
Valve 1
Valve 2
Tank 1
Tank 1
Capacitance
Gauge
pressure
Capacitance
Gauge
pressure
Ps(t)
FIGURE 5.21
Two-tank cascade supplied by a single water pump.

243
Linear Graphs
Input variable: P t( )
s
 = outflow pressure of the pump
Output variable: Q4 = volume flow rate through the exit valve
Solution
	  (a) 	
	
	 The system has a single A-type source (P t( )
s
); three independent energy storage 
elements (two A-type elements: fluid capacitors C1 and C2; a T-type element: 
fluid inertor I); and three D-type elements (fluid resistors R, R1 and R2).
	
	 The linear graph of the system is shown in Figure 5.22.
	 (b)	
	
(i)	
Constitutive Equations
	
	
State-space shell: 
	
	
Fluid Intertor: 
=
IQ
P
I
I

	
	
First Tank: 
=
C P
Q
1 1
1

	
	
Second Tank: 
=
C P
Q
2
2
2

	
	 Remaining constitutive equations
	
Fluid Resistance in Long Pipe: 
=
P
RQ
R
R	
(i)
	
First Valve: 
=
P
R Q
3
1
3	
(ii)
	
Second Valve: 
=
P
R Q
4
2
4	
(iii)
	
(ii)	
Node Equations (5 nodes  4 independent nodes)
	
{
−
=
Q
Q
Q
Node 1:
0 Not useful because 
 is the dependent variable of the source
s
R
s
	
−
=
Q
Q
Node 2:
0
R
I
	
(iv)
	
−
−
=
Q
Q
Q
Node 3:
0
I
1
3
	
(v)
	
−
−
=
Q
Q
Q
Node 4:
0
3
2
4
	
(vi)
R1
R2
C1
C2
+
–
R
I
Loop 1
Loop 2
Loop 2
Node 1
Node 2
Node 3
Node 4
Q3, P3
QI, PI
Q2, P2
Q1, P1
Q4, P4
QR, PR
Qs, Ps(t)
FIGURE 5.22
Linear graph of the system.

244
Modeling of Dynamic Systems with Engineering Applications
(iii) Loop Equations
	
−
−
−
+
=
P
P
P
P t
Loop 1:
( )
0
I
R
s
1
	
(vii)
	
−
−
+
=
P
P
P
Loop 2:
0
2
3
1
	
(viii)
	
−
+
=
P
P
Loop 3:
0
4
2
	
(ix)
To obtain the state equations, we eliminate the auxiliary variables in the state-shell 
equations now.
	
=
−
−
=
−
−
=
−
−
P
P t
P
P
P t
P
RQ
P t
P
RQ
( )
( )
( )
I
s
R
s
R
s
I
1
1
1
  (from (vii), (i), and (iv))
	
=
−
=
−
=
−
−
Q
Q
Q
Q
P
R
Q
P
P
R
I
I
I
1
3
3
1
1
2
1
  (from (v), (ii), and (viii))
	
=
−
=
−
=
−
−
Q
Q
Q
P
R
P
R
P
P
R
P
R
2
3
4
3
1
4
2
1
2
1
2
2
  (from (vi), (ii), (iii), (viii), and (ix))
Hence, we have the final state equations:
	
= −
−
+
IQ
RQ
P
P t( )
I
I
s
1

	
=
−
+
C P
Q
P
R
P
R
I
1 1
1
1
2
1

	
=
−
+




C P
P
R
R
R
P
1
1
2
2
1
1
1
1
2

Output equation:
	
=
=
Q
P
R
P
R
4
4
2
2
2
In the matrix-vector form:
	
x
Ax
Bu
=
+

	
y
Cx
Du
=
+
where
	
=
−
−
−
+
























=












=








=
A
B
C
D
R
I
I
C
C R
C R
C R
C
R
R
I
R
1
0
1
1
1
0
1
1
1
1
;
1
0
0
;
0
0
1
;
[0]
1
1
1
1
1
2
1
2
1
1
2
LEARNING OBJECTIVES
	
1.	 Identification of the element types in a fluid system
	
2.	 Selection of proper state variables
	
3.	 Formulation of the constitutive equations, starting from the state-space shell

245
Linear Graphs
	
4.	 Selection of primary loops
	
5.	 Identification of primary nodes that can be skipped in the formulation
	
6.	 Sign conventions
	
7.	 Systematic development of a state-space model for a fluid system
◾
Example 5.11
A liquid input of volume flow rate Q t( )
s
 is supplied to a storage tank (see Figure 5.23). 
The tank, when empty, is uniform and cylindrical with radius ro. The tank wall is flex-
ible. Specially, when a gauge pressure P is exerted at a particular interior location of the 
tank wall, the tank radius at that location stretches from ro to such that 
=
P
kr, where k is 
a known stiffness parameter.
In addition, the following parameters are known:
	
β = bulk modulus of the liquid in the tank
	
ρ = mass density of the liquid
Note: The gauge pressure of the liquid in the tank is not uniform. It varies linearly from 
the highest value (ρgh) at the bottom of the tank to zero at the liquid surface; g = accelera-
tion due to gravity.
It is required to model this dynamic system in order to study its response (liquid level 
h) as a result of the input Q t( )
s
.
With sufficient detail, develop a lumped-parameter dynamic model (state-space 
model) for the system for this purpose.
Note 1: In fact, this is a distributed-parameter system. Since the liquid pressure varies 
from the bottom to the top, we cannot use a single lumped capacitor to represent the 
entire liquid compressibility. Also, we will not be able to use a single lumped capacitor 
to represent the entire flexibility of the tank. We will have to use several lumped ele-
ments for different layers in the tank, in modeling the capacitance. Also, the gravity 
effect (capacitance) has to be included in the model.
Note 2: You may appropriately discretize the system (e.g., different liquid layers in the 
tank) and also introduce other parameters if necessary (in addition to the given param-
eters γ ρ k
r
, , , and
o).
Solution
We discretize the (distributed-parameter) tank into n control volumes (layers), covering 
the entire nominal liquid volume in the tank.
h
Pump
Tank wall
(stiffness = k,
unstretched radius = ro)
Input volume
flow rate = Qs(t)
Liquid
(β, ρ)
FIGURE 5.23
Compressible liquid pumped into a flexible tank against gravity.

246
Modeling of Dynamic Systems with Engineering Applications
SIMPLIFYING ASSUMPTIONS
•	 Within a control volume, the pressure is uniform at the value of the inflow 
pressure.
•	 Radius of the control volume is uniform (but changes its value as the pressure 
changes).
•	 Height of a control volume is pre-selected and does not change with time.
•	 Fluid resistance and fluid inertance are neglected.
Note: Assumptions 1–3 are satisfactory when the height of a control volume is small 
when compared to the height of the liquid column in the tank (i.e., n is sufficiently large) 
and/or when the variations (of the variables and the parameters) from the nominal val-
ues are small. By properly defining the representative (equivalent) pressure in a con-
trol volume, we can remove these assumptions without affecting the general approach 
given below (e.g., by using the average pressure of the inlet and the outlet of a control 
volume as the uniform pressure in that control volume). Assumption 4 can be relaxed 
as well, by incorporating a resistor and an inertor into a control element, albeit leading 
to a more complex model. This is not important in the present formulation, which is pri-
marily used to model a distributed fluid capacitance and to illustrate the basic approach 
modeling (and the use of linear graphs) for the given problem.
The discretized model of the system is represented in Figure 5.24a.
Note: The indicated pressures are gauge pressures (i.e., given with reference to the 
ambient—atmospheric pressure).
Consider the control volume i.
According to the assumption, its pressure is the pressure Pi at the inlet.
From what is given in the problem,
	
=
+
r
r
P
k
Radius
i
o
i
	
(i)
Tank area in the control volume i is, 
π
=
A
r
i
i
2
Volume of the control volume i is 
π
=
V
r h
i
i
i
2
.
Fluid capacitance of the control volume i due to the bulk modulus (compressibility) of 
the liquid (see Chapter 3):
	
β
π
β
=
=
C
V
r h
bulk i
i
i
i
2
	
(ii)
where β = bulk modulus of the liquid.
Fluid capacitance due to the gravity head of the control volume i (see Chapter 3):
	
ρ
π
ρ
=
=
C
A
g
r
g
grav i
i
i
2
	
(iii)
where ρ = mass density of the liquid.
DETERMINATION OF Celas i
To determine the capacitance of the control volume i due to the flexibility (elasticity) of 
the tank, we proceed as follows:
Rate of increase of the space within the control volume i due to stretching of the tank 
π
π
=
=
d
dt
r h
h r dr
dt
(
)
2
i
i
i i
i
2

247
Linear Graphs
Note: hi is a constant but ri changes with Pi.
From (i): 
=
dr
dt
k
dP
dt
1
i
i
→ Rate of increase of volume of the control volume 
π
=
i
h r
k
dP
dt
2
i i
i
	
→ 
π
=
C
h r
k
2
elas i
i i 	
(iv)
A linear graph can be drawn for the dynamic model, as shown in Figure 5.24b.
(a)  
2ri
Qn+1
2ro
Qi+1
Qn
Qi
Q3
Q2
Qs
Q1
Q1 = Qs
rn, An
ri , Ai  
Pn
hn
hi
Pn+1 = (Atmospheric)
Pi+1
Pi
P3
P2
P1
Control volume 1
Cgravi
Cbulki, Celasi
Control volume i
(b)  
C΄n
C΄2
C΄1
Q΄n, Pn
Qn, Pn–1 – Pn
Q3, P2 – P3
Q΄2, P2
Qs, P1
Q΄1, P1
Q2, P1 – P2
P = 0
Qn+1, Pn
Cgravn–1
Cgravn
Cgrav1
(Atmospheric)
FIGURE 5.24
(a) Discretization of the system and (b) linear graph of the discretized model.

248
Modeling of Dynamic Systems with Engineering Applications
Since the same pressure Pi is associated with both the liquid compressibility in the 
control volume i and the stretching of the tank in the control volume i, it is seen that the 
capacitors Cbulk i and Celas i are in parallel. Hence, their combined capacitance is
	
′ =
+
C
C
C
i
bulk i
elas i
Note: From Equations (ii) to (iv) it is clear that all capacitors depend on ri, which 
depends on the variable pressure Pi. Hence the present model is nonlinear. However, an 
­approximate linear model can be given, assuming that the variation in ri (and hence in 
pressure Pi) is small, by using the unstrained value ro for ri. Then
	
π
β
π
ρ
π
=
=
=
C
r h
C
r
g
C
h r
k
;
;
2
bulk i
o
i
grav i
o
elas i
i o
2
2
ANALYTICAL MODEL
The overall analytical model of the system can be expressed as
	
=
C
dP
dt
Q
eq
s
1
The equivalent capacitance Ceq can be determined in terms of the capacitance param-
eters of the discrete layers. This is done as follows, starting from the top (nth) layer:
Since ′
Cn  and Cgrav n are in parallel, their combined capacitance is
	
=
′ +
C
C
C
n
n
grav n
Next, since Cn and 
−
Cgrav n 1 are in series, their combined capacitance is
	
′′
=
+
−
−
−
C
C
C
C
C
n
grav n
n
grav n
n
1
1
1
Proceeding in this manner, we can write
	
=
′
+
′′
′′
=
+
=
′
+
′′
=
+
=
′ +
′′
′′=
+
=
=
′ +
′′
−
−
−
−
−
−
−
−
−
−
−

C
C
C
C
C
C
C
C
C
C
C
C
C
C
C
C
C
C
C
C
C
C
C
C
C
C
C
C
n
n
n
n
grav n
n
grav n
n
n
n
n
grav
grav
grav
grav
eq
1
1
1
2
2
1
2
1
2
2
2
2
"
2
3
2
3
2
2
2
1
1
2
1
2
1
1
1

249
Linear Graphs
LEARNING OBJECTIVES
	
1.	 Discretization of a distributed-parameter fluid system
	
2.	 Selection of proper state variables
	
3.	 Determination of the system structure (i.e., series or parallel connection)
	
4.	 Systematic development of a state-space model for a fluid system using LGs ◾
5.9  Linear-Graph Examples in Thermal Domain
Thermal systems have temperature (T) as the across-variable, which is measured with 
respect to a reference point of the element (i.e., as the temperature difference across the 
element), and heat transfer (flow) rate (Q) as the through-variable. Heat source and tem-
perature source are the two types of source elements of a thermal system. The former is 
more common. The latter may correspond to a large reservoir whose temperature is practi-
cally not affected by heat transfer into or out of it. There is only one type of energy (ther-
mal energy) in a thermal system. Hence there is only one type of energy storage element 
(A-type element or thermal capacitance) with the associated state variable temperature (T). 
There is no T-type energy storage element in a thermal system. These issues have been 
discussed in Chapter 2. Some modeling examples of thermal systems are presented in 
Chapter 3. In this section we discuss examples where linear graphs are used for the state-
space model formulation of thermal systems.
5.9.1  Model Equations
In the state model formulation of a thermal system, we follow the systematic procedure as 
for any other system. Specifically, we write:
	
1.	Constitutive equations (for thermal capacitance and resistance elements)
	
2.	Node equations (the algebraic sum of heat-transfer rate at a node is zero)
	
3.	Loop equations (the algebraic sum of the temperature drop around a closed ther-
mal path is zero).
Finally, we obtain the state-space model by eliminating the auxiliary variables, which 
should not be present in state equations.
Example 5.12
Consider the simplified model of a household hot-water heating system, as shown in 
Figure 5.25. The furnace supplies heat to the water in the tank at the rate Q t( )
s
. This is 
the deliberate input to the system (it is a T-type source). The ambient room temperature 
Ta is variable and it affects the response (output) of the system. This is an unintentional 
input or a disturbance input (it is an A-type source). The water inside the hot-water 
heater has mass M and specific heat c. This water is assumed to be fully mixed and the 
water temperature is assumed uniform at Th. It is a thermal capacitor (A-type element 
C ).
h  The radiator, which provides heat to the room, is a thermal resistor (D-type element 
with thermal resistance Rr). Hot water enters the radiator at temperature Th, transfers 

250
Modeling of Dynamic Systems with Engineering Applications
heat to the room through a temperature difference 
−
T
T
h
a and at a rate Qr, and leaves the 
radiator at temperature To.
	 (a)	 Draw a linear graph for the system.
	 (b)	 Taking Th as the state variable; Q t w
( )
s
 and T t( )
a
 as the inputs; and Qr and To as 
the outputs, determine a complete state-space model for the system.
Given: M = mass of the water in the heater
	 c = specific heat of water
	 m = rate of mass flow of the water into the radiator
	 Rr = thermal resistance of the radiator
Note: The water heater and the piping are fully insulated.
Solution
	 (a) 	
	
	 The system has a T-type source (Q t( )
s
) and an A-type source (T t( )
a
); an A-type 
element (thermal capacitor Ch); and a D-type element (thermal resistor Rr).
	
	 The linear graph of the system is sketched in Figure 5.26a.
Note: The reference temperature is the absolute zero temperature. In this problem, Ta cannot 
be taken as the reference temperature because it is variable externally (unintentionally).
	 (b)	
	
	 (i)  Constitutive Equations
Thermal capacitor (water heater): 
=
C dT
d
Q
h
h
t
h with 
=
C
Mc
h
Thermal resistor (radiator): 
=
T
R Q
r
r
r
	
	 (ii)  Node Equations
	
−
−
=
Q t
Q
Q
( )
0
s
h
r
	
{
+
=
Q
Q
Q
0 Not useful because
is the dependent variable of a source
r
a
a
	
	 (iii)  Loop Equations
	
{
−
+
=
T
T
T
0 Not useful because 
 is the dependent variable of a source
h
s
s
	
−
−
+
=
T t
T
T
( )
0
a
r
h
To determine the final state equation, eliminate the auxiliary variable Qh in the state-
shell equation.
Water
heater
Fully
insulated
Th
Qs (t)
Th
Rr
Qr
To
Ch = Mc
m
m
Fully
insulated
Room temperature Ta (t)
Radiator
Heat
source
FIGURE 5.25
A simplified hot-water heating system.

251
Linear Graphs
	
=
−
=
−
=
−
−
Q
Q t
Q
Q t
T
R
Q t
T
T t
R
( )
( )
( )
( )
h
s
r
s
r
r
s
h
a
r
 State equation: 
= −
+
+
C dT
dt
T
R
Q t
T t
R
( )
( )
h
h
h
r
s
a
r
The output equations are obtained as follows:
	
First output equation: Qr = T
R
r
r
 = 
−
T
T t
R
( )
h
a
r
The second output equation is obtained from the heat flow balance of the radiator (see 
Figure 5.26b): 
	
−
−
=


mcT
mcT
Q
0
n
o
r
	
→
=
−
=
−
−
=
−




+




T
T
Q
mc
T
T
T t
R mc
R mc T
T
R mc
( )
1
1
o
h
r
h
h
a
r
r
h
a
r
Now, with
	
= 

= 

= 

x
u
y
T
Q t T t
Q T
;
( ),
( )
;
,
h
s
a
T
r
o
T
We have
	
=
+
x
Ax
Bu
	
=
+
y
Cx
Du
where
	
= −




=








=
−














=
−
















A
B
C
D
C R
C
C R
R
R mc
R
R mc
1
;
1
1
;
1
1
1
;
0
1
0
1
h
r
h
h
r
r
r
r
r
(a)  
Qs(t), Ts
ChQh, Th
Qr, Tr
Qa, Ta(t)
Rr
+
–
(b)  
Qr
mcTh
mcT0
Radiator
FIGURE 5.26
(a) Linear graph of the hot-water heating system; (b) heat flow rate continuity of the radiator.

252
Modeling of Dynamic Systems with Engineering Applications
LEARNING OBJECTIVES
	
1.	 Identification of the element types in a thermal system
	
2.	 Selection of proper state variables
	
3.	 Formulation of the constitutive equations
	
4.	 Identification of primary loops that can be skipped in the formulation
	
5.	 Identification of independent nodes that can be skipped in the formulation
	
6.	 Systematic development of a state-space model for a fluid system
◾
Example 5.13
A traditional Asian pudding is made by blending roughly equal portions by volume of 
treacle (a palm honey similar to maple syrup), coconut milk, and eggs; flavoring with 
cashew nuts, cloves and cardamoms; and baking in a special oven for about one hour. 
The traditional oven uses charcoal fire in a well-insulated earthen pit as the heat source. 
An aluminum container half filled with water is placed on the fire. A smaller stain-
less steel pot containing the dessert mixture is placed inside the water bath and cov-
ered fully with a metal lid. Both the water and the dessert mixture are well stirred and 
assumed to have uniform temperatures. A simplified model of the oven is shown in 
Figure 5.27a.
Assume that the thermal capacitances of the aluminum water container, dessert pot, 
and the lid are negligible. Also, the following equivalent (linear) parameters and vari-
ables are defined:
Cr = thermal capacitance of the water bath
Cd = thermal capacitance of the dessert mixture
Rr = thermal resistance between the water bath and the ambient air
Rd = thermal resistance between the water bath and the dessert mixture
Rc = thermal resistance between the dessert mixture and the ambient air through 
the covering lid
Tr = temperature of the water bath
Td = temperature of the dessert mixture
(a)
Q
Heat transfer
Charcoal fire
Water
Dessert
mixture
Rc
Td, Cd
Tw, Cw
Rd
Rw
Ta
Tp, Cp
Td
Tw
Rp2
Rp1
(b)
FIGURE 5.27
(a) A simplified model of an Asian dessert oven and (b) An improved model of the dessert pot.

253
Linear Graphs
TS = ambient temperature
Q = heat flow rate from the charcoal fire into the water bath.
	 (a)	 Assuming that Td is the output of the system, develop a complete state-space 
model for the system. What are the system inputs?
	 (b)	 In part (a), suppose that the thermal capacitance of the dessert pot is not neg-
ligible, and is given by Cp. Also, as shown in Figure 5.27b, thermal resistances 
Rp1 and Rp2 are defined for the two interfaces of the pot. Assuming that the pot 
temperature is maintained uniform at Tp show how the state-space model of 
part (a) should be modified to include this improvement. What parameters do 
Rp1 and Rp2 depend on?
	 (c)	 Draw the linear graphs for the systems in (a) and (b). Indicate in the graph only 
the system parameters, input variables, and the state variables.
Solution
	 (a)	 For the water bath:
	
=
−
−
−
−
C dT
dt
Q
R
T
T
R
T
T
1 (
)
1 (
)
w
w
w
w
a
d
w
d
	
(i)
For the dessert mixture:
	
=
−
−
−
C dT
dt
R
T
T
R
T
T
1 (
)
1 (
)
d
d
d
w
d
c
d
a
	
(ii)
Equations (i) and (ii) are the state equations with
	
= 

x
T
T
State vector
,
w
d
T
	
= 

u
Q
T
Input vector
,
a
T
	
= 

y
T
Output vector
d
T
The corresponding matrices of the state-space model are
	
=
−
+




−
+


















=














= 

= 

A
B
C
D
C
R
R
C R
C R
C
R
R
C
C R
C R
1
1
1
1
1
1
1
1
;
1
1
0
1
;
0
1
;
0
0
;
w
w
d
w
d
d
d
d
d
c
w
w
w
d
c
	 (b)	 For the dessert pot:
	
=
−
−
−
C dT
dt
R
T
T
R
T
T
1 (
)
1 (
)
p
p
p
w
p
p
p
d
1
2
	
(iii)

254
Modeling of Dynamic Systems with Engineering Applications
Equations (i) and (ii) have to be modified as
	
=
−
−
−
−
C
dT
dt
Q
R
T
T
R
T
T
1 (
)
1 (
)
w
w
w
w
a
p
w
p
1
	
(i)*
	
=
−
−
−
C dT
dt
R
T
T
R
T
T
1 (
)
1 (
)
d
d
p
w
d
c
d
a
2
	
(ii)**
The system has become third order now, with the state Equations (i)*, (ii)**, and (iii) and 
the corresponding state vector:
	
= 

x
T
T
T
w
d
p
T
However, u and y remain the same as before. Matrices A, B, and C have to be modified 
accordingly.
The resistance Rpi depends on the heat-transfer area Ai and the heat-transfer ­coefficient 
hi. Specifically, 
=
R
h A
1
pi
i
i
	 (c)	 The linear graph for case (a) is shown in Figure 5.28a. The linear graph for case 
(b) is shown in Figure 5.28b.
LEARNING OBJECTIVES
	
1.	 Identification of the elements in a thermal system
	
2.	 Short-cut formulation of the state-space model using a linear graph
	
3.	 Model enhancement by considering ignored effects
◾
5.10  Linear-Graph Examples in Mixed Domains
In the previous sections. we illustrated the use linear graph in the state model formulation 
of lumped-parameter mechanical, electrical, fluid, and thermal systems, using analogous 
+
–
Rc
Rd
Td
Ta
Tw
Cw
Cd
Rw
C
Q
T = 0
(a)
Rc
Rp2
Rp1
Td
Ta
Tw
Tp
Cp
Cw
Cd
(b)
+
−
Q
T = 0
Rw
FIGURE 5.28
Linear graph of the model. (a) The simplified model and (b) the improved model.

255
Linear Graphs
and systematic procedure. Specifically, linear graphs facilitate a unified approach for devel-
oping dynamic models in the mechanical, electrical, fluid, and thermal domains. In view 
of this, linear graphs facilitate as well an integrated procedure to model multidomain sys-
tems (mixed systems) that use a combination of two or more types of physical components 
(mechanical, electrical, fluid, and thermal) in a convenient manner. Mixed-domain exam-
ples include electromechanical or mechatronic systems. In this section, we present several 
examples of the use of linear graphs in the state model formulation of multidomain systems.
Example 5.14
Consider a positioning mechanism, which has an armature-controlled linear dc motor, 
driving a load using a flexible rod, and buffered with a gas-cylinder (shock absorber), 
as shown in Figure 5.29a. A lumped-parameter linear model of the system is shown in 
Figure 5.29b
Given model parameters:
	
Ra = resistance of the armature coil
	
La = leakage inductance of the armature circuit
	
km = force constant of the linear dc motor
	
mm = mass of the linear-moving mass of the armature
	
k = stiffness of the driving rod of the load
	
bm = viscous damping constant of the moving part of the motor
	
mp = mass of the positioned load and the connected piston of the shock absorber
	
C f = fluid capacitance of the shock absorber
	
A = area of the shock-absorber piston
Neglect the friction between the piston and the cylinder.
	 (a)	 Sketch a complete linear graph (LG) for the system model.
	
	 Note: Orient the branches and indicate all the system parameters and branch 
variables (through- and across-variable pairs).
	 (b)	 Derive a complete state-space model systematically using the LG and the fol-
lowing variables:
	
Input = armature input voltage = v t( )
a
(a)
(b)
−
+
Ra
va(t)
La
vm
vp
k
mm
mp
Pc
Cf
km
bm
FIGURE 5.29
(a) A positioning mechanism driven by a linear motor and (b) lumped parameter model.

256
Modeling of Dynamic Systems with Engineering Applications
Output = velocity of the load = vp
State variables:
	
iL = armature current
	
vm = motor speed
	
fk = force in the rod that moves the load
	
vp = speed of the load/piston
	
Pc = pressure in the shock absorber
Note: Give the model matrices A B C
,
,
, and D.
Solution
The LG is shown in Figure 5.30.
STATE-SPACE SHELL:
	
=
L di
dt
v
a
L
L
	
=
m dv
dt
f
m
m
m
	
=
df
dt
kv
k
k
	
=
m dv
dt
f
p
p
p
	
=
C dP
dt
Q
f
c
c
OTHER CONSTITUTIVE EQUATIONS
Armature resistor: 
=
v
R i
R
a R
Motor (electromechanical transformer): =
= −
v
k
v
f
k i
1
;
m
b
m b
Motor mechanical damper: 
=
f
b v
d
m
d
La
Ra
+
iR, vR
i, va(t)
iL, vL
fk, vk
k
f, v
ib, vb
A
mm
km
1
bm
mp
fm, vm
fp, vp
fd, vd
fc, vc
Q, P
Qc, Pc
Cf
1
FIGURE 5.30
Linear graph of the system.

257
Linear Graphs
Mechanical-fluid gyrator: 
=
= −
P
A f
Q
Av
1
;
c
c
NODE EQUATIONS
	
−
=
i
i
i
0
(This is not a useful node equation since it has .)
R
	
−
=
i
i
0
R
L
	
−
=
i
i
0
L
b
	
−
−
−
−
=
f
f
f
f
0
m
d
k
	
−
−
=
−
−
=
f
f
f
Q
Q
0;
0
k
p
c
c
LOOP EQUATIONS
Note: Include branches that will make the algebraic manipulations more efficient 
(e.g., include branches that correspond to A-type energy storage elements and A-type 
sources).
	
−
−
−
=
−
=
−
=
−
−
=
−
=
−
=
v
v
v
v
v
v
v
v
v
v
v
v
v
P
P
0
0
0
0
0
0
a
R
L
b
m
m
d
m
p
k
p
c
c
Eliminate auxiliary variables in the state-space shell:
	
=
−
−
=
−
−
=
−
−
v
v
v
v
v
R i
k v
v
R i
k v
L
a
R
b
a
a R
m
a
a L
m
m
	
= −
−
−
=
−
−
=
−
−
f
f
f
f
k i
b v
f
k i
b v
f
m
d
k
m b
m
d
k
m L
m
m
k
	
=
−
v
v
v
k
m
p
	
=
−
=
−
=
−
f
f
f
f
AP
f
AP
p
k
c
k
k
c
	
= −
=
=
Q
Q
Av
Av
c
c
p
STATE-SPACE MODEL:
	
= −
−
+
L di
dt
R i
k v
v
a
L
a L
m
m
a
	
=
−
−
m dv
dt
k i
b v
f
m
m
m L
m
m
k

258
Modeling of Dynamic Systems with Engineering Applications
	
=
−
df
dt
kv
kv
k
m
p
	
=
−
m dv
dt
f
AP
p
p
k
c
	
=
C dP
dt
Av
f
c
p
Output: vp
	
= 

x
i
v
f
v
P
State vector
L
m
k
p
c
T
	
=
u
v t
Input vector
[
( )]
a
	
=
y
v
Output vector
[
]
p
We have
	
[ ]
=
−
−
−
−
−
−




























=


















= 

=
A
B
C
D
R
L
k
L
k
m
b
m
m
k
k
m
A
m
A
C
L
0
0
0
1
0
0
0
0
0
0
0
1
0
0
0
0
0
;
1
0
0
0
0
;
0
0
0
1
0
;
0
a
a
m
a
m
m
m
m
m
p
p
f
a
LEARNING OBJECTIVES
	
1.	 Identification of the element types
	
2.	 Selection of proper state variables
	
3.	 Formulation of the constitutive equations, starting from the state-space shell
	
4.	 Selection of useful primary loops
	
5.	 Identification of primary nodes that can be skipped in the formulation
	
6.	 Sign conventions
	
7.	 Systematic development of a state-space model for a mixed-domain system ◾

259
Linear Graphs
Example 5.15
A pressure-controlled pump drives a mechanical load using a piston-cylinder hydraulic 
actuator (ram) which is connected to the pump through a long pipe (see Figure 5.31a). 
A hydraulic accumulator of capacitance C f  is used to smoothen any pressure spikes in 
the input to the ram. The input to the overall system is the output pressure P t( )
s
 of the 
pump. The output of the system is the velocity v of the mechanical load. The following 
parameters are given:
	
I f = fluid inertance of the long pipe
	
R f = fluid resistance at the inlet of the ram
	
Cl = fluid capacitance of the ram
	
m = mass of the load
	
k = resisting stiffness on the load
	
b = damping constant of the load motion
	
A = area of the piston of the ram
	 (a)	 Sketch a complete linear graph for the system.
	 (b)	 Show that the topological relation =
−
+
l
b
n
1 is satisfied in the linear graph. 
Also, show that the number of unknown variables is equal to the number of 
independent equations that can be written for the linear graph (i.e., the prob-
lem is solvable).
	 (c)	 Write the constitutive equations (state-space shell equations and the remain-
ing constitutive equations), loop equations, and node equations. By eliminat-
ing the auxiliary variables, determine a complete state-space model for the 
system.
Solution
	 (a)	 A linear graph for the system is shown in Figure 5.31b.
	 (b)	 For the linear graph,
	
	
=
=
=
l
b
n
6,
10, and
5
(a)   
A
Ram
m
b
Rf
Cf
If
Ps(t)
k
v
Pressure-
controlled pump
Fluid
inertor
Fluid
resistor
Mechanical
load
Accumlator
Rf
If
QR, PR
Qc, Pc
Qs, Ps (t)
QI, PI
Q1, P1
f, v
fb, vb
fk, vk
f1, v1
Ql, Pl
k
b
Cl
Cf
M
m
(b)  
FIGURE 5.31
(a) A mechanical load driven by a pump through a ram and (b) linear graph of the system.

260
Modeling of Dynamic Systems with Engineering Applications
Note: The reference node is common to both ports of the gyrator.
Hence, −
+
=
−
+
=
=
b
n
l
1
10
5
1
6
 is satisfied.
Number of sources, =
s
1
Number of unknown variables =
−
=
−
=
b
s
2
20
1
19
Number of constitutive equations =
−
=
−
=
b
s
10
1
9
Number of loop equations = =
l
6
Number of node equations =
−
=
n
1
4
	⇒ Total number of equations =
+
+
=
9
6
4
19
	⇒ Number of unknown variables = Number of equations
Hence, the problem is solvable.
	 (c)	 There are five independent energy storage elements I f, C f, Cl, m, and k.
The state vector =
x
Q
P
P v f
[
,
,
,
,
]
I
C
l
k
T ⇒ fifth-order system
The input vector 
=
u
P t
[
( )]
s
Constitutive equations
State-space shell:
	
=
=
=
=
=





I Q
P
C P
Q
C P
Q
mv
f
f
kv
f
I
I
f
C
C
l
l
l
k
k
Remaining constitutive equations:
	
=
P
R Q
R
f
R
	
=
f
bv
b
b
	
=
v
MQ
1
1
	
= −
f
M P
1
1
	
with 
=
M
A
1
Loop equations
Note: Pick loops that have independent A-type elements and the A-source (which 
generally provide variables that should be retained in the state-space model).
	
−
−
+
=
−
−
+
=
−
+
=
−+
=
−
+
=
−
+
=
P
P
P t
P
P
P
P
P
v
v
v
v
v
v
( )
0
0
0
0
0
0
C
I
s
l
R
C
l
k
b
1
1

261
Linear Graphs
Node equations
	
−
=
−
−
=
−
−
=
−
−
−
−
=
Q
Q
Q
Q
Q
Q
Q
Q
Q
f
f
f
f
0
(not a useful equation because it contains
)
0
0
0
S
I
S
I
R
C
R
l
k
b
1
1
Eliminate auxiliary variables:
	
= −
+
P
P
P t( )
I
C
s
	
=
−
=
−
=
−
−
Q
Q
Q
Q
P
R
Q
P
P
R
(
)
C
I
R
I
R
f
I
C
l
f
	
=
−
=
−
=
−
−
Q
Q
Q
P
R
M v
P
P
R
M v
1
(
)
1
l
R
R
f
c
l
f
1
1
1
	
= −
−
−
=
−
−
=
−
−
f
f
f
f
M P
f
bv
M P
f
bv
1
1
k
b
k
b
l
k
1
1
	
=
v
v
k
State equations:
	
= −
+

I Q
P
P t( )
f
I
c
s
	
=
−
+

C P
Q
P
R
P
R
f
c
I
c
f
l
f
	
=
−
−

C P
P
R
P
R
v
M
l
l
c
f
l
f
	
=
−
−

mv
P
M
bv
f
l
k
	
=
f
kv
k
The output vector 
=
y
v
[ ]
Expressing in the vector-matrix form of the sate-space model:
	
=
+
=
+
x
Ax
Bu
y
Cx
Du

262
Modeling of Dynamic Systems with Engineering Applications
We have
	
=
−
−
−
−
−
−




























=


















A
B
I
C
R C
R C
R C
R C
MC
mM
b
m
m
k
I
0
1
0
0
0
1
1
1
0
0
0
1
1
1
0
0
0
1
1
0
0
0
0
;
1
0
0
0
0
f
f
f
f
f
f
f
l
f
l
l
f
 
	
= 

=
C
D
0
0
0
1
0
;
[0]
LEARNING OBJECTIVES
	
1.	 Identification of the element types in a system
	
2.	 Checking the solvability of a dynamic model
	
3.	 Selection of proper state variables
	
4.	 Formulation of the constitutive equations, starting from the state-space shell
	
5.	 Selection of convenient primary loops
	
6.	 Identification of primary nodes that can be skipped in the formulation
	
7.	 Sign conventions
	
8.	 Systematic development of a state-space model for a mixed-domain system ◾
Summary Sheet
Characteristics and Advantages of Linear Graphs (LGs): (1) Applicable for lumped-
parameter engineering dynamic systems; (2) line segments (branches) represent model 
elements; (3) interconnecting branches at “nodes”  model structure (graphical represen-
tation)  structure visualization before model formulation; (4) LGs facilitate an integrated 
(i.e., concurrent  all physical domains can be represented in a single LG and analyzed 
together) methodology for multidomain systems; (5) LGs facilitate a unified (i.e., analogous 
methodology is used in multiple domains) modeling approach; (6) the model structure is 
retained across domain  interconnected components in one domain and similarly inter-
connected analogous elements in another domain have the same LG; (7) identify similari-
ties (in domain, structure, behavior, etc.); (8) facilitate the development of computer-based 
modeling tools and software (systematic, unified, graphical); and (9) multi-functional 
devices are modeled conveniently (e.g., a piezoelectric device, which can function as both 
a sensors and an actuator, can be represented simply by a reversible source)
Conventions: (1) Single port  one line segment (branch)  one end is point of action and 
the other end is point of reference; (2) Through-variable f is the same at action point and ref-
erence point; across-variable differs (difference  value relative to reference point = across-
variable v); (3) Pair (f,v) is shown on one side of the branch. Their relationship (constitutive 
relation) can be linear or nonlinear; element parameter is shown on the other side of the 

263
Linear Graphs
branch; (4) Power flow p = [through-variable] × [across-variable]. At action point, f and p 
(power flow in) are positive in the same direction; at reference point, power flows out 
(direction of f at reference is determined by this); positive direction of power flow p is 
shown by arrow on LG branch (oriented branch); (5) Difference in the energy flows at 
action and reference is either stored (A-type and T-type, with capacity to do work) or dis-
sipated (D-type)
Port: Power port  represented by one branch (single-port element)
Decoupling: Components in series with T-source or parallel with A-source have no 
dynamic interaction
Two-port Elements: Transformer: 
=
v
r v
o
i, 
= −
f
r f
1
o
i; Gyrator: 
=
v
Mf
o
i, 
= −
f
M v
1
o
i
Compatibility (Loop) Equations: Algebraic sum of across-variables around a loop = 0  
no variable discontinuity (incompatibility) around a loop. Note: (1) Go in counter-clockwise 
(ccw) direction of loop; (2) Across-variable drops in branch arrow direction of a branch 
arrow  across-variable is positive. Exception: T-source  arrow direction is increasing 
direction of across-variable (still, it is the +ve direction of power flow); (3) Primary loop set 
is a “minimal” and “independent” set:  (a) Any other loop can be formed by combining 
the loops in this set; (b) No loop in the set can be formed by combining the remaining 
loops in the set; (4) Primary loops provide all the independent loop equations; (5) Best 
choice of primary loops will include A-type energy storage elements (providing A-type 
state variables) and A-sources (providing A-type input variables)  minimizes the mathe-
matical manipulations in state equation generation (i.e., in eliminating auxiliary variables); 
(6) All primary loops (loop equations) may not be useful in the development of a state 
model (e.g., ignore loop with T-source because its across-variable is an auxiliary variable, 
which should not be in state equations)
Continuity (Node) Equations: Algebraic sum of through-variables at a junction = 0  
Mechanical Systems: Force balance, equilibrium equation, Newton’s third law, etc.; 
Electrical Systems: Current balance, Kirchoff’s current law, conservation of charge, etc.; 
Hydraulic Systems: Conservation of fluid; Thermal Systems: Conservation of thermal 
energy. Note: (1) LG with n nodes  n − 1 primary (independent) node equations (remain-
ing node equation = algebraic sum of first n − 1 node equations); (2) All primary node equa-
tions may not be useful in the development of a state model (e.g., node equation with an 
A-source, because its through-variable is an auxiliary variable, which should not be in 
state equations)
Sketching of a Linear Graph: (1) Identify energy storage elements, energy dissipation 
elements, and source elements in system (single-port elements, each represented by one 
branch); (2) Identify multi-port elements (e.g., transformers, gyrators); (3) Recognize how 
elements (branches) are interconnected (series or parallel and to what elements) and sketch 
a schematic diagram (e.g., circuit diagram)  parent graph of LG; (4) Starting from a con-
venient node point (typically, the ground reference) draw a branch (typically, for a source), 
link it to another appropriate branch through a node (action point of linked branch) and 
so on, to form a loop; (5) Repeat Step 4 until the entire system is completed (i.e., all system 
elements are included and connected); (6) Orient (with an arrow) each LG branch (this 
may have been done in an earlier step); (7) Write through-across variable pair on one side 
of each branch and element parameter on the other side (this may have been done in an 
earlier step)
Steps for State Model from LG: (1) Choose as state variables: across-variables for 
­independent A-type elements and through-variables for independent T-type elements; 
(2) Write constitutive equations for independent energy storage elements  state-space 

264
Modeling of Dynamic Systems with Engineering Applications
shell. Note: If dependent elements cannot be identified at this stage, you may write con-
stitutive equations for all the energy storage elements (Graph tree approach in Appendix 
C gives a formal way to identify dependent elements); (3) Write constitutive equations for 
remaining elements (dependent energy storage elements, dissipation—D-type elements, 
two-port elements, etc.); (4) Write compatibility equations for primary loops. Note: If a pri-
mary loop equation is not useful, you may skip it; (5) Write continuity equations for pri-
mary (independent) nodes (= total number of nodes − 1). Note: If a primary node equation 
is not useful, you may skip it; (6). In the state space shell, retain state variables and input 
variables only. Eliminate all other variables (auxiliary variables) using loop and node equa-
tions and additional constitutive equations
LG Topological Relation: ℓ = b − n + 1; Number of nodes = n; Number of branches = b; 
Number of primary loops = ℓ; Number of sources = s; Number of constitutive equa-
tions = b − s; Number of loop (compatibility) equations = ℓ; Number of node (continuity) 
equations = n − 1  Total number of equations = b − s + ℓ + n − 1 = 2b − s = number of ­variables  
problem is solvable
Problems
5.1	
Select the correct answer for each of the following multiple-choice questions:
	
i.	 A through-variable is characterized by
	
(a)	 being the same at both ends of the element
	
(b)	 being listed first in the pair written on an LG branch
	
(c)	 requiring no reference value
	
(d)	 all the above
	
ii.	 An across-variable is characterized by
	
(a)	 the value difference between action and reference points
	
(b)	 being listed second in the pair written on an LG branch
	
(c)	 requiring a reference point
	
(d)	 all the above
	
iii.	 Which of the following could be a through-variable?
	
(a)	 pressure
	
(b)	 voltage
	
(c)	 force
	
(d)	 all the above
	
iv.	 Which of the following could be an across-variable?
	
(a)	 motion (velocity)
	
(b)	 fluid flow
	
(c)	 current
	
(d)	 all the above

265
Linear Graphs
	
v.	 If angular velocity is selected as an element’s across-variable, the accompany-
ing through-variable is
	
(a)	 force
	
(b)	 flow
	
(c)	 torque
	
(d)	 distance
	
vi.	 The equation written for through-variables at a node is called
	
(a)	 a continuity equation
	
(b)	 a constitutive equation
	
(c)	 a compatibility equation
	
(d)	 all the above
	
vii.	 The functional relation between a through-variable and its across-variable of 
an LG branch is called
	
(a)	 a continuity equation
	
(b)	 a constitutive equation
	
(c)	 a compatibility equation
	
(d)	 a node equation
	
viii.	 The equation that equates the algebraic sum of across-variables in a loop to 
zero is known as
	
(a)	 a continuity equation
	
(b)	 a constitutive equation
	
(c)	 a compatibility equation
	
(d)	 a node equation
	
ix.	 A node equation is also known as
	
(a)	 an equilibrium equation
	
(b)	 a continuity equation
	
(c)	 the balance of through-variables at the node
	
(d)	 all the above
	
x.	 A loop equation represents
	
(a)	 compatibility of across-variables
	
(b)	 continuity of through-variables
	
(c)	 a constitutive relationship
	
(d)	 all the above
5.2	
A linear graph has ten branches, two sources, and six nodes.
	
i.	 How many unknown variables are there?
	
ii.	 What is the number of independent loops?
	
iii.	 How many inputs are present in the system?

266
Modeling of Dynamic Systems with Engineering Applications
	
iv.	 How many constitutive equations could be written?
	
v.	 How many independent continuity equations could be written?
	
vi.	 How many independent compatibility equations could be written?
	
vii.	 Do a quick check on your answers.
5.3	
The circuit shown in Figure P5.3 has an inductor L, a capacitor C, a resistor R, and 
a voltage source v(t). Follow the systematic steps to obtain the state equations. 
Specifically, sketch the linear graph denoting the currents through and the volt-
ages across the elements L, C, and R by (fl, vl), (f2, v2), and (f3, v3), respectively. Then, 
proceed in the usual manner.
	
i.	 What are the state variables, and what are the system matrix A and the input 
distribution matrix B for your choice of state variables?
	
ii.	 What is the order of the system?
	
iii.	 Briefly explain what happens if the voltage source v(t) is replaced by a current 
source i(t).
	
	 Note: The fact that L is analogous to a spring, C is analogous to an inertia, R is 
analogous to a viscous damper, and a voltage source is analogous to a velocity 
source may be used to solve the analogous mechanical-domain problems.
5.4	
Consider an automobile traveling at a constant speed on a rough road, as sketched 
in Figure P5.4a. The disturbance input due to road irregularities can be considered 
as a velocity source u(t) at the tires in the vertical direction. An approximate one-
dimensional model (one-quarter model) shown in Figure P5.4b may be used to 
study the “heave” (up and down) motion of the automobile. Note that v1 and v2 are 
the velocities of the lumped masses m1 and m2, respectively.
	
(a)	 Briefly state what physical components of the automobile are represented by 
the model parameters k1, m1, k2, m2, and b2. Also, discuss the validity of the 
assumptions that are made in arriving at this model.
	
(b)	 Draw a linear graph for this model, orient it (i.e., mark the directions of the 
branches), and completely indicate the system variables and parameters.
	
(c)	 By following the step-by-step (systematic) procedure of writing constitutive 
equations, node equations, and loop equations, develop a complete state-space 
model for this system. The outputs are v1 and v2. What is the order of the system?
	
(d)	 Instead of the velocity source u(t), a force source f(t) is applied at the same 
location, and is considered as the system input. Draw a linear graph for this 
modified model. Obtain the state equations for this modified model. What is 
the order of the system now?
v(t)
–
+
L
C
R
FIGURE P5.3 
An electrical circuit.

267
Linear Graphs
	
	 Note: In this problem, you may assume that the gravitational effects are completely 
balanced by the initial compression of the springs with reference to which all the 
motions are defined.
5.5
	
(a)	 List several advantages of using linear graphs in the development of a state-
space model of a dynamic system.
	
(b)	 Electrodynamic shakers are commonly used in the dynamic testing of prod-
ucts. One possible configuration of a shaker/test-object system is shown in 
Figure P5.5a. A simple, linear, lumped-parameter model of the mechanical sys-
tem is shown in Figure P5.5b.
	
	 The driving motor (actuator) is represented by a torque source Tm. Also, the follow-
ing parameters are indicated:
Jm = equivalent moment of inertia of motor rotor, shaft, coupling, gears, and the 
shaker platform
r1 = pitch circle radius of the gear wheel attached to the motor shaft
r1 = pitch circle radius of the gear wheel rocking the shaker platform
l = lever arm from the center of the rocking gear to the support location of the test 
object
mL = equivalent mass of the test object and its support fixture
kL = stiffness of the support fixture
bL = equivalent viscous damping constant of the support fixture
ks = stiffness of the suspension system of the shaker table
bs = equivalent viscous damping constant of the suspension system
(a)
(b)
Reference 
Road surface
Forward speed
(constant)
Heave motion
k1
u(t)
v1
Ground reference
m1
m2
v2
k2
b2
FIGURE P5.4 
(a) An automobile traveling at constant speed and (b) a crude model of the automobile for the heave motion 
analysis.

268
Modeling of Dynamic Systems with Engineering Applications
	
	 Since the inertia effects are lumped into equivalent elements, it may be assumed 
that the shafts, gearing, platform, and the support fixtures are light. The following 
variables are of interest:
ωm = angular speed of the drive motor
vL = vertical speed of motion of the test object
fL = equivalent dynamic force of the support fixture (force in spring kL)
fs = equivalent dynamic force of the suspension system (force in spring ks)
	
i.	 Obtain an expression for the motion ratio:
	
=
r
vertical movement of the shaker table at the test object support location
angular movement of the drive motor shaft
	
ii.	 Draw a linear graph to represent the dynamic model
	
iii.	 Using 
ω
= 

x
f
f
v
,
,
,
m
s
L
L
T as the state vector, 
[
]
=
u
Tm  as the input,
	
	
and = 

y
v
f
L
L
T as the output vector, systematically obtain a complete
	
	
state-space model for the system. For this purpose, you must use the linear 
graph drawn in Part (ii).
(a)
(b)
Drive
oscillator
Gearing
Test object
Support fixture
Shaker
platform
dc motor
Jm
Tm
m
ω
Motor
2r1
Gearing
2r2
ks
bs
mL
vL
kL
bL
Test
object
Suspension
Table
Support
fixture
l
FIGURE P5.5 
(a) A dynamic-­testing system and (b) a model of the dynamic testing system.

269
Linear Graphs
5.6	
A robotic sewing system consists of a conventional sewing head. During operation, 
a panel of fabric is fed by a robotic hand into the sewing head. The sensing and con-
trol system of the robotic hand ensures that the seam is accurate and the cloth ten-
sion is correct in order to guarantee the quality of the stitch. The sewing head has a 
frictional feeding mechanism, which pulls the fabric in a cyclic manner away from 
the robotic hand, using a toothed feeding element. When there is slip between the 
feeding element and the fabric, the feeder functions as a force source and the applied 
force is assumed cyclic with a constant amplitude. When there is no slip, however, 
the feeder functions as a velocity source, which is the case during normal operation. 
The robot hand has inertia. There is some flexibility at the mounting location of the 
hand on the robot. The links of the robot are assumed rigid and some of its joints 
can be locked, when desired, to reduce the number of degrees of freedom.
	
	 Consider the simplified case of a single-degree-of-freedom robot. The correspond-
ing robotic sewing system is modeled as in Figure P5.6. Here the robot is modeled 
as a single moment of inertia Jr, which is linked to the hand with a light rack-and-
pinion device whose speed transmission parameter is given by:
	
= r
Rack translatory movement
Pinion rotatory movement
	
	 The drive torque of the robot is Tr and the associated rotatory speed is ωr. Under 
conditions of slip, the feeder input to the cloth panel is force ff . With no slip, the 
input is the velocity vf. Various energy dissipation mechanisms are modeled as 
linear viscous dampers of damping constant b (with corresponding subscripts). 
The flexibility of various system elements is modeled by linear springs with stiff-
ness k. The inertia effects of the cloth panel and the robotic hand are denoted by 
the lumped masses mc and mh, respectively, having velocities vc and vh, as shown 
in Figure P5.6.
	
	 Note: The cloth panel is normally in tension with tensile force fc. In order to push 
the panel, the robotic wrist is normally in compression with compressive force fr.
	
	 First, consider the case of the feeding element with slip:
	
(a)	 Draw a linear graph for the model shown in Figure P5.6, orient the graph, and 
mark all the element parameters through-variables and across-variables on the 
graph.
bh
mh
m
ω
kr
bc
(Normally
compressed)
Hand
Robot
mc
br
kc
fc
fr
ff, vf
Feeder
element
Cloth panel
vc
Jr
Rack
Pinion
Tr
vh
(Normally
tensioned)
FIGURE P5.6 
A robotic sewing system.

270
Modeling of Dynamic Systems with Engineering Applications
	
(b)	 Write all the constitutive equations (element physical equations), independent 
node equations (continuity), and independent loop equations (compatibility). 
What is the order of the model?
	
(c)	 Develop a complete state-space model for the system. The outputs are taken as 
the cloth tension fc and the robot speed ω r, which represent the two variables 
that have to be measured to control the system. Obtain the model matrices A, 
B, C, and D.
	
	 Now, consider the case where there is no slip at the feeder element:
	
(d)	 What is the order of the system now? How is the linear graph of the model mod-
ified for this situation? Accordingly, modify the state-space model obtained 
earlier to represent the present situation and from that obtain the new model 
matrices A, B, C, and D.
	
(e)	 Generally comment on the validity of the assumptions made in obtaining the 
model shown in Figure P5.6 for a robotic sewing system.
5.7	
Suppose that a linear graph has the following characteristics:
n = number of nodes
b = number of braches (segments)
s = number of sources
l = number of independent loops
	
	 Carefully explaining the underlying reasons, answer the following questions 
regarding this linear graph:
	
(a)	 From the topology of the linear graph show that l = b – n + 1
	
(b)	 What is the number of continuity equations required (in terms of n)?
	
(c)	 What is the number of lumped elements including source elements in the 
model (expressed in terms of b and s)?
	
(d)	 What is the number of unknown variables, both state and auxiliary, (expressed 
in terms of b and s)? Verify that this is equal to the number of available equa-
tions, and hence the problem is solvable.
5.8	
An approximate model of a motor-compressor combination used in a process con-
trol application is shown in Figure P5.8.
bm
Jm
Tm
k
bc
(Viscous)
(Viscous)
Tc
Drive shaft
ωm
ωc
Motor rotor
Compressor
Jc
FIGURE P5.8 
A model of a motor-­compressor unit.

271
Linear Graphs
	
	 Note that T, J, k, b, and ω denote torque, moment of inertia, torsional stiffness, 
angular viscous damping constant, and angular speed, respectively, and the sub-
scripts m and c denote the motor rotor and compressor impeller, respectively.
	
(a)	 Sketch a translatory mechanical model that is analogous to this rotatory 
mechanical model.
	
(b)	 Draw a linear graph for the given model, orient it, and indicate all necessary 
variables and parameters on the graph.
	
(c)	 By following a systematic procedure and using the linear graph, obtain a com-
plete state-space representation of the given model. The outputs of the system 
are compressor speed ωc and the torque T transmitted through the drive shaft.
5.9	
A model for a single joint of a robotic manipulator is shown in Figure P5.9. The 
usual notation is used. The gear inertia is neglected and the gear reduction ratio is 
taken as 1 : r (Note: r < 1).
	
(a)	 Draw a linear graph for the model, assuming that no external (load) torque is 
present at the robot arm.
	
(b)	 Using the linear graph derive a state model for this system. The input is the 
motor magnetic torque Tm and the output is the angular speed ωr of the robot 
arm. What is the order of the system?
	
(c)	 Discuss the validity of various assumptions made in arriving at this simplified 
model for a commercial robotic manipulator.
5.10	 Consider the rotatory electromechanical system with feedback control, shown 
schematically in Figure P5.10a. The load has inertia J, stiffness K, and equivalent 
viscous damping B, as shown. The armature circuit for the dc fixed field motor is 
shown in Figure P5.10b.
	
	 For a dc motor, the following relations hold (see Figure P5.10 for the nomenclature):
ω
=
v
K
The back e.m.f.
b
V
m
−
=
T
K i
The motor magnetic torque
T
T
bm
Jm
Tm
ωm
ωr
k
(Viscous)
Motor
1:r
Gear box
(light)
Jr
Robot arm
FIGURE P5.9 
A model of a single-degree-­of-­freedom robot.

272
Modeling of Dynamic Systems with Engineering Applications
	
	 Note: The –ve sign in the second equation originates from the linear-graph conven-
tion for a transformer, where energy is considered to flow into the transformer at 
either port (branch) whereas in the actual case, energy flows in at the input port 
and flows out at the output port.
	
	 For ideal electromechanical energy conversion of a dc motor, with consistent units, 
we have 
=
K
K
V
T.
	
(a)	 Identify the system inputs.
	
(b)	 Give an equivalent translatory model for the system. Write the linear system 
equations. Sketch its linear graph. Using that, obtain a state model for the 
system.
5.11
	
(a)	 What is the main physical reason for natural oscillatory behavior in a purely 
fluid system?
	
	 Why do purely fluid systems with large tanks connected by small-diameter pipes 
rarely exhibit an oscillatory response?
(a)
(b)
vm
vb
ω = θ
θm, ωm
ωl
i
R
L
dc motor
Kv, KT
Power
ampliﬁer
Ka
Tachometer
Kt
vr
va
vm
B
K
J
Tm
–
Load
torque
Tl
Gear
ratio r 
Output speed
Input speed
FIGURE P5.10 
(a) A rotatory electromechanical system and (b) the armature circuit.

273
Linear Graphs
	
(b)	 Two large tanks whose bottoms are connected by a thin horizontal pipe are 
shown in Figure P5.11a. Tank 1 receives an inflow of liquid at the volume rate 
Qi when the inlet valve is open. Tank 2 has an exit valve, which has a fluid flow 
resistance of Re and a flow rate of Qe when opened. The connecting pipe also 
has a valve, and when opened, the combined fluid flow resistance of the valve 
and the thin pipe is Rp. The following parameters and variables are defined:
C1, C2 = fluid (gravity head) capacitances of tanks 1 and 2
ρ = mass density of the fluid
Inlet valve
Qi
Qi
Qp
Rp
P1
P2
H1
H2
C1
C2
P0
P0
Exit valve
Re
Qe
P0
Tank 1
Tank 2
Connecting
valve
(a)
(b)
Connecting
valve
Tank 1
P0
P1
H1
C1
Rp
Qp
P2
H2
C2
P0
Exit valve
Re
Qe
P0
Tank 2
FIGURE P5.11 
(a) An interacting two-­tank fluid system and (b) a non-­interacting two-­tank fluid system.

274
Modeling of Dynamic Systems with Engineering Applications
g = acceleration due to gravity
P1, P2 = pressures at the bottom of tanks 1 and 2
P0 = ambient pressure
	
	 Sketch a linear graph for this system. Using P10 = P1 – P0 and P20 = P2 – P0 as the 
state variables, and the liquid levels H1 and H2 in the two tanks as the output vari-
ables, systematically derive a complete, linear, state-space model for the system 
(by using the linear graph).
	
(c)	 Suppose that the two tanks are as in Figure P5.11b. Here, Tank 1 has an exit 
valve at its bottom whose resistance is Rt and the volume flow rate is Qt when 
open. This flow directly enters Tank 2 without a connecting pipe. The remain-
ing tank characteristics and the parameters are the same as in Part (b).
	
	 Sketch a suitable linear graph for this modified system. Using it, derive a state-
space model for the system in terms of the same variables as in Part (b).
5.12	 Give reasons for the common experience that in the flushing tank of a household 
toilet, some effort is needed to move the handle for the flushing action but virtu-
ally no effort is needed to release the handle at the end of the flush.
	
	 A simple model for the valve movement mechanism of a household flushing tank 
is shown in Figure P5.12. The overflow tube on which the handle lever is hinged 
is assumed rigid. Also, the handle rocker is assumed light, and the rocker hinge is 
assumed frictionless.
lh
lv
f(t)
Hinge
(frictionless)
Handle
(light)
Overflow tube
(rigid)
Lift rod
Valve flapper
(equivalent mass m)
Valve spring
(stiffness k)
Valve damper
(nonlinear)
x, v
FIGURE P5.12 
Simplified model of a toilet-­flushing mechanism.

275
Linear Graphs
	
	 The following parameters are indicated in the figure:
	
=
r
l
l
v
h
 = the lever arm ratio of the handle rocker
m = equivalent lumped mass of the valve flapper and the lift rod
k = stiffness of spring action on the valve flapper
	
	 The damping force fNLD on the valve is assumed quadratic and is given by
	
=
f
a v
v
NLD
VLD
VLD
	
	 where the positive parameter a is defined as follows:
a = au for upward motion of the flapper (vNLD ≥ 0)
a = ad for downward motion of the flapper (vNLD < 0)
	
	 with 
≫
a
a
u
d
	
	 The force applied at the handle is f(t), as shown.
	
	 We are interested in studying the dynamic response of the flapper valve. Specially, 
the valve displacement x and the valve speed v are considered outputs, as shown 
in Figure P5.12.
	
	 Note: x is measured from the static equilibrium point of the spring where the 
weight mg is balanced by the spring force.
	
(a)	 By defining appropriate through-variables and across-variables, draw a linear 
graph for the system shown in Figure P5.12. Clearly indicate the power flow 
arrows.
	
(b)	 Using the valve speed and the spring force as the state variables, systemati-
cally develop a (nonlinear) state-space model for the system, with the aid of 
the linear graph. Specifically, start with all the constitutive, continuity, and 
compatibility equations, and eliminate the auxiliary variables, to obtain the 
state-space model.
	
(c)	 Linearize the state-space model about an operating point where the valve 
speed is v. For the linearized model, obtain the model matrices A, B, C, and D, 
in the usual notation. The incremental variables xˆ  and vˆ are the outputs in the 
linear model, and the incremental variable f t
ˆ( ) is the input.
	
(d)	 From the linearized state-space model, derive the input–output model (differ-
ential equation) relating f t
ˆ( ) and xˆ.
5.13	 A common application of dc motors is in accurate positioning of a mechanical 
load. A schematic diagram of a possible arrangement is shown in Figure P5.13. The 
actuator of the system is an armature-controlled dc motor. The moment of inertia 
of its rotor is Jr and the angular speed is ω r. The mechanical damping of the motor 
(including that of its bearings) is neglected in comparison to that of the load.
	
	 The armature circuit is also shown in Figure P5.13, which indicates a back e.m.f. 
vb (due to the motor coil rotation in the stator field), a leakage inductance La, and 
a resistance Ra. The current through the leakage inductor is iL. The input signal 
is the armature voltage va(t) as shown. The interaction of the rotor magnetic field 
and the stator magnetic field (Note: The rotor field rotates at an angular speed ω m) 
generates a “magnetic” torque Tm, which is exerted on the motor rotor.

276
Modeling of Dynamic Systems with Engineering Applications
	
	 The stator provides a constant magnetic field to the motor, and is not important 
in the present problem. The dc motor may be considered as an ideal electrome-
chanical transducer, which may be represented by a linear-graph transformer. The 
associated constitutive equations are
	
ω
= k v
1
m
m
b
	
= −
T
k i
m
m b
where km is the torque constant of the motor.
	
	 Note: The negative sign in the second equation arises due to the specific sign con-
vention used for a transformer, in the conventional linear-graph representation. 
Specifically, power is taken as positive going in at either port of the transformer, 
whereas in the actual operation, electrical power goes in at the input port while 
mechanical power comes out at the output port.
	
	 The motor is connected to a rotatory load of moment of inertia Jl using a long 
flexible shaft of torsional stiffness kl. The torque transmitted through this shaft is 
denoted by Tk. The load rotates at an angular speed ω l and experiences mechanical 
dissipation, which is modeled by a linear viscous damper of damping constant bl.
Answer the following questions:
	
(a)	 Draw a suitable linear graph for the entire system shown in Figure P5.13, mark 
the variables and parameters (you may introduce new, auxiliary variables but 
not new parameters), and orient the graph.
	
(b)	 Give the number of branches (b), nodes (n), and independent loops (l) in the 
complete linear graph. What relationship do these three parameters satisfy? 
How many independent node equations, loop equations, and constitutive 
equations can be written for the system? Verify the sufficiency of these equa-
tions to solve the problem.
	
(c)	 Take the current through the inductor (iL), speed of rotation of the motor rotor 
(ω r), torque transmitted through the load shaft (Tk), and the speed of rotation 
of the load (ω l) as the four state variables; the armature supply voltage va(t) as 
the input variable; and the shaft torque Tk and the load speed ω l as the output 
variables. Write the constitutive equations, independent node equations, and 
the independent loop equations for the complete linear graph. Clearly show 
the state-space shell.
Ra
bl
ib
+
–
La
+
_
vb
Jl
Jr
kl
Armature circuit
va(t)
Rotor
Stator (constant field)
dc motor
ωm
ωr
ωl
(km)
Tm
Load
iL
FIGURE P5.13 
An electromechanical model of a rotatory positioning system.

277
Linear Graphs
	
(d)	 Eliminate the auxiliary variables and obtain a complete state-space model for 
the system, using the equations written in Part (c). Express the matrices A, B, 
C, and D of the state-space model in terms of the system parameters Ra, La, km, 
Jr, kl, bl, and Jl only.
5.14	 An armature-controlled dc motor is used for motion control of a payload, which 
is assumed to be a concentrated mass. A lead-screw-and-nut device is used to con-
vert the rotatory motion of the motor into the translatory motion of the nut, which 
is integral with the carriage on which the payload is firmly mounted (Figure P5.14).
	
	 The following system parameters are given:
J = moment of inertia of the motor rotor (
⋅
kg m2)
B = equivalent rotary damping constant at the motor (
⋅
⋅
⋅
−
N m rad
s
1
)
m = total mass of the carriage and the payload (kg)
b = equivalent translatory damping constant at the carriage (
⋅
⋅
−
N m
s
1
)
km = torque constant of the motor (
⋅
⋅
−
N m A 1)
Ra = resistance of the armature windings (Ω)
La = leakage inductance of the armature (H)
p = pitch of the lead-screw (i.e., distance between adjacent threads) (m)
Also
v t( )
a
 = armature voltage, which is the input to the system (V)
vp = velocity of the payload, which is the output of the system (
⋅
−
m s 1)
Note: Pitch p of the lead-screw is equal to the motion of the nut per revolution, which 
assumes that a single-threaded lead-screw is used.
	
(a)
	
	
Assume that the torsional stiffness K of the lead-screw, from the motor to the 
nut, is a constant.
Lead-screw
Nut
Armature-controlled
dc motor
Input
voltage va
Carriage
Guide
shaft
Guide shaft
Playload
Fixed
bearing
Fixed
bearing
FIGURE P5.14 
Motion control device with a dc motor and lead-screw-nut mechanism.

278
Modeling of Dynamic Systems with Engineering Applications
	
	
Note: Actually K varies because the position of the nut along the lead screw is not 
fixed.
	
	
Giving all necessary steps, derive a complete state-space model for the system. 
Use the following as the state variables:
	
ia = armature current (A)
	
ω m = motor speed (
⋅
−
rad s 1)
	
Tl = torque in the lead-screw (
⋅
N m)
	
vp = velocity of the payload (
⋅
−
m s 1)
	
(b)
	
	
Suppose that the stiffness K of the lead-screw from the motor to the nut is vari-
able. In particular, suppose that the angle of twist of a unit length (1m) of the 
lead-screw, when a unit torque (
⋅
1N m) is applied to it = a (
⋅
⋅
⋅
−
−
−
rad m
N
m
1
1
1).
	
	
Also
	
	
xo = initial distance of the nut from the motor
	
	
Note: During motion, the distance of the nut from the motor varies.
	
	
Derive a state-space model for the system, using the same state variables as before.
	
	
Note: Now you must use the constant parameter a instead of K in your equa-
tions. You must give all necessary steps and details of your derivation.
5.15	 A passive shock-absorber unit has a piston-cylinder mechanism, as schematically 
shown in Figure P5.15. The cylinder is fixed and rigid, and it is filled with an 
incompressible hydraulic fluid (on both sides of the piston). The piston mass is 
m and its area is A. It has a small opening through which the hydraulic fluid can 
flow from one side of the cylinder to the other side as the piston moves. The fluid 
resistance to this flow may be represented by a linear hydraulic resistance Rf.
	
	 A spring of stiffness k resists the movement of the piston. Suppose that the input 
force applied to the shock absorber (piston) is f t( ).
	
(a)	 Sketch a linear graph for this system.
	
	 Hint: It may contain a force source, a spring branch, a mass branch, a mechanical-
fluid gyrator (two-domain), and a hydraulic resistance. Some of the associated 
branch variables are
v = piston velocity
Q = fluid volume flow rate through the piston opening (taken positive from left 
to right)
	
=
−
P
P
P
2
1 = pressure difference between the two sides of the piston
	
fk = spring force
	
(b)	 Using the linear graph, systematically develop a state-space model for the sys-
tem (give the model matrices A and B only) with:
State vector: =
x
v f
[ ,
]
k
T
Input vector: =
u
f t
[ ( )]
Express the model parameters in terms of m, k, A, and Rf.
Notes: Assume that
•	 There is no friction between the piston and the cylinder
•	 The area of the two sides of the piston is the same (approximately) at value A. That 
is, neglect the area of the piston rod.

279
Linear Graphs
5.16
	
(a)	 What is a gyrator as an element used in modeling a dynamic system?
	
(b)	 A hydraulic motion-controlled system is schematically shown in Figure P5.16. 
The control input to the system is the volume flow rate Q t( ), which is pro-
vided by a flow-controlled pump. The hydraulic fluid from the pump enters 
the cylinder of a positioning ram. The piston (area = Q t( )) of the ram is light and 
frictionless, and adjusts the motion of the load consisting of a mass m, which 
moves against a spring of stiffness k  (the other end of the spring is fixed, as 
shown) and a viscous damper of damping constant b.
	
	
The motion output of the system is velocity v of the mass m.
	
	
Assume that the fluid in the rigid cylinder is compressible, and the corre-
sponding fluid capacitance is Cf.
	
(i)	 Sketch a linear graph for the system, orient all it branches, and indicate 
all the system parameters, and the (through-, across-) variable pairs of the 
branches.
	
(ii)	 Showing all the steps systematically, derive a complete state-space model 
for the system.
Note: Express your result only in terms of the given parameters Cf, A, m, k and b.
f(t)
Rf
fk
k
P1
P2
Q
Area = A
P = P2 – P1
v
m
FIGURE P5.15 
A passive shock absorber unit.
m
k
Q(t)
Cf
Area A
b
v
Frictionless
Flow-controlled
pump
Ramp
Load
FIGURE P5.16 
A hydraulic motion-controlled system.

280
Modeling of Dynamic Systems with Engineering Applications
5.17	 A mechanical load of mass m is driven by a force source f t( ) and is buffered using 
a gas shock absorber, as shown in Figure P5.17. The gas cylinder is properly sealed 
(i.e., gas does not leak out of the cylinder compartment). The piston moves against 
the cylinder without experiencing an appreciable friction (or, this friction compo-
nent may be incorporated into the damping of the motion of the mass, assuming 
that the shaft is rigid). The following parameters are given:
m = mass of the moving load
b = equivalent viscous damping constant of the load motion
Cf = capacitance of the gas in the shock absorber
A = area of the piston
	
(a)	 Sketch a complete linear graph for the system
	
(b)	 Using the state variables: v1 = velocity of the mass, Pf = gauge pressure in the 
gas; the input variable f t( ) = force of the source element (linear motor); and the 
output variable v1 = velocity of the mass, systematically determine a complete 
state-space model for the system.
	
(c)	 Express the undamped natural frequency and the damping ratio of the system 
in terms of b, m, A, and Cf.
	
	
Note: Neglect the mass of the piston (or incorporate it into the mass of the load) 
and assume that the piston rod is rigid.
5.18
	
	 Consider a positioning mechanism, which has an armature-controlled linear dc 
motor, driving a massive load having viscous damping. The load is connected 
through a flexible rod of stiffness k to a gas cylinder (which serves as a shock 
absorber) of pressure Pc and fluid (gas) capacitance Cf. A lumped-parameter linear 
model for the system is shown in Figure P5.18.
Load
   m
f (t)
Cf, Pf
v1
Force
source
Gas shock absorber
A
b
Smooth seal
Atmospheric
pressure
Clearance
FIGURE P5.17 
Mechanical load with a shock absorber.
+
−
va(t)
Ra
La
vm
k
b
km
m
Pc
Cf
A
FIGURE P5.18 
A linear motor-­driven mechanical load.

281
Linear Graphs
The following model parameters are given:
Ra = resistance of the armature coil
La = leakage inductance of the armature circuit
km = force constant of the linear dc motor
m = overall mass of the load and the armature
k = stiffness of the rod connecting the load to the shock absorber
b = viscous damping constant of the load
Cf  = fluid (gas) capacitance of the shock absorber
A = area of the shock-absorber piston
Note: The piston is light (neglect its mass).
	
(a)	 Sketch a complete linear graph for the system.
Note: Orient the branches and indicate all the system parameters and branch variables 
(through- and across-pairs).
	
(b)	 Systematically derive a complete state-space model using the linear graph and 
the following variables:
Input = armature input voltage = v t( )
a
Output = velocity of the load = vm
Give the model matrices A,B,C, and D.
	
(c)	 Discuss an important characteristic of the model.
5.19
	
	 A pressure-controlled fluid actuator is used to move a mechanical load (see 
Figure P5.19). The pump provides hydraulic fluid at pressure PS, which enters the 
actuator chamber through a valve of fluid flow resistance Rf. The actuator chamber 
has a fluid capacitance Cf due to the compressibility of the fluid, whose pressure is 
P. This pressure moves the load whose mass is m  and the area of cross-section is 
A, against a mechanical resistance of stiffness k and damping constant b. The mass 
is moved inside the actuator chamber at speed vm.
	
(a)	 Draw a linear graph for the system.
	
(b)	 Using 
=
x
P f
v
[ ,
,
]
k
m
T as the state vector, 
=
u
P t
[
( )]
s
 as the input, and 
=
y
x
[ ] as 
the output, determine a complete state-space model with the aid of the linear 
graph in Part (a).
f
Cf
P
Rf
Ps
vm
b
k
Actuator
Area = A
Mass = m Frictionless seal
Load
Pressure-controlled
pump
Fluid
FIGURE P5.19 
A fluid actuator moving a mechanical load.

282
Modeling of Dynamic Systems with Engineering Applications
Note: fk = spring force; x = position of the load (of velocity vm)
	
(c)	 Determine the input–output differential equation model of the system.
5.20
	
	 A flow-controlled pump is used to operate a ram (piston-cylinder actuator) which 
positions a mechanical load (see Figure P5.20). The piston and the cylinder of the 
ram are rigid. The capacitance Cf  results from the flexibility of the fluid only. The 
mechanical load consists of a mass, spring, and a damper, as shown in the figure.
The following parameters are given:
mp = mass of the piston
A = effective area of the piston
Rp = fluid resistance at the piston due to the flow through the damping cavities 
(and also possible leakage flow between the piston and the cylinder)
kr = stiffness of the piston rod, which is connected to the mechanical load
ml = mass of the mechanical load
kl = resisting stiffness of the mechanical load
bl = linear viscous damping constant at the mechanical load
Also, the following sate variables are defined:
Pf = fluid pressure in the cylinder
vp = velocity of the piston
fr = spring force in the piston rod
vm = velocity of the mechanical load
fl = resisting spring force of the mechanical load
The system input is the volume flow rate Q t( )
s
 of the pump.
The system output is the velocity vm of the mechanical load.
	
(a)	 Sketch a complete linear graph for the system. Indicate the parameters, 
through-variables, and across-variables of all the branches.
	
(b)	 By writing the state-space shell equations, remaining constitutive equations, 
loop equations, and the node equations, determine a complete state-space 
model for the system. The state vector is x = P v
f v
f
[
,
,
,
,
]
f
p
r
m
l
T.
	
(c)	 Determine the matrices A, B, C, and D of the linear state-space model.
Cf
Pf
Ram
Effective
area A
Mass mp
Piston rod
Flow-controlled pump
Input
flow rate
Qs(t)
Mechanical load
vp
kr
fr
ml
vm
kl
fl
bl
Damping
cavity
FIGURE P5.20 
Mechanical load positioned by a ram using a flow-­controlled pump.

283
Linear Graphs
5.21
	
	 To incorporate such aspects as sensing, data acquisition, control, and communica-
tion into an LG model, we need means for power-to-information transformation 
and information-to-power transformation. For modeling purposes in such situ-
ations, a modulated information source and a modulated power source may be 
used, as represented in Figure P5.21. A power signal (same as those used in LG 
models for the four physical domains) will be the modulating signal for an infor-
mation source, and an information signal (as needed, for example, in data acqui-
sition, control, and communication) will be the modulating signal for a power 
source. Explore the use of these two types of modulated sources in modeling an 
engineering dynamic system.
5.22
	
	 Consider a multidomain engineering system that you are familiar with (in your 
projects, research, engineering practice, informed imagination, through the litera-
ture that you have read, etc.). It should include the mechanical structural domain 
(i.e., with inertia, flexibility, and damping) and at least one other domain (e.g., 
electrical, fluid, and thermal).
	
(a)	 Using sketches, describe the system by giving at least the following information:
	
i.	 The practical purpose and functions of the system
	
ii.	 Typical operation/behavior of the system
	
iii.	 System boundary
	
iv.	 Inputs and outputs
	
v.	 Characteristics of the main components of the system
	
(b)	 Sketch a lumped-parameter model of the system by approximating any sig-
nificant distributed effects using appropriate lumped elements and showing 
how the lumped-parameter elements (including sources) are interconnected 
(i.e., show the system structure). You must justify your choice of elements and 
approximation decisions. Also, you must retain any significant nonlinearities 
in the original system.
(a)
ii, vi
co=f (vi)
(b)
ci
Power source
_
+
io(t), vo
vo=f (ci)
co
Information source
FIGURE P5.21 
(a) Power-to-information transformer (modulated information source) and (b) information-to-power trans-
former (modulated power source).

284
Modeling of Dynamic Systems with Engineering Applications
	
(c)	 Develop an analytical model of the system by writing the necessary constitu-
tive equations, continuity equations, and compatibility equations. The model 
should be at least fifth order but not greater than tenth order.
	
	 Note: Draw a linear graph for the system (assuming that you plan to use the 
linear-graph approach to obtain the analytical model).
	
(d)	 Approximate the nonlinear elements by suitable linear elements.
	
(e)	 Identify suitable state variables for the linear system and develop a complete 
state-space model (i.e., matrices A, B, C, and D) for the system. 

285
6
Frequency-Domain Models
6.1   Introduction
In the previous chapters, we primarily studied time-domain models of engineering 
dynamic systems. In their analytical form, these models are represented by differential 
equations with respect to time. In particular, we paid much attention to state-space mod-
els, which are presented by a set of first-order ordinary differential equations in time. 
The present chapter formally studies another popular type of input–output model called 
transfer functions (TFs). In the general case, the Laplace transform is used to convert a linear 
and time-invariant time-domain model into a Laplace transfer-function model. A special, yet 
very practical, version of Laplace transfer function is the frequency transfer function (FTF) 
or frequency response function (FRF). Analytically, the Fourier transform is used to convert a 
linear and time-invariant time-domain model into an FTF model.
The present chapter specifically studies several very practical mechanical transfer func-
tions and illustrates how they are used in various practical applications, including model 
formulation, response analysis, and design. The focus is on mechanical systems. However, 
in view of the existing analogies (as extensively covered in the previous chapters) the 
Chapter Highlights
•	 Transfer-function (TF) Models
•	 Laplace Transform and Fourier Transform
•	 Differentiation and Integration Operators
•	 Transfer-function Matrix (MIMO)
•	 Frequency-domain Models (FTF or FRF)
•	 Bode and Nyquist Diagrams of FTF
•	 Harmonic Response (Magnitude and Phase)
•	 Mechanical TFs (Mechanical Impedance and Mobility)
•	 Component Interconnection Laws (Series and Parallel)
•	 Force Transmissibility and Motion Transmissibility
•	 Vibration Isolation and Suspension/Mount Design
•	 Maxwell’s Reciprocity Property (and Generalization)

286
Modeling of Dynamic Systems with Engineering Applications
methods in the present chapter can be easily extended to other domains (electrical, fluid, 
and thermal). In fact, many procedures in the present chapter use the concept of mechani-
cal circuits, which are analogous to electrical circuits. Hence, some of the methods that are 
applied to mechanical systems in this chapter are widely used in electrical systems and 
electrical circuit analysis.
6.1.1   Transfer-Function Models
A transfer-function (TF) model is an input–output model (I–O model) and is equivalent 
to an I–O differential equation in the time domain (see Chapters 3 and 5). Simplistically, 
a TF  model  provides an “algebraic” (not differential-equation) representation of: 
System output
System input
.
A TF model (strictly, a Laplace transfer function) is based on the Laplace transform, and 
is a versatile means of representing a linear system that has constant (time-invariant) 
parameters. Strictly, it is a dynamic model in the Laplace domain. A frequency-domain 
model (or a frequency transfer function or FTF) is a special case of a Laplace domain 
model, and it is based on the Fourier transform. However, these two types of models 
are interchangeable—it is a trivial exercise to convert a Laplace-domain model into the 
corresponding frequency-domain model, and vice versa. Similarly, it is a simple and 
straightforward exercise to convert a linear, constant-coefficient (time-invariant) time-
domain model (e.g., input–output differential equation or a state-space model) into a 
transfer-function model, and vice versa.
A system with just one input (excitation) and one output (response) can be represented 
uniquely by one transfer function. For example, in a mechanical dynamic system, the 
response characteristics at a given location and direction (say, along a particular coor-
dinate or in a given degree of freedom) of the system to a forcing input at the same or 
different location and direction can be modeled using a single FTF. When a system has 
two or more inputs (i.e., input vectors) and/or two or more outputs (i.e., output vectors), its 
transfer-function representation needs several transfer functions (i.e., a transfer-function 
matrix is needed).
Transfer-function models have been widely used in early studies of dynamic systems 
because they are algebraic functions rather than differential equations and are easier to 
analyze. In view of the simpler algebraic operations that are involved in transfer-function 
approaches, a substantial amount of information regarding the dynamic behavior of a 
system can be obtained with minimal computational effort. This is the primary reason for 
the popularity enjoyed by the transfer-function methods prior to the advent of the digital 
computer. One might think that the abundance of high-speed and low-cost digital pro-
cessing would lead to a dominance of time-domain methods over transfer-function meth-
ods, but there is evidence to the contrary in many areas, particularly in dynamic systems 
and control, due to the analytical simplicity and the intuitive appeal of transfer-function 
techniques. Only a minimal knowledge of the theory of Laplace transform and Fourier 
transform is needed to use transfer-function methods in system modeling, analysis, simula-
tion, design, and control. Furthermore, just as a time-domain model presents the behavior 
of a dynamic system in its true physical domain as the time changes, a frequency-domain 
model is also a very realistic and practical model.
In its core, a frequency-domain model represents how a dynamic system responds to 
a sinusoidal (i.e., harmonic) excitation. Since, according to the theory of Fourier analysis, 

287
Frequency-Domain Models
any signal can be represented by a collection of harmonic components, a frequency-
domain model can represent as well the true physical behavior of a dynamic system 
to any type of input. Indeed, a frequency-domain model is completely equivalent to a 
time-domain model and to a Laplace-domain model. Techniques of transfer-function 
models, both in the Laplace domain and the special frequency (Fourier) domain are 
studied in the present chapter. In particular, we will see that mobility, mechanical imped-
ance and transmissibility are convenient transfer-function representations of mechanical 
dynamic systems, in the frequency domain. We will study how such a model can be 
formulated with the knowledge of the element (component) transfer functions and how 
they are interconnected (series, parallel) in the system. The complementary (dual) char-
acteristic of force transmissibility and motion transmissibility is recognized. Also the 
application of Maxwell’s reciprocity property in mechanical dynamic systems and its 
extension to other physical domains is examined. As practical examples, transmissibil-
ity is applicable in vibration isolation of machines and suspension systems in vehicles; 
and mechanical impedance is useful in such tasks as cutting, joining, and assembly that 
employ machine tools and robots.
6.2   Laplace and Fourier Transforms
In mathematics we encounter various transforms. Typically, a transform is used to covert 
a mathematical problem into a different analytical form in order to take advantage of the 
possible analytical convenience of the transformed problem. For example, the logarithm is 
a transform that converts the multiplication operation into an addition operation and the 
division operation into a subtraction operation, thereby making the analysis simpler. In a 
similar manner, the Laplace transform converts “differentiation” into a “multiplication by 
the Laplace variable s;” and “integration” into a “division by s,” thereby providing signifi-
cant analytical convenience. Fourier transform may be considered as a special case of the 
Laplace transform. However, a Fourier transform of a function contains all the informa-
tion of the original function and also of the Laplace-transformed result. Hence, they are 
fully reversible. The Fourier result corresponding to a Laplace result is obtained simply by 
setting 
ω
=
s
j
 in the Laplace result, where ω is the frequency variable. Even though this 
conversion itself is trivial, the underlying analytical basis is quite sophisticated and com-
prehensive. Further details are found in Appendix D.
6.2.1   Laplace Transform
The Laplace transform involves the mathematical transformation of a function (y(t)) in 
the time domain into an equivalent function (Y(s)) in the Laplace domain (also termed the 
s-domain or the complex frequency domain) according to
	
∫
=
−
=
∞
L
Y s
y t
st dt
Y s
y t
( )
( )exp(
)
or
( )
( )
0
	
(6.1)
Here, the Laplace operator = L; and the Laplace variable 
σ
ω
=
+
s
j
 are complex, since 
=
−
j
1.

288
Modeling of Dynamic Systems with Engineering Applications
The real positive value σ is chosen sufficiently large so that the transform integral 
(Equation 6.1) is finite (i.e., ∫
σ
−e
y t dt
( )
t
 is finite) even when ∫y t dt
( )
 is not finite.
Note: Mathematically, y(t) can be complex in general. However, in a practical dynamic 
system, it is a real function of time t (representing a time response of the dynamic system). 
Even in this practical case, Y(s) will be complex, because s is complex, as is clear from 
Equation 6.1.
The inverse Laplace transform is:
	
∫
π
=
=
σ
σ
−∞
+ ∞
−
y t
j
Y s
st ds
y t
L Y s
( )
1
2
( )exp( )
or ( )
( )
j
j
1
	
(6.2)
This is obtained simply through mathematical manipulation (multiply both sides by 
the appropriate exponential and integrate with respect to s) of the forward transform 
(Equation 6.1).
Note: For a given time function, its Laplace transform is unique, and the Laplace opera-
tion is completely reversible. Specifically, the time function can be fully recovered from its 
Laplace transform.
Laplace Transform of a Derivative
Using Equation 6.1, the Laplace transform of the time derivative 
=
y
dy
dt

 may be deter-
mined as:
	
∫
=
=
−
−
∞
y
e
dy
dt dt
sY s
y
( )
(0)
st
0

L
	
(6.3)
Note: Integration by parts: ∫
∫
=
−
udv
uv
vdu  is used in obtaining the result (Equation 6.3). 
Also y(0) is the initial condition (IC) of y(t) at t = 0.
By repeatedly applying Equation 6.3 we can get the Laplace transform of the higher 
derivatives; specifically, 
( ) =

−
=
−
−
y t
s
y t
y
s sY s
y
y
( )
(0)
[
( )
(0)]
(0)




L
L
This gives the result:
	
( )
( )
=

−
−
y t
s
y t
sy
y
(0)
(0)
2


L
L
	
(6.4)
Similarly we can obtain
	
=
−
−
−
y
s Y s
s y
sy
y
( )
(0)
(0)
(0)
3
2



L
	
(6.5)
Proceeding in this manner, we get the general result:
	
=
−
−
−
−
−
−
−
−
d y t
dt
s Y s
s
y
s
y
d
y
dt
( )
( )
(0)
(0)
(0)
n
n
n
n
n
n
n
1
2
1
1


L
	
(6.6)
Note: With zero ICs, we have

289
Frequency-Domain Models
	
=
d y t
dt
s Y s
( )
( )
n
n
n
L
	
(6.7)
This means the time derivative corresponds to multiplication by s in the Laplace domain. 
As a result, differential equations (time-domain models) become algebraic equations (transfer 
functions), which require easier mathematics. We will explore this issue further in the next 
section. From the result (Equation 6.7) it is clear that the Laplace variable s can be inter-
preted as the derivative operator in the context of a dynamic system.
Note: ICs can be added separately to a Laplace model after using Equation 6.7 to trans-
form the derivatives of a time-domain dynamic model into polynomials in s. These poly-
nomials represent the model, and do not depend on the ICs. Hence, in the transformation 
of a time-domain model (ordinary differential equation) into a Laplace-domain model 
(transfer function), first the ICs are assumed zero.
Laplace Transform of an Integral
The Laplace transform of the time integral ∫
τ
τ
y
d
( )
t
0
 is obtained by the direct application 
of Equation 6.1 as
	
∫
∫
∫
∫
∫
τ
τ
τ
τ
τ
τ
=
=
−




−
∞
−
∞
y
d
e
y
d dt
s
d
dt e
y
d dt
( )
( )
1
(
)
( )
t
st
t
st
t
0
0
0
0
0
L
Integrate by parts using: ∫
∫
=
−
udv
uv
vdu , as
	
∫
∫
∫
∫
τ
τ
τ
τ
= −




−
−




=
−
+ 



−
∞
−
∞
−
∞
y
d
s e
y
d
s e
y t dt
s e
y t dt
( )
1
( )
|
1
( )
0
0
1
( )
t
st
t
st
st
0
0
0
0
0
L
We obtain
	
∫
τ
τ =
y
d
s Y s
( )
1
( )
t
0
L
	
(6.8)
It follows that integration in the time domain becomes multiplication by 1/s in the Laplace 
domain. In particular, 1/s can be interpreted as the integration operator, in the context of a 
dynamic system.
In using techniques of Laplace transform in the analysis of dynamic systems, the gen-
eral approach is to first convert the time-domain problem into an equivalent s-domain 
problem (conveniently, Laplace transform tables are available as well, for this purpose. 
See Appendix D); perform the necessary analysis (algebra rather than calculus) in the 
s-domain; and convert the results back into the time domain (again, Laplace transform 
tables may be used). Further discussion, techniques, and Laplace tables are found in 
Appendix D.

290
Modeling of Dynamic Systems with Engineering Applications
6.2.2   Fourier Transform
The Fourier transform involves the mathematical transformation from the time domain 
into the frequency domain) according to
	
∫
ω
ω
ω
(
)
=
−
=
−∞
∞
Y j
y t
j t dt
Y j
y t
(
)
( )exp
or
(
)
( )
F
	
(6.9)
where the cyclic frequency variable = f (in Hz); and the angular frequency variable = ω
π
=
f
2
 
(in rad/s).
Note: Mathematically, y(t) can be complex (i.e., not real) even though in practice it is a real 
function of time t (representing a time response of a dynamic system). Even when y(t) is 
real, 
ω
Y j(
)  will be complex, because 
ω
ω
ω
(
)
−
=
−
j t
t
j
t
exp
cos
sin
 is complex, as clear from 
Equation 6.9.
The inverse Fourier transform is given by
	
∫
π
ω
ω
ω
ω
(
)
=
=
−∞
∞
−
y t
Y j
j t d
y t
Y j
( )
1
2
(
)exp
or ( )
(
)
1
F
	
(6.10)
This is obtained simply through mathematical manipulation (multiply both sides by 
the appropriate exponential and integrate with respect to ω) of the forward transform 
(Equation 6.9).
By examining the transforms Equations 6.1 and 6.9, it is clear that the conversion from the 
Laplace domain into the Fourier (frequency) domain may be done simply by setting 
ω
=
s
j . 
Strictly, the one-sided Fourier transform is used for this purpose (where the lower limit of 
integration in Equation 6.9 is set to t = 0) because it is then that Equation 6.1 becomes identi-
cal to Equation 6.9 with 
ω
=
s
j .
We summarize these results and observations below.
Laplace Transform:
Time domain ↔ Laplace (complex frequency) domain
Time derivative ↔ Multiplication by Laplace variable s
Differential equations ↔ Algebraic equations (with polynomials in s)
Time integration ↔ Multiplication by 1/s
Fourier Transform:
Time domain ↔ Frequency domain
Laplace result 
ω
ω
←
=
→=
j
s
s
j  Fourier result (one-sided)
It should be clear that, in modeling and analysis of dynamic systems (linear and time-
invariant), the Laplace approach and the Fourier approach are completely equivalent. 
The conversion 
ω
=
s
j
 is used to get the Fourier result from the equivalent Laplace result 
and vice versa. In other words, for our purposes, when we have a Laplace result, there is 
an equivalent Fourier result (and vice versa). Mathematically, however, a Fourier result 
may not exist even when a Laplace result exists. This is because in the Laplace transform 
(see Equation 6.1) there is the multiplier 
σ >
σ
−e
with
0
t
 in the integrand whereas in the 
Fourier transform (see Equation 6.9) there is no multiplier 
σ
−e
t in the integrand. For σ > 0, 

291
Frequency-Domain Models
the rapid (exponential) decay property of 
σ
−e
t  makes the Laplace transform much more 
convergent than the Fourier transform.
6.3   Transfer Function
The transfer function is a dynamic model that is represented in the Laplace domain. 
Specifically, the transfer function G(s) of a linear, time-invariant, single-input single-output 
(SISO) system is given by
=
G s( )
Laplace-transformed output
Laplace-transformed input
, assuming zero initial conditions (zero ICs). This is a 
unique function, which represents the system (model); it does not depend on the input,
the output, or the initial conditions.
A physically realizable linear, constant-parameter system possesses a unique transfer 
function even if the Laplace transform of a particular input to the system (and of the cor-
responding output) does not exist. For example, suppose that the Laplace transform of a 
particular input u(t) is infinite. Then the Laplace transform of the corresponding output 
y(t) will also be infinite. But the transfer function itself will be finite, and will represent the 
actual system (irrespective of the input or the output).
Consider the nth-order linear, constant-parameter system given by:
	
+
+
+
=
+
+
+
−
−
−
a d y
dt
a
d
y
dt
a y
b u
b du
dt
b d u
dt
n
n
n
n
n
n
m
m
m
1
1
1
0
0
1


	
(6.11)
with input = u(t) and output = y(t).
For systems that possess dynamic delay (i.e., systems whose response does not feel the 
excitation (input) either instantly or ahead of time (i.e., systems whose excitation and/or its 
derivatives are not directly fed forward to the output), we will have m < n. These are the 
systems that concern us most in real applications.
Note: We will assume that m < n, or at worst m ≤ n. The requirement m ≤ n is satisfied by a 
physically realizable system. In the extreme case of m = n, the input u(t) is instantly felt at the 
output y(t). In other words, the input is directly fed forward into the output.
Use the result Equation 6.7 in Equation 6.11, assuming zero ICs. We obtain the system 
transfer function:
	
=
=
+
+
+
+
+
+
Y s
U s
G s
b
b s
b s
a
a s
a s
( )
( )
( )
m
m
n
n
0
1
0
1


	
(6.12)
It should be clear from Equations 6.11 and 6.12 that the transfer function that corresponds 
to the differential equation of a dynamic system, can be written simply by inspection, with-
out requiring any mathematics or knowledge of Laplace-transform theory. Conversely, 
once the transfer function is given, the corresponding time-domain (differential) equation 
should be immediately obvious as well.

292
Modeling of Dynamic Systems with Engineering Applications
Note: The dominator polynomial of a transfer function is called the characteristic polyno-
mial, and the corresponding equation is called the characteristic equation: 
+
+
+
=
a
a s
a s
0
n
n
0
1

. Its roots are the poles (or eigenvalues) of the system.
Transfer functions are simple algebraic expressions. Specifically, differential equations 
(time-domain models) are transformed into algebraic relations through the Laplace trans-
form. This is a major advantage of the transfer-function approach. Once the analysis is 
performed using transfer functions, the inverse Laplace transform can convert the Laplace 
results into the corresponding time-domain results. This can be accomplished with the aid 
of Laplace transform tables (see Appendix D).
Example 6.1
Consider the mechanical oscillator (mass-spring-damper system) shown in Figure 6.1. 
Its dynamic equation is obtained in a straightforward manner (by applying Newton’s 
second law to the point mass) as: 
= −
−
+
my
by
ky
f t( )


 or,
	
+
+
=
my
by
ky
ku t( )


	
(6.13)
where the response (output) y of the mass is measured from its static equilibrium posi-
tion (so that the gravitational force is balanced by the initial static force in the spring). 
Also, the input u(t) is a “scaled” version of the force applied to the mass, according to:
	
=
f t
ku t
( )
( ) 	
(6.14)
Note: Alternatively, u(t) may be considered as the displacement “applied” to the base of 
the spring only (not the damper, whose base is still fixed to the ground). See Problem 6.3.
Take the Laplace transform of the system Equation 6.13a with zero ICs:
	
+
+
=
ms
bs
k Y s
kU s
(
) ( )
( )
2
The corresponding transfer function is
	
=
=
+
+
G s
Y s
U s
k
ms
bs
k
( )
( )
( )
(
)
2
	
(6.15a)
Define ω = k m
n
2
 and ζω = b m
2
n
 where
Undamped natural frequency = ωn
Damping ratio = ς
m
k
f(t) = ku(t)
b
y
FIGURE 6.1
A damped mechanical oscillator.

293
Frequency-Domain Models
Then, we can write the transfer function as
	
ω
ζω
ω
=
+
+
G s
s
s
( )
(
2
)
n
n
n
2
2
2 	
(6.15)
This is the transfer function corresponding to the displacement output.
If the output of the oscillator is taken as the velocity of the mass, we have
	
ω
ζω
ω
=
=
+
+
sY s
U s
sG s
s
s
s
( )
( )
( )
(
2
)
n
n
n
2
2
2 	
(6.16)
Similarly, if the output is the acceleration of the mass, the corresponding transfer func-
tion is
	
ω
ζω
ω
=
=
+
+
s Y s
U s
s G s
s
s
s
( )
( )
( )
(
2
)
n
n
n
2
2
2
2
2
2
	
(6.17)
Note: The results (Equations 6.16 and 6.17) are obtained from the fact that, the Laplace 
transform of the velocity is sY s( ), and the Laplace transform of the acceleration is s Y s( )
2
. 
See Equation 6.7.
In Equation 6.17, the numerator order is equal to the denominator order (i.e., m = n = 2). 
This means, the input (applied force) is instantly felt in the acceleration of the mass, 
which is intuitive, and also may be verified experimentally by using an accelerometer 
(acceleration sensor) mounted on the mass. This transfer function corresponds to feed-
ing forward the input directly into the output (as noted before, with regard to the case 
of m = n) with zero dynamic delay. For example, this is the primary mechanism through 
which road disturbances are felt inside a vehicle having hard suspensions.
The characteristic equation of the oscillator is
	
∆
ζω
ω
=
+
+
=
s
s
s
( )
2
0
n
n
2
2
	
(6.18)
LEARNING OBJECTIVES
	
1.	 Converting an I–O differential equation of a system into a transfer function
	
2.	 Natural frequency and damping ratio of a damped mechanical oscillator
	
3.	 Characteristic polynomial of a system
	
4.	 Obtaining the transfer function corresponding an input force and an output 
displacement of a mechanical dynamic system
	
5.	 Derivation of the transfer functions of related outputs (displacement è velocity 
è acceleration)
	
6.	 A situation where the input is directly present in the output (feedforward                    
situation) 
■
6.3.1  Transfer-Function Matrix
Consider the state variable representation of a linear, time-invariant system (see 
Chapters 3 and 5):
	
=
+
x
Ax
Bu

	
(6.19)
	
=
+ Du
yy
CCxx
	
(6.20)

294
Modeling of Dynamic Systems with Engineering Applications
where x(t) is the nth-order state vector; u is the rth-order input (excitation); and y is the mth-
order output (response) vector. This is a multi-input multi-output (MIMO) system. The cor-
responding transfer-function model relates the output vector y to the input vector u. We will 
need m × n transfer functions, or a transfer-function matrix, to represent this MIMO system.
To obtain an expression for the transfer-function matrix, we first apply Laplace trans-
form to the Equations 6.19 and 6.20, with zero ICs for x. We get
	
=
+
X
AX
BU
s
s
s
s
( )
( )
( ) 	
(6.19b)
	
=
+
Y
CX
DU
s
s
s
( )
( )
( ) 	
(6.20b)
From Equation 6.19b we have
	
=
−
−
X
I
A
BU
s
s
s
( )
(
)
( )
1
	
(6.19c)
in which I is the nth-order identity matrix (a matrix with 1s as its diagonal elements and 
0s for all other elements). By substituting Equation 6.19c into Equation 6.20b, we get the 
transfer-function relation:
	
(
)
=
−
+


−
Y
C
I
A
B
D U
s
s
s
( )
(
)
( )
1
	
(6.21a)
or
	
=
Y
G
U
s
s
s
( )
( ) ( )
	
(6.21)
The transfer-function matrix G(s) is an m × n matrix given by
	
(
)
=
−
+
−
G
C
I
A
B
D
s
s
( )
(
) 1
	
(6.22a)
In most practical systems with dynamic delay, the excitation u(t) is not directly fed forward 
to the response y; and as a result it is not instantaneously felt in the response y. Then we 
have D = 0, and Equation 6.22a becomes
	
=
−
−
G
C I
A
B
s
s
( )
(
) 1
	
(6.22)
Examples are presented now to illustrate the conversion of a time-domain (differential-
equation) model into a transfer-function (matrix) model.
Example 6.2
Let us consider again the damped oscillator of Example 6.1, given by
	
ζω
ω
ω
+
+
=
y
y
y
u t
2
( )
n
n
n
2
2


	
(6.13b)
Define the state variables as
	
= 

= 

x
x
x
y
y
T
T
1
2


295
Frequency-Domain Models
where y = position and y  = velocity. Then, a state model for the system can be 
expressed as
	
ω
ζω
ω
=
−








+








x
x
u t
0
1
2
0
( )
n
n
n
2
2

If we consider both displacement and velocity as outputs, we have
	
=
y
n
Note: In this example, the output gain matrix (measurement matrix) is the identity 
matrix: C = I. Also, there is no direct feed-forward of the input to the output. Hence, 
D = 0. From Equation 6.21a, we obtain
ω
ζω
ω
ζω
ω
ζω
ω
ω
ζω
ω
ω
ω
=
=
−
+
















=
+
+
+
−
















=
+
+








−
X
Y
s
s
s
s
U s
s
s
s
s
U s
s
s
s
U s
( )
( )
1
2
0
( )
1
(
2
)
2
1
0
( )
1
(
2
)
( )
n
n
n
n
n
n
n
n
n
n
n
n
2
1
2
2
2
2
2
2
2
2
2
	

(i)
We observe that the transfer-function matrix is
	
ω
∆
ω
∆
=








G s
s
s
s
( )
( )
( )
n
n
2
2
 
The characteristic polynomial of the system is ∆
ζω
ω
=
+
+
s
s
s
( )
2
n
n
2
2 .
The transfer-function matrix in the present example is in fact a column vector. The 
first element in G(s) is the displacement-output transfer function, and the second ele-
ment is the velocity-output transfer function. These results agree with the expressions 
obtained in Example 6.1.
Now, let us consider the acceleration y  as an output, and denote it by y3. It is clear 
from the system Equation 6.13b that
	
ζω
ω
ω
=
= −
−
+
y
y
y
y
u t
2
( )
n
n
n
3
2
2


or, in terms of the state variables:
	
ζω
ω
ω
= −
−
+
y
x
x
u t
2
( )
n
n
n
3
2
2
1
2
This output explicitly contains the input term. This is a direct “feedforward” situation 
which implies that the matrix D becomes non-zero when acceleration y  is chosen as an 
output. In this case, by substituting (i), we obtain
	
ζω
ω
ω
ζω
ω
∆
ω
ω
∆
ω
= −
−
+
= −
−
+
Y s
X s
X s
U s
s
s U s
s U s
U s
( )
2
( )
( )
( )
2
( )
( )
( )
( )
( )
n
n
n
n
n
n
n
n
3
2
2
1
2
2
2
2
2
This simplifies to
	
ζω
ω
ω
ω
∆
= −
−
+
=
Y s
X s
X s
U s
s
s U s
( )
2
( )
( )
( )
( )
( )
n
n
n
n
3
2
2
1
2
2
This agrees with the acceleration-output transfer function obtained in Example 6.1.

296
Modeling of Dynamic Systems with Engineering Applications
LEARNING OBJECTIVES
	
1.	 The vector-matrix approach to converting an I–O differential equation of a 
system into a state-space model and then into a transfer function
	
2.	 Characteristic polynomial of a system
	
3.	 Derivation of the transfer functions of related outputs (displacement è velocity 
è acceleration)
	
4.	 A situation where the input is directly present in the output (feedforward 
situation). 
■
Example 6.3
Consider the simplified model of a vehicle shown in Figure 6.2, which can be used to 
study the heave (vertical up and down) and pitch (front-back rotation) motions due to 
the road profile and other disturbances. For our purposes, let us assume that the road 
disturbances that excite the front and back suspensions are independent. The equations 
of motion for heave (y) and pitch (θ) are written about the static equilibrium configura-
tion of the vehicle model (hence, gravity does not enter into the equations) for small 
motions:
	
θ
θ
θ
θ
θ
θ
θ
θ
θ
=
−
+
+
−
+
+
−
+
+
−
+
= −
−
+
+
−
+

+
−
+
+
−
+


my
k u
y
l
k u
y
l
b u
y
l
b u
y
l
J
l
k u
y
l
b u
y
l
l
k u
y
l
b u
y
l
(
)
(
)
(
)
(
)
(
)
(
)
(
)
(
)
1
1
1
2
2
2
1
1
1
2
2
2
1
1
1
1
1
1
1
2
2
2
2
2
2
2














Take the Laplace transforms of these two equations with zero initial conditions (i.e., 
substitute s Y
2  for y, sY for y, etc.):
	
θ
[
]
+
+
+
+


+
−
+
−
=
+
+
+
ms
b
b s
k
k
Y s
b l
b l s
k l
k l
s
b s
k U s
b s
k U s
(
)
(
)
( )
(
)
(
)
( )
(
)
( )
(
)
( )
2
1
2
1
2
2 2
1 1
2 2
1 1
1
1
1
2
2
2
	
θ
[
]
−
+
−
+
+
+
+
+


= −
+
+
+
b l
b l s
k l
k l
Y s
Js
b l
b l s
k l
k l
s
l b s
k U s
l b s
k U s
(
)
(
)
( )
(
)
(
)
( )
(
)
( )
(
)
( )
2 2
1 1
2 2
1 1
2
1 1
2
2 2
2
1 1
2
2 2
2
1
1
1
1
2
2
2
2
Denote the coefficients as
Vehicle body 
Vehicle
suspension 
Road
disturbances 
l1
l2
b2
k2
b1
k1
u2(t)
u1(t)
J
y
m
θ
FIGURE 6.2
A model of a vehicle with its suspension system.

297
Frequency-Domain Models
	
=
=
+
=
+
=
=
+
=
+
=
−
=
+
=
−
= −
+
=
+
=
+
C
m C
b s
k
C
b
b
C
J C
k
k
C
b l
b l
C
b l
b l
C
k l
k l
C
k l
k l
C
l b s
k
C
b s
k
C
l b s
k
;
;
;
;
;
;
;
;
;
(
);
;
(
)
1
7
2
2
2
1
2
8
3
1
2
9
1 1
2
2 2
2
4
2 2
1 1
10
1 1
2
2 2
2
5
2 2
1 1
11
1
1
1
6
1
1
12
2
2
2
 
Then
	
θ
θ
[
]
[
]
+
+


+
+
=
+
+
+
+
+


=
+
C s
C s
C
Y s
C s
C
s
C U s
C U s
C s
C
Y s
C s
C s
C
s
C U s
C U s
( )
( )
( )
( )
( )
( )
( )
( )
1
2
2
3
4
5
6
1
7
2
4
5
8
2
9
10
11
1
12
2
In the matrix form
	
θ
+
+
+
+
+
+
















=








+








C s
C s
C
C s
C
C s
C
C s
C s
C
Y s
s
C
C
U s
C
C
U s
( )
( )
( )
( )
1
2
2
3
4
5
4
5
8
2
9
10
6
11
1
7
12
2
Now, by taking the inverse of the left hand side (LHS) matrix we obtain
	
θ
∆








=








−
















Y s
s
s
P s
Q s
Q s
R s
l
l
C U s
C U s
( )
( )
1
( )
( )
( )
( )
( )
1
1
( )
( )
1
2
6
1
7
2
in which
	
=
+
+
= −
−
=
+
+
P s
Js
C s
C
Q s
C s
C s
R s
C s
C s
C
( )
( )
( )
2
9
10
4
5
1
2
2
3
and ∆s( ) is the characteristic polynomial of the system as given by the determinant of the 
transformed system matrix:
	
∆
=
−
−








s
P s
Q s
Q s
R s
( )
det
( )
( )
( )
( )
The transfer-function matrix is given by
	
∆
=
















G s
s
P s
Q s
Q s
R s
C
C
C
C
( )
1
( )
( )
( )
( )
( )
6
7
11
12
The individual transfer functions are given by the four elements of G(s) as
	
∆
θ
∆
∆
θ
∆
[
]
[
]
[
]
[
]
=
−
=
−
=
+
=
+
Y s
U s
P s
l Q s
s
C
s
U s
Q s
l R s
s
C
Y s
U s
P s
l Q s
s
C
s
U s
Q s
l R s
s
C
( )
( )
( )
( )
( )
( )
( )
( )
( )
( )
( )
( )
( )
( )
( )
( )
( )
( )
( )
( )
1
1
6
1
1
6
2
2
7
2
2
7

298
Modeling of Dynamic Systems with Engineering Applications
LEARNING OBJECTIVES
	
1.	 The vector-matrix approach to converting an I–O differential equation of a 
system into a transfer function
	
2.	 Analysis of a multi-input–multi-output (MIMO) problem.
■
6.4   Frequency-Domain Models
The transfer function of a device is given by output/input of device. As presented previ-
ously, if the output and the input are expressed in the Laplace domain (i.e., by the Laplace 
transforms of the corresponding time-domain signals), we have the Laplace transfer func-
tion. Alternatively, if the output and the input are expressed in the frequency domain 
(i.e., by the Fourier transforms of the corresponding time-domain signals), we have the 
­frequency transfer function. Specifically, in the frequency domain,
	
Frequency transfer function = Fourier transform of output
Fourier transform of input
Frequency response function is another name for frequency transfer function. Laplace trans-
fer function and Fourier (frequency) transfer function are completely equivalent and 
reversible through the change of variables 
ω
=
s
j .
Frequency-domain representations are particularly useful in the analysis, simulation, 
design, control, and testing of electro-mechanical systems. The signal waveforms encoun-
tered in such systems can be interpreted and represented as a combination of sinusoidal 
components (i.e., a Fourier spectrum). In particular, any periodic signal can be represented 
as a summation of sinusoidal (harmonic) components, which forms the Fourier series expan-
sion. Such periodic excitations are used, for example, in dynamic testing (vibration testing, 
shaker testing) of products and equipment. It is usually easier to determine by testing, the 
frequency-domain models than the associated time-domain models.
6.4.1   Frequency Transfer Function (Frequency Response Function)
Consider the time-domain system (Equation 6.11) whose transfer function (in the Laplace-
domain) is given by the Equation 6.12. The corresponding frequency transfer function is 
obtained through the substitution 
ω
=
s
j  in Equation 6.12. This fact can be easily shown, 
as given next.
Response to a Harmonic Input
Suppose that the system input is harmonic (sinusoidal). It can be expressed in the complex 
form
	
ω
ω
=
=
+
ω
u
u e
u
t
j
t
(cos
sin
)
o
j t
o
	
(6.23)
Note: Mathematically, we can always make the assumption of a “complex” input. Then, the 
response of the actual (real) system may be obtained from either the real part or the imagi-
nary part of the analytical response, which corresponds to the real part or the imaginary 

299
Frequency-Domain Models
part of the “complex” input. A complex signal has the exponential form (Equation 6.23), 
which is easier to analyze than either the cosine signal or the sine signal.
After applying the input, eventually, the conditions of the system will settle down (i.e., 
steady state will be reached). Then, the output (response) of the system will also be har-
monic, at the same frequency (ω), and given by:
	
ω
ω
=
=
+
ω
y
y e
y
t
j
t
(cos
sin
)
o
j t
o
	
(6.24)
By substituting Equations 6.23 and 6.24 into Equation 6.11 and cancelling the common 
term 
ω
e j t, we obtain
	
ω
ω
ω
ω
(
)
(
)
(
)
(
)
=
+
+
+
+
+
+








−
−
−
−
y
b
j
b
j
b
a
j
a
j
a
u
o
m
m
m
m
n
n
n
n
o
1
1
0
1
1
0


	
(6.25a)
or,
	
ω
(
)
=
y
G j
u
o
o 	
(6.25b)
(Note: 
ω
=
ω
ω
de
dt
j e
j t
j t)
Hence, it is seen that 
ω
G j(
) in Equation 6.25 is obtained precisely by substituting 
ω
=
s
j  
in Equation 6.12. Specifically, the frequency transfer function (FTF) or, the frequency response 
function (FRF) is given by
	
ω
ω
ω
ω
ω
=
=
+
+
+
+
+
+
ω
=
G j
G s
b
b j
b
j
a
a j
a
j
(
)
( )|
(
)
(
)
(
)
(
)
s
j
m
m
n
n
0
1
0
1


	
(6.26)
Note: Angular frequency variable (rad/s) is ω
π
=
f
2
, where f = cyclic frequency (Hz).
The meaning of the FRF is clear from Equation 6.25. When a harmonic input of fre-
quency ω and amplitude uo is applied to a system (linear, time-invariant), at steady state, 
its output will also be harmonic at frequency ω. However, the amplitude will be magnified 
by the magnitude of 
ω
(
)
G j
 and the phase angle will change by the phase angle of 
ω
(
)
G j
.
Further interpretation of the FRF 
ω
(
)
G j
 can be given because Fourier transform is a spe-
cial case of Laplace transform (as discussed before). Hence, Fourier results can be obtained 
directly from the Laplace-domain results, by substituting 
ω
=
s
j . Accordingly, from the 
Laplace result (Equation 6.12) we have the frequency-domain (Fourier) result:
	
ω
ω
ω
=
G j
Y j
U j
(
)
(
)
(
) 	
(6.26b)
where 
ω =
Y j
y t
(
)
F ( ) and 
ω =
U j
t
(
)
Fu( ) with F denoting the Fourier transform operator. 
In other words, FRF is obtained by dividing the Fourier spectrum of the output by the 
Fourier spectrum of the input.
Magnitude (Gain) and Phase
Let us denote the magnitude of 
ω
(
)
G j
 by
	
ω
(
) =
G j
M 	
(6.27a)

300
Modeling of Dynamic Systems with Engineering Applications
and the phase angle of 
ω
(
)
G j
 by
	
ω
φ
(
)
∠
=
G j
	
(6.27b)
Then, we can write
	
ω
φ
φ
(
) =
+
=
φ
G j
M
jM
Me
cos
sin
j
	
(6.27c)
Now from Equations 6.24 and 6.25b, we have
	
=
ω
φ
(
)
+
y
u Me
o
j
t
	
(6.28)
Using this result, we can make the same observations as before, for the harmonic response 
of a system.
Observations
•	 The frequency response function (FRF) is given by:
	
ω
ω
ω
=
=
G j
Y j
U j
(
)
(
)
(
)
Fourier spectrum of the output
Fourier spectrum of the input
•	 The frequency transfer function (FTF) is obtained by substituting 
ω
=
s
j  in the 
Laplace transfer function:
	
ω
ω
ω
ω
ω
=
=
+
+
+
+
+
+
ω
=
G j
G s
b
b j
b
j
a
a j
a
j
(
)
( )|
(
)
(
)
(
)
(
)
s
j
m
m
n
n
0
1
0
1


 
When a harmonic input of frequency ω is applied to the system, at steady state:
•	 The output is magnified by 
ω
(
)
=
M
G j
•	 The output has a phase lead w.r.t. the input, of φ
ω
(
)
= ∠G j
.
Note: For practical systems 
ω
(
)
∠G j
 is typically a negative phase lead (i.e., the output usu-
ally lags the input).
These observations further confirm that G(jω) constitutes a complete model for a linear, 
constant-parameter system (as does G(s)).
6.4.2   Bode Diagram (Bode Plot) and Nyquist Diagram
We have established that the frequency transfer function G(jω) is a complete model of (lin-
ear time-invariant) system. In general, FRF is a complex function of frequency ω, which is 
a real variable. Hence, the FRF has a magnitude and a phase angle, or a real part and an 
imaginary part, expressed as a function of frequency.
Experimental determination of G(jω) can be done in several ways. One straightforward 
method is indicated by the result (Equation 6.27):

301
Frequency-Domain Models
Step 1: Decide on the frequency range of interest ω ω
[
,
]
s
e . Set ω
ω
=
s
Step 2: Apply a harmonic (i.e., sinusoidal) excitation of known amplitude to the sys-
tem, at frequency ω  and measure the amplitude and the phase change at the 
output (response), at steady state.
Step 3: Increment the excitation frequency by a small step ( ∆ω ) according to 
ω
ω
∆ω
→
+
. If ω
ω
>
e Go to Step 4. Otherwise, go to Step 2.
Step 4: For each frequency, compute: (a) Gain 
G j(
)
ω  = [Output amplitude]/[Input amplitude]; (b) Phase lead ∠G(f) = [Phase angle of 
output]-[Phase angle of input].
Either a sine-sweep or a sine-dwell excitation may be used with this test. The frequency of 
excitation is varied continuously for a sine sweep, and in steps for a sine dwell. Sweep rate 
should be sufficiently slow, or dwell times should be sufficiently long, to guarantee achiev-
ing steady-state response during measurement, in these methods.
An alternative method of determining G(jω) is using the Fourier transform according to 
Equation 6.26b. The associated steps are as follows:
Step 1: Apply a transient excitation u(t) that has all the frequency components of 
interest, to the system, and measure the output (response) y(t).
Step 2: Compute the Fourier spectrum 
ω
Y j
y t
(
) of ( ) and the Fourier spectrum 
U j
u t
(
) of ( )
ω
.
Step 3: Compute the FRF, 
	
G j
Y j
U j
(
)
(
)
(
)
ω
ω
ω
=
.
Bode Plot (Bode Diagram): The analytical FRF or the dynamic test results are usually 
presented as the pair of curves
	
ω
ω
G j(
) versus
	
ω
∠G f( ) versus
with the log scales for both the magnitude axis (e.g., in decibels or 20log ()
10
) and the 
frequency axis (e.g., in decades, which are multiples of 10; octaves, which are multiples of 2; 
one-third octaves, which are multiples of 21/3 ). This pair of curves is called the Bode plot or 
Bode diagram.
Note: A linear scale is used for the phase angle axis.
Nyquist Diagram (Argand Plot or Polar Plot): The analytical FRF or the dynamic test 
results may also be plotted on the complex G(jω) plane with its real part plotted on the 
horizontal axis and the imaginary part on the vertical axis. The resulting curve is termed 
the Nyquist diagram or the argand plot or the polar plot.

302
Modeling of Dynamic Systems with Engineering Applications
In a Bode diagram, the frequency is shown explicitly on the horizontal axis, whereas in 
a Nyquist plot the frequency is an implicit parameter on the curve, and is not explicitly 
shown unless the curve itself is calibrated. In Bode diagrams, it is customary and conve-
nient to give the magnitude in decibels (
ω
G j
20log
(
)
10
) and scale the frequency axis in 
logarithmic units (typically factors of 10 or decades). Since the argument of a logarithm 
should necessarily be a dimensionless quantity, Y(jω) and U(jω) should have the same 
units. If not, G(jω) should be divided by some base value such as G(0) (i.e., the static gain) in 
order to non-dimensionalize it.
The arrow on a Nyquist curve indicates the direction of increasing frequency. Only the 
part corresponding to positive frequencies is actually shown. The frequency response 
function corresponding to negative frequencies is obtained by replacing ω by –ω or, equiv-
alently, jω by –jω. The result is clearly the complex conjugate of G(jω), and is denoted G*(jω):
	
ω =
ω
=−
G
j
G s
(
)
( ) s
j
*
	
(6.29)
Since, in complex conjugation, the magnitude does not change and the phase angle changes 
sign, it follows that the Nyquist plot for G*(jω) is the mirror image of that for G(jω) about 
the real axis. In other words, the Nyquist plot for the entire frequency range ω [−∞, +∞] is 
symmetric about the real axis.
Example 6.4
The transfer function of a dynamic system is given by 
(
)
(
)
=
+
+
+
G s
s
s
s
( )
3
4
16
2
	 (a)	 Tabulate the values of the magnitude 
ω
G j(
)  and the phase angle 
ω
∠G j(
)  for 
about 6 points of frequency in the range ω = 0 to ω = 5
	 (b)	 Plot the Nyquist diagram for G using this data. Also plot the Bode and Nyquist 
diagrams using MATLAB.
	 (c)	 If the system (G) is given the sinusoidal input 
=
u
t
2cos2 , what is the corre-
sponding output at steady state?
Solution
By setting 
ω
=
s
j
 we get the FTF
	
ω
ω
ω
ω
=
+
−
+
G j
j
j
(
)
3
16
4
2
	
(i)
Hence
	
ω
ω
ω
ω
(
)
=
+
−
+
G j(
)
3
16
16
2
2
2 2
2 	
(ii)
and
	
ω
ω
ω
ω
ω
ω
π
ω
ω
ω
∠
=
−
−
<
=
−
+
−
>
−
−
−
−
G j(
)
tan
3
tan
4
16
for
4
tan
3
tan
4
16
for
4
1
1
2
1
1
2
	
(iii)

303
Frequency-Domain Models
Note: When ω > 4, the real part of the denominator of the FTF (i) is negative (and the 
imaginary part is positive). Hence, the denominator term is in quadrant 2 of the complex 
plane. The denominator phase angle = π − [phase angle obtained by using +ve real part] = 
π
ω
ω
−
−
−
tan
4
16
1
2
. This has to be subtracted from the numerator phase angle 
ω




−
tan
3
1
, 
to get the overall phase angle of G(jω). This gives the second part of Equation (iii).
	  (a) 	
	  (b)	 The Nyquist curve is now plotted (using this data and interpolation) as shown 
in Figure 6.3a.
Note:	 For negative frequencies (ω =
−∞
−
0 to
) the indicated curve (ω =
∞
+
0 to + ) 
has to be mirror-imaged about the real axis.
The Bode and Nyquist curves may be obtained using the following MATLAB commands:
MATLAB Commands
	
	 >> num=[1 3];
	
	 >> den=[1 4 16];
	
	 >> G=tf(num,den);
	
	 >> bode(G),grid
	
	 >> nyquist(G),grid
The resulting curves are shown in Figure 6.3b and c.
	  (c) 	  FTF of the system is 
ω
ω
ω
ω
(
)
=
+
−
+
G j
j
j
(
)
3
16
4
2
At ω = 2 rad/s: 
ω =
G j(
)
0.25  and 
ω
∠
= ° =
G j(
)
0
0rad
Hence, the steady-state response for an input of 
=
u
t
2cos2  is
	
=
×
+
y
t
2
0.25cos(2
0)
	
=
y
t
or:
0.5cos2
LEARNING OBJECTIVES
	
1.	 Manual computation of Bode and Nyquist plots of a transfer function
	
2.	 Use of MATLAB to get the Bode and Nyquist curves
	
3.	 Determining the harmonic response of a system using its FTF
■
Frequency
	 ω
0
1
2
3
4
5
∞
Magnitude
	
ω
G j(
)
3/16
0.204
0.25
0.305
0.3125
0.266
0
(dB)
(−14.5)
(−13.8)
(−12)
(−10.3)
(−10.1)
(−11.5)
(−∞)
Phase
	
ω
∠G j(
)
(degrees)
0
3.5
0
−14.7
−36.8
−55.2
−90

304
Modeling of Dynamic Systems with Engineering Applications
6.4.3   Bode Diagram Using Asymptotes
The denominator (characteristic) polynomial of a transfer function may be factor-
ized into first-order terms of the form (s + a), and second-order oscillatory terms 
ζω
ω
ζ
+
+
≤
<
s
s
(
2
),0
0
n
n
2
2
. The numerator polynomial also can be similarly factorized. 
The Bode plot of each factor (component) can be easily determined. Then, the Bode plot of 
the entire transfer function can be constructed (by using only additions and subtractions 
of the component plots, in view of the log scales). The rationale for this is the following:
•	 In a product of complex numbers, the magnitudes multiply and the phase angles 
add.
•	 In a quotient of complex numbers, the magnitudes divide and the phase angles 
subtract.
•	 Since a log scale (dB) is used for the magnitudes, the multiplications and divisions 
of the magnitudes are “transformed” into additions and subtractions.
An advantage of the log scale for magnitude is that the Bode diagram for a product of sev-
eral transfer functions can be obtained by simply adding the Bode plots for the individual 
transfer functions. In this manner, the Bode plot of a complex system can be conveniently 
obtained with the knowledge of the Bode plots of its components.
Note: In a Bode plot, a linear scale is used for the phase angle. Hence, the component 
phase angles also add (or subtract).
When a log scale is used for both magnitude and frequency, it emphasizes the lower 
values in a range. The x-axis (frequency axis) of the Bode plot is marked in units of 
frequency, which may be incremented by factors of 2 (octaves) or factors of 10 (decades). 
Typically in a Bode plot, the frequency axis is scaled in decades. This is a linear log10
scale. The amplitude axis is given in decibels (dB), which is also a log10 scale, specifically 
20log ( )
10
 in decibels (dB).
Note: 
=
20log ()
10log () .
10
10
2  Since power and energy are represented by the square of 
a signal such as voltage, current, velocity, and force, it is clear that 10 dB corresponds 
to a power (or energy) increase by a factor of 10 or a signal increase by a factor of 10 . 
Similarly, 20 dB corresponds to a signal increase by a factor of 10 or a power increase by 
a factor of 100.
The exercise of sketching a Bode diagram may be further simplified by first sketching 
the asymptotes of the elementary terms (s + a) and 
ζω
ω
ζ
+
+
≤
<
s
s
(
2
),0
0
n
n
2
2
 and then 
approximating the actual curves, which will approach the asymptotes in the limit. This 
approach is illustrated now using examples.
Example 6.5
Sketch the Bode plot of the transfer function [Output speed/Input voltage] of an arma-
ture controlled dc motor, given by 
τ
( )
(
)
=
+
G s
K
s
1
where
K = gain parameter (depends on motor constants, armature resistance, and damping)
τ  = time constant (depends on motor inertia, motor constants, armature resistance, and 
damping).
Solution
This is a first-order system. The FTF corresponding to the given TF is

305
Frequency-Domain Models
Nyquist plane
Im
Re
0
3/16
3
4
5
2
(a)   
(b)   
–40
–30
–20
–10
0
10–1
10–0
10–10
10–2
–90
–45
0
45
Bode diagram
Frequency  (rad/s)
Phase (deg)
Magnitude (dB)
ω  =  1
ω = ∞
ω =  0
(c)    
0.3
0.2
0.1
0
Imaginary cxis
–0.1
–0.2
–0.3
–0.2
–0.1
–10 db
-20 db
0
0.1
0.2
Real axis
Nyquist diagram
0.3
0.4
FIGURE 6.3
(a) Nyquist curve using data interpolation; (b) Bode plot using MATLAB; and (c) Nyquist diagram using 
MATLAB.

306
Modeling of Dynamic Systems with Engineering Applications
	
ω
τ ω
π
τ
π
(
)
(
)
(
)
(
)
=
+
=
+
G j
K
j
G j
f
K
j
f
1 or
2
2
1
	
(i)
Here ω is the angular frequency (in rad/s) and f is the cyclic frequency (in cycles/s or Hz).
Note: The complex functions 
ω
G j(
) and 
π
G j
f
( 2
) may be denoted by 
ω
G( ) and G f( ), 
respectively, for notational convenience (even though contrary to strict mathematical 
meanings).
The numerator term in the TF is a constant. The asymptotes for the numerator and the 
denominator of the TF are determined now. First, we define a critical frequency (break 
frequency) where the real part and the imaginary part of the considered factor are equal:
	
πτ
=
f
1
2
b
	
(ii)
	
( ) ≈
f
f
G f
K
When
:
b
≪
	
(iii)
The corresponding magnitude is K (or 
K
20log10
 dB). This asymptote is a horizontal 
line as shown in Figure 6.4. The phase angle of this asymptote is zero.
	
τ
π
( ) ≈
f
f
G f
K
j
f
When
:
2
b
≫
	
(iv)
The magnitude of this function is 
τ π
(
)
K
f
2
. It monotonically decreases with frequency. 
If decibel scale (i.e., 20log ()
10  dB) is used for the magnitude axis and decade scale (i.e., 
multiples of 10) for the frequency axis, the slope of this asymptote is –20 dB/decade. The 
phase angle of this asymptote is 90°.
The two asymptotes intersect at 
=
f
fb. This frequency is the break frequency (or the 
corner frequency).
Note: Since a significant magnitude attenuation takes place for input signal frequen-
cies greater than fb and in view of the fast decay of the natural response for large fb , 
it is appropriate to consider fb, given by Equation (ii), as the limiting frequency for the 
frequency response, a measure of the bandwidth, for a dc motor.
The asymptotes are drawn and the approximate Bode plots are sketched based on 
them (so as to approach them in the limit) as shown in Figure 6.4.
Suppose that a sinusoidal signal is used as the input test signal to the dc motor. As the 
input frequency is raised, the output amplitude decreases and the phase-lag increases, 
as confirmed by the Bode plot.
Note 1: Similarly it can be shown that for a transfer-function component of the form 
τ
( )
(
)
=
+
G s
K
s
1 , the second asymptote (beyond the break point of ω
τ
= 1/
b
) of the 
magnitude (gain) will have a slope of +20 dB/decade and the second asymptote of the 
phase angle will be a constant at +90°.
Note 2: The advantages of using a log scale for frequency are the fact that a wide range 
of frequencies can be accommodated in a limited plotting area, and that asymptotes to 
the magnitude curve become straight lines with slopes differing by fixed increments 
(by ±20 dB/decade if the decibel scale is used for magnitude and the decade scale is 
used for frequency).
LEARNING OBJECTIVES
	
1.	 Use of asymptotes to sketch a Bode plot
	
2.	 The use of log scales in the Bode plot

307
Frequency-Domain Models
	
3.	 Break frequency, corner frequency, and bandwidth of a simple TF
	
4.	 The asymptote slope of a first-order factor in the denominator is −20 dB/decade
	
5.	 The asymptote slope of a first-order factor in the numerator is +20 dB/decade ■
Example 6.6
Consider a damped oscillator, which has the frequency transfer function (FTF):
	
ω
ω
ω
ζω ω
ζ
(
)
(
) =
−
+
<
<
G j
K
j
2
0
1
n
n
2
2
	
(i)
Note: This is an underdamped system, with its damping ratio ζ less than 1. For it to have 
a resonance, we need 
ζ
<
<
0
1/
2 .
The break point for the asymptotes is the undamped natural frequency ωn .
For ω
ωn
≪
 the frequency transfer function (i) can be approximated by the static gain 
(i.e., the zero-frequency magnitude):
	
ω
ω
≈
G j
K
(
)
n
2 	
(ii)
Phase angle (radians)
Magnitude (dB)
0
0
20log10
20log10
K
G(f )
Frequency f
Asymptote
slope = –20 dB/decade
fb
2
fb  = 1/(2
)
f
Asymptote
slope = 0 dB/decade
Corner frequency
(Break frequency)
π—
–
4
π—
–
G( f )
FIGURE 6.4
Bode diagram of a dc motor transfer function.

308
Modeling of Dynamic Systems with Engineering Applications
This is a real transfer function. Its magnitude is a constant and hence the slope of its Bode 
plot is zero. The phase angle is zero as well, in this region (because the FTF is real). The 
corresponding gain and phase asymptote pair (for ω
ω
= 0 to
n) is shown in Figure 6.5a.
For ω
ωn
≫
 the frequency transfer function (i) can be approximated by
	
ω
ω
(
) ≈−
G j
K
2
	
(iii)
In this region, the magnitude in decibels is 
ω
ω



−




K
K
20log
40log
dB
o
o
10
10
Note: K  and ω  are nondimensionalized because mathematically it is not correct to 
obtain the logarithm of a dimensional quantity. An important observation, however, is 
that when the frequency changes by 1 decade (i.e., when ω ω = 10
o
), the magnitude of 
this expression changes by −40dB.
Hence, the slope of this asymptote is −40 dB/decade. Since (iii) represents a negative 
real quantity, its phase angle is −180°. The corresponding gain and phase asymptote pair 
(for ω
ω
=
∞
to
n
) is shown in Figure 6.5a.
For the sake of completion, the Bode and Nyquist plots of the damped oscillator are 
shown in Figure 6.5b and c.
LEARNING OBJECTIVES
	
1.	 Use of asymptotes to sketch a Bode plot
	
2.	 The asymptote slope of a 2nd order factor in the denominator is −40 dB/decade
	
3.	 Special consideration in Bode sketching near a resonance (in an under-damped 
system)
	
4.	 Further understanding of decibels (dB) and decades (frequency multiples of 10) ■
6.5 Mechanical Impedance and Mobility
Impedance is a transfer function, which is useful in both mechanical and electrical sys-
tems. However, mechanical impedance is not analogous to electrical impedance. It is the 
mobility, which is the inverse of mechanical impedance that is analogous to electrical 
impedance. Mechanical impedance is analogous to electrical admittance. Specifically, elec-
trical impedance and mechanical mobility are A-type transfer functions (Across-variable/
Through-variable) or, generalized impedances. Mechanical impedance and electrical admit-
tance are T-type transfer functions (Through-variable/Across-variable). In view of the exist-
ing analogies (particularly, the force-current analogy, as used in linear graphs), which 
have been studied in the previous chapters, similar treatments are possible concerning 
analogous transfer functions in mechanical and electrical systems. Several relevant topics 
are addressed next.
6.5.1 Transfer Functions in Mechanical Systems
The use of the frequency transfer function as a dynamic model has been addressed in the 
previous sections. Its significance can be illustrated by considering the damped mechani-
cal oscillator (i.e., a single degree-of-freedom mass-spring-damper system) shown in 
Figure 6.1. Its force-displacement transfer function, in the frequency domain, is

309
Frequency-Domain Models
(a)
0
1
Im
G(jω)
Re
G(jω)
ω
(c)
Frequency ω
(Log scale) 
Magnitude (dB)
0
Exact curve
Asymptotes
20log10
G
Slope = 0 dB/decade
(r = 0)
Slope = –40 dB/decade
(r = –2)
ωn
Phase Angle (deg)
–180°
–90°
0°
φ
ωn
ω
(b)
Frequency (ω/ωn)
Phase (deg)
Magnitude (dB)
–40
–20
0
20
10–1
–180
–120
–60
0
100
101
FIGURE 6.5
Damped oscillator: (a) Asymptotes of Bode plot; (b) Bode plot; and (c) Nyquist plot.

310
Modeling of Dynamic Systems with Engineering Applications
	
ω
ω
=
+
+
=
G j
ms
bs
k
s
j
(
)
1
with
2
	
(6.30)
in which m, b, and k denote mass, damping constant, and stiffness, respectively. When the 
excitation frequency ω is small in comparison to the system natural frequency ω =
k
m
/
n
, 
the terms ms2 and bs can be neglected with respect to k; and the system behaves as a simple 
spring. When the excitation frequency ω is much larger than the system natural frequency, 
the terms bs and k can be neglected in comparison to ms2. In this case the system behaves 
like a simple mass element. When the excitation frequency ω is very close to the natural 
frequency (i.e., 
ω
ω
=
≈
=
s
j
j
j k m
n
), it is seen from Equation 6.30 that the term ms2 + k 
in the denominator of the transfer function (i.e., the characteristic polynomial) becomes 
almost zero, and can be neglected. Then the transfer function can be approximated by 
G(jω) = 1/(bs) with s = jω.
In summary:
•	 When the excitation frequency approaches the resonant frequency or natural fre-
quency (i.e., for intermediate values of excitation frequencies), system damping 
becomes the most important parameter. Then the system behaves like a damper, 
and the largest response occurs at the resonant frequency. We have: As 
	
ω
ω
ω
ω
→
→
G j
bj
,
(
)
1
n
•	 At low excitation frequencies the system stiffness is the most significant param-
eter. Then the system behaves like a spring, giving a somewhat “static” response. 
We have: As 
	
ω
ω
→
→
G j
k
0,
(
)
1
•	 At high excitation frequencies the mass is the most significant parameter. Then the 
system behaves like a mass, and its response tends to zero (i.e., it is very difficult 
for a mass to move at very high frequencies). We have: As 
	
ω
ω
ω
→∞
→−
→
G j
m
,
(
)
1
0
2
Note: In these observations, instead of the physical parameters m, k, and b, we could use 
natural frequency ωn = k m  and the damping ratio ζ = b
mk
(2
) as the system param-
eters. Then the number of system parameters reduces to two, which is an advantage in 
parametric and sensitivity studies.
Mechanical Transfer Functions
Any force variable or motion variable of a system may be used as the input and the output 
in defining an “analytical” transfer function in the mechanical system. However, some 
such transfer functions may not be physically realizable (Then, for practical purpose, the 
input and the output must be reversed). We can define several versions of frequency trans-
fer functions that may be useful in the modeling and analysis of mechanical systems. 
Some relatively common ones are given in Table 6.1.
In the frequency domain:

311
Frequency-Domain Models
Acceleration = (jω) × (Velocity)
Displacement = Velocity/(jω)
In view of these relations, many of the alternative types of transfer functions defined 
in Table 6.1 are related to the mechanical impedance and mobility through the factor jω. 
Specifically
	
ω
ω
ω
ω
=
=
×
=
=
=
=
=
=
×
j
j
j
j
Dynamic stiffness
Force/Displacement
Mechanical impedance
Receptance
Displacement/Force
Mobility/(
)
Dynamic inertia
Force/Acceleration
Impedance/(
)
Accelerance
Acceleration/Force
Mobility
In these definitions the variables force, acceleration and displacement should be inter-
preted as the corresponding Fourier spectra.
Mechanical Impedance and Mobility
In studies of mechanical systems, three types of frequency transfer functions are particu-
larly useful. They are mechanical impedance, mobility, and transmissibility, as presented in 
Table 6.1. In a mechanical impedance function, velocity is considered the input variable 
and the force is the output variable, whereas in a mobility function the converse applies. 
It is clear that mobility is the inverse of mechanical impedance. Either transfer function 
may be used in the “analysis” of a given problem, for convenience of analysis, as will be 
clear from the examples presented in this chapter. However, in the context of practical 
application, some transfer functions may not be physically realizable (even though they 
have analytical expressions).
6.5.2 Interconnection Laws
Once the transfer functions of the basic components (elements) of a system are known, the 
interconnection laws may be used to determine the overall transfer function of the system. 
Two types of interconnection are possible for two components:
TABLE 6.1
Definitions of Useful Mechanical Transfer Functions
Transfer Function
Definition
(in Laplace or Frequency Domain)
Dynamic stiffness
Force/displacement
Receptance (dynamic flexibility or compliance)
Displacement/force
Mechanical impedance (Z)
Force/velocity
Mobility (M)
Velocity/force
Dynamic inertia
Force/acceleration
Accelerance
Acceleration/force
Force transmissibility (Tf)
Transmitted force/applied force
Motion transmissibility (Tm) 
Transmitted velocity/applied velocity

312
Modeling of Dynamic Systems with Engineering Applications
	
1.	Series connection
	
2.	Parallel connection
Determination of the interconnection laws is straightforward in view of the fact that:
	
1.	For series-connected elements: the through-variable is common and the across-
variables add.
	
2.	For parallel-connected elements: the across-variable is common and the through-
variables add.
Interconnection Laws for Mechanical Impedance and Mobility
Since mobility is given by an across-variable (velocity) divided by a through-variable 
(force), it is clear (on dividing throughout by the common through-variable) that for series-
connected elements the mobilities add (or, the inverse of mechanical impedance is addi-
tive) or generalized impedances add.
Since mechanical impedance is given by a through-variable (force) divided by an across-
variable (velocity), it is clear (on dividing throughout by the common across-variable) that 
for parallel-connected elements the mechanical impedances add (or, the inverse of mobil-
ity is additive).
These interconnection laws are presented in Table 6.2. 
Interconnection Laws for Electrical Impedance and Admittance
Since electrical impedance is given by
	
(
)
(
)
Electrical impedance = Across-variable voltage
Through-variable current
,
it is clear (on dividing throughout by the common through-variable) that for series-con-
nected elements the electrical impedances add (or, the inverse of admittance is additive).
Since admittance is given by
	
Electrical admittance = Through-variable (current)
Across-variable (voltage)
,
it is clear (on dividing throughout by the common across-variable) that for parallel-con-
nected elements the admittances add (or, the inverse of electrical impedance is additive). 
These interconnection laws for electrical systems are presented in Table 6.3.
A-Type Transfer Functions and T-Type Transfer Functions
Electrical Impedance and Mechanical Mobility are “A-type transfer functions” because
	
A-type transfer function = [Across-variable]
[Through-variable]
They follow the same interconnection laws (compare Tables 6.2 and 6.3).

313
Frequency-Domain Models
Electrical Admittance and Mechanical Impedance are “T-type transfer functions” 
because
	
T-type transfer function =[Through-variable]
[Across-variable]
They follow the same interconnection laws (compare Tables 6.2 and 6.3).
6.5.3 Transfer Functions of Basic Elements
Since a complex system can be formed through series and parallel interconnections of 
basic elements, it is possible to systematically generate the transfer function of a complex 
system by using the transfer functions of the basic elements.
In Chapter 2, the linear constitutive relations for the mass, spring and the damper ele-
ments are presented as time-domain relations. The corresponding transfer functions are 
obtained by replacing the derivative operator d/dt by the Laplace operator s. The frequency 
transfer functions are obtained by substituting jω or j2πf for s. In this manner, the trans-
fer functions of the basic (linear) mechanical elements: mass, spring, and damper are 
obtained, as given in Table 6.4.
Similarly, in Chapter 2, the linear constitutive relations for the electrical capacitor, induc-
tor, and resistor elements are presented as time-domain relations. The corresponding 
transfer functions are obtained by replacing the derivative operator d/dt by the Laplace 
TABLE 6.2
Interconnection Laws for Mechanical Impedance (Z) and Mobility (M)
Series Connection
Parallel Connection
v
v
v
1
2
=
+
f
f
f
1
2
=
+
v
f
v
f
v
f
1
2
=
+
=
=
f
v
f
v
f
v
1
2
M
M
M
1
2
=
+
=
+
Z
Z
Z
1
2
 Z
Z
Z
1
1
1
1
2
=
+
 
or
 
Z
Z Z
Z
Z
1
2
1
2
=
+
M
M
M
1
1
1
1
2
=
+
 
or M
M M
M
M
1
2
1
2
=
+
TABLE 6.3
Interconnection Laws for Electrical Impedance (Z) and Admittance (W)
Series Connections
Parallel Connections
v
v
v
1
2
=
+
=
+
i
i
i
1
2
v
i
v
i
v
i
1
2
=
+
=
=
i
v
i
v
i
v
1
2
Z
Z
Z
1
2
=
+
=
+
W
W
W
1
2
W
W
W
1
1
1
1
2
=
+
 
or
 
W
W W
W
W
1
2
1
2
=
+
 
=
+
Z
Z
Z
1
1
1
1
2
 
or
 
=
+
Z
Z Z
Z
Z
1
2
1
2

314
Modeling of Dynamic Systems with Engineering Applications
operator s. In this manner, the transfer functions of the basic (linear) electrical elements are 
obtained, as given in Table 6.5.
Examples are given next to demonstrate the use of mechanical impedance and mobility 
methods in the development of frequency-domain models. In particular, the interconnec-
tion of the transfer functions (mechanical impedance and mobility) of the basic mechani-
cal elements (mass—an A-type element, spring—a T-type element, damper—a D-type 
element), along with the input elements (force source, which is a T-source, and velocity 
source, which is an A-source) is demonstrated. We do not consider examples in the electri-
cal domain in the present section mainly because the present approach is common knowl-
edge in the field of electrical engineering. In fact the mechanical circuits that we use here 
are analogous to electrical circuits, and also are the parent schematic diagrams used in the 
process of generating linear graphs (see Chapters 5 and 7). Similarly, the present approach 
can be easily extended to the fluid domain and the thermal domain (Note: There is no 
T-type element in the thermal domain).
Example 6.7: Ground-Based Mechanical Oscillator
Consider the damped mechanical oscillator shown in Figure 6.6a. This may represent 
a simple machine mounted on a rigid floor. Its mechanical impedance circuit is given 
in Figure 6.6b. This circuit will clearly show the “structure” of the system (whether the 
elements are connected in series or parallel).
TABLE 6.4
Mechanical Impedance and Mobility of Basic Mechanical Elements
Element
Time-Domain Model
Mechanical Impedance
Mobility
(Generalized Impedance)
Mass
m
=
m dv
dt
f
=
Z
ms
m
=
M
ms
1
m
Spring
k
=
df
dt
kv
=
Z
k
s
k
=
M
s
k
k
Damper
b
=
f
bv
=
Z
b
b
=
M
b
1
b
TABLE 6.5
Impedance and Admittance of Basic Electrical Elements
Element
Time-Domain Model
Impedance (Z)
Admittance (W)
Capacitor
C
=
C dv
dt
i
=
Z
Cs
1
C
=
W
Cs
C
Inductor
L
=
L di
dt
v
=
Z
Ls
L
=
W
Ls
1
L
Resistor
R
=
Ri
v
=
Z
R
R
=
W
R
1
R

315
Frequency-Domain Models
Note: In the mechanical impedance circuit we have indicated the two ends (terminals) 
of each element. In particular, a mass element always has the ground as the reference 
terminal (with a virtual connection, indicated by a broken line—see Chapter 5). Also, a 
source element has the ground as its reference terminal.
Since the input is the force f(t), the source element is a force source (a through-variable 
source or T-source).
The output (response) of the system is the velocity v. The corresponding transfer func-
tion V(jω)/F(jω) is a mobility function.
From Figure 6.6b it is clear that the four elements (mass, spring, damper, and source) 
in the system are connected in parallel. This structure is clear as well from the mechani-
cal impedance circuit shown in Figure 6.6c.
Note: Analytically, the mechanical impedance representation (rather than the mobility 
representation) is more convenient when combining parallel elements because mechan-
ical impedance is a T-type transfer function: Across-variable/Through-variable), and 
they simply add in parallel connection. Of course, it is okay to indicate mobilities in 
b
k
m
f (t)
v
Suspension
(a)
(c)
(b)
v
0
Zk
Zb
Zm
f (t)
v
0
f (t)
f s(t)
FIGURE 6.6
(a) Ground-based mechanical oscillator; (b) schematic mechanical circuit; and (c) mechanical impedance circuit.

316
Modeling of Dynamic Systems with Engineering Applications
Figure 6.6c and call it a “mobility circuit.” Whether a particular transfer function is 
physically realizable is a different issue, which needs to be addressed in the final result 
and not in the intermediate analytical steps.
The overall impedance function of the system is
	
ω
ω
ω
=
=
+
+
=
+
+
=
+
+
ω
ω
=
=
Z j
F j
V j
Z
Z
Z
ms
k
s
b
ms
bs
k
s
(
)
(
)
(
)
m
k
b
s
j
s
j
2
	
(6.31)
The mobility function is the inverse of Z(jω):
	
ω
ω
ω
=
=
+
+
ω
=
M j
V j
F j
s
ms
bs
k
(
)
(
)
(
)
s
j
2
	
(6.32)
It is known that this transfer function is physically realizable because the numerator order 
(1) is not greater than the denominator order (2). This is further confirmed by the physi-
cal fact that the input to the system is the force and the output is the velocity, and the cor-
responding mobility function governs the system behavior. In this transfer function, the 
characteristic polynomial is 
+
+
s
bs
k
2
, which corresponds to a damped oscillator (a 2nd 
order system). Accordingly, the behavior (particularly, the free or natural response) of 
the system is governed by this characteristic polynomial.
Another useful TF in the present example is that corresponding to the suspen-
sion force fs. The suspension system has the parallel elements with mechani-
cal impedances 
=
Z
k
s
k
 and 
=
Z
b
b
. Their combined mechanical impedance is 
=
=
+
=
+
=
+
F
V
Z
Z
Z
k
s
b
bs
k
s
s
s
k
b
. Combining this with Equation 6.32 we obtain
	
ω
ω
=
+
+
+
ω
=
F j
F j
bs
k
ms
bs
k
(
)
(
)
s
s
j
2
	
(6.33)
In fact, this is the force transmissibility function, which we will further discuss in the next 
section.
Note: Upper case letters are used for the variables to denote their Fourier spectra.
Degenerate Situation: Suppose that in this example, the force source (T-source) is 
replaced by a velocity source (A-source). Then, as we have discussed in Chapter 5, the 
three elements (mass spring and damper) become completely decoupled. Each element 
can be analyzed separately where the given velocity source is the input to each ele-
ment. In fact, with a velocity input, the mass element becomes physically non-realizable 
(transfer function 
=
Z
ms
m
) and the damping element becomes “algebraic” having a 
constant transfer function 
=
Z
b
b
. In this case, the spring element has the transfer func-
tion 
=
Z
k
s
k
, and is physically realizable. In essence, then, with a velocity input, the 
system in Figure 6.6 becomes degenerate and practically useless.
Observation: Suppose that using a force source, a known forcing function is applied to 
this system (with zero initial conditions) and the velocity response is measured. Next, 
using a velocity source if we move the mass exactly according to this predetermined 
velocity, the force generated at the source (the dependent variable of the velocity source) 
will be identical to the originally applied force. This is because, mobility is the recipro-
cal (inverse) of impedance. This reciprocity should be intuitively clear because we are 
dealing with the same system and same initial conditions. Due to this property, we may 
use either the impedance representation or the mobility representation, depending on 
whether the elements are connected in parallel or in series, irrespective of whether the 

317
Frequency-Domain Models
input is a force or a velocity or whether the transfer functions are physically realizable. 
This will be a matter of analytical convenience rather than practical importance.
LEARNING OBJECTIVES
	
1.	 Use of the concepts of mechanical impedance and mobility in frequency-
domain modeling
	
2.	 System structure representation using a schematic mechanical circuit or a 
mechanical impedance/mobility circuit
	
3.	 Determination of the system TF using the element TFs and the system struc-
ture (series or parallel connection)
	
4.	 Physical realizability of a TF.
■
Example 6.8: Oscillator with Support Motion
Consider the system shown in Figure 6.6a, where a mass-spring-damper system is sup-
ported on a movable platform. This may represent a simple (1D) model of a vehicle or 
an elevator. In this example the motion of the mass m is not associated with an external 
force. The support (platform) velocity v(t) is the input (an A-source), with the associated 
force f, which is the dependent variable of the source. A schematic mechanical circuit for 
the system is shown in Figure 6.6b and the corresponding impedance circuit is shown 
in Figure 6.6c. These circuits clearly indicate that the spring and the damper are con-
nected in parallel, and the mass is connected in series with this pair. By impedance 
addition for parallel elements, and mobility addition for series elements, it is seen that 
the overall mobility function of the system is
	
ω
ω
=
+
+
=
+
+
=
+
+
+
ω
ω
=
=
V j
F j
M
Z
Z
ms
k s
b
ms
bs
k
ms bs
k
(
)
(
)
1
(
)
1
1
(
)
(
)
m
k
b
s j
s j
2
	
(6.34)
However, since we know that the input is the velocity v(t), the proper transfer function 
is the mechanical impedance function:
	
ω
ω =
+
+
+
ω
=
F j
V j
ms bs
k
ms
bs
k
(
)
(
)
(
)
s
j
2
	
(6.35)
Furthermore, since the same force goes through to the mass element (see the circuit 
diagrams in Figure 6.7) we have
	
ω
ω
=
ω
=
V j
F j
ms
(
)
(
)
1
s
j
1
	
(6.36)
A practically more useful TF is the one that uses the velocity of the mass (v1) as the 
output. The corresponding TF is obtained by combining Equation 6.36 with Equation 
6.34. We obtain
	
ω
ω
=
+
+
+
ω
=
V j
V j
bs
k
ms
bs
k
(
)
(
)
(
)
s
j
1
2
	
(6.37)
Clearly, this transfer function is physically realizable. In fact, this is the motion transmis-
sibility function, which we will further discuss in the next section. It is interesting to 
note that this TF is same as that given by Equation 6.33 (the expressions are the same 
but the meanings are different).

318
Modeling of Dynamic Systems with Engineering Applications
Note: If the force at the support (platform) is the input (a force source, which is a 
T-source) it is clear that the same input force (f) goes through the combined spring-
damper unit and the mass element. Then, the spring-damper unit becomes completely 
uncoupled from the mass element, and they may be treated as two independent mod-
ules with input f applied separately. This situation is problematic for several reasons:
•	 Consider the mass element as an uncoupled unit. The corresponding TF is the 
mobility function V1(jω)/F(jω). This is a simple integrator, as given by (6.36). 
Physically, when a force f is applied to the mass, it will accelerate in proportion, 
regardless of the behavior of the other components (spring and damper) in the 
system. In particular, when f is constant, a constant acceleration is produced at the 
mass, causing its velocity to increase linearly (a behavior of simple “integration”). 
This is an “unstable” device (such as a solid rocket).
•	 If the support (platform) velocity is considered as the output, the system TF is 
given by the inverse of Equation 6.35: 
ω
ω
=
+
+
+
ω
=
V j
F j
ms
bs
k
ms bs
k
(
)
(
)
(
)
s
j
2
. In theory, this is 
physically realizable (because the numerator order is not greater than the denomi-
nator order). However, the characteristic polynomial of the system is ms(bs + k), 
which is known to be inherently unstable due to the presence of the free integra-
tor, and has a nonoscillatory transient response.
v(t)
v1
b
k
(b)
Velocity
source
0
m
+
_
v1
b
k
m
v(t)
f
(a)
(c)
v1
Zb
Zk
Zm
f
0
f
_
+
v(t)
FIGURE 6.7
(a) A mechanical oscillator with support motion; (b) schematic mechanical circuit; and (c) mechanical imped-
ance circuit.

319
Frequency-Domain Models
Note: Uppercase letters are used for the variables to denote their Fourier spectra.
LEARNING OBJECTIVES
	
1.	 Use of the concepts of mechanical impedance and mobility in frequency-
domain modeling
	
2.	 System structure representation using a schematic mechanical circuit or a 
mechanical impedance/mobility circuit
	
3.	 Determination of the system TF using the element TFs and the system struc-
ture (series or parallel connection)
	
4.	 Proper inputs, proper transfer functions, and physical realizability 
■
6.6 Transmissibility Function
Transmissibility is another transfer function that is quite versatile in mechanical systems. 
Transmissibility functions are transfer functions that are particularly useful in the design 
and analysis of fixtures, suspensions of vehicles, and mounts and support structures for 
machinery and other engineering systems (with moving parts and inertia, flexibility, and 
damping characteristics). They are directly applicable in the studies of vibration isolation 
(engine mount) and vehicle suspension design. Two types of transmissibility functions—
force transmissibility and motion transmissibility—can be defined. Due to a reciprocity (or dual 
or complementary) characteristic of linear systems, it can be shown that these two transfer 
functions are identical and, consequently, it is sufficient to analyze only one of them. First 
we will consider both types of transmissibility functions and show their equivalence.
6.6.1 Force Transmissibility
Consider a mechanical system supported on a rigid foundation through a suspension sys-
tem. If a forcing excitation is applied to the system (this can be a force generated within 
the machine during its operation), it is not directly transmitted to the foundation. The 
suspension system acts as an “isolation” device. The force transmissibility determines the 
fraction of the forcing excitation that is directly transmitted to the foundation through the 
suspension system, as a function of the excitation (force) frequency, and is defined as
	
T
F
F
Force transmissibility
= Suspension force
Applied force
f
s
	
(6.38)
Note: This function is defined in the frequency domain, and accordingly Fs and F should be 
interpreted as the Fourier spectra of the corresponding forces.
A schematic diagram of a force transmissibility mechanism is shown in Figure 6.8a. The 
reason for the suspension force fs not being equal to the applied force f is attributed to the 
inertia force path (broken line in Figure 6.8a) that is present in the mechanical system.
6.6.2 Motion Transmissibility
Consider a mechanical system supported through a suspension mechanism on a movable 
platform or structure, which may be subjected to deliberate or undesirable motions (e.g., 

320
Modeling of Dynamic Systems with Engineering Applications
elevator movement, seismic disturbances, road disturbances on a vehicle, machinery dis-
turbances). Motion transmissibility determines the fraction of the support motion that is 
transmitted to the system through its suspension, as a function of the excitation (platform 
velocity) frequency. It is defined as
	
T
V
V
Motion transmissibility
= System motion
Support motion
m
m
	
(6.39)
Note: The velocities Vm and V are expressed in the frequency domain, as Fourier spectra.
A schematic representation of the motion transmissibility mechanism is shown in Figure 
6.8b. The platform force, indicated by a broken-line arrow, represents the dependent force 
of the velocity source. Also, the broken line from the mechanical system to the foundation 
(ground) is the path of the inertia force. Typically, the representative motion of the system 
is the velocity of one of its critical masses. Different transmissibility functions are obtained 
when different mass points (or degrees of freedom) of the system are considered.
Next, two examples are given to show the reciprocity property, which makes the force 
transmissibility and the motion transmissibility functions equivalent.
Example 6.9: Single-Degree-of-Freedom System
Consider the single-degree-of-freedom systems shown in Figure 6.9. In these examples 
the system is represented by a lumped mass m, and the suspension system is modeled 
(a)
(b)
v(t)
Suspension
Mechanical 
vm
Platform
Inertia
force
path
Suspension
Mechanical 
system
f(t)
Foundation
Inertia
force
path
Forcing
excitation 
fs
system
FIGURE 6.8
(a) Force transmissibility mechanism and (b) motion transmissibility mechanism.

321
Frequency-Domain Models
as a spring of stiffness k and a viscous damper of damping constant b. The model shown 
in Figure 6.9a is used to study force transmissibility. Its (mechanical) impedance cir-
cuit is shown in Figure 6.10a. The model shown in Figure 6.9b is used in determining 
the motion transmissibility. Its mechanical impedance (or, mobility) circuit is shown in 
Figure 6.10b.
Note: Mechanical impedance representation is suitable for force transmissibility stud-
ies and mobility representation is suitable for motion transmissibility studies (even 
though either representation is acceptable in analysis).
By the definition of mechanical impedance (Force/Velocity), a force is divided among 
parallel branches in proportion to their impedances. Hence, in Figure 6.10a, we have
	
=
=
+
T
F
F
Z
Z
Z
f
s
s
m
s
	
(6.40)
By the definition of mobility (Velocity/Force), a velocity is divided among series ele-
ments in proportion to their mobilities. Hence, in Figure 6.10b, we have
	
=
=
+
T
V
V
M
M
M
m
m
m
m
s
	
(6.41)
vm
b
k
m
v(t)
(b)
b
k
m
f(t)
(a)
fs
FIGURE 6.9
Single-degree-of-freedom systems. (a) Fixed on ground and (b) with support (platform) motion.
Suspension 
(a)
Zs
Zm
f(t)
fs
Main
system 
0
v(t)
Ms
Mm
0
vm
+
(b)
Suspension 
Main
system 
−
FIGURE 6.10
Mechanical impedance circuit of: (a) System in Figure 6.9a and (b) system in Figure 6.9b.

322
Modeling of Dynamic Systems with Engineering Applications
	
+
=
+
=
+
M
M
M
Z
Z
Z
Z
Z
Z
But,
1
1
1/
m
m
s
m
m
s
s
m
s
Consequently, we have
	
=
T
T
f
m 	
(6.42)
In view of this result, a distinction between the two types of transmissibility is not 
necessary. Hence, let us denote them by a common transmissibility function T. It can 
be concluded as well that Figure 6.9a and b are complementary systems or duals, for 
transmissibility.
Since, 
=
=
+
Z
ms
Z
k
s
b
and
m
s
 it follows that
	
=
+
+
+




ω
=
T
bs
k
ms
bs
k
s
j
2
	
(6.43)
This result is the same as what we obtained in the previous section as Equations 6.33 
and 6.37.
Note: Upper case letters are used for the variables to denote their Fourier spectra.
It is customary to consider only the magnitude of the complex transmissibility func-
tion because the phase angle is not particularly useful in transmissibility studies, where 
what is key is the relative “strength” of the transmitted signal. This magnitude is termed 
transmissibility magnitude, or simply transmissibility and is given by
	
ω
ω
ω
=
+
+
−




T
b
k
b
k
m
(
)
2
2
2
2
2
2
2 2
12
	
(6.44)
Note: Uppercase letters are used for the variables to denote their Fourier spectra.
LEARNING OBJECTIVES
	
1.	 Determination of the force transmissibility of a system using the element TFs 
and the system structure (series or parallel connection)
	
2.	 Determination of the motion transmissibility of a system using the element TFs 
and the system structure (series or parallel connection)
	
3.	 Recognizing the equivalence of force transmissibility of a system and the 
motion transmissibility of the dual or the complementary or the reciprocal system

■
For a structurally-complex mechanical system, it is advantageous to consider the analo-
gous electrical-circuit procedures when analyzing the mechanical system (particularly 
in transmissibility analysis). This is true because generally we are very familiar with 
the analysis of electrical circuits but not mechanical circuits. Further complexity enters 
since mechanical impedance is not analogous to electrical impedance. It is the mechani-
cal mobility that is analogous to electrical impedance.
In analyzing a mechanical circuit, a convenient approach is to use the following anal-
ogies and then treat the mechanical circuit as an electrical circuit:
	
1.	 Force (or torque) → Current.
	
2.	 Velocity → Voltage.

323
Frequency-Domain Models
	
3.	 In series-connected mechanical (electrical) elements, velocities (voltages) 
add → mobilities (electrical impedances) add (
=
+
M
M
M
e
1
2); mechanical 
impedances (electrical admittances) have the inverse relation 
=
+




Z
Z Z
Z
Z
e
1
2
1
2
.
	
4.	 In parallel-connected mechanical (electrical) elements, forces (currents) add 
→ mechanical impedances (electrical admittances) add (
=
+
Z
Z
Z
e
1
2); mobili-
ties (electrical impedances) have the inverse relation 
=
+




M
M M
M
M
e
1
2
1
2
.
The next example illustrates this approach.
Example 6.10: Two-Degree-of-Freedom System
Consider the two-degree-of-freedom systems shown in Figure 6.11. The main system is 
represented by two masses linked through a spring and a damper. The model shown in 
Figure 6.11a is used to study force transmissibility. Its (mechanical) impedance circuit is 
shown in Figure 6.12a. This model may represent a machine tool (e.g., milling machine) 
with a fixed base. Here we are interested determining what fraction of the applied force 
f(t) (this may be the task force of the machine) is transmitted to the floor (i.e., the force 
transmissibility f
f
/
s
). The model shown in Figure 6.11b is used in determining the 
motion transmissibility. Its (mechanical) impedance (or, mobility) circuit is shown in 
Figure 6.12b. This model may represent a vehicle or an elevator with a mobile base. Here 
we are interested determining what fraction of the base/platform velocity v(t) (this may 
be the upward velocity of the tires due to road irregularities, or the moving velocity of 
the elevator) is transmitted to a critical mass, such as the vehicle seat or the occupant, of 
the system (i.e., the motion transmissibility v
v
/
m
).
k2
v(t)
b2
m2
m1
vm
k1
b1
(b)
v΄
k2
b2
m2
m1
f (t)
k1
b1
(a)
fs
f ΄
fs
v2
FIGURE 6.11
Systems with two degrees of freedom. (a) Fixed on ground and (b) with support motion.

324
Modeling of Dynamic Systems with Engineering Applications
To make the procedures clearer, let us analyze the two circuits in Figure 6.12 simul-
taneously. First note that the suspension (spring-damper) module in the two circuits is 
the same and is given by the TF:
	
=
+
=
+
=
Z
Z
Z
b
k
s
M
1
s
b
k
s
1
1
1
1
	
(6.45)
In the circuit of Figure 6.12a
	
1.	 Combine the bottom two parallel modules as 
=
+
Z
Z
Z
m
s
2
2
	
(i)
	
2.	 Combine it with its series module Zs1 as: 
=
+
=
+
Z
Z Z
Z
Z
M
M
1
s
s
s
1
2
1
2
2
1
	
(ii)
	
3.	 The force F’ that goes through this combined module Z is: 
=
+




F
Z
Z
Z
F
'
m1
	
4.	 The part of the force F’ that goes through the suspension Zs is:
	
= 



F
Z
Z
F'
s
s
2
 (see (i))
+
–
Mm1
Ms1
Mm2
Ms
0
vm
(b) 
v(t)
Zm1
Zs1
Zm2
Zs
f(t)
0
(a) 
f ΄
fs
v2
FIGURE 6.12
Mechanical impedance circuit of: (a) System in Figure 6.11a and (b) system in Figure 6.11b.

325
Frequency-Domain Models
	
5.	 Combine the results of Steps 3 and 4: 
= 



+




F
Z
Z
Z
Z
Z
F
s
s
m
2
1
	
6.	 Force Transmissibility: 
=
= 



+



= 



+



=
T
F
F
Z
Z
Z
Z
Z
Z
Z
Z
Z
1
1
/
f
s
s
m
s
m
2
1
2
1




+
+



=
+
+




Z
Z
Z
M
M
Z
Z
Z
Z Z
M
1
1
(
)
s
m
s
s
m
m
s
2
1
2
1
2
1
2
1
1
	
(from (ii))
=
+
+



=
+
+
+




Z
Z
Z
M
Z
Z
Z
Z
Z
M
Z
(1
)
(
)(1
)
s
m
s
m
s
m
s
m
s
m
2
1
1
1
2
1
1
1
	
(from (i))
In the circuit of Figure 6.12b:
	
1.	 Combine the left two series modules as 
=
+
M
M
M
m
s
1
1
1 
(iii)
	
2.	 Combine it with its parallel module Mm2 as: 
=
+
=
+
M
M
M
M
M
Z
Z
1
m
m
m
2
1
2
1
1
2

(iv)
	
3.	 The velocity V’ at this combined module M is: 
=
+




V
M
M
M
V
'
s
	
4.	 The part of the velocity V’ that is present at the critical mass Mm1 is:
	
= 



V
M
M
V'
m
m1
1
	
(see (iii))
	
5.	 Combine the results of Steps 3 and 4: 
= 



+




V
M
M
M
M
M
V
m
m
s
1
1
	
6.	 Motion Transmissibility: 
=
= 



+



= 



+



= 



+
+



=
+
+




T
V
V
M
M
M
M
M
M
M
M
M
M
M
M Z
Z
M
M
M
M M Z
1
1
/
1
1
(
)
m
m
m
s
m
s
m
s
m
m
s
s
m
1
1
1
1
1
1
1
2
1
1
1
2
	
(from (iv))
= 
+
+



=
+
+
+




M
M
M Z
M
M
M
M
M Z
M
(1
)
(
)(1
)
m
s
m
s
m
m
s
s
m
s
1
1
2
1
1
1
2
	
(from (iii))
Note: Uppercase letters are used for the variables to denote their Fourier spectra.
The two transmissibility results are
	
=
+
+
+




T
Z
Z
Z
Z
M
Z
(
)(1
)
f
s
m
s
m
s
m
2
1
1
1
	
(6.46)

326
Modeling of Dynamic Systems with Engineering Applications
	
=
+
+
+




T
M
M
M
M Z
M
(
)(1
)
m
m
m
s
s
m
s
1
1
1
2
	
(6.47)
Now, we show that these two results are identical. We do this by dividing throughout by 
the numerators of the two functions and then examining the resulting denominators:
	
=
+
+
+



=
+
+
+




T
Z
Z
Z
Z
M
Z
M Z
Z
M
M Z
(
)(1
)
1
(
1)(1
)
f
s
m
s
m
s
m
s
m
m
s
s
m
2
1
1
1
2
1
1
1
	
=
+
+
+



=
+
+
+




T
M
M
M
M Z
M
Z
M
M Z
Z
M
(
)(1
)
1
(1
)(1
)
m
m
m
s
s
m
s
m
s
s
m
m
s
1
1
1
2
1
1
2
1
Clearly, the two transmissibility functions are identical.
It can be concluded that Figure 6.11a and b are complementary systems for 
transmissibility.
The equivalence of Tf and Tm can be shown in a similar straightforward manner for 
higher degree-of-freedom systems as well.
LEARNING OBJECTIVES
	
1.	 Systematic determination of the force transmissibility of a complex system using 
the element TFs and the system structure (series or parallel connection)
	
2.	 Systematic determination of the motion transmissibility of a complex system 
using the element TFs and the system structure (series or parallel connection)
	
3.	 Showing the equivalence of force transmissibility of a complex system and the 
motion transmissibility of the dual or the complementary or the reciprocal system
	
4.	 Possible generalization of the result
■
6.6.3 Vibration Isolation
The concepts of mechanical impedance, mobility, and transmissibility can be extended to 
other physical domains and to mixed systems (e.g., electromechanical systems or mecha-
tronic systems) in a straightforward manner. The procedure follows from the familiar 
analogies of through-variables (force, current, fluid flow rate, and heat transfer rate) and 
across-variables (velocity, voltage, pressure, and temperature). Furthermore, the concepts 
of transmissibility are useful in many practical applications. In particular, transmissibility 
is applicable in shock and vibration isolation.
Proper operation of engineering systems such as delicate instruments, computer hard-
ware, machine tools, and vehicles can be hampered due to shock and vibration. The 
purpose of vibration isolation is to “isolate” such devices from vibration and shock distur-
bances that are coming from its environment (including the supporting structure or road). 
This is achieved by connecting a “vibration isolator” or “shock mount” or “engine mount” in 
between them. This application is discussed now.
Force Isolation and Motion Isolation
External disturbance can be force or motion, and depending on that, force isolation (related 
to force transmissibility) or motion isolation (related to motion transmissibility) would be 
applicable in the design of the isolator. As we showed in the previous section, the design is 
quite similar (complementary) for the two situations.

327
Frequency-Domain Models
In force isolation, vibration forces that would be ordinarily transmitted directly from a 
source to a supporting structure (isolated system) are filtered out by an isolator through 
its flexibility (spring) and dissipation (damping), and part of the force is routed through an 
inertial path. In motion isolation, vibration motions that are applied to a system (e.g., vehi-
cle) by a moving platform are absorbed by an isolator through its flexibility and dissipation 
so that the motion that is transmitted to the system of interest is weakened. The design 
problem in both cases is to select applicable parameters for the isolator so that the vibra-
tions entering the system of interest are below the specified values within a frequency 
band of interest (the operating frequency range). This design problem is essentially a situ-
ation of “mechanical impedance matching” because impedance parameters (mechanical) 
of the isolator are chosen depending on the impedance parameters of the isolator.
Consider again the force-transmissibility model shown in Figure 6.9a and the motion 
transmissibility model shown in Figure 6.9b. In these circuits, the mechanical imped-
ances of the basic elements are 
ω
ω
=
=
=
Z
mj
Z
b
Z
k
j
,
, and
m
b
k
, for mass (m), spring (k), and 
viscous damper (b), respectively. The suspension system (engine mount) is the parallel 
spring-damper element, with the mechanical impedance 
=
+
Z
Z
Z
s
b
k. We know that the 
expressions for the force transmissibility and the motion transmissibility are identical and 
given by Equation 6.43, and the transmissibility magnitude is given by Equations 6.44. 
Then, with 
ω
=
k
m
n
2  and 
ζω
=
b
m
2
n  (or, ω =
k
m
/
n
 = undamped natural frequency of the 
system; ζ =
b
km
2
 = damping ratio of the system) and dividing (Equation 6.44) throughout
by ωn
2 , we get,
	
ζ
ζ
=
+
−
+
T
r
r
r
1
4
(1
)
4
2
2
2 2
2
2 	
(6.48)
Here the non-dimensional excitation frequency is defined as 
ω
ω
=
r
/
n.
Note: The transmissibility function (Equation 6.43) has a phase angle as well as a mag-
nitude. In practical applications of vibration isolation, it is the level of attenuation of 
the vibration excitation that is of primary importance, rather than the phase difference 
between the vibration excitation and the response. Accordingly, the transmissibility mag-
nitude (Equation 6.48) is particularly useful.
To determine the peak point of T, differentiate the expression within the square-root 
sign in Equation 6.48 and equate to zero:
	
ζ
ζ
ζ
ζ
ζ
−
+
−
+
−
−
+
−
+
=
r
r
r
r
r
r
r
r
r
[(1
)
2
]8
[1
4
][2(1
)( 2 )
8
]
[(1
)
4
]
0
2 2
2
2
2
2
2
2
2
2 2
2
2 2
Hence, 
ζ
ζ
ζ
ζ
−
+
+
+
−
−
=
r
r
r
r
r
4 {[(1
)
2
]2
[1
4
][(1
)
2
]}
0
2 2
2
2
2
2
2
2
2
. 
This 
simplifies 
to 
ζ
+
−
=
r
r
r
(2
1)
0
2
4
2
. Its roots are r = 0 and 
ζ
ζ
= −±
+
r
1
1
8
4
2
2
2
.
The root r = 0 corresponds to the initial stationary point at zero frequency. It does not 
represent a peak. Taking only the positive root for r2 and then its positive square-root, the 
peak point of the transmissibility magnitude is given by

328
Modeling of Dynamic Systems with Engineering Applications
	
ζ
ζ
=
+
−
r
[ 1
8
1]
2
2
12
	
(6.49)
For small ζ, Taylor series expansion gives 
ζ
ζ
ζ
+
≈
+
×
=
+
1
8
1
1
2
8
1
4
2
2
2. With this approx-
imation, Equation 6.49 evaluates to 1. Hence, for small damping, the transmissibility mag-
nitude will have a peak at r = 1 and, from Equation 6.48, its value is
 
ζ
ζ
ζ
ζ
≈
+
≈
+
×
T
1
4
2
1
1
2
4
2
2
2
, or	
ζ
ζ
ζ
ζ
ζ
ζ
≈
+
≈
≈
+
≈
T
T
1
2
1
2
1
2
1
2
f
	
(6.50)
The five curves of T verses r for ζ = 0, 0.3, 0.7, 1.0, and 2.0 are shown in Figure 6.13a. These 
curves use the exact expression 6.48, and can be generated using the following MATLAB 
program:
clear;
zeta=[0.0 0.3 0.7 1.0 2.0];
for j=1:5
for i=1:1201
 r(i)=(i-1)/200;
 T(i,j)=sqrt((1+4*zeta(j)^2*r(i)^2)/((1-r(i)^2)^2+4*zeta(j)^2*r(i)^2));
end
plot(r,T(:,1),r,T(:,2),r,T(:,3),r,T(:,4),r,T(:,5));
From the transmissibility curves in Figure 6.13a we observe the following:
•	 There is always a non-zero frequency value at which the transmissibility magni-
tude will peak. This is the resonance.
•	 For small ζ the peak transmissibility magnitude occurs approximately at r = 1. As 
ζ increases, this peak point shifts to the left (i.e., a lower value for peak frequency).
•	 The peak magnitude decreases as ζ increases.
•	 All the transmissibility curves pass through the magnitude value 1.0 at the same 
frequency r = 2 .
•	 The isolation (i.e., T < 1) is given by r > 2. In this region, T increases with ζ.
•	 In the isolation region, the transmissibility magnitude decreases as r increases.
From the transmissibility curves we observe the following two particular situations:
For T < 1.05; 
>
r
2  for all ζ
For T < 0.5; r > [1.73, 1.964, 2.871, 3.77, 7.075] for ς = [0.0, 0.3, 0.7, 1.0, 2.0], respectively.
Next, suppose that the device in Figure 6.9a has a primary, undamped natural frequency 
of 6 Hz and a damping ratio of 0.2. Suppose, it is required that for proper operation, the 
system achieves a force transmissibility magnitude of less than 0.5 for operating frequency 
values greater than 12 Hz. We need 
ζ
ζ
+
−
+
<
r
r
r
1
4
(1
)
4
1
2
2
2
2 2
2
2
 → 
ζ
ζ
(
)
+
<
−
+
r
r
r
4
16
1
4
2
2
2 2
2
2 
→ 
ζ
−
−
−
>
r
r
r
2
12
3
0
4
2
2
2
. For ζ = 0.2 and 
=
=
r
12 6
2  this expression computes to 
(
)
−
×
−
×
×
−
=
>
2
2
2
12
0.2
2
3
3.08
4
2
2
2
.

329
Frequency-Domain Models
Hence, the requirement is met. In fact, for r = 2, the expression becomes
ζ
ζ
−
×
−
×
−
=
−
2
2
2
12
2
3
5
48
4
2
2
2
2. It follows that the requirement would be met for 
ζ
−
>
5
48
0
2
 → ζ <
=
5
48
0.32. If the requirement was not met (say, if ζ = 0.4), an option 
would be to reduce damping.
Normalized frequency r = ω/ωn 
(a) 
0
0.5
1
1.5
2
2.5
3
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
5
5.5
6
6.5
7
7.5
Transmissibility magnitude T 
ζ = 0.0
ζ = 0.3
ζ = 0.7
ζ = 1.0
ζ = 2.0
(b)
30
35
40
45
50
55
60
65
70
75
80
Percentage isolation
Frequency ratio r 
1.0
1.5
2.0
2.5
3.0
3.5
4.0
4.5
5.0
ζ = 0.50 
ζ = 0 
0.40 
0.30 
0.20 
0.10 
FIGURE 6.13
Transmissibility curves for a damped oscillator model and (b) curves of vibration isolation.

330
Modeling of Dynamic Systems with Engineering Applications
In design problems of vibration isolator, what is normally specified is the percentage isola-
tion, which is directly related to the transmissibility, as given by
	
=
−
×
I
T
[1
]
100% 	
(6.51)
For the result in Equation 6.48, this corresponds to
	
ζ
ζ
=
−
+
−
+








×
I
r
r
r
1
1
4
(
1)
4
100
2
2
2
2
2
2
	
(6.52)
The isolation curves given by Equation 6.52 are plotted in Figure 6.13b. These curves are 
useful in the design of vibration isolators.
Note: The model in Figure 6.9 is not limited to sinusoidal vibrations. Any general vibra-
tion excitation may be represented by a Fourier spectrum, which is a function of frequency 
ω. Then, the response vibration spectrum is obtained by multiplying the excitation spec-
trum by the transmissibility function T. The associated design problem is to select the 
isolator impedance parameters k and b to meet the specifications of isolation.
Example 6.11
A machine tool, sketched in Figure 6.14a, weighs 1000 kg and normally operates in 
the speed range of 300–1200 rpm. A set of spring mounts has to be placed beneath the 
base of the machine so as to achieve a vibration isolation level of at least 70 percent. 
A commercially available spring mount has the load-deflection characteristic shown 
in Figure  6.14b. It is recommended that an appropriate number of these mounts be 
used, along with an inertia block, if necessary. The damping constant of each mount 
is 1.56 × 103 N m−1 s. Design a vibration isolation system for the machine. Specifically, 
decide upon the number of spring mounts that are needed and the mass of the inertia 
block that should be added.
Solution
First we will assume zero damping (since, in practice, the level of damping in a system 
of this type is small), and design an isolator (spring mount and inertia block) for a level 
of isolation somewhat greater than the required 70 percent. Then we will check for 
the case of damped isolator to see whether the required 70 percent level of isolation is 
achieved.
For the undamped case, Equation 6.48 becomes
	
=
−
T
r
1
1
2
	
(6.53)
Note: We have used the case r > 1 since the isolation region corresponds to 
>
r
2 .
Assume the conservative value I = 80% ⇒ T = 0.2.
Using Equation 6.53, we have: 
ω
ω
ω
=
+
=
+
=
=
=
r
T
m
k
1
1
1
0.2
1
6.0
n
2
2
2
2
The lowest operating speed (frequency) is the most significant one (because it corre-
sponds to the lowest isolation, as clear from Figure 6.13a. Hence,
	
ω
π
π
=
×
=
300
60
2
10 rad/s

331
Frequency-Domain Models
From the load-deflection curve of a spring mount (Figure 6.14b),
	
=
×
=
×
−
−
−
Mount stiffness
3000
6
10
50
10 Nm
1
2
3
1
We will try 4 mounts. Then 
=
×
×
k
4
50
103 Nm−1
Hence
Several spring mounts
have to be placed here
An inertia block
 may be added here
(a)
2.0
4.0
6.0
8.0
10.0
750
1500
2250
3000
3750
Deflection (cm)
Load (N)
0
(b) 
FIGURE 6.14
(a) A machine tool and (b) load-deflection characteristic of a spring mount.

332
Modeling of Dynamic Systems with Engineering Applications
	
(
)
×
π
×
×
=
=
×
m
m
10
4
50
10
6.0 è
1.216
10 kg
2
3
3
Note that an inertia block of mass 216 kg has to be added.
Now we must check whether the required level of vibration isolation would be 
achieved in the damped case.
	
ζ =
=
×
×
×
×
×
×
=
b
km
Damping ratio
2
4
1.56
10
2 4
50
10
1.216
10
0.2
3
3
3
Substitute in the damped isolator Equation 6.48: 
ζ
ζ
(
)
=
+
−
+
T
r
r
r
1
4
1
4
2
2
2
2
2
2  with r2 = 6
We have 
(
)
=
+
×
×
−
+
×
×
=
T
1
4
0.2
6
(6
1)
4
0.2
6
0.27
2
2
2
This corresponds to an isolation level of 73%, which is better than the required 70 
percent.
LEARNING OBJECTIVES
	
1.	 Application of the concepts of transmissibility in the design of vibration isola-
tors or engine mounts
	
2.	 Meanings of transmissibility and isolation
	
3.	 The use of the transmissibility curves
	
4.	 Practical selection and design of vibration isolators or engine mounts
■
6.6.4 Maxwell’s Reciprocity Property
For our purposes, Maxwell’s property of reciprocity may be stated as follows: In a mechan-
ical dynamic system suppose that, when a force f is applied along the coordinate (degree of 
freedom) i, the resulting velocity along the coordinate (degree of freedom) j is v. Then, if f 
is applied along the coordinate j, the resulting velocity along the coordinate i will also be v.
This property is valid for linear, constant-parameter systems in general. Also, for static 
systems, we can replace “velocity” in the above statement by “displacement.” This prop-
erty can be quite useful in practice, for example, in dynamic testing of complex mechanical 
systems, to determine a behavior that is difficult to measure. Then, by applying the force 
at that location and measuring response at the counterpart location, we can obtain the 
required information.
The system in Example 6.10 may be used to illustrate Maxell’s property of reciprocity. 
This is done in the next example.
Example 6.12: Maxwell’s Reciprocity Property
Consider the two-dof system shown in Figure 6.11a. Its mechanical impedance circuit 
is given in Figure 6.12a. Here the force f(t) is applied on mass m1. Let the resulting 
velocity of mass m2 be v2. Now reverse this arrangement, and apply the force f(t) on 
mass m2. Let the resulting velocity of mass m1 be v1, as shown in Figure 6.15a. We need 
to show that 
=
v
v
1
2 .

333
Frequency-Domain Models
First observe the TFs M1 and Z2 of the combined elements, as defined in Example 6.10. 
These are indicated as well in Figure 6.15b.
From the circuit in Figure 6.12a we can write:
	
[
]
= 


′ = 



+




=
+
+
=
+
+
=
+
+
V
Z
F
Z
Z
Z
Z
F
Z
M
M
Z
F
Z
Z
Z M Z
F
Z
M Z
Z
F
1
1
1
1
(
)
1
1
(1
)
m
s
m
m
s
m
s
m
m
2
2
2
1
2
2
1
1
2
1
2
1
1
2
1
1
1
Or
	
=
+
+
+
V
Z
Z
M Z
Z
F
1
(
)(1
)
m
s
s
m
m
2
2
1
1
1
	
(i)
From the circuit in Figure 6.15b we can write:
	
=
+




F
Z
Z
Z
F
1
1
1
2
Then
	
=
=
+




=
+




=
+
+
+




V
F
Z
Z
Z
Z Z
F
M Z Z
F
Z
M
M
Z
Z Z
F
(
)
1
(1
)
1
(
)(
)
m
m
m
m
m
s
m
s
m
1
1
1
1
1
2
1
1
2
1
1
1
1
2
1
Or
	
=
+
+
+




V
Z
M Z
Z
Z
F
1
(1
)(
)
m
s
m
m
s
1
1
1
1
2
	
(ii)
k2
b2
m2
m1
f
k1
b1
(a)
Zs1
Zs
v1
Zs1
Zm2
Zs
f(t)
0
(b)
M1
Zm1
Z2
f1
v1
FIGURE 6.15
Maxwells’ reciprocity property. (a) Reversed system and (b) mechanical impedance circuit.

334
Modeling of Dynamic Systems with Engineering Applications
Clearly, the results (i) and (ii) are identical, thereby demonstrating Maxwell’s property 
of reciprocity.
Note: Uppercase letters are used for the variables to denote their Fourier spectra.
LEARNING OBJECTIVES
	
1.	 Systematic determination of TFs of systems using the element TFs and the sys-
tem structure (series or parallel connection)
	
2.	 Verification of Maxwell’s property of reciprocity for a linear mechanical 
dynamic system.
■
Maxwell’s Reciprocity Property in Other Domains
It should be clear that Maxwell’s reciprocity property is not limited to the mechanical 
domain. In view of the fact that force is a through-variable and velocity is an across-
variable, the reciprocity property may be extended to any linear dynamic system in 
terms of a corresponding through-variable and a corresponding across-variable. Then 
for any physical domain (electrical, fluid, thermal), the reciprocity may be applied using 
the proper variables and transfer functions for that domain.
Note: Mechanical impedance is a T-type transfer function and mobility is an A-type 
transfer function.
Summary Sheet
Transfer Function (TF): 
=
G s
Y s
U s
( )
Laplace-transformed output
( )
Laplace-transformed input
( )
Laplace Transform (LT): 
∫
=
−
∞
Y s
y t
st dt
( )
( )exp(
)
0
 or 
ΛΛ
=
Y s
y t
( )
( )
Inverse LT: 
∫
π
=
σ
σ
−∞
+ ∞
y t
j
Y s
st ds
( )
1
2
( )exp( )
j
j
 or 
ΛΛ
=
−
y t
Y s
( )
( )
1
Time domain ↔ Laplace (Complex Frequency) Domain
LT of Derivative (General): 
=
−
−
−
−
−
−
−
−
d y t
dt
s Y s
s
y
s
y
d
y
dt
( )
( )
(0)
(0)
(0)
n
n
n
n
n
n
n
1
2
1
1


L
LT of Integral: ∫
τ
τ =
y
d
s Y s
( )
1
( )
t
0
L
Time derivative ↔ Multiplication by Laplace variable s
Differential Equations ↔ Algebraic Equations (with polynomials in s)
Time integration ↔ Multiplication by 1/s; e.g.,
	
+
+
+
=
+
+
+
↔
=
+
+
+
+
+
+
−
−
−
a d y
dt
a
d
y
dt
a y
b u
b du
dt
b d u
dt
Y s
U s
b
b s
b s
a
a s
a s
( )
( )
n
n
n
n
n
n
m
m
m
m
m
n
n
1
1
1
0
0
1
0
1
0
1





335
Frequency-Domain Models
Fourier Transform: 
∫
ω
ω
(
)
=
−
=
−∞
∞
Y j
y t
j t dt
y t
(
)
( )exp
( );
F
Note: ω
π
=
× f
(rad/s)
2
(cycles/s or Hz)
Inverse Fourier Transform: 
∫
π
ω
ω
ω
(
)
=
−∞
∞
y t
Y j
j t d
( )
1
2
(
)exp
 or 
ω
=
−
y t
Y j
( )
(
)
1
F
Laplace result 
ω
ω
←
=
→=
j
s
s
j
 Fourier result (One-sided); (e.g., 
ω
ω
ω
←
=
→=
G s
G j
( )
(
)
j
s
s
j
 )
Magnitude of 
ω
(
)
G j
: 
ω
(
) =
G j
M
Phase Angle of 
ω
(
)
G j
: 
ω
φ
(
)
∠
=
G j
	
ω
φ
φ
(
) =
+
=
=
φ
ω
φ
(
)
+
G j
M
jM
Me
y
u Me
cos
sin
;
j
o
j
t
Note: Output is magnified by 
ω
(
)
=
M
G j
; has a phase lead w.r.t. input of φ
ω
(
)
= ∠G j
(Typically a phase lag or a negative phase lead is present)
Bode Plot: (1) 
ω
G j(
)  versus ω; (2) ∠G(f) versus ω
Log scales are used for both axes: Magnitude axis (e.g., in decibels or 20log ()
10
), fre-
quency axis (e.g., in decades, which are multiples of 10)
Nyquist Diagram (Argand Plot or Polar Plot): Real part of G(jω) on horizontal axis, and 
imaginary part of G(jω) on vertical axis
In Frequency Domain: Acceleration = (jω) × (Velocity);
Displacement = Velocity/(jω) →
	
ω
ω
ω
ω
=
=
×
=
=
=
=
=
=
×
j
j
j
j
Dynamic Stiffness
Force/Displacement
Mechanical Impedance
Receptance
Displacement/Force
Mobility/(
)
Dynamic Inertia
Force/Acceleration
Impedance/(
)
Accelerance
Acceleration/Force
Mobility
Series Connection: Through-variable is common, across-variables add →
Transfer Function
Definition
(in Laplace or Frequency Domain)
Dynamic stiffness
Force/displacement
Receptance (dynamic flexibility or compliance)
Displacement/force
Mechanical impedance (Z)
Force/velocity
Mobility (M)
Velocity/force
Dynamic inertia
Force/acceleration
Accelerance
Acceleration/force
Force transmissibility (Tf)
Transmitted force/applied force
Motion transmissibility (Tm) 
Transmitted velocity/applied velocity

336
Modeling of Dynamic Systems with Engineering Applications
	
=
=
+
=
+
=
+
M
M
M
Z
Z
Z
Z
Z Z
Z
Z
Mobility
Velocity
Force
:
; Mech Impedance : 1
1
1 or
1
2
1
2
1
2
1
2
 
Parallel Connection: Across-variable is common, through-variables add →
	
=
+
=
+
=
+
Z
Z
Z
M
M
M
M
M M
M
M
Mech Impedance =
Force
Velocity :
;Mobility: 1
1
1 or
1
2
1
2
1
2
1
2
	
A
Generalized Impedance =
Across-variable
Through-variable : An
-type Transfer Function
	
T
Generalized Admittance = Through-variable
Across-variable
: A
-type Transfer Function
 	
T
F
F
Force Transmissibility
= Suspension Force
Applied Force
f
s
	
T
V
V
Motion Transmissibility
= System Motion
Support Motion
m
m
Tf = Tm for complementary (dual, reciprocal) systems
E.g., ground-based damped oscillator and oscillator with moving base:
	
=
=
+
+
+




ω
=
T
T
bs
k
ms
bs
k
f
m
s
j
2
Magnitude 
ω
ω
ω
ζ
ζ
=
+
+
−




=
+
−
+
T
b
k
b
k
m
r
r
r
(
)
1
4
(1
)
4
2
2
2
2
2
2
2 2
12
2
2
2 2
2
2 
Element
Time-Domain Model
Mechanical Impedance
Mobility
(Generalized Impedance)
Mass
m
=
m dv
dt
f
=
Z
ms
m
=
M
ms
1
m
Spring
k
=
df
dt
kv
=
Z
k
s
k
=
M
s
k
k
Damper
B
=
f
bv
=
Z
b
b
=
M
b
1
b
Element
Time-Domain Model
Impedance
(Z)
Admittance
(W)
Capacitor
C
=
C dv
dt
i
=
Z
Cs
1
C
=
W
Cs
C
Inductor
L
=
L di
dt
v
=
Z
Ls
L
=
W
Ls
1
L
Resistor
R
=
Ri
v
=
Z
R
R
=
W
R
1
R

337
Frequency-Domain Models
Percentage Isolation: 
ζ
ζ
=
−
×
=
−
+
−
+








×
I
T
r
r
r
[1
]
100%
1
1
4
(
1)
4
100
2
2
2
2
2
2
Maxwell’s Reciprocity Property: Force f is applied along coordinate (dof) i
→ velocity along j is v → if f is applied along j → velocity along i is also v
Note: Applicable to other physical domains as well
Problems
6.1	
State whether true (T) or false (F):
	
(a)	 The output of a system will depend on the input.
	
(b)	 The output of a system will depend on the system transfer function.
	
(c)	 The transfer function of a system will depend on the input signal.
	
(d)	 If the Laplace transform of the input signal does not exist (say, infinite), then 
the transfer function itself does not exist.
	
(e)	 If the Laplace transform of the output signal does not exist, then the transfer 
function itself does not exist.
6.2	
State whether true (T) or false (F):
	
(a)	 A transfer function provides an algebraic expression for a system.
	
(b)	 The Laplace variable s can be interpreted as the time derivative operator d/dt, 
assuming zero initial conditions.
	
(c)	 The variable 1/s may be interpreted as the integration of a signal starting
	
	  at t = 0.
	
(d)	 The numerator of a transfer function is the characteristic polynomial.
	
(e)	 A single-input single-output (SISO), linear, time-invariant (constant-parameter) 
system has a unique (one and only one) transfer function.
6.3 Consider a mass-spring-damper system with a displacement input u(t) applied to 
the free end (moving platform) of the spring, as shown in Figure P6.3. The result-
ing displacement y(t) of the mass is the output. Also,
	
	 m = point mass
	
	 b = viscous damping constant
	
	 k = stiffness of the spring.
	
(a)	 Formulate its I–O differential equation.
	
(b)	 What is the transfer function of the system?
	
(c)	 Show that this system is equivalent to a damped oscillator with an input 
force at the mass (the other ends of the spring and the damper are fixed to the 
ground)

338
Modeling of Dynamic Systems with Engineering Applications
	
(d)	
How will the system transfer function change if the damper is also attached to 
the moving platform in Figure P6.3 (with a displacement input u(t) applied to 
the platform) while the output is still the displacement y(t) of the mass?
6.4	
The Fourier transform of a measured position y(t) of an object is Y(jω). Select the 
correct one among the following statements:
	
(i)	 The Fourier transform of the corresponding velocity signal is
	
(a)	 Y(jω)
	
(b)	 jω Y (jω)
	
(c)	 Y(jω)/(jω)
	
(d)	 ω Y(jω)
	
(ii) 	The Fourier transform of the acceleration signal is
	
(a)	 Y(jω)
	
(b)	 ω2 Y(jω)
	
(c)	 −ω2 Y(jω)
	
(d)	 Y(jω)/(jω)
6.5	
The movable arm with read/write head of a disk-drive unit is modeled as a rota-
tory damped oscillator (a lumped-parameter model), as shown in Figure P6.5. The 
unit has an equivalent moment of inertia J = 1 × 10−3 gm·cm2 about it centroids, and 
rotates at an equivalent angle θ radians about the centroid. An equivalent rotation 
u(t) radians is imparted at the read/write (R/W) head. The bending stiffness at 
the R/W head with respect to the centroid of the arm is k = 10 dyne.cm/rad and 
damping constant b. Similarly, the bending damping constant at the R/W head 
with respect to the centroid of the arm is b.
	
(a)	 Write the I–O differential equation of motion for the read/write arm unit. 
What are the consistent units for b?
	
(b)	 What is the undamped natural frequency ωn of the unit in rad/s?
	
(c)	 Determine the value of b for 5% critical damping.
y
b
k
m
u(t)
FIGURE P6.3 
A mas-spring-damper system with a displacement input.

339
Frequency-Domain Models
	
(d)	
Write the frequency transfer function of the model.
6.6
A system has the transfer function 
=
+
+ +
G s
s
s
s
( )
1
4
2
. If a sinusoidal input given by 
=
u
t
3cos2  is applied to this system, 
determine the output (response) y under steady conditions.
6.7	
A system is shown in Figure P6.7. It was found to have the following properties:
	
1.	 The system transfer function G s( ) has two zeros and three poles.
	
2.	 The product of the three poles is −4.
	
3.	 When the system was excited with a sinusoidal input u (as shown in Figure P6.7) 
at frequency ω = 4 , the output y at steady state was found to be zero (i.e., no 
response).
	
4.	 When the system was excited with a sinusoidal input u (as shown in Figure P6.7) 
at frequency ω = 2, the output y at steady state was found to have a phase lag of 
180° with respect to the input (i.e., the response was in the opposite direction to 
the input).
	
5.	 When the system was excited with a sinusoidal input u (as shown in Figure P6.7) 
at frequency ω =
2, the output y at steady state was found to have a phase lag 
of 90° with respect to the input.
	
6.	 The dc gain of the system (i.e., the magnitude of the frequency transfer func-
tion at zero frequency) is 8.
Determine the complete transfer function G s( ) of the system (i.e., the numerical values 
of the five parameters in G s( )).
6.8	
A system was found to have the following properties:
	
1.	 It is a second-order system
	
2.	 It has a zero at s = −z where z > 0.
J
b
k
u(t)
θ
FIGURE P6.5
A rotatory damped oscillator model of a disk-drive arm.
G(s)
Input 
u = u0 cosωt
y = y0 cos(ωt + φ)
Output 
System 
FIGURE P6.7
The system with a harmonic input.

340
Modeling of Dynamic Systems with Engineering Applications
	
3.	 Its dc gain (i.e., the magnitude of the frequency transfer function at zero fre-
quency) is K
	
4.	 When the system is excited at its undamped natural frequency, the magnitude 
of the frequency transfer function is given by rK, where r > 0, and the phase 
angle is −90°
	
	 In terms of the given parameters z, K, and r, determine the following:
	
(a)	
Undamped natural frequency of the system
	
(b)	
Damping ratio of the system
	
(c)	
Complete transfer function of the system.
6.9	
The frequency transfer function for a damped oscillator is given by
	
ω
ω
ω
ω
ζω ω
=
−
+
G
j
( )
[
2
]
n
n
n
2
2
2
	
(a)	
If a harmonic excitation u(t) = 
ω
a
t
cos
n  is applied to this system what is the 
steady-state response?
	
(b)	
What is the magnitude of the resonant peak?
	
(c)	
Using your answers to parts (a) and (b) suggest a method to measure damping 
in a mechanical system.
	
(d)	
At what excitation frequency is the response amplitude maximum under 
steady-state conditions?
	
(e)	
Determine an approximate expression for the half-power (3 dB) bandwidth 
(i.e., the frequency band where the power level is half the peak power, or the 
transfer-function magnitude drops by 
2  or 3 dB from the peak value) at 
low damping. Using this result, suggest an alternative method for damping 
measurement.
6.10	 Sketch the Bode magnitude plots (asymptotes only are sufficient when the exact 
curve need numerical computation) of the following common system elements:
	
(a)	
Derivative Controller: τs
	
(b)	
Integral Controller: τs
1
	
(c)	
First-Order Simple Lag Network: 
τ +
s
1
1
	
(d)	
Proportional plus Derivative Controller: τ +
s
1.
	
	 Also, sketch the polar plots (Nyquist plots) for these elements.
6.11	 The transfer function of a dynamic system is given by
	
(
)
(
)
=
+
+
+
G s
s
s
s
( )
3
4
16
2

341
Frequency-Domain Models
	
	 Plot the Bode diagram for G and indicate the asymptotes. Comment on the result.
6.12	 A rotating machine of mass M is placed on a rigid concrete floor. There is an isola-
tion pad made of elastomeric material between the machine and the floor, and is 
modeled as a viscous damper of damping constant b. In steady operation there is 
a predominant harmonic force component f(t), which is acting on the machine in 
the vertical direction at a frequency equal to the speed of rotation (n rev/s) of the 
machine. To control the vibrations produced by this force, a dynamic absorber 
of mass m and stiffness k is mounted on the machine. A model of the system is 
shown in Figure P6.12.
	
(a)	 Determine the frequency transfer function of the system, with force f(t) as the 
input and the vertical velocity v of mass M as the output.
	
(b)	 What is the mass of the dynamic absorber that should be used in order to vir-
tually eliminate the machine vibration (a tuned absorber)?
6.13
	
(a)	 An approximate frequency transfer function of a system was determined by 
Fourier analysis of the measured excitation-response data and fitting into an 
appropriate analytical expression (by curve fitting using the least squares 
method). This was found to be 
π
=
+
G f
j
f
( )
5
10
2
	
	
What is its magnitude, phase angle, real part, and imaginary part at f = 2 Hz? 
If the reference frequency is taken as 1 Hz, what is the transfer-function mag-
nitude at 2 Hz expressed in dB?
	
(b)	 A dynamic test on a structure using a portable shaker revealed the following: 
The accelerance between two locations (shaker location and accelerometer loca-
tion) measured at a frequency ratio of 10 was 35 dB. Determine the correspond-
ing mobility and mechanical impedance at this frequency ratio.
b
M
m
f (t)
k
v
FIGURE P6.12
A mounted machine with a dynamic absorber.

342
Modeling of Dynamic Systems with Engineering Applications
6.14	 Answer as true (T) or false (F):
	
	
(i) Mechanical impedances are additive for two elements connected in parallel.
	
	
(ii) Mobilities are additive for two elements connected in series.
6.15	 Answer as true (T) or false (F):
	
(a)	 Electrical impedances are additive for two elements connected in parallel.
	
(b)	 Impedance, both mechanical and electrical, is given by the ratio of Effort/
Flow, in the frequency domain.
	
(c)	 Impedance, both mechanical and electrical, is given by the ratio of Across-
variable/Through-variable, in the frequency domain.
	
(d)	 Mechanical impedance is analogous to electrical impedance when determin-
ing the equivalent impedance of several interconnected impedances.
	
(e)	 Mobility is analogous to electrical admittance (Current/Voltage in the fre-
quency domain) when determining the equivalent value of several intercon-
nected elements.
6.16 A machine of mass m has a rotating device, which generates a harmonic forcing 
excitation f(t) in the vertical direction. The machine is mounted on the factory floor 
using a vibration isolator of stiffness k and damping constant b. The harmonic com-
ponent of the force that is transmitted to the floor, due to the forcing excitation, is 
f t( )
s
. A simplified model of the system is shown in Figure P6.16. The corresponding 
force transmissibility magnitude T from f to fs is given by 
ζ
ζ
(
)
=
+
−
+
T
r
r
r
1
4
1
4
2
2
2 2
2
2  where,
ω
ω
=
r
/
n, ς = damping ratio, ωn = undamped natural frequency of the system, 
and ω = excitation frequency (of f(t)).
Suppose that 
	
=
=
×
m
k
100kg and
1.0
10 N/m
6
. Also, the frequency of the excitation force f(t) in 
the operating range of the machine is known to be 200 rad/s or higher. Determine the 
damping constant b of the vibration isolator so that the force transmissibility magnitude is 
not more than 0.5.
k
m
b
 fs
 f(t)
Vibration
isolator
Machine
Floor
FIGURE P6.16
Model of a machine mounted on a vibration isolator.

343
Frequency-Domain Models
	
	 Using MATLAB, plot the resulting transmissibility function and verify that the 
design requirements are met.
	
	 Note: 2.0 = 6 dB; 
2 = 3 dB; 
= −
1/
2
3 dB; 0.5 = −6 dB.
6.17	 Figure P6.17 shows two electrical circuit. The current source i(t) is in different loca-
tions in the two circuits. Furthermore, in circuit (a) the output is the voltage v2 of 
the capacitor C2 while in circuit (b) the output is the voltage v1 of the capacitor C1. 
Show that the voltages v1 and v2 in the two circuits are the same.
	
	 Hint: You may apply Maxwell’s reciprocity property.
(a)   
Current
Source 
i(t)
R
L
C2
Voltage
output
v2
v2
C1
(b)   
Current
source
i(t)
R
L
C1
Voltage
output
v1
v1
C2
FIGURE P6.17
(a) An electrical circuit and (b) the reciprocal circuit.


345
7
Transfer-Function Linear Graphs
Chapter Highlights
•	 Types of Model Equivalence
•	 Thevenin and Norton Equivalent Circuits
•	 Extension to Multiple Physical Domains
•	 Transfer-Function Linear Graphs (TF LGs)
•	 Linear Graph Reduction (Condensation, Simplification)
•	 Thevenin and Norton Equivalent Linear Graphs
•	 Domain Conversion in Multidomain Linear Graphs
7.1  Introduction
In Chapters 2 and 3, we studied the development of time-domain analytical models of 
engineering dynamic system. In Chapter 5, we discussed how linear graphs (LGs) can 
facilitate the model formulation in the time domain. The main focus in those chapters has 
been time-domain input-output models and state-space models. In Chapter 6, we studied 
the transfer-function (TF) methods, particular the frequency-domain TFs in the model 
formulation and analysis. We also saw how the TF methods can simplify the analysis and 
implementation. With this backdrop, in this chapter we integrate the TF approach with the 
LG approach. Many advantages can be derived through this integration; for example, since 
the component TFs can be combined using the well-established combination rules, unlike 
in the time-domain situation, there are two main advantages:
	
1.	Not all the variables in a conventional LG need to be indicated in a TF (or 
­frequency-domain) LG.
	
2.	A TF can be reduced (simplified) by combining the branches according to the rules 
of TF combination, in a simple and straightforward manner.
Going further, using the TF representation of LGs, other advantages of LGs can be exploited 
in the model analysis:

346
Modeling of Dynamic Systems with Engineering Applications
•	 Well-established methods of circuit reduction and equivalent circuits in the field 
of electrical engineering (particularly Thevenin equivalent circuit and Norton 
equivalent circuit) can be applied to an LG in any physical domain (mechanical, 
electrical, fluid, thermal).
•	 Engineering dynamic systems in multiple physical domains (mixed systems) can 
be analyzed.
•	 A multidomain model can be reduced to an equivalent model in a single physical 
domain in a straightforward manner, thereby simplifying the subsequent analysis 
and result interpretation.
We will study all these issues in this chapter through the use of TF LGs.
Recall that this book pays particular attention to equivalent models. Notably, approximate 
models concern approximate equivalence of models. A model itself is “approximately equiva-
lent” to the actual system. Indeed, various types of models (physical, analytical, computer, 
experimental, etc.) are approximately equivalent to the actual system. In the process of 
modeling, first, an equivalence is established based on such considerations as
	
1.	Needs of the specific application (purpose of the model: design, analysis, control, 
etc., and of what aspects?)
	
2.	Available resources for modeling: physical information, analytical methodolo-
gies, physical system, computer resources, system accessibility and ability to 
acquire experimental data, ability to develop a physical prototype, past informa-
tion, etc.
	
3.	The required accuracy and possible model complexity
The decision to develop an analytical model can be made based on these considerations.
In the development of an analytical model for a system, we have to first establish some 
criteria of equivalence or “approximate equivalence” of models. For example, we have con-
sidered the conversion of the following:
•	 A distributed-parameter system (model) into a lumped-parameter model
•	 A nonlinear system (model) into a linear model
•	 A time-domain system (model) into a TF model
•	 A detailed, component-based TF model into a reduced/simplified TF model
In each case, we (explicitly or implicitly) used some criteria of equivalence, for example, 
energy equivalence, modal (or, natural-frequency) equivalence, analytical equivalence, 
computer-simulation (discrete-time or digital) equivalence, and physical equivalence.
In this chapter, we consider another type of equivalence. Specifically, we consider the 
dynamic equivalence of a complex and extensive subsystem of a system and a simple 
model of the subsystem, when viewed from the remaining “simple segment of interest” of 
the system. In other words, we do the following:
	
1.	Identify the simple segment of interest (call it subsystem A) of the system. For 
example, system output may be within subsystem A.
	
2.	Represent the remaining subsystem (call it subsystem B) of the system by an 
equivalent, yet simple model (call it M).

347
Transfer-Function Linear Graphs
The criterion of equivalence in this case is such that the dynamic response of A within the 
actual system (i.e., when A and B are together) is the same as the response of A when it 
is connected to M. In developing the equivalent model M, we will consider two types of 
equivalence, which are commonly used in the analysis of electrical circuits:
•	 Thevenin equivalence
•	 Norton equivalence
By this approach, different types of linear time-domain models (e.g., complex, 
­single-domain, multidomain) can be represented by equivalent, simpler (and possibly 
­single-domain) models. We will integrate the approaches of TFs and LGs for this purpose. 
Specifically, we will use TF LGs.
7.2  Circuit Reduction and Equivalent Circuits
We have observed that TF approaches are more convenient than differential-equation 
approaches, in dealing with modeling issues of linear systems. This stems primarily from 
the fact that TF approaches use algebra rather than calculus. Also we have noted that when 
dealing with circuits (particularly, mechanical impedance and mobility circuits, which are 
in the mechanical domain), TF approaches are quite natural. Since the circuit approaches are 
extensively used in electrical systems, and as a result, quite mature procedures are available 
in that context, it is useful to consider extending such approaches to mechanical systems, 
and hence to other domains such as fluid, thermal, and mixed domains (e.g., electrome-
chanical, fluid-mechanical). Circuit reduction is convenient using Thevenin’s equivalence 
and Norton’s equivalence for electrical circuits. LGs, as studied in Chapter 5, can be simpli-
fied as well by using TF (frequency-domain) approaches and circuit reduction. Hence, the 
integration of these approaches can lead to substantial benefits in model analysis.
In this section, we will address the representation of a complex electrical circuit as a 
simple equivalent circuit (Thevenin form or Norton form). We will justify their equiva-
lence. Then we will indicate the generalization of this approach for use in other physical 
domains.
7.2.1  Thevenin’s Theorem for Electrical Circuits
Thevenin’s theorem provides a powerful approach to reduce a complex circuit segment 
into a simpler equivalent representation. Two types of equivalent circuits are generated by 
this theorem:
•	 Thevenin equivalent circuit (consists of an equivalent voltage source and an 
equivalent electrical impedance Ze in series)
•	 Norton equivalent circuit (consists of an equivalent current source and an equiva-
lent electrical impedance Ze in parallel)
The theorem provides means to determine the equivalent source and the equivalent 
impedance for either of these two equivalent circuits.

348
Modeling of Dynamic Systems with Engineering Applications
Circuit Partitioning
Consider a rather complex circuit C. Suppose that for practical purposes, we need to deter-
mine the voltage and current in a very small and simple sub-circuit C1. The remaining 
(complex) circuit segment is denoted as C2. This separation of the overall circuit into a 
simple sub-circuit of interest and the remaining complex sub-circuit is schematically indi-
cated in Figure 7.1.
With Thevenin and Norton equivalent circuits, the complex sub-circuit C2 can be repre-
sented by a simple equivalent circuit with just one source and one impedance. Then, by 
connecting back the simple sub-circuit of interest C1 to the “simple” equivalent sub-circuit, 
the analysis of the overall circuit (system) will be considerably simplified. In fact, much 
of the analysis goes in determining the equivalent impedance and the equivalent source 
for the original, complex sub-circuit.
Thevenin and Norton Equivalent Circuits
Consider a (rather complex) segment (C2) of a circuit, consisting of impedances and 
source elements, as represented in Figure 7.2a. According to Thevenin’s theorem, this 
sub-circuit can be represented by the Thevenin equivalent circuit, as shown in Figure 
7.2b or the Norton equivalent circuit, as shown in Figure 7.2c. For either of the two equiv-
alent circuits, its equivalence to the original complex sub-circuit (C2) is such that for any 
circuit segment connected at the output port (or for the special open-circuit case where 
no external circuit is connected), the voltage v and the current i at the output port of the 
original complex sub-circuit (C2) and those at the output port of the equivalent circuit 
are identical.
Note: In the circuits, the variables (voltage and current) are indicated by uppercase 
letters as they denote Laplace-domain variables (or Fourier spectra in the frequency 
domain).
As noted previously, the complex circuit segment (Figure 7.2a) is isolated by “virtually” 
cutting (separating) the original, complex circuit into the complex sub-circuit segment (C2) 
and a quite simple (and fully known) segment (C1), which is connected to the complex 
sub-circuit. The “virtual” cut is made at the “port” that links the two sub-circuits. The two 
terminal ends formed by the virtual cut is the “virtual” output port of the complex sub-
circuit segment (C2). Normally, this port is not in open-circuit condition because the cut 
is “virtual,” and the simpler and known sub-circuit segment (C1) is connected to it under 
normal conditions (and a current flows through the port).
Note: The equivalent source and the equivalent impedance of a “physical” circuit may be 
determined experimentally, if the analytical details of the circuit are not known.
I(s)
Complex
sub-circuit
C2
V(s)
Connecting port
Simple
sub-circuit
of interest
C1
+
–
FIGURE 7.1
Isolating a simple sub-circuit of interest from a complex circuit.

349
Transfer-Function Linear Graphs
We define the following variables and parameters:
V(s) = voltage across the output port when the entire circuit is complete
I(s) = current through the output port when the entire circuit is complete
Voc(s) = open-circuit voltage at the output port (i.e., with the terminals open)
Isc(s) = short-circuit current at the output port (i.e., when the terminals are shorted)
Ze = equivalent impedance of the circuit segment with its sources killed
(i.e., voltage sources shorted and current sources opened)
= Thevenin impedance
Note 1: Variables are expressed in the Laplace domain using the Laplace variable s.
Note 2: For a circuit segment with multiple sources, use superposition (because the sys-
tem is linear), by considering one source at a time.
Example 7.1: Illustrative Example for Thevenin’s Theorem
We use an electrical circuit in this illustrative example. Also, electrical impedances are 
expressed in the Laplace domain.
+
–
Ze
V(s)
I(s)
Isc(s)
(c)
Output port
Ze
V(s)
I(s)
Removed
known simple
sub-circuit
Voc(s)
+
(b)
+
–
Output port
Ze
V(s)
I(s)
Removed
known simple
sub-circuit
–
–
+
(a)
Output port
V(s)
I(s)
Removed
known simple
sub-circuit
Complex sub-
circuit with
impedances and
sources
FIGURE 7.2
(a) Complex circuit segment with impedances and sources; (b) Thevenin equivalent circuit; and (c) Norton 
equivalent circuit.

350
Modeling of Dynamic Systems with Engineering Applications
Note: The corresponding frequency transfer functions are obtained by setting s = jω 
(see Chapter 6).
Consider the circuit shown in Figure 7.3a. We “virtually” cut it as indicated by the 
dotted line and determine the Thevenin and Norton equivalent circuits for the left-side 
segment of the circuit.
DETERMINATION OF THE EQUIVALENT IMPEDANCE Ze
First, we kill the two sources (i.e., open the current source and short the voltage source 
so that the source signals are zero). The resulting circuit is shown in Figure 7.3b. Note 
the series element and two parallel elements. Since the impedances add in series and 
inversely in parallel, we have
ZR
ZC
I(s)
ZL
Voci
(c)
ZR=R
1
Cs
(b)
ZC
ZL = LS
–
R2
C2
(a)
v(t)
i(t)
C
R
L
+
Cut
+
_
(d)
V(s)
ZR
VR
VC
ZC
VL
ZL
Vocv
+
–
(f)
ZR
ZC
ZL
Isci
I(s)
+
(e)
Ze
Voc(s)
–
(h)
Ze
Isc(s)
ZC
ZR
V(s)
ZL
Iscv
(g)
–
+
FIGURE 7.3
(a) An electrical impedance circuit; (b) circuit with the sources killed; (c) open-circuit with the current source 
only; (d) open-circuit with the voltage source only; (e) Thevenin equivalent circuit; (f) closed-circuit with current 
source only; (g) closed-circuit with voltage source only; and (h) Norton equivalent circuit.

351
Transfer-Function Linear Graphs
	
=
+
+
=
+
+
=
+
+
Z
Z
Z Z
Z
Z
Ls
R
Cs
R
Cs
Ls
R
RCs
/(
)
1/(
)
1
e
L
R
C
R
C
	
(7.1)
DETERMINATION OF VOC(S) FOR THEVENIN EQUIVALENT CIRCUIT
We find the open-circuit voltage for one source at a time, and then use the principle of 
superposition to determine the overall open-circuit voltage.
	 (a)	 With Current Source I(s) Only
The open circuit with the current source only (i.e., with shorted voltage 
source) is shown in Figure 7.3c. The source current goes through the 
two parallel ­elements only, whose equivalent impedance is 
+
Z Z
Z
Z
R
C
R
C
. 
Hence, the voltage across it, which is also the open-circuit voltage (since 
no current and hence no voltage drop along the inductor), is given by
	
=
+
V
Z Z
Z
Z
I s
(
) ( )
oci
R
C
R
C
	
(7.2a)
	 (b)	 With Voltage Source V(s) Only
The open-circuit with the voltage source only (i.e., with opened current 
source) is shown in Figure 7.3d. The voltage drop across R should 
be equal to that across C, and hence, the currents in these two ele-
ments must be in the same direction. However, the sum of the currents 
through these parallel elements must be zero, by the node equation 
(since the open-circuit current is zero). Hence, each current must be 
zero and the voltages VR and VC must be zero. Furthermore, due to the 
open circuit, the voltage VL across the inductor must be zero. Then, 
from the loop equation, we have VOCV + V(s) = 0
Or
	
= −
V
V s( )
ocv
	
(7.2b)
	
	 Note the positive direction of potential drop for the open-circuit voltage, as 
needed for the Thevenin equivalent voltage source.
By superposition, the overall open-circuit voltage is
	
=
+
=
+
−
V
s
V
V
Z Z
Z
Z
I s
V s
( )
(
) ( )
( )
oc
oci
ocv
R
C
R
C
	
(7.2)
The resulting Thevenin equivalent circuit is shown in Figure 7.3e.
DETERMINATION OF ISC(S) FOR NORTON EQUIVALENT CIRCUIT
We find the short-circuit current by taking one source at a time, and then using the 
principle of superposition.
	 (a)	 With Current Source I(s) Only
The closed circuit with the current source only (shorted voltage source) is 
shown in Figure 7.3f. The source current goes through the three paral-
lel elements, and the currents are divided inversely with the respec-
tive impedances. Hence, the current through the inductor is (note the 
positive direction as marked, for the Norton equivalent current source)
	
=
+
+
I
Z
Z
Z
Z
I s
1/
(1/
1/
1/
) ( )
sci
L
R
C
L
	
(7.3a)

352
Modeling of Dynamic Systems with Engineering Applications
	 (b)	 With Voltage Source V(s) Only
The short circuit with the voltage source only (opened current source) is 
shown in Figure 7.3g. Note from the circuit that the short-circuit current is 
the current that flows through the overall impedance of the circuit (series 
inductor and a parallel resistor and capacitor combination). According to 
the polarity of the voltage source, this current is in the opposite direction 
to the positive direction marked in Figure 7.3g. We have
	
(
)
= −
+
+
I
s
V s
Z
Z Z
Z
Z
( )
( )
/(
)
scv
L
R
C
R
C
	
(7.3b)
	
	 By superposition, the overall short-circuit current is
	
(
)
(
)
=
+
=
+
+
−
+
+
I
s
I
I
Z
Z
Z
Z
I s
V s
Z
Z Z
Z
Z
( )
1/
1/
1/
1/
( )
( )
/(
)
sc
sci
scv
L
R
C
L
L
R
C
R
C
	
(7.3)
	
	 The resulting Norton equivalent circuit is shown in Figure 7.3h.
LEARNING OBJECTIVES
	
1.	 Thevenin’s theorem
	
2.	 Obtaining the Thevenin equivalent circuit of an electrical circuit
	
3.	 Obtaining the Norton equivalent circuit of an electrical circuit
	
4.	 Handling of multiple sources using the principle of superposition
▪
7.2.2  Justification of Circuit Equivalence
To justify the circuit equivalence, we proceed as follows:
	
1.	Show that the general circuit (Figure 7.2a) is equivalent to the Thevenin equivalent 
circuit (Figure 7.2b).
	
2.	Show that the general circuit (Figure 7.2a) is equivalent to the Norton equivalent 
circuit (Figure 7.2c).
	
3.	Show that the Thevenin equivalent circuit (Figure 7.2b) is equivalent to the Norton 
equivalent circuit (Figure 7.2c). Note: Actually, this step is redundant in view of 
Steps 1 and 2.
Step 1: Kill the equivalent source (i.e., short it) in the Thevenin circuit (Figure 7.2b). The 
resulting overall impedance of the Thevenin circuit is Ze. Next, open the output port of the 
Thevenin circuit. The open-circuit voltage is Voc(s). By definition, this is also the open-circuit 
voltage of the original circuit (Figure 7.2a). Hence, these two circuits must be equivalent.
Step 2: Kill the equivalent source (i.e., open it) in the Norton circuit (Figure 7.2c). The result-
ing overall impedance of the Norton circuit is Ze. Next, short the output port of the Norton 
circuit. The short-circuit current is Isc(s). By definition, this is also the short-circuit current 
of the original circuit (Figure 7.2a). Hence, these two circuits must be equivalent.
Step 3: Connect an impedance (load) Zl at the output port of the Thevenin circuit 
(Figure 7.2b). The current passing through the load is 
+
V
Z
Z
oc
e
l
. The voltage across the load 
(note: potential divider) is 
+
Z
Z
Z V
l
e
l
oc .

353
Transfer-Function Linear Graphs
Connect an impedance (load) Zl at the output port of the Norton circuit (Figure 7.2c). The 
current passing through the load is 
+
Z
Z
Z I
e
e
l
sc . (Note: Current is inversely proportional to 
the impedance.) The overall impedance of the two parallel impedances is 
+
Z Z
Z
Z
e
l
e
l
. Hence, 
the voltage across the load is 
+
Z Z
Z
Z I
e
l
e
l
sc . Now,
	 (a)	 For the currents in these two cases to be equal, we must have
	
+
=
+
=
V
Z
Z
Z
Z
Z I
V
Z I
or
oc
e
l
e
e
l
sc
oc
e sc
	
(7.4)
	 (b)	 For the voltages in these two cases to be equal, we must have
	
+
=
+
=
Z
Z
Z V
Z Z
Z
Z I
V
Z I
or
l
e
l
oc
e
l
e
l
sc
oc
e sc
It is seen that the requirements for the current equivalence are the same as the require-
ments for the voltage equivalence. Hence, the two circuits must be equivalent.
7.2.3  Extension into Other Domains
Circuit reduction and the use of Thevenin and Norton equivalent circuits are not limited to 
the electrical domain. In view of the fact that current is a through-variable and voltage is an 
across-variable, the Thevenin and Norton equivalent circuits may be extended to any linear 
dynamic system in terms of a corresponding through-variable and a corresponding across-
variable. Then for any physical domain (mechanical, fluid, thermal), the circuit reduction 
may be applied using the proper variables and element TFs for the circuits in that domain.
7.3  Equivalent TF LGs
A TF LG is an LG where only the A-type TF (i.e., Generalized impedance = [Across-
variable]/[Through-variable]; e.g., electrical impedance, mechanical mobility, fluid imped-
ance, thermal impedance) of the branch is indicated on the branch. This representation 
of LGs has particular advantages, as presented next. The reduction of a TF LG to obtain a 
simpler, equivalent LG by using the concept of equivalent circuits (Thevenin or Norton) is 
studied subsequently.
7.3.1  Transfer-Function LGs
A TF LG takes a simpler form than a time-domain LG. The reasons for this relative sim-
plicity are the following:
•	 On an LG branch we indicate only the A-type TF (generalized impedance; e.g., 
mobility in the mechanical domain), not the associated through-variable and the 
across-variable.

354
Modeling of Dynamic Systems with Engineering Applications
•	 Branches can be combined by combining the corresponding generalized imped-
ances using the standard rules for series connection and parallel connection, with-
out manipulating the branch variables themselves. This will produce a simplified 
(condensed, reduced) LG.
•	 Only the variables that are important for the analysis and the end result (e.g., input 
variables and output variables) are noted on the LG.
An illustrative example is given next.
Example 7.2
Consider the electrical circuit shown in Figure 7.4a. In the electrical domain, the gener-
alized impedance (A-type TF) is the electrical impedance. The impedance elements in 
the circuit are as follows:
Capacitor C1: 
=
Z
C s
1
C1
1
Capacitor C2: 
=
Z
C s
1
C2
2
Inductor L: ZL = LS
Resistor R: ZR = R
Note: For the frequency-domain expression for electrical impedance, set s = jω.
The TF LG of the circuit is shown in Figure 7.4b. We have indicated the electrical 
impedances of the circuit elements on the corresponding branches of the LG. We have 
not shown any variables except for the source current (independent variable of the 
source, which is the input) I(s). System variables may be indicated on the LG depending 
on the requirements of a particular problem (e.g., if we are interested in the voltage of 
capacitor C1, we will indicated that voltage (an output variable) on the corresponding 
branch of the LG.
The “preliminary” reduction of the LG may be achieved by combining the branches, 
depending on the problem objective. For instance, if we need to determine the voltage 
and/or the current of Capacitor C1, we should not combine its branch (impedance ZC1) 
with any other branch. But we may combine the branches of the remaining circuit ele-
ments where feasible. Specifically, we can combine the branches of ZL and ZC2. But we 
cannot combine the resulting branch with the branch of ZR (because ZR is in series with 
ZC1, and only one of them cannot be combined with the common parallel branch).
A sequence of branch combinations is indicated. Figure 7.4c shows the result when the 
branches of ZR and ZC1 are combined. Figure 7.4d shows the result when the branches 
of ZL and ZC2 are combined as well. Figure 7.4e shows the final result when the previous 
two combined branches are combined as well.
LEARNING OBJECTIVES
	
1.	 Preparation of a TF LG
	
2.	 Preliminary simplification (condensation, reduction) of a TF LG by combining 
the LG branches where possible
	
3.	 Identification of infeasible combinations of branches
▪
The concepts of TF LGs can be directly extended from electrical systems to mechanical 
systems using the familiar force-current analogy. According to this analogy, electrical 
impedance is analogous to mechanical mobility, which are A-type TFs (or, generalized imped-
ances); and electrical admittance is analogous to mechanical impedance, which are T-type 
TFs (or generalized admittances). This analogy is summarized in Table 7.1.

355
Transfer-Function Linear Graphs
(a)   
R
L
C1
C2
i(t)
Current
source
(b)  
ZL
ZR
ZC2
ZC1
I(s)
Z1 = ZR + ZC1
ZL
ZC2
I(s)
(c)   
(d)   
Z1
I(s)
Z2 =
ZLZC2
ZL + ZC2
(e)   
Z1Z2
Z =
I(s)
Z1 + Z2
FIGURE 7.4
(a) An electrical circuit; (b) TF LG; (c) LG simplification stage 1; (d) LG simplification stage 2; and (e) LG simpli-
fication stage 3 (final stage).
TABLE 7.1
Mechanical and Electrical TF Analogy
Mechanical circuit
Electrical circuit analogy
Mobility function
Electrical impedance
Force
Current
Voltage
Velocity

356
Modeling of Dynamic Systems with Engineering Applications
Accordingly, the preliminary reduction (condensation, simplification) of a TF LG is done 
by the following two steps:
	
1.	On each branch of the LG mark the mobility function (not mechanical impedance)
	
2.	Carry out LG analysis and reduction (simplification, condensation) as if we are 
dealing with an electrical circuit, in view of the analogy given in Table 7.1.
In particular, we do the following:
	
1.	For parallel branches: mobilities are combined by the inverse relation:
	
=
+
M
M M
M
M
1
2
1
2 	
(7.5)
	
	 Note: Velocity is common; Force is divided inversely to the branch mobility.
	
2.	For series branches: Mobilities add:
	
=
+
M
M
M
1
2 	
(7.6)
	
	 Note: Force is common; velocity is divided in proportion to the branch mobility.
7.3.2  Equivalent Mechanical Circuit Analysis Using LGs
The equivalent-circuit analysis (Thevenin equivalence and Norton equivalence) can be 
extended to mechanical systems as well, by using the force-current analogy. We start by 
forming the TF LG of the system. Then we simplify (reduce, condense) it as appropriate. 
Next, we perform an appropriate “virtual cut” and determine the Thevenin equivalent 
circuit or the Norton equivalent circuit, depending on the problem objective.
We have already discussed the formation of a TF LG, and the preliminary simplifica-
tion of an LG by combining its branches where feasible. Subsequent steps in the formation 
of an “equivalent LG” are determination of the equivalent mobility Me and the equiva-
lent source (an equivalent velocity source for Thevenin circuit and an equivalent force source 
for Norton circuit). In determining the equivalent mobility, the following operations are 
applicable:
•	 Killing a force source means open-circuiting it (so, transmitted force = 0)
•	 Killing a velocity source means short-circuiting it (so, velocity across = 0)
Some illustrative examples in the mechanical domain are given next.
Example 7.3: Ground-based Mechanical Oscillator (Revisited)
Consider the ground-based oscillator shown in Figure 7.5a. Let us use the LG equivalent 
circuit approach to determine the force transmissibility of the system.
Solution
The TF LG of the system is shown in Figure 7.5b. We can simplify/reduce this LG by 
combining the parallel branches in the suspension system (engine mount), as shown in 
Figure 7.5c, where

357
Transfer-Function Linear Graphs
Mobility of the mass:
	
=
M
ms
1
m
	
(7.7)
Mobility of the suspension system:
	
=
×
+
=
+
M
s
k
b
s
k
b
s
bs
k
1
1
s
	
(7.8)
Note: Equation 7.5 was used to combine the parallel branches.
Now, since we are interested in the force (a through-variable) through the suspension 
system, we need to do the following:
	
1.	 Virtually cut the branch corresponding to the suspension (whose force needs 
to be determined).
	
2.	 Since we need a through-variable, Thevenin equivalent LG is appropriate.
These are carried out, resulting in Figure 7.5d.
To determine the equivalent velocity source, we kill the force source in Figure 7.5c, 
and determine the mobility of the remaining circuit, viewed from the virtually cut port.
Note: For a T-source (force source), killing means opening the connection.
Clearly, the resulting equivalent mobility is
	
=
M
M
e
m 	
(7.9)
Also, from Figure 7.5c, the open-circuit velocity is
	
=
V
s
M F s
( )
( )
oc
m
	
(7.10)
s
k
(b)  
1
ms
1
b
F(s)
(a)  
b
k
f(t)
m
v
Suspension
Cut
(c)
F(s)
Ms
Mm
Fs
(d)
Me
Voc(s)
Ms
Fs
–
+
FIGURE 7.5
(a) Ground-based mechanical oscillator; (b) TF LG; (c) reduced TF LG; and (d) Thevenin equivalent LG.

358
Modeling of Dynamic Systems with Engineering Applications
Now, from the Thevenin LG in Figure 7.5d, the transmitted force is
	
=
+
=
+
F s
V
s
M
M
M F s
M
M
( )
( )
( )
s
oc
e
s
m
m
s
Note: We have substituted Equations 7.9 and 7.10.
The resulting force transmissibility is
	
=
+
T
M
M
M
f
m
m
s 	
(7.11)
This is identical to the result we obtained in Chapter 6.
LEARNING OBJECTIVES
	
1.	 Preliminary simplification (condensation) of a TF LG by combining the LG 
branches
	
2.	 Identification of the suitable virtual cut and the equivalent LG
	
3.	 Determination of the Thevenin equivalent LG
	
4.	 Determination of the force transmissibility using the equivalent LG method ▪
Example 7.4: Oscillator with Support Motion (Revisited)
Consider the mechanical oscillator with support motion, as shown in Figure 7.6a. Let 
us use the LG equivalent circuit approach to determine the motion transmissibility of 
the system.
Solution
The TF LG of the system is shown in Figure 7.6b. We can reduce this LG by combin-
ing the parallel branches in the suspension system, as shown in Figure 7.6c, where, the 
mobility of the mass, 
=
M
ms
1
m
, and the mobility of the suspension system:
	
=
+
M
s
bs
k
s
	
(see Example 7.3)
Now, since we are interested in the velocity (an across-variable) of the mass, we need to 
do the following:
	
1.	 Virtually cut the branch corresponding to the mass (whose velocity needs to be 
determined).
	
2.	 Since we need an across-variable, Norton equivalent LG is appropriate.
These are carried out, resulting in Figure 7.6d.
To determine the equivalent force source, we kill the velocity source in Figure 7.6c, 
and determine the mobility of the remaining circuit, viewed from the virtually cut port.
Note: For an A-source (velocity source), killing means closing the connection.
Clearly, the resulting equivalent mobility is
	
=
M
M
e
s 	
(7.12)
Also, from Figure 7.6c, the closed-circuit force is
	
=
F
s
V s
M
( )
( )
sc
s 	
(7.13)

359
Transfer-Function Linear Graphs
In the Norton LG of Figure 7.6d, the overall mobility of the two parallel branches is 
+
M M
M
M
e
m
e
m  (see Equation 7.5). Hence, the velocity at the mass is
	
=
+
=
+
=
+
V
M M
M
M
F
s
M M
M
M
V s
M
M V s
M
M
( )
( )
( )
m
e
m
e
m
sc
s
m
s
m
s
m
m
s
Note: We have substituted Equations 7.12 and 7.13.
The resulting motion transmissibility is
	
=
+
T
M
M
M
m
m
m
s 	
(7.14)
This is identical to the result we obtained for the force transmissibility in Example 7.3 
and also the results in Chapter 6.
LEARNING OBJECTIVES
	
1.	 Preliminary simplification (reduction, condensation) of a TF LG by combining 
the LG branches
	
2.	 Identification of the suitable virtual cut and the needed type of equivalent LG
	
3.	 Determination of the Norton equivalent LG
m
k
b
v
v1
(a)
f
1
b
s
k
+
–
1
ms
(b)
Vm
V(s)
V(s)
Vm
–
(c)
Mm
Ms
Cut
+
Vm
Mm
Me
Fsc(s)
(d)
FIGURE 7.6
(a) Mechanical oscillator with support motion; (b) TF LG; (c) reduced TF LG; and (d) Norton equivalent LG.

360
Modeling of Dynamic Systems with Engineering Applications
	
4.	 Determination of the motion transmissibility using the equivalent LG method
	
5.	 Equivalence of the force transmissibility and the motion transmissibility in 
complementary (dual, reciprocal) systems
▪
Example 7.5: Ground-based 2DOF Mechanical Oscillator (Revisited)
Let us revisit the ground-based two-degree-of freedom oscillator, this time using 
Thevenin’s theorem and LGs. The system is shown in Figure 7.7a. Its TF LG is drawn as 
in Figure 7.7b. Next, the simplified TF LG in Figure 7.7c is drawn by representing each 
suspension unit by a single branch.
Since we are interested in the force Fs transmitted through the suspension unit Ms, 
this unit is virtually cut out as in Figure 7.7d in order to determine the Thevenin equiva-
lent circuit of the remaining system, which is shown in Figure 7.7e.
To determine the open-circuit velocity V
s( )
oc
 after the cut, note from Figure 7.7d that 
the force through the 2nd parallel path is (divided according to the inverse of mobili-
ties): 
=
+
+
F
M
M
M
M
F s
(
) ( )
m
s
m
m
1
1
1
2
1
Hence, the velocity across Mm2 is (product of force and mobility):
	
=
=
+
+
V
s
M
F
M
M
M
M
M
F s
( )
(
) ( )
oc
m
m
m
s
m
m
2
1
1
2
1
2
1
	
(7.15)
The Thevenin equivalent mobility of Figure 7.7d is obtained by open-circuiting the force 
source and combining the remaining two parallel paths:
	
M
M
M
M
M
M
M
(
)
(
)
e
m
s
m
m
s
m
2
1
1
2
1
1
=
+
+
+
	
(7.16)
From Figure 7.7e, the force transmitted through the suspension is
	
F
V
s
M
M
M
M
F s
M
M
M
M
M
M
M
M
M
M
( )
(
)
( )
(
)
1
(
)
(
)
s
oc
e
s
m
m
s
m
m
m
s
m
m
s
m
s
1
2
1
2
1
2
1
1
2
1
1
=
+
=
+
+
×
+
+
+
+




or
	
F
M
M
F s
M
M
M
M M
M
M
( )
(
)
(
)
s
m
m
m
s
m
s
s
m
m
1
2
2
1
1
1
2
1
=
+
+
+
+
Hence
	
T
M
M
M
M
M
M M
M
M
Force transmissibility
(
)
(
)
f
m
m
m
s
m
s
s
m
m
1
2
2
1
1
1
2
1
=
+
+
+
+
	
(7.17)
Compare with the result obtained in Chapter 6:
	
T
M
M
M
M
M
M
M
M
1
1
1
1
1
f
s
m
s
m
s
m
s
m
1
2
2
1
2
=
+
+




+






+




We can manipulate this expression as

361
Transfer-Function Linear Graphs
b2
k2
b1
k1
m1s
m2s
1
1
1
s
s
1
(b)
(a)
fs
f(t)
k1
b1
m1
k2
b2
m2
Ms1
Fs
Ms
Mm1
Mm2
(c)
F(s)
F(s)
F(s)
Mm2
Fs
Ms1
Mm1
Cut
Ms
F1
(d)
V oc(s)
Fs
+
–
Me
Ms
(e)
FIGURE 7.7
(a) Ground-based 2 dof oscillator; (b) TF LG; (c) reduced TF LG; (d) virtual cut of the suspension unit; and (e) 
Thevenin equivalent circuit.

362
Modeling of Dynamic Systems with Engineering Applications
	
=
+
+
+



+






=
+
+
+
+
=
+
+
+
+
T
M
M
M
M
M
M
M
M
M
M
M
M
M
M
M
M
M
M
M
M
M
M
M
M
M
M M
M
M
(
)
(
)
(
)
(
)
(
)
f
m
m
s
m
s
m
s
m
s
m
m
m
s
s
m
m
s
m
m
s
m
m
m
s
m
s
s
m
m
1
2
2
1
2
2
1
1
2
1
2
2
1
2
1
2
2
1
1
1
2
1
Hence, the two expressions are equivalent.
LEARNING OBJECTIVES
	
1.	 Preliminary simplification (condensation, reduction) of a TF LG by combining 
the LG branches
	
2.	 Identification of the suitable virtual cut and the appropriate equivalent LG
	
3.	 Determination of the Thevenin equivalent LG of a somewhat complex mechan-
ical circuit
	
4.	 Determination of the force transmissibility using the equivalent LG method ▪
Example 7.6: 2DOF Mechanical System with Support Motion (Revisited)
Let us revisit the two-degree-of freedom mechanical oscillator with support motion, 
this time armed with Thevenin’s theorem and LGs. The system is shown in Figure 7.8a. 
Its TF LG is shown in Figure 7.8b. Next. the simplified TF LG in Figure 7.8c is drawn by 
representing each suspension unit by a single branch.
Since we are interested in the velocity Vm of the mass element Mm1, this unit is vir-
tually cut as in Figure 7.8c in order to determine the Norton equivalent circuit of the 
remaining system, which is shown in Figure 7.8d.
To determine the short-circuit force Fsc(s) after the cut, note from Figure 7.8c that this 
will be the forced through Ms1, after shorting the cut. Since there is a series branch Ms 
and two parallel branches Mm2 and Ms1, the force provided by the source velocity V(s) is: 
V s
M M
M
M
M
( )
(
)
s
m
s
m
s
1
2
1
2
+
+




. This force is divided “inversely” to the mobilities in the two parallel
branches Mm2 and Ms1. Hence, the short-circuit force is
	
F s
V s
M M
M
M
M
M
M
M
M
M M
M M
M
V s
( )
( )
(
)
(
)
(
)
( )
sc
s
m
s
m
s
m
s
m
m
s
m
s
s
m
1
2
1
2
2
1
2
2
1
2
1
2
=
+
+




+
=
+
+
	
(7.18)
The Norton equivalent mobility is obtained by short-circuiting the velocity source and 
combining the remaining two parallel branches Mm2 and Ms with the series branch Ms1. 
We obtain
M
M
M
M
M
M
M
M
M
M
M
M
M
M M
M M
M
M
M
(
)
(
)
e
s
m
s
m
s
s
m
s
m
s
m
s
s
m
s
s
m
m
s
1
2
2
1
2
2
2
1
2
1
2
2
=
+
+
=
+
+
+
=
+
+
+
	
(7.19)
From Figure 7.8d, the velocity Vm is the product of the force and the equivalent mobility:
	
V
M
M
M
M
F s
(
)
( )
m
m
e
m
e
sc
1
1
=
+

363
Transfer-Function Linear Graphs
Note from the results Equations 7.18 and 7.19 that F s M
M
M
M
V s
( )
(
)
( )
sc
e
m
m
s
2
2
=
+
Hence
	
V
M
M
M M
M M
M
M
M
M
M
M
V s
M
M
M
M
M
M M
M M
M
V s
M
M
M
M
M
M M
M
M
V s
(
)
(
)
( )
(
)
(
)
( )
(
)
(
)
( )
m
m
m
s
m
s
s
m
m
s
m
m
s
m
m
m
m
s
s
m
s
s
m
m
m
m
m
s
s
m
s
m
1
1
1
2
1
2
2
2
2
1
2
1
2
1
2
1
2
1
2
2
1
1
1
1
2
=
+
+
+
+




+
=
+
+
+
+
=
+
+
+
+
k2
v(t)
b2
m2
m1
vm
k1
b1
(a)
V (s)
1
b2
1
m1s
+
–
s
k2
1
b1
s
k1
1
m2s
(b)
M m1
+
–
M s1
V m
Ms
V (s)
M m2
Cut
(c)
Fsc(s)
M m1
Me
Vm
(d)
FIGURE 7.8
(a) Two-degree-of-freedom oscillator with support motion; (b) TF LG of the system; and (c) simplified TF LG; (d) 
Norton equivalent circuit.

364
Modeling of Dynamic Systems with Engineering Applications
or
	
T
M
M
M
M
M
M M
M
M
Motion transmissibility
(
)
(
)
m
m
m
m
m
s
s
m
s
m
1
2
2
1
1
1
1
2
=
+
+
+
+
	
(7.20)
The motion transmissibility obtained in Chapter 6 is
	
T
M
M
M
M
M
M
M
1
(
1
1
(
))
1
m
s
m
s
m
m
s
m
2
1
1
1
1
1
=
+
+
+












+




We can manipulate this expression as follows:
	
T
M
M M
M
M
M
M
M
M
M
M M
M
M
M
M
M
M
M
M
M
M
M M
M
M
(
)
(
)
(
)
(
)
(
)
m
m
s
s
m
m
s
s
m
m
m
s
s
m
m
s
s
m
m
m
m
m
s
s
s
m
m
1
1
1
2
1
1
1
2
1
1
2
1
1
1
2
2
1
1
1
1
2
=
+
+
+
+
=
+
+
+
+
=
+
+
+
+
It follows that the two expressions are equivalent.
Furthermore, direct comparison with the result in Example 7.5 shows that the force 
transmissibility in that example is equal to the motion transmissibility in this example. 
This further confirms the observation made in Chapter 6.
LEARNING OBJECTIVES
	
1.	 Preliminary simplification (condensation, reduction) of a TF LG by combining 
the LG branches
	
2.	 Identification of the suitable virtual cut and the suitable equivalent LG
	
3.	 Determination of the Norton equivalent LG for a somewhat complex mechani-
cal system
	
4.	 Determination of the motion transmissibility using the equivalent LG method
	
5.	 Equivalence of the force transmissibility and the motion transmissibility in the 
complementary (dual, reciprocal) systems
▪
7.3.3  Summary of Thevenin Approach for Mechanical Circuits
We now summarize the general steps in the application of the Thevenin’s theorem to 
mechanical circuits that are represented by TF LGs.
General Steps
	
1.	Draw the TF LG for the system and mark the mobility functions for all the branches 
(except the source elements).
	
2.	On the LG indicate only those variables that are important for the object (e.g., 
inputs and outputs).
	
3.	Simplify (reduce, condense) the LG by combining branches as appropriate (series 
branches: add mobilities; parallel branches: inverse rule applies for mobilities) 

365
Transfer-Function Linear Graphs
and mark the mobilities of the combined branches. Do not combine a branch 
whose variable needs to be determined (e.g., an output branch), with another 
branch.
	
4.	Depending on the problem objective (e.g., determine a particular force, velocity, 
TF) determine which segment of the circuit (LG) should be virtually cut (i.e., the 
variable or function of interest should be associated with the segment/branch that 
is removed from the LG). The equivalent LG of the remaining part needs to be 
determined.
	
5.	Depending on the problem objective, establish whether Thevenin equivalence 
or Norton equivalence is needed (Specifically: Use Thevenin equivalence if a 
through-variable or T-type TF needs to be determined, because then the equiv-
alent LG will have two series branches with a common through-variable; Use 
Norton equivalence if an across-variable or an A-type TF needs to be determined, 
because then the equivalent LG will have two parallel branches with a common 
across-variable).
	
6.	Determine the equivalent source and equivalent mobility of the equivalent LG.
	
7.	Using the equivalent LG, determine the variable or function of interest.
7.4  Multidomain TF LGs
This section studies multidomain TF LGs. Their analysis is done by first converting the 
LG into an equivalent single-domain TF LG. This conversion is done using the constitu-
tive relationships of the associated two-port elements. The other key steps in the problem 
solution are the same as before. In particular, the preliminary steps prior to the domain 
conversion are the following:
	
1.	Draw the TF LG for the system and mark the A-type TFs (generalized impedances) 
for all the branches (except the source elements).
	
2.	On the LG, indicate only those variables that are important for the object (e.g., 
inputs and outputs).
	
3.	Simplify (reduce, condense) the LG by combining branches as appropriate (series 
branches: add mobilities; parallel branches: inverse rule applies for mobilities) and 
mark the mobilities of the combined branches. Do not combine a branch whose 
variable needs to be determined (e.g., an output branch), with another branch.
7.4.1  Conversion into an Equivalent Single Domain
Once the TF LG is pre-processed using the preliminary steps indicated above, the process 
of converting a two-domain system into an equivalent single domain is done as follows 
(Note: The two domains are coupled either by a transformer or a gyrator):
	
1.	Decide which domain will be converted. This is based on the end objective of the 
analysis. Typically, the domain of the system input is converted into the domain of 
the system output.

366
Modeling of Dynamic Systems with Engineering Applications
	
2.	Determine the Thevenin equivalent LG of the subsystem that will be converted. 
This is connected to the input branch of the two-port element (transformer or 
gyrator), which links to remaining subsystem through the output branch of the 
two-port element.
	
3.	Apply the constitutive equations of the two-port element to the Thevenin equiva-
lent LG and determine the equivalent A-source and the equivalent generalized 
impedance in series, which will replace the output branch of the two-port element.
Note: In step 2, we may use Norton equivalence instead. Also, in Step 3, we may determine 
the equivalent T-source and the equivalent generalized impedance in parallel. The final 
result will be the same but the intermediate analysis will be different.
Transformer-Coupled Systems
Suppose that the two domains of the mixed system are coupled through a transformer 
two-domain). First, we apply the Thevenin theorem to the subsystem to be converted and 
determine the equivalent A-source Poc(s) and the equivalent generalized impedance Ze in 
series in the Thevenin equivalent LG. This result is shown in Figure 7.9a.
Note: If the fluid domain is to be converted, the equivalent Thevenin source Poc(s) is a 
pressure source, and Ze is a fluid impedance (Pressure/Flow Rate). If the retaining (equiva-
lent) domain is mechanical, f1 is a force and v1 is a velocity. In any other domain, these 
quantities will take the corresponding meanings.
The governing equations of the TF LG in Figure 7.9a are written now.
Equivalent-Impedance Constitutive equation:
	
P
Z Q
e
e
e
=
	
(i)
Transformer Constitutive equations:
	
v
rP
1
1
=
	
(ii)
	
f
r Q
1
1
1
= −
	
(iii)
(a)
Ze
r
–
+
(Qe, Pe)
(Poc(s), Q)
(Q1, P1)
(f1, v1)
Me
–
+
ve(s)
(f1, v1)
(b)  
FIGURE 7.9
Transformer-coupled system. (a) Thevenin equivalent LG of the subsystem to be converted and (b) equivalent 
TF LG of the subsystem in the new domain.

367
Transfer-Function Linear Graphs
where r = transformer parameter.
	
P
P
P
s
Loop equation:
( )
0
e
oc
1
−
−
+
= 	
(iv)
	
Q
Q
Node equation:
0
e
1
−
= 	
(v)
Now, we carry out substitutions as follows:
(ii): v
rP
r P
s
P
rP
s
rZ Q
rP
s
rZ Q
[
( )
]
( )
( )
oc
e
oc
e
e
oc
e
1
1
1
=
=
−
=
−
=
−
 (from (iv), (i), and (v))
	
v
rP
s
r Z f
Substitute iii :
( )
oc
e
1
2
1
( )
=
+
	
(vi)
This may be written as:
	
v
V s
M f
( )
e
e
1
1
=
+
	
(7.21)
Accordingly, we have the following results:
	
A
V s
rP
s
Converted equivalent -source
( )
( )
e
oc
=
	
(7.22)
	
M
r Z
Converted equivalent generalized impedance in series :
e
e
2
(
)
=
	
(7.23)
The equivalent TF LG of the converted subsystem is shown in Figure 7.9b.
Gyrator-Coupled Systems
Now suppose that the two domains of the mixed system are coupled through a gyrator 
(two-domain). Again, we apply the Thevenin theorem to the subsystem to be converted 
and determine the equivalent A-source P
s( )
oc
 and the equivalent generalized impedance 
Ze in series in the Thevenin equivalent LG. This result is shown in Figure 7.10a.
(a)  
Ze
(Qe, Pe)
(Q1, P1)
M
–
+
(Poc(s), Q)
(f1, v1)
(b)  
Me
–
+
ve(s)
(f1, v1)
FIGURE 7.10
Gyrator-coupled system. (a) Thevenin equivalent LG of the subsystem to be converted and (b) equivalent TF LG 
of the subsystem in the new domain.

368
Modeling of Dynamic Systems with Engineering Applications
The governing equations of the TF LG in Figure 7.10a are written now.
Equivalent-Impedance Constitutive equation:
	
P
Z Q
e
e
e
=
	
(i)
Gyrator Constitutive equations:
	
v
MQ
1
1
=
	
(ii)
	
f
M P
1
1
1
= −
	
(iii)
where M = gyrator parameter.
	
P
P
P
s
Loop equation:
( )
0
e
oc
1
−
−
+
= 	
(iv)
	
Q
Q
Node equation:
0
e
1
−
= 	
(v)
Now, we carry out substitutions as follows:
(ii): v
MQ
MQ
MP
Z
M
Z
P
s
P
M
Z P
s
M
Z
Mf
[
( )
]
( )
(
)
e
e
e
e
oc
e
oc
e
1
1
1
1
=
=
=
=
−
=
−
× −
 (from (v), (i), (iv), 
and (iii)).
We have
	
v
M
Z P
s
M
Z
f
( )
e
oc
e
1
2
1
=
+
	
(vi)
This may be written as
	
v
V s
M f
( )
e
e
1
1
=
+
	
(7.21)
Accordingly, we have the following results:
	
A
V s
M
Z P
s
Converted equivalent
- source
( )
( )
e
e
oc
=
	
(7.24)
	
M
M
Z
Converted equivalent generalized impedance in series :
e
e
2
(
)
=
	
(7.25)
The equivalent TF LG of the converted subsystem is shown in Figure 7.10b.
7.4.2  Illustrative Examples
Once the equivalent TF LG of the domain-converted subsystem is obtained, the remaining 
subsystem (of the same domain) is directly connected to it (the same way the remaining 
subsystem had been connected to the output branch of the two-port element). This gives 
the overall equivalent TF LG, expressed in a single domain. Then this equivalent TF LG, 
expressed in a single domain, can be analyzed in the same way as done in the previous 
section. Illustrative examples are given now.

369
Transfer-Function Linear Graphs
Example 7.7
A mechanical load consists of mass m and a restraining spring of stiffness k. It is moved 
by a pressure-controlled hydraulic pump of pressure Ps(t) through a long pipe and an 
end cylinder inside which the load is located (see Figure 7.11). The load m serves as the 
piston of the hydraulic cylinder. Neglect the friction between the piston and the cylinder. 
In addition to the load parameters m and k, the following system parameters are given:
	
Rf  = hydraulic resistance in the pipe that connects the drive pump to the load 
cylinder
	
If  = hydraulic inertance in the pipe
	
Cf= hydraulic capacitance in the cylinder of the load
	
A = piston/cylinder sectional area
Also
System input = drive pressure of the pump = Ps(t)
System output = velocity of the load mass = Vm
	 (a)	 Sketch a complete LG for the system. In particular orient the LG (i.e., show the 
arrows), indicate the system parameters, and the through-across-variable pairs 
of the LG branches (Note: You will have to introduce auxiliary variables).
	 (b)	 Systematically, using the unified and integrated approach (see Chapter 5), 
derive a state-space model for the system, using the LG. Give the correspond-
ing matrices A, B, C, and D.
	 (c)	 By mathematically manipulating the state equations, obtain the input-output 
differential equation relating the output Vm to the input Ps(t). What is the cor-
responding Laplace TF?
	 (d)	 Sketch the TF LG of the system. On the LG, indicate the A-type TFs of the 
branches and some key variables (which may be useful later in the LG simplifi-
cation/reduction). Convert the hydraulic (fluid) domain segment of the LG into 
an equivalent mechanical domain segment. Sketch the resulting equivalent 
mechanical domain LG. Reduce this LG into a Norton-equivalent LG, by per-
forming a suitable virtual cut (for determining the system output). Using this 
equivalent LG, determine the Laplace TF Vm/Ps of the system. Show that this 
result is identical to what you obtained in Part(c).
Solution
(a)
An LG for the system is shown in Figure 7.12a.
Area  A
Smooth 
k
m
Pump
Fluid
resistor
Fluid
inertor
Load
(m,k)
Fluid
capacitor
Rf
If
Vm
Vent
Ps(t)
Pc,Cf
FIGURE 7.11
A mechanical load moved by a hydraulic device.

370
Modeling of Dynamic Systems with Engineering Applications
(b)	
State-space shell:
	
I dQ
dt
P
f
I
I
=
	
C dP
dt
Q
f
c
c
=
(b)  
Ps(s)
+
–
Rf  + If s
M = 1/A
Pc
vm
Q
Qc
f
s
k
1
ms
1
Cf s
(a)    
QI, PI
Qc, Pc
fm, vm
fk, vk
QR, PR
Qs, Ps(t)
+
–
Q, P
If
Rf
Cf
f, v
m
k
M = 1/A
(d)   
+
–
Me
vm
s
k
1
ms
ve(s)
(c)
Poc(s)
+
–
M = 1/A
Ze
Pc
vm
Q
f
s
k
1
ms
(e)
M*e
vm
fsc
1
ms
FIGURE 7.12
(a) LG of the system; (b): TF LG of the system; (c) Thevenin equivalent representation of the fluid 
domain; (d) equivalent TF LG entirely in the mechanical domain; and (e) Norton equivalent TF LG.

371
Transfer-Function Linear Graphs
	
m dv
dt
f
m
m
=
	
df
dt
kv
k
k
=
Other constitutive equations:
Fluid resistance: P
R Q
R
f
R
=
Fluid-mechanical gyrator: v
A Q
1
=
	
f
AP
= −
Node equations:
	
Q
Q
0
s
R
−
=
	
Q
Q
0
R
I
−
=
	
Q
Q
Q
0
I
C
−
−
=
	
f
f
f
0
m
k
−
−
−
=
Loop equations:
	
P
P
P
P t
P
P
v
v
v
v
( )
0
0
0
0
c
I
R
s
c
m
k
m
−
−
−
+
=
−
+
=
−
+
=
−
+
=
Eliminate auxiliary variables:
	
P
P
P
P
P
P
R Q
P
P
R Q
I
s
c
R
s
c
f
R
s
c
f
I
=
−
−
=
−
−
=
−
−
	
Q
Q
Q
Q
Av
Q
Av
c
I
I
I
m
=
−
=
−
=
−
	
f
f
f
AP
f
AP
f
m
k
k
c
k
= −
−
=
−
=
−
	
v
v
k
m
=
Final state-space model:
	
I dQ
dt
R Q
P
P t( )
f
I
f
I
c
s
= −
−
+
	
(i)
	
C dP
dt
Q
Av
f
c
I
m
=
−
	
(ii)
	
m dv
dt
AP
f
m
c
k
=
−
	
(iii)
	
df
dt
kv
k
m
=
	
(iv)
State vector x
Q
P
v
f
I
c
m
k
T
= 
; Input vector u
Ps
= 
; Output vector 
y
vm
= 


372
Modeling of Dynamic Systems with Engineering Applications
The corresponding model matrices are
	
A
B
C
D
R
I
I
C
A
C
A
m
m
k
I
1
0
0
1
0
0
0
0
1
0
0
0
;  
1
0
0
0
;  
0
0
1
0
; 
0
f
f
f
f
f
f
=
−
−
−
−






















=
















= 

= 
	  (c) 	
Eliminate Pc from (i) and (ii):
	
I d Q
dt
R dQ
dt
C
Q
Av
dP
dt
1 (
)
f
I
f
I
f
I
m
s
2
2 = −
−
−
+
	
(v)
Eliminate fk from (iii) and (iv) and then eliminate Pc by substituting (ii):
	
m d v
dt
A
C
Q
Av
kv
(
)
m
f
I
m
m
2
2
=
−
−
	
(vi)
Substitute (vi) into (v) to eliminate QI:
	
I C
A
m d v
dt
A
C
k d v
dt
R C
A
m d v
dt
A
C
k dv
dt
A m d v
dt
A
C
k v
A
C v
dP
dt
1
f
f
m
f
m
f
f
m
f
m
m
f
m
f
m
s
4
4
2
2
2
3
3
2
2
2
2
+
+












+
+
+












+
+
+












−
=
I C m d v
dt
R C m d v
dt
I
A
kC
m d v
dt
R
A
kC
dv
dt
kv
A dP
dt
(
)
(
)
f
f
m
f
f
m
f
f
m
f
f
m
m
s
4
4
3
3
2
2
2
2
→
+
+
+
+


+
+
+
=
System TF:
	
v
P
As
I C ms
R C ms
I
A
kC
m s
R
A
kC s
k
(
)
(
)
m
s
f
f
f
f
f
f
f
f
4
3
2
2
2
=
+
+
+
+


+
+
+
	  (d) 	
Step 1:
The TF LG corresponding to the LG in Figure 7.12a is shown in Figure 7.12b
Further reduction of this LG is not required/feasible.
Step 2:
Now we represent the fluid domain by its Thevenin equivalent LG. This is shown in 
Figure 7.12c.
By the usual procedure for Thevenin circuit development, we have
Equivalent pressure source P
s
P s
R
I s
C s
C s
( )
( )
1
1
oc
s
f
f
f
f
=
+
+




×
	
(vii)

373
Transfer-Function Linear Graphs
Note: The potential divider is used in writing this equation.
Equivalent fluid impedance Z
R
I s
R
I s
C s
C s
(
)
1
1
e
f
f
f
f
f
f
=
+
+
+




×
	
(viii)
Note: Impedance combination in the two parallel branches.
Step 3:
Now we convert the fluid domain into an equivalent mechanical domain, through 
the gyrator. We get the equivalent TF LG shown in Figure 7.12d.
From Equation 7.24, equivalent velocity source is
	
v s
M
Z P
s
( )
( )
e
e
oc
=
	
(ix)
From (vii) and (viii): P
s
Z
P s
R
I s
( )
( )
(
)
oc
e
s
f
f
=
+
Note: Gyrator parameter M
A
1
=

(x)
Substitute these in (ix). We obtain
	
v s
P s
A R
I s
( )
( )
(
)
e
s
f
f
=
+
	
(xi)
From Equation 7.25, the equivalent mechanical mobility is: M
M
Z
e
e
2
=
Substitute (viii) and (x). We obtain
	
M
A
R
I s
C s
1
1
(
)
e
f
f
f
2
=
+
+







	
(xii)
Step 4:
To determine the Norton equivalent LG, we cut the output branch ms
1  and follow the 
usual procedure.
Short-circuit force at the cut:
	
f
v s
M
( )
sc
e
e
=
	
(xiii)
We kill the source and determine the equivalent mobility of the two parallel branches:
	
=
×
+
=
+
M
M
s
k
M
s
k
M s
kM
s
e
e
e
e
e
*
	
(xiv)
The resulting Norton equivalent LG is shown in Figure 7.12e.
The output velocity is

374
Modeling of Dynamic Systems with Engineering Applications
v
M
ms
M
ms
f
M
mM s
f
M s
kM
s
mM s
kM
s
v s
M
v
v
s
ms
k M
s
1
1
(
1)
/(
)
/(
)
1
( )   
   
(
)
m
e
e
sc
e
e
sc
e
e
e
e
e
e
m
e
e
*
*
*
*
2
2
=
×
+
×
=
+
=
+
+
+


×
→
=
+
+
(Note: We have substituted (xiii) and (xiv))
Substitute (xii) for Me:
v
v
s
ms
k
A
R
I s
C s
s
A s R
I s
ms
k
C R
I s s
A R
I s s
A s R
I s
ms
k
C s R
I s
A R
I s s
(
)
1
(
)
(
)
(
) 1
(
)
(
)
(
)
(
)
(
)
1
(
)
m
e
f
f
f
f
f
f
f
f
f
f
f
f
f
f
f
f
f
2
2
2
2
2
2
2
2
=
+
+
+








+
=
+
+
+
+

+
+
=
+
+
+
+

+
+
Substitute (xi) for Ve:
	
v
P
As
ms
k
C s R
I s
A R
I s s
As
I C ms
R C ms
I
A
kC
m s
R
A
kC s
k
(
)
(
)
1
(
)
(
)
(
)
m
s
f
f
f
f
f
f
f
f
f
f
f
f
f
2
2
4
3
2
2
2
=
+
+
+

+
+
=
+
+
+
+


+
+
+
This TF is identical to what was obtained previously, by the time-domain approach.
LEARNING OBJECTIVES
	
1.	 Systematic, state-space model development using the conventional LG 
approach in the time domain
	
2.	 Conversion of a time-domain LG into a TF LG
	
3.	 TF LG approach for a mixed-domain system
	
4.	 Determination of the Thevenin equivalent LG for the domain to be converted
	
5.	 Conversion of an LG in one domain into an equivalent LG in another domain, 
for a gyrator-coupled system
	
6.	 Determination of the Norton equivalent LG of a TF LG, and using it to obtain 
an A-type output (and a TF)
▪
Example 7.8
The model for a robotic hand, which is turning a door knob, may be represented as in 
Figure 7.13. The actuator is a dc motor.
The flowing parameters are given (also see Chapter 5):
	
Km = torque constant of the dc motor
	
La = leakage inductance of the motor armature
	
Ra = resistance of the motor armature
	
Jd = equivalent moment of inertia of the motor rotor and the mechanical load 
(door knob)
	
kd = torsional stiffness of the door knob
	
bd = torsional damping constant of the motor bearings and the load.

375
Transfer-Function Linear Graphs
The following variables are defined: Input = armature voltage = Va(t); Output = speed of 
the mechanical load (door knob) = ωd.
	 (a)	 Draw an LG for the system and using it, systematically, obtain a complete 
state-space model.
	 (b)	 By mathematically manipulating the state-space model determine the input-
output model (differential equation in ωd and Va ) of the system.
	 (c)	 Sketch the TF LG of the system. Indicate the A-type TFs of the branches (except 
the source branch).
	 (d)	 Convert the electrical domain segment (dc motor, which is the “input seg-
ment”) of the TF LG into an equivalent mechanical domain representation and 
sketch the corresponding overall TF LG entirely in the mechanical domain.
	 (e)	 With the objective of determining the Laplace TF 
v
/
d
a
ω
, do the following: 1. 
Reduce the equivalent mechanical TF LG by combining appropriate branches; 
2. Virtually cut an appropriate branch of the reduced LG; 3. Determine an 
appropriate (Norton or Thevenin) equivalent LG for the system (in the mechan-
ical domain).
	 (f)	 Using the equivalent LG that was obtained in Part (e) determine the system TF 
v
/
d
a
ω
 (Laplace) and show that it is identical to the result obtained in Part (b).
Solution
(a)
LG of the system is shown in Figure 7.14a.
CONSTITUTIVE EQUATIONS
State-Space Shell:
Armature leakage inductor: L di
dt
v
a
L
L
=
Inertia: J d
dt
T
d
d
d
ω
=
Torsional spring: dT
dt
k
k
d
k
ω
=
Remaining Constitutive Equations:
Armature resistance: v
R i
R
a R
=
Load damping: T
b
b
d
b
ω
=
Electro-mechanical transformer: 
k
v
T
k i
1
;
m
m
b
m
m b
ω
=
= −
(a) 
(b)   
Mechanical load
Jd
ωd
kd
bd
Motor
torque
and speed
La
+
–
Ra
dc motor armature circuit
Stator ﬁeld
(constant)
Back
emf
Motor torque
and speed
Leakage
inductance
Armature
resistance
Input voltage
va(t)
FIGURE 7.13
(a) Motor circuit and (b) mechanical load.

376
Modeling of Dynamic Systems with Engineering Applications
Me
Ms
MJ
ve(s)
–
+
ωd
(d)
Fsc
M*e
MJ
(e)
ωd
Ra
La
+
–
Jd
bd
kd
iR, vR
ib, vb
Tm, ωb
(a)
Td, ωd
Tb, ωb
Tk, ωk
iL, vL
i, va(t)
1
km
Ms =
MJ =
Voc(s)
=Va(s)
+
–
ib, vb
Tm, ωm
ωd
(c)
Ze = Ra + Las
r = 1
km
s
kd + Jds
1
bds
Ra
Las
Va(s)
–
+
ib, vb
Tm, ωm
ωd
(b)
1
km
1
Jds
1
bd
S
kd
FIGURE 7.14
(a) LG of the system; (b) TF LG; (c) reduced equivalent TF LG; (d) equivalent LG in the mechanical domain; and (e) Norton equivalent LG.

377
Transfer-Function Linear Graphs
Loop Equations:
	
v
v
v
v t( )
0
b
L
R
a
−
−
−
+
=
	
0
d
m
ω
ω
−
+
=
	
0
b
d
ω
ω
−
+
=
	
0
k
d
ω
ω
−
+
=
Node Equations:
	
i
i
0
R
−
=
	
i
i
0
R
L
−
=
	
i
i
0
L
b
−
=
	
T
T
T
T
0
m
d
b
k
−
−
−
−
=
Eliminate Auxiliary Variables:
	
v
v
v
v t
k
R i
v t
k
R i
v t
( )
( )
( )
L
b
R
a
m
m
a R
a
m
d
a L
a
ω
ω
= −
−
+
= −
−
+
= −
−
+
	
T
T
T
T
k i
b
T
k i
b
T
d
m
b
k
m b
d
b
k
m L
d
d
k
ω
ω
= −
−
−
=
−
−
=
−
−
	
k
d
ω
ω
=
Final State Equations:
State vector x
i
T
,
,
L
d
k
T
ω
= 

	
L di
dt
R i
k
v t( )
a
L
a L
m
d
a
ω
= −
−
+
	
(i)
	
J d
dt
k i
b
T
d
d
m L
d
d
k
ω
ω
=
−
−
	
(ii)
	
dT
dt
k
k
d
d
ω
=
	
(iii)
Model Matrices:
	
A
B
C
D
R
L
k
L
k
J
b
J
J
k
L
0
1
0
0
;
1
0
0
;
0
1
0
;
[0]
a
a
m
a
m
d
d
d
d
d
a
=
−
−
−
−
















=












= 

=

378
Modeling of Dynamic Systems with Engineering Applications
(b)
From (ii): 

i
k
J
b
T
1 [
]
L
m
d
d
d
d
k
ω
ω
=
+
+
Substitute in (i): 




L
k
J
b
T
R
k
J
b
T
k
v t
[
]
[
]
( )
a
m
d
d
d
d
k
a
m
d
d
d
d
k
m
d
a
ω
ω
ω
ω
ω
+
+
+
+
+
+
=
Differentiate this result and substitute (iii):
	







L
k
J
b
k
R
k
J
b
k
k
v t
[
]
[
]
( )
a
m
d
d
d
d
d
d
a
m
d
d
d
d
d
d
m
d
a
ω
ω
ω
ω
ω
ω
ω
+
+
+
+
+
+
=
	




L J
L b
R J
L k
R b
k
R k
k v t
    
(
)
(
)
( )
a
d
d
a
d
a
d
d
a
d
a
d
m
d
a
d
d
m
a
2
ω
ω
ω
ω
→
+
+
+
+
+
+
=
In the Laplace domain, the TF
	
V
k s
L J s
L b
R J s
L k
R b
k
s
R k
(
)
(
)
d
a
m
a
d
a
d
a
d
a
d
a
d
m
a
d
3
2
2
ω
=
+
+
+
+
+
+
(c)
The TF LG of the system is shown in Figure 7.14b.
The electrical domain of this LG is already in the Thevenin equivalent form.
Thevenin equivalent voltage source:
	
V
s
V s
( )
( )
oc
a
=
	
(iv)
Thevenin equivalent series impedance:
	
Z
R
L s
e
a
a
=
+
	
(v)
Furthermore, in the mechanical domain, the parallel branches of the spring and the 
damper can be combined (since they are not needed separately in the further analysis) 
into a single branch. Specifically, b
1
d
 and s
kd
 are combined into a single mobility:
	
M
b
s
k
b
s
k
s
k
b s
1
1
s
d
d
d
d
d
d
=
×
+
=
+
	
(vi)
The resulting equivalent TF LG is shown in Figure 7.14c.
(d)
Now we convert the electrical domain into an equivalent mechanical domain, 
through the transformer. We get the equivalent TF LG shown in Figure 7.14d. The 
equivalent source and equivalent series generalized impedance are obtained using 
the standard formulas. Specifically:
From Equation 7.22, equivalent velocity source is
	
v s
rV
s
k V s
( )
( )
1
( )
e
oc
m
a
=
=
	
(vii)
(from (iv))

379
Transfer-Function Linear Graphs
From Equation 7.23, equivalent mobility is
	
M
r Z
k
R
L s
1 (
)
e
e
m
a
a
2
2
=
=
+
	
(viii)
(from (v))
Note: Transformer parameter
	
r
k
1
m
=
	
(ix)
(e)
Since we are interested in the velocity across the inertia branch 
=
M
J s
1
J
d
, virtually 
cut the inertia branch.
Also, since we are interested in the across-variable, we use the Norton equivalent LG.
We proceed as follows.
Short-circuit force:
	
F s
v s
M
( )
( )
sc
e
e
=
	
(x)
Equivalent mobility (of the parallel branches), after killing (shorting) the velocity 
source:
	
M
M
M
M
M
M
s
k
b s
M
s
k
b s
M s
M k
b s
s
(
)
e
e
s
e
s
e
d
d
e
d
d
e
e
d
d
* =
×
+
=
×
+
+
+
=
+
+
	
(xi)
The corresponding Norton equivalent circuit is shown in Figure 7.14e.
We can now confirm that that Norton equivalent circuit is appropriate in this prob-
lem because we needed to determine the across-variable 
d
ω  at the cut branch.
(f)
From the Norton equivalent LG in Figure 7.14e, with parallel branches, we have
	
M
M
M
M
F
M
J s
M
J s
F
M
M J s
v s
M
(
)
1
1
(
1)
( )
d
J
J
J
J
sc
e
d
e
d
sc
e
e
d
e
e
*
*
*
*
*
*
ω =
×
+
=
×
+




=
+

{From (x)}
Substitute (xi):
	
v
M s
M k
b s
s J s
s
M k
b s
s
s
M J s
b s
k
s
1
(
)
1
[
(
)
]
(
)
d
e
e
e
d
d
d
e
d
d
e
d
d
d
2
ω
=
+
+




+
×
+
+
=
+
+
+

380
Modeling of Dynamic Systems with Engineering Applications
Substitute (viii):
	
v
s
R
L s
k
J s
b s
k
s
(
)(
)
d
e
a
a
m
d
d
d
2
2
ω
=
+
+
+
+
Substitute (vii):
	
V
k s
L s
R
J s
b s
k
k s
(
)(
)
d
a
m
a
a
d
d
d
m
2
2
ω
=
+
+
+
+
This is identical to the result in Part (b).
LEARNING OBJECTIVES
	
1.	 State-space model development using the conventional LG approach in the 
time domain
	
2.	 Conversion of a time-domain LG into a TF LG
	
3.	 TF LG approach for a mixed-domain system
	
4.	 Determination of the Thevenin equivalent LG for the input domain
	
5.	 Conversion of an LG segment in one domain into an equivalent LG segment 
(Thevenin form) in another domain, for a transformer-coupled system
	
6.	 Determination of the Norton equivalent LG of a TF LG and using it to obtain 
an A-type output (and an A-type TF)
■
Summary Sheet
Model Conversion/Approximation: (1) Distributed-parameter to lumped-parameter; 
(2) Nonlinear to linear; (3) Time-domain to TF (Laplace-domain, frequency-domain); (4) 
Detailed component-based to a reduced TF; (5) Complex structure to simple equivalent 
(Thevenin or Norton) structure
Thevenin Equivalence: Equivalent A-type source with equivalent A-type TF (generalized 
impedance) in series
Thevenin Source: Open-circuit across-variable → Voc(s)
Thevenin Impedance: Overall impedance with sources killed = Ze
Killing a force source → open-circuiting it → transmitted force = 0
Killing a velocity source → short-circuiting it → velocity across = 0
Norton Equivalence: Equivalent T-type source with equivalent A-type TF (generalized 
impedance) in parallel
Norton Source: Short-circuit through-variable → Isc(s); Note: V
Z I
oc
e sc
=
Norton Impedance: Overall impedance with sources killed = Thevenin Impedance = Ze
Series Branches: Combined mobility (or, generalized impedance) M
M
M
1
2
=
+
Parallel Branches: Combined mobility (or, generalized impedance) M
M M
M
M
1
2
1
2
=
+
Steps of Equivalent LG Approach

381
Transfer-Function Linear Graphs
	
1.	Draw TF LG; mark A-type TFs (generalized impedances) for all the branches 
(except sources)
	
2.	On TF LG indicate important variables only (e.g., inputs and outputs)
	
3.	Simplify (reduce, condense) TF LG by combining branches. Do not combine a 
branch whose variable needs to be determined (e.g., output branch)
	
4.	Depending on problem objective, determine which LG segment should be cut. The 
equivalent LG of the remaining part needs to be determined
	
5.	Depending on problem objective, establish whether Thevenin equivalence or 
Norton equivalence is needed. Use Thevenin equivalence if a through-variable 
needs to be determined; Use Norton equivalence if an across-variable needs to be 
determined
	
6.	Determine the equivalent source and generalized impedance of the equivalent LG
	
7.	Using the equivalent LG determine the variable or function of interest.
Conversion into Equivalent Single Domain: (1) Determine the Thevenin equivalent 
LG (associated source P
s( )
oc
 and generalized impedance Ze) of the subsystem to be con-
verted;  (2) Determine the converted equivalent A-source and series A-TF (generalized 
impedance) depending on the two-port coupling element:
Transformer-coupled Systems: Converted equivalent A-source V s
rP
s
( )
( )
e
oc
=
; Converted 
equivalent generalized impedance (in series): M
r Z
e
e
2
=
Note: r = transformer parameter
Gyrator-coupled Systems: Converted equivalent A-source V s
M
Z P
s
( )
( )
e
e
oc
=
; Converted 
equivalent generalized impedance (in series): M
M
Z
e
e
2
=
Note: M = gyrator parameter
Problems
	 7.1	 Consider the ground-based mechanical oscillator shown Figure P7.1.
	
(a)	 Sketch the TF LG of the system. Indicate the source element and the mobility 
functions of the branches.
	
(b)	 Combine the spring and the damper branches.
	
(c)	 Virtually cut the mass branch and find the Thevenin equivalent LG of the 
remaining LG. Determine the force transmissibility.
	
(d)	 Determine the force (inertial force) through the mass and the velocity of the 
mass using, 1. Simplified TF LG; 2. Thevenin equivalent LG. Show that the 
results from the two methods are identical.
	 7.2	 Consider the mechanical oscillator with support motion, as shown in Figure P7.2.
	
(a)	 Sketch the TF LG of the system. Indicate the source element and the mobility 
functions of the branches.
	
(b)	 Combine the spring and damper branches.

382
Modeling of Dynamic Systems with Engineering Applications
	
(c)	 Virtually cut the mass branch and find the Norton equivalent LG of the remain-
ing LG.
	
(d)	 Determine the force (inertial force) through the mass and the velocity of the 
mass using, 1. Simplified TF LG; 2. Norton equivalent LG. Show that the results 
from the two methods are identical.
	 7.3	 Consider the mass-spring-damper system that has two inputs: Force source f t( ) 
acting on the mass; velocity v t( ) source at the base, as shown in Figure P7.3. The 
resulting velocity of mass m is vm. The force associated with the velocity source 
v t( ) is fs, which is also the force transmitted through the suspension unit consist-
ing of the spring and the damper (Note: v t( ), not fs, is the input. fs is the “dependent 
variable” of the velocity source).
	
(a)	 Sketch the TF LG for the system and mark the mobility parameters of the 
branches and the source variables F s( ) and V s( ), in the Laplace domain. Also 
mark the mass velocity Vm and the support force Fs on the LG.
	
(b)	 Redraw the TF LG so that the two parallel branches corresponding to k and b 
are combined into a single branch with mobility Ms. Express Ms in terms of k 
and b.
	
(c)	 Make a virtual cut of the branch corresponding to the mass element in the TF 
LG of Part (b) and determine the corresponding Norton equivalent LG.
vm
b
k
m
v
f
FIGURE P7.2
Oscillator with support motion.
b
k
m
f (t)
v
Suspension
FIGURE P7.1
Ground-based mechanical oscillator.

383
Transfer-Function Linear Graphs
	
	 Using the Norton LG express Vm in terms of the inputs F s( ) and V s( ). From 
this result determine the motion transmissibility V
V s( )
m
 for the special case: 
F s( )
0
= .
	
(d)	 Make a virtual cut of the branch corresponding to the suspension element (Ms) 
in the TF LG of Part (b) and determine the corresponding Thevenin ­equivalent 
LG.
Using the Thevenin LG express Fs in terms of the inputs F s( ) and V s( ). From 
this result determine the force transmissibility F F s( )
s
 for the special case of 
V s( )
0
=  (i.e., when the base is fixed).
	 7.4	 An incompressible liquid is pumped into a tank, as schematically shown in Figure 
P7.4. The pump is modeled as a pressure source of pressure P t( ), which is mea-
sured with respect to the ambient (atmospheric) pressure. The overall resistance 
of the liquid flow in the piping is R f  and the overall inertance of the liquid flow in 
the piping is I f. The liquid capacitance (due to gravity head) of the tank is C f.
m
k
b
v(t)
f (t)
fs
vm
FIGURE P7.3
Mechanical oscillator with a force source and a velocity source.
+
–
H
Rf
If
Cf
P(t)
PH
Pa
Pa
FIGURE P7.4
A liquid pumping system.

384
Modeling of Dynamic Systems with Engineering Applications
	
(a)	 Sketch an LG for the system (Note: You may introduce auxiliary variables as 
necessary).
	
(b)	 Taking x
P Q
[
]
H
T
=
 as the state vector, u
P t
[ ( )]
=
 as the input, and y
H
[
]
=
 
as the  output, determine a complete state-space model for the system (i.e., 
determine the model matrices A, B, C and D) systematically, using the LG. 
Nomenclature:
PH = liquid pressure at the bottom of the tank with respect to the ambient 
pressure
Q = volume flow rate of the liquid in the piping
H = height of liquid in the tank
ρ = mass density of the liquid
g = acceleration due to gravity
	
(c)	 From the state-space model of Part (b), determine the input-output differential 
equation of the system.
	
(d)	 Represent the LG of Part (a) in the Laplace domain, as a TF LG and indicate the 
impedance functions (i.e., [Pressure]/[Flow Rate] ratio in the Laplace domain) 
of each branch (except the source). Cut the branch corresponding to the liq-
uid capacitance. Obtain the Norton equivalent circuit of the remaining cir-
cuit (i.e., determine an equivalent liquid flow source Q
s( )
sc
 and an equivalent 
­liquid impedance Ze in parallel, to which the cut capacitance branch will be 
connected in parallel. From this circuit determine the TF between the capaci-
tance pressure P
s( )
H
 and the input pressure P s( ).
Determine the corresponding input-output differential equation (in the time 
domain; i.e., change s to d
dt) relating H and P t( ). Verify that this result is identi-
cal to what was obtained in Part (c).
	 7.5	 Figure P7.5 shows two systems (a) and (b), which may be used to study force trans-
missibility and motion transmissibility, respectively. Clearly discuss whether the 
force transmissibility F
F
/
s
 (in the Laplace domain) in System (a) is equal to the 
motion transmissibility V
V
/
m
 (in the Laplace domain) in System (b) (i.e., the “reci-
procity,” “duality,” or “complementarity” of the two systems), by carrying out the 
following steps:
	
1.	 Draw the LGs for the two systems and mark the mobility functions for all the 
branches (except the source elements); i.e., sketch the TF LGs
	
2.	 Simplify the two LGs by combining branches as appropriate (series branches: 
mobilities add; parallel branches; inverse rule applies for mobilities) and mark 
the mobilities of the combined branches
	
3.	 Based on the objectives of the problem (i.e., determination of the force trans-
missibility of System (a), and motion transmissibility of System (b)), for apply-
ing Thevenin’s theorem, determine which segment of the LG should be cut 
(Note: The variable of interest in the particular transmissibility function should 
be associated with the segment of the circuit that is cut)
	
4.	 Based on the objectives of the problem, establish whether Thevenin equiva-
lence or Norton equivalence is appropriate (Specifically: Use Thevenin equiv-
alence if a through-variable needs to be determined, because the Thevenin 

385
Transfer-Function Linear Graphs
LG gives two series elements with a common through-variable; Use Norton 
equivalence if an across-variable needs to be determined, because the Norton 
LG gives two parallel elements with a common across-variable)
	
5.	 Determine the equivalent sources and mobilities of the equivalent LGs of the 
two systems
	
6.	 Using the two equivalent LGs determine the transmissibility functions of 
interest
	
7.	 By analysis, examine whether the two mobility functions obtained in this 
manner are equivalent.
Note: Neglect the effects of gravity (i.e., Assume that the systems are hori-
zontal, supported on frictionless rollers; or the static deflections of the springs 
compensate for the gravitational forces).
Bonus: Extend you results to an n-degree-of-freedom system (i.e., one with n 
mass elements), structured as in Figure P7.5a and Figure P7.5b.
	 7.6	 Consider the rotatory load driven by a turbine through a long shaft and a step-
down gear, as shown in Figure P7.6.
Its state-space model is given by,
	
T
k
t
p
(
( )
)
k
s
l
ω
ω
=
−
(b)
m1
k1
k2
k3
b1
vm
b2
b3
m2
m3
(a)
m1
k1
k2
k3
b1
b2
b3
fs
m2
m3
f (t)
v(t)
FIGURE P7.5
Two mechanical systems. (a) For determining force transmissibility and (b) for determining motion 
transmissibility.

386
Modeling of Dynamic Systems with Engineering Applications
	

J
pT
b
l
l
k
l
l
ω
ω
=
−
Input = 
t( )
s
ω
; output = 
l
ω
The I/O differential equation model is obtained by eliminating Tk  as follows:
The 2nd state equation gives: 

T
p J
b
1 (
)
k
l
l
l
l
ω
ω
=
+
Substitute in the 1st state equation after differentiating:
	




p J
b
k
t
p
J
b
kp
kp
s
1 (
)
(
( )
)
( )
l
l
l
l
s
l
l
l
l
l
l
s
2
ω
ω
ω
ω
ω
ω
ω
ω
+
=
−
⇒
+
+
=
The corresponding TF is: 
kp
J s
b s
kp
l
s
l
l
2
2
ω
ω =
+
+
 
Obtain this result by using the approach of TF LG (Laplace-domain) and 
equivalent LG (Thevenin or Norton).
	 7.7	 Consider the simplified model for the vertical dynamics of a hovercraft, as sketched 
in Figure P7.7.
Input 
Q t
u
[
( )]
s
=
; Output 
v
y
[ ]
=
. Also, Q t( )
s
 = volume flow rate of the pump; 
Pf  = gage pressure of air in the cylindrical space underneath the hovercraft; 
A = area of cross-section of the cylindrical space; C f = fluid capacitance due to 
air compressibility; R f = fluid flow resistance of the exiting air from the edges 
of the cylindrical space; v = vertical velocity of the hovercraft; M = effective 
mass of the hovercraft.
	
(a)	 Sketch a conventional LG (in the time domain) and using it, systematically 
determine a linear state-space model for the system
	
(b)	 Obtain the input-output differential equation and the corresponding TF of this 
model
	
(c)	 Sketch a TF LG, in the Laplace domain, for the system
	
(d)	 Convert the fluid domain into an equivalent mechanical domain and sketch 
the corresponding TF LG, which is entirely in the mechanical domain
	
(e)	 Make a virtual cut of the branch that represents the mass M. Based on that, 
obtain the Norton equivalent LG
k
Turbine
(velocity source)
Jl
bl
(p : 1)
Step-down
gear
Load
Tk
ωs(t)
ωl
FIGURE P7.6
A load driven by a turbine through a long shaft and a step-down gear.

387
Transfer-Function Linear Graphs
	
(f)	 From the Norton LG determine the system TF v Q
( /
)
s  and show that this result 
is identical to what was obtained in Part (b).
	 7.8	 A mechanical load of mass m is driven by a force source f t( ) and is buffered using 
a gas shock absorber, as shown in Figure P7.8. The gas cylinder is properly sealed 
(i.e., gas does not leak out of the cylinder compartment). The piston moves against 
the cylinder without experiencing appreciable friction (or, that friction component 
may be incorporated into the damping in the motion of the mass, assuming that 
the shaft is rigid). The following parameters are given:
m = mass of the moving load
b = equivalent viscous damping constant of the load motion
C f = capacitance of the gas in the shock absorber
A = area of the piston
	
(a)	 Using Laplace domain variables and A-type TFs (e.g., mobility functions for 
mechanical elements) sketch a TF LG for the system.
Hovercraft body
(effective mass = M)
Pressure Pf
Ground
Pump
(ﬂow source)
Qs(t)
Air ﬂow
Area of cylindrical
volume = A
h
y
FIGURE P7.7
A simplified model for vertical dynamics of a hovercraft.
Load
m
Cf ,  Pf
v1
Force
source
Gas shock absorber
A
b
Smooth seal
Atmospheric
pressure
Clearance
f(t)
FIGURE P7.8
Mechanical load with a shock absorber.

388
Modeling of Dynamic Systems with Engineering Applications
	
(b)	 Suppose that we are interested in the force transmissibility function from the 
applied force F s( ) to the damping force F s( )
b
 at the mechanical damper b. Make 
a suitable cut of a branch, and determine a suitable equivalent LG (you must 
decide whether to use Thevenin equivalence or Norton equivalence, based on 
what needs to be determined). Using that equivalent LG, determine the trans-
missibility function F s
F s
( )/ ( )
b
, where F s( ) = Laplace-transformed f t( ).
	 7.9	 An armature-controlled linear dc actuator (similar in principle to a rotatory dc 
motor, but for rectilinear motions rather than rotatory motions) is used to adjust 
the linear motion of a load (see Figure P7.9). Nomenclature:
La = armature leakage inductance
Ra = armature resistance
v t( )
a
 = drive voltage in the armature circuit (input)
km = force constant (the constant of proportionality between the generated 
magnetic force and the armature current); analogous to torque constant
ma = armature mass
ml = load mass
bl = damping constant of the resisting force on the load mass
k = stiffness of the link between ma and ml
vl = speed of load mass (output)
Note 1: In ideal energy conversion, km is equal to the constant of proportionality 
between the back emf and the speed of the motor.
Note 2: In armature control, the field (stator) conditions are assumed constant.
	
(a)	 Draw a TF LG in the Laplace domain, for the system, indicating the A-type TFs 
(e.g., electrical impedance and mechanical mobility) of the branches
	
(b)	 Obtain an equivalent TF LG of the given electro-mechanical system, entirely in 
the mechanical domain
	
(c)	 Make a cut at the branch corresponding to the load mass and obtain the Norton 
equivalent LG of the converted system
	
(d)	 Using the Norton equivalent LG, determine the TF of the system.
bl
vl
ml
k
ma
va (t)
Ra
La
Linear dc motor
+
–
Mechanical load
FIGURE P7.9
dc linear actuator moving a linear mechanical load.

389
Transfer-Function Linear Graphs
	 7.10	
A flow-controlled liquid pump drives a piston within a cylinder. The piston 
rod, which is flexible with stiffness k, moves a payload of mass m against some 
mechanical resistance approximated by a linear viscous damper of damping 
constant b (see Figure P7.10). Also,
C f = fluid capacitance of the piston-cylinder unit
A = area of the piston on the liquid side.
	
(a)	 Determine the TF between the input Q s( ) and the output Vm, where
Q s( ) = volume flow rate of the pump
Vm = speed of the mass m.
Note: All the variables are expressed in the Laplace domain.
	
(b)	 From the result of Part (a), determine the input-output differential equation 
of the system.
	
	 In solving this problem, you must use the following steps:
	
1.	 Draw a TF LG of the system, in the Laplace domain. Indicate the pertinent 
A-type TFs of the LG branches (in terms of the parameters C
A k b
m
,
, , , and
f
)
	
2.	 Convert the fluid domain into an equivalent mechanical domain. Give the 
corresponding, equivalent LG in the mechanical domain. Clearly indicate 
the input (source) and the output on the LG
	
3.	 Perform an appropriate cut and obtain the pertinent equivalent LG (Thevenin 
or Norton, as appropriate). Obtain the equivalent source (velocity or force, as 
appropriate) and the equivalent mobility for the equivalent LG
	
4.	 By analyzing the equivalent LG of Step 3, determine Vm in terms of Q s( ).
	 7.11	
An armature-controlled dc motor is used to operate a fluid pump, as schemati-
cally shown in Figure P7.11a. The equivalent armature (rotor) circuit of the motor 
is shown in Figure P7.11b, where the field windings (stationary) are assumed to 
provide a steady magnetic field.
v t( )
a
 = armature voltage (input)
Ra = resistance in the armature windings
La = leakage inductance of the armature
iL = current through the inductance.
Q(s)
k
Cf
Area = A 
m
Smooth
seal
Flexible rod
Payload
Flow-controlled
pump
Piston and cylinder
b
FIGURE P7.10
Motion control of a payload using a pump-cylinder device.

390
Modeling of Dynamic Systems with Engineering Applications
The mechanical subsystem is modeled as in Figure P7.11c.
J = overall moment of inertia (motor rotor and pump impeller combined; this 
may also include the “added mass” of the fluid in the pump)
bl = linear viscous damping constant representing the pump fluid load (corre-
sponding to resisting torque at constant speed, which excludes the added 
mass effect), and mechanical friction in the motor and the pump
ω = speed of the inertia (= motor speed 
m
ω  = pump speed 
l
ω ).
Note: The shaft connecting the motor to the pump is rigid.
Also, km = torque constant of the motor.
(a)  Sketch a conventional (time-domain) LG for the system (Note: You may 
introduce auxiliary variables as necessary)
(b)  Taking x
i
[
]
L
T
ω
=
 as the state vector, u
v t
[
( )]
a
=
 as the input, and y
[
]
l
ω
=
 
as the output, determine a complete state-space model for the system, sys-
tematically, using the LG
(c)  From the state-space model determine the input-output differential equa-
tion relating the output 
l
ω  to the input v t( )
a
.
(a)   
va(t)
Jm
ωl
Jp
J = Jm + Jp
dc motor
Pump
(b)   
(c)   
ωm,Tm
+
–
va(t)
vb
Field circuit
(steady)
iL
La
Ra
Armature circuit
Tm
Tl = blωl
J
ω
FIGURE P7.11
(a) An armature-controlled dc motor operating a fluid pump; (b) armature circuit (field circuit is steady); and 
(c) mechanical model.

391
Transfer-Function Linear Graphs
(d)  Represent the LG of Part (a) in the Laplace domain as a TF LG, and indicate 
the electrical impedances and mechanical mobilities of all the branches 
(except the source and the transformer). Convert the input side of the LG 
(electrical domain) into an equivalent mechanical domain. Cut the branch 
corresponding to the load bl and obtain the corresponding Norton equiva-
lent LG (i.e., an equivalent torque source in parallel with an equivalent 
mechanical mobility) to which the branch bl will be connected in parallel.
From this Norton equivalent LG, determine the TF between the output 
l
ω  and the 
input va. Determine the corresponding input-output differential equation. Verify that 
this result is identical to what was obtained in Part (c).


393
8
Simulation Block Diagrams
Chapter Highlights
•	 Model Equivalence
•	 Relationship between Transfer Functions and Block Diagrams
•	 Relationship between State-Space Models and Block Diagrams
•	 Rules of Block-Diagram Manipulation
•	 Transfer Function of a Feedback Loop
•	 Simulation Block Diagrams
•	 State-Space Models from Simulation Block Diagrams
•	 The Superposition Method for Simulation Diagram Generation
•	 The Grouping Like-Derivatives Method for Simulation Diagram Generation
•	 The Factored Transfer-Function Method for Simulation Diagram Generation
•	 The Partial Fraction Method for Simulation Diagram Generation
•	 Causality and Physical Realizability
8.1  Introduction
In this book, we have studied different types of models, their formulation, analysis, 
and application. There are specific advantages and shortcomings in any type of model. 
Based on the objective, a particular type of model may present the most benefits. We have 
seen that such benefits may be attributed to the underlying nature of “equivalence” or 
“approximate equivalence” of the model to another form of model or to the actual sys-
tem itself. Specifically, in the book, we have considered the equivalence or approximate 
equivalence between (1) distributed-parameter models and lumped-parameter models; 
(2) nonlinear models and linear models; (3) time-domain models and transfer-function 
models; (4) detailed component-based models and reduced transfer-function models; and 
(5) complex-structure models and simple-structure models (Thevenin or Norton). In this 
chapter, we introduce another form of equivalence—that concerning computer simulation. 

394
Modeling of Dynamic Systems with Engineering Applications
In particular, we present some model structures that are equivalent to an original input–
output (I–O) model and are particularly useful in the formulation of state-space models and 
the computer simulation of a dynamic system.
Block diagrams are widely used in representing models of dynamic systems for vari-
ous applications such as computer simulations, performance analyses, and control. 
Specifically, a transfer-function model can be directly represented by a block diagram 
and vice versa. Also, we have seen that linear state-space models and transfer-function 
models are equivalent. In other words, I–O differential equation models, transfer-func-
tion models, block-diagram models, and state-space models are all related because they 
may represent the same dynamic system. In this light, in the present chapter we study 
basic blocks, operations, and rules of manipulation of block diagrams. Then we con-
sider the representation of an I–O model by different forms of simulation block-­diagram 
models. Next, we study the formulation of a state-space model from a simulation 
block-diagram model. We primarily focus on the relationship between I–O differential 
equation models, transfer-function models, simulation block-diagram models, and state-
space models. In particular, the simulation block-diagram models can be quite beneficial in 
computer simulation.
8.2  Block-Diagrams and State-Space Models
State-space representation of a dynamic system is not unique. Many different state models 
can be developed that are equivalent to the same dynamic system. Similarly, the block-­
diagram representation of a dynamic system is not unique. In other words, many equiv-
alent state models and block diagrams can be developed for the same system. Then, a 
challenge is to select the most appropriate state-space model or the most appropriate form 
of block diagram for a given dynamic system based on the objectives of the problem. This 
section explores the relationship between block diagrams and state-space models. For 
example, we may explore such questions as follows:
•	 Given a block diagram, is there a particular form of state-space model that more 
effectively represent the structure and the information content of the particular 
block diagram?
•	 Given a state-space model, is there a particular form of block diagram that more 
effectively represent the nature of the particular state-space model?
8.2.1  Transfer Functions and Block Diagrams
A dynamic model may be represented by a block diagram, which consists of intercon-
nected blocks (containing transfer functions including “integrators” and simple “gains” or 
“coefficients”) and summing junctions. For example, the transfer-function model G(s) of 
a single-input single-output (SISO) system can be represented by a single block with an 
input and an output, as shown in Figure 8.1a. For a multi-input multi-output (MIMO) sys-
tem, the inputs and outputs are vectors u and y. The corresponding information (signal) 
lines are drawn thicker, as in Figure 8.1b, to indicate that they represent vectors. These are 
block diagrams with just a single block.

395
Simulation Block Diagrams
One disadvantage of this “overall” transfer-function representation is obvious from 
Figure 8.1: No information regarding how the various elements or components are inter-
connected within the system can be uniquely determined from the transfer function. Also, 
it does not present any particular advantage in computer simulation of the system. It con-
tains only a unique, overall I–O description.
A given transfer function can correspond to several different structural interconnec-
tions of system components, which can then be represented by different (yet equivalent 
and detailed) block diagrams. Also, a given transfer function can be represented by a 
variety of equivalent state-space models. We identify the transfer function of a dynamic 
model by its inputs and outputs, not by its state variables, which are internal variables. 
However, the internal structure of a dynamic system can be indicated by a more elabo-
rate graphical representation. One such representation is provided by linear graphs, as we 
have seen in Chapters 5 and 7. Another detailed representation can be provided by a block 
diagram with many blocks representing the basic system elements or components con-
nected together. Such a detailed block diagram may uniquely indicate the state variables 
in a particular model.
8.2.2  State-Space Models and Block Diagrams
Consider the state-space model given in the compact vector-matrix form by (see Chapter 3):
	
=
+
x
Ax
Bu

	
(8.1)
	
=
+
y
Cx
Du 	
(8.2)
where
	
	

= 

x
x x
xn
T
1
2
 
= state vector (nth order)
	
	

= 

u
u u
ur
T
1
2
 
= input vector (rth order)
	
	

= 

y
y y
ym
T
1
2
 = output vector (mth order)
u
G(s)
G(s)
y
Input
Output
(a)
(b)
u
y
Input
vector
Output
vector
FIGURE 8.1
Block-diagram representation of a transfer-function model. (a) SISO system; (b) MIMO system.

396
Modeling of Dynamic Systems with Engineering Applications
A = system matrix (n × n)
B = input distribution matrix (n × r)
C = output (or measurement) gain matrix (m × n)
D = feedforward input gain matrix (m × r)
A block diagram that uniquely represents this model is shown in Figure 8.2. The func-
tion of each element in the block diagram should be self-explanatory. If not, see the 
descriptions in the next section. For instance, two or more blocks in cascade can be 
replaced by a single block having the product of individual transfer functions. Also, 
two or more blocks in parallel can be replaced by a single block having the sum of 
individual transfer functions. The circle in Figure 8.2 is a summing junction. A negative 
sign at the arrowhead of an incoming signal corresponds to subtraction of that signal. 
As mentioned earlier (see Chapter 5), 1/s can be interpreted as integration, and s as 
differentiation.
Note the feedforward path corresponding to D. The feedback paths (corresponding to A) 
do not necessarily represent a feedback control system where “active” feedback paths are 
generated by an external controller. The internal feedback paths shown in Figure 8.2 cor-
respond to natural feedback within the system.
Note: Strictly, thicker signal lines should be used in this diagram since we are dealing 
with vector variables.
As we have seen in Chapter 5, the transfer-function relation of the system of Equations 
8.1 and 8.2 is given by
	
(
)
=
−
+


−
Y
C
I
A
B
D U
s
s
s
( )
(
)
( )
1
	
(8.3)
This is an MIMO system. Its transfer function is a matrix, given by
	
== (
)
−
+
−
G
C
I
A
B
D
s
s
( )
(
) 1
	
(8.4)
u
B
–A
C
D
y
x
x
–
1
s I
FIGURE 8.2
Block-diagram representation of a state-space model.

397
Simulation Block Diagrams
8.3  Block-Diagram Manipulation
We note the following with regard to block diagrams:
	
1.	Rectangular block: Represents a transfer function (written inside the block). Arrow 
entering the block is the “input” to the block. The arrow leaving the block is the 
“output” of the block, which is equal to the product: input × transfer function.
	
2.	Circle (summing junction): Two or more signals (inputs) may enter a summing 
junction and are represented by inward arrows. The single output of the summing 
junction (represented by an outward arrow) = sum of the incoming signals.
	
	 Note: A negative sign at the arrowhead of an incoming signal indicates subtracting 
(not adding) that signal. The default is addition. Hence, the corresponding “+” is 
not indicated at the summing junction.
	
3.	Two or more blocks in cascade = Single block having the product of individual 
transfer functions of the blocks.
	
4.	Two or more blocks in parallel = Single block having the sum of the individual 
transfer functions of the blocks.
8.3.1  Block-Diagram Manipulation and Reduction
In generating, manipulating, and simplifying block diagrams, the rules indicated in 
Table 8.1 are useful. All the entries except the last entry of the table should be clear from 
the list of statements given previously and may be verified by direct inspection.
An explanation is appropriate for the last entry of the table, where the equivalent single 
block for a feedback loop is given. This result may be obtained as follows:
The feedback signal at the summing junction = −Hx2.
Hence, the signal reaching the block G (i.e., output of the summing junction) is 
−
x
Hx
1
2.
Accordingly, the output of the block G is 
×
−
G
x
Hx
(
)
1
2  which must be equal to x2.
Hence, we have 
×
−
=
G
x
Hx
x
(
)
1
2
2 .
Straightforward algebra gives
	
=
+
x
G
GH x
1
2
1
	
(8.5)
The equivalence of the MIMO block diagram shown in Figure 8.2 and the state-space model 
given by relations 8.1 and 8.2 should be obvious. The corresponding transfer-­function 
matrix is given by Equation 8.4. Let us present a related scalar example.
Example 8.1
Consider the first-order (scaler) state-space model:
	
 =
+
x
Ax
Bu 	
(8.6)
	
=
+
y
Cx
Du
	
(8.7)

398
Modeling of Dynamic Systems with Engineering Applications
Its block diagram is given by the scalar version of Figure 8.2. We can apply the rules for 
block-diagram reduction (Table 8.1) to obtain the transfer function of this system.
First, the transfer function of the feedback loop is expressed as (see the last row of 
Table 8.1): 
	
−
=
−
s
A
s
s
A
1/
1
/
1
Combine this with the cascaded blocks B and C to give (see row 2 of Table 8.1): 
−
CB
s
A
.
Combine this with the parallel block D to give (see row 3 of Table 8.1): 
−
+
CB
s
A
D
.
Hence, the system transfer function is given by
	
=
=
−
+
Y s
U s
G s
CB
s
A
D
( )
( )
( )
(
)
	
(8.8)
This is the scalar version of the vector-matrix equation (8.4).
TABLE 8.1
Basic Relations for Block-Diagram Reduction
Description
Equivalent Representation
Summing junction
x1
x2
x3
x3 = x1 + x2
Blocks in cascade (series)
x1
x2
G1
G2
x1
x2
G1
G2
Blocks in parallel
x1
x2
G1
G2
x1
x2
G1 + G2
Shifting signal pickoff point
x1
x2
G
x2
x1
x2
G
x1= x2/ G
Shifting signal application point
x1
x2
G
x3
x1
x2/G
x3
G
Reduction of feedback loop
x1
x2
G
H
–
1+GH
G
x2
x1

399
Simulation Block Diagrams
LEARNING OBJECTIVES
	
1.	 Representation of a state-space model by a detailed block diagram
	
2.	 Manipulation of a block diagram using the standard rules
	
3.	 Determination of the overall transfer function of a system through block-­
diagram manipulation
■
8.4  Simulation Block Diagrams
In computer simulation of a dynamic system, the key operation is the integration (numeri-
cal integration). There are software packages that primarily rely on the accuracy and effi-
ciency of numerical integration in carrying out dynamic simulations. In fact, there are 
software toolboxes that represent a dynamic system as a block diagram containing “inte-
grator blocks,” “coefficient blocks,” and “summing junctions,” and then perform computer 
simulation by carrying out the necessary integrations. Such block diagrams are termed 
simulation block diagrams.
In a simulation block diagram, each block contains either an integrator (1/s) or a con-
stant gain (coefficient) term. Historically, simulation block diagrams were used to program 
(patch) an analog computer, where hardware modules of summing amplifiers and integra-
tors (along with other units such as potentiometers and resistors) were interconnected to 
simulate dynamic systems. That was the approach of analog hardware simulation. This 
approach evolved as “analog computer simulation.” Today, simulation block diagrams are 
widely used in digital computer simulation of dynamic systems, for example, using soft-
ware tools such as Simulink®.
In summary, a simulation block diagram consists only of the following:
•	 Integration blocks
•	 Constant gain blocks
•	 Summing junctions
They are
•	 Useful in computer simulation of dynamic systems.
•	 Obtained from I–O models or state-space models.
•	 Useful in the formulation of state-space models.
•	 Not unique.
8.4.1  Principle of Superposition
As noted previously (see Chapter 4 for example), the principle of superposition is satisfied by 
any linear system. In particular, for a dynamic system with zero initial conditions, if x is 
the response of the system to an input u, then d x
dt
r
r  is the response to the input d u
dt
r
r  (due 
to its linearity). Consequently, by the principle of superposition, α
α
+
d x
dt
d x
dt
p
p
r
r
1
2
 is the 

400
Modeling of Dynamic Systems with Engineering Applications
response to the input α
α
+
d u
dt
d u
dt
p
p
r
r
1
2
 for any arbitrary coefficients α
α
and
1
2 and any 
arbitrary derivative orders p and r. This form of the principle of superposition is quite use-
ful in the analytical manipulation of block diagrams.
In the synthesis of a state-space model from a simulation block diagram, we use the fol-
lowing facts:
	
1.	State variables = Outputs of the integrators
	
2.	State equations = Equations for the signals going into the integration blocks
	
3.	Algebraic output equation = Equation for the summing junction that generates the 
output (far-right summing junction)
In the methods discussed next, we use the following steps to develop a state-space model 
from an I–O model via simulation block diagrams:
	
1.	Sketch the simulation block diagram of a specific type to represent the given I–O 
differential equation or transfer function.
	
2.	Using the outputs of the integrators (in the simulation diagram) as the state vari-
ables, write the equations for the input side of each integrator (i.e., for the deriva-
tive of the corresponding state variable). These give the state equations.
	
3.	Write the equation for the summing junction at the far right (output end) of the 
simulation diagram. This gives the algebraic output equation.
Consider the general, linear I–O model given by
	


+
+
+
=
+
+
+
−
−
−
a d y
dt
a
d
y
dt
a y
b u
b du
dt
b d u
dt
n
n
n
n
n
n
m
m
m
1
1
1
0
0
1
	
(8.9)
where u is the input, y is the output, and a
b
and
i
j  are system coefficients (param-
eters), which are constants (a time-invariant system). Its auxiliary model (or parent model) 
is given by
	

+
+
+
=
−
−
−
a d x
dt
a
d
x
dt
a x
u
n
n
n
n
n
n
1
1
1
0
	
(8.10)
We will use these models in the following discussions. As a special case, we will use the 
following I–O differential equation model to illustrate the generation and use of different 
forms of simulation block diagrams:
	
+
+
+
=
+
+
+
d y
dt
d y
dt
dy
dt
y
d u
dt
d u
dt
du
dt
u
13
56
80
6
11
6
3
3
2
2
3
3
2
2
	
(8.11)
Specifically, we will illustrate several methods of obtaining the state-space models through 
simulation block diagrams.

401
Simulation Block Diagrams
8.4.2  Superposition Method
Consider the I–O model given by Equation 8.9. Consider its parent model as given by 
Equation 8.10. For the parent model:
	
1.	When u is the input, x is the output.
	
2.	If the input is the “linear” combination 

+
+
+
b u
b du
dt
b d u
dt
m
m
m
0
1
, then by 
the  principle of superposition, the output will be 

+
+
+
b x
b dx
dt
b d x
dt
m
m
m
0
1
.
	
3.	According to Equations 8.9 and 8.10, the output in step 2 is also y; hence,
	

=
+
+
+
y
b x
b dx
dt
b d x
dt
m
m
m
0
1
	
(8.12)
In the superposition method, we can first construct the simulation block diagram for the 
parent model (Equation 8.10). Then, we construct the output segment of the simulation 
block diagram for the original model (Equation 8.9) by using Equation 8.12.
Example 8.2
Consider the time-domain I–O model given by Equation 8.11:
	






+
+
+
=
+
+
+
y
y
y
y
u
u
u
u
13
56
80
6
11
6
	
(i)
The principle of superposition is applicable to it. Consider the parent model (auxiliary 
model):
	



+
+
+
=
x
x
x
x
u
13
56
80
	
(ii)
The simulation diagram for the parent model (Equation ii) is shown in Figure 8.3. The 
steps of obtaining this diagram are as follows:
	
1.	 Start with the highest-order derivative of the response variable (i.e., x ).
	
2.	 Successively integrate it until the variable itself (x) is obtained. For this example, 
we need to perform three integrations (resulting in three integrator blocks).
	
3.	 Feed the resulting different order derivatives of x, with appropriate multipliers 
(coefficients), to the summing junction on the input side (which also receives 
the input u) to produce the highest-order derivative of the response variable 
that we started with (i.e., x , in the present example) such that the parent-
model differential equation (Equation ii in the present example) is satisfied.
By the principle of superposition, it follows from Equations i and ii that
	



=
+
+
+
y
x
x
x
x
6
11
6 	
(iii)
Hence, the simulation diagram for the original model (Equation i) can be derived from 
Figure 8.3, as shown in Figure 8.4.

402
Modeling of Dynamic Systems with Engineering Applications
In particular, note the resulting feedforward paths.
The corresponding state model employs x and its derivatives as the state variables:
	
 

= 

x
x
x
x x x
T
T
1
2
3
As indicated previously, the state variables are the outputs of the integrators (see 
Figure 8.4). Also, a state equation is written by expressing how the signal that goes into 
the corresponding integration block (i.e., the first derivative of the corresponding state 
variable) is formed. Specifically, from Figure 8.4, we have
u
13
56
80
1
s
1
s
x
1
s
y
6
x1
x2
x3
6
11
–
x
x
x
FIGURE 8.4
Simulation diagram obtained by the superposition method.
u
13
56
80
1
s
1
s
x
x
x
x
1
s
–
FIGURE 8.3
Simulation diagram of the parent (auxiliary) model 


+
+
+
=
x
x
x
x
u
13
56
80
.

403
Simulation Block Diagrams
	



=
=
= −
−
−
+
x
x
x
x
x
x
x
x
u
80
56
13
1
2
2
3
3
1
2
3
	
(iv)
As indicated previously, the algebraic output equation is obtained by writing the signal 
summation equation for the summing junction in the output segment of the block dia-
gram (far right), which generates y. Specifically, from Figure 8.4, we have
	
=
+
+
+ −
−
−
+
y
x
x
x
x
x
x
u
6
11
6
( 80
56
13
)
1
2
3
1
2
3
or
	
= −
−
−
+
y
x
x
x
u
74
45
7
1
2
3
	
(v)
The corresponding state-model matrices are
	
[ ]
=
−
−
−










=










=
−
−
−


=
A
B
C
D
0
1
0
0
0
1
80
56
13
;
0
0
1
;
74
45
7
;
1
 
The system matrix pair (A, B) is said to be in the companion form in this state model. Note 
that the model is third order. Hence, the simulation diagram needs three integrators, 
and the system matrix A is 3 × 3.
Note further that the “parent” (or auxiliary) transfer function (that of Equation ii) is 
given by
	
=
+
+
+
X
U
s
s
s
1
13
56
80
3
2
From Equation iii, the output of the original system is given by
	
=
+
+
+
=
+
+
+
Y
s X
s X
sX
X
s
s
s
X
6
11
6
(
6
11
6)
3
2
3
2
Hence, the transfer function of the original system is
	
=
=
+
+
+
+
+
+
G s
Y
U
s
s
s
s
s
s
( )
6
11
6
13
56
80
3
2
3
2
Clearly, this result agrees with the original differential equation model (Equation i). 
Furthermore, in G(s), since the numerator polynomial is of the same order (third order) 
as the denominator polynomial (characteristic polynomial), a nonzero feedforward 
gain matrix D is generated in the state model.
Note: The last row of the system matrix A (in the companion form) has the coefficients 
of the characteristic polynomial.

404
Modeling of Dynamic Systems with Engineering Applications
LEARNING OBJECTIVES
	
1.	 The parent model (auxiliary model) of an I–O model
	
2.	 Construction of a model using its parent model (by the principle of superposition)
	
3.	 Construction of a simulation block diagram of a system by the superposition 
method
	
4.	 Formulation of a state-space model (in the companion form) using the simula-
tion block diagram (state variables are the “integrator outputs”)
■
8.4.3  Grouping Like-Derivatives Method
In this method, we proceed as follows:
	
1.	Consider the limiting system (m = n):
	


+
+
+
=
+
+
+
−
−
−
d y
dt
a
d
y
dt
a y
b u
b du
dt
b d u
dt
n
n
n
n
n
n
n
n
1
1
1
0
0
1
	
(8.13)
Keep the highest derivative term of the output y on the left-hand side (LHS) in the I–O 
model and move all the remaining terms to the right-hand side (RHS).
	
2.	Group the terms on the RHS so that like derivatives (those of the same order) are 
kept together:
	
 (
)
=
+
−



+
+
−
−
−
−
−
−
−
d y
dt
b d u
dt
b
d
u
dt
a
d
y
dt
b u
a y
n
n
n
n
n
n
n
n
n
n
n
1
1
1
1
1
1
0
0
	
(8.14)
	
3.	Integrate Equation 8.14 n times (n = system order = order of the LHS term) so that 
the LHS term is y:
	

…
∫
∫
∫
τ
τ
τ
{
}
=
+
−
+
+
−
+
−
′




′′
−
−
y
b u
b
u
a
y
b u
a y
b u
a y d
d
d
(
)
n
n
n
1
1
1
1
0
0
	
(8.15)
Note: When integrating the RHS n times, integrate the lowest-order term once, add the 
next-higher order term (which will not have derivatives, because it has been integrated 
as well), integrate the sum once, and so on. In this manner, the integration proceeds from 
the grouped lowest-order term (innermost term) to the grouped highest-order term (outer-
most term), as shown in Equation 8.15.
	
4.	Start the construction of the simulation diagram from the innermost term 
−
b u
a y
(
)
0
0
 
and proceed to the outermost term using integration blocks successively.
	
5.	The output y is the end product of the final integration. Note: An input term 
	
	 ( b u
n ) has to be added after the final integration, if it is a feedforward system 
(m = n).

405
Simulation Block Diagrams
The state-space model is formulated using the simulation diagram in the usual man-
ner: (1) Integrator outputs are the state variables, and (2) state equations are formed by the 
inputs to the integrators. In this method, the first column of the system matrix A has the 
coefficients of the characteristic polynomial. This is the “dual” of the companion form (as 
generated by the superposition method).
Example 8.3
Consider the same I–O model (Equation 8.11), as in Example 8.2. By grouping the deriva-
tives of the same order, it is written in the following form:
	






=
+
−
+
−
+
−
y
u
u
y
u
y
u
y
(6
13 )
(11
56 )
(6
80 )
By successively integrating this equation three times, we obtain
	
∫
∫
∫
τ
τ
τ
{
}
=
+
−
+
−
+
−
′




′′
y
u
u
y
u
y
u
y d
d
d
6
13
11
56
(6
80 )
	
(ia)
Note the three integrations on the RHS of this equation. Now, draw the simulation dia-
gram as follows:
	
1.	 Assume that y is available. Form the integrand of the innermost integration 
in Equation ia by feeding forward the necessary u term (6u) and feeding back 
the necessary y term (80y). This will form the starting (leftmost) signal in the 
simulation diagram.
	
2.	 Perform the innermost integration using an integration block. The result will 
form a part of the integrand for the next integration.
	
3.	 Complete the integrand by feeding forward the necessary u term (11u) and 
feeding back the necessary y term (56y) to it.
	
4.	 Perform this second integration. The result will form a part of the integrand for 
the next (outermost) integration.
	
5.	 Proceed as above to complete the integrand and perform the next integration 
(the outermost integration, which is the last integration).
	
6.	 After all the integrations are performed, feed forward the necessary u term 
(which is 1 × u in the present feedforward system, with m = n = 3) to generate y, 
which was assumed to be known in the beginning.
The resulting simulation block diagram is shown in Figure 8.5.
Note: The “innermost” integration in Equation ia forms the “outermost” feedback 
loop in the block diagram.
As in the previous examples, the state variables are defined as the outputs of the 
integrators. The state equations are written by considering the signals that enter each 
integration block, to form the first derivative of the corresponding state variable. In this 
manner, we obtain
	



=
+
−
+
= −
+
−
=
+
−
+
= −
+
−
=
−
+
= −
−
x
u
x
x
u
x
x
u
x
u
x
x
u
x
x
u
x
u
x
u
x
u
6
13(
)
13
7
11
56(
)
56
45
6
80(
)
80
74
1
2
1
1
2
2
3
1
1
3
3
1
1
	
(iva)

406
Modeling of Dynamic Systems with Engineering Applications
The algebraic output equation is written by writing the equation for the output sum-
ming junction (far right), which generates y. We obtain
	
=
+
y
x
u
1
	
(va)
This corresponds to the state-space model with the following matrices:
	
[ ]
=
−
−
−










=
−
−
−










= 

=
A
B
C
D
13
1
0
56
0
1
80
0
0
;
7
45
74
;
1
0
0
;
1
This state model is the dual of the state model (companion form) obtained in Example 8.2.
LEARNING OBJECTIVES
	
1.	 Grouping of the like terms of input and output, and successive integration of 
the I–O model
	
2.	 Successive integration from the lowest-order term (innermost) to the highest-
order term (outermost)
	
3.	 Construction of a simulation block diagram of a system by the “grouping of 
like terms” method
	
4.	 Formulation of a state-space model by the grouping of like terms (dual of com-
panion form) using the simulation block diagram (state variables are the “inte-
grator outputs”)
■
8.4.4  Factored Transfer-Function Method
We can directly write the transfer function from the I–O differential equation (a time deriv-
ative corresponds to s). Often, it is the transfer function that is given to us as the I–O model. 
If the numerator polynomial and the denominator polynomial (characteristic polynomial) 
u
13
56
80
1
s
x2
x3
y
6
x1
x2
x3
6
11
1
s
1
s
x1
–
–
–
FIGURE 8.5
Simulation diagram obtained by grouping like-derivatives.

407
Simulation Block Diagrams
of the transfer function can be easily factorized (or are already given in the factored form), 
the present method is particularly appropriate.
Note: The factors in the denominator (characteristic polynomial) correspond to the poles 
(i.e., eigenvalues) of the system. As a result, the system matrix A of the state-space model 
that is obtained from the simulation diagram in the present method will be upper triangu-
lar (i.e., all the elements below the main diagonal are zero). Then, the diagonal elements of 
A are indeed the eigenvalues of the system.
First, consider one numerator factor and one denominator factor of the original transfer 
function as the sub-transfer function:
	
=
+
+
G s
s
b
s
a
( )
(
)
(
)
1
	
(8.16)
Since the block diagram of the sub-transfer function 
+
s
a
1
(
)  is given by Figure 8.6a, 
it follows from the superposition method that the block diagram of 
+
+
s
b
s
a
(
)
(
) is shown in
 Figure 8.6b. This is one form of simulation diagram for the basic block-diagram module 
+
+
s
b
s
a
(
)
(
)  that is used in the present method.
An alternative form of block diagram for this basic transfer-function module is obtained 
by noting the equivalence shown in Figure 8.7a. In other words, when it is needed to sup-
ply the derivative signal u  at the input to an integrator, instead, the signal u itself can be 
a
1
s
u
x
−
a
1
s
x
−
b
x
(a)
(b)
y
FIGURE 8.6
Simulation diagrams of (a) 1/(s + a) and (b) (s + b)/(s + a).
1
s
u
=
1
s
u
(a)
(b)
1
s
u
a
b
–
u
y
FIGURE 8.7
(a) Two equivalent ways of providing the derivative of input ( u ) and (b) an equivalent simulation diagram for 
(s + b)/(s + a).

408
Modeling of Dynamic Systems with Engineering Applications
supplied at the output of the integrator. Now, note that the first-order transfer–function 
unit 
+
+
s
b
s
a
(
)
(
) has the terms  +
u
bu on the input side in the time-domain model. The term
bu is generated by cascading a block with simple gain b, as in Figure 8.7b. To provide u, 
instead of using the dotted input path in Figure 8.7b, which requires differentiation of the 
input signal, the signal u itself is applied at the output of the integrator. It follows that the 
block diagram in Figure 8.6b is equivalent to that in Figure 8.7b.
Then, the overall simulation diagram can be generated by cascading the appropriate 
number of simulation diagrams for all the transfer-function modules (of the form 
+
+
s
b
s
a
(
)
(
)
) in the original transfer function.
Example 8.4
Again, consider the I–O model given by Equation i. We have seen that its transfer 
­function is
	
=
+
+
+
+
+
+
G s
s
s
s
s
s
s
( )
6
11
6
13
56
80
3
2
3
2
This can be factorized into the form:
	
=
+
+
×
+
+
×
+
+
G s
s
s
s
s
s
s
( )
(
1)
(
4)
(
2)
(
4)
(
3)
(
5) 	
(ib)
Note that there are two common factors in the characteristic polynomial (denomi-
nator). Hence, there are “repeated poles” or “repeated eigenvalues” in this system 
(pole −4 is repeated). This has no special implications in the present method. Two 
versions of block diagram for this transfer function in the present method are shown 
in Figures 8.8 and 8.9. Here, we have used the fact that the product of two transfer 
functions corresponds to cascading the corresponding simulation block-diagram 
modules. As before, the state variables are chosen as the outputs of the integrators, 
and the state equations are written for the input terms of the integrator blocks. The 
output equation comes from the summing junction at the far right, which generates 
the output.
From Figure 8.8, the state equations are obtained as
u – 4x3
1
s
4
1
s
4
x3
x3
2
x2
−
–
−
1
s
3
5
x1
x1
x2
u
y
FIGURE 8.8
Simulation block diagram obtained by factorizing the transfer function.

409
Simulation Block Diagrams
	



=
−
=
−
+
−
= −
−
+
=
−
+ −
−
+
= −
−
−
+
x
u
x
x
x
x
u
x
x
x
u
x
x
x
x
x
u
x
x
x
u
4
4
(
4
)
4
3
2
5
( 4
3
)
5
2
3
3
3
2
3
2
3
2
3
1
2
1
2
3
1
2
3
	
(ivb)
The algebraic output equation is
	
=
+ −
−
−
+
= −
−
−
+
y
x
x
x
x
u
x
x
x
u
3
( 5
2
3
)
2
2
3
1
1
2
3
1
2
3
	
(vb)
These equations correspond to the state model with the following matrices:
	
[ ]
=
−
−
−
−
−
−










=










=
−
−
−


=
A
B
C
D
5
2
3
0
4
3
0
0
4
;
1
1
1
;
2
2
3
;
1
The state equations corresponding to Figure 8.9 are
	



= −
+
+
= −
−
= −
+
+
+
+
= −
−
−
= −
+
+
+
+
+
+
= −
−
−
−
x
x
u
u
x
u
x
x
x
u
x
u
x
x
u
x
x
x
x
u
x
x
u
x
x
x
u
4(
)
4
3
4(
)
2(
)
4
2
2
5(
)
3(
)
5
2
3
2
3
3
3
2
2
3
3
2
3
1
1
2
3
2
3
1
2
3
	
(ivc)
The algebraic output equation is
	
=
+
+
+
y
x
x
x
u
1
2
3
	
(vc)
These equations correspond to the state model with the following matrices:
1
s
4
1
s
4
2
3
1
s
5
x3
x3
x2
x1
x2
x1
−
−
−
u
x3 + u
x2 + x3 + u
x1 + x2 + x3 + u
y
FIGURE 8.9
An alternative simulation diagram obtained by factorizing the transfer function.

410
Modeling of Dynamic Systems with Engineering Applications
	
=
−
−
−
−
−
−










=
−
−
−










= 

=
A
B
C
D
5
2
2
0
4
2
0
0
4
;
2
2
3
;
1
1
1
;
1
Both system matrices are upper triangular (i.e., all the elements below the main diago-
nal are zero), and the main diagonal consists of the poles (eigenvalues) of the system. 
These are the roots of the characteristic equation. Note the duality in these two state 
models (Equations ivb and ivc).
Note: If we group the original transfer function into different factor modules, we get 
different state models. In particular, the state equations will be interchanged.
LEARNING OBJECTIVES
	
1.	 Simulation diagram of a first-order transfer function with one zero and one 
pole
	
2.	 If the system transfer function is available in the factorized form, cascading the 
first-order modules to construct the overall simulation diagram
	
3.	 Simulation diagram construction for a factorized transfer function
	
4.	 Formulation of a state-space model (with upper triangular system matrix A) 
using the simulation diagram with factorized segments (state variables are the 
“integrator outputs”)
■
8.4.5  Partial-Fraction Method
In the partial-fraction method, the transfer function is first expressed as the sum of the 
corresponding partial fractions (see Appendix D). Each partial fraction will generate a 
familiar simple simulation diagram segment. Since the partial fractions are added (rather 
than multiplied) to form the original transfer function, in the simulation diagram, the cor-
responding simulation modules are placed in parallel:
Note: For a high-order factor that represents repeated poles (e.g., a “square” in the case 
of two repeated poles), the first-order simulation diagram module is simply repeated in 
cascade.
Example 8.5
The partial fractions of the transfer function of the model (Equation 8.11) considered in 
the previous examples can be expressed in the partial-fraction form:
	
=
+
+
+
+
+
+
=
−
+
−
+
−
+
G s
s
s
s
s
s
s
a
s
b
s
c
s
( )
6
11
6
13
56
80
1
(
4)
(
4)
(
5)
3
2
3
2
2
By equating the like terms on the two sides of this identity, or by using the fact that
	
= −
+
= −
+
= −
+




=−
=−
=−
c
s
G s
b
s
G s
a
d
ds s
G s
(
5) ( )
(
4)
( )
(
4)
( )
s
s
s
5
2
4
2
4

411
Simulation Block Diagrams
we can determine the unknown coefficients as a = −17, b = 6, and c = 24.
The simulation block diagram corresponding to the partial-fraction representation of 
the transfer function is shown in Figure 8.10. We have used the fact that the sum of two 
transfer functions corresponds to combining their block diagrams in parallel. Again, 
the state variables are chosen as the outputs of the integrators. By following the same 
procedure as before, the corresponding state equations are obtained as
	



= −
+
= −
+
= −
+
x
x
u
x
x
x
x
x
u
5
4
4
1
1
2
2
3
3
3
The algebraic output equation is
	
= −
−
−
+
y
cx
bx
ax
u
1
2
3
These equations correspond to the state model with the following matrices:
	
=
−
−
−










=










=
−
−
−


=
A
B
C
D
c
b
a
5
0
0
0
4
0
0
0
4
;
1
0
1
;
;
1
In the present example, the system matrix is said to be in the Jordan canonical form. If the 
eigenvalues are distinct (unequal), the matrix A, when expressed in the Jordan form, will 
be diagonal, and the diagonal elements will be the eigenvalues. When repeated eigenval-
ues are present, as in the present example, the matrix A may consist of diagonal blocks (or 
Jordan blocks) consisting of upper triangular submatrices with the repeated eigenvalues 
lying on the main diagonal, elements of unity at locations immediately above the main 
diagonal, and zero elements elsewhere. More than one Jordan block can exist for the same 
repeated eigenvalue. These considerations are beyond the scope of the present treatment.
Note: There are no Jordan blocks in the present A, which is simply diagonal.
1
s
1
s
−b
−a
−c
y
u
4
4
1
s
5
x3
x2
x1
_
_
_
x3
x1
x2
FIGURE 8.10
Simulation block diagram obtained by the partial-fraction method.

412
Modeling of Dynamic Systems with Engineering Applications
LEARNING OBJECTIVES
	
1.	 If the system transfer function is available as a sum of partial fractions, place 
the corresponding simulation diagram segments in parallel to construct the 
overall simulation diagram
	
2.	 The square of a term corresponds to cascading two identical simulation dia-
gram segments corresponding to the squared term
	
3.	 Determination of the coefficients of partial fractions
	
4.	 Simulation diagram construction for a transfer function expressed in partial fractions
	
5.	 Formulation of a state-space model with repeated roots (the system matrix A 
may be in the Jordan canonical form with Jordan blocks)
■
Example 8.6
A manufacturer of rubber parts uses a conventional process of steam-cured molding 
of latex. The molded rubber parts are first cooled and buffed (polished), and then sent 
for inspection and packing. A simple version of a rubber buffing machine is shown in 
Figure 8.11a. It consists of a large hexagonal drum whose inside surfaces are all coated 
Three-phase
induction motor 
Flexible
coupling
Emery surfaced
hexagonal drum 
Self-aligning
bearing 
θm
Tm
Jm
bm
kL
θL
JL
Motor rotor
Drive
shaft 
Tr
Drum
TNL
(Buffing
dissipation) 
(a)
(b)
FIGURE 8.11
A rubber buffing machine. (a) Schematic diagram; (b) dynamic model.

413
Simulation Block Diagrams
with a layer of bonded emery. The drum is supported horizontally along its axis on two 
heavy-duty, self-aligning bearings at the two ends, and is rotated using a three-phase 
induction motor. The drive shaft of the drum is connected to the motor shaft through 
a flexible coupling in order to compensate for possible misalignments of the axes. The 
buffing process consists of filling the drum with rubber parts, steadily rotating the 
drum for a specified period of time (depending on the product and its quality), and 
finally vacuum cleaning the drum and its contents. Dynamics of the machine affects the 
mechanical loading on various parts of the system such as the motor, coupling, bear-
ings, shafts, and the support structure.
In order to study the dynamic behavior, particularly at the startup stage and under 
disturbances during steady-state operation, an engineer develops a simplified model of 
the buffing machine. This model is shown in Figure 8.11b. The motor is modeled as a 
torque source Tm, which is applied on the rotor having moment of inertia Jm and resisted 
by a viscous damper of damping constant bm. The connecting shafts and the coupling 
unit are represented by a torsional spring of stiffness kL. The drum and its contents are 
represented by an equivalent constant moment of inertia JL. There is a resisting torque 
on the drum, even at steady operating speed, due to the eccentricity of the contents of 
the drum. This is represented by a constant torque Tr. Furthermore, energy dissipation 
due to the buffing action (between the rubber parts and the emery surfaces of the drum) 
is represented by a nonlinear damping torque TNL, which may be approximated by
	


θ θ
=
>
T
c
c
with
0
NL
L
L
Note: θm  and θL  are the angles of rotation of the motor rotor and the drum, respec-
tively, and these are measured from inertial reference lines, which correspond to a 
relaxed configuration of spring kL.
	 (a)	 Comment on the assumptions made in the modeling process of this system 
and briefly discuss the validity (or accuracy) of the model.
	 (b)	 Show that the model equations are
	





θ
θ
θ
θ
θ
θ
θ
θ θ
=
−
−
−
=
−
−
−
J
T
k
b
J
k
c
T
(
)
(
)
m
m
m
L
m
L
m
m
L
L
L
m
L
L
L
r
What are the inputs of this system?
	 (c)	 Using the speeds θm  and θL  and the spring torque Tk as the state variables, 
and the twist of the spring as the output, obtain a complete state-space model 
for this nonlinear system.
What is the order of the state model?
	 (d)	 Suppose that under steady operating conditions, the motor torque is Tm, which 
is constant. Determine an expression for the constant speed ω  of the drum in 
terms of Tm, Tr, and appropriate system parameters under these conditions. 
Show that, as intuitively clear, we must have 
>
T
T
m
r for this steady operation 
to be feasible. Also, obtain an expression for the spring twist at steady state, in 
terms of ω, Tr, and the system parameters.
	 (e)	 Linearize the system equations under the steady operation condition and 
express the two equations in terms of the following “incremental” variables 
(see Chapter 4):
	
	
q1 = variation of θm about the steady value
	
	
q2 = variation of θL about the steady value
	
	
u = disturbance increment of Tm from the steady value Tm

414
Modeling of Dynamic Systems with Engineering Applications
	 (f)	 For the linearized system, obtain the I–O model (differential equation), first 
considering q1 as the output and next considering q2 as the output. Comment 
about and justify the nature of the homogeneous (characteristic-equation) 
parts of the two equations. Discuss, by examining the physical nature of the 
system, why only the derivatives of q1 and q2 and not the variables themselves 
are present in these I–O equations.
	
Explain why the derivation of the I–O differential equations would become 
considerably more difficult if a damper is present between the two inertia ele-
ments Jm and JL.
	 (g)	 Consider the I–O differential equation for ql. By introducing an auxiliary vari-
able, draw a simulation block diagram for this system. (Use integrators, sum-
mers, and coefficient blocks only.) Show how this block diagram can be easily 
modified to represent the following cases:
	
(i)	
q2 is the output.
	
(ii)	
q1  is the output.
	
(iii)	
q2 is the output.
	
	 What is the order of the system (or the number of free integrators needed) in 
each of the four cases of the output considered in this example?
	 (h)	 Considering the spring twist (q1 − q2) as the output, draw a simulation block 
diagram for the system. What is the order of the system in this case?
	
	 Hint: For this purpose, you may use the two linearized second-order differen-
tial equations obtained in part (e).
	
(i)	 Comment on why the “system order” is not the same for the five cases of the 
output considered in parts (g) and (h).
Solution
	 (a)	 The assumptions are satisfactory for a preliminary model, particularly because 
very accurate control is not required in this application (industrial process). 
Some sources of error and concern are as follows:
	
(i)	
Since the rubber parts move inside the drum, JL is not constant and the 
inertia contribution does not represent a rigid system.
	
(ii)	
Inertia of the shafts and coupling is either neglected or lumped with Jm 
and JL.
	
(iii)	
Coulomb and other nonlinear types of damping in the motor and the bear-
ings have been approximated by viscous damping.
	
(iv)	
The torque source model (Tm) is only an approximation to a real induction 
motor.
	
(v)	
The resisting torque of the rubber parts (Tr) is not constant during rotation.
	
(vi)	
Energy dissipation due to relative movements between the rubber parts 
and the inside surfaces of the drum may take a different form from what is 
given (a quadratic damping model).
	 (b)	 For Jm, Newton’s second law gives (see Figure 8.12a)
	

θ
θ
=
−
−
J
d
dt
T
b
T
m
m
m
m
m
k
2
2
	
(i)
For spring kL, Hooke’s law gives (see Figure 8.12b)
	
θ
θ
=
T
k (
–
)
k
L
m
L 	
(ii)

415
Simulation Block Diagrams
For JL, Newton’s second law gives (see Figure 8.12c)
	
θ
=
−
−
J d
dt
T
T
T
L
L
k
NL
r
2
2
	
(iii)
where
	


θ θ
=
T
c
NL
L
L 	
(iv)
	


θ
θ
θ
θ
=
−
−
−
J
T
b
k
Substitute Equation ii into Equation i :
(
)
m
m
m
m
m
L
m
L 	
(v)
 



θ
θ
θ
θ θ
=
−
−
−
J
k
c
T
Substitute Equations ii and iv into Equation iii :
(
)
L
L
L
m
L
L
L
r 	
(vi)
Clearly, Tm and Tr are the inputs to the system (see Equations v and vi).
	 (c)	 Let θ
ω
=
m
m  and θ
ω
=
L
L .
	
ω
ω
= −
−
+
d
dt
b
J
J
T
J
T
From Equation i :
1
1
m
m
m
m
m
k
m
m
	
ω
ω ω
= −
+
−
d
dt
c
J
J T
J T
From Equations iii and iv :
1
1
L
L
L
L
L
k
L
r
Jm
Tm 
Tk
bmθm
(a)
Tk
Tk
TNL
Tk
kL
(b)
JL
Tr 
(c)
θm
θm
θL
θL
FIGURE 8.12
(a) Motor inertia; (b) drive shaft; (c) drum inertia.

416
Modeling of Dynamic Systems with Engineering Applications
	
ω
ω
=
−
dT
dt
k
k
Differentiate Equation ii :
k
L
m
L
L
The preceding three equations are the state equations.
Output y = spring twist = θ
θ
−
m
L
Hence, from Equation ii, we have 
=
y
k T
1/
L
.
This is the output equation.
The system is third order (three state equations).
	 (d)	 Under steady conditions:
	ω
ω
ω
=
=
m
L
, 

ω
ω
=
=
0
m
L , 
=
T
T
m
m , and θ
θ
∆θ
−
=
m
L
; Tr remains a constant.
	
ω
∆θ
−
−
=
T
b
k
Then, from Equations v and vi :
0
m
m
L
	
(vii)
and
	
∆θ
ω
−
−
=
k
c
T
0
L
r
2
	
(viii)
Without loss of generality, ω  is assumed to be positive.
	Add Equations vii and viii to eliminate 
∆θ
kL
.
	We get 
ω
ω
−
−
−
=
T
b
c
T
0
m
m
r
2
, or ω
ω
+
−
−
=
c
b
T
T
(
)
0
m
m
r
2
.
Hence, ω = −
±



+
−
b
c
b
c
T
T
c
2
2
(
)
m
m
m
r
2
The proper solution is the positive one: ω =



+
−
−
b
c
T
T
c
b
c
2
(
)
2
m
m
r
m
2
For this to be positive, we must have 
>
T
T
m
r .
Next, from Equation viii, the steady-state twist of the spring is ∆θ
ω
=
−
c
T
k
(
)
r
L
2
.
	 (e)	 Taylor series expansion up to the first-order term gives the following:
For Equation v: 



ω
ω
∆θ
+
=
+
−
−
−
−
−
J
J q
T
u
b
b q
k
k q
q
(
)
m
m
m
m
m
L
L
1
1
1
2
For Equation vi: 



ω
∆θ
ω
ω
+
=
+
−
−
−
−
J
J q
k
k q
q
c
c q
T
(
)
2
L
L
L
L
r
2
1
2
2
2
The steady-state terms cancel out (also ω = 0). Hence, we have the following 
­linearized equations:
	


=
−
−
−
J q
u
b q
k q
q
(
)
m
m
L
1
1
1
2 	
(ix)
	


ω
=
−
−
J q
k q
q
c q
(
)
2
L
L
2
1
2
2 	
(x)
These two equations represent the linear model.
	 (f)	 From Equation ix: 


=
+
+
−




q
q
b
k q
J
k q
u
k
m
L
m
L
L
2
1
1
1

(xi)

417
Simulation Block Diagrams
	


ω
=
+
+




q
q
c
k
q
J
k q
From Equation x :
2
L
L
L
1
2
2
2
	
(xii)
Substitute Equation xi into Equation xii for q2 :
	










ω
=
+
+
−



+
+
+
−




+
+
+
−




q
q
b
k q
J
k q
u
k
c
k
q
b
k q
J
k q
u
k
J
k
q
b
k q
J
k
q
u
k
2
m
L
m
L
L
L
m
L
m
L
L
L
L
m
L
m
L
L
2
1
1
1
1
1
1
1
1
1
This gives
	
ω
ω
ω
ω
+
+




+
+
+




+
+




=
+
+
J J
k
d q
dt
b J
k
c
J
k
d q
dt
J
k
c b
k
J
k
d q
dt
c
k
b
k
dq
dt
k u
c
k
du
dt
J
k
d u
dt
2
2
2
1
2
m L
L
m L
L
m
L
m
L
m
L
L
L
L
m
L
L
L
L
L
2
4
1
4
2
2
3
1
3
2
2
1
2
1
2
2
2
2
	
(xiii)
Next, substitute Equation xii into Equation xi for q1. We obtain
	
ω
ω
ω
+
+




+
+
+




+
+




=
J J
k
d q
dt
b J
k
c
J
k
d q
dt
J
k
c b
k
J
k
d q
dt
c
k
b
k
dq
dt
k u
2
2
2
1
m L
L
m L
L
m
L
L
L
m
L
m
L
L
m
L
L
2
4
2
4
2
2
3
2
3
2
2
2
2
2
	
(xiv)
	
	 Observe that the LHSs (homogeneous or characteristic parts) of these two I–O 
differential equations are identical. The characteristic equation represents the 
“natural” dynamics of the system and should be common and independent 
of the input (u). Hence, the result is justified. Furthermore, derivatives of u are 
present only in the q1 equation. This is justified because motion q1 is closer 
than q2 to the input u. Also, only the derivatives of q1 and q2 are present in the 
two equations. This is a property of a mechanical system that is not anchored 
(by a spring) to ground. Here, the reference value for q1 or q2 could be chosen 
arbitrarily, regardless of the relaxed position of the intercomponent spring (kL) 
and should not depend on u either. Hence, the absolute displacements q1 and 
q2 themselves should not appear in the I–O equations, as clear from Equations 
xiii and xiv. Such systems are said to possess rigid body modes. Even though the 
differential equations are fourth order, they can be directly integrated once, 
and the system is actually third order (also see Example 4.3). The position itself 
can be defined by an arbitrary reference and should not be used as a state in 
order to avoid this ambiguity. However, if position (q1 or q2 and not the twist 
q1 − q2) is chosen as an output, the system has to be treated as fourth order. 
Compare this to the simple problem of a single mass subjected to an external 
force, and without any anchoring springs.
	
	
If there is a damper between Jm and JL, we cannot write simple expressions 
for q2 in terms of q1, and q1 in terms of q2, as in Equations xi and xii, respectively. 

418
Modeling of Dynamic Systems with Engineering Applications
Here, the derivative operator 
=
D
d
dt
/
 has to be introduced for the elimination 
process, and the solution of one variable by eliminating the other one becomes 
much more complicated.
	 (g)	 Use the auxiliary model (parent model):
	
+
+
+
=
a d x
dt
a d x
dt
a d x
dt
a dx
dt
u
4
4
4
3
3
3
2
2
2
1
where 
=
a
J J
k
m L
L
4
, 
ω
=
+




a
b J
k
c
J
k
2
m L
L
m
L
3
, 
ω
=
+
+




a
J
c b
k
J
2
m
m
L
L
2
, and
ω
=
+
a
b
c
2
m
1
.
It follows from Equation xiv that q2 = x, and from Equation xiii that 


=
+
+
q
x
b x
b x
1
1
2
where 
ω
=
b
c
k
2
L
1
, and 
=
b
J
k
L
L
2
.
Hence, we have the block diagram shown in Figure 8.13a for the relationship u → q1.
Note that four integrators are needed. Hence, this is a fourth-order system.
	
(i)	
In this case, the simulation block diagram is as shown in Figure 8.13b. This 
also needs four integrators (a fourth-order system).
	
(ii)	
In this case, the simulation block diagram is as shown in Figure 8.13c. This 
only needs three integrators (a third-order system).
	
(iii)	
By differentiating the expression for q1, we have 



=
+
+
q
x
b x
b x
1
1
2 . Hence, 
the block diagram in this case is as shown in Figure 8.13d. This needs three 
integrators (a third-order system).
	 (h)	 Using Equations ix and x, we get
	


=
−
−
−
J q
u
b q
k q
q
(
)
m
m
L
1
1
1
2
	


ω
=
−
−
J q
k q
q
c q
(
)
2
L
L
1
1
2
2
Accordingly, we can draw the block diagram shown in Figure 8.13e. There are three 
integrators in this case. The system is third order.
	
(i)	 When q1 and q2 are used as outputs, the system order increases to four. But, as 
discussed in part (f), q1 and q2 are not realistic state variables for the present 
problem.
LEARNING OBJECTIVES
	
1.	 Formulation of a nonlinear model
	
2.	 Linearization of a nonlinear model, about a steady operating point, using local 
slopes (first-order Taylor series approximation). (Also see Chapter 4.)
	
3.	 Sketch of the simulation block diagram using I–O differential equations
	
4.	 The concept of system order
	
5.	 The choice of system outputs
■

419
Simulation Block Diagrams
u
1
a4
x
a3 
a2 
a1 
b2 
b1 
b1 
q1
Subsystem S 
–
(a)
(b)
Subsystem
S
(Has one integrator)
x
x
x = q2
u
(c)
S
(Has one integrator)
x
x
x
x
u
x = q2
x
x
x
x
x
b2
b1 
S
(Needs one
integrator)
u
(d)
(e)
u
1
Jm
bm
q1
q1 – q2
q1 – q2
kL
q1
1
JL
2cω
q2
q2
–
–
–
q1
x
FIGURE 8.13
Simulation block diagram. (a) When q1 is the output; (b) when q2 is the output; (c) when q1 is the output; (d) when 
q2 is the output; (e) when the spring twist q1 − q2 is the output.

420
Modeling of Dynamic Systems with Engineering Applications
8.5  Causality and Physical Realizability
Consider a dynamic system that is represented by the single I–O differential equation 
model (8.9), with n > m. The physical realizability of the system should dictate the causality 
(cause–effect) of this system: u is the input and y is the output. Its transfer function G(s) is 
given by
	


∆
=
=
+
+
+
+
+
+
=
Y s
U s
G s
b
b s
b s
a
a s
a s
N s
s
( )
( )
( )
( )
( )
m
m
n
n
0
1
0
1
	
(8.17)
Here, n is the order of the system, Δ(s) is the characteristic polynomial (of order n), and N(s) is 
the numerator polynomial (of order m) of the system.
8.5.1  Proof of Causality and Physical Realizability
We can prove by contradiction the previous statement on the causality of the system. 
Suppose that m > n. Then, if we integrate Equation 8.9 n times, we will have y and its inte-
grals on the LHS, but the RHS will contain at least one derivative of u. Since the derivative 
of a step function is an impulse, this implies that a finite change in input will result in an 
infinite change in the output (response). Such a scenario will require infinite power and 
is not physically realizable. It follows that a physically realizable system cannot have a 
numerator order greater than the denominator order in its transfer ­function. If in fact m > 
n, then, what it means physically is that y should be the system input and u should be the 
system output. In other words, the causality should be reversed in this case.
For a physically realizable system, a simulation block diagram can be established using 
integrals (1/s) alone, without the need of derivatives (s). Note that pure derivatives are 
physically not realizable. If m > n, the simulation block diagram will need at least one 
derivative for linking u to y. That will not be physically realizable, again, because it would 
imply the possibility of producing an infinite response by a finite input. In other words, 
the simulation block diagram of a physical realizable system will not require feedforward 
paths containing pure derivatives.
Another fact has been observed before. If m = n, then we need a direct feedforward path 
from the input to the output. In other words, the output equation in the state-space model 
will have an input term. In such a system, the input is instantaneously felt at the output 
(without dynamic delay). Hence, such a feedforward system is a very fast system.
Summary Sheet
Equivalence or approximate equivalence: (1) distributed-parameter models and lumped-
parameter models; (2) nonlinear models and linear models; (3) time-domain models and 
transfer-function models; (4) detailed component-based models and reduced transfer-­
function models; and (5) complex-structure models and simple-structure models (Thevenin 
or Norton); and (6) simulation model structures

421
Simulation Block Diagrams
State-space model:  =
+
x
Ax
Bu ; y = Cx + Du
Transfer-function model: 
(
)
=
−
+


−
Y
C
I
A
B
D U
s
s
s
( )
(
)
( )
1
Transfer-function matrix: 
== (
)
−
+
−
G
C
I
A
B
D
s
s
( )
(
) 1
Block-diagram manipulation:
	
1.	Cascade (series) G1 and G2: G1G2
	
2.	Parallel G1 and G2: G1 + G2
	
3.	Pickoff x1 before G and x2 after G: x1 = x2/G
	
4.	Insert x1 before G and x2 after G: x1 = x2/G
	
5.	Combined transfer function of feedback loop: 
+
G
GH
/1
; G = forward TF, 
H = feedback TF
Simulation block diagrams:
	
1.	Superposition method: Parent model 

+
+
+
=
−
−
−
a d x dt
a
d
x dt
a x
u
/
/
n
n
n
n
n
n
1
1
1
0
; 
­original model
	
	


+
+
+
=
+
+
+
−
−
−
a d y dt
a
d
y dt
a y
b u
b du dt
b d u dt
/
/
/
/
n
n
n
n
n
n
m
m
m
1
1
1
0
0
1
→ input
	
	

+
+
+
b u
b du dt
b d u dt
/
/
m
m
m
0
1
 gives output 

=
+
+
+
y
b x
b dx dt
b d x dt
/
/
m
m
m
0
1
	
2.	Grouping like-derivatives method:
	
	


+
+
+
=
+
+
+
−
−
−
d y dt
a
d
y dt
a y
b u
b du dt
b d u dt
/
/
/
/
n
n
n
n
n
n
n
n
1
1
1
0
0
1
; arrange as
	
	
(
)
=
+
−
+
+
−
−
−
−
−
−
−
d y dt
b d u dt
b
d
u dt
a
d
y dt
b u
a y
/
/
/
/
...
(
)
n
n
n
n
n
n
n
n
n
n
n
1
1
1
1
1
1
0
0
; 
­integrate n times →

∫
∫
∫
τ
τ
τ
{
}
=
+
−
+
+
−
+
−
′




′′
−
−
y
b u
b
u
a
y
b u
a y
b u
a y d
d
d
(
)
...
n
n
n
1
1
1
1
0
0
	
3.	Factored transfer-function method: Group into factors 
+
+
s
b
s
a
(
)/(
)
i
i
; cascade 
the corresponding block diagrams.
	
4.	Partial-fraction method: Form the block diagram of each partial fraction; arrange 
them in parallel. Note: 
+
s
a
1/(
)2→ cascade the block diagram of 
+
s
a
1/(
) with 
itself.
Causality 
and 
physical 
realizability: 
Transfer 
function 


+
+
+
+
+
+
b
b s
b s
a
a s
a s
/
m
m
n
n
0
1
0
1
 must satisfy 
≤
m
n; otherwise, interchange the input 
and the output.

422
Modeling of Dynamic Systems with Engineering Applications
Problems
8.1
Consider the system given by the differential equation: 


+
+
=
+
y
y
y
u
u
4
3
2
	
(a)	
What is the order of the system?
	
(b)	
What is the system transfer function?
	
(c)	
Do we need Laplace tables to obtain the transfer function?
	
(d)	
What are the poles?
	
(e)	
What is the characteristic equation?
	
(f)	
Consider the parent system: 

+
+
=
x
x
x
u
4
3
	
	
Express y in terms of x, using the principle of superposition.
	
(g)	
Using 


= 

x
x
x
x
T
T
1
2
 as the state variables, obtain a state-space 
model for the given original system (not the parent system).
	
(h)	
Using the superposition approach, draw a simulation block diagram for the 
system.
	
(i)	
Express the system differential equation in a form suitable for drawing a simu-
lation diagram by the “grouping like-derivatives” method.
	
(j)	
From part (i), draw the simulation block diagram.
	
(k)	
Express the transfer function (s + 2)/(s + 3) in two forms of simulation block 
diagrams.
	
(l)	
Using one of the two forms obtained in part (k), draw the simulation block 
diagram for the original second-order system.
	
(m)	
What are the partial fractions of the original transfer function?
	
(n)	
Using the partial-fraction method, draw a simulation block diagram for the 
system. What is the corresponding state-space model?
	
(o)	
Obtain a state-space model for the system using part (j).
	
(p)	
Obtain at least one state model for the system using the block diagram obtained 
in part (l).
	
(q)	
What can you say about the diagonal elements of the system matrix A in parts 
(n) and (p)?
8.2
	
(a)	
List several characteristics of a physically realizable system. How would you 
recognize the physically realizability of a system by drawing a simulation 
block diagram, which uses integrators, summing junctions, and gain blocks?
	
(b)	
Consider the system given by the following I–O differential equation:
	





+
+
+
=
+
+
y
a y
a y
a y
b u
b u
b u
2
1
0
2
1
0

423
Simulation Block Diagrams
	where u is the input and y is the output.
Is this system physically realizable?
Draw a simulation block diagram for this system using integrators, gains, and sum-
ming junctions only.
8.3
Consider the control system shown in Figure P8.3.
The back e.m.f. 
ω
=
v
K
B
V
The motor torque 
=
T
K i
m
T
Draw a simulation block diagram for the system.
8.4
It is required to study the dynamics behavior of an automobile during the very brief 
period of a sudden start from rest. Specifically, the vehicle acceleration a in the 
direction of primary motion, as shown in Figure P8.4a, is of interest and should 
be considered as the system output. The equivalent force f(t) of the engine, applied 
in the direction of primary motion, is considered as the system input. A simple 
dynamic model that may be used for the study is shown in Figure P8.4b.
Note that k is the equivalent stiffness, primarily due to tire flexibility, and b is the equiv-
alent viscous damping constant, primarily due to dissipations at the tires and 
other moving parts of the vehicle, taken in the direction of a. Also, m is the mass 
of the vehicle.
	
(a)	
Discuss the advantages and limitations of the proposed model for the particu-
lar purpose.
(a)
(b)
dc motor
Kv, KT 
Power
amp. Ka 
Potentiometer
Kp
K
B
θ
J
vr
va
vm
−
Gear
ratio
r
Load
torque
Tl
vm
vb
ω = θ
i
R
L
FIGURE P8.3
(a) A rotatory electromechanical system and (b) the armature circuit.

424
Modeling of Dynamic Systems with Engineering Applications
	
(b)	
Using force fk of the spring (stiffness k) and velocity v of the vehicle as the state 
variables, engine force f(t) as the input, and the vehicle acceleration a as the 
output, develop a complete state-space model for the system.
	
	
(Note: You must derive the matrices A, B, C, and D for the model).
	
(c)	
Draw a simulation block diagram for the model, employing integration and 
gain blocks, and summing junctions only.
	
(d)	
Obtain the I–O differential equation of the system. From this, derive the trans-
fer function (a/f in the Laplace domain).
	
(e)	
Discuss the characteristics of this model by observing the nature of matrix D, 
feedforwardness of the block diagram, input and output orders of the I–O dif-
ferential equation, and the numerator and denominator orders of the system 
transfer function.
8.5
Consider a dynamic system, which is represented by the transfer function (output/input):
	
=
+
+
+
+
+ +
G s
s
s
s
s
s
s
( )
3
2
2
1
4
3
3
2
3
2
System output = y; system input = u.
	
(a)	
What is the I–O differential equation of the system?
What is the order of the system?
Is this system physically realizable?
	
(b)	
Based on the “superposition method,” draw a simulation block diagram for the 
system, using integrators, constant gain blocks, and summing junctions only.
Obtain a state-space model using this simulation block diagram, clearly giving 
the matrices A, B, C, and D.
	
(c)	
Based on the “grouping like-derivatives method,” draw a simulation block dia-
gram, which should be different from what was drawn in part (b), again using 
integrators, constant gain blocks, and summing junctions only.
(b)
k
fk
(a)
Acceleration a 
Speed v
Equivalent
resisting spring
Vehicle mass
m
Equivalent
engine force
f(t)
Equivalent
viscous damping
b
FIGURE P8.4
(a) Vehicle suddenly accelerating from rest and (b) a simplified model of the accelerating vehicle.

425
Simulation Block Diagrams
Give a state-space model for the system, now using this simulation block diagram. This 
state-space model should be different from that in part (b), which further illus-
trates that the state-space representation is not unique.
8.6
The electrical circuit shown in Figure P5.8 has two resistors R1 and R2, an inductor L, a 
capacitor C, and a voltage source u(t). The voltage across the capacitor is considered 
the output y of the circuit.
	
(a)	
What is the order of the system and why?
	
(b)	
Show that the I–O equation of the circuit is given by
	
+
+
=
+
a d y
dt
a dy
dt
a y
b du
dt
b u
2
2
2
1
0
1
0
Express the coefficients a0, a1, a2, b0, and b1 in terms of the circuit parameters R1, R2, L, 
and C.
	
(c)	
Starting with the auxiliary differential equation:
	


+
+
=
a x
a x
a x
u
2
1
0
	
	
and using 

= 

x
x
x
T as the state vector, obtain a complete state-space 
model for the system in Figure P8.6. Note that this is the “superposition 
method” of developing a state model.
	
(d)	
Clearly explain why, for the system in Figure P8.6, neither the current ic through 
the capacitor nor the time derivative of the output ( y ) can be chosen as a state 
variable.
8.7
Consider an nth order, linear, time-invariant dynamic system with input u(t) and output 
y. When a step input was applied to this system, it was observed that the output 
+
–
Voltage
source
u(t)
R1 
R2
L
C
ic
il
Voltage
output
y
FIGURE P8.6
An RLC circuit driven by a voltage source.

426
Modeling of Dynamic Systems with Engineering Applications
jumped instantaneously in the very beginning. Which of the following statements 
are true for this system?
	
(a)	
Any simulation block diagram of this system (consisting only of integrators, 
constant gain blocks, and summing junctions) will have at least one feedfor-
ward path.
	
(b)	
The D matrix does not vanish (i.e., D ≠ 0) in its state-space model:
	
 =
+
=
+
x
Ax
Bu
y
Cx
Du
	
(c)	
This is not a physically realizable system.
	
(d)	
The number of zeros in the system is equal to n.
	
(e)	
The number of poles in the system is equal to n.
In each case, briefly justify your answer.
8.8
In relation to a dynamic system, briefly explain your interpretation of the terms
	
(a)	
Causality
	
(b)	
Physical Realizability
Using integrator blocks, summing junctions, and coefficient blocks only, unless it is 
absolutely necessary to use other types if blocks, draw simulation block dia-
grams for the following three I–O differential equations:
	
(i)
	
+
=
a dy
dt
a y
u
1
0
	
(ii)
	
+
=
+
a dy
dt
a y
u
b du
dt
1
0
1
	
(iii)
	
+
=
+
+
a dy
dt
a y
u
b du
dt
b d u
dt
1
0
1
2
2
2
Note that u denotes the input and y denotes the output. Comment about causality and 
physical realizability of these three systems.

427
9
Response Analysis and Simulation
Chapter Highlights
•	 Uses of Response Analysis
•	 Analytical Solution of Response
•	 Homogenous Solution and Particular Solution
•	 Free Response and Forced Response
•	 Convolution Integral
•	 Stability
•	 Response of a First-Order System
•	 Response of a Second-Order System
•	 Natural Frequency and Damping Ratio
•	 Step, Impulse, and Harmonic Responses
•	 Considerations of Initial Conditions
•	 Response Using Laplace Transform Methods
•	 Computer Simulation
•	 Runge–Kutta Method
•	 Use of Simulink®
9.1   Introduction
In this book, we have studied several approaches for the formulation of analytical models 
of engineering dynamic systems. The types of considered systems included mechanical, 
electrical, fluid, and thermal systems, and also multidomain (or mixed) systems, which 
incorporate two or more physical domains (e.g., electro-mechanical systems). An analyti-
cal model, which is a set of differential equations (or transfer functions), has many uses in 
various applications, including analysis, design, control, testing, performance evaluation, 
validation, and qualification of systems.
Practically any application of a dynamic model requires a knowledge of the response 
(output) of the system to a specified input (excitation). Of course, once a model is formu-
lated, its response to a particular excitation can be determined (at least for relatively simple 

428
Modeling of Dynamic Systems with Engineering Applications
analytical inputs) by direct analysis (i.e., a solution of the associated differential equations; 
or by using transfer functions if the input is represented in the frequency domain). For 
large-scale and complex systems, and for complex inputs, a purely analytical study may not 
be feasible. Then, one may have to resort to numerical approaches and computer simulation.
An analytical model can provide information regarding how the system responds when 
excited by an initial condition (IC) (i.e., free, natural response) or when a specific excita-
tion (input) is applied (i.e., forced response). In this chapter, we address the following two 
approaches of response analysis:
•	 Solution of the differential equations (analytical)
•	 Computer simulation (numerical)
Some advanced topics of response analysis are presented in Appendix G.
9.2   Analytical Solution
The response of a dynamic system may be obtained analytically by solving the associated 
differential equations, subject to the ICs. This may be done by
•	 Direct solution (in the time domain)
•	 Solution using Laplace transform
Consider a linear time-invariant model given by the input–output differential equation
	

+
+
+
=
−
−
−
a d y
dt
a
d
y
dt
a y
u
n
n
n
n
n
n
1
1
1
0
	
(9.1)
At the outset, note that it is not necessary to specifically include derivative terms on the 
RHS of Equation 9.1; for example, 

+
+
+
b u
b du
dt
b d u
dt
m
m
m
0
1
, because once we have the solu-
tion (say, ys) for Equation 9.1 we can use the principle of superposition to obtain the general 
solution, which is given by 

+
+
+
b y
b dy
dt
b d y
dt
s
s
m
m
s
m
0
1
. Hence, we will consider only the 
case 9.1.
9.2.1   Homogeneous Solution
The natural characteristics of a dynamic system do not depend on the input to the system. 
Hence, the natural behavior (or free response) of Equation 9.1 is determined by the homo-
geneous equation (i.e., with the input = 0):
	

+
+
+
=
−
−
−
a d y
dt
a
d
y
dt
a y
0
n
n
n
n
n
n
1
1
1
0
	
(9.2)
Its solution—the homogeneous solution—is denoted by yh, and it depends on the system 
ICs. For a linear system, the natural response is known to take an exponential form given by

429
Response Analysis and Simulation
	
=
λ
y
ce
h
t	
(9.3)
where c is an arbitrary constant and, in general, λ can be complex. Substitute Equation 9.3 
in Equation 9.2 with the knowledge that
	
λ
=
λ
λ
d
dt e
e
t
t	
(9.4)
and cancel the common term 
λ
ce t, since it cannot be zero at all times. Then, we have
	

λ
λ
+
+
+
=
−
−
a
a
a
0
n
n
n
n
1
1
0
	
(9.5)
This is called the characteristic equation of the system. Note: the polynomial 

λ
λ
+
+
+
−
−
a
a
a
n
n
n
n
1
1
0 is called the characteristic polynomial. Equation 9.5 has n roots 
…
λ λ
λ
,
,
,
n
1
2
. These are called poles or eigenvalues of the system. Assuming that they are 
distinct (i.e., unequal), the overall solution to Equation 9.2 becomes
	

=
+
+
+
λ
λ
λ
y
c e
c e
c e
h
t
t
n
t
1
2
n
1
2
	
(9.6)
The unknown constants 
…
c c
c
,
,
,
n
1
2
 are determined using the necessary n ICs 

( )
…
−
−
y
y
d
y
dt
0 , (0),
,
(0)
n
n
1
1 .
Repeated Poles
Suppose that at least two eigenvalues from the solution of Equation 9.5 are equal. Without 
loss of generality, suppose in Equation 9.6 that λ
λ
=
1
2. Then, the first two terms in Equation 
9.6 can be combined into the single unknown (c1 + c2). Consequently there are only n − 1 
unknowns in Equation 9.6 but there are n ICs for the system (Equation 9.2). It follows 
that another unknown needs to be introduced for obtaining a complete solution. Since 
a repeated pole is equivalent to a double integration (i.e., a term 1/(s − λi)2 in the system 
­transfer function), the logical (and correct) solution for Equation 9.5 in the case λ
λ
=
1
2 is
	

=
+
+
+
+
λ
λ
λ
y
c
c t e
c e
c e
(
)
h
t
t
n
t
1
2
3
n
1
3
	
(9.7)
This idea can be easily generalized for the case of three or more repeated poles (by adding 
terms containing t2, t3, and so on).
9.2.2   Particular Solution
The homogeneous solution corresponds to the “natural,” “free,” or “unforced” response 
of a system, and clearly it does not depend on the input function. The effect of the input 
is incorporated into the particular solution, which is defined as one possible function for y 
that satisfies Equation 9.1. We denote this by yp. Several important input functions and the 
corresponding form of yp that satisfies Equation 9.1 are given in Table 9.1.
The parameters A, B, A1, A2, B1, B2, and D in Table 9.1 are determined by substituting the 
pair u(t) and yp into Equation 9.1 and then equating the like terms. This approach is called 
the method of undetermined coefficients.

430
Modeling of Dynamic Systems with Engineering Applications
The total response of the system (Equation 9.1) is given by
	
=
+
y
y
y
h
p 	
(9.8)
The unknown constants 
…
c c
c
,
,
,
n
1
2
 in this result are determined by substituting into 
Equation 9.8 the ICs of the system.
Note: It is incorrect to determine 
…
c c
c
,
,
,
n
1
2
 by substituting the ICs into yh only and then 
adding yp to the resulting yh. This is so because the total response is y, not yh. Furthermore, 
when u = 0, the homogeneous solution is identical to the free response (which is also the 
IC response, or the zero-input response). When an input is present, however, the homoge-
neous solution may not be identical to these other three types of response since they can be 
influenced by the forcing input as well as the natural dynamics of the system. These ideas 
are summarized in Box 9.1
BOX 9.1  SOME CONCEPTS OF SYSTEM RESPONSE
( )
( )
( )
( )
( )
( )
( )
( )
( )
=
+
=
+
=
+
=
+
T
H
P
X
F
X
F
X
F
Total response
Homogeneous solution
Particular integral
Free response
Forced response
Initial-condition response
Zero-initial-condition response
 Zero-input response
Zero-state response
Note 1: In general, H ≠ X and P ≠ F.
Note 2: With no input (no forcing excitation), by definition, H ≡ X.
Note 3: At steady state, F becomes equal to P.
TABLE 9.1
Particular Solutions for Useful Input Functions
Input u(t)
Particular Solution yp
c
A
ct + d
At + B
sin ct
+
A
ct
A
ct
sin
cos
1
2
cos ct
+
B
ct
B
ct
sin
cos
1
2
ect
Dect

431
Response Analysis and Simulation
9.2.3   Impulse Response Function
Consider a linear dynamic system. The principle of superposition holds. More specifically, 
if y1 is the system response (output) to excitation (input) u t( )
1
, and y2 is the response to 
­excitation u t( )
2
, then α
β
+
y
y
1
2 is the system response to input α
β
+
u t
u t
( )
( )
1
2
 for any con-
stants α  and β  and any excitation functions u t( )
1
 and u t( )
2
. This is true for both time-­
variant-parameter linear systems and constant-parameter linear systems.
A unit pulse of width ∆τ  starting at time 
τ
=
t
 is shown in Figure 9.1a. Its area is unity. A 
unit impulse is the limiting case of a unit pulse as ∆τ →0. A unit impulse acting at time 
τ
=
t
 is denoted by δ
τ
−
t(
) and is graphically represented as in Figure 9.1b. In mathemati-
cal analysis, this is known as the Dirac delta function, and is defined by the two conditions:
	
δ
τ
τ
τ
−
=
≠
→∞
=
t
t
t
(
)
0
for
 
at
	
(9.9)
and
	
∫δ
τ
−
=
−∞
∞
t
dt
(
)
1 	
(9.10)
The Dirac delta function has the following well-known and useful properties:
	
∫
δ
τ
τ
−
=
−∞
∞
f t
t
dt
f
( ) (
)
( ) 	
(9.11)
and
	
∫
δ
τ
−
=
τ
−∞
∞
=
d f t
dt
t
dt
d f t
dt
( ) (
)
( )
n
n
n
n
t
	
(9.12)
for any well-behaved time function f(t). The system response (output) to a unit-impulse 
excitation (input) acted at time t = 0, is known as the impulse-response function and is denoted 
by h(t).
Convolution Integral
The system output (response) to an arbitrary input may be expressed in terms of its impulse-
response function. This is the essence of the impulse-response approach to determining 
(a)
(b)
u(t)
u(t)
t
t
0
0
1
∆τ
τ
τ
τ + ∆τ
FIGURE  9.1
Illustration of (a) unit pulse and (b) unit impulse.

432
Modeling of Dynamic Systems with Engineering Applications
the forced response of a dynamic system. Without loss of generality, let us assume that the 
system input u(t) starts at t = 0; that is
	
=
<
u t
t
( )
0
for
0	
(9.13)
For physically realizable systems (see Chapters 6 and 8), the response does not depend on 
the future values of the input. Consequently
	
=
<
y t
t
( )
0
for
0	
(9.14)
and
	
=
<
h t
t
( )
0
for
0	
(9.15)
where y(t) is the response of the system, to any general excitation u(t).
Furthermore, if the system is a constant-parameter system, then the response does not 
depend on the time origin used for the input. Mathematically, this is stated as follows: if 
the response to input u(t) satisfying Equation 9.13 is y(t), which in turn satisfies Equation 
9.14, then the response to input 
τ
−
u t(
), which satisfies
	
τ
τ
−
=
<
u t
t
(
)
0
for
	
(9.16)
is 
τ
−
y t(
), and it satisfies
	
τ
τ
−
=
<
y t
t
(
)
0
for
	
(9.17)
This situation is illustrated in Figure 9.2. It follows that the delayed-impulse input 
δ
τ
−
t(
), having time delay τ , produces the delayed response 
τ
−
h t(
).
A given input u(t) can be divided approximately into a series of pulses of width ∆τ  
and magnitude 
τ
∆τ
⋅
u( )
. In Figure 9.3, as ∆τ →0, the pulse shown by the shaded 
area  becomes  an  impulse acting at 
τ
=
t
 having the magnitude τ
τ
⋅
u
d . This impulse is 
given by δ
τ
τ
τ
−
t
u
d
(
) ( )
. In a linear, constant-parameter system, it produces the response 
τ
τ
τ
−
h t
u
d
(
) ( )
. By integrating over the entire time duration of the input u(t) (i.e., by using the 
principle of superposition, since the system is linear) the overall response y(t) is obtained 
as
	
∫
τ
τ
τ
=
−
∞
y t
h t
u
d
( )
(
) ( )
0
	
(9.18a)
Alternatively, by introducing the change of variables τ
τ
→−
t
 and correspondingly revers-
ing the limits of integration (and changing the sign) we have
	
∫
τ
τ
τ
=
−
∞
y t
h
u t
d
( )
( ) (
)
0
	
(9.18b)
Equation 9.18 is known as the convolution integral. This is in fact the forced response, under 
zero ICs. It is also a particular integral (particular solution) of the system.

433
Response Analysis and Simulation
Note: The limits of integration in Equation 9.18 can be set in various manner in view of 
the fact that u(t) and h(t) are zero for t < 0 (e.g., the lower limit may be set at τ and the upper 
limit at t).
9.2.4   Stability
Many definitions are available for stability of a system. For example, a stable system may 
be defined as one whose natural response (i.e., free, zero-input, initial-condition response) 
decays to zero. This is in fact the well-known asymptotic stability. If the initial-condition 
response oscillates within finite bounds, we say the system is marginally stable. For a linear, 
time-invariant system of the type (Equation 9.1), the free response is of the form 9.6, assum-
ing no repeated poles. Hence, if none of the eigenvalues λi have positive real parts, the 
system is considered stable, because in that case, the response 9.6 does not grow unbound-
edly. In particular, if the system has a single eigenvalue that is zero, or if the eigenvalues 
are purely imaginary pairs, the system is marginally stable. If the system has two or more 
u(t)
y(t)
t
t
0
0
t
t
0
0
u(t
)
–τ
τ
y(t
)
–τ
τ
FIGURE 9.2
Response to a delayed input.
Time t
0
+ 
Area = u( )
Input 
u(t) 
τ
τ
τ
τ
∆
∆τ
FIGURE 9.3
General input treated as a continuous series of impulses.

434
Modeling of Dynamic Systems with Engineering Applications
poles that are zero, we will have terms of the form c1 + ct in Equation 9.6, and hence it will 
grow polynomially (not exponentially). Then, the system will be unstable. Even in the pres-
ence of repeated poles, if the real parts of the eigenvalues are negative, however, the system 
is stable (because the decay of the exponential terms in the response will be faster than the 
growth of the polynomial terms—see Equation 9.7, for example).
Note: Since physical systems have real parameters, their eigenvalues must occur as con-
jugate pairs, if complex.
Since stability is governed by the sign of the real part of the eigenvalues, it can be repre-
sented on the eigenvalue plane (or the pole plane, s-plane, or root plane). This is illustrated 
in Figure 9.4.
9.3   First- and Second-Order Systems
In this section, we study the response analysis of first-order systems and second-order 
systems.
9.3.1   First-Order Systems
Consider the first-order dynamic system with time constant τ, input u, and output y, as 
given by
	

τ
+
=
y
y
u t( )	
(9.19)
Im
Re
s-Plane
(Eigenvalue plane)
E
E
A
A
D
B
C
C
FIGURE 9.4
Dependence of stability on the pole location. A and B are stable pole locations; C is a marginally stable location; 
and D and E are unstable locations.

435
Response Analysis and Simulation
Suppose that the system starts from y(0) = y0 and a step input of magnitude A is applied at 
that IC. The homogeneous solution is
	
=
τ
−
y
ce
h
t
The particular solution (see Table 9.1) is given by yp = A. Hence, the total response is
	
=
+
=
+
τ
−
y
y
y
ce
A
h
p
t
Substitute the IC: y(0) = y0. We get C + A = y0. Hence
	






 




=
−
+
=
+
−
τ
τ
τ
−
−
−
y
y
A e
A
y e
A
e
(
)
(1
)
step
t
y
y
t
y
t
y
0
Homogeneous
         
Particular
       
0
Free response
        
Forced response
           
h
p
x
f
	
(9.20)
The steady-state value is given by t → ∞:
	
=
y
A
ss
	
(9.21)
It is seen from Equation 9.20 that the forced response to a unit step input (i.e., A = 1) is 
−
τ
−e
(1
)
t
. Due to linearity of the system, the forced response to a unit impulse input is 
τ
−
=
τ
τ
−
−
d
dt
e
e
(1
)
1
t
t . Hence, the total response to an impulse input of magnitude P is
	
τ
=
+
τ
τ
−
−
y
y e
P e
impulse
t
t
0
	
(9.22)
This result follows from the fact that
	
=
d
dt (Step function)
Impulse function	
(9.23)
and because, due to linearity, when the input is differentiated, the output is correspond-
ingly differentiated.
Note from Equations 9.20 and 9.22 that if we know the response of a first-order system to 
a step input, or to an impulse input, the system itself can be determined. This is known as 
model identification or experimental modeling. We will illustrate this by an example.
Example 9.1: Model Identification Example
Consider the first-order system (model)
	

τ
+
=
y
y
ku	
(i)
The system parameters are the time constant τ and the gain parameter k. The IC is 
y(0) = y0.
Using Equation 9.20, we can derive the response of the system to a step input of 
­magnitude A:

436
Modeling of Dynamic Systems with Engineering Applications
	
=
+
−
τ
τ
−
−
y
y e
Ak
e
(1
)
step
t
t
0
	
(ii)
Note: Due to linearity, the forced response is magnified by k since the input is magnified 
by the same factor.
Suppose that the unit step response of a first-order system with zero ICs was found 
(by, say, curve fitting of experimental data) to be
	
=
−
−
y
e
2.25(1
)
step
t
5.2
Then, it is clear from Equation ii that the system parameters are
	
=
=
=
k
t
2.25 and
1/5.2
0.192.
These two parameters completely determine the system model.
LEARNING OBJECTIVES
	
1.	 Analytical response of a first-order linear system
	
2.	 Use of response analysis in model identification (e.g., determination of the 
parameter values of a dynamic system)
■
9.3.2   Second-Order Systems
A general high-order system can be represented by a suitable combination of first-order 
and second-order models, using the principles of modal analysis. Hence, it is useful to 
study the response behavior of second-order systems as well. Examples of second-order 
systems include mass-spring-damper systems and capacitor-inductor-resistor circuits, 
which we have studied in previous chapters. These are called simple oscillators because 
they exhibit oscillations in the natural response (free, unforced response) when the level 
of damping is sufficiently low. We will study both free response and forced response of 
second order systems.
Free Response of an Undamped Oscillator
The equation of free (i.e., no excitation force) motion of an undamped simple oscillator is 
of the general form:
	

ω
+
=
x
x
0
n
2
	
(9.24)
For a mechanical system of mass m and stiffness k, we have the undamped natural fre-
quency (whose meaning will be further discussed later):
	
ω =
k
m
n
	
(9.25a)
For an electrical circuit with capacitance C and inductance L, we have
	
ω =
LC
1
n
	
(9.25b)

437
Response Analysis and Simulation
Note: These results can be immediately established from the electro-mechanical analogy 
(see Chapter 2) that we use: 
→
→
→
m
C k
L b
R
;
1/ ;
1/
.
To determine the time response x of this system, we use the trial solution
	
ω
φ
=
+
x
A
t
sin(
)
n
	
(9.26)
in which A and ϕ are unknown constants to be determined by the ICs (for x and x); say,
	

=
=
x
x
x
v
(0)
, (0)
o
o	
(9.27)
The parameter A is the amplitude, and ϕ is the phase angle of the response, as will be 
discussed later.
Substitute the trial solution (Equation 9.26) into Equation 9.24. We obtain 
ω
ω
ω
φ
−
+
+
=
A
A
t
(
)sin(
)
0
n
n
n
2
2
This equation is identically satisfied for all t. Hence, the general solution of Equation 9.24 
is indeed Equation 9.26, which is periodic and sinusoidal.
This response (Equation 9.26) is sketched in Figure 9.5 (the subscript in ωn is dropped for 
convenience). Note that this sinusoidal, oscillatory motion has a frequency of oscillation of 
ω (radians/s). Hence, a system that provides this type of natural motion is called a simple 
oscillator. In other words, the system response exactly repeats itself in time periods of T or 
at a cyclic frequency 
=
f
T
1 (cycles/s or Hz).
Note: This fact may be verified by substituting 
π
ω
= +
= +
= +
t
t
T
t
f
t
1/
2 /
 in Equation 
9.26, which will give the same x value. The frequency ω is in fact the angular frequency given 
by ω
π
=
f
2
.
Also, the response has amplitude A, which is the peak value of the sinusoidal response. 
This is verified from Equation 9.26 because the maximum value of a sine function is 1. 
Now, suppose that we shift the response curve (Equation 9.26) to the right through a time 
interval of φ ω
/
. Take the resulting curve as the reference signal (whose signal value = 0 
at t = 0, and increasing). It should be clear that the response shown in Figure 9.5 leads the 
reference signal by a time period of φ ω
/
. This may be verified from the fact that the value 
of the reference signal at time t is the same as that of the signal in Figure 9.5 at time 
φ ω
−
t
/
. Hence, φ is termed the phase angle of the response, and it is indeed a phase lead.
Response x 
Time t
x
A
0
2
ω
ω
ω
ω
–
φ
φ
φ
φ
π
π
–
–
FIGURE 9.5
Free response of an undamped simple oscillator.

438
Modeling of Dynamic Systems with Engineering Applications
The left-hand-side portion of Figure 9.5 is the phasor representation of a sinusoidal 
response. In this representation, an arm of length A rotates in the counterclockwise direc-
tion at angular speed ω. This arm is the phasor. The arm starts at an angular position ϕ 
from the horizontal axis, at time t = 0. The projection of the arm onto the vertical (x) axis 
gives the time response. In this manner, the phasor representation can conveniently indi-
cate the amplitude, frequency, phase angle, and the actual time response (at any time t) of 
a sinusoidal motion.
Free Response of a Damped Oscillator
Energy dissipation in a mechanical oscillator may be represented by a damping element. 
For an electrical circuit, a resistor accounts for energy dissipation. In either case, the equa-
tion motion of a damped simple oscillator without an input, may be expressed as
	


ζω
ω
+
+
=
x
x
x
2
0
n
n
2
	
(9.28)
Note: ς is the damping ratio.
Assume an exponential solution:
	
=
λ
x
Ce t	
(9.29)
This is justified by the fact that linear systems have exponential or oscillatory (i.e., com-
plex exponential) free responses (see Equation 9.6). A more convincing justification for this 
assumption will be provided later.
Substitute Equation 9.29 into Equation 9.28. We get λ
ζω λ
ω
+
+


=
λ
Ce
2
0.
n
n
t
2
2
Note that 
λ
Ce t  is not zero for all t; hence, it can be removed from the preceding equation, 
giving:
	
λ
ζω λ
ω
+
+
=
2
0
n
n
2
2
	
(9.30)
It follows that, when λ satisfies Equation 9.30, then Equation 9.29 will represent a solution 
of Equation 9.28. As noted before, Equation 9.30 is the characteristic equation of the system. 
This equation depends on the natural dynamics of the system, not the forcing excitation or 
the ICs. The solution of Equation 9.30 gives the two roots:
	
λ
ζω
ζ
ω
λ
λ
= −
±
−
=
1
and
n
n
2
1
2
	
(9.31)
These are the eigenvalues or poles of the system. When λ
λ
≠
1
2 (i.e., unequal poles), the gen-
eral solution of Equation 9.28 is
	
=
+
λ
λ
x
C e
C e
t
1
2
1
2 	
(9.32)
The two unknown constants C1 and C2 are related to the integration constants and can be 
determined by two ICs, which should be known.
If λ
λ
λ
=
=
1
2
; we have the case of repeated roots. In this case, as noted before, the general 
solution (Equation 9.32) does not hold because C1 and C2 will no longer be independent 
constants, which will not require two ICs for their determination. The repetition of the 

439
Response Analysis and Simulation
roots suggests that one term of the homogenous solution should have the multiplier t (a 
result of the associated double integration). Accordingly, the general solution is
	
=
+
λ
λ
x
C e
C te
t
t
1
2
	
(9.33)
We can identify three ranges of damping, as discussed below, and the nature of the 
response will depend on the particular range of damping.
Case 1: Underdamped motion (ζζ << 1)
In this case, it follows from Equation 9.31 that the roots of the characteristic equation are
	
λ
ζω
ζ ω
ζω
ω
λ
λ
= −
±
−
= −
±
=
j
j
1
 and 
n
n
n
d
2
1
2	
(9.34)
where ω d is the damped natural frequency, given by
	
ω
ζ ω
=
−
1
d
n
2
	
(9.35)
Note: λ1 and λ2 are complex conjugates, as required. In this case, the response 9.32 may be 
expressed as
	
=
+


ζω
ω
ω
−
−
x
e
C e
C e
t
j
t
j
t
1
2
n
d
d
	
(9.36)
The term within the square brackets in Equation 9.36 has to be real, because it represents 
the time response of a real physical system. It follows that C1 and C2, as well, have to be 
complex conjugates.
	
ω
ω
ω
ω
=
+
=
−
ω
ω
−
e
t
j
t
e
t
j
t
Note:
cos
sin
cos
sin
j
t
d
d
j
t
d
d
d
d
So, an alternative form of the general solution would be
	
ω
ω
=
+


ζω
−
x
e
A
t
A
t
cos
sin
t
d
d
1
2
n
	
(9.37)
Here, A1 and A2 are two unknown real-valued constants. By equating the coefficients in 
Equations 9.37 and 9.36, it can be shown that
	
=
+
=
−
A
C
C
A
j C
C
(
)
1
1
2
2
1
2
	
(9.38a)
Hence,
	
=
−
=
+
C
A
jA
C
A
jA
1
2 (
)
1
2 (
)
1
1
2
2
1
2
	
(9.38b)
Initial conditions:
Let 

=
=
x
x
x
v
(0)
, (0)
o
o as before. Then

440
Modeling of Dynamic Systems with Engineering Applications
	
=
x
A
o
1	
(9.39a)
and 
	
ζω
ω
= −
+
v
A
A
o
n
d
1
2
or
	
ω
ζω
ω
=
+
A
v
x
o
d
n
o
d
2
	
(9.39b)
Yet another form of the solution would be
	
ω
φ
=
+
ζω
−
x
Ae
t
sin(
)
t
d
n
	
(9.40)
Here, A and ϕ are the two unknown constants with
	
φ
=
+
=
+
A
A
A
A
A
A
and sin
.
1
2
2
2
1
1
2
2
2
	
(9.41)
	
φ
φ
=
+
=
A
A
A
A
A
Also, cos
 and tan
2
1
2
2
2
1
2
	
(9.42)
Note: The response →
x
0 as →∞
t
. This means the system is asymptotically stable.
Case 2: Overdamped motion (ζζ > 1)
In this case, roots λ1 and λ1 of the characteristic Equation 9.30 are real and negative. 
Specifically, we have
	
λ
ζω
ζ
ω
= −
+
−
<
1
0
n
n
1
2
	
(9.43a)
	
λ
ζω
ζ
ω
= −
−
−
<
1
0
n
n
2
2
	
(9.43b)
and the response (Equation 9.32) is nonoscillatory. Also, since both λ
λ
 and 
1
2 are nega-
tive (see Equation 9.43), we have →
x
0 as →∞
t
. This means the system is asymptotically 
stable.
From the ICs 

=
=
x
x
x
v
(0)
,
(0)
o
o, we obtain
	
=
+
x
C
C
o
1
2	
(i)
and
	
λ
λ
=
+
v
C
C
o
1
1
2
2	
(ii)
	
λ
λ
λ
λ
(
)
=
+
x
C
C
Multiply the first IC Equation i by
:
o
2
2
2
1
2
2	
(iii)
	
λ
λ
λ
−
=
−
v
x
C
Subtract Equation iii from Equation ii :
(
)
o
o
2
1
1
2

441
Response Analysis and Simulation
We obtain
	
λ
λ
λ
=
−
−
C
v
x
o
o
1
2
1
2
	
(9.44a)
	
λ
λ
λ
λ
(
)
=
+
x
C
C
Multiply the first IC Equation i by
:
o
1
1
1
1
1
2	
(iii)
	
λ
λ
λ
−
=
−
v
x
C
Subtract Equation iii from Equation ii:
(
)
o
o
1
2
2
1
We obtain
	
λ
λ
λ
=
−
−
C
v
x
o
o
2
1
2
1
	
(9.44b)
Case 3: Critically damped motion (ζζ == 1)
Here, we have repeated roots, given by
	
λ
λ
ω
=
= −
n
1
2
	
(9.45)
The response for this case is given by (see Equation 9.33)
	
=
+
ω
ω
−
−
x
C e
C te
t
t
1
2
n
n 	
(9.46)
Since the term 
ω
−e
t
n  goes to zero faster than t that goes to infinity, we have:
	
→
ω
−
te
0
t
n
as →∞
t
. Hence, the system is asymptotically stable.
Now, use the ICs 

=
=
x
x
x
v
(0)
,
(0)
o
o. We have
	
ω
=
= −
+
x
C
v
C
C
o
o
n
1
1
2
Hence,
	
=
C
xo
1
	
(9.47a)
	
ω
=
+
C
v
x
o
n
o
2
	
(9.47b)
Note: When ζ = 1 we have the critically damped response because below this value, the 
response is oscillatory (underdamped) and above this value, the response is nonoscilla-
tory (overdamped). It follows that we may define the damping ratio as
	
ζ =
=
Damping ratio
Damping constant
Damping constant for critically damped conditions
The main results for free (natural) response of a damped oscillator are given in Box 9.2. 

442
Modeling of Dynamic Systems with Engineering Applications
BOX 9.2  FREE (NATURAL) RESPONSE OF A 
DAMPED SIMPLE OSCILLATOR
System equation:
	


ζω
ω
+
+
=
x
x
x
2
0
n
n
2
Undamped natural frequency ω =
k
m
n
 or ω =
LC
1
n
Damping ratio ζ =
b
km
2
 or ζ =
R
L
C
1
2
Note: Electromechanical analogy 
→
→
→
m
C k
L b
R
;
1/ ;
1/
Characteristic equation: λ
ζω λ
ω
+
+
=
2
0
n
n
2
2
Roots (eigenvalues or poles): λ
λ
ζω
ζ
ω
= −
±
−
and
1
n
n
1
2
2
λ
λ
λ
λ
λ
=
+
≠
=
+
=
=
λ
λ
λ
x
C e
C e
x
C
C t e
Response:
for unequal roots (
)
(
)
for equal roots (
)
t
t
t
1
2
1
2
1
2
1
2
1
2
Initial conditions: 

=
=
x
x
x
v
(0)
and (0)
0
0
Case 1: Underdamped (ζζ << 1)
Poles are complex conjugates: ζω
ω
−
± j
n
d
Damped natural frequency ω
ζ ω
=
−
1
d
n
2
	
ω
ω
ω
φ
φ
(
)
(
)
(
)
(
)
=
+


=
+


=
+
=
+
=
−
=
−
=
+
=
+
=
ζω
ω
ω
ζω
ζω
−
−
−
−
A
A
x
e
C e
C e
e
A
t
A
t
Ae
t
A
C
C
A
j C
C
C
A
jA
C
A
jA
A
A
A
cos
sin
sin
and
and
and tan
t
j
t
j
t
t
d
d
t
d
1
2
1
2
1
1
2
2
1
2
1
1
2
1
2
2
1
2
1
2
1
2
2
2
1
2
n
d
d
n
n
ICs give: 
ζω
ω
=
=
+
x
v
x
A
and A
o
o
n
o
d
1
2
Logarithmic decrement per radian: α
π
ζ
ζ
=
=
−
n
r
1
2
ln
1
2
where 
( )
(
)
=
+
r
x t
x t
nT  = decay ratio over n complete cycles. For small ζ: ζ @ α
Case 2: Overdamped (ζ > 1)
	
λ λ
ζω
ζ
ω
λ
λ
λ
λ
λ
λ
= −
±
−
=
+
=
−
−
=
−
−
λ
λ
x
C e
C e
C
v
x
C
v
x
Poles are real and negative :
,
1
and
n
n
t
t
1
2
2
1
2
1
0
2
0
1
2
2
0
1
0
2
1
1
2
Case 3: Critically damped (ζ = 1)
Two identical poles: λ
λ
λ
ω
=
=
= −
n
1
2
	
ω
(
)
=
+
=
=
+
ω
−
x
C
C t e
C
x
C
v
x
with
and
t
n
1
2
1
0
2
0
0
n
The response of a damped simple oscillator is shown in Figure 9.6.

443
Response Analysis and Simulation
9.4   Forced Response of a Damped Oscillator
The forced response depends on both the natural characteristics of the system (free 
response) and the nature of the input. Mathematically, as noted before, the total 
response is the sum of the homogeneous solution and the particular solution. Consider 
a damped simple oscillator, with input u(t) scaled such that it has the same units as the 
response y:
	


ζω
ω
ω
+
+
=
y
y
y
u t
2
( )
n
n
n
2
2
	
(9.48)
0.5
1.0
t  (s)
0.20
0.10
0.00
0
Displacement
x (m)
0.5
1.0
Time  t   (s)
0.20
0.10
0.00
0
x
(m)
0.5
1.0
t  (s)
0.20
0.10
0.00
0
x
(m)
< 1
= 1
> 1
(a)
(b)
(c)
–0.10
–0.20
–0.10
–0.20
–0.20
–0.10
ζ
ζ
ζ
FIGURE 9.6
Free response of a damped oscillator. (a) Underdamped; (b) critically damped; (c) overdamped.

444
Modeling of Dynamic Systems with Engineering Applications
We will consider the response of this system to three types of inputs:
	
1.	Impulse input
	
2.	Step input
	
3.	Harmonic (sinusoidal) input
9.4.1   Impulse Response
Many important characteristics of a system can be studied by analyzing the system response 
to a baseline excitation (test excitation) such as an impulse, a step, or a sinusoidal (harmonic) 
input. Characteristics that may be studied in this manner include: system stability, speed of 
response, time constants, damping properties, and natural frequencies. Furthermore, mod-
els and their parameters can be determined by this method (this subject is known as system 
identification, model identification, or experimental modeling). As well, an insight can be 
gained into the system response for an arbitrary excitation. Responses to such test inputs can 
also serve as the basis for system comparison. For example, it is possible to determine the 
degree of nonlinearity in a system by exciting it with two input intensity levels separately 
and checking whether the proportionality is retained at the output, or when the excitation is 
harmonic, whether limit cycles are encountered by the response.
The response of the system (Equation 9.48) to a unit impulse input 
δ
=
u t
t
( )
( ) may be 
­conveniently determined by the Laplace transform approach (see Section 9.5). However, in 
the present section, we will use a time-domain approach instead. First, integrate Equation 
9.48 over the almost-zero interval from =
=
−
+
t
t
0 to
0 . We obtain
	


∫
∫
ζω
ω
ω
=
−
−

−
+
+
−
+
−
−
+
−
+
y
y
y
y
ydt
u t dt
(0 )
(0 )
2
(0 )
(0 )
( )
n
n
n
2
2
0
0
0
0
	
(9.49)
Suppose that the system starts from rest. Hence, 
=
−
y(0 )
0 and 
=
−
y(0 )
0. When an impulse 
is applied over an infinitesimally short time period 

−
+
0 ,0
 the system will not be able 
to move through a finite distance during that time. Hence, 
=
+
y(0 )
0, and furthermore, 
the integral of y on the RHS of Equation 9.49 also will be zero. Now, by definition of a 
unit impulse, the integral of u on the RHS of Equation 9.49 will be unity. Hence, we have 

ω
=
+
y(0 )
n
2. It follows that as soon as a unit impulse is applied to the system 9.48, the ICs 
will become
	

ω
=
=
+
+
y
y
(0 )
0 and (0 )
n
2	
(9.50)
Also, beyond =
+
t
0  the input is zero (
=
u t( )
0), according to the definition of an impulse. 
Hence, the impulse response of the system 9.48 is obtained by its homogeneous solution 
(as carried out before for the case of free response), but with the ICs (Equation 9.50). The 
three cases of damping ratio ζ
ζ
ζ
(
)
<
>
=
1,
1, and
1  should be considered separately. Then, 
we can conveniently obtain the following results:
	
ω
ζ
ζω
ω
ζ
=
=
−
−
<
y
t
h t
t
t
( )
( )
1
exp(
)sin
for
1
impulse
n
n
d
2
	
(9.51a)

445
Response Analysis and Simulation
	
ω
ζ
λ
λ
ζ
=
=
−
−


>
y
t
h t
t
t
( )
( )
2
1
exp
exp
for
1
impulse
n
2
1
2
	
(9.51b)
	
ω
ω
ζ
=
=
−
=
y
t
h t
t
t
( )
( )
exp(
) for
1
impulse
n
n
2
	
(9.51c)
An explanation concerning the dimensions of h(t) is appropriate at this juncture. Note that 
y(t) has the same dimensions as u(t). Since h(t) is the response to a unit impulse δ t( ), it fol-
lows that these two have the same dimensions. The magnitude of δ t( ) is represented by 
a unit area in the u(t) versus t plane. Consequently, δ t( ) has the dimensions of (1/time) or 
(frequency). It follows that h(t) also has the dimensions of (1/time) or (frequency).
The impulse-response functions given by Equation 9.51 are plotted in Figure 9.7 for 
some representative values of damping ratio. It should be noted that for 
ζ
<
<
0
1, the angu-
lar frequency of damped vibrations is ω d, which is smaller than the undamped natural 
frequency ωn.
9.4.2   The Riddle of Zero ICs
For a second-order system, zero ICs correspond to y(0) = 0 and 
=
y(0)
0. It is clear from 
Equation 9.51 that h(0) = 0, but 
≠
h(0)
0, which appears to violate the assumption of zero ICs. 
This situation is characteristic in a system response to an impulse and its higher deriva-
tives. This may be explained as follows. When an impulse is applied to a system at rest 
(zero initial state), the highest derivative of the system differential equation momentarily 
becomes infinity. As a result, the next lower derivative becomes finite (nonzero) at =
+
t
0 . 
The remaining lower derivatives maintain their original zero values at that instant =
+
t
0 . 
Impulse response function
(non-dimensional)
Time
(non-dimensional)
h(t)
1
0
2π
3π
4π
= 0
= 0.5
= 1.0
= 2.0
ωn
ζ
ζ
ζ
ζ
π
ωnt 
FIGURE 9.7
Impulse-response function of a damped oscillator.

446
Modeling of Dynamic Systems with Engineering Applications
When an impulse is applied to the mechanical system given by Equation 9.48, for example, 
the acceleration y t( ) becomes infinity, and the velocity y t( ) takes a nonzero (finite) value 
shortly after its application (i.e., at =
+
t
0 ). The displacement y(t), however, would not have 
sufficient time to change at =
+
t
0 . In this case, the impulse input is therefore equivalent 
to a velocity IC. This IC is determined by using the integrated form (Equation 9.49) of the 
system equation (9.48), as has been done.
9.4.3   Step Response
A unit step excitation is defined by
	
=
>
=
≤
U t
t
t
( )
1 for
0
0 for
0
	
(9.52)
Unit impulse excitation δ t( ) may be interpreted as the time derivative of U t( ):
	
δ
=
t
dU t
dt
( )
( )	
(9.53)
Note: Equation 9.53 reestablishes the fact that for nondimensional U t( ), the dimension of 
δ t( ) is (time)−1. Since a unit step is the integral of a unit impulse, the step response can be 
obtained directly as the integral of the impulse response:
	
∫
τ
τ
=
y
t
h
d
( )
( )
step
t
0
	
(9.54)
This result also follows from the convolution integral (Equation 9.18b) because, for a 
delayed unit step, we have
	
τ
τ
τ
−
=
<
=
≥
U t
t
t
(
)
1
for
             
0
for
	
(9.55)
Thus, by integrating Equation 9.51 with zero ICs, the following results are obtained for 
step response:
	
ζ
ζω
ω
φ
ζ
=
−
−
−
+
<
y
t
t
t
( )
1
1
1
exp(
)sin(
) for
1
step
n
d
2
	
(9.56a)
	
ζ ω
λ
λ
λ
λ
ζ
=
−
−
−


>
y
t
t
1
1
2 1
exp
exp
for
1
step
n
2
1
2
2
1
	
(9.56b)
	
ω
ω
ζ
=
−
+
−
=
y
t
t
1
(
1)exp(
) for
1
step
n
n
	
(9.56c)
with
	
φ
ζ
=
cos
	
(9.57)
The step responses given by Equation 9.56 are plotted in Figure 9.8, for several values of 
damping ratio.

447
Response Analysis and Simulation
Note: Since a step input does not cause the highest derivative of the system equation to 
approach infinity at =
+
t
0 , the ICs that are required to solve the system equation remain 
unchanged at =
+
t
0 , provided that there are no derivative terms on the input side of the 
system equation. If there is a derivative term in the input side of the system equation, then 
a step will be converted into an impulse (due to differentiation), and the response will 
change accordingly.
The impulse response h(t) assumes a zero initial state. It should be emphasized as well 
that the response given by the convolution integral (Equation 9.18) is based on the assump-
tion that the initial state is zero. Hence, it is known as the zero-state response. As we have 
stated before, the zero-state response is not necessarily equal to the “particular solution” in 
mathematical analysis. Also, as t increases ( →∞
t
), this solution approaches the steady-state 
response denoted by yss, which is typically the particular solution. The impulse response of 
a system is the inverse Laplace transform of the transfer function. Hence, it can be deter-
mined using Laplace transform techniques. Some useful concepts of forced response are 
summarized in Box 9.3.
9.4.4   Response to Harmonic Excitation
In many engineering problems, the primary excitation typically has a repetitive periodic 
nature, and, in some cases, this periodic input function may even be purely sinusoidal. 
Examples are excitations due to mass eccentricity and misalignments in rotational com-
ponents, tooth meshing in gears, and electromagnetic devices excited by ac or periodic 
electrical signals and frequency generators. In basic terms, the frequency response of a 
dynamic system is the response to a pure sinusoidal excitation. As the amplitude and the 
frequency of the excitation are changed, the response also changes. In this manner, the 
response of the system over a range of excitation frequencies can be determined, and this 
set of input–output data, at steady state, represents the frequency response. Here, we are 
Time (non- 
   dimensional)
0
2π
3π
4π
2
1
= 0
= 0.5
= 1.0
= 2.0
Unit step response   
y(t)
ζ
ζ
ζ
ζ
π
ωnt
FIGURE 9.8
Unit step response of a damped oscillator.

448
Modeling of Dynamic Systems with Engineering Applications
dealing with the frequency domain (rather than the time domain), and frequency (ω) is the 
independent variable.
Consider the damped oscillator with a harmonic input, as given by
	


ζω
ω
ω
+
+
=
=
x
x
x
a
t
u t
2
cos
( )
n
n
2
	
(9.58)
The particular solution xp that satisfies (Equation 9.58) is of the form (see Table 9.1)
	
ω
ω
ζ
ω
ω
{
}
=
+
=
=
x
a
t
a
t
cos
sin
Except for the case :
0 and
p
n
1
2
	
(9.59)
BOX 9.3:  USEFUL CONCEPTS OF FORCED RESPONSE
Convolution integral: Response ∫
∫
τ
τ
τ
τ
τ
τ
(
) ( )
( ) (
)
=
−
=
−
y
h t
u
d
h
u t
d
t
t
0
0
where u = excitation (input) and h = impulse response function (response to a unit 
impulse input).
Damped simple oscillator: 

ζω
ω
ω
( )
+
+
=
y
y
y
u t
2
n
n
n
2
2
Poles (eigenvalues):
 
λ λ
ζω
ζ
ω
ζ
ζω
ω
ζ
= −
±
−
≥
= −
±
<
j
,
1
for
1
for
1
n
n
n
1
2
2
d
ωn = undamped natural frequency, ω d = damped natural frequency
ς = damping ratio.
Note: ω
ζ ω
=
−
1
d
n
2
ω
ζ
ζω
ω
ζ
ω
ζ
λ
λ
ζ
ω
ω
ζ
(
)
(
)
(
)
=
−
−
<
=
−
−


>
=
−
=
h t
t
t
t
t
t
t
Impulse response function
Zero ICs
:
( )
1
exp
sin
for
1
2
1
exp
exp
for
1
exp
for
1
n
n
d
n
n
n
2
2
1
2
2
	
ζ
ζω
ω
φ
ζ
ζ
ω
λ
λ
λ
λ
ζ
ω
ω
ζ
φ
ζ
(
)
(
)
(
)
(
)
(
)
=
−
−
−
+
<
=
−
−
−


>
=
−
+
−
=
=
y t
t
t
t
t
t
t
Unit step response
Zero ICs
:
( )
1
1
1
exp
sin
for
1
1
1
2
1
exp
exp
for
1
1
1 exp
for
1
cos
n
d
n
n
n
step
2
2
1
2
2
1
Note: Impulse response =  (
)
d
dt Step response .

449
Response Analysis and Simulation
where the constants a1 and a2 are determined by substituting Equation 9.59 into the system 
equation (9.58) and equating the like coefficient; the method of undetermined coefficients. We 
will consider several important cases.
(1)  Undamped oscillator with excitation frequency ≠ natural frequency:
We have
	

ω
ω
ω
ω
+
=
≠
x
x
a
t
cos
with
n
n
2
	
(9.60)
	
ω
ω
=
+
x
A
t
A
t
Homogeneous solution :
cos
sin
h
n
n
1
2
	
(9.61)
	
ω
ω
ω
=
−
x
a
t
Particular solution :
(
) cos
p
n
2
2
	
(9.62)
Note: It can be easily verified that xp given by Equation 9.62 satisfies the forced system 
equation (9.60). Hence it is a particular solution.
Complete solution:
	










ω
ω
ω
ω
ω
(
)
=
+
+
−
x
A
t
A
t
a
t
cos
sin
(
) cos
Satisfies the homogeneous
equation
Satisfies the forced equation
equation with input
n
n
H
n
P
1
2
2
2
	
(9.63)
Now A1 and A2 are determined using the ICs:
	

=
=
x
x
x
v
(0)
and
(0)
o
o	
(9.64)
Specifically, we obtain
	
ω
ω
=
+
−
x
A
a
o
n
1
2
2 	
(9.65a)
	
ω
=
v
A
o
n
2
	
(9.65b)
Hence, the complete response is
	










ω
ω
ω
ω
ω
ω
ω
ω
=
−
−




+
+
−
x
x
a
t
v
t
a
t
(
) cos
sin
cos
Homogeneous solution.
Particular solution.
o
n
n
o
n
n
H
n
P
2
2
2
2
	
(9.66a)
	















ω
ω
ω
ω
ω
ω
ω
(
)
(
)
=
+
+
−
−


ω
ω
ω
ω
+
−
x
t
v
t
a
t
t
x
x
cos
sin
(
) cos
cos
Free response
* Forced response depends on input
Depends only on ICs
Comes from both 
 and 
.
o
n
o
n
n
X
n
n
t
t
F
h
p
2
2
2sin (
)
2
sin (
)
2
n
n
	
(9.66b)

450
Modeling of Dynamic Systems with Engineering Applications
	
ω
ω
ω
ω
ω
ω
ω
−
+
−
x
Comes from
; Sinusoidal at
.
*Will exhibit a beat phenomenon for
Small
; i.e., (
)
2
wave
“modulated” by (
)
2
wave.
h
n
n
n
n
This is a “stable” response in the sense of bounded-input bounded-output (BIBO) stability, 
as it is bounded and does not increase steadily.
Note: If there is no forcing excitation, the homogeneous solution H and the free response 
X will be identical. With a forcing input, the natural free response will be influenced by the 
input in general, as clear from Equation 9.66b.
(2)  Undamped Oscillator with ω
ω
=
n (Resonant Ccondition):
This is the degenerate case given by
	

ω
ω
+
=
x
x
a
t
cos
2
	
(9.67)
In this case, the particular solution xp that was used before is no longer valid because by 
then the particular solution would become the same as the homogeneous solution, and 
the former would be completely absorbed into the latter. Instead, in view of the “double-
integration” nature of the forced system equation when ω = ωn (see the Laplace transform 
of Equation 9.67—Section 9.5), we use the following particular solution (P):
	
ω
ω
=
x
at
t
2
sin
p
	
(9.68)
This choice of particular solution is justified by the fact that it satisfies the forced system 
equation (9.67).
	
ω
ω
ω
ω
=
+
+
x
A
t
A
t
at
t
Complete solution:
cos
sin
2
sin
1
2
	
(9.69)
	

=
=
x
x
x
v
ICs :
(0)
and (0)
o
o
By substitution of ICs into Equation 9.69, we obtain
	
=
x
A
o
1	
(9.70a)
	
ω
=
v
A
o
2	
(9.70b)
The total response:
	










ω
ω
ω
ω
ω
ω
(
)
(
)
=
+
+
x
x
t
v
t
at
t
cos
sin
2
sin
Free response depends on ICs
Forced response depends on input
*Sinusoidal with frequency .
* Amplitude increases linearly.
o
o
X
F
	
(9.71)

451
Response Analysis and Simulation
Since the forced response increases steadily, this is an unstable forced response in the 
BIBO sense. Furthermore, the homogeneous solution H and the free response X are identi-
cal, and the particular solution P is identical to the forced response F, in this case.
Note: The same system (undamped oscillator) gives a bounded response for some excita-
tions while producing an unstable response (steady linear increase) when the excitation 
frequency is equal to its natural frequency. Hence, the system is not quite unstable, but 
is not quite stable either. In fact, the undamped oscillator is said to be marginally stable. 
When the excitation frequency is equal to the natural frequency, it is reasonable for the 
system to respond in a complementary and steadily increasing manner because this cor-
responds to the most “receptive” excitation. Specifically, in this case, the excitation comple-
ments and reinforces the natural response of the system. In other words, the system is “in 
resonance” with the excitation. This condition is called a resonance and the corresponding 
frequency is called resonant frequency. Later on, we will address this aspect for the more 
general case of a damped oscillator.
Figure 9.9 shows typical forced responses of an undamped oscillator for a large dif-
ference in excitation frequency and natural frequency (Case 1); for a small difference in 
0
0
0
(a)
(b)
Time t 
Time t 
Time t 
Response
Response
(c)
Response
FIGURE 9.9
Forced response of a harmonic-excited undamped simple oscillator. (a) For a large frequency difference; (b) for a small 
frequency difference (beat phenomenon); (c) response at resonance.

452
Modeling of Dynamic Systems with Engineering Applications
excitation frequency and natural frequency (also Case 1), where a beat-phenomenon is 
clearly manifested; and for the resonant case where the excitation frequency equals the 
natural frequency (Case 2).
(3)  Damped oscillator:
In this case, the equation of forced motion is
	


ζω
ω
ω
+
+
=
x
x
x
a
t
2
cos
n
n
2
	
(9.72)
Particular solution: Since derivatives of both odd order and even order are present in this 
equation, the particular solution should have terms corresponding to odd and even deriv-
atives of the forcing function (i.e., sin ωt and cos ωt). Hence, the appropriate particular 
solution will be of the form:
	
ω
ω
=
+
x
a
t
a
t
cos
sin
p
1
2
	
(9.73)
We determine the coefficients in Equation 9.73 by the method of undetermined coeffi-
cients. Specifically, substitute Equation 9.73 into Equation 9.72. We obtain
	
ω
ω
ω
ω
ζω
ω
ω
ω
ω
ω
ω
ω
ω
−
−
+
−
+

+
+

=
a
t
a
t
a
t
a
t
a
t
a
t
a
t
cos
sin
2
sin
cos
cos
sin
cos
n
n
2
1
2
2
1
2
2
1
2
Equate like coefficients:
	
ω
ζω ω
ω
−
+
+
=
a
a
a
a
2
n
n
2
1
2
2
1
	
ω
ζω ω
ω
−
−
+
=
a
a
a
2
0
n
n
2
2
1
2
2
Hence, we have
	
ω
ω
ζω ω
(
)
−
+
=
a
a
a
2
n
n
2
2
1
2
	
(9.74a)
	
ζω ω
ω
ω
(
)
−
+
−
=
a
a
2
0
n
n
1
2
2
2
	
(9.74b)
This can be written in the vector-matrix form:
	
ω
ω
ζω ω
ζω ω
ω
ω
−
−
−
















=








a
a
a
(
)
2
2
(
)
0
n
n
n
n
2
2
2
2
1
2
	
(9.74c)
Its solution is
	
ω
ω
ζω ω
ζω ω
ω
ω








=
−
−
−
















a
a
D
a
o
1
(
)
2
2
(
)
n
n
n
n
1
2
2
2
2
2
	
(9.75)
or
	
ω
ω
(
)
=
−
a
D
a
n
1
2
2
	
(9.75a)
	
ζω ω
=
a
D
a
2
n
2
	
(9.75b)

453
Response Analysis and Simulation
with the determinant given by
	
ω
ω
ζω ω
(
)
(
)
=
−
+
D
2
n
n
2
2 2
2	
(9.76)
Some useful results on the frequency response of a simple oscillator are summarized in 
Box 9.4.
BOX 9.4  HARMONIC RESPONSE OF A SIMPLE OSCILLATOR


ω
ω
+
=
=
=
x
x
a
t x
x
x
v
Undamped oscillator:
cos
; (0)
, (0)
n
2
0
0










ωω
ωω
ω
ω
ω
ω
ω
ω
ω
≠≠
=
+
+
−
−


x
x
t
v
t
X
a
t
t
F
For
:
cos
sin
cos
cos
n
n
n
n
n
n
0
0
2
2
ωω
ωω
ω
ω
(
)
=
=
+
x
X
at
t
For
resonance :
Same
2
sin
n







ζω
ω
ω
ω
ω
ζω ω
ω
φ
(
)
+
+
=
=
+
−
+
−
x
x
x
a
t
x
H
a
j
t
P
Damped oscillator :
2
cos
2
cos
n
n
n
n
2
2
2
where 
φ
ζω ω
ω
ω
φ
=
−
=
tan
2
;
phase lag
n
n
2
2
.
Particular solution P is also the steady-state response.
Homogeneous solution 
=
+
λ
λ
H
A e
A e
t
t
1
2
2
1
λ
λ
λ
ζω λ
ω
(
)
+
+
=
where, 
 and 
 are the roots of 
2
0   characteristic equation
n
n
1
2
2
2
A1 and A2 are determined from ICs: 

( )
( )
=
=
x
x
x
v
0
,
0
0
0
Resonant frequency: ω
ζ ω
=
−
1
2
r
n
2
The magnitude of P will peak at resonance.
Damping ratio: ζ
∆ω
ω
ω
ω
ω
ω
=
=
−
+
2
n
2
1
2
1
 for low damping
where Δω = half-power bandwidth = ω2 − ω1
Note: Q-factor 
ω
∆ω
ζ
=
= 1
2
n
 for low damping

454
Modeling of Dynamic Systems with Engineering Applications
9.5   Response Using Laplace Transform
Transfer function concepts are discussed in Chapter 6, and transform techniques are out-
lined in Appendix D. Once a transfer function model of a system is available, its response 
can be determined using the Laplace transform approach. The steps are as follows:
	
1.	Using the Laplace transform table (Appendix D), determine the Laplace transform 
(U(s)) of the input.
	
2.	Multiply by the transfer function (G(s)) to obtain the Laplace transform of the out-
put: 
=
Y s
G s U s
( )
( ) ( ).
	
	 Note: The ICs may be introduced in this step by first expressing the system equa-
tion in the polynomial form in s and then adding the ICs to each derivative term 
in the characteristic polynomial.
	
3.	Convert the expression in step 2 into a convenient form (e.g., by partial fractions).
	
4.	Using Laplace transform table, obtain the inverse Laplace transform of Y(s), which 
gives the response y(t).
Let us illustrate this approach by determining again the step response of a simple oscillator.
9.5.1   Step Response Using Laplace Transforms
Consider the oscillator system given by Equation 9.48:
	


ζω
ω
ω
+
+
=
y
y
y
u t
2
( )
n
n
n
2
2
	
(9.48)
Since ∠
=
U t
s
( )
1/ , the unit step response of the dynamic system (Equation 9.48), with zero 
ICs, can be obtained by taking the inverse Laplace transform of
	
ω
ζω
ω
ω
∆
=
+
+
=
Y
s
s s
s
s
s
( )
1
(
2
)
1
( )
step
n
n
n
n
2
2
2
2
	
(9.77a)
Here, the characteristic polynomial of the system is denoted as
	
∆
ζω
ω
=
+
+
s
s
s
( )
(
2
)
n
n
2
2 	
(9.78a)
To facilitate using the Laplace transform table, partial fractions of Equation 9.77a are deter-
mined in the form: 
	
ζω
ω
+
+
+
+
a
s
a
a s
s
s
(
2
)
n
n
1
2
3
2
2
in which the constants a
a
a
,
 and 
1
2
3 are determined by comparing the numerator 
polynomial:
	
ω
δω
ω
=
+
+
+
+
a s
s
s a
a s
(
2
)
(
)
n
n
n
2
1
2
2
2
3
We obtain 
ζω
=
= −
=
a
a
a
1,
2
, and
1
n
1
2
3
.
Hence

455
Response Analysis and Simulation
	
ζω
ζω
ω
ζω
∆
=
+
−
+
+
=
+
−
Y
s
s
s
s
s
s
s
s
( )
1
2
(
2
)
1
2
( )
step
n
n
n
n
2
2
	
(9.77b)
Next, using Laplace transform tables, the inverse transform of Equation 9.77b is obtained 
and verified to be identical to Equation 9.56.
9.5.2   Incorporation of ICs
When the ICs of the system are not zero, they have to be explicitly incorporated into the 
derivative terms of the system equation, when converting into the Laplace domain. Except 
for this, the analysis using the Laplace transform approach is identical to that with zero 
ICs. In fact, the total solution is equal to the sum of the solution with zero ICs and the 
solution corresponding to the initial-conditions. We will illustrate the approach using two 
examples.
Step Response of a First-Order System
Let us revisit the first-order dynamic system with time constant τ, input u, and output y, 
as given by
	

τ
+
=
y
y
u t( )	
(9.19)
The IC is y(0) = y0. A step input of magnitude A is applied at that IC.
From Laplace tables (see Appendix D), convert each term in Equation 9.19 into the Laplace 
domain as follows:
	
τ
−
+
=
sY s
y
Y s
A s
[
( )
]
( )
/
0
	
(9.79a)
Note how the IC is included in the derivative term, as clear from the Laplace tables. On 
simplification, we obtain
	
τ
τ
τ
τ
τ
τ
τ
=
+
+
+
=
+
+
−
+
Y s
y
s
A
s
s
y
s
A
s
A
s
( )
(
1)
(
1)
(
1)
(
1)
0
0
	
(9.79b)
Now we use the Laplace tables to determine the inverse Laplace transform each term in 
Equation 9.79b. We obtain
	
=
+
−
τ
τ
−
−
y
y e
Ak
e
(1
)
step
t
t
0
	
(9.80)
This is identical to the previous result (Equation 9.20). The response is plotted in Figure 9.10 
for different values of the time constant τ. Notice how the response becomes more sluggish 
(i.e., the response becomes slower) for larger values of the time constant.
Step Response of a Second-Order System
As another illustrative example revisit the simple oscillator problem:
	


ζω
ω
ω
+
+
=
y
y
y
u t
2
( )
n
n
n
2
2
	
(9.48)
Only the underdamped case is considered where 
ζ
<
<
0
1.

456
Modeling of Dynamic Systems with Engineering Applications
We use the Laplace transform approach to determine the response to a unit step input 
for the case with the ICs 

y
y
(0) and (0). First, use Laplace tables to convert each term in 
Equation 9.48 into the Laplace domain as follows:
	

ζω
ω
ω
−
−
+
−
+
=
s Y s
sy
y
sY s
y
Y s
s
( )
(0)
(0)
2
[
( )
(0)]
( )
n
n
n
2
2
2
	
(9.81a)
On simplification, we have
	

ω
∆
ζω
∆
=
+
+
+
Y s
s
s
sy
y
y
s
( )
1
( )
(0)
(0)
2
(0)
( )
n
n
2
	
(9.81b)
Here the characteristic polynomial is given by
	
∆
ζω
ω
ζω
ω
=
+
+
=
+
+
s
s
s
s
( )
(
2
)
(
)
n
n
n
d
2
2
2
2	
(9.78b)
where the damped natural frequency ω d is such that
	
ω
ζ
ω
=
−
(1
)
d
n
2
2
2	
(9.82)
The zero-state response (i.e., when the ICs are zero) corresponds to the first term on the 
RHS of Equation 9.81b, which can be determined as before by noting that
	
ω
∆
ζω
∆
ζω
∆
=
=
−
−
+
Y
s
s
s
s
s
s
s
( )
1
( )
1
( )
(
)
( )
Forced
n
n
n
2
	
(9.83)
From Laplace tables, the zero-state response (i.e., the forced part) is obtained as
	
ζω
ω
ζω
ω
ζω
ω
ζ
(
)
(
)
=
−
−
−
−
<
t
t
t
t
t
y
( )
1
exp
sin
exp
cos
for
1
n
d
n
d
n
d
Forced
 	
(9.84a)
Now, by combining the last two terms on the RHS, we obtain
0
Time t
A
Step response
y
y0
τ
FIGURE 9.10
Step response of a first-order system.

457
Response Analysis and Simulation
	
ζ
ζω
ω
φ
ζ
φ
ζ
(
)
(
)
=
−
−
−
+
<
=
y
t
t
t
( )
1
1
1
exp
sin
for
1
                                                              with  cos
Forced
n
d
2
	
(9.84b)
This result is identical to what we obtained before.
The response to the ICs is given by the second term on the RHS of Equation 9.81b. 
Specifically
	


ζω
∆
ζω
∆
ζω
∆
=
+
+
=
+
+
+
Y
s
sy
y
y
s
s
y
s
y
y
s
( )
(0)
(0)
2
(0)
( )
(
) (0)
( )
(0)
(0)
( )
IC
n
n
n
The terms in this result are similar to those in Equation 9.83. After term-by-term conver-
sion into the time domain using Laplace tables, we have
    

ζω
ω
ζω
ω
ζω
ω
ζ
(
)
(
)
=
−
+
+




−
<
y
t
y
t
t
y
y
t
t
( )
(0)exp
cos
(0)
(0) exp
sin
for
1
I C
n
d
n
d
n
d
	
(9.85)
The total response is given by the sum of Equations 9.84 and 9.85.
9.6   Determination of ICs for Step Response
When a step input is applied to a system, the initial values of the system variables may 
change instantaneously. However, not all variables will change in this manner since the 
value of a state variable cannot change instantaneously. We will illustrate some related 
considerations using an example.
Example 9.2
The circuit shown in Figure 9.11 consists of an inductor L, a capacitor C, and two resistors R 
and Ro. The input is the voltage ( )
v t
i
 and the output is the voltage vo across the resistor Ro.
	 (a)	 Obtain a complete state-space model for the system.
	 (b)	 Obtain an input–output differential equation for the system.
	 (c)	 Obtain expressions for undamped natural frequency and the damping ratio of 
the system.
	 (d)	 The system starts at steady state with an input of 5 V (for all t < 0). Then sud-
denly, the input is dropped to 1 V (for all t > 0), which corresponds to a step 
input as shown in Figure 9.12. For R = Ro = 1 Ω, L = 1 H, and C = 1 F, what are the 
ICs of the system and their derivatives at both t = 0− and t = 0+? What are the 
final (steady state) values of the state variables and the output variable? Sketch 
the nature of the system response.
Solution
	 (a)	
State variables:
Current through independent inductors (iL); Voltage across independent capacitors (vc)

458
Modeling of Dynamic Systems with Engineering Applications
	
=
=
=
=
v
L di
dt
i
C dv
dt
v
Ri
v
Ri
Constitutive equations:
;
;
;
L
L
C
C
R
L
o
o
First two equations are for independent energy storage elements, and they form the 
state-space shell.
Continuity equation:
	
(
)
−
−
=
i
i
i
Node A Kirchhoff’s current law :
0
L
C
o
Compatibility equations:
	
(
)
−
−
−
=
v
v
v
v
Loop 1 Kirchhoff’s voltage law :
0
i
R
L
C
	
(
)
−
=
v
v
Loop 2 Kirchhoff’s voltage law :
0
C
o
Eliminate auxiliary variables. We have the state equations:
	
=
=
−
−
=
−
−
L di
dt
v
v
v
v
v
Ri
v
L
L
i
R
C
i
L
C
	
=
=
−
=
−
=
−
C dv
dt
i
i
i
i
v
R
i
v
R
C
C
L
o
L
o
o
L
C
o
+
vi(t)
R
L
vR
vL
iL
iC
C
Ro
io
vo
+
Node
A
vC
Loop 1
Loop 2
–
–
FIGURE 9.11
An electrical circuit.
Input
vi(t)
Timet
1.0
5.0
0
FIGURE 9.12
A step input.

459
Response Analysis and Simulation
Final state equations:
	
=
−
−
+
di
dt
L
Ri
v
v
1 [
]
L
L
C
i 	
(i)
	
=
−




dv
dt
C i
v
R
1
C
L
C
o 	
(ii)
	
=
v
v
Output equation :
o
c
Vector-matrix representation: 
++
==
x = Ax
Bu; y
Cx
Model matrices:
System matrix 
=
−
−
−








A
R L
L
C
R C
/
1/
1/
1/(
)
o
; input gain matrix 
=






B
L
1/
0
;
measurement gain matrix 
= 

C
0
1
; state vector =  =








x
i
v
L
C
;
input =  =
u
v
[
]
i ; output =  =
y
v
[
]
o
(b)	
From Equation ii: 
=
+
i
C dv
dt
v
R
L
C
C
o
Substitute in Equation i for iL: 
+



= −
+



−
+
L d
dt C dv
dt
v
R
R C dv
dt
v
R
v
v
C
C
o
C
C
o
C
i
This simplifies to the input–output differential equation (since 
=
v
v
o
C)
	
+
+




+
+




=
LC d v
dt
L
R
RC dv
dt
R
R
v
v
1
o
o
o
o
o
i
2
2
	
(iii)
(c)	
The input–output differential equation is of the form
	
ζω
ω
+
+
=
d v
dt
dv
dt
v
LC v
2
1
o
n
o
n
o
i
2
2
2
Hence,
	
ω =
+




LC
R
R
Natural frequency
1
1
n
o
	
(iv)
	
ζ =
+




+




LC
R
R
L
R
RC
Damping ratio
1
2
1
o
o
	
(v)

460
Modeling of Dynamic Systems with Engineering Applications
Note: LC
1  has units of (frequency)2.
RC and L
Ro
 have units of “time” (i.e., time constant).
(d)	
	
(
)
<
=
=
ICs
t
di
dt
dv
dt
:
For
0 initial steady state :
0;
0
L
c
Hence
	
=
=
−
−
+
−
−
−
−
di
dt
L
Ri
v
v
(i)
(0 )
0
1 [
(0 )
(0 )
(0 )]
L
L
C
i
	
=
=
−






−
−
−
dv
dt
C i
v
R
(ii)
(0 )
0
1
(0 )
(0 )
C
L
C
o
Substitute the given parameter values R = Ro = 1 Ω, L = 1 H, and C = 1 F, and the input 
=
−
v (0 )
5.0
i
:
	
−
−
+
=
−
−
i
v
(0 )
(0 )
5
0
L
C
	
−
=
−
−
i
v
(0 )
(0 )
0
L
C
	
(
)
(
)
=
=
−
−
i
v
We obtain
0
2.5A,
0
2.5V
L
c
State variables cannot undergo step changes (because that violates the corresponding 
physical laws—constitutive equations). Specifically:
Inductor cannot have a step change in current (needs infinite voltage).
Capacitor cannot have a step change in voltage (needs infinite current).
Hence,
	
(
)
(
)
=
=
+
−
i
i
0
0
2.5A
L
L
	
(
)
(
)
=
=
+
−
v
v
0
0
2.5V
c
c
Note: Since 
=
+
v (0 )
1.0
i
	
= −
−
+
= −
−
+
= −
≠
+
+
+
di
dt
i
v
(i)
(0 )
(0 )
(0 )
1.0
2.5
2.5
1.0
4.0A/s
0
L
L
C
	
=
−
=
−
=
+
+
+
dv
dt
i
v
(ii)
(0 )
(0 )
(0 )
2.5
2.5
0.0V/s
C
L
C
Final values:

461
Response Analysis and Simulation
As t → ∞ (at final steady state): 
=
di
dt
0
L
; 
=
dv
dt
0
c
; and 
=
v
1.0
i
Substitute:
	
∞=
= −
∞−
∞+
di
dt
i
v
(i)
( )
0
( )
( )
1.0
L
L
C
	
∞=
=
∞−
∞
dv
dt
i
v
(ii)
( )
0
( )
( )
C
L
C
Solution: ( )
∞=
i
0.5 A
L
, ( )
∞=
V
v
0.5 
c
For the given parameter values
	
+
+
=
d v
dt
dv
dt
v
(iii)
2
2
1
o
o
o
2
2
Hence, ω =
2
n
 and ζω =
2
2,
n
 or ζ = 1/ 2
This is an underdamped system, producing an oscillatory response as a result. The 
nature of the responses of the two state variables is shown in Figure 9.13. Note: 
Output 
=
v
v
o
c.
LEARNING OBJECTIVES
	
1.	 State model of an electrical circuit
	
2.	 Input–output model of an electrical circuit
	
3.	 Analytical response (e.g., step response) of an electrical circuit
	
4.	 Natural frequency, damping ratio, and time constants of an electrical circuit
	
5.	 Some considerations of ICs in a state model
	
6.	 Steady-state behavior of a system
■
L
i
t
0.5
2.5
0
Slope = –4 A/s
vc = vo
t
0.5
2.5
0
Slope = 0 V/s
FIGURE 9.13
Responses of the state variables.

462
Modeling of Dynamic Systems with Engineering Applications
Example 9.3
A system is given by the transfer function 
ω
ζω
ω
=
+
+
y
u
s
s
2
n
n
n
2
2
2
where u = input; y = output; s = Laplace variable; and ζ ω
,
n are the system parameters.
	 (a)	 Write the input–output differential equation of the system.
	
	 It is well known that the response of this system to a unit step input with zero 
ICs: 

=
=
−
−
y
y
(0 )
0 and (0 )
0 is given by
	
ζ
ω
φ
ζ
=
−
−
+
≤
<
ζω
−
y
e
t
1
1
1
sin(
) for 0
1
t
d
2
n
	
	
ω
ζ ω
φ
ζ
=
−
=
where
1
and cos
d
n
2
	 (b)	 Determine 
+
y(0 ) and 
+
y(0 ) for this response.
	
	 Now consider the system given by the transfer function
	
ω
τ
ζω
ω
=
+
+
+
y
u
s
s
s
(
1)
(
2
)
n
n
n
2
2
2
	
	 where τ  is an additional system parameter. The remaining parameters are the 
same as those given for the previous system.
	 (c)	 Write the input–output differential equation for this modified system.
	 (d)	 Without using Laplace transform tables, but using the result given for the orig-
inal system, determine the response of the modified system to a unit step input 
with zero ICs: 

=
=
−
−
y
y
(0 )
0 and (0 )
0
	
	 The response must be expressed in terms of the given system parameters 
ω
ζ τ
(
, , )
n
.
	 (e)	 Determine 
+
y(0 ) and 
+
y(0 ) for this response. Comment on your result, if it is 
different from the values for 

=
=
−
−
y
y
(0 )
0 and (0 )
0.
Solution
(a)	
	
	 To obtain the input–output differential equation, represent the Laplace vari-
able “s” by the derivative operator “ d
dt
” in the given transfer function. We 
obtain
	
ζω
ω
ω
+
+
=
d y
dt
dy
dt
y
u
2
n
n
n
2
2
2
2 	
(i)
(b)	
	
	 By direct substitution of =
+
t
0  in the given response expression, we have
	
ζ
φ
ζ
ζ
=
−
−
=
−
−
×
−
=
−
=
+
y(0 )
1
1
1
sin
1
1
1
1
1
1
0
2
2
2
	
	 Now differentiate the given response expression. We have
	

ζ
ω
ω
φ
ζω
ω
φ
= −
−
+
−
+
ζω
ζω
−
−
y
e
t
e
t
1
1
[
cos(
)
sin(
)]
t
d
d
n
t
d
2
n
n

463
Response Analysis and Simulation
	
	 By substituting =
+
t
0  in this expression, we obtain
	

ζ
ω
φ
ζω
φ
ζ
ζ ω ζ
ζω
ζ
= −
−
−
= −
−
−
−
−



=
+
y(0 )
1
1
[
cos
sin ]
1
1
1
1
0
d
n
n
n
2
2
2
2
	 (c)	
	
	 As before, to obtain the input–output differential equation, represent the 
Laplace variable “s” by the derivative operator “ d
dt
” in the given transfer func-
tion. We obtain
	
ζω
ω
ω
τ
+
+
=
+




d y
dt
dy
dt
y
du
dt
u
2
n
n
n
2
2
2
2
	
(ii)
	 (d)	
	
	 Examine the two differential equations (i and ii). The left-hand sides are identi-
cal. The right-hand sides, which represent the input to the system, are differ-
ent, but the second corresponds to a linear superposition of the first. Since both 
systems are linear, from the “principle of superposition,” the forced response 
(i.e., with zero ICs) of system (Equation ii)—call it y—is obtained from the 
forced response of system (Equation i)—call it yo—as
	
τ
=
+
y
dy
dt
y
o
o	
(iii)
It is given that
	
ζ
ω
φ
=
−
−
+
ζω
−
y
e
t
1
1
1
sin(
)
o
t
d
2
n
	
(iv)
and from Part (b)
	

ζ
ω
ω
φ
ζω
ω
φ
= −
−
+
−
+
ζω
ζω
−
−
y
e
t
e
t
1
1
[
cos(
)
sin(
)]
o
t
d
d
n
t
d
2
n
n
	
(v)
Substitute Equations iv and v in Equation ii. We obtain
	
τ
ζ
ω
ω
φ
ζω
ω
φ
ζ
ω
φ
ζ
ω
φ
τ ω
ω
φ
ζω
ω
φ
ζ
ω
φ
τω
ζ
ω
φ
ζ
ω
φ
ζ
ω
φ
τω
φ
ω
φ
φ
ω
φ
{
}
{
}
{
}
= −
−
+
−
+


+ −
−
+
=
−
−
+
+
+
−
+


=
−
−
+
+
−
+
−
+




=
−
−
+
+
+
−
+


ζω
ζω
ζω
ζω
ζω
ζω
−
−
−
−
−
−
y
e
t
e
t
e
t
e
t
t
t
e
t
t
t
e
t
t
t
1
cos(
)
sin(
)
1
1
1
sin(
)
1
1
1
sin(
)
cos(
)
sin(
)
1
1
1
sin(
)
1
cos(
)
sin(
)
1
1
1
sin(
)
sin
cos(
)
cos sin(
)
t
d
d
n
t
d
t
d
t
d
d
d
n
d
t
d
n
d
d
t
d
n
d
d
2
2
2
2
2
2
n
n
n
n
n
n

464
Modeling of Dynamic Systems with Engineering Applications
or
	
ζ
ω
φ
τω
ω
=
−
−
+
−
ζω
−
y
e
t
t
1
1
1
[sin(
)
sin
]
t
d
n
d
2
n
	
(vi)
Note: The last step follows from the trigonometric identity
	
−
=
−
A
B
A
B
A
B
sin(
)
sin
cos
cos
sin
(e)	
Substitute =
+
t
0  in Equation vi. We obtain
	
ζ
φ
ζ
ζ
=
−
−
=
−
−
−



=
−
=
+
y(0 )
1
1
1
[sin ]
1
1
1
1
1
1
0
2
2
2
Next, differentiate Equation vi. We obtain
	

ζω
ζ
ω
φ
τω
ω
ζ
ω
ω
φ
τω ω
ω
=
−
+
−
−
−
+
−
ζω
ζω
−
−
y
e
t
t
e
t
t
1
[sin(
)
sin
]
1
1
[
cos(
)
cos
]
n
t
d
n
d
t
d
d
n
d
d
2
2
n
n
	
(vii)
Substitute =
+
t
0  in Equation vii. We obtain
	

ζω
ζ
φ
ζ
ω
φ
τω ω
ζω
ζ
ζ
ζ
ζ ω ζ
τω
ζ
ζω
ζω
τω
=
−
−
−
−
=
−
−



−
−
−
−
−




=
−
−
+
y(0 )
1
[sin ]
1
1
[
cos
]
1
1
1
1
1
1
[
]
n
d
n
d
n
n
n
n
n
n
2
2
2
2
2
2
2
2
2
or,
	

τω
=
+
y(0 )
n
2
Note: At =
+
t
0  we have 
=
+
y(0 )
0 but 
≠
+
y(0 )
0.
	
	 The reason for non-zero rate (or velocity, if y represents displacement) is as 
follows. When the input u is a step function, its derivative u is an impulse func-
tion. In the modified system (Equation ii), it is clear from the right-hand side 
that a linear combination of a step and an impulse are applied to the system 
(when u is a step function). The impulse input component results in an instan-
taneous change in y (or instantaneous change in velocity).
LEARNING OBJECTIVES
	
1.	 Transfer-function and input–output differential equation models
	
2.	 Determination of the analytical response of a linear system using its transfer 
function and Laplace transform tables
	
3.	 Some considerations of ICs and time response of a system
	
4.	 Time derivative of input and time derivative of response of a linear system ■

465
Response Analysis and Simulation
9.7   Computer Simulation
Simulation of the response of a dynamic system by using a digital computer is perhaps 
the most convenient and popular approach to the response analysis of complex (nonlinear, 
time-varying) systems. An important advantage is that any complex, nonlinear, and time-
variant system may be analyzed in this manner. The main disadvantage is that the solu-
tion is not analytic, and is valid only for a specific excitation, under the particular ICs, over 
a limited time interval, and so on. Of course, symbolic approaches of obtaining analytical 
solutions using a digital computer are available as well. We will consider here numerical 
simulation only.
The key operation of digital simulation is integration over time (also see Chapter 8). This 
typically involves integration of a differential equation of the form
	
 =
y
f y u t
( , , )	
(9.86)
where u is the input (excitation) and y is the output (response). Note that the function f is 
nonlinear and time-variant in general. The most straightforward approach to digital inte-
gration of this equation is by using trapezoidal rule, which is the Euler’s method, as given by
	
∆
=
+
=
…
+
y
y
f y
u t
t n
(
,
, )
0,1,
n
n
n
n
n
1
	
(9.87)
Here tn is the nth time instant, 
=
u
u t( )
n
n , 
=
y
y t( )
n
n ; and ∆t is the integration time step 
(∆=
−
+
t
t
t
n
n
1
). This approach is generally robust. But depending on the nature of the func-
tion f, the integration can be ill behaved. Also, ∆t has to be chosen sufficiently small.
For complex nonlinearities in f, a better approach of digital integration is the Runge–
Kutta method. In this approach, in each time step, first the following four quantities are 
computed:
	
=
g
f y
u t
(
,
, )
n
n
n
1
	
(9.88a)
	
∆
∆
=
+




+










+
g
f
y
g
t
u
t
t
2
,
,
2
n
n
n
2
1
1
2
	
(9.88b)
	
∆
∆
=
+




+










+
g
f
y
g
t
u
t
t
2
,
,
2
n
n
n
3
2
1
2
	
(9.88c)
	
∆
=
+
+
+
g
f
y
g
t u
t
[(
),
,
]
n
n
n
4
3
1
1 	
(9.88d)
Then, the integration step is carried out according to
	
∆
=
+
+
+
+
+
y
y
g
g
g
g
t
(
2
2
) 6
n
n
1
1
2
3
4
	
(9.89)
Note that 
∆
=
+




+
u
u t
t
2
n
n
1
2
.*
* MATLAB and Simulink are properties of Mathworks, Inc.

466
Modeling of Dynamic Systems with Engineering Applications
Other sophisticated approaches of digital simulation are available as well. Perhaps 
the most convenient computer-based approach to simulation of a dynamic model is by 
using a graphic environment that uses block diagrams. Several such environments are 
commercially available. One that is widely used is Simulink®, which is an extension to 
MATLAB®.
9.7.1   Use of Simulink in Computer Simulation
Perhaps the most convenient computer-based approach to simulation of a dynamic model 
is by using a graphic environment that uses block diagrams. Several such environments 
are commercially available. One that is widely used is Simulink1, and is available as 
an extension to MATLAB1. It provides a graphical environment for modeling, simulating, 
and analyzing dynamic linear and nonlinear systems. It is quite convenient. First, a suit-
able block diagram model of the system is developed on the computer screen and stored. 
The Simulink environment provides almost any block that is used in a typical block dia-
gram. These include transfer functions, integrators, gains, summing junctions, inputs (i.e., 
source blocks) and outputs (i.e., graph blocks or scope blocks). Such a block may be selected 
and inserted into the workspace as many times as needed by clicking and dragging using 
the mouse. These blocks may be converted as required, using directed lines. A block may 
be opened by clicking on it and the parameter values and text may be inserted or modified 
as needed. Once the simulation block diagram is generated in this manner, it may be run 
and the response may be observed through an output block (graph block or scope block). 
Since Simulink is integrated with MATLAB, data can be easily transferred between pro-
grams within various tools and applications.
Starting Simulink
First, enter the MATLAB environment. You will see the MATLAB command prompt >>. 
To start Simulink, enter the command: simulink. Alternatively, you may click on the 
"Simulink" button at the top of the MATLAB command window. The Simulink Library 
Browser window should now appear on the screen. Most of the blocks needed for model-
ing basic systems can be found in the subfolders of the main Simulink folder.
Basic Elements
There are two types of elements in Simulink: blocks and lines. Blocks are used to generate 
(or input), modify, combine, output, and display signals. Lines are used to transfer signals 
from one block to another.
Blocks: The subfolders below the Simulink folder show the general classes of blocks avail-
able for use. They are
•	 Continuous: Linear, continuous-time system elements (integrators, transfer func-
tions, state-space models, etc.)
•	 Discrete: Linear, discrete-time system elements (integrators, transfer functions, 
state-space models, etc.)
•	 Functions and tables: User-defined functions and tables for interpolating function 
values
•	 Math: Mathematical operators (sum, gain, dot product, etc.)

467
Response Analysis and Simulation
•	 Nonlinear: Nonlinear operators (Coulomb/viscous friction, switches, relays, etc.)
•	 Signals and systems: Blocks for controlling/monitoring signals and for creating 
subsystems
•	 Sinks: For output or display signals (displays, scopes, graphs, etc.)
•	 Sources: To generate various types of signals (step, ramp, sinusoidal, etc.)
Blocks may have zero or more input terminals and zero or more output terminals.
Lines: A directed line segment transmits signals in the direction indicated by its arrow. 
Typically, a line must transmit signals from the output terminal of one block to the input 
terminal of another block. One exception to this is, a line may be used to tap off the signal 
from another line. In this manner, the tapped original signal can be sent to other (one or 
more) destination blocks. However, a line can never inject a signal into another line; com-
bining (or summing) of signals has to be done by using a summing junction. A signal can 
be either a scalar signal (single signal) or a vector signal (several signals in parallel). The 
lines used to transmit scalar signals and vector signals are identical; whether it is a scalar 
or vector is determined by the blocks connected by the line.
Building an Application
To build a system for simulation, first bring up a new model window for creating the 
block diagram. To do this, click on the “New Model” button in the toolbar of the Simulink 
Library Browser. Initially, the window will be blank. Then, build the system using the fol-
lowing three steps:
	
1.	Gather blocks.
	
	 From the Simulink Library Browser, collect the blocks you need in your model. 
This can be done by simply clicking on a required block and dragging it into your 
workspace.
	
2.	Modify the blocks.
	
	 Simulink allows you to modify the blocks in your model so that they accurately 
reflect the characteristics of your system. Double-click on the block to be modified. 
You can modify the parameters of the block in the “Block Parameters” window. 
Simulink gives a brief explanation of the function of the block in the top portion of 
this window.
	
3.	Connect the blocks.
	
	 The block diagram must accurately reflect the system to be modeled. The selected 
Simulink blocks have be properly connected by lines, to realize the correct block 
diagram. Draw the necessary lines for signal paths by dragging the mouse from 
the starting point of a signal (i.e., output terminal of a block) to the terminating 
point of the signal (i.e., input terminal of another block). Simulink converts the 
mouse pointer into a crosshair when it is close to an output terminal, to begin 
drawing a line, and the pointer will become a double crosshair when it is close 
enough to be snapped to an input terminal. When drawing a line, the path you fol-
low is not important. The lines will route themselves automatically. The terminals 
points are what matter. Once the blocks are connected, they can be moved around 
for neater appearance. A block can be simply clicked dragged to its desired loca-
tion (the signal lines will remain connected and will re-route themselves).

468
Modeling of Dynamic Systems with Engineering Applications
	
	
It may be necessary to branch a signal and transmit it to more than one input 
terminal. To do this, first placing the mouse cursor at the location where the sig-
nal is to be branched (tapped). Then, using either the CTRL key in conjunction 
with the left mouse button or just the right mouse button, drag the new line to its 
intended destination.
Running a Simulation
Once the model is constructed, you are ready to simulate the system. To do this, go to the 
Simulation menu and click Start, or just click the “Start/Pause Simulation” button in the 
model window toolbar (this will look like the “Play” button on a VCR). The simulation will 
be carried out and the necessary signals will be generated.
General tips:
•	 You can save your model by selecting Save from the file menu and clicking the OK 
button (you should give a name to a file).
•	 The results of a simulation can be sent to the MATLAB window by the use of the 
“to workshop” icon from the Sinks window.
•	 Use the Demux (i.e., demultiplexing) icon to convert a vector into several scalar 
lines. The Mux icon takes several scalar inputs and multiplexes them into a vector. 
This is useful, for example, when transferring the results from a simulation to the 
MATLAB workspace).
•	 A sign of a Sum icon may be changed by double clicking on the icon and changing 
the sign. The number of inputs to a Sum icon may be changed by double clicking 
on the icon and correctly setting the number of inputs in the window.
•	 Be sure to set the integration parameters in the simulation menu. In particular, 
the default minimum and maximum step sizes must be changed (they should be 
around 1/100 to 1/10 of the dominant (i.e., slowest) time constant of your system).
Example 9.4
Consider the time-domain model given by:
	






+
+
+
=
+
+
+
y
y
y
y
u
u
u
u
13
56
80
6
11
6
We build the Simulink model, as given in Figure 9.14a.
LEARNING OBJECTIVES
	
1.	 Computer simulation of an analytical dynamic model
	
2.	 Use of the simulation software tool Simulink	
■
Example 9.5
Consider the model of a robotic sewing system, as studied in Figure 9.15a.
With the state vector 
ω
= 

x
f
v
f
v
r
r
h
c
c
T
; the input vector u = 




T
f
r
f
T
; and the output vector 
ω
= 

f
y
c
r
T
, the following state-space 
model is obtained:

469
Response Analysis and Simulation
	
 =
+
=
+
x
Ax
Bu
y
Cx
Du
;
where
=
−
−
−
−
+
−
−
−


















=


















= 





=
A
B
C
D
r b
J
r J
rk
k
m
b
b
m
m
b
m
k
k
b
m
m
b
m
J
m
0
0
0
0
0
0
0
1
(
)
1
0
0
0
0
0
1
;
1
0
0
0
0
0
0
0
0
1
0
0
0
1
0
1
0
0
0
0
;
0
r
r
r
r
r
h
c
h
h
h
c
h
c
c
c
c
c
c
c
r
c
2
u
Output
1
s
1
s
1
s
Input
80
13
56
6
11
6
0
2
4
6
8
10
–1
–0.8
–0.6
–0.4
–0.2
0
0.2
0.4
0.6
0.8
1
Output
Time (s)
Output
0
2
4
6
8
10
0
0.2
0.4
0.6
0.8
1
Input
Time (s)
Input
(a)
(b)
FIGURE 9.14  
The system response to an impulse input is shown in Figure 9.14b.

470
Modeling of Dynamic Systems with Engineering Applications
bh
mh
kr
bc
(Normally
compressed)
Hand
Robot
mc
br
kc
fc
fr
ff, vf
Feeder
element
Cloth panel
vc
Jr
Rack
Pinion
Tr
vh
Torque
x΄ = Ax + Bu
y = Cx + Du
State-space
Output force
Output angular velocity
Input torque
Input force
Force
ωm
(a)
(b)
0
5
10
15
20
–1.5
–1
–0.5
0
0.5
1
1.5
Output force 
Time (s)
Output force (N)
0
5
10
15
20
0
0.5
1
1.5
Input force 
Time (s)
Input force (N)
0
5
10
15
20
0
0.5
1
1.5
Input torque 
Time (s)
Input torque (N)
0
5
10
15
20
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
Output angular velocity
Time (s)
Output angular velocity (rad/s)
(c)
FIGURE 9.15
(a) A robotic sewing system. (b) Simulink model of a robotic sewing machine. (c) Simulation results.

471
Response Analysis and Simulation
To carry out a simulation using Simulink, we use the following parameter values:
mc = 0.6 kg
kc = 100 N/m
bc = 0.3 N/m/s
mh = 1 kg
bh = 1 N/m/s
kr = 200 N/m
br = 1 N/m/s
Jr = 2 kg·m2
r = 0.05 m
The matrices of the linear model are obtained as
	
=
−
−
−
−
−
−














=














= 





= 





A
B
C
D
0.00125
0.025
0
0
0
10
0
200
0
0
0
1
1.3
1
0.3
0
0
100
0
100
0
0
0.5
1.67
0.5
;   
0.5
0
0
0
0
0
0
0
0
1.67
  
 
0
0
0
1
0
1
0
0
0
0
;   
0
0
0
0
The Simulink model is built, as shown in Figure 9.15b.
The response of the system to two impulse inputs is shown in Figure 9.15c.
LEARNING OBJECTIVES
	
1.	 Computer simulation of a somewhat complex state model
	
2.	 Use of the simulation software tool Simulink in response studies	
■
Summary Sheet
Homogeneous system: 

+
+
+
=
−
−
−
a d y
dt
a
d
y
dt
a y
0
n
n
n
n
n
n
1
1
1
0
 → Characteristic equation 

λ
λ
+
+
+
=
−
−
a
a
a
0
n
n
n
n
1
1
0
 with n roots λi.
Homogeneous solution:
	
…
…
λ
λ
=
+
+
+
=
+
+
+
+
=
λ
λ
λ
λ
λ
λ
y
c e
c e
c e
y
c
c t e
c e
c e
;
(
)
if
h
t
t
n
t
h
t
t
n
t
1
2
1
2
3
1
2
n
n
1
2
1
3
Particular solution: yp.(particular output for an input); e.g., output A for input c; At + B for 
ct + d; 
+
A
ct
A
ct
sin
cos
1
2
 for sin ct; 
+
B
ct
B
ct
sin
cos
1
2
 for cos ct; Dect for ect

472
Modeling of Dynamic Systems with Engineering Applications
Total response: y = Homogeneous solution (H) + Particular solution (P) = Free response 
(X) + Forced response (F) = Initial-condition response (X) + Zero-initial-condition response 
(F) = Zero-input response (X) + Zero-state response (F). Note: In general, H ≠ X and P ≠ F.
At steady state F → P
Impulse input: Dirac delta function, δ
τ
τ
−
=
≠
t
t
(
)
0
for
 and 
τ
→∞
=
t
at
.
Also, ∫δ
τ
−
=
−∞
∞
t
dt
(
)
1; ∫
δ
τ
τ
−
=
−∞
∞
f t
t
dt
f
( ) (
)
( ); ∫
δ
τ
−
=
τ
−∞
∞
=
d f t
dt
t
dt
d f t
dt
( ) (
)
( )
n
n
n
n
t
Impulse-response function: h(t) = response to input unit impulse δ t( )
Convolution integral: 
∫
∫
τ
τ
τ
τ
τ
τ
=
−
=
−
∞
∞
y t
h t
u
d
h
u t
d
( )
(
) ( )
( ) (
)
0
0
Note: System transfer function H(s) = Laplace transform of h(t)
First-order system: 
τ
+
=
y
y
u t( ); 
=
τ
−
y
ce
h
t , =
+
=
+
τ
−
y
y
y
ce
A
h
p
t
 (for step input);
	






 




=
−
+
=
+
−
τ
τ
τ
−
−
−
y
y
A e
A
y e
A
e
(
)
(1
)
step
t
y
y
t
y
t
y
0
Homogeneous
         
Particular
       
0
Free response
        
Forced response
           
h
p
x
f
; at steady state yss = A
	
τ
=
+
τ
τ
−
−
y
y e
P e
impulse
t
t
0
. Note: 
=
d
dt (Step function)
Impulse function
Second-order system: 

ζω
ω
ω
+
+
=
x
x
x
u
2
n
n
n
2
2 ; characteristic equation λ
ζω λ
ω
+
+
=
2
0
n
n
2
2
 
→ Roots λ
λ
ζω
ζ
ω
= −
±
−
and
1
n
n
1
2
2
Free response: 
λ
λ
λ
λ
λ
=
+
≠
=
+
=
=
λ
λ
λ
x
C e
C e
x
C
C t e
for
;
(
)
for
t
t
t
1
2
1
2
1
2
1
2
1
2
ICs: 

=
=
x
x
v
(0)
and x(0)
0
0
Underdamped case (ζζ << 1):
	
ω
ω
ω
φ
φ
(
)
(
)
(
)
(
)
=
+


=
+


=
+
=
+
=
−
=
−
=
+
=
+
=
ζω
ω
ω
ζω
ζω
−
−
−
−
e
C e
C e
e
A
t
A
t
Ae
t
A
C
C
A
j C
C
C
A
jA
C
A
jA
A
A
A
A
A
x
  
cos
sin
  
sin
and
1
2
and
and tan 
t
j
t
j
t
t
d
d
t
d
1
2
1
2
1
1
2
2
1
2
1
1
2
2
1
2
1
2
1
2
2
2
2
n
d
d
n
n
1
with 
ζω
ω
=
=
+
A
x
A
v
x
and
o
o
n
o
d
1
2
Overdamped case (ζ > 1): Poles are real and negative: λ λ
ζω
ζ
ω
= −
±
−
,
1
n
n
1
2
2
;
	
λ
λ
λ
λ
λ
λ
=
+
=
−
−
=
−
−
λ
λ
x
C e
C e
C
v
x
C
v
x
with
and
t
t
1
2
1
0
2
0
1
2
2
0
1
0
2
1
1
2
Critically damped case (ζ = 1): Two identical poles: λ
λ
λ
ω
=
=
= −
n
1
2
	
ω
(
)
=
+
=
=
+
ω
−
x
C
C t e
C
x
C
v
x
with
and
t
n
1
2
1
0
2
0
0
n

473
Response Analysis and Simulation
Forced response:
	
ω
ζ
ζω
ω
ζ
=
=
−
−
<
y
t
h t
t
t
( )
( )
1
exp(
)sin
for
1
impulse
n
n
d
2
	
ω
ζ
λ
λ
ζ
=
=
−
−


>
y
t
h t
t
t
( )
( )
2
1
exp
exp
for
1
impulse
n
2
1
2
	
ω
ω
ζ
=
=
−
=
y
t
h t
t
t
( )
( )
exp(
) for
1
impulse
n
n
2
	
ζ
ζω
ω
ϕ
ζ
=
−
−
−
+
<
y
t
t
t
( )
1
1
1
exp(
)sin(
) for
1
step
n
d
2
	
ζ ω
λ
λ
λ
λ
ζ
=
−
−
−


>
y
t
t
1
1
2 1
exp
exp
for
1
step
n
2
1
2
2
1
	
ω
ω
ζ
=
−
+
−
=
y
t
t
1
(
1)exp(
) for
1
step
n
n
with 
φ
ζ
=
cos
Harmonic excitation
Undamped 
system: 

ω
ω
+
=
x
x
a
t
cos
n
2
 
with 
ω
ω
ω
ω
≠
=
+
x
A
t
A
t
:
cos
sin
n
h
n
n
1
2
; 
ω
ω
ω
=
−
x
a
t
(
) cos
p
n
2
2
Complete response: 



 




ω
ω
ω
ω
ω
ω
ω
ω
=
−
−




+
+
−
x
x
a
t
v
t
a
t
(
) cos
sin
cos
Homogeneous Solution.
Particular Solution.
o
n
n
o
n
n
H
n
P
2
2
2
2
	















ω
ω
ω
ω
ω
ω
ω
(
)
(
)
=
+
+
−
−


ω
ω
ω
ω
+
−
x
t
v
t
a
t
t
x
x
cos
sin
(
) cos
cos
Free response
*Forced response depends on input
Depends only on ICs
Comes from both
 and 
o
n
o
n
n
X
n
n
t
t
F
h
p
2
2
2sin (
)
2
sin (
)
2
n
n











ω
ω
ω
ω
ω
ω
ω
ω
(
)
(
)
+
=
=
+
+
x
x
a
t x
x
t
v
t
at
t
For :
cos
:
cos
sin
2
sin
Free response depends on ICs
Forced response depends on input
*Sinusoidal with frequency 
* Amplitude increases linearly
o
o
X
F
2

474
Modeling of Dynamic Systems with Engineering Applications
Damped system: 

ζω
ω
ω
+
+
=
=
x
x
x
a
t
u t
2
cos
( )
n
n
2
	
ω
ω
ζ
ω
ω
{
}
=
+
=
=
x
a
t
a
t
cos
sin
Except for the case :
0 and
p
n
1
2
Total response 





ω
ω
ζω ω
ω
φ
(
)
=
+
−
+
−
x
H
a
j
t
P
2
cos
n
n
2
2
. Note: H is as before.
Resonant frequency: ω
ζ ω
=
−
1
2
r
n
2
; response magnitude will peak at resonance.
Damping ratio: ζ
∆ω
ω
ω
ω
ω
ω
=
=
−
+
2
n
2
1
2
1  for low damping; Δω = half-power bandwidth = ω2 − ω1
Response using Laplace transform: 
=
Y s
G s U s
( )
( ) ( ); substitute for G and U → Y. Use 
Laplace tables to find y(t) from Y(s) (inverse Laplace).
Damped oscillator: 
ω
ζω
ω
ω
∆
ζω
ζω
ω
ζω
∆
=
+
+
=
=
+
−
+
+
=
+
−
Y
s
s s
s
s
s
s
s
s
s
s
s
s
( )
1
(
2
)
1
( )
1
2
(
2
)
1
2
( )
step
n
n
n
n
n
n
n
n
2
2
2
2
2
2
Runge–Kutta method: Compute 
=
g
f y
u t
(
,
, )
n
n
n
1
; 
∆
∆
=
+




+










+
g
f
y
g
t
u
t
t
2
,
,
2
n
n
n
2
1
1
2
;
	
∆
∆
∆
=
+




+










=
+
+
+
+
g
f
y
g
t
u
t
t
g
f
y
g
t u
t
2
,
,
2
;
[(
),
,
]
n
n
n
n
n
n
3
2
1
2
4
3
1
1
Integration step: 
∆
=
+
+
+
+
+
y
y
g
g
g
g
t
(
2
2
) 6
n
n
1
1
2
3
4
. Note: 
∆
=
+




+
u
u t
t
2
n
n
1
2
.
Problems
9.1	
The unit step response of a system with zero ICs was found to be 
−
−e
1.5(1
)
t
10 . 
What is the input–output differential equation of the system? What is the transfer 
function?
9.2	
Discuss why the convolution integrals given below (where u is the input, y is the 
output, and h is the impulse response function) are all identical.
	
∫
τ
τ
τ
=
−
∞
y t
h
u t
d
( )
( ) (
)
0
	
∫
τ
τ
τ
=
−
−∞
∞
y t
h t
u
d
( )
(
) ( )

475
Response Analysis and Simulation
	
∫
τ
τ
τ
=
−
−∞
∞
y t
h
u t
d
( )
( ) (
)
	
∫
τ
τ
τ
=
−
−∞
y t
h t
u
d
( )
(
) ( )
t
	
∫
τ
τ
τ
=
−
−∞
y t
h
u t
d
( )
( ) (
)
t
	
∫
τ
τ
τ
=
−
y t
h t
u
d
( )
(
) ( )
t
0
	
∫
τ
τ
τ
=
−
y t
h
u t
d
( )
( ) (
)
t
0
9.3	
A system at rest is subjected to a unit step input U t( ). Its response is given by
	
=
−
−
y
e
t
t U t
2
(cos
sin ) ( )
t
	
(a)	 Write the input–output differential equation for the system.
	
(b)	 What is its transfer function?
	
(c)	 Determine the damped natural frequency, the undamped natural fre-
quency, and the damped ratio.
	
(d)	 Write the response of the system to a unit impulse and sketch it.
9.4	
Consider the dynamic system given by the transfer function
	
=
+
+
+
Y s
U s
s
s
s
( )
( )
(
4)
(
3
2)
2
	
(a)	 Plot the poles and zeros of the systems on the s-plane.
	
(b)	 Indicate the correct statement among the following:
	
(i)	
The system is stable.
	
(ii)	
The system is unstable.
	
(iii)	
The system stability depends on the input.
	
(iv)	
None of the above.
	
(c)	 Obtain the system differential equation.

476
Modeling of Dynamic Systems with Engineering Applications
	
(d)	 Using the Laplace transfer technique, determine the system response y(t) to 
a unit step input with zero ICs.
9.5	
A dynamic system is represented by the transfer function
	
ω
ζω
ω
=
=
+
+
Y s
U s
G s
s
s
( )
( )
( )
2
n
n
n
2
2
2
	
(a)	 Is the system stable?
	
(b)	 If the system is given an impulse input, at what frequency will it oscillate?
	
(c)	 If the system is given a unit step input, what is the frequency of the result-
ing output oscillations? What is its steady-state value?
	
(d)	 The system is given the sinusoidal input.
	
ω
=
u t
a
t
( )
sin
Determine an expression for the output y(t) at steady state in terms of a, ω, ωn, and ς. At 
what value of ω will the output y(t) be maximum at steady state?
9.6	
A system at rest is subjected to a unit step input µ t( ). Its response is given by
	
µ
=
−
y
e
t
t
[2
sin ]
)
t
	
(a)	 Write the input–output differential equation for the system.
	
(b)	 What is its transfer function?
	
(c)	 Determine the damped natural frequency, the undamped natural fre-
quency, and the damped ratio.
	
(d)	 Write the response of the system to a unit impulse and find y(0+).
	
(e)	 What is the steady-state response for unit step input?
9.7
	
(a)	 Define the following terms with reference to the response of a dynamic 
system:
	
(i)	
Homogeneous solution
	
(ii)	
Particular solution
	
(iii)	
Zero-input (or free) response
	
(iv)	
Zero-state (or forced) response
	
(v)	
Steady-state response
	
(b)	 Consider the first-order system:
	
τ
+
=
dy
dt
y
u t( )

477
Response Analysis and Simulation
in which u is the input, y is the output, and τ is a system constant.
	
(i)	 Suppose that the system is initially at rest with u = 0 and y = 0, and suddenly 
a unit step input is applied. Obtain an expression for the ensuing response 
of the system. Into which of the above five categories does this response 
fall? What is the corresponding steady-state response?
	
(ii)	 If the step input in Part (i) is of magnitude A, what is the corresponding 
response?
	
(iii)	 If the input in Part (i) was an impulse of magnitude P, what would be the 
response?
9.8	
An “iron butcher” is a head-cutting machine that is commonly used in the fish 
processing industry. Millions of dollars’ worth of salmon is wasted annually due 
to inaccurate head-cutting using these somewhat outdated machines. The main 
cause of wastage is the “overfeed problem.” This occurs when a salmon is inac-
curately positioned with respect to the cutter blade so that the cutting location is 
beyond the collar bone and into the body of a salmon. An effort has been made to 
correct this situation by sensing the position of the collar bone and automatically 
positioning the cutter blade accordingly.
	
	
A schematic representation of an electromechanical positioning system of a 
salmon-head cutter is shown in Figure P9.8a. Positioning of the cutter is achieved 
through a lead screw-and-nut arrangement, which is driven by a brushless dc 
motor. The cutter carriage is integral with the nut of the lead screw and the ac 
motor, which drives the cutter blade, and it has an overall mass of m (kg). The 
carriage slides along a lubricated guideway and provides an equivalent viscous 
damping force of damping constant b (N/m/s). The overall moment of inertia of 
the motor rotor and the lead screw is J (N∙m2) about the axis of rotation. The motor 
is driven by a drive system that provides a voltage v to the stator field windings 
of the motor. Note that the motor has a permanent magnet rotor. The interaction 
between the field circuit and. the motor rotor is represented by Figure P9.8b.
	
	
The magnetic torque Tm generated by the motor is given by 
=
T
k i
m
m f. The force 
FL exerted by the lead screw in the y-direction of the cutter carriage is given by 
=
F
e
hT
L
L
, in which
	
=
h
Translatory motion of the nut
Rotatory motion of lead screw
	
	
and e is the mechanical efficiency of the lead screw-nut unit. The remaining 
parameters and variables, as indicated in Figure P9.8, should be self-explanatory.
	
(a)	 Write the necessary equations to study the displacement y of the cutter 
in response to an applied voltage v to the motor. What is the order of the 
system? Obtain the input–output differential equation for the system, and 
from that, determine the characteristic equation. What are the roots (poles 
or eigenvalues) of the characteristic equation?

478
Modeling of Dynamic Systems with Engineering Applications
	
(b)	 Using summation junctions, integration blocks, and constant gain blocks 
only, draw a complete block diagram of the system, with v as the input and 
y as the output.
	
(c)	 Obtain a state-space model for the system, using v as the input and y as the 
output.
	
(d)	 Assume that L/R ratio is very small and can be neglected. Obtain an 
expression for the response y of the system to a step input with zero ICs. 
Show from this expression that the behavior of the system is unstable in 
the present form (i.e., without feedback control).
9.9	
Consider the two-mass system shown in Figure P9.9.
	
(a)	 What is the transfer function x
f
/
1
?
	
(b)	 For a harmonic excitation f(t), at what frequency will m1 be motionless?
9.10	 When two dissimilar metal wires are jointed at the two ends to form a loop, and 
one junction is maintained at a different temperature from the other, a voltage is 
generated between the two junctions. A temperature sensor that makes use of 
Brushless
dc motor
Motor drive
system
Nut
Lead screw
Cutter carriage
Inertia = J
Mass = m
Cutter
motor
(ac)
Cutter
blade
Salmon
Conveyor
Guideway
(Damping constant = b)
y
(a)
if
J
R
L
Supply
voltage
v
Rotor
(b)
FIGURE P9.8
(a) A positioning system for an automated fish cutting machine; (b) the field circuit of the permanent-magnet rotor dc 
motor.

479
Response Analysis and Simulation
this property is the thermocouple. The cold junction is maintained at a known 
temperature (say, by dipping into an ice-water bath). The hot junction is then used 
to measure the temperature at some location. The temperature of the hot junc-
tion (T) does not instantaneously reach that of the sensed location (Tf), in view 
of the thermal capacitance of the junction. Derive an expression for the thermal 
time constant of a thermocouple in terms of the following parameters of the hot 
junction:
m = mass of the junction
c = specific heat of the junction
h = heat transfer coefficient of the junction
A = surface area of the junction
9.11	 Consider again Problem 5.11 (Figure P5.11).
	
	 Defining the time constants τ = C Rp
1
1
 and τ = C Ro
2
2
 and the gain parameter 
=
k
R
R
o
p, express the characteristic equation of the system in terms of these three 
parameters.Show that the poles of the system are real and negative but the system 
is coupled (interacting).
	
	 Suppose that the two tanks are as in Figure P5.11b. Here, Tank 1 has an outlet valve 
at its bottom whose resistance is Rt and the volume flow rate is Qt when open. This 
flow directly enters Tank 2 without a connecting pipe. The remaining characteris-
tics of the tanks are the same as in Part (b). 
	
	 Derive a state-space model for the modified system in terms of the same vari-
ables as in Part (b). With τ = C Rt
1
1
, τ = C Ro
2
2
, and =
k
R
R
o
t, obtain the characteristic 
equation of this system. What are the poles of the system? Show that the modified 
system is non-interacting.
9.12	 Consider again Problem 5.12 in Chapter 5 (Figure P5.12). Obtain expressions for 
the undamped natural frequency and the damping ratio of the linear model in 
terms of the parameters a, v, m, and k. Show that the damping ratio increases with 
the operating speed.
9.13	 Consider the fluid oscillation problem in Example 3.7 (Figure 3.15). What is the 
characteristic equation of this system? Using the following numerical values for 
the system parameters: 
	
=
=
=
=
L
L
d
d
10.0 m,
4.0 m,
0.025 m,
0.02 m
v
h
v
h
f(t)
k
x1
x2
m1
m2
FIGURE P9.9
A two-car train.

480
Modeling of Dynamic Systems with Engineering Applications
	
ρ
µ
=
=
×
⋅
=
1000.0 kg/m ,
1.0
10
N s/m , and tank diameter
0.5 m
3
–3
2
compute the undamped natural frequency 
ωn and the damping ratio ς of the system. Will this system provide an oscillatory natural 
response? If so, what is the corresponding frequency? If not, explain the reasons.
9.14	 The circuit shown in Figure P9.14 consists of an inductor L, a capacitor C, and two 
resistors R and Ro. The input is the source voltage ( )
v t
s
, and the output is the volt-
age vo across the resistor Ro.
	
(a)	 Explain why the current iL through the inductor and the voltage vC across 
the capacitor are suitable state variables for this circuit.
	
(b)	 Using iL and vC as the state variables, obtain a complete state-space model 
for the system. Specifically, express system equations in the vector-matrix 
form:
	
 =
+
x
Ax
u
B
	
=
y
Cx
Du
+
	
in the usual notation, where x is the state vector, u is the input vector, and y is the 
output vector, and determine all the elements of the four matrices A, B, C, and D 
in terms of the circuit parameters R, Ro, L, and C. 
	
(c)	 The system starts at steady state with a source voltage of 1 V (for all t < 0). 
Then, suddenly, the source voltage (i.e., input) is increased to 10 V (for all 
t > 0), which corresponds to a step input. For R = Ro = 1 Ω, L = 1 H, and C = 1 
F, determine the numerical values of the ICs of the following system vari-
ables at both t = 0− and t = 0+:
	
(i)	
Voltage vL across the inductor
	
(ii)	
Current iC through the capacitor
	
(iii)	
Current i through the resistor R
	
(iv)	
Current iL
R
L
C
vs
dc
vC
vR
vL
vRo = vo
Ro
Loop
1
Loop
2
A
i
iL
iC
FIGURE P9.14
An electrical circuit with R, L, and C elements.

481
Response Analysis and Simulation
	
(v)	
Voltage vC
	
(vi)	
Output voltage vo
Hint: A state variable cannot change its value instantaneously.
9.15	 Consider the linear system with constant coefficients, expressed in the time 
domain as
	
+
+
=
+
+
+
a d y
dt
a dy
dt
a y
b d u
dt
b d u
dt
b du
dt
b u
2
2
2
1
0
3
3
3
2
2
2
1
0
u = input to the system
y = output of the system
The coefficients ai and bj are constants and they are the system parameters.
	
	 The system may be represented in the block-diagram form as in Figure P9.15, with 
the transfer function G(s).
	
(a)	
What is the order of the system? Give reasons.
	
(b)	
Express the transfer function of the system in terms of the system parameters.
	
(c)	
What is the characteristic equation of the system? Explain your result.
	
(d)	
Derive expressions for the poles of the system in terms of the given system 
parameters.
	
(e)	
If a0 > 0, a1 > 0 and a2 > 0, discuss the stability of the system.
	
(f)	
First, assume that the coefficients b3, b2, and b1 are zero and b0 = 1. Then the 
“forced” (i.e., zero IC) response of this modified system for some input u(t) 
is denoted by x(t). Now, if b3, b2, and b1 are all non-zero, and b0 ≠ 1, express in 
terms of x(t) and the system parameters, the response of this system to the 
same input u(t) as before (with zero ICs). Clearly indicate the reasons behind 
your answer.
	
(g)	
If b3 ≠ 0, discuss the “physical realizability” of the system.
	
Note: Give all details of your derivations. If you use new parameters or variables or 
any notation other than what is given in the problem, they have to be defined.
9.16
	
(a)	
Answer “true” or “false” for the following:
The order of a system is equal to
G(s)
System
Input u
Output y
FIGURE P9.15
Block diagram of the system.

482
Modeling of Dynamic Systems with Engineering Applications
	
(i)	 The number of states in a state-space model of the system.
	
(ii)	 The order of the input–output differential equation of the system.
	
(iii)	 The number of ICs needed to completely determine the time response of 
the system.
	
(iv)	 The number of independent energy-storage elements in a lumped-parame-
ter model of the system.
	
(v)	 The number of independent energy storage elements and energy dissipa-
tion elements in a lumped-parameter model of the system.
	
(b)	
	
	
A fluid pump has an impeller of moment of inertia J and is supported on fric-
tionless bearings. It is driven by a powerful motor at speed ωm, which may be 
treated as a velocity source, through a flexible shaft of torsional stiffness K. The 
fluid load to which the pump impeller is subjected may be approximated by a 
load torque ω ω
c
, where ω is the speed of the pump impeller. A schematic dia-
gram of the system is shown in Figure P9.16a, and a lumped parameter model 
is shown in Figure P9.16b.
9.17	 Consider the simple oscillator shown in Figure P9.17, with parameters 
=
m
4 kg, =
×
k
1.6
10 N/m
3
, and the two cases of damping:
	
=
b
1.
80 N/m/s
	
=
b
2.
320 N/m/s
(Velocity source)
Motor
Flexible
shaft
Pump
(Inertial and fluid 
resistance torque)
Fluid in
Fluid out
(a)
ω
ωm
K
J
Fluid resistance torque
cω ω
(b)
τ
FIGURE P9.16
(a) A pump driven by a powerful motor; (b) a lumped-parameter model.

483
Response Analysis and Simulation
	
	 Using MATLAB, determine the free response in each case for an IC excitation.
9.18	 Consider the following equation of motion of the single-degree-of-freedom sys-
tem (damped simple oscillator) shown in Figure P9.17:
x
b
k
m
FIGURE P9.17
A damped simple oscillator.
In5 Out5
zeta = 2
In4 Out4
zeta = 1
In3 Out3
zeta = 0.5
In2 Out2
zeta = 0.3
In1 Out1
zeta = 0
Step
Scope
1
Out2
1
s
1
s
–K–
6
–K–
1
In2
(a)
(b)
FIGURE P9.18
Use of Simulink to obtain the step response of a simple oscillator. (a) Overall Simulink model; (b) Simulink submodel for 
each case of damping.

484
Modeling of Dynamic Systems with Engineering Applications
	


ζω
ω
ω
+
+
=
y
y
y
u t
2
( )
n
n
n
2
2
	
	 With an undamped natural frequency of ω = 10 rad/s
n
, the step responses may be 
conveniently determined using Simulink for the following cases of damping ratio 
ζ: 0, 0.3, 0.5, 1.0, 2.0. In particular, the block diagram model for the simulation can be 
formed as shown in Figure P9.18a, where each case of damping is simulated using 
the sub-model in Figure P9.18b. Obtain the step for these five cases of damping.

485
Appendix A: Practical Elements 
and Components
For basic lumped-parameter elements in the mechanical, electrical, fluid, and thermal 
domains, refer to Chapter 2. This appendix presents further types of mechanical/electri-
cal/electronic elements and components.
A.1  Mechanical Components
Common mechanical components in a mechatronic system may be classified into some 
useful groups as follows:
•	 Load bearing/structural components (strength and surface properties)
•	 Fasteners (strength)
•	 Dynamic isolation components (transmissibility)
•	 Transmission components (motion conversion)
•	 Mechanical actuators (generated force/torque)
•	 Mechanical controllers (controlled energy dissipation)
In each category, we have indicated within parentheses the main property or attribute that 
is characteristic of the function of that category. The analytical results in solid mechanics 
are particularly useful in the design and development of these components.
In load bearing or structural components, the main function is to provide structural 
support. In this context, mechanical strength and surface properties (e.g., hardness, wear 
resistance, friction) of the component are crucial. The component may be rigid or flexible 
and stationary or moving. Examples of load bearing and structural components include 
bearings, springs, shafts, beams, columns, flanges, and similar load-bearing structures.
Fasteners are closely related to load bearing/structural components. The purpose 
of a fastener is to join two mechanical components. Here as well, the primary property 
of importance is the mechanical strength. Examples are bolts and nuts, locks and keys, 
screws, rivets, and spring retainers. Welding, bracing, and soldering are processes of fas-
tening and will fall into the same category.
Dynamic isolation components perform the main task of isolating a system from another 
system (or environment) with respect to motion and forces. These involve the “filtering” of 
motions and forces/torques. Hence, motion transmissibility and force transmissibility are 
the key considerations in these components. Springs, dampers, and inertia elements may 
form the isolation element. Shock and vibration mounts for machinery, inertia blocks, and 
the suspension systems of vehicles are examples of dynamic isolation components.
Transmission components may be related to isolation components in principle, but their 
functions are rather different. The main purpose of a transmission component is the con-
version of motion (in magnitude and from). In the process, the force/torque of the input 

486
Appendix A
member is also converted in magnitude and form. In fact, in some applications the modi-
fication of the force/torque may be the primary requirement of the transmission compo-
nent. Examples of transmission components are gears, lead screws and nuts (or power 
screws), racks and pinions, cams and followers, chains and sprockets, belts and pulleys 
(or drums), differentials, kinematic linkages, flexible couplings, and fluid transmissions.
Mechanical actuators are used to generate forces (and torques) for various applications. 
The common actuators are electromagnetic in form (i.e., electric motors) and not purely 
mechanical. Since the magnetic forces are “mechanical” forces that generate mechani-
cal torques, electric motors may be considered as electromechanical devices. Other types 
of actuators that use fluids for generating the required effort may be considered in the 
category of mechanical actuators. Examples are hydraulic pistons and cylinders (rams), 
hydraulic motors, their pneumatic counterparts, and thermal power units (prime mov-
ers) such as steam/gas turbines. Of particular interest in mechatronic systems are the 
­electromechanical actuators and hydraulic and pneumatic actuators.
Mechanical controllers perform the task of modifying dynamic response (motion and 
force/torque) in a desired manner. Purely mechanical controllers carry out this task by 
controlled dissipation of energy. These are not as common as electrical/electronic con-
trollers and hydraulic/pneumatic controllers. In fact hydraulic/pneumatic servo valves 
may be treated in the category of purely mechanical controllers. Furthermore, mechani-
cal controllers are closely related to transmission components and mechanical actuators. 
Examples of mechanical controllers are clutches and brakes.
In selecting a mechanical component for a mechatronic application, many engineering 
aspects have to be considered. The foremost are the capability and performance of the 
component with respect to the design requirements (or specifications) of the system. For 
example, motion and torque specifications, flexibility and deflection limits, strength char-
acteristics including stress–strain behavior, failure modes and limits and fatigue life, sur-
face and material properties (e.g., friction, nonmagnetic, noncorrosive), operating range, 
and design life will be important. Other factors such as size, shape, cost, and commercial 
availability can be quite crucial.
The foregoing classification of mechanical components is summarized in Figure A.1. It 
is not within the scope of the present appendix to study all the types of mechanical com-
ponents that are summarized here. Rather, we select for further analysis a few important 
mechanical components that are particularly useful in mechatronic systems.
A.2  Transmission Components
Transmission devices are indispensable in mechatronic applications. We will undertake to 
discuss a few representative transmission devices here. It should be cautioned that in the 
present treatment, a transmission is isolated and treated as a separate unit. In an actual appli-
cation, however, a transmission device works as an integral unit with other components, par-
ticularly the actuator, electronic drive unit, and the load of the system. Hence, a transmission 
design or selection should involve an integrated treatment of all interacting components.
Perhaps the most common transmission device is a gearbox. In its simplest form, a gearbox 
consists of two gear wheels, which contain teeth of identical pitch (tooth separation) and 
of unequal wheel diameter. The two wheels are meshed (i.e., the teeth are engaged) at one 
location. This device changes the rotational speed by a specific ratio (gear ratio) as dictated 

487
Appendix A
by the ratio of the diameters (or radii) of the two gear wheels. In particular, by stepping 
down the speed (in which case the diameter of the output gear is larger than that of the 
input gear), the output torque can be increased. Larger gear ratios can be realized by employ-
ing more than one pair of meshed gear wheels. Gear transmissions are used in a variety of 
applications including automotive, industrial drive, and robotics. Specific gear designs range 
from conventional spur gears to harmonic drives, as discussed later in this section.
Gear drives have several disadvantages. In particular, they exhibit “backlash” because 
the tooth width is smaller than the tooth space of the mating gear. Some degree of backlash 
is necessary for proper meshing. Otherwise, jamming will occur. Unfortunately, back-
lash is a nonlinearity, which can cause irregular and noisy operation with brief intervals 
of zero-torque transmission. It can lead to rapid wear and tear and even instability. The 
degree of backlash can be reduced by using proper profiles (shapes) for the gear teeth. 
Mechanical components
Load bearing/structural components
(strength and surface properties) 
(Bearings, springs, shafts, beams, columns, flanges)
Fasteners (strength)
(Bolts and nuts, locks and keys, screws, rivets, and spring
retainers, welding, bracing, soldering)  
Dynamic isolation components (transmissibility) 
(Springs, dampers, shock and vibration mounts, 
inertia blocks, suspension systems)
Transmission components (motion conversion)
(Gears, friction or traction drives, lead screws and nuts,
power screws, racks and pinions, cams and followers, 
chains and sprockets, belts and pulleys or drums, 
differentials, kinematic linkages, flexible couplings, 
fluid transmissions)
Mechanical actuators (generated force/torque)
(Hydraulic pistons and cylinders or rams, hydraulic
motors, their pneumatic counterparts) 
Mechanical controllers (controlled energy dissipation)
(Clutches, brakes, hydraulic and pneumatic servo valves)
FIGURE A.1
Classification of mechanical components.

488
Appendix A
Backlash can be eliminated through the use of spring-loaded gears. Sophisticated feed-
back control may be used as well to reduce the effects of gear backlash.
Conventional gear transmissions, such as those used in automobiles with standard gear-
boxes, contain several gear stages. The gear ratio can be changed by disengaging the drive-
gear wheel (pinion) from a driven wheel of one gear stage, and engaging it with another 
wheel of a different number of teeth (different diameter) of another gear stage, while the 
power source (input) is disconnected by means of a clutch. Such a gearbox provides only 
a few fixed gear ratios. The advantages of a standard gearbox include relative simplicity of 
design and the ease with which it can be adapted to operate over a reasonably wide range of 
speed ratios, albeit in a few discrete increments of large steps. There are many disadvantages: 
Since each gear ratio is provided by a separate gear stage, the size, weight, and complexity 
(and associated cost, wear, and unreliability) of the transmission increases directly with the 
number of gear ratios provided. Also, the drive source has to be disconnected by a clutch 
during the shifting of gears; the speed transitions are generally not smooth; and operation is 
noisy. There is also dissipation of power during the transmission steps, and wear and damage 
can be caused by inexperienced operators. These shortcomings can be reduced or eliminated 
if the transmission is able to vary the speed ratio continuously rather than in a stepped man-
ner. Further, the output speed and corresponding torque can be matched to the load require-
ments closely and continuously for a fixed input power. This results in more efficient and 
smooth operation, among many other related advantages. A continuously variable transmis-
sion, which has these desirable characteristics, will be discussed later in this section. First, we 
will discuss a power screw, which converts angular motion into rectilinear motion.
A.3  Lead Screw and Nut
A lead-screw drive is a transmission component, which converts rotatory motion into 
rectilinear motion. Lead screws, power screws, and ball screws are rather synonymous. 
Lead screw and nut units are used in numerous applications including positioning tables, 
machine tools, gantry and bridge systems, automated manipulators, and valve actuators. 
Figure A.2(a) shows the main components of a lead-screw unit. The screw is rotated by a 
motor, and as a result the nut assembly moves along the axis of the screw. The support block, 
Screw
Nut
End bearing
Support
block 
(a)
Keyhole
for preloading
Internal ball return system
(b)
FIGURE A.2
(a) A lead screw and nut unit; (b) Details of a ball screw (Barnes Industries, Inc., Madison Heights, MI, With 
permission).

489
Appendix A
which is attached to the nut, provides means for supporting the device that has to be moved 
using the lead-screw drive. The screw holes that are drilled on the support block may be 
used for this purpose. Since there can be backlash between the screw and the nut as a result 
of the assembly clearance and/or wear and tear, a keyhole is provided in the nut to apply 
a preload through some form of a clamping arrangement that is designed into the nut. The 
end bearings support the moving load. Typically these are ball bearings can carry axial loads 
as well by means of an angular-contact thrust bearing design. A ball screw is a lead screw 
with a helical channel that carries bearing balls, which provide backlash-free, smoother and 
uniform support (see Figure A.2(b)). However, a ball screw requires a mechanism and path-
way to recirculate the balls back into the bearing channel once they reach the end.
The basic equation for operation of a lead-screw drive is obtained now. As shown in 
Figure A.3, suppose that a torque TR is provided by the screw at (and reacted by) the nut. 
Note that this is the net torque after deducting the inertia torque (due to inertia of the 
motor rotor and the lead screw) and the frictional torque of the bearings from the motor 
(magnetic) torque. Torque TR is not completely available to move the load that is supported 
on the nut. The reason is the energy dissipation (friction) at the screw and nut interface. 
Suppose that the net force available from the nut to drive the load in the axial direction is 
F. Denote the screw rotation by θ and the rectilinear motion of the nut by x.
When the screw is rotated (by a motor) through δθ, the nut (which is restrained from 
rotating due to the guides along which the support block moves) will move through δx 
along the axial direction. The work done by the screw is TR.δθ and the work done in mov-
ing the nut (with its load) is F · δx. The lead-screw efficiency e is given by 
	
 
δ
δθ
=
⋅
⋅
e
F
x
TR
	
(A.1)
Now, δθ
δ
=
r
x, where the transmission parameter of the lead screw is r (axial distance 
moved per one radian of screw rotation). The “lead” l of the lead screw is the axial distance 
moved by the nut in one revolution of the screw, and it satisfies
	
π
=
l
r
2
	
(A.2)
In general, the lead is not the same as the “pitch” p of the screw, which is the axial distance 
between two adjacent threads. For a screw with n threads,
	
=
l
np	
(A.3)
Substituting r in Equation A.1, we have
	
π
=
=
F
e
r T
e
l
T
2
R
R	
(A.4)
Te
x
F
θ
FIGURE A.3
Effort and motion transmission at the screw and nut interface.

490
Appendix A
This result is the representative equation of a lead screw and may be used in the design 
and selection of components in a lead-screw drive system.
For a screw of mean diameter d, the helix angle α is given by
	
α
π
=
=
l
d
r
d
tan
2 	
(A.5)
Assuming square threads, we obtain a simplified equation for the screw efficiency in terms 
of the coefficient of friction μ. First, for a screw of 100% efficiency (e = 1), from Equation A.4, 
a torque TR at the nut can support an axial force (load) of TR/r. The corresponding frictional 
force Ff is μTR/r. The torque required to overcome this frictional force is Tf = Ff·d/2. Hence, 
the frictional torque is given by
	
µ
=
T
d
r T
2
f
R	
(A.6)
The screw efficiency is
	
µ
µ
α
=
−
=
−
=
−
e
T
T
T
d
r
1
2
1
tan
R
f
R
	
(A.7)
For threads that are not square (e.g., for slanted threads such as acme threads, buttress 
threads, and modified square threads), Equation A.7 has to be appropriately modified.
It is clear from Equation A.6 that the efficiency of a lead screw unit can be increased 
by decreasing the friction and increasing the helix angle. Of course, there are limits. For 
example, typically the efficiency will not increase by increasing the helix angle beyond 
30°. In fact, a helix angle of 50° or more will cause the efficiency to drop significantly. The 
friction can be decreased by proper choice of material for screw and nut and through 
surface treatments, particularly lubrication. Typical values for the coefficient of friction 
(for identical mating material) are given in Table A.1. Not that the static (starting) friction 
will be higher (as much as 30%) than the dynamic (operating) friction. An ingenious way 
to reduce friction is by using a nut with a helical track of balls instead of threads. In this 
case, the mating between the screw and the nut is not through threads but through ball 
bearings. Such a lead screw unit is termed a ball screw. A screw efficiency of 90% or greater 
is possible with a ball screw unit.
In the driving mode of a lead screw, the frictional torque acts in the opposite direction 
to (and has to be overcome by) the driving torque. In the “free” mode where the load is not 
driven by an external torque from the screw, it is likely that the load will try to ­“back-drive” 
the screw (say, due to gravitational load). Then, however, the frictional torque will change 
direction and the back motion has to overcome it. If the back-driving torque is less than 
the frictional torque, motion will not be possible and the screw is said to be self-locking.
TABLE A.1
Some Useful Values for Coefficient of Friction
Material
Coefficient of Friction
Steel (dry)
0.2
Steel (lubricated)
0.15
Bronze
0.10
Plastic
0.10

491
Appendix A
Example A.1
A lead-screw unit is used to drive a load of mass up an incline of angle θ, as shown in 
Figure A.4. Under quasi-static conditions (i.e., neglecting inertial loads) determine the 
drive torque needed by the motor to operate the device. The total mass of the mov-
ing unit (load, nut, and fixtures) is m. The efficiency of the lead screw is e and the lead 
is l. Assume that the axial load (thrust) due to gravity is taken up entirely by the nut. 
(In practice, a significant part of the axial load is supported by the end bearings, which 
have the thrust-bearing capability.)
Solution
The effective load that has to be acted upon by the net torque (after allowing for ­friction) 
in this example is
	
θ
=
F
mgsin
Substitute into Equation A.4. The required torque at the nut is
	
θ
π
θ
=
=
T
mgr
e
mgl
e
sin
2
sin
R
	
(A.8)

▪
A.4  Harmonic Drives
Usually, motors run efficiently at high speeds. Yet in many practical applications, low 
speeds and high torques are needed. A straightforward way to reduce the effective speed 
and increase the output torque of a motor is to employ a gear system with high gear reduc-
tion. Gear transmission has several disadvantages, however. For example, backlash in 
gears would be unacceptable in high-precision applications. Frictional loss of torque, wear 
problems, and the need for lubrication must also be considered. Furthermore, the mass 
of the gear system consumes energy from the actuator (motor), and reduces the overall 
torque/mass ratio and the useful bandwidth of the actuator.
 θ
Load
(Mass m)
Motor
FIGURE A.4
A lead-screw unit driving an inclined load.

492
Appendix A
A harmonic drive is a special type of transmission device that provides very large speed 
reductions (e.g., 200:1) without backlash problems. Also, a harmonic drive is comparative 
much lighter than a standard gearbox. The harmonic drive is often integrated with con-
ventional motors to provide very high torques, particularly in direct-drive and servo appli-
cations. The principle of operation of a harmonic drive is shown in Figure A.5. The rigid 
circular spline of the drive is the outer gear and it has internal teeth. An annular flexispline 
has external teeth that can mesh with the internal teeth of the rigid spline in a limited 
region when pressed in the radial direction. The external radius of the flexispline is slightly 
smaller than the internal radius of the rigid spline. As it name implies, the flexispline 
undergoes some elastic deformation during the meshing process. This results in a tight 
mesh without ant clearance between meshed teeth, and hence the motion is backlash free.
In the design shown in Figure A.5, the rigid spline is fixed and may also serve as the 
housing of the harmonic drive. The rotation of the flexispline is the output of the drive; 
hence, it is connected to the driven load. The input shaft (motor shaft) drives the wave 
generator (represented by a cam in Figure A.5). The wave generator motion brings about 
controlled backlash-free meshing between the rigid spline and the flexispline.
Suppose that
	
nr = number of teeth (internal) in the rigid spline
	
n f = number of teeth (external) in the flexispline
It follows that
	
π
= n
Tooth pitch of the rigid spline
2
rad
r
	
π
= n
Tooth pitch of the flexispline
2
rad
f
Fixed rigid spline with 
internal teeth (nr)
Annular spline
(flexispline) with 
external teeth (nf) 
(output) 
Motor shaft
(input)
Wave generator (cam)
driven by input
(actuator) shaft
FIGURE A.5
The principle of operation of a harmonic drive.

493
Appendix A
Further, suppose that nr is slightly smaller than n f. Then, during a single tooth ­engagement, 
the flexispline rotates through 
π
π
−
n
n
(2 /
2 /
)
r
f  radians in the direction of rotation of the 
wave generator. During one full rotation of the wave generator, there will be a total of nr 
tooth engagements in the rigid spline (which is stationary in this design). Hence, the rota-
tion of the flexispline during one rotation of the wave generator (around the rigid spline) is
	
π
π
π (
)
−



=
−
n
n
n
n
n
n
2
2
2
r
r
f
f
f
r
It follows that the gear reduction ratio (r:1) representing the input speed/output speed ratio 
is given by
	
=
−
r
n
n
n
f
f
r
	
(A.9a)
We can see that by making nr very close to n f, very high gear reductions can be obtained. 
Furthermore, since the efficiency of a harmonic drive is given by
	
e
Efficiency  = Output power
Input power 	
(A.10)
we have
	
−
×
en
n
n
Output torque = (
)
 Input torque 
f
f
r
	
(A.11)
This result illustrates the torque amplification capability of a harmonic drive.
An inherent shortcoming of the harmonic drive sketched in Figure A.5 is that the motion 
of the output device (flexispline) is eccentric (or epicyclic). This problem is not serious 
when the eccentricity is small (which is the case for typical harmonic drives) and is fur-
ther reduced because of the flexibility of the flexispline. For improved performance, how-
ever, this epicyclic rotation has to be reconverted into a concentric rotation. This may be 
accomplished by various means, including flexible coupling and PIN-slot transmissions. 
The output device of a PIN-slot transmission is a flange that has pins arranged on the 
circumference of a circle centered at the axis of the output shaft. The input to the PIN-slot 
transmission is the flexispline motion, which is transmitted through a set of holes on the 
flexispline. The PIN diameter is smaller than the hole diameter, the associated clearance 
being adequate to take up the eccentricity in the flexispline motion. This principle is shown 
schematically in Figure A.6. Alternatively, pins could be attached to the flexispline and the 
slots on the output flange. The eccentricity problem can be eliminated altogether by using 
a double-ended cam in place of the single-ended cam wave generator shown in Figure A.5. 
With this new arrangement, meshing takes place at two diametrical ends simultaneously, 
and the flexispline is deformed elliptically in doing this. The center of rotation of the flex-
ispline now coincides with the center of the input shaft. This double-mesh design is more 
robust and is quite common in industrial harmonic drives.
Other designs of harmonic drive are possible. For example, if 
<
n
n
f
r then r in 
Equation A.9a will be negative and the flexipline will rotate in the opposite direction to the 
wave generator (input shaft). Also, as indicated in the example below, the flexipline may be 
fixed and the rigid spline may serve as the output (rotating) member.

494
Appendix A
Traction drives (or friction drives) employ frictional coupling to eliminate backlash 
and overloading problems. These are not harmonic drives. In a traction drive, the drive 
member (input roller) is frictionally engaged with the driven member (output roller). The 
disadvantages of traction drives include indeterminacy of the speed ratio under slipping 
(overload) conditions and large size and weight for a specified speed ratio.
Example A.2
An alternative design of a harmonic drive is sketched in Figure A.7a. In this design, the 
flexipline is fixed. It loosely fits inside the rigid spline and is pressed against the internal 
teeth of the rigid spline at diametrically opposite locations. Tooth meshing occurs at 
these two locations only. The rigid spline is the output member of the harmonic drive 
(see Figure A.7b).
	
1.	 Show that the speed reduction ratio is given by
	
ω
ω
=
=
−
r
n
n
n
(
)
i
f
r
r
f
	
(A.9b)
	
Note that if 
>
n
n
f
r the output shaft will rotate in the opposite direction to the 
input shaft.
	
2.	 Now consider the free-body diagram shown in Figure A.7c. The axial moment 
of inertia of the rigid spline is J. Neglecting the inertia of the wave generator, 
write approximate equations for the system. The variables shown in Figure A.7c 
are defined as follows:
	
	 Ti = torque applied on the harmonic drive by the input shaft
	
	 To = torque transmitted to the driven load by the output shaft (rigid spline)
	
	 Tf = torque transmitted by the flexispline to the rigid spline
	
	 Tr = reaction torque on the flexispline at the fixture
	
	 Tw = torque transmitted by the wave generator
A
+
+B
Flexispline
Slots on flexispline
Pins on the
output member
A – Flexispline center
B – Output (load) shaft center
FIGURE A.6
The principle of a PIN-slot transmission.

495
Appendix A
Meshed
Output flange 
(rigid)
External teeth (nf)
Flexispline
(stationary)
Internal
teeth (nr)
Meshed
Wave generator
(attached to the
input shaft)
ωi
ωo
Input
shaft
(a)
(b)
ωi
ωo
To
Ti
Input
shaft
Wave generator
Flexispline
Rigid spline
Output
shaft
J
Tw
Tw
Tf
Tf
Tr
Ti
T0
ω0
(c)
Wave
 generator
Flexispline
Rigid spline
J
FIGURE A.7
(a) An alternative design of harmonic drive; (b) torque and speed transmission of the harmonic drive; 
(c) ­free-body diagrams.

496
Appendix A
Solution
Part 1:
Suppose that nr is slightly larger than n f. Then, during a single tooth engagement, the 
rigid spline rotates through 
π
π
−
n
n
(2 /
2 / )
f
r  radians in the direction of rotation of the 
wave generator. During one full rotation of the wave generator, there will be a total of n f 
tooth engagements in the flexispline (which is stationary in the present design). Hence, 
the rotation of the rigid spline during one rotation of the wave generator (around the 
flexispline) is
	
π
π
π (
)
−



=
−
n
n
n
n
n
n
2
2
2
f
f
r
r
r
f
It follows that the gear reduction ratio (r:1) representing the input speed/output speed 
ratio is given by
	
=
−
r
n
n
n
r
r
f
	
(A.9c)
It should be clear that if 
>
n
n
f
r, the output shaft will rotate in the opposite direction to 
the input shaft.
Part 2:
Equations of motion for the three components are as follows:
	
1.	 Wave generator
	
	 Here, since inertia is neglected, we have
	
−
=
T
T
0
i
w
	
(A.12a)
	
2.	 Flexispline
	
	 Here, since the component is fixed, the equilibrium condition is
	
+
−
=
T
T
T
0
w
f
r
	
(A.12b)
	
3.	 Rigid spline
	
	 Newton’s second law gives
	
ω
−
=
T
T
J d
dt
f
o
o 	
(A.12c)

▪
A.5  Resistor (Dissipation) Element
Consider the resistor element shown in Figure A.8a. It is a D-type element (energy dis-
sipating element). The constitutive equation (physical law) is the well-known Ohm’s law:
	
=
v
Ri	
(A.13a)
where voltage applied across the conductor is v (volts), the current that will flow through 
the conductor is i (amperes), and R is the resistance of the resistor (measured in units of 

497
Appendix A
“ohm,” denoted by Ω). Equation A.13a is an algebraic equation. Hence, either v or i can 
serve as the natural output variable for a resistor, and either one can determine its state. 
However, since the state variables v and i are established by an independent capacitor ele-
ment and an independent inductor element, respectively, a damper will not introduce a 
new state variable.
In summary:
	
1.	Electrical resistor is an energy dissipating element (D-type element).
	
2.	Either current i or voltage v may represent its state.
	
3.	No new state variable is defined by this element.
A.5.1  Conductance and Resistance
The flow electrons or electric current in a linear conductive is governed by Ohm’s law 
(Equation A.13a), which can also be expressed as
	
=
i
Gv	
(A.13b)
where the conductance of the conductor is G. It is measured in the units of “mho” or 
­“siemen” (denoted by S). Resistance is the inverse of conductance; thus,
	
=
R
G
1 	
(A.14)
Silver, copper, gold, and aluminum are good conductors of electricity.
(a)
v
v
+
–
+
–
+
–
i=
v
R
1
R
(b)
i
v
C
(c)
v
v
L
FIGURE A.8
Basic passive electrical elements. (a) Resistor (dissipating element); (b) capacitor; (c) inductor.

498
Appendix A
A.5.2  Resistivity
The resistance increases with the length (L) of the conductor and decreases with the area 
of cross-section (A). The corresponding relationship is
	
ρ
=
R
L
A 	
(A.15)
The constant of proportionality ρ is the resistivity of the conducting material. Hence, 
resistivity may be defined as the resistance of a conductor of unity length and unity 
cross-sectional area. It may be expressed in Ω⋅
Ω⋅
cm /cm or
cm.
2
 A larger unit would be 
Ω⋅
Ω⋅
m /m or
m.
2
Alternatively, resistivity may be defined as the resistance of a conductor of unity length 
and unity diameter. According to this definition,
	
ρ
=
R
L
d
ˆ
2 	
(A.16)
where d represents the wire diameter and ρˆ is the resistivity in the new units. Resistivities 
of several common materials are given in Table A.2.
Example A.3
Determine the conversion factor between ρ expressed in Ω⋅m and ρˆ  expressed in 
­diameters of 1 cm and lengths of 1 m. How would you determine the resistance of a 
TABLE A.2
Resistivities of Some Useful Materials
Material
Resistivity ρ
Ω
(
)
 
.m  at 20°C (68°F)
Aluminum
2.8 × 10−8
Carbon
4000.0 × 10−8
Constantan
44.0 × 10−8
Copper
1.7 × 10−8
Ferrite (manganese-zinc)
20.0
Gold
2.4 × 10−8
Graphite carbon
775.0 × 10−8
Iron
10.0 × 10−8
Lead
9.6 × 10−8
Magnesium
45.8 × 10−8
Mercury
20.4 × 10−8
Nichrome
112.0 × 10−8
Polyester
1 × 1010
Polystyrene
1 × 1016
Porcelain
1 × 1016
Silver
1.6 × 10−8
Steel
15.9 × 10-8
Tin
11.5 × 10−8
Tungsten
5.5 × 10−8

499
Appendix A
conductor that is 5.0 mm in diameter and 2.0 m in length using these two resistivity 
values?
Solution
Wire diameter = 1.0 cm =  ×
−
1
10
m
2
Wire length = 1.0 m
Wire resistance 
ρ
π
Ω
=
×
×
−
R
1.0
4 (1
10 )
2 2
or 
ρ
=
×
×
Ω
R
1.273
10
.
4
Hence, multiply ρ by 
×
1.273
104 to obtain the resistivity ρˆ  in Ω⋅cm-diam/m.
Now, according to Equation A.16, the resistance of the given conductor is
	
ρ
ρ
ρ
=
Ω
×
Ω
×
×
×
Ω
R
ˆ2.0/(0.5)
 = 8.0
ˆ
 = 8.0
1.273
10
2
4
Hence, multiply ρˆ  by 8.0 or ρ by 
×
×
8.0
1.273
104 to determine the resistance of the given 
conductor.
▪
A.5.3  Effect of Temperature on Resistance
The resistance of a typical metal increases with temperature. The resistance decreases 
with temperature for many nonmetals and semiconductors. Typically, temperature effects 
on hardware have to be minimized in precision equipment, and temperature compensa-
tion or calibration would be necessary. On the other hand, high temperature sensitivity of 
resistance in some materials is exploited in temperature sensors such as resistance temper-
ature detectors (RTDs) and thermistors. The sensing element of an RTD is made of a metal 
such as nickel, copper, platinum, or silver. If the temperature variation is not too large, the 
following linear relationship is valid:
	
α ∆
(
)
=
+
⋅
R
R
t
1
0
	
(A.17)
where
R = final resistance
R0 = initial resistance
ΔT = change in temperature
α = temperature coefficient of resistance
Values of α for several common materials are given in Table A.3. Each of these values 
can be expressed in ppm/°C (parts per million per degree centigrade) by multiplying by 
106. Note that graphite has a negative temperature coefficient and nichrome has a very low 
temperature coefficient of resistance. A platinum RTD can operate accurately over a wide 
temperature range and possesses a high sensitivity (typically 
Ω°
0.4 / C).
Thermistors are made of semiconductor material such as oxides of cobalt, copper, 
­manganese, and nickel. Their resistance decreases with temperature. The relationship is 
nonlinear and is given approximately by
	
(
)
=
−
β
−
R
R e
T
T
1
1
0
0
	
(A.18)
where the temperatures T and To are in absolute degrees (°K or °R) and, R and R0 are the 
corresponding resistances. The parameter β is a material constant.

500
Appendix A
A.5.4  Effect of Strain on Resistance
The property of resistance change with strain in materials is termed piezoresistivity. This 
property is used in strain gauges, in particular. A foil strain gauge uses a metallic foil (e.g., 
a copper-nickel alloy called constantan) as its sensing element. A semiconductor strain 
gauge uses a semiconductor element (e.g., silicon with the trace impurity boron) in place of 
a metal foil. An approximate relationship for a strain gauge is:
	
∆
ε
=
R
R
Ss 	
(A.19)
where:
ΔR = change in resistance due to strain ε
R = initial resistance
Ss = sensitivity (gauge factor) of the strain gauge
The gauge factor is on the order of 4.0 for a metal-foil strain gauge and can range from 
40.0 to 200.0 for a semiconductor strain gauge.
Temperature effects have to be compensated for in high-precision measurement of 
strain. Compensation circuitry may be employed for this purpose. In a semiconductor 
strain gauge, self-compensation for temperature effects can be achieved due to the fact that 
its temperature coefficient of resistance varies nonlinearly with the concentration of the 
dope material. The temperature coefficient curve of a p-type semiconductor strain gauge 
is shown in Figure A.9.
A.5.5  Superconductivity
The resistivity of some materials drops virtually to zero when the temperature is decreased 
close to absolute zero, provided that the magnetic field strength of the environment is 
less than some critical value. Such materials are called superconducting materials. The 
superconducting temperature T (absolute) and the corresponding critical magnetic field 
strength H are related through
TABLE A.3
Temperature Coefficients of Resistance for Several Materials
Material
Temperature Coefficient of Resistance α 
(per °C) at 20°C (68°F)
Aluminum
0.0040
Brass
0.0015
Copper
0.0039
Gold
0.0034
Graphite carbon
−0.0005
Iron
0.0055
Lead
0.0039
Nichrome
0.0002
Silver
0.0038
Steel
0.0016
Tin
0.0042
Tungsten
0.0050

501
Appendix A
	
(
)
=
−
H
H
T T
1
c
0
2	
(A.20)
where
H0 = critical magnetic field strength for a superconducting temperature of absolute zero
Tc = superconducting temperature at zero magnetic field
The constants H0 and Tc for several materials are listed in Table A.4
1
2
Temperature coefficient (per °F)
3
0
1018
1019
1020
1021
Concentration of trace
material (atoms/mL)
α = Temperature
coefficient of resistance
α
× 10–4
FIGURE A.9
The temperature coefficient of resistance of a p-type semiconductor strain gauge.
TABLE A.4
Superconductivity Constants for Several Materials
Material
Tc (°K)
H0 (A/m)
Aluminum
1.2
0.8 × 104
Gallium
1.1
0.4×104
Indium
3.4
2.3 × 104
Lead
7.2
6.5 × 104
Mercury
4.0
3.0 × 104
Tin
3.7
2.5 × 104
Vanadium
5.3
10.5 × 104
Zinc
0.9
0.4 × 104

502
Appendix A
Superconducting elements can be used to produce high-frequency (e.g., 1 × 1011 Hz) 
switching elements (e.g., Josephson junctions), which can generate two stable states (e.g., 
zero voltage and a finite voltage, or zero magnetic field and a finite magnetic field). Hence, 
they are useful as computer memory elements. Other applications of superconductivity 
include powerful magnets with low dissipation (for medical imaging, magnetohydro-
dynamics, fusion reactors, particle accelerators, etc.), actuators (for motors, magnetically 
­levitated vehicles, magnetic bearings, etc.), and sensors.
A.5.6  Color Code for Fixed Resistors
Carbon, wound metallic wire, and conductive plastics are commonly used as commercial 
resistors. A wire-wound resistor element is usually encapsulated in a cylindrical casing 
made of an insulating material such as porcelain or bakelite. Axial or radial leads are 
provided for external connection. The outer surface of a cylindrical resistor element is 
color coded for the purpose of its specification. Four color stripes (bands) are marked on 
a cylindrical resistor element for coding. The first stripe gives the first digit of a two-digit 
number, and the second stripe gives the second digit. The third stripe specifies a multiplier 
that should be included with the two-digit number to give the resistance value of the ele-
ment in ohms. These three bands are equally spaced. The fourth stripe, which is spaced 
somewhat farther from the first three, gives the percentage tolerance of the ­resistance 
value. This color code is given in Table A.5. According to the notation given in the table, 
the resistance value is given by
	
Ω
=
×
±
R
mn
e
10
%
p
	
(A.21)
If there is no fourth band, the tolerance of the element is considered to be ±20%.
Example A.4
A cylindrical wire-lead resistor element has the following bands printed on it: red, 
green, blue, and silver. What is the resistance of the element?
TABLE A.5
Color Code for Fixed Resistor Elements
Color
First Stripe
Second Stripe
Third Stripe
Fourth Stripe
First Digit (m)
Second Digit (n)
Power of 10 (p)
Tolerance (e %)
Silver
—
—
−2
±10
Gold
—
—
−1
±5
Black
0
0
0
—
Brown
1
1
1
±1
Red
2
2
2
±2
Orange
3
3
3
—
Yellow
4
4
4
—
Green
5
5
5
—
Blue
6
6
6
—
Violet
7
7
7
—
Gray
8
8
8
—
White
9
9
9
—

503
Appendix A
Solution
According to Equation 4.9,
	
Ω
Ω
=
×
±
=
×
×
R
25
10
10%
22.5
10  to 27.5
10
6
6
6

▪
In addition to the common cylindrical wire-lead elements, resistors are available in other 
packages, which are particularly useful in assembling a printed circuit board. They 
include a single in-line package, which has a single array of pins projecting downward, 
and a dual in-line package, which has two parallel arrays of pins projecting downward. 
Each such package has multiple resistors, as determined by the number of pins. Also, 
there are flat surface-mount packages without pins or leads but with solder tabs as the 
connection points. Metal-film resistors provide high precision. Since the tolerance of such 
a component is typically less than 1%, the code printed on the package takes a somewhat 
different meaning. Specifically, the first three stripes (not just the first two) are used to 
denote a three-digit number (coefficient) and the fourth stripe gives the power of 10 of 
the multiplier.
A.6  Dielectric Material and Capacitor Element
Components made of dielectric material exhibit properties of electrical capacitance. The 
“capacity” to storage electrical charge is the underlying basis. Dielectric materials are 
­insulators, having resistivities larger than 1 × 1012 Ω·m and containing less than 1 × 106 
mobile electrons per m3. When a voltage is applied across a medium of dielectric material 
that is sandwiched between two electrode plates, a charge polarization takes place at the 
two electrodes. The resulting charge depends on the capacitance of the capacitor formed 
in this manner.
Consider the linear capacitor element shown in Figure A.8b. Its constitutive equation is
	
=
q
Cv	
(A.22a)
where
v = applied voltage (V)
q = stored charge (C)
C = capacitance (F)
Since current (i) is the rate of change of charge (dq/dt), we can write the following proper 
form of the constitutive equation:
	
=
C dv
dt
i	
(A.22b)
Since power is given by the product iv, by substituting Equation A.22b, the energy in a 
capacitor can be expressed as
	
∫
∫
∫
=
=
=
E
ivdt
C dv
dt vdt
Cvdv

504
Appendix A
or
	
=
E
C v
Energy 
1
2
2	
(A.23)
This is the familiar electrostatic energy of a capacitor.
Also
	
∫
=
+
−
−
v t
v
C
idt
( )
(0 )
1
t
0
	
(A.24)
Hence, for a capacitor with a finite current, we have
	
=
+
−
v
v
(0 )
(0 )	
(A.25)
In summary:
	
1.	A capacitor is an energy storage element (electrostatic energy).
	
2.	Voltage is an appropriate (natural) response variable (or state variable) for a 
capacitor element. This is justified by two reasons: First, from Equation 2.16, the 
voltage at any time t can be completely determined with the knowledge of the 
initial voltage and the applied current during the time interval 0 to t. Second, 
from Equation A.23, the energy of a capacitor element can be represented by the 
variable v alone.
	
3.	Voltage across a capacitor cannot change instantaneously unless an infinite ­current 
is applied.
	
4.	Voltage is a natural output variable, and current is a natural input variable for a 
capacitor.
	
5.	Since its state variable, voltage, is an across variable, a capacitor is an A-type 
element.
A.6.1  Permittivity
Consider a capacitor made of a dielectric plate of thickness d sandwiched between two 
conducting plates (electrodes) of common (facing) area A. Its capacitance is given by
	
ε
=
C
A
d
	
(A.26)
where ε = permittivity (or dielectric constant) of the dielectric material.
The relative permittivity (or dielectric constant) εr is defined as
	
ε
ε
ε
=
r
0
	
(A.27)
where ε0 = permittivity of vacuum (~8.85 × 10−12 F/m or 8.85 pF/m).
Relative permittivities of some materials are given in Table A.6.

505
Appendix A
A.6.2  Capacitor Types
The capacitance of a capacitor increases with the common surface area of the electrode 
plates. This increase can be achieved, without compromising the compact size of the capac-
itor, by employing a rolled-tube construction. Here, a dielectric sheet (e.g., paper or a poly-
ester film) is placed between two metal foils and the composite is rolled into a tube. Axial 
or radial leads are provided for external connection. If the dielectric material is not flexible 
(e.g., mica), a stacked-plate construction may be employed in place of the rolled construc-
tion, to obtain compact capacitors having high capacitance. High-permittivity ceramic 
disks are used as the dielectric plates in miniature, single-plate, high-capacitance capaci-
tors. Electrolytic capacitors can be constructed using the rolled-tube method, using a paper 
soaked in an electrolyte in place of the dielectric sheet. When a voltage is applied across 
the capacitor, the paper becomes coated with a deposit of dielectric oxide, which is formed 
through electrolysis. This becomes the dielectric medium of the capacitor. Capacitors hav-
ing low capacitances on the order of 1 × 10−12 F (1 pF) and high capacitances on the order of 
4 × 10−3 F are commercially available.
An important specification for a capacitor is the breakdown voltage—the voltage at 
which discharge will occur through the dielectric medium (i.e., the dielectric medium 
ceases to function as an insulator). This is measured in terms of the dielectric strength, 
which is defined as the breakdown voltage for a dielectric element of thickness 1 mil 
(1 × 10−3 in). Approximate dielectric strengths of several useful materials are given in 
Table A.7.
TABLE A.6
Dielectric Constants of Some Common Materials
Material
Relative Permittivity εr
Air
1.0006
Carbon dioxide gas
1.001
Ceramic (high permittivity)
8000.0
Cloth
5.0
Common salt
5.9
Diamond
5.7
Glass
6.0
Hydrogen (liquid)
1.2
Mica
6.0
Oil (mineral)
3.0
Paper (dry)
3.0
Paraffin wax
2.2
Polythene
2.3
PVC
6.0
Porcelain
6.0
Quartz (SiO2)
4.0
Vacuum
1.0
Water
80.0
Wood
4.0

506
Appendix A
A.6.3  Color Code for Fixed Capacitors
Color codes are used to indicate the specifications of paper capacitors or ceramic capacitors. 
The code consists of a colored end followed by a series of four dots printed on the outer 
surface of the capacitor. The end color gives the temperature coefficient of the capacitance 
in parts per million per degree Celsius (ppm/°C). The first two dots specify a two-digit 
number. The third dot specifies a multiplier, which together with the two-digit number, 
gives the capacitance value of the capacitor in pF. The fourth dot gives the tolerance of the 
capacitance. This code is shown in Table A.8.
A.6.4  Piezoelectricity
Some materials, when subjected to a stress (strain), produce an electric charge. These are 
termed piezoelectric materials, and the effect is called piezoelectricity. Most materials that 
possess a nonsymmetric crystal structure are known to exhibit the piezoelectric property. 
Examples are barium titanate, cadmium sulfide, lead titanate, quartz, and Rochelle salt. 
The reverse piezoelectric effect (i.e., the material deforms in an electric field) is also useful 
in practice.
TABLE A.8
Color Code for Ceramic and Paper Capacitors
Color
End Color
First Dot
Second 
Dot
Third Dot
Fourth Dot Tolerance
Temperature 
Coefficient 
(ppm/°C) 
First Digit
Second Digit Multiplier
For ≤10 pF
For >10 pF
Black
0
0
0
1
±2 pF
±20%
Brown
−30
1
1
10
±0.1 pF
±1%
Red
−80
2
2
1 × 102
—
±2%
Orange
−150
3
3
1 × 103
—
±2.5%
Yellow
−220
4
4
1 × 104
—
—
Green
−330
5
5
—
±0.5 pF
±5%
Blue
−470
6
6
—
—
—
Violet
−750
7
7
—
—
—
Gray
30
8
8
0.01
±0.25 pF
—
White
100
9
9
0.1
±1 pF
±10%
TABLE A.7
Approximate Dielectric Strengths of Several Materials
Material
Dielectric Strength (V/mil)
Air
25
Ceramics
1000
Glass
2000
Mica
3000
Oil
400
Paper
1500

507
Appendix A
The piezoelectric characteristic of a material may be represented by its piezoelectric 
coefficient kp, which is defined as follows:
	
(
)
(
)
=
k
Change in strain m/m
Change in electric field strength V/m
p
with no applied stress. Piezoelectric coefficients of some common materials are given in 
Table A.9. Quartz and Rochelle salt are naturally occurring piezoelectric materials. PZT 
and barium titanate are synthetic materials whose piezoelectric properties are achieved 
by heating and gradually cooling them in a strong magnetic field.
A piezoelectric element may be treated as a capacitor, which satisfies Equation A.22. 
A piezoelectric element has a very high impedance, particularly at low frequencies. For 
example, a quartz crystal may present an impedance of several megohms at 100 Hz. For 
this reason (and due to charge leakage), in particular, piezoelectric sensors do not function 
properly at low frequencies.
The sensitivity of a piezoelectric crystal may be represented either by its charge sensitivity 
or by its voltage sensitivity. Charge sensitivity is defined as
	
∂
∂
=
S
q
F
q
	
(A.28)
where q denotes the generated charge and F denotes the applied force. For a crystal with 
surface area A, Equation A.28 can be expressed as
	
∂
∂
=
S
A
q
p
1
q
	
(A.29)
where p is the stress (normal or shear) or pressure applied to the crystal surface. Voltage 
sensitivity Sv is given by the change in voltage due to a unit increment in pressure (or stress) 
per unit thickness of the crystal. Thus, in the limit, we have
	
∂
∂
=
S
d
v
p
1
v
	
(A.30)
where d denotes the crystal thickness.
For a capacitor, from Equation A.22a, we have δ
δ
=
q
C v. Then, by using Equation A.26 
for a capacitor element, the following relationship between charge sensitivity and voltage 
sensitivity is obtained:
	
ε
=
S
S
q
v	
(A.31)
TABLE A.9
Piezoelectric Coefficients of Some Materials
Material
Piezoelectric Coefficient kp (m/V)
Barium titanate
2.5 × 10−10
Lead zirconate titanate
6.0 × 10−10
Quartz
0.02 × 10−10
Rochelle salt
3.5 × 10−10

508
Appendix A
Note that ε is the dielectric constant (permittivity) of the crystal (capacitor).
Example A.5
A barium titanate crystal has a charge sensitivity of 150.0 picocoulombs per newton 
(pC/N). (Note: 1 pC = 1 × 10−12 coulombs; coulombs = farads × volts). The dielectric con-
stant (permittivity) of the crystal is 1.25 × 10−8 farads per meter (F/m). What is the voltage 
sensitivity of the crystal?
Solution
The voltage sensitivity of the crystal is given by
=
×
=
×
×
=
×
⋅
=
⋅
−
−
−
−
S
150.0pC/N
1.25
10
F/m
150.0
10
C/N
1.25
10
F/m
12.0
10
V m/N
12.0mV m/N
v
8
12
8
3

▪
The sensitivity of a piezoelectric element is dependent on the direction of loading. This is 
because the sensitivity depends on the crystal axis. Sensitivities of several piezoelectric 
materials along their most sensitive crystal axis are listed in Table A.10.
Applications of piezoelectric materials include actuators for ink-jet printers, miniature 
step motors, force sensors, precision shakers, high-frequency oscillators, and acoustic 
amplifiers. Note that large kp values are desirable in piezoelectric actuators. For instance, 
PZT is used in microminiature step motors. On the other hand, small kp values are ­desirable 
in piezoelectric sensors (e.g., quartz accelerometers).
A.7  Magnetic Material and Inductor Element
Components made of magnetic material are useful in a range of applications. They include 
actuators (e.g., motors, magnetically levitated vehicles, tools, magnetic bearings), sensors 
and transducers, relays, resonators, and cores of inductors and transformers.
A.7.1  Magnetism and Permeability
When electrons move (or spin), a magnetic field is generated. The combined effect of such 
electron movements is the cause of magnetic properties of a material. In the linear range of 
operation of a magnetic element, we can write
	
µ
=
B
H	
(A.32)
TABLE A.10
Sensitivities of Several Piezoelectric Materials
Material
Charge Sensitivity Sq (pC/N)
Voltage Sensitivity Sv (mV·m/N)
Lead zirconate titanate 
110
10
Barium titanate
140
6
Quartz
2.5
50
Rochelle salt
275
90

509
Appendix A
where
B = magnetic flux density (Wb/m2 or T)
H = magnetic field strength (A/m)
M = permeability of the magnetic material
The relative permeability µr of a magnetic material is defined as
	
µ
µ
µ
=
0
	
(A.33)
where μ0 is the permeability of a vacuum (approximately 4π × 10−7 H/m).
Note: 1 tesla = 1 weber per square meter; 1 henry = 1 weber per ampere.
A.7.2  Hysteresis Loop
The B versus H curve of a magnetic material is not linear and exhibits a hysteresis loop, 
as shown in Figure A.10. It follows that µ is not a constant. Initial µ values (when magne-
tization is started at the demagnetized state of H = 0 and B = 0) are usually specified. Some 
representative values are given in Table A.11.
Properties of magnetic materials can be specified in terms of parameters of the hyster-
esis curve. Some important parameters are shown in Figure A.10; specifically,
B
Magnitude flux density (T)
H
Hc
Bsat
Br
Magnetic field (A/m)
FIGURE A.10
Hysteresis curve (magnetization curve) of a magnetic material.

510
Appendix A
	
(
)
=
=
=
H
B
B
coercive field or coercive force A/m
remnant flux density (Wb/m or T)
saturation flux density (T)
c
r
2
sat
Magnetic parameters of a few permanent-magnetic materials are given in Table A.12. 
Note that high values of Hc and Br are desirable for high-strength permanent magnets. 
Furthermore, high values of µ are desirable for core materials whose purpose is to 
­concentrate magnetic flux.
A.7.3  Magnetic Materials
Magnetic characteristics of a material can be imagined as if contributed by a matrix of 
microminiature magnetic dipoles. Paramagnetic materials (e.g., platinum and tungsten) 
have their magnetic dipoles arranged in a somewhat random manner. These materials 
have a µr value approximately equal to 1 (i.e., no magnetization). Ferromagnetic materials 
(e.g., iron, cobalt, nickel, and some manganese alloys) have their magnetic dipoles aligned 
in one direction (parallel) with virtually no cancellation of polarity. These ­materials have 
a high µr (on the order of 1000). Antiferromagnetic materials (e.g., chromium and man-
ganese) have their magnetic dipoles arranged in parallel, but in an alternately ­opposing 
manner, thereby virtually canceling the magnetization (µ = 1
r
). Ferrites have parallel 
­magnetic dipoles arranged alternately opposing, as in antiferromagnetic materials, but 
the adjacent dipoles have unequal strengths. Hence there is a resultant magnetization 
(µ  is on the order of 1000
r
).
TABLE A.12
Parameters of Some Magnetic Materials
Material
Hc (A/m)
Br (Wb/m2)
Alnico
4.6 × 104
1.25
Ferrites
14.0 × 104
0.65
Steel (carbon)
0.4 × 104
0.9
Steel (35% Co)
2.0 × 104
1.4
TABLE A.11
Initial Relative Permeability (Approximate) of Some 
Materials
Material
Relative Permeability µr
Alnico (Fe2 Ni Al)
6.5
Carbon steel
20
Cobalt steel (35% Co)
12
Ferrite (manganese-zinc)
800–10,000
Iron
200
Permalloy
3000
(78% Ni, 22% Fe)
Silicon iron (grain oriented)
500–1500

511
Appendix A
A.7.4  Piezomagnetism
When a stress (or strain) is applied to a piezomagnetic material, the degree of magnetiza-
tion of the material changes. Conversely, a piezomagnetic material undergoes deformation 
when the magnetic field in which the material is situated, is changed.
A.7.5  Hall-Effect Sensors
Suppose that a dc voltage vref is applied to a semiconductor element that is placed in a 
magnetic field in an orthogonal direction, as shown in Figure A.11. A voltage v0 is gener-
ated in the third orthogonal direction, as indicated in the figure. This is known as the 
Hall effect. Hall-effect sensors use this phenomenon. For example, the motion of a fer-
romagnetic element can be detected in this manner, since the magnetic field in which 
the sensor is mounted would vary as a result of the motion of the ferromagnetic ele-
ment. Hall-effect sensors are useful as position sensors, speed sensors, and commutation 
devices for motors.
N
Magnetic
field
Magnetic
source
Supply 
vref
Semiconductor
element
Hall sensor
output
v0
+
–
FIGURE A.11
A Hall-effect sensor.

512
Appendix A
A.7.6  Magnetic Bubble Memories
Consider a film of magnetic material such as gadolinium gallium garnet (Gd3Ga5O12) 
deposited on a nonmagnetic garnet layer (substrate). The direction of magnetization will 
be perpendicular to the surface of the film. Initially, some regions of the film will be N 
poles, and the remaining regions will be S poles. An external magnetic field can shrink 
either the N regions or the S regions, depending on the direction of the field. The size 
of the individual magnetic regions can be reduced to the order of µ
1 m in this manner. 
These tiny magnetic bubbles are the means by which information is stored in a magnetic 
bubble memory.
A.7.7  Reluctance
Suppose that a conducting coil having n turns is wound around a doughnut-shaped core 
of ferromagnetic material (e.g., soft iron). When a current i is applied to the coil magnetic 
flux φ(Wb) will be generated, which will flow through closed magnetic path of the core. 
This forms a simple magnetic circuit, as shown in Figure A.12.
The magnetomotive force (mmf) F, which enables the flow of magnetic flux, is given by
	
=
F
ni	
(A.34)
The equation for the magnetic circuit (analogous to Ohm’s law) is given by
	
ℜφ
=
F
	
(A.35)
in which ℜ is the reluctance of the magnetic circuit. Now suppose that the mean length of 
the closed core (magnetic circuit) is L and the area of cross-section is A. Then, in Equation 
A.32, B = φ/A and H = ni/L, which gives
	
ℜ
µ
= L
A
	
(A.36)
n Turns
Current i
Magnetic
flux φ  
Soft iron core
(length = L
cross-section area = A)
FIGURE A.12
A magnetic circuit.

513
Appendix A
This shows that the reluctance of a magnetic circuit is inversely proportional to the 
­permeability of the circuit material. Compare Equation A.36 with Equation A.15 for 
­electrical resistance.
A.7.8  Inductance
Suppose that a conducting coil having n turns is placed in a magnetic field of flux ϕ (Wb). 
The resulting flux linkage is nφ. If the flux linkage is changed, a voltage is induced in the 
coil. This induced voltage (v) is given by
	
φ
φ
(
)
=
=
v
d n
dt
n d
dt
	
(A.37)
If the change in magnetic flux is brought about by a change in current (i), we can write
	
=
v
L di
dt
	
(A.38)
where 
=
L
inductance of the coil (H). The linear inductor element is shown in Figure A.8c. 
As before, it can be easily shown using Equation A.38 that energy in an inductor is given by
	
=
E
Li
1
2
2	
(A.39)
This is the well-known electromagnetic energy of an inductor.
Also, by integrating Equation A.38, we obtain
	
∫
=
+
−
−
i t
i
L
vdt
( )
(0 )
1
t
0
	
(A.40)
Hence, for an inductor with a finite voltage, we have
	
=
+
−
i
i
(0 )
(0 )	
(A.41)
In summary:
	
1.	An inductor is an energy storage element (electromagnetic energy).
	
2.	Current is an appropriate response variable (or state variable) for an inductor. This 
is justified by two reasons: First, from Equation 2.20, the current at any time t 
can be completely determined with the knowledge of the initial current and the 
applied current during the time interval 0 to t. Second, from Equation 2.19, the 
energy of an inductor element can be represented by the variable i alone.
	
3.	Current through an inductor cannot change instantaneously unless an infinite 
voltage is applied.
	
4.	Current is a natural output variable, and voltage is a natural input variable for an 
inductor.
	
5.	Since its state variable, current, is a through variable, an inductor is a T-type 
element.

514
Appendix A
A.8  Active Electronic Components
An active device depends on an external power source to activate its behavior. Active com-
ponents made of semiconductor junctions, and field effect components are considered in 
this section. Junction diodes, bipolar junction transistors (BJTs), and field effect transistors 
(FETs) are of particular interest here. Active components are widely used in the monolithic 
(integrated-circuit) form as well as in the form of discrete elements. They are extensively 
used in both analog and digital electronic devices including sensors, actuator circuits, con-
trollers, interface hardware, and signal conditioning circuitry. In particular, the fields of 
consumer electronics and digital computers have been revolutionized due to the advances 
in active components. Understanding of the characteristics of the discrete components is 
important as well in application of the corresponding monolithic devices.
A.8.1  Diodes
A semiconductor diode is formed by joining a p-type semiconductor with an n-type 
semiconductor. A diode offers much less resistance to current flow in one direction (for-
ward) than in the opposite direction (reverse). There are many varieties of diodes. Zener 
diodes, voltage variable capacitor (VVC) diodes, tunnel diodes, microwave power diodes, 
PIN diodes, photodiodes, and light-emitting diodes (LED) are examples. First we need to 
understand pn junctions.
A.8.2  pn Junctions
Semiconductors exhibit properties that border conductors and insulators. A pure semi-
conductor can be “doped” by mixing a small quantity of special material, to form either 
a p-type semiconductor or an n-type semiconductor. A pn junction is formed by joining 
a p-type semiconductor element and an n-type semiconductor element. This subject is 
explored now.
A.8.3  Semiconductors
Semiconductor materials have resistivities that are several million times larger than those 
of conductors and several billion times smaller than those of insulators. Crystalline mate-
rials such as silicon, germanium, and cadmium sulfide (CdS) are semiconductors. For example, 
the resistivity of pure silicon is about 5 × 1010 times that of silver. Similarly, the resistivity 
of pure germanium is about 5 × 107 times that of silver. Typically, semiconductors have 
resistivities ranging from 10−4 to 107 Ωm. Other examples of semiconductor materials are 
gallium arsenide (GaAs), CdS, and selenium.
A pure (intrinsic) semiconductor material has some free electrons (negative charge car-
riers) and holes (positive charge carriers). Note that a hole is formed in an atom when an 
electron is removed. Strictly, the holes cannot move. But, suppose that an electron shared 
by two atoms (a covalent electron) enters an existing hole in an atom, leaving behind a hole 
at the point of origin. The resulting movement of the electron is interpreted as a movement 
of a hole in the direction opposite to the actual movement of the covalent electron.
The number of free electrons in a pure semiconductor is roughly equal to the number 
of holes. The number of free electrons or holes in a pure semiconductor can be drastically 

515
Appendix A
increased by adding traces of impurities in a controlled manner (doping) into the semi-
conductor during crystal growth (e.g., by alloying in a molten form, and by solid or gas-
eous diffusion of the trace). An atom of a pure semiconductor that has four electrons in 
its outer shell will need four more atoms to share in order to form a stable covalent bond. 
These covalent bonds are necessary to form a crystalline lattice structure of atoms which 
is typical of semiconductor materials. If the trace impurity is a material such as arsenic, 
phosphorus, or antimony whose atoms have five electrons in the outer shell (a donor impu-
rity), a free electron will be left over after the formation of a bond with an impurity atom. 
The result will be an n-type semiconductor having a very large number of free electrons. 
If, on the other hand, the trace impurity is a material such as boron, gallium, aluminum or 
indium whose atoms have only three electrons in the outer shell (an acceptor impurity), 
a hole will be resulted on formation of a bond. In this case, a p-type semiconductor, con-
sisting of a very large number of holes, will result. Doped semiconductors are termed 
extrinsic.
It is clear that doping can change the current-carrying characteristics of a semiconduc-
tor. These characteristics can be altered as well by temperature (the principle of a tem-
perature), stress (the principle of a strain gauge), magnetic field (in Hall-effect devices, for 
example), and light (the principle of a photosensor).
A.8.4  Depletion Region
When a p-type semiconductor is joined with an n-type semiconductor, a pn junction is 
formed. A pn junction exhibits the diode effect; much larger resistance to current flow in 
one direction than in the opposite direction across the junction. As a pn junction is formed, 
electrons in the n-type material in the neighborhood of the common layer will diffuse 
across into the p-type material. Similarly, the holes in the p-type material near the junction 
will diffuse into the opposite side (strictly, the covalent electrons will diffuse in the oppo-
site direction). The diffusion will proceed until an equilibrium state is reached. But, as a 
result of the loss of electrons and the gain of holes on the n side and the opposite process 
on the p side, a potential difference is generated across the pn junction, with a negative 
potential on the p side and a positive potential on the n side. Due to the diffusion of carri-
ers across the junction, the small region surrounding the common area will be virtually 
free of carriers (free electrons and holes). Hence, this region is called depletion region. The 
potential difference that exists in the depletion region is mainly responsible for the diode 
effect of a pn junction.
A.8.5  Biasing
The forward biasing and the reverse biasing of a pn junction are shown in Figure A.13. In 
the case of forward biasing, a positive potential is connected to the p side of the junction 
and a negative potential is connected to the n side. The polarities are reversed for reverse 
biasing. Note that in forward biasing, the external voltage (bias voltage v) complements the 
potential difference of the depletion region (Figure A.13a). The free electrons that crossed 
over to the p side from the n side will continue to flow toward the positive terminal of the 
external supply, thereby generating a current (junction current i). The junction current 
increases with the bias voltage, as shown in Figure A.13c.
In forward biasing, the potential in the depletion region is opposed by the bias volt-
age (Figure A.13b). Hence the diffusion of free electrons from the n side into the p side is 
resisted. Since there are some (very few) free electrons in the p side and some holes in the n 

516
Appendix A
side, the reverse bias will reinforce the flow of these minority electrons and holes. This will 
create a very small current (about 10−9 A for silicon and 10−6 A for germanium at room tem-
perature), known as the leakage current, in the opposite direction to the forward-bias cur-
rent. If the reverse bias is increased, at some voltage (breakdown voltage vb in Figure A.13c) 
the junction will break down, generating a sudden increase in the reverse current. There 
are two main causes of this breakdown. First, the intense electric field of the external volt-
age can cause electrons to break away from neutral atoms in large numbers. This is known 
as zener breakdown. Second, the external voltage will accelerate the minority free electrons 
on the p side (and minority holes on the n side) creating collisions that will cause electrons 
on the outer shells of neutral atoms to break away in large numbers. This is known as 
the avalanche breakdown. In some applications (e.g., rectifier circuits), junction breakdown 
is detrimental. In some other types of applications (e.g., as constant voltage sources and 
in some digital circuits), the breakdown state of specially designed diodes is practically 
utilized. Typical breakdown voltages of pn junctions made of three common semiconduc-
tor materials are given in Table A.13. Note that the breakdown voltage decreases with the 
concentration of the trace material.
p-type
n-type
p-type
n-type
–   +
Depletion region
Electron flow
v
Current i 
(a)
(b)
Junction
current i 
Forward
bias
Bias voltage v 
0
Reverse
bias
Leakage
current
Breakdown
voltage vb
(c)
100 V
0.6 V
FIGURE A.13
A pn-junction diode. (a) Forward biasing; (b) reverse biasing; (c) characteristic curve.

517
Appendix A
The current through a reverse-biased pn junction will increase exponentially with tem-
perature. For a forward-biased pn junction, current will increase with temperature at low 
to moderate voltages and will decrease with temperature at high levels of voltage.
A.8.6  Zener Diodes
Zener diodes are a particular type of diodes that are designed to operate in the neighbor-
hood of the reverse breakdown (both zener and avalanche breakdowns). In this manner, 
somewhat constant voltage output (the breakdown voltage) can be generated. This voltage 
depends on the concentration of the trace impurity. By varying the impurity concentra-
tion, output voltages in the range of 2–200 V may be realized from a zener diode. Special 
circuits would be needed to divert large currents that are generated at the breakdown 
point of the diode. The rated power dissipation of a zener diode should take into consid-
eration the current levels that would be possible in the breakdown region. Applications 
of zener diodes include constant voltage sources, voltage clipper circuits, filter circuits for 
voltage transients, digital circuits, and two-state devices.
Example A.6
A simple circuit for regulated voltage supply is shown in Figure A.14. An unregulated 
dc source of voltage vs is connected through a series resistor R to a zener diode in reverse 
bias. Assuming that vs is larger than the breakdown voltage of the diode, the output 
voltage vo of the circuit is maintained rather constant, as clear from the characteristic 
curve shown in Figure A.13c. Obtain an expression for the fluctuations in the output 
voltage in terms of the fluctuations in the voltage source.
Solution
The voltage summation in the circuit loop gives
	
=
+
v
Ri
v
s
o	
(i)
TABLE A.13
Typical Breakdown Voltage of pn Junction at Room Temperature
Semiconductor
Breakdown Voltage (V)
Dope concentration = 1015 
atoms/cm3
Dope concentration = 1017 
atoms/cm3
Germanium
400
5.0
Silicon
300
11.0
Gallium arsenide
150
16.0
R
+
–
vs
vo
i
FIGURE A.14
A voltage regulator using a zener diode.

518
Appendix A
where i is the current through R, which is the same as the current through the diode, 
assuming that output is in open circuit (or, the load resistance is quite high). The signal 
fluctuations are expressed as differentials in this equation; thus
	
δ
δ
δ
=
+
v
R i
v
s
o	
(ii)
Also, for the diode we have
	
δ
δ
=
v
i
R
o
z	
(iii)
where Rz is the resistance provided by the zener diode. Substitute Equation iii in 
Equation ii to obtain
	
δ
δ
=
+
v
R
R
R
v
o
z
z
s
Since Rz is quite small compared to R, following the breakdown of the diode, as is clear 
from the slope of the left-hand curve of Figure A.13c beyond breakdown, δvo will be 
quite small compared to δv .
s 
▪
A.8.7  VVC Diodes
VVC diodes use the property of a diode that, in reverse bias, the diode capacitance decreases 
(nonlinearly) with the bias voltage. The depletion region of a pn junction is practically free 
of carriers (free electrons and holes) and hence behaves like the dielectric medium of a 
capacitor. The adjoining p region and n region serve as the two plates of the capacitor. The 
width of the depletion region increases with the bias voltage. Consequently, the capaci-
tance of a reverse biased pn junction decreases as the bias voltage is increased. Obtainable 
range of capacitance can be varied by changing the dope concentration and also by distrib-
uting the dope concentration nonuniformly along the diode. For example, a capacitance 
variation of 5–500 pF may be obtained in this manner (Note: 1 pF = 1 × 10−12 F). VVC diodes 
are also known as varactor diodes and varicaps, and are useful in ­voltage-controlled tuners 
and oscillators.
A.8.8  Tunnel Diodes
The depletion of a pn junction can be made very thin by using very high dope concentra-
tions (in both p and n sides). The result is a tunnel diode. Since the depletion region is 
very narrow, charge carriers (free electrons and holes) in the n and p sides of the diode 
can tunnel through the region into the opposite side, on application of a relatively small 
voltage. The voltage-current characteristic of a tunnel diode is quite linear at low (for-
ward and reverse) voltages. When the forward bias is further increased, however, the 
behavior becomes quite nonlinear; the junction current peaks, then drops (a negative con-
ductance) to a minimum (valley), and finally rises again, as the voltage is increased. Due 
to the linear behavior of the tunnel diode at low voltages, almost instantaneous current 
reversal (i.e., very low reverse recovery time) can be achieved by switching the bias volt-
age. Tunnel diodes are useful in high-frequency switching devices, sensors, and signal 
conditioning circuits.

519
Appendix A
A.8.9  PIN Diodes
The width of the depletion region of a conventional pn junction varies with many factors, 
primarily the applied (bias) voltage. The capacitance of a junction depends on this width 
and varies due to such factors. A diode with practically a constant capacitance is obtained 
by adding a layer of silicon in between the p and n elements. The sandwiched silicon 
layer is called the intrinsic layer, and the diode is called a PIN diode. The resistance of a 
PIN diode varies inversely with the junction current. PIN diodes are useful as current-
controlled resistors at constant capacitance.
A.8.10  Schottky Barrier Diodes
Most diodes consist of semiconductor–semiconductor junctions. An exception is a Schottky 
barrier diode, which consists of a metal-semiconductor (n-type) junction. A metal such as 
gold, silver, platinum, or palladium and a semiconductor such as silicon or GaAs may be used 
in the construction. Since no holes exist in the metal, a depletion region cannot be formed 
at the metal-semiconductor junction. Instead an electron barrier is formed by the free elec-
trons from the n-type semiconductor. Consequently, the junction capacitance will be neg-
ligible and the reverse recovery time will be very small. For this reason, Schottky diodes 
can handle very high switching frequencies (109 Hz range). Since by using a reverse bias, 
the electron barrier is easier to penetrate than a depletion region, Schottky diodes exhibit 
much lower breakdown voltages. Operating noise is also lower than for semiconductor-
semiconductor diodes.
A.8.11  Thyristors
A thyristor, also known as a silicon-controlled rectifier, a solid-state controlled rectifier, a 
­semiconductor-controlled rectifier, or simply an SCR, possesses some of the characteristics 
of a semiconductor diode. It consists of four layers (pnpn) of semiconductor, and has three 
­terminals—the anode, the cathode, and the gate—as shown in Figure A.15a. The circuit sym-
bol for a thyristor is shown in Figure A.15b. The thyristor current is denoted by i, the exter-
nal voltage is v, and the gate potential is vg. The characteristic curve of a thyristor is shown 
in Figure A.15c. Note that a thyristor cannot conduct in either direction (i almost zero) until 
either the reverse voltage reaches the reverse breakdown voltage (vb), or the forward volt-
age reaches the forward breakover voltage (vfb). The forward breakover is a bistable state 
and once this voltage is reached, the voltage drops significantly and the thyristor begins 
to conduct like a forward-biased diode. When vg is less than or equal to zero with respect 
to the cathode, vfb becomes quite high. When vg is made positive, vfb becomes small and 
vfb will decrease as the gate current (ig) is increased. A small positive vg can make vfb very 
small, and then the thyristor will conduct from anode to cathode but not in the opposite 
direction (i.e., it behaves like a diode). It follows that a thyristor behaves like a voltage-­
triggered switch; a positive firing signal (a positive vg) will close the switch. The switch 
will be opened when both i and vg are made zero. When the supply voltage v is dc and 
nonzero, the thyristor will not be able to turn itself off. In this case, a commutating circuit 
that can make the trigger voltage vg slightly negative, has to be employed. Thyristors are 
commonly used in control circuits for dc and ac motors.
Parameter values for diodes are given in data sheets provided by the manufacturer. 
Commonly used variables and characteristic parameters in association with diodes are 
described in Table A.14. For thyristors, as mentioned before, several other quantities such 

520
Appendix A
as vfb, vg, and ig should be included. The time required for a thyristor to be turned on by 
the trigger signal (turn-on time) and the time for it to be turned off through commuta-
tion (turnoff time) determine the maximum switching frequency (bandwidth) for a thyristor. 
Another variable that is important is the holding current or latching current, which denotes 
the small forward current that exists at the breakover voltage.
A.9  Transistors
A.9.1  Bipolar Junction Transistors
A BJT has two junctions, which are formed by joining p regions and n regions. Two types 
of transistors, npn and pnp, are possible with this structure. A BJT has three terminals, as 
indicated in Figure A.16a. The middle (sandwiched) region of a BJT is thinner than the end 
regions, and this region is known as the base. The end regions are termed the emitter and 
p
n
p
n
Gate
Anode
Cathode
(a)
Gate
Anode
Cathode
v
i
vg
(b)
(c)
Thyristor
current  i
Supply voltage v
0
vb
Gate
on
Gate off ( vg = 0)
vfb
FIGURE A.15
The thyristor. (a) Schematic representation; (b) circuit symbol; (c) characteristic curve.

521
Appendix A
the collector. Under normal conditions, the emitter-base junction is forward biased and the 
collector-base junction is reverse biased, as shown in Figure A.16b.
To explain the behavior of a BJT, consider an npn transistor under normal biasing. The 
forward bias at the emitter-base junction will cause free electrons in the emitter to flow into 
the base region, thereby creating the emitter current (ie). The reverse bias at the collector-
base junction will increase the depletion region there. The associated potential difference 
at the collector-base junction will accelerate the free electrons in the base into the collector 
and will form the collector current (ic). Holes that are created in the base for recombination 
with some free electrons that entered the base will form the base current (ib). Usually, ic is 
slightly smaller than ie. Furthermore, ib is much smaller than ic.
TABLE A.14
Characteristic Variables and Parameters for Diodes
Diode Parameter
Diode Variable
Description
Forward bias 
vf
A positive external voltage at p with respect to n
Reverse bias
vr
A positive external voltage at n with respect to p
Breakdown voltage
vb
The minimum reverse bias that will break down the 
junction resistance
Junction current
if
Forward current through a forward-biased diode
Leakage current
ir
Reverse current through a reverse-biased diode
Transition capacitance 
Ct
Capacitance (in the depletion region) of a reverse-biased 
diode
Diffusion capacitance 
Cd
Capacitance exhibited while a forward biased diode is 
switched off
Forward resistance 
Rf
Resistance of a forward-biased diode
Reverse recovery time 
trr
Time needed for the reverse current to reach a specified 
level when the diode is switched from forward to reverse
Operating temperature range 
TA
Allowable temperature range for a diode during operation
Storage temperature range 
Tsrg
Temperature that should be maintained during storage of 
a diode
Power dissipation 
P
The maximum power dissipation allowed for a diode at 
a specified temperature
(a)
n
p
n
Base
(B)
Emitter
Collector
(C)
(E)
p
n
p
B
C
E
(b)
ie
ib
ic
E
C
B
ie
ib
ic
E
C
B
FIGURE A.16
BJTs. (a) npn and pnp transistors; (b) circuit symbols and biasing.

522
Appendix A
A.9.2  Transistor Characteristics
The common-emitter connection is widely used for transistors in amplifier applications. In 
this configuration, the emitter terminal will be common to the input side and the output 
side of the circuit. Transistor characteristics are usually specified for this configuration. 
Figure A.17 shows typical characteristic curves for a junction transistor in the common-
emitter connection. In this configuration, both voltage gain (output voltage/input voltage) 
and current gain (collector current/base current) will be greater than unity, thereby provid-
ing a voltage amplification as well as a current amplification. Note from Figure A.17 that the 
control signal is the base current (ib), and the characteristic of the transistor depends on ib. 
This is generally true for any BJT; a BJT is a current-controlled transistor. In the common-base 
configuration, the base terminal is common to both input and output.
Maximum frequency of operation and allowable switching rate for a transistor are deter-
mined by parameters such as rise time, storage time, and fall time. These and some other use-
ful ratings and characteristic parameters for BJTs are defined in Table A.15. Values for these 
parameters are normally given in the manufacturer’s data sheet for a particular transistor.
A.9.3  Fabrication Process of Transistors
The actual manufacturing process for a transistor is complex and delicate. For example, an 
npn transistor can be fabricated by starting with a crystal of n-type silicon. This starting 
element is called the wafer or substrate. An npn transistor is formed in the top half of the sub-
strate, by using the planar diffusion method, as follows: The substrate is heated to about 1000°C. 
A gas stream containing a donar-type impurity (which forms n-type regions) is impinged on 
the crystal surface. This produces an n-type layer on the crystal. Next, the crystal is oxidized 
by heating to a high temperature. The resulting layer of silicon dioxide acts as an insulating 
surface. A small area of this layer is then dissolved off to form a window, using hydrofluoric 
Collector-emitter voltage vce (V)
2
4
6
8
10
2
4
6
8
10
Base-current ib = 20 mA
ib = 40 mA
ib = 60 mA
ib = 80 mA
ib = 100 mA
ib = 120 mA
Collector current ic (mA)
FIGURE A.17
Characteristic curves of a common emitter BJT.

523
Appendix A
acid. The crystal is again heated to 1000°C and a gas stream containing acceptor-type impurity 
(which forms p-type regions) is impinged on the window. This produces a p region under the 
window, on top of the n region, which was formed earlier.
Oxidation is repeated to cover the newly formed p region. Using hydrofluoric acid, a 
smaller window is cut on the latest silicon dioxide layer, and a new n region is formed 
as before, on top of the p region. The entire manufacturing process has to be properly 
controlled so as to control the properties of the resulting transistor. Aluminum contacts 
have to be deposited on the uppermost n region, the second p region (in a suitable annular 
window cut on the silicon dioxide layer), and on the n region below it or on the crystal sub-
strate. A pictorial representation of an npn transistor fabricated in this manner is shown 
in Figure A.18.
A.9.4  Field Effect Transistors
A FET, unlike a BJT, is a voltage-controlled transistor. The electrostatic field generated by a 
voltage applied to the gate terminal of a FET controls the behavior of the FET. Since the 
device is voltage controlled at very low input current levels, the input impedance is very high 
and the input power is very low. Other advantages of an FET over a BJT are that the former 
is cheaper and requires significantly less space on a chip in the monolithic form. FETs are 
somewhat slower (in terms of switching rates) and more nonlinear than BJTs, however.
There are two primary types of FETs: metal oxide semiconductor FET (MOSFET) and junc-
tion FET (JFET). Even though the physical structure of the two types is somewhat differ-
ent, their characteristics are quite similar. Insulated gate FET (or IGFET) is a general name 
given to a MOSFET.
TABLE A.15
Rating Parameters for Transistors
Transistor Parameter
Transistor 
Variable
Description
Collector to base voltage 
vcb
Voltage limit across collector and base with emitter open
Collector to emitter voltage 
vce
Voltage limit across collector and emitter with base connected 
to emitter
Emitter to base voltage
veb
Voltage limit across emitter and base with collector open
Collector cutoff current
ico
Reverse saturation current at collector with either emitter open 
(icbo) or base open (iceo)
Transistor dissipation 
PT
Power dissipated by the transistor at rated conditions
Input impedance 
hi
Input voltage/input current with output voltage = 0 (defined 
for both common emitter and common base configurations, 
hie, hib)
Output admittance 
ho
Output current/output voltage with input current = 0 (hoe, hob 
are defined)
Forward current transfer ratio
hf
Output current/input current with output voltage = 0 (hfe, hfb 
are defined)
Reverse voltage transfer ratio
hr
Input voltage/output voltage with input current = 0 (hre, hrb are 
defined)
Rise time
tr
Time taken to reach the full current level for the first time 
when turned on
Storage time 
ts
Time taken to reach the steady current level when turned on
Fall time 
tf
Time taken for the current to reach zero when turned off

524
Appendix A
A.9.5  The MOSFET
An n-channel MOSFET is produced using a p-type silicon substrate, and a p-channel 
MOSFET by an n-type substrate. An n-channel MOSFET is shown in Figure A.19a. During 
manufacture, two heavily doped n-type regions are formed on the substrate. One region 
is termed source (S) and the other region drain (D). The two regions are connected by a 
moderately doped and narrow n region called channel. A metal coating deposited over 
an insulating layer of silicon dioxide, which is formed on the channel, is the gate (G). The 
source lead is usually joined with the substrate lead. This is a depletion-type MOSFET (or 
D-MOSFET). Another type is the enhancement-type MOSFET (or E-MOSFET). In this type, 
a channel linking the drain and the source is not physically present in the substrate, but is 
induced during operation of the transistor.
Consider the operation of the n-channel D-MOSFET shown in Figure A.19a. Under nor-
mal operation, the drain is positively biased with respect to the source. Drain current id 
is considered the output of a MOSFET (analogous to the collector current of a BJT). The 
control signal of a MOSFET is the gate voltage vgs with respect to the source (analogous to 
the base current of a BJT). It follows that a MOSFET is a voltage-controlled device. Since the 
source terminal is used as the reference for both input (gate voltage) and output (drain), 
this connection is called the common-source configuration. Suppose that the gate voltage is 
negative with respect to the source. This will induce holes in the channel, thereby decreas-
ing the free electrons there through recombination. This in turn will reduce the concen-
tration of free electrons in the drain region and hence will reduce the drain current id. 
Clearly, if the magnitude of the negative voltage at the gate is decreased, the drain current 
will increase, as indicated by the characteristic curves in Figure A.19b. A positive bias at 
the gate will further increase the drain current of an n-channel MOSFET, as shown. The 
opposite will be true for a p-channel MOSFET.
A.9.6  The JFET
A JFET is different in physical structure to a MOSFET, but similar in characteristic. The 
structure of an n-channel JFET is shown in Figure A.20. It consists of two p-type regions 
formed inside an n-type region. The two p regions are separated by a narrow n region 
called channel. The channel links two n-type regions called source (S) and drain (D). The 
two p regions are linked by a common terminal and form the gate (G). As in the case of a 
MOSFET, drain current id is considered the output of the JFET and gate voltage vgs with 
Silicon wafer (substrate)
N
N
P
Silicon diode
(insulator)
Aluminum
plate
Base
Emitter
Collector
FIGURE A.18
An npn transistor manufactured by the planar diffusion method.

525
Appendix A
respect to the source is considered the control signal. For normal operation, the drain is 
positively biased with respect to the source, as for an n-channel MOSFET, and the common-
source configuration is used.
To explain the operation of a JFET, consider the n-channel JFET shown in Figure A.20. 
Depletion regions are present at the two pn junctions of the JFET (as for a semiconductor 
diode). If the gate voltage is made negative, the resulting field will weaken the p regions. 
As a result, the depletion regions will shrink. Some of the free electrons from the drain will 
diffuse toward the channel to occupy the growing n regions due to the shrinking deple-
tion regions. This will reduce the drain current. It follows that drain current decreases as 
(a)
p-substrate
n+
n+
n
Substrate
Channel (n)
n+ = Heavily
doped n regions
SiO2
insulator
Platinum
plate
+
–
Source
(S)
Drain D
Gate G
id
vg
–
(b)
Drain-source voltage vds (V)
id (mA)
Gate-source voltage vgs = –2V
vgs = –1V
vgs = 0V
vgs = 1V
vgs = 2V
10
20
10
20
30
0
Drain current
FIGURE A.19
A metal oxide semiconductor FET, (a) An n-channel depletion-type MOSFET; (b) D-MOSFET characteristics.

526
Appendix A
the magnitude of the negative voltage at the gate is increased. This behavior is similar to 
that of a MOSFET. A p-channel JFET has two n regions representing the gate and two p 
regions forming the source and the drain, which are linked by a p-channel. Its character-
istic is the reverse of an n-channel JFET.
Common types of transistors are summarized in Table A.16. Semiconductor devices 
have numerous uses. A common use is as switching devices or as two-state elements. 
Typical two-state elements are schematically illustrated in Figure A.21.
Example A.7
The temperature dependence of a BJT allows its use as a temperature sensor. The rel-
evant relation (Ebers-Moll model) is
	
=
v
kT
q
i
I
ln
eb
c
s
	
(A.42)
where
T = absolute temperature (°K)
k = Boltzmann constant (1.38 × 10−23 J/K)
q = electron charge magnitude (1.6 × 10−19 C)
Is = saturation current
The difficulty here is that Is also varies with temperature. This problem can be over-
come by using two identical transistors with a common base, and maintaining their 
collector currents (ic) at a fixed ratio. An appropriate circuit is shown in Figure A.22. 
Obtain an expression for the output vo for the circuit and show that this varies lin-
early with T.
Solution
For the two transistors, which are identical, we have
	
=
v
kT
q
i
I
ln
eb
c
s
2
2
	
=
v
kT
q
i
I
ln
eb
c
s
1
1
p
–
+
Source
(S)
Drain (D)
Gate (G)
p
n
n
FIGURE A.20
An n-channel JFET.

527
Appendix A
Subtracting the second equation from the first, we obtain
	
−
=
v
v
kT
q
i
i
ln
eb
eb
c
c
2
1
2
1
Note that the temperature-dependent term Is has been eliminated. Thus
	
=
v
kT
q
i
i
ln
o
c
c
2
1
	
(A.43)
It is seen that the output voltage varies linearly with temperature. The ratio of the ­collector 
currents (i
i/
c
c
2
1 ) has to be maintained constant when taking sensor readings.
▪
A.9.7  Switching Elements
Semiconductor devices are particularly useful as high-frequency switching elements in 
circuits. For example, in pulse width modulation, the average voltage and power supplied 
TABLE A.16
Common Transistor Types
Transistor Type
Description
Abbreviation
Name
BJT
Bipolar junction transistor
A three-layer device (npn or pnp)
Current controlled
Control = base current
Output = collector current
FET
Field effect transistor
A physical or induced channel
(n-channel or p-channel) voltage controlled
Control = gate voltage
Output = drain current
MOSFET
Metal oxide semiconductor FET
n-channel or p-channel
D-MOSFET
Depletion-type MOSFET
A channel is physically present
E-MOSFET
Enhancement-type MOSFET
A channel is induced
VMOS
V-shaped gate MOSFET or VFET
An E-MOSFET with increased power handling 
capacity
DG-MOS
Dual-gate MOSFET
A secondary gate is present between main gate and 
drain (lower capacitance)
D-MOS
Double-diffused MOSFET
A channel layer is formed on a high-resistivity 
substrate and then source and drain are formed 
(by diffusion). High breakdown voltage
CMOS
Complementary symmetry MOSFET
Uses two E-MOSFETs (n channel and p channel). 
Symmetry is used to save space on chip. Cheaper and 
lower power consumption.
GaAs
Gallium arsenide MOSFET
Uses GaAs, aluminum GaAs, (AlGaAs), InGaAsP, etc. 
in place of silicon substrate. Faster operation
JFET 
Junction FET 
p-channel or n-channel. Has two (n or p) regions in a 
(p or n) region linked by a channel (p or n)
Control = gate voltage
Output = drain current

528
Appendix A
v0
v0
Aluminum
contacts
+
–
ie
ic
ic
ib
ib
vce
vds
vds
vgs
vgs
id
id
vce
Control
signal
Physical
representation
Relay
contact
Insulator
Solenoid
To output
circuit
Circuit symbol
Schematic
diagram
Control
circuit
Output
circuit
Output
Characteristic
curve
On
Off
Control
current
0
Output
voltage
n
n
D
G
S
Silicon dioxide
(insulator)
Aluminum plate
p = substrate
(silicon)
Substrate
Channel
(n)
+
+
Source
(S)
p = substrate _
Gate (G)
Drain (D)
0
i
v
Reverse
breakdown
voltage
+
_
i
v
n
p
Anode
Cathode
Collector
Emitter
Base
+
_
n
p
Collector
Emitter
n
Base
0
0
(a)
(b)
(c)
(d)
FIGURE A.21
Discrete switching (two-state) elements. (a) Electromagnetic relay; (b) zener diode; (c) BJT (npn); (d) n-channel 
MOSFET.

529
Appendix A
by a drive circuit (e.g., amplifier connected to a motor) are varied by varying the duty ratio. 
Here, the switching frequency and the output voltage level are kept constant.
The duty ratio is defined as
	
=
+
d
t
t
t
on
on
off
	
(A.44)
where ton is the on time of the switch and toff is the off time of the switch within a switching 
cycle. The switching frequency is given by
	
=
+
f
t
t
1
s
on
off
	
(A.45)
A.10  Light Emitters and Displays
Visible light is part of the electromagnetic spectrum. Electromagnetic waves in the wavelength 
range of 390–770 nm form the visible light (Note: 1 nm = 1 × 10−9 m.). Ultraviolet rays and 
X-rays are also electromagnetic waves, but have lower wavelengths (higher frequencies). 
Infrared rays, microwaves, and radio waves are electromagnetic waves having higher 
wavelengths. Table A.17 lists wavelengths of several types of electromagnetic waves. 
Visible light occupies a broad range of wavelengths. In optical coupling applications, for 
example, the narrower the wave spectrum the clearer (noise free) the coupling process. 
Consequently, it is advantageous to use light sources with particular spectral character-
istics in applications of that nature. In particular, since visible light can be contaminated 
by environmental light, thereby introducing an error signal into the optical device, it is 
also useful to consider electromagnetic waves that are different from what is commonly 
present in operating environments, in applications such as sensing, optical coupling, 
switching, and signal processing. Lighting is also crucial in a variety of automated indus-
trial processes, for object recognition and measurement, product inspection and grading, 
defect recognition and quality control, image analysis, computer vision, and visual servo-
ing of robotic manipulators.
R1
R2
vo
–v
+
−
FIGURE A.22
A circuit for a semiconductor temperature sensor.

530
Appendix A
A.10.1  Light-Emitting Diodes
Semiconductor-based light sources such as LED are integral components of optoelectronic 
devices. The basic components of an LED are shown in Figure A.23a. The element symbol 
that is commonly used in electrical circuits is shown in Figure A.23b. The main component 
of an LED is a semiconductor diode element, typically made of gallium compounds (e.g., 
GaAs and GaAs phosphide or GaAsP). When a voltage is applied in the forward-bias direction 
to this semiconductor element, it emits visible light (and also other electromagnetic wave 
components, primarily infrared). An LED needs a somewhat higher voltage (about 2 V) for 
its activation (in forward bias) than an ordinary silicon diode. In the forward-bias con-
figuration electrons are injected into the p region of the diode and recombined with holes. 
Radiation energy (including visible light) is released spontaneously in this process. This is 
the principle of operation of an LED. Suitable doping with trace elements such as nitrogen 
will produce the desired effect. The radiation energy generated at the junction of a diode 
has to be directly transmitted to a window of the diode in order to reduce absorption 
losses. Two types of construction are commonly used; edge emitters emit radiation along the 
edges of the pn junction and surface emitters emit radiation normal to the junction surface.
Infrared LEDs (IRED) are LEDs that emit infrared radiation at a reasonable level of power. 
GaAs, gallium aluminum arsenide (GaA/As), and indium GaAsP (InGaAsP) are the commonly 
used IRED material. Gallium compounds and not silicon or germanium are used in LEDs for 
reasons of efficiency of energy conversion and intensity characteristics (gallium compounds 
exhibit sharp peaks of spectral output in the desired frequency bands). Table A.18 gives 
wave-length characteristics of common LED and IRED types 
=
×
=
−
(1Å
1
10
m
0.1nm).
10
 
TABLE A.17
Wavelengths of Several Selected Components 
of the Electromagnetic Spectrum
Wave Type
Approximate Wavelength 
Range (μm)
Radio waves
1 × 106 – 5 × 106
Microwaves
1 × 103 – 1 × 106
Infrared rays
0.8 – 1 × 103
Visible light
0.4 – 0.8
Ultraviolet rays
1 × 10−2 – 0.4
X-rays
1 × 10−6 – 5 × 10−2
External
leads
Semiconductor
element
Metal
housing
Glass
window
(a)
(b)
FIGURE A.23
An LED. (a) Physical construction; (b) circuit symbol.

531
Appendix A
Note: Å denotes the unit “angstrom.” These diodes come in small size (e.g., few millimeters 
in diameter) and use small currents (20–100 mA) at low voltages (2 V).
LEDs are widely used in optical electronics because of their energy conversion effi-
ciency, spectral composition, speed, size, durability, and low cost. They can be constructed 
in miniature sizes, they have small time constants and low impedances, they can provide 
high switching rates (typically >1000 Hz), and they have much longer component life than 
incandescent lamps. They are useful as both light sources and displays.
A.10.2  Lasers
Laser (light amplification by stimulated emission of radiation) is a light source that emits a 
concentrated beam of light, which will propagate typically at one or two frequencies (wave-
lengths) and in phase. Usually, the frequency band is extremely narrow, (i.e., monochro-
matic) and the waves in each frequency are in phase (i.e., coherent). Furthermore the energy 
of a laser is highly concentrated (power densities on the order of one billion W/cm2). 
Consequently a laser beam can travel in a straight line over a long distance with very little 
dispersion. Hence it is a structured light source that is particularly useful in imaging, 
gauging and aligning applications. Lasers can be used in a wide variety of sensors (e.g., 
motion sensors, tactile sensors, laser Doppler velocity sensors, 3D imaging) that employ 
photosensing and fiber optics. Also, lasers are used in medical applications, microsurgery 
in particular. Lasers have been used in manufacturing and material removal applications 
such as precision welding, cutting, and drilling of different types of materials, including 
metals, glass, plastics, ceramics, rubber, leather, and cloth. Lasers are used in inspection 
(detection of faults and irregularities) and gauging (measurement of dimensions) of parts. 
Other applications of lasers include heat treatment of alloys, holographic methods of non-
destructive testing, communication, information processing, and high-quality printing.
Lasers may be classified as solid, liquid, gas, and semiconductor. In a solid laser (e.g., ruby laser, 
glass laser) a solid rod with reflecting ends is used as the laser medium. The laser medium 
of a liquid laser (e.g., dye laser, salt-solution laser) is a liquid such as an organic solvent with a 
dye or an inorganic solvent with dissolved salt compound. Very high peak power levels are 
possible with liquid lasers. Gas lasers [e.g. helium-neon (He-Ne) laser, helium-cadmium (He-
Cd) laser, carbon dioxide (CO2) laser] use a gas as the laser medium. Semiconductor lasers 
(e.g., GaAs laser) use a semiconductor diode similar to an edge-­emitting LED. Some lasers 
have their main radiation components outside the visible spectrum of light. For example, 
CO2 laser (wavelength of about 110,000 Å) primarily emits infrared radiation.
TABLE A.18
Wavelength Characteristics of Common LEDs (
)
=
×
−
1Å
1
10
m
10
LED Type 
Wavelength at Peak 
Intensity (Å)
Color
GaAs
5,500
Green
9,300
Infrared
GaAsP
5,500
Green
7,000
Red
Gallium Phosphide
5,500
Green
GaA/As
8,000
Red
8,500
Infrared
InGaAsP
13,000
Infrared

532
Appendix A
In a conventional laser unit, the laser beam is generated by first originating an excita-
tion to create a light flash. This will initiate a process of emitting photons from molecules 
within the laser medium. This light is then reflected back and forth between two reflecting 
surfaces before the light beam is finally emitted as a laser. These waves will be limited to a 
very narrow frequency band (monochromatic) and will be in phase (coherent). For example, 
consider the He-Ne laser unit schematically shown in Figure A.24. The helium and neon 
gas mixture in the cavity resonator is heated by a filament lamp and ionized using a high 
dc voltage (2000 V). Electrons released in the process will be accelerated by the high volt-
age and will collide with the atoms, thereby releasing photons (light). These photons will 
collide with other molecules, releasing more photons. This process is known as lasing. The 
light generated in this manner is reflected back and forth by the silvered surface and the 
partially reflective lens (beam splitter) in the cavity resonator, thereby stimulating it. This 
is somewhat similar to a resonant action. The stimulated light is concentrated into a nar-
row beam by a glass tube and emitted as a laser beam, through the partially silvered lens.
A semiconductor laser is somewhat similar to an LED. The laser element is typically made 
of a pn junction (diode) of semiconductor material such as GaAs or InGaAsP. The edges 
of the junction are reflective (naturally or by depositing a film of silver). As a voltage is 
applied to the semiconductor laser, the ionic injection and spontaneous recombination that 
take place near the pn junction will emit light as in an LED. This light will be reflected back 
and forth between the reflective surfaces, passing along the depletion region many times 
and creating more photons. The stimulated light (laser) beam is emitted through an edge 
of the pn junction. Semiconductor lasers are often maintained at very low temperatures in 
order to obtain a reasonable component life. Semiconductor lasers can be manufactured in 
very small sizes. They are lower in cost and require less power in comparison to the con-
ventional lasers. Wavelength and power output characteristics of several types of lasers 
are given in Table A.19.
Silvered
surface
High-voltage
dc supply
Glass tube
ac
Filament
lamp
Laser
beam
Partially
reflective
lens
Gravity
resonator
He, Ne,
gases
FIGURE A.24
He-Ne laser.

533
Appendix A
A.10.3  Liquid Crystal Displays
A liquid crystal display (LCD) consists of a medium of liquid crystal material (e.g., organic 
compounds such as cholesteryl nonanote and p-azoxyanisole) trapped between a glass sheet 
and a mirrored surface, as shown in Figure A.25. Pairs of transparent electrodes (e.g., 
indium tin oxide), arranged in a planar matrix, are deposited on the inner surfaces of the 
sandwiching plates. In the absence of an electric field across an electrode pair, the atoms 
of liquid crystal medium in that region will have a parallel orientation. As a result, any 
light that falls on the glass sheet will first travel through the liquid crystal, then will be 
reflected back by the mirrored surface, and finally will return unscattered. Once an elec-
trode pair is energized, the molecular alignment of the entrapped medium will change, 
causing some scattering. As a result a dark region in the shape of the electrode will be 
TABLE A.19
Properties of Several Types of Lasers (
)
=
×
−
1Å
1
10
m
10
Laser Type
Wavelength Å
( )
Output Power (W)
Solid
Ruby
7,000
0.1 – 100
Glass
1,000
0.1 – 500
Liquid
Dye
4,000 – 10,000
0.001 – 1
Gas
He-Ne
6,330
0.001 – 2
He-Cd
4,000
0.001 – 1
Carbon dioxide
110,000
1–1 × 104
Semiconductor
GaAs
9,000
0.002 – 0.01
InGaAsP
13,000
0.001 – 0.005
Glass
surface
Liquid crystal
medium
Transparent
electrodes
Mirrored
surface
FIGURE A.25
An LCD element.

534
Appendix A
visible. Alphanumeric characters and other graphic images can be displayed in this man-
ner, by energizing a particular pattern of electrodes.
Other types of LCD construction are available as well. In one type, polarized glass sheets 
are used to entrap the liquid crystal. In addition, a special coating is applied on the inner 
surfaces of the two sheets that will polarize the liquid crystal medium in different direc-
tions. This polarization structure is altered by an electric field (supplied by an electrode 
pair), thereby displaying an image element. LCDs require external light to function. But 
they need significantly low currents and power levels to operate. For example, an LED 
display might need a watt of power whereas a comparable LCD might require just a small 
fraction of a megawatt. Similarly, the current requirement for an LCD is in the microam-
pere range. LCDs usually need an ac biasing, however. An image resolution on the order 
of five lines/mm is possible with an LCD.
A.10.4  Plasma Displays
A plasma display is somewhat similar to an LCD in construction. The medium used in a 
plasma display is an ionizing gas (e.g., neon with traces of argon or xenon). A planar matrix 
of electrode pairs is used on the inner surfaces of entrapping glass. When a voltage above 
the ionizing voltage of the medium is applied to the electrode pair, the gas will breakdown 
and a discharge will result. The electron impacts generated at the cathode as a result will 
cause further release of electrons to sustain the discharge. A characteristic orange glow will 
result. The pattern of energized electrodes will determine the graphic image.
The electrodes could be either dc coupled or ac coupled. In the case of the latter, the elec-
trodes are coated with a layer of dielectric material to introduce a capacitor at the gas 
interface. The power efficiency of a plasma display is higher than that of an LED display. A 
typical image resolution of two lines/mm is obtainable.
A.11  Light Sensors
Semiconductor-based light sensors as well as light sources are needed in optoelectronics. 
A light sensor (also known as a photodetector or photosensor) is a device that is sensitive to 
light. Usually it is a part of an electrical circuit with associated signal conditioning (ampli-
fication, filtering, etc.) so that an electrical signal representative of the intensity of light 
falling on the photosensor is obtained. Some photosensors can serve as energy sources 
(cells) as well. A photosensor may be an integral component of an optoisolator or other 
optically coupled system. In particular, a commercial optical coupler typically has an LED 
light source and a photosensor in the same package, with leads for connecting it to other 
circuits, together with power leads.
By definition, the purpose of a photodetector or photosensor is to sense visible light. 
But there are many applications where sensing of adjoining bands of the electromagnetic 
spectrum, namely infrared radiation and ultraviolet radiation, would be useful. For instance, 
since objects emit reasonable levels of infrared radiation even at low temperatures, infra-
red sensing can be used in applications where imaging of an object in the dark is needed. 
Applications include infrared photography, security systems, and missile guidance. Also, 
since infrared radiation is essentially thermal energy, infrared sensing can be effectively used 
in thermal control systems. Ultraviolet sensing is not as widely applied as infrared sensing.

535
Appendix A
Typically, a photosensor is a resistor, diode, or transistor element that brings about a 
change (e.g., generation of a potential or a change in resistance) in an electrical circuit, 
in response to light that is falling on the sensor element. The power of the output sig-
nal may be derived primarily from the power source that energizes the electrical circuit. 
Alternatively, a photocell can be used as a photosensor. In this latter case the energy of the 
light falling on the cell is converted into electrical energy of the output signal. Typically, 
a photosensor is available as a tiny cylindrical element with a sensor head consisting of a 
circular window (lens). Several types of photosensors are described below.
A.11.1  Photoresistors
A photoresistor (or photoconductor) has the property of decreasing its electrical resistance 
(increasing the conductivity) as the intensity of light falling on it increases. Typically, the 
resistance of a photoresistor could change from very high values (megohms) in the dark 
to reasonably low values (less than 100 Ω) in bright light. As a result, very high sensitivity 
to light is possible. Some photocells can function as photoresistors because their imped-
ance decreases (output increases) as the light intensity increases. Photocells used in this 
manner are termed photoconductive cells. The circuit symbol of a photoresistor is given in 
Figure A.26a. A photoresistor may be formed by sandwiching a photoconductive crystal-
line material such as CdS or cadmium selenide (CdSe) between two electrodes. Lead sulfide 
(PbS) or lead selenide (PbSe) may be used in infrared photoresistors.
A.11.2  Photodiodes
A photodiode is a pn junction of semiconductor material that produces electron-hole pairs 
in response to light. The symbol for a photodiode is shown in Figure A.26b. Two types of 
photodiodes are available. A photovoltaic diode generates a sufficient potential at its junc-
tion in response to light (photons) falling on it. Hence an external bias source is not neces-
sary for a photovoltaic diode. A photoconductive diode undergoes a resistance change at 
its junction in response to photons. This type of photodiode is operated in reverse-biased 
form; the p-lead of the diode is connected to the negative lead of the circuit and n-lead is 
connected to the positive lead of the circuit. The breakdown condition may occur at about 
(e)
(d)
Gate
(G)
Drain (D)
Source (S)
(a)
(c)
Collector
(C)
Emitter
(E)
Base
(B)
(b)
n
p
FIGURE A.26
Circuit symbols of some photosensors. (a) Photoresistor; (b) photodiode; (c) phototransistor (npn); (d) photo-FET 
(n-channel); (e) photocell.

536
Appendix A
10 V and the corresponding current will be nearly proportional to the intensity of light fall-
ing on the photodiode. Hence this current can be used as a measure of the light intensity. 
The sensitivity of a photodiode is rather low particular due to the reverse-bias operation. 
Since the output current level is usually low (a fraction of a milliampere), amplification 
might be necessary before using it in the subsequent application (e.g., signal transmission, 
actuation, control, display). Semiconductor materials such as silicon, germanium, CdS, and 
CdSe are commonly used in photodiodes. The response speed of a photodiode is high. 
A diode with an intrinsic layer (a PIN diode) can provide still faster response than with a 
regular pn diode.
A.11.3  Phototransistor
Any semiconductor photosensor with amplification circuitry built into the same package 
(chip) is popularly called a phototransistor. Hence a photodiode with an amplifier circuit 
in a single unit might be called a phototransistor. Strictly, a phototransistor is manufac-
tured in the form of a conventional BJT with base (B), collector (C), and emitter (E) leads.
Symbolic representation of a phototransistor is shown in Figure A.26c. This is an npn 
transistor. The base is the central (p) region of the transistor element. The collector and 
the emitter are the two end regions (n) of the element. Under operating conditions of the 
phototransistor the collector-base junction is reverse biased (i.e., a positive lead of the circuit 
is connected to the collector and a negative lead of the circuit is connected to the base of an 
npn transistor). Alternatively, a phototransistor may be connected as a two-terminal device 
with its base terminal floated and the collector terminal properly biased (positive for an 
npn transistor). For a given level of source voltage (usually applied between the emitter 
lead of the transistor and load, the negative potential being at the emitter lead), the collec-
tor current (current through the collector lead) ic is nearly proportional to the intensity of 
the light falling on the collector-base junction of the transistor. Hence, ic can be used as a 
measure of the light intensity. Germanium or silicon is the semiconductor material that is 
commonly used in phototransistors.
A.11.4  Photo-FET
A photo-FET is similar to a conventional FET. The symbol shown in Figure A.26d is for an 
n-channel photo-FET. This consists of an n-type semiconductor element (e.g., silicon doped 
with boron), called channel. A much smaller element of p-type material is attached to the 
n-type element. The lead on the p-type element forms the gate (G). The drain (D) and the 
source (S) are the two leads on the channel. The operation of a FET depends on the electro-
static fields created by the potentials applied to the leads of the FET.
Under operating conditions of a photo-FET, the gate is reverse-biased (i.e., a negative 
potential is applied to the gate of an n-channel photo-FET). When light is projected at the 
gate, the drain current id will increase. Hence drain current (current at the D lead) can be 
used as a measure of light intensity.
A.11.5  Photocells
Photocells are similar to photosensors except that a photocell is used as an electricity 
source rather than a sensor of radiation. Solar cells, which are more effective in sunlight, 
are commonly available. A typical photocell is a semiconductor junction element made of 
a material such as single-crystal silicon, polycrystalline silicon, and CdS. Cell arrays are 

537
Appendix A
used in moderate-power applications. Typical power output is 10 mW/cm2 of surface area, 
with a potential of about 1.0 V. The circuit symbol of a photocell is given in Figure A.26e.
A.11.6  Charge-Coupled Device
A charge-coupled device (CCD) is an integrated circuit (a monolithic device) element of semi-
conductor material. A CCD made from silicon is schematically represented in Figure A.27. 
A silicon wafer (p type or n type) is oxidized to generate a layer of SiO2 on its surface. A 
matrix of metal electrodes is deposited on the oxide layer and is linked to the CCD output 
leads. When light falls onto the CCD element (from an object), a charge packets are gener-
ated within the substrate silicon wafer. Now, if an external potential is applied to a particu-
lar electrode of the CCD, a potential well is formed under the electrode and a charge packet 
is deposited here. This charge packet can be moved across the CCD to an output circuit 
by sequentially energizing the electrodes using pulses of external voltage. Such a charge 
packet corresponds to a pixel (a picture element) of the image of the object. The circuit 
output is the video signal of the image. The pulsing rate could be higher than 10 MHz. 
CCDs are commonly used in imaging application, particularly in video cameras. A typi-
cal CCD element with a facial area of a few square centimeters may detect 576 × 485 pixels, 
but larger elements (e.g., 4096 × 4096 pixels) are available for specialized applications. A 
charge injection device (CID) is similar to a CCD. In a CID, however, there is a matrix of 
semiconductor capacitor pairs. Each capacitor pair can be directly addressed through volt-
age pulses. When a particular element is addressed, the potential well there will shrink, 
thereby injecting minority carriers into the substrate. The corresponding signal, tapped 
from the substrate, forms the video signal. The signal level of a CID is substantially smaller 
than that of a CCD, as a result of higher capacitance.
A.11.7  Applications of Optically Coupled Devices
One direct application is in the isolation of electric circuitry. When two circuits are directly 
connected through hard electrical connections (cables, wires, etc.) a two-way path for the 
electrical signals is created at the interface. In other words, signals in circuit A will affect 
circuit B and signals in circuit B will affect circuit A. This interaction means that “noise” in 
one circuit will directly affect the other. Furthermore, there will be loading problems; the 
Silicon dioxide
layer
Electrodes
Silicon substrate (p or n)
A potential well
(receives a charge packet)
FIGURE A.27
A CCD.

538
Appendix A
source will be affected by the load. Both these situations are undesirable. If the two circuits 
are optically coupled, however, there is only a one-way interaction between the two cir-
cuits (see Figure A.28). Variations in the output circuit (load circuit) will not affect the input 
circuit. Hence the input circuit is isolated from the output circuit. The connecting cables in 
an electrical circuit can introduce noise components such as electromagnetic interference, line 
noise, and ground-loop noise. The likelihood of these noise components affecting the over-
all system is also reduced by using optical coupling. In summary, isolation between two 
circuits and isolation of a circuit from noise can be achieved by optical coupling. For these 
reasons, optical coupling is widely used in communication networks (telephones, comput-
ers, etc.) and in circuitry for high-precision signal conditioning (e.g., for sophisticated sen-
sors and control systems).
The medium through which light passes from the light source to the photosensor can 
create noise problems, however. If the medium is open (see Figure A.28), then ambient 
lighting conditions will affect the output circuit, resulting in an error. Also, environmental 
impurities (dust, dirt, smoke, moisture, etc.) will affect the light received by the photosen-
sor. Hence, a more controlled medium of transmission would be desirable. Linking the 
light source and the photosensor using optical fibers is a good way to reduce problems due 
to ambient conditions in optically coupled systems.
Optical coupling may be used in relay circuits where a low-power circuit is used to oper-
ate a high-power circuit. If the relay that operates the high-power circuit is activated using 
an optical coupler, reaction effects (noise and loading) on the low-power circuit can be 
eliminated. Optical coupling is used in power electronics and control systems in this manner.
Many types of sensors and transducers that are based on optical methods do indeed 
employ optical coupling. (e.g., optical encoders, fiberoptic tactile sensors). Optical sensors 
are widely used in industry for parts counting, parts detection, and level detection. In 
these sensors a light beam is projected from a source to a photodetector, both units being 
stationary. An interruption of the beam through the passage of a part will generate a pulse 
at the detector, and this pulse is read by a counter or a parts detector. Furthermore, if the 
light beam is located horizontally at a required height, its interruption when the material 
filled into a container reaches that level, may be used for filling control in the packaging 
industry. Note that the light source and the sensor can be located within a single package 
if a mirror is used to reflect light from the source back onto the detector. Further applica-
tions include computer disk drive systems; e.g., to detect the write protect notch as well as 
the position of the recording head.
Input
signal
Output
(to load)
Electrical
circuitry
Electrical
circuitry
Input circuit
Output circuit
Light
source
Photo
sensor
FIGURE A.28
An optically coupled device.

539
Appendix B: Bond Graphs
This appendix presents an introduction to the method of bond graphs in the modeling 
of dynamic systems. This is a graphical modeling method. It is an alternative approach 
to linear graphs, which are extensively presented in this book (see Chapters 5 and 7, and 
Appendix C).
B.1  Introduction
Bond graphs, like linear graphs, are graphical representations of lumped-parameter 
­models of dynamic systems. Figure B.1 shows a typical line segment of a bond graph. Each 
line or branch is called a bond because it connects two elements in the model, analogous to 
a chemical bond in chemistry, which links two atoms.
First, let us comment on the similarities of bond graphs to linear graphs: (1) Both repre-
sent dynamic models; (2) both are convenient and systematic graphic tools to obtain state 
equations; (3) both use lines to represent a model; and (4) both characterize a line with two 
variables representing cause and effect or input and output. However, one should not rush 
to establish a one-to-one correspondence between linear graphs and bond graphs because 
such a correspondence does not exist. Some of the major differences between linear graphs 
and bond graphs are:
•	 In linear graphs, a line segment represents an element (such as mass, inductor, 
capacitor, damper, force source, and voltage source), whereas in bond graphs, a 
line segment (a bond) emerges from an element. Hence, a bond connects two ele-
ments (like in chemical bonds—hence the name).
•	 An arrow in a linear graph can represent the direction of power transmitted 
through an element. A half arrow in a bond graph represents the direction of power 
flow (whether into or out of the element).
•	 Linear graphs do not explicitly represent “causality” of variables associated with 
an element (i.e., which one is the input and which one is the output). Bond graphs 
use “causality strokes” to explicitly indicate the causality of the two variables 
associated with each bond.
•	 Linear graphs do not explicitly indicate the correct “order” of a dynamic system 
(unless the graph-tree approach is used—see Appendix C). Bond graphs immedi-
ately show the system order. Specifically
	
System order = number of energy-storage elements – number of causality conflicts
•	 Linear graphs use “through-variables” and “across-variables,” whereas bond 
graphs use “flow variables” and “effort variables.”
•	 Continuity equations are node equations for a linear graph. Continuity equations 
are explicitly represented by common-velocity-junction elements in bond graphs.
•	 Compatibility equations are loop equations in a linear graph. Compatibility equa-
tions are explicitly represented by common-force-junction elements in bond graphs.

540
Appendix B
In this presentation of bond graphs, we will continue to use the variables that we have 
used in linear graphs—for example, for mechanical systems, the velocity of an inertia ele-
ment and the force in a stiffness element—to develop state models. Alternatively, in bond 
graphs, (1) momentum of inertia elements and (2) displacement of stiffness elements may 
be used as the model variables. Note: Momentum is directly related to velocity in an inertia 
element, and displacement is directly related to force in a stiffness element.
In bond graphs, “effort” and “flow” denote force and velocity in mechanical systems, 
voltage and current in electrical systems, pressure and flow rate in fluid systems, and tem-
perature and heat-transfer rate in thermal systems. In linear graphs, force and current are 
through-variables, and velocity and voltage are across-variables. In this sense, force-voltage 
analogy is used in bond graphs, whereas force-current analogy is used in linear graphs. In 
the current presentation of bond graphs, we will indicate the relevant principles primar-
ily using mechanical elements and systems even though the techniques may be similarly 
applied to electrical, fluid, and thermal systems. We will present examples to illustrate the 
application of bond graphs to non-mechanical systems.
B.2  Single-Port Elements
Figure B.1 shows four possible configurations for a single bond. The “half arrow” indicates 
the direction of power flow when the flow and the effort variables are positive according 
to some convention. In Figure B.1a, for example, when the effort (force) variable (f) and the 
flow (velocity) variable (v) are positive according to a preestablished sign convention, the 
power would flow into the element (denoted by A). Hence, once the positive direction of 
v is assigned, the half arrow will also determine the positive direction of f. (If the signs 
of two of the three variables, effort, flow, and power, are known, the sign of the third is 
known because power = effort × flow.)
The short (vertical) stroke across a bond indicates the causality of each port. In other 
words, the causality stroke determines which of the two variables (f and v) in a bond (or 
port) is the input variable and which is the output variable. If the stroke is at the near end 
of element A (as in Figure B.1a), the input variable to A is f and the output variable of A is v. 
Similarly, if the “causality stroke” is at the far end of the bond to A, then v is the input to 
A and f is the output of A. This notation is further explained in Figure B.2. Note that the 
causality is a completely independent consideration from the direction of power flow, as is 
clear from the four possible combinations of causality and power-flow directions shown 
in Figure B.1. Also, by convention, the effort variable (force) is marked above or to the left 
of each bond.
(a)
f
v
A
(b)
f
v
A
(c)
f
v
A
(d)
f
v
A
FIGURE B.1
A bond graph showing various possibilities of causality and power flow.

541
Appendix B
B.3  Source Elements
In modeling lumped-parameter mechanical systems, we may use two ideal source ele-
ments: a force source and a velocity source. Their bond-graph representations are shown in 
Table B.1. From the practical point of view, the positive direction of power is always taken 
to be out of the source. However, it would be acceptable to use the reverse direction as 
positive because it is simply a sign convention. In a source element, only one variable is 
(a)
f
v
A
(b)
A
f
v
Input
Output
FIGURE B.2
(a) Bond-graph representation of element A with input f and output v with power flow into A; (b) block diagram 
representation.
TABLE B.1
Basic Single-Port Bond-Graph Elements for Mechanical Systems
Category
Source
Elements
Energy-
Storage
Elements
Energy
Dissipation
Elements
Element
Conventional Representation
Bond-Graph
Representation
Force
Source f(t)
Velocity
Source v(t)
Inertia
m
Stiﬀness
k
Damper
b
f(t)
v
f
v(t)
f(t)
m
f
f
v2 = v
v1 = 0
f
f
v2
v1
v2
v1
v = v2 – v1
v = v2 – v1
f
f
v
SF
f(t)
v
SF
v
v
f
f
(m)
M
(m)
M
v
v
f
f
(k)
K
(k)
K
v
v
f
f
(b)
B
(b)
B

542
Appendix B
specified (the output variable) and the value of the other variable depends on the remain-
der of the system to which the source is connected.
The causality of a source is unique by its definition—the output of a force source is force 
and the output of a velocity source is velocity. It is clear that the causality stroke is com-
pletely determined by the source type, and hence is redundant. For this reason, causalities 
in source elements are known as necessary causalities. Causality strokes are often omitted 
from the final bond graph because the strokes are useful primarily in establishing that 
there are no causality conflicts and, hence, that no dependent energy-storage elements 
exist in the model. Causality conflict is an indication that the system order is less than the 
number of energy-storage elements in the model.
B.4  Energy Storage and Dissipation Elements
The two energy-storage elements in mechanical models are the mass (inertia) element and 
the stiffness (tension/compression spring, torsional spring, or flexural spring) element. In 
electrical models, these are inductors and capacitors. Energy dissipation is represented 
by a damping element for mechanical systems and by a resistance for ­electrical systems. 
In linear mechanical models, viscous damping is assumed. These single-port mechanical 
­elements and their bond-graph representations are summarized in Table B.1.
B.4.1  Derivative Causality and Integral Causality
When the constitutive (characterizing) relations are written in the derivative form, deriva-
tive causality is said to apply. For example, for the mass element; if we use Newton’s law 
in the form 
=
f
m dv
dt
, this denotes that f is the output variable and v is therefore the input 
variable. This corresponds to derivative causality. On the other hand, if we use the same 
Newton’s law in the form 
∫
=
v
m
f dt
1
, this implies that v is the output variable (and f is 
therefore the input variable). This is an example of integral causality. It is natural to use 
integral causality for mass and stiffness elements because, as discussed before, velocity (v) 
for mass and force (f) for stiffness are the natural state variables (which are a particular 
type of output variable). Once this decision is made, their causalities become fixed (i.e., 
velocity is the output for all mass elements and force is the output for all stiffness ele-
ments). For damper elements, the causality is algebraic and hence arbitrary. Both forms of 
causality are shown in Table B.1. Note that the integral causality is shown by the bottom 
figures for the inertia and stiffness elements.
B.4.2  Causality Conflicts and System Order
Consider a system model having several energy-storage elements. First, we draw its bond 
graph and indicate causality using the integral-causality convention. If it is not possible 
to assign causalities to all bonds without violating the assumed (integral) causality, then 
there exists a conflict in causality. This indicates that the energy-storage elements are not 
independent and hence the system order is less than the total number of energy-storage 
elements. It is seen that bond graphs are particularly useful in identifying the correct order 
of a system (model).

543
Appendix B
B.5  Multiport Elements
In linear graphs, we examined systems with transformers and gyrators. These are two-
port elements. According to the sign convention for linear graphs, power at the output 
port as well as the input port is taken to be positive into the element. On the contrary, in 
bond-graph notation, it is customary to take the positive direction of power as into the 
element at the input port, and out of the element at the output port. The bond-graph rep-
resentations for an ideal transformer and gyrator are given in Table B.2. In each, there are 
two choices for causality. For the transformer, it is possible to choose either vo and fi or vi 
and fo as outputs. For the gyrator, either vo and vi or fo and fi may be chosen as outputs. Both 
choices are shown in Table B.2 in the bond-graph column, along with the corresponding 
constitutive relations.
B.5.1  Multiport Junction Elements
Junction elements are used to represent continuity (conservation) relations and compat-
ibility relations in bond-graph models (Table B.3). Multiport junctions consisting of more 
than three ports can be represented by a combination of three-port junctions; it follows 
that only three-port junctions need be considered. For convenience and conciseness of 
representation, however, it is acceptable to use multiport junctions having more than 
three ports.
B.5.2  Common-Force Junction
The three-port, common-force junction is shown in Figure B.3a and Table B.3. This junc-
tion has the property that the force variables at the port are identical, and the velocity 
TABLE B.2
Basic Two-Port Mechanical Bond-Graph Elements
Element
Transformer
Gyrator
Conventional
Representation
Bond
Graph
Constitutive
Relation
Fi
fo
vo
vi
fi, vi
Fo
vo
ω
fi
vo
TF
(r)
vi
fo
fi
vo
TF
(r)
vi
fo
fi
vo
GY
(M)
vi
fo
fi
vo
GY
(M)
vi
fo
vo = r vi
fi = r fo
vo = M fi
vi = M fo
1
1
fo
fi
r
vi
vo
r
=
=
1
1
fo
M
fi
M
=
=
vi
vo

544
Appendix B
variables add up to zero. This element, therefore, represents a compatibility condition 
(or a loop equation for linear graphs). Since the force variable is common, the positive 
direction of power flow (half arrow) in each bond can be used to represent the posi-
tive direction of velocity at that port. In other words, if the direction of half arrow at a 
port is reversed, the corresponding positive direction of velocity, as well as the positive 
direction of power flow, is reversed. Note that causality is not indicated in Table B.3. The 
approach to assigning causalities to a common-force junction is simple: Any two of the 
three velocity variables are selected as inputs to the element; the third velocity variable 
is necessarily the output. This, therefore, is a case of restricted causality. The particular 
choice, however, should be compatible with the rest of the bond graph. In Figure B.3a, for 
example, v3 is considered output.
B.5.3  Common-Velocity Junction
A three-port, common-velocity junction is shown in Figure B.3b and Table B.3. This ele-
ment represents a continuity (or conservation, or force-balance) condition (a node equation 
for linear graphs) in a model. Since the velocity variable is common at the three ports, the 
positive direction of power flow (as given by half arrow) is also used to indicate the posi-
tive direction of force. The summing relation dictates the causality; any two force variables 
0
1
2
3
(a)
v3 = –v2 – v1
(f )
f3 = –f1 – f2
1
1
2
3
(b)
(v)
FIGURE B.3
(a) Common-force junction; (b) common-velocity junction.
TABLE B.3
Three-Port Junction Elements
Element
Common-force
junction
Significance
Bond-Graph
Representation
Constitutive
Relation
Common-
velocity
junction
Compatibility
(Sum of velocities
in a loop = 0)
0
1
2
3
(f )
1
1
2
3
(v)
Continuity
(Sum of forces
at a node = 0)
f 1 = f 2 = f 3 = f
V 1 + V 2 + V 3 = 0
f 1 + f 2 + f 3 = 0
V1 = V 2 = V 3 = V

545
Appendix B
can be chosen as inputs and the third force variable is necessarily the output. This is also a 
case of restricted causality. The causality stroke for the case when f3 is taken as the output 
is shown in Figure B.3b.
B.6  State Models from Bond Graphs
The main steps of obtaining a state-space model from a bond graph are as follows:
	
1.	Draw the bond-graph structure for the lumped-parameter model.
	
2.	Augment the bond graph with causality (input-output) strokes and positive 
power-flow-direction half arrows. Use integral causality.
	
3.	If no conflict of causality exists (as evidenced by being able to complete all cau-
sality strokes correctly), the order of the system (model) is equal to the number 
of energy-storage elements. For mechanical systems, pick velocities of inertia ele-
ments and forces in stiffness elements as state variables. For electrical systems, 
pick currents of inductors and voltages of capacitors as state variables.
	
4.	Write constitutive relations for independent energy-storage elements to obtain the 
state-model skeleton.
	
5.	Write constitutive relations for the remaining elements.
	
6.	Eliminate auxiliary variables using the relations in step (5).
Two circumstances deserve special attention here:
	
1. Arbitrary causality: In order to complete the causality assignment in a bond 
graph, it may be required to assign causality to one or more dissipation (mechani-
cal damping or electrical resistance) elements, arbitrarily. In this case, the bond 
graph itself is not unique (i.e., more than one bond graph exists for the system).
	
2. Conflicts in causality: In some bond-graph models, a causality conflict can exist 
when integral causality is used for energy-storage elements. This means that, even 
though we started by assuming integral causality for the energy-storage elements, 
it becomes imperative to use derivative causality for one or more of these ele-
ments. This will imply that these energy-storage elements depend, algebraically, 
on the remaining energy-storage elements. These algebraic relations can be used 
to eliminate the corresponding redundant state variables. The order of the model, 
in this case, is given by
	
= n
n
Model order
–
1
2 
	
where nl = number of energy-storage elements and n2 = storage elements with 
derivative causality.
When causality conflicts occur, it might be necessary to include derivatives of input vari-
ables in the system equations. These correspond to feedforward paths. To eliminate these 
derivative terms from the state equations, it would be necessary to redefine the state 

546
Appendix B
variables, resulting in an output equation that depends on the inputs as well as the states. 
From a practical point of view, causality conflicts usually mean modeling errors and mod-
eling redundancies. Next, we will consider several illustrative examples.
Example B.1
Consider a mechanical system subjected to a support-motion excitation, modeled as in 
Figure B.4. Gravitational forces at inertia elements may be incorporated into the model 
as constant force sources. Alternatively, if we apply a constant external force to support 
gravity and for stiffness elements if we use as state variables the changes in forces from 
the static equilibrium position, the gravity forces do not enter into the state equations. 
This is similar to the situation where system motion is in a horizontal plane. Let us 
make this assumption.
▪
The steps of developing a stat-space model for this system using bond graphs are given as 
follows:
Step 1: The bond graph of the given model is drawn as shown in Figure B.5. There 
are four energy-storage elements (m1, m2, k1, k2). Prior to making causality assign-
ments, we should not state that the system (model) is fourth order because, should 
there be causality conflicts, the order would be less than four.
Step 2: The half-arrows, indicating the direction of positive power, are assigned 
using the standard convention (see Tables B.1 and B.3) of “out of the sources” and 
“into the m, k, and b elements.” Causality strokes are assigned to each port using 
integral causality for m and k elements; necessary causality (i.e., velocity is the 
output) for the velocity source; and restricted causality for the common-force junc-
tions (i.e., one velocity has to be the output) and common-velocity junctions (i.e., 
one force has to be the output). It follows that the causality of the damping element 
(B) is uniquely determined by these assignments; no arbitrary causality is needed. 
Hence, the bond graph is unique. Furthermore, all m and k elements retain their 
assumed integral causality.
k2
v(t)
v2
m2
m1
v1
k1
b1
FIGURE B.4
A system subject to support-motion excitation.

547
Appendix B
Step 3: There are no causality conflicts. Hence, the system is fourth order. The 
state variables are chosen as v1, v2, fl, and f2—the velocities of ml and m2 and the 
“changes” from static equilibrium configuration of forces in k1 and k2.
Step 4: The skeleton state model is obtained by writing the constitutive equations for 
m1, m2, k1, and k2:
	

∫
=
′
=
′
v
m
f dt
v
m f
1
or
1
1
1
1
1
1
1
	

∫
=
′
=
′
v
m
f dt
v
m f
1
or
1
2
2
2
2
2
2
	

∫
=
′
=
′
f
k
v dt
f
k v
or
1
1
1
1
1
1
	

∫
=
′
=
′
f
k
v dt
f
k v
or
2
2
2
2
2
2
Step 5: To eliminate the auxiliary variables ′f1 , ′f2, ′
v2, and ′
v2, the descriptive equa-
tions for the remaining elements are used:
For 0-junctions (common force):
	
−′ = −
+
′ =
−
v
v t
v
v
v t
v
( )
or
( )
2
2
2
2
	
−′ = −
+
′ =
−
v
v
v
v
v
v
or
1
2
1
1
2
1
Note that the signs are assigned to velocity variables according to the direction of the half 
arrows, and equations are written according to causality (the output variable is on the left-
hand side.)
For 1-junctions (common velocity):
	
−′ = −
+
′
′ =
−
′
f
f
f
f
f
f
or
2
2
1
2
2
1
	
′ =
+
′′
f
f
f
1
1
1
0
(f2)
v(t)
1
(v2)
(v1)
1
SV
K
(k2)
M
(m2)
0
v1
M
(m1)
K
(k1)
f1
(b1)
B
 
v΄2
f2
f1
( f1)
΄
˝
΄
΄
FIGURE B.5
Bond graph of system in Figure B.4.

548
Appendix B
(Again, signs are assigned to the force variables according to the direction of half arrows, 
and equations are written according to causality.)
For B-element:
	
′′=
′
f
b v
1
1
1
	
Step 6: The elimination of the auxiliary variables is a straightforward algebraic 
exercise. Note that five constitutive equations are necessary because an additional 
auxiliary variable ′′
f1  is introduced in the process and has to be eliminated as well. 
The final state equations are
	




(
)
(
)
(
)
=
+
−


=
−
−
−


=
−
=
−


v
m
f
b v
v
v
m
f
f
b v
v
f
k
v
v
f
k
v t
v
1
1
( )
1
1
1
1
2
1
2
2
2
1
1
2
1
1
1
2
1
2
2
2
The corresponding system matrix and the input-gain matrix (input distribution matrix) are
	
=
−
−
−
−
−














=












A
B
b m
b m
m
b m
b m
m
m
k
k
k
k
1
0
1
1
0
0
0
0
0
;
0
0
0
1
1
1
1
1
1
2
1
2
2
2
1
1
2
2
with the state vector = 

x
v
v
f
f
T
1
2
1
2
 and the input vector (which is a scalar for this 
model) u = v(t).
It should be recognized that there is a hidden force (not shown in Figure B.4) equal in 
magnitude to the force in k2 that has to be applied to the support in order to generate the 
input velocity v(t). This force (f2) is a dependent variable and is considered as the input to 
the velocity source to generate its output v(t). It is clear that a velocity source has an associ-
ated force as much as a force source has an associated velocity.
Example B.2
An interesting exercise on identifying the order of a system is provided by the lumped-
parameter model shown in Figure B.6. Note that the velocity input v(t) is applied directly 
to mass m2, and the forcing input f(t) is applied to mass m1.
The bond graph of this model is shown in Figure B.7. There is a conflict in causality, 
which has surfaced as derivative causality for mass m2. (Note the causality stroke of the 
bond connected to m2. It is at the far end meaning force is the output. But according to 
the integral causality, velocity of m2 should be the output—hence the conflict.) Thus, the 
order of the system is 2:

549
Appendix B
	
=
=
=
Order
#energy-storage elements – #causality conflicts
3 – 1
2
On closer examination, it appears that the velocity of m2 is completely specified by 
the velocity source—this velocity is directly applied to the common ends of k and b. 
Consequently, the presence of m2 is not felt by the rest of the system. This corresponds 
to a second-order system.
The state equations are obtained in terms of the state variables v1 and f1. The skeleton 
state model is
	

∫
=
′
=
′
v
m
f dt
v
m f
1
or
1
1
1
1
1
1
1
	

∫
=
′
=
′
f
k
v dt
f
kv
or
1
1
1
1
The remaining constitutive equations are
	
−′ = −
+
v
v t
v
( )
1
1 (for the common-force junction ′′
f1 )
	
′′=
+
′′′
f
f
f
1
1
1  (for the common-velocity junction ′
v1)
	
′= −′′ −
f
f
f t( )
1
 (for the common-velocity junction v1)
	
′′′=
′
f
bv
1
1
v(t)
m2
m1
v1
k
b
f(t)
FIGURE B.6
A system with velocity and force inputs.
1
f1
0
(v(t))
M
(m2)
1
(v1)
M
(m1)
K
(k)
1
SF
(f(t))
v(t)
SV
f
~
( f1  )˝
f1
B
(b)
f1΄΄΄
΄
(v1)΄
FIGURE B.7
Bond graph of system in Figure B.6.

550
Appendix B
The final state equations are obtained by eliminating the auxiliary variables. We obtain
	


(
)
=
+
+
−


=
−


v
m
f t
f
b v t
v
f
k v t
v
1
( )
( )
( )
1
1
1
1
1
2
The corresponding state-model matrices are
	
=
−
−








=








A
B
b m
m
k
b m
m
k
1
0
;
1
0
1
1
1
1
with the state vector = 

x
v
f
T
1
1
 and the input vector = 

u
v t
f t
( )
( )
T.
Note that the force required by the velocity source to generate its velocity v(t) is 
­indicated in Figure B.7 as f . In order to determine this force, however, it is required to 
consider the constitutive equation for mass m2. This can be expressed as
	


−
′′=
f
f
m v t( )
1
2
The value of ′′
f1  is known from a previous relation. It can be shown that
	


=
+
+
−


f
m v t
f
b v t
v
( )
( )
2
1
1
This expression contains the first derivative of the input variable v(t), as expected.
▪
Example B.3
As another example, let us consider an ideal rack-and-pinion arrangement (with no 
backlash and friction) shown in Figure B.8a. A torque τi is applied to the pinion, causing 
it to rotate at angular velocity ωi. The corresponding translational velocity of the rack is 
vo. The load resisting this motion is indicated as a force fo. The radius of the pinion is r.
If we neglect the inertia of both rack and pinion, the system corresponds to an ideal 
transformer. Its bond graph is shown in Figure B.8b. The constitutive relations written 
according to the causality indicated in the figure are as follows:
	
τ
=
f
r
1
o
i
	
ω = r v
1
i
o
Now, let us include the polar moment of inertia J of the pinion, and the mass m of 
the rack. The corresponding bond graph is shown in Figure B.8c. It is observed that 
there is a conflict in causality, which is indicated as derivative causality for mass m. 
Furthermore, it is required to make vo an output variable for TF in Figure B.8c, whereas 
in Figure B.8b it is an input variable. The system (model) is obviously first order.
The skeleton state model is
	

∫
ω
τ
τ
ω
τ
τ
(
)
(
)
=
−
=
−
J
dt
J
1
or
1
i
i
i
i

551
Appendix B
The remaining constitutive equations are written according to the indicated causalities 
and power flow directions (half arrows):
	

ω
τ
−
=
=
=
f
f
mv
v
r
rf
o
o
o
i
In particular, note that the power flow of the force source fo is “into” the force source 
because the positive direction of fo is opposite to that of vo (Figure B.8a). But the power 
flow of torque source τi is “out of” the source because τi and ωi are in the same direction.
By eliminating the auxiliary variable τ using these relations, the final state equation 
is obtained as
	
ω
τ
(
)(
)
=
+
−
J
mr
rf
1
i
i
o
2
This is analogous to a simple mass driven by a force and resisted by a force (such as 
­friction).
▪
B.7  Bond Graphs of Electrical Systems
The concepts used in mechanical systems may be directly extended to electrical systems 
using the force-voltage analogy. Specifically, force and voltage are effort variables and veloc-
ity and current are flow variables. Then a spring is analogous to a capacitor and an inertia is 
(a)
r
fo
vo
(b)
TF
(r)
SF
fo
vo
SV
(c)
SF
1
TF
1
(r)
vo
fo
f
(J)
M
(m)
M
τi
τi
τ
τi
ωi
ωi
ωi
FIGURE B.8
(a) A rack-and-pinion system; (b) bond graph when inertia is neglected; (c) bond graph with inertia 
included.

552
Appendix B
analogous to an inductor. Also, we have voltage sources analogous to force sources (effort 
sources) and current sources analogous to voltage sources (flow sources).
Example B.4
Consider the circuit shown in Figure B.9a. Its bond graph is shown in Figure B.9b. A state-
space model is obtained by following the same procedure as for a mechanical system.
The state-space shell:
	
∫
=
=
i
L
v dt
di
dt
L v
1
'
or
1
'
	
∫
=
=
v
C
i dt
dv
dt
C i
1
or
1
o
o
1
1
The remaining constitutive equations:
Resistor: 
=
v
Ri
o
2
Common-flow (1) junction: −
= −
+
=
−
v
v t
v
v
v t
v
'
( )
or
'
( )
o
o
Common-effort (0) junction: −
= −+
= −
i
i
i
i
i
i
or
1
2
1
2
By eliminating the auxiliary variables, we get the following state-space model.
State vector: = 

x
i
vo
T
Input vector: =
u
v t
[ ( )]
State equations:
	
= −
+
=
−
di
dt
L v
L v t
dv
dt
C i
RC v
1
1 ( )
1
1
o
o
o 
▪
There are ways to represent electronic circuits containing active devices such as opera-
tional amplifiers and nonlinear elements using bond graphs. Such topics are beyond the 
scope of this introductory section.
(b)
+–
1
(i) 
v(t) 
0
(vo) 
SV
L
C
R 
v΄
i1
LL
(a)
v(t)
C
R
vo
i
FIGURE B.9
(a) An electrical circuit; (b) bond graph of the circuit.

553
Appendix B
B.8  Fluid and Thermal Systems
In fluid systems the effort variable is pressure and the flow variable is the fluid flow rate. 
Accordingly, the bond-graph concepts can be extended to these systems. The model ele-
ments will include fluid capacitor, fluid inertor, fluid resistor, pressure source (effort 
source), and fluid flow source. In addition, a mechanical-fluid transformer is useful. This 
would represent a fluid pump, as shown in Figure B.10. The reverse operation of a fluid 
motor or a hydraulic actuator is also important.
In thermal systems, the effort variable is temperature, and the flow variable is heat trans-
fer rate. The system elements are thermal capacitor, thermal resistor, temperature (effort) 
source, and heat (flow) source. As noted before, there is no thermal inertia element.
Example B.5
A fluid of mass m and specific heat c is maintained at a uniform temperature T using 
heat source of rate Qs. The container, which provides a thermal resistance R, loses heat 
to the environment (temperature Ta) at the rate Qr. This thermal system is shown in 
Figure B.11a. A bond-graph model for the system is shown in Figure B.11b.
Constitutive equations are written using the bond graph as follows:
Capacitor: 
=
mc dT
dt
Qc (This is the state-space shell. The system is first order.)
Common-T (or 0) junction: −
= −
+
=
−
Q
Q
Q
Q
Q
Q
or
c
s
r
c
s
r
Common-Q (or 1) junction: −
= −
+
=
−
T
T
T
T
T
T
or
 
r
a
r
a
Resistor: 
=
T
RQ
r
r
Note:
Qc = heat transfer rate to capacitor
Tr = temperature across the thermal resistor
By substitution, we obtain
	
=
−
=
−
=
−
−
mc dT
dt
Q
Q
Q
T
R
Q
T
T
R
s
r
s
r
s
a
TF
(r) 
P
Q
(b) 
Flow out
Q
Pressure gain P  
Flow in
Q
τ
τ
Pump
(a)
ω
ω
FIGURE B.10
(a) Mechanical-fluid transformer (pump); (b) bond-graph representation.

554
Appendix B
Hence, the final state model is
	
= −
+
+
mc dT
dt
T
R
T
R
Q
a
s
▪
Qs 
Qr 
m, c, T
R 
(a)
SQ 
0
(T) 
T
C 
(mc)
R 
(R) 
1
(Q) 
Ta
ST 
Qs
Qr
(b) 
FIGURE B.11
(a) A thermal system; (b) bond-graph model.

555
Appendix C: Graph Tree Concepts 
for Linear Graphs
A graph tree, particularly a normal tree, provides a systematic procedure in model formu-
lation linear graphs (LGs). This appendix outlines the concepts and generation of a normal 
tree for a system and give examples illustrate them.
C.1  Continuity Equations
A continuity equation may be written for through variables passing through any closed 
contour drawn on the LG. This contour may enclose more than one node. Then, the result-
ing continuity equation = sum of the continuity equations of the nodes enclosed in the 
contour.
Proof: The internal through variables have opposite signs with respect to the adjoining 
nodes and hence cancel out. Consider the example in Figure C.1.
Continuity equation for node A:
	
+
−
−
+
=
f
f
f
f
f
0
1
2
3
4
5
	
(i)
Continuity equation for node B:
	
−
+
+
−
=
f
f
f
f
0
5
4
6
7
	
(ii)
Continuity equation for the closed contour:
	
+
−
+
−
=
f
f
f
f
f
0
1
2
3
6
7
	
(iii)
It is seen that Equation iii = Equation i + Equation ii.
C.2 Graph Tree
A graph tree of an LG is formed by all the nodes and the maximum number of branches of 
the LG such that no closed loops are created.
Note 1: For an LG with n nodes, there will be n − 1 branches in its graph tree (proved later).
Note 2: Graph tree of an LG is not unique. More than one graph tree is possible for a given LG.
As an example, consider the LG with four branches as shown in Figure C.2a.
It can generate four graph trees, as shown in Figure C.2b.

556
Appendix C
Property: There are n − 1 branches in a graph tree (n = number of nodes in the LG).
Proof: Consider any node in the LG. Connect it to a second node ⇒ one branch with two 
nodes.
The next branch in the graph tree will connect one of these nodes to just one new node 
(because it will not form a loop—by the definition of graph tree) and so on until the graph 
tree is complete, connecting all n nodes.
C.2.1  Link
A link is a branch of an LG that is not included in its graph tree.
Property: By definition, each link will form a new loop in the LG. Hence,
Number of primary loops (l) in an LG = Number of links corresponding to its graph tree.
1
2
3
4
(a)
1
3
1
4
1
2
2
3
2
4
(b)
FIGURE C.2
(a) An LG example and (b) possible graph trees of the LG in Figure C.2a.
A
B
f1
Closed contour
f2
f3
f4
f7
f6
f5
FIGURE C.1
Continuity equation through a closed contour.

557
Appendix C
Hence, by definition,
Number of links = b − (n − 1), where b = number of branches in the LG
Note: n – 1 = number of branches in its graph tree. Hence,
	
=
−
−
l
b
n
(
1)	
(C.1)
C.3  Conflict Identification in an LG Using Its Graph Tree
There are several types of conflicts that can arise in an LG, which need to be resolved. 
Some situations are indicated as follows:
	
1.	Two or more independent A-sources forming a loop
	
	 See the example in Figure C.3a. The corresponding loop equation is −
+
=
v t
v t
( )
( )
0.
2
1
This violates the assumption that the A-sources are “independent,” and hence, 
v t( )
1
 and v t( )
2
 are independent.
	
2.	Two or more independent T-sources joining at a node
	
	 See the example in Figure C.3b. The node equation at N is 
+
=
f t
f t
( )
( )
0
1
2
. This 
­violates the assumption that the T-sources are “independent,” and hence, f t( )
1
 and 
f t( )
2
 are independent.
+
−
+
v2(t)
v1(t)
−
(a)
f1(t)
f2(t)
N
(b)
+
v2(t)
f , v
−
+
−
v1(t)
(c)
N
f , v
f2 (t)
f1 (t)
(d)
FIGURE C.3
(a) Two A-sources in a loop—a conflict; (b) two T-sources at a node—a conflict; (c) two A-sources and a passive 
element in a loop—a redundant case; (d) two T-sources and a passive element at a node—a redundant case.

558
Appendix C
	
3.	Two or more A-sources in a loop with some passive elements
	
	 See the example in Figure C.3c. The loop equation is −
−
+
=
v t
v
v t
( )
( )
0
2
1
. Hence, 
one of the two sources is redundant; the two sources act as a single A-source 
−
v t
v t
( )
( )
1
2
.
	
4.	Two or more T-sources joining at a node with some passive elements
	
	 See the example in Figure C.3d. The node equation at N is 
+
−
=
f t
f t
f
( )
( )
0
1
2
. 
Hence, one of the two sources is redundant; the two sources act as a single T-source 
+
f t
f t
( )
( )
1
2
.
	
5.	An A-element closing a loop with other elements whose primary variables are 
A-variables
	
	 See the example in the Figure C.4a. It has two A-type elements (C1 and C2) and a 
D-type element (R) in the loop. Loop equation:
	
−
+
+
=
v
v
v
0
1
2
3
	
	 In the D-element, the two variables f3 and v3 are completely determined by other 
state variables in the system (because D-type elements do not introduce new state 
variables).
	
	
Hence, both v1 and v2 cannot act as state variables; one of them will be com-
pletely determined by other state variables (thereby violating a requirement for a 
state variable).
	
	
It follows that C1 and C2 are not independent A-type elements.
	
	
Now see the second example, shown in Figure C.4b. It has the A-type element C 
forming a loop with an A-type source.
C1
f1 , v1
f2 , v2
f3, v3
C2
R
(a)
C
+
−
f , v(t)
f1 , v1
(b)
N
b
f1, v1
f1, v1
f2, v2
f3, v3
K1
K2
(c)
N
k
f (t), v
(d)
FIGURE C.4
(a) Two A-elements in a loop with a D-element—a case of dependent elements; (b) an A-source and an A-element 
in a loop—a case of decoupling; (c) two T-elements in a node with a D-element—a case of dependent elements; 
(d) a T-source and an A-element in a loop—a case of decoupling.

559
Appendix C
	
Loop equation: −
+
=
v
v t( )
0
1
	
	 Hence, v1 is completely determined by the input v t( ). It follows that v1 cannot 
serve as a state variable because it acts an input variable (independent). In fact, the 
element C has no effect on any other components that may be connected to this 
system (because it is in parallel with the A-source) and is effectively decoupled 
from the rest of the system (as discussed before concerning parallel connections 
with A-sources).
	
6.	A T-element forming a node with other elements whose primary variables are 
T-variables
	
	 See the example in Figure C.4c. Here, two T-type elements K1, K2 and a D-type 
­element b form a node. 
	
Node equation: 
+
−
=
f
f
f
0
1
2
3
	
	 Since b is a D-type element, its variable f3 is completely determined by other state 
variables in the system. Hence, both f1 and f2 cannot function as state variables; 
one of them will be completely determined by other state variables.
	
	
Hence, K1 and K2 are not independent T-type elements. 
	
	
Now, see the second example as shown in Figure C.4d. It has a T-type element k 
connected in series with a T-type source, forming a node.
	
Node equation: 
−
=
f t
f
( )
0
1
 ⇒ 
=
f
f t( )
1
	
	 Hence, f1 is completely determined by the input f t( ). It follows that f1 cannot serve 
as a state variable because it acts an input variable (independent). In fact, the ele-
ment k has no effect on any other components that may be connected to this sys-
tem (because it is in series with the T-source) and is effectively decoupled from 
the rest of the system (as discussed before concerning series connections with 
T-sources).
C.4  Dependent Energy Storage Elements
There are two configurations of dependent energy storage elements, which should be rep-
resented by an equivalent single energy storage element before addressing any other pos-
sibilities of dependence and conflicts in an LG. These two configurations are discussed as 
follows:
	 (a)	 Several A-type elements connected in series
	
Consider the case of two capacitor elements C1 and C2 connected in series. This is 
equivalent to a single capacitance Ceq, as indicated in Figure C.5.

560
Appendix C
	
The equivalent capacitor is derived now.
	
We have 
=
=
f
f
f
1
2 and =
+
v
v
v
1
2 with 
 =
C v
f
1
1
1  and 
 =
C v
f .
2
2
2
	
Hence, 



=
+
=
+
=
+




v
v
v
C f
C f
C
C
f
1
1
1
1
1
2
1
1
2
2
1
2
.
	
Compare with  =
v
C
f
1
eq
.
	
We have 
=
+
C
C
C
1
1
1
eq
1
2
.
	
	
This result may be generalized for the case of more than two series-connected 
A-type elements.
	 (b)	 Several T-type elements in parallel
	
Consider the case of two springs, k1 and k2, connected in parallel. This is equiva-
lent to a single spring keq, as indicated in Figure C.6.
	
	
We have 
=
=
v
v
v
1
2 and 
=
+
f
f
f
1
2 with  =
f
k v
1
1
1 and  =
f
k v
2
2
2. Hence, 



=
+
=
+
=
+
f
f
f
k v
k v
k
k v
(
)
1
2
1
1
2
2
1
2
. Compare with  =
f
k v
eq . We have 
=
+
k
k
k
eq
1
2. 
This result may be generalized for the case of more than two parallel-connected 
T-type elements.
C.5  Normal Tree of an LG
We have defined “graph tree,” which is a particular type of substructure of an LG. We 
found that more than one graph tree is possible for a given LG. A particularly useful 
graph tree is a normal tree. By obtaining a normal tree of an LG, it is possible to find the 
following:
f1 , v1
C1
C2
Ceq
f2 , v2
f , v
FIGURE C.5
Two capacitors in series and the equivalent capacitor.
f1 , v1
k1
k2
keq
f2 , v2
f , v
FIGURE C.6
Two springs in series and the equivalent spring.

561
Appendix C
	 (a)	 Any dependent energy storage elements
	 (b)	 Conflicting source elements (i.e., source elements connected in an unacceptable/
redundant/infeasible manner)
	 (c)	 System order
	 (d)	 A systematic way to obtain state equations
C.5.1  Steps for Obtaining a Normal Tree
Step 1: Draw the LG of the system using dotted lines to represent the branches.
Step 2: Convert any series-connected A-type elements into a single equivalent A-type 
element. Convert any parallel-connected T-type elements into a single equivalent 
T-type element.
Step 3: Convert the dotted lines of any A-type sources into solid lines as long as they 
do not create loops. If two or more A-type sources form a loop, there is a conflict, 
which must be resolved before proceeding further (e.g., remove one source to open 
the loop and combine the remaining sources into a single source).
Step 4: If there is a transformer, convert one of its branches into a solid line.
Step 5: Convert the dotted lines of any A-type energy storage elements into solid 
lines (use half solid lines for inertia elements) as long as they do not create loops. 
If A-type energy storage elements form a loop, keep one of these elements aside. It 
is a dependent source (which does not generate a new state variable).
Step 6: If there is a gyrator, convert both of its branches into solid lines provided they 
do not create loops.
Step 7: Convert the dotted lines of any D-type elements into solid lines as long as they 
do not create loops.
Step 8: Convert the dotted lines of any T-type energy storage elements into solid lines 
as long as they do not create loops. The T-type elements included into the tree in 
this manner are dependent energy storage elements (they do not result in new 
state variables).
Step 9: If one or more T-type sources need to be included to complete the tree, they 
are conflicting source elements (they violate continuity). They have to be removed 
from the system and replaced by new elements, to complete the tree.
The resulting graph tree is called a normal tree. What information it provides and why are 
explained next.
C.5.2  Main Result from a Normal Tree
Independent energy storage elements = A-type storage elements in normal tree + T-type 
storage elements to be added at links of the tree in forming the LG of the system.
Note: System order = the number of independent storage elements
Proof:
	 (a)	 Since a graph tree (normal tree in the present case) does not have loops, no com-
patibility equations can be written. Hence, the across variables of its A-type ele-
ments are linearly independent and provide a subset of state variables.

562
Appendix C
	 (b)	 If a loop-forming A-type storage element exists, the corresponding loop equation 
provides an equation for its across variable as a linear combination of the vari-
ables of the other A-type elements in the loop. Hence, this A-type storage ele-
ment is not independent, and its across variable does not provide an additional 
state variable.
	 (c)	 If a T-type storage element is present in the normal tree, a contour can be drawn 
through its branch and other branches of the LG that are links. Hence, a continu-
ity equation can be written to express its through variable in terms of the through 
variables of the links (which can only be T-type storage elements, T-type sources, 
and/or D-type elements). Hence, this through variable can be expressed as a linear 
combination of other state variables and input variables. It follows that this T-type 
storage element is not independent, and its through variable does not provide an 
additional state variable.
	
	
As an illustrative example, suppose that a normal tree has two open nodes A 
and B that form the link AB. Also, suppose that the T-type storage element L1 (an 
inductor) is in the normal tree and B is a terminal of its branch, as shown in Figure 
C.7a. When completing the LG, suppose that link AB takes a T-type storage ele-
ment L2, a T-type source, and a D-type element R in parallel, as shown in Figure 
C.7b.
	
	
The continuity equation for node B is 
−
−
−
=
f
f
f t
f
( )
0
1
2
3
. Now, f2 is a state 
­variable (through variable of the T-type independent storage element L2) and f t( ) 
is an input variable (through variable of the T-type source). The through variable 
f3 of the D-type element R is expressible in terms of state variables and input vari-
ables (because a D-type element does not introduce any new variables).
	
	
It follows that f1 is expressed as a linear combination of state variables and 
input variables. Hence, it cannot be a new state variable, and the T-type element 
L1 is not independent.
	 (d)	 In view of step 2, no more than one T-type storage element can be present at a 
link of a normal tree. Then, from the counterargument of that given in step 3, its 
through variable cannot be expressed as a linear combination of other state vari-
ables (and input variables). Hence, it is an independent storage element.
A
B
C
f1 , v1
L1
(a)
A
B
C
R
f (t) , v
f1 , v1
f3 , v3
f2 , v2
L2
L1
(b)
FIGURE C.7
(a) A segment of normal; (b) completed link AB and node B. Tree showing link AB.

563
Appendix C
C.5.2.1  Justification of Step 5
Inclusion of one branch of the transformer is needed in order to recognize the possible 
presence of an A-type storage element that is dependent on another A-type element 
(dependence arising from the constitutive relation 
=
v
rv
o
i).
Both branches of the transformer should not be included in the normal tree because this 
can form a loop with an independent A-type storage element, which needs to be retained 
in the normal tree.
As an illustrative example, consider the two A-type storage elements, C1 and C2, linked 
by a transformer with parameter r, as shown in Figure C.8a.
Constitutive equations: 


=
=
=
= −
C v
f
C v
f
v
rv
f
r f
;
;
;
1
1
1
1
2
2
2
4
3
4
3
Loop equations: −
+
=
−
+
=
v
v
v
v
0;
0
3
1
2
4
Node equations: −
−
=
−
−
=
f
f
f
f
0;
0
1
3
4
2
We note that 
=
=
=
v
v
rv
rv
2
4
3
1.
Hence, v1 and v2 cannot constitute two independent state variables. The elements C1 and C2 
are not independent, and only one of them can remain in the normal tree. This is possible 
if and only if one of the two branches of the transformer is included in the normal tree. 
One possibility of a normal tree of the LG is shown in Figure C.8b.
C.5.2.2  Justification of Step 6
The constitutive relations of a gyrator are
	
=
= −
v
Mf
f
M v
;
1
o
i
o
i	
(C.2)
Hence, unlike a transformer (which couples an across variable with an across variable), 
a gyrator couples an across variable with a through variable. Hence, it can help identify 
dependence between an A-type element and a T-type element.
In particular, on removing both branches of the gyrator from the normal tree, a need 
may arise to include a T-type element in the tree (either a dependent or a conflicting ele-
ment). Alternatively, by including both branches in the normal tree, a need may arise to 
remove an A-type element from the tree that forms a loop with a branch of the gyrator 
(again indicating a dependent element or a conflicting element).
r
f3 , v3
f4 , v4
f2 , v2
f1 , v1
C1
C2
(a)
C2
(b)
FIGURE C.8
(a) Both branches of the transformer should be in the normal tree; (b) only one branch of the transformer should 
be in the normal tree.

564
Appendix C
As an illustrative example, consider an A-type storage element C1 and a T-type storage 
element L linked through a gyrator (M) along with another A-type storage element C2, as 
shown by the LG in Figure C.9a.
The equations of the LG are as follows:
Constitutive equations:
	
 =
C v
f
1
1
1
	
 =
C v
f
2
2
2
	
 =
L f
v
3
3
	
=
v
Mf
5
4
	
= −
f
M v
1
5
4
Loop equations:
	
−
+
=
v
v
0
4
1
	
−
−
+
=
v
v
v
0
2
3
5
Node equations:
	
−
−
=
f
f
0
1
4
(a)
f3 , v3
f5 , v5
f4 , v4
f2 , v2
f1 , v1
C1
C2
M
L
(b)
L
C2
C1
(c)
M
C2
FIGURE C.9
(a) Example concerning possible inclusion of a gyrator in a normal tree; (b) a possible graph tree; (c) another 
possible graph tree.

565
Appendix C
	
−
−
=
f
f
0
3
5
	
−
+
=
f
f
0
2
3
State equations:
	
 =
=
= −
=
=
C v
f
f
f
M v
M v
1
1
2
2
2
3
5
4
1
	
(i)
Now, consider the constitutive equation of the first capacitor:
	


=
= −
= −
= −
+
= −
+
C v
f
f
M v
M v
v
M v
Lf
1
1 (
)
1 (
)
1
1
1
4
5
2
3
2
3
or
	


+
= −
C v
L
M f
M v
1
1
1
2
2	
(ii)
Equation ii shows the dependence of the A-type storage element C1 and the T-type storage 
element L.
In fact, define the state variable:
	
=
+
x
C v
L
M f
1
1
2
	
	
	
Equation ii becomes  = −
x
M v
1
2
(ii′)
Equations i and ii′ form a complete set of state equations ⇒ The model is second order 
for this system with three energy storage elements. This further confirms the dependence 
of the elements C1 and L.
The possible graph trees for the system are shown in Figures C.8b and c.
Note: The graph tree in Figure C.9b includes the T-type storage element L, indicating that 
it is dependent. The graph tree in Figure C.9c skips the A-type storage element C1, indicat-
ing that it is dependent.
C.6  Formulation of a State-Space Model Using a Normal Tree
The steps of formulating a state-space model, while systematically identifying the conflicts 
in source elements and the dependence in energy storage elements, are summarized as 
follows:
Step 1: Sketch the LG of the system using dotted lines.

566
Appendix C
Step 2: Superimpose a normal tree on the LG, using solid lines (half-solid line for 
an inertia element) using the usual steps. Resolve any conflicts among source 
elements. Identify the independent energy storage elements (and system order). 
Identify the state variables. Write constitutive equations for the elements in the 
normal tree.
Step 3: Add missing branches (links of the normal tree) one by one into the LG. Write 
the resulting loop equations and constitutive equations.
Step 4: Once the LG is complete, write the node equations. Note: In doing this, it may 
be convenient to draw a contour that intersects only one branch in the normal tree 
at a time. Write the continuity equation for the contour. Repeat this process until 
all the links of the normal tree (except those corresponding to A-type sources) are 
covered.
Step 5: Eliminate the auxiliary variables in the state-space shell (constitutive equa-
tions of the independent energy storage elements).
Step 6: Formulate the algebraic output equation in terms of the state variables.
Example: Geared Load Driven by Velocity Source through Flexible Coupling
Consider the system having an A-source u(t), A-type storage elements m1 and m2, a 
T-type storage element k, a D-type element b, and a transformer r, as shown in Figure 
C.10a. The output of the system is v1, which is the velocity of the inertia m1.
The LG of the system is sketched using dotted lines in Figure C.10b.
Note that this LG represents the same system that was solved earlier.
A possible normal tree for the LG is shown in Figure C.10c.
(a)
k
b
r
u(t)
m2
m1
v1
(b)
+
−
r
b
k
f2 , v2
f4 , v4
f5 , v5
f6 , v6
f1 , v1
f3 , v3
m2
m1
f,u(t)
(c)
+
−
r
b
k
A
B
C
D
D
f2 , v2
f1 , v1
m2
m1
f,u(t)
FIGURE C.10
(a) A dynamic system; (b) LG of the system; (c) a normal tree of the LG.

567
Appendix C
We note from the normal tree that
Independent energy storage elements are m1 and k
State vector = 

x
v
f
T
1
2
System order = 2
State-space shell:
	
 =
m
m v
f
:  
1
1
1
1	
(i)
	
 =
k
f
kv
:  2
2	
(ii)
Links of the normal tree are AC, AD for b and m2 and BD.
Insert link AC (k). The corresponding loop equation is −
+
+
=
v
v
u t( )
0
5
2
.
Insert link AD (b). The corresponding constitutive equation and loop equation are as 
follows:
	
=
b f
bv
:
3
3
	
−
+
=
v
v
0
5
3
Insert link AD (m2). The corresponding constitutive equation and loop equation are as 
follows:
	
 =
m
m v
f
:
2
2
4
4
	
−
+
=
v
v
0
5
4
Insert link BD (r). The corresponding constitutive equations and loop equation are as 
follows:
	
=
v
rv
6
5
	
= −
f
r f
1
6
5
	
−
+
=
v
v
0
1
6
Node equations:
Three independent node equations can be written for nodes A, B, and C. However, the 
equation for C involves the through variable f of the A-source. Hence, it is not needed.
Node A: 
−
−
−
=
f
f
f
f
0
2
3
4
5
Node B: −
−
=
f
f
0
1
6
Eliminate the auxiliary variable f1 in Equation i:
	





= −
=
=
−
−
=
−
−
=
−
−
=
−
−
=
−
−
= −
−
+
f
f
r f
r f
f
f
r f
bv
m v
r f
bv
m v
r f
b
r v
m
r v
r f
b
r v
m
r v
m
r
v
b
r v
f
r
1
1(
) 
1(
)
1(
)
1(
)
1(
) 
1
6
5
2
3
4
2
3
2
4
2
5
2
5
2
6
2
6
2
1
2
1
2
2
1
2
1
2

568
Appendix C
Hence,
	



= −
−
+
+




= −
+
m v
r m v
b
r v
f
r
m
r m
v
b
r v
f
r
1
or
1
1
1
2
2
1
2
1
2
1
2
2
1
2
1
2
or
	 	
	
	
	
 = −
+
mv
bv
r f
1
1
2	

(i′)
where 
=
+
m
r m
m
2
1
2.
Eliminate v2 in Equation ii:
	
= −
+
= −
+
= −
+
v
v
u t
v
r
u t
v
r
u t
( )
( )
( )
2
5
6
1
Hence,
	
 = −
+
f
K
r v
Ku t( )
2
1
	
(ii′)
This is identical to the result that was obtained previously.
The algebraic output equation is 
=
v
x
1
1. This corresponds to 
= 

C
1
0
.
Example: Mechanical Load Moved by a Flow-Controlled Pump
A flow-controlled pump with volume flow rate Q t( ) operates a ramp (piston-cylinder 
device) that moves a mechanical load consisting of a spring (k) and a mass (m) against 
damping (b), as shown in Figure C.11a. The fluid in the cylinder is compressible, and this 
effect is represented by the fluid capacitance C f. The area of the piston is A. Velocity v of 
the mass is the output variable.
We will derive a state-space model for the system using the systematic approach, 
starting with a normal tree of the system LG.
The LG of the system is sketched in Figure C.11b. Note the hydraulic-mechanical gyra-
tor (mixed-domain).
A normal tree of the LG is shown in Figure C.11c.
Note from the normal tree that the T-type storage element k is dependent.
Independent storage elements are C and m
State vector = 

x
P
v
T
2
System order = 2
State-space shell:
	
 =
m mv
f
:
	
(i)
	
 =
C
C P
Q
:
f
f
2
2	
(ii)
Dependent source
	
 =
k f
kv
:
2
2
Insert link b:
	
=
b f
bv
:
3
3

569
Appendix C
Loop: −
+
=
v
v
0
3
Insert links for gyrator M:
Constitutive equations: 
=
Q
Av
1
4 (flow continuity)
+
=
AP
f
0
1
4
 (force balance)
Hence, with 
=
M
A
1
	
=
v
MQ
4
1
	
= −
f
M P
1
4
1
Loops: −−
+
=
v
v
v
0
2
4
	
−
+
=
P
P
0
1
2
Note: Ignore the loop equation that includes the flow source because we do not need 
to determine its across variable P.
Node equations:
Node A: −
−
+
=
f
f
f
0
3
2
Node B: −
−
=
f
f
0
4
2
Node C: 
−
−
=
Q t
Q
Q
( )
0
2
1
Eliminate f in Equation i:
	
=
−
= −
−
=
−
=
−
f
f
f
f
bv
M P
bv
M P
bv
1
1
2
3
4
3
1
2
(a)
m
k
A
b
v
Q (t)
Cf
(b)
m
M
,f v
b
k
f4 , v4
Q1 , P1
Q2 , P2
f3 , v3
f2 , v2
Cf
Q(t), P
(c)
m
M
B
C
b
K
A
Cf
Q(t), P
FIGURE C.11
(a) Flow-controlled ramp with a mechanical load; (b) LG of the system; (c) a normal tree of the LG.

570
Appendix C
Eliminate Q2 in Equation ii:
	




=
−
=
−
=
−
+
=
−
−
=
−
+
=
−
+
−









=
−
+
Q
Q t
Q
Q t
M v
Q t
M v
v
Q t
M v
k f
Q t
M v
k f
Q t
M v
k
M P
Q t
M v
M k P
( )
( )
1
( )
1 (
) 
( )
1 (
1
)
( )
1 (
1
)
( )
1
1
1
( )
1
1
2
1
4
2
2
4
1
2
2
State equations:
	
 = −
+
mv
bv
M P
1
2	
(i′)
	

−
= −
+
C
M k P
M v
Q t
(
1 )
1
( )
f
2
2
	
(ii′)
We have
	
=
−
−
−














=
−










= 

= 
A
B
C
D
b
m
mM
M C
C
M k
1
1
(
)
0
;
0
1
;
1
0
;
0
f
M k
f
1
2
2

571
Appendix D: Transform Techniques
In the present appendix, we will formally introduce the Laplace transformation and the 
Fourier transformation, and will illustrate how these techniques are useful in the analy-
sis of dynamic systems. The preference of one domain over another will depend on such 
factors as the nature of the excitation input, the type of the analytical model available, the 
time duration of interest, and the quantities that need to be determined.
D.1  Laplace Transform
The Laplace transformation relates the time domain to the Laplace domain (also called 
s-domain or complex frequency domain). The Laplace transform Y(s) of a piecewise-­
continuous function or signal y(t) is given, by definition, as
	
∫
=
−
∞
Y s
y t
st dt
( )
( )exp(
)
0
	
(D.1)
and is denoted using the Laplace operator L, as
	
L
=
Y s
y t
( )
( )	
(D.1*)
Here, s is a complex independent variable known as the Laplace variable, defined by
	
σ
ω
=
+
s
j
	
(D.2)
where σ is a real-valued constant that will make the transform (Equation D.1) finite, ω 
is simply frequency, and 
=
−
j
1. The real value (a) can be chosen sufficiently large 
so that the integral in Equation D.1 is finite even when the integral of the signal itself 
(i.e.,∫y t dt
( )
) is not finite. This is the reason why, for example, Laplace transform is better 
behaved than Fourier transform, which will be defined later, from the analytical point of 
view. The symbol s can be considered to be a constant, when integrating with respect to t, in 
Equation D.1.
The inverse relation (i.e., obtaining y from its Laplace transform) is
	
∫
π
=
σ
ω
σ
ω
−
+
y t
j
Y s
st ds
( )
1
2
( )exp( )
j
j
	
(D.3)
and is denoted using the inverse Laplace operator L−1, as

572
Appendix D
	
L
=
−
y t
Y s
( )
( )
1
	
(D.3*)
The integration in Equation D.3 is performed along a vertical line parallel to the imaginary 
(vertical) axis, located at σ  from the origin in the complex Laplace plane (s-plane). For a 
given piecewise-continuous function y(t), the Laplace transform exists if the integral in 
Equation D.1 converges. A sufficient condition for this is
	
∫
σ
−
< ∞
∞
y t
t dt
( ) exp(
)
0
	
(D.4)
Convergence is guaranteed by choosing a sufficiently large and positive σ. This property 
is an advantage of the Laplace transformation over the Fourier transformation.
D.1.1  Laplace Transforms of Some Common Functions
Now we determine the Laplace transform of some useful functions using the definition 
(Equation D.1). Usually, however, we use Laplace transform tables to obtain these results.
Laplace Transform of a Constant
Suppose our function ( )
y t  is a constant, B. Then the Laplace transform is
	
L
∫
( )
( )
=
=
=
−
=
−
∞
−
∞
B
Y s
Be
dt
B e
s
B
s
                   
st
st
0
0
Laplace Transform of the Exponential
If ( )
y t  is eat, its Laplace transform is
	
L
∫
∫
(
)
(
)
=
=
=
−
=
−
(
)
(
)
−
∞
−
∞
−
∞
e
e
e dt
e
dt
a
s e
s
a
1
1
at
st at
a s t
a s t
0
0
0
Note: If ( )
y t  is −e at, it is obvious that the Laplace transform is

573
Appendix D
	
L
∫
∫
(
)
(
)
=
=
=
−
−
=
+
(
)
(
)
−
−
−
∞
−
+
∞
−
+
∞
e
e
e
dt
e
dt
a
s e
s
a
1
1
at
st
at
a s t
a s t
0
0
0
This result can be obtained from the previous result simply by replacing a with −a.
Laplace Transform of Sine and Cosine
In the following, the letter =
−
j
1. If ( )
y t  is 
ωt
sin
, the Laplace transform is
	
L
∫
ω
ω
(
)
(
)
=
−
∞
t
e
t dt
sin
sin
st
0
Consider the identities:
	
ω
ω
=
+
ω
e
t
j
t
cos
sin
j t
	
ω
ω
=
−
ω
−e
t
j
t
cos
sin
j t
If we add and subtract these two equations, respectively, we obtain the expressions for the 
sine and the cosine in terms of 
ω
e j t and 
ω
−e
j t:
	
ω
(
)
=
+
ω
−
t
e
e
cos
1
2
j t
jwt
	
ω
(
)
=
−
ω
ω
−
t
i e
e
sin
1
2
j t
j t
	
L
ω
(
)
(
)
(
) =
+
ω
ω
−
t
L e
L e
cos
1
2
1
2
j t
j t
	
L
ω
(
)
(
)
(
) =
−
ω
ω
−
t
L e
L e
sin
1
2
1
2
j t
j t
We have just seen that
	
L
L
(
)
(
)
=
−
=
+
−
e
s
a
e
s
a
1
;
1
at
at
Hence,

574
Appendix D
	
L
L
ω
ω
(
)
(
)
=
−
=
+
ω
ω
−
e
s
j t
e
s
j t
1
;
1
j t
j t
Substituting these expressions, we get
	
L
ω
ω
ω
ω
ω
ω
ω
ω
(
)
(
)
(
)
=
−



+
+




=
+
−
+
−
−








=
+
t
s
j
s
j
s
j
s
j
s
j
s
j
s
s
cos
1
2
1
1
2
1
1
2
2
2
2
2
2
2
	
L
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
(
)
(
)
(
)
(
)
=
−
=
−



−
+




=
+
−
+
−
−








=
+




=
+
ω
ω
−
t
j L e
e
j s
j
j s
j
j
s
j
s
j
s
j
s
j
j
j
s
s
sin
1
2
1
2
1
1
2
1
1
2
1
2
2
j t
j t
2
2
2
2
2
2
2
2
Laplace Transform of a Derivative
Let us transform a derivative of a function. Specifically, the derivative of a function y of t is 
denoted by  =
y
dy
dt . Its Laplace transform is given by
	


L
∫
∫
( ) =
=
−
∞
−
∞
y
e
ydt
e
dy
dt dt
st
st
0
0
	
(D.5)
Now we integrate by parts, to eliminate the derivative within the integrand.
Integration by parts: From calculus, we know that (
) =
+
d uv
udv
vdu
By integrating, we obtain 
∫
∫
=
+
uv
udv
vdu
Hence,
	
∫
=
−
udv
uv
vdu	
(D.6)

575
Appendix D
This is known as integration by parts.
In Equation D.5, let
	
=
=
−
u
e
v
y
and
st
Then,
	

=
=
=
dv
dy
dy
dt dt
ydt
	
=
= −
−
du
du
dt dt
se
dt
st
.
Substitute in Equation D.5 to integrate by parts:
	

L
L
L
∫
∫
∫
∫
( )
( )
( )
( )
( )
( )
=
=
=
−
=
−
−
= −
+


=
−
−
∞
−
∞
−
∞
y
e
dy
udv
uv
vdu
e
y t
se
y t dt
y
s
y t
s
y
y
0
(0)
st
st
st
0
0
0
where ( ) =
y
y
0
initial value of
. This says that the Laplace transform of a first derivative y 
equals s times the Laplace transform of the function y minus the initial value of the func-
tion (the initial condition).
Note: We can determine the Laplace transforms of the second and higher derivatives by 
repeated application this result, for the first derivative. For example, the transform of the 
second derivative is given by
	





L
L
L
L
( )
( )

=



=

−
=

−
−
y t
dy t
dt
s
y t
y
s s
y t
y
y
( )
( )
(0)
{
(0)}
(0)
	


L
L
( )
( )

=

−
−
y t
s
y t
sy
y
or,
(0)
(0)
2
D.1.2  Table of Laplace Transforms
Table D.1 shows the Laplace transforms of some common functions. Specifically, the table 
lists functions as ( )
y t , and their Laplace transforms (on the right) as ( )
Y s  or L ( )
y t . If one 
is given a function, one can get its Laplace transform from the table. Conversely, if one is 
given the transform, one can get the function from the table.
Some general properties and results of the Laplace transform are given in Table D.2.

576
Appendix D
TABLE D.1
Laplace Transform Pairs
L
==
( )
( )


−−
y t
Y s
1
L
==
( )
( )


y t
Y s
B
B s
−e at
+
s
a
1
eat
−
s
a
1
at
sinh
−
a
s
a
2
2
at
cosh
−
s
s
a
2
2
ωt
sin
ω
ω
+
s2
2
ωt
cos
ω
+
s
s2
2
ω
−e
t
sin
at
ω
ω
(
)
+
+
s
a
2
2
ω
−e
t
cos
at
ω
(
)
+
+
+
s
a
s
a
2
2
Ramp t
s
1
2
(
)
−
−e
at
1
at
(
)
+
s
s
a
2
y t( )
Y s( )

=
dy
dt
y
−
sY s
y
( )
(0)

=
d y
dt
y
2
2

−
−
s Y s
sy
y
( )
(0)
(0)
2

=
d y
dt
y
3
3


−
−
−
s Y s
s y
sy
y
( )
(0)
(0)
(0)
3
2
∫y t dt
( )
a
t
∫
−
s Y s
s
y t dt
1
( )
1
( )
a
0
+
af t
bg t
( )
( )
+
aF s
bG s
( )
( )
Unit step U(t) = 1 for t ≥ 0 
= 0 otherwise
s
1
Delayed step
−
cU t
b
(
) 
−
c
s e bs
Pulse
−
−


c U t
U t
b
( )
(
)
−




−
c
e
s
1
bs
Impulse function δ t( )
1
Delayed impulse
	

δ
−
=
−
t
b
U t
b
(
)
(
)
−e bs
Sine pulse
ω
ω
(
)
+




+
π
ω
(
)
−
s
e
1
s
2
2
C
0 0
b
t
C
00
b
t
0
b
t
0
p/w
t
0
1

577
Appendix D
In particular, note that, with zero initial conditions, differentiation can be interpreted as 
multiplication by s. Also, integration can be interpreted as division by s.
D.2  Response Analysis
The Laplace transform method can be used in the response analysis of dynamic systems, 
mechatronic and control systems in particular. We will give examples for the approach.
Example D.1
The capacitor-charge equation of the RC circuit shown in Figure D.1 is
	
=
+
e
iR
v	
(i)
TABLE D.2
Important Laplace Transform Relations
==
−−
L F s
f t
( )
( )
1
==
Lf t
F s
( )
( )
∫
π
σ
σ
−∞
+ ∞
j
F s
st ds
1
2
( )exp( )
j
j
∫
(
)
−
∞
f t
st dt
( )exp
0
+
k f t
k f t
( )
( )
1 1
2
2
+
k F s
k F s
( )
( )
1 1
2
2
−at f t
exp(
) ( )
+
F s
a
(
)
f(t − τ)
exp(−τs)F(s)
=
f
t
d f t
dt
( )
( )
n
n
n
( )

−
−
−
−
−
+
−
+
−
+
s F s
s
f
s
f
f
( )
(0 )
(0 )
(0 )
n
n
n
n
1
2
1
1
∫
−∞
f t dt
( )
t
∫
+−∞
F s
s
f t dt
s
( )
( )
0
tn
+
n
s
!
n 1
−
t e
n
at
(
)
+
+
n
s
a
!
n 1
i
e
R
C
v
FIGURE D.1
An RC circuit with applied voltage e and voltage v across capacitor.

578
Appendix D
For the capacitor,
	
=
i
C dv
dt 	
(ii)
Substitute Equation ii in Equation i to get the circuit equation:
	
=
+
e
RC dv
dt
v	
(iii)
Take the Laplace transform of each term in Equation ii), with all initial conditions = 0:
	
( )
( )
( )
=
+
E s
RCsV s
V s
The transfer function expressed as the output/input ratio (in the transform form) is
	
τ
( )
( )
( )
( )
( )
=
+
=
+
=
+
V s
E s
V s
sRCV s
V s
sRC
s
1
1
1
1	
(iv)
where τ = RC.
The actual response can now be found from Table D.1 for a given input E. The first 
step is to get the transform into proper form (like line 2):
	
τ
τ
τ
(
)
+
=
+
=
+
=
+




s
s
a
s
a
a s
a
1
1
1
1
1
where 
τ
=
a
1
. Suppose that input (excitation) e is a unit impulse. Its Laplace transform 
(see Table D.1) is E = 1. Then, from Equation iv,
	
τ
( ) =
+
V s
s
1
1
From line 2 of Table D.1, the response is
	
τ
=
=
=
τ
−
−
−
v
ae
e
RC e
1
1
at
t
t RC

■
A common transfer function for an overdamped second-order system (e.g., one with two 
RC circuit components of Figure D.1) would be
	
τ
τ
( )
( )
(
)(
)
=
+
+
V s
E s
s
s
1
1
1
1
2
This can be expressed as “partial fractions” in the form
	
τ
τ
+
+
+
A
s
B
s
1
1
1
2
and solved in the usual manner.

579
Appendix D
Example D.2
The transfer function of a thermal system is given by
	
( )
(
)(
)
=
+
+
G s
s
s
2
1
3
If a unit step input is applied to the system, with zero initial conditions, what is the 
resulting response?
Solution
Input ( ) =
U s
s
1 (for a unit step)
Since ( )
( )
(
)(
)
=
+
+
Y s
U s
s
s
2
1
3
the output (response)
	
( )
(
)(
)
=
+
+
Y s
s s
s
2
1
3
Its inverse Laplace transform gives the time response. For this, first convert the expres-
sion into partial fractions as
	
(
)(
)
(
)
(
)
+
+
=
+
+
+
+
s s
s
A
s
B
s
C
s
2
1
3
1
3 	
(i)
The unknown A is determined by multiplying Equation i throughout by s and then set-
ting =
s
0 . We obtain
	
(
)(
)
=
+
+
=
A
2
0
1 0
3
2
3
Similarly, B is obtained by multiplying Equation i throughout by (
)
+
s
1  and then setting 
= −
s
1. We obtain
	
(
)(
)
= −
−+
= −
B
2
1
1
3
1
Next, C is obtained by multiplying Equation i throughout by (
)
+
s
3  and then setting 
= −
s
3. We obtain
	
(
)(
)
= −
−+
=
C
2
3
3
1
1
3
Hence
	
( )
(
)
(
)
=
−
+
+
+
Y s
s
s
s
2
3
1
1
1
3
3

580
Appendix D
Take the inverse transform using Line 2 of Table D.1.
	
( ) =
−
+
−
−
y t
e
e
2
3
1
3
t
t
3

■
Example D.3
The transfer function of a damped simple oscillator is known to be of the form:
	
ω
ζω
ω
(
)
( )
( )
=
+
+
Y s
U s
s
s
2
n
n
n
2
2
2
where
	ωn = undamped natural frequency
	ζ  = damping ratio
Suppose that a unit step input (i.e., ( ) =
U s
s
1) is applied to the system. Using Laplace 
transform tables determine the resulting response, with zero initial conditions.
Solution
	
ω
ζω
ω
(
)
( ) =
⋅
+
+
Y s
s
s
s
1
2
n
n
n
2
2
2
The corresponding partial fractions are of the form:
	
ζω
ω
ω
ζω
ω
(
)
(
)
( ) =
+
+
+
+
=
+
+
Y s
A
s
Bs
C
s
s
s s
s
2
2
n
n
n
n
n
2
2
2
2
2
	
(i)
We need to determine A, B, and C.
Multiply Equation i throughout by s and set =
s
0. We obtain
	
=
A
1
Next note that the roots of the characteristic equation
	
ζω
ω
+
+
=
s
s
2
0
n
n
2
2
are
	
ζω
ζ
ω
ζω
ω
= −
±
−
= −
±
s
j
1
n
n
n
d
2
These are the poles of the system and are complex conjugates. Two equations for 
B and C are obtained by multiplying Equation i by 
ζω
ζ
ω
+
−
−
s
1
n
n
2
 and setting 
ζω
ζ
ω
= −
+
−
s
1
n
n
2
 and by multiplying Equation i by 
ζω
ζ
ω
+
+
−
s
1
n
n
2
 and setting 
ζω
ζ
ω
= −
−
−
s
1
n
n
2
. We obtain = −
B
1 and 
ζω
= −
C
2
n. Consequently,

581
Appendix D
	
ζω
ζω
ω
ζω
ζω
ω
ζ
ζ
ω
ζω
ω
(
)
( )
(
)
(
)
=
−
+
+
+
=
−
+
+
+




−
−
⋅
+
+




Y s
s
s
s
s
s
s
s
s
1
2
2
1
1
n
n
n
n
n
d
d
n
d
2
2
2
2
2
2
2
where ω
ζ ω
=
−
1
d
n
2
 = damped natural frequency.
Now, use Table D.1 to obtain the inverse Laplace transform:
	
ω
ζ
ζ
ω
ζ
φ
ω
φ
ω
ζ
ω
φ
( )
(
)
=
−
−
−
=
−
−
+


=
−
−
+
ζω
ζω
ζω
ζω
−
−
−
−
y
t
e
t
e
t
e
t
t
e
t
1
cos
1
sin
1
1
sin cos
cos sin
1
1
sin
step
t
d
t
d
t
d
d
t
d
2
2
2
n
n
n
n
where 
φ
ζ
=
cos
 = damping ratio; 
φ
ζ
=
−
sin
1
2 .
■
Example D.4
The open-loop response of a plant to a unit impulse input, with zero ICs, was found to 
be 
−e
t
2
sin
t
. What is the transfer function of the plant?
Solution
By linearity, since a unit impulse is the derivative of a unit step, the response to a unit 
impulse is given by the derivative of the result given in the previous example; thus,
	
ζω
ζ
ω
φ
ω
ζ
ω
φ
ω
ζ
φ
ω
φ
φ
ω
φ
( )
(
)
(
)
(
)
(
)
=
−
+
−
−
+
=
−
+
−
+


ζω
ζω
ζω
−
−
−
y
t
e
t
e
t
e
t
t
1
sin
1
cos
1
cos sin
sin cos
n
t
d
d
t
d
n
t
d
d
impulse
2
2
2
n
n
n
or
	
ω
ζ
ω
( ) =
−
ζω
−
y
t
e
t
1
sin
n
t
d
impulse
2
n
Compare this with the given expression. We have
	
ω
ζ
ζω
ω
−
=
=
=
1
2;
1;
1
n
n
d
2
But
	
ω
ζω
ω
(
)
=
+
=
+
=
1
1
2
n
n
d
2
2
2

582
Appendix D
Hence,
	
ω =
2
n
Hence,
	
ζ = 1
2
The system transfer function is
	
ω
ζω
ω
(
)
+
+
=
+
+
s
s
s
s
2
2
2
2
n
n
n
2
2
2
2

■
Example D.5
Express the Laplace-transformed expression
	
( )
(
)(
)
=
+
+
+
+
+
X s
s
s
s
s
s
5
9
7
1
2
3
2
as partial fractions. From the result, determine the inverse Laplace function ( )
x t .
Solution
	
( ) =
+
+
+
−
+
X s
s
s
s
2
2
1
1
2
From Table D.1, we get the inverse Laplace transform
	
δ
δ
( )
( )
( )
=
+
+
−
−
−
x t
d
dt
t
t
e
e
2
2
t
t
2
where δ ( ) =
t
 unit impulse function.
■
D.3  Transfer Function
By the use of Laplace transformation, a convolution integral equation can be converted into 
an algebraic relationship. To illustrate this, consider the convolution integral which gives 
the response y(t) of a dynamic system to an excitation input u(t), with zero ICs. By defini-
tion (Equation D.1), its Laplace transform is written as
	
∫∫
τ
τ
τ
=
−
−
∞
∞
Y s
h
u t
d
st dt
( )
( ) (
)
exp(
)
0
0
	
(D.7)

583
Appendix D
Note that h(t) is the impulse-response function of the system. Since the integration with 
respect to t is performed while keeping τ constant, we have 
τ
=
−
dt
d t(
). Consequently,
	
∫
∫
τ
τ
τ
τ
τ
τ
=
−
−
−


−
−
τ
−
∞
∞
Y s
u t
s t
d t
h
s
d
( )
(
)exp
(
)
(
)
( )exp(
)
0
The lower limit of the first integration can be made equal to zero, in view of the fact that 
u(t) = 0 for t < 0. Again, by using the definition of Laplace transformation, the foregoing 
relation can be expressed as
	
=
Y s
H s U s
( )
( ) ( )	
(D.8)
whereas
	
L
∫
=
=
−
∞
H s
h t
h t
st dt
( )
( )
( )exp(
)
0
	
(D.9)
Note that, by definition, the transfer function of a system, denoted by H s( ), is given by 
Equation D.8. More specifically, system transfer function is given by the ratio of the 
Laplace-transformed output and the Laplace-transformed input, with zero initial condi-
tions. In view of Equation D.9, it is clear that the system transfer function can be expressed 
as the Laplace transform of the impulse-response function of the system. Transfer function 
of a linear and constant-parameter system is a unique function that completely represents 
the system. A physically realizable, linear, constant-parameter system possesses a unique 
transfer function, even if the Laplace transforms of a particular input and the correspond-
ing output do not exist. This is clear from the fact that the transfer function is a system 
model and does not depend on the system input itself.
Note: The transfer function is also commonly denoted by G(s). But, in the present context, 
we use H(s) in view of its relation to h(t).
Consider the nth-order linear, constant-parameter dynamic system given by
	


+
+
+
=
+
+
+
−
−
−
a d y
dt
a
d
y
dt
a y
b u
b du t
dt
b d u t
dt
( )
( )
n
n
n
n
n
n
o
o
m
m
m
1
1
1
1
	
(D.10)
For a physically realizable system, m ≤ n. By applying Laplace transformation and then 
integrating by parts, it may be verified that
	

L
=
−
−
−
+
−
−
−
−
d f t
dt
s F s
s
f
s
df
dt
d
f
dt
( )
ˆ( )
(0)
(0)
(0)
k
k
k
k
k
k
k
1
2
1
1
	
(D.11)
By definition, the initial conditions are set to zero in obtaining the transfer function. This 
results in
	


=
+
+
+
+
+
H s
b
b s
b s
a
a s
a s
( )
m
m
n
n
0
1
0
1
	
(D.12)

584
Appendix D
for m ≤ n. Note that Equation D.12 contains all the information that is contained in Equation 
D.10. Consequently, a transfer function is an analytical model of a system. The transfer 
function may be employed to determine the total response of a system for a given input, 
even though it is defined in terms of the response under zero initial conditions. This is 
quite logical because the analytical model of a system is independent of the initial condi-
tions of the system.
D.4  Fourier Transform
The Fourier transform Y(f) of a signal y(t) relates the time domain to the frequency domain. 
Specifically,
	
∫
∫
π
=
−
=
ω
−∞
+∞
−
−∞
+∞
Y f
y t
j
ft dt
y t e
dt
( )
( )exp(
2
)
 
( )
 
t
	
(D.13)
Using the Fourier operator F  terminology
	
F
( )
( )
=
Y f
y t 	
(D.14)
Note that if y(t) = 0 for t < 0, as in the conventional definition of system excitations and 
responses, the Fourier transform is obtained from the Laplace transform by simply chang-
ing the variable according to s = j2πf or s = jω. The Fourier is a special case of the Laplace, 
where, in Equation D.2, σ = 0:
	
=
π
=
Y f
Y s
( )
( ) s
j
f
2
	
(D.15)
or
	
ω =
ω
=
Y
Y s
( )
( ) s
j 	
(D.16)
The (complex) function Y(f) is also termed the (continuous) Fourier spectrum of the (real) 
signal y(t). The inverse transform is given by
	
F
∫
π
( )
( )
=
=
−∞
+∞
−
y t
Y f
j
ft df
y t
Y f
( )
( )exp( 2
)
 
or
1
	
(D.17)

585
Appendix D
Note that according to the definition given by Equation D.13, the Fourier spectrum Y(f) 
is defined for the entire frequency range f(–∞, +∞), which includes negative values. This 
is termed the two-sided spectrum. Since in practical applications it is not possible to have 
“negative frequencies,” the one-sided spectrum is usually defined only for the frequency 
range f(0, ∞).
In order that a two-sided spectrum have the same amount of power as a one-sided spec-
trum, it is necessary to make the one-sided spectrum double the two-sided spectrum for f > 0.
If the signal is not sufficiently transient (fast-decaying or damped), the infinite integral 
given by Equation D.13 might not exist, but the corresponding Laplace transform might 
still exist.
D.4.1  Frequency-Response Function (Frequency Transfer Function)
The Fourier integral transform of the impulse-response function is given by
	
∫
π
=
−
−∞
∞
H f
h t
j
ft dt
( )
( )exp(
2
)
	
(D.18)
where f is the cyclic frequency (measured in cycles/s or hertz). This is known as the fre-
quency-response function (or, frequency-transfer function) of a system. Fourier transform 
operation is denoted as F ( )
( )
=
h t
H f . In view of the fact that h(t) = 0 for t < 0, the lower limit 
of integration in Equation D.18 could be made zero. Then, from Equation D.9, it is clear that 
H(f) is obtained simply by setting 
π
=
s
j
f
2
 in H(s). Hence, strictly speaking, we should use 
the notation 
π
H j
f
( 2
) and not H(f). But, for notational simplicity, we denote H(j2πf) by H(f). 
Furthermore, since the angular frequency ω
π
=
f
2
, we can express the frequency response 
function by 
ω
H j(
), or simply by 
ω
H( ) for the notational convenience. It should be noted that 
the frequency-response function, like the (Laplace) transfer function, is a complete repre-
sentation of a linear, constant-parameter system. In view of the fact that both 
=
u t( )
0 and 
=
y t( )
0 for t < 0, we can write the Fourier transforms of the input and the output of a system 
directly by setting 
π
ω
=
=
s
j
f
j
2
 in the corresponding Laplace transforms.
Then, from Equation D.8, we have
	
=
Y f
H f U f
( )
( ) ( )	
(D.19)
Note: Sometimes for notational convenience, the same lowercase letters are used to rep-
resent the Laplace and Fourier transforms as well as the original time-domain variables.
If the Fourier integral transform of a function exists, then its Laplace transform also 
exists. The converse is not generally true, however, because of poor convergence of the 
Fourier integral in comparison to the Laplace integral. This arises from the fact that the 
factor 
σ
−t
exp(
) is not present in the Fourier integral. For a physically realizable, linear, 
constant-parameter system, H(f) exists even if U(f) and Y(f) do not exist for a particular 
input. The experimental determination of H(f), however, requires system stability. For the 
nth-order system given by Equation D.10, the frequency-response function is determined 
by setting 
π
=
s
j
f
2
 in Equation D.12 as
	


π
π
π
π
=
+
+
+
+
+
+
H f
b
b j
f
b
j
f
a
a j
f
a
j
f
( )
2
( 2
)
2
( 2
)
m
m
n
n
0
1
0
1
	
(D.20)

586
Appendix D
This, generally, is a complex function of f, which has a magnitude denoted by H f( )  and a 
phase angle denoted by ∠H f( ).
D.5  The s-Plane
We have noted that the Laplace variable s is a complex variable with a real part and an 
imaginary part. Hence, to represent it we will need two axes at right angles to each other—
the real axis and the imaginary axis. These two axes form a plane, which is called the 
s-plane. Any general value of s (or any variation or trace of s) may be marked on the s-plane.
D.5.1  An Interpretation of Laplace and Fourier Transforms
In the Laplace transformation of a function f t( ), we multiply the function by −e st and inte-
grate with respect to t. This process may be interpreted as determining the “components” 
F s( ) of f t( ) in the “direction” −e st where s is a complex variable. All such components F s( ) 
should be equivalent to the original function f t( ).
In the Fourier transformation of f t( ), we multiply it by 
ω
−e
j t and integrate with respect 
to t. This is the same as setting 
ω
=
s
j . Hence, the Fourier transform of f t( ) is 
ω
F j(
). 
Furthermore, 
ω
F j(
) represents the components of f t( ) that are in the direction of 
ω
−e
j t. Since 
ω
ω
=
−
ω
−e
t
j
t
cos
sin
j t
, in the Fourier transformation what we do is to determine the sinu-
soidal components of frequency ω of a time function f t( ). Since s is complex, F s( ) is also 
complex and so is 
ω
F j(
). Hence, they all will have a real part and an imaginary part.
D.5.2  Application in Circuit Analysis
The fact that 
ωt
sin
 and 
ωt
cos
 are 90° out of phase is further confirmed in view of
	
ω
ω
=
+
ω
e
t
j
t
cos
sin
j t
	
(D.21)
Consider the R-L-C circuit shown in Figure D.2. For the capacitor, the current (i) and the 
voltage (v) are related through
	
=
i
C dv
dt 	
(D.22)
If the voltage 
ω
=
v
v
t
sin
o
, the current 
ω
ω
=
i
v
C
t
cos
o
. Note that the magnitude of v i is ωC
1  
(or π fC
1
2
 where ω
π
=
f
2
; f  is the cyclic frequency and ω is the angular frequency). But v 
and i are out of phase by 90°. In fact, in the case of a capacitor, i leads v by 90°. The equiva-
lent circuit resistance of a capacitance is called reactance and is given by
	
π
=
X
fC
1
2
C
	
(D.23)
	
ω
=
C
1
	
(D.24)

587
Appendix D
Note that this parameter changes with the frequency.
We cannot add the reactance of the capacitor and the resistance of the resistor algebra-
ically; we must add them vectorialy because the voltages across a capacitor and resistor in 
series are not in phase, unlike in the case of a resistor. Also, the resistance in a resistor does 
not change with frequency. In a series circuit, as in Figure D.2, the current is identical in 
each element, but the voltages differ in both amplitude and phase; in a parallel circuit, the 
voltages are identical, but the currents differ in amplitude and phase.
Similarly, for an inductor
	
=
v
L di
dt 	
(D.25)
The corresponding reactance is
	
ω
π
=
=
X
L
fL
2
L
	
(D.26)
If the voltage (E) across R in Figure D.2a is in the direction shown in Figure D.2b (i.e., point-
ing to the right), then the voltage across the inductor L must point upward (90° leading), 
and the voltage across the capacitor C must point down (90° lagging). Since the current (I) 
is identical in each component of a series circuit, we see the directions of IR, IXL, and IXC 
as in Figure D.2b, giving the impedance triangle shown in Figure D.2c.
To express these reactances in the s domain, we simply substitute s for ω
j :
	
−
=
jX
sC
1
C
	
=
jX
sL
L
The series impedance of the RLC circuit can be expressed as
	
=
+
−
=
+
+
Z
R
jX
jX
R
sL
sC
1
L
C
In this discussion, note the use of −1 or j to indicate a 90° phase change.
E
R
L
C
(a)
EL or IXL
ER or IR
EC or IXC
XL – XC
R
Z
θ
(b)
(c)
FIGURE D.2
(a) Series RLC circuit; (b) phases of voltage drops; (c) impedance triangle.


589
Appendix E: Software Tools
Modeling, analysis, design, data acquisition, and control are important activities within 
the field of mechatronic engineering. Computer software tools and environments are avail-
able for effectively carrying out, both at the learning level and at the professional applica-
tion level. Several such environments and tools are commercially available. A selected few, 
which are particular useful for the tasks related to the present book, are outlined here.
MATLAB®* is an interactive computer environment with a high-level language and tools 
for scientific and technical computation, modeling and simulation, design, and control of 
dynamic systems. Simulink®* is a graphical environment for modeling, simulation, and 
analysis of dynamic systems, and is available as an extension to MATLAB. LabVIEW* is 
a graphical programming language and a program development environment for data 
acquisition, processing, display, and instrument control.
E.1  Simulink
Computer simulation of a dynamic model by using Simulink is outlined in Chapter 3. 
Simulink is a graphic environment that uses block diagrams. It is an extension to MATLAB.
E.2  MATLAB
MATLAB interactive computer environment is very useful in computational activities in 
mechatronics. Computations involving scalars, vectors, and matrices can be carried out 
and the results can be graphically displayed and printed. MATLAB toolboxes are available 
for performing specific tasks in a particular area of study such as control systems, fuzzy 
logic, neural network, data acquisition, image processing, signal processing, system identi-
fication, optimization, model predictive control, robust control, and statistics. User guides, 
Web-based help, and online help from the parent company, MATH WORKS, Inc., and vari-
ous other sources. What is given here is a brief introduction to get started in MATLAB for 
tasks that are particularly related to controls and mechatronics.
E.2.1  Computations
Mathematical computations can be done by using the MATLAB command window. Simply 
type in the computations against the MATLAB prompt “>>” as illustrated next.
* MATLAB and Simulink are registered trademarks and products of The MathWorks, Inc. LabVIEW is a product 
of National Instruments, Inc.

590
Appendix E
Arithmetic
An example of a simple computation using MATLAB is given as follows:
>> x=2; y=-3;
>> z=x^2-x*y+4
z = 14
In the first line, we have assigned values 2 and 3 to two variables x and y. In the next line, 
the value of an algebraic function of these two variables is indicated. Then, MATLAB pro-
vides the answer as 14. Note that if you place a “;” at the end of the line, the answer will 
not be printed/displayed.
Table E.1 gives the symbols for common arithmetic operations used in MATLAB.
The following example shows the solution of the quadratic equation 
+
+
=
ax
bx
c
0
2
:
>> a=2;b=3;c=4;
>> x=(-b+sqrt(b^2-4*a*c))/(2*a)
x =
  −0.7500 + 1.1990i
The answer is complex, where i denotes 
−1. Note that the function sqrt( ) is used, 
which provides the positive root only. Some useful mathematical functions are given in 
Table E.2.
Arrays
An array may be specified by giving the start value, increment, and the end value limit. An 
example is given as follows:
>> x=(.9:-.1:0.42)
x =
    0.9000    0.8000    0.7000    0.6000    0.5000
The entire array may be manipulated. For example, all the elements are multiplied by π as 
below:
>> x=x*pi
x =
    2.8274    2.5133    2.1991    1.8850    1.5708
The second and fifth elements are obtained by
TABLE E.1
MATLAB Arithmetic Operations
Symbol
Operation
+
Addition
−
Subtraction
*
Multiplication
/
Division
^
Power

591
Appendix E
>> x([2 5])
ans =
    2.5133    1.5708
Next, we form a new array y using x, and then plot the two arrays, as shown in Figure E.1.
>> y=sin(x);
>> plot(x,y)
TABLE E.2
Useful Mathematical Functions in MATLAB
Function
Description
abs( )
Absolute value/magnitude
acos( )
Arc-cosine (inverse cosine)
acosh( )
Arc-hyperbolic-cosine
asin( )
Arc-sine
atan( )
Arc-tan
cos( )
Cosine
cosh( )
Hyperbolic cosine
exp( )
Exponential function
imag( )
Imaginary part of a complex number
log( )
Natural logarithm
log10( )
Log to base 10 (common log)
real( )
Real part of a complex number
sign( )
Signum function
sin( )
Sine
sqrt( )
Positive square root
tan( )
Tan function
Note:	 MATLAB is case sensitive.
1
0.9
0.8
0.7
0.6
0.5
0.4
0.31.5
2
2.5
3
FIGURE E.1
A plot using MATLAB.

592
Appendix E
A polynomial may be represented as an array of its coefficients. For example, the quadratic 
equation 
+
+
=
ax
bx
c
0
2
 as given before, with a = 2, b = 3, and c = 4, may be solved using the 
function “roots” as follows:
>> p=[2 3 4];
>> roots(p)
ans =
  −0.7500 + 1.1990i
  −0.7500 − 1.1990i
The answer is the same as what we obtained before.
E.2.2  Relational and Logical Operations
Useful relational operations in MATLAB are given in Table E.3. Basic logical operations 
are given in Table E.4.
Consider the following example:
>> x=(0:0.25:1)*pi
x =
         0    0.7854    1.5708    2.3562    3.1416
>> cos(x)>0
ans =
     1     1     1     0     0
>> (cos(x)>0)&(sin(x)>0)
ans =
     0     1     1     0     0
In this example, first an array is computed. Then, the cosine of each element is computed. 
Next, it is checked whether the elements are positive (a truth value of 1 is sent out if true, 
and a truth value of 0 if false). Finally, the “AND” operation is used to check whether both 
corresponding elements of two arrays are positive. 
TABLE E.3
Some Relational Operations in MATLAB
Operator
Description
<
Less than
<=
Less than or equal to
>
Greater than
>=
Greater than or equal to
= =
Equal to
~=
Not equal to
TABLE E.4
Basic Logical Operations in MATLAB
Operator
Description
&
AND
|
OR
~
NOT

593
Appendix E
E.2.3  Linear Algebra
MATLAB can perform various computations with vectors and matrices. Some basic illus-
trations are given here.
A vector or a matrix may be specified by assigning values to its elements. Consider the 
following example:
>> b=[1.5 −2];
>> A=[2 1;-1 1];
>> b=b'
b =
    1.5000
   −2.0000
>> x=inv(A)*b
x =
    1.1667
   −0.8333
In this example, first a second-order row vector and 2 × 2 matrix are defined. The row vec-
tor is transposed to get a column vector. Finally, the matrix-vector equation 
=
Ax
b is solved 
according to =
−
x
A b
1 . The determinant and the eigenvalues of A are determined by
>> det(A)
ans =
     3
>> eig(A)
ans =
   1.5000 + 0.8660i
   1.5000 − 0.8660i
Both eigenvectors and eigenvalues of A computed as
>> [V,P]=eig(A)
V =
   0.7071             0.7071          
  −0.3536 + 0.6124i  −0.3536 − 0.6124i
P =
   1.5000 + 0.8660i        0          
        0             1.5000 − 0.8660i
Here, the symbol V is used to denote the matrix of eigenvectors. The symbol P is used to 
denote the diagonal matrix whose diagonal elements are the eigenvalues.
Useful matrix operations in MATLAB are given in Table E.5, and several matrix func-
tions are given in Table E.6.
E.2.4  M-Files
The MATLAB commands have to be keyed in on the command window one by one. When 
several commands are needed to carry out a task, the required effort can be tedious. Instead, 
the necessary commands can be placed in a text file and edited as appropriate (using text 
editor), which MATLAB can use to execute the complete task. Such a file is called an M-file. 
The file name must have the extension “m” in the form filename.m. A toolbox is a collection 

594
Appendix E
of such files for use in a particular application area (e.g., control systems, fuzzy logic). 
Then, by keying in the M-file name at the MATLAB command prompt, the file will be 
executed. The necessary data values for executing the file have to be assigned beforehand.
E.3  Control Systems Toolbox
There are several toolboxes with MATLAB, which can be used to analyze, compute, sim-
ulate, and design control problems. Both time-domain representations and frequency-
domain representations can be used. Also, both classical and modern control problems 
can be handled. The application is illustrated here through several conventional control 
problems.
E.3.1  Compensator Design Example
A speed control system shown in Figure E.2a has a compensator, a controller and amplifier 
gain K, and a dc motor with transfer function 
+
s
1
(10
1)
 in the forward path, and a low-pass 
filter of transfer function 
+
s
1
(0.1
1) in the feedback path. The signal y (system output) from 
the speed sensor is conditioned by the filter and compared with the speed command u 
(system input). The resulting error signal is fed into the control amplifier. The controller 
may be tuned by adjusting the gain K. Since the required performance was not achieved 
by this adjustment alone, it was decided to add a compensator network into the forward 
path of the control loop. The design specifications are (1) steady-state accuracy of 99.9% for 
a step input and (2) percentage overshoot of 10%.
Design: (a) a lead compensator and (b) a lag compensator to meet these design 
specifications.
TABLE E.5
Some Matrix Operations in MATLAB
Operation
Description
+
Addition
−
Subtraction
*
Multiplication
/
Division
^
Power
‘
Transpose
TABLE E.6
Useful Matrix Functions in MATLAB
Function
Description
det( )
Determinant
inv( )
Inverse
eig( )
Eigenvalues
[ , ]=eig( )
Eigenvectors and eigenvalues

595
Appendix E
(Continued)
Compensator
Motor
Filter
Input
u
Speed
y
Ampliﬁer
K
−
(
)
1
10
1
 s+
(
)
1
0.1
1
 s+
(a)
(b)
(c)
output
FIGURE E.2
(a) Compensator design for a velocity servo. (b) Importing the model into the SISO Design Tool. (c) Root locus 
and Bode plots for the motor model. (d) Closed-loop step response of the motor system without compensation. 
(e) Root locus and Bode plots of the compensated system. (f) Closed-loop step response of the compensated 
system.

596
Appendix E
(Continued)
Step response
Time (s)
Amplitude
0
0.2
0.4
0.6
0.8
1
1.2
–0.5
0
0.5
1
1.5
2
2.5
3
3.5
From: r
To: y
(d)
(e)
FIGURE E.2 (CONTINUED)
(a) Compensator design for a velocity servo. (b) Importing the model into the SISO Design Tool. (c) Root locus 
and Bode plots for the motor model. (d) Closed-loop step response of the motor system without compensation. 
(e) Root locus and Bode plots of the compensated system. (f) Closed-loop step response of the compensated 
system.

597
Appendix E
The MATLAB SISO (single-input-single-output) Design Tool is used here to solve this 
problem. 
Building the System Model
Build the transfer-function model of the Motor and Filter in the MATLAB workspace as 
follows:
Motor_G = tf([999], [10 1]);
Filter_H = tf([1], [0.1 1]);
To open the SISO Design Tool, type
sisotool
at the MATLAB prompt (>>).
Importing Model into SISO Design Tool
Select Import Model under the File menu. This opens the Import System Data dialog box, 
as shown in Figure E.2b.
Use the following steps to import the motor and filter models:
	
1.	Select Motor_G under SISO Models.
	
2.	Place it into the G field under Design Model by pressing the right arrow button to 
the left of G.
	
3.	Similarly import the filter model.
	
4.	Press OK.
Step response
Time (s)
Amplitude
0
1
2
3
4
5
6
7
0
0.2
0.4
0.6
0.8
1
1.2
1.4
From: r
To: y
(f)
FIGURE E.2 (CONTINUED)
(a) Compensator design for a velocity servo. (b) Importing the model into the SISO Design Tool. (c) Root locus 
and Bode plots for the motor model. (d) Closed-loop step response of the motor system without compensation. (e) 
Root locus and Bode plots of the compensated system. (f) Closed-loop step response of the compensated system.

598
Appendix E
Now, the main window of the SISO Design Tool will show the root locus and Bode plots of 
open loop transfer function GH (see Figure E.2c). As given in the figure, the phase margin 
is 18.2°, which occurs at 30.8 rad/s (4.9 Hz).
The closed-loop step response, without compensation, is obtained by selecting 
Tools→Loop responses→Closed-loop step from the main menu. The response is shown 
in Figure E.2d. It is noted that the phase margin is not adequate, which explains the oscil-
lations and the long settling time. Also the P.O. is about 140%, which is considerably higher 
than the desired one (10%) and is not acceptable. 
Adding Lead and Lag Compensators
To add a lead compensator, right-click the mouse in the white space of the Bode magni-
tude plot, choose Add Pole/Zero and then lead in the right-click menu for the open-loop 
Bode diagram. Move the zero and the pole of the lead compensator to get a desired phase 
margin about 60°. 
To add a lag compensator, choose Add Pole/Zero and then lag in the right-click menu for 
the open-loop Bode diagram. Move the zero and the pole of the lag compensator to get a 
desired phase angle of about −115° at the crossing frequency, which corresponds to a phase 
margin of 180°−115° = 65°. 
With the added lead and leg compensators, the root locus and Bode plots of the system are 
shown in Figure E.2e. The closed-loop step response of the system is shown in Figure E.2f. 
E.3.2  PID Control with Controller Tuning
Consider a unity-feedback control system where the forward path has the controller and 
a plant of transfer function 
+ +
s s
s
1
(
4)
2
. The SISO Design Tool of MTLAB Control Systems 
Toolbox is used. First build the transfer-function model of the given system (call it Mill).
Mill_G = tf([1], [1 1 4 0]);
Filter_H = tf([1], [1]);
Now import the system model into the SISO Design Tool. 
	 (a)	 Proportional control
	
	 First, by trial and error, we determine the proportional gain that will make the 
system marginally stable. As seen in Figure E.3a, when K = 4, the gain margin is 
just below 0 dB, which makes the system unstable. The response of the system is 
shown in Figure E.3b.
	
	 According to Ziegler-Nichols controller settings, we can choose the proper pro-
portional gain as Kp = 0.5 × 4 = 2. The corresponding system response is shown in 
Figure E.3c.
	 (b)	 PI control
	
	 Note that the period of oscillations (ultimate period) is
	
π
ω
π
π
=
=
=
P
2
2
2
s
u
n
	
	 Hence, from the Ziegler–Nichols settings, we have the following settings for a PI 
controller:

599
Appendix E
(a)
Step response
Time (s) 
Amplitude
0
5
10
15
20
25
0
0.5
1
1.5
From: r
To: y
(b)
Step response
Time (s)
Amplitude
0
5
10
15
0
0.2
0.4
0.6
0.8
1
1.2
1.4
From: r
To: y
(c)
(d)
Step response
Time (s)
Amplitude
0
10
20
30
40
50
60
70
80
90
0
0.5
1
1.5
From: r
To: y
(e)
(f)
Step response
Time (s)
Amplitude
0
10
20
30
40
50
60
0
0.5
1
1.5
From: 
To: y
r
(g)
FIGURE E.3
(a) Root locus and Bode plots of the system with proportional gain Kp = 4. (b) Step response of the closed-loop 
system with Kp = 4. (c) Step response of the closed-loop system with Kp = 2. (d) Bode plot of the system with PI 
control. (e) Step response of the system with PI control. (f) Bode plot of the system with PID control. (g) Step 
response of the system with PID control.

600
Appendix E
	
=
×
=
K
0.45
4
1.8
p
	
τ
π
=
=
0.83
2.61s.
i
	
	 Hence, the PI controller transfer function is
	
τ
τ
τ
+



=
+
=
+
=
+
K
s
K
s
K
s
s
s
s
s
1
1
4.68
1.8
2.61
0.214 2.6
1
p
i
p
i
p
i
	
	 Insert this controller into C in the SISO Design Tool. The corresponding system 
Bode plot and the step response are shown in Figure E.6d and e, respectively.
	 (c)	 PID control
	
	 From Ziegler–Nichols settings, we pick the following parameters for a PID 
controller:
	
=
×
=
K
0.6
4
2.4
p
	
τ
π
=
=
0.5
1.57 s
i
	
τ
π
=
=
0.125
0.393 s.
d
	
	 The corresponding transfer function of the PID controller is
	
τ
τ
τ τ
τ
τ
+
+



=
+
+
=
+
+
=
+
+
K
s
s
K
s
K
s
K
s
s
s
s
s
s
s
1
1
1.48
3.768
2.4
1.57
0.94
2.4
1.53
p
i
d
p
i
d
p
i
p
i
2
2
2
	
	 Use the MATLAB function roots to calculate the roots of the numerator polynomial. 
	
R = roots([0.94 2.4 1.53]);
	
R = –1.3217
         –1.2315
	
	 Hence, the transfer function of the PID controller is
	
+
+
=
+
+
s
s
s
s
s
s
(
1.32)(
1.23)
0.616 (0.76
1)(0.81
1)
	
	 Insert this controller into C of the SISO Design Tool. The corresponding Bode plot 
and the step response of the controlled system are shown in Figure E.6f and g.
E.3.3  Root Locus Design Example
Consider a control system (steel rolling mill with unity feedback). The forward path has a 
controller represented by gain K, a lead compensator 
+
+
s
z
s
p
(
)
(
) , and the mill whose transfer 
function is 
+
s s
1
(
5)
. We use the SISO Design Tool to design a suitable lead compensator. 
First, build the transfer function model for the rolling mill with no filter:
Mill_G = tf([1], [1 5 0]);
Filter_H = tf([1], [1]);

601
Appendix E
(Continued)
Step response
Time (s)
Amplitude
0
5
10
15
20
25
30
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
From: r
To: y
(b)
(a)
FIGURE E.4 
(a) Root locus and Bode plots of the rolling mill system without compensation. (b) Step response of the closed-
loop system without compensation. (c) Root locus of the compensated system. (d) Step response of the compen-
sated closed-loop system.

602
Appendix E
Time (s) 
0
0.05
0.1
0.15
0.2
0.25
0.3
0.35
0.4
0.45
0.5
0
0.2
0.4
0.6
0.8
1
1.2
1.4
Step response
From: r
Amplitude
To: y
(d)
(c)
FIGURE E.4 (CONTINUED)
(a) Root locus and Bode plots of the rolling mill system without compensation. (b) Step response of the closed-
loop system without compensation. (c) Root locus of the compensated system. (d) Step response of the compen-
sated closed-loop system.

603
Appendix E
Then, import the system model into the SISO Design Tool. The root locus and the step 
response of the closed-loop system are shown in Figure E.7a and b. From Figure E.4b, it 
is seen that the peak time and the 2% settling time do not meet the design specifications.
To add a lead compensator, right-click in the white space of the root locus plot, choose 
Add Pole/Zero and then lead in the right-click menu. Left-click on the root locus plot 
where we want to add the lead compensator.
Now we have to adjust the pole and zero of the lead compensator and the loop gain so 
that the root locus passes through the design region. To speed up the design process, turn 
on the grid setting for the root locus plot. The radial lines are constant damping ratio lines 
and the semicircular curves are constant undamped natural frequency lines. 
On the root locus plot, drag the pole and zero of the lead compensator (pink cross or 
circle symbol on the plot) so that the root locus moves toward the design region. Left-click 
and move the closed-loop pole (small pink-color square box) to adjust the loop gain. As 
you drag the closed-loop pole along the locus, the current location of that pole, the system 
damping ratio, and the natural frequency will be shown at the bottom of the graph.
Drag the closed-loop pole into the design region. The resulting lead compensator, the 
loop gain, and the corresponding root locus are shown in Figure E.4c. The step response 
of the compensated closed-loop system is shown in Figure E.4d.
E.4  Fuzzy Logic Toolbox
Fuzzy logic is useful in intelligent systems. The Fuzzy Logic Toolbox of MATLAB is 
quite useful in this regard. Using it, we create and edit fuzzy decision-making systems 
(for ­control and other applications) by means of interactive graphical tools or command-
line functions. Simulink can be used to simulate the developed fuzzy system. Real-time 
Workshop can create portable C code from a Simulink environment for use in real-time and 
non-­real-time applications. The toolbox also provides source codes in C for implementing 
a stand-alone fuzzy inference engine. The stand-alone C-code fuzzy inference engine can 
read an FIS file (the file format for saving the fuzzy engine in MATLAB). In other words, 
it is able to parse the stored information, to perform fuzzy inference directly, or it can be 
embedded in other external applications. The design process of a fuzzy decision-making 
system involves the following general steps: input data, fuzzification, implication (or fuzzy 
rules), aggregation (or composition), and inference defuzzification.
E.4.1  Graphical Editors
There are five primary graphical user interface (GUI) tools for building, editing, and 
observing fuzzy inference systems in the MATLAB Fuzzy Logic Toolbox: the FIS Editor, 
the Membership Function Editor, the Rule Editor, the Rule Viewer, and the Surface Viewer. 
The FIS Editor handles the high-level issues for the system, for example, the number of 
inputs, outputs and names. The Membership Function Editor is used to define the shapes 
of the membership functions associated with each variable. The Rule Editor is used for 
editing the rules in the fuzzy knowledge base, which describes defines the knowledge of 
the application (control knowledge, in the case of fuzzy control). The Rule Viewer and the 
Surface Viewer are used for observing (not editing) the designed FIS. Try the example on 
tipping in a restaurant, by clicking on the file menu and loading FIS from disk. The tipper.
fis is located at ./Matlabr12/toolbox/fuzzy/fuzzydemos/tipper.fis

604
Appendix E
	
1.	FIS Editor
	
	 It displays general information about a fuzzy inference system. Double-click on an 
icon to open and carry out editing related that particular item, and save the results.
	
2.	Membership Function Editor
	
	 It shares some features with the FIS Editor. It is a menu-driven interface, which allows 
the user to open/display and edit the membership functions for the entire fuzzy 
inference system; specifically the membership functions of inputs and outputs. 
	
3.	Rule Editor
	
	 It contains an editable text field for displaying and editing rules. It also has some 
landmarks similar to those in the FIS Editor and the Membership Function Editor, 
including the menu bar and the status line. The Format pop-up menu is available 
from the Options pull-down menu in the top menu bar. This is used to set the 
format for the display.
	
4.	Rule Viewer
	
	 It displays a roadmap of the entire fuzzy inference process. It is based on the fuzzy 
inference diagram. The user will see a single figure window with seven small 
plots nested in it. The two small plots across the top of the figure represent the 
antecedent and the consequent of the first rule. Each rule is a row of plots, and 
each column is a variable.
	
5.	Surface Viewer
	
	 This allows the user to view the overall decision-making surface (the control sur-
face). This is a nonfuzzy representation of the fuzzy application and is analogous 
to a look-up table albeit continuous.
E.4.2  Command Line-Driven FIS Design
A pre-designed FIS may be loaded into the MATLAB workspace by typing
>> myfis = readfis(‘name_of_file.fis’)
 
Typing the showfis(myfis) command will enable us to see the details of the FIS. Use the 
getfis command to access information of the loaded FIS. For example,
>> getfis(myfis)
>> getfis(myfis, ‘Inlabels’)
>> getfis(myfis, ‘input’, 1)
>> getfis(myfis, ‘output’, 1)
 
The command setfis may be used to modify any property of an FIS. For example,
>> setfis(myfis, ‘name’, ‘new_name’);
 
The following three functions are used to display the high-level view of a fuzzy inference 
system from the command line:
>> plotfis(myfis)
>> plotmf(myfis, ‘input’, input_number) 
or plotmf(myfis, ‘output’, output_number)
>> gensuf(myfis)

605
Appendix E
To evaluate the output of a fuzzy system for a given input, we use the function:
>> evalfis([input matrix], myfis)
 
For example, evalfis([1 1], myfis) is used for single-input evaluation, and evalfis([1 1; 2 3] 
myfis) for multiple-input evaluation.
Note that we may directly edit a previously saved .fis file, besides manipulating a fuzzy 
inference system from the toolbox GUI or from the MATLAB workspace through the com-
mand line.
E.4.3  Practical Stand-alone Implementation in C
The MATLAB Fuzzy Logic Toolbox allows you to run your own stand-alone C programs 
directly, without the need for Simulink. This is made possible by a stand-alone fuzzy 
inference engine that reads the fuzzy systems saved from a MATLAB session. Since the C 
source code is provided, you can customize the stand-alone engine to build fuzzy infer-
ence into your own code. This procedure is outlined in Figure E.5.
Fuzzy
logic
toolbox
Testing using
Simulink
MATLAB
Design
stage
FIS 
ﬁles
…….
…...
Fuzzy
stand alone
engine
Main
routine
Other
subroutines
Application
software
Hardware
modules
(e.g., ADC/DAC
 
board)
Physical 
system
Sensors
Implementation in real time
FIGURE E.5
Target implementation of a fuzzy system.

606
Appendix E
E.5  LabVIEW*
LabVIEW, or Laboratory Virtual Engineering Workbench, is a product of National 
Instruments, Inc. It is a software development environment for data acquisition, instru-
ment control, image acquisition, motion control, and presentation. LabVIEW is a complied 
graphical environment, which allows the user to create programs graphically through 
wired icons similar to creating a flowchart.
E.5.1  Introduction
LabVIEW is a general programming language such as the high-level programming lan-
guages C or Basic, but labVIEW is a higher-level language. LabVIEW programs are called 
virtual instruments (VIs), which use icons to represent subroutines. It is similar to flow 
charting codes as you write them. The LabVIEW development environment uses the 
graphical programming language G.
E.5.2  Some Key Concepts
E.5.3  Working with LabVIEW
As a software-centered system, LabVIEW resides in a desktop computer or laptop as an 
application platform where it acts as a set of VIs, providing the functionality of traditional 
hardware instruments such as oscilloscopes. Comparing to physical instruments with 
* For details see LabVIEW User Manual Glossary and G programming Reference Manual Glossary, which 
are available online at http://www.ni.com/pdf/manuals/320999b.pdf and http://www.ni.com/pdf/
manuals/321296b.pdf, respectively.
Block diagram
Pictorial description or representation of a program or algorithm. In a G program, 
the block diagram consists of executable icons called nodes and wires that carry 
data between the nodes.
G programming
G is a convenient graphical data flow programming language on which LabVIEW is 
based. G simplifies scientific computation, process monitoring and control, and 
applications of testing and measurement.
Control
Front panel object such as a knob, push button, or dial for entering data to a VI 
interactively or by programming.
Control terminal
Terminal linked to a control on the front panel, through which input data from the 
front panel passes to the block diagram.
Front panel
Interactive user interface of a VI. The front panel appearance imitates physical 
instruments, such as oscilloscopes and multimeters.
Indicator
Front panel object that displays output, such as a graph or turning on a light-
emitting diode.
Waveform chart
Indicator that plots data points at a certain rate.
While loop
Loop structure that repeats a code section until a given condition is met. It is 
comparable to a Do loop or a Repeat-Until in conventional programming 
languages.
Wire
Data path between nodes.

607
Appendix E
fixed functions, LabVIEW VIs are flexible and can easily be reconfigured to different appli-
cations. It is able to interface with various hardware devices such as GPIB, data acquisition 
modules, distributed input/output (I/O), image acquisition, and motion control, making it 
a modular solution. This utility is shown in Figure E.6.
Front Panel
Upon launching LabVIEW, you will be able to create or open an existing VI where the lay-
out of the GUI can be designed. Figure E.7 shows the front panel of the simple alarm slide 
control (alarmsld.lib) example included with LabVIEW suite of examples. This is the first 
phase in developing a VI. Buttons, indicators, I/O, and dialogs are placed appropriately. 
These control components are selected from the Controls palette, which contains a list of 
prebuilt library or user-customized components.
A component is selected from the Controls palette by left-clicking the mouse on the 
particular control icon, and it can be placed on the front panel by left-clicking again. Then 
Desktop computer
laptop
PXI
LabVIEW
GPIB
Modular instrumentation
Data acquisition
Distributed I/O
Image acquisition
Motion control
Physical
test system
Sensors
FIGURE E.6
Modular solution of LabVIEW.
FIGURE E.7
Front panel of the alarm slide control example.

608
Appendix E
the component can be resized, reshaped, or moved to any desired position. A component 
property such as visibility, format, precision, labels, data range, or action can be changed 
by right-clicking, with the cursor placed anywhere on the selected component, to bring up 
the pop-up menu.
Block Diagrams
After designing the GUI in the front panel, the VI has to be programmed graphically 
through the block diagram window in order to implement the intended functionality of 
the VI. The block diagram window can be brought forward by clicking on the Window pull 
menu and selecting Show Diagram. For every control component created on the front panel, 
there is a corresponding terminal automatically created in the block diagram window. 
Figure E.8 shows the block diagram for the alarm slide control example provided with 
LabVIEW.
The terminal is labeled automatically according to the data type of each control. For 
example, the stop button has a terminal labeled TF, which is a Boolean type. The verti-
cal level indicator has a double-precision (DBL) type terminal, providing double-precision 
representation. Other common controls with a DBL terminal include various numeric 
indicators, sliders, and graphs.
LabVIEW uses the G programming language to implement the functionality of a VI. It 
provides an extensive library of basic conditional and looping structures, mathematical 
operators, Boolean operators, comparison operators, and more advanced analysis and con-
ditioning tools, provided through the Functions palette. A function may be placed on the 
block diagram window similar to how a control component is placed on the front panel. 
Depending on the required flow of execution, they are then wired together using the Connect 
Wire tool in the Tools palette. In order to wire two terminals together, first click the Connect 
Wire icon in the Tools palette, then move the cursor to the I/O hotspot of one terminal, left-
click to make the connection, and then move the cursor to the output/input hotspot of the 
other terminal and left-click again to complete the connection. The corresponding control 
component on the front panel can be selected by double-clicking on the terminal block.
FIGURE E.8
Block diagram panel of the alarm slide control example.

609
Appendix E
The general flow of execution is to first acquire the data, then analyze, followed by the 
presentation of results. The terminals and functional components are wired in such a way 
that data flows from the sources (e.g., data acquisition) to the sinks (e.g., presentation). 
LabVIEW executes its G programming code in data flow manner, executing an icon as data 
becomes available to it through connecting wires.
The dice terminal is a random number generator and its output is multiplied by a con-
stant using the multiplier operator (see Figure E.8). The multiplication result is connected to 
the input of the alarm slide, which will show up as the level in the vertical indicator on the 
front panel during VI execution. The gray box surrounding the terminals is the while loop 
in which all the flow within the gray box will run continuously until the loop is ­terminated 
by the stop button with the corresponding Boolean terminal. When the stop terminal is 
true, the while loop terminates upon reading a false through the not operator. The wait 
terminal (watch icon) controls the speed of the while loop. The wait terminal input is given 
in milliseconds. In the figure, the loop runs at an interval of 1 s since a constant of 1000 is 
wired to the wait terminal. In order to run the VI, left-click on the arrow icon on the top 
rows of icons or click Operate and then select Run. No compilation is required.
Note the Remove Broken Wire command found in the Edit pull-down menu. This com-
mand cleans up the block diagram of any unwanted or incomplete wiring. The Debugging 
pop-up window that appears when an erroneous VI is executed is very helpful in trouble-
shooting the VI. Double-clicking on the items in the errors list will automatically highlight 
the problematic areas or wires or terminals in the diagram.
Tools Palette
LabVIEW has three main floating palettes for creating VIs: the Tools palette, the Controls 
palette, and the Functions palette. The Tools palette, shown in Figure E.9, is the general 
editing palette with tools for editing components in the front panel and block diagram 
panel; modifying the position, shape, and size of components; labeling the wiring of ter-
minals in the block diagram panel; debugging; and coloring. When manipulating the front 
panel and the block diagram panel, note which tool icon is selected. For example, the values 
of a control or terminal cannot be selected or edited when the positioning icon is selected.
Controls Palette
Figure E.10 shows the Controls palette, which contains the prebuilt and user-defined con-
trols to create a GUI. This palette will be available when the front panel is selected. If it is 
Operate value 
Connect wire 
Set/clear breakpoint 
Probe data 
Set color 
Edit text 
Scroll window 
Object shortcut menu 
Get color 
Position/size/select 
FIGURE E.9
LabVIEW Tools palette.

610
Appendix E
not showing, click open the Window pull-down menu and select the Show Controls Palette 
option. The figure shows the main group of top-level components available in its prebuilt 
library. Clicking on the appropriate top-level icons will bring up the subpalettes of the 
available controls and indicators. To go back to the top-level icons, click on the up arrow 
icon on the top-left of the Controls palette.
Functions Palette
When the block diagram panel is selected, the Functions palette is shown as in Figure 
E.11, enabling you to program the VI. The Functions palette contains a complete library 
Previous level 
Numeric 
Array and cluster 
Select a control 
Ring and enum 
String and path 
Graph
List and table 
I/O
Boolean
Refnum 
Classic controls 
ActiveX
User controls 
Dailog controls 
Decorations
FIGURE E.10
LabVIEW Controls palette.
Previous level
Structure
String
Comparison
Boolean
Cluster
Array
Time and dialog
Numeric
File I/O
Waveform
Analyze
User libraries
Data acquisition
Instrument I/O
Communication
Tutorial
Select a VI
Motion and vision
Mathematics
Application control
Graphics and sound
Report generation
Advanced
FIGURE E.11
LabVIEW Functions palette.

611
Appendix E
of necessary operations for developing the functionality of the VI. Similar to the Controls 
palette, the top-level icons show the grouping of different subfunctions available for the 
programmer. Several commonly used groups are indicated as follows:
•	 Structures: The structures icon consists of the usual programming language 
sequences, conditional statements, and conditional loops. These structures are in 
the form of boxes where the terminals within the boxes are executed when the 
statements or loops are invoked. In addition, there is a formula node where cus-
tom text-based formulas can be included if you prefer the traditional text-based 
equations. There are also variable declaration nodes where local and global vari-
ables can be declared.
•	 Numeric: The elementary operators such as summation, subtraction, multiplica-
tion, division, and power are grouped under this icon.
•	 Boolean: This icon contains the Boolean operators required for logic manipulation.
•	 Array: The array grouping consists of tools for array manipulation.
•	 Comparison: Operators for numerical comparison, which provide Boolean out-
puts, are found under this icon.
•	 Analyze: This icons contains the more advanced analysis tools such as fast Fourier 
transform (FFT) spectrum, power spectrum, filters, triggering, and waveform 
generation.
•	 Mathematics: Under this icon, the tools for mathematical manipulation such as 
calculus, statistics and probability, linear algebra, optimization, and numeric 
functions are found.


613
Appendix F: Review of Linear Algebra
Linear algebra, the algebra of sets, vectors, and matrices, is useful in the study of control 
systems in general and the state-space approach in particular. In practical engineering 
systems, interactions among various components are inevitable. There are many response 
variables associated with many excitations. Then, it is convenient to consider all excita-
tions (inputs) simultaneously as a single variable and also all responses (outputs) as a 
single variable. Use of linear algebra makes the analysis of such a system convenient. The 
subject of linear algebra is complex and is based on a rigorous mathematical foundation. 
In this appendix, we will review the basics of vectors and matrices.
F.1  Vectors and Matrices
In the analysis of control systems, vectors and matrices will be useful in both time and 
frequency domains. First, consider the time domain formulation of a mechanical system. 
For a single-degree-of-freedom (single-DoF) system with a single forcing excitation f(t) and 
a corresponding single displacement response y, the dynamic equation would be
	


+
+
=
my
cy
ky
f t( )	
(F.1)
In this single-DoF case, the quantities f, y, m, c, and k are scalars. If the system has n degrees 
of freedom, with excitation forces f t f t
f t
( ),
( ),...,
( )
n
1
2
 and associated displacement responses 
…
y y
y
,
,
,
n
1
2
, the equations of motion can be expressed as
	


+
+
=
My
Cy
Ky
f t( )	
(F.2)
where
	

=














=
y
y
y
yn
1
2
 
displacement vector (nth-order column vector)
	

=














=
f
f
f
fn
1
2
 
forcing excitation vector (nth-order column vector)

614
Appendix F
	
…
…

…
=














=
M
m
m
m
m
m
m
m
m
m
n
n
n
n
nn
11
12
1
21
22
2
1
2
 
mass matrix (n × n square matrix)
	
…
…

…
=














=
C
c
c
c
c
c
c
c
c
c
n
n
n
n
nn
11
12
1
21
22
2
1
2
 
damping matrix (n × n square matrix)
	
…
…

…
=














=
K
k
k
k
k
k
k
k
k
k
n
n
n
n
nn
11
12
1
21
22
2
1
2
 
stiffness matrix (n × n square matrix)
In this manner, vectors and matrices are introduced into the formulation of a multi-degree-
of-freedom mechanical system. Further vector-matrix concepts will enter into the picture 
in subsequent analysis of the system, for example, in modal analysis.
Next, consider the frequency-domain formulation. In the single-input–single-output 
(SISO) case, the system equation may be given as
	
=
y
Gu	
(F.3)
where
u = frequency spectrum (Fourier spectrum) of the forcing excitation (input)
y = frequency spectrum (Fourier spectrum) of the response (output)
G = frequency transfer function (frequency response function) of the system
The quantities u, y, and G are scalars because each one is a single quantity and not a col-
lection of several quantities.
Next, consider a multi-input–multi-output (MIMO) system having two excitations u1 and 
u2, and two responses y1 and y2; each yi now depends on both u1 and u2. It follows that we 
need four transfer functions to represent all the excitation-response relationships that exist 
in this system. We use the four transfer functions (G
G
G
G
,
,
, and
11
12
21
22). For example, the 
transfer function G12 relates the excitation u2 to the response y1. The associated two equa-
tions that govern the system are
	
=
+
=
+
y
G u
G u
y
G u
G u
1
11
1
12
2
2
21
1
22
2	
(F.4)
Instead of considering the two excitations (two inputs) as two separate quantities, we can 
consider them as a single “vector” u having the two components u1 and u2. As before, we 
can write this as a column consisting of the two elements:

615
Appendix F
	
=








u
u
u
1
2
In this case, we have a “column vector.” Alternately, we can write a “row vector” as
	
= 

u
u u
,
1
2
But the column-vector representation is more common.
Similarly, we can express the two outputs y1 and y2 as a vector y. Consequently, we have 
the column vector:
	
=








y
y
y
1
2
or the row vector: 
= 

y
y
y
,
1
2
It should be kept in mind that the order in which the components (or elements) are given 
is important since the vector 

u u
,
1
2  is not equal to the vector 

u
u
,
2
1 . In other words, a 
vector is an “ordered” collection of quantities.
In summary, we can express a collection of quantities in an orderly manner as a single 
vector. Each quantity in the vector is known as a component or an element of the vector. 
What each component means will depend on the particular situation. For example, in a 
dynamic system it may represent a quantity such as voltage, current, force, velocity, pres-
sure, flow rate, temperature, or heat transfer rate. The number of components (elements) in 
a vector is called the order, or dimension of the vector.
Next, let us introduce the concept of a matrix using the frequency domain example given 
above. Note that we needed four transfer functions to relate the two excitations to the two 
responses. Instead of considering these four quantities separately, we can express them 
as a single matrix G having four elements. Specifically, the transfer function matrix for the 
present example is
	
=








G
G
G
G
G
11
12
21
22
This matrix has two rows and two columns. Hence, the size or order of the matrix is 2 × 2. 
Since the number of rows is equal to the number of columns in this example, we have a 
square matrix. If the number of rows is not equal to the number of columns, we have a rect-
angular matrix. Actually, we can interpret a matrix as a collection of vectors. Hence, in the 
previous example, the matrix G is an assembly of the two column vectors:
	
















G
G
G
G
and
11
21
12
22
or, alternatively, an assembly of the two row vectors: 

G
G
,
11
12  and 

G
G
,
21
22 .

616
Appendix F
F.2  Vector-Matrix Algebra
The advantage of representing the excitations and the responses of a control system as the 
vectors u and y, and the transfer functions as the matrix G is clear from the fact that the 
excitation-response (input-output) equations can be expressed as the single equation
	
=
y
Gu	
(F.5)
instead of the collection of scalar equations (F.4).
Hence, the response vector y is obtained by “premultiplying” the excitation vector u by the 
transfer function matrix G. Of course, certain rules of vector-matrix multiplication have to 
be agreed upon in order that this single equation is consistent with the two scalar equations 
given by Equation F.4. Also, we have to agree upon rules for the addition of vectors or matrices.
A vector is a special case of a matrix. Specifically, a third-order column vector is a matrix 
having three rows and one column. Hence, it is a 3 × 1 matrix. Similarly, a third-order row 
vector is a matrix having one row and three columns. Accordingly, it is a 1 × 3 matrix. It 
follows that we only need to know matrix algebra, and the vector algebra will follow from 
the results for matrices.
F.2.1  Matrix Addition and Subtraction
Only matrices of the same size can be added. The result (sum) will also be a matrix of the 
same size. In matrix addition, we add the corresponding elements (i.e., the elements at 
the same position) in the two matrices, and write the results at the corresponding places 
in the resulting matrix.
	
As an example, consider the 2 × 3 matrix: 
=
−
−








A
1
0
3
2
6
2
	
and a second matrix:
 
=
−
−








B
2
1
5
0
3
2
	
The sum of these two matrices is given by
 
+
=
−








A
B
1
1
2
2
3
0
The order in which the addition is done is immaterial. Hence,
	
+
=
+
A
B
B
A	
(F.6)
In other words, matrix addition is commutative.

617
Appendix F
Matrix subtraction is defined just like matrix addition, except the corresponding ele-
ments are subtracted. An example is
	
−
−










−
−
−










=
−
−










1
2
3
0
4
1
4
2
2
1
3
0
5
0
1
1
1
1
F.2.2 Null Matrix
The null matrix is a matrix whose elements are all zeros. Hence, when we add a null 
matrix to an arbitrary matrix the result is equal to the original matrix. We can define a null 
vector in a similar manner. We can write
	
+
=
A
A
0
	
(F.7)
As an example, the 2 × 2 null matrix is
	






0
0
0
0
F.2.3  Matrix Multiplication
Consider the product AB of the two matrices A and B. Let us write this as
	
=
C
AB	
(F.8)
We say that B is premultiplied by A or, equivalently, A is postmultiplied by B. For this multi-
plication to be possible, the number of columns in A has to be equal to the number of rows 
in B. Then, the number of rows of the product matrix C is equal to the number of rows in A, 
and the number of columns in C is equal to the number of columns in B.
The actual multiplication is done by multiplying the elements in a given row (say the ith 
row) of A by the corresponding elements in a given column (say the jth column) of B and 
summing these products. The result is the element cij of the product matrix C. Note that cij 
denotes the element that is common to the ith row and the jth column of matrix C. So, we have
	
∑
=
c
a b
ij
ik
kj
k
	
(F.9)
As an example, suppose
	
=
−
−






=
−
−
−










A
B
1
2
1
3
3
4
;
1
1
2
4
2
3
4
2
5
3
1
0
Note that the number of columns in A is equal to 3 and the number of rows in B is also 
equal to 3. Hence, we can perform the pre-multiplication of B by A. For example,

618
Appendix F
	
=
× +
×
+ −
×
=
c
1
1
2
2
( 1)
5
0
11
 
	
=
× −
+
×
+ −
× −
=
c
1
( 1)
2
3
( 1)
( 3)
8
12
	
=
×
+
× −
+ −
×
= −
c
1
2
2
( 4)
( 1)
1
7
13
	
=
×
+
×
+ −
×
=
c
1
4
2
2
( 1)
0
8
14
	
=
× + −
×
+
×
=
c
3
1
( 3)
2
4
5
17
21
	
=
× −
+ −
×
+
× −
= −
c
3
( 1)
( 3)
3
4
( 3)
24
22
and so on. The product matrix is
	
=
−
−






C
0
8
7
8
17
24
22
6
It should be noted that both products AB and BA are not always defined, and even when 
they are defined, the two results are not equal in general. Unless both A and B are square 
matrices of the same order, the two product matrices will not be of the same order.
Summarizing, matrix multiplication is not commutative:
	
≠
AB
BA	
(F.10)
F.2.4  Identity Matrix
An identity matrix (or unity matrix) is a square matrix whose diagonal elements are all 
equal to 1 and all the remaining elements are zeros. This matrix is denoted by I. For exam-
ple, the third-order identity matrix is
	
=










I
1
0
0
0
1
0
0
0
1
It is easy to see that when any matrix is multiplied by an identity matrix (provided, of 
course, that the multiplication is possible), the product is equal to the original matrix. Thus
	
=
=
AI
IA
A	
(F.11)
F.3  Matrix Inverse
An operation similar to scalar division can be defined in terms of the inverse of a matrix. A 
proper inverse is defined only for a square matrix and, even for a square matrix, an inverse 
might not exist. The inverse of a matrix is defined as follows:

619
Appendix F
Suppose that a square matrix A has the inverse B. Then these must satisfy the equation:
	
=
AB
I	
(F.12)
or equivalently
	
=
BA
I	
(F.13)
where I is the identity matrix, as defined before.
The inverse of A is denoted by 
−
A 1. The inverse exists for a matrix if and only if the deter-
minant of the matrix is nonzero. Such matrices are termed nonsingular. We shall discuss 
the determinant in a later subsection of this appendix. But, before explaining a method for 
determining the inverse of a matrix let us verify that
	






−
−






2
1
1
1
is the inverse of
1
1
1
2
To show this, we simply multiply the two matrices and show that the product is the 
­second-order unity matrix. Specifically,
	
−
−











= 





1
1
1
2
2
1
1
1
1
0
0
1
or
	






−
−





= 





2
1
1
1
1
1
1
2
1
0
0
1
F.3.1  Matrix Transpose
The transpose of a matrix is obtained by simply interchanging the rows and the columns 
of the matrix. The transpose of A is denoted by AT.
For example, the transpose of the 2 × 3 matrix:
	
=
−
−






A
1
2
3
2
2
0
is the 3 × 2 matrix:
	
=
−
−










A
1
2
2
2
3
0
T
Note: The first row of the original matrix has become the first column of the transposed 
matrix, and the second row of the original matrix has become the second column of the 
transposed matrix.

620
Appendix F
If 
=
A
A
T
, then we say that the matrix A is symmetric. Another useful result on the matrix 
transpose is expressed by
	
(
) =
AB
B A
T
T
T
	
(F.14)
If follows that the transpose of a matrix product is equal to the product of the transposed 
matrices, taken in the reverse order.
F.3.2  Trace of a Matrix
The trace of a square matrix is given by the sum of the diagonal elements. The trace of 
matrix A is denoted by tr(A).
	
∑
=
A
tr
a
( )
ii
i
	
(F.15)
For example, the trace of the matrix: 
	
=
−
−
−










A
2
3
0
4
4
1
1
0
3
is given by tr(A) = (−2) + (−4) + 3 = −3.
F.3.3  Determinant of a Matrix
The determinant is defined only for a square matrix. It is a scalar value computed from the 
elements of the matrix. The determinant of a matrix A is denoted by det(A) or A .
Instead of giving a complex mathematical formula for the determinant of a general matrix 
in terms of the elements of the matrix, we now explain a way to compute the determinant.
First, consider the 2 × 2 matrix: 
	
=








A
a
a
a
a
11
12
21
22
Its determinant is given by
	
( ) =
−
A
a a
a a
det
11 22
12
21
Next, consider the 3 × 3 matrix:
	
=










A
a
a
a
a
a
a
a
a
a
11
21
31
12
22
32
13
23
33

621
Appendix F
Its determinant can be expressed as 
( ) =
−
+
A
a M
a M
a M
det
11
11
12
12
13
13 where the minors of 
the associated matrix elements are defined as
	
=








=








=








M
a
a
a
a
M
a
a
a
a
M
a
a
a
a
det
; 
det
; 
det
11
22
23
32
33
12
21
22
31
32
13
21
22
31
32
Note that Mij is the determinant of the matrix obtained by deleting the ith row and the jth 
column of the original matrix. The quantity Mij is known as the minor of the element aij 
of the matrix A. If we attach a proper sign to the minor depending on the position of the 
corresponding matrix element, we have a quantity known as the cofactor. Specifically, the 
cofactor Cij corresponding to the minor Mij is given by
	
(
)
= −
+
C
M
1
ij
i
j
ij	
(F.16)
Hence, the determinant of the 3 × 3 matrix may be given by
	
( ) =
+
+
A
a C
a C
a C
det
11
11
12
12
13
13
In the two preceding formulas for computing the determinant of a 3 × 3 matrix, we have 
expanded along the first row of the matrix. We get the same answer, however, if we expand 
along any row or any column. Specifically, when expanded along the ith row, we have
	
( ) =
+
+
A
a C
a C
a C
det
i
i
i
i
i
i
1
1
2
2
3
3
Similarly, if we expand along the jth column, we have
	
( ) =
+
+
A
a C
a C
a C
det
j
j
j
j
j
j
1
1
2
2
3
3
These ideas of computing a determinant can be easily extended to 4 × 4 and higher order 
matrices in a straightforward manner. Hence, we can write
	
∑
∑
=
=
A
a C
a C
det( )
ij
ij
j
ij
ij
i
	
(F.17)
F.3.4  Adjoint of a Matrix
The adjoint of a matrix is the transpose of the matrix whose elements are the cofactors of 
the corresponding elements of the original matrix. The adjoint of matrix A is denoted by 
adj(A).
As an example, in the 3 × 3 case, we have

622
Appendix F
	
( ) =










=










A
C
C
C
C
C
C
C
C
C
C
C
C
C
C
C
C
C
C
adj
T
11
12
13
21
22
23
31
32
33
11
21
31
12
22
32
13
23
33
In particular, it is easily seen that the adjoint of the matrix
	
=
−










A
1
2
1
0
3
2
1
1
1
is given by
	
( ) =
−
−
−










A
adj
1
2
3
3
2
1
7
2
3
T
Accordingly, we have
	
( ) =
−
−
−










A
adj
1
3
7
2
2
2
3
1
3
Hence, in general,
BOX F.1  SUMMARY OF MATRIX PROPERTIES
Addition: 
+
=
×
×
×
A
B
C
m n
m n
m n
Multiplication: 
=
×
×
×
A
B
C
m n
n r
m r
Identity: 
=
=
⇒
AI
IA
A
I is the identity matrix
Note: 
=
/⇒
=
=
AB
A
B
0
0
0
or
 in general
Transposition: 
(
)
=
=
C
AB
B A
T
T
T
T
==
==
⇒
⇒
==
==
==
(
)
−
−
−
−
−
AP
I
PA
A
P
P
A
AB
B A
Inverse:
and
1
1
1
1
1
Commutativity: 
≠
AB
BA in general
Associativity: 
==
(
)
(
)
AB C
BC A
Distributivity: (
) =
C A
B
CA
CB
+
+
Distributivity: (
)
A
B D = AD
BD
+
+

623
Appendix F
	
( ) = 

A
C
adj
ij
T
	
(F.18)
F.3.5  Inverse of a Matrix
At this juncture, it is appropriate to give a formula for the inverse of a square matrix. 
Specifically,
	
( )
( )
=
−
A
A
A
adj
det
1
	
(F.19)
Hence, in the 3 × 3 matrix example given before, since we have already determined the 
adjoint, it remains only to compute the determinant in order to obtain the inverse. Now 
expanding along the first row of the matrix, the determinant is given by
	
( )
(
) (
)
=
× +
×
+ −
× −
=
A
det
1
1
2
2
1
3
8
Accordingly, the inverse is given by
	
=
−
−
−










−
A
1
8
1
3
7
2
2
2
3
1
3
1
For two square matrices A and B, we have
	
(
)
=
−
−
−
AB
B A
1
1
1
	
(F.20)
As a final note, if the determinant of a matrix is zero, the matrix does not have an inverse. 
Then we say that the matrix is singular. Some important matrix properties are summarized 
in Box F.1.
F.4  Vector Spaces
F.4.1  Field (F)
Consider a set of scalars.
If for any α and β from the set, α
β
+
 and αβ  are also elements in the set, and if
	
1.	α
β
β
α
+
=
+
 and αβ
βα
=
 (commutativity)
	
2.	 α
β
γ
α
β
γ
+
+
=
+
+
(
)
(
) and αβ γ
α βγ
=
(
)
(
) (associativity)
	
3.	α β
γ
αβ
αγ
+
=
+
(
)
 (distributivity)
are satisfied,

624
Appendix F
and if
	
1.	Identity elements 0 and 1 exist in the set such that α
α
+
=
0
 and α
α
=
1
	
2.	Inverse elements exist in the set such that α
α
+ −
=
(
)
0 and α α
⋅
=
−
1
1
then the set is a field (e.g., the set of real numbers).
F.4.2  Vector Space (L)
Properties:
	
1.	Vector addition ( +
x
y) and scalar multiplication (αx) are defined.
	
2.	Commutativity: +
=
+
x
y
y
x
	
	 Associativity: 
==
+
+
+
+
x
y
z
x
y
z
(
)
(
) are satisfied.
	
3.	Unique null vector 0 and negation (−x) exist such that +
=
x
x
0
	
(
)
+ −
=
x
x
0.
	
4.	Scalar multiplication satisfies
	
α β
αβ
(
)
=
x
x
(
)
(
)
associativity
	
α
α
β
α
β
α
β
(
)
+
=
+
+
=
+



x
y
x
y
x
x
x
(
)
(
)
distributivity
	
=
=
x
x
x
1
,0
0
Special case: Vector space Ln has vectors with n elements from the field F.
Consider
	
 
=
⋅
⋅
















x
x
x
xn
1
2
,
 
=
⋅
⋅
















y
y
y
yn
1
2
Then
	
α
α
α
+
=
+
⋅
⋅
⋅
+
















=
+
=
⋅
⋅
⋅
















x
x
x
y
x
y
x
y
y
x
x
and
n
n
n
1
1
1

625
Appendix F
F.4.3  Subspace S of L
	
1.	If x and y are in S, then x + y is also in S.
	
2.	If x is in S and α  is in F, then αx is also in S.
F.4.4  Linear Dependence
Consider the set of vectors: x x
x
,
,...,
n
1
2
.
They are linearly independent if any one of these vectors cannot be expressed as a linear 
combination of one or more remaining vectors.
Necessary and sufficient condition for linear independence:
The following equation
	
α
α
α
+
+
=
x
x
x
0
,...,
n
n
1
1
2
2
	
(F.21)
gives αα = 0 (trivial solution) as the only solution.
For example,
	
=










=
−










=










x
x
x
1
2
3
; 
2
1
1
; 
5
0
5
1
2
3
These vectors are not linearly independent because 
+
=
x
x
x
2
1
2
3.
F.4.5  Bases and Dimension of a Vector Space
	
1.	If a set of vectors can be combined to form any vector in L, then that set of vectors 
is said to span the vector space L (i.e., a generating system of vectors).
	
2.	If the spanning vectors are all linearly independent, then this set of vectors is a 
basis for that vector space.
	
3.	The number of vectors in the basis = dimension of the vector space.
Note: Dimension of a vector space is not necessarily the order of the vectors.
For example, consider two intersecting third-order vectors. The will form a basis for the 
plane (two dimensional) that contains the two vectors. Hence, the dimension of the vector 
space = 2, but the order of each vector in the basis = 3.
Note: Ln is spanned by n linearly independent vectors ⇒
=
L
n
dim(
)
n
.
For example,

626
Appendix F
	
…
⋅
⋅


















⋅
⋅


















⋅
⋅


















1
0
0
0
, 
0
1
0
0
, ,
0
0
0
1
F.4.6  Inner Product
	
=
x y
y x
( , )
H 	
(F.22)
where H denotes the hermitian transpose (i.e., complex conjugate and transpose). Hence, 
yH = (y*)T, where ( )* denotes complex conjugation.
Note:
	
(
)
≥
=
=
x x
x x
x
0
1.
( , )
0 and ( , )
0 if and only if iff
	
=
x y
y x
2.
( , )
( , )*
	
λ
λ
λ
λ
=
=
x y
x y
x
y
x y
3.
(
, )
( , )
( ,
)
( , )
*
	
+
=
+
x y
z
x y
x z
4.
( ,
)
( , )
( , )
F.4.7  Norm
Properties:
	
  
≥
x
0 and 
=
x
0 iff x = 0
	
λ
= λ
x
x  for any scalar λ
	
+
≤
+
x
y
x
y
Examples are as follows:
Euclidean norm:
	
∑
=
=






=
x
x x
x
H
i
i
n
2
1
1
2
	
(F.23)
Unit vector: 
=
x
1

627
Appendix F
Normalization: 
=
x
x
xˆ
	
θ =
=
x y
x y
x y
Angle between vectors: We have cos
( , )
(ˆ, ˆ)
	
(F.24)
where θ is the angle between x and y.
	
=
x y
Orthogonal vectors: iff ( , )
0	
(F.25)
Note: n orthogonal vectors in Ln are linearly independent, span Ln, and form a basis for Ln.
F.4.8  Gram–Schmidt Orthogonalization
Given a set of vectors x x
x
,
,...,
n
1
2
 that are linearly independent in Ln, we construct a set of 
orthonormal (orthogonal and normalized) vectors 
…
y y
y
ˆ
ˆ
ˆ n
1,
2 ,
,
, which are linear combina-
tions of xˆi:
Start 
=
=
y
x
x
x
ˆ
ˆ
1
1
1
1
.
Then 
Σ
=
−
=
−
y
x
x y y
(
, ˆ ) ˆ
i
i
j
i
i
j
j
1
1
 for =
i
n
1,2,..., .
Normalize yi to produce yˆ i.
F.4.9 Modified Gram–Schmidt Procedure
In each step, compute new vectors that are orthogonal to the just-computed vector.
	
=
y
x
x
ˆ 1
1
1  
as before
	
=
−
=
x
x
y x y
i
n
Then
( ˆ ,
) ˆ for
2,3,...,
i
i
i
(1)
1
1
	
=
=
…
y
x
x
i
n
ˆ
for
 2, 3,
,
i
i
i
(1)
(1)
and 
=
−
x
x
y
x
y
( ˆ ,
) ˆ
i
i
i
(2)
(1)
2
(1)
2, i = 3, 4,…, n and so on.
F.5  Determinants
Now, let us address several analytical issues of the determinant of a square matrix. 
Consider the matrix:

628
Appendix F
	
=
⋅
⋅
⋅
⋅
⋅
⋅
















A
a
a
a
a
n
n
nn
11
1
1
Minor of 
=
=
a
M
ij
ij
 determinant of matrix formed by deleting the ith row and the jth col-
umn of the original matrix.
Cofactor of aij = 
= −
+
C
M
( 1)
ij
i
j
ij
cof (A) = cofactor matrix of A
adj (A) = adjoint 
=
A
A
(cof )T
F.5.1  Properties of Determinant of a Matrix
	
1.	Interchange two rows (columns) ⇒ Determinant sign changes.
	
2.	Multiply one row (column) by α 
α
⇒
 det ().
	
3.	Add a [α × row (column)] to a second row (column) ⇒ determinant unchanged.
	
4.	Identical rows (columns) ⇒ zero determinant.
	
5.	For two square matrices A and B, det(AB) = det(A) det(B).
F.5.2  Rank of a Matrix
Rank A = number of linearly independent columns = number of linearly independent 
rows = dim (column space) = dim (row space)
Here, “dim” denotes the “dimension of.”
F.6  System of Linear Equations
Consider the set of linear algebraic equations:
	




+
+
+
=
+
+
+
=
+
+
+
=
a x
a x
a x
c
a x
a x
a x
c
a
x
a
x
a
x
c
n
n
n
n
m
m
mn
n
m
11
1
12
2
1
1
21
1
22
2
2
2
1
1
2
2
We need to solve for 
…
x x
x
,
,
,
n
1
2
.
This problem can be expressed in the vector-matrix form:
	
=
=
×
A
x
B
A c
c
[
, ]
m n
n
m

629
Appendix F
Solution exists iff rank [A, c] = rank [A].
Two cases can be considered:
Case 1: If 
≥
m
n and rank [A] = n ⇒ unique solution for x.
Case 2: If 
≤
m
n and rank [A] = m ⇒ infinite number of solutions for x
	
=
⇐
−
x
A
AA
C
(
)
H
H
1
 minimum norm form
Specifically, out of the infinite possibilities, this is the solution that minimizes the norm xHx.
Note: The superscript H denotes the “hermitian transpose,” which is the transpose of the 
complex conjugate of the matrix:
For example,
	
=
+
+
−
−−








A
j
j
j
j
1
2
3
6
3
5
1
2
Then
	
=
−
+
−
−+












A
j
j
j
j
1
3
2
3
5
6
1
2
H
If the matrix is real, its hermitian transpose is simply the ordinary transpose.
In general, if rank 
≤
⇒
A
n
 infinite number of solutions.
The space formed by solutions 
=
⇒
Ax
0
 is called the null space.
dim (null space) = n − k where rank [A] = k.
F.7  Quadratic Forms
Consider a vector x and a square matrix A. Then, the function Q(x) = (x, Ax) is called a 
quadratic form. For a real vector x and a real and symmetric matrix A,
	
( ) =
x
x Ax
Q
T
Positive definite matrix: If (x, Ax) > 0 for all x ≠ 0, then A is said to be a positive definite 
matrix. Also, the corresponding quadratic form is also said to be positive definite.
Positive semidefinite matrix: If (x, Ax) ≠ 0 for all x ≠ 0, then A is said to be a positive semi-
definite matrix. Note that in this case the quadratic form can assume a zero value for a 
nonzero x. Also, the corresponding quadratic form is also said to be positive semidefinite.
Negative definite matrix: If (x, Ax) < 0 for all x ≠ 0, then A is said to be a negative definite 
matrix. Also, the corresponding quadratic form is also said to be negative definite.
Negative semidefinite matrix: If (x, Ax) ≠ 0 for all x ≠ 0, then A is said to be a negative 
semidefinite matrix. Note that in this case the quadratic form can assume a zero value for a 
nonzero x. Also, the corresponding quadratic form is also said to be negative semidefinite.
Note: If A is positive definite, then −A is negative definite. If A is positive semidefinite, 
then −A is negative semidefinite.

630
Appendix F
Principal minors: Consider the matrix:
	

=
…
…
…














A
a
a
a
a
a
a
a
a
a
n
n
n
n
nn
11
12
1
21
22
2
1
2
Its principal minors are the determinants of the various matrices along the principal diag-
onal, as given by, and so on
	
∆
∆
∆
=








=










a
a
a
a
a
a
a
a
a
a
a
a
a
a
= 
,
det
,
det
1
11
2
11
12
21
22
3
11
12
13
21
22
23
31
32
33
, and so on
Sylvester’s theorem: A matrix is positive if definite if all its principal minors are positive.
F.8  Matrix Eigenvalue Problem
F.8.1  Characteristic Polynomial
Consider a square matrix A. The polynomial Δ(s) = det[sI − A] is called the characteristic 
polynomial of A.
F.8.2  Characteristic Equation
The polynomial equation Δ(s) = det[sI − A] = 0 is called the characteristic equation of the 
square matrix A.
F.8.3  Eigenvalues
The roots of the characteristic equation of a square matrix A are the eigenvalues of A. For 
an n × n matrix, there will be n eigenvalues.
F.8.4  Eigenvectors
The eigenvalue problem of a square matrix A is given by Av = λv, where the objective is 
to solve for λ and the corresponding nontrivial (i.e., nonzero) solutions for v. The problem 
can be expressed as
	
λ
=
I
A v
0
(
–
)
Note: If v is a solution of this equation, then any multiple av of it is also a solution. Hence, 
an eigenvector is arbitrary up to a multiplication factor.
For a nontrivial (i.e., nonzero) solution to be possible for v, one must have

631
Appendix F
	
λ −−
=
I
A
det[
]
0
Since this is the characteristic equation of A, as defined previously, it is clear that the roots 
of λ are the eigenvalues of A. The corresponding solutions for v are the eigenvectors of A. 
For an n × n matrix, there will be n eigenvalues and n corresponding eigenvectors.
F.9  Matrix Transformations
F.9.1  Similarity Transformation
Consider a square matrix A and a nonsingular (and square) matrix T. Then, the matrix 
obtained according to
	
=
−
B
T
AT
1
is the similarity transformation of A by T. The transformed matrix B has the same eigen-
values as the original matrix A. Also, A and B are said to be similar.
F.9.2  Orthogonal Transformation
Consider a square matrix A and another square matrix T. Then, the matrix obtained 
according to
	
=
B
T AT
T
is the orthogonal transformation of A by T.
If T−1 = T T then the matrix T is said to be an orthogonal matrix. In this case, the similarity 
transformation and the orthogonal transformation become identical.
F.10  Matrix Exponential
The matrix exponential is given by the infinite series
	

=
+
+
+
A
I
A
A
t
t
t
exp(
)
1
2!
2 2
	
(F.26)
exactly like the scalar exponential
	

λ
λ
λ
=
+
+
+
t
t
t
exp(
)
1
1
2!
2 2
	
(F.27)
The matrix exponential maybe determined by reducing the infinite series given in 
Equation F.26 into a finite matrix polynomial of order n − 1 (where A is n × n) by using the 
Cayley–Hamilton theorem.

632
Appendix F
Cayley–Hamilton Theorem: This theorem states that a matrix satisfies its own character-
istic equation. The characteristic polynomial of A can be expressed as
	

∆λ
λ
λ
λ
=
−
=
+
+
+
−
−
A
I
a
a
a
( )
det(
)
n
n
n
n
1
1
0	
(F.28)
in which det( ) denotes determinant. The notation
	

∆
=
+
+
+
−
−
A
A
A
I
a
a
a
( )
n
n
n
n
1
1
0 	
(F.29)
is used. Then, by the Cayley–Hamilton theorem, we have
	

=
+
+
+
−
−
A
A
I
a
a
a
0
n
n
n
n
1
1
0 	
(F.30)
F.10.1  Computation of Matrix Exponential
Using Cayley–Hamilton theorem, we can obtain a finite polynomial expansion for exp(At). 
First, we express Equations F.26 and F.27 as
	

∆
α
α
α
(
) =
+
+
+
+
−
−
−
−
A
A
A
A
A
I
t
S
exp
( ) ( ) 
 
 
n
n
n
n
1
1
2
2
0 	
(F.31)
	

λ
λ
∆λ
α
λ
α
λ
α
=
⋅
+
+
+
+
−
−
−
−
t
S
exp(
)
( )
( )
n
n
n
n
1
1
2
2
0	
(F.32)
where S(.) is an appropriate infinite series, which is the result of dividing the exponential 
(infinite) series by the characteristic polynomial Δ(.).
Next, since Δ(A) = 0 by the Cayley–Hamiltion theorem, Equation F.31 becomes
	

α
α
α
(
) =
+
+
+
−
−
−
−
A
A
A
I
t
exp
n
n
n
n
1
1
2
2
0 	
(F.33)
Now, it is just a matter of determining the coefficients 
…
α α
α −
,
,
,
n
0
1
1, which are functions 
of time. This is done as follows: If 
…
λ λ
λ
,
,
,
n
1
2
 are the eigenvalues of A, however, then, by 
definition
	
∆λ
λ
=
−
=
=
A
I
i
n
(
)
det(
)
0 for 
1,2,...,
i
i
	
(F.34)
Thus, from Equation F.32, we obtain
	

λ
α
λ
α
λ
α
=
+
+
+
=
−
−
−
−
t
i
n
exp(
)
for
1,2,...,
i
n
i
n
n
i
n
1
1
2
2
0
	
(F.35)
If the eigenvalues are all distinct, Equation F.35 represents a set of n independent algebraic 
equations from which the n unknowns 
…
α α
α −
,
,
,
n
0
1
1 could be determined. If some eigen-
values are repeated, the derivatives with respect to λi of the corresponding Equation F.35 
have to be used as well.

633
Appendix G: Advanced Response Analysis
G.1  Introduction
This appendix presents some advanced topics of response analysis and complements 
Chapter 9. The time response of a system describes how the system responds as a function 
of time. The frequency response describes how the system responds as a function of fre-
quency. There are many reasons why response analysis is important. The performance of 
a system depends on the response of the system, both free response and forced response. 
Hence response analysis is applicable in many situations including computer simulation, 
design, control, and performance evaluation of a system. For example, since the objective 
of control is to make a system behave in a desired manner, it is important to analyze how 
the system variables, the output variables in particular, vary with time. Both free response 
and forced response are important.
G.2  Scalar Problem
Consider the first-order system:
	
 =
+
x
a t x
b t u t
( )
( ) ( )	
(G.1)
where x is the state (or response) and u is the input.
Note the time-varying parameters a and b.
G.2.1  Homogeneous Case (Input u = 0)
	

( )
=
⇒
=
x
a t x
dx x
a t dt
( )
/
Integrate:
	
∫
τ
=
⇒
=
∫
τ
τ
x t
x t
a
x t
x t e
ln
( )
( )
( )
( )
( )
t
t
a
d
0
0
( )
t
t
0
0
	
(G.2)
	
=
=
−
a
x t
x t e
If
constant ( )
( ) a t t
0
(
)
0 	
(G.3)

634
Appendix G
Note: The initial condition x(t0) must be specified for unique solution. Also, x(t) depends on 
the time difference (t − t0), not the absolute time, when a is constant.
G.2.2  Nonhomogeneous (Forced) Case
Multiply Equation G.1 by k(t):
	
−
=
k t x
k t a t x
k t b t u t
( )
( ) ( )
( ) ( ) ( )
.
	
(i)
Pick k(t) such that
	
= −
k t
k t a t
( )
( ) ( )
.
	
(ii)
(to make the left-hand side an exact differential). Then, the system equation G.1 has a 
solution:
	
=
∫
τ
τ
−
k t
k t e
( )
( )
a
d
0
( )
t
t
0
	
(iii)
Hence, Equation i can be written as
	
=
d
dt kx
kb t u t
[
]
( ) ( )	
(iv)
Integrate:
	
∫
τ
τ
τ
τ
=
+
k t x t
k t x t
k
b
u
d
( ) ( )
( ) ( )
( ) ( ) ( )
t
t
0
0
0
We obtain
	
∫
∫
τ
τ
τ
τ
τ
τ
τ
=
+
=
∫
+
∫
τ
τ
τ
τ
−
x t
k t
k t x t
k
k t b
u
d
x t e
e
b
u
d
( )
( )
( )
( )
( )
( ) ( ) ( )
( )
( ) ( )
t
t
a
d
a
d
t
t
0
0
0
( )
( )
t
t
t
t
0
0
0
0
Final result:
	
∫
τ
τ
τ
=
∫
+
∫
τ
τ
τ
τ
−
x t
x t e
e
b
u
d
( )
( )
( ) ( )
a
d
a
d
t
t
0
( )
( )
t
t
t
t
0
0
0
	
(G.4)

635
Appendix G
For constant a,
	
∫
τ
τ
τ
=
+
τ
−
−
x t
e
x t
e
b
u
d
( )
( )
( ) ( )
a t t
a t
t
t
(
)
0
(
)
0
0
	
(G.5)
Note: In general (see Chapter 9),
zero-input response ≠ homogeneous solution (complementary solution)
zero-state (zero initial-condition) response ≠ particular solution
(because the input affects the unknown coefficients in the homogeneous solution).
Example G.1
Let particular solution = zero-state response + 
−
e
.
a t t
(
)
0
This satisfies the system differential Equation G.1, with constant a. Then, homoge-
neous (complementary) solution = 
−
−
e
x t
[ ( )
1].
a t t
(
)
0
0
G.3  Time Response of a State Space Model
The foregoing concepts of time response may be extended to the multivariable case of a 
state space model.
G.3.1  Case of Constant System Matrix
Assume that A is a constant matrix.
	
 =
x
Ax
Homogeneouscase :
	
(G.6)
	
=
−
x
x
t
e
t
This satisfies : ( )
( )
A t t
(
)
0
0
	
(G.7)
Nonhomogeneous (forced) case:
	
 =
+
x
Ax
Bu t( )	
(G.8)
	
= −
K
K
K
A
t
t
t
Let
( ) satisfy
( )
( )
.
	
(i)
	
=
−
−
K t
e
For example,
( )
A t t
(
)
0 	
(ii)
Multiply Equation G.8 throughout by K(t). Then, as for the scalar case,

636
Appendix G
	

=
K
x
K
B
u
d
dt
t
t
t
t
( )
( ) ( ) ( )	
(iii)
Integrate Equation iii:
	
∫
τ
τ
τ
=
+
−
−
x
K
K
x
K
K
u
t
t
t
t
t
d
( )
( ) ( ) ( )
( ) ( ) ( )
t
t
1
0
0
1
0
	
(iv)
With Equation ii:
	
∫
τ
τ
τ
=
+
τ
−
−
x
x
B
u
t
e
t
e
d
( )
( )
( ) ( )
A
A
t t
t
t
t
(
)
0
(
)
0
0
	
(G.9)
G.3.2  Matrix Exponential
Note that the matrix exponential (which is called the state-transition matrix, because 
it changes the state vector over time) is needed for the response analysis of a constant-
parameter state space model. This matrix is given by
	

=
+
+
+
A
A
e
I
t
t
1
2!
At
2 2
	
(G.10)
Some properties:
	

=
−
+
+
−
A
A
e
I
t
t
1
2!
At
2 2
	

=
+
+

=
A
A
A
d
dt e
I
t
e
A
A
t
t
	
=
−
I
e e
A
A
t
t
Hence,
	


=
−
−
e
e
A
A
t
t
1
Methods of Computing e At
Method 1 (Laplace transform method):
According to Equation G.7:  =
⇒
=
x
Ax
x
x
t
e
( )
(0)
At
Take Laplace transform (see Appendix D):

637
Appendix G
	
−
=
⇒
=
−
−
−
X
x
AX
x
I
A
x
s
s
s
t
L
s
( )
(0)
( )
( )
(
)
(0)
1
1
Hence,
	
=
−
−
−
I
A
e
L
s(
)
At
1
1	
(G.11)
Method 2 (modal transformation method):
Determine the eigenvectors (see Appendix F) of A, and assemble them into the modal matrix 
M. Form the matrix J through the similarity transformation:
	
=
−
J
M
AM
1
	
(G.12)
At least in the case when A has distinct eigenvalues, it is known that J (the Jordan matrix) is 
diagonal, with eigenvalues as its diagonal elements. Then
	
=












λ
λ
λ
e
e
e
e
0
0
0
0
.
0
0
0
Jt
t
t
t
n
1
2
	
(G.13)
It is known that
	
=
−
e
M
M
e
At
Jt
1	
(G.14)
Method 3 (matrix element evaluation):
Consider the series expression of each matrix element in
	

=
+
+
+
I
A
A
e
t
t
1
2
At
2 2
Then, see whether a closed-form expression can be written for each matrix element. 
Alternatively, for small t (e.g., for digital simulation over small time steps), truncate the 
series expression.
Method 4 (use Cayley–Hamilton theorem):
See Appendix F. Determine coefficients 
…
α α
α −
,
,
,
n
0
1
1 by solving
	

α
α λ
α
λ
=
+
+
+
λ
−
−
e
t
n
n
0
1
1
1
1
1
1
	

α
α λ
α
λ
=
+
+
+
λ
−
−
e
t
n
n
n
n
0
1
1
1
n
where λi are the eigenvalues of A. Then (see Appendix F)

638
Appendix G
	

α
α
α
=
+
+
+
−
−
I
A
A
eAt
n
n
0
1
1
1	
(G.15)
Example G.2
Consider the system matrix:
	
=
−






A
0
1
0
2
We will determine the matrix exponential of this matrix by each of the four methods 
that were outlined before.
Method 1:
	
−
=
−
+






I
A
s
s
s
1
0
2
	
−
=
+
+












−
I
A
s
s
s s
s
(
)
1
1
(
2)
0
1
2
1
Take inverse Laplace of each term, using Laplace transform tables (see Table D.1). We get
	
L
(
)
=
+
+












=
−










−
−
−
e
s
s s
s
e
e
1
1
(
2)
0
1
2
1
1
2 1
0
At
t
t
1
2
2
Method 2:
Determine eigenvalues of A: λ = 0,
1
 λ = −2
2
.
Determine eigenvectors by solving: 
λ
ξ
−


=
A
I
0.
We get
	
λ
ξ = 





For
:
1
0
1
1
	
λ
ξ











= 




⇒
=
−






x
x
For
:
2
1
0
0
0
0
1
2
2
2
Then, form the modal matrix M and determine its inverse:

639
Appendix G
	
=
−






=
−












−
M
M
1
1
0
2
,
1
1
2
0
1
2
1
Form the exponential of the Jordan matrix J:
	
=








−
e
e
e
0
0
Jt
t
0
2
Finally, use Equation G.13 to determine the matrix exponential:
	
(
)
=
−












−












=
−










−
−
−
e
e
e
e
1
1
0
2
1
0
0
1
1
2
0
1
2
1
1
2 1
0
At
t
t
t
2
2
2
Method 3:
Write the series expansion: 
	




(
)
=
+
+
+
= 




+
−





+
−





+
=
−
−
+
−
+




−
+
−
−
+














=
−










−
−
I
A
A
e
t
t
t
t
t
t
t
t
t
t
t
e
e
2
1
0
0
1
0
1
0
2
2!
0
1
0
2
1
1
2
1
2 1
2
(2 )
2!
(2 )
3!
0
1
2
(2 )
2!
(2 )
2!
(2 )
3!
1
1
2 1
0
At
t
t
2
2
2
2
2
3
2
3
3
2
2
Method 4:
Form the two coefficient equations using the eigenvalues

640
Appendix G
	
α
α λ
α
α λ
λ
λ
+
=
+
=




=
= −
λ
λ
e
e
for
0
2
t
t
0
1
1
0
1
2
1
2
1
2
and solve for the coefficients:
	
α
α
(
)
⇒
=
=
−
−e
1,
1
2 1
t
0
1
2
Then,
	
α
α
(
)
(
)
=
+
=
+
−
=
−










−
−
−
I
A
I
A
e
e
e
e
1
2 1
1
1
2 1
0
At
t
t
t
0
1
2
2
2
Example G.3
Find the response to initial state x(0) of the system 
	
 =
−






x
x
0
1
0
2
Here, we use the result Equation G.7 and the matrix exponential determined in the 
previous example. We have
	
=
=
−










=
+
−










−
−
−
−
x
x
x
t
e
e
e
x
x
e
x
e
x
( )
(0)
1
1
2 (1
)
0
(0)
(0)
1
2
(0)
1
2
(0)
(0)
At
t
t
t
t
2
2
1
2
2
2
2
2
Example G.4
For the circuit shown in Figure G.1a, the input voltage e t( )
i
 is given in Figure G.1b. 
The output is voltage e0.
	
(i)	 Using current through inductor 2 H and voltage across the capacitor 1
2 F as the 
state variables, obtain a complete state model (including output equation) for 
the system.
	 (ii)	 Determine the value of the state vector at =
+
t
0 .
	 (iii)	 Find the eigenvalues and the corresponding eigenvectors of the system.

641
Appendix G
	 (iv)	 Using Part (iii), obtain an expression for the state-transition matrix eAt.
	 (v)	 Obtain the response (output) y(t) for the given input.
Solution
See Figure G.2.
The state space shell:
	
=
di
dt
v
2
L
	
=
de
dt
i
1
2
c
Loop 1 (compatibility equation): 
−
−
−
=
e
i
v
e
2
0
i
L
c
Node A (continuity equation): 
−−
=
i
i
e
2
0
L
c
2
4
ei
t
ei(t)
e0
F
2
1
iL
2Ω
+
–
2Ω
2H
ec
+
+
–
–
(a)
(b)
FIGURE G.1
(a) An electrical circuit; (b) input to the circuit.
ei(t)
e0
F
2
1
iL
2Ω
+
–
2Ω
2H
v
+
–
ec
+
+
–
–
1
2
A
i
FIGURE G.2
Writing equations for the electrical circuit.

642
Appendix G
Eliminate the auxiliary variables v and i:
	
=
−
−
di
dt
e
i
e
2
2
c
i
L
c
	
=
−
de
dt
i
e
1
2
2
c
L
c
Hence, the state equations are
	
= −
−
+
di
dt
i
e
e
1
2
1
2
L
L
c
i
	
=
−
de
dt
i
e
2
c
L
c
The output equation: 
=
e
ec
0
	
(i)	
=
−
−
−










=










= 

=
A
B
C
D
0
1
1
2
2
1
1
2
0
0
1
	 (ii)	 Note: State variables cannot undergo step changes. Hence,
	
=
=
+
−
+
−
e
e
i
i
(0 )
(0 )
(0 )
(0 )
c
c
L
L
	
(
)
=
=
=
−
t
di
dt
de
dt
At
0 :
0
steady state
L
c
	
=
e
4
i
	
	 Hence,
	
= −
−
+
×
−
−
i
e
0
(0 )
1
2
(0 )
1
2
4
L
c
	
=
−
−
−
i
e
0
2 (0 )
(0 )
L
c
	
	 Solve: 
=
=
−
−
i
e
(0 )
1,
(0 )
2
L
c
	
	 Hence,
	
= 





+
x(0 )
1
2

643
Appendix G
	 (iii)	 Find eigenvalues by solving the characteristic equation:
	
λ
λ
λ
λ(
)
−
=
+
−
+
=
+
+
=
I
A
1
1
2
2
1
1
1
0
2
Hence,
	
λ +
= ±j
1
or
	
λ
λ
= −+
= −−
j
j
1
1
1
2
Determine the corresponding eigenvectors:
	
ξξ
−










+
+








= 




⇒
−
+
+
=
−
−
+
−
=
j
j
a
jb
p
jq
ja
b
p
j q
a
jb
jp
q
:
1
2
2
0
0
1
2
2
0
2
2
0
1
Hence,
	
+
=
−
+
=
a
q
b
p
2
0,
1
2
0
	
⇒
= −
=
q
a p
b
2 ,
2
	
ξξ =
+
−








=
=
a
jb
a
ja
a
b
2
2
Pick
1,
0
1
	
ξξ =
−








j
1
2
1
Hence,
	
ξξ =








j
1
2
2
	 (iv)	 We will use Method 2 to determine the matrix exponential.

644
Appendix G
	Form the modal matrix
	
=
−








M
j
j
1
1
2
2
Note: 
=
+
=
≠
M
j
j
j
2
2
4
0 (nonsingular matrix).
Form the matrix inverse: 
	
=
−








=
−












−
M
j
j
j
j
j
1
4
2
1
2
1
1
2
4
1
2
4
1
	
=








−+
−−
e
e
e
0
0
Jt
j t
j t
( 1
)
( 1
)
By Method 2 of determining matrix exponential, we have
	
(
)
(
)
(
)
(
)
=
=
−
















−












=
−








−












=
+
−
−
−
+












=
−










−
−
−
−
−
−
−
−
−
−
−
−
M
M
e
e
e
j
j
e
e
j
j
e
e
e
je
je
j
j
e
e
e
j e
e
j e
e
e
e
e
t
t
t
t
1
1
2
2
0
0
1
2
4
1
2
4
2
2
1
2
4
1
2
4
1
2
4
1
2
cos
1
2 sin
2sin
cos
A
J
t
t
t
jt
jt
t
jt
jt
jt
jt
t
jt
jt
jt
jt
jt
jt
jt
jt
t
1
(v)	
∫
∫
∫
τ
τ
τ
τ
τ
τ
τ
τ
τ
τ
=
+
=
−















+
−
−
−
−
−




















×
=
−
+








+
−
−








τ
τ
τ
−
−
−
−
−
−
−
x
x
Bu
t
e
e
d
e
t
t
t
t
e
t
t
t
t
d
e
t
t
t
t
e
t
t
d
( )
(0)
( )
cos
1
2 sin
2sin
cos
1
2
cos(
)
1
2 sin(
)
2sin(
)
cos(
)
1
2
0
2
cos
sin
2(cos
sin )
cos(
)
2sin(
)
A
A
t
t
t
t
t
t
t
t
t
(
)
0
(
)
0
(
)
0

645
Appendix G
Now, direct integration gives
	
∫
τ
τ
−
=
−
−
τ
−
−
−
e
t
d
e
t
t
cos(
)
1
2
2 (cos
sin )
t
t
t
(
)
0
	
∫
τ
τ
−
=
−
+
τ
−
−
−
e
t
d
e
t
t
sin(
)
1
2
2 (cos
sin )
t
t
t
(
)
0
Hence,
	
=
−
−
+
+
−
−












+












=
−
+












+












−
−
x t
e
t
t
t
t
t
t
t
t
e
t
t
t
t
( )
cos
sin
1
2 cos
1
2 sin
2cos
2sin
1
2 cos
1
2 sin
1
2
1
2
1
2 cos
1
2 sin
3
2 cos
3
2 sin
1
2
1
2
t
t
Note that the initial conditions are satisfied: 
	
= 





x(0)
1
2
G.4  Time Response by Laplace Transform
Time variation of the state vector of a linear, constant-parameter dynamic system (Equation 
G.8) can be obtained using the Laplace transform method (see Appendix F and Chapter 9). 
This idea was already used for the unforced case (u = 0), in the context of determining 
the matrix exponential. Now, let us address the general (forced) case more formally. The 
Laplace transform of the forced state space equation:
	
 =
+
x
Ax
Bu t( ) 	
(G.8)
is given by
	
( )
( )
( )
−
=
+
X
x
AX
BU
s
s
s
s
(0)
	
(G.16)
Consequently,
	
( )
( )
=
−
+
−
−
−
−
−
x
I
A
x
I
A
BU
t
L
s
L
s
s
(
)
(0)
(
)
1
1
1
1
	
(G.17)

646
Appendix G
where I denotes the identity (unit) matrix. Note that −L 1 denotes the inverse Laplace trans-
form operator. The square matrix 
−
−
I
A
s(
) 1 is known as the resolvent matrix. Its inverse 
Laplace transform is the state-transition matrix, as clear from Equation G.9 and already seen 
in Equation G.11. Specifically,
	
Φ( ) =
−
−
−
I
A
t
L
s(
)
1
1 	
(G.18)
We have already seen that Φ(t) is equal to the matrix exponential:
	
…
ΦΦ
=
=
+
+
+
A
I
A
A
t
t
t
t
( )
exp(
)
1
2!
2 2
	
(G.19)
It follows from Equation G.18 that the state-transition matrix may be analytically deter-
mined as a closed-form matrix function by the direct use of inverse Laplace transforma-
tion on each term of the resolvent matrix. Since the product in the Laplace domain is a 
convolution integral in the time domain and vice versa (see Appendix D), the second term 
on the right-hand side of Equation G.17 can be expressed as a matrix convolution integral. 
Hence, Equation G.17 can be expressed as
	
∫
ΦΦ
ΦΦ
τ
τ
τ
( )
( )
=
+
−
x
x
Bu
t
t
t
d
( )
0
(
)
( )
t
0
	
(G.20)
The first part of this solution is the zero-input response, and the second part is the zero-state 
response.
G.5  Output Response
State variables are not necessarily measurable and generally are not system outputs. 
Linearized relationship between state variables and system output (response) variables 
y(t) can be expressed as
	
( )
( )
=
y
Cx
t
t 	
(G.21)
in which the output vector is
	

=
y
y y
y
[
,
,
,
]
p
T
1
2
	
(G.22)
and C denotes the output (measurement) gain matrix. Hence, once x is known, y can be 
determined by using Equation G.21.

647
Appendix G
G.5.1  Transfer-Function Matrix
Suppose that the number of inputs m > 1 and the number of outputs p > 1. By substituting 
the Laplace-transformed Equation G.21 into Equation G.16, with zero initial conditions 
(x(0) = 0), we get the input-output relation
	
( )
( ) ( )
=
Y
H
U
s
s
s 	
(G.23)
where the transfer-function matrix H(s) of the system is given by
	
( )
(
)
=
−
−
H
C
I
A
B
s
s
1
	
(G.24)
G.6  Modal Response
A dynamic system has a set of natural, unforced responses that represent the preferred 
dynamics of the system. Such a preferred motion is called a “modal response” or a “mode 
of motion.” Analytically, a mode of a linear, time-invariant system is represented by an 
eigenvalue and the corresponding eigenvector. In particular, with regard to a state space 
model, in a given mode of response the state vector will remain proportional to the cor-
responding eigenvector, and the time variation of the associated response will be given by 
the time exponential function of the corresponding eigenvalue.
Since modal response corresponds to free (unforced) response of the system, we con-
sider the corresponding state space model:
	
 =
x
Ax 	
(G.6)
Eigenvectors of A: nontrivial solutions ξ of
	
ξξ
ξξ
λ
λ
ξ
(
)
=
−
=
A
A
I
0
or
	
(G.25)
For a nontrivial (i.e., nonzero) solution to be possible, the matrix 
λ
(
)
−
A
I  should be singu-
lar (i.e., it should not have a finite inverse; otherwise ξ = 0). Hence, we must have
	
λ
−
=
A
I
0	
(G.26)
which is the characteristic equation of the system, whose roots are the eigenvalues (poles) 
of the system: 
…
λ λ
λ
,
,
,
n
1
2
.
Note: If ξ is a solution of Equation G.25, then any multiple aξ of it is also a solution. Hence, 
an eigenvector is arbitrary up to a multiplication factor.
Assume that A is a normal matrix, that is,
	
=
AA
A A
H
H
	
(G.27)

648
Appendix G
…
ξ ξ
ξ
⇒
,
,
,
n
1
2
 will be linearly independent eigenvectors and will form a basis for the state 
space Σ (see Appendix F).
Consider the forced state space model
	
 =
+
x
Ax
B
u
t
t
( ) ( )	
(G.28)
where B may be time variant.
Note: ∈∑
x
 and 
∈∑
B
u
t
t
( ) ( )
.
Hence, the state vector can be expressed as a linear combination of the eigenvectors:
	

ξξ
ξξ
=
+
+
x
q
q
t
t
t
( )
( )
( )
n
n
1
1
	
(G.29)
Also,
	

ξξ
ξξ
β
β
=
+
+
B t u t
t
t
( ) ( )
( )
( )
n
n
1
1
	
(G.30)
Substitute Equations G.29 and G.30 into Equation G.28.
	



ξξ
ξξ
λ
β
λ
β
(
)
(
)
⇒
−
−
+
+
−
−
=
q
q
q
q
0
n
n n
n
n
1
1 1
1
1
Hence,
	

∵
λ
β
ξ
−
−
=


q
q
i
0
are linearly independent
for all
i
i i
i
i
	
(G.31)
Form the modal matrix:
	
…
ξξ ξξ
ξξ
= 

M
,
,
n
1,
2
	
(G.32)
Equation G.29 can be written as
	
=
x
Mq 	
(G.33)
This is a transformation between the state vector x and the modal coordinate vector q.
Substitute Equation G.33 into Equation G.28:
	
 =
+
−
−
q
M
AMq
M Bu
1
1
	
(G.34)
The Jordan matrix
	
λ λ
λ
λ
=
=
…
−
J
M
AM
diag (
,
,
,
,
)
n
1
1
2
3
	
(G.35)
is a diagonal matrix of eigenvalues, in view of Equation G.25. Hence, Equation G.34 repre-
sents a set of uncoupled first-order differential equations (see Equation G.31), which can be 
integrated to obtain the modal responses qi.

649
Appendix G
G.6.1  State Response through Modal Response
Step 1: Integrate the uncoupled Equations G.34 to determine the responses qi:
	
∫
β τ
τ
=
+
λ
λ
τ
−
−
q t
e
q t
e
d
( )
( )
( )
i
t t
i
t
i
t
t
(
)
0
(
)
i
i
0
0
	
(G.36)
Step 2: Transform the resulting response vector q back to x using Equation G.33.
Note: This is a method to compute e At.
	
=
−
Me M
e
J
At
t
1	
(G.37)
	
( ) =
=
=
−
x
e
x
Me M x
Me q
t
(0)
(0)
(0)
A
J
J
t
t
t
1
	
(G.38)
G.6.2  Advantages of Modal Decomposition
The advantages of modal decomposition are as follows:
	
1.	Easier to determine the response
	
2.	Gives better insight about system and its response (e.g., stability, controability, 
observability)
	
3.	Useful in system modeling (e.g., model reduction) and design (e.g., pole placement)
Example G.5
Consider the mechanical system shown in Figure G.3. This may be interpreted as a 
model of a motor and a rotor (of moments of inertia I1 and I2, respectively, which are 
connected through a fluid coupling (of damping constant b1).
The equations of motion are
	
ω
ω
ω
= −
−
I
b (
)
1
1
1
1
2 	
(i)
	
ω
ω
ω
=
−
I
b (
)
2
2
1
1
2 	
(ii)
which form a second-order state space model.
Let 
=
=
=
I
I
b
1,
1
1
2
1
.
I1
I2
b1
ω1
ω2
FIGURE G.3
A rotor driven by a motor through fluid coupling.

650
Appendix G
	
=
−
−






The system matrix
1
1
1
1
A
	
(iii)
By straightforward mathematics, the eigenvalues of A are
	
λ
λ
=
= −
0,
2
1
2
and the corresponding eigenvectors are
	
ξ
ξ
= 





=
−






1
1
,
1
1
1
2
Hence, the state response for free motion (input = 0) can be expressed as
	
ω
ω








=





+
−






=





+
−





=





+
−






λ
λ
−
q t
q t
p e
p e
p
p e
( )
1
1
( )
1
1
1
1
1
1
1
1
1
1
t
t
t
1
2
1
2
1
2
1
2
2
1
2
	
(iv)
The constants p1 and p2 are determined by the initial conditions ω1(0) and ω2(0), 
using (iv). The state space of the system (which is a plane for this second-order problem) 
is shown in Figure G.4. The two eigenvectors are indicated as two lines, the first one 
having a slope of 1 and the other having a slope of −1. We observe the following:
	
1.	 If the initial state vector falls on one of the eigenvectors, the subsequent 
response will remain on the same eigenvector.
	
2.	 If the ICs are such that p2 = 0, then the second mode will not enter into the 
response. The response will remain on the line with slope 1, which corre-
sponds to the first mode. (In fact, the system will be stationary in this case, 
because mode 1 has a zero eigenvalue.)
	
3.	 If the ICs are such that p1 = 0, then mode 1 will not enter the response. Then, the 
response will remain on the line of slope −1, which corresponds to mode 2.
	
4.	 Since the second mode has a negative eigenvalue, the corresponding modal 
response will eventually decay to zero. Hence, the response for any arbitrary 
initial condition will eventually end up on the first eigenvector (line of slope 1).
ω2
ω1
ξ1
ξ2
FIGURE G.4
State space and the eigenvectors of the example system.

651
Appendix G
Example G.6
A torsional dynamic model of a pipeline segment is shown in Figure G.5a. Free-body 
diagrams in Figure G.5b show internal torques acting at sectioned inertia junctions for 
free motion.
The state vector is chosen as
	
ΩΩ
= 

x
T T
,
,
,
T
1
2
1
2
	
(i)
The corresponding system matrix may be determined as (see Chapter 3)
	
=
−
−




−
+




−




















A
I
I
I
k
k
I
k
k
k
k
k
0
0
1
1
0
0
1
1
1
0
0
0
0
0
1
1
2
3
1
2
3
2
1
2
2
	
(ii)
The displacements are used as outputs:
	
=
+




y
T
k
T
k
T
k
,
T
1
1
1
1
2
2
	
(iii)
This output vector corresponds to the output-gain matrix:
	
=














C
k
k
k
0
0
1
0
0
0
1
1
1
1
2
	
(iv)
For the special case given by 
=
=
I
I
I
1
2
 and 
=
=
k
k
k
1
3
, the system eigenvalues are
(a)
I1
I2
k1
k2
Ω1
Ω2
k3
T1
T1
T2
T2
T2
T3
T3
T1
T2
T2
T3
(b)
FIGURE G.5
(a) Dynamic model of a pipeline segment; (b) free-body diagrams.

652
Appendix G
	
λ λ
ω
= ±
= ±
j
j
k
I
,
1
1
1
	
λ
λ
ω
= ±
= ±
+
j
j
k
k
I
,
2
2
2
2
2
	
(v)
The magnitudes of these are in fact the two natural frequencies of oscillation of the sys-
tem. The corresponding eigenvectors are
	
∓
α
ω ω
=
±
=


X
X
R
Ij
jk
,
2
,
,
,0
T
1
1
1
1
1
1
1
1
	
∓
α
ω
ω
=
±
=
−
±


X
j
jk
jk
,
2
,
,
, 2
T
2
2
2
2
2
2
2
1
2
X
R
I
	
(vi)
where α1 and α2 are arbitrary constants, because eigenvectors are arbitrary up to a mul-
tiplication factor.
Note that the first two elements of the state vector correspond to the angular veloci-
ties of the two inertia elements. In a modal motion of a particular natural frequency, the 
amplitude of velocity will be proportional to the amplitude of displacement. The modal 
contributions to the displacement vector (or velocity vector) are given by the first two 
elements of the eigenvectors:
	
α
ω
= 





Y
t
1
1
sin
1
1
1
and
	
α
ω
=
−






Y
t
1
1
sin
2
2
2 	
(x)
1st Mode
2nd Mode
Node
FIGURE G.6
Mode shapes of the pipeline segment.

653
Appendix G
The mode shapes of motion are given by the amplitude vectors 
= 

1,1
T
1
S
 and 
=
−


1, 1
T
2
S
, which are sketched in Figure G.6. In general, each modal contribution 
introduces two unknown parameters, α
φ
 
 
i
i and
, into the free response (homogeneous 
solution), where ϕi are the phase angles associated with the sinusoidal terms. For an 
n-degree-of-­freedom (i.e., order-2n) system, this results in 2n unknowns, the determina-
tion of which requires the 2n initial conditions x(0).
G.7  Time-Varying Systems
In this case, the system matrix is time dependent and is given by A t( ).
G.7.1  Homogeneous (Free) System
	
 =
x
A
x
t( )
	
(G.39)
Let x1 be the response to initial state [1, 0,…,0]T, and so on.
Form the matrix:
	
…
(
)
= 

U
x x
x
t( )
,
,
,
fundamental solution matrix
n
1
2
	
(G.40)
Then, for any arbitrary initial state x t( )
0 , it is clear that the state response is
	
=
x
U
x
t
t
t
( )
( ) ( )
0
	
(G.41)
G.7.2  Nonhomogeneous (Forced) System
	
 =
+
x
A
x
B
u
t
t
( )
( )
	
(G.42)
Differentiate Equation G.41 and substitute in Equation G.39:
	


=
=
=
x
U
x
A
x
A
U
x
t
t
t
t
t
t
t
t
( )
( ) ( )
( ) ( )
( )
( ) ( )
0
0
Hence,
	

=
U
A
U
t
t
t
( )
( )
( ) 	
(G.43)
The fundamental solution matrix U(t) is nonsingular, in general. Hence,
	
=
−
U
U
I
t
t
( )
( )
n
1
	
(G.44)

654
Appendix G
Differentiating Equation G.44 and using Equation G.43, we can show that
	
= −
−
−
U
U
A
d
dt
t( )
1
1
	
(G.45)
We now use Equation G.45 to get a perfect differential form for Equation G.42: 
 −
=
x
A
x
B
u
t
t
( )
( )
Premultiply Equation G.42 by 
−
U 1. This gives
	

=
−
−
U x
U B
u
d
dt
t
t
( )
( )
1
1
Integrate:
	
∫
τ
τ
τ
τ
=
+
−
−
U x
U
x
U
B
u
t
t
t
d
( )
( ) ( )
( ) ( ) ( )
t
t
1
1
0
0
0
Premultiply by U(t):
	
∫
τ
τ
τ
τ
=
+
−
−
x
U
U
x
U
U
B
u
t
t
t
t
t
d
( )
( )
( ) ( )
( )
( ) ( ) ( )
t
t
1
0
0
1
0
	
(G.46)
Note: According to Equation G.41, U(t0) = I (the identity matrix), but is not substituted in 
Equation G.46 for the sake of mathematical clarity.
Define state-transition matrix:
	
Φ
τ
τ
=
−
U
U
t
t
( , )
( )
( )
1
	
(G.47)
Then, Equation G.46 can be written as
	
∫
Φ
Φ
τ
τ
τ
τ
=
+
x
x
B
u
t
t t
t
t
d
( )
( , ) ( )
( , ) ( ) ( )
t
t
0
0
0
	
(G.48)
From Equation G.48, for the homogeneous case (u = 0), we have
	
Φ
=
x
x
t
t t
t
( )
( , ) ( )
0
0 	
(G.49)
This is identical to Equation G.41, because U(t0) = I.

655
Appendix G
Properties of the State-Transition Matrix
	
1.	ΦΦ τ τ = I
( , )
n for any τ
	
2.	
Φ
τ
Φ
τ
= A
d
dt
t
t
t
( , )
( ) ( , )
	
3.	Φ
τ
Φ
τ
=
−
t
t
( , )
( , )
1
	
4.	Φ
Φ
Φ
=
t t
t t
t t
( , )
( , ) ( , )
2
0
2
1
1
0
Note: For constant A, we have
	
Φ
τ =
τ
−
t
e
( , )
A t(
)


657
Index
Note: Page numbers followed by “f” indicate figures; those followed by “t” indicate tables.
A
Across-variables, 18, 26, 63, 75, 76, 146, 201, 
202–204, 207, 209, 212, 220, 263
Active electronic components
biasing, 515–517
depletion region, 515
diodes, 514
PIN diodes, 519
pn junctions, 514
Schottky barrier diodes, 519
semiconductors, 514–515
thyristors, 519–520
tunnel diodes, 518
VVC diodes, 518
zener diodes, 517–518
Adjoint of matrix, 621–623
Algebraic equations, 31, 34, 289
Aliasing distortion due to signal sampling, 
68–69, 69f
Aliasing error, 69
Amplifiers, 235, 236
A-type, 235, 236, 236f
linear graph representation, 235–236
operational (op-amps), 235
T-type, 235, 236, 236f
Analogies, 25, 74
domain, 54–55
lumped elements and, 26
Analytical linearization using local slopes, 127
about an operating point, 128
equilibrium state, 128
nonlinear functions
of one variable, 128–130
of two variables, 130–131
Analytical modeling, 3, 4, 13, 17, 63
advantages of, 12–13
comparison of different types of, 65t
development, 74
steps of, 15–16, 75–76
discrete-time systems, 66–70
aliasing distortion due to signal 
sampling, 68, 69f
antialiasing filter, 69–70
difference equations, 68
discrete transfer function, 68
sampling theorem, 68–69
Z-transform, 68
distributed system, lumped model of, 70
heavy spring, 70–72
kinetic energy equivalence, 72
natural frequency equivalence, 73–74
fluid domain, modeling in, 89–100
A-type pneumatic element, 94
commutativity of series resistor and 
inertor elements, 90
D-type pneumatic element, 95–100
parallel connection of fluid capacitors, 93
pneumatic systems, 94
pressure head in a vertical pipe, 92–93
thin fluid layer approximation, 93–94
T-type pneumatic element, 94–95
input–output models, 76
from state-space models, 80–83
linear state equations, 78
time-invariant systems, 80
linear systems, properties of, 66, 67f
superposition, principle of, 66
mechanical domain, modeling in, 84–89
constitutive equations, 89
loop equations, 87
node equations, 88–89
state equations, 89
state models, properties of, 77–78
state space, 77
systematic development of a state model, 
83–84
thermal domain, modeling in, 100–106
types of, 64
frequency domain model, 65
time domain model, 64
transfer function model, 64–65
Angle between vectors, 627
Angstrom, 531
Antialiasing filter, 69–70
Antiferromagnetic materials, 510
Applications of modeling, 3–6
Approximate equivalence, 16–17, 346, 393, 420
Approximate models, 8, 16, 346
Arbitrary causality, 545

658
Index
Argand plot, 301–303
Asymptotes, Bode diagram using, 304–308, 309f
Asymptotic stability, 433
A-type amplifier, 235, 236, 236f
A-type element, 18, 26, 27, 31, 35, 45, 126, 146, 
220, 249, 263
A-type pneumatic element, 94
A-type source, 205–206
A-type transfer functions, 308, 312–313
Autonomous systems, see Time-invariant 
systems
Avalanche breakdown, 516
B
Back-electromotive force, 237
Ball screw, 488–490, 488f
Biasing, 515–517
BIBO stability, see Bounded-input bounded-
output (BIBO) stability
Biot number, 50
Bipolar junction transistor (BJT), 520–521, 527
BJT, see Bipolar junction transistor (BJT)
Block diagrams, 394, 395f, 466, 467, see also 
Simulation block diagrams
manipulation, 397
and reduction, 397–399, 398t
state-space models and, 395–396, 396f
transfer functions and, 394–395
Bode diagram, 300–302
of dc motor transfer function, 307f
using asymptotes, 304–308
Bode plot, 301, 304, 305f, 306, 309f
Bond graphs
of electrical systems, 551–552
energy storage and dissipation elements, 542
fluid and thermal systems, 553–554
introduction, 539–540
linear graphs and, 539–540
multiport elements, 543–545
single-port elements, 540–541
source elements, 541–542
state models from, 545–551
Bounded-input bounded-output (BIBO) 
stability, 450–451
Braking torque, 164
Breakdown voltage, 516, 521
Break frequency, 306–307
C
Calibration curve method, 172–173
Capacitance, 31
due to gas compressibility, 37–39
due to liquid compressibility, 36–37
equivalent, 94, 248
Capacitor, 31, 32, 32f, 34f, 126
element, 31–33
fluid, 35, 36, 36f
thermal, 45–46, 45f
types, 505–506
Capacitor-type energy storage elements, 18, 26
Causality and physical realizability, 420, 421
Causal relationship, 7
Cause-effect relationship, 7
Cavity resonator, 532
Cayley–Hamilton theorem, 632
CCD, see Charge-coupled device (CCD)
Characteristic equation, 292, 417, 429, 438, 630
of oscillator, 293
Characteristic polynomial, 292, 295, 310, 316, 
318, 405, 407, 408, 429, 454, 456, 630
Charge-coupled device (CCD), 537
Charge injection device (CID), 537, 537f
Charge sensitivity, 507
CID, see Charge injection device (CID)
Circuit equivalence, justification of, 352–353
Circuit partitioning, 348
Circuit reduction and equivalent circuits, 347
extension into other domains, 353
justification of circuit equivalence, 352–353
Thevenin’s theorem for electrical circuits, 
347
circuit partitioning, 348
Thevenin and Norton equivalent circuits, 
348–352
CMOS, see Complementary symmetry MOSFET 
(CMOS)
Coefficient blocks, 399
Coil spring, 70
Color code
for ceramic and paper capacitors, 506t
for fixed capacitors, 506
for fixed resistors, 502–503
Common-emitter connection, for transistors, 
522
Common-force junction, 543–544, 544t, 544f
Common-velocity junction, 544t, 544–545, 544f
Commutating circuit, 519
Commutativity
of increment and derivative, 130
of series resistor and inertor elements, 
90–91, 92f
Compatibility (loop) equations, 16, 75, 97, 99, 
212, 263
“primary” loops, number of, 213–215

659
Index
sign conventions, 212
Complementary symmetry MOSFET 
(CMOS), 527
Complex frequency domain, 287
Computer-based studies, 4
Computer software tools, see Software tools
Conductance and resistance, 497
Conduction, 46–49
three-dimensional conduction, 48–49
Conflicts in causality, 545
Constant matrix, 635
Constitutive equations, 31, 34, 36, 89
fluid capacitor, 36
flexible container, effect of, 39–42
gas compressibility, capacitance due to, 
37–39
gravity head of a fluid column, 42
liquid compressibility, capacitance due 
to, 36–37
fluid inertor, 42–44
laminar flow, 44
fluid resistor, 44
laminar flow, 44
turbulent flow, 44
Continuity (node) equations, 75, 97, 215, 263, 555
primary node equations, 215–217
sign convention, 215
Control system, 4
defined, 7
Convection, 49
Biot number, 50
Conveyor, 11
Convolution integral, 431–433, 447
Corner frequency, 306
Covalent electron, 514
Critically damped response, 441
Current-controlled transistor, 522
Current gain, 522
Current source, 31
D
Damped oscillator, 308, 309f, 451
forced response of, 443
harmonic excitation, response to, 447–453
impulse response, 444–445
step response, 446–447
zero ICs, riddle of, 445–446
free response of, 436–443, 443f
impulse-response function of, 445f
unit step response of, 447f
Damping (dissipation) element, 30–31
dc motor, 164, 236–242
armature-controlled, 187f
torque-speed operating curves of, 164f
Dead zone, 124
Dependent energy storage elements, 559–560
Dependent Source element, 235
Depletion region, 515
Depletion-type MOSFET (D-MOSFET), 524, 525, 
527
Derivative causality, 542
Describing function method, 176–178
Determinants of a matrix, 620–621, 627–628
Dielectric material and capacitor element, 
503–508
capacitor types, 505–506
color code for fixed capacitors, 506
permittivity, 504–505
piezoelectricity, 506–508
Difference equations, 68, 289
Diffusion capacitance, 521
Diodes, 514
parameter values for, 521t
Dirac delta function, 431, 472
Discrete switching (two-state) elements, 528f
Discrete-time systems, 66–70, 106
aliasing distortion due to signal sampling, 
68, 69f
antialiasing filter, 69–70
difference equations, 68
discrete transfer function, 68
sampling theorem, 68–69
Z-transform, 68
Discrete transfer function, 68
Dissipation element, 30–31
Distributed-parameter model, 48, 50, 64, 70
Distributed system, lumped model of, 70
heavy spring, 70
potential energy equivalence, 71–72
kinetic energy equivalence, 72
natural frequency equivalence, 73–74
Domain analogies, 54
natural oscillations, 55
Domain models, 2
frequency, see Frequency-domain models
time, 64, 106
Doping, 515
Double-diffused MOSFET (D-MOS), 527
D-type element, 18, 26, 27, 30, 31, 34, 35, 45, 55, 
77, 126
D-type pneumatic element, 95–100
Dual-gate MOSFET (DG-MOS), 527
Duty ratio, 529
Dynamic isolation components, 485
Dynamic modeling, 4, 17, 18

660
Index
Dynamic nonlinearity, 122
Dynamic system, 1, 7, 8
examples of, 8, 8t
nomenclature of, 8f
E
Ebers-Moll model, 526
Edge emitters, 530
Eigenvalues, 74, 407, 438, 630
Eigenvectors, 630–631
Elastic potential energy, 30, 70, 71
Electrical charge, 126
Electrical domain, linear-graph examples 
in, 233
amplifiers, 235
linear graph representation, 235–236
dc motor, 236–242
power-information transformer, 236
Electrical elements, 31, 32f
capacitor element, 31–33
inductor element, 33
nonlinear, 126
capacitor, 126
inductor, 126–127
resistor, 127
resistor (dissipation) element, 34
Electrical impedance and admittance, 
interconnection laws for, 312
Electrical transformer, 208f, 209
Electrolytic capacitors, 505
Electromagnetic energy, 33, 56, 203
of an inductor, 513
Electromagnetic spectrum, 529
Electromagnetic waves, 529
Electron barrier, 519
Electronic components, 13
Electrostatic energy, 32, 203
of a capacitor, 504
Energy dissipation, 9, 18, 26, 27, 30, 34, 71, 
124–125, 438, 542
Energy storage elements, 18, 26, 27, 31, 45, 76, 
220, 542
Enhancement-type MOSFET (E-MOSFET), 524, 
527
Equilibrium state, 128, 128f, 132
Equivalence, 393
approximate, 16–17, 346, 393, 420
circuit equivalence, justification of, 
352–353
eigenvalue, 74
kinetic energy, 72
natural frequency, 73
Norton equivalence, 356, 365, 366, 381, 384, 
388
potential energy, 71–72
Thevenin equivalence, 19, 356, 365, 381, 388
Equivalent capacitance, 94, 248
Equivalent impedance, 348
determination of, 350–351
Equivalent mechanical circuit analysis using 
LGs, 356–364
Equivalent model approach of linearization, 
173–176
Equivalent transfer-function (TF) linear graphs, 
353
equivalent mechanical circuit analysis using 
LGs, 356–364
Thevenin approach for mechanical circuits, 
364–365
transfer-function linear graphs, 353–356
Euler’s method, 465
Experimental linear model
for motor control, 165–166
of nonlinear system, 166–171
Experimental modeling, 11, 163, 435
F
Factored transfer-function method, 406–410
Fasteners, 485
Feedback linearization technique (FLT), 
178–180
Ferromagnetic materials, 510
FET, see Field effect transistors (FET)
Field (F), 623–624
Field effect transistors (FET), 523, 527
junction FET (JFET), 524–527
metal oxide semiconductor FET (MOSFET), 
524, 525
First-order dynamic systems, 434–436
FIS Editor, 603, 604
Flexibility element, 28f, 29–30
Flexible container, 36, 39–42
FLT, see Feedback linearization technique (FLT)
Fluid capacitor, 35, 36
A-type element, 35
capacitance due to gas compressibility, 37–39
capacitance due to liquid compressibility 
(bulk modulus), 36–37
effect of flexible container, 39–42
gravity head of a fluid column, 42
parallel connection of, 93
Fluid column, gravity head of, 42
Fluid domain
linear-graph examples in, 242–249

661
Index
modeling in, 89–100
A-type pneumatic element (fluid 
capacitor), 94
D-type pneumatic element (fluid resistor), 
95–100
fluid capacitors, parallel connection 
of, 93
pneumatic systems, 94
series resistor and inertor elements, 
commutativity of, 90
thin fluid layer approximation, 93–94
T-type pneumatic element (fluid inertor), 
94–95
vertical pipe, pressure head in, 92–93
Fluid “inductor,” 42
T-type element, 35, 94
Fluid inertor, 42–44
laminar flow, 44
modeling in, 89
T-type element, 35, 94
Fluid resistor, 44
D-type element, 35, 95
laminar flow, 44
turbulent flow, 44
Fold catastrophe, see Jump phenomenon
Force–current analogy, 54, 55, 308, 354, 356
“Forced” oscillations, 45
Force isolation and motion isolation, 
326–332
Force source, 541–542
Force transmissibility, 287, 316, 319, 320f
Forward biasing, 515–517, 521
Forward resistance, 521
Fourier analysis, 286
Fourier equation, 46, 48
Fourier series, 176
expansion, 298
Fourier transform, 285, 286, 287, 290–291, 298, 
299, 584–586
inverse, 290
one-sided, 290
Free electrons, 514–515
Free response, 430, 433
of damped oscillator, 438–443, 443f
of undamped oscillator, 436–438, 437f
Frequency creation, 125–126, 176, 180
Frequency-domain models, 2, 16, 65, 106, 285, 
286, 287
Bode diagram, 301
using asymptotes, 304–308
Fourier transform, 290–291
frequency transfer function, 298
magnitude (gain) and phase, 299–300
observations, 300
response to a harmonic input, 298–299
interconnection laws, 311
A-type transfer functions, 312–313
for electrical impedance and admittance, 
312
for mechanical impedance and mobility, 
312
T-type transfer functions, 312–313
Laplace transform, 287
of a derivative, 288–289
of an integral, 289
Nyquist diagram, 301–303
transfer function, 286–287, 291
of basic elements, 313–319
in mechanical systems, 308–311
transfer-function matrix, 293–298
transmissibility function, 319
force transmissibility, 319
Maxwell’s reciprocity property, 332–337
motion transmissibility, 319–326
vibration isolation, 326–332
Frequency response function (FRF)/frequency 
transfer function (FTF), 17, 65, 106, 285, 
286, 298, 299, 300, 307, 308, 311, 313, 
584–586
Functional models, 2
Fuzzy Logic Toolbox, of MATLAB®
command line-driven FIS design, 604–605
graphical editors, 603–604
practical stand-alone implementation in 
C, 605
G
GaAs, see Gallium arsenide MOSFET (GaAs)
Gadolinium gallium garnet, 512
Gallium arsenide MOSFET (GaAs), 527
Gas compressibility, capacitance due to, 
37–39
Gas lasers, 531, 533
Gauge-pressure transducers, 11
Gearbox, 486
Geometric nonlinearity, 123
Gram–Schmidt orthogonalization, 627
Graphical editors, 603–604
Graphical techniques, 11
Graph tree, of linear graphs (LGs), 555–557
Gravity head of a fluid column, 42
Gyrator, 209
-coupled systems, 367–368, 367f
hydraulic-mechanical, 210f, 211
mechanical, 209–211, 210f

662
Index
H
Hall-effect sensors, 511, 511f
Hard-disk drive (HDD) unit, of computer, 
9, 9f
Harmonic drives, 491–496
alternative design of, 495f
principle of operation of, 492f
torque and speed transmission of, 495f
Harmonic excitation, 286, 447–453
Harmonic-excited undamped simple oscillator, 
451
Heat source, 249
Heavy spring, 70, 71f
lumped-parameter approximation for an 
oscillator with, 72f
mechanical system with, 108f
potential energy equivalence, 71–72
He-Ne laser, 532, 532f
Hermitian transpose, 626
Holding current, 520
Holes, 514–515
Hooke’s law, 29, 123, 136, 414
Household heating system, 101f
Humanoid robot, 13, 14f
Hydraulic manipulator, 11
Hydraulic-mechanical gyrator, 210f, 211
Hydrofluoric acid, 522–523
Hysteresis loop, 124–125
of magnetic material, 509–510
I
Ideal relay, 124, 177f
Identity matrix, 618
Impulse response function, 431, 444–445, 445f
Independent energy storage elements, 26–27, 31
Inductance, 513
Inductor, 31, 32f, 34f, 35, 126–127
Inductor element, 33–34
Inductor-type energy storage elements, 18, 26
Inertia element, 27–29
Inertia force, 43, 205
Infrared LEDs (IRED), 530
Infrared radiation, 534
Infrared rays, 529, 530
Inner product, 626
Innovative elevated guideway transit system, 
9, 10f
Input elements, 26, 27
Input–output (I–O) model, 7, 11, 12, 16, 76, 394
from state-space models, 80–83
Inputs, defined, 7
Instrumentation, 11
Insulated gate FET (IGFET), see Metal oxide 
semiconductor FET (MOSFET)
Integral causality, 542
Integrated approach, 3, 6, 25
Integrator blocks, 399, 408
Intelligent iron butcher, 12f
Interconnection laws, 311
A-type transfer functions, 312–313
for electrical impedance and admittance, 
312, 313t
for mechanical impedance and mobility, 312, 
313t
T-type transfer functions, 312–313
Intrinsic layer, 519
Inverse Fourier transform, 290
Inverse of a matrix, 623
IRED, see Infrared LEDs (IRED)
Iron butcher, multidomain model of, 12f, 477
J
JFET, see Junction field effect transistors (JFET)
Jordan canonical form, 411
Jordan matrix, 637
Jump phenomenon, 123f, 125
Junction current, 521
Junction field effect transistors (JFET), 
524–527
n-channel JFET, 526f
K
Kinetic energy, 28, 29, 70
Kinetic energy equivalence, 71, 72
Kirchhoff’s current law, 75
Kirchhoff’s voltage law, 75
L
LabVIEW (Laboratory Virtual Engineering 
Workbench)
key concepts, 606
modular solution of, 607f
working with, 606–611
Laminar flow, 43, 44
Laplace-domain model, 286, 287, 289
Laplace transfer function, 16, 65, 285, 286, 298, 
300
Laplace transform, 16, 64, 285, 287–288, 290, 291, 
444, 447, 454, 571–577
common functions, 572–575
of constant, 572

663
Index
of derivative, 288–289, 574–575
of exponential, 572–573
important relations, 577t
of integral, 289
pairs, 576t
of sine and cosine, 573–574
table of, 575–577
time response by, 645–646
used in response analysis of dynamic 
systems, 577–582
Laplace variable, 16, 64, 106, 287, 289
Lasers, 531–532
types, 533t
Lasing process, 532
Latching current, 520
LCDs, see Liquid crystal displays (LCDs)
Lead screw and nut units, 488–491, 488f
Leakage current, 516, 521
LEDs, see Light-emitting diodes (LEDs)
LGs, see Linear graphs (LGs)
Light emitters and displays, 529–534
lasers, 531–533
light-emitting diodes (LEDs), 530–531
liquid crystal displays (LCDs), 533–534
plasma displays, 534
Light-emitting diodes (LEDs), 530–531
physical construction and circuit symbol, 
530f
wavelength characteristics, 531t
Lighting, 529
Light sensors, 534–538
charge-coupled device (CCD), 537, 537f
circuit symbols, 535f
optically coupled devices, applications of, 
537–538, 538f
photocells, 536–537
photodiode, 535–536
photo-FET, 536
photoresistor, 535
phototransistor, 536
Like-derivatives method, grouping, 404–406
Limit cycles, 125
Linear algebra, review of
determinants, 627–628
matrix eigenvalue problem
characteristic equation, 630
characteristic polynomial, 630
eigenvalues, 630
eigenvectors, 630–631
matrix exponential, 631–632
matrix inverse, 618–623
adjoint of matrix, 621–623
determinant of a matrix, 620–621
inverse of a matrix, 623
matrix transpose, 619–620
trace of a matrix, 620
matrix transformations, 631
quadratic forms, 629–630
system of linear equations, 628–629
vector-matrix algebra
identity matrix, 618
matrix addition and subtraction, 616–617
matrix multiplication, 617–618
null matrix, 617
vectors and matrices, 613–615
vector spaces
bases and dimension of, 625–626
field (F), 623–624
Gram–Schmidt orthogonalization, 627
inner product, 626
linear dependence, 625
modified Gram–Schmidt procedure, 627
norm, 626–627
subspace S of L, 625
vector space (L), properties, 624
Linear dependence, 625
Linear equations, system of, 628–629
Linear graphs (LGs), 18, 199, 200, 370f
and bond graphs, 539–540
compatibility (loop) equations, 212
number of “primary” loops, 213–215
sign conventions, 212
conflict identification in, 557–559
continuity (node) equations, 215
primary node equations, 215–217
sign convention, 215
in electrical domain, 233
amplifiers, 235–236
dc motor, 236–242
power-information transformer, 236
equivalent mechanical circuit analysis 
using, 356–364
in fluid domain, 242–249
graph tree of, 555–557
in mechanical domain, 224–233
in mixed domains, 254–262
normal tree of, 560–565
series and parallel connections, 217–218
sign convention for, 201f
single-port elements, 204
mechanical elements, 204–205
source elements, 205
A-type source, 205–206
interaction inhibition by source elements, 
206–207
T-type source, 205

664
Index
Linear graphs (LGs) (cont.)
state models from, 218
characteristics, 222–224
sign conventions, 221
sketching of a linear graph, 219
steps of obtaining a state model, 221
system order, 220
in thermal domain, 249
model equations, 249–254
topological result for, 223f
transfer-function, 353–356
two-port elements, 207
gyrator, 209–211
transformer, 207–209, 208f
variables and sign conventions, 200
through-variables and across-variables, 
201–203
Linearization, 121
analytical linearization, 127
about an operating point, 128
nonlinear functions of one variable, 
128–130
nonlinear functions of two variables, 
130–131
calibration curve method, 172–173
describing function method, 176–178
equivalent model approach of linearization, 
173–176
experimental linear model
for motor control, 165–166
of nonlinear system, 166–171
feedback linearization, 178–180
nonlinear characteristics of practical 
devices, 123
dead zone, 124
frequency creation, 125–126
hysteresis, 124
hysteresis loop and energy dissipation, 
124–125
ideal relay, 124
jump phenomenon, 125
limit cycles, 125
saturation, 123–124
nonlinear electrical elements, 126
capacitor, 126
inductor, 126–127
resistor, 127
nonlinear state-space models, 131
linearization of state models, 132–133
mitigation of system nonlinearities, 
133–163
static nonlinearity, 122
torque-speed curves of motors, 163–165
Linearized radiation resistor, 53–54
Linearizing feedback control system, 179, 179f
Linear local model, 127
Linear state equations, 78
time-invariant systems, 80
Linear systems, properties of, 66, 67f
superposition, principle of, 66
Link, 556–557
Liquid compressibility, capacitance due to, 
36–37
Liquid crystal displays (LCDs), 533–534, 533f
Liquid lasers, 531, 533
Load bearing/structural components, 485
Logarithm, 287, 302
Loop equations, 16, 21, 75, 76, 84, 87, 212, 214
Lumped elements and analogies, 26
Lumped model of distributed system, 70
heavy spring, 70
potential energy equivalence, 71–72
kinetic energy equivalence, 72
natural frequency equivalence, 73–74
Lumped-parameter approximation, 71, 72f
Lumped-parameter model, 9, 50, 64, 70, 71, 73, 
73f, 393, 482f
M
Magnetic bubble memories, 512
Magnetic circuit, 512, 512f
Magnetic materials, 510
Magnetism and permeability, 508–509
Marginally stable system, 433
Mass-spring-damper system, 213f, 308, 436
Mathematical definitions, 7, 12
Mathematical model, 7, 11
MATLAB, xvi, 589–594
arithmetic operations, 590t
arrays, 590–592
computations, 589–592
control systems toolbox and, 594–603
Fuzzy Logic Toolbox, 603–605
linear algebra, 593
mathematical functions, 591t
matrix functions, 594t
matrix operations, 594t
M-files, 593–594
relational and logical operations, 592
SISO Design Tool, 597–598
Matrices, vectors and, 613–615
Matrix addition and subtraction, 616–617
Matrix eigenvalue problem
characteristic equation, 630
characteristic polynomial, 630

665
Index
eigenvalues, 630
eigenvectors, 630–631
Matrix exponential, 631–632
computation of, 632
time response of state space model, 
636–645
Matrix inverse, 618–623
adjoint of matrix, 621–623
determinant of a matrix, 620–621
inverse of a matrix, 623
matrix transpose, 619–620
trace of a matrix, 620
Matrix multiplication, 617–618
Matrix properties, summary of, 622
Matrix transformations, 631
Matrix transpose, 619–620
Maxwell’s reciprocity property, 287, 332–337, 
333f
Mechanical actuators, 486
Mechanical circuits, Thevenin approach for, 
364–365
Mechanical components, 485
classification of, 487f
Mechanical controllers, 486
Mechanical domain
linear graph examples in, 224–233
modeling in, 84–89
constitutive equations, 89
loop equations, 87
node equations, 88–89
state equations, 89
Mechanical elements, 27, 28f, 204, 204f
damping element, 30–31
inertia element, 27–29
spring element, 29–30
Mechanical gyrator, 207, 209–211, 210f
Mechanical impedance, 287, 321, 321f, 327
circuit, 321f, 324
matching, 327
and mobility, 308, 311
interconnection laws, 311–313
transfer functions, 308–311, 313–319
Mechanical systems, 55, 86f, 108f, 109f, 111f, 154f, 
167f, 204, 226f, 285–286
transfer functions in, 308–311
Mechanical transfer functions, 19, 285, 310–311, 
311f
Mechatronic approach, 2, 3, 6, 13
Mechatronic systems, 13–15, 14f
concepts and technologies of, 15f
Membership Function Editor, 603, 604
Metal oxide semiconductor FET (MOSFET), 524, 
525f, 527
M-files, 593–594
Microwaves, 529, 530
MIMO system, see Multi-input–multi-output 
(MIMO) system
Mitigation of system nonlinearities, 133, 181
Mixed domains, linear-graph examples in, 
254–262
Mixed dynamic system, 19, 25
Mixed system, see Multidomain system
Mobility, 287
mechanical impedance and, 311
Mobility function, 311, 315, 316, 317, 318
Modal matrix, 637
Modal response, 647–653
advantages of modal decomposition, 
649–653
state response through modal 
response, 649
Model, 1, 2, 7
Model-based control, 4
Model identification, 7, 11, 435
Modeling, 1
and design, 6f
dynamic systems and models, 7
model complexity, 8–11
terminology, 7–8
importance and applications of, 3
modeling in control, 4–5
modeling in design, 5–6
model types, 11
analytical model development, steps of, 
15–16
analytical models, advantages of, 12–13
mechatronic systems, 13–15, 14f, 15f
modeling criteria and equivalent models, 
16–17
Model-referenced adaptive control, 4, 5f
Modified Gram–Schmidt procedure, 627
Modulated Source element, 235
MOSFET, see Metal oxide semiconductor FET 
(MOSFET)
Motion isolation, force isolation and, 326–332
Motion transmissibility, 319–326
function, 317
mechanism, 320, 320f
Motor control, experimental linear model for, 
165–166
Multidomain/mixed dynamic system, 25
Multidomain model of Iron Butcher, 12f, 346
Multidomain system, 2, 5, 6, 11, 13, 262
Multidomain transfer-function (TF) LGs, 365
equivalent single domain, conversion into, 
365

666
Index
Multidomain transfer-function (TF) LGs (cont.)
gyrator-coupled systems, 367–368, 367f
transformer-coupled systems, 366–367, 
366f
Multifunctional components, 2
Multi-input–multi-output (MIMO) system, 66, 
76, 294, 394, 395f, 396
Multiport elements, in bond-graph models
common-force junction, 543–544
common-velocity junction, 544–545
junction elements, 543
Multivariable system, 66, 76
N
Natural frequency equivalence, 73–74
Natural oscillations, 18, 26, 55
Negative definite matrix, 629
Negative semidefinite matrix, 629
Neutral equilibrium, 128
Newton’s second law, 27, 43, 80, 166, 210, 414, 415
Node equations, 88–89, 215
primary, 215
Non-autonomous systems, see Time-variant 
systems
Nonlinear characteristics of practical devices, 
123
dead zone, 124
frequency creation, 125–126
hysteresis, 124
hysteresis loop and energy dissipation, 
124–125
ideal relay, 124
jump phenomenon, 125
limit cycles, 125
saturation, 123–124
Nonlinear electrical elements, 126
capacitor, 126
inductor, 126–127
resistor, 127
Nonlinear functions
of one variable, 128–130
of two variables, 130–131
Nonlinearity, static, 122, 172, 173
Nonlinear state-space models, 131
linearization of state models, 132–133
mitigation of system nonlinearities, 133–163
Nonlinear system, 176
experimental linear model of, 166–171
properties of, 122
nonlinear characteristics of practical 
devices, 123–126
nonlinear electrical elements, 126–127
static nonlinearity, 122
Nonstationary systems, see Time-varying 
systems
Norm, 626–627
Normalization, 627
Normal tree
of linear graphs, 560–565
main result from, 561–565
state-space model formulation using, 
565–570
steps for obtaining, 561
Norton equivalence, 356, 365, 366, 381, 384, 388
Norton equivalent circuit, 348–352
npn transistor, 520, 521f, 522, 524f
Null matrix, 617
Null space, 629
Numerical model, 7
Nut, 488–491, 488f
Nyquist diagram, 301–303
Nyquist frequency, 69–70
O
Ohm’s law, 34, 127, 497
One-sided Fourier transform, 290
Operating temperature range, 521
Operational amplifiers (op-amps), 235
Optical coupling, 538
Optically coupled devices, applications of, 
537–538, 538f
“Optimistic” approach, modeling as, 5
Oriented branch, 202, 263
Orthogonal transformation, 631
Orthogonal vectors, 627
Output response, 646–647
Outputs, defined, 7
P
Paramagnetic materials, 510
Partial-fraction method, 410–419, 411f
Permeability, magnetism and, 508–509
Permittivity, 504–505
“Pessimistic” approach, modeling as, 5
Phase angle, 437
Photocells, 535, 536–537
Photoconductive cells, 535
Photoconductive diode, 535
Photoconductor, see Photoresistor
Photodetector/photosensor, see Light sensors
Photodiode, 535–536
Photo-FET, 535, 536
Photoresistor, 535

667
Index
Phototransistor, 535, 536
Photovoltaic diode, 535
Physical realizability, causality and, 420
PID control, see Proportional-integral-derivative 
(PID) control
Piezoelectricity, 506–508
Piezomagnetism, 511
Piezoresistivity, 500
PIN diodes, 519
PIN-slot transmission, principle of, 493–494, 
494f
Planar diffusion method, 522
Plant/process, defined, 7
Plasma displays, 534
Pneumatic systems, 94, 98f
pn junctions, 514
diode, 516f
pnp transistors, 520, 521f
Point of action, 201–206, 221, 262
Point of reference, 201–207, 221, 262
Polar plot, 301–303
Poles, 292, 407, 438
repeated poles, 429
Positive definite matrix, 629
Positive semidefinite matrix, 629
Potential energy, 30, 70
Potential energy equivalence, 71–72
Power, 202–203, 221
Power dissipation, 521
Power flow, 202, 203, 221
Power-information transformer, 236
Pressure source, 34
Principle of superposition, 66, 67f, 122, 351, 
399–400
Product qualification, 4
Product testing, 4
Proportional-integral-derivative (PID) control, 
179
p-type semiconductor, 515
Q
Quadratic forms, 629–630
R
Radiation, 53
linearized radiation resistor, 53–54
Radiation energy, 530
Radio waves, 529, 530
Rank of a matrix, 628
Reactance, 586–587
Real systems, 121, 127
Recalibration, 172
Rectangular matrix, 615
Reference point and action point, 201–202
Reluctance, of magnetic circuit, 512–513
Rescaling, 122, 172
Resistance
conductance and, 497
strain effects on, 500
temperature effects on, 499, 500t
Resistance temperature detectors (RTDs), 499
Resistivity, 498–499
of useful materials, 498t
Resistor, 31, 32f, 34f, 127
fluid, 35, 90, 95
linearized radiation, 53
thermal, 46, 102
Resistor (dissipation) element, 34, 496–503
color code for fixed resistors, 502–503
conductance and resistance, 497
resistivity, 498–499
strain effects on resistance, 500
superconductivity, 500–502
temperature effects on resistance, 499–500
Resistor-type elements, 18, 26
Resolvent matrix, 646
Resonant frequency, 125, 310, 451
Response analysis and simulation, 427
advanced, 633–655
analytical solution, 428
homogeneous solution, 428–429
impulse response function, 430–433
particular solution, 429–430
stability, 433–434
damped oscillator, forced response of, 443
harmonic excitation, response to, 447–453
impulse response, 444–445
riddle of zero ICs, 445–446
step response, 446–447
determination of ICs for step response, 
457–464
first-order systems, 434–436
Laplace transform, response using, 454, 
577–582
first-order system, step response of, 455
second-order system, step response of, 
455–457
step response, 454–455
second-order systems, 436
damped oscillator, free response of, 
438–443
undamped oscillator, free response of, 
436–438
Simulink®, 466

668
Index
Response analysis and simulation (cont.)
basic elements, 466–467
building an application, 467–468
running, 468–471
starting, 466
Reverse biasing, 515–517, 521
Reverse recovery time, 521
Rigid body modes, 417
Robotic sewing system, 269, 269f, 470f
RTDs, see Resistance temperature detectors 
(RTDs)
Rule Editor, 603, 604
Rule Viewer, 603, 604
Runge–Kutta method, 465
S
Sampling period, 66, 68
Sampling rate, 68, 69
Sampling theorem, 68–69
Saturation, 123–124, 123f
Scalar problem
homogeneous case, 633–634
nonhomogeneous case, 634–635
Schottky barrier diodes, 519
s-Domain, 287, 289
Second-order dynamic systems, 436
damped oscillator, free response of, 438–443
undamped oscillator, free response of, 
436–438
Semiconductor-controlled rectifier (SCR), see 
Thyristors
Semiconductor diode element, 530
Semiconductor lasers, 531, 532, 533
Semiconductors, 514–515
Semiconductor temperature sensor, circuit for, 
529
Series and parallel connections, 217–218
Series resistor and inertor elements, 
commutativity of, 90
Servomotor, 13
Silicon-controlled rectifier, see Thyristors
Silicon wafer, 537
Similarity transformation, 631
Simple oscillator, 226, 436, 437
Simulation block diagrams, 393, 399, 419f
causality and physical realizability, 420
proof of causality and physical 
realizability, 420
factored transfer-function method, 406–410
grouping like-derivatives method, 404–406
partial-fraction method, 410–419
principle of superposition, 399–400
superposition method, 401–403
Simulink, 589
blocks, 466–467
building an application, 467
connecting the blocks, 467–468
gathering blocks, 467
modifying the blocks, 467
in computer simulation, 399, 466
lines, 467
running a simulation, 468–471
starting Simulink, 466
Single-degree-of-freedom systems, 321f, 483
Single energy port, see Single-port elements, of 
linear graphs
Single-input single-output (SISO) system, 68, 
291, 394, 395f
SISO Design Tool, 595–598
Single-port bond-graph elements, 540–541
Single-port electrical system elements, 205f
Single-port elements, of linear graphs, 204, 207
mechanical elements, 204–205
SISO system, see Single-input single-output 
(SISO) system
Software tools
LabVIEW, 606–611
MATLAB, see MATLAB
Simulink, see Simulink
Solar cells, 536
Solid lasers, 531, 533
Solid-state controlled rectifier, see Thyristors
Speed-versus-torque curves, 163
s-Plane
application in circuit analysis, 586–587
Laplace and Fourier transforms, 
interpretation, 586
Spring (stiffness/flexibility) element, 29–30
Square matrix, 615
Stability of a system, 433–434
Stable equilibrium, 128, 132
Stable limit cycle, 125
Stalling torque, 164
State equations, 64, 76, 89
State models, 16
from linear graphs, 218
characteristics of LG, 222–224
LG variables and relations, 222–223
sign conventions, 221
sketching of linear graph, 219
steps of obtaining, 221
system order, 220
topological result, 223–224
linearization of, 132–133
properties of, 77–78

669
Index
systematic development of, 83–84
State-space models, 11, 12, 16, 18, 27, 76, 77
and block diagrams, 395–396, 396f
from bond graphs, 545–551
input–output models from, 80–83
linearization of, 131, 132
time response of, 635–645
using normal tree, 565–570
State-space shell, 27, 99, 221
State-transition matrix, see Matrix exponential
State variables, 26, 27, 31
defined, 7
Static nonlinearity, 122, 172, 173
Stationary systems, see Time-varying systems
Steady-state response, 447
Stiffness/flexibility element, 29–30
Storage temperature range, 521
Subspace, 625
Summing junctions, 396, 399
Superconductivity, 500–502
Superposition method, 401–403, 402f
Superposition, principle of, 66, 399–400
Surface emitters, 530
Surface Viewer, 603, 604
Switching elements, 527–529
Sylvester’s theorem, 630
“Systematic” approach to modeling, 15
System, defined, 7
System identification, 7, 11, 163, see also 
Experimental modeling
System nonlinearities, mitigation of, 133–163
T
Taylor series approximation, 127, 128, 130
Temperature source, 45, 249
TF model, see Transfer-function (TF) model
Thermal capacitor, 45–46, 45f
Thermal conductivities, 47t
Thermal domain
linear-graph examples in, 249
model equations, 249–254
modeling in, 100–106
Thermal energy, 534
Thermal resistance, types of, 47f
Thermal resistor, 46
conduction, 46–49
three-dimensional conduction, 48–49
convection, 49
Biot number, 50
radiation, 53
linearized radiation resistor, 53–54
Thermistors, 499
Thevenin and Norton equivalent circuits, 
348–352
Thevenin approach for mechanical circuits, 
364–365
Thevenin equivalence, 19, 356, 365, 381, 388
Thevenin’s theorem for electrical circuits, 347
circuit partitioning, 348
Thevenin and Norton equivalent circuits, 
348–352
Thin fluid layer approximation, 93–94
Three-dimensional conduction, 48–49
Three-port junction elements, 544
Through-variables, 16, 18, 26–27, 75, 126, 201, 
202–203, 207, 215
Thyristors, 519–520, 520f
Time domain model, 64, 285, 289, 292, 298
Time-invariant systems, 80, 400, 433
Time response
by Laplace transform, 645–646
of state space model, 635–645
Time-varying systems, 80
homogeneous (free) system, 653
nonhomogeneous (forced) system, 653–655
Torque-speed curves of motors, 163–165
Trace of a matrix, 620
Traction drives, 494
Transfer function, 582–584
Transfer-function linear graphs, 345, 353–356
circuit reduction and equivalent circuits, 347
circuit partitioning, 348
extension into other domains, 353
justification of circuit equivalence, 
352–353
Thevenin and Norton equivalent circuits, 
348–352
equivalent TF LGs, 353
equivalent mechanical circuit analysis 
using LGs, 356–364
Thevenin approach for mechanical 
circuits, 364–365
transfer-function LGs, 353–356
multidomain TF LGs, 365
gyrator-coupled systems, 367–368, 367f
transformer-coupled systems, 366–367, 
366f
Transfer function matrix, 293–295, 615, 647
Transfer-function (TF) model, 11, 16, 64–65, 176, 
285, 286–287, 291–293, 298, 308
of basic elements, 313–319
and block diagrams, 394–395
discrete transfer function, 68
factored transfer-function method, 
406–410

670
Index
Transfer-function (TF) model (cont.)
mechanical impedance and mobility, 311
mechanical transfer functions, 310–311
Transformer, 207, 208f
-coupled systems, 366–367, 366f
electrical, 209
electromechanical, 237
power-information, 236
Transform techniques
Fourier transform, 584–586
Laplace transform, see Laplace transform
s-plane, 586–587
transfer function, 582–584
Transistors
bipolar junction transistor (BJT), 520–521
characteristics, 522
common types, 527t
fabrication process of, 522–523
field effect transistors (FET), 523
JFET, 524–527
MOSFET, 524, 525
parameters for, 523t
switching elements, 527–529
Transition capacitance, 521
Transmissibility function, 287, 319, 322
force transmissibility, 319
Maxwell’s reciprocity property, 332–337
motion transmissibility, 319–326
vibration isolation, 326
force isolation and motion isolation, 
326–332
Transmissibility magnitude, 322, 327, 328
Transmission components, 485–488
Transpose of a matrix, 619–620
Trapezoidal rule, 465
T-source, 202, 203, 205, 206, 207f, 212, 213, 
316
T-type amplifier, 235, 236, 236f
T-type element, 18, 26, 27, 31, 35
T-type pneumatic element, 94–95
T-type source, 27, 205, 206
T-type transfer functions, 308, 312–313
Tunnel diodes, 518
Turbulent flow, 44
Two-port elements, of linear graphs, 207
gyrator, 209
hydraulic-mechanical gyrator, 210f, 211
mechanical gyrator, 209–211, 210f
transformer, 207, 208f
electrical transformer, 209
Two-port mechanical bond-graph 
elements, 543
U
Ultraviolet radiation, 534
Ultraviolet rays, 529, 530
Undamped oscillator, free response of, 
436–438
Undetermined coefficients, method of, 429
Unified approach, 2, 3, 6, 18, 25, 200, 255
Unit vector, 626
Unity matrix, see Identity matrix
Unstable equilibrium, 128, 128f, 132
Unstable limit cycle, 125
Unstable system, 434
V
Varactor diodes/varicaps, see VVC diodes
Variable pair, 201, 203, 218, 219
Vector-matrix algebra
identity matrix, 618
matrix addition and subtraction, 
616–617
matrix multiplication, 617–618
null matrix, 617
Vectors and matrices, 613–615
Vector spaces
bases and dimension of, 625–626
field (F), 623–624
Gram–Schmidt orthogonalization, 627
inner product, 626
linear dependence, 625
modified Gram–Schmidt procedure, 627
norm, 626–627
subspace S of L, 625
vector space (L), properties, 624
Velocity source, 541–542
Vertical pipe, pressure head in, 92–93
Vibration, 4
Vibration isolation, 326
force isolation and motion isolation, 
326–332
Virtual instruments (VIs), 606
VIs, see Virtual instruments (VIs)
Visible light, 529, 530
VMOS, see V-shaped gate MOSFET (VMOS)
Voltage-controlled transistor, see Field effect 
transistors (FET)
Voltage gain, 522
Voltage sensitivity, 507
Voltage source, 31
V-shaped gate MOSFET (VMOS), 527
VVC diodes, 518

671
Index
W
Wafer, 522
Wavelengths, 529, 530
Wood-cutting machine, 142f
X
X-rays, 529, 530
Z
Zener breakdown, 516
Zener diodes, 517–518
voltage regulator using, 517f
Zero initial conditions (ICs), 291, 
445–446
Zero-state response, 447, 456
Z-transform, 68, 106

