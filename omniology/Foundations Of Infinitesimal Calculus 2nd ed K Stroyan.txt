Mathematical Background:
Foundations of Inﬁnitesimal Calculus
second edition
by
K. D. Stroyan
x
y
y=f(x)
dx
dy
δx
ε
dx
dy
Figure 0.1: A Microscopic View of the Tangent
Copyright c⃝1997 by Academic Press, Inc. - All rights reserved.
Typeset with AMS-TEX

i
Preface to the Mathematical Background
We want you to reason with mathematics. We are not trying to get everyone to give
formalized proofs in the sense of contemporary mathematics; ‘proof’ in this course means
‘convincing argument.’ We expect you to use correct reasoning and to give careful expla-
nations. The projects bring out these issues in the way we ﬁnd best for most students,
but the pure mathematical questions also interest some students. This book of mathemat-
ical “background” shows how to ﬁll in the mathematical details of the main topics from
the course. These proofs are completely rigorous in the sense of modern mathematics –
technically bulletproof. We wrote this book of foundations in part to provide a convenient
reference for a student who might like to see the “theorem - proof” approach to calculus.
We also wrote it for the interested instructor. In re-thinking the presentation of beginning
calculus, we found that a simpler basis for the theory was both possible and desirable. The
pointwise approach most books give to the theory of derivatives spoils the subject. Clear
simple arguments like the proof of the Fundamental Theorem at the start of Chapter 5 below
are not possible in that approach. The result of the pointwise approach is that instructors
feel they have to either be dishonest with students or disclaim good intuitive approximations.
This is sad because it makes a clear subject seem obscure. It is also unnecessary – by and
large, the intuitive ideas work provided your notion of derivative is strong enough. This
book shows how to bridge the gap between intuition and technical rigor.
A function with a positive derivative ought to be increasing.
After all, the slope is
positive and the graph is supposed to look like an increasing straight line. How could the
function NOT be increasing? Pointwise derivatives make this bizarre thing possible - a
positive “derivative” of a non-increasing function. Our conclusion is simple. That deﬁnition
is WRONG in the sense that it does NOT support the intended idea.
You might agree that the counterintuitive consequences of pointwise derivatives are un-
fortunate, but are concerned that the traditional approach is more “general.” Part of the
point of this book is to show students and instructors that nothing of interest is lost and a
great deal is gained in the straightforward nature of the proofs based on “uniform” deriva-
tives. It actually is not possible to give a formula that is pointwise diﬀerentiable and not
uniformly diﬀerentiable.
The pieced together pointwise counterexamples seem contrived
and out-of-place in a course where students are learning valuable new rules. It is a theorem
that derivatives computed by rules are automatically continuous where deﬁned. We want
the course development to emphasize good intuition and positive results. This background
shows that the approach is sound.
This book also shows how the pathologies arise in the traditional approach – we left
pointwise pathology out of the main text, but present it here for the curious and for com-
parison. Perhaps only math majors ever need to know about these sorts of examples, but
they are fun in a negative sort of way.
This book also has several theoretical topics that are hard to ﬁnd in the literature. It
includes a complete self-contained treatment of Robinson’s modern theory of inﬁnitesimals,
ﬁrst discovered in 1961. Our simple treatment is due to H. Jerome Keisler from the 1970’s.
Keisler’s elementary calculus using inﬁnitesimals is sadly out of print. It used pointwise
derivatives, but had many novel ideas, including the ﬁrst modern use of a microscope to
describe the derivative. (The l’Hospital/Bernoulli calculus text of 1696 said curves consist
of inﬁnitesimal straight segments, but I do not know if that was associated with a magni-
fying transformation.) Inﬁnitesimals give us a very simple way to understand the uniform

ii
derivatives, although this can also be clearly understood using function limits as in the text
by Lax, et al, from the 1970s. Modern graphical computing can also help us “see” graphs
converge as stressed in our main materials and in the interesting Uhl, Porta, Davis, Calculus
& Mathematica text.
Almost all the theorems in this book are well-known old results of a carefully studied
subject. The well-known ones are more important than the few novel aspects of the book.
However, some details like the converse of Taylor’s theorem – both continuous and discrete –
are not so easy to ﬁnd in traditional calculus sources. The microscope theorem for diﬀerential
equations does not appear in the literature as far as we know, though it is similar to research
work of Francine and Marc Diener from the 1980s.
We conclude the book with convergence results for Fourier series. While there is nothing
novel in our approach, these results have been lost from contemporary calculus and deserve
to be part of it. Our development follows Courant’s calculus of the 1930s giving wonderful
results of Dirichlet’s era in the 1830s that clearly settle some of the convergence mysteries
of Euler from the 1730s. This theory and our development throughout is usually easy to
apply. “Clean” theory should be the servant of intuition – building on it and making it
stronger and clearer.
There is more that is novel about this “book.” It is free and it is not a “book” since it is
not printed. Thanks to small marginal cost, our publisher agreed to include this electronic
text on CD at no extra cost. We also plan to distribute it over the world wide web. We
hope our fresh look at the foundations of calculus will stimulate your interest. Decide for
yourself what’s the best way to understand this wonderful subject. Give your own proofs.

Contents
Part 1
Numbers and Functions
Chapter 1. Numbers
3
1.1 Field Axioms
3
1.2 Order Axioms
6
1.3 The Completeness Axiom
7
1.4 Small, Medium and Large Numbers
9
Chapter 2. Functional Identities
17
2.1 Speciﬁc Functional Identities
17
2.2 General Functional Identities
18
2.3 The Function Extension Axiom
21
2.4 Additive Functions
24
2.5 The Motion of a Pendulum
26
Part 2
Limits
Chapter 3. The Theory of Limits
31
3.1 Plain Limits
32
3.2 Function Limits
34
3.3 Computation of Limits
37
Chapter 4. Continuous Functions
43
4.1 Uniform Continuity
43
4.2 The Extreme Value Theorem
44
iii

iv
Contents
4.3 Bolzano’s Intermediate Value Theorem
46
Part 3
1 Variable Diﬀerentiation
Chapter 5. The Theory of Derivatives
49
5.1 The Fundamental Theorem: Part 1
49
5.1.1 Rigorous Inﬁnitesimal Justiﬁcation
52
5.1.2 Rigorous Limit Justiﬁcation
53
5.2 Derivatives, Epsilons and Deltas
53
5.3 Smoothness ⇒Continuity of Function and Derivative
54
5.4 Rules ⇒Smoothness
56
5.5 The Increment and Increasing
57
5.6 Inverse Functions and Derivatives
58
Chapter 6. Pointwise Derivatives
69
6.1 Pointwise Limits
69
6.2 Pointwise Derivatives
72
6.3 Pointwise Derivatives Aren’t Enough for Inverses
76
Chapter 7. The Mean Value Theorem
79
7.1 The Mean Value Theorem
79
7.2 Darboux’s Theorem
83
7.3 Continuous Pointwise Derivatives are Uniform
85
Chapter 8. Higher Order Derivatives
87
8.1 Taylor’s Formula and Bending
87
8.2 Symmetric Diﬀerences and Taylor’s Formula
89
8.3 Approximation of Second Derivatives
91
8.4 The General Taylor Small Oh Formula
92
8.4.1 The Converse of Taylor’s Theorem
95
8.5 Direct Interpretation of Higher Order Derivatives
98
8.5.1 Basic Theory of Interpolation
99
8.5.2 Interpolation where f is Smooth
101
8.5.3 Smoothness From Diﬀerences
102
Part 4
Integration
Chapter 9. Basic Theory of the Deﬁnite Integral
109
9.1 Existence of the Integral
110

Contents
v
9.2 You Can’t Always Integrate Discontinuous Functions
114
9.3 Fundamental Theorem: Part 2
116
9.4 Improper Integrals
119
9.4.1 Comparison of Improper Integrals
121
9.4.2 A Finite Funnel with Inﬁnite Area?
123
Part 5
Multivariable Diﬀerentiation
Chapter 10. Derivatives of Multivariable Functions
127
Part 6
Diﬀerential Equations
Chapter 11. Theory of Initial Value Problems
131
11.1 Existence and Uniqueness of Solutions
131
11.2 Local Linearization of Dynamical Systems
135
11.3 Attraction and Repulsion
141
11.4 Stable Limit Cycles
143
Part 7
Inﬁnite Series
Chapter 12. The Theory of Power Series
147
12.1 Uniformly Convergent Series
149
12.2 Robinson’s Sequential Lemma
151
12.3 Integration of Series
152
12.4 Radius of Convergence
154
12.5 Calculus of Power Series
156
Chapter 13. The Theory of Fourier Series
159
13.1 Computation of Fourier Series
160
13.2 Convergence for Piecewise Smooth Functions
167
13.3 Uniform Convergence for Continuous Piecewise Smooth Functions
173
13.4 Integration of Fourier Series
175

-4
-2
2
4
w
-4
-2
2
4
x
Part 1
Numbers and Functions

2

CHAPTER
1
Numbers
This chapter gives the algebraic laws of the number systems used
in calculus.
Numbers represent various idealized measurements. Positive integers may count items,
fractions may represent a part of an item or a distance that is part of a ﬁxed unit. Distance
measurements go beyond rational numbers as soon as we consider the hypotenuse of a right
triangle or the circumference of a circle. This extension is already in the realm of imagined
“perfect” measurements because it corresponds to a perfectly straight-sided triangle with
perfect right angle, or a perfectly round circle. Actual real measurements are always rational
and have some error or uncertainty.
The various “imaginary” aspects of numbers are very useful ﬁctions. The rules of com-
putation with perfect numbers are much simpler than with the error-containing real mea-
surements. This simplicity makes fundamental ideas clearer.
Hyperreal numbers have ‘teeny tiny numbers’ that will simplify approximation estimates.
Direct computations with the ideal numbers produce symbolic approximations equivalent
to the function limits needed in diﬀerentiation theory (that the rules of Theorem 1.12 give
a direct way to compute.) Limit theory does not give the answer, but only a way to justify
it once you have found it.
1.1
Field Axioms
The laws of algebra follow from the ﬁeld axioms. This means that algebra
is the same with Dedekind’s “real” numbers, the complex numbers, and
Robinson’s “hyperreal” numbers.
3

4
1. Numbers
Axiom 1.1.
Field Axioms
A “ﬁeld” of numbers is any set of objects together with two operations, addition
and multiplication where the operations satisfy:
• The commutative laws of addition and multiplication,
a1 + a2 = a2 + a1
&
a1 · a2 = a2 · a1
• The associative laws of addition and multiplication,
a1 + (a2 + a3) = (a1 + a2) + a3
&
a1 · (a2 · a3) = (a1 · a2) · a3
• The distributive law of multiplication over addition,
a1 · (a2 + a3) = a1 · a2 + a1 · a3
• There is an additive identity, 0, with 0 + a = a for every number a.
• There is an multiplicative identity, 1, with 1 · a = a for every number a ̸= 0.
• Each number a has an additive inverse, −a, with a + (−a) = 0.
• Each nonzero number a has a multiplicative inverse, 1
a, with a · 1
a = 1.
A computation needed in calculus is
Example 1.1.
The Cube of a Binomial
(x + ∆x)3 = x3 + 3x2∆x + 3x∆x2 + ∆x3
= x3 + 3x2∆x + (∆x(3x + ∆x)) ∆x
We analyze the term ε = (∆x(3x + ∆x)) in diﬀerentiation.
The reader could laboriously demonstrate that only the ﬁeld axioms are needed to perform
the computation. This means it holds for rational, real, complex, or hyperreal numbers.
Here is a start. Associativity is needed so that the cube is well deﬁned, or does not depend
on the order we multiply. We use this in the next computation, then use the distributive
property, the commutativity and the distributive property again, and so on.
(x + ∆x)3 = (x + ∆x)(x + ∆x)(x + ∆x)
= (x + ∆x)((x + ∆x)(x + ∆x))
= (x + ∆x)((x + ∆x)x + (x + ∆x)∆x)
= (x + ∆x)((x2 + x∆x) + (x∆x + ∆x2))
= (x + ∆x)(x2 + x∆x + x∆x + ∆x2)
= (x + ∆x)(x2 + 2x∆x + ∆x2)
= (x + ∆x)x2 + (x + ∆x)2x∆x + (x + ∆x)∆x2)
...
The natural counting numbers 1, 2, 3, . . . have operations of addition and multiplication,
but do not satisfy all the properties needed to be a ﬁeld. Addition and multiplication do
satisfy the commutative, associative, and distributive laws, but there is no additive inverse

Field Axioms
5
0 in the counting numbers. In ancient times, it was controversial to add this element that
could stand for counting nothing, but it is a useful ﬁction in many kinds of computations.
The negative integers −1, −2, −3, . . . are another idealization added to the natural num-
bers that make additive inverses possible - they are just new numbers with the needed
property. Negative integers have perfectly concrete interpretations such as measurements
to the left, rather than the right, or amounts owed rather than earned.
The set of all integers; positive, negative, and zero, still do not form a ﬁeld because there
are no multiplicative inverses. Fractions, ±1/2, ±1/3, . . . are the needed additional inverses.
When they are combined with the integers through addition, we have the set of all rational
numbers of the form ±p/q for natural numbers p and q ̸= 0. The rational numbers are a
ﬁeld, that is, they satisfy all the axioms above. In ancient times, rationals were sometimes
considered only “operators” on “actual” numbers like 1, 2, 3, . . ..
The point of the previous paragraphs is simply that we often extend one kind of number
system in order to have a new system with useful properties. The complex numbers extend
the ﬁeld axioms above beyond the “real” numbers by adding a number i that solves the
equation x2 = −1. (See the CD Chapter 29 of the main text.) Hundreds of years ago this
number was controversial and is still called “imaginary.” In fact, all numbers are useful
constructs of our imagination and some aspects of Dedekind’s “real” numbers are much
more abstract than i2 = −1. (For example, since the reals are “uncountable,” “most” real
numbers have no description what-so-ever.)
The rationals are not “complete” in the sense that the linear measurement of the side
of an equilateral right triangle (
√
2) cannot be expressed as p/q for p and q integers. In
Section 1.3 we “complete” the rationals to form Dedekind’s “real” numbers. These numbers
correspond to perfect measurements along an ideal line with no gaps.
The complex numbers cannot be ordered with a notion of “smaller than” that is compat-
ible with the ﬁeld operations. Adding an “ideal” number to serve as the square root of −1 is
not compatible with the square of every number being positive. When we make extensions
beyond the real number system we need to make choices of the kind of extension depending
on the properties we want to preserve.
Hyperreal numbers allow us to compute estimates or limits directly, rather than making
inverse proofs with inequalities. Like the complex extension, hyperreal extension of the reals
loses a property; in this case completeness. Hyperreal numbers are explained beginning in
Section 1.4 below and then are used extensively in this background book to show how many
intuitive estimates lead to simple direct proofs of important ideas in calculus.
The hyperreal numbers (discovered by Abraham Robinson in 1961) are still controver-
sial because they contain inﬁnitesimals. However, they are just another extended modern
number system with a desirable new property. Hyperreal numbers can help you understand
limits of real numbers and many aspects of calculus. Results of calculus could be proved
without inﬁnitesimals, just as they could be proved without real numbers by using only
rationals. Many professors still prefer the former, but few prefer the latter. We believe that
is only because Dedekind’s “real” numbers are more familiar than Robinson’s, but we will
make it clear how both approaches work as a theoretical background for calculus.
There is no controversy concerning the logical soundness of hyperreal numbers. The use
of inﬁnitesimals in the early development of calculus beginning with Leibniz, continuing with
Euler, and persisting to the time of Gauss was problematic. The founders knew that their
use of inﬁnitesimals was logically incomplete and could lead to incorrect results. Hyperreal
numbers are a correct treatment of inﬁnitesimals that took nearly 300 years to discover.

6
1. Numbers
With hindsight, they also have a simple description. The Function Extension Axiom 2.1
explained in detail in Chapter 2 was the missing key.
Exercise set 1.1
1. Show that the identity numbers 0 and 1 are unique. (HINT: Suppose 0′ + a = a. Add
−a to both sides.)
2. Show that 0 · a = 0. (HINT: Expand
 0 + b
a

· a with the distributive law and show that
0 · a + b = b. Then use the previous exercise.)
3. The inverses −a and 1
a are unique. (HINT: Suppose not, 0 = a −a = a + b. Add −a
to both sides and use the associative property.)
4. Show that −1 · a = −a. (HINT: Use the distributive property on 0 = (1 −1) · a and use
the uniqueness of the inverse.)
5. Show that (−1) · (−1) = 1.
6. Other familiar properties of algebra follow from the axioms, for example, if a3 ̸= 0 and
a4 ̸= 0, then
a1 + a2
a3
= a1
a3
+ a2
a3
,
a1 · a2
a3 · a4
= a1
a3
· a2
a4
&
a3 · a4 ̸= 0
1.2
Order Axioms
Estimation is based on the inequality ≤of the real numbers.
One important representation of rational and real numbers is as measurements of distance
along a line. The additive identity 0 is located as a starting point and the multiplicative
identity 1 is marked oﬀ(usually to the right on a horizontal line). Distances to the right
correspond to positive numbers and distances to the left to negative ones. The inequality
< indicates which numbers are to the left of others. The abstract properties are as follows.
Axiom 1.2.
Ordered Field Axioms
A a number system is an ordered ﬁeld if it satisﬁes the ﬁeld Axioms 1.1 and has a
relation < that satisﬁes:
• Every pair of numbers a and b satisﬁes exactly one of the relations
a = b, a < b, or b < a
• If a < b and b < c, then a < c.
• If a < b, then a + c < b + c.
• If 0 < a and 0 < b, then 0 < a · b.
These axioms have simple interpretations on the number line. The ﬁrst order axiom says
that every two numbers can be compared; either two numbers are equal or one is to the left
of the other.

The Completeness Axiom
7
The second axiom, called transitivity, says that if a is left of b and b is left of c, then a is
left of c.
The third axiom says that if a is left of b and we move both by a distance c, then the
results are still in the same left-right order.
The fourth axiom is the most diﬃcult abstractly. All the compatibility with multiplication
is built from it.
The rational numbers satisfy all these axioms, as do the real and hyperreal numbers. The
complex numbers cannot be ordered in a manner compatible with the operations of addition
and multiplication.
Deﬁnition 1.3.
Absolute Value
If a is a nonzero number in an ordered ﬁeld, |a| is the larger of a and −a, that is,
|a| = a if −a < a and |a| = −a if a < −a. We let |0| = 0.
Exercise set 1.2
1. If 0 < a, show that −a < 0 by using the additive property.
2. Show that 0 < 1. (HINT: Recall the exercise that (−1) · (−1) = 1 and argue by contra-
diction, supposing 0 < −1.)
3. Show that a · a > 0 for every a ̸= 0.
4. Show that there is no order < on the complex numbers that satisﬁes the ordered ﬁeld
axioms.
5. Prove that if a < b and c > 0, then c · a < c · b.
Prove that if 0 < a < b and 0 < c < d, then c · a < d · b.
1.3
The Completeness Axiom
Dedekind’s “real” numbers represent points on an ideal line with no gaps.
The number
√
2 is not rational. Suppose to the contrary that
√
2 = q/r for integers q
and r with no common factors. Then 2r2 = q2. The prime factorization of both sides must
be the same, but the factorization of the squares have an even number distinct primes on
each side and the 2 factor is left over. This is a contradiction, so there is no rational number
whose square is 2.
A length corresponding to
√
2 can be approximated by (rational) decimals in various
ways, for example, 1 < 1.4 < 1.41 < 1.414 < 1.4142 < 1.41421 < 1.414213 < . . .. There
is no rational for this sequence to converge to, even though it is “trying” to converge. For
example, all the terms of the sequence are below 1.41422 < 1.4143 < 1.415 < 1.42 < 1.5 < 2.
Even without remembering a fancy algorithm for ﬁnding square root decimals, you can test

8
1. Numbers
the successive decimal approximations by squaring, for example, 1.414212 = 1.9999899241
and 1.414222 = 2.0000182084.
It is perfectly natural to add a new number to the rationals to stand for the limit of
the better and better approximations to
√
2. Similarly, we could devise approximations
to π and make π the number that stands for the limit of such successive approximations.
We would like a method to include “all such possible limits” without having to specify the
particular approximations. Dedekind’s approach is to let the real numbers be the collection
of all “cuts” on the rational line.
Deﬁnition 1.4.
A Dedekind Cut
A “cut” in an ordered ﬁeld is a pair of nonempty sets A and B so that:
• Every number is either in A or B.
• Every a in A is less than every b in B.
We may think of
√
2 deﬁning a cut of the rational numbers where A consists of all rational
numbers a with a < 0 or a2 < 2 and B consists of all rational numbers b with b2 > 2. There
is a “gap” in the rationals where we would like to have
√
2. Dedekind’s “real numbers” ﬁll
all such gaps. In this case, a cut of real numbers would have to have
√
2 either in A or in
B.
Axiom 1.5.
Dedekind Completeness
The real numbers are an ordered ﬁeld such that if A and B form a cut in those
numbers, there is a number r such that r is in either A or in B and all other the
numbers in A satisfy a < r and in B satisfy r < b.
In other words, every cut on the “real” line is made at some speciﬁc number r, so there
are no gaps. This seems perfectly reasonable in cases like
√
2 and π where we know speciﬁc
ways to describe the associated cuts. The only drawback to Dedekind’s number system
is that “every cut” is not a very concrete notion, but rather relies on an abstract notion
of “every set.” This leads to some paradoxical facts about cuts that do not have speciﬁc
descriptions, but these need not concern us. Every speciﬁc cut has a real number in the
middle.
Completeness of the reals means that “approximation procedures” that are “improving”
converge to a number. We need to be more speciﬁc later, but for example, bounded in-
creasing or decreasing sequences converge and “Cauchy” sequences converge. We will not
describe these details here, but take them up as part of our study of limits below.
Completeness has another important consequence, the Archimedean Property Theo-
rem 1.8. We take that up in the next section. The Archimedean Property says precisely that
the real numbers contain no positive inﬁnitesimals. Hyperreal numbers extend the reals by
including inﬁnitesimals. (As a consequence the hyperreals are not Dedekind complete.)

Small, Medium and Large Numbers
9
1.4
Small, Medium and Large Num-
bers
Hyperreal numbers give us a way to simplify estimation by adding inﬁnites-
imal numbers to the real numbers.
We want to have three diﬀerent intuitive sizes of numbers, very small, medium size, and
very large. Most important, we want to be able to compute with these numbers using the
same rules of algebra as in high school and separate the ‘small’ parts of our computation.
Hyperreal numbers give us these computational estimates. Hyperreal numbers satisfy three
axioms which we take up separately below, Axiom 1.7, Axiom 1.9, and Axiom 2.1.
As a ﬁrst intuitive approximation, we could think of these scales of numbers in terms of
the computer screen. In this case, ‘medium’ numbers might be numbers in the range -999 to
+ 999 that name a screen pixel. Numbers closer than one unit could not be distinguished by
diﬀerent screen pixels, so these would be ‘tiny’ numbers. Moreover, two medium numbers
a and b would be indistinguishably close, a ≈b, if their diﬀerence was a ‘tiny’ number less
than a pixel. Numbers larger in magnitude than 999 are too big for the screen and could
be considered ‘huge.’
The screen distinction sizes of computer numbers is a good analogy, but there are diﬃ-
culties with the algebra of screen - size numbers. We want to have ordinary rules of algebra
and the following properties of approximate equality. For now, all you should think of is
that ≈means ‘approximately equals.’
(a) If p and q are medium, so are p + q and p · q.
(b) If ε and δ are tiny, so is ε + δ, that is, ε ≈0 and δ ≈0 implies ε + δ ≈0.
(c) If δ ≈0 and q is medium, then q · δ ≈0.
(d) 1/0 is still undeﬁned and 1/x is huge only when x ≈0.
You can see that the computer number idea does not quite work, because the approximation
rules don’t always apply. If p = 15.37 and q = −32.4, then p·q = −497.998 ≈−498, ‘medium
times medium is medium,’ however, if p = 888 and q = 777, then p · q is no longer screen
size...
The hyperreal numbers extend the ‘real’ number system to include ‘ideal’ numbers that
obey these simple approximation rules as well as the ordinary rules of algebra and trigonom-
etry. Very small numbers technically are called inﬁnitesimals and what we shall assume that
is diﬀerent from high school is that there are positive inﬁnitesimals.
Deﬁnition 1.6.
Inﬁnitesimal Number
A number δ in an ordered ﬁeld is called inﬁnitesimal if it satisﬁes
1
2 > 1
3 > 1
4 > · · · > 1
m > · · · > |δ|
for any ordinary natural counting number m = 1, 2, 3, · · ·. We write a ≈b and say
a is inﬁnitely close to b if the number b −a ≈0 is inﬁnitesimal.
This deﬁnition is intended to include 0 as “inﬁnitesimal.”

10
1. Numbers
Axiom 1.7.
The Inﬁnitesimal Axiom
The hyperreal numbers contain the real numbers, but also contain nonzero inﬁnites-
imal numbers, that is, numbers δ ≈0, positive, δ > 0, but smaller than all the real
positive numbers.
This stands in contrast to the following result.
Theorem 1.8.
The Archimedean Property
The hyperreal numbers are not Dedekind complete and there are no positive in-
ﬁnitesimal numbers in the ordinary reals, that is, if r > 0 is a positive real number,
then there is a natural counting number m such that 0 < 1
m < r.
Proof:
We deﬁne a cut above all the positive inﬁnitesimals. The set A consists of all numbers a
satisfying a < 1/m for every natural counting number m. The set B consists of all numbers
b such that there is a natural number m with 1/m < b. The pair A, B deﬁnes a Dedekind
cut in the rationals, reals, and hyperreal numbers. If there is a positive δ in A, then there
cannot be a number at the gap. In other words, there is no largest positive inﬁnitesimal or
smallest positive non-inﬁnitesimal. This is clear because δ < δ+δ and 2δ is still inﬁnitesimal,
while if ε is in B, ε/2 < ε must also be in B.
Since the real numbers must have a number at the “gap,” there cannot be any positive
inﬁnitesimal reals. Zero is at the gap in the reals and every positive real number is in B.
This is what the theorem asserts, so it is proved. Notice that we have also proved that the
hyperreals are not Dedekind complete, because the cut in the hyperreals must have a gap.
Two ordinary real numbers, a and b, satisfy a ≈b only if a = b, since the ordinary real
numbers do not contain inﬁnitesimals. Zero is the only real number that is inﬁnitesimal.
If you prefer not to say ‘inﬁnitesimal,’ just say ‘δ is a tiny positive number’ and think
of ≈as ‘close enough for the computations at hand.’ The computation rules above are still
important intuitively and can be phrased in terms of limits of functions if you wish. The
intuitive rules help you ﬁnd the limit.
The next axiom about the new “hyperreal” numbers says that you can continue to do
the algebraic computations you learned in high school.
Axiom 1.9.
The Algebra Axiom (Including < rules.)
The hyperreal numbers are an ordered ﬁeld, that is, they obey the same rules of
ordered algebra as the real numbers, Axiom 1.1 and Axiom 1.2.
The algebra of inﬁnitesimals that you need can be learned by working the examples and
exercises in this chapter.
Functional equations like the addition formulas for sine and cosine or the laws of logs
and exponentials are very important. (The speciﬁc high school identities are reviewed in
the main text CD Chapter 28 on High School Review.) The Function Extension Axiom 2.1
shows how to extend the non-algebraic parts of high school math to hyperreal numbers.
This axiom is the key to Robinson’s rigorous theory of inﬁnitesimals and it took 300 years
to discover. You will see by working with it that it is a perfectly natural idea, as hindsight
often reveals. We postpone that to practice with the algebra of inﬁnitesimals.
Example 1.2.
The Algebra of Small Quantities

Small, Medium and Large Numbers
11
Let’s re-calculate the increment of the basic cubic using the new numbers. Since the rules
of algebra are the same, the same basic steps still work (see Example 1.1), except now we
may take x any number and δx an inﬁnitesimal.
Small Increment of f[x] = x3
f[x + δx] = (x + δx)3 = x3 + 3x2δx + 3xδx2 + δx3
f[x + δx] = f[x] + 3x2 δx + (δx[3x + δx]) δx
f[x + δx] = f[x] + f ′[x] δx + ε δx
with f ′[x] = 3x2 and ε = (δx[3x + δx]). The intuitive rules above show that ε ≈0 whenever
x is ﬁnite. (See Theorem 1.12 and Example 1.8 following it for the precise rules.)
Example 1.3.
Finite Non-Real Numbers
The hyperreal numbers obey the same rules of algebra as the familiar numbers from high
school. We know that r+∆> r, whenever ∆> 0 is an ordinary positive high school number.
(See the addition property of Axiom 1.2.) Since hyperreals satisfy the same rules of algebra,
we also have new ﬁnite numbers given by a high school number r plus an inﬁnitesimal,
a = r + δ > r
The number a = r + δ is diﬀerent from r, even though it is inﬁnitely close to r. Since δ is
small, the diﬀerence between a and r is small
0 < a −r = δ ≈0
or
a ≈r
but
a ̸= r
Here is a technical deﬁnition of “ﬁnite” or “limited” hyperreal number.
Deﬁnition 1.10.
Limited and Unlimited Hyperreal Numbers
A hyperreal number x is said to be ﬁnite (or limited) if there is an ordinary natural
number m = 1, 2, 3, · · · so that
|x| < m.
If a number is not ﬁnite, we say it is inﬁnitely large (or unlimited).
Ordinary real numbers are part of the hyperreal numbers and they are ﬁnite because
they are smaller than the next integer after them. Moreover, every ﬁnite hyperreal number
is near an ordinary real number (see Theorem 1.11 below), so the previous example is the
most general kind of ﬁnite hyperreal number there is. The important thing is to learn to
compute with approximate equalities.
Example 1.4.
A Magniﬁed View of the Hyperreal Line
Of course, inﬁnitesimals are ﬁnite, since δ ≈0 implies that |δ| < 1. The ﬁnite numbers are
not just the ordinary real numbers and the inﬁnitesimals clustered near zero. The rules of
algebra say that if we add or subtract a nonzero number from another, the result is a diﬀerent
number. For example, π−δ < π < π+δ, when 0 < δ ≈0. These are distinct ﬁnite hyperreal
numbers but each of these numbers diﬀer by only an inﬁnitesimal, π ≈π + δ ≈π −δ. If
we plotted the hyperreal number line at unit scale, we could only put one dot for all three.
However, if we focus a microscope of power 1/δ at π we see three points separated by unit
distances.

12
1. Numbers
X 1/d
Pi
Pi + d
Pi - d
Figure 1.1: Magniﬁcation at Pi
The basic fact is that ﬁnite numbers only diﬀer from reals by an inﬁnitesimal. (This is
equivalent to Dedekind’s Completeness Axiom.)
Theorem 1.11.
Standard Parts of Finite Numbers
Every ﬁnite hyperreal number x diﬀers from some ordinary real number r by an
inﬁnitesimal amount, x−r ≈0 or x ≈r. The ordinary real number inﬁnitely near
x is called the standard part of x, r = st(x).
Proof:
Suppose x is a ﬁnite hyperreal. Deﬁne a cut in the real numbers by letting A be the
set of all real numbers satisfying a ≤x and letting B be the set of all real numbers b with
x < b. Both A and B are nonempty because x is ﬁnite. Every a in A is below every b
in B by transitivity of the order on the hyperreals. The completeness of the real numbers
means that there is a real r at the gap between A and B. We must have x ≈r, because if
x −r > 1/m, say, then r + 1/(2m) < x and by the gap property would need to be in B.
A picture of the hyperreal number line looks like the ordinary real line at unit scale.
We can’t draw far enough to get to the inﬁnitely large part and this theorem says each
ﬁnite number is indistinguishably close to a real number. If we magnify or compress by new
number amounts we can see new structure.
You still cannot divide by zero (that violates rules of algebra), but if δ is a positive
inﬁnitesimal, we can compute the following:
−δ,
δ2,
1
δ
What can we say about these quantities?
The idealization of inﬁnitesimals lets us have our cake and eat it too. Since δ ̸= 0, we
can divide by δ. However, since δ is tiny, 1/δ must be HUGE.
Example 1.5.
Negative inﬁnitesimals
In ordinary algebra, if ∆> 0, then −∆< 0, so we can apply this rule to the inﬁnitesimal
number δ and conclude that −δ < 0, since δ > 0.
Example 1.6.
Orders of inﬁnitesimals
In ordinary algebra, if 0 < ∆< 1, then 0 < ∆2 < ∆, so 0 < δ2 < δ.
We want you to formulate this more exactly in the next exercise.
Just assume δ is
very small, but positive. Formulate what you want to draw algebraically. Try some small
ordinary numbers as examples, like δ = 0.01. Plot δ at unit scale and place δ2 accurately
on the ﬁgure.
Example 1.7.
Inﬁnitely large numbers

Small, Medium and Large Numbers
13
For real numbers if 0 < ∆< 1/n then n < 1/∆. Since δ is inﬁnitesimal, 0 < δ < 1/n
for every natural number n = 1, 2, 3, . . . Using ordinary rules of algebra, but substituting
the inﬁnitesimal δ, we see that H = 1/δ > n is larger than any natural number n (or is
“inﬁnitely large”), that is, 1 < 2 < 3 < . . . < n < H, for every natural number n. We can
“see” inﬁnitely large numbers by turning the microscope around and looking in the other
end.
The new algebraic rules are the ones that tell us when quantities are inﬁnitely close,
a ≈b. Such rules, of course, do not follow from rules about ordinary high school numbers,
but the rules are intuitive and simple. More important, they let us ‘calculate limits’ directly.
Theorem 1.12.
Computation Rules for Finite and Inﬁnitesimal Numbers
(a)
If p and q are ﬁnite, so are p + q and p · q.
(b)
If ε and δ are inﬁnitesimal, so is ε + δ.
(c)
If δ ≈0 and q is ﬁnite, then q · δ ≈0. (ﬁnite x infsml = infsml)
(d)
1/0 is still undeﬁned and 1/x is inﬁnitely large only when x ≈0.
To understand these rules, just think of p and q as “ﬁxed,” if large, and δ as being as
small as you please (but not zero). It is not hard to give formal proofs from the deﬁnitions
above, but this intuitive understanding is more important. The last rule can be “seen” on
the graph of y = 1/x. Look at the graph and move down near the values x ≈0.
x
y
Figure 1.2: y = 1/x
Proof:
We prove rule (c) and leave the others to the exercises. If q is ﬁnite, there is a natural
number m so that |q| < m. We want to show that |q · δ| < 1/n for any natural number n.
Since δ is inﬁnitesimal, we have |δ| < 1/(n · m). By Exercise 1.2.5, |q| · |δ| < m ·
1
n·m = 1
m.
Example 1.8.
y = x3 ⇒dy = 3x2 dx, for ﬁnite x
The error term in the increment of f[x] = x3, computed above is
ε = (δx[3x + δx])
If x is assumed ﬁnite, then 3x is also ﬁnite by the ﬁrst rule above. Since 3x and δx are ﬁnite,
so is the sum 3x + δx by that rule. The third rule, that says an inﬁnitesimal times a ﬁnite
number is inﬁnitesimal, now gives δx× ﬁnite = δx[3x + δx] = inﬁnitesimal, ε ≈0. This

14
1. Numbers
justiﬁes the local linearity of x3 at ﬁnite values of x, that is, we have used the approximation
rules to show that
f[x + δx] = f[x] + f ′[x] δx + ε δx
with ε ≈0 whenever δx ≈0 and x is ﬁnite, where f[x] = x3 and f ′[x] = 3 x2.
Exercise set 1.4
1. Draw the view of the ideal number line when viewed under an inﬁnitesimal microscope
of power 1/δ. Which number appears unit size? How big does δ2 appear at this scale?
Where do the numbers δ and δ3 appear on a plot of magniﬁcation 1/δ2?
2. Backwards microscopes or compression
Draw the view of the new number line when viewed under an inﬁnitesimal microscope
with its magniﬁcation reversed to power δ (not 1/δ). What size does the inﬁnitely large
number H (HUGE) appear to be? What size does the ﬁnite (ordinary) number m = 109
appear to be? Can you draw the number H2 on the plot?
3. y = xp ⇒dy = p xp−1 dx, p = 1, 2, 3, . . .
For each f[x] = xp below:
(a) Compute f[x + δx] −f[x] and simplify, writing the increment equation:
f[x + δx] −f[x] = f ′[x] · δx + ε · δx
= [term in x but not δx]δx + [observed microscopic error]δx
Notice that we can solve the increment equation for ε = f[x + δx] −f[x]
δx
−f ′[x]
(b) Show that ε ≈0 if δx ≈0 and x is ﬁnite. Does x need to be ﬁnite, or can it be
any hyperreal number and still have ε ≈0?
(1) If f[x] = x1, then f ′[x] = 1x0 = 1 and ε = 0.
(2) If f[x] = x2, then f ′[x] = 2x and ε = δx.
(3) If f[x] = x3, then f ′[x] = 3x2 and ε = (3x + δx)δx.
(4) If f[x] = x4, then f ′[x] = 4x3 and ε = (6x2 + 4xδx + δx2)δx.
(5) If f[x] = x5, then f ′[x] = 5x4 and ε = (10x3 + 10x2δx + 5xδx2 + δx3)δx.
4. Exceptional Numbers and the Derivative of y = 1
x
(a) Let f[x] = 1/x and show that
f[x + δx] −f[x]
δx
=
−1
x(x + δx)
(b) Compute
ε =
−1
x(x + δx) + 1
x2 = δx ·
1
x2(x + δx)
(c) Show that this gives
f[x + δx] −f[x] = f ′[x] · δx + ε · δx
when f ′[x] = −1/x2.
(d) Show that ε ≈0 provided x is NOT inﬁnitesimal (and in particular is not zero.)

Small, Medium and Large Numbers
15
5. Exceptional Numbers and the Derivative of y = √x
(a) Let f[x] = √x and compute
f[x + δx] −f[x] =
1
√
x + δx + √x
(b) Compute
ε =
1
√
x + δx + √x −
1
2√x =
−1
2√x(
√
x + δx + √x)2 · δx
(c) Show that this gives
f[x + δx] −f[x] = f ′[x] · δx + ε · δx
when f ′[x] =
1
2√x.
(d) Show that ε ≈0 provided x is positive and NOT inﬁnitesimal (and in particular
is not zero.)
6. Prove the remaining parts of Theorem 1.12.

16
1. Numbers

CHAPTER
2
Functional Identities
In high school you learned that trig functions satisfy certain iden-
tities or that logarithms have certain “properties.” This chapter
extends the idea of functional identities from speciﬁc cases to a
deﬁning property of an unknown function.
The use of “unknown functions” is of fundamental importance in calculus, and other
branches of mathematics and science. For example, diﬀerential equations can be viewed as
identities for unknown functions.
One reason that students sometimes have diﬃculty understanding the meaning of deriva-
tives or even the general rules for ﬁnding derivatives is that those things involve equations in
unknown functions. The symbolic rules for diﬀerentiation and the increment approximation
deﬁning derivatives involve unknown functions. It is important for you to get used to this
“higher type variable,” an unknown function. This chapter can form a bridge between the
speciﬁc identities of high school and the unknown function variables from rules of calculus
and diﬀerential equations.
2.1
Speciﬁc Functional Identities
All the the identities you need to recall from high school are:
(Cos[x])2 + (Sin[x])2 = 1
CircleIden
Cos[x + y] = Cos[x] Cos[y] −Sin[x] Sin[y]
CosSum
Sin[x + y] = Sin[x] Cos[y] + Sin[y] Cos[x]
SinSum
bx+y = bx by
ExpSum
(bx)y = bx·y
RepeatedExp
Log[x · y] = Log[x] + Log[y]
LogProd
Log[xp] = p Log[x]
LogPower
but you must be able to use these identities. Some practice exercises using these familiar
identities are given in main text CD Chapter 28.
17

18
2. Functional Identities
2.2
General Functional Identities
A general functional identity is an equation which is satisﬁed by an unknown
function (or a number of functions) over its domain.
The function
f[x] = 2x
satisﬁes f[x + y] = 2(x+y) = 2x2y = f[x]f[y], so eliminating the two middle terms, we see
that the function f[x] = 2x satisﬁes the functional identity
f[x + y] = f[x] f[y]
(ExpSum)
It is important to pay attention to the variable or variables in a functional identity. In order
for an equation involving a function to be a functional identity, the equation must be valid for
all values of the variables in question. Equation (ExpSum) above is satisﬁed by the function
f[x] = 2x for all x and y. For the function f[x] = x, it is true that f[2 + 2] = f[2]f[2], but
f[3 + 1] ̸= f[3]f[1], so = x does not satisfy functional identity (ExpSum).
Functional identities are a sort of ‘higher laws of algebra.’ Observe the notational simi-
larity between the distributive law for multiplication over addition,
m · (x + y) = m · x + m · y
and the additive functional identity
f[x + y] = f[x] + f[y]
(Additive)
Most functions f[x] do not satisfy the additive identity. For example,
1
x + y ̸= 1
x + 1
y
and
√x + y ̸= √x + √y
The fact that these are not identities means that for some choices of x and y in the domains
of the respective functions f[x] = 1/x and f[x] = √x, the two sides are not equal. You
will show below that the only diﬀerentiable functions that do satisfy the additive functional
identity are the functions f[x] = m · x. In other words, the additive functional identity is
nearly equivalent to the distributive law; the only unknown (diﬀerentiable) function that
satisﬁes it is multiplication. Other functional identities such as the 7 given at the start of
this chapter capture the most important features of the functions that satisfy the respective
identities. For example, the pair of functions f[x] = 1/x and g[x] = √x do not satisfy the
addition formula for the sine function, either.
Example 2.1.
The Microscope Equation
The “microscope equation” deﬁning the diﬀerentiability of a function f[x] (see Chapter
5 of the text),
f[x + δx] = f[x] + f ′[x] · δx + ε · δx
(Micro)

General Functional Identities
19
with ε ≈0 if δx ≈0, is similar to a functional identity in that it involves an unknown
function f[x] and its related unknown derivative function f ′[x]. It “relates” the function
f[x] to its derivative df
dx = f ′[x].
You should think of (Micro) as the deﬁnition of the derivative of f[x] at a given x, but
also keep in mind that (Micro) is the deﬁnition of the derivative of any function. If we let
f[x] vary over a number of diﬀerent functions, we get diﬀerent derivatives. The equation
(Micro) can be viewed as an equation in which the function, f[x], is the variable input, and
the output is the derivative df
dx.
To make this idea clearer, we rewrite (Micro) by solving for df
dx: )
df
dx = f[x + δx] −f[x]
δx
−ε
or
df
dx = lim
∆x→0
f[x + δx] −f[x]
∆x
If we plug in the “input” function f[x] = x2 into this equation, the output is df
dx = 2x. If we
plug in the “input” function f[x] = Log[x], the output is df
dx = 1
x. The microscope equation
involves unknown functions, but strictly speaking, it is not a functional identity, because
of the error term ε (or the limit which can be used to formalize the error). It is only an
approximate identity.
Example 2.2.
Rules of Diﬀerentiation
The various “diﬀerentiation rules,” the Superposition Rule, the Product Rule and the
Chain Rule (from Chapter 6 of the text) are functional identities relating functions and
their derivatives. For example, the Product Rule states:
d(f[x]g[x])
dx
= df
dxg[x] + f[x]dg
dx
We can think of f[x] and g[x] as “variables” which vary by simply choosing diﬀerent actual
functions for f[x] and g[x]. Then the Product Rule yields an identity between the choices
of f[x] and g[x], and their derivatives. For example, choosing f[x] = x2 and g[x] = Log[x]
and plugging into the Product Rule yields
d(x2 Log[x])
dx
= 2x Log[x] + x2 1
x
Choosing f[x] = x3 and g[x] = Exp[x] and plugging into the Product Rule yields
d(x3 Exp[x])
dx
= 3x2 Exp[x] + x3 Exp[x]
If we choose f[x] = x5, but do not make a speciﬁc choice for g[x], plugging into the
Product Rule will yield
d(x5g[x])
dx
= 5x4g[x] + x5 dg
dx
The goal of this chapter is to extend your thinking to identities in unknown functions.

20
2. Functional Identities
Exercise set 2.2
1.
(a) Verify that for any positive number, b, the function f[x] = bx satisﬁes the func-
tional identity (ExpSum) above for all x and y.
(b) Is (ExpSum) valid (for all x and y) for the function f[x] = x2 or f[x] = x3?
Justify your answer.
2. Deﬁne f[x] = Log[x] where x is any positive number. Why does this f[x] satisfy the
functional identities
f[x · y] = f[x] + f[y]
(LogProd)
and
f[xk] = kf[x]
(LogPower)
where x, y, and k are variables. What restrictions should be placed on x and y for the
above equations to be valid? What is the domain of the logarithm?
3. Find values of x and y so that the left and right sides of each of the additive formulas
for 1/x and √x above are not equal.
4. Show that 1/x and √x also do not satisfy the identity (SinSum), that is,
1
x + y = 1
x
√y + √x 1
y
is false for some choices of x and y in the domains of these functions.
5.
(a) Suppose that f[x] is an unknown function which is known to satisfy (LogProd)
(so f[x] behaves “like” Log[x], but we don’t know if f[x] is Log[x]), and suppose
that f[0] is a well-deﬁned number (even though we don’t specify exactly what f[0]
is). Show that this function f[x] must be the zero function, that is show that
f[x] = 0 for every x. (Hint: Use the fact that 0 ∗x = 0).
(b) Suppose that f[x] is an unknown function which is known to satisfy (LogPower)
for all x > 0 and all k. Show that f[1] must equal 0, f[1] = 0. (Hint: Fix x = 1,
and try diﬀerent values of k).
6.
(a) Let m and b be ﬁxed numbers and deﬁne
f[x] = m x + b
Verify that if b = 0, the above function satisﬁes the functional identity
f[x] = x f[1]
(Mult)
for all x and that if b ̸= 0, f[x] will not satisfy (Mult) for all x (that is, given a
nonzero b, there will be at least one x for which (Mult) is not true).
(b) Prove that any function satisfying (Mult) also automatically satisﬁes the two
functional identities
f[x + y] = f[x] + f[y]
(Additive)
and
f[x y] = x f[y]
(Multiplicative)
for all x and y.

The Function Extension Axiom
21
(c) Suppose f[x] is a function which satisﬁes (Mult) (and for now that is the only
thing you know about f[x]). Prove that f[x] must be of the form f[x] = m · x,
for some ﬁxed number m (this is almost obvious).
(d) Prove that a general power function, f[x] = mxk where k is a positve integer and
m is a ﬁxed number, will not satisfy (Mult) for all x if k ̸= 1, (that is, if k ̸= 1,
there will be at least one x for which (Mult) is not true).
(e) Prove that f[x] = Sin[x] does not satisfy the additive identity.
(f) Prove that f[x] = 2x does not satisfy the additive identity.
7.
(a) Let f[x] and g[x] be unknown functions which are known to satisfy f[1] = 2,
df
dx(1) = 3, g(1) = −3, dg
dx(1) = 4. Let h(x) = f[x]g[x]. Compute dh
dx(1).
(b) Diﬀerentiate the general Product Rule identity to get a formula for
d2(fg)
dx2
Use your rule to compute d2(h)
dx2 (1) if d2(f)
dx2 (1) = 5 and d2(g)
dx2 (1) = −2, using other
values from part 1 of this exercise.
2.3
The Function Extension Axiom
This section shows that all real functions have hyperreal extensions that are
“natural” from the point of view of properties of the original function.
Roughly speaking, the Function Extension Axiom for hyperreal numbers says that the
natural extension of any real function obeys the same functional identities and inequalities
as the original function. In Example 2.7, we use the identity,
f[x + δx] = f[x] · f[δx]
with x hyperreal and δx ≈0 inﬁnitesimal where f[x] is a real function satisfying f[x + y] =
f[x] · f[y]. The reason this statement of the Function Extension Axiom is ‘rough’ is because
we need to know precisely which values of the variables are permitted. Logically, we can
express the axiom in a way that covers all cases at one time, but this is a little complicated
so we will precede that statement with some important examples.
The Function Extension Axiom is stated so that we can apply it to the Log identity in
the form of the implication
(x > 0 & y > 0) ⇒Log[x] and Log[y] are deﬁned and Log[x · y] = Log[x] + Log[y]
The natural extension of Log[·] is deﬁned for all positive hyperreals and its identities hold for
hyperreal numbers satisfying x > 0 and y > 0. The other identities hold for all hyperreal x
and y. To make all such statements implications, we can state the exponential sum equation
as
(x = x
&
y = y)
⇒
ex+y = ex · ey

22
2. Functional Identities
The diﬀerential
d(Sin[θ]) = Cos[θ] dθ
is a notational summary of the valid approximation
Sin[θ + δθ] −Sin[θ] = Cos[θ]δθ + ε · δθ
where ε ≈0 when δθ ≈0. The derivation of this approximation based on magnifying a
circle (given in a CD Section of Chapter 5 of the text) can be made precise by using the
Function Extension Axiom in the place where it locates (Cos[θ +δθ], Sin[θ +δθ]) on the unit
circle. This is simply using the extension of the (CircleIden) identity to hyperreal numbers,
(Cos[θ + δθ])2 + (Sin[θ + δθ])2 = 1.
Logical Real Expressions, Formulas and Statements
Logical real expressions are built up from numbers and variables using functions. Here
is the precise deﬁnition.
(a) A real number is a real expression.
(b) A variable standing alone is a real expression.
(c) If E1, E2, · · · , En are a real expressions and f[x1, x2, · · · , xn] is a real function of n
variables, then f[E1, E2, · · · , En] is a real expression.
A logical real formula is one of the following:
(a) An equation between real expressions, E1 = E2.
(b) An inequality between real expressions, E1 < E2, E1 ≤E2, E1 > E2, E1 ≥E2, or
E1 ̸= E2.
(c) A statement of the form “E is deﬁned” or of the form “E is undeﬁned.”
Let S and T be ﬁnite sets of real formulas. A logical real statement is an implication of the
form,
S ⇒T
or “whenever every formula in S is true, then every formula in T is true.”
Logical real statements allow us to formalize statements like: “Every point in the square
below lies in the circle below.” Formalizing the statement does not make it true or false.
Consider the ﬁgure below.
x
y
Figure 2.1: Square and Circle

The Function Extension Axiom
23
The inside of the square shown can be described formally as the set of points satisfying the
equations in the set S = { 0 ≤x, 0 ≤y, x ≤1.2, y ≤1.2 }. The inside of the circle shown can
be deﬁned as the set of points satisfying the single equation T = { (x−1)2+(y−1)2 ≤1.62 }.
This is the circle of radius 1.6 centered at the point (1, 1). The logical real statement S ⇒T
means that every point inside the square lies inside the circle. The statement is true for
every real x and y. First of all, it is clear by visual inspection. Second, points (x, y) that
make one or more of the formulas in S false produce a false premise, so no matter whether
or not they lie in the circle, the implication is logically true (if uninteresting).
The logical real statement T ⇒S is a valid logical statement, but it is false since it
says every point inside the circle lies inside the square. Naturally, only true logical real
statements transfer to the hyperreal numbers.
Axiom 2.1.
The Function Extension Axiom
Every logical real statement that holds for all real numbers also holds for all hyper-
real numbers when the real functions in the statement are replaced by their natural
extensions.
The Function Extension Axiom establishes the 5 identities for all hyperreal numbers,
because x = x and y = y always holds. Here is an example.
Example 2.3.
The Extended Addition Formula for Sine
S = {x = x, y = y} ⇒T = { Sin[x] is deﬁned ,
Sin[y] is deﬁned ,
Cos[x] is deﬁned ,
Cos[y] is deﬁned ,
Sin[x + y] = Sin[x] Cos[y] + Sin[y] Cos[x]}
The informal interpretation of the extended identity is that the addition formula for sine
holds for all hyperreals.
Example 2.4.
The Extended Formulas for Log
We may take S to be formulas x > 0, y > 0 and p = p and T to be the functional
identities for the natural log plus the statements “Log[ ] is deﬁned,” etc. The Function
Extension Axiom establishes that log is deﬁned for positive hyperreals and satisﬁes the two
basic log identities for positive hyperreals.
Example 2.5.
Abstract Uses of Function Extension
There are two general uses of the Function Extension Axiom that underlie most of the
theoretical problems in calculus.
These involve extension of the discrete maximum and
extension of ﬁnite summation. The proof of the Extreme Value Theorem 4.4 below uses a
hyperﬁnite maximum, while the proof of the Fundamental Theorem of Integral Calculus 5.1
uses hyperﬁnite summation.
Equivalence of inﬁnitesimal conditions for derivatives or limits and the “epsilon - delta”
real number conditions are usually proved by using an auxiliary real function as in the proof
of the limit equivalence Theorem 3.2.

24
2. Functional Identities
Example 2.6.
The Increment Approximation
Note: The increment approximation
f[x + δx] = f[x] + f ′[x] · δx + ε · δx
with ε ≈0 for δx ≈0 and the simpler statement
δx ≈0
⇒
f ′[x] ≈f[x] + δx) −f[x]
δx
are not real logical expressions, because they contain the relation ≈, which is not included
in the formation rules for logical real statements. (The relation ≈does not apply to ordinary
real numbers, except in the trivial case x = y.)
For example, if θ is any hyperreal and δθ ≈0, then
Sin[θ + δθ] = Sin[θ] Cos[δθ] + Sin[δθ] Cos[θ]
by the natural extension of the addition formula for sine above. Notice that the natural
extension does NOT tell us the interesting and important estimate
Sin[θ + δθ] = Sin[θ] + δθ · Cos[θ] + ε · δθ
with ε ≈0 when δθ ≈0. (I.e., Cos[δθ] = 1 + ιδθ and Sin[δθ]/δθ ≈1 are true, but not real
logical statements we can derive just from natural extensions.)
Exercise set 2.3
1. Write a formal logical real statement S ⇒T that says, “Every point inside the circle
of radius 2, centered at (−1, 3) lies outside the square with sides x = 0, y = 0, x = 1,
y = −1. Draw a ﬁgure and decide whether or not this is a true statement for all real
values of the variables.
2. Write a formal logical real statement S ⇒T that is equivalent to each of the functional
identities on the ﬁrst page of the chapter and interpret the extended identities in the
hyperreals.
2.4
Additive Functions
An identity for an unknown function together with the increment approxi-
mation combine to give a speciﬁc kind of function. The two ideas combine
to give a diﬀerential equation. After you have learned about the calculus
of the natural exponential function in Chapter 8 of the text, you will easily
understand the exact solution of the problem of this section.

Additive Functions
25
In the early 1800s, Cauchy asked the question: Must a function satisfying
f[x + y] = f[x] + f[y]
(Additive)
be of the form f[x] = m·x? This was not solved until the late 1800s by Hamel. The answer
is “No.” There are some very strange functions satisfying the additive identity that are not
simple linear functions. However, these strange functions are not diﬀerentiable. We will
solve a variant of Cauchy’s problem for diﬀerentiable functions.
Example 2.7.
A Variation on Cauchy’s Problem
Suppose an unknown diﬀerentiable function f[x] satisﬁes the (ExpSum) identity for all
x and y,
f[x + y] = f[x] · f[y]
Does the function have to be f[x] = bx for some positive b?
Since our unknown function f[x] satisﬁes the (ExpSum) identity and is diﬀerentiable,
both of the following equations must hold:
f[x + y] = f[x] · f[y]
f[x + δx] = f[x] + f ′[x] · δx + ε · δx
We let y = δx in the ﬁrst identity to compare it with the increment approximation,
f[x + δx] = f[x] · f[δx]
f[x + δx] = f[x] + f ′[x] · δx + ε · δx
so
f[x] · f[δx] = f[x] + f ′[x] · δx + ε · δx
f[x][f[δx] −1] = f ′[x] · δx + ε · δx
f ′[x] = f[x]f[δx] −1
δx
−ε
or
f ′[x]
f[x] = f[δx] −1
δx
−ε
with ε ≈0 when δx ≈0. The identity still holds with hyperreal inputs by the Function
Extension Axiom. Since the left side of the last equation depends only on x and the right
hand side does not depend on x at all, we must have f[δx]−1
δx
≈k, a constant, or f[∆x]−1
∆x
→k
as ∆x →0. In other words, a diﬀerentiable function that satisﬁes the (ExpSum) identity
satisﬁes the diﬀerential equation
df
dx = k f
What is the value of our unknown function at zero, f[0]? For any x and y = 0, we have
f[x] = f[x + 0] = f[x] · f[0]
so unless f[x] = 0 for all x, we must have f[0] = 1.
One of the main morals of this course is that if you know:
(1) where a quantity starts,

26
2. Functional Identities
and
(2) how a quantity changes,
then you can compute subsequent values of the quantity. In this problem we have found
(1) f[0] = 1 and (2) df
dx = k f. We can use this information with the computer to calculate
values of our unknown function f[x]. The unique symbolic solution to
f[0] = 1
df
dx = k f
is
f[x] = ek x
The identity (Repeated Exp) allows us to write this as
f[x] = ek x = (ek)x = bx
where b = ek. In other words, we have shown that the only diﬀerentiable functions that
satisfy the (ExpSum) identity are the ones you know from high school, bx.
Problem 2.1. Smooth Additive Functions ARE Linear
H
Suppose an unknown function is additive and diﬀerentiable, so it satisﬁes both
f[x + δx] = f[x] + f[δx]
(Additive)
and
f[x + δx] = f[x] + f ′[x] · δx + ε · δx
(Micro)
Solve these two equations for f ′[x] and argue that since the right side of the equation does
not depend on x, f ′[x] must be constant. (Or f[∆x]
∆x
→f ′[x1] and f[∆x]
∆x
→f ′[x2], but since
the left hand side is the same, f ′[x1] = f ′[x2].)
What is the value of f[0] if f[x] satisﬁes the additive identity?
The derivative of an unknown function f[x] is constant and f[0] = 0, what can we say
about the function? (Hint: Sketch its graph.)
N
A project explores this symbolic kind of ‘linearity’ and the microscope equation from
another angle.
2.5
The Motion of a Pendulum
Diﬀerential equations are the most common functional identities which arise
in applications of mathematics to solving “real world” problems. One of the
very important points in this regard is that you can often obtain signiﬁcant
information about a function if you know a diﬀerential equation the function
satisﬁes, even if you do not know an exact formula for the function.

The Motion of a Pendulum
27
For example, suppose you know a function θ[t] satisﬁes the diﬀerential equation
d2θ
dt2 = Sin[θ[t]]
This equation arises in the study of the motion of a pendulum and θ[t] does not have a
closed form expression. (There is no formula for θ[t].) Suppose you know θ[0] = π
2 . Then
the diﬀerential equation forces
d2θ
dt2 [0] = Sin[θ[0]] = Sin[π
2 ] = 1
We can also use the diﬀerential equation for θ to get information about the higher deriva-
tives of θ[t].
Say we know that dθ
dt [0] = 2. Diﬀerentiating both sides of the diﬀerential
equation yields
d3θ
dt3 = Cos[θ[t]]dθ
dt
by the Chain Rule. Using the above information, we conclude that
d3θ
dt3 [0] = Cos[θ[0]]dθ
dt [0] = Cos[π
2 ]2 = 0
Problem 2.2.
H
Derive a formula for d4θ
dt4 and prove that d4θ
dt4 [0] = 1.
N

28
2. Functional Identities

-4
-2
2
4
w
-4
-2
2
4
x
Part 2
Limits

30

CHAPTER
3
The Theory of Limits
The intuitive notion of limit is that a quantity gets close to a “lim-
iting” value as another quantity approaches a value. This chapter
deﬁnes two important kinds of limits both with real numbers and
with hyperreal numbers. The chapter also gives many computations
of limits.
A basic fact about the sine function is
lim
x→0
Sin[x]
x
= 1
Notice that the limiting expression Sin[x]
x
is deﬁned for 0 < |x−0| < 1, but not if x = 0. The
sine limit above is a diﬃcult and interesting one. The important topic of this chapter is,
“What does the limit expression mean?” Rather than the more “practical” question, “How
do I compute a limit?”
Here is a simpler limit where we can see what is being approached.
lim
x→1
x2 −1
x −1 = 2
While this limit expression is also only deﬁned for 0 < |x −1|, or x ̸= 1, the mystery is
easily resolved with a little algebra,
x2 −1
x −1 = (x −1)(x + 1)
(x −1)
= x + 1
So,
lim
x→1
x2 −1
x −1 = lim
x→1(x + 1) = 2
The limit limx→1(x + 1) = 2 is so obvious as to not need a technical deﬁnition. If x is
nearly 1, then x + 1 is nearly 1 + 1 = 2. So, while this simple example illustrates that the
original expression does get closer and closer to 2 as x gets closer and closer to 1, it skirts
the issue of “how close?”
31

32
3. The Theory of Limits
3.1
Plain Limits
Technically, there are two equivalent ways to deﬁne the simple continuous
variable limit as follows.
Deﬁnition 3.1.
Limit
Let f[x] be a real valued function deﬁned for 0 < |x−a| < ∆with ∆a ﬁxed positive
real number. We say
lim
x→a f[x] = b
when either of the equivalent the conditions of Theorem 3.2 hold.
Theorem 3.2.
Limit of a Real Variable
Let f[x] be a real valued function deﬁned for 0 < |x−a| < ∆with ∆a ﬁxed positive
real number. Let b be a real number. Then the following are equivalent:
(a)
Whenever the hyperreal number x satisﬁes 0 < |x −a| ≈0, the natural
extension function satisﬁes
f[x] ≈b
(b)
For every accuracy tolerance θ there is a suﬃciently small positive real num-
ber γ such that if the real number x satisﬁes 0 < |x −a| < γ, then
|f[x] −b| < θ
Proof:
We show that (a) ⇒(b) by proving that not (b) implies not (a), the contrapositive.
Assume (b) fails. Then there is a real θ > 0 such that for every real γ > 0 there is a real x
satisfying 0 < |x −a| < γ and |f[x] −b| ≥θ. Let X[γ] = x be a real function that chooses
such an x for a particular γ. Then we have the equivalence
{γ > 0} ⇔{X[γ] is deﬁned , 0 < |X[γ] −a| < γ, |f[X[γ] −b| ≥θ}
By the Function Extension Axiom 2.1 this equivalence holds for hyperreal numbers and
the natural extensions of the real functions X[·] and f[·]. In particular, choose a positive
inﬁnitesimal γ and apply the equivalence. We have 0 < |X[γ] −a| < γ and |f[X[γ] −b| > θ
and θ is a positive real number. Hence, f[X[γ]] is not inﬁnitely close to b, proving not (a)
and completing the proof that (a) implies (b).
Conversely, suppose that (b) holds. Then for every positive real θ, there is a positive real
γ such that 0 < |x −a| < γ implies |f[x] −b| < θ. By the Function Extension Axiom 2.1,
this implication holds for hyperreal numbers. If ξ ≈a, then 0 < |ξ −a| < γ for every real γ,
so |f[ξ] −b| < θ for every real positive θ. In other words, f[ξ] ≈b, showing that (b) implies
(a) and completing the proof of the theorem.
Example 3.1.
Condition (a) Helps Prove a Limit

Plain Limits
33
Suppose we wish to prove completely rigorously that
lim
∆x→0
1
2(2 + ∆x) = 1
4
The intuitive limit computation of just setting ∆x = 0 is one way to “see” the answer,
lim
∆x→0
1
2(2 + ∆x) =
1
2(2 + 0 = 1
4
but this certainly does not demonstrate the “epsilon - delta” condition (b).
Condition (a) is almost as easy to establish as the intuitive limit computation. We wish
to show that when δx ≈0
1
2(2 + δx) ≈1
4
Subtract and do some algebra,
1
2(2 + δx) −1
4 =
2
4(2 + δx) −(2 + δx)
4(2 + δx)
=
−δx
4(2 + δx) = δx ·
−1
4(2 + δx)
We complete the proof using the computation rules of Theorem 1.12. The fraction −1/(4(2+
δx)) is ﬁnite because 4(2 + δx) ≈8 is not inﬁnitesimal. The inﬁnitesimal δx times a ﬁnite
number is inﬁnitesimal.
1
2(2 + δx) −1
4 ≈0
1
2(2 + δx) ≈1
4
This is a complete rigorous proof of the limit. Theorem 3.2 shows that the “epsilon - delta”
condition (b) holds.
Exercise set 3.1
1. Prove rigorously that the limit lim∆x→0
1
3(3+∆x) = 1
9. Use your choice of condition (a)
or condition (b) from Theorem 3.2.
2. Prove rigorously that the limit lim∆x→0
1
√
4+∆x+
√
4 = 1
4. Use your choice of condition
(a) or condition (b) from Theorem 3.2.
3. The limit limx→0
Sin[x]
x
= 1 means that sine of a small value is nearly equal to the value,
and near in a strong sense. Suppose the natural extension of a function f[x] satisﬁes
f[ξ] ≈0 whenever ξ ≈0. Does this mean that limx→0
f[x]
x
exists? (HINT: What is
limx→0
√x? What is √ξ/ξ?)
4. Assume that the derivative of sine is cosine and use the increment approximation
f[x + δx] −f[x] = f ′[x] · δx + ε · δx

34
3. The Theory of Limits
with ε ≈0 when δx ≈0, to prove the limit limx→0
Sin[x]
x
= 1. (It means essentially the
same thing as the derivative of sine at zero is 1. HINT: Take x = 0 and δx = x in the
increment approximation.)
3.2
Function Limits
Many limits in calculus are limits of functions. For example, the derivative
is a limit and the derivative of x3 is the limit function 3 x2. This section
deﬁnes the function limits used in diﬀerentiation theory.
Example 3.2.
A Function Limit
The derivative of x3 is 3 x2, a function. When we compute the derivative we use the limit
lim
∆x→0
(x + ∆x)3 −x3
∆x
Again, the limiting expression is undeﬁned at ∆x = 0. Algebra makes the limit intuitively
clear,
(x + ∆x)3 −x3
∆x
= (x3 + 3 x2 ∆x + 3 x ∆x2 + ∆x3) −x3
∆x
= 3 x2 + 3 x ∆x + ∆x2
The terms with ∆x tend to zero as ∆x tends to zero.
lim
∆x→0
(x + ∆x)3 −x3
∆x
= lim
∆x→0(3 x2 + 3 x ∆x + ∆x2) = 3 x2
This is clear without a lot of elaborate estimation, but there is an important point that
might be missed if you don’t remember that you are taking the limit of a function. The
graph of the approximating function approaches the graph of the derivative function. This
more powerful approximation (than that just a particular value of x) makes much of the
theory of calculus clearer and more intuitive than a ﬁxed x approach. Intuitively, it is no
harder than the ﬁxed x approach and inﬁnitesimals give us a way to establish the “uniform”
tolerances with computations almost like the intuitive approach.
Deﬁnition 3.3.
Locally Uniform Function Limit
Let f[x] and F[x, ∆x] be real valued functions deﬁned when x is in a real interval
(a, b) and 0 < ∆x < ∆with ∆a ﬁxed positive real number. We say
lim
∆x→0 F[x, ∆x] = f[x]
uniformly on compact subintervals of (a, b), or “locally uniformly” when one of the
equivalent the conditions of Theorem 3.4 holds.

Function Limits
35
Theorem 3.4.
Limit of a Real Function
Let f[x] and F[x, ∆x] be real valued functions deﬁned when x is in a real interval
(a, b) and 0 < ∆x < ∆with ∆a ﬁxed positive real number. Then the following are
equivalent:
(a)
Whenever the hyperreal numbers δx and x satisfy 0 < |δx| ≈0, x is ﬁnite,
and a < x < b with neither x ≈a nor x ≈b, the natural extension functions
satisfy
F[x, δx] ≈f[x]
(b)
For every accuracy tolerance θ and every real α and β in (a, b), there is
a suﬃciently small positive real number γ such that if the real number ∆x
satisﬁes 0 < |∆x| < γ and the real number x satisﬁes α ≤x ≤β, then
|F[x, ∆x] −f[x]| < θ
Proof:
First, we prove not (b) implies not (a). If (b) fails, there are real α and β, a < α < β < b,
and real positive θ such that for every real positive γ there are x and ∆x satisfying
0 < ∆x < γ,
α ≤x ≤β,
|F[x, ∆x] −f[x]| ≥θ
Deﬁne real functions X[γ] and DX[γ] that select such values of x and ∆x,
0 < DX[γ] < γ,
α ≤X[γ] ≤β,
|F[X[γ], DX[γ]] −f[X[γ]]| ≥θ
Now apply the Function Extension Axiom 2.1 to the equivalent sets of inequalities,
{γ > 0} ⇔{0 < DX[γ] < γ,
α ≤X[γ] ≤β,
|F[X[γ], DX[γ]] −f[X[γ]]| ≥θ}
Choose an inﬁnitesimal γ ≈0 and let x = X[γ] and δx = DX[γ]. Then
0 < δx < γ ≈0,
α ≤x ≤β,
|F[x, δx] −f[x]| ≥θ
so F[x, δx] −f[x] is not inﬁnitesimal showing not (a) holds and proving (a) implies (b).
Now we prove that (b) implies (a). Let δx be a non zero inﬁnitesimal and let x satisfy
the conditions of (a). We show that F[x, δx] ≈f[x] by showing that for any positive real θ,
|F[x, δx] −f[x]| < θ. Fix any one such value of θ.
Since x is ﬁnite and not inﬁnitely near a nor b, there are real values α and β satisfying
a < α < β < b. Apply condition (b) to these α and β together with θ ﬁxed above. Then
there is a positive real γ so that for every real ξ and ∆x satisfying 0 < |∆x| < γ and
α ≤ξ ≤β, we have |F[ξ, ∆x] −f[ξ]| < θ. In other words, the following implication holds in
the real numbers,
{0 < |∆x| < γ, α ≤ξ ≤β} ⇒{|F[ξ, ∆x] −f[ξ]| < θ}
Apply the Function Extension Axiom 2.1 to see that the same implication holds in the
hyperreals. Moreover, x = ξ and nonzero ∆x = δx ≈0 satisfy the left hand side of the
implication, so the right side holds. Since θ was arbitrary, condition (a) is proved.
Example 3.3.
Computing Locally Uniform Limits

36
3. The Theory of Limits
The following limit is uniform on compact subintervals of (−∞, ∞).
lim
∆x→0
(x + ∆x)3 −x3
∆x
= lim
∆x→0(3 x2 + 3 x ∆x + ∆x2) = 3 x2
A complete rigorous proof based on condition (a) can be obtained with the computation
rules of Theorem 1.12. The diﬀerence is inﬁnitesimal
(3 x2 + 3 x δx + δx2) −3 x2 = (3 x + δx)δx
when δx is inﬁnitesimal. First, 3 x+δx is ﬁnite because a sum of ﬁnite numbers is ﬁnite. Sec-
ond, inﬁnitesimal times ﬁnite is inﬁnitesimal. This is a complete proof and by Theorem 3.4
shows that both conditions (b) and (c) also hold.
Exercise set 3.2
1. Prove rigorously that the locally uniform function limit lim∆x→0
1
x(x+∆x) =
1
x2 . Use
your choice of condition (a) or condition (b) from Theorem 3.4.
2. Prove rigorously that the locally uniform function limit lim∆x→0
1
√
x+∆x+√x =
1
2√x.
Use your choice of condition (a), condition (b), or condition (c) from Theorem 3.4.
3. Prove the following:
Theorem 3.5.
Locally Uniform Derivatives
Let f[x] and f ′[x] be real valued functions deﬁned when x is in a real interval
(a, b). Then the following are equivalent:
(a)
Whenever the hyperreal numbers δx and x satisfy δx ≈0, x is ﬁnite,
and a < x < b with neither x ≈a nor x ≈b, the natural extension
functions satisfy
f[x + δx] −f[x] = f ′[x] · δx + ε · δx
for ε ≈0.
(b)
For every accuracy tolerance θ and every real α and β in (a, b), there is
a suﬃciently small positive real number γ such that if the real number
∆x satisﬁes 0 < |∆x| < γ and the real number x satisﬁes α ≤x ≤β,
then

f[x + ∆x] −f[x]
∆x
−f ′[x]
 < θ
(c)
For every real c in (a, b),
lim
x→c,∆x→0
f[x + ∆x] −f[x]
∆x
= f ′[c]
That is, for every real c with a < c < b and every real positive θ,
there is a real positive γ such that if the real numbers x and ∆x satisfy
0 < ∆x < γ and 0 < |x −c| < γ, then | f[x+∆x]−f[x]
∆x
−f ′[c]| < θ.

Computation of Limits
37
3.3
Computation of Limits
Limits can be computed in a way that rigorously establishes them as results
by using the rules of Theorem 1.12.
Suppose we want to compute a limit like
lim
d→0
(x + d)2 −x2
d
First we observe that it does no good to substitute d = 0 into the expression, because we
get 0/0. We do some algebra,
(x + d)2 −x2
d
= x2 + 2 x d + d2 −x2
d
= 2 x d + d2
d
= 2 x + d
Now,
lim
d→0
(x + d)2 −x2
d
= lim
d→0 2 x + d = 2 x
because making d smaller and smaller makes the expression closer and closer to 2 x. The
rules of small, medium and large numbers given in Theorem 1.12 just formalize the kinds of
operations that work in such calculations. Theorem 3.2 and Theorem 3.4 show that these
rules establish the limits as rigorously proven facts.
Exercise 3.3.1 below contains a long list of drill questions that may be viewed as limit
computations. For example,
lim
d→0
1
d

1
b + d −1
b

=?
is just asking what happens as d becomes small. Another way to ask the question is
1
δ

1
b + δ −1
b

≈?
when
δ ≈0
The latter approach is well suited to direct computations and can be solved with the rules
of Theorem 1.12 that formalize our intuitive notions of small, medium and large numbers.
Following are some sample calculations with parameters a, b, c, δ, ε, H, K from Exer-
cise 3.3.1.
Example 3.4.
Inﬁnitesimal, Finite and Inﬁnite Computations
We are told that a ≈2 and b ≈5, so we may write a = 2 + ι and b = 5 + θ with ι ≈0
and θ ≈0. Now we compute b −a = 5 + θ −2 −ι = 5 −2 + (θ −ι) = 3 + (θ −ι) by rules
of algebra. The negative of an inﬁnitesimal is inﬁnitesimal and the sum of a positive and
negative inﬁnitesimal is inﬁnitesimal, hence θ −ι ≈0. This makes
b −a ≈3

38
3. The Theory of Limits
Another correct way to do this computation is the following
a ≈2
b ≈5
b −a ≈5 −2 = 3
However, this is NOT use of ordinary rules of algebra, because ordinary rules of algebra do
not refer to the inﬁnitely close relation ≈. This form of the computation incorporates the
fact that negatives of inﬁnitesimals are inﬁnitesimal and the fact that sums of inﬁnitesimals
are inﬁnitesimal.
Example 3.5.
Small, Medium and Large as Limits
The approximate computations can be re-phrased in terms of limits. We can replace the
occurrences of δ ≈0 and ε ≈0 by variables approaching zero and so forth. Let’s just do
this by change of alphabet, limd→0
for
δ ≈0
and
limα→2
for
a ≈2.
The computation b −a ≈3 can be viewed as the limit
lim
α→2,β→5 β −α = 3
The computation (2 −δ)/a ≈1 becomes
lim
d→0&α→2
2 −d
α
= 1
The computation
√a+δ−√a
δ
≈
1
2
√
2 becomes
lim
d→0&α→2
√
α + d −√α
d
=
1
2
√
2
Example 3.6.
Hyperreal Roots
When a ≈2 and c ≈−7, the Function Extension Axiom guarantees in particular that
√a is deﬁned and that √c is undeﬁned, since a > 0 is positive and c < 0 is negative. The
computation rules may be used to show that √a ≈
√
2, that is, we do not need any more
rules to show this. First, √a is ﬁnite, because a < 3 implies
√a <
√
3 < 2
by the Function Extension Axiom. Next,
√a −
√
2 = (√a −
√
2)(√a +
√
2)
√a +
√
2
=
a −2
√a +
√
2
= ι ·
1
√a +
√
2
an inﬁnitesimal times a ﬁnite number, by approximation rule (4). Finally, approximation
rule (3) shows
√a −
√
2 ≈0
or
√a ≈
√
2

Computation of Limits
39
Example 3.7.
A Limit of Square Root
The “epsilon - delta” proof (condition (b) of Theorem 3.2) of
lim
x→0
p
|x| = 0
is somewhat diﬃcult to prove. We establish the equivalent condition (a) as follows.
Let 0 < ξ ≈0 be a positive inﬁnitesimal. Since 0 ≥x implies √x is deﬁned and positive,
The Function Extension Axiom 2.1 guarantees that √ξ is deﬁned and positive.
Suppose √ξ is not inﬁnitesimal. Then there is a positive real number 0 < a with a < √ξ.
Squaring and using the Function Extension Axiom on the property 0 < b < c implies 0 <
√
b < √c, we see that 0 < a2 < ξ contradicting the assumption that ξ ≈0 is inﬁnitesimal.
Example 3.8.
Inﬁnite Limits
We know that c + 7 ̸= 0 because we are given that c ̸= −7 and c ≈−7 or c = −7 + ι with
ι ≈0, but ι ̸= 0. This means that c + 7 = ι ̸= 0 and so
c + 7 ≈0
This, together with what we know about reciprocals of inﬁnitesimals tells us that
1
c + 7
is inﬁnite
We do not know if it is positive or negative; we simply weren’t told whether c < 7 or c > 7,
but only that c ≈7.
In this example, the limit formulation has the result
lim
γ→7
1
γ −7 does not exist or lim
γ→7

1
γ −7
 = +∞
The precise meaning of these symbols is as follows.
Deﬁnition 3.6.
Inﬁnite Limits
Let f[x] be a real function deﬁned for a neighborhood of a real number a, 0 <
|x −a| < ∆. We say
lim
x→a f[x] = ∞
provided that for every large positive real number B, there is a suﬃciently small
real tolerance, τ such that if 0 < |x −a| < τ then f[x] > B.
The symbol ∞means “gets bigger and bigger.”
This is equivalent to the following
hyperreal condition.
Theorem 3.7.
A Hyperreal Condition for Inﬁnite Limits
Let f[x] be a real function deﬁned for a neighborhood of a real number a, 0 <
|x −a| < ∆. The deﬁnition of limx→a f[x] = ∞is equivalent to the following.
For every hyperreal x inﬁnitely close to a, but distinct from it, the natural ex-
tension satisﬁes, f[x] is a positive inﬁnite hyperreal.
Proof: Left as an exercise below.
Example 3.9.
∞is NOT Hyperreal

40
3. The Theory of Limits
The symbol ∞cannot stand for a number because it does not obey the usual laws of
algebra. Viewed as a numerical equation ∞· ∞= ∞says that we must have ∞= 1 or
∞= 0, by ordinary rules of algebra. Since we want to retain the rules of algebra, ∞in the
sense of ‘very big’ can not be a hyperreal number.
Example 3.10.
An Inﬁnite Limit with Roots
The limit
lim
x→0
p
|x|
|x|
= +∞
Proof:
Let 0 < ξ ≈0. We know from the previous example that √ξ ≈0. We know from algebra
and the Function Extension Axiom that √ξ
ξ
= 1
√ξ
Using Theorem 1.12, we see that this expression is inﬁnitely large.
Example 3.11.
Indeterminate Forms
Even though arguments similar to the ones we have just done show that a + b + c ≈0 we
can not conclude that
1
a+b+c is deﬁned. For example, we might have a = 2 −δ, b = 5 + 3δ
and c = −7 −2δ. Then a ≈2, b ≈5 and c ≈−7, but a + b + c = 0. (Notice that it is true
that a + b + c ≈0.) In this case
1
a+b+c is not deﬁned. Other choices of the perturbations
might make a + b + c ̸= 0, so
1
a+b+c is deﬁned (and positive or negative inﬁnite) in some
cases, but not in others. This means that the value of
1
a + b + c
can not be determined knowing only that the sum is inﬁnitesimal.
In Webster’s unabridged dictionary, the term “indeterminate” has the following symbolic
characters along with the verbal deﬁnition
0
0,
∞
∞,
∞· 0,
1∞,
00,
∞0,
∞−∞
In the ﬁrst place, Webster’s deﬁnition pre-dates the discovery of hyperreal numbers. The
symbol ∞does NOT represent a real or hyperreal number, because things like ∞· ∞= ∞
only denote ‘limit of big times limit of big is big.’ The limit forms above do not have a
deﬁnite outcome.
Each of the symbolic short-cuts above has a hyperreal number calculation with indeter-
minate outcomes in the sense that they may be inﬁnitesimal, ﬁnite or inﬁnite depending on
the particular inﬁnitesimal, ﬁnite or inﬁnite numbers in the computation. In this sense, the
older inﬁnities are compatible with inﬁnitely large hyperreal numbers.
Example 3.12.
The Indeterminate Form ∞−∞
Consider ∞−∞.
The numbers H and L = H + δ are both inﬁnite numbers, but
H −L = −δ is inﬁnitesimal.
The numbers K and M = K + b are both inﬁnite and
K −M ≈−5. The numbers H and N = H2 are both inﬁnite and H −N = (1 −H) · H is
a negative inﬁnite number.

Computation of Limits
41
We may view the symbolic expression “∞−∞is indeterminate” as a short-hand for the
fact that the diﬀerence between two inﬁnite hyperreal numbers can be positive or negative
inﬁnite, positive or negative and ﬁnite or even positive or negative inﬁnitesimal. Of course,
it can also be zero.
Example 3.13.
The Indeterminate Form 0 · ∞
The short-hand symbolic expression “0·∞is indeterminate” corresponds to the following
kinds of choices. Suppose that H = 1/δ. Then δ · H = 1. An inﬁnitesimal times an inﬁnite
number could be ﬁnite. Suppose K = H3, so K is inﬁnite. Now δ · K = H is inﬁnite.
An inﬁnitesimal times an inﬁnite number could be inﬁnite. Finally, suppose ε = δ5. Then
ε · K = δ5/δ2 = δ3 is inﬁnitesimal.
The following is just for practice at using the computation rules for inﬁnitesimal, ﬁnite,
and inﬁnite numbers from Theorem 1.12 to compute limits rigorously. These computations
prove that the “epsilon - delta” conditions hold.
Exercise set 3.3
1. Drill with Rules of Inﬁnitesimal, Finite and Inﬁnite Numbers
In the following formulas,
0 < ε ≈0
and
0 < δ ≈0,
H
and
K
are inﬁnite and positive.
a ≈2,
b ≈5,
c ≈−7,
but
a ̸= 2,
b ̸= 5,
c ̸= −7
Say whether each expression is inﬁnitesimal, ﬁnite (and which real number it is near),
inﬁnite, or indeterminate (that is, could be in diﬀerent categories depending on the
particular values of the parameters above.)
1
y = ε × δ
2
y = ε −δ
3
y = ε/b
4
y = ε/δ
5
y = a+7ε
b−4δ
6
y = b/ε
7
y = a + b −c
8
y = a + δ
9
y = c −ε
10
y = a −2
11
y =
1
a−2
12
y =
1
a−b
13
y =
c
a−b
14
y = 2−δ
a
15
y = 5δ4−3δ2+2δ
δ
16
y = 1
H
17
y =
2−δ
a−K
18
y = 5δ4−3δ2+2δ
4δ+δ2
19
y = H2+3H
H
20
y = H2+3H
H2
21
y =
3δ2
δ+8δ2
22
y = H−K
H
23
y = H−K
H K
24
y = H−K
H+K
25
y =
√
H
26
y =
√
δ
27
y = H+K
H−K
28
y =
√
H
H+a
29
y =
√
a + δ −√a
30
y =
1
b+δ −1
b

42
3. The Theory of Limits
31
y = 3aδ2+δ3
δ
32
y =
√
a+δ−√a
δ
33
y = 1
δ

1
b+δ −1
b

2. Re-write the problems of the previous exercise as limits.
3. Prove Theorem 3.7.

CHAPTER
4
Continuous Functions
A function f[x] is continuous if a small change in its input only
produces a small change in its output. This chapter gives some
fundamental consequences of this property.
Deﬁnition 4.1.
Continuous Function
Suppose a real function f[x] is deﬁned in a neighborhood of a, |x −a| < ∆. We
say f[x] is continuous at a if whenever x ≈a in the hyperreal numbers, the natural
extension satisﬁes f[x] ≈f[a].
Notice that continuity assumes that f[a] is deﬁned. The function
f[x] = Sin[x]
x
is technically not continuous at x = 0, but since limx→0 f[x] = 1 we could extend the
deﬁnition to include f[0] = 1 and then the function would be continuous.
Theorem 4.2.
Continuity as Limit
Suppose a real function f[x] is deﬁned in a neighborhood of a, |x −a| < ∆. Then
f[x] is continuous at a if and only if limx→a f[x] = f[a].
Proof:
Apply Theorem 3.2.
We show in Section ?? that diﬀerentiable functions are continuous, so rules of calculus
give us an easy way to verify that a function is continuous.
4.1
Uniform Continuity
A function is uniformly continuous if given an “epsilon,” the same “delta”
works “uniformly” for all x.
The simplest intervals are the ones of ﬁnite length that include their endpoints, [a, b], for
numbers a and b. These intervals are sometimes described as ‘closed and bounded,’ because
they have the endpoints and have bounded length. A shorter name is ‘compact’ intervals.
43

44
4. Continuous Functions
Every hyperreal number satisfying a ≤x ≤b is near a real number x ≈c with a ≤c ≤b.
First, the hyperreal x has a standard part since it is ﬁnite.
Second, c must lie in the
interval because real numbers r outside the interval are a noninﬁnitesimsl distance from the
endpoints. We cannot have x ≈r and r a noninﬁnitesimal distance from the interval.
The fact that every hyperreal point of a set is near a standard point of the set is equivalent
to the “ﬁnite covering property” of general topologically compact spaces. The hyperreal
condition is easy to apply directly. The following theorem illustrates this (although we do
not need the theorem later in the course.)
Theorem 4.3.
Continuous on a Compact Interval
Suppose that a real function f[x] is deﬁned and continuous on the compact real
interval [a, b] = {x : a ≤x ≤b}. Then for every real positive θ there is a real
positive γ such that if |x1 −x2| < γ in [a, b], then |f[x1] −f[x2]| < θ.
Proof:
Since f[x] is continuous at every point of [a, b], if ξ ≈c for a ≤c ≤b, then f[ξ] ≈f[c].
Further, since the interval [a, b] includes its real endpoints, if a hyperreal number x
satisﬁes a ≤x ≤b then its standard part from Theorem 1.11 c lies in the interval and x ≈c.
Let x1 and x2 be any two points in [a, b] with x1 ≈x2. Both of these numbers have the
same standard part (since the real standard parts have to be inﬁnitely close and real, hence
equal.) We have
f[x1] ≈f[c] ≈f[x2]
so for any numbers x1 ≈x2 in [a, b], f[x1] ≈f[x2].
Suppose the conclusion of the theorem is false. Then there is a real θ > 0 such that for
every γ > 0 there exist x1 and x2 in [a, b] with |x1 −x2| < γ and |f[x1] −f[x2]| ≥θ. Deﬁne
real functions X1[γ] and X2[γ] that select such values and give us the real logical statement
{γ > 0} ⇒{a ≤X1[γ] ≤b, a ≤X2[γ] ≤b, |X1[γ] −X2[γ]| < γ, |f[X1[γ]] −f[X2[γ]]| ≥θ}
Now apply the Function Extension Axiom 2.1 to this implication and select a positive
inﬁnitesimal γ ≈0. Let x1 = X1[γ], x2 = X2[γ] and notice that they are in the interval,
x1 ≈x2, but f[x1] is not inﬁnitely close to f[x2]. This contradiction shows that the theorem
is true.
4.2
The Extreme Value Theorem
Continuous functions attain their max and min on compact intervals.
Theorem 4.4.
The Extreme Value Theorem
If f[x] is a continuous real function on the real compact interval [a, b], then f
attains its maximum and minimum, that is, there are real numbers xm and xM
such that a ≤xm ≤b, a ≤xM ≤b, and for all x with a ≤x ≤b
f[xm] ≤f[x] ≤f[xM]
Intuitive Proof:

The Extreme Value Theorem
45
We will show how to locate the maximum, you can ﬁnd the minimum. Partition the
interval into steps of size ∆x,
a < a + ∆x < a + 2∆x < · · · < b
and deﬁne a real function
M[∆x] = the x of the form x1 = a + k∆x
so that
f[M[∆x] = f[x1] = max[f[x] : x = a + h∆x, h = 0, 1, · · · , n]
This function is the discrete maximum from among a ﬁnite number of possibilities, so that
M[∆x] has two properties: (1) M[∆x] is one of the partition points and (2) all other
partition points x = a + h∆x satisfy f[x] ≤f[M[∆x]].
Next, we partition the interval into inﬁnitesimal steps,
a < a + δx < a + 2δx < · · · < b
and consider the natural extension of the discrete maximizing function M[δx].
By the
Function Extension Axiom 2.1 we know that (1) x1 = M[δx] is one of the points in the
inﬁnitesimal partition and (2) f[x] ≤f[x1] for all other partition points x.
Since the hyperreal interval [a, b] only contains ﬁnite numbers, there is a real number
xM ≈x1 (standard part) and every other real number x2 in [a, b] is within δx of some
partition point, x2 ≈x.
Continuity of f means that f[x] ≈f[x2] and f[xM] ≈f[x1]. The numbers x2 and xM
are real, so f[x2] and f[xM] are also real and we have
f[x2] ≈f[x] ≤f[x1] ≈f[xM]
Thus, for any real x2, f[x2] ≤f[xM], which says f attains its maximum at xM.
This
completes the proof.
Partition Details of the Proof:
Let a and b be real numbers and suppose a real function f[x] is deﬁned for a ≤x ≤b.
Let ∆x be a positive number smaller than b −a. There are ﬁnitely many numbers of the
form a + k ∆x between a and b; a = a + 0 ∆x, a + ∆x, a + 2 ∆x, · · · , a + n ∆x ≤b. The
corresponding function values, f[a], f[a + ∆x], f[a + 2 ∆x], · · · , f[a + n ∆x] have a largest
amongst them, say f[a + m ∆x] ≥f[a + k ∆x] for all other k. We can express this with a
function M[∆x] = a + m ∆x “is the place amongst the points a < a + ∆x < a + 2 ∆x <
· · · < a + n ∆x ≤b such that f[M[∆x]] ≥f[a + k ∆x].” (There could be more than one,
but M[∆x] chooses one of them.)
A better way to formulate this logically is to say, ‘if x is of the form a + k ∆x, then
f[x] ≤f[M[∆x]].’ This can also be formulated with functions. Let I[x] be the ‘indicator
function of integers,’ that is I[x] = 1 if x = 0, ±1, ±2, ±3, · · · and I[x] = 0 otherwise. Then
the maximizing property of M[∆x] = a + m ∆x can be summarized by

a ≤x ≤b
and
I
x −a
∆x

= 1

⇒
f[x] ≤f[M[∆x]]
The rigorous formulation of the Function Extension Axiom covers this case. We take S to
be the set of formulas, ∆x > 0, a ≤x, x ≤b and I[[x −a]/∆x] = 1 and take T to be the
inequality f[x] ≤f[M[∆x]]. The Function Extension Axiom shows that M[δx] is the place

46
4. Continuous Functions
where f[x] is largest among points of the form a + k δx, even when δx ≈0 is inﬁnitesimal,
but it says this as follows:

a ≤x ≤b
and
I
x −a
δx

= 1

⇒
f[x] ≤f[M[δx]]
We interpret this as meaning that, ‘among the hyperreal numbers of the form a + k δx, f[x]
is largest when x = M[δx],’ even when δx is a positive inﬁnitesimal.
4.3
Bolzano’s Intermediate Value The-
orem
The graphs of continuous functions have no “jumps.”
Theorem 4.5.
Bolzano’s Intermediate Value Theorem
If y = f[x] is continuous on the interval a ≤x ≤b, then f[x] attains every
value intermediate between the values f[a] and f[b]. In particular, if f[a] < 0 and
f[b] > 0, then there is an x0, a < x0 < b, such that f[x0] = 0.
Proof:
The following idea makes a technically simple general proof. Suppose we want to hit a
real value γ between the values of f[a] = α and f[b] = β. Divide the interval [a, b] up into
small steps each ∆x long, a, a + ∆x, a + 2∆x, a + 3∆x, · · · , b. Suppose α < γ < β. The
function f[x] starts at x = a with f[a] = α < γ. At the next step, it may still be below γ,
f[a + ∆x] < γ, but there is a ﬁrst step, a + k∆x where f[a + k∆x] > γ and f[x] < γ for all
x of the form x = a + h∆x with h < k.
[
a
b
]
Figure 4.1: [a, b] in steps of size ∆x
We need a general function for this. Let the function
M[∆x] = Min[x : f[x] > γ,
a < x < b,
x = a + ∆x, a + 2 ∆x, a + 3 ∆x, · · · ]
= a + k∆x
give this minimal x as a function of the step size ∆x.
The natural extension of this Min function has the property that even when we compute
at an inﬁnitesimal step size, ξ = M[δx] satisﬁes, f[ξ] > γ, and f[x] < γ for x = a+hδx < ξ,
in particular f[ξ −δx] < γ. Inﬁnitesimals let continuity enter the picture.
Continuity of f[x] means that if c ≈x, then f[c] ≈f[x]. We take c to be the standard
real number such that c ≈ξ = M[δx]. We know f[c] ≈f[ξ] > γ and f[c] ≈f[ξ −δx] < γ.
Since f[c] must be a real value for a real function at a real input, and since we have just
shown that f[c] ≈γ, it follows that f[c] = γ, because ordinary reals can only be inﬁnitely
close if they are equal.

-4
-2
2
4
w
-4
-2
2
4
x
Part 3
1 Variable Diﬀerentiation

48

CHAPTER
5
The Theory of Derivatives
This chapter shows how the traditional “epsilon-delta” theory, rig-
orous inﬁnitesimal analysis, and the intuitive approximations of the
main text are related.
The chapter shows that
lim
∆x→0
f[x + ∆x] −f[x]
∆x
= f ′[x]
locally uniformly
⇔
f[x + δx] = f[x] + f ′[x] δx + ε · δx
with
ε ≈0
for
δx ≈0
with all the provisos needed to make both of these exactly formally correct. Then this
approximation is used to prove some of the basic facts about derivatives.
5.1
The Fundamental Theorem: Part
1
We begin with an overview that illustrates the two main approximations of
calculus, how they ﬁt together, and how the ﬁne details are added if you
wish to make formal arguments based on an intuitive approximation.
We re-write the traditional limit for a derivative as an approximation for the diﬀerential.
Then we plug this diﬀerential approximation into an approximation of an integral to see
why the Fundamental Theorem of Integral Calculus is true. The two main approximations
interact to let us compute integrals by ﬁnding antiderivatives. For now, we simply treat
the symbol “wiggly equals,” ≈, as an intuitive “approximately equals.” Subsections below
justify the use both in terms of hyperreal inﬁnitesimals and in terms of uniform limits. The
point of the section is that the intuitive arguments are correct because we can ﬁll in all the
details if we wish.
The Intuitive Derivative Approximation
49

50
5. The Theory of Derivatives
The traditional approach to derivatives is the approximation of secant lines approaching
the slope of the tangent. Symbolically, this is
lim
∆x→0
f[x + ∆x] −f[x]
∆x
= f ′[x]
The intuitive meaning of this formula is that (f[x + ∆x] −f[x])/∆x is approximately equal
to f ′[x] when the diﬀerence, ∆x, is small, ∆x = δx ≈0. We write this with an explicit
error,
f[x + δx] −f[x]
δx
= f ′[x] + ε
where the error given by the Greek letter epsilon, ε, is small, provided that δx is small. We
use lower case or small delta to indicate that the approximation is valid for a small diﬀerence
in the value of x. [δ is lower case ∆. Both stand for “diﬀerence” because the diﬀerence in
x-input is δx = (x + δx) −x.]
This approximation can be rewritten using algebra and expressed in the form
f[x + δx] −f[x] = f ′[x] δx + ε · δx
with
ε ≈0
for
δx ≈0
where now the wiggly equals ≈only means “approximately equals” in an intuitive sense.
This expresses the change in a function f[x + δx] −f[x] in moving from x to x + δx as
approximately given by a change f ′[x] δx, linear in δx, with an error ε · δx that is small
compared to δx, (ε · δx)/δx = ε ≈0.
This is a powerful intuitive formulation of the approximation of derivatives. (It is often
called ‘Landau’s small oh formula.’) This also has a direct geometric counterpart in terms
of microscopes given in the main text, but here we use it symbolically.
An Antiderivative
Suppose that we begin with a function f[x] and know an antiderivative F[x], that is,
dF
dx [x] = f[x]
for
a ≤x ≤b
The approximation above becomes
F[x + δx] −F[x] = f[x] δx + ε · δx
with
ε ≈0
for
δx ≈0
Flip this around to tell us
f[x] δx = (F[x + δx] −F[x]) −ε · δx
with
ε ≈0
for
δx ≈0
provided that a ≤x ≤b.
Integrals are Sums of Slices
The main idea of integral calculus is that integrals are ‘sums of slices.’ One way to express
this is
Z b
a
f[x] dx = lim
∆x→0(f[a]∆x + f[a + ∆x]∆x + f[a + 2∆x]∆x
+ f[a + 3∆x]∆x + · · · + f[b −2∆x]∆x + f[b −∆x]∆x)
where the sum is over values of f[x] ∆x where x starts at a and goes in steps of size ∆x
until we get to the slice ending at b.

The Fundamental Theorem: Part 1
51
The limiting quantity is approximately equal to the integral when the step size is “small
enough.”
Z b
a
f[x] dx ≈f[a]δx + f[a + δx]δx + · · · + f[b −δx]δx
for
δx ≈0
where ≈temporarily only means the intuitive “approximately equals.”
Now we incorporate the diﬀerential approximation above at each of the x points, x = a,
x = a + δx, · · · , x = b −δx, in our sum approximation, obtaining
Z b
a
f[x] dx ≈
([F(a + δx) −F[a]) + (F[a + 2δx] −F[a + δx]) + · · · + (F[b] −F[b −δx])
−(ε[a, δx] δx + ε[a + δx, δx]) δx + · · · + ε[b, δx] δx)
The ﬁrst sum ‘telescopes,’ that is, positive leading terms in one summand cancel negative
second terms in the next, all except for the ﬁrst and last terms,
(F[a + δx] −F[a]) + (F[a + 2δx] −F[a + δx]) + · · · + (F[b] −F[b −δx])
= −F[a] + F[b]
The second sum and can be estimated as follows,
|ε[a, δx] δx + ε[a + δx, δx] δx + · · · + ε[b −δx, δx] δx|
≤|ε[a, δx]| δx + |ε[a + δx, δx]| δx + · · · + |ε[b −δx, δx]| δx
≤|εMax|(δx + δx + · · · + δx)
≤|εMax|(b −a)
where |εMax| is the largest of the small errors, ε[x, δx], coming from the diﬀerential approx-
imation. The sum of δx enough times to move from a to b is b −a, the distance moved.
As long as we make the largest error small enough, the summed error less than |εMax|(b−
a) will also be small, so
Z b
a
f[x] dx ≈F[b] −F[a]
But these are both ﬁxed and do not depend on how small we take δx, hence
Z b
a
f[x] dx = F[b] −F[a]
This intuitive estimation illustrates the Fundamental Theorem of Integral Calculus.
Theorem 5.1.
Fundamental Theorem of Integral Calculus: Part 1
Suppose the real function f[x] has an antiderivative, that is, a real function F[x]
so that the derivative of F[x] satisﬁes
dF
dx [x] = f[x]
for all x with a ≤x ≤b
Then
Z b
a
f[x] dx = F[b] −F[a]

52
5. The Theory of Derivatives
The above is not a formal proof, because we have not kept track of the “approximately
equal” errors. This can be completed either from the “ε −δ” theory of limits or by using
hyperreal inﬁnitesimals. Both justiﬁcations follow in separate subsections.
5.1.1
Rigorous Inﬁnitesimal Justiﬁcation
First, we take as our deﬁnition of derivative, dF
dx = f[x], condition (a) of Theorem 3.5:
for every hyperreal x with a ≤x ≤b and every δx inﬁnitesimal, there is an inﬁnitesimal ε
so that the extended functions satisfy
F[x + δx] −F[x] = f[x] δx + ε · δx
The only thing we need to know from the theory of inﬁnitesimals is that
εMax
exists in the sense that
|ε[a, δx] δx+ε[a + δx, δx] δx + · · · + ε[b −δx, δx] δx|
≤|ε[a, δx]| δx + |ε[a + δx, δx]| δx + · · · + |ε[b −δx, δx]| δx
≤|εMax|(δx + δx + · · · + δx)
≤|εMax|(b −a)
still holds when δx is inﬁnitesimal. This follows from the Function Extension Axiom. Let
ε[x, ∆x] be the real function of the real variables x and ∆x,
ε[x, ∆x] = F[x + ∆x] −F[x]
∆x
−f[x]
For each ordinary real ∆x, there is an x of the form xm = a + m ∆x
(m = 1, 2, 3, · · ·)
so that the inequalities above hold with εMax = ε[xm, ∆x]. This is just a ﬁnite maximum
being attained at one of the values. Deﬁne a real function m[∆x] = xm.
Deﬁne a real function
S[∆x] = |ε[a, ∆x] ∆x + ε[a + ∆x, ∆x] ∆x + · · · + ε[ε[b −∆x, ∆x] ∆x|
The inequalities above say that for real ∆x
S[∆x] ≤|ε[m[∆x], ∆x]|(b −a)
The Function Extension Axiom says
S[δx] ≤|ε[m[δx], δx]|(b −a)
and the deﬁnition of derivative says that ε[m[δx], δx] is inﬁnitesimal, provided δx is inﬁnites-
imal. Since an inﬁnitesimal times the ﬁnite number (b −a) is also inﬁnitesimal, we have
shown that the diﬀerence between the real integral and the real answer
S[δx] =
Z b
a
f[x] dx −(F[b] −F[a])
is inﬁnitesimal. This means that they must be equal, since ordinary numbers can not diﬀer
by an inﬁnitesimal unless they are equal.

Derivatives, Epsilons and Deltas
53
5.1.2
Rigorous Limit Justiﬁcation
We need our total error to be small. This total error, ErrorIntegral, is the diﬀerence
between the quantity F[b] −F[a] and the integral, so by the calculation above,
ErrorIntegral = ε[a, ∆x] ∆x + ε[a + ∆x, ∆x] ∆x + · · · + ε[b −∆x, ∆x] ∆x
We know from the calculation above that |ErrorIntegral| ≤|εMax|(b −a).
If we choose
an arbitrary error tolerance of θ, then it is suﬃcient to have |εMax| ≤θ/(b −a), because
then we will have |ErrorIntegral| ≤θ. This means that we must show that the diﬀerential
approximation
f[x]∆x = (F[x + ∆x] −F[x]) −ε · ∆x
holds with |ε| ≤θ/(b −a) for every x in [a, b]. Using the algebra above in reverse, this is
the same as showing that
F[x + ∆x] −F[x]
∆x
−f[x] = ε[x, ∆x]
is never more than θ/(b −a), provided that ∆x is small enough. The traditional way to say
this is
lim
∆x→0
F[x + ∆x] −F[x]
∆x
= f[x]
uniformly for
a ≤x ≤b
The rigorous deﬁnition of the limit in question is: for every tolerance η and every x in [a, b],
there exists a µ such that if |∆x| < µ, then
|F[x + ∆x] −F[x]
∆x
−f[x]| < η
This is the formal deﬁnition of derivative condition (b) of Theorem 3.5. Our proof of the
Fundamental Theorem is complete (letting η = θ/(b −a)). The hypothesis says that if we
can ﬁnd a function f[x] so that
lim
∆x→0
F[x + ∆x] −F[x]
∆x
= f[x]
uniformly for
a ≤x ≤b
then the conclusion is
Z b
a
f[x] dx = F[b] −F[a]
(Notice that the existence of the limit deﬁning the integral is part of our proof. The function
f[x] is continuous, because of our strong deﬁnition of derivative.)
5.2
Derivatives, Epsilons and Deltas
The fundamental approximation deﬁning the derivative of a real valued
function can be formulated with or without inﬁnitesimals as follows.

54
5. The Theory of Derivatives
Deﬁnition 5.2.
The Rigorous Derivative
In Theorem 3.5 we saw that the following are equivalent deﬁnitions of, “The real
function f[x] is smooth with derivative f ′[x] on the interval (a, b).”
(a)
Whenever a hyperreal x satisﬁes a < x < b and x is not inﬁnitely near a
or b, then an inﬁnitesimal increment of the naturally extended dependent
variable is approximately linear, that is, whenever δx ≈0
f[x + δx] −f[x] = f ′[x] δx + ε · δx
for some ε ≈0.
(b)
For every compact subinterval [α, β] ⊂(a, b),
lim
∆x→0
f[x + ∆x] −f[x]
∆x
= f ′[x]
uniformly for
α ≤x ≤β
in other words, for every accuracy tolerance θ and every real α and β in
(a, b), there is a suﬃciently small positive real number γ such that if the real
number ∆x satisﬁes 0 < |∆x| < γ and the real number x satisﬁes α ≤x ≤β,
then

f[x + ∆x] −f[x]
∆x
−f ′[x]
 < θ
(c)
For every real c in (a, b),
lim
x→c,∆x→0
f[x + ∆x] −f[x]
∆x
= f ′[c]
That is, for every real c with a < c < b and every real positive θ, there is a
real positive γ such that if the real numbers x and ∆x satisfy 0 < ∆x < γ
and 0 < |x −c| < γ, then | f[x+∆x]−f[x]
∆x
−f ′[c]| < θ.
All derivatives computed by rules satisfy this strong approximation provided the formulas
are valid on the interval. This is proved in Theorem 5.5 below.
5.3
Smoothness ⇒Continuity of Func-
tion and Derivative
This section shows that diﬀerentiability in the sense of Deﬁnition 5.2 implies
that the function and derivative are continuous.
One diﬃcult thing about learning new material is putting new facts together. Bolzano’s
Theorem and Darboux’s Theorem have hypotheses that certain functions are continuous.
This means you must show that the function you are working with is continuous. How do
you tell if a function is continuous? You can’t ‘look’ at a graph if you haven’t drawn one
and are using calculus to do so. What does continuity mean? Intuitively, it just means that
small changes in the independent variable produce only small changes in the dependent
variable.

Smoothness ⇒Continuity of Function and Derivative
55
In Theorem ?? we showed that the following are equivalent deﬁnitions
Deﬁnition 5.3.
Continuity of f[x]
Suppose a real function f[x] is deﬁned for at least a small neighborhood of a real
number a, |x −a| < ∆, for some positive real ∆.
(a)
f[x] is continuous at a if whenever a hyperreal x satisﬁes x ≈a, the natural
extension satisﬁes f[x] ≈f[a].
(b)
f[x] is continuous at a if limx→a f[x] = f[a].
Intuitively, this just means that f[x] is close to f[a] when x is close to a, for every x ≈a,
f[x] is deﬁned and
f[x] ≈f[a]
The rules of calculus (together with Theorem 5.5) make it easy to verify that functions
given by formulas are continuous: Simply calculate the derivative.
Theorem 5.4.
Continuity of f[x] and f ′[x]
Suppose the real function f[x] is smooth on the real interval (a, b) (see Deﬁni-
tion 5.2). Then both f[x] and f ′[x] are continuous at every real point c in (a, b).
Proof for f[x]:
Proof of continuity of f is easy algebraically but is obvious geometrically: A graph that is
indistinguishable from linear in a microscope clearly only moves a small amount in a small
x-step. Draw the picture on a small scale.
Algebraically, we want to show that if x1 ≈x2 then f[x1] ≈f[x2], condition (a) above.
Let c be any real point in (a, b) and x = x1 = c. Let δx = x2 −x1 be any inﬁnitesimal and
use the approximation f[x2] = f[x+δx] = f[x1]+f ′[x1]δx+ε δx. The quantity [f ′[x1]+ε]δx
is medium times small = small, so f[x1] ≈f[x2], by Theorem 1.12 (c). That is the algebraic
proof.
Proof for f ′[x]:
Proof of continuity of f ′[x] requires us to view the increment from both ends. First take
any real c in (a, b), x = x1 = c, and δx = x2 −x1 any nonzero inﬁnitesimal. Use the
approximation
f[x2] = f[x + ∆x] = f[x1] + f ′[x1]δx + ε1δx.
Next let x = x2, δx = x1 −x2 and use the approximation
f[x1] = f[x + ∆x] = f[x2] + f ′[x2]δx + ε2δx.
The diﬀerent x-increments are negatives, so we have
f[x1] −f[x2] = f ′[x2](x1 −x2) + ε2(x1 −x2)
and
f[x2] −f[x1] = f ′[x1](x2 −x1) + ε1(x2 −x1)
Adding, we obtain
0 = ((f ′[x2] −f ′[x1]) + (ε2 −ε1)) (x1 −x2)
Dividing by the non-zero (x1 −x2), we see that
f ′[x2] = f ′[x1] + (ε1 −ε2),
so
f ′[x2] ≈f ′[x1]
Note:

56
5. The Theory of Derivatives
The derivative deﬁned in many calculus books is a weaker pointwise notion than the
notion of smoothness we have deﬁned. The weak derivative function need not be continuous.
(The same approximation does not apply at both ends with the weak deﬁnition.) This is
explained in Chapter 6 on Pointwise Approximations.
Exercise set 5.3
1.
(a) Consider the real function f[x] = 1/x, which is undeﬁned at x = 0. We could
extend the deﬁnition by simply assigning f[0] = 0. Show that this function is not
continuous at x = 0 but is continuous at every other real x.
(b) Give an intuitive graphical description of the deﬁnition of continuity in terms of
powerful microscopes and explain why it follows that smooth functions must be
continuous.
(c) The function f[x] = √x is deﬁned for x ≥0; there is nothing wrong with f[0].
However, our increment computation for √x above was not valid at x = 0 because
a microscopic view of the graph focused at x = 0 looks like a vertical ray (or half-
line). Explain why this is so, but show that f[x] is still continuous “from the
right;” that is, if 0 < x ≈0, then √x ≈0 but
√x
x is very large.
5.4
Rules
⇒Smoothness
This section shows that when we can compute a derivative by rules, then
the smoothness Deﬁnition 5.2 is automatically satisﬁed on intervals where
both formulas are deﬁned.
Theorem 5.5.
Rules ⇒Smooth
Suppose a function y = f[x] is given by a formula to which we can apply the rules
of Chapter 6 of the main text, obtaining a formula for f ′[x].
If both f[x] and
f ′[x] are deﬁned on the real interval (a, b), then then satisfy Deﬁnition 5.2 and, by
Theorem 5.4, are continuous on (a, b).
Proof:
This is a special case of Theorem 10.1.
Exercise set 5.4
1. What is the simple way to tell if a function is continuous?
2. Suppose that y = f[x] is given by a formula that you can diﬀerentiate by the rules of
calculus from Chapter 6 of the main text. As you know, you can diﬀerentiate many

The Increment and Increasing
57
many formulas. What property does the function dy
dx = f ′[x] have to have so that you
can conclude f[x] is continuous at all points of the interval a ≤x ≤b? (What about
f[x] = 1/x at x = 0?)
Give examples of:
(a) One y = f[x] which you can diﬀerentiate by rules and an interval [a, b] where
f ′[x] is deﬁned and f[x] is continuous on the whole interval.
(b) Another y = f[x] which you can diﬀerentiate by rules, but where f ′[x] fails to be
deﬁned on all of [a, b] and where f[x] is not continuous at some point a ≤c ≤b.
(Hint: Read Theorem 5.4. What about y = 1/x?)
What properties does the function
dy
dx = f ′[x] have to have so that you can conclude
f ′[x] is continuous at all points of the interval a ≤x ≤b?
Give Examples of:
(a) One y = f[x] which you can diﬀerentiate by rules and an interval [a, b] where
f ′[x] is deﬁned and f ′[x] is continuous on the whole interval.
(b) Another y = f[x] which you can diﬀerentiate by rules, but where f ′[x] fails to be
deﬁned on all of [a, b] and where f ′[x] is not continuous at some point a ≤c ≤b.
(Note: If f ′[x] is undeﬁned at x = c, it cannot be considered continuous at c.
Well, there is a sticky point here. Perhaps f ′[x] could be extended at an undeﬁned
point so that it would become continuous with the extension. It is actually fairly
easy to rule this out with one of the functions you have worked with in previous
homework problems.)
5.5
The Increment and Increasing
A positive derivative means a function is increasing near the point. We
prove this algebraically in this section.
It is ‘clear’ that if we view a graph in an inﬁnitesimal microscope at a point x0 and
see the graph as indistinguishable from an upward sloping line, then the function must be
‘increasing’ near x0. Certainly, the graph need not be increasing everywhere - draw y = x2
and consider the point x0 = 1 with f ′[1] = 2. Exactly how should we formulate this? Even
if you don’t care about the symbolic proof of the algebraic formulation, the formulation
itself may be useful in cases where you don’t have graphs.
One way to say f[x] increases near x0 would be to say that if x1 < x0 < x2 (and these
points are not ‘too far’ from x0), then f[x1] < f[x0] < f[x2]. Another way to formulate
the problem is to say that if x1 < x2 (and these points are not ‘too far’ from x0), then
f[x1] < f[x2]. Surprisingly, the second formulation is more diﬃcult to prove (and even fails
for pointwise diﬀerentiable functions). The second formulation essentially requires that we
can move the microscope from x0 to x1 and continue to see an upward sloping line. We
know from Theorem 5.4 that if x1 ≈x0 the slope of the microscopic line only changes an
small amount, so we actually see the same straight line.

58
5. The Theory of Derivatives
Theorem 5.6.
Local Monotony
Suppose the function f[x] is diﬀerentiable on the real interval a < x < b and x0
is a real point in this interval.
(a)
If f ′[x0] > 0, then there is a real interval [α, β], a < α < x0 < β < b, such
that f[x] is increasing on [α, β], that is,
α ≤x1 < x2 ≤β
⇒
f[x1] < f[x2]
(b)
If f ′[x0] < 0, then there is a real interval [α, β], a < α < x0 < β < b, such
that f[x] is decreasing on [α, β], that is,
α ≤x1 < x2 ≤β
⇒
f[x1] > f[x2]
Proof
We will only prove case (a), since the second case is proved similarly. First we verify that
f[x] is increasing on a microscopic scale. The idea is simple: Compute the change in f[x]
using the positive slope straight line and keep track of the error.
Take x1 and x2 so that x0 ≈x1 < x2 ≈x0. Since f ′[x1] ≈f ′[x0] by Theorem 5.4 we may
write f ′[x1] = m + ε1 where m = f ′[x0] and ε1 ≈0. Let δx = x2 −x1 so
f[x2] = f[x1 + δx] = f[x1] + f ′[x1] · δx + ε2 · δx
= f[x1] + m · δx + (ε1 + ε2) · δx
The number m is a real positive number, so m + ε1 + ε2 > 0 and , since δx > 0, (m + ε1 +
ε2) · δx > 0. This means f[x2] −f[x1] > 0 and f[x2] > f[x1]. This proves that for any
inﬁnitesimal interval [α, β] with α < x0 < β, the function satisﬁes
α ≤x1 < x2 ≤β
⇒
f[x1] < f[x2]
The Function Extension Axiom guarantees that real numbers α and β exist satisfying the
inequalities above, since if the equation fails for all real α and β, it would fail for inﬁnitely
close ones. That completes the proof.
Example 5.1.
A Non-Increasing Function with Pointwise Derivative 1
The function
f[x] =
(
0,
if x = 0
x + x2 Sin[ π
x],
if x ̸= 0
has a pointwise derivative at every point and Dxf[0] = 1 (but is not diﬀerentiable in the
usual sense of Deﬁnition 5.2). This function is not increasing in any neighborhood of zero
(so it shows why the pointwise derivative is not strong enough to capture the intuitive idea
of the microscope). See Example 6.3.1 for more details.
5.6
Inverse Functions and Derivatives
If a function has a nonzero derivative at a point, then it has a local inverse.
The project on Inverse Functions expands this section with more details.

Inverse Functions and Derivatives
59
The inverse of a function y = f[x] is the function x = g[y] whose ‘rule un-does what the
rule for f does.’
g[f[x]] = x
If we have a formula for f[x], we can try to solve the equation y = f[x] for x. If we are
successful, this gives us a formula for g[y],
y = f[x]
⇔
x = g[y]
Example 5.2.
y = x2 and the Partial Inverse x = √y
For example, if y = f[x] = x2, then x = g[y] = √y, at least when x ≥0. These two
functions have the same graph if we plot g with its independent variable where the y axis
normally goes, rather than plotting the input variable of g[y] on the horizontal scale.
x
  y=f[x],  x>0
x=g[y]
y
Figure 5.1: y = f[x]
and its inverse
x = g[y]
The graph of x = g[y] operationally gives the function g by choosing a y value on the
y axis, moving horizontally to the graph, and then moving vertically to the x output on
the x axis. This makes it clear graphically that the rule for g ‘un-does’ what the rule for
f does. If we ﬁrst compute f[x] and then substitute that answer into g[y], we end up with
the original x.
Example 5.3.
y = f[x] = x9 + x7 + x5 + x3 + x its Inverse
The graph of the function y = f[x] = x9 + x7 + x5 + x3 + x is always increasing because
f ′[x] = 9 x8+7 x6+5 x4+3 x2+1 > 0 is positive for all x. Since we know limx→−∞f[x] = −∞
and limx→+∞f[x] = +∞, Bolzano’s Intermediate Value Theorem 4.5 says that f[x] attains
every real value y. By Theorem 5.6, f[x] can attain each value only once. This means that
for every real y, there is an x = g[y] so that f[x] = y. In other words, we see abstractly that
f[x] has an inverse without actually solving the equation y = x9 + x7 + x5 + x3 + x for x as
a function of y.
Example 5.4.
ArcTan[y]
The function y = Tan[x] has derivative dy
dx =
1
(Cos[x])2 . When −π/2 < x < π/2, cosine is
not zero and therefore the tangent is increasing for −π/2 < x < π/2. How do we solve for

60
5. The Theory of Derivatives
x in the equation y = Tan[x]?
y = Tan[x]
ArcTan[y] = ArcTan[Tan[x]] = x
x = ArcTan[y]
But what is the arctangent? By deﬁnition, the inverse of tangent on (−π/2, π/2). So how
would we compute it? The Inverse Function project answers this question.
Example 5.5.
A Non-Elementary Inverse
Some functions are do not have classical expressions for their inverses. Let
y = f[x] = xx
This may be written using x = eLog[x], so xx = (eLog[x])x = ex Log[x], and f[x] has derivative
dy
dx = d(ex Log[x])
dx
= (Log[x] + x 1
x)ex Log[x]
= (1 + Log[x]) xx
It is clear graphically that y = f[x] has an inverse on either the interval (0, 1/e) or
(1/e, ∞).
We ﬁnd where the derivative is positive, negative and zero as follows.
First,
xx = ex Log[x] is always positive, never zero, so
0 = (1 + Log[x]) xx
0 = (1 + Log[x])
−1 = Log[x]
e−1 = eLog[x]
1
e = x
If x < 1/e, say x = 1/e2, then
dy
dx = (1 + Log[e−2])(+) = (1 −2)(+) = (−) < 0.
If
x = e > 1/e, dy
dx = (1 + Log[e])(+) = (2)(+) = (+) > 0. So dy
dx < 0 for 0 < x < 1/e and
dy
dx > 0 for 1/e < x < ∞. (Note our use of Darboux’s Theorem 7.2.) This means that
f[x] = xx has an inverse for x > 1/e.
It turns out that the inverse function x = g[y] can not be expressed in terms of any of the
classical functions. In other words, there is no formula for g[y]. (This is similar to the non-
elementary integrals in the Mathematica NoteBook SymbolicIntegr. Computer algebra
systems have a non-elementary function ω[x] which can be used to express the inverse.) The
Inverse Function project has you compute the inverse approximately.
Example 5.6.
A Microscopic View of the Graph
We view the graph x = g[y] for the inverse as the graph y = f[x] with the roles of the
horizontal and vertical axes reversed. In other words, both functions have the same graph,
but we view y as the input to the inverse function g[y]. A microscopic view of the graph
can likewise be viewed as that of either y = f[x] or x = g[y].

Inverse Functions and Derivatives
61
dy
dx
y
y0
x0
x1
dy
dx
Figure 5.2: Small View of x = g[y] and y = f[x] at (x0, y0)
The ratio of a change in g-output dx to a change in g-input dy for the linear graph is
the reciprocal of the change in f-output dy to the change in f-input dx for the function.
In other words, if the inverse function really exists and is diﬀerentiable, we see from the
microscopic view of the graph that we should have
dy
dx = f ′[x0]
and
dx
dy =
1
dy/dx = g′[y0]
The picture is right, of course, and the Inverse Function Theorem 5.7 justiﬁes the needed
steps algebraically (in case you don’t trust the picture.)
Example 5.7.
The Symbolic Inverse Function Derivative
Assume for the moment that f[x] and g[y] are smooth inverse functions. Apply the Chain
Rule (in function notation) as follows.
x = g[f[x]]
dx
dx = g′[f[x]] · f ′[x]
1 = g′[f[x]] · f ′[x]
g′[f[x]] =
1
f ′[x]
At a point (x0, y0) on the graph of both functions, we have
g′[y0] =
1
f ′[x0]

62
5. The Theory of Derivatives
In diﬀerential notation, this reads like ordinary fractions,
x = g[y]
⇔
y = f[x]
dx
dy = g′[y]
⇔
dy
dx = f ′[x]
dx
dy = 1/dy
dx
A concrete example may help at this point.
Example 5.8.
Derivative of ArcTangent
x = ArcTan[y]
⇔
y = Tan[x]
dx
dy = ArcTan′[y]
⇔
dy
dx =
1
(Cos[x])2
ArcTan′[y] = dx
dy = 1/dy
dx = (Cos[x])2
Correct, but not in the form of a function of the same input variable y. We know that
Tan2[x] = Sin2[x]
Cos2[x] = y2 and Sin2[x] + Cos2[x] = 1, so we can express Cos2[x] in terms of y,
Sin2[x] + Cos2[x] = 1
1 + Sin2[x]
Cos2[x] =
1
Cos2[x]
1 + y2 =
1
Cos2[x]
Cos2[x] =
1
1 + y2
So we can write
ArcTan′[y] = (Cos[x])2 =
1
1 + y2
The point of this concrete example is that we can compute the derivative of the arctangent
even though we don’t have a way (yet) to compute the arctangent. In general, the derivative
of an inverse function at a point is the reciprocal of the derivative of the function. In this
case a trig trick lets us ﬁnd a general expression in terms of y as well.
Example 5.9.
Another Inverse Derivative
It is sometimes easier to compute the derivative of the inverse function and invert for the
derivative of the function itself – even if it is possible to diﬀerentiate the inverse function.
For example, if y = x2 + 1 and x = √y −1 when y ≥1, then dy
dx = 2x. The inverse function

Inverse Functions and Derivatives
63
rule says
dx
dy =
1/dy
dx = 1
2x
=
1
2√y −1
The point of the last two examples is that computing derivatives by reciprocals is some-
times helpful. The next result justiﬁes the method.
Theorem 5.7.
The Inverse Function Theorem
Suppose y = f[x] is a real function that is smooth on an interval containing a real
point x0 where f ′[x0] ̸= 0. Then
(a)
There is a smooth real function g[y] deﬁned when |y −y0| < ∆, for some
real ∆> 0.
(b)
There is a real ε > 0 such that if |x −x0| < ε, then |f[x] −y0| < ∆and
g[f[x]] = x.
g[y] is a “local” inverse for f[x].
Proof:
Suppose we have a function y = f[x] and know that f ′[x] exists on an interval around a
point x = x0 and we know the values y0 = f[x0] and m = f ′[x0] ̸= 0. In a microscope we
would see the graph
dy
dx
y
y0
x0
x1
dy
dx
Figure 5.3: Small View of y = f[x] at (x0, y0)
The point (dx, dy) = (0, 0) in local coordinates is at (x0, y0) in regular coordinates.
Suppose we are given y near y0, y ≈y0. In the microscope, this appears on the dy axis
at the local coordinate dy = y −y0. The corresponding dx value is easily computed by

64
5. The Theory of Derivatives
inverting the linear approximation
dy = m dx
m dx = dy
dx = dy/m
The value x1 that corresponds to dx = dy/m is dx = x1 −x0. Solve for x1,
x1 = x0 + dx
= x0 + dy/m
= x0 + (y −y0)/m
Does this value of x = x1 satisfy y = f[x1] for the value of y we started with? We wouldn’t
think it would be exact because we computed linearly and we only know the approximation
f[x0 + dx] = f[x0] + f ′[x0] dx + ε · dx
f[x1] = f[x0] + m · (x1 −x0) + ε · (x1 −x0)
We know that the error ε ≈0 is small when dx ≈0 is small, so we would have to move the
microscope to see the error. Moving along the tangent line until we are centered over x1,
we might see
?x
?y
Figure 5.4: Small View at (x1, y)
The graph of y = f[x] appears to be the parallel line above the tangent, because we have
only moved x a small amount and f ′[x] is continuous by Theorem 5.4. We don’t know how
to compute x = g[y] necessarily, but we do know how to compute y1 = f[x1]. Suppose we
have computed this and focus our microscope at (x1, y1) seeing

Inverse Functions and Derivatives
65
dy
dx
y
y1
x1
x2
dy
dx
Figure 5.5: Small View at (x1, y1)
We still have the original y ≈y1 and thus y still appears on the new view at dy = y −y1.
The corresponding dx value is easily computed by inverting the linear approximation
dy = m dx
m dx = dy
dx = dy/m
The x value, x2, that corresponds to dx = dy/m is dx = x2 −x1 with x2 unknown. Solve
for the unknown,
x2 = x1 + dx
= x1 + dy/m
= x1 + (y −y1)/m
This is the same computation we did above to go from x0 to x1, in fact, this gives a discrete
dynamical system of successive approximations
x0 = given
xn+1 = xn + (y −f[xn])/m
xn+1 = G[xn],
with
G[x] = x + (y −f[x])/m
The sequence of approximations is given by the general function iteration explained in
Chapter 20 of the main text,
x1 = G[x0],
x2 = G[x1] = G[G[x0]],
x3 = G[G[G[x0]]], · · ·
and we want to know how far we move,
lim
n→∞xn =?
The iteration function G[x] is smooth, in fact,
G′[x] = 1 −f ′[x]/m

66
5. The Theory of Derivatives
and in particular, G′[x0] = 1−f ′[x0]/m = 1−m/m = 0. By Theorem 5.4, whenever x ≈x0,
G′[x] ≈0. Diﬀerentiability of G[x] means that if xi ≈xj ≈x0,
G[xi] −G[xj] = G′[xj] · (xi −xj) + ι · (xi −xj)
|G[xi] −G[xj]| = |G′[xj] + ι| · |xi −xj|
|G[xi] −G[xj]| ≤r · |xi −xj|
for any real positive r, since G′[xj] ≈G′[x0] = 0 and some ι ≈0.
If y ≈y0, then x1 = x0 −(y −y0)/m ≈x0. Similarly, if xn ≈x0, then f[xn] ≈y and
xn+1 ≈x0, so |G[xn+1] −G[xn]| ≤r · |xn+1 −xn|. Hence,
|x2 −x1| = |G[x1] −G[x0]| ≤r|x1 −x0|
|x3 −x2| = |G[x2] −G[x1]| ≤r|x2 −x1| ≤r(r|x1 −x0|) = r2|x1 −x0|
|x4 −x3| = |G[x3] −G[x2]| ≤r|x3 −x2| ≤r(r2|x1 −x0|) = r3|x1 −x0|
and in general
|xn+1 −xn| ≤rn|x1 −x0|
The total distance moved in x is estimated as follows.
|xn+1 −x0| = |(xn+1 −xn) + (xn −xn−1) + (xn−1 −xn−2) + · · · + (x1 −x0)|
≤|xn+1 −xn| + |xn −xn−1| + |xn−1 −xn−2| + · · · + |x1 −x0|
≤rn|x1 −x0| + rn−1|x1 −x0| + . . . + |x1 −x0|
≤(rn + rn−1 + . . . + r + 1)|x1 −x0|
≤1 −rn+1
1 −r
|x1 −x0|
The sum 1 + r + r2 + r3 + · · · + rn = 1−rn+1
1−r
is a geometric series as studied in the main
text Chapter 25. Since limn→∞rn = 0 if |r| < 1, 1 + r + r2 + r3 + · · · + rn →
1
1 −r for
|r| < 1. Thus, for any y ≈y0 and any real r with 0 < r < 1,
|xn −x0| ≤
1
1 −r |x1 −x0|
for all n = 1, 2, 3, . . ..
Similar reasoning shows that when y ≈y0
|xk+n −xk| ≤rk
1
1 −r |x1 −x0|
because
|xk+1 −xk| ≤rk|x1 −x0|
|xk+2 −xk+1| = |G[xk+1] −G[xk]| ≤r|xk+1 −xk| ≤r(rk|x1 −x0|)
|xk+3 −xk+2| = |G[xk+2] −G[xk+1]| ≤r|xk+2 −xk+1| ≤r2(rk|x1 −x0|)
...

Inverse Functions and Derivatives
67
Take the particular case r = 2. We have shown in particular that whenever 0 < δ ≈0
and |y −y0| < δ, then for all k and n,
|xn −x0| ≤2|x1 −x0|
and
|xk+n −xk| ≤2
2k |x1 −x0|
and f[x] is deﬁned and |f ′[x] −f ′[x0]| < |m|/2 for |x −x0| < 3δ/|m|. By the Function
Extension Axiom 2.1, there must be a positive real ∆such that if |y −y0| < ∆, then for all
k and n,
|xn −x0| ≤2|x1 −x0|
and
|xk+n −xk| ≤2
2k |x1 −x0|
and f[x] is deﬁned and |f ′[x] −f ′[x0]| < |m|/2 for |x −x0| < 3∆/|m|. Fix this positive real
∆.
Also, if |x −x0| < E ≈0, then |f[x] −y0| < ∆with ∆as above. By the Function
Extension Axiom 2.1, there is a real positive ε so that if |x −x0| < ε < 3∆/|m|, then
|f[x] −y0| < ∆and |f ′[x] −f ′[x0]| < |m|/2.
Now, take any real y with |y −y0| < ∆and consider the sequence
x1 = G[x0],
x2 = G[x1] = G[G[x0]],
x3 = G[G[G[x0]]], · · ·
This converges because once we have gotten to the approximation xk, we never move beyond
that approximation by more than
|xk+n −xk| ≤2
2k |x1 −x0|
In other words, if we want an approximation good to one one millionth, we need only take
k large enough so that
2
2k |x1 −x0| ≤10−6
(1 −k) Log[2] + Log[|x1 −x0|] ≤−6 log[10]
k ≥Log[2] + Log[|x1 −x0|] + 6 Log[10]
Log[2]
This shows by an explicit error formula that the sequence xn converges. We deﬁne a real
function g[y] = limn→∞xn whenever |y −y0| < ∆. We can approximate g[y] = x∞using
the recursive sequence. (This is a variant of “Newton’s method” for uniform derivatives.)
Moreover, if |y −y0| < ∆, then f[x∞] is deﬁned and |f ′[x∞] −f ′[x0]| < |m|/2 because
|x∞−x0| ≤2|x1 −x0| = 2|y −y0|/|m| < 3∆/|m|.
Consider the limit
x∞= lim
n→∞xn
= lim
n→∞G[xn−1]
= G[ lim
n→∞xn−1]
= G[x∞]
x∞= x∞+ (y −f[x∞])/m
0 = (y −f[x∞])/m
y = f[x∞]

68
5. The Theory of Derivatives
so g[y] = x∞is the value of the inverse function and proves that the inverse function exists
in our real interval [x0 −ε, x0 + ε].
We conclude by showing that g[y] is diﬀerentiable. Take y1 ≈y2 in the interval (y0 −
∆, y0+∆), not near the endpoints. We know that f[xi] is deﬁned and |f ′[xi]| > |m|/2 where
xi = g[yi] for i = 1, 2.
We have x2 ≈x1 because the deﬁning sequences stay close. Let xi1 = x0 +(yi −f[x0])/m
and xi(n+1) = xin + (yi + f[xin])/m, for i = 1, 2. Then |x21 −x11| = |y2 −y1|/|m| ≈0
and since |xi −x0| < 3∆/|m|, f[x] is diﬀerentiable at xin. We can show inductively that
|x2(n+1) −x1(n+1)| < B ·
 y2−y1
m
 for some ﬁnite multiplier B when n is ﬁnite, because
x2(n+1) −x1(n+1) = (x2n −x1n) + y2 −y1
m
+ f[x2n] −f[x1n]
m
= (x2n −x1n) + y2 −y1
m
+ (f ′[x1n] + ι) · (x2n −x1n)
m
= y2 −y1
m
+

1 + f ′[x1n] + ι
m

· (x2n −x1n)
For any real positive θ, choose k large enough so that |xi −xik| <
2
2k |xi1 −x0| < θ/3. Then
|x2 −x1| < |x2 −x2k| + |x1 −x1k| + |x2k −x11k| < θ. Since θ is arbitrary, we must have
x2 ≈x1.
Diﬀerentiability of f[x] means that
f[x2] −f[x1] = f ′[x1](x2 −x1) + ι · (x2 −x1)
with ι ≈0. Solving for (x2 −x1) gives
(x2 −x1) =
y2 −y1
f ′[x1] + ι
g[y2] −g[y1] =
1
f ′[x1] + ι · (y2 −y1)
Since |f ′[x1]| > |m|/2,
1
f ′[x1]+ι =
1
f ′[x1] + η with η ≈0. Hence,
g[y2] −g[y1] =
1
f ′[x1] · (y2 −y1) + η · (y2 −y1)
and g[y] is diﬀerentiable with g′[y1] = 1/f ′[x1].

CHAPTER
6
Pointwise Derivatives
This chapter explores the pathological consequences of weakening
the deﬁnition of the derivative to only requiring the limit of diﬀer-
ence quotients to converge pointwise.
Could a function have a derivative of 1 at x = a and not be increasing near x = a?
Could we have F ′[x] = f[x] on [a, b] and yet not have R b
a f[x] dx = F[b] −F[a]?
The
strange answer is “yes” if you weaken the deﬁnition of derivative to allow only “pointwise”
derivatives. We chose Deﬁnition 5.2 because ordinary functions given by formulas do not
exhibit these pathologies, as shown in Theorem 5.5. We make the theory simple and natural
with Deﬁnition 5.2 and lose nothing more than strange curiosities. If f[x] is smooth on an
interval around x = a and f ′[a] = 1, then f[x] is increasing. (See Theorem 5.6.) The
Fundamental Theorem of Integral Calculus above holds for smooth functions, as our proof
shows, whereas a pointwise derivative need not even be integrable.
It is an unfortunate custom in many calculus texts to use the pointwise derivative. (As Pe-
ter Lax said in his lecture at a conference in San Jose, ‘No self-respecting analyst would study
the class of only pointwise diﬀerentiable functions.’) This chapter explores the pathologies
of the pointwise derivative and concludes with the connection with Deﬁnition 5.2 in Theo-
rem 7.4: If pointwise derivatives are continuous, they satisfy Deﬁnition 5.2. The contrast
of the straightforward proofs by approximation in this book with the round-about proofs of
things like the Fundamental Theorem in many “traditional” books is then clear. The Mean
Value Theorem 7.1 is used to make an approximation uniform. The traditional approach
obscures the approximation concepts, makes the Mean Value Theorem seem more central
than it actually is, and contributes no interesting new theorems other than the Mean Value
Theorem whose main role is to recover from the over-generalization using Theorem 7.4.
6.1
Pointwise Limits
This section reviews the idea of a limit both from the point of view of “ep-
silons and deltas” and inﬁnitesimals.
Suppose g[∆x] is a function that only depends on one real variable, ∆x, and is deﬁned
when 0 < |∆x| < b. (The function may or may not be deﬁned when ∆x = 0.) Let g0 be a
69

70
6. Pointwise Derivatives
number. The intuitive meaning of
lim
∆x→0 g[∆x] = g0
is that g[δx] is close to the value g0, when δx is small or close to zero, but not necessarily equal
to zero. (We exclude δx = 0, because we often have an expression which is not deﬁned at the
limiting value, such as g[∆x] = Sin[∆x]/∆x and want to know that lim∆x→0 Sin[∆x]/∆x =
1.) Technically, the limit is g0 if the natural extension function satisﬁes g[δx] ≈g0, whenever
0 ̸= δx ≈0.
We proved the following in Theorem 3.2.
Theorem 6.1.
Let g[∆x] be a function of one real variable deﬁned for 0 < |∆x| < b
and let g0 be a number. Then the following are equivalent deﬁnitions of
lim
∆x→0 g[∆x] = g0
(a)
For every nonzero inﬁnitesimal δx, the natural extension function satisﬁes
g[δx] ≈g0
(b)
For every real positive error tolerance, ε, there is a corresponding input
allowance D[ε], such that whenever the real value satisﬁes 0 < |∆x| < D[ε],
then
|g[∆x] −g0| < ε
Example 6.1.
lim∆x→0 Sin[π/∆x] does not exist
We want to see why a limit need not exist in the case
g[∆x] = Sin[ π
∆x]
Notice that g[∆x] is deﬁned for all real ∆x except ∆x = 0. The fact that it is not deﬁned
is not the reason that there is no limit. We will show below that
lim
∆x→0 ∆x Sin[ π
∆x] = 0
even though this second function is also undeﬁned at ∆x = 0.
We know from the 2π periodicity of sine that
Sin[θ] = +1
if
θ = 2kπ + π
2
and
Sin[θ] = −1
if
θ = 2kπ −π
2
whenever k = ±1, ±2, · · · is an integer. Hence we see that
g[∆x1] = Sin[ π
∆x1
] = +1
if
∆x1 =
1
2k + 1
2
g[∆x2] = Sin[ π
∆x2
] = −1
if
∆x2 =
1
2k −1
2
Intuitive Reason for No Limit
We can take k as large as we please, making ∆x1 and ∆x2 both close to zero, yet
g[∆x1] = +1 and g[∆x2] = −1, so there is no single limiting value g0.

Pointwise Limits
71
Figure 6.1: y = Sin[ π
∆x]
Rigorous Infinitesimal Reason for No Limit
We want an inﬁnite integer K, so we can let δx1 = 1/(2 K + 1
2) and δx2 = 1/(2 K −1
2)
and have δx1 ≈δx2 ≈0, g[δx1] = +1 and g[δx2] = −1. We can rigorously deﬁne inﬁnite
integers by function extension.
Let N[x] be the function that indicates whether or not a number is an integer,
N[x] =
(
0,
if x is not an integer
1,
if x is an integer
Then we know that if N[k] = 1, then Sin[(2 K ± 1
2)π] = ±1 (respectively). We also know
that every real number is within 1
2 unit of an integer; for every x, there is a k with |x−k| ≤1
2
and N[k] = 1. The natural extension of N[x] also has these properties, so given any inﬁnite
hyperreal H, there is another K satisfying |H−K| ≤1
2, N[K] = 1 and Sin[(2 K± 1
2)π] = ±1.
This technically completes the intuitive argument above, since we have two inﬁnitesimals
δx1 =
1
2K + 1
2
and δx2 =
1
2K −1
2
with g[δx1] a distance of 2 units from g[δx2].
Rigorous ε −D Reason for No Limit
No limit means that the negation of the ε −D statement holds for every real value
g0. Negation of quantiﬁers is tricky, but the correct negation is that for every g0, there is
some real ε > 0 so that for every real D > 0 there is a real ∆x such that |∆x| < D and
|g[∆x] −g0| ≥ε.
Let ε = 1
3 and let g0 and D > 0 be arbitrary real numbers. We know that we can take
an integer k large enough so that 0 < |∆x1| < |∆x2| < D, g[∆x1] = +1 and g[∆x2] = −1.
At most one of the two values can be within 1
3 of g0, because if |g[∆x1] −g0| < 1
3, then
|g[∆x2] −g0| ≥5
3 or vice versa. This shows that the negation of the ε −D statement holds.
Example 6.2.
lim∆x→0 ∆x Sin[π/∆x] = 0
Since | Sin[θ]| ≤1, |∆x Sin[anything]| ≤|∆x|, so if |∆x| is small, |∆x Sin[π/∆x]| is small.
The rigorous justiﬁcation with inﬁnitesimals is obvious and the rigorous ε −D argument
follows simply by taking D[ε] = ε.

72
6. Pointwise Derivatives
Figure 6.2: y = ∆x Sin[ π
∆x]
Exercise set 6.1
1. Show that lim∆x→0 ∆x2 Sin[π/∆x] = 0.
2. Show that lim∆x→0 ∆Cos[π/∆x2] does not exist.
6.2
Pointwise Derivatives
What happens if we apply the pointwise limit idea to g[∆x] = (f[x + ∆x] −
f[x])/∆x, “holding x ﬁxed”? In fact, many books use this to deﬁne the
following weak notion of derivative.
Deﬁnition 6.2.
Pointwise Derivative
We say that the function f[x] has pointwise derivative Dxf[x0] at a point x0 if
lim
∆x→0
f[x0 + ∆x] −f[x0]
∆x
= Dxf[x0]
What is the diﬀerence between this deﬁnition and Deﬁnition 5.2? We can explain this
either in terms of the ε−D deﬁnition, or in terms of inﬁnitesimals. In terms of ε−D limits,
the input allowance D[ε] can depend on the point x0 in the pointwise deﬁnition. In the
following example, f[x] = x2 Sin[π/x], a D[ε] that works at x = 0 does not work at x = √ε.
In terms of inﬁnitesimals, the increment approximation
f[x0 + δx] −f[x0] = f ′[x0] · δx + ε · δx

Pointwise Derivatives
73
only holds at ﬁxed real values. In the following example, this approximation fails at hyperreal
values like x = 1/(2 K).
Before we proceed with the example, we repeat an important observation of Theorem 5.5.
Derivatives computed by rules automatically satisfy the stronger approximation, provided
the formulas are valid on intervals. If you compute derivatives by rules, you know that you
will see straight lines in microscopic views of the graph. The next example shows that this
is false for the weaker approximation of pointwise derivatives.
Example 6.3.
A Non-Smooth, Pointwise Diﬀerentiable Function
From the exercise above, the following deﬁnition makes f[x] a continuous function,
f[x] =
(
0,
if x = 0
x2 Sin[ π
x],
if x ̸= 0
That is, limx→0 f[x] = f[0] = 0. Diﬀerentiation of f[x] by rules does not apply at x = 0,
since we obtain
f ′[x] = 2 x Sin[π
x ] −π Cos[π
x ]
which is undeﬁned at x = 0.
We can apply the pointwise deﬁnition of derivative to this function at x0 = 0,
lim
∆x→0
f[x0 + ∆x] −f[x0]
∆x
= lim
∆x→0
f[0 + ∆x] −f[0]
∆x
= lim
∆x→0
∆x2 Sin[ π
∆x] −0
∆x
= lim
∆x→0 ∆x Sin[ π
∆x] = 0
So the pointwise derivative at x = 0 isDxf[0] = 0.
If we focus a microscope at (x, y) = (0, 0) and magnify enough, we will see only a
horizontal straight line for the graph of y = x2 Sin[ π
x].
a)
b)
c)
Three Views of y = x2 Sin[ π
x]
However, if we ﬁrst magnify this much and then move the focus point to
x = 1/
p
magniﬁcation
we will no longer see a straight line, but rather a pure sinusoid!
Example 6.4.
Why we see a sinusoid

74
6. Pointwise Derivatives
Suppose we focus our microscope at the point x = 1/(2 K), for a very large K. We know
that Sin[ π
x] = ±1 for x = 1/(2 K ± 1
2). This makes the function values x2 Sin[ π
x] diﬀer by
1
(2 K −1
2)2 −
−1
(2 K + 1
2)2 =
1
(2 K)2

1
(1 −
1
4 K )2 +
1
(1 +
1
4 K )2

so that we see 2 after magniﬁcation by (2 K)2,
1
(1 −
1
4 K )2 +
1
(1 +
1
4 K )2 ≈2
We compute the distance between these x points,
1
2 K −1
2
−
1
2 K + 1
2
= 2 K + 1
2 −2 K + 1
2
(2 K −1
2)(2 K + 1
2)
=
1
4 K2 −1
4
=
1
(2 K)2
1
1 −
1
16 K2
These points are one unit apart on the 1/(2 K)2 scale,
1
1 −
1
16 K2
≈1
We will see a diﬀerence of two units in function values at magniﬁcation (2 K)2 and the
diﬀering points lie one unit apart at this magniﬁcation.
We can say more. If we magnify by 4 K2 and observe the function f[x + δx] with the
microscope centered at (x, 0) = (1/(2 K), 0), we see the magniﬁed values
4 K2(x + δx)2 Sin[
π
x + δx],
x ﬁxed,
δx varying.
But we also see magniﬁed values on the dx axis. Let δx = dx/(4 K2), for dx ﬁnite and let
F[dx] = 4 K2(x + δx)2 Sin[
π
x + δx]
with this relationship between the true δx and the dx we see in the microscope.
Our
microscopic view is the same as F[dx] at unit scale. The coeﬃcient in front of the sine
above is actually constant on the scale of our microscope,
4 K2(x + δx)2 = 4 K2( 1
2 K +
dx
4 K2 )2
= (2 K
2 K + dx 2 K
4 K2 )2
= (1 + dx
2 K )2
≈1

Pointwise Derivatives
75
for dx ﬁnite, so F[dx] ≈Sin[
π
x+δx] on this scale. By algebra (as in Chapters 5 and 28 of the
main text)
1
x + δx = 1
x +
−δx
x(x + δx)
= 2 K −
dx
(2 K)2( 1
2 K )( 1
2 K
+
dx
(2 K)2
= 2 K −
dx
1 + dx
2 K
≈2 K −dx
This means that Sin[π/(x+δx)] ≈Sin[2 K π−π dx] = −Sin[π dx]. At the point x = 1/(2 K)
with magniﬁcation (2 K)2, we see the function
dy = −Sin[π dx]
dx
dy
Figure 6.3: y = f[x] at x = 1/(2 K)
Example 6.5.
More Trouble with Pointwise Derivatives
The sinusoidal view we see in the microscope is just a hint of what can go wrong with
derivatives that are only given by pointwise limits. A pointwise derivative can be 1 and yet
the function need not be increasing near the point. The Fundamental Theorem of Integral
Calculus is false if we only assume that DxF(x) = f[x], because then
R b
a f[x] dx need not
exist. The section below on the Mean Value Theorem unravels the mystery. A pointwise
derivative Dxf[x] is a continuous function on an interval if and only if it is actually an
ordinary derivative, Dxf[x] = f ′[x].
Exercise set 6.2
1. Show that limx→0 f ′[x] = limx→0
 2 x Sin[ π
x] −π Cos[ π
x]

does not exist.

76
6. Pointwise Derivatives
2. Use Mathematica to Plot y = x2 Sin[ π
x] from -0.0001 to + 0.0001. Use AspectRatio ->
1 and PlotRange -> {-0.0001,0.0001}. You should see a straight line, but if you do not
control the PlotRange, you won’t. (Try the plot without setting equal scales.)
Now move the focus point of your microscope to x = 0.01. Plot from 0.0099 to 0.0101
with PlotRange -> {-0.0001,0.0001}. You will see a sinusoid. (If you use equal scales.)
3. Show that the function f[x] = x Sin[ π
x] is continuous if we extend its deﬁnition to
f[0] = 0. Show that the extended function does not even have a pointwise derivative at
x = 0. What do you see if you Plot this function at a very small scale at zero?
Show that the function f[x] = x3 Sin[ π
x] is continuous if we extend its deﬁnition to
f[0] = 0. Show that the extended function has a pointwise derivative at x = 0. What
do you see if you Plot this function at a very small scale near zero? Do wiggles appear?
Figure 6.4: y = x Sin[ π
x]
6.3
Pointwise Derivatives Aren’t Enough
for Inverses
A function can have a pointwise derivative at every point, Dfx[x0] = 1, but
not be increasing in any neighborhood of x0.
The function
w[x] =
(
0,
if x = 0
x + x2 Sin[ π
x],
if x ̸= 0
has pointwise derivative Dxw[0] = 1. However, this function does not have an inverse in
any neighborhood of zero. It is NOT increasing in any neighborhood of zero. You can verify
this yourself. Here are plots of w[x] on two scales:

Pointwise Derivatives Aren’t Enough for Inverses
77
y = w[x] = x + x2 Sin[ π
x]
−1 ≤x ≤1
and
0.0099 ≤x ≤0.0101
Exercise set 6.3
1.
(a) Show that the function w[x] above has an ordinary derivative at every x ̸= 0.
(b) Show that the function w[x] above has a pointwise derivative at every x, in par-
ticular, the pointwise derivative Dxw[0] = 1. (HINT: Write the deﬁnition and
estimate.)
(c) Verify the plots shown using Mathematica with equal scales. One plot is from
-1 to 1 and the other is from 0.0099 to 0.0101 both with AspectRatio -> 1 and
PlotRanges equal to x ranges.
(d) Prove that for every real θ > 0, there are numbers x1 < x2 with w[x1] > w[x2]
as shown on the decreasing portion of the small scale graph above.

78
6. Pointwise Derivatives

CHAPTER
7
The Mean Value Theorem
The following situation illustrates the main result of this chapter.
You travel a total distance of 100 miles in an elapsed time of 2 hours for an average or
“mean” speed of 50 mph. However, your speed varies. For example, you start from rest,
drive through city streets, stop at stop signs, then enter the Interstate and travel most of
the way at 65 mph. Were you ever going exactly 50 mph? Of course, but how can we show
this mathematically?
Exercise set 7.0
1. Sketch the graph of a trip beginning at 2 pm, 35 miles from a reference point, ending at
4 pm 135 miles from the point and having the features of stopping at stop signs, etc.,
as described above.
Sketch the line connecting the end points of the graph (a, f[a]) and (b, f[b]). What is
the slope of this line?
Find a point on your sketch where the speed is 50 mph and sketch the tangent line at
that point. Call the point c. Why does this satisfy f ′[c] = f[b]−f[a]
b−a
?
7.1
The Mean Value Theorem
The Mean Value Theorem asserts that there is a place where the value of
the instantaneous speed equals the average speed. This theorem is true even
if the derivative is only deﬁned pointwise.
We want to formulate the speed problem above in a general way for a function y = f[x]
on an interval [a, b]. You may think of x as the time variable with x = a at the start of the
trip and x = b at the end. The elapsed time traveled is b −a, or 2 hours in the example.
(Perhaps you start at 2 and end at 4, 4 - 2 = 2.) You may think of y = f[x] as a distance
from a reference point, so we start at f[a], end at f[b] and travel a total of f[b] −f[a]. The
average speed is (f[b] −f[a])/(b −a).
79

80
7. The Mean Value Theorem
We state the Mean Value Theorem in its ultimate generality, only assuming weakly
approximating pointwise derivatives and those only at interior points. This complicates the
proof, but will be the key to seeing why regular derivatives and pointwise derivatives are
the same when the pointwise derivative is continuous.
Theorem 7.1.
The Mean Value for Pointwise Derivatives
Let f[x] be a function which is pointwise diﬀerentiable at every point of the open
interval (a, b) and is continuous on the closed interval [a, b]. There is a point c in
the open interval a < c < b such that
Dxf[c] = f[b] −f[a]
b −a
Figure 7.1: Mean Slope and Tangents
There may be more than one point where Dxf[c] equals the mean speed or slope.
Proof
The average speed over a sub-interval of length ∆x is
g[x] = f[x + ∆x] −f[x]
∆x
and this new function is deﬁned and continuous on [a, b −∆x].
Suppose we let ∆x1 = (b −a)/3 compute the average of 3 averages, the speeds on
[a, a + ∆x1], [a + ∆x1, a + 2∆x1] and [a + 2∆x1, a + 3∆x1]. This ought to be the same as

The Mean Value Theorem
81
the overall average and the telescoping sum below shows that it is:
1
3 (g[a] + g[a + ∆x1] + g[a + 2∆x1]) =
1
3
f[a + ∆x1] −f[a]
∆x1
+ f[a + 2∆x1] −f[a + ∆x1]
∆x1
+ f[a + 3∆x1] −f[a + 2∆x1]
∆x1

= f[a + ∆x1] −f[a] + f[a + 2∆x1] −f[a + ∆x1] + f[a + 3∆x1] −f[a + 2∆x1]
3∆x1
= −f[a] + f[b]
3 b−a
3
= f[b] −f[a]
b −a
This implies that there is an adjacent pair of sub-intervals with
g[xlo] = f[xlo + ∆x1] −f[xlo]
∆x1
≤f[b] −f[a]
b −a
≤f[xhi + ∆x1] −f[xhi]
∆x1
= g[xhi]
because the average of the three sub-interval speeds equals the overall average and so either
all three also equal the overall average, or one is below and another is above the mean slope.
(We know that xlo and xhi diﬀer by ∆x1, but we do not care in which order they occur
xlo < xhi or xhi < xlo.)
Since g[x] is continuous, Bolzano’s Intermediate Value Theorem 4.5 says that there is an
x1 between xlo and xhi with g[x1] = (f[x1 + ∆x1] −f[x1])/∆x1 = (f[b] −f[a])/(b −a). The
subinterval [x1, x1 + ∆x1] lies inside (a, b), has length (b −a)/3 and f[x] has the same mean
slope over the subinterval as over the whole interval. (So far we have only used continuity
of f[x].)
Let ∆x2 = (b −a)/32, one third of the length of [x1, x1 + ∆x1]. We can repeat the
average of averages procedure above on the interval [x1, x1 + ∆x1] and obtain a new sub-
interval [x2, x2 + ∆x2] inside the old sub-interval such that (f[x2 + ∆x2] −f[x2])/∆x2 =
(f[b] −f[a])/(b −a).
Continuing recursively, we can ﬁnd xn in (xn−1, xn−1 + ∆xn−1) with ∆xn = (b −a)/3n
and (f[xn + ∆xn] −f[xn])/∆xn = (f[b] −f[a])/(b −a).
The sequence of numbers an = xn increases to a limit c in (a, b), and the sequence
bn = xn + ∆xn decreases to c. In addition, we have
f[b] −f[a]
b −a
= f[xn + ∆xn] −f[xn]
∆xn
= f[bn] −f[an]
bn −an
= f[bn] −f[c] + f[c] −f[an]
bn −an
= bn −c
bn −an
f[bn] −f[c]
bn −c
+ c −an
bn −an
f[c] −f[an]
c −an
Notice that coeﬃcients are positive and satisfy
bn −c
bn −an
+ c −an
bn −an
= 1
Also notice that
lim
n→∞
f[bn] −f[c]
bn −c
= lim
n→∞
f[c] −f[an]
c −an
= Dxf[c]

82
7. The Mean Value Theorem
Hence
lim
n→∞
bn −c
bn −an
f[bn] −f[c]
bn −c
+ c −an
bn −an
f[c] −f[an]
c −an
= Dxf[c]
and we have proved the general result of the graphically ‘obvious’ Mean Value Theorem,
by ﬁnding a sequence of shorter and shorter sub-intervals with the same mean slope and
‘taking the limit.’
Exercise set 7.1
1. Suppose f[x] satisﬁes Deﬁnition 5.2. Show that the step in the proof of the Mean Value
Theorem where we write
bn −c
bn −an
f[bn] −f[c]
bn −c
+ c −an
bn −an
f[c] −f[an]
c −an
can be skipped. If we take an inﬁnite n, we must automatically have
f[bn] −f[an]
bn −an
≈f ′[an] ≈f ′[bn] ≈f ′[c]
when f[x] satisﬁes Deﬁnition 5.2. Why?
2. This exercise seeks to explain why we call the fraction
f[b] −f[a]
b −a
the average speed in the case of the ordinary derivative, Deﬁnition 5.2.
The average of a continuous function g[x] over the interval [a, b] is
1
b −a
Z b
a
g[x] dx
If f[x] satisﬁes Deﬁnition 5.2, show that the average of the speed is
1
b −a
Z b
a
f ′[x] dx = f[b] −f[a]
b −a
What theorem do you use to make this general calculation? Why do you need Deﬁni-
tion 5.2 rather than only a pointwise derivative?
Write an approximating sum for the integral and substitute the microscope approxima-
tion f ′[x] δx = f[x + δx] −f[x] −ε δx as the summand. The latter sum telescopes to
f[b] −f[a] with your adjusting constants.
Write the average of small interval speeds, (f[x + δx] −f[x])/(δx) for enough terms to
move from a to b. How many terms are there in the sum? Why is this sum
1
(b −a)/δx
b−δx
X
x=a
step δx
f[x + δx] −f[x]
δx

approximately the integral above?

Darboux’s Theorem
83
3. Alternate Proof to Averaging Averages
Let f[x] satisfy the hypotheses of the Mean Value Theorem for Pointwise Derivatives.
Let the constant m denote the mean slope,
m = f[b] −f[a]
b −a
Deﬁne a function
h[x] = f[x] −m · (x −a)
Show that h[x] has the following properties:
(a) h[x] is continuous on [a, b].
(b) h[x] is pointwise diﬀerentiable on (a, b).
(c) h[a] = f[a]
(d) h[b] = f[a] = h[a], so that the mean slope of h[x] is zero,
h[b] −h[a]
b −a
= 0
(e) For any x, we have
Dxh[x] = 0
⇔
Dxf[x] = m
The function h[x] has a horizontal mean cord. We want you to show that there
is a point c in (a, b) where Dxh[c] = 0.
(f) Show that h[x] satisﬁes the hypotheses of the Extreme Value Theorem 4.4 on
[a, b], hence must have both a max and a min.
(g) Show that either h[x] is constant or not both the max and min occur at endpoints.
In other words, there is a c in the open interval (a, b) where either h[c] is a max
or min for [a, b].
(h) Prove a pointwise version of the the Interior Critical Points Theorem 10.2 from
the main text and show that Dxh[c] = 0.
(i) Show that Dxf[c] = (f[b] −f[a])/(b −a).
7.2
Darboux’s Theorem
Suppose that f[x] is pointwise diﬀerentiable, but Dxf[x] is not necessarily
continuous. The derivative function still has the intermediate value prop-
erty. In other words, a derivative cannot be deﬁned and take a jump in val-
ues. (Pointwise derivatives can oscillate to a discontinuity, be deﬁned, and
NOT be continuous. Ordinary derivatives are continuous by Theorem 5.4)
How do we know that it is suﬃcient to just check one point between the zeros of f ′[x]
in the graphing procedure of the main text Chapter 9? If f ′[x] is not zero in an interval
a < x < b and if f ′[x] cannot change sign without being zero, then the sign of any one point
determines the sign of all the others in the interval. Derivatives have the property that they
cannot change sign without being zero, but not every function has this property.

84
7. The Mean Value Theorem
It was 5◦C when I woke up this morning, but has warmed up to a comfortable 16◦
now (61◦F). Was it ever 10◦this morning? Most people would say, ‘Yes.’ They implicitly
reason that temperature ‘moves continuously’ through values and hence hits all intermediate
values. This idea is a precise mathematical theorem and its most diﬃcult part is in correctly
formulating what we mean by ‘continuous’ function. See Theorem 4.5.
Darboux’s Theorem even holds for the discontinuous weak pointwise derivatives deﬁned
above. We showed in Theorem 5.4 that our deﬁnition of f ′[x] makes it a continuous function.
This means we can apply Bolzano’s Theorem to f ′[x] to prove the case of Darboux’s theorem
for the ordinary derivatives we have deﬁned. This is the result:
Theorem 7.2.
Darboux’s Intermediate Value Theorem
If f ′[x] exists on the interval a ≤x ≤b, then f ′[x] attains every value intermediate
between the values f ′[a] and f ′[b]. In particular, if f ′[a] < 0 and f ′[b] > 0, then
there is an x0, a < x0 < b, such that f ′[x0] = 0.
Theorem 7.3.
Intermediate Values for Pointwise Derivatives
Suppose that f[x] is pointwise diﬀerentiable at every point of [a, b].
Then the
derivative function Dxf[x] attains every value between Dxf[a] and Dxf[b], even
though it can be discontinuous.
Proof:
The functions
g[x] =
(
Dxf[a],
if x = a
f[x]−f[a]
x−a
,
if x ̸= a
and
h[x] =
( f[b]−f[x]
b−x
,
if x ̸= b
Dxf[b],
if x = b
are continuous on [a, b]. The function g[x] attains every value between Dxf[a] and [f[b] −
f[a]]/[b −a], while h[x] attains every value between [f[b] −f[a]]/[b −a] and Dxf[b]. Con-
sequently, one or the other attains every value between Dxf[a] and Dxf[b] by Bolzano’s
Intermediate Value Theorem 4.5. In either case, an intermediate value v satisﬁes
v = f[β] −f[α]
β −α
so the Mean Value Theorem for Derivatives above asserts that there is a γ with Dxf[γ] = v.
This proves the theorem.
Exercise set 7.2
1. Show that the function y = j[x] =
√
x2+2x+1
x+1
equals −1 when x = −2, equals +1 when
x = +3, but never takes the value y = 1
2 for any value of x. Why doesn’t j[x] violate
Bolzano’s Theorem 4.5?
2. 1) Show that the function y = k[x] =
√
x2 + 2x + 1 has k′[x] = −1 when x = −2, has
k′[x] = +1 when x = +3, but k′[x] never takes the value y′ = 1
2 for any value of x.
Why doesn’t k[x] violate Darboux’s Theorem above?
2) In the graphing procedures using the ﬁrst and second derivatives, you must compute
all values where the derivative is zero or fails to exist. Why is this a crucial part of

Continuous Pointwise Derivatives are Uniform
85
making the shape table? In particular, suppose you missed one x value where f ′[x] failed
to exist or was zero. How could this lead you to make an incorrect graph?
7.3
Continuous Pointwise Derivatives
are Uniform
Pointwise derivatives are peculiar because they do not arise from computa-
tions with rules of calculus. This section explores the question of when a
pointwise derivative is actually the stronger uniform kind. The answer is
simple.
Theorem 7.4.
Continuous Pointwise Derivatives are Uniform
Let f[x] be deﬁned on the open interval (a, b). The following are equivalent:
(a)
The function f[x] is smooth with derivative f ′[x] on (a, b) as deﬁned Deﬁ-
nition 5.2.
(b)
The pointwise derivative exists at every point of (a, b) and deﬁnes a contin-
uous function, Dxf[x] = g[x].
(c)
The double limit
lim
x1→x,x2→x
f[x2] −f[x1]
x2 −x1
= h[x]
exists at every point x in (a, b).
Proof
(1) ⇒(3) : Assume that (1) holds. Let x2 ≈x1 ≈x0, a real value in (a, b). Then
x2 = x1 + δx with δx = x2 −x1 ≈0 and x1 is not inﬁnitely near the ends of the interval
(a, b). By smoothness at x1,
f[x2] = f[x1] + f ′[x1] · (x2 −x1) + ε · (x2 −x1)
so [f[x2] −f[x1]]/[x2 −x1] ≈f ′[x1]. We know from Theorem 5.39 of the main text that
f ′[x] is continuous, so f ′[x1] ≈f ′[x0] and we have shown that for any real value x0 in (a, b)
and any pair of nearby values,
f[x2] −f[x1]
x2 −x1
≈f ′[x0]
which is equivalent to (3).
(3) ⇒(2): Now assume (3). As a special case of the double limit, we may let x1 = x0
and take limx2→x0[f[x2] −f[x0]]/[x2 −x0] = h[x0] = Dxf[x0], showing that the pointwise
derivative exists. It remains to show that h[x] = Dxf[x] is continuous.
If x1 ≈x0, we need to show that h[x1] ≈h[x0]. We may apply the Function Extension
Axiom to show that given an inﬁnitesimal ε, for ‘suﬃciently small’ diﬀerences between x2

86
7. The Mean Value Theorem
and x1,
f[x2] −f[x1]
x2 −x1
= Dxf[x1] + ε1
with |ε1| < ε. We know that Dxf[x] = h[x] at all real points, hence by Extension, at all
hyperreal points and h[x1] ≈[f[x2] −f[x1]]/[x2 −x1].
The double limit means that whenever x2 ≈x1 ≈x0,
f[x2] −f[x1]
x2 −x1
≈h[x0]
Hence, h[x1] ≈h[x0] and h[x] = Dxf[x] is continuous.
(2) ⇒(1): Finally, assume that the pointwise derivative exists at every point of (a, b)
and that g[x] = Dxf[x] is continuous. This means that for any real x0 in (a, b) and x1 ≈x0,
we have g[x0] ≈g[x1]. We must show that for any ﬁnite x in (a, b), not inﬁnitely near an
endpoint, and any inﬁnitesimal δx,
f[x + δx] = f[x] + Dxf[x] · δx + ε · δx
for an inﬁnitesimal ε.
By the Mean Value Theorem on [x, x + δx], there is an x1 in (x, x + δx) such that
f[x + δx] −f[x]
δx
= Dxf[x1]
By the continuity hypothesis, since x ≈x1, we have Dxf[x] ≈Dxf[x1], so Dxf[x] =
Dxf[x1] + ε, with ε ≈0. This means
f[x + δx] −f[x]
δx
= Dxf[x] + ε
so by algebra we have shown (1) with f ′[x] = Dxf[x]:
f[x + δx] = f[x] + Dxf[x] · δx + ε · δx
We have shown (1) ⇒(3) ⇒(2) ⇒(1), so all three conditions are equivalent.

CHAPTER
8
Higher Order Derivatives
This chapter relates behavior of a function to its successive deriva-
tives.
The derivative is a function; its derivative is the second derivative of the original function.
Taylor’s formula is a more accurate local formula than the “microscope approximation”
based on a number of derivatives. It has versions for each order of derivative and has many
uses. Taylor’s formula of order n is equivalent to having n successive derivatives.
Higher order derivatives can also be deﬁned directly in terms of local properties of a
function. The ﬁrst derivative arises from a local ﬁt by a linear function. We can successfully
ﬁt a quadratic locally if and only if the function has two derivatives. We give a general
result for nth order ﬁt and n derivatives.
8.1
Taylor’s Formula and Bending
The ﬁrst derivative tells the slope of a graph and the second derivative
says which way the graph bends. This section gives algebraic forms of the
graphical “smile” and “frown” icons that say which way a graph bends.
When the second derivative is positive, a curve bends upward like part of a smile. When
the second derivative is negative, the curve bends downward like part of a frown. The smile
and frown icons are based on a simple intuitive mathematical idea: when the slope of the
tangent increases, the curve bends up. We have two questions. (1) How can we formulate
bending symbolically? (2) How do we prove that the formulation is true? First things ﬁrst.
If a curve bends up, it lies above its tangent line. Draw the picture. The tangent line at
x0 has the formula y = b+m(x−x0) with b = f[x0] and m = f ′[x0]. If the graph lies above
the tangent, f[x1] should be greater than b + m(x1 −x0) = f[x0] + f ′[x0](x1 −x0) or
f[x1] > f[x0] + f ′[x0](x1 −x0)
This is the answer to question (1), but now we are faced with question (2): How do we
prove it? The increment approximation says
f[x1] = f[x0] + f ′[x0](x1 −x0) + ε(x1 −x0)
87

88
8. Higher Order Derivatives
so this direct formulation of ‘bending up’ requires that we show that the whole error ε(x1 −
x0) stays positive for x1 ≈x0. All we have to work with is the increment approximation
for f ′[x] and the fact that f ′′[x0] > 0. A direct proof is not very easy to give - at least we
don’t know a simple one.
We have formulated the result as follows.
Theorem 8.1.
Local Bending
Suppose the function f[x] is twice diﬀerentiable on the real interval a < x < b and
x0 is a real point in this interval.
(a)
If f ′′[x0] > 0, then there is a real interval [α, β], a < α < x0 < β < b, such
that y = f[x] lies above its tangent over [α, β], that is,
α ≤x1 ≤β
⇒
f[x1] > f[x0] + f ′[x0](x1 −x0)
(b)
If f ′′[x0] < 0, then there is a real interval [α, β], a < α < x0 < β < b, such
that y = f[x] lies below its tangent over [α, β], that is,
α ≤x1 ≤β
⇒
f[x1] < f[x0] + f ′[x0](x1 −x0)
Proof:
This algebraic formulation of convexity (or bending) follows easily from the second order
Taylor formula. This formula approximates by a quadratic function in the change variable
δx (where x is considered ﬁxed), not just a linear function in δx. A general higher order
Taylor Formula is proved later in this chapter. We want to use the second order case as
follows to show the algebraic form of the smile icon.
Theorem 8.2.
The Second Order Taylor Small Oh Formula
If f[x] is twice diﬀerentiable on a real interval (a, b), a < x < b and x is not
inﬁnitely near a or b, then for any inﬁnitesimal δx
f[x + δx] = f[x] + f ′[x] δx + 1
2f ′′[x](δx)2 + ε · δx2
with ε ≈0.
Suppose that f ′′[x0] > 0 at the real value x0.
If x1 ≈x0, substitute x = x0 and
δx = x1 −x0 into Taylor’s Second Order Formula to show:
f[x + δx] = f[x] + f ′[x] δx + 1
2f ′′[x](δx)2 + ε · δx2
f[x1] = f[x0] + f ′[x0] (x1 −x0) + 1
2f ′′[x0] (x1 −x0) + ε (x1 −x0)2
The inﬁnitesimal smile formula follows from using the fact that 1
2(f ′′[x0] + ε)(x1 −x0)2 > 0
f[x1] > f[x0] + f ′[x0] (x1 −x0)
The Function Extension Axiom 2.1 says that since f[x1] > f[x0] + f ′[x0] (x1 −x0) for
all |x1 −x0| < d, for inﬁnitesimal d, there must be a non-inﬁnitesimal D such that f[x1] >
f[x0] + f ′[x0] (x1 −x0) whenever |x1 −x0| < D. This proves the Local Bending Theorem.

Symmetric Diﬀerences and Taylor’s Formula
89
Exercise set 8.1
1. Give an algebraic condition that says a curve bends downward. One way to do this is to
“say” the curve lies below its tangent line. Prove that your condition holds for a small
real interval containing x0 provided f ′′[x0] < 0.
8.2
Symmetric Diﬀerences and Tay-
lor’s Formula
The symmetric diﬀerence
f[x + δx/2] −f[x −δx/2]
δx
≈f ′[x]
gives a more accurate approximation to ﬁrst derivative than the formula
(f[x + δx] −f[x])/δx ≈f ′[x].
In the computations for Galileo’s Law of Gravity in Chapter 10 of the main text, we
used symmetric diﬀerences to approximate the derivative. There is an obvious geometric
reason to suspect this is a better approximation. Look at the ﬁgure below. Graphically, the
approximation of slope given by the symmetric diﬀerence is “clearly” better on a “typical”
graph as illustrated in Figure 8.1 below.
A line through the points (x, f[x]) and (x + δx, f[x + δx]) is drawn with the tangent at x
in the left view , while a line through (x−δx, f[x−δx]) and (x+δx, f[x+δx]) is drawn with
the tangent at x in the right view. The second slope is closer to the slope of the tangent,
even though the line does not go through the point of tangency.
a)
b)
Figure 8.1: (f[x + δx] −f[x])/δx
and
(f[x + δx] −f[x −δx])/δx
Now we use the second order Taylor formula to prove the algebraic form of this geometric

90
8. Higher Order Derivatives
condition. Substitute δx/2 and −δx/2 into Taylor’s Second Order Formula to obtain
f[x + δx/2] = f[x] + f ′[x]δx/2 + 1
8f ′′[x] (δx)2 + ε1δx2
f[x −δx/2] = f[x] −f ′[x]δx/2 + 1
8f ′′[x] (δx)2 + ε2δx2
subtract the two to obtain
f[x + δx/2] −f[x −δx/2] = f ′[x]δx + (ε1 + ε2) δx2
Solve for f ′[x] obtaining
f ′[x] = f[x + δx/2] −f[x −δx/2]
δx
−ε4 δx
with ε4 ≈0. This formula algebraically a better approximation for f ′[x] than the ordinary
increment approximation f[x + δx] = f[x] + f ′[x]δx + ε3δx which gives
f ′[x] = f[x + δx] −f[x]
δx
−ε3
Note the importance of δx being small: ε4 · δx is a product of two small quantities.
Exercise set 8.2
1.
(a) Sketch the line through the points (x−δx, f[x−δx]) and (x, f[x]) on the left view
of Figure 8.1.
(b) Substitute x ± δx into Taylor’s second order formula and do some algebra to
obtain the approximation
f ′[x] = f[x + δx] −f[x −δx]
2 δx
+ ε5 · δx
(c) Show that the average of the slopes of the two secant lines on the left ﬁgure is
(f[x + δx] −f[x −δx])/(2δx), the same as the slope of the symmetric secant line
in the second view.
(d) A quadratic function q[dx] in the local variable dx that matches the graph y = f[x]
at the three x values, x −δx, x, and x + δx is given by
q[dx] = y1 + y2 −y1
δx
dx + y3 −2y1 + y2
2δx2
[dx(dx −δx)]
where y1 = f[x], y2 = f[x + δx] and y3 = f[x −δx]. Verify that the values agree
at these points by substituting the values dx = 0, dx = δx and dx = −δx into
q[dx].
(e) Show that the derivative q′[0] = (f[x + δx] −f[x −δx])/(2δx), the same as the
symmetric secant line slope.
A quadratic ﬁt gives the same slope approximation as the symmetric one, which is also
the same as the average of a left and right approximation. All these approximations are
“second order.”

Approximation of Second Derivatives
91
It is interesting to compare numerical approximations to the derivative in a diﬃcult, but
known case. The experiments give a concrete form to the error estimates of the previous
exercise. When we only have data (such as in the law of gravity in Chapter 9 of the main text
or in the air resistance project in the Scientiﬁc Projects), we must use an approximation.
In that case the symmetric formula is best.
2. Numerical Diﬀerence Experiments
In the Project on Exponentials, you compute the derivative of y = bt directly from
the increment approximation. Type and enter the following Mathematica program and
compare the two methods of ﬁnding y′[0]
b = 2;
y[t ] := b∧t;
t = 0;
Do[
dt = 0.5∧n;
Print[dt,(y[t + dt] - 1)/dt,(y[t + dt] - y[t - dt])/(2 dt)]
,{n,0,16}]
N[Log[b],10]
8.3
Approximation of Second Deriva-
tives
f ′′[x] = f[x + δx] −2f[x] + f[x −δx]
δx2
+ ε
Substitute δx and −δx into Taylor’s Second Order Formula to obtain
f[x + δx] = f[x] + f ′[x]δx + 1
2f ′′[x] (δx)2 + ε1δx2
f[x −δx] = f[x] −f ′[x]δx + 1
2f ′′[x] (δx)2 + ε2δx2
add the two to obtain
f[x + δx] −2f[x] + f[x −δx] = f ′′[x]δx2 + (ε1 + ε2) δx2
Solve for f ′′[x] to give a formula approximating the second derivative with values of the
function:
f ′′[x] = f[x + δx] −2f[x] + f[x −δx]
δx2
+ ε
Exercise set 8.3

92
8. Higher Order Derivatives
1. Second Diﬀerences for Second Derivatives
(a) The acceleration data in the electronic homework for the Chapter on velocity
and acceleration is obtained by taking diﬀerences of diﬀerences. Suppose three
x values are x −δx, x and x + δx. Two velocities correspond to the diﬀerence
quotients
f[x] −f[x −δx]
δx
&
f[x + δx] −f[x]
δx
Compute the diﬀerence of these two diﬀerences and divide by the correct x step
size. What formula do you obtain?
(b) Compare the approximation for f ′′[x] preceding the Exercise Set to the answer
from part (a) of this exercise. What does the comparison tell you?
(c) Make a program like the one in Exercise 8.2.2 above to compute this direct nu-
merical approximation to the second derivative and compare it with the exact
symbolically calculated derivative of bt.
8.4
The General Taylor Small Oh For-
mula
The general higher order Taylor formula is the following approximation of
the change function g[δx] = f[x+δx] by a polynomial in the change variable
δx (or sometimes dx) when x is held ﬁxed.
Continuity of all the derivatives is equivalent to the fact that the approximation works
for all the values of x strictly inside the interval. The converse result is given below.
Theorem 8.3.
Taylor’s Small Oh Formula
Suppose that the real function f[x] has n real function continuous derivatives on
the interval (a, b). If x is not inﬁnitely near a or b and δx ≈0 is inﬁnitesimal,
then the natural extension functions satisfy
f[x+δx] = f[x]+f ′[x]·δx+1
2f ′′[x]·δx2+ 1
3 · 2f (3)[x]·δx3+· · ·+ 1
n!f (n)[x]·δxn+ε·δxn
for ε ≈0.
Equivalently,for every compact subinterval [α, β] ⊂(a, b),
lim
∆x→0
f[x + ∆x] −
 f[x] + f ′[x] · δx + 1
2f ′′[x] · ∆x2 + · · · + 1
n!f (n)[x] · ∆xn
∆xn
= 0
uniformly in [α, β].
Before we give the proof of this approximation formula, we would like you to see for
yourself how it looks. The claim of the theorem is “local,” that is, the approximations are

The General Taylor Small Oh Formula
93
better than δxn, but only for small δx, or only ‘in the limit.’ (Notice that if δx = 0.01 and
n = 3, this means that the error is small compared to δx3 = 0.000001.)
Figure 8.2: Sine and Taylor
You will need to review Integration by Parts from Chapter 12 of the main text,
Z b
a
F[u] dG[u] = F[x] G[x]|b
a −
Z b
a
G[u] dF[u]
in order to follow the proof of Taylor’s formula.
Taylor’s Remainder Formula using Integration by Parts
When n = 1, Taylor’s approximation is the increment equation of Deﬁnition 5.2. However,
we want to derive a general formula for the error ε using integration. In the case where
n = 1, this is just uses the Fundamental Theorem of Integral Calculus 5.1.
Z δx
0
[f ′[x + u] −f ′[x]] du =
Z δx
0
f ′[x + u] du −
Z δx
0
f ′[x] du
=
Z δx
0
f ′[x + u] du −f ′[x]
Z δx
0
du
=
Z δx
0
f ′[x + u] du −f ′[x] · δx
= f[x + δx] −f[x] −f ′[x] · δx
because if we take F[u] = f[x+u], then dF[u] = f ′[x+u] du and the Fundamental Theorem
of Integral Calculus says
R b
a dF[u] = F[b] −F[a]. Rearranging the calculation we have the
ﬁrst order formula
f[x + δx] = f[x] + f ′[x] · δx +
Z δx
0
[f ′[x + u] −f ′[x]] du

94
8. Higher Order Derivatives
Integration by Parts shows
f[x + δx] = f[x] + f ′[x] · δx + 1
2f ′′[x] · δx2 + · · ·
· · · + 1
n!f (n)[x] · δxn + δx(n−1)
(n −1)! ·
Z δx
0
(1 −u/δx)(n−1) [f (n)[x + u] −f (n)[x]] du
because
δx(n−1)
(n −1)! · f (n)[x] ·
Z δx
0
(1 −u/δx)(n−1) du = δx(n−1)
(n −1)! · f (n)[x] · δx
n = δxn
n! · f (n)[x]
and Integration by Parts with F[u] = (1 −u/δx)(n−1) and dG[u] = f (n)[x + u] du gives
δx(n−1)
(n −1)! ·
Z δx
0
(1 −u/δx)(n−1) f (n)[x + u] du =
−δx(n−1)
(n −1)! · f (n−1)(x) + δx(n−2)
(n −2)! ·
Z δx
0
(1 −u/δx)(n−2) f (n−1)[x + u] du
which could be further reduced (or used as an inductive hypothesis),
δx(n−2)
(n −2)!·
Z δx
0
(1 −u/δx)(n−2) [f (n−1)[x + u] −f (n)[x]] du
=
1
(n −2)!f (n−2)[x] · δx(n−2) + δx(n−3)
(n −3)! ·
Z δx
0
(1 −u/δx)(n−3) f (n−2)[x + u] du
...
The Error Formula: We have shown that
f[x + δx] = f[x] + f ′[x] · δx + 1
2f ′′[x] · δx2 +
1
3 · 2f (3)[x] · δx3 + · · · + 1
n!f (n)[x] · δxn + ε · δxn
with the explicit formula
ε = 1
δx
Z δx
0
(1 −u/δx)(n−1)
(n −1)!
[f (n)[x + u] −f (n)[x]] du
Now we will show that ε is small when δx is small.
Proof of Taylor’s Small Oh Formula
To show that ε ≈0, it is suﬃcient to notice that continuity makes f (n)[x+u]−f (n)[x] ≈0
for 0 ≤u ≤δx, so the maximum
m = Max[|f (n)[x + u] −f (n)[x]| : 0 ≤u ≤δx] ≈0
and
|ε| ≤m
δx
Z δx
0
(1 −u/δx)(n−1)
(n −1)!
du
= m
δx · δx
n! = m
n! ≈0
This completes the proof. The equivalent “epsilon - delta” condition follows as in the proof
of Theorem 3.4.

The General Taylor Small Oh Formula
95
8.4.1
The Converse of Taylor’s Theorem
Theorem 8.4.
The Converse of Taylor’s Theorem
Let f[x] be a real function deﬁned on an interval (α, ω). Suppose there are real
functions ah[x], h = 0, · · · , k, deﬁned on (α, ω) such that whenever a hyperreal x is
in (α, ω) and not inﬁnitely near the endpoints, and δx ≈0, the natural extensions
satisfy
f[x + δx] =
k
X
h=0
1
h! ah[x] δxh + ε · δxk
with ε ≈0. Then f[x] is k-times diﬀerentiable with derivatives f (h)[x] = ah[x].
Proof:
First, we show that the coeﬃcient functions are continuous. Consider k = 0. Take δx = 0
to see that f[x + 0] = a0[x] + 0. Take δx ≈0 to see f[x] is continuous,
f[x + δx] = f[x] + ε
with ε ≈0.
Consider k = 1 and take two inﬁnitesimals δx0 and δx1 of comparable size, δx0/δx1 and
δx1/δx0 both ﬁnite. Expand at ξ = x + δx0 and at x,
f[x + δx0 + δx1] −f[x + δx0] = a1[x + δx0] δx1 + ε1 δx1
f[x + δx0 + δx1] −f[x] + f[x] −f[x + δx0] = a1[x] (δx0 + δx1) −a1[x] δx0 + ε2 δx1
f[x + δx0 + δx1] −f[x + δx0] = a1[x] δx1 + ε2 δx1
Solving, a1[x + δx0] = a1[x] + (ε2 −ε1) proves continuity,
a1[x + δx0] ≈a1[x]
The case k = 2 is Exercise 8.4.3 below.
The general case follows by expanding the
deleted diﬀerences (δx
′
i indicates it is deleted from the expression) for k + 1 comparable
inﬁnitesimals, δx0, δx1,· · · , δxk,
f[x + δx0 + δx1 + · · · + δxk]
−
k
X
j=1
f[x + δx0 + δx1 + · · · + δx
′
j + · · · + δxk]
+
X
1≤i<j≤k
f[x + δx0 + δx1 + · · · + δx
′
i + · · · + · · · + δx
′
j + · · · + δxk]
+ · · · +
(−1)k−1
k
X
j=1
f[x + δx0 + δxj]
+ (−1)k f[x + δx0]
about ξ = x + δx0 and about x, obtaining this expression equal to both
ak[x + δx0] δx1 · δx2 · · · δxk + ε1 · δxk+1
0
= ak[x] δx1 · δx2 · · · δxk + ε2 · δxk
0

96
8. Higher Order Derivatives
Proof that f (h)[x] = ah[x] is by induction on k. The case k = 1 is the Deﬁnition 5.2.
Suppose that we know f (h)[x] = ah[x], for h = 0, 1, · · · , k. Let δx1 and δx2 be comparable
inﬁnitesimals and expand two ways:
f[x + δx1 + δx2]
=
k
X
h=0
1
h! f (h)[x + δx1]δxh
2 +
1
(k + 1)!ak+1[x + δx1] δxk+1
2
+ ε1 δxk+1
2
=
k
X
h=0
1
h! f (h)[x](δx1 + δx2)h +
1
(k + 1)!ak+1[x] (δx1 + δx2)k+1 + ε2 δxk+1
2
Now form the diﬀerence, and write it as a polynomial in δx2,
ε3 · δxk+1
2
=
k
X
h=0

f (h)[x + δx1] δxh
2 −f (h)[x] (δx1 + δx2)h
+
1
(k + 1)!

ak+1[x + δx1] δxk+1
2
−ak+1[x] (δx1 + δx2)(k+1)
=
k+1
X
h=0
bh[x, δx1] δxh
2
Expansion in δx2 gives the terms
bk+1[x, δx1] =
1
(k + 1)! (ak+1[x + δx1] −ak+1[x])
and
bk[x, δx1] = 1
k!

f (k)[x + δx1] −f (k)[x] −ak+1[x] δx1

Since ak+1[x] is continuous, we have
ε · δxk+1
2
= 1
k!

f (k)[x + δx1] −f (k)[x] −ak+1[x] δx1

δxk
2 +
k−1
X
h=0
bh[x, δx] δxh
2
For any λ0, · · · , λk distinct nonzero real numbers, we have the invertible Vandermonde
system of equations


1, λ0, · · · , λk
0
1, λ1, · · · , λk
1
...
1, λk, · · · , λk
k




b0
b1 δx2
...
bk δxk
2

=


ε0(λ0δx2)k+1
ε1(λ1δx2)k+1
...
εk(λkδx2)k+1

= δxk+1
2


ι0
ι1
...
ιk


with ιh ≈0 for h = 0, · · · , k. Applying the real inverse matrix to both sides, we obtain


b0[x, δx1]
b1[x, δx1] δx2
...
bk[x, δx2] δxk
2

= δxk+1
2


η0
η1
...
ηk



The General Taylor Small Oh Formula
97
with ηh ≈0 for h = 0, · · · , k. In particular,
bk[x, δx1] = 1
k!

f (k)[x + δx1] −f (k)[x] −ak+1[x] δx1

= ζ δx1
with ζ ≈0. This proves that f (k)[x] satisﬁes Deﬁnition 5.2.
Exercise set 8.4
1. Show that the Taylor polynomials for sine at x = 0 satisfy
Sin[0 + dx] = dx −1
6 · dx3 + 1
5! · dx5 + · · ·
and use Mathematica to compare the plots as follows
Plot[{Sin[0 + dx],dx, dx - dx∧3/6, dx - dx∧3/6 + dx∧5/5!}
, {dx,-3 Pi/2,3 Pi/2}]
Make similar graphical comparisons for Cos[0 + dx] and Exp[0 + dx] = e0+dx.
2. We to work through the steps in ﬁnding the second order formula.
Calculate the following second order integral by breaking it into two pieces,
δx ·
Z δx
0
(1 −u/δx)[f ′′[x + u] −f ′′[x]] du
= δx ·
Z δx
0
(1 −u/δx)f ′′[x + u] du −δx
Z δx
0
(1 −u/δx)f ′′[x] du
= δx ·
Z δx
0
(1 −u/δx)f ′′[x + u] du −δx · f ′′[x]
Z δx
0
(1 −u/δx)du
First, compute the integral
R δx
0 (1 −u/δx)du = δx/2, by symbolic means or by noticing
that it is the area of a triangle of height 1 and base δx. Second, use Integration by Parts
with F[u] = (1 −u/δx) and dG[u] = f ′′[x + u] du to show
δx ·
Z δx
0
(1 −u/δx)f ′′[x + u] du = −δx · f ′[x] +
Z δx
0
f ′[x + u] du
= −δx · f ′[x] + f[x + δx] −f[x]
Finally, combine your second order results to show that
f[x + δx] = f[x] + f ′[x] · δx + 1
2f ′′[x] · δx2 + δx ·
Z δx
0
(1 −u/δx)[f ′′[x + u] −f ′′[x]] du
3. Suppose that
f[x + δx] = f[x] + a1[x] δx + 1
2 a2[x] δx2 + εδx2

98
8. Higher Order Derivatives
Take three comparable inﬁnitesimals δx0, δx1, δx2, and expand the following:
f[ξ + δx1 + δx2] −f[ξ] + f[ξ] −f[ξ + δx1] −f[ξ + δx2] + f[ξ]
= a2[ξ] δx1δx2 + ε1δx2
0,
ξ = x + δx0
f[x + δx0 + δx1 + δx2] −f[x] + f[x] −f[x + δx0 + δx1] −f[x + δx0 + δx2]
+ f[x] −f[x] + f[x + δx0]
= a2[x] δx1δx2 + ε2δx2
0
to show that a2[x + δx0] ≈a2[x], a2[x] is continuous.
8.5
Direct Interpretation of Higher Or-
der Derivatives
We know that the ﬁrst derivative tells us the slope and the second derivative
tells us the concavity or convexity (frown or smile), but what do the third,
fourth, and higher derivatives tell us?
The symmetric limit interpretation of derivative arose from ﬁtting the curve y = f[x]
at the points x −δx and x + δx and then taking the limit of the quadratic ﬁt. A more
detailed approach to studying higher order properties of the graph is to ﬁt a polynomial
to several points and take a limit. To determine a quadratic ﬁt to a curve, we would need
three points, say x −δx, x, and x + δx. We would then have three values of the function,
f[x −δx], f[x], and f[x + δx] to use to determine unknown coeﬃcients in the interpolation
polynomial p[dx] = a0 +a1dx+a2dx2. We could solve for these coeﬃcients in order to make
f[x −δx] = p[−δx], f[x] = p[0], and f[x + δx] = p[δx]. This solution can be easily done
with Mathematica commands given in the next exercise. The limit of this ﬁt tends to the
second order Taylor polynomial,
lim
δx→0 p[dx] = f[x] + f ′[x] dx + 1
2 f ′′[x] dx2
This approach extends to as many derivatives as we wish. If we ﬁt to n + 1 points, we
can determine the n + 1 coeﬃcients in the polynomial
p[dx] = a0 + a1 dx + · · · + an dxn
so that p[δxi] = f[x + δxi] for i = 0, 1, · · · , n. If the function f[x] is n times continuously
diﬀerentiable,
lim
δx→0 p[dx] = f[x] + f ′[x] dx + 1
2 f ′′[x] dx2 + · · · + 1
n! f (n)[x] dxn

Direct Interpretation of Higher Order Derivatives
99
speciﬁcally, if p[dx] = a0[x, δx] + a1[x, δx] dx + · · · + an[x, δx] dxn, then
lim
δx→0 ak[x, δx] = 1
k! f (k)[x],
for all k = 0, 1, · · · , n
uniformly for x in compact intervals. The higher derivatives mean no more or less than the
coeﬃcients of a local polynomial ﬁt to the function. In other words, once we understand the
geometric meaning of the dx3 coeﬃcient in a cubic polynomial, we can apply that knowledge
locally to a thrice diﬀerentiable function. Before we prove this amazing fact, we would like
you to “see” how it works by using Mathematica to ﬁt the polynomials in Exercise 8.5.1
8.5.1
Basic Theory of Interpolation
Let f[x] be a real-valued function deﬁned on (α, ω), and let X = {x0, x1, . . . , xn} be n+1
distinct points in the interval. The “Lagrange form” of the polynomial of degree n that has
the same values at the xi is
pX[x] =
n
X
i=0
f[xi]
n
Y
j=0,j̸=i
x −xj
xi −xj
We say “pX[x] interpolates f on X.” For example, when n = 2,
pX[x] =
= f[x0] (x −x1)(x −x2)
(x0 −x1)(x0 −x2) + f[x1] (x −x0)(x −x2)
(x1 −x0)(x1 −x2) + f[x2] (x −x0)(x −x1)
(x2 −x0)(x2 −x1)
By substitution we see that pX[xi] = f[xi] for i = 0, 1, . . . , n . A polynomial of order n
with this interpolation property is unique, because the diﬀerence of two such polynomials
has n + 1 zeros and thus is identically zero.
The interpolation polynomial may also be written in “Newton form” with ascending terms
depending only on successive values of xi:
pX[x] = a0[x0] + a1[x0, x1](x −x0) + · · · + an[x0, . . . , xn]
n−1
Y
i=0
(x −xi)
Substitution of x0 in the Newton form shows
a0[x0] = f[x0]
Equating the nth order terms in both the Newton and Lagrange form, we obtain
an[x0, . . . , xn] =
n
X
i=0
f[xi]
nQ
j=0,j̸=i
(xj −xi)
(NewtLa)
This formula (NewtLa) for an[x0, . . . , xn] shows the symmetry of the coeﬃcients. That is,
if ki is any permutation of {0, 1, . . . , n}, then
an[xk0, . . . , xkn] = an[x0, . . . , xn] .
(Symm)

100
8. Higher Order Derivatives
Applying the formula (NewtLa) to the right hand side of the next equation and putting
the resulting expression on a common denominator justiﬁes the divided diﬀerence recursion
an[x0, . . . , xn] = an−1[x1, . . . , xn] −an−1[x0, . . . , xn−1]
xn −x0
(DiﬀQ)
Successive substitution into (DiﬀQ) shows
a0[x0] = f[x0] ,
a1[x0, x1] = f[x1] −f[x0]
x1 −x0
a2[x0, x1, x2] =
1
x2 −x0
f[x2] −f[x1]
x2 −x1
−f[x1] −f[x0]
x1 −x0

...
Because of the relation of the Newton coeﬃcients to divided diﬀerences of f[x], we denote
them by
δnf[x0, . . . , xn] = an[x0, . . . , xn]
If f[x] is diﬀerentiable at a point, we may extend the deﬁnition of δnf to include a
repetition. This extension continues to satisfy the functional identity (DiﬀQ).
Theorem 8.5.
Limiting Diﬀerences
(a)
If f ′[xn] exists (as pointwise limit) then the following limit exists,
lim
t→0 δn+1f[x0, . . . , xi, xi + t, . . . , xn]
We denote this limit δn+1f[x0, . . . , xi−1, xi, xi, xi+1, . . . , xn].
(b)
If f[x] is pointwise diﬀerentiable on (α, ω) and {x0, . . . , xn+1} has one rep-
etition amongst x0, . . . , xn, then the functional identity (DiﬀQ) still holds
δn+1f[x0, . . . , xn+1] =
1
xn+1 −x0
n
δnf[x1, . . . , xn+1] −δnf[x0, . . . , xn]
o
with the extended deﬁnition of part (a) as needed.
Proof(a):
If n = 0, the limit
lim
t→0
f[x0 + t] −f[x0]
t
= f ′[x0]
exists and we may deﬁne δ1f[x0, x0] = f ′[x0].
If n ≥0, Newton’s interpolation formula at distinct points x0, x0 + t, x1, x2, . . . , xn gives
f[x0 + t] = f[x0] +
n
X
i=1
tδif[x0, . . . , xi]
i−1
Y
j=1
(x0 + t −xj)
+ tδn+1f[x0, . . . , xn, x0 + t]
n
Y
j=1
(x0 + t −xj)

Direct Interpretation of Higher Order Derivatives
101
so that
δn+1f[x0, x1, . . . , xn, x0 + t]
=
f[x0+t]−f[x0]
t
−δ1f[x0, x1] −Pn
i=2 δif[x0, . . . , xi] Qi−1
j=1(x0 + t −xj)
Qn
j=1(x0 + t −xj)
−→
f ′[x0] −δ1f[x0, x1] −Pn
i=2 δif[x0, . . . , xi] Qi−1
j=1(x0 −xj)
Qn
j=1(x0 −xj)
This proves (a).
Proof (b):
To prove (b), we may use symmetry and assume x0 = x1, so by deﬁnition of the extended
formula and identity (DiﬀQ),
δn+1f[x0, x1, . . . , xn+1] = lim
t→0 δn+1f[x0, x0 + t, x2, . . . , xn+1]
= lim
t→0
1
xn+1 −x0
(
δnf[x0 + t, x2, . . . , xn+1] −δnf[x0, x0 + t, . . . , xn]
)
=
1
xn+1 −x0
n
δnf[x1, x2, . . . , xn+1] −δnf[x0, x0, x2, . . . , xn]
o
8.5.2
Interpolation where f is Smooth
If we know that f[x] has n ordinary continuous derivatives (Deﬁnition 5.2), then we have
the following elegant formula.
Theorem 8.6.
Hermite-Gennocci’s Formula
Suppose f[x] has n derivatives in (α, ω), for n ≥1.
Choose distinct points
x0, . . . , xnin (α, ω). Then
δnf[x0, . . . , xn] =
Z
ti≥0,
nP
i=0
ti=1
· · ·
Z
f (n)[t0x0 + · · · + tnxn]dt1 . . . dtn
=
Z
ti≥0,
nP
i=1
ti≤1
· · ·
Z
f (n)[x0 + t1(x1 −x0) + · · · + tn(xn −x0)]dt1 . . . dtn
Proof:
First, the two integrals are equivalent because
n
X
i=1
ti = 1 −t0
Second, if n = 1, the Fundamental Theorem of Integral Calculus, with G[t] = f[x0 +
t(x1 −x0)]/(x1 −x0) and dG
dt = f ′[x0 + t(x1 −x0)], shows the Hermite-Gennoci Formula,
δ1f[x1, x0] = f[x1] −f[x0]
x1 −x0
=
Z 1
0
f ′[x0 + t(x1 −x0)]dt

102
8. Higher Order Derivatives
Third, for n > 1, use successive integration and The Fundamental Theorem to show that
the the Hermite-Gennoci integrals satisfy the recursion (DiﬀQ):
Z
ti≥0,
nP
i=1
ti≤1
· · ·
Z
f (n)(x0 + t1(x1 −x0) + · · · + tn(xn −x0)dt1 . . . dtn
=
Z
· · ·
Z


Z 1−
n−1
P
i=1
ti
tn=0
f (n)(x0 + t1(x1 −x0) + · · · + tn(xn −x0))dtn

dt1 . . . dtn−1
=
Z
· · ·
Z
1
xn −x0
f (n−1)[x0 + t1(x1 −x0) + · · · + tn(xn −x0)]

1−
n−1
P
i=1
ti
tn=0
dt1 . . . dtn−1
=
1
xn −x0
{
Z
· · ·
Z
f (n−1)(xn + t1(x1 −xn) + · · · + tn−1(xn−1 −xn))dt1 . . . dtn−1
−
Z
· · ·
Z
f (n−1)(x0 + t1(x1 −x0) + · · · + tn−1(xn−1 −x0))dt1 . . . dtn−1}
Since both δnf and the integrals agree when n = 1 and since both satisfy the recursion
(DiﬀQ), the two are equal and we have proved the theorem.
If f[x] = xn, then f (n)[x] = n! and δnf[x0, . . . , xn] = 1 by equating coeﬃcients of xn, so
1 =
Z
ti≥0,
nP
i=0
ti=1
· · ·
Z
n! dt1 . . . dtn
8.5.3
Smoothness From Diﬀerences
We say δnf is S-continuous on (α, ω) if whenever we choose nearby inﬁnitesimal se-
quences, we obtain nearly the same ﬁnite results. That is, suppose x0 ≈x1 ≈· · · ≈xn are
distinct inﬁnitely close points near a real b in (α, ω) and ξ0 ≈ξ1 ≈· · · ≈ξn are also near
b. (The xi points are distinct and the ξi points are distinct, but the sets {x0, . . . , xn} and
{ξ0, . . . , ξn} may overlap.) Then
δnf[x0, . . . , xn] ≈δnf[ξ0, . . . , ξn]
and both are ﬁnite numbers.
Theorem 8.7.
Theorem on Higher Order Smoothness
Let f[x] be a real function deﬁned on a real open interval (α, ω). Then f[x] is n-
times continuously diﬀerentiable on (α, ω) if and only if the nth-order diﬀerences
δnf are S-continuous on (α, ω).
Proof that Smooth Implies Stable Differences:
The implication ⇒follows from the Hermite-Gennoci Formula, Theorem 8.6, and shows
δnf[x0, . . . , xn] ≈1
n!f (n)[b]
whenever x0 ≈· · · ≈xn ≈b.

Direct Interpretation of Higher Order Derivatives
103
If x0 ≈x1 ≈· · · ≈xn, then for all 0 ≤ti ≤1, f (n)[t0x0 + · · · + tnxn] ≈f (n)[x0], so
δf (n)[x0, · · · , xn] =
Z
ti≥0,
nP
i=0
ti=1
· · ·
Z
f (n)[t0x0 + · · · + tnxn]dt1 . . . dtn
≈f (n)[x0]
Z
ti≥0,
nP
i=0
ti=1
· · ·
Z
dt1 . . . dtn
We prove the converse by induction and need some technical lemmas. The case n = 0 is
trivial and the case n = 1 follows from Theorem 3.5.
Theorem 8.8.
Technical Lemma 1
If f[x] is pointwise diﬀerentiable with derivative f ′[x] on (α, ω) and x0, x1, . . . xn
are distinct points in (α, ω), then
δnf ′[x0, . . . , xn] =
n
X
i=0
δn+1f[x0, . . . , xn, xi]
(δ′)
Proof of Lemma 1:
If n = 0,
δ0f ′[x0] = f ′[x0] = lim
t→0 δ1f[x0, x0 + t] = δ1f[x0, x0]
Assume that the formula holds for n and that x0, . . . , xn+1 are distinct points in (α, ω).
Use the recurrence formula (DiﬀQ),
δn+1f ′[x0, . . . , xn+1] =
1
xn+1 −x0
(
δnf ′[x1, . . . xn+1] −δnf ′[x0, . . . , xn]
)
Next, use the induction hypothesis,
δn+1f ′[x0, . . . , xn+1]
=
1
xn+1 −x0
( n+1
X
i=1
δn+1f[x1, . . . , xn+1, xi] −
n
X
i=0
δn+1f[x0, . . . , xn, xi]
)

104
8. Higher Order Derivatives
Finally, use part (b) of Theorem 8.5
δn+1f ′[x0, . . . , xn+1]
=
1
xn+1 −x0
(
δn+1f[x1, . . . , xn+1, xn+1]
+
n
X
i=1

δn+1f[x1, . . . , xn+1, xi] −δn+1f[x0, . . . , xn, xi]

−δn+1f[x0, . . . , xn, x0]
)
=
n
X
i=1
δn+2f[x0, . . . , xn+1, xi]
+
1
xn+1 −x0
(
δn+1f[x1, . . . , xn+1, xn+1] −δn+1f[x1, . . . , xn+1, x0]
)
+
1
xn+1 −x0
(
δn+1f[x0, x1, . . . , xn+1] −δn+1f[x0, x1, . . . , xn, x0]
)
=
n+1
X
i=0
δn+2f[x0, . . . , xn+1, xi]
This proves the lemma.
Theorem 8.9.
Technical Lemma 2
If δn+1f is S-continuous on (α, ω), then δkf is also S-continuous for all k =
0, 1, . . . , n.
Proof of Lemma 2:
It is suﬃcient to prove this for k = n, by reduction.
Suppose x0 ≈x1 ≈. . . ≈xn
and ξ0 ≈· · · ≈ξn are near a real b. We wish to show δnf[x0, . . . , xn] ≈δnf[ξ0, . . . , ξn]
and both are ﬁnite. We may assume that {x0, . . . , xn} ̸= {ξ0, . . . , ξn} and if there is an
overlap between the sets let xm, xm+1, . . . , xn be the overlapping points. Take ξ0 = xm,
ξ1 = xm+1, . . . , ξn−m = xn. Now we have xi ̸= ξi and {x0, x1, . . . , xj, ξj, ξj+1, . . . , ξn} a set
of n + 1 distinct inﬁnitely close points for each j.
To show that δnf[x0, . . . , xn] ≈δnf[ξ0, . . . , ξn], we form a telescoping sum and apply
identity (DiﬀQ):
δnf[x0, . . . , xn] −δnf[ξ0, . . . , ξn]
=
n
X
j=0
δnf[x0, . . . , xj, ξj+1, . . . , ξn] −δnf[x0, . . . , xj−1, ξj, . . . , ξn]
=
n
X
j=0
(xj −ξj)δn+1f[x0, . . . , xj, ξj, . . . , ξn]

Direct Interpretation of Higher Order Derivatives
105
By hypothesis all the n + 1 order diﬀerences are near the same ﬁnite number so δnf[x] ≈
δnf[ξ], since xj ≈ξj.
We can also use this identity to show that the nth order diﬀerences are ﬁnite. Since the
identity holds for all inﬁnitely close points, The Function Extension Axiom 2.1 shows that
it must almost hold for suﬃciently close diﬀerences (say within real θ for x’s within real η).
A real diﬀerence is ﬁnite, so the nearby inﬁnitesimal one is too.
Proof that Stable Differences Implies Smooth:
We need to show that the diﬀerences with repetition are S-continuous, not just deﬁned
as hyperreals. It follows from The Function Extension Axiom 2.1 (as in the proof of Theo-
rem 3.4) that for suﬃciently small inﬁnitesimal t,
δn+1f[x0, x1, . . . , xn, x0 + t] ≈δn+1f[x0, . . . , xn, x0]
If ξ0 ≈ξ1 ≈· · · ≈ξn ≈x0 ≈· · · ≈xn, then
δn+1f[x0, . . . , xn, x0] ≈δn+1f[x0, . . . , xn, x0 + t]
≈δn+1f[ξ0, . . . , ξn, ξ0 + s]
≈δn+1f[ξ0, . . . , ξn, ξ0]
So S-continuity of δn+1f implies S-continuity of δn+1f with one repetition. (This is the
theorem on ﬁrst order smoothness if n = 0.)
Our induction hypothesis is applied at n to the function g[x] = f ′[x], that is, we assume
that it is given that when δng is S-continuous, g is n-times continuously diﬀerentiable. Now
apply (δ′):
δnf ′[x0, . . . , xn] =
n
X
i=0
δn+1f[x0, . . . , xn, xi]
≈
n
X
i=0
δn+1f[ξ0, . . . , ξn, ξi]
= δnf ′[ξ0, . . . , ξn]
so δnf ′ is S-continuous and f ′ is n-times continuously diﬀerentiable. This proves that f is
n + 1 times continuously diﬀerentiable as claimed.
Exercise set 8.5
1. Local Higher Order Fit
First, make a table of values to ﬁt:
n = 1;
x = 0.0;
dx = 0.5;
f[x ] := Exp[x]
values = Table[{x + k dx,f[x+ k dx]},{k,-n,n}] < Enter >
Next, make a list of basic functions:
Clear[dx];
polys = Table[dx∧i,{i,0,2 n}] < Enter >

106
8. Higher Order Derivatives
Now Fit[] the data:
p = Fit[values,polys, dx];
p< Enter >
And ﬁnally, Plot[] for comparison:
Plot[{ Exp[x + dx],1 + dx + dx∧2/2, p},{dx,-2,2}]
-2
-1
1
2
1
2
3
4
Figure 8.3: 2nd Comparison
Take dx = 0.25, dx = 0.125 and compare the coeﬃcients of your Fit[] p[dx] to the
Taylor polynomial.
Extend your program to ﬁt a polynomial of degree 4 and use the program to compare to
the Taylor coeﬃcients in the limit as δx →0.

-4
-2
2
4
w
-4
-2
2
4
x
Part 4
Integration

108

CHAPTER
9
Basic Theory of the Deﬁnite Integral
The second half of the Fundamental Theorem technically requires
that we prove existence of the integral before we make the estimates
given in the proof.
We are assuming that we have a function f[x] and do not know whether or not there is
an expression for its antiderivative. We want to take the following limit and be assured that
it converges.
lim
∆x↓0(f[a]∆x+f[a+∆x]∆x+f[a+2∆x]∆x+f[a+3∆x]∆x+· · ·+f[b−2∆x]∆x+f[b−∆x]∆x)
If the limit exists it equals
R b
a f[x] dx,
Z b
a
f[x] dx = lim
∆x↓0(f[a]∆x + f[a + ∆x]∆x + f[a + 2∆x]∆x
+ f[a + 3∆x]∆x + · · · + f[b −2∆x]∆x + f[b −∆x]∆x)
or
Z b
a
f[x] dx ≈f[a]δx + f[a + δx]δx + · · · + f[b −δx]δx
for every
0 < δx ≈0
When f[x] is continuous and [a, b] is a compact interval, of course this works as we prove
next. When f[x] is not continuous or if we want to integrate over an interval like [1, ∞),
then the theory of integration is more complicated. Later sections in this chapter show you
why. (Even the ﬁrst half of the Fundamental Theorem does not work if we only have a
pointwise diﬀerentiable antiderivative, because then f[x] can be discontinuous.)
The proof of the ﬁrst half of the Fundamental Theorem of Integral Calculus 5.1 does not
require a separate proof of the convergence of the sum approximations to the integral. The
fact that the limit converges in the case where we know an antiderivative F[x], where dF[x] =
f[x] dx as an ordinary derivative, follows directly from the increment approximation.
When we cannot ﬁnd an antiderivative F[x] for a given f[x], we sometimes still want to
work directly with the deﬁnition of the integral. A number of important functions are given
by integrals of simple functions. The logarithm and arctangent are elementary examples.
Some other functions like the probability function of the “bell-shaped curve” of probability
and statistics do not have elementary formulas but do have integral formulas. The second
half of the Fundamental Theorem justiﬁes the integral formulas, which are useful as approx-
109

110
9. Basic Theory of the Deﬁnite Integral
imations. The NumIntAprx computer program shows us eﬃcient ways to estimate the
limit of sums directly.
9.1
Existence of the Integral
The next result states the approximation result we need without writing a
symbol for
R b
a f[x] dx. Once we show that I exists, we are justiﬁed in writing
I =
R b
a f[x] dx. Continuity of f[x] is needed to show that the limit actually
“converges.”
Theorem 9.1.
Existence of the Deﬁnite Integral
Let f[x] be a continuous function on the interval [a, b]. Then there is a real number
I such that
lim
∆x↓0
b−∆x
X
x=a
step ∆x
[f[x]∆x] = I
or, equivalently, for any 0 < δx ≈0 the natural extension of the sum function
satisﬁes
b−δx
X
x=a
step δx
[f[x] δx] ≈I
Proof:
First, by the Extreme Value Theorem 4.4, f[x] has a min, m, and a Max, M, on the
interval [a, b]. Monotony of summation tells us
m × (b −a) ≤
b−δx
X
x=a
step δx
[f[x] δx] ≤M × (b −a)
So that Pb−δx
x=a
step δx[f[x] δx] is a ﬁnite number and thus near some real value I[δx] ≈Pb−δx
x=a
step δx[f[x] δx].
What we need to show is that if we choose a diﬀerent inﬁnitesimal, say δu, then I[δx] = I[δu]
or
b−δx
X
x=a
step δx
[f[x] δx] ≈
b−δu
X
u=a
step δu
[f[u] δu]
In other words, we need to compare “rectangular” approximations to the “area” with diﬀer-
ent step sizes. These step sizes may not be multiples of one another. This creates a messy
technical complication as illustrated next with several ﬁnite step sizes. (You can experiment
further using the program GraphIntApprox.)
The next two graphs show a function over an interval with 12 and 13 subdivisions.

Existence of the Integral
111
If we superimpose these two subdivisions, we see
Figure 9.1: Both 12 and 13 Subdivisions Together
Notice that the overlaps between the various rectangles are not equal sizes.
Here is
another example with 17 and 15 subdivisions:
Again, the overlapping portions of the rectangles are unequal in size.

112
9. Basic Theory of the Deﬁnite Integral
Figure 9.2: Both 17 and 15 Subdivisions Together
As a ﬁrst step, we will make upper and lower estimates for the sum with a ﬁxed step size.
We know by the Extreme Value Theorem 4.4 that for each ∆x and each x = a + k ∆x < b,
the function f[x] has a max and a min on the small subinterval [x, x + ∆x],
f[xm] ≤f[ξ] ≤f[xM],
for any ξ satisfying x ≤ξ ≤x + ∆x
We may ‘code’ this fact by letting xm = xm[x, ∆x] and xM = xM[x, ∆x] be functions that
give these values. We extend and sum these to see that
b−δx
X
x=a
step δx
[f[xm] δx] ≤
b−δx
X
x=a
step δx
[f[x] δx]
and
b−δx
X
x=a
step δx
[f[x] δx] ≤
b−δx
X
x=a
step δx
[f[xM] δx]
When δx ≈0 is inﬁnitesimal, we also know that f[xm] ≈f[xM] and in fact that the largest
diﬀerence along the partition is also inﬁnitesimal,
0 ≤Max[(f[xM[x, δx]] −f[xm[x, δx]]) : x = a, a + δx, a + 2 δx, · · · < b] = θ ≈0
This shows that our upper and lower estimates are close,
b−δx
X
x=a
step δx
[f[xM] δx] −
b−δx
X
x=a
step δx
[f[xm] δx] =
=
b−δx
X
x=a
step δx
[(f[xM] −f[xm]) δx]
≤θ ·
b−δx
X
x=a
step δx
[δx] = θ · (b −a) ≈0
We have shown that for any equal size inﬁnitesimal partition, the upper and lower esti-
mate sums are inﬁnitely close. Now consider the unequal partition given by overlapping a

Existence of the Integral
113
δx partition and a δu partition for two diﬀerent inﬁnitesimals. A lower estimate with the
min of f[x] over the reﬁned partition is LARGER than the min estimate of either equal
size partition, because the subinterval mins are taken over smaller subintervals. An upper
estimate with the max of f[x] over the reﬁned partition is SMALLER than the max esti-
mate over either equal size partition. The diﬀerence between the reﬁned upper and lower
estimates is inﬁnitesimal by the same kind of computation as above. We therefore have
I[δx] ≈Min δx-Sum ≈Max δx-Sum and Min δu-Sum ≈Max δu-Sum ≈I[δu]
Min δx-Sum ≤Reﬁned Min Sum ≤Reﬁned Max Sum ≤Max δx-Sum
Min δu-Sum ≤Reﬁned Min Sum ≤Reﬁned Max Sum ≤Max δu-Sum
so I[δx] ≈I[δu] and since these are real numbers I[δx] = I[δu]. This proves that the integral
of a continuous function over a compact interval exists.
Exercise set 9.1
1. Keisler’s Proof of Existence
Let f[x] be continuous on [a, b].
We want to show that the integral exists.
This is
equivalent to showing that for every two positive inﬁnitesimals δx and δu we have
b−δx
X
x=a
step δx
[f[x] δx] ≈
b−δu
X
u=a
step δu
[f[u] δu]
(a) First, show that we can reduce the problem to the case where f[x] ≥0 on [a, b].
(HINT: Consider f[x] = F[x] + m where m = Min[F[x] : a ≤x ≤b].)
(b) Given two positive inﬁnitesimals δx and δu, show that we can reduce the problem
to showing that for any positive real number r we have
b−δx
X
x=a
step δx
[f[x] δx] ≤r +
b−δu
X
u=a
step δu
[f[u] δu]
(c) Let r be a positive real number and take c = (b −a)/r. Below you will show that
b−δx
X
x=a
step δx
[f[x] δx] ≤
b−δu
X
u=a
step δu
[(f[u] + c) δu]
Why does this establish (b)?
(d) To prove that the inequality in (c) holds, suppose to the contrary that
b−δx
X
x=a
step δx
[f[x] δx] >
b−δu
X
u=a
step δu
[(f[u] + c) δu]
Show that then there must be a pair of points x and u in [a, b] so that
x −δu ≤u ≤x + δx
and
f[x] > f[u] + c

114
9. Basic Theory of the Deﬁnite Integral
(e) When f[x] is continuous and δx ≈0, we cannot have x −δu ≤u ≤x + δx and
f[x] > c + f[u]. Why?
(f) Why does the contradiction of (e) prove that the integral exists?
(HINTS: Step (d) is the hard one. The sums are areas of regions bounded by x = a,
x = b, the x-axis, and step functions sδx[x] and sδu[x]. When the δx-sum is larger
than the δu-sum, the region below sδx[x] cannot lie completely inside the region below
sδu[x]. Let v satisfy sδx[v] > sδu[v]. The value sδx[v] = f[x] for a δx-partition point,
x ≤v < x + δx and the value sδu[v] = f[u] + c for a δu-partition point, u ≤v < u + δu.
Show that x −δu ≤u ≤x + δx.
When ∆x and ∆u are real, concoct functions that give the needed values of x = X[∆x]
and u = U[∆u], then apply the implication when δx and δu are inﬁnitesimal.)
9.2
You Can’t Always Integrate Dis-
continuous Functions
With discontinuous integrands, it is possible to make the sums oscillate as
∆x →0. In these cases, numerical integration by computer will likely give
the wrong answer.
Exercises 12.7.3 and 12.7.4 in the main text show you examples of false attempts to
integrate discontinuous functions by antidiﬀerentiation. The idea in those exercises is very
important - it is a main text topic. You can not use the Fundamental Theorem without
verifying the hypotheses.
More bizarre examples are possible if you permit the use of weakly approximating point-
wise derivatives. Examples 6.3.1 and 6.3 show how a single oscillatory discontinuity in a
pointwise derivative can lead to unexpected results. It is possible to tie a bunch of these
oscillations together in such a way that the resulting function has oscillatory discontinuities
on ‘a set of positive measure.’ In this case we have the pointwise derivative DxF[x] = f[x],
but the limit of sums trying to deﬁne the integral do not converge to F[b] −F[a].
There are two diﬀerent kinds of discontinuity preventing convergence of the approximat-
ing sums for integrals. Isolated inﬁnite discontinuities like the ones cited above from the
main text are easiest to understand and we discuss them below in a section on “improper”
integrals. There is also a project on improper integrals.
Oscillatory (even bounded) discontinuities are much more diﬃcult to understand. B.
Riemann discovered the best condition that would allow convergence of the sums.
The
integral is often called the “Riemann integral” as a result. This is peculiar, because the
notation for integrals originated in 1675 in a paper of Leibniz, while Riemann’s integrability
result appears over 150 years later in his paper on Fourier series. It took a very long time for
mathematicians to understand integration of discontinuous functions. (You too can progress
very far by only integrating continuous functions.)

You Can’t Always Integrate Discontinuous Functions
115
Riemann was interested in passing a limit under the integral,
lim
n→∞
Z b
a
fn[x] dx =
Z b
a
lim
n→∞fn[x] dx
In his particular case the functions fn[x] were Fourier series approximations. This idea
seems harmless enough, but the appearance is deceiving. If we can do this once, we should
be able to do it twice. We want you to see just how awful limits of functions can be.
Example 9.1.
A Very Discontinuous Limit
The following limit exists for each x, but the limit function is discontinuous at every
point.
lim
n→∞lim
m→∞(Cos[π n! x])m = IQ[x]
If x = p/q is rational, then when n ≥q, Cos[π n! p
q ] = 1, so
lim
m→∞

Cos[π n! p
q ]
m
= 1
Also
lim
n→∞1 = lim
n→∞lim
m→∞

Cos[π n! p
q ]
m
= 1
If x is not rational, then no matter how large we take a ﬁxed n,
lim
m→∞(Cos[π n! x])m = 0
since the ﬁxed quantity | Cos[π n! x]| < 1. The limit of zero is zero, so when x is ﬁxed and
irrational,
lim
n→∞0 = lim
n→∞lim
m→∞(Cos[π n! x])m = 0
Together, these two parts show that the limit exists and equals the indicator function of
the rational numbers,
IQ[x] =
(
1,
if x is rational
0,
if x is irrational
This function is discontinuous at every point since every x has both rational and irrational
points arbitrarily nearby. In other words, we can approximate ξ ≈x ≈η with IQ[ξ] = 1
and IQ[η] = 0, so
ξ ≈η
but
IQ[ξ] = 1
and
IQ[η] = 0
It is even diﬃcult to make a useful plot of low approximations to the limit.
Figure 9.3: (Cos[π 3! x])8

116
9. Basic Theory of the Deﬁnite Integral
We can show that
lim
n→∞lim
m→∞
Z π
−π
(Cos[π n! x])m dx = 0
and the limits deﬁning the ordinary integral
Z π
−π
IQ[x] dx =
Z π
−π

lim
n→∞lim
m→∞Cosm[π n! x]

dx
do not converge.
You cannot interchange these limits and the ordinary integral.
After Riemann, the study of Fourier series motivated Lebesgue’s work on integration that
ultimately led to a more powerful kind of integral now called the Lebesgue integral. Lebesgue
integrals of continuous functions are the same as the integrals we have been studying, but
Lebesgue integrals are deﬁned for more discontinuous functions and satisfy more general
and ﬂexible interchange of limit and integral theorems. When you really need to integrate
wild discontinuities, study Lebesgue integrals.
9.3
Fundamental Theorem: Part 2
The second part of the Fundamental Theorem of Integral Calculus says that
the derivative of an integral of a continuous function is the integrand,
d
dX
Z X
a
f[x] dx = f [X]
The function A[X] =
R X
a f[x] dx can be thought of as the “accumulated area” under the
curve y = f[x] from a to X shown in Figure 9.4. The “accumulation function” can also be
thought of as the reading of your odometer at time X for a given speed function f[x].
Figure 9.4: A[X] =
R X
a f[x] dx

Fundamental Theorem: Part 2
117
Theorem 9.2.
Second Half of the Fundamental Theorem
Suppose that f[x] is a continuous function on an interval containing a and we
deﬁne a new function by “accumulation,”
A [X] =
Z X
a
f[x] dx
Then A [X] is smooth and dA
dX [X] = f [X]; in other words,
d
dX
Z X
a
f[x] dx = f [X]
Proof:
We show that A [X] satisﬁes the diﬀerential approximation A [X + δX]−A [X] = f [X] δX+
ε · δX with ε ≈0 when δX ≈0. This proves that f[X] is the derivative of A[X].
Figure 9.5: R X+δX
a
f[x] dx
By deﬁnition of A and the additivity property of integrals, for every real ∆X (small
enough so X + ∆X is still in the interval where f[x] is continuous) we have
A [X + ∆X] =
Z X+∆X
a
f[x] dx =
Z X
a
f[x] dx +
Z X+∆X
X
f[x] dx
= A [X] +
Z X+∆X
X
f[x] dx
A [X + ∆X] −A [X] =
Z X+∆X
X
f[x] dx
Figure 9.6:
R X+∆X
X
f[x] dx
The Extreme Value Theorem for Continuous Functions 4.4 says that f[x] has a max and
a min on the interval [X, X + ∆X], m = f [Xm] ≤f[x] ≤M = f [XM] for all X ≤x ≤

118
9. Basic Theory of the Deﬁnite Integral
X + ∆X. Monotony of the integral and simple algebra gives us the estimates
m · ∆X =
Z X+∆X
X
m dx ≤
Z X+∆X
X
f[x] dx ≤
Z X+∆X
X
M dx = M · ∆X
m · ∆X ≤A [X + ∆X] −A [X] ≤M · ∆X
m ≤A [X + ∆X] −A [X]
∆X
≤M
m = f[Xm] ≤f[X] ≤f[XM] = M
A [X + ∆X] −A [X]
∆X
−f[X]
 ≤f[XM] −f[Xm]
with both Xm and XM in the interval [X, X + ∆X].
Figure 9.7: Upper and lower estimates
The Function Extension Axiom 2.1 means that this inequality also hold for positive
inﬁnitesimal δX = ∆X,

A [X + δX] −A [X]
δX
−f[X]
 ≤f[XM] −f[Xm]
We know that Xm ≈XM when δX ≈0. Continuity of f[x] means that f [Xm] ≈f [XM] ≈
f [X] in this case, so
A [X + δX] −A [X]
δX
= f[X] + ε
with ε ≈0. So,
A [X + δX] −A [X] = f[X] · δX + ε · δX
with ε ≈0, when δX ≈0. This proves the theorem because we have veriﬁed the microscope
equation from Deﬁnition 5.2
A [X + δX] = A [X] + A′ [X] δX + ε · δX
with A′ [X] = f [X].
Exercise set 9.3
1. A Formula for ArcTangent
Prove that
ArcTan[x] =
Z x
0
1
1 + ξ2 dξ
(HINT: See Example 5.4.)

Improper Integrals
119
9.4
Improper Integrals
The ordinary integral does not cover the case where the integrand function
is discontinuous or the case where the interval of integration is unbounded.
This section extends the integral to these cases.
There are two main kinds of improper integrals that we can study simply. One kind has
an isolated discontinuity in the integrand like
Z 1
0
1
√x dx
and
Z 1
0
1
x2 dx
The other kind of improper integral is over an unbounded interval like the probability
distribution
2
√π
Z X
−∞
e−x2 dx
or
Z ∞
1
1
x2 dx
In both of these cases, we can calculate
R c
a f[x] dx and take a limit as c →b. The theory of
these kinds of limiting integrals is similar to the theory of inﬁnite series. We begin with a
very basic pair of examples.
Example 9.2.
R 1
0 1/xp dx
The function
1
xp has a discontinuity at x = 0 when p > 0, but we can compute
lim
b↓0
Z 1
b
1
xp dx
The Fundamental Theorem applies to the continuous function 1/xp for 0 < b ≤x ≤1, so
Z 1
b
1
xp dx =
Z 1
b
x−p dx
=
(
1
1−px1−p|1
b,
if p ̸= 1
Log[x]|1
b,
if p = 1
=





1−b1−p
1−p ,
if p < 1
−Log[b],
if p = 1
1/bp−1−1
p−1
,
if p > 1
The limits in these cases are
lim
b↓0
Z 1
b
1
xp dx =





limb↓0 1−b1−p
1−p
=
1
1−p,
if p < 1
limb↓0 −Log[b] = limb↓0 Log[1/b] = limc→∞Log[c] = ∞,
if p = 1
limb↓0
1/bp−1−1
p−1
= ∞,
if p > 1

120
9. Basic Theory of the Deﬁnite Integral
To summarize, we have
Z 1
0
x−p dx =
(
1
1−p,
if p < 1
∞,
if p ≥1
Now we consider the other diﬃculty, an unbounded interval of integration.
Example 9.3.
R ∞
1
1/xp dx
The integrand 1/xp is continuous on the interval [1, ∞), so we can compute
lim
b→∞
Z b
1
1
xp dx
Again we have cases,
Z b
1
1
xp dx =
Z b
1
x−p dx
=
(
1
1−px1−p|b
1,
if p ̸= 1
Log[x]|b
1,
if p = 1
=





b1−p−1
1−p ,
if p < 1
Log[b],
if p = 1
1−1/bp−1
p−1
,
if p > 1
The limits in these cases are
lim
b→∞
Z b
1
1
xp dx =





limb→∞b1−p−1
1−p
= ∞,
if p < 1
limb→∞Log[b] = ∞,
if p = 1
limb→∞
1−1/bp−1
p−1
=
1
p−1,
if p > 1
To summarize, we have the opposite cases of convergence in the inﬁnite interval case that
we had in the (0, 1] case above,
Z ∞
1
x−p dx =
(
1
p−1,
if p > 1
∞,
if p ≤1
Inﬁnite intervals of integration arise often in probability. One such place is in exponential
waiting times. This can be explained intuitively as follows. Suppose you have light bulbs
that fail in some random way, but if one of them is still working, it is as good as new, that
is, the time you expect to wait for it to fail is the same as if it was new. If we write P[t] for
the probability of the bulb lasting at least until time t, then the ‘good as new’ statement
becomes
Probability of lasting to t + ∆t given that it lasted to t = P[t + ∆t]
P[t]
= P[∆t]
If we re-write this algebraically, this probabilistic statement is the same as the exponential
functional identity (see Chapter 2 above for the background on functional identities),
P[t + ∆t] = P[t] × P[∆t]

Improper Integrals
121
If we assume that P[t] is a smooth function, we saw in Example 2.7 above that
P[t] = e−λ t
for some λ > 0.
Example 2.7 shows that P[t] = ek t and the reason that we have a
negative constant k = −λ in our exponential is because the light bulb can not last forever,
limt→∞P[t] = limt→∞e−λ t = 0.
Notice that P[0] = 1 says we start with a good bulb.
We can think of the expression λ e−λ t dt as the probability that the bulb burns out
during the time interval [t, t + dt). (See the next exercise.)
Example 9.4.
Expected Life of the Bulb
The average or expected lifetime of a bulb that fails by an exponential waiting time is
given by the improper integral
Z ∞
0
t λ e−λ t dt
This can be computed with integration by parts,
u = t
dv = λ e−λ t dt
du = dt
v = −e−λ t
so
Z b
0
t λe−λ t dt = −t e−λ t|b
0 +
Z b
0
e−λ t dt
= b e−λ b −1
λ e−λ t|b
0
= 1
λ + b e−λ b −1
λ e−λ b
We know (from Chapter 7 of the main text) that exponentials beat powers to inﬁnity, so
lim
b→∞b e−λ b −1
λ e−λ b = lim
b→∞
b
eλ b −
1
λ eλ b = 0
We have shown that the expected life of the bulb is
Z ∞
0
t λ e−λ t dt = 1
λ
9.4.1
Comparison of Improper Integrals
The most important integral in probability is the Gaussian or “normal” probability re-
lated to the integral
Erf[X] =
2
√π
Z X
−∞
e−x2 dx
You saw in the NoteBook SymbolicIntegr that this does not have an antiderivative that
can be expressed in terms of elementary functions. Mathematica calculates this integral in
terms of “Erf[ ],” its built in Gaussian error function. We often want to be certain that
an integral converges, but without calculating the limit explicitly (since this is sometimes

122
9. Basic Theory of the Deﬁnite Integral
impossible). We may do this by comparing an integral to a known one. This is similar to
the comparison tests for convergence of series in the main text Chapter 18 on Series.
In the case of the integral above, e−x2 < e−|x| for |x| > 1, so
Z −1
−∞
e−x2 dx <
Z −1
−∞
ex dx
and
Z ∞
1
e−x2 dx <
Z ∞
1
e−x dx
The estimating integral converges,
Z ∞
1
e−x dx = lim
b→∞
Z b
1
e−x dx = lim
b→∞
 e −e−b
= e
so the tails of the e−x2 integral converges and
Z −1
−∞
e−x2 dx +
Z 1
−1
e−x2 dx +
Z ∞
1
e−x2 dx =
Z ∞
−∞
e−x2 dx
Exercise set 9.4
1. Improper Drill
1
R 1
0 1/√x dx =
2
R ∞
1
1/√x dx =
3
R ∞
0
1/√x dx =
4
R 1
0 1/x2 dx =
5
R ∞
1
1/x2 dx =
6
R ∞
0
1/x2 dx =
7
R 1
0 1/ 3√x dx =
8
R ∞
1
1/ 3√x dx =
9
R ∞
0
1/ 3√x dx =
10
R 1
0 1/x3 dx =
11
R ∞
1
1/x3 dx =
12
R ∞
0
1/x3 dx =
2. Show that
P[t] =
Z ∞
t
λ e−λ t dt = lim
b→∞
Z b
t
λ e−λ t dt = e−λ t
and
Z t
0
λ e−λ t dt = 1 −e−λ t
3. Calculate the integral
2
√π
Z ∞
−∞
x e−x2 dx
symbolically using a change of variables. Explain your answer geometrically.
Calculate the integral
2
√π
Z ∞
−∞
x2 e−x2 dx
4. Prove that the integral
Z 1
0
Sin[x]
x
dx
converges. (Is Sin[x]/x really discontinuous at zero? Consider its power series.)

Improper Integrals
123
Do the integrals
Z ∞
0
Sin[x]
x
dx
and
Z ∞
0
| Sin[x]|
x
dx
converge? This is a tough question, but perhaps you can at least use Mathematica to
make conjectures.
The previous exercise is related to conditionally convergent series studied in the Mathe-
matical Background Chapter on Series below.
Lebesgue integrals are always absolutely
convergent, but we can have conditionally convergent improper integrals when we deﬁne
them by limits like
lim
b→∞
Z b
0
Sin[x]
x
dx
5. The Gamma Function
The Gamma function is given by the improper integral
Γ(s) =
Z ∞
0
ts−1 e−t dt
This integral has both kinds of improperness. Why? Show that it converges anyway by
breaking up the two cases
Z ∞
0
ts−1 e−t dt =
Z 1
0
ts−1 e−t dt +
Z ∞
1
ts−1 e−t dt
Use Integration by Parts to show Γ(s + 1) = s Γ(s).
Use s = n, a positive integer and induction on the functional identity above to show
that Γ(s + 1) is an extension of the factorial function,
Γ(n + 1) = n!
9.4.2
A Finite Funnel with Inﬁnite Area?
Suppose we imagine an inﬁnite funnel obtained by rotating the curve y = 1/x about the
x-axis. We can compute the volume of the funnel by slicing it into disks,
Figure 9.8: y = 1/x Rotated

124
9. Basic Theory of the Deﬁnite Integral
Volume =
Z ∞
1
πr2(x) dx = π
Z ∞
1
x−2 dx
6. Finite Volume
Calculate the integral above and show that the volume is ﬁnite (π).
Paradoxically, the surface area of this inﬁnite funnel is inﬁnite. If you review the cal-
culation of surface area integrals from Chapter 12 of the main text, you will obtain the
formula
Area = π
Z ∞
1
1
x
r
1 + 1
x4 dx
7. Inﬁnite Area
Show that the surface area integral above is inﬁnite by comparing it to a smaller integral
that you know diverges.
Perhaps it is a good thing that we can’t build inﬁnite objects. We would run out of paint
to cover them, even though we could ﬁll them with paint...

-4
-2
2
4
w
-4
-2
2
4
x
Part 5
Multivariable Diﬀerentiation

126

CHAPTER
10
Derivatives of Multivariable Functions
Functions of several variables whose partial derivatives can be com-
puted by rules automatically are diﬀerentiable when the function
and its partial derivative formulas are deﬁned on a rectangle.
Theorem 10.1.
Deﬁned Formulas Imply Approximation
Suppose that z = f[x, y] is given by formulas and that the partial derivatives
∂f
∂x[x, y] and ∂f
∂y[x, y] can be computed using the rules of Chapter 6 (Speciﬁc Func-
tions, Superposition Rule, Product Rule, Chain Rule) holding one variable at a
time ﬁxed. If the resulting three formulas f[x, y], ∂f
∂x[x, y], ∂f
∂y [x, y], are all deﬁned
in a compact box, α ≤x ≤β, γ ≤y ≤η, then
f[x + δx, y + δy] −f[x, y] = ∂f
∂x[x, y] · δx + ∂f
∂y [x, y] · δy + ε ·
p
δx2 + δy2
with ε uniformly small in the (x, y)-box for suﬃciently small δx and δy.
The “high tech” reason this theorem is true is this. All the speciﬁc classical functions
are complex analytic; having inﬁnitely many derivatives and convergent power series expan-
sions. Formulas are built up using these functions together with addition, multiplication
and composition - the exact rules by which we diﬀerentiate. These formation rules only
result in more complex analytic functions of several variables. The only thing that can “go
wrong” is to have the functions undeﬁned.
Despite this clear reason, it would be nice to have a more direct elementary proof. In
fact, it would be nice to show that uniform diﬀerentiability is “closed” under the operations
of basic calculus and speciﬁcally including solution of initial value problems and indeﬁnite
integration in particular. Try to prove this yourself or WATCH OUR WEB SITE!
http://www.math.uiowa.edu/ stroyan/
127

128
10. Derivatives of Multivariable Functions

-4
-2
2
4
w
-4
-2
2
4
x
Part 6
Diﬀerential Equations

130

CHAPTER
11
Theory of Initial Value Problems
One of the main ideas of calculus is that if we know
(1) where a quantity starts,
x[t0] = x0
and
(2) how the quantity changes,
dx
dt = f[t, x]
then we can ﬁnd out where the quantity goes. The basic start and
continuous change information is called an initial value problem.
The solution of an initial value problem is an unknown function x[t]. This chapter shows
that there is only one solution, but since the solutions may not be given by simple formulas,
it also studies properties of the solutions.
11.1
Existence and Uniqueness of So-
lutions
If we know where to start and how to change, then we should be able to
ﬁgure out where we go. This sounds simple, but it means that there is only
one possible place for the quantity to go by a certain time.
The precise one dimensional theorem that captures this is:
Theorem 11.1.
Existence & Uniqueness for I. V. P.s
Suppose that the functions f[t, x] and ∂f
∂x[t, x] are continuous in a rectangle around
(x0, t0). Then the initial value problem
x[t0] = x0
dx = f[t, x] dt
has a unique solution x[t] deﬁned for some small time interval t0 −∆< t < t0 +∆.
Euler’s Method converges to x[t] on closed subintervals [t0, t1], for t1 < t0 + ∆.
The Idea of the Proof
131

132
11. Theory of Initial Value Problems
The simplest proof of this theorem is based on a “functional.” The unknown variable in
the diﬀerential equation is a function x[t]. Suppose we had a solution and integrated the
diﬀerential,
Z τ
t0
dx[t] =
Z τ
t0
f[t, x[t]] dt
x[τ] −x[t0] =
Z τ
t0
f[t, x[t]] dt
We may think of the integral as a function of functions (or “functional.”)
We make a
translation of variables, u[t] = x[t + t0] −x0, g[t, u] = f[t + t0, u + x0]. Given an input
function v[t], we get an output function by computing
w = G[v],
where
w[τ] =
Z τ
0
g[t, v[t]] dt
An equivalent problem to our diﬀerential equation is: Find a “ﬁxed point” of the func-
tional G[u], that is, a function u[t] with u[0] = 0 so that G[u] = u. Notice that
u[τ] =
Z τ
0
g[t, u[t]] dt
⇔
u = G[u]
See Exercise 11.1.1.
The proof of the theorem is very much like the computation of inverse functions in
Theorem 5.7 above. We begin with u0[t] = 0 and successively compute
u1 = G[u0]
u2 = G[u1] = G[G[u0]]
u3 = G[u2] = G[G[u1]] = G[G[G[u0]]]
...
This iteration is an inﬁnite dimensional discrete dynamical system or a discrete dynamical
system on functions. If we choose a small enough time interval, 0 ≤t ≤∆, we can show
that the functional G[·] decreases the distance between functions as measured by
∥u −v∥= Max[|u[t] −v[t]| : 0 ≤t ≤∆]
That is, ∥G[u] −G[v]∥≤r ∥u −v∥, with a constant r satisfying 0 ≤r < 1.
(We will
show that we can take r = 1/2 below.) The proof of convergence of these approximating
functions is just like the proof in Theorem 5.7 once we have this “contraction” property.
The iteration scheme above reduces the distance between successive terms, and we can prove
that ∥un+1 −un∥≤rn ·∥u1 −u0∥by recursively using each inequality in the next as follows:
∥u2 −u1∥= ∥G[u1] −G[u0]∥≤r · ∥u1 −u0∥
∥u3 −u2∥= ∥G[u2] −G[u1]∥≤r · ∥G[u1] −G[u0]∥≤r2 · ∥u1 −u0∥
∥u4 −u3∥= ∥G(u3) −G[u2]∥≤r · ∥G[u2] −G[u1]∥≤r3 · ∥u1 −u0∥
...
∥un+1 −un∥≤rn · ∥u1 −u0∥

Existence and Uniqueness of Solutions
133
The sequence of iterates tends to the actual solution, un →u, the function satisfying
u = G[u]. To see this we use the geometric series from Chapter 25 of the main text on the
numbers ∥un+1 −un∥. Notice that the distance we move for any number m steps beyond
the nth approximation satisﬁes
|un+m[t] −un[t]| ≤|un+m[t] −un+m−1[t] + un+m−1[t] −· · · −un[t]|
≤|un+m[t] −un+m−1[t]| + |un+m−1[t] −un+m−2[t]| + · · ·
+ |un+1[t] −un[t]|
≤∥un+m −un+m−1∥+ ∥un+m−1 −un+m−2∥+ · · ·
+ ∥un+1 −un∥
≤rn · ∥u1 −u0∥· (rm + rm−1 + · · · + 1)
≤rn · ∥u1 −u0∥· 1 −rm+1
1 −r
≤rn · ∥u1 −u0∥·
1
1 −r
We use of the explicit formula (rm +rm−1 +· · ·+1) = 1−rm+1
1−r
for the ﬁnite geometric series.
(We use 0 ≤r < 1 in the last step.)
Uniqueness follows from the same functional, because if both u and v satisfy the problem,
u = G[u] and v = G[v], then
∥u −v∥= ∥G[u] −G[v]∥≤r ∥u −v∥
with
r < 1
This shows that ∥u −v∥= 0, or u = v as functions, since the maximum diﬀerence is zero.
This is all there is to the proof conceptually, but the details that show the integral functional
is deﬁned on the successive iterates are quite cumbersome. The details follow, if you are
interested.
The Details of the Proof
The proof uses two maxima.
In a sense, the maximum M below gives existence of
solutions and the maximum L gives uniqueness. This is where the hypothesis about the
diﬀerentiability of f[t, x] enters the proof.
In Exercise 11.1.2 you show that if f[t, x] and ∂f
∂x[t, x] are deﬁned and continuous on the
compact rectangle |x −x0| ≤bx and |t −t0| ≤bt, then the maxima M and L below exist
and
M = Max[|f[t, x]| : |x −x0| ≤bx&|t −t0| ≤bt]
= Max[|g[t, u]| : |u| ≤bx&|t| ≤bt]
and
L = Max[

∂f
∂x[t, x]
 : |x −x0| ≤bx&|t −t0| ≤bt]
= Max[

∂g
∂u[t, u]
 : |u| ≤bx&|t| ≤bt]
An important detail in the proof is a prior estimate of the time that a solution could last.
(We know from Problem 21.7 of the main text that solutions can “explode” in ﬁnite time.)
This is transferred technically to the problem of making G[v] deﬁned when v = G[u].

134
11. Theory of Initial Value Problems
As long as g[t, u[t]] is deﬁned for 0 ≤t ≤τ, we know our functional G[·] satisﬁes
|G[u](τ)| =

Z τ
0
g[t, u[t]] dt
 ≤M

Z τ
t0
dt
 = M · τ
when |g[t, u]| ≤M. This is a little circular, because we need to have g[t, u[t]] deﬁned in
order to use the estimate. What we really need is that g[t, un+1[t]] is deﬁned on 0 ≤t ≤τ
provided that g[t, un[t]] is deﬁned on 0 ≤t ≤τ and g[t, u0[t]] is also deﬁned on 0 ≤t ≤τ.
Exercise11.1.3 shows the following successive deﬁnitions. Let u0[t] = 0 for all t. Then
g[t, u0[t]] = f[t + t0, x0] is deﬁned for all t with 0 ≤t ≤τ as long as τ ≤bt (the constant
given above.) Let ∆1 be a positive number satisfying ∆1 < bt and ∆1 < bx/M (for the
maximum M above and in Exercise 11.1.2.) Let u1[t] = G[u0][t]. Then |u1[t]| ≤bx, so
that g[t, u1[t]] is deﬁned for 0 ≤t ≤∆1. Continuing this procedure, the whole sequence
un+1 = G[un] is deﬁned for 0 ≤t ≤∆1.
The maximum partial derivative L is needed for the contraction property. For each ﬁxed
t and any numbers u and v with |u| ≤bx and |v| ≤bx, we can use (integration or) the Mean
Value Theorem 7.1 (on the function F[u] = g[t, u]) to show that
|g[t, v] −g[t, u]| ≤L · |v −u|
This is called a “Lipschitz estimate” for the change in g. See Exercise 11.1.4.
Let ∆be a positive number with ∆< ∆1 and ∆< 1/(2 L). For any two continuous
functions u[t] and v[t] deﬁned on [0, ∆] with maximum less than bx,
|G[u] −G[v]|(τ) =

Z τ
0
g[t, u[t]] dt −
Z τ
0
g[t, v[t]] dt

≤
Z τ
0
|g[t, u[t]] −g[t, v[t]]| dt
≤
Z τ
0
L · Max[|u[t] −v[t]| : 0 ≤t ≤∆] dt
≤
Z τ
0
L∥u −v∥dt ≤∥u −v∥· L · ∆≤1
2 ∥u −v∥
This shows that the iteration idea above will produce a solution deﬁned for 0 ≤t ≤∆and
completes the details of the proof.
Once we know that there is an exact solution, the idea for a proof of convergence of Euler’s
method given in Section 21.2 of the core text applies and shows that the Euler approxima-
tions converge to the true solution. (The functional G[·], called the Picard approximation,
is usually not a practical approximation method.)
Exercise set 11.1
1. Deﬁne the functional G[u] as in the proof of Theorem 11.1 Show that a function u[t]
satisﬁes u = G[u] if and only if x[t+t0] = u[t]+x0 satisﬁes x[t0] = x0 and dx
dt = f[t, x[t]].

Local Linearization of Dynamical Systems
135
2. If f[t, x] and ∂f
∂x[t, x] are deﬁned and continuous on the compact rectangle |x −x0| ≤bx
and |t −t0| ≤bt, show that the maxima M and L below exist and
M = Max[|f[t, x]| : |x −x0| ≤bx&|t −t0| ≤bt]
= Max[|g[t, u]| : |u| ≤bx&|t| ≤bt]
and
L = Max[

∂f
∂x[t, x]
 : |x −x0| ≤bx&|t −t0| ≤bt]
= Max[

∂g
∂u[t, u]
 : |u| ≤bx&|t| ≤bt]
3. Let u0[t] = 0 for all t. Prove that g[t, u0[t]] is deﬁned for all t with 0 ≤t ≤τ as long
as τ ≤bt (the constant given in the Exercise 11.1.2 above.)
Let ∆1 be a positive number satisfying ∆1 < bt and ∆1 < bx/M (for the maximum M
in Exercise 11.1.2.) Let u1[t] = G[u0][t] and show that |u1[t]| ≤bx, so that g[t, u1[t]] is
deﬁned for 0 ≤t ≤∆1.
Continue this procedure and show that the whole sequence un+1 = G[un] is deﬁned for
0 ≤t ≤∆1.
4. Calculate the integral
Z v
u
∂g
∂x[t, x] dx
(where t is ﬁxed.)
If h[x] is any continuous function for |x| ≤bx, and Max[|h[x]| : |x| ≤bx] ≤L (in
particular, if h[x] = g[t, x]) show that

Z v
u
h[x] dx
 ≤L ·

Z v
u
dx
 = L · |v −u|
provided |u| ≤bx and |v| ≤bx. Which property of the integral do you use?
Combine the two previous parts to show that for any t with |t| ≤bt and any numbers u
and v with |u| ≤bx and |v| ≤bx,
|g[t, v] −g[t, u]| ≤L · |v −u|
11.2
Local Linearization of Dynamical
Systems
Now we consider a microscopic view of a nonlinear equilibrium point.

136
11. Theory of Initial Value Problems
Theorem 11.2.
Microscopic Equilibria
Let f[x, y] and g[x, y] be smooth functions with f[xe, ye] = g[xe, ye] = 0. The ﬂow
of
dx
dt = f[x, y]
dy
dt = g[x, y]
under inﬁnite magniﬁcation at (xe, ye) appears the same as the ﬂow of its lineariza-
tion
 du
dt
dv
dt

=

ax
ay
bx
by
 
u
v

where

ax
ay
bx
by

=
" ∂f
∂x
∂f
∂y
∂g
∂x
∂g
∂y
#
[xe, ye]
Speciﬁcally, if our magniﬁcation is 1/δ, for δ ≈0, and our solution starts in our
view,
(x[0] −xe, y[0] −ye) = δ · (a, b)
for ﬁnite a and b and if (u[t], v[t]) satisﬁes the linear equation and starts at
(u[0], v[0]) = (a, b), then
(x[t] −xe, y[t] −ye) = δ · (u[t], v[t]) + δ · (εx[t], εy[t])
where (εx[t], εy[t]) ≈(0, 0) for all ﬁnite t.
Equivalently, for every screen resolution θ and every bound β on the time of
observation and observed scale of initial condition, there is a magniﬁcation large
enough so that if |a| ≤β and |b| ≤β, then the error observed at that magniﬁcation
is less than θ for 0 ≤t ≤β, and in particular, the solution lasts until time β.
Proof:
We give the proof in the 1-D case, where the pictures are not very interesting, but the
ideas of the approximation are the same except for the technical diﬃculty of estimating
vectors rather than numbers.
We deﬁne functions
z[t] = 1
δ (x[t] −xe)
and
F[z] = 1
δ f[z · δ + xe]
when x[t] is a solution of the original equation. z[t] is what we observe when we focus a
microscope of magniﬁcation 1/δ at the equilibrium point xe, with f[xe] = 0 and watch a
solution of the original equation. We want to compare z[t] starting with z[0] = a to the
solution of du
dt = b u where b = f ′[xe] and u[0] = a as well. Exercise 11.2.1 shows:
(a) z[t] satisﬁes dz
dt = F[z], when x[t] satisﬁes dx
dt = f[x].
(b) If z is a ﬁnite number, F[z] ≈b · z.
(c) Let ρ > 0 be any real number so that the following max is deﬁned and let
L = Max[|f ′[x]| : |x −xe| ≤ρ] + 1
Then if z1 and z2 are ﬁnite,
|F[z2] −F[z1]| ≤L |z2 −z1|

Local Linearization of Dynamical Systems
137
Our ﬁrst lemma in the microscope proof is:
Theorem 11.3.
Lemma on Existence of the Inﬁnitesimal Solution
The problem dz
dt = F[z] and z[0] = a has a solution deﬁned for all ﬁnite time.
Proof of the Lemma: See Problem 11.1.
Let u[t] satisfy u[0] = a and du
dt = b · u. (Ignore the fact that we know a formula in the
1-D case.) Deﬁne ε[t] by
z[t] = u[t] + ε[t]
Now use Taylor’s formula for f[x] at xe, and use the fact that f[z[t]] = dz
dt ,
F[z] = 1
δ f[xe + δz]
= f[xe] + f ′[xe] · (u[t] + ε[t]) +
Z 1
0
(f ′[xe + s δz] −f ′[xe]) z ds
dz
dt = du
dt + dε
dt = b · (u[t] + ε[t]) +
Z 1
0
(f ′[xe + s δz] −f ′[xe]) z ds
so
dε
dt = b ε[t] + η[t]
with η[t] ≈0 for all ﬁnite t.
This diﬀerential equation is equivalent to
ε[t] =
Z 1
0
η[s] ds + b
Z 1
0
ε[s] ds
so for any positive real a, no matter how small (but not inﬁnitesimal) and any ﬁnite t,
|ε[t]| ≤a + b
Z 1
0
|ε[s]| ds
Which implies that
|ε[t]| ≤a eb t
and since a is arbitrarily small, ε[t] ≈0 for all ﬁnite t.
To see this last implication, let
H[t] = a + b
Z 1
0
|ε[s]| ds
so |ε[t]| ≤H[t]. We know H[0] = a and H′[t] = b |ε[t]| ≤b H[t] by the second half of the
Fundamental Theorem of Integral Calculus and the previous estimate. Hence,
H′[t]
H[t] ≤b
Z s
0
H′[t]
H[t] dt ≤
Z s
0
b dt
Log[H[s]
a
] ≤b s
H[s] ≤a eb t

138
11. Theory of Initial Value Problems
This proves the inﬁnitesimal microscope theorem for dynamical systems, but better than
a proof, we oﬀer some interesting experiments for you to try yourself in the exercises.
This is a ﬁnite time approximation result. In the limit as t tends to inﬁnity, the nonlinear
system can “look” diﬀerent. Here is another way to say this. If we magnify a lot, but not by
an inﬁnite amount, then we may see a separation between the linear and nonlinear system
after a very very long time. As a matter of fact, a solution beginning a small ﬁnite distance
away from the equilibrium can ‘escape to inﬁnity’ in large ﬁnite time.
Exercise set 11.2
1. Show that z[t] satisﬁes dz
dt = F[z], when x[t] satisﬁes dx
dt = f[x].
Show that if z is a ﬁnite number, F[z] ≈b · z.
Let ρ > 0 be any real number so that the following max is deﬁned and let
L = Max[|f ′[x]| : |x −xe| ≤ρ] + 1
Show that when z1 and z2 are ﬁnite,
|F[z2] −F[z1]| ≤L |z2 −z1|
The following experiments go beyond the main text examples of magnifying a ﬂow near
an equilibrium where the linearized problems are non-degenerate.
2. Use the phase variable trick to write the diﬀerential equation d2x
dt2 + 2 dx
dt + x + 15 x3 = 0
as a two dimensional ﬁrst order system with f[x, y] = y and g[x, y] = −x −2 y −15 x3.
Prove that the only equilibrium point is at (xe, ye) = (0, 0).
Prove that the linearization of the system is the system
 du
dt
dv
dt

=

0
1
−1
−2
 
u
v

and that it has only the single characteristic value r = −1.
Use the Flow2D.ma NoteBook to solve the linear and nonlinear systems at various
scales. A few experiments are shown next. Notice the diﬀerent shape of the nonlinear
system at large scale and that the diﬀerence gradually vanishes as the magniﬁcation
increases. The ﬁrst three ﬁgures are nonlinear, and the fourth is linear at same scale
as the small nonlinear case.

Local Linearization of Dynamical Systems
139
a)
-1
1 x
-1
1
y
b)
-0.1
0.1x
-0.1
0.1
y
c)
-0.1
0.1x
-0.1
0.1
y
d)
-0.1
0.1x
-0.1
0.1
y
x′′ + 2x′ + x + 15 x3 = 0 vs. x′′ + 2x′ + x = 0
3. Use the phase variable trick to write the diﬀerential equation d2x
dt2 + x3 = 0 as a two
dimensional ﬁrst order system with f[x, y] = y and g[x, y] = −x3.
Prove that the only equilibrium point is at (xe, ye) = (0, 0).
Prove that the linearization of the system is the system
 du
dt
dv
dt

=
0
1
0
0
 u
v

and that it has only the single characteristic value r = 0.
Use the Flow2D.ma NoteBook to solve the linear and nonlinear systems at various
scales. A few experiments are shown next. The ﬁrst three ﬁgures are nonlinear, and
the fourth is linear at same scale as the small nonlinear case. What is the analytical
solution of the linear system?

140
11. Theory of Initial Value Problems
a)
-1
1
x
-1
1
y
b)
-0.25
0.25
x
-0.25
0.25
y
c)
-0.1
0.1
x
-0.1
0.1
y
d)
-0.1
0.1
x
-0.1
0.1
y
x′′ + x3 = 0 vs. x′′ = 0
Problem 11.1. Existence of the Infinitesimal Solution
H
Prove that the problem dz
dt = F[z] and z[0] = a has a solution deﬁned for all ﬁnite time.
HINTS:

Attraction and Repulsion
141
Apply the idea in the proof of existence-uniqueness, Theorem 11.1 above. Deﬁne,
z0[t] = a
zn+1[t] = a +
Z t
0
F[zn(s)] ds
We have |z1[t] −z0[t]| ≤
R t
0 F[a] ds| ≤t |F[a]| ≈b · a · t is ﬁnite. Next,
|z2[t] −z1[t]| ≤
Z t
0
|F[z2(s)] −F[z1(s)]| ds
≤
Z t
0
L |z1(s) −a| ds
≤L t2
2
|z2[t] −a| ≤|z2[t] −z1[t]| + |z1[t] −a|
≤|F[a]| · |L t + 1
2(L t)2| ≤|F[a]| · |1 + L t + 1
2(L t)2|
Continue by induction to show that
|zn+1[t] −a| ≤|F[a]| |1 + L t + 1
2(L t)2 + · · · + 1
n!(L t)n| ≤|F[a]| eL t
This shows that zn[t] is ﬁnite when t is. We can also show that zn[t] →z[t], the solution to
the initial value problem, as we did in the existence-uniqueness theorem.
N
11.3
Attraction and Repulsion
This section studies the cases where solutions stay in the microscope for
inﬁnite time.
The local stability of an equilibrium point for a dynamical system is formulated as the
next result. Notice that stability is an “inﬁnite time” result, whereas the localization of the
previous theorem is a ﬁnite time result after magniﬁcation.

142
11. Theory of Initial Value Problems
Theorem 11.4.
Local Stability
Let f[x, y] and g[x, y] be smooth functions with f[xe, ye] = g[xe, ye] = 0.
The
coeﬃcients given by the partial derivatives evaluated at the equilibrium
ax
ay
bx
by

=
" ∂f
∂x
∂f
∂y
∂g
∂x
∂g
∂y
#
[xe, ye]
deﬁne the characteristic equation of the equilibrium,
det

ax −r
ay
bx
by −r
 = (ax−r)(by −r)−ay bx = r2 −(ax+by) r+(ax by −ay bx) = 0
Suppose that the real parts of both of the roots of this equation are negative. Then
there is a real neighborhood of (xe, ye) or a non-inﬁnitesimal ε > 0 such that when
a solution satisﬁes
dx
dt = f[x, y]
dy
dt = g[x, y]
with initial condition in the neighborhood, |x[0] −xe| < ε and |y[0] −ye| < ε, then
lim
t→∞x[t] = xe
and
lim
t→∞y[t] = ye
Proof
One way to prove this theorem is to ‘keep on magnifying.’ If we begin with any solution
inside a square with an inﬁnitesimal side 2 ε, then the previous magniﬁcation result says
that the solution appears to be in a square of half the original side in the time that it takes
the linearization to do this. It might be complicated to compute the maximum time for a
linear solution starting on the square, but we could do so based on the characteristic roots
in the linear solution terms of the form e−r t. It is a ﬁxed ﬁnite time τ. We could then start
up again at the half size position and watch again for time τ. After each time interval of
length τ, we would arrive nearly in a square of half the previous side.
If we want to formulate this with only reference to real quantities, we need to remove
the fact that the true solution is only inﬁnitely near the linear one on the scale of the
magniﬁcation. Since it appears to be in a square of one half the side on that scale, the true
solution must be inside a square of 2/3 the side within time τ. Since this holds for every
inﬁnitesimal radius, the Function Extension Axiom guarantees that it also holds for some
positive real ε. After time n × τ, the true solution is inside a square of side
  2
3
n times the
original length of the side. limn→∞
  2
3
n = 0, so our theorem is proved.
Continuous dynamical systems have a local repeller theorem, unlike discrete dynamical
systems.
Discrete solutions can “jump” inside the microscope, but continuous solutions
‘move continuously.’ You could formulate a local repeller theorem by ‘zooming out’ with
the microscopic theorem above. How would a ring of initial conditions move when viewed
inside a microscope if the characteristic values had only positive real parts?

Stable Limit Cycles
143
11.4
Stable Limit Cycles
Solutions of a dynamical system do not necessarily tend to an attracting
point or to inﬁnity.
There are nonlinear oscillators which have stable oscillations in the sense that every
solution (except zero) tends to the same oscillatory solution.
One of the most famous
examples is the Van der Pol equation:
d2x
dt2 + a(x2 −1)dx
dt + x = 0
Your experiments in the ﬁrst exercise below will reveal a certain sensitivity of this form of
the Van der Pol equation. A more stable equivalent system may be obtained by a diﬀerent
change of variables, w = −
R
x dt,
dw
dt = −x
dx
dt = w −a(x3
3 −x)
Since
d2x
dt2 + adx
dt (x2 −1) = d
dt(dx
dt + a(x3
3 −x)) = −x
Z
d
dt(dx
dt + a(x3
3 −x) dt = −
Z
x dt = w
dx
dt + a(x3
3 −x) = w
dx
dt = −a(x3
3 −x) + w
-4
-2
2
4
w
-4
-2
2
4
x
Figure 11.1: Van der Pol Flow

144
11. Theory of Initial Value Problems
Exercise set 11.4
1. Van der Pol 1
Show that the following is an equivalent system to the ﬁrst form of the Van der Pol
equation via the phase variable trick, y = dx
dt ,
dx
dt = y
dy
dt = −x −ay(x2 −1)
Use Flow2D.ma to make a ﬂow for this system and observe that every solution except
zero tends to the same oscillation.
2. Van der Pol 2
Use Flow2D.ma to create an animation of the second version of the Van der Pol
dynamics.

-4
-2
2
4
w
-4
-2
2
4
x
Part 7
Inﬁnite Series

146

CHAPTER
12
The Theory of Power Series
This chapter ﬁlls in a few details of the theory of series not covered
in the main text Chapters 24 and 25.
What do we mean by an inﬁnite sum
u1[x] + u2[x] + u3[x] + · · ·
The traditional notation is
∞
X
k=1
uk[x] = lim
m→∞
m
X
k=1
uk[x]
where the limit may be deﬁned at least two diﬀerent ways using real numbers. One way to
deﬁne the limit allows the rate of convergence to be diﬀerent at diﬀerent values of x and the
other has the whole graph of the partial sum functions approximate the limiting graph. The
weaker kind of limit makes the “sum” P∞
k=1 have fewer “calculus” properties. The stronger
limit makes the “inﬁnite sum” behave more like an ordinary sum. The traditional notation
P∞
k=1 makes no distinction between uniform and non-uniform convergence. Perhaps this is
unfortunate since the equation
Z b
a
∞
X
k=1
uk[x] dx =
∞
X
k=1
Z b
a
uk[x] dx
is true for uniform convergence (when the uk[x] are continuous) and may be false for point-
wise convergence (even when the uk[x] are continuous).
The love knot symbol “∞” is NOT a hyperreal number, and is not an integer, because
it does not satisfy the formal properties of arithmetic (as the Axioms in Chapter 1 require
of hyperreals. For example, ∞+ ∞̸= 2∞.) Hyperreal integers will retain the arithmetic
properties of an ordered ﬁeld, so we always have
Z b
a
n
X
k=1
uk[x] dx =
n
X
k=1
Z b
a
uk[x] dx
when n is a hyperreal integer, even an inﬁnite one. This seems a little paradoxical, since we
expect to have
n
X
k=1
uk[x] ≈
∞
X
k=1
uk[x]
It turns out that we can understand uniform and non-uniform convergence quite easily from
this approximation. The secret lies in examining the approximation when x is hyperreal. If
147

148
12. The Theory of Power Series
the convergence is non-uniform, then even when n is inﬁnite the hyperreal sum will NOT
be near the limit for some non-ordinary x’s. In other words, non-uniform convergence is
“inﬁnitely slow” at hyperreal x’s. (You might even wish to say the series is not converging
at these hyperreal values.)
What do we mean by an inﬁnite sum, Pn
k=1 uk[x], when n is an inﬁnite hyperreal integer?
What do we even mean by an inﬁnite integer n? On the ordinary real numbers we can deﬁne
the indicator function of the integers
I[x] =
(
1,
if xis an integer
0,
if xis not an integer
The equation I[m] = 1 says “m is an integer”. The formal statement
{I[m] = 1, a ≤x ≤b} ⇒s[m, x] is deﬁned
is true when m and x are real. The function I[x] has a natural extension and we take the
equation I[n] = 1 to be the meaning of the statement “n is a hyperinteger.” The natural
extensions of these functions satisfy the same implication, so when n is an inﬁnite hyperreal
and I[n] = 1, we understand the “hyperreal inﬁnite sum” to be the natural extension
n
X
k=1
uk[x] = s[n, x]
Next, we will show that hyperintegers are either ordinary integers or inﬁnite as you might
expect from a sketch of the hyperreal line. Every real number r is within a half unit of an
integer. For example, we can deﬁne the nearest integer function
N[r] = n,
the integer n such that |r −n| < 1
2 or n = r −1
2
and then every real r satisﬁes
|r −N[r]| ≤1
2 and I[N[r]] = 1
(As a formal logical statement we can write this {x = x} ⇒{|x −N[x]| ≤1
2, I[N[x]] = 1}.)
If m = 1, 2, 3, · · · is an ordinary natural number and |x| ≤m in the real numbers, then
we know N[x] = −m or N[x] = −m + 1 or N[x] = −m + 2 or · · · or N[x] = m −1 or
N[x] = m. By the Function Extension Axiom, if x is a ﬁnite hyperreal (so |x| ≤m for some
m), then N[x] must equal an ordinary integer in the ﬁnite list from −m to m described in
these equations.
If x is an inﬁnite hyperreal, then N[x] is still a “hyperinteger” in the sense I[N[x]] = 1.
Since |x −N[x]| ≤1/2, N[x] is inﬁnite, yet s[n, x] = Pn
k=1 uk[x] is deﬁned.
Similarly, we can show that hyperreal inﬁnite sums given by natural extension of sum
function satisfy formal properties like
m
X
k=1
uk[x] +
n
X
k=m+1
uk[x] =
n
X
k=1
uk[x]

Uniformly Convergent Series
149
12.1
Uniformly Convergent Series
A series of continuous functions
u1[x] + u2[x] + u3[x] + · · ·
can converge to a discontinuous limit function as in Example 13.18 below.
However, this can only happen when the rate of convergence of the series
varies with x. A series whose convergence does not depend on x is said to
converge “uniformly.”
Following is the real tolerance (“epsilon - delta”) version of uniform convergence. We
state the deﬁnition for a general sequence of functions, fm[x] = s[m, x], deﬁned for all
positive integers m and x in some interval.
Deﬁnition 12.1.
Uniformly Convergent Sequence
A sequence of functions s[m, x] all deﬁned on an interval I is said to converge to
the function S[x] uniformly for x in I if for every small positive real tolerance, θ,
there exists a suﬃciently large real index N, so that all real functions beyond N
are θ-close to S[x], speciﬁcally, if m > N and x is in I, then
|S[x] −s[m, x]| < θ
The needed N for a given accuracy θ does not depend on x in A, N is “uniform
in x” for θ.
If we have a series of functions
u1[x] + u2[x] + u3[x] + · · ·
let the partial sum sequence be denoted
s[m, x] =
m
X
k=1
uk[x]
Deﬁnition 12.2.
Uniformly Convergent Series
A series of functions all deﬁned on an interval I
u1[x] + u2[x] + u3[x] + · · ·
is said to converge to the function S[x] = P∞
k=1 uk[x] uniformly for x in I if the
sequence of partial sums s[m, x] converges to S[x] uniformly on I.
The equivalent deﬁnition in terms of inﬁnitesimals is given in Theorem 12.3. By “extended
interval” we mean that the same deﬁning inequalities hold. For example, if I = [a, b] then
a hyperreal x is in the extended interval if a ≤x ≤b. In the case I = (a, ∞), a hyperreal x
is in the extended interval if a < x.

150
12. The Theory of Power Series
Theorem 12.3.
A sequence of functions s[m, x] converges uniformly on the interval to
the real function S[x] if and only if for every inﬁnite n and every hyperreal x in
the extended interval, the natural extension functions satisfy
S[x] ≈s[n, x]
Proof:
The proof is similar to that of Theorem 3.4. Given the real tolerance condition, there is
a function N[θ] such that the following implication holds in the real numbers.
{a ≤x ≤b, θ > 0, m > N[θ]} ⇒|S[x] −s[m, x]| < θ
By the Function Extension Axiom 2.1, this also holds for the hyperreals.
Fix any inﬁnite integer n. Let θ > 0 be an arbitrary positive real number. We will
show that |S[x] −s[n, x]| < θ. Since N[θ] is real and n is inﬁnite, n > N[θ]. Thus the
extended implication above applies with this θ and m = n, so for any a ≤x ≤b we have
|S[x] −s[n, x]| < θ. Since θ is an arbitrary real, S[x] ≈s[n, x].
Conversely, suppose the real tolerance condition fails.
Then there are real functions
M[θ, N] and X[θ, N] so that the following holds in the reals and hyperreals.
{θ > 0, N > 0} ⇒{a ≤X[θ, N] ≤b, M[θ, N] > N, |S[X[θ, N]] −s[M[θ, N], X[θ, N]]| ≥θ}
Applying this to an inﬁnite hyperinteger N, we see that |S[X[θ, N]]−s[M[θ, N], X[θ, N]]| ≥θ
and the inﬁnitesimal condition also fails, that is, if x = X[θ, N] and n = M[θ, N], then
n > N is inﬁnite and we do NOT have S[x] ≈s[n, x]. This proves the contrapositive of the
statement and completes the proof.
Example 12.1.
Uniformly Convergent Series
A series of functions u1[x] + u2[x] + u3[x] + · · · all deﬁned on an interval I with partial
sums s[m, x] = Pm
k=1 uk[x] converges uniformly to S[x] = P∞
k=1 uk[x] on I if and only if,
for every inﬁnite hyperinteger n
n
X
k=1
uk[x] ≈
∞
X
k=1
uk[x]
for all hyperreal x, a ≤x ≤b. In other words if the whole graph of the any inﬁnite sum is
inﬁnitely near the graph of the real limiting function.
If a series is NOT converging uniformly, then there is an x where even an inﬁnite number
of terms of the series fails to approximate the limit function. This can happen even though
the point x where the approximation fails is not real. We can see this in Example 13.18 and
Example 12.2.
We think it is intuitively easier to understand non-uniformity of convergence as “inﬁnitely
slow convergence” at hyperreal values.
Example 12.2.
xn Convergence
The sequence of functions
s[m, x] = xm

Robinson’s Sequential Lemma
151
converges to the function
S[x] =
(
1,
x = 1
0,
−1 < x < 1
In particular, xm →0 for −1 < x < 1. However, this convergence is not uniform on all of
the interval −1 < x < 1.
x
y
Figure 12.1: Limit of xn
You can see from the graphs above that each function xm climbs from near zero to xm = 1
when x = 1. In particular, for every real m there is a ξm, 0 < ξm < 1, such that ξm
m = 1
2
– the graph y = xm crosses the line y = 1/2. The Function Extension Axiom 2.1 says that
this holds with m = n an inﬁnite integer. (Extend the real function ξm =
mp
1/2 = f[m, x].)
The inﬁnite function xn is 1/2 unit away from the limit function S[x] = 0 when x = ξn. Of
course, 1 ≈ξn < 1.
If we ﬁx any ξ ≈1, suﬃciently large n will make ξn ≈1, but some inﬁnite powers will
not be inﬁnitesimal. We could say ξm converges to zero “inﬁnitely slowly.”
Example 12.3.
xn Convergence is Uniform for −r ≤x ≤r if 0 < r < 1
When r < 1 is a ﬁxed real number, we know that rm →0 and if |x| ≤r then |xm| ≤rm,
so the convergence of xm to zero is uniform on [−r, r].
12.2
Robinson’s Sequential Lemma
Functionally deﬁned sequences that are inﬁnitesimal for ﬁnite indices con-
tinue to be inﬁnitesimal for suﬃciently small inﬁnite indices.

152
12. The Theory of Power Series
Theorem 12.4.
Robinson’s Sequential Lemma
Suppose a hyperreal sequence εk is given by a real function of several variables
speciﬁed at ﬁxed hyperreal values, ξ1, · · · , ξi,
εk = f[k, ξ1, ξ2, · · · , ξi] = f[k, Ξ],
k = 1, 2, 3, · · ·
If εm ≈0 for ﬁnite m, then there is an inﬁnite n so that εk ≈0 for all k ≤n.
Proof:
Let X = (x1, x2, · · · , xi) be a real multivariable and suppose f[k, X] is deﬁned for all
natural numbers. Assume f[n, X] is non-negative, if necessary replacing it with |f[n, X]|.
(By hypothesis, εk = f[k, Ξ] is deﬁned at Ξ = (ξ1, · · · , ξi) for all hyperintegers k, I[k] = 1.)
Deﬁne a real function
µ[X] =
(
1/Max[n : m ≤n ⇒f[m, X] < 1/m] when f[h, X] ≥1/h for some h
0, if f[m, X] < 1/m for all m
In the reals we have either µ[X] = 0 and f[k, X] < 1/k for all k, or µ[X] > 0 and
k ≤1/µ[X] ⇒f[k, X] < 1/k
Now, consider the value of µ[Ξ]. Since f[m, Ξ] ≈0 for all ﬁnite m, f[m, Ξ] < 1/m for
all ﬁnite m. Thus µ[Ξ] ≈0 and either µ[Ξ] = 0 so all inﬁnite n satisfy f[n, Ξ] < 1/n or
1/µ[Ξ] = n is an inﬁnite hyperinteger and all k ≤n satisfy f[k, Ξ] < 1/k. When k is ﬁnite
we already know f[k, Ξ] ≈0 and when k is inﬁnite, 1/k ≈0, so the Lemma is proved.
12.3
Integration of Series
We can interchange integration and inﬁnite series summation of unifromly
convergent series of continuous functions.
Theorem 12.5.
Integration of Series
Suppose that the series of continuous functions uo[x] + u1[x] + · · · converges uni-
formly on the interval [a, b] to a “sum”
S[x] = lim
n→∞u0[x] + · · · + un[x]
Then the limit S[x] is continuous and
Z b
a
lim
n→∞u0[x] + · · · + un[x] dx = lim
n→∞
Z b
a
u0[x] + · · · + un[x] dx
Short notation for this result would simply be that
Z b
a
∞
X
k=0
uk[x] dx =
∞
X
k=0
Z b
a
uk[x] dx
provided the series is uniformly convergent and the terms are continuous.

Integration of Series
153
Proof:
Continuity means that if x1 ≈x2, then S[x1] ≈S[x2]. We need this in order to integrate
S[x]. By continuity of the functions uk[x], if x1 ≈x2 and m is a ﬁnite integer, Pm
k=0 uk[x1] ≈
Pm
k=0 uk[x2].
Robinson’s Lemma 12.4 with the function f[m, x1, x2] = Pm
k=0(uk[x1] −
uk[x2]) shows that there is an inﬁnite n so that we still have Pn
k=0 uk[x1] ≈Pn
k=0 uk[x2].
Uniform convergence gives us the conclusion
∞
X
k=0
uk[x1] ≈
n
X
k=0
uk[x1] ≈
n
X
k=0
uk[x2] ≈
∞
X
k=0
uk[x2]
The integral part is easy. Let θ > 0 be any real number and n suﬃciently large so that
|S[x] −(u0[x] + · · · + un[x])| < θ/(2(b −a))

Z b
a
S[x] dx −
 Z b
a
u0[x] dx + · · · +
Z b
a
un[x] dx
! =

Z b
a
S[x] −(u0[x] + · · · + un[x]) dx
 =
≤
Z b
a
|S[x] −(u0[x] + · · · + un[x])| dx
≤
Z b
a
θ
2(b −a) dx = (b −a)
θ
2(b −a) < θ
This shows that the series of numbers
R b
a u0[x] dx+
R b
a u1[x] dx+
R b
a u2[x] dx+· · · converges
to the number
R b
a S[x] dx.
Exercise set 12.3
1. When a series converges uniformly and n is inﬁnite, we know P∞
k=0 uk[x] ≈Pn
k=0 uk[x].
Show that
Z b
a
∞
X
k=0
uk[x] dx ≈
Z b
a
n
X
k=0
uk[x] dx
and
Z b
a
 ∞
X
k=0
uk[x] −
n
X
k=0
uk[x]
!
dx ≈0
What is the meaning of the equation
Z b
a
n
X
k=0
uk[x] dx =
n
X
k=0
Z b
a
uk[x] dx
and why is it true?
Prove that
Z b
a
∞
X
k=0
uk[x] dx =
∞
X
k=0
Z b
a
uk[x] dx

154
12. The Theory of Power Series
2. Let f[m, x] = (m + 1) 2 x
 1 −x2m
(a) Show that
Z 1
0
f[m, x] dx = 1
for each m
(b) Show that for a ﬁxed real value of x
lim
m→∞f[m, x] = 0
(c) Show that
Z 1
0

lim
m→∞f[m, x]

dx = 0
(d) Show that
lim
m→∞
Z 1
0
f[m, x] dx

= 1
(e) Explain why f[m, x] does NOT tend to zero uniformly. In fact, for a given inﬁnite
m = n show that there is an x = ξ ≈0 where f[n, ξ] is inﬁnitely far from zero.
(HINT: See Section 26.3 of the main text.)
12.4
Radius of Convergence
A power series a0 +a1 x+a2 x2 +· · ·+an xn +· · · does one of the following:
(a) Converges for all x and converges uniformly and absolutely for
|x| ≤ρ for any constant ρ < ∞. In this case we say the series
has radius of convergence ∞.
(b) There is a number r so that the series converges for all x in the
open interval (−r, r), uniformly and absolutely for |x| ≤ρ < r for
any constant ρ, and diverges for all x with |x| > r. In this case
we say the series has radius of convergence r. Such a series may
converge or diverge at either x = r or x = −r.
(c) The series does not converge for any nonzero x. In this case we
say the series has radius of convergence 0.
A general fact about power series is that if we can ﬁnd a point of convergence, even
conditional convergence, then we can use geometric comparison to prove convergence at
smaller values. See Theorem 27.4 of the main text where the following is discussed in more
detail - but where there is a typo in the proof, (:-().

Radius of Convergence
155
Theorem 12.6.
If the power series
a0 + a1 x + a2 x2 + · · · + an xn + · · ·
converges for a particular x = x1, then the series converges uniformly and abso-
lutely for |x| ≤ρ < |x1|, for any constant ρ.
Proof:
Because the series converges at x1, we must have an xn
1 →0. If |x| ≤ρ < |x1|, then
|an xn| = |an xn
1 |

x
x1

n
≤

ρ
x1

n
= rn
is a geometric majorant for the tail of the series.
That is, eventually |anxn| ≤rn and
P∞
n=m rn converges. This proves the theorem.
Example 12.4.
The Radius of Convergence
Now consider the cases described in the section summary at the beginning of this section.
If the series converges for all x we simply say the radius of convergence is ∞and apply the
theorem to see that convergence is uniform on any compact interval.
If the series diverges for all nonzero x there is nothing to show. We simply say the radius
of convergence is zero.
If the series converges for some values of x and diverges for others, we need to show
that it converges in (−r, r), and diverges for |x| > r. Theorem 12.6 shows that if the series
converges for x1, then it converges for all real x satisfying |x| < |x1|.
Consider the sets numbers
L = {s : s < 0 or the series converges when x = s}
R = {t : t > 0 and the series diverges when x = t}
The pair (L, R) is a Dedekind cut on the real numbers (see Deﬁnition 1.4.) First, both L
and R are nonempty since there are positive values where the series converges and where
it diverges. Second, if s ∈L and t ∈R, then s < t by Theorem 12.6. Let r be the real
number at the gap of this cut. Then whenever |x| < r, |x| ∈L and the series converges,
while when r < |x|, |x| ∈R and the series diverges at the positive |x|. It cannot converge
at −|x| because Theorem 12.6 would make the series converge at (|x| + r)/2 > r. Thus the
series converges for |x| < r and diverges for |x| > r.
Exercise set 12.4
1.
(a) Find a power series with ﬁnite radius of convergence r that converges when x = r,
but diverges when x = −r.
(b) Find a power series with ﬁnite radius of convergence r that diverges when x = r
and diverges when x = −r.
(c) Find a power series with radius of convergence ∞.
(d) Find a power series with radius of convergence 0.
(HINT: Try Log[1 + x], 1/(1 −x), make substitutions, · · · .)

156
12. The Theory of Power Series
12.5
Calculus of Power Series
We can diﬀerentiate and integrate power series inside their radius of con-
vergence (deﬁned in the preceding section).
Theorem 12.7.
Diﬀerentiation and Integration of Power Series
Suppose that a power series
a0 + a1 x + a2 x2 + · · · + an xn + · · ·
converges to S[x] for |x| < r, its radius of convergence,
S[x] = a0 + a1 x + a2 x2 + a3 x3 + · · · =
∞
X
k=0
ak xk
Then, the derivative of S[x] exists and the series obtained from term by term dif-
ferentiation has the same radius of convergence and converges uniformly absolutely
to it on |x| ≤ρ < r,
dS[x]
dx
= a1 + 2 a2 x + 3 a3 x2 + · · · + n an xn−1 + · · · =
∞
X
k=1
k ak xk−1
The integral of S[x] exists and the series obtained from term by term integration
has the same radius of convergence and converges uniformly absolutely to it on
|x| ≤ρ < r,
Z x
0
S[ξ] dξ = a0 x + a1
2 x2 + a2
3 x3 + · · · +
an
n + 1 xn+1 + · · · =
∞
X
k=0
ak
k + 1 xk+1
Proof:
First, we show that the series P∞
k=1 k ak xk−1 and P∞
k=0
ak
k+1 xk+1 have the same radius
of convergence as P∞
k=0 ak xk.
For any x and ρ,
k ak xk−1 = k

x
ρ

k
·

1
x

ak ρk
and

ak
k + 1 xk+1
 =

x
k + 1


x
ρ

k
·
ak ρk
When we ﬁx |x| < ρ < r
k ak xk−1 <
ak ρk
and

ak
k + 1 xk+1
 <
ak ρk

Calculus of Power Series
157
for suﬃciently large k because then |x/ρ| < 1 so
k

x
ρ

k
·

1
x
 →0
and

x
k + 1


x
ρ

k
→0
as k →∞
See Exercise 12.5.1. In this case since the series P∞
k=0 |ak| ρk converges, the term-by-term
derivative and integral series also converge. (See Exercise 12.5.5.)
When |x| > ρ > r
k ak xk−1 >
ak ρk
and

ak
k + 1 xk+1
 >
ak ρk
for suﬃciently large k because then |x/ρ| > 1 so
k

x
ρ

k
·

1
x
 →∞
and

x
k + 1


x
ρ

k
→∞
as k →∞
See Exercise 12.5.2. In this case since the series P∞
k=0 |ak| ρk diverges, the term-by-term
derivative and integral series also diverge. (See Exercise 12.5.5.)
The fact that the integral of the series equals the series of integrals now follows from
Theorem 12.5 applied to and interval [−ρ, ρ] with ρ < r, the radius of convergence.
To prove the derivative part, deﬁne a new function
T [x] =
∞
X
k=1
k ak xk−1
on the interval of convergence, (−r, r). T [x] is continuous by Theorem 12.5. The integral
Z x
0
T [ξ] dξ =
∞
X
k=1
ak
Z x
0
k ξk−1 dξ =
∞
X
k=1
ak xk = S[x]
The second half of the Fundamental Theorem 9.2 says
T [x] = d
dx
Z x
0
T [ξ] dξ = dS
dx [x]
This proves that the derivative of the series is the series of derivatives.
Exercise set 12.5
1. Show that if 0 ≤ρ < 1 then limk→∞k ρk = 0
2. Show that if ρ > 1 then limk→∞
ρk
k = ∞
3. Prove:
Theorem 12.8.
If the series a0 + a1 + a2 + a3 + . . . converges (with terms of arbitrary sign),
then limk→∞ak = 0.
4. Give a divergent series a0 + a1 + a2 + a3 + . . . of positive terms with limk→∞ak = 0.
(HINT: Harmonic series.)

158
12. The Theory of Power Series
5. Prove the following.
Theorem 12.9.
Comparison Suppose that ak and bk are sequences of positive num-
bers with ak ≤bk for all k ≥n. Then
(a)
If P∞
k=1 bk < ∞converges, so does P∞
k=1 ak < ∞.
(b)
If P∞
k=1 ak = ∞diverges, so does P∞
k=1 bk = ∞.
6. Euler’s Criterion for Convergence
Show that the series P∞
k=1 ak converges if and only if whenever m and n are both inﬁnite
hyperintegers,
n
X
k=m
ak ≈0
7. Prove:
Theorem 12.10.
Limit Comparison
Suppose two sequences ak and bk satisfy limk→∞ak
bk = L ̸= 0. Then P∞
k=1 ak
converges if and only if P∞
k=1 bk converges.
HINT: If k is inﬁnite, ak = (L + εk)bk with ε ≈0. How much is Pn
k=m(ak −L bk)?

CHAPTER
13
The Theory of Fourier Series
This chapter gives some examples of Fourier series and a basic
convergence theorem.
Fourier series and general “orthogonal function expansions” are important in the study
of heat ﬂow and wave propagation as well as in pure mathematics. The reason that these
series are important is that sines and cosines satisfy the ‘heat equation’ or ‘wave equation’ or
‘Laplace’s equation’ for certain geometries of the domain. A general solution of these partial
diﬀerential equations can sometimes be approximated by a series of the simple solutions by
using superposition. We conclude the background on series with this topic, because Fourier
series provide many interesting examples of delicately converging series where we still have
a simple general result on convergence.
The project on Fourier series shows you how to compute some of your own examples.
The method of computing Fourier series is quite diﬀerent from the methods of computing
power series.
The Fourier sine-cosine series associated with f[x] for −π < x ≤π is:
f[x] ∼a0 +
∞
X
k=1
[ak Cos[kx] + bk Sin[kx]]
where
a0 = 1
2π
Z π
−π
f[x] dx = Average of f[x]
and for k = 1, 2, 3, · · ·
ak = 1
π
Z π
−π
f[x] · Cos[kx] dx
and
bk = 1
π
Z π
−π
f[x] · Sin[kx] dx
Dirichlet’s Theorem 13.4 says that if f[x] and f ′[x] are 2π-periodic and continuous except
for a ﬁnite number of jumps or kinks and if the value f[xj] is the midpoint of the jump if
there is one at xj, then the Fourier series converges to the function at each point. It may
not converge uniformly, in fact, the approximating graphs may not converge to the graph
of the function, as shown in Gibb’s goalposts below. If the periodic function f[x] has no
jumps (but may have a ﬁnite number of kinks, or jumps in f ′[x]), then the series converges
uniformly to f[x].
Convergence of Fourier series is typically weaker than the convergence of power series, as
we shall see in the examples, but the weak convergence is still quite useful. Actually, the
159

160
13. The Theory of Fourier Series
most important kind of convergence for Fourier series is “mean square convergence,”
Z π
−π
(f[x] −Sn[x])2 dx →0
where Sn[x] is the sum of n terms. This is only a kind of average convergence, since the
integral is still small if the diﬀerence is big only on a small set of x′s. We won’t go into
mean square convergence except to mention that it sometimes corresponds to the diﬀerence
in energy between the ‘wave’ f[x] and its approximation Sn[x]. Mean square convergence
has important connections to “Hilbert spaces.”
Convergence of Fourier series at ‘almost every’ point was a notorious problem in mathe-
matics, with many famous mathematicians making errors about the convergence. Fourier’s
work was in the early 1800’s and not until 1966 did L. Carleson prove that the Fourier series
of any continuous function f[x] converges to the function at almost every point. (Dirichlet’s
Theorem ?? uses continuity of f ′[x] which may not be true if f[x] is only continuous. Mean
square convergence is much easier to work with, and was well understood much earlier.)
13.1
Computation of Fourier Series
This section has some examples of speciﬁc Fourier series.
Three basic examples of Fourier sine - cosine series are animated in the computer program
FourierSeries. These follow along with some more. “Calculus” is about calculating. The
following examples indicate the many speciﬁc results that we can obtain by performing
algebra and calculus on Fourier series. Of course, the computation of the basic coeﬃcients
also requires calculus.
Example 13.1.
Fourier Series for the Zig-Zag f[x] = |x|
for −π < x ≤π
{terms =, 5}
-4
-2
2
4
0.5
1
1.5
2
2.5
3
Figure 13.1: Fourier Series for f[x] = |x|

Computation of Fourier Series
161
|x| = π
2 −4
π
∞
X
k=0
4
(2k + 1)2 Cos[(2k + 1)x]
The series
|x| = π
2 −4
π
Cos[x]
1
+ Cos[3 x]
32
+ Cos[5 x]
52
+ · · · + Cos[(2n + 1) x]
(2n + 1)2
+ · · ·

converges to the function that equals |x| for −π < x ≤π and is then repeated periodically.
The average value of f[x] is clearly π/2 and can be computed as the integral
a0 = 1
2π
Z π
−π
f[x] dx = 1
2π
Z π
−π
|x| dx
= 2 1
2π
Z π
0
x dx
= 1
π
1
2 x2|π
0 = π2
2π
= π
2
Notice the step in the computation of the integral where we get rid of the absolute value.
We must do this in order to apply the Fundamental Theorem of Integral Calculus. Absolute
value does not have an antiderivative. We do the same thing in the computation of the
other coeﬃcients.
a2k = 1
π
Z π
−π
|x| Cos[2k x] dx
= 2
π
Z π
0
x Cos[2k x] dx
= 2
π

x 1
2k Sin[2kx] |π
0 −
Z π
0
1
2k Sin[2k x] dx

= 2
π

2kπ Sin[2kπ] −0 −
1
(2k)2 (Cos[2kx] |π
0)

= 0
using integration by parts with
u = x
dv = Cos[2kx] dx
du = dx
v = 1
2k Sin[2kx]
In the fourier Series project you show that the ak terms of the Fourier series for f[x] = |x|
with odd k are
a2k+1 = −4
π ·
1
(2k + 1)2
and all bk = 0.
Example 13.2.
A Particular Case of the |x| Series

162
13. The Theory of Fourier Series
Set x = 0 in the series
|x| = π
2 −4
π
Cos[x]
1
+ Cos[3 x]
32
+ Cos[5 x]
52
+ · · · + Cos[(2n + 1) x]
(2n + 1)2
+ · · ·

0 = π
2 −4
π

1 + 1
32 + 1
52 + · · · +
1
(2n + 1)2 + · · ·

π2
8 = 1 + 1
32 + 1
52 + · · ·
Example 13.3.
Fourier Series for f[x] = | Sin[x]|
for −π < x ≤π
| Sin[x]| = 2
π −4
π
∞
X
k=1
1
4k2 −1 Cos[2kx]
In the project on Fourier Series you show that
| Sin[x]| = 2
π −4
π
Cos[2x]
3
+ Cos[4 x]
15
+ Cos[6 x]
35
+ · · · + Cos[2n x]
(2n)2 −1 + · · ·

converges to the function that equals |x| for −π < x ≤π and is then repeated periodically.
Example 13.4.
A Particular Case of the | Sin[x]| Series
Set x = 0 in the series
| Sin[x]| = 2
π −4
π
Cos[2x]
3
+ Cos[4 x]
15
+ Cos[6 x]
35
+ · · · + Cos[2n x]
(2n)2 −1 + · · ·

0 = 2
π −4
π
1
3 + 1
15 + 1
35 + · · · +
1
(2n)2 −1 + · · ·

1
2 = 1
3 + 1
15 + 1
35 + · · · +
1
(2n)2 −1 + · · ·
Example 13.5.
Another Case of the | Sin[x]| Series
Set x = π/2 in the series
| Sin[x]| = 2
π −4
π
Cos[2x]
3
+ Cos[4 x]
15
+ Cos[6 x]
35
+ · · · + Cos[2n x]
(2n)2 −1 + · · ·

1 = 2
π −4
π
−1
3 + 1
15 + −1
35 + · · · +
(−1)n
(2n)2 −1 + · · ·

π
4 = 1
2 + 1
3 −1
15 + 1
35 + · · · + (−1)n+1
(2n)2 −1 + · · ·
π
8 = 1
3 + 1
35 + · · · +
1
4(2k + 1)2 −1 + · · ·
Example 13.6.
Fourier Series for f[x] = x2, for −π < x ≤π

Computation of Fourier Series
163
x2 = π2
3 −4
∞
X
k=1
(−1)k+1
k2
Cos[kx]
In the project on Fourier Series you show that
x2 = π2
3 −4

Cos[x] −Cos[2x]
22
+ Cos[3x]
32
+ · · · + (−1)n+1 Cos[nx]
n2
+ · · ·

for −π < x ≤π.
Example 13.7.
A Particular Case of the x2 Series
Set x = 0 in the series
x2 = π2
3 −4

Cos[x] −Cos[2x]
22
+ Cos[3x]
32
+ · · · + (−1)n+1 Cos[nx]
n2
+ · · ·

0 = π2
3 −4

1 −1
22 + 1
32 + · · · + (−1)n+1 1
n2 + · · ·

π2
12 = 1 −1
22 + 1
32 + · · · + (−1)n+1 1
n2 + · · ·
Example 13.8.
The Formal Derivative of the x2 Series
Notice that if we diﬀerentiate both sides and (without justiﬁcation) interchange derivative
and (inﬁnite) sum, we obtain
dx2
dx = d
dx
π2
3 −4

Cos[x] −Cos[2x]
22
+ Cos[3x]
32
+ · · · + (−1)n+1 Cos[nx]
n2
+ · · ·

2 x = 4

Sin[x] −Sin[2x]
2
+ Sin[3x]
3
+ · · · + (−1)n+1 Sin[nx]
n
+ · · ·

Example 13.9.
Fourier Series for the Sawtooth Wave f[x] = x

164
13. The Theory of Fourier Series
{terms =, 7}
-4
-2
2
4
-3
-2
-1
1
2
3
Figure 13.2: Fourier Series for f[x] = x
x = 2
∞
X
k=1
(−1)k+1
k
Sin[k x]
x = 2

Sin[x] −Sin[2x]
2
+ Sin[3x]
3
+ · · · + (−1)n+1 Sin[nx]
n
+ · · ·

Without the absolute value the integrals of the Fourier coeﬃcients can be computed
directly, without breaking them into pieces. The Fourier sine-cosine series for the “sawtooth
wave,”
f[x] =
(
x, for −π < x < π
0, for |x| = π
extended to be 2π periodic is easier to compute.
Notice that the average a0 = 0, by
inspection of the graph or by computation of an integral. Moreover, x Cos[2kx] is an odd
function, that is, −x Cos[2k · (−x)] = −(x Cos[2kx]), so the up areas and down areas of the
integral cancel, ak = 0. Finally, you can show that
bk = 2(−1)k+1
k
Example 13.10.
A Particular Case of the x Series
Set x = π/2 in the series
x = 2

Sin[x] −Sin[2x]
2
+ Sin[3x]
3
+ · · · + (−1)n+1 Sin[nx]
n
+ · · ·

π
4 = 1 −1
3 + 1
5 + · · · + (−1)n
2n + 1 + · · ·
Example 13.11.
Fourier Series for the Square Wave f[x] = Sign[x]

Computation of Fourier Series
165
{terms =, 7}
-4
-2
2
4
-1.5
-1
-0.5
0.5
1
1.5
Figure 13.3: Gibbs Goalposts f[x] = Sign[x]
Sign[x] = 4
π
∞
X
k=0
1
2k + 1 Sin[(2k + 1) x]
4
π

Sin[x] + 1
3 Sin[3 x] + 1
5 Sin[5 x] + · · ·

= Sign[x] =





+1,
if x > 0
0,
if x = 0
−1,
if x < 0
The coeﬃcients for the Fourier series of
f[x] = Sign[x] =





+1,
if x > 0
0,
if x = 0
−1,
if x < 0
must be computed by breaking the integrals into pieces where the Fundamental Theorem
applies, for example,
a0 = 1
2π
Z π
−π
f[x] dx = 1
2π
Z 0
−π
−1 dx +
Z π
0
+1 dx

= 0
In the Fourier Series project you show that
ak = 1
π
Z π
−π
Sign[x] Cos[kx] dx = 0
and
b2k = 0
because each piece of the integral
R π
0 Sin[2kx] dx = 0, being the integral over whole periods
of the sine function.

166
13. The Theory of Fourier Series
Also,
b2k+1 = 2
π
Z π
0
Sin[(2k + 1)x] dx
= 2
π ·
1
2k + 1
Z (2k+1)π
0
Sin[u] du
= 4
π ·
1
2k + 1
Example 13.12.
A Particular Case of the Sign[x] Series
Substituting x = π/2 in the series
Sign[x] = 4
π

Sin[x] + 1
3 Sin[3 x] + 1
5 Sin[5 x] + · · ·

π
4 = 1 −1
3 + 1
5 + · · · + (−1)n
2n + 1 + · · ·
Example 13.13.
The Series for Cos[ωx], for Non-Integer ω
In the project on Fourier Series you show that when ω is not an integer,
Cos[ωx] = 2ω Sin[ωπ]
π
 1
2ω2 −Cos[x]
ω2 −1 + Cos[2x]
ω2 −22 + · · · + (−1)n
ω2 −n2 Cos[n x] + · · ·

Substituting x = π and performing some algebra, we obtain,
Cos[ωx] = 2ω Sin[ωπ]
π
 1
2ω2 −Cos[x]
ω2 −1 + Cos[2x]
ω2 −22 + · · · + (−1)n
ω2 −n2 Cos[n x] + · · ·

π Cos[ωπ]
Sin[ωπ] = 2 ω
 1
2ω2 +
1
ω2 −1 +
1
ω2 −22 + · · · +
1
ω2 −n2 + · · ·

π Cos[ωπ]
Sin[ωπ] −1
ω = 2 ω

1
ω2 −1 +
1
ω2 −22 + · · · +
1
ω2 −n2 + · · ·

π
Z x
0
Cos[ωπ]
Sin[ωπ] −
1
π ω dω =
Z x
0
2 ω
ω2 −1 dω +
Z x
0
2 ω
ω2 −22 dω + · · · +
Z x
0
2 ω
ω2 −n2 dω + · · ·

Log
Sin[π x]
π x

= Log[1 −x2
1 ] + Log[1 −x2
22 ] + · · · + Log[1 −x2
n2 ] + · · ·
Sin[π x] = π x
∞
Y
k=1

1 −x2
k2

Example 13.14.
The Derivative of The Series for Cos[ωx]

Convergence for Piecewise Smooth Functions
167
Formally diﬀerentiating,
d Cos[ωx]
dx
= 2ω Sin[ωπ]
π
d
dx
 1
2ω2 −Cos[x]
ω2 −1 + Cos[2x]
ω2 −22 + · · · + (−1)n
ω2 −n2 Cos[n x] + · · ·

−Sin[ω x] = 2 Sin[ωπ]
π
 Sin[x]
ω2 −1 −2 Cos[2 x]
ω2 −22
+ · · · + (−1)n+1
n
ω2 −n2 Sin[n x] + · · ·

Example 13.15.
The Series for Sin[ωx], for Non-Integer ω
In the project on Fourier Series you show that when ω is not an integer,
Sin[ωx] = 2 Sin[ωπ]
π

−Sin[x]
ω2 −1 + 2 Sin[2x]
ω2 −22 + · · · + (−1)n
n
ω2 −n2 Sin[n x] + · · ·

Example 13.16.
Hyperbolic Functions Restricted to −π < x < π
We can also compute
cosh[ω x] = 2 ω sinh[ω π]
π
 1
2ω2 −Cos[x]
ω2 + 12 + Cos[2 x]
ω2 + 22 + · · · + (−1)n
1
ω2 + n2 Cos[n x] + · · ·

sinh[ω x] = 2 sinh[ω π]
π
 Sin[x]
ω2 + 12 −2 Sin[2 x]
ω2 + 22 + · · · + (−1)n+1
n
ω2 + n2 Sin[n x] + · · ·

Exercise set 13.1
1. Use the computer to plot the Fourier series examples above.
13.2
Convergence for Piecewise Smooth
Functions
Fourier series of piecewise smooth functions converge.
A function f[x] on −π < x ≤π is said to be piecewise continuous if it is continuous
except for at most a ﬁnite number of jump discontinuities. That is, except for ﬁnitely many
values of x, limξ→x f[ξ] = f[x], and at the ﬁnite number of other points xj, f[xj] has a jump
discontinuity, meaning limx↑xj f[x] exists and limx↓xj f[x] exists. (f[xj] can exist, but need
not equal either one-sided limit. Fourier series will converge to the midpoint of a jump.) A
function is said to be piecewise smooth if both f[x] and f ′[x] are piecewise continuous.
Piecewise smooth functions can be continuous, like the periodic extension of |x| for −π <
x ≤π. In this case the function has a kink or its derivative f ′[x] has a jump discontinuity
because f ′[x] = −1 for x < 0 and f ′[x] = +1 for x > 0. (See Figure 13.1.)

168
13. The Theory of Fourier Series
Periodic extension can create jump discontinuities, like x for −π < x < π. In this case
limx↑π f[x] = π but limx↓π “periodic x” = limx↓−π x = −π. (See Figure 13.2.)
Periodic extension can create jumps in the derivative of a smooth function like x2. Sketch
the graph from −π to π, extend periodically, and observe that the graph is continuous, but
not smooth at multiples of π.
We need the following
Theorem 13.1.
A Trig Identity and Integral
Sin[(n + 1
2) φ]
2 Sin[ 1
2φ]
= 1
2 +
n
X
k=1
Cos[k φ]
and
1
π
Z π
0
Sin[(n + 1
2) φ]
Sin[ 1
2φ]
dφ = 1
Proof:
By Euler’s formula, Cos[θ] = 1
2(eiθ + e−iθ),
1
2 +
n
X
k=1
Cos[k φ] = 1
2
n
X
k=−n
ei k φ = e−i n φ
2n
X
h=0
rh, for r = ei φ
= e−i n φ 1 −r2n+1
1 −r
= e−i n φ 1 −ei (2n+1) φ
1 −ei φ
= e−i n φ −ei (n+1) φ
2
· e−i 1
2 φ
e−i 1
2 φ ·
1
1 −ei φ
= ei (n+ 1
2 ) φ −e−i (n+ 1
2 ) φ
2i
· 1
2 ·
2i
ei 1
2 φ −e−i 1
2 φ
= Sin[(n + 1
2)φ]
2 Sin[ 1
2 φ]
using Euler’s formula, Sin[θ] = 1
2i
 eiθ −e−iθ
.
For the integral notice that all the terms of the integral of the right hand side vanish
except for the constant term.
Example 13.17.
The Dirichlet Kernel Sn[x] =
1
2 π
R π
−π f[x + θ] Sin[(n+ 1
2 )θ]
2 Sin[ 1
2 θ]
dθ
We use this identity to write a partial sum of a Fourier series as an integral. By the

Convergence for Piecewise Smooth Functions
169
deﬁnition of a partial sum of the Fourier series, for any n,
Sn[x] = a0 +
n
X
k=1
(ak Cos[k x] + bk Sin[k x])
= 1
π
 Z π
−π
1
2f[ξ] dξ +
n
X
k=1
Z π
−π
f[ξ] Cos[k ξ] dξ Cos[k x] +
Z π
−π
f[ξ] Sin[k ξ] dξ Sin[k x]
!
= 1
π
Z π
−π
f[ξ]
 
1
2 +
n
X
k=1
(Cos[k ξ] Cos[k x] + Sin[k ξ] Sin[k x])
!
dξ
= 1
π
Z π
−π
f[ξ]
 
1
2 +
n
X
k=1
Cos[k (ξ −x)]
!
dξ
= 1
π
Z π
−π
f[ξ] · Sin[(n + 1
2)(ξ −x)]
2 Sin[ 1
2 (ξ −x)]
dξ, by the trig identity above.
Now make a change of variable and diﬀerential, ξ = x + θ, dξ = dθ and use periodicity
of f[x] to see,
Sn[x] = 1
2 π
Z π
−π
f[x + θ]Sin[(n + 1
2)θ]
Sin[ 1
2 θ]
dθ
Notice that this integrand is well-behaved even near θ = 0 where the denominator tends
to zero. (Sin[x]/x extends smoothly to x = 0, as you can easily see from the power series
for sine.)
The intuitive idea using this formula in the convergence theorem given next is to think
of the sine fraction as giving a “measure” for each n.
Z π
−π
() dµn[θ] = 1
2 π
Z π
−π
() Sin[(n + 1
2)θ]
Sin[ 1
2 θ]
dθ
Each of these measures has total “mass” 1,
Z π
−π
(1) dµn[θ] = 1
2 π
Z π
−π
(1) Sin[(n + 1
2)θ]
Sin[ 1
2 θ]
dθ = 1
As n increases, more and more of this unit mass is concentrated near θ = 0,
-3
-2
-1
1
2
3
-5
5
10
15
20
-3
-2
-1
1
2
3
-5
5
10
15
20
Figure 13.4: Dirichlet’s Kernel Sin[(n+ 1
2 )θ]
Sin[ 1
2 θ]
with n = 10

170
13. The Theory of Fourier Series
Since θ ≈0 implies f[x −θ] ≈f[x], we expect
Z π
−π
(f[x + θ]) dµn[θ] ≈f[x]
when n is large. It is not quite this simple, but it is easy to show that the measure is less
and less important away from zero.
Theorem 13.2.
Suppose f[x] is 2 π-periodic and piecewise smooth. Then for any ﬁxed
ε > 0,
lim
n→∞
Z π
ε
f[x + θ] Sin[(n + 1
2)θ]
Sin[ 1
2 θ]
dθ +
Z −ε
−π
f[x + θ] Sin[(n + 1
2)θ]
Sin[ 1
2 θ]
dθ = 0
Proof:
Deﬁne the function
g[θ] = f[x + θ]/ Sin[θ/2]
Since f[x] is piecewise smooth and Sin[θ/2] is nonzero for ε ≤θ ≤π,
Z π
ε
f[x + θ] Sin[(n + 1
2)θ]
Sin[ 1
2 θ]
dθ =
Z π
ε
g[θ] Sin[(n + 1
2)θ] dθ
g[θ] is piecewise smooth and we may integrate by parts:
Z π
ε
g[θ] Sin[(n + 1
2)θ] dθ =
1
n + 1
2

g[ε] Cos[(n + 1
2)ε] −g[π] Cos[(n + 1
2)π]
+
Z π
ε
g′[θ] Cos[(n + 1
2)θ] dθ

→0, as n →∞
In order to prove the strongest form of the convergence theorem, we need the following
generalization of this result.
Theorem 13.3.
Suppose that g[θ] is piecewise continuous on the subinterval [a, b] of
[−π, π]. Then
Z b
a
g[θ] Sin[νθ] dθ →0 as ν →∞
Proof:
Let ν be a large integer, the interval a ≤x ≤b is divided into a sequence of adjacent
subintervals [x2j, x2j+1], [x2j+1, x2j+2] of length π/ν where ν x2j is an even multiple of π
and ν x2j+1 is an odd multiple of π. These are simply the points that lie in the interval of
the form k π/ν, for integers k.
There may be as many as 2 exceptional unequal length subintervals at the ends and
one additional non-matched subinterval of odd and even multiples of π/ν. Re-number the
sequence beginning with x1 = a and ending with b.
The integral
Z b
a
g[x] Sin[ν x] dx =
n
X
j=1
 Z x2j+1
x2j
g[x] Sin[ν x] dx +
Z x2j+2
x2j+1
g[x] Sin[ν x] dx
!

Convergence for Piecewise Smooth Functions
171
Sine is positive on one subinterval of each pair and negative on the next with
Z x2j+1
x2j
Sin[νξ] dξ = −
Z x2j+2
x2j+1
Sin[νξ] dξ
The same decomposition is true when ν is an inﬁnite hyperreal. We may write
Z b
a
g[x] Sin[ν x] dx =
Z x1
a
g[x] Sin[ν x] dx +
n
X
j=1
 Z x2j
x2j−1
g[x] Sin[x] dx +
Z x2j+1
x2j
g[x] Sin[x] dx
!
+
Z b
x2n+2
g[x] Sin[ν x] dx
When ν is inﬁnite, g[θ] changes very little on [x2j−1, x2j+1], in fact, the maximum and
minimum over a pair of subintervals diﬀer by an inﬁnitesimal: there is a sequence of in-
ﬁnitesimals ηj such that
|g[ξ] −g[ζ]| ≤ηj ≈0, for x2j−1 ≤ξ ≤ζ ≤x2j+1
Sine is positive on one and negative on the other so that the adjacent subintegrals nearly
cancel,

Z x2j
x2j−1
g[x] Sin[ν x] dx +
Z x2j+1
x2j
g[x] Sin[ν x] dx
 =

Z x2j
x2j−1
g[x] Sin[ν x] + g[x + π
ν ] Sin[ν x + π] dx
 ≤

Z x2j
x2j−1
(g[x] −g[x + π
ν ]) Sin[ν x] dx
 ≤
Max[|g[x] −g[x + π
ν ]| : x2j−1 ≤x ≤x2j]
Z x2j
x2j−1
1 dx ≤ηj
π
ν
and

n
X
j=1
 Z x2j
x2j−1
g[x] Sin[ν x] dx +
Z x2j+1
x2j
g[x] Sin[ν x] dx
 ≤
n
X
j=1
ηj
π
ν
≤Max[ηj : 1 ≤j ≤n]
n
X
j=1
π
ν
≤ηh · (b −a)/2 ≈0
The few stray inﬁnitesimal end subintervals contribute at most an inﬁnitesimal since g[x] is
bounded, so
Z b
a
g[x] Sin[ν x] dx ≈0
and the theorem is proved (by the characterization of limits with inﬁnite indices.)

172
13. The Theory of Fourier Series
Theorem 13.4.
Dirichlet’s Convergence Theorem
If f[x] is a piecewise smooth 2 π-periodic function, then the Fourier series of f[x]
converges to the function at each point of continuity of f[x] and converges to the
midpoint of the jump at the ﬁnite number of jump discontinuities, for all x,
1
2

lim
ξ↑x f[ξ] + lim
ξ↓x f[ξ]

= a0 +
∞
X
k=0
ak Cos[k x] +
∞
X
k=0
bk Sin[k x]
If f[x] is continuous at x, f[x] = 1
2 (limξ↑x f[ξ] + limξ↓x f[ξ]).
Proof:
Fix a value of x and let Fx = limξ↓x f[ξ]. Then limξ↓x f[x] −Fx = 0 and the piecewise
derivative of f[x] means lim∆x↓0
f[x+∆x]−Fx
∆x
= F ′
x exists.
Since lim∆x→0
Sin[∆x]
∆x
= lim∆x→0
Sin[∆x/2]
∆x/2
= 1, we also have
lim
∆x↓0
f[x + ∆x] −Fx
2 Sin[∆x/2]
= F ′
x
This discussion means that the function
g[θ] = f[x + θ] −Fx
Sin[θ/2]
is piecewise continuous on [0, π] and Theorem 13.3 says
Z π
0
g[θ] Sin[(n + 1
2)θ] dθ →0 as n →∞
Thus, we see that
1
π
Z π
0
f[x + θ] −Fx
Sin[θ/2]
Sin[(n + 1
2)θ] dθ →0
1
π
Z π
0
f[x + θ]Sin[(n + 1
2)θ]
Sin[θ/2]
dθ →Fx
1
π
Z π
0
Sin[(n + 1
2)θ]
Sin[θ/2]
dθ = limξ↓x f[ξ]
2
Similarly,
1
π
Z 0
−π
f[x + θ]Sin[(n + 1
2)θ]
Sin[θ/2]
dθ →limξ↑x f[ξ]
2
This proves the theorem.
Exercise set 13.2
Intuitively, many of the weakly convergent Fourier series are converging by cancelling
oscillations. If this is true, we would expect averages to be even better approximations.
1. Let sm[x] = 1
2 + Pm
k=1 (Cos[k x] + Sin[k x]) be the partial Fourier-like sum. Deﬁne the
average of the partial sums to be
an[x] =
1
1 + n
n
X
m=0
sm[x]

Uniform Convergence for Continuous Piecewise Smooth Functions
173
When Sm[x] = a0 + Pm
k=1 (ak Cos[k x] + bk Sin[k x]) are the partial Fourier sums of a
function f[x], let
An[x] =
1
1 + n
n
X
m=0
Sm[x]
denote the average of the ﬁrst n Fourier sums.
(a) Plot the average Fourier sums An[x] for the examples of the previous section,
especially those that converge weakly like f[x] = x at ±π or f[x] = Sign[x].
(b) Show that
an[x] =
1
1 + n
Sin[(n + 1) x
2 ]
Sin[ x
2 ]
2
(c) Show that
1
π
Z π
0
1
1 + n
Sin[(n + 1) x
2 ]
Sin[ x
2]
2
dx = 1
(d) Show that the average of the ﬁrst n Fourier series of a function f[x] are given by
An[x] = 1
2 π
Z π
−π
f[x + θ]
1
1 + n
 
Sin[(n + 1) x
2 ]
Sin[ θ
2]
!2
dθ
13.3
Uniform Convergence for Con-
tinuous Piecewise Smooth Func-
tions
Fourier series of continuous piecewise smooth functions converge uniformly.
Theorem 13.5.
Uniform Convergence of Fourier Series
If f[x] is continuous and f ′[x] is piecewise continuous, then its Fourier series
converges absolutely and uniformly to the function. Moreover, the Fourier series
of any piecewise smooth function converges uniformly to the function on any closed
subinterval where the function is continuous.
Proof of this theorem requires some inequalities related to mean square convergence. In
particular,
a2
0 +
n
X
k=1
(a2
k + b2
k) ≤1
π
Z π
−π
(f[x])2 dx and for any sequences
 n
X
k=1
uk vk
!2
≤
n
X
k=1
u2
k ·
n
X
k=1
v2
k
We refer the reader to a book on fourier series.

174
13. The Theory of Fourier Series
We do want to compare the convergence of some of the continuous and discontinuous
examples computed above to compare uniform and non-uniform convergence.
Example 13.18.
Inﬁnitely Slowly Convergent Series with a Discontinuous Limit
Fourier series can converge delicately. For example, the identity
x = 2

Sin[x] −Sin[2x]
2
+ Sin[3x]
3
+ · · · + (−1)n+1 Sin[nx]
n
+ · · ·

is a valid convergent series for −π < x < π. However, the Weierstrass majorization does
not yield a simple convergence estimate, because
(−1)n+1 Sin[nx]
n
 ≤1
n
is a useless upper estimate by a divergent series, P∞
k=1
1
n = ∞. The Fourier series converges
but not uniformly, and its limit function is discontinuous because repeating x periodically
produces a jump at π as follows:
{terms =, 7}
-4
-2
2
4
-3
-2
-1
1
2
3
Figure 13.5: Fourier series for f[x] = x
The convergence of the Fourier series for Sign[x]
4
π

Sin[x] + 1
3 Sin[3 x] + 1
5 Sin[5 x]+

= Sign[x]
holds at every ﬁxed point, but the convergence is not uniform.

Integration of Fourier Series
175
{terms =, 7}
-4
-2
2
4
-1.5
-1
-0.5
0.5
1
1.5
Figure 13.6: Gibbs Goalposts f[x] = Sign[x]
In fact, the graphs of the approximations do not converge to a “square wave,” but rather
to “goal posts.” Each approximating term has an overshoot before the jump in Sign[x] and
these move to a straight line segment longer than the distance between ±1. You can see this
for yourself in the animation of the computer program FourierSeries. A book on Fourier
series will show you how to estimate the height of the overshoot.
In both of these examples, no matter how many terms we take in the Fourier series, even
a hyperreal inﬁnite number, there will always be an x close to the jump where the partial
sum is half way between the one-sided limit and the midpoint of the jump. In this sense
the series is converging “inﬁnitely slowly” near the jump.
13.4
Integration of Fourier Series
Fourier series of piecewise smooth functions can be integrated termwise,
even if the series are not uniformly convergent.
Theorem 13.6.
Integration of Fourier Series
Let f[x] be a piecewise continuous 2 π-periodic function with Fourier series
a0 +
∞
X
k=0
ak Cos[k x] +
∞
X
k=0
bk Sin[k x]
(which we do not even assume is convergent.) The Fourier series can be integrated
between any two limits −π ≤α < ξ ≤π and
Z ξ
α
f[x] dx = a0(ξ −α) +
∞
X
k=0
Z ξ
α
ak Cos[k x] dx +
∞
X
k=0
Z ξ
α
bk Sin[k x] dx
Moreover, the series on the right converges uniformly in ξ.
Proof:

176
13. The Theory of Fourier Series
Deﬁne the function
F[x] =
Z x
−π
(f[ξ] −a0) dξ
Then F[x] is continuous inside the interval (−π, π) and piecewise smooth.
Since a0 =
1
π
R π
−π f[ξ] dξ, F[−π] = 0 = F[π], and F[x] has a continuous periodic extension. Applying
Theorem 13.5, the Fourier series for F[x] converges uniformly. Denote this series by
F[x] = A0 +
∞
X
k=1
(Ak Cos[k x] + Bk Sin[k x])
Apply integration by parts to the deﬁnitions of the Fourier coeﬃcients with k > 0,
Ak = 1
π
Z π
−π
F[x] Cos[k x] dx
= 1
π

F[π]Sin[k π]
k
−F[−π]Sin[−k π]
k
−1
k
Z π
−π
f[x] Sin[k x] dx

= −1
k
1
π
Z π
−π
f[x] Sin[k x] dx = −bk
k
and similarly
Bk = ak
k
Notice that the uniformly convergent series gives
F[x] −F[ξ] =
∞
X
k=1
(Ak(Cos[k x] −Cos[k ξ]) + Bk(Sin[k x] −Sin[k ξ]))
=
∞
X
k=1
ak
k (Sin[k x] −Sin[k ξ]) −bk
k (Cos[k x] −Cos[k ξ])

Replace F[x] by its deﬁnition and the diﬀerences by integrals,
−1
k(Cos[k x]−Cos[k ξ]) =
Z x
ξ
Sin[k ζ] dζ
and
1
k(Sin[k x]−Sin[k ξ]) =
Z x
ξ
Cos[k ζ] dζ
to see the uniformly convergent series
Z x
ξ
f[ζ] dζ −a0
Z x
ξ
dζ =
∞
X
k=1

ak
Z x
ξ
Cos[k ζ] dζ + bk
Z x
ξ
Sin[k ζ] dζ


