Graduate Texts in Mathematics
Classical 
Fourier 
Analysis
Loukas Grafakos
Third Edition

Graduate Texts in Mathematics
249

Graduate Texts in Mathematics
Series Editors:
Sheldon Axler
San Francisco State University, San Francisco, CA, USA
Kenneth Ribet
University of California, Berkeley, CA, USA
Advisory Board:
Colin Adams, Williams College, Williamstown, MA, USA
Alejandro Adem, University of British Columbia, Vancouver, BC, Canada
Ruth Charney, Brandeis University, Waltham, MA, USA
Irene M. Gamba, The University of Texas at Austin, Austin, TX, USA
Roger E. Howe, Yale University, New Haven, CT, USA
David Jerison, Massachusetts Institute of Technology, Cambridge, MA, USA
Jeffrey C. Lagarias, University of Michigan, Ann Arbor, MI, USA
Jill Pipher, Brown University, Providence, RI, USA
Fadil Santosa, University of Minnesota, Minneapolis, MN, USA
Amie Wilkinson, University of Chicago, Chicago, IL, USA
Graduate Texts in Mathematics bridge the gap between passive study and creative
understanding, offering graduate-level introductions to advanced topics in mathe-
matics. The volumes are carefully written as teaching aids and highlight character-
istic features of the theory. Although these books are frequently used as textbooks
in graduate courses, they are also suitable for individual study.
For further volumes:
http://www.springer.com/series/136

Loukas Grafakos
Classical Fourier Analysis
Third Edition
123

Loukas Grafakos
Department of Mathematics
University of Missouri
Columbia, MO, USA
ISSN 0072-5285
ISSN 2197-5612 (electronic)
ISBN 978-1-4939-1193-6
ISBN 978-1-4939-1194-3 (eBook)
DOI 10.1007/978-1-4939-1194-3
Springer New York Heidelberg Dordrecht London
Library of Congress Control Number: 2014946585
Mathematics Subject Classiﬁcation (2010): 42Axx, 42Bxx
© Springer Science+Business Media New York 2000, 2008, 2014
This work is subject to copyright. All rights are reserved by the Publisher, whether the whole or part of
the material is concerned, speciﬁcally the rights of translation, reprinting, reuse of illustrations, recitation,
broadcasting, reproduction on microﬁlms or in any other physical way, and transmission or information
storage and retrieval, electronic adaptation, computer software, or by similar or dissimilar methodology
now known or hereafter developed. Exempted from this legal reservation are brief excerpts in connection
with reviews or scholarly analysis or material supplied speciﬁcally for the purpose of being entered
and executed on a computer system, for exclusive use by the purchaser of the work. Duplication of
this publication or parts thereof is permitted only under the provisions of the Copyright Law of the
Publisher’s location, in its current version, and permission for use must always be obtained from Springer.
Permissions for use may be obtained through RightsLink at the Copyright Clearance Center. Violations
are liable to prosecution under the respective Copyright Law.
The use of general descriptive names, registered names, trademarks, service marks, etc. in this publication
does not imply, even in the absence of a speciﬁc statement, that such names are exempt from the relevant
protective laws and regulations and therefore free for general use.
While the advice and information in this book are believed to be true and accurate at the date of pub-
lication, neither the authors nor the editors nor the publisher can accept any legal responsibility for any
errors or omissions that may be made. The publisher makes no warranty, express or implied, with respect
to the material contained herein.
Printed on acid-free paper
Springer is part of Springer Science+Business Media (www.springer.com)

To Suzanne


Preface
The great response to the publication of my book Classical and Modern Fourier
Analysis in 2004 has been especially gratifying to me. I was delighted when Springer
offered to publish the second edition in 2008 in two volumes: Classical Fourier
Analysis, 2nd Edition, and Modern Fourier Analysis, 2nd Edition. I am now elated
to have the opportunity to write the present third edition of these books, which
Springer has also kindly offered to publish. The third edition was born from my
desire to improve the exposition in several places, ﬁx a few inaccuracies, and add
some new material. I have been very fortunate to receive several hundred e-mail
messages that helped me improve the proofs and locate mistakes and misprints in
the previous editions.
In this edition, I maintain the same style as in the previous ones. The proofs con-
tain details that unavoidably make the reading more cumbersome. Although it will
behoove many readers to skim through the more technical aspects of the presenta-
tion and concentrate on the ﬂow of ideas, the fact that details are present will be
comforting to some. (This last sentence is based on my experience as a graduate
student.) Readers familiar with the second edition will notice that the chapter on
weights has been moved from the second volume to the ﬁrst.
This ﬁrst volume Classical Fourier Analysis is intended to serve as a text for
a one-semester course with prerequisites of measure theory, Lebesgue integration,
and complex variables. I am aware that this book contains signiﬁcantly more ma-
terial than can be taught in a semester course; however, I hope that this additional
information will be useful to researchers. Based on my experience, the following list
of sections (or parts of them) could be taught in a semester without affecting the
logical coherence of the book: Sections 1.1, 1.2, 1.3, 2.1, 2.2., 2.3, 3.1, 3.2, 3.3, 4.4,
4.5, 5.1, 5.2, 5.3, 5.5, 5.6, 6.1, 6.2.
A long list of people have assisted me in the preparation of this book, but I remain
solely responsible for any misprints, mistakes, and omissions contained therein.
Please contact me directly (grafakosl@missouri.edu) if you have corrections or com-
ments. Any corrections to this edition will be posted to the website
http://math.missouri.edu/˜loukas/FourierAnalysis.html
vii

viii
Preface
which I plan to update regularly. I have prepared solutions to all of the exercises for
the present edition which will be available to instructors who teach a course out of
this book.
Athens, Greece,
Loukas Grafakos
March 2014

Acknowledgments
I am extremely fortunate that several people have pointed out errors, misprints, and
omissions in the previous editions of the books in this series. All these individuals
have provided me with invaluable help that resulted in the improved exposition of
the text. For these reasons, I would like to express my deep appreciation and sincere
gratitude to the all of the following people.
ix
First edition acknowledgements: Georgios Alexopoulos, Nakhl´e Asmar, Bruno
Calado, Carmen Chicone, David Cramer, Geoffrey Diestel, Jakub Duda, Brenda
Frazier, Derrick Hart, Mark Hoffmann, Steven Hofmann, Helge Holden, Brian
Hollenbeck, Petr Honz´ık, Alexander Iosevich, Tunde Jakab, Svante Janson, Ana
Jim´enez del Toro, Gregory Jones, Nigel Kalton, Emmanouil Katsoprinakis, Dennis
Kletzing, Steven Krantz, Douglas Kurtz, George Lobell, Xiaochun Li, Jos´e Mar´ıa
Martell, Antonios Melas, Keith Mersman, Stephen Montgomery-Smith, Andrea
Nahmod, Nguyen Cong Phuc, Krzysztof Oleszkiewicz, Cristina Pereyra, Carlos
P´erez, Daniel Redmond, Jorge Rivera-Noriega, Dmitriy Ryabogin, Christopher
Sansing, Lynn Savino Wendel, Shih-Chi Shen, Roman Shvidkoy, Elias M. Stein,
Atanas Stefanov, Terence Tao, Erin Terwilleger, Christoph Thiele, Rodolfo Torres,
Deanie Tourville, Nikolaos Tzirakis, Don Vaught, Igor Verbitsky, Brett Wick, James
Wright, and Linqiao Zhao.
Second edition acknowledgements: Marco Annoni, Pascal Auscher, Andrew
Bailey, Dmitriy Bilyk, Marcin Bownik, Juan Cavero de Carondelet Fiscowich,
Leonardo Colzani, Simon Cowell, Mita Das, Geoffrey Diestel, Yong Ding, Jacek
Dziubanski, Frank Ganz, Frank McGuckin, Wei He, Petr Honz´ık, Heidi Hulsizer,
Philippe Jaming, Svante Janson, Ana Jim´enez del Toro, John Kahl, Cornelia Kaiser,
Nigel Kalton, Kim Jin Myong, Doowon Koh, Elena Koutcherik, David Kramer,
Enrico Laeng, Sungyun Lee, Qifan Li, Chin-Cheng Lin, Liguang Liu, Stig-Olof
Londen, Diego Maldonado, Jos´e Mar´ıa Martell, Mieczysław Mastyło, Parasar
Mohanty, Carlo Morpurgo, Andrew Morris, Mihail Mourgoglou, Virginia Naibo,
Tadahiro Oh, Marco Peloso, Maria Cristina Pereyra, Carlos P´erez, Humberto Rafeiro,
Maria Carmen Reguera Rodr´ıguez, Alexander Samborskiy, Andreas Seeger, Steven
Senger, Sumi Seo, Christopher Shane, Shu Shen, Yoshihiro Sawano, Mark Spencer,
Vladimir Stepanov, Erin Terwilleger, Rodolfo H. Torres, Suzanne Tourville,

x
Acknowledgments
Among all these people, I would like to give special thanks to an individual who
has studied extensively the two books in the series and has helped me more than
anyone else in the preparation of the third edition: Danqing He. I am indebted to him
for all the valuable corrections, suggestions, and constructive help he has provided
me with in this work. Without him, these books would have been a lot poorer.
Finally, I would also like to thank the University of Missouri for granting me
a research leave during the academic year 2013-2014. This time off enabled me to
ﬁnish the third edition of this book on time. I spent my leave in Greece.
Ignacio Uriarte-Tuero, Kunyang Wang, Huoxiong Wu, Kˆozˆo Yabuta, Takashi
Yamamoto, and Dachun Yang.
Third edition acknowledgments: Marco Annoni, Mark Ashbaugh, Daniel
Azagra, Andrew Bailey, ´Arpad B´enyi, Dmitriy Bilyk, Nicholas Boros, Almut
Burchard, Mar´ıa Carro, Jameson Cahill, Juan Cavero de Carondelet Fiscowich,
Xuemei Chen, Andrea Fraser, Shai Dekel, Fausto Di Biase, Zeev Ditzian, Jianfeng
Dong, Oliver Dragiˇcevi´c, Sivaji Ganesh, Friedrich Gesztesy, Zhenyu Guo, Piotr
Hajłasz, Danqing He, Andreas Heinecke, Steven Hofmann, Takahisa Inui, Junxiong
Jia, Kasinathan Kamalavasanthi, Hans Koelsch, Richard Laugesen, Kaitlin Leach,
Andrei Lerner, Yiyu Liang, Calvin Lin, Liguang Liu, Elizabeth Loew, Chao Lu,
Richard Lynch, Diego Maldonado, Lech Maligranda, Richard Marcum, Mieczysław
Mastyło, Mariusz Mirek, Carlo Morpurgo, Virginia Naibo, Hanh Van Nguyen,
Seungly Oh, Tadahiro Oh, Yusuke Oi, Lucas da Silva Oliveira, Kevin O’Neil, Hesam
Oveys, Manos Papadakis, Marco Peloso, Carlos P´erez, Jesse Peterson, Dmitry
Prokhorov, Amina Ravi, Maria Carmen Reguera Rodr´ıguez, Yoshihiro Sawano,
Mirye Shin, Javier Soria, Patrick Spencer, Marc Strauss, Krystal Taylor, Naohito
Tomita, Suzanne Tourville, Rodolfo H. Torres, Fujioka Tsubasa, Ignacio Uriarte-
Tuero, Brian Tuomanen, Shibi Vasudevan, Michael Wilson, Dachun Yang, Kai Yang,
Yandan Zhang, Fayou Zhao, and Lifeng Zhao.

Contents
1
Lp Spaces and Interpolation
1
1.1
Lp and Weak Lp . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1
1.1.1
The Distribution Function . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
3
1.1.2
Convergence in Measure . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
6
1.1.3
A First Glimpse at Interpolation . . . . . . . . . . . . . . . . . . . . . . . .
9
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
11
1.2
Convolution and Approximate Identities . . . . . . . . . . . . . . . . . . . . . . .
17
1.2.1
Examples of Topological Groups . . . . . . . . . . . . . . . . . . . . . . .
18
1.2.2
Convolution . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
19
1.2.3
Basic Convolution Inequalities . . . . . . . . . . . . . . . . . . . . . . . . .
21
1.2.4
Approximate Identities. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30
1.3
Interpolation. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 33
1.3.1
Real Method: The Marcinkiewicz Interpolation Theorem . . . 33
1.3.2
Complex Method: The Riesz–Thorin Interpolation
Theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36
1.3.3
Interpolation of Analytic Families of Operators . . . . . . . . . . . 40
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45
1.4
Lorentz Spaces. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 48
1.4.1
Decreasing Rearrangements . . . . . . . . . . . . . . . . . . . . . . . . . . . 48
1.4.2
Lorentz Spaces . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 52
1.4.3
Duals of Lorentz Spaces . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 56
1.4.4
The Off-Diagonal Marcinkiewicz Interpolation Theorem . . . 60
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
74
2
Maximal Functions, Fourier Transform, and Distributions
85
2.1
Maximal Functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 86
2.1.1
The Hardy–Littlewood Maximal Operator. . . . . . . . . . . . . . . . 86
2.1.2
Control of Other Maximal Operators . . . . . . . . . . . . . . . . . . . . 90
xi

xii
Contents
2.1.3
Applications to Differentiation Theory . . . . . . . . . . . . . . . . . . 93
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 98
2.2
The Schwartz Class and the Fourier Transform . . . . . . . . . . . . . . . . . . 104
2.2.1
The Class of Schwartz Functions . . . . . . . . . . . . . . . . . . . . . . . 105
2.2.2
The Fourier Transform of a Schwartz Function . . . . . . . . . . . 108
2.2.3
The Inverse Fourier Transform and Fourier Inversion . . . . . . 111
2.2.4
The Fourier Transform on L1 +L2 . . . . . . . . . . . . . . . . . . . . . . 113
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 116
2.3
The Class of Tempered Distributions . . . . . . . . . . . . . . . . . . . . . . . . . . 119
2.3.1
Spaces of Test Functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 119
2.3.2
Spaces of Functionals on Test Functions . . . . . . . . . . . . . . . . . 120
2.3.3
The Space of Tempered Distributions . . . . . . . . . . . . . . . . . . . 123
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 131
2.4
More About Distributions and the Fourier Transform . . . . . . . . . . . . . 133
2.4.1
Distributions Supported at a Point . . . . . . . . . . . . . . . . . . . . . . 134
2.4.2
The Laplacian . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 135
2.4.3
Homogeneous Distributions . . . . . . . . . . . . . . . . . . . . . . . . . . . 136
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 143
2.5
Convolution Operators on Lp Spaces and Multipliers . . . . . . . . . . . . . 146
2.5.1
Operators That Commute with Translations . . . . . . . . . . . . . . 146
2.5.2
The Transpose and the Adjoint of a Linear Operator . . . . . . . 150
2.5.3
The Spaces M p,q(Rn) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 151
2.5.4
Characterizations of M 1,1(Rn) and M 2,2(Rn) . . . . . . . . . . . . 153
2.5.5
The Space of Fourier Multipliers Mp(Rn) . . . . . . . . . . . . . . . 155
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 159
2.6
Oscillatory Integrals . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 161
2.6.1
Phases with No Critical Points . . . . . . . . . . . . . . . . . . . . . . . . . 161
2.6.2
Sublevel Set Estimates and the Van der Corput Lemma. . . . . 164
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 169
3
Fourier Series
173
3.1
Fourier Coefﬁcients . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 173
3.1.1
The n-Torus Tn . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 174
3.1.2
Fourier Coefﬁcients . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 175
3.1.3
The Dirichlet and Fej´er Kernels . . . . . . . . . . . . . . . . . . . . . . . . 178
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 182
3.2
Reproduction of Functions from Their Fourier Coefﬁcients . . . . . . . . 183
3.2.1
Partial sums and Fourier inversion . . . . . . . . . . . . . . . . . . . . . . 183
3.2.2
Fourier series of square summable functions . . . . . . . . . . . . . 185
3.2.3
The Poisson Summation Formula . . . . . . . . . . . . . . . . . . . . . . . 187
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 191
3.3
Decay of Fourier Coefﬁcients . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 192
3.3.1
Decay of Fourier Coefﬁcients of Arbitrary Integrable
Functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 193
3.3.2
Decay of Fourier Coefﬁcients of Smooth Functions . . . . . . . . 195

Contents
xiii
3.3.3
Functions with Absolutely Summable Fourier
Coefﬁcients . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 200
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 202
3.4
Pointwise Convergence of Fourier Series . . . . . . . . . . . . . . . . . . . . . . . 204
3.4.1
Pointwise Convergence of the Fej´er Means . . . . . . . . . . . . . . . 204
3.4.2
Almost Everywhere Convergence of the Fej´er Means . . . . . . 207
3.4.3
Pointwise Divergence of the Dirichlet Means . . . . . . . . . . . . . 210
3.4.4
Pointwise Convergence of the Dirichlet Means . . . . . . . . . . . . 212
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 214
3.5
A Tauberian theorem and Functions of Bounded Variation . . . . . . . . 216
3.5.1
A Tauberian theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 216
3.5.2
The sine integral function . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 218
3.5.3
Further properties of functions of bounded variation . . . . . . . 219
3.5.4
Gibbs phenomenon. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 221
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 225
3.6
Lacunary Series and Sidon Sets . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 226
3.6.1
Deﬁnition and Basic Properties of Lacunary Series . . . . . . . . 227
3.6.2
Equivalence of Lp Norms of Lacunary Series . . . . . . . . . . . . . 229
3.6.3
Sidon sets . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 235
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 237
4
Topics on Fourier Series
241
4.1
Convergence in Norm, Conjugate Function,
and Bochner–Riesz Means . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 241
4.1.1
Equivalent Formulations of Convergence in Norm . . . . . . . . . 242
4.1.2
The Lp Boundedness of the Conjugate Function. . . . . . . . . . . 246
4.1.3
Bochner–Riesz Summability . . . . . . . . . . . . . . . . . . . . . . . . . . . 250
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 253
4.2
A. E. Divergence of Fourier Series and Bochner–Riesz means . . . . . 255
4.2.1
Divergence of Fourier Series of Integrable Functions . . . . . . 255
4.2.2
Divergence of Bochner–Riesz Means of Integrable
Functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 261
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 270
4.3
Multipliers, Transference, and Almost Everywhere Convergence . . . 271
4.3.1
Multipliers on the Torus. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 271
4.3.2
Transference of Multipliers . . . . . . . . . . . . . . . . . . . . . . . . . . . . 275
4.3.3
Applications of Transference. . . . . . . . . . . . . . . . . . . . . . . . . . . 280
4.3.4
Transference of Maximal Multipliers . . . . . . . . . . . . . . . . . . . . 281
4.3.5
Applications to Almost Everywhere Convergence . . . . . . . . . 285
4.3.6
Almost Everywhere Convergence of Square Dirichlet
Means . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 287
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 289

xiv
Contents
4.4
Applications to Geometry and Partial Differential Equations. . . . . . . 292
4.4.1
The Isoperimetric Inequality . . . . . . . . . . . . . . . . . . . . . . . . . . . 292
4.4.2
The Heat Equation with Periodic Boundary Condition . . . . . 294
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 298
4.5
Applications to Number theory and Ergodic theory . . . . . . . . . . . . . . 299
4.5.1
Evaluation of the Riemann Zeta Function at even Natural
numbers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 299
4.5.2
Equidistributed sequences . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 302
4.5.3
The Number of Lattice Points inside a Ball . . . . . . . . . . . . . . . 305
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 308
5
Singular Integrals of Convolution Type
313
5.1
The Hilbert Transform and the Riesz Transforms . . . . . . . . . . . . . . . . 313
5.1.1
Deﬁnition and Basic Properties of the Hilbert Transform . . . 314
5.1.2
Connections with Analytic Functions. . . . . . . . . . . . . . . . . . . . 317
5.1.3
Lp Boundedness of the Hilbert Transform . . . . . . . . . . . . . . . . 319
5.1.4
The Riesz Transforms . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 324
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 329
5.2
Homogeneous Singular Integrals and the Method of Rotations . . . . . 333
5.2.1
Homogeneous Singular and Maximal Singular Integrals . . . . 333
5.2.2
L2 Boundedness of Homogeneous Singular Integrals . . . . . . 336
5.2.3
The Method of Rotations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 339
5.2.4
Singular Integrals with Even Kernels . . . . . . . . . . . . . . . . . . . . 341
5.2.5
Maximal Singular Integrals with Even Kernels . . . . . . . . . . . 347
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 353
5.3
The Calder´on–Zygmund Decomposition and Singular Integrals . . . . 355
5.3.1
The Calder´on–Zygmund Decomposition . . . . . . . . . . . . . . . . . 355
5.3.2
General Singular Integrals . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 358
5.3.3
Lr Boundedness Implies Weak Type (1,1) Boundedness. . . . 359
5.3.4
Discussion on Maximal Singular Integrals . . . . . . . . . . . . . . . 362
5.3.5
Boundedness for Maximal Singular Integrals Implies
Weak Type (1,1) Boundedness . . . . . . . . . . . . . . . . . . . . . . . . . 366
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 371
5.4
Sufﬁcient Conditions for Lp Boundedness . . . . . . . . . . . . . . . . . . . . . . 374
5.4.1
Sufﬁcient Conditions for Lp Boundedness of Singular
Integrals . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 375
5.4.2
An Example . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 378
5.4.3
Necessity of the Cancellation Condition . . . . . . . . . . . . . . . . . 379
5.4.4
Sufﬁcient Conditions for Lp Boundedness of Maximal
Singular Integrals . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 380
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 384
5.5
Vector-Valued Inequalities . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 385
5.5.1
ℓ2-Valued Extensions of Linear Operators . . . . . . . . . . . . . . . . 386
5.5.2
Applications and ℓr-Valued Extensions of Linear
Operators . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 390

Contents
xv
5.5.3
General Banach-Valued Extensions . . . . . . . . . . . . . . . . . . . . . 391
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 398
5.6
Vector-Valued Singular Integrals . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 401
5.6.1
Banach-Valued Singular Integral Operators. . . . . . . . . . . . . . . 402
5.6.2
Applications . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 408
5.6.3
Vector-Valued Estimates for Maximal Functions . . . . . . . . . . 411
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 414
6
Littlewood–Paley Theory and Multipliers
419
6.1
Littlewood–Paley Theory . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 419
6.1.1
The Littlewood–Paley Theorem . . . . . . . . . . . . . . . . . . . . . . . . 420
6.1.2
Vector-Valued Analogues. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 426
6.1.3
Lp Estimates for Square Functions Associated
with Dyadic Sums . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 426
6.1.4
Lack of Orthogonality on Lp . . . . . . . . . . . . . . . . . . . . . . . . . . . 431
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 434
6.2
Two Multiplier Theorems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 437
6.2.1
The Marcinkiewicz Multiplier Theorem on R . . . . . . . . . . . . . 439
6.2.2
The Marcinkiewicz Multiplier Theorem on Rn . . . . . . . . . . . . 441
6.2.3
The Mihlin–H¨ormander Multiplier Theorem on Rn . . . . . . . . 445
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 450
6.3
Applications of Littlewood–Paley Theory . . . . . . . . . . . . . . . . . . . . . . 453
6.3.1
Estimates for Maximal Operators . . . . . . . . . . . . . . . . . . . . . . . 453
6.3.2
Estimates for Singular Integrals with Rough Kernels . . . . . . . 455
6.3.3
An Almost Orthogonality Principle on Lp . . . . . . . . . . . . . . . . 459
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 461
6.4
The Haar System, Conditional Expectation, and Martingales . . . . . . 463
6.4.1
Conditional Expectation and Dyadic Martingale
Differences . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 464
6.4.2
Relation Between Dyadic Martingale Differences
and Haar Functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 465
6.4.3
The Dyadic Martingale Square Function . . . . . . . . . . . . . . . . . 469
6.4.4
Almost Orthogonality Between the Littlewood–Paley
Operators and the Dyadic Martingale Difference
Operators . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 471
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 474
6.5
The Spherical Maximal Function . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 475
6.5.1
Introduction of the Spherical Maximal Function . . . . . . . . . . 475
6.5.2
The First Key Lemma . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 478
6.5.3
The Second Key Lemma . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 479
6.5.4
Completion of the Proof . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 481
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 481
6.6
Wavelets and Sampling . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 482
6.6.1
Some Preliminary Facts . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 483
6.6.2
Construction of a Nonsmooth Wavelet . . . . . . . . . . . . . . . . . . . 485

xvi
Contents
6.6.3
Construction of a Smooth Wavelet . . . . . . . . . . . . . . . . . . . . . . 486
6.6.4
Sampling . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 490
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 494
7
Weighted Inequalities
499
7.1
The Ap Condition . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 499
7.1.1
Motivation for the Ap Condition . . . . . . . . . . . . . . . . . . . . . . . . 500
7.1.2
Properties of Ap Weights . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 503
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 511
7.2
Reverse H¨older Inequality for Ap Weights and Consequences . . . . . . 514
7.2.1
The Reverse H¨older Property of Ap Weights . . . . . . . . . . . . . . 514
7.2.2
Consequences of the Reverse H¨older Property . . . . . . . . . . . . 518
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 521
7.3
The A∞Condition . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 525
7.3.1
The Class of A∞Weights . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 525
7.3.2
Characterizations of A∞Weights . . . . . . . . . . . . . . . . . . . . . . . 527
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 530
7.4
Weighted Norm Inequalities for Singular Integrals . . . . . . . . . . . . . . . 532
7.4.1
Singular Integrals of Non Convolution type . . . . . . . . . . . . . . 532
7.4.2
A Good Lambda Estimate for Singular Integrals . . . . . . . . . . 533
7.4.3
Consequences of the Good Lambda Estimate . . . . . . . . . . . . . 539
7.4.4
Necessity of the Ap Condition. . . . . . . . . . . . . . . . . . . . . . . . . . 543
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 545
7.5
Further Properties of Ap Weights. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 546
7.5.1
Factorization of Weights . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 546
7.5.2
Extrapolation from Weighted Estimates on a Single Lp0 . . . . 548
7.5.3
Weighted Inequalities Versus Vector-Valued Inequalities. . . . 554
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 558
A
Gamma and Beta Functions
563
A.1
A Useful Formula . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 563
A.2 Deﬁnitions of Γ (z) and B(z,w) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 563
A.3 Volume of the Unit Ball and Surface of the Unit Sphere. . . . . . . . . . . 565
A.4 Computation of Integrals Using Gamma Functions. . . . . . . . . . . . . . . 565
A.5 Meromorphic Extensions of B(z,w) and Γ (z) . . . . . . . . . . . . . . . . . . . 566
A.6 Asymptotics of Γ (x) as x →∞. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 567
A.7 Euler’s Limit Formula for the Gamma Function . . . . . . . . . . . . . . . . . 568
A.8 Reﬂection and Duplication Formulas for the Gamma Function . . . . . 570
B
Bessel Functions
573
B.1
Deﬁnition . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 573
B.2
Some Basic Properties . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 573
B.3
An Interesting Identity . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 576
B.4
The Fourier Transform of Surface Measure on Sn−1 . . . . . . . . . . . . . . 577
B.5
The Fourier Transform of a Radial Function on Rn . . . . . . . . . . . . . . . 577

Contents
xvii
B.6
Bessel Functions of Small Arguments . . . . . . . . . . . . . . . . . . . . . . . . . 578
B.7
Bessel Functions of Large Arguments. . . . . . . . . . . . . . . . . . . . . . . . . . 579
B.8
Asymptotics of Bessel Functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 580
B.9
Bessel Functions of general complex indices . . . . . . . . . . . . . . . . . . . . 582
C
Rademacher Functions
585
C.1
Deﬁnition of the Rademacher Functions. . . . . . . . . . . . . . . . . . . . . . . . 585
C.2
Khintchine’s Inequalities . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 586
C.3
Derivation of Khintchine’s Inequalities . . . . . . . . . . . . . . . . . . . . . . . . 586
C.4
Khintchine’s Inequalities for Weak Type Spaces . . . . . . . . . . . . . . . . . 589
C.5
Extension to Several Variables . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 589
D
Spherical Coordinates
591
D.1
Spherical Coordinate Formula . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 591
D.2 A Useful Change of Variables Formula . . . . . . . . . . . . . . . . . . . . . . . . 592
D.3 Computation of an Integral over the Sphere . . . . . . . . . . . . . . . . . . . . . 593
D.4 The Computation of Another Integral over the Sphere . . . . . . . . . . . . 593
D.5 Integration over a General Surface . . . . . . . . . . . . . . . . . . . . . . . . . . . . 594
D.6 The Stereographic Projection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 594
E
Some Trigonometric Identities and Inequalities
597
F
Summation by Parts
599
G
Basic Functional Analysis
601
H
The Minimax Lemma
603
I
Taylor’s and Mean Value Theorem in Several Variables
607
I.1
Mutlivariable Taylor’s Theorem. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 607
I.2
The Mean value Theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 608
J
The Whitney Decomposition of Open Sets in Rn
609
J.1
Decomposition of Open Sets . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 609
J.2
Partition of Unity adapted to Whitney cubes . . . . . . . . . . . . . . . . . . . . 611
Glossary
613
References
617
Index
633

Chapter 1
Lp Spaces and Interpolation
Many quantitative properties of functions are expressed in terms of their integra-
bility to a power. For this reason it is desirable to acquire a good understanding
of spaces of functions whose modulus to a power p is integrable. These are called
Lebesgue spaces and are denoted by Lp. Although an in-depth study of Lebesgue
spaces falls outside the scope of this book, it seems appropriate to devote a chapter
to reviewing some of their fundamental properties.
The emphasis of this review is basic interpolation between Lebesgue spaces.
Many problems in Fourier analysis concern boundedness of operators on Lebesgue
spaces, and interpolation provides a framework that often simpliﬁes this study. For
instance, in order to show that a linear operator maps Lp to itself for all 1 < p < ∞,
it is sufﬁcient to show that it maps the (smaller) Lorentz space Lp,1 into the (larger)
Lorentz space Lp,∞for the same range of p’s. Moreover, some further reductions can
be made in terms of the Lorentz space Lp,1. This and other considerations indicate
that interpolation is a powerful tool in the study of boundedness of operators.
Although we are mainly concerned with Lp subspaces of Euclidean spaces, we
discuss in this chapter Lp spaces of arbitrary measure spaces, since they represent
a useful general setting. Many results in the text require working with general mea-
sures instead of Lebesgue measure.
1.1 Lp and Weak Lp
A measure space is a set X equipped with a σ-algebra of subsets of it and a function
μ from the σ-algebra to [0,∞] that satisﬁes μ(/0) = 0 and
μ
 ∞

j=1
Bj

=
∞
∑
j=1
μ(Bj)
for any sequence Bj of pairwise disjoint elements of the σ-algebra. The function μ
is called a (positive) measure on X and elements of the σ-algebra of X are called
L. Grafakos, Classical Fourier Analysis, Graduate Texts in Mathematics 249,
DOI 10.1007/978-1-4939-1194-3 1, © Springer Science+Business Media New York 2014
1

2
1 Lp Spaces and Interpolation
measurable sets. Measure spaces will be assumed to be complete, i.e., subsets of
the σ-algebra of measure zero also belong to the σ-algebra. A measure space X is
called σ-ﬁnite if there is a sequence of measurable subsets Xn of it such that
X =
∞

n=1
Xn
and μ(Xn) < ∞. A real-valued function f on a measure space is called measurable if
the set {x ∈X : f(x) > λ} is measurable for all real numbers λ. A complex-valued
function is measurable if and only if its real and imaginary parts are measurable. A
simple function is a ﬁnite linear combination of characteristic functions of measur-
able subsets of X; these subsets may have inﬁnite measure. A ﬁnitely simple function
has the form
N
∑
j=1
cjχB j
where N < ∞, cj ∈C, and Bj are pairwise disjoint measurable sets with μ(Bj) < ∞.
If N = ∞, this function will be called countably simple. Finitely simple functions
are exactly the integrable simple functions. Every nonnegative measurable function
is the pointwise limit of an increasing sequence of simple functions; if the space is
σ-ﬁnite, these simple functions can be chosen to be ﬁnitely simple.
For 0 < p < ∞, Lp(X,μ) denotes the set of all complex-valued μ-measurable
functions on X whose modulus to the pth power is integrable. L∞(X,μ) is the set of
all complex-valued μ-measurable functions f on X such that for some B > 0, the set
{x : | f(x)| > B} has μ-measure zero. Two functions in Lp(X,μ) are considered equal
if they are equal μ-almost everywhere. When 0 < p < ∞ﬁnitely simple functions
are dense in Lp(X,μ). Within context and in the absence of ambiguity, Lp(X,μ) is
simply written as Lp.
The notation Lp(Rn) is reserved for the space Lp(Rn,| · |), where | · | denotes n-
dimensional Lebesgue measure. Lebesgue measure on Rn is also denoted by dx.
Other measures will be considered on the Borel σ-algebra of Rn, i.e., is the smallest
σ-algebra that contains the closed subsets of Rn. Measures on the σ-algebra of Borel
measurable subsets are called Borel measures; such measures will be assumed to be
ﬁnite on compact subsets of Rn. A Borel measure μ with μ(Rn) < ∞is called a ﬁnite
Borel measure. A Borel measure on Rn is called regular for all Borel measurable
sets E we have
μ(E) = inf{μ(O) : E ⫅O, O open} = sup{μ(K) : K ⫅E, K compact}.
The space Lp(Z) equipped with counting measure is denoted by ℓp(Z) or simply ℓp.
For 0 < p < ∞, we deﬁne the Lp norm of a function f (or quasi-norm if p < 1) by
 f

Lp(X,μ) =

X | f(x)|p dμ(x)
 1
p
(1.1.1)

1.1 Lp and Weak Lp
3
and for p = ∞by
f

L∞(X,μ) = ess.sup| f| = inf
	
B > 0 : μ({x : | f(x)| > B}) = 0

.
(1.1.2)
It is well known that Minkowski’s (or the triangle) inequality
f +g

Lp(X,μ) ≤
f

Lp(X,μ) +
g

Lp(X,μ)
(1.1.3)
holds for all f, g in Lp = Lp(X,μ), whenever 1 ≤p ≤∞. Since in addition
∥f∥Lp(X,μ) = 0 implies that f = 0 (μ-a.e.), the Lp spaces are normed linear spaces
for 1 ≤p ≤∞. For 0 < p < 1, inequality (1.1.3) is reversed when f,g ≥0. However,
the following substitute of (1.1.3) holds:
f +g

Lp(X,μ) ≤2
1−p
p  f

Lp(X,μ) +
g

Lp(X,μ)

,
(1.1.4)
and thus Lp(X,μ) is a quasi-normed linear space. See also Exercise 1.1.5. For all
0 < p ≤∞, it can be shown that every Cauchy sequence in Lp(X,μ) is convergent,
and hence the spaces Lp(X,μ) are complete. For the case 0 < p < 1 we refer to
Exercise 1.1.8. Therefore, the Lp spaces are Banach spaces for 1 ≤p ≤∞and quasi-
Banach spaces for 0 < p < 1. For any p ∈(0,∞)\{1} we use the notation p′ =
p
p−1.
Moreover, we set 1′ = ∞and ∞′ = 1, so that p′′ = p for all p ∈(0,∞]. H¨older’s
inequality says that for all p ∈[1,∞] and all measurable functions f,g on (X,μ) we
have
fg

L1 ≤
 f

Lp
g

Lp′ .
It is a well-known fact that the dual (Lp)∗of Lp is isometric to Lp′ for all 1 ≤p < ∞.
Furthermore, the Lp norm of a function can be obtained via duality when 1 ≤p ≤∞
as follows:
f

Lp =
sup
∥g∥Lp′ =1


X f gdμ
.
For the endpoint cases p = 1, p = ∞, see Exercise 1.4.12 (a), (b).
1.1.1 The Distribution Function
Deﬁnition 1.1.1. For f a measurable function on X, the distribution function of f is
the function df deﬁned on [0,∞) as follows:
df (α) = μ({x ∈X : | f(x)| > α}).
(1.1.5)
The distribution function df provides information about the size of f but not
about the behavior of f itself near any given point. For instance, a function on Rn and
each of its translates have the same distribution function. It follows from Deﬁnition
1.1.1 that df is a decreasing function of α (not necessarily strictly).

4
1 Lp Spaces and Interpolation
f (x)
a3
a2
a1
E3
E1
B1
B2
B3
E2
x
a1
a2
a3
0
0
α
α
f (  )
d
.
.
.
.
Fig. 1.1 The graph of a simple function f =∑3
k=1 akχEk and its distribution function df (α). Here
Bj =∑j
k=1 μ(Ek).
Example 1.1.2. For pedagogical reasons we compute the distribution function df of
a nonnegative simple function
f(x) =
N
∑
j=1
ajχE j(x),
where the sets Ej are pairwise disjoint and a1 > ··· > aN > 0. If α ≥a1, then clearly
df (α) = 0. However, if a2 ≤α < a1 then | f(x)| > α precisely when x ∈E1, and in
general, if aj+1 ≤α < aj, then | f(x)| > α precisely when x ∈E1 ∪···∪Ej. Setting
Bj =
j
∑
k=1
μ(Ek),
for j ∈{1,...,N}, B0 = aN+1 = 0, and a0 = ∞, we have
df (α) =
N
∑
j=0
Bjχ[a j+1,a j)(α).
Note that these formulas are valid even when μ(Ei) = ∞for some i. Figure 1.1
presents an illustration of this example when N = 3 and μ(Ej) < ∞for all j.
Proposition 1.1.3. Let f and g be measurable functions on (X,μ). Then for all
α,β > 0 we have
(1) |g| ≤| f| μ-a.e. implies that dg ≤df ;
(2) dc f (α) = df (α/|c|), for all c ∈C\{0};
(3) df+g(α +β) ≤df (α)+dg(β);
(4) dfg(αβ) ≤df (α)+dg(β).

1.1 Lp and Weak Lp
5
Proof. The simple proofs are left to the reader.
□
Knowledge of the distribution function df provides sufﬁcient information to eval-
uate the Lp norm of a function f precisely. We state and prove the following impor-
tant description of the Lp norm in terms of the distribution function.
Proposition 1.1.4. Let (X,μ) be a σ-ﬁnite measure space. Then for f in Lp(X,μ),
0 < p < ∞, we have
f
p
Lp = p
 ∞
0 α p−1df (α)dα .
(1.1.6)
Moreover, for any increasing continuously differentiable function ϕ on [0,∞) with
ϕ(0) = 0 and every measurable function f on X with ϕ(| f|) integrable on X, we
have

X ϕ(| f|)dμ =
 ∞
0 ϕ′(α)df (α)dα .
(1.1.7)
Proof. Indeed, we have
p
 ∞
0 α p−1df (α)dα = p
 ∞
0 α p−1

X χ{x: | f(x)|>α} dμ(x)dα
=

X
 | f(x)|
0
pα p−1 dα dμ(x)
=

X | f(x)|p dμ(x)
=
f
p
Lp ,
where in the second equality we used Fubini’s theorem, which requires the measure
space to be σ-ﬁnite. This proves (1.1.6). Identity (1.1.7) follows similarly, replacing
the function α p by the more general function ϕ(α) which has similar properties. □
Deﬁnition 1.1.5. For 0 < p < ∞, the space weak Lp(X,μ) is deﬁned as the set of
all μ-measurable functions f such that
f

Lp,∞= inf

C > 0 : df (α) ≤Cp
α p
for all
α > 0

(1.1.8)
= sup
	
γ df (γ)1/p : γ > 0

(1.1.9)
is ﬁnite. The space weak L∞(X,μ) is by deﬁnition L∞(X,μ).
One should check that (1.1.9) and (1.1.8) are in fact equal. The weak Lp spaces are
denoted by Lp,∞(X,μ). Two functions in Lp,∞(X,μ) are considered equal if they are
equal μ-a.e. The notation Lp,∞(Rn) is reserved for Lp,∞(Rn,|·|). Using Proposition
1.1.3 (2), we can easily show that
k f

Lp,∞= |k|
f

Lp,∞,
(1.1.10)

6
1 Lp Spaces and Interpolation
for any complex constant k. The analogue of (1.1.3) is
 f +g

Lp,∞≤cp
 f

Lp,∞+
g

Lp,∞

,
(1.1.11)
where cp = max(2,21/p), a fact that follows from Proposition 1.1.3 (3), taking both
α and β equal to α/2. We also have that
 f

Lp,∞(X,μ) = 0 ⇒f = 0
μ-a.e.
(1.1.12)
In view of (1.1.10), (1.1.11), and (1.1.12), Lp,∞is a quasi-normed linear space for
0 < p < ∞.
The weak Lp spaces are larger than the usual Lp spaces. We have the following:
Proposition 1.1.6. For any 0 < p < ∞and any f in Lp(X,μ) we have
 f

Lp,∞≤
 f

Lp .
Hence the embedding Lp(X,μ) ⫅Lp,∞(X,μ) holds.
Proof. This is just a trivial consequence of Chebyshev’s inequality:
α pdf (α) ≤

{x:| f(x)|>α} | f(x)|p dμ(x) ≤∥f∥p
Lp .
Using (1.1.9) we obtain that ∥f∥Lp,∞≤∥f∥Lp.
□
The inclusion Lp ⫅Lp,∞is strict. For example, on Rn with the usual Lebesgue
measure, let h(x) = |x|−n
p . Obviously, h is not in Lp(Rn) but h is in Lp,∞(Rn) with
∥h∥Lp,∞(Rn) = v1/p
n
, where vn is the measure of the unit ball of Rn.
It is not immediate from their deﬁnition that the weak Lp spaces are complete
with respect to the quasi-norm ∥·∥Lp,∞. The completeness of these spaces is proved
in Theorem 1.4.11, but it is also a consequence of Theorem 1.1.13, proved in this
section.
1.1.2 Convergence in Measure
Next we discuss some convergence notions. The following notion is important in
probability theory.
Deﬁnition 1.1.7. Let f, fn, n = 1,2,..., be measurable functions on the measure
space (X,μ). The sequence fn is said to converge in measure to f if for all ε > 0
there exists an n0 ∈Z+ such that
n > n0 =⇒μ({x ∈X : | fn(x)−f(x)| > ε}) < ε .
(1.1.13)

1.1 Lp and Weak Lp
7
Remark 1.1.8. The preceding deﬁnition is equivalent to the following statement:
For all ε > 0
lim
n→∞μ({x ∈X : | fn(x)−f(x)| > ε}) = 0.
(1.1.14)
Clearly (1.1.14) implies (1.1.13). To see the converse given ε > 0, pick 0 < δ < ε
and apply (1.1.13) for this δ. There exists an n0 ∈Z+ such that
μ({x ∈X : | fn(x)−f(x)| > δ}) < δ
holds for n > n0. Since
μ({x ∈X : | fn(x)−f(x)| > ε}) ≤μ({x ∈X : | fn(x)−f(x)| > δ}),
we conclude that
μ({x ∈X : | fn(x)−f(x)| > ε}) < δ
for all n > n0. Let n →∞to deduce that
limsup
n→∞
μ({x ∈X : | fn(x)−f(x)| > ε}) ≤δ .
(1.1.15)
Since (1.1.15) holds for all 0 < δ < ε, (1.1.14) follows by letting δ →0.
Convergence in measure is a weaker notion than convergence in either Lp or Lp,∞,
0 < p ≤∞, as the following proposition indicates:
Proposition 1.1.9. Let 0 < p ≤∞and fn, f be in Lp,∞(X,μ).
(1) If fn, f are in Lp and fn →f in Lp, then fn →f in Lp,∞.
(2) If fn →f in Lp,∞, then fn converges to f in measure.
Proof. Fix 0 < p < ∞. Proposition 1.1.6 gives that for all ε > 0 we have
μ({x ∈X : | fn(x)−f(x)| > ε}) ≤1
ε p

X | fn −f|p dμ .
This shows that convergence in Lp implies convergence in weak Lp. The case p = ∞
is tautological.
Given ε > 0 ﬁnd an n0 such that for n > n0, we have
fn −f

Lp,∞= sup
α>0
αμ({x ∈X : | fn(x)−f(x)| > α})
1
p < ε
1
p +1 .
Taking α = ε, we conclude that convergence in Lp,∞implies convergence in mea-
sure.
□
Example 1.1.10. Note that there is no general converse of statement (2) in the pre-
ceding proposition. Fix 0 < p < ∞and on [0,1] deﬁne the functions
fk, j = k1/pχ( j−1
k , j
k ),
k ≥1, 1 ≤j ≤k.

8
1 Lp Spaces and Interpolation
Consider the sequence {f1,1, f2,1, f2,2, f3,1, f3,2, f3,3,...}. Observe that
|{x : fk, j(x) > 0}| = 1/k.
Therefore, fk, j converges to 0 in measure. Likewise, observe that
fk, j

Lp,∞= sup
α>0
α|{x : fk, j(x) > α}|1/p ≥sup
k≥1
(k −1/k)1/p
k1/p
= 1,
which implies that fk, j does not converge to 0 in Lp,∞.
It turns out that every sequence convergent in Lp(X,μ) or in Lp,∞(X,μ) has a
subsequence that converges a.e. to the same limit.
Theorem 1.1.11. Let fn and f be complex-valued measurable functions on a mea-
sure space (X,μ) and suppose that fn converges to f in measure. Then some subse-
quence of fn converges to f μ-a.e.
Proof. For all k = 1,2,... choose inductively nk such that
μ({x ∈X : | fnk(x)−f(x)| > 2−k}) < 2−k
(1.1.16)
and such that n1 < n2 < ··· < nk < ···. Deﬁne the sets
Ak = {x ∈X : | fnk(x)−f(x)| > 2−k}.
Equation (1.1.16) implies that
μ
 ∞

k=m
Ak

≤
∞
∑
k=m
μ(Ak) ≤
∞
∑
k=m
2−k = 21−m
(1.1.17)
for all m = 1,2,3,.... It follows from (1.1.17) that
μ
 ∞

k=1
Ak

≤1 < ∞.
(1.1.18)
Using (1.1.17) and (1.1.18), we conclude that the sequence of the measures of the sets
{∞
k=m Ak}∞
m=1 converges as m →∞to
μ
 ∞

m=1
∞

k=m
Ak

= 0.
(1.1.19)
To ﬁnish the proof, observe that the null set in (1.1.19) contains the set of all x ∈X
for which fnk(x) does not converge to f(x).
□
In many situations we are given a sequence of functions and we would like to
extract a convergent subsequence. One way to achieve this is via the next theorem,
which is a useful variant of Theorem 1.1.11. We ﬁrst give a relevant deﬁnition.

1.1 Lp and Weak Lp
9
Deﬁnition 1.1.12. We say that a sequence of measurable functions {fn} on the mea-
sure space (X,μ) is Cauchy in measure if for every ε > 0, there exists an n0 ∈Z+
such that for n,m > n0 we have
μ({x ∈X : | fm(x)−fn(x)| > ε}) < ε.
Theorem 1.1.13. Let (X,μ) be a measure space and let {fn} be a complex-valued
sequence on X that is Cauchy in measure. Then some subsequence of fn converges
μ-a.e.
Proof. The proof is very similar to that of Theorem 1.1.11. For all k = 1,2,... choose
nk inductively such that
μ({x ∈X : | fnk(x)−fnk+1(x)| > 2−k}) < 2−k
(1.1.20)
and such that n1 < n2 < ··· < nk < nk+1 < ···. Deﬁne
Ak = {x ∈X : | fnk(x)−fnk+1(x)| > 2−k}.
As shown in the proof of Theorem 1.1.11, (1.1.20) implies that
μ
 ∞

m=1
∞

k=m
Ak

= 0.
(1.1.21)
For x /∈∞
k=m Ak and i ≥j ≥j0 ≥m (and j0 large enough) we have
| fni(x)−fn j(x)| ≤
i−1
∑
l= j
| fnl(x)−fnl+1(x)| ≤
i−1
∑
l= j
2−l ≤21−j ≤21−j0 .
This implies that the sequence {fni(x)}i is Cauchy for every x in the set (∞
k=m Ak)c
and therefore converges for all such x. We deﬁne a function
f(x) =
⎧
⎨
⎩
lim
j→∞fn j(x)
when x /∈∞
m=1
∞
k=m Ak ,
0
when x ∈∞
m=1
∞
k=m Ak .
Then fn j →f almost everywhere.
□
1.1.3 A First Glimpse at Interpolation
It is a useful fact that if a function f is in Lp(X,μ) and in Lq(X,μ), then it also lies
in Lr(X,μ) for all p < r < q. The usefulness of the spaces Lp,∞can be seen from the
following sharpening of this statement:

10
1 Lp Spaces and Interpolation
Proposition 1.1.14. Let 0 < p < q ≤∞and let f in Lp,∞(X,μ)∩Lq,∞(X,μ), where
X is a σ-ﬁnite measure space. Then f is in Lr(X,μ) for all p < r < q and
f

Lr ≤

r
r −p +
r
q−r
1
r f

1r −1q
1p −1q
Lp,∞
 f

1p −1r
1p −1q
Lq,∞,
(1.1.22)
with the interpretation that 1/∞= 0.
Proof. Let us take ﬁrst q < ∞. We know that
df (α) ≤min
f
p
Lp,∞
α p
,
f
q
Lq,∞
αq

.
(1.1.23)
Set
B =
 f
q
Lq,∞
 f
p
Lp,∞

1
q−p
.
(1.1.24)
We now estimate the Lr norm of f. By (1.1.23), (1.1.24), and Proposition 1.1.4 we
have
 f
r
Lr(X,μ) = r
 ∞
0 αr−1df (α)dα
≤r
 ∞
0 αr−1 min
f
p
Lp,∞
α p
,
f
q
Lq,∞
αq

dα
= r
 B
0 αr−1−pf
p
Lp,∞dα +r
 ∞
B αr−1−q f
q
Lq,∞dα
=
r
r −p
f
p
Lp,∞Br−p +
r
q−r
f
q
Lq,∞Br−q
=

r
r −p +
r
q−r
f
p
Lp,∞
 q−r
q−p f
q
Lq,∞
 r−p
q−p .
(1.1.25)
Observe that the integrals converge, since r −p > 0 and r −q < 0.
The case q = ∞is easier. Since df (α) = 0 for α > ∥f∥L∞we need to use only
the inequality df (α) ≤α−p∥f∥p
Lp,∞for α ≤∥f∥L∞in estimating the ﬁrst integral in
(1.1.25). We obtain
 f
r
Lr ≤
r
r −p
 f
p
Lp,∞
f
r−p
L∞,
which is nothing other than (1.1.22) when q = ∞. This completes the proof.
□
Note that (1.1.22) holds with constant 1 if Lp,∞and Lq,∞are replaced by Lp and
Lq, respectively. It is often convenient to work with functions that are only locally in
some Lp space. This leads to the following deﬁnition.
Deﬁnition 1.1.15. For 0 < p < ∞, the space Lp
loc(Rn,| · |) or simply Lp
loc(Rn) is the
set of all Lebesgue-measurable functions f on Rn that satisfy

K | f(x)|p dx < ∞
(1.1.26)

1.1 Lp and Weak Lp
11
for any compact subset K of Rn. Functions that satisfy (1.1.26) with p = 1 are called
locally integrable functions on Rn.
The union of all Lp(Rn) spaces for 1 ≤p ≤∞is contained in L1
loc(Rn). More
generally, for 0 < p < q < ∞we have the following:
Lq(Rn) ⫅Lq
loc(Rn) ⫅Lp
loc(Rn).
Functions in Lp(Rn) for 0 < p < 1 may not be locally integrable. For example,
take f(x) = |x|−n−αχ|x|≤1, which is in Lp(Rn) when α > 0 and p < n/(n+α), and
observe that f is not integrable over any open set in Rn containing the origin.
Exercises
1.1.1. Suppose f and fn are measurable functions on (X,μ). Prove that
(a) df is right continuous on [0,∞).
(b) If | f| ≤liminfn→∞| fn| μ-a.e., then df ≤liminfn→∞dfn.
(c) If | fn| ↑| f|, then dfn ↑df .

Hint: Part (a): Let tn be a decreasing sequence of positive numbers that tends to
zero. Show that df (α0 + tn) ↑df (α0) using a convergence theorem. Part (b): Let
E = {x ∈X : | f(x)| > α} and En = {x ∈X : | fn(x)| > α}. Use that μ
∞
n=m En

≤
liminf
n→∞μ(En) and E ⫅∞
m=1
∞
n=m En μ-a.e.

1.1.2. (H¨older’s inequality) Let 0 < p, p1,..., pk ≤∞, where k ≥2, and let f j be in
Lp j = Lp j(X,μ). Assume that
1
p = 1
p1
+···+ 1
pk
.
(a) Show that the product f1 ··· fk is in Lp and that
 f1 ··· fk

Lp ≤
f1

Lp1 ···
fk

Lpk .
(b) When no pj is inﬁnite, show that if equality holds in part (a), then it must be the
case that c1| f1|p1 = ··· = ck| fk|pk μ-a.e. for some cj ≥0.
(c) Let 0 < q < 1 and q′ =
q
q−1. For r < 0 and g > 0 almost everywhere, deﬁne
∥g∥Lr = ∥g−1∥−1
L|r|. Show that if g is strictly positive μ-a.e. and lies in Lq′ and f is
measurable such that fg belongs to L1, we have
 fg

L1 ≥
 f

Lq
g

Lq′ .
1.1.3. Let (X,μ) be a measure space.
(a) If f is in Lp0(X,μ) for some p0 < ∞, prove that
lim
p→∞
f

Lp =
 f

L∞.

12
1 Lp Spaces and Interpolation
(b) (Jensen’s inequality) Suppose that μ(X) = 1. Show that
f

Lp ≥exp

X log| f(x)|dμ(x)

for all 0 < p < ∞.
(c) If μ(X) = 1 and f is in some Lp0(X,μ) for some p0 > 0, then
lim
p→0
 f

Lp = exp

X log| f(x)|dμ(x)

with the interpretation e−∞= 0.

Hint: Part (a): If 0 < ∥f∥L∞< ∞, use that ∥f∥Lp ≤∥f∥(p−p0)/p
L∞
∥f∥p0/p
Lp0
to obtain
limsupp→∞∥f∥Lp ≤∥f∥L∞. Conversely, let Eγ = {x ∈X : | f(x)| > γ∥f∥L∞} for γ in
(0,1). Then μ(Eγ) > 0, ∥f∥Lp0(Eγ) > 0, and ∥f∥Lp ≥

γ∥f∥L∞(p−p0)/p∥f∥p0/p
Lp0(Eγ),
hence liminfp→∞∥f∥Lp ≥γ∥f∥L∞. If ∥f∥L∞= ∞, set Gn = {| f| > n} and use that
∥f∥Lp ≥∥f∥Lp(Gn) ≥nμ(Gn)
1
p to obtain liminfp→∞∥f∥Lp ≥n. Part (b) is a direct
consequence of Jensen’s inequality

X log|h|dμ ≤log

X |h|dμ

. Part (c): Fix a
sequence 0 < pn < p0 such that pn ↓0 and deﬁne
hn(x) = 1
p0
(| f(x)|p0 −1)−1
pn
(| f(x)|pn −1).
Use that 1
p(t p −1) ↓logt as p ↓0 for all t > 0. The Lebesgue monotone convergence
theorem yields

X hn dμ ↑

X hdμ, hence

X
1
pn (| f|pn −1)dμ ↓

X log| f|dμ, where
the latter could be −∞. Use
exp

X log| f|dμ

≤

X | f|pn dμ
 1
pn
≤exp

X
1
pn
(| f|pn −1)dμ

to complete the proof.

1.1.4. Let aj be a sequence of positive reals. Show that
(a)

∑∞
j=1 aj
θ ≤∑∞
j=1 aθ
j , for any 0 ≤θ ≤1.
(b) ∑∞
j=1 aθ
j ≤

∑∞
j=1 aj
θ, for any 1 ≤θ < ∞.
(c)

∑N
j=1 aj
θ ≤Nθ−1 ∑N
j=1 aθ
j , when 1 ≤θ < ∞.
(d) ∑N
j=1 aθ
j ≤N1−θ
∑N
j=1 aj
θ, when 0 ≤θ ≤1.
1.1.5. Let {f j}N
j=1 be a sequence of Lp(X,μ) functions.
(a) (Minkowski’s inequality) For 1 ≤p ≤∞show that

N
∑
j=1
f j

Lp ≤
N
∑
j=1
 f j

Lp .

1.1 Lp and Weak Lp
13
(b) (Reverse Minkowski inequality) For 0 < p < 1 and f j ≥0 prove that
N
∑
j=1
f j

Lp ≤

N
∑
j=1
f j

Lp .
(c) For 0 < p < 1 show that

N
∑
j=1
f j

Lp ≤N
1−p
p
N
∑
j=1
f j

Lp .
(d) The constant N
1−p
p
in part (c) is best possible.

Hint: Part (c): Use Exercise 1.1.4 (c). Part (d): Take {f j}N
j=1 to be characteristic
functions of disjoint sets with the same measure.

1.1.6. (a) (Minkowski’s integral inequality) Let (X,μ) and (T,ν) be two σ-ﬁnite
measure spaces and let 1 ≤p < ∞. Show that for every nonnegative measurable
function F on the product space (X,μ)×(T,ν) we have

T

X F(x,t)dμ(x)
p
dν(t)
 1
p
≤

X

T F(x,t)p dν(t)
 1
p
dμ(x),
(b) State and prove an analogous inequality when p = ∞.
(c) Prove that when 0 < p < 1, then the preceding inequality is reversed.
(d) (Y. Sawano) Consider the example X = T = [0,1], μ is counting measure, ν is
Lebesgue measure, F(x,t) = 1 when x = t and zero otherwise. What is the relevance
of this example with the inequalities in (a) and (b)?

Hint: Part (a) Split the power p as 1 + (p −1) and apply H¨older’s inequality with
exponents p and p′. Part (b) Let p →∞on subsets of X with ﬁnite measure.

1.1.7. Let f1,..., fN be in Lp,∞(X,μ).
(a) Prove that for 1 ≤p < ∞we have

N
∑
j=1
f j

Lp,∞≤N
N
∑
j=1
f j

Lp,∞.
(b) Show that for 0 < p < 1 we have

N
∑
j=1
f j

Lp,∞≤N
1
p
N
∑
j=1
f j

Lp,∞.

Hint: Use that μ({| f1 + ··· + fN| > α}) ≤∑N
j=1 μ({| f j| > α/N}) and Exercise
1.1.4 (a) and (c).

1.1.8. Let 0 < p < ∞. Prove that Lp(X,μ) is a complete quasi-normed space. This
means that every quasi-norm Cauchy sequence is quasi-norm convergent.

14
1 Lp Spaces and Interpolation

Hint: Let fn be a Cauchy sequence in Lp. Pass to a subsequence {ni}i such that
∥fni+1 −fni∥Lp ≤2−i. Then the series f = fn1 +∑∞
i=1( fni+1 −fni) converges in Lp.

1.1.9. Let (X,μ) be a measure space with μ(X) < ∞. Suppose that a sequence of
measurable functions fn on X converges to f μ-a.e. Prove that fn converges to f in
measure.

Hint: For ε > 0,
	
x ∈X : fn(x) →f(x)} ⫅
∞
m=1
∞
n=m
{x ∈X : | fn(x)−f(x)| < ε

.

1.1.10. Let f be a measurable function on (X,μ) such such df (α) < ∞for all α > 0.
Fix γ > 0 and deﬁne fγ = f χ| f|>γ and f γ = f −fγ = f χ| f|≤γ.
(a) Prove that
dfγ(α) =

df (α)
when
α > γ,
df (γ)
when
α ≤γ,
df γ(α) =

0
when
α ≥γ,
df (α)−df (γ)
when
α < γ.
(b) If f ∈Lp(X,μ) then
fγ
p
Lp = p
 ∞
γ α p−1df (α)dα +γ pdf (γ),
f γp
Lp = p
 γ
0 α p−1df (α)dα −γ pdf (γ),

γ<| f|≤δ | f|p dμ = p
 δ
γ df (α)α p−1 dα −δ pdf (δ)+γ pdf (γ).
(c) If f is in Lp,∞(X,μ) prove that f γ is in Lq(X,μ) for any q > p and fγ is in
Lq(X,μ) for any q < p. Thus Lp,∞⫅Lp0 +Lp1 when 0 < p0 < p < p1 ≤∞.
1.1.11. Let (X,μ) be a measure space and let E be a subset of X with μ(E) < ∞.
Assume that f is in Lp,∞(X,μ) for some 0 < p < ∞.
(a) Show that for 0 < q < p we have

E | f(x)|q dμ(x) ≤
p
p−qμ(E)1−q
p f
q
Lp,∞.
(b) Conclude that if μ(X) < ∞and 0 < q < p, then
Lp(X,μ) ⫅Lp,∞(X,μ) ⫅Lq(X,μ).

Hint: Part (a): Use μ

E ∩{| f| > α}

≤min

μ(E),α−pf
p
Lp,∞

.

1.1.12. (Normability of weak Lp for p > 1) Let (X,μ) be a σ-ﬁnite measure space
and let 0 < p < ∞. Pick 0 < r < p and deﬁne
⏐⏐⏐⏐⏐⏐f
⏐⏐⏐⏐⏐⏐
Lp,∞=
sup
0<μ(E)<∞
μ(E)−1
r + 1
p

E | f|rdμ
 1
r
,

1.1 Lp and Weak Lp
15
where the supremum is taken over all measurable subsets E of X of ﬁnite measure.
(a) Use Exercise 1.1.11 with q = r to conclude that
⏐⏐⏐⏐⏐⏐f
⏐⏐⏐⏐⏐⏐
Lp,∞≤

p
p−r
 1
r f

Lp,∞
for all f in Lp,∞(X,μ). (It is not needed that X be σ-ﬁnite here).
(b) Prove that for all f in Lp,∞(X,μ) we have
f

Lp,∞≤
⏐⏐⏐⏐⏐⏐f
⏐⏐⏐⏐⏐⏐
Lp,∞.
(Y. Oi) Notice that if X = {1,2}, μ({1}) = 1, μ({2}) = ∞, then X is not σ-ﬁnite,
and verify that for the function f = 1 the preceding inequality fails.
(c) Show that Lp,∞(X,μ) is metrizable for all 0 < p < ∞, i.e., there is a metric on the
space that generates the same topology as the quasi-norm. Also show that Lp,∞(X,μ)
is normable when p > 1, i.e., there is a norm on the space equivalent to ∥·∥Lp,∞.
(d) Use the characterization of the weak Lp quasi-norm obtained in parts (a) and (b)
to prove Fatou’s lemma for this space: For all measurable functions gn on X we have
liminf
n→∞|gn|

Lp,∞≤Cp liminf
n→∞
gn

Lp,∞
for some constant Cp that depends only on p ∈(0,∞).

Hint: Part (b): Write X = ∞
k=1 Xk with μ(Xk) < ∞and take E = {| f| > α}∩Xk.

1.1.13. Consider the N! functions on the line
fσ =
N
∑
j=1
N
σ( j)χ[ j−1
N , j
N ) ,
where σ is a permutation of the set {1,2,...,N}.
(a) Show that each fσ satisﬁes ∥fσ∥L1,∞= 1.
(b) Show that ∥∑σ∈SN fσ∥L1,∞= N!

1+ 1
2 +···+ 1
N

.
(c) Conclude that the space L1,∞(R) is not normable (this means that ∥·∥L1,∞is not
equivalent to a norm).
(d) Use a similar argument to prove that L1,∞(Rn) is not normable by considering
the functions
fσ(x1,...,xn) =
N
∑
j1=1
···
N
∑
jn=1
Nn
σ(τ( j1,..., jn))χ[ j1−1
N
, j1
N )(x1)···χ[ jn−1
N
, jn
N )(xn),
where σ is a permutation of the set {1,2,...,Nn} and τ is a ﬁxed injective map
from the set of all n-tuples of integers with coordinates 1 ≤j ≤N onto the set
{1,2,...,Nn}. One may take
τ( j1,..., jn) = j1 +N( j2 −1)+N2( j3 −1)+···+Nn−1( jn −1),
for instance.

16
1 Lp Spaces and Interpolation
1.1.14. Let (X,μ) be a measure space and let s > 0.
(a) Let f be a measurable function on X. Show that if 0 < p < q < ∞we have

| f|≤s | f|q dμ ≤
q
q−p sq−p f
p
Lp,∞.
(b) Let f j, 1 ≤j ≤m, be measurable functions on X and let 0 < p < ∞. Show that
 max
1≤j≤m| f j|

p
Lp,∞≤
m
∑
j=1
f j
p
Lp,∞.
(c) Conclude from part (b) that for 0 < p < 1 we have
f1 +···+ fm
p
Lp,∞≤2−p
1−p
m
∑
j=1
f j
p
Lp,∞.
The latter estimate is referred to as the p-normability of weak Lp.

Hint: Part (a): Use the distribution function. Part (c): First obtain the estimate
df1+···+ fm(α) ≤μ({| f1+···+ fm|>α,max| f j|≤α})+dmaxj | f j|(α)
for all α > 0 and then use part (b).

1.1.15. (H¨older’s inequality for weak spaces) Let f j be in Lp j,∞of a measure space
X where 0 < pj < ∞and 1 ≤j ≤k. Let
1
p = 1
p1
+···+ 1
pk
.
Prove that
f1 ··· fk

Lp,∞≤p−1
p
k
∏
j=1
p
1
p j
j
k
∏
j=1
f j

Lp j,∞.

Hint: Take ∥f j∥Lp j,∞= 1 for all j. Control df1···fk(α) by
μ({| f1|>α/s1})+···+ μ({| fk−1|>sk−2/sk−1})+ μ({| fk|>sk−1})
≤(s1/α)p1 +(s2/s1)p2 +···+(sk−1/sk−2)pk−1 +(1/sk−1)pk .
Set x1 = s1/α, x2 = s2/s1,...,xk = 1/sk−1. Minimize xp1
1 +···+xpk
k subject to the
constraint x1 ···xk = 1/α.

1.1.16. Let 0 < p0 < p < p1 ≤∞and let 1
p = 1−θ
p0 + θ
p1 for some θ ∈[0,1]. Prove
the following:
f

Lp ≤
 f
1−θ
Lp0
f
θ
Lp1 ,
f

Lp,∞≤
 f
1−θ
Lp0,∞
f
θ
Lp1,∞.

1.2 Convolution and Approximate Identities
17
1.1.17. ([231]) Follow the steps below to prove the isoperimetric inequality. For
n ≥2 and 1 ≤j ≤n deﬁne the projection maps π j : Rn →Rn−1 by setting for
x = (x1,...,xn),
π j(x) = (x1,...,xj−1,xj+1,...,xn),
with the obvious interpretations when j = 1 or j = n.
(a) For maps f j : Rn−1 →C prove that
Λ( f1,..., fn) =

Rn
n
∏
j=1
f j ◦π j
dx ≤
n
∏
j=1
f j

Ln−1(Rn−1) .
(b) Let Ω be a compact set with a rectiﬁable boundary in Rn where n ≥2. Show
that there is a constant cn independent of Ω such that
|Ω| ≤cn|∂Ω|
n
n−1 ,
where the expression |∂Ω| denotes the (n−1)-dimensional surface measure of the
boundary of Ω.

Hint: Part (a): Use induction starting with n = 2. For n ≥3 write
Λ( f1,..., fn) ≤

Rn−1 P(x1,...,xn−1)| fn(πn(x))|dx1 ···dxn−1
≤∥P∥
L
n−1
n−2 (Rn−1)
fn ◦πn

Ln−1(Rn−1) ,
where P(x1,...,xn−1) =

R | f1(π1(x))··· fn−1(πn−1(x))|dxn, and apply the induc-
tion hypothesis to the n−1 functions

R f j(π j(x))n−1 dxn

1
n−2
,
for j = 1,...,n−1, to obtain the required conclusion. Part (b): Specialize part (a) to
the case f j = χπ j[Ω] to obtain
|Ω| ≤|π1[Ω]|
1
n−1 ···|πn[Ω]|
1
n−1
and then use that |π j[Ω]| ≤1
2|∂Ω|.

1.2 Convolution and Approximate Identities
The notion of convolution can be deﬁned on measure spaces endowed with a group
structure. It turns out that the most natural environment to deﬁne convolution is the
context of topological groups. Although the focus of this book is harmonic analysis
on Euclidean spaces, we develop the notion of convolution on general groups. This
allows us to study this concept on Rn, Zn, and Tn, in a uniﬁed way. Moreover,

18
1 Lp Spaces and Interpolation
since the basic properties of convolutions and approximate identities do not require
commutativity of the group operation, we may assume that the underlying groups
are not necessarily abelian. Thus, the results in this section can be also applied to
nonabelian structures such as the Heisenberg group.
1.2.1 Examples of Topological Groups
A topological group G is a Hausdorff topological space that is also a group with law
(x,y) →xy
(1.2.1)
such that the maps (x,y) →xy and x →x−1 are continuous. The identity element of
the group is the unique element e with the property xe = ex = x for all x ∈G. We
adopt the standard notation
AB = {ab : a ∈A,b ∈B},
A−1 = {a−1 : a ∈A}
for subsets A and B of G. Note that (AB)−1 = B−1A−1. Every topological group
G has an open basis at e consisting of symmetric neighborhoods, i.e., open sets U
satisfying U = U−1. A topological group is called locally compact if there is an
open set U containing the identity element such that U is compact. Then every point
in the group has an open neighborhood with compact closure.
Let G be a locally compact group. It is known that G possesses a positive measure
λ on the Borel sets that is nonzero on all nonempty open sets, ﬁnite on compact sets,
and is left invariant, meaning that
λ(tA) = λ(A),
(1.2.2)
for all measurable sets A and all t ∈G. Such a measure λ is called a (left) Haar
measure on G. Similarly, G possesses a right Haar measure which is right invariant,
i.e., λ(At) = λ(A) for all measurable A ⫅G and all t ∈G. For the existence of Haar
measure we refer to [152, §15] or [213, §16.3]. Furthermore, Haar measure is unique
up to positive multiplicative constants. If G is abelian then any left Haar measure on
G is a constant multiple of any given right Haar measure on G. A locally compact
group which is a countable union of compact subsets is a σ-ﬁnite measure space
under left or right Haar measure. This is case for connected locally compact groups.
Example 1.2.1. The standard examples are provided by the spaces Rn and Zn with
the usual topology and the usual addition of n-tuples. Another example is the space
Tn = Rn/Zn deﬁned as follows:
Tn = [0,1)×···×[0,1)


 
n times

1.2 Convolution and Approximate Identities
19
with the usual topology and group law:
(x1,...,xn)+(y1,...,yn) = ((x1 +y1) mod1,...,(xn +yn) mod1).
Example 1.2.2. Let G = R∗= R\{0} with group law the usual multiplication. It is
easy to verify that the measure λ = dx/|x| is invariant under multiplicative transla-
tions, that is,
 ∞
−∞f(tx) dx
|x| =
 ∞
−∞f(x) dx
|x| ,
for all f in L1(G,μ) and all t ∈R∗. Therefore, dx/|x| is a Haar measure. [Taking
f = χA gives λ(tA) = λ(A).]
Example 1.2.3. Similarly, on the multiplicative group G = R+, a Haar measure is
dx/x.
Example 1.2.4. Counting measure is a Haar measure on the group Zn with the usual
addition as group operation.
Example 1.2.5. The Heisenberg group Hn is the set Cn×R with the group operation
(z1,...,zn,t)(w1,...,wn,s) =

z1 +w1,...,zn +wn,t +s+2Im
n
∑
j=1
z jwj

.
It can easily be seen that the identity element e of this group is 0 ∈Cn × R and
(z1,...,zn,t)−1 = (−z1,...,−zn,−t). Topologically the Heisenberg group is identi-
ﬁed with Cn ×R, and both left and right Haar measure on Hn is Lebesgue measure.
The norm
|(z1,...,zn,t)| =
 n
∑
j=1
|z j|22
+t2
 1
4
introduces balls Br(x) = {y ∈Hn : |y−1x| < r} on the Heisenberg group that are quite
different from Euclidean balls. For x close to the origin, the balls Br(x) are not far
from being Euclidean, but for x far away from e = 0 they look like slanted truncated
cylinders. The Heisenberg group can be naturally identiﬁed as the boundary of the
unit ball in Cn and plays an important role in quantum mechanics.
1.2.2 Convolution
Throughout the rest of this section, we ﬁx a locally compact group G and a left
invariant Haar measure λ on G. We assume that G is a countable union of compact
subsets, hence the pair (G,λ) forms a σ-ﬁnite measure space. The spaces Lp(G,λ)
and Lp,∞(G,λ) are simply denoted by Lp(G) and Lp,∞(G).

20
1 Lp Spaces and Interpolation
Left invariance of λ is equivalent to the fact that for all t ∈G and all nonnegative
measurable functions f on G we have

G f(tx)dλ(x) =

G f(x)dλ(x).
(1.2.3)
Equation (1.2.3) is a restatement of (1.2.2) if f is a characteristic function. Obviously
(1.2.3) also holds for f ∈L1(G) by linearity and approximation.
We are now ready to deﬁne the operation of convolution.
Deﬁnition 1.2.6. Let f, g be in L1(G). Deﬁne the convolution f ∗g by
( f ∗g)(x) =

G f(y)g(y−1x)dλ(y).
(1.2.4)
For instance, if G = Rn with the usual additive structure, then y−1 = −y and the
integral in (1.2.4) is written as
( f ∗g)(x) =

Rn f(y)g(x−y)dy.
Remark 1.2.7. The right-hand side of (1.2.4) is deﬁned a.e., since the following
double integral converges absolutely:

G

G | f(y)||g(y−1x)|dλ(y)dλ(x)
=

G

G | f(y)||g(y−1x)|dλ(x)dλ(y)
=

G | f(y)|

G |g(y−1x)|dλ(x)dλ(y)
=

G | f(y)|

G |g(x)|dλ(x)dλ(y)
by (1.2.2)
=
f

L1(G)
g

L1(G) < +∞.
The change of variables z = x−1y yields that (1.2.4) is in fact equal to
( f ∗g)(x) =

G f(xz)g(z−1)dλ(z),
(1.2.5)
where the substitution of dλ(y) by dλ(z) is justiﬁed by left invariance.
Example 1.2.8. On R let f(x) = 1 when −1 ≤x ≤1 and zero otherwise. We see
that ( f ∗f)(x) is equal to the length of the intersection of the intervals [−1,1] and
[x −1,x + 1]. It follows that ( f ∗f)(x) = 2 −|x| for |x| ≤2 and zero otherwise.
Observe that f ∗f is a smoother function than f. Similarly, we obtain that f ∗f ∗f
is a smoother function than f ∗f.
There is an analogous calculation when g is the characteristic function of the unit
disk B(0,1) in R2. A simple computation gives

1.2 Convolution and Approximate Identities
21
(g∗g)(x) =
B

0,1

∩B

x,1
 =
 +
!
1−1
4 |x|2
−
!
1−1
4 |x|2

2
"
1−t2 −|x|

dt
= 2arcsin
!
1−1
4|x|2

−|x|
!
1−1
4|x|2
when x = (x1,x2) in R2 satisﬁes |x| ≤2, while (g∗g)(x) = 0 if |x| ≥2.
A calculation similar to that in Remark 1.2.7 yields that
f ∗g

L1(G) ≤
f

L1(G)
g

L1(G) ,
(1.2.6)
that is, the convolution of two integrable functions is also an integrable function
with L1 norm less than or equal to the product of the L1 norms.
Proposition 1.2.9. For all f, g, h in L1(G), the following properties are valid:
(1) f ∗(g∗h) = ( f ∗g)∗h (associativity)
(2) f ∗(g+h) = f ∗g+ f ∗h and ( f +g)∗h = f ∗h+g∗h (distributivity)
Proof. The easy proofs are omitted.
□
Proposition 1.2.9 implies that L1(G) is a (not necessarily commutative) Banach
algebra under the convolution product.
1.2.3 Basic Convolution Inequalities
The most fundamental inequality involving convolutions is the following.
Theorem 1.2.10. (Minkowski’s inequality) Let 1 ≤p ≤∞. For f in Lp(G) and g in
L1(G) we have that g∗f exists λ-a.e. and satisﬁes
g∗f

Lp(G) ≤
g

L1(G)
f

Lp(G) .
(1.2.7)
Proof. Estimate (1.2.7) follows directly from Exercise 1.1.6. Here we give a direct
proof. We may assume that 1 < p < ∞, since the cases p = 1 and p = ∞are simple.
We ﬁrst show that the convolution |g|∗| f| exists λ-a.e. Indeed,
(|g|∗| f|)(x) =

G | f(y−1x)||g(y)|dλ(y).
(1.2.8)
Apply H¨older’s inequality in (1.2.8) with respect to the measure |g(y)|dλ(y) to the
functions y →f(y−1x) and 1 with exponents p and p′ = p/(p−1), respectively. We
obtain
(|g|∗| f|)(x) ≤

G | f(y−1x)|p|g(y)|dλ(y)
1
p 
G |g(y)|dλ(y)
1
p′
.
(1.2.9)

22
1 Lp Spaces and Interpolation
Taking Lp norms of both sides of (1.2.9) we deduce
|g|∗| f|

Lp ≤
g
p−1
L1

G

G | f(y−1x)|p|g(y)|dλ(y)dλ(x)
1
p
=
g
p−1
L1

G

G | f(y−1x)|p dλ(x)|g(y)|dλ(y)
1
p
=
g
p−1
L1

G

G | f(x)|p dλ(x)|g(y)|dλ(y)
1
p
by (1.2.3)
=
 f
p
Lp
g

L1
g
p−1
L1
1
p
=
 f

Lp
g

L1 < ∞,
where the second equality follows by Fubini’s theorem. This shows that |g| ∗| f| is
ﬁnite λ-a.e. and satisﬁes (1.2.7); then g ∗f exists λ-a.e. and also satisﬁes (1.2.7),
since |g∗f| ≤|g|∗| f|.
□
Remark 1.2.11. Theorem 1.2.10 may fail for nonabelian groups if g ∗f is replaced
by f ∗g in (1.2.7). Note, however, that if for all h ∈L1(G) we have
h

L1 =
#h

L1 ,
(1.2.10)
where #h(x) = h(x−1), then (1.2.7) holds when the quantity ∥g ∗f∥Lp(G) is replaced
by ∥f ∗g∥Lp(G). To see this, observe that if (1.2.10) holds, then we can use (1.2.5) to
conclude that if f in Lp(G) and g in L1(G), then
f ∗g

Lp(G) ≤
g

L1(G)
f

Lp(G) .
(1.2.11)
If the left Haar measure satisﬁes
λ(A) = λ(A−1)
(1.2.12)
for all measurable A ⫅G, then (1.2.10) holds and thus (1.2.11) is satisﬁed for all g in
L1(G) and f ∈Lp(G). This is, for instance, the case for the Heisenberg group Hn.
Minkowski’s inequality (1.2.11) is only a special case of Young’s inequality in
which the function g can be in any space Lr(G) for 1 ≤r ≤∞.
Theorem 1.2.12. (Young’s inequality) Let 1 ≤p,q,r ≤∞satisfy
1
q +1 = 1
p + 1
r .
(1.2.13)
Then for all f in Lp(G) and all g in Lr(G) satisfying
g

Lr(G) =
#g

Lr(G) we have
f ∗g exists λ-a.e. and satisﬁes
f ∗g

Lq(G) ≤
g

Lr(G)
f

Lp(G) .
(1.2.14)

1.2 Convolution and Approximate Identities
23
Proof. Young’s inequality is proved in a way similar to Minkowski’s inequality. We
do a suitable splitting of the product | f(y)||g(y−1x)| and apply H¨older’s inequality.
Observe that when r < ∞, the hypotheses on the indices imply that
1
r′ + 1
q + 1
p′ = 1,
p
q + p
r′ = 1,
r
q + r
p′ = 1.
Using H¨older’s inequality with exponents r′, q, and p′, we obtain
|(| f|∗|g|)(x)| ≤

G | f(y)||g(y−1x)|dλ(y)
=

G | f(y)|
p
r′ 
| f(y)|
p
q |g(y−1x)|
r
q 
|g(y−1x)|
r
p′ dλ(y)
≤
 f

p
r′
Lp

G | f(y)|p|g(y−1x)|r dλ(y)
1
q 
G |g(y−1x)|r dλ(y)
 1
p′
=
 f

p
r′
Lp

G | f(y)|p|g(y−1x)|r dλ(y)
1
q 
G |#g(x−1y)|r dλ(y)
 1
p′
=

G | f(y)|p|g(y−1x)|r dλ(y)
 1
q f

p
r′
Lp
#g

r
p′
Lr ,
where we used left invariance. Now take Lq norms (in x) and apply Fubini’s theorem
to deduce that
| f|∗|g|

Lq ≤
f

p
r′
Lp
#g

r
p′
Lr

G

G | f(y)|p|g(y−1x)|r dλ(x)dλ(y)
1
q
=
f

p
r′
Lp
#g

r
p′
Lr
 f

p
q
Lp
g

r
q
Lr
=
g

Lr
 f

Lp< ∞,
using the hypothesis on g. This implies that | f| ∗|g| is ﬁnite λ-a.e. and satisﬁes
(1.2.14); then f ∗g exists λ-a.e. and also satisﬁes (1.2.14).
Finally, note that if r = ∞, the assumptions on p and q imply that p = 1 and q = ∞,
in which case the required inequality trivially holds.
□
We now give a version of Theorem 1.2.12 for weak Lp spaces. Theorem 1.2.13 is
improved in Section 1.4.
Theorem 1.2.13. (Young’s inequality for weak type spaces) Let G be a locally com-
pact group with left Haar measure λ that satisﬁes (1.2.12). Let 1 ≤p < ∞and
1 < q,r < ∞satisfy
1
q +1 = 1
p + 1
r .
(1.2.15)
Then there exists a constant Cp,q,r > 0 such that for all f in Lp(G) and g in Lr,∞(G),
the convolution f ∗g exists λ-a.e. and satisﬁes
f ∗g

Lq,∞(G) ≤Cp,q,r
g

Lr,∞(G)
f

Lp(G) .
(1.2.16)

24
1 Lp Spaces and Interpolation
Proof. As in the proofs of Theorems 1.2.10 and 1.2.12, we ﬁrst obtain (1.2.16) for the
convolution of the absolute values of the functions. This implies that | f| ∗|g| < ∞
λ-a.e., and thus f ∗g exists λ-a.e. and satisﬁes | f ∗g| ≤| f|∗|g|. We may therefore
assume that f,g ≥0 λ-a.e. The proof is based on a suitable splitting of the function
g. Let M be a positive real number to be chosen later. Deﬁne g1 = gχ|g|≤M and
g2 = gχ|g|>M. In view of Exercise 1.1.10 (a) we have
dg1(α) =

0
if α ≥M,
dg(α)−dg(M)
if α < M,
(1.2.17)
dg2(α) =

dg(α)
if α > M,
dg(M)
if α ≤M.
(1.2.18)
Proposition 1.1.3 gives for all β > 0
df∗g(β) ≤df∗g1(β/2)+df∗g2(β/2),
(1.2.19)
and thus it sufﬁces to estimate the distribution functions of f ∗g1 and f ∗g2. Since
g1 is the “small” part of g, it is in Ls for any s > r. In fact, we have

G g1(x)s dλ(x) = s
 ∞
0 αs−1dg1(α)dα
= s
 M
0
αs−1(dg(α)−dg(M))dα
≤s
 M
0
αs−1−rg
r
Lr,∞dα −s
 M
0
αs−1dg(M)dα
=
s
s−rMs−rg
r
Lr,∞−Msdg(M),
(1.2.20)
when s < ∞.
Similarly, since g2 is the “large” part of g, it is in Lt for any t < r, and

G g2(x)t dλ(x) = t
 ∞
0 αt−1dg2(α)dα
= t
 M
0
αt−1dg(M)dα +t
 ∞
M αt−1dg(α)dα
≤Mtdg(M)+t
 ∞
M αt−1−rg
r
Lr,∞dα
≤Mt−rg
r
Lr,∞+
t
r −t Mt−rg
r
Lr,∞
=
r
r −t Mt−rg
r
Lr,∞.
(1.2.21)
Since 1/r = 1/p′ + 1/q, it follows that 1 < r < p′. Select t = 1 and s = p′.
H¨older’s inequality and (1.2.20) give when p′ < ∞
|( f ∗g1)(x)| ≤
 f

Lp
g1

Lp′ ≤
 f

Lp

p′
p′ −rMp′−rg
r
Lr,∞
 1
p′
(1.2.22)

1.2 Convolution and Approximate Identities
25
and
|( f ∗g1)(x)| ≤
 f

LpM
(1.2.23)
when p′ = ∞. If p′ < ∞choose an M such that the right-hand side of (1.2.22) is equal
to β/2. If p′ = ∞choose M such that the right-hand side of (1.2.23) is also equal to
β/2. That is, choose
M = (β p′2−p′rq−1∥f∥−p′
Lp ∥g∥−r
Lr,∞)1/(p′−r)
if p′ < ∞and M = β/(2∥f∥L1) if p′ = ∞. For these choices of M we have that
df∗g1(β/2) = 0.
Next by Theorem 1.2.10 and (1.2.21) with t = 1 we obtain
f ∗g2

Lp ≤
f

Lp
g2

L1 ≤
f

Lp
r
r −1M1−rg
r
Lr,∞.
(1.2.24)
For the value of M chosen, using (1.2.24) and Chebyshev’s inequality, we obtain
df∗g(β) ≤df∗g2(β/2)
≤(2
f ∗g2

Lpβ −1)p
≤(2r
 f

LpM1−rg
r
Lr,∞(r −1)−1β −1)p
= Cq
p,q,rβ −qf
q
Lp
g
q
Lr,∞,
(1.2.25)
which is the required inequality. This proof gives that the constant Cp,q,r blows up
like (r −1)−p/q as r →1.
□
Example 1.2.14. Theorem 1.2.13 may fail at some endpoints:
(1) r = 1 and 1 ≤p = q ≤∞. On R take g(x) = 1/|x| and f = χ[0,1]. Clearly, g is in
L1,∞and f in Lp for all 1 ≤p ≤∞, but the convolution of f and g is identically
equal to inﬁnity on the interval [0,1]. Therefore, (1.2.16) fails in this case.
(2) q = ∞and 1 < r = p′ < ∞. On R let f(x) = (|x|1/p log|x|)−1 for |x| ≥2 and zero
otherwise, and also let g(x) = |x|−1/r. We see that ( f ∗g)(x) = ∞for |x| ≤1.
Thus (1.2.16) fails in this case also.
(3) r = q = ∞and p = 1. Then inequality (1.2.16) trivially holds.
1.2.4 Approximate Identities
We now introduce the notion of approximate identities. The Banach algebra L1(G)
may not have a unit element, that is, an element f0 such that
f0 ∗f = f = f ∗f0
(1.2.26)

26
1 Lp Spaces and Interpolation
for all f ∈L1(G). In particular, this is the case when G = R; in fact, the only f0 that
satisﬁes (1.2.26) for all f ∈L1(R) is not a function but the Dirac delta distribution,
introduced in Chapter 2. It is reasonable therefore to introduce the notion of approx-
imate unit or identity, a family of functions kε with the property kε ∗f →f in L1 as
ε →0.
Deﬁnition 1.2.15. An approximate identity (as ε →0) is a family of L1(G) functions
kε with the following three properties:
(i)
There exists a constant c > 0 such that ∥kε∥L1(G) ≤c for all ε > 0.
(ii)

G kε(x)dλ(x) = 1 for all ε > 0.
(iii)
For any neighborhood V of the identity element e of the group G we have

V c |kε(x)|dλ(x) →0 as ε →0.
The construction of approximate identities on general locally compact groups G
is beyond the scope of this book and is omitted; see [152] for details. In this book we
are interested only in groups with Euclidean structure, where approximate identities
exist in abundance.
Sometimes we think of approximate identities as sequences {kn}n. In this case
property (iii) holds as n →∞. It is best to visualize approximate identities as se-
quences of positive functions kn that spike near 0 in such a way that the signed area
under the graph of each function remains constant (equal to one) but the support
shrinks to zero. See Figure 1.2.
Example 1.2.16. On R let P(x) = (π(x2 +1))−1 and Pε(x) = ε−1P(ε−1x) for ε > 0.
Since Pε and P have the same L1 norm and
 +∞
−∞
1
x2 +1 dx = lim
x→+∞

arctan(x)−arctan(−x)

= (π/2)−(−π/2) = π ,
property (ii) is satisﬁed. Property (iii) follows from the fact that
1
π

|x|≥δ
1
ε
1
(x/ε)2 +1 dx = 1−2
π arctan(δ/ε) →0
as ε →0,
for all δ > 0. The function Pε is called the Poisson kernel.
The Poisson kernel may be replaced by any integrable function of integral 1 as
the following example indicates.
Example 1.2.17. On Rn let k(x) be an integrable function with integral one. Let
kε(x) = ε−nk(ε−1x). It is straightforward to see that kε(x) is an approximate identity.
Property (iii) follows from the fact that

|x|≥δ/ε |k(x)|dx →0
as ε →0 for δ ﬁxed.

1.2 Convolution and Approximate Identities
27
-0.4
-0.2
0.2
0.4
1
2
3
4
5
6
Fig. 1.2 The Fej´er kernel F5 plotted on the interval [−1
2, 1
2].
Example 1.2.18. On the circle group T1 let
FN(t) =
N
∑
j=−N

1−
| j|
N +1

e2πi jt =
1
N +1
sin(π(N +1)t)
sin(πt)
2
.
(1.2.27)
To check the previous equality we use that
sin2(x) = (2−e2ix −e−2ix)/4,
and we carry out the calculation. FN is called the Fej´er kernel. See Figure 1.2. To
see that the sequence {FN}N is an approximate identity, we check conditions (i), (ii),
and (iii) in Deﬁnition 1.2.15. Property (iii) follows from the expression giving FN in
terms of sines, while property (i) follows from the expression giving FN in terms of
exponentials. Property (ii) is identical to property (i), since FN is nonnegative.
Next comes the basic theorem concerning approximate identities.
Theorem 1.2.19. Let kε be an approximate identity on a locally compact group G
with left Haar measure λ.
(1) If f lies in Lp(G) for 1 ≤p < ∞, then ∥kε ∗f −f∥Lp(G) →0 as ε →0.
(2) Let f be a function in L∞(G) that is uniformly continuous on a subset K of
G, in the sense that for all δ > 0 there is a neighborhood V of the identity
element such that for all x ∈K and y ∈V we have | f(y−1x)−f(x)| < δ. Then
we have that ∥kε ∗f −f∥L∞(K) →0 as ε →0. In particular, if f is bounded and
continuous at a point x0 ∈G, then (kε ∗f)(x0) →f(x0) as ε →0.
Proof. We start with the case 1 ≤p < ∞. We recall that continuous functions with
compact support are dense in Lp of locally compact Hausdorff spaces equipped
with measures arising from nonnegative linear functionals; see [152, Theorem
12.10]. For a continuous function g supported in a compact set L we have we have
|g(h−1x) −g(x)|p ≤(2∥g∥L∞)pχW −1L for h in a relatively compact neighborhood

28
1 Lp Spaces and Interpolation
W of the identity element e. By the Lebesgue dominated convergence theorem we
obtain

G |g(h−1x)−g(x)|p dλ(x) →0
(1.2.28)
as h →e. Now approximate a given f in Lp(G) by a continuous function with com-
pact support g to deduce that

G | f(h−1x)−f(x)|p dλ(x) →0
as
h →e.
(1.2.29)
Because of (1.2.29), given a δ > 0 there exists a neighborhood V of e such that
h ∈V =⇒

G | f(h−1x)−f(x)|p dλ(x) <
 δ
2c
p
,
(1.2.30)
where c is the constant that appears in Deﬁnition 1.2.15 (i). Since kε has integral one
for all ε > 0, we have
(kε ∗f)(x)−f(x) = (kε ∗f)(x)−f(x)

G kε(y)dλ(y)
=

G( f(y−1x)−f(x))kε(y)dλ(y)
=

V( f(y−1x)−f(x))kε(y)dλ(y)
+

V c( f(y−1x)−f(x))kε(y)dλ(y).
(1.2.31)
Now take Lp norms in x in (1.2.31). In view of (1.2.30),


V( f(y−1x)−f(x))kε(y)dλ(y)

Lp(G,dλ(x))
≤

V
f(y−1x)−f(x)

Lp(G,dλ(x))|kε(y)|dλ(y)
≤

V
δ
2c|kε(y)|dλ(y) < δ
2 ,
(1.2.32)
while


V c( f(y−1x)−f(x))kε(y)dλ(y)

Lp(G,dλ(x))
≤

V c 2
f

Lp(G)|kε(y)|dλ(y) < δ
2 ,
(1.2.33)
provided we have that

V c |kε(x)|dλ(x) <
δ
4
 f

Lp +1
 .
(1.2.34)

1.2 Convolution and Approximate Identities
29
Choose ε0 > 0 such that (1.2.34) is valid for ε < ε0 by property (iii). Now (1.2.32)
and (1.2.33) imply the required conclusion.
The case p = ∞follows similarly. Let f be a bounded function on G that is
uniformly continuous on K. Given δ > 0, there is a neighborhood V of e such that,
whenever y ∈V and x ∈K we have
| f(y−1x)−f(x)| < δ
2c ,
(1.2.35)
where c is as in Deﬁnition 1.2.15 (i). By property (iii) in Deﬁnition 1.2.15, there is
an ε0 > 0 such that for 0 < ε < ε0 we have

V c |kε(y)|dλ(y) <
δ
4

∥f∥L∞(G) +1
 .
(1.2.36)
Using (1.2.35) and (1.2.36), we deduce that
sup
x∈K
|(kε ∗f)(x)−f(x)|
≤

V |kε(y)|sup
x∈K
| f(y−1x)−f(x)|dλ(y)+

V c |kε(y)|sup
x∈K
| f(y−1x)−f(x)|dλ(y)
≤c δ
2c +
δ
4

∥f∥L∞(G) +1
 2∥f∥L∞(G) ≤δ.
This shows that kε ∗f converge uniformly to f on K as ε →0. In particular, if
K = {x0} and f is bounded and continuous at x0, we have (kε ∗f)(x0) →f(x0). □
Remark 1.2.20. Observe that if Haar measure satisﬁes (1.2.12), then the conclusion
of Theorem 1.2.19 also holds for f ∗kε.
A simple modiﬁcation in the proof of Theorem 1.2.19 yields the following vari-
ant, which presents a signiﬁcant difference only when a = 0.
Theorem 1.2.21. Let kε be a family of functions on a locally compact group G that
satisﬁes properties (i) and (iii) of Deﬁnition 1.2.15 and also

G kε(x)dλ(x) = a
for some ﬁxed a ∈C and for all ε > 0. Let f ∈Lp(G) for some 1 ≤p ≤∞.
(a) If 1 ≤p < ∞, then ∥kε ∗f −af∥Lp(G) →0 as ε →0.
(b) If p = ∞and f is uniformly continuous on a subset K of G, in the sense that
for any δ > 0 there is a neighborhood V of the identity element of G such that
supx∈G supy∈V | f(y−1x)−f(x)| ≤δ, then we have that ∥kε ∗f −af∥L∞(K) →0
as ε →0.

30
1 Lp Spaces and Interpolation
Exercises
1.2.1. Let G be a locally compact group and let f,g in L1(G) be supported in the
subsets A and B of G, respectively. Prove that f ∗g is supported in the algebraic
product set AB.
1.2.2. For a function f on a locally compact group G and t ∈G, let tf(x) = f(tx)
and f t(x) = f(xt). Show that
tf ∗g = t( f ∗g)
and
f ∗gt = ( f ∗g)t
whenever f,g ∈L1(G), equipped with left Haar measure.
1.2.3. Let G be a locally compact group with left Haar measure. Let f ∈Lp(G)
and ˜g ∈Lp′(G), where 1 < p < ∞; recall that #g(x) = g(x−1). For t,x ∈G, let
tg(x) = g(tx). Show that for any ε > 0 there exists a relatively compact symmet-
ric neighborhood of the origin U such that u ∈U implies ∥u#g −#g∥Lp′(G) < ε and
therefore
|( f ∗g)(v)−( f ∗g)(w)| <
f

Lp ε
whenever v−1w ∈U.
1.2.4. (a) Prove that compactly supported functions are dense in Lp(Rn) for all 0 <
p < ∞.
(b) Show that smooth functions with compact support are dense in Lp(Rn) for all
1 ≤p < ∞.

Hint: Part (b): Use Theorem 1.2.19 with kε(x) = ε−nk(ε−1x) and k smooth and
compactly supported function.

1.2.5. Show that a Haar measure λ for the multiplicative group of all positive real
numbers is
λ(A) =
 ∞
0 χA(t) dt
t .
1.2.6. Let G = R2 \{(0,y) : y ∈R} with group operation (x,y)(z,w) = (xz,xw+y).
[Think of G as the group of all 2 × 2 matrices with bottom row (0,1) and nonzero
top left entry.] Show that a left Haar measure on G is
λ(A) =
 +∞
−∞
 +∞
−∞χA(x,y) dxdy
x2
,
while a right Haar measure on G is
ρ(A) =
 +∞
−∞
 +∞
−∞χA(x,y) dxdy
|x| .

1.2 Convolution and Approximate Identities
31
1.2.7. ([144], [145]) Use Theorem 1.2.10 to prove that
 ∞
0
1
x
 x
0 | f(t)|dt
p
dx
1
p
≤
p
p−1
f

Lp(0,∞),
 ∞
0
 ∞
x | f(t)|dt
p
dx
1
p
≤p
 ∞
0 | f(t)|pt p dt
1
p
,
when 1 < p < ∞.

Hint: On the multiplicative group (R+, dt
t ) consider the convolution of the function
| f(x)|x
1
p with the function x−1
p′ χ[1,∞) and the convolution of the function | f(x)|x1+ 1
p
with x
1
p χ(0,1].

1.2.8. (G. H. Hardy) Let 0 < b < ∞and 1 ≤p < ∞. Prove that
 ∞
0
 x
0 | f(t)|dt
p
x−b−1 dx
1
p
≤p
b
 ∞
0 | f(t)|pt p−b−1 dt
1
p
,
 ∞
0
 ∞
x | f(t)|dt
p
xb−1 dx
1
p
≤p
b
 ∞
0 | f(t)|pt p+b−1 dt
1
p
.

Hint: On the multiplicative group (R+, dt
t ) consider the convolution of the function
| f(x)|x1−b
p with x−b
p χ[1,∞) and of the function | f(x)|x1+ b
p with x
b
p χ(0,1].

1.2.9. On Rn let T( f) = f ∗K, where K is a positive L1 function and f is in Lp,
1 ≤p ≤∞. Prove that the operator norm of T : Lp →Lp is equal to ∥K∥L1.

Hint: Clearly, ∥T∥Lp→Lp ≤∥K∥L1. Conversely, ﬁx 0 < ε < 1 and let N be a positive
integer. Let χN = χB(0,N) and for any R > 0 let KR = KχB(0,R), where B(x,R) is the
ball of radius R centered at x. Observe that for |x| ≤(1−ε)N, we have B(0,Nε) ⫅
B(x,N); thus

Rn χN(x−y)KNε(y)dy =

Rn KNε(y)dy =
KNε

L1. Then
K ∗χN
p
Lp
∥χN∥p
Lp
≥
KNε ∗χN
p
Lp(B(0,(1−ε)N)
χN
p
Lp
≥
KNε
p
L1(1−ε)n .
Let N →∞ﬁrst and then ε →0.

1.2.10. On the multiplicative group (R+, dt
t ) let T( f) = f ∗K, where K is a positive
L1 function and f is in Lp, 1 ≤p ≤∞. Prove that the operator norm of T : Lp →Lp
is equal to the L1 norm of K. Deduce that the constants p/(p−1) and p/b are sharp
in Exercises 1.2.7 and 1.2.8.

Hint: Adapt the idea of Exercise 1.2.9 to this setting.

1.2.11. Let Qk(t) = ck(1−t2)k for t ∈[−1,1] and zero elsewhere, where ck is cho-
sen such that
 1
−1 Qk(t)dt = 1 for all k = 1,2,....
(a) Show that ck <
√
k.

32
1 Lp Spaces and Interpolation
(b) Use part (a) to show that {Qk}k is an approximate identity on R as k →∞.
(c) Given a continuous function f on R that vanishes outside the interval [−1,1],
show that f ∗Qk converges to f uniformly on [−1,1] as k →∞.
(d) (Weierstrass) Prove that every continuous function on [−1,1] can be approxi-
mated uniformly by polynomials.

Hint: Part (a): Estimate the integral

|t|≤k−1/2 Qk(t)dt from below using the in-
equality (1 −t2)k ≥1 −kt2 for |t| ≤1. Part (d): Consider the function g(t) =
f(t)−f(−1)−t+1
2 ( f(1)−f(−1)).

1.2.12. Show that the Laplace transform L( f)(x) =
 ∞
0 f(t)e−xtdt maps L2(0,∞) to
itself with norm at most √π.

Hint: Consider convolution with the kernel √t e−t on the group L2((0,∞), dt
t ).

1.2.13. ([62]) Let F ≥0, G ≥0 be measurable functions on the sphere Sn−1 and let
K ≥0 be a measurable function on [−1,1]. Prove that

Sn−1

Sn−1 F(θ)G(ϕ)K(θ ·ϕ)dϕ dθ ≤C∥F∥Lp(Sn−1)∥G∥Lp′(Sn−1) ,
where 1 ≤p ≤∞, θ ·ϕ = ∑n
j=1 θ jϕj andC =

Sn−1 K(θ ·ϕ)dϕ, which is independent
of θ. Moreover, show that C is the best possible constant in the preceding inequality.
Using duality, compute the norm of the linear operator
F(θ) →

Sn−1 F(θ)K(θ ·ϕ)dϕ
from Lp(Sn−1) to itself.

Hint: Observe that

Sn−1

Sn−1 F(θ)G(ϕ)K(θ ·ϕ)dϕ dθ is bounded by the quantity
$
Sn−1

Sn−1 F(θ)K(θ ·ϕ)dθ
p
dϕ
% 1
p
∥G∥Lp′(Sn−1).
Apply H¨older’s inequality to the functions F and 1 with respect to the measure
K(θ ·ϕ)dθ to deduce that

Sn−1 F(θ)K(θ ·ϕ)dθ is controlled by

Sn−1 F(θ)pK(θ ·ϕ)dθ
1/p
Sn−1 K(θ ·ϕ)dθ
1/p′
.
Use Fubini’s theorem to bound the latter by
∥F∥Lp(Sn−1)∥G∥Lp′(Sn−1)

Sn−1 K(θ ·ϕ)dϕ.
Note that equality is attained if and only if both F and G are constants.


1.3 Interpolation
33
1.3 Interpolation
The theory of interpolation of operators is vast and extensive. In this section we
are mainly concerned with a couple of basic interpolation results that appear in a
variety of applications and constitute the foundation of the ﬁeld. These results are
the Marcinkiewicz interpolation theorem and the Riesz–Thorin interpolation theo-
rem. These theorems are traditionally proved using real and complex variables tech-
niques, respectively. A byproduct of the Riesz–Thorin interpolation theorem, Stein’s
theorem on interpolation of analytic families of operators, has also proved to be an
important and useful tool in many applications and is presented at the end of the
section.
We begin by setting up the background required to formulate the results of this
section. Let (X,μ) and (Y,ν) be two measure spaces. Suppose we are given a linear
operator T, initially deﬁned on the set of simple functions on X, such that for all f
simple on X, T( f) is a ν-measurable function on Y. Let 0 < p < ∞and 0 < q < ∞.
If there exists a constant Cp,q > 0 such that for all simple functions f on X we have
T( f)

Lq(Y,ν) ≤Cp,q
f

Lp(X,μ) ,
(1.3.1)
then by density, T admits a unique bounded extension from Lp(X,μ) to Lq(Y,ν).
This extension is also denoted by T. Operators that map Lp to Lq are called of strong
type (p,q) and operators that map Lp to Lq,∞are called weak type (p,q).
1.3.1 Real Method: The Marcinkiewicz Interpolation Theorem
Deﬁnition 1.3.1. Let T be an operator deﬁned on a linear space of complex-valued
measurable functions on a measure space (X,μ) and taking values in the set of all
complex-valued ﬁnite almost everywhere measurable functions on a measure space
(Y,ν). Then T is called linear if for all f, g in the domain of T and all λ ∈C we
have
T( f +g) = T( f)+T(g)
and
T(λ f) = λT( f).
(1.3.2)
T is called sublinear if for all f, g in the domain of T and all λ ∈C we have
|T( f +g)| ≤|T( f)|+|T(g)|
and
|T(λ f)| = |λ||T( f)|.
(1.3.3)
T is called quasi-linear if for all f, g in the domain of T and all λ ∈C we have
|T( f +g)| ≤K(|T( f)|+|T(g)|)
and
|T(λ f)| = |λ||T( f)|
(1.3.4)
for some constant K > 0. Sublinearity is a special case of quasi-linearity.
For instance, T1 and T2 are linear operators, then (|T1|p +|T2|p)1/p is sublinear if
p ≥1 and quasi-linear if 0 < p < 1.

34
1 Lp Spaces and Interpolation
Theorem 1.3.2. Let (X,μ) be a σ-ﬁnite measure space, let (Y,ν) be another mea-
sure space, and let 0 < p0 < p1 ≤∞. Let T be a sublinear operator deﬁned on
Lp0(X)+Lp1(X) = {f0 + f1 : f j ∈Lp j(Xj), j = 0,1} and taking values in the space
of measurable functions on Y. Assume that there exist A0,A1 < ∞such that
T( f)

Lp0,∞(Y) ≤A0
 f

Lp0(X)
for all f ∈Lp0(X),
(1.3.5)
T( f)

Lp1,∞(Y) ≤A1
 f

Lp1(X)
for all f ∈Lp1(X).
(1.3.6)
Then for all p0 < p < p1 and for all f in Lp(X) we have the estimate
T( f)

Lp(Y) ≤A
f

Lp(X) ,
(1.3.7)
where
A = 2

p
p−p0
+
p
p1 −p
1
p
A
1p −1p1
1p0 −1p1
0
A
1p0 −1p
1p0 −1p1
1
.
(1.3.8)
Proof. Assume ﬁrst that p1 < ∞. Fix f a function in Lp(X) and α > 0. We split
f = f α
0 + f α
1 , where f α
0 is in Lp0 and f α
1 is in Lp1. The splitting is obtained by
cutting | f| at height δα for some δ > 0 to be determined later. Set
f α
0 (x) =

f(x)
for
| f(x)| > δα,
0
for
| f(x)| ≤δα,
f α
1 (x) =

f(x)
for
| f(x)| ≤δα,
0
for
| f(x)| > δα.
It can be checked easily that f α
0 (the unbounded part of f) is an Lp0 function and
that f α
1 (the bounded part of f) is an Lp1 function. Indeed, since p0 < p, we have
f α
0
p0
Lp0 =

| f|>δα | f(x)|p| f(x)|p0−p dμ(x) ≤(δα)p0−pf
p
Lp
and similarly, since p < p1,
f α
1
p1
Lp1 ≤(δα)p1−pf
p
Lp.
In view of the subadditivity property of T contained in (1.3.3) we obtain that
|T( f)| ≤|T( f α
0 )|+|T( f α
1 )|,
which implies
{y ∈Y : |T( f)(y)| > α} ⫅{y ∈Y : |T( f α
0 )(y)| > α/2}∪{y ∈Y : |T( f α
1 )(y)| > α/2},
and therefore
dT( f)(α) ≤dT( f α
0 )(α/2)+dT( f α
1 )(α/2).
(1.3.9)

1.3 Interpolation
35
Hypotheses (1.3.5) and (1.3.6) together with (1.3.9) now give
dT( f)(α) ≤
Ap0
0
(α/2)p0

| f|>δα | f(x)|p0 dμ(x)+
Ap1
1
(α/2)p1

| f|≤δα | f(x)|p1 dμ(x).
In view of the last estimate and Proposition 1.1.4, we obtain that
T( f)
p
Lp ≤p(2A0)p0
 ∞
0 α p−1α−p0

| f|>δα | f(x)|p0 dμ(x)dα
+ p(2A1)p1
 ∞
0 α p−1α−p1

| f|≤δα | f(x)|p1 dμ(x)dα
= p(2A0)p0

X | f(x)|p0

1
δ | f(x)|
0
α p−1−p0 dα dμ(x)
+ p(2A1)p1

X | f(x)|p1
 ∞
1
δ | f(x)| α p−1−p1 dα dμ(x)
= p(2A0)p0
p−p0
1
δ p−p0

X | f(x)|p0| f(x)|p−p0 dμ(x)
+ p(2A1)p1
p1 −p
1
δ p−p1

X | f(x)|p1| f(x)|p−p1 dμ(x)
= p
(2A0)p0
p−p0
1
δ p−p0 + (2A1)p1
p1 −p δ p1−p
 f
p
Lp ,
and the convergence of the integrals in α is justiﬁed from p0 < p < p1, while the
interchange of the integrals (Fubini’s theorem) uses the hypothesis that (X,μ) is a
σ-ﬁnite measure space. We pick δ > 0 such that
(2A0)p0
1
δ p−p0 = (2A1)p1δ p1−p ,
and observe that the last displayed constant is equal to the pth power of the constant
in (1.3.8). We have therefore proved the theorem when p1 < ∞.
We now consider the case p1 = ∞. Write f = f α
0 + f α
1 , where
f α
0 (x) =

f(x)
for
| f(x)| > γα,
0
for
| f(x)| ≤γα,
f α
1 (x) =

f(x)
for
| f(x)| ≤γα,
0
for
| f(x)| > γα.
We have
T( f α
1 )

L∞≤A1
f α
1

L∞≤A1γα = α/2,

36
1 Lp Spaces and Interpolation
provided we choose γ = (2A1)−1. It follows that the set {y ∈Y : |T( f α
1 )(y)| > α/2}
has measure zero. Therefore,
dT( f)(α) ≤dT( f α
0 )(α/2).
Since T maps Lp0 to Lp0,∞with norm at most A0, it follows that
dT( f α
0 )(α/2) ≤(2A0)p0f α
0
p0
Lp0
α p0
= (2A0)p0
α p0

| f|>γα | f(x)|p0 dμ(x).
(1.3.10)
Using (1.3.10) and Proposition 1.1.4, we obtain
T( f)
p
Lp = p
 ∞
0 α p−1dT( f)(α)dα
≤p
 ∞
0 α p−1dT( f α
0 )(α/2)dα
≤p
 ∞
0 α p−1 (2A0)p0
α p0

| f|>α/(2A1) | f(x)|p0 dμ(x)dα
= p(2A0)p0

X | f(x)|p0
 2A1| f(x)|
0
α p−p0−1 dα dμ(x)
= p(2A1)p−p0(2A0)p0
p−p0

X | f(x)|p dμ(x).
This proves the theorem with constant
A = 2

p
p−p0
 1
p
A
1−p0
p
1
A
p0
p
0 .
(1.3.11)
Observe that when p1 = ∞, the constant in (1.3.11) coincides with that in (1.3.8). □
Remark 1.3.3. Notice that the proof of Theorem 1.3.2 only makes use of the subad-
ditivity property |T( f +g)| ≤|T( f)|+|T(g)| of T in hypothesis (1.3.3).
If T is a linear operator (instead of sublinear), then we can relax the hypotheses
of Theorem 1.3.2 by assuming that (1.3.5) and (1.3.6) hold for all simple functions
f on X. Then the functions f α
0 and f α
1 constructed in the proof are also simple, and
we conclude that (1.3.7) holds for all simple functions f on X. By density, T has a
unique extension on Lp(X) that also satisﬁes (1.3.7).
1.3.2 Complex Method: The Riesz–Thorin Interpolation Theorem
The next interpolation theorem assumes stronger endpoint estimates, but yields a
more natural bound on the norm of the operator on the intermediate spaces. Unfor-
tunately, it is mostly applicable for linear operators and in some cases for sublinear

1.3 Interpolation
37
operators (often via a linearization process) but it does not apply to quasi-linear
operators without some loss in the constant.
Recall that a simple function is called ﬁnitely simple if it is supported in a set
of ﬁnite measure. Finitely simple functions are dense in Lp(X,μ) for 0 < p < ∞,
whenever (X,μ) is a σ-ﬁnite measure space.
Theorem 1.3.4. Let (X,μ) and (Y,ν) be two σ-ﬁnite measure spaces. Let T be a
linear operator deﬁned on the set of all ﬁnitely simple functions on X and taking
values in the set of measurable functions on Y. Let 1 ≤p0, p1,q0,q1 ≤∞and assume
that
T( f)

Lq0 ≤M0
f

Lp0 ,
T( f)

Lq1 ≤M1
f

Lp1 ,
(1.3.12)
for all ﬁnitely simple functions f on X. Then for all 0 < θ < 1 we have
T( f)

Lq ≤M1−θ
0
Mθ
1
f

Lp
(1.3.13)
for all ﬁnitely simple functions f on X, where
1
p = 1−θ
p0
+ θ
p1
and
1
q = 1−θ
q0
+ θ
q1
.
(1.3.14)
Consequently, when p < ∞, by density, T has a unique bounded extension from
Lp(X,μ) to Lq(Y,ν) when p and q are as in (1.3.14).
Proof. Let
f =
m
∑
k=1
akeiαkχAk
be a ﬁnitely simple function on X, where ak > 0, αk are real, and Ak are pairwise
disjoint subsets of X with ﬁnite measure.
We need to control
T( f)

Lq(Y,ν) = sup
g


Y T( f)(y)g(y)dν(y)
,
where the supremum is taken over all ﬁnitely simple functions g on Y with Lq′ norm
less than or equal to 1. Write
g =
n
∑
j=1
bjeiβ jχB j ,
where bj > 0, β j are real, and Bj are pairwise disjoint subsets of Y with ﬁnite ν-
measure. Let
P(z) = p
p0
(1−z)+ p
p1
z
and
Q(z) = q′
q′
0
(1−z)+ q′
q′
1
z.
(1.3.15)

38
1 Lp Spaces and Interpolation
For z in the closed strip S = {z ∈C : 0 ≤Rez ≤1}, deﬁne
fz =
m
∑
k=1
aP(z)
k
eiαkχAk,
gz =
n
∑
j=1
bQ(z)
j
eiβ jχB j ,
(1.3.16)
and
F(z) =

Y T( fz)(y)gz(y)dν(y).
Notice that fθ = f and gθ = f. By linearity we have
F(z) =
m
∑
k=1
n
∑
j=1
aP(z)
k
bQ(z)
j
eiαkeiβ j

Y T(χAk)(y)χB j(y)dν(y).
Since ak,bj > 0, F is analytic in z, and the expression

Y T(χAk)(y)χB j(y)dν(y)
is a ﬁnite constant, being an absolutely convergent integral; this is seen by H¨older’s
inequality with exponents q0 and q′
0 (or q1 and q′
1) and (1.3.12).
By the disjointness of the sets Ak we have (even when p0 = ∞)
fit

Lp0 =
f

p
p0
Lp ,
since |aP(it)
k
| = a
p
p0
k , and by the disjointness of the Bj’s we have (even when q0 = 1)
git

Lq′
0 =
g

q′
q′
0
Lq′ ,
since |bQ(it)
j
| = b
q′
q′
0
j . Thus H¨older’s inequality and the hypothesis give
|F(it)| ≤
T( fit)

Lq0
git

Lq′
0
≤M0
 fit

Lp0
git

Lq′
0
= M0
 f

p
p0
Lp
g

q′
q′
0
Lq′ .
(1.3.17)
By similar calculations, which are valid even when p1 = ∞and q1 = 1, we have
f1+it

Lp1 =
 f

p
p1
Lp
and
g1+it

Lq′
1 =
g

q′
q′
1
Lq′ .

1.3 Interpolation
39
Also, in a way analogous to that we obtained (1.3.17) we deduce that
|F(1+it)| ≤M1
f

p
p1
Lp
g

q′
q′
1
Lq′ .
(1.3.18)
To ﬁnish the proof we will need the following lemma, known as Hadamard’s
three lines lemma.
Lemma 1.3.5. Let F be analytic in the open strip S = {z ∈C : 0 < Re z < 1},
continuous and bounded on its closure, such that |F(z)| ≤B0 when Re z = 0 and
|F(z)| ≤B1 when Re z = 1, for some 0 < B0,B1 < ∞. Then |F(z)| ≤B1−θ
0
Bθ
1 when
Re z = θ, for any 0 ≤θ ≤1.
To prove the lemma we deﬁne analytic functions
G(z) = F(z)(B1−z
0
Bz
1)−1
and
Gn(z) = G(z)e(z2−1)/n
for z in the unit strip S, for n = 1,2,.... Since F is bounded on S and
|B1−z
0
Bz
1| ≥min(1,B0)min(1,B1) > 0
for all z ∈S, we conclude that G is bounded by some constant M on S. Since
|Gn(x+iy)| ≤Me−y2/ne(x2−1)/n ≤Me−y2/n ,
we deduce that Gn(x + iy) converges to zero uniformly in 0 ≤x ≤1 as |y| →∞.
Select y(n) > 0 such that for |y| ≥y(n), we have |Gn(x + iy)| ≤1 for all x ∈[0,1].
Also, the assumptions on F imply that G is bounded by one on the two lines forming
the boundary of S. By the maximum principle we obtain that |Gn(z)| ≤1 for all z in
the rectangle [0,1]×[−y(n),y(n)]; hence |Gn(z)| ≤1 everywhere in the closed strip.
Letting n →∞, we conclude that |G(z)| ≤1 in the closed strip. Taking z = θ +it we
deduce that
|F(θ +it)| ≤|B1−θ−it
0
Bθ+it
1
| = B1−θ
0
Bθ
1
whenever t is real. This proves the required conclusion.
□
Returning to the proof of Theorem 1.3.4, we observe that F is analytic in the open
strip S and continuous on its closure. Also, F is bounded on the closed unit strip (by
some constant that depends on f and g). Therefore, (1.3.17), (1.3.18), and Lemma
1.3.5 give
|F(z)| ≤

M0
 f

p
p0
Lp
g

q′
q′
0
Lq′
1−θ
M1
f

p
p1
Lp
g

q′
q′
1
Lq′
θ
= M1−θ
0
Mθ
1
f

Lp
g

Lq′ ,
when Rez = θ. Observe that P(θ) = Q(θ) = 1 and hence
F(θ) =

Y T( f)gdν .

40
1 Lp Spaces and Interpolation
Taking the supremum over all ﬁnitely simple functions g on Y with Lq′ norm less
than or equal to one, we conclude the proof of the theorem.
□
We now give an application of Theorem 1.3.4.
Example 1.3.6. One may prove Young’s inequality (Theorem 1.2.12) using the
Riesz–Thorin interpolation theorem (Theorem 1.3.4). Fix a function g in Lr and
let T( f) = f ∗g. Since T : L1 →Lr with norm at most ∥g∥Lr and T : Lr′ →L∞with
norm at most ∥g∥Lr, Theorem 1.3.4 gives that T maps Lp to Lq with norm at most
the quantity ∥g∥θ
Lr∥g∥1−θ
Lr
= ∥g∥Lr, where
1
p = 1−θ
1
+ θ
r′
and
1
q = 1−θ
r
+ θ
∞.
(1.3.19)
Finally, observe that equations (1.3.19) give (1.2.13).
1.3.3 Interpolation of Analytic Families of Operators
Theorem 1.3.4 can be extended to the case in which the interpolated operators are
allowed to vary. In particular, if a family of operators depends analytically on a
parameter z, then the proof of this theorem can be adapted to work in this setting.
We describe the setup for this theorem. Let (X,μ) and (Y,ν) be σ-ﬁnite measure
spaces. Suppose that for every z in the closed strip S = {z ∈C : 0 ≤Rez ≤1} there
is an associated linear operator Tz deﬁned on the space of ﬁnitely simple functions
on X and taking values in the space of measurable functions on Y such that

Y |Tz(χA)χB|dν < ∞
(1.3.20)
whenever A and B are subsets of ﬁnite measure of X and Y, respectively. The family
{Tz}z is said to be analytic if for all f,g ﬁnitely simple functions we have that the
function
z →

Y Tz( f)gdν
(1.3.21)
is analytic in the open strip S = {z ∈C : 0 < Rez < 1} and continuous on its closure.
The analytic family {Tz}z is called of admissible growth if there is a constant τ0 with
0 ≤τ0 < π such that for ﬁnitely simple functions f on X and g on Y there is constant
C( f,g) such that
log


Y Tz( f)gdν
 ≤C( f,g)eτ0|Imz|
(1.3.22)
for all z satisfying 0 ≤Rez ≤1. Note that if there is τ0 ∈(0,π) such that for all
measurable subsets A of X and B of Y of ﬁnite measure there is a constant c(A,B)
such that
log


B Tz(χA)dν
 ≤c(A,B)eτ0|Imz| ,
(1.3.23)

1.3 Interpolation
41
then (1.3.22) holds for f = ∑M
k=1 akχAk and g = ∑N
j=1 bjχB j and
C( f,g) = log(MN)+
M
∑
k=1
N
∑
j=1

c(Ak,Bj)+
log|ak bj|

.
The extension of the Riesz–Thorin interpolation theorem is as follows.
Theorem 1.3.7. Let Tz be an analytic family of linear operators of admissible growth
deﬁned on the space of ﬁnitely simple functions of a σ-ﬁnite measure space (X,μ)
and taking values in the set of measurable functions of another σ-ﬁnite measure
space (Y,ν). Let 1 ≤p0, p1,q0,q1 ≤∞and suppose that M0 and M1 are positive
functions on the real line such that for some τ1 with 0 ≤τ1 < π we have
sup
−∞<y<+∞
e−τ1|y| logMj(y) < ∞
(1.3.24)
for j = 0,1. Fix 0 < θ < 1 and deﬁne p,q by the equations
1
p = 1−θ
p0
+ θ
p1
and
1
q = 1−θ
q0
+ θ
q1
.
(1.3.25)
Suppose that for all ﬁnitely simple functions f on X we have
Tiy( f)

Lq0 ≤M0(y)
f

Lp0 ,
(1.3.26)
T1+iy( f)

Lq1 ≤M1(y)
f

Lp1 .
(1.3.27)
Then for all ﬁnitely simple functions f on X we have
Tθ( f)

Lq ≤M(θ)
f

Lp
(1.3.28)
where for 0 < x < 1
M(x) = exp
$sin(πx)
2
 ∞
−∞

logM0(t)
cosh(πt)−cos(πx) +
logM1(t)
cosh(πt)+cos(πx)

dt
%
.
Thus, by density, Tθ has a unique bounded extension from Lp(X,μ) to Lq(Y,ν) when
p and q are as in (1.3.25).
Note that in view of (1.3.24), the integral deﬁning M(t) converges absolutely. The
proof of the previous theorem is based on an extension of Lemma 1.3.5.
Lemma 1.3.8. Let F be analytic on the open strip S = {z ∈C : 0 < Re z < 1} and
continuous on its closure such that for some A < ∞and 0 ≤τ0 < π we have
log|F(z)| ≤Aeτ0|Im z|
(1.3.29)

42
1 Lp Spaces and Interpolation
for all z ∈S. Then
|F(x+iy)| ≤exp
$sin(πx)
2
 ∞
−∞

log|F(it +iy)|
cosh(πt)−cos(πx) + log|F(1+it +iy)|
cosh(πt)+cos(πx)

dt
%
whenever 0 < x < 1, and y is real.
Assuming Lemma 1.3.8, we prove Theorem 1.3.7.
Proof. Fix 0 < θ < 1 and ﬁnitely simple functions f on X and g on Y such that
∥f∥Lp = ∥g∥Lq′ = 1. Note that since 0 < θ < 1 we must have 1 < p,q < ∞. Let
f =
m
∑
k=1
akeiαkχAk
and
g =
n
∑
j=1
bjeiβ jχB j ,
where ak > 0, bj > 0, αk, β j are real, Ak are pairwise disjoint subsets of X with ﬁnite
measure, and Bj are pairwise disjoint subsets of Y with ﬁnite measure for all k, j.
Let P(z), Q(z) be as in (1.3.15) and fz, gz as in (1.3.16). Deﬁne for z ∈S
F(z) =

Y Tz( fz)gz dν .
(1.3.30)
Linearity gives that
F(z) =
m
∑
k=1
n
∑
j=1
aP(z)
k
bQ(z)
j
eiαkeiβ j

Y Tz(χAk)(x)χB j(x)dν(x),
and conditions (1.3.20) together with the fact that {Tz}z is an analytic family imply
that F(z) is a well-deﬁned analytic function on the unit strip that extends continu-
ously to its boundary.
Since {Tz}z is a family of admissible growth, (1.3.23) holds for some c(Ak,Bj)
and τ0 ∈(0,π) and this combined with the facts that
|aP(z)
k
| ≤a
p
p0 + p
p1
k
and
|bQ(z)
j
| ≤b
q′
q′
0
+ q′
q′
1
j
for all z with 0 < Re z < 1, implies (1.3.29) with τ0 as in (1.3.23) and
A = log(mn)+
m
∑
k=1
n
∑
j=1

c(Ak,Bj)+
 p
p0
+ p
p1
log ak
+
 q′
q′
0
+ q′
q′
1
log bj


.
Thus F satisﬁes the hypotheses of Lemma 1.3.8. Moreover, the calculations in the
proof of Theorem 1.3.4 show that (even when p0 = ∞, q0 = 1, p1 = ∞, q1 = 1)
 fiy

Lp0 =
 f

p
p0
Lp = 1 =
g

q′
q′
0
Lq′ =
giy

Lq′
0
when y ∈R,
(1.3.31)
 f1+iy

Lp1 =
f

p
p1
Lp = 1 =
g

q′
q′
1
Lq′ =
g1+iy

Lq′
1
when y ∈R.
(1.3.32)

1.3 Interpolation
43
H¨older’s inequality, (1.3.31), and the hypothesis (1.3.26) now give
|F(iy)| ≤
Tiy( fiy)

Lq0
giy

Lq′
0 ≤M0(y)
fiy

Lp0
giy

Lq′
0 = M0(y)
for all y real. Similarly, (1.3.32), and (1.3.27) imply
|F(1+iy)| ≤
T1+iy( f1+iy)

Lq1
g1+iy

Lq′
1 ≤M1(y)
f1+iy

Lp1
g1+iy

Lq′
1 = M1(y)
for all y ∈R. These inequalities and the conclusion of Lemma 1.3.8 yield
|F(x)| ≤exp
$sin(πx)
2
 ∞
−∞

logM0(t)
cosh(πt)−cos(πx) +
logM1(t)
cosh(πt)+cos(πx)

dt
%
= M(x)
for all 0 < x < 1. But notice that
F(θ) =

Y Tθ( f)gdν .
(1.3.33)
Taking absolute values and the supremum over all ﬁnitely simple functions g on Y
with Lq′ norm equal to one, we conclude the proof of (1.3.28) for ﬁnitely simple
functions f with Lp norm one. Then (1.3.28) follows by replacing f by f/∥f∥Lp. □
We end this section with the proof of Lemma 1.3.8.
Proof of Lemma 1.3.8. Recall the Poisson integral formula
U(z) = 1
2π
 +π
−π U(Reiϕ)
R2 −ρ2
|Reiϕ −ρeiθ|2 dϕ ,
z = ρeiθ,
(1.3.34)
which is valid for a harmonic function U deﬁned on the unit disk D = {z : |z| < 1}
when |z| < R < 1. See [307, p. 258].
Consider now a subharmonic function u on D that is continuous on the circle
|ζ| = R < 1. When U = u, the right side of (1.3.34) deﬁnes a harmonic function on
the set {z ∈C : |z| < R} that coincides with u on the circle |ζ| = R. The maximum
principle for subharmonic functions ([307, p. 362]) implies that for |z| < R < 1 we
have
u(z) ≤1
2π
 +π
−π u(Reiϕ)
R2 −ρ2
|Reiϕ −ρeiθ|2 dϕ ,
z = ρeiθ.
(1.3.35)
This is valid for all subharmonic functions u on D that are continuous on the circle
|ζ| = R when ρ < R < 1.
It is not difﬁcult to verify that
h(ζ) = 1
πi log

i1+ζ
1−ζ

is a conformal map from D onto the strip S = (0,1) × R. Indeed, i(1 + ζ)/(1 −ζ)
lies in the upper half-plane and the preceding complex logarithm is a well deﬁned
holomorphic function that takes the upper half-plane onto the strip R×(0,π). Since

44
1 Lp Spaces and Interpolation
F ◦h is a holomorphic function on D, log|F ◦h| is a subharmonic function on D.
Applying (1.3.35) to the function z →log|F(h(z))|, we obtain
log|F(h(z))| ≤1
2π
 +π
−π log|F(h(Reiϕ))|
R2 −ρ2
R2 −2ρRcos(θ −ϕ)+ρ2 dϕ
(1.3.36)
when z = ρeiθ and |z| = ρ < R. Observe that when |ζ| = 1 and ζ ̸= ±1, h(ζ) has
real part zero or one. It follows from the hypothesis that
log|F(h(ζ))| ≤Aeτ0|Imh(ζ)| = Aeτ0
Im 1
πi log

i 1+ζ
1−ζ
 = Ae
τ0
π
log
 1+ζ
1−ζ

 .
Therefore, log|F(h(ζ))| is bounded by a multiple of |1+ζ|−τ0/π|1−ζ|−τ0/π, which
is integrable over the set |ζ| = 1, since τ0 < π. Fix now z = ρeiθ with ρ < R and let
R →1 in (1.3.36). The Lebesgue dominated convergence theorem gives that
log|F(h(ρeiθ))| ≤1
2π
 +π
−π log|F(h(eiϕ))|
1−ρ2
1−2ρ cos(θ −ϕ)+ρ2 dϕ .
(1.3.37)
Setting x = h(ρeiθ), we obtain that
ρeiθ = h−1(x) = eπix −i
eπix +i = −i
cos(πx)
1+sin(πx) =

cos(πx)
1+sin(πx)

e−i(π/2) ,
from which it follows that ρ = (cos(πx))/(1 + sin(πx)) and θ = −π/2 when 0 <
x ≤1
2, while ρ = −(cos(πx))/(1+sin(πx)) and θ = π/2 when 1
2 ≤x < 1. In either
case we easily deduce that
1−ρ2
1−2ρ cos(θ −ϕ)+ρ2 =
sin(πx)
1+cos(πx)sin(ϕ) .
Using this we write (1.3.37) as
log|F(x)| ≤1
2π
 π
−π
sin(πx)
1+cos(πx)sin(ϕ) log|F(h(eiϕ))|dϕ .
(1.3.38)
We now change variables. On the interval [−π,0) we use the change of variables
it = h(eiϕ) or, equivalently, eiϕ = −tanh(πt)−isech(πt). Observe that as ϕ ranges
from −π to 0, t ranges from +∞to −∞. Furthermore, dϕ = −π sech(πt)dt. We
have
1
2π
 0
−π
sin(πx)
1+cos(πx)sin(ϕ) log|F(h(eiϕ))|dϕ
= 1
2
 ∞
−∞
sin(πx)
cosh(πt)−cos(πx) log|F(it)|dt .
(1.3.39)

1.3 Interpolation
45
On the interval (0,π] we use the change of variables 1+it = h(eiϕ) or, equivalently,
eiϕ = −tanh(πt) + isech(πt). Observe that as ϕ ranges from 0 to π, t ranges from
−∞to +∞. Furthermore, dϕ = π sech(πt)dt. Similarly, we obtain
1
2π
 π
0
sin(πt)
1+cos(πt)sin(ϕ) log|F(h(eiϕ))|dϕ
= 1
2
 +∞
−∞
sin(πx)
cosh(πt)+cos(πx) log|F(1+it)|dt.
(1.3.40)
Adding (1.3.39) and (1.3.40) and using (1.3.38) we conclude the proof when y = 0.
We now consider the case where y ̸= 0. Fix y ̸= 0 and deﬁne the function G(z) =
F(z + iy). Then G is analytic on the open strip S = {z ∈C : 0 < Re z < 1} and
continuous on its closure. Moreover, for some A < ∞and 0 ≤τ0 < π we have
log|G(z)| = log|F(z+iy)| ≤Aeτ0|Im z+y| ≤Aeτ0|y| eτ0|Im z|
for all z ∈S. Then the case y = 0 for G (with A replaced by Aeτ0|y|) yields
|G(x)| ≤exp
$sin(πx)
2
 ∞
−∞

log|G(it)|
cosh(πt)−cos(πx) +
log|G(1+it)|
cosh(πt)+cos(πx)

dt
%
,
which yields the required conclusion for any real y, since G(x) = F(x+iy), G(it) =
F(it +iy), and G(1+it) = F(1+it +iy).
□
Exercises
1.3.1. Generalize Theorem 1.3.2 to the situation in which T is quasi-subadditive,
that is, it satisﬁes for some K > 0,
|T( f +g)| ≤K(|T( f)|+|T(g)|),
for all f, g in the domain of T. Prove that in this case, the constant A in (1.3.7) can
be taken to be K times the constant in (1.3.8).
1.3.2. Let (X,μ), (Y,ν) be two σ-ﬁnite measure spaces. Let 1 < p < r ≤∞and
suppose that T be a sublinear operator deﬁned on the space Lp0(X) + Lp1(X) and
taking values in the space of measurable functions on Y. Assume that T maps L1(X)
to L1,∞(Y) with norm A0 and Lr(X) to Lr(Y) with norm A1. Let 0 < p0 < p1 ≤∞.
Prove that T maps Lp to Lp with norm at most
8(p−1)−1
p A
1p −1r
1−1r
0
A
1−1p
1−1r
1
.

Hint: First interpolate between L1 and Lr using Theorem 1.3.2 and then interpolate
between L
p+1
2
and Lr using Theorem 1.3.4.


46
1 Lp Spaces and Interpolation
1.3.3. Let 0 < p0 < p < p1 ≤∞and let T be an operator as in Theorem 1.3.2 that
also satisﬁes
|T( f)| ≤T(| f|),
for all f ∈Lp0 +Lp1.
(a) If p0 = 1 and p1 = ∞, prove that T maps Lp to Lp with norm at most
p
p−1A
1
p
0 A
1−1
p
1
.
(b) More generally, if p0 < p < ∞, prove that the norm of T from Lp to Lp is at most
p1+ 1
p
B(p0 +1, p−p0)
pp0
0 (p−p0)p−p0
 1
p
A
p0
p
0 A
1−p0
p
1
,
where B(s,t) =
 1
0 xs−1(1−x)t−1 dx is the usual Beta function.
(c) When 0 < p0 < p1 < ∞, then the norm of T from Lp to Lp is at most
min
0<λ<1 p
1
p
B(p−p0, p0 +1)
(1−λ)p0
+
p1−p+1
p1−p
λ p1
 1
p
A
1p −1p1
1p0 −1p1
0
A
1p0 −1p
1p0 −1p1
1
.

Hint: The hypothesis |T( f)| ≤T(| f|) reduces matters to nonnegative functions.
Parts (a), (b): Given f ≥0 and α > 0 write f = f0 + f1, where f0 = f −λα/A1
when f ≥λα/A1 and zero otherwise. Here 0 < λ < 1 to be chosen later. Then we
have that |{|T( f)| > α}| ≤|{|T( f0)| > (1 −λ)α}|. Part (c): Write f = f0 + f1,
where f0 = f −δα when f ≥δα and zero otherwise. Use that
|{|T( f)| > α}| ≤|{|T( f0)| > (1−λ)α}|+|{|T( f1)| > λα}|
and optimize over δ > 0.

1.3.4. Let 0 ≤γ,δ < π. For every z ∈Sa,b = {z ∈C : a < Rez < b}, let Tz be a
family of linear operators deﬁned on ﬁnetely simple functions on a σ-ﬁnite measure
space (X,μ) and taking values in another σ-ﬁnite measure space (Y,ν). Assume that
{Tz}z is an analytic on of Sa,b, in the sense of (1.3.21), continuous on its closure, and
that for all simple functions f on X and g on Y there is a constant Cf,g < ∞such that
for all z ∈Sa,b,
log


Y Tz( f)gdν
 ≤Cf,g eγ|Imz|/(b−a) .
Let 1 ≤p0,q0, p1,q1 ≤∞. Suppose that Ta+iy maps Lp0(X) to Lq0(Y) with bound
M0(y) and Tb+iy maps Lp1(X) to Lq1(Y) with bound M1(y), where
sup
−∞<y<∞
e−δ|y|/(b−a) logMj(y) < ∞,
j = 0,1.

1.3 Interpolation
47
Then for a < t < b, Tt maps Lp(X) to Lq(Y), where
1
p =
b−t
b−a
p0
+
t−a
b−a
p1
and
1
q =
b−t
b−a
q0
+
t−a
b−a
q1
.
1.3.5. ([331]) On Rn let x = (x1,...,xn) and |x| = (x2
1 +···+x2
n)1/2. Let
Kλ(x) = π
n−1
2 Γ (λ +1)
Γ (λ + n+1
2 )
 +1
−1 e2πis|x|(1−s2)λ+ n−1
2 ds = Γ (λ +1)
πλ|x|λ+ n
2 Jλ+ n
2 (2π|x|),
where λ is a complex number and Jλ+ n
2 is the Bessel function of order λ + n
2. Let Tλ
be the operator given by convolution with Kλ. Show that Tλ maps Lp(Rn) to itself
for Reλ > (n−1)| 1
2 −1
p|.

Hint: In view of the calculation of the Fourier transform of Kλ contained in Ap-
pendix B.5, we have that when Reλ = 0, Tλ maps L2(Rn) to itself with norm 1. Us-
ing the estimates in Appendices B.6 and B.7, conclude that Kλ is integrable and thus
Tλ maps L1(Rn) to itself with an appropriate constant when Re λ = (n −1)/2 + δ
(for δ > 0). Then use Exercise 1.3.4.

1.3.6. Observe that Theorem 1.3.7 yields the stronger conclusion
Tz( f)

Lq ≤M(z)
f

Lp
for z ∈S = {z ∈C : 0 < Re z < 1}, where for z = x+iy
M(z) = exp
$sin(πx)
2
 ∞
−∞

logM0(t +y)
cosh(πt)−cos(πx) +
logM1(t +y)
cosh(πt)+cos(πx)

dt
%
.
1.3.7. ([380]) Let (X,μ) and (Y,ν) be two measure spaces with μ(X) < ∞and
ν(Y) < ∞. Let T be a countably subadditive operator that maps Lp(X) to Lp(Y)
for every 1 < p ≤2 with norm ∥T∥Lp→Lp ≤A(p −1)−α for some ﬁxed A,α > 0.
(Countably subadditive means that |T(∑j f j)| ≤∑j |T( f j)| for all f j in Lp(X) with
∑j f j ∈Lp.) Prove that for all f measurable on X we have

Y |T( f)|dν ≤6A(1+ν(Y))
1
2

X | f|(log+
2 | f|)α dμ +Cα + μ(X)
1
2

,
where Cα = ∑∞
k=1 kα(2/3)k. This result provides an example of extrapolation.

Hint: Write
f =
∞
∑
k=0
f χSk ,
where Sk = {2k ≤| f| < 2k+1} when k ≥1 and S0 = {| f| < 2}. Using H¨older’s
inequality and the hypotheses on T, obtain that

Y |T( f χSk)|dν ≤2Aν(Y)
1
k+1 2kkαμ(Sk)
k
k+1

48
1 Lp Spaces and Interpolation
for k ≥1. Note that for k ≥1 we have ν(Y)
1
k+1 ≤max(1,ν(Y))
1
2 and consider the
cases μ(Sk) ≥3−k−1 and μ(Sk) ≤3−k−1 when summing in k ≥1. The term with
k = 0 is easier.

1.3.8. Prove that for 0 < x < 1 we have
sin(πx)
2
 +∞
−∞
1
cosh(πt)+cos(πx) dt = x,
sin(πx)
2
 +∞
−∞
1
cosh(πt)−cos(πx) dt = 1−x,
and conclude that Lemma 1.3.8 reduces to Lemma 1.3.5 when the functions M0(y)
and M1(y) are constant and assumption (1.3.29) is replaced by the stronger assump-
tion that F is bounded on S.

Hint: In the ﬁrst integral write cosh(πt) = 1
2(eπt + e−πt). Then use the change of
variables s = eπt.

1.3.9. Let (X,μ), (Y,ν) be σ-ﬁnite measure spaces, and let 0 < p0 < p1 ≤∞. Let
T be a sublinear operator deﬁned on the space Lp0(X) + Lp1(X) and taking values
in the space of measurable functions on Y. Suppose T is a sublinear operator such
that maps Lp0 to L∞with constant A0 and Lp1 to L∞with constant A1. Prove T maps
Lp to L∞with constant 2A1−θ
0
Aθ
1 where
1−θ
p0
+ θ
p1
= 1
p .
1.4 Lorentz Spaces
Suppose that f is a measurable function on a measure space (X,μ). It would be de-
sirable to have another function f ∗deﬁned on [0,∞) that is decreasing and equidis-
tributed with f. By this we mean
df (α) = df ∗(α)
(1.4.1)
for all α ≥0. This is achieved via a simple construction discussed in this section.
1.4.1 Decreasing Rearrangements
Deﬁnition 1.4.1. Let f be a complex-valued function deﬁned on X. The decreasing
rearrangement of f is the function f ∗deﬁned on [0,∞) by
f ∗(t) = inf{s > 0 : df (s) ≤t} = inf{s ≥0 : df (s) ≤t}.
(1.4.2)

1.4 Lorentz Spaces
49
We adopt the convention inf /0 = ∞, thus having f ∗(t) = ∞whenever df (α) > t for
all α ≥0. Observe that f ∗is decreasing and supported in [0,μ(X)].
Before we proceed with properties of the function f ∗, we work out three
examples.
f (x)
a3
a2
a1
E3
E1
B2
B3
E2
x
a1
a2
a3
0
0
B1
t
f*(t)
.
.
.
.
Fig. 1.3 The graph of a simple function f(x) and its decreasing rearrangement f ∗(t).
Example 1.4.2. Consider the simple function of Example 1.1.2,
f(x) =
N
∑
j=1
ajχE j(x),
where Ej are pairwise disjoint sets of ﬁnite measure and a1 > ··· > aN > 0. We saw
in Example 1.1.2 that
df (α) =
N
∑
j=0
Bjχ[a j+1,a j)(α),
where
Bj =
j
∑
i=1
μ(Ei)
and aN+1 = B0 = 0 and a0 = ∞. Observe that for B0 ≤t < B1, the smallest s > 0
with df (s) ≤t is a1. Similarly, for B1 ≤t < B2, the smallest s > 0 with df (s) ≤t is
a2. Arguing this way, it is not difﬁcult to see that
f ∗(t) =
N
∑
j=1
ajχ[B j−1,B j)(t).
See Figure 1.3.
Example 1.4.3. On (Rn,dx) let
f(x) =
1
1+|x|p ,
0 < p < ∞.

50
1 Lp Spaces and Interpolation
A computation shows that
df (α) =

vn( 1
α −1)
n
p
if α < 1,
0
if α ≥1,
and therefore
f ∗(t) =
1
(t/vn)p/n +1 ,
where vn is the volume of the unit ball in Rn.
Example 1.4.4. Again on (Rn,dx) let g(x) = 1 −e−|x|2. We can easily see that
dg(α) = 0 if α ≥1 and dg(α) = ∞if α < 1. We conclude that g∗(t) = 1 for all
t ≥0. This example indicates that although quantitative information is preserved,
signiﬁcant qualitative information is lost in passing from a function to its decreasing
rearrangement.
It is clear from the previous examples that f ∗is continuous from the right and
decreasing. The following are some properties of the function f ∗.
Proposition 1.4.5. For f, g, fn μ-measurable, k ∈C, and 0 ≤t,s,t1,t2 < ∞we have
(1)
f ∗(df (α)) ≤α whenever α > 0.
(2)
df ( f ∗(t)) ≤t.
(3)
f ∗(t) > s if and only if t < df (s); that is, {t ≥0 : f ∗(t) > s} = [0,df (s)).
(4)
|g| ≤| f| μ-a.e. implies that g∗≤f ∗and | f|∗= f ∗.
(5)
(k f)∗= |k| f ∗.
(6)
( f +g)∗(t1 +t2) ≤f ∗(t1)+g∗(t2).
(7)
( fg)∗(t1 +t2) ≤f ∗(t1)g∗(t2).
(8)
| fn| ↑| f| μ-a.e. implies f ∗
n ↑f ∗.
(9)
| f| ≤liminf
n→∞| fn| μ-a.e. implies f ∗≤liminf
n→∞f ∗
n .
(10)
f ∗is right continuous on [0,∞).
(11)
If f ∗(t) < ∞, c > 0, and μ({| f| ≥f ∗(t)−c}) < ∞, then t ≤μ({| f| ≥f ∗(t)}).
(12)
df = df ∗.
(13)
(| f|p)∗= ( f ∗)p when 0 < p < ∞.
(14)

X | f|p dμ =
 ∞
0
f ∗(t)p dt when 0 < p < ∞.
(15)
 f

L∞= f ∗(0).
(16)
sup
t>0
tq f ∗(t) = sup
α>0
α

df (α)
q for 0 < q < ∞.

1.4 Lorentz Spaces
51
Proof. Property (1): The set A = {s > 0 : df (s) ≤df (α)} contains α and thus
f ∗(df (α)) = infA ≤α.
Property (2): Let sn ∈{s > 0 : df (s) ≤t} be such that sn ↓f ∗(t). Then df (sn) ≤t,
and the right continuity of df (Exercise 1.1.1 (a)) implies that df ( f ∗(t)) ≤t.
Property (3): If s < f ∗(t) = inf{u > 0 : df (u) ≤t}, then s /∈{u > 0 : df (u) ≤t}
which gives df (s) > t. Conversely, if for some t < df (s) we had f ∗(t) ≤s, applying
df and using property (2) would yield the contradiction df (s) ≤df ( f ∗(t)) ≤t.
Properties (4) and (5) are left to the reader.
Properties (6) and (7): Let A = {s1 > 0 : df (s1) ≤t1}, B = {s2 > 0 : dg(s2) ≤t2},
P = {s > 0 : dfg(s) ≤t1 +t2}, and S = {s > 0 : df+g(s) ≤t1 +t2}. Then A+B ⫅S
and A·B ⫅P; thus ( f +g)∗(t1+t2) = infS ≤s1+s2 and ( fg)∗(t1+t2) = infP ≤s1s2
are valid for all s1 ∈A and s2 ∈B. Taking the inﬁmum over all s1 ∈A and s2 ∈B
yields the conclusions.
Property (8): It follows from the deﬁnition of decreasing rearrangements that
f ∗
n ≤f ∗
n+1 ≤f ∗for all n. Let h = limn→∞f ∗
n ; then obviously h ≤f ∗. Since f ∗
n ≤h,
we have dfn(h(t)) ≤dfn( f ∗
n (t)) ≤t, which implies, in view of Exercise 1.1.1 (c), that
df (h(t)) ≤t by letting n →∞. It follows that f ∗≤h, hence h = f ∗.
Property (9): Set Fn = infm≥n | fm| and h = liminfn→∞| fn| = supn≥1 Fn. Since Fn ↑
h, property (8) yields that F∗
n ↑h∗as n →∞. By hypothesis we have | f| ≤h, hence
f ∗≤h∗= supn F∗
n . Since Fn ≤| fm| for m ≥n, it follows that F∗
n ≤f ∗
m for m ≥n; thus
F∗
n ≤infm≥n f ∗
m. Putting these facts together, we obtain f ∗≤h∗≤supn infm≥n f ∗
m =
liminfn→∞f ∗
n .
Property (10): If f ∗(t0) = 0, then f ∗(t) = 0 for all t > t0 and thus f ∗is right
continuous at t0. Suppose f ∗(t0) > 0. Pick α such that 0 < α < f ∗(t0) and let {tn}∞
n=1
be a sequence of real numbers decreasing to zero. The deﬁnition of f ∗yields that
df ( f ∗(t0) −α) > t0. Since tn ↓0, there is an n0 ∈Z+ such that df ( f ∗(t0) −α) >
t0 +tn for all n ≥n0. Property (3) yields that for all n ≥n0 we have f ∗(t0) −α <
f ∗(t0 +tn), and since the latter is at most f ∗(t0), the right continuity of f ∗follows.
Property (11): The deﬁnition of f ∗yields that the set An = {| f| > f ∗(t) −c/n}
has measure μ(An) > t. The sets An form a decreasing sequence as n increases and
μ(A1) < ∞by assumption. Consequently, {| f| ≥f ∗(t)} = ∞
n=1 An has measure
greater than or equal to t.
Property (12): This is immediate for nonnegative simple functions in view of
Examples 1.1.2 and 1.4.2. For an arbitrary measurable function f, ﬁnd a sequence of
nonnegative simple functions fn such that fn ↑| f| and apply (9).
Property (13): It follows from d| f|p(α) = df (α1/p) = df ∗(α1/p) = d( f ∗)p(α) for
all α > 0.
Property (14): This is a consequence of property (12) and of Proposition 1.1.4.
Property (15): This is a restatement of (1.1.2).
Property (16): Given α > 0, without loss of generality we may assume df (α) > 0.
Pick ε satisfying 0 < ε < df (α). Property (3) yields f ∗(df (α) −ε) > α, which
implies that
sup
t>0
tq f ∗(t) ≥(df (α)−ε)q f ∗(df (α)−ε) > (df (α)−ε)qα .

52
1 Lp Spaces and Interpolation
We ﬁrst let ε →0 and then take the supremum over all α > 0 to obtain one direction.
Conversely, given t > 0, assume without loss of generality that f ∗(t) > 0, and pick
ε such that 0 < ε < f ∗(t). Property (3) yields df ( f ∗(t) −ε) > t. This implies that
supα>0 α(df (α))q ≥( f ∗(t)−ε)(df ( f ∗(t)−ε))q > ( f ∗(t)−ε)tq. We ﬁrst let ε →0
and then take the supremum over all t > 0 to obtain the opposite direction of the
claimed equality.
□
1.4.2 Lorentz Spaces
Having disposed of the basic properties of decreasing rearrangements of functions,
we proceed with the deﬁnition of the Lorentz spaces.
Deﬁnition 1.4.6. Given f a measurable function on a measure space (X,μ) and
0 < p,q ≤∞, deﬁne
 f

Lp,q =
⎧
⎪
⎪
⎨
⎪
⎪
⎩
 ∞
0

t
1
p f ∗(t)
q dt
t
 1
q
if q < ∞,
sup
t>0
t
1
p f ∗(t)
if q = ∞.
The set of all f with ∥f∥Lp,q < ∞is denoted by Lp,q(X,μ) and is called the Lorentz
space with indices p and q.
As in Lp and in weak Lp, two functions in Lp,q(X,μ) are considered equal if they
are equal μ-almost everywhere. Observe that the previous deﬁnition implies that
L∞,∞= L∞, Lp,∞= weak Lp in view of Proposition 1.4.5 (16) and that Lp,p = Lp.
Remark 1.4.7. Observe that for all 0 < p,r < ∞and 0 < q ≤∞we have
|g|r
Lp,q =
g
r
Lpr,qr .
(1.4.3)
On Rn let δ ε( f)(x) = f(εx), ε > 0, be the dilation operator. It is straightforward
that dδ ε( f)(α) = ε−ndf (α) and (δ ε( f))∗(t) = f ∗(εnt). It follows that Lorentz norms
satisfy the following dilation identity:
δ ε( f)

Lp,q = ε−n/pf

Lp,q .
(1.4.4)
Next, we calculate the Lorentz norms of a ﬁnitely simple function.
Example 1.4.8. Using the notation of Example 1.4.2, when 0 < p,q < ∞we have
f

Lp,q =
 p
q
 1
q 
aq
1B
q
p
1 +aq
2

B
q
p
2 −B
q
p
1

+···+aq
N

B
q
p
N −B
q
p
N−1
 1
q
,

1.4 Lorentz Spaces
53
and also
f

Lp,∞= sup
1≤j≤N
ajB
1
p
j .
Next, we calculate ∥f∥L∞,q for the simple function f of Example 1.4.2. when
q < ∞. It turns out that
f

L∞,q =

aq
1 log
B1
B0

+aq
2 log
B2
B1

+···+aq
N log
 BN
BN−1
 1
q
= ∞,
since B0 = 0. We conclude that the only nonnegative simple function with ﬁnite L∞,q
norm is the zero function. Given a general nonzero function g ∈L∞,q with 0 < q < ∞,
there is a nonzero simple function s with 0 ≤s ≤g. Then s has inﬁnite norm, and
therefore so does g. We deduce that L∞,q(X) = {0} when 0 < q < ∞.
Proposition 1.4.9. For 0 < p < ∞and 0 < q ≤∞, we have the identity
f

Lp,q =
⎧
⎪
⎨
⎪
⎩
p
1
q
 ∞
0

df (s)
1
p s
q ds
s
 1
q
when q < ∞
sups>0 sdf (s)
1
p
when q = ∞.
(1.4.5)
Proof. The case q = ∞is statement (16) in Proposition 1.4.5, and we may therefore
concentrate on the case q < ∞. If f is the simple function of Example 1.1.2, then
df (s) =
N
∑
j=1
Bjχ[a j+1,a j)(s)
with the understanding that aN+1 = 0. Using the this formula and identity in Exam-
ple 1.4.8, we obtain the validity of (1.4.5) for simple functions. In general, given a
measurable function f, ﬁnd a sequence of nonnegative simple functions such that
fn ↑| f| a.e. Then dfn ↑df (Exercise 1.1.1 (c)) and f ∗
n ↑f ∗(Proposition 1.4.5 (8)).
Using the Lebesgue monotone convergence theorem we deduce (1.4.5).
□
Since Lp,p ⫅Lp,∞, one may wonder whether these spaces are nested. The next
result shows that for any ﬁxed p, the Lorentz spaces Lp,q increase as the exponent q
increases.
Proposition 1.4.10. Suppose 0 < p ≤∞and 0 < q < r ≤∞. Then there exists a
constant cp,q,r (which depends on p, q, and r) such that
f

Lp,r ≤cp,q,r
f

Lp,q .
(1.4.6)
In other words, Lp,q is a subspace of Lp,r.

54
1 Lp Spaces and Interpolation
Proof. We may assume p < ∞, since the case p = ∞is trivial. We have
t1/p f ∗(t) =
$ q
p
 t
0 [s1/p f ∗(t)]q ds
s
%1/q
≤
$ q
p
 t
0 [s1/p f ∗(s)]q ds
s
%1/q
since f ∗is decreasing,
≤
 q
p
1/q f

Lp,q .
Hence, taking the supremum over all t > 0, we obtain
f

Lp,∞≤
 q
p
1/q f

Lp,q .
(1.4.7)
This establishes (1.4.6) in the case r = ∞. Finally, when r < ∞, we have
 f

Lp,r =
$ ∞
0 [t1/p f ∗(t)]r−q+q dt
t
%1/r
≤
 f
(r−q)/r
Lp,∞
f
q/r
Lp,q .
(1.4.8)
Inequality (1.4.7) combined with (1.4.8) gives (1.4.6) with cp,q,r = (q/p)(r−q)/rq. □
Unfortunately, the functionals ∥· ∥Lp,q do not satisfy the triangle inequality. For
instance, consider the functions f(t) = t and g(t) = 1 −t deﬁned on [0,1]. Then
f ∗(α) = g∗(α) = (1 −α)χ[0,1](α). A simple calculation shows that the inequality
∥f +g∥Lp,q ≤∥f∥Lp,q +∥g∥Lp,q would be equivalent to
p
q ≤2q Γ (q+1)Γ (q/p)
Γ (q+1+q/p) ,
which fails in general. However, since for all t > 0 we have
( f +g)∗(t) ≤f ∗(t/2)+g∗(t/2),
the estimate
 f +g

Lp,q ≤cp,q
 f

Lp,q +
g

Lp,q

,
(1.4.9)
where cp,q = 21/p max(1,2(1−q)/q), is a consequence of (1.1.4). Also, if ∥f∥Lp,q = 0
then we must have f = 0 μ-a.e. Therefore, Lp,q is a quasi-normed space for all p,q
with 0 < p,q ≤∞. Is this space complete with respect to its quasi-norm? The next
theorem answers this question.
Theorem 1.4.11. Let (X,μ) be a measure space. Then for all 0 < p,q ≤∞, the
spaces Lp,q(X,μ) are complete with respect to their quasi-norm and they are there-
fore quasi-Banach spaces.

1.4 Lorentz Spaces
55
Proof. We consider only the case p < ∞. First we note that convergence in Lp,q
implies convergence in measure. When q = ∞, this is proved in Proposition 1.1.9.
When q < ∞, in view of Proposition 1.4.5 (16) and (1.4.7), it follows that
sup
t>0
t1/p f ∗(t) = sup
α>0
αdf (α)1/p ≤
 q
p
1/q f

Lp,q
for all f ∈Lp,q, and from this it follows that convergence in Lp,q implies convergence
in measure.
Now let {fn} be a Cauchy sequence in Lp,q. Then {fn} is Cauchy in measure,
and hence it has a subsequence {fnk} that converges almost everywhere to some f by
Theorem 1.1.13. Fix k0 and apply property (9) in Proposition 1.4.5. Since | f −fnk0| =
limk→∞| fnk −fnk0|, it follows that
( f −fnk0)∗(t) ≤liminf
k→∞( fnk −fnk0)∗(t).
(1.4.10)
Raise (1.4.10) to the power q, multiply by tq/p, integrate with respect to dt/t over
(0,∞), and apply Fatou’s lemma to obtain
 f −fnk0
q
Lp,q ≤liminf
k→∞
fnk −fnk0
q
Lp,q.
(1.4.11)
Now let k0 →∞in (1.4.11) and use the fact that {fn} is Cauchy to conclude that fnk
converges to f in Lp,q. It is a general fact that if a Cauchy sequence has a convergent
subsequence in a quasi-normed space, then the sequence is convergent to the same
limit. It follows that fn converges to f in Lp,q.
□
Remark 1.4.12. It can be shown that the spaces Lp,q are normable when p, q are
bigger than 1; see Exercise 1.4.3. Therefore, these spaces can be normed to become
Banach spaces.
It is well known that ﬁnitely simple functions are dense in Lp of any measure
space, when 0 < p < ∞. It is natural to ask whether ﬁnitely simple functions are also
dense in Lp,q. This is in fact the case when q ̸= ∞.
Theorem 1.4.13. Finitely simple functions are dense in Lp,q(X,μ) when 0 < q < ∞.
Proof. Let f ∈Lp,q(X,μ). Assume without loss of generality that f ≥0. Since f
lies in Lp,q ⫅Lp,∞we have μ({f > ε})1/pε ≤∥f∥Lp,q < ∞for every ε > 0 and
consequently for any A > 0, μ({f > A}) is ﬁnite and tends to zero as A →∞. Thus
for every n = 1,2,3,..., there is an An > 0 such that μ({f > An}) < 2−n.
For each n = 1,2,3,... deﬁne the function
ϕn(x) =
1+2nAn
∑
k=0
k
2n χ{k2−n< f≤(k+1)2−n}χ{2−n< f≤An} .

56
1 Lp Spaces and Interpolation
Then ϕn is supported in the set {2−n < f ≤An} which has ﬁnite μ measure, thus ϕn
is ﬁnitely simple and satisﬁes
f(x)−2−n ≤ϕn(x) ≤f(x)
for every x ∈{x ∈X : 2−n < f(x) ≤An}. It follows that
μ({x ∈X : | f(x)−ϕn(x)| > 2−n}) < 2−n
which implies that ( f −ϕn)∗(t) ≤2−n for t ≥2−n. Thus
( f −ϕn)∗(t) →0
as n →∞and
ϕ∗
n(t) ≤f ∗(t)
for all t > 0.
Since ( f −ϕn)∗(t) ≤f ∗(t), an application of the Lebesgue dominated convergence
theorem gives that ∥ϕn −f∥Lp,q →0 as n →∞.
□
Remark 1.4.14. One may wonder whether simple functions are dense in Lp,∞. This
turns out to be false for all 0 < p ≤∞. However, countable linear combinations of
characteristic functions of sets with ﬁnite measure are dense in Lp,∞(X,μ). We call
such functions countably simple. See Exercise 1.4.4 for details.
1.4.3 Duals of Lorentz Spaces
Given a quasi-Banach space Z with norm ∥· ∥Z, its dual Z∗is deﬁned as the space
of all continuous linear functionals T on Z equipped with the norm
T

Z∗= sup
∥x∥Z=1
|T(x)|.
Observe that the dual of a quasi-Banach space is always a Banach space.
We are now considering the following question: What are the dual spaces (Lp,q)∗
of Lp,q? The answer to this question presents some technical difﬁculties for general
measure spaces. In this exposition we restrict our attention to σ-ﬁnite nonatomic
measure spaces, where the situation is simpler.
Deﬁnition 1.4.15. A measurable subset A of a measure space (X,μ) is called an
atom if μ(A) > 0 and every measurable subset B of A has measure either equal to
zero or equal to μ(A). A measure space (X,μ) is called nonatomic if it contains no
atoms. In other words, X is nonatomic if and only if for any A ⫅X with μ(A) > 0,
there exists a proper subset B ⫋A with μ(B) > 0 and μ(A\B) > 0.
For instance, R with Lebesgue measure is nonatomic, but any measure space
with counting measure is atomic. Nonatomic spaces have the property that every
measurable subset of them with strictly positive measure contains subsets of any
given measure smaller than the measure of the original subset. See Exercise 1.4.5.

1.4 Lorentz Spaces
57
Theorem 1.4.16. Suppose that (X,μ) is a nonatomic σ-ﬁnite measure space. Then
(i)
(Lp,q)∗= {0},
when 0 < p < 1, 0 < q ≤∞,
(ii)
(Lp,q)∗= L∞,
when p = 1, 0 < q ≤1,
(iii)
(Lp,q)∗= {0},
when p = 1, 1 < q < ∞,
(iv)
(Lp,q)∗̸= {0},
when p = 1, q = ∞,
(v)
(Lp,q)∗= Lp′,∞,
when 1 < p < ∞, 0 < q ≤1,
(vi)
(Lp,q)∗= Lp′,q′,
when 1 < p < ∞, 1 < q < ∞,
(vii)
(Lp,q)∗̸= {0},
when 1 < p < ∞, q = ∞,
(viii)
(Lp,q)∗̸= {0},
when p = q = ∞.
Proof. Since X is σ-ﬁnite, we have X = ∞
N=1 KN, where KN is an increasing se-
quence of sets with μ(KN) < ∞. Let A be the σ-algebra on which μ is deﬁned
and deﬁne AN = {A ∩KN : A ∈A }. Given T ∈(Lp,q)∗, where 0 < p,q < ∞, for
each N = 1,2,..., consider the measure σN(E) = T(χE) deﬁned on AN. Since σN
satisﬁes |σN(E)| ≤(p/q)1/q∥T∥μ(E)1/p, it follows that σN is absolutely continu-
ous with respect to μ restricted on AN. By the Radon–Nikodym theorem (see [153]
(19.36)), there exists a unique (up to a set of μ-measure zero) complex-valued mea-
surable function gN which satisﬁes

KN |gN|dμ < ∞such that

KN
f dσN =

KN
gN f dμ
(1.4.12)
for all f in L1(KN,AN,σN). Since σN = σN+1 on AN, it follows that gN = gN+1
μ-a.e. on KN and hence there is a well-deﬁned measurable function g on X that co-
incides with each gN on KN. But the linear functionals f →T( f) and f →

KN f dσN
coincide on simple functions supported in KN and therefore they must be equal on
L1(KN,AN,σN)∩Lp,q(X,μ) by density; consequently, (1.4.12) is also equal to T( f)
for f in L1(KN,AN,σN)∩Lp,q(X,μ).
Note that if f ∈L∞(KN,μ), then f ∈Lp,q(KN,μ) and also in L∞(KN,σN), which is
contained in L1(KN,AN,σN). It follows from (1.4.12) and the preceding discussion
that
T( f) =

X g f dμ
(1.4.13)
for every f ∈L∞(KN). We have now proved that for every linear functional T on
Lp,q(X,μ) with 0 < p,q < ∞there is a function g satisfying

KN |g|dμ < ∞for all
N = 1,2,... such that (1.4.13) holds for all f ∈L∞(KN).
We now examine each case (i)–(viii) separately.
(i) We consider the case 0 < p < 1. Let f = ∑n anχEn be a ﬁnitely simple function
on X (which is taken to be countably simple when q = ∞). Since X is nonatomic,
we split each En as a union of m disjoint sets Ej,n, j = 1,2,...,m, each having
measure m−1μ(En). Let f j = ∑n anχE j,n. We see that ∥f j∥Lp,q = m−1/p∥f∥Lp,q. Now
if T ∈(Lp,q)∗, it follows that

58
1 Lp Spaces and Interpolation
|T( f)| ≤
m
∑
j=1
|T( f j)| ≤∥T∥
m
∑
j=1
f j

Lp,q = ∥T∥m1−1/p∥f∥Lp,q .
Let m →∞and use that p < 1 to obtain that T = 0.
(ii) We now consider the case p = 1 and 0 < q ≤1. Clearly, every h ∈L∞gives a
bounded linear functional on L1,q, since


X f hdμ
 ≤
h

L∞
f

L1 ≤Cq
h

L∞
 f

L1,q .
Conversely, suppose that T ∈(L1,q)∗where q ≤1. The function g given in (1.4.13)
satisﬁes


E gdμ
 =
T(χE)
 ≤
T
q−1/qμ(E)
for all E ⫅KN, and hence |g| ≤q−1/q∥T∥μ-a.e. on every KN; see [307, Theorem
1.40 on p. 31] for a proof of this fact. It follows that ∥g∥L∞≤q−1/q∥T∥and hence
(L1,q)∗= L∞.
(iii) Let us now take p = 1, 1 < q < ∞, and suppose that T ∈(L1,q)∗. Then


X fgdμ
 ≤∥T∥
f

L1,q,
(1.4.14)
where g is the function in (1.4.13) and f ∈L∞(KN). We will show that g = 0 a.e.
Suppose that |g| ≥δ on some set E0 with μ(E0) > 0. Then there exists N such that
μ(E0 ∩KN) > 0. Let f = g|g|−2χE0∩KNhχh≤M, where h is a nonnegative function.
Then (1.4.14) implies for all h ≥0 that
hχh≤M

L1(E0∩KN) ≤∥T∥
hχh≤M

L1,q(E0∩KN) .
Letting M →∞, we obtain that L1,q(E0 ∩KN) is contained in L1(E0 ∩KN), but
since the reverse inclusion is always valid, these spaces must be equal. Since X
is nonatomic, this can’t happen; see Exercise 1.4.8 (d). Thus g = 0 μ-a.e. and T = 0.
(iv) In the case p = 1, q = ∞an interesting phenomenon appears. Since every
continuous linear functional on L1,∞extends to a continuous linear functional on
L1,q for 1 < q < ∞, it must necessarily vanish on all simple functions by part (iii).
However, (L1,∞)∗contains nontrivial linear functionals; see [84], [85].
(v) We now take up the case 1 < p < ∞and 0 < q ≤1. Using Exercise 1.4.1 (b)
and Proposition 1.4.10, we see that if f ∈Lp,q and h ∈Lp′,∞, then

X | f h|dμ ≤
 ∞
0 t
1
p f ∗(t)t
1
p′ h∗(t) dt
t
≤
f

Lp,1∥h∥Lp′,∞
≤Cp,q
f

Lp,q∥h∥Lp′,∞;

1.4 Lorentz Spaces
59
thus every h ∈Lp′,∞gives rise to a bounded linear functional f →
 h f dμ on Lp,q
with norm at most Cp,q∥h∥Lp′,∞. Conversely, let T ∈(Lp,q)∗where 1 < p < ∞and
0 < q ≤1. Let g satisfy (1.4.13) for all f ∈L∞(KN). Taking f = g|g|−1χKN∩{|g|>α}
for α > 0 and using that


X fgdμ
 ≤∥T∥∥f∥Lp,q ,
we obtain that
αμ(KN ∩{|g| > α}) ≤(p/q)1/qT
μ(KN ∩{|g| > α})
1
p .
Divide by μ(KN ∩{|g| > α})
1
p , let N →∞, and take the supremum over α > 0 to
obtain that ∥g∥Lp′,∞≤(p/q)1/q∥T∥.
(vi) Using Exercise 1.4.1 (b) and H¨older’s inequality, we obtain


X f ϕ dμ
 ≤
 ∞
0 t
1
p f ∗(t)t
1
p′ ϕ∗(t) dt
t ≤
f

Lp,q
ϕ

Lp′,q′ ;
thus every ϕ ∈Lp′,q′ gives a bounded linear functional on Lp,q with norm at most
∥ϕ∥Lp′,q′. Conversely, let T be in (Lp,q)∗. By (1.4.13), T is given by integration
against a locally integrable function g. It remains to prove that g ∈Lp′,q′. We let
gN,M = gχKN χ|g|≤M. Then (gN,M)∗≤g∗for all M,N = 1,2,... and (gN,M)∗↑g∗as
M,N →∞by Proposition 1.4.5 (4), (8).
For a bounded function f in Lp,q(X) we have
 ∞
0
f ∗(t)(gN,M)∗(t)dt =
sup
h: dh=d f


X hgN,M dμ

=
sup
h: dh=d f


KN
hχ|g|≤M gdμ

=
sup
h: dh=d f
T(hχKN χ|g|≤M)

≤
sup
h: dh=d f
T
 hχKN χ|g|≤M

Lp,q
≤
sup
h: dh=d f
T
 h

Lp,q
=
T
 f

Lp,q ,
(1.4.15)
where the ﬁrst equality is a consequence of the fact that X is nonatomic (see Exercise
1.4.5 (d)). Using the result of Exercise 1.4.5 (b), pick a function f on X such that
f ∗(t) =
 ∞
t/2 s
q′
p′ −1(gN,M)∗(s)q′−1 ds
s ,
(1.4.16)

60
1 Lp Spaces and Interpolation
noting that the preceding integral converges since (gN,M)∗(s) ≤M χ[0,μ(KN)](s). It
follows that f ∗≤cp,q Mq′−1, which implies that f is bounded, and also that f ∗(t) = 0
when t > 2μ(KN), which implies that f is supported in a set of measure at most
2μ(KN); thus the function f deﬁned in (1.4.16) is bounded and lies in Lp,q(X).
We have the following calculation regarding the Lp,q norm of f:
f

Lp,q =
 ∞
0 t
q
p
 ∞
t/2 s
q′
p′ −1(gN,M)∗(s)q′−1 ds
s
q dt
t
 1
q
≤C1(p,q)
 ∞
0 (t
1
p′ (gN,M)∗(t))q′ dt
t
 1
q
= C1(p,q)
gN,M
q′/q
Lp′,q′ < ∞,
(1.4.17)
which is a consequence of Hardy’s second inequality in Exercise 1.2.8 with b = q/p.
Using (1.4.15) and (1.4.17) we deduce that
 ∞
0
f ∗(t)(gN,M)∗(t)dt ≤
T
  f

Lp,q ≤C1(p,q)
T
 gN,M
q′−1
Lp′,q′ .
(1.4.18)
On the other hand, we have
 ∞
0
f ∗(t)(gN,M)∗(t)dt ≥
 ∞
0
 t
t/2 s
q′
p′ −1(gN,M)∗(s)q′−1 ds
s (gN,M)∗(t)dt
≥
 ∞
0 (gN,M)∗(t)q′  t
t/2 s
q′
p′ −1 ds
s dt
= C2(p,q)
gN,M
q′
Lp′,q′.
(1.4.19)
Combining (1.4.18) and (1.4.19), and using the fact that ∥gN,M∥Lp′,q′ < ∞, we obtain
∥gN,M∥Lp′,q′ ≤C(p,q)∥T∥. Letting N,M →∞we deduce ∥g∥Lp′,q′ ≤C(p,q)∥T∥and
this proves the reverse inequality required to complete case (vi).
(vii) For a complete characterization of this space, we refer to [83].
(viii) The dual of L∞= L∞,∞can be identiﬁed with the set of all bounded ﬁnitely
additive set functions; see [99].
□
Remark 1.4.17. Some parts of Theorem 1.4.16 are false if X is atomic. For instance,
the dual of ℓp(Z) contains ℓ∞when 0 < p < 1 and thus it is not equal to {0}.
1.4.4 The Off-Diagonal Marcinkiewicz Interpolation Theorem
We now present the main result of this section, the off-diagonal extension of
Marcinkiewicz’s interpolation theorem (Theorem 1.3.2). For a measure space (X,μ),
let S(X) be the space of ﬁnitely simple functions on X and S+
0 (X) be the subset of
S(X) of functions of the form

1.4 Lorentz Spaces
61
n
∑
i=m
2−iχAi
where m < n are integers and Ai are subsets of X of ﬁnite measure. The sets Ai are
not required to be different nor disjoint; consequently, the sum of two elements in
S+
0 (X) also belong to S+
0 (X). We deﬁne Sreal
0
(X) = S+
0 (X)−S+
0 (X) be the space of
all functions of the form f1 −f2, where f1, f2 lie in S+
0 (X) and S0(X) be the space
of functions of the form h1 +ih2, where h1,h2 lie in Sreal
0
(X).
An operator T deﬁned on S0(X) is called quasi-linear if there is a K ≥1 such
that
|T(λ f)| = |λ||T( f)|
and
|T( f +g)| ≤K(|T( f)|+|T(g)|),
for all λ ∈C and all functions f, g in S0(X). If K = 1, then T is called sublinear.
Deﬁnition 1.4.18. Let T be a linear operator deﬁned on the space of ﬁnitely simple
functions S(X) on a measure space (X,μ) and let 0 < p,q ≤∞. We say that T is of
restricted weak type (p,q) if
T(χA)

Lq,∞≤C μ(A)1/p
(1.4.20)
for all measurable subsets A of X with ﬁnite measure. Estimates of the form (1.4.20)
are called restricted weak type estimates.
It is important to observe that if an operator is of restricted weak type (p0,q0) and
of restricted weak type (p1,q1), then it is of restricted weak type (p,q), where the
indices are as in (1.4.23). It will be a considerable effort to extend the latter estimate
to all functions in S0(X). The next theorem addresses this extension.
Theorem 1.4.19. Let 0 < r ≤∞, 0 < p0 ̸= p1 ≤∞, and 0 < q0 ̸= q1 ≤∞and let
(X,μ), (Y,ν) be σ-ﬁnite measure spaces. Let T be a quasi-linear operator deﬁned
on the space of simple functions on X and taking values in the set of measurable
functions on Y. Assume that for some M0,M1 < ∞the following restricted weak type
estimates hold:
T(χA)

Lq0,∞≤M0 μ(A)1/p0 ,
(1.4.21)
T(χA)

Lq1,∞≤M1 μ(A)1/p1 ,
(1.4.22)
for all measurable subsets A of X with μ(A) < ∞. Fix 0 < θ < 1 and let
1
p = 1−θ
p0
+ θ
p1
and
1
q = 1−θ
q0
+ θ
q1
.
(1.4.23)
Then there exists a constant C∗(p0,q0, p1,q1,K,r,θ) < ∞such that for all functions
f in S0(X) we have
T( f)

Lq,r ≤C∗(p0,q0, p1,q1,K,r,θ)M1−θ
0
Mθ
1
f

Lp,r.
(1.4.24)

62
1 Lp Spaces and Interpolation
Additionally, if 0 < p,r < ∞and if T is linear (or sublinear with nonnegative val-
ues), then it admits a unique bounded extension from Lp,r(X) to Lq,r(Y,ν) such that
(1.4.24) holds for all f in Lp,r.
Before we give the proof of Theorem 1.4.19, we state and prove a lemma that is
interesting on its own.
Lemma 1.4.20. Let 0 < p < ∞and 0 < q ≤∞and let (X,μ), (Y,ν) be σ-ﬁnite
measure spaces. Let T be a quasi-linear operator deﬁned on S(X) and taking values
in the set of measurable functions on Y. Suppose that there exists a constant M > 0
such that for all measurable subsets A of X of ﬁnite measure we have
T(χA)

Lq,∞≤M μ(A)
1
p .
(1.4.25)
Then for all α with 0 < α < min(q, log2
log2K ) there exists a constant C(p,q,K,α) > 0
such that for all functions f in S0(X) we have the estimate
T( f)

Lq,∞≤C(p,q,K,α)M
f

Lp,α
(1.4.26)
where
C(p,q,K,α) = 28+ 2
p + 2
q K3

q
q−α
 2
α
(1−2−α)−1
α (log2)−1
α .
Proof. A function f in S0(X) can be written as f = h1 −h2 + i(h3 −h4), where
hj are in S+
0 (X). We write f = f1 −f2 + i( f3 −f4), where f1 = max(h1 −h2,0),
f2 = max(−(h1 −h2),0), f3 = max(h3 −h4,0), and f4 = max(−(h3 −h4),0). We
note that f j lie in S+
0 (X); indeed, if h1 = ∑ℓ2−ℓχAℓand h2 = ∑k 2−kχBk, where both
sums are ﬁnite, then
f1 =
∑
ℓ: Aℓ∩(∪kBk)=/0
2−ℓχAℓ+
∑
(ℓ,k): ℓ<k, Aℓ∩Bk̸=/0
(2−ℓ−2−k)χAℓ∩Bk .
Since the second sum is equal to ∑k
s=ℓ+1 2−sχAℓ∩Bk, we obtain that h1 ∈S+
0 (X).
Likewise we can show that f2, f3, f4 lie in S+
0 (X). Moreover, we have f j ≤| f| and
Proposition 1.4.5(4), yields
∥f j∥Lp,α(X) ≤∥f∥Lp,α(X)
for all j = 1,2,3,4. Suppose now that (1.4.26) holds for functions in S+
0 (X) with
constant C′(p,q,α) in place of C(p,q,K,α). By the quasi-linearity of T we have

1.4 Lorentz Spaces
63
∥T( f)∥Lq,∞(Y) ≤K3

4
∑
j=1
|T( f j)|

Lq,∞(Y)
≤K341+ 1
q
4
∑
j=1
∥T( f j)∥Lq,∞(Y)
≤K342+ 2
q MC′(p,q,K,α)∥f∥Lp,α(X)
which proves (1.4.26) for all f in S0(X) with constant
C(p,q,K,α) = 24+ 2
q K3C′(p,q,α).
We now prove (1.4.26) for functions in S+
0 (X) with constant C′(p,q,α) in place
of C(p,q,K,α). It follows from the Aoki–Rolewicz theorem (Exercise 1.4.6) that for
all N ∈Z+ and for all f1,..., fN in S+
0 (X) we have the pointwise inequality
|T( f1 +···+ fN)| ≤4
 N
∑
j=1
|T( f j)|α1
 1
α1 ≤4
 N
∑
j=1
|T( f j)|α
 1
α
,
(1.4.27)
where 0 < α ≤α1 and α1 satisﬁes the equation (2K)α1 = 2. The second inequality
in (1.4.27) is a simple consequence of the fact that α ≤α1. Fix α0 with
0 < α0 ≤α1 = log2
log2K
and
α0 < q.
This ensures that the quasi-normed space Lq/α,∞is normable when α ≤α0. In fact,
since Y is σ-ﬁnite, Exercise 1.1.12 gives that the space Ls,∞is normable as long as
s > 1 and there is an equivalent norm ||| f|||Ls,∞such that
 f

Ls,∞≤
⏐⏐⏐⏐⏐⏐f
⏐⏐⏐⏐⏐⏐
Ls,∞≤
s
s−1
f

Ls,∞.
Next we claim that for any nonnegative function f in S+
0 (X) we have
T( f χA)

Lq,∞≤4

q
q−α
 1
α (1−2−α)−1
α M μ(A)
1
p f χA

L∞.
(1.4.28)
To show this, we write f = ∑n
j=m 2−jχS j, where m < n are integers, Sj are subsets of
X of ﬁnite measure for all j ∈{m,m+1,...,n}, μ(Sm) ̸= 0 and μ(Sn) ̸= 0. Setting
Bj = Sj ∩A we have
f χA =
n
∑
j=m
2−jχB j
and 2−m ≤∥f χA∥L∞(X).

64
1 Lp Spaces and Interpolation
We use (1.4.27) once and (1.4.3) twice in the following argument. We have
T( f χA)

Lq,∞≤4


n
∑
j=m
2−jα|T(χB j)|α 1
α 
Lq,∞
= 4

n
∑
j=m
2−jα|T(χB j)|α
1
α
Lq/α,∞
≤4
⏐⏐⏐
⏐⏐⏐
⏐⏐⏐
n
∑
j=m
2−jα|T(χB j)|α⏐⏐⏐
⏐⏐⏐
⏐⏐⏐
1
α
Lq/α,∞
≤4

n
∑
j=m
2−jα⏐⏐⏐
⏐⏐⏐
⏐⏐⏐|T(χB j)|α⏐⏐⏐
⏐⏐⏐
⏐⏐⏐
Lq/α,∞
 1
α
≤4

q
q−α
 1
α

n
∑
j=m
2−jα|T(χB j)|α
Lq/α,∞
 1
α
= 4

q
q−α
 1
α

n
∑
j=m
2−jαT(χB j)
α
Lq,∞
 1
α
≤4

q
q−α
 1
α M

n
∑
j=m
2−jαμ(Bj)
α
p
 1
α
≤4

q
q−α
 1
α (1−2−α)−1
α M μ(A)
1
p 2−m,
using Bj ⫅A. Using that 2−m ≤∥f χA∥L∞establishes (1.4.28).
We now apply (1.4.28) to obtain (1.4.26). For any f ∈S+
0 (X) we deﬁne measur-
able sets
Ak = {x ∈X : f ∗(2k+1) < | f(x)| ≤f ∗(2k)}
(1.4.29)
and we note that these sets are pairwise disjoint. We may write the ﬁnitely simple
function f as ∑n
j=1 ajχE j, where 0 < aj < ∞, E1 ⫅E2 ⫅··· ⫅En and 0 < μ(Ej) < ∞
for j ∈{1,2,...,n}. Clearly, we have
f ∗=
n
∑
j=1
ajχ[0,μ(E j)).
Thus, when t ∈(μ(En),∞), f ∗(t) vanishes, and when t ∈(0,μ(E1)), f ∗(t) = ∑n
j=1 aj
is a positive constant. So there exists N ∈Z+ such that f ∗(2k) = 0 when k > N, and
that f ∗(2k) is a positive constant when k < −N. This also implies that Ak = /0 if
|k| > N and thus we express
f =
N
∑
k=−N
f χAk.

1.4 Lorentz Spaces
65
Proposition 1.4.5(2) implies μ(Ak) ≤df ( f ∗(2k+1)) ≤2k+1. Using (1.4.27) we obtain
T( f)

Lq,∞(Y) ≤4


N
∑
k=−N
|T( f χAk)|α 1
α 
Lq,∞(Y)
= 4

N
∑
k=−N
|T( f χAk)|α
1
α
Lq/α,∞(Y)
≤4
⏐⏐⏐
⏐⏐⏐
⏐⏐⏐
N
∑
k=−N
|T( f χAk)|α⏐⏐⏐
⏐⏐⏐
⏐⏐⏐
1
α
Lq/α,∞(Y)
≤4

N
∑
k=−N
⏐⏐⏐
⏐⏐⏐
⏐⏐⏐|T( f χAk)|α⏐⏐⏐
⏐⏐⏐
⏐⏐⏐
Lq/α,∞(Y)
 1
α
≤4

q
q−α
 1
α

N
∑
k=−N
|T( f χAk)|α
Lq/α,∞(Y)
 1
α
≤4

q
q−α
 1
α
'
N
∑
k=−N
∥T( f χAk)∥α
Lq,∞(Y)
( 1
α
≤16

q
q−α
 2
α
(1−2−α)−1
α M
'
N
∑
k=−N
μ(Ak)
α
p f χAk
α
L∞
( 1
α
≤16

q
q−α
 2
α
(1−2−α)−1
α 2
1
p M
'
∞
∑
k=−∞
[ f ∗(2k)]α2
kα
p
( 1
α
≤16

q
q−α
 2
α
(1−2−α)−1
α 2
2
p (log2)−1
α M∥f∥Lp,α(X),
where we made use of (1.4.28) and in the last inequality, we used
∥f∥α
Lp,α(X) =
∞
∑
k=−∞
 2k
2k−1 t
α
p [ f ∗(t)]α dt
t
≥
∞
∑
k=−∞
(2k−1)
α
p [ f ∗(2k)]α
 2k
2k−1
dt
t
= 2−α
p log2
∞
∑
k=−∞
[ f ∗(2k)]α2
kα
p .
This completes the proof of the required inequality for nonnegative functions in
S+
0 (X) with constant
C′(p,q,α) = 16

q
q−α
 2
α
(1−2−α)−1
α 2
2
p (log2)−1
α
As noted, the constant in general is C(p,q,K,α) = 24+ 2
p K3C′(p,q,α).
□

66
1 Lp Spaces and Interpolation
We now proceed with the proof of Theorem 1.4.19.
Proof. We assume that p0 < p1, since if p0 > p1 we may simply reverse the roles
of p0 and p1. We ﬁrst consider the case p1,r < ∞. Lemma 1.4.20 implies that
T( f)

Lq0,∞≤M′
0
f

Lp0,m ,
T( f)

Lq1,∞≤M′
1
f

Lp1,m ,
(1.4.30)
for all f in S0(X), where m = 1
2 min

q0,q1, log2
log2K ,2r

, M′
0 = C(p0,q0,K,m)M0,
M′
1 = C(p1,q1,K,m)M1, and C(p,q,K,α) is as in (1.4.26).
Fix a function f in S0(X). Split f = f t + ft as follows:
f t(x) =

f(x)
if | f(x)| > f ∗(δtγ),
0
if | f(x)| ≤f ∗(δtγ),
ft(x) =

0
if | f(x)| > f ∗(δtγ),
f(x)
if | f(x)| ≤f ∗(δtγ),
where δ is to be determined later and γ is the following nonzero real number:
γ =
1
q0 −1
q
1
p0 −1
p
=
1
q −1
q1
1
p −1
p1
.
Using Exercise 1.1.10 we write
df t(v) =

df (v)
when v > f ∗(δtγ)
df ( f ∗(δtγ))
when v ≤f ∗(δtγ)
dft(v) =

0
when v ≥f ∗(δtγ)
df (v)−df ( f ∗(δtγ))
when v < f ∗(δtγ).
Observe the following facts
v ≥δtγ =⇒( f t)∗(v) ≤inf
	
s ∈(0, f ∗(δtγ)] : df t(s) ≤v

= inf
	
s ∈(0, f ∗(δtγ)] : df ( f ∗(δtγ)) ≤v

= inf(0, f ∗(δtγ)]
= 0,
v < δtγ =⇒( f t)∗(v) ≤inf
	
s > f ∗(δtγ) : df t(s) ≤v

= inf
	
s > f ∗(δtγ) : df (s) ≤v

= inf
	
s > 0 : df (s) ≤v

∩

f ∗(δtγ),∞

= f ∗(v),
since f ∗(v) ≥f ∗(δtγ),

1.4 Lorentz Spaces
67
v ≥δtγ =⇒( ft)∗(v) = inf
	
s > 0 : dft(s) ≤v

≤inf
	
s > 0 : df (s) ≤v

since dft ≤df
= f ∗(v),
v < δtγ =⇒( ft)∗(v) = inf
	
s > 0 : dft(s) ≤v

≤f ∗(δtγ),
since f ∗(δtγ) ∈{s > 0 : dft(s) ≤v

.
We summarize these observations in a couple of inequalities:
( f t)∗(s) ≤

f ∗(s)
if 0 < s < δtγ,
0
if s ≥δtγ,
( ft)∗(s) ≤

f ∗(δtγ)
if 0 < s < δtγ,
f ∗(s)
if s ≥δtγ.
It follows from these inequalities that f t lies in Lp0,m and ft lies in Lp1,m for all t > 0.
The quasi-linearity of the operator T and (1.4.9) imply
T( f)

Lq,r
=
t
1
q T( f)∗(t)

Lr( dt
t )
≤K
t
1
q (|T( ft)|+|T( f t)|)∗(t)

Lr( dt
t )
≤K
t
1
q T( ft)∗( t
2)+t
1
q T( f t)∗( t
2)

Lr( dt
t )
≤Kar
t
1
q T( ft)∗( t
2)

Lr( dt
t ) +
t
1
q T( f t)∗( t
2)

Lr( dt
t )

≤K max{1,2
1
r −1}
t
1
q T( ft)∗( t
2)

Lr( dt
t ) +
t
1
q T( f t)∗( t
2)

Lr( dt
t )

.
(1.4.31)
It follows from (1.4.30) that
t
1
q0 T( f t)∗( t
2) ≤2
1
q0 sup
s>0
s
1
q0 T( f t)∗(s) ≤2
1
q0 M′
0
 f t
Lp0,m ,
(1.4.32)
t
1
q1 T( ft)∗( t
2) ≤2
1
q1 sup
s>0
s
1
q1 T( ft)∗(s) ≤2
1
q1 M′
1
 ft

Lp1,m ,
(1.4.33)
for all t > 0. Now use (1.4.32), (1.4.33), and the facts that
t
1
q T( f t)∗( t
2) = t
1
q −1
q0 t
1
q0 T( f t)∗( t
2) ≤t
1
q −1
q0 2
1
q0 M′
0
 f t
Lp0,m
t
1
q T( f t)∗( t
2) = t
1
q −1
q1 t
1
q1 T( f t)∗( t
2) ≤t
1
q −1
q1 2
1
q1 M′
1
f t
Lp1,m ,

68
1 Lp Spaces and Interpolation
to estimate (1.4.31) by
K max{1,2
1
r −1}
)
2
1
q0 M′
0
t
1
q −1
q0  f t
Lp0,m

Lr( dt
t )
+2
1
q1 M′
1
t
1
q −1
q1  ft

Lp1,m

Lr( dt
t )
*
,
which is the same as
K max{1,2
1
r −1}2
1
q0 M′
0
t−γ( 1
p0 −1
p )f t
Lp0,m

Lr( dt
t )
(1.4.34)
+K max{1,2
1
r −1}2
1
q1 M′
1
tγ( 1
p −1
p1 )ft

Lp1,m

Lr( dt
t )
.
(1.4.35)
Next, we change variables u = δtγ in the Lr quasi-norm in (1.4.34) to obtain
t−γ( 1
p0 −1
p )f t
Lp0,m

Lr( dt
t )
≤δ
1
p0 −1
p
|γ|
1
r
u−( 1
p0 −1
p )
 u
0 f ∗(s)ms
m
p0 ds
s
 1
m

Lr( du
u )
≤δ
1
p0 −1
p
|γ|
1
r
)
r
m
r( 1
p0 −1
p)
* 1
m  ∞
0 (s
1
p0 f ∗(s))rs−r( 1
p0 −1
p ) ds
s
 1
r
=
δ
1
p0 −1
p
m
1
m |γ|
1
r ( 1
p0 −1
p)
1
m
f

Lp,r ,
where the last inequality is a consequence of Hardy’s inequality:
 ∞
0
 u
0 g(s) ds
s
p
u−b du
u
 1
p
≤p
b
 ∞
0 g(u)p u−b du
u
 1
p
(1.4.36)
with g(s) = f ∗(s)msm/p0 ≥0, p = r/m ≥1 and b = r/p0 −r/p > 0. See Exercise
1.2.8 for the proof of (1.4.36).
Likewise, change variables u = δtγ in the Lr quasi-norm of (1.4.35) to obtain
tγ( 1
p −1
p1 ) ft

Lp1,m

Lr( dt
t )
≤δ −( 1
p −1
p1 )
|γ|
1
r
u
1
p −1
p1
 u
0 f ∗(u)ms
m
p1 ds
s +
 ∞
u
f ∗(s)ms
m
p1 ds
s
 1
m

Lr( du
u )
= δ −( 1
p −1
p1 )
|γ|
1
r
u
m
p −m
p1
 u
0 f ∗(u)ms
m
p1 ds
s +
 ∞
u
f ∗(s)ms
m
p1 ds
s

1
m
Lr/m( du
u )

1.4 Lorentz Spaces
69
≤δ −( 1
p −1
p1 )
|γ|
1
r
u
m
p −m
p1 f ∗(u)m
 u
0 s
m
p1 ds
s

Lr/m( du
u )
+
u
m
p −m
p1
 ∞
u
f ∗(s)ms
m
p1 ds
s

Lr/m( du
u )
+ 1
m
≤δ −( 1
p −1
p1 )
|γ|
1
r

p1
m
 f
m
Lp,r +
r
m
r( 1
p−1
p1 )
 ∞
0

f ∗(u)mu
m
p1  r
m u
r
p −r
p1 du
u
 m
r
+ 1
m
= δ −( 1
p −1
p1 )
m
1
m |γ|
1
r

p1
p
1
p−1
p1
+ 1
m f

Lp,r ,
where the last inequality above is Hardy’s inequality:
 ∞
0
 ∞
u g(s) ds
s
p
ub du
u
 1
p
≤p
b
 ∞
0 g(u)p ub du
u
 1
p
(1.4.37)
with g(s) = f ∗(s)msm/p1 ≥0, p = r/m ≥1 and b = r/p −r/p1 > 0. See Exercise
1.2.8 for the proof of (1.4.37).
Combining these elements we deduce that given f in S0(X), we have that the
expression in (1.4.34) plus the expression in (1.4.35) is at most
K max{1,2
1
r −1}
m
1
m |γ|
1
r
⎧
⎨
⎩
2
1
q0 M′
0 δ
1
p0 −1
p
( 1
p0 −1
p)
1
m
+
2
1
q1 ( p1
p )
1
m M′
1 δ −( 1
p −1
p1 )
( 1
p−1
p1 )
1
m
⎫
⎬
⎭
f

Lp,r
We choose δ > 0 such that the two terms in the curly brackets above are equal. We
deduce that
T( f)

Lq,r ≤2K max{1,2
1
r −1}
m
1
m |γ|
1
r
⎧
⎨
⎩
2
1−θ
q0 (M′
0)1−θ
( 1
p0 −1
p)
1−θ
m
2
θ
q1 ( p1
p )
θ
m (M′
1)θ
( 1
p−1
p1 )
θ
m
⎫
⎬
⎭
 f

Lp,r
where θ is as in (1.4.23), i.e.,
θ =
1
p0 −1
p
1
p0 −1
p1
.
This proves (1.4.24) in the case p1,r < ∞with constant C∗(p0,q0, p1,q1,K,r,θ)
equal to
2K max{1,2
1
r −1}
m
1
m |γ|
1
r
⎧
⎨
⎩
2
1−θ
q0 C(p0,q0,K,m)1−θ2
θ
q1 ( p1
p )
θ
m C(p1,q1,K,m)θ
( 1
p0 −1
p)
1−θ
m ( 1
p−1
p1 )
θ
m
⎫
⎬
⎭,
where we recall that m = 1
2 min

q0,q1, log2
log2K ,2r

and C(pj,qj,K,m) is as in Lemma
1.4.20.

70
1 Lp Spaces and Interpolation
We now turn to the remaining cases p = ∞or r = ∞. The restriction r < ∞can
be removed since C∗(p0,q0, p1,q1,K,r,θ) has a ﬁnite limit as r →∞and, moreover,
∥f∥Lp,r = ∥t1/p f ∗(t)∥Lr(dt/t) →∥t1/p f ∗(t)∥L∞(dt/t) = ∥f∥Lp,∞as r →∞and likewise
∥T( f)∥Lp,r →∥T( f)∥Lp,∞as r →∞; see Exercise 1.1.3 (a). The restriction p1 < ∞
can be removed as follows. Suppose that p1 = ∞. Then, since θ ∈(0,1) it follows
that p < ∞and we pick p2 > p and p2 < ∞. It is easy to see T satisﬁes the restricted
weak type (p2,q2) estimate
sup
α>0
αν({|T(χA)| > α})
1
q2 ≤M1−ϕ
0
Mϕ
1 μ(A)
1
p2 ,
where
1−ϕ
p0
+ ϕ
∞= 1
p2
,
1−ϕ
q0
+ ϕ
q1
= 1
q2
.
(1.4.38)
Using the result obtained when p1 < ∞with p2 in place of p1 we obtain that
T( f)

Lq,r ≤C∗(p0,q0, p2,q2,K,r,ρ)M1−ρ
0
(M1−ϕ
0
Mϕ
1 )ρf

Lp,r
(1.4.39)
for all functions f in S0(X), where
1−ρ
p0
+ ρ
p2
= 1
p,
1−ρ
q0
+ ρ
q2
= 1
q .
(1.4.40)
Combining (1.4.38) and (1.4.40) and using (1.4.23) we deduce that θ = ρϕ and
hence (1.4.39) yields (1.4.24) in the case where p1 = ∞. In this case we have
C∗(p0,q0,∞,q1,K,r,θ) = C∗(p0,q0,
p0
1−ϕ ,( 1−ϕ
q0 + ϕ
q1 )−1,K,r, θ
ϕ ),
where ϕ is any number satisfying 1 > ϕ > 1−p0
p .
Finally, we address the last assertion of the theorem which claims that when
p,r < ∞and K = 1, the linear (or sublinear with nonnegative values) operator T
initially deﬁned on ﬁnitely simple functions has a unique bounded extension from
Lp,r(X) to Lq,r(Y), which also satisﬁes (1.4.24) (with the same constant). To obtain
this conclusion, we will need to know that the space S0(X) is dense in Lp,r(X)
whenever 0 < p,r < ∞. This is proved in Proposition 1.4.21 below. Assuming this
proposition, we deﬁne the extension of T on Lp,r(X) as follows:
Given f in Lp,r(X) a sequence of functions f j in S0(X) that converge to f in
Lp,r(X), notice that the linearity (or the sublinearity and the fact that T( f) ≥0 for
all f in S0(X)) implies
|T( f j)−T( fk)| ≤|T( f j −fk)|.
Using the boundedness of T from Lp,r(X) to Lq,r(Y) we obtain that the sequence
{T( f j)}j is Cauchy in Lq,r(Y) and by the completeness of this space, it must con-
verge to a limit which we call T( f). We observe that T( f) is independent of the
choice of the sequence {f j}j that converges to f in Lp,r. Moreover, one can show
that T is linear (or sublinear with nonnegative values), T( f) coincides with T( f)

1.4 Lorentz Spaces
71
on S0(X) and T is bounded from Lp,r(X) to Lq,r(Y). Thus T is the unique bounded
extension of T on the entire space Lp,r(X). For details, see Exercise 1.4.17.
□
Proposition 1.4.21. For all 0 < p,r < ∞the space S0(X) is dense in Lp,r(X).
Proof. Let f ∈Lp,r(X) and assume ﬁrst that f ≥0. Using (1.4.5) and the fact that
df is decreasing on [0,∞), we obtain for any n ∈Z+,
 f
r
Lp,r(X) = p
 ∞
0
/
df (s)
1
p s
0r ds
s
≥p
 2−n
0

df (2−n)
 r
p sr−1 ds
= p2−nr
r

df (2−n)
 r
p ,
which implies that df (2−n) < ∞. Likewise, again in view of (1.4.5), we have
f
r
Lp,r(X) ≥p
 2n
0

df (s)
 r
p sr−1 ds = p2nr
r

df (2n)
 r
p ,
which implies that limn→∞df (2n) = 0. Thus, for any n ∈Z+, there exists kn ∈N
such that
df (2kn) = μ
	
x ∈X : f(x) > 2kn

< 2−n.
Let En =
	
x ∈X : 2−n < f(x) ≤2kn
and note that μ (En) ≤df (2−n) < ∞for each
n ∈Z+. We write f χEn in binary expansion, that is, f χEn(x) = ∑∞
j=−kn dj(x)2−j,
where dj(x) = 0 or 1. Let Bj = {x ∈En : dj(x) = 1}. Then, μ(Bj) ≤μ(En) and
f χEn can be expressed as f χEn = ∑∞
j=−kn 2−jχB j.
Set fn = ∑n
j=−kn 2−jχB j. It is obvious that fn ∈S+
0 (X) and fn ≤f χEn ≤f. Ob-
serve that when x ∈En, we have
f(x)−fn(x) =
∞
∑
j=n+1
2−jχB j ≤2−n,
and that when x /∈En, we have fn(x) = 0 and f(x) > 2kn or f(x) ≤2−n. It follows
from these facts that
df−fn(2−n) = μ

En ∩{f −fn > 2−n}

+ μ

Ec
n ∩{f −fn > 2−n}

< 2−n.
Hence, for 2−n ≤t < ∞one has
( f −fn)∗(t) ≤( f −fn)∗(2−n) = inf
	
s > 0 : df−fn(s) ≤2−n
≤2−n.
This implies that limn→∞( f −fn)∗(t) = 0 for all t ∈(0,∞). By Proposition 1.4.5 (5),
(6), we obtain for all t ∈(0,∞)
( f −fn)∗(t) ≤f ∗(t/2)+ f ∗
n (t/2) ≤2f ∗(t/2).

72
1 Lp Spaces and Interpolation
The Lebesgue dominated convergence theorem gives ∥fn −f∥Lp,r(X) →0 as n →∞
which yields the required conclusion for nonnegative functions f in Lp,r(X).
For a complex-valued function f ∈Lp,r(X), we write f = f1 −f2 + i( f3 −f4),
where f j are nonnegative functions in Lp,r(X). By the preceding conclusion, there
exist sequences {f j
n}n∈Z+, j = 1,2,3,4, in S+
0 (X) such that f j
n →f j in Lp,r(X) as
n →∞. Set fn = f 1
n −f 2
n +i( f 3
n −f 4
n ). Using the fact that ∥·∥Lp,r(X) is a quasi-norm
we obtain
 f −fn

Lp,r(X) ≤C(p,r)
4
∑
j=1
 f j −f j
n

Lp,r(X)
which tends to zero as n →∞. This completes the proof.
□
Corollary 1.4.22. Let T be as in the statement of Theorem 1.4.19 and let 0 < p0 ̸=
p1 ≤∞and 0 < q0 ̸= q1 ≤∞. If T is restricted weak type (p0,q0) and (p1,q1) with
constants M0 and M1, respectively, and for some 0 < θ < 1 we have
1
p = 1−θ
p0
+ θ
p1
,
1
q = 1−θ
q0
+ θ
q1
,
and p ≤q, then T satisﬁes the strong type estimate
T( f)

Lq ≤C(p0,q0, p1,q1,θ)M1−θ
0
Mθ
1
f

Lp
(1.4.41)
for all f in S0(X). Moreover, if T is linear (or sublinear with nonnegative values),
then it has a unique bounded extension from Lp(X,μ) to Lq(Y,ν) that satisﬁes es-
timate (1.4.41) for all f ∈Lp(X) with the constant C(p0,q0, p1,q1,θ) replaced by
C(p0,q0, p1,q1,θ)22/p max(1,21/p−1)2.
Proof. Since θ ∈(0,1) we must have p,q < ∞. Take r = q in Theorem 1.4.19 and
note that ∥f∥Lp,r ≤∥f∥Lp since p ≤q = r; see Proposition 1.4.10. The last assertion
follows using Exercise 1.4.17.
□
We now give examples to indicate why the assumptions p0 ̸= p1 and q0 ̸= q1
cannot be dropped in Theorem 1.4.19.
Example 1.4.23. Let X = Y = R and
T( f)(x) = |x|−1/2
 1
0 f(t)dt .
Then α|{x : |T(χA)(x)| > α}|1/2 = 21/2|A∩[0,1]| and thus T is of restricted weak
types (1,2) and (3,2). But observe that T does not map L2 = L2,2 to Lq,2. Thus
Theorem 1.4.19 fails if the assumption q0 ̸= q1 is dropped. The dual operator
S( f)(x) = χ[0,1](x)
 +∞
−∞f(t)|t|−1/2 dt

1.4 Lorentz Spaces
73
satisﬁes α|{x : |S(χA)(x)| > α}|1/q ≤c|A|1/2 when q = 1 or 3, and thus it furnishes
an example of an operator of restricted weak types (2,1) and (2,3) that is not L2
bounded. Thus Theorem 1.4.19 fails if the assumption p0 ̸= p1 is dropped.
As an application of Theorem 1.4.19, we give the following strengthening of
Theorem 1.2.13.
We end this chapter with a corollary of the proof of Theorem 1.4.19.
Corollary 1.4.24. Let 1 ≤r < ∞, 1 ≤p0 ̸= p1 < ∞, and 0 < q0 ̸= q1 ≤∞and let
(X,μ) and (Y,ν) be σ-ﬁnite measure spaces. Let T be a quasi-linear operator de-
ﬁned on Lp0(X)+Lp1(X) and taking values in the set of measurable functions on Y.
Assume that for some M′
0,M′
1 < ∞the following estimates hold for j = 0,1
T( f)

Lq j,∞(Y) ≤M′
j
f

Lp j (X) ,
(1.4.42)
for all functions f ∈Lp j(X). Fix 0 < θ < 1 and let
1
p = 1−θ
p0
+ θ
p1
and
1
q = 1−θ
q0
+ θ
q1
.
(1.4.43)
Then there exists a constant C∗(p0,q0, p1,q1,K,r,θ) < ∞such that for all functions
f in Lp(X) we have
T( f)

Lq,p ≤C∗(p0,q0, p1,q1,K,r,θ)(M′
0)1−θ(M′
1)θ f

Lp.
(1.4.44)
Proof. Since Lp(X) is contained in the sum Lp0(X)+Lp1(X), the operator T is well
deﬁned on Lp(X). Hypothesis (1.4.42) implies that (1.4.30) holds for all f ∈Lp j,1.
Repeat the proof of Theorem 1.4.19 starting from (1.4.30) ﬁxing a function f in
Lp(X), m = 1 and r = p. We obtain the required conclusion.
Theorem 1.4.25. (Young’s inequality for weak type spaces) Let G be a locally com-
pact group with left Haar measure λ that satisﬁes (1.2.12) for all measurable subsets
A of G. Let 1 < p,q,r < ∞satisfy
1
q +1 = 1
p + 1
r .
(1.4.45)
Then there exists a constant Bp,q,r > 0 such that for all f in Lp(G) and g in Lr,∞(G)
we have
 f ∗g

Lq(G) ≤Bp,q,r
g

Lr,∞(G)
 f

Lp(G) .
(1.4.46)
Proof. We ﬁx 1 < p,q < ∞. Since p and q range in an open interval, we can ﬁnd
p0 < p < p1, q0 < q < q1, and 0 < θ < 1 such that (1.4.23) and (1.4.45) hold.
Let T( f) = f ∗g, deﬁned for all functions f on G. By Theorem 1.2.13, T extends
to a bounded operator from Lp0 to Lq0,∞and from Lp1 to Lq1,∞. It follows from
the Corollary 1.4.24 that T extends to a bounded operator from Lp(G) to Lq(G).
Notice that since G is locally compact, (G,λ) is a σ-ﬁnite measure space and for
this reason, we were able to apply Corollary 1.4.24.
□

74
1 Lp Spaces and Interpolation
Exercises
1.4.1. (a) Let g be a nonnegative integrable function on a measure space (X,μ) and
let A be a measurable subset of X. Prove that

A gdμ ≤
 μ(A)
0
g∗(t)dt.
(b) (G. H. Hardy and J. E. Littlewood) For f and g measurable on a σ-ﬁnite measure
space (X,μ), prove that

X | f(x)g(x)|dμ(x) ≤
 ∞
0
f ∗(t)g∗(t)dt.
Compare this result to the classical Hardy–Littlewood result asserting that for
aj,bj > 0, the sum ∑j ajbj is greatest when both aj and bj are rearranged in de-
creasing order (for this see [148, p. 261]).
1.4.2. Let (X,μ) be a measure space. Prove that if f ∈Lq0,∞(X)∩Lq1,∞(X) for some
0 < q0 < q1 ≤∞, then f ∈Lq,s(X) for all 0 < s ≤∞and q0 < q < q1.
1.4.3. ([164]) Given 0 < p,q < ∞, ﬁx an r = r(p,q) > 0 such that r ≤1, r ≤q and
r < p. Let (X,μ) be a measure space. For t < μ(X) deﬁne
f ∗∗(t) = sup
μ(E)≥t

1
μ(E)

E | f|r dμ
1/r
,
while for t ≥μ(X) (if μ(X) < ∞) let
f ∗∗(t) =
1
t

X | f|r dμ
1/r
.
Also deﬁne
⏐⏐⏐⏐⏐⏐f
⏐⏐⏐⏐⏐⏐
Lp,q =
 ∞
0

t
1
p f ∗∗(t)
q dt
t
 1
q
.
(The function f ∗∗and the functional f →||| f|||Lp,q depend on r.)
(a) Prove that the inequality ((( f +g)∗∗)(t))r ≤( f ∗∗(t))r +(g∗∗(t))r is valid for all
t ≥0. Since r ≤q, conclude that the functional f →||| f|||r
Lp,q is subadditive and
hence it is a norm when r = 1 (this is possible only if p > 1).
(b) Show that for all f we have
f

Lp,q ≤
⏐⏐⏐⏐⏐⏐f
⏐⏐⏐⏐⏐⏐
Lp,q ≤

p
p−r
1/r f

Lp,q.
(c) Conclude that Lp,q(X) is metrizable and normable when 1 < p,q < ∞.

1.4 Lorentz Spaces
75
1.4.4. Show that on a measure space (X,μ) the set of countable linear combinations
of simple functions is dense in Lp,∞(X).
(b) Prove that ﬁnitely simple functions are not dense in Lp,∞(R) for any 0 < p ≤∞.

Hint: Part (b): Show that the function h(x) = x−1/pχx>0 cannot be approximated
in Lp,∞by a sequence of ﬁnitely simple functions. Given a ﬁnitely simple function s
which is nonzero on a set A with |A| > 0, show that ∥s−h∥Lp,∞≥sup0<λ<|A|1/p λ(λ −p
−|A|)1/p = 1.

1.4.5. Let (X,μ) be a nonatomic measure space.
(a) If A0 ⫅A1 ⫅X, 0 < μ(A1) < ∞, and μ(A0) ≤t ≤μ(A1), show that there exists
an Et ⫅A1 with μ(Et) = t.
(b) Given a nonnegative continuous and decreasing function ϕ on [0,∞) such that
ϕ(t) = 0 whenever t ≥μ(X), prove that there exists a measurable function f on X
with f ∗(t) = ϕ(t) for all t > 0.
(c) Given A ⫅X with 0 < μ(A) < ∞and g an integrable function on X, show that
there exists a subset #A of X with μ(#A) = μ(A) such that

#A |g|dμ =
 μ(A)
0
g∗(s)ds.
(d) If X is σ-ﬁnite, f ∈L∞(X), and g ∈L1(X), prove that
sup
h: dh=d f


X hgdμ
 =
 ∞
0
f ∗(s)g∗(s)ds,
where the supremum is taken over all functions h on X equidistributed with f.

Hint: Part (a): Reduce matters to the situation in which A0 = /0. Consider ﬁrst the
case that for all A ⫅X there exists a subset B of X satisfying
1
10 μ(A) ≤μ(B) ≤
9
10 μ(A). Then we can ﬁnd subsets of A1 of measure in any arbitrarily small inter-
val, and by continuity the required conclusion follows. Next consider the case in
which there is a subset A1 of X such that every B ⫅A1 satisﬁes μ(B) < 1
10 μ(A1)
or μ(B) > 9
10 μ(A1). Without loss of generality, normalize μ so that μ(A1) = 1. Let
μ1 = sup{μ(C) : C ⫅A1, μ(C) < 1
10} and pick B1 ⫅A1 such that 1
2 μ1 ≤μ(B1) ≤
μ1. Set A2 = A1 \B1 and deﬁne μ2 = sup{μ(C) : C ⫅A2, μ(C) < 1
10}. Continue in
this way and deﬁne sets A1 ⫆A2 ⫆A3 ⫆··· and numbers 1
10 ≥μ1 ≥μ2 ≥μ3 ≥···.
If C ⫅An+1 with μ(C) < 1
10, then C∪Bn ⫅An with μ(C∪Bn) < 1
5 < 9
10, and hence
by assumption we must have μ(C ∪Bn) < 1
10. Conclude that μn+1 ≤1
2μn and that
μ(An) ≥4
5 for all n = 1,2,.... Then the set ∞
n=1 An must be an atom. Part (b):
First show that when d is a simple right continuous decreasing function on [0,∞)
there exists a measurable f on X such that f ∗= d. For general continuous func-
tions, use approximation. Part (c): Let t = μ(A) and deﬁne A1 = {x : |g(x)| > g∗(t)}
and A2 = {x : |g(x)| ≥g∗(t)}. Then A1 ⫅A2 and μ(A1) ≤t ≤μ(A2). Pick #A such
that A1 ⫅#A ⫅A2 and μ(#A) = t = μ(A) by part (a). Then

#A gdμ =

X gχ#A dμ =
 ∞
0 (gχ#A)∗ds =
 μ(#A)
0
g∗(s)ds. Part (d): Reduce matters to functions f,g ≥0. Let

76
1 Lp Spaces and Interpolation
f = ∑N
j=1 ajχA j where a1 > a2 > ··· > aN > 0 and the Aj are pairwise disjoint.
Write f as ∑N
j=1 bjχB j, where bj = (aj −aj+1) and Bj = A1 ∪···∪Aj. Pick #Bj as in
part (c). Then #B1 ⫅··· ⫅#BN and the function f1 = ∑N
j=1 bjχ#B j has the same distri-
bution function as f. It follows from part (c) that

X f1gdμ =
 ∞
0 f ∗(s)g∗(s)ds. The
case of a general f ∈L∞(X) follows by approximation by ﬁnitely simple functions.

1.4.6. ([7], [297]) Let K ≥1 and let ∥· ∥be a nonnegative functional on a vector
space X that satisﬁes
∥x+y∥≤K

∥x∥+∥y∥

for all x,y ∈X. For a ﬁxed α ≤1 satisfying (2K)α = 2 show that
∥x1 +···+xn∥α ≤4(∥x1∥α +···+∥xn∥α)
for all n = 1,2,... and all x1, x2, ..., xn in X. This inequality is referred to as the
Aoki-Rolewicz theorem.

Hint: Quasi-linearity implies that ∥x1 + ··· + xn∥≤max1≤j≤n[(2K) j∥xj∥] for all
x1,...,xn in X (use that K ≥1). Deﬁne H : X →R by setting H(0) = 0 and
H(x) = 2j/α if 2j−1 < ∥x∥α ≤2j. Then ∥x∥≤H(x) ≤21/α∥x∥for all x ∈X. Prove by
induction that ∥x1 +···+xn∥α ≤2(H(x1)α +···+H(xn)α). Suppose that this state-
ment is true when n = m. To show its validity for n = m+1, without loss of general-
ity assume that ∥x1∥≥∥x2∥≥··· ≥∥xm+1∥. Then H(x1) ≥H(x2) ≥··· ≥H(xm+1).
Assume that all the H(xj)’s are distinct. Then since H(xj)α are distinct powers of 2,
they must satisfy H(xj)α ≤2−j+1H(x1)α. Then
∥x1 +···+xm+1∥α ≤

max
1≤j≤m+1(2K) j∥xj∥
α
≤

max
1≤j≤m+1(2K) jH(xj)
α
≤

max
1≤j≤m+1(2K) j21/α2−j/αH(x1)
α
= 2H(x1)α
≤2(H(x1)α +···+H(xm+1)α).
We now consider the case that H(xj) = H(xj+1) for some 1 ≤j ≤m. Then for some
integer r we must have 2r−1 < ∥xj+1∥α ≤∥xj∥α ≤2r and H(xj) = 2r/α. Next note
that
∥xj +xj+1∥α ≤Kα(∥xj∥+∥xj+1∥)α ≤Kα(2 2r/α)α = 2r+1.
This implies
H(xj +xj+1)α ≤2r+1 = 2r +2r = H(xj)α +H(xj+1)α.
Now apply the inductive hypothesis to x1,...,xj−1,xj + xj+1,xj+1,...,xm and use
the previous inequality to obtain the required conclusion.

1.4.7. (a) ([347]) Let (X,μ) and (Y,ν) be measure spaces. Let Z be a Banach space
of complex-valued measurable functions on Y. Assume that Z is closed under abso-

1.4 Lorentz Spaces
77
lute values and satisﬁes ∥f∥Z = ∥| f|∥Z. Suppose that T is a linear operator deﬁned
on the space of ﬁnitely simple functions on (X,μ) and taking values in Z. Suppose
that for some constant A > 0 the following restricted weak type estimate
T(χE)

Z ≤Aμ(E)1/p
holds for some 0 < p < ∞and for all E measurable subsets of X of ﬁnite measure.
Show that for all ﬁnitely simply functions f on X we have
T( f)

Z ≤p−1A
f

Lp,1 .
Consequently T has a bounded extension from Lp,1(X) to Z.
(b) ([172]) As an application of part (a) prove that for any U, V measurable subsets
of Rn with |U|,|V| < ∞and any f measurable on U ×V we have

U
 f(u,·)
2
L2,1(V) du
 1
2
≤1
2
f

L2,1(U×V) .

Hint: Part (a): Let f = ∑N
j=1 ajχE j ≥0, where a1 > a2 > ··· > aN > 0, μ(Ej) < ∞
pairwise disjoint. Let Fj = E1 ∪··· ∪Ej, B0 = 0, and Bj = μ(Fj) for j ≥1. Write
f = ∑N
j=1(aj −aj+1)χFj, where aN+1 = 0. Then
T( f)

Z =
|T( f)|

Z
≤
N
∑
j=1
(aj −aj+1)
T(χFj)

Z
≤A
N
∑
j=1
(aj −aj+1)(μ(Fj))1/p
= A
N−1
∑
j=0
aj+1(B1/p
j+1 −B1/p
j
)
= p−1A
 f

Lp,1 ,
where the penultimate equality follows by a summation by parts; see Appendix F.

1.4.8. Let 0 < p,q,α,β < ∞. Also let 0 < q1 < q2 < ∞.
(a) Show that the function fα,β(t) = t−α(logt−1)−β χ[0,e−β/α)(t) lies in Lp,q(R) if
and only if either p < 1/α or both p = 1/α and q > 1/β hold. Conclude that the
function t →t−1/p(logt−1)−1/q1χ[0,e−p/q1)(t) lies in Lp,q2(R) but not in Lp,q1(R).
(b) Find a necessary and sufﬁcient condition in terms of p,α,β for the function
gα,β(t) = (1+t)−α(log(2+t))−β χ[0,∞) to lie in Lp,q(R).

78
1 Lp Spaces and Interpolation
(c) Let ψ(t) be smooth decreasing function on [0,∞) and let F(x) = ψ(|x|) for x
in Rn, where |x| is the modulus of x. Show that F∗(t) = f((t/vn)1/n), where vn is
the volume of the unit ball. Use this formula to construct examples showing that
Lp,q1(Rn) ⫋Lp,q2(Rn).
(d) On a general nonatomic measure space (X,μ) prove that there does not exist a
constant C(p,q1,q2) > 0 such that for all f in Lp,q2(X) the following is valid:
f

Lp,q1 ≤C(p,q1,q2)
f

Lp,q2 .

Hint: Parts (a), (b): Use that fα,β and gα,β are equal to their decreasing rearrange-
ments. Part (d): Use Exercise 1.4.5 (b) with ϕ(t) = g1/p,1/q1(t).

1.4.9. ([346]) Let Lp(ω) denote the space of all measurable functions f on Rn such
that ∥f∥p
Lp(ω) =

Rn | f(x)|p ω(x)dx < ∞, where 0 < ω < ∞a.e. Let T be a sublinear
operator that maps Lp0(ω0) to Lq0,∞(ω) and Lp1(ω1) to Lq1,∞(ω), where ω0,ω1,ω
are positive functions and 1 ≤p0 < p1 < ∞, 0 < q0,q1 < ∞. Suppose that
1
pθ
= 1−θ
p0
+ θ
p1
,
1
qθ
= 1−θ
q0
+ θ
q1
.
Let Ωθ = ω
1−θ
p0 pθ
0
ω
θ
p1 pθ
1
. Show that T maps Lpθ 
Ωθ

→Lqθ ,pθ (ω).

Hint: Deﬁne L( f) = (ω1/ω0)
1
p1−p0 f and observe that for each θ ∈[0,1], L maps
Lpθ 
Ωθ

→Lpθ 
(ω p1
0 ω−p0
1
)
1
p1−p0 
isometrically. Then apply Corollary 1.4.24 to
the sublinear operator T ◦L−1.

1.4.10. ([185], [349]) Let λn be a sequence of positive numbers with ∑n λn ≤1 and
∑n λn log( 1
λn ) = K < ∞. Suppose all sequences are indexed by a ﬁxed countable set.
(a) Let fn be a sequence of complex-valued functions in L1,∞(X) with ∥fn∥L1,∞≤1
uniformly in n. Prove that ∑n λn fn lies in L1,∞(X) with norm at most 2(K +2). (This
property is referred to as the logconvexity of L1,∞.)
(b) Let Tn be a sequence of sublinear operators that map L1(X) to L1,∞(Y) with
norms ∥Tn∥L1→L1,∞≤B uniformly in n. Use part (a) to prove that ∑n λnTn maps
L1(X) to L1,∞(Y) with norm at most 2B(K +2).
(c) Given δ > 0 pick 0 < ε < δ and use the simple estimate
μ

{
∞
∑
n=1
2−δn fn >α}

≤
∞
∑
n=1
μ

{2−δn fn >(2ε −1)2−εnα}

to obtain a simple proof of the statement in part (a) when λn = 2−δn, n = 1,2,....

Hint: Part (a): For ﬁxed α > 0, write fn = un + vn + wn, where un = fnχ| fn|≤α
2 ,
vn = fnχ| fn|> α
2λn , and wn = fnχ α
2 <| fn|≤α
2λn . Let u = ∑n λnun, v = ∑n λnvn, and w =
∑n λnwn. Clearly |u| ≤α
2 . Also {v ̸= 0} ⫅
n{| fn| >
α
2λn }; hence μ({v ̸= 0}) ≤2
α .
Finally,

1.4 Lorentz Spaces
79

X |w|dμ ≤∑
n
λn

X | fn|χ α
2 <| fn|≤α
2λn dμ
≤∑
n
λn
 α/(2λn)
α/2
dfn(β)dβ +
 α/2
0
dfn(α/2)dβ

≤K +1.
Using μ({|u+v+w| > α}) ≤μ({|u| > α/2})+ μ({|v| ̸= 0})+ μ({|w| > α/2}),
deduce the conclusion.

1.4.11. Let {fn}n be a sequence of measurable functions on a measure space (X,μ).
Let 0 < q,s ≤∞.
(a) Suppose that fn ≥0 for all n. Show that
liminf
n→∞fn

Lq,s ≤liminf
n→∞
fn

Lq,s .
(b) Let gn →g in Lq,s as n →∞. Show that ∥gn∥Lq,s →∥g∥Lq,s as n →∞.
1.4.12. (a) Suppose that X is a quasi-Banach space and let X∗be its dual (which is
always a Banach space). Prove that for all T ∈X∗we have
T

X∗= sup
x∈X
∥x∥X≤1
|T(x)|.
(b) Now suppose that X is a Banach space. Use the Hahn–Banach theorem to prove
that for every x ∈X we have
∥x∥X =
sup
T∈X∗
∥T∥X∗≤1
|T(x)|.
Observe that this result may fail for quasi-Banach spaces. For example, if X = L1,∞,
every linear functional on X∗vanishes on the set of simple functions.
(c) Let 1 < p < ∞, X = Lp,1(Y), and X∗= Lp′,∞(Y), where (Y,μ) is nonatomic
σ-ﬁnite measure space. Conclude that
f

Lp,1 ≈
sup
∥g∥Lp′,∞≤1


Y fgdμ
,
f

Lp,∞≈
sup
∥g∥Lp′,1≤1


Y fgdμ
.
1.4.13. Let 0 < p,q < ∞. Prove that any function in Lp,q(X,μ) can be written as
f =
+∞
∑
n=−∞
cn fn,

80
1 Lp Spaces and Interpolation
where fn is a function bounded by 2−n/p, supported on a set of measure 2n, and the
sequence {ck}k lies in ℓq and satisﬁes
2−1
p (log2)
1
q {ck}k

ℓq ≤
f

Lp,q ≤
{ck}k

ℓq 2
1
p (log2)
1
q .

Hint: Let cn = 2n/p f ∗(2n), An = {x : f ∗(2n+1) < | f(x)| ≤f ∗(2n))}, and fn =
c−1
n f χAn.

1.4.14. (T. Tao) Let 0 < p < ∞, 0 < γ < 1, A,B > 0, and let f be a measurable func-
tion on a measure space (X,μ).
(a) Suppose that ∥f∥Lp,∞≤A. Then for every measurable set E of ﬁnite measure
there exists a measurable subset E′ of E with μ(E′) ≥γ μ(E) such that f is inte-
grable on E′ and


E′ f dμ
 ≤(1−γ)−1/p Aμ(E)1−1
p .
(b) Suppose that (X,μ) is a σ-ﬁnite measure space and that f has the property that
for any measurable subset E of X with μ(E) < ∞there is a measurable subset E′ of
E with μ(E′) ≥γ μ(E) such that f is integrable on E′ and


E′ f dμ
 ≤Bμ(E)1−1
p .
Then we have that ∥f∥Lp,∞≤B41/pγ−1√
2.
(c) Conclude that if (X,μ) is a σ-ﬁnite measure space then
f

Lp,∞≈
sup
E⫅X
0<μ(E)<∞
inf
E′⫅E
μ(E′)≥1
2 μ(E)
f∈L1(E′)
μ(E)−1+ 1
p


E′ f dμ
.

Hint: Part (a): Take E′ = E \ {| f| > A(1 −γ)−1
p μ(E)−1
p }. Part (b): Write X =
∞
n=1 Xn with μ(Xn) < ∞. Given α > 0, note that the set
	
| f| > α

is contained in
	
Re f > α
√
2

∪
	
Im f > α
√
2

∪
	
Re f <−α
√
2

∪
	
Im f <−α
√
2

.
Let En be any of the preceding four sets intersected with Xn, let E′
n be a subset of
it with measure at least γ μ(En) as in the hypothesis. Then

E′n f dμ
 ≥α
√
2γ μ(En),
from which it follows that αμ(En)1/p ≤B
√
2γ−1, and let n →∞.

1.4.15. Let T be a linear operator deﬁned on the set of ﬁnitely simple functions on
a σ-ﬁnite measure space (X,μ) and taking values in the set of measurable functions
on a σ-ﬁnite measure space (Y,ν) and Tt be a linear operator deﬁned on the set
of ﬁnitely simple functions on (Y,ν) and taking values in the set of measurable
functions of (X,μ). Suppose that for all A subsets of X and B subsets of Y of ﬁnite
measure we have

1.4 Lorentz Spaces
81

B |T(χA)|dν +

A |Tt(χB)|dμ < ∞
and that T and Tt are related via the “transpose identity”

Y T(χA)χB dν =

X Tt(χB)χA dμ = Λ(A,B).
Assume that whenever μ(An)+ν(Bn) →0 as n →∞, we have Λ(An,Bn) →0. Sup-
pose that T and Tt are restricted weak type (1,1) operators, with constants C1 and
C2, respectively. Show that, for all 1 < p < ∞, T is of restricted weak type (p, p).
Precisely, show that there exists a constant Kp such that
T(χA)

Lp(Y) ≤KpC
1
p
1 C
1−1
p
2
μ(A)
1
p
for all measurable subsets A of X with μ(A) < ∞.

Hint: Suppose that C1μ(F) > C2ν(E) and pick m so that C1μ(F) ∼2mC2ν(E).
Since Tt is restricted weak type (1,1) there is an F′ ⫅F such that μ(F′) ≥1
2μ(F)
and |Λ(F′,E)| ≤2C2ν(E). Find by induction sets F( j) ⫅F \ (F′ ∪··· ∪F( j−1))
such that μ(F( j)) ≥1
2μ(F \ (F′ ∪··· ∪F( j−1))) and |Λ(F( j),E)| ≤2C2ν(E), j =
1,2,...,m. Stop when F(m) = F \(F′ ∪···∪F(m−1)) satisﬁes C1μ(F(m)) ≤C2ν(E).
Since T is restricted weak type (1,1) there is a subset E′ of E such that ν(E′) ≥
1
2ν(E) and |Λ(F(m),E′)| ≤2C1μ(F(m)) ≤2C2ν(E). Now write
Λ(F,E) =
m−1
∑
j=1
Λ(F( j),E)+Λ(F(m),E′)+Λ(F(m),E \E′)
from which it follows that
|Λ(F,E)| ≤2C2ν(E)

1+log2
C1μ(F)
C2ν(E)

+|Λ(F1,E1)|
where F1 = F(m) and E1 = E \ E′. Note that the ﬁrst term in the sum above is
at most K′
p(C1μ(F))1/p(C2ν(E))1/p′ and that the identical estimate holds if the
roles of E and F are reversed. Also observe that μ(F1) ≤1
2μ(F) and ν(E1) ≤
1
2ν(E). Continuing this process we ﬁnd sets (Fn,En) with μ(Fn+1) ≤1
2μ(Fn) and
ν(En+1) ≤1
2ν(En).Using Λ(Fn,En) →0 as n →∞we deduce that |Λ(F,E)| ≤
2K′
p(C1μ(F))1/p(C2ν(E))1/p′. Considering the sets E+ = E ∩{T(χF) > 0} and
E−= E ∩{T(χF) < 0}, obtain that

E
T(χF)
dν ≤4K′
p

C1μ(F)
 1
p 
C2ν(E)
 1
p′
for all F and E measurable sets of ﬁnite measure. Exercise 1.1.12 (a) with r = 1
yields that ∥T(χF)∥Lp,∞≤4KpC1/p
1
C1/p′
2
μ(F)1/p.

1.4.16. ([35]) Let 0 < p0 < p1 < ∞and 0 < α,β,A,B < ∞. Suppose that a family of
sublinear operators Tk is of restricted weak type (p0, p0) with constant A2−kα and
of restricted weak type (p1, p1) with constant B2kβ for all k ∈Z. Show that there

82
1 Lp Spaces and Interpolation
is a constant C = C(α,β, p0, p1) such that ∑k∈Z Tk is of restricted weak type (p, p)
with constant CA1−θBθ, where θ = α/(α +β) and
1
p = 1−θ
p0
+ θ
p1
.

Hint: Estimate μ({|T(χE)| > λ}) by the sum ∑k≥k0 μ({|Tk(χE)| > cλ2α′(k0−k)})+
∑k≤k0 μ({|Tk(χE)| > cλ2β ′(k−k0)}), where c is a suitable constant and 0 < α′ < α,
0 < β ′ < β. Apply the restricted weak type (p0, p0) hypothesis on each term of the
ﬁrst sum, the restricted weak type (p1, p1) hypothesis on each term of the second
sum, and choose k0 to optimize the resulting expression.

1.4.17. Let (X,μ), (Y,ν) be measure spaces, 0 < p,r,q,s ≤∞and 0 < B < ∞. Sup-
pose that a sublinear operator T is deﬁned on a dense subspace D of Lp,r(X), takes
values in the space of measurable functions of another measure space Y, and satisﬁes
T( f) ≥0 for all f in D. Assume that
T(ϕ)

Lq,s ≤B
ϕ

Lp,r
for all ϕ in D. Prove that T admits a unique sublinear extension T on Lp,r(X) such
that
T( f)

Lq,s ≤B
f

Lp,r
for all f ∈Lp,r(X).

Hint: Given f ∈Lp,r(X) ﬁnd a sequence of functions ϕj in D such that ϕj →f in
Lp,r. Use the inequality |T(ϕj)−T(ϕk)| ≤|T(ϕj −ϕk)|, to obtain that the sequence
{T(ϕj)}j is Cauchy in Lq,s and thus it has a unique limit T( f) which is independent
of the choice of sequence ϕj. Boundedness of T follows by density. To prove that T
is sublinear use that convergence in Lq,s implies convergence in measure and thus a
subsequence of T(ϕj) converges ν-a.e. to T( f). Also use Exercise 1.4.11.

HISTORICAL NOTES
The modern theory of measure and integration was founded with the publication of Lebesgue’s
dissertation [214]; see also [215]. The theory of the Lebesgue integral reshaped the course of in-
tegration. The spaces Lp([a,b]), 1 < p < ∞, were ﬁrst investigated by Riesz [290], who obtained
many important properties of them. A rigorous treatise of harmonic analysis on general groups
can be found in the book of Hewitt and Ross [152]. The best possible constant Cpqr in Young’s
inequality ∥f ∗g∥Lr(Rn) ≤Cpqr∥f∥Lp(Rn)∥g∥Lq(Rn), 1
p + 1
q = 1
r + 1, 1< p,q,r <∞, was shown by
Beckner [21] to be Cpqr = (BpBqBr′)n, where B2
p = p1/p(p′)−1/p′.
Theorem 1.3.2 ﬁrst appeared without proof in Marcinkiewicz’s brief note [240]. After his death
in World War II, this theorem seemed to have escaped attention until Zygmund reintroduced it
in [387]. This reference presents the more difﬁcult off-diagonal version of the theorem, derived
by Zygmund. Stein and Weiss [347] strengthened Zygmund’s theorem by assuming that the initial
estimates are of restricted weak type whenever 1 ≤p0, p1,q0,q1 ≤∞. The extension of this result
to the case 0 < p0, p1,q0,q1 < 1 in Theorem 1.4.19 is due to the author. The critical Lemma 1.4.20
was suggested by Kalton. Improvements of these results, in particular, the appearance of the space
S0(X) and the presence of the factor M1−θ
0
Mθ
1 in (1.4.24) appeared in Liang, Liu, and Yang [224].
Equivalence of restricted weak type (1,1) and weak type (1,1) properties for certain maximal

1.4 Lorentz Spaces
83
multipliers was obtained by Moon [257]. The following partial converse of Theorem 1.2.13 is due
to Stepanov [351]: If a convolution operator maps L1(Rn) to Lq,∞(Rn) for some 1 < q < ∞then its
kernel must be in Lq,∞.
The extrapolation result of Exercise 1.3.7 is due to Yano [380]; see also Zygmund [389, pp.
119–120] and the related work of Carro [56], Soria [330], and Tao [356].
The original version of Theorem 1.3.4 was proved by Riesz [293] in the context of bilinear
forms. This version is called the Riesz convexity theorem, since it says that the logarithm of the
function M(α,β) = infx,y
∑n
j=1 ∑m
k=1 ajkxjyk
∥x∥−1
ℓ1/α ∥y∥−1
ℓ1/β (where the inﬁmum is taken over all
sequences {xj}n
j=1 in ℓ1/α and {yk}m
k=1 in ℓ1/β) is a convex function of (α,β) in the triangle 0 ≤
α,β ≤1, α + β ≥1. Riesz’s student Thorin [360] extended this triangle to the unit square 0 ≤
α,β ≤1 and generalized this theorem by replacing the maximum of a bilinear form with the
maximum of the modulus of an entire function in many variables. After the end of World War II,
Thorin published his thesis [361], building the subject and giving a variety of applications. The
original proof of Thorin was rather long, but a few years later, Tamarkin and Zygmund [354] gave
a very elegant short proof using the maximum modulus principle in a more efﬁcient way. Today,
this theorem is referred to as the Riesz–Thorin interpolation theorem.
Calder´on [42] elaborated the complex-variables proof of the Riesz–Thorin theorem into a gen-
eral method of interpolation between Banach spaces. The complex interpolation method can also be
deﬁned for pairs of quasi-Banach spaces, although certain complications arise in this setting; how-
ever, the Riesz–Thorin theorem is true for pairs of Lp spaces (with the “correct” geometric mean
constant) for all 0 < p ≤∞and also for Lorentz spaces. In this setting, duality cannot be used, but
a well-developed theory of analytic functions with values in quasi-Banach spaces is crucial. We
refer to the articles of Kalton [186] and [187] for details. Complex interpolation for sublinear maps
is also possible; see the article of Calder´on and Zygmund [47]. Interpolation for analytic families
of operators (Theorem 1.3.7) is due to Stein [331]. The critical Lemma 1.3.8 used in the proof was
previously obtained by Hirschman [154].
The fact that nonatomic measure spaces contain subsets of all possible measures is classical.
An extension of this result to countably additive vector measures with values in ﬁnite-dimensional
Banach spaces was obtained by Lyapunov [236]; for a proof of this fact, see Diestel and Uhl [95,
p. 264]. The Aoki–Rolewicz theorem (Exercise 1.4.6) was proved independently by Aoki [7] and
Rolewicz [297]. For a proof of this fact and a variety of its uses in the context of quasi-Banach
spaces we refer to the book of Kalton, Peck, and Roberts [188].
Decreasing rearrangements of functions were introduced by Hardy and Littlewood [146]; the
authors attribute their motivation to understanding cricket averages. The Lp,q spaces were intro-
duced by Lorentz in [232] and in [233]. A general treatment of Lorentz spaces is given in the
article of Hunt [164]. The normability of the spaces Lp,q (which holds exactly when 1 < p ≤∞
and 1 ≤q ≤∞) can be traced back to general principles obtained by Kolmogorov [199]. The in-
troduction of the function f ∗∗, which was used in Exercise 1.4.3, to explicitly deﬁne a norm on
the normable spaces Lp,q is due to Calder´on [42]. These spaces appear as intermediate spaces in
the general interpolation theory of Calder´on [42] and in that of Lions and Peetre [225]. The latter
was pointed out by Peetre [275]. For a systematic study of the duals of Lorentz spaces we refer to
Cwikel [83] and Cwikel and Fefferman [84], [85]. An extension of the Marcinkiewicz interpolation
theorem to Lorentz spaces was obtained by Hunt [163]. Carro, Raposo, and Soria [57] provide a
comprehensive presentation of the theory of Lorentz spaces in the context of weighted inequali-
ties. For further topics on interpolation one may consult the books of Bennett and Sharpley [24],
Bergh and L¨ofstr¨om [25], Sadosky [309], Kislyakov and Kruglyak [194], and Chapter 5 in Stein
and Weiss [348].

Chapter 2
Maximal Functions, Fourier Transform,
and Distributions
We have already seen that the convolution of a function with a ﬁxed density is a
smoothing operation that produces a certain average of the function. Averaging is an
important operation in analysis and naturally arises in many situations. The study of
averages of functions is better understood by the introduction of the maximal func-
tion which is deﬁned as the largest average of a function over all balls containing a
ﬁxed point. Maximal functions are used to obtain almost everywhere convergence
for certain integral averages and play an important role in this area, which is called
differentiation theory. Although maximal functions do not preserve qualitative in-
formation about the given functions, they maintain crucial quantitative information,
a fact of great importance in the subject of Fourier analysis.
Another important operation we study in this chapter is the Fourier transform,
the father of all oscillatory integrals. This is as fundamental to Fourier analysis as
marrow is to the human bone. It is a powerful transformation that carries a func-
tion from its spatial domain to its frequency domain. By doing this, it inverts the
function’s localization properties. If applied one more time, then magically repro-
duces the function composed with a reﬂection. It changes convolution to multipli-
cation, translation to modulation, and expanding dilation to shrinking dilation. Its
decay at inﬁnity encodes information about the local smoothness of the function.
The study of the Fourier transform also motivates the launch of a thorough study
of general oscillatory integrals. We take a quick look at this topic with emphasis on
one-dimensional results.
Distributions suppy a mathematical framework for many operations that do not
exactly qualify to be called functions. These operations found their mathematical
place in the world of functionals applied to smooth functions (called test functions).
These functionals also introduced the correct interpretation for many physical ob-
jects, such as the Dirac delta function. Distributions have become an indispensable
tool in analysis and have enhanced our perspective.
L. Grafakos, Classical Fourier Analysis, Graduate Texts in Mathematics 249,
DOI 10.1007/978-1-4939-1194-3 2, © Springer Science+Business Media New York 2014
85

86
2 Maximal Functions, Fourier Transform, and Distributions
2.1 Maximal Functions
Given a Lebesgue measurable subset A of Rn, we denote by |A| its Lebesgue mea-
sure. For x ∈Rn and r > 0, we denote by B(x,r) the open ball of radius r centered at
x. We also use the notation aB(x,δ) = B(x,aδ), for a > 0, for the ball with the same
center and radius aδ. Given δ > 0 and f a locally integrable function on Rn, let
Avg
B(x,δ)
| f| =
1
|B(x,δ)|

B(x,δ) | f(y)|dy
denote the average of | f| over the ball of radius δ centered at x.
2.1.1 The Hardy–Littlewood Maximal Operator
Deﬁnition 2.1.1. Let f be a locally integrable function on Rn. The function
M( f)(x) = sup
δ>0
Avg
B(x,δ)
| f| = sup
δ>0
1
vnδ n

|y|<δ | f(x−y)|dy
is called the centered Hardy–Littlewood maximal function of f.
Obviously we have M( f) = M(| f|) ≥0; thus the maximal function is a positive
operator. Information concerning cancellation of the function f is lost by passing
to M( f). We show later that M( f) pointwise controls f (i.e., M( f) ≥| f| almost
everywhere). Note that M maps L∞to itself, that is, we have
M( f)

L∞≤
f

L∞.
Let us compute the Hardy–Littlewood maximal function of a speciﬁc function.
Example 2.1.2. On R, let f be the characteristic function of the interval [a,b]. For
x ∈(a,b), clearly M( f) = 1. For x ≥b, a simple calculation shows that the largest
average of f over all intervals (x−δ,x+δ) is obtained when δ = x−a. Similarly,
when x ≤a, the largest average is obtained when δ = b−x. Therefore,
M( f)(x) =
⎧
⎪
⎨
⎪
⎩
(b−a)/2|x−b|
when x ≤a,
1
when x ∈(a,b),
(b−a)/2|x−a|
when x ≥b.
Observe that M( f) has a jump at x = a and x = b equal to one-half that of f.
M is a sublinear operator, i.e., it satisﬁes M( f +g) ≤M( f)+M(g) and M(λ f) =
|λ|M( f) for all locally integrable functions f and g and all complex constants λ. It
also has some interesting properties:

2.1 Maximal Functions
87
If f is locally integrable, then by considering the average of f over the ball
B(x,|x|+R), which contains the ball B(0,R), we obtain
M( f)(x) ≥

B(0,R) | f(y)|dy
vn(|x|+R)n
,
(2.1.1)
for all x ∈Rn, where vn is the volume of the unit ball in Rn. An interesting conse-
quence of (2.1.1) is the following: suppose that f ̸= 0 on a set of positive measure
E, then M( f) is not in L1(Rn). In other words, if f is in L1
loc(Rn) and M( f) is in
L1(Rn), then f = 0 a.e. To see this, integrate (2.1.1) over the ball Rn to deduce that
∥f χB(0,R)∥L1 = 0 and thus f(x) = 0 for almost all x in the ball B(0,R). Since this is
valid for all R = 1,2,3,..., it follows that f = 0 a.e. in Rn.
Another remarkable locality property of M is that if M( f)(x0) = 0 for some x0 in
Rn, then f = 0 a.e. To see we take x = x0 in (2.1.1) to deduce that ∥f χB(0,R)∥L1 = 0
and as before we have that f = 0 a.e. on every ball centered at the origin, i.e., f = 0
a.e. in Rn.
A related analogue of M( f) is its uncentered version M( f), deﬁned as the supre-
mum of all averages of f over all open balls containing a given point.
Deﬁnition 2.1.3. The uncentered Hardy–Littlewood maximal function of f,
M( f)(x) =
sup
δ>0
|y−x|<δ
Avg
B(y,δ)
| f|,
is deﬁned as the supremum of the averages of | f| over all open balls B(y,δ) that
contain the point x.
Clearly M( f) ≤M( f); in other words, M is a larger operator than M. However,
M( f) ≤2nM( f) and the boundedness properties of M are identical to those of M.
Example 2.1.4. On R, let f be the characteristic function of the interval I = [a,b].
For x ∈(a,b), clearly M( f)(x) = 1. For x > b, a calculation shows that the largest
average of f over all intervals (y −δ,y + δ) that contain x is obtained when δ =
1
2(x −a) and y = 1
2(x + a). Similarly, when x < a, the largest average is obtained
when δ = 1
2(b−x) and y = 1
2(b+x). We conclude that
M( f)(x) =
⎧
⎪
⎨
⎪
⎩
(b−a)/|x−b|
when x ≤a,
1
when x ∈(a,b),
(b−a)/|x−a|
when x ≥b.
Observe that M does not have a jump at x = a and x = b and is in fact equal to the
function

1+ dist(x,I)
|I|
−1.
We are now ready to obtain some basic properties of maximal functions. We need
the following simple covering lemma.

88
2 Maximal Functions, Fourier Transform, and Distributions
Lemma 2.1.5. Let {B1,B2,...,Bk} be a ﬁnite collection of open balls in Rn. Then
there exists a ﬁnite subcollection {Bj1,...,Bjl} of pairwise disjoint balls such that
l
∑
r=1
Bjr
 ≥3−n
k
i=1
Bi
.
(2.1.2)
Proof. Let us reindex the balls so that
|B1| ≥|B2| ≥··· ≥|Bk|.
Let j1 = 1. Having chosen j1, j2,..., ji, let ji+1 be the least index s > ji such that
i
m=1 Bjm is disjoint from Bs. Since we have a ﬁnite number of balls, this process will
terminate, say after l steps. We have now selected pairwise disjoint balls Bj1,...,Bjl.
If some Bm was not selected, that is, m /∈{j1,..., jl}, then Bm must intersect a
selected ball Bjr for some jr < m. Then Bm has smaller size than Bjr and we must
have Bm ⫅3Bjr. This shows that the union of the unselected balls is contained in the
union of the triples of the selected balls. Therefore, the union of all balls is contained
in the union of the triples of the selected balls. Thus

k
i=1
Bi
 ≤

l
r=1
3Bjr
 ≤
l
∑
r=1
|3Bjr| = 3n
l
∑
r=1
|Bjr|,
and the required conclusion follows.
□
It was noted earlier that M( f) and M( f) never map into L1. However, it is true
that these functions are in L1,∞when f is in L1. Operators that map L1 to L1,∞are
said to be weak type (1,1). The centered and uncentered maximal functions M and
M are of weak type (1,1) as shown in the next theorem.
Theorem 2.1.6. The uncentered and centered Hardy–Littlewood maximal operators
M and M map L1(Rn) to L1,∞(Rn) with constant at most 3n and also Lp(Rn) to
Lp(Rn) for 1 < p < ∞with constant at most 3n/pp(p −1)−1. For any f ∈L1(Rn)
we also have
	
M( f) > α

 ≤3n
α

{M( f)>α} | f(y)|dy.
(2.1.3)
Proof. We claim that the set Eα = {x ∈Rn : M( f)(x) > α} is open. Indeed, for
x ∈Eα, there is an open ball Bx that contains x such that the average of | f| over Bx
is strictly bigger than α. Then the uncentered maximal function of any other point
in Bx is also bigger than α, and thus Bx is contained in Eα. This proves that Eα is
open.
Let K be a compact subset of Eα. For each x ∈K there exists an open ball Bx
containing the point x such that

Bx
| f(y)|dy > α|Bx|.
(2.1.4)

2.1 Maximal Functions
89
Observe that Bx ⊂Eα for all x. By compactness there exists a ﬁnite subcover
{Bx1,...,Bxk} of K. Using Lemma 2.1.5 we ﬁnd a subcollection of pairwise disjoint
balls Bx j1,...,Bx jl such that (2.1.2) holds. Using (2.1.4) and (2.1.2) we obtain
|K| ≤

k
i=1
Bxi
 ≤3n
l
∑
i=1
|Bx ji| ≤3n
α
l
∑
i=1

Bx ji
| f(y)|dy ≤3n
α

Eα
| f(y)|dy,
since all the balls Bx ji are disjoint and contained in Eα. Taking the supremum over
all compact K ⊆Eα and using the inner regularity of Lebesgue measure, we deduce
(2.1.3). We have now proved that M maps L1 →L1,∞with constant 3n. It is a trivial
fact that M maps L∞→L∞with constant 1. Since M is well deﬁned and ﬁnite a.e.
on L1 + L∞, it is also on Lp(Rn) for 1 < p < ∞. The Marcinkiewicz interpolation
theorem (Theorem 1.3.2) implies that M maps Lp(Rn) to Lp(Rn) for all 1 < p < ∞.
Using Exercise 1.3.3, we obtain the following estimate for the operator norm of M
on Lp(Rn):
M

Lp→Lp ≤p3
n
p
p−1 .
(2.1.5)
Observe that a direct application of Theorem 1.3.2 would give the slightly worse
bound of 2

p
p−1
 1
p 3
n
p . Finally the boundedness of M follows from that of M.
□
Remark 2.1.7. The previous proof gives a bound on the operator norm of M on
Lp(Rn) that grows exponentially with the dimension. One may wonder whether this
bound could be improved to a better one that does not grow exponentially in the
dimension n, as n →∞. This is not possible; see Exercise 2.1.8.
Example 2.1.8. Let R > 0. Then we have
Rn
(|x|+R)n ≤M(χB(0,R))(x) ≤
6n Rn
(|x|+R)n .
(2.1.6)
The lower estimate in (2.1.6), is an easy consequence of the fact that the ball
B(x,|x| + R) contains the ball B(0,R). For the upper estimate, we ﬁrst consider the
case where |x| ≤2R, when clearly M(χB(0,R))(x) ≤1 ≤
3n Rn
(|x|+R)n . In the case where
|x| > 2R, if the balls B(x,r) and B(0,R) intersect, we must have that r > |x|−R. But
note that |x|−R > 1
3(|x|+R), since |x| > 2R. We conclude that for |x| > 2R we have
M(χB(0,R))(x) ≤sup
r>0
|B(x,r)∩B(0,R)|
|B(x,r)|
≤
sup
r>|x|−R
vnRn
vnrn ≤
Rn
 1
3(|x|+R)
n
and thus the upper estimate in (2.1.6) holds since M(χB(0,R)) ≤2nM(χB(0,R)). Thus
in both cases the upper estimate in (2.1.6) is valid.
Next we estimate M(M(χB(0,R)))(x). First we write
Rn
(|x|+R)n ≤χB(0,R) +
∞
∑
k=0
Rn
(R+2kR)n χB(0,2k+1R)\B(0,2kR) .

90
2 Maximal Functions, Fourier Transform, and Distributions
Using the upper estimate in (2.1.6) and the sublinearity of M, we obtain
M

Rn
(|·|+R)n

(x) ≤M(χB(0,R))(x)+
∞
∑
k=0
1
(1+2k)n M(χB(0,2k+1R))(x)
≤
6n Rn
(|x|+R)n +
∞
∑
k=0
1
2nk
6n (2k+1R)n
(|x|+2k+1R)n
≤Cn log(e+|x|/R)
(1+|x|/R)n
,
where the last estimate follows by summing separately over k satisfying 2k+1 ≤|x|/R
and 2k+1 ≥|x|/R. Note that the presence of the logarithm does not affect the Lp
boundedness of this function when p > 1.
2.1.2 Control of Other Maximal Operators
We now study some properties of the Hardy–Littlewood maximal function. We
begin with a notational deﬁnition that we plan to use throughout this book.
Deﬁnition 2.1.9. Given a function g on Rn and ε > 0, we denote by gε the following
function:
gε(x) = ε−ng(ε−1x).
(2.1.7)
As observed in Example 1.2.17, if g is an integrable function with integral equal
to 1, then the family deﬁned by (2.1.7) is an approximate identity. Therefore, convo-
lution with gε is an averaging operation. The Hardy–Littlewood maximal function
M( f) is obtained as the supremum of the averages of a function f with respect to
the dilates of the kernel k = v−1
n χB(0,1) in Rn; here vn is the volume of the unit ball
B(0,1). Indeed, we have
M( f)(x) = sup
ε>0
1
vnεn

Rn | f(x−y)|χB(0,1)
 y
ε

dy
= sup
ε>0
(| f|∗kε)(x).
Note that the function k = v−1
n χB(0,1) has integral equal to 1, and convolving with kε
is an averaging operation.
It turns out that the Hardy–Littlewood maximal function controls the averages of
a function with respect to any radially decreasing L1 function. Recall that a function
f on Rn is called radial if f(x) = f(y) whenever |x| = |y|. Note that a radial func-
tion f on Rn has the form f(x) = ϕ(|x|) for some function ϕ on R+. We have the
following result.

2.1 Maximal Functions
91
Theorem 2.1.10. Let k ≥0 be a function on [0,∞) that is continuous except at a
ﬁnite number of points. Suppose that K(x) = k(|x|) is an integrable function on Rn
that satisﬁes
K(x) ≥K(y),
whenever |x| ≤|y|,
(2.1.8)
i.e., k is decreasing. Then the following estimate is true:
sup
ε>0
(| f|∗Kε)(x) ≤
K

L1M( f)(x)
(2.1.9)
for all locally integrable functions f on Rn.
Proof. We prove (2.1.9) when K is radial, satisﬁes (2.1.8), and is compactly sup-
ported and continuous. When this case is established, select a sequence Kj of radial,
compactly supported, continuous functions that increase to K as j →∞. This is pos-
sible, since the function k is continuous except at a ﬁnite number of points. If (2.1.9)
holds for each Kj, passing to the limit implies that (2.1.9) also holds for K. Next,
we observe that it sufﬁces to prove (2.1.9) for x = 0. When this case is established,
replacing f(t) by f(t +x) implies that (2.1.9) holds for all x.
Let us now ﬁx a radial, continuous, and compactly supported function K with
support in the ball B(0,R), satisfying (2.1.8). Also ﬁx an f ∈L1
loc and take x = 0. Let
e1 be the vector (1,0,0,...,0) on the unit sphere Sn−1. Polar coordinates give

Rn | f(y)|Kε(−y)dy =
 ∞
0

Sn−1 | f(rθ)|Kε(re1)rn−1 dθ dr.
(2.1.10)
Deﬁne functions
F(r) =

Sn−1 | f(rθ)|dθ ,
G(r) =
 r
0 F(s)sn−1 ds,
where dθ denotes surface measure on Sn−1. Using these functions, (2.1.10), and
integration by parts, we obtain

Rn | f(y)|Kε(y)dy =
 εR
0
F(r)rn−1Kε(re1)dr
= G(εR)Kε(εRe1)−G(0)Kε(0)−
 εR
0
G(r)dKε(re1)
=
 ∞
0 G(r)d(−Kε(re1)),
(2.1.11)
where two of the integrals are of Lebesgue–Stieltjes type and we used our assump-
tions that G(0) = 0, Kε(0) < ∞, G(εR) < ∞, and Kε(εRe1) = 0. Let vn be the volume
of the unit ball in Rn. Since
G(r) =
 r
0 F(s)sn−1 ds =

|y|≤r | f(y)|dy ≤M( f)(0)vnrn ,

92
2 Maximal Functions, Fourier Transform, and Distributions
it follows that the expression in (2.1.11) is dominated by
M( f)(0)vn
 ∞
0 rnd(−Kε(re1)) = M( f)(0)
 ∞
0 nvnrn−1Kε(re1)dr
= M( f)(0)
K

L1 .
Here we used integration by parts and the fact that the surface measure of the unit
sphere Sn−1 is equal to nvn. See Appendix A.3. The theorem is now proved.
□
Remark 2.1.11. Theorem 2.1.10 can be generalized as follows. If K is an L1 function
on Rn such that |K(x)| ≤k0(|x|) = K0(x), where k0 is a nonnegative decreasing func-
tion on [0,∞) that is continuous except at a ﬁnite number of points, then (2.1.9) holds
with ∥K∥L1 replaced by ∥K0∥L1. Such a K0 is called a radial decreasing majorant of
K. This observation is formulated as the following corollary.
Corollary 2.1.12. If a function ϕ has an integrable radially decreasing majorant Φ,
then the estimate
sup
t>0
|( f ∗ϕt)(x)| ≤
Φ

L1M( f)(x)
is valid for all locally integrable functions f on Rn.
Example 2.1.13. Let
P(x) =
cn
(1+|x|2)
n+1
2
,
where cn is a constant such that

Rn P(x)dx = 1.
The function P is called the Poisson kernel. We deﬁne L1 dilates Pt of the Poisson
kernel P by setting
Pt(x) = t−nP(t−1x)
for t > 0. It is straightforward to verify that when n ≥2,
d2
dt2 Pt +
n
∑
j=1
∂2
j Pt = 0,
that is, Pt(x1,...,xn) is a harmonic function of the variables (x1,...,xn,t). Therefore,
for f ∈Lp(Rn), 1 ≤p < ∞, the function
u(x,t) = ( f ∗Pt)(x)
is harmonic in Rn+1
+
and converges to f(x) in Lp(dx) as t →0, since {Pt}t>0 is an
approximate identity. If we knew that f ∗Pt converged to f a.e. as t →0, then we
could say that u(x,t) solves the Dirichlet problem

2.1 Maximal Functions
93
∂2
t u+
n
∑
j=1
∂2
j u = 0
on Rn+1
+ ,
u(x,0) = f(x)
a.e. on Rn.
(2.1.12)
Solving the Dirichlet problem (2.1.12) motivates the study of the almost everywhere
convergence of the expressions f ∗Pt.
Let us now compute the value of the constant cn. Denote by ωn−1 the surface area
of Sn−1. Using polar coordinates, we obtain
1
cn
=

Rn
dx
(1+|x|2)
n+1
2
= ωn−1
 ∞
0
rn−1
(1+r2)
n+1
2
dr
= ωn−1
 π/2
0
(sinϕ)n−1 dϕ
(r = tanϕ)
= 2π
n
2
Γ ( n
2)
1
2
Γ ( n
2)Γ ( 1
2)
Γ ( n+1
2 )
=
π
n+1
2
Γ ( n+1
2 ) ,
where we used the formula for ωn−1 in Appendix A.3 and an identity in Appendix
A.4. We conclude that
cn = Γ ( n+1
2 )
π
n+1
2
and that the Poisson kernel on Rn is given by
P(x) = Γ ( n+1
2 )
π
n+1
2
1
(1+|x|2)
n+1
2
.
(2.1.13)
Theorem 2.1.10 implies that the solution of the Dirichlet problem (2.1.12) is point-
wise bounded by the Hardy–Littlewood maximal function of f.
2.1.3 Applications to Differentiation Theory
We continue this section by obtaining some applications of the boundedness of the
Hardy–Littlewood maximal function in differentiation theory.

94
2 Maximal Functions, Fourier Transform, and Distributions
We now show that the weak type (1,1) property of the Hardy–Littlewood max-
imal function implies almost everywhere convergence for a variety of families of
functions. We deduce this from the more general fact that a certain weak type prop-
erty for the supremum of a family of linear operators implies almost everywhere
convergence.
Here is our setup. Let (X,μ), (Y,ν) be measure spaces and let 0 < p ≤∞, 0 <
q < ∞. Suppose that D is a dense subspace of Lp(X,μ). This means that for all
f ∈Lp and all δ > 0 there exists a g ∈D such that ∥f −g∥Lp < δ. Suppose that for
every ε > 0, Tε is a linear operator that maps Lp(X,μ) into a subspace of measurable
functions, which are deﬁned everywhere on Y. For y ∈Y, deﬁne a sublinear operator
T∗( f)(y) = sup
ε>0
|Tε( f)(y)|
(2.1.14)
and assume that T∗( f) is ν- measurable for any f ∈Lp(X,μ). We have the following.
Theorem 2.1.14. Let 0 < p < ∞, 0 < q < ∞, and Tε and T∗as previously. Suppose
that for some B > 0 and all f ∈Lp(X) we have
T∗( f)

Lq,∞≤B
 f

Lp
(2.1.15)
and that for all f ∈D,
lim
ε→0Tε( f) = T( f)
(2.1.16)
exists and is ﬁnite ν-a.e. (and deﬁnes a linear operator on D). Then for all func-
tions f in Lp(X,μ) the limit (2.1.16) exists and is ﬁnite ν-a.e., and deﬁnes a linear
operator T on Lp(X) (uniquely extending T deﬁned on D) that satisﬁes
T( f)

Lq,∞≤B
f

Lp
(2.1.17)
for all functions f in Lp(X).
Proof. Given f in Lp, we deﬁne the oscillation of f:
Of (y) = limsup
ε→0
limsup
θ→0
|Tε( f)(y)−Tθ( f)(y)|.
We would like to show that for all f ∈Lp and δ > 0,
ν({y ∈Y : Of (y) > δ}) = 0.
(2.1.18)
Once (2.1.18) is established, given f ∈Lp(X), we obtain that Of (y) = 0 for ν-almost
all y, which implies that Tε( f)(y) is Cauchy for ν-almost all y, and it therefore
converges ν-a.e. to some T( f)(y) as ε →0. The operator T deﬁned this way on
Lp(X) is linear and extends T deﬁned on D.
To approximate Of we use density. Given η > 0, ﬁnd a function g ∈D such that
∥f −g∥Lp < η. Since Tε(g) →T(g) ν-a.e, it follows that Og = 0 ν-a.e. Using this
fact and the linearity of the Tε’s, we conclude that
Of (y) ≤Og(y)+Of−g(y) = Of−g(y)
ν-a.e.

2.1 Maximal Functions
95
Now for any δ > 0 we have
ν({y ∈Y : Of (y) > δ}) ≤ν({y ∈Y : Of−g(y) > δ})
≤ν({y ∈Y : 2T∗( f −g)(y) > δ})
≤

2B
 f −g

Lp/δ
q
≤(2Bη/δ)q .
Letting η →0, we deduce (2.1.18). We conclude that Tε( f) is a Cauchy sequence,
and hence it converges ν-a.e. to some T( f). Since |T( f)| ≤|T∗( f)|, the conclusion
(2.1.17) of the theorem follows easily.
□
We now derive some applications. First we return to the issue of almost every-
where convergence of the expressions f ∗Py, where P is the Poisson kernel.
Example 2.1.15. Fix 1 ≤p < ∞and f ∈Lp(Rn). Let
P(x) = Γ ( n+1
2 )
π
n+1
2
1
(1+|x|2)
n+1
2
be the Poisson kernel on Rn and let Pε(x) = ε−nP(ε−1x). We deduce from the previ-
ous theorem that the family f ∗Pε converges to f a.e. Let D be the set of all contin-
uous functions with compact support on Rn. Since the family (Pε)ε>0 is an approx-
imate identity, Theorem 1.2.19 (2) implies that for f in D we have that f ∗Pε →f
uniformly on compact subsets of Rn and hence pointwise everywhere. In view of
Theorem 2.1.10, the supremum of the family of linear operators Tε( f) = f ∗Pε is
controlled by the Hardy–Littlewood maximal function, and thus it maps Lp to Lp,∞
for 1 ≤p < ∞. Theorem 2.1.14 now gives that f ∗Pε converges to f a.e. for all f ∈Lp.
Here is another application of Theorem 2.1.14. Exercise 2.1.10 contains other ap-
plications.
Corollary 2.1.16. (Lebesgue’s differentiation theorem) For any locally integrable
function f on Rn we have
lim
r→0
1
|B(x,r)|

B(x,r) f(y)dy = f(x)
(2.1.19)
for almost all x in Rn. Consequently we have | f| ≤M( f) a.e. There is also an
analogous statement to (2.1.19) in which balls are replaced by cubes centered at x.
Precisely, for any locally integrable function f on Rn we have
lim
r→0
1
(2r)n

x+[−r,r]n f(y)dy = f(x)
(2.1.20)
for almost all x in Rn.

96
2 Maximal Functions, Fourier Transform, and Distributions
Proof. Since Rn is the union of the balls B(0,N) for N = 1,2,3..., it sufﬁces to
prove the required conclusion for almost all x inside a ﬁxed ball B(0,N). Given a
locally integrable function f on Rn, consider the function fN = f χB(0,N+1). Then
fN lies in L1(Rn). Let Tε be the operator given with convolution with kε, where
k = v−1
n χB(0,1) and 0 < ε < 1. We know that the corresponding maximal operator T∗
is controlled by the centered Hardy–Littlewood maximal function M, which maps L1
to L1,∞. It is straightforward to verify that (2.1.19) holds for all continuous functions
f with compact support. Since this set of functions is dense in L1, and T∗maps L1
to L1,∞, Theorem 2.1.14 implies that (2.1.19) holds for all integrable functions on Rn,
in particular for fN. But for 0 < ε < 1 and x ∈B(0,N) we have f χB(x,ε) = fNχB(x,ε),
so it follows that
lim
ε→0
1
|B(x,ε)|

B(x,ε) f(y)dy = lim
ε→0
1
|B(x,ε)|

B(x,ε) fN(y)dy = fN(x)
for almost all x ∈Rn, in particular for almost all x in B(0,N). But on this set fN = f,
so the required conclusion follows. The assertion that | f| ≤M( f) a.e. is an easy
consequence of (2.1.19) when the limit is replaced by a supremum.
Finally, with minor modiﬁcations, the proof can be adjusted to work for cubes in
place of balls. To prove (2.1.20), for f ∈L1
loc(Rn) we introduce the maximal operator
Mc( f)(x) = sup
r>0
1
(2r)n

x+[−r,r]n | f(y)|dy.
Then Exercise 2.1.3 yields that Mc maps L1(Rn) to weak L1(Rn) and the preceding
proof with Mc in place of M yields (2.1.20).
□
The following corollaries were inspired by Example 2.1.15.
Corollary 2.1.17. (Differentiation theorem for approximate identities) Let K be an
L1 function on Rn with integral 1 that has a continuous integrable radially decreas-
ing majorant. Then f ∗Kε →f a.e. as ε →0 for all f ∈Lp(Rn), 1 ≤p < ∞.
Proof. It follows from Example 1.2.17 that Kε is an approximate identity. Theorem
1.2.19 now implies that f ∗Kε →f uniformly on compact sets when f is continuous.
Let D be the space of all continuous functions with compact support. Then f ∗Kε →
f a.e. for f ∈D. It follows from Corollary 2.1.12 that T∗( f) = supε>0 | f ∗Kε| maps
Lp to Lp,∞for 1 ≤p < ∞. Using Theorem 2.1.14, we conclude the proof of the
corollary.
□
Remark 2.1.18. Fix f ∈Lp(Rn) for some 1 ≤p < ∞. Theorem 1.2.19 implies that
f ∗Kε converges to f in Lp and hence some subsequence f ∗Kεn of f ∗Kε converges
to f a.e. as n →∞, (εn →0). Compare this result with Corollary 2.1.17, which gives
a.e. convergence for the whole family f ∗Kε as ε →0.
Corollary 2.1.19. (Differentiation theorem for multiples of approximate identi-
ties) Let K be a function on Rn that has an integrable radially decreasing majorant.

2.1 Maximal Functions
97
Let a =

Rn K(x)dx. Then for all f ∈Lp(Rn) and 1 ≤p < ∞, ( f ∗Kε)(x) →af(x)
for almost all x ∈Rn as ε →0.
Proof. Use Theorem 1.2.21 instead of Theorem 1.2.19 in the proof of Corollary
2.1.17.
□
The following application of the Lebesgue differentiation theorem uses a simple
stopping-time argument. This is the sort of argument in which a selection procedure
stops when it is exhausted at a certain scale and is then repeated at the next scale. A
certain reﬁnement of the following proposition is of fundamental importance in the
study of singular integrals given in Chapter 4.
Proposition 2.1.20. Given a nonnegative integrable function f on Rn and α > 0,
there exists a collection of disjoint (possibly empty) open cubes Q j such that for
almost all x ∈

j Qj
c we have f(x) ≤α and
α <
1
|Qj|

Qj
f(t)dt ≤2nα .
(2.1.21)
Proof. The proof provides an excellent paradigm of a stopping-time argument. Start
by decomposing Rn as a union of cubes of equal size, whose interiors are disjoint,
and whose diameter is so large that |Q|−1 
Q f(x)dx ≤α for every Q in this mesh.
This is possible since f is integrable and |Q|−1 
Q f(x)dx →0 as |Q| →∞. Call the
union of these cubes E0.
Divide each cube in the mesh into 2n congruent cubes by bisecting each of the
sides. Call the new collection of cubes E1. Select a cube Q in E1 if
1
|Q|

Q f(x)dx > α
(2.1.22)
and call the set of all selected cubes S1. Now subdivide each cube in E1 \ S1 into
2n congruent cubes by bisecting each of the sides as before. Call this new collection
of cubes E2. Repeat the same procedure and select a family of cubes S2 that satisfy
(2.1.22). Continue this way ad inﬁnitum and call the cubes in ∞
m=1 Sm “selected.”
If Q was selected, then there exists Q1 in Em−1 containing Q that was not selected at
the (m−1)th step for some m ≥1. Therefore,
α < 1
|Q|

Q f(x)dx ≤2n 1
|Q1|

Q1
f(x)dx ≤2nα .
Now call F the closure of the complement of the union of all selected cubes. If
x ∈F, then there exists a sequence of cubes containing x whose diameter shrinks
down to zero such that the average of f over these cubes is less than or equal to α.
By Corollary 2.1.16, it follows that f(x) ≤α almost everywhere in F. This proves
the proposition.
□
In the proof of Proposition 2.1.20 it was not crucial to assume that f was deﬁned
on all Rn, but only on a cube. We now give a local version of this result.

98
2 Maximal Functions, Fourier Transform, and Distributions
Corollary 2.1.21. Let f ≥0 be an integrable function over a cube Q in Rn and let
α ≥
1
|Q|

Q f dx. Then there exist disjoint (possibly empty) open subcubes Q j of Q
such that for almost all x ∈Q\ 
j Qj we have f ≤α and (2.1.21) holds for all Qj.
Proof. The proof easily follows by a simple modiﬁcation of Proposition 2.1.20 in
which Rn is replaced by the ﬁxed cube Q. To apply Corollary 2.1.16, we extend f to
be zero outside the cube Q.
□
See Exercise 2.1.4 for an application of Proposition 2.1.20 involving maximal
functions.
Exercises
2.1.1. A positive Borel measure μ on Rn is called inner regular if for any open
subset U of Rn we have μ(U) = sup{μ(K) : K ⫅U, K compact} and μ is called
locally ﬁnite if μ(B) < ∞for all balls B.
(a) Let μ be a positive inner regular locally ﬁnite measure on Rn that satisﬁes the
following doubling condition: There exists a constant D(μ) > 0 such that for all
x ∈Rn and r > 0 we have
μ(3B(x,r)) ≤D(μ)μ(B(x,r)).
For f ∈L1
loc(Rn,μ) deﬁne the uncentered maximal function Mμ( f) with respect to
μ by
Mμ( f)(x) = sup
r>0
sup
z: |z−x|<r
μ(B(z,r))̸=0
1
μ(B(z,r))

B(z,r) f(y)dμ(y).
Show that Mμ maps L1(Rn,μ) to L1,∞(Rn,μ) with constant at most D(μ) and
Lp(Rn,μ) to itself with constant at most 2

p
p−1
 1
p D(μ)
1
p .
(b) Obtain as a consequence a differentiation theorem analogous to Corollary 2.1.16.

Hint: Part (a): For f ∈L1(Rn,μ) show that the set Eα = {Mμ( f) > α} is open.
Then use the argument of the proof of Theorem 2.1.6 and the inner regularity of μ.

2.1.2. On R consider the maximal function Mμ of Exercise 2.1.1.
(a) (W. H. Young) Prove the following covering lemma. Given a ﬁnite set F of open
intervals in R, prove that there exist two subfamilies each consisting of pairwise dis-
joint intervals such that the union of the intervals in the original family is equal to the
union of the intervals of both subfamilies. Use this result to show that the maximal
function Mμ of Exercise 2.1.1 maps L1(μ) →L1,∞(μ) with constant at most 2.

2.1 Maximal Functions
99
(b) ([134]) Prove that for any σ-ﬁnite positive measure μ on R, α > 0, and f ∈
L1
loc(R,μ) we have
1
α

A | f|dμ −μ(A) ≤1
α

{| f|>α} | f|dμ −μ({| f| > α}).
Use this result and part (a) to prove that for all α > 0 and all locally integrable f we
have
μ({| f| > α})+ μ({Mμ( f) > α}) ≤1
α

{| f|>α} | f|dμ + 1
α

{Mμ( f)>α} | f|dμ
and note that equality is obtained when α = 1 and f(x) = |x|−1/p.
(c) Conclude that Mμ maps Lp(μ) to Lp(μ), 1 < p < ∞, with bound at most the
unique positive solution Ap of the equation
(p−1)xp −pxp−1 −1 = 0.
(d) ([136]) If μ is the Lebesgue measure show that for 1 < p < ∞we have
M

Lp→Lp = Ap ,
where Ap is the unique positive solution of the equation in part (c).

Hint: Part (a): Select a subset G of F with minimal cardinality such that 
J∈G J =

I∈F I. Part (d): One direction follows from part (c). Conversely, M(|x|−1/p)(1) =
p
p−1
γ1/p′+1
γ+1 , where γ is the unique positive solution of the equation
p
p−1
γ1/p′+1
γ+1
=
γ−1/p. Conclude that M(|x|−1/p)(1) = Ap and that M(|x|−1/p) = Ap|x|−1/p. Since
this function is not in Lp, consider the family fε(x) = |x|−1/p min(|x|−ε,|x|ε), ε > 0,
and show that M( fε)(x) ≥(1+γ
1
p′ +ε)(1+γ)−1( 1
p′ +ε)−1 fε(x) for 0 < ε < p′.

2.1.3. Deﬁne the centered Hardy–Littlewood maximal function Mc and the uncen-
tered Hardy–Littlewood maximal function Mc using cubes with sides parallel to the
axes instead of balls in Rn. Prove that
1 ≤M( f)
M( f) ≤2n ,
1
n
n
2
2n
vn
≤M( f)
Mc( f) ≤2n
vn
,
1
n
n
2
2n
vn
≤M( f)
Mc( f) ≤2n
vn
,
where vn is the volume of the unit ball in Rn. Conclude that Mc and Mc are weak
type (1,1) and they map Lp(Rn) to Lp(Rn) for 1 < p ≤∞.
2.1.4. (a) Prove the estimate:
|{x ∈Rn : M( f)(x) > 2α}| ≤3n
α

{| f|>α} | f(y)|dy
and conclude that M maps Lp to Lp,∞with norm at most 2·3n/p for 1 ≤p < ∞.

100
2 Maximal Functions, Fourier Transform, and Distributions
(b) Deduce that if f log+(2| f|) is integrable over a ball B, then M( f) is integrable
over the same ball B.
(c) ([375], [336]) Apply Proposition 2.1.20 to | f| and α > 0 and Exercise 2.1.3 to
show that with cn = 2n(nn/2vn)−1 we have
|{x ∈Rn : M( f)(x) > cn α}| ≥2−n
α

{| f|>α} | f(y)|dy.
(d) Suppose that f is integrable and supported in a ball B(0,ρ). Show that for x in
B(0,2ρ)\B(0,ρ) we have M( f)(x) ≤M( f)(ρ2|x|−2x). Conclude that

B(0,2ρ) M( f)dx ≤(4n +1)

B(0,ρ) M( f)dx
and from this deduce a similar inequality for M( f).
(e) Suppose that f is integrable and supported in a ball B and that M( f) is integrable
over B. Let λ0 = 2n|B|−1∥f∥L1. Use part (b) to prove that f log+(λ −1
0 cn | f|) is inte-
grable over B.

Hint: Part (a): Write f = f χ| f|>α + f χ| f|≤α. Part (b): Show that M( f χE) is inte-
grable over B, where E = {| f| ≥1/2}. Part (c): Use Proposition 2.1.20. Part (d): Let
x′ = ρ2|x|−2x for some ρ < |x| < 2ρ. Show that for R > |x|−ρ, we have that

B(x,R) | f(z)|dz ≤

B(x′,R) | f(z)|dz
by showing that B(x,R)∩B(0,ρ) ⊂B(x′,R). Part (e): For x /∈2B we have M( f)(x) ≤
λ0, hence

2B M( f)(x)dx ≥
 ∞
λ0 |{x ∈2B : M( f)(x) > α}|dα.

2.1.5. (A. Kolmogorov) Let S be a sublinear operator that maps L1(Rn) to L1,∞(Rn)
with norm B. Suppose that f ∈L1(Rn). Prove that for any set A of ﬁnite Lebesgue
measure and for all 0 < q < 1 we have

A |S( f)(x)|q dx ≤(1−q)−1Bq|A|1−q f
q
L1,
and in particular, for the Hardy–Littlewood maximal operator,

A M( f)(x)q dx ≤(1−q)−13nq|A|1−qf
q
L1 .

Hint: Use the identity

A |S( f)(x)|q dx =
 ∞
0 qαq−1|{x∈A : S( f)(x)>α}|dα
and estimate the last measure by min(|A|, B
α ∥f∥L1).


2.1 Maximal Functions
101
2.1.6. Let Ms( f)(x) be the supremum of the averages of | f| over all rectangles with
sides parallel to the axes containing x. The operator Ms is called the strong maximal
function.
(a) Prove that Ms maps Lp(Rn) to itself.
(b) Show that the operator norm of Ms is An
p, where Ap is as in Exercise 2.1.2 (c).
(c) Prove that Ms is not weak type (1,1).
2.1.7. Prove that if
|ϕ(x1,...,xn)| ≤A(1+|x1|)−1−ε ···(1+|xn|)−1−ε
for some A,ε > 0, and ϕt1,...,tn(x) = t−1
1
···t−1
n ϕ(t−1
1 x1,...,t−1
n xn), then the maximal
operator
f →
sup
t1,...,tn>0
| f ∗ϕt1,...,tn|
is pointwise controlled by the strong maximal function.
2.1.8. Prove that for any ﬁxed 1 < p < ∞, the operator norm of M on Lp(Rn) tends
to inﬁnity as n →∞.

Hint: Let f0 be the characteristic function of the unit ball in Rn. Consider the aver-
ages |Bx|−1 
Bx f0 dy, where Bx = B
 1
2(|x|−|x|−1) x
|x|, 1
2(|x|+|x|−1)

for |x| > 1.

2.1.9. (a) In R2 let M0( f)(x) be the maximal function obtained by taking the supre-
mum of the averages of | f| over all rectangles (of arbitrary orientation) containing
x. Prove that M0 is not bounded on Lp(Rn) for p ≤2 and conclude that M0 is not
weak type (1,1).
(b) Let M00( f)(x) be the maximal function obtained by taking the supremum of the
averages of | f| over all rectangles in R2 of arbitrary orientation but ﬁxed eccentricity
containing x. (The eccentricity of a rectangle is the ratio of its longer side to its
shorter side.) Using a covering lemma, show that M00 is weak type (1,1) with a
bound proportional to the square of the eccentricity.
(c) On Rn deﬁne a maximal function by taking the supremum of the averages
of | f| over all products of intervals I1 × ··· × In containing a point x with |I2| =
a2|I1|,...,|In| = an|I1| and a2,...,an > 0 ﬁxed. Show that this maximal function is
of weak type (1,1) with bound independent of the numbers a2,...,an.

Hint: Part (b): Let b be the eccentricity. If two rectangles with the same eccentricity
intersect, then the smaller one is contained in the bigger one scaled 4b times. Then
use an argument similar to that in Lemma 2.1.5.

2.1.10. (a) Let 0 < p,q < ∞and let X,Y be measure spaces. Suppose that Tε are
maps from Lp(X) to Lq,∞(Y) satisfy |Tε( f +g)| ≤K(|Tε( f)|+|Tε(g)|) for all ε > 0
and all f,g ∈Lp(X), and also limε→0 Tε( f) = 0 a.e. for all f in some dense subspace
D of Lp(X). Assume furthermore that the maximal operator T∗( f) = supε>0 |Tε( f)|
maps Lp(X) to Lq,∞(Y). Prove that limε→0 Tε( f) = 0 a.e. for all f in Lp(X).
(b) Use the result in part (a) to prove the following version of the Lebesgue differ-
entiation theorem: Let f ∈Lp(Rn) for some 0 < p < ∞. Then for almost all x ∈Rn
we have

102
2 Maximal Functions, Fourier Transform, and Distributions
lim
|B|→0
B∋x
1
|B|

B |g(y)−g(x)|p dy = 0,
where the limit is taken over all open balls B containing x and shrinking to {x}.
(c) Conclude that for any f in L1
loc(Rn) and for almost all x ∈Rn we have
lim
|B|→0
B∋x
1
|B|

B f(y)dy = f(x),
where the limit is taken over all open balls B containing x and shrinking to {x}.

Hint: (a) Deﬁne an oscillation Of (y) = limsupε→0 |Tε( f)(y)|. For all f in Lp(X)
and g ∈D we have that Of (y) ≤KOf−g(y). Then use the argument in the proof of
Theorem 2.1.14. (b) Apply part (a) with
Tε( f)(x) =
sup
B(z,ε)∋x

1
|B(z,ε)|

B(z,ε) | f(y)−f(x)|p dy
1/p
,
observing that T∗( f) = supε>0 Tε( f) ≤max(1,2
1−p
p )

| f|+M(| f|p)
1
p 
. (c) Follows
from part (b) with p = 1. Note that part (b) can be proved without part (a) but using
part (c) as follows: for every rational number a there is a set Ea of Lebesgue measure
zero such that for x ∈Rn \Ea we have limB∋x,|B|→0
1
|B|

B |g(y)−a|p dy = |g(x)−a|p,
since the function y →| f(y)−a|p is in L1
loc(Rn). By considering an enumeration of
the rationals, ﬁnd a set of measure zero E such for x /∈E the preceding limit exists
for all rationals a and by continuity for all real numbers a, in particular for a = g(x).

2.1.11. Let f be in L1(R). Deﬁne the right maximal function MR( f) and the left
maximal function ML( f) as follows:
ML( f)(x) = sup
r>0
1
r
 x
x−r | f(t)|dt ,
MR( f)(x) = sup
r>0
1
r
 x+r
x
| f(t)|dt .
(a) Show that for all α > 0 and f ∈L1(R) we have
|{x ∈R : ML( f)(x) > α}| = 1
α

{ML( f)>α} | f(t)|dt ,
|{x ∈R : MR( f)(x) > α}| = 1
α

{MR( f)>α} | f(t)|dt .
(b) Extend the deﬁnition of ML( f) and MR( f) for f ∈Lp(R) for 1 ≤p ≤∞. Show
that ML and MR map Lp to Lp with norm at most p/(p−1) for all p with 1 < p < ∞.
(c) Construct examples to show that the operator norms of ML and MR on Lp(R) are
exactly p/(p−1) for 1 < p < ∞.

2.1 Maximal Functions
103
(d) Prove that M = max(MR,ML).
(e) Let N = min(MR,ML). Obtain the following consequence of part (a),

R M( f)p +N( f)p dx =
p
p−1

R | f|

M( f)p−1 +N( f)p−1
dx,
(f) Use part (e) to prove that
(p−1)
M( f)
p
Lp −p
f

Lp
M( f)
p−1
Lp
−
f
p
Lp ≤0.

Hint: (a) Write the set Eα = {MR( f) > α} as a union of open intervals (aj,bj).
For each x in (aj,bj), let Nx =
	
s ∈R :
 s
x | f| > α(s−x)

∩(x,bj]. Show that Nx is
nonempty and that supNx = bj for every x ∈(aj,bj). Conclude that
 b j
a j | f(t)|dt ≥
α(bj −aj), which implies that each aj is ﬁnite. For the reverse inequality use that
aj /∈Eα. Part (d) is due to K. L. Phillips. (e) First obtain a version of the equality
with MR in the place of M and ML in the place of N. Then use that M( f)q +N( f)q =
ML( f)q +MR( f)q for all q. (f) Use that | f|N( f)p−1 ≤1
p| f|p + 1
p′ N( f)p. This alter-
native proof of the result in Exercise 2.1.2(c) was suggested by J. Duoandikoetxea.

2.1.12. A cube Q = [a12k,(a1 + 1)2k) × ··· × [an2k,(an + 1)2k) on Rn is called
dyadic if k, a1,...,an ∈Z. Observe that either two dyadic cubes are disjoint or one
contains the other. Deﬁne the dyadic maximal function
Md( f)(x) = sup
Q∋x
1
|Q|

Q f(y)dy,
where the supremum is taken over all dyadic cubes Q containing x.
(a) Prove that Md maps L1 to L1,∞with constant at most one. Presicely, show that for
all α > 0 and f ∈L1(Rn) we have
|{x ∈Rn : Md( f)(x) > α}| ≤1
α

{Md( f)>α} f(t)dt .
(b) Conclude that Md maps Lp(Rn) to itself with constant at most p/(p−1).
2.1.13. Observe that the proof of Theorem 2.1.6 yields the estimate
λ|{M( f) > λ}|
1
p ≤3n|{M( f) > λ}|−1+ 1
p

{M( f)>λ} | f(y)|dy
for λ > 0 and f locally integrable. Use the result of Exercise 1.1.12(a) to prove that
the Hardy–Littlewood maximal operator M maps the space Lp,∞(Rn) to itself for
1 < p < ∞.

104
2 Maximal Functions, Fourier Transform, and Distributions
2.1.14. Let K(x) = (1+|x|)−n−δ be deﬁned on Rn. Prove that there exists a constant
Cn,δ such that for all ε0 > 0 we have the estimate
sup
ε>ε0
(| f|∗Kε)(x) ≤Cn,δ sup
ε>ε0
1
εn

|y−x|≤ε | f(y)|dy,
for all f locally integrable on Rn.

Hint: Apply only a minor modiﬁcation to the proof of Theorem 2.1.10.

2.2 The Schwartz Class and the Fourier Transform
In this section we introduce the single most important tool in harmonic analysis, the
Fourier transform. It is often the case that the Fourier transform is introduced as an
operation on L1 functions. In this exposition we ﬁrst deﬁne the Fourier transform
on a smaller class, the space of Schwartz functions, which turns out to be a very
natural environment. Once the basic properties of the Fourier transform are derived,
we extend its deﬁnition to other spaces of functions.
We begin with some preliminaries. Given x = (x1,...,xn) ∈Rn, we set |x| =
(x2
1 + ··· + x2
n)1/2. The partial derivative of a function f on Rn with respect to the
jth variable xj is denoted by ∂j f while the mth partial derivative with respect to
the jth variable is denoted by ∂m
j f. The gradient of a function f is the vector ∇f =
(∂1 f,...,∂n f). A multi-index α is an ordered n-tuple of nonnegative integers. For
a multi-index α = (α1,...,αn), ∂α f denotes the derivative ∂α1
1 ···∂αn
n f. If α =
(α1,...,αn) is a multi-index, |α| = α1+···+αn denotes its size and α! = α1!···αn!
denotes the product of the factorials of its entries. The number |α| indicates the total
order of differentiation of ∂α f. The space of functions in Rn all of whose derivatives
of order at most N ∈Z+ are continuous is denoted by C N(Rn) and the space of all
inﬁnitely differentiable functions on Rn by C ∞(Rn). The space of C ∞functions with
compact support on Rn is denoted by C ∞
0 (Rn). This space is nonempty; see Exercise
2.2.1(a).
For x ∈Rn and α = (α1,...,αn) a multi-index, we set xα = xα1
1 ···xαn
n . Multi-
indices will be denoted by the letters α,β,γ,δ,.... It is a simple fact to verify that
|xα| ≤cn,α|x||α| ,
(2.2.1)
for some constant that depends on the dimension n and on α. In fact, cn,α is
the maximum of the continuous function (x1,...,xn) →|xα1
1 ···xαn
n | on the sphere
Sn−1 = {x ∈Rn : |x| = 1}. The converse inequality in (2.2.1) fails. However, the
following substitute of the converse of (2.2.1) is of great use: for k ∈Z+ we have
|x|k ≤Cn,k ∑
|β|=k
|xβ|
(2.2.2)
for all x ∈Rn \{0}. To prove (2.2.2), take 1/Cn,k to be the minimum of the function
x →∑
|β|=k
|xβ|

2.2 The Schwartz Class and the Fourier Transform
105
on Sn−1; this minimum is positive since this function has no zeros on Sn−1. A related
inequality is
(1+|x|)k ≤2k(1+Cn,k) ∑
|β|≤k
|xβ|.
(2.2.3)
This follows from (2.2.2) for |x| ≥1, while for |x| < 1 we note that the sum in (2.2.3)
is at least one since |x(0,...,0)| = 1.
We end the preliminaries by noting the validity of the one-dimensional Leibniz
rule
dm
dtm ( fg) =
m
∑
k=0
m
k
dk f
dtk
dm−kg
dtm−k ,
(2.2.4)
for all C m functions f,g on R, and its multidimensional analogue
∂α( fg) = ∑
β≤α
α1
β1

···
αn
βn

(∂β f)(∂α−βg),
(2.2.5)
for f,g in C |α|(Rn) for some multi-index α, where the notation β ≤α in (2.2.5)
means that β ranges over all multi-indices satisfying 0 ≤β j ≤αj for all 1 ≤j ≤n.
We observe that identity (2.2.5) is easily deduced by repeated application of (2.2.4),
which in turn is obtained by induction.
2.2.1 The Class of Schwartz Functions
We now introduce the class of Schwartz functions on Rn. Roughly speaking, a func-
tion is Schwartz if it is smooth and all of its derivatives decay faster than the recip-
rocal of any polynomial at inﬁnity. More precisely, we give the following deﬁnition.
Deﬁnition 2.2.1. A C ∞complex-valued function f on Rn is called a Schwartz func-
tion if for every pair of multi-indices α and β there exists a positive constant Cα,β
such that
ρα,β( f) = sup
x∈Rn |xα∂β f(x)| = Cα,β < ∞.
(2.2.6)
The quantities ρα,β( f) are called the Schwartz seminorms of f. The set of all
Schwartz functions on Rn is denoted by S (Rn).
Example 2.2.2. The function e−|x|2 is in S (Rn) but e−|x| is not, since it fails to be
differentiable at the origin. The C ∞function g(x) = (1+|x|4)−a, a > 0, is not in S
since it decays only like the reciprocal of a ﬁxed polynomial at inﬁnity. The set of
all smooth functions with compact support, C ∞
0 (Rn), is contained in S (Rn).
Remark 2.2.3. If f1 is in S (Rn) and f2 is in S (Rm), then the function of m + n
variables f1(x1,...,xn) f2(xn+1,...,xn+m) is in S (Rn+m). If f is in S (Rn) and P(x)
is a polynomial of n variables, then P(x) f(x) is also in S (Rn). If α is a multi-index
and f is in S (Rn), then ∂α f is in S (Rn). Also note that

106
2 Maximal Functions, Fourier Transform, and Distributions
f ∈S (Rn) ⇐⇒sup
x∈Rn |∂α(xβ f(x))| < ∞
for all multi-indices α, β.
Remark 2.2.4. The following alternative characterization of Schwartz functions is
very useful. A C ∞function f is in S (Rn) if and only if for all positive integers N
and all multi-indices α there exists a positive constant Cα,N such that
|(∂α f)(x)| ≤Cα,N(1+|x|)−N.
(2.2.7)
The simple proofs are omitted. We now discuss convergence in S (Rn).
Deﬁnition 2.2.5. Let fk, f be in S (Rn) for k = 1,2,.... We say that the sequence
fk converges to f in S (Rn) if for all multi-indices α and β we have
ρα,β( fk −f) = sup
x∈Rn |xα(∂β( fk −f))(x)| →0
as
k →∞.
For instance, for any ﬁxed x0 ∈Rn, f(x + x0/k) →f(x) in S (Rn) for any f in
S (Rn) as k →∞.
This notion of convergence is compatible with a topology on S (Rn) under which
the operations ( f,g) →f + g, (a, f) →af, and f →∂α f are continuous for all
complex scalars a and multi-indices α ( f,g ∈S (Rn)). A subbasis for open sets
containing 0 in this topology is
{f ∈S : ρα,β( f) < r},
for all α, β multi-indices and all r ∈Q+. Observe the following: If ρα,β( f) = 0, then
f = 0. This means that S (Rn) is a locally convex topological vector space equipped
with the family of seminorms ρα,β that separate points. We refer to Reed and Simon
[286] for the pertinent deﬁnitions. Since the origin in S (Rn) has a countable base,
this space is metrizable. In fact, the following is a metric on S (Rn):
d( f,g) =
∞
∑
j=1
2−j
ρ j( f −g)
1+ρ j( f −g) ,
where ρ j is an enumeration of all the seminorms ρα,β, α and β multi-indices. One
may easily verify that S is complete with respect to the metric d. Indeed, a Cauchy
sequence {hj}j in S would have to be Cauchy in L∞and therefore it would con-
verge uniformly to some function h. The same is true for the sequences {∂βhj}j
and {xαhj(x)}j, and the limits of these sequences can be shown to be the functions
∂βh and xαh(x), respectively. It follows that the sequence {hj} converges to h in S .
Therefore, S (Rn) is a Fr´echet space (complete metrizable locally convex space).
We note that convergence in S is stronger than convergence in all Lp. We have
the following.
Proposition 2.2.6. Let f, fk, k = 1,2,3,..., be in S (Rn). If fk →f in S then
fk →f in Lp for all 0 < p ≤∞. Moreover, there exists a Cp,n > 0 such that

2.2 The Schwartz Class and the Fourier Transform
107
∂β f

Lp ≤Cp,n
∑
|α|≤[ n+1
p ]+1
ρα,β( f)
(2.2.8)
for all f for which the right-hand side is ﬁnite.
Proof. Observe that when p < ∞we have
∂β f

Lp ≤

|x|≤1 |∂β f(x)|p dx+

|x|≥1 |x|n+1|∂β f(x)|p|x|−(n+1) dx
1/p
≤

vn
∂β f
p
L∞+

sup
|x|≥1
|x|n+1|∂β f(x)|p

|x|≥1 |x|−(n+1) dx
1/p
≤Cp,n
∂β f

L∞+ sup
|x|≥1
(|x|[ n+1
p ]+1|∂β f(x)|)

.
The preceding inequality is also trivially valid when p = ∞. Now set m =
 n+1
p

+1
and use (2.2.2) to obtain
sup
|x|≥1
|x|m|∂β f(x)| ≤sup
|x|≥1
Cn,m ∑
|α|=m
|xα∂β f(x)| ≤Cn,m ∑
|α|≤m
ρα,β( f).
Conclusion (2.2.8) now follows immediately. This shows that convergence in S
implies convergence in Lp.
□
We now show that the Schwartz class is closed under certain operations.
Proposition 2.2.7. Let f, g be in S (Rn). Then fg and f ∗g are in S (Rn). More-
over,
∂α( f ∗g) = (∂α f)∗g = f ∗(∂αg)
(2.2.9)
for all multi-indices α.
Proof. Fix f and g in S (Rn). Let ej be the unit vector (0,...,1,...,0) with 1 in the
jth entry and zeros in all the other entries. Since
f(y+hej)−f(y)
h
−(∂j f)(y) →0
(2.2.10)
as h →0, and since the expression in (2.2.10) is pointwise bounded by some constant
depending on f, the integral of the expression in (2.2.10) with respect to the measure
g(x −y)dy converges to zero as h →0 by the Lebesgue dominated convergence
theorem. This proves (2.2.9) when α = (0,...,1,...,0). The general case follows by
repeating the previous argument and using induction.
We now show that the convolution of two functions in S is also in S . For each
N > 0 there is a constant CN such that


Rn f(x−y)g(y)dy
 ≤CN

Rn(1+|x−y|)−N(1+|y|)−N−n−1dy.
(2.2.11)

108
2 Maximal Functions, Fourier Transform, and Distributions
Inserting the simple estimate
(1+|x−y|)−N ≤(1+|y|)N(1+|x|)−N
in (2.2.11) we obtain that
|( f ∗g)(x)| ≤CN(1+|x|)−N

Rn(1+|y|)−n−1dy = C′
N (1+|x|)−N .
This shows that f ∗g decays like (1+|x|)−N at inﬁnity, but since N > 0 is arbitrary
it follows that f ∗g decays faster than the reciprocal of any polynomial.
Since ∂α( f ∗g) = (∂α f) ∗g, replacing f by ∂α f in the previous argument, we
also conclude that all the derivatives of f ∗g decay faster than the reciprocal of any
polynomial at inﬁnity. Using (2.2.7), we conclude that f ∗g is in S . Finally, the fact
that fg is in S follows directly from Leibniz’s rule (2.2.5) and (2.2.7).
□
2.2.2 The Fourier Transform of a Schwartz Function
The Fourier transform is often introduced as an operation on L1. In that setting,
problems of convergence arise when certain manipulations of functions are per-
formed. Also, Fourier inversion requires the additional assumption that the Fourier
transform is in L1. Here we initially introduce the Fourier transform on the space
of Schwartz functions. The rapid decay of Schwartz functions at inﬁnity allows us
to develop its fundamental properties without encountering any convergence prob-
lems. The Fourier transform is a homeomorphism of the Schwartz class and Fourier
inversion holds in it. For these reasons, this class is a natural environment for it.
For x = (x1,...,xn), y = (y1,...,yn) in Rn we use the notation
x·y =
n
∑
j=1
xjyj .
Deﬁnition 2.2.8. Given f in S (Rn) we deﬁne
1f(ξ) =

Rn f(x)e−2πix·ξ dx.
We call 1f the Fourier transform of f.
Example 2.2.9. If f(x) = e−π|x|2 deﬁned on Rn, then 1f(ξ) = f(ξ). To prove this,
observe that the function
s →
 +∞
−∞e−π(t+is)2dt,
s ∈R,

2.2 The Schwartz Class and the Fourier Transform
109
deﬁned on the line is constant (and thus equal to
 +∞
−∞e−πt2dt), since its derivative is
 +∞
−∞−2πi(t +is)e−π(t+is)2dt =
 +∞
−∞i d
dt (e−π(t+is)2)dt = 0.
Using this fact, we calculate the Fourier transform of the function t →e−πt2 on R
by completing the squares as follows:

R e−πt2e−2πitτdt =

R e−π(t+iτ)2eπ(iτ)2dt =
 +∞
−∞e−πt2dt

e−πτ2 = e−πτ2,
where τ ∈R, and we used that
 +∞
−∞e−t2dt = √π ,
(2.2.12)
a fact that can be found in Appendix A.1.
Remark 2.2.10. It follows from the deﬁnition of the Fourier transform that if f is in
S (Rn) and g is in S (Rm), then
[ f(x1,...,xn)g(xn+1,...,xn+m)]1= 1f(ξ1,...,ξn)1g(ξn+1,...,ξn+m),
where the ﬁrst 1 denotes the Fourier transform on Rn+m. In other words, the Fourier
transform preserves separation of variables. Combining this observation with the
result in Example 2.2.9, we conclude that the function f(x) = e−π|x|2 deﬁned on Rn
is equal to its Fourier transform.
We now continue with some properties of the Fourier transform. Before we do
this we introduce some notation. For a measurable function f on Rn, x ∈Rn, and
a > 0 we deﬁne the translation, dilation, and reﬂection of f by
(τy f)(x) = f(x−y)
(δ a f)(x) = f(ax)
#f(x) = f(−x).
(2.2.13)
Also recall the notation fa = a−nδ 1/a( f) introduced in Deﬁnition 2.1.9.
Proposition 2.2.11. Given f, g in S (Rn), y ∈Rn, b ∈C, α a multi-index, and t > 0,
we have
(1)
 1f

L∞≤
f

L1,
(2)

f +g = 1f + 1g,
(3)
2
bf = b 1f,

110
2 Maximal Functions, Fourier Transform, and Distributions
(4)
1#f = #1f ,
(5)
1f = #1f ,
(6)
3
τy f(ξ) = e−2πiy·ξ 1f(ξ),
(7)
(e2πix·y f(x))1(ξ) = τy( 1f )(ξ),
(8)
(δt f)1= t−nδt−1 1f = ( 1f )t ,
(9)
(∂α f)1(ξ) = (2πiξ)α 1f(ξ),
(10)
(∂α 1f )(ξ) = ((−2πix)α f(x))1(ξ),
(11)
1f ∈S ,
(12)
3
f ∗g = 1f 1g,
(13)
3
f ◦A(ξ) = 1f(Aξ), where A is an orthogonal matrix and ξ is a column vector.
Proof. Property (1) follows directly from Deﬁnition 2.2.8. Properties (2)–(5) are
trivial. Properties (6)–(8) require a suitable change of variables but they are omitted.
Property (9) is proved by integration by parts (which is justiﬁed by the rapid decay
of the integrands):
(∂α f)1(ξ) =

Rn(∂α f)(x)e−2πix·ξ dx
= (−1)|α|

Rn f(x)(−2πiξ)αe−2πix·ξ dx
= (2πiξ)α 1f(ξ).
To prove (10), let α = ej = (0,...,1,...,0), where all entries are zero except for
the jth entry, which is 1. Since
e−2πix·(ξ+he j) −e−2πix·ξ
h
−(−2πixj)e−2πix·ξ →0
(2.2.14)
as h →0 and the preceding function is bounded by C|x| for all h and ξ, the Lebesgue
dominated convergence theorem implies that the integral of the function in (2.2.14)
with respect to the measure f(x)dx converges to zero. This proves (10) for α = ej.
For other α’s use induction. To prove (11) we use (9), (10), and (1) in the following
way:
xα(∂β 1f )(x)

L∞= (2π)|β|
(2π)|α|
(∂α(xβ f(x)))1

L∞≤(2π)|β|
(2π)|α|
∂α(xβ f(x))

L1 < ∞.

2.2 The Schwartz Class and the Fourier Transform
111
Identity (12) follows from the following calculation:
3
f ∗g(ξ) =

Rn

Rn f(x−y)g(y)e−2πix·ξ dydx
=

Rn

Rn f(x−y)g(y)e−2πi(x−y)·ξe−2πiy·ξ dydx
=

Rn g(y)

Rn f(x−y)e−2πi(x−y)·ξdx e−2πiy·ξ dy
= 1f(ξ)1g(ξ),
where the application of Fubini’s theorem is justiﬁed by the absolute convergence
of the integrals. Finally, we prove (13). We have
3
f ◦A(ξ) =

Rn f(Ax)e−2πix·ξ dx
=

Rn f(y)e−2πiA−1y·ξ dy
=

Rn f(y)e−2πiAty·ξ dy
=

Rn f(y)e−2πiy·Aξ dy
= 1f(Aξ),
where we used the change of variables y = Ax and the fact that |detA| = 1.
□
Corollary 2.2.12. The Fourier transform of a radial function is radial. Products and
convolutions of radial functions are radial.
Proof. Let ξ1, ξ2 in Rn with |ξ1| = |ξ2|. Then for some orthogonal matrix A we have
Aξ1 = ξ2. Since f is radial, we have f = f ◦A. Then
1f(ξ2) = 1f(Aξ1) = 3
f ◦A(ξ1) = 1f(ξ1),
where we used (13) in Proposition 2.2.11 to justify the second equality. Products and
convolutions of radial functions are easily seen to be radial.
□
2.2.3 The Inverse Fourier Transform and Fourier Inversion
We now deﬁne the inverse Fourier transform.
Deﬁnition 2.2.13. Given a Schwartz function f, we deﬁne
f ∨(x) = 1f(−x),

112
2 Maximal Functions, Fourier Transform, and Distributions
for all x ∈Rn. The operation
f →f ∨
is called the inverse Fourier transform.
It is straightforward that the inverse Fourier transform shares the same properties
as the Fourier transform. One may want to list (and prove) properties for the inverse
Fourier transform analogous to those in Proposition 2.2.11.
We now investigate the relation between the Fourier transform and the inverse
Fourier transform. In the next theorem, we prove that one is the inverse operation of
the other. This property is referred to as Fourier inversion.
Theorem 2.2.14. Given f, g, and h in S (Rn), we have
(1)

Rn f(x)1g(x)dx =

Rn
1f(x)g(x)dx,
(2) (Fourier Inversion)
( 1f )∨= f = ( f ∨)∧,
(3) (Parseval’s relation)

Rn f(x)h(x)dx =

Rn
1f(ξ)1h(ξ)dξ ,
(4) (Plancherel’s identity)
f

L2 =
 1f

L2 =
 f ∨
L2 ,
(5)

Rn f(x)h(x)dx =

Rn
1f(x)h∨(x)dx.
Proof. (1) follows immediately from the deﬁnition of the Fourier transform and
Fubini’s theorem. To prove (2) we use (1) with
g(ξ) = e2πiξ·te−π|εξ|2 .
By Proposition 2.2.11 (7) and (8) and Example 2.2.9, we have that
1g(x) = 1
εn e−π|(x−t)/ε|2,
which is an approximate identity. Now (1) gives

Rn f(x)ε−ne−πε−2|x−t|2 dx =

Rn
1f(ξ)e2πiξ·te−π|εξ|2 dξ .
(2.2.15)
Now let ε →0 in (2.2.15). The left-hand side of (2.2.15) converges to f(t) uniformly
on compact sets by Theorem 1.2.19. The right-hand side of (2.2.15) converges to
( 1f )∨(t) as ε →0 by the Lebesgue dominated convergence theorem. We conclude
that ( 1f )∨= f on Rn. Replacing f by #f and using the result just proved, we conclude
that ( f ∨)∧= f.
Note that if g = 1h, then Proposition 2.2.11 (5) and identity (2) imply that 1g = h.
Then (3) follows from (1) by expressing h in terms of g. Identity (4) is a trivial

2.2 The Schwartz Class and the Fourier Transform
113
consequence of (3). (Sometimes the polarized identity (3) is also referred to as
Plancherel’s identity.) Finally, (5) easily follows from (1) and (2) with 1g = h.
□
Next we have the following simple corollary of Theorem 2.2.14.
Corollary 2.2.15. The Fourier transform is a homeomorphism from S (Rn) onto
itself.
Proof. The continuity of the Fourier transform (and its inverse) follows from Exer-
cise 2.2.2, while Fourier inversion yields that this map is bijective.
□
2.2.4 The Fourier Transform on L1 +L2
We have deﬁned the Fourier transform on S (Rn). We now extend this deﬁnition to
the space L1(Rn)+L2(Rn).
We begin by observing that the Fourier transform given in Deﬁnition 2.2.8,
1f(ξ) =

Rn f(x)e−2πix·ξ dx,
makes sense as a convergent integral for functions f ∈L1(Rn). This allows us to
extend the deﬁnition of the Fourier transform on L1. Moreover, this operator satisﬁes
properties (1)–(8) as well as (12) and (13) in Proposition 2.2.11, with f,g integrable.
We also deﬁne the inverse Fourier transform on L1 by setting f ∨(x) = 1f(−x) for
f ∈L1(Rn) and we note that analogous properties hold for it. One problem in this
generality is that when f is integrable, one may not necessarily have ( 1f )∨= f a.e.
This inversion is possible when 1f is also integrable; see Exercise 2.2.6.
The integral deﬁning the Fourier transform does not converge absolutely for func-
tions in L2(Rn); however, the Fourier transform has a natural deﬁnition in this space
accompanied by an elegant theory. In view of the result in Exercise 2.2.8, the Fourier
transform is an L2 isometry on L1 ∩L2, which is a dense subspace of L2. By density,
there is a unique bounded extension of the Fourier transform on L2. Let us denote
this extension by F. Then F is also an isometry on L2, i.e.,
F( f)

L2 =
f

L2
for all f ∈L2(Rn), and any sequence of functions fN ∈L1(Rn)∩L2(Rn) converging
to a given f in L2(Rn) satisﬁes
2
fN −F( f)

L2 →0,
(2.2.16)
as N →∞. In particular, the sequence of functions fN(x) = f(x)χ|x|≤N yields that
2
fN(ξ) =

|x|≤N f(x)e−2πix·ξ dx
(2.2.17)

114
2 Maximal Functions, Fourier Transform, and Distributions
converges to F( f)(ξ) in L2 as N →∞. If f is both integrable and square inte-
grable, the expressions in (2.2.17) also converge to 1f(ξ) pointwise. Also, in view of
Theorem 1.1.11 and (2.2.16), there is a subsequence of 2
fN that converges to F( f)
pointwise a.e. Consequently, for f in L1(Rn)∩L2(Rn) the expressions 1f and F( f)
coincide pointwise a.e. For this reason we often adopt the notation 1f to denote the
Fourier transform of functions f in L2 as well.
In a similar fashion, we let F ′ be the isometry on L2(Rn) that extends the op-
erator f →f ∨, which is an L2 isometry on L1 ∩L2; the last statement follows
by adapting the result of Exercise 2.2.8 to the inverse Fourier transform. Since
ϕ∨(x) = 1ϕ(−x) for ϕ in the Schwartz class, which is dense in L2 (Exercise 2.2.5),
it follows that F ′( f)(x) = F( f)(−x) for all f ∈L2 and almost all x ∈Rn. The
operators F and F ′ are L2-isometries that satisfy F ′ ◦F = F ◦F ′ = Id on the
Schwartz space. By density this identity also holds for L2 functions and implies that
F and F ′ are injective and surjective mappings from L2 to itself; consequently, F ′
coincides with the inverse operator F −1 of F : L2 →L2, and Fourier inversion
f = F −1 ◦F( f) = F ◦F −1( f)
a.e.
holds on L2.
Having set down the basic facts concerning the action of the Fourier transform
on L1 and L2, we extend its deﬁnition on Lp for 1 < p < 2. Given a function f in
Lp(Rn), with 1 < p < 2, we deﬁne 1f = 1f1 + 1f2, where f1 ∈L1(Rn), f2 ∈L2(Rn),
and f = f1 + f2; we may take, for instance, f1 = f χ| f|>1 and f2 = f χ| f|≤1. The
deﬁnition of 1f is independent of the choice of f1 and f2, for if f1 + f2 = h1 +h2 for
f1,h1 ∈L1(Rn) and f2,h2 ∈L2(Rn), we have f1 −h1 = h2 −f2 ∈L1(Rn)∩L2(Rn).
Since these functions are equal on L1(Rn) ∩L2(Rn), their Fourier transforms are
also equal, and we obtain 1f1 −1h1 = 1h2 −1f2, which yields 
f1 + f2 = 
h1 +h2. We
have the following result concerning the action of the Fourier transform on Lp.
Proposition 2.2.16. (Hausdorff–Young inequality) For every function f in Lp(Rn)
we have the estimate
 1f

Lp′ ≤
f

Lp
whenever 1 ≤p ≤2.
Proof. This follows easily from Theorem 1.3.4. Interpolate between the estimates
∥1f ∥L∞≤∥f∥L1 (Proposition 2.2.11 (1)) and ∥1f ∥L2 ≤∥f∥L2 to obtain ∥1f ∥Lp′ ≤
∥f∥Lp. We conclude that the Fourier transform is a bounded operator from Lp(Rn)
to Lp′(Rn) with norm at most 1 when 1 ≤p ≤2.
□
Next, we are concerned with the behavior of the Fourier transform at inﬁnity.
Proposition 2.2.17. (Riemann–Lebesgue lemma) For a function f in L1(Rn) we
have that
| 1f(ξ)| →0
as
|ξ| →∞.

2.2 The Schwartz Class and the Fourier Transform
115
Proof. Consider the function χ[a,b] on R. A simple computation gives
3
χ[a,b](ξ) =
 b
a e−2πixξ dx = e−2πiξa −e−2πiξb
2πiξ
,
which tends to zero as |ξ| →∞. Likewise, if g = ∏n
j=1 χ[a j,b j] on Rn, then
1g(ξ) =
n
∏
j=1
e−2πiξ ja j −e−2πiξ jb j
2πiξ j
.
Given a ξ = (ξ1,...,ξn) ̸= 0, there is j0 such that |ξ j0| > |ξ|/√n. Then

n
∏
j=1
e−2πiξ ja j −e−2πiξ jb j
2πiξ j
 ≤2√n
2π|ξ|
sup
1≤j0≤n ∏
j̸= j0
(bj −aj)
which also tends to zero as |ξ| →∞in Rn.
Given a general integrable function f on Rn and ε > 0, there is a simple function
h, which is a ﬁnite linear combination of characteristic functions of rectangles (like
g), such that ∥f −h∥L1 < ε
2. Then there is an M is such that for |ξ| > M we have
|1h(ξ)| < ε
2. It follows that
| 1f(ξ)| ≤| 1f(ξ)−1h(ξ)|+|1h(ξ)| ≤
f −h

L1 +|1h(ξ)| < ε
2 + ε
2 ,
provided |ξ| > M. This implies that | 1f(ξ)| →0 as |ξ| →∞.
A different proof can be given by taking the function h in the preceding paragraph
to be a Schwartz function and using that Schwartz functions are dense in L1(Rn);
see Exercise 2.2.5 about the last assertion.
□
We end this section with an example that illustrates some of the practical uses of
the Fourier transform.
Example 2.2.18. We would like to ﬁnd a Schwartz function f(x1,x2,x3) on R3 that
satisﬁes the partial differential equation
f(x)+∂2
1 ∂2
2 ∂4
3 f(x)+4i∂2
1 f(x)+∂7
2 f(x) = e−π|x|2.
Taking the Fourier transform on both sides of this identity and using Proposition
2.2.11 (2), (9) and the result of Example 2.2.9, we obtain
1f(ξ)
/
1+(2πiξ1)2(2πiξ2)2(2πiξ3)4 +4i(2πiξ1)2 +(2πiξ2)7 0
= e−π|ξ|2 .
Let p(ξ) = p(ξ1,ξ2,ξ3) be the polynomial inside the square brackets. We observe
that p(ξ) has no real zeros and we may therefore write
1f(ξ) = e−π|ξ|2 p(ξ)−1 =⇒f(x) =

e−π|ξ|2 p(ξ)−1∨(x).

116
2 Maximal Functions, Fourier Transform, and Distributions
In general, let
P(ξ) = ∑
|α|≤N
Cαξ α
be a polynomial in Rn with constant complex coefﬁcients Cα indexed by multi-
indices α. If P(2πiξ) has no real zeros, and u is in S (Rn), then the partial differ-
ential equation
P(∂) f = ∑
|α|≤N
Cα∂α f = u
is solved as before to give
f =

1u(ξ)P(2πiξ)−1∨.
Since P(2πiξ) has no real zeros and u ∈S (Rn), the function
1u(ξ)P(2πiξ)−1
is smooth and therefore a Schwartz function. Then f is also in S (Rn) by Proposition
2.2.11 (11).
Exercises
2.2.1. (a) Construct a Schwartz function supported in the unit ball of Rn.
(b) Construct a C ∞
0 (Rn) function equal to 1 on the annulus 1 ≤|x| ≤2 and vanishing
off the annulus 1/2 ≤|x| ≤4.
(c) Construct a nonnegative nonzero Schwartz function f on Rn whose Fourier
transform is nonnegative and compactly supported.

Hint: Part (a): Try the construction in dimension one ﬁrst using the C ∞function
η(x) = e−1/x for x > 0 and η(x) = 0 for x < 0. Part (c): Take f = |φ ∗#φ|2, where 1φ
is odd, real-valued, and compactly supported; here #φ(x) = φ(−x).

2.2.2. If fk, f ∈S (Rn) and fk →f in S (Rn), then 1fk →1f and f ∨
k →f ∨in S (Rn).
2.2.3. Find the spectrum (i.e., the set of all eigenvalues of the Fourier transform),
that is, all complex numbers λ for which there exist nonzero functions f such that
1f = λ f .

Hint: Apply the Fourier transform three times to the preceding identity. Consider
the functions xe−πx2, (a + bx2)e−πx2, and (cx + dx3)e−πx2 for suitable a,b,c,d to
show that all fourth roots of unity are indeed eigenvalues of the Fourier transform.

2.2.4. Use the idea of the proof of Proposition 2.2.7 to show that if the functions f,
g deﬁned on Rn satisfy | f(x)| ≤A(1 + |x|)−M and |g(x)| ≤B(1 + |x|)−N for some
M,N > n, then

2.2 The Schwartz Class and the Fourier Transform
117
|( f ∗g)(x)| ≤ABC(1+|x|)−L ,
where L = min(N,M) and C = C(N,M) > 0.
2.2.5. Show that C ∞
0 (Rn) is dense on Lp(Rn) for 0 < p < ∞but not for p = ∞.

Hint: Use a smooth approximate identity when p ≥1. Reduce the case p < 1 to
p = 1.

2.2.6. (a) Prove that if f ∈L1, then 1f is uniformly continuous on Rn.
(b) Prove that for f,g ∈L1(Rn) we have

Rn f(x)1g(x)dx =

Rn
1f(y)g(y)dy.
(c) Take 1g(x) = ε−ne−πε−2|x−t|2 in (b) and let ε →0 to prove that if f and 1f are both
in L1, then ( 1f )∨= f a.e. This fact is called Fourier inversion on L1.
2.2.7. (a) Prove that if a function f in L1(Rn)∩L∞(Rn) is continuous at 0, then
lim
ε→0

Rn
1f(x)e−π|εx|2dx = f(0).
(b) Let f ∈L1(Rn) ∩L∞(Rn) be continuous at zero and satisfy 1f ≥0. Show that 1f
is in L1 and conclude that Fourier inversion holds at zero f(0) = ∥1f ∥L1, and also
f = ( 1f )∨a.e. in general.

Hint: Part (a): Let g(x) = e−π|εx|2 in Exercise 2.2.6(b) and use Theorem 1.2.19 (2).

2.2.8. Given f in L1(Rn)∩L2(Rn), without appealing to density, prove that
 1f

L2 =
 f

L2 .

Hint: Let h = f ∗#f , where #f(x) = f(−x) and the bar indicates complex conjuga-
tion. Then h ∈L1(Rn)∩L∞(Rn), 1h = | 1f|2 ≥0, and h is continuous at zero. Exercise
2.2.7(b) yields ∥1f ∥2
L2 = ∥1h∥L1 = h(0) =

Rn f(x) #f(−x)dx = ∥f∥2
L2.

2.2.9. (a) Prove that for all 0 < ε < t < ∞we have

 t
ε
sin(ξ)
ξ
dξ
 ≤4.
(b) If f is an odd L1 function on the line, conclude that for all t > ε > 0 we have

 t
ε
1f(ξ)
ξ
dξ
 ≤4
f

L1 .
(c) Let g(ξ) be a continuous odd function that is equal to 1/log(ξ) for ξ ≥2. Show
that there does not exist an L1 function whose Fourier transform is g.

118
2 Maximal Functions, Fourier Transform, and Distributions
2.2.10. Let f be in L1(R). Prove that
 +∞
−∞f

x−1
x

dx =
 +∞
−∞f(u)du.

Hint: For x ∈(−∞,0) use the change of variables u = x−1
x or x = 1
2

u−
√
4+u2 
.
For x ∈(0,∞) use the change of variables u = x−1
x or x = 1
2

u+
√
4+u2 
.

2.2.11. (a) Use Exercise 2.2.10 with f(x) = e−tx2 to obtain the subordination
identity
e−2t =
1
√π
 ∞
0 e−y−t2/y dy
√y ,
where t > 0.
(b) Set t = π|x| and integrate with respect to e−2πiξ·xdx to prove that
(e−2π|x|)1(ξ) = Γ ( n+1
2 )
π
n+1
2
1
(1+|ξ|2)
n+1
2
.
This calculation gives the Fourier transform of the Poisson kernel.
2.2.12. Let 1 ≤p ≤∞and let p′ be its dual index.
(a) Prove that Schwartz functions f on the line satisfy the estimate
f
2
L∞≤2
 f

Lp
 f ′
Lp′ .
(b) Prove that all Schwartz functions f on Rn satisfy the estimate
f
2
L∞≤
∑
|α+β|=n
∂α f

Lp
∂β f

Lp′ ,
where the sum is taken over all pairs of multi-indices α and β whose sum has size n.

Hint: Part (a): Write f(x)2 =
 x
−∞
d
dt f(t)2 dt.

2.2.13. The uncertainty principle says that the position and the momentum of a
particle cannot be simultaneously localized. Prove the following inequality, which
presents a quantitative version of this principle:
f
2
L2(Rn) ≤4π
n
inf
y∈Rn

Rn |x−y|2| f(x)|2 dx
1
2
inf
z∈Rn

Rn |ξ −z|2| 1f(ξ)|2 dξ
1
2
,
where f is a Schwartz function on Rn (or an L2 function with sufﬁcient decay at
inﬁnity).

Hint: Let y be in Rn. Start with
f
2
L2 = 1
n

Rn f(x) f(x)
n
∑
j=1
∂
∂xj
(xj −yj)dx,

2.3 The Class of Tempered Distributions
119
integrate by parts, apply the Cauchy–Schwarz inequality, Plancherel’s identity, and
the identity ∑n
j=1 |3
∂j f(ξ)|2 = 4π2|ξ|2| 1f(ξ)|2 for all ξ ∈Rn. Then replace f(x) by
f(x)e2πix·z.

2.2.14. Let −∞< α < n
2 < β < +∞. Prove the validity of the following inequality:
g

L1(Rn) ≤C
|x|αg(x)

β−n/2
β−α
L2(Rn)
|x|βg(x)

n/2−α
β−α
L2(Rn)
for some constant C = C(n,α,β) independent of g.

Hint: First prove ∥g∥L1 ≤C∥|x|αg(x)∥L2 + ∥|x|βg(x)∥L2 and then replace g(x) by
g(λx) for some suitable λ > 0.

2.3 The Class of Tempered Distributions
The fundamental idea of the theory of distributions is that it is generally easier to
work with linear functionals acting on spaces of “nice” functions than to work with
“bad” functions directly. The set of “nice” functions we consider is closed under
the basic operations in analysis, and these operations are extended to distributions
by duality. This wonderful interpretation has proved to be an indispensable tool that
has clariﬁed many situations in analysis.
2.3.1 Spaces of Test Functions
We recall the space C ∞
0 (Rn) of all smooth functions with compact support, and
C ∞(Rn) of all smooth functions on Rn. We are mainly interested in the three spaces
of “nice” functions on Rn that are nested as follows:
C ∞
0 (Rn) ⊆S (Rn) ⊆C ∞(Rn).
Here S (Rn) is the space of Schwartz functions introduced in Section 2.2.
Deﬁnition 2.3.1. We deﬁne convergence of sequences in these spaces. We say that
fk →f in C ∞
⇐⇒
fk, f ∈C ∞and lim
k→∞sup
|x|≤N
|∂α( fk −f)(x)| = 0
∀α multi-indices and all N = 1,2,....
fk →f in S
⇐⇒
fk, f ∈S and lim
k→∞sup
x∈Rn |xα∂β( fk −f)(x)| = 0
∀α,β multi-indices.
fk →f in C ∞
0
⇐⇒
fk, f ∈C ∞
0 , support( fk) ⊆B for all k, B compact,
and lim
k→∞
∂α( fk −f)

L∞= 0 ∀α multi-indices.

120
2 Maximal Functions, Fourier Transform, and Distributions
It follows that convergence in C ∞
0 (Rn) implies convergence in S (Rn), which in
turn implies convergence in C ∞(Rn).
Example 2.3.2. Let ϕ be a nonzero C ∞
0
function on R. We call such functions
smooth bumps. Deﬁne the sequence of smooth bumps ϕk(x) = ϕ(x −k)/k. Then
ϕk(x) does not converge to zero in C ∞
0 (R), even though ϕk (and all of its deriva-
tives) converge to zero uniformly. Furthermore, we see that ϕk does not converge to
any function in S (R). Clearly ϕk →0 in C ∞(R).
The space C ∞(Rn) is equipped with the family of seminorms
#ρα,N( f) = sup
|x|≤N
|(∂α f)(x)|,
(2.3.1)
where α ranges over all multi-indices and N ranges over Z+. It can be shown that
C ∞(Rn) is complete with respect to this countable family of seminorms, i.e., it is a
Fr´echet space. However, it is true that C ∞
0 (Rn) is not complete with respect to the
topology generated by this family of seminorms.
The topology of C ∞
0 given in Deﬁnition 2.3.1 is the inductive limit topology, and
under this topology it is complete. Indeed, letting C ∞
0 (B(0,k)) be the space of all
smooth functions with support in B(0,k), then C ∞
0 (Rn) is equal to ∞
k=1 C ∞
0 (B(0,k))
and each space C ∞
0 (B(0,k)) is complete with respect to the topology generated by
the family of seminorms #ρα,N; hence so is C ∞
0 (Rn). Nevertheless, C ∞
0 (Rn) is not
metrizable. Details on the topologies of these spaces can be found in [286].
2.3.2 Spaces of Functionals on Test Functions
The dual spaces (i.e., the spaces of continuous linear functionals on the sets of test
functions) we introduced is denoted by
(C ∞
0 (Rn))′ = D′(Rn),
(S (Rn))′ = S ′(Rn),
(C ∞(Rn))′ = E ′(Rn).
By deﬁnition of the topologies on the dual spaces, we have
Tk →T
in D′
⇐⇒
Tk,T ∈D′ and Tk( f) →T( f) for all f ∈C ∞
0 .
Tk →T
in S ′
⇐⇒
Tk,T ∈S ′ and Tk( f) →T( f) for all f ∈S .
Tk →T
in E ′
⇐⇒
Tk,T ∈E ′ and Tk( f) →T( f) for all f ∈C ∞.
The dual spaces are nested as follows:
E ′(Rn) ⊆S ′(Rn) ⊆D′(Rn).

2.3 The Class of Tempered Distributions
121
Deﬁnition 2.3.3. Elements of the space D′(Rn) are called distributions. Elements of
S ′(Rn) are called tempered distributions. Elements of the space E ′(Rn) are called
distributions with compact support.
Before we discuss some examples, we give alternative characterizations of distri-
butions, which are very useful from the practical point of view. The action of a
distribution u on a test function f is represented in either one of the following two
ways:
4
u, f
5
= u( f).
Proposition 2.3.4. (a) A linear functional u on C ∞
0 (Rn) is a distribution if and only
if for every compact K ⊆Rn, there exist C > 0 and an integer m such that
4
u, f
5 ≤C ∑
|α|≤m
∂α f

L∞,
for all f ∈C ∞with support in K.
(2.3.2)
(b) A linear functional u on S (Rn) is a tempered distribution if and only if there
exist C > 0 and k, m integers such that
4
u, f
5 ≤C ∑
|α|≤m
|β|≤k
ρα,β( f),
for all f ∈S (Rn).
(2.3.3)
(c) A linear functional u on C ∞(Rn) is a distribution with compact support if and
only if there exist C > 0 and N, m integers such that
4
u, f
5 ≤C ∑
|α|≤m
#ρα,N( f),
for all f ∈C ∞(Rn).
(2.3.4)
The seminorms ρα,β and #ρα,N are deﬁned in (2.2.6) and (2.3.1), respectively.
Proof. We prove only (2.3.3), since the proofs of (2.3.2) and (2.3.4) are similar. It is
clear that (2.3.3) implies continuity of u. Conversely, it was pointed out in Section
2.2 that the family of sets {f ∈S (Rn) : ρα,β( f) < δ}, where α, β are multi-
indices and δ > 0, forms a subbasis for the topology of S . Thus if u is a continuous
functional on S , there exist integers k, m and a δ > 0 such that
|α| ≤m, |β| ≤k,
and ρα,β( f) < δ =⇒
4
u, f
5 ≤1.
(2.3.5)
We see that (2.3.3) follows from (2.3.5) with C = 1/δ.
□
Examples 2.3.5. We now discuss some important examples.
1. The Dirac mass at the origin δ0. This is deﬁned for ϕ ∈C ∞(Rn) by
4
δ0,ϕ
5
= ϕ(0).

122
2 Maximal Functions, Fourier Transform, and Distributions
We claim that δ0 is in E ′. To see this we observe that if ϕk →ϕ in C ∞then
4
δ0,ϕk
5
→
4
δ0,ϕ
5
. The Dirac mass at a point a ∈Rn is deﬁned similarly by
4
δa,ϕ
5
= ϕ(a).
2. Some functions g can be thought of as distributions via the identiﬁcation g →Lg,
where Lg is the functional
Lg(ϕ) =

Rn ϕ(x)g(x)dx.
Here are some examples: The function 1 is in S ′ but not in E ′. Compactly sup-
ported integrable functions are in E ′. The function e|x|2 is in D′ but not in S ′.
3. Functions in L1
loc are distributions. To see this, ﬁrst observe that if g ∈L1
loc, then
the integral
Lg(ϕ) =

Rn ϕ(x)g(x)dx
is well deﬁned for all ϕ ∈D and satisﬁes |Lg(ϕ)| ≤

K |g(x)|dx

∥ϕ∥L∞for all
smooth functions ϕ supported in the compact set K.
4. Functions in Lp, 1 ≤p ≤∞, are tempered distributions, but may not in E ′ unless
they have compact support.
5. Any ﬁnite Borel measure μ is a tempered distribution via the identiﬁcation
Lμ(ϕ) =

Rn ϕ(x)dμ(x).
To see this, observe that ϕk →ϕ in S implies that Lμ(ϕk) →Lμ(ϕ). Finite Borel
measures may not be distributions with compact support.
6. Every function g that satisﬁes |g(x)| ≤C(1 + |x|)k, for some real number k, is a
tempered distribution. To see this, observe that
Lg(ϕ)
 ≤sup
x∈Rn(1+|x|)m|ϕ(x)|

Rn(1+|x|)k−mdx,
where m > n+k and the expression supx∈Rn(1+|x|)m|ϕ(x)| is bounded by a ﬁnite
sum of Schwartz seminorms ρα,β(ϕ).
7. The function log|x| is a tempered distribution; indeed for any ϕ ∈S (Rn), the
integral of ϕ(x)log|x| is bounded by a ﬁnite number of Schwartz seminorms of
ϕ. More generally, any function that is integrable on a ball |x| ≤M and for some
C > 0 satisﬁes |g(x)| ≤C(1+|x|)k for |x| ≥M, is a tempered distribution.
8. Here is an example of a compactly supported distribution on R that is neither a
locally integrable function nor a ﬁnite Borel measure:
4
u,ϕ
5
= lim
ε→0

ε≤|x|≤1
ϕ(x)dx
x = lim
ε→0

ε≤|x|≤1
(ϕ(x)−ϕ(0))dx
x .
We have that |⟨u,ϕ⟩| ≤2∥ϕ′∥L∞([−1,1]) and notice that ∥ϕ′∥L∞([−1,1]) is a #ρα,N
seminorm of ϕ.

2.3 The Class of Tempered Distributions
123
2.3.3 The Space of Tempered Distributions
Having set down the basic deﬁnitions of distributions, we now focus our study on the
space of tempered distributions. These distributions are the most useful in harmonic
analysis. The main reason for this is that the subject is concerned with boundedness
of translation-invariant operators, and every such bounded operator from Lp(Rn) to
Lq(Rn) is given by convolution with a tempered distribution. This fact is shown in
Section 2.5.
Suppose that f and g are Schwartz functions and α a multi-index. Integrating by
parts |α| times, we obtain

Rn(∂α f)(x)g(x)dx = (−1)|α|

Rn f(x)(∂αg)(x)dx.
(2.3.6)
If we wanted to deﬁne the derivative of a tempered distribution u, we would have to
give a deﬁnition that extends the deﬁnition of the derivative of the function and that
satisﬁes (2.3.6) for g in S ′ and f ∈S if the integrals in (2.3.6) are interpreted as
actions of distributions on functions. We simply use equation (2.3.6) to deﬁne the
derivative of a distribution.
Deﬁnition 2.3.6. Let u ∈S ′ and α a multi-index. Deﬁne
4
∂αu, f
5
= (−1)|α|4
u,∂α f
5
.
(2.3.7)
If u is a function, the derivatives of u in the sense of distributions are called distri-
butional derivatives.
In view of Theorem 2.2.14, it is natural to give the following:
Deﬁnition 2.3.7. Let u ∈S ′. We deﬁne the Fourier transform 1u and the inverse
Fourier transform u∨of a tempered distribution u by
4
1u, f
5
=
4
u, 1f
5
and
4
u∨, f
5
=
4
u, f ∨5
,
(2.3.8)
for all f in S .
Example 2.3.8. We observe that 1δ0 = 1. More generally, for any multi-index α we
have
(∂αδ0)∧= (2πix)α.
To see this, observe that for all f ∈S we have
4
(∂αδ0)∧, f
5
=
4
∂αδ0 , 1f
5
= (−1)|α|4
δ0 , ∂α 1f
5
= (−1)|α|4
δ0 , ((−2πix)α f(x))∧5
= (−1)|α|((−2πix)α f(x))∧(0)

124
2 Maximal Functions, Fourier Transform, and Distributions
= (−1)|α|

Rn(−2πix)α f(x)dx
=

Rn(2πix)α f(x)dx.
This calculation indicates that (∂αδ0)∧can be identiﬁed with the function (2πix)α.
Example 2.3.9. Recall that for x0 ∈Rn, δx0( f) =
4
δx0, f
5
= f(x0). Then
42
δx0,h
5
=
4
δx0,1h
5
= 1h(x0) =

Rn h(x)e−2πix·x0 dx,
h ∈S (Rn),
that is, 2
δx0 can be identiﬁed with the function x →e−2πix·x0. In particular, 1δ0 = 1.
Example 2.3.10. The function e|x|2 is not in S ′(Rn) and therefore its Fourier trans-
form is not deﬁned as a distribution. However, the Fourier transform of any locally
integrable function with polynomial growth at inﬁnity is deﬁned as a tempered dis-
tribution.
Now observe that the following are true whenever f, g are in S .

Rn g(x) f(x−t)dx =

Rn g(x+t) f(x)dx,

Rn g(ax) f(x)dx =

Rn g(x)a−n f(a−1x)dx,

Rn #g(x) f(x)dx =

Rn g(x) #f(x)dx,
(2.3.9)
for all t ∈Rn and a > 0. Recall now the deﬁnitions of τt, δ a, and # given in (2.2.13).
Motivated by (2.3.9), we give the following:
Deﬁnition 2.3.11. The translation τtu, the dilation δ au, and the reﬂection #u of a
tempered distribution u are deﬁned as follows:
4
τtu, f
5
=
4
u,τ−t f
5
,
(2.3.10)
4
δ au, f
5
=
4
u,a−nδ 1/a f
5
,
(2.3.11)
4
#u, f
5
=
4
u, #f
5
,
(2.3.12)
for all t ∈Rn and a > 0. Let A be an invertible matrix. The composition of a distri-
bution u with an invertible matrix A is the distribution
4
uA,ϕ
5
= |det A|−14
u,ϕA−15
,
(2.3.13)
where ϕA−1(x) = ϕ(A−1x).

2.3 The Class of Tempered Distributions
125
It is easy to see that the operations of translation, dilation, reﬂection, and differ-
entiation are continuous on tempered distributions.
Example 2.3.12. The Dirac mass at the origin δ0 is equal to its reﬂection, while
δ aδ0 = a−nδ0. Also, τxδ0 = δx for any x ∈Rn.
Now observe that for f, g, and h in S we have

Rn(h∗g)(x) f(x)dx =

Rn g(x)(#h∗f)(x)dx.
(2.3.14)
Motivated by (2.3.14), we deﬁne the convolution of a function with a tempered dis-
tribution as follows:
Deﬁnition 2.3.13. Let u ∈S ′ and h ∈S . Deﬁne the convolution h∗u by
4
h∗u, f
5
=
4
u,#h∗f
5
,
f ∈S .
(2.3.15)
Example 2.3.14. Let u = δx0 and f ∈S . Then f ∗δx0 is the function x →f(x−x0),
for when h ∈S , we have
4
f ∗δx0,h
5
=
4
δx0, #f ∗h
5
= ( #f ∗h)(x0) =

Rn f(x−x0)h(x)dx.
It follows that convolution with δ0 is the identity operator.
We now deﬁne the product of a function and a distribution.
Deﬁnition 2.3.15. Let u ∈S ′ and let h be a C ∞function that has at most polynomial
growth at inﬁnity and the same is true for all of its derivatives. This means that for
all α it satisﬁes |(∂αh)(x)| ≤Cα(1 + |x|)kα for some Cα,kα > 0. Then deﬁne the
product hu of h and u by
4
hu, f
5
=
4
u,hf
5
,
f ∈S .
(2.3.16)
Note that hf is in S and thus (2.3.16) is well deﬁned. The product of an arbitrary
C ∞function with a tempered distribution is not deﬁned.
We observe that if a function g is supported in a set K, then for all f ∈C ∞
0 (Kc)
we have

Rn f(x)g(x)dx = 0.
(2.3.17)
Moreover, the support of g is the intersection of all closed sets K with the property
(2.3.17) for all f in C ∞
0 (Kc). Motivated by the preceding observation we give the
following:
Deﬁnition 2.3.16. Let u be in D′(Rn). The support of u (suppu) is the intersection
of all closed sets K with the property
ϕ ∈C ∞
0 (Rn),
suppϕ ⊆Rn \K =⇒
4
u,ϕ
5
= 0.
(2.3.18)

126
2 Maximal Functions, Fourier Transform, and Distributions
Distributions with compact support are exactly those whose support (as deﬁned
in the previous deﬁnition) is a compact set. To prove this assertion, we start with a
distribution u with compact support as deﬁned in Deﬁnition 2.3.3. Then there exist
C,N,m > 0 such that (2.3.4) holds. For a C ∞function f whose support is contained
in B(0,N)c, the expression on the right in (2.3.4) vanishes and we must therefore
have ⟨u, f⟩= 0. This shows that the support of u is contained in B(0,N) hence it is
bounded, and since it is already closed (as an intersection of closed sets), it must be
compact. Conversely, if the support of u as deﬁned in Deﬁnition 2.3.16 is a compact
set, then there exists an N > 0 such that suppu is contained in B(0,N). We take a
smooth function η that is equal to 1 on B(0,N) and vanishes off B(0,N +1). Then
for h ∈C ∞
0 the support of h(1−η) does not meet the support of u, and we must have
4
u,h
5
=
4
u,hη
5
+
4
u,h(1−η)
5
=
4
u,hη
5
.
The distribution u can be thought of as an element of E ′ by deﬁning for f ∈C ∞(Rn)
4
u, f
5
=
4
u, fη
5
.
Taking m to be the integer that corresponds to the compact set K = B(0,N +1)
in (2.3.2), and using that the L∞norm of ∂α( fη) is controlled by a ﬁnite sum of
seminorms #ρα,N+1( f) with |α| ≤m, we obtain the validity of (2.3.4) for f ∈C ∞.
Example 2.3.17. The support of the Dirac mass at x0 is the set {x0}.
Along the same lines, we give the following deﬁnition:
Deﬁnition 2.3.18. We say that a distribution u in D′(Rn) coincides with the function
h on an open set Ω if
4
u, f
5
=

Rn f(x)h(x)dx
for all f in C ∞
0 (Ω).
(2.3.19)
When (2.3.19) occurs we often say that u agrees with h away from Ω c.
This deﬁnition implies that the support of the distribution u −h is contained in
the set Ω c.
Example 2.3.19. The distribution |x|2 +δa1 +δa2, where a1, a2 are in Rn, coincides
with the function |x|2 on any open set not containing the points a1 and a2. Also, the
distribution in Example 2.3.5 (8) coincides with the function x−1χ|x|≤1 away from
the origin in the real line.
Having ended the streak of deﬁnitions regarding operations with distributions,
we now discuss properties of convolutions and Fourier transforms.

2.3 The Class of Tempered Distributions
127
Theorem 2.3.20. If u ∈S ′ and ϕ ∈S , then ϕ ∗u is a C ∞function and
(ϕ ∗u)(x) = ⟨u,τx #ϕ⟩
for all x ∈Rn. Moreover, for all multi-indices α there exist constants Cα,kα > 0
such that
|∂α(ϕ ∗u)(x)| ≤Cα(1+|x|)kα .
Furthermore, if u has compact support, then ϕ ∗u is a Schwartz function.
Proof. Let ψ be in S (Rn). We have
4
ϕ ∗u,ψ
5
=
4
u, #ϕ ∗ψ
5
= u

Rn #ϕ(· −y)ψ(y)dy

= u

Rn(τy #ϕ)(·)ψ(y)dy

(2.3.20)
=

Rn
4
u,τy #ϕ
5
ψ(y)dy,
where the last step is justiﬁed by the continuity of u and by the fact that the Riemann
sums of the inner integral in (2.3.20) converge to that integral in the topology of S ,
a fact that will be justiﬁed later. This calculation identiﬁes the function ϕ ∗u as
(ϕ ∗u)(x) =
4
u,τx #ϕ
5
.
(2.3.21)
We now show that (ϕ ∗u)(x) is a C ∞function. Let ej = (0,...,1,...,0) with 1
in the jth entry and zero elsewhere. Then
τ−he j(ϕ ∗u)(x)−(ϕ ∗u)(x)
h
= u
τ−he j(τx #ϕ)−τx #ϕ
h

→
4
u,τx(∂j #ϕ)
5
by the continuity of u and the fact that

τ−he j(τx #ϕ) −τx #ϕ

/h tends to ∂jτx #ϕ =
τx(∂j #ϕ) in S as h →0; see Exercise 2.3.5 (a). The same calculation for higher-order
derivatives shows that ϕ ∗u ∈C ∞and that ∂γ(ϕ ∗u) = (∂γϕ)∗u for all multi-indices
γ. It follows from (2.3.3) that for some C, m, and k we have
|∂α(ϕ ∗u)(x)| ≤C ∑
|γ|≤m
|β|≤k
sup
y∈Rn |yγτx(∂α+β #ϕ)(y)|
= C ∑
|γ|≤m
|β|≤k
sup
y∈Rn |(x+y)γ(∂α+β #ϕ)(y)|
≤Cm ∑
|β|≤k
sup
y∈Rn(1+|x|m +|y|m)|(∂α+β #ϕ)(y)|,
(2.3.22)
and this clearly implies that ∂α(ϕ ∗u) grows at most polynomially at inﬁnity.

128
2 Maximal Functions, Fourier Transform, and Distributions
We now indicate why ϕ ∗u is Schwartz whenever u has compact support. Apply-
ing estimate (2.3.4) to the function y →ϕ(x−y) yields that
4
u,ϕ(x−·)
5 = |(ϕ ∗u)(x)| ≤C ∑
|α|≤m
sup
|y|≤N
|∂α
y ϕ(x−y)|
for some constants C,m,N. Since for |x| ≥2N we have
|∂α
y ϕ(x−y)| ≤Cα,M(1+|x−y|)−M ≤Cα,M,N(1+|x|)−M,
it follows that ϕ ∗u decays rapidly at inﬁnity. Since ∂γ(ϕ ∗u) = (∂γϕ)∗u, the same
argument yields that all the derivatives of ϕ ∗u decay rapidly at inﬁnity; hence ϕ ∗u
is a Schwartz function. Incidentally, this argument actually shows that any Schwartz
seminorm of ϕ ∗u is controlled by a ﬁnite sum of Schwartz seminorms of ϕ.
We now return to the point left open concerning the convergence of the Riemann
sums in (2.3.20) in the topology of S (Rn). For each N = 1,2,..., consider a parti-
tion of [−N,N]n into (2N2)n cubes Qm of side length 1/N and let ym be the center
of each Qm. For multi-indices α,β, we must show that
DN(x) =
(2N2)n
∑
m=1
xα∂β
x #ϕ(x−ym)ψ(ym)|Qm|−

Rn xα∂β
x #ϕ(x−y)ψ(y)dy
converges to zero in L∞(Rn) as N →∞. We have
xα∂β
x #ϕ(x−ym)ψ(ym)|Qm|−

Qm
xα∂β
x #ϕ(x−y)ψ(y)dy
=

Qm
xα(y−ym)·∇

∂β
x #ϕ(x−·)ψ

(ξ)dy
for some ξ = y+θ(ym −y), where θ ∈[0,1]. Distributing the gradient to both fac-
tors, we see that the last integrand is at most
C|x||α|
√n
N
1
(1+|x−ξ|)M/2
1
(2+|ξ|)M
for M large (pick M > 2|α|), which in turn is at most
C′ |x||α|
√n
N
1
(1+|x|)M/2
1
(2+|ξ|)M/2 ≤C′ |x||α|
√n
N
1
(1+|x|)M/2
1
(1+|y|)M/2 ,
since |y| ≤|ξ|+θ|y−ym| ≤|ξ|+√n/N ≤|ξ|+1 for N ≥√n. Inserting the estimate
obtained for the integrand in the last displayed integral, we obtain
|DN(x)| ≤C′′
N
|x||α|
(1+|x|)M/2

[−N,N]n
dy
(1+|y|)M/2 +

([−N,N]n)c
|xα∂β
x #ϕ(x−y)ψ(y)|dy.

2.3 The Class of Tempered Distributions
129
But the second integral in the preceding expression is bounded by

([−N,N]n)c
C′′′|x||α|
(1+|x−y|)M
dy
(1+|y|)M ≤
C′′′|x||α|
(1+|x|)M/2

([−N,N]n)c
dy
(1+|y|)M/2 .
Using these estimates it is now easy to see that limN→∞supx∈Rn |DN(x)| = 0.
□
Next we have the following important result regarding distributions with compact
support:
Theorem 2.3.21. If u is in E ′(Rn), then 1u is a real analytic function on Rn. In par-
ticular, 1u is a C ∞function. Furthermore, 1u and all of its derivatives have polynomial
growth at inﬁnity. Moreover, 1u has a holomorphic extension on Cn.
Proof. Given a distribution u with compact support and a polynomial p(ξ), the ac-
tion of u on the C ∞function ξ →p(ξ)e−2πix·ξ is a well deﬁned function of x, which
we denote by u(p(·)e−2πix·(·)). Here x is an element of Rn but the same assertion
is valid if x = (x1,...,xn) ∈Rn is replaced by z = (z1,...,zn) ∈Cn. In this case we
deﬁne the dot product of ξ and z via ξ ·z = ∑n
k=1 ξkzk.
It is straightforward to verify that the function of z = (z1,...,zn)
F(z) = u

e−2πi(·)·z
deﬁned on Cn is holomorphic, in fact entire. Indeed, the continuity and linearity of
u and the fact that (e−2πiξ jh −1)/h →−2πiξ j in C ∞(Rn) as h →0, h ∈C, imply
that F is holomorphic in every variable and its derivative with respect to z j is the
action of the distribution u to the C ∞function
ξ →(−2πiξ j)e−2πi∑n
j=1 ξ jz j .
By induction it follows that for all multi-indices α we have
∂α1
z1 ···∂αn
zn F = u

(−2πi(·))αe−2πi∑n
j=1(·)z j
.
Since F is entire, its restriction on Rn, i.e., F(x1,...,xn), where xj = Re z j, is real
analytic. Also, an easy calculation using (2.3.4) and Leibniz’s rule yield that the
restriction of F on Rn and all of its derivatives have polynomial growth at inﬁnity.
Now for f in S (Rn) we have
4
1u, f
5
=
4
u, 1f
5
= u

Rn f(x)e−2πix·ξ dx

=

Rn f(x)u(e−2πix·(·))dx,
provided we can justify the passage of u inside the integral. The reason for this
is that the Riemann sums of the integral of f(x)e−2πix·ξ over Rn converge to it in
the topology of C ∞, and thus the linear functional u can be interchanged with the
integral. We conclude that the tempered distribution 1u can be identiﬁed with the real
analytic function x →F(x) whose derivatives have polynomial growth at inﬁnity.

130
2 Maximal Functions, Fourier Transform, and Distributions
To justify the fact concerning the convergence of the Riemann sums, we argue as
in the proof of the previous theorem. For each N = 1,2,..., consider a partition of
[−N,N]n into (2N2)n cubes Qm of side length 1/N and let ym be the center of each
Qm. For a multi-index α let
DN(ξ) =
(2N2)n
∑
m=1
f(ym)(−2πiym)αe−2πiym·ξ|Qm|−

Rn f(x)(−2πix)αe−2πix·ξ dx.
We must show that for every M > 0, sup|ξ|≤M |DN(ξ)| converges to zero as N →∞.
Setting g(x) = f(x)(−2πix)α, we write
DN(ξ) =
(2N2)n
∑
m=1

Qm

g(ym)e−2πiym·ξ −g(x)e−2πix·ξ
dx+

([−N,N]n)c g(x)e−2πix·ξ dx.
Using the mean value theorem, we bound the absolute value of the expression inside
the square brackets by

|∇g(zm)|+2π|ξ||g(zm)|
√n
N ≤CK (1+|ξ|)
(1+|zm|)K
√n
N ,
for some point zm in the cube Qm. Since
(2N2)n
∑
m=1

Qm
CK (1+|ξ|)
(1+|zm|)K dx ≤C′
K(1+M) < ∞
for |ξ| ≤M, it follows that sup|ξ|≤M |DN(ξ)| →0 as N →∞.
□
Next we give a proposition that extends the properties of the Fourier transform to
tempered distributions.
Proposition 2.3.22. Given u, v in S ′(Rn), f j, f ∈S , y ∈Rn, b a complex scalar,
α a multi-index, and a > 0, we have
(1)
3
u+v = 1u+ 1v,
(2) 1bu = b1u,
(3) If f j →f in S , then 1f j →1f in S and if uj →u in S ′, then 1uj →1u in S ′ ,
(4) (#u)1= (1u)#,
(5) (τyu)1= e−2πiy·ξ 1u,
(6) (e2πix·yu)1= τy1u ,
(7) (δ au)1= (1u)a = a−nδ a−11u ,
(8) (∂αu)1= (2πiξ)α 1u,
(9) ∂α 1u = ((−2πix)αu)1,

2.3 The Class of Tempered Distributions
131
(10) (1u)∨= u,
(11) 3
f ∗u = 1f 1u,
(12) 2
fu = 1f ∗1u,
(13) (Leibniz’s rule) ∂m
j ( fu) = ∑m
k=0
m
k

(∂k
j f)(∂m−k
j
u), m ∈Z+ ,
(14) (Leibniz’s rule) ∂α( fu) = ∑α1
γ1=0 ···∑αn
γn=0
α1
γ1

···
αn
γn

(∂γ f)(∂α−γu),
(15) If uk, u ∈Lp(Rn) and uk →u in Lp (1 ≤p ≤∞), then uk →u in S ′(Rn).
Therefore, convergence in S implies convergence in Lp, which in turn implies
convergence in S ′(Rn).
Proof. All the statements can be proved easily using duality and the corresponding
statements for Schwartz functions.
□
We continue with an application of Theorem 2.3.21.
Proposition 2.3.23. Given u ∈S ′(Rn), there exists a sequence of C ∞
0 functions fk
such that fk →u in the sense of tempered distributions; in particular, C ∞
0 (Rn) is
dense in S ′(Rn).
Proof. Fix a function in C ∞
0 (Rn) with ϕ(x) = 1 in a neighborhood of the origin.
Let ϕk(x) = δ 1/k(ϕ)(x) = ϕ(x/k). It follows from Exercise 2.3.5 (b) that for u ∈
S ′(Rn), ϕku →u in S ′. By Proposition 2.3.22 (3), we have that the map u →
(ϕk1u)∨is continuous on S ′(Rn). Now Theorem 2.3.21 gives that (ϕk1u)∨is a C ∞
function and therefore ϕj(ϕk1u)∨is in C ∞
0 (Rn). As observed, ϕj(ϕk1u)∨→(ϕk1u)∨in
S ′ when k is ﬁxed and j →∞. Exercise 2.3.5 (c) gives that the diagonal sequence
ϕk(ϕk f)∧converges to 1f in S as k →∞for all f ∈S . Using duality and Exercise
2.2.2, we conclude that the sequence of C ∞
0 functions ϕk(ϕk1u)∨converges to u in
S ′ as k →∞.
□
Exercises
2.3.1. Show that a positive measure μ that satisﬁes

Rn
dμ(x)
(1+|x|)k < +∞,
for some k > 0, can be identiﬁed with a tempered distribution. Show that if we think
of Lebesgue measure as a tempered distribution, then it coincides with the constant
function 1 also interpreted as a tempered distribution.
2.3.2. Let ϕ, f ∈S (Rn), and for ε > 0 let ϕε(x) = ε−nϕ(ε−1x). Prove that
ϕε ∗f →b f in S , where b is the integral of ϕ.

132
2 Maximal Functions, Fourier Transform, and Distributions
2.3.3. Prove that for all a > 0, u ∈S ′(Rn), and f ∈S (Rn) we have
(δ a f)∗(δ au) = a−nδ a( f ∗u).
2.3.4. (a) Prove that the derivative of χ[a,b] is δa −δb.
(b) Compute ∂jχB(0,1) on R2.
(c) Compute the Fourier transforms of the locally integrable functions sinx and cosx.
(d) Prove that the derivative of the distribution log|x| ∈S ′(R) is the distribution
u(ϕ) = lim
ε→0

ε≤|x|
ϕ(x)dx
x .
2.3.5. Let f ∈S (Rn) and let ϕ ∈C ∞
0 be identically equal to 1 in a neighborhood
of the origin. Deﬁne ϕk(x) = ϕ(x/k) as in the proof of Proposition 2.3.23.
(a) Prove that (τ−he j f −f)/h →∂j f in S as h →0.
(b) Prove that ϕk f →f in S as k →∞.
(c) Prove that the sequence ϕk(ϕk f)∧converges to 1f in S as k →∞.
2.3.6. Use Theorem 2.3.21 to show that there does not exist a nonzero C ∞
0 function
whose Fourier transform is also a C ∞
0 function.
2.3.7. Let f ∈Lp(Rn) for some 1 ≤p < ∞. Show that the sequence of functions
gN(ξ) =

B(0,N) f(x)e−2πix·ξ dx
converges to 1f in S ′.
2.3.8. Let (ck)k∈Zn be a sequence that satisﬁes |ck| ≤A(1+|k|)M for all k and some
ﬁxed M and A > 0. Let δk denote Dirac mass at the integer k. Show that the sequence
of distributions
∑
|k|≤N
ckδk
converges to some tempered distribution u in S ′(Rn) as N →∞. Also show that 1u
is the S ′ limit of the sequence of functions
hN(ξ) = ∑
|k|≤N
cke−2πiξ·k .
2.3.9. A distribution in S ′(Rn) is called homogeneous of degree γ ∈C if for all
λ > 0 and for all ϕ ∈S (Rn) we have
4
u,δ λϕ
5
= λ −n−γ4
u,ϕ
5
.
(a) Prove that this deﬁnition agrees with the usual deﬁnition for functions.
(b) Show that δ0 is homogeneous of degree −n.
(c) Prove that if u is homogeneous of degree γ, then ∂αu is homogeneous of degree
γ −|α|.

2.4 More About Distributions and the Fourier Transform
133
(d) Show that u is homogeneous of degree γ if and only if 1u is homogeneous of
degree −n−γ.
2.3.10. (a) Show that the functions einx and e−inx converge to zero in S ′ and D′ as
n →∞. Conclude that multiplication of distributions is not a continuous operation
even when it is deﬁned.
(b) What is the limit of √n(1+n|x|2)−1 in D′(R) as n →∞?
2.3.11. (S. Bernstein) Let f be a bounded function on Rn with 1f supported in the
ball B(0,R). Prove that for all multi-indices α there exist constants Cα,n (depending
only on α and on the dimension n) such that
∂α f

L∞≤Cα,nR|α| f

L∞.

Hint: Write f = f ∗h1/R, where h is a Schwartz function h in Rn whose Fourier
transform is equal to one on the ball B(0,1) and vanishes outside the ball B(0,2).

2.3.12. Let 1Φ be a C ∞
0 function that is equal to 1 in B(0,1) and let 1Θ be a C ∞
function that is equal to 1 in a neighborhood of inﬁnity and equal to zero in a neigh-
borhood of the origin. Prove the following.
(a) For all u in S ′(Rn) we have

1Φ

ξ/2N
1u
∨
→u
in S ′(Rn) as N →∞.
(b) For all u in S ′(Rn) we have

1Θ

ξ/2N
1u
∨
→0
in S ′(Rn) as N →∞.
2.3.13. Prove that there exists a function in Lp for 2 < p < ∞whose distributional
Fourier transform is not a locally integrable function.

Hint: Assume the converse. Then for all f ∈Lp(Rn), 1f is locally integrable and
hence the map f →1f is a well deﬁned linear operator from Lp(Rn) to L1(B(0,M))
for all M > 0 (i.e. ∥1f ∥L1(B(0,M)) < ∞for all f ∈Lp(Rn)). Use the closed graph
theorem to deduce that ∥1f ∥L1(B(0,M)) ≤CM∥f∥Lp(Rn) for some CM < ∞. To violate
this inequality whenever p > 2, take fN(x) = (1 + iN)−n/2e−π(1+iN)−1|x|2 and let
N →∞, noting that 2
fN(ξ) = e−π|ξ|2(1+iN).

2.4 More About Distributions and the Fourier Transform
In this section we discuss further properties of distributions and Fourier transforms
and bring up certain connections that arise between harmonic analysis and partial
differential equations.

134
2 Maximal Functions, Fourier Transform, and Distributions
2.4.1 Distributions Supported at a Point
We begin with the following characterization of distributions supported at a single
point.
Proposition 2.4.1. If u ∈S ′(Rn) is supported in the singleton {x0}, then there exists
an integer k and complex numbers aα such that
u = ∑
|α|≤k
aα∂αδx0.
Proof. Without loss of generality we may assume that x0 = 0. By (2.3.3) we have
that for some C, m, and k,
4
u, f
5 ≤C ∑
|α|≤m
|β|≤k
sup
x∈Rn |xα(∂β f)(x)|
for all f ∈S (Rn).
We now prove that if ϕ ∈S satisﬁes
(∂αϕ)(0) = 0
for all |α| ≤k,
(2.4.1)
then
4
u,ϕ
5
= 0. To see this, ﬁx a ϕ satisfying (2.4.1) and let ζ(x) be a smooth
function on Rn that is equal to 1 when |x| ≥2 and equal to zero for |x| ≤1. Let
ζ ε(x) = ζ(x/ε). Then, using (2.4.1) and the continuity of the derivatives of ϕ at the
origin, it is not hard to show that ρα,β(ζ εϕ −ϕ) →0 as ε →0 for all |α| ≤m and
|β| ≤k. Then
4
u,ϕ
5 ≤
4
u,ζ εϕ
5+
4
u,ζ εϕ −ϕ
5 ≤0+C ∑
|α|≤m
|β|≤k
ρα,β(ζ εϕ −ϕ) →0
as ε →0. This proves our assertion.
Now let f ∈S (Rn). Let η be a C ∞
0 function on Rn that is equal to 1 in a neigh-
borhood of the origin. Write
f(x) = η(x)

∑
|α|≤k
(∂α f)(0)
α!
xα +h(x)

+(1−η(x)) f(x),
(2.4.2)
where h(x) = O(xk+1) as |x| →0. Then ηh satisﬁes (2.4.1) and hence
4
u,ηh
5
= 0
by the claim. Also,
4
u,

(1−η) f
5
= 0
by our hypothesis. Applying u to both sides of (2.4.2), we obtain
4
u, f
5
= ∑
|α|≤k
(∂α f)(0)
α!
u(xαη(x)) = ∑
|α|≤k
aα(∂αδ0)( f),
with aα = (−1)|α|u(xαη(x))/α!. This proves the proposition.
□

2.4 More About Distributions and the Fourier Transform
135
An immediate consequence is the following result.
Corollary 2.4.2. Let u ∈S ′(Rn). If 1u is supported in the singleton {ξ0}, then u is
a ﬁnite linear combination of functions (−2πiξ)αe2πiξ·ξ0, where α is a multi-index.
In particular, if 1u is supported at the origin, then u is a polynomial.
Proof. Proposition 2.4.1 gives that 1u is a linear combination of derivatives of Dirac
masses at ξ0. Then Proposition 2.3.22 (8) yields the required conclusion.
□
2.4.2 The Laplacian
The Laplacian Δ is a partial differential operator acting on tempered distributions
on Rn as follows:
Δ(u) =
n
∑
j=1
∂2
j u.
Solutions of Laplace’s equation Δ(u) = 0 are called harmonic distributions. We have
the following:
Corollary 2.4.3. Let u ∈S ′(Rn) satisfy Δ(u) = 0. Then u is a polynomial.
Proof. Taking Fourier transforms, we obtain that 
Δ(u) = 0. Therefore,
−4π2|ξ|21u = 0
in S ′.
This implies that 1u is supported at the origin, and by Corollary 2.4.2 it follows that
u must be polynomial.
□
Liouville’s classical theorem that every bounded harmonic function must be con-
stant is a consequence of Corollary 2.4.3. See Exercise 2.4.2.
Next we would like to compute the fundamental solutions of Laplace’s equation
in Rn. A distribution is called a fundamental solution of a partial differential operator
L if we have L(u) = δ0. The following result gives the fundamental solution of the
Laplacian.
Proposition 2.4.4. For n ≥3 we have
Δ(|x|2−n) = −(n−2) 2πn/2
Γ (n/2)δ0 ,
(2.4.3)
while for n = 2,
Δ(log|x|) = 2πδ0 .
(2.4.4)
Proof. We use Green’s identity

Ω

vΔ(u)−uΔ(v)

dx =

∂Ω

v ∂u
∂ν −u ∂v
∂ν

ds,

136
2 Maximal Functions, Fourier Transform, and Distributions
where Ω is an open set in Rn with smooth boundary and ∂v/∂ν denotes the
derivative of v with respect to the outer unit normal vector. Take Ω = Rn \B(0,ε),
v = |x|2−n, and u = f a C ∞
0 (Rn) function in the previous identity. The normal deriva-
tive of f(rθ) is the derivative with respect to the radial variable r. Observe that
Δ(|x|2−n) = 0 for x ̸= 0. We obtain

|x|>ε Δ( f)(x)|x|2−n dx = −

|θ|=ε

ε2−n ∂f
∂r −f(rθ)∂r2−n
∂r

dθ,
(2.4.5)
where dθ denotes surface measure on the sphere |θ| = ε. Now observe two things:
ﬁrst, that for some C = C( f) we have


|θ|=ε
∂f
∂r dθ
 ≤Cεn−1 ;
second, that

|θ|=ε f(rθ)ε1−n dθ →ωn−1 f(0)
as ε →0. Letting ε →0 in (2.4.5), we obtain that
lim
ε→0

|x|>ε Δ( f)(x)|x|2−n dx = −(n−2)ωn−1 f(0),
which implies (2.4.3) in view of the formula for ωn−1 given in Appendix A.3.
The proof of (2.4.4) is identical. The only difference is that the quantity ∂r2−n/∂r
in (2.4.5) is replaced by ∂logr/∂r.
□
2.4.3 Homogeneous Distributions
The fundamental solutions of the Laplacian are locally integrable functions on Rn
and also homogeneous of degree 2 −n when n ≥3. Since homogeneous distribu-
tions often arise in applications, it is desirable to pursue their study. Here we do not
undertake such a study in depth, but we discuss a few important examples.
Our ﬁrst goal is to understand the action of the distribution |t|z on Rn when
Rez ≤−n. Let us consider ﬁrst the case n = 1. The tempered distribution
⟨wz,ϕ⟩=
 1
−1 |t|z ϕ(t)dt
is well-deﬁned when Rez > −1. But we can extend the deﬁnition for all z with
Rez > −3 and z ̸= −1 by rewriting it as
⟨wz,ϕ⟩=
 1
−1 |t|z 
ϕ(t)−ϕ(0)−tϕ′(0)

dt +
2
z+1ϕ(0),
(2.4.6)

2.4 More About Distributions and the Fourier Transform
137
and noting that for all ϕ ∈S (R) we have
⟨wz,ϕ⟩
 ≤
1
z+3∥ϕ′′∥L∞+
2
z+1∥ϕ∥L∞,
thus wz ∈S ′(R). Subtracting the Taylor polynomial of degree 3 centered at zero
from ϕ(t) instead of the linear one, as in (2.4.6), allows us to extend the deﬁnition
for Rez > −5 and Rez /∈{−1,−3}. Subtracting higher order Taylor polynomials
allows us to extend the deﬁnition of wz for all z ∈C except at the negative odd
integers. To be able to include the points z = −1,−3,−5,−7,... we need to multiply
wz by an entire function that has simple zeros at all the negative odd integers to be
able to eliminate the simple poles at these points. Such a function is Γ
 z+1
2
−1. This
discussion leads to the following deﬁnition.
Deﬁnition 2.4.5. For z ∈C we deﬁne a distribution uz as follows:
4
uz, f
5
=

Rn
π
z+n
2
Γ
 z+n
2
|x|z f(x)dx.
(2.4.7)
Clearly the uz’s coincide with the locally integrable functions
π
z+n
2 Γ
 z+n
2
−1|x|z
when Rez > −n and the deﬁnition makes sense only for that range of z’s. It follows
from its deﬁnition that uz is a homogeneous distribution of degree z.
We would like to extend the deﬁnition of uz for z ∈C. Let Re z > −n ﬁrst. Fix N
to be a positive integer. Given f ∈S (Rn), write the integral in (2.4.7) as follows:

|x|<1
π
z+n
2
Γ ( z+n
2 )

f(x)−∑
|α|≤N
(∂α f)(0)
α!
xα
+
|x|z dx
+

|x|>1
π
z+n
2
Γ ( z+n
2 ) f(x)|x|z dx+

|x|<1
π
z+n
2
Γ ( z+n
2 ) ∑
|α|≤N
(∂α f)(0)
α!
xα|x|z dx.
The preceding expression is equal to

|x|<1
π
z+n
2
Γ ( z+n
2 )

f(x)−∑
|α|≤N
(∂α f)(0)
α!
xα
+
|x|z dx
+

|x|>1
π
z+n
2
Γ ( z+n
2 ) f(x)|x|z dx
+ ∑
|α|≤N
(∂α f)(0)
α!
π
z+n
2
Γ ( z+n
2 )
 1
r=0

Sn−1(rθ)α rz+n−1 drdθ ,

138
2 Maximal Functions, Fourier Transform, and Distributions
where we switched to polar coordinates in the penultimate integral. Now set
b(n,α,z) =
π
z+n
2
Γ ( z+n
2 )
1
α!

Sn−1θ α dθ
 1
0 r|α|+n+z−1 dr
=
π
z+n
2
Γ ( z+n
2 )
1
α!

Sn−1 θ α dθ
|α|+z+n
,
where α = (α1,...,αn) is a multi-index. These coefﬁcients are zero when at least
one αj is odd. Consider now the case that all the αj’s are even; then |α| is also even.
The function Γ ( z+n
2 ) has simple poles at the points
z = −n, z = −(n+2), z = −(n+4),
and so on;
see Appendix A.5. These poles cancel exactly the poles of the function
z →(|α|+z+n)−1
at z = −n−|α| when |α| is an even integer in [0,N]. We therefore have
4
uz, f
5
=

|x|≥1
π
z+n
2
Γ ( z+n
2 ) f(x)|x|z dx+ ∑
|α|≤N
b(n,α,z)(−1)|α|4
∂αδ0, f
5
+

|x|<1
π
z+n
2
Γ ( z+n
2 )

f(x)−∑
|α|≤N
(∂α f)(0)
α!
xα
+
|x|z dx.
(2.4.8)
Both integrals converge absolutely when Re z > −N −n −1, since the expression
inside the curly brackets above is bounded by a constant multiple of |x|N+1, and
the resulting function of z in (2.4.8) is a well deﬁned analytic function in the range
Re z > −N −n−1.
Since N was arbitrary, ⟨uz, f⟩has an analytic extension to all of C. Therefore,
uz is a distribution-valued entire function of z, i.e., for all ϕ ∈S (Rn), the function
z →⟨uz,ϕ⟩is entire.
Next we would like to calculate the Fourier transform of uz. We know by Exercise
2.3.9 that 1uz is a homogeneous distribution of degree −n−z. The choice of constant
in the deﬁnition of uz was made to justify the following result:
Theorem 2.4.6. For all z ∈C we have 1uz = u−n−z.
Proof. The idea of the proof is straightforward. First we show that for a certain range
of z’s we have

Rn |ξ|z 1ϕ(ξ)dξ = C(n,z)

Rn |x|−n−zϕ(x)dx,
(2.4.9)

2.4 More About Distributions and the Fourier Transform
139
for some ﬁxed constant C(n,z) and all ϕ ∈S (Rn). Next we pick a speciﬁc ϕ to
evaluate the constant C(n,z). Then we use analytic continuation to extend the va-
lidity of (2.4.9) for all z’s. Use polar coordinates by setting ξ = ρϕ and x = rθ in
(2.4.9). We have

Rn |ξ|z 1ϕ(ξ)dξ
=
 ∞
0 ρz+n−1
 ∞
0

Sn−1 ϕ(rθ)

Sn−1 e−2πirρ(θ·ϕ)dϕ

dθ rn−1 drdρ
=
 ∞
0
 ∞
0 σn(rρ)ρz+n−1 dρ

Sn−1 ϕ(rθ)dθ

rn−1 dr
= C(n,z)
 ∞
0 r−z−n

Sn−1 ϕ(rθ)dθ

rn−1 dr
= C(n,z)

Rn |x|−n−zϕ(x)dx,
where we set
σn(t) =

Sn−1 e−2πit(θ·ϕ) dϕ =

Sn−1 e−2πit(ϕ1) dϕ ,
(2.4.10)
C(n,z) =
 ∞
0 σn(t)tz+n−1 dt ,
(2.4.11)
and the second equality in (2.4.10) is a consequence of rotational invariance. It re-
mains to prove that the integral in (2.4.11) converges for some range of z’s.
If n = 1, then
σ1(t) =

S0 e−2πitϕdϕ = e−2πit +e2πit = 2cos(2πt)
and the integral in (2.4.11) converges conditionally for −1 < Re z < 0.
Let us therefore assume that n ≥2. Since |σn(t)| ≤ωn−1, the integral converges
near zero when −n < Re z. Let us study the behavior of σn(t) for t large. Using the
formula in Appendix D.2 and the deﬁnition of Bessel functions in Appendix B.1, we
write
σn(t) = ωn−2
 1
−1 e2πits"
1−s2 n−2
ds
√
1−s2 = cnt−n−2
2 J n−2
2 (2πt),
for some constant cn. Since n ≥2 we have when n−2 > −1/2. Then the asymptotics
for Bessel functions (Appendix B.7) apply and yield |σn(t)| ≤ct−(n−1)/2 for t ≥1.
Splitting the integral in (2.4.11) in t ≤1 and t ≥1 and using the corresponding
estimates, we notice that it converges absolutely on [0,1] when Rez > −n and on
[1,∞) when Re z+n−1−n−1
2
< −1.
We have now proved that when −n < Re z < −n+1
2
and n ≥2 we have
1uz = C(n,z)u−n−z

140
2 Maximal Functions, Fourier Transform, and Distributions
for some constant C(n,z) that we wish to compute. Insert the function ϕ(x) = e−π|x|2
in (2.4.9). Example 2.2.9 gives that this function is equal to its Fourier transform.
Use polar coordinates to write
ωn−1
 ∞
0 rz+n−1e−πr2dr = C(n,z)ωn−1
 ∞
0 r−z−n+n−1e−πr2dr.
Change variables s = πr2 and use the deﬁnition of the gamma function to obtain
that
C(n,z) = Γ ( z+n
2 )
Γ (−z
2)
π−z+n
2
π
z
2
.
It follows that 1uz = u−n−z for the range of z’s considered.
At this point observe that for every f ∈S (Rn), the function z →⟨1uz −u−z−n, f⟩
is entire and vanishes for −n < Rez < −n + 1/2. Therefore, it must vanish every-
where and the theorem is proved.
□
Homogeneous distributions were introduced in Exercise 2.3.9. We already saw
that the Dirac mass on Rn is a homogeneous distribution of degree −n. There is
another important example of a homogeneous distributions of degree −n, which we
now discuss.
Let Ω be an integrable function on the sphere Sn−1 with integral zero. Deﬁne a
tempered distribution WΩ on Rn by setting
4
WΩ, f
5
= lim
ε→0

|x|≥ε
Ω(x/|x|)
|x|n
f(x)dx.
(2.4.12)
We check that WΩ is a well deﬁned tempered distribution on Rn. Indeed, since
Ω(x/|x|)/|x|n has integral zero over all annuli centered at the origin, we obtain
4
WΩ,ϕ
5 =
lim
ε→0

ε≤|x|≤1
Ω(x/|x|)
|x|n
(ϕ(x)−ϕ(0))dx+

|x|≥1
Ω(x/|x|)
|x|n
ϕ(x)dx

≤
∇ϕ

L∞

|x|≤1
|Ω(x/|x|)|
|x|n−1
dx+

sup
x∈Rn |x||ϕ(x)|

|x|≥1
|Ω(x/|x|)|
|x|n+1
dx
≤C1
∇ϕ

L∞
Ω

L1(Sn−1) +C2 ∑
|α|≤1
ϕ(x)xα
L∞
Ω

L1(Sn−1) ,
for suitable constants C1 and C2 in view of (2.2.2).
One can verify that WΩ ∈S ′(Rn) is a homogeneous distribution of degree −n
just like the Dirac mass at the origin. It is an interesting fact that all homogeneous
distributions on Rn of degree −n that coincide with a smooth function away from
the origin arise in this way. We have the following result.
Proposition 2.4.7. Suppose that m is a C ∞function on Rn\{0} that is homogeneous
of degree zero. Then there exist a scalar b and a C ∞function Ω on Sn−1 with integral
zero such that
m∨= bδ0 +WΩ ,
(2.4.13)
where WΩ denotes the distribution deﬁned in (2.4.12).

2.4 More About Distributions and the Fourier Transform
141
To prove this result we need the following proposition, whose proof we postpone
until the end of this section.
Proposition 2.4.8. Suppose that u is a C ∞function on Rn \{0} that is homogeneous
of degree z ∈C. Then 1u is a C ∞function on Rn \{0}.
We now prove Proposition 2.4.7 using Proposition 2.4.8.
Proof. Let a be the integral of the smooth function m over Sn−1. The function m−a
is homogeneous of degree zero and thus locally integrable on Rn; hence it can be
thought of as a tempered distribution that we call 1u (the Fourier transform of a
tempered distribution u). Since 1u is a C ∞function on Rn \ {0}, Proposition 2.4.8
implies that u is also a C ∞function on Rn \ {0}. Let Ω be the restriction of u on
Sn−1. Then Ω is a well deﬁned C ∞function on Sn−1. Since u is a homogeneous
function of degree −n that coincides with the smooth function Ω on Sn−1, it follows
that u(x) = Ω(x/|x|)/|x|n for x in Rn \{0}.
We show that Ω has mean value zero over Sn−1. Pick a nonnegative, radial,
smooth, and nonzero function ψ on Rn supported in the annulus 1 < |x| < 2. Switch-
ing to polar coordinates, we write
4
u,ψ
5
=

Rn
Ω(x/|x|)
|x|n
ψ(x)dx = cψ

Sn−1 Ω(θ)dθ,
4
u,ψ
5
=
4
1u, 1ψ
5
=

Rn(m(ξ)−a) 1ψ(ξ)dξ = c′
ψ

Sn−1

m(θ)−a

dθ = 0,
and thus Ω has mean value zero over Sn−1 (since cψ ̸= 0).
We can now legitimately deﬁne the distribution WΩ, which coincides with the
function Ω(x/|x|)/|x|n on Rn \ {0}. But the distribution u also coincides with this
function on Rn \ {0}. It follows that u −WΩ is supported at the origin. Proposition
2.4.1 now gives that u −WΩ is a sum of derivatives of Dirac masses. Since both
distributions are homogeneous of degree −n, it follows that
u−WΩ = cδ0 .
But u = (m−a)∨= m∨−aδ0, and thus m∨= (c+a)δ0 +WΩ. This proves the propo-
sition.
□
We now turn to the proof of Proposition 2.4.8.
Proof. Let u ∈S ′ be homogeneous of degree z and C ∞on Rn \ {0}. We need to
show that 1u is C ∞away from the origin. We prove that 1u is C M for all M. Fix M ∈Z+
and let α be any multi-index such that
|α| > n+M +Re z.
(2.4.14)

142
2 Maximal Functions, Fourier Transform, and Distributions
Pick a C ∞function ϕ on Rn that is equal to 1 when |x| ≥2 and equal to zero for
|x| ≤1. Write u0 = (1−ϕ)u and u∞= ϕu. Then
∂αu = ∂αu0 +∂αu∞
and thus
3
∂αu = 
∂αu0 + 
∂αu∞,
where the operations are performed in the sense of distributions. Since u0 is com-
pactly supported, Theorem 2.3.21 implies that 
∂αu0 is C ∞. Now Leibniz’s rule gives
that
∂αu∞= v+ϕ∂αu,
where v is a smooth function supported in the annulus 1 ≤|x| ≤2. Then 1v is
C ∞and we need to show only that 
ϕ∂αu is C M. The function ϕ∂αu is ac-
tually C ∞, and by the homogeneity of ∂αu (Exercise 2.3.9 (c)) we obtain that
(∂αu)(x) = |x|−|α|+z(∂αu)(x/|x|). Since ϕ is supported away from zero, it follows
that
|ϕ(x)(∂αu)(x)| ≤
Cα
(1+|x|)|α|−Re z
(2.4.15)
for some Cα > 0. It is now straightforward to see that if a function satisﬁes (2.4.15),
then its Fourier transform is C M whenever (2.4.14) is satisﬁed. See Exercise 2.4.1.
We conclude that 
∂αu∞is a C M function whenever (2.4.14) is satisﬁed; thus so
is 3
∂αu. Since 3
∂αu(ξ) = (2πiξ)α 1u(ξ), we deduce smoothness for 1u away from the
origin. Let ξ ̸= 0. Pick a neighborhood V of ξ such that for η in V we have ηj ̸= 0
for some j ∈{1,...,n}. Consider the multi-index (0,...,|α|,...,0) with |α| in the
jth coordinate and zeros elsewhere. Then (2πiηj)|α|1u(η) is a C M function on V,
and thus so is 1u(η), since we can divide by η|α|
j . We conclude that 1u(ξ) is C M on
Rn \{0}. Since M is arbitrary, the conclusion follows.
□
We end this section with an example that illustrates the usefulness of some of the
ideas discussed in this section.
Example 2.4.9. Let η be a smooth radial function on Rn that is equal to 1 on the
set |x| ≥1/2 and vanishes on the set |x| ≤1/4. Fix z ∈C satisfy 0 < Rez < n. Let
g =

η(x)|x|−z∧be the distributional Fourier transform of η(x)|x|−z. We show that
g is a function that decays faster than |ξ|−N at inﬁnity (for sufﬁciently large positive
number N) and that
g(ξ)−πz−n
2Γ ( n−z
2 )
Γ ( z
2)
|ξ|z−n
(2.4.16)
is a C ∞function on Rn. This example indicates the interplay between the smooth-
ness of a function and the decay of its Fourier transform. The smoothness of the
function η(x)|x|−z near zero has as a consequence the rapid decay of g near inﬁnity,
while the slow decay of η(x)|x|−z at inﬁnity reﬂects the lack of smoothness of g(ξ)
at zero, in view of the moderate blowup |ξ|Rez−n as |ξ| →0.

2.4 More About Distributions and the Fourier Transform
143
To show that g is a function we write it as g = (|x|−z)∧+

(η(x)−1)|x|−z∧and
we observe that the ﬁrst term is a function, since 0 < Rez < n. Using Theorem 2.4.6
we write
g(ξ) = πz−n
2Γ ( n−z
2 )
Γ ( z
2)
|ξ|z−n + 1ϕ(ξ),
where 1ϕ(ξ) =

(η(x)−1)|x|−z∧(ξ) is a C ∞function, since it is the Fourier trans-
form of a compactly supported integrable function. This proves that g is a function
and that the difference in (2.4.16) is C ∞.
Finally, we assert that every derivative of g satisﬁes |∂γg(ξ)| ≤Cγ,N|ξ|−N for all
sufﬁciently large positive integers N when ξ ̸= 0. Indeed, ﬁx a multi-index γ and
write ∂γg(ξ) = (|x|−zη(x)(−2πix)γ)∧(ξ). It follows that
(4π2|ξ|2)N|∂γg(ξ)| =

Δ N(|x|−zη(x)(−2πix)γ)
∧(ξ)

for all N ∈Z+, where Δ is the Laplacian in the x variable. Using Leibniz’s rule
we distribute Δ N to the product. If a derivative falls on η, we obtain a compactly
supported smooth function, hence integrable. If all derivatives fall on |x|−zxγ, then
we obtain a term that decays like |x|−Rez+|γ|−2N at inﬁnity, which is also integrable
if N is sufﬁciently large. Thus the function |ξ|2N|∂γg(ξ)| is equal to the Fourier
transform of an L1 function, hence it is bounded, when 2N > n−Rez+|γ|.
Exercises
2.4.1. Suppose that a function f satisﬁes the estimate
| f(x)| ≤
C
(1+|x|)N ,
for some C > 0 and N > n+1. Then 1f is C M for all M ∈Z+ with 1 ≤M < N −n.
2.4.2. Use Corollary 2.4.3 to prove Liouville’s theorem that every bounded har-
monic function on Rn must be a constant. Derive as a consequence the fundamental
theorem of algebra, stating that every polynomial on C must have a complex root.
2.4.3. Prove that ex is not in S ′(R) but that exeiex is in S ′(R).
2.4.4. Show that the Schwartz function x →sech(πx), x ∈R, coincides with its
Fourier transform.

Hint: Integrate the function eiaz over the rectangular contour with corners (−R,0),
(R,0), (R,iπ), and (−R,iπ).

2.4.5. ([174]) Construct an uncountable family of linearly independent Schwartz
functions fa such that | fa| = | fb| and | 1fa| = | 1fb| for all fa and fb in the family.

Hint: Let w be a smooth nonzero function whose Fourier transform is supported

144
2 Maximal Functions, Fourier Transform, and Distributions
in the interval [−1/2,1/2] and let φ be a real-valued smooth nonconstant periodic
function with period 1. Then take fa(x) = w(x)eiφ(x−a) for a ∈R.

2.4.6. Let Py be the Poisson kernel deﬁned in (2.1.13). Prove that for f ∈Lp(Rn),
1 ≤p < ∞, the function
(x,y) →(Py ∗f)(x)
is a harmonic function on Rn+1
+ . Use the Fourier transform and Exercise 2.2.11 to
prove that (Py1 ∗Py2)(x) = Py1+y2(x) for all x ∈Rn.
2.4.7. (a) For a ﬁxed x0 ∈Sn−1, show that the function
v(x;x0) = 1−|x|2
|x−x0|n
is harmonic on Rn \{x0}.
(b) For ﬁxed x0 ∈Sn−1, prove that the family of functions θ →v(rx0;θ), 0 < r < 1,
deﬁned on the sphere satisﬁes
lim
r↑1

θ∈Sn−1
|θ−x0|>δ
v(rx0;θ)dθ = 0
uniformly in x0. The function v(rx0;θ) is called the Poisson kernel for the sphere.
(c) Show that
1
ωn−1
(1−|x|2)

Sn−1
1
|x−θ|n dθ = 1
for all |x| < 1.
(d) Let f be a continuous function on Sn−1. Prove that the function
u(x) =
1
ωn−1
(1−|x|2)

Sn−1
f(θ)
|x−θ|n dθ
solves the Dirichlet problem Δ(u) = 0 on |x| < 1 with boundary values u = f on
Sn−1, in the sense limr↑1 u(rx0) = f(x0) when |x0| = 1.

Hint: Part (c): Apply the mean value property over spheres to the harmonic function
y →(1−|x|2|y|2)
|x|y−x
|x|
−n.

2.4.8. Fix n ∈Z+ with n ≥2 and a real number λ, 0 < λ < n. Also ﬁx η ∈Sn and
y ∈Rn.
(a) Prove that

Sn |ξ −η|−λ dξ = 2n−λ π
n
2Γ ( n−λ
2 )
Γ (n−λ
2 )
.
(b) Prove that

Rn |x−y|−λ(1+|x|2)
λ
2 −n dx = π
n
2Γ ( n−λ
2 )
Γ (n−λ
2 )
(1+|y|2)−λ
2 .

2.4 More About Distributions and the Fourier Transform
145

Hint: Part (a): See Appendix D.4 Part (b): Use the stereographic projection in
Appendix D.6.

2.4.9. Prove the following beta integral identity:

Rn
dt
|x−t|α1|y−t|α2 = π
n
2 Γ
 n−α1
2

Γ
 n−α2
2

Γ
 α1+α2−n
2

Γ
 α1
2

Γ
 α2
2

Γ

n−α1+α2
2

|x−y|n−α1−α2,
where 0 < α1,α2 < n, α1 +α2 > n.

Hint: Reduce to the case y = 0, interpret the integral as a convolution, and use
Theorem 2.4.6.

2.4.10. (a) Prove that if a continuous integrable function f on Rn (n ≥2) is constant
on the spheres rSn−1 for all r > 0, then so is its Fourier transform.
(b) If a continuous integrable function on Rn (n ≥3) is constant on all (n −2)–
dimensional spheres orthogonal to e1 = (1,0,...,0), then its Fourier transform has
the same property.
2.4.11. ([137]) Suppose that 0 < d1,d2,d3 < n satisfy d1 +d2 +d3 = 2n. Prove that
for any distinct x,y,z ∈Rn we have the identity

Rn |x−t|−d2|y−t|−d3|z−t|−d1dt
= π
n
2
 3
∏
j=1
Γ

n−d j
2

Γ
 d j
2


|x−y|d1−n|y−z|d2−n|z−x|d3−n.

Hint: Reduce matters to the case that z = 0 and y = e1. Then take the Fourier
transform in x and use that the function h(t) = |t −e1|−d3|t|−d1 satisﬁes 1h(ξ) =
1h(A−2
ξ ξ) for all ξ ̸= 0, where Aξ is an orthogonal matrix with Aξe1 = ξ/|ξ|.

2.4.12. (a) Integrate the function eiz2 over the contour consisting of the three pieces
P1 = {x+i0 : 0 ≤x ≤R}, P2 = {Reiθ : 0 ≤θ ≤π
4 }, and P3 = {rei π
4 : 0 ≤r ≤R}
(with the proper orientation) to obtain the Fresnel integral identity:
lim
R→∞
 R
0 eix2 dx =
√
2π
4 (1+i).
(b) Use the result in part (a) to show that the Fourier transform of the function eiπ|x|2
in Rn is equal to ei πn
4 e−iπ|ξ|2.

Hint: Part (a): On P2 we have e−R2sin(2θ) ≤e−4
π R2θ, and the integral over P2 tends
to 0. Part (b): Try ﬁrst n = 1.


146
2 Maximal Functions, Fourier Transform, and Distributions
2.5 Convolution Operators on Lp Spaces and Multipliers
In this section we study the class of operators that commute with translations. We
prove in this section that bounded operators that commute with translations must be
of convolution type. Convolution operators arise in many situations, and we would
like to know under what circumstances they are bounded between Lp spaces.
2.5.1 Operators That Commute with Translations
Deﬁnition 2.5.1. A vector space X of measurable functions on Rn is called closed
under translations if for f ∈X we have τz( f) ∈X for all z ∈Rn. Let X and Y be
vector spaces of measurable functions on Rn that are closed under translations. Let
also T be an operator from X to Y. We say that T commutes with translations or is
translation-invariant if
T(τy( f)) = τy(T( f))
for all f ∈X and all y ∈Rn.
It is straightforward to see that convolution operators commute with translations,
i.e., τy( f ∗g) = τy( f) ∗g whenever the convolution is deﬁned. One of the goals of
this section is to prove the converse: every bounded linear operator that commutes
with translations is of convolution type. We have the following:
Theorem 2.5.2. Let 1 ≤p,q ≤∞and suppose T is a bounded linear operator from
Lp(Rn) to Lq(Rn) that commutes with translations. Then there exists a unique tem-
pered distribution w such that
T( f) = f ∗w
a.e. for all f ∈S .
A very important point to make is that if p = ∞, the restriction of T on S does
not uniquely determine T on the entire L∞; see Example 2.5.9 and the comments
preceding it about this. The theorem is a consequence of the following two results:
Lemma 2.5.3. Under the hypotheses of Theorem 2.5.2 and for f ∈S (Rn), the dis-
tributional derivatives of T( f) are Lq functions that satisfy
∂α
T( f)

= T(∂α f),
for all multi-indices α.
(2.5.1)
Lemma 2.5.4. Let 1 ≤q ≤∞and let h ∈Lq(Rn). If all distributional derivatives
∂αh are also in Lq, then h is almost everywhere equal to a continuous function H
satisfying
|H(0)| ≤Cn,q ∑
|α|≤n+1
∂αh

Lq .
(2.5.2)

2.5 Convolution Operators on Lp Spaces and Multipliers
147
Proof. Assuming Lemmas 2.5.3 and 2.5.4, we prove Theorem 2.5.2.
Given f ∈S (Rn), by Lemmas 2.5.3 and 2.5.4, there is a continuous function H
such that T( f) = H a.e. and such that
|H(0)| ≤Cn,q ∑
|α|≤n+1
∂αT( f)

Lq
holds. Deﬁne a linear functional u on S by setting
4
u, f
5
= H(0).
This functional is well-deﬁned, for, if there is another continuous function G such
that G = T( f) a.e., then G = H a.e. and since both functions are continuous, it
follows that H = G everywhere and thus H(0) = G(0).
By (2.5.1), (2.5.2), and the boundedness of T, we have
4
u, f
5 ≤Cn,q ∑
|α|≤n+1
∂αT( f)

Lq
≤Cn,q ∑
|α|≤n+1
T(∂α f)

Lq
≤Cn,q
T

Lp→Lq ∑
|α|≤n+1
∂α f

Lp
≤C′
n,q
T

Lp→Lq
∑
|γ|≤[ n+1
p ]+1
|α|≤n+1
ργ,α( f),
where the last estimate uses (2.2.8). This implies that u is in S ′. We now set w = #u
and we claim that for all x ∈Rn we have
4
u,τ−x f
5
= H(x).
(2.5.3)
Assuming (2.5.3) we prove that T( f) = f ∗w for f ∈S . To see this, by Theorem
2.3.20 and by the translation invariance of T, for a given f ∈S (Rn) we have
( f ∗w)(x) =
4
#u,τx #f
5
=
4
u,τ−x f
5
= H(x) = T( f)(x),
where the last equality holds for almost all x, by the deﬁnition of H. Thus f ∗w =
T( f) a.e., as claimed. The uniqueness of w follows from the simple observation that
if f ∗w = f ∗w′ for all f ∈S (Rn), then w = w′.
We now turn to the proof of (2.5.3). Given f ∈S (Rn) and x ∈Rn and let Hx
be the continuous function such that Hx = T(τ−x f). We show that Hx(0) = H(x).
Indeed, we have
Hx(y) = T(τ−x f)(y) = τ−xT( f)(y) = T( f)(x+y) = H(x+y) = τ−xH(y),

148
2 Maximal Functions, Fourier Transform, and Distributions
where the equality T( f)(x + y) = H(x + y) holds a.e. in y. Thus the continuous
functions Hx and τ−xH are equal a.e. and thus they must be everywhere equal,
in particular, when y = 0. This proves that Hx(0) = H(x), which is a restatement
of (2.5.3).
□
We now return to Lemmas 2.5.3 and 2.5.4. We begin with Lemma 2.5.3.
Proof. Consider ﬁrst the multi-index α = (0,...,1,...,0), where 1 is in the jth
entry and 0 is elsewhere. Let ej = (0,...,1,...,0), where 1 is in the jth entry and
zero elsewhere. We have

Rn T( f)(y)ϕ(y+hej)−ϕ(y)
h
dy =

Rn ϕ(y)T
τhe j( f)−f
h

(y)dy
(2.5.4)
since both of these expressions are equal to

Rn ϕ(y)T( f)(y−hej)−T( f)(y)
h
dy
and T commutes with translations. We will let h →0 in both sides of (2.5.4). We
write
ϕ(y+hej)−ϕ(y)
h
=
 1
0 ∂jϕ(y+htej)dt ,
from which it follows that for |h| < 1/2 we have

ϕ(y+hej)−ϕ(y)
h
 ≤
 1
0
CM dt
(1+|y+htej|)M ≤
 1
0
CM dt
(1+|y|−1
2)M ≤
C′
M
(|y|+1)M .
The integrand on the left-hand side of (2.5.4) is bounded by the integrable function
|T( f)(y)|C′
M(|y| + 1)−M and converges to T( f)(y)∂jϕ(y) as h →0. The Lebesgue
dominated convergence theorem yields that the integral on the left-hand side of
(2.5.4) converges to

Rn T( f)(y)∂jϕ(y)dy.
(2.5.5)
Moreover, for a Schwartz function f we have
τhe j( f)(y)−f(y)
h
=
 1
0 ∂j f(y+htej)dt ,
which converges to ∂j f(y) pointwise as h →0 and is bounded by C′
M(1+|y|)−M for
|h| < 1/2 by an argument similar to the preceding one for ϕ in place of f. Thus
τhe j( f)−f
h
→∂j f
in Lp as h →0,
(2.5.6)

2.5 Convolution Operators on Lp Spaces and Multipliers
149
by the Lebesgue dominated convergence theorem. The boundedness of T from Lp
to Lq yields that
T
τhe j( f)−f
h

→T(∂j f)
in Lq as h →0.
(2.5.7)
Since ϕ ∈Lq′, by H¨older’s inequality, the right-hand side of (2.5.4) converges to

Rn ϕ(y)T(∂j f)(y)dy
as h →0. This limit is equal to (2.5.5) and the required conclusion follows for α =
(0,...,0,1,0,...,0). The general case follows by induction on |α|.
□
We now prove Lemma 2.5.4.
Proof. Let R ≥1. Fix a C ∞
0 function ϕR that is equal to 1 in the ball |x| ≤R and
equal to zero when |x| ≥2R. Since h is in Lq(Rn), it follows that ϕRh is in L1(Rn).
We show that 3
ϕRh is also in L1. We begin with the inequality
1 ≤Cn(1+|x|)−(n+1) ∑
|α|≤n+1
|(−2πix)α|,
(2.5.8)
which is just a restatement of (2.2.3). Now multiply (2.5.8) by |3
ϕRh(x)| to obtain
|3
ϕRh(x)| ≤Cn(1+|x|)−(n+1) ∑
|α|≤n+1
|(−2πix)α 3
ϕRh(x)|
≤Cn(1+|x|)−(n+1) ∑
|α|≤n+1
(∂α(ϕRh))∧
L∞
≤Cn(1+|x|)−(n+1) ∑
|α|≤n+1
∂α(ϕRh)

L1
≤Cn(2nRnvn)1/q′(1+|x|)−(n+1) ∑
|α|≤n+1
∂α(ϕRh)

Lq
≤Cn,R(1+|x|)−(n+1) ∑
|α|≤n+1
∂αh

Lq ,
where we used Leibniz’s rule (Proposition 2.3.22 (14)) and the fact that all deriva-
tives of ϕR are pointwise bounded by constants depending on R.
Integrate the previously displayed inequality with respect to x to obtain
3
ϕRh

L1 ≤CR,n ∑
|α|≤n+1
∂αh

Lq < ∞.
(2.5.9)
Therefore, Fourier inversion holds for ϕRh (see Exercise 2.2.6). This implies that
ϕRh is equal a.e. to a continuous function, namely the inverse Fourier transform of
its Fourier transform. Since ϕR = 1 on the ball B(0,R), we conclude that h is a.e.
equal to a continuous function in this ball. Since R > 0 was arbitrary, it follows that

150
2 Maximal Functions, Fourier Transform, and Distributions
h is a.e. equal to a continuous function on Rn, which we denote by H. Finally, (2.5.2)
is a direct consequence of (2.5.9) with R = 1, since |H(0)| ≤∥3
ϕ1h∥L1.
□
2.5.2 The Transpose and the Adjoint of a Linear Operator
We brieﬂy discuss the notions of the transpose and the adjoint of a linear operator.
We ﬁrst recall real and complex inner products. For f,g measurable functions on
Rn, we deﬁne the complex inner product
4
f |g
5
=

Rn f(x)g(x)dx,
whenever the integral converges absolutely. We reserve the notation
4
f,g
5
=

Rn f(x)g(x)dx
for the real inner product on L2(Rn) and also for the action of a distribution f on
a test function g. (This notation also makes sense when a distribution f coincides
with a function.)
Let 1 ≤p,q ≤∞. For a bounded linear operator T from Lp(X,μ) to Lq(Y,ν) we
denote by T ∗its adjoint operator deﬁned by
4
T( f)|g
5
=

Y T( f)gdν =

X f T ∗(g)dμ =
4
f |T ∗(g)
5
(2.5.10)
for f in Lp(X,μ) and g in Lq′(Y,ν) (or in a dense subspace of it). We also deﬁne the
transpose of T as the unique operator Tt that satisﬁes
4
T( f),g
5
=

Y T( f)gdx =

X f Tt(g)dx =
4
f,Tt(g)
5
for all f ∈Lp(X,μ) and all g ∈Lq′(Y,ν).
If T is an integral operator of the form
T( f)(x) =

X K(x,y) f(y)dμ(y),
then T ∗and Tt are also integral operators with kernels K∗(x,y) = K(y,x) and
Kt(x,y) = K(y,x), respectively. If T has the form T( f) = ( 1fm)∨, that is, it is given
by multiplication on the Fourier transform by a (complex-valued) function m(ξ),
then T ∗is given by multiplication on the Fourier transform by the function m(ξ).
Indeed for f,g in S (Rn) we have

2.5 Convolution Operators on Lp Spaces and Multipliers
151

Rn f T ∗(g)dx =

Rn T( f) gdx
=

Rn

T( f) 1gdξ
=

Rn
1f m 1gdξ
=

Rn f (m 1g)∨dx.
A similar argument (using Theorem 2.2.14 (5)) gives that if T is given by multipli-
cation on the Fourier transform by the function m(ξ), then Tt is given by multipli-
cation on the Fourier transform by the function m(−ξ). Since the complex-valued
functions m(ξ) and m(−ξ) may be different, the operators T ∗and Tt may be dif-
ferent in general. Also, if m(ξ) is real-valued, then T is self-adjoint (i.e., T = T ∗)
while if m(ξ) is even, then T is self-transpose (i.e., T = Tt).
2.5.3 The Spaces M p,q(Rn)
Deﬁnition 2.5.5. Given 1 ≤p,q ≤∞, we denote by M p,q(Rn) the set of all bounded
linear operators from Lp(Rn) to Lq(Rn) that commute with translations.
By Theorem 2.5.2 we have that every T in M p,q is given by convolution with a
tempered distribution. We introduce a norm on M p,q by setting
T

M p,q =
T

Lp→Lq,
that is, the norm of T in M p,q is the operator norm of T as an operator from Lp to
Lq. It is a known fact that under this norm, M p,q is a complete normed space (i.e.,
a Banach space).
Next we show that when p > q the set M p,q consists of only one element, namely
the zero operator T = 0. This means that the only interesting classes of operators
arise when p ≤q.
Theorem 2.5.6. M p,q = {0} whenever 1 ≤q < p < ∞.
Proof. Let f be a nonzero C ∞
0 function and let h ∈Rn. We have
τh(T( f))+T( f)

Lq =
T(τh( f)+ f)

Lq ≤
T

Lp→Lq
τh( f)+ f

Lp.
Now let |h| →∞and use Exercise 2.5.1. We conclude that
2
1
q T( f)

Lq ≤
T

Lp→Lq2
1
p f

Lp ,
which is impossible if q < p unless T is the zero operator.
□

152
2 Maximal Functions, Fourier Transform, and Distributions
Next we have a theorem concerning the duals of the spaces M p,q(Rn).
Theorem 2.5.7. Let 1 < p ≤q < ∞and T ∈M p,q(Rn). Then T can be deﬁned on
Lq′(Rn), coinciding with its previous deﬁnition on the subspace Lp(Rn)∩Lq′(Rn) of
Lp(Rn), so that it maps Lq′(Rn) to Lp′(Rn) with norm
T

Lq′→Lp′ =
T

Lp→Lq .
(2.5.11)
In other words, we have the following isometric identiﬁcation of spaces:
M q′,p′(Rn) = M p,q(Rn).
Proof. We ﬁrst observe that if T : Lp →Lq is given by convolution with u ∈S ′, then
the adjoint operator T ∗: Lq′ →Lp′ is given by convolution with #u ∈S ′. Indeed, for
f,g ∈S (Rn) we have

Rn f T ∗(g)dx =

RnT( f)gdx
=

Rn( f ∗u)gdx
=

Rn f (g∗#u)dx
=

Rn f g∗#udx.
Therefore T ∗is given by convolution with #u when applied to Schwartz functions.
Next we observe the validity of the identity
f ∗#u = ( #f ∗u)#,
f ∈S .
(2.5.12)
It remains to show that T (convolution with u) and T ∗(convolution with #u) map Lq′
to Lp′ with the same norm. But this easily follows from (2.5.12), which implies that
f ∗#u

Lp′
 f

Lq′
=
 #f ∗u

Lp′
 #f

Lq′
,
for all nonzero Schwartz functions f. We conclude that
∥T ∗∥Lq′→Lp′ = ∥T∥Lq′→Lp′
and therefore
∥T∥Lp→Lq = ∥T∥Lq′→Lp′ .
This establishes the claimed assertion.
□
We next focus attention on the spaces M p,q(Rn) whenever p = q. These spaces
are of particular interest, since they include the singular integral operators, which
we study in Chapter 5.

2.5 Convolution Operators on Lp Spaces and Multipliers
153
2.5.4 Characterizations of M 1,1(Rn) and M 2,2(Rn)
It would be desirable to have a characterization of the spaces M p,p in terms of
properties of the convolving distribution. Unfortunately, this is unknown at present
(it is not clear whether it is possible) except for certain cases.
Theorem 2.5.8. An operator T is in M 1,1(Rn) if and only if it is given by convo-
lution with a ﬁnite Borel (complex-valued) measure. In this case, the norm of the
operator is equal to the total variation of the measure.
Proof. If T is given with convolution with a ﬁnite Borel measure μ, then clearly T
maps L1 to itself and ∥T∥L1→L1 ≤∥μ∥M , where ∥μ∥M is the total variation of μ.
Conversely, let T be an operator bounded from L1 to L1 that commutes with trans-
lations. By Theorem 2.5.2, T is given by convolution with a tempered distribution
u. Let
fε(x) = ε−ne−π|x/ε|2 .
Since the functions fε are uniformly bounded in L1, it follows from the boundedness
of T that fε ∗u are also uniformly bounded in L1. Since L1 is naturally embedded in
the space of ﬁnite Borel measures, which is the dual of the space C00 of continuous
functions that tend to zero at inﬁnity, we obtain that the family fε ∗u lies in a ﬁxed
multiple of the unit ball of C ∗
00. By the Banach–Alaoglu theorem, this is a weak∗
compact set. Therefore, some subsequence of fε ∗u converges in the weak∗topology
to a measure μ. That is, for some εk →0 and all g ∈C00(Rn) we have
lim
k→∞

Rn g(x)( fεk ∗u)(x)dx =

Rn g(x)dμ(x).
(2.5.13)
We claim that u = μ. To see this, ﬁx g ∈S . Equation (2.5.13) implies that
4
u, #fεk ∗g
5
=
4
u, fεk ∗g
5
→
4
μ,g
5
as k →∞. Exercise 2.3.2 gives that g∗fεk converges to g in S . Therefore,
4
u, fεk ∗g
5
→
4
u,g
5
.
It follows from (2.5.13) that ⟨u,g⟩= ⟨μ,g⟩, and since g was arbitrary, u = μ.
Next, (2.5.13) implies that for all g ∈C00 we have


Rn g(x)dμ(x)
 ≤
g

L∞sup
k
 fεk ∗u

L1 ≤
g

L∞
T

L1→L1.
(2.5.14)
The Riesz representation theorem gives that the norm of the functional
g →

Rn g(x)dμ(x)
on C00 is exactly ∥μ∥M . It follows from (2.5.14) that ∥T∥L1→L1 ≥∥μ∥M . Since the
reverse inequality is obvious, we conclude that ∥T∥L1→L1 = ∥μ∥M .
□

154
2 Maximal Functions, Fourier Transform, and Distributions
Let μ be a ﬁnite Borel measure. The operator h →h ∗μ maps Lp(Rn) to itself
for all 1 ≤p ≤∞; hence M 1,1(Rn) can be identiﬁed with a subspace of M ∞,∞(Rn).
But there exist bounded linear operators Φ on L∞that commute with translations
for which there does not exist a ﬁnite Borel measure μ such that Φ(h) = h ∗μ for
all h ∈L∞(Rn). The following example captures such a behavior.
Example 2.5.9. Let (X,∥· ∥L∞) be the space of all complex-valued bounded func-
tions on the real line such that
Φ( f) = lim
R→+∞
1
R
 R
0 f(t)dt
exists. Then Φ is a bounded linear functional on X with norm 1 and has a bounded
extension #Φ on L∞with norm 1, by the Hahn–Banach theorem. We may view #Φ
as a bounded linear operator from L∞(R) to the space of constant functions, which
is contained in L∞(R). We note that #Φ commutes with translations, since for all
f ∈L∞(R) and x ∈R we have
#Φ(τx( f))−τx( #Φ( f)) = #Φ(τx( f))−#Φ( f) = #Φ(τx( f)−f) = Φ(τx( f)−f) = 0,
where the last two equalities follow from the fact that for L∞functions f the expres-
sion 1
R
 R
0 ( f(t −x)−f(t))dt is bounded by |x|
R ∥f∥L∞when R > |x| and thus tends to
zero as R →∞. If Φ(ϕ) = ϕ ∗u for some u ∈S ′(Rn) and all ϕ ∈S (Rn), since Φ
vanishes on S , the uniqueness in Theorem 2.5.2 yields that u = 0. Hence, if there
existed a ﬁnite Borel measure μ such that #Φ(h) = h∗μ all h ∈L∞, in particular we
would have 0 = Φ(ϕ) = ϕ ∗μ for all ϕ ∈S , hence μ would be the zero measure.
But obviously, this is not the case, since Φ is not the zero operator on X.
We now study the case p = 2. We have the following theorem:
Theorem 2.5.10. An operator T is in M 2,2(Rn) if and only if it is given by convo-
lution with some u ∈S ′ whose Fourier transform 1u is an L∞function. In this case
the norm of T : L2 →L2 is equal to ∥1u∥L∞.
Proof. If 1u ∈L∞, Plancherel’s theorem gives

Rn | f ∗u|2 dx =

Rn | 1f(ξ)1u(ξ)|2 dξ ≤
1u
2
L∞
 1f
2
L2 ;
therefore, ∥T∥L2→L2 ≤∥1u∥L∞, and hence T is in M 2,2(Rn).
Now suppose that T ∈M 2,2(Rn) is given by convolution with a tempered distri-
bution u. We show that 1u is a bounded function. For R > 0 let ϕR be a C ∞
0 function
supported inside the ball B(0,2R) and equal to one on the ball B(0,R). The product
of the function ϕR with the distribution 1u is ϕR1u = ((ϕR)∨∗u)1= T(ϕ∨
R )1, which
is an L2 function. Since the L2 function ϕR1u coincides with the distribution 1u on
the set B(0,R), it follows that 1u is in L2(B(0,R)) for all R > 0 and therefore it is

2.5 Convolution Operators on Lp Spaces and Multipliers
155
in L2
loc. If f ∈L∞(Rn) has compact support, the function f 1u is in L2, and therefore
Plancherel’s theorem and the boundedness of T give

Rn | f(x)1u(x)|2 dx =

Rn |T( f ∨)(x)|2 dx ≤
T
2
L2→L2

Rn | f(x)|2 dx.
We conclude that for all bounded functions with compact support f we have

Rn

∥T∥2
L2→L2 −|1u(x)|2
| f(x)|2 dx ≥0.
Taking f(x1,...,xn) = (2r)−n/2 ∏n
j=1 χ[−r,r](xj) for r > 0 and using Corollary 2.1.16,
we obtain that ∥T∥2
L2→L2 −|1u(x)|2 ≥0 for almost all x. Hence 1u is in L∞and ∥1u∥L∞≤
∥T∥L2→L2. Combining this with the estimate ∥T∥L2→L2 ≤∥1u∥L∞, which holds if
1u ∈L∞, we deduce that ∥T∥L2→L2 = ∥1u∥L∞.
□
2.5.5 The Space of Fourier Multipliers Mp(Rn)
We have now characterized all convolution operators that map L2 to L2. Suppose
now that T is in M p,p, where 1 < p < 2. As discussed in Theorem 2.5.7, T also
maps Lp′ to Lp′. Since p < 2 < p′, by Theorem 1.3.4, it follows that T also maps L2
to L2. Thus T is given by convolution with a tempered distribution whose Fourier
transform is a bounded function.
Deﬁnition 2.5.11. Given 1 ≤p < ∞, we denote by Mp(Rn) the space of all bounded
functions m on Rn such that the operator
Tm( f) = ( 1f m)∨,
f ∈S ,
is bounded on Lp(Rn) (or is initially deﬁned in a dense subspace of Lp(Rn) and has
a bounded extension on the whole space). The norm of m in Mp(Rn) is deﬁned by
m

Mp =
Tm

Lp→Lp.
(2.5.15)
Deﬁnition 2.5.11 implies that m ∈Mp if and only if Tm ∈M p,p. Elements of
the space Mp are called Lp multipliers or Lp Fourier multipliers. It follows from
Theorem 2.5.10 that M2, the set of all L2 multipliers, is L∞. Theorem 2.5.8 implies
that M1(Rn) is the set of the Fourier transforms of ﬁnite Borel measures that is
usually denoted by M (Rn). Theorem 2.5.7 states that a bounded function m is an
Lp multiplier if and only if it is an Lp′ multiplier, and in this case
m

Mp =
m

Mp′ ,
1 < p < ∞.

156
2 Maximal Functions, Fourier Transform, and Distributions
It is a consequence of Theorem 1.3.4 that the normed spaces Mp are nested, that is,
for 1 ≤p ≤q ≤2 we have
M1 ⫅Mp ⫅Mq ⫅M2 = L∞.
Moreover, if m ∈Mp and 1 ≤p ≤2 ≤p′, Theorem 1.3.4 gives
Tm

L2→L2 ≤
Tm

1
2
Lp→Lp
Tm

1
2
Lp′→Lp′ =
Tm

Lp→Lp ,
(2.5.16)
since 1/2 = (1/2)/p+(1/2)/p′. Theorem 1.3.4 also gives that
m

Mp ≤
m

Mq
whenever 1 ≤q ≤p ≤2. Thus the Mp’s form an increasing family of spaces as p
increases from 1 to 2.
Example 2.5.12. The function m(ξ) = e2πiξ·b is an Lp multiplier for all b ∈Rn,
since the corresponding operator Tm( f)(x) = f(x+b) is bounded on Lp(Rn). Clearly
∥m∥Mp = 1.
Proposition 2.5.13. For 1 ≤p < ∞, the normed space

Mp,∥· ∥Mp

is a Banach
space. Furthermore, Mp is closed under pointwise multiplication and is a Banach
algebra.
Proof. It sufﬁces to consider the case 1 ≤p ≤2. It is straightforward that if m1, m2
are in Mp and b ∈C then m1 + m2 and bm1 are also in Mp. Observe that m1m2 is
the multiplier that corresponds to the operator Tm1Tm2 = Tm1m2 and thus
m1m2

Mp =
Tm1Tm2

Lp→Lp ≤
m1

Mp
m2

Mp.
This proves that Mp is an algebra. To show that Mp is a complete normed space,
consider a Cauchy sequence mj in Mp. It follows from (2.5.16) that mj is Cauchy in
L∞, and hence it converges to some bounded function m in the L∞norm; moreover
all the mj are a.e. bounded by some constant C uniformly in j. We have to show that
m ∈Mp. Fix f ∈S . We have
Tmj( f)(x) =

Rn
1f(ξ)mj(ξ)e2πix·ξ dξ →

Rn
1f(ξ)m(ξ)e2πix·ξ dξ = Tm( f)(x)
a.e. by the Lebesgue dominated convergence theorem, since C| 1f | is an integrable
upper bound of all integrands on the left in the preceding expression. Since {mj}j
is a Cauchy sequence in Mp, it is bounded in Mp, and thus sup j ∥mj∥Mp < +∞. An
application of Fatou’s lemma yields that

Rn |Tm( f)|p dx =

Rn liminf
j→∞|Tmj( f)|p dx
≤liminf
j→∞

Rn |Tmj( f)|p dx
≤liminf
j→∞
mj
p
Mp
f
p
Lp ,

2.5 Convolution Operators on Lp Spaces and Multipliers
157
which implies that m ∈Mp. This argument shows that if mj ∈Mp and mj →m
uniformly, then m is in Mp and satisﬁes
∥m∥Mp ≤liminf
j→∞∥mj∥Mp .
Apply this inequality to mk −mj in place of mj and mk −m in place of m, for some
ﬁxed k. We obtain
∥mk −m∥Mp ≤liminf
j→∞∥mk −mj∥Mp
(2.5.17)
for each k. Given ε > 0, by the Cauchy criterion, there is an N such that for j,k > N
we have ∥mk −mj∥Mp < ε. Using (2.5.17) we conclude that ∥mk −m∥Mp ≤ε when
k > N, thus mk converges to m in Mp.
This proves that Mp is a Banach space.
□
The following proposition summarizes some simple properties of multipliers.
Proposition 2.5.14. For all m ∈Mp, 1 ≤p < ∞, x ∈Rn, and h > 0 we have
τx(m)

Mp =
m

Mp ,
(2.5.18)
δ h(m)

Mp =
m

Mp ,
(2.5.19)
#m

Mp =
m

Mp ,
e2πi(·)·xm

Mp =
m

Mp ,
m◦A

Mp =
m

Mp,
A is an orthogonal matrix.
Proof. See Exercise 2.5.2.
□
Example 2.5.15. We show that for −∞<a<b<∞we have ∥χ[a,b]∥Mp = ∥χ[0,1]∥Mp.
Indeed, using (2.5.18) we obtain that ∥χ[a,b]∥Mp = ∥χ[0,b−a]∥Mp , and the latter is
equal to ∥χ[0,1]∥Mp in view of (2.5.19). The fact that we have ∥χ[0,1]∥Mp < ∞for all
1 < p < ∞is shown in Chapter 5.
We continue with the following interesting result.
Theorem 2.5.16. Suppose that m(ξ,η) ∈Mp(Rn+m), where 1 < p < ∞. Then for
almost every ξ ∈Rn the function η →m(ξ,η) is in Mp(Rm), with
m(ξ,·)

Mp(Rm) ≤
m

Mp(Rn+m).
Proof. Since m lies in L∞(Rn+m), it follows by Fubini’s theorem that for almost all
ξ ∈Rn, the function η →m(ξ,η) lies in L∞(Rm) and
m(ξ, ·)

L∞(Rm) ≤
m

L∞(Rn+m) .
(2.5.20)

158
2 Maximal Functions, Fourier Transform, and Distributions
Fix f1, g1 in S (Rn) and f2, g2 in S (Rm). Deﬁne the functions ( f1 ⊗f2)(x,y) =
f1(x) f2(y) when x ∈Rn and y ∈Rm. For all ξ for which (2.5.20) is satisﬁed deﬁne
M(ξ) =

Rm

m(ξ, ·) 1f2
∨(y)g2(y)dy =

Rm m(ξ,η) 1f2(η)g2∨(η)dη
and observe that


Rn

M(·) 1f1
∨(x)g1(x)dx
 =


Rn M(ξ) 1f1(ξ)g1∨(ξ)dξ

=


Rn+m m(ξ,η) 
f1 ⊗f2(ξ,η)(g1 ⊗g2)∨(ξ,η)dξ dη

=


Rn+m(m 
f1 ⊗f2)∨(x,y)(g1 ⊗g2)(x,y)dxdy

≤
m

Mp(Rn+m)
 f1

Lp
f2

Lp
g1

Lp′
g2

Lp′ .
In view of the identity
(M(·) 1f1)∨
Lp =
sup
∥g1∥Lp′ ≤1


Rn

M(·) 1f1
∨(x)g1(x)dx
,
it follows that, for the ξ that satisfy (2.5.20), M(ξ) lies in Mp(Rn) with
M

Mp(Rn) ≤
m

Mp(Rn+m)
f2

Lp
g2

Lp′ .
Since ∥M∥L∞≤∥M∥Mp for almost all ξ ∈Rn, we obtain


Rm(m(ξ,·) 1f2)∨(y)g2(y)dy
 = |M(ξ)| ≤
m

Mp(Rn+m)
f2

Lp
g2

Lp′ , (2.5.21)
which of course implies the required conclusion, by taking the supremum over all
g2 in Lp′ with norm at most 1.
□
Example 2.5.17. (The cone multiplier) On Rn+1 deﬁne the function
mλ(ξ1,...,ξn+1) =
'
1−ξ 2
1 +···+ξ 2
n
ξ 2
n+1
(λ
+
,
λ > 0,
where the plus sign indicates that mλ = 0 if the expression inside the parentheses is
negative. The multiplier mλ is called the cone multiplier with parameter λ. If mλ is
in Mp(Rn+1), then the function bλ(ξ) = (1−|ξ|2)λ
+ deﬁned on Rn is in Mp(Rn).
Indeed, by Theorem 2.5.16 we have that for some ξn+1 = h, bλ(ξ1/h,...,ξn/h) is in
Mp(Rn) and hence so is bλ by property (2.5.19).

2.5 Convolution Operators on Lp Spaces and Multipliers
159
Exercises
2.5.1. Prove that if f ∈Lq(Rn) and 0 < q < ∞, then
τh( f)+ f

Lq →21/qf

Lq
as |h| →∞.
2.5.2. Prove Proposition 2.5.14. Also prove that if δ
h j
j
is a dilation operator in the
jth variable (for instance δ h1
1 f(x) = f(h1x1,x2,...,xn)), then
δ h1
1 ···δ hn
n m

Mp =
m

Mp.
2.5.3. Let m ∈Mp(Rn) where 1 ≤p < ∞.
(a) If ψ is a function on Rn whose inverse Fourier transform is an integrable func-
tion, then prove that
ψm

Mp ≤
ψ∨
L1
m

Mp .
(b) If ψ is in L1(Rn), then prove that
ψ ∗m

Mp ≤
ψ

L1
m

Mp .
2.5.4. Fix a multi-index γ.
(a) Prove that the map T( f) = f ∗∂γδ0 maps S continuously into S .
(b) Prove that when 1/p−1/q ̸= |γ|/n, T does not extend to an element of the space
M p,q.
2.5.5. Let Kγ(x) = |x|−n+γ, where 0 < γ < n. Use Theorem 1.4.25 to show that the
operator
Tγ( f) = f ∗Kγ,
f ∈S ,
extends to a bounded operator in M p,q(Rn), where 1/p−1/q = γ/n, 1 < p < q < ∞.
This provides an example of a nontrivial operator in M p,q(Rn) when p < q.
2.5.6. (a) Use the ideas of the proof of Proposition 2.5.13 to show that if mj ∈Mp,
1 ≤p < ∞, ∥mj∥Mp ≤C for all j = 1,2,..., and mj →m a.e., then m ∈Mp and
m

Mp(Rn) ≤liminf
j→∞
mj

Mp(Rn) ≤C.
(b) Prove that if m ∈Mp, 1 ≤p < ∞, and the limit m0(ξ) = lim
R→∞m(ξ/R) exists for
all ξ ∈Rn, then m0 is a radial function in Mp(Rn) and satisﬁes ∥m0∥Mp ≤∥m∥Mp.
(c) If m ∈Mp(R) has left and right limits at the origin, then prove that
m

Mp(R) ≥max(|m(0+)|,|m(0−)|).

160
2 Maximal Functions, Fourier Transform, and Distributions
(d) Suppose that for some 1 ≤p < ∞, mt ∈Mp(Rn) for all 0 < t < ∞. Prove that
 ∞
0
mt

Mp(Rn)
dt
t < ∞=⇒
m(ξ) =
 ∞
0 mt(ξ)dt
t ∈Mp .
2.5.7. Let 1 ≤p < ∞and suppose that m ∈Mp(Rn) satisﬁes |m(ξ)| ≥c(1+|ξ|)−N
for some c,N > 0. Prove that the operator T( f) = ( 1f m−1)∨satisﬁes ∥T( f)∥Lp ≥
cp∥f∥Lp for all f ∈S (Rn), where cp = ∥m∥−1
Mp.
2.5.8. (a) Prove that if m ∈L∞(Rn) satisﬁes m∨≥0, then for all 1 ≤p < ∞we have
m

Mp =
m∨
L1 .
(b) (L. Colzani and E. Laeng) On the real line let
m1(ξ) =

−1
for ξ > 0
1
for ξ < 0,
m2(ξ) =

min(ξ −1,0)
for ξ > 0
max(ξ +1,0)
for ξ < 0.
Prove that
m1

Mp =
m2

Mp
for all 1 < p < ∞.

Hint: Part (a): Use Exercise 1.2.9. Part (b): Use part (a) to show that ∥m2m−1
1 ∥Mp =
1. Deduce that ∥m2∥Mp ≤∥m1∥Mp. For the converse use Exercise 2.5.6 (c).

2.5.9. ([94]) Let 1 < p < ∞and 0 < A < ∞. Prove that the following are equivalent:
(a) The operator f →∑m∈Zn am f(x−m) is bounded on Lp(Rn) with norm A.
(b) The Mp norm of the function ∑m∈Zn ame−2πim·x is exactly A.
(c) The operator given by convolution with the sequence {am} is bounded on ℓp(Zn)
with norm A.
2.5.10. ([177]) Let m(ξ) in Mp(Rn) be supported in [0,1]n. Then the periodic ex-
tension of m in Rn,
M(ξ) = ∑
k∈Zn
m(ξ −k),
is also in Mp(Rn).
2.5.11. Suppose that u is a C ∞function on Rn \{0} that is homogeneous of degree
−n+iτ, τ ∈R. Prove that the operator given by convolution with u maps L2(Rn) to
L2(Rn).
2.5.12. ([142]) Let m1 ∈Lr(Rn) and m2 ∈Lr′(Rn) for some 2 ≤r ≤∞. Prove that
m1 ∗m2 ∈Mp(Rn) when 1
p −1
2 = 1
r and 1 ≤p ≤2.

Hint: Prove that the trilinear operator (m1,m2, f)→

(m1∗m2) 1f
∨is bounded from
L2 × L2 × L1 →L1 and L∞× L1 × L2 →L2. Apply trilinear complex interpolation
(Corollary 7.2.11 in [131]) to deduce the required conclusion for 1 ≤p ≤2.


2.6 Oscillatory Integrals
161
2.5.13. Show that the function ei|ξ|2 is an Lp Fourier multiplier on Rn if and only if
p = 2.

Hint: By Exercise 2.4.12 the inverse Fourier transform of ei|ξ|2 is in L∞, thus the
operator f →
 1f(ξ)eiπ|ξ|2∨maps L1 to L∞. Since this operator also maps L2 to L2,
it should map Lp to Lp′ for all 1 ≤p ≤2.

2.6 Oscillatory Integrals
Oscillatory integrals have played an important role in harmonic analysis from its
outset. The Fourier transform is the prototype of oscillatory integrals and provides
the simplest example of a nontrivial phase, a linear function of the variable of in-
tegration. More complicated phases naturally appear in the subject; for instance,
Bessel functions provide examples of oscillatory integrals in which the phase is a
sinusoidal function.
In this section we take a quick look at oscillatory integrals. We mostly concentrate
on one-dimensional results, which already require some signiﬁcant analysis. We
examine only a very simple higher-dimensional situation. Our analysis here is far
from adequate.
Deﬁnition 2.6.1. An oscillatory integral is an expression of the form
I(λ) =

Rn eiλϕ(x)ψ(x)dx,
(2.6.1)
where λ is a positive real number, ϕ is a real-valued function on Rn called the
phase, and ψ is a complex-valued and smooth integrable function on Rn, which is
often taken to have compact support.
2.6.1 Phases with No Critical Points
We begin by studying the simplest possible one-dimensional case. Suppose that ϕ
and ψ are smooth functions on the real line such that suppψ is a closed interval and
ϕ′(x) ̸= 0
for all x ∈suppψ.
Since ϕ′ has no zeros, it must be either strictly positive or strictly negative every-
where on the support of ψ. It follows that ϕ is monotonic on the support of ψ and
we are allowed to change variables
u = ϕ(x)

162
2 Maximal Functions, Fourier Transform, and Distributions
in (2.6.1). Then dx = (ϕ′(x))−1du = (ϕ−1)′(u)du, where ϕ−1 is the inverse function
of ϕ. We transform the integral in (2.6.1) into

R eiλuψ(ϕ−1(u))(ϕ−1)′(u)du
(2.6.2)
and we note that the function θ(u) = ψ(ϕ−1(u))(ϕ−1)′(u) is smooth and has com-
pact support on R. We therefore interpret the integral in (2.6.1) as 1θ(−λ/2π), where
1θ is the Fourier transform of θ. Since θ is a smooth function with compact support,
it follows that the integral in (2.6.2) has rapid decay as λ →∞.
A quick way to see that the expression 1θ(−λ/2π) has decay of order λ −N for all
N > 0 as λ tends to ∞is the following. Write
eiλu =
1
(iλ)N
dN
duN (eiλu)
and integrate by parts N times to express the integral in (2.6.2) as
(−1)N
(iλ)N

R eiλu dNθ(u)
duN
du,
from which the assertion follows. Hence
|I(λ)| = |1θ(−λ/2π)| ≤CNλ −N ,
(2.6.3)
where CN = ∥θ (N)∥L1, which depends on derivatives of ϕ and ψ.
We now turn to a higher-dimensional analogue of this situation.
Deﬁnition 2.6.2. We say that a point x0 is a critical point of a phase function ϕ if
∇ϕ(x0) =

∂1ϕ(x0),...,∂nϕ(x0)

= 0.
Example 2.6.3. Let ξ ∈Rn \ {0}. Then the phase functions ϕ1(x) = x · ξ, ϕ2(x) =
ex·ξ have no critical points, while the phase function ϕ3(x) = |x|2 −x · ξ has one
critical point at x0 = 1
2ξ.
The next result concerns the behavior of oscillatory integrals whose phase func-
tions have no critical points.
Proposition 2.6.4. Suppose that ψ is a compactly supported smooth function on Rn
and that ϕ is a real-valued C ∞function on Rn that has no critical points on the
support of ψ. Then the oscillatory integral
I(λ) =

Rn eiλϕ(x)ψ(x)dx
(2.6.4)
obeys a bound of the form |I(λ)| ≤CNλ −N for all λ ≥1 and all N > 0, where CN
depends on N and on ϕ and ψ.

2.6 Oscillatory Integrals
163
Proof. Since the case n = 1 has already been discussed, we concentrate on dimen-
sions n ≥2. For each y in the support of ψ there is a unit vector θy such that
θy ·∇ϕ(y) = |∇ϕ(y)|.
By the continuity of ∇ϕ there is a small neighborhood B(y,ry) of y such that for all
x ∈B(y,ry) we have
θy ·∇ϕ(x) ≥1
2|∇ϕ(y)| > 0.
Cover the support of ψ by a ﬁnite number of balls B(yj,ry j), j = 1,...,m, and pick
c = minj 1
2|∇ϕ(yj)|; we have
θy j ·∇ϕ(x) ≥c > 0
(2.6.5)
for all x ∈B(yj,ry j) and j = 1,...,m.
Next we ﬁnd a smooth partition of unity of Rn such that each member ζk of the
partition is supported in some ball B(yj,ry j) or lies outside the support of ψ. We
therefore write
I(λ) = ∑
k

Rn eiλϕ(x)ψ(x)ζk(x)dx,
(2.6.6)
where the sum contains only a ﬁnite number of indices, since only a ﬁnite number
of the ζk’s meet the support of ψ. It sufﬁces to show that every term in the sum in
(2.6.6) has rapid decay in λ as λ →∞.
To this end, we ﬁx a k and we pick a j such that the support of ψζk is contained
in some ball B(yj,ry j). We ﬁnd unit vectors θy j,2,...,θy j,n, such that the system
{θy j,θy j,2,...,θy j,n} is an orthonormal basis of Rn. Let ej be the unit (column)
vector on Rn whose jth coordinate is one and whose remaining coordinates are zero.
We ﬁnd an orthogonal matrix R such that Rte1 = θy j and we introduce the change
of variables u = yj +R(x−yj) in the integral
Ik(λ) =

Rn eiλϕ(x)ψ(x)ζk(x)dx.
The map x →u = (u1,...,un) is a rotation that ﬁxes yj and preserves the ball
B(yj,ry j). Deﬁning ϕ(x) = ϕo(u), ψ(x) = ψo(u), ζk(x) = ζ o
k (u), under this new
coordinate system we write
Ik(λ) =

K
$
R eiλϕo(u)ψo(u1,...,un)ζ o
k (u1,...,un)du1
%
du2 ···dun ,
(2.6.7)
where K is a compact subset of Rn−1. Since R is an orthogonal matrix, R−1 = Rt,
and the change of variables x = yj +Rt(u−yj) implies that
∂x
∂u1
= ﬁrst column of Rt = ﬁrst row of R = Rte1 = θy j .

164
2 Maximal Functions, Fourier Transform, and Distributions
Thus for all x ∈B(yj,r j) we have
∂ϕo(u)
∂u1
= ∂ϕ(yj +Rt(u−yj))
∂u1
= ∇ϕ(x)· ∂x
∂u1
= ∇ϕ(x)·θy j ≥c > 0
in view of condition (2.6.5). This lower estimate is valid for all u ∈B(yj,ry j), and
therefore the inner integral inside the curly brackets in (2.6.7) is at most CNλ −N by
estimate (2.6.3). Integrating over K results in the same conclusion for I(λ) deﬁned
in (2.6.4).
□
2.6.2 Sublevel Set Estimates and the Van der Corput Lemma
We discuss a sharp decay estimate for one-dimensional oscillatory integrals. This
estimate is obtained as a consequence of delicate size estimates for the Lebesgue
measures of the sublevel sets {|u| ≤α} for a function u. In what follows, u(k) denotes
the kth derivative of a function u(t) deﬁned on R, and C k the space of all functions
whose kth derivative exists and is continuous.
Lemma 2.6.5. Let k ≥1 and suppose that a0,...,ak are distinct real numbers. Let
a = min(aj) and b = max(aj) and let f be a real-valued C k−1 function on [a,b] that
is C k on (a,b). Then there exists a point y in (a,b) such that
k
∑
m=0
cm f(am) = f (k)(y),
where cm = (−1)k k!
k
∏
ℓ=0
ℓ̸=m
(aℓ−am)−1.
Proof. Suppose we could ﬁnd a polynomial pk(x) = ∑k
j=0 bjx j such that the function
ϕ(x) = f(x)−pk(x)
(2.6.8)
satisﬁes ϕ(am) = 0 for all 0 ≤m ≤k. Since the aj are distinct, we apply Rolle’s
theorem k times to ﬁnd a point y in (a,b) such that
f (k)(y) = k!bk .
The existence of a polynomial pk such that (2.6.8) is satisﬁed is equivalent to the
existence of a solution to the matrix equation

2.6 Oscillatory Integrals
165
⎛
⎜
⎜
⎜
⎜
⎜
⎝
ak
0
ak−1
0
...
a0
1
ak
1
ak−1
1
...
a1
1
...
...
...
...
...
ak
k−1 ak−1
k−1 ... ak−1 1
ak
k
ak−1
k
...
ak
1
⎞
⎟
⎟
⎟
⎟
⎟
⎠
⎛
⎜
⎜
⎜
⎜
⎜
⎝
bk
bk−1
...
b1
b0
⎞
⎟
⎟
⎟
⎟
⎟
⎠
=
⎛
⎜
⎜
⎜
⎜
⎜
⎝
f(a0)
f(a1)
...
f(ak−1)
f(ak)
⎞
⎟
⎟
⎟
⎟
⎟
⎠
.
The determinant of the square matrix on the left is called the Vandermonde deter-
minant and is equal to
k−1
∏
ℓ=0
k
∏
j=ℓ+1
(aℓ−aj) ̸= 0.
Since the aj are distinct, it follows that the system has a unique solution. Using
Cramer’s rule, we solve this system to obtain
bk =
k
∑
m=0
(−1)m f(am)
k−1
∏
ℓ=0
ℓ̸=m
k
∏
j=ℓ+1
j̸=m
(aℓ−aj)
k−1
∏
ℓ=0
k
∏
j=ℓ+1
(aℓ−aj)
=
k
∑
m=0
(−1)m f(am)
k
∏
ℓ=0
ℓ̸=m
(aℓ−am)−1(−1)k−m .
The required conclusion now follows with cm as claimed.
□
Lemma 2.6.6. Let E be a measurable subset of R with ﬁnite nonzero Lebesgue mea-
sure and let k ∈Z+. Then there exist a0,...,ak in E such that for all ℓ= 0,1,...,k
we have
k
∏
j=0
j̸=ℓ
|aj −aℓ| ≥(|E|/2e)k .
(2.6.9)
Proof. Given a measurable set E with ﬁnite measure, pick a compact subset E′ of
E such that |E \ E′| < δ, for some δ > 0. For x ∈R deﬁne T(x) = |(−∞,x) ∩E′|.
Then T enjoys the distance-decreasing property
|T(x)−T(y)| ≤|x−y|
for all x,y ∈E′; consequently, by the intermediate value theorem, T is a surjective
map from E′ to [0,|E′|]. Let aj be points in E′ such that T(aj) = j
k|E′| for j =
0,1,...,k. For k an even integer, we have
k
∏
j=0
j̸=ℓ
|aj −aℓ| ≥
k
∏
j=0
j̸=ℓ
 j
k|E′|−ℓ
k|E′|
 ≥
k
∏
j=0
j̸= k
2
 j
k −1
2
|E′|k =
k
2 −1
∏
r=0
r −k
2
k
2
|E′|k ,
and it is easily shown that

(k/2)!
2k−k ≥(2e)−k.

166
2 Maximal Functions, Fourier Transform, and Distributions
For k an odd integer we have
k
∏
j=0
j̸=ℓ
|aj −aℓ| ≥
k
∏
j=0
j̸=ℓ
 j
k|E′|−ℓ
k|E′|
 ≥
k
∏
j=0
j̸= k+1
2
 j
k −k +1
2k
|E′|k ,
while the last product is at least
1
k · 2
k ···
k−1
2
k
2 k +1
2k
≥(2e)−k .
We have therefore proved (2.6.9) with E′ replacing E. Since |E \E′| < δ and δ > 0
is arbitrarily small, the required conclusion follows.
□
The following is the main result of this section.
Proposition 2.6.7. (a) Let u be a real-valued C k function, k ∈Z+, that satisﬁes
u(k)(t) ≥1 for all t ∈R. Then the following estimate is valid for all α > 0:
	
t ∈R : |u(t)| ≤α

 ≤(2e)((k +1)!)
1
k α
1
k .
(2.6.10)
(b) Let −∞< a < b < ∞. For all k ≥2, for every real-valued C k function u on the
line that satisﬁes u(k)(t) ≥1 for all t ∈[a,b], and every λ ∈R\{0} we have:

 b
a eiλu(t)dt
 ≤12k|λ|−1
k .
(2.6.11)
(c) If k = 1, u′(t) is monotonic on (a,b), and u′(t) ≥1 for all t ∈(a,b), then for all
nonzero real numbers λ we have

 b
a eiλu(t)dt
 ≤3|λ|−1 .
(2.6.12)
Proof. Part (a): Let E = {t ∈R : |u(t)| ≤α}. If |E| is nonzero, then by Lemma
2.6.6 there exist a0,a1,...,ak in E such that for all ℓwe have
|E|k ≤(2e)k
k
∏
j=0
j̸=ℓ
|aj −aℓ|.
(2.6.13)
Lemma 2.6.5 implies that there exists y ∈

minaj,maxaj

such that
u(k)(y) = (−1)k k!
k
∑
m=0
u(am)
k
∏
ℓ=0
ℓ̸=m
(aℓ−am)−1 .
(2.6.14)

2.6 Oscillatory Integrals
167
Using (2.6.13), we obtain that the expression on the right in (2.6.14) is in absolute
value at most
(k +1)! max
0≤j≤k|u(aj)|(2e)k |E|−k ≤(k +1)!α (2e)k |E|−k ,
since aj ∈E. The bound u(k)(t) ≥1 now implies
|E|k ≤(k +1)!(2e)k α
as claimed. This proves (2.6.10).
Part (b): We now take k ≥2 and we split the interval (a,b) in (2.6.11) into the
sets
R1 = {t ∈(a,b) : |u′(t)| ≤β},
R2 = {t ∈(a,b) : |u′(t)| > β},
for some parameter β to be chosen momentarily. The function v = u′ satisﬁes
v(k−1) ≥1 and k −1 ≥1. It follows from part (a) that


R1
eiλu(t) dt
 ≤|R1| ≤2e(k!)
1
k−1 β
1
k−1 ≤6kβ
1
k−1 .
To obtain the corresponding estimate over R2, we note that if u(k) ≥1, then the set
{|u′| > β} is the union of at most 2k −2 intervals on each of which u′ is monotone.
Let (c,d) be one of these intervals on which u′ is monotone. Then u′ has a ﬁxed sign
on (c,d) and we have

 d
c eiλu(t) dt
 =

 d
c

eiλu(t)′
1
λu′(t) dt

≤

 d
c eiλu(t)
1
λu′(t)
′
dt
+ 1
|λ|
eiλu(d)
u′(d) −eiλu(c)
u′(c)

≤1
|λ|
 d
c

 1
u′(t)
′dt +
2
|λ|β
= 1
|λ|

 d
c
 1
u′(t)
′
dt
+
2
|λ|β
= 1
|λ|

1
u′(d) −
1
u′(c)
+
2
|λ|β
≤
3
|λ|β ,
where we use the monotonicity of 1/u′(t) in moving the absolute value from inside
the integral to outside. It follows that


R2
eiλu(t) dt
 ≤6k
|λ|β .

168
2 Maximal Functions, Fourier Transform, and Distributions
Choosing β = |λ|−(k−1)/k to optimize and adding the corresponding estimates for
R1 and R2, we deduce the claimed estimate (2.6.11).
Part (c): Repeat the argument in part (b) setting β = 1 and replacing the interval
(c,d) by (a,b).
□
Corollary 2.6.8. Let (a,b), u(t), λ > 0, and k be as in Proposition 2.6.7. Then for
any function ψ on (a,b) with an integrable derivative and k ≥2, we have

 b
a eiλu(t)ψ(t)dt
 ≤12kλ −1/k

|ψ(b)|+
 b
a |ψ′(s)|ds

.
We also have

 b
a eiλu(t)ψ(t)dt
 ≤3λ −1

|ψ(b)|+
 b
a |ψ′(s)|ds

,
when k = 1 and u′ is monotonic on (a,b).
Proof. Set
F(x) =
 x
a eiλu(t) dt
and use integration by parts to write
 b
a eiλu(t)ψ(t)dt = F(b)ψ(b)−
 b
a F(t)ψ′(t)dt .
The conclusion easily follows.
□
Example 2.6.9. The Bessel function of order m is deﬁned as
Jm(r) = 1
2π
 2π
0
eirsinθe−imθ dθ .
Here we take both r and m to be real numbers, and we suppose that m > −1
2; we refer
to Appendix B for an introduction to Bessel functions and their basic properties.
We use Corollary 2.6.8 to calculate the decay of the Bessel function Jm(r) as
r →∞. Set
ϕ(θ) = sin(θ)
and note that ϕ′(θ) vanishes only at θ = π/2 and 3π/2 inside the interval [0,2π] and
that ϕ′′(π/2) = −1, while ϕ′′(3π/2) = 1. We now write 1 = ψ1 +ψ2 +ψ3, where
ψ1 is smooth and compactly supported in a small neighborhood of π/2, and ψ2 is
smooth and compactly supported in a small neighborhood of 3π/2. For j = 1,2,
Corollary 2.6.8 yields

 2π
0
eirsin(θ)
ψj(θ)e−imθ
dθ
 ≤Cmr−1/2

2.6 Oscillatory Integrals
169
for some constant C, while the corresponding integral containing ψ3 has arbitrary
decay in r in view of estimate (2.6.3) (or Proposition 2.6.4 when n = 1).
Exercises
2.6.1. Suppose that u is a real-valued C k function deﬁned on the line that satisﬁes
|u(k)(t)| ≥c0 > 0 for some k ≥2 and all t ∈(a,b). Prove that for λ ∈R \ {0} we
have

 b
a eiλu(t) dt
 ≤12k(λc0)−1/k
and that the same conclusion is valid when k = 1, provided u′ is monotonic.
2.6.2. Show that if u′ is not monotonic in part (c) of Proposition 2.6.7, then the
conclusion may fail.

Hint: Let ϕ(t) be a real-valued smooth function that is equal to 2t on intervals
[2πk+εk,2π(k+ 1
2)−εk] and equal to t on intervals [2π(k+ 1
2)+εk,2π(k+1)−εk],
where 0 ≤k ≤N, for some N ∈Z+. Show that the absolute value of the integral of
eiϕ(t) over the interval [ε0,2π(N +1)−εN] tends to inﬁnity as N →∞.

2.6.3. Prove that the dependence on k of the constant in part (b) of Proposition 2.6.7
is indeed linear.

Hint: Take u(t) = tk/k! over the interval (0,k!).

2.6.4. Follow the steps below to give an alternative proof of part (b) of Proposition
2.6.7. Assume that the statement is known for some k ≥2 and some constant C(k)
for all intervals [a,b] and all C k functions satisfying u(k) ≥1 on [a,b]. Fix a C k+1
function u such that u(k+1) ≥1 on an interval [a,b]. Let c be the unique point at
which the function u(k) attains its minimum in [a,b].
(a) If u(k)(c) = 0, then for all δ > 0 we have u(k)(t) ≥δ in the complement of the
interval (c−δ,c+δ) and derive the bound

 b
a eiλu(t)dt
 ≤2C(k)(λδ)−1/k +2δ .
(b) If u(k)(c) ̸= 0, then we must have c ∈{a,b}. Obtain the bound

 b
a eiλu(t)dt
 ≤C(k)(λδ)−1/k +δ .
(c) Choose a suitable δ to optimize and deduce the validity of the statement for k+1
with C(k +1) = 2C(k)+2, hence C(k) = 3·2k−1 +2k −2, since C(1) = 3.
2.6.5. (a) Prove that for some constant C and all λ ∈R and ε ∈(0,1) we have


ε≤|t|≤1 eiλt dt
t
 ≤C.

170
2 Maximal Functions, Fourier Transform, and Distributions
(b) Prove that for some C′ < ∞, all λ ∈R, k > 0, and ε ∈(0,1) we have


ε≤|t|≤1 eiλt±tk dt
t
 ≤C′ .
(c) Show that there is a constant C′′ such that for any 0 < ε < N < ∞, for all ξ1,ξ2
in R, and for all integers k ≥2, we have


ε≤|s|≤N ei(ξ1s+ξ2sk) ds
s
 ≤C′′ .

Hint: Part (a): For |λ| small use the inequality |eiλt −1| ≤|λt|. If |λ| is large,
split the domains of integration into the regions |t| ≤|λ|−1 and |t| ≥|λ|−1 and use
integration by parts in the second case. Part (b): Write
ei(λt±tk) −1
t
= eiλt e±itk −1
t
+ eiλt
t
and use part (a). Part (c): When ξ1 = ξ2 = 0 it is trivial. If ξ2 = 0, ξ1 ̸= 0, change
variables t = ξ1s and then split the domain of integration into the sets |t| ≤1 and
|t| ≥1. In the interval over the set |t| ≤1 apply part (b) and over the set |t| ≥1 use
integration by parts. In the case ξ2 ̸= 0, change variables t = |ξ2|1/ks and split the
domain of integration into the sets |t| ≥1 and |t| ≤1. When |t| ≤1 use part (b) and
in the case |t| ≥1 use Corollary 2.6.8, noting that dk(ξ1|ξ2|−1/kt±tk)
dt
= k! ≥1.

2.6.6. (a) Show that for all a > 0 and λ > 0 the following is valid:

 aλ
0
eiλ logt dt
 ≤a.
(b) Prove that there is a constant c > 0 such that for all b > λ > 10 we have

 b
0 eiλt logt dt
 ≤
c
λ logλ .

Hint: Part (b): Consider the intervals (0,δ) and [δ,b) for some δ. Apply Proposi-
tion 2.6.7 with k = 1 on one of these intervals and with k = 2 on the other. Then
choose a suitable δ.

2.6.7. Show that there is a constant C < ∞such that for all nonintegers γ > 1 and
all λ,b > 1 we have

 b
0 eiλtγdt
 ≤C
λ γ .

Hint: On the interval (0,δ) apply Proposition 2.6.7 with k = [γ] + 1 and on the
interval (δ,b) with k = [γ]. Then optimize by choosing δ = λ −1/γ.


2.6 Oscillatory Integrals
171
HISTORICAL NOTES
The one-dimensional maximal function originated in the work of Hardy and Littlewood [146].
Its n-dimensional analogue was introduced by Wiener [375], who used Lemma 2.1.5, a variant of
the Vitali covering lemma, to derive its Lp boundedness. One may consult the books of de Guzm´an
[92], [93] for extensions and other variants of such covering lemmas. The actual covering lemma
proved by Vitali [368] says that if a family of closed cubes in Rn has the property that for every point
x ∈A ⊆Rn there exists a sequence of cubes in the family that tends to x, then it is always possible
to extract a sequence of pairwise disjoint cubes Ej from the family such that |A \ 
j Ej| = 0. We
refer to Saks [310] for details and extensions of this theorem.
The class LlogL was introduced by Zygmund to give a sufﬁcient condition on the local integra-
bility of the Hardy–Littlewood maximal operator. The necessity of this condition was observed by
Stein [336]. Stein [341] also showed that the Lp(Rn) norm of the centered Hardy–Littlewood max-
imal operator M is bounded above by some dimension-free constant; see also Stein and Str¨omberg
[345]. Analogous results for maximal operators associated with convex bodies are contained in
Bourgain [35], Carbery [51], and M¨uller [263]. Bourgain [37] showed the the Hardy-Littlewood
maximal operator associated with cubes is bounded on Lp(Rn) with dimension-free bounds when
p > 1. Aldaz [2] studied the corresponding weak type (1,1) bounds and proved that they grow
to inﬁnity with the dimension; the constant was improved by Aubrun [15]. The situation for the
uncentered maximal operator M on Lp is different, since given any 1 < p < ∞there exists Cp > 1
such that ∥M∥Lp(Rn)→Lp(Rn) ≥Cn
p (see Exercise 2.1.8 for a value of such a constant Cp and also the
article of Grafakos and Montgomery-Smith [136] for a larger value).
The centered maximal function Mμ with respect to a general inner regular locally ﬁnite posi-
tive measure μ on Rn is bounded on Lp(Rn,μ) without the additional hypothesis that the measure
is doubling; see Fefferman [117]. The proof of this result requires the following covering lemma,
obtained by Besicovitch [27]: Given any family of closed balls whose centers form a bounded sub-
set of Rn, there exists an at most countable subfamily of balls that covers the set of centers and has
bounded overlap, i.e., no point in Rn belongs to more than a ﬁnite number (depending on the dimen-
sion) of the balls in the subfamily. A similar version of this lemma was obtained independently by
Morse [258]. See also Ziemer [385] for an alternative formulation. The uncentered maximal opera-
tor Mμ of Exercise 2.1.1 may not be weak type (1,1) if the measure μ is nondoubling, as shown by
Sj¨ogren [323]; related positive weak type (1,1) results are contained in the article of Vargas [365].
The precise value of the operator norm of the uncentered Hardy–Littlewood maximal function on
Lp(R) was shown by Grafakos and Montgomery-Smith [136] to be the unique positive solution of
the equation (p −1)xp −pxp−1 −1 = 0. This constant raised to the power n is the operator norm
of the strong maximal function Ms on Lp(Rn) for 1 < p ≤∞. The best weak type (1,1) constant
for the centered Hardy–Littlewood maximal operator was shown by Melas [248] to be the largest
root of the quadratic equation 12x2 −22x + 5 = 0. The strong maximal operator Ms is not weak
type (1,1), but it satisﬁes the substitute inequality dMs( f)(α) ≤C

Rn |f(x)|
α
(1 + log+ |f(x)|
α
)n−1 dx.
This result is due to Jessen, Marcinkiewicz, and Zygmund [176], but a geometric proof of it was
obtained by C´ordoba and Fefferman [73].
The basic facts about the Fourier transform go back to Fourier [119]. The theory of distributions
was developed by Schwartz [314], [315]. For a concise introduction to the theory of distributions
we refer to H¨ormander [160] and Yosida [382]. Homogeneous distributions were considered by
Riesz [295] in the study of the Cauchy problem in partial differential equations, although some
earlier accounts are found in the work of Hadamard. They were later systematically studied by
Gelfand and ˇSilov [126], [127]. References on the uncertainty principle include the articles of
Fefferman [114] and Folland and Sitaram [118]. The best possible constant Bp in the Hausdorff–
Young inequality ∥1f ∥Lp′ (Rn) ≤Bp∥f∥Lp(Rn) when 1 ≤p ≤2 was shown by Beckner [21] to be
Bp = (p1/p(p′)−1/p′)n/2. This best constant was previously obtained by Babenko [16] in the case
when p′ is an even integer.
A nice treatise of the spaces M p,q is found in H¨ormander [159]. This reference also con-
tains Theorem 2.5.6, which is due to him. Theorem 2.5.16 is due to de Leeuw [94], but the proof
presented here is taken from Jodeit [178]. De Leeuw’s result in Exercise 2.5.9 says that periodic

172
2 Maximal Functions, Fourier Transform, and Distributions
elements of Mp(Rn) can be isometrically identiﬁed with elements of M (Tn), the latter being the
space of all multipliers on ℓp(Zn). The hint in Exercise 2.5.13 was suggested by M. Peloso.
Parts (b) and (c) of Proposition 2.6.7 are due to van der Corput [364] and are referred to in
the literature as van der Corput’s lemma. The reﬁnement in part (a) was subsequently obtained by
Arhipov, Karachuba, and ˇCubarikov [8]. The treatment of these results in the text is based on the
article of Carbery, Christ, and Wright [53], which also investigates higher-dimensional analogues
of the theory. Precise asymptotics can be obtained for a variety of oscillatory integrals via the
method of stationary phase; see H¨ormander [160]. References on oscillatory integrals include the
books of Titchmarsh [362], Erd´elyi [107], Zygmund [388], [389], Stein [344], and Sogge [328].
The latter provides a treatment of Fourier integral operators.

Chapter 3
Fourier Series
Principles of Fourier series go back to ancient times. The attempts of the Pythagorean
school to explain musical harmony in terms of whole numbers embrace early ele-
ments of a trigonometric nature. The theory of epicycles in the Almagest of Ptolemy,
based on work related to the circles of Appolonius, contains ideas of astronomical
periodicities that we would interpret today as harmonic analysis. Early studies of
acoustical and optical phenomena, as well as periodic astronomical and geophysical
occurrences, provided a stimulus in the physical sciences toward the rigorous study
of expansions of periodic functions. This study is carefully pursued in this chapter.
The modern theory of Fourier series begins with attempts to solve boundary
value problems using trigonometric functions. The work of d’Alembert, Bernoulli,
Euler, and Clairaut on the vibrating string led to the belief that it might be possible
to represent arbitrary periodic functions as sums of sines and cosines. Fourier an-
nounced belief in this possibility in his solution of the problem of heat distribution
in spatial bodies (in particular, for the cube T3) by expanding an arbitrary function
of three variables as a triple sine series. Fourier’s approach, although heuristic, was
appealing and eventually attracted attention. It was carefully studied and further de-
veloped by many scientists, but most notably by Laplace and Dirichlet, who were
the ﬁrst to investigate the validity of the representation of a function in terms of its
Fourier series. This is the main topic of study in this chapter.
3.1 Fourier Coefﬁcients
We discuss some basic facts of Fourier analysis on the torus Tn. Throughout this
chapter, n denotes the dimension, i.e., a ﬁxed positive integer.
L. Grafakos, Classical Fourier Analysis, Graduate Texts in Mathematics 249,
DOI 10.1007/978-1-4939-1194-3 3, © Springer Science+Business Media New York 2014
173

174
3 Fourier Series
3.1.1 The n-Torus Tn
The n-torus Tn is the cube [0,1]n with opposite sides identiﬁed. This means that
the points (x1,...,0,...,xn) and (x1,...,1,...,xn) are identiﬁed whenever 0 and 1
appear in the same coordinate. A more precise deﬁnition can be given as follows:
We say that x,y in Rn are equivalent and we write
x ≡y
(3.1.1)
if x −y ∈Zn. Here Zn is the additive subgroup of all points in Rn with integer
coordinates. It is a simple fact that ≡is an equivalence relation that partitions Rn
into equivalence classes. The n-torus Tn is then deﬁned as the set Rn/Zn of all such
equivalence classes. When n = 1, this set can be geometrically viewed as a circle
by bending the line segment [0,1] so that its endpoints are brought together. When
n = 2, the identiﬁcation brings together the left and right sides of the unit square
[0,1]2 as well as the top and bottom sides. The resulting ﬁgure is a two-dimensional
manifold embedded in R3 that looks like a donut. See Figure 3.1.
Fig. 3.1 The graph of the
two-dimensional torus T2.
x1
x3
x2
The n-torus is an additive group. The identity element of the group is 0, which
of course coincides with every ej = (0,...,0,1,0,...,0). To avoid multiple appear-
ances of the identity element in the group, we often think of the n-torus as the
set [−1/2,1/2]n. Since the group Tn is additive, the inverse of an element x ∈Tn
is denoted by −x. For example, −(1/3,1/4) ≡(2/3,3/4) on T2, or, equivalently,
−(1/3,1/4)−(2/3,3/4) ∈Z2.
The n-torus Tn can also be thought of as the following subset of Cn,
{(e2πix1,...,e2πixn) ∈Cn : (x1,...,xn) ∈[0,1]n},
(3.1.2)
in a way analogous to which the unit interval [0,1] can be thought of as the unit
circle in C once 1 and 0 are identiﬁed.
Functions on Tn are functions f on Rn that satisfy f(x+m) = f(x) for all x ∈Rn
and m ∈Zn. Such functions are called 1-periodic in every coordinate. Haar mea-
sure on the n-torus is the restriction of n-dimensional Lebesgue measure to the set

3.1 Fourier Coefﬁcients
175
Tn = [0,1]n. This measure is still denoted by dx, while the measure of a set A ⊆Tn
is denoted by |A|. Translation invariance of Lebesgue measure and the periodicity
of functions on Tn imply that for all integrable functions f on Tn, we have

Tn f(x)dx =

[−1/2,1/2]n f(x)dx =

[a1,1+a1]×···×[an,1+an] f(x)dx
(3.1.3)
for any real numbers a1,...,an. In view of periodicity, integration by parts on the
torus does not produce boundary terms; given f,g continuously differentiable func-
tions on Tn we have

Tn ∂j f(x)g(x)dx = −

Tn ∂jg(x) f(x)dx.
Elements of Zn are denoted by m = (m1,...,mn). For m ∈Zn, we deﬁne the total
size of m to be the number |m| = (m2
1 +···+m2
n)1/2. Recall that for x = (x1,...,xn)
and y = (y1,...,yn) in Rn,
x·y = x1y1 +···+xnyn
denotes the usual dot product. Finally, for x ∈Tn, |x| denotes the usual Euclidean
norm of x. If we identify Tn with [−1/2,1/2]n, then |x| can be interpreted as the
distance of the element x from the origin, and then we have 0 ≤|x| ≤√n/2 for all
x ∈Tn.
Multi-indices are elements of (Z+ ∪{0})n. For a multi-index α = (α1,...,αn),
we denote the partial derivative ∂α1
1 ···∂αn
n f by ∂α f. The spaces C k(Tn) of con-
tinuously differentiable functions of order k, where k ∈Z+, are deﬁned as the sets
of functions ϕ for which ∂αϕ exist and are continuous for all |α| ≤k. When k = 0
we set C 0(Tn) = C (Tn) to be the space of continuous functions on Tn. The space
C ∞(Tn) of inﬁnitely differentiable functions on Tn is the union of all the C k(Tn).
All of these spaces are contained in Lp(Tn), which are nested, with L1(Tn) being
the largest.
3.1.2 Fourier Coefﬁcients
Deﬁnition 3.1.1. For a complex-valued function f in L1(Tn) and m in Zn, we deﬁne
1f(m) =

Tn f(x)e−2πim·xdx.
(3.1.4)
We call 1f(m) the mth Fourier coefﬁcient of f. We note that 1f(ξ) is not deﬁned for
ξ ∈Rn \Zn, since the function x →e−2πiξ·x is not 1-periodic in any coordinate and
therefore not well deﬁned on Tn. For a ﬁnite Borel measure μ on Tn and m ∈Zn the
expression
1μ(m) =

Tn e−2πim·xdμ
(3.1.5)
is called the mth Fourier coefﬁcient of μ.

176
3 Fourier Series
The Fourier series of f at x ∈Tn is the series
∑
m∈Zn
1f(m)e2πim·x.
(3.1.6)
It is not clear at present in which sense and for which x ∈Tn (3.1.6) converges. The
study of convergence of Fourier series is the main topic of study in this chapter.
We quickly recall the notation we introduced in Chapter 2. We denote by f the
complex conjugate of the function f, by #f the function #f(x) = f(−x), and by τy( f)
the function τy( f)(x) = f(x−y) for all y ∈Tn. We mention some elementary prop-
erties of Fourier coefﬁcients.
Proposition 3.1.2. Let f, g be in L1(Tn). Then for all m,k ∈Zn, λ ∈C, y ∈Tn, and
all multi-indices α we have
(1) 
f +g(m) = 1f(m)+ 1g(m),
(2) 2
λ f(m) = λ 1f(m),
(3) 1f (m) = 1f(−m),
(4) 1#f (m) = 1f(−m),
(5)

τy( f)(m) = 1f(m)e−2πim·y ,
(6) (e2πik(·) f)1(m) = 1f(m−k),
(7) 1f(0) =

Tn f(x)dx,
(8)
sup
m∈Zn | 1f(m)| ≤
 f

L1(Tn) ,
(9)
3
f ∗g(m) = 1f(m)1g(m),
(10) 3
∂α f(m) = (2πim)α 1f(m), whenever f ∈C α.
Proof. The proof of properties (1)–(10) is rather easy and is left to the reader. We
only sketch the proof of (9). We have
3
f ∗g(m) =

Tn

Tn f(x−y)g(y)e−2πim·(x−y)e−2πim·y dydx = 1f(m)1g(m),
where the interchange of integrals is justiﬁed by the absolute convergence of the
integrals and Fubini’s theorem.
□
Remark 3.1.3. The Fourier coefﬁcients have the following property. For a function
f1 on Tn1 and a function f2 on Tn2, the tensor function
( f1 ⊗f2)(x1,x2) = f1(x1) f2(x2)

3.1 Fourier Coefﬁcients
177
is a periodic function on Tn1+n2 whose Fourier coefﬁcients are

f1 ⊗f2(m1,m2) = 1f1(m1) 1f2(m2),
(3.1.7)
for all m1 ∈Zn1 and m2 ∈Zn2.
Deﬁnition 3.1.4. A trigonometric polynomial on Tn is a function of the form
P(x) = ∑
m∈Zn
ame2πim·x,
(3.1.8)
where {am}m∈Zn is a ﬁnitely supported sequence in Zn. The degree of P is the largest
number |q1|+···+|qn| such that aq is nonzero, where q = (q1,...,qn). Observe that
in view of the orthonormality of the exponentials we have for all m ∈Zn
1P(m) = am .
Example 3.1.5. If the sequence {am}m has only one nonzero term, then the trigono-
metric polynomial of Deﬁnition 3.1.4 reduces to a trigonometric monomial, which
has the form
P(x) = ae2πi(q1x1+···+qnxn)
for some q = (q1,...,qn) ∈Zn and a ∈C.
Let
P(x) = ∑
|m|≤N
ame2πim·x = ∑
|m|≤N
1P(m)e2πim·x
be a trigonometric polynomial on Tn and let μ be a ﬁnite Borel measure on Tn. Then
we have
(P∗μ)(x) =

Tn ∑
|m|≤N
1P(m)e2πim·(x−y) dμ(y) = ∑
|m|≤N
1P(m)1μ(m)e2πim·x.
(3.1.9)
In particular, if f is an integrable function on Tn we have
(P∗f)(x) =

Tn f(y) ∑
|m|≤N
1P(m)e2πim·(x−y) dy = ∑
|m|≤N
1P(m) 1f(m)e2πim·x.
(3.1.10)
This implies that the partial sums
∑
|m|≤N
1f(m)e2πim·x
of the Fourier series of f in (3.1.6) can be obtained by convolving f with the function
DN(x) = ∑
|m|≤N
e2πim·x .
(3.1.11)
This function is called the Dirichlet kernel.

178
3 Fourier Series
3.1.3 The Dirichlet and Fej´er Kernels
Deﬁnition 3.1.6. Let 0 ≤R < ∞. The square Dirichlet kernel on Tn is the function
Dn
R(x) = ∑
m∈Zn
|mj|≤R
e2πim·x .
(3.1.12)
The circular (or spherical) Dirichlet kernel on Tn is the function
◦Dn
R(x) = ∑
m∈Zn
|m|≤R
e2πim·x .
(3.1.13)
In dimension n = 1 these functions coincide and are denoted by
DR(x) = D1
R(x) =
◦
D1
R(x).
This function is called the Dirichlet kernel and coincides with DN(x) in (3.1.11)
when N ≤R < N +1 and N ∈Z+ ∪{0}; see Figure 3.2.
-0.4
-0.2
0.2
0.4
-2
2
4
6
8
10
Fig. 3.2 The graph of the Dirichlet kernel D5 plotted on the interval [−1/2,1/2].
Both the square and circular (or spherical) Dirichlet kernels are trigonomet-
ric polynomials. The square Dirichlet kernel on Tn is equal to a product of one-
dimensional Dirichlet kernels, that is,
Dn
R(x1,...,xn) = DR(x1)···DR(xn).
(3.1.14)
We have the following two equivalent ways to write the Dirichlet kernel DN:
DN(x) = ∑
|m|≤N
e2πim·x = sin((2N +1)πx)
sin(πx)
,
(3.1.15)

3.1 Fourier Coefﬁcients
179
for x ∈[0,1]. To verify the validity of (3.1.15), we write
∑
|m|≤N
e2πim·x = e−2πiNx e2πi(2N+1)x −1
e2πix −1
= e2πi(N+1)x −e−2πiNx
eπix(eπix −e−πix)
= sin((2N +1)πx)
sin(πx)
.
It follows that for R ∈R+ ∪{0} we have
DR(x) = sin(πx(2[R]+1))
sin(πx)
.
(3.1.16)
It is reasonable to ask whether the family {DR}R>0 forms an approximate identity
as R →∞. Using (3.1.15) we see that each DR is integrable over [−1/2,1/2] and
has integral equal to 1. But it follows from Exercise 3.1.5 that ∥DR∥L1 ≈logR as
R →∞, and therefore property (i) in Deﬁnition 1.2.15 fails for DR. We conclude
that the family {DR}R>0 is not an approximate identity on T1, which signiﬁcantly
complicates the study of Fourier series. Consequently, the family {Dn
R}R>0 is not an
approximate identity on Tn, since ∥Dn
R∥L1(T1) ≈(logR)n. The same is true for the
family of circular (or spherical) Dirichlet kernels {
◦Dn
R}R>0. Although this is harder
to prove, it will be a consequence of the results in Section 4.2.
A typical situation encountered in analysis is that the means of a sequence behave
better than the original sequence. This fact led Ces`aro and independently Fej´er to
consider the arithmetic means of the Dirichlet kernel in dimension 1, that is, the
expressions
FN(x) =
1
N +1

D0(x)+D1(x)+D2(x)+···+DN(x)

.
(3.1.17)
The expression in (3.1.17) is in fact equal to the Fej´er kernel given in Example 1.2.18.
We have the following identity concerning the kernel FN.
Proposition 3.1.7. For every nonnegative integer N the identity holds
FN(x) =
N
∑
j=−N

1−
| j|
N +1

e2πi jx =
1
N +1
sin(π(N +1)x)
sin(πx)
2
(3.1.18)
for all x ∈T1. Thus 2
FN(m) = 1−|m|
N+1 if |m| ≤N and zero otherwise.
Proof. The fact that the expression in (3.1.17) is equal to the middle term in (3.1.18)
is a consequence of the trivial calculation:
1
N +1
N
∑
k=0
Dk(x) =
1
N +1
N
∑
k=0 ∑
| j|≤k
e2πi jx = ∑
| j|≤N
#{k ∈Z : | j| ≤k ≤N}
N +1
e2πi jx .
To verify the second equality in (3.1.18) we use the simple geometric series identity
1+r +r2 +···+rN = 1−rN+1
1−r
to write for x ̸= 0

180
3 Fourier Series
N
∑
j=1
e2πi jx = e2πi(N+1)x −1
e2πix −1
−1 = eiπ(N+1)x
eiπx
eπi(N+1)x −e−πi(N+1)x
eπix −e−πix
−1
from which it follows that
N
∑
j=1
| j|e2πi jx = 1
2πi
d
dx

eiπNx sin(π(N +1)x)
sin(πx)

.
(3.1.19)
Likewise we prove that
−1
∑
j=−N
| j|e2πi jx = −1
2πi
d
dx

e−iπNx sin(π(N +1)x)
sin(πx)

.
(3.1.20)
Adding (3.1.19) and (3.1.20) we deduce
∑
| j|≤N
| j|e2πi jx = 1
π
d
dx
sin(πNx)sin(π(N +1)x)
sin(πx)

.
(3.1.21)
Multiplying (3.1.21) by −
1
N+1 and adding DN(x) we obtain
N
∑
j=−N

1−
| j|
N +1

e2πi jx = sin(π(2N +1)x)
sin(πx)
−1
π
d
dx

sin(πNx) sin(π(N +1)x)
(N +1)sin(πx)

.
Writing the preceding expression on the right as
(N+1)sin(π(N+1)x)cos(πNx)sin(πx)+(N+1)cos(π(N+1)x)sin(πNx)sin(πx)
(N+1)sin2(πx)
−1
π
d
dx
	
sin(πNx)sin(π(N+1)x)

sin(πx)−
	
sin(πNx)sin(π(N+1)x)

π cos(πx)
(N+1)sin2(πx)
,
computing the derivative of the expression in the curly brackets, and simplifying,
we ﬁnally obtain that
N
∑
j=−N

1−
| j|
N +1

e2πi jx =
1
N +1
sin(π(N +1)x)
sin(πx)
2
.
(3.1.22)
This proves the second identity in (3.1.18).
□
Deﬁnition 3.1.8. Let N be a nonnegative integer. The function FN on T1 given by
(3.1.22) is called the Fej´er kernel.
The Fej´er kernel Fn
N on Tn is deﬁned as the product of the 1-dimensional Fej´er
kernels, or as the average of the product of the Dirichlet kernels in each variable,
precisely, F1
N(x) = FN(x) and

3.1 Fourier Coefﬁcients
181
Fn
N(x1,...,xn) =
n
∏
j=1
FN(xj)
=
n
∏
j=1

1
N +1
N
∑
k=0
Dk(xj)

=
1
(N +1)n
N
∑
k1=0
...
N
∑
kn=0
Dk1(x1)···Dkn(xn).
Note that Fn
N is a trigonometric polynomial of degree nN.
Remark 3.1.9. Using the identities for FN in (3.1.18), we may write for all N ≥0
Fn
N(x1,...,xn) = ∑
m∈Zn
|mj|≤N

1−|m1|
N +1

···

1−|mn|
N +1

e2πim·x
(3.1.23)
=
1
(N +1)n
n
∏
j=1
sin(π(N +1)xj)
sin(πxj)
2
,
(3.1.24)
thus Fn
N ≥0. Observe that Fn
0 (x) = 1 for all x ∈Tn and that Fn
N(0) = (N +1)n.
Proposition 3.1.10. The family of Fej´er kernels {Fn
N}∞
N=0 is an approximate identity
on Tn.
Proof. Since Fn
N ≥0 we have that ∥Fn
N∥L1 =

Tn Fn
N dx. Also

Tn Fn
N dx = 1, in view
of identity (3.1.23). Thus properties (i) and (ii) of approximate identities (according
to Deﬁnition 1.2.15) hold. To prove property (iii) of the deﬁnition we make use of
identity (3.1.24). Using the fact that 1 ≤
|t|
|sint| ≤π
2 when |t| ≤π
2 , we obtain
FN(x) ≤
1
N +1 min
(N +1)|πx|
|sin(πx)| ,
1
|sin(πx)|
2
≤
1
N +1
π2
4 min

N +1, 1
|πx|
2
when |x| ≤1
2. This implies that for δ > 0 we have

δ≤|x|≤1
2
FN(x)dx ≤
1
N +1
π2
4

δ≤|x|≤1
2
dx
|πδ|2 ≤
1
4δ 2
1
N +1 →0
as N →∞. In higher dimensions, given x = (x1,...,xn) ∈[−1/2,1/2]n with |x| ≥δ,
there is a j ∈{1,...,n} such that |xj| ≥δ/√n and thus

x∈Tn
|x|≥δ
Fn
N(x)dx ≤
n
∑
j=1

|x j|≥δ
√n
FN(xj)dxj∏
k̸= j

T1 FN(xk)dxk ≤
n
4(δ/√n)2
1
N +1 →0.
This proves the claim.
□

182
3 Fourier Series
Exercises
3.1.1. Identify T1 with [−1/2,1/2] and let h(t) be an integrable function on T1.
(a) If h(t) ≥0 is even, show that 1h(m) is real and |1h(m)| ≤1h(0) for all m ∈Z.
(b) If h(t) is odd and h(t) ≥0 on [0,1/2), then i1h(m) is real and |1h(m)| ≤im1h(1)
for all m ∈Z.
3.1.2. Suppose that h is a periodic integrable function on [−1/2,1/2) with integral
zero. Deﬁne another periodic function H on T1 by setting
H(x) =
 x
−1/2 h(t)dt .
Compute 1H(m) in terms of 1h(m) for m ∈Z.
3.1.3. Suppose that {gε}ε>0 is an approximate identity on Rn as ε →0 and let
Gε(x) = ∑
ℓ∈Zn
gε(x+ℓ).
Show that the family {Gε}ε>0 is an approximate identity on Tn.
3.1.4. On T1 deﬁne the de la Vall´ee Poussin kernel
VN(x) = 2F2N+1(x)−FN(x).
(a) Show that the sequence VN is an approximate identity.
(b) Prove that 2
VN(m) = 1 when |m| ≤N +1, and 2
VN(m) = 0 when |m| ≥2N +2.
3.1.5. (a) Show that for all |t| ≤π
2 we have

1
sin(t) −1
t
 ≤1−2
π .
(b) Let DN be the Dirichlet kernel on T1. Prove that for N ∈Z+ we have
4
π2
N
∑
k=1
1
k ≤
DN

L1 ≤3−2
π + 4
π2
N
∑
k=1
1
k .
Conclude that the numbers ∥DN∥L1 grow logarithmically as N →∞and therefore
the family {DN}∞
N=1 is not an approximate identity on T1. The numbers ∥DN∥L1,
N = 1,2,... are called the Lebesgue constants.

Hint: Part (a): Show that the derivative of
1
sin(t) −1
t is nonnegative on (0, π
2 ], or
equivalently prove that tan(t)sin(t) ≥t2 on (0, π
2 ]; this is a consequence of the in-
equality
"
sin(t)tan(t) ≥2(
1
sin(t) +
1
tan(t))−1 = 2tan( t
2) ≥t. Part (b): Replace DN(t)
by sin((2N+1)πt)
πt
and estimate the difference using part (a).


3.2 Reproduction of Functions from Their Fourier Coefﬁcients
183
3.1.6. Let DN be the Dirichlet kernel on T1. Prove that for all 1 < p < ∞there exist
two constants Cp,cp > 0 such that
cp (2N +1)1/p′ ≤
DN

Lp ≤Cp (2N +1)1/p′.

Hint: Consider the two closest zeros of DN near the origin and split the integral
into the intervals thus obtained.

3.1.7. The Poisson kernel on Tn is the function
Pr1,...,rn(x) = ∑
m∈Zn
r|m1|
1
···r|mn|
n
e2πim·x
and is deﬁned for 0 < r1,...,rn < 1. Prove that Pr1,...,rn can be written as
Pr1,...,rn(x1,...,xn) =
n
∏
j=1
Re
1+r je2πix j
1−r je2πix j

=
n
∏
j=1
1−r2
j
1−2r j cos(2πxj)+r2
j
,
and conclude that Pr,...,r(x) is an approximate identity as r ↑1.
3.2 Reproduction of Functions from Their Fourier Coefﬁcients
We can obtain very interesting results using the Fej´er kernel.
Proposition 3.2.1. The set of trigonometric polynomials is dense in Lp(Tn) for 1 ≤
p < ∞.
Proof. Given f in Lp(Tn) for 1 ≤p < ∞, consider f ∗Fn
N. Clearly f ∗Fn
N is also a
trigonometric polynomial. In view of Theorem 1.2.19 (1), f ∗Fn
N converges to f in
Lp as N →∞.
□
Corollary 3.2.2. (Weierstrass approximation theorem for trigonometric polyno-
mials) Every continuous function on the torus is a uniform limit of trigonometric
polynomials.
Proof. Since f is continuous on Tn, which is a compact set, Theorem 1.2.19 (2)
gives that f ∗Fn
N converges uniformly to f as N →∞. But f ∗Fn
N is a trigonomet-
ric polynomial, and so we conclude that every continuous function on Tn can be
uniformly approximated by trigonometric polynomials.
□
3.2.1 Partial sums and Fourier inversion
We now deﬁne the partial sums of Fourier series.

184
3 Fourier Series
Deﬁnition 3.2.3. Let R ≥0 and N ∈Z+ ∪{0}. The expressions
( f ∗Dn
R)(x) = ∑
m∈Zn
|mj|≤R
1f(m)e2πim·x
are called the square partial sums of the Fourier series of f. Then the expressions
( f ∗
◦Dn
R)(x) = ∑
m∈Zn
|m|≤R
1f(m)e2πim·x
are called the circular (or spherical) partial sums of the Fourier series of f. The
expressions
( f ∗Fn
N)(x) = ∑
m∈Zn
|mj|≤N

1−|m1|
N +1

···

1−|mn|
N +1

1f(m)e2πim·x
are called the square Ces`aro means (or square Fej´er means) of f.
Finally, for R ≥0 the expressions
( f ∗
◦Fn
R )(x) = ∑
m∈Zn
|m|≤R

1−|m|
R

1f(m)e2πim·x
are called the circular Ces`aro means (or circular Fej´er means) of f.
Observe that f ∗
◦Fn
R is equal to the average of the expressions f ∗
◦Dn
r in the
following sense:
( f ∗
◦Fn
R )(x) = 1
R
 R
0 ( f ∗
◦Dn
r)(x)dr.
This is analogous to the fact that the Fej´er kernel FN is the average of the Dirichlet
kernels D0, D1,...,DN.
A fundamental problem is in what sense the partial sums of the Fourier series
converge back to the function as R →∞or N →∞. This problem is of central im-
portance in harmonic analysis and is in part investigated in this chapter.
We now ask the question whether the Fourier coefﬁcients uniquely determine the
function. The answer is afﬁrmative and simple.
Proposition 3.2.4. If f,g ∈L1(Tn) satisfy 1f(m) = 1g(m) for all m in Zn, then
f = g a.e.
Proof. By linearity of the problem, it sufﬁces to assume that g = 0. If 1f(m) = 0
for all m ∈Zn, Deﬁnition 3.2.3 implies that Fn
N ∗f = 0 for all N ∈Z+. In view of
Proposition 3.1.10, the sequence {Fn
N}N∈Z+ is an approximate identity as N →∞.
Therefore,
f −Fn
N ∗f

L1 →0
as N →∞; hence ∥f∥L1 = 0, from which we conclude that f = 0 a.e.
□

3.2 Reproduction of Functions from Their Fourier Coefﬁcients
185
A useful consequence of the result just proved is the following.
Proposition 3.2.5. (Fourier inversion) Suppose that f ∈L1(Tn) and that
∑
m∈Zn
| 1f(m)| < ∞.
Then
f(x) = ∑
m∈Zn
1f(m)e2πim·x
a.e.,
(3.2.1)
and therefore f is almost everywhere equal to a continuous function.
Proof. It is straightforward to check that both functions in (3.2.1) are well deﬁned
and have the same Fourier coefﬁcients. Therefore, they must be almost everywhere
equal by Proposition 3.2.4. Moreover, the function on the right in (3.2.1) is every-
where continuous.
□
3.2.2 Fourier series of square summable functions
Let H be a separable Hilbert space with complex inner product ⟨·|·⟩. Recall that
a subset E of H is called orthonormal if ⟨f |g⟩= 0 for all f, g in E with f ̸= g,
while ⟨f | f⟩= 1 for all f in E. A complete orthonormal system is a subset of H
having the additional property that the only vector orthogonal to all of its elements
is the zero vector. We summarize basic properties about orthonormal systems in the
proposition below (see [307]).
Proposition 3.2.6. Let H be a separable Hilbert space and let {ϕk}k∈Z be an or-
thonormal system in H. Then the following are equivalent:
(1) {ϕk}k∈Z is a complete orthonormal system.
(2) For every f ∈H we have
 f
2
H = ∑
k∈Z
|⟨f |ϕk⟩|2 .
(3) For every f ∈H we have
f = lim
N→∞∑
|k|≤N
⟨f |ϕk⟩ϕk ,
where the series converges in H.
Now consider the Hilbert space space L2(Tn) with inner product
4
f |g
5
=

Tn f(t)g(t)dt .

186
3 Fourier Series
Let ϕm be the sequence of functions ξ →e2πim·ξ indexed by m ∈Zn. The orthonor-
mality of the sequence {ϕm} is a consequence of the following simple but crucial
identity:

[0,1]n e2πim·x e2πik·x dx =

1
when m = k,
0
when m ̸= k.
The completeness of the sequence {ϕm} is also evident. Since
4
f |ϕm
5
= 1f(m) for
all f ∈L2(Tn), it follows from Proposition 3.2.4 that if
4
f |ϕm
5
= 0 for all m ∈Zn,
then f = 0 a.e.
The next result is a consequence of Proposition 3.2.6.
Proposition 3.2.7. The following are valid for f,g ∈L2(Tn):
(1) (Plancherel’s identity)
 f
2
L2 = ∑
m∈Zn
| 1f(m)|2 .
(2) The function f(t) is a.e. equal to the L2(Tn) limit of the sequence
lim
M→∞∑
|m|≤M
1f(m)e2πim·t .
(3) (Parseval’s relation)

Tn f(t)g(t)dt = ∑
m∈Zn
1f(m)1g(m).
(4) The map f →{ 1f(m)}m∈Zn is an isometry from L2(Tn) onto ℓ2.
(5) For all k ∈Zn we have
2
fg(k) = ∑
m∈Zn
1f(m)1g(k −m) = ∑
m∈Zn
1f(k −m)1g(m).
Proof. (1) and (2) follow from the corresponding statements in Proposition 3.2.6.
Notice that both sides of (3) converge by the Cauchy-Schwarz inequality. Parseval’s
relation (3) follows from polarization. By this we mean the following procedure.
First replace f by f +g in (1) and expand the squares to obtain
∥f∥2
L2 +∥g∥2
L2 +2Re⟨f |g⟩=∥f +g∥2
L2
= ∑
m∈Zn
| 1f(m)+ 1g(m)|2
= ∑
m∈Zn
| 1f(m)|2 + ∑
m∈Zn
|1g(m)|2 +2Re ∑
m∈Zn
1f(m)1g(m)
and from this it follows that the real parts of the expressions in (3) are equal. Next
replace f by f +ig in (1) and expand the squares. Using Re(−iw) = Imw we obtain

3.2 Reproduction of Functions from Their Fourier Coefﬁcients
187
∥f∥2
L2 +∥g∥2
L2 +2Im⟨f |g⟩=∥f +ig∥2
L2
= ∑
m∈Zn
| 1f(m)+i 1g(m)|2
= ∑
m∈Zn
| 1f(m)|2 + ∑
m∈Zn
|1g(m)|2 +2Im ∑
m∈Zn
1f(m)1g(m),
and thus the imaginary parts of the expressions in (3) are equal. Thus (3) holds.
Next we prove (4). We already know that the map f →{ 1f(m)}m∈Zn is an injective
isometry. It remains to show that it is onto. Given a square summable sequence
{am}m∈Zn of complex numbers, deﬁne
fN(t) = ∑
|m|≤N
ame2πim·t.
Observe that fN is a Cauchy sequence in L2(Tn) and it therefore converges to some
f ∈L2(Tn). Then we have 1f(m) = am for all m ∈Zn. Finally, (5) is a consequence
of (3) and Proposition 3.1.2 (6) and (3).
□
3.2.3 The Poisson Summation Formula
We end this section with an important result that connects Fourier analysis on the
torus with Fourier analysis on Rn. Suppose that f is an integrable function on Rn
and let 1f be its Fourier transform. Restrict 1f on Zn and form the “Fourier series”
(assuming that it converges)
∑
m∈Zn
1f(m)e2πim·x.
What does this series represent? Since the preceding function is 1-periodic in every
variable, it follows that it cannot be equal to f, unless f is itself periodic. However,
it should not come as a surprise that it is in fact equal to the periodization of f
on Rn. In other words, the Fourier expansion of a function on Rn reproduces the
periodization of the function.
Theorem 3.2.8. (Poisson summation formula) Let f be a continuous function on
Rn which satisﬁes for some C,δ > 0 and for all x ∈Rn
| f(x)| ≤C(1+|x|)−n−δ,
and whose Fourier transform 1f restricted on Zn satisﬁes
∑
m∈Zn
| 1f(m)| < ∞.
(3.2.2)

188
3 Fourier Series
Then for all x ∈Rn we have
∑
m∈Zn
1f(m)e2πim·x = ∑
k∈Zn
f(x+k),
(3.2.3)
and in particular
∑
m∈Zn
1f(m) = ∑
k∈Zn
f(k).
Proof. Deﬁne a 1-periodic function on Tn by setting
F(x) = ∑
k∈Zn
f(x+k).
It is straightforward to verify that ∥F∥L1([0,1]n) = ∥f∥L1(Rn), thus F lies in L1(Tn). We
prove that the sequence of the Fourier coefﬁcients of F coincides with the restriction
of the Fourier transform of f on Zn. This follows from the calculation
1F(m) =

Tn ∑
k∈Zn
f(x+k)e−2πim·x dx
= ∑
k∈Zn

Tn f(x+k)e−2πim·x dx
= ∑
k∈Zn

[−1
2 , 1
2 ]n−k f(x)e−2πim·x dx
=

Rn f(x)e−2πim·x dx
= 1f(m),
in which the interchange of the sum and the integral is justiﬁed by the Weierstrass
M-test of uniform convergence of series, since
∑
k∈Zn
1
(1+|k +x|)n+δ ≤∑
k∈Zn
(1+√n)n+δ
(1+√n+|k +x|)n+δ ≤∑
k∈Zn
Cn,δ
(1+|k|)n+δ < ∞,
where we used |k + x| ≥|k| −|x| ≥|k| −√n. This calculation also shows that F is
the sum of a uniformly convergent series of continuous functions on [0,1]n, thus
it is itself continuous. It follows that (3.2.2) holds with |1F(m)| in place of | 1f(m)|.
Hence, Proposition 3.2.5 applies, and given the fact that F is continuous, it yields
conclusion (3.2.3) for all x ∈Tn and, by periodicity, for all x ∈Rn.
□
Example 3.2.9. We have seen earlier (Exercise 2.2.11) that the following identity
gives the Fourier transform of the Poisson kernel in Rn:
(e−2π|x|)1(ξ) = Γ ( n+1
2 )
π
n+1
2
1
(1+|ξ|2)
n+1
2
.

3.2 Reproduction of Functions from Their Fourier Coefﬁcients
189
The Poisson summation formula yields the identity
Γ ( n+1
2 )
π
n+1
2
∑
k∈Zn
ε−n
(1+ |k+x|2
ε2
)
n+1
2
= ∑
m∈Zn
e−2πε|m|e−2πim·x
(3.2.4)
which implies
Γ ( n+1
2 )
π
n+1
2
∑
k∈Zn
1
(1+|k|2)
n+1
2
= ∑
m∈Zn
e−2π|m| .
(3.2.5)
It follows from (3.2.4) that
∑
k∈Zn\{0}
1
(ε2 +|k|2)
n+1
2
= 1
ε
 π
n+1
2
Γ ( n+1
2 ) ∑
m∈Zn
e−2πε|m| −1
εn

,
from which we obtain the identity
∑
k∈Zn\{0}
1
|k|n+1 = lim
ε→0
1
ε
 π
n+1
2
Γ ( n+1
2 ) ∑
m∈Zn
e−2πε|m| −1
εn

.
(3.2.6)
The limit in (3.2.6) can be easily calculated in dimension 1 using that
lim
δ→0
π2
δ
1+e−2δ
1−e−2δ −1
δ

= π2
3 ,
and this yields
∑
k̸=0
1
k2 = π2
3 .
Also, in dimension 1, from (3.2.5) we obtain the related identity
∑
k∈Z
1
1+k2 = π ∑
m∈Z
e−2π|m| = π 1+e−2π
1−e−2π .
Example 3.2.10. Let 0 < Re α < n. We introduce a smooth function 1Φ(ξ) which is
equal to 1 on the ball |ξ| ≤1 and vanishes outside the ball |ξ| ≤2. We investigate
the behavior as x →0 of the expression
lim
R→∞
∑
m∈Zn\{0}
e2πim·x
|m|α
1Φ
m
R

when x ∈[−1
2, 1
2)n \{0}. As in Example 2.4.9, let η be a smooth radial function on
Rn that is equal to 1 outside the ball B(0,1/2) and vanishes on the ball B(0,1/4)
and deﬁne
g = (η(ξ)|ξ|−α)1.

190
3 Fourier Series
Let Φδ(x) = δ −nΦ(x/δ). The Poisson summation formula (Theorem 3.2.8) gives
∑
k∈Zn\{0}
e2πik·x
|k|α
1Φ
 k
R

= ∑
k∈Zn
η(k)e2πik·x
|k|α
1Φ
 k
R

= (g∗Φ1/R)(x)+
∑
m∈Zn\{0}
(g∗Φ1/R)(x+m).
It was shown in Example 2.4.9 that g(y) decays faster than the reciprocal of any
polynomial at inﬁnity and is equal to πα−n
2Γ ( n−α
2 )Γ ( α
2 )−1|y|α−n + h(y), where h
is a smooth function on Rn. Since x ̸= 0, it follows that g is smooth in a small rela-
tively compact neighborhood of x and, since {Φ1/R}R>0 is an approximate identity,
Theorem 1.2.19 (2) yields that (g∗Φ1/R)(x) →g(x) as R →∞. Assume for a moment
that
lim
R→∞
∑
m∈Zn\{0}
(g∗Φ1/R)(x+m) =
∑
m∈Zn\{0}
lim
R→∞(g∗Φ1/R)(x+m).
(3.2.7)
Since x + m does not vanish for any m ∈Zn \ {0}, the function g is smooth in a
relatively compact neighborhood of x + m, and thus (g ∗Φ1/R)(x + m) →g(x + m)
as R →∞. Consequently, the sum on the right in (3.2.7) is equal to
∑
m∈Zn\{0}
g(x+m).
We conclude that
lim
R→∞
∑
m∈Zn\{0}
e2πim·x
|m|α
1Φ
m
R

= πα−n
2Γ ( n−α
2 )
Γ ( α
2 )
|x|α−n +h1(x),
where h1 is a C ∞function on [−1
2, 1
2)n given by
h1(t) = h(t)+
∑
m∈Zn\{0}
g(t +m).
We now explain the passage of the limit inside the sum in (3.2.7). This is a con-
sequence of the Lebesgue dominated convergence theorem, provided we know that
|(g∗Φ1/R)(x+m)| ≤
C
|m|n+1 ,
|m| > 5√n
(3.2.8)
for some constant C independent of R ≥1 and of m. Indeed, the expression on the
left of this inequality is bounded by I +II, where
I = Cn,α

|x+m−y|≤2√n |x+m−y|α−n
Rn
(1+R|y|)2n+2 dy
II = Cn,α

|x+m−y|≥2√n
1
(1+|x+m−y|)2n+2
Rn
(1+R|y|)2n+2 dy.

3.2 Reproduction of Functions from Their Fourier Coefﬁcients
191
In I we have
1+R|y| ≥R|x+m|−R|x+m−y| ≥R|m|−1
2R√n−2R√n ≥1
2R|m|,
hence
I ≤C′
n,αR−n−2|m|−2n−2 ≤C′
n,α|m|−2n−2 .
In II we use
(1+|x+m−y|)n+1(1+R|y|)n+1 ≥(1+|m|)n+1
while the term left produces a convergent integral, which is uniformly bounded in
R ≥1. This proves (3.2.8).
Exercises
3.2.1. On T1 let P be a trigonometric polynomial of degree N > 0. Show that P has
at most 2N zeros. Construct a trigonometric polynomial with exactly 2N zeros.
3.2.2. (Hausdorff–Young inequality) Prove that when f ∈Lp(Tn), 1 ≤p ≤2, the
sequence of Fourier coefﬁcients of f is in ℓp′(Zn) and

∑
m∈Zn
| 1f(m)|p′1/p′
≤
f

Lp(Tn).
Also observe that 1 is the best constant in the preceding inequality.
3.2.3. Use without proof that there exists a constant C > 0 such that for all t ∈R we
have

N
∑
k=2
eiklogkeikt
 ≤C
√
N,
N = 2,3,4,...,
to construct an example of a continuous function g on T1 with
∑
m∈Z
|1g(m)|q = ∞
for all q < 2. Thus the Hausdorff–Young inequality of Exercise 3.2.2 fails for p > 2.

Hint: Consider g(x) = ∑∞
k=2
eiklogk
k1/2(logk)2 e2πikx. For a proof of the previous estimate,
see Zygmund [388, Theorem (4.7) p. 199].

3.2.4. (S. Bernstein) Let P(x) be a trigonometric polynomial of degree N on T1.
Prove that ∥P′∥L∞≤4πN∥P∥L∞.

Hint: Prove ﬁrst that P′(x)/2πiN is equal to

(e−2πiN(·)P)∗FN−1

(x)e2πiNx −

(e2πiN(·)P)∗FN−1

(x)e−2πiNx
and then take L∞norms.


192
3 Fourier Series
3.2.5. (Fej´er and F. Riesz) Let P(ξ) = ∑N
k=−N ake2πikξ be a trigonometric polyno-
mial on T1 of degree N such that P(ξ) > 0 for all ξ. Prove that there exists a trigono-
metric polynomial Q(ξ) of the form ∑N
k=0 bke2πikξ such that P(ξ) = |Q(ξ)|2.

Hint: Since P ≥0 the complex-variable polynomial R(z) = ∑N
k=−N akzk+N must
satisfy R(z) = z2NR(1/z), and thus it must have N zeros inside the unit circle and
the other N outside. Therefore we may write R(z) = aN ∏s
k=1(z −zk)rk(z −1/zk)rk
for some 0 < |zk| < 1 and rk ≥1 with ∑s
k=1 rk = N. Then take z = e2πiξ.

3.2.6. Let g be a function on Rn that satisﬁes |g(x)| + |1g(x)| ≤C(1 + |x|)−n−δ for
some C,δ > 0 and all x ∈Rn. Prove that
λ n ∑
m∈Zn
1g(λm+α)e2πix·(m+ α
λ ) = ∑
k∈Zn
g
x+k
λ

e−2πi k·α
λ
for any x,α ∈Rn and λ > 0.
3.2.7. Verify the following identity when 0 < r < 1 and x ∈Rn
Γ ( n+1
2 )
π
n+1
2
∑
k∈Zn
1
2π log 1
r

( 1
2π log 1
r )2 +|x−k|2 n+1
2
= ∑
m∈Zn
r|m|e2πim·x .
In the special case n = 1 and x ∈R we have
1
π ∑
k∈Z
1
2π log 1
r
( 1
2π log 1
r )2 +|x−k|2 =
1−r2
1−2rcos(2πx)+r2 .

Hint: Use identity (3.2.4) and Exercise 3.1.7 when n = 1.

3.2.8. Let γ ∈R and λ > 0. Show that
∑
k∈Z
cos(2πkγ)
λ 2 +k2
= π
λ
cosh(2πλ(γ −[γ]−1
2))
sinh(πλ)
.

Hint: Use Exercise 3.2.6 when n = 1 with x = 0, α = −γλ, g(x) = 1
π
1
1+x2 and sum
in m.

3.3 Decay of Fourier Coefﬁcients
In this section we investigate the interplay between the smoothness of a function and
the decay of its Fourier coefﬁcients.

3.3 Decay of Fourier Coefﬁcients
193
3.3.1 Decay of Fourier Coefﬁcients of Arbitrary Integrable
Functions
We begin with the classical result asserting that the Fourier coefﬁcients of any inte-
grable function tend to zero at inﬁnity. One should compare the following proposi-
tion with Proposition 2.2.17.
Proposition 3.3.1. (Riemann–Lebesgue lemma) Given a function f in L1(Tn), we
have that | 1f(m)| →0 as |m| →∞.
Proof. Given f ∈L1(Tn) and ε > 0, let P be a trigonometric polynomial such that
∥f −P∥L1 < ε. If |m| > degree(P), then 1P(m) = 0 and thus
| 1f(m)| = | 1f(m)−1P(m)| ≤
f −P

L1 < ε.
This proves that | 1f(m)| →0 as |m| →∞.
□
Several questions are naturally raised. How fast can the Fourier coefﬁcients of an
L1 function tend to zero? Does additional smoothness of the function imply faster
decay of the Fourier coefﬁcients? Can such a decay be quantitatively expressed in
terms of the smoothness of the function?
We answer the ﬁrst question. Fourier coefﬁcients of an L1 function may tend to
zero arbitrarily slowly, that is, slower than any given rate of decay. To achieve this,
we need the following two lemmas.
Lemma 3.3.2. Given a sequence of positive real numbers {am}∞
m=0 that tends to
zero as m →∞, there exists a sequence {cm}∞
m=0 that satisﬁes
cm ≥am,
cm ↓0,
and
cm+2 +cm ≥2cm+1
(3.3.1)
for all m = 0,1,.... A sequence {cm}∞
m=0 that satisﬁes (3.3.1) is called convex.
Proof. Let k0 = 0 and suppose that am ≤M for all m ≥0. Find k1 > k0 such that
for m ≥k1 we have am ≤M/2. Now ﬁnd k2 > k1 + k1−k0
2
such that for m ≥k2 we
have am ≤M/4. Next ﬁnd k3 > k2 + k2−k1
2
such that for m ≥k3 we have am ≤M/8.
Continue inductively in this way and construct a subsequence k0 < k1 < k2 < ··· of
the integers such that for m ≥kj+1 we have am ≤2−j−1M and kj+1 > kj + k j−k j−1
2
for j ≥1. Join the points (k0,2M), (k1,M), (k2,M/2), (k3,M/4),... by straight
lines and note that by the choice of the sequence {kj}∞
j=0 the resulting piecewise
linear function h is convex on [0,∞). Deﬁne cm = h(m) and observe that the se-
quence {cm}∞
m=0 satisﬁes the required properties. Exercise 3.3.1 contains an alterna-
tive proof.
□
Lemma 3.3.3. Given a convex decreasing sequence {cm}∞
m=0 of positive real num-
bers satisfying limm→∞cm = 0 and a ﬁxed integer s ≥0, we have that

194
3 Fourier Series
∞
∑
r=0
(r +1)(cr+s +cr+s+2 −2cr+s+1) = cs .
(3.3.2)
Proof. We begin by observing the validity of the telescoping sum
N
∑
r=0
(r +1)(cr+s +cr+s+2 −2cr+s+1)
= cs −(N +1)(cs+N+1 −cs+N+2)−cs+N+1 .
(3.3.3)
To show that the last expression tends to cs as N →∞, we take M = [ N
2 ] and we use
convexity

cs+M+ j−cs+M+ j+1 ≥cs+M+ j+1−cs+M+ j+2

to obtain
cs+M+1 −cs+N+2 = cs+M+1 −cs+M+2
+cs+M+2 −cs+M+3
+···
+cs+N+1 −cs+N+2
≥(N −M +1)(cs+N+1 −cs+N+2)
≥N+1
2 (cs+N+1 −cs+N+2) ≥0.
The preceding calculation implies that (N + 1)(cs+N+1 −cs+N+2) tends to zero as
N →∞and thus the expression in (3.3.3) converges to cs as N →∞.
□
The proof of Lemma 3.3.3 appears more natural after examining Exercise 3.3.3(a).
We now state the theorem we alluded to earlier.
Theorem 3.3.4. Let (dm)m∈Zn be a sequence of positive real numbers with dm →0
as |m| →∞. Then there exists a function f ∈L1(Tn) such that 1f(m) ≥dm for all
m ∈Zn. In other words, given any rate of decay, there exists an integrable function
on the torus whose Fourier coefﬁcients have slower rate of decay.
Proof. We are given a sequence of positive numbers {am}m∈Z that converges to zero
as |m| →∞and we would like to ﬁnd an integrable function on T1 with 1f(m) ≥am
for all m ∈Z. Apply Lemma 3.3.2 to the sequence {am +a−m}m≥0 to ﬁnd a convex
sequence {cm}m≥0 that dominates {am +a−m}m≥0 and decreases to zero as m →∞.
Extend cm for m < 0 by setting cm = c|m|. Now deﬁne
f(x) =
∞
∑
j=0
( j +1)(cj +cj+2 −2cj+1)Fj(x),
(3.3.4)
where Fj is the (one-dimensional) Fej´er kernel. The convexity of the sequence cm
and the positivity of the Fej´er kernel imply that f ≥0. Lemma 3.3.3 with s = 0 gives
that
∞
∑
j=0
( j +1)(cj +cj+2 −2cj+1)
Fj

L1 = c0 < ∞,
(3.3.5)

3.3 Decay of Fourier Coefﬁcients
195
since ∥Fj∥L1 = 1 for all j. Therefore (3.3.4) deﬁnes an integrable function f on T1.
We now compute the Fourier coefﬁcients of f. Since the series in (3.3.4) converges
in L1, for m ∈Z we have
1f(m) =
∞
∑
j=0
( j +1)(cj +cj+2 −2cj+1) 1Fj(m)
=
∞
∑
j=|m|
( j +1)(cj +cj+2 −2cj+1)

1−|m|
j +1

=
∞
∑
r=0
(r +1)(cr+|m| +cr+|m|+2 −2cr+|m|+1)
= c|m| = cm ,
(3.3.6)
where we used Lemma 3.3.3 with s = |m|.
Let us now extend this result on Tn. Let (dm)m∈Zn be a positive sequence with
dm →0 as |m| →∞. By Exercise 3.3.2, there exists a positive sequence (aj) j∈Z with
am1 ···amn ≥d(m1,...,mn) and aj →0 as | j| →∞. Let
f(x1,...,xn) = f(x1)··· f(xn),
where f is the function previously constructed when n = 1 so that 1f(m) ≥am. It can
be seen easily using (3.1.7) that 1f(m) ≥dm.
□
3.3.2 Decay of Fourier Coefﬁcients of Smooth Functions
We next study the decay of the Fourier coefﬁcients of functions that possess a cer-
tain amount of smoothness. In this section we see that the decay of the Fourier
coefﬁcients reﬂects the smoothness of the function in a rather precise quantitative
way. Conversely, one can infer some information about the smoothness of a function
from the decay of its Fourier coefﬁcients.
Deﬁnition 3.3.5. Given 0 < γ < 1 and f a function on Tn, deﬁne the homogeneous
Lipschitz seminorm of order γ of f by
f
.
Λγ = sup
x,h∈Tn
h̸=0
| f(x+h)−f(x)|
|h|γ
and deﬁne the homogeneous Lipschitz space of order γ as
.
Λγ(Tn) = {f : Tn →C with
 f
.
Λγ < ∞}.
Functions in .
Λγ(Tn) are called homogeneous Lipschitz functions of order γ.
There is an analogous deﬁnition for the inhomogeneous norm.

196
3 Fourier Series
Deﬁnition 3.3.6. For 0 < γ < 1 and f a function on Tn, deﬁne the inhomogeneous
Lipschitz norm of order γ of f by
f

Λγ =
 f

L∞+ sup
x,h∈Tn
h̸=0
| f(x+h)−f(x)|
|h|γ
=
f

L∞+
f
.
Λγ .
Also deﬁne the inhomogeneous Lipschitz space of order γ as
Λγ(Tn) = {f : Tn →C with
 f

Λγ < ∞}.
Functions in Λγ(Tn) are called inhomogeneous Lipschitz functions of order γ.
Remark 3.3.7. Functions in both spaces Λγ(Tn) and .
Λγ(Tn) are obviously contin-
uous and therefore bounded. Moreover, the functional ∥· ∥Λγ is a norm on Λγ(Tn).
The positive functional ∥· ∥.
Λγ satisﬁes the triangle inequality, but it does not satisfy
the property ∥f∥.
Λγ = 0 =⇒f = 0 required to be a norm. It is therefore a semi-
norm on .
Λγ(Tn). However, if we identify functions whose difference is a constant,
we form a space of the equivalence classes .
Λγ(Tn)/{constants} on which ∥· ∥.
Λγ is
a norm.
Remark 3.3.8. We already observed that elements of .
Λγ(Tn) are continuous and
thus bounded. Therefore, .
Λγ(Tn) ⊆L∞(Tn) in the set-theoretic sense. However, the
norm inequality ∥f∥L∞≤C∥f∥.
Λγ for all f ∈.
Λγ fails for all constants C. For exam-
ple, take f = N +sin(2πx1) on Tn and let N →∞to see that this is the case.
The following theorem indicates how the smoothness of a function is reﬂected
by the decay of its Fourier coefﬁcients.
Theorem 3.3.9. Let s ∈Z with s ≥0.
(a) Suppose that ∂α f exist and are integrable for all |α| ≤s. Then
| 1f(m)| ≤
√n
2π
s max
|α|=s| 3
∂α f(m)|
|m|s
,
m ̸= 0,
(3.3.7)
and thus
| 1f(m)|(1+|m|s) →0
as |m| →∞. In particular this holds when f lies in C s(Tn).
(b) Suppose that ∂α f exist for all |α| ≤s and whenever |α| = s, ∂α f are in .
Λγ(Tn)
for some 0 < γ < 1. Then
| 1f(m)| ≤(√n)s+γ
(2π)s2γ+1
max
|α|=s
∂α f
.
Λγ
|m|s+γ
,
m ̸= 0.
(3.3.8)

3.3 Decay of Fourier Coefﬁcients
197
Proof. Fix m ∈Zn \ {0} and pick a j such that |mj| = sup1≤k≤n |mk|. Then clearly
mj ̸= 0. Integrating by parts s times with respect to the variable xj, we obtain
1f(m) =

Tn f(x)e−2πix·m dx = (−1)s

Tn(∂s
j f)(x) e−2πix·m
(−2πimj)s dx,
(3.3.9)
where the boundary terms all vanish because of the periodicity of the integrand.
Taking absolute values and using |m| ≤√n|mj|, we obtain assertion (3.3.7).
We now turn to the second part of the theorem. Let ej = (0,...,1,...,0) be the
element of the torus Tn whose jth coordinate is one and all the others are zero. A
simple change of variables together with the fact that eπi = −1 gives that

Tn(∂s
j f)(x)e−2πix·m dx = −

Tn(∂s
j f)(x−e j
2mj )e−2πix·m dx,
which implies that

Tn(∂s
j f)(x)e−2πix·m dx = 1
2

Tn

(∂s
j f)(x)−(∂s
j f)(x−e j
2mj )

e−2πix·m dx.
Now use the estimate
|(∂s
j f)(x)−(∂s
j f)(x−e j
2mj )| ≤
∂s
j f
.
Λγ
(2|mj|)γ
and identity (3.3.9) to conclude the proof of (3.3.8).
□
The following is an immediate consequence.
Corollary 3.3.10. Let s ∈Z with s ≥0.
(a) Suppose that ∂α f exist and are integrable for all |α| ≤s. Then for some constant
cn,s we have
| 1f(m)| ≤cn,s
max

∥f∥L1,max|α|=s ∥∂α f∥L1

(1+|m|)s
.
(3.3.10)
(b) Suppose that ∂α f exist for all |α| ≤s and whenever |α| = s, ∂α f are in .
Λγ(Tn)
for some 0 < γ < 1. Then for some constant c′
n,s we have
| 1f(m)| ≤c′
n,s
max

∥f∥L1,max|α|=s ∥∂α f∥˙Λγ

(1+|m|)s+γ
.
(3.3.11)
Remark 3.3.11. The conclusions of Theorem 3.3.9 and Corollary 3.3.10 are also
valid when γ = 1. In this case the spaces ˙Λγ should be replaced by the space Lip1
equipped with the seminorm
 f

Lip1 = sup
x,h∈Tn
h̸=0
| f(x+h)−f(x)|
|h|
.

198
3 Fourier Series
There is a slight lack of uniformity in the notation here, since in the theory of Lips-
chitz spaces the notation .
Λ1 is usually reserved for the space with seminorm
 f
.
Λ1 = sup
x,h∈Tn
h̸=0
| f(x+h)+ f(x−h)−2f(x)|
|h|
.
The following proposition provides a partial converse to Theorem 3.3.9. We
denote below by [[s]] the largest integer strictly less than a given real number s.
Then [[s]] is equal to the integer part [s] of s, unless s is an integer, in which case
[[s]] = [s]−1.
Proposition 3.3.12. Let s > 0 and suppose that f is an integrable function on the
torus with
| 1f(m)| ≤C(1+|m|)−s−n
(3.3.12)
for all m ∈Zn. Then f has partial derivatives of all orders |α| ≤[[s]], and for 0 <
γ < s−[[s]], ∂α f ∈.
Λγ for all multi-indices α satisfying |α| = [[s]].
Proof. Since f has an absolutely convergent Fourier series, Proposition 3.2.5 gives
that
f(x) = ∑
m∈Zn
1f(m)e2πix·m ,
(3.3.13)
for almost all x ∈Tn.
Suppose that a series g = ∑m gm satisﬁes ∑m ∥∂βgm∥L∞< ∞for all |β| ≤M. Then
the function g is in C M and ∂βg = ∑m ∂βgm; indeed this can be proved by induction
on the degree of the multi-index, since for all |β| ≤M −1 we have
lim
t→0
∂βg(x+tej)−∂βg(x)
t
= ∑
m
lim
t→0
∂βgm(x+tej)−∂βgm(x)
t
= ∑
m
∂j∂βg(x),
where the passage of the limit inside the sum is due to the Lebesgue dominated con-
vergence theorem, which can be applied using the uniform convergence of ∑m ∂j∂βg
via the mean value theorem.
Using the preceding observation, the function f in (3.3.13) is C [[s]](Tn) and
(∂α f)(x) = ∑
m∈Zn
1f(m)(2πim)αe2πix·m
for all multi-indices (α1,...,αn) with |α| ≤[[s]], since
∑
m∈Zn
1f(m) sup
x∈Tn
(2πim)αe2πix·m < ∞,
which holds because of (3.3.12).

3.3 Decay of Fourier Coefﬁcients
199
Now suppose that |α| = [[s]] and that 0 < γ < s−[[s]]. Then
|(∂α f)(x+h)−(∂α f)(x)| =
 ∑
m∈Zn
1f(m)(2πim)αe2πix·m
e2πim·h −1

≤(2π)[[s]] ∑
m∈Zn
|m|[[s]]C21−γ(2π)γ|h|γ|m|γ
(1+|m|)n+s
≤C21−γ(2π)s|h|γ ,
where we used the relation [[s]]+γ −s−n < −n to conclude the convergence of the
series and the fact that
|e2πim·h −1| ≤min(2,2π|m||h|) ≤21−γ(2π)γ|m|γ|h|γ .
□
Next we recall the deﬁnition of functions of bounded variation.
Deﬁnition 3.3.13. A measurable function f on T1 is said to be of bounded variation
if it is deﬁned everywhere and
Var( f) = sup
 M
∑
j=1
| f(xj)−f(xj−1)| : 0 = x0 < x1 < ··· < xM = 1

< ∞,
where the supremum is taken over all partitions of the interval [0,1]. The expression
Var( f) is called the total variation of f. The class of functions of bounded variation
on T1 is denoted by BV(T1).
Examples of functions of bounded variation can be constructed as follows: given
f1, f2 nonnegative integrable functions on [0,1] with
 1
0 f1(t)dt =
 1
0 f2(t)dt ,
then the periodic function
g(x) =
 x
0 f1(t)dt −
 x
0 f2(t)dt ,
deﬁned on[0,1], is of bounded variation. Analogous examples can be constructed
when f1 and f2 are replaced by nonnegative ﬁnite Borel measures on [0,1].
Every function of bounded variation can be represented as the difference of two
(not necessarily strictly) increasing functions and thus it has a ﬁnite derivative at
almost every point. Moreover, for functions of bounded variation, the Lebesgue–
Stieltjes integral with respect to d f is well deﬁned.

200
3 Fourier Series
Proposition 3.3.14. If f is in BV(T1), then
| 1f(m)| ≤Var( f)
2π|m|
whenever m ̸= 0.
Proof. Integration by parts gives
1f(m) =

T1 f(x)e−2πimx dx =

T1
e−2πimx
−2πim d f ,
where the boundary terms vanish because of periodicity. The conclusion follows
from the fact that the norm of the measure d f is the total variation of f.
□
The following chart (Table 3.1) summarizes the decay of Fourier coefﬁcients in
terms of scales of spaces measuring the smoothness of the functions. Recall that
for q ≥0, 1f(m) = o(|m|−q) means that | 1f(m)||m|q →0 as |m| →∞and 1f(m) =
O(|m|−q) means that | 1f(m)| ≤C|m|−q when |m| is large. In this chart, we denote by
C s,γ(Tn) the space of all C s functions on Tn, all of whose derivatives of total order
s lie in Λγ(Tn), for some 0 < γ < 1.
SPACE
SEQUENCE OF FOURIER COEFFICIENTS
L1(Tn)
o(1)
Lp(Tn)
ℓp′(Zn)
L2(Tn)
ℓ2(Zn)
.
Λγ(Tn)
O(|m|−γ)
BV(T1)
O(|m|−1)
C 1(Tn)
o(|m|−1)
C 1,γ(Tn)
O(|m|−1−γ)
C 2(Tn)
o(|m|−2)
C 2,γ(Tn)
O(|m|−2−γ)
C 3(Tn)
o(|m|−3)
···
···
C ∞(Tn)
o(|m|−N) for all N > 0
Table 3.1 Interconnection between smoothness of functions and decay of their Fourier coefﬁ-
cients. We take 0 < γ < 1 and 1 < p < 2.
3.3.3 Functions with Absolutely Summable Fourier Coefﬁcients
Decay for the Fourier coefﬁcients can also be indirectly deduced from knowledge
about the summability of these coefﬁcients. The simplest kind of summability is in
the sense of ℓ1. It is therefore natural to consider the class of functions on the torus
whose Fourier coefﬁcients form an absolutely summable series.

3.3 Decay of Fourier Coefﬁcients
201
Deﬁnition 3.3.15. An integrable function f on the torus is said to have an absolutely
convergent Fourier series if
∑
m∈Zn
| 1f(m)| < +∞.
We denote by A(Tn) the space of all integrable functions on the torus Tn whose
Fourier series are absolutely convergent. We then introduce a norm on A(Tn) by
setting
f

A(Tn) = ∑
m∈Zn
| 1f(m)|.
In view of Proposition 3.2.5, every function f in A(Tn) can be changed on a set of
measure zero to be made continuous and under this modiﬁcation, Fourier inversion
f(x) = ∑
m∈Zn
1f(m)e2πim·x
holds for all x ∈Tn. Thus functions in A(Tn) are continuous and bounded. More-
over, Theorem 3.3.9 yields that every function in C n(Tn) whose partial derivatives
of order n are in .
Λγ, γ > 0, must lie in A(Tn). The following theorem gives us a
signiﬁcantly better sufﬁcient condition for a function to be in A(Tn).
Theorem 3.3.16. Suppose f is a given function in C [n/2](Tn) and that all partial
derivatives of order [ n
2] of f lie in .
Λγ(Tn) for some γ with n
2 −[ n
2] < γ < 1. Then f
lies in A(Tn) and
f

A(Tn) ≤| 1f(0)|+C(n,γ) sup
|α|=[ n
2 ]
∂α f
.
Λγ(Tn),
where C(n,γ) is a constant depending on n and γ.
Proof. For each ℓ= 0,1,2,..., let
Sℓ=

∑
2ℓ≤|m|<2ℓ+1
| 1f(m)|2
1/2
.
We begin by writing
f

A(Tn) = | 1f(0)|+
∞
∑
ℓ=0
∑
2ℓ≤|m|<2ℓ+1
| 1f(m)| ≤| 1f(0)|+√cn
∞
∑
ℓ=0
2
ℓn
2 Sℓ,
(3.3.14)
where we used the Cauchy-Schwarz inequality and the fact that there are at most
cn2ℓn points in Zn inside the open ball B(0,2ℓ+1), for some dimensional constant cn.
Notice that for a multi-index m = (m1,...,mn) satisfying 2ℓ≤|m| ≤2ℓ+1 and for
j in {1,...,n} such that |mj| = supk |mk| we have
|mj|
2ℓ≥|m|
2ℓ√n ≥1
√n .
(3.3.15)

202
3 Fourier Series
For 1 ≤j ≤n, let ej be the element of Rn with zero entries except for the jth
coordinate, which is 1, and deﬁne
hℓ
j = 2−ℓ−2ej .
(3.3.16)
Using the elementary fact that |t| ≤π =⇒|eit −1| ≥2|t|/π, we obtain
|e2πim·hℓ
j −1| = |e2πimj2−ℓ−2 −1| ≥2
π
|2πmj|
2ℓ+2
= |mj|
2ℓ≥1
√n ,
(3.3.17)
whenever |2πmj|
2ℓ+2 ≤π, which is always true since |2πmj|
2ℓ+2 ≤2π2ℓ+1
2ℓ+2
≤π.
We now have
S2
ℓ=
n
∑
j=1
∑
2ℓ≤|m|<2ℓ+1
|mj|=supk |mk|
| 1f(m)|2
≤n
n
∑
j=1
∑
2ℓ≤|m|<2ℓ+1
|mj|=supk |mk|
|e2πim·hℓ
j −1|2| 1f(m)|2 |2πimj|2[ n
2 ]
|2πmj|2[ n
2 ]
≤n
n[ n
2 ]
(2π2ℓ)2[ n
2 ]
n
∑
j=1 ∑
m∈Zn
|e2πim·hℓ
j −1|2| 
∂[n/2]
j
f(m)|2
= Cn2−2ℓ[ n
2 ]
n
∑
j=1
∂[n/2]
j
f(· +hℓ
j)−∂[n/2]
j
f
2
L2
≤Cn2−2ℓ[ n
2 ]
n
∑
j=1
∂[n/2]
j
f(· +hℓ
j)−∂[n/2]
j
f
2
L∞
≤C′
n2−2ℓ[ n
2 ] sup
|α|=[ n
2 ]
∂α f
2.
Λγ
n
∑
j=1
|hℓ
j|2γ
= C′
n,γ 2−2ℓ[ n
2 ]−2ℓγ sup
|α|=[ n
2 ]
∂α f
2.
Λγ ,
where we used (3.3.17), (3.3.15), and (3.3.16). We conclude that
Sℓ≤C′′
n,γ 2−ℓ([ n
2 ]+γ) sup
|α|=[ n
2 ]
∂α f
.
Λγ
which inserted in (3.3.14) yields the desired conclusion since γ > n
2 −[ n
2].
□
Exercises
3.3.1. Given a sequence {an}∞
n=0 of positive numbers such that an →0 as n →∞,
ﬁnd a nonnegative integrable function h on [0,1] such that

3.3 Decay of Fourier Coefﬁcients
203
 1
0 h(t)tm dt ≥am.
Use this result to deduce a different proof of Lemma 3.3.2.

Hint: Try h = e
∞
∑
k=0
(sup
j≥k
aj −sup
j≥k+1
aj)(k +2)χ[ k+1
k+2 ,1].

3.3.2. Prove that given a positive sequence {dm}m∈Zn with dm →0 as |m| →∞,
there exists a positive sequence {aj}j∈Z with am1 ···amn ≥d(m1,...,mn) and aj →0 as
| j| →∞.
3.3.3. (a) Use the idea of the proof of Lemma 3.3.3 to prove that if a twice contin-
uously differentiable function f ≥0 is deﬁned on (0,∞) and satisﬁes f ′(x) ≤0 and
f ′′(x) ≥0 for all x > 0, then limx→∞x f ′(x) = 0.
(b) Suppose that a continuously differentiable function g is deﬁned on (0,∞) and
satisﬁes g ≥0, g′ ≤0, and
 ∞
1 g(x)dx < +∞. Prove that
lim
x→∞xg(x) = 0.
3.3.4. Prove that for 0 < γ < δ < 1 we have ∥f∥.
Λγ ≤Cn,γ,δ∥f∥.
Λδ for all functions
f and thus .
Λδ is a subspace of .
Λγ.
3.3.5. Suppose that f is a differentiable function on T1 whose derivative f ′ is in
L2(T1). Prove that f ∈A(T1) and that
 f

A(T1) ≤
f

L1 + 1
2π
 ∑
j̸=0
j−21/2f ′
L2.
3.3.6. (a) Prove that the product of two functions in A(Tn) is also in A(Tn) and that
 fg

A(Tn) ≤
f

A(Tn)
g

A(Tn).
(b) Prove that the convolution of two square integrable functions on Tn always gives
a function in A(Tn).
3.3.7. Fix 0 < α < 1 and deﬁne f on T1 by setting
f(x) =
∞
∑
k=0
2−αke2πi2kx.
Prove that the function f lies in .
Λα(T1). Conclude that there does not exist positive
β > α such that for all f in .
Λα(T1) we have supm∈Z |m|β| 1f(m)| < ∞.

Hint: For h ̸= 0 pick N ∈Z+ such that 2N|h| > 1 ≥2N−1|h|. To estimate the differ-
ence | f(x+h)−f(x)|, consider the cases k ≤N and k ≥N +1 in the sum.


204
3 Fourier Series
3.3.8. Use without proof that there exists a constant C > 0 such that
sup
t∈R

N
∑
k=2
eiklogkeikt
 ≤C
√
N,
N = 2,3,4,...,
to prove that the function
g(x) =
∞
∑
k=2
eiklogk
k
e2πikx
is in .
Λ1/2(T1) but not in A(T1). Conclude that the restriction s > 1/2 in Theorem
3.3.16 is sharp.

Hint: Estimate the difference |g(x+h)−g(x)| using the summation by parts iden-
tity in Appendix F, taking sums of the sequence eiklogke2πikx and differences of the
sequence e2πikh−1
k
.

3.3.9. Show that there exist sequences {am}m∈Zn that tend to zero as |m| →∞for
which there do not exist functions f in L1(Tn) with 1f(m) = am for all m.

Hint: Suppose the contrary. Then the open mapping theorem would imply the in-
equality ∥f∥L1(Tn) ≤A∥1f ∥ℓ∞(Zn) for some A > 0. To contradict it, ﬁx a smooth
nonzero function h equal to 1 on B(0, 1
4) and supported in B(0, 1
2). For b > 0 de-
ﬁne gb(x) = h(x)e−π(1+ib)|x|2 and extend gb to a 1-periodic function in each variable
on Rn. Use that 1gb(m) =

Rn 1h(y)(1 + ib)−n/2e−
π
1+ib |m−y|2dy, and let b →∞in the
inequality ∥gb∥L1(Tn) ≤A∥1gb ∥ℓ∞(Zn) to obtain a contradiction.

3.4 Pointwise Convergence of Fourier Series
In this section we are concerned with the pointwise convergence of the square partial
sums and the Fej´er means of a function deﬁned on the torus.
3.4.1 Pointwise Convergence of the Fej´er Means
We saw in Section 3.1 that the Fej´er kernel is an approximate identity. This implies
that the Fej´er (or Ces`aro) means of an Lp function f on Tn converge to it in Lp for any
1 ≤p < ∞. Moreover, if f is continuous at x0, then the means (Fn
N ∗f)(x0) converge
to f(x0) as N →∞in view of Theorem 1.2.19 (2). Although this is a satisfactory
result, it is natural to ask what happens for more general functions.

3.4 Pointwise Convergence of Fourier Series
205
Using properties of the Fej´er kernel, we obtain the following one-dimensional
result regarding the convergence of the Fej´er means:
Theorem 3.4.1. (Fej´er) If a function f in L1(T1) has left and right limits at a point
x0, denoted by f(x0−) and f(x0+), respectively, then
(FN ∗f)(x0) →1
2

f(x0+)+ f(x0−)

as
N →∞.
(3.4.1)
In particular, this is the case for functions of bounded variation.
Proof. Let us identify T1 with [−1/2,1/2]. Given ε > 0, ﬁnd δ ∈(0,1/2) such that
0 < t < δ =⇒

f(x0 +t)+ f(x0 −t)
2
−f(x0+)+ f(x0−)
2
 < ε .
(3.4.2)
Using the second expression for FN in (3.1.18), we can ﬁnd an N0 > 0 such that for
N ≥N0 we have
sup
δ≤t≤1
2
FN(t) =
1
N +1 sup
δ≤t≤1
2
sin(π(N +1)t)
sin(πt)
2
≤
1
N +1
1
sin2(πδ) < ε.
(3.4.3)
We now have
(FN ∗f)(x0)−f(x0+) =

T1 FN(t)

f(x0 +t)−f(x0+)

dt ,
(FN ∗f)(x0)−f(x0−) =

T1 FN(t)

f(x0 −t)−f(x0−)

dt .
Averaging these two identities and using that the integrand is even, we obtain
(FN ∗f)(x0)−f(x0+)+ f(x0−)
2
= 2
 1/2
0
FN(t)
 f(x0 +t)+ f(x0 −t)
2
−f(x0+)+ f(x0−)
2

dt .
(3.4.4)
We split the integral in (3.4.4) into two pieces, the integral over [0,δ) and the inte-
gral over [δ,1/2]. By (3.4.2), the integral over [0,δ) is controlled by ε

T1 FN(t)dt =
ε. Also (3.4.3) gives that for N ≥N0

 1/2
δ
FN(t)
 f(x0 −t)+ f(x0 +t)
2
−f(x0−)+ f(x0+)
2

dt

≤ε
2
 f −f(x0−)

L1 +
f −f(x0+)

L1

= ε c( f,x0),
where c( f,x0) is a constant depending on f and x0. We have now proved that given
ε > 0 there exists an N0 such that for N ≥N0 the second expression in (3.4.4) is
bounded by 2ε (c( f,x0)+1). This proves the required conclusion.

206
3 Fourier Series
Functions of bounded variation can be written as differences of increasing func-
tions, and since increasing functions have left and right limits everywhere, (3.4.1)
holds for these functions.
□
We continue with an elementary but very useful application of the preceding
result.
Proposition 3.4.2. Let x0 ∈T1 and let f be a complex-valued function on T1. Sup-
pose that the left and right limits of f exist as x →x0 and that the partial sums
(Dirichlet means) (DN ∗f)(x0) converge. Then
(DN ∗f)(x0) →1
2

f(x0+)+ f(x0−)

as N →∞.
Proof. If (DN ∗f)(x0) →L(x0) as N →∞, then
(FN ∗f)(x0) = (D0 ∗f)(x0)+(D1 ∗f)(x0)+···+(DN ∗f)(x0)
N +1
→L(x0)
as N →∞. But (FN ∗f)(x0) →1
2

f(x0+)+ f(x0−)

as N →∞in view of Theorem
3.4.1. We conclude that
L(x0) = 1
2

f(x0+)+ f(x0−)

,
Thus (DN ∗f)(x0) →1
2

f(x0+)+ f(x0−)

as N →∞.
□
This theorem is quite useful when we have a priori knowledge that the Fourier
series converges. For instance, consider the following example.
Example 3.4.3. On (−1/2,1/2) let f(t) = t and f(1/2) = f(−1/2) = 1000. Then
f is discontinuous at the point −1/2 ≡1/2 but it has left and right limits at this
point:
lim
t→−1
2 +
f(t) = −1
2
lim
t→1
2 −
f(t) = 1
2 .
(3.4.5)
Moreover 1f(m) = i(−1)m
2πm
when m ̸= 0 and 1f(0) = 0 by Exercise 3.4.1 (a). It is not
hard to see that the series
(DN ∗f)(x) = i
2π
∑
0<|m|≤N
(−1)m
m
e2πimx = i
2π
∑
0<|m|≤N
e2πim(x+ 1
2 )
m
(3.4.6)

3.4 Pointwise Convergence of Fourier Series
207
converges for every x ∈(−1/2,1/2). Indeed, by Appendix F, (3.4.6) equals
i
2π
1
N
N
∑
m=1

e2πim(x+ 1
2 ) −e−2πim(x+ 1
2 )
−i
2π
N−1
∑
k=1

k
∑
m=1

e2πim(x+ 1
2 ) −e−2πim(x+ 1
2 )
1
k +1 −1
k

which has a limit as N →∞, since the geometric sums
N
∑
m=1
e±2πim(x+ 1
2 ) = 1−e±2πi(N+1)(x+ 1
2 )
1−e±2πi(x+ 1
2 )
−1
are bounded above independently of N when x ∈(−1/2,1/2). We conclude that
f(x) = x = lim
N→∞
i
2π
∑
0<|m|≤N
e2πim(x+ 1
2 )
m
= −lim
N→∞∑
0<|m|≤N
sin(2πm(x+ 1
2))
2πm
whenever |x| < 1/2. Moreover, we have that
(DN ∗f)(1/2) = lim
N→∞
i
2π
∑
0<|m|≤N
0
m = 0,
which is the average of the left and right limits in (3.4.5) as Proposition 3.4.2 states.
Exercise 3.4.2 contains other applications of this sort.
3.4.2 Almost Everywhere Convergence of the Fej´er Means
We have seen that the Fej´er means of a relatively nice function (such as of bounded
variation) converge everywhere. What can we say about the Fej´er means of a general
integrable function? Since the Fej´er kernel is an approximate identity that satisﬁes
good estimates, the following result should not come as a surprise.
Theorem 3.4.4. (a) For f ∈L1(Tn), let
H ( f) = sup
N∈Z+ | f ∗Fn
N|.
Then H maps L1(Tn) to L1,∞(Tn) and Lp(Tn) to itself for 1 < p ≤∞.
(b) For any function f ∈L1(Tn), we have as N →∞
(Fn
N ∗f) →f
a.e.
Proof. It is an elementary fact that |t| ≤π
2 =⇒|sint| ≥2
π |t|; see Appendix E.
Using this fact and the expression (3.1.18) we obtain for all t in [−1
2, 1
2],

208
3 Fourier Series
|FN(t)| =
1
N +1

sin(π(N +1)t)
sin(πt)

2
≤N +1
4

sin(π(N +1)t)
(N +1)t

2
≤N +1
4
min

π2,
1
(N +1)2t2

≤π2
2
N +1
1+(N +1)2|t|2 .
For t ∈R let us set ϕ(t) = (1 + |t|2)−1 and ϕε(t) = 1
ε ϕ( t
ε ) for ε > 0. For x =
(x1,...,xn) ∈Rn and ε > 0 we also set
Φ(x) = ϕ(x1)···ϕ(xn)
and Φε(x) = ε−nΦ(ε−1x). Then for |t| ≤1
2 we have |FN(t)| ≤π2
2 ϕε(t) with ε =
(N +1)−1, and for y ∈[−1
2, 1
2]n we have
|Fn
N(y)| ≤( π2
2 )n Φε(y),
with ε = (N +1)−1.
Now let f be an integrable function on Tn and let f0 denote its periodic extension
on Rn. For x ∈[−1
2, 1
2]n we have
H ( f)(x) = sup
N>0


Tn Fn
N(y) f(x−y)dy

≤( π2
2 )n sup
ε>0

[−1
2 , 1
2 ]n |Φε(y)|| f0(x−y)|dy
≤5n sup
ε>0

Rn |Φε(y)| |( f0χQ)(x−y)|dy
= 5nG ( f0χQ)(x),
(3.4.7)
where Q is the cube [−1,1]n and G is the operator deﬁned on integrable functions
on Rn by
G (h) = sup
ε>0
|h|∗Φε .
If we can show that G maps L1(Rn) to L1,∞(Rn), the corresponding conclusion for
H on Tn would follow from the fact H ( f) ≤5nG ( f0χQ) proved in (3.4.7) and the
sequence of inequalities
H ( f)

L1,∞(Tn) ≤5nG ( f0χQ)

L1,∞(Rn) ≤5nC
 f0χQ

L1(Rn) = C′f

L1(Tn).

3.4 Pointwise Convergence of Fourier Series
209
Moreover, the Lp conclusion about H follows from the weak type (1,1) result and
the trivial L∞inequality, in view of the Marcinkiewicz interpolation theorem (The-
orem 1.3.2). The required weak type (1,1) estimate for G on Rn is a consequence of
Lemma 3.4.5. Modulo the proof of this lemma, part (a) of the theorem is proved.
To prove the statement in part (b) observe that for f ∈C ∞(Tn), which is a dense
subspace of L1, we have Fn
N ∗f →f uniformly on Tn as N →∞, since the sequence
{FN}N is an approximate identity. Since by part (a), H maps L1(Tn) to L1,∞(Tn),
Theorem 2.1.14 yields that for f ∈L1(Tn), Fn
N ∗f →f a.e.
□
We now prove the weak type (1,1) boundedness of G used earlier.
Lemma 3.4.5. Let Φ(x1,...,xn) = (1 + |x1|2)−1 ···(1 + |xn|2)−1 and for ε > 0 let
Φε(x) = ε−nΦ(ε−1x). Then the maximal operator
G ( f) = sup
ε>0
| f|∗Φε
maps L1(Rn) to L1,∞(Rn).
Proof. Let I0 = [−1,1] and Ik = {t ∈R : 2k−1 ≤|t| ≤2k} for k = 1,2,.... Also, let
#Ik be the convex hull of Ik, that is, the interval [−2k,2k]. For a2,...,an ﬁxed positive
numbers, let Ma2,...,an be the maximal operator obtained by averaging a function on
Rn over all products of closed intervals J1 ×···×Jn containing a given point with
|J1| = 2a2|J2| = ··· = 2an|Jn|.
In view of Exercise 2.1.9(c), we have that Ma2,...,an maps L1 to L1,∞with some con-
stant independent of the aj’s. (This is due to the nice doubling property of this family
of rectangles.) For a ﬁxed ε > 0 we estimate the expression
(Φε ∗| f|)(0) =

Rn
| f(−εy)|dy
(1+y2
1)···(1+y2n) .
Split Rn into n! regions of the form |yj1| ≥··· ≥|yjn|, where {j1,..., jn} is a per-
mutation of the set {1,...,n} and y = (y1,...,yn). By symmetry, we examine the
region R where |y1| ≥··· ≥|yn|. Then for some constant C > 0 we have

R
| f(−εy)|dy
(1+y2
1)···(1+y2n) ≤C
∞
∑
k1=0
k1
∑
k2=0
···
kn−1
∑
kn=0
2−(2k1+···+2kn)

Ik1
···

Ikn
| f(−εy)|dykn···dy1,
and the last expression is trivially controlled by the corresponding expression, where
the Ik’s are replaced by the #Ik’s. This, in turn, is controlled by
C′
∞
∑
k1=0
k1
∑
k2=0
···
kn−1
∑
kn=0
2−(k1+···+kn)Mk1−k2,...,k1−kn( f)(0).
(3.4.8)

210
3 Fourier Series
Now set s2 = k1 −k2,...,sn = k1 −kn, observe that s j ≥0, use that
2−(k1+···+kn) ≤2−k1
2 2−s2
2n ···2−sn
2n ,
and change the indices of summation to estimate the expression in (3.4.8) by
C′′
∞
∑
k1=0
∞
∑
s2=0
···
∞
∑
sn=0
2−k1
2 2−s2
2n ···2−sn
2n Ms2,...,sn( f)(0).
Argue similarly for the remaining regions |yj1| ≥··· ≥|yjn|. Finally, translate to an
arbitrary point x to obtain the estimate
|(Φε ∗f)(x)| ≤C′′n!
∞
∑
s2=0
···
∞
∑
sn=0
2−s2
2n ···2−sn
2n Ms2,...,sn( f)(x).
Now take the supremum over all ε > 0 and use the fact that the maximal functions
Ms2,...,sn map L1 to L1,∞uniformly in s2,...,sn as well as the result of Exercise 1.4.10
to obtain the desired conclusion for G .
□
3.4.3 Pointwise Divergence of the Dirichlet Means
We now pass to the more difﬁcult question of convergence of the square partial sums
of a Fourier series. It is natural to start our investigation with the class of continuous
functions. Do the partial sums of the Fourier series of continuous functions converge
pointwise? The following simple proposition warns about the behavior of partial
sums.
Proposition 3.4.6. (a) (duBois Reymond) There exists a continuous function f on
T1 whose partial sums diverge at a point. Precisely, for some point x0 ∈T1 we have
limsup
N→∞
 ∑
m∈Z
|mj|≤N
1f(m)e2πix0m
 = ∞.
(b) There exists a continuous function F on Tn and x0 ∈T1 such that the sequence
limsup
N→∞
 ∑
m∈Zn
|mj|≤N
1F(m)e2πi(x0m1+x2m2+···+xnmn)
 = ∞
for all x2,...,xm in T1.

3.4 Pointwise Convergence of Fourier Series
211
Proof. The proof of part (b) is obtained by considering the continuous function
F(x1,...,xn) = f(x1), where f is as in part (a). Then we have
(F ∗Dn
N)(x1,...,xn) = ( f ∗DN)(x1)
and thus the square partial sums of F diverge on the (n −1)-dimensional plane
{(x0,x2,...,xn) : x2,...,xn ∈T1}.
We now prove part (a) using functional analysis. For a constructive proof, see
Exercise 3.4.7. Let C(T1) be the Banach space of all continuous functions on the
circle equipped with the L∞norm. Consider the continuous linear functionals
f →TN( f) = (DN ∗f)(0)
on C(T1) for N = 1,2,.... We show that the norms of the TN’s on C(T1) converge to
inﬁnity as N →∞. To see this, given any integer N ≥100, let ϕN(x) be a continuous
even function on [−1
2, 1
2] that is bounded by 1 and is equal to the sign of DN(x)
except at small intervals of length (2N +1)−2 around the 2N +1 zeros of DN. Call
the union of all these intervals BN and set AN = [−1
2, 1
2]\BN. Then

BN
DN(x)
dx+


BN
ϕN(x)DN(x)dx
 ≤2|BN|(2N +1) = 2.
Using this estimate we obtain
TN

C(T1)→C ≥|TN(ϕN)| =


T1 DN(−x)ϕN(x)dx

≥

AN
DN(x)
dx−


BN
DN(x)ϕN(x)dx

=

T1
DN(x)
dx−


BN
DN(x)ϕN(x)dx
−

BN
DN(x)
dx
≥4
π2
N
∑
k=1
1
k −2.
It follows that the norms of the linear functionals TN are not uniformly bounded. The
uniform boundedness principle now implies the existence of a function f ∈C(T1)
and of a sequence Nj →∞such that
|TNj( f)| →∞
as j →∞. The Fourier series of this f diverges at x0 = 0.
□

212
3 Fourier Series
3.4.4 Pointwise Convergence of the Dirichlet Means
We have seen that continuous functions may have divergent Fourier series. How
about Lipschitz continuous functions? As it turns out, there is a more general condi-
tion that implies convergence for the Fourier series of functions that satisfy a certain
integrability condition.
Theorem 3.4.7. (Dini) Let f be an integrable function on T1, let t0 be a point on T1
for which f(t0) is deﬁned and assume that

|t|≤1
2
| f(t +t0)−f(t0)|
|t|
dt < ∞.
(3.4.9)
Then (Dn
N ∗f)(t0) →f(t0) as N →∞.
(Tonelli) Let f be an integrable function on Tn and let a = (a1,...,an) ∈Tn. If f is
deﬁned at a and

|x1|≤1
2
···

|xn|≤1
2
| f(x+a)−f(a)|
|x1|···|xn|
dxn ···dx1 < ∞,
(3.4.10)
then we have (Dn
N ∗f)(a) →f(a) as N →∞.
Proof. Since the one-dimensional result is contained in the multidimensional one,
we prove the latter. Replacing f(x) by f(x + a) −f(a), we may assume that a = 0
and f(a) = 0. Using identities (3.1.15) and (3.1.14), we can write
(Dn
N ∗f)(0) =

Tn f(−x)
n
∏
j=1
sin((2N +1)πxj)
sin(πxj)
dxn ···dx1
(3.4.11)
=

Tn f(−x)
n
∏
j=1
sin(2Nπxj)cos(πxj)
sin(πxj)
+cos(2Nπxj)

dxn ···dx1 .
Expand out the product to express the integrand as a sum of terms of the form
$
f(−x)∏
j∈I
cos(πxj)
sin(πxj)
%
∏
j∈I
sin(2Nπxj)
∏
k∈{1,2,...,n}\I
cos(2Nπxk),
(3.4.12)
where I is a subset of {1,2,...,n}; here we use the convention that the product over
an empty set of indices is 1. The function fI inside the curly brackets in (3.4.12)
is integrable on [−1
2, 1
2)n except possibly in a neighborhood of the origin, since
|sin(πxj)| ≥2|xj| when |xj| ≤1
2. But condition (3.4.10) with a = 0 and f(a) = 0
guarantees that fI is also integrable in a neighborhood of the origin. Expressing the
sines and cosines in (3.4.12) in terms of exponentials, we obtain that the integral of
(3.4.12) over [−1
2, 1
2)n is a ﬁnite linear combination of Fourier coefﬁcients of fI at
the points (±N,...,±N) ∈Zn. Applying Lemma 3.3.1 yields that the expression in
(3.4.11) tends to zero as N →∞.
□

3.4 Pointwise Convergence of Fourier Series
213
The following are consequences of this test.
Corollary 3.4.8. (a) (Riemann’s principle of localization) Let f be an integrable
function on T1 that vanishes on an open interval I. Then DN ∗f converges to zero
on the interval I.
(b) Let a = (a1,...,an) ∈Tn and suppose that an integrable function f on Tn is
constant on the cross
{x = (x1,...,xn) ∈Tn : |xj −aj| < δ j
for some j},
where 0 < δ j < 1/2 are ﬁxed. Then (Dn
N ∗f)(a) →f(a) as N →∞.
Proof. (a) Let t0 ∈I. If f vanishes on I, condition (3.4.9) holds, since the function
t →f(t +t0)−f(t0) vanishes on −t0 +I, which is an interval containing the origin,
and is integrable outside −t0 +I. Thus (DN ∗f)(t0) →f(t0) = 0 for every t0 ∈I.
(b) We need to show that the function
| f(x+a)−f(a)|
|x1|···|xn|
is integrable over Tn = [−1/2,1/2)n. The integral of this function over Tn is equal
to its integral over the region
S = {(x1,...,xn) ∈Tn : |xk| ≥δk
for all k},
since f(x+a)−f(a) vanishes whenever |xj| < δ j for some j ∈{1,2,...,n}. But on
S we have that
| f(x+a)−f(a)|
|x1|···|xn|
≤| f(x+a)−f(a)|
δ1 ···δn
and this function is integrable over S, since f is. We deduce that (3.4.10) holds.
□
Corollary 3.4.9. Let a ∈Tn and suppose that f ∈L1(Tn) satisﬁes
| f(x)−f(a)| ≤C|x1 −a1|ε1 ···|xn −an|εn
for some C,ε j > 0 and for all x ∈Tn. Then the square partial sums (Dn
N ∗f)(a)
converge to f(a).
Proof. Note that condition (3.4.10) holds.
□
Corollary 3.4.10. (Dirichlet) If f is deﬁned on T1 and is a differentiable function
at a point a in T1, then (DN ∗f)(a) →f(a).
Proof. There exists a δ > 0 (say less than 1/2) such that | f(x) −f(a)|/|x −a| is
bounded by | f ′(a)| + 1 for |x −a| ≤δ. Also | f(x) −f(a)|/|x −a| is bounded by
| f(x)−f(a)|/δ when |x−a| > δ. It follows that condition (3.4.9) holds.
□

214
3 Fourier Series
Exercises
3.4.1. Identify T1 with [−1/2,1/2) and ﬁx 0 < b < 1/2. Prove the following:
(a) The mth Fourier coefﬁcient of the function x is i (−1)m
2πm when m ̸= 0 and 0 when
m = 0.
(b) The mth Fourier coefﬁcient of the function χ[−b,b] is sin(2πbm)
mπ
when m ̸= 0 and
2b when m = 0.
(c) The mth Fourier coefﬁcient of the function

1−|x|
b

+ is sin2(πbm)
bm2π2
when m ̸= 0
and b when m = 0.
(d) The mth Fourier coefﬁcient of the function |x| is −
1
2m2π2 + (−1)m
2m2π2 when m ̸= 0
and 1
4 when m = 0.
(e) The mth Fourier coefﬁcient of the function x2 is (−1)m
2m2π2 when m ̸= 0 and
1
12
when m = 0.
(f) The mth Fourier coefﬁcient of the function cosh(2πx) is (−1)m
1+m2
sinhπ
π
.
(g) The mth Fourier coefﬁcient of the function sinh(2πx) is im(−1)m
1+m2
sinhπ
π
.
3.4.2. Use Exercise 3.4.1 and Proposition 3.4.2 to prove that
∑
k∈Z
1
(2k +1)2 = π2
4
∑
k∈Z\{0}
1
k2 = π2
3
∑
k∈Z\{0}
(−1)k+1
k2
= π2
6
∑
k∈Z
(−1)k
k2 +1 =
2π
eπ −e−π .
3.4.3. Let M > N be given positive integers.
(a) For f ∈L1(T1), prove the following identity:
(DN ∗f)(x) = M +1
M −N (FM ∗f)(x)−N +1
M −N (FN ∗f)(x)
−M +1
M −N
∑
N<| j|≤M

1−
| j|
M +1

1f( j)e2πi jx .
(b) (G. H. Hardy) Suppose that a function f on T1 satisﬁes the following condition:
for any ε > 0 there exists an a > 1 and a k0 > 0 such that for all k ≥k0 we have
∑
k<|m|≤[ak]
| 1f(m)| < ε.
Use part (a) to prove that if (FN ∗f)(x) converges (uniformly) to A(x) as N →∞,
then (DN ∗f)(x) also converges (uniformly) to A(x) as N →∞.

3.4 Pointwise Convergence of Fourier Series
215
3.4.4. Use Proposition 3.4.2 to show that for 0 < b < 1
2 we have
lim
N→∞
N
∑
m=−N
m̸=0
sin(2πbm)
mπ
e2πibm = 1
2 −2b.

Hint: Use Exercise 3.4.1(b).

3.4.5. Let f be an integrable function on Tn and g be a bounded function on Tn
and let K be a compact subset of Tn. Consider the family F = {fw : w ∈K}, where
fw(x) = f(x−w)g(x) for all x ∈Tn. Prove that the Riemann–Lebesgue lemma holds
uniformly for the family F. This means that given ε > 0 there exists an N0(K) > 0
such that for |m| ≥N0 we have | 1fw(m)| ≤ε for all w ∈K.
3.4.6. Prove the following version of Corollary 3.4.8 (b). Suppose that a function f
on Tn is constant on the cross U = {(x1,...,xn) ∈Tn : |xj −aj| < δ for some j},
for some δ < 1/2. Then Dn
N ∗f converges to f(a) uniformly on compact subsets of
the box W = {(x1,...,xn) ∈Tn : |xj| < δ for all j}.

Hint: Use Exercise 3.4.5.

3.4.7. Follow the steps given to obtain a constructive proof of the existence of a
continuous function whose Fourier series diverges at a point. Identify T1 with [0,1)
and deﬁne
g(x) = −2πi(x−1/2).
(a) Prove that 1g(m) = 1/m when m ̸= 0 and zero otherwise.
(b) Prove that for all nonnegative integers M and N we have

(e2πiN(·)(g∗DN))∗DM

(x) = e2πiNx ∑
1≤|r|≤N
1
r e2πirx
when M ≥2N and

(e2πiN(·)(g∗DN))∗DM

(x) = e2πiNx
∑
−N≤r≤M−N
r̸=0
1
r e2πirx
when M < 2N. Conclude that there exists a constant C > 0 such that for all M, N,
and x ̸= 0 we have
|

e2πiN(·)(g∗DN)

∗DM(x)| ≤C
|x| .
(c) Show that there exists a constant C1 > 0 such that
sup
N>0
sup
x∈T1
(g∗DN)(x)
 = sup
N>0
sup
x∈T1
 ∑
1≤|r|≤N
1
r e2πirx
 ≤C1 < ∞.

216
3 Fourier Series
(d) Let λk = 1+eek. Deﬁne
f(x) =
∞
∑
k=1
1
k2 e2πiλkx(g∗Dλk)(x)
and prove that f is continuous on T1 and that its Fourier series converges at every
x ̸= 0, but limsupM→∞|( f ∗DM)(0)| = ∞.

Hint: Take M = eem with m →∞. The inequality in part (b) follows by summation
by parts.

3.5 A Tauberian theorem and Functions of Bounded Variation
The relation between the partial sums of a Fourier series and the Fej´er means is a
particular situation of a relation between sequences of complex numbers and their
arithmetic means. Given a sequence {ak}∞
k=0 of complex numbers, we denote its
partial sums by
sN = a1 +···+aN
for N ≥0, and its arithmetic or Ces`aro means by
σN =
1
N +1
N
∑
k=0
sk =
1
N +1
N
∑
k=0
(N +1−k)ak .
A classical result says that if sN →L as N →∞, then σN →L as N →∞. The converse
is not true, as the example ak = (−1)k indicates. But in a particular situation the
reverse implication holds.
3.5.1 A Tauberian theorem
We have the following result concerning the convergence of {sk}∞
k=0 as a conse-
quence of that of {σk}∞
k=0.
Theorem 3.5.1. (a) Suppose that for a sequence {ak}∞
k=0 of complex numbers we
have that σN →L as N →∞and that |kak| ≤M < ∞for all k = 0,1,2,.... Then
sk →L as k →∞.
(b) Let X be a nonempty set. Suppose that for a sequence {ak(x)}∞
k=0 of complex-
valued functions on X we have that σN(x) →L(x) uniformly in x ∈X as N →∞
and that supk≥0 supx∈X |kak(x)| ≤M < ∞. Then sk(x) →L(x) uniformly in x ∈X as
k →∞.

3.5 A Tauberian theorem and Functions of Bounded Variation
217
Proof. We prove part (b), noting that the proof of part (a) is subsumed in that of (b).
For 0 ≤k < m < ∞we have
(m+1)σm(x)−(k +1)σk(x)−
m
∑
j=k+1
(m+1−j)aj(x)
=
m
∑
j=0
(m+1−j)aj(x)−
k
∑
j=0
(k +1−j)aj(x)−
m
∑
j=k+1
(m+1−j)aj(x)
=(m−k)
k
∑
j=0
aj(x)
=(m−k)sk(x).
Therefore we have
m+1
m−k σm(x)−k +1
m−kσk(x)−
1
m−k
m
∑
j=k+1
(m+1−j)aj(x) = sk(x)
and thus
sk(x)−σk(x) = m+1
m−k (σm(x)−σk(x))−m+1
m−k
m
∑
j=k+1
1
j −
1
m+1

jaj(x). (3.5.1)
Notice that
m
∑
j=k+1
1
j −
1
m+1

≤
 m
k
dt
t −
m
∑
j=k+1
1
m+1 = log m
k −m−k
m+1 .
(3.5.2)
Now ﬁx ε > 0 such that ε < 1. For each k ∈Z+ pick an mk ∈{k,k+1,...,2k} such
that mk
k →1+ε. Then mk+1
mk−k converges to ε−1 +1 as k →∞, hence it is bounded by
some constant Cε. Then (3.5.1) and (3.5.2) with mk in place of m yield
sup
x∈X
sk(x)−σk(x)
 ≤Cε sup
x∈X
|σmk(x)−σk(x)|+M mk +1
mk −k
/
log mk
k −mk −k
mk +1
0
.
Taking the limsupk→∞in the preceding inequality and using that
limsup
k→∞
sup
x∈X
|σmk(x)−σk(x)| = 0,
which is a consequence of the hypothesis that σk (and thus σmk) converges to L
uniformly, we obtain
limsup
k→∞
sup
x∈X
sk(x)−σk(x)
 ≤M
/
1+ 1
ε

log(1+ε)−1
0
.

218
3 Fourier Series
In view of the Taylor expansion
log(1+ε) = ε −1
2ε2 + 1
3ε3 −··· = ε +O(ε2),
which is valid for 0 < ε < 1, we conclude that
limsup
k→∞
sup
x∈X
sk(x)−σk(x)
 ≤M cε
for some absolute constant c > 0. Since ε > 0 was arbitrary, we ﬁnally deduce that
sk(x) converges uniformly to the same limit as σk(x), which is L(x).
□
Corollary 3.5.2. Suppose that a function f on T1 is continuous and there is a con-
stant M > 0 such that | 1f(m)| ≤M|m|−1 for all m ∈Z+ \{0}. Then the Fourier series
of f converges uniformly to f. In particular, if f is a continuous function of bounded
variation on the circle, then f ∗DN →f uniformly on T1 as N →∞.
Proof. The Fej´er means {FN}∞
N=0 are an approximate identity on Tn (Proposition
3.1.10) and so FN ∗f converge uniformly to f on T1 as N →∞in view of Theorem
1.2.19 (2). Moreover, we have |m|| 1f(m)| ≤M for all m ∈Z. It follows from Theorem
3.5.1 that DN ∗f converges uniformly to f.
If, additionally, f is a function of bounded variation, then |m|| 1f(m)| ≤1
2π Var( f),
as shown in Proposition 3.3.14. Then the claimed conclusion follows.
□
3.5.2 The sine integral function
We examine a few useful properties of the antiderivative of sin(t)/t.
Deﬁnition 3.5.3. For 0 ≤x < ∞deﬁne the sine integral function
Si(x) =
 x
0
sin(t)
t
dt .
(3.5.3)
Integrating by parts we write
Si(x) =
 1
0
sin(t)
t
dt + −cos(x)
x
+cos(1)−
 x
1
cos(t)
t2
dt ,
from which it follows that the limit of Si(x) as x →∞exists and is equal to
lim
x→∞Si(x) =
 1
0
sin(t)
t
dt +cos(1)−
 ∞
1
cos(t)
t2
dt .

3.5 A Tauberian theorem and Functions of Bounded Variation
219
To precisely evaluate the limit of Si(x) as x →∞we write
Si((N + 1
2)π) =π

1
2
0
sin((2N +1)πt)
πt
dt
=π

1
2
0
sin((2N +1)πt)
sin(πt)
dt +π

1
2
0 sin((2N +1)πt)
$ 1
πt −
1
sin(πt)
%
dt
=π
2

1
2
−1
2
DN(t)dt + π
2

1
2
−1
2
e(2N+1)πit −e−(2N+1)πit
2i
$ 1
πt −
1
sin(πt)
%
dt,
which converges to π/2 + 0 as N →∞, in view of the Riemann-Lebesgue lemma
(Proposition 3.3.1), since the function inside the curly brackets is integrable over the
circle. We conclude that limx→∞Si(x) = π/2.
Note that Si′ vanishes at nπ, n = 0,1,2,... and Si′′(nπ) = (−1)n/nπ. Conse-
quently, Si(x) has local maxima at the points π, 3π, 5π, ... and local minima at the
points 2π, 4π, 6π, .... Moreover, it is increasing on the intervals [2kπ,(2k + 1)π]
and decreasing on [(2k +1)π,(2k +2)π], k = 0,1,2,.... Also, observe that
Si(3π)−Si(π) =
 2π
π
sin(t)
t
dt +
 2π
π
sin(t +π)
t +π
dt =
 2π
π
sin(t)
1
t −
1
t +π

dt < 0
and likewise we can prove the remaining inequalities in the sequence
Si(π) > Si(3π) > Si(5π) > Si(7π) > ··· > π
2 .
Similarly, one can show that
Si(2π) < Si(4π) < Si(6π) < ··· < π
2 .
Hence Si(π) is the absolute maximum of Si(x) on [0,∞), while 0 is the absolute
minimum of Si(x) on [0,∞); Si(π) is the absolute minimum of Si(x) on [π,∞).
3.5.3 Further properties of functions of bounded variation
Next we have the following theorem concerning functions of bounded variation.
Recall that functions of bounded variation are differences of increasing functions
and thus have left and right limits at every point.
Theorem 3.5.4. Let 0 < δ ≤1/2. Suppose that f is an integrable function on T1
which is of bounded variation on the neighborhood [t0 −δ,t0 + δ] of the point
t0 ∈T1. Then
lim
N→∞( f ∗DN)(t0) = f(t0+)+ f(t0−)
2
.

220
3 Fourier Series
Proof. We write W for the neighborhood (−δ,δ) of 0, Ft0(t) = f(t0−t)+ f(t0+t)
2
, and
Lt0 = f(t0+)+ f(t0−)
2
. We have
( f ∗DN)(t0) =

T1 f(t0 −t)DN(t)dt =

T1 f(t0 +t)DN(t)dt ,
hence, averaging yields
( f ∗DN)(t0) =

T1
f(t0 −t)+ f(t0 +t)
2
DN(t)dt =

T1 Ft0(t)DN(t)dt .
Therefore we have
( f ∗DN)(t0)−Lt0 =

W

Ft0(t)−Lt0

DN(t)dt +

T1\W

Ft0(t)−Lt0

DN(t)dt
and since in the second integral |t| ≥δ, the Riemann-Lebesgue lemma shows that
the second term is o(1), i.e., it tends to zero as N →∞. We now show that the ﬁrst
integral also goes to zero. We write

W

Ft0(t)−Lt0

DN(t)dt =

W

Ft0(t)−Lt0
sin((2N +1)πt)
πt
dt
(3.5.4)
+

W

Ft0(t)−Lt0

1
sin(πt) −1
πt

sin((2N +1)πt)dt ,
but since the function 1
πt −
1
sin(πt) remains bounded on [−1
2, 1
2] (Exercise 3.1.5 (a)), it
follows from the Riemann-Lebesgue lemma that the second term is o(1) as N →∞.
Consequently,
( f ∗DN)(t0)−Lt0 = 1
π

W

Ft0(t)−Lt0
sin((2N +1)πt)
t
dt +o(1)
as N →∞. To prove the required conclusion, it will sufﬁce to show that
2
π
 δ
0

Ft0(t)−Lt0
sin((2N +1)πt)
t
dt →0
(3.5.5)
as N →∞. Let Si(t) be as deﬁned in (3.5.3). We express the integral in (3.5.5) as
 δ
0

Ft0(t)−Lt0

Si′((2N +1)πt)dt
(3.5.6)
Integrating by parts we obtain that (3.5.6) is equal to
(Ft0(δ−)−Lt0)Si((2N +1)πδ)−
 δ
0 Si((2N +1)πt)dFt0(t).
(3.5.7)

3.5 A Tauberian theorem and Functions of Bounded Variation
221
Letting N →∞and using the Lebesgue dominated convergence theorem, we con-
clude that (3.5.7) converges to
(Ft0(δ−)−Lt0)π
2 −
 δ
0
π
2 dFt0(t) = (Ft0(δ−)−Lt0)π
2 −(Ft0(δ−)−Ft0(0+))π
2 = 0
noticing that Lt0 = Ft0(0+).
□
Next, we obtain an explicit bound for the partial sums of functions of bounded
variation. Let Si(t) be as in (3.5.3).
Theorem 3.5.5. Suppose that f is a function of bounded variation on the circle T1.
Then the partial sums of the Fourier series of f are uniformly bounded, in particular,
we have
sup
t0∈T1 sup
N∈Z+ |( f ∗DN)(t0)| ≤

1−2
π +Si(π)

∥f∥L∞+Si(π)Var( f).
(3.5.8)
Proof. We take δ = 1/2 in the proof of the preceding theorem. For a point t0 ∈T1,
let Ft0(t) = f(t0−t)+ f(t0+t)
2
. We have that
( f ∗DN)(t0) =

T1 Ft0(t)sin((2N +1)πt)
πt
dt
+

T1 Ft0(t)

1
sin(πt) −1
πt

sin((2N +1)πt)dt .
(3.5.9)
Using that

1
sin(πt) −1
πt
 ≤1−2
π when |t| ≤1
2 (Exercise 3.1.5 (a)), we obtain that the
second integral in (3.5.9) is bounded by (1−2
π )∥f∥L∞. Integrating by parts as in the
proof of the preceding theorem, we express the ﬁrst integral in (3.5.9) as
Ft0( 1
2−)Si((2N +1)π 1
2)−

1
2
0 Si((2N +1)πt)dFt0(t),
(3.5.10)
which is bounded (in absolute value) by ∥f∥L∞Si(π) + Si(π)Var( f). Assertion
(3.5.8) now follows.
□
3.5.4 Gibbs phenomenon
It is not reasonable to expect that the Fourier series of a discontinuous function
converges uniformly in a neighborhood of a discontinuity. The lack of uniformity in
the convergence can be measured in terms of the worst jump, called the overshoot.
The exact form of nonuniform convergence is illustrated in the following example:

222
3 Fourier Series
Example 3.5.6. Consider the function
h(t) =
⎧
⎪
⎨
⎪
⎩
1
2 −t
when 0 < t ≤1
2
0
when t = 0
−1
2 −t
when −1
2 < t < 0.
(3.5.11)
Clearly h(t) is a function of bounded variation and is continuous except at the point
t = 0 at which it has a jump discontinuity. Since h is an odd function, its Fourier
coefﬁcients are
1h(m) =
 1/2
−1/2 h(t)e−2πimt dt = −2i
 1/2
0
( 1
2 −t)sin(2πmt)dt = −
i
2mπ
when m ̸= 0 and 1h(0) = 0. The partial sums of the Fourier series of h are
(h∗DN)(t) = −i
2π ∑
|m|≤N
m̸=0
e2πimt
m
.
Notice that
d
dt (h∗DN)(t) = ∑
|m|≤N
m̸=0
e2πimt = DN(t)−1.
Then, if we deﬁne d(s) =
1
sin(πs) −1
πs, we can write
(h∗DN)(t) =
 t
0 DN(s)−1ds
= −t +
 t
0
sin((2N +1)πs)
sin(πs)
ds
= −t +
 t
0 d(s)sin((2N +1)πs)ds+
 t
0
sin((2N +1)πs)
πs
ds.
Notice that d(s) is continuous at zero and d(0) = 0, while lims→0
d(s)
s = π
6 ; thus d is a
differentiable function on [0, 1
2] and d′(0) = π
6 . Moreover, lims→0 d′(s) = d′(0), thus
d is continuously differentiable on [0, 1
2]. Additionally both d and d′ are nonnegative
and increasing on [0, 1
2], thus d′ ≤4
π ; see the hint of Exercise 3.1.5. It follows that
 t
0 d(s)sin((2N +1)πs)ds = −cos((2N +1)πt)
(2N +1)π
d(t)+
 t
0 d′(s)cos((2N +1)πs)
(2N +1)π
ds
and the preceding expression is bounded in absolute value by ( d( 1
2 )
π
+ 1
2
d′( 1
2 )
π
)
1
2N+1.
We deduce that
(h∗DN)(t) = −t + 1
π
 t
0
sin((2N +1)πs)
s
ds+O

1
2N +1

,

3.5 A Tauberian theorem and Functions of Bounded Variation
223
where O

1
2N+1

is a function bounded by 1
π
1
2N+1. Consequently,
(h∗DN)(t) = −t + 1
π
 (2N+1)πt
0
sin(s)
s
ds+O

1
2N +1

.
Hence for t ∈(0,−1
2] we have limN→∞(h∗DN)(t) = −t + 1
π
π
2 = 1
2 −t as expected.
Analogously for t ∈[−1
2,0) we have limN→∞(h ∗DN)(t) = −1
2 −t. Also for t = 0,
limN→∞(h∗DN)(0) = 0. Thus the Fourier series of h at zero converges to the “fair”
value of the average of h(0+) and h(0−) which happens to be h(0) = 0.
To quantitatively estimate the nonuniformity of the convergence of (h ∗DN)(t)
we note that
(h∗DN)(t)−( 1
2 −t) = 1
π
 (2N+1)πt
0
sin(s)
s
ds−1
2 +O

1
2N +1

.
Thus for all N = 1,2,... and t ∈(0, 1
2] we have
(h∗DN)(t)−h(t) ≤Si(π)
π
−1
2 + 1
π
1
2N +1 ≤.08949···+
π−1
2N +1 .
Also, for any sequence tN →0+ we have
limsup
N→∞

(h∗DN)(tN)−h(tN)

≤Si(π)
π
−1
2 = .08949...,
(3.5.12)
while if for each N we consider the value tN = 1/(2N +1), we obtain that
limsup
N→∞

(h∗DN)(tN)−h(tN)

= Si(π)
π
−1
2 = .08949....
(3.5.13)
−0.4
−0.2
0.2
0.4
−0.6
−0.4
−0.2
0.2
0.4
0.6
Fig. 3.3 The partial sums (h∗D40)(t) showing the overshoot of approximately 9% of the jump of
h at zero.

224
3 Fourier Series
The quantity .08949... is called the overshoot of the partial sums of the Fourier
series of the function h in a neighborhood of zero. See Figure 3.3.
We now examine the preceding phenomenon in the setting of functions of
bounded variation. These functions can be written as a differences of two increasing
functions, so they have countable sets of discontinuities. Suppose we are given a
function f ∈L1(T1) of bounded variation, and for the sake of simplicity, let us con-
sider the situation where it has exactly one discontinuity, say at the point t0 ∈T1.
Consider the function h deﬁned in (3.5.11) and deﬁne
f0(t) =

f(t0+)−f(t0−)

h(t −t0)+ f(t0+)+ f(t0−)
2
when t ̸= t0,
f(t0)
when t = t0.
(3.5.14)
Now the function f −f0 is of bounded variation and is also continuous and satisﬁes
( f −f0)(t0) = 0. In view of Corollary 3.5.2, the Fourier series of f −f0 converges
uniformly to f −f0 and so the lack of uniformity of the convergence of the partial
sums of f is due to the presence of f0.
We express these observations as a theorem.
Theorem 3.5.7. (a) Let h be deﬁned in (3.5.11). Then the set of accumulation points
of sets of the form {(h∗DN)(tN)}N∈Z+, where tN ∈[0,1/2], is the interval

0, Si(π)
π

=

0,0.58949...

.
In particular if tN →0 such that NtN →1
2, then
lim
N→∞(h∗DN)(tN) = Si(π)
π
= 0.58949... .
(b) Let f be a function of bounded variation on the circle with a single discontinuity
at the point t0, such that f(t0+)−f(t0−) > 0. Then the set of accumulation points
of sets of the form {( f ∗DN)(tN)}N∈Z+, where tN ∈[t0,t0 +δ], for some δ > 0, is the
interval
/
f(t0+)+ f(t0−)
2
, f(t0+)+ f(t0−)
2
+ Si(π)
π

f(t0+)−f(t0−)
0
.
In particular if tN →t0+ such that N(tN −t0) →1
2, then
lim
N→∞( f ∗DN)(tN) = f(t0+)+ f(t0−)
2
+ Si(π)
π

f(t0+)−f(t0−)

.
Proof. (a) Since h ≥0 on (0, 1
2] and (h ∗DN)(t) →1
2 −t for 0 < t ≤1
2 we have
that all accumulation points of sequences (h∗DN)(tN) are nonnegative. We showed
in (3.5.12) that all accumulation points of sequences (h ∗DN)(tN) −h(tN) are at
most Si(π)
π
−1
2; but h(tN) ≤1
2, when tN ∈[0, 1
2], hence all accumulation points of
sequences (h∗DN)(tN) are at most Si(π)
π
and thus contained in

0, Si(π)
π

. Also, 0 is
attained as the accumulation point of (h∗DN)(0) and the number Si(π)
π
is attained as
the accumulation point of the sequence (h∗DN)(
1
2N+1) as shown in (3.5.13); notice

3.5 A Tauberian theorem and Functions of Bounded Variation
225
that the same assertion is valid for any other sequence tN →0 such that NtN →1
2.
Now, since the functions (h∗DN)(t) are continuous, given any c in

0, Si(π)
π

, there
is a t′
N between 0 and
1
2N+1 such that (h ∗DN)(t′
N) = c for all N; this shows that
the set of accumulation points of sequences of the form {( f ∗DN)(tN)}N∈Z+ is the
interval

0, Si(π)
π

.
(b) To examine the behavior of f ∗DN near the point of a single jump discon-
tinuity t0 of f, we reduce matters to the preceding situation as alluded earlier, by
introducing the function f0 deﬁned in (3.5.14). Then for a sequence tN converging
to t0 from the right we have
( f ∗DN)(tN)
= ( f −f0)∗DN(tN)+

f(t0+)−f(t0−)

(h∗DN)(tN −t0)+ f(t0+)+ f(t0−)
2
=

f(t0+)−f(t0−)
/
(h∗DN)(tN −t0)−h(tN −t0)
0
+

f(t0+)−f(t0−)

h(tN −t0)+( f −f0)∗DN(tN)+ f(t0+)+ f(t0−)
2
.
Applying limsupN→∞and using (3.5.12), we obtain as N →∞
limsup
N→∞
( f ∗DN)(tN) ≤

f(t0+)−f(t0−)
 Si(π)
π
−1
2 + 1
2

+ f(t0+)+ f(t0−)
2
,
where we used the following consequence of Theorem 3.5.4
limsup
N→∞
( f −f0)∗DN(tN) = ( f −f0)(t0) = 0.
This shows that all accumulation points of sequences of the form {( f ∗DN)(tN)}N∈Z+
are at most

f(t0+)−f(t0−)
 Si(π)
π
+ 1
2

f(t0+)+ f(t0−)

. Also, since all accumu-
lation points of sequences (h ∗DN)(tN) are nonnegative, when tN lies to the right
of t0, it follows from the identity f = ( f −f0) + f0 and (3.5.14) that all accumula-
tion points of {( f ∗DN)(tN)}N∈Z+ are at least 1
2

f(t0+) + f(t0−)

. As in part (a)
the intermediate value theorem implies that every point in the interval having the
aforementioned endpoints is also an accumulation point for the sequence at hand. □
Exercises
3.5.1. Let Si(t) be the sine function as deﬁned in (3.5.3).
(a) Prove that | π
2 −Si(t)| ≤2
t .
(b) Show that Si(Nt) →π
2 uniformly in t ∈[δ,∞) for any δ > 0.
3.5.2. Show that the sine integral function has the following expansion
Si(x) =
∞
∑
k=1
(−1)kx2k+1
(2k +1)(2k +1)! .

226
3 Fourier Series
3.5.3. Let L1
1(T1) be the space of all differentiable functions on T1 whose deriva-
tives are integrable. Obtain the inclusions L1
1(T1) ⊆BV(T1) ⊆L∞(T1) as follows:
(a) If f ∈L1
1(T1), then Var( f) ≤∥f ′∥L1.
(b) If f ∈BV(T1), then ∥f∥L∞≤Var( f)+| f(0)|.
3.5.4. (a) Let ak ≥0, sN = ∑N
k=−N ak, and σN =
1
N+1(σ0 +···+σN). Suppose that
σN →L < ∞as N →∞. Prove that sN →L as N →∞.
(b) Apply the preceding result to show that if a complex-valued function h on T1 is
continuous in a neighborhood of 0 and 1h(m) ≥0 for all m ∈Z, then h(0) ≥0 and
∑m∈Z1h(m) = h(0) < ∞; i.e., the partial sums of the Fourier series of h converge at
zero.
3.5.5. Let h ∈L1(T1), t0 ∈T1, and 0 < δ < 1/2.
(a) Show that (h∗DN)(t0) →L as N →∞if and only if
lim
M→∞
 δ
0
h(t0 −t)+h(t0 +t)
2
−L
sin(Mt)
t
dt = 0.
(b) Conclude that if an integrable function h on T1 satisﬁes
 δ
0
|h(t0 −t)+h(t0 +t)−2L|
t
dt < ∞,
then (h∗DN)(t0) →L as N →∞.
(c) In particular, if there are constants C,β > 0 with β < 1 such that for all t with
0 < t < δ we have
|h(t0 −t)+h(t0 +t)−2h(t0)| ≤Ctβ ,
then (h∗DN)(t0) →h(t0) as N →∞.
(d) If h is an odd function, then (h∗DN)(0) →0 as N →∞.
3.5.6. Let f ∈L1(T1) and suppose that (a,b) is an interval in T1. Then we have
lim
N→∞
 b
a ( f ∗DN)(t)dt =
 b
a f(t)dt .

Hint: Use Theorems 3.5.4 and 3.5.5 and the fact that the operator f →f ∗DN is
self-adjoint.

3.6 Lacunary Series and Sidon Sets
Lacunary series provide examples of 1-periodic functions on the line that possess
certain remarkable properties.

3.6 Lacunary Series
227
3.6.1 Deﬁnition and Basic Properties of Lacunary Series
We begin by deﬁning lacunary sequences.
Deﬁnition 3.6.1. A sequence of positive integers Λ = {λk}∞
k=1 is called lacunary if
there exists a constant A > 1 such that λk+1 ≥Aλk for all k ∈Z+.
Examples of lacunary sequences are provided by exponential sequences, such as
λk = 2k,3k,4k,.... Observe that polynomial sequences such as λk = 1 + k2 are not
lacunary. Note that lacunary sequences tend to inﬁnity as k →∞.
An important observation about lacunary sequences is the following: for any
m,k0 ∈Z+ we have
1 ≤|m−λk0| < (1−A−1)λk0 =⇒m /∈Λ .
(3.6.1)
Indeed, to prove this assertion, notice that the closest numbers to λk0 among of the
terms of the sequence {λk}∞
k=1 are λk0+1 and λk0−1 (the latter only if k0 > 1) and
thus if j > k0 we have
|λ j −λk0| ≥λk0+1 −λk0 ≥Aλk0 −λk0 = (A−1)λk0 ≥(1−A−1)λk0 ,
while if j < k0
|λ j −λk0| ≥λk0 −λk0−1 ≥λk0 −1
Aλk0 = (1−A−1)λk0 .
Thus (3.6.1) follows.
We begin with the following result.
Proposition 3.6.2. Let {λk}∞
k=1 be a lacunary sequence and let f be an integrable
function on the circle that is differentiable at a point and has Fourier coefﬁcients
1f(m) =

am
when m = λk ,
0
when m ̸= λk .
(3.6.2)
Then we have
lim
k→+∞
1f(λk)λk = 0.
Proof. Applying translation, we may assume that the point at which f is differen-
tiable is the origin. Replacing f by the 1-periodic function
g(t) = f(t)−f(0)cos(2πt)−f ′(0)sin(2πt)
2π
we may assume that f(0) = f ′(0) = 0. (We have 1g(m) = 1f(m) for |m| ≥2 and thus
the ﬁnal conclusion for f is equivalent to that for g.)

228
3 Fourier Series
Using (3.6.1) and (3.6.2), we obtain that for any m ∈Z we have
1 ≤|m−λk| < (1−A−1)λk =⇒1f(m) = 0.
(3.6.3)
Let [t] denote the integer part of t. Given ε > 0, pick a positive integer k0 such that
if [(1−A−1)λk0] = 2N0, then N−2
0
< ε, and
sup
|x|<N
−1
4
0

f(x)
x
 < ε .
(3.6.4)
The expression in (3.6.4) can be made arbitrarily small, since f is differentiable at
the origin. Now take an integer k with k ≥k0 and set 2N = [min(A−1,1−A−1)λk],
which is of course at least 2N0. Using (3.6.3), we obtain that for any trigonometric
polynomial KN of degree 2N with 2
KN(0) = 1 we have
1f(λk) =

|x|≤1
2
f(x)KN(x)e−2πiλkx dx.
(3.6.5)
We take KN = (FN/∥FN∥L2)2, where FN is the Fej´er kernel. Using (3.1.18), we obtain
ﬁrst the identity
FN
2
L2 =
N
∑
j=−N

1−
| j|
N +1
2
= 1+ 1
3
N(2N +1)
N +1
> N
3
(3.6.6)
and also the estimate
FN(x)2 ≤

1
N +1
1
4x2
2
,
(3.6.7)
which is valid for |x| ≤1/2. In view of (3.6.6) and (3.6.7), we have the estimate
KN(x) ≤3
16
1
N3
1
x4 .
(3.6.8)
We now use (3.6.5) to obtain
λk 1f(λk) = λk

|x|≤1
2
f(x)KN(x)e−2πiλkx dx = I1
k +I2
k +I3
k ,
where
I1
k = λk

|x|≤N−1 f(x)KN(x)e−2πiλkx dx,
I2
k = λk

N−1<|x|≤N−1
4 f(x)KN(x)e−2πiλkx dx,
I3
k = λk

N−1
4 <|x|≤1
2
f(x)KN(x)e−2πiλkx dx.

3.6 Lacunary Series
229
Since ∥KN∥L1 = 1, it follows that
|I1
k | ≤λk
N
sup
|x|<N−1

f(x)
x
 ≤
(2N +1)ε
min(A−1,1−A−1)N ,
which can be made arbitrarily small if ε is small. Also, using (3.6.8), we obtain
|I2
k | ≤3λk
16N3
sup
|x|<N−1
4

f(x)
x


N−1<|x|≤N−1
4
dx
|x|3 ≤3λk
16N
sup
|x|<N−1
4

f(x)
x
,
which, as observed, is bounded by a constant multiple of ε. Finally, using again
(3.6.8), we obtain
|I3
k | ≤
3
16N3 Nλk

N−1
4 <|x|≤1
2
| f(x)|dx ≤
3
16N2
 f

L1 < 3ε
16
f

L1 .
It follows that for all k ≥k0 we have
|λk 1f(λk)| ≤|I1
k |+|I2
k |+|I3
k | ≤C( f)ε
for some ﬁxed constant C( f). This proves the required conclusion.
□
Corollary 3.6.3. (Weierstrass) There exists a continuous function on the circle that
is nowhere differentiable.
Proof. Consider the 1-periodic function
f(t) =
∞
∑
k=0
2−ke2πi3kt .
Since this series converges absolutely and uniformly, f is a continuous function. If f
were differentiable at a point, then by Proposition 3.6.2 we would have that 3k 1f(3k)
tends to zero as k →∞. Since 1f(3k) = 2−k for k ≥0, this is not the case. Therefore, f
is nowhere differentiable. The real and imaginary parts of this function are displayed
in Figure 3.4.
□
3.6.2 Equivalence of Lp Norms of Lacunary Series
We now turn to one of the most important properties of lacunary series, equivalence
of their norms. It is a remarkable result that lacunary Fourier series have comparable
Lp norms for 1 ≤p < ∞. More precisely, we have the following theorem:
Theorem 3.6.4. Let 1 ≤λ1 < λ2 < λ3 < ··· be a lacunary sequence with constant
A > 1. Set Λ = {λk : k ∈Z+}. Then for all 1 ≤p < ∞, there exists a constant Cp(A)
such that for all f ∈L1(T1), with 1f(k) = 0, when k ∈Z\Λ we have

230
3 Fourier Series
-0.4
-0.2
0.2
0.4
-2
-1
1
2
-0.4
-0.2
0.2
0.4
-1
-0.5
0.5
1
Fig. 3.4 The graph of the real and imaginary parts of the function f(t) = ∑∞
k=0 2−ke2πi3kt.
f

Lp(T1) ≤Cp(A)
f

L1(T1) .
(3.6.9)
Moreover, the converse inequality to (3.6.9) is valid, and thus all Lp norms of lacu-
nary Fourier series are equivalent for 1 ≤p < ∞.
Proof. We suppose initially that f ∈L2(T1) and f is nonzero. We deﬁne
fN(x) =
N
∑
j=1
1f(λ j)e2πiλ jx .
(3.6.10)
Given 2 ≤p < ∞, we pick an integer m with 2m > p and we also pick a positive
integer r such that Ar > m. Then we can write fN as a sum of r functions ϕs, s =
1,2,...,r, where each ϕs has Fourier coefﬁcients that vanish except possibly on the
lacunary set
{λkr+s : k ∈Z+ ∪{0}} = {μ1,μ2,μ3,...}.
It is a simple fact that the sequence {μk}k is lacunary with constant Ar. Then we
have
 1
0 |ϕs(x)|2m dx =
∑
1≤j1,..., jm,k1,...,km≤N
μ j1+···+μ jm=μk1+···+μkm
1ϕs(μ j1)··· 1ϕs(μ jm) 1ϕs(μk1)··· 1ϕs(μkm).
We claim that if μ j1 +···+ μ jm = μk1 +···+ μkm, then
max(μ j1,...,μ jm) = max(μk1,...,μkm).
Indeed, if max(μ j1,...,μ jm) > max(μk1,...,μkm), then
max(μ j1,...,μ jm) ≤μk1 +···+ μkm ≤mmax(μk1,...,μkm).
But since
Ar max(μk1,...,μkm) ≤max(μ j1,...,μ jm),

3.6 Lacunary Series
231
it would follow that Ar ≤m, which contradicts our choice of r. Likewise, we elimi-
nate the case max(μ j1,...,μ jm) < max(μk1,...,μkm). We conclude that these num-
bers are equal. We can now continue the same reasoning using induction to conclude
that if μ j1 +···+ μ jm = μk1 +···+ μkm, then
{μk1,...,μkm} = {μ j1,...,μ jm}.
Using this fact in the evaluation of the previous multiple sum, we obtain
 1
0 |ϕs(x)|2m dx =
N
∑
j1=1
···
N
∑
jm=1
| 1ϕs(μ j1)|2 ···| 1ϕs(μ jm)|2 =
ϕs
2
L2
m ,
which implies that ∥ϕs∥L2m = ∥ϕs∥L2 for all s ∈{1,2,...,r}. Then we have
fN

Lp ≤
fN

L2m ≤√r
 r
∑
s=1
ϕs
2
L2m
 1
2 = √r
 r
∑
s=1
ϕs
2
L2
 1
2 = √r
fN

L2 ,
since the functions ϕs are orthogonal in L2. Since r can be chosen to be [logA m]+1
and m can be taken to be [ p
2]+1, we have now established the inequality
fN

Lp(T1) ≤cp(A)
fN

L2(T1) ,
p ≥2,
(3.6.11)
with cp(A) =
!
1+

logA

[ p
2]+1

for every fN of the form (3.6.10).
To replace fN by f in (3.6.11), we recall our assumption that f ∈L2(T1). We
observe that fN →f in L2 and thus fNj tends to f a.e. for some subsequence. Then
Fatou’s lemma and (3.6.11) imply for 1 < p < ∞
 1
0 | f(x)|p dx =
 1
0 liminf
j→∞| fNj(x)|p dx
≤liminf
j→∞
 1
0 | fNj(x)|p dx
≤cp(A)p liminf
j→∞
fNj
p
L2
= cp(A)pf
p
L2 .
We conclude that
f

Lp(T1) ≤cp(A)
f

L2(T1) ,
p ≥2.
(3.6.12)
By interpolation we obtain
 f

L2 ≤
f

2
3
L4
f

1
3
L1 ≤

[logA 3]+1
 1
2 · 2
3 f

2
3
L2
 f

1
3
L1 .

232
3 Fourier Series
We are assuming that 0 < ∥f∥L2 < ∞and the preceding inequality implies that
f

L2(T1) ≤

[logA 3]+1
 f

L1(T1) .
(3.6.13)
Finally an easy consequence of H¨older’s inequality is that
 f

Lp(T1) ≤
f

L2(T1) ,
1 ≤p < 2.
(3.6.14)
Combining (3.6.12) and (3.6.14) with (3.6.13) yields (3.6.9) with
Cp(A) = cp(A)

[logA 3]+1

for all 1 ≤p < ∞under the hypothesis that 1f(k) = 0 for all k ∈Z \ Λ and the
additional assumption that f ∈L2.
We now extend the result to f ∈L1(T1). Given f ∈L1(T1) with 1f(k) = 0 when
k ∈Z\Λ, consider the functions f ∗FM, where FM is the Fej´er kernel and M ∈Z+.
Then f ∗FM lie in L2, f ∗FM converge to f in L1 and in Lp, and 
f ∗FM(k) = 0 when
k ∈Z\Λ. The inequality
f ∗FM

Lp(T1) ≤Cp(A)
f ∗FM

L1(T1)
(3.6.15)
holds since f ∗FM lie in L2, so letting M →∞yields (3.6.9).
□
Theorem 3.6.4 describes the equivalence of the Lp norms of lacunary Fourier
series for p < ∞. The question that remains is whether there is a similar charac-
terization for the L∞norms of lacunary Fourier series. Such a characterization is
investigated below. Before we state and prove this theorem, we need a classical tool,
referred to as a Riesz product.
Deﬁnition 3.6.5. A Riesz product is a function of the form
PN(x) =
N
∏
j=1

1+aj cos(2πλ jx+2πγ j)

,
(3.6.16)
where N is a positive integer, λ1 < λ2 < ··· < λN is a lacunary sequence of positive
integers, aj are real numbers in [−1,1], and γ j ∈[0,1].
We make a few observations about Riesz products. A simple calculation gives
that if PN, j(x) = 1+aj cos(2πλ jx+2πγ j), then
3
PN, j(m) =
⎧
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎩
1
when m = 0,
1
2aje2πiγ j
when m = λ j,
1
2aje−2πiγ j
when m = −λ j,
0
when m /∈{0}∞
j=1{λ j,−λ j}.
(3.6.17)
Assume that the constant A associated with the lacunary sequence λ1<λ2<···<λN
satisﬁes A ≥3. Then each integer m has at most one representation as a sum

3.6 Lacunary Series
233
m = ε1λ1 +···+εNλN ,
where ε j ∈{−1,1,0}; see Exercise 3.6.1. We now calculate the Fourier coefﬁcients
of the Riesz product deﬁned in (3.6.16). For a ﬁxed integer b, let us denote by δb the
sequence of integers that is equal to 1 at b and zero otherwise. Then, using (3.6.17),
we obtain that
3
PN, j = δ0 + 1
2aje2πiγ jδλ j + 1
2aje−2πiγ jδ−λ j ,
and thus 2
PN is the N-fold convolution of these functions. Using that δa ∗δb = δa+b,
we obtain
2
PN(m) =
⎧
⎪
⎨
⎪
⎩
1
when m = 0,
∏N
j=1
1
2aje2πiε jγ j
when m = ∑N
j=1 ε jλ j and ∑N
j=1 |ε j| > 0,
0
otherwise.
It follows that 2
PN(λ j) = 0 since for j ≥N + 1, λ j cannot be expressed as a linear
combination of λ1,...,λN with coefﬁcients in {±1,0}. Also 2
PN(λk) = 1
2aje2πiγk for
1 ≤k ≤N, since each λk is written uniquely as 0·λ1 +···+0·λk−1 +1·λk. Hence
when A ≥3 we have that 2
PN(λk) = 1
2aje2πiγk when 1 ≤k ≤N and 2
PN(λk) = 0 for
k ≥N +1.
Next, we discuss an important property of Riesz products. Suppose that for some
m ∈Z we have 2
PN(m) ̸= 0. We write m = ∑N
j=1 ε jλ j uniquely with ε j ∈{−1,0,1}.
Let k be the largest integer less than or equal to N such that εk ̸= 0. Then we have
|m|−λk
 ≤λ1 +···+λk−1 ≤
λk
Ak−1 +···+ λk
A ≤λk
A
1
1−1
A
=
λk
A−1 .
(3.6.18)
Another important property of the Riesz product is that since PN ≥0 we have
∥PN∥L1 =

T1 PN(t)dt = 2
PN(0) = 1.
We recall the space A(T1) of all functions with absolutely summable Fourier
coefﬁcients normed with the ℓ1 norm of the coefﬁcients.
Theorem 3.6.6. Let 1 < λ1 < λ2 < λ3 < ··· be a lacunary sequence of integers with
constant A > 1. Set Λ = {λk : k ∈Z+}. Then there exists a constant C(A) such that
for all f ∈L∞(T1) with 1f(k) = 0 when k ∈Z\Λ we have
 f

A(T1) = ∑
k∈Λ
| 1f(k)| ≤C(A)
f

L∞(T1) .
(3.6.19)
Proof. Let us assume ﬁrst that A ≥3. Also ﬁx f ∈L∞(T1). We consider the Riesz
product
PN(x) =
N
∏
j=1

1+cos(2πλ jx+2πγ j)

,

234
3 Fourier Series
where γ j is chosen to satisfy the identity | 1f(λ j)| = e2πiγ j 1f(λ j). In view of Parseval’s
relation and of the fact that ∥PN∥L1 = 1 we obtain
 ∑
m∈Z
2
PN(m) 1f(m)
 =

 1
0 PN(x) f(x)dx
 ≤
f

L∞,
(3.6.20)
and the sum in (3.6.20) is ﬁnite, since the Fourier coefﬁcients of 2
PN form a ﬁnitely
supported sequence. But 1f(m) = 0 for m /∈Λ, while 2
PN(λ j) = 1
2e2πiγ j for 1 ≤j ≤N
since A ≥3, and moreover, 2
PN(λ j) = 0 for j ≥N + 1, as observed earlier. Thus
(3.6.20) reduces to
1
2
N
∑
j=1
 1f(λ j)
 =

N
∑
j=1
1
2e2πiγ j 1f(λ j)
 ≤
f

L∞.
Letting N →∞, we deduce that ∑∞
j=1 | 1f(λ j)| ≤2∥f∥L∞, which proves (3.6.19) when
A ≥3.
We now consider the case A < 3. We ﬁx 1 < A < 3 and we pick a positive integer
r such that
Ar > 3
and
1
Ar −1 < 1−1
A .
(3.6.21)
This is possible, since (Ar −1)−1 →0 as r →∞.
For each s ∈{1,...,r}, deﬁne the sequences λ s
k = λs+(k−1)r indexed by k =
1,2,3,... and observe that λ s
(k+1) > Arλ s
k for all k = 1,2,...; i.e., each such se-
quence is lacunary with constant Ar. We consider the Riesz product
Ps
N(x) =
N
∏
k=1

1+cos(2πλ s
k x+2πγs
k)

,
where γs
k is deﬁned via the identity | 1f(λ s
k)| = e2πiγs
k 1f(λ s
k).
Using (3.6.18) we obtain that, if m ∈Z is such that 2
Ps
N(m) ̸= 0, then there exists
a k ∈{1,2 ...,N} such that
|m|−λ s
k
 <
λ s
k
Ar −1 .
This combined with (3.6.21) yields
|m|−λ s
k
 <

1−1
A

λ s
k .
Using (3.6.1) we obtain that either m = ±λ s
k or |m| /∈Λ. Thus we have
{m ∈Z+ : 2
Ps
N(m) ̸= 0} ⫅{λ s
1,λ s
2,...,λ s
N}∪Λ c .

3.6 Lacunary Series
235
This observation, the fact that 1f is supported in Λ, and Parseval’s relation yield

N
∑
k=1
2
Ps
N(λ s
k) 1f(λ s
k)
 =
 ∑
m∈Z
2
Ps
N(m) 1f(m)
 =

 1
0 Ps
N(x) f(x)dx
 ≤
f

L∞. (3.6.22)
Since 2
PN(λ s
k) = 1
2e2πiγs
k for 1 ≤k ≤N, (3.6.22) reduces to
1
2
N
∑
k=1
 1f(λ s
k)
 ≤
f

L∞.
Letting N →∞gives
∞
∑
j=1
 1f(λ s
j)
 ≤2
f

L∞.
Summing over s in the set {1,2,...,r}, we obtain the required conclusion with
C(A) = 2r and note that r can be taken to be [max(logA
2A−1
A−1 ,log3 A)]+2.
□
Corollary 3.6.7. Let Λ = {λk : k ∈Z+} be a lacunary set and let f be a bounded
function on the circle that satisﬁes 1f(k) = 0 when k ∈Z \Λ. Then f is almost ev-
erywhere equal to the absolutely (and uniformly) convergent series
f(x) = ∑
k∈Λ
1f(k)e2πikx
a.e.
(3.6.23)
and thus it is almost everywhere equal to a continuous function.
Proof. It follows from Theorem 3.6.6 that if 1f(k) = 0 when k ∈Z\Λ, then we have
that f ∈A(T1). Applying the inversion result in Proposition 3.2.5 we obtain that f is
almost everywhere equal to a continuous function and that (3.6.23) holds for almost
all x ∈T1.
□
3.6.3 Sidon sets
Given a subset E of the integers, we denote by CE the space of all continuous func-
tions on T1 such that
m ∈Z\E =⇒1f(m) = 0.
(3.6.24)
It is straightforward that CE is a closed subspace of all bounded functions on the
circle T1 with the standard L∞norm.
Deﬁnition 3.6.8. A set of integers E is called a Sidon set if every function in CE has
an absolutely convergent Fourier series.
There are several characterizations of Sidon sets. We state them below.
Proposition 3.6.9. The following assertions are equivalent for a subset E of Z.

236
3 Fourier Series
(1) There is a constant K such that for all trigonometric polynomials P with 1P
supported in E we have
∑
m∈Z
|1P(m)| ≤K
P

L∞
(2) There exists a constant K such that
 1f

ℓ1(Z) ≤K
 f

L∞(T1)
for every bounded function f on T1 with 1f supported in E.
(3) Every function f in CE has an absolutely convergent Fourier series; i.e., E is a
Sidon set.
(4) For every bounded function b on E there is a ﬁnite Borel measure μ on T1 such
that 1μ(m) = b(m) for all m ∈E.
(5) For every function b on Z with the property b(m) →0 as m →∞, there is a
function g ∈L1(T1) such that 1g(m) = b(m) for all m ∈E.
Proof. Suppose that (1) holds. Given f in L∞(T1) with 1f is supported in E, write
( f ∗FN)(x) =
N
∑
m=−N

1−|m|
N +1

1f(m)e2πimx ,
where FN is the Fej´er kernel. These are trigonometric polynomials whose Fourier
coefﬁcients vanish on Z\E. Applying (1) we obtain
∑
k∈Z

1−|m|
N +1

| 1f(m)| ≤K
f ∗FN

L∞.
Letting N →∞we obtain (2).
It is trivial that (2) implies (3).
If (3) holds, then the map f →1f is a linear bijection from CE to ℓ1(E). Moreover
its inverse mapping 1f →f is continuous, since
 f

L∞(T1) ≤sup
t∈[0,1]
 ∑
k∈Z
1f(k)e2πikt ≤∑
k∈Z
| 1f(k)| =
 1f

ℓ1(Z) .
By the open mapping theorem, it follows that f →1f is a continuous mapping, which
proves the existence of a constant K such that (1) holds.
We have now proved the equivalence of (1), (2), and (3).
We show that (2) implies (4). If E is a Sidon set and if b is a bounded function
on E, say ∥b∥ℓ∞≤1, then the mapping
f →∑
m∈E
1f(m)1b(m)

3.6 Lacunary Series
237
is a bounded linear functional on CE with norm at most K. By the Hanh-Banach
theorem this functional admits an extension to C (T1) with the same norm. Hence
there is a measure μ, whose total variation ∥μ∥does not exceed K, such that
∑
m∈E
1f(m)1b(m) =

T1 f(t)dμ(t).
Taking f(t) = e2πimt in (2) we obtain 1μ(m) = b(m) for all m ∈E.
If (4) holds and b(m) →0 as |m| →∞, using Lemma 3.3.2 there is a con-
vex sequence c(m) such that c(m) > 0, c(m) →0 as |m| →∞, c(−m) = c(m),
and |b(m)| ≤c(m) for all m ∈Z. By (4), there is a ﬁnite Borel measure μ with
1μ(m) = b(m)/c(m) for all m ∈E.
By Theorem 3.3.4, there is a function g in L1(T1) such that 1g(m) = c(m) for all
m ∈Z. Then b(m) = 1g(m)1μ(m) for all m ∈E. Since f = g ∗μ is in L1, we have
b(m) = 1f(m) for all m ∈E, and thus (4) implies (5).
Finally, if (5) holds, we show (3). Given f ∈CE, we show that for an arbi-
trary sequence dm tending to zero, we have ∑m∈Z | 1f(m)dm| < ∞; this implies that
∑m∈Z | 1f(m)| < ∞. Given a sequence dm →0, pick a function g in L1 such that
1g(m) 1f(m) = | 1f(m)||dm| for all m ∈E by assumption (5). Then the series
∑
m∈Z
1g(m) 1f(m) = ∑
m∈Z
3
f ∗g(m)
(3.6.25)
has nonnegative terms and the function f ∗g is continuous, thus FN ∗( f ∗g)(0) →
( f ∗g)(0) as N →∞. It follows that DN ∗( f ∗g)(0) →( f ∗g)(0), thus the series in
(3.6.25) converges (see Exercise 3.5.4) and hence ∑m∈Z | 1f(m)dm| < ∞.
□
Example 3.6.10. Every lacunary set is a Sidon set. Indeed, suppose that E is a lacu-
nary set with constant A. If f is a continuous function which satisﬁes (3.6.24), then
Theorem 3.6.6 gives that
∑
m∈Λ
| 1f(m)| ≤C(A)
f

L∞< ∞;
hence f has an absolutely convergent Fourier series.
Example 3.6.11. There exist subsets of Z that are not Sidon. For example, Z \ {0}
is not a Sidon set. See Exercise 3.6.7.
Exercises
3.6.1. Suppose that 0 < λ1 < λ2 < ··· < λN is a lacunary sequence of integers
with constant A ≥3. Prove that for every integer m there exists at most one N-tuple
(ε1,...,εN) with each ε j ∈{−1,1,0} such that
m = ε1λ1 +···+εNλN .

238
3 Fourier Series

Hint: Suppose there exist two such N-tuples. Pick the largest k such that the coefﬁ-
cients of λk are different.

3.6.2. Is the sequence λk =

e(logk)2
, k = 2,3,4,... lacunary?
3.6.3. Let ak ≥0 for all k ∈Z+ and 1 ≤p < ∞. Show that there exist constants
Cp,cp such that for all N ∈Z+ we have
cp
 N
∑
k=1
|ak|2 1
2 ≤
 1
0

N
∑
k=1
ake2πi2kx
p
dx
 1
p
≤Cp
 N
∑
k=1
|ak|2 1
2 ,
while
sup
x∈[0,1]

N
∑
k=1
ake2πi2kx =
N
∑
k=1
|ak|.
3.6.4. Suppose that 0 < λ1 < λ2 < ··· is a lacunary sequence and let f be a bounded
function on the circle that satisﬁes 1f(m) = 0 whenever m ∈Z\{λ1,λ2,...}. Suppose
also that
sup
t̸=0
| f(t)−f(0)|
|t|α
= B < ∞
for some 0 < α < 1.
(a) Prove that there is a constant C such that | 1f(λk)| ≤CBλ −α
k
for all k ≥1.
(b) Prove that f ∈.
Λα(T1).

Hint: Let 2N = [(1 −A−1)λk] and let KN be as in the proof of Proposition 3.6.2.
Write
1f(λk) =

|x|≤N−1( f(x)−f(0))e−2πiλkxKN(x)dx
+

N−1≤|x|≤1
2
( f(x)−f(0))e−2πiλkxKN(x)dx .
Use that ∥KN∥L1 = 1 and also the estimate (3.6.7). Part (b): Use the estimate in
part (a).

3.6.5. Let f be an integrable function on the circle whose Fourier coefﬁcients van-
ish outside a lacunary set Λ = {λ1,λ2,λ3,...}. Suppose that f vanishes identically
in a small neighborhood of the origin. Show that f is in C ∞(T1).

Hint: Let 2N = [(1 −A−1)λk] and let KN be as in the proof of Proposition 3.6.2.
Write
1f(λk) =

|x|≤1
2
f(x)e−2πiλkxKN(x)dx
and use estimate (3.6.7) to obtain that f is in C 2. Continue by induction.

3.6.6. Let 1 < a,b < ∞. Consider the 1-periodic function
f(x) =
∞
∑
k=0
a−ke2πibkx .

3.6 Lacunary Series
239
Prove that the following statements are equivalent:
(a) f is differentiable at a point.
(b) b < a.
(c) f is differentiable everywhere.
3.6.7. Use the example in Proposition 3.4.6 (a) to show that Z\{q1,...,qL} is not
a Sidon set for any ﬁnite subset {q1,...,qL} of the integers.
3.6.8. Let 0 < δ < 1. Let E be a subset of the integers such that for any sequence
of complex numbers {dm}m∈E with |dm| = 1 there is a ﬁnite Borel measure μ on T1
such that
|1μ(m)−dm| < 1−δ
for all m ∈E. Show that E is a Sidon set.

Hint: Given f be in CE deﬁne dm via the identity dm 1f(m) = | 1f(m)| if 1f(m) ̸=
0, otherwise set dm = 1. For the measure μ given by the hypothesis, notice that
Re(1μ(m) 1f(m)) ≥δ| 1f(m)| for all m ∈Z.

HISTORICAL NOTES
Trigonometric series in one dimension were ﬁrst considered in the study of the vibrating string
problem and are implicitly contained in the work of d’Alembert, D. Bernoulli, Clairaut, and Euler.
The analogous problem for vibrating higher-dimensional bodies naturally suggested the use of mul-
tiple trigonometric series. However, it was the work of Fourier on steady-state heat conduction that
inspired the subsequent systematic development of such series. Fourier announced his results in
1811, although his classical book Th´eorie de la chaleur was published in 1822. This book contains
several examples of heuristic use of trigonometric expansions and motivated other mathematicians
to carefully study such expansions. The systematic development of the theory of Fourier series
began by Dirichlet [96], who studied the pointwise convergence of the Fourier series of piecewise
monotonic functions via the use of the kernel DN, today called the Dirichlet kernel.
The fact that the Fourier series of a continuous function can diverge was ﬁrst observed by
DuBois Reymond in 1873. The Riemann–Lebesgue lemma was ﬁrst proved by Riemann in his
memoir on trigonometric series (appeared between 1850 and 1860). It carries Lebesgue’s name
today because Lebesgue later extended it to his notion of integral. The rebuilding of the theory
of Fourier series based on Lebesgue’s integral was mainly achieved by de la Vall´ee-Poussin and
Fatou.
Theorem 3.3.16 was obtained by Bernstein [26] in dimension n = 1. Higher-dimensional ana-
logues of the Hardy–Littlewood series of Exercise 3.3.8 were studied by Wainger [370]. These
series can be used to produce examples indicating that the restriction s > α + n/2 in Bernstein’s
theorem is sharp even in higher dimensions. Part (b) of Theorem 3.4.4 is due to Lebesgue when
n = 1 and Marcinkiewicz and Zygmund [243] when n = 2. Marcinkiewicz and Zygmund’s proof
also extends to higher dimensions. The proof given here is based on Lemma 3.4.5 proved by Stein
[342] in a different context. The proof of Lemma 3.4.5 presented here was suggested by T. Tao.
Abel proved that if an inﬁnite series ∑∞
k=0 ak converges and has sum L, then the power series
f(x) = ∑∞
k=0 akxk converges for |x| < 1 and tends to L as x →1−. The converse of this theorem
under the additional assumption that kak →0 as k →∞was proved by Tauber [358]. Hardy [143]
extended Tauber’s result (Theorem 3.5.1) for Ces`aro summability under the weaker assumption that
the sequence kak is bounded. Jordan [180] studied of functions of bounded variation and proved
Theorem 3.5.4. The existence of a continuous function which is nowhere differentiable (Corollary
3.6.3) was ﬁrst published in 1872 by K. Weierstrass, although earlier ﬁndings of such functions
were published later. The exposition on Sidon sets is taken from the classical article of Rudin
[305], which also contains Exercise 3.6.8.

240
3 Fourier Series
The Gibbs phenomenon (a version of Theorem 3.5.7) was discovered by Wilbraham [376] and
rediscovered by Gibbs [128]; this phenomenon describes the particular way in which the Fourier
sums of a piecewise continuously differentiable periodic function have large oscillations and over-
shoot at the jump discontinuity of the function. Bˆocher [29] gave a detailed mathematical analysis
of that overshoot, which he called the “Gibbs phenomenon”.
The main references for trigonometric series are the books of Bary [20] and Zygmund [388],
[389]. Other references for one-dimensional Fourier series include the books of Edwards [106],
Dym and McKean [105], Katznelson [190], K¨orner [202], Pinsky [283], and the ﬁrst eight chapters
in Torchinsky [363]. The reader may also consult the book of Krantz [203] for a historical intro-
duction to the subject of Fourier series. A review of the heritage and continuing signiﬁcance of
Fourier Analysis is written by Kahane [182].
A classical treatment of multiple Fourier series can be found in the last chapter of Bochner’s
book [32] and in parts of his other book [31]. Other references include the last chapter in Zygmund
[389], the books of Yanushauskas [381] (in Russian) and Zhizhiashvili [384], the last chapter in
Stein and Weiss [348], and the article of Alimov, Ashurov, and Pulatov in [3]. A brief survey article
on the subject was written by Ash [11]. More extensive expositions were written by Shapiro [320],
Igari [171], and Zhizhiashvili [383]. A short note on the history of Fourier series was written by
Zygmund [390]. The book of Shapiro [321] contains a very detailed study of Fourier series in
several variables as well as applications of this theory.

Chapter 4
Topics on Fourier Series
In this chapter we go deeper into the theory of Fourier series and we study topics
such as convergence in norm and the conjugate function, divergence of Fourier se-
ries and Bochner–Riesz summability. We also study transference of multipliers on
the torus and of maximal multipliers. This is a powerful technique that allows one
to infer results concerning Fourier series from corresponding results about Fourier
integrals and vice versa.
We also take a quick look at applications of Fourier series such as the isoperti-
metric inequality problem, the distribution of lattice points in a ball, and the heat
equation. The power of Fourier series techniques manifests itself in the study of
these problems which represent only a small part of the wide and vast range of ap-
plications of the subject known today.
4.1 Convergence in Norm, Conjugate Function,
and Bochner–Riesz Means
In this section we address the following fundamental question: Do Fourier series
converge in norm? We begin with some abstract necessary and sufﬁcient conditions
that guarantee such a convergence. In one dimension, we are able to reduce matters
to the study of the so-called conjugate function on the circle, a sister operator of
the Hilbert transform, which is the center of study of the next chapter. In higher
dimensions the situation is more complicated, but we are able to give a positive
answer in the case of square summability.
L. Grafakos, Classical Fourier Analysis, Graduate Texts in Mathematics 249,
DOI 10.1007/978-1-4939-1194-3 4, © Springer Science+Business Media New York 2014
241

242
4 Topics on Fourier Series
4.1.1 Equivalent Formulations of Convergence in Norm
The question we pose is for which indices p, with 1 ≤p < ∞, we have
Dn
N ∗f −f

Lp(Tn) →0
as N →∞,
(4.1.1)
and similarly for the circular Dirichlet kernel
◦Dn
N. We tackle this question by looking
at an equivalent formulation of it.
Theorem 4.1.1. For R > 0 and m ∈Zn, let a(m,R) be complex numbers such that
(i) For every R > 0 there is a qR such that a(m,R) = 0 if |m| > qR.
(ii) There is an M0 < ∞such that |a(m,R)| ≤M0 for all m ∈Zn and all R > 0.
(iii) For each m ∈Zn, the limit of a(m,R) exists as R →∞and limR→∞a(m,R) = am.
Let 1 ≤p < ∞. For f ∈Lp(Tn) and x ∈Tn deﬁne
SR( f)(x) = ∑
m∈Zn
a(m,R) 1f(m)e2πim·x
noting that the sum is well deﬁned because of (i). Also, for h ∈C ∞(Tn) deﬁne
A(h)(x) = ∑
m∈Zn
am1h(m)e2πim·x.
Then for all f ∈Lp(Tn) the sequence SR( f) converges in Lp as R →∞if and only if
there exists a constant K < ∞such that
sup
R>0
SR

Lp→Lp ≤K.
(4.1.2)
Furthermore, if (4.1.2) holds, then for the same constant K we have
sup
h∈C ∞
h̸=0
A(h)

Lp
h

Lp
≤K ,
(4.1.3)
and then A extends to a bounded operator #A from Lp(Tn) to itself; moreover, for
every f ∈Lp(Tn) we have that SR( f) →#A( f) in Lp as R →∞.
Proof. If SR( f) converges in Lp, then ∥SR( f)∥Lp ≤Cf for some constant Cf that
depends on f ∈Lp(Tn). Moreover, each SR is a bounded operator from Lp(Tn) to
itself with norm at most #{m ∈Zn : |m| ≤qR}M0. Thus {SR}R>0 is a family of Lp-
bounded linear operators that satisfy supR>0 ∥SR( f)∥Lp ≤Cf for each f ∈Lp(Tn).
The uniform boundedness theorem applies and yields that the operator norms of SR
from Lp to Lp are bounded uniformly in R. This proves (4.1.2).
Conversely, assume (4.1.2). For h ∈C ∞(Tn), we have that
lim
R→∞∑
m∈Zn
a(m,R)1h(m)e2πim·x = ∑
m∈Zn
am1h(m)e2πim·x

4.1 Convergence in Norm, Conjugate Function, and Bochner–Riesz Means
243
in view of property (ii) and of the Lebesgue dominated convergence theorem, since
∑m∈Zn |1h(m)| < ∞. Fatou’s lemma now gives
A(h)

Lp =
 lim
R→∞SR(h)

Lp ≤liminf
R→∞
SR(h)

Lp ≤K
h

Lp ;
hence (4.1.3) holds. Thus A extends to a bounded operator #A on Lp(Tn) by density.
We show that for all f ∈Lp(Tn) we have SR( f) →#A( f) in Lp as R →∞. Fix
f in Lp(Tn) and let ε > 0 be given. Pick a trigonometric polynomial P satisfying
∥f −P∥Lp ≤ε. Let d be the degree of P. Then there is an R0 > 0 such that for all
R > R0 we have
∑
|m1|+···+|mn|≤d
|a(m,R)−am||1P(m)| ≤ε
since a(m,R) →am for every m with |m1|+···+|mn| ≤d. We deduce that
SR(P)−A(P)

Lp ≤
SR(P)−A(P)

L∞
≤
∑
|m1|+···+|mn|≤d
|a(m,R)−am||1P(m)|
≤ε ,
whenever R > R0. Then
SR( f)−#A( f)

Lp ≤
SR( f)−SR(P)

Lp +
SR(P)−#A(P)

Lp +
#A(P)−#A( f)

Lp
≤Kε +ε +Kε = (2K +1)ε
for R > R0. This proves that SR( f) converges to #A( f) in Lp as R →∞.
□
The most interesting situation arises, of course, when a(m,R) →am = 1 for all
m ∈Zn. In this case A (and #A) is the identity operator, and thus we expect the oper-
ators SR( f) to converge back to f as R →∞. We should keep in mind the following
three examples:
(a) The sequence a(m,R) = 1 when |mj| ≤R for all j ∈{1,2,...,n} and zero other-
wise, in which case the operator SR of Theorem 4.1.1 is
SR( f) = f ∗Dn
R ;
(4.1.4)
(b) The sequence a(m,R) = 1 when |m| ≤R and zero otherwise, in which case the
SR of Theorem 4.1.1 is
◦SR( f) = f ∗
◦Dn
R ;
(4.1.5)
(c) The sequence a(m,R) =

1 −|m|2
R2
α
+, for some α > 0, in which case we denote
SR by Bα
R.

244
4 Topics on Fourier Series
Deﬁnition 4.1.2. The Bochner–Riesz operator or Bochner–Riesz means of order
α ≥0 is the operator
Bα
R( f)(x) = ∑
m∈Zn
|m|≤R

1−|m|2
R2
α 1f(m)e2πim·x
(4.1.6)
deﬁned on integrable functions f on Tn.
Corollary 4.1.3. Let 1 ≤p < ∞and α ≥0. Let SR and
◦SR be as in (4.1.4) and (4.1.5),
respectively, and let Bα
R be the Bochner–Riesz means as deﬁned in (4.1.6). Then
∀f ∈Lp(Tn), lim
R→∞
Dn
R ∗f −f

Lp = 0
⇐⇒
sup
R≥0
SR

Lp→Lp < ∞,
∀f ∈Lp(Tn), lim
R→∞
 ◦Dn
R ∗f −f

Lp = 0
⇐⇒
sup
R≥0
 ◦SR

Lp→Lp < ∞,
∀f ∈Lp(Tn), lim
R→∞
Bα
R ∗f −f

Lp = 0
⇐⇒
sup
R≥0
Bα
R

Lp→Lp < ∞.
Example 4.1.4. We investigate the one-dimensional case in some detail. We take
n = 1, and we deﬁne a(m,N) = 1 for all −N ≤m ≤N, and zero otherwise. Then
SN( f) =
◦SN( f) = DN ∗f, where DN is the Dirichlet kernel. Clearly, the expressions
∥SN∥Lp→Lp are bounded above by the L1 norm of DN, but this estimation yields a
bound that blows up as N →∞. We later show, via a more delicate argument, that
the expressions ∥SN∥Lp→Lp are uniformly bounded in N when 1 < p < ∞.
This reasoning, however, allows us to deduce that for some function g ∈L1(T1),
SN(g) may not converge in L1. This is also a consequence of the proof of Theorem
4.2.1; see (4.2.13). Note that since the Fej´er kernel FM has L1 norm 1, we have
SN

L1→L1 ≥lim
M→∞
DN ∗FM

L1 =
DN

L1 .
This implies that the expressions ∥SN∥L1→L1 are not uniformly bounded in N, and
therefore Corollary 4.1.3 gives that for some f0 ∈L1(T1), SN( f0) does not converge
to f0 in L1.
Although the partial sums of Fourier series fail to convergence in L1(Tn), it is a
consequence of Plancherel’s theorem that they converge in L2(Tn). More precisely,
if f ∈L2(Tn), then
 ◦Dn
N ∗f −f
2
L2 = ∑
|m|>N
| 1f(m)|2 →0
as N →∞and the same result is true for Dn
N ∗f and for Bα
R ∗f; for the latter, we
apply Theorem 4.1.1, noting that
Bα
R( f)
2
L2 = ∑
m∈Zn


1−|m|2
R2
α
+

2
| 1f(m)|2 ≤∑
m∈Zn
| 1f(m)|2 =
f
2
L2
and thus supR>0 ∥Bα
R∥L2→L2 ≤1.

4.1 Convergence in Norm, Conjugate Function, and Bochner–Riesz Means
245
Motivated by the preceding discussion for p = 2, it is natural to pose the follow-
ing question. Can 2 be replaced by p ̸= 2 in the preceding results? This question has
an afﬁrmative answer in dimension one for DN. In higher dimensions an interesting
dichotomy appears. As a consequence of the one-dimensional result, the square par-
tial sums Dn
N ∗f converge in Lp to a given f in Lp(Tn), but for the circular partial
sums this may not be the case.
We begin the discussion with the one-dimensional situation.
Deﬁnition 4.1.5. For f ∈C ∞(T1) deﬁne the conjugate function #f by
#f(x) = −i ∑
m∈Z1
sgn(m) 1f(m)e2πimx,
where sgn(m) = 1 for m > 0, −1 for m < 0, and 0 for m = 0. Also deﬁne the Riesz
projections P+ and P−by
P+( f)(x) =
∞
∑
m=1
1f(m)e2πimx ,
(4.1.7)
P−( f)(x) =
−1
∑
m=−∞
1f(m)e2πimx .
(4.1.8)
Observe that f = P+( f) + P−( f) + 1f(0), while #f = −iP+( f) + iP−( f), when f
is in C ∞(T1). Consequently, one has
P+( f) = 1
2( f +i #f )−1
2
1f(0)
(4.1.9)
and therefore the Lp boundedness of the operator f →#f is equivalent to that of the
operator f →P+( f), since the identity and the operator f →1f(0) are obviously
Lp bounded. Clearly, these statements are also valid for the other Riesz projection
f →P−( f). The following is a consequence of Theorem 4.1.1.
Proposition 4.1.6. Let 1 ≤p < ∞. Then the expressions SN( f) = DN ∗f converge to
f in Lp(T1) as N →∞if and only if there exists a constant Cp > 0 such that for all
smooth functions f on Tn we have ∥#f ∥Lp(T1) ≤Cp∥f∥Lp(T1).
Proof. In view of Corollary 4.1.3, the fact that for all f ∈Lp(T1), SN( f) →f in Lp
as N →∞is equivalent to the uniform (in N) Lp boundedness of SN.
We note the validity of the identity
e−2πiNx
2N
∑
m=0

f(·)e2πiN(·)1(m)e2πimx =
N
∑
m=−N
1f(m)e2πimx .
Since multiplication by exponentials does not affect Lp norms, this identity implies
that the norm of the operator SN( f) = DN ∗f from Lp to Lp is equal to that of the
operator

246
4 Topics on Fourier Series
S′
N(g)(x) =
2N
∑
m=0
1g(m)e2πimx
from Lp to Lp. Therefore,
sup
N≥0
SN

Lp→Lp < ∞⇐⇒sup
N≥0
S′
N

Lp→Lp < ∞,
(4.1.10)
and both of these statements are equivalent to the fact that for all f ∈Lp(T1),
SN( f) →f in Lp as N →∞.
We have already observed that the Lp boundedness of the conjugate function is
equivalent to that of P+. Therefore, it sufﬁces to show that the Lp boundedness of
P+ is equivalent to the uniform Lp boundedness of S′
N.
Suppose ﬁrst that supN≥0 ∥S′
N∥Lp→Lp < ∞. Theorem 4.1.1 applied to the sequence
a(m,R) = 1 for 0 ≤m ≤R and a(m,R) = 0 otherwise gives that the operator A( f) =
P+( f)+ 1f(0) is bounded on Lp(T1). Hence so is P+.
Conversely, suppose that P+ extends to a bounded operator from Lp(T1) to itself.
For all h in C ∞(Tn) we can write
S′
N(h)(x) =
∞
∑
m=0
1h(m)e2πimx −
∞
∑
m=2N+1
1h(m)e2πimx
=
∞
∑
m=1
1h(m)e2πimx +1h(0)−e2πi(2N)x
∞
∑
m=1
1h(m+2N)e2πimx
= P+(h)(x)−e2πi(2N)xP+(e−2πi(2N)(·)h)+1h(0).
This identity implies that
sup
N≥0
S′
N( f)

Lp ≤

2
P+

Lp→Lp +1
 f

Lp
(4.1.11)
for all f smooth, and by density for all f ∈Lp(T1). Note that S′
N is well deﬁned on
Lp(T1). Thus the operators S′
N are uniformly bounded on Lp(Tn).
Thus the uniform Lp boundedness of SN is equivalent to the uniform Lp bound-
edness of S′
N, which is equivalent to the Lp boundedness of P+, which in turn is
equivalent to the Lp boundedness of the conjugate function.
□
4.1.2 The Lp Boundedness of the Conjugate Function
We know now that convergence of Fourier series in Lp is equivalent to the Lp bound-
edness of the conjugate function or either of the two Riesz projections. It is natural
to ask whether these operators are Lp bounded.

4.1 Convergence in Norm, Conjugate Function, and Bochner–Riesz Means
247
Theorem 4.1.7. Given 1 < p < ∞, there is a constant Ap > 0 such that for all f in
C ∞(T1) we have
 #f

Lp ≤Ap
f

Lp.
(4.1.12)
Thus the operator f →#f has a bounded extension on Lp(T1) that also satisﬁes
(4.1.12).
Consequently, the Fourier series of Lp functions on the circle converge back to
the functions in the Lp norm for 1 < p < ∞.
Proof. In proving the inequality (4.1.12), we make the following reductions:
(a) We assume that f is trigonometric polynomial.
(b) We assume that 1f(0) = 0.
(c) We assume that f is real valued.
Since f is a real-valued function, we have that 1f(−m) = 1f(m) for all m, and since
1f(0) = 0, we can write
#f(t) = −i
∞
∑
m=1
1f(m)e2πimt +i
∞
∑
m=1
1f(−m)e−2πimt = 2Re

−i
∞
∑
m=1
1f(m)e2πimt

,
which implies that #f is also real-valued (see also Exercise 4.1.4(b)). Therefore the
polynomial f +i #f contains only positive frequencies. Thus for k ∈Z+ we have

T1( f(t)+i #f(t))2k dt = 0.
Expanding the 2k power and taking real parts, we obtain
k
∑
j=0
(−1)k−j
2k
2j

T1
#f(t)2k−2 j f(t)2 j dt = 0,
where we used that f is real-valued. Therefore,
 #f
2k
L2k ≤
k
∑
j=1
2k
2j

T1
#f(t)2k−2 j f(t)2 j dt
≤
k
∑
j=1
2k
2j
 #f
2k−2 j
L2k
 f
2 j
L2k ,
by applying H¨older’s inequality with exponents 2k/(2k−2j) and 2k/(2j) to the jth
term of the sum. Dividing the last inequality by ∥f∥2k
L2k, we obtain
R2k ≤
k
∑
j=1
2k
2j

R2k−2 j,
(4.1.13)

248
4 Topics on Fourier Series
where R = ∥#f ∥L2k/∥f∥L2k. If R > 0 satisﬁes (4.1.13), then R ≤C2k, where C2k is the
largest real root of the polynomial g(t) = t2k −∑k
j=1
2k
2 j

t2k−2 j. (Since g(0) < 0 and
limt→∞g(t) = ∞, g has at least one real root.) We conclude that if f satisﬁes (a), (b),
and (c), then we have for all k = 1,2,...
 #f

L2k ≤C2k
f

L2k .
(4.1.14)
We now remove assumptions (a), (b), and (c). We ﬁrst remove assumption (c).
Given a complex-valued trigonometric polynomial f with 1f(0) = 0, we write
f(t) =
N
∑
j=−N
cje2πi jt =

N
∑
j=−N
cj +c−j
2
e2πi jt

+i

N
∑
j=−N
cj −c−j
2i
e2πi jt

(with c0 = 0) and we note that the expressions inside the square brackets are real-
valued trigonometric polynomials. Thus we can express f as P + iQ, where P and
Q are real-valued trigonometric polynomials, and applying (4.1.14) to P and Q we
obtain the inequality
 #f

L2k ≤2C2k
f

L2k
(4.1.15)
for all trigonometric polynomials f with 1f(0) = 0.
Next, we remove the assumption that 1f(0) = 0. We write f = ( f −1f(0))+ 1f(0),
we observe that the conjugate function of a constant is zero, and we apply (4.1.15)
to obtain
 #f

L2k ≤2C2k
f −1f(0)

L2k ≤2C2k
/f

L2k +∥f∥L1
0
≤4C2k
 f

L2k .
Since trigonometric polynomials are dense in Lp, it follows that the operator f →#f
has a bounded extension on L2k that satisﬁes (4.1.12) for all f ∈L2k, and in particular
for all f ∈C ∞(T1).
Every real number p ≥2 lies in an interval of the form [2k,2k + 2], for some
k ∈Z+. Theorem 1.3.4 gives that for all 2 ≤p < ∞there is a constant Ap such that
 #f

Lp ≤Ap
 f

Lp
(4.1.16)
when f is a simple function. Thus the conjugate function has a bounded extension
on Lp that satisﬁes (4.1.16) when p ≥2.
To extend this result for p < 2 we use duality. We observe that the adjoint operator
of f →#f is f →−#f. Indeed, for f,g in C ∞(T1) we have
⟨#f |g⟩= ∑
m∈Z
−isgn(m) 1f(m)1g(m) = −∑
m∈Z
1f(m)−isgn(m)1g(m) = −⟨f | #g⟩.
By duality, estimate (4.1.16) is also valid for 1 < p ≤2 with constant Ap′ = Ap.
□
We extend the preceding result to higher dimensions.

4.1 Convergence in Norm, Conjugate Function, and Bochner–Riesz Means
249
Theorem 4.1.8. Let 1 < p < ∞and f ∈Lp(Tn). Then Dn
N ∗f converges to f in Lp
as N →∞.
Proof. As a consequence of Corollary 4.1.3, Proposition 4.1.6, and Theorem 4.1.7,
it sufﬁces to show that for all f trigonometric polynomials on Tn we have
sup
N>0
 1
0 ···
 1
0
(Dn
N ∗f)(x)
p dx1 ···dxn ≤Knpf
p
Lp(Tn) .
Obviously, this inequality is valid in dimension n = 1. We extend it by induction
to all dimensions. We assume that it is valid in dimension n −1 and we prove it in
dimension n.
Let x′ = (x2,...,xn) ∈Tn−1. For a ﬁxed trigonometric polynomial f, and for ﬁxed
N ≥0 and x′ ∈Tn−1, deﬁne a trigonometric polynomial gN,x′ on T1 by setting
gN,x′(x1) = ∑
m1∈Z

∑
|m2|,...,|mn|≤N
e2πim′·x′ 1f(m1,m′)

e2πim1x1
where m′ = (m2,...,mn). Then we have
gN,x′(x1) =
∑
|m2|,...,|mn|≤N
e2πim′·x′
∑
m1∈Z
e2πim1x1 1f(m1,m′)

=
∑
|m2|,...,|mn|≤N
e2πim′·x′
Tn−1 f(x1,y′)e−2πim′·y′dy′

=
∑
|m2|,...,|mn|≤N
e2πim′·x′ 2
fx1(m′)
= (Dn−1
N
∗fx1)(x′),
where fx1 is the trigonometric polynomial of n −1 variables deﬁned by fx1(x′) =
f(x1,x′). We also have that
(DN ∗gN,x′)(x1) = (Dn
N ∗f)(x1,x′).
Combining this information, we write

Tn−1
 1
0
(Dn
N ∗f)(x1,x′)
p dx1 dx′
=

Tn−1
 1
0
(DN ∗gN,x′)(x1)
p dx1 dx′
≤Kp

Tn−1
 1
0
gN,x′(x1)
p dx1 dx′
= Kp
 1
0

Tn−1
(Dn−1
N
∗fx1)(x′)
p dx′ dx1

250
4 Topics on Fourier Series
≤KpK(n−1)p

Tn−1
 1
0
fx1(x′)
p dx′ dx1
= Knpf
p
Lp(Tn),
where the penultimate inequality follows from the induction hypothesis.
□
4.1.3 Bochner–Riesz Summability
In dimension 1 the Fej´er means of an integrable function are better behaved than the
Dirichlet means. We investigate whether there is a similar phenomenon in higher
dimensions. Recall that the circular (or spherical) partial sums of the Fourier series
of f are given by
( f ∗
◦Dn
R)(x) = ∑
m∈Zn
|m|≤R
1f(m)e2πim·x ,
where R ≥0. Taking the averages of these expressions, we obtain
1
R
 R
0 ( f ∗
◦Dn
r)(x)dr = ∑
m∈Zn
|m|≤R

1−|m|
R
 1f(m)e2πim·x = B1
R( f)(x),
and we call these expressions the circular Ces`aro means (or circular Fej´er means)
of f. It turns out that the circular Ces`aro means of integrable functions on T2 always
converge in L1, but in dimension 3, this may fail. Theorem 4.2.5 gives an example of
an integrable function f on T3 whose circular Ces`aro means diverge a.e. However,
we show below that this is not the case if the circular Ces`aro means of a function f
in L1(T3) are replaced by the only slightly different-looking means
∑
m∈Zn
|m|≤R

1−|m|
R
1+ε 1f(m)e2πim·x ,
for some ε > 0. This discussion suggests that the preceding expressions behave bet-
ter as ε increases, but for a ﬁxed ε they get worse as the dimension increases. The
need to understand the behavior of these operators for different values of α ≥0 led
to introduction of the operators Bα
R given in Deﬁnition 4.1.2.
The family of operators Bα
R forms a natural “spherical” analogue of the Ces`aro–
Fej´er sums. It turns out that there is no signiﬁcant difference in the behavior of
these means if the expression

1 −|m|2
R2
α in (4.1.6) is replaced by the expression

1−|m|
R
α; see Exercise 4.3.1. The advantage of the quadratic expression in (4.1.6)
is that it has an easily computable kernel and yields the elegant reproducing formula
Bα
R( f) =
2Γ (α +1)
Γ (α −β)Γ (β +1)
1
R
 R
0

1−r2
R2
α−β−1 r2
R2
β+ 1
2
Bβ
r ( f)dr, (4.1.17)

4.1 Convergence in Norm, Conjugate Function, and Bochner–Riesz Means
251
which precisely quantiﬁes the way in which Bα
R is smoother than Bβ
R when α > β.
Identity (4.1.17) also says that when α > β, the operator Bα
R( f) is an average of the
operators Bβ
r ( f), 0 < r < R, with respect to a certain density.
Note that the Bochner–Riesz means of order zero coincide with the circular (or
spherical) Dirichlet means, and, as we have seen, these converge in L2(Tn). We
address an analogous question on Lp(Tn) for p ̸= 2.
Proposition 4.1.9. Let 1 ≤p < ∞and f ∈Lp(Tn). Then the Bochner–Riesz means
Bα
R( f) converge to f in Lp(Tn) as R →∞when α > (n−1)
 1
p −1
2
. Moreover, if f
is continuous on Tn and α > n−1
2 , then Bα
R( f) converges to f uniformly as R →∞.
Proof. For z ∈C with Rez ≥0, consider the function
mz(ξ) = (1−|ξ|2)z
+
deﬁned for ξ in Rn. Note that ∥mz∥L∞= 1. Using an identity proved in Appendix
B.5, we have that
(mz)∨(y) = Kz(y) = Γ (z+1)
πz
J n
2 +z(2π|y|)
|y|
n
2 +z
,
(4.1.18)
where y ∈Rn and Jν is the Bessel function of order ν. The estimates in Appendices
B.6 and B.7 imply that there is a constant C(Reν) such that
|Jν(r)| ≤C(Reν)e10|Imν|2(1+r)−1
2
whenever Reν > 0. This yields that if Rez > n−1
2 , then there is a constant C′(t) such
that the function Kz obeys the estimate
|Kz(y)| ≤C′( n
2 +Rez)e10|Imz|2(1+|y|)−n−(Rez−n−1
2 ) ,
(4.1.19)
and hence it lies in L1(Rn). Using identity (3.1.10), whenever Rez > n−1
2 , we deﬁne
for an integrable function f on Tn and x ∈Tn the operator
Bz
R( f)(x) = ∑
ℓ∈Zn
mz( ℓ
R) 1f(ℓ)e2πiℓ·x = ( f ∗Lz,R)(x),
where Lz,R is a function whose sequence of Fourier coefﬁcients is {mz( ℓ
R)}ℓ∈Zn.
But the function Lz,R can be precisely identiﬁed. By the Poisson summation for-
mula (Theorem 3.2.8), which applies since both Kz(x) and mz(x) are bounded by a
constant multiple of (1+|x|)−n−δ for some δ > 0, we have
Lz,R(x) = ∑
k∈Zn
mz( k
R)e2πix·k = Rn ∑
ℓ∈Zn
Kz((x+ℓ)R)

252
4 Topics on Fourier Series
for all x ∈Tn. We show that the family {Lz,R}R>0 is an approximate identity on Tn
when Rez > n−1
2 ; on this see the related Exercise 3.1.3. Obviously, using (4.1.19) we
have that

Tn |Lz,R(x)|dx =

Rn |Kz(y)|dy = C′′(n,Rez)e10|Imz|2 < ∞
(4.1.20)
for some constant C′′(n,Rez), and also

Tn Lz,R(x)dx =

Rn Kz(y)dy = mz(0) = 1
for all R > 0 when Rez > n−1
2 . Moreover, for δ < 1
2 using (4.1.19) we have

δ≤supj |x j|≤1
2
Lz,R(x)
dx ≤
Cn,z
RRez−n−1
2

δ≤supj |x j|≤1
2 ∑
ℓ∈Zn
1
|x+ℓ|n+Rez−n−1
2
dx →0,
thus the integral of Lz,R over [−1/2,1/2]n \[−δ,δ]n tends to zero as R →∞.
Using Theorem 1.2.19, we obtain these conclusions for Rez > n−1
2 :
(a) For f ∈L1(Tn), Bz
R( f) converge to f in L1 as R →∞.
(b) For f continuous on Tn, Bz
R( f) converge to f uniformly as R →∞.
We turn to the corresponding results for 1 < p < ∞. We have that
Rez > n−1
2
=⇒sup
R>0
Bz
R

L1(Tn)→L1(Tn) = C′′(n,Rez)e10|Imz|2
(4.1.21)
Rez = 0 =⇒sup
R>0
Bz
R

L2(Tn)→L2(Tn) = ∥mz∥L∞= 1.
(4.1.22)
The family of operators f →Bz
R( f) is of admissible growth for all Rez ≥0, since
for all measurable subsets A, B of Tn we have


Tn Bz
R(χA)χB dx
 =
 ∑
k∈Zn
2
χA(k)mz(k)2
χB(k)
 ≤∑
|k|≤R
1 ≤CnRn ,
thus condition (1.3.23) holds. Moreover, hypothesis (1.3.24) of Theorem 1.3.7 holds
in view of (4.1.21) and (4.1.22). Applying Theorem 1.3.7 (or rather Exercise 1.3.4 in
which the strip [0,1]×R is replaced by the more general strip [a,b]×R) we obtain
that when α = Rez > (n−1)| 1
p −1
2|, we have
sup
R>0
Bα
R

Lp(Tn)→Lp(Tn) < ∞.
Finally, using Corollary 4.1.3, we deduce that Bα
R( f) →f in Lp(Tn) as R →∞for
all f ∈Lp(Tn).
□
The preceding result is sharp in the case p = 1 (Theorem 4.2.5). For this rea-
son, the number α = (n−1)/2 is referred to as the critical index of Bochner–Riesz
summability.

4.1 Convergence in Norm, Conjugate Function, and Bochner–Riesz Means
253
Exercises
4.1.1. If f ∈C ∞(Tn), then show that Dn
N ∗f and
◦Dn
N ∗f converge to f uniformly
and in Lp for 1 ≤p ≤∞.
4.1.2. Prove that
∥P+∥L2(T1)→L2(T1) = ∥P−∥L2(T1)→L2(T1) = ∥W∥L2(T1)→L2(T1) = 1,
where W( f) = #f is the conjugate function on the circle. Moreover, show that the
mappings f →W( f)+ 1f(0) and f →W( f)−1f(0) are isometries on L2(T1).
4.1.3. Let −∞≤aj < bj ≤+∞for 1 ≤j ≤n. Consider the rectangular projection
operator deﬁned on C ∞(Tn) by
P( f)(x) =
∑
a j≤mj≤b j
1f(m)e2πi(m1x1+···+mnxn) .
Prove that when 1 < p < ∞, P extends to a bounded operator from Lp(Tn) to itself
with bounds independent of the aj,bj.

Hint: Express P in terms of the Riesz projection P+.

4.1.4. Let Pr(t) be the Poisson kernel on T1 as deﬁned in Exercise 3.1.7. For 0 <
r < 1, deﬁne the conjugate Poisson kernel Qr(t) on the circle by
Qr(t) = −i
+∞
∑
m=−∞
sgn (m)r|m|e2πimt .
(a) For 0 < r < 1, prove the identity
Qr(t) =
2rsin(2πt)
1−2rcos(2πt)+r2 .
(b) Prove that #f(t) = limr→1(Qr ∗f)(t) whenever f is smooth. Conclude that if f is
real-valued, then so is #f.
(c) Let f ∈L1(T1). Prove that the function
z →(Pr ∗f)(t)+i(Qr ∗f)(t)
is analytic in z = re2πit on the open unit disc {z ∈C : |z| < 1}.
(d) Let f ∈L1(T1). Conclude that the functions z →(Pr ∗f)(t) and z →(Qr ∗f)(t)
are conjugate harmonic functions of z = re2πit in the region |z| < 1. The term con-
jugate Poisson kernel stems from this property.

254
4 Topics on Fourier Series
4.1.5. Let f be in .
Λα(T1) for some 0 < α < 1. Prove that the conjugate function #f
is well deﬁned and can be written as
#f(x) = lim
ε→0

ε≤|t|≤1/2 f(x−t)cot(πt)dt
=

|t|≤1/2

f(x−t)−f(x)

cot(πt)dt.

Hint: Use part (b) of Exercise 4.1.4 and the fact that Qr has integral zero over the
circle to write ( f ∗Qr)(x) =

( f −f(x)) ∗Qr

(x), allowing use of the Lebesgue
dominated convergence theorem.

4.1.6. Suppose that f is a real-valued function on T1 with | f| ≤1 and 0 ≤λ < π/2.
(a) Prove that

T1 eλ #f(t) dt ≤
1
cos(λ) .
(b) Conclude that for 0 ≤λ < π/2 we have

T1 eλ| #f(t)| dt ≤
2
cos(λ) .

Hint: Part (a): Consider the analytic function F(z) on the disk |z| < 1 deﬁned by
F(z) = −i(Pr ∗f)(θ) + (Qr ∗f)(θ), where z = re2πiθ. Then Re eλF(z) is harmonic
and its average over the circle |z| = r is equal to its value at the origin, which is
cos(λ f(0)) ≤1. Let r ↑1 and use that for z = e2πit on the circle we have Re eλF(z) ≥
eλ #f(t) cos(λ).

4.1.7. Prove that for 0 < α < 1 there is a constant Cα such that
 #f
.
Λα(T1) ≤Cα
 f
.
Λα(T1) .

Hint: Using Exercise 4.1.5, for |h| ≤1/10 write #f(x+h)−#f(x) as

|t|≤5|h|

f(x−t)−f(x+h)

cot(π(t +h))dt
−

|t|≤5|h|

f(x−t)−f(x)

cot(πt)dt
+

5|h|≤|t|≤1/2

f(x−t)−f(x)

cot(π(t +h))−cot(πt)

dt
+

f(x)−f(x+h)

5|h|≤|t|≤1/2 cot(π(t +h))dt .
You may use the fact that cot(πt) = 1
πt + b(t), where b(t) is a bounded function
when |t| ≤1/2. The case |h| ≥1/10 is easy.


4.2 Divergence Theorems
255
4.1.8. The beta function is deﬁned in Appendix A.2. Derive the identity
tα =
1
B(α−β,β +1)
 t
0 (t −s)α−β−1sβ ds
and show that the function Kα
R (x) = ∑|m|≤R

1−|m|2
R2
αe2πim·x satisﬁes (4.1.17).

Hint: Take t = 1−|m|2
R2 and change variables s = r2−|m|2
R2
in the displayed identity.

4.2 A. E. Divergence of Fourier Series and Bochner–Riesz means
We saw in Proposition 3.4.6 that the Fourier series of a continuous function may
diverge at a point. As expected, the situation can only get worse as the functions
get worse. In this section we present an example, due to A. N. Kolmogorov, of an
integrable function on T1 whose Fourier series diverges almost everywhere. We also
prove an analogous result for the Bochner–Riesz means at the critical index.
4.2.1 Divergence of Fourier Series of Integrable Functions
It is natural to start our investigation with the case n = 1. We begin with the follow-
ing important result:
Theorem 4.2.1. There exists an integrable function on the circle T1 whose Fourier
series diverges almost everywhere.
Proof. The proof of this theorem is a bit involved, and we need a sequence of lem-
mas, which we prove ﬁrst.
Lemma 4.2.2. (Kronecker) Suppose that N ∈Z+ and
{x1,x2,...,xN,1}
is a linearly independent set over the rationals. Then for any ε > 0 and any complex
numbers z1,z2,...,zN with |z j| = 1, there exists an integer L ∈Z such that
|e2πiLx j −z j| < ε
for all
1 ≤j ≤N.
Proof. Suppose that the assertion claimed is false. Then there is an ε > 0 and com-
plex numbers z j = e2πiθ j, j = 1,...,N, with 0 ≤θ j < 1, such that
{m(x1,...,xN) : m ∈Z}∩B

(θ1,...,θN),ε

= /0,

256
4 Topics on Fourier Series
where B

(θ1,...,θN),ε

denotes a neighborhood in TN of radius ε centered at the
point (θ1,...,θN). Pick a smooth, nonzero, and nonnegative function f on TN sup-
ported in B

(θ1,...,θN),ε

. Then f(m(x1,...,xN)) = 0 for all m ∈Z, but
1f(0) =

TN f(y)dy > 0.
(4.2.1)
Set x = (x1,...,xN). Then we have
0 = 1
M
M−1
∑
m=0
f(mx) = 1
M
M−1
∑
m=0

∑
ℓ∈ZN
1f(ℓ)e2πiℓ·mx

= ∑
ℓ∈ZN
1f(ℓ)
 1
M
M−1
∑
m=0
e2πim(ℓ·x)

= 1f(0)+
∑
ℓ∈ZN\{0}
1f(ℓ)
 1
M
e2πiM(ℓ·x) −1
e2πi(ℓ·x) −1

.
Note that e2πi(ℓ·x) −1 ̸= 0 because ℓ·x = ℓ1x1 +···+ℓNxN /∈Z, since by assumption
the set {x1,x2,...,xN,1} is linearly independent over the rationals. Observe that
1f(ℓ) 1
M
e2πiM(ℓ·x) −1
e2πi(ℓ·x) −1 = 1f(ℓ) 1
M
M−1
∑
m=0
e2πim(ℓ·x)
tends to 0 as M →∞for every ﬁxed ℓ∈ZN and is bounded uniformly in M by
| 1f(ℓ)| which satisﬁes ∑ℓ∈ZN | 1f(ℓ)| < ∞. Using the Lebesgue dominated convergence
theorem, we obtain that
0 = 1f(0)+ lim
M→∞
∑
ℓ∈ZN\{0}
1f(ℓ)
 1
M
e2πiM(ℓ·x) −1
e2πi(ℓ·x) −1

= 1f(0)+
∑
ℓ∈ZN\{0}
1f(ℓ) lim
M→∞
 1
M
e2πiM(ℓ·x) −1
e2πi(ℓ·x) −1

= 1f(0)+0,
which contradicts (4.2.1). Therefore the claimed L exists.
□
Lemma 4.2.3. There exists a positive constant c > 0 such that given any integer
N ≥2 there exists a positive measure μN on T1 with μN(T1) = 1 such that
sup
L≥1
(μN ∗DL

(x)| = sup
L≥1

L
∑
k=−L
2
μN(k)e2πikx
 ≥clogN
(4.2.2)
for almost all x ∈T1 (c is a ﬁxed constant).

4.2 Divergence Theorems
257
Proof. Given irrational real numbers x1,...,xN such that the set {x1,...,xN,1} is
linearly independent over the rationals, we deﬁne Q[x1,...,xN] to be the ﬁeld exten-
sion of Q consisting of all linear combinations of the form q0 + q1x1 + ··· + qNxN,
where qj are rational numbers. Obviously Q[x1,...,xN] is a countable set. Fix
N ≥100 and choose points xj as follows:
0 < x1 < 1
N < x2 < 2
N < x3 < 3
N < ··· < N −1
N
< xN < 1
(4.2.3)
and such that x1 /∈Q, x2 /∈Q[x1], ..., xN /∈Q[x1,...,xN−1]. Then obviously the set
{x1,...,xN,1} is linearly independent over the rationals. Let
EN =
	
x ∈[0,1] : {x−x1,...,x−xN,1}
is linearly independent over Q

and observe that every x in [0,1] \ Q[x1,...,xN] belongs to EN. Indeed, if x /∈EN,
then there are rational numbers qj such that
q0 +q1(x−x1)+···+qN(x−xN) = 0.
Then q = q1 +···+qN ̸= 0, since {x1,...,xN,1} are linearly independent over Q. It
follows that
x = −q−1q0 +q−1q1x1 +···+q−1qNxN,
thus x ∈Q[x1,...,xN]. We conclude that EN has full measure.
Next, we deﬁne the probability measure
μN = 1
N
N
∑
j=1
δx j ,
where δx j are Dirac delta masses at the points xj. For this measure we have

L
∑
k=−L
2
μN(k)e2πikx
 =

L
∑
k=−L
 1
N
N
∑
j=1
e−2πikx j

e2πikx

=

1
N
N
∑
j=1
DL(x−xj)

=

1
N
N
∑
j=1
sin(2π(L+ 1
2)(x−xj))
sin(π(x−xj))

=

1
N
N
∑
j=1
Im

e2πi(L+ 1
2 )(x−x j)
sgn

sin(π(x−xj))

|sin(π(x−xj))|
,
(4.2.4)
where the signum function is deﬁned as sgna = 1 for a > 0, −1 for a < 0, and zero
if a = 0. By Lemma 4.2.2, for all x ∈EN there exists an L ∈Z+ such that
e2πiL(x−x j) −ie−2πi 1
2 (x−x j)sgn

sin(π(x−xj))
 < 1
2 ,

258
4 Topics on Fourier Series
which can be equivalently written as
e2πi(L+ 1
2 )(x−x j)sgn

sin(π(x−xj))

−i
 < 1
2 .
(4.2.5)
It follows from (4.2.5) that
Im

e2πi(L+ 1
2 )(x−x j)
sgn

sin(π(x−xj))

> 1
2 .
Combining this with the result of the calculation in (4.2.4), we obtain that

L
∑
k=−L
2
μN(k)e2πikx
 > 1
2N
N
∑
j=1
1
|sin(π(x−xj))| ≥
1
2πN
N
∑
j=1
1
|x−xj| .
But for every x ∈[0,1), there exists a j0 such that x ∈[xj0,xj0+1). It follows from
(4.2.3) that |x−xj| ≤C(| j −j0|+1)N−1, and thus
N
∑
j=1
1
|x−xj| ≥c′N logN .
Thus for every x ∈EN there exists an L ∈Z+ such that
DL ∗μN(x)
 =

L
∑
k=−L
2
μN(k)e2πikx
 > clogN ,
which proves the required conclusion since EN is a set of measure 1.
□
Lemma 4.2.4. For each 0 < M < ∞there exists a trigonometric polynomial gM and
a measurable subset AM of T1 with measure |AM| > 1−2−M such that ∥gM∥L1 = 1,
and such that
inf
x∈AM sup
L≥1
(DL ∗gM)(x)
 = inf
x∈AM sup
L≥1

L
∑
k=−L
2
gM(k)e2πikx
 > 2M .
(4.2.6)
Proof. Given an M ∈Z+, we pick an integer N(M) such that clogN(M) > 2M+2,
where c is as in (4.2.2), and we also pick the measure μN(M), which satisﬁes (4.2.2).
By Fatou’s lemma we have
1 =
	
x ∈T1 : sup
L≥1
|(DL ∗μN(M))(x)| ≥2M+2

=
 
L≥1
	
x ∈T1 :
sup
1≤j≤L
|(Dj ∗μN(M))(x)| ≥2M+2

=

T1 lim
L→∞χ{x∈T1: sup1≤j≤L |(Dj∗μN(M))(x)|≥2M+2}dx
≤liminf
L→∞
	
x ∈T1 :
sup
1≤j≤L
|(Dj ∗μN(M))(x)| ≥2M+2
,

4.2 Divergence Theorems
259
and thus we can ﬁnd a positive integer L(M) such that the set
AM =
	
x ∈T1 :
sup
1≤L≤L(M)
|(DL ∗μN(M))(x)| ≥2M+2
has measure greater than 1−2−M. We pick a positive integer K(M) such that
sup
1≤j≤L(M)
FK(M) ∗Dj −Dj

L∞≤1,
where FK is the Fej´er kernel. This is possible, since the Fej´er kernel is an approx-
imate identity and {Dj : 1 ≤j ≤L(M)} is a ﬁnite family of continuous functions.
Then we deﬁne gM = μN(M)∗FK(M). Since μN(M) is a probability measure, we obtain
|(Dj ∗gM)(x)−(Dj ∗μN(M))(x)| ≤
Dj ∗FK(M) −Dj

L∞≤1
for all x ∈[0,1] and 1 ≤j ≤L(M). But given x ∈AM there exists an L in {1,...,L(M)}
such that |(DL ∗μN(M))(x)| ≥2M+2 and for this L we have
|(DL ∗gM)(x)| ≥|(DL ∗μN(M))(x)|−1 ≥2M+2 −1 ≥2M+1 > 2M .
Therefore, (4.2.6) is satisﬁed for this gM and AM. Since μN is a nonnegative measure
and FK(M) is nonnegative and has L1 norm 1, we have that
gM

L1 =
μN(M) ∗FK(M)

L1 =
μN(M)

M
FK(M)

L1 = 1,
showing that gM has L1 norm equal to one.
□
We now have the tools needed to construct an example of a function whose
Fourier series diverges almost everywhere. The example is given as a series of func-
tions whose behavior worsens as its index becomes bigger. The function we wish to
construct is a sum of the form
g =
∞
∑
j=1
ε jgMj ,
(4.2.7)
for a choice of sequences ε j →0 and Mj →∞, where gM are as in Lemma 4.2.4.
Let us be speciﬁc. First, we set d0 = 1 and for N ≥1
dN = max
1≤s≤N degree(gMs),
(4.2.8)
where gM is the trigonometric polynomial of Lemma 4.2.4. We set ε0 = M0 = 1.
Assume that we have deﬁned ε j and Mj for all 1 ≤j < N for some N ≥2. We set
εN = 2−N(3dN−1)−1
(4.2.9)

260
4 Topics on Fourier Series
and then we pick MN such that
2MN ≥

2N +dN−1 +1

ε−1
N .
(4.2.10)
This deﬁnes εN and MN for a given positive integer N, provided εj and Mj are known
for all j < N. This way we deﬁne εN and MN for all natural numbers N.
We observe that the selections of ε j and Mj force the inequalities ε j ≤2−j and
dj ≤dj+1 for all j ≥1. Since each gMj has L1 norm 1 and ε j ≤2−j, the function g
in (4.2.7) is integrable and has L1 norm at most 1.
For a given j ≥1 and x ∈AMj, by Lemma 4.2.4 there exists an L ≥1 such that
|(DL ∗gMj)(x)| > 2Mj. Set
k = k(x) = min(L,dj).
Then we have
|(Dk ∗g)(x)| ≥ε j|(Dk ∗gMj)(x)|−∑
1≤s< j
εs|(Dk ∗gMs)(x)|−∑
s> j
εs|(Dk ∗gMs)(x)|.
We make the following observations:
(i) |(Dk ∗gMj)(x)| = |(DL ∗gMj)(x)| > 2Mj.
(ii) |(Dk ∗gMs)(x)| = |(Dmin(ds,k) ∗gMs)(x)| ≤
Dmin(ds,L)

L∞≤3ds, when s < j.
(iii) |(Dk ∗gMs)(x)| = |(Dmin(ds,k) ∗gMs)(x)| ≤
Dmin(d j,L)

L∞≤3dj, when s > j.
In these estimates we have used that k = min(L,dj),
Dm

L∞≤2m + 1 ≤3m, and
that
Dr ∗gMs = Dmin(r,ds) ∗gMs ,
which follows easily by examining the corresponding Fourier coefﬁcients.
Using the estimates in (i), (ii), and (iii), for a ﬁxed x ∈AMj and k = k(x) we obtain
|(Dk ∗g)(x)| ≥ε j 2Mj −3 ∑
1≤s< j
εs ds −3∑
s> j
εs dj .
(4.2.11)
Our selection of ε j and Mj now ensures that (4.2.11) is a large number. In fact, we
have
3∑
s> j
εs dj = ∑
s> j
2−sdj(ds−1)−1 ≤∑
s> j
2−s ≤1
and
3 ∑
1≤s< j
εs ds ≤3dj−1 ∑
1≤s< j
εs ≤dj−1 ∑
1≤s< j
2−s(ds−1)−1 ≤dj−1 .

4.2 Divergence Theorems
261
Therefore, the expression in (4.2.11) is at least ε j2Mj −dj−1 −1 ≥2j. It follows that
for every j ≥1 and every x ∈AMj there exists a k = k(x) ∈Z+ such that
|(Dk ∗g)(x)| ≥2j .
We conclude that for every r ≥1 and x ∈
∞
j=r
AMj,
sup
k≥1
|(Dk ∗g)(x)| ≥2j ≥2r ,
(4.2.12)
since x belongs to some AMj with j ≥r. For given r ≥1, Lemma 4.2.4 yields that
1 ≥

∞

j=r
AMj
 ≥liminf
j→∞|AMj| ≥lim
j→∞(1−2−Mj) = 1.
Then the set
A =
∞

r=0
∞

j=r
AMj
has measure 1, since it is a countable intersection of subsets of T1 of full measure.
In view of (4.2.12) we have that for all x in A
sup
k≥1
|(Dk ∗g)(x)| ≥sup
r≥1
2r = ∞
(4.2.13)
and thus the required conclusion follows.
□
4.2.2 Divergence of Bochner–Riesz Means of Integrable Functions
We now turn to the corresponding n-dimensional problem for spherical summability
of Fourier series. The situation here is quite similar at the critical index α = n−1
2 .
Theorem 4.2.5. Let n > 1. There exists an integrable function f on Tn such that
limsup
R→∞
B
n−1
2
R
( f)(x)
 = limsup
R→∞
 ∑
m∈Zn
|m|≤R

1−|m|2
R2
 n−1
2 1f(m)e2πim·x
 = ∞
for almost all x ∈Tn. Furthermore, such a function can be constructed such that it
is supported in an arbitrarily small given neighborhood of the origin.
We will need a couple of lemmas.
Lemma 4.2.6. Let n ≥2. The complement of the set
S =
	
x ∈Rn : {1}∪{|x−m| : m ∈Zn} is linearly independent over Q

has n-dimensional Lebesgue measure zero.

262
4 Topics on Fourier Series
Proof. Recall that a function g deﬁned on an open subset Ω of Rn is called real
analytic if for every point x0 in Ω there is a ball B(x0,ε) is contained in Ω and there
exist coefﬁcients cβ(x0) such that g(x) = ∑β cβ(x0)(x −x0)β for all |x −x0| < ε,
where the sum is taken over all multiindices. We will need two facts about real
analytic functions. First, the function x →|x| is real analytic on Rn \ {0}. Indeed,
given x0 ̸= 0, for |x−x0| < |x0|/3 we have that
|x−x0|2
|x0|2
+2(x−x0)· x0
|x0|2 < 1.
This allows us to write
|x| = |x0|

1+ |x−x0|2
|x0|2
+2(x−x0)· x0
|x0|2
 1
2
= |x0|
∞
∑
k=0
1/2
k
|x−x0|2
|x0|2
+2(x−x0)· x0
|x0|2
k
,
which is a power series of the form ∑β cβ(x0)(x−x0)β.
Secondly, we need the fact that a real analytic function deﬁned on an open con-
nected subset of Rn cannot vanish on a set of positive measure, unless it is identically
equal to zero; a proof of this in dimension one and an outline of the proof in higher
dimensions is contained in [205].
We return to the proof of the lemma which requires us to show that S has full
measure in Rn. Indeed, if x ∈Rn \ S, then there exist k ∈Z+, m1,...mk ∈Zn, and
q0,q1,...,qk nonzero rational numbers such that
q0 +
k
∑
j=1
qj|x−mj| = 0.
(4.2.14)
Since the function
y →q0 +
k
∑
j=1
qj|y−mj|
is nonzero and real analytic on Rn \ Zn, it must vanish only on a set of Lebesgue
measure zero. Therefore, there exists a set Am1,...,mk,q0,q1,...,qk of Lebesgue measure
zero such that (4.2.14) holds exactly when x is in this set. Then
Rn \S ⊆
∞

k=1

m1,...,mk∈Zn

q0,q1,...,qk∈Q
Am1,...,mk,q0,q1,...,qk ,
from which it follows that Rn \S has Lebesgue measure zero.
□

4.2 Divergence Theorems
263
Let us denote the Bochner–Riesz kernel by
Kα
R (x) = ∑
|m|≤R

1−|m|2
R2
αe2πim·x
when x ∈Tn. We need the following lemma regarding Kα
R :
Lemma 4.2.7. Let n ≥2. For almost every x ∈Tn we have
limsup
R→∞
|K
n−1
2
R
(x)| = ∞.
It is noteworthy to compare the result of this lemma with the analogous one-
dimensional statement
limsup
R→∞
|DR(x)| = ∞
for the Dirichlet kernel, which holds exactly when x = 0. Thus the uniform ill be-
havior of the kernel K
n−1
2
R
reﬂects in some sense its lack of localization.
Proof. Fix n ≥2 and ﬁx x0 ∈

[−1/2,1/2)n \ {0}

∩S, where S is as in Lemma
4.2.6. Using (4.1.18) and the Poisson summation formula (Theorem 3.2.8), for each
α > n−1
2
we obtain the identity
Kα
R (x0) = Γ (α +1)
πα
Rn ∑
m∈Zn
J n
2 +α(2πR|x0 −m|)
(R|x0 −m|)
n
2 +α
(4.2.15)
and the sum converges absolutely because of the asymptotics for the Bessel func-
tions in Appendix B.8. The term with m = 0 in the sum in (4.2.15) is a ﬁnite constant
since by Appendix B.6 the function
y →
J n
2 +α(2πR|y|)
|y|
n
2 +α
is smooth and therefore bounded. But for m ̸= 0 in (4.2.15) we have |m−x0| ≥1/2.
The asymptotics in Appendix B.8 imply that for R ≥2 we have
J n
2 +α(2πR|x0 −m|) = e2πiR|x0−m|e−i π
2 ( n
2 +α)−i π
4 +e−2πiR|x0−m|ei π
2 ( n
2 +α)+i π
4
π
"
R|x0 −m|
+O

(R|x0 −m|)−3
2 
for all α > n−1
2 . We insert this expression in (4.2.15), we multiply by e2πiλR for some
λ real, and then we average in R from 1 to T, for some T > 10. We obtain

264
4 Topics on Fourier Series
1
T
 T
1 Kα
R (x0)e2πiλR dR
= Γ (α+1)
πα
∑
m∈Zn\{0}
e−i π
2 ( n
2 +α)−i π
4
|x0 −m|
n+1
2 +α
1
T
 T
1 e2πiR(λ+|x0−m|)R
n−1
2 −α dR
+ Γ (α+1)
πα
∑
m∈Zn\{0}
ei π
2 ( n
2 +α)+i π
4
|x0 −m|
n+1
2 +α
1
T
 T
1 e2πiR(λ−|x0−m|)R
n−1
2 −α dR
+ Γ (α+1)
πα
∑
m∈Zn\{0}
O

1
|x0 −m|
n+3
2 +α
 1
T
 T
1 R
n−3
2 −α dR
+ Γ (α+1)
πα
1
T
 T
1
J n
2 +α(2πR|x0|)
(R|x0|)
n
2 +α
e2πiλR Rn dR.
(4.2.16)
Assume that we are able to pass the limit as α →n−1
2 + through the sums and
integrals in the preceding identity; we justify this step momentarily. Then we obtain
1
T
 T
1 K
n−1
2
R
(x0)e2πiλR dR
= Γ ( n+1
2 )
π
n−1
2
∑
m∈Zn\{0}
e−i π
2 ( 2n−1
2
)−i π
4
|x0 −m|n
1
T
 T
1 e2πiR(λ+|x0−m|) dR
+ Γ ( n+1
2 )
π
n−1
2
∑
m∈Zn\{0}
ei π
2 ( 2n−1
2
)+i π
4
|x0 −m|n
1
T
 T
1 e2πiR(λ−|x0−m|) dR
+ Γ ( n+1
2 )
π
n−1
2
∑
m∈Zn\{0}
O

1
|x0 −m|n+1
 1
T
 T
1
dR
R
+ Γ ( n+1
2 )
π
n−1
2
1
T
 T
1
Jn−1
2 (2πR|x0|)
(R|x0|)n−1
2
e2πiλR Rn dR.
(4.2.17)
We now justify the passage of the limit in α inside the sums and the integrals in
(4.2.16) to obtain (4.2.17). First, when |m| ≤R ≤T and α > n−1
2 , the mean value
theorem gives


1−|m|2
R2
 n−1
2
e2πix0·m −

1−|m|2
R2
α
e2πix0·m

≤

α −n−1
2

1−|m|2
R2
 n−1
2
log
1
1−|m|2
R2
≤

α −n−1
2

sup
0<t≤1
t
n−1
2 log 1
t ,

4.2 Divergence Theorems
265
thus Kα
R (x0) converges to K
n−1
2
R
(x0) uniformly in R ∈[1,T] as α →n−1
2 and therefore
the integral over [1,T] of the former converges to the integral over [1,T] of the latter.
Next, an integration by parts shows that the integral
 T
1 e2πiR(λ+|x0−m|)R
n−1
2 −α dR
is bounded by a constant multiple of (λ +|x0 −m|)−1, which makes the ﬁrst inﬁnite
sum in (4.2.16) converge absolutely and uniformly in α ≥n−1
2 , thus one may pass
the limit in α inside the sum. Also, the integral
 T
1 e2πiR(λ−|x0−m|)R
n−1
2 −α dR
is bounded by a constant multiple of (λ −|x0 −m|)−1 whenever λ is not in the set
Λx0 = {|x0 −m| : m ∈Zn} = {λ1,λ2,λ3,...},
where 0 < λ1 < λ2 < λ3 < ···. Thus for λ /∈Λx0, the preceding argument explains
the passage of the limit in α inside the second inﬁnite sum in (4.2.16). If λ happens
to be in Λx0, then there is at most one m0 ̸= 0, such that λ = |x0 −m0| and the
second sum in (4.2.16) restricted to m ∈Zn \ {0,m0} converges absolutely, while
for the single term with m = m0, letting α →n−1
2 + is trivial. Finally, for the term
involving the Bessel function Jn−1
2 , the passage of the limit in α inside the integral
is straightforward since the function
(α,R) →
J n
2 +α(2πR|x0|)
(R|x0|)
n
2 +α
is continuous on the compact set [ n−1
2 , n
2] × [1,T]. This completes the proof of
(4.2.17).
There are four terms to the right of (4.2.17) and we observe that if λ ̸= ±|x0 −m0|
for any m0 ∈Zn, then all these terms converge to zero as T →∞. This assertion
is trivial for the ﬁrst three of these four terms, while for the last we assume that
T > |x0|−1. We split the integral
1
T
 T
1
Jn−1
2 (2πR|x0|)
(R|x0|)n−1
2
e2πiλR Rn dR
(4.2.18)
as a sum of the integral over [1,|x0|−1], which obviously converges to zero as T →∞
by Appendix B.6, and of the integral over [|x0|−1,T]. For the latter, we use the
asymptotics in Appendix B.8 to write
Jn−1
2 (2πR|x0|) = e2πiR|x0|e−i π
2 ( 2n−1
2
)−i π
4 +e−2πiR|x0|ei π
2 ( 2n−1
2
)+i π
4
π
"
R|x0|
+O

(R|x0|)−3
2 
.

266
4 Topics on Fourier Series
The part of the integral in (4.2.18) over [|x0|−1,T] corresponding to O

(R|x0|)−3
2 
grows like log(T|x0|) which divided by T obviously tends to zero. The part of the
integral in (4.2.18) over [|x0|−1,T] corresponding to the main term is
1
T
1
π
"
|x0|
 T
|x0|−1 e2πiR(λ+|x0|)e−i π
2 ( 2n−1
2
)−i π
4 +e2πiR(λ−|x0|)ei π
2 ( 2n−1
2
)+i π
4 dR
which tends to zero as T →∞by an integration by parts, since λ ̸= |x0| because we
are considering the case where λ ̸= ±|x0 −m| for any m ∈Zn.
Now consider the case where λ = ±|x0 −m0| for some m0 ∈Zn. In this case the
expression to the right in (4.2.17) converges to
Γ ( n+1
2 )
π
n−1
2
e±i( π
2 ( 2n−1
2
)+ π
4 )
|x0 −m0|n
= Γ ( n+1
2 )
π
n−1
2
e±i πn
2
|x0 −m0|n
as T →∞. Next observe that
∞
∑
j=1
1
λ n
j
= ∞.
(4.2.19)
We have now shown that
lim
T→∞
1
T
 T
1 K
n−1
2
t
(x0)e2πiλt dt =
⎧
⎪
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎪
⎩
Γ ( n+1
2
)
π
n−1
2
ei πn
2
λ n
j
if λ = λ j,
0
if λ ̸= ±λ j,
Γ ( n+1
2
)
π
n−1
2
e−i πn
2
λ n
j
if λ = −λ j.
(4.2.20)
Since x0 lies in S, the set {1} ∪{λ1,λ2,λ3,...} is linearly independent over the
rationals and thus no expression of the form ±λ j1 ±···±λ js is equal to an integer.
It follows from this fact and (4.2.20) that
lim
T→∞
1
T
 T
1 K
n−1
2
t
(x0)
N
∏
j=1

1+ e−i πn
2 e2πiλ jt +ei πn
2 e−2πiλ jt
2

dt = Γ ( n+1
2 )
π
n−1
2
N
∑
j=1
1
λ n
j
.
Suppose we had that
sup
R≥1
|K
n−1
2
R
(x0)| ≤Ax0 < ∞.
Then, setting cn =
Γ ( n+1
2
)
π
n−1
2
, we would have
cn
N
∑
j=1
1
λ n
j
= lim
T→∞
1
T
 T
1 K
n−1
2
t
(x0)
N
∏
j=1

1+ e−i πn
2 e2πiλ jt +ei πn
2 e−2πiλ jt
2

dt
= limsup
T→∞
1
T
 T
1 |K
n−1
2
t
(x0)|
N
∏
j=1
1+ e−i πn
2 e2πiλ jt +ei πn
2 e−2πiλ jt
2
dt

4.2 Divergence Theorems
267
≤Ax0 limsup
T→∞
1
T
 T
1
N
∏
j=1

1+ e−i πn
2 e2πiλ jt +ei πn
2 e−2πiλ jt
2

dt
= Ax0 ,
which contradicts (4.2.19) by letting N →∞. Here, once again, we used the fact
that no expression of the form ±λ j1 ± ··· ± λ js is equal to an integer and thus the
preceding limsup is a limit and is equal to 1, since the integral of all the exponentials
produces another exponential which remains bounded.
We deduce that supR≥1 |K
n−1
2
R
(x0)| = ∞for every point x0 ∈S ∩[−1
2, 1
2)n \ {0}
and this concludes the proof of Lemma 4.2.7.
□
Proof. We now prove Theorem 4.2.5. This part of the proof is similar to the proof
of Theorem 4.2.1. Lemma 4.2.7 says that the means B
n−1
2
R
(δ0)(x), where δ0 is the
Dirac mass at 0, do not converge for almost all x ∈Tn. Our goal is to replace this
Dirac mass by a series of integrable functions on Tn that have a peak at the origin.
Let us ﬁx a nonnegative C ∞radial function 1Φ on Rn that is supported in the unit
ball |ξ| ≤1 and has integral equal to 1. We set
ϕε(x) = ∑
m∈Zn
1
εn 1Φ( x+m
ε ) = ∑
m∈Zn
Φ(εm)e2πim·x,
where the identity is valid because of the Poisson summation formula. It follows that
the mth Fourier coefﬁcient of ϕε is Φ(εm). Therefore, we have the estimate
sup
x∈Tn sup
R>0
|B
n−1
2
R
(ϕε)(x)| ≤∑
m∈Zn
|Φ(εm)| ≤∑
m∈Zn
C′
n
(1+ε|m|)n+1 ≤Cn
εn .
(4.2.21)
For any k ≥1, we construct measurable subsets Ek of Tn with |Ek| ≥1 −1
k, a se-
quence of positive numbers R1 < R2 < ···, with Rk ↑∞, and two sequences of posi-
tive numbers εk ↓0 and γk ↓0 such that εk ≤γk for all k and
sup
R≤Rk
B
n−1
2
R
 ∞
∑
s=1
2−s(ϕεs −ϕγs)

(x)
 ≥k
for x ∈Ek.
(4.2.22)
We pick E1 = /0, R1 = 1, and ε1 = γ1 = 1. Let k > 1 and suppose that we have selected
Ej, Rj, γ j, and ε j for all 1 ≤j ≤k −1 such that (4.2.22) is satisﬁed. We construct
Ek, Rk, γk, and εk such that (4.2.22) is satisﬁed with j = k. We begin by choosing γk.
Let B be a constant such that
|Φ(x)−Φ(y)| ≤B|x−y|
for all x,y ∈Rn. Deﬁne γk such that
Bγk
∑
|m|≤Rk−1
|m| = 1.
(4.2.23)

268
4 Topics on Fourier Series
Then deﬁne
Ak = Cn2−kγ−n
k
+Cn
k−1
∑
j=1
2−j(ε−n
j
+γ−n
j ),
where Cn is the constant in (4.2.21), and observe that in view of (4.2.21) we have
sup
x∈Tn sup
R>0
B
n−1
2
R

−2−kϕγk +
k−1
∑
j=1
2−j(ϕε j −ϕγ j)

(x)
 ≤Ak .
(4.2.24)
Let δ0 be the Dirac mass at the origin in Tn. Since by Fatou’s lemma and Lemma
4.2.7 we have
liminf
R′→∞


x ∈Tn :
sup
0<R≤R′
B
n−1
2
R
(δ0)(x)
 > 2k(Ak +k +2)
 = 1,
there exists an Rk > max(Rk−1,k) such that the set
Ek =

x ∈Tn :
sup
0<R≤Rk
B
n−1
2
R
(2−kδ0)(x)
 > Ak +k +2

has measure at least 1 −1
k. Note that since Rk is increasing and tends to inﬁnity,
(4.2.23) yields that γk is decreasing and tends to zero.
We now choose εk such that εk ≤γk, εk ≤εk−1, and that
sup
x∈Tn sup
R≤Rk
2−kB
n−1
2
R
(δ0)(x)−B
n−1
2
R
(ϕεk)(x)
 ≤∑
|m|≤Rk
2−k
1−|m|2
R2
k
 n−1
2 |1−2
ϕεk(m)| ≤1.
This is possible, since for a ﬁxed Rk, the preceding sum tends to zero as εk →0.
Then for x ∈Ek we have
inf
x∈Ek
sup
R≤Rk
2−kB
n−1
2
R
(ϕεk)(x)
 ≥Ak +k +1.
(4.2.25)
The inductive selection of the parameters can be schematically described as follows:
{γk−1,Rk−1,Ek−1,εk−1} =⇒γk =⇒Ak =⇒{Rk,Ek} =⇒εk =⇒{γk,Rk,Ek,εk}.
Observe that the construction of γk gives for all s ≥k +1 the estimate
sup
x∈Tn sup
R≤Rk
|B
n−1
2
R
(ϕεs −ϕγs)(x)| ≤∑
|m|≤Rk
|Φ(εsm)−Φ(γsm)|
≤B(γs −εs) ∑
|m|≤Rk
|m|
≤Bγs ∑
|m|≤Rk
|m|
≤Bγk+1 ∑
|m|≤Rk
|m| = 1,
(4.2.26)
using (4.2.23) and the fact that the sequence γk is decreasing.

4.2 Divergence Theorems
269
We now prove (4.2.22). For x ∈Tn write
B
n−1
2
R
 ∞
∑
s=1
2−s(ϕεs−ϕγs)

(x) = B
n−1
2
R

−2−kϕγk +
k−1
∑
s=1
2−s(ϕεs−ϕγs)

(x)
+B
n−1
2
R

2−kϕεk

(x)
+B
n−1
2
R

∞
∑
s=k+1
2−s(ϕεs−ϕγs)

(x),
from which it follows that
sup
R≤Rk
B
n−1
2
R
 ∞
∑
s=1
2−s(ϕεs−ϕγs)

(x)
 ≥sup
R≤Rk
B
n−1
2
R

2−kϕεk

(x)

−sup
R≤Rk
B
n−1
2
R

−2−kϕγk +
k−1
∑
s=1
2−s(ϕεs−ϕγs)

(x)

−sup
R≤Rk
B
n−1
2
R

∞
∑
s=k+1
2−s(ϕεs−ϕγs)

(x)
.
In view of (4.2.25), (4.2.24), and (4.2.26) for all x ∈Ek, we obtain
sup
R≤Rk
B
n−1
2
R
 ∞
∑
s=1
2−s(ϕεs −ϕγs)

(x)
 ≥(Ak +k +1)−Ak −
∞
∑
s=k+1
2−s ≥k,
which clearly implies (4.2.22). Setting
f =
∞
∑
s=1
2−s(ϕεs −ϕγs) ∈L1(Tn),
we deduce that supR>0
B
n−1
2
R
( f)(x)
 ≥k for all x in ∞
r=k Er, and thus
sup
R>0
B
n−1
2
R
( f)(x)
 = ∞
for all x in
∞

k=1
∞

r=k
Er .
Since this set has full measure in Tn, the required conclusion follows.
By taking ε1 arbitrarily small (instead of picking ε1 = 1), we force f to be sup-
ported in an arbitrarily small neighborhood of the origin.
□
The previous argument shows that the Bochner–Riesz means Bα
R are badly be-
haved on L1(Tn) when α = n−1
2 . It follows that the “rougher” spherical Dirichlet
means
◦Dn
N ∗f (which correspond to α = 0) are also ill behaved on L1(Tn). See
Exercise 4.2.2.

270
4 Topics on Fourier Series
Exercises
4.2.1. Using Theorem 4.2.1 construct a function F on Tn such that
limsup
N→∞
|(Dn
N ∗F)(x1,...,xn)| = ∞
for almost all (x1,...,xn) ∈Tn.
4.2.2. For any 0 ≤α < ∞and R > 0 consider the Bochner–Riesz kernel
Kα
R (x) = ∑
|m|≤R

1−|m|2
R2
αe2πim·x .
Use Exercise 4.1.8 to obtain that if for some x0 ∈Tn we have
limsup
R→∞
|Kα
R (x0)| < ∞,
then for all β > α we have
sup
R>0
|Kβ
R (x0)| < ∞.
Conclude that whenever 0 ≤α ≤n−1
2 , the Bochner–Riesz means of order α of
the function f constructed in the proof of Theorem 4.2.5, in particular the circu-
lar (spherical) Dirichlet means of this function, diverge a.e.
4.2.3. (a) Show that for M,N positive integers we have
(FM ∗DN)(x) =
⎧
⎨
⎩
FM(x)
for M ≤N,
FN(x)+
M−N
(M+1)(N+1)
∑
|k|≤N
|k|e2πikx
for M > N.
(b) Prove that for some constant c > 0 we have

T1
 ∑
|k|≤N
|k|e2πikx
dx ≥cN logN
as N →∞.

Hint: Part (b): Show that for x ∈[−1
2, 1
2] we have
∑
|k|≤N
|k|e2πikx = (N +1)(DN(x)−FN(x))
and use the result of Exercise 3.1.5.


4.3 Multipliers, Transference, and A. E. Convergence
271
4.2.4. Given the integrable functions
f1(x) =
∞
∑
j=0
2−jF
222 j (x),
f2(x) =
∞
∑
j=1
1
j2 F22 j (x),
x ∈T1,
show that ∥f1 ∗DN∥L1 →∞and ∥f2 ∗DN∥L1 →∞as N →∞.

Hint: Let Mj = 222 j
or Mj = 22 j depending on the situation. For ﬁxed N let jN
be the least integer j such that Mj > N. Then for j ≥jN + 1 we have Mj ≥M2
jN >
N2 ≥2N +1, hence Mj−N
Mj+1 ≥1
2. Split the summation indices into the sets j ≥jN and
j < jN. Conclude that ∥f1 ∗DN∥L1 and ∥f2 ∗DN∥L1 tend to inﬁnity as N →∞using
Exercise 4.2.3.

4.3 Multipliers, Transference, and Almost Everywhere
Convergence
In Chapter 2 we saw that bounded operators from Lp(Rn) to Lq(Rn) that commute
with translations are given by convolution with tempered distributions on Rn. In par-
ticular, when p = q, these tempered distributions have bounded Fourier transforms,
called Fourier multipliers. Convolution operators that commute with translations
can also be deﬁned on the torus. These lead to Fourier multipliers on the torus.
4.3.1 Multipliers on the Torus
In analogy with the nonperiodic case, we could identify convolution operators on Tn
with appropriate distributions on the torus; see Exercise 4.3.2 for an introduction to
this topic. However, it is simpler to avoid this point of view and consider the study
of multipliers directly, bypassing the discussion of distributions on the torus.
For h ∈Tn we deﬁne the translation operator τh acting on a periodic function
f as follows: τh( f)(x) = f(x −h) for x ∈Tn. We say that a linear operator T act-
ing on functions on the torus commutes with translations if for all h ∈Tn we have
τh(T( f))(x) = T(τh f)(x) for almost all x ∈Tn.
Theorem 4.3.1. Suppose that T is a linear operator that commutes with translations
and maps Lp(Tn) to Lq(Tn) for some 1 ≤p,q ≤∞. Then there exists a bounded
sequence {am}m∈Zn such that
T( f)(x) = ∑
m∈Zn
am 1f(m)e2πim·x
(4.3.1)

272
4 Topics on Fourier Series
for all f ∈C ∞(Tn). Moreover, we have
{am}

ℓ∞≤
T

Lp→Lq .
Proof. Consider the functions em(x) = e2πim·x deﬁned on Tn for m in Zn. Since
T commutes with translations, for every h ∈Tn there is a subset Fh of Tn of full
measure such that
T(em)(x−h) = T(τh(em))(x) = e−2πim·hT(em)(x)
for every x ∈Fh. Note that

Tn |{h ∈Tn : x ∈Fh}|dx =

Tn

Tn χ{(h,x)∈Tn×Tn: x∈Fh} dhdx
=

Tn

Tn χ{(h,x)∈Tn×Tn: x∈Fh} dxdh
=

Tn |Fh|dh = 1.
Therefore there exists an x0 ∈Tn such that |{h ∈Tn : x0 ∈Fh}| = 1. It follows that
for almost all h ∈Tn we have T(em)(x0 −h) = e−2πim·hT(em)(x0). Replacing x0 −h
by x, we obtain
T(em)(x) = e2πim·x
e−2πim·x0T(em)(x0)

= amem(x)
(4.3.2)
for almost all x ∈Tn, where we set am = e−2πim·x0T(em)(x0), for m ∈Zn. Taking Lq
norms in (4.3.2), we deduce |am| = ∥T(em)∥Lq ≤∥T∥Lp→Lq, and thus am is bounded.
Moreover, since T(em) = amem for all m in Zn, it follows that (4.3.1) holds for all
trigonometric polynomials. By density this extends to all f ∈C ∞(Tn) and the theo-
rem is proved.
□
Deﬁnition 4.3.2. Let 1 ≤p,q ≤∞. We call a bounded sequence {am}m∈Zn an
(Lp,Lq) multiplier if the corresponding operator given by (4.3.1) maps Lp(Tn)
to Lq(Tn). If p = q, (Lp,Lp) multipliers are simply called Lp multipliers. When
1 ≤p < ∞, the space of all Lp multipliers on Tn is denoted by Mp(Zn). This no-
tation follows the convention that Mp( 1G) denote the space of Lp multipliers on
Lp(G), where G is a locally compact group and 1G is its dual group. The norm of
an element {am} in Mp(Zn) is the norm of the operator T given by (4.3.1) from
Lp(Tn) to itself. This norm is denoted by
{am}

Mp.
We now examine some special cases. We begin with the case p = q = 2. As
expected, it turns out that M2(Zn) = ℓ∞(Zn).
Theorem 4.3.3. A linear operator T that commutes with translations maps L2(Tn)
to itself if and only if there exists a sequence {am}m∈Zn in ℓ∞(Zn) such that
T( f)(x) = ∑
m∈Zn
am 1f(m)e2πim·x
(4.3.3)
for all f ∈C ∞(Tn). Moreover, in this case we have
T

L2→L2 =
{am}m

ℓ∞.

4.3 Multipliers, Transference, and A. E. Convergence
273
Proof. The existence of such a sequence is guaranteed by Theorem 4.3.1, which also
gives ∥{am}m∥ℓ∞≤∥T∥L2→L2. Conversely, any operator of the form (4.3.3) satisﬁes
T( f)
2
L2 = ∑
m∈Zn
|am 1f(m)|2 ≤
{am}m
2
ℓ∞∑
m∈Zn
| 1f(m)|2 ,
and thus ∥T∥L2→L2 ≤∥{am}m∥ℓ∞.
□
We continue with the case p = q = 1. Recall the deﬁnition of a ﬁnite Borel mea-
sure on Tn. Given such a measure μ, its Fourier coefﬁcients are deﬁned by
1μ(m) =

Tn e−2πix·m dμ(x),
m ∈Zn .
Clearly, all the Fourier coefﬁcients of the measure μ are bounded by the total vari-
ation
μ
 of μ. See Exercise 4.3.3 for basic properties of Fourier transforms of
distributions on the torus.
Theorem 4.3.4. A linear operator T that commutes with translations maps L1(Tn)
to itself if and only if there exists a ﬁnite Borel measure μ on the torus such that
T( f)(x) = ∑
m∈Zn
1μ(m) 1f(m)e2πim·x
(4.3.4)
for all f ∈C ∞(Tn). Moreover, in this case we have ∥T∥L1→L1 = ∥μ∥. In other words,
M1(Zn) is the set of all sequences given by Fourier coefﬁcients of ﬁnite Borel mea-
sures on Tn.
Proof. Fix f ∈L1(Tn). If (4.3.4) is valid, then 
T( f)(m) = 1f(m)1μ(m) for all m ∈Zn.
But Exercise 4.3.3 gives that 
f ∗μ(m) = 1f(m)1μ(m) for all m ∈Zn; therefore, the
integrable functions f ∗μ and T( f) have the same Fourier coefﬁcients, and they
must be equal. Thus T( f) = f ∗μ, which implies that T is bounded on L1 and
∥T( f)∥L1 ≤∥μ∥∥f∥L1.
To prove the converse direction, we suppose that T commutes with translations
and maps L1(Tn) to itself. We recall the Poisson kernel Pε deﬁned on Tn, which can
be expressed in the following two ways:
Pε(x) = ∑
m∈Zn
e−2π|m|εe2πim·x = Γ ( n+1
2 )
π
n+1
2
∑
m∈Zn
ε−n
(1+| x+m
ε |2)
n+1
2
≥0
(4.3.5)
for all x ∈Tn, in view of the identity obtained in (3.2.4). The preceding identity says
that Pε ≥0; hence, ∥Pε∥L1 =

Tn Pε(x)dx. Integrating the ﬁrst series in (4.3.5) over
Tn we conclude that ∥Pε∥L1(Tn) = 1. The boundedness of T now gives
T(Pε)

L1(Tn) ≤
T

L1→L1

274
4 Topics on Fourier Series
for all ε > 0. The Banach–Alaoglu theorem implies that there exist a sequence εj ↓0
and a ﬁnite Borel measure μ on Tn such that T(Pε j) tends to μ weakly as j →∞.
This means that for all continuous functions g on Tn we have
lim
j→∞

Tn g(x)T(Pε j)(x)dx =

Tn g(x)dμ(x).
(4.3.6)
It follows from (4.3.6) that for all g continuous on Tn we have


Tn g(x)dμ(x)
 ≤sup
j
T(Pε j)

L1
g

L∞≤
T

L1→L1
g

L∞.
Since, by the Riesz representation theorem we have that the norm of the linear func-
tional
g →

Tn g(x)dμ(x)
on the space of continuous functions C (Tn) is ∥μ∥, it follows that
∥μ∥≤
T

L1→L1.
(4.3.7)
It remains to prove that T has the form given in (4.3.4). By Theorem 4.3.1 we have
that there exists a bounded sequence {am} on Zn such that (4.3.1) is satisﬁed. Taking
g(x) = e−2πik·x in (4.3.6) and using the representation for T in (4.3.1), we obtain
1μ(k) =

Tn e−2πik·x dμ(x)
= lim
j→∞

Tn e−2πik·x ∑
m∈Zn
ame−2πε j|m|e2πim·x dx
= lim
j→∞∑
m∈Zn

Tn e−2πik·xame−2πε j|m|e2πim·x dx
= lim
j→∞ake−2πε j|k| = ak .
This proves assertion (4.3.4). It follows from (4.3.4) that T( f) = f ∗μ and thus
∥T∥L1→L1 ≤∥μ∥. This fact combined with (4.3.7) gives ∥T∥L1→L1 = ∥μ∥.
□
Remark 4.3.5. It is not hard to see that most basic properties of the space Mp(Rn)
of Lp Fourier multipliers on Rn are also valid for Mp(Zn). In particular, Mp(Zn) is
a closed subspace of ℓ∞(Zn) and thus a Banach space itself. Moreover, sums, scalar
multiples, and products of elements of Mp(Zn) are also in Mp(Zn), which makes
this space a Banach algebra. As in the nonperiodic case, we also have Mp(Zn) =
Mp′(Zn) when 1 < p < ∞.

4.3 Multipliers, Transference, and A. E. Convergence
275
4.3.2 Transference of Multipliers
It is clear by now that multipliers on L1(Tn) and L1(Rn) are very similar, and the
same is true for L2(Tn) and L2(Rn). These similarities became obvious when we
characterized L1 and L2 multipliers on both Rn and Tn. So far, it is not known if a
nontrivial characterization of Mp(Rn) exists, but we might ask whether this space is
related to Mp(Zn). There are several connections of this type and there are general
ways to produce multipliers on the torus from multipliers on Rn and vice versa.
General methods of this sort are called transference of multipliers.
We begin with a useful deﬁnition.
Deﬁnition 4.3.6. Let t0 ∈Rn. A bounded function b on Rn is called regulated at the
point t0 if
lim
ε→0
1
εn

|t|≤ε

b(t0 −t)−b(t0)

dt = 0.
(4.3.8)
The function b is called regulated if it is regulated at every t0 ∈Rn.
Clearly, if t0 is a Lebesgue point of b, then b is regulated at t0. In particular, this
is the case if b is continuous at t0. If b(t0) = 0, condition (4.3.8) also holds when
b(t0 −t) = −b(t0 +t) whenever |t| ≤ε for some ε > 0; for instance the function
b(t) = −isgn(t −t0) has this property.
An example of a regulated function is the following modiﬁcation of the charac-
teristic function of the cube [−1,1]n
#χ[−1,1]n(x1,...,xn) =
⎧
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎩
1
when all |xj| < 1,
2k−n
if (x1,...,xn) belongs to some k-dimensional
face of the boundary of [−1,1]n,
0
when some |xj| > 1,
with the understanding that points are zero-dimensional.
The ﬁrst transference result we discuss is the following.
Theorem 4.3.7. Suppose that b is a regulated function at every point m ∈Zn and
that b lies in Mp(Rn) for some 1 < p < ∞. Then the sequence {b(m)}m∈Zn is in
Mp(Zn) and moreover,
{b(m)}m∈Zn
Mp(Zn) ≤∥b∥Mp(Rn) .
If b is regulated everywhere, then for all R > 0 the sequences {b(m/R)}m∈Zn are
in Mp(Zn) and we have
sup
R>0
{b(m/R)}m∈Zn
Mp(Zn) ≤∥b∥Mp(Rn) .
The second conclusion of the theorem is a consequence of the ﬁrst, since for a
given R > 0 the function b(ξ/R) is regulated on Zn and has the same Mp(Rn) norm
as b(ξ). Before we prove this result, we state and prove a couple of lemmas.

276
4 Topics on Fourier Series
Lemma 4.3.8. Suppose that the function b on Rn is regulated at the point x0. Let
Kε(x) = ε−ne−π|x/ε|2 for ε > 0. Then we have that (b∗Kε)(x0) →b(x0) as ε →0.
Proof. For r > 0 deﬁne the function
Fx0(r) = 1
rn

|t|≤r

b(x0−t)−b(x0)

dt = 1
rn
 r
0

Sn−1

b(x0−sθ)−b(x0)

dθsn−1ds.
Let η > 0. Since b is regulated at x0 there is a δ > 0 such that for r ≤δ we have
|Fx0(r)| ≤η. Fix such a δ and write
(b∗Kε)(x0)−b(x0) =

y∈Rn

b(x0 −y)−b(x0)

Kε(y)dy = Aε
1 +Aε
2,
where
Aε
1 =

|y|≥δ

b(x0 −y)−b(x0)

Kε(y)dy
and
Aε
2 =

|y|<δ

b(x0 −y)−b(x0))Kε(y)

dy
=
 δ
0
1
εn e−π(r/ε)2 
Sn−1

b(x0 −rθ)−b(x0)

rndr
=
 δ
0
1
εn e−π(r/ε)2 d
dr(rnFx0(r))dr.
For our given η > 0 there is an ε0 > 0 such that for ε < ε0 we have
|Aε
1| ≤2∥b∥L∞

|y|≥δ
ε
e−π|y|2dy < η .
Via an integration by parts Aε
2 can be written as
|Aε
2| =
δ nFx0(δ) 1
εn e−π(δ/ε)2 −0+2π
 δ
0
r
εn+2 e−π(r/ε)2rnFx0(r)dr

=
Fx0(δ)δ n
εn e−π(δ/ε)2 +2π
 δ/ε
0
rn+1Fx0(εr)e−πr2dr

≤
Fx0(δ)
δ n
εn e−π(δ/ε)2 + sup
0<r≤δ
ε
|Fx0(εr)|2π
 δ/ε
0
rn+1e−πr2dr
≤
Fx0(δ)
Cn + sup
0<r≤δ
|Fx0(r)|C′
n
≤(Cn +C′
n)η ,
where we set Cn = supt>0tne−πt2 and C′
n = 2π
 ∞
0 rn+1e−πr2dr. Then for ε < ε0 we
have |(b∗Kε)(x0 −b(x0)| < (Cn +C′
n +1)η, thus (b∗Kε)(x0) →b(x0) as ε →0. □

4.3 Multipliers, Transference, and A. E. Convergence
277
Lemma 4.3.9. Let T be the operator on Rn whose multiplier is b(ξ), and let S be
the operator on Tn whose multiplier is the sequence {b(m)}m∈Zn. Assume that b(ξ)
is regulated at every point ξ = m ∈Zn. Suppose that P and Q are trigonometric
polynomials on Tn and let Lε(x) = e−πε|x|2 for x ∈Rn and ε > 0. Then the following
identity is valid whenever α,β > 0 and α +β = 1:
lim
ε→0ε
n
2

Rn T(PLεα)(x)Q(x)Lεβ(x)dx =

Tn S(P)(x)Q(x)dx.
(4.3.9)
Proof. It sufﬁces to prove the required assertion for P(x) = e2πim·x and Q(x) =
e2πik·x, k,m ∈Zn, since the general case follows from this case by linearity. In view
of Parseval’s relation (Proposition 3.2.7 (3)), we have

Tn S(P)(x)Q(x)dx = ∑
r∈Zn
b(r)1P(r) 1Q(r) =

b(m)
when k = m,
0
when k ̸= m.
(4.3.10)
On the other hand, using the identity in Theorem 2.2.14 (3), we obtain
ε
n
2

Rn T(PLεα)(x)Q(x)Lεβ(x)dx
= ε
n
2

Rn b(ξ)
PLεα(ξ) 
QLεβ(ξ)dξ
= ε
n
2

Rn b(ξ)(εα)−n
2 e−π |ξ−m|2
εα
(εβ)−n
2 e−π |ξ−k|2
εβ
dξ
= (εαβ)−n
2

Rn b(ξ)e−π |ξ−m|2
εα
e−π |ξ−k|2
εβ
dξ .
(4.3.11)
Now if m = k, since α +β = 1, the expression in (4.3.11) is equal to
(εαβ)−n
2

Rn b(ξ)e−π |ξ−m|2
εαβ dξ ,
(4.3.12)
which tends to b(m) in view of Lemma 4.3.8, since b is regulated at every point
m ∈Zn.
We now consider the case m ̸= k in (4.3.11). Since |m −k| ≥1, then every ξ in
Rn must satisfy either |ξ −m| ≥1/2 or |ξ −k| ≥1/2. Therefore, the expression in
(4.3.11) is controlled by
(εαβ)−n
2

|ξ−m|≥1
2
b(ξ)e−π
4εα e−π |ξ−k|2
εβ
dξ +

|ξ−k|≥1
2
b(ξ)e−π
4εβ e−π |ξ−m|2
εα
dξ

,
which is in turn controlled by
∥b∥L∞
α−n
2 e−π
4εα +β −n
2 e−π
4εβ 
,

278
4 Topics on Fourier Series
which tends to zero as ε →0. This proves that the expression in (4.3.10) is equal
to the limit of the expression in (4.3.11) as ε →0. This completes the proof of
Lemma 4.3.9
□
Proof (Theorem 4.3.7). We are assuming that T maps Lp(Rn) to itself and we need
to show that S maps Lp(Tn) to itself. We prove this using duality. For P and Q
trigonometric polynomials, using Lemma 4.3.9, we have


TnS(P)(x)Q(x)dx

=
 lim
ε→0ε
n
2

Rn T(PLε/p)(x)Q(x)Lε/p′(x)dx

≤
T

Lp→Lp limsup
ε→0
ε
n
2 PLε/p

Lp(Rn)
QLε/p′

Lp′(Rn)
=
T

Lp→Lp limsup
ε→0

ε
n
2

Rn|P(x)|pe−επ|x|2 dx
1
p
ε
n
2

Rn|Q(x)|p′e−επ|x|2 dx
 1
p′
=
T

Lp→Lp

Tn |P(x)|p dx
1
p 
Tn |Q(x)|p′ dx
 1
p′
,
provided for all continuous 1-periodic functions g on Rn we have that
lim
ε→0ε
n
2

Rn g(x)e−επ|x|2 dx =

Tn g(x)dx.
(4.3.13)
Assuming (4.3.13) for the moment, we take the supremum over all trigonometric
polynomials Q on Tn with Lp′ norm at most 1 to obtain that S maps Lp(Tn) to itself
with norm at most ∥T∥Lp→Lp, yielding the required conclusion.
We now prove (4.3.13). Use the Poisson summation formula to write the left-hand
side of (4.3.13) as
ε
n
2 ∑
k∈Zn

Tn g(x−k)e−επ|x−k|2 dx =

Tn g(x)ε
n
2 ∑
k∈Zn
e−επ|x−k|2 dx
=

Tn g(x) ∑
k∈Zn
e−π|k|2/εe2πix·k dx
=

Tn g(x)dx+Aε ,
where
|Aε| ≤
g

L∞∑
|k|≥1
e−π|k|2/ε →0
as ε →0. This completes the proof of Theorem 4.3.7.
□
We now obtain a converse of Theorem 4.3.7. If b(ξ) is a bounded function on Rn
and the sequence {b(m)}m∈Zn is in Mp(Zn), then we cannot necessarily obtain that

4.3 Multipliers, Transference, and A. E. Convergence
279
b is in Mp(Rn), since such a conclusion would depend on the values of b on the in-
teger lattice, which is a set of measure zero. However, a converse can be formulated
if we assume that for all R > 0, the sequences {b(m/R)}m∈Zn are in Mp(Zn) uni-
formly in R. Then we obtain that b(ξ/R) is in Mp(Rn) uniformly in R > 0, which is
equivalent to saying that b ∈Mp(Rn), since dilations of multipliers on Rn do not af-
fect their norms (see Proposition 2.5.14). These remarks can be precisely expressed
in the following theorem.
Theorem 4.3.10. Suppose that b(ξ) is a bounded function deﬁned on Rn which is
Riemann integrable over any cube. Suppose that the sequences {b( m
R )}m∈Zn are in
Mp(Zn) uniformly in R > 0 for some 1 < p < ∞. Then b is in Mp(Rn) and we have
∥b∥Mp(Rn) ≤sup
R>0
{b( m
R )}m∈Zn
Mp(Zn).
(4.3.14)
Proof. Suppose that f and g are smooth functions with compact support on Rn.
Then there is an R0 > 0 such that for R ≥R0, the functions x →f(Rx) and x →g(Rx)
are supported in [−1/2,1/2]n. We deﬁne periodic functions
FR(x) = ∑
k∈Zn
f(R(x−k))
and
GR(x) = ∑
k∈Zn
g(R(x−k))
on Tn. Observe that the mth Fourier coefﬁcient of FR is 2
FR(m) = R−n 1f(m/R) and
that of GR is 2
GR(m) = R−n1g(m/R).
Now for R ≥R0 we have
 ∑
m∈Zn
b(m/R) 1f(m/R)1g(m/R) Volume
 m
R +[0, 1
R]n
(4.3.15)
=
Rn ∑
m∈Zn
b(m/R)2
FR(m)2
GR(m)

=
Rn

Tn

∑
m∈Zn
b(m/R)2
FR(m)e2πim·x

GR(x)dx

≤Rn{b(m/R)}m

Mp(Zn)
FR

Lp(Tn)
GR

Lp′(Tn)
≤sup
R>0
{b(m/R)}m∈Zn
Mp(Zn) RnFR

Lp(Rn)
GR

Lp′(Rn)
= sup
R>0
{b(m/R)}m∈Zn
Mp(Zn)
f

Lp(Rn)
g

Lp′(Rn).
(4.3.16)
Since b is bounded and Riemann integrable over any cube in Rn, the function
b(ξ) 1f(ξ)1g(ξ) is Riemann integrable over Rn. The expressions in (4.3.15) are sums
associated with the partition {[ m
R , m+1
R )n}m∈Zn of Rn which tend to


Rn b(ξ) 1f(ξ)1g(ξ)dξ


280
4 Topics on Fourier Series
as R →∞by the deﬁnition of the Riemann integral. We deduce that the absolute
value of

Rn b(ξ) 1f(ξ)1g(ξ)dξ =

Rn(b 1f )∨(x)g(x)dx
is bounded by the expression in (4.3.16). This proves the theorem via duality.
□
4.3.3 Applications of Transference
Having established two main transference theorems, we turn to an application.
Corollary 4.3.11. Let 1 < p < ∞, f ∈Lp(Tn), and α ≥0. Then
(a)
Dn
R ∗f −f

Lp(Tn) →0 as R →∞if and only if χ[−1,1]n ∈Mp(Rn).
(b)
 ◦Dn
R ∗f −f

Lp(Tn) →0 as R →∞if and only if χB(0,1) ∈Mp(Rn).
(c)
Bα
R( f)−f

Lp(Tn) →0 as R →∞if and only if (1−|ξ|2)α
+ ∈Mp(Rn).
Proof. First observe that in view of Corollary 4.1.3, the assertions on the left in (a),
(b), and (c) are equivalent to the statements
sup
R>0
Dn
R ∗f

Lp(Tn) ≤Cp
f

Lp(Tn) ,
sup
R>0
 ◦Dn
R ∗f

Lp(Tn) ≤Cp
f

Lp(Tn) ,
sup
R>0
Bα
R( f)

Lp(Tn) ≤Cp
f

Lp(Tn) ,
for some constant 0 < Cp < ∞and all f in Lp(Tn). These statements can be
rephrased as
sup
R>0
{χ[−1,1]n(m/R)}m∈Zn
Mp(Zn) <∞,
sup
R>0
{χB(0,1)(m/R)}m∈Zn
Mp(Zn) <∞,
sup
R>0
{(1−|m/R|2)α
+}m∈Zn
Mp(Zn) <∞.
If these statements hold, then Theorem 4.3.10 gives that the functions χ[−1,1]n(ξ),
χB(0,1)(ξ), and (1−|ξ|2)α
+ lie in Mp(Rn).
To prove the converse implication, for any given R′ ∈R+ \ {|m| : m ∈Zn}, the
functions χ[−1,1]n(ξ/R′), χB(0,1)(ξ/R′) are Riemann integrable over Rn and are reg-
ulated (actually continuous) at every point in Zn. Moreover, the function (1−|ξ|2)α
+
is continuous, regulated, and Riemann integrable over Rn. Then the hypotheses of
Theorem 4.3.7 are satisﬁed and its conclusion yields that
{χ[−1,1]n(m/R′)}m∈Zn
Mp(Zn) ≤
χ[−1,1]n

Mp ,
(4.3.17)

4.3 Multipliers, Transference, and A. E. Convergence
281
{χB(0,1)(m/R′)}m∈Zn
Mp(Zn) ≤
χB(0,1)

Mp ,
(4.3.18)
sup
R>0
{(1−|m/R|2)α
+}m∈Zn
Mp(Zn) ≤
(1−| · |2)α
+

Mp.
Notice that the ﬁrst and second estimates are uniform in R′, so one may insert a
supremum over R′ ∈R+ \{|m| : m ∈Zn} in (4.3.17) and (4.3.18). To replace R′ by a
general R ∈Z+ simply notice that for any R > 0 there is an R′ ∈R+ \{|m| : m ∈Zn}
such that
Dn
R ∗f = Dn
R′ ∗f
and
◦Dn
R ∗f =
◦
Dn
R′ ∗f
for any f ∈Lp(Tn). Then using (4.3.17) we obtain
sup
R>0
Dn
R ∗f

Lp = sup
R>0
Dn
R′ ∗f

Lp = sup
R′>0
Dn
R′ ∗f

Lp ≤
χ[−1,1]n

Mp
f

Lp
and likewise for
◦Dn
R.
□
4.3.4 Transference of Maximal Multipliers
We now prove a theorem concerning maximal multipliers analogous to Theorems
4.3.7 and 4.3.10. This enables us to reduce problems related to almost everywhere
convergence of Fourier series on the torus to problems of boundedness of maximal
operators on Rn.
Let b be a bounded function deﬁned on all of Rn. For R > 0, we introduce the
multiplier operators
Sb,R(F)(x) = ∑
m∈Zn
b(m/R)1F(m)e2πim·x ,
(4.3.19)
Tb,R( f)(x) =

Rn b(ξ/R) 1f(ξ)e2πiξ·x dξ ,
(4.3.20)
initially deﬁned for smooth functions with compact support f on Rn and smooth
functions F on Tn.
We introduce the maximal operators
Mb(F)(x) = sup
R>0
Sb,R(F)(x)
,
(4.3.21)
Nb( f)(x) = sup
R>0
Tb,R( f)(x)
,
(4.3.22)
deﬁned for smooth functions F on Tn and smooth functions with compact support
f on Rn. Let τy(b)(ξ) = b(ξ −y) be a translation operator deﬁned for y ∈Rn. We
have the following result concerning these operators.
Theorem 4.3.12. Let b be a function deﬁned on Rn. Suppose that b is bounded,
regulated, Riemann integrable over any cube, and assume that for all ξ ∈Rn the

282
4 Topics on Fourier Series
function t →b(ξ/t) has only countably many discontinuities on R+. Let 1 < p < ∞
and Cp < ∞, and suppose that b lies in Mp(Rn). Let Mb and Nb be as in (4.3.21)
and (4.3.22). Then the following assertions are equivalent:
Mb(F)

Lp(Tn) ≤Cp
b

Mp
F

Lp(Tn) ,
F ∈C ∞(Tn),
(4.3.23)
Nb( f)

Lp(Rn) ≤Cp
b

Mp
 f

Lp(Rn) ,
f ∈C ∞
0 (Rn).
(4.3.24)
Proof. Let F = {t1,...,tk} be a ﬁnite subset of R+. We prove the claimed equiva-
lences for the maximal operators
MF
b (G)(x) = sup
t∈F
Sb,t(G)(x)
,
NF
b (g)(x) = sup
t∈F
Tb,t(g)(x)
,
with constants that are uniform in the ﬁnite set F. Then MF
b
may be viewed as
an operator deﬁned on the dense subspace C ∞(Tn) of Lp(Tn) and taking values in
Lp(Tn,ℓ∞(F)), which is the dual space of Lp′(Tn,ℓ1(F)). Likewise, NF
b is deﬁned
on the dense subspace C ∞
0 (Rn) of Lp(Rn) and takes values in Lp(Rn,ℓ∞(F)), which
is the dual space of Lp′(Rn,ℓ1(F)). Using duality, with respect to the complex inner
product, estimates (4.3.23) and (4.3.24) are equivalent to the pair of inequalities
 ∑
m∈Zn
1G(m)
k
∑
j=1
b
m
t j

1Fj(m)
 ≤Cp
b

Mp
G

Lp(Tn)

k
∑
j=1
|Fj|

Lp′(Tn) ,
(4.3.25)


Rn 1g(ξ)
k
∑
j=1
b
ξ
t j

1f j(ξ)dξ
 ≤Cp
b

Mp
g

Lp(Rn)

k
∑
j=1
| f j|

Lp′(Rn),
(4.3.26)
where g, f j ∈C ∞
0 (Rn), and G,Fj ∈C ∞(Tn). In proving the equivalence of (4.3.25)
and (4.3.26), by density, we work with smooth functions with compact support g, f j
and trigonometric polynomials G,Fj.
Suppose that (4.3.25) holds and let f1,..., fk,g be smooth functions with com-
pact support on Rn. Then there is an R0 > 0 such that for R ≥R0 the functions
Fj,R(x) = f j(Rx) and GR(x) = g(Rx) are supported in [−1/2,1/2]n and thus they
can be viewed as functions on Tn once they are periodized. Also, the mth Fourier
coefﬁcient of Fj,R is 3
Fj,R(m) = R−n 1f j(m/R) and that of GR is 2
GR(m) = R−n1g(m/R).
Since b lies in Mp(Rn) we have
∥b∥Mp(Rn) = sup
R>0
{b(m/R)}m∈Zn
Mp(Zn)
in view of Theorems 4.3.7 and 4.3.10, which are both applicable in view of the
hypotheses of b.

4.3 Multipliers, Transference, and A. E. Convergence
283
As in the proof of Theorem 4.3.10, for R ≥R0 we have
 ∑
m∈Zn
k
∑
j=1
b(m/Rt j)1f j(m/R)1g(m/R)Volume
 m
R +[0, 1
R]n
(4.3.27)
=
Rn ∑
m∈Zn
k
∑
j=1
b(m/Rt j)3
Fj,R(m)2
GR(m)

≤Cp∥b∥MpRn
k
∑
j=1
|Fj,R|

Lp′(Tn)
GR

Lp(Tn)
= Cp∥b∥Mp

k
∑
j=1
| f j|

Lp′(Rn)∥g∥Lp(Rn) ,
where we applied (4.3.25) in the ﬁrst inequality above for the function ξ →b(ξ/R),
which has the same Mp norm as b.
Since b is bounded and Riemann integrable over any cube in Rn, the functions
b(ξ/t j)1f j(ξ) 1gj(ξ) are Riemann integrable over Rn. Realizing the limit of the partial
sums in (4.3.27) when R →∞as a Riemann integral, we obtain


Rn
k
∑
j=1
b(ξ/t j) 1f j(ξ)1g(ξ)dξ
 ≤Cp
b

Mp

k
∑
j=1
| f j|

Lp′(Rn)∥g∥Lp(Rn)
and thus we showed that (4.3.25) implies (4.3.26).
We now turn to the converse. Assume that (4.3.26) holds. We will prove (4.3.25)
for trigonometric polynomials and then by density we extend it to all C ∞functions
on Tn. Expressing 1g in terms of g in (4.3.26) and taking the supremum in (4.3.26)
over all C ∞
0 functions g with Lp norm 1 we deduce that


Rn
k
∑
j=1
b
ξ
t j

1f j(ξ)e2πi(·)·ξ dξ

Lp′ ≤Cp
b

Mp

k
∑
j=1
| f j|

Lp′(Rn) .
(4.3.28)
Let P1,...,Pk and Q be trigonometric polynomials on Tn. Set Lε(x) = e−πε|x|2.
Since b is regulated at every point in Rn, Lemma 4.3.9 gives
 ∑
m∈Zn
k
∑
j=1
1Q(m)b(m/t j) 1Pj(m)

=


Tn

∑
m∈Zn
k
∑
j=1
1Pj(m)b(m/t j)e2πim·x

Q(x)dx

=
 lim
ε→0ε
n
2

Rn

Rn
k
∑
j=1

PjLε/p′(ξ)b(ξ/t j)e2πiξ·xdξ

Q(x)Lε/p(x)dx


284
4 Topics on Fourier Series
≤Cp∥b∥Mp limsup
ε→0

ε
n
2

k
∑
j=1
PjLε/p′


Lp′(Rn)
QLε/p

Lp(Rn)

= Cp∥b∥Mp limsup
ε→0

ε
n
2p′
 k
∑
j=1
Pj


Lε/p′

Lp′(Rn)

ε
n
2

Rn|Q(x)|pe−επ|x|2dx
1
p 
= Cp∥b∥Mp

k
∑
j=1
Pj


Lp′(Rn)
Q

Lp(Tn),
where we used H¨older’s inequality and (4.3.28) in the only inequality above and
(4.3.13) in the last equality. Thus we obtain that (4.3.26) implies (4.3.25), and this
completes the equivalence of boundedness of MF
b and NF
b .
We now prove the claimed equivalence for the operators Mb and Nb. We ﬁrst
show that if MF
b
is bounded on (C ∞(Tn),∥· ∥Lp) with bound independent of the
ﬁnite set F, then Mb is bounded on (C ∞(Tn),∥·∥Lp).
For each ξ ∈Rn, let Aξ be the null subset of R+ such that t →b(ξ/t) is contin-
uous on R+ \Aξ. We ﬁx a function F in C ∞(Tn), and we note that for each x ∈Tn
the function
t →Sb,t(F)(x) = ∑
m∈Zn
b(m/t)1F(m)e2πim·x
(4.3.29)
is continuous on the set R+ \ 
m∈Zn Am. We pick a countable dense subset D′ of
R+ \ 
m∈Zn Am, and we let D = D′ ∪
m∈Zn Am. Then D is a countable set and the
Lebesgue monotone convergence theorem gives that
sup
t∈D
|Sb,t(F)|

Lp(Tn) = lim
k→∞
MFk
b (F)

Lp(Tn) ≤Cp∥b∥Mp
F

Lp(Tn) ,
(4.3.30)
where Fk is an increasing sequence of ﬁnite sets whose union is D. Using that the
function in (4.3.29) is continuous on R+ \ D, we conclude that the supremum over
t ∈D in (4.3.30) can be replaced by the supremum over t ∈Z+ (Exercise 4.3.7).
Assume now that NF
b
is bounded on (C ∞
0 (Rn),∥· ∥Lp) with bound independent
of the ﬁnite set F. We show that Nb is bounded on (C ∞
0 (Rn),∥· ∥Lp). Let f be in
C ∞
0 (Rn). We have that the map
t →Tb,t( f)(x) =

Rn b(ξ/t) 1f(ξ)e2πiξ·x dξ = tn

Rn b(ξ) 1f(tξ)e2πiξ·tx dξ
(4.3.31)
is a continuous function on R+ since 1f is continuous. Thus the estimate
sup
t∈D
|Tb,t( f)|

Lp(Rn) ≤Cp∥b∥Mp
f

Lp(Rn)
(4.3.32)
for a countable dense subset D of R+ (such as D = Q+) can be easily extended by
replacing the supremum over D by the supremum over R+. And estimate (4.3.32)
for D = Q+ follows from the corresponding estimate on ﬁnite sets via the Lebesgue
monotone convergence theorem.
□

4.3 Multipliers, Transference, and A. E. Convergence
285
Remark 4.3.13. Under the hypotheses of Theorem 4.3.12, the following two in-
equalities are also equivalent:
Mb(G)

Lp,∞(Tn) ≤Cp∥b∥Mp
G

Lp(Tn) ,
G ∈C ∞(Tn),
(4.3.33)
Nb(g)

Lp,∞(Rn) ≤C′
p∥b∥Mp∥g∥Lp(Rn) ,
g ∈C ∞
0 (Rn),
(4.3.34)
with C′
p ≤Cp ≤C(n, p)C′
p for some other constant C(n, p). Indeed, Exercise 1.4.12
gives that the pair of inequalities (4.3.33) and (4.3.34) is equivalent to the pair of
inequalities
 ∑
m∈Zn
k
∑
j=1
1Fj(m)b(m/t j) 1G(m)
 ≤Cp∥b∥Mp
G

Lp(Tn)

k
∑
j=1
|Fj|

Lp′,1(Tn) , (4.3.35)


Rn
k
∑
j=1
1f j(ξ)b(ξ/t j)1g(ξ)dξ
 ≤C′
p∥b∥Mp∥g∥Lp(Rn)

k
∑
j=1
| f j|

Lp′,1(Rn) ,
(4.3.36)
where Lp′,1 is the Lorentz space and f j ∈C ∞
0 (Rn) and Fj ∈C ∞(Tn).
Now (4.3.36) follows from (4.3.35) just like (4.3.26) follows from (4.3.25) with
the only exception being that H¨older’s inequality for Lp and Lp′ is replaced by
H¨older’s inequality for Lp,∞and Lp′,1 and we use that ∥g∥Lp,∞≤∥g∥Lp. Conversely,
assuming (4.3.36), in order to prove (4.3.35) it will sufﬁce to know that
sup
0<ε<1
ε
n
2q

 k
∑
j=1
Pj


Lε/q

Lq,1(Rn) ≤C(n,q)

k
∑
j=1
Pj


Lq,1(Tn) .
(4.3.37)
For this we refer to Exercise 4.3.6.
4.3.5 Applications to Almost Everywhere Convergence
As an application of the preceding results, we relate the almost everywhere conver-
gence of Fourier series of functions on T1 with the almost everywhere convergence
of Fourier integrals of functions on R. In this subsection we show that the following
two results are equivalent:
Theorem 4.3.14. For every 1 < p < ∞there exists a ﬁnite constant Cp such that for
all F ∈C ∞(T1) we have
 sup
N∈Z+ |F ∗DN|

Lp ≤Cp
F

Lp.
(4.3.38)
Theorem 4.3.15. For every 1 < p < ∞there exists a ﬁnite constant Cp such that for
all f ∈C ∞
0 (R) we have
C∗∗( f)

Lp(R) ≤Cp∥f∥Lp(R)
(4.3.39)

286
4 Topics on Fourier Series
where
C∗∗( f)(x) = sup
R>0


|ξ|≤R
1f(ξ)e2πixξ dξ

is the Carleson operator.
As a consequence of Theorem 4.3.14, we obtain that for any F ∈Lp(T1), we have
lim
N→∞∑
|m|≤N
1F(m)e2πimx = F(x)
for almost every x ∈[0,1].
Theorem 4.3.14 can be proved directly, but we do not pursue this here. Instead,
we show the equivalence of the two theorems and refer the interested reader to [131],
which contains the proof of Theorem 4.3.15.
We observe that both operators F →C∗(F) = supN>0 |F ∗DN| and f →C∗∗( f)
are sublinear and take nonnegative values. Thus they satisfy the inequalities
|C∗(F)−C∗(G)| ≤C∗(F −G)
|C∗∗( f)−C∗∗(g)| ≤C∗∗( f −g)
for all F,G in C ∞(T1) and f,g in C ∞
0 (R). Then, by density (see the argument in
the proof of Theorem 1.4.19 or Exercise 1.4.17), they admit bounded extensions to
Lp(T1) and Lp(R), respectively, so that (4.3.38) and (4.3.39) hold for all F ∈Lp(T1)
and f ∈Lp(R).
Next, we discuss the details of the transference argument that claims the equiva-
lence of Theorems 4.3.14 and 4.3.15.
Consider the following function deﬁned on R:
b(x) =
⎧
⎪
⎨
⎪
⎩
1
when |x| < 1,
1/2
when |x| = 1,
0
when |x| > 1.
(4.3.40)
Then b is bounded and Riemann integrable over any interval, and is easily seen to
be regulated; also, given any x ∈R, the function t →b(x/t) is discontinuous only
for t ∈{x,−x}.
Let Sb,R be as in (4.3.19), where b is deﬁned in (4.3.40). We note that inequality
(4.3.38) is equivalent to
sup
R>0
|Sb,R(F)|

Lp ≤C′
p
F

Lp
(4.3.41)
for all F ∈C ∞(T1), where {DR}R>0 is the family of Dirichlet kernels as deﬁned in
(3.1.16), depending on the continuous parameter R. Indeed, we have

4.3 Multipliers, Transference, and A. E. Convergence
287
Sb,R(F)(x) =
⎧
⎪
⎪
⎨
⎪
⎪
⎩
∑|m|≤[R] 1F(m)e2πimx
if R /∈Z+,
(DR−1 ∗F)(x)+
1F(R)e2πixR+ 1F(−R)e−2πixR
2
if R ∈Z+.
(4.3.42)
Since supR>0 |1F(±R)| ≤∥F∥L1 ≤∥F∥Lp, it follows that if (4.3.38) holds, then
(4.3.41) also holds with C′
p = Cp +1.
The only hypothesis of Theorem 4.3.12 missing is that b lies in Mp(R). We
obtain this from the fact that supR>0 ∥b(·/R)∥Mp(Z) < ∞via Theorem 4.3.10, since
sup
R>0
F ∗DR

Lp(T1) = sup
N∈Z+
F ∗DN

Lp(T1) ≤C′′
p
F∥Lp(T1) ,
(4.3.43)
where the last estimate follows from Proposition 4.1.6, Theorem 4.1.7, and Corollary
4.1.3. The preceding equality is due to the fact that DR = DR+ε whenever 0 < ε < 1.
Now all hypotheses of Theorem 4.3.12 are valid. As a consequence we obtain the
equivalence of the boundedness of the the maximal operator
Nb( f)(x) = C∗∗( f)(x) = sup
R>0

 +R
−R
1f(ξ)e2πixξ dξ

on Lp(R) and of
Mb(F)(x) = sup
R>0
 ∑
m∈Z
1F(m)e2πimxb
m
R
 = sup
R>0
|Sb,R(F)(x)|,
on Lp(T1). But in view of (4.3.42) and of the fact that supR>0 |1F(±R)| ≤∥F∥Lp, the
Lp boundedness of Mb is equivalent to the Lp boundedness of C∗on Lp(T1). This
discussion concludes the equivalence of Theorems 4.3.14 and 4.3.15.
4.3.6 Almost Everywhere Convergence of Square Dirichlet Means
The extension of Theorem 4.3.14 to higher dimensions is a rather straightforward
consequence of the one-dimensional result.
Theorem 4.3.16. For every 1 < p < ∞, there exists a ﬁnite constant Cp,n such that
for all f ∈Lp(Tn) we have
 sup
N>0
|Dn
N ∗f|

Lp(Tn) ≤Cp,n
f

Lp(Tn)
(4.3.44)
and consequently
lim
N→∞∑
m∈Zn
|mj|≤N
1f(m)e2πim·x = f(x)
for almost every x ∈Tn and f ∈Lp(Tn).

288
4 Topics on Fourier Series
Proof. We prove Theorem 4.3.16 when n = 2. Fix a p with 1 < p < ∞. Since the
Riesz projection P+ is bounded on Lp(T1) (Theorem 4.1.7 and identity (4.1.9)), ap-
plying Theorem 4.3.10 with b(ξ) = χ(0,∞), we obtain that that the function χ(0,∞)
is in Mp(R). It follows that the characteristic function of the half-space ξ1 > 0 in
R2 lies in Mp(R2). Since rotations and translations of multipliers preserve their
Mp norms (Proposition 2.5.14), it follows that the characteristic function of any half
space created by a line in R2 lies in Mp(R2) with a ﬁxed norm. The product of three
multipliers is a multiplier (Proposition 2.5.13); thus the characteristic function of the
triangle T created by the lines ξ2 = ξ1 −1
4, ξ2 = −ξ1 −1
4, ξ2 = L + 1
4 lies also in
Mp(R2) with norm independent of L ∈Z+. The regulated function
σ(ξ1,ξ2) =
⎧
⎪
⎪
⎪
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎪
⎪
⎪
⎩
1
if (ξ1,ξ2) ∈T \∂T
0
if (ξ1,ξ2) /∈T
1
2
if (ξ1,ξ2) ∈∂T \{(0,−1
4),(L+ 1
2,L+ 1
4),(−L−1
2,L+ 1
4)}
1
8
if (ξ1,ξ2) ∈{(L+ 1
2,L+ 1
4),(−L−1
2,L+ 1
4)}
1
4
if (ξ1,ξ2) = (0,−1
4)
is a.e. equal to the characteristic function of T. Thus Theorem 4.3.7 gives that the
restriction of σ on Z2, i.e., the sequence {am1,m2}m1,m2 deﬁned by am1,m2 = 1 when
|m1| ≤|m2| ≤L and zero otherwise, lies in Mp(Z2) with norm independent of L in
Z+. This means that for some constant Bp we have the following inequality for all f
in Lp(T2):

T2
 ∑
m2∈Z
|m2|≤L
∑
m1∈Z
|m1|≤|m2|
1f(m1,m2)e2πi(m1x1+m2x2)

p
dx2 dx1 ≤Bp
p
f
p
Lp(T2) ,
(4.3.45)
where Bp is independent of L ∈Z+. There is also a a version of (4.3.45), proved
similarly, in which |m1| ≤|m2| is replaced by the strict inequality |m1| < |m2|.
Now let 1 < p < ∞, L ∈Z+, and f ∈Lp(T2). For ﬁxed x1 ∈T1 deﬁne
f L
x1(x2) = ∑
m2∈Z
|m2|≤L

∑
m1∈Z
|m1|≤|m2|
1f(m1,m2)e2πim1x1

e2πim2x2 = ∑
m2∈Z
|m2|≤L
2
f Lx1(m2)e2πim2x2
and for ﬁxed x2 ∈T1 deﬁne
f x2
L (x1) = ∑
m1∈Z
|m1|≤L

∑
m2∈Z
|m2|<|m1|
1f(m1,m2)e2πim2x2

e2πim1x1 = ∑
m1∈Z
|m1|≤L
2
f x2
L (m1)e2πim1x1 .

4.3 Multipliers, Transference, and A. E. Convergence
289
We have

T1

T1 sup
0<N≤L
 ∑
|m1|≤N ∑
|m2|≤N
1f(m1,m2)e2πim1x1e2πim2x2

p
dx2 dx1
≤2p−1

T1

T1 sup
0<N≤L
 ∑
|m2|≤N

∑
|m1|≤|m2|
1f(m1,m2)e2πim1x1

e2πim2x2

p
+ sup
0<N≤L
 ∑
|m1|≤N

∑
|m2|<|m1|
1f(m1,m2)e2πim2x2

e2πim1x1

p
dx1 dx2
= 2p−1

T1

T1 sup
0<N≤L
(DN ∗f L
x1)(x2)
p dx2 dx1
+

T1

T1 sup
0<N≤L
(DN ∗f x2
L )(x1)
p dx1 dx2

≤2p−1

T1

T1 sup
N∈Z+
(DN ∗f L
x1)(x2)
p dx2dx1
+

T1

T1 sup
N∈Z+
(DN ∗f x2
L )(x1)
p dx1 dx2

≤2p−1Cp
p

T1

T1 | f L
x1(x2)|p dx2 dx1 +2p−1Cp
p

T1

T1 | f x2
L (x1)|p dx1 dx2
≤2pCp
pBp
p
 f
p
Lp(T2),
where we used Theorem 4.3.14 in the penultimate inequality and estimate (4.3.45)
in the last inequality. Since the last estimate we obtained is independent of L ∈Z+,
letting L →∞and applying Fatou’s lemma, we obtain the conclusion (4.3.44) for
n = 2. When n ≥3 the idea of the proof is similar, but the notation a bit more
cumbersome.
□
Exercises
4.3.1. Let α ≥0. Prove that the function (1−|ξ|2)α
+ is in Mp(Rn) if and only if the
function (1−|ξ|)α
+ is in Mp(Rn).

Hint: Use that smooth functions with compact support lie in Mp(Rn).

4.3.2. The purpose of this exercise is to introduce distributions on the torus. The
set of test functions on the torus is C ∞(Tn) equipped with the following topology.
Given f j, f in C ∞(Tn), we say that f j →f in C ∞(Tn) if
∂α f j −∂α f

L∞(Tn) →0
as j →∞, ∀α.
Under this notion of convergence, C ∞(Tn) is a topological vector space with topol-
ogy induced by the family of seminorms ρα(ϕ) = supx∈Tn |(∂α f)(x)|, where α

290
4 Topics on Fourier Series
ranges over all multi-indices. The dual space of C ∞(Tn) under this topology is the
set of all distributions on Tn and is denoted by D′(Tn). The deﬁnition implies that
for uj and u in D′(Tn) we have uj →u in D′(Tn) if and only if
4
uj, f
5
→
4
u, f
5
as j →∞for all f ∈C ∞(Tn).
The following operations can be deﬁned on elements of D′(Tn): differentiation (as
in Deﬁnition 2.3.6), translation and reﬂection (as in Deﬁnition 2.3.11), convolution
with a C ∞function (as in Deﬁnition 2.3.13), multiplication by a C ∞function (as
in Deﬁnition 2.3.15), the support of a distribution (as in Deﬁnition 2.3.16). Use the
same ideas as in Rn to prove the following:
(a) Prove that if u ∈D′(Tn) and f ∈C ∞(Tn), then ( f ∗u)(x) = ⟨u,τx( #f )⟩is a C ∞
function.
(b) In contrast to Rn, the convolution of two distributions on Tn can be deﬁned. For
u,v ∈D′(Tn) and f ∈C ∞(Tn) deﬁne
4
u∗v, f
5
=
4
u, f ∗#v
5
.
Check that convolution of distributions on D′(Tn) is associative, commutative, and
distributive.
(c) Prove the analogue of Proposition 2.3.23, i.e., that C ∞(Tn) is dense in D′(Tn).
4.3.3. For u ∈D′(Tn) and m ∈Zn deﬁne the Fourier coefﬁcient 1u(m) by
1u(m) = u(e−2πim·(·)) =
4
u,e−2πim·(·)5
.
Prove properties (1), (2), (4), (5), (6), (8), (9), (11), and (12) of Proposition 2.3.22
regarding the Fourier coefﬁcients of distributions on the circle. Moreover, prove that
for any u, v in D′(Tn) we have (u ∗v)1(m) = 1u(m)1v(m). In particular, this is valid
for ﬁnite Borel measures.
4.3.4. Let μ be a ﬁnite Borel measure on Rn and let ν be the periodization of μ,
that is, ν is a measure on Tn deﬁned by
ν(A) = ∑
m∈Zn
μ(A+m)
for all measurable subsets A of Tn. Prove that the restriction of the Fourier transform
of μ on Zn coincides with the sequence of the Fourier coefﬁcients of the measure ν.
4.3.5. Let vn be the volume of the unit ball in Rn and e1 = (1,0,...,0). Prove that
lim
ε→0
1
vnεn

|x−e1|≤ε χ|x|≤1 dx = 1
2 .

4.3 Multipliers, Transference, and A. E. Convergence
291
Conclude that the function
#χB(0,1)(x) =
⎧
⎪
⎨
⎪
⎩
1
when |x| < 1,
1/2
when |x| = 1,
0
when |x| > 1
is regulated.
4.3.6. Let Lε(x) = e−πε|x|2 be deﬁned for ε > 0 and x ∈Rn and let 1 < q < ∞.
Prove that there is a constant C(n,q) < ∞such that for any 1-periodic continuous
function g on Rn we have
sup
0<ε<1
ε
n
2q gLε/q

Lq,1(Rn) ≤C(n,q)∥g∥Lq,1(Tn) .

Hint: Reduce matters to the situation where g = ∑k∈Zn χk+E, where E is a measur-
able subset of [−1/2,1/2)n. Express the Lq,1 norm of gLε/q in terms of its distribu-
tion function and for 0 < λ < 1 estimate the measure
{Lε/q > λ}
 
k∈Zn
(k +E)
=
B

0,
 q
πε log 1
λ
 1
2  
k∈Zn
(k +E)

by Cn
√n+
 q
πε log 1
λ
1/2)n |E|.

4.3.7. Let 0 < C0 < ∞. Suppose that {ft}t∈R+ is a family of measurable functions
on a measure space X that satisﬁes
sup
t∈F
| ft|

Lp ≤C0
for every ﬁnite subset F of R+.
(a) Suppose that for each x ∈X, the function t →ft(x) is continuous. Show that
sup
t>0
| ft|

Lp ≤C0 .
(b) Prove that for any t > 0 there is a measurable function #ft on X that is a.e. equal
to ft such that
 sup
t∈R+ | #ft|

Lp ≤C0 .

Hint: Part (a): Notice that in view of the Lebesgue monotone convergence theo-
rem, we have
supt∈Q | ft|

Lp ≤C0. Also, for each x ∈X we have supt∈Q | ft(x)| =
supt∈R+ | ft(x)| by continuity. Part (b): Let a = supF ∥supt∈F | ft|∥Lp ≤C0, where the
supremum is taken over all ﬁnite subsets F of R. Pick an increasing sequence of
ﬁnite sets Fn such that ∥supt∈Fn | ft|∥Lp →a as n →∞. Let g = supn supt∈Fn | ft| and
note that ∥g∥Lp = a. Then for any s ∈R we have

292
4 Topics on Fourier Series
max(| fs|,sup
t∈Fk
| ft|)

Lp ≤a.
This implies ∥max(| fs|,g)∥Lp ≤a = ∥g∥Lp, so that | fs| ≤g a.e. for all s ∈R.

4.3.8. (E. Prestini) Show that for f ∈L2(T2) we have that
∑
|m1|≤N
|m2|≤N2
1f(m1,m2)e2πi(m1x1+m2x2) →f(x1,x2)
for almost all (x1,x2) in T2.

Hint: Use the splitting 1f(m1,m2) = 1f(m1,m2)χ|m2|≤|m1|2 + 1f(m1,m2)χ|m2|>|m1|2
and apply the idea of the proof of Theorem 4.3.16.

4.4 Applications to Geometry and Partial Differential Equations
In this section we discuss two applications of Fourier series. The ﬁrst concerns a
classical result in planar geometry and the other the heat equation.
4.4.1 The Isoperimetric Inequality
Suppose we are given a closed positively oriented nonself intersecting C 1 curve C
in the (x,y) plane of length L that encloses a region R of area A. The curve can be
described in terms of its parametric equations x = x(t) and y = y(t), where t ∈[0,1].
Since the curve is closed, we have (x(0),y(0)) = (x(1),y(1)) and the C 1 functions
x(t),y(t) can be thought of as 1-periodic functions on the circle. The perimeter L of
the curve is given by the equation
L =
 1
0
!
|x′(t)|2 +|y′(t)|2 dt
while the area of the region R enclosed by the curve is equal to
A =

R 1dxdy
=

R
∂
∂x
x
2 −∂
∂y

−y
2

dxdy
=1
2
<
C xdy−ydx
=1
2
 1
0 x(t)y′(t)−x′(t)y(t)dt ,
where we made use of Green’s theorem in the third equality above.

4.4 Applications to Geometry and Partial Differential Equations
293
A C 1 curve γ(t) is regular if γ′(t) ̸= 0 for all t. We have the following result
relating the perimeter and the enclosed area of a region enclosed by a closed C 1
curve.
Theorem 4.4.1. Given a closed, positively oriented, nonself intersecting, regular,
C 1 planar curve of length L that encloses a region of area A, we have that
A ≤L2/4π
(4.4.1)
with equality holding if and only if the curve is a circle.
Proof. Assume that the curve has parametric equations x = x(t), y = y(t), 0 ≤t ≤1.
We may assume that the curve has constant speed, i.e., it satisﬁes
!
|x′(t)|2 +|y′(t)|2 = L
for all t ∈[0,1]. This is achieved via the reparametrization of the curve in terms of
the inverse function s−1(t) = γ(t) of the normalized arc length function
s(t) = 1
L
 t
0
!
|x′(u)|2 +|y′(u)|2 du.
Since |(x′(t),y′(t))| ̸= 0, t →s(t) is a one-to-one and onto continuous map from
[0,1] to [0,1]. Then the curve t →(x(γ(t)),y(γ(t))) has constant speed, since
|x′(γ(t))|2|γ′(t)|2 +|y′(γ(t))|2|γ′(t)|2 = |x′(s−1(t))|2 +|y′(s−1(t))|2
|s′(s−1(t))|2
= L2 .
So we can replace the map (x(t),y(t)) by (x(γ(t)),y(γ(t))) which produces the same
curve. Let
f(t) = x(t)+iy(t)
for t ∈[0,1]. Then in view of the preceding discussion, we may assume that the
function f(t) = x(t)+iy(t) satisﬁes | f ′(t)| = L for all t ∈[0,1].
Under the assumption | f ′(t)| = L for all t ∈[0,1], we now show that (4.4.1) holds,
with equality if and only if f(t) = c0e2πit +C0 for some c0,C0 ∈C with |c0| = L
2π .
To prove this claim we argue as follows:
A = 1
2 Im
 1
0 f ′(t) f(t)dt
= 1
2 Im
 1
0 f ′(t)

f(t)−1f(0)

dt
≤1
2 L
 f −1f(0)

L2
≤L
2
1
2π
 f ′
L2
= L2
4π ,

294
4 Topics on Fourier Series
establishing (4.4.1), but we need to explain why the inequality
∥f −1f(0)∥L2 ≤1
2π ∥f ′∥L2
(4.4.2)
is valid. Indeed, we have
f ′(t) = ∑
m∈Z
2πim 1f(m)e2πimt
where the series converges in L2. Thus we have
f ′
L2 = 2π

∑
m∈Z
|m 1f(m)|2
 1
2
≥2π

∑
m∈Z\{0}
| 1f(m)|2
 1
2
= 2π
f−1f(0)

L2 , (4.4.3)
which proves (4.4.2).
Now suppose that equality holds in (4.4.1), then we must have equality in (4.4.2)
and thus in (4.4.3), which implies that 1f(m) = 0 when |m| ≥2; hence for all t ∈[0,1]
we must have
f(t) = ce2πit +c′e−2πit + 1f(0)
(4.4.4)
where c,c′ are complex numbers. But since ∥f ′∥L2 = L, it follows that
4π2(|c|2 +|c′|2) = L2 ,
(4.4.5)
and since | f ′(t)| = L for all t ∈[0,1], it follows that
 L
2π
2
= |c|2 +|c′|2 −2Re

cc′e2πi2t
(4.4.6)
for all t ∈[0,1]. Combining (4.4.5) and (4.4.6) we obtain
Re

cc′e2πi2t
= 0.
(4.4.7)
Inserting t = 0 and t = 1/8 in (4.4.7) and using that Im(iz) = −Rez, we deduce that
Recc′ = Imcc′ = 0. This implies that either c or c′ is zero. In either case (4.4.4) and
(4.4.5) imply that f(t) is a circle of radius L/2π centered at the point 1f(0).
□
4.4.2 The Heat Equation with Periodic Boundary Condition
Let k > 0 be a ﬁxed quantity. Consider the partial differential equation
∂
∂t F(x,t) = k
n
∑
j=1
∂2
∂x2
j
F(x,t)
t ∈(0,∞),
x ∈Rn ,
(4.4.8)

4.4 Applications to Geometry and Partial Differential Equations
295
which is called the heat equation. Assume that there is an initial condition
F(0,x) = f(x)
x ∈Rn
(4.4.9)
for a given C ∞function f on Rn which is assumed to be 1-periodic in every variable.
We would like to ﬁnd a continuous function F(t,x) on [0,∞) × Rn which is C ∞
on (0,∞)×Rn such that
F(t,x+ej) = F(t,x)
for all t ≥0 and all ej = (0,...,0,1,0,...,0), so that F solves the equation (4.4.8).
The function F(t,x) represents the temperature of a body at time t > 0 at the
location (x1,...,xn). Since the initial temperature f is 1-periodic in each variable,
we expect F(t,·) to also be periodic in each variable. For example, F(t,x) is a good
model for the temperature of the torus {(e2πix1,...,e2πixn) : xj ∈R} at time t > 0,
given that its temperature at time t = 0 is f(x). When n = 1, F(t,x) models the
temperature of a inﬁnitesimally thin ring, thought of as the unit circle, at time t > 0
at the location e2πix.
Let us suppose there is a continuous function F(t,x) on [0,∞)×Rn which is C ∞
on (0,∞) × Rn that solves the equation (4.4.8) and satisﬁes F(t,x + ej) = F(t,x)
for all x ∈Rn and t ≥0. Denote by cm(t) the Fourier coefﬁcient of the function
x →F(t,x) deﬁned by
cm(t) =

Tn F(t,x)e−2πim·x dx.
Then cm(t) is a continuous function on [0,∞) since F is continuous in the variable
t. For the same reason, cm is a smooth function on (0,∞) whose jth derivative is
given by
d j
dt j cm(t) =

Tn
∂j
∂t j F(t,x)e−2πim·x dx
for any j = 1,2,.... Using equation (4.4.8) we obtain that
c′
m(t) =

Tn
∂
∂t F(t,x)e−2πim·x dx =

Tn k ∂2
∂2xF(t,x)e−2πim·x dx = −4π2|m|2kcm(t),
where the last identity is due to an integration by parts in which the boundary terms
cancel each other in view of the periodicity of the integrand in x. Also cm(0) = 1f(m).
The ordinary differential equation c′
m(t) = −4π2|m|2kcm(t) with initial condition
cm(0) = 1f(m) is easily solved by separating the variables
dcm(t)
cm(t) = −4π2|m|2kdt ,
(4.4.10)
yielding the solution
cm(t) = 1f(m)e−4π2|m|2kt .

296
4 Topics on Fourier Series
We may therefore deﬁne the function
F(t,x) = ∑
m∈Zn
1f(m)e−4π2|m|2kte2πim·x
(4.4.11)
on [0,∞)×Rn and observe the following:
(a) F is continuous on [0,∞)×Rn and C ∞on (0,∞)×Rn.
(b) F satisﬁes the heat equation (4.4.8) and the initial condition (4.4.9).
(c) F is 1-periodic in each of the last n variables.
These statements can be easily proved by passing the differentiation inside the
sum, in view of the rapid convergence of the series in (4.4.11) due to the fact that
the periodic function f is C ∞(Rn). Furthermore, F is unique with properties (a),
(b), and (c), since any other function G(x,t) with these properties is derived in the
preceding way, and so it has to be equal to F(x,t).
Deﬁnition 4.4.2. Deﬁne the heat kernel
Ht(x) = ∑
m∈Zn
e−4π2|m|2kte2πim·x
for t > 0. Notice that the series deﬁning Ht is absolutely convergent for any t > 0.
The importance of the heat kernel lies in the fact that one can express the solution
F(x,t) of (4.4.8) in terms of the convolution F(x,t) = ( f ∗Ht)(x).
We summarize these facts in the following proposition.
Proposition 4.4.3. Let k > 0 be ﬁxed and let f be in C ∞(Rn). Assume that f is
1-periodic function in each variable. Then the heat equation
∂
∂t F(x,t) = kΔxF(x,t)
t ∈(0,∞),
x ∈Rn
(4.4.12)
under the initial condition
F(0,x) = f(x)
x ∈Rn
(4.4.13)
has a unique solution which is continuous on [0,∞) × Rn and C ∞on (0,∞) × Rn
given by
F(x,t) = ( f ∗Ht)(x) = ∑
m∈Zn
1f(m)e−4π2|m|2kte2πim·x .
(4.4.14)
Proof. Since f is C ∞, the series in (4.4.14) is rapidly convergent in m and thus it
gives a continuous function on [0,∞)×Rn. Moreover, the series can be differentiated
term by term in the variable t > 0, and thus it produces a C ∞function on (0,∞)×Rn.
By Fourier inversion (Proposition 3.2.5), F satisﬁes the initial condition (4.4.13).
Finally, to verify (4.4.12), we simply notice that

4.4 Applications to Geometry and Partial Differential Equations
297
∂
∂t F(x,t) = ∑
m∈Zn
∂
∂t
1f(m)e−4π2|m|2kte2πim·x
= −4π2k ∑
m∈Zn
1f(m)e−4π2|m|2kt|m|2e2πim·x
= k ∑
m∈Zn
1f(m)e−4π2|m|2kt ∂2
∂2x1
+···+ ∂2
∂2xn

e2πim·x
= k
 ∂2
∂2x1
+···+ ∂2
∂2xn

∑
m∈Zn
1f(m)e−4π2|m|2kte2πim·x
= k ∂2
∂2xF(x,t),
where the rapid convergence of the series in m makes it possible to pass the differ-
entiations in and out of the sum. Finally, to show uniqueness, assume that there is
another solution G(t,x), continuous on [0,∞)×Rn and C ∞on (0,∞)×Rn, that can
be expanded in Fourier series as follows:
G(t,x) = ∑
m∈Zn
cm(t)e2πim·x .
Conditions (4.4.12) and the rapid decay of the coefﬁcients cm(t) yield the ordinary
differential equation (4.4.10) with initial condition cm(0) = 1f(m), which has the
solution cm(t) = 1f(m)e−4π2|m|2kt. Thus G = F on [0,∞)×Rn.
□
It is important to observe that the family {Ht}t>0 is an approximate identity on
T1. Indeed, the Poisson summation formula (Theorem 3.2.8) and the fact that the
inverse Fourier transform of e−4π2kt|ξ|2 is e−|x|2/4kt/(2
√
πkt)n [Example 2.2.9 and
Proposition 2.2.11 (8)] yield that for all x ∈[0,1]n we have
Ht(x) =
1
(2
√
πkt)n ∑
ℓ∈Z
e−|x+ℓ|2
4kt .
This identity implies that Ht(x) ≥0 for all t > 0 and that

Tn Ht(x)dx =

Rn
1
(2
√
πkt)n e−|x|2
4kt dx =

Rn e−π|x|2 dx = 1
for all t > 0 and that

δ≤|u| Ht(u)du ≤

|x|≥δ
1
(2
√
πkt)n e−|x|2
4kt dx =

|x|≥
δ
2
√
kπt
e−π|x|2 dx
which tends to zero as t →0 for any δ > 0 in view of the Lebesgue differentiation
theorem. Thus properties (i), (ii), and (iii) of approximate identities hold.
As a consequence, we have that ∥F(t,·) −f∥Lp(Tn) →0 as t →0 for 1 ≤p < ∞
and F(t,·) converges to f uniformly on Tn; see Theorem 1.2.19.

298
4 Topics on Fourier Series
Exercises
4.4.1. Let f,F be as in Proposition 4.4.3. Prove that the total heat on the torus
remains constant in time by showing that for all t ≥0 we have

Tn F(t,x)dx =

Tn f(x)dx.
Moreover, show that the temperature at any ﬁxed point x ∈Tn on the torus tends to
the average initial temperature, i.e., it satisﬁes
lim
t→∞F(t,x) =

Tn f(y)dy.
4.4.2. Derive the following property of the heat kernel,
Ht ∗Hs = Ht+s
for all t,s > 0.
4.4.3. Consider the heat equation on [0,∞)×R
∂
∂t u(x,t) = ∂2
∂x2 u(x,t)
without a boundary condition. Show that u = 2t +x2 and u(t,x) = e−q2teiqx, as well
as constant functions, are solutions of this equation. Prove that the set of solutions
is a vector space over the ﬁeld of complex numbers C.
4.4.4. Suppose that a square-integrable function g(x) on Rn is supported in a cube
[−A,A]n for some A > 0. Then we have the following representation:
g(x) = ∑
m∈Zn

1
(2A)n

Rn g(y)e−2πi m·y
2A dy

e2πi x·m
2A χ[−A,A]n ,
where the series converges in L2
4.4.5. This exercise provides an application of Fourier series in complex analysis.
Let z ∈C\Z. Consider the function hz(x) = cos(2πzx) deﬁned on [−1
2, 1
2] extended
periodically on the entire line [notice hz(−1
2) = hz( 1
2)].
(a) Compute the Fourier coefﬁcients of hz.
(b) Obtain a Fourier series expansion of hz noticing that it is a Lipschitz function.
(c) Plug in x = 1/2 to prove that
cot(πz) = 1
πz + 1
π
∞
∑
m=1
2z
z2 −m2 .

4.5 Applications to Number theory and Ergodic theory
299
4.5 Applications to Number theory and Ergodic theory
In this section we discuss three applications of Fourier series techniques to number
theory and ergodic theory.
4.5.1 Evaluation of the Riemann Zeta Function at even Natural
numbers
Deﬁnition 4.5.1. We deﬁne the Bernoulli polynomials {Bk}∞
k=0 on [0,1] recursively
as follows:
B0(x) = 1
B′
k(x) = kBk−1(x)
for k = 1,2,..., and
 1
0 Bk(x)dx = 0.
In view of this deﬁnition we ﬁnd the ﬁrst few polynomials B1(x) = x −1
2, B2(x) =
x2 −x+ 1
6, B3(x) = x3 −3
2x2 + 1
2x, etc. Unlike orthogonal polynomials, the Bernoulli
polynomials have the remarkable property that their number of zeros in the unit
interval does not increase as the degree of the polynomials increases; in fact all
Bernoulli polynomials have at most three zeros in [0,1].
Notice that for k ≥2 we have
Bk(1)−Bk(0) =
 1
0 B′
k(x)dx = k
 1
0 Bk−1(x)dx = 0,
thus we may think of these polynomials as functions on the circle T1. We extend the
Bernoulli polynomials to the whole line periodically by setting Bk(x+l) = Bk(x) for
x ∈[0,1]. We now compute the Fourier coefﬁcients of Bk. We have
2
B1(m) =
 1
0 (t −1
2)e−2πimt dt =

0
if m = 0
−
1
2πim
if m ̸= 0.
Therefore, using Corollary 3.4.10, we can write
B1(x) = ∑
m̸=0
−
1
2πime2πimx
where the series converges at every x ∈(0,1).
We have the following result concerning the Fourier expansion of the Bernoulli
polynomials.

300
4 Topics on Fourier Series
Theorem 4.5.2. For each k ≥2 we have
Bk(x) = −k! ∑
m∈Z\{0}
1
(2πim)k e2πimx ,
(4.5.1)
where the series converges absolutely and uniformly on [0,1]. When k = 1 we have
B1(x) = −∑
m∈Z\{0}
1
2πime2πimx
(4.5.2)
for all x ∈(0,1) and the series converges conditionally.
Proof. We have already proved (4.5.2) and we focus attention to the case k ≥2. As
a consequence of B′
k = kBk−1 we obtain
Bk(x) = k
 x
0 Bk−1(t)dt +Ck .
Using the property that Bk has integral zero over [0,1] we evaluate the constant Ck.
We have
0 =
 1
0

k
 x
0 Bk−1(t)dt +Ck

dx
= k
 1
0
 1
t dx

Bk−1(t)dt +Ck
= −k
 1
0 tBk−1(t)dt +Ck .
Thus
Ck = k
 1
0 tBk−1(t)dt .
The Fourier series of Bk(x) can be obtained by integrating the one for Bk−1(x)
for all k ≥2 by induction via the identity
Bk(x) = k
 x
0 Bk−1(t)dt +k
 1
0 tBk−1(t)dt .
(4.5.3)
Indeed, assume that (4.5.1) holds for some k ≥2. Then using (4.5.3) we obtain
Bk(x) =
 x
0 lim
N→∞∑
|m|≤N
m̸=0
−k (k −1)!
(2πim)k−1 e2πimt dt −
 1
0 t lim
N→∞∑
|m|≤N
m̸=0
k (k −1)!
(2πim)k−1 e2πimt dt
= lim
N→∞
 x
0 ∑
|m|≤N
m̸=0
−k (k −1)!
(2πim)k−1 e2πimt dt −lim
N→∞
 1
0 t ∑
|m|≤N
m̸=0
k (k −1)!
(2πim)k−1 e2πimt dt

4.5 Applications to Number theory and Ergodic theory
301
= −lim
N→∞∑
|m|≤N
m̸=0
k!
(2πim)k−1
e2πimx −1
2πim
−lim
N→∞∑
|m|≤N
m̸=0
k!
(2πim)k−1

t e2πimt
2πim
t=1
t=0
= −k! ∑
m̸=0
e2πimx
(2πim)k .
Passing the limit from inside the integral to outside is allowed due to the uniform
convergence of the series when k ≥3. In the case k = 2, one may use Exercise 3.5.6
which says that for all [a,b] ⫅T1 and g integrable functions over [a,b] one has
lim
N→∞
 b
a (g∗DN)(t)dt =
 b
a lim
N→∞(g∗DN)(t)dt =
 b
a g(t)dt .
This argument proves identity (4.5.1) for all k ≥2 by induction and concludes the
proof.
□
We recall the following deﬁnition from number theory.
Deﬁnition 4.5.3. For s > 1 we deﬁne
ζ(s) =
∞
∑
k=1
1
ks
called the Riemann zeta function.
We use the Fourier expansions of the Bernoulli polynomials to obtain the values
of the Riemann zeta function for integers. When k is an even integer, identity (4.5.1)
can also be written as
Bk(x) = 2(−1)1+ k
2 k!
∞
∑
n=1
cos(2πnx)
(2πn)k
and inserting x = 0 yields
ζ(k) =
∞
∑
n=1
1
nk = Bk(0)(2π)k
2(−1)1+ k
2 k!
.
The polynomial B1(x) = x −1/2 has rational coefﬁcients and thus so do all the Bk
by a straightforward inductive argument that uses the identity (4.5.3). Thus Bk(0) is
a rational number for all k ≥1. We conclude that
ζ(2m) = B2m(0)(2π)2m
2(−1)1+m(2m)!
(4.5.4)
which is a rational multiple of (2π)2m, hence transcendental, since π is a transcen-
dental number. We have therefore obtained the following.

302
4 Topics on Fourier Series
Corollary 4.5.4. (Euler) The value of the Riemann zeta function ζ(2m), m =
1,2,..., is equal to a rational multiple of (2π)2m; hence it is a transcendental
number.
The corresponding statement for odd integers remains unresolved in general, as
of this writing.
4.5.2 Equidistributed sequences
Here we discuss Weyl’s theorem on equidistributed sequences.
Deﬁnition 4.5.5. A sequence {ak}∞
k=0 with values in Tn is called equidistributed if
for every cube Q in Tn we have
lim
N→∞
#{k : 0 ≤k ≤N −1,
ak ∈Q}
N
= |Q|.
Theorem 4.5.6. The following statements are equivalent:
(a) The sequence {ak}∞
k=0 is equidistributed.
(b) For every smooth function f on Tn we have that
lim
N→∞
1
N
N−1
∑
k=0
f(ak) =

Tn f(x)dx.
(c) For every m ∈Zn \{0} we have
lim
N→∞
1
N
N−1
∑
k=0
e2πim·ak = 0.
Proof. We ﬁrst prove the equivalence of (a) and (b). We begin by observing that
(b) is a restatement of (a) if f = χQ and Q is a cube in Tn. Thus, if (a) holds,
then (b) holds for all step functions, i.e., ﬁnite linear combinations of characteristic
functions of cubes. We prove that (a) implies (b) for smooth functions. Given a
smooth function f on Tn and given ε > 0, by the uniform continuity of f, there is a
step function g = ∑m
j=1 cjχQj (cj ∈C and Qj are cubes in Tn) such that ∥f −g∥L∞<
ε
3. Since g is a ﬁnite linear combination of step functions, there is an N0 such that
for N ≥N0 we have

1
N
N−1
∑
k=0
g(ak)−

Tn g(x)dx
 < ε
3 .
Since


Tn f(x)dx−

Tn g(x)dx
 ≤∥f −g∥L∞< ε
3

4.5 Applications to Number theory and Ergodic theory
303
and

1
N
N−1
∑
k=0
g(ak)−1
N
N−1
∑
k=0
f(ak)
 ≤∥f −g∥L∞< ε
3 ,
it follows that for N ≥N0 we have

1
N
N−1
∑
k=0
f(ak)−

Tn f(x)dx
 < ε ,
thus (b) holds.
To prove that (b) implies (a) given a cube Q in Tn pick two smooth functions g
and h such that
0 ≤h ≤χQ ≤g
and such that g is equal to 1 on Q and vanishes off (1+ε)Q while h is equal to 1 on
(1−ε)Q and vanishes off Q. Observe that
|Q|−cn ε ≤

Tn h(x)dx ≤|Q| ≤

Tn g(x)dx ≤|Q|+cn ε .
for some cn > 0. Since
1
N
N−1
∑
k=0
h(ak) ≤1
N
N−1
∑
k=0
χQ(ak) ≤1
N
N−1
∑
k=0
g(ak),
the sandwich theorem implies that
|Q|−cn ε ≤liminf
N→∞
1
N
N−1
∑
k=0
χQ(ak) ≤limsup
N→∞
1
N
N−1
∑
k=0
χQ(ak) ≤|Q|+cn ε .
Since ε > 0 was arbitrary the conclusion follows.
The implication (b) =⇒(c) is trivial.
We now prove that (c) =⇒(b).
Given a smooth function f on Tn we write
1
N
N−1
∑
k=0
f(ak) = 1
N
N−1
∑
k=0 ∑
m∈Zn
1f(m)e2πim·ak = 1f(0)+ ∑
m∈Zn\{0}
1f(m)
 1
N
N−1
∑
k=0
e2πim·ak

.
Because of the rapid decay of the Fourier coefﬁcients of f we can pass the limit as
N →∞inside the sum in m. It follows that
lim
N→∞
1
N
N−1
∑
k=0
f(ak) = 1f(0) =

Tn f(x)dx.
□

304
4 Topics on Fourier Series
Example 4.5.7. The sequence {k
√
2−[k
√
2]}∞
k=0 is equidistributed on T1. We check
this by verifying condition (c) of Theorem 4.5.6. Indeed if m ∈Z\{0} then
lim
N→∞
1
N
N−1
∑
k=0
e2πim(k
√
2−[k
√
2]) = lim
N→∞
1
N
e2πiN(m
√
2) −1
e2πi(m
√
2) −1
= 0,
since m
√
2 is never a rational and thus the denominator never vanishes.
Naturally, the same conclusion is valid for any other irrational number in place
of
√
2.
Example 4.5.8. We examine the sequence of the ﬁrst digits of powers of 2. Consider
the following sequence of numbers deﬁned for m = 1,2,...
dm = ﬁrst digit of 2m.
For instance we have d1 = 2,d2 = 4,d3 = 8,d4 = 1,d5 = 3,....
Fix an integer k ∈{1,2,3,4,5,6,7,8,9}. We would like to ﬁnd the frequency in
which k appears as a ﬁrst digit of 2m, precisely, we would like to compute
lim
N→∞
#
	
m ∈{1,2,...,N} : dm = k

N
.
The crucial observation is that the ﬁrst digit of 2m is equal to k if and only if there is
a nonnegative integer s such that
k10s ≤2m < (k +1)10s .
Taking logarithms with base 10 we obtain
s+log10(k) ≤mlog10 2 < s+log10(k +1),
but since 0 ≤log10(k) and log10(k +1) ≤1, taking fractional parts we obtain that
s = [mlog10 2]
and that
log10(k) ≤mlog10 2−[mlog10 2] < log10(k +1).
Since the number log10 2 is irrational, it follows from Example 4.5.7 that the
sequence
	
mlog10 2−[mlog10 2]

∞
m=1
is equidistributed in [0,1). Using Deﬁnition 4.5.5 in dimension n = 1 with
Q = [a,b] =

log10(k),log10(k +1)


4.5 Applications to Number theory and Ergodic theory
305
we obtain that
lim
N→∞
#
	
m ∈{1,2,...,N} : dm = k

N
= log10(k +1)−log10(k) = log10(1+ 1
k).
This gives the frequency in which k appears as ﬁrst digit of 2m. Notice that
9
∑
k=1
log10(1+ 1
k) =
9
∑
k=1

log10(k +1)−log10(k)

= 1,
as expected, and that the digit with the highest frequency that appears ﬁrst in a
term of the sequence {1,2,4,8,16,32,64,...} is 1, while the one with the lowest
frequency is 9.
4.5.3 The Number of Lattice Points inside a Ball
Points in Zn are called lattice points. In this subsection we obtain the number of
lattice points N(R) inside a closed ball of radius R in Rn centered at the origin,
precisely, we compute the asymptotic behavior of
N(R) = |B(0,R)∩Zn|
as R →∞. We denote by vn the volume of the closed unit ball in Rn. We have the
following result.
Theorem 4.5.9. Let n ≥2. If N(R) is the number of lattice points inside the closed
ball of radius R centered at zero in Rn, then we have that
N(R) = vnRn +O(Rn n−1
n+1 ),
as R →∞.
Proof. Let B be the closed unit ball in Rn and χB its characteristic function. Using
the result in Appendix B.5 we have 2
χB(ξ) =
Jn/2(2π|ξ|)
|ξ|n/2
. Now in view of the behavior
of the Bessel function given in Appendix B.6 for |ξ| <
1
2π we have Jn/2(2π|ξ|) ≤
C|ξ|
n
2 . Also for |ξ| ≥
1
2π we have Jn/2(2π|ξ|) ≤C|ξ|−1
2 , in view of the result in
Appendix B.7. Consequently, there is a constant Cn such that for all ξ ∈Rn we have
|2
χB(ξ)| ≤Cn(1+|ξ|)−n+1
2 .
Fix a smooth nonnegative radial function ζ supported in |x| ≤1
2 with integral
equal to 1 and deﬁne ζε(x) = 1
εn ζ( x
ε ) for ε > 0. For 0 < ε < 1
10, deﬁne functions
Φε = χ(1−ε
2 )B ∗ζε
Ψ ε = χ(1+ ε
2 )B ∗ζε.

306
4 Topics on Fourier Series
These functions are even, hence their Fourier transforms are real-valued. We observe
that
Φε(x) = 1 when |x| ≤1−ε
and
Φε(x) = 0 when |x| ≥1.
(4.5.5)
Indeed, we have
Φε(x) =

Rn χ(1−ε
2 )B(y)ζε(x−y)dy
=

|y|≤1−ε
2
1
εn ζ( x−y
ε )dy
=

|y|≤1
ε −1
2
ζ( x
ε −y)dy.
For |x| ≤1−ε, | x
ε | ≤1
ε −1, so | x
ε −t| ≤1
ε −1+ 1
2 = 1
ε −1
2 for |t| ≤1
2, which means
Φε(x) =

|y|≤1
ε −1
2
ζ( x
ε −y)dy =

|t|≤1
2
ζ(t)dt = 1.
For |x| ≥1,| x
ε −y| ≥1
ε −1
ε + 1
2 = 1
2, so
Φε(x) =

|y|≤1
ε −1
2
ζ( x
ε −y)dy = 0,
proving (4.5.5). Likewise one can show that
Ψ ε(x) = 1 when |x| ≤1
and
Ψ ε(x) = 0 when |x| ≥1+ε.
(4.5.6)
Next we claim that
2
Φε(ξ)
+
2
Ψ ε(ξ)
 ≤Cn,N(1+|ξ|)−n+1
2 (1+ε|ξ|)−N
(4.5.7)
for every ξ ∈Rn and N a large positive number. Indeed to show (4.5.7) for Φε we
write
|2
Φε(ξ)| = | 
χ(1−ε
2 )B(ξ)1ζ(ξε)|
≤(1−ε
2)nCn(1+|ξ|(1−ε
2))−n+1
2 |1ζ(ξε)|
≤Cn,N(1+|ξ|)−n+1
2 (1+ε|ξ|)−N
(4.5.8)
since ζ ∈S (R) and 0 < ε < 1
10. The proof for Ψ ε is completely similar.
We now notice that for R > 0, m ∈Zn \{0}, and x ∈[0,1]n we have
1+|m+x|R ≤1+(√n+|m|)R ≤2√n(1+|m|R).

4.5 Applications to Number theory and Ergodic theory
307
This implies that for ε < 1/10 we have
∑
m∈Zn\{0}
Rn(1+R|m|)−n+1
2 (1+εR|m|)−N
≤C′

[0,1]n
∑
m∈Zn\{0}
Rn(1+R|m+x|)−n+1
2 (1+εR|m+x|)−Ndx
≤C′

Rn Rn(1+R|x|)−n+1
2 (1+εR|x|)−Ndx
≤C′′ε−n−1
2 ,
(4.5.9)
where the proof of (4.5.9) is easily deduced by considering the cases (a) |x| ≤R−1
which yields a constant, (b) R−1 ≤|x| ≤(Rε)−1 which yields a constant multiple of
ε−n−1
2 , and (c) (Rε)−1 ≤|x| which also produces a constant multiple of ε−n−1
2 if we
pick N > n−1
2 .
Using (4.5.5) and the Poisson summation formula we write
∑
m∈Zn
χB( m
R ) ≥∑
m∈Zn
Φε( m
R )
= Rn 2
Φε(0)+
∑
m∈Zn\{0}
Rn 2
Φε(Rm)
≥vnRn(1−ε)n −Cn,N
∑
m∈Zn\{0}
Rn(1+R|m|)−n+1
2 (1+εR|m|)−N
≥vnRn −nvnRnε −C′
n,Nε−n−1
2 ,
where we used that (1 −ε)n ≥1 −nε, (4.5.8), and (4.5.9). Now pick ε such that
εRn = ε−n−1
2 , or equivalently ε = R−2n
n+1 to deduce the estimate
N(R) ≥vnRn −O(Rn n−1
n+1 )
as R →∞.
Finally, making use of (4.5.6), and via a similar argument we write
∑
m∈Zn
χB( m
R ) ≤∑
m∈Zn
Ψ ε( m
R ) = Rn 2
Ψ ε(0)+
∑
m∈Zn\{0}
Rn 2
Ψ ε(Rm)
≤vnRn(1+ε)n +Cn,N
∑
m∈Zn\{0}
Rn(1+R|m|)−n+1
2 (1+εR|m|)−N
≤vnRn +vn 2n Rnε +Cn,Nε−n−1
2 .
The same choice of ε = R−2n
n+1 , yields the upper estimate for N(R).

308
4 Topics on Fourier Series
Combining the upper and lower estimates for N(R) we obtain
N(R) = vnRn +O(Rn n−1
n+1 ),
as R →∞.
□
Exercise 4.5.8 contains an application of Theorem 4.5.9.
Exercises
4.5.1. Prove that for all x ∈[0,1] we have
∞
∑
j=1
sin(2π jx)
j2m+1
= (−1)m+1
2
(2π)2m+1
(2m+1)!B2m+1(x).
4.5.2. Show that for all z ∈C with |z| < 1 we have
πzcot(πz) = 1−2
∞
∑
k=0
z2k+2ζ(2k +2).

Hint: Use the result of Exercise 4.4.5.

4.5.3. Suppose that a point x = (x1,...,xn) ∈[0,1]n has the property that m·x is irra-
tional for all m ∈Zn\{0}. Show that the sequence {(kx1−[kx1],...,kxn−[kxn])}∞
k=0
is equidistributed in Tn.
4.5.4. ([191]) Let N(x,R) be the number of lattice points inside the closed ball of
radius R > 0 centered at x ∈Rn. Show that

Tn
N(x,R)−vnRn2 dx = O(Rn−1)
as R →∞, where vn is the volume of the unit ball on Rn.
4.5.5. (Minkowski) Let S be an open convex symmetric set in Rn and assume that
the Fourier transform of its characteristic function satisﬁes the decay estimate
| 1χS(ξ)| ≤C(1+|ξ|)−n+1
2 .
(This is the case if the boundary of S has nonzero Gaussian curvature.) Assume that
|S| > 2n. Prove that S contains at least one lattice point other than the origin.

Hint: Assume the contrary, set f = χ 1
2 S ∗χ 1
2 S, and apply the Poisson summation
formula to f to prove that f(0) ≥1f(0).


4.5 Applications to Number theory and Ergodic theory
309
4.5.6. For t ∈[0,∞) let
N(t) = #{m ∈Zn : |m| ≤t}.
Let 0 = r0 < r1 < r2 < ··· be the sequence all of numbers r for which there exist
m ∈Zn such that |m| = r.
(a) Observe that N is right continuous and constant on intervals of the form [r j,r j+1).
(b) Show that the distributional derivative of N is the measure
μ(t) = #{m ∈Zn : |m| = t},
deﬁned via the identity ⟨μ,ϕ⟩= ∑∞
j=0 #{m ∈Zn : |m| = r j}ϕ(r j).
4.5.7. Let f ∈C 1((0,∞)), and let 0 < a < b < ∞. Derive the identity
∑
m∈Zn
a<|m|≤b
f(|m|) =
 b
a f(t)dN(t) = f(b)N(b)−f(a)N(a)−
 b
a f ′(x)N(x)dx,
where N is deﬁned in Exercise 4.5.6 and
 b
a f(t)dN(t) is the Riemann-Stieltjes in-
tegral of f with respect to N.
4.5.8. Let n ∈Z+ and 0 < λ < ∞.
(a) Prove that for k ∈Z+ ∪{0} we have
∑
m∈Zn
a<|m|≤b
ei|m|
|m|λ = −iωn−1 eib
bλ−(n−1) −−iωn−1 eia
aλ−(n−1) +O(a−λ+(n−1)−n−1
n+1 )
for all 0 < a < b < ∞with b−a ≤1, where ωn−1 is the volume of Sn−1.
(b) Show that when λ > n−n−1
n+1, the limit
lim
R→∞
∑
m∈Zn\{0}
|m|≤R
ei|m|
|m|λ
exists.
(c) Prove, however, that when n−1−n−1
n+1 < λ ≤n−1, the limit in part (b) does not
exist.

Hint: Use Exercise 4.5.7 and Theorem 4.5.9. Part (b): For R > 1 use the identity
∑
m∈Zn\{0}
|m|≤R
ei|m|
|m|λ =
[R−1
2 ]−1
∑
k=0

∑
m∈Zn
k+ 1
2 <|m|≤k+ 3
2
ei|m|
|m|λ

+
$
∑
m∈Zn
[R−1
2 ]+ 1
2 <|m|≤R
ei|m|
|m|λ
%
.
Notice that the main term in the ﬁrst sum on the right is telescoping. Part (c): Show
that limR→∞∑m∈Zn\{0}
R<|m|≤R+1
ei|m|
|m|λ does not tend to zero.


310
4 Topics on Fourier Series
HISTORICAL NOTES
The boundedness of the conjugate function on the circle (Theorem 4.1.7) and, hence, the Lp
convergence of one-dimensional Fourier series was announced by Riesz in [292], but its proof ap-
peared a little later in [293]. The proof of Theorem 4.1.7 in the text is attributed to S. Bochner.
Luzin’s conjecture [235] on almost everywhere convergence of the Fourier series of continuous
functions was announced in 1913 and settled by Carleson [54] in 1965 for the more general class
of square summable functions (Theorem 4.3.14). Carleson’s theorem was later extended by Hunt
[165] for the class of Lp functions for all 1 < p < ∞(Theorem 4.3.15). Sj¨olin [325] sharpened
this result by showing that the Fourier series of functions f with | f|(log+ | f|)(log+ log+ | f|) in-
tegrable over T1 converge almost everywhere. Antonov [5] improved Sj¨olin’s result by extend-
ing it to functions f with | f|(log+ | f|)(log+ log+ log+ | f|) integrable over T1. One should also
consult the related results of Soria [330] and Arias de Reyna [9]. The book [10] of Arias de
Reyna contains a historically motivated comprehensive study of topics related to the Carleson–
Hunt theorem. Counterexamples due to Konyagin [200] show that Fourier series of functions f
with | f|(log+ | f|)
1
2 (log+ log+ | f|)−1
2 −ε integrable over T1 may diverge when ε > 0. Examples of
continuous functions whose Fourier series diverge exactly on given sets of measure zero are given
in Katznelson [189] and Kahane and Katznelson [183].
The extension of the Carleson–Hunt theorem to higher dimensions for square summability of
Fourier series (Theorem 4.3.16) is a rather straightforward consequence of the one-dimensional
result and was independently obtained by Fefferman [112], Sj¨olin [325], and Tevzadze [359]. An
example showing that the circular partial sums of a Fourier series may not converge in Lp(Tn) for
n ≥2 and p ̸= 2 was obtained by Fefferman [113]. This example also shows that there exist Lp
functions on Tn for n ≥2 whose circular partial sums do not converge almost everywhere when
1 ≤p < 2. Indeed, if the opposite happened, then the maximal operator f →supN≥0 |#D(n,N)∗f|
would have to be ﬁnite a.e. for all f ∈Lp(Tn), and by Stein’s theorem [335] it would have to be of
weak type (p, p) for some 1 < p < 2. But this would contradict Fefferman’s counterexample on Lp1
for some p < p1 < 2. On the other hand, almost everywhere is valid for the square partial sums of
functions f with | f|(log+ | f|)n(log+ log+ log+ | f|) integrable over Tn, as shown by Antonov [6];
see also Sj¨olin and Soria [327].
The development of the complex methods in the study of Fourier series was pioneered by
the Russian school, especially Luzin and his students Kolmogorov, Menshov, and Privalov. The
existence of an integrable function on T1 whose Fourier series diverges almost everywhere (The-
orem 4.2.1) is due to Kolmogorov [195]. An example of an integrable function whose Fourier
series diverges everywhere was also produced by Kolmogorov [198] three years later. Localiza-
tion of the Bochner–Riesz means at the critical exponent α = n−1
2
fails for L1 functions on Tn
(see Bochner [30]) but holds for functions f such that | f|log+ | f| is integrable over Tn (see Stein
[333]). The latter article also contains the Lp boundedness of the maximal Bochner–Riesz oper-
ator supR>0 |Bα
R( f)| for 1 < p < ∞when α > | 1
p −1
2|. Proposition 4.1.9 is due to Stein [331] and
Theorem 4.2.5 is also due to Stein [335]. The technique that involves the points for which the set
{|x−m| : m ∈Zn} is linearly independent over the rationals was introduced by Bochner [30].
Transference of regulated multipliers originated in the article of de Leeuw [94]. The methods
of transference in Section 4.3 were beautifully placed into the framework of a general theory by
Coifman and Weiss [70]. The key Lemma 4.3.8 is attributed to G. Weiss. Transference of maximal
multipliers (Theorem 4.3.12) was ﬁrst obtained by Kenig and Tomas [192] and later elaborated by
Asmar, Berkson, and Gillespie [12], [13].
Paraphrasing Pappus of Alexandria, bees know than a hexagon will hold more honey than a
triangle or square of the same length, but people claim a greater share of wisdom knowing that the
circle of a given length holds the maximum area among all geometric shapes of equal perimeter.
This reﬂection captures the isoperimetric inequality, which was ﬁrst recorded by Pappus in the
fourth century A.D. and was credited it to Zenodorus (second century B.C.). Archimedes also
studied the problem, but his work on the subject, like the original writings of Zenodorus, has been
lost. Rigorous modern-day proofs of this inequality can be traced to J. Steiner, K. Weierstrass, and

4.5 Applications to Number theory and Ergodic theory
311
F. Edler, whose methods are based in geometry and calculus. The proof in the text is due to A.
Hurwitz. On the history of the isoperimetric inequality see [322].
The mean square error for lattice points (Exercise 4.5.4) is due to Kendall [191] while the more
delicate pointwise asymptotic formula of Theorem 4.5.9 was obtained by Landau [212]. Using
Landau’s formula Pinsky, Stanton, and Trapa [284] showed that the spherical partial sums of the
Fourier series of the characteristic function of a sufﬁciently small ball in Tn converge at the center
of the ball if and only if the dimension n is strictly less than three; this property is valid for the
characteristic function of any ball as shown in Pinsky [283].

Chapter 5
Singular Integrals of Convolution Type
The topic of singular integrals is motivated by its intimate connection with some of
the most important problems in Fourier analysis, such as that of the convergence of
Fourier series. As we have seen, the Lp boundedness of the conjugate function on
the circle is equivalent to the Lp convergence of Fourier series of Lp functions. And
since the Hilbert transform on the real line provides an analogue of the conjugate
function on the circle, it is deeply connected with the Lp convergence of Fourier
integrals. It also appears in the theory of harmonic functions on the upper half space
and has so many remarkable properties that deserve a careful investigation. The
Hilbert transform is the prototype of all singular integrals and provides inspiration
for subsequent development of the subject.
Historically, the theory of the Hilbert transform depended on techniques of com-
plex analysis. With the development of the Calder´on–Zygmund school, and the
extension of one-dimensional theory to higher dimensions, real-variable methods
slowly replaced complex analysis. The higher-dimensional framework proved to be
ﬂexible enough for generalizations and led to the introduction of singular integrals
in other areas of mathematics. Singular integrals are nowadays intimately connected
with partial differential equations, operator theory, several complex variables, and
other ﬁelds. In this chapter we study singular integrals given by convolution with
tempered distributions. We call such operators singular integrals of convolution
type.
5.1 The Hilbert Transform and the Riesz Transforms
We begin the investigation of singular integrals with a careful study of the Hilbert
transform which provides inspiration for the subsequent development of the theory.
L. Grafakos, Classical Fourier Analysis, Graduate Texts in Mathematics 249,
DOI 10.1007/978-1-4939-1194-3 5, © Springer Science+Business Media New York 2014
313

314
5 Singular Integrals of Convolution Type
5.1.1 Deﬁnition and Basic Properties of the Hilbert Transform
There are several equivalent ways to introduce the Hilbert transform; in this ex-
position we ﬁrst deﬁne it as a convolution operator with a certain principal value
distribution, but we later discuss other equivalent deﬁnitions.
We begin by deﬁning a distribution W0 in S ′(R) as follows:
4
W0,ϕ
5
= 1
π lim
ε→0

ε≤|x|≤1
ϕ(x)
x
dx+ 1
π

|x|≥1
ϕ(x)
x
dx,
(5.1.1)
for ϕ in S (R). The function 1/x integrated over [−1,−ε][ε,1] has mean value
zero, and we may replace ϕ(x) by ϕ(x) −ϕ(0) in the ﬁrst integral in (5.1.1). Since
(ϕ(x) −ϕ(0))x−1 is controlled by ∥ϕ′∥L∞, it follows that the limit in (5.1.1) exists.
To see that W0 is indeed in S ′(R), we note that the estimate
4
W0,ϕ
5 ≤2
π
ϕ′
L∞+ 2
π sup
x∈R
|xϕ(x)|
(5.1.2)
is valid. This says that W0 ∈S ′(R).
Deﬁnition 5.1.1. The truncated Hilbert transform (at height ε) of a function f in
Lp(R), 1 ≤p < ∞, is deﬁned by
H(ε)( f)(x) = 1
π

|y|≥ε
f(x−y)
y
dy = 1
π

|x−y|≥ε
f(y)
x−y dy.
(5.1.3)
The Hilbert transform of ϕ ∈S (R) is deﬁned by
H(ϕ)(x) = (W0 ∗ϕ)(x) = lim
ε→0H(ε)(ϕ)(x).
(5.1.4)
Observe that H(ε)( f) is well deﬁned for all f ∈Lp, 1 ≤p < ∞. This follows from
H¨older’s inequality, since 1/x is integrable to the power p′ on the set |x| ≥ε.
For Schwartz functions ϕ, the integral
 +∞
−∞
ϕ(x−y)
y
dy
may not converge absolutely for any real number x, but is deﬁned as a limit of the
absolutely convergent integrals

|y|≥ε
ϕ(x−y)
y
dy,
as ε →0. Such limits are called principal value integrals and are denoted by the
letters p.v. Using this notation, the Hilbert transform of a Schwartz function ϕ is
H(ϕ)(x) = 1
π p.v.
 +∞
−∞
ϕ(x−y)
y
dy = 1
π p.v.
 +∞
−∞
ϕ(y)
x−y dy.
(5.1.5)

5.1 The Hilbert Transform and the Riesz Transforms
315
Remark 5.1.2. We extend the deﬁnition of the Hilbert transform to a bigger class
of functions. Suppose that f is an integrable function on R that satisﬁes a H¨older
condition near every point x; that is, for any x ∈R there are Cx > 0 and εx > 0 such
that
| f(x)−f(y)| ≤Cx|x−y|εx
whenever |y−x| < δx. Then we write
H(ε)( f)(x) = 1
π

ε<|x−y|<δx
f(y)
x−y dy+ 1
π

|x−y|≥δx
f(y)
x−y dy
= 1
π

ε<|x−y|<δx
f(y)−f(x)
x−y
dy+ 1
π

|x−y|≥δx
f(y)
x−y dy.
Both integrals converge absolutely; hence the limit of H(ε)( f)(x) exists as ε →0.
Fig. 5.1 The graph of the
function H(χE) when E is
a union of three disjoint
intervals J1 ∪J2 ∪J3.
Example 5.1.3. For the characteristic function χ[a,b] of an interval [a,b] we show
that
H(χ[a,b])(x) = 1
π log |x−a|
|x−b| .
(5.1.6)
Let us verify this identity. Pick ε < min(|x −a|,|x −b|). To show (5.1.6) consider
the three cases 0 < x −b, x −a < 0, and x −b < 0 < x −a. In the ﬁrst two cases,
(5.1.6) follows immediately. In the third case we have
H(χ[a,b])(x) = 1
π lim
ε→0

log |x−a|
ε
+log
ε
|x−b|

,
(5.1.7)

316
5 Singular Integrals of Convolution Type
which yields (5.1.6). Observe that the cancellation of ε in (5.1.7) reﬂects the fact
that 1/x has integral zero on symmetric intervals ε < |x| < c. Note that H(χ[a,b])(x)
blows up logarithmically in x near the points a and b and decays like |x|−1 as x →∞.
See Figure 5.1.
Example 5.1.4. Let log+ x = logx when x ≥1 and zero otherwise. Observe that the
calculation in the previous example actually gives
H(ε)(χ[a,b])(x) =
⎧
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎩
1
π log+
|x−a|
max(ε,|x−b|)
when x > b,
−1
π log+
|x−b|
max(ε,|x−a|)
when x < a,
1
π log+ |x−a|
ε
−1
π log+ |x−b|
ε
when a < x < b.
We now give an alternative characterization of the Hilbert transform using the
Fourier transform. To achieve this we need to compute the Fourier transform of the
distribution W0 deﬁned in (5.1.1). Fix a Schwartz function ϕ on R. Then
42
W0,ϕ
5
=
4
W0, 1ϕ
5
(5.1.8)
= 1
π lim
ε→0

|ξ|≥ε
1ϕ(ξ) dξ
ξ
= 1
π lim
ε→0

1
ε ≥|ξ|≥ε

R ϕ(x)e−2πixξ dx dξ
ξ
= lim
ε→0

R ϕ(x)
 1
π

1
ε ≥|ξ|≥ε e−2πixξ dξ
ξ

dx
= lim
ε→0

R ϕ(x)
−i
π

1
ε ≥|ξ|≥ε sin(2πxξ) dξ
ξ

dx
= lim
ε→0

R ϕ(x)
−i
π sgnx

1
2πε ≥|ξ|≥ε
2π
sin(|x|ξ) dξ
ξ

dx.
(5.1.9)
Here we used the signum function
sgnx =
⎧
⎪
⎨
⎪
⎩
+1
when x > 0,
0
when x = 0,
−1
when x < 0.
(5.1.10)
Using the results (a) and (b) in Exercise 5.1.1 we obtain that the integrals inside the
square brackets in (5.1.9) are uniformly bounded by 8 and converge to 2 π
2 = π as
ε →0, whenever x ̸= 0. These observations make possible the use of the Lebesgue
dominated convergence theorem that allows the passage of the limit inside the inte-
gral in (5.1.9). We obtain that
42
W0,ϕ
5
=

R ϕ(x)(−isgn(x))dx.
(5.1.11)

5.1 The Hilbert Transform and the Riesz Transforms
317
This implies that
2
W0(ξ) = −isgnξ .
(5.1.12)
In particular, identity (5.1.12) says that 2
W0 is a (bounded) function.
We now use identity (5.1.12) to write
H( f)(x) =
 1f(ξ)(−isgnξ)
∨(x).
(5.1.13)
This formula can be used to give an alternative deﬁnition of the Hilbert transform.
An immediate consequence of (5.1.13) is that
H( f)

L2 =
f

L2 ,
(5.1.14)
that is, H is an isometry on L2(R). Moreover, H satisﬁes
H2 = HH = −I ,
(5.1.15)
where I is the identity operator. Equation (5.1.15) is a simple consequence of the
fact that (−isgnξ)2 = −1. The adjoint operator H∗of H is uniquely deﬁned via the
identity
4
f |H(g)
5
=

R f H(g)dx =

R H∗( f) gdx =
4
H∗( f)|g
5
,
and we can easily obtain that H∗has multiplier −isgnξ = isgnξ. We conclude that
H∗= −H. Likewise, we obtain Ht = −H.
5.1.2 Connections with Analytic Functions
We now investigate connections of the Hilbert transform with the Poisson kernel.
Recall the deﬁnition of the Poisson kernel Py given in Example 1.2.17. Then for a
real-valued function f in Lp(R), 1 ≤p < ∞, we have
(Py ∗f)(x) = y
π
 +∞
−∞
f(t)
(x−t)2 +y2 dt ,
(5.1.16)
and the integral in (5.1.16) converges absolutely by H¨older’s inequality, since the
function t →((x−t)2 +y2)−1 is in Lp′(R) whenever y > 0.
Let Re z and Im z denote the real and imaginary parts of a complex number z.
Observe that
(Py ∗f)(x) = Re
 i
π
 +∞
−∞
f(t)
x−t +iy dt

= Re
 i
π
 +∞
−∞
f(t)
z−t dt

,

318
5 Singular Integrals of Convolution Type
where z = x+iy. The function
Ff (z) = i
π
 +∞
−∞
f(t)
z−t dt
deﬁned on
R2
+ = {z = x+iy : y > 0}
is analytic, since its ∂/∂z derivative is zero. The real part of Ff (x+iy) is (Py ∗f)(x).
The imaginary part of Ff (x+iy) is
Im
 i
π
 +∞
−∞
f(t)
x−t +iy dt

= 1
π
 +∞
−∞
f(t)(x−t)
(x−t)2 +y2 dt = ( f ∗Qy)(x),
where Qy is called the conjugate Poisson kernel and is given by
Qy(x) = 1
π
x
x2 +y2 .
(5.1.17)
The function uf +ivf is analytic and thus uf (x+iy) = ( f ∗Py)(x) and vf (x+iy) =
( f ∗Qy)(x) are conjugate harmonic functions. Since the family Py, y > 0, is an ap-
proximate identity, it follows from Theorem 1.2.19 that Py∗f →f in Lp(R) as y →0.
The following question therefore arises: What is the limit of f ∗Qy as y →0? The
next result addresses this question.
Theorem 5.1.5. Let 1 ≤p < ∞. For any f ∈Lp(R) we have
f ∗Qε −H(ε)( f) →0
(5.1.18)
in Lp and almost everywhere as ε →0. Moreover, for ϕ in S (R) we have
Fϕ(x+iy) = i
π
 +∞
−∞
ϕ(t)
x+iy−t dt →ϕ(x)+iH(ϕ)(x)
(5.1.19)
as y →0+ for all x ∈R.
Proof. We see that
(Qε ∗f)(x)−1
π

|t|≥ε
f(x−t)
t
dt = 1
π ( f ∗ψε)(x),
where ψε(x) = ε−1ψ(ε−1x) and
ψ(t) =

t
t2+1 −1
t
when |t| ≥1,
t
t2+1
when |t| < 1.
(5.1.20)

5.1 The Hilbert Transform and the Riesz Transforms
319
Note that ψ is integrable over the line and has integral zero. Furthermore, the inte-
grable function
Ψ(t) =

1
t2+1
when |t| ≥1,
1
when |t| < 1,
(5.1.21)
is a radially decreasing majorant of ψ, i.e., it is even, decreasing on [0,∞), and
satisﬁes |ψ| ≤Ψ. It follows from Theorem 1.2.21 (with a = 0) that f ∗ψε →0 in
Lp. Also Corollary 2.1.19 (with a = 0) implies that f ∗ψε →0 almost everywhere
as ε →0.
Assertion (5.1.19) is a consequence of (5.1.18), the discussion preceding Theorem
5.1.5, and the observation that H(ε)(ϕ) converges to H(ϕ) pointwise everywhere as
ε →0.
□
Remark 5.1.6. We will show later that for f ∈Lp(R), 1 ≤p < ∞, the expressions
H(ε)( f) converge a.e. (and also in Lp when p > 1) to a function #H( f). This will
be a consequence of Theorem 5.1.12 (or Corollary 5.3.6 when p = 1), combined
with Theorem 2.1.14 and the observation that for Schwartz functions ϕ, H(ε)(ϕ)
converge to H(ϕ) as ε →0. The linear operator #H deﬁned in this way extends the
Hilbert transform H initially deﬁned on Schwartz functions and will still be denoted
by H. Thus for f ∈Lp(R), 1 ≤p < ∞, one has
lim
ε→0 f ∗Qε = H( f)
a.e.
This convergence is also valid in Lp in view of the preceding observations and The-
orem 5.1.5.
5.1.3 Lp Boundedness of the Hilbert Transform
As a consequence of the result in Exercise 5.1.4 and of the fact that
x ≤1
2(ex −e−x),
x ≥0,
we obtain that
|{x : |H(χE)(x)| > α}| ≤2
π
|E|
α ,
α > 0,
(5.1.22)
for all subsets E of the real line of ﬁnite measure. Theorem 1.4.19 with p0 = q0 = 1
and p1 = q1 = 2 now implies that H is bounded on Lp for 1 < p < 2. Duality gives
that H∗= −H is bounded on Lp for 2 < p < ∞and hence so is H.
We give another proof of the boundedness of the Hilbert transform H on Lp(R),
which has the advantage that it gives the best possible constant in the resulting norm
inequality when p is a power of 2.

320
5 Singular Integrals of Convolution Type
Theorem 5.1.7. For all 1 < p < ∞, there exists a positive constant Cp such that
H( f)

Lp ≤Cp
 f

Lp
for all f in S (R). Moreover, the constant Cp satisﬁes Cp ≤2p for 2 ≤p < ∞and
Cp ≤2p/(p−1) for 1 < p ≤2. Therefore, the Hilbert transform H admits an exten-
sion to a bounded operator on Lp(R) when 1 < p < ∞.
Proof. The proof we give is based on the interesting identity
H( f)2 = f 2 +2H( fH( f)),
(5.1.23)
which is valid whenever f is a real-valued Schwartz function. We prove (5.1.23) in
two different ways. First we consider the analytic function
Ff (z) = i
π

R
f(t)
z−t dt
deﬁned on the upper half space. We compute its square. Fix z ∈C with Rez > 0 and
f a real-valued Schwartz function. Then for ε > 0 we have
Ff (z)2 =
 i
π
2 
R

R
f(t) f(s)
(z−t)(z−s) dtds
=
 i
π
2
R

|t−s|>ε
f(t) f(s)
t −s
 1
z−t −
1
z−s

dtds−1
π2

|t−s|≤ε
f(t) f(s)dtds
(z−t)(z−s)
=
 i
π
2
R f(t)

|t−s|>ε
f(s)
t −s ds dt
z−t −
 i
π
2 
R f(s)

|t−s|>ε
f(t)
t −s dt ds
z−s
−1
π2

|t−s|≤ε
f(t) f(s)dtds
(z−t)(z−s) .
Letting ε →0 and passing the limit inside the integral by the Lebesgue dominated
convergence theorem, we deduce
Ff (z)2 = i i
π

R
2f(t)H( f)(t)
z−t
dt .
(5.1.24)
We now let Imz →0+ in (5.1.24) and use (5.1.19) in Theorem 5.1.5. We obtain
f 2 −H( f)2 +i2f H( f) =

f +iH( f)
2 = i

2fH( f)+iH

2fH( f)

,
and equating the real parts we deduce (5.1.23).
To give an alternative proof of (5.1.23) we take Fourier transforms. Let
m(ξ) = −isgnξ

5.1 The Hilbert Transform and the Riesz Transforms
321
be the symbol of the Hilbert transform. We have
1f 2(ξ)+2[H( fH( f))]1(ξ)
= ( 1f ∗1f)(ξ)+2m(ξ)( 1f ∗
H( f))(ξ)
=

R
1f(η) 1f(ξ −η)dη +2m(ξ)

R
1f(η) 1f(ξ −η)m(η)dη
(5.1.25)
=

R
1f(η) 1f(ξ −η)dη +2m(ξ)

R
1f(η) 1f(ξ −η)m(ξ −η)dη. (5.1.26)
Averaging (5.1.25) and (5.1.26) we obtain
1f 2(ξ)+2[H( fH( f))]1(ξ) =

R
1f(η) 1f(ξ −η)

1+m(ξ)

m(η)+m(ξ −η)

dη .
But the last displayed expression is equal to

R
1f(η) 1f(ξ −η)m(η)m(ξ −η)dη = (
H( f)∗
H( f))(ξ)
in view of the identity
m(η)m(ξ −η) = 1+m(ξ)m(η)+m(ξ)m(ξ −η),
which is valid for all (ξ,η) ∈R2 \{(0,0)} for the function m(ξ) = −isgnξ.
Having established (5.1.23), we can easily obtain Lp bounds for H when p = 2k
is a power of 2. We already know that H is bounded on Lp with norm one when
p = 2k and k = 1. Suppose that H is bounded on Lp with bound cp for p = 2k for
some k ∈Z+. Then for a nonzero real-valued function f in C ∞
0 we have
H( f)

L2p =
H( f)2
1
2
Lp ≤
f 2
Lp +
2H( fH( f))

Lp
 1
2
≤
f
2
L2p +2cp
fH( f)

Lp
 1
2
≤
f
2
L2p +2cp
f

L2p
H( f)

L2p
 1
2 .
Since ∥H( f)∥L2p < ∞, we obtain that
H( f)

L2p
f

L2p
2
−2cp
H( f)

L2p
f

L2p
−1 ≤0.
If follows that
H( f)

L2p
f

L2p
≤cp +
!
c2p +1,
and from this we conclude that H is bounded on L2p with bound
c2p ≤cp +
!
c2p +1.
(5.1.27)

322
5 Singular Integrals of Convolution Type
This completes the induction. We have proved that H maps Lp to Lp when p = 2k,
k = 1,2,.... Interpolation now gives that H maps Lp to Lp for all p ≥2. Since
H∗= −H, duality gives that H is also bounded on Lp for 1 < p ≤2.
The previous proof of the boundedness of the Hilbert transform provides us with
some useful information about the norm of this operator on Lp(R). Let us begin
with the identity
cot x
2 = cotx+
"
1+cot2 x,
valid for 0 < x < π
2 . If cp ≤cot π
2p, then (5.1.27) gives that
c2p ≤cp +
!
c2p +1 ≤cot π
2p +
=
1+cot2 π
2p = cot
π
2·2p ,
and since 1 = cot π
4 = cot π
2·2, we obtain by induction that the numbers cot π
2p are
indeed bounds for the norm of H on Lp when p = 2k, k = 1,2,.... Duality now
gives that the numbers cot π
2p′ = tan π
2p are bounds for the norm of H on Lp when
p =
2k
2k−1, k = 1,2,.... These bounds allow us to derive good estimates for the norm
∥H∥Lp→Lp as p →1 and p →∞. Indeed, since cot π
2p ≤p when p ≥2, the Riesz–
Thorin interpolation theorem gives that ∥H∥Lp→Lp ≤2p for 2 ≤p < ∞and by du-
ality ∥H∥Lp→Lp ≤
2p
p−1 for 1 < p ≤2. This completes the proof which is worth
comparing with that of Theorem 4.1.7.
□
Remark 5.1.8. The numbers cot π
2p for 2 ≤p < ∞and tan π
2p for 1 < p ≤2 are
indeed equal to the norms of the Hilbert transform H on Lp(R). This requires a
more delicate argument; see Exercise 5.1.12.
Remark 5.1.9. We may wonder what happens when p = 1 or p = ∞. The Hilbert
transform of χ[a,b] computed in Example 5.1.3 is easily seen to be unbounded and not
integrable, since it behaves like 1/|x| as x →∞. This behavior near inﬁnity suggests
that the Hilbert transform may map L1 to L1,∞. This is indeed the case, but this will
not be shown until Section 5.3.
We now introduce the maximal Hilbert transform.
Deﬁnition 5.1.10. The maximal Hilbert transform is the operator
H(∗)( f)(x) = sup
ε>0
H(ε)( f)(x)

(5.1.28)
deﬁned for all f in Lp, 1 ≤p < ∞. For such f, H(ε)( f) is well deﬁned as a convergent
integral by H¨older’s inequality. Hence H(∗)( f) makes sense for f ∈Lp(R), although
for some values of x, H(∗)( f)(x) may be inﬁnite.
Example 5.1.11. Using the result of Example 5.1.4, we obtain that
H(∗)(χ[a,b])(x) = 1
π
log |x−a|
|x−b|
.
(5.1.29)

5.1 The Hilbert Transform and the Riesz Transforms
323
We see that in general, H(∗)( f)(x) ̸= |H( f)(x)| by taking f to be the characteristic
function of the union of two disjoint closed intervals.
The deﬁnition of H gives that H(ε)( f) converges pointwise to H( f) whenever f
lies in C ∞
0 (R). If we have the estimate ∥H(∗)( f)∥Lp ≤Cp∥f∥Lp for f ∈Lp(R), The-
orem 2.1.14 yields that H(ε)( f) converges to H( f) a.e. as ε →0 for any f ∈Lp. This
almost everywhere limit provides a way to describe H( f) for general f ∈Lp(R).
Note that Theorem 5.1.7 implies only that H has a (unique) bounded extension on
Lp, but it does not provide a way to describe H( f) when f is a general Lp function.
The next theorem is a simple consequence of these ideas.
Theorem 5.1.12. There exists a constant C such that for all 1 < p < ∞we have
H(∗)( f)

Lp ≤Cmax

p,(p−1)−2f

Lp .
(5.1.30)
Moreover, for all f in Lp(R), H(ε)( f) converges to H( f) a.e. and in Lp.
Proof. Another proof of this theorem is given in Theorem 4.2.4 in [131] in which
the asserted bound is improved.
Recall the kernels Pε and Qε deﬁned in (5.1.16) and (5.1.17). Fix 1 < p < ∞and
suppose momentarily that
f ∗Qε = H( f)∗Pε ,
ε > 0,
(5.1.31)
holds whenever f is an Lp function. Then we have
H(ε)( f) = H(ε)( f)−f ∗Qε +H( f)∗Pε .
(5.1.32)
Using the identity
H(ε)( f)(x)−( f ∗Qε)(x) = −1
π

R f(x−t)ψε(t)dt ,
(5.1.33)
where ψ is as in (5.1.20), and applying Corollary 2.1.12, we obtain the estimate
sup
ε>0
|H(ε)( f)(x)−( f ∗Qε)(x)| ≤1
π
Ψ

L1M( f)(x),
(5.1.34)
where Ψ is as in (5.1.21) and M is the Hardy–Littlewood maximal function. In view
of (5.1.32) and (5.1.34), we obtain for f ∈Lp(Rn) that
|H(∗)( f)(x)| ≤
Ψ

L1M( f)(x)+M(H( f))(x).
(5.1.35)
It follows immediately from (5.1.35) that H(∗) is Lp bounded with norm at most
Cmax

p,(p−1)−2
.

324
5 Singular Integrals of Convolution Type
We now turn to the proof of (5.1.31). It sufﬁces to prove (5.1.31) for Schwartz
functions since, given f ∈Lp there is a sequence φ j ∈S such that ∥f −φ j∥Lp →0
as j →∞and Pε, Qε lie in Lp′. Taking Fourier transforms, we see that (5.1.31) is a
consequence of the identity

(−isgnξ)e−2π|ξ|∨(x) = 1
π
x
x2 +1 .
(5.1.36)
To prove (5.1.36) we write

(−isgnξ)e−2π|ξ|∨(x) =
 +∞
−∞e−2π|ξ|(−isgnξ)e2πixξ dξ
= 2
 ∞
0 e−2πξ sin(2πxξ)dξ
= 1
π
 ∞
0 e−ξ sin(xξ)dξ
(5.1.37)
= 1
π
 ∞
0 (e−ξ)′′ sin(xξ)dξ
= −x
π
 ∞
0 (e−ξ)′ cos(xξ)dξ
= −x
π

−1+x
 ∞
0 e−ξ sin(xξ)dξ

(5.1.38)
and we equate (5.1.38) and (5.1.37).
The statement in the theorem about the almost everywhere convergence of
H(ε)( f) to H( f) is a consequence of (5.1.30), of the fact that the alleged conver-
gence holds for Schwartz functions, and of Theorem 2.1.14. Finally, the Lp conver-
gence follows from the almost everywhere convergence and the Lebesgue dominated
convergence theorem in view of the validity of (5.1.35).
□
5.1.4 The Riesz Transforms
We now study an n-dimensional analogue of the Hilbert transform. It turns out that
there exist n operators in Rn, called the Riesz transforms, with properties analogous
to those of the Hilbert transform on R.
To deﬁne the Riesz transforms, we ﬁrst introduce tempered distributions Wj on
Rn, for 1 ≤j ≤n, as follows. For ϕ ∈S (Rn), let
4
Wj,ϕ
5
= Γ ( n+1
2 )
π
n+1
2
lim
ε→0

|y|≥ε
yj
|y|n+1 ϕ(y)dy.
One should check that indeed Wj ∈S ′(Rn). Observe that the normalization of Wj
is similar to that of the Poisson kernel.

5.1 The Hilbert Transform and the Riesz Transforms
325
Deﬁnition 5.1.13. For 1 ≤j ≤n, the jth Riesz transform of f is given by convolution
with the distribution Wj, that is,
Rj( f)(x) = ( f ∗Wj)(x) = Γ ( n+1
2 )
π
n+1
2
p.v.

Rn
xj −yj
|x−y|n+1 f(y)dy,
(5.1.39)
for all f ∈S (Rn). Deﬁnition 5.1.13 makes sense for any integrable function f that
has the property that for all x there exist Cx > 0, εx > 0, and δx > 0 such that for
y satisfying |y −x| < δx we have | f(x) −f(y)| ≤Cx|x −y|εx. The principal value
integral in (5.1.39) is as in Deﬁnition 5.1.1.
We now give a characterization of Rj using the Fourier transform. For this we
need to compute the Fourier transform of Wj.
Proposition 5.1.14. The jth Riesz transform Rj is given on the Fourier transform
side by multiplication by the function −iξ j/|ξ|. That is, for any f in S (Rn) we
have
Rj( f)(x) =

−iξ j
|ξ|
1f(ξ)
∨
(x).
(5.1.40)
Proof. The proof is essentially a reprise of the corresponding proof for the Hilbert
transform, but it involves a few technical difﬁculties. Fix a Schwartz function ϕ on
Rn. Then for 1 ≤j ≤n we have
42
Wj,ϕ
5
=
4
Wj, 1ϕ
5
(5.1.41)
= Γ ( n+1
2 )
π
n+1
2
lim
ε→0

|ξ|≥ε
1ϕ(ξ)
ξ j
|ξ|n+1 dξ
= Γ ( n+1
2 )
π
n+1
2
lim
ε→0

1
ε ≥|ξ|≥ε

Rn ϕ(x)e−2πix·ξ dx
ξ j
|ξ|n+1 dξ
= lim
ε→0

Rn ϕ(x)
)
Γ ( n+1
2 )
π
n+1
2

1
ε ≥|ξ|≥ε e−2πix·ξ
ξ j
|ξ|n+1 dξ
*
dx
= lim
ε→0

Rn ϕ(x)
Γ ( n+1
2 )
π
n+1
2

Sn−1

ε≤r≤1
ε
e−2πirx·θ
r
rn+1 rn−1drθ jdθ

dx
=

Rn ϕ(x)
)
−iΓ ( n+1
2 )
π
n+1
2

Sn−1
 ∞
0 sin(2πrx·θ) dr
r θ j dθ
*
dx
=

Rn ϕ(x)
)
−iπ
2
Γ ( n+1
2 )
π
n+1
2

Sn−1 sgn(x·θ)θ j dθ
*
dx
=

Rn −iϕ(x) xj
|x|dx,

326
5 Singular Integrals of Convolution Type
where in the penultimate equality we used the identity
 ∞
0
sint
t dt = π
2 , for which we
refer to Exercise 5.1.1, while in the last equality we used the identity
−iπ
2
Γ ( n+1
2 )
π
n+1
2

Sn−1 sgn(x·θ)θ j dθ = −i xj
|x| ,
(5.1.42)
which needs to be established. The passage of the limit inside the integral in the
previous calculation is a consequence of the Lebesgue dominated convergence the-
orem, which is justiﬁed from the fact that

 1/ε
ε
sin(2πrθ)
r
dr
 ≤4
(5.1.43)
for all ε > 0. For a proof of (5.1.43) we again refer to Exercise 5.1.1.
□
It remains to establish (5.1.42). Let us recall that O(n) is the set of all orthogonal
n × n matrices with real entries. An invertible matrix A is called orthogonal if its
transpose At is equal to its inverse A−1, that is, AAt = AtA = I.
Lemma 5.1.15. The following identity is valid for all ξ ∈Rn \{0}:

Sn−1 sgn(ξ ·θ)θ j dθ = 2π
n−1
2
Γ ( n+1
2 )
ξ j
|ξ| .
(5.1.44)
Therefore (5.1.42) holds.
Proof. We begin with the identity

Sn−1 sgn(θk)θ j dθ =
⎧
⎪
⎪
⎨
⎪
⎪
⎩
0
if k ̸= j,

Sn−1 |θ j|dθ
if k = j,
(5.1.45)
which can be proved by noting that for k ̸= j, sgn(θk) has a constant sign on the
hemispheres θk > 0 and θk < 0, on either of which the function θ →θ j has integral
zero.
It sufﬁces to prove (5.1.44) for a unit vector ξ. Given ξ ∈Sn−1, pick an orthogonal
n×n matrix A = (akl)k,l such that Aej = ξ. Then the jth column of the matrix A is
the vector (ξ1,ξ2,...,ξn)t. We have

Sn−1 sgn(ξ ·θ)θ j dθ =

Sn−1 sgn(Aej ·θ)θ j dθ
=

Sn−1 sgn(ej ·Atθ)(AAtθ) j dθ
=

Sn−1 sgn(ej ·θ)(Aθ) j dθ
=

Sn−1 sgn(θ j)(aj1θ1 +···+ξ jθ j +···+ajnθn)dθ

5.1 The Hilbert Transform and the Riesz Transforms
327
= ξ j

Sn−1 sgn(θ j)θ j dθ +
∑
1≤m̸= j≤n
0
= ξ j
|ξ|

Sn−1 |θ j|dθ .
Next, for all j ∈{1,2,...,n}, we compute the value of the integral

Sn−1 |θ j|dθ =

Sn−1 |θ1|dθ ,
which is obviously independent of j by symmetry. In view of the result of Appendix
D.2, we write

Sn−1 |θ1|dθ =
 1
−1 |s|

√
1−s2 Sn−2 dϕ
ds
(1−s2)
1
2
= ωn−2
 1
−1 |s|(1−s2)
n−3
2 ds
= ωn−2
 1
0 u
n−3
2 du
= 2ωn−2
n−1
=
2π
n−1
2
Γ ( n−1
2 ) n−1
2
= 2π
n−1
2
Γ ( n+1
2 ) ,
having used the expression for ωn−2 in Appendix A.3. This proves (5.1.44). The
proof of the lemma and hence that of Proposition 5.1.14 is complete.
□
Proposition 5.1.16. The Riesz transforms satisfy
−I =
n
∑
j=1
R2
j ,
on L2(Rn),
(5.1.46)
where I is the identity operator.
Proof. Use the Fourier transform and the identity ∑n
j=1(−iξ j/|ξ|)2 = −1 to obtain
that ∑n
j=1 R2
j( f) = −f for any f in L2(Rn).
□
We can express the mixed derivatives of Schwartz function in terms of its Lapla-
cian using the Riesz transforms.

328
5 Singular Integrals of Convolution Type
Proposition 5.1.17. For ϕ in S (Rn) and 1 ≤j,k ≤n we have
∂j∂kϕ(x) = −RjRkΔϕ(x)
(5.1.47)
for all x ∈Rn.
Proof. We verify the claimed identity by taking Fourier transforms. We have

∂j∂kϕ
1(ξ) = (2πiξ j)(2πiξk)1ϕ(ξ)
= −

−iξ j
|ξ|

−iξk
|ξ|

(−4π2|ξ|2)1ϕ(ξ)
= −

RjRkΔϕ
1(ξ)
and taking the inverse Fourier transform, identity (5.1.47) follows.
□
Next we discuss a use of the Riesz transforms to partial differential equations.
Example 5.1.18. Suppose that f is a given function in L2(Rn) and that u is a tem-
pered distribution on Rn that solves Laplace’s equation
Δu = f .
(5.1.48)
We express all second-order derivatives of u in terms of the Riesz transforms of f.
To solve equation (5.1.48) we ﬁrst show that the tempered distribution

∂j∂ku+RjRk( f)
1
is supported at {0}. In view of Proposition 2.4.1, this implies that
∂j∂ku = −RjRk( f)+P
where P is a polynomial of n variables (that depends on j and k) and provides a way
to express the mixed partials of u in terms of the Riesz transforms of f.
To verify that

∂j∂ku+RjRk( f)

1 is supported at {0}, we ﬁx a Schwartz function
ψ whose support does not contain the origin. Then ψ vanishes in a neighborhood
of zero and we can pick C ∞function η which vanishes in a smaller neighborhood
of zero and is equal to 1 on the support of ψ. We deﬁne
ζ(ξ) = −η(ξ)

−iξ j
|ξ|

−iξk
|ξ|

and we notice that ζ is a bounded C ∞function and so are all of its derivatives; also
η(ξ)(2πiξ j)(2πiξk) = ζ(ξ)(−4π2|ξ|2).
Taking the Fourier transform of both sides of (5.1.48) we obtain
(−4π2|ξ|2) 1u(ξ) = 1f(ξ)

5.1 The Hilbert Transform and the Riesz Transforms
329
and multiplying by ζ (which is allowed since all derivatives of ζ lie in L∞∩C ∞)
ζ(ξ)(−4π2|ξ|2) 1u = ζ(ξ) 2
Δu = ζ(ξ) 1f(ξ).
It follows that for all 1 ≤j,k ≤n we have
4
(∂j∂ku)1,ψ
5
=
4
(2πiξ j)(2πiξk)1u,ψ
5
=
4
(2πiξ j)(2πiξk)1u,ηψ
5
=
4
η(ξ)(2πiξ j)(2πiξk)1u,ψ
5
=
4
ζ(ξ)(−4π2|ξ|2)1u,ψ
5
=
4
ζ(ξ) 1f(ξ),ψ
5
=
4
−η(ξ)

−iξ j
|ξ|

−iξk
|ξ|
 1f(ξ),ψ
5
=
4
−η(ξ)(RjRk( f))1(ξ),ψ
5
= −
4
(RjRk( f))1,ηψ
5
= −
4
(RjRk( f))1,ψ
5
and since this holds for all Schwartz functions ψ whose support does not contain
the origin, it follows that

∂j∂ku+RjRk( f)

1 is supported at {0}.
Exercises
5.1.1. (a) Show that for all 0 < a < b < ∞we have

 b
a
sinx
x
dx
 ≤4.
(b) For a > 0 deﬁne
I(a) =
 ∞
0
sinx
x e−ax dx
and show that I(a) is continuous at zero. Differentiate in a and look at the behavior
of I(a) as a →∞to obtain the identity
I(a) = π
2 −arctan(a).
Deduce that I(0) = π
2 and also derive the following identity used in (5.1.10):
 +∞
−∞
sin(bx)
x
dx = π sgn(b).

330
5 Singular Integrals of Convolution Type
(c) Argue as in part (b) to prove for a ≥0 the identity
 ∞
0
1−cosx
x2
e−ax dx = π
2 −arctan(a)+alog
a
√
1+a2 .

Hint: Part (a): Consider the cases b ≤1, a ≤1 ≤b, 1 ≤a. When a ≥1, integrate
by parts.

5.1.2. (a) Let ϕ be a compactly supported C m+1 function on R for some m in
Z+ {0}. Prove that if ϕ(m) is the mth derivative of ϕ, then
|H(ϕ(m))(x)| ≤Cm,ϕ (1+|x|)−m−1
for some Cm,ϕ > 0.
(b) Let ϕ be a compactly supported C m+1 function on Rn for some m ∈Z+. Show
that
|Rj(∂αϕ)(x)| ≤Cn,m,ϕ (1+|x|)−n−m
for some Cn,m,ϕ > 0 and all multi-indices α with |α| = m.
(c) Let I be an interval on the line and assume that a function h is equal to 1 on the
left half of I, is equal to −1 on the right half of I, and vanishes outside I. Prove that
for x /∈2I we have
|H(h)(x)| ≤4|I|2|x−center(I)|−2 .

Hint: Use that when |t| ≤1
2 we have log(1+t) = t +R1(t), where |R1(t)| ≤2|t|2.

5.1.3. (a) Using identity (5.1.13) one may deﬁne H( f) as an element of S ′(R) for
bounded functions f on the line whose Fourier transform vanishes in a neighbor-
hood of the origin. Using this interpretation, prove that
H(eix) = −ieix ,
H(cosx) = sinx,
H(sinx) = −cosx,
H(sin(πx)/πx) = (1−cos(πx))/πx.
(b) Show that the operators given by convolution with the smooth function sin(t)/t
and the distribution p.v. cos(t)/t are bounded on Lp(R) whenever 1 < p < ∞.

Hint: Use that the Fourier transform of the distribution eix is δ1/2π.

5.1.4. ([347]) Show that the distribution function of the Hilbert transform of the
characteristic function of a measurable subset E of the real line of ﬁnite measure is
dH(χE)(α) =
4|E|
eπα −e−πα ,
α > 0.

Hint: First take E = N
j=1(aj,bj), where bj < aj+1. Show that the equation
H(χE)(x) = α has exactly one root ρ j in each open interval (aj,bj) for 1 ≤j ≤N
and exactly one root r j in each interval (bj,aj+1) for 1 ≤j ≤N, (aN+1 = ∞). Then

5.1 The Hilbert Transform and the Riesz Transforms
331
|{x ∈R : H(χE)(x) > α}| = ∑N
j=1 r j −∑N
j=1 ρ j, and this can be expressed in terms
of ∑N
j=1 aj and ∑N
j=1 bj. Argue similarly for the set {x ∈R : H(χE)(x) < −α}. For a
general measurable set E, ﬁnd sets En such that each En is a ﬁnite union of intervals
and that χEn →χE in L2. Then H(χEn) →H(χE) in measure; thus H(χEnk ) →H(χE)
a.e. for some subsequence nk. The Lebesgue dominated convergence theorem gives
dH(χEnk ) →dH(χE). See Figure 5.1.

5.1.5. Let 1 ≤p < ∞and let T be a linear operator deﬁned on the space of Schwartz
functions that commutes with dilations, i.e., T(δ λ f) = δ λT( f) for all f ∈S (Rn)
and all λ > 0. (Here δ λ( f)(x) = f(λx).) Suppose that there exists a constant C > 0
such that for all f ∈S (Rn) with Lp norm one we have
|{x : |T( f)(x)| > 1}| ≤C.
Prove that T admits a bounded extension from Lp(Rn) to Lp,∞(Rn) with norm at
most C1/p.

Hint: Try functions of the form λ −n/p f(λ −1x)/∥f∥Lp with λ > 0.

5.1.6. Let ϕ be in S (R). Prove that
lim
N→∞p.v.

R
e2πiNx
x
ϕ(x)dx = ϕ(0)πi,
lim
N→−∞p.v.

R
e2πiNx
x
ϕ(x)dx = −ϕ(0)πi.
5.1.7. Let Tα, α ∈R, be the operator given by convolution with the distribution
whose Fourier transform is the function
uα(ξ) = e−πiα sgnξ .
(a) Show that the Tα’s are isometries on L2(R) that satisfy
(Tα)−1 = T2−α .
(b) Express Tα in terms of the identity operator and the Hilbert transform.
5.1.8. Let Q( j)
y
be the jth conjugate Poisson kernel of Py deﬁned by
Q( j)
y (x) = Γ ( n+1
2 )
π
n+1
2
xj
(|x|2 +y2)
n+1
2
.
Prove that
(Q( j)
y )∧(ξ) = −i ξ j
|ξ|e−2πy|ξ| .
Conclude that Rj(Py) = Q( j)
y
and that for f in L2(Rn) we have Rj( f)∗Py = f ∗Q( j)
y .
These results are analogous to the statements 2
Qy(ξ) = −isgn(ξ) 1Py(ξ), H(Py) = Qy,
and H( f)∗Py = f ∗Qy.

332
5 Singular Integrals of Convolution Type
5.1.9. Fix n ≥2. Let f0, f1,..., fn be in L2(Rn) and, for 0 ≤j ≤n, let uj(x,x0) =
(Px0 ∗f j)(x) be the Poisson integrals of f j where x = (x1,...,xn) ∈Rn and x0 > 0.
Show that a necessary and sufﬁcient condition for
f j = Rj( f0),
j = 1,...,n,
is that the following system of generalized Cauchy-Riemann equations holds:
n
∑
j=0
∂uj
∂xj
(x,x0) = 0,
∂uj
∂xk
(x,x0) = ∂uk
∂xj
(x,x0),
0 ≤j ̸= k ≤n.
5.1.10. Prove the distributional identity
∂j|x|−n+1 = (1−n)p.v.
xj
|x|n+1 .
Then take Fourier transforms of both sides and use Theorem 2.4.6 to obtain another
proof of Proposition 5.1.14.
5.1.11. (a) Prove that if T is a bounded linear operator on L2(R) that commutes
with translations and dilations and anticommutes with the reﬂection f(x) →#f(x) =
f(−x), then T is a constant multiple of the Hilbert transform.
(b) Prove that if T is a bounded linear operator on L2(R) that commutes with transla-
tions and dilations and vanishes when applied to functions whose Fourier transform
is supported in [0,∞), then T is a constant multiple of the operator f →
 1f χ(−∞,0]
∨.
5.1.12. ([282]) Fix 1 < p ≤2.
(a) Show that the function G(x,y) = Re (|x|+iy)p is subharmonic on R2.
(b) Let u(x,y),v(x,y) be real-valued functions on R2 such that u + iv is a holomor-
phic function of x+iy. Prove that G(u,v) is a subharmonic function on R2.
(c) Prove that there is a constant Bp such that for all a and b reals we have
|b|p ≤

tan π
2p
p
|a|p −Bp Re (|a|+ib)p .
(d) Prove that for f in C ∞
0 (R) we have

R Re (| f(x)|+iH( f)(x))p dx ≥0.
(e) Combine the results in parts (d) and (c) with a = f(x), b = H( f)(x) to obtain
that
H

Lp→Lp ≤tan π
2p .

5.2 Singular Integrals and the Method of Rotations
333
(f) To deduce that this constant is sharp, take π/2p′ < γ < π/2p and let fγ(x) =
(x+1)−1|x+1|2γ/π|x−1|−2γ/π cosγ. Then
H( fγ)(x) =
⎧
⎨
⎩
1
x+1
|x+1|
|x−1|
2γ/π sinγ
when |x| > 1,
−1
x+1
|x+1|
|x−1|
2γ/π sinγ
when |x| < 1.

Hint: Part (d): Let CR be the circle of radius R centered at (0,R) in R2. Use that
the integral of the subharmonic function G((Py ∗f)(x),Qy ∗f)(x)) over CR is at
least 2πRRe (|(PR ∗f)(0)|+i(QR ∗f)(0))p and let R →∞. Part (f): The formula for
H( fγ) is best derived by considering the restriction of the analytic function
F(z) = (z+1)−1
iz+i
z−1
2γ/π
on the real line.

5.2 Homogeneous Singular Integrals and the Method
of Rotations
So far we have introduced the Hilbert and the Riesz transforms and we have de-
rived the Lp boundedness of the former. The boundedness properties of the Riesz
transforms on Lp spaces are consequences of the results discussed in this section.
5.2.1 Homogeneous Singular and Maximal Singular Integrals
We introduce singular integral operators on Rn that appropriately generalize the
Riesz transforms on Rn. Here is the setup. We ﬁx Ω to be an integrable function of
the unit sphere Sn−1 with mean value zero. Observe that the kernel
KΩ(x) = Ω(x/|x|)
|x|n
,
x ̸= 0,
(5.2.1)
is homogeneous of degree −n just like the functions xj/|x|n+1. Since KΩ is not
in L1(Rn), convolution with KΩ cannot be deﬁned as an operation on Schwartz
functions on Rn. For this reason we introduce a distributionWΩ in S ′(Rn) by setting
4
WΩ,ϕ
5
= lim
ε→0

|x|≥ε KΩ(x)ϕ(x)dx = lim
ε→0

ε≤|x|≤ε−1 KΩ(x)ϕ(x)dx
(5.2.2)

334
5 Singular Integrals of Convolution Type
for ϕ ∈S (Rn). Using the fact that Ω has mean value zero, we can easily see that
WΩ is a well deﬁned tempered distribution on Rn. Indeed, since KΩ has integral zero
over all annuli centered at the origin, we have
4
WΩ,ϕ
5 =
lim
ε→0

ε≤|x|≤1
Ω(x/|x|)
|x|n
(ϕ(x)−ϕ(0))dx+

|x|≥1
Ω(x/|x|)
|x|n
ϕ(x)dx

≤
∇ϕ

L∞

|x|≤1
|Ω(x/|x|)|
|x|n−1
dx+ sup
y∈Rn |y||ϕ(y)|

|x|≥1
|Ω(x/|x|)|
|x|n+1
dx
≤C1
∇ϕ

L∞
Ω

L1 +C2 ∑
|α|≤1
ϕ(x)xα
L∞
Ω

L1,
for suitable C1 and C2, where we used (2.2.2) in the last estimate. Note that the
distribution WΩ coincides with the function KΩ on Rn \{0}.
The Hilbert transform and the Riesz transforms are examples of these general
operators TΩ. For instance, the function Ω(θ) =
θ
π|θ| = 1
π sgnθ deﬁned on the unit
sphere S0 = {−1,1} ⫅R gives rise to the Hilbert transform, while the function
Ω(θ) = Γ ( n+1
2 )
π
n+1
2
θ j
|θ|
deﬁned on Sn−1 ⫅Rn gives rise to the jth Riesz transform.
Deﬁnition 5.2.1. Let Ω be integrable on the sphere Sn−1 with mean value zero. For
0 < ε < N and f ∈
1≤p<∞Lp(Rn) we deﬁne the truncated singular integral
T (ε,N)
Ω
( f)(x) =

ε≤|y|≤N f(x−y) Ω(y/|y|)
|y|n
dy.
(5.2.3)
Note that for f ∈Lp(Rn) we have
T (ε,N)
Ω
( f)

Lp ≤
Ω

L1 log(N/ε)
f

Lp(Rn) ,
which implies that (5.2.3) is ﬁnite a.e. and therefore well deﬁned. We denote by TΩ
the singular integral operator whose kernel is the distribution WΩ, that is,
TΩ( f)(x) = ( f ∗WΩ)(x) = lim
ε→0
N→∞
T (ε,N)
Ω
( f)(x),
deﬁned for f ∈S (Rn). The associated maximal singular integral is deﬁned by
T (∗∗)
Ω
( f) =
sup
0<N<∞
sup
0<ε<N
T (ε,N)
Ω
( f)
.
(5.2.4)

5.2 Singular Integrals and the Method of Rotations
335
We note that if Ω is bounded, there is no need to use the upper truncations in
the deﬁnition of T (ε,N)
Ω
given in (5.2.3). In this case the maximal singular integrals
could be deﬁned as
T (∗)
Ω ( f) = sup
ε>0
T (ε)
Ω ( f)
,
(5.2.5)
where for f ∈
1≤p<∞Lp(R), ε > 0, and x ∈Rn, T (ε)
Ω ( f)(x) is deﬁned in terms of
the absolutely convergent integral
T (ε)
Ω ( f)(x) =

|y|≥ε f(x−y)Ω(y/|y|)
|y|n
dy.
To examine the relationship between T (∗)
Ω
and T (∗∗)
Ω
for Ω ∈L∞(Sn−1), notice that


ε≤|y|≤N f(x−y)Ω(y/|y|)
|y|n
dy
 ≤
sup
0<N<∞
T (ε,N)
Ω
( f)(x)
.
(5.2.6)
Then for f ∈Lp(Rn), 1 ≤p < ∞, we let N →∞on the left in (5.2.6) and we note
that the limit exists in view of the absolute convergence of the integral. Then we
take the supremum over ε > 0 to deduce that T (∗)
Ω
is pointwise bounded by T (∗∗)
Ω
.
Since T (ε,N)
Ω
= T (ε)
Ω
−T (N)
Ω , it also follows that T (∗∗)
Ω
≤2T (∗)
Ω ; thus T (∗)
Ω
and T (∗∗)
Ω
are pointwise comparable when Ω lies in L∞(Sn−1). This is the case with the Hilbert
transform, that is, H(∗∗) is comparable to H(∗); likewise with the Riesz transforms.
A certain class of multipliers can be realized as singular integral operators of the
kind discussed. Recall from Proposition 2.4.7 that if m is homogeneous of degree 0
and inﬁnitely differentiable on the sphere, then m∨is given by
m∨= cδ0 +WΩ,
for some complex constant c and some smooth Ω on Sn−1 with mean value zero.
Therefore, all convolution operators whose multipliers are homogeneous of degree
zero smooth functions on Sn−1 can be realized as a constant multiple of the identity
plus an operator of the form TΩ.
Example 5.2.2. Let P(ξ) = ∑|α|=k bαξ α be a homogeneous polynomial of degree
k in Rn that vanishes only at the origin. Let α be a multi-index of order k. Then the
function
m(ξ) = ξ α
P(ξ)
(5.2.7)
is inﬁnitely differentiable on the sphere and homogeneous of degree zero. The oper-
ator given by multiplication on the Fourier transform by m(ξ) is a constant multiple
of the identity plus an operator given by convolution with a distribution of the form
WΩ for some Ω in C ∞(Sn−1) with mean value zero. In this section we establish
the Lp boundedness of such operators when Ω has appropriate smoothness on the
sphere. This, in particular, implies that m(ξ) deﬁned by (5.2.7) lies in the space
Mp(Rn), deﬁned in Section 2.5, for 1 < p < ∞.

336
5 Singular Integrals of Convolution Type
5.2.2 L2 Boundedness of Homogeneous Singular Integrals
Next we would like to compute the Fourier transform of WΩ. This provides infor-
mation as to whether the operator given by convolution with KΩ is L2 bounded. We
have the following result.
Proposition 5.2.3. Let n ≥2 and Ω ∈L1(Sn−1) have mean value zero. Then the
Fourier transform of WΩ is a (ﬁnite a.e.) function given by the formula
2
WΩ(ξ) =

Sn−1 Ω(θ)

log
1
|ξ ·θ| −iπ
2 sgn (ξ ·θ)

dθ .
(5.2.8)
Remark 5.2.4. We need to show that the function of ξ on the right in (5.2.8) is well
deﬁned and ﬁnite for almost all ξ in Rn. Write ξ = |ξ|ξ ′ where ξ ′ ∈Sn−1 and notice
that
log
1
|ξ ·θ| = log 1
|ξ| +log
1
|ξ ′ ·θ| .
Since Ω has mean value zero, the term log 1
|ξ| multiplied by Ω(θ) vanishes when
integrated over the sphere.
We need to show that

Sn−1 |Ω(θ)|log
1
|ξ ′ ·θ| dθ < ∞
(5.2.9)
for almost all ξ ′ ∈Sn−1. Integrate (5.2.9) over ξ ′ ∈Sn−1 and apply Fubini’s theorem
to obtain

Sn−1 |Ω(θ)|

Sn−1 log
1
|ξ ′ ·θ| dξ ′ dθ
=

Sn−1 |Ω(θ)|

Sn−1 log 1
|ξ1| dξ dθ
= ωn−2

Sn−1 |Ω(θ)|
 +1
−1

log 1
|s|

(1−s2)
n−3
2 dsdθ
= Cn
Ω

L1(Sn−1) < ∞,
since we are assuming that n ≥2. (The second-to-last identity follows from the
identity in Appendix D.2.) We conclude that (5.2.9) holds for almost all ξ ′ ∈Sn−1.
Since the function of ξ on the right in (5.2.8) is homogeneous of degree zero, it
follows that it is a locally integrable function on Rn.
Before we return to the proof of Proposition 5.2.3, we discuss the following
lemma:
Lemma 5.2.5. Let a be a nonzero real number. Then for 0 < ε < N < ∞we have
lim
ε→0
N→∞
 N
ε
cos(ra)−cos(r)
r
dr = log 1
|a| ,
(5.2.10)

5.2 Singular Integrals and the Method of Rotations
337

 N
ε
cos(ra)−cos(r)
r
dr
 ≤2
log 1
|a|

for all N > ε > 0,
(5.2.11)
lim
ε→0
N→∞
 N
ε
e−ira −cos(r)
r
dr = log 1
|a| −iπ
2 sgn a,
(5.2.12)

 N
ε
e−ira −cos(r)
r
dr
 ≤2
log 1
|a|
+4
for all N > ε > 0.
(5.2.13)
Proof. We ﬁrst prove (5.2.10) and (5.2.11). By the fundamental theorem of calculus
we write
 N
ε
cos(ra)−cos(r)
r
dr =
 N
ε
cos(r|a|)−cos(r)
r
dr
= −
 N
ε
 |a|
1
sin(tr)dt dr
= −
 |a|
1
 N
ε sin(tr)drdt
= −
 |a|
1
cos(εt)
t
dt +
 N|a|
N
cos(t)
t
dt ,
and from this expression, we clearly obtain (5.2.11). But the ﬁrst integral of the
same expression converges to −log|a| as ε →0 while the second integral converges
to zero as N →∞by an integration by parts. This proves (5.2.10).
To prove (5.2.12) and (5.2.13) we need to know that the expressions

 N
ε
sin(ra)
r
dr
 =

 N|a|
ε|a|
sin(r)
r
dr

(5.2.14)
tend to π
2 as ε →0 and N →∞and are bounded by 4. Both statements follow from
Exercise 5.1.1.
□
Let us now prove Proposition 5.2.3.
Proof. Let us set ξ ′ = ξ/|ξ|. We have the following:
4 2
WΩ,ϕ
5
=
4
WΩ, 1ϕ
5
= lim
ε→0

|x|≥ε
Ω(x/|x|)
|x|n
1ϕ(x)dx
= lim
ε→0
N→∞

ε≤|x|≤N
Ω(x/|x|)
|x|n
1ϕ(x)dx
= lim
ε→0
N→∞

Rn ϕ(ξ)

ε≤|x|≤N
Ω(x/|x|)
|x|n
e−2πix·ξ dx dξ
= lim
ε→0
N→∞

Rn ϕ(ξ)

Sn−1 Ω(θ)

ε≤r≤N
e−2πirθ·ξ dr
r dθ dξ

338
5 Singular Integrals of Convolution Type
= lim
ε→0
N→∞

Rn ϕ(ξ)

Sn−1 Ω(θ)

ε≤r≤N

e−2πr|ξ|iθ·ξ ′ −cos(2πr|ξ|)
dr
r dθ dξ
= lim
ε→0
N→∞

Rn ϕ(ξ)

Sn−1 Ω(θ)

ε
2π|ξ| ≤r≤
N
2π|ξ|
e−irθ·ξ ′ −cos(r)
r
drdθ dξ
=

Rn ϕ(ξ)

Sn−1 Ω(θ)

log
1
|ξ ′ ·θ| −iπ
2 sgn(ξ ·θ)

dθ dξ,
where we used the Lebesgue dominated convergence theorem to pass the limit in-
side, Lemma 5.2.5, and Remark 5.2.4. We were able to subtract cos(2πr|ξ|) from
the r integral in the previous calculation, since Ω has mean value zero over the
sphere. Also, the use of the dominated convergence theorem is justiﬁed from the
fact that the function
(θ,ξ) →|Ω(θ)||ϕ(ξ)|

log
1
|ξ ′ ·θ| +4

lies in L1(Sn−1 × Rn). Moreover, all the interchanges of integrals are well justiﬁed
by Fubini’s theorem.
□
Corollary 5.2.6. Let Ω ∈L1(Sn−1) have mean value zero. Then for almost all ξ ′ in
Sn−1 the integral

Sn−1 Ω(θ)log
1
|ξ ′ ·θ|dθ
(5.2.15)
converges absolutely. Moreover, the associated operator TΩ maps L2(Rn) to itself if
and only if
ess.sup
ξ ′∈Sn−1


Sn−1 Ω(θ)log
1
|ξ ′ ·θ|dθ
 < ∞.
(5.2.16)
Proof. To obtain the absolute convergence of the integral in (5.2.15) we integrate
over ξ ′ ∈Sn−1 and we apply Fubini’s theorem. The assertion concerning the bound-
edness of TΩ on L2 is an immediate consequence of Proposition 5.2.3 and Theorem
2.5.10.
□
There exist functions Ω in L1(Sn−1) with mean value zero such that the ex-
pressions in (5.2.16) are equal to inﬁnity; consequently, not all such Ω give rise
to bounded operators on L2(Rn). Observe, however, that for Ω odd i.e., Ω(−θ) =
−Ω(θ) for all θ ∈Sn−1, (5.2.16) trivially holds, since log
1
|ξ·θ| is even and its prod-
uct against an odd function must have integral zero over Sn−1. We conclude that
singular integrals TΩ with odd Ω are always L2 bounded.

5.2 Singular Integrals and the Method of Rotations
339
5.2.3 The Method of Rotations
Having settled the issue of L2 boundedness for singular integrals of the form TΩ with
Ω odd, we turn our attention to their Lp boundedness. A simple procedure called the
method of rotations plays a crucial role in the study of operators TΩ when Ω is an
odd function. This method is based on the use of the directional Hilbert transforms.
Fix a unit vector θ in Rn. For a Schwartz function f on Rn let
Hθ( f)(x) = 1
π p.v.
 +∞
−∞f(x−tθ)dt
t .
(5.2.17)
We call Hθ( f) the directional Hilbert transform of f in the direction θ. For func-
tions f ∈S (Rn) the integral in (5.2.17) is well deﬁned, since it converges rapidly at
inﬁnity and by subtracting the constant f(x), it also converges near zero.
Likewise, we deﬁne the directional maximal Hilbert transforms. For a function
f in 
1≤p<∞Lp(Rn) and 0 < ε < N < ∞we let
H (ε,N)
θ
( f)(x) = 1
π

ε≤|t|≤N
f(x−tθ)dt
t ,
H (∗∗)
θ
( f)(x) =
sup
0<ε<N<∞
H (ε,N)
θ
( f)(x)
.
We observe that for any ﬁxed 0 < ε < N < ∞and f ∈Lp(Rn), H (ε,N)
θ
( f) is well
deﬁned almost everywhere. Indeed, by Minkowski’s integral inequality we obtain
H (ε,N)
θ
( f)

Lp(Rn) ≤2
π
f

Lp(Rn) log N
ε < ∞,
which implies that H (ε,N)
θ
( f)(x) is ﬁnite for almost all x ∈Rn. Thus H (∗∗)
θ
( f) is
well deﬁned for f in 
1≤p<∞Lp(Rn).
Theorem 5.2.7. If Ω is odd and integrable over Sn−1, then TΩ and T (∗∗)
Ω
are Lp
bounded for all 1 < p < ∞. More precisely, TΩ initially deﬁned on Schwartz func-
tions has a bounded extension on Lp(Rn) (which is also denoted by TΩ).
Proof. Let ej be the usual unit vectors in Sn−1. The operator He1 is obtained by
applying the Hilbert transform in the ﬁrst variable followed by the identity operator
in the remaining variables. Clearly, He1 is bounded on Lp(Rn) with norm equal to
that of the Hilbert transform on Lp(R). Next observe that the following identity is
valid for all matrices A ∈O(n):
HA(e1)( f)(x) = He1( f ◦A)(A−1x).
(5.2.18)
This implies that the Lp boundedness of Hθ can be reduced to that of He1. We
conclude that Hθ is Lp bounded for 1 < p < ∞with norm bounded by the norm of
the Hilbert transform on Lp(R) for every θ ∈Sn−1.

340
5 Singular Integrals of Convolution Type
Identity (5.2.18) is also valid for H (ε,N)
θ
and H (∗∗)
θ
. Consequently, H (∗∗)
θ
is
bounded on Lp(Rn) for 1 < p < ∞with norm at most that of H(∗∗) on Lp(R).
Next we realize a general singular integral TΩ with Ω odd as an average of the
directional Hilbert transforms Hθ. We start with f in 
1≤p<∞Lp(Rn) and the fol-
lowing identities:

ε≤|y|≤N
Ω(y/|y|)
|y|n
f(x−y)dy = +

Sn−1 Ω(θ)
 N
r=ε f(x−rθ) dr
r dθ
= −

Sn−1 Ω(θ)
 N
r=ε f(x+rθ) dr
r dθ,
where the ﬁrst follows by switching to polar coordinates and the second one is a
consequence of the ﬁrst one and the fact that Ω is odd via the change variables
θ →−θ. Averaging the two identities, we obtain

ε≤|y|≤N
Ω(y/|y|)
|y|n
f(x−y)dy
= 1
2

Sn−1 Ω(θ)
 N
r=ε
f(x−rθ)−f(x+rθ)
r
drdθ
= π
2

Sn−1 Ω(θ)H (ε,N)
θ
( f)(x)dθ.
(5.2.19)
It follows from the identity in (5.2.19) that

ε≤|y|≤N
Ω(y/|y|)
|y|n
f(x−y)dy = π
2

Sn−1 Ω(θ)H (ε,N)
θ
( f)(x)dθ ,
(5.2.20)
from which we conclude that
T (∗∗)
Ω
( f)(x) ≤π
2

Sn−1 |Ω(θ)|H (∗∗)
θ
( f)(x)dθ .
(5.2.21)
Using the Lebesgue dominated convergence theorem, we see that for f in S (Rn),
we can pass the limits as ε →0 and N →∞inside the integral in (5.2.20), concluding
that
TΩ( f)(x) = π
2

Sn−1 Ω(θ)Hθ( f)(x)dθ ,
(5.2.22)
for f ∈S (Rn). The Lp boundedness of TΩ and T (∗∗)
Ω
for Ω odd are then trivial
consequences of (5.2.22) and (5.2.21) via Minkowski’s integral inequality.
□
Corollary 5.2.8. The Riesz transforms R j and the maximal Riesz transforms R(∗)
j
are bounded on Lp(Rn) for 1 < p < ∞.
Proof. The assertion follows from the fact that the Riesz transforms have odd ker-
nels. Since the kernel of Rj decays like |x|−n near inﬁnity, it follows that R(∗)
j ( f) is
well deﬁned for f ∈Lp(Rn). Since R(∗)
j
is pointwise bounded by 2R(∗∗)
j
, the conclu-
sion follows from Theorem 5.2.7.
□

5.2 Singular Integrals and the Method of Rotations
341
Remark 5.2.9. It follows from the proof of Theorem 5.2.7 and from Theorems 5.1.7
and 5.1.12 that whenever Ω is an odd function on Sn−1, we have
TΩ

Lp→Lp ≤
Ω

L1

a p
when p ≥2,
a(p−1)−1
when 1 < p ≤2,
T (∗∗)
Ω

Lp→Lp ≤
Ω

L1

a p
when p ≥2,
a(p−1)−1
when 1 < p ≤2,
for some a > 0 independent of p and the dimension.
5.2.4 Singular Integrals with Even Kernels
Since a general integrable function Ω on Sn−1 with mean value zero can be written
as a sum of an odd and an even function, it sufﬁces to study singular integral opera-
tors TΩ with even kernels. For the rest of this section, ﬁx an integrable even function
Ω on Sn−1 with mean value zero. The following idea is fundamental in the study of
such singular integrals. Proposition 5.1.16 implies that
TΩ = −
n
∑
j=1
RjRjTΩ .
(5.2.23)
If RjTΩ were another singular integral operator of the form TΩ j for some odd Ω j,
then the boundedness of TΩ would follow from that of TΩ j via the identity (5.2.23)
and Theorem 5.2.7. It turns out that RjTΩ does have an odd kernel, but it may not be
integrable on Sn−1 unless Ω itself possesses an additional amount of integrability.
The amount of extra integrability needed is logarithmic, more precisely of this sort:
cΩ =

Sn−1 |Ω(θ)|log+ |Ω(θ)|dθ < ∞.
(5.2.24)
Observe that
Ω

L1 ≤cΩ +eωn−1 ≤Cn (cΩ +1),
which says that the norm ∥Ω∥L1 is always controlled by a dimensional constant
multiple of cΩ +1. The following theorem is the main result of this section.
Theorem 5.2.10. Let n ≥2 and let Ω be an even integrable function on Sn−1 with
mean value zero that satisﬁes (5.2.24). Then the corresponding singular integral
TΩ is bounded on Lp(Rn), 1 < p < ∞, with norm at most a dimensional constant
multiple of the quantity max

(p−1)−2, p2
(cΩ +1).
If the operator TΩ in Theorem 5.2.10 is weak type (1,1), then the estimate on the
Lp operator norm of TΩ can be improved to ∥TΩ∥Lp→Lp ≤Cn(p −1)−1 as p →1.
This is indeed the case; see the historical comments at the end of this chapter.

342
5 Singular Integrals of Convolution Type
Proof. Let WΩ be the distributional kernel of TΩ. We have that WΩ coincides with
the function Ω(x/|x|)|x|−n on Rn \{0}. Using Proposition 5.2.3 and the fact that Ω
is an even function, we obtain the formula
2
WΩ(ξ) =

Sn−1 Ω(θ)log
1
|ξ ·θ| dθ ,
(5.2.25)
which implies that 2
WΩ is itself an even function. Now, using Exercise 5.2.3 and
condition (5.2.24), we conclude that 2
WΩ is a bounded function. Therefore, TΩ is L2
bounded. To obtain the Lp boundedness of TΩ, we use the idea mentioned earlier
involving the Riesz transforms. In view of (5.1.46), we have that
TΩ = −
n
∑
j=1
RjTj,
(5.2.26)
where Tj = RjTΩ. Equality (5.2.26) makes sense as an operator identity on L2(Rn),
since TΩ and each Rj are well deﬁned and bounded on L2(Rn).
The kernel of the operator Tj is the inverse Fourier transform of the distribu-
tion −i ξ j
|ξ| 2
WΩ(ξ), which we denote by Kj. At this point we know only that Kj is
a tempered distribution whose Fourier transform is the function −i ξ j
|ξ| 2
WΩ(ξ). Our
ﬁrst goal is to show that Kj coincides with an integrable function on an annulus. To
prove this assertion we write
WΩ = W 0
Ω +W 1
Ω +W ∞
Ω ,
where W 0
Ω is a distribution and W 1
Ω,W ∞
Ω are functions deﬁned by
4
W 0
Ω,ϕ
5
= lim
ε→0

ε<|x|≤1
2
Ω(x/|x|)
|x|n
ϕ(x)dx,
W 1
Ω(x) = Ω(x/|x|)
|x|n
χ 1
2 ≤|x|≤2 ,
W ∞
Ω (x) = Ω(x/|x|)
|x|n
χ2<|x| .
We now ﬁx a j ∈{1,2,...,n} and we write
Kj = K0
j +K1
j +K∞
j ,
where
K0
j =

−i ξ j
|ξ| 2
W 0
Ω(ξ)
∨,
K1
j =

−i ξ j
|ξ| 2
W 1
Ω(ξ)
∨,
K∞
j =

−i ξ j
|ξ|3
W ∞
Ω (ξ)
∨.
Notice that K0
j is well deﬁned via Theorem 2.3.21.

5.2 Singular Integrals and the Method of Rotations
343
Deﬁne the annulus
A = {x ∈Rn : 2/3 < |x| < 3/2}.
For a smooth function φ supported in the annulus 2/3 < |x| < 3/2 we have
4
K0
j ,φ
5
=
4
(−i ξ j
|ξ| 2
W 0
Ω(ξ)
∨,φ
5
=
4
−i ξ j
|ξ| 2
W 0
Ω(ξ),φ ∨(ξ)
5
=
4 2
W 0
Ω(ξ),−i ξ j
|ξ|φ ∨(ξ)
5
=
4
W 0
Ω,

−i ξ j
|ξ|φ ∨(ξ)
∧5
= −
4
W 0
Ω,
Rj(φ)
5
= −lim
ε→0

ε<|y|<1/2
Ω(y/|y|)
|y|n
Rj(φ)(−y)dy
(Ω is even)
= −Γ ( n+1
2 )
π
n+1
2
lim
ε→0

ε<|y|<1/2
Ω(y/|y|)
|y|n

Rn
yj −xj
|y−x|n+1 φ(x)dxdy,
where the action of the distribution W 0
Ω on Rj(φ) is justiﬁed by fact that Rj(φ)(y) is
smooth on the support of W 0
Ω; note |x −y| ≥1/6. Moreover, ⟨2
W 0
Ω(ξ),−i ξ j
|ξ|φ ∨(ξ)⟩
should be interpreted as a convergent integral.
It follows that for x ∈A, the absolute value of the convolution of W 0
Ω with the
kernel of the Riesz transform Rj is

Γ ( n+1
2 )
π
n+1
2
lim
ε→0

ε<|y|< 1
2
xj −yj
|x−y|n+1
Ω(y/|y|)
|y|n
dy

(5.2.27)
=

Γ ( n+1
2 )
π
n+1
2

|y|< 1
2
 xj −yj
|x−y|n+1 −
xj
|x|n+1
 Ω(y/|y|)
|y|n
dy

(5.2.28)
≤

|y|≤1
2
Cn|y| |Ω(y/|y|)|
|y|n
dy
= C′
n
Ω

L1 ,
where we used the fact that Ω(y/|y|)|y|−n has integral zero over annuli of the form
ε < |y| < 1
2, the mean value theorem applied to the function xj|x|−(n+1), and the fact
that |x−y| ≥1/6 for x in the annulus A. We conclude that on A, K0
j coincides with
the bounded function inside the absolute value in (5.2.27).

344
5 Singular Integrals of Convolution Type
Likewise, for x ∈A we have
Γ ( n+1
2 )
π
n+1
2


|y|>2
xj −yj
|x−y|n+1
Ω(y/|y|)
|y|n
dy

(5.2.29)
≤Γ ( n+1
2 )
π
n+1
2

|y|>2
1
|x−y|n
|Ω(y/|y|)|
|y|n
dy
≤Γ ( n+1
2 )
π
n+1
2

|y|>2
4n
|y|2n |Ω(y/|y|)|dy
= C
Ω

L1,
from which it follows that on the annulus A, K∞
j coincides with the bounded function
inside the absolute value in (5.2.29) or in (5.2.28).
Now observe that condition (5.2.24) gives that the function W 1
Ω satisﬁes

|x|≤2 |W 1
Ω(x)| log+ |W 1
Ω(x)|dx
≤
 2
1/2

Sn−1
|Ω(θ)|
rn
log+[2n|Ω(θ)|]dθrn−1 dr
r
≤(log4)

n(log2)
Ω

L1 +cΩ

< ∞.
Since the Riesz transform Rj is countably subadditive and maps Lp to Lp with norm
at most 4(p−1)−1 for 1 < p < 2, it follows from Exercise 1.3.7 that K1
j = Rj(W 1
Ω)
is integrable over the ball |x| ≤3/2 and moreover, it satisﬁes

A |K1
j (x)|dx ≤Cn

|x|≤2 |W 1
Ω(x)| log+ |W 1
Ω(x)|dx+1

≤C′
n(cΩ +1).
Furthermore, since 2
Kj is homogeneous of degree zero, Kj is a homogeneous
distribution of degree −n (Exercise 2.3.9). This means that for all test functions ϕ
and all λ > 0 we have
4
Kj,δ λ(ϕ)
5
=
4
Kj,ϕ
5
,
(5.2.30)
where δ λ(ϕ)(x) = ϕ(λx). But for ϕ ∈C ∞
0 supported in the annulus 3/4 < |x| < 4/3
and for λ in (8/9,9/8) we have that δ λ −1(ϕ) is supported in A and thus we can
express (5.2.30) as convergent integrals as follows:

Rn Kj(x)ϕ(x)dx =

Rn Kj(x)ϕ(λ −1x)dx =

Rn λ nKj(λx)ϕ(x)dx.
(5.2.31)
From this it would be ideal to be able to directly obtain that Kj(x) = λ nKj(λx) for all
8/9 < |x| < 9/8 and 8/9 < λ < 9/8, in particular when λ = |x|−1. But unfortunately,
we can only deduce that for every λ ∈(8/9,9/8), Kj(x) = λ nKj(λx) holds for all x
in the annulus except a set of measure zero that depends on λ. To be able to deﬁne
the restriction of Kj on Sn−1, we employ a more delicate argument.

5.2 Singular Integrals and the Method of Rotations
345
For any J subinterval of [8/9,9/8] we obtain from (5.2.31) that

Rn Kj(x)ϕ(x)dx =

Rn −

J λ nKj(λx)dλ ϕ(x)dx,
where integral with the slashed integral denotes the average of a function over the set
J. Since ϕ was an arbitrary C ∞
0 function supported in the annulus 3/4 < |x| < 4/3,
it follows that for every J subinterval of [8/9,9/8], there is a null subset EJ of the
annulus A′ = {x : 27/32 < |x| < 32/27} such that
Kj(x) = −

J λ nKj(λx)dλ
(5.2.32)
for all x ∈A′ \EJ.
Let J0 = [
"
8/9,
"
9/8]. We claim that there is a set of null subset E of A′ such
that for all x ∈A′ \E we have
−

J0
λ nKj(λx)dλ = −

rJ0
λ nKj(λx)dλ
(5.2.33)
for every r in J0. Indeed, let E be the union of ErJ0 over all r in J0 ∩Q. Then in
view of (5.2.32), identity (5.2.33) holds for x ∈A′ \E and J0 ∩Q. But for a ﬁxed x in
A′ \E, the function of r on the right hand side of (5.2.33) is constant on the rationals
and is also continuous (in r), hence it must be constant for all r ∈J0. Thus the claim
follows since both sides of (5.2.33) are equal to (5.2.32).
Writing x = δθ, where 27/32 < δ < 32/27 and θ ∈Sn−1, it follows by Fubini’s
theorem that there is a δ ∈(27/32,32/27) (in fact almost all δ have this property)
such that
−

J0
λ nKj(λδθ)dλ = −

rJ0
λ nKj(λδθ)dλ
(5.2.34)
for almost all θ ∈Sn−1 and all r ∈J0. We ﬁx such a δ, which we denote δ0.
We now deﬁne a function Ω j on Sn−1 by setting
Ω j(θ) = −

J0
δ n
0 λ nKj(λδ0θ)dλ = −

rJ0
δ n
0 λ nKj(λδ0θ)dλ
for all r ∈J0. The function Ω j is deﬁned almost everywhere and is integrable over
Sn−1, since Kj is integrable over the annulus A.
Let e1 = (1,0,...,0). Let Ψ be a C ∞
0 (Rn) nonzero, nonnegative, radial, and sup-
ported in the annulus 32/(27
√
2) < |x| < 27
√
2/32 around Sn−1. We start with
Ω j(θ) = −

r−1J0
δ n
0 λ nKj(λδ0θ)dλ = −

J0
δ n
0 rnλ nKj(rλδ0θ)dλ ,
which holds for all r ∈J0, we multiply by Ψ(re1), and we integrate over Sn−1 and
over (0,∞) with respect to the measure dr/r. We obtain

346
5 Singular Integrals of Convolution Type
 ∞
0 Ψ(re1)dr
r

Sn−1Ω j(θ)dθ = −

J0
 ∞
0

Sn−1δ n
0 λ nKj(λδ0rθ)Ψ(re1)rndθ dr
r dλ
= −

J0

Rn δ n
0 λ nKj(λδ0x)Ψ(x)dxdλ
= −

J0

Rn Kj(x)Ψ((λδ0)−1x)dxdλ
= −

J0
4
Kj,Ψ
5
dλ ,
=
4
Kj,Ψ
5
in view of the homogeneity of Kj. But also, for some constant c′
Ψ we have
4
Kj,Ψ
5
=
42
Kj, 1
Ψ
5
=

Rn
−iξ j
|ξ|
2
WΩ(ξ) 1
Ψ(ξ)dξ = c′
Ψ

Sn−1
−iθ j
|θ|
2
WΩ(θ)dθ = 0,
since by (5.2.25), −iξ j
|ξ| 2
WΩ(ξ) is an odd function. We conclude that Ω j has mean
value zero over Sn−1.
Thus Ω ∈L1(Sn−1) has mean value zero and the distribution WΩ j is well deﬁned.
We claim that
Kj = WΩ j .
(5.2.35)
To establish (5.2.35), we show ﬁrst that
4
Kj,ϕ
5
=
4
WΩ j,ϕ
5
whenever ϕ is sup-
ported in the annulus 8/9 < |x| < 9/8. Using (5.2.32) we have

Rn Kj(x)ϕ(x)dx =

Rn −

J0
Kj(δ0λx)δ n
0 λ ndλ ϕ(x)dx
=
 ∞
0

Sn−1 −

J0
Kj(δ0λrθ)δ n
0 λ nrn dλ ϕ(rθ)dθ dr
r
=
 ∞
0

Sn−1 −

rJ0
Kj(δ0λ ′θ)δ n
0 (λ ′)ndλ ′ ϕ(rθ)dθ dr
r
=
 ∞
0

Sn−1 Ω j(θ)ϕ(rθ)dθ dr
r
=
4
WΩ j,ϕ
5
,
having used (5.2.34) in the second to last equality.
Given a general C ∞
0 function ϕ whose support is contained in an annulus of the
form M−1 < |x| < M, for some M > 0, via a smooth partition of unity, we write ϕ as a
ﬁnite sum of smooth functions ϕk whose supports are contained in annuli of the form
8s/9 < |x| < 9s/8 for some s > 0. These annuli can be brought inside the annulus
8/9 < |x| < 9/8 by a dilation. Since both Kj and WΩ j are homogeneous distributions
of degree −n and agree on the annulus 8/9 < |x| < 9/8 they must agree on annuli
8s/9 < |x| < 9s/8. Consequently, ⟨Kj,ϕ⟩= ⟨WΩ j,ϕ⟩for all ϕ ∈C ∞
0 (Rn \ {0}).
Therefore, Kj −WΩ j is supported at the origin, and since it is homogeneous of degree
−n, it must be equal to bδ0, a constant multiple of the Dirac mass. But 2
Kj is an

5.2 Singular Integrals and the Method of Rotations
347
odd function and hence Kj is also odd. It follows that WΩ j is an odd function on
Rn \{0}, which implies that Ω j is an odd function. We say that u ∈S ′(Rn) is odd
if #u = −u, where #u is deﬁned by ⟨#u,ψ⟩= ⟨u, #ψ⟩for all ψ ∈S (Rn) and #ψ(x) =
ψ(−x). We have that Kj −WΩ j is an odd distribution, and thus bδ0 must be an odd
distribution. But if bδ0 is odd, then b = 0. We conclude that for each j there exists an
odd integrable function Ω j on Sn−1 with ∥Ω j∥L1 controlled by a constant multiple
of cΩ +1 such that (5.2.35) holds.
Then we use (5.2.26) and (5.2.35) to write
TΩ = −
n
∑
j=1
RjTΩ j ,
and appealing to the boundedness of each TΩ j (Theorem 5.2.7) and to that of the
Riesz transforms, we obtain the required Lp boundedness for TΩ.
□
We note that Theorem 5.2.10 holds for all Ω ∈L1(Sn−1) that satisfy (5.2.24), not
necessarily even Ω. Simply write Ω = Ωe + Ωo , where Ωe is even and Ωo is odd,
and check that condition (5.2.24) holds for Ωe.
5.2.5 Maximal Singular Integrals with Even Kernels
We have the corresponding theorem for maximal singular integrals.
Theorem 5.2.11. Let Ω be an even integrable function on Sn−1 with mean value
zero that satisﬁes (5.2.24). Then the corresponding maximal singular integral T (∗∗)
Ω
,
deﬁned in (5.2.4), is bounded on Lp(Rn) for 1 < p < ∞with norm at most a dimen-
sional constant multiple of max(p2,(p−1)−2)(cΩ +1).
Proof. For f ∈L1
loc(Rn), x deﬁne the maximal function of f in the direction θ by
setting
Mθ( f)(x) = sup
a>0
1
2a

|r|≤a | f(x−rθ)|dr.
(5.2.36)
In view of Exercise 5.2.5 we have that Mθ is bounded on Lp(Rn) with norm at most
3 p(p−1)−1.
Fix Φ a smooth radial function such that Φ(x) = 0 for |x| ≤1/4, Φ(x) = 1 for
|x| ≥3/4, and 0 ≤Φ(x) ≤1 for all x in Rn. For f ∈Lp(Rn) and 0 < ε < N < ∞we
introduce the smoothly truncated singular integral
#T (ε,N)
Ω
( f)(x) =

Rn
Ω
 y
|y|

|y|n

Φ
 y
ε

−Φ
 y
N

f(x−y)dy
and the corresponding maximal singular integral operator
#T (∗∗)
Ω
( f) =
sup
0<N<∞
sup
0<ε<N
|#T (ε,N)
Ω
( f)|.
(5.2.37)
Computing the supremum in (5.2.37), we ﬁrst consider the case where N > 4ε.

348
5 Singular Integrals of Convolution Type
For f in Lp(Rn) (for some 1 < p < ∞), we have
#T (ε,N)
Ω
( f)(x)−T (ε,N)
Ω
( f)(x)

=


ε
4 ≤|y|≤ε
Ω
 y
|y|

|y|n
Φ
 y
ε

f(x−y)dy−

N
4 ≤|y|≤N
Ω
 y
|y|

|y|n
Φ
 y
N

f(x−y)dy

≤


ε
4 ≤|y|≤ε
|Ω
 y
|y|

|
|y|n
| f(x−y)|dy+

N
4 ≤|y|≤N
|Ω
 y
|y|

|
|y|n
| f(x−y)|dy

≤

Sn−1
|Ω(θ)|
4
ε
 ε
ε
4
| f(x−rθ)|dr + 4
N
 N
N
4
| f(x−rθ)|dr

dθ
≤16

Sn−1 |Ω(θ)|Mθ( f)(x)dθ .
Now if N ≤4ε, then the function Φ
 y
ε

−Φ
 y
N

−χε≤|y|≤N is bounded by 3 and is
supported in the annulus ε
4 ≤|y| ≤4ε. In this case we obtain
#T (ε,N)
Ω
( f)(x)−T (ε,N)
Ω
( f)(x)
 ≤3

Sn−1
|Ω(θ)|
 4ε
ε
4
| f(x−rθ)| dr
r dθ
≤96

Sn−1 |Ω(θ)|Mθ( f)(x)dθ .
We deduce from these estimates that
sup
0<ε<N<∞
#T (ε,N)
Ω
( f)(x)−T (ε,N)
Ω
( f)(x)
 ≤96

Sn−1 |Ω(θ)|Mθ( f)(x)dθ .
Using the result of Exercise 5.2.5 we conclude that
#T (∗∗)
Ω
( f)−T (∗∗)
Ω
( f)

Lp ≤600
Ω

L1 max(p,(p−1)−1)
f

Lp .
This implies that it sufﬁces to obtain the required Lp bound for the smoothly trun-
cated maximal singular integral operator #T (∗∗)
Ω
.
Let Kj, Ω j, and Tj be as in the previous theorem, and let Fj be the Riesz transform
of the function Ω(x/|x|)Φ(x)|x|−n. Let f ∈Lp(Rn). A calculation yields the identity
#T (ε,N)
Ω
( f)(x) =

Rn
 1
εn
Ω( y
ε /| y
ε |)
| y
ε |n
Φ( y
ε )−1
Nn
Ω( y
N /| y
N |)
| y
N |n
Φ( y
N )

f(x−y)dy
= −
 n
∑
j=1
/
1
εn Fj
 ·
ε

−1
Nn Fj
 ·
N
0
∗Rj( f)

(x),

5.2 Singular Integrals and the Method of Rotations
349
where in the last step we used Proposition 5.1.16. Therefore we may write
−#T (ε,N)
Ω
( f)(x) =
n
∑
j=1

Rn

1
εn Fj
 x−y
ε

−1
Nn Fj
 x−y
N

Rj( f)(y)dy
= A(ε,N)
1
( f)(x)+A(ε,N)
2
( f)(x)+A(ε,N)
3
( f)(x),
(5.2.38)
where
A(ε,N)
1
( f)(x) =
n
∑
j=1
1
εn

|x−y|≤ε Fj
 x−y
ε

Rj( f)(y)dy
−
n
∑
j=1
1
Nn

|x−y|≤N Fj
 x−y
N

Rj( f)(y)dy,
A(ε,N)
2
( f)(x) =
n
∑
j=1

Rn
/
1
εn χ|x−y|>ε
	
Fj
 x−y
ε

−Kj
 x−y
ε

−1
Nn χ|x−y|>N
	
Fj
 x−y
N

−Kj
 x−y
N

0
Rj( f)(y)dy,
A(ε,N)
3
( f)(x) =
n
∑
j=1

Rn
/
1
εn χ|x−y|>εKj
 x−y
ε

−1
Nn χ|x−y|>NKj
 x−y
N
0
Rj( f)(y)dy.
It follows from the deﬁnitions of Fj and Kj that
Fj(z)−Kj(z) = Γ ( n+1
2 )
π
n+1
2
lim
ε→0

ε≤|y|
Ω(y/|y|)
|y|n

Φ(y)−1
 z j −yj
|z−y|n+1 dy
= Γ ( n+1
2 )
π
n+1
2

|y|≤3
4
Ω(y/|y|)
|y|n

Φ(y)−1
$ z j −yj
|z−y|n+1 −
z j
|z|n+1
%
dy
whenever |z| ≥1. But using the mean value theorem, the last expression is easily
seen to be bounded by
Cn

|y|≤3
4
Ω(y/|y|)
|y|n
|y|
|z|n+1 dy = C′
n
Ω

L1|z|−(n+1) ,
whenever |z| ≥1. Using this estimate, we obtain that the jth term in A(ε,N)
2
( f)(x) is
bounded by
Cn
∥Ω∥L1
εn

|x−y|>ε
|Rj( f)(y)|dy
(|x−y|/ε)n+1 ≤Cn
2∥Ω∥L1
2−nεn

Rn
|Rj( f)(y)|dy

1+ |x−y|
ε
n+1 .
It follows that for functions f in Lp we have
sup
0<ε<N<∞
|A(ε,N)
2
( f)| ≤Cn
Ω

L1M(Rj( f)),

350
5 Singular Integrals of Convolution Type
in view of Theorem 2.1.10. (M here is the Hardy–Littlewood maximal operator.)
By Theorem 2.1.6, M maps Lp(Rn) to itself with norm bounded by a dimensional
constant multiple of max(1,(p−1)−1). Since by Remark 5.2.9 the norm
Rj

Lp→Lp
is controlled by a dimensional constant multiple of max(p,(p−1)−1), it follows that

sup
0<ε<N<∞
|A(ε,N)
2
( f)|

Lp ≤Cn
Ω

L1 max(p,(p−1)−1)
f

Lp .
(5.2.39)
Next, recall that in the proof of Theorem 5.2.10 we showed that
Kj(x) = Ω j(x/|x|)
|x|n
,
where Ω j are integrable functions on Sn−1 that satisfy
Ω j

L1 ≤Cn(cΩ +1).
(5.2.40)
Consequently, for functions f in Lp(Rn) we have
sup
0<ε<N<∞
|A(ε,N)
3
( f)| ≤2
n
∑
j=1
T (∗∗)
Ω j (Rj( f)),
and by Remark 5.2.9 this last expression has Lp norm at most a dimensional constant
multiple of
Ω j

L1 max(p,(p−1)−1)
Rj( f)

Lp. It follows that

sup
0<ε<N<∞
|A(ε,N)
3
( f)|

Lp ≤Cn max(p2,(p−1)−2)(cΩ +1)
f

Lp .
(5.2.41)
Finally, we turn our attention to the term A(ε,N)
1
( f). To prove the required esti-
mate, we ﬁrst show that there exist nonnegative homogeneous of degree zero func-
tions Gj on Rn that satisfy
|Fj(x)| ≤Gj(x)
when |x| ≤1
(5.2.42)
and

Sn−1 |Gj(θ)|dθ ≤Cn(cΩ +1).
(5.2.43)
To prove (5.2.42), ﬁrst note that if |x| ≤1/8, then
|Fj(x)| = Γ ( n+1
2 )
π
n+1
2


Rn
Ω(y/|y|)
|y|n
Φ(y) xj −yj
|x−y|n+1 dy

≤Cn

|y|≥1
4
|Ω(y/|y|)|
|y|2n
dy
≤C′
n
Ω

L1 .

5.2 Singular Integrals and the Method of Rotations
351
We now ﬁx an x satisfying 1/8 ≤|x| ≤1 and we write
|Fj(x)| ≤Φ(x)|Kj(x)|+|Fj(x)−Φ(x)Kj(x)|
≤|Kj(x)|+ Γ ( n+1
2 )
π
n+1
2
 lim
ε→0

|y|>ε
xj −yj
|x−y|n+1

Φ(y)−Φ(x)
Ω(y/|y|)
|y|n
dy

= |Kj(x)|+ Γ ( n+1
2 )
π
n+1
2

P1(x)+P2(x)+P3(x)

,
where
P1(x) =


|y|≤1
16
 xj −yj
|x−y|n+1 −
xj
|x|n+1

Φ(y)−Φ(x)
Ω(y/|y|)
|y|n
dy
,
P2(x) =


1
16 ≤|y|≤2
xj −yj
|x−y|n+1

Φ(y)−Φ(x)
Ω(y/|y|)
|y|n
dy
,
P3(x) =


|y|≥2
xj −yj
|x−y|n+1

Φ(y)−Φ(x)
Ω(y/|y|)
|y|n
dy
.
But since 1/8 ≤|x| ≤1, we see that
P1(x) ≤Cn

|y|≤1
16
|y|
|x|n+1
|Ω(y/|y|)|
|y|n
dy ≤C′
n
Ω

L1
and that
P3(x) ≤Cn

|y|≥2
|Ω(y/|y|)|
|y|2n
dy ≤C′
n
Ω

L1 .
For P2(x) we use the estimate |Φ(y)−Φ(x)| ≤C|x−y| to obtain
P2(x) ≤

1
16 ≤|y|≤2
C
|x−y|n−1
|Ω(y/|y|)|
|y|n
dy
≤4C

1
16 ≤|y|≤2
|Ω(y/|y|)|
|x−y|n−1|y|n−1
2
dy
≤4C

Rn
|Ω(y/|y|)|
|x−y|n−1|y|n−1
2
dy.
Recall that Kj(x) = Ω j(x/|x|)|x|−n. We now set
Gj(x) = Cn
Ω

L1 +
Ω j
 x
|x|
+|x|n−3
2

Rn
|Ω(y/|y|)|dy
|x−y|n−1|y|n−1
2

(5.2.44)
and we observe that Gj is a homogeneous of degree zero function, it satisﬁes
(5.2.42), and it is integrable over the annulus 1
2 ≤|x| ≤2. To verify the last assertion,
we split up the double integral

352
5 Singular Integrals of Convolution Type
I =

1
2 ≤|x|≤2

Rn
|Ω(y/|y|)|dy
|x−y|n−1|y|n−1
2
dx
into the pieces 1/4 ≤|y| ≤4, |y| > 4, and |y| < 1/4. The part of I where 1/4 ≤|y| ≤4
is pointwise bounded by a constant multiple of

1
4 ≤|y|≤4
Ω
 y
|y|


1
2 ≤|x|≤2
dx
|y−x|n−1 dy ≤

1
4 ≤|y|≤4
Ω
 y
|y|


|x−y|≤6
dx
|y−x|n−1 dy,
which is pointwise controlled by a constant multiple of ∥Ω∥L1. In the part of I where
|y| > 4 we use that |x −y|−n+1 ≤(|y|/2)−n+1 to obtain rapid decay in y and hence
a bound by a constant multiple of ∥Ω∥L1. Finally, in the part of I where |y| < 1/4
we use that |x −y|−n+1 ≤(1/4)−n+1, and then we also obtain a similar bound. It
follows from (5.2.44) and (5.2.40) that

1
2 ≤|x|≤2 |Gj(x)|dx ≤Cn

∥Ω∥L1 +∥Ω j∥L1 +∥Ω∥L1

≤Cn(cΩ +1).
Since Gj is homogeneous of degree zero, we deduce (5.2.43).
To complete the proof, we argue as follows:
sup
0<ε<N<∞
|A(ε,N)
1
( f)(x)|
≤2sup
ε>0
n
∑
j=1
1
εn

|z|≤ε |Fj(z)||Rj( f)(x−z)|dz
≤2sup
ε>0
n
∑
j=1
1
εn
 ε
r=0

Sn−1 |Fj(rθ)||Rj( f)(x−rθ)|rn−1 dθ dr
≤2
n
∑
j=1

Sn−1 |Gj(θ)|
$
sup
ε>0
1
εn
 ε
r=0 |Rj( f)(x−rθ)|rn−1 dr
%
dθ
≤4
n
∑
j=1

Sn−1 |Gj(θ)|Mθ(Rj( f))(x)dθ .
Using (5.2.43) together with the Lp boundedness of the Riesz transforms and of Mθ
we obtain

sup
0<ε<N<∞
|A(ε,N)
1
( f)|

Lp ≤Cn max(p,(p−1)−2)(cΩ +1)
f

Lp .
(5.2.45)
Combining (5.2.45), (5.2.39), and (5.2.41), we obtain the required conclusion.
□
The following corollary is a consequence of Theorem 5.2.11.
Corollary 5.2.12. Let Ω be as in Theorem 5.2.11. Then for 1 < p < ∞and f in
Lp(Rn) the functions T (ε,N)
Ω
( f) converge to TΩ( f) in Lp and almost everywhere as
ε →0 and N →∞.

5.2 Singular Integrals and the Method of Rotations
353
Proof. The a.e. convergence is a consequence of Theorem 2.1.14. The Lp conver-
gence is a consequence of the Lebesgue dominated convergence theorem since for
f ∈Lp(Rn) we have that |T (ε,N)
Ω
( f)| ≤T (∗∗)
Ω
( f) and T (∗∗)
Ω
( f) is in Lp(Rn).
□
Exercises
5.2.1. Show that the directional Hilbert transform Hθ is given by convolution with
the distribution wθ in S ′(Rn) deﬁned by
4
wθ,ϕ
5
= 1
π p.v.
 +∞
−∞
ϕ(tθ)
t
dt.
Compute the Fourier transform of wθ and prove that Hθ maps L1(Rn) to L1,∞(Rn).
5.2.2. Extend the deﬁnitions of WΩ and TΩ to Ω = dμ a ﬁnite signed Borel measure
on Sn−1 with mean value zero. Compute the Fourier transform of Wdμ and ﬁnd a
necessary and sufﬁcient condition on measures dμ so that Tdμ is L2 bounded. Notice
that the directional Hilbert transform Hθ is a special case of such an operator Tdμ.
5.2.3. Use the inequality AB ≤AlogA + eB for A ≥1 and B > 0 to prove that if
Ω satisﬁes (5.2.24) then it must satisfy (5.2.16). Conclude that if |Ω|log+ |Ω| is in
L1(Sn−1), then TΩ is L2 bounded.

Hint: Use that

Sn−1 |ξ ·θ|−α dθ converges when α < 1. See Appendix D.3.

5.2.4. Let Ω be a nonzero integrable function on Sn−1 with mean value zero. Let
f ≥0 be nonzero and integrable over Rn. Prove that TΩ( f) is not in L1(Rn).

Hint: Show that 
TΩ( f) cannot be continuous at zero.

5.2.5. Let θ ∈Sn−1. Use an identity similar to (5.2.18) to show that the maximal
operators
sup
a>0
1
a
 a
0 | f(x−rθ)|dr,
sup
a>0
1
2a
 +a
−a | f(x−rθ)|dr
are Lp(Rn) bounded for 1 < p < ∞with norm at most 3 p(p−1)−1.
5.2.6. For Ω ∈L1(Sn−1) and f locally integrable on Rn, deﬁne
MΩ( f)(x) = sup
R>0
1
vnRn

|y|≤R |Ω(y/|y|)|| f(x−y)|dy.
Apply the method of rotations to prove that MΩ maps Lp(Rn) to itself for 1 < p < ∞.
5.2.7. Let Ω(x,θ) be a function on Rn ×Sn−1 satisfying
(a) Ω(x,−θ) = −Ω(x,θ) for all x and θ.
(b) supx |Ω(x,θ)| is in L1(Sn−1).

354
5 Singular Integrals of Convolution Type
Use the method of rotations to prove that
TΩ( f)(x) = p.v.

Rn
Ω(x,y/|y|)
|y|n
f(x−y)dy
is bounded on Lp(Rn) for 1 < p < ∞.
5.2.8. Let Ω ∈L1(Sn−1) have mean value zero. Prove that if TΩ maps Lp(Rn) to
Lq(Rn), then p = q.

Hint: Use dilations.

5.2.9. Prove that for all 1 < p < ∞there exists a constant Ap > 0 such that for every
complex-valued C 2(R2) function f with compact support we have the bound
∂x1 f

Lp +
∂x2 f

Lp ≤Ap
∂x1 f +i∂x2 f

Lp.
5.2.10. (a) Let Δ = ∑n
j=1 ∂2
x j be the usual Laplacian on Rn. Prove that for all 1 <
p < ∞there exists a constant Ap > 0 such that for all C 2 functions f with compact
support we have the bound
∂x j∂xk f

Lp ≤Ap
Δ f

Lp.
(b) Let Δ m =
m times

 

Δ ◦···◦Δ. Show that for any 1 < p < ∞there exists a Cp > 0 such
that for all f of class C 2m with compact support and all differential monomials ∂α
x
of order |α| = 2m we have
∂α
x f

Lp ≤Cp
Δ m f

Lp.
5.2.11. Use the same idea as in Lemma 5.2.5 to show that if f is continuous on
[0,∞), differentiable in (0,∞), and satisﬁes
lim
N→∞
 Na
N
f(u)
u
du = 0
for all a > 0, then
lim
ε→0
N→∞
 N
ε
f(at)−f(t)
t
dt = f(0)log 1
a .
5.2.12. Let Ωo be an odd integrable function on Sn−1 and Ωe an even function on
Sn−1 that satisﬁes (5.2.24). Let f be a function supported in a ball B in Rn. Prove
that
(a) If | f|log+ | f| is integrable over a ball B, then TΩo( f) and T (∗∗)
Ωo ( f) are integrable
over B.
(b) If | f|(log+ | f|)2 is integrable over a ball B, then TΩe( f) and T (∗∗)
Ωe ( f) are inte-
grable over B.

Hint: Use Exercise 1.3.7.


5.3 Calder´on–Zygmund Decomposition and Singular Integrals
355
5.2.13. ([324]) Let Ω be integrable on Sn−1 with mean value zero. Use Jensen’s
inequality to show that for some C > 0 and every radial function f ∈L2(Rn) we
have
TΩ( f)

L2 ≤C
f

L2 .
This inequality subsumes that TΩ is well deﬁned on radial L2(Rn) functions.
5.3 The Calder´on–Zygmund Decomposition and Singular
Integrals
The behavior of singular integral operators on L1(Rn) is a more subtle issue than
that on Lp for 1 < p < ∞. It turns out that singular integrals are not bounded from
L1 to L1. See Example 5.1.3 and also Exercise 5.2.4. In this section we see that
singular integrals map L1 into the larger space L1,∞. This result strengthens their Lp
boundedness.
5.3.1 The Calder´on–Zygmund Decomposition
To make some advances in the theory of singular integrals, we need to introduce
the Calder´on–Zygmund decomposition. This is a powerful stopping-time construc-
tion that has many other interesting applications. We have already encountered an
example of a stopping-time argument in Section 2.1.
Recall that a dyadic cube in Rn is the set
[2km1,2k(m1 +1))×···×[2kmn,2k(mn +1)),
where k,m1,...,mn ∈Z. Two dyadic cubes are either disjoint or related by inclusion.
Theorem 5.3.1. Let f ∈L1(Rn) and α > 0. Then there exist functions g and b on
Rn such that
(1)
f = g+b.
(2)
∥g∥L1 ≤∥f∥L1 and ∥g∥L∞≤2nα.
(3)
b = ∑j bj, where each bj is supported in a dyadic cube Qj. Furthermore, the
cubes Qk and Qj are disjoint when j ̸= k.
(4)

Qj
bj(x)dx = 0.
(5)
∥bj∥L1 ≤2n+1α|Qj|.
(6)
∑j |Qj| ≤α−1∥f∥L1.

356
5 Singular Integrals of Convolution Type
Remark 5.3.2. This decomposition is called the Calder´on–Zygmund decomposition
of f at height α. The function g is called the good function of the decomposition,
since it is both integrable and bounded; hence the letter g. The function b is called
the bad function, since it contains the singular part of f (hence the letter b), but it
is carefully chosen to have mean value zero. It follows from (1) and (2) that the bad
function b is integrable and satisﬁes
b

L1 ≤
f

L1 +
g

L1 ≤2
 f

L1.
By (2) the good function is integrable and bounded; hence it lies in all the Lp spaces
for 1 ≤p ≤∞. More speciﬁcally, we have the following estimate:
g

Lp ≤
g

1
p
L1
g
1−1
p
L∞
≤
f

1
p
L1(2nα)1−1
p = 2
n
p′ α
1
p′ f

1
p
L1.
(5.3.1)
Proof. Decompose Rn into a mesh of disjoint dyadic cubes of the same size such
that
|Q| ≥1
α
 f

L1
for every cube Q in the mesh. Call these cubes of zero generation. Subdivide each
cube of zero generation into 2n congruent cubes by bisecting each of its sides. We
now have a new mesh of dyadic cubes, which we call of generation one. Select a
cube Q of generation one if
1
|Q|

Q | f(x)|dx > α.
(5.3.2)
Let S(1) be the set of all selected cubes of generation one. Now subdivide each
nonselected cube of generation one into 2n congruent subcubes by bisecting each
side and call these cubes of generation two. Then select all cubes Q of generation
two if (5.3.2) holds. Let S(2) be the set of all selected cubes of generation two. Repeat
this procedure indeﬁnitely.
The set of all selected cubes ∞
m=1 S(m) is countable and is exactly the set of the
cubes Qj proclaimed in the proposition. Note that in some instances this set may
be empty, in which case b = 0 and g = f. Let us observe that the selected cubes
are disjoint, for otherwise some Qk would be a proper subset of some Qj, which is
impossible since the selected cube Qj was never subdivided. Now deﬁne
bj =

f −
1
|Qj|

Qj
f dx

χQj ,
b = ∑j bj, and g = f −b.
For a selected cube Qj there exists a unique nonselected cube Q′ with twice its
side length that contains Qj. Let us call this cube the parent of Qj. Since the parent
Q′ of Qj was not selected, we have |Q′|−1 
Q′ | f|dx ≤α. Then

5.3 Calder´on–Zygmund Decomposition and Singular Integrals
357
1
|Qj|

Qj
| f(x)|dx ≤
1
|Qj|

Q′ | f(x)|dx = 2n
|Q′|

Q′ | f(x)|dx ≤2nα.
Consequently,

Qj
|bj|dx ≤

Qj
| f|dx+|Qj|

1
|Qj|

Qj
f dx
 ≤2

Qj
| f|dx ≤2n+1α|Qj|,
which proves (5). To prove (6), simply observe that
∑
j
|Qj| ≤1
α ∑
j

Qj
| f|dx = 1
α


j Qj
| f|dx ≤1
α
 f

L1.
Next we need to obtain the estimates concerning g. We obviously have
g =
⎧
⎨
⎩
f
on Rn \ 
j Qj,
1
|Qj|

Qj
f dx
on Qj.
(5.3.3)
On the cube Qj, g is equal to the constant |Qj|−1 
Qj f dx, and this is bounded by
2nα. It sufﬁces to show that g is bounded outside the union of the Qj’s. Indeed, for
each x ∈Rn \ 
j Qj and for each k = 0,1,2,... there exists a unique nonselected
dyadic cube Q(k)
x
of generation k that contains x. Then for each k ≥0, we have

1
|Q(k)
x |

Q(k)
x
f(y)dy
 ≤
1
|Q(k)
x |

Q(k)
x
| f(y)|dy ≤α.
The intersection of the closures of the cubes Q(k)
x
is the singleton {x}. Using Corol-
lary 2.1.16, we deduce that for almost all x ∈Rn \ 
j Qj we have
f(x) = lim
k→∞
1
|Q(k)
x |

Q(k)
x
f(y)dy.
Since these averages are at most α, we conclude that | f| ≤α a.e. on Rn \ 
j Qj,
hence |g| ≤α a.e. on this set. Finally, it follows from (5.3.3) that ∥g∥L1 ≤∥f∥L1.
This ﬁnishes the proof of the theorem.
□
We now apply the Calder´on–Zygmund decomposition to obtain weak type (1,1)
bounds for a wide class of singular integral operators that includes the operators TΩ
we studied in the previous section.

358
5 Singular Integrals of Convolution Type
5.3.2 General Singular Integrals
The kernels of the general singular integrals we will study are tempered distributions
that coincide with functions away from the origin. The setup as follows. Let K be
a measurable function deﬁned on Rn \{0} that is integrable on compact subsets of
Rn \{0} and satisﬁes the size condition
sup
R>0

R≤|x|≤2R |K(x)|dx = A1 < ∞.
(5.3.4)
This condition is less restrictive than the standard size estimate
sup
x∈Rn |x|n|K(x)| < ∞,
(5.3.5)
but it is strong enough to capture size properties of kernels K(x) = Ω(x/|x|)/|x|n,
where Ω ∈L1(Sn−1). We also note that condition (5.3.4) is equivalent to
sup
R>0
1
R

|x|≤R |K(x)||x|dx < ∞.
(5.3.6)
See Exercise 5.3.1.
The size condition (5.3.4) is sufﬁcient to make the restriction of K(x) on |x| > δ
a tempered distribution (for any δ > 0). Indeed, for ϕ ∈S (Rn) we have

|x|≥1 |K(x)ϕ(x)|dx ≤
∞
∑
m=0

2m+1≥|x|≥2m
|K(x)|(1+|x|)N|ϕ(x)|
(1+2m)N
dx
≤
∞
∑
m=0
A1
(1+2m)N sup
x∈Rn(1+|x|)N|ϕ(x)|,
and this expression is bounded by a constant times a ﬁnite sum of Schwartz semi-
norms of ϕ.
We are interested in tempered distributions W on Rn that extend the function K
deﬁned on Rn \{0} and have the form
⟨W,ϕ⟩= lim
j→∞

|x|≥δ j
K(x)ϕ(x)dx,
ϕ ∈S (Rn),
(5.3.7)
for some sequence δ j ↓0 as j →∞. It is not hard to see that there exists a tempered
distribution W satisfying (5.3.7) for all ϕ ∈S (Rn) if and only if
lim
j→∞

1≥|x|≥δ j
K(x)dx = L
(5.3.8)
exists. See Exercise 5.3.2. If such a distribution W exists it may not be unique, since
it depends on the choice of the sequence δ j. Two different sequences tending to zero

5.3 Calder´on–Zygmund Decomposition and Singular Integrals
359
may give two different tempered distributions W of the form (5.3.7), both coinciding
with the function K on Rn \{0}. See Example 5.4.2 and Remark 5.4.3.
If condition (5.3.8) is satisﬁed, we can deﬁne
⟨W,ϕ⟩= lim
j→∞

j≥|x|≥δ j
K(x)ϕ(x)dx
(5.3.9)
and the limit exists as j →∞for all ϕ ∈S (Rn) and is equal to
⟨W,ϕ⟩=

|x|≤1 K(x)(ϕ(x)−ϕ(0))dx+ϕ(0)L+

|x|≥1 K(x)ϕ(x)dx.
Moreover, the previous calculations show that W is an element of S ′(Rn).
Next we assume that the given function K on Rn \{0} satisﬁes a certain smooth-
ness condition. There are three kinds of smoothness conditions that we encounter:
ﬁrst, the gradient condition
|∇K(x)| ≤A2|x|−n−1,
x ̸= 0;
(5.3.10)
next, the weaker Lipschitz condition,
|K(x−y)−K(x)| ≤A2
|y|δ
|x|n+δ ,
whenever |x| ≥2|y|;
(5.3.11)
and ﬁnally the even weaker smoothness condition
sup
y̸=0

|x|≥2|y| |K(x−y)−K(x)|dx = A2 ,
(5.3.12)
for some A2 < ∞. One should verify that (5.3.12) is a weaker condition than (5.3.11),
which in turn is weaker than (5.3.10). Condition (5.3.12) is often referred to as
H¨ormander’s condition.
5.3.3 Lr Boundedness Implies Weak Type (1,1) Boundedness
This next theorem provides the most classical application of the Calder´on–Zygmund
decomposition.
Theorem 5.3.3. Let K be a function on Rn \{0} that satisﬁes (5.3.4)1 and (5.3.12)
for some A1,A2 < ∞. Let W be an element of S ′(Rn) related to K as in (5.3.7).
Suppose that the operator T given by convolution with W has a bounded extension
that maps Lr(Rn) to itself with norm B for some 1 < r ≤∞. Then T has an extension
that maps L1(Rn) to L1,∞(Rn) with norm
1 this condition could be replaced by the assumption that K is integrable over any compact set that
does not contain the origin.

360
5 Singular Integrals of Convolution Type
T

L1→L1,∞≤Cn (A2 +B),
(5.3.13)
and T also extends to a bounded operator from Lp(Rn) to itself for 1 < p < ∞with
norm
T

Lp→Lp ≤C′
n max

p,(p−1)−1
(A2 +B),
(5.3.14)
where Cn,C′
n are constants that depend on the dimension but not on r or p.
Proof. We discuss the case r < ∞and we refer to Exercise 5.3.7 for the case r = ∞.
Let α > 0 be given. We ﬁx a step function f given as a ﬁnite linear combination of
characteristic functions of disjoint dyadic intervals. The class of such functions is
dense in all the Lp spaces. Once (5.3.13) is obtained for such functions, a density ar-
gument gives that T admits an extension on L1 that also satisﬁes (5.3.13). Therefore
it sufﬁces to prove (5.3.13) for such a function f.
Apply the Calder´on–Zygmund decomposition to f at height γα, where γ is a
positive constant to be chosen later. That is, write the function f as the sum
f = g+b = g+∑
j
bj,
where conditions (1)–(6) of Theorem 5.3.1 are satisﬁed with the constant α replaced
by γα. Since f is a ﬁnite linear combination of characteristic functions of disjoint
dyadic cubes, there are only ﬁnitely many cubes Qj that appear in the Calder´on–
Zygmund decomposition to f. Each bj is supported in a dyadic cube Qj with center
yj and the Qj’s are pairwise disjoint. We denote by ℓ(Q) the side length of a cube
Q. Let Q∗
j be the unique cube with sides parallel to the axes having the same center
as Qj and having side length ℓ(Q∗
j) = 2√nℓ(Qj). Because of the form of f, each
bj is a bounded function supported in Qj, hence it is in Lr, thus each T(bj) is a
well-deﬁned Lr function. We observe that for all j and all x /∈Q∗
j we have
T(bj)(x) = lim
k→∞

k≥|x−y|≥δk
K(x−y)bj(y)dy =

Qj
K(x−y)bj(y)dy,
where the last integral converges absolutely. This is a consequence of the Lebesgue
dominated convergence theorem, based on the facts that bj is bounded, that K is
integrable over any compact annulus that does not contain the origin (cf. (5.3.4)),
and that x−Qj is contained in such a compact annulus, since x /∈Q∗
j.
Next we use the cancellation of bj in the following way:

(∪iQ∗
i )c∑
j
T(bj)(x)
 dx
=

(
i Q∗
i )c∑
j


Qj
bj(y)

K(x−y)−K(x−yj)

dy
dx
≤∑
j

(Q∗
j)c

Qj
|bj(y)||K(x−y)−K(x−yj)|dydx

5.3 Calder´on–Zygmund Decomposition and Singular Integrals
361
= ∑
j

Qj
|bj(y)|

(Q∗
j)c |K(x−y)−K(x−yj)|dxdy
= ∑
j

Qj
|bj(y)|

−y j+(Q∗
j)c |K(x−(y−yj))−K(x)|dxdy
≤∑
j

Qj
|bj(y)|

|x|≥2|y−y j| |K(x−(y−yj))−K(x)|dxdy
≤A2∑
j
bj

L1
≤A22n+1 f

L1 < ∞,
where we used (5.3.12) since if x ∈−yj + (Q∗
j)c then |x| ≥1
2ℓ(Q∗
j) = √nℓ(Qj)
and since y −yj ∈−yj + Qj we have |y −yj| ≤
√n
2 ℓ(Qj), thus |x| ≥2|y −yj|. See
Figure 5.2.
Fig. 5.2 The cubes −yj +Qj
and −yj +Q∗
j.
0.
.x
j*
j
− y + Q
j
j
− y + Q
.
j
y − y
Thus we proved that

(
i Q∗
i )c∑
j
|T(bj)(x)|dx ≤2n+1A2
f

L1 ,
an inequality we use below. We have
	
x ∈Rn : |T( f)(x)| > α


≤


x ∈Rn : |T(g)(x)| > α
2
+


x ∈Rn : |T(b)(x)| > α
2

≤2r
αr
T(g)
r
Lr +


i
Q∗
i
+


x /∈

i
Q∗
i : |T
∑
j
bj

(x)| > α
2


362
5 Singular Integrals of Convolution Type
= 2r
αr
T(g)
r
Lr +


i
Q∗
i
+


x /∈

i
Q∗
i : |∑
j
T(bj)(x)| > α
2

≤2r
αr Brg
r
Lr +∑
i
|Q∗
i |+ 2
α

(
i Q∗
i )c∑
j
|T(bj)(x)|dx
≤2r
αr 2
nr
r′ Br(γα)
r
r′ f

L1 +(2√n)n
f

L1
γα
+ 2
α 2n+1A2
f

L1
≤
(2n+1Bγ)r
2nγ
+ (2√n)n
γ
+2n+2A2
 f

L1
α
.
Choosing γ = 2−(n+1)B−1, we deduce the weak type (1,1) estimate (5.3.13) for T
with Cn = 2+2n+1(2√n)n +2n+2.
It follows from Exercise 1.3.2 that T has an extension that maps Lp to Lp with
bound at most C′
n(A2 + B)(p −1)−1/p when 1 < p < r. The adjoint operator T ∗of
T, deﬁned by
4
T( f)|g
5
=
4
f |T ∗(g)
5
,
has a kernel that coincides with the function K∗(x) = K(−x) on Rn \{0}. We notice
that since K satisﬁes (5.3.12), then so does K∗and with the same bound. Therefore,
T ∗, which maps Lr′ to Lr′, has a kernel that satisﬁes (5.3.12). By the preceding
argument, T ∗maps Lp′ to Lp′ with bound at most C′
n(A2 +B)(p−1)−1/p whenever
1 < p′ < r′. By duality this yields that T maps Lp(Rn) to Lp(Rn) with bound at most
C′
n(A2 +B)(p−1)1−1/p whenever r′ < p < ∞. Using interpolation we obtain that T
maps Lp to itself with norm at most C′
n(A2 +B)max((p−1)−1/p,(p−1)1−1/p) for
p in the interval (r,r′), which is nonempty only if r < 2. Then (5.3.14) holds since
max((p−1)−1/p,(p−1)1−1/p) ≤max((p−1)−1, p).
□
5.3.4 Discussion on Maximal Singular Integrals
In this subsection we introduce maximal singular integrals and we derive their
boundedness under certain smoothness conditions on the kernels, assuming bound-
edness of the associated linear operator.
Suppose that K is a kernel on Rn \{0} that satisﬁes the size condition
|K(x)| ≤A1|x|−n
(5.3.15)
for x ̸= 0. Then for any ε > 0 the function K(ε)(x) = K(x)χ|x|≥ε lies in Lp′(Rn)
(with norm bounded by cp,n A1ε−n/p) for all 1 ≤p < ∞. Consequently, by H¨older’s
inequality, the integral
( f ∗K(ε))(x) =

|y|≥ε f(x−y)K(y)dy
converges absolutely for all x ∈Rn and all f ∈Lp(Rn), when 1 ≤p < ∞.

5.3 Calder´on–Zygmund Decomposition and Singular Integrals
363
Let f ∈
1≤p<∞Lp(Rn). We deﬁne the truncated singular integrals T (ε)( f) asso-
ciated with the kernel K by setting
T (ε)( f) = f ∗K(ε) ;
we also deﬁne the maximal truncated singular integral operator associated with K
by setting
T (∗)( f) = sup
ε>0
|( f ∗K(ε))| = sup
ε>0
|T (ε)( f)|.
This operator is well deﬁned, but possibly inﬁnite, for certain points in Rn.
We now consider the situation in which the kernel K satisﬁes an integrability
condition over concentric annuli centered at the origin, a condition that is certainly
a weaker condition than (5.3.15). Precisely, suppose that K is a measurable function
on Rn \ {0}, that is integrable on compact subsets of Rn \ {0}, for which there is a
constant A1 < ∞such that
sup
R>0

R≤|x|≤2R |K(x)|dx ≤A1 < ∞.
(5.3.16)
Such kernels may not be integrable to the power p′ > 1 over the region |x| ≥ε.
For this reason, it is not possible to deﬁne T (ε) as an absolutely convergent integral.
To overcome this difﬁculty, we consider double truncations. We deﬁne the doubly
truncated kernel K(ε,N) by setting
K(ε,N)(x) = K(x)χε≤|x|≤N(x).
(5.3.17)
A repeated application of (5.3.16) yields that

|K(ε,N)(x)|dx ≤A1
/
log2
N
ε
0
+1

,
which implies that K(ε,N) is integrable over concentric annuli centered at the origin.
Next, we deﬁne the doubly truncated singular integrals T (ε,N) by setting
T (ε,N)( f) = f ∗K(ε,N) ,
and we observe that these operators are well deﬁned when f in Lp, for 1 ≤p ≤∞.
Indeed, Theorem 1.2.10 yields that
T (ε,N)( f)

Lp ≤
 f

Lp

|K(ε,N)(x)|dx < ∞
for functions f in Lp, 1 ≤p ≤∞. Consequently, for almost every x ∈Rn we have
|T (ε,N)( f)(x)| < ∞.
For functions in 
1≤p≤∞Lp(Rn) we deﬁne the doubly truncated maximal singular
integral operator T (∗∗) associated with K by setting

364
5 Singular Integrals of Convolution Type
T (∗∗)( f) =
sup
0<ε<N<∞
|T (ε,N)( f)|.
(5.3.18)
For such functions and for almost all x ∈Rn, T (∗∗)( f)(x) is well deﬁned, but poten-
tially inﬁnite.
One observation is that under condition (5.3.16), one can also deﬁne T (∗)(g)
for general integrable functions g with compact support. In this case, say that the
ball B(0,R) contains the support of g. Let x ∈B(0,M) and N = M + R. Then
|T (ε)(g)(x)| ≤|g| ∗|K(ε,N)|(x), which is ﬁnite a.e. as the convolution of two L1
functions; consequently, the integral deﬁning T (ε)(g)(x) converges absolutely for
all x ∈B(0,R). Since R > 0 is arbitrary, T (ε)(g)(x) is deﬁned and ﬁnite for almost
all x ∈Rn.
Obviously T (∗) and T (∗∗) are related. If K satisﬁes condition (5.3.15), then


ε≤|y| f(x−y)K(y)dy
 ≤sup
N>0


ε≤|y|≤N f(x−y)K(y)dy
,
which implies that
T (∗)( f) ≤T (∗∗)( f)
for all f ∈
1≤p<∞Lp. Also, T (ε,N)( f) = T (ε)( f)−T (N)( f); hence
T (∗∗)( f) ≤2T (∗)( f).
Therefore, for kernels satisfying (5.3.15), T (∗∗) and T (∗) are comparable and the
boudnedness properties of T (∗∗) and T (∗) are equivalent
Theorem 5.3.4. (Cotlar’s inequality) Let 0 < A1,A2,A3 < ∞and suppose that K is
deﬁned on Rn \{0} and satisﬁes the size condition,
|K(x)| ≤A1|x|−n ,
x ̸= 0,
(5.3.19)
the smoothness condition
|K(x−y)−K(x)| ≤A2|y|δ |x|−n−δ ,
(5.3.20)
whenever |x| ≥2|y| > 0, and the cancellation condition
sup
0<r<R<∞


r<|x|<R K(x)dx
 ≤A3 .
(5.3.21)
Let W in S ′(Rn) be related to K via (5.3.7) and let T be the operator given by
convolution with W. Then there is a constant Cn,δ such that the following inequality
is valid:
T (∗)( f) ≤M(T( f))+Cn,δ (A1 +A2 +A3)M( f),
(5.3.22)

5.3 Calder´on–Zygmund Decomposition and Singular Integrals
365
for all f ∈S (Rn), where M is the Hardy–Littlewood maximal operator. Conse-
quently, T (∗) is bounded on Lp(Rn) when 1 < p < ∞.
Proof. Let ϕ be a radially decreasing smooth function with integral 1 supported
in the ball B(0,1/2). For a function g and ε > 0 we use the notation gε(x) =
ε−ng(ε−1x). For a distribution W we deﬁne Wε analogously, i.e. as the unique dis-
tribution with the property ⟨Wε,ψ⟩= ε−n⟨W,ψε−1⟩. We begin by observing that
Kε−1(x) = εnK(εx) satisﬁes (5.3.19), (5.3.20), and (5.3.21) uniformly in ε > 0.
Set, as before, K(ε)(x) = K(x)χ|x|≥ε. Fix f ∈S (Rn) for some 1 < p < ∞. Obvi-
ously we have
f ∗K(ε) = f ∗

(Kε−1)(1)
ε = f ∗W ∗ϕε + f ∗

(Kε−1)(1) −Wε−1 ∗ϕ

ε .
(5.3.23)
Next we prove the following estimate for all ε > 0:

(Kε−1)(1) −Wε−1 ∗ϕ

(x)
 ≤C(A1 +A2 +A3)(1+|x|)−n−δ
(5.3.24)
for all x ∈Rn. Indeed, for |x| ≥1 we express the left-hand side in (5.3.24) as


Rn

Kε−1(x)−Kε−1(x−y)

ϕ(y)dy
.
Since ϕ is supported in |y| ≤1/2, we have |x| ≥2|y|, and condition (5.3.20) yields
that the expression on the left-hand side of (5.3.24) is bounded by
A2
|x|n+δ

Rn |y|δ|ϕ(y)|dy ≤c
A2
(1+|x|)n+δ ,
which proves (5.3.24) in the case |x| ≥1. When |x| < 1, the left-hand side of (5.3.24)
equals
(Wε−1 ∗ϕ)(x) = lim
δ j→0

|x−y|≥δ j
Kε−1(x−y)ϕ(y)dy
(5.3.25)
for some sequence δ j ↓0; see the discussion in Section 5.3.2. The expression in
(5.3.25) is equal to
I1 +I2 +I3 ,
where
In I1 we have 1/8 ≤|x −y| ≤1 + 1/2 = 3/2; hence I1 is bounded by a multiple of
A1. Since |ϕ(x) −ϕ(y)| ≤c|x −y|, the same is valid for I2. Finally, I3 is bounded
by a multiple of A3. Combining these facts yields the proof of (5.3.24) in the case
|x| < 1 as well.
I1 =

|x−y|> 1
8
Kε−1(x−y)ϕ(y)dy,
I2 =

|x−y|≤1
8
Kε−1(x−y)

ϕ(y)−ϕ(x)

dy,
I3 = ϕ(x) lim
δ j→0

1
8 ≥|x−y|≥δ j
Kε−1(x−y)dy.

366
5 Singular Integrals of Convolution Type
Use Corollary 2.1.12 to deduce that
sup
ε>0
 f ∗

(Kε−1)(1) −Kε−1 ∗ϕ

ε
 ≤c(A1 +A2 +A3)M( f).
Finally, take the supremum over ε > 0 in (5.3.23) and use (5.3.24) and Corollary
2.1.12 one more time to deduce the estimate
T (∗)( f) ≤M( f ∗W)+C(A1 +A2 +A3)M( f),
where C depends on n and δ; this concludes the proof of (5.3.22) for all functions
f ∈S (Rn). Thus T (∗) is bounded on Lp, 1 < p < ∞, when restricted to Schwartz
functions.
Now given a general function g in Lp(Rn) we ﬁnd a sequence hj in S (Rn) such
that ∥hj −g∥Lp →0 as j →∞. Then we have the pointwise estimate
|T (ε)(g)| ≤|T (ε)(g−hj)|+|T (ε)(hj)| ≤cp,n A1ε
−n
p
0
∥g−hj∥Lp +|T (∗)(hj)|
for all ε ≥ε0. Taking the supremum over ε ≥ε0 and then Lp norm over the ball
B(0,R), we obtain
 sup
ε≥ε0
|T (ε)(g)|

Lp(B(0,R)) ≤c′
p,n A1ε
−n
p
0
R
n
p ∥g−hj∥Lp +C′ (A1 +A2 +A3)∥hj∥Lp .
Now we let j →∞ﬁrst, and then R →∞and ε0 →0 to deduce the boundedness of
T (∗) on Lp(Rn) via the Lebesgue monotone convergence theorem.
□
5.3.5 Boundedness for Maximal Singular Integrals Implies
Weak Type (1,1) Boundedness
We now state and prove a result analogous to that in Theorem 5.3.3 for maximal
singular integrals.
Theorem 5.3.5. Let K(x) be function on Rn \ {0} satisfying (5.3.4) with constant
A1 < ∞and H¨ormander’s condition (5.3.12) with constant A2 < ∞. Suppose that the
operator T (∗∗) as deﬁned in (5.3.18) maps L2(Rn) to itself with norm B. Then T (∗∗)
maps L1(Rn) to L1,∞(Rn) with norm
T (∗∗)
L1→L1,∞≤Cn(A1 +A2 +B),
where Cn is some dimensional constant.
Proof. The proof of this theorem is only a little more involved than the proof of
Theorem 5.3.3. We ﬁx an L1(Rn) function f. We apply the Calder´on–Zygmund
decomposition of f at height γα for some γ,α > 0. We then write f = g+b, where

5.3 Calder´on–Zygmund Decomposition and Singular Integrals
367
b = ∑j bj and each bj is supported in some cube Qj. We deﬁne Q∗
j as the cube
with the same center as Qj and with sides parallel to the sides of Qj having length
ℓ(Q∗
j) = 5√nℓ(Qj). This is only a minor change compared with the deﬁnition of Qj
in Theorem 5.3.3. The main change in the proof is in the treatment of the term


x ∈

j
Q∗
j
c
: |T (∗∗)(b)(x)| > α
2
.
(5.3.26)
We show that for all γ ≤(2n+5A1)−1 we have


x ∈

j
Q∗
j
c
: |T (∗∗)(b)(x)| > α
2
 ≤2n+8A2
f

L1
α
.
(5.3.27)
Let us conclude the proof of the theorem assuming for the moment the validity of
(5.3.27). As in the proof of Theorem 5.3.3, we can show that


x ∈Rn : |T (∗∗)(g)(x)| > α
2
+


j
Q∗
j
 ≤

2n+2B2γ + (5√n)n
γ
f

L1
α
.
Combining this estimate with (5.3.27) and choosing
γ = (2n+5(A1 +A2 +B))−1 ,
we obtain the required estimate
	
x ∈Rn : |T (∗∗)( f)(x)| > α

 ≤Cn(A1 +A2 +B)
f

L1
α
with Cn = 2−3 +(5√n)n2n+5 +2n+8.
It remains to prove (5.3.27). This estimate will be a consequence of the fact that
for x ∈

j Q∗
j
c we have the key inequality
T (∗∗)(b)(x) ≤4E1(x)+2n+2αγE2(x)+2n+3αγA1 ,
(5.3.28)
where
E1(x) = ∑
j

Qj
|K(x−y)−K(x−yj)||bj(y)|dy,
E2(x) = ∑
j

Qj
|K(x−y)−K(x−yj)|dy,
and yj is the center of Qj.
If we had (5.3.28), then we could easily derive (5.3.27). Indeed, ﬁx a γ satisfying
γ ≤(2n+5A1)−1. Then we have 2n+3αγA1 < α
3 , and using (5.3.28), we obtain

368
5 Singular Integrals of Convolution Type


x ∈

j
Q∗
j
c
: |T (∗∗)(b)(x)| > α
2

≤


x ∈

j
Q∗
j
c
: 4E1(x) > α
12

+


x ∈

j
Q∗
j
c
: 2n+2αγE2(x) > α
12

≤48
α

(
j Q∗
j)c E1(x)dx+2n+6γ

(
j Q∗
j)c E2(x)dx,
(5.3.29)
since α
2 = α
3 + α
12 + α
12. We have

(
j Q∗
j)c E1(x)dx
≤∑
j

Qj
|bj(y)|

(Q∗
j)c |K(x−y)−K(x−yj)|dxdy
≤∑
j

Qj
|bj(y)|

|x−y j|≥2|y−y j| |K(x−y)−K(x−yj)|dxdy
≤A2∑
j

Qj
|bj(y)|dy = A2∑
j
bj

L1 ≤A22n+1f

L1 ,
(5.3.30)
where we used the fact that if x ∈(Q∗
j)c, then |x −yj| ≥1
2ℓ(Q∗
j) = 5
2
√nℓ(Qj). But
since |y−yj| ≤
√n
2 ℓ(Qj), this implies that |x−yj| ≥2|y−yj|. Here we used the fact
that the diameter of a cube is equal to √n times its side length. Likewise, we obtain
that

(
j Q∗
j)c E2(x)dx ≤A2∑
j
|Qj| ≤A2
f

L1
αγ
.
(5.3.31)
Combining (5.3.30) and (5.3.31) with (5.3.29) yields (5.3.27).
Fig. 5.3 The cubes Qj
and Q∗
j.
x
y
y0
Q j
Qj*
j. .
.

5.3 Calder´on–Zygmund Decomposition and Singular Integrals
369
Therefore, the main task of the proof is to prove (5.3.28). Since b = ∑j bj, to
estimate T (∗∗)(b), it sufﬁces to estimate each |T (ε,N)(bj)| uniformly in ε and N. To
achieve this we use the estimate
|T (ε,N)(bj)| ≤|T (ε)(bj)|+|T (N)(bj)|,
(5.3.32)
noting that the truncated singular integrals T (ε)(bj) are well deﬁned. Indeed, say x
lies in a compact set K0. Pick M such that K0 −Qj is contained in a ball B(0,M).
Then
|T (ε)(bj)(x)| ≤|bj|∗|K(ε,M)|(x),
which is ﬁnite a.e. as the convolution of two L1 functions; thus the integral deﬁning
T (ε)(bj)(x) converges absolutely and the expression T (ε)(bj)(x) is well deﬁned for
almost all x.
We work with T (ε) and we note that T (N) can be treated similarly. Fix x /∈
j Q∗
j
and ε > 0 and deﬁne
J1(x,ε) = {j : ∀y ∈Qj we have |x−y| < ε},
J2(x,ε) = {j : ∀y ∈Qj we have |x−y| > ε},
J3(x,ε) = {j : ∃y ∈Qj we have |x−y| = ε}.
Note that
T (ε)(bj)(x) = 0
whenever x /∈
j Q∗
j and j ∈J1(x,ε). Also note that
K(ε)(x−y) = K(x−y)
whenever x /∈
j Q∗
j, j ∈J2(x,ε) and y ∈Qj. Therefore,
sup
ε>0
|T (ε)(b)(x)| ≤sup
ε>0
 ∑
j∈J2(x,ε)
T(bj)(x)
+sup
ε>0
 ∑
j∈J3(x,ε)
T(bjχ|x−·|≥ε)(x)
,
but since
sup
ε>0
 ∑
j∈J2(x,ε)
T(bj)(x)
 ≤∑
j
|T(bj)(x)| ≤E1(x),
(5.3.33)
it sufﬁces to estimate the term
sup
ε>0
 ∑
j∈J3(x,ε)
T(bjχ|x−·|≥ε)(x)
.
We now make some geometric observations; see Figure 5.3. Fix ε > 0 and a cube
Qj with j ∈J3(x,ε); recall that x lies in (
j Q∗
j)c. Then we have
ε ≥1
2

ℓ(Q∗
j)−ℓ(Qj)

= 1
2(5√n−1)ℓ(Qj) ≥2√nℓ(Qj).
(5.3.34)

370
5 Singular Integrals of Convolution Type
Since j ∈J3(x,ε), there exists a y0 ∈Qj with
|x−y0| = ε .
Using (5.3.34), we obtain that for any y ∈Qj we have
ε
2 ≤ε −√nℓ(Qj) ≤|x−y0|−|y−y0| ≤|x−y|,
|x−y| ≤|x−y0|+|y−y0| ≤ε +√nℓ(Qj) ≤3ε
2 .
Therefore, we have proved that

j∈J3(x,ε)
Qj ⫅B(x, 3ε
2 )\B(x, ε
2).
Letting
cj(ε) =
1
|Qj|

Qj
bj(y)χ|x−y|≥ε(y)dy,
we note that in view of property (5) of the Calder´on–Zygmund decomposition (The-
orem 5.3.1), the estimate
|cj(ε)| ≤2n+1αγ
holds. Then
sup
ε>0
 ∑
j∈J3(x,ε)

Qj
K(x−y)bj(y)χ|x−y|≥ε(y)dy

≤sup
ε>0
 ∑
j∈J3(x,ε)

Qj
K(x−y)

bj(y)χ|x−y|≥ε(y)−cj(ε)

dy

+sup
ε>0
 ∑
j∈J3(x,ε)
cj(ε)

Qj
K(x−y)dy

≤sup
ε>0
 ∑
j∈J3(x,ε)

Qj

K(x−y)−K(x−yj)

bj(y)χ|x−y|≥ε(y)−cj(ε)

dy

+2n+1αγ sup
ε>0

B(x, 3ε
2 )\B(x, ε
2 ) |K(x−y)|dy
≤∑
j

Qj
K(x−y)−K(x−yj)

|bj(y)|+2n+1αγ

dy
+2n+1αγ sup
ε>0

ε
2 ≤|x−y|≤3ε
2
|K(x−y)|dy
≤E1(x)+2n+1αγE2(x)+2n+1αγ(2A1).
The last estimate, together with (5.3.33), with (5.3.32), and with the analogous esti-
mate for supN>0 |T (N)(bj)(x)| (which is similarly obtained), yields (5.3.28).
□

5.3 Calder´on–Zygmund Decomposition and Singular Integrals
371
The value of the previous theorem lies in the following: Since we know that for
some sequences ε j ↓0, Nj ↑∞the pointwise limit T (ε j,Nj)( f) exists a.e. for all f in a
dense subclass of L1, then Theorem 5.3.5 allows us to deduce that T (ε j,Nj)( f) exists
a.e. for all f in L1(Rn).
If the singular integrals have kernels of the form Ω(x/|x|)|x|−n with Ω in L∞,
such as the Hilbert transform and the Riesz transforms, then the upper truncations
are not needed for K in (5.3.17). In this case
T (ε)
Ω ( f)(x) =

|y|≥ε f(x−y)Ω(y/|y|)
|y|n
dy
is well deﬁned for f ∈
1≤p<∞Lp(Rn) by H¨older’s inequality and is equal to
lim
N→∞

ε≤|y|≤N f(x−y)Ω(y/|y|)
|y|n
dy.
Corollary 5.3.6. The maximal Hilbert transform H(∗) and the maximal Riesz trans-
forms R(∗)
j
are weak type (1,1). Secondly, limε→0 H(ε)( f) and limε→0 R(ε)
j (g) exist
a.e. for all f ∈L1(R) and g ∈L1(Rn), as ε →0.
Proof. Since the kernels 1/x on R and xj/|x|n on Rn satisfy (5.3.10), the ﬁrst state-
ment in the corollary is an immediate consequence of Theorem 5.3.5. The second
statement follows from Theorem 2.1.14 and Corollary 5.2.8, since these limits exist
for Schwartz functions.
□
Corollary 5.3.7. Under the hypotheses of Theorem 5.3.5, T (∗∗) maps Lp(Rn) to itself
for 1 < p < 2 with norm
T (∗∗)
Lp→Lp ≤Cn(A1 +A2 +B)
p−1
,
where Cn is some dimensional constant.
Exercises
5.3.1. Let A1 be deﬁned in (5.3.4). Prove that
1
2A1 ≤sup
R>0
1
R

|x|≤R |K(x)||x|dx ≤2A1 ;
thus the expressions in (5.3.6) and (5.3.4) are equivalent.
5.3.2. Suppose that K is a locally integrable function on Rn \ {0} that satisﬁes
(5.3.4). Suppose that δ j ↓0. Prove that the principal value operation
⟨W,ϕ⟩= lim
j→∞

δ j≤|x|≤1 K(x)ϕ(x)dx

372
5 Singular Integrals of Convolution Type
deﬁnes a distribution in S ′(Rn) if and only if the following limit exists:
lim
j→∞

δ j≤|x|≤1 K(x)dx.
5.3.3. Suppose that a function K on Rn \ {0} satisﬁes condition (5.3.4) with con-
stant A1 and condition (5.3.12) with constant A2.
(a) Show that the functions K(x)χ|x|≥ε also satisfy condition (5.3.12) uniformly in
ε > 0 with constant A1 +A2.
(b) Obtain the same conclusion for the upper truncations K(x)χ|x|≤N.
(c) Deduce a similar conclusion for the double truncations K(ε,N)(x) = K(x)χε≤|x|≤N.
5.3.4. Modify the proof of Theorem 5.3.5 to prove that if T (∗∗) maps Lr to Lr,∞for
some 1 < r < ∞, and K satisﬁes condition (5.3.12), then T (∗∗) maps L1 to L1,∞.
5.3.5. Assume that T is a linear operator acting on measurable functions on Rn
such that whenever a function f is supported in a cube Q, then T( f) is supported in
a ﬁxed multiple of Q.
(a) Suppose that T maps Lp to itself for some 1 < p < ∞with norm B. Prove that T
extends to a bounded operator from L1 to L1,∞with norm a constant multiple of B.
(b) Suppose that T maps Lp to Lq for some 1 < q < p < ∞with norm B. Prove that
T extends to a bounded operator from L1 to Ls,∞with norm a multiple of B, where
1
p′ + 1
q = 1
s .
5.3.6. (a) Let 1 < q < ∞. Show that the good function g in Theorem 5.3.1 lies in the
Lorentz space Lq,1 and that ∥g∥Lq,1 ≤Cn,qα1/q′∥f∥1/q
L1 for some constant Cn,q.
(b) Let 1 < r < ∞. Obtain a generalization of Theorem 5.3.3 in which the assumption
that T maps Lr to Lr is replaced by that T maps Lr,1 to Lr,∞with norm B.
(c) Let 1 < r < ∞. Obtain a further generalization of Theorem 5.3.3 in which the
assumption that T maps Lr to Lr is replaced by that it is of restricted weak type
(r,r), i.e., it satisﬁes
|{x : |T(χE)(x)| > α}| ≤Br |E|
αr
for all subsets E of Rn with ﬁnite measure.
5.3.7. Let K satisfy (5.3.12) for some A2 > 0, let W ∈S ′(Rn) be an extension of K
on Rn as in (5.3.7), and let T be the operator given by convolution with W. Obtain
the case r = ∞in Theorem 5.3.3. Precisely, prove that if T maps L∞(Rn) to itself
with constant B, then T has an extension on L1 +L∞that satisﬁes
T

L1→L1,∞≤C′
n (A2 +B),

5.3 Calder´on–Zygmund Decomposition and Singular Integrals
373
and for 1 < p < ∞it satisﬁes
T

Lp→Lp ≤Cn
1
(p−1)1/p (A2 +B),
where Cn,C′
n are constants that depend only on the dimension.

Hint: Apply the Calder´on–Zygmund decomposition f = g+b at height αγ, where
γ = (2n+1B)−1. Since |g| ≤2nαγ, observe that
|{x : |T( f)(x)| > α}| ≤|{x : |T(b)(x)| > α/2}|.
For the interpolation use the result of Exercise 1.3.2.

5.3.8. (Calder´on–Zygmund decomposition on Lq) Fix a function f ∈Lq(Rn) for
some 1 ≤q < ∞and let α > 0. Then there exist functions g and b on Rn such that
(1) f = g+b.
(2) ∥g∥Lq ≤∥f∥Lq and ∥g∥L∞≤2
n
q α.
(3) b = ∑j bj, where each bj is supported in a cube Qj. Furthermore, the cubes Qk
and Qj have disjoint interiors when j ̸= k.
(4) ∥bj∥q
Lq ≤2n+qαq|Qj|.
(5)

Qj bj(x)dx = 0.
(6) ∑j |Qj| ≤α−q∥f∥q
Lq.
(7) ∥b∥Lq ≤2
n+q
q ∥f∥Lq and ∥b∥L1 ≤2α1−q∥f∥q
Lq.

Hint: Imitate the basic idea of the proof of Theorem 5.3.1, but select a cube Q if
 1
|Q|

Q | f(x)|q dx
1/q > α. Deﬁne g and b as in the proof of Theorem 5.3.1.

5.3.9. Let f ∈L1(Rn). Then for any α > 0, prove that there exist disjoint cubes Qj
in Rn such that the set Eα = {x ∈Rn : Mc( f)(x) > α} is contained in 
j 3Qj and
α
4n <
1
|Qj|

Qj | f(t)|dt ≤α
2n .

Hint: For given α > 0, select all maximal dyadic cubes Qj(α) such that the average
of f over them is bigger than α. Given x ∈Eα, pick a cube R that contains x such
that the average of | f| over R is bigger than α and ﬁnd a dyadic cube Q such that
2−n|Q| < |R| ≤|Q| and that

R∩Q | f|dx > 2−nα|R|. Conclude that Q is contained
in some Qk(4−nα) and thus R is contained in 3Qk(4−nα). The collection of all
Qj = Qj(4−nα) is the required one.

5.3.10. Let K(x) be a function on Rn \{0} that satisﬁes |K(x)| ≤A|x|−n. Let η(x)
be a smooth function equal to 1 when |x| ≥2 and vanishing when |x| ≤1. For f ∈Lp,
1 ≤p < ∞, deﬁne truncated singular integral operators

374
5 Singular Integrals of Convolution Type
T (ε)( f)(x) =

|y|≥ε K(y) f(x−y)dy,
T (ε)
η ( f)(x) =

Rn η(y/ε)K(y) f(x−y)dy.
Show that the truncated maximal singular integral T (∗)( f) = supε>0 |T (ε)( f)| is Lp
bounded for 1 < p < ∞if and only if the smoothly truncated maximal singular in-
tegral T (∗)
η ( f) = supε>0 |T (ε)
η ( f)| is Lp bounded. Formulate an analogous statement
for p = 1.
5.3.11. (M. Mastyło) Let 1 ≤p < ∞. Suppose that Tε are linear operators deﬁned
on Lp(Rn) such that for all f ∈Lp(Rn) we have |Tε( f)| ≤Aε−a∥f∥Lp for some
0 < a,A < ∞. Also suppose that there is a constant C < ∞such that the maximal
operator T∗( f) = supε>0 |Tε( f)| satisﬁes
T∗(h)∥Lp ≤C∥h∥Lp for all h ∈S (Rn).
Prove that the same inequality is valid for all f ∈Lp(Rn).

Hint: For a ﬁxed δ > 0 deﬁne Sδ( f) = supε>δ |Tε( f)|, which is a subadditive func-
tional on Lp(Rn). For a ﬁxed f0 ∈Lp(Rn) deﬁne a linear space X0 = {λ f0 : λ ∈C}
and a linear functional T0 on X0 by setting T0(λ f0) = λSδ( f0). By the Hahn–
Banach theorem there is an extension #T0 of T0 that satisﬁes |#T0( f)| ≤Sδ( f) for
all f ∈Lp(Rn). Since Sδ is Lp is bounded on Schwartz functions with norm at most
C, then so is #T0. But #T0 is linear and by density it is bounded on Lp(Rn) with norm
at most C; consequently, ∥Sδ( f0)∥Lp = ∥T0( f0)∥Lp = ∥#T0( f0)∥Lp ≤C∥f0∥Lp. The
required conclusion for T∗follows by Fatou’s lemma.

5.4 Sufﬁcient Conditions for Lp Boundedness
We have used the Calder´on–Zygmund decomposition to prove weak type (1,1)
boundedness for singular integral and maximal singular integral operators, assum-
ing that these operators are already L2 bounded. It is therefore natural to ask for
sufﬁcient conditions that imply L2 boundedness for such operators. Precisely, what
are sufﬁcient conditions on functions K on Rn \ {0} so that the corresponding sin-
gular and maximal singular integral operators associated with K are L2 bounded?
We saw in Section 5.2 that if K has the special form K(x) = Ω(x/|x|)/|x|n for some
Ω ∈L1(Sn−1) with mean value zero, then condition (5.2.16) is necessary and suf-
ﬁcient for the L2 boundedness of T, while the L2 boundedness of T (∗) requires the
stronger smoothness condition (5.2.24).
For the general K considered in this section (for which the corresponding op-
erator does not necessarily commute with dilations), we only give some sufﬁcient
conditions for L2 boundedness of T and T (∗∗).
Throughout this section K denotes a locally integrable function on Rn \{0} that
satisﬁes the “size” condition
sup
R>0

R≤|x|≤2R |K(x)|dx = A1 < ∞,
(5.4.1)

5.4 Sufﬁcient Conditions for Lp Boundedness
375
the “smoothness” condition
sup
y̸=0

|x|≥2|y| |K(x−y)−K(x)|dx = A2 < ∞,
(5.4.2)
and the “cancellation” condition
sup
0<R1<R2<∞


R1<|x|<R2
K(x)dx
 = A3 < ∞,
(5.4.3)
for some A1,A2,A3 > 0. As mentioned earlier, condition (5.4.2) is often referred to
as H¨ormander’s condition. In this section we show that these three conditions give
rise to convolution operators that are bounded on Lp.
5.4.1 Sufﬁcient Conditions for Lp Boundedness of Singular
Integrals
We ﬁrst note that under conditions (5.4.1), (5.4.2), and (5.4.3), there exists a tem-
pered distribution W of the form (5.3.7) that coincides with K on Rn \{0}. Indeed,
condition (5.4.3) implies that there exists a sequence δ j ↓0 such that
lim
j→∞

δ j<|x|≤1 K(x)dx = L
exists. Using (5.3.8), we conclude that there exists such a tempered distribution W.
Note that we must have |L| ≤A3.
We observe that the difference of two distributions W and W ′ that coincide with
K on Rn \{0} must be supported at the origin.
Theorem 5.4.1. Assume that K satisﬁes (5.4.1), (5.4.2), and (5.4.3), and let W be a
tempered distribution of the form (5.3.7) that coincides with K on Rn \{0}. Then we
have
sup
0<ε<N<∞
sup
ξ∈Rn |(Kχε<|·|<N)∧(ξ)| ≤15(A1 +A2 +A3)
(5.4.4)
and consequently
sup
ξ∈Rn | 1W(ξ)| ≤15(A1 +A2 +A3).
(5.4.5)
Thus the operator given by convolution with W maps L2(Rn) to itself with norm at
most 15(A1 +A2 +A3). Consequently, it also maps L1(Rn) to L1,∞(Rn) with bound
at most a dimensional constant multiple of A1 + A2 + A3 and Lp(Rn) to itself with
bound at most Cn max(p,(p−1)−1)(A1 +A2 +A3), when 1 < p < ∞, where Cn is a
dimensional constant.

376
5 Singular Integrals of Convolution Type
Proof. Let us set K(ε,N)(x) = K(x)χε<|x|<N. Estimate (5.4.4) implies that for all f
in S (Rn) we have
 f ∗K(δ j, j)
L2 ≤15(A1 +A2 +A3)
f

L2
uniformly in j. Using this, (5.3.9), and Fatou’s lemma, we obtain that
 f ∗W

L2 ≤15(A1 +A2 +A3)
f

L2 ,
for all f ∈S (Rn), and this is equivalent to (5.4.5).
Case 1: Suppose that ε < |ξ|−1 < N. Then we write

K(ε,N)(ξ) = I1(ξ)+I2(ξ),
where
I1(ξ) =

ε<|x|<|ξ|−1 K(x)e−2πix·ξ dx,
I2(ξ) =

|ξ|−1<|x|<N K(x)e−2πix·ξ dx.
We now have
I1(ξ) =

ε<|x|<|ξ|−1 K(x)dx+

ε<|x|<|ξ|−1 K(x)(e−2πix·ξ −1)dx.
(5.4.6)
It follows that
|I1(ξ)| ≤A3 +2π|ξ|

|x|<|ξ|−1 |x||K(x)|dx ≤A3 +2π(2A1)
uniformly in ε. Let us now examine I2(ξ). Let z =
ξ
2|ξ|2 so that e2πiz·ξ = −1 and
2|z| = |ξ|−1. By changing variables x = x′ −z, rewrite I2 as
I2(ξ) = −

|ξ|−1<|x′−z|<N K(x′ −z)e−2πix′·ξ dx′ ;
hence averaging gives
I2(ξ) = 1
2

|ξ|−1<|x|<NK(x)e−2πix·ξdx−1
2

|ξ|−1<|x−z|<NK(x−z)e−2πix·ξ dx.
Now use that

A F dx−

B Gdx =

B(F −G)dx+

A\B F dx−

B\A F dx
(5.4.7)

5.4 Sufﬁcient Conditions for Lp Boundedness
377
to write I2(ξ) = J1(ξ)+J2(ξ)+J3(ξ)+J4(ξ)+J5(ξ), where
J1(ξ) = + 1
2

|ξ|−1<|x−z|<N

K(x)−K(x−z)

e−2πix·ξ dx,
(5.4.8)
J2(ξ) = + 1
2

|ξ|−1<|x|<N
|x−z|≤|ξ|−1
K(x)e−2πix·ξ dx,
(5.4.9)
J3(ξ) = + 1
2

|ξ|−1<|x|<N
|x−z|≥N
K(x)e−2πix·ξ dx,
(5.4.10)
J4(ξ) = −1
2

|ξ|−1<|x−z|<N
|x|≤|ξ|−1
K(x)e−2πix·ξ dx,
(5.4.11)
J5(ξ) = −1
2

|ξ|−1<|x−z|<N
|x|≥N
K(x)e−2πix·ξ dx.
(5.4.12)
Since 2|z| = |ξ|−1, J1(ξ) is bounded in absolute value by 1
2A2, in view of (5.4.2).
Next observe that |ξ|−1 ≤|x| ≤3
2|ξ|−1 in (5.4.9), while 1
2|ξ|−1 ≤|x| ≤|ξ|−1 in
(5.4.11); hence both J2 and J4 are bounded by 1
2A1. Finally, we have 1
2N < |x| < N
in (5.4.10) (since |x| > N −1
2|ξ|−1), and similarly we have N ≤|x| < 3
2N in (5.4.12).
Thus both J3 and J5 are bounded above by 1
2A1.
Case 2: If ε < N ≤|ξ|−1, then we write

ε<|x|<N K(x)e−2πix·ξ dx =

ε<|x|<N K(x)dx+

ε<|x|<N K(x)(e−2πix·ξ −1)dx
which is bounded in absolute value by
A3 +2π|ξ|

|x|≤|ξ|−1 |K(x)||x|dx ≤A3 +4πA1.
Notice that if ξ = 0, only the ﬁrst term appears which is bounded by A3.
Case 2: If |ξ|−1 ≤ε < N, we write

ε<|x|<NK(x)e−2πix·ξdx =

|ξ|−1<|x|<NK(x)e−2πix·ξdx−

|ξ|−1<|x|<εK(x)e−2πix·ξdx,
and both of the terms on the right are similar to I2(ξ) which was shown to be
bounded by 2A1 + 1
2A2.
In all cases (5.4.4) holds.
□

378
5 Singular Integrals of Convolution Type
5.4.2 An Example
We now give an example of a distribution that satisﬁes conditions (5.4.1), (5.4.2),
and (5.4.3).
Example 5.4.2. Let τ be a nonzero real number and let K(x) =
1
|x|n+iτ deﬁned for
x ∈Rn \{0}. For a sequence δk ↓0 and ϕ a Schwartz function on Rn, deﬁne
4
W,ϕ
5
= lim
k→∞

δk≤|x| ϕ(x)
dx
|x|n+iτ ,
(5.4.13)
whenever the limit exists. We claim that for some choices of sequences δk, W is a
well deﬁned tempered distribution on Rn. Take, for example, δk = e−2πk/τ. For this
sequence δk, observe that

δk≤|x|≤1
1
|x|n+iτ dx = ωn−1
1−(e−2πk/τ)−iτ
−iτ
= 0,
and thus
4
W,ϕ
5
=

|x|≤1(ϕ(x)−ϕ(0))
dx
|x|n+iτ +

|x|≥1 ϕ(x)
dx
|x|n+iτ ,
(5.4.14)
which implies that W ∈S ′(Rn), since
4
W,ϕ
5 ≤C
∇ϕ

L∞+
|x|ϕ(x)

L∞

.
If ϕ is supported in Rn \{0}, then
4
W,ϕ
5
=

Rn K(x)ϕ(x)dx.
Therefore W coincides with the function K away from the origin. Moreover, (5.4.1)
and (5.4.2) are clearly satisﬁed for K, while (5.4.3) is also satisﬁed, since


R1<|x|<R2
1
|x|n+iτ dx
 = ωn−1

R−iτ
1
−R−iτ
2
−iτ
 ≤2ωn−1
|τ|
.
Remark 5.4.3. It is important to emphasize that the limit in (5.4.13) may not exist
for all sequences δk →0. For example, the limit in (5.4.13) does not exist if δk =
e−πk/τ. Moreover, for a different choice of a sequence δk for which the limit in
(5.4.13) exists (for example, δk = e−π(2k+1)/τ), we obtain a different distribution W1
that coincides with the function K(x) = |x|−n−iτ on Rn \{0}.
We discuss a point of caution. We can directly check that the distributions W
deﬁned by (5.4.13) are not homogeneous distributions of degree −n −iτ. In fact,
the only homogeneous distribution of degree −n−iτ that coincides with the func-
tion |x|−n−iτ away from zero is a multiple of the distribution u−n−iτ, where uz is

5.4 Sufﬁcient Conditions for Lp Boundedness
379
deﬁned in (2.4.7). Let us investigate the relationship between u−n−iτ and W deﬁned
in (5.4.14). Recall that (2.4.8) gives
4
u−n−iτ,ϕ
5
=

|x|≥1 ϕ(x) π−i τ
2
Γ (−i τ
2)|x|−n−iτ dx
+

|x|≤1(ϕ(x)−ϕ(0)) π−i τ
2
Γ (−i τ
2)|x|−n−iτ dx+ ωn−1π−i τ
2
−iτΓ (−i τ
2)ϕ(0).
Using (5.4.14), we conclude that u−n−iτ −c1W = c2δ0 for suitable nonzero constants
c1 and c2. Since the Dirac mass at the origin is not a homogeneous distribution of
degree −n−iτ, it follows that neither is W.
Since

u−n−iτ = uiτ = c3|ξ|iτ ,
the identity u−n−iτ −c1W = c2δ0 can be used to obtain a formula for the Fourier
transform of W and thus produce a different proof that convolution with W is a
bounded operator on L2(Rn).
5.4.3 Necessity of the Cancellation Condition
Although conditions (5.4.1), (5.4.2), and (5.4.3) are sufﬁcient for L2 boundedness,
they might not necessary. However, we show that (5.4.3) is a necessary condition,
given (5.4.1).
Proposition 5.4.4. Suppose that K is a function on Rn \ {0} that satisﬁes (5.4.1).
Let W be a tempered distribution on Rn related to K as in (5.3.7). If the operator
T given by convolution with W maps L2(Rn) to itself (equivalently if 1W is an L∞
function), then the function K must satisfy (5.4.3).
Proof. Pick a radial C ∞function ϕ supported in the ball |x| ≤2 with 0 ≤ϕ ≤1,
and ϕ(x) = 1 when |x| ≤1. For R > 0 let ϕR(x) = ϕ(x/R). Fourier inversion for
distributions gives the second equality,
(W ∗ϕR)(0) =
4
W,ϕR5
=
4 1W, 2
ϕR5
=

Rn 1W(ξ)Rn 1ϕ(Rξ)dξ ,
and the preceding identity implies that
|(W ∗ϕR)(0)| ≤
 1W

L∞
1ϕ

L1 =
T

L2→L2
1ϕ

L1
uniformly in R > 0. Fix 0 < R1 < R2 < ∞. If R2 ≤2R1, we have


R1<|x|<R2
K(x)dx
 ≤

R1<|x|<2R1
|K(x)|dx ≤A1 ,

380
5 Singular Integrals of Convolution Type
which implies the required conclusion. We may therefore assume that 2R1 < R2.
Since the part of the integral in (5.4.3) over the set R1 < |x| < 2R1 is controlled by
A1, it sufﬁces to control the integral of K(x) over the set 2R1 < |x| < R2. Since the
function ϕR2 −ϕR1 is supported away from the origin, the action of the distribution
W on it can be written as integration against the function K. We have

RnK(x)(ϕR2(x)−ϕR1(x))dx
=

2R1<|x|<R2
K(x)dx+

R1<|x|<2R1
K(x)(1−ϕR1(x))dx+

R2<|x|<2R2
K(x)ϕR2(x)dx.
The sum of the last two integrals is bounded by 3A1 (since 0 ≤ϕ ≤1), while the
ﬁrst integral is equal to
(W ∗ϕR2)(0)−(W ∗ϕR1)(0)
and is therefore bounded by 2∥T∥L2→L2∥1ϕ ∥L1. We conclude that the function K
must satisfy (5.4.3) with constant
A3 ≤3A1 +2∥1ϕ ∥L1∥T∥L2→L2 ≤c

A1 +∥T∥L2→L2

.
This establishes the assertion.
□
5.4.4 Sufﬁcient Conditions for Lp Boundedness of Maximal
Singular Integrals
We now discuss the analogous result to Theorem 5.4.1 for the maximal singular
integral operator T (∗∗).
Theorem 5.4.5. Suppose that K satisﬁes (5.4.1), (5.4.2), and (5.4.3) and let T (∗∗) be
as in (5.3.18). Then T (∗∗) is bounded on Lp(Rn), 1 < p < ∞, with norm
T (∗∗)
Lp→Lp ≤Cn max(p,(p−1)−1)(A1 +A2 +A3),
where Cn is a dimensional constant.
Proof. We ﬁrst deﬁne an operator T associated with K that satisﬁes (5.4.1), (5.4.2),
and (5.4.3). Because of condition (5.4.3), there exists a sequence δ j ↓0 such that
lim
j→∞

δ j<|x|≤1 K(x)dx
exists. Therefore, for ϕ ∈S (Rn) we can deﬁne a tempered distribution
4
W,ϕ
5
= lim
j→∞

δ j≤|x|≤j K(x)ϕ(x)dx

5.4 Sufﬁcient Conditions for Lp Boundedness
381
and an operator T given by T( f) = f ∗W for f ∈S (Rn). In view of Theorems 5.4.1
and 5.3.3, T admits an Lp bounded extension (1 < p < ∞) with
T

Lp→Lp ≤cn max(p,(p−1)−1)(A1 +A2 +A3)
(5.4.15)
and is weak type (1,1). This extension is still denoted by T.
Fix 1 < p < ∞and f ∈Lp(Rn)∩L∞(Rn) with compact support. We have
T (ε,N)( f)(x)
=

ε≤|x−y|<N K(x−y) f(y)dy = T (ε)( f)(x)−T (N)( f)(x)
=

ε≤|x−y| K(x−y) f(y)dy−

N≤|x−y| K(x−y) f(y)dy
=

ε≤|x−y|(K(x−y)−K(z1 −y)) f(y)dy+

ε≤|x−y| K(z1 −y) f(y)dy
−

N≤|x−y|(K(x−y)−K(z2 −y)) f(y)dy−

N≤|x−y| K(z2 −y) f(y)dy
=

ε≤|x−y|(K(x−y)−K(z1 −y)) f(y)dy+T( f)(z1)−T( f χ|x−·|<ε)(z1)
−

N≤|x−y|(K(x−y)−K(z2 −y)) f(y)dy−T( f)(z2)+T( f χ|x−·|<N)(z2),
where z1 and z2 are arbitrary points in Rn that satisfy |z1 −x| ≤ε
2 and |z2 −x| ≤N
2 .
We used that f has compact support in order to be able to write T (ε)( f)(x) and
T (N)( f)(x) as convergent integrals for almost every x.
At this point we take absolute values, average over |z1 −x| ≤ε
2 and |z2 −x| ≤N
2 ,
and we apply H¨older’s inequality in two terms. We obtain the estimate
|T (ε,N)( f)(x)|
≤1
vn
2
ε
n 
|z1−x|≤ε
2

|x−y|≥ε |K(x−y)−K(z1 −y)|| f(y)|dydz1
+ 1
vn
2
ε
n 
|z1−x|≤ε
2
|T( f)(z1)|dz1
+
 1
vn
2
ε
n 
|z1−x|≤ε
2
|T( f χ|x−·|<ε)(z1)|p dz1
 1
p
+ 1
vn
 2
N
n 
|z2−x|≤N
2

|x−y|≥N |K(x−y)−K(z2 −y)|| f(y)|dydz2
+ 1
vn
 2
N
n 
|z2−x|≤N
2
|T( f)(z2)|dz2
+
 1
vn
 2
N
n 
|z2−x|≤N
2
|T( f χ|x−·|<N)(z2)|p dz2
 1
p
,

382
5 Singular Integrals of Convolution Type
where vn is the volume of the unit ball in Rn. Applying condition (5.4.2) and estimate
(5.4.15), we obtain for f in Lp(Rn)∩L∞(Rn) with compact support that
|T (ε,N)( f)(x)|
≤1
vn
2
ε
n 
|z1−x|≤ε
2
|T( f)(z1)|dz1 + 1
vn
 2
N
n 
|z2−x|≤N
2
|T( f)(z2)|dz2
+cn
 3
∑
j=1
Aj

max(p,(p−1)−1)
 1
vn
2
ε
n 
|z1−x|≤ε | f(z1)|p dz1
 1
p
+cn
 3
∑
j=1
Aj

max(p,(p−1)−1)
 1
vn
 2
N
n 
|z2−x|≤N | f(z2)|p dz2
 1
p
+2A2
 f

L∞.
We now use density to remove the compact support condition on f and obtain the
last displayed estimate for all functions f in Lp(Rn)∩L∞(Rn). Taking the supremum
over all 0 < ε < N and over all N > 0, we deduce that for all f in Lp(Rn)∩L∞(Rn)
we have the estimate
T (∗∗)( f)(x) ≤2A2
f

L∞+Sp( f)(x),
(5.4.16)
where Sp is the sublinear operator deﬁned by
Sp( f)(x) = 2M(T( f))(x)+3n+1cn
 3
∑
j=1
Aj

max(p,(p−1)−1)(M(| f|p)(x))
1
p ,
and M is the Hardy–Littlewood maximal operator.
Recalling that M maps L1 to L1,∞with bound at most 3n and also Lp to Lp,∞with
bound at most 2 · 3n/p for 1 < p < ∞(Exercise 2.1.4), we conclude that Sp maps
Lp(Rn) to Lp,∞(Rn) with norm at most
Sp

Lp→Lp,∞≤#cn(A1 +A2 +A3)max(p,(p−1)−1),
(5.4.17)
where #cn is another dimensional constant.
Now write f = fα + f α, where
fα = f χ| f|≤α/(16A2)
and
f α = f χ| f|>α/(16A2).
The function fα is in L∞∩Lp and f α is in L1 ∩Lp. Moreover, we see that
f α
L1 ≤(16A2/α)p−1f
p
Lp.
(5.4.18)

5.4 Sufﬁcient Conditions for Lp Boundedness
383
Apply the Calder´on–Zygmund decomposition (Theorem 5.3.1) to the function f α at
height αγ to write f α = gα + bα, where gα is the good function and bα is the bad
function of this decomposition. Using (5.3.1), we obtain
gα
Lp ≤2n/p′(αγ)1/p′ f α1/p
L1 ≤2(n+4)/p′(A2γ)1/p′ f

Lp.
(5.4.19)
We now use (5.4.16) to get
|{x ∈Rn : T (∗∗)( f)(x) > α}| ≤b1 +b2 +b3 ,
(5.4.20)
where
b1 = |{x ∈Rn : 2A2
 fα

L∞+Sp( fα)(x) > α/4}|,
b2 = |{x ∈Rn : 2A2
gα
L∞+Sp(gα)(x) > α/4}|,
b3 = |{x ∈Rn : T (∗∗)(bα)(x) > α/2}|.
Observe that 2A2∥fα∥L∞≤α/8. Selecting γ = 2−n−5(A1 + A2)−1 and using prop-
erty (2) in Theorem 5.3.1, we obtain
2A2
gα
L∞≤A22n+1αγ ≤α2−4 < α
8
and therefore
b1 ≤|{x ∈Rn : Sp( fα)(x) > α/8}|,
b2 ≤|{x ∈Rn : Sp(gα)(x) > α/8}|.
(5.4.21)
Since γ ≤(2n+5A1)−1, it follows from (5.3.27) that
b3 ≤


j
Q∗
j
+2n+8A2
f α
L1
α
≤
(5√n)n
γ
+2n+8A2
f α
L1
α
,
and using (5.4.18), we obtain
b3 ≤Cn(A1 +A2)pα−pf
p
Lp.
Using Chebyshev’s inequality in (5.4.21) and (5.4.17), we ﬁnally obtain that
b1 +b2 ≤(8/α)p (#cn)p(A1+A2+A3)p max(p,(p−1)−1)pf
p
Lp +
gαp
Lp

.
Combining the estimates for b1,b2, and b3 and using (5.4.19), we deduce
T (∗∗)( f)

Lp,∞≤Cn(A1 +A2 +A3)max(p,(p−1)−1)
f

Lp(Rn) .
(5.4.22)
Finally, we need to obtain a similar estimate to (5.4.22), in which the weak Lp norm
on the left is replaced by the Lp norm. This is a consequence of Theorem 1.3.2 via

384
5 Singular Integrals of Convolution Type
interpolation between the estimates L
p+1
2 →L
p+1
2 ,∞and L2p →L2p,∞for 2 < p < ∞
and between the estimates L2p →L2p,∞and L1 →L1,∞for 1 < p < 2. The latter
estimate follows from Theorem 5.3.5. See also Corollary 5.3.7.
□
Exercises
5.4.1. Let T be a convolution operator that is L2 bounded. Suppose that a given
function f0 ∈L1(Rn) ∩L2(Rn) has vanishing integral and that T( f0) is integrable.
Prove that T( f0) also has vanishing integral.
5.4.2. Let K satisfy (5.4.1), (5.4.2), and (5.4.3) and let W ∈S ′ be an extension of
K on Rn. Let f be a compactly supported C 1 function on Rn with mean value zero.
Prove that the function f ∗W is in L1(Rn).
5.4.3. Suppose K is a function on Rn \{0} that satisﬁes (5.4.1), (5.4.2), and (5.4.3).
Let K(ε,N)(x) = K(x)χε<|x|<N for 0 < ε < N < ∞and let T (ε,N) be the operator given
by convolution with K(ε,N). Let 1 < p < ∞and f ∈Lp(Rn). Prove that for some
sequence ε j ↓0, T (ε j,N)( f) converges almost everywhere as j →∞and N →∞.

Hint: Use Theorems 5.4.5 and 2.1.14.

5.4.4. (a) Prove that for all x,y ∈Rn that satisfy 0 ̸= x ̸= y we have

x−y
|x−y| −x
|x|
 ≤2 |y|
|x| .
(b) Let Ω be an integrable function with mean value zero on the sphere Sn−1. Sup-
pose that Ω satisﬁes a Lipschitz (H¨older) condition of order 0 < α < 1 on Sn−1.
This means that
|Ω(θ1)−Ω(θ2)| ≤B0|θ1 −θ2|α
for all θ1,θ2 ∈Sn−1. Prove that K(x) = Ω(x/|x|)/|x|n satisﬁes H¨ormander’s condi-
tion (5.4.3) with constant at most a multiple of B0 +∥Ω∥L∞.
5.4.5. Let Ω be an L1 function on Sn−1 with mean value zero.
(a) Let ω∞(t) = sup{|Ω(θ1) −Ω(θ2)| : θ1,θ2 ∈Sn−1, |θ1 −θ2| ≤t} and suppose
that the following Dini condition holds:
 1
0 ω∞(t)dt
t < ∞.
Prove that the function K(x)=Ω(x/|x|)|x|−n satisﬁes H¨ormander’s condition.
(b) (A. Calder´on and A. Zygmund) For A ∈O(n), let
A
 = sup{|θ −A(θ)| : θ ∈Sn−1}.

5.5 Vector-Valued Inequalities
385
Suppose that Ω satisﬁes the more general Dini-type condition
 1
0 ω1(t)dt
t < ∞,
where
ω1(t) = sup
A∈O(n)
∥A∥≤t

Sn−1 |Ω(A(θ))−Ω(θ)|dθ .
Prove the same conclusion as in part (a).

Hint: Part (b): Use the result in part (a) of Exercise 5.4.4 and switch to polar
coordinates.

5.5 Vector-Valued Inequalities
Certain nonlinear expressions that appear in Fourier analysis, such as maximal func-
tions and square functions, can be viewed as linear quantities taking values in some
Banach space. This point of view provides the motivation for a systematic study of
Banach-valued operators. Let us illustrate this line of thinking via an example. Let
T be a linear operator acting on Lp of some measure space (X,μ) and taking values
in the set of measurable functions of another measure space (Y,ν). The seemingly
nonlinear inequality


∑
j
|T( f j)|21
2 
Lp ≤Cp


∑
j
| f j|21
2 
Lp
(5.5.1)
can be transformed to a linear one with only a slight change of view. Let us denote
by Lp(X,ℓ2) the Banach space of all sequences {f j}j of measurable functions on X
that satisfy
{f j}j

Lp(X,ℓ2) =

X

∑
j
| f j|2p
2 dμ
1
p
< ∞.
(5.5.2)
Deﬁne a linear operator acting on such sequences by setting
⃗T({f j}j) = {T( f j)}j.
(5.5.3)
Then (5.5.1) is equivalent to the inequality
⃗T({f j}j)

Lp(Y,ℓ2) ≤Cp
{f j}j

Lp(X,ℓ2) ,
(5.5.4)
in which ⃗T is thought of as a linear operator acting on the Lp space of ℓ2-valued
functions on X. This is the basic idea of vector-valued inequalities. A nonlinear
inequality such as (5.5.1) can be viewed as a linear norm estimate for an operator
acting and taking values in suitable Banach spaces.

386
5 Singular Integrals of Convolution Type
5.5.1 ℓ2-Valued Extensions of Linear Operators
The following result is classical and fundamental in the subject of vector-valued
inequalities.
Theorem 5.5.1. Let 0 < p,q < ∞and let (X,μ) and (Y,ν) be two σ-ﬁnite measure
spaces. The following are valid:
(a) Suppose that T is a bounded linear operator from Lp(X) to Lq(Y) with norm N.
Then T has an ℓ2-valued extension, that is, for all complex-valued functions f j in
Lp(X) we have


∑
j
|T( f j)|21
2 
Lq(Y) ≤Cp,q N


∑
j
| f j|21
2 
Lp(X)
(5.5.5)
for some constant Cp,q that satisﬁes Cp,q = 1 if p ≤q. Moreover, if T maps real-
valued Lp functions to real-valued Lq functions with norm Nreal, then (5.5.5) holds
for real-valued functions f j with Nreal in place of N.
(b) Suppose that T is a bounded linear operator from Lp(X) to Lq,∞(Y) with norm
M. Then T has an ℓ2-valued extension, that is,


∑
j
|T( f j)|21
2 
Lq,∞(Y) ≤Dp,q M


∑
j
| f j|21
2 
Lp(X)
(5.5.6)
for some constant Dp,q that depends only on p and q. Moreover, if T maps real-
valued Lp functions to real-valued Lq,∞functions with norm Mreal, then (5.5.5) holds
for real-valued functions f j with Mreal in place of M.
To prove this theorem, we need the following identities.
Lemma 5.5.2. For any 0 < r < ∞, deﬁne constants
Ar =
Γ ( r+1
2 )
π
r+1
2
1
r
and
Br =
Γ ( r
2+1)
π
r
2
1
r
.
(5.5.7)
Then for any λ1,λ2,...,λn ∈R we have

Rn |λ1x1 +···+λnxn|re−π|x|2dx
1
r
= Ar (λ 2
1 +···+λ 2
n )
1
2 ,
(5.5.8)
where dx = dx1 ···dxn. Also for all w1,w2,...,wn ∈C we have

Cn |w1z1 +···+wnzn|re−π|z|2dz
1
r
= Br(|w1|2 +···+|wn|2)
1
2 ,
(5.5.9)
where dz = dz1 ···dzn = dx1dy1 ···dxndyn if z j = xj +iyj.

5.5 Vector-Valued Inequalities
387
Proof. Dividing both sides of (5.5.8) by (λ 2
1 + ··· + λ 2
n )
1
2 , we reduce things to the
situation in which λ 2
1 + ··· + λ 2
n = 1. Let e1 = (1,0,...,0)t be the standard basis
column unit vector on Rn and ﬁnd an orthogonal n×n matrix A ∈O(n) (orthogonal
means a real matrix satisfying At = A−1) such that A−1e1 = (λ1,...,λn)t. Then the
ﬁrst coordinate of Ax is
(Ax)1 = Ax·e1 = x·Ate1 = x·A−1e1 = λ1x1 +···+λnxn .
Now change variables y = Ax in the integral in (5.5.8) and use the fact that |Ax| = |x|
to obtain

Rn |λ1x1 +···+λnxn|re−π|x|2dx
1
r
=

Rn |y1|re−π|y|2dy
1
r
=

2
 ∞
0 tre−πt2dt
1
r
=
 ∞
0 s
r−1
2 e−πsds
1
r
=
Γ ( r+1
2 )
π
r+1
2
1
r
= Ar ,
which proves (5.5.8). We used the fact that

R e−π|x|2dx = 1.
The proof of (5.5.9) is almost identical. We normalize by assuming that
|w1|2 +···+|wn|2 = 1,
and we let ε1 be the column vector of Cn having 1 in the ﬁrst entry and zero
elsewhere. We ﬁnd a unitary n × n matrix A such that A −1ε1 = (w1,...,wn)t.
Unitary means A −1 = A ∗, where A ∗is the conjugate transpose matrix of A ,
i.e., the matrix whose entries are the complex conjugates of A t and that satis-
ﬁes u · A v = A ∗u · v for all u,v ∈Cn. Then (A z)1 = w1z1 + ··· + wnzn and also
|A z| = |z|; therefore, changing variables ζ = A z in the integral in (5.5.9), we can
rewrite that integral as

Cn |ζ1|re−π|ζ|2dζ
1
r
=

C |ζ1|re−π|ζ1|2dζ1
1
r
=

2π
 ∞
0 tre−πt2t dt
1
r
=

π
 ∞
0 s
r
2 e−πsds
1
r

388
5 Singular Integrals of Convolution Type
=
Γ ( r
2+1)
π
r
2
1
r
= Br ,
where the second equality follows by polar coordinates and the third by the change
of variables s = t2.
□
We now continue with the proof of Theorem 5.5.1.
Proof. The proof is based on conclusion (5.5.9) of Lemma 5.5.2.
Part (a): Assume ﬁrst that q < p and let Br be as in (5.5.7). We may assume
that the sequence {f j}j is indexed by Z+. Use successively identity (5.5.9), the
boundedness of T, H¨older’s inequality with exponents p/q and (p/q)′ with respect
to the measure e−π|z|2dz, and identity (5.5.9) again to deduce for n ∈Z+

 n
∑
j=1
|T( f j)|21
2 
q
Lq(Y) = (Bq)−q

Y

Cn |z1T( f1)+···+znT( fn)|qe−π|z|2dzdν
= (Bq)−q

Cn

Y |T(z1 f1 +···+zn fn)|q dν e−π|z|2dz
≤(Bq)−qNq

Cn

X |z1 f1 +···+zn fn|p dμ
 q
p
e−π|z|2dz
≤(Bq)−qNq

Cn

X |z1 f1 +···+zn fn|p dμ e−π|z|2dz
 q
p
= (Bq)−qNq

Bp
p

X
 n
∑
j=1
| f j|2 p
2 dμ
 q
p
= (BpB−1
q )qNq
 n
∑
j=1
| f j|21
2 
q
Lp(X) .
Now, letting n →∞in the previous inequality, we obtain the required conclusion
with Cp,q = BpB−1
q
when q < p.
We now turn to the case q ≥p. Using similar reasoning, we obtain

 n
∑
j=1
|T( f j)|21
2 
q
Lq(Y) = (Bq)−q

Y

Cn |z1T( f1)+···+znT( fn)|qe−π|z|2dzdν
= (Bq)−q

Cn

Y |T(z1 f1 +···+zn fn)|q dν e−π|z|2dz
≤(NB−1
q )q

Cn

X |z1 f1 +···+zn fn|p dμ
 q
p
e−π|z|2dz
= (NB−1
q )q

X |z1 f1 +···+zn fn|p dμ

q/p
L
q
p (Cn,e−π|z|2dz)
≤(NB−1
q )q
$
X
|z1 f1 +···+zn fn|p
L
q
p (Cn,e−π|z|2dz)dμ
%q
p

5.5 Vector-Valued Inequalities
389
= (NB−1
q )q
$
X

Cn |z1 f1 +···+zn fn|qe−π|z|2dz
p
q
dμ
%q
p
= (NB−1
q )q
$
X(Bq)p n
∑
j=1
| f j|2 p
2 dμ
% q
p
= Nq
 n
∑
j=1
| f j|21
2 
q
Lp(X) .
Note that we made use of Minkowski’s integral inequality (Exercise 1.1.6) in the last
inequality. Letting n →∞proves the required conclusion with Cp,q = 1 if q ≥p.
If T happens to map real-valued functions to real-valued functions, then we adapt
the preceding argument by taking f j to be real-valued functions, we replace Bp by
Ap, Bq by Aq, N by Nreal and we use identity (5.5.8) instead of (5.5.9).
Part (b): Inequality (5.5.6) will be a consequence of (5.5.5) and of the following
result of Exercise 1.1.12 which holds when Y is σ-ﬁnite:
∥g∥Lq,∞≤
sup
0<ν(E)<∞
ν(E)
1
q −1
r

E |g|r dν
1
r
≤

q
q−r
1
r ∥g∥Lq,∞,
(5.5.10)
where 0 < r < q and the supremum is taken over all subsets E of Y of ﬁnite measure.
Using (5.5.10), we obtain


∑
j
|T( f j)|21
2 
Lq,∞(Y)
≤
sup
0<ν(E)<∞
ν(E)
1
q −1
r

E

∑
j
|T( f j)|2r
2 dν
1
r
=
sup
0<ν(E)<∞
ν(E)
1
q −1
r

Y

∑
j
|χE T( f j)|2r
2 dν
1
r
≤
sup
0<ν(E)<∞
ν(E)
1
q −1
r TE

Lp→LrCp,r

X

∑
j
| f j|2p
2 dμ
1
p
,
(5.5.11)
where TE is deﬁned by TE( f) = χE T( f). Since for any function f in Lp(X) we have
ν(E)
1
q −1
r TE( f)

Lr ≤

q
q−r
1
r T( f)

Lq,∞≤

q
q−r
1
r M
f

Lp ,
it follows that for any measurable set E of ﬁnite measure the estimate
ν(E)
1
q −1
r TE

Lp→Lr ≤

q
q−r
1
r M
(5.5.12)
is valid. Inserting (5.5.12) in (5.5.11), we obtain (5.5.6) with Dp,q = Cp,r
 q
q−r
1
r and
0 < r < q. Recall that Cp,r = 1 if r ≥p and Cp,r = BpB−1
r
if r < p.

390
5 Singular Integrals of Convolution Type
If T happens to map real-valued functions to real-valued functions, then we take
f j to be real-valued and we replace M by Mreal, Br by Ar, and Bq by Aq in the
preceding argument.
□
5.5.2 Applications and ℓr-Valued Extensions of Linear Operators
Here is an application of Theorem 5.5.1:
Example 5.5.3. On the real line consider the intervals Ij = [bj,∞) for j ∈Z. Let Tj
be the operator given by multiplication on the Fourier transform by the characteristic
function of Ij. Then we have the following two inequalities:


∑
j∈Z
|Tj( f j)|21
2 
Lp(R) ≤Cp


∑
j∈Z
| f j|21
2 
Lp(R) ,
(5.5.13)


∑
j∈Z
|Tj( f j)|21
2 
L1,∞(R) ≤C


∑
j∈Z
| f j|21
2 
L1(R) ,
(5.5.14)
for 1 < p < ∞. To prove these, ﬁrst observe that the operator T = 1
2(I +iH) is given
on the Fourier transform by multiplication by the characteristic function of the half-
axis [0,∞) [precisely, the Fourier multiplier of T is equal to 1 on the set (0,∞)
and 1/2 at the origin; this function is almost everywhere equal to the characteristic
function of the half-axis [0,∞)]. Moreover, each Tj is given by
Tj( f)(x) = e2πib jxT(e−2πib j(·) f)(x)
and thus with gj(x) = e−2πib jx f(x), (5.5.13) and (5.5.14) can be written respectively
as


∑
j∈Z
|T(gj)|21
2 
Lp(R) ≤Cp


∑
j∈Z
|gj|21
2 
Lp(R),


∑
j∈Z
|T(gj)|21
2 
L1,∞(R) ≤C


∑
j∈Z
|gj|21
2 
L1(R).
Theorem 5.5.1 gives that both of the previous estimates are valid by in view of the
boundedness of T = 1
2(I + iH) from Lp to Lp and from L1 →L1,∞. For a slight
generalization and an extension to higher dimensions, see Exercise 5.6.1.
We have now seen that bounded operators from Lp to Lq (or to Lq,∞) always
admit ℓ2-valued extensions. It is natural to ask whether they also admit ℓr-valued
extensions for some r ̸= 2. For some values of r we may answer this question. Here
is a straightforward corollary of Theorem 5.5.1.

5.5 Vector-Valued Inequalities
391
Corollary 5.5.4. Let (X,μ) and (Y,ν) be σ-ﬁnite measure spaces. Suppose that T
is a linear bounded operator from Lp(X) to Lp(Y) with norm A for some 1 < p < ∞.
Let r be a number between p and 2. Then we have


∑
j
|T( f j)|r1
r 
Lp(Y) ≤A


∑
j
| f j|r1
r 
Lp(X) .
(5.5.15)
Proof. Using Exercise 5.5.2 we interpolate between the trivial bound Lp(X,ℓp) →
Lp(Y,ℓp) and the bound Lp(X,ℓ2) →Lp(Y,ℓ2), which follows from Theorem 5.5.1.
We obtain the bound Lp(X,ℓr) →Lp(Y,ℓr) since r lies between p and 2.
□
Example 5.5.5. The result of Corollary 5.5.4 may fail if r does not lie in the interval
with endpoints p and 2. Let us take, for example, 1 < p < 2 and consider an r < p.
Take X = Y = R and deﬁne a linear operator T by setting
T( f)(x) = 1f(x)χ[0,1](x).
Then T is Lp bounded, since ∥T( f)∥Lp ≤∥T( f)∥Lp′ ≤∥f∥Lp. Now take f j = χ[ j−1, j]
for j = 1,...,N. A simple calculation gives
 N
∑
j=1
|T( f j)(x)|r1
r = N
1
r

e−2πix −1
−2πix
χ[0,1](x)
 ,
while
 N
∑
j=1
| f j|r1
r = χ[0,N] .
It follows that N1/r ≤CN1/p for all N > 1, and hence (5.5.15) cannot hold if p > r.
We have now seen that ℓr-valued extensions for r ̸= 2 may fail in general. But do
they fail for some speciﬁc operators of interest in Fourier analysis? For instance, is
the inequality


∑
j∈Z
|H( f j)|r1
r 
Lp ≤Cp,r


∑
j∈Z
| f j|r1
r 
Lp
(5.5.16)
true for the Hilbert transform H whenever 1 < p,r < ∞? The answer to this question
is afﬁrmative. Inequality (5.5.16) is indeed valid and was ﬁrst proved using complex
function theory. In the next section we plan to study inequalities such as (5.5.16)
for general singular integrals using the Calder´on–Zygmund theory of the previous
section applied to the context of Banach-valued functions.
5.5.3 General Banach-Valued Extensions
Let B be a Banach space over the ﬁeld of complex numbers with norm ∥∥B, and let
B∗be its dual (with norm ∥∥B∗). A function F deﬁned on a measure space (X,μ)

392
5 Singular Integrals of Convolution Type
and taking values in B is called B-measurable if there exists a measurable subset
X0 of X such that μ(X \X0) = 0, F[X0] is contained in some separable subspace B0
of B, and for every u∗∈B∗the complex-valued map
x →
4
u∗,F(x)
5
is measurable. A consequence of this deﬁnition is that the positive function x →
∥F(x)∥B on X is measurable; to see this, use the relevant result in [382, p. 131].
For 0 < p ≤∞we denote by Lp(X) the space Lp(X,C). Let Lp(X)⊗B be the set
of all ﬁnite linear combinations of elements of B with coefﬁcients in Lp(X), that is,
elements of the form
F = f1u1 +···+ fmum,
(5.5.17)
where f j ∈Lp(X), uj ∈B, and m ∈Z+. We deﬁne Lp(X,B) to be the space of all
B-measurable functions F on X satisfying

X
F(x)
p
B dμ(x)
1
p
< ∞,
(5.5.18)
with the obvious modiﬁcation when p = ∞. Similarly deﬁne Lp,∞(X,B) as the space
of all B-measurable functions F on X satisfying

F(·)

B

Lp,∞(X) < ∞.
(5.5.19)
Then Lp(X,B) (respectively, Lp,∞(X,B)) is called the Lp (respectively, Lp,∞) space
of functions on X with values in B. The quantity in (5.5.18) (respectively, in (5.5.19))
is the norm of F in Lp(X,B) (respectively, in Lp,∞(X,B)).
Proposition 5.5.6. Let B be a Banach space and (X,μ) a σ-ﬁnite measure space.
(a) The set {∑m
j=1 χE j uj : uj ∈B, Ej ⫅X are pairwise disjoint and μ(Ej) < ∞} is
dense in Lp(X,B) whenever 0 < p < ∞.
(b) The set {∑∞
j=0 χE j uj : uj ∈B, Ej ⫅X are pairwise disjoint and X = ∪∞
j=0Ej} is
dense in L∞(X,B).
(c) The space C ∞
0 ⊗B of functions of the form ∑m
j=1 ϕj uj, where uj ∈B, ϕj are in
C ∞
0 (Rn), is dense in Lp(Rn,B) for 1 ≤p < ∞.
Proof. If F ∈Lp(X,B) for 0 < p ≤∞, then F is B-measurable; thus there exists
X0 ⫅X satisfying μ(X \ X0) = 0 and F[X0] ⫅B0, where B0 is some separable
subspace of B. Choose a countable dense sequence {uj}∞
j=1 of B0.
(a) First assume that p < ∞. Since X is σ-ﬁnite, for any ε > 0, there exists a
measurable subset X1 of X0 with μ(X1) < ∞such that

X\X1
F(x)
p
B dμ < ε p
3 .
Setting
#B(uj,ε) =
	
u ∈B0 : ∥u−uj∥B < ε(3μ(X1))−1
p 
,

5.5 Vector-Valued Inequalities
393
we have B0 ⫅∞
j=1 #B(uj,ε). Let A1 = #B(u1,ε) and Aj = #B(uj,ε)\(j−1
i=1 #B(ui,ε))
for j ≥2. It is easily seen that {Aj}∞
j=1 are pairwise disjoint and ∞
j=1 Aj =
∞
j=1 #B(uj,ε). Set Ej = F−1[Aj] ∩X1. Then X1 = ∞
j=1 Ej and {Ej}∞
j=1 are pair-
wise disjoint. Since μ(X1) = ∑∞
j=1 μ(Ej) < ∞, it follows that μ(Ej) < ∞and also
that for some m ∈Z+,

∞
j=m+1 E j
∥F(x)∥p
B dμ < ε p
3 .
(5.5.20)
Moreover, one can easily verify that ∑m
j=1 χE juj is B-measurable. Notice that
∥F(x) −uj∥B < ε(3μ(X1))−1/p for any x ∈Ej and j ∈{1,...,m}. This fact com-
bined with (5.5.20) and the mutual disjointness of {Ej}m
j=1 yields that

X
F(x)−
m
∑
j=1
χE j(x)uj

p
B
dμ =

X\X1
F(x)
p
B dμ +

∪∞
j=m+1E j
F(x)
p
B dμ
+

m
j=1 E j

m
∑
j=1
χE j(x)[F(x)−uj]

p
B
dμ
< ε p
3 + ε p
3 + ε p
3 = ε p .
(b) Now consider the case p = ∞. Obviously we have B0 ⫅∞
j=1 B(uj,ε), where
B(uj,ε) = {u ∈B0 : ∥u −uj∥B < ε}. Let A1 = B(u1,ε) and for j ≥2 deﬁne sets
Aj = B(uj,ε)\(j−1
i=1 B(ui,ε)). Let Ej = F−1[Aj] for j ≥1 and E0 = X \(∞
j=1 Ej).
Then μ(E0) = 0. As in the proof of the case p < ∞, we have that {Ej}∞
j=0 are
pairwise disjoint and X0 ⫅∞
j=0 Ej. Pick u0 = 0. Notice that ∑∞
j=0 χE juj is B-
measurable. Since ∥F(x)−uj∥B < ε for any x ∈Ej and j ≥0, we have
F −
∞
∑
j=0
χE juj

L∞(X,B)
=

∞
∑
j=0
χE j(F −uj)

L∞(X,B)
< ε ,
which completes the proof in the case p = ∞.
(c) For the last assertion, we ﬁx a smooth function with supported in the unit ball
of Rn with integral one. Let ϕδ(x) = δ −nϕ(x/δ) for x ∈Rn and δ > 0. Given a
function ∑m
j=1 χE j uj as in part (a) approximating a given f in Lp ⊗B, we consider
the function ∑m
j=1(χE j ∗ϕδ)uj which lies in C ∞
0 ⊗B. Since ∥χE j ∗ϕδ −χE j∥Lp →0
as δ →0 when 1 ≤p < ∞, ∑m
j=1(χE j ∗ϕδ)uj tends to ∑m
j=1 χE j uj in Lp ⊗B as
δ →0, and the conclusion follows.
□
Let (X,μ) be a measure space. If F is an element of L1(X) ⊗B given as in
(5.5.17), we deﬁne its integral (which is an element of B) by setting

X F(x)dμ(x) =
m
∑
j=1

X f j(x)dμ(x)

uj.

394
5 Singular Integrals of Convolution Type
Observe that for every F ∈L1(X)⊗B we have


X F(x)dμ(x)

B =
sup
∥u∗∥B∗≤1

>
u∗,
m
∑
j=1

X f j dμ

uj
?
=
sup
∥u∗∥B∗≤1


X
4
u∗,
m
∑
j=1
f juj
5
dμ

≤

X
sup
∥u∗∥B∗≤1
4
u∗,
m
∑
j=1
f juj
5dμ
=
F

L1(X,B) .
Thus the linear operator
F →IF =

X F(x)dμ(x)
is bounded from L1(X) ⊗B into B. Since every element of L1(X,B) is a (norm)
limit (Proposition 5.5.6 (c)) of a sequence of elements in L1(X)⊗B, by continuity,
the operator F →IF has a unique extension on L1(X,B) that we call the Bochner
integral of F and denote by

X F(x)dμ(x).
L1(X,B) is called the space of all Bochner integrable functions from X to B. Since
the Bochner integral is an extension of IF, for each F ∈L1(X,B) we have


X F(x)dx

B ≤

X
F(x)

B dx.
Consequently, measurable functions F with

X ∥F(x)∥B dx < ∞are Bochner inte-
grable over X. It is not difﬁcult to show that the Bochner integral of F is the only
element of B that satisﬁes
@
u∗,

X F(x)dμ(x)
A
=

X
4
u∗,F(x)
5
dμ(x)
(5.5.21)
for all u∗∈B∗. The next result concerns duality in this context when X = Rn.
Proposition 5.5.7. Let B be a Banach space and 1 ≤p ≤∞.
(a) For any F ∈Lp(Rn,B) we have
∥F∥Lp(Rn,B) =
sup
∥G∥Lp′ (Rn,B∗)≤1


Rn⟨G(x),F(x)⟩dx
 .
Consequently, Lp(Rn,B) isometrically embeds in (Lp′(Rn,B∗))∗.
(b) for any G ∈Lp′(Rn,B∗) one has
∥G∥Lp′(Rn,B∗) =
sup
∥F∥Lp(Rn,B)≤1


Rn⟨G(x),F(x)⟩dx

and thus Lp′(Rn,B∗) isometrically embeds in (Lp(Rn,B))∗.

5.5 Vector-Valued Inequalities
395
Proof. H¨older’s inequality yields that the right-hand side of (a) is controlled by its
left-hand side. It remains to establish the reverse inequality.
For F ∈Lp(Rn,B) and ε > 0, by Proposition 5.5.6, there is Fε(x)=∑m
j=1 χE j(x)uj
with m ∈Z+ or m = ∞(when p = ∞) such that ∥Fε −F∥Lp(Rn,B) < ε/2, where
{Ej}m
j=1 are pairwise disjoint subsets of Rn and uj ∈B. Since Fε ∈Lp(Rn,B), we
choose a nonnegative function h satisfying ∥h∥Lp′(Rn) ≤1 such that
Fε

Lp(Rn,B) =

Rn
Fε(x)
p
B dx
 1
p
<

Rn h(x)
Fε(x)

B dx+ ε
4 .
(5.5.22)
When 1 ≤p < ∞, we can further choose h ∈Lp′(Rn) to be a function with bounded
support, which ensures that it is integrable. For given uj ∈B, there exists u∗
j ∈B∗
satisfying ∥u∗
j∥B∗= 1 and
∥uj∥B < ⟨u∗
j,uj⟩+
ε
4(∥h∥L1(Rn) +1) .
(5.5.23)
Set G(x) = ∑m
j=1 h(x)χE j(x)u∗
j. Clearly G is B∗-measurable and ∥G∥Lp′(Rn,B∗) ≤1.
It follows from (5.5.22) and (5.5.23) that

Rn⟨G(x),Fε(x)⟩dx =

Rn h(x)
m
∑
j=1
χE j(x)⟨u∗
j,uj⟩dx
≥

Rn h(x)
m
∑
j=1
'
∥uj∥B −
ε
4(∥h∥L1(Rn) +1)
(
χE j(x)dx
≥
Fε

Lp(Rn,B) −ε
4 −ε
4 .
Using H¨older’s inequality we have


Rn⟨G(x),Fε(x)−F(x)⟩dx
 ≤∥G∥Lp′(Rn,B∗)∥F −Fε∥Lp(Rn,B) < ε
2 ,
hence we obtain
Fε

Lp(Rn,B) ≤
sup
∥G∥Lp′ (Rn,B∗)≤1


Rn⟨G(x),F(x)⟩dx
+ε .
Letting ε →0 yields the desired inequality in part (a).
(b) The duality statement |⟨G(x),F(x)⟩| ≤∥G(x)∥B∗∥F(x)∥B together with
H¨older’s inequality imply the ≥inequality in part (b). We prove the ≤inequal-
ity via an argument symmetric with that in case (a). For completeness we in-
clude the details. For a given G in Lp′(Rn,B) and ε > 0, by Proposition 5.5.6,
there is Gε(x) = ∑m
j=1 χE j(x)u∗
j with m ∈Z+ or m = ∞(when p = 1) such that
∥Gε −G∥Lp′(Rn,B∗) < ε/2, where {Ej}m
j=1 are pairwise disjoint subsets of Rn and

396
5 Singular Integrals of Convolution Type
u∗
j ∈B∗. Since Gε lies in Lp′(Rn,B∗), we choose a nonnegative function h satisfy-
ing ∥h∥Lp(Rn) ≤1 such that
Gε

Lp′(Rn,B∗) =

Rn
Gε(x)
p′
B∗dx
 1
p′
<

Rn h(x)
Gε(x)

B∗dx+ ε
4 . (5.5.24)
When 1 < p ≤∞, we can further choose h ∈Lp(Rn) to be a function with bounded
support, which ensures that it is integrable. For each u∗
j ∈B, there exists uj ∈B
satisfying ∥uj∥B = 1 and
∥u∗
j∥B∗< ⟨u∗
j,uj⟩+
ε
4(∥h∥L1(Rn) +1) .
(5.5.25)
Set F(x) = ∑m
j=1 h(x)χE j(x)uj. Clearly F is B-measurable and ∥F∥Lp(Rn,B) ≤1. It
follows from (5.5.24) and (5.5.25) that

Rn⟨Gε(x),F(x)⟩dx =

Rn h(x)
m
∑
j=1
χE j(x)⟨u∗
j,uj⟩dx
≥

Rn h(x)
m
∑
j=1
'
∥u∗
j∥B∗−
ε
4(∥h∥L1(Rn) +1)
(
χE j(x)dx
≥
Gε

Lp′(Rn,B∗) −ε
2 .
Hence, for any ε > 0, we have
Gε

Lp′(Rn,B∗) ≤
sup
∥F∥Lp(Rn,B)≤1


Rn⟨G(x),F(x)⟩dx
+ε
which implies the reverse inequality in part (b) by letting ε →0.
□
Deﬁnition 5.5.8. Let X,Y be measure spaces. Let T be a linear operator that maps
Lp(X) to Lq(Y) (respectively, Lp(X) to Lq,∞(Y)) for some 0 < p,q ≤∞. We deﬁne
another operator ⃗T acting on Lp(X)⊗B by setting
⃗T
 m
∑
j=1
f juj

=
m
∑
j=1
T( f j)uj.
If ⃗T happens to have a bounded extension from Lp(X,B) to Lq(Y,B) (respectively
from Lp(X,B) to Lq,∞(Y,B)), then we say that T has a bounded B-valued exten-
sion. In this case we also denote by ⃗T the B-valued extension of T.
Example 5.5.9. Let B = ℓr for some 1 ≤r < ∞. Then a measurable function
F : X →B is just a sequence {f j}j of measurable functions f j : X →C. The
space Lp(X,ℓr) consists of all measurable complex-valued sequences {f j}j on X
that satisfy
{f j}j

Lp(X,ℓr) =


∑
j
| f j|r1
r 
Lp(X) < ∞.

5.5 Vector-Valued Inequalities
397
The space Lp(X)⊗ℓr is the set of all ﬁnite sums
m
∑
j=1
(aj1,aj2,aj3,...)gj ,
where gj ∈Lp(X) and (aj1,aj2,aj3,...) ∈ℓr, j = 1,...,m. This is certainly a sub-
space of Lp(X,ℓr). Now given ( f1, f2,...) ∈Lp(X,ℓr), let Fm = e1 f1 + ··· + em fm,
where ej is the inﬁnite sequence with zeros everywhere except at the jth entry, where
it has 1. Then Fm ∈Lp(X) ⊗ℓr and approximates f in the norm of Lp(X,ℓr). This
shows the density of Lp(X)⊗ℓr in Lp(X,ℓr).
If T is a linear operator bounded from Lp(X) to Lq(Y), then ⃗T is deﬁned by
⃗T({f j}j) = {T( f j)}j.
According to Deﬁnition 5.5.8, T has a bounded ℓr-extension if and only if the in-
equality


∑
j
|T( f j)|r1
r 
Lq ≤C


∑
j
| f j|r1
r 
Lp
is valid.
A linear operator T acting on measurable functions is called positive if it satisﬁes
f ≥0 =⇒T( f) ≥0. It is straightforward to verify that positive operators satisfy
f ≤g =⇒T( f) ≤T(g),
|T( f)| ≤T(| f|),
sup
j
|T( f j)| ≤T

sup
j
| f j|

,
(5.5.26)
for all f,g, f j measurable functions. We have the following result regarding vector-
valued extensions of positive operators:
Proposition 5.5.10. Let 0 < p,q ≤∞and (X,μ), (Y,ν) be two measure spaces. Let
T be a positive linear operator mapping Lp(X) to Lq(Y) (respectively, to Lq,∞(Y))
with norm A. Let B be a Banach space. Then T has a B-valued extension ⃗T that
maps Lp(X,B) to Lq(Y,B) (respectively, to Lq,∞(Y,B)) with the same norm.
Proof. Let us ﬁrst understand this theorem when B = ℓr for 1 ≤r ≤∞. The two
endpoint cases r = 1 and r = ∞can be checked easily using the properties in (5.5.26).
For instance, for r = 1 we have
∑
j
|T( f j)|

Lq ≤
∑
j
T(| f j|)

Lq =
T

∑
j
| f j|

Lq ≤A
∑
j
| f j|

Lp ,
while for r = ∞we have
sup
j
|T( f j)|

Lq ≤
T(sup
j
| f j|)

Lq ≤A
sup
j
| f j|

Lp .

398
5 Singular Integrals of Convolution Type
The required inequality for 1 < r < ∞,


∑
j
|T( f j)|r1
r 
Lq ≤A


∑
j
| f j|r1
r 
Lp ,
follows from the Riesz–Thorin interpolation theorem (see Exercise 5.5.2).
The result for a general Banach space B can be proved using the following in-
equality:
⃗T(F)(x)

B ≤T

∥F∥B

(x),
x ∈X,
(5.5.27)
by simply taking Lq norms. To prove (5.5.27), let us take F = ∑n
j=1 f juj. Then
⃗T(F)(x)

B =

n
∑
j=1
T( f j)(x)uj

B =
sup
∥u∗∥B∗≤1

4
u∗,
n
∑
j=1
T( f j)(x)uj
5
=
sup
∥u∗∥B∗≤1
T
 n
∑
j=1
f j
4
u∗,uj
5
(x)

≤T

sup
∥u∗∥B∗≤1
4
u∗,
n
∑
j=1
f juj
5

(x)
= T

n
∑
j=1
f juj

B

(x)
= T

∥F∥B

(x),
where the inequality makes use of the fact that T is a positive operator.
□
Exercises
5.5.1. ([207]) Let (X,μ) and (Y,ν) be σ-ﬁnite measure spaces and suppose that
0 < p1, p1 ≤∞, 1 ≤q0,q1 ≤∞, and that p0 > p1. For 0 < θ < 1 deﬁne p,q by
1
p = 1−θ
p0
+ θ
p1
,
1
q = 1−θ
q0
+ θ
q1
.
Let B1 and B2 be Banach spaces and let ⃗T be a linear operator that maps
Lp0(X,B1) to Lq0(Y,B2) with norm A0 and Lp1(X,B1) to Lq1(Y,B2) with norm
A1. Show that ⃗T has an extension that maps Lp(X,B1) to Lq(Y,B2) with norm at
most 9A1−θ
0
Aθ
1 , by following the steps below:
(a) Let i ∈{0,1}. If Fj, j = 1,...,m are in Lpi(B1) with disjoint supports, using
max j∈{1,...,m} ∥⃗T(Fj)(y)∥B2 ≤1
2m ∑εk=±1
∑m
k=1 εk⃗T(Fk)(y)

B2 for y ∈Y show that
 max
j=1,...,m∥⃗T(Fj)∥B2

Lqi ≤Ai

m
∑
j=1
Fj

Lpi(X,B1) .

5.5 Vector-Valued Inequalities
399
(b) Assume that F lies in a dense subspace of B1, it satisﬁes ∥∥F∥B1∥Lp = 1, and
it takes only ﬁnitely many values. For a λ > 1 pick a large integer N such that
λ −N < ∥F(x)∥B1 ≤λ N for all x ∈X such that ∥F(x)∥B1 ̸= 0 and deﬁne Fj = FχΩ j,
where Ω j = {x : 2j < ∥F∥B1 ≤2j+1}. Let a = p
p1 −p
p0 . Prove the inequalities
∑
j
λ −jaθFj

p0
Lp0(X,B1) ≤λ aθ p0
and
∑
j
λ jaθFj

p1
Lp1(X,B1) ≤1.
(c) Deﬁne g0(y) = max j λ −jaθ∥⃗T(Fj)(y)∥B2, g1(y) = max j λ ja(1−θ)∥⃗T(Fj)(y)∥B2
for y ∈Y and show that
∥g0∥Lq0(Y) ≤A0 λ aθ
and
∥g1∥Lq1(Y) ≤A1 .
(d) Prove that for all y ∈Y we have
∥⃗T(F)(y)∥B2 ≤∑
j
∥⃗T(Fj)(y)∥B2 ≤g0(y)1−θg1(y)θ

2+
1
λ aθ −1 +
1
λ a(1−θ) −1

and conclude that ∥⃗T(F)∥Lp(Y,B2) ≤9A1−θ
0
Aθ
1 by picking λ = (1+
√
2)aθ.

Hint: Part (d): Split the sum according to whether λ ja > g1(y)
g0(y) and λ ja ≤g1(y)
g0(y).

5.5.2. Prove the following version of the Riesz–Thorin interpolation theorem. Let
(X,μ) and (Y,ν) be σ-ﬁnite measure spaces. Let 1 < p0,q0,, p1,q1,r0,s0,r1,s1 < ∞
and 0 < θ < 1 satisfy
1−θ
p0
+ θ
p1
= 1
p ,
1−θ
q0
+ θ
q1
= 1
q ,
1−θ
r0
+ θ
r1
= 1
r ,
1−θ
s0
+ θ
s1
= 1
s .
Suppose that T is a linear operator that maps Lp0(X) to Lq0(Y) and Lp1(X) to
Lq1(Y). Deﬁne a vector-valued operator ⃗T by setting ⃗T({f j}j) = {T( f j)}j acting
on sequences of complex-valued functions deﬁned on X. Suppose that ⃗T maps
Lp0(X,ℓr0(C)) to Lq0(Y,ℓs0(C)) with norm M0 and Lp1(X,ℓr1(C)) to Lq1(Y,ℓs1(C))
with norm M1. Prove that ⃗T maps Lp(X,ℓr(C)) to Lq(Y,ℓs(C)) with norm at most
M1−θ
0
Mθ
1 .

Hint: Use the idea of the proof of Theorem 1.3.4. Apply Lemma 1.3.5 to the
function
F(z) =
m
∑
k=1
n
∑
j=1∑
l∈Z
aP(z)
k,l eiαk,l
∥{ak,l}l∥R(z)−P(z)
ℓr
bQ(z)
j,l eiβ j,l
∥{bk,l}l∥S(z)−Q(z)
ℓs′

Y T(χAk)(y)χB j(y)dν(y)

400
5 Singular Integrals of Convolution Type
where P(z) = p
p0 (1−z)+ p
p1 z, Q(z) = q′
q′
0 (1−z)+ q′
q′
1 z, R(z) = r
r0 (1−z)+ r
r1 z, and
S(z) = s′
s′
0 (1−z)+ s′
s′
1 z, {ak,l}l∈Z,{bj,l}l∈Z are ﬁnitely supported sequences of pos-
itive reals, αk,l,βk,l ∈R, Ak are pairwise disjoint subsets of X with ﬁnite measure,
and Bj are pairwise disjoint subsets of Y with ﬁnite measure.

5.5.3. Prove the following version of the Marcinkiewicz interpolation theorem. Let
(X,μ) and (Y,ν) be σ-ﬁnite measure spaces and let 0 < p0 < p < p1 ≤∞and
0 < θ < 1 satisfy
1−θ
p0
+ θ
p1
= 1
p .
Let B1,B2 be Banach spaces and ⃗T be deﬁned on Lp0(X,B1) + Lp1(X,B1) such
that for every y ∈Y and for all F,G ∈Lp0(X,B1)+Lp1(X,B1) we have
⃗T(F +G)(y)

B2 ≤
⃗T(F)(y)

B2 +
⃗T(G)(y)

B2 .
(a) Suppose that ⃗T maps Lp0(X,B1) to Lp0,∞(Y,B2) with norm A0 and Lp1(X,B1)
to Lp1,∞(Y,B2) with norm A1. Show that ⃗T maps Lp(X,B1) to Lp(Y,B2) with norm
at most 2

p
p−p0 +
p
p1−p
 1
p A1−θ
0
Aθ
1 .
(b) Let p0 = 1. If ⃗T is linear and maps L1(X,B1) to L1,∞(Y,B2) with norm A0 and
Lp1(X,B1) to Lp1(Y,B2) with norm A1, show that ⃗T maps Lp(X,B1) to Lp(Y,B2)
with norm at most 72

p−1
−1/pA1−θ
0
Aθ
1 .

Hint: Part (a): Copy the proof of Theorem 1.3.2. Part (b): Use Exercise 5.5.1.

5.5.4. For all x ∈Rn let ⃗K(x) be a bounded linear operator from B1 to B2 and
let Q ⊗B1 the space of all ﬁnite linear combinations of elements of the form F =
∑m
i=1 χEiui , where Ei are disjoint measurable subsets of Rn of ﬁnite measure, ui in
B1, and m ∈Z+.
(a) Suppose that ⃗K satisﬁes

Rn
⃗K(x)

B1→B2 dx = C1 < ∞.
Prove that the operator
⃗T(F)(x) =

Rn ⃗K(x−y)(F(y))dy,
initially deﬁned on Q ⊗B1, has an extension that maps Lp(Rn,B1) to Lp(Rn,B2)
with norm at most C1 for 1 ≤p < ∞.
(b) (Young’s inequality) Let 1 ≤p,q,s ≤∞be such that p < ∞, s > 1, 1/q + 1 =
1/s+1/p. Suppose that ⃗K satisﬁes

⃗K(·)

B1→B2

Ls(Rn) = C2 < ∞.

5.6 Vector-Valued Singular Integrals
401
Prove that the ⃗T deﬁned in part (a) has an extension that maps Lp(Rn,B1) to
Lq(Rn,B2) with norm at most C2.
(c) (Young’s inequality for weak type spaces) Suppose that 1 < p,s < ∞, 1/q+1 =
1/s+1/p, and that ⃗K satisﬁes

⃗K(·)

B1→B2

Ls,∞(Rn) = C3 < ∞.
Prove that the ⃗T deﬁned in part (a) has an extension that maps Lp(Rn,B1) to
Lq(Rn,B2).
(d) Prove the following (slight) generalization of the assertion in part (a). Suppose
that ⃗K satisﬁes

Rn
⃗K(x)(u)

B2 dx ≤C1∥u∥B1
for all u ∈B1. Then ⃗T has an extension that maps L1(Rn,B1) to L1(Rn,B2) with
norm at most C1.
5.5.5. Use the inequality for the Rademacher functions in Appendix C.2 instead of
Lemma 5.5.2 to prove part (a) of Theorem 5.5.1 in the special case p = q. Notice
that this approach does not yield a sharp constant.
5.5.6. Let 0 < p ̸= 2 ≤∞and suppose that Tj are uniformly bounded linear operators
from Lp(R) to Lp(R). Show that the inequality

 ∑
j∈Z
|Tj( f j)|21
2

Lp ≤Cp

 ∑
j∈Z
| f j|21
2

Lp
may fail.

Hint: Let Tj(g)(x) = g(x−j). When p > 2 take f j(x) = χ[−j,1−j] for j = 1,2,...,N.
When p < 2 take f j = χ[0,1] for j = 1,2,...,N.

5.5.7. Suppose that T is a linear operator that takes real-valued functions to real-
valued functions. Use Theorem 5.5.1(a) with p = q to prove that
sup
f real-valued
f̸=0
T( f)

Lp
f

Lp
=
sup
f complex-valued
f̸=0
T( f)

Lp
f

Lp
.
5.6 Vector-Valued Singular Integrals
We now discuss some results about vector-valued singular integrals. By this we
mean singular integral operators acting on functions deﬁned on Rn and taking values
in Banach spaces.

402
5 Singular Integrals of Convolution Type
5.6.1 Banach-Valued Singular Integral Operators
Suppose that B1 and B2 are Banach spaces. We denote by L(B1,B2) the space
of all bounded linear operators from B1 to B2. We consider a kernel ⃗K deﬁned on
Rn \ {0} that takes values in L(B1,B2). In other words, for all x ∈Rn \ {0}, ⃗K(x)
is a bounded linear operator from B1 to B2 with norm ∥⃗K(x)∥B1→B2. Thus for any
v ∈B1 and any x ∈Rn \{0} we have
⃗K(x)(v)

B2 ≤∥⃗K(x)∥B1→B2∥v∥B1 .
We assume that there is a constant A < ∞such that the size condition holds
⃗K(x)

B1→B2 ≤A|x|−n ,
(5.6.1)
and also the regularity condition
sup
y∈Rn\{0}

|x|≥2|y|
⃗K(x−y)−⃗K(x)

B1→B2 dx ≤A < ∞.
(5.6.2)
Moreover, we assume that there is a sequence εk ↓0 as k →∞and an element ⃗K0 of
L(B1,B2) such that
lim
k→∞


εk≤|y|≤1
⃗K(y)dy−⃗K0

B1→B2
= 0.
(5.6.3)
Given these assumptions, we deﬁne an operator ⃗T on C ∞
0 ⊗B1 as follows:
For functions fi ∈C ∞
0 (Rn) and ui ∈B1 we deﬁne
⃗T
 m
∑
i=1
fiui

(x) = lim
k→∞

εk≤|y|
⃗K(y)
 m
∑
i=1
fi(x−y)ui

dy
(5.6.4)
=
m
∑
i=1

|y|≤1( fi(x−y)−fi(x))⃗K(y)(ui)dy+
m
∑
i=1
fi(x)⃗K0(ui)
+

|y|>1
m
∑
i=1
fi(x−y)⃗K(y)(ui)dy.
(5.6.5)
Notice that for each i ∈{1,...,m} we have

|y|≤1| fi(x−y)−fi(x)|∥⃗K(y)(ui)∥B2dy ≤∥∇fi∥L∞∥ui∥B1

|y|≤1|y|∥⃗K(y)∥B1→B2dy
and this is a ﬁnite integral in view of (5.6.1). Thus the function
( fi(x−y)−fi(x))⃗K(y)(ui)

5.6 Vector-Valued Singular Integrals
403
is B2-integrable and the expression

|y|≤1( fi(x−y)−fi(x))∥⃗K(y)(ui)∥B2 dy
is a well-deﬁned element of B2. Also the integral in (5.6.5) is over the compact set
1 ≤|y| ≤|x|+M, where the ball B(0,M) contains the supports of all fi, and thus it
also converges in B2, using (5.6.1).
The following vector-valued extension of Theorem 5.3.3 is the main result of this
section.
Theorem 5.6.1. Let B1 and B2 be Banach spaces. Suppose that ⃗K(x) satisﬁes
(5.6.1), (5.6.2), and (5.6.3) for some A > 0 and ⃗K0 ∈L(B1,B2). Let ⃗T be the
operator associated with ⃗K as in (5.6.4). Assume that ⃗T is a bounded linear op-
erator from Lr(Rn,B1) to Lr(Rn,B2) with norm B⋆for some 1 < r ≤∞. Then ⃗T
has well-deﬁned extensions on Lp(Rn,B1) for all 1 ≤p < ∞. Moreover, there exist
dimensional constants Cn and C′
n such that
⃗T(F)

L1,∞(Rn,B2) ≤C′
n(A+B⋆)
F

L1(Rn,B1)
(5.6.6)
for all F in L1(Rn,B1) and
⃗T(F)

Lp(Rn,B2) ≤Cn max

p,(p−1)−1
(A+B⋆)
F

Lp(Rn,B1)
(5.6.7)
whenever 1 < p < ∞and F is in Lp(Rn,B1).
Proof. Although ⃗T is deﬁned on the entire L1(Rn,B1)∩Lr(Rn,B1), it will be con-
venient to work with its restriction to a smaller dense subspace of L1(Rn,B1). We
make the observation that the space Q ⊗B1 of all functions of the form ∑m
i=1 χRiui,
where Ri are disjoint dyadic cubes and ui ∈B1, is dense in L1(Rn,B1). Indeed, by
Proposition 5.5.6 (b) it sufﬁces to approximate a C ∞
0 ⊗B1-valued function with a
Q ⊗B1-valued function. But this is immediate since any function in C ∞
0 (Rn) can
be approximated in L1(Rn) by ﬁnite linear combinations of characteristic functions
of disjoint dyadic cubes.
Case 1: r = ∞. We ﬁx F = ∑m
i=1 χRiui in Q ⊗B1 and we notice that for each
x ∈Rn we have ∥F(x)∥B1 = ∑m
i=1 χRi(x)∥ui∥B1, which is also a ﬁnite linear combi-
nation of characteristic functions of dyadic cubes. Apply the Calder´on-Zygmund
decomposition to ∥F∥B1 at height γα, where γ = 2−n−1B−1
⋆
as in the proof of
Theorem 6.3.1. We extract a ﬁnite collection of closed dyadic cubes {Qj}j satis-
fying ∑j |Qj| ≤(γα)−1∥F∥L1(Rn,B1) and we deﬁne the good function of the decom-
position
G(x) =

F(x)
for x /∈∪jQj
|Qj|−1 
Qj F(x)dx
for x ∈Qj.

404
5 Singular Integrals of Convolution Type
Also deﬁne the bad function B(x) = F(x)−G(x). Then B(x) = ∑j Bj(x), where each
Bj is supported in Qj and has mean value zero over Qj. Moreover,
∥G∥L1(Rn,B1) ≤∥F∥L1(Rn,B1)
(5.6.8)
∥G∥L∞(Rn,B1) ≤2nγα
(5.6.9)
and ∥Bj∥L1(Rn,B1) ≤2n+1γα|Qj|, by an argument similar to that given in the proof
of Theorem 5.3.1. We only verify (5.6.9). On the cube Qj, G is equal to the constant
|Qj|−1 
Qj F(x)dx, and this is bounded by 2nγα. For each x ∈Rn \ 
j Qj and for
each k = 0,1,2,... there exists a unique nonselected dyadic cube Q(k)
x
of generation
k that contains x. Then for each k ≥0, we have

1
|Q(k)
x |

Q(k)
x
F(y)dy

B1
≤
1
|Q(k)
x |

Q(k)
x
∥F(y)∥B1 dy ≤γα.
The intersection of the closures of the cubes Q(k)
x
is the singleton {x}. Using Corol-
lary 2.1.16, we deduce that for almost all x ∈Rn \ 
j Qj we have
F(x) =
m
∑
i=1
χRi(x)ui =
m
∑
i=1
lim
k→∞

1
|Q(k)
x |

Q(k)
x
χRi(y)dy

ui = lim
k→∞
1
|Q(k)
x |

Q(k)
x
F(y)dy.
Since these averages are at most γα, we conclude that ∥F∥B1 ≤γα almost every-
where on Rn \ 
j Qj, hence ∥G∥B1 ≤γα a.e. on this set. This proves (5.6.9).
By assumption we have
∥⃗T(G)∥L∞(Rn,B) ≤B⋆∥G∥L∞(Rn,B) ≤2nγαB⋆= α/2.
Then the set
	
x ∈Rn : ∥⃗T(G)(x)∥B2 > α/2

is null and we have
	
x ∈Rn : ∥⃗T(F)(x)∥B2 > α

 ≤
	
x ∈Rn : ∥⃗T(B)(x)∥B2 > α/2

.
Let Q∗
j = 2√nQj. We have
{x ∈Rn : ∥T(B)(x)∥B2 > α/2}

≤

j
Q∗
j
+
	
x /∈

j
Q∗
j : ∥⃗T(B)(x)∥B2 > α/2


≤(2√n)n
γ
∥F∥L1(Rn,B1)
α
+ 2
α

(∪jQ∗
j)c ∥⃗T(B)(x)∥B2 dx
≤(2√n)n
γ
∥F∥L1(Rn,B1)
α
+ 2
α ∑
j

(Q∗
j)c ∥T(Bj)(x)∥B2 dx,
since B = ∑j Bj. It sufﬁces to estimate the last sum. Denoting by yj is the center of
the cube Qj and using the fact that Bj has mean value zero over Qj, we write

5.6 Vector-Valued Singular Integrals
405
∑
j

(Q∗
j)c
⃗T(Bj)(x)

B2 dx
= ∑
j

(Q∗
j)c


Qj
⃗K(x−y)−⃗K(x−yj)

(Bj(y))dy

B2
dx
≤∑
j

Qj
Bj(y)

B1

(Q∗
j)c
⃗K(x−y)−⃗K(x−yj)

B1→B2 dxdy
≤∑
j

Qj
Bj(y)

B1

|x−y j|≥2|y−y j|
⃗K(x−y)−⃗K(x−yj)

B1→B2 dxdy
≤A∑
j
∥Bj∥L1(Qj,B1)
≤2n+1A∥F∥L1(Rn,B1),
where we used the fact that |x−yj| ≥2|y−yj| for all x /∈Q∗
j and y ∈Qj and (5.6.2).
Consequently,
	
x ∈Rn : ∥⃗T( f)(x)∥B2 > α

 ≤(2√n)n
γ
∥F∥L1(Rn,B1)
α
+ 2
α 2n+1A∥F∥L1(Rn,B1)
=

(2√n)n2n+1B⋆+2n+1A
∥F∥L1(Rn,B1)
α
≤C′
n (A+B⋆)
∥F∥L1(Rn,B1)
α
,
where C′
n = (2√n)n2n+1 +2n+1. Thus ⃗T has an extension that maps L1(Rn,B1) to
L1,∞(Rn,B2) with constant Cn(A+B⋆). By interpolation (Exercise 5.5.3 (b)) it has
an extension that satisﬁes (5.6.7).
Case 2: 1 < r < ∞. We ﬁx F = ∑m
i=1 χRiui in Q ⊗B1 and we notice that for each
x ∈Rn we have ∥F(x)∥B1 = ∑m
i=1 χRi(x)∥ui∥B1. Thus the function x →∥F(x)∥B1 is
a ﬁnite linear combination of characteristic functions of disjoint dyadic cubes. We
prove the weak type estimate (5.6.6) by applying the Calder´on–Zygmund decompo-
sition to the function x →∥F(x)∥B1 deﬁned on Rn. Then we decompose F = G+B,
where G and B satisfy properties analogous to the case r = ∞. The new ingredient in
this case is that the set
	
x ∈Rn : ∥⃗T(G)(x)∥B2 > α/2

is not null but its measure
can be estimated as follows:
	
x ∈Rn : ∥⃗T(G)(x)∥B2 > α/2

 ≤
2B⋆
α
r
∥G∥r
L2(Rn,B1) ≤2
α ∥F∥L1(Rn,B1) ,
where the ﬁrst inequality is a consequence of the boundedness of ⃗T on Lr and the
second is obtained by combining (5.6.8) and (5.6.9). Combining this estimate for
the good function with the one for the bad function obtained in the preceding case,
it follows that ⃗T has an extension that satisﬁes (5.6.6), i.e., it maps ⃗T : L1(Rn,B1)
to L1,∞(Rn,B2) with constant C′
n (A+B⋆), where C′
n = 2+(2√n)n2n+1 +2n+1.

406
5 Singular Integrals of Convolution Type
Next we interpolate between the estimates ⃗T : L1(Rn,B1) →L1,∞(Rn,B2)
and ⃗T : Lr(Rn,B1) →Lr(Rn,B2). Using Exercise 5.5.3 (b) and the fact that
(p−1)−1/p ≤(p−1)−1 when 1 < p < 2, we obtain
⃗T(F)

Lp(Rn,B2) ≤Cn(p−1)−1(A+B⋆)∥F∥Lp(Rn,B1) ,
(5.6.10)
when 1 < p < min(r,2), where Cn is independent of r, p, B1, and B2.
We prove (5.6.7) for p > r via duality. Since ⃗K(x) is an operator from B1 to B2,
its adjoint ⃗K∗(x) is an operator from B∗
2 to B∗
1. Obviously ⃗K∗(x) and ⃗K(x) have the
same norm, so (5.6.1) holds. For the same reason, condition (5.6.2) also holds for
⃗K∗, Finally condition (5.6.3) also holds since for any εk ↓as k →∞we have


εk≤|y|≤1
⃗K∗(y)dy−⃗K0∗

B∗
2→B∗
1
=


εk≤|y|≤1
⃗K(y)dy−⃗K0

B1→B2
→0.
Let ⃗T ′ be the Banach-valued operator with kernel ⃗K∗(−x). Clearly ⃗T ′ is well
deﬁned on C ∞
0 ⊗B∗
2. For F(y) = ∑m
i=1 fi(y)w∗
i in C ∞
0 ⊗B∗
2 and G(z) = ∑l
j=1 gj(z)vj
in C ∞
0 ⊗B1 we prove the following duality relation

Rn
4⃗T ′(F)(x),G(x)
5
dx =

Rn
4
F(z),⃗T(G)(z)
5
dz.
(5.6.11)
Indeed, for each index i ∈{1,...,m} and j ∈{1,...,l} we have

Rn
>
lim
k→∞

|y|≥εk
⃗K∗(−y)( fi(x−y)w∗
i )dy,gj(x)vj
?
dx
= lim
k→∞

|y|≥εk

Rn
>
⃗K∗(−y)( fi(x−y)w∗
i ),gj(x)vj
?
dxdy
= lim
k→∞

|y|≥εk

Rn
>
⃗K∗(−y)( fi(z)w∗
i ),gj(z+y)vj
?
dzdy
= lim
k→∞

|y|≥εk

Rn
>
fi(z)w∗
i ,⃗K(−y)(gj(z+y)vj)
?
dzdy
=

Rn
>
fi(z)w∗
i , lim
k→∞

|y|≥εk
⃗K(y)(gj(z−y)vj)dy
?
dz,
proving (5.6.11), provided we can justify the interchange the x (or z)-integral with the
y-integral paired with the limit. These justiﬁcations can be given using the deﬁnition
in (5.6.4). For the part of the y-integral where |y| ≥1 the interchange is easily justi-
ﬁed in view of the absolute convergence of the double integral and (5.5.21). For the
part of the y-integral where |y| ≤1 we introduce the operators ⃗K0∗and ⃗K0 and we use
the facts that |gj(z −y) −gj(z)| ≤∥∇gj∥L∞|y| and | fi(x −y) −fi(x)| ≤∥∇fi∥L∞|y|
together with the assumption ∥⃗K(y)∥B1→B2 ≤A|y|−n and (5.5.21) to obtain the ab-
solute convergence of the double integral, and thus justify the interchange.

5.6 Vector-Valued Singular Integrals
407
We claim that ⃗T ′ is bounded from Lr′(Rn,B∗
2) to Lr′(Rn,B∗
1). Indeed, to verify
this assertion, we ﬁx F in C ∞
0 ⊗B∗
2 and use Proposition 5.5.7 (b). Using (5.6.11),
for each G ∈C ∞
0 ⊗B1, we write


Rn
4⃗T ′(F)(x),G(x)
5
dx
 =


Rn
4
F(x),⃗T(G)(x)
5
dx

≤

Rn
F(x)

B∗
2
⃗T(G)(x)

B2 dx
≤∥F∥Lr′(Rn,B∗
2)
⃗T(G)

Lr(Rn,B2)
≤∥F∥Lr′(Rn,B∗
2)B⋆∥G∥Lr(Rn,B1) ,
so taking the supremum over all G ∈C ∞
0 ⊗B1 with ∥G∥Lr(Rn,B1) ≤1 we deduce
that
⃗T ′(F)

Lr′(Rn,B∗
1) ≤B⋆∥F∥Lr′(Rn,B∗
2) .
Collecting these facts, we have that ⃗T ′ is associated with a kernel ⃗K∗(−x) which
satisﬁes (5.6.1), (5.6.2), and (5.6.3) (with ⃗K0∗in place of ⃗K0), and moreover it has a
bounded extension that maps Lr′(Rn,B∗
2) to Lr′(Rn,B∗
1). The Calder´on-Zygmund
decomposition in the vector-valued setting (discussed in the ﬁrst paragraph of the
proof) yields that ⃗T ′ has an extension that satisﬁes
⃗T ′(F)

L1,∞(Rn,B∗
1) ≤C′
n(A+B⋆)∥F∥L1(Rn,B∗
2) .
Using interpolation (Exercise 5.5.3 (b)) and the fact that (p′ −1)1/p′ ≤p, we obtain
that for 1 < p′ < r′, ⃗T ′ has an extension on Lp′(Rn,B∗
2) that satisﬁes
⃗T ′(F)

Lp′(Rn,B∗
1) ≤Cn p(A+B⋆)∥F∥Lp′(Rn,B∗
2) .
(5.6.12)
Let F = ∑m
i=1 ϕi ui be in the dense subspace C ∞
0 ⊗B1 of Lp(Rn,B1). We observe
that ∥⃗T(F)∥Lp(Rn,B2) < ∞. Indeed, all ϕi are supported in |x| ≤R, then for |x| ≥2R
we have


|y|≤R
⃗K(x−y)
 m
∑
i=1
ϕi ui

dy

B2
≤A
|x|
2
−n m
∑
i=1
∥ϕi∥L1∥ui∥B1
(5.6.13)
which is integrable to the power p > 1 in the region |x| ≥2R. Also using the deﬁ-
nition in (5.6.4) we see that the expression on the left in (5.6.13) is bounded, hence
integrable to the power p in the region |x| ≤2R. For a ﬁxed r < p < ∞, we are now
able to apply Proposition 5.5.7 (a) to write
⃗T(F)

Lp(Rn,B2) ≤
sup
∥G∥Lp′ (Rn,B∗
2)≤1


Rn
4
G(x),⃗T(F)(x)
5
dx

=
sup
∥G∥Lp′ (Rn,B∗
2)≤1


Rn
4⃗T ′(G)(x),F(x)
5
dx


408
5 Singular Integrals of Convolution Type
≤
sup
∥G∥Lp′ (Rn,B∗
2)≤1
⃗T ′(G)

Lp′(Rn,B∗
1)∥F∥Lp(Rn,B1)
≤Cn p(A+B⋆)∥F∥Lp(Rn,B1) ,
where we used (5.6.12). This combined with (5.6.10) implies the required conclu-
sion whenever r < ∞and p ∈

1,min(r,2)

∪(r,∞). The remaining p’s follow by
interpolation (Exercise 5.5.3 (a)).
□
5.6.2 Applications
We proceed with some applications. An important consequence of Theorem 5.6.1 is
the following:
Corollary 5.6.2. Let A,B > 0 and let Wj be a sequence of tempered distributions
on Rn whose Fourier transforms are uniformly bounded functions (i.e., |2
Wj| ≤B).
Suppose that for each j, Wj coincides with a function Kj on Rn \{0} that satisﬁes
|Kj(x)| ≤A|x|−n ,
x ̸= 0,
(5.6.14)
lim
εk→0

|x|≥εk
Kj(x)dx = Lj ,
(5.6.15)
for some complex constant Lj, and
sup
y∈Rn\{0}

|x|≥2|y| sup
j
|Kj(x−y)−Kj(x)|dx ≤A.
(5.6.16)
Then there are constants Cn,C′
n > 0 such that for all 1 < p,r < ∞we have


∑
j
|Wj ∗f j|r1
r 
L1,∞≤C′
n max(r,(r−1)−1)(A+B)


∑
j
| f j|r1
r 
L1,


∑
j
|Wj ∗f j|r1
r 
Lp ≤Cn c(p,r)(A+B)


∑
j
| f j|r1
r 
Lp,
where c(p,r) = max(p,(p−1)−1)max(r,(r −1)−1).
Proof. Let Tj be the operator given by convolution with the distribution Wj. Clearly
Tj is L2 bounded with norm at most B. It follows from Theorem 5.3.3 that the Tj’s
are of weak type (1,1) and also bounded on Lr with bounds at most a dimensional
constant multiple of max(r,(r−1)−1)(A+B), uniformly in j. We set B1 = B2 = ℓr
and deﬁne
⃗T({f j}j) = {Wj ∗f j}j

5.6 Vector-Valued Singular Integrals
409
for {f j}j ∈Lr(Rn,ℓr). It is immediate to verify that ⃗T maps Lr(Rn,ℓr) to itself
with norm at most a dimensional constant multiple of max(r,(r−1)−1)(A+B). The
kernel of ⃗T is ⃗K in L(ℓr,ℓr) deﬁned by
⃗K(x)({t j}j) = {Kj(x)t j}j,
{t j}j ∈ℓr.
Obviously, we have
⃗K(x−y)−⃗K(x)

ℓr→ℓr ≤sup
j
|Kj(x−y)−Kj(x)|,
and therefore condition (5.6.3) holds for ⃗K as a consequence of (5.6.16). Moreover,
(5.6.1) and (5.6.2) with ⃗K0 = {Lj}j are also valid for this ⃗K, in view of assumptions
(5.6.14) and (5.6.15). The desired conclusion follows from Theorem 5.6.1.
□
If all the Wj’s are equal, we obtain the following corollary, which contains in
particular the inequality (5.5.16) mentioned earlier.
Corollary 5.6.3. Let W be an element of S ′(Rn) whose Fourier transform is a func-
tion bounded in absolute value by some B > 0. Suppose that W coincides with some
locally integrable function K on Rn \{0} that satisﬁes
|K(x)| ≤A|x|−n ,
x ̸= 0,
lim
εk→0

εk≤|x|≤1 K(x)dx = L,
and
sup
y∈Rn\{0}

|x|≥2|y| |K(x−y)−K(x)|dx ≤A.
(5.6.17)
Let T be the operator given by convolution with W. Then there exist constants
Cn,C′
n > 0 such that for all 1 < p,r < ∞we have that


∑
j
|T( f j)|r1
r 
L1,∞≤C′
n max(r,(r−1)−1)(A+B)


∑
j
| f j|r1
r 
L1 ,


∑
j
|T( f j)|r1
r 
Lp ≤Cnc(p,r)(A+B)


∑
j
| f j|r1
r 
Lp ,
where c(p,r) = max(p,(p−1)−1)max(r,(r−1)−1). In particular, these inequalities
are valid for the Hilbert transform and the Riesz transforms.
Interestingly enough, we can use the very statement of Theorem 5.6.1 to obtain
its corresponding vector-valued version.
Proposition 5.6.4. Let let 1 < p,r < ∞and let B1 and B2 be two Banach spaces.
Suppose that ⃗T given by (5.6.4) is a bounded linear operator from Lr(Rn,B1) to
Lr(Rn,B2) with norm B = B(r). Also assume that for all x ∈Rn \ {0}, ⃗K(x) is a

410
5 Singular Integrals of Convolution Type
bounded linear operator from B1 to B2 that satisﬁes conditions (5.6.1) , (5.6.2),
(5.6.3) for some A > 0 and ⃗K0 ∈L(B1,B2). Then there exist positive constants
Cn,C′
n such that for all B1-valued functions Fj we have


∑
j
⃗T(Fj)
r
B2
1
r 
L1,∞(Rn) ≤C′
n(A+B)


∑
j
Fj
r
B1
1
r 
L1(Rn),


∑
j
⃗T(Fj)
r
B2
1
r 
Lp(Rn) ≤Cn(A+B)c(p)


∑
j
Fj
r
B1
1
r 
Lp(Rn),
where c(p) = max(p,(p−1)−1).
Proof. Let us denote by ℓr(B1) the Banach space of all B1-valued sequences {uj}j
that satisfy
{uj}j

ℓr(B1) =
∑
j
uj
r
B1
1
r < ∞.
Now consider the operator ⃗S deﬁned on Lr(Rn,ℓr(B1)) by
⃗S({Fj}j) = {⃗T(Fj)}j .
It is obvious that ⃗S maps Lr(Rn,ℓr(B1)) to Lr(Rn,ℓr(B2)) with norm at most B.
Moreover, ⃗S has kernel #K(x) ∈L(ℓr(B1),ℓr(B2)) given by
#K(x)({uj}j) = {⃗K(x)(uj)}j,
where ⃗K is the kernel of ⃗T. It is not hard to verify that for x ∈Rn \{0} we have
 #K(x)

ℓr(B1)→ℓr(B2) =
⃗K(x)

B1→B2 ,
hence for x ̸= y ∈Rn we also have
 #K(x−y)−#K(x)

ℓr(B1)→ℓr(B2) =
⃗K(x−y)−⃗K(x)

B1→B2 .
Moreover, if we deﬁne B
K0 ∈L

ℓr(B1),ℓr(B2)

by
B
K0({uj}j) =
	⃗K0(y)(uj)

j .
for {uj}j ∈ℓr(B1), then we have
lim
k→∞

εk≤|y|≤1
#K(y)dy = B
K0,
in L

ℓr(B1),ℓr(B2)

.
We conclude that #K satisﬁes conditions (5.6.1) , (5.6.2), (5.6.3). Hence the oper-
ator ⃗S associate with #K satisﬁes the conclusion of Theorem 5.6.1, that is, the desired
inequalities for ⃗T.
□

5.6 Vector-Valued Singular Integrals
411
5.6.3 Vector-Valued Estimates for Maximal Functions
Next, we discuss applications of vector-valued inequalities to some nonlinear opera-
tors. We ﬁx an integrable function Φ on Rn and for t > 0 deﬁne Φt(x) =t−nΦ(t−1x).
We suppose that Φ satisﬁes the following regularity condition:
sup
y∈Rn\{0}

|x|≥2|y| sup
t>0
|Φt(x−y)−Φt(x)|dx = AΦ < ∞.
(5.6.18)
We consider the maximal operator
MΦ( f)(x) = sup
t>0
|( f ∗Φt)(x)|
deﬁned for f in L1 + L∞. We are interested in obtaining Lp estimates for MΦ. We
observe that the trivial estimate
MΦ( f)

L∞≤∥Φ∥L1∥f∥L∞
(5.6.19)
holds when p = ∞. It is natural to set
B1 = C
and
B2 = L∞(R+)
and view MΦ as the linear operator f →{f ∗Φδ}δ>0 that maps B1-valued functions
to B2-valued functions.
To do this precisely, for each x ∈Rn we deﬁne a bounded linear operator ⃗KΦ(x)
from B1 to B2 by setting for c ∈C
⃗KΦ(x)(c) = {c Φδ(x)}δ∈R+ .
Clearly we have
⃗KΦ(x)

C→L∞(R+) = sup
δ>0
|Φδ(x)|.
Now (5.6.18) implies condition (5.6.2) for the kernel ⃗KΦ. Also condition (5.6.1)
holds (for some A < depending on n) since
sup
δ>0
|Φδ(x)| ≤A|x|−n
and also condition (5.6.3) holds since for every δ > 0 we have
lim
ε→0

ε≤|y|≤1 Φδ(y)dy =

|y|≤1 Φδ(y)dy.
We also deﬁne a B2-valued linear operator acting on complex-valued functions
on Rn by
⃗MΦ( f) = f ∗⃗KΦ = {f ∗Φδ}δ∈R+ .
Obvisouly ⃗MΦ maps L∞(Rn,B1) to L∞(Rn,B2) with norm at most ∥Φ∥L1.

412
5 Singular Integrals of Convolution Type
Applying Theorem 5.6.1 with r = ∞we obtain for 1 < p < ∞,
⃗MΦ( f)

Lp(Rn,B2) ≤Cn max(p,(p−1)−1)

AΦ +∥Φ∥L1
f

Lp(Rn) ,
(5.6.20)
which can be immediately improved to
⃗MΦ( f)

Lr(Rn,B2) ≤Cn max(1,(r −1)−1)

AΦ +∥Φ∥L1
f

Lr(Rn)
(5.6.21)
via interpolation with estimate (5.6.19) for all 1 < r < ∞.
Next we use estimate (5.6.21) to obtain vector-valued estimates for the sublinear
operator MΦ.
Corollary 5.6.5. Let Φ be an integrable function on Rn that satisﬁes (5.6.18). Then
there exist dimensional constants Cn and C′
n such that for all 1 < p,r < ∞the fol-
lowing vector-valued inequalities are valid:


∑
j
|MΦ( f j)|r1
r 
L1,∞≤C′
nc(r)

AΦ+∥Φ∥L1


∑
j
| f j|r1
r 
L1 ,
(5.6.22)
where c(r) = 1+(r−1)−1, and


∑
j
|MΦ( f j)|r1
r 
Lp ≤Cnc(p,r)

AΦ+∥Φ∥L1


∑
j
| f j|r1
r 
Lp ,
(5.6.23)
where c(p,r) =

1+(r−1)−1
p+(p−1)−1
.
Proof. We set B1 = C and B2 = L∞(R+). We use estimate (5.6.21) as a start-
ing point in Proposition 5.6.4, which immediately yields the required conclusions
(5.6.22) and (5.6.23).
□
Similar estimates hold for the Hardy–Littlewood maximal operator.
Theorem 5.6.6. For 1 < p,r < ∞the Hardy–Littlewood maximal function M satis-
ﬁes the vector-valued inequalities


∑
j
|M( f j)|r1
r 
L1,∞≤C′
n

1+(r−1)−1

∑
j
| f j|r1
r 
L1 ,
(5.6.24)


∑
j
|M( f j)|r1
r 
Lp ≤Cn c(p,r)


∑
j
| f j|r1
r 
Lp ,
(5.6.25)
where c(p,r) =

1+(r−1)−1
p+(p−1)−1
.
Proof. Let us ﬁx a positive radial symmetrically decreasing Schwartz function Φ on
Rn that satisﬁes Φ(x) ≥1 when |x| ≤1. Then the Hardy–Littlewood maximal func-
tion M( f) is pointwise controlled by a constant multiple of the function MΦ(| f|).

5.6 Vector-Valued Singular Integrals
413
In view of Corollary 5.6.5, it sufﬁces to check that for such a Φ, (5.6.18) holds. First
observe that in view of the decreasing character of Φ, we have
sup
j
| f|∗Φ2 j ≤MΦ(| f|) ≤2n sup
j
| f|∗Φ2 j ,
and for this reason we choose to work with the easier dyadic maximal operator
Md
Φ( f) = sup
j
| f ∗Φ2 j|.
We observe the validity of the simple inequalties
2−n M( f) ≤M( f) ≤MΦ(| f|) ≤2nMd
Φ(| f|).
(5.6.26)
If we can show that
sup
y∈Rn\{0}

|x|≥2|y| sup
j∈Z
|Φ2 j(x−y)−Φ2 j(x)|dx = Cn < ∞,
(5.6.27)
then (5.6.22) and (5.6.23) are satisﬁed with Md
Φ replacing MΦ. We therefore turn
our attention to (5.6.27). We have

|x|≥2|y| sup
j∈Z
|Φ2 j(x−y)−Φ2 j(x)|dx
≤∑
j∈Z

|x|≥2|y| |Φ2 j(x−y)−Φ2 j(x)|dx
≤∑
2 j>|y|

|x|≥2|y|
|y||∇Φ
 x−θy
2 j

|
2(n+1) j
dx+ ∑
2 j≤|y|

|x|≥2|y|(|Φ2 j(x−y)|+|Φ2 j(x)|)dx
≤∑
2 j>|y|

|x|≥2|y|
|y|
2(n+1) j
CN dx
(1+|2−j(x−θy)|)N +2 ∑
2 j≤|y|

|x|≥|y| |Φ2 j(x)|dx
≤∑
2 j>|y|

|x|≥2|y|
|y|
2(n+1) j
CN
(1+|2−j−1x|)N dx+2 ∑
2 j≤|y|

|x|≥2−j|y| |Φ(x)|dx
≤∑
2 j>|y|

|x|≥2−j|y|
|y|
2j
CN
(1+|x|)N dx+2 ∑
2 j≤|y|
CN(2−j|y|)−N
≤CN ∑
2 j>|y|
|y|
2j +CN
≤3CN ,
where CN > 0 depends on N > n, θ ∈[0,1], and |x−θy| ≥|x|/2 when |x| ≥2|y|.
Now apply (5.6.22) and (5.6.23) to Md
Φ and use (5.6.26) to obtain the desired
vector-valued inequalities.
□

414
5 Singular Integrals of Convolution Type
Remark 5.6.7. Observe that (5.6.24) and (5.6.25) also hold for r = ∞. These end-
point estimates can be proved directly by observing that
sup
j
M( f j) ≤M(sup
j
| f j|).
The same is true for estimates (5.6.22) and (5.6.23). Finally, estimates (5.6.25) and
(5.6.23) also hold for p = ∞.
Exercises
5.6.1. (a) For all j ∈Z, let Ij be an interval in R and let Tj be the operator given
on the Fourier transform by multiplication by the characteristic function of Ij. Prove
that there exists a constant C > 0 such that for all 1 < p,r < ∞and for all square
integrable functions f j on R we have


∑
j
|Tj( f j)|r1
r 
Lp(R) ≤C max

r,
1
r−1

max

p,
1
p−1


∑
j
| f j|r1
r 
Lp(R),


∑
j
|Tj( f j)|r1
r 
L1,∞(R) ≤Cmax

r,
1
r−1


∑
j
| f j|r1
r 
L1(R) .
(b) Let Rj be arbitrary rectangles on Rn with sides parallel to the axes and let Sj be
the operators given on the Fourier transform by multiplication by the characteristic
functions of Rj. Prove that there exists a dimensional constant Cn < ∞such that for
all indices 1 < p,r < ∞and for all square integrable functions f j in Lp(Rn) we have


∑
j
|Sj( f j)|r1
r 
Lp(Rn)≤Cn max

r,
1
r−1
n
max

p,
1
p−1
n

∑
j
| f j|r1
r 
Lp(Rn) .

Hint: Part (a): Use Theorem 5.5.1 and the identity Tj = i
2

MaHM−a −MbHM−b
,
if Ij is χ(a,b), where Ma( f)(x) = f(x)e2πiax and H is the Hilbert transform. Part (b):
Apply the result in part (a) in each variable.

5.6.2. Let (T,dμ) be a σ-ﬁnite measure space. For every t ∈T, let R(t) be a rect-
angle in Rn with sides parallel to the axes such that the map t →R(t) is measurable.
Then there is a constant Cn > 0 such that for all 1 < p < ∞and for all families of
square integrable functions {ft}t∈T on Rn such that t →ft(x) is measurable for all
x ∈Rn we have


T |(1ftχR(t))∨|2 dμ(t)
1
2 
Lp ≤Cn max(p,(p−1)−1)n


T | ft|2 dμ(t)
1
2 
Lp,

5.6 Vector-Valued Singular Integrals
415

Hint: When n = 1 reduce matters to an Lp(L2(T,dμ),L2(T,dμ)) inequality for the
Hilbert transform, via the hint in the preceding exercise. Verify the inequality p = 2
and then use Theorem 5.6.1 for the other p’s. Obtain the n-dimensional inequality
by iterating the one-dimensional.

5.6.3. Let Φ be a function on Rn that satisﬁes supx∈Rn |x|n|Φ(x)| ≤A and

Rn |Φ(x−y)−Φ(x)|dx ≤η(y),

|x|≥R |Φ(x)|dx ≤η(R−1),
for all R ≥1, where η is a continuous increasing function on [0,2] that satisﬁes
η(0) = 0 and
 2
0
η(t)
t
dt < ∞.
(a) Prove that (5.6.27) holds.
(b) Show that if Φ lies in L1(Rn), then the maximal function f →supj∈Z | f ∗Φ2 j|
maps Lp(Rn) to itself for 1 < p ≤∞.

Hint: Part (a): Modify the calculation in the proof of Theorem 5.6.6. Part (b): Use
Theorem 5.6.1 with r = ∞.

5.6.4. (a) On R, take f j = χ[2 j−1,2 j] to prove that inequality (5.6.25) fails when p = ∞
and 1 < r < ∞.
(b) Again on R, take N > 2 and f j = χ[ j−1
N , j
N ] for j = 1,2,...,N to prove that (5.6.25)
fails when 1 < p < ∞and r = 1.
5.6.5. Let K be an integrable function on the real line and assume that the operator
f →f ∗K is bounded on Lp(R) for some 1 < p < ∞. Prove that the vector-valued
inequality


∑
j
|K ∗f j|q1
q 
Lp ≤Cp,q


∑
j
| f j|q1
q 
Lp
may fail in general when q < 1.

Hint: Take K = χ[−1,1] and f j = χ[ j−1
N , j
N ] for 1 ≤j ≤N.

5.6.6. Let {Qj}j be a countable collection of cubes in Rn with disjoint interiors.
Let cj be the center of the cube Qj and dj its diameter. For ε > 0, deﬁne the
Marcinkiewicz function associated with the family {Qj}j as follows:
Mε(x) = ∑
j
dn+ε
j
|x−cj|n+ε +dn+ε
j
.
Prove that for some constants Cn,ε,p and Cn,ε one has
Mε

Lp ≤Cn,ε,p

∑
j
|Qj|
 1
p ,
p >
n
n+ε ,
Mε

L
n
n+ε ,∞≤Cn,ε

∑
j
|Qj|
 n+ε
n ,
and consequently

Rn Mε(x)dx ≤Cn,ε ∑j |Qj|.

416
5 Singular Integrals of Convolution Type

Hint: Verify that
dn+ε
j
|x−cj|n+ε +dn+ε
j
≤CM(χQj)(x)
n+ε
n
and use Theorem 5.6.6.

HISTORICAL NOTES
The Lp boundedness of the conjugate function on the circle was announced in 1924 by Riesz
[292], but its ﬁrst proof appeared three years later in [294]. In view of the identiﬁcation of the
Hilbert transform with the conjugate function, the Lp boundedness of the Hilbert transform is also
attributed to M. Riesz. Riesz’s proof was ﬁrst given for p = 2k, k ∈Z+, via an argument similar to
that in the proof of Theorem 4.1.7. For p ̸= 2k this proof relied on interpolation and was completed
with the simultaneous publication of Riesz’s article on interpolation of bilinear forms [293]. The
weak type (1,1) property of the Hilbert transform is due to Kolmogorov [197]. Additional proofs
of the boundedness of the Hilbert transform have been obtained by Stein [350], Loomis [230], and
Calder´on [41]. The proof of Theorem 5.1.7, based on identity (5.1.23), is a reﬁnement of a proof
given by Cotlar [75].
The norm of the conjugate function on Lp(T1), and consequently that of the Hilbert transform
on Lp(R), was shown by Gohberg and Krupnik [129] to be cot(π/2p) when p is a power of 2. Du-
ality gives that this norm is tan(π/2p) for 1 < p ≤2 whenever p′ is a power of 2. Pichorides [282]
extended this result to all 1 < p < ∞by reﬁning Calder´on’s proof of Riesz’s theorem. This result
was also independently obtained by B. Cole (unpublished). The direct and simpliﬁed proof for the
Hilbert transform given in Exercise 5.1.12 is in Grafakos [130]. The norm of the operators 1
2(I±iH)
for real-valued functions was found to be 1
2

min(cos(π/2p),sin(π/2p))
−1 by Verbitsky [366] and
later independently by Ess´en [108]. The norm of the same operators for complex-valued functions
was shown to be equal to [sin(π/p)]−1 by Hollenbeck and Verbitsky [156]. Exact formulas for the
Lp norm, 1 ≤p < ∞of the Hilbert transform acting on a characteristic function were obtained by
Laeng [211]. The best constant in the weak type (1,1) estimate for the Hilbert transform is equal
to (1 + 1
32 + 1
52 + ···)(1 −1
32 + 1
52 −···)−1 as shown by Davis [91] using Brownian motion; an
alternative proof was later obtained by Baernstein [17]. Iwaniec and Martin [175] showed that the
norms of the Riesz transforms on Lp(Rn) coincide with that of the Hilbert transform on Lp(R) for
1 < p < ∞.
Operators of the kind TΩ as well as the stopping-time decomposition of Theorem 5.3.1 were
introduced by Calder´on and Zygmund [46]. In the same article, Calder´on and Zygmund used this
decomposition to prove Theorem 5.3.3 for operators of the form TΩ when Ω satisﬁes a certain
weak smoothness condition. The more general condition (5.3.12) ﬁrst appeared in H¨ormander’s
article [159]. A more ﬂexible condition sufﬁcient to yield weak type (1,1) bounds is contained
in the article of Duong and McIntosh [104]. Theorems 5.2.10 and 5.2.11 are also due to Calder´on
and Zygmund [48]. The latter article contains the method of rotations. Algebras of operators of the
form TΩ were studied in [49]. For more information on algebras of singular integrals see the article
of Calder´on [44]. Theorem 5.4.1 is due to Benedek, Calder´on, and Panzone [22], while Example
5.4.2 is taken from Muckenhoupt [259]. Theorem 5.4.5 is due to Riviere [296]. A weaker version
of this theorem, applicable for smoother singular integrals such as the maximal Hilbert transform,
was obtained by Cotlar [75] (Theorem 5.3.4). Improvements of the main inequality in Theorem
5.3.4 for homogeneous singular integrals were obtained by Mateu and Verdera [245] and Mateu,
Orobitg, and Verdera [244]. For a general overview of singular integrals and their applications, one
may consult the expository article of Calder´on [43].
Part (a) of Theorem 5.5.1 is due to Marcinkiewicz and Zygmund [242], although the case p = q
was proved earlier by Paley [273] with a larger constant. The values of r for which a general linear
operator of weak or strong type (p,q) admits bounded ℓr extensions are described in Rubio de
Francia and Torrea [304]. The Lp and weak Lp spaces in Theorem 5.5.1 can be replaced by general
Banach lattices, as shown by Krivine [206] using Grothendieck’s inequality. Hilbert-space-valued

5.6 Vector-Valued Singular Integrals
417
estimates for singular integrals were obtained by Benedek, Calder´on, and Panzone [22]. Other
operator-valued singular integral operators were studied by Rubio de Francia, Ruiz, and Torrea
[303]. Banach-valued singular integrals are studied in great detail in the book of Garc´ıa-Cuerva
and Rubio de Francia [122], which provides an excellent presentation of the subject. The ℓr-valued
estimates (5.5.16) for the Hilbert transform were ﬁrst obtained by Boas and Bochner [28]. The
corresponding vector-valued estimates for the Hardy–Littlewood maximal function in Theorem
5.6.6 are due to Fefferman and Stein [115]. Conditions of the form (5.6.18) have been applied to
several situations and can be traced in Zo [386].
The sharpness of the logarithmic condition (5.2.24) was indicated by Weiss and Zygmund [372],
who constructed an example of an integrable function Ω with vanishing integral on S1 satisfying

Sn−1 |Ω(θ)|log+ |Ω(θ)|

log(2 + log(2 + |Ω(θ)|))
−δ dθ = ∞for all δ > 0 and of a continuous
function in Lp(R2) for all 1 < p < ∞such that limsupε→0 |T (ε)
Ω ( f)(x)| = ∞for almost all x ∈R2.
The proofs of Theorems 5.2.10 and 5.2.11 can be modiﬁed to give that if Ω is in the Hardy space
H1 of Sn−1, then TΩ and T (∗)
Ω
map Lp to Lp for 1 < p < ∞. For TΩ this fact was proved by Connett
[72] and independently by Ricci and Weiss [289]; for T (∗)
Ω
this was proved by Fan and Pan [110]
and independently by Grafakos and Stefanov [139]. The latter authors [138] also obtained that the
logarithmic condition ess.sup|ξ|=1

Sn−1 |Ω(θ)|(log
1
|ξ·θ||)1+α dθ < ∞, α > 0, implies Lp bounded-
ness for TΩ and T (∗)
Ω
for some p ̸= 2. See also Fan, Guo, and Pan [109] as well as Ryabogin and
Rubin [308] for extensions. Examples of functions Ω for which TΩ maps Lp to Lp for a certain
range of p’s but not for other ranges of p’s is given in Grafakos, Honz´ık, and Ryabogin [132]. A
different example of this sort was provided later by Honz´ık [158]; the range of p’s for which bound-
edness holds are different for these examples. Honz´ık [157] also constructed a delicate example of
an integrable function Ω with mean value zero over S1 such that TΩ is bounded on L2(R) but T (∗)
Ω
is not.
The relatively weak condition |Ω|log+ |Ω| ∈L1(Sn−1) also implies weak type (1,1) bound-
edness for operators TΩ. This was obtained by Seeger [317] and later extended by Tao [355] to
situations in which there is no Fourier transform structure. Earlier partial results are in Christ and
Rubio de Francia [63] and in the simultaneous work of Hofmann [155], both inspired by the work
of Christ [60]. Soria and Sj¨ogren [324] showed that for arbitrary Ω in L1(Sn−1), TΩ is weak type
(1,1) when restricted to radial functions. Examples due to Christ (published in [139]) indicate
that even for bounded functions Ω on Sn−1, TΩ may not map the endpoint Hardy space H1(Rn) to
L1(Rn). However, Seeger and Tao [318] have showed that TΩ always maps the Hardy space H1(Rn)
to the Lorentz space L1,2(Rn) when |Ω|(log+ |Ω|)2 is integrable over Sn−1. This result is sharp in
the sense that for such Ω, TΩ may not map H1(Rn) to L1,q(Rn) when q < 2 in general. If TΩ maps
H1(Rn) to itself, Daly and Phillips [87] (in dimension n = 2) and Daly [86] (in dimensions n ≥3)
showed that Ω must lie in the Hardy space H1(Sn−1). There are also results concerning the singu-
lar maximal operator MΩ( f)(x) = supr>0
1
vnrn

|y|≤r | f(x −y)||Ω(y)|dy, where Ω is an integrable
function on Sn−1 of not necessarily vanishing integral. Such operators were studied by Fefferman
[116], Christ [60], and Hudson [162]. An excellent treatment of several kinds of singular integral
operators with rough kernels is contained in the book of Lu, Ding, and Yan [234].

Chapter 6
Littlewood–Paley Theory and Multipliers
In this chapter we are concerned with orthogonality properties of the Fourier trans-
form. This orthogonality is easily understood on L2, but at this point it is not clear
how it manifests itself on other spaces. Square functions introduce a way to express
and quantify orthogonality of the Fourier transform on Lp and other function spaces.
The introduction of square functions in this setting was pioneered by Littlewood and
Paley, and the theory that subsequently developed is named after them. The extent
to which Littlewood–Paley theory characterizes function spaces is remarkable.
Historically, Littlewood–Paley theory ﬁrst appeared in the context of one-dimen-
sional Fourier series and depended on complex function theory. With the develop-
ment of real-variable methods, the whole theory became independent of complex
methods and was extended to Rn. This is the approach that we follow in this chapter.
It turns out that the Littlewood–Paley theory is intimately related to the Calder´on–
Zygmund theory introduced in the previous chapter. This connection is deep and
far-reaching, and its central feature is that one is able to derive the main results of
one theory from the other.
The thrust and power of the Littlewood–Paley theory become apparent in some of
the applications we discuss in this chapter. Such applications include the derivation
of certain multiplier theorems, that is, theorems that yield sufﬁcient conditions for
bounded functions to be Lp multipliers. As a consequence of Littlewood–Paley the-
ory we also prove that the lacunary partial Fourier integrals

|ξ|≤2N 1f(ξ)e2πix·ξ dξ
converge almost everywhere to an Lp function f on Rn.
6.1 Littlewood–Paley Theory
We begin by examining more closely what we mean by orthogonality of the Fourier
transform. If the functions f j deﬁned on Rn have Fourier transforms 1f j supported in
disjoint sets, then they are orthogonal in the sense that
L. Grafakos, Classical Fourier Analysis, Graduate Texts in Mathematics 249,
DOI 10.1007/978-1-4939-1194-3 6, © Springer Science+Business Media New York 2014
419

420
6 Littlewood–Paley Theory and Multipliers
∑
j
f j
2
L2 = ∑
j
 f j
2
L2.
(6.1.1)
Unfortunately, when 2 is replaced by some p ̸= 2 in (6.1.1), the previous quanti-
ties may not even be comparable, as we show in Examples 6.1.8 and 6.1.9. The
Littlewood–Paley theorem provides a substitute inequality to (6.1.1) expressing the
fact that certain orthogonality considerations are also valid in Lp(Rn).
6.1.1 The Littlewood–Paley Theorem
The orthogonality we are searching for is best seen in the context of one-dimensional
Fourier series (which was the setting in which Littlewood and Paley formulated
their result). The primary observation is that the exponential e2πi2kx oscillates half
as much as e2πi2k+1x and is therefore nearly constant in each period of the latter.
This observation was instrumental in the proof of Theorem 3.6.4, which implied in
particular that for all 1 < p < ∞we have

N
∑
k=1
ake2πi2kx
Lp[0,1] ≈
 N
∑
k=1
|ak|2 1
2 .
(6.1.2)
In other words, we can calculate the Lp norm of ∑N
k=1 ake2πi2kx in almost a pre-
cise fashion to obtain (modulo multiplicative constants) the same answer as in the
L2 case. Similar calculations are valid for more general blocks of exponentials in
the dyadic range {2k + 1,...,2k+1 −1}, since the exponentials in each such block
behave independently from those in each previous block. In particular, the Lp inte-
grability of a function on T1 is not affected by the randomization of the sign of its
Fourier coefﬁcients in the previous dyadic blocks. This is the intuition behind the
Littlewood–Paley theorem.
Motivated by this discussion, we introduce the Littlewood–Paley operators in the
continuous setting.
Deﬁnition 6.1.1. Let Ψ be an integrable function on Rn and j ∈Z. We deﬁne the
Littlewood–Paley operator Δ j associated with Ψ by
Δ j( f) = f ∗Ψ2−j,
where Ψ2−j(x) = 2jnΨ(2jx) for all x in Rn. Thus we have 3
Ψ2−j(ξ) = 1
Ψ(2−jξ) for
all ξ in Rn. We note that whenever Ψ is a Schwartz function and f is a tempered
distribution, the quantity Δ j( f) is a well deﬁned function.
These operators depend on the choice of the function Ψ; in most applications
we choose Ψ to be a smooth function with compactly supported Fourier transform.
Observe that if 1
Ψ is supported in some annulus 0 < c1 < |ξ| < c2 < ∞, then the
Fourier transform of Δ j is supported in the annulus c12j < |ξ| < c22j; in other

6.1 Littlewood–Paley Theory
421
words, it is localized near the frequency |ξ| ≈2j. Thus the purpose of Δ j is to
isolate the part of frequency of a function concentrated near |ξ| ≈2j.
The square function associated with the Littlewood–Paley operators Δ j is
deﬁned by
f →

∑
j∈Z
|Δ j( f)|2 1
2 .
This quadratic expression captures the intrinsic orthogonality of the function f.
Theorem 6.1.2. (Littlewood–Paley theorem) Suppose that Ψ is an integrable C 1
function on Rn with mean value zero that satisﬁes
|Ψ(x)|+|∇Ψ(x)| ≤B(1+|x|)−n−1 .
(6.1.3)
Then there exists a constant Cn < ∞such that for all 1 < p < ∞and all f in Lp(Rn)
we have


∑
j∈Z
|Δ j( f)|2 1
2 
Lp(Rn) ≤CnBmax

p,(p−1)−1 f

Lp(Rn).
(6.1.4)
There also exists a C′
n < ∞such that for all f in L1(Rn) we have


∑
j∈Z
|Δ j( f)|2 1
2 
L1,∞(Rn) ≤C′
nB
 f

L1(Rn).
(6.1.5)
Conversely, let Ψ be a Schwartz function such that either 1
Ψ(0) = 0 and
∑
j∈Z
| 1
Ψ(2−jξ)|2 = 1,
for all ξ ∈Rn \{0},
(6.1.6)
or 1
Ψ is compactly supported away from the origin and
∑
j∈Z
1
Ψ(2−jξ) = 1,
for all ξ ∈Rn \{0}.
(6.1.7)
Then there is a constant Cn,Ψ, such that for any f ∈S ′(Rn) with

∑j∈Z |Δ j( f)|2 1
2
in Lp(Rn) for some 1 < p < ∞, there exists a unique polynomial Q such that the
tempered distribution f −Q coincides with an Lp function, and we have
f −Q

Lp(Rn) ≤Cn,Ψ Bmax

p,(p−1)−1

∑
j∈Z
|Δ j( f)|2 1
2 
Lp(Rn) .
(6.1.8)
Consequently, if g lies in Lp(Rn) for some 1 < p < ∞, then
g∥Lp(Rn) ≈


∑
j∈Z
|Δ j(g)|2 1
2 
Lp(Rn) .

422
6 Littlewood–Paley Theory and Multipliers
Proof. We ﬁrst prove (6.1.4) when p = 2. Using Plancherel’s theorem, we see that
(6.1.4) is a consequence of the inequality
∑
j
| 1
Ψ(2−jξ)|2 ≤CnB2
(6.1.9)
for some Cn < ∞. Because of (6.1.3), Fourier inversion holds for Ψ. Furthermore, Ψ
has mean value zero and we may write
1
Ψ(ξ) =

Rn e−2πix·ξΨ(x)dx =

Rn(e−2πix·ξ −1)Ψ(x)dx,
(6.1.10)
from which we obtain the estimate
| 1
Ψ(ξ)| ≤
"
4π|ξ|

Rn |x|
1
2 |Ψ(x)|dx ≤CnB|ξ|
1
2 .
(6.1.11)
For ξ = (ξ1,...,ξn) ̸= 0, let j be such that |ξ j| ≥|ξk| for all k ∈{1,...,n}. Integrate
by parts with respect to ∂j in (6.1.10) to obtain
1
Ψ(ξ) = −

Rn(−2πiξ j)−1e−2πix·ξ(∂jΨ)(x)dx,
from which we deduce the estimate
| 1
Ψ(ξ)| ≤√n|ξ|−1

Rn |∇Ψ(x)|dx ≤CnB|ξ|−1.
(6.1.12)
We now break the sum in (6.1.9) into the parts where 2−j|ξ| ≤1 and 2−j|ξ| ≥1
and use (6.1.11) and (6.1.12), respectively, to obtain (6.1.9). (See also Exercise 6.1.2.)
This proves (6.1.4) when p = 2.
We now turn our attention to the case p ̸= 2 in (6.1.4). We view (6.1.4) and (6.1.5)
as vector-valued inequalities in the spirit of Section 5.5. Deﬁne an operator ⃗T acting
on functions on Rn as follows:
⃗T( f)(x) = {Δ j( f)(x)}j .
The inequalities (6.1.4) and (6.1.5) we wish to prove say simply that ⃗T is a bounded
operator from Lp(Rn,C) to Lp(Rn,ℓ2) and from L1(Rn,C) to L1,∞(Rn,ℓ2). We just
proved that this statement is true when p = 2, and therefore the ﬁrst hypothesis of
Theorem 5.6.1 is satisﬁed. We observe that the operator ⃗T can be written in the form
⃗T( f)(x) =
$
RnΨ2−j(x−y) f(y)dy
%
j
=

Rn ⃗K(x−y)( f(y))dy,
where for each x ∈Rn, ⃗K(x) is a bounded linear operator from C to ℓ2 given by
⃗K(x)(a) = {Ψ2−j(x)a}j.
(6.1.13)

6.1 Littlewood–Paley Theory
423
We clearly have that ∥⃗K(x)∥C→ℓ2 =

∑j |Ψ2−j(x)|2 1
2 , and to be able to apply
Theorem 5.6.1 we need to know that for some constant Cn we have
⃗K(x)

C→ℓ2 ≤Cn B|x|−n ,
(6.1.14)
lim
ε↓0

ε≤|y|≤1
⃗K(y)dy =
$ 1
0 Ψ2 j(y)dy
%
j∈Z
,
(6.1.15)
sup
y̸=0

|x|≥2|y|
⃗K(x−y)−⃗K(x)

C→ℓ2 dx ≤CnB.
(6.1.16)
Of these, (6.1.14) is easily obtained using (6.1.3), (6.1.15) i.e. trivial, and so we focus
on (6.1.16). Since Ψ is a C 1 function, for |x| ≥2|y| we have
|Ψ2−j(x−y)−Ψ2−j(x)|
≤2(n+1) j|∇Ψ(2j(x−θy))||y|
for some θ ∈[0,1],
≤B2(n+1) j
1+2j|x−θy|
−(n+1)|y|
≤B2n j
1+2j−1|x|
−(n+1)2j|y|
since |x−θy| ≥1
2|x|.
(6.1.17)
We also have that
|Ψ2−j(x−y)−Ψ2−j(x)|
≤2n j|Ψ(2j(x−y))|+2jn|Ψ(2jx)|
≤B2n j
1+2j|x|
−(n+1) +B2jn
1+2j−1|x|
−(n+1)
≤2B2n j
1+2j−1|x|
−(n+1).
(6.1.18)
Taking the geometric mean of (6.1.17) and (6.1.18), we obtain for any γ ∈[0,1]
|Ψ2−j(x−y)−Ψ2−j(x)| ≤21−γ B2n j(2j|y|)γ
1+2j−1|x|
−(n+1) .
(6.1.19)
Using this estimate, when |x| ≥2|y|, we obtain
⃗K(x−y)−⃗K(x)

C→ℓ2 =

∑
j∈Z
Ψ2−j(x−y)−Ψ2−j(x)
2
1/2
≤∑
j∈Z
Ψ2−j(x−y)−Ψ2−j(x)

≤2B

|y| ∑
2 j< 2
|x|
2(n+1) j +|y|
1
2 ∑
2 j≥2
|x|
2(n+ 1
2 ) j(2j−1|x|)−(n+1)
≤CnB

|y||x|−n−1 +|y|
1
2 |x|−n−1
2 
,
where we used (6.1.19) with γ = 1 in the ﬁrst sum and (6.1.19) with γ = 1/2 in
the second sum. Using this bound, we easily deduce (6.1.16) by integrating over the

424
6 Littlewood–Paley Theory and Multipliers
region |x| ≥2|y|. Finally, using Theorem 5.6.1 we conclude the proofs of (6.1.4) and
(6.1.5), which establishes one direction of the theorem.
We now turn to the converse direction. Let Δ ∗
j be the adjoint operator of Δ j
given by 3
Δ ∗
j f = 1f 3
Ψ2−j. Let f be in S ′(Rn). Then the series ∑j∈Z Δ ∗
j Δ j( f) con-
verges in S ′(Rn). To see this, it sufﬁces to show that the sequence of partial sums
uN = ∑| j|<N Δ ∗
j Δ j( f) converges in S ′. This means that if we test this sequence
against a Schwartz function g, then it is a Cauchy sequence and hence it converges as
N →∞. But an easy argument using duality and the Cauchy–Schwarz and H¨older’s
inequalities shows that for M > N we have
|⟨uN,g⟩−⟨uM,g⟩| ≤


∑
j
|Δ j( f)|2 1
2

Lp


∑
N≤| j|≤M
|Δ j(g)|2 1
2 
Lp′ ,
and this can be made small by picking M > N ≥N0(g). Since the sequence ⟨uN,g⟩is
Cauchy, it converges to some Λ(g). Now it remains to show that the map g →Λ(g)
is a tempered distribution. Obviously Λ(g) is a linear functional. Also,
|Λ(g)| ≤


∑
j
|Δ j( f)|2 1
2

Lp


∑
j
|Δ j(g)|2 1
2 
Lp′
≤Cp′


∑
j
|Δ j( f)|2 1
2

Lp
g

Lp′ ,
and since ∥g∥Lp′ is controlled by a ﬁnite number of Schwartz seminorms of g, it
follows that Λ is in S ′. The distribution Λ is the limit of the series ∑j Δ ∗
j Δ j.
Under hypothesis (6.1.6), the Fourier transform of the tempered distribution f −
∑j∈Z Δ ∗
j Δ j( f) is supported at the origin. This implies that there exists a polynomial
Q such that f −Q = ∑j∈Z Δ ∗
j Δ j( f). Now let g be a Schwartz function. We have
4
f −Q, g
5 =
4 ∑
j∈Z
Δ ∗
j Δ j( f),g
5
=
 ∑
j∈Z
4
Δ ∗
j Δ j( f),g
5
=
 ∑
j∈Z
4
Δ j( f),Δ j(g)
5
=


Rn ∑
j∈Z
Δ j( f) Δ j(g)dx

≤

Rn

∑
j∈Z
|Δ j( f)|2 1
2 
∑
j∈Z
|Δ j(g)|2 1
2 dx
≤


∑
j∈Z
|Δ j( f)|2 1
2 
Lp


∑
j∈Z
|Δ j(g)|2 1
2 
Lp′

6.1 Littlewood–Paley Theory
425
≤


∑
j∈Z
|Δ j( f)|2 1
2 
LpCnBmax

p′,(p′ −1)−1g

Lp′ ,
(6.1.20)
having used the deﬁnition of the adjoint (Section 2.5.2), the Cauchy–Schwarz in-
equality, H¨older’s inequality, and (6.1.4). Taking the supremum over all g in Lp′
with norm at most one, we obtain that the tempered distribution f −Q is a bounded
linear functional on Lp′. By the Riesz representation theorem, f −Q coincides with
an Lp function whose norm satisﬁes the estimate
f −Q

Lp ≤CnBmax

p,(p−1)−1

∑
j∈Z
|Δ j( f)|2 1
2 
Lp .
We now show uniqueness. If Q1 is another polynomial, with f −Q1 ∈Lp, then
Q −Q1 must be an Lp function; but the only polynomial that lies in Lp is the zero
polynomial. This completes the proof of the converse of the theorem under hypoth-
esis (6.1.6).
To obtain the same conclusion under the hypothesis (6.1.7) we argue in a similar
way but we leave the details as an exercise. (One may adapt the argument in the
proof of Corollary 6.1.7 to this setting.)
□
Remark 6.1.3. We make some observations. If 1
Ψ is real-valued, then the operators
Δ j are self-adjoint. Indeed,

Rn Δ j( f)gdx =

Rn
1f 3
Ψ2−j 1gdξ =

Rn
1f 3
Ψ2−j 1gdξ =

Rn f Δ j(g)dx.
Moreover, if Ψ is a radial function, we see that the operators Δ j are self-transpose,
that is, they satisfy

Rn Δ j( f)gdx =

Rn f Δ j(g)dx.
Assume now that Ψ is both radial and has a real-valued Fourier transform. Suppose
also that Ψ satisﬁes (6.1.3) and that it has mean value zero. Then the inequality
 ∑
j∈Z
Δ j( f j)

Lp ≤CnBmax

p,(p−1)−1

∑
j∈Z
| f j|21
2 
Lp
(6.1.21)
is true for sequences of functions {f j}j. To see this we use duality. Let
⃗T( f) = {Δ j( f)}j .
Then
⃗T ∗({gj}j) = ∑
j
Δ j(gj).
Inequality (6.1.4) says that the operator ⃗T maps Lp(Rn,C) to Lp(Rn,ℓ2), and its dual
statement is that ⃗T ∗maps Lp′(Rn,ℓ2) to Lp′(Rn,C). This is exactly the statement in
(6.1.21) if p is replaced by p′. Since p is any number in (1,∞), (6.1.21) is proved.

426
6 Littlewood–Paley Theory and Multipliers
6.1.2 Vector-Valued Analogues
We now obtain a vector-valued extension of Theorem 6.1.2. We have the following.
Proposition 6.1.4. Let Ψ be an integrable C 1 function on Rn with mean value zero
that satisﬁes (6.1.3) and let Δ j be the Littlewood–Paley operator associated with Ψ.
Then there exists a constant Cn < ∞such that for all 1 < p,r < ∞and all sequences
of Lp functions f j we have


∑
j∈Z

∑
k∈Z
|Δk( f j)|2r
2 1
r 
Lp(Rn) ≤CnB #Cp,r


∑
j∈Z
| f j|r1
r 
Lp(Rn) ,
where #Cp,r = max(p,(p −1)−1)max(r,(r −1)−1). Moreover, for some C′
n > 0 and
all sequences of L1 functions f j we have


∑
j∈Z

∑
k∈Z
|Δk( f j)|2r
2 1
r 
L1,∞(Rn) ≤C′
nBmax(r,(r −1)−1)


∑
j∈Z
| f j|r1
r 
L1(Rn) .
In particular,


∑
j∈Z
|Δ j( f j)|r1
r 
Lp(Rn) ≤CnB #Cp,r


∑
j∈Z
| f j|r1
r 
Lp(Rn) .
(6.1.22)
Proof. We introduce Banach spaces B1 = C and B2 = ℓ2 and for f ∈Lp(Rn) deﬁne
an operator
⃗T( f) = {Δk( f)}k∈Z .
In the proof of Theorem 6.1.2 we showed that ⃗T has a kernel ⃗K that satisﬁes con-
dition (6.1.16). Furthermore, ⃗T obviously maps Lr(Rn,C) to Lr(Rn,ℓr). Applying
Proposition 5.6.4, we obtain the ﬁrst two statements of the proposition. Restricting
to k = j yields (6.1.22).
□
6.1.3 Lp Estimates for Square Functions Associated with Dyadic
Sums
Let us pick a Schwartz function Ψ whose Fourier transform is compactly supported
in the annulus 2−1 ≤|ξ| ≤22 such that (6.1.6) is satisﬁed. (Clearly (6.1.6) has no
chance of being satisﬁed if 1
Ψ is supported only in the annulus 1 ≤|ξ| ≤2.) The
Littlewood–Paley operation f →Δ j( f) represents the smoothly truncated frequency
localization of a function f near the dyadic annulus |ξ| ≈2j. Theorem 6.1.2 says that
the square function formed by these localizations has Lp norm comparable to that of
the original function. In other words, this square function characterizes the Lp norm
of a function. This is the main feature of Littlewood–Paley theory.

6.1 Littlewood–Paley Theory
427
One may ask whether Theorem 6.1.2 still holds if the Littlewood–Paley operators
Δ j are replaced by their nonsmooth versions
f →

χ2 j≤|ξ|<2 j+1 1f(ξ)
∨(x).
(6.1.23)
This question has a surprising answer that already signals that there may be some
fundamental differences between one-dimensional and higher-dimensional Fourier
analysis. The square function formed by the operators in (6.1.23) can be used to
characterize Lp(R) in the same way Δ j did, but not Lp(Rn) when n > 1 and p ̸= 2.
The problem lies in the fact that the characteristic function of the unit disk is not
an Lp multiplier on Rn when n ≥2 unless p = 2; see Section 5.1 in [131]. The
one-dimensional result we alluded to earlier is the following.
For j ∈Z we introduce the one-dimensional operator
Δ #
j ( f)(x) = ( 1f χIj)∨(x),
(6.1.24)
where
Ij = [2j,2j+1)∪(−2j+1,−2j],
and Δ #
j is a version of the operator Δ j in which the characteristic function of the set
2j ≤|ξ| < 2j+1 replaces the function 1
Ψ(2−jξ).
Theorem 6.1.5. There exists a constant C1 such that for all 1 < p < ∞and all f in
Lp(R) we have
f

Lp(Rn)
C1(p+
1
p−1)2 ≤


∑
j∈Z
|Δ #
j ( f)|21
2 
Lp(Rn) ≤C1(p+
1
p−1)2f

Lp(Rn).
(6.1.25)
Proof. Pick a Schwartz function ψ on the line whose Fourier transform is supported
in the set 2−1 ≤|ξ| ≤22 and is equal to 1 on the set 1 ≤|ξ| ≤2. Let Δ j be the
Littlewood–Paley operator associated with ψ. Observe that Δ jΔ #
j = Δ #
j Δ j = Δ #
j ,
since 1ψ is equal to one on the support of Δ #
j ( f)1. We now use Exercise 5.6.1(a) to
obtain


∑
j∈Z
|Δ #
j ( f)|21
2 
Lp =


∑
j∈Z
|Δ #
j Δ j( f)|21
2 
Lp
≤Cmax(p,(p−1)−1)


∑
j∈Z
|Δ j( f)|21
2 
Lp
≤CBmax(p,(p−1)−1)2f

Lp ,
where the last inequality follows from Theorem 6.1.2. The reverse inequality for
1 < p < ∞follows just like the reverse inequality (6.1.8) of Theorem 6.1.2 by simply
replacing the Δ j’s by the Δ #
j ’s and setting the polynomial Q equal to zero. (There is
no need to use the Riesz representation theorem here, just the fact that the Lp norm

428
6 Littlewood–Paley Theory and Multipliers
of f can be realized as the supremum of expressions |⟨f,g⟩| where g has Lp′ norm
at most 1.)
□
There is a higher-dimensional version of Theorem 6.1.5 with dyadic rectan-
gles replacing the dyadic intervals. As has already been pointed out, the higher-
dimensional version with dyadic annuli replacing the dyadic intervals is false.
Let us introduce some notation. For j ∈Z, we denote by Ij the dyadic set
[2j,2j+1)(−2j+1,−2j] as in the statement of Theorem 6.1.5. For j1,..., jn ∈Z
deﬁne a dyadic rectangle
Rj1,..., jn = Ij1 ×···×Ijn
in Rn. Actually Rj1,..., jn is not a rectangle but a union of 2n rectangles; with some
abuse of language we still call it a rectangle. For notational convenience we write
Rj = Rj1,..., jn ,
where j = ( j1,..., jn) ∈Zn.
Observe that for different j,j′ ∈Zn the rectangles Rj and Rj′ have disjoint interiors
and that the union of all the Rj’s is equal to Rn \{0}. In other words, the family of
Rj’s, where j ∈Zn, forms a tiling of Rn, which we call the dyadic decomposition of
Rn. We now introduce operators
Δ #
j ( f)(x) = ( 1f χRj)∨(x),
(6.1.26)
and we have the following n-dimensional extension of Theorem 6.1.5.
Theorem 6.1.6. For a Schwartz function ψ on the line with integral zero we deﬁne
the operator
Δj( f)(x) =
 1ψ(2−j1ξ1)··· 1ψ(2−jnξn) 1f(ξ)
∨(x),
(6.1.27)
where j = ( j1,..., jn) ∈Zn. Then there is a dimensional constant Cn such that


∑
j∈Zn
|Δj( f)|21
2 
Lp(Rn) ≤Cn(p+(p−1)−1)n f

Lp(Rn) .
(6.1.28)
Let Δ #
j be the operators deﬁned in (6.1.26). Then there exists a positive constant Cn
such that for all 1 < p < ∞and all f ∈Lp(Rn) we have
f

Lp(Rn)
Cn(p+
1
p−1)2n ≤


∑
j∈Zn
|Δ #
j ( f)|21
2 
Lp(Rn) ≤Cn(p+
1
p−1)2n f

Lp(Rn). (6.1.29)
Proof. We ﬁrst prove (6.1.28). Note that if j = ( j1,..., jn) ∈Zn, then the operator
Δj is equal to
Δj( f) = Δ ( j1)
j1
···Δ ( jn)
jn ( f),

6.1 Littlewood–Paley Theory
429
where the Δ ( jr)
jr
are one-dimensional operators given on the Fourier transform
by multiplication by 1ψ(2−jrξr), with the remaining variables ﬁxed. Inequality in
(6.1.28) is a consequence of the one-dimensional case. For instance, we discuss the
case n = 2. Using Proposition 6.1.4, we obtain


∑
j∈Z2
|Δj( f)|21
2 
p
Lp(R2)
=

R

R

∑
j1∈Z ∑
j2∈Z
|Δ (1)
j1 Δ (2)
j2 ( f)(x1,x2)|2p
2 dx1

dx2
≤Cp max(p,(p−1)−1)p

R

R

∑
j2∈Z
|Δ (2)
j2 ( f)(x1,x2)|2p
2 dx1

dx2
= Cp max(p,(p−1)−1)p

R

R

∑
j2∈Z
|Δ (2)
j2 ( f)(x1,x2)|2p
2 dx2

dx1
≤C2p max(p,(p−1)−1)2p

R

R | f(x1,x2)|p dx2

dx1
= C2p max(p,(p−1)−1)2pf
p
Lp(R2) ,
where we also used Theorem 6.1.2 in the calculation. Higher-dimensional versions
of this estimate may easily be obtained by induction.
We now turn to the upper inequality in (6.1.29). We pick a Schwartz function ψ
whose Fourier transform is supported in the union [−4,−1/2][1/2,4] and is equal
to 1 on [−2,−1][1,2]. Then we clearly have
Δ #
j = Δ #
j Δj ,
since 1ψ(2−j1ξ1)··· 1ψ(2−jnξn) is equal to 1 on the rectangle Rj. We now use Exercise
5.6.1(b) and estimate (6.1.28) to obtain


∑
j∈Zn
|Δ #
j ( f)|21
2 
Lp =


∑
j∈Zn
|Δ #
j Δj( f)|21
2 
Lp
≤Cmax(p,(p−1)−1)n

∑
j∈Zn
|Δj( f)|21
2 
Lp
≤CBmax(p,(p−1)−1)2n f

Lp .
The lower inequality in (6.1.29) for 1 < p < ∞is proved like inequality (6.1.8) in
Theorem 6.1.2. The fundamental ingredient in the proof is that f = ∑j∈Zn Δ #
j Δ #
j ( f)
for all Schwartz functions f, where the sum is interpreted as the L2-limit of the se-
quence of partial sums. Thus the series converges in S ′, and pairing with a Schwartz
function g, we obtain the lower inequality in (6.1.29) for Schwartz functions, by
applying the steps that prove (6.1.20) (with Q = 0). To prove the lower inequality

430
6 Littlewood–Paley Theory and Multipliers
in (6.1.29) for a general function f ∈Lp(Rn) we approximate an Lp function by a
sequence of Schwartz functions in the Lp norm. Then both sides of the lower in-
equality in (6.1.29) for the approximating sequence converge to the corresponding
sides of the lower inequality in (6.1.29) for f; the convergence of the sequence of
Lp norms of the square functions requires the upper inequality in (6.1.29) that was
previously established. This concludes the proof of the theorem.
□
Next we observe that if the Schwartz function ψ is suitably chosen, then the
reverse inequality in estimate (6.1.28) also holds. More precisely, suppose 1ψ(ξ) is
an even smooth real-valued function supported in the set
9
10 ≤|ξ| ≤21
10 in R that
satisﬁes
∑
j∈Z
1ψ(2−jξ) = 1,
ξ ∈R\{0};
(6.1.30)
then we have the following.
Corollary 6.1.7. Suppose that ψ satisﬁes (6.1.30) and let Δj be as in (6.1.27). Let f
be an Lp function on Rn such that the function

∑j∈Zn |Δj( f)|21
2 is in Lp(Rn). Then
there is a constant Cn that depends only on the dimension and ψ such that the lower
estimate
f

Lp
Cn(p+
1
p−1)n ≤


∑
j∈Zn
|Δj( f)|21
2 
Lp
(6.1.31)
holds.
Proof. If we had ∑j∈Z | 1ψ(2−jξ)|2 = 1 instead of (6.1.30), then we could apply the
method used in the lower estimate of Theorem 6.1.2 to obtain the required conclu-
sion. In this case we provide another argument that is very similar in spirit.
We ﬁrst prove (6.1.31) for Schwartz functions f. Then the series ∑j∈Zn Δj( f)
converges in L2 (and hence in S ′) to f. Now let g be another Schwartz function. We
express the inner product
4
f,g
5
as the action of the distribution ∑j∈Zn Δj( f) on the
test function g:
4
f,g
5 =

4 ∑
j∈Zn
Δj( f),g
5
=
 ∑
j∈Zn
4
Δj( f),g
5
=
 ∑
j∈Zn
∑
k=(k1,...,kn)∈Zn
∃r |kr−jr|≤1}
4
Δj( f),Δk(g)
5
≤

Rn ∑
j∈Zn
∑
k=(k1,...,kn)∈Zn
∃r |kr−jr|≤1}
Δj( f)
Δk(g)
dx
≤3n

Rn

∑
j∈Zn
Δj( f)
2 1
2 
∑
k∈Zn
Δk(g)
2 1
2 dx

6.1 Littlewood–Paley Theory
431
≤3n

∑
j∈Zn
Δj( f)
2 1
2 
Lp


∑
k∈Zn
Δk(g)
2 1
2 
Lp′
≤C−1
n max

p′,(p′ −1)−1ng

Lp′


∑
j∈Zn
Δj( f)
2 1
2 
Lp ,
where we used the fact that Δj( f) and Δk(g) are orthogonal operators unless every
coordinate of k is within 1 unit of the corresponding coordinate of j; this is an easy
consequence of the support properties of 1ψ. We now take the supremum over all g
in Lp′ with norm at most 1, to obtain (6.1.31) for Schwartz functions f.
To extend this estimate to general Lp functions f, we use the density argument
described in the last paragraph in the proof of Theorem 6.1.6.
□
6.1.4 Lack of Orthogonality on Lp
We discuss two examples indicating why (6.1.1) cannot hold if the exponent 2 is
replaced by some other exponent q ̸= 2. More precisely, we show that if the functions
f j have Fourier transforms supported in disjoint sets, then the inequality
∑
j
f j

p
Lp ≤Cp∑
j
f j
p
Lp
(6.1.32)
cannot hold if p > 2, and similarly, the inequality
∑
j
f j
p
Lp ≤Cp
∑
j
f j

p
Lp
(6.1.33)
cannot hold if p < 2. In both (6.1.32) and (6.1.33) the constants Cp are supposed to
be independent of the functions f j.
Example 6.1.8. Pick a Schwartz function ζ whose Fourier transform is positive and
supported in the interval |ξ| ≤1/4. Let N be a large integer and let
f j(x) = e2πi jxζ(x).
Then
1f j(ξ) = 1ζ(ξ −j)
and the 1f j’s have disjoint Fourier transforms. We obviously have
N
∑
j=0
 f j
p
Lp = (N +1)
ζ
p
Lp.

432
6 Littlewood–Paley Theory and Multipliers
On the other hand, we have the estimate

N
∑
j=0
f j

p
Lp =

R
 e2πi(N+1)x−1
e2πix−1
p|ζ(x)|p dx
≥c

|x|< 1
10 (N+1)−1
(N+1)p|x|p
|x|p
|ζ(x)|p dx
= Cζ(N +1)p−1 ,
since ζ does not vanish in a neighborhood of zero. We conclude that (6.1.32) cannot
hold for this choice of f j’s for p > 2.
Example 6.1.9. We now indicate why (6.1.33) cannot hold for p < 2. We pick a
smooth function Ψ on the line whose Fourier transform 1
Ψ is supported in
 7
8, 17
8

,
is nonnegative, is equal to 1 on
 9
8, 15
8

, and satisﬁes
∑
j∈Z
1
Ψ(2−jξ)2 = 1,
ξ > 0.
Extend 1
Ψ to be an even function on the whole line and let Δ j be the Littlewood–
Paley operator associated with Ψ. Also pick a nonzero Schwartz function ϕ on the
real line whose Fourier transform is nonnegative and supported in the set
 11
8 , 13
8

.
Fix N a large positive integer and let
f j(x) = e2πi 12
8 2 jxϕ(x),
(6.1.34)
for j = 1,2,...,N. Then the function 1f j(ξ) = 1ϕ(ξ −12
8 2j) is supported in the set
 11
8 + 12
8 2j, 13
8 + 12
8 2j
, which is contained in
 9
82j, 15
8 2j
for j ≥3. In other words,
1
Ψ(2−jξ) is equal to 1 on the support of 1f j. This implies that
Δ j( f j) = f j
for
j ≥3.
This observation combined with (6.1.21) gives for N ≥3,

N
∑
j=3
f j

Lp =

N
∑
j=3
Δ j( f j)

Lp ≤Cp

 N
∑
j=3
| f j|21
2 
Lp = Cp
ϕ

Lp(N −2)
1
2 ,
where 1 < p < ∞. On the other hand, (6.1.34) trivially yields that
 N
∑
j=3
f j
p
Lp
 1
p =
ϕ

Lp(N −2)
1
p .
Letting N →∞we see that (6.1.33) cannot hold for p < 2 even when the f j’s have
Fourier transforms supported in disjoint sets.

6.1 Littlewood–Paley Theory
433
Example 6.1.10. A similar idea illustrates the necessity of the ℓ2 norm in (6.1.4). To
see this, let Ψ and Δ j be as in Example 6.1.9. Let us ﬁx 1 < p < ∞and q < 2. We
show that the inequality


∑
j∈Z
|Δ j( f)|q1
q 
Lp ≤Cp,q
 f

Lp
(6.1.35)
cannot hold. Take f = ∑N
j=3 f j, where the f j are as in (6.1.34) and N ≥3. Then
the left-hand side of (6.1.35) is bounded from below by ∥ϕ∥Lp(N −2)1/q, while the
right-hand side is bounded above by ∥ϕ∥Lp(N −2)1/2. Letting N →∞, we deduce
that (6.1.35) is impossible when q < 2.
Example 6.1.11. For 1 < p < ∞and 2 < q < ∞, the inequality
g

Lp ≤Cp,q


∑
j∈Z
|Δ j(g)|q1
q 
Lp
(6.1.36)
cannot hold even under assumption (6.1.6) on Ψ. Let Δ j be as in Example 6.1.9.
Let us suppose that (6.1.36) did hold for some q > 2 for these Δ j’s. Then the self-
adjointness of the Δ j’s and duality would give


∑
k∈Z
|Δk(g)|q′ 1
q′ 
Lp′
=
sup
∥{hk}k∥ℓq

Lp≤1


R ∑
k∈Z
Δk(g)hk dx

≤
g

Lp′
sup
∥{hk}k∥ℓq

Lp≤1
 ∑
k∈Z
Δk(hk)

Lp
≤C
g

Lp′
sup
∥{hk}k∥ℓq

Lp≤1


∑
j∈Z
Δ j

∑
k∈Z
Δk(hk)

q1
q 
Lp
by (6.1.36)
≤C′g

Lp′
sup
∥{hk}k∥ℓq

Lp≤1
$
1
∑
l=−1


∑
j∈Z
|Δ jΔ j+l(hj)|q1
q 
Lp
%
≤C′′g

Lp′
sup
∥{hk}k∥ℓq

Lp≤1


∑
j∈Z
|hj|q1
q 
Lp = C′′g

Lp′ ,
where the next-to-last inequality follows from (6.1.22) applied twice, while the one
before that follows from support considerations. But since q′ < 2, this exactly proves
(6.1.35), previously shown to be false, a contradiction.
We conclude that if both assertions (6.1.4) and (6.1.8) of Theorem 6.1.2 were to
hold, then the ℓ2 norm inside the Lp norm could not be replaced by an ℓq norm for
some q ̸= 2. Exercise 6.1.6 indicates the crucial use of the fact that ℓ2 is a Hilbert
space in the converse inequality (6.1.8) of Theorem 6.1.2.

434
6 Littlewood–Paley Theory and Multipliers
Exercises
6.1.1. Construct a Schwartz function Ψ that satisﬁes ∑j∈Z | 1
Ψ(2−jξ)|2 = 1 for all
ξ ∈Rn \{0} and whose Fourier transform is supported in the annulus 6
7 ≤|ξ| ≤2
and is equal to 1 on the annulus 1 ≤|ξ| ≤14
7 .

Hint: Set 1
Ψ(ξ) = η(ξ)

∑k∈Z |η(2−kξ)|2−1/2 for a suitable η ∈C ∞
0 (Rn) .

6.1.2. Suppose that Ψ is an integrable function on Rn that satisﬁes | 1
Ψ(ξ)| ≤
B min(|ξ|ε,|ξ|−ε′) for some ε′,ε > 0. Show that for some constant Cε,ε′ < ∞we
have
sup
ξ∈Rn
 ∞
0 | 1
Ψ(tξ)|2 dt
t
 1
2
+ sup
ξ∈Rn

∑
j∈Z
| 1
Ψ(2−jξ)|2 1
2 ≤Cε,ε′ B.
6.1.3. Let Ψ be an integrable function on Rn with mean value zero that satisﬁes
|Ψ(x)| ≤B(1+|x|)−n−ε,

Rn |Ψ(x−y)−Ψ(x)|dx ≤B|y|ε′,
for some B,ε′,ε > 0 and for all y ̸= 0.
(a) Prove that | 1
Ψ(ξ)| ≤cn,ε,ε′ B min(|ξ|min( ε
2 ,1),|ξ|−ε) for some constant cn,ε,ε′ and
conclude that (6.1.4) holds for p = 2.
(b) Deduce the validity of (6.1.4) and (6.1.5).
(c) If ε < 1 and the assumption |Ψ(x)| ≤B(1 + |x|)−n−ε is weakened to |Ψ(x)| ≤
B|x|−n−ε for all x ∈Rn, then show that | 1
Ψ(ξ)| ≤cn,ε,ε′ B min(|ξ|
ε
2 ,|ξ|−ε) and thus
(6.1.4) and (6.1.5) are valid.

Hint: Part (a): Make use of the identity
1
Ψ(ξ) =

Rn e−2πix·ξΨ(x)dx = −

Rn e−2πix·ξΨ(x−y)dx,
where y = 1
2
ξ
|ξ|2 when |ξ| ≥1. For |ξ| ≤1 use the mean value property ofΨ to write
1
Ψ(ξ) =

|x|≤1Ψ(x)(e−2πix·ξ −1)dx and split the integral in the regions |x| ≤1 and
|x| ≥1. Part (b): If ⃗K is deﬁned by (6.1.13), then control the ℓ2(Z) norm by the ℓ1(Z)
norm to prove (6.1.16). Then split the sum ∑j∈Z

|x|≥2|y|
Ψ2−j(x −y) −Ψ2−j(x)
dx
into the parts ∑2 j≤|y|−1 and ∑2 j>|y|−1. Part (c): Notice that when ε < 1, we have
|

|x|≤1Ψ(x)(e−2πix·ξ −1)dx| ≤Cn B|ξ|
ε
2 .

6.1.4. Let Ψ be an integrable function on Rn with mean value zero that satisﬁes
|Ψ(x)| ≤B(1+|x|)−n−ε,

Rn |Ψ(x−y)−Ψ(x)|dx ≤B|y|ε′,

6.1 Littlewood–Paley Theory
435
for some B,ε′,ε > 0 and for all y ̸= 0. Let Ψt(x) = t−nΨ(x/t). (a) Prove that there
are constants cn,c′
n such that
 ∞
0 |Ψt(x)|2 dt
t dx
 1
2
≤cn B|x|−n ,
sup
y∈Rn\{0}

|x|≥2|y|
 ∞
0 |Ψt(x−y)−Ψt(x)|2 dt
t
 1
2
dx ≤c′
n B.
(b) Show that there exist constants Cn,C′
n such that for all 1 < p < ∞and for all
f ∈Lp(Rn) we have

 ∞
0 | f ∗Ψt|2 dt
t
1
2 
Lp(Rn) ≤CnBmax(p,(p−1)−1)
f

Lp(Rn)
and also for all f ∈L1(Rn) we have

 ∞
0 | f ∗Ψt|2 dt
t
1
2 
L1,∞(Rn) ≤C′
nB
 f

L1(Rn) .
(c) Under the additional hypothesis that 0 <
 ∞
0 | 1
Ψ(tξ)|2 dt
t = c0 for all ξ ∈Rn \{0},
prove that for all f ∈Lp(Rn) we have
f

Lp(Rn) ≤C′′
n B max(p,(p−1)−1)

 ∞
0 | f ∗Ψt|2 dt
t
1
2 
Lp(Rn)

Hint: Part (a): Use the Cauchy-Schwarz inequality to obtain

|x|≥2|y|
 ∞
0 |Ψt(x−y)−Ψt(x)|2 dt
t
 1
2
dx
≤cn|y|−ε
2

|x|≥2|y| |x|n+ε
 ∞
0 |Ψt(x−y)−Ψt(x)|2 dt
t dx
 1
2
,
and split the integral on the right into the regions t ≤|y| and t > |y|. In the second
region use that Ψ is bounded to replace the square by the ﬁrst power. Part (b): Use
Exercise 6.1.2 and part (a) of Exercise 6.1.3 and to deduce the inequality when p = 2.
Then apply Theorem 5.6.1. Part (c): Prove the inequality ﬁrst for f ∈S (Rn) using
duality.

6.1.5. Prove the following generalization of Theorem 6.1.2. Let A > 0. Suppose that
{Kj}j∈Z is a sequence of locally integrable functions on Rn \{0} that satisﬁes
sup
x̸=0
|x|n
∑
j∈Z
|Kj(x)|2 1
2 ≤A ,
sup
y∈Rn\{0}

|x|≥2|y|

∑
j∈Z
|Kj(x−y)−Kj(x)|21
2 dx ≤A < ∞,

436
6 Littlewood–Paley Theory and Multipliers
and for each j ∈Z there is a number Lj such that
lim
εk↓0

εk≤|y|≤1 Kj(y)dy = Lj .
If the Kj coincide with tempered distributions Wj that satisfy
∑
j∈Z
|2
Wj(ξ)|2 ≤B2 ,
then the operator
f →

∑
j∈Z
|Kj ∗f|21
2
maps Lp(Rn) to itself and is weak type (1,1) norms at most multiples of A+B.
6.1.6. Suppose that H is a Hilbert space with inner product ⟨·, ·⟩H . Let A > 0 and
1 < p < ∞. Suppose that an operator T from L2(Rn) →L2(Rn,H ) is a multiple of
an isometry, that is,
T(g)

L2(Rn,H ) = A
g

L2(Rn)
for all g ∈L2(Rn,H ). Then the inequality ∥T( f)∥Lp(Rn,H ) ≤Cp∥f∥Lp(Rn) for all
f ∈S (Rn) implies
f

Lp′(Rn) ≤Cp′A−2T( f)

Lp′(Rn,H )
for all in f ∈S (Rn).

Hint: Use the inner product structure and polarization to obtain
A2


Rn f(x)g(x)dx
 =


Rn
>
T( f)(x),T(g)(x)
?
H dx

and then argue as in the proof of inequality (6.1.8).

6.1.7. Suppose that {mj}j∈Z is a sequence of bounded functions supported in the
intervals [2j,2j+1]. Let Tj( f) = ( 1f mj)∨be the corresponding multiplier operators.
Assume that for all sequences of functions {f j}j the vector-valued inequality


∑
j
|Tj( f j)|21
2 
Lp ≤Ap


∑
j
| f j|21
2 
Lp
is valid for some 1 < p < ∞. Prove there is a Cp > 0 such that for all ﬁnite subsets S
of Z we have
∑
j∈S
mj

Mp ≤Cp Ap.

Hint: Use that
4
∑j∈S Tj( f),g
5
= ∑j∈S
4
Δ #
j Tj( f),Δ #
j (g)
5
.


6.2 Two Multiplier Theorems
437
6.1.8. Let m be a bounded function on Rn that is supported in the annulus
1 ≤|ξ| ≤2 and deﬁne Tj( f) =
 1f(ξ)m(2−jξ)
∨. Suppose that the square func-
tion f →

∑j∈Z |Tj( f)|21/2 is bounded on Lp(Rn) for some 1 < p < ∞. Show that
for every ﬁnite subset S of the integers we have
∑
j∈S
Tj( f)

Lp(Rn) ≤Cp,n
 f

Lp(Rn)
for some constant Cp,n independent of S.
6.1.9. Fix a nonzero Schwartz function h on the line whose Fourier transform is
supported in the interval

−1
8, 1
8

. For {aj} a sequence of numbers, set
f(x) =
∞
∑
j=1
aje2πi2 jxh(x).
Prove that for all 1 < p < ∞there exists a constant Cp such that
∥f∥Lp(R) ≤Cp
∑
j
|aj|2 1
2 ∥h∥Lp .

Hint: Write f = ∑∞
j=1 Δ j(aje2πi2 j(·)h), where Δ j is given by convolution with ϕ2−j
for some ϕ whose Fourier transform is supported in the interval
 6
8, 10
8

and is equal
to 1 on
 7
8, 9
8

. Then use (6.1.21).

6.1.10. Let Ψ be a Schwartz function whose Fourier transform is supported in the
annulus 1
2 ≤|ξ| ≤2 and that satisﬁes (6.1.7). Deﬁne a Schwartz function Φ by
setting
1Φ(ξ) =

∑j≤0 1
Ψ(2−jξ)
when ξ ̸= 0,
1
when ξ = 0.
Let S0 be the operator given by convolution with Φ. Let 1 < p < ∞and f ∈Lp(Rn).
Show that
f

Lp ≈
S0( f)

Lp +

 ∞
∑
j=1
|Δ j( f)|2 1
2 
Lp .

Hint: Use Theorem 6.1.2 together with the identity S0 +∑∞
j=1 Δ j = I.

6.2 Two Multiplier Theorems
We now return to the spaces Mp introduced in Section 2.5. We seek sufﬁcient con-
ditions on L∞functions deﬁned on Rn to be elements of Mp. In this section we are
concerned with two fundamental theorems that provide such sufﬁcient conditions.

438
6 Littlewood–Paley Theory and Multipliers
These are the Marcinkiewicz and the H¨ormander–Mihlin multiplier theorems. Both
multiplier theorems are consequences of the Littlewood–Paley theory discussed in
the previous section.
Using the dyadic decomposition of Rn, we can write any L∞function m as the
sum
m = ∑
j∈Zn
mχRj
a.e.,
where j = ( j1,..., jn), Rj = Ij1 ×···×Ijn, and Ik = [2k,2k+1)(−2k+1,−2k]. For j
in Zn we set mj = mχRj. A consequence of the ideas developed so far is the following
characterization of Mp(Rn) in terms of a vector-valued inequality.
Proposition 6.2.1. Let m ∈L∞(Rn) and let mj = mχRj. Then m lies in Mp(Rn), that
is, for some cp we have
( 1fm)∨
Lp ≤cp
f

Lp ,
f ∈Lp(Rn),
if and only if for some Cp > 0 we have


∑
j∈Zn
|(1fjmj)∨|21
2 
Lp ≤Cp


∑
j∈Zn
| fj|21
2 
Lp
(6.2.1)
for all sequences of functions fj in Lp(Rn).
Proof. Suppose that m ∈Mp(Rn). Exercise 5.6.1 gives the ﬁrst inequality below


∑
j∈Zn
|(χRjm1fj)∨|21
2 
Lp ≤Cp


∑
j∈Zn
|(m1fj)∨|21
2 
Lp ≤Cp


∑
j∈Zn
| fj|21
2 
Lp ,
while the second inequality follows from Theorem 5.5.1. (Observe that when p = q
in Theorem 5.5.1, then Cp,q = 1.) Conversely, suppose that (6.2.1) holds for all se-
quences of functions fj. Fix a function f and apply (6.2.1) to the sequence ( 1f χRj)∨,
where Rj is the dyadic rectangle indexed by j = ( j1,..., jn) ∈Zn. We obtain


∑
j∈Zn
|( 1f mχRj)∨|21
2 
Lp ≤Cp


∑
j∈Zn
|( 1f χRj)∨|21
2 
Lp.
Using Theorem 6.1.6, we obtain that the previous inequality is equivalent to the
inequality
( 1f m)∨
Lp ≤cp
f

Lp ,
which implies that m ∈Mp(Rn).
□

6.2 Two Multiplier Theorems
439
6.2.1 The Marcinkiewicz Multiplier Theorem on R
Proposition 6.2.1 suggests that the behavior of m on each dyadic rectangle Rj should
play a crucial role in determining whether m is an Lp multiplier. The Marcinkiewicz
multiplier theorem provides such sufﬁcient conditions on m restricted to any dyadic
rectangle Rj. Before stating this theorem, we illustrate its main idea via the follow-
ing example. Suppose that m is a bounded function that vanishes near −∞, that is
differentiable at every point, and whose derivative is integrable. Then we may write
m(ξ) =
 ξ
−∞m′(t)dt =
 +∞
−∞χ[t,∞)(ξ)m′(t)dt ,
from which it follows that for a Schwartz function f we have
( 1fm)∨=

R( 1f χ[t,∞))∨m′(t)dt.
Since the operators f →( 1f χ[t,∞))∨map Lp(R) to itself independently of t, it follows
that
( 1fm)∨
Lp ≤Cp
m′
L1
f

Lp ,
thus yielding that m is in Mp(R). The next multiplier theorem is an improvement
of this result and is based on the Littlewood–Paley theorem. We begin with the one-
dimensional case, which already captures the main ideas.
Theorem 6.2.2. (Marcinkiewicz multiplier theorem) Let m : R →R be a bounded
function that is C 1 in every dyadic set (2j,2j+1)(−2j+1,−2j) for j ∈Z. Assume
that the derivative m′ of m satisﬁes
sup
j
 −2 j
−2 j+1 |m′(ξ)|dξ +
 2 j+1
2 j
|m′(ξ)|dξ

≤A < ∞.
(6.2.2)
Then for all 1 < p < ∞we have that m ∈Mp(R) and for some C > 0 we have
m

Mp(R) ≤Cmax

p,(p−1)−16m

L∞+A

.
(6.2.3)
Proof. Since the function m has an integrable derivative on (2j,2j+1), it has
bounded variation in this interval and hence it is a difference of two increasing
functions. Therefore, m has left and right limits at the points 2j and 2j+1, and by
redeﬁning m at these points we may assume that m is right continuous at the points
2j and left continuous at the points −2j.
Set Ij = [2j,2j+1) ∪(−2j+1,−2j] and I+
j = [2j,2j+1) whenever j ∈Z. Given
an interval I in R, we introduce an operator ΔI deﬁned by ΔI( f) = ( 1f χI)∨. With
this notation ΔI+
j ( f) is “half” of the operator Δ #
j introduced in the previous section.
Given m as in the statement of the theorem, we write m(ξ) = m+(ξ) + m−(ξ),
where m+(ξ) = m(ξ)χξ≥0 and m−(ξ) = m(ξ)χξ<0. We show that both m+ and m−

440
6 Littlewood–Paley Theory and Multipliers
are Lp multipliers. Since m′ is integrable over all intervals of the form [2j,ξ] when
2j ≤ξ < 2j+1, the fundamental theorem of calculus gives
m(ξ) = m(2j)+
 ξ
2 j m′(t)dt,
for 2j ≤ξ < 2j+1,
from which it follows that for a Schwartz function f on the real line we have
m(ξ) 1f(ξ)χI+
j (ξ) = m(2j) 1f(ξ)χI+
j (ξ)+
 2 j+1
2 j
1f(ξ)χ[t,∞)(ξ)χI+
j (ξ)m′(t)dt .
We therefore obtain the identity
( 1f χIjm+)∨= ( 1fmχI+
j )∨= m(2j)ΔI+
j ( f)+
 2 j+1
2 j
Δ[t,∞)ΔI+
j ( f)m′(t)dt ,
which implies that
|( 1f χIjm+)∨| ≤∥m∥L∞|ΔI+
j ( f)|+A
1
2
 2 j+1
2 j
Δ[t,∞)ΔI+
j ( f)
2 |m′(t)|dt
1
2
,
using the hypothesis (6.2.2). Taking ℓ2(Z) norms we obtain

∑
j∈Z
|( 1f χIjm+)∨|21
2 ≤∥m∥L∞

∑
j∈Z
|ΔI+
j ( f)|21
2
+A
1
2
 ∞
0
Δ[t,∞)Δ #
[log2 t]( f)
2 |m′(t)|dt
1
2
.
Exercise 5.6.2 gives
A
1
2

 ∞
0
Δ[t,∞)Δ #
[log2 t]( f)
2|m′(t)|dt
1
2 
Lp
≤Cmax(p,(p−1)−1)A
1
2

 ∞
0
Δ #
[log2 t]( f)
2|m′(t)|dt
1
2 
Lp ,
while the hypothesis on m′ implies the inequality


∑
j∈Z
ΔI+
j ( f)
2 
I+
j
|m′(t)|dt
1
2 
Lp ≤A
1
2


∑
j
|ΔI+
j ( f)|21
2 
Lp .
Using Theorem 6.1.5 we obtain that


∑
j
|ΔI+
j ( f)|21
2 
Lp ≤C′ max(p,(p−1)−1)2 1f χ(0,∞)
∨
Lp ,

6.2 Two Multiplier Theorems
441
and the latter is at most a constant multiple of max(p,(p −1)−1)3f

Lp. Putting
things together we deduce that


∑
j
|( 1f χIjm+)∨|21
2 
Lp ≤C′′ max(p,(p−1)−1)4
A+∥m∥L∞ f

Lp ,
(6.2.4)
from which we obtain the estimate
( 1fm+)∨
Lp ≤Cmax(p,(p−1)−1)6
A+∥m∥L∞ f

Lp ,
using the lower estimate of Theorem 6.1.5. This proves (6.2.3) for m+. A similar
argument also works for m−, and this concludes the proof by summing the corre-
sponding estimates for m+ and m−.
□
We remark that the same proof applies under the more general assumption that
m is a function of bounded variation on every interval [2j,2j+1] and [−2j+1,−2j].
In this case the measure |m′(t)|dt should be replaced by the total variation |dm(t)|
of the Lebesgue–Stieltjes measure dm(t).
Example 6.2.3. Any bounded function that is constant on dyadic intervals is an Lp
multiplier. Also, the function
m(ξ) = |ξ|2−[log2 |ξ|]
is an Lp multiplier on R for 1 < p < ∞.
6.2.2 The Marcinkiewicz Multiplier Theorem on Rn
We now extend this theorem on Rn. As usual we denote the coordinates of a point
ξ ∈Rn by (ξ1,...,ξn). We recall the notation Ij = (−2j+1,−2j][2j,2j+1) and
Rj = Ij1 ×···×Ijn whenever j = ( j1,..., jn) ∈Zn.
Theorem 6.2.4. Let m be a bounded function on Rn such that for all α = (α1,...,αn)
with |α1|,...,|αn| ≤1 the derivatives ∂αm are continuous up to the boundary of Rj
for all j ∈Zn. Assume that there is a constant A < ∞such that for all partitions
{s1,...,sk}∪{r1,...,rℓ} = {1,2,...,n} with n = k +ℓand all ξ ∈Rj we have
sup
ξr1∈Ijr1
··· sup
ξrℓ∈Ijrℓ

Ijs1
···

Ijsk
(∂s1 ···∂skm)(ξ1,...,ξn)
dξsk ···dξs1 ≤A
(6.2.5)
for all j = ( j1,..., jn) ∈Zn. Then m is in Mp(Rn) whenever 1 < p < ∞and there is
a constant Cn < ∞such that
∥m∥Mp(Rn) ≤Cn

A+∥m∥L∞
max

p,(p−1)−16n.
(6.2.6)

442
6 Littlewood–Paley Theory and Multipliers
Proof. We prove this theorem only in dimension n = 2, since the general case
presents no substantial differences but only some notational inconvenience. We de-
compose the given function m as
m(ξ) = m++(ξ)+m−+(ξ)+m+−(ξ)+m−−(ξ),
where each of the last four terms is supported in one of the four quadrants. For
instance, the function m+−(ξ1,ξ2) is supported in the quadrant ξ1 ≥0 and ξ2 < 0.
As in the one-dimensional case, we work with each of these pieces separately. By
symmetry we choose to work with m++ in the following argument.
Using the fundamental theorem of calculus, we obtain the following simple iden-
tity, valid for 2j1 ≤ξ1 < 2j1+1 and 2j2 ≤ξ2 < 2j2+1:
m(ξ1,ξ2) = m(2j1,2j2)+
 ξ1
2 j1 (∂1m)(t1,2j2)dt1
+
 ξ2
2 j2 (∂2m)(2j1,t2)dt2
+
 ξ1
2 j1
 ξ2
2 j2 (∂1∂2m)(t1,t2)dt2 dt1 .
(6.2.7)
We introduce operators Δ (r)
I , r ∈{1,2}, acting in the rth variable (with the other
variable remaining ﬁxed) given by multiplication on the Fourier transform side by
the characteristic function of the interval I. Likewise, we introduce operators Δ #(r)
j
,
r ∈{1,2} (also acting in the rth variable), given by multiplication on the Fourier
transform side by the characteristic function of the set (−2j+1,−2j][2j,2j+1). For
notational convenience, for a given Schwartz function f we write
f++ =
 1f χ(0,∞)2
∨,
and likewise we deﬁne f+−, f−+, and f−−.
Multiplying both sides of (6.2.7) by the function 1f χRjχ(0,∞)2 and taking inverse
Fourier transforms yields
( 1f χRjm++)∨= m(2j1,2j2)Δ #(1)
j1
Δ #(2)
j2
( f++)
+
 2 j1+1
2 j1
Δ #(2)
j2
Δ (1)
[t1,∞)Δ #(1)
j1
( f++)(∂1m)(t1,2j2)dt1
+
 2 j2+1
2 j2
Δ #(1)
j1
Δ (2)
[t2,∞)Δ #(2)
j2
( f++)(∂2m)(2j1,t2)dt2
+
 2 j1+1
2 j1
 2 j2+1
2 j2
Δ (1)
[t1,∞)Δ #(1)
j1
Δ (2)
[t2,∞)Δ #(2)
j2
( f++)(∂1∂2m)(t1,t2)dt2 dt1 .
(6.2.8)
We apply the Cauchy–Schwarz inequality in the last three terms of (6.2.8) with re-
spect to the measures |(∂1m)(t1,2j2)|dt1, |(∂2m)(2j1,t2)|dt2, |(∂1∂2m)(t1,t2)|dt2dt1
and we use hypothesis (6.2.5) to deduce

6.2 Two Multiplier Theorems
443
( 1f χRjm++)∨ ≤∥m∥L∞Δ #(1)
j1
Δ #(2)
j2
( f++)

+ A
1
2
 2 j1+1
2 j1
Δ #(2)
j2
Δ (1)
[t1,∞)Δ #(1)
j1
( f++)
2 |(∂1m)(t1,2j2)|dt1
 1
2
+ A
1
2
 2 j2+1
2 j2
Δ #(1)
j1
Δ (2)
[t2,∞)Δ #(2)
j2
( f++)
2 |(∂2m)(2j1,t2)|dt2
 1
2
+ A
1
2
 2 j1+1
2 j1
 2 j2+1
2 j2
Δ (1)
[t1,∞)Δ #(1)
j1
Δ (2)
[t2,∞)Δ #(2)
j2
( f++)
2 |(∂1∂2m)(t1,t2)|dt2 dt1
 1
2
.
Both sides of the preceding inequality are sequences indexed by j ∈Z2. We apply
ℓ2(Z2) norms and use Minkowski’s inequality to deduce the pointwise estimate

∑
j∈Z2
( 1f χRjm++)∨21
2 ≤∥m∥L∞

∑
j∈Z2
Δ #
j ( f++)
21
2
+A
1
2
 ∞
0
 ∞
0
Δ (1)
[t1,∞)Δ #(2)
[log2 t2]Δ #(1)
[log2 t1]( f++)
2 (∂1m)(t1,2[log2 t2])
dt1dν(t2)
1
2
+A
1
2
 ∞
0
 ∞
0
Δ (2)
[t2,∞)Δ #(1)
[log2 t1]Δ #(2)
[log2 t2]( f++)
2 (∂2m)(2[log2 t1],t2)
dν(t1)dt2
1
2
+A
1
2
 ∞
0
 ∞
0
Δ (1)
[t1,∞)Δ (2)
[t2,∞)Δ #(1)
[log2 t1]Δ #(2)
[log2 t2]( f++)
2(∂1∂2m)(t1,t2)
dt1dt2
1
2
,
where ν is the counting measure ∑j∈Z δ2 j deﬁned by ν(A) = #{j ∈Z : 2j ∈A}
for subsets A of (0,∞). We now take Lp(R2) norms and we estimate separately the
contribution of each of the four terms on the right side. Using Exercise 5.6.2 we
obtain


∑
j∈Z2
( 1f χRjm++)∨21
2

Lp ≤∥m∥L∞


∑
j∈Z2
Δ #
j ( f++)
21
2

Lp
+ C2 A
1
2 max

p,(p−1)−12
×

 ∞
0
 ∞
0
Δ #(2)
[log2 t2]Δ #(1)
[log2 t1]( f++)
2 (∂1m)(t1,2[log2 t2])
dt1 dν(t2)
1
2 
Lp
+

 ∞
0
 ∞
0
Δ #(1)
[log2 t1]Δ #(2)
[log2 t2]( f++)
2 (∂2m)(2[log2 t1],t2)
dν(t1)dt2
1
2 
Lp
+

 ∞
0
 ∞
0
Δ #(1)
[log2 t1]Δ #(2)
[log2 t2]( f++)
2(∂1∂2m)(t1,t2)
dt1dt2
1
2 
Lp
+
.

444
6 Littlewood–Paley Theory and Multipliers
But the functions (t1,t2) →Δ #(1)
[log2 t1]Δ #(2)
[log2 t2]( f++) are constant on products of inter-
vals of the form [2j1,2j1+1) × [2j2,2j2+1); hence using hypothesis (6.2.5) again we
deduce the estimate


∑
j∈Z2
( 1f χRjm++)∨21
2

Lp(R2)
≤C2

∥m∥L∞+A

max

p,(p−1)−12


∑
j∈Z2
Δ #
j ( f++)
21
2

Lp(R2)
≤C2

∥m∥L∞+A

max

p,(p−1)−16( 1f χ(0,∞)2)∨
Lp(R2)
≤C2

∥m∥L∞+A

max

p,(p−1)−18f

Lp(R2) ,
where the penultimate estimate follows from Theorem 6.1.6 and the last estimate
by the boundedness of the Hilbert transform (Theorem 5.1.7). We now appeal
to inequality (6.1.29) which yields the required estimate for the Lp(R2) norm of
( 1f m++)∨. A similar argument also works for the remaining parts of m+−, m−+,
m−−, and summing concludes the proof of (6.2.6).
The analogous estimate on Rn is


∑
j∈Zn
( 1f χRjm+···+)∨21
2

Lp(Rn)
≤Cn

∥m∥L∞+A

max

p,(p−1)−14n f

Lp(Rn)
which is obtained in a similar fashion. Using (6.1.29), this implies that
( 1fm+···+)∨
Lp(Rn) ≤Cn

∥m∥L∞+A

max

p,(p−1)−16nf

Lp(Rn) .
A similar inequality holds when some (or all) +’s are replaced by −’s.
□
We now give a condition that implies (6.2.5) and is well suited for a variety of
applications.
Corollary 6.2.5. Let m be a bounded C n function deﬁned away from the coordinate
axes on Rn. Assume that for all k ∈{1,...,n}, all distinct j1,..., jk ∈{1,2,...,n},
and all ξr ∈R\{0} for r /∈{j1,..., jk} we have
(∂j1 ···∂jkm)(ξ1,...,ξn)
 ≤A|ξ j1|−1 ···|ξ jk|−1 .
(6.2.9)
Then m satisﬁes (6.2.6).
Proof. Simply observe that condition (6.2.9) implies (6.2.5).
□

6.2 Two Multiplier Theorems
445
Example 6.2.6. The following are examples of functions that satisfy the hypotheses
of Corollary 6.2.5:
m1(ξ) =
ξ1
ξ1 +i(ξ 2
2 +···+ξ 2n ) ,
m2(ξ) =
|ξ1|α1 ···|ξn|αn
(ξ 2
1 +ξ 2
2 +···+ξ 2n )α/2 ,
where α1 +α2 +···+αn = α, αj > 0,
m3(ξ) =
ξ2ξ 2
3
iξ1 +ξ 2
2 +ξ 4
3
.
The functions m1 and m2 are deﬁned on Rn \{0} and m3 on R3 \{0}.
The previous examples and many other examples that satisfy the hypothesis
(6.2.9) of Corollary 6.2.5 are invariant under a set of dilations in the following sense:
suppose that there exist k1,...,kn ∈R+ and s ∈R such that the smooth function m
on Rn \{0} satisﬁes
m(λ k1ξ1,...,λ knξn) = λ ism(ξ1,...,ξn)
for all ξ1,...,ξn ∈R and λ > 0. Then m satisﬁes condition (6.2.9). Indeed, differ-
entiation gives
λ α1k1+···+αnkn∂αm(λ k1ξ1,...,λ knξn) = λ is∂αm(ξ1,...,ξn)
for every multi-index α = (α1,...,αn). Now for every ξ ∈Rn \{0} pick the unique
λξ > 0 such that (λ k1
ξ ξ1,...,λ kn
ξ ξn) ∈Sn−1. Then λ
k jα j
ξ
≤|ξ j|−α j, and it follows
that
|∂αm(ξ1,...,ξn)| ≤

sup
Sn−1 |∂αm|

λ α1k1+···+αnkn
ξ
≤Cα|ξ1|−α1 ···|ξn|−αn.
6.2.3 The Mihlin–H¨ormander Multiplier Theorem on Rn
We now discuss another multiplier theorem that also requires decay of derivatives.
We will consider the situation where each differentiation produces uniform decay in
all variables, quantitatively expressed via the condition
|∂α
ξ m(ξ)| ≤Cα|ξ|−|α|
(6.2.10)

446
6 Littlewood–Paley Theory and Multipliers
for each multi-index α. The decay can also be expressed in terms of a square inte-
grable estimate that has the form

R<|ξ|<2R |∂α
ξ m(ξ)|2 dξ
 1
2
≤C′
α R
n
2 −|α| < ∞
(6.2.11)
for all multi-indices α and all R > 0. Obviously (6.2.10) implies (6.2.11)
Theorem 6.2.7. Let m(ξ) be a complex-valued bounded function on Rn \ {0} that
satisﬁes for some A < ∞

R<|ξ|<2R |∂α
ξ m(ξ)|2 dξ
 1
2
≤AR
n
2 −|α| < ∞
(6.2.12)
for all multi-indices |α| ≤[n/2]+1 and all R > 0.
Then for all 1 < p < ∞, m lies in Mp(Rn) and the following estimate is valid:
∥m∥Mp ≤Cn max(p,(p−1)−1)

A+∥m∥L∞
.
(6.2.13)
Moreover, the operator f →( 1fm)∨maps L1(Rn) to L1,∞(Rn) with norm at most a
dimensional constant multiple of A+∥m∥L∞.
We remark that in most applications, condition (6.2.12) appears in the form
|∂α
ξ m(ξ)| ≤Cα|ξ|−|α| ,
(6.2.14)
which should be, in principle, easier to verify.
Proof. Since m is a bounded function, the operator given by convolution with W =
m∨is bounded on L2(Rn). To prove that this operator maps L1(Rn) to L1,∞(Rn), it
sufﬁces to prove that the distribution W coincides with a function K on Rn \{0} that
satisﬁes H¨ormander’s condition.
Let 1ζ be a smooth function supported in the annulus 1
2 ≤|ξ| ≤2 such that
∑
j∈Z
1ζ(2−jξ) = 1,
when ξ ̸= 0.
Set mj(ξ) = m(ξ)1ζ(2−jξ) for j ∈Z and Kj = m∨
j . We begin by observing that
∑N
−N Kj converges to W in S ′(Rn). Indeed, for all ϕ ∈S (Rn) we have
>
N
∑
j=−N
Kj,ϕ
?
=
>
N
∑
j=−N
mj,ϕ ∨?
→
4
m,ϕ ∨5
=
4
W,ϕ
5
.
We set n0 = [ n
2]+1. We claim that there is a constant #Cn such that
sup
j∈Z

Rn |Kj(x)|(1+2j|x|)
1
4 dx ≤#CnA,
(6.2.15)
sup
j∈Z
2−j

Rn |∇Kj(x)|(1+2j|x|)
1
4 dx ≤#CnA.
(6.2.16)

6.2 Two Multiplier Theorems
447
To prove (6.2.15) we multiply and divide the integrand in (6.2.15) by the expression
(1 + 2j|x|)n0. Applying the Cauchy–Schwarz inequality to |Kj(x)|(1 + 2j|x|)n0 and
(1+2j|x|)−n0+ 1
4 , we control the integral in (6.2.15) by the product

Rn |Kj(x)|2(1+2j|x|)2n0 dx
1
2 
Rn(1+2j|x|)−2n0+ 1
2 dx
1
2
.
(6.2.17)
We now note that −2n0 + 1
2 < −n, and hence the second factor in (6.2.17) is equal
to a constant multiple of 2−jn/2. To estimate the ﬁrst integral in (6.2.17) we use the
simple fact that
(1+2j|x|)n0 ≤C(n) ∑
|γ|≤n0
|(2jx)γ|.
We now have that the expression inside the supremum in (6.2.15) is controlled by
C′(n)2−jn/2 ∑
|γ|≤n0

Rn |Kj(x)|222 j|γ||xγ|2 dx
1
2
,
(6.2.18)
which, by Plancherel’s theorem, is equal to
2−jn/2 ∑
|γ|≤n0
Cγ2j|γ|

Rn |(∂γmj)(ξ)|2 dξ
1
2
(6.2.19)
for some constants Cγ.
For multi-indices δ = (δ1,...,δn) and γ = (γ1,...,γn) we introduce the notation
δ ≤γ to mean δ j ≤γ j for all j = 1,...,n . For any |γ| ≤n0 we use Leibniz’s rule to
obtain for some constants Cδ,γ

Rn |(∂γmj)(ξ)|2 dξ
1
2
≤∑
δ≤γ
Cδ,γ

Rn
2−j|γ−δ|(∂γ−δ
ξ
1ζ)(2−jξ)(∂δ
ξ m)(ξ)
2dξ
1
2
≤∑
δ≤γ
Cδ,γ2−j|γ|2j|δ|

2 j−1≤|ξ|≤2 j+1 |(∂δ
ξ m)(ξ)
2 dξ
1
2
≤∑
δ≤γ
Cδ,γ2−j|γ|2j|δ| 2A2jn/22−j|δ|
= #Cn A2jn/22−j|γ| ,
which inserted in (6.2.19) and combined with (6.2.18) yields (6.2.15). To obtain
(6.2.16) we repeat the same argument for every derivative ∂rKj. Since the Fourier
transform of (∂rKj)(x)xγ is equal to a constant multiple of ∂γ
ξrm(ξ)1ζ(2−jξ)

,
we observe that the extra factor 2−j in (6.2.16) can be combined with ξr to write
2−j∂γ
ξrm(ξ)1ζ(2−jξ)

as ∂γ
m(ξ)1ζr(2−jξ)

, where 1ζr(ξ) = ξr1ζ(ξ). The pre-
vious calculation with 1ζr replacing 1ζ can then be used to complete the proof of
(6.2.16).

448
6 Littlewood–Paley Theory and Multipliers
We now show that for all x ̸= 0, the series ∑j∈Z Kj(x) converges to a function,
which we denote by K(x). Indeed, as a consequence of (6.2.15) we have that
(1+2jδ)
1
4

|x|≥δ |Kj(x)|dx ≤#CnA,
for any δ > 0, which implies that the function ∑j>0 |Kj(x)| is integrable away from
the origin and satisﬁes

δ≤|x|≤2δ ∑j>0 |Kj(x)|dx < ∞. Now note that (6.2.15) also
holds with −1
4 in place of 1
4. Using this observation we obtain
(1+2j2δ)−1
4

|x|≤2δ |Kj(x)|dx ≤

|x|≤2δ |Kj(x)|(1+2j|x|)−1
4 dx ≤#CnA,
and from this it follows that

δ≤|x|≤2δ ∑j≤0 |Kj(x)|dx < ∞.
We conclude that the series ∑j∈Z Kj(x) converges a.e. on Rn \{0} to a function
K(x) that coincides with the distribution W = m∨on Rn \{0} and satisﬁes
sup
δ>0

δ≤|x|≤2δ |K(x)|dx < ∞.
We now prove that the function K = ∑j∈Z Kj (deﬁned on Rn \ {0}) satisﬁes
H¨ormander’s condition. It sufﬁces to prove that for all y ̸= 0 we have
∑
j∈Z

|x|≥2|y| |Kj(x−y)−Kj(x)|dx ≤2C′
nA.
(6.2.20)
Fix a y ∈Rn \{0} and pick a k ∈Z such that 2−k ≤|y| ≤2−k+1. The part of the sum
in (6.2.20) where j > k is bounded by
∑
j>k

|x|≥2|y| |Kj(x−y)|+|Kj(x)|dx ≤2 ∑
j>k

|x|≥|y| |Kj(x)|dx
≤2 ∑
j>k

|x|≥|y| |Kj(x)|(1+2j|x|)
1
4
(1+2j|x|)
1
4
dx
≤∑
j>k
2#CnA
(1+2j|y|)
1
4
≤∑
j>k
2#CnA
(1+2j2−k)
1
4
= C′
nA,
where we used (6.2.15). The part of the sum in (6.2.20) where j ≤k is bounded by
∑
j≤k

|x|≥2|y| |Kj(x−y)−Kj(x)|dx
≤∑
j≤k

|x|≥2|y|
 1
0 |−y·∇Kj(x−θy)|dθ dx

6.2 Two Multiplier Theorems
449
≤
 1
0 ∑
j≤k
2−k+1

Rn |∇Kj(x−θy)|(1+2j|x−θy|)
1
4 dxdθ
≤
 1
0 ∑
j≤k
2−k+1 #CnA2j dθ ≤C′
nA,
using (6.2.16). H¨ormander’s condition is satisﬁed for K, and we appeal to Theorem
5.3.3 to complete the proof of (6.2.13).
□
Example 6.2.8. Let m be a smooth function away from the origin that is homoge-
neous of imaginary order, i.e., for some ﬁxed τ real and all λ > 0 we have
m(λξ) = λ iτm(ξ).
(6.2.21)
Then m is an Lp Fourier multiplier for 1 < p < ∞. Indeed, differentiating both sides
of (6.2.21) with respect to ∂α
ξ we obtain
λ |α|∂α
ξ m(λξ) = λ iτ∂α
ξ m(ξ)
and taking λ = |ξ|−1, we deduce condition (6.2.14) with Cα = sup|θ|=1 |∂αm(θ)|.
An explicit example of such a function is m(ξ) = |ξ|iτ. Another example is
m0(ξ1,ξ2,ξ3) =
ξ 2
1 +ξ 2
2
ξ 2
1 +i(ξ 2
2 +ξ 2
3 )
which is homogeneous of degree zero and also smooth on Rn \{0}.
Example 6.2.9. Let z be a complex numbers with Rez ≥0. Then the functions
m1(ξ) =

|ξ|2
1+|ξ|2
z
,
m2(ξ) =

1
1+|ξ|2
z
deﬁned on Rn are Lp Fourier multipliers for 1 < p < ∞. To prove this assertion for
m1, we verify condition (6.2.14). To achieve this, introduce the function on Rn+1
M1(ξ1,...,ξn,t) =

|ξ1|2 +···+|ξn|2
t2 +|ξ1|2 +···+|ξn|2
z
=

|ξ|2
t2 +|ξ|2
z
,
where ξ = (ξ1,...,ξn). Then M is homogeneous of degree 0 and smooth on
Rn+1 \{0}. The derivatives ∂βM1 are homogeneous of degree −|β| and by the cal-
culation in the preceding example they satisfy |∂βM1(ξ,t)| ≤Cβ|(ξ,t)|−|β|, with
Cβ = sup|θ|=1 |∂βM1(θ)|, whenever (ξ,t) ̸= 0 and β is a multi index of n+1 vari-
ables. In particular, taking β = (α,0), we obtain
∂α1
ξ1 ···∂αn
ξn M1(ξ1,...,ξn,t)
 ≤
Cα
(t2 +|ξ|2)|α|/2 ,
and setting t = 1 we deduce that |∂αm1(ξ)| ≤Cα(1+|ξ|2)−|α|/2 ≤Cα|ξ|−|α|.

450
6 Littlewood–Paley Theory and Multipliers
For m2 we introduce the function
M2(ξ1,...,ξn,t) =

1
t2 +|ξ1|2 +···+|ξn|2
z
on Rn+1, which is homogeneous of degree −2z. Then the derivative ∂βM2 is homo-
geneous of degree −|β| −2z, hence it satisﬁes |∂βM2(ξ,t)| ≤Cβ|(ξ,t)|−|β|−2Rez
for all multi-indices β of n+1 variables. In particular, taking β = (α,0), we obtain
∂α1
ξ1 ···∂αn
ξn M2(ξ1,...,ξn,t)
 ≤
Cα
(t2 +|ξ|2)
|α|
2 +Rez ,
and setting t = 1, we deduce |∂αm2(ξ)| ≤Cα(1+|ξ|2)−|α|/2 ≤Cα|ξ|−|α|, where in
the ﬁrst inequality we used that Rez ≥0.
We end this section by comparing Theorems 6.2.2 and 6.2.4 with Theorem 6.2.7.
It is obvious that in dimension n = 1, Theorem 6.2.2 is stronger than Theorem 6.2.7
in view of the inequality

2 j<|ξ|<2 j+1 |m′(ξ)|dξ ≤2j/2

2 j<|ξ|<2 j+1 |m′(ξ)|2 dξ
 1
2
,
which implies that (6.2.2) is weaker than (6.2.12). Note also that in Theorem 6.2.2
the multiplier m is not required to be differentiable at the points ±2j. But in higher
dimensions neither theorem includes the other. In Theorem 6.2.4 the multiplier is
allowed to be singular on a set of measure zero but is required to be differentiable in
every variable, i.e., to be at least C n in the complement of this null set. In Theorem
6.2.7, the multiplier is only allowed to be singular only at the origin, but it is assumed
to be C [n/2]+1, requiring almost half the differentiability called for by condition
(6.2.9). It should be noted that both theorems have their shortcomings. In particular,
they are not Lp sensitive, i.e., delicate enough to detect whether m is a bounded
Fourier multiplier on some Lp but not on some other Lq.
Exercises
6.2.1. Let ψ(ξ) be a smooth function supported in [3/4,2]∪[−2,−3/4] and equal
to 1 on [1,3/2] ∪[−3/2,−1] that satisﬁes ∑j∈Z ψ(2−jξ) = 1 for all ξ ̸= 0. Let
1 ≤k ≤n. Prove that m ∈Mp(Rn) if and only if (6.2.1) is satisﬁed with mj(ξ) re-
placed by the function m(ξ)ψ(2−j1ξ1)···ψ(2−jkξk).

Hint: To prove one direction, partition Zk in 2k sets such that for every j =
( j1,..., jk) in each of these sets, ji has a ﬁxed remainder modulo 2. For the
other direction, use Theorem 6.1.6 in the variables x1,...,xk. Also use the inequal-
ity ∥f∥Lp(Rn) ≤Cp∥(∑j∈Zk |( 1f χRj)∨|2)1/2∥Lp(Rn), Rj = ([−2,−1
2] ∪[ 1
2,2])k × Rn−k,
which can be derived by duality from the identity ∑j∈Zk χRj = 2k.


6.2 Two Multiplier Theorems
451
6.2.2. Let ϕ be a smooth function on the real line supported in the interval [−1,1].
Let ψ(t) be a smooth function on the real line that is equal to 1 when |t| ≥10 and
vanishes when |t| ≤9. Show that for the function m(ξ1,ξ2) = eiξ 2
2 /ξ1ϕ(ξ2)ψ(ξ1)
lies in Mp(R2), 1 < p < ∞, using Theorem 6.2.4. Also show that Theorem 6.2.7
does not apply.
6.2.3. Consider the differential operators
L1 = ∂1 −∂2
2 +∂4
3 ,
L2 = ∂1 +∂2
2 +∂2
3 .
Prove that for every 1 < p < ∞there exists a constant Cp < ∞such that for all
Schwartz functions f on R3 we have
∂2∂2
3 f

Lp ≤Cp
L1( f)

Lp ,
∂1 f

Lp ≤Cp
L2( f)

Lp .

Hint: Use Corollary 6.2.5 and the idea of Example 6.2.6.

6.2.4. Suppose that m(ξ) is a real-valued function that satisﬁes either (6.2.9) or
|∂αm(ξ)| ≤Cα|ξ|−|α| for all multi-indices α with |α| ≤[ n
2]+1 and all ξ ∈Rn\{0}.
Show that eim(ξ) lies in Mp(Rn) for any 1 < p < ∞.

Hint: Prove by induction and use that
∂α
eim(ξ)
= eim(ξ)
∑
l j≥0,β j≤α
l1β 1+···+lkβ k=α
cβ 1,...,β k(∂β 1m(ξ))l1 ···(∂β km(ξ))lk ,
where the sum is taken over all partitions of the multi-index α as a linear combina-
tion of multi-indices β j with coefﬁcients l j ∈Z+ ∪{0}.

6.2.5. Suppose that ϕ(ξ) is a smooth function on Rn that vanishes in a neighbor-
hood of the origin and is equal to 1 in a neighborhood of inﬁnity. Prove that the
function eiξ j|ξ|−1ϕ(ξ) is in Mp(Rn) for 1 < p < ∞.
6.2.6. Let τ,τ1,...,τn be real numbers and ρ1,...,ρn be even natural numbers.
Prove that the following functions are Lp multipliers on Rn for 1 < p < ∞:
|ξ1|iτ1 ···|ξn|iτn ,
(|ξ1|ρ1 +···+|ξn|ρn)iτ ,
(|ξ1|−ρ1 +|ξ2|−ρ2)iτ .

452
6 Littlewood–Paley Theory and Multipliers
6.2.7. Let 1ζ(ξ) be a smooth function on Rn is supported in a compact set that does
not contain the origin and let aj be a bounded sequence of complex numbers. Prove
that the function
m(ξ) = ∑
j∈Z
aj 1ζ(2−jξ)
is in Mp(Rn) for all 1 < p < ∞.
6.2.8. Let 1ζ(ξ) be a smooth function on Rn supported in a compact set that does
not contain the origin and let Δ ζ
j ( f) =
 1f(ξ)1ζ(2−jξ)
∨. Show that the operator
f →sup
N∈Z
 ∑
j<N
Δ ζ
j ( f)

is bounded on Lp(R) when 1 < p < ∞.

Hint: Pick a Schwartz function ϕ satisfying ∑j∈Z 1ϕ(2−jξ) = 1 on Rn \ {0} with
1ϕ(ξ) supported in 6
7 ≤|ξ| ≤2. Then Δ ϕ
k Δ ζ
j = 0 if | j −k| < c0 and we have
∑
j<N
Δ ζ
j = ∑
k<N+c0
Δ ϕ
k ∑
j<N
Δ ζ
j = ∑
k<N+c0
Δ ϕ
k ∑
j
Δ ζ
j −∑
k<N+c0
Δ ϕ
k ∑
j≥N
Δ ζ
j ,
which is a ﬁnite sum plus a term controlled by a multiple of the operator
f →M
 ∑
j∈Z
Δ ζ
j ( f)

,
where M is the Hardy–Littlewood maximal function.

6.2.9. Let Ψ be a Schwartz function whose Fourier transform is real-valued, sup-
ported in a compact set that does not contain the origin, and satisﬁes
∑
j∈Z
1
Ψ(2−jξ) = 1
when ξ ̸= 0.
Let Δ j be the Littlewood–Paley operator associated with Ψ. Prove that
 ∑
| j|<N
Δ j(g)−g

Lp →0
as N →∞for all functions g ∈S (Rn). Deduce that Schwartz functions whose
Fourier transforms have compact supports that do not contain the origin are dense
in Lp(Rn) for 1 < p < ∞.

Hint: Use the result of Exercise 6.2.8 and the Lebesgue dominated convergence
theorem.


6.3 Applications of Littlewood–Paley Theory
453
6.3 Applications of Littlewood–Paley Theory
We now turn our attention to some important applications of Littlewood–Paley the-
ory. We are interested in obtaining bounds for singular and maximal operators.
These bounds are obtained by controlling the corresponding operators by quadratic
expressions.
6.3.1 Estimates for Maximal Operators
One way to control the maximal operator supk |Tk( f)| is by introducing a good aver-
aging function ϕ and using the majorization
sup
k
|Tk( f)| ≤sup
k
|Tk( f)−f ∗ϕ2−k|+sup
k
| f ∗ϕ2−k|
≤

∑
k
|Tk( f)−f ∗ϕ2−k|2 1
2 +Cϕ M( f)
(6.3.1)
for some constant Cϕ depending on ϕ. We apply this idea to prove the following
theorem.
Theorem 6.3.1. Let m be a bounded function on Rn that is C 1 in a neighborhood
of the origin and satisﬁes m(0) = 1 and |m(ξ)| ≤C|ξ|−ε for some C,ε > 0 and
all ξ ̸= 0. For each k ∈Z deﬁne Tk( f)(x) = ( 1f(ξ)m(2−kξ))∨(x). Then there is a
constant Cn such that for all L2 functions f on Rn we have
sup
k∈Z
|Tk( f)|

L2 ≤Cn
f

L2.
(6.3.2)
Proof. Select a Schwartz function ϕ such that 1ϕ(0) = 1. Then there are positive
constants C1 and C2 such that |m(ξ)−1ϕ(ξ)| ≤C1|ξ|−ε for |ξ| away from zero and
|m(ξ)−1ϕ(ξ)| ≤C2|ξ| for |ξ| near zero. These two inequalities imply that
∑
k
|m(2−kξ)−1ϕ(2−kξ)|2 ≤C3 < ∞,
from which the L2 boundedness of the operator
f →
∑
k
|Tk( f)−f ∗ϕ2−k|21/2
follows easily. Using estimate (6.3.1) and the well-known L2 estimate for the Hardy–
Littlewood maximal function, we obtain (6.3.2).
□
If m(ξ) is the characteristic function of a rectangle with sides parallel to the axes,
this result can be extended to Lp.

454
6 Littlewood–Paley Theory and Multipliers
Theorem 6.3.2. Let 1 < p < ∞and let U be the n-fold product of open intervals that
contain zero. For each k ∈Z deﬁne Tk( f)(x) = ( 1f(ξ)χU(2−kξ))∨(x). Then there is
a constant Cp,n such that for all Lp functions f on Rn we have
sup
k∈Z
|Tk( f)|

Lp(Rn) ≤Cp,n
f

Lp(Rn).
Proof. Let us ﬁx an open annulus A whose interior contains the boundary of U and
take a smooth function with compact support 1ψ that vanishes in a neighborhood of
zero and a neighborhood of inﬁnity and is equal to 1 on the annulus A. Then the
function 1ϕ = (1 −1ψ )χU is Schwartz. Since χU = χU 1ψ + 1ϕ, it follows that for all
f ∈Lp(Rn) we have
Tk( f) = Tk( f)−f ∗ϕ2−k + f ∗ϕ2−k = Tk( f ∗ψ2−k)+ f ∗ϕ2−k .
Taking the supremum over k and using Corollary 2.1.12 we obtain
sup
k∈Z
|Tk( f)| ≤
∑
k
|Tk( f)−f ∗ϕ2−k|21/2 +Cϕ M( f).
(6.3.3)
The operator Tk( f) −f ∗ϕ2−k is given by multiplication on the Fourier transform
side by the multiplier
χU(2−kξ)−1ϕ(2−kξ) = χU(2−kξ) 1ψ(2−kξ) = χ2kU(ξ) 1ψ(2−kξ).
Since {2kU}k∈Z is a measurable family of rectangles with sides parallel to the axes,
Exercise 5.6.1(b) yields the following inequality:

 ∑
k∈Z
|Tk( f)−f ∗ϕ2−k|2 1
2

Lp ≤Cp,n

 ∑
k∈Z
| f ∗ψ2−k|2 1
2

Lp .
(6.3.4)
Since f ∗ψ2−k = Δ ψ
j ( f), estimate (6.1.4) of Theorem 6.1.2 yields that the expres-
sion on the right in (6.3.4) is controlled by a multiple of ∥f∥Lp. Taking Lp norms in
(6.3.3) and using the Lp estimate for the square function yields the required conclu-
sion.
□
The following lacunary version of the Carleson–Hunt theorem is yet another in-
dication of the powerful techniques of Littlewood–Paley theory.
Corollary 6.3.3. (a) Let f be in L2(Rn) and let Ω be an open set that contains the
origin in Rn. Then
lim
k→∞

2kΩ
1f(ξ)e2πix·ξ dξ = f(x)
for almost all x ∈Rn.
(b) Let f be in Lp(Rn) for some 1 < p < ∞. Then
lim
k→∞

|ξ1|<2k
...
|ξn|<2k
1f(ξ)e2πix·ξ dξ = f(x)
for almost all x ∈Rn.

6.3 Applications of Littlewood–Paley Theory
455
Proof. Both limits exist everywhere for functions f in the Schwartz class. To obtain
almost everywhere convergence for general f in Lp we appeal to Theorem 2.1.14.
The required control of the corresponding maximal operator is a consequence of
Theorem 6.3.1 with m = χΩ in case (a) and Theorem 6.3.2 in case (b).
□
6.3.2 Estimates for Singular Integrals with Rough Kernels
We now turn to another application of the Littlewood–Paley theory involving singu-
lar integrals.
Theorem 6.3.4. Suppose that μ is a ﬁnite Borel measure on Rn with compact sup-
port that satisﬁes |1μ(ξ)| ≤Bmin

|ξ|−b,|ξ|b
for some b > 0 and all ξ ̸= 0. Deﬁne
measures μ j by setting 1μ j(ξ) = 1μ(2−jξ). Then the operator
Tμ( f)(x) = ∑
j∈Z
( f ∗μ j)(x)
is bounded on Lp(Rn) for all 1 < p < ∞.
Proof. It is natural to begin with the L2 boundedness of Tμ. The estimate on 1μ
implies that
∑
j∈Z
|1μ(2−jξ)| ≤∑
j∈Z
Bmin

|2−jξ|b,|2−jξ|−b
≤CbB < ∞.
(6.3.5)
The L2 boundedness of Tμ is an immediate consequence of (6.3.5).
We now turn to the Lp boundedness of Tμ for 1 < p < ∞. We ﬁx a radial Schwartz
function ψ whose Fourier transform is supported in the annulus 1
2 < |ξ| < 2 that
satisﬁes
∑
j∈Z
1ψ(2−jξ) = 1
(6.3.6)
whenever ξ ̸= 0. We let ψ2−k(x) = 2knψ(2kx), so that 3
ψ2−k(ξ) = 1ψ(2−kξ), and we
observe that the identity
μ j = ∑
k∈Z
μ j ∗ψ2−j−k
is valid by taking Fourier transforms and using (6.3.6). We now deﬁne operators Sk
by setting
Sk( f) = ∑
j∈Z
μ j ∗ψ2−j−k ∗f = ∑
j∈Z
(μ ∗ψ2−k)2−j ∗f .
Then for f in S we have that
Tμ( f) = ∑
j∈Z
μ j ∗f = ∑
j∈Z ∑
k∈Z
μ j ∗ψ2−j−k ∗f = ∑
k∈Z
Sk( f).

456
6 Littlewood–Paley Theory and Multipliers
It sufﬁces therefore to obtain Lp boundedness for the sum of the Sk’s. We begin
by investigating the L2 boundedness of each Sk. Since the product 
ψ2−j−k 
ψ2−j′−k is
nonzero only when j′ ∈{j −1, j, j +1}, it follows that
Sk( f)
2
L2 ≤∑
j∈Z ∑
j′∈Z

Rn | 1μ j(ξ) 2
μ j′ (ξ) 1ψ(2−j−kξ) 1ψ(2−j′−kξ)|| 1f(ξ)|2 dξ
≤C1 ∑
j∈Z
j+1
∑
j′= j−1

|ξ|≈2 j+k
| 1μ j(ξ)2
μ j′(ξ)|| 1f(ξ)|2 dξ
≤C2 ∑
j∈Z

|ξ|≈2 j+k
B2 min(|2−jξ|b,|2−jξ|−b)2| 1f(ξ)|2 dξ
≤C2
3B22−2|k|b ∑
j∈Z

|ξ|≈2 j+k
| 1f(ξ)|2 dξ
= C2
3B2 2−2|k|bf
2
L2 .
We have therefore obtained that for all k ∈Z and f ∈S (Rn) we have
Sk( f)

L2 ≤C3 B2−b|k|f

L2 .
(6.3.7)
We notice that for any R > 0 we have

R≤|x|≤2R ∑
j∈Z

μ ∗ψ2−k

2−j(x)
dx = ∑
j∈Z

2 jR≤|x|≤2 j+1R

μ ∗ψ2−k

(x)
dx
=

Rn

μ ∗ψ2−k

(x)
dx
≤
μ
∥ψ∥L1 ,
thus condition (5.3.4) of Theorem 5.3.3 is satisﬁed.
Next we verify that the kernel of each Sk satisﬁes H¨ormander’s condition with
constant at most a multiple of (1+|k|). Fix y ̸= 0. Then

|x|≥2|y|
 ∑
j∈Z

(μ ∗ψ2−k)2−j(x−y)−(μ ∗ψ2−k)2−j(x)
dx
≤∑
j∈Z

|x|≥2|y| 2jn(μ ∗ψ2−k)(2jx−2jy)−(μ ∗ψ2−k)(2jx)
dx
= ∑
j∈Z
Ij,k(y),
where
Ij,k(y) =

|x|≥2 j+1|y|
(μ ∗ψ2−k)(x−2jy)−(μ ∗ψ2−k)(x)
dx.

6.3 Applications of Littlewood–Paley Theory
457
We observe that Ij,k(y) ≤C4∥μ∥M . Let |μ| be the total variation of μ. To obtain a
more delicate estimate for Ij,k(y) we argue as follows:
Ij,k(y) ≤

|x|≥2 j+1|y|

Rn
ψ2−k(x−2jy−z)−ψ2−k(x−z)
d|μ|(z)dx
=

Rn 2kn

|x|≥2 j+1|y|
ψ(2kx−2kz−2j+ky)−ψ(2kx−2kz)
dxd|μ|(z)
≤C5

|x|≥2 j+1|y|

Rn 2kn2j+k|y|
∇ψ(2kx−2kz−θ)
d|μ|(z)dx
≤C62j+k

Rn

|x|≥2 j+1|y|
2kn|y|

1+|2kx−2kz−θ|
−n−2 dxd|μ|(z)
= C62j+k|y|

Rn

|x|≥2 j+k+1|y|

1+|x−2kz−θ|
−n−2 dxd|μ|(z),
where |θ| ≤2j+k|y|. Note that θ depends on j,k, and y. From this and from Ij,k(y) ≤
C4∥μ∥M we obtain
Ij,k(y) ≤C7
μ

M min

1,2j+k|y|

,
(6.3.8)
which is valid for all j,k, and y ̸= 0. To estimate the last double integral even more
delicately, we consider the following two cases: |x| ≥2k+2|z| and |x| < 2k+2|z|. In
the ﬁrst case we have |x −2kz −θ| ≥1
4|x|, given the fact that |x| ≥2j+k+1|y|. In
the second case we have that |x| ≤2k+2R, where B(0,R) contains the support of
μ. Applying these observations in the last double integral, we obtain the following
estimate:
Ij,k(y) ≤C82j+k|y|

Rn


|x|≥2 j+k+1|y|
|x|≥2k+2|z|
dx

1+ 1
4|x|
n+2 +

|x|≥2 j+k+1|y|
|x|<2k+2R
dx

d|μ|(z)
≤C92j+k|y|
μ

M

1
(2j+k|y|)2 +0

= C9(2j+k|y|)−1μ

M ,
provided 2j|y| ≥2R. Combining this estimate with (6.3.8), we obtain
Ij,k(y) ≤C10
μ

M

min

1,2j+k|y|

for all j,k and y,
(2j+k|y|)−1
when 2j|y| ≥2R.
(6.3.9)

458
6 Littlewood–Paley Theory and Multipliers
We now estimate ∑j Ij,k(y). When 2k ≥(2R)−1 we use (6.3.9) to obtain
∑
j
Ij,k(y) ≤C10
μ

M
/
∑
2 j≤
1
2k|y|
2j+k|y|+
∑
1
2k|y| ≤2 j≤2R
|y|
1+ ∑
2 j≥2R
|y|
(2j+k|y|)−10
≤C11
μ

M (|logR|+|k|).
Also when 2k < (2R)−1 we again use (6.3.9) to obtain
∑
j
Ij,k(y) ≤C10
μ

M
/
∑
2 j≤
1
2k|y|
2j+k|y|+ ∑
2 j≥
1
2k|y|
(2j+k|y|)−10
≤C12
μ

M ,
since in the second sum we have 2j|y| ≥2−k > 2R, which justiﬁes use of the corre-
sponding estimate in (6.3.9). This gives
∑
j
Ij,k(y) ≤C13
μ

M (1+|k|),
(6.3.10)
where the constant C13 depends on the dimension and on R. We now use esti-
mates (6.3.7) and (6.3.10) and Theorem 5.3.3 to obtain that each Sk maps L1(Rn)
to L1,∞(Rn) with constant at most
Cn(2−b|k| +1+|k|)
μ

M ≤Cn(2+|k|)
μ

M .
It follows from the Marcinkiewicz interpolation theorem (Theorem 1.3.2) that Sk
maps Lp(Rn) to itself for 1 < p < 2 with bound at most Cp,n2−b|k|θp(1 + |k|)1−θp,
when 1
p = θp
2 +1−θp. Summing over all k ∈Z, we obtain that Tμ maps Lp(Rn) to
itself for 1 < p < 2. The boundedness of Tμ for p > 2 follows by duality.
□
An immediate consequence of the previous result is the following.
Corollary 6.3.5. Suppose that μ is a ﬁnite Borel measure on Rn with compact sup-
port that satisﬁes |1μ(ξ)| ≤Bmin

|ξ|−b,|ξ|b
for some b > 0 and all ξ ̸= 0. Deﬁne
measures μ j by setting 1μ j(ξ) = 1μ(2−jξ). Then the square function
G( f) =

∑
j∈Z
|μ j ∗f|2 1
2
(6.3.11)
maps Lp(Rn) to itself whenever 1 < p < ∞.
Proof. To obtain the boundedness of the square function in (6.3.11) we use the
Rademacher functions r j(t), introduced in Appendix C.1, reindexed so that their
index set is the set of all integers (not the set of nonnegative integers). For each t we
introduce the operators
Tt
μ( f) = ∑
j∈Z
r j(t)( f ∗μ j).

6.3 Applications of Littlewood–Paley Theory
459
Next we observe that for each t in [0,1] the operators Tt
μ map Lp(Rn) to itself with
the same constant as the operator Tμ, which is in particular independent of t. Using
that the square function in (6.3.11) raised to the power p is controlled by a multiple
of the quantity
 1
0
 ∑
j∈Z
r j(t)( f ∗μ j)

p
dt ,
a fact stated in Appendix C.2, we obtain the required conclusion by integrating
over Rn.
□
6.3.3 An Almost Orthogonality Principle on Lp
Suppose that Tj are multiplier operators given by Tj( f) = ( 1fmj)∨, for some multi-
pliers mj. If the functions mj have disjoint supports and they are bounded uniformly
in j, then the operator
T = ∑
j
Tj
is bounded on L2. The following theorem gives an Lp analogue of this result.
Theorem 6.3.6. Suppose that 1 < p ≤2 ≤q < ∞. Let mj be Schwartz functions
supported in the annuli 2j−1 ≤|ξ| ≤2j+1 and let Tj( f) = ( 1fmj)∨. Suppose that the
Tj’s are uniformly bounded operators from Lp(Rn) to Lq(Rn), i.e.,
sup
j
Tj

Lp→Lq = A < ∞.
Then for each f ∈Lp(Rn), the series
T( f) = ∑
j
Tj( f)
converges in the Lq norm and there exists a constant Cp,q,n < ∞such that
T

Lp→Lq ≤Cp,q,nA.
(6.3.12)
Proof. Fix a radial Schwartz function ϕ whose Fourier transform 1ϕ is real, equal to
one on the annulus 1
2 ≤|ξ| ≤2, and vanishes outside the annulus 1
4 ≤|ξ| ≤4. We
set ϕ2−j(x) = 2jnϕ(2jx), so that 3
ϕ2−j is equal to 1 on the support of each mj. Setting
Δ j( f) = f ∗ϕ2−j, we observe that
Tj = Δ jTjΔ j
for all j ∈Z. For a positive integer N we set
T N = ∑
| j|≤N
Δ jTjΔ j .

460
6 Littlewood–Paley Theory and Multipliers
Fix f ∈Lp(Rn). Clearly for every N, T N( f) is in Lq(Rn). Using (6.1.21) we obtain
T N( f)

Lq =
 ∑
| j|≤N
Δ jTjΔ j( f)

Lq
≤C′
q

 ∑
j∈Z
|TjΔ j( f)|2 1
2

Lq
= C′
q
 ∑
j∈Z
|TjΔ j( f)|2
1
2
Lq/2
≤C′
q

∑
j∈Z
|TjΔ j( f)|2
Lq/2
 1
2
= C′
q

∑
j∈Z
TjΔ j( f)
2
Lq
 1
2 ,
where we used Minkowski’s inequality, since q/2 ≥1. Using the uniform bounded-
ness of the Tj’s from Lp to Lq, we deduce that
C′
q

∑
j∈Z
TjΔ j( f)
2
Lq
 1
2 ≤C′
q A

∑
j∈Z
Δ j( f)
2
Lp
1
2
= C′
q A

∑
j∈Z
|Δ j( f)|2
Lp/2
1
2
≤C′
q A
 ∑
j∈Z
|Δ j( f)|2
Lp/2
1
2
= C′
q A


∑
j∈Z
|Δ j( f)|2 1
2 
Lp
≤C′
qCp A
 f

Lp(Rn) ,
where we used the result of Exercise 1.1.5(b), since p ≤2, and Theorem 6.1.2. We
conclude that the operators T N are uniformly bounded from Lp(Rn) to Lq(Rn).
If 1h is compactly supported in a subset of Rn \ {0}, then the sequence T N(h)
becomes independent of N for N large enough and hence it is Cauchy in Lq. But in
view of Exercise 6.2.9, the set of all such h is dense in Lp(Rn). Combining these
two results with the uniform boundedness of the T N’s from Lp to Lq, a simple ε
3
argument gives that for all f ∈Lp the sequence T N( f) is Cauchy in Lq. Therefore,
for all f ∈Lp the sequence {T N( f)}N converges in Lq to some T( f). Fatou’s lemma
gives
T( f)

Lq ≤C′
qCp A
 f

Lp,
which proves (6.3.12).
□

6.3 Applications of Littlewood–Paley Theory
461
Exercises
6.3.1. (The g-function) Let Pt(x) = Γ ( n+1
2 )π−n+1
2 t(t2 +|x|2)−n+1
2
be the Poisson
kernel on Rn.
(a) Use Exercise 6.1.4 with Ψ(x) = ∂
∂t Pt(x)

t=1 to obtain that the operator
f →
 ∞
0 t
 ∂
∂t (Pt ∗f)(x)
2 dt
1/2
is bounded from Lp(Rn) to Lp(Rn) for 1 < p < ∞.
(b ) Use Exercise 6.1.4 with Ψ(x) = ∂kP1(x) to obtain that the operator
f →
 ∞
0 t|∂k(Pt ∗f)(x)|2 dt
1/2
is bounded from Lp(Rn) to Lp(Rn) for 1 < p < ∞.
(c) Conclude that the g-function
g( f)(x) =
 ∞
0 t|∇x,t(Pt ∗f)(x)|2 dt
1/2
is bounded from Lp(Rn) to Lp(Rn) for 1 < p < ∞.
6.3.2. Suppose that μ is a ﬁnite Borel measure on Rn with compact support that sat-
isﬁes 1μ(0) = 0 and |1μ(ξ)| ≤C|ξ|−a for some a > 0 and all ξ ̸= 0. Deﬁne measures
μ j by setting 1μ j(ξ) = 1μ(2−jξ). Show that the operator
Tμ( f)(x) = ∑
j∈Z
( f ∗μ j)(x)
is bounded from Lp(Rn) to Lp(Rn) for all 1 < p < ∞.

Hint: Use Theorem 6.3.4

6.3.3. ([50], [71]) (a) Suppose that μ is a ﬁnite Borel measure on Rn with compact
support that satisﬁes |1μ(ξ)| ≤C|ξ|−a for some a > 0 and all ξ ̸= 0. Show that the
maximal function
Mμ( f)(x) = sup
j∈Z


Rn f(x−2jy)dμ(y)

is bounded from Lp(Rn) to Lp(Rn) for all 1 < p < ∞.
(b) Let μ be the surface measure on the sphere Sn−1 when n ≥2. Conclude that the
dyadic spherical maximal function Mμ is bounded on Lp(Rn) for all 1 < p < ∞.

Hint: Part (a): Pick a C ∞
0 function ϕ on Rn with 1ϕ(0) = 1. Then the measure
σ = μ −1μ(0)ϕ satisﬁes the hypotheses of Corollary 6.3.5. Since,
Mμ( f)(x) ≤

∑
j
|(σj ∗f)(x)|21/2
+|1μ(0)|M( f)(x),

462
6 Littlewood–Paley Theory and Multipliers
it follows that Mμ is bounded on Lp(Rn) whenever 1 < p < ∞. Part (b): If μ = dσ
is surface measure on Sn−1, then |2
dσ(ξ)| ≤C|ξ|−n−1
2
(Appendices B.4 and B.7).

6.3.4. Let Ω be in Lq(Sn−1) for some 1 < q < ∞and deﬁne the absolutely continu-
ous measure
dμ(x) = Ω(x/|x|)
|x|n
χ1<|x|≤2 dx.
Show that for all a < 1/q′ we have that |1μ(ξ)| ≤C|ξ|−a. Under the additional hy-
pothesis that Ω has mean value zero, conclude that the singular integral operator
TΩ( f)(x) = p.v.

Rn
Ω(y/|y|)
|y|n
f(x−y)dy = ∑
j
f ∗μ j
is Lp bounded for all 1 < p < ∞. This provides an alternative proof of Theorem
5.2.10 under the hypothesis that Ω ∈Lq(Sn−1).
6.3.5. For a continuous function F on R deﬁne
u(F)(x) =
 ∞
0 |F(x+t)+F(x−t)−2F(x)|2 dt
t3
 1
2
.
Given f ∈L1
loc(R) we denote by Ff the indeﬁnite integral of f, that is,
Ff (x) =
 x
0 f(t)dt .
Prove that for all 1 < p < ∞there exist constants cp and Cp such that for all functions
f ∈Lp(R) we have
cp
f

Lp ≤
u(Ff )

Lp ≤Cp
f

Lp .

Hint: Let ϕ = χ[−1,0] −χ[0,1]. Then
(ϕt ∗f)(x) = 1
t

Ff (x+t)+Ff (x−t)−2Ff (x)

and the double inequality follows from parts (b) and (c) of Exercise 6.1.4.

6.3.6. Let m be a bounded function on Rn that is C 1 in a neighborhood of zero, it
satisﬁes m(0) = 1 and |m(ξ)| ≤B|ξ|−ε for all ξ ̸= 0, for some B,ε > 0. Deﬁne an
operator Tt by setting Tt( f)1(ξ) = 1f(ξ)m(tξ). Show that the maximal operator
sup
N>0
 1
N
 N
0
Tt( f)(x)
2 dt
1
2
maps L2(Rn) to itself.

6.4 Haar System, Conditional Expectation, and Martingales
463

Hint: Majorize this maximal operator by a constant multiple of the sum
M( f)(x)+
 ∞
0 |Tt( f)(x)−( f ∗ϕt)(x)|2 dt
t
 1
2 ,
where ϕ is a C ∞
0 function such that 1ϕ(0) = 1.

6.3.7. ([150]) Let 0 < β < 1 and p0 = (1 −β/2)−1. Suppose that {f j}j∈Z are L2
functions on the real line with norm at most 1. Assume that each f j is supported in
interval of length 1 and that the orthogonality relation
4
f j | fk⟩
 ≤(1 + | j −k|)−β
holds for all j,k ∈Z.
(a) Let I ⫅Z be such that for all j ∈I the functions f j are supported in a ﬁxed
interval of length 3. Show that for all p satisfying 0 < p ≤2 there is Cp,β < ∞such
that
∑
j∈I
ε j f j

Lp ≤Cp,β |I|1−β
2
whenever ε j are complex numbers with |ε j| ≤1.
(b) Under the same hypothesis as in part (a), prove that for all 0 < p < p0 there is a
constant C′
p,β < ∞such that
∑
j∈I
cj f j

Lp ≤C′
p,β

∑
j∈Z
|cj|p 1
p
for all complex-valued sequences {cj}j in ℓp.
(c) Derive the conclusion of part (b) without the assumption that the f j are sup-
ported in a ﬁxed interval of length 3.

Hint: Part (a): Pass from Lp to L2 and use the hypothesis. Part (b): Assume
∑j∈Z |cj|p = 1. For each k = 0,1,..., set Ik = {j ∈Z : 2−k−1 < |cj| ≤2−k}. Write
∑j∈Z cj f j

Lp ≤∑∞
k=0 2−k∑j∈Ik(cj2k) f j

Lp, use part (b), H¨older’s inequality, and
the fact that ∑∞
k=0 2−kp|Ik| ≤2p. Part (c): Write ∑j∈Z cj f j = ∑m∈Z Fm, where Fm is
the sum of cj f j over all j such that the support of f j meets the interval [m,m + 1].
These Fm’s are supported in [m−1,m+2] and are almost orthogonal.

6.4 The Haar System, Conditional Expectation, and Martingales
There is a very strong connection between the Littlewood–Paley operators and cer-
tain notions from probability, such as conditional expectation and martingale differ-
ence operators. The conditional expectation we are concerned with is with respect
to the increasing σ-algebra of all dyadic cubes on Rn.

464
6 Littlewood–Paley Theory and Multipliers
6.4.1 Conditional Expectation and Dyadic Martingale Differences
We recall the deﬁnition of dyadic cubes.
Deﬁnition 6.4.1. A dyadic interval in R is an interval of the form

m2−k,(m+1)2−k
where m,k are integers. A dyadic cube in Rn is a product of dyadic intervals of the
same length. That is, a dyadic cube is a set of the form
n
∏
j=1

mj2−k,(mj +1)2−k
for some integers m1,...,mn,k.
We deﬁned dyadic intervals to be closed on the left and open on the right, so that
different dyadic intervals of the same length are always disjoint sets.
Given a cube Q in Rn we denote by |Q| its Lebesgue measure and by ℓ(Q) its
side length. We clearly have |Q| = ℓ(Q)n. We introduce some more notation.
Deﬁnition 6.4.2. For k ∈Z we denote by Dk the set of all dyadic cubes in Rn whose
side length is 2−k. We also denote by D the set of all dyadic cubes in Rn. Then we
have
D =

k∈Z
Dk ,
and moreover, the σ-algebra σ(Dk) of measurable subsets of Rn formed by count-
able unions and complements of elements of Dk is increasing as k increases.
We observe the fundamental property of dyadic cubes, which clearly justiﬁes
their usefulness. Any two dyadic intervals of the same side length either are disjoint
or coincide. Moreover, either two given dyadic intervals are disjoint, or one contains
the other. Similarly, either two dyadic cubes are disjoint, or one contains the other.
Deﬁnition 6.4.3. Given a locally integrable function f on Rn, we denote by
Avg
Q
f = 1
|Q|

Q f(t)dt
the average of f over a cube Q.
The conditional expectation of a locally integrable function f on Rn with respect
to the increasing family of σ-algebras σ(Dk) generated by Dk is deﬁned as
Ek( f)(x) = ∑
Q∈Dk
(Avg
Q
f)χQ(x),

6.4 Haar System, Conditional Expectation, and Martingales
465
for all k ∈Z. We also deﬁne the dyadic martingale difference operator Dk as follows:
Dk( f) = Ek( f)−Ek−1( f),
also for k ∈Z.
Next we introduce the family of Haar functions.
Deﬁnition 6.4.4. For a dyadic interval I = [m2−k,(m + 1)2−k) we deﬁne IL =
[m2−k,(m+ 1
2)2−k) and IR = [(m+ 1
2)2−k,(m+1)2−k) to be the left and right parts
of I, respectively. The function
hI(x) = |I|−1
2 χIL −|I|−1
2 χIR
is called the Haar function associated with the interval I.
We remark that Haar functions are constructed in such a way that they have L2
norm equal to 1. Moreover, the Haar functions have the following fundamental or-
thogonality property:

R hI(x)hI′(x)dx =

0
when I ̸= I′,
1
when I = I′.
(6.4.1)
To see this, observe that the Haar functions have L2 norm equal to 1 by construction.
Moreover, if I ̸= I′, then I and I′ must have different lengths, say we have |I′| < |I|.
If I and I′ are not disjoint, then I′ is contained either in the left or in the right half of
I, on either of which hI is constant. Thus (6.4.1) follows.
We recall the notation
4
f,g
5
=

R f(x)g(x)dx
valid for square integrable functions. Under this notation, (6.4.1) can be rewritten as
4
hI,hI′5
= δI,I′, where the latter is 1 when I = I′ and zero otherwise.
6.4.2 Relation Between Dyadic Martingale Differences and Haar
Functions
We have the following result relating the Haar functions to the dyadic martingale
difference operators in dimension one.
Proposition 6.4.5. For every locally integrable function f on R and for all k ∈Z we
have the identity
Dk( f) = ∑
I∈Dk−1
4
f,hI
5
hI
(6.4.2)

466
6 Littlewood–Paley Theory and Multipliers
and also
Dk( f)
2
L2 = ∑
I∈Dk−1
4
f,hI
52.
(6.4.3)
Proof. We observe that every interval J in Dk is either an IL or an IR for some unique
I ∈Dk−1. Thus we can write
Ek( f) = ∑
J∈Dk
(Avg
J
f)χJ
= ∑
I∈Dk−1
 2
|I|

IL
f(t)dt

χIL +
 2
|I|

IR
f(t)dt

χIR

.
(6.4.4)
But we also have
Ek−1( f) = ∑
I∈Dk−1
(Avg
I
f)χI
= ∑
I∈Dk−1
 1
|I|

IL
f(t)dt + 1
|I|

IR
f(t)dt

χIL + χIR

.
(6.4.5)
Now taking the difference between (6.4.4) and (6.4.5) we obtain
Dk( f) = ∑
I∈Dk−1
 1
|I|

IL
f(t)dt

χIL −
 1
|I|

IR
f(t)dt

χIL
+
 1
|I|

IR
f(t)dt

χIR −
 1
|I|

IL
f(t)dt

χIR

,
which is easily checked to be equal to
∑
I∈Dk−1

I f(t)hI(t)dt

hI = ∑
I∈Dk−1
4
f,hI
5
hI.
Finally, (6.4.3) is a consequence of (6.4.1).
□
Theorem 6.4.6. Every function f ∈L2(Rn) can be written as
f = ∑
k∈Z
Dk( f),
(6.4.6)
where the series converges almost everywhere and in L2. We also have
f
2
L2(Rn) = ∑
k∈Z
Dk( f)
2
L2(Rn).
(6.4.7)
Moreover, when n = 1 we have the representation
f = ∑
I∈D
4
f,hI
5
hI ,
(6.4.8)

6.4 Haar System, Conditional Expectation, and Martingales
467
where the sum converges a.e. and in L2 and also
f
2
L2(R) = ∑
I∈D
4
f,hI
52 .
(6.4.9)
Proof. In view of the Lebesgue differentiation theorem, Corollary 2.1.16, given a
function f ∈L2(Rn) there is a set Nf of measure zero on Rn such that for all x ∈
Rn \Nf we have that
Avg
Qj
f →f(x)
whenever Qj is a sequence of decreasing cubes such that 
j Qj = {x}. Given x
in Rn \ Nf there exists a unique sequence of dyadic cubes Qj(x) ∈D j such that
∞
j=0 Qj(x) = {x}. Then for all x ∈Rn \Nf we have
lim
j→∞Ej( f)(x) = lim
j→∞∑
Q∈D j
(Avg
Q
f)χQ(x) = lim
j→∞Avg
Qj(x)
f = f(x).
From this we conclude that Ej( f) →f a.e. as j →∞. We also observe that since
|Ej( f)| ≤Mc( f), where Mc denotes the uncentered maximal function with respect
to cubes, we have that |Ej( f) −f| ≤2Mc( f), which allows us to obtain from the
Lebesgue dominated convergence theorem that Ej( f) →f in L2 as j →∞.
Next we study convergence of Ej( f) as j →−∞. For a given x ∈Rn and Qj(x)
as before we have that
|Ej( f)(x)| =
 Avg
Qj(x)
f
 ≤

1
|Qj(x)|

Qj(x) | f(t)|2 dt
1
2
≤2
jn
2  f

L2 ,
which tends to zero as j →−∞, since the side length of each Qj(x) is 2−j. Since
|Ej( f)| ≤Mc( f), the Lebesgue dominated convergence theorem allows us to con-
clude that Ej( f) →0 in L2 as j →−∞. To obtain the conclusion asserted in (6.4.6)
we simply observe that
N
∑
k=M
Dk( f) = EN( f)−EM−1( f) →f
in L2 and almost everywhere as N →∞and M →−∞.
To prove (6.4.7) we ﬁrst observe that we can rewrite Dk( f) as
Dk( f) = ∑
Q∈Dk
(Avg
Q
f)χQ −∑
R∈Dk−1
(Avg
R
f)χR
= ∑
R∈Dk−1

∑
Q∈Dk
Q⊆R
(Avg
Q
f)χQ −(Avg
R
f)χR


468
6 Littlewood–Paley Theory and Multipliers
= ∑
R∈Dk−1

∑
Q∈Dk
Q⊆R
(Avg
Q
f)χQ −1
2n ∑
Q∈Dk
Q⊆R
(Avg
Q
f)χR

= ∑
R∈Dk−1 ∑
Q∈Dk
Q⊆R
(Avg
Q
f)

χQ −2−nχR

.
(6.4.10)
Using this identity we obtain that for given integers k′ > k we have

Rn Dk( f)(x)Dk′( f)(x)dx
= ∑
R∈Dk−1 ∑
Q∈Dk
Q⊆R
(Avg
Q
f) ∑
R′∈Dk′−1 ∑
Q′∈Dk′
Q′⊆R′
(Avg
Q′ f)
 
χQ −2−nχR

χQ′ −2−nχR′
dx.
Since k′ > k, the last integral may be nonzero only when R′ ⫋R. If this is the case,
then R′ ⊆QR′ for some dyadic cube QR′ ∈Dk with QR′ ⫋R. See Figure 6.1.
Fig. 6.1 Picture of the cubes
R, R′, and QR′.
Then the function χQ′ −2−nχR′ is supported in the cube QR′ and the function
χQ −2−nχR is constant on any dyadic subcube Q of R (of half its side length) and in
particular is constant on QR′. Then
∑
Q′∈Dk′
Q′⊆R′

Avg
Q′ f

QR′
χQ′ −2−nχR′ dx = ∑
Q′∈Dk′
Q′⊆R′

Avg
Q′ f

|Q′|−2−n|R′|

= 0,
since |R′| = 2n|Q′|. We conclude that
4
Dk( f),Dk′( f)
5
= 0 whenever k ̸= k′, from
which we easily derive (6.4.7).
Now observe that (6.4.8) is a direct consequence of (6.4.2), and (6.4.9) is a direct
consequence of (6.4.3).
□

6.4 Haar System, Conditional Expectation, and Martingales
469
6.4.3 The Dyadic Martingale Square Function
As a consequence of identity (6.4.7), proved in the previous subsection, we obtain
that


∑
k∈Z
|Dk( f)|2 1
2 
L2(Rn) =
 f

L2(Rn) ,
(6.4.11)
which says that the dyadic martingale square function
S( f) =

∑
k∈Z
|Dk( f)|2 1
2
is L2 bounded. It is natural to ask whether there exist Lp analogues of this result, and
this is the purpose of the following theorem.
Theorem 6.4.7. For any 1 < p < ∞there exists a constant cp,n such that for every
function f in Lp(Rn) we have
1
cp′,n
f

Lp(Rn) ≤
S( f)

Lp(Rn) ≤cp,n
f

Lp(Rn) .
(6.4.12)
The lower inequality subsumes the fact that if
S( f)

Lp(Rn) < ∞, then f must be an
Lp function.
Proof. Let {r j}j be the Rademacher functions (see Appendix C.1) enumerated in
such a way that their index set is the set of integers. We rewrite the upper estimate
in (6.4.12) as
 1
0

Rn
 ∑
k∈Z
rk(ω)Dk( f)(x)

p
dxdω ≤Cp
p
f
p
Lp .
(6.4.13)
We prove a stronger estimate than (6.4.13), namely that for all ω ∈[0,1] we have

Rn
Tω( f)(x)

p
dx ≤Cp
p
f
p
Lp ,
(6.4.14)
where
Tω( f)(x) = ∑
k∈Z
rk(ω)Dk( f)(x).
In view of the L2 estimate (6.4.11), we have that the operator Tω is L2 bounded with
norm 1. We show that Tω is weak type (1,1).
To show that Tω is of weak type (1,1) we ﬁx a function f ∈L1 and α > 0. We
apply the Calder´on–Zygmund decomposition (Theorem 5.3.1) to f at height α to
write
f = g+b,
b = ∑
j

f −Avg
Qj
f

χQj ,

470
6 Littlewood–Paley Theory and Multipliers
where Qj are dyadic cubes that satisfy ∑j |Qj| ≤1
α
f

L1 and g has L2 norm at
most (2nα
 f

L1)
1
2 ; see (5.3.1). To achieve this decomposition, we apply the proof
of Theorem 5.3.1 starting with a dyadic mesh of large cubes such that |Q| ≥1
α
f

L1
for all Q in the mesh. Then we subdivide each Q in the mesh by halving each side,
and we select those cubes for which the average of f over them is bigger than α (and
thus at most 2nα). Since the original mesh consists of dyadic cubes, the stopping-
time argument of Theorem 5.3.1 ensures that each selected cube is dyadic.
We observe (and this is the key observation) that Tω(b) is supported in 
j Qj. To
see this, we use identity (6.4.10) to write Tω(b) as
∑
j

∑
k
rk(ω) ∑
R∈Dk−1 ∑
Q∈Dk
Q⊆R
Avg
Q
[( f −Avg
Qj
f)χQj]

χQ −2−nχR

.
(6.4.15)
We consider the following three cases for the cubes Q that appear in the inner sum in
(6.4.15): (i) Qj ⊆Q, (ii) Qj ∩Q = /0, and (iii) Q ⫋Qj. It is simple to see that in cases
(i) and (ii) we have AvgQ[( f −AvgQj f)χQj] = 0. Therefore the inner sum in (6.4.15)
is taken over all Q that satisfy Q ⫋Qj. But then we must have that the unique dyadic
parent R of Q is also contained in Qj. It follows that the expression inside the square
brackets in (6.4.15) is supported in R and therefore in Qj. We conclude that Tω(b)
is supported in 
j Qj. Using Exercise 5.3.5(a) we obtain that Tω is weak type (1,1)
with norm at most
α
{|Tω(g)| > α
2 }
+α

j Qj

∥f∥L1
≤
α4α−2∥g∥2
L2 +∥f∥L1
∥f∥L1
≤2n+2 +1.
We have now established that Tω is weak type (1,1). Since Tω is L2 bounded with
norm 1, it follows by interpolation that Tω is Lp bounded for all 1 < p < 2. The
Lp boundedness of Tω for the remaining p > 2 follows by duality. (Note that the
operators Dk and Ek are self-transpose.) We conclude the validity of (6.4.14), which
implies that of (6.4.13). As observed, this is equivalent to the upper estimate in
(6.4.12).
Finally, we notice that the lower estimate in (6.4.12) is a consequence of the
upper estimate as in the case of the Littlewood–Paley operators Δ j. Indeed, we need
to observe that in view of (6.4.6) we have
4
f,g
5 =
4∑
k
Dk( f),∑
k′
Dk′(g)
5
=
∑
k ∑
k′
4
Dk( f),Dk′(g)
5
=
∑
k
4
Dk( f),Dk(g)
5
[Exercise 6.4.6(a)]
≤

Rn∑
k
|Dk( f)(x)||Dk(g)(x)|dx

6.4 Haar System, Conditional Expectation, and Martingales
471
≤

Rn S( f)(x)S(g)(x)dx
(Cauchy–Schwarz inequality)
≤
S( f)

Lp
S(g)

Lp′
(H¨older’s inequality)
≤
S( f)

Lp cp′,n
g

Lp′ .
Taking the supremum over all functions g on Rn with Lp′ norm at most 1, we obtain
that f gives rise to a bounded linear functional on Lp′. It follows by the Riesz repre-
sentation theorem that f must be an Lp function that satisﬁes the lower estimate in
(6.4.12).
□
6.4.4 Almost Orthogonality Between the Littlewood–Paley
Operators and the Dyadic Martingale Difference Operators
Next, we discuss connections between the Littlewood–Paley operators Δ j and the
dyadic martingale difference operators Dk. It turns out that these operators are al-
most orthogonal in the sense that the L2 operator norm of the composition DkΔ j
decays exponentially as the indices j and k get farther away from each other.
For the purposes of the next theorem we deﬁne the Littlewood–Paley operators
Δ j as convolution operators with the function Ψ2−j, where
1
Ψ(ξ) = 1Φ(ξ)−1Φ(2ξ)
and Φ is a ﬁxed radial Schwartz function whose Fourier transform 1Φ is real-valued,
supported in the ball |ξ| < 2, and equal to 1 on the ball |ξ| < 1. In this case we
clearly have the identity
∑
j∈Z
1
Ψ(2−jξ) = 1,
ξ ̸= 0.
Then we have the following theorem.
Theorem 6.4.8. There exists a constant C such that for every k, j in Z the following
estimate on the operator norm of DkΔ j : L2(Rn) →L2(Rn) is valid:
DkΔ j

L2(Rn)→L2(Rn) =
Δ jDk

L2(Rn)→L2(Rn) ≤C2−1
2 | j−k|.
(6.4.16)
Proof. Since Ψ is a radial function, it follows that Δ j is equal to its transpose oper-
ator on L2. Moreover, the operator Dk is also equal to its transpose. Thus
(DkΔ j)t = Δ jDk
and it therefore sufﬁces to prove only that
DkΔ j

L2→L2 ≤C2−1
2 | j−k| .
(6.4.17)

472
6 Littlewood–Paley Theory and Multipliers
By a simple dilation argument it sufﬁces to prove (6.4.17) when k = 0. In this
case we have the estimate
D0Δ j

L2→L2 =
E0Δ j −E−1Δ j

L2→L2
≤
E0Δ j −Δ j

L2→L2 +
E−1Δ j −Δ j

L2→L2 ,
and since the Dk’s and Δ j’s are self-transposes, we have
D0Δ j

L2→L2 =
Δ jD0

L2→L2 =
Δ jE0 −Δ jE−1

L2→L2
≤
Δ jE0 −E0

L2→L2 +
Δ jE−1 −E0

L2→L2.
Estimate (6.4.17) when k = 0 will be a consequence of the pair of inequalities
E0Δ j −Δ j

L2→L2 +
E−1Δ j −Δ j

L2→L2 ≤C2
j
2 for j ≤0,
(6.4.18)
Δ jE0 −E0

L2→L2 +
Δ jE−1 −E0

L2→L2 ≤C2−1
2 j for j ≥0.
(6.4.19)
We start by proving (6.4.18). We consider only the term E0Δ j −Δ j, since the term
E−1Δ j −Δ j is similar. Let f ∈L2(Rn). Then
E0Δ j( f)−Δ j( f)
2
L2
= ∑
Q∈D0
 f ∗Ψ2−j −Avg
Q
( f ∗Ψ2−j)
2
L2(Q)
≤∑
Q∈D0

Q

Q |( f ∗Ψ2−j)(x)−( f ∗Ψ2−j)(t)|2 dt dx
≤3 ∑
Q∈D0

Q

Q

5√nQ | f(y)||Ψ2−j(x−y)|dy
2
dt dx
+3 ∑
Q∈D0

Q

Q

5√nQ | f(y)||Ψ2−j(t −y)|dy
2
dt dx
+3 ∑
Q∈D0

Q

Q

(5√nQ)c | f(y)|2jn+ j|∇Ψ(2j(ξx,t −y))|dy
2
dt dx,
where ξx,t lies on the line segment joining x and t. Applying the Cauchy-Schwarz
inequality to the ﬁrst two terms, we see that the last expression is bounded by
C2jn ∑
Q∈D0

5√nQ | f(y)|2 dy+CM22 j ∑
Q∈D0

Q

Rn
2jn| f(y)|dy
(1+2j|x−y|)M
2
dx,
which is clearly controlled by C(2jn+22 j)∥f∥2
L2 ≤2C2j∥f∥2
L2. This proves (6.4.18).
We now turn to the proof of (6.4.19). We set Sj = ∑k≤j Δk. Since Δ j is the differ-
ence of two Sj’s, it sufﬁces to prove (6.4.19), where Δ j is replaced by Sj. We work
only with the term SjE0 −E0, since the other term can be treated similarly. We have

6.4 Haar System, Conditional Expectation, and Martingales
473
SjE0( f)−E0( f)
2
L2 =
 ∑
Q∈D0
(Avg
Q
f)(Φ2−j ∗χQ −χQ)

2
L2
≤2
 ∑
Q∈D0
(Avg
Q
f)(Φ2−j ∗χQ −χQ)χ5√nQ

2
L2
+2
 ∑
Q∈D0
(Avg
Q
f)(Φ2−j ∗χQ)χ(5√nQ)c

2
L2.
Since the functions appearing inside the sum in the ﬁrst term have supports with
bounded overlap, we obtain
 ∑
Q∈D0
(Avg
Q
f)(Φ2−j ∗χQ −χQ)χ5√nQ

2
L2 ≤C ∑
Q∈D0
(Avg
Q
| f|)2Φ2−j ∗χQ −χQ
2
L2,
and the crucial observation is that
Φ2−j ∗χQ −χQ
2
L2 ≤C2−j,
a consequence of Plancherel’s identity and the fact that |1 −1Φ(2−jξ)| ≤χ|ξ|≥2 j.
Putting these observations together, we deduce
 ∑
Q∈D0
(Avg
Q
f)(Φ2−j ∗χQ −χQ)χ3Q

2
L2 ≤C ∑
Q∈D0
(Avg
Q
| f|)22−j ≤C2−jf
2
L2,
and the required conclusion will be proved if we can show that
 ∑
Q∈D0
(Avg
Q
f)(Φ2−j ∗χQ)χ(3Q)c

2
L2 ≤C2−jf
2
L2.
(6.4.20)
We prove (6.4.20) by using an estimate based purely on size. Let cQ be the center of
the dyadic cube Q. For x /∈3Q we have the estimate
|(Φ2−j ∗χQ)(x)| ≤
CM2jn
(1+2j|x−cQ|)M ≤
CM2jn
(1+2j)M/2
1
(1+|x−cQ|)M/2 ,
since both 2j ≥1, and |x−cQ| ≥1. We now control the left-hand side of (6.4.20) by
2j(2n−M) ∑
Q∈D0 ∑
Q′∈D0
(Avg
Q
| f|)(Avg
Q′ | f|)

Rn
CM dx
(1+|x−cQ|)
M
2 (1+|x−cQ′|)
M
2
≤2j(2n−M) ∑
Q∈D0 ∑
Q′∈D0
(Avg
Q
| f|)(Avg
Q′ | f|)
(1+|cQ −cQ′|)
M
4

Rn
CM dx
(1+|x−cQ|)
M
4 (1+|x−cQ′|)
M
4
≤2j(2n−M) ∑
Q∈D0 ∑
Q′∈D0
CM
(1+|cQ −cQ′|)
M
4

Q | f(y)|2 dy+

Q′ | f(y)|2 dy


474
6 Littlewood–Paley Theory and Multipliers
≤CM2j(2n−M) ∑
Q∈D0

Q | f(y)|2 dy
= CM2j(2n−M)f
2
L2.
By taking M large enough, we obtain (6.4.20) and thus (6.4.19).
□
Exercises
6.4.1. (a) Prove that no dyadic cube in Rn contains the point 0 in its interior.
(b) Prove that every interval [a,b] is contained in the union of three dyadic intervals
of length less than b−a.
(c) Prove that every cube of length l in Rn is contained in the union of 3n dyadic
cubes, each having length less than l.
6.4.2. Let k ∈Z. Show that the set [m2−k,(m + s)2−k) is a dyadic interval if and
only if s = 2p for some p ∈Z and m is an integer multiple of s.
6.4.3. Given a cube Q in Rn of side length ℓ(Q) ≤2k−1 for some integer k, prove
that there is a dyadic cube DQ of side length 2k such that Q ⫅σ + DQ for some
σ = (σ1,...,σn), where σj ∈{0,1/3,−1/3}.
6.4.4. Show that the martingale maximal function f →supk∈Z |Ek( f)| is weak type
(1,1) with constant at most 1.

Hint: Use Exercise 2.1.12.

6.4.5. (a) Show that EN( f) →f a.e. as N →∞for all f ∈L1
loc(Rn).
(b) Prove that EN( f) →f in Lp as N →∞for all f ∈Lp(Rn) whenever 1 < p < ∞.
6.4.6. (a) Let k,k′ ∈Z be such that k ̸= k′. Show that for functions f and g in L2(Rn)
we have
4
Dk( f),Dk′(g)
5
= 0.
(b) Conclude that for functions f j in L2(Rn) we have
 ∑
j∈Z
Dj( f j)

L2(Rn) =

∑
j∈Z
Dj( f j)
2
L2(Rn)
 1
2 .
(c) Let Δ j and C be as in the statement of Theorem 6.4.8. Show that for any r ∈Z
we have
 ∑
j∈Z
DjΔ j+rDj

L2(Rn)→L2(Rn) ≤C2−1
2 |r| .
6.4.7. ([133]) Let Dj, Δ j be as in Theorem 6.4.8.
(a) Prove that the operator
Vr = ∑
j∈Z
DjΔ j+r
is bounded from L2(Rn) to itself with norm at most a multiple of 2−1
2 |r|.

6.5 The Spherical Maximal Function
475
(b) Show that Vr is Lp(Rn) bounded for all 1 < p < ∞with a constant depending
only on p and n.
(c) Conclude that for each 1 < p < ∞there is a constant cp > 0 such that Vr is
bounded on Lp(Rn) with norm at most a multiple of 2−cp |r|.

Hint: Part (a): Write Δ j = Δ j #Δ j, where #Δ j is another family of Littlewood–Paley
operators and use Exercise 6.4.6 (b). Part (b): Use duality and (6.1.21).

6.5 The Spherical Maximal Function
In this section we discuss yet another consequence of the Littlewood–Paley theory,
the boundedness of the spherical maximal operator.
6.5.1 Introduction of the Spherical Maximal Function
We denote throughout this section by dσ the normalized Lebesgue measure on the
sphere Sn−1. For f in Lp(Rn), 1 ≤p ≤∞, we deﬁne the maximal operator
M ( f)(x) = sup
t>0


Sn−1 f(x−tθ)dσ(θ)

(6.5.1)
and we observe that by Minkowski’s integral inequality each expression inside the
supremum in (6.5.1) is well deﬁned for f ∈Lp for almost all x ∈Rn. The operator
M is called the spherical maximal function. It is unclear at this point for which
functions f we have M ( f) < ∞a.e. and for which values of p < ∞the maximal
inequality
M ( f)

Lp(Rn) ≤Cp
f

Lp(Rn)
(6.5.2)
holds for all functions f ∈Lp(Rn).
Spherical averages often make their appearance as solutions of partial differential
equations. For instance, the spherical average
u(x,t) = 1
4π

S2 t f(x−ty)dσ(y)
(6.5.3)
is a solution of the wave equation
Δx(u)(x,t) = ∂2u
∂t2 (x,t),
u(x,0) = 0,
∂u
∂t (x,0) = f(x),

476
6 Littlewood–Paley Theory and Multipliers
in R3. The introduction of the spherical maximal function is motivated by the fact
that the related spherical average
u(x,t) = 1
4π

S2 f(x−ty)dσ(y)
(6.5.4)
solves Darboux’s equation
Δx(u)(x,t) = ∂2u
∂t2 (x,t)+ 2
t
∂u
∂t (x,t),
u(x,0) = f(x),
∂u
∂t (x,0) = 0,
in R3. It is rather remarkable that the Fourier transform can be used to study almost
everywhere convergence for several kinds of maximal averaging operators such as
the spherical averages in (6.5.4). This is achieved via the boundedness of the cor-
responding maximal operator; the maximal operator controlling the averages over
Sn−1 is given in (6.5.1).
Before we begin the analysis of the spherical maximal function, we recall that
2
dσ(ξ) =
2π
|ξ|
n−2
2
J n−2
2 (2π|ξ|),
as shown in Appendix B.4. Using the estimates in Appendices B.6 and B.7 and the
identity
d
dt Jν(t) = 1
2(Jν−1(t)−Jν+1(t))
derived in Appendix B.2, we deduce the crucial estimate
|2
dσ(ξ)|+|∇2
dσ(ξ)| ≤
Cn
(1+|ξ|)
n−1
2
.
(6.5.5)
Theorem 6.5.1. Let n ≥3. For each
n
n−1 < p ≤∞, there is a constant Cp such that
M ( f)

Lp(Rn) ≤Cp
f

Lp(Rn)
(6.5.6)
holds for all f in Lp(Rn). Consequently, for all
n
n−1 < p ≤∞and f ∈Lp(Rn) we
have
lim
t→0
1
ωn−1

Sn−1 f(x−tθ)dσ(θ) = f(x)
(6.5.7)
for almost all x ∈Rn. Here we set ωn−1 = |Sn−1|.

6.5 The Spherical Maximal Function
477
The proof of this theorem is given in the rest of this section. Before we present the
proof we explain the validity of (6.5.7). Clearly this assertion is valid for functions
f ∈S (Rn). Using inequality (6.5.6) and Theorem 2.1.14 we obtain that (6.5.7) holds
for all functions in f ∈Lp(Rn).
We now focus on (6.5.6). Deﬁne m(ξ) = 2
dσ(ξ) and notice that m(ξ) is a C ∞
function. To study the maximal multiplier operator
sup
t>0
 1f(ξ)m(tξ)
∨
we decompose the multiplier m(ξ) into radial pieces as follows: We ﬁx a radial C ∞
function ϕ0 in Rn such that ϕ0(ξ) = 1 when |ξ| ≤1 and ϕ0(ξ) = 0 when |ξ| ≥2.
For j ≥1 we let
ϕj(ξ) = ϕ0(2−jξ)−ϕ0(21−jξ)
(6.5.8)
and we observe that ϕj(ξ) is localized near |ξ| ≈2j. Then we have
∞
∑
j=0
ϕj = 1.
Set mj = ϕjm for all j ≥0. The mj’s are C ∞
0 functions that satisfy
m =
∞
∑
j=0
mj .
Also, the following estimate is valid:
M ( f) ≤
∞
∑
j=0
M j( f),
where
M j( f)(x) = sup
t>0
 1f(ξ)mj(tξ)
∨(x)
.
Since the function m0 is C ∞
0 , we have that M0 maps Lp to itself for all 1 < p ≤∞.
(See Exercise 6.5.1.)
We deﬁne g-functions associated with mj as follows:
Gj( f)(x) =
 ∞
0 |Aj,t( f)(x)|2 dt
t
1
2
,
where Aj,t( f)(x) =
 1f(ξ)mj(tξ)
∨(x).

478
6 Littlewood–Paley Theory and Multipliers
6.5.2 The First Key Lemma
We have the following lemma:
Lemma 6.5.2. There is a constant C = C(n) < ∞such that for any j ≥1 we have
the estimate
M j( f)

L2 ≤C2( 1
2 −n−1
2 ) jf

L2
for all functions f in L2(Rn).
Proof. We deﬁne a function
#mj(ξ) = ξ ·∇mj(ξ),
we let #Aj,t( f)(x) =
 1f(ξ) #mj(tξ)
∨(x), and we let
#Gj( f)(x) =
 ∞
0 |#Aj,t( f)(x)|2 dt
t
1
2
be the associated g-function. For f ∈L2(Rn), the identity
s dAj,s
ds ( f) = #Aj,s( f)
is clearly valid for all j and s. Since Aj,s( f) = f ∗(m∨
j )s and m∨
j has integral zero for
j ≥1 (here (m∨
j )s(x) = s−nm∨
j (s−1x)), it follows from Corollary 2.1.19 that
lim
s→0Aj,s( f)(x) = 0
for all x ∈Rn \Ef , where Ef is some set of Lebesgue measure zero. By the funda-
mental theorem of calculus for x ∈Rn \Ef we deduce that
(Aj,t( f)(x))2 =
 t
0
d
ds(Aj,s( f)(x))2 ds
= 2
 t
0 Aj,s( f)(x)sdAj,s
ds ( f)(x) ds
s
= 2
 t
0 Aj,s( f)(x)#Aj,s( f)(x) ds
s ,
from which we obtain the estimate
Aj,t( f)(x)
2 ≤2
 ∞
0
Aj,s( f)(x)
#Aj,s( f)(x)
 ds
s .
(6.5.9)

6.5 The Spherical Maximal Function
479
Taking the supremum over all t > 0 on the left-hand side in (6.5.9) and integrating
over Rn, we obtain the estimate
M j( f)
2
L2 ≤2

Rn
 ∞
0
Aj,s( f)(x)
#Aj,s( f)(x)
 ds
s dx
≤2

Rn Gj( f)(x) #Gj( f)(x)dx
≤2
Gj( f)

L2
 #Gj( f)

L2 ,
by applying the Cauchy–Schwarz inequality twice. Next we claim that as a conse-
quence of (6.5.5) we have for some c,#c < ∞,
mj

L∞≤c2−j n−1
2
and
#mj

L∞≤#c2j(1−n−1
2 ) .
Using these facts together with the facts that the functions mj and #mj are sup-
ported in the annuli 2 j−1 ≤|ξ| ≤2j+1, we obtain that the g-functions Gj and #Gj
are L2 bounded with norms at most a constant multiple of the quantities 2−j n−1
2 and
2j(1−n−1
2 ), respectively; see Exercise 6.5.2. Note that since n ≥3, both exponents are
negative. We conclude that
M j( f)

L2 ≤C2j( 1
2 −n−1
2 )f

L2 ,
which is what we needed to prove.
□
6.5.3 The Second Key Lemma
Next we need the following lemma.
Lemma 6.5.3. There exists a constant C = C(n) < ∞such that for all j ≥1 and for
all f in L1(Rn) we have
M j( f)

L1,∞≤C2jf

L1 .
Proof. Let K( j) = (ϕj)∨∗dσ = Φ2−j ∗dσ, where Φ is a Schwartz function. Setting
(K( j))t(x) = t−nK( j)(t−1x)
we have that
M j( f) = sup
t>0
|(K( j))t ∗f|.
(6.5.10)
The proof of the lemma is based on the estimate:
M j( f) ≤C2j M( f)
(6.5.11)

480
6 Littlewood–Paley Theory and Multipliers
and the weak type (1,1) boundedness of the Hardy–Littlewood maximal operator M
(Theorem 2.1.6). To establish (6.5.11), it sufﬁces to show that for any M > n there is
a constant CM < ∞such that
|K( j)(x)| = |(Φ2−j ∗dσ)(x)| ≤
CM 2j
(1+|x|)M .
(6.5.12)
Then Theorem 2.1.10 yields (6.5.11) and hence the required conclusion.
Using the fact that Φ is a Schwartz function, we have for every N > 0,
|(Φ2−j ∗dσ)(x)| ≤CN

Sn−1
2n j dσ(y)
(1+2j|x−y|)N .
We pick an N to depend on M (6.5.12); in fact, any N > M sufﬁces for our purposes.
We split the last integral into the regions
S−1(x) = Sn−1 ∩{y ∈Rn : 2j|x−y| ≤1}
and for r ≥0,
Sr(x) = Sn−1 ∩{y ∈Rn : 2r < 2j|x−y| ≤2r+1}.
The key observation is that whenever B(y,R) is a ball of radius R in Rn centered at
y ∈Sn−1, then the spherical measure of the set Sn−1 ∩B(y,R) is at most a dimen-
sional constant multiple of Rn−1. This implies that the spherical measure of each
Sr(x) is at most cn2(r+1−j)(n−1), an estimate that is useful only when r ≤j. Using
this observation, together with the fact that for y ∈Sr(x) we have |x| ≤2r+1−j + 1,
we obtain the following estimate for the expression |(Φ2−j ∗dσ)(x)|:
j
∑
r=−1

Sr(x)
CN2n j dσ(y)
(1+2j|x−y|)N +
∞
∑
r= j+1

Sr(x)
CN2n j dσ(y)
(1+2j|x−y|)N
≤C′
N2n j

j
∑
r=−1
dσ(Sr(x))χB(0,3)(x)
2rN
+
∞
∑
r= j+1
dσ(Sr(x))χB(0,2r+1−j+1)(x)
2rN

≤C′
N2n j

j
∑
r=−1
cn2(r+1−j)(n−1)χB(0,3)(x)
2rN
+
∞
∑
r= j+1
ωn−1 χB(0,2r+2−j)(x)
2rN

≤CN,n

2jχB(0,3)(x)+2n j
∞
∑
r= j+1
1
2rN
(1+2r+2−j)M
(1+|x|)M

≤C′
M,n
2j
(1+|x|)M

1+
∞
∑
r= j+1
2(r−j)(M−N)
2j(N+1−n)

≤
C′′
M,n2j
(1+|x|)M ,
where we used that N > M > n. This establishes (6.5.12).
□

6.5 The Spherical Maximal Function
481
6.5.4 Completion of the Proof
It remains to combine the previous ingredients to complete the proof of the theorem.
Interpolating between the L2 →L2 and L1 →L1,∞estimates obtained in Lemmas
6.5.2 and 6.5.3, we obtain
M j( f)

Lp(Rn) ≤Cp2( n
p −(n−1)) j f

Lp(Rn)
for all 1 < p ≤2. When p >
n
n−1 the series ∑∞
j=1 2( n
p −(n−1)) j converges and we
conclude that M is Lp bounded for these p’s. The boundedness of M on Lp for
p > 2 follows by interpolation between Lq for q < 2 and the estimate M : L∞→L∞.
Exercises
6.5.1. Let m be in L1(Rn)∩L∞(Rn) that satisﬁes |m∨(x)| ≤C(1+|x|)−n−δ for some
δ > 0. Show that the maximal multiplier
Mm( f)(x) = sup
t>0
 1f(ξ)m(tξ)
∨(x)

is Lp bounded for all 1 < p < ∞.
6.5.2. Suppose that the function m is supported in the annulus R ≤|ξ| ≤2R and is
bounded by A. Show that the g-function
G( f)(x) =
 ∞
0 |(m(tξ) 1f(ξ))∨(x)|2 dt
t
1
2
maps L2(Rn) to L2(Rn) with bound at most A√log2.
6.5.3. ([302]) Let A,a,b > 0 with a+b > 1. Use the idea of Lemma 6.5.2 to show
that if m(ξ) satisﬁes |m(ξ)| ≤A(1 + |ξ|)−a and |∇m(ξ)| ≤A(1 + |ξ|)−b for all
ξ ∈Rn, then the maximal operator
Mm( f)(x) = sup
t>0
 1f(ξ)m(tξ)
∨(x)

is bounded from L2(Rn) to itself.

Hint: Use that
Mm ≤
∞
∑
j=0
Mm, j ,
where Mm, j corresponds to the multiplier ϕjm; here ϕj is as in (6.5.8). Show that
Mm, j( f)

L2 ≤C
ϕjm

1
2
L∞
ϕj #m

1
2
L∞
 f

L2 ≤C2j 1−(a+b)
2
f

L2,
where #m(ξ) = ξ ·∇m(ξ).


482
6 Littlewood–Paley Theory and Multipliers
6.5.4. Let A,c > 0, a > 1/2, 0 < b < n. Follow the idea of the proof of Theorem
6.5.1 to obtain the following more general result: If dμ is a ﬁnite Borel measure
supported in the closed unit ball that satisﬁes |2
dμ(ξ)| ≤A(1+|ξ|)−a for all ξ ∈Rn
and dμ(B(y,R)) ≤cRb for all R > 0, then the maximal operator
f →sup
t>0


Rn f(x−ty)dμ(y)

maps Lp(Rn) to itself when p > 2n−2b+2a−1
n−b+2a−1 .

Hint: Using the notation of the preceding exercise, show that ∥Mm, j( f)∥L2 ≤
C2j( 1
2 −a)∥f∥L2 and that ∥Mm, j( f)∥L1,∞≤C2j(n−b)∥f∥L1 for all j ∈Z+, where C
is a constant depending on the given parameters.

6.5.5. Show that Theorem 6.5.1 is false when n = 1, that is, show that the maximal
operator
M1( f)(x) = sup
t>0
| f(x+t)+ f(x−t)|
2
is unbounded on Lp(R) for all p < ∞.
6.5.6. Show that when n ≥2 and p ≤
n
n−1 there exists an Lp(Rn) function f such
that M ( f)(x) = ∞for all x ∈Rn. Hence Theorem 6.5.1 is false is this case.

Hint: Choose a compactly supported and radial function equal to |y|1−n(−log|y|)−1
when |y| ≤1/2.

6.6 Wavelets and Sampling
In this section we construct orthonormal bases of L2(R) generated by translations
and dilations of a single function. An example of such base is given by the Haar
functions we encountered in Section 6.4. The Haar functions are generated by in-
teger translations and dyadic dilations of the single function χ[0, 1
2 ) −χ[ 1
2 ,1). This
function is not smooth, and the main question addressed in this section is whether
there exist smooth analogues of the Haar functions.
Deﬁnition 6.6.1. A square integrable function ϕ on Rn is called a wavelet if the
family of functions
ϕν,k(x) = 2
νn
2 ϕ(2νx−k),
where ν ranges over Z and k over Zn, is an orthonormal basis of L2(Rn). This
means that the functions ϕν,k are mutually orthogonal and span L2(Rn), and ϕ is
normalized to have L2 norm equal to 1. Note that the Fourier transform of ϕν,k is
given by
3
ϕν,k(ξ) = 2−νn
2 1ϕ(2−νξ)e−2πi2−νξ·k .
(6.6.1)

6.6 Wavelets and Sampling
483
Rephrasing the question posed earlier, the main issue addressed in this section is
whether smooth wavelets actually exist. Before we embark on this topic, we recall
that we have already encountered examples of nonsmooth wavelets.
Example 6.6.2. (The Haar wavelet) Recall the family of functions
hI(x) = |I|−1
2 (χIL −χIR),
where I ranges over D (the set of all dyadic intervals) and IL is the left part of I and
IR is the right part of I. Note that if I = [2−νk,2−ν(k +1)), then
hI(x) = 2
ν
2 ϕ(2νx−k),
where
ϕ(x) = χ[0, 1
2 ) −χ[ 1
2 ,1) .
(6.6.2)
The single function ϕ in (6.6.2) therefore generates the Haar basis by taking trans-
lations and dilations. Moreover, we observed in Section 6.4 that the family {hI}I is
orthonormal. Moreover, in Theorem 6.4.6 we obtained the representation
f = ∑
I∈D
4
f,hI
5
hI
in L2 ,
which proves the completeness of the system {hI}I∈D in L2(R).
6.6.1 Some Preliminary Facts
Before we look at more examples, we make some observations. We begin with the
following useful fact.
Proposition 6.6.3. Let g ∈L1(Rn). Then
1g(m) = 0
for all m ∈Zn \{0}
if and only if
∑
k∈Zn
g(x+k) =

Rn g(t)dt
for almost all x ∈Tn.
Proof. We deﬁne the periodic function
G(x) = ∑
k∈Zn
g(x+k),

484
6 Littlewood–Paley Theory and Multipliers
which is easily shown to be in L1(Tn). Moreover, we have
1G(m) = 1g(m)
for all m ∈Zn, where 1G(m) denotes the mth Fourier coefﬁcient of G and 1g(m) de-
notes the Fourier transform of g at ξ = m. If 1g(m) = 0 for all m ∈Zn \ {0}, then
all the Fourier coefﬁcients of G (except for m = 0) vanish, which means that the
sequence { 1G(m)}m∈Zn lies in ℓ1(Zn) and hence Fourier inversion applies. We con-
clude that for almost all x ∈Tn we have
G(x) = ∑
m∈Zn
1G(m)e2πim·x = 1G(0) = 1g(0) =

Rn g(t)dt .
Conversely, if G is a constant, then 1G(m) = 0 for all m ∈Zn \{0}, and so the same
holds for g.
□
A consequence of the preceding proposition is the following.
Proposition 6.6.4. Let ϕ ∈L2(Rn). Then the sequence
{ϕ(x−k)}k∈Zn
(6.6.3)
forms an orthonormal set in L2(Rn) if and only if
∑
k∈Zn
|1ϕ(ξ +k)|2 = 1
(6.6.4)
for almost all ξ ∈Rn.
Proof. Observe that either (6.6.4) or the hypothesis that the sequence in (6.6.3) is
orthonormal implies that ∥ϕ∥L2 = 1. Also the orthonormality condition

Rn ϕ(x−j)ϕ(x−k)dx =

1
when j = k,
0
when j ̸= k,
is equivalent to

Rn e−2πik·ξ 1ϕ(ξ)e−2πi j·ξ 1ϕ(ξ)dξ = (|1ϕ|2)1(k −j) =

1
when j = k,
0
when j ̸= k,
in view of Parseval’s identity. Proposition 6.6.3 with g(ξ) = |1ϕ(ξ)|2 gives that the
latter is equivalent to
∑
k∈Zn
|1ϕ(ξ +k)|2 =

Rn |1ϕ(t)|2 dt = 1
for almost all ξ ∈Rn.
□

6.6 Wavelets and Sampling
485
Corollary 6.6.5. Let ϕ ∈L2(Rn) and suppose that the sequence
{ϕ(x−k)}k∈Zn
(6.6.5)
forms an orthonormal set in L2(Rn). Then the measure of the support of 1ϕ is at least
1, that is,
|supp 1ϕ| ≥1.
(6.6.6)
Moreover, if |supp 1ϕ| = 1, then |1ϕ(ξ)| = 1 for almost all ξ ∈supp 1ϕ.
Proof. It follows from (6.6.4) that |1ϕ| ≤1 for almost all ξ ∈Rn and thus
|supp 1ϕ| ≥

Rn |1ϕ(ξ)|2 dξ =

[0,1)n ∑
k∈Zn
|1ϕ(ξ +k)|2 dξ =

[0,1)n 1dξ = 1.
If equality holds in (6.6.6), then equality holds in the preceding inequality, and since
|1ϕ| ≤1 a.e., it follows that |1ϕ(ξ)| = 1 for almost all ξ in supp 1ϕ.
□
6.6.2 Construction of a Nonsmooth Wavelet
Having established these preliminary facts, we now start searching for examples of
wavelets. It follows from Corollary 6.6.5 that the support of the Fourier transform of
a wavelet must have measure at least 1. It is reasonable to ask whether this support
can have measure exactly 1. Example 6.6.6 indicates that this can indeed happen. As
dictated by the same corollary, the Fourier transform of such a wavelet must satisfy
|1ϕ(ξ)| = 1 for almost all ξ ∈supp 1ϕ, so it is natural to look for a wavelet ϕ such
that 1ϕ = χA for some set A. We can start by asking whether the function
1ϕ = χ[−1
2 , 1
2 ]
on R is an appropriate Fourier transform of a wavelet, but a moment’s thought shows
that the functions ϕμ,0 and ϕν,0 cannot be orthogonal to each other when μ ̸= 0.
The problem here is that the Fourier transforms of the functions ϕν,k cluster near
the origin and do not allow for the needed orthogonality. We can ﬁx this problem
by considering a function whose Fourier transform vanishes near the origin. Among
such functions, a natural candidate is
χ[−1,−1
2 ) + χ[ 1
2 ,1) ,
(6.6.7)
which is indeed the Fourier transform of a wavelet.
Example 6.6.6. Let A = [−1,−1
2)[ 1
2,1) and deﬁne a function ϕ on R by setting
1ϕ = χA .

486
6 Littlewood–Paley Theory and Multipliers
Then we assert that the family of functions
{ϕν,k(x)}k∈Z,ν∈Z = {2ν/2ϕ(2νx−k)}k∈Z,ν∈Z
is an orthonormal basis of L2(R) (i.e., the function ϕ is a wavelet). This is an exam-
ple of a wavelet with minimally supported frequency.
To verify this assertion, ﬁrst note that {ϕ0,k}k∈Z is an orthonormal set, since
(6.6.4) is easily seen to hold. Dilating by 2ν, it follows that {ϕν,k}k∈Z is also an
orthonormal set for every ﬁxed ν ∈Z. Next, observe that if μ ̸= ν, then
supp 3
ϕν,k ∩supp 3
ϕμ,l = /0.
(6.6.8)
This implies that the family {2ν/2ϕ(2νx−k)}k∈Z,ν∈Z is also orthonormal.
Next, we observe that the completeness of {ϕν,k}ν,k∈Z is equivalent to that of
{3
ϕν,k(ξ)}ν,k∈Z = {2−ν/2e−2πikξ2−ν χ2νA(ξ)}ν,k∈Z. Let f ∈L2(R), ﬁx any ν ∈Z,
and deﬁne
h(ξ) = 2ν/2 f(2νξ).
Suppose that for all k ∈Z,
0 = ⟨f, 3
ϕν,k⟩=

2νA f(ξ)2−ν/2e−2πikξ2−νdξ
=

A 2ν/2 f(2νξ)e−2πikξdξ
= ⟨χAh,e−2πikξ⟩.
Exercise 6.6.1(a) shows {e−2πikξ}k∈Z is an orthonormal basis of L2(A), and there-
fore χAh = 0 almost everywhere. From the deﬁnition of h it follows that χ2νA f = 0
almost everywhere. Now suppose for all ν,k ∈Z
0 = ⟨f, 3
ϕν,k⟩.
Then χ2νA f = 0 almost everywhere for all ν ∈Z. Since ∪ν∈Z2νA = R \ {0}, it
follows that f = 0 almost everywhere. We conclude {3
ϕν,k}ν,k∈Z is complete.
6.6.3 Construction of a Smooth Wavelet
The wavelet basis of L2(Rn) constructed in Example 6.6.6 is forced to have slow
decay at inﬁnity, since the Fourier transforms of the elements of the basis are non-
smooth. Smoothing out the function 1ϕ but still expecting ϕ to be wavelet is a bit
tricky, since property (6.6.8) may be violated when μ ̸= ν, and moreover, (6.6.4)
may be destroyed. These two obstacles are overcome by the careful construction of
the next theorem.

6.6 Wavelets and Sampling
487
Theorem 6.6.7. There exists a Schwartz function ϕ on the real line that is a wavelet,
that is, the collection of functions {ϕν,k}k,ν∈Z with ϕν,k(x) = 2
ν
2 ϕ(2νx −k) is an
orthonormal basis of L2(R). Moreover, the function ϕ can be constructed so that its
Fourier transform satisﬁes
supp 1ϕ ⊆

−4
3,−1
3

∪
 1
3, 4
3

.
(6.6.9)
Note that in view of condition (6.6.9), the function ϕ must have vanishing mo-
ments of all orders.
Proof. We start with an odd smooth real-valued function Θ on the real line such that
Θ(t) = π
4 for t ≥1
6 and such that Θ is strictly increasing on the interval

−1
6, 1
6

.
We set
α(t) = sin(Θ(t)+ π
4 ),
β(t) = cos(Θ(t)+ π
4 ),
and we observe that
α(t)2 +β(t)2 = 1
and that
α(−t) = β(t)
for all real t. Next we introduce the smooth function ω deﬁned via
ω(t) =
⎧
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎩
β(−t
2 −1
2) = α( t
2 + 1
2)
when t ∈

−4
3,−2
3

,
α(−t −1
2) = β(t + 1
2)
when t ∈

−2
3,−1
3

,
α(t −1
2)
when t ∈
 1
3, 2
3

,
β( t
2 −1
2)
when t ∈
 2
3, 4
3

,
on the interval

−4
3,−1
3
 1
3, 4
3

. Note that ω is an even function. Finally we deﬁne
the function ϕ by letting
1ϕ(ξ) = e−πiξω(ξ),
and we note that
ϕ(x) =

R ω(ξ)e2πiξ(x−1
2 )dξ = 2
 ∞
0 ω(ξ)cos

2π(x−1
2)ξ

dξ .
It follows that the function ϕ is symmetric about the number 1
2, that is, we have
ϕ(x) = ϕ(1−x)
for all x ∈R. Note that ϕ is a Schwartz function whose Fourier transform is sup-
ported in the set

−4
3,−1
3
 1
3, 4
3

.
Having deﬁned ϕ, we proceed by showing that it is a wavelet. In view of identity
(6.6.1) we have that 3
ϕν,k is supported in the set 1
32ν ≤|ξ| ≤4
32ν, while 3
ϕμ, j is
supported in the set 1
32μ ≤|ξ| ≤4
32μ. The intersection of these sets has measure
zero when |μ −ν| ≥2, which implies that such wavelets are orthogonal to each
other. Therefore, it sufﬁces to verify orthogonality between adjacent scales (i.e.,
when ν = μ and ν = μ +1).

488
6 Littlewood–Paley Theory and Multipliers
We begin with the case ν = μ, which, by a simple dilation, is reduced to the case
ν = μ = 0. Thus to obtain the orthogonality of the functions ϕ0,k(x) = ϕ(x−k) and
ϕ0, j(x) = ϕ(x−j), in view of Proposition 6.6.4, it sufﬁces to show that
∑
k∈Z
|1ϕ(ξ +k)|2 = 1.
(6.6.10)
Since the sum in (6.6.10) is 1-periodic, we check that is equal to 1 only for ξ in
 1
3, 4
3

. First for ξ ∈
 1
3, 2
3

, the sum in (6.6.10) is equal to
|1ϕ(ξ)|2 +|1ϕ(ξ −1)|2 = ω(ξ)2 +ω(ξ −1)2
= α(ξ −1
2)2 +β((ξ −1)+ 1
2)2
= 1
from the deﬁnition of ω. A similar argument also holds for ξ ∈
 2
3, 4
3

, and this
completes the proof of (6.6.10). As a consequence of this identity we also obtain
that the functions ϕ0,k have L2 norm equal to 1, and thus so have the functions ϕν,k,
via a change of variables.
Next we prove the orthogonality of the functions ϕν,k and ϕν+1, j for general
ν,k, j ∈Z. We begin by observing the validity of the following identity:
1ϕ(ξ)1ϕ( ξ
2 ) =

e−πiξ/2β( ξ
2 −1
2)α( ξ
2 −1
2)
when 2
3 ≤ξ ≤4
3,
e−πiξ/2α( ξ
2 + 1
2)β( ξ
2 + 1
2)
when −4
3 ≤ξ ≤−2
3.
(6.6.11)
Indeed, from the deﬁnition of ϕ, it follows that
1ϕ(ξ)1ϕ( ξ
2 ) = e−πiξ/2ω(ξ)ω( ξ
2 ).
This function is supported in
{ξ ∈R : 1
3 ≤|ξ| ≤4
3}∩{ξ ∈R : 2
3 ≤|ξ| ≤8
3} = {ξ ∈R : 2
3 ≤|ξ| ≤4
3},
and on this set it is equal to
e−πiξ/2

β( ξ
2 −1
2)α( ξ
2 −1
2)
when 2
3 ≤ξ ≤4
3,
α( ξ
2 + 1
2)β( ξ
2 + 1
2)
when −4
3 ≤ξ ≤−2
3,
by the deﬁnition of ω. This establishes (6.6.11).
We now turn to the orthogonality of the functions ϕν,k and ϕν+1, j for general
ν,k, j ∈Z. Using (6.6.1) and (6.6.11) we have
4
ϕν,k |ϕν+1, j
5
=
43
ϕν,k | 
ϕν+1, j
5
=

R 2−ν
2 1ϕ(2−νξ)e−2πi ξ k
2ν 2−ν+1
2 1ϕ(2−(ν+1)ξ)e−2πi
ξ j
2ν+1 dξ

6.6 Wavelets and Sampling
489
=
1
√
2

R
1ϕ(ξ)1ϕ( ξ
2 )e−2πiξ(k−j
2 ) dξ
=
1
√
2
 −2
3
−4
3
α( ξ
2 + 1
2)β( ξ
2 + 1
2)e−2πiξ(k−j
2 + 1
4 ) dξ
+
1
√
2

4
3
2
3
α( ξ
2 −1
2)β( ξ
2 −1
2)e−2πiξ(k−j
2 + 1
4 ) dξ
= 0,
where the last identity follows from the change of variables ξ = ξ ′−2 in the second-
to-last integral, which transforms its range of integration to
 2
3, 4
3

and its integrand
to the negative of that of the last displayed integral.
Our ﬁnal task is to show that the orthonormal system {ϕν,k}ν,k∈Z is complete.
We show this by proving that whenever a square-integrable function f satisﬁes
4
f |ϕν,k
5
= 0
(6.6.12)
for all ν,k ∈Z, then f must be zero. Suppose that (6.6.12) holds. Plancherel’s iden-
tity yields

R
1f(ξ)2−ν
2 1ϕ(2−νξ)e−2πi2−νξk dξ = 0
for all ν,k and thus

R
1f(2νξ)1ϕ(ξ)e2πiξk dξ =
 1f(2ν(·)) 1ϕ
1(−k) = 0
(6.6.13)
for all ν,k ∈Z. It follows from Proposition 6.6.3 and (6.6.13) (with k = 0) that
∑
k∈Z
1f(2ν(ξ +k))1ϕ(ξ +k) =

R
1f(2νξ) 1ϕ(ξ)dξ =
 1f(2ν(·)) 1ϕ
1(0) = 0
for all ν ∈Z.
Next, we show that the identity
∑
k∈Z
1f(2ν(ξ +k))1ϕ(ξ +k) = 0
(6.6.14)
for all ν ∈Z implies that 1f is identically equal to zero. Suppose that 1
3 ≤ξ ≤2
3. In
this case the support properties of 1ϕ imply that the only terms in the sum in (6.6.14)
that do not vanish are k = 0 and k = −1. Thus for 1
3 ≤ξ ≤2
3 the identity in (6.6.14)
reduces to
0 = 1f(2ν(ξ −1))1ϕ(ξ −1)+ 1f(2νξ)1ϕ(ξ)
= 1f(2ν(ξ −1))eπi(ξ−1)β((ξ −1)+ 1
2)+ 1f(2νξ)eπiξα(ξ −1
2);

490
6 Littlewood–Paley Theory and Multipliers
hence
−1f(2ν(ξ −1))β(ξ −1
2)+ 1f(2νξ)α(ξ −1
2) = 0,
1
3 ≤ξ ≤2
3 .
(6.6.15)
Next we observe that when 2
3 ≤ξ ≤4
3, only the terms with k = 0 and k = −2 survive
in the identity in (6.6.14). This is because when k = −1, ξ +k = ξ −1 ∈

−1
3, 1
3

and
this interval has null intersection with the support of 1ϕ. Therefore, (6.6.14) reduces
to
0 = 1f(2ν(ξ −2))1ϕ(ξ −2)+ 1f(2νξ)1ϕ(ξ)
= 1f(2ν(ξ −2))eπi(ξ−2)α( ξ−2
2 + 1
2)+ 1f(2νξ)eπiξβ( ξ
2 −1
2);
hence
1f(2ν(ξ −2))α( ξ
2 −1
2)+ 1f(2νξ)β( ξ
2 −1
2) = 0,
2
3 ≤ξ ≤4
3 .
(6.6.16)
Replacing ﬁrst ν by ν −1 and then ξ
2 by ξ in (6.6.16), we obtain
1f(2ν(ξ −1))α(ξ −1
2)+ 1f(2νξ)β(ξ −1
2) = 0,
1
3 ≤ξ ≤2
3 .
(6.6.17)
Now consider the 2 × 2 system of equations given by (6.6.15) and (6.6.17) with
unknown 1f(2ν(ξ −1)) and 1f(2νξ). The determinant of the system is
det

−β(ξ −1/2) α(ξ −1/2)
α(ξ −1/2) β(ξ −1/2)

= −1 ̸= 0.
Therefore, the system has the unique solution
1f(2ν(ξ −1)) = 1f(2νξ) = 0,
which is valid for all ν ∈Z and all ξ ∈[ 1
3, 2
3]. We conclude that 1f(ξ) = 0 for all ξ ∈R
and thus f = 0. This proves the completeness of the system {ϕν,k}. We conclude that
the function ϕ is a wavelet.
□
6.6.4 Sampling
Next we discuss how one can recover a band-limited function by its values at a
countable number of points.
Deﬁnition 6.6.8. An integrable function on Rn is called band limited if its Fourier
transform has compact support.
For every band-limited function there is a B > 0 such that its Fourier transform
is supported in the cube [−B,B]n. In such a case we say that the function is band
limited on the cube [−B,B]n.

6.6 Wavelets and Sampling
491
It is an interesting observation that such functions are completely determined by
their values at the points x = k/2B, where k ∈Zn. We have the following result.
Theorem 6.6.9. (a) Let f in L1(Rn) be band limited on the cube [−B,B]n. Then f
can be sampled by its values at the points x = k/2B, where k ∈Zn. In particular, we
have
f(x1,...,xn) = ∑
k∈Zn
f
 k
2B
 n
∏
j=1
sin(2πBxj −πkj)
2πBxj −πkj
(6.6.18)
for almost all x ∈Rn.
(b) Suppose that f is band-limited on the cube [−B′,B′]n where 0 < B′ < B. Then f
can be sampled by its values at the points x = k/2B, k ∈Zn as follows
f(x1,...,xn) = ∑
k∈Zn
f
 k
2B

Φ(x−k),
(6.6.19)
for some Schwartz function Φ that depends on B,B′.
Proof. Since the function 1f is supported in [−B,B]n, we use Exercise 6.6.2 to obtain
1f(ξ) =
1
(2B)n ∑
k∈Zn
11f
 k
2B

e2πi k
2B ·ξ
=
1
(2B)n ∑
k∈Zn
f

−k
2B

e2πi k
2B ·ξ .
Inserting this identity in the inversion formula
f(x) =

[−B,B]n
1f(ξ)e2πix·ξ dξ ,
which holds for almost all x ∈Rn since 1f is continuous and therefore integrable over
[−B,B]n, we obtain
f(x) =

[−B,B]n
1
(2B)n ∑
k∈Zn
f

−k
2B

e2πi k
2B ·ξe2πix·ξ dξ
= ∑
k∈Zn
f

−k
2B

1
(2B)n

[−B,B]n e2πi( k
2B +x)·ξ dξ
(6.6.20)
= ∑
k∈Zn
f

−k
2B
 n
∏
j=1
sin(2πBxj +πkj)
2πBxj +πkj
.
(6.6.21)
This is exactly (6.6.18) when we change k to −k and thus part (a) is proved. For part
(b) we argue similarly, except that we replace χ[−B,B]n by 1Φ, where 1Φ is smooth,
equal to 1 on [−B′,B′]n and vanishes outside [−B,B]n. Then we can insert the func-
tion 1Φ(ξ) in (6.6.20) and instead of (6.6.21) we obtain the expression on the right
in (6.6.19).
□

492
6 Littlewood–Paley Theory and Multipliers
Remark 6.6.10. Identity (6.6.18) holds for any B′′ > B. In particular, we have
∑
k∈Zn
f
 k
2B
 n
∏
j=1
sin(2πBxj −πkj)
2πBxj −πkj
= ∑
k∈Zn
f
 k
2B′′
 n
∏
j=1
sin(2πB′′xj −πkj)
2πB′′xj −πkj
for all x ∈Rn whenever f is band-limited in [−B,B]n. In particular, band-limited
functions in [−B,B]n can be sampled by their values at the points k/2B′′ for any
B′′ ≥B.
However, band-limited functions in [−B,B]n cannot be sampled by the points
k/2B′ for any B′ < B, as the following example indicates.
Example 6.6.11. For 0 < B′ < B, let f(x) = g(x)sin(2πB′x), where 1g is supported
in the interval [−(B −B′),B −B′]. Then f is band limited in [−B,B], but it cannot
be sampled by its values at the points k/2B′, since it vanishes at these points and f
is not identically zero if g is not the zero function.
Next, we give a couple of results that relate the Lp norm of a given function with
the ℓp norm (or quasi-norm) of its sampled values.
Theorem 6.6.12. Let f be a tempered1 function whose Fourier transform is sup-
ported in the closed ball B(0,t) for some 0 < t < ∞. Assume that f lies in Lp(Rn)
for some 0 < p ≤∞. Then there is a constant C(n, p) such that
{f(k)}k∈Zn

ℓp(Zn) ≤C(n, p)t (1+t
2n
p )
f

Lp(Rn) .
Proof. The proof is based on the following fact, whose proof can be found in [131]
(Lemma 2.2.3). Let 0 < r < ∞. Then there exists a constant C2 = C2(n,r) such that
for all t > 0 and for all C 1 functions u on Rn whose distributional Fourier transform
is supported in the ball |ξ| ≤t we have
sup
z∈Rn
1
t
|∇u(x−z)|
(1+t|z|)
n
r ≤C2 M(|u|r)(x)
1
r ,
(6.6.22)
where M denotes the Hardy–Littlewood maximal operator.
Notice that f is a C ∞function since its Fourier transform is compactly supported.
Assuming (6.6.22), for each k ∈Zn and x ∈[0,1]n we use the mean value theorem
to obtain
| f(k)| ≤| f(x+k)|+√n
sup
z∈[0,1]n |∇f(z+k)|
≤| f(x+k)|+√n
sup
z∈B(x+k,√n)
|∇f(z)|.
We raise this inequality to the power p, we integrate over the cube [0,1]n, we sum
over k ∈Zn, and then we take the 1/p power. Let cp = max(1,21/p−1) and c(n,r,t) =
1 A function is called tempered if there are constants C,M such that | f(x)| ≤C(1 + |x|)M for all
x ∈Rn. Tempered functions are tempered distributions.

6.6 Wavelets and Sampling
493
√nt(1+t√n)n/r. The sum over k and the integral over [0,1]n yield an integral over
Rn and thus we obtain
/
∑
k∈Zn
| f(k)|p0 1
p ≤

Rn | f(x)+√n
sup
z∈B(x,√n)
|∇f(z)|p dx
 1
p
≤cp
f

Lp +√n

Rn
sup
z∈B(0,√n)
|∇f(x−z)|p dx
 1
p 
≤cp
f

Lp +c(n,r,t)

Rn
$
sup
z∈B(0,√n)
|∇f(x−z)|
t(1+t|z|)
n
r
%p
dx
 1
p 
≤cp
f

Lp +c(n,r,t)

Rn
$
sup
z∈Rn
|∇f(x−z)|
t(1+t|z|)
n
r
%p
dx
 1
p 
≤cp
f

Lp +c(n,r,t)C2

Rn[M(| f|r)(x)]
p
r dx
 1
p 
,
where the last step uses (6.6.22). We now select r = p/2 if p < ∞and r to be
any number if p = ∞. The required inequality follows from the boundedness of the
Hardy-Littlewood maximal operator on L2 if p < ∞or on L∞if p = ∞.
□
The next theorem could be considered a partial converse of Theorem 6.6.13
Theorem 6.6.13. Suppose that an integrable function f has Fourier transform sup-
ported in the cube [−( 1
2 −ε), 1
2 −ε]n for some 0 < ε < 1/2. Furthermore, suppose
that the sequence of coefﬁcients {f(k)}k∈Zn lies in ℓp(Zn) for some 0 < p ≤∞. Then
f lies in Lp(Rn) and the following estimate is valid
f

Lp(Rn) ≤Cn,p,ε
{f(k)}k

ℓp(Zn) .
(6.6.23)
Proof. We ﬁx a smooth function 1Φ supported in [−1
2, 1
2]n and equal to 1 on the
smaller cube [−( 1
2 −ε), 1
2 −ε]n. Then we may write f = f ∗Φ, since 1Φ is equal to
one on the support of 1f. Writing 1f in terms of its Fourier series we have
1f(ξ) = ∑
k∈Zn
11f(k)e2πik·ξ χ[−1
2 , 1
2 ]n = ∑
k∈Zn
f(−k)e2πik·ξ χ[−1
2 , 1
2 ]n
(6.6.24)
Since f is integrable, 1f is continuous and thus integrable over [−1
2, 1
2]n. By Fourier
inversion we have
f(x) =

[−1
2 , 1
2 ]n
1f(ξ)e2πix·ξdξ =

[−1
2 , 1
2 ]n
1f(ξ) 1Φ(ξ)e2πix·ξdξ
(6.6.25)
for almost all x ∈Rn. Inserting (6.6.25) in (6.6.24) we obtain
f(x) =

[−1
2 , 1
2 ]n ∑
k∈Zn
f(−k)e2πik·ξe2πix·ξ 1Φ(ξ)dξ

494
6 Littlewood–Paley Theory and Multipliers
= ∑
k∈Zn
f(k)

[−1
2 , 1
2 ]n e−2πik·ξe2πix·ξ 1Φ(ξ)dξ
= ∑
k∈Zn
f(k)Φ(x−k).
This identity combined with the rapid decay of Φ yields (6.6.23) as follows. For
0 < p ≤1 we have
 f
p
Lp ≤

Rn ∑
k∈Zn
| f(k)|p|Φ(x−k)|p =
{f(k)}k∥p
ℓp(Zn)∥Φ∥p
Lp
while for 1 < p ≤∞, setting Q = [−1
2, 1
2]n we write:
 f

Lp(Rn) ≤

∑
l∈Zn

l+Q

∑
k∈Zn
| f(k)||Φ(x−k)|
p
dx
 1
p
≤Cn,N

∑
l∈Zn

l+Q

∑
k∈Zn
| f(k)|
1
(2√n+|x−k|)N
p
dx
 1
p
≤C′
n,N

∑
l∈Zn

l+Q

∑
k∈Zn
| f(k)|
1
(√n+|l −k|)N
p
dx
 1
p
≤C′
n,N

∑
l∈Zn

∑
k∈Zn
| f(k)|
1
(√n+|l −k|)N
p 1
p
.
The preceding expression can be viewed as the ℓp norm of the discrete convolution
of the sequences {f(k)}k and
1
(√n+|k|)N and thus it is bounded by a constant multiple
of
{f(k)}k

ℓp(Zn), since the sequence
1
(√n+|k|)N is in ℓ1(Zn) if N is large enough.
This completes the proof.
□
Exercise 6.6.6 gives examples of functions for which Theorem 6.6.13 fails
if ε = 0.
Exercises
6.6.1. (a) Let A = [−1,−1
2)[ 1
2,1). Show that the family {e2πimx}m∈Z is an
orthonormal basis of L2(A).
(b) Obtain the same conclusion for the family {e2πim·x}m∈Zn in L2(An).

Hint: To show completeness, given f ∈L2(A), deﬁne h on [0,1] by setting h(x) =
f(x−1) for x ∈[0, 1
2) and h(x) = f(x) for x ∈[ 1
2,1). Observe that 1h(m) = 1f(m) for
all m ∈Z and expand h in Fourier series.


6.6 Wavelets and Sampling
495
6.6.2. Let g be an integrable function on Rn.
(a) Suppose that g is supported in [−b,b]n for some b > 0 and that the sequence
{1g(k/2b)}k∈Zn lies in ℓ2(Zn). Show that
g(x) = (2b)−n ∑
k∈Zn
1g( k
2b)e2πi k
2b ·xχ[−b,b]n ,
where the series converges in L2(Rn) and deduce that g is in L2(Rn).
(b) Suppose that g is supported in [0,b]n for some b > 0 and that the sequence
{1g(k/b)}k∈Zn lies in ℓ2(Zn). Show that
g(x) = b−n ∑
k∈Zn
1g( k
b)e2πi k
b ·xχ[0,b]n ,
where the series converges in L2(Rn) and deduce that g is in L2(Rn).
(c) When n = 1, obtain the same as the conclusion in part (b) for x ∈[−b,−b
2)
[ b
2,b), provided g is supported in this set.

Hint: Part (c): Use the result in Exercise 6.6.1.

6.6.3. Show that the sequence of functions
Hk(x1,...,xn) = (2B)
n
2
n
∏
j=1
sin

π(2Bxj −kj)

π(2Bxj −kj)
,
k ∈Zn ,
is orthonormal in L2(Rn).

Hint: Interpret the functions Hk as the Fourier transforms of known functions.

6.6.4. Prove the following spherical multidimensional version of Theorem 6.6.9.
Suppose that 1f is supported in the ball |ξ| ≤R. Show that
f(x) = ∑
k∈Zn
f

−k
2R
 1
2n
J n
2 (2π|Rx+ k
2|)
|Rx+ k
2|
n
2
,
where Ja is the Bessel function of order a.
6.6.5. Let {ak}k∈Zn be in ℓp for some 1 < p < ∞. Show that the partial sums
∑
k∈Zn
|k|≤N
ak
n
∏
j=1
sin(2πBxj −πkj)
2πBxj −πkj
converge in S ′(Rn) as N →∞to an Lp function on Rn whose Fourier transform
is supported in [−B,B]n. Here k = (k1,...,kn). Moreover, the Lp norm of A is con-
trolled by a constant multiple of the ℓp norm of {ak}k.
6.6.6. Consider the function ∏n
j=1 sin(πxj)/(πxj) on Rn to show that Theorem
6.6.13 fails when ε = 0 and p ≤1. When 1 < p ≤∞consider the function x1 +
∏n
j=1 sin(πxj)/(πxj).

496
6 Littlewood–Paley Theory and Multipliers
6.6.7. (a) Let ψ(x) be a nonzero continuous integrable function on R that satisﬁes

R ψ(x)dx = 0 and
Cψ =
 +∞
−∞
| 1ψ(t)|2
|t|
dt < ∞.
Deﬁne the wavelet transform of f in L2(R) by setting
W( f;a,b) =
1
"
|a|
 +∞
−∞f(x)ψ
x−b
a

dx
when a ̸= 0 and W( f;0,b) = 0. Show that for any f ∈L2(R) the following inversion
formula holds:
f(x) = 1
Cψ
 +∞
−∞
 +∞
−∞
1
|a|
1
2
ψ
x−b
a

W( f;a,b)db da
a2 .
(b) State and prove an analogous wavelet transform inversion property on Rn.

Hint: Apply Theorem 2.2.14 (5) in the b-integral and use Fourier inversion.

6.6.8. (P. Casazza) On Rn let ej be the vector whose coordinates are zero every-
where except for the jth entry, which is 1. Set qj = ej −1
n ∑n
k=1 ek for 1 ≤j ≤n and
also qn+1 =
1
√n ∑n
k=1 ek. Prove that
n+1
∑
j=1
|qj ·x|2 = |x|2
for all x ∈Rn. This provides an example of a tight frame on Rn.
HISTORICAL NOTES
An early account of square functions in the context of Fourier series appears in the work of
Kolmogorov [196], who proved the almost everywhere convergence of lacunary partial sums of
Fourier series of periodic square-integrable functions. This result was systematically studied and
extended to Lp functions, 1 < p < ∞, by Littlewood and Paley [227], [228], [229] using complex-
analysis techniques. The real-variable treatment of the Littlewood and Paley theorem was pioneered
by Stein [334] and allowed the higher-dimensional extension of the theory. The use of vector-valued
inequalities in the proof of Theorem 6.1.2 is contained in Benedek, Calder´on, and Panzone [22]. A
Littlewood–Paley theorem for lacunary sectors in R2 was obtained by Nagel, Stein, and Wainger
[264].
An interesting Littlewood–Paley estimate holds for 2 ≤p < ∞: There exists a constant Cp such
that for all families of disjoint open intervals Ij in R the estimate ∥(∑j |( 1f χIj)∨|2)
1
2 ∥Lp ≤Cp∥f∥Lp
holds for all functions f ∈Lp(R). This was proved by Rubio de Francia [301], but the special case
in which Ij = ( j, j+1) was previously obtained by Carleson [55]. An alternative proof of Rubio de
Francia’s theorem was obtained by Bourgain [34]. A higher-dimensional analogue of this estimate
for arbitrary disjoint open rectangles in Rn with sides parallel to the axes was obtained by Journ´e
[181]. Easier proofs of the higher-dimensional result were subsequently obtained by Sj¨olin [326],
Soria [329], and Sato [311].
Part (a) of Theorem 6.2.7 is due to Mihlin [254] and the generalization in part (b) to H¨ormander
[159]. Theorem 6.2.2 can be found in Marcinkiewicz’s article [241] in the context of one-
dimensional Fourier series. Calder´on and Torchinsky [45] have improved Theorem 6.2.7 in the

6.6 Wavelets and Sampling
497
following way: if for a suitable smooth bump η supported in an annulus the functions m(2kξ)η(ξ)
lie in the Sobolev space Lr
γ uniformly in k ∈Z, where γ > n( 1
p −1
2), 1 < p < 2, 1
r = 1
p −1
2, then m
lies in Mp(Rn). The power 6 in estimate (6.2.3) that appears in the statement of Theorem 6.2.2 is
not optimal. Tao and Wright [357] proved that in dimension 1, the best power of (p−1)−1 in this
theorem is 3
2 as p →1. An improvement of the Marcinkiewicz multiplier theorem in one dimen-
sion was obtained by Coifman, Rubio de Francia, and Semmes [69]. Weighted norm estimates for
H¨ormander–Mihlin multipliers were obtained by Kurtz and Wheeden [209] and for Marcinkiwiecz
multipliers by Kurtz [208]. Heo, Nazarov, and Seeger [150] have obtained a very elegant charac-
terization of radial Lp multipliers in large dimensions; precisely, they showed that for dimensions
n ≥4 and 1 < p < 2n−2
n+1 , a radial function m on Rn is an Lp Fourier multiplier if and only if there
exists a nonzero Schwartz function η such that supt>0tn/p∥(m(·)η(t ·))∨∥Lp < ∞. This characteri-
zation builds on and extends a previously obtained simple characterization by Garrig´os and Seeger
[124] of radial multipliers on the invariant subspace of radial Lp functions when 1 < p <
2n
n+1.
The method of proof of Theorem 6.3.4 is adapted from Duoandikoetxea and Rubio de Francia
[102]. The method in this article is rather general and can be used to obtain Lp boundedness for a
variety of rough singular integrals. A version of Theorem 6.3.6 was used by Christ [59] to obtain
Lp smoothing estimates for Cantor–Lebesgue measures. When p = q ̸= 2, Theorem 6.3.6 is false
in general, but it is true for all r satisfying | 1
r −1
2| < | 1
p −1
2| under the additional assumption that
the mj’s are Lipschitz functions uniformly at all scales. This result was independently obtained
by Carbery [52] and Seeger [316]. Miyachi [255] has obtained a complete characterization of the
indices a,b > 0 such that the functions |x|−bei|x|aψ(x) are Lp Fourier multipliers; here ψ is a smooth
function that is equal to 1 near inﬁnity and vanishes near zero.
The probabilistic notions of conditional expectations and martingales have a strong connection
with the Littlewood–Paley theory discussed in this chapter. For the purposes of this exposition we
considered only the case of the sequence of σ-algebras generated by the dyadic cubes of side length
2−k in Rn. The Lp boundedness of the maximal conditional expectation (Doob [97]) is analogous
to the Lp boundedness of the dyadic maximal function; likewise with the corresponding weak type
(1,1) estimate. The Lp boundedness of the dyadic martingale square function was obtained by
Burkholder [39] and is analogous to Theorem 6.1.2. Moreover, the estimate
supk |Ek( f)|

Lp ≈
S( f)

Lp, 0 < p < ∞, obtained by Burkholder and Gundy [40] and also by Davis [90] is analogous
to the square-function characterization of the Hardy space H p norm. For an exposition on the
different and unifying aspects of Littlewood–Paley theory we refer to Stein [337]. The proof of
Theorem 6.4.8, which quantitatively expresses the almost orthogonality of the Littlewood–Paley
and the dyadic martingale difference operators, is taken from Grafakos and Kalton [133].
The use of quadratic expressions in the study of certain maximal operators has a long history.
We refer to the article of Stein [340] for a historical survey. Theorem 6.5.1 was ﬁrst proved by Stein
[339]. The proof in the text is taken from an article of Rubio de Francia [302]. Another proof when
n ≥3 is due to Cowling and Mauceri [76]. The more difﬁcult case n = 2 was settled by Bour-
gain [36] about 10 years later. Alternative proofs when n = 2 were given by Mockenhaupt, Seeger,
and Sogge [256] as well as Schlag [313]. The boundedness of maximal operators associated to
more general smooth measures on compact surfaces of ﬁnite type were investigated by Iosevich
and Sawyer [173]. The powerful machinery of Fourier integral operators was used by Sogge [328]
to obtain the boundedness of spherical maximal operators on compact manifolds without bound-
ary and positive injectivity radius; a simple proof for the boundedness of the spherical maximal
function on the sphere was given by Nguyen [269]. Weighted norm inequalities for the spheri-
cal maximal operator were obtained by Duoandikoetxea and Vega [103]. The discrete spherical
maximal function was studied by Magyar, Stein, and Wainger [237].
Much of the theory of square functions and the ideas associated with them has analogues in the
dyadic setting. A dyadic analogue of the theory discussed here can be obtained. For an introduction
to the area of dyadic harmonic analysis, we refer to Pereyra [276].
The idea of expressing (or reproducing) a signal as a weighted average of translations and
dilations of a single function appeared in early work of Calder´on [42]. This idea is in some sense a
forerunner of wavelets. An early example of a wavelet was constructed by Str¨omberg [352] in his

498
6 Littlewood–Paley Theory and Multipliers
search for unconditional bases for Hardy spaces. Another example of a wavelet basis was obtained
by Meyer [249]. The construction of an orthonormal wavelet presented in Theorem 6.6.7 is in
Lemari´e and Meyer [216]. A compactly supported wavelet was constructed by Daubechies [88].
Mallat [238] introduced the notion of multiresolution analysis, which led to a systematic production
of wavelets. Theorem 6.6.9 is Shannon’s [319] version of Nyquist’s theorem [270] and is referred
to as the Nyquist-Shannon sampling theorem. It is a fundamental result in telecommunications and
signal processing, since it describes how to reconstruct a signal that contains no frequencies higher
than B Hertz in terms of its values at a sequence of points spaced 1/(2B) seconds apart.
The area of wavelets has taken off signiﬁcantly since its inception, spurred by these early re-
sults. A general theory of wavelets and its use in Fourier analysis was carefully developed in the
two-volume monograph of Meyer [250], [251] and its successor Meyer and Coifman [253]. For
further study and a deeper account of developments on the subject the reader may consult the
books of Daubechies [89], Chui [64], Wickerhauser [374], Kaiser [184], Benedetto and Frazier
[23], H´ernandez and Weiss [151], Wojtaszczyk [379], Mallat [239], Meyer [252], Frazier [120],
Gr¨ochenig [140], and the references therein. Theorems 6.6.12 and 6.6.13 ﬁrst appeared in a com-
bined form in the work of Plancherel and P´olya [285] for restrictions of entire functions of expo-
nential type on the real line.

Chapter 7
Weighted Inequalities
Weighted inequalities arise naturally in Fourier analysis, but their use is best justiﬁed
by the variety of applications in which they appear. For example, the theory of
weights plays an important role in the study of boundary value problems for
Laplace’s equation on Lipschitz domains. Other applications of weighted inequal-
ities include extrapolation theory, vector-valued inequalities, and estimates for cer-
tain classes of nonlinear partial differential equations.
The theory of weighted inequalities is a natural development of the principles and
methods we have acquainted ourselves with in earlier chapters. Although a variety
of ideas related to weighted inequalities appeared almost simultaneously with the
birth of singular integrals, it was only in the 1970s that a better understanding of
the subject was obtained. This was spurred by Muckenhoupt’s characterization of
positive functions w for which the Hardy–Littlewood maximal operator M maps
Lp(Rn,w(x)dx) to itself. This characterization led to the introduction of the class
Ap and the development of weighted inequalities. We pursue exactly this approach
in the next section to motivate the introduction of the Ap classes.
7.1 The Ap Condition
A weight is a nonnegative locally integrable function on Rn that takes values in
(0,∞) almost everywhere. Therefore, weights are allowed to be zero or inﬁnite only
on a set of Lebesgue measure zero. Hence, if w is a weight and 1/w is locally inte-
grable, then 1/w is also a weight.
Given a weight w and a measurable set E, we use the notation
w(E) =

E w(x)dx
L. Grafakos, Classical Fourier Analysis, Graduate Texts in Mathematics 249,
DOI 10.1007/978-1-4939-1194-3 7, © Springer Science+Business Media New York 2014
499

500
7 Weighted Inequalities
to denote the w-measure of the set E. Since weights are locally integrable functions,
w(E) < ∞for all sets E contained in some ball. The weighted Lp spaces are denoted
by Lp(Rn,w) or simply Lp(w). Recall the uncentered Hardy–Littlewood maximal
operators on Rn over balls
M( f)(x) = sup
B∋x
Avg
B
| f| = sup
B∋x
1
|B|

B | f(y)|dy,
and over cubes
Mc( f)(x) = sup
Q∋x
Avg
Q
| f| = sup
Q∋x
1
|Q|

Q | f(y)|dy,
where the suprema are taken over all balls B and cubes Q (with sides parallel to the
axes) that contain the given point x. A classical result (Theorem 2.1.6) states that for
all 1 < p < ∞there is a constant Cp(n) > 0 such that

Rn M( f)(x)p dx ≤Cp(n)p

Rn | f(x)|p dx
(7.1.1)
for all functions f ∈Lp(Rn). We are concerned with the situation in which the mea-
sure dx in (7.1.1) is replaced by w(x)dx for some weight w(x).
7.1.1 Motivation for the Ap Condition
The question we raise is whether there is a characterization of all weights w(x) such
that the strong type (p, p) inequality

Rn M( f)(x)p w(x)dx ≤Cp
p

Rn | f(x)|p w(x)dx
(7.1.2)
is valid for all f ∈Lp(w).
Suppose that (7.1.2) is valid for some weight w and all f ∈Lp(w) for some
1 < p < ∞. Apply (7.1.2) to the function f χB supported in a ball B and use that
AvgB | f| ≤M( f χB)(x) for all x ∈B to obtain
w(B)

Avg
B
| f|
p ≤

B M( f χB)p wdx ≤Cp
p

B | f|p wdx.
(7.1.3)
It follows that
 1
|B|

B | f(t)|dt
p
≤Cp
p
w(B)

B | f(x)|p w(x)dx
(7.1.4)
for all balls B and all functions f. At this point, it is tempting to choose a function
such that the two integrands are equal. We do so by setting f = w−p′/p, which gives

7.1 The Ap Condition
501
f pw = w−p′/p. Under the assumption that infB w > 0 for all balls B, it would follow
from (7.1.4) that
sup
B balls
 1
|B|

B w(x)dx
 1
|B|

B w(x)−
1
p−1 dx
p−1
≤Cp
p .
(7.1.5)
If infB w = 0 for some balls B, we take f = (w+ε)−p′/p to obtain
 1
|B|

B w(x)dx
 1
|B|

B(w(x)+ε)−p′
p dx
p 1
|B|

B
w(x)dx
(w(x)+ε)p′
−1
≤Cp
p (7.1.6)
for all ε > 0. Replacing w(x)dx by (w(x) + ε)dx in the last integral in (7.1.6) we
obtain a smaller expression, which is also bounded by Cp
p. Since −p′/p = −p′ +1,
(7.1.6) implies that
 1
|B|

B w(x)dx
 1
|B|

B(w(x)+ε)−p′
p dx
p−1
≤Cp
p ,
(7.1.7)
from which we can still deduce (7.1.5) via the Lebesgue monotone convergence the-
orem by letting ε →0. We have now obtained that every weight w that satisﬁes
(7.1.2) must also satisfy the rather strange-looking condition (7.1.5), which we refer
to in the sequel as the Ap condition. It is a remarkable fact, to be proved in this chap-
ter, that the implication obtained can be reversed, that is, (7.1.2) is a consequence
of (7.1.5). This is the ﬁrst signiﬁcant achievement of the theory of weights [i.e., a
characterization of all functions w for which (7.1.2) holds]. This characterization is
based on some deep principles discussed in the next section and provides a solid
motivation for the introduction and careful examination of condition (7.1.5).
Before we study the converse statements, we consider the case p = 1. Assume
that for some weight w the weak type (1,1) inequality
w

{x ∈Rn : M( f)(x) > α}

≤C1
α

Rn | f(x)|w(x)dx
(7.1.8)
holds for all functions f ∈L1(Rn). Since M( f)(x) ≥AvgB | f| for all x ∈B, it follows
from (7.1.8) that for all α < AvgB | f| we have
w(B) ≤w

{x ∈Rn : M( f)(x) > α}

≤C1
α

Rn | f(x)|w(x)dx.
(7.1.9)
Taking f χB instead of f in (7.1.9), we deduce that
Avg
B
| f| = 1
|B|

B | f(t)|dt ≤
C1
w(B)

B | f(x)|w(x)dx
(7.1.10)

502
7 Weighted Inequalities
for all functions f and balls B. Taking f = χS, we obtain
|S|
|B| ≤C1
w(S)
w(B) ,
(7.1.11)
where S is any measurable subset of the ball B.
Recall that the essential inﬁmum of a function w over a set E is deﬁned as
ess.inf
E
(w) = inf
	
b > 0 : |{x ∈E : w(x) < b}| > 0

.
Then for every a > ess.infB(w) there exists a subset Sa of B with positive measure
such that w(x) < a for all x ∈Sa. Applying (7.1.11) to the set Sa, we obtain
1
|B|

B w(t)dt ≤C1
|Sa|

Sa
w(t)dt ≤C1a,
(7.1.12)
which implies
1
|B|

B w(t)dt ≤C1w(x)
for all balls B and almost all x ∈B.
(7.1.13)
It remains to understand what condition (7.1.13) really means. For every ball B, there
exists a null set N(B) such that (7.1.13) holds for all x in B\N(B). Let N be the union
of all the null sets N(B) for all balls B with centers in Qn and rational radii. Then
N is a null set and for every x in B \ N, (7.1.13) holds for all balls B with centers in
Qn and rational radii. By density, (7.1.13) must also hold for all balls B that contain
a ﬁxed x in Rn \N. It follows that for x ∈Rn \N we have
M(w)(x) = sup
B∋x
1
|B|

B w(t)dt ≤C1w(x).
(7.1.14)
Therefore, assuming (7.1.8), we have arrived at the condition
M(w)(x) ≤C1w(x)
for almost all x ∈Rn,
(7.1.15)
where C1 is the same constant as in (7.1.13).
We later see that this deduction can be reversed and we can obtain (7.1.8) as a
consequence of (7.1.15). This motivates a careful study of condition (7.1.15), which
we refer to as the A1 condition. Since in all the previous arguments we could have
replaced balls with cubes, we give the following deﬁnitions in terms of cubes.
Deﬁnition 7.1.1. A function w(x) ≥0 is called an A1 weight if
M(w)(x) ≤C1w(x)
for almost all x ∈Rn
(7.1.16)
for some constant C1. If w is an A1 weight, then the (ﬁnite) quantity
[w]A1 =
sup
Q cubes in Rn
 1
|Q|

Q w(t)dt

∥w−1∥L∞(Q)
(7.1.17)

7.1 The Ap Condition
503
is called the A1 Muckenhoupt characteristic constant of w, or simply the A1 charac-
teristic constant of w. Note that A1 weights w satisfy
1
|Q|

Q w(t)dt ≤[w]A1 ess.inf
y∈Q w(y)
(7.1.18)
for all cubes Q in Rn.
Remark 7.1.2. We also deﬁne
[w]balls
A1
=
sup
B balls in Rn
 1
|B|

B w(t)dt
w−1
L∞(B) .
(7.1.19)
Using (7.1.13), we see that the smallest constant C1 that appears in (7.1.16) is equal
to the A1 characteristic constant of w as deﬁned in (7.1.19). This is also equal to the
smallest constant that appears in (7.1.13). All these constants are bounded above and
below by dimensional multiples of [w]A1.
We now recall condition (7.1.5), which motivates the following deﬁnition of Ap
weights for 1 < p < ∞.
Deﬁnition 7.1.3. Let 1 < p < ∞. A weight w is said to be of class Ap if
sup
Q cubes in Rn
 1
|Q|

Q w(x)dx
 1
|Q|

Q w(x)−
1
p−1 dx
p−1
< ∞.
(7.1.20)
The expression in (7.1.20) is called the Ap Muckenhoupt characteristic constant of
w (or simply the Ap characteristic constant of w) and is denoted by [w]Ap.
Remark 7.1.4. Note that Deﬁnitions 7.1.1 and 7.1.3 could have been given with the
set of all cubes in Rn replaced by the set of all balls in Rn. Deﬁning [w]balls
Ap
as in
(7.1.20) except that cubes are replaced by balls, we see that

vn2−np ≤[w]Ap
[w]balls
Ap
≤

nn/2vn2−np .
(7.1.21)
7.1.2 Properties of Ap Weights
It is straightforward that translations, isotropic dilations, and scalar multiples of Ap
weights are also Ap weights with the same Ap characteristic. We summarize some
basic properties of Ap weights in the following proposition.
Proposition 7.1.5. Let w ∈Ap for some 1 ≤p < ∞. Then
(1) [δ λ(w)]Ap = [w]Ap, where δ λ(w)(x) = w(λx1,...,λxn).
(2) [τz(w)]Ap = [w]Ap, where τz(w)(x) = w(x−z), z ∈Rn.

504
7 Weighted Inequalities
(3) [λw]Ap = [w]Ap for all λ > 0.
(4) When 1 < p < ∞, the function w−
1
p−1 is in Ap′ with characteristic constant

w−
1
p−1 
Ap′ = [w]
1
p−1
Ap .
Therefore, w ∈A2 if and only if w−1 ∈A2 and both weights have the same A2
characteristic constant.
(5) [w]Ap ≥1 for all w ∈Ap. Equality holds if and only if w is a constant.
(6) The classes Ap are increasing as p increases; precisely, for 1 ≤p < q < ∞we
have
[w]Aq ≤[w]Ap.
(7) lim
q→1+[w]Aq = [w]A1 if w ∈A1.
(8) The following is an equivalent characterization of the Ap characteristic constant
of w:
[w]Ap = sup
Qcubes
in Rn
sup
f ∈Lp(Q,wdt)

Q | f|pwdt>0
$
 1
|Q|

Q | f(t)|dt
p
1
w(Q)

Q | f(t)|pw(t)dt
%
.
(9) The measure w(x)dx is doubling: precisely, for all λ > 1 and all cubes Q we
have
w(λQ) ≤λ np[w]Ap w(Q).
(λQ denotes the cube with the same center as Q and side length λ times the side
length of Q.)
Proof. The simple proofs of (1), (2), and (3) are left as an exercise. Property (4) is
also easy to check and plays the role of duality in this context. To prove (5) we use
H¨older’s inequality with exponents p and p′ to obtain
1 = 1
|Q|

Q dx = 1
|Q|

Q w(x)
1
p w(x)−1
p dx ≤[w]
1
p
Ap ,
with equality holding only when w(x)
1
p = cw(x)−1
p for some c > 0 (i.e., when w is a
constant). To prove (6), observe that 0 < q′ −1 < p′ −1 ≤∞and that the statement
[w]Aq ≤[w]Ap
is equivalent to the fact
w−1
Lq′−1(Q, dx
|Q| ) ≤
w−1
Lp′−1(Q, dx
|Q| ) .
Property (7) is a consequence of part (a) of Exercise 1.1.3.

7.1 The Ap Condition
505
To prove (8), apply H¨older’s inequality with exponents p and p′ to get
(Avg
Q
| f|)p =
 1
|Q|

Q | f(x)|dx
p
=
 1
|Q|

Q | f(x)|w(x)
1
p w(x)−1
p dx
p
≤
1
|Q|p

Q | f(x)|pw(x)dx

Q w(x)−p′
p dx
 p
p′
=

1
ω(Q)

Q | f(x)|pw(x)dx
 1
|Q|

Q w(x)dx
 1
|Q|

Q w(x)−
1
p−1 dx
p−1
≤[w]Ap

1
ω(Q)

Q | f(x)|pw(x)dx

.
This argument proves the inequality ≥in (8) when p > 1. In the case p = 1 the
obvious modiﬁcation yields the same inequality. The reverse inequality follows by
taking f = (w+ε)−p′/p as in (7.1.6) and letting ε →0.
Applying (8) to the function f = χQ and putting λQ in the place of Q in (8), we
obtain
w(λQ) ≤λ np[w]Apw(Q),
which says that w(x)dx is a doubling measure. This proves (9).
□
Example 7.1.6. A positive measure dμ is called doubling if for some C < ∞,
μ(2B) ≤Cμ(B)
(7.1.22)
for all balls B. We show that the measures |x|a dx are doubling when a > −n. We
divide all balls B(x0,R) in Rn into two categories: balls of type I that satisfy |x0| ≥
3R and type II that satisfy |x0| < 3R. For balls of type I we observe that

B(x0,2R) |x|a dx ≤vn(2R)n

(|x0|+2R)a
when a ≥0,
(|x0|−2R)a
when a < 0,

B(x0,R) |x|a dx ≥vnRn

(|x0|−R)a
when a ≥0,
(|x0|+R)a
when a < 0.
Since |x0| ≥3R, we have |x0|+2R ≤4(|x0|−R) and |x0|−2R ≥1
4(|x0|+R), from
which (7.1.22) follows with C = 23n4|a|.
For balls of type II, we have |x0| ≤3R and we note two things: ﬁrst

B(x0,2R) |x|a dx ≤

|x|≤5R |x|a dx = cnRn+a,

506
7 Weighted Inequalities
and second, since |x|a is radially decreasing for a < 0 and radially increasing for
a ≥0, we have

B(x0,R) |x|a dx ≥
⎧
⎪
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎪
⎩

B(0,R) |x|a dx
when a ≥0,

B(3R x0
|x0| ,R) |x|a dx
when a < 0.
For x ∈B(3R x0
|x0|,R) we must have |x| ≥2R, and hence both integrals on the right
are at least a multiple of Rn+a. This establishes (7.1.22) for balls of type II.
Example 7.1.7. We investigate for which real numbers a the power function |x|a is
an Ap weight on Rn. For 1 < p < ∞, we examine for which a the following expression
is ﬁnite:
sup
B balls
 1
|B|

B |x|a dx
 1
|B|

B |x|−a p′
p dx
 p
p′
.
(7.1.23)
As in the previous example we split the balls in Rn into those of type I and those of
type II. If B = B(x0,R) is of type I, then for x satisfying |x−x0| ≤R we must have
2
3|x0| ≤|x0|−R ≤|x| ≤|x0|+R ≤4
3|x0|,
thus the expression inside the supremum in (7.1.23) is comparable to
|x0|a
|x0|−a p′
p  p
p′ = 1.
If B(x0,R) is a ball of type II, then B(0,5R) has size comparable to B(x0,R) and
contains it. Since the measure |x|a dx is doubling, the integrals of the function |x|a
over B(x0,R) and over B(0,5R) are comparable. It sufﬁces therefore to estimate the
expression inside the supremum in (7.1.23), in which we have replaced B(x0,R) by
B(0,5R). But this is

1
vn(5R)n

B(0,5R)|x|a dx

1
vn(5R)n

B(0,5R) |x|−a p′
p dx
 p
p′
=

n
(5R)n
 5R
0
ra+n−1dr

n
(5R)n
 5R
0
r−a p′
p +n−1dr
 p
p′
,
which is seen easily to be ﬁnite and independent of R exactly when −n < a < n p
p′ .
We conclude that |x|a is an Ap weight, 1 < p < ∞, if and only if −n < a < n(p−1).
The previous proof can be suitably modiﬁed to include the case p = 1. In this case
we obtain that |x|a is an A1 weight if and only if −n < a ≤0. As we have seen, the
measure |x|a dx is doubling on the larger range −n < a < ∞. Thus for a > n(p−1),
the function |x|a provides an example of a doubling measure that is not in Ap.

7.1 The Ap Condition
507
Example 7.1.8. On Rn the function
u(x) =

log 1
|x|
when |x| < 1
e,
1
otherwise,
is an A1 weight. Indeed, to check condition (7.1.19) it sufﬁces to consider balls of
type I and type II as deﬁned in Example 7.1.6. In either case the required estimate
follows easily.
We now return to a point alluded to earlier, that the Ap condition implies the
boundedness of the Hardy–Littlewood maximal function M on the space Lp(w). To
this end we introduce four maximal functions acting on functions f that are locally
integrable with respect to w:
Mw( f)(x) = sup
B∋x
1
w(B)

B | f|wdy,
where the supremum is taken over open balls B that contain the point x and
Mw( f)(x) = sup
δ>0
1
w(B(x,δ))

B(x,δ) | f|wdy,
Mw
c ( f)(x) = sup
Q∋x
1
w(Q)

Q | f|wdy,
where Q is an open cube containing the point x, and
Mw
c ( f)(x) = sup
δ>0
1
w(Q(x,δ))

Q(x,δ) | f|wdy,
where Q(x,δ) = ∏n
j=1(xj −δ,xj + δ) is a cube of side length 2δ centered at
x = (x1,...,xn). When w = 1, these maximal functions reduce to the standard ones
M( f), M( f), Mc( f), and Mc( f), the uncentered and centered Hardy–Littlewood
maximal functions with respect to balls and cubes, respectively.
Theorem 7.1.9. (a) Let w ∈A1. Then we have
Mc

L1(w)→L1,∞(w) ≤3n[w]A1 .
(7.1.24)
(b) Let w ∈Ap(Rn) for some 1 < p < ∞. Then there is a constant Cn,p such that
Mc

Lp(w)→Lp(w) ≤Cn,p[w]
1
p−1
Ap .
(7.1.25)
Since the operators Mc, Mc, M, and M are pointwise comparable, a similar conclu-
sions hold for the other three as well.
Proof. (a) Since dμ = wdx is a doubling measure and dμ(3Q) ≤3n[w]A1μ(Q),
using Proposition 7.1.5 (9) and Exercise 2.1.1 we obtain that Mw
c maps L1(w) to
L1,∞(w) with norm at most 3n[w]A1. This proves (7.1.24).

508
7 Weighted Inequalities
(b) Fix a weight w in Ap and let σ = w−
1
p−1 be its dual weight. Fix an open cube
Q = Q(x0,r) in Rn with center x0 and side length 2r and write
1
|Q|

Q | f|dy = w(Q)
1
p−1 σ(3Q)
|Q|
p
p−1
$ |Q|
w(Q)

1
σ(3Q)

Q | f|dy
p−1%
1
p−1
.
(7.1.26)
For any x ∈Q, consider the cube Q(x,2r). Then Q ⫅Q(x,2r) ⫅3Q = Q(x0,3r) and
thus
1
σ(3Q)

Q | f|dy ≤
1
σ(Q(x,2r))

Q(x,2r) | f|dy ≤Mσ
c (| f|σ−1)(x)
for any x ∈Q. Inserting this expression in (7.1.26), we obtain
1
|Q|

Q | f|dy ≤w(Q)
1
p−1 σ(3Q)
|Q|
p
p−1
$
1
w(Q)

Q Mσ
c (| f|σ−1)p−1 dy
%
1
p−1
.
(7.1.27)
Since one may easily verify that
w(Q)σ(3Q)p−1
|Q|p
≤3np[w]Ap ,
it follows that
1
|Q|

Q | f|dy ≤3
np
p−1 [w]
1
p−1
Ap

Mw
c

Mσ
c (| f|σ−1)
p−1w−1
(x0)

1
p−1 ,
since x0 is the center of Q. Hence, we have
Mc( f) ≤3
np
p−1 [w]
1
p−1
Ap

Mw
c

Mσ
c (| f|σ−1)
p−1w−1
1
p−1 .
Applying Lp(w) norms, we deduce
Mc( f)

Lp(w) ≤3
np
p−1 [w]
1
p−1
Ap
Mw
c

Mσ
c (| f|σ−1)
p−1w−1
1
p−1
Lp′(w)
≤3
np
p−1 [w]
1
p−1
Ap
Mw
c

1
p−1
Lp′(w)→Lp′(w)

Mσ
c (| f|σ−1)
p−1w−1
1
p−1
Lp′(w)
= 3
np
p−1 [w]
1
p−1
Ap
Mw
c

1
p−1
Lp′(w)→Lp′(w)
Mσ
c (| f|σ−1)

Lp(σ)
≤3
np
p−1 [w]
1
p−1
Ap
Mw
c

1
p−1
Lp′(w)→Lp′(w)
Mσ
c

Lp(σ)→Lp(σ)
f

Lp(w) ,
and conclusion (7.1.25) follows, provided we show that
Mw
c

Lq(w)→Lq(w) ≤C(q,n) < ∞
(7.1.28)
for any 1 < q < ∞and any weight w.

7.1 The Ap Condition
509
We obtain this estimate by interpolation. Obviously (7.1.28) is valid when q = ∞
with C(∞,n) = 1. If we prove that
Mw
c

L1(w)→L1,∞(w) ≤C(1,n) < ∞,
(7.1.29)
then (7.1.28) will follow from Theorem 1.3.2.
To prove (7.1.29) we ﬁx f ∈L1(Rn,wdx). We ﬁrst show that the set
Eλ = {Mw
c ( f) > λ}
is open. For any r > 0, let Q(x,r) denote an open cube of side length 2r with center
x ∈Rn. If we show that for any r > 0 and x ∈Rn the function
x →
1
w(Q(x,r))

Q(x,r) | f|wdy
(7.1.30)
is continuous, then Mw
c ( f) is the supremum of continuous functions; hence it is
lower semicontinuous and thus the set Eλ is open. But this is straightforward. If
xn →x0, then w(Q(xn,r)) →w(Q(x0,r)) and also

Q(xn,r) | f|wdy →

Q(x0,r) | f|wdy
by the Lebesgue dominated convergence theorem. Since w(Q(x0,r)) ̸= 0, it follows
that the function in (7.1.30) is continuous.
Given K a compact subset of Eλ, for any x ∈K select an open cube Qx centered
at x such that
1
w(Qx)

Qx
| f|wdy > λ .
Applying Lemma 7.1.10 (proved immediately afterward) we ﬁnd a subfamily
{Qx j}m
j=1 of the family of the balls {Qx : x ∈K} such that (7.1.31) and (7.1.32)
hold. Then
w(K) ≤
m
∑
j=1
w(Qx j) ≤
m
∑
j=1
1
λ

Qx j
| f|wdy ≤24n
λ

Rn | f|wdy,
where the last inequality follows by multiplying (7.1.32) by | f|w and integrating
over Rn. Taking the supremum over all compact subsets K of Eλ and using the inner
regularity of wdx, which is a consequence of the Lebesgue monotone convergence
theorem, we deduce that Mw
c maps L1(w) to L1,∞(w) with constant at most 24n. Thus
(7.1.29) holds with C(1,n) = 24n.
□
Lemma 7.1.10. Let K be a bounded set in Rn and for every x ∈K, let Qx be an open
cube with center x and sides parallel to the axes. Then there are an m ∈Z+ ∪{∞}
and a sequence of points {xj}m
j=1 in K such that
K ⫅
m

j=1
Qx j
(7.1.31)

510
7 Weighted Inequalities
and for almost all y ∈Rn one has
m
∑
j=1
χQx j (y) ≤24n .
(7.1.32)
Proof. Let s0 = sup{ℓ(Qx) : x ∈K}. If s0 = ∞, then there exists x1 ∈K such that
ℓ(Qx1) > 4L, where [−L,L]n contains K. Then K is contained in Qx1 and the state-
ment of the lemma is valid with m = 1.
Suppose now that s0 < ∞. Select x1 ∈K such that ℓ(Qx1) > s0/2. Then deﬁne
K1 = K \Qx1 ,
s1 = sup{ℓ(Qx) : x ∈K1},
and select x2 ∈K1 such that ℓ(Qx2) > s1/2. Next deﬁne
K2 = K \(Qx1 ∪Qx2),
s2 = sup{ℓ(Qx) : x ∈K2},
and select x3 ∈K2 such that ℓ(Qx3) > s2/2. Continue until the ﬁrst integer m is
found such that Km is an empty set. If no such integer exists, continue this process
indeﬁnitely and set m = ∞.
We claim that for all i ̸= j we have 1
3Qxi ∩1
3Qx j = /0. Indeed, suppose that i > j.
Then xi ∈Ki−1 = K \(Qx1 ∪···∪Qxi−1); thus xi /∈Qj. Also xi ∈Ki−1 ⫅Kj−1, which
implies that ℓ(Qxi) ≤s j−1 < 2ℓ(Qx j). If xi /∈Qj and ℓ(Qx j) > 1
2ℓ(Qxi), it easily
follows that 1
3Qxi ∩1
3Qx j = /0.
We now prove (7.1.31). If m < ∞, then Km = /0 and therefore K ⫅m
j=1 Qx j. If
m = ∞, then there is an inﬁnite number of selected cubes Qx j. Since the cubes 1
3Qx j
are pairwise disjoint and have centers in a bounded set, it must be the case that
some subsequence of the sequence of their lengths converges to zero. If there exists
a y ∈K \ ∞
j=1 Qx j, this y would belong to all Kj, j = 1,2,..., and then s j ≥ℓ(Qy)
for all j. Since some subsequence of the s j’s tends to zero, it would follow that
ℓ(Qy) = 0, which would force the open cube Qy to be the empty set, a contradiction.
Thus (7.1.31) holds.
Finally, we show that ∑m
j=1 χQx j (y) ≤24n for almost every point y ∈Rn. To prove
this we consider the n hyperplanes Hi that are parallel to the coordinate hyperplanes
and pass through the point y. Then we write Rn as a union of n hyperplanes Hi of
n-dimensional Lebesgue measure zero and 2n higher-dimensional open “octants”
Or, henceforth called orthants. We ﬁx a y ∈Rn and we show that there are only
12n points xj such that y lies in Or ∩Qx j for a given open orthant Or. To prove this
assertion, setting |z|ℓ∞= sup1≤i≤n |zi| for points z = (z1,...,zn) in Rn, we pick an
xk0 ∈K ∩Or such that Qxk0 contains y and |xk0 −y|ℓ∞is the largest possible among
all |xj −y|ℓ∞. If xj is another point in K ∩Or such that Qx j contains y, then we claim
that xj ∈Qxk0. Indeed, to show this we notice that for each i ∈{1,...,n} we have
|xj,i −xk0,i| =
xj,i −yi −(xk0,i −yi)

=
|xj,i −yi|−|xk0,i −yi|


7.1 The Ap Condition
511
≤max

|xk0,i −yi|,|xj,i −yi|

≤max

|xk0 −y|ℓ∞,|xj −y|ℓ∞
= |xk0 −y|ℓ∞
< 1
2ℓ(Qxk0),
where the second equality is due to the fact that xj,xk0 lie in the same orthant and
the last inequality in the fact that y ∈Qxk0; it follows that xj lies in Qxk0.
We observed previously that i > j implies xi /∈Qj. Since xj lies in Qxk0, one must
then have j ≤k0, which implies that 1
2ℓ(Qxk0) < ℓ(Qx j). Thus all cubes Qx j with
centers in K ∩Or that contain the ﬁxed point y have side lengths comparable to that
of Qxk0. A simple geometric argument now gives that there are at most ﬁnitely many
cubes Qx j of side length between α and 2α that contain the given point y such that
1
3Qx j are pairwise disjoint. Indeed, let α = 1
2ℓ(Qxk0) and let {Qxr}r∈I be the cubes
with these properties. Then we have
αn|I|
3n
≤∑
r∈I
 1
3Qxr
 =
 
r∈I
1
3Qxr
 ≤
 
r∈I
Qxr
 ≤(4α)n ,
since all the cubes Qxr contain the point y and have length at most 2α and they
must therefore be contained in a cube of side length 4α centered at y. This obser-
vation shows that |I| ≤12n, and since there are 2n sets Or, we conclude the proof
of (7.1.32).
□
Remark 7.1.11. Without use of the covering Lemma 7.1.10, (7.1.29) can be proved
via the doubling property of w (cf. Exercise 2.1.1(a)), but then the resulting constant
C(q,n) would depend on the doubling constant of the measure wdx and thus on
[w]Ap; this would yield a worse dependence on [w]Ap in the constant in (7.1.25).
Exercises
7.1.1. Let k be a nonnegative measurable function such that k,k−1 are in L∞(Rn).
Prove that if w is an Ap weight for some 1 ≤p < ∞, then so is kw.
7.1.2. Let w1, w2 be two A1 weights and let 1 < p < ∞. Prove that w1w1−p
2
is an Ap
weight by showing that
[w1w1−p
2
]Ap ≤[w1]A1[w2]p−1
A1 .
7.1.3. Suppose that w ∈Ap for some p ∈[1,∞) and 0 < δ < 1. Prove that wδ ∈Aq,
where q = δ p+1−δ, by showing that
[wδ]Aq ≤[w]δ
Ap .

512
7 Weighted Inequalities
7.1.4. Show that if the Ap characteristic constants of a weight w are uniformly
bounded for all p > 1, then w ∈A1.
7.1.5. Let w0 ∈Ap0 and w1 ∈Ap1 for some 1 ≤p0, p1 < ∞. Let 0 ≤θ ≤1 and deﬁne
1
p = 1−θ
p0
+ θ
p1
and
w
1
p = w
1−θ
p0
0
w
θ
p1
1 .
Prove that
[w]Ap ≤[w0]
(1−θ) p
p0
Ap0
[w1]
θ p
p1
Ap1 ;
thus w is in Ap.
7.1.6. ([122]) Fix 1 < p < ∞. A pair of weights (u,w) that satisﬁes
[u,w](Ap,Ap) = sup
Q cubes
in Rn
 1
|Q|

Q udx
 1
|Q|

Q w−
1
p−1 dx
p−1
< ∞
is said to be of class (Ap,Ap). The quantity [u,w](Ap,Ap) is called the (Ap,Ap) char-
acteristic constant of the pair (u,w).
(a) Suppose that pair of weights (u,w) is of class (Ap,Ap). Show that for all non-
negative measurable functions f and all cubes Q′ we have
 1
|Q′|

Q′ | f|dx
p
u(Q′) ≤C0

Q′ | f|pwdx,
where C0 = [u,w](Ap,Ap).
(b) Suppose that a pair of weights (u,w) satisﬁes the inequality in part (a) for some
constant C0. Prove that M maps Lp(w) to Lp,∞(u) with norm at most C(n, p)C1/p
0
,
where C(n, p) is a ﬁxed constant.
(c) Suppose that for a pair of weights (u,w), M maps Lp(w) to Lp,∞(u). Show that
the pair (u,w) is of class (Ap,Ap).

Hint: Part (b): Replacing f by f χQ in part (a), where Q ⊆Q′, obtain that
u(Q′) ≤C0|Q′|p

Q | f|pwdx

Q | f|dx
p .
Then use Exercise 5.3.9 to ﬁnd disjoint cubes Qj such that the set Eα = {x ∈Rn :
Mc( f)(x) > α} is contained in the union of 3Qj and α
4n <
1
|Qj|

Qj | f(t)|dt ≤α
2n .
Then u(Eα) ≤∑j u(3Qj), and bound each u(3Qj) by taking Q′ = 3Qj and Q = Qj in
the preceding estimate. Part (c): First prove the assertion in part (b) and then derive
the inequality in part (a) by adapting the idea in the discussion in the beginning of
Subsection 7.1.1.


7.1 The Ap Condition
513
7.1.7. ([122]) Let 1 < p < ∞and let (u,w) be a pair of weights of class (Ap,Ap).
Show that for any q with p < q < ∞there is a constant Cp,q,n < ∞such that for all
f ∈Lq(w) we have

Rn M( f)(x)qu(x)dx
1/q
≤Cp,q,n

Rn f(x)qw(x)dx
1/q
.

Hint: Use Exercise 7.1.6 and interpolate between Lp and L∞.

7.1.8. Let k > 0. For an A1 weight w show that [min(w,k)]A1 ≤[w]A1. If 1 < p < ∞
and w ∈Ap, show that
[min(w,k)]Ap ≤cp[w]Ap ,
where cp = 1 if 1 < p ≤2 and cp = 2p−1 if 2 < p < ∞.

Hint: Use the inequality
1
|Q|

Q min(w,k)−
1
p−1 dx ≤1
|Q|

Q w−
1
p−1 dx+k−
1
p−1 and also
1
|Q|

Q min(w,k)dx ≤min
	
k, 1
|Q|

Q wdx

.

7.1.9. Suppose that wj ∈Ap j with 1 ≤j ≤m for some 1 ≤p1,..., pm < ∞and let
0 < θ1,...,θm < 1 be such that θ1 +···+θm = 1. Show that
wθ1
1 ···wθm
m ∈Amax{p1,...,pm} .

Hint: First note that each weight wj lies in Amax{p1,...,pm} and then apply H¨older’s
inequality.

7.1.10. Let w1 ∈Ap1 and w2 ∈Ap2 for some 1 ≤p1, p2 < ∞. Prove that
[w1 +w2]Ap ≤[w1]Ap1 +[w2]Ap2 ,
where p = max(p1, p2).
7.1.11. Show that the function
u(x) =

log 1
|x|
when |x| < 1
e,
1
otherwise,
in Example 7.1.8 is an A1 weight on Rn.

Hint: Use [u]balls
A1
instead of [u]A1 and consider balls of type I and II as in Example
7.1.7.

7.1.12. Let 1 < p < ∞and w ∈A1. Show that the uncentered Hardy-Littlewood
maximal function M maps Lp,∞(w) to itself.

Hint: Prove ﬁrst the inequality
w({M(g) > λ}) ≤
3n([w]balls
A1
)2
λ

{M(g)>λ} |g|wdx
and then use the characterization of Lp,∞given in Exercise 1.1.12.]

514
7 Weighted Inequalities
7.2 Reverse H¨older Inequality for Ap Weights and Consequences
An essential property of Ap weights is that they assign to subsets of balls mass
proportional to the percentage of the Lebesgue measure of the subset within the
ball. The following lemma provides a way to quantify this statement.
Lemma 7.2.1. Let w ∈Ap for some 1 ≤p < ∞and let 0 < α < 1. Then there exists
β < 1 such that whenever S is a measurable subset of a cube Q that satisﬁes |S| ≤
α|Q|, we have w(S) ≤β w(Q).
Proof. Taking f = χA in property (8) of Proposition 7.1.5, we obtain
 |A|
|Q|
p
≤[w]Ap
w(A)
w(Q) .
(7.2.1)
We write S = Q\A to get

1−|S|
|Q|
p
≤[w]Ap

1−w(S)
w(Q)

.
(7.2.2)
Given 0 < α < 1, set
β = 1−(1−α)p
[w]Ap
(7.2.3)
and use (7.2.2) to obtain the required conclusion.
□
7.2.1 The Reverse H¨older Property of Ap Weights
We are now ready to state and prove one of the main results of the theory of weights,
the reverse H¨older inequality for Ap weights.
Theorem 7.2.2. Let w ∈Ap for some 1 ≤p < ∞. Then there exist constants C and
γ > 0 that depend only on the dimension n, on p, and on [w]Ap such that for every
cube Q we have
 1
|Q|

Q w(t)1+γ dt

1
1+γ
≤C
|Q|

Q w(t)dt .
(7.2.4)
Proof. Let us ﬁx a cube Q and set
α0 = 1
|Q|

Q w(x)dx.
We also ﬁx 0 < α < 1. We deﬁne an increasing sequence of scalars
α0 < α1 < α2 < ··· < αk < ···

7.2 Reverse H¨older Inequality and Consequences
515
for k ≥0 by setting
αk+1 = 2nα−1αk
or
αk = (2nα−1)kα0,
and for each k ≥1 we apply a Calder´on–Zygmund decomposition to w at height αk.
Precisely, for dyadic subcubes R of Q, we let
1
|R|

R w(x)dx > αk
(7.2.5)
be the selection criterion. Since Q does not satisfy the selection criterion, it is not
selected. We divide the cube Q into a mesh of 2n subcubes of equal side length, and
among these cubes we select those that satisfy (7.2.5). We subdivide each unselected
subcube into 2n cubes of equal side length and we continue in this way indeﬁnitely.
We denote by {Qk, j}j the collection of all selected subcubes of Q. We observe that
the following properties are satisﬁed:
(1) αk <
1
|Qk, j|

Qk, j
w(t)dt ≤2nαk.
(2) For almost all x /∈Uk we have w(x) ≤αk, where Uk = 
j
Qk, j.
(3) Each Qk+1, j is contained in some Qk,l.
Property (1) is satisﬁed since the unique dyadic parent of Qk, j was not chosen in the
selection procedure. Property (2) follows from the Lebesgue differentiation theorem
using the fact that for almost all x /∈Uk there exists a sequence of unselected cubes
of decreasing lengths whose closures’ intersection is the singleton {x}. Property (3)
is satisﬁed since each Qk, j is the maximal subcube of Q satisfying (7.2.5). And since
the average of w over Qk+1, j is also bigger than αk, it follows that Qk+1, j must be
contained in some maximal cube that possesses this property.
We now compute the portion of Qk,l that is covered by cubes of the form Qk+1, j
for some j. We have
2nαk ≥
1
|Qk,l|

Qk,l∩Uk+1
w(t)dt
=
1
|Qk,l|
∑
j:Qk+1, j⊆Qk,l
|Qk+1, j|
1
|Qk+1, j|

Qk+1, j
w(t)dt
>
Qk,l ∩Uk+1

|Qk,l|
αk+1
=
Qk,l ∩Uk+1

|Qk,l|
2nα−1αk .
It follows that
Qk,l ∩Uk+1
 ≤α|Qk,l|; thus, applying Lemma 7.2.1, we obtain
w(Qk,l ∩Uk+1)
w(Qk,l)
< β = 1−(1−α)p
[w]Ap
,

516
7 Weighted Inequalities
from which, summing over all l, we obtain
w(Uk+1) ≤βw(Uk).
The latter gives w(Uk) ≤β kw(U0). We also have |Uk+1| ≤α|Uk|; hence |Uk| →0 as
k →∞. Therefore, the intersection of the Uk’s is a set of Lebesgue measure zero. We
can therefore write
Q =

Q\U0
 ∞

k=0
Uk \Uk+1

modulo a set of Lebesgue measure zero. Let us now ﬁnd a γ > 0 such that the reverse
H¨older inequality (7.2.4) holds. We have w(x) ≤αk for almost all x in Q \Uk and
therefore

Q w(t)1+γ dt =

Q\U0
w(t)γw(t)dt +
∞
∑
k=0

Uk\Uk+1
w(t)γw(t)dt
≤αγ
0w(Q\U0)+
∞
∑
k=0
αγ
k+1w(Uk)
≤αγ
0w(Q\U0)+
∞
∑
k=0
((2nα−1)k+1α0)γβ kw(U0)
≤αγ
0

1+(2nα−1)γ
∞
∑
k=0
(2nα−1)γkβ k

w(Q)
=
 1
|Q|

Q w(t)dt
γ
1+
(2nα−1)γ
1−(2nα−1)γβ

Q w(t)dt ,
provided γ > 0 is chosen small enough that (2nα−1)γβ < 1. Keeping track of the
constants, we conclude the proof of the theorem with
γ = 1
2
−logβ
log2n −logα = log

[w]Ap

−log

[w]Ap −(1−α)p
2log 2n
α
(7.2.6)
and
Cγ+1 = 1+
(2nα−1)γ
1−(2nα−1)γβ
= 1+
(2nα−1)γ
1−(2nα−1)γ
1−(1−α)p
[w]Ap

= 1+
1
(2nα−1)−γ −

1−(1−α)p
[w]Ap
 ,

7.2 Reverse H¨older Inequality and Consequences
517
which yields
C =

1+
1

1−(1−α)p
[w]Ap
 1
2 −

1−(1−α)p
[w]Ap


2log 2n
α
2log 2n
α −log

1−(1−α)p
[w]Ap

.
(7.2.7)
Note that up to this point, α was an arbitrary number in (0,1).
□
Remark 7.2.3. It is worth observing that for α such that (1−α)p = 3
4, the constant
γ in (7.2.6) decreases as [w]Ap increases, while the constant C in (7.2.7) increases as
[w]Ap increases. This is because 1−3
4[w]−1
Ap ≥1
4 and for t ∈( 1
4,1) the function √t −t
is decreasing. This allows us to obtain the following stronger version of Theorem
7.2.2: For any 1 ≤p < ∞and B > 1, there exist positive constants C = C(n, p,B)
and γ = γ(n, p,B) such that for all w ∈Ap satisfying [w]Ap ≤B the reverse H¨older
condition (7.2.4) holds for every cube Q. See Exercise 7.2.4(a) for details.
Observe that in the proof of Theorem 7.2.2 it was crucial to know that for some
0 < α,β < 1 we have
|S| ≤α |Q| =⇒w(S) ≤β w(Q)
(7.2.8)
whenever S is a subset of the cube Q. No special property of Lebesgue measure was
used in the proof of Theorem 7.2.2 other than its doubling property. Therefore, it is
reasonable to ask whether Lebesgue measure in (7.2.8) can be replaced by a general
measure μ satisfying the doubling property
μ(3Q) ≤Cn μ(Q) < ∞
(7.2.9)
for all cubes Q in Rn. A straightforward adjustment of the proof of the previous
theorem indicates that this is indeed the case.
Corollary 7.2.4. Let w be a weight and let μ be a measure on Rn satisfying (7.2.9).
Suppose that there exist 0 < α,β < 1, such that
μ(S) ≤α μ(Q) =⇒

S w(t)dμ(t) ≤β

Q w(t)dμ(t)
whenever S is a μ-measurable subset of a cube Q. Then there exist 0 < C,γ < ∞
[which depend only on the dimension n, the constant Cn in (7.2.9), α, and β] such
that for every cube Q in Rn we have

1
μ(Q)

Q w(t)1+γ dμ(t)

1
1+γ
≤
C
μ(Q)

Q w(t)dμ(t).
(7.2.10)
Proof. The proof of the corollary can be obtained almost verbatim from that of
Theorem 7.2.2 by replacing Lebesgue measure with the doubling measure dμ and
the constant 2n by Cn.

518
7 Weighted Inequalities
Precisely, we deﬁne αk = (Cnα−1)kα0, where α0 is the μ-average of w over Q;
then properties (1), (2), (3) concerning the selected cubes {Qk, j}j are replaced by
(1μ) αk <
1
μ(Qk, j)

Qk, j
w(t)dμ(t) ≤Cn αk.
(2μ) On Q\Uk we have w ≤αk μ-almost everywhere, where Uk = 
j
Qk, j.
(3μ) Each Qk+1, j is contained in some Qk,l.
To prove the upper inequality in (1μ) we use that the dyadic parent of each selected
cube Qk, j was not selected and is contained in 3Qk, j. To prove (2μ) we need a dif-
ferentiation theorem for doubling measures, analogous to that in Corollary 2.1.16.
This can be found in Exercise 2.1.1. The remaining details of the proof are trivially
adapted to the new setting. The conclusion is that for
0 < γ <
−logβ
logCn −logα
(7.2.11)
and
C =

1+
(Cnα−1)γ
1−(Cnα−1)γβ

1
γ+1
,
(7.2.12)
(7.2.10) is satisﬁed. Notice that the choice of the constants (7.2.6) and (7.2.7) is valid
in this case with Cn in place of 2n.
□
7.2.2 Consequences of the Reverse H¨older Property
Having established the crucial reverse H¨older inequality for Ap weights, we now
pass to some very important applications. Among them, the ﬁrst result of this section
yields that an Ap weight that lies a priori in L1
loc(Rn) must actually lie in the better
space L1+σ
loc (Rn) for some σ > 0 depending on the weight.
Theorem 7.2.5. If w ∈Ap for some 1 ≤p < ∞, then there exists a number γ > 0
(that depends on n, p, and [w]Ap) such that w1+γ ∈Ap.
Proof. Let C be the constant in the proof of Theorem 7.2.2. When p = 1, we apply
the reverse H¨older inequality of Theorem 7.2.2 to the weight w to obtain
1
|Q|

Q w(t)1+γ dt ≤
 C
|Q|

Q w(t)dt
1+γ
≤C1+γ[w]1+γ
A1 w(x)1+γ
for almost all x in the cube Q. Therefore, w1+γ is an A1 weight with characteristic
constant at most C1+γ[w]1+γ
A1 . When p > 1, there exist γ1,γ2 > 0 and C1,C2 > 0 such
that the reverse H¨older inequality of Theorem 7.2.2 holds for the weights w ∈Ap
and w−
1
p−1 ∈Ap′, that is,

7.2 Reverse H¨older Inequality and Consequences
519
 1
|Q|

Q w(t)1+γ1dt

1
1+γ1 ≤C1
|Q|

Q w(t)dt,
 1
|Q|

Q w(t)−
1
p−1 (1+γ2)dt

1
1+γ2 ≤C2
|Q|

Q w(t)−
1
p−1 dt .
Taking γ = min(γ1,γ2), both inequalities are satisﬁed with γ in the place of γ1, γ2. It
follows that w1+γ is in Ap and satisﬁes
[w1+γ]Ap ≤(C1Cp−1
2
)1+γ[w]1+γ
Ap .
(7.2.13)
This concludes the proof of the theorem.
□
Corollary 7.2.6. For any 1 < p < ∞and for every w ∈Ap there is a q = q(n, p,[w]Ap)
with q < p such that w ∈Aq. In other words, we have
Ap =

q∈(1,p)
Aq .
Proof. Given w ∈Ap, let γ,C1,C2 be as in the proof of Theorem 7.2.5. In view of
the result in Exercise 7.1.3 with δ = 1/(1+γ), if w1+γ ∈Ap and
q = p
1
1+γ +1−
1
1+γ = p+γ
1+γ ,
then w ∈Aq and
[w]Aq = [(w1+γ)
1
1+γ ]Aq ≤

w1+γ
1
1+γ
Ap ≤C1Cp−1
2
[w]Ap ,
where the last estimate comes from (7.2.13). Since 1 < q = p+γ
1+γ < p, the required
conclusion follows. Observe that the constants C1Cp−1
2
, q, and 1
γ increase as [w]Ap
increases.
□
Another powerful consequence of the reverse H¨older property of Ap weights is
the following characterization of all A1 weights.
Theorem 7.2.7. Let w be an A1 weight. Then there exist 0 < ε < 1, a nonnegative
function k such that k,k−1 ∈L∞, and a nonnegative locally integrable function f
that satisﬁes M( f) < ∞a.e. such that
w(x) = k(x)M( f)(x)ε .
(7.2.14)
Conversely, given a nonnegative function k such that k,k−1 ∈L∞and given a
nonnegative locally integrable function f that satisﬁes M( f) < ∞a.e., deﬁne w via
(7.2.14). Then w is an A1 weight that satisﬁes
[w]A1 ≤
Cn
1−ε ∥k∥L∞∥k−1∥L∞,
(7.2.15)
where Cn is a universal dimensional constant.

520
7 Weighted Inequalities
Proof. In view of Theorem 7.2.2, there exist 0 < γ,C < ∞such that the reverse
H¨older condition
 1
|Q|

Q w(t)1+γ dt

1
1+γ
≤C
|Q|

Q w(t)dt ≤C[w]A1w(x)
(7.2.16)
holds for all cubes Q and for all x in Q\EQ, where EQ is a null subset of Q. We set
ε =
1
1+γ
and
f(x) = w(x)1+γ = w(x)
1
ε .
Letting N be the union of EQ over all Q with rational radii and centers in Qn, it
follows from (7.2.16) that the uncentered Hardy–Littlewood maximal function Mc( f)
with respect to cubes satisﬁes
Mc( f)(x) ≤C1+γ[w]1+γ
A1 f(x)
for x ∈Rn \N.
This implies that M( f) ≤CnC1+γ[w]1+γ
A1 f a.e. for some constant Cn that depends
only on the dimension. We now set
k(x) =
f(x)ε
M( f)(x)ε ,
and we observe that C−1C−ε
n [w]−1
A1 ≤k ≤1 a.e.
It remains to prove the converse. Given a weight w = kM( f)ε in the form (7.2.14)
and a cube Q, it sufﬁces to show that
1
|Q|

Q M( f)(t)ε dt ≤
Cn
1−ε M( f)ε(x)
for almost all x ∈Q,
(7.2.17)
since then (7.2.15) follows trivially from (7.2.17) with w = kM( f)ε using that
k,k−1 ∈L∞. To prove (7.2.17), we write
f = f χ3Q + f χ(3Q)c .
Then
1
|Q|

Q M( f χ3Q)(t)ε dt ≤
C′
n
1−ε
 1
|Q|

Rn( f χ3Q)(t)dt
ε
(7.2.18)
in view of Kolmogorov’s inequality (Exercise 2.1.5). But the last expression in
(7.2.18) is at most a dimensional multiple of M( f)(x)ε for almost all x ∈Q, which
proves (7.2.17) when f is replaced by f χ3Q on the left-hand side of the inequality.
And for f χ(3Q)c we only need to notice that
M( f χ(3Q)c)(t) ≤2nM( f χ(3Q)c)(t) ≤2nn
n
2 M( f)(x)

7.2 Reverse H¨older Inequality and Consequences
521
for all x,t in Q, since any ball B centered at t that gives a nonzero average for
f χ(3Q)c must have radius at least the side length of Q, and thus √nB must also
contain x. (Here M is the centered Hardy–Littlewood maximal operator introduced
in Deﬁnition 2.1.1.) Hence (7.2.17) also holds when f is replaced by f χ(3Q)c on the
left-hand side. Combining these two estimates and using the subadditivity property
M( f1 + f2)ε ≤M( f1)ε +M( f2)ε, we obtain (7.2.17).
□
We end this section with the following consequence of the reverse H¨older prop-
erty of Ap weights which can be viewed as a reverse property to (7.2.1).
Proposition 7.2.8. Let 1 ≤p < ∞and w ∈Ap. Then there exist δ ∈(0,1) and C > 0
depending only on n, p, and [w]Ap such that for any cube Q and any measurable
subset S of Q we have
w(S)
w(Q) ≤C
 |S|
|Q|
δ
.
Proof. Let C and γ be as in Theorem 7.2.2. We use H¨older’s inequality to write
w(S)
w(Q) =
1
w(Q)

Q w(x)χS(x)dx
≤
1
w(Q)

Q w(x)1+γ dx

1
1+γ
|S|
γ
1+γ
=
1
w(Q)
 1
|Q|

Q w(x)1+γ dx

1
1+γ
|Q|
1
1+γ |S|
γ
1+γ
=
C
w(Q)

Q w(x)dx

|Q|−
γ
1+γ |S|
γ
1+γ
= C
 |S|
|Q|
δ
,
where δ =
γ
1+γ . This proves the assertion.
□
Exercises
7.2.1. Let w ∈Ap for some 1 < p < ∞and let 1 ≤q < ∞. Prove that the sublinear
operator
S( f) =

M(| f|qw)w−1 1
q
is bounded on Lp′q(w).
7.2.2. Let v be a real-valued locally integrable function on Rn and let 1 < p < ∞.
For a cube Q, let νQ be the average of ν over Q.

522
7 Weighted Inequalities
(a) If ev is an Ap weight, show that
sup
Q cubes
1
|Q|

Q ev(t)−vQ dt ≤[eν]Ap ,
sup
Q cubes
1
|Q|

Q e−(v(t)−vQ)
1
p−1 dt ≤[eν]Ap .
(b) Conversely, if the preceding inequalities hold with some constant C in place of
[ν]Ap, then ν lies in Ap with [ν]Ap ≤C.

Hint: Part (a): If ev ∈Ap, use that
1
|Q|

Q ev(t)−vQ dt ≤

Avg
Q
e−
v
p−1
p−1 
Avg
Q
ev
and obtain a similar estimate for the second quantity.

7.2.3. This exercise assumes familiarity with the space BMO.
(a) Show that if ϕ ∈A2, then logϕ ∈BMO and ∥logϕ∥BMO ≤[ϕ]A2.
(b) Prove that every BMO function is equal to a constant multiple of the logarithm
of an A2 weight. Precisely, given f ∈BMO show that

ec f 
A2 ≤1+2e,
where c = 1/(2n+1∥f∥BMO).
(c) Prove that if ϕ is in Ap for some 1 < p < ∞, then logϕ is in BMO by showing
that
logϕ

BMO ≤
⎧
⎨
⎩
[ϕ]Ap
when 1 < p ≤2,
(p−1)[ϕ]
1
p−1
Ap
when 2 < p < ∞.

Hint: Part (a): Use Exercise 7.2.2 with p = 2. Part (b): Use Exercise 7.2.2 and
Corollary 3.1.7 in [131]. Use Part (c): Use that ϕ−
1
p−1 ∈Ap′ when p > 2.

7.2.4. Prove
the
following
quantitative
versions
of
Theorem
7.2.2
and
Corollary 7.2.6.
(a) For any 1 ≤p < ∞and B > 1, there exists a positive constant C3(n, p,B) and
γ = γ(n, p,B) such that for all w ∈Ap satisfying [w]Ap ≤B, (7.2.4) holds for every
cube Q with C3(n, p,B) in place of C.
(b) Given any 1 < p < ∞and B > 1 there exists a constant C4(n, p,B) and δ =
δ(n, p,B) such that for all w ∈Ap we have
[w]Ap ≤B =⇒[w]Ap−δ ≤C4(n, p,B).
7.2.5. Given a positive doubling measure μ on Rn, deﬁne the characteristic constant
[w]Ap(μ) and the class Ap(μ) for 1 < p < ∞.
(a) Show that statement (8) of Proposition 7.1.5 remains valid if Lebesgue measure
is replaced by μ.

7.2 Reverse H¨older Inequality and Consequences
523
(b) Obtain as a consequence that if w ∈Ap(μ), then for all cubes Q and all μ-
measurable subsets A of Q we have
 μ(A)
μ(Q)
p
≤[w]Ap(μ)
w(A)
w(Q) .
Conclude that if Lebesgue measure is replaced by μ in Lemma 7.2.1, then the lemma
is valid for w ∈Ap(μ).
(c) Use Corollary 7.2.4 to obtain that weights in Ap(μ) satisfy a reverse H¨older
condition.
(d) Prove that given a weight w ∈Ap(μ), there exists 1 < q < p, which depends on
[w]Ap(μ), such that w ∈Aq(μ).
7.2.6. Let 1 < q < ∞and μ a positive measure on Rn. We say that a positive function
K on Rn satisﬁes a reverse H¨older condition of order q with respect to μ, symboli-
cally K ∈RHq(μ), if
[K]RHq(μ) =
sup
Qcubes in Rn

1
μ(Q)

Q Kq dμ
 1
q
1
μ(Q)

Q K dμ
< ∞.
For positive functions u,v on Rn and 1 < p < ∞, show that
[vu−1]RHp′(udx) = [uv−1]
1
p
Ap(vdx) ,
that is, vu−1 satisﬁes a reverse H¨older condition of order p′ with respect to udx if
and only if uv−1 is in Ap(vdx). Conclude that
w ∈RHp′(dx) ⇐⇒w−1 ∈Ap(wdx),
w ∈Ap(dx) ⇐⇒w−1 ∈RHp′(wdx).
7.2.7. ([125]) Suppose that a positive function K on Rn lies in RHp(dx) for some
1 < p < ∞. Show that there exists a δ > 0 such that K lies in RHp+δ(dx).

Hint: By Exercise 7.2.6, K ∈RHp(dx) is equivalent to the fact that K−1 ∈Ap′(K dx),
and the index p′ can be improved by Exercise 7.2.5 (d).

7.2.8. (a) Show that for any w ∈A1 and any cube Q in Rn and a > 1 we have
ess.inf
Q
w ≤an[w]A1 ess.inf
aQ
w.
(b) Prove that there is a constant Cn such that for all locally integrable functions f
on Rn and all cubes Q in Rn we have
ess.inf
Q
M( f) ≤Cn ess.inf
3Q
M( f),
and an analogous statement is valid for Mc.

524
7 Weighted Inequalities

Hint: Part (a): Use (7.1.18). Part (b): Apply part (a) to M( f)
1
2 , which is an A1 weight
in view of Theorem 7.2.7.

7.2.9. ([223]) For a weight w ∈A1(Rn) deﬁne a quantity r = 1 +
1
2n+1[w]A1 . Show
that
Mc(wr)
1
r ≤2[w]A1 w
a.e.

Hint: Fix a cube Q and consider the family FQ of all cubes obtained by subdividing
Q into a mesh of (2n)m subcubes of side length 2−mℓ(Q) for all m = 1,2,.... Deﬁne
Md
Q( f)(x) = supR∈FQ,R∋x |R|−1 
R | f|dy. Using Corollary 2.1.21 obtain

Q∩{Md
Q(w)>λ} w(x)dx ≤2nλ|{x ∈Q : Md
Q(w)(x) > λ}|
for λ > wQ =
1
|Q|

Q wdt. Multiply by λ δ−1 and integrate to obtain

Q Md
Q(w)δwdx ≤(wQ)δ

Q wdx+ 2nδ
δ +1

Q Md
Q(w)δ+1dx.
Replace w by wk = min(k,w) and select δ =
1
2n+1[w]A1 to deduce
1
|Q|

Q wδ+1
k
dx ≤1
|Q|

Q Md
Q(wk)δwk dx ≤2(wQ)δ+1,
using [wk]A1 ≤[w]A1. Then let k →∞.

7.2.10. Let 1 < p < ∞. Recall that a pair of weights (u,w) that satisﬁes
[u,w](Ap,Ap) = sup
Q cubes
in Rn
 1
|Q|

Q udx
 1
|Q|

Q w−
1
p−1 dx
p−1
< ∞
is said to be of class (Ap,Ap). The quantity [u,w](Ap,Ap) is called the (Ap,Ap) char-
acteristic constant of the pair (u,w).
(a) Show that for any g ∈L1
loc(Rn) with 0 < g < ∞a.e., the pair (g,M(g)) is of class
(Ap,Ap) with characteristic constant independent of f.
(b) If (u,w) is of class (Ap,Ap), then the Hardy–Littlewood maximal operator M
may not map Lp(w) to Lp(u).
(c) Given g ∈L1
loc(Rn) with 0 < g < ∞a.e., conclude that Hardy–Littlewood max-
imal operator M maps Lp(M(g)dx) to Lp,∞(gdx) and also Lq(M(g)dx) to Lq(gdx)
for any q with p < q < ∞.

Hint: Part (a): Use H¨older’s inequality and Theorem 7.2.7. Part (b): Try the pair

M(g)1−p,|g|1−p
for a suitable g. Part (c): Use Exercises 7.1.6 and 7.1.7.


7.3 The A∞Condition
525
7.3 The A∞Condition
In this section we examine more closely the class of all Ap weights. It turns out that
Ap weights possess properties that are p-independent but delicate enough to char-
acterize them without reference to a speciﬁc value of p. The Ap classes increase
as p increases, and it is only natural to consider their limit as p →∞. Not surpris-
ingly, a condition obtained as a limit of the Ap conditions as p →∞provides some
unexpected but insightful characterizations of the class of all Ap weights.
7.3.1 The Class of A∞Weights
Let us start by recalling a simple consequence of Jensen’s inequality:

X |h(t)|q dμ(t)
 1
q
≥exp

X log|h(t)|dμ(t)

,
(7.3.1)
which holds for all measurable functions h on a probability space (X,μ) and all
0 < q < ∞. See Exercise 1.1.3(b). Moreover, part (c) of the same exercise says that
the limit of the expressions on the left in (7.3.1) as q →0 is equal to the expression
on the right in (7.3.1).
We apply (7.3.1) to the function h = w−1 for some weight w in Ap with q =
1/(p−1). We obtain
w(Q)
|Q|
 1
|Q|

Q w(t)−
1
p−1 dt
p−1
≥w(Q)
|Q| exp
 1
|Q|

Q logw(t)−1 dt

,
(7.3.2)
and the limit of the expressions on the left in (7.3.2) as p →∞is equal to the ex-
pression on the right in (7.3.2). This observation provides the motivation for the
following deﬁnition.
Deﬁnition 7.3.1. A weight w is called an A∞weight if
[w]A∞=
sup
Q cubes in Rn
$ 1
|Q|

Q w(t)dt

exp
 1
|Q|

Q logw(t)−1 dt
%
< ∞.
The quantity [w]A∞is called the A∞characteristic constant of w.
It follows from the previous deﬁnition and (7.3.2) that for all 1 ≤p < ∞we have
[w]A∞≤[w]Ap .
This means that

1≤p<∞
Ap ⊆A∞,
(7.3.3)

526
7 Weighted Inequalities
but the remarkable thing is that equality actually holds in (7.3.3), a deep property
that requires some work.
Before we examine this and other characterizations of A∞weights, we discuss
some of their elementary properties.
Proposition 7.3.2. Let w ∈A∞. Then
(1) [δ λ(w)]A∞= [w]A∞, where δ λ(w)(x) = w(λx1,...,λxn) and λ > 0.
(2) [τz(w)]A∞= [w]A∞, where τz(w)(x) = w(x−z), z ∈Rn.
(3) [λw]A∞= [w]A∞for all λ > 0.
(4) [w]A∞≥1.
(5) The following is an equivalent characterization of the A∞characteristic constant
of w:
[w]A∞= sup
Qcubes
in Rn
sup
log| f| ∈L1(Q)

Q | f|wdt > 0
$
w(Q)

Q | f(t)|w(t)dt exp
 1
|Q|

Q log| f(t)|dt
%
.
(6) The measure w(x)dx is doubling; precisely, for all λ > 1 and all cubes Q we
have
w(λQ) ≤2λ n[w]λ n
A∞w(Q).
As usual, λQ here denotes the cube with the same center as Q and side length
λ times that of Q.
We note that estimate (6) is not as good as λ →∞but it can be substantially
improved using the case λ = 2. We refer to Exercise 7.3.1 for an improvement.
Proof. Properties (1)–(3) are elementary, while property (4) is a consequence of
Exercise 1.1.3(b). To show (5), ﬁrst observe that by taking f = w−1, the expression
on the right in (5) is at least as big as [w]A∞. Conversely, (7.3.1) gives
exp
 1
|Q|

Q log

| f(t)|w(t)

dt

≤1
|Q|

Q | f(t)|w(t)dt ,
which, after a simple algebraic manipulation, can be written as
w(Q)

Q | f|wdt exp
 1
|Q|

Q log| f|dt

≤w(Q)
|Q| exp

−1
|Q|

Q log|w|dt

,
whenever f does not vanish almost everywhere on Q. Taking the supremum over all
such f and all cubes Q in Rn, we obtain that the expression on the right in (5) is at
most [w]A∞.

7.3 The A∞Condition
527
To prove the doubling property for A∞weights, we ﬁx λ > 1 and we apply prop-
erty (5) to the cube λQ in place of Q and to the function
f =

c
on Q,
1
on Rn \Q,
(7.3.4)
where c is chosen so that c1/λ n = 2[w]A∞. We obtain
w(λQ)
w(λQ\Q)+cw(Q) exp
logc
λ n

≤[w]A∞,
which implies (6) if we take into account the chosen value of c.
□
7.3.2 Characterizations of A∞Weights
Having established some elementary properties of A∞weights, we now turn to some
of their deeper properties, one of which is that every A∞weight lies in some Ap
for p < ∞. It also turns out that A∞weights are characterized by the reverse H¨older
property, which as we saw is a fundamental property of Ap weights. The following
is the main theorem of this section.
Theorem 7.3.3. Suppose that w is a weight. Then w is in A∞if and only if any one
of the following conditions holds:
(a) There exist 0 < γ,δ < 1 such that for all cubes Q in Rn we have
	
x ∈Q : w(x) ≤γ Avg Qw

 ≤δ |Q|.
(b) There exist 0 < α,β < 1 such that for all cubes Q and all measurable subsets A
of Q we have
|A| ≤α |Q| =⇒w(A) ≤β w(Q).
(c) The reverse H¨older condition holds for w, that is, there exist 0 < C1,ε < ∞such
that for all cubes Q we have
 1
|Q|

Q w(t)1+ε dt
 1
1+ε
≤C1
|Q|

Q w(t)dt .
(d) There exist 0 < C2,ε0 < ∞such that for all cubes Q and all measurable subsets
A of Q we have
w(A)
w(Q) ≤C2
 |A|
|Q|
ε0
.
(e) There exist 0 < α′,β ′ < 1 such that for all cubes Q and all measurable subsets
A of Q we have
w(A) < α′ w(Q) =⇒|A| < β ′ |Q|.

528
7 Weighted Inequalities
(f) There exist p,C3 < ∞such that [w]Ap ≤C3. In other words, w lies in Ap for some
p ∈[1,∞).
All the constants C1,C2,C3,α,β,γ,δ,α′,β ′,ε,ε0, and p in (a)–(f) depend only
on the dimension n and on [w]A∞. Moreover, if any of the statements in (a)–(f) is
valid, then so is any other statement in (a)–(f) with constants that depend only on
the dimension n and the constants that appear in the assumed statement.
Proof. The proof follows from the sequence of implications
w ∈A∞=⇒(a) =⇒(b) =⇒(c) =⇒(d) =⇒(e) =⇒( f) =⇒w ∈A∞.
At each step we keep track of the way the constants depend on the constants of the
previous step. This is needed to validate the last assertion of the theorem.
w ∈A∞=⇒(a)
Fix a cube Q. Since multiplication of an A∞weight with a positive scalar does
not alter its A∞characteristic, we may assume that

Q logw(t)dt = 0. This implies
that AvgQ w ≤[w]A∞. Then we have
{x ∈Q : w(x) ≤γ Avg
Q
w}
 ≤
{x ∈Q : w(x) ≤γ[w]A∞}

=
{x ∈Q : log(1+w(x)−1) ≥log(1+(γ[w]A∞)−1)}

≤
1
log(1+(γ[w]A∞)−1)

Q log 1+w(t)
w(t)
dt
=
1
log(1+(γ[w]A∞)−1)

Q log(1+w(t))dt
≤
1
log(1+(γ[w]A∞)−1)

Q w(t)dt
≤
[w]A∞|Q|
log(1+(γ[w]A∞)−1)
= 1
2|Q|,
which proves (a ) with γ = [w]−1
A∞(e2[w]A∞−1)−1 and δ = 1
2.
(a) =⇒(b)
Let Q be ﬁxed and let A be a subset of Q with w(A) > βw(Q) for some β to be
chosen later. Setting S = Q\A, we have w(S) < (1−β)w(Q). We write S = S1 ∪S2,
where
S1 = {x ∈S : w(x) > γ Avg Qw}
and
S2 = {x ∈S : w(x) ≤γ Avg Qw}.
For S2 we have |S2| ≤δ|Q| by assumption (a ). For S1 we use Chebyshev’s inequality
to obtain
|S1| ≤
1
γ Avg
Q
w

S w(t)dt = |Q|
γ
w(S)
w(Q) ≤1−β
γ
|Q|.

7.3 The A∞Condition
529
Adding the estimates for |S1| and |S2|, we obtain
|S| ≤|S1|+|S2| ≤1−β
γ
|Q|+δ|Q| =

δ + 1−β
γ

|Q|.
Choosing numbers α,β in (0,1) such that δ + 1−β
γ
= 1−α, for example α = 1−δ
2
and β = 1−(1−δ)γ
2
, we obtain |S| ≤(1−α)|Q|, that is, |A| > α|Q|.
(b) =⇒(c)
This was proved in Corollary 7.2.4. To keep track of the constants, we note that
the choices
ε =
−1
2 logβ
log2n −logα
and
C1 = 1+
(2nα−1)ε
1−(2nα−1)εβ
as given in (7.2.6) and (7.2.7) serve our purposes.
(c) =⇒(d )
We apply ﬁrst H¨older’s inequality with exponents 1 + ε and (1 + ε)/ε and then
the reverse H¨older estimate to obtain

A w(x)dx ≤

A w(x)1+ε dx

1
1+ε
|A|
ε
1+ε
≤
 1
|Q|

Q w(x)1+ε dx

1
1+ε
|Q|
1
1+ε |A|
ε
1+ε
≤C1
|Q|

Q w(x)dx |Q|
1
1+ε |A|
ε
1+ε ,
which gives
w(A)
w(Q) ≤C1
 |A|
|Q|

ε
1+ε .
This proves (d ) with ε0 =
ε
1+ε and C2 = C1.
(d ) =⇒(e)
Pick an 0 < α′′ < 1 small enough that β ′′ = C2(α′′)ε0 < 1. It follows from (d )
that
|A| < α′′|Q| =⇒w(A) < β ′′w(Q)
(7.3.5)
for all cubes Q and all A measurable subsets of Q. Replacing A by Q\A, the impli-
cation in (7.3.5) can be equivalently written as
|A| ≥(1−α′′)|Q| =⇒w(A) ≥(1−β ′′)w(Q).
In other words, for measurable subsets A of Q we have
w(A) < (1−β ′′)w(Q) =⇒|A| < (1−α′′)|Q|,
(7.3.6)

530
7 Weighted Inequalities
which is the statement in (e ) if we set α′ = (1 −β ′′) and β ′ = 1 −α′′. Note that
(7.3.5) and (7.3.6) are indeed equivalent.
(e) =⇒( f)
We begin by examining condition (e ), which can be written as

A w(t)dt ≤α′

Q w(t)dt =⇒

A w(t)−1w(t)dt ≤β ′

Q w(t)−1w(t)dt ,
or, equivalently, as
μ(A) ≤α′μ(Q) =⇒

A w(t)−1 dμ(t) ≤β ′

Q w(t)−1 dμ(t)
after deﬁning the measure dμ(t) = w(t)dt. As we have already seen, the assertions
in (7.3.5) and (7.3.6) are equivalent. Therefore, we may use Exercise 7.3.2 to deduce
that the measure μ is doubling, i.e., it satisﬁes property (7.2.9) for some constant
Cn = Cn(α′,β ′), and hence the hypotheses of Corollary 7.2.4 are satisﬁed. We con-
clude that the weight w−1 satisﬁes a reverse H¨older estimate with respect to the
measure μ, that is, if γ,C are deﬁned as in (7.2.11) and (7.2.12) [in which α is re-
placed by α′, β by β ′, and Cn is the doubling constant of w(x)dx], then we have

1
μ(Q)

Q w(t)−1−γ dμ(t)

1
1+γ
≤
C
μ(Q)

Q w(t)−1 dμ(t)
(7.3.7)
for all cubes Q in Rn. Setting p = 1+ 1
γ and raising to the pth power, we can rewrite
(7.3.7) as the Ap condition for w. We can therefore take C3 = Cp to conclude the
proof of (f).
( f) =⇒w ∈A∞
This is trivial, since [w]A∞≤[w]Ap.
□
An immediate consequence of the preceding theorem is the following result
relating A∞to Ap.
Corollary 7.3.4. The following equality is valid:
A∞=

1≤p<∞
Ap.
Exercises
7.3.1. Let λ > 0, Q be a cube in Rn, and w ∈A∞(Rn).
(a) Show that property (6) in Proposition 7.3.2 can be improved to
w(λQ) ≤min
ε>0
(1+ε)λ n[w]λ n
A∞−1
ε
w(Q).

7.3 The A∞Condition
531
(b) Prove that
w(λQ) ≤(2λ)2n(1+log2[w]A∞)w(Q).

Hint: Part (a): Take c in (7.3.4) such that c1/λ n = (1 + ε)[w]A∞. Part (b): Use the
estimate in property (6) of Proposition 7.3.2 with λ = 2.

7.3.2. Suppose that μ is a positive Borel measure on Rn with the property that for
all cubes Q and all measurable subsets A of Q we have
|A| < α|Q| =⇒μ(A) < βμ(Q)
for some ﬁxed 0 < α,β < 1. Show that μ is doubling [i.e., it satisﬁes (7.2.9)].

Hint: Use that |S| > (1−α)|Q| ⇒μ(S) > (1−β)μ(Q) when S ⫅Q.

7.3.3. Prove that a weight w is in Ap if and only if both w and w−
1
p−1 are in A∞.

Hint: You may want to use the result of Exercise 7.2.2.

7.3.4. ([33], [343]) Prove that if P(x) is a polynomial of degree k in Rn, then
log|P(x)| is in BMO with norm depending only on k and n and not on the coef-
ﬁcients of the polynomial.

Hint: Use that all norms on the ﬁnite-dimensional space of polynomials of degree
at most k are equivalent to show that |P(x)| satisﬁes a reverse H¨older inequality.
Therefore, |P(x)| is an A∞weight and thus Exercise 7.2.3 (c) is applicable.

7.3.5. Show that the product of two A1 weights may not be an A∞weight.
7.3.6. Let g be in Lp(w) for some 1 ≤p ≤∞and w ∈Ap. Prove that g ∈L1
loc(Rn).

Hint: Let B be a ball. In the case p < ∞, write

B |g|dx =

B(|g|w−1
p )w
1
p dx and
apply H¨older’s inequality. In the case p = ∞, use that w ∈Ap0 for some p0 < ∞.

7.3.7. ([278]) Show that a weight w lies in A∞if and only if there exist γ,C > 0 such
that for all cubes Q we have
w
	
x ∈Q : w(x) > λ


≤Cλ
	
x ∈Q : w(x) > γλ


for all λ > AvgQ w.

Hint: The displayed condition easily implies that
1
|Q|

Q w1+ε
k
dx ≤
w(Q)
|Q|
ε+1
+ C′δ
γ1+ε
1
|Q|

Q w1+ε
k
dx,
where k > 0, wk = min(w,k) and δ = ε/(1+ε). Take ε > 0 small enough to obtain
the reverse H¨older condition (c ) in Theorem 7.3.3 for wk. Let k →∞to obtain the
same conclusion for w. Conversely, ﬁnd constants γ,δ ∈(0,1) as in condition (a) of
Theorem 7.3.3 and for λ > AvgQ w write the set {w > λ}∩Q as a union of maximal
dyadic cubes Qj such that λ < AvgQj w ≤2nλ for all j. Then w(Qj) ≤2nλ|Qj| ≤
2nλ
1−δ |Qj ∩{w > γλ}| and the required conclusion follows by summing on j.


532
7 Weighted Inequalities
7.4 Weighted Norm Inequalities for Singular Integrals
We now address a topic of great interest in the theory of singular integrals, their
boundedness properties on weighted Lp spaces. It turns out that a certain amount
of regularity must be imposed on the kernels of these operators to obtain the afore-
mentioned weighted estimates.
7.4.1 Singular Integrals of Non Convolution type
We introduce some deﬁnitions.
Deﬁnition 7.4.1. Let 0 < δ,A < ∞. A function K(x,y) deﬁned for x,y ∈Rn with
x ̸= y is called a standard kernel (with constants δ and A) if
|K(x,y)| ≤
A
|x−y|n ,
x ̸= y,
(7.4.1)
and whenever |x−x′| ≤1
2 max

|x−y|,|x′ −y|

we have
|K(x,y)−K(x′,y)| ≤
A|x−x′|δ
(|x−y|+|x′ −y|)n+δ
(7.4.2)
and also when |y−y′| ≤1
2 max

|x−y|,|x−y′|

we have
|K(x,y)−K(x,y′)| ≤
A|y−y′|δ
(|x−y|+|x−y′|)n+δ .
(7.4.3)
The class of all kernels that satisfy (7.4.1), (7.4.2), and (7.4.3) is denoted by
SK(δ,A).
Deﬁnition 7.4.2. Let 0 < δ,A < ∞and K in SK(δ,A). A Calder´on–Zygmund opera-
tor associated with K is a linear operator T deﬁned on S (Rn) that admits a bounded
extension on L2(Rn),
T( f)

L2 ≤B
 f

L2 ,
(7.4.4)
and that satisﬁes
T( f)(x) =

Rn K(x,y) f(y)dy
(7.4.5)
for all f ∈C ∞
0 and x not in the support of f. The class of all Calder´on–Zygmund
operators associated with kernels in SK(δ,A) that are bounded on L2 with norm at
most B is denoted by CZO(δ,A,B). Note that there is no unique T associated with
a given K. Given a Calder´on–Zygmund operator T in CZO(δ,A,B), we deﬁne the
truncated operator T (ε) as
T (ε)( f)(x) =

|x−y|>ε K(x,y) f(y)dy

7.4 Weighted Norm Inequalities for Singular Integrals
533
and the maximal operator associated with T as follows:
T (∗)( f)(x) = sup
ε>0
T (ε)( f)(x)
.
We note that if T is in CZO(δ,A,B), then T (ε)( f) and T (∗)( f) are well deﬁned
for all f in 
1≤p<∞Lp(Rn). It is also well deﬁned whenever f is locally integrable
and satisﬁes

|x−y|≥ε | f(y)||x−y|−ndy < ∞for all x ∈Rn and ε > 0.
The class of kernels in SK(δ,A) extends the family of convolution kernels that
satisfy conditions (5.3.10), (5.3.11), and (5.3.12). Obviously, the associated operators
in CZO(δ,A,B) generalize the associated convolution operators.
A fundamental property of operators in CZO(δ,A,B) is that they have bounded
extensions on all the Lp(Rn) spaces and also from L1(Rn) to weak L1(Rn). This is
proved via an adaptation of Theorem 5.3.3; see Theorem 4.2.2 in [131]. There are
analogous results for the maximal counterparts T (∗) of elements of CZO(δ,A,B).
In fact, an analogue of Theorem 5.3.5 yields that T (∗) is Lp bounded for 1 < p < ∞
and weak type (1,1); this result is contained in Theorem 4.2.4 in [131].
We discuss weighted inequalities for singular integrals for general operators in
CZO(δ,A,B). In Subsections 7.4.2 and 7.4.3, the reader may wish to replace kernels
in SK(δ,A) by the more familiar functions K(x) deﬁned on Rn \ {0} that satisfy
(5.3.10), (5.3.11), and (5.3.12).
7.4.2 A Good Lambda Estimate for Singular Integrals
The following theorem is the main result of this section.
Theorem 7.4.3. Let 1 ≤p ≤∞, w ∈Ap, and T in CZO(δ,A,B). Then there exist
positive constants1 C0 = C0(n, p,[w]Ap), ε0 = ε0(n, p,[w]Ap), and c0(n,δ), such that
if γ0 = c0(n,δ)/A, then for all 0 < γ < γ0 we have
w

{T (∗)( f) > 3λ}∩{M( f) ≤γλ}

≤C0γε0(A+B)ε0w

{T (∗)( f) > λ}

, (7.4.6)
for all locally integrable functions f for which

|x−y|≥ε | f(y)||x−y|−ndy < ∞
for all x ∈Rn and ε > 0. Here M denotes the Hardy–Littlewood maximal operator.
Proof. We write the open set
Ω = {T (∗)( f) > λ} =

j
Qj ,
1 the dependence on p is relevant only when p < ∞

534
7 Weighted Inequalities
where Qj are the Whitney cubes (see Appendix J). We set
Q∗
j = 10√nQj ,
Q∗∗
j = 10√nQ∗
j ,
where aQ denotes the cube with the same center as Q whose side length is aℓ(Q),
where ℓ(Q) is the side length of Q. We note that in view of the properties of the
Whitney cubes, the distance from Qj to Ω c is at most 4√nℓ(Qj). But the distance
from Qj to the boundary of Q∗
j is (5√n−1
2)ℓ(Qj), which is bigger than 4√nℓ(Qj).
Therefore, Q∗
j must meet Ω c and for every cube Qj we ﬁx a point yj in Ω c ∩Q∗
j. See
Figure 7.1.
Qj
Qj
Qj
**
*
yj.
..
.
x
zj
t
c
(50
-
-
 n  5   n ) l(Q )
j 
(5   n 
) l(Q )
j
1
2
Ω
Ω
Fig. 7.1 A picture of the proof.
We also ﬁx f in 
1≤p<∞Lp(Rn), and for each j we write f = f j
0 + f j
∞, where
f j
0 = f χQ∗∗
j is the part of f near Qj and f j
∞= f χ(Q∗∗
j )c is the part of f away from Qj.
We now claim that the following estimate is true:
Qj ∩{T (∗)( f) > 3λ}∩{M( f) ≤γλ}
 ≤Cn γ (A+B)
Qj
.
(7.4.7)
Once the validity of (7.4.7) is established, we apply Theorem 7.3.3 (d) when p = ∞
or Proposition 7.2.8 when p < ∞to obtain constants ε0,C2 > 0, which depend on
[w]Ap, p, n when p < ∞and on [w]A∞and n when p = ∞, such that
w

Q j ∩{T (∗)( f) > 3λ}∩{M( f) ≤γλ}

≤C2 (Cn)ε0 γε0 (A+B)ε0 w(Qj).

7.4 Weighted Norm Inequalities for Singular Integrals
535
Then a simple summation in j gives (7.4.6) with C0 = C2(Cn)ε0, and recall that C2
and ε0 depend on n and [w]Ap and on p if p < ∞.
In proving estimate (7.4.7), we may assume that for each cube Qj there exists a
z j ∈Qj such that M( f)(z j) ≤γ λ; otherwise, the set on the left in (7.4.7) is empty.
We now invoke Theorem 4.2.4 in [131], which states that T (∗) maps L1(Rn) to
L1,∞(Rn) with norm at most C(n)(A+B). We have the estimate
Qj ∩{T (∗)( f) > 3λ}∩{M( f) ≤γλ}
 ≤Iλ
0 +Iλ
∞,
(7.4.8)
where
Iλ
0 =
Qj ∩{T (∗)( f j
0) > λ}∩{M( f) ≤γλ}
,
Iλ
∞=
Qj ∩{T (∗)( f j
∞) > 2λ}∩{M( f) ≤γλ}
.
To control Iλ
0 we note that f j
0 is in L1(Rn) and we argue as follows:
Iλ
0 ≤
{T (∗)( f j
0) > λ}

≤∥T (∗)∥L1→L1,∞
λ

Rn | f j
0(x)|dx
≤C(n)(A+B)
|Q∗∗
j |
λ
1
|Q∗∗
j |

Q∗∗
j
| f(x)|dx
≤C(n)(A+B)
|Q∗∗
j |
λ
Mc( f)(z j)
≤#C(n)(A+B)
|Q∗∗
j |
λ
M( f)(z j)
≤#C(n)(A+B)
|Q∗∗
j |
λ
λ γ
= Cn (A+B)γ |Qj|.
(7.4.9)
Next we claim that Iλ
∞= 0 if we take γ sufﬁciently small. We ﬁrst show that for all
x ∈Qj we have
sup
ε>0
T (ε)( f j
∞)(x)−T (ε)( f j
∞)(yj)
 ≤C(1)
n,δ AM( f)(z j).
(7.4.10)
Indeed, let us ﬁx an ε > 0. We have
T (ε)( f j
∞)(x)−T (ε)( f j
∞)(yj)
 =


|t−x|>ε
K(x,t) f j
∞(t)dt −

|t−y j|>ε
K(yj,t) f j
∞(t)dt

≤L1 +L2 +L3 ,

536
7 Weighted Inequalities
where
L1 =


|t−y j|>ε

K(x,t)−K(yj,t)

f j
∞(t)dt
,
L2 =


|t−x|>ε
|t−y j|≤ε
K(x,t) f j
∞(t)dt
,
L3 =


|t−x|≤ε
|t−y j|>ε
K(x,t) f j
∞(t)dt
,
in view of identity (5.4.7).
We now make a couple of observations. For t /∈Q∗∗
j , x,z j ∈Qj, and yj ∈Q∗
j we
have
3
4 ≤|t −x|
|t −yj| ≤5
4 ,
48
49 ≤|t −x|
|t −z j| ≤50
49 .
(7.4.11)
Indeed,
|t −yj| ≥(50n−5√n)ℓ(Qj) ≥44nℓ(Qj)
and
|x−yj| ≤1
2
√nℓ(Qj)+√n10√nℓ(Qj) ≤11nℓ(Qj) ≤1
4 |t −yj|.
Using this estimate and the inequalities
3
4 |t −yj| ≤|t −yj|−|x−yj| ≤|t −x| ≤|t −yj|+|x−yj| ≤5
4 |t −yj|,
we obtain the ﬁrst estimate in (7.4.11). Likewise, we have
|x−z j| ≤√nℓ(Qj) ≤nℓ(Qj)
and
|t −z j| ≥(50n−1
2)ℓ(Qj) ≥49nℓ(Qj),
and these give
48
49 |t −z j| ≤|t −z j|−|x−z j| ≤|t −x| ≤|t −z j|+|x−z j| ≤50
49 |t −z j|,
yielding the second estimate in (7.4.11).
Since |x−yj| ≤1
2|t −yj| ≤1
2 max

|t −x|,|t −yj|

, we have
|K(x,t)−K(yj,t)| ≤
A|x−yj|δ
(|t −x|+|t −yj|)n+δ ≤C′
n,δA
ℓ(Qj)δ
|t −z j|n+δ ;

7.4 Weighted Norm Inequalities for Singular Integrals
537
hence, we obtain
L1 ≤

|t−z j|≥49nℓ(Qj)
C′
n,δA
ℓ(Qj)δ
|t −z j|n+δ | f(t)|dt ≤C′′
n,δAM( f)(z j)
using Theorem 2.1.10. Using (7.4.11) we deduce
L2 ≤

|t−z j|≤5
4 · 49
48 ε
A
|x−t|n χ|t−x|≥ε | f j
∞(t)|dt ≤C′
nAM( f)(z j).
Again using (7.4.11), we obtain
L3 ≤

|t−z j|≤49
48 ε
A
|x−t|n χ|t−x|≥3
4 ε | f j
∞(t)|dt ≤C′′
nAM( f)(z j).
This proves (7.4.10) with constant C(1)
n,δ = C′′
n,δ +C′
n +C′′
n.
Having established (7.4.10), we next claim that
sup
ε>0
T (ε)( f j
∞)(yj)
 ≤T (∗)( f)(yj)+C(2)
n AM( f)(z j).
(7.4.12)
To prove (7.4.12) we ﬁx a cube Qj and ε > 0. We let Rj be the smallest number such
that
Q∗∗
j ⊆B(yj,Rj).
See Figure 7.2. We consider the following two cases.
Q j
Qj
Qj
**
*
yj.
Rj
Fig. 7.2 The ball B(yj,Rj).

538
7 Weighted Inequalities
Case (1): ε ≥Rj. Since Q∗∗
j ⊆B(yj,ε), we have B(yj,ε)c ⊆(Q∗∗
j )c and therefore
T (ε)( f j
∞)(yj) = T (ε)( f)(yj),
so (7.4.12) holds easily in this case.
Case (2): 0 < ε < Rj. Note that if t ∈(Q∗∗
j )c, then |t −yj| ≥40nℓ(Qj). On the
other hand, Rj ≤diam(Q∗∗
j ) = 100n
3
2 ℓ(Qj). This implies that
Rj ≤5√n
2 |t −yj|,
when
t ∈(Q∗∗
j )c .
Notice also that in this case we have B(yj,Rj)c ⊆(Q∗∗
j )c, hence
T (R j)( f j
∞)(yj) = T (R j)( f)(yj).
Therefore, we have
T (ε)( f j
∞)(yj)
 ≤
T (ε)( f j
∞)(yj)−T (R j)( f j
∞)(yj)
+
T (R j)( f)(yj)

≤

ε≤|y j−t|≤R j
|K(yj,t)| | f j
∞(t)|dt +T (∗)( f)(yj)
≤

2
5√n R j≤|y j−t|≤R j
|K(yj,t)|| f j
∞(t)|dt +T (∗)( f)(yj)
≤
A(
2
5√n)−n
Rn
j

|z j−t|≤5
4 · 49
48 R j
| f(t)|dt +T (∗)( f)(yj)
≤C(2)
n AM( f)(z j)+T (∗)( f)(yj),
where in the penultimate estimate we used (7.4.11). The proof of (7.4.12) follows
with the required bound C(2)
n A.
Combining (7.4.10) and (7.4.12), we obtain
T (∗)( f j
∞)(x) ≤T (∗)( f)(yj)+

C(1)
n,δ +C(2)
n

AM( f)(z j).
Recalling that yj /∈Ω and that M( f)(z j) ≤γλ, we deduce
T (∗)( f j
∞)(x) ≤λ +

C(1)
n,δ +C(2)
n

Aγλ .
Setting γ0 =

C(1)
n,δ +C(2)
n
−1 A−1 = c0(n,δ)A−1, for 0 < γ < γ0, we have that the set
Qj ∩{T (∗)( f j
∞) > 2λ}∩{M( f) ≤γλ}

7.4 Weighted Norm Inequalities for Singular Integrals
539
is empty. This shows that the quantity Iγ
∞vanishes if γ is smaller than γ0. Returning
to (7.4.8) and using the estimate (7.4.9) proved earlier, we conclude the proof of
(7.4.7), which, as indicated earlier, implies the theorem.
□
Remark 7.4.4. We observe that for any δ > 0, estimate (7.4.6) also holds for the
operator
T (∗)
δ
( f)(x) = sup
ε≥δ
|T (ε)( f)(x)|
(7.4.13)
with the same constant (which is independent of δ).
To see the validity of (7.4.6) for T (∗)
δ
, it sufﬁces to prove
T (∗)
δ
( f j
∞)(yj)
 ≤T (∗)
δ
( f)(yj)+C(2)
n AM( f)(z j),
(7.4.14)
which is a version of (7.4.12) with T (∗) replaced by T (∗)
δ
. The following cases arise:
Case (1′): Rj ≤δ ≤ε or δ ≤Rj ≤ε. Here, as in Case (1) we have
|T (ε)( f j
∞)(yj)| = |T (ε)( f)(yj)| ≤T (∗)
δ
( f)(yj).
Case (2′): δ ≤ε < Rj. As in Case (2) we have
T (R j)( f j
∞)(yj) = T (R j)( f)(yj),
thus
T (ε)( f j
∞)(yj)
 ≤
T (ε)( f j
∞)(yj)−T (R j)( f j
∞)(yj)
+
T (R j)( f)(yj)
.
As in the proof of Case (2), we bound the ﬁrst term on the right of the last displayed
expression by C(2)
n AM( f)(z j) while the second term is at most T (∗)
δ
( f)(yj).
7.4.3 Consequences of the Good Lambda Estimate
Having obtained the important good lambda weighted estimate for singular inte-
grals, we now pass to some of its consequences. We begin with the following lemma:
Lemma 7.4.5. Let 1 ≤p < ∞, ε > 0, w ∈Ap, x ∈Rn, and f ∈Lp(w). Then we have

|x−y|≥ε
| f(y)|
|x−y|n dy ≤C00(w,n, p,x,ε)
f

Lp(w)
for some constant C00 depending on the stated parameters. In particular, T (ε)( f)
and T (∗)( f) are deﬁned for f ∈Lp(w).
Proof. For each ε > 0 and x pick a cube Q0 = Q0(x,ε) of side length cnε (for some
constant cn) such that Q0 ⫅B(x,ε). Set Qj = 2jQ0 for j ≥0. We have

540
7 Weighted Inequalities

|y−x|≥ε
| f(y)|
|x−y|n dy ≤Cn
∞
∑
j=0
(2jε)−n

Qj+1\Qj
| f(y)|dy
≤Cn
∞
∑
j=1
 1
|Qj|

Qj
| f(y)|pwdy
 1
p  1
|Qj|

Qj
w−p′
p dy
 1
p′
≤Cn [w]
1
p
Ap
∞
∑
j=1

Qj
| f(y)|pwdy
 1
p 
1
w(Qj)
 1
p
≤Cn [w]
1
p
Ap
 f

Lp(w)
∞
∑
j=1

w(Qj)
−1
p .
But Proposition 7.2.8 gives for some δ = δ(n, p,[w]Ap) that
w(Q0)
w(Qj) ≤C(n, p,[w]Ap)|Q0|δ
|Qj|δ ,
from which it follows that
w(Qj)−1
p ≤C′(n, p,[w]Ap)2−j nδ
p w(Q0)−1
p .
In view of this estimate, the previous series converges. Note that C′ and thus C00
depend on [w]Ap,n, p,x,ε, and w(Q0).
This argument is also valid in the case p = 1 by an obvious modiﬁcation.
□
Theorem 7.4.6. Let A,B,β > 0 and let T be a CZO(β,A,B). Then given 1 < p < ∞,
there is a constant Cp = Cp(n,β,[w]Ap) such that
T (∗)( f)

Lp(w) ≤Cp (A+B)
f

Lp(w)
(7.4.15)
for all w ∈Ap and f ∈Lp(w). There is also a constant C1 =C1(n,β,[w]A1) such that
T (∗)( f)

L1,∞(w) ≤C1 (A+B)
f

L1(w)
(7.4.16)
for all w ∈A1 and f ∈L1(w).
Proof. This theorem is a consequence of the estimate proved in the previous the-
orem. For technical reasons, it is useful to ﬁx a δ > 0 and work with the auxil-
iary maximal operator T (∗)
δ
deﬁned in (7.4.13) instead of T (∗). We begin by taking
1 < p < ∞and f ∈Lp(w) for some w ∈Ap. We write
T (∗)
δ
( f)
p
Lp(w) =
 ∞
0 pλ p−1w

{T (∗)
δ
( f) > λ}

dλ
= 3p
 ∞
0 pλ p−1w

{T (∗)
δ
( f) > 3λ}

dλ ,

7.4 Weighted Norm Inequalities for Singular Integrals
541
which we control by
3p
 ∞
0 pλ p−1w

{T (∗)
δ
( f) > 3λ}∩{M( f) ≤γλ}

dλ
+ 3p
 ∞
0 pλ p−1w

{M( f) > γλ}

dλ .
Using Theorem 7.4.3 (or rather Remark 7.4.4), there are C0 = C0(n,[w]Ap), ε0 =
ε0(n,[w]Ap), and γ0 = c0(n,β)A−1, such that the preceding displayed expression is
bounded by
3pC0γε0(A+B)ε0
 ∞
0 pλ p−1w

{T (∗)
δ
( f) > λ}

dλ
+ 3p
γ p
 ∞
0 pλ p−1w

{M( f) > λ}

dλ ,
which is equal to
3pC0γε0(A+B)ε0T (∗)
δ
( f)
p
Lp(w) + 3p
γ p
M( f)
p
Lp(w) .
Taking γ = min
 1
2c0(n,β)A−1, 1
2(2C03p)−1
ε0 (A+B)−1
< γ0, we conclude that
T (∗)
δ
( f)
p
Lp(w)
≤1
2
T (∗)
δ
( f)
p
Lp(w) + #Cp(n,β,[w]Ap)(A+B)pM( f)
p
Lp(w) .
(7.4.17)
We now prove a similar estimate when p = 1. For f ∈L1(w) and w ∈A1 we have
3λw
	
T (∗)
δ
( f) > 3λ


≤3λw
	
T (∗)
δ
( f) > 3λ

∩{M( f) ≤γλ}

+3λw

{M( f) > γλ}

,
and this expression is controlled by
3λC0γε0(A+B)ε0w
	
T (∗)
δ
( f) > λ


+ 3
γ
M( f)

L1,∞(w) .
Recalling that γ0 = c0(n,β)A−1 and choosing γ = min
 1
2γ0, 1
2(6C0)−1
ε0 (A+B)−1
,
it follows that
T (∗)
δ
( f)

L1,∞(w)
≤1
2
T (∗)
δ
( f)

L1,∞(w)+ #C1(n,β,[w]A1)(A+B)
M( f)

L1,∞(w).
(7.4.18)

542
7 Weighted Inequalities
Estimate (7.4.15) would follow from (7.4.17) if we knew that ∥T (∗)
δ
( f)∥Lp(w) < ∞
whenever 1 < p < ∞, w ∈Ap and f ∈Lp(w), while (7.4.16) would follow from
(7.4.18) if we had ∥T (∗)
δ
( f)∥L1,∞(w) < ∞whenever w ∈A1 and f ∈L1(w). Since we
do not know that these quantities are ﬁnite, a certain amount of work is needed.
To deal with this problem we momentarily restrict attention to a special class
of functions on Rn, the class of bounded functions with compact support. Such
functions are dense in Lp(w) when w ∈Ap and 1 ≤p < ∞; see Exercise 7.4.1. Let
h be a bounded function with compact support on Rn. Then T (∗)
δ
(h) ≤C1δ −n∥h∥L1
and T (∗)
δ
(h)(x) ≤C2(h)|x|−n for x away from the support of h. It follows that
T (∗)
δ
(h)(x) ≤C3(h,δ)(1+|x|)−n
for all x ∈Rn. Furthermore, if h is nonzero, then
M(h)(x) ≥
C4(h)
(1+|x|)n ,
and therefore for w ∈A1,
T (∗)
δ
(h)

L1,∞(wdx) ≤C5(h,δ)
M(h)

L1,∞(wdx) < ∞,
while for 1 < p < ∞and w ∈Ap,

Rn(T (∗)
δ
(h)(x))pw(x)dx ≤C5(h, p,δ)

Rn M(h)(x)pw(x)dx < ∞
in view of Theorem 7.1.9. Using these facts, (7.4.17), (7.4.18), and Theorem 7.1.9
once more, we conclude that for all δ > 0 and 1 < p < ∞we have
T (∗)
δ
(h)
p
Lp(w) ≤2 #Cp
M(h)
p
Lp(w) ≤#C′
p[w]
p
p−1
Ap
h
p
Lp(w) = Cp
p
h
p
Lp(w),
T (∗)
δ
(h)

L1,∞(w) ≤2 #C1
M(h)

L1,∞(w) ≤#C1[w]A1
h

L1(w) = C1
h

L1(w),
(7.4.19)
whenever h a bounded function with compact support. The constants #Cp, #C′
p, and Cp
depend only on the parameters n, β, p, and [w]Ap.
We now extend estimates (7.4.16) and (7.4.15) to functions in Lp(Rn,wdx). Given
1 ≤p < ∞, w ∈Ap, and f ∈Lp(w), let
fN(x) = f(x)χ| f|≤Nχ|x|≤N .
Then fN is a bounded function with compact support that converges to f in Lp(w)
(i.e., ∥fN −f∥Lp(w) →0 as N →∞) by the Lebesgue dominated convergence theo-
rem. Also | fN| ≤| f| for all N. Sublinearity and Lemma 7.4.5 give for all x ∈Rn,
|T (∗)
δ
( fN)(x)−T (∗)
δ
( f)(x)| ≤T (∗)
δ
( f −fN)(x)
≤AC00(w,n, p,x,δ)
fN −f

Lp(w) ,

7.4 Weighted Norm Inequalities for Singular Integrals
543
and this converges to zero as N →∞since C00(w,n, p,x,δ) < ∞. Therefore
T (∗)
δ
( f) = lim
N→∞T (∗)
δ
( fN)
pointwise, and Fatou’s lemma for weak type spaces [see Exercise 1.1.12 (d)] gives
for w ∈A1 and f ∈L1(w),
T (∗)
δ
( f)

L1,∞(w) =
liminf
N→∞T (∗)
δ
( fN)

L1,∞(w)
≤liminf
N→∞
T (∗)
δ
( fN)

L1,∞(w)
≤C1 liminf
N→∞
M( fN)

L1,∞(w)
≤C1
M( f)

L1,∞(w) ,
since | fN| ≤| f| for all N. An analogous argument gives the estimate
T (∗)
δ
( f)

Lp(w) ≤Cp
f

Lp(w)
for w ∈Ap and f ∈Lp(w) when 1 < p < ∞.
It remains to prove (7.4.15) and (7.4.16) for T (∗). But this is also an easy conse-
quence of Fatou’s lemma, since the constants Cp and C1 are independent of δ and
lim
δ→0T (∗)
δ
( f) = T (∗)( f)
for all f ∈Lp(w).
□
We end this subsection by making the comment that if a given T in CZO(δ,A,B)
is pointwise controlled by T (∗), then the estimates of Theorem 7.4.6 also hold for it.
This is the case for the Hilbert transform, the Riesz transforms, and other classical
singular integral operators.
7.4.4 Necessity of the Ap Condition
We have established the main theorems relating Calder´on–Zygmund operators and
Ap weights, namely that such operators are bounded on Lp(w) whenever w lies in
Ap. It is natural to ask whether the Ap condition is necessary for the boundedness of
singular integrals on Lp. We end this section by indicating the necessity of the Ap
condition for the boundedness of the Riesz transforms on weighted Lp spaces.
Theorem 7.4.7. Let w be a weight in Rn and let 1 ≤p < ∞. Suppose that each of the
Riesz transforms Rj is of weak type (p, p) with respect to w. Then w must be an Ap
weight. Similarly, let w be a weight in R. If the Hilbert transform H is of weak type
(p, p) with respect to w, then w must be an Ap weight.

544
7 Weighted Inequalities
Proof. We prove the n-dimensional case, n ≥2. The one-dimensional case is essen-
tially contained in following argument, suitably adjusted.
Let Q be a cube and let f be a nonnegative function on Rn supported in Q that
satisﬁes AvgQ f > 0. Let Q′ be the cube that shares a corner with Q, has the same
length as Q, and satisﬁes xj ≥yj for all 1 ≤j ≤n whenever x ∈Q′ and y ∈Q. Then
for x ∈Q′ we have

n
∑
j=1
Rj( f)(x)
 = Γ ( n+1
2 )
π
n+1
2
n
∑
j=1

Q
xj −yj
|x−y|n+1 f(y)dy ≥Γ ( n+1
2 )
π
n+1
2

Q
f(y)
|x−y|n dy.
But if x ∈Q′ and y ∈Q we must have that |x −y| ≤2√nℓ(Q), which implies that
|x −y|−n ≥(2√n)−n|Q|−1. Let Cn = Γ ( n+1
2 )(2√n)−nπ−n+1
2 . It follows that for all
0 < α < Cn AvgQ f we have
Q′ ⊆

x ∈Rn :

n
∑
j=1
Rj( f)(x)
 > α

.
Since the operator ∑n
j=1 Rj is of weak type (p, p) with respect to w (with constant
C), we must have
w(Q′) ≤Cp
α p

Q f(x)pw(x)dx
for all α < Cn AvgQ f, which implies that

Avg
Q
f
p ≤C−p
n Cp
w(Q′)

Q f(x)pw(x)dx.
(7.4.20)
We observe that we can reverse the roles of Q and Q′ and obtain

Avg
Q′ g
p ≤C−p
n Cp
w(Q)

Q′ g(x)pw(x)dx
(7.4.21)
for all g supported in Q′. In particular, taking g = χQ′ in (7.4.21) gives that
w(Q) ≤C−p
n Cpw(Q′).
Using this estimate and (7.4.20), we obtain

Avg
Q
f
p ≤(C−p
n Cp)2
w(Q)

Q f(x)pw(x)dx.
(7.4.22)
Using the characterization of the Ap characteristic constant in Proposition 7.1.5 (8),
it follows that
[w]Ap ≤(C−p
n Cp)2 < ∞;
hence w ∈Ap.
□

7.4 Weighted Norm Inequalities for Singular Integrals
545
Exercises
7.4.1. Let 1 ≤p < ∞and let w ∈L1
loc(Rn) satisfy w > 0 a.e. Show that C ∞
0 (Rn) is
dense in Lp(w). In particular this assertion holds for any w ∈A∞.
7.4.2. ([74]) Let T be in CZO(δ,A,B). Show that for all ε > 0 and all 1 < p < ∞
there exists a constant Cn,p,ε,δ such that for all f ∈Lp(Rn) and for all measurable
nonnegative functions u with u1+ε ∈L1
loc(Rn) and M(u1+ε) < ∞a.e. we have

Rn |T (∗)( f)|p udx ≤Cn,p,ε,δ(A+B)p

Rn | f|pM(u1+ε)
1
1+ε dx.

Hint: Obtain this result as a consequence of Theorems 7.4.6 and 7.2.7.

7.4.3. Use the idea of the proof of Theorem 7.4.6 to prove the following result.
Suppose that for some ﬁxed A,B > 0 the nonnegative μ-measurable functions F
and G on a σ-ﬁnite measure space (X,μ) satisfy the distributional inequality
μ

{G > α}∩{F ≤cα}

≤Aμ

{G > Bα}

for all α > 0. Given 0 < p < ∞, if A < Bp and ∥G∥Lp(μ) < ∞, show that
∥G∥Lp(μ) ≤
B
(Bp −A)1/p
1
c ∥F∥Lp(μ) .
7.4.4. Let α > 0, w ∈A1, and f ∈L1(Rn,w) ∩L1(Rn). Let f = g + b be the
Calder´on–Zygmund decomposition of f at height α > 0 given in Theorem 5.3.1,
such that b = ∑j bj, where each bj is supported in a dyadic cube Qj,

Qj bj(x)dx = 0,
and Qj and Qk have disjoint interiors when j ̸= k. Prove that
(a) ∥g∥L1(w) ≤[w]A1∥f∥L1(w) and ∥g∥L∞(w) = ∥g∥L∞≤2nα,
(b) ∥bj∥L1(w) ≤(1+[w]A1)∥f∥L1(Qj,w) and ∥b∥L1(w) ≤(1+[w]A1)∥f∥L1(w),
(c) ∑j w(Qj) ≤
[w]A1
α ∥f∥L1(w).
7.4.5. Assume that T is an operator associated with a kernel in SK(δ,A). Suppose
that T maps L2(w) to L2(w) for all w ∈A1 with bound Bw. Prove that there is a
constant Cn,δ such that
∥T∥L1(w)→L1,∞(w) ≤Cn,δ(A+Bw)[w]2
A1
for all w ∈A1.

Hint: Apply the idea of the proof of Theorem 5.3.3 using the Calder´on-Zygmund
decomposition f = g+b of Exercise 7.4.4 at height γα for a suitable γ. To estimate

546
7 Weighted Inequalities
T(g) use an L2(w) estimate and Exercise 7.4.4. To estimate T(b) use the mean value
property, the fact that

Rn\Q∗
j
|y−cj|δ
|x−cj|n+δ w(x)dx ≤Cδ,nM(w)(y) ≤C′
δ,n[w]A1 w(y),
and Exercise 7.4.4 to obtain the required estimate.

7.4.6. Recall that the transpose Tt of a linear operator T is deﬁned by
4
T( f),g
5
=
4
f,Tt(g)
5
for all suitable f and g. Suppose that T is a linear operator that maps Lp(Rn,vdx)
to itself for some 1 < p < ∞and some v ∈Ap. Show that the transpose operator Tt
maps Lp′(Rn,wdx) to itself with the same norm, where w = v1−p′ ∈Ap′.
7.4.7. Suppose that T is a linear operator that maps L2(Rn,vdx) to itself for all v
such that v−1 ∈A1. Show that the transpose operator Tt of T maps L2(Rn,wdx) to
itself for all w ∈A1.
7.4.8. Let 1 < p < ∞. Suppose that T is a linear operator that maps Lp(v) to itself
for all v satisfying v−1 ∈Ap. Show that the transpose operator Tt of T maps Lp′(w)
to itself for all w satisfying w−1 ∈Ap′.
7.5 Further Properties of Ap Weights
In this section we discuss other properties of Ap weights. Many of these proper-
ties indicate deep connections with other branches of analysis. We focus attention
on three such properties: factorization, extrapolation, and relations of weighted in-
equalities to vector-valued inequalities.
7.5.1 Factorization of Weights
Recall the simple fact that if w1,w2 are A1 weights, then w = w1 w1−p
2
is an Ap
weight (Exercise 7.1.2). The factorization theorem for weights says that the converse
of this statement is true. This provides a surprising and striking representation of Ap
weights.
Theorem 7.5.1. Suppose that w is an Ap weight for some 1 < p < ∞. Then there
exist A1 weights w1 and w2 such that
w = w1 w1−p
2
.

7.5 Further Properties of Ap Weights
547
Proof. Let us ﬁx a p ≥2 and w ∈Ap. We deﬁne an operator T as follows:
T( f) =

w−1
p M( f p−1w
1
p )

1
p−1 +w
1
p M( fw−1
p ),
where M is the Hardy–Littlewood maximal operator. We observe that T is well
deﬁned and bounded on Lp(Rn). This is a consequence of the facts that w−
1
p−1
is an Ap′ weight and that M maps Lp′(w−
1
p−1 ) to itself and also Lp(w) to itself.
Thus the norm of T on Lp depends only on the Ap characteristic constant of w.
Let B(w) = ∥T∥Lp→Lp, the norm of T on Lp. Next, we observe that for f,g ≥0 in
Lp(Rn) and λ ≥0 we have
T( f +g) ≤T( f)+T(g),
T(λ f) = λT( f).
(7.5.1)
To see the ﬁrst assertion, we need only note that for every ball B, the operator
f →
 1
|B|

B | f|p−1w
1
p dx

1
p−1
is sublinear as a consequence of Minkowski’s integral inequality, since p−1 ≥1.
We now ﬁx an Lp function f0 with ∥f0∥Lp = 1 and we deﬁne a function ϕ in
Lp(Rn) as the sum of the Lp convergent series
ϕ =
∞
∑
j=1
(2B(w))−jT j( f0).
(7.5.2)
We deﬁne
w1 = w
1
p ϕ p−1 ,
w2 = w−1
p ϕ ,
so that w = w1 w1−p
2
. It remains to show that w1,w2 are A1 weights. Applying T and
using (7.5.1), we obtain
T(ϕ) ≤2B(w)
∞
∑
j=1
(2B(w))−j−1T j+1( f0)
= 2B(w)

ϕ −T( f0)
2B(w)

≤2B(w)ϕ ,
that is,

w−1
p M(ϕ p−1w
1
p )

1
p−1 +w
1
p M(ϕw−1
p ) ≤2B(w)ϕ .
Using that ϕ = (w−1
p w1)
1
p−1 = w
1
p w2, we obtain
M(w1) ≤(2B(w))p−1w1
and
M(w2) ≤2B(w)w2 .

548
7 Weighted Inequalities
These show that w1 and w2 are A1 weights whose characteristic constants depend on
[w]Ap (and also the dimension n and p). This concludes the case p ≥2.
We now turn to the case p < 2. Given a weight w ∈Ap for 1 < p < 2, we consider
the weight w−1/(p−1), which is in Ap′. Since p′ > 2, using the result we obtained, we
write w−1/(p−1) = v1v1−p′
2
, where v1, v2 are A1 weights. It follows that w = v1−p
1
v2,
and this completes the asserted factorization of Ap weights.
□
Combining the result just obtained with Theorem 7.2.7, we obtain the following
description of Ap weights.
Corollary 7.5.2. Let w be an Ap weight for some 1 < p < ∞. Then there exist locally
integrable functions f1 and f2 with
M( f1)+M( f2) < ∞
a.e.,
constants 0 < ε1,ε2 < 1, and a nonnegative function k satisfying k,k−1 ∈L∞such
that
w = kM( f1)ε1M( f2)ε2(1−p) .
(7.5.3)
7.5.2 Extrapolation from Weighted Estimates on a Single Lp0
Our next topic concerns a striking application of the class of Ap weights. It says
that an estimate on Lp0(v) for a single p0 and all Ap0 weights v implies a similar Lp
estimate for all p in (1,∞). This property is referred to as extrapolation.
Surprisingly the operator T is not needed to be linear or sublinear in the following
extrapolation theorem. The only condition required is that T be well deﬁned on

1≤q<∞

w∈Aq Lq(w). If T happens to be a linear operator, this condition can be
relaxed to T being well deﬁned on C ∞
0 (Rn).
Theorem 7.5.3. Suppose that T is deﬁned on 
1≤q<∞

w∈Aq Lq(w) and takes values
in the space of measurable complex-valued functions. Let 1 ≤p0 < ∞and suppose
that there exists a positive increasing function N on [1,∞) such that for all weights
v in Ap0 we have
T

Lp0(v)→Lp0(v) ≤N

[v]Ap0

.
(7.5.4)
Then for any 1 < p < ∞and for all weights w in Ap we have
T

Lp(w)→Lp(w) ≤K

n, p, p0,[w]Ap

,
(7.5.5)
where
K

n, p, p0,[w]Ap

=
⎧
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎩
2N

κ1(n, p, p0)[w]
p0−1
p−1
Ap

when p < p0,
2
p−p0
p0(p−1) N

κ2(n, p, p0) [w]Ap

when p > p0,
and κ1(n, p, p0) and κ2(n, p, p0) are constants that depend on n, p, and p0.

7.5 Further Properties of Ap Weights
549
Proof. Let 1 < p < ∞and w ∈Ap. We deﬁne an operator
M′( f) = M( fw)
w
,
where M is the Hardy–Littlewood maximal operator. We observe that since w1−p′ is
in Ap′, the operator M′ maps Lp′(w) to itself; indeed, we have
M′
Lp′(w)→Lp′(w) =
M

Lp′(w1−p′)→Lp′(w1−p′)
≤Cn,p[w1−p′]
1
p′−1
Ap′
= Cn,p[w]Ap
(7.5.6)
in view of Theorem 7.1.9 and property (4) of Proposition 7.1.5.
We introduce operators M0( f) = | f| and Mk = M ◦M ◦··· ◦M, where M is the
Hardy–Littlewood maximal function and the composition is taken k times. Likewise,
we introduce powers (M′)k of M′ for k ∈Z+ ∪{0}. The following lemma provides
the main tool in the proof of Theorem 7.5.3. Its simple proof uses Theorem 7.1.9 and
(7.5.6) and is omitted.
Lemma 7.5.4. Let 1 < p < ∞and w ∈Ap. Deﬁne operators R and R′
R( f) =
∞
∑
k=0
Mk( f)

2∥M∥Lp(w)→Lp(w)
k
for functions f in Lp(w) and also
R′( f) =
∞
∑
k=0
(M′)k( f)

2
M′
Lp′(w)→Lp′(w)
k
for functions f in Lp′(w). Then there exist constants C1(n, p) and C2(n, p) that de-
pend on n and p such that
| f| ≤R( f),
(7.5.7)
R( f)

Lp(w) ≤2
f

Lp(w) ,
(7.5.8)
M(R( f)) ≤C1(n, p)[w]
1
p−1
Ap R( f),
(7.5.9)
for all functions f in Lp(w) and such that
|h| ≤R′(h),
(7.5.10)
R′(h)

Lp′(w) ≤2
h

Lp′(w) ,
(7.5.11)
M′(R′(h)) ≤C2(n, p)[w]Ap R′(h),
(7.5.12)
for all functions h in Lp′(w).

550
7 Weighted Inequalities
We now proceed with the proof of the theorem. It is natural to split the proof into
the cases p < p0 and p > p0.
Case (1): p < p0. Assume momentarily that R( f)
−
p0
(p0/p)′ is an Ap0 weight. Then we
have
T( f)
p
Lp(w)
=

Rn |T( f)|pR( f)
−
p
(p0/p)′ R( f)
p
(p0/p)′ wdx
≤

Rn |T( f)|p0R( f)
−
p0
(p0/p)′ wdx
 p
p0 
Rn R( f)p wdx

1
(p0/p)′
≤N

R( f)
−
p0
(p0/p)′ 
Ap0
p
Rn | f|p0R( f)
−
p0
(p0/p)′ wdx
 p
p0 
Rn R( f)p wdx

1
(p0/p)′
≤N

R( f)
−
p0
(p0/p)′ 
Ap0
p
Rn R( f)p0R( f)
−
p0
(p0/p)′ wdx
 p
p0
Rn R( f)p wdx

1
(p0/p)′
= N

R( f)
−
p0
(p0/p)′ 
Ap0
p
Rn R( f)pwdx
 p
p0 
Rn R( f)p wdx

1
(p0/p)′
≤N

R( f)
−
p0
(p0/p)′ 
Ap0
p
2
 f

Lp(w)
p ,
where we used H¨older’s inequality with exponents p0/p and (p0/p)′, the hypothesis
of the theorem, (7.5.7), and (7.5.8). Thus, we have the estimate
T( f)

Lp(w) ≤2N

R( f)
−
p0
(p0/p)′ 
Ap0
f

Lp(w)
(7.5.13)
and it remains to obtain a bound for the Ap0 characteristic constant of R( f)
−
p0
(p0/p)′ .
In view of (7.5.9), the function R( f) is an A1 weight with characteristic constant at
most a constant multiple of [w]
1
p−1
Ap . Consequently, there is a constant C′
1 such that
R( f)−1 ≤C′
1 [w]
1
p−1
Ap
 1
|Q|

Q R( f)dx
−1
for any cube Q in Rn. Thus we have
1
|Q|

Q R( f)
−
p0
(p0/p)′ wdx
≤

C′
1 [w]
1
p−1
Ap

p0
(p0/p)′
 1
|Q|

Q R( f)dx
−
p0
(p0/p)′ 1
|Q|

Q wdx

.
(7.5.14)

7.5 Further Properties of Ap Weights
551
Next we have
 1
|Q|

Q

R( f)
−
p0
(p0/p)′ w
1−p′
0 dx
p0−1
=
 1
|Q|

Q R( f)
p0(p′
0−1)
(p0/p)′ w1−p′
0 dx
p0−1
≤
 1
|Q|

Q R( f)dx

p0
(p0/p)′  1
|Q|

Q w1−p′p−1
,
(7.5.15)
where we applied H¨older’s inequality with exponents
 p′ −1
p′
0 −1
′
and
p′ −1
p′
0 −1 ,
and we used that
p0(p′
0 −1)
(p0/p)′
 p′ −1
p′
0 −1
′
= 1
and
p0 −1

p′−1
p′
0−1
′ =
p0
(p0/p)′ .
Multiplying (7.5.14) by (7.5.15) and taking the supremum over all cubes Q in Rn we
deduce that
/
R( f)
−
p0
(p0/p)′ 0
Ap0
≤

C′
1 [w]
1
p−1
Ap

p0
(p0/p)′ [w]Ap = κ1(n, p, p0)[w]
p0−1
p−1
Ap
.
Combining this estimate with (7.5.13) and using the fact that N is an increasing
function, we obtain the validity of (7.5.5) in the case p < p0.
Case (2): p > p0. In this case we set r = p/p0 > 1. Then we have
T( f)
p
Lp(w) =
|T( f)|p0r
Lr(w) =

Rn |T( f)|p0hwdx
r
(7.5.16)
for some nonnegative function h with Lr′(w) norm equal to 1. We deﬁne a function
H =

R′
h
r′
p′  p′
r′ .
Obviously, we have 0 ≤h ≤H and thus

Rn |T( f)|p0hwdx ≤

Rn |T( f)|p0H wdx
≤N

[H w]Ap0
p0 f
p0
Lp0(H w)
≤N

[H w]Ap0
p0| f|p0
Lr(w)
H

Lr′(w)
≤2
p′
r′ N

[H w]Ap0
p0f
p0
Lp(w) ,
(7.5.17)

552
7 Weighted Inequalities
noting that
H
r′
Lr′(w) =

Rn R′(hr′/p′)p′ wdx ≤2p′ 
Rn hr′ wdx = 2p′ ,
which is valid in view of (7.5.11). Moreover, this argument is based on the hypothesis
of the theorem and requires that H w be an Ap0 weight. To see this, we observe that
condition (7.5.12) implies that Hr′/p′w is an A1 weight with characteristic constant
at most a multiple of [w]A1. Thus, there is a constant C′
2 that depends only on n and
p such that
1
|Q|

Q H
r′
p′ wdx ≤C′
2 [w]ApH
r′
p′ w
for all cubes Q in Rn. From this it follows that
(H w)−1 ≤κ2(n, p, p0)[w]
p′
r′
Ap
 1
|Q|

Q H
r′
p′ wdx
−p′
r′
w
p′
r′ −1 ,
where we set κ2(n, p, p0) = (C′
2)p′/r′. We raise the preceding displayed expression
to the power p′
0 −1, we average over the cube Q, and then we raise to the power
p0 −1. We deduce the estimate
 1
|Q|

Q(H w)1−p′
0 dx
p0−1
≤κ2(n, p, p0)[w]
p′
r′
Ap
 1
|Q|

Q H
r′
p′ wdx
−p′
r′  1
|Q|

Q w1−p′ dx
p0−1
,
(7.5.18)
where we use the fact that
 p′
r′ −1

p′
0 −1

= 1−p′ .
Note that r′/p′ ≥1, since p0 ≥1. Using H¨older’s inequality with exponents r′/p′
and (r′/p′)−1 we obtain that
1
|Q|

Q H wdx ≤
 1
|Q|

Q H
r′
p′ wdx
 p′
r′  1
|Q|

Q wdx
 p0−1
p−1
,
(7.5.19)
where we used that
1
( r′
p′ )′ = p0 −1
p−1 .
Multiplying (7.5.18) by (7.5.19), we deduce the estimate

H w

Ap0 ≤κ2(n, p, p0)[w]
p′
r′
Ap [w]
p0−1
p−1
Ap
= κ2(n, p, p0)[w]Ap .

7.5 Further Properties of Ap Weights
553
Inserting this estimate in (7.5.17) we obtain

Rn |T( f)|p0hwdx ≤2
p′
r′ N

κ2(n, p, p0)[w]Ap
p0f
p0
Lp(w) ,
and combining this with (7.5.16) we conclude that
T( f)
p
Lp(w) ≤2
p′r
r′ N

κ2(n, p, p0)[w]Ap
p0rf
p0r
Lp(w) .
This proves the required estimate (7.5.5) in the case p > p0.
□
There is a version of Theorem 7.5.3 in which the initial strong type assumption
is replaced by a weak type estimate.
Theorem 7.5.5. Suppose that T is a well deﬁned operator on 
1<q<∞

w∈Aq Lq(w)
that takes values in the space of measurable complex-valued functions. Fix 1 ≤
p0 < ∞and suppose that there is an increasing function N on [1,∞) such that for all
weights v in Ap0 we have
T

Lp0(v)→Lp0,∞(v) ≤N([v]Ap0).
(7.5.20)
Then for any 1 < p < ∞and for all weights w in Ap we have
T

Lp(w)→Lp,∞(w) ≤K

n, p, p0,[w]Ap

,
(7.5.21)
where K

n, p, p0,[w]Ap

is as in Theorem 7.5.3.
Proof. For every ﬁxed λ > 0 we deﬁne
Tλ( f) = λχ|T( f)|>λ .
The operator Tλ is not linear but is well deﬁned on 
1<q<∞

w∈Aq Lq(w), since T is
well deﬁned on this union. We show that Tλ maps Lp0(v) to Lp0(v) for every v ∈Ap0.
Indeed, we have

Rn |Tλ( f)|p0 vdx
 1
p0 =

Rn λ p0χ|T( f)|>λ vdx
 1
p0
=

λ p0v

{|T( f)| > λ}
 1
p0
≤N([v]Ap0)
f

Lp0(v)
using the hypothesis on T. Applying Theorem 7.5.3, we obtain that Tλ maps Lp(w)
to itself for all 1 < p < ∞and all w ∈Ap with a constant independent of λ. Precisely,
for any w ∈Ap and any f ∈Lp(w) we have
Tλ( f)

Lp(w) ≤K

n, p, p0,[w]Ap
 f

Lp(w) .

554
7 Weighted Inequalities
Since
T( f)

Lp,∞(w) = sup
λ>0
Tλ( f)

Lp(w) ,
it follows that T maps Lp(w) to Lp,∞(w) with the asserted norm.
□
Assuming that the operator T in the preceding theorem is sublinear (or quasi-
sublinear), we obtain the following result that contains a stronger conclusion.
Corollary 7.5.6. Suppose that T is a sublinear operator on 
1<q<∞

w∈Aq Lq(w)
that takes values in the space of measurable complex-valued functions. Fix 1 ≤
p0 < ∞and suppose that there is an increasing function N on [1,∞) such that for all
weights v in Ap0 we have
T

Lp0(v)→Lp0,∞(v) ≤N([v]Ap0).
(7.5.22)
Then for any 1 < p < ∞and any weight w in Ap there is a constant K′(n, p, p0,[w]Ap)
such that
T( f)

Lp(w) ≤K′(n, p, p0,[w]Ap)
f

Lp(w) .
Proof. The proof follows from Theorem 7.5.5 and the Marcinkiewicz interpolation
theorem.
□
We end this subsection by observing that the conclusion of the extrapolation The-
orem 7.5.3 can be strengthened to yield vector-valued estimates. This strengthening
may be achieved by a simple adaptation of the proof discussed.
Corollary 7.5.7. Suppose that T is deﬁned on 
1≤q<∞

w∈Aq Lq(w) and takes val-
ues in the space of all measurable complex-valued functions. Fix 1 ≤p0 < ∞and
suppose that there is an increasing function N on [1,∞) such that for all weights v
in Ap0 we have
T

Lp0(v)→Lp0(v) ≤N

[v]Ap0

.
Then for every 1 < p < ∞and every weight w ∈Ap we have


∑
j
|T( f j)|p0
 1
p0 
Lp(w) ≤K(n, p, p0,[w]Ap)


∑
j
| f j|p0
 1
p0 
Lp(w)
for all sequences of functions f j in Lp(w), where K

n, p, p0,[w]Ap

is as in Theorem
7.5.3.
Proof. To derive the claimed vector-valued inequality follow the proof of Theorem
7.5.3 replacing the function f by (∑j | f j|p0)
1
p0 and T( f) by (∑j |T( f j)|p0)
1
p0 .
□
7.5.3 Weighted Inequalities Versus Vector-Valued Inequalities
We now discuss connections between weighted inequalities and vector-valued
inequalities. The next result provides strong evidence that there is a nontrivial

7.5 Further Properties of Ap Weights
555
connection of this sort. The following is a general theorem saying that any vector-
valued inequality is equivalent to some weighted inequality. The proof of the the-
orem is based on a minimax lemma whose precise formulation and proof can be
found in Appendix H.
Theorem 7.5.8. (a) Let 0 < p < q,r < ∞. Let {Tj}j be a sequence of sublinear
operators that map Lq(μ) to Lr(ν), where μ and ν are arbitrary measures. Then
the vector-valued inequality

∑
j
|Tj( f j)|p1
p

Lr ≤C

∑
j
| f j|p1
p

Lq
(7.5.23)
holds for all f j ∈Lq(μ) if and only if for every u ≥0 in L
r
r−p (ν) there exists U ≥0
in L
q
q−p (μ) with
∥U∥
L
q
q−p ≤∥u∥L
r
r−p ,
sup
j

|Tj( f)|p udν ≤Cp

| f|pU dμ .
(7.5.24)
(b) Let 0 < q,r < p < ∞. Let {Tj}j be as before. Then the vector-valued inequality
(7.5.23) holds for all f j ∈Lq(μ) if and only if for every u ≥0 in L
q
p−q (μ) there exists
U ≥0 in L
r
p−r (ν) with
∥U∥L
r
p−r ≤∥u∥
L
q
p−q ,
sup
j

|Tj( f)|pU−1 dν ≤Cp

| f|p u−1 dμ .
(7.5.25)
Proof. We begin with part (a). Given f j ∈Lq(Rn,μ), we use (7.5.24) to obtain


∑
j
|Tj( f j)|p 1
p 
Lr(ν) =
∑
j
|Tj( f j)|p
1
p
L
rp (ν)
=
sup
∥u∥
L
r
r−p ≤1

Rn∑
j
|Tj( f j)|p udν
1
p
≤
sup
∥u∥
L
r
r−p ≤1
C

Rn∑
j
| f j|pU dμ
1
p
≤
sup
∥u∥
L
r
r−p ≤1
C
∑
j
| f j|p
1
p
L
q
p (μ)∥U∥
1
p
L
q
q−p
≤C


∑
j
| f j|p 1
p 
Lq(μ) ,

556
7 Weighted Inequalities
which proves (7.5.23) with the same constant C as in (7.5.24). To prove the converse,
given a nonnegative u ∈L
r
r−p (ν) with ∥u∥L
r
r−p = 1, we deﬁne
A =
	
a = (a0,a1) : a0 = ∑
j
| f j|p,
a1 = ∑
j
|Tj( f j)|p,
f j ∈Lq(μ)

and
B =
	
b ∈L
q
q−p (μ) : b ≥0,
∥b∥
L
q
q−p ≤1 = ∥u∥L
r
r−p

.
Notice that A and B are convex sets and B is weakly compact. (The sublinearity of
each Tj is used here.) We deﬁne the function Φ on A×B by setting
Φ(a,b) =

a1udν −Cp

a0bdμ = ∑
j

|Tj( f j)|pudν −Cp

| f j|pbdμ

.
Then Φ is concave on A and weakly continuous and convex on B. Thus the minimax
lemma in Appendix H is applicable. This gives
min
b∈B sup
a∈A
Φ(a,b) = sup
a∈A
min
b∈B Φ(a,b).
(7.5.26)
At this point observe that for a ﬁxed a =

∑j | f j|p,∑j |Tj( f j)|p
in A we have
min
b∈B Φ(a,b) ≤
∑
j
|Tj( f j)|p
L
rp (ν)∥u∥L
r
r−p −Cp max
b∈B

∑
j
| f j|p bdμ
≤
∑
j
|Tj( f j)|p
L
rp (ν) −Cp∑
j
| f j|p
L
q
p (μ) ≤0
using the hypothesis (7.5.23). It follows that supa∈A minb∈B Φ(a,b) ≤0 and hence
(7.5.26) yields minb∈B supa∈A Φ(a,b) ≤0. Thus there exists a U ∈B such that
Φ(a,U) ≤0 for every a ∈A. This completes the proof of part (a).
The proof of part (b) is similar. Using the result of Exercise 7.5.1 and (7.5.25),
given f j ∈Lq(Rn,μ) we have

∑
j
| f j|p 1
p

Lq(μ) =
∑
j
| f j|p
1
p
L
q
p (μ)
=
inf
∥u∥
L
q
p−q ≤1

Rn∑
j
| f j|p u−1 dμ
1
p
≥1
C
inf
∥U∥
L
r
p−r ≤1

Rn∑
j
|Tj( f j)|pU−1 dν
1
p

7.5 Further Properties of Ap Weights
557
= 1
C
∑
j
|Tj( f j)|p
1
p
L
rp (ν)
= 1
C


∑
j
|Tj( f j)|p 1
p 
Lr(ν) .
To prove the converse direction in part (b), given a ﬁxed u ≥0 in L
q
p−q (μ) with
u

L
q
p−q = 1, we deﬁne A as in part (a) and
B =
	
b ∈L
p
p−r (ν) : b ≥0,
∥b∥
L
p
p−r ≤1 = ∥u∥
L
q
p−q

.
We also deﬁne the function Φ on A×B by setting
Φ(a,b) =

a1b−1dν −Cp

a0u−1 dμ
= ∑
j

|Tj( f j)|pb−1 dν −Cp

| f j|pu−1 dμ

.
Then Φ is concave on A and weakly continuous and convex on B. Also, using Exer-
cise 7.5.1, for any a =

∑j | f j|p,∑j |Tj( f j)|p
in A, we have
min
b∈B Φ(a,b) ≤
∑
j
|Tj( f j)|p
L
rp (ν) −Cp∑
j
| f j|p
L
q
p (μ) ≤0.
Thus supa∈A minb∈B Φ(a,b) ≤0. Using (7.5.26), yields minb∈B supa∈A Φ(a,b) ≤0,
and the latter implies the existence of a U in B such that Φ(a,U) ≤0 for all a ∈A.
This proves (7.5.25).
□
Example 7.5.9. We use the previous theorem to obtain another proof of the vector-
valued Hardy–Littlewood maximal inequality in Corollary 5.6.5. We take Tj = M for
all j. For given 1 < p < q < ∞and u in L
q
q−p we set s =
q
q−p andU = ∥M∥−1
Ls→Ls M(u).
In view of Exercise 7.1.7 we have
∥U∥Ls ≤∥u∥Ls
and

Rn M( f)p udx ≤Cp

Rn | f|pU dx.
Using Theorem 7.5.8, we obtain

∑
j
|M( f j)|p1
p

Lq ≤Cn,p,q

∑
j
| f j|p1
p

Lq
(7.5.27)
whenever 1 < p < q < ∞, an inequality obtained earlier in (5.6.25).
It turns out that no speciﬁc properties of the Hardy–Littlewood maximal function
were used in the preceding inequality, and one could obtain a general result along
these lines.

558
7 Weighted Inequalities
Exercises
7.5.1. Let (X,μ) be a measure space, 0 < s < 1, and f ∈Ls(X,μ). Show that
f

Ls = inf
$
X | f|u−1 dμ : ∥u∥L
s
1−s ≤1
%
and that the inﬁmum is attained.

Hint: Try u = c| f|1−s for a suitable constant c.

7.5.2. (K. Yabuta) Let w ∈Ap for some 1 < p < ∞and let f be in Lp
loc(Rn,wdx).
Show that f lies in L1
loc(Rn).

Hint: Write w = w1/wp−1
2
via Theorem 7.5.1.

7.5.3. Use the same idea of the proof of Theorem 7.5.1 to prove the following gen-
eral result: Let μ be a positive measure on a measure space X and let T be a bounded
sublinear operator on Lp(X,μ) for some 1 ≤p < ∞. Suppose that T( f) ≥0 for all f
in Lp(X,μ). Prove that for all f0 ∈Lp(X,μ), there exists an f ∈Lp(X,μ) such that
(a) f0(x) ≤f(x) for μ-almost all x ∈X.
(b) ∥f∥Lp(X) ≤2∥f0∥Lp(X).
(c) T( f)(x) ≤2∥T∥Lp→Lp f(x) for μ-almost all x ∈X.

Hint: Try the expression in (7.5.2) starting the sum at j = 0.

7.5.4. ([100]) Suppose that T is an operator deﬁned on 
1<q<∞

w∈Aq Lq(w) that
satisﬁes ∥T∥Lr(v)→Lr(v) ≤N([v]Ar) for some increasing function N : [1,∞) →R+.
Without using Theorem 7.5.3 prove that for 1 < q < r and all v ∈A1, T maps Lq(v)
to Lq(v) with constant depending on q,r, n, and [v]A1.

Hint: H¨older’s inequality gives that
T( f)

Lq(v) ≤

Rn |T( f)(x)|rM( f)(x)q−r v(x)dx
1
r 
Rn M( f)(x)qv(x)dx
r−q
rq
.
Then use the fact that the weight M( f)
r−q
r−1 is in A1 and Exercise 7.1.2.

7.5.5. Let T be a sublinear operator deﬁned on 
2≤q<∞Lq. Suppose that for all
functions f and u we have

Rn |T( f)|2udx ≤

Rn | f|2M(u)dx.
Prove that T maps Lp(Rn) to itself for all 2 < p < ∞.

Hint: Use that
T( f)

Lp =
sup
∥u∥L(p/2)′ ≤1

Rn |T( f)|2udx
1
2
and H¨older’s inequality.


7.5 Further Properties of Ap Weights
559
7.5.6. (X. C. Li) Let T be a sublinear operator deﬁned on 
1<q≤2

w∈Aq Lq(w).
Suppose that T maps L2(w) to L2(w) for all weights w that satisfy w−1 ∈A1. Prove
that T maps Lp to itself for all 1 < p < 2.

Hint: We have
T( f)

Lp ≤

Rn |T( f)|2M( f)−(2−p) dx
1
2 
Rn M( f)p dx
2−p
2p
by H¨older’s inequality. Apply the hypothesis to the ﬁrst term of the product.

HISTORICAL NOTES
Weighted inequalities can probably be traced back to the beginning of integration, but the
Ap condition ﬁrst appeared in a paper of Rosenblum [298] in a somewhat different form. The
characterization of Ap when n = 1 in terms of the boundedness of the Hardy–Littlewood maximal
operator was obtained by Muckenhoupt [260]. The estimate on the norm in (7.1.25) can also be
reversed, as shown by Buckley [38]. The simple proof of Theorem 7.1.9 is contained in Lerner’s
article [218] and yields both the Muckenhoupt theorem and Buckley’s optimal growth of the norm
of the Hardy–Littlewood maximal operator in terms of the Ap characteristic constant of the weight.
Another proof of this result is given by Christ and Fefferman [61]. Versions of Lemma 7.1.10 for
balls were ﬁrst obtained by Besicovitch [27] and independently by Morse [258]. The particular
version of Lemma 7.1.10 that appears in the text is adapted from that in de Guzm´an [93]. Another
version of this lemma is contained in the book of Mattila [246]. The fact that A∞is the union
of the Ap spaces was independently obtained by Muckenhoupt [261] and Coifman and Fefferman
[66]. The latter paper also contains a proof that Ap weights satisfy the crucial reverse H¨older
condition. This condition ﬁrst appeared in the work of Gehring [125] in the following context: If F
is a quasiconformal homeomorphism from Rn into itself, then |det(∇F)| satisﬁes a reverse H¨older
inequality. The characterization of A1 weights is due to Coifman and Rochberg [68]. The fact that
M( f)δ is in A∞when δ < 1 was previously obtained by C´ordoba and Fefferman [74]. The different
characterizations of A∞(Theorem 7.3.3) are implicit in [260] and [66]. Another characterization of
A∞in terms of the Gurov-Reshetnyak condition supQ
1
|Q|

Q | f −AvgQ f|dx ≤ε AvgQ f for f ≥0
and 0 < ε < 2 was obtained by Korenovskyy, Lerner, and Stokolos [201]. The deﬁnition of A∞
using the reverse Jensen inequality herein was obtained as an equivalent characterization of that
space by Garc´ıa-Cuerva and Rubio de Francia [122] (p. 405) and independently by Hrusˇcev [161].
The reverse H¨older condition was extensively studied by Cruz-Uribe and Neugebauer [82].
Weighted inequalities with weights of the form |x|a for the Hilbert transform were ﬁrst obtained
by Hardy and Littlewood [147] and later by Stein [332] for other singular integrals. The necessity
and sufﬁciency of the Ap condition for the boundedness of the Hilbert transform on weighted Lp
spaces was obtained by Hunt, Muckenhoupt, and Wheeden [167]. Historically, the ﬁrst result re-
lating Ap weights and the Hilbert transform is the Helson-Szeg˝o theorem [149], which says that
the Hilbert transform is bounded on L2(w) if and only if logw = u+Hv, where u,v ∈L∞(R) and
∥v∥L∞< π
2 . The Helson-Szeg˝o condition easily implies the A2 condition, but the only known direct
proof for the converse gives ∥v∥L∞< π; see Coifman, Jones, and Rubio de Francia [67]. A related
result in higher dimensions was obtained by Garnett and Jones [123]. Weighted Lp estimates con-
trolling Calder´on–Zygmund operators by the Hardy–Littlewood maximal operator were obtained
by Coifman [65]. Coifman and Fefferman [66] extended one-dimensional weighted norm inequal-
ities to higher dimensions and also obtained good lambda inequalities for A∞weights for more
general singular integrals and maximal singular integrals (Theorem 7.4.3). Bagby and Kurtz [19],
and later Alvarez and P´erez [4], gave a sharper version of Theorem 7.4.3, by replacing the good
lambda inequality by a rearrangement inequality. See also the related work of Lerner [217]. The
following relation ∥Md( f)∥Lp(w) ≤C(p,n,[w]A∞)∥M#( f)∥Lp(w) between the dyadic maximal func-
tion and the sharp maximal function is valid for any w ∈A∞under the condition M( f) ∈Lp0 but

560
7 Weighted Inequalities
also under the weaker assumption that w({| f| > t}) < ∞for every t > 0; see Kurtz [208]. Using
that min(M,w) is an A∞weight with constant independent of M and Fatou’s lemma, this condition
can be relaxed to |{| f| > t}| < ∞for every t > 0. A rearrangement inequality relating f and M#( f)
is given in Bagby and Kurtz [18].
The factorization of Ap weights was conjectured by Muckenhoupt and proved by Jones [179].
The simple proof given in the text can be found in [67]. Extrapolation of operators (Theorem 7.5.3)
is due to Rubio de Francia [300]. An alternative proof of this theorem was given later by Garc´ıa-
Cuerva [121]. The value of the constant K(n, p, p0,[w]Ap) ﬁrst appeared in Dragiˇcevi´c, Grafakos,
Pereyra, and Petermichl [98]. Another proof with sharp bounds (in terms of the characteristic con-
stant of the weights) was given by Duoandikoetxea [101]. The present treatment of Theorem 7.5.3,
based on crucial Lemma 7.5.4, was communicated to the author by J. M. Martell. One may also
consult the related work of Cruz-Uribe, Martell, and P´erez [80]. The simple proof of Theorem 7.5.5
was conceived by J. M. Martell and ﬁrst appeared in the treatment of extrapolation of operators of
many variables; see Grafakos and Martell [135]. The idea of extrapolation can be carried to general
pairs of functions, see Cruz-Uribe, Martell, and P´erez [78]. Estimates for the distribution function
in extrapolation theory were obtained by Carro, Torres, and Soria [58]. The equivalence between
vector-valued inequalities and weighted norm inequalities of Theorem 7.5.8 is also due to Rubio de
Francia [299]. The difﬁcult direction in this equivalence is obtained using a minimax principle (see
Fan [111]). Alternatively, one can use the factorization theory of Maurey [247], which brings an
interesting connection with Banach space theory. The book of Garc´ıa-Cuerva and Rubio de Francia
[122] provides an excellent reference on this and other topics related to weighted norm inequalities.
A primordial double-weighted norm inequality is the observation of Fefferman and Stein [115]
that the maximal function maps Lp(M(w)) to Lp(w) for nonnegative measurable functions w (Exer-
cise 7.1.7). Sawyer [312] obtained that the condition supQ

Q v1−p′dx
−1
Q M(v1−p′χQ)pwdx < ∞
provides a characterization of all pairs of weights (v,w) for which the Hardy–Littlewood maximal
operator M maps Lp(v) to Lp(w). Simpler proofs of this result were obtained by Cruz-Uribe [77]
and Verbitsky [367]. The fact that Sawyer’s condition reduces to the usual Ap condition when v = w
was shown by Hunt, Kurtz, and Neugebauer [166]. The two-weight problem for singular integrals
is more delicate, since they are not necessarily bounded from Lp(M(w)) to Lp(w). Known results
in this direction are that singular integrals map Lp(M[p]+1(w)) to Lp(w), where Mr denotes the rth
iterate of the maximal operator. See Wilson [377] (for 1 < p < 2) and P´erez [277] for the remaining
p’s. A necessary condition for the boundedness of the Hilbert transform from Lp(v) to Lp(w) was
obtained by Muckenhoupt and Wheeden [262].
For an approach to two-weighted inequalities using Bellman functions, we refer to the article of
Nazarov, Treil, and Volberg [266]. The notion of Bellman functions originated in control theory;
the article [267] of the previous authors analyzes the connections between optimal control and
harmonic analysis. Bellman functions have been used to derive estimates for the norms of classical
operators on weighted Lebesgue spaces; for instance, Petermichl [279] showed that for w ∈A2(R),
the norm of the Hilbert transform from L2(R,w) to L2(R,w) is bounded by a constant times the
characteristic constant [w]A2.
The theory of Ap weights in this chapter carries through to the situation in which Lebesgue
measure is replaced by a general doubling measure. This theory also has a substantial analogue
when the underlying measure is nondoubling but satisﬁes μ(∂Q) = 0 for all cubes Q in Rn with
sides parallel to the axes; see Orobitg and P´erez [272]. A thorough account of weighted Littlewood–
Paley theory and exponential-square function integrability is contained in the book of Wilson [378].
The conjecture whether ∥T∥L1(M(w))→L1,∞(w) < ∞holds for a weight w was disproved by
Reguera [287] when T is a Haar multiplier and then by Reguera and Thiele [288] for the Hilbert
transform. However, the slightly weaker version of this inequality, in which M(w) is replaced by
the Orlicz maximal operator ML(logL)ε (w), holds for any ε > 0 and any Calder´on-Zygmund oper-
ator T, as shown by P´erez [277]. For A1 weights w the aforementioned conjecture would imply
∥T∥L1(w)→L1,∞(w) ≤C[w]A1. However, Nazarov, Reznikov, Vasyunin, and Volberg [265] disproved
the weaker inequality ∥T∥L1(w)→L1,∞(w) ≤C[w]A1

log(e + [w]A1)
α for α < 1
5. Lerner, Ombrosi,
and P´erez [223] had previously shown that the preceding inequality holds with α = 1 for any
Calder´on-Zygmund operator T.

7.5 Further Properties of Ap Weights
561
Concerning the sharp weighted bound ∥T∥L2(w)→L2(w) ≤cT [w]A2 for a Calder´on-Zygmund op-
erator T we have the work of Petermichl and Volberg [281] which answered a question by Astala,
Iwaniecz and Saksman [14] on the regularity of solutions to the Beltrami equation. The proofs of
this inequality for the Hilbert and Riesz transforms via the Bellman function technique were ob-
tained soon afterwards by Petermichl [279], [280]. The use of Bellman functions was ﬁrst avoided
in the work of Lacey, Petermichl, and Reguera [210], whose proof recovered the already known
cases and used Haar shift operators, the two-weight theory for them of Nazarov, Treil and Volberg
[268], and corona decompositions. The simplest proof for these classical operators was obtained
by Cruz-Uribe, Martell, and P´erez [79], [81] using a very powerful inequality due to Lerner [219].
The complete proof for a general Calder´on-Zygmund operator was given by Hyt¨onen [168]. A sim-
pliﬁed proof was provided by Lerner [220], [221]. For other improvements and estimates involving
Ap and A∞constants see the work of Lerner [222], Hyt¨onen and P´erez [170], and Lacey, Hyt¨onen,
and P´erez [169].

Appendix A
Gamma and Beta Functions
A.1 A Useful Formula
The following formula is valid:

Rn e−|x|2dx =
√π
n .
This is an immediate consequence of the corresponding one-dimensional identity
 +∞
−∞e−x2dx = √π ,
which is usually proved from its two-dimensional version by switching to polar
coordinates:
I2 =
 +∞
−∞
 +∞
−∞e−x2e−y2 dydx = 2π
 ∞
0 re−r2 dr = π .
A.2 Deﬁnitions of Γ (z) and B(z,w)
For a complex number z with Rez > 0 deﬁne
Γ (z) =
 ∞
0 tz−1e−tdt.
Γ (z) is called the gamma function. It follows from its deﬁnition that Γ (z) is analytic
on the right half-plane Rez > 0.
Two fundamental properties of the gamma function are that
Γ (z+1) = zΓ (z)
and
Γ (n) = (n−1)!,
L. Grafakos, Classical Fourier Analysis, Graduate Texts in Mathematics 249,
DOI 10.1007/978-1-4939-1194-3, © Springer Science+Business Media New York 2014
563

564
A Gamma and Beta Functions
where z is a complex number with positive real part and n ∈Z+. Indeed, integration
by parts yields
Γ (z) =
 ∞
0 tz−1e−t dt =
tze−t
z
∞
0
+ 1
z
 ∞
0 tze−t dt = 1
z Γ (z+1).
Since Γ (1) = 1, the property Γ (n) = (n −1)! for n ∈Z+ follows by induction.
Another important fact is that
Γ
 1
2

= √π .
This follows easily from the identity
Γ
 1
2

=
 ∞
0 t−1
2 e−t dt = 2
 ∞
0 e−u2 du = √π .
Next we deﬁne the beta function. Fix z and w complex numbers with positive real
parts. We deﬁne
B(z,w) =
 1
0 tz−1(1−t)w−1 dt =
 1
0 tw−1(1−t)z−1 dt.
We have the following relationship between the gamma and the beta functions:
B(z,w) = Γ (z)Γ (w)
Γ (z+w) ,
when z and w have positive real parts.
The proof of this fact is as follows:
Γ (z+w)B(z,w) = Γ (z+w)
 1
0 tw−1(1−t)z−1 dt
= Γ (z+w)
 ∞
0 uw−1

1
1+u
z+w
du
t = u/(1+u)
=
 ∞
0
 ∞
0 uw−1

1
1+u
z+w
vz+w−1e−v dvdu
=
 ∞
0
 ∞
0 uw−1sz+w−1e−s(u+1) dsdu
s = v/(1+u)
=
 ∞
0 sze−s
 ∞
0 (us)w−1e−su duds
=
 ∞
0 sz−1e−sΓ (w)ds
= Γ (z)Γ (w).

A.4 Computation of Integrals Using Gamma Functions
565
A.3 Volume of the Unit Ball and Surface of the Unit Sphere
We denote by vn the volume of the unit ball in Rn and by ωn−1 the surface area of
the unit sphere Sn−1. We have the following:
ωn−1 = 2π
n
2
Γ ( n
2)
and
vn = ωn−1
n
= 2π
n
2
nΓ ( n
2) =
π
n
2
Γ ( n
2 +1) .
The easy proofs are based on the formula in Appendix A.1. We have
√π
n =

Rn e−|x|2dx = ωn−1
 ∞
0 e−r2rn−1 dr,
by switching to polar coordinates. Now change variables t = r2 to obtain that
π
n
2 = ωn−1
2
 ∞
0 e−tt
n
2 −1 dt = ωn−1
2 Γ
 n
2

.
This proves the formula for the surface area of the unit sphere in Rn.
To compute vn, write again using polar coordinates
vn = |B(0,1)| =

|x|≤1 1dx =

Sn−1
 1
0 rn−1 drdθ = 1
n ωn−1 .
Here is another way to relate the volume to the surface area. Let B(0,R) be the
ball in Rn of radius R > 0 centered at the origin. Then the volume of the shell
B(0,R + h) \ B(0,R) divided by h tends to the surface area of B(0,R) as h →0. In
other words, the derivative of the volume of B(0,R) with respect to the radius R is
equal to the surface area of B(0,R). Since the volume of B(0,R) is vnRn, it follows
that the surface area of B(0,R) is nvnRn−1. Taking R = 1, we deduce ωn−1 = nvn.
A.4 Computation of Integrals Using Gamma Functions
Let k1,...,kn be nonnegative even integers. The integral

Rn xk1
1 ···xkn
n e−|x|2dx1 ···dxn =
n
∏
j=1
 +∞
−∞x
k j
j e−x2
j dxj =
n
∏
j=1
Γ
kj +1
2

expressed in polar coordinates is equal to

Sn−1 θ k1
1 ···θ kn
n dθ
 ∞
0 rk1+···+knrn−1e−r2dr,

566
A Gamma and Beta Functions
where θ = (θ1,...,θn). This leads to the identity

Sn−1 θ k1
1 ···θ kn
n dθ = 2Γ
k1 +···+kn +n
2
−1
n
∏
j=1
Γ
kj +1
2

.
Another classical integral that can be computed using gamma functions is the
following:
 π/2
0
(sinϕ)a(cosϕ)b dϕ = 1
2
Γ ( a+1
2 )Γ ( b+1
2 )
Γ ( a+b+2
2
)
,
whenever a and b are complex numbers with Rea > −1 and Reb > −1.
Indeed, change variables u = (sinϕ)2; then du = 2(sinϕ)(cosϕ)dϕ, and the pre-
ceding integral becomes
1
2
 1
0 u
a−1
2 (1−u)
b−1
2 du = 1
2 B
a+1
2
, b+1
2

= 1
2
Γ ( a+1
2 )Γ ( b+1
2 )
Γ ( a+b+2
2
)
.
A.5 Meromorphic Extensions of B(z,w) and Γ (z)
Using the identity Γ (z + 1) = zΓ (z), we can easily deﬁne a meromorphic exten-
sion of the gamma function on the whole complex plane starting from its known
values on the right half-plane. We give an explicit description of the meromorphic
extension of Γ (z) on the whole plane. First write
Γ (z) =
 1
0 tz−1e−tdt +
 ∞
1 tz−1e−tdt
and observe that the second integral is an analytic function of z for all z ∈C. Write
the ﬁrst integral as
 1
0 tz−1

e−t −
N
∑
j=0
(−t) j
j!
+
dt +
N
∑
j=0
(−1) j/j!
z+ j
.
The last integral converges when Rez > −N−1, since the expression inside the curly
brackets is O(tN+1) as t →0. It follows that the gamma function can be deﬁned to be
an analytic function on Rez > −N −1 except at the points z = −j, j = 0,1,...,N, at
which it has simple poles with residues (−1) j
j! . Since N was arbitrary, it follows that
the gamma function has a meromorphic extension on the whole plane.
In view of the identity
B(z,w) = Γ (z)Γ (w)
Γ (z+w) ,
the deﬁnition of B(z,w) can be extended to C×C. It follows that B(z,w) is a mero-
morphic function in each argument.

A.6 Asymptotics of Γ (x) as x →∞
567
A.6 Asymptotics of Γ (x) as x →∞
We now derive Stirling’s formula:
lim
x→∞
Γ (x+1)
 x
e
x√
2πx = 1.
First change variables t = x+sx
!
2
x to obtain
Γ (x+1) =
 ∞
0 e−ttx dt =
x
e
x√
2x
 +∞
−√
x/2

1+s
!
2
x
x
e2s√
x/2
ds.
Setting y = " x
2, we obtain
Γ (x+1)
 x
e
x√
2x
=
 +∞
−∞
'
1+ s
y
y
es
(2y
χ(−y,∞)(s)ds.
To show that the last integral converges to √π as y →∞, we need the following:
(1) The fact that
lim
y→∞

1+s/y
y
es
2y
→e−s2 ,
which follows easily by taking logarithms and applying L’Hˆopital’s rule twice.
(2) The estimate, valid for y ≥1,
'
1+ s
y
y
es
(2y
≤
⎧
⎪
⎨
⎪
⎩
(1+s)2
es
when s ≥0,
e−s2
when −y < s < 0,
which can be easily checked using calculus. Using these facts, the Lebesgue dom-
inated convergence theorem, the trivial fact that χ−y<s<∞→1 as y →∞, and the
identity in Appendix A.1, we obtain that
lim
x→∞
Γ (x+1)
 x
e
x√
2x
= lim
y→∞
 +∞
−∞
'
1+ s
y
y
es
(2y
χ(−y,∞)(s)ds
=
 +∞
−∞e−s2ds
= √π.

568
A Gamma and Beta Functions
As a consequence of Stirling’s formula, for any t > 0, we obtain
lim
x→∞
Γ (x)
Γ (x+t) = 0.
A.7 Euler’s Limit Formula for the Gamma Function
For n a positive integer and Rez > 0 we consider the functions
Γn(z) =
 n
0

1−t
n
n
tz−1 dt
We show that
Γn(z) =
n!nz
z(z+1)···(z+n)
and we obtain Euler’s limit formula for the gamma function
lim
n→∞Γn(z) = Γ (z).
We write Γ (z)−Γn(z) = I1(z)+I2(z)+I3(z), where
I1(z) =
 ∞
n e−ttz−1 dt ,
I2(z) =
 n
n/2

e−t −

1−t
n
n
tz−1 dt ,
I3(z) =
 n/2
0

e−t −

1−t
n
n
tz−1 dt .
Obviously I1(z) tends to zero as n →∞. For I2 and I3 we have that 0 ≤t < n, and by
the Taylor expansion of the logarithm we obtain
log

1−t
n
n
= nlog

1−t
n

= −t −L,
where
L = t2
n
1
2 + 1
3
t
n + 1
4
t2
n2 +···

.
It follows that
0 < e−t −

1−t
n
n
= e−t −e−Le−t ≤e−t ,
and thus I2(z) tends to zero as n →∞. For I3 we have t/n ≤1/2, which implies that
L ≤t2
n
∞
∑
k=0
1
(k +1)2k−1 = t2
n c.

A.7 Euler’s Limit Formula for the Gamma Function
569
Consequently, for t/n ≤1/2 we have
0 ≤e−t −

1−t
n
n
= e−t(1−e−L) ≤e−tL ≤e−t ct2
n .
Plugging this estimate into I3, we deduce that
|I3(z)| ≤c
n Γ (Rez+2),
which certainly tends to zero as n →∞.
Next, n integrations by parts give
Γn(z) = n
nz
n−1
n(z+1)
n−2
n(z+2) ···
1
n(z+n−1)
 n
0 tz+n−1 dt =
n!nz
z(z+1)···(z+n) .
This can be written as
1 = Γn(z)zexp

z

1+ 1
2 + 1
3 +···+ 1
n −logn
 n
∏
k=1

1+ z
k

e−z/k .
Taking limits as n →∞, we obtain an inﬁnite product form of Euler’s limit formula,
1 = Γ (z)zeγz
∞
∏
k=1

1+ z
k

e−z/k ,
where Rez > 0 and γ is Euler’s constant
γ = lim
n→∞1+ 1
2 + 1
3 +···+ 1
n −logn.
The inﬁnite product converges uniformly on compact subsets of the complex plane
that excludes z = 0,−1,−2,..., and thus it represents a holomorphic function in this
domain. This holomorphic function multiplied by Γ (z)zeγz is equal to 1 on Rez > 0
and by analytic continuation it must be equal to 1 on C\{0,−1,−2,...}. But Γ (z)
has simple poles, while the inﬁnite product vanishes to order one, at the nonpositive
integers. We conclude that Euler’s limit formula holds for all complex numbers z;
consequently, Γ (z) has no zeros and Γ (z)−1 is entire.
An immediate consequence of Euler’s limit formula is the identity
1
|Γ (x+iy)|2 =
1
|Γ (x)|2
∞
∏
k=0

1+
y2
(k +x)2

,
which holds for x and y real with x /∈{0,−1,−2,...}. As a consequence we have
that
|Γ (x+iy)| ≤|Γ (x)|

570
A Gamma and Beta Functions
and also that
1
|Γ (x+iy)| ≤
1
|Γ (x)|eC(x)|y|2 ,
where
C(x) = 1
2
∞
∑
k=0
1
(k +x)2 ,
whenever y ∈R and x ∈R \ {0,−1,−2,...}. Before we ﬁnd a similar estimate for
x ∈{0,−1,−2,...} we provide a simpler expression for this estimate when x > 0.
When x > 0 we have
C(x) ≤1
2x2 + 1
2
∞
∑
k=1
1
(k +x)2 ≤1
2x2 + 1
2
 ∞
0
dt
(t +x)2 = 1
2x2 + 1
2x
 ∞
1
dt
t2 = 1
2x2 + 1
2x.
Thus we conclude that when x > 0 and y ∈R we have
1
|Γ (x+iy)| ≤
1
|Γ (x)|emax{x−2,x−1}|y|2 .
When x = 0 we write Γ (iy)iy = Γ (1+iy) and use the preceding inequality to obtain
1
|Γ (iy)| ≤
|iy|
|Γ (1)|e|y|2 = |y|e|y|2
and more generally for x = −N ∈{−1,−2,...} and y ∈R we obtain by induction
1
|Γ (−N +iy)| ≤|iy||1+iy||2+iy| ···|N +iy|e|y|2 .
A.8 Reﬂection and Duplication Formulas for the Gamma
Function
The reﬂection formula relates the values of the gamma function of a complex num-
ber z and its reﬂection about the point 1/2 in the following way:
sin(πz)
π
=
1
Γ (z)
1
Γ (1−z) .
The duplication formula relates the entire functions Γ (2z)−1 and Γ (z)−1 as follows:
1
Γ (z)Γ (z+ 1
2) = π−1
2 22z−1
Γ (2z)
.

A.8 Reﬂection and Duplication Formulas for the Gamma Function
571
Both of these could be proved using Euler’s limit formula. The reﬂection formula
also uses the identity
∞
∏
k=1

1−z2
k2

= sin(πz)
πz
,
while the duplication formula makes use of the fact that
lim
n→∞
(n!)2 22n+1
(2n)!n1/2 = 2π1/2 .
These and other facts related to the gamma function can be found in Olver [271].

Appendix B
Bessel Functions
B.1 Deﬁnition
We survey some basics from the theory of Bessel functions Jν of complex order
ν with Reν > −1/2. We deﬁne the Bessel function Jν of order ν by its Poisson
representation formula
Jν(t) =
 t
2
ν
Γ (ν + 1
2)Γ ( 1
2)
 +1
−1 eits(1−s2)ν
ds
√
1−s2 ,
where Reν > −1/2 and t ≥0. Although this deﬁnition is also valid when t is a
complex number, for the applications we have in mind, it sufﬁces to consider the
case that t is real and nonnegative; in this case Jν(t) is also a real number.
B.2 Some Basic Properties
Let us summarize a few properties of Bessel functions. We take t > 0.
(1) We have the following recurrence formula:
d
dt

t−νJν(t)

= −t−νJν+1(t),
Reν > −1/2.
(2) We also have the companion recurrence formula:
d
dt

tνJν(t)

= tνJν−1(t),
Reν > 1/2.
L. Grafakos, Classical Fourier Analysis, Graduate Texts in Mathematics 249,
DOI 10.1007/978-1-4939-1194-3, © Springer Science+Business Media New York 2014
573

574
B Bessel Functions
(3) Jν(t) satisﬁes the differential equation:
t2 d2
dt2 (Jν(t))+t d
dt (Jν(t))+(t2 −ν2)Jν(t) = 0.
(4) If ν ∈Z+, then we have the following identity, which was taken by Bessel as the
deﬁnition of Jν for integer ν:
Jν(t) = 1
2π
 2π
0
eit sinθe−iνθ dθ = 1
2π
 2π
0
cos(t sinθ −νθ)dθ .
(5) For Reν > −1/2 we have the following identity:
Jν(t) =
1
Γ ( 1
2)
 t
2
ν
∞
∑
j=0
(−1) j
Γ ( j + 1
2)
Γ ( j +ν +1)
t2 j
(2j)! ,
which can also be written as
Jν(t) =
∞
∑
j=0
(−1) j
j!
1
Γ ( j +ν +1)
 t
2
2 j+ν
,
using the equality (2j)! = 22 j j!( j −1
2)( j −3
2)··· 1
2 = 22 j j!Γ ( j + 1
2)Γ ( 1
2)−1.
(6) For Reν > 1/2 the identity below is valid:
d
dt (Jν(t)) = 1
2

Jν−1(t)−Jν+1(t)

.
We ﬁrst verify property (1). We have
d
dt

t−νJν(t)

=
i
2νΓ (ν + 1
2)Γ ( 1
2)
 1
−1 seits(1−s2)ν−1
2 ds
=
i
2νΓ (ν + 1
2)Γ ( 1
2)
 1
−1
it
2 eits (1−s2)ν+ 1
2
ν + 1
2
ds
= −t−νJν+1(t),
where we integrated by parts and used the fact that Γ (x+1) = xΓ (x).
We now prove Property (2) for Reν > 1/2:
d
dt

tνJν(t)

=
2νt2ν−12−ν
Γ (ν + 1
2)Γ ( 1
2)
 1
−1 eits(1−s2)ν−1
2 ds+
t2ν2−ν
Γ (ν + 1
2)Γ ( 1
2)i
 1
−1 eitsis(1−s2)ν−1
2 ds

B.2 Some Basic Properties
575
=
2νt2ν−12−ν
Γ (ν + 1
2)Γ ( 1
2)
 1
−1 eits(1−s2)ν−1
2 ds+
t2ν2−ν
Γ (ν + 1
2)Γ ( 1
2)
 1
−1
eits
t
′
(1−s2)ν−1
2 sds
=
2νt2ν−12−ν
Γ (ν + 1
2)Γ ( 1
2)
 1
−1 eits(1−s2)ν−1
2 ds−
t2ν2−ν
Γ (ν + 1
2)Γ ( 1
2)
 1
−1
eits
t

(1−s2)ν−1
2 s
′ds
=
t2ν−12−ν
Γ (ν + 1
2)Γ ( 1
2)
 1
−1 eits/
2ν(1−s2)ν−1
2 −

(1−s2)ν−1
2 s
′0
ds
=
t2ν−12−ν
Γ (ν + 1
2)Γ ( 1
2)
 1
−1 eits(2ν −1)(1−s2)ν−3
2 ds
= t2ν−12−(ν−1)
Γ (ν −1
2)Γ ( 1
2)
 1
−1 eits(1−s2)ν−1
2
ds
√
1−s2
= tνJν−1(t).
We proceed with the proof of property (3). A calculation using the deﬁnition of
the Bessel function gives that the left-hand side of (3) is equal to
2−νtν+1
Γ (ν + 1
2)Γ ( 1
2)
 +1
−1 eist

(1−s2)t +2is(ν + 1
2)

(1−s2)ν−1
2 ds,
which in turn is equal to
−i
2−νtν+1
Γ (ν + 1
2)Γ ( 1
2)
 +1
−1
d
ds

eist(1−s2)ν+ 1
2 
ds = 0.
Property (4) can be derived directly from (1). Deﬁne
Gν(t) = 1
2π
 2π
0
eit sinθe−iνθ dθ,
for ν = 0,1,2,... and t > 0. We can show easily that G0 = J0. If we had
d
dt

t−νGν(t)

= −t−νGν+1(t),
t > 0,
for ν ∈Z+, we would immediately conclude that Gν = Jν for ν ∈Z+. We have
d
dt

t−νGν(t)

= −t−ν
ν
t Gν(t)−dGν
dt (t)

= −t−ν
 2π
0
ν
2πt eit sinθe−iνθ −1
2π
 d
dt eit sinθ

e−iνθ dθ
= −t−ν
2π
 2π
0
i d
dθ
eit sinθ−iνθ
t

+(cosθ −isinθ)eit sinθe−iνθ dθ
= −t−ν
2π
 2π
0
eit sinθe−i(ν+1)θ dθ
= −t−νGν+1(t).

576
B Bessel Functions
For t real, the identity in (5) can be derived by inserting the expression
∞
∑
j=0
(−1) j (ts)2 j
(2j)! +isin(ts)
for eits in the deﬁnition of the Bessel function Jν(t) in Appendix B.1. Algebraic
manipulations yield
Jν(t) = (t/2)ν
Γ ( 1
2)
∞
∑
j=0
(−1) j
1
Γ (ν + 1
2)
t2 j
(2j)!2
 1
0 s2 j−1(1−s2)ν−1
2 sds
= (t/2)ν
Γ ( 1
2)
∞
∑
j=0
(−1) j
1
Γ (ν + 1
2)
t2 j
(2j)!
Γ ( j + 1
2)Γ (ν + 1
2)
Γ ( j +ν +1)
= (t/2)ν
Γ ( 1
2)
∞
∑
j=0
(−1) j
Γ ( j + 1
2)
Γ ( j +ν +1)
t2 j
(2j)! .
To derive property (6) we ﬁrst multiply (1) by tν and (2) by t−ν; then we use the
product rule for differentiation and we add the resulting expressions.
For further identities on Bessel functions, one may consult Watson’s mono-
graph [371].
B.3 An Interesting Identity
Let Reμ > −1
2, Reν > −1, and t > 0. Then the following identity is valid:
 1
0 Jμ(ts)sμ+1(1−s2)ν ds = Γ (ν +1)2ν
tν+1
Jμ+ν+1(t).
To prove this identity we use formula (5) in Appendix B.2. We have
 1
0 Jμ(ts)sμ+1(1−s2)ν ds
=
 t
2
μ
Γ ( 1
2)
 1
0
∞
∑
j=0
(−1) jΓ ( j + 1
2)t2 j
Γ ( j + μ +1)(2j)!s2 j+μ+μ(1−s2)νsds
= 1
2
 t
2
μ
Γ ( 1
2)
∞
∑
j=0
(−1) jΓ ( j + 1
2)t2 j
Γ ( j + μ +1)(2j)!
 1
0 uj+μ(1−u)ν du
= 1
2
 t
2
μ
Γ ( 1
2)
∞
∑
j=0
(−1) jΓ ( j + 1
2)t2 j
Γ ( j + μ +1)(2j)!
Γ (μ + j +1)Γ (ν +1)
Γ (μ +ν + j +2)
= 2νΓ (ν +1)
tν+1
 t
2
μ+ν+1
Γ ( 1
2)
∞
∑
j=0
(−1) jΓ ( j + 1
2)t2 j
Γ ( j + μ +ν +2)(2j)!
= Γ (ν +1)2ν
tν+1
Jμ+ν+1(t).

B.5 The Fourier Transform of a Radial Function on Rn
577
B.4 The Fourier Transform of Surface Measure on Sn−1
Let dσ denote surface measure on Sn−1 for n ≥2. Then the following is true:
2
dσ(ξ) =

Sn−1 e−2πiξ·θdθ =
2π
|ξ|
n−2
2
J n−2
2 (2π|ξ|).
To see this, use the result in Appendix D.3 to write
2
dσ(ξ) =

Sn−1 e−2πiξ·θ dθ
= 2π
n−1
2
Γ ( n−1
2 )
 +1
−1 e−2πi|ξ|s(1−s2)
n−2
2
ds
√
1−s2
= 2π
n−1
2
Γ ( n−1
2 )
Γ ( n−2
2 + 1
2)Γ ( 1
2)
(π|ξ|)
n−2
2
J n−2
2 (2π|ξ|)
=
2π
|ξ|
n−2
2
J n−2
2 (2π|ξ|).
B.5 The Fourier Transform of a Radial Function on Rn
Let f(x) = f0(|x|) be a radial function deﬁned on Rn, where f0 is deﬁned on [0,∞).
Then the Fourier transform of f is given by the formula
1f(ξ) =
2π
|ξ|
n−2
2
 ∞
0
f0(r)J n
2 −1(2πr|ξ|)r
n
2 dr.
To obtain this formula, use polar coordinates to write
1f(ξ) =

Rn f(x)e−2πiξ·x dx
=
 ∞
0

Sn−1 f0(r)e−2πiξ·rθdθ rn−1dr
=
 ∞
0
f0(r) 2
dσ(rξ)rn−1dr
=
 ∞
0
f0(r)
2π
(r|ξ|)
n−2
2
J n−2
2 (2πr|ξ|)rn−1dr
=
2π
|ξ|
n−2
2
 ∞
0
f0(r)J n
2 −1(2πr|ξ|)r
n
2 dr.

578
B Bessel Functions
As an application we take f(x) = χB(0,1)(x), where B(0,1) is the unit ball in Rn.
We obtain
(χB(0,1))1(ξ) =
2π
|ξ|
n−2
2
 1
0 J n
2 −1(2π|ξ|r)r
n
2 dr =
J n
2 (2π|ξ|)
|ξ|
n
2
,
in view of the result in Appendix B.3. More generally, for Reλ > −1, let
mλ(ξ) =

(1−|ξ|2)λ
for |ξ| ≤1,
0
for |ξ| > 1.
Then
mλ
∨(x) =
2π
|x|
n−2
2
 1
0 J n
2 −1(2π|x|r)r
n
2 (1−r2)λ dr = Γ (λ +1)
πλ
J n
2 +λ(2π|x|)
|x|
n
2 +λ
,
using again the identity in Appendix B.3.
B.6 Bessel Functions of Small Arguments
We seek the behavior of Jk(r) as r →0+. We ﬁx ν ∈C with Reν > −1
2. Then we
have the identity
Jν(r) =
rν
2νΓ (ν +1) +Sν(r),
where
Sν(r) =
(r/2)ν
Γ (ν + 1
2)Γ ( 1
2)
 +1
−1 (eirt −1)(1−t2)ν−1
2 dt
and Sν satisﬁes
|Sν(r)| ≤
2−ReνrReν+1
(Reν +1)|Γ (ν + 1
2)|Γ ( 1
2) .
To prove this estimate we note that
Jν(r) =
(r/2)ν
Γ (ν + 1
2)Γ ( 1
2)
 +1
−1 (1−t2)ν−1
2 dt +Sν(r)
=
(r/2)ν
Γ (ν + 1
2)Γ ( 1
2)
 π
0 (sin2 φ)ν−1
2 (sinφ)dφ +Sν(r)
=
(r/2)ν
Γ (ν + 1
2)Γ ( 1
2)
Γ (ν + 1
2)Γ ( 1
2)
Γ (ν +1)
+Sν(r),
where we evaluated the last integral using the result in Appendix A.4. Using that
|eirt −1| ≤r|t|, we deduce the assertion regarding the size of |Sν(r)|.

B.7 Bessel Functions of Large Arguments
579
It follows from these facts and the estimate in Appendix A.7 that for 0 < r ≤1
and Reν > −1/2 we have
|Jν(r)| ≤C0(Reν)e
max

1
(Reν+ 1
2 )2 ,
1
Reν+ 1
2

|Imν|2
rReν ,
where C0 is a constant that depends smoothly on Reν ∈(−1/2,∞).
B.7 Bessel Functions of Large Arguments
For r > 0 and complex numbers ν with Reν > −1/2 we prove the identity
Jν(r) =
(r/2)ν
Γ (ν + 1
2)Γ ( 1
2)

ie−ir
 ∞
0 e−rt(t2+2it)ν−1
2 dt −ieir
 ∞
0 e−rt(t2−2it)ν−1
2 dt

.
Fix 0 < δ < 1/10 < 10 < R < ∞. We consider the region Ωδ,R in the complex
plane whose boundary is the set consisting of the interval [−1 + δ,1 −δ] union a
quarter circle centered at 1 of radius δ from 1−δ to 1+iδ, union the line segments
from 1+iδ to 1+iR, from 1+iR to −1+iR, and from −1+iR to −1+iδ, union
a quarter circle centered at −1 of radius δ from −1+iδ to −1+δ. This is a simply
connected region on the interior of which the holomorphic function (1−z2) has no
zeros. Since Ωδ,R is contained in the complement of the negative imaginary axis,
there is a holomorphic branch of the logarithm such that log(t) is real, log(−t) =
log|t| + iπ, and log(it) = log|t| + iπ/2 for t > 0. Since the function log(1 −z2) is
well deﬁned and holomorphic in Ωδ,R, we may deﬁne the holomorphic function
(1−z2)ν−1
2 = e(ν−1
2 )log(1−z2)
for z ∈Ωδ,R. Since eirz(1−z2)ν−1
2 has no poles in Ωδ,R, Cauchy’s theorem yields
i
 R
δ eir(1+it)(t2 −2it)ν−1
2 dt +
 1−δ
−1+δ eirt(1−t2)ν−1
2 dt
+i
 δ
R eir(−1+it)(t2 +2it)ν−1
2 dt +E(δ,R) = 0,
where E(δ,R) is the sum of the integrals over the two small quarter-circles of radius
δ and the line segment from 1 + iR to −1 + iR. The ﬁrst two of these integrals are
bounded by constants times δ, the latter by a constant times R2Reν−1e−rR; hence
E(δ,R) →0 as δ →0 and R →∞. We deduce the identity
 +1
−1 eirt(1−t2)ν−1
2 dt = ie−ir
 ∞
0 e−rt(t2+2it)ν−1
2 dt −ieir
 ∞
0 e−rt(t2−2it)ν−1
2 dt .

580
B Bessel Functions
Estimating the two integrals on the right by putting absolute values inside and mul-
tiplying by the missing factor rν2−ν(Γ (ν + 1
2)Γ ( 1
2))−1, we obtain
|Jν(r)| ≤2 (r/2)Reν e
π
2 |Imν|
|Γ (ν + 1
2)|Γ ( 1
2)
 ∞
0 e−rttReν−1
2 "
t2 +4
Reν−1
2 dt ,
since the absolute value of the argument of t2±2it is at most π/2. When Reν > 1/2,
we use the inequality (
√
t2 +4)Reν−1
2 ≤2Reν−3
2 
tReν−1
2 +2Reν−1
2 
to get
|Jν(r)| ≤2 (r/2)Reν e
π
2 |Imν|
|Γ (ν + 1
2)|Γ ( 1
2) 2Reν−3
2
Γ (2Reν)
r2Reν
+2Reν Γ (Reν + 1
2)
rReν+ 1
2

.
When 1/2 ≥Reν > −1/2 we use that
√
t2 +4
Reν−1
2 ≤1 to deduce that
|Jν(r)| ≤2 (r/2)Reν e
π
2 |Imν|
|Γ (ν + 1
2)|Γ ( 1
2)
Γ (Reν + 1
2)
rReν+ 1
2
.
These estimates yield that for Reν > −1/2 and r ≥1 we have
|Jν(r)| ≤C1(Reν) e

max((Reν+ 1
2 )−2,(Reν+ 1
2 )−1)+ π
2

|Imν|2 r−1/2
using the result in Appendix A.7, where C1 is a constant that depends smoothly on
Reν on the interval (−1/2,∞).
B.8 Asymptotics of Bessel Functions
We obtain asymptotics for Jν(r) as r →∞whenever Reν > −1/2. We have the
following identity for r > 0:
Jν(r) =
=
2
πr cos

r −πν
2 −π
4

+Rν(r),
where Rν is given by
Rν(r) = (2π)−1
2 rν
Γ (ν + 1
2) ei(r−πν
2 −π
4 )
 ∞
0 e−rttν+ 1
2 
(1+ it
2 )ν−1
2 −1
dt
t
+(2π)−1
2 rν
Γ (ν + 1
2) e−i(r−πν
2 −π
4 )
 ∞
0 e−rttν+ 1
2 
(1−it
2 )ν−1
2 −1
dt
t
and satisﬁes |Rν(r)| ≤Cν r−3/2 whenever r ≥1.

B.8 Asymptotics of Bessel Functions
581
To see the validity of this identity we write
ie−ir(t2 +2it)ν−1
2 = (2t)ν−1
2 e−i(r−νπ
2 −π
4 )(1−it
2 )ν−1
2 ,
−ieir(t2 −2it)ν−1
2 = (2t)ν−1
2 ei(r−νπ
2 −π
4 )(1+ it
2 )ν−1
2 .
Inserting these expressions into the corresponding integrals in the formula proved in
Appendix B.7, adding and subtracting 1 from each term (1± it
2 )ν−1
2 , and multiplying
by the missing factor (r/2)ν/Γ (ν + 1
2)Γ ( 1
2), we obtain the claimed identity
Jν(r) =
=
2
πr cos

r −πν
2 −π
4

+Rν(r).
It remains to estimate Rν(r). We begin by noting that for a,b real with a > −1
we have the pair of inequalities
|(1±iy)a+ib −1| ≤3(|a|+|b|)

2
a+1
2 e
π
2 |b|
y
when 0 < y < 1,
|(1±iy)a+ib −1| ≤(1+y2)
a
2 e
π
2 |b| +1 ≤2

2
a+1
2 e
π
2 |b|
ya
when 1 ≤y < ∞.
The ﬁrst inequality is proved by splitting into real and imaginary parts and applying
the mean value theorem in the real part. Taking ν −1
2 = a+ib, y = t/2, and inserting
these estimates into the integrals appearing in Rν, we obtain
|Rν(r)| ≤2
1
2 Reν+ 5
4 e
π
2 |Imν|rReν
(2π)1/2|Γ (ν + 1
2)|
3
√
2|ν|
2
 2
0 e−rttReν+ 3
2 dt
t + 2
√
2
2Reν
 ∞
2 e−rtt2Reν dt
t

.
It follows that for all r > 0 we have
|Rν(r)| ≤2 2
1
2 Reνe
π
2 |Imν|
|Γ (ν + 1
2)|

|ν| Γ (Reν + 3
2)
r3/2
+ r−Reν
2Reν
 ∞
2r e−tt2Reν dt
t

≤2 2
1
2 Reνe
π
2 |Imν|
|Γ (ν + 1
2)|

|ν| Γ (Reν + 3
2)
r3/2
+ 2Reν
rReν
Γ (2Reν)
er

,
using that e−t ≤e−t/2e−r for t ≥2r. We conclude that for r ≥1 and Reν > −1/2
we have
|Rν(r)| ≤2
1
2 Reνe
π
2 |Imν|
Γ (Reν + 1
2) emax((Reν+ 1
2 )−2,(Reν+ 1
2 )−1)|Imν|2

|ν| Γ (Reν + 3
2)
r3/2
+ 2Reν
rReν
Γ (2Reν)
er

≤C2(Reν)e

max((Reν+ 1
2 )−2,(Reν+ 1
2 )−1)+ π
2 +1

|Imν|2 r−3/2 ,
via the result in Appendix A.7, where C2 is a constant that depends smoothly on
Reν on the interval (−1/2,∞).

582
B Bessel Functions
B.9 Bessel Functions of general complex indices
We now discuss how to extend Jν(t) to complex values of ν when t > 0. Identity (5)
Jν(t) =
∞
∑
j=0
(−1) j
j!
1
Γ ( j +ν +1)
 t
2
2 j+ν
of Appendix B.2 expresses Jν(t) as a power series when ν is a complex number with
Reν > −1/2. But this power series converges absolutely for all complex values of
ν by the ratio test. Indeed, for j sufﬁciently large we have

(−1) j+1
( j+1)!
1
Γ ( j+1+ν+1)
 t
2
2 j+2+ν
(−1) j
j!
1
Γ ( j+ν+1)
 t
2
2 j+ν
 =

Γ ( j +ν +1)
 t
2
2
( j +1)Γ ( j +ν +2)
 =

 t
2
2
( j +1)( j +ν +1)

which tends to zero as j →∞, thus the ratio test applies.
Therefore the power series deﬁnes an entire function of ν. Since this entire func-
tion coincides with Jν on (−1
2,∞)×R, by analytic continuation, Jν(t) has an entire
extension for all t > 0.
We obtain an integral representation of Jz(t) when −1/2 ≥Rez > −3/2. Fix
t > 0. Then we write
Jz(t) =
 t
2
z
Γ (z+ 1
2)Γ ( 1
2)
 1
−1 eits(1−s2)z
ds
√
1−s2
=
2
 t
2
z
Γ (z+ 1
2)Γ ( 1
2)
 1
0 cos(ts)(1−s2)z−1
2 ds
=
 t
2
z
Γ (z+ 1
2)Γ ( 1
2)
 1
0
cos(t√1−u)
√1−u
uz−1
2 du,
where the last step follows by the change of variables u = 1−s2. By the mean value
theorem, there is a constant c in (0,1) such that
 t
2
z
Γ (z+ 1
2)Γ ( 1
2)
 1
0
cos(t√1−u)
√1−u
uz−1
2 du
=
 t
2
z
Γ (z+ 1
2)√π
 1
0
d
du
cos(t√1−u)
√1−u

(c) uz+ 1
2 du+
 t
2
z cos(t)
√π
 1
0 uz−1
2 du
Γ (z+ 1
2)
=
 t
2
z
Γ (z+ 1
2)√π
 1
0
d
du
cos(t√1−u)
√1−u

(c) uz+ 1
2 du+
 t
2
z cos(t)
√π
1
Γ (z+ 3
2) ,

B.9 Bessel Functions of general complex indices
583
where the second identity is due to the fact that the integral
 1
0 uz−1
2 du is equal to
(z+ 1
2)−1 when Rez > −1/2 and thus when divided by Γ (z+ 1
2) can be analytically
extended to an entire function. It follows from these calculations that
J−1
2 (t) =
=
2
π
cos(t)
√t
.
We now estimate Jz(t) when −3/2 < Rez ≤−1/2. Given q ∈(0,1) we write
Jz(t) = J1
z (t;q)+J2
z (t;q)+J3
z (t;q),
where
J1
z (t;q) =
 t
2
z
Γ (z+ 1
2)Γ ( 1
2)
 q
0
d
du
cos(t√1−u)
√1−u

(c) uz+ 1
2 du
J2
z (t;q) =
 t
2
z cos(t)
√π
qz+ 1
2
Γ (z+ 3
2)
J3
z (t;q) =
 t
2
z
Γ (z+ 1
2)Γ ( 1
2)
 1
q
cos(t√1−u)
√1−u
uz−1
2 du
for some c satisfying 0 < c < q.
Suppose that t > 2. Then we pick q = 1/t. We have
|J1
z (t;1/t)| ≤
 t
2
Rez
Γ (z+ 1
2)
√π
t
"
1−1/t
3
1
Rez+ 3
2
1
t
Rez+ 3
2 ≤C1(Rez) t−1
2
Γ (z+ 1
2)
 ,
for some constant C1 depending on Rez. The second term obviously satisﬁes
|J2
z (t;1/t)| ≤C2(Rez) t−1
2
Γ (z+ 3
2)
 .
In J3
z (t;1/t) we write cos(t√1−u)
√1−u
= −2
t
d
du

sin(t√1−u)

and integrate by parts to
obtain the estimate
|J3
z (t;1/t)| ≤
 t
2
Rez
Γ (z+ 1
2)
√π
2
t +
2
t
1
2 +Rez

≤C3(Rez) t−1
2
Γ (z+ 1
2)

when −1/2 ≥Rez > −3/2. Thus for these z’s and t > 2 we have
|Jz(t)| ≤C0(Rez) t−1
2

1
|Γ (z+ 1
2)| +
1
|Γ (z+ 3
2)|

.

584
B Bessel Functions
When 0 < t ≤2 we choose q = 1/2. Then each of |Jk
z (t;1/2)|, k = 1,2,3 is
bounded by a multiple of tRez and we obtain the estimate
|Jz(t)| ≤C00(Rez) tRez

1
|Γ (z+ 1
2)| +
1
|Γ (z+ 3
2)|

.
when −1/2 ≥Rez > −3/2 and 0 < t ≤2.
In the special case Rez = −1/2 or z = −1/2+iθ, θ ∈R, we deduce
|J−1
2 +iθ(t)| ≤Ct−1
2

1
|Γ (1+iθ)| +
1
|Γ (iθ)|

≤Ct−1
2 (1+|θ|)e|θ|2
for some constant C independent of all parameters; see Appendix A.7 for the last
inequality.

Appendix C
Rademacher Functions
C.1 Deﬁnition of the Rademacher Functions
The Rademacher functions are deﬁned on [0,1] as follows: r0(t) = 1; r1(t) = 1 for
0 ≤t ≤1/2 and r1(t) = −1 for 1/2 < t ≤1; r2(t) = 1 for 0 ≤t ≤1/4, r2(t) = −1
for 1/4 < t ≤1/2, r2(t) = 1 for 1/2 < t ≤3/4, and r2(t) = −1 for 3/4 < t ≤1;
and so on. According to this deﬁnition, we have that r j(t) = sgn(sin(2jπt)) for j =
0,1,2,.... It is easy to check that the rj’s are mutually independent random variables
on [0,1]. This means that for all functions f j we have
 1
0
n
∏
j=0
f j(r j(t))dt =
n
∏
j=0
 1
0 f j(r j(t))dt .
To see the validity of this identity, we write its right-hand side as
f0(1)
n
∏
j=1
 1
0 f j(r j(t))dt = f0(1)
n
∏
j=1
f j(1)+ f j(−1)
2
= f0(1)
2n
∑
S⊂{1,2,...,n}∏
j∈S
f j(1)∏
j/∈S
f j(−1)
and we observe that there is a one-to-one and onto correspondence between sub-
sets S of {1,2,...,n} and intervals Ik =
 k
2n , k+1
2n

, k = 0,1,...,2n −1, such that the
restriction of the function ∏n
j=1 f j(r j(t)) on Ik is equal to
∏
j∈S
f j(1)∏
j/∈S
f j(−1).
It follows that the last of the three equal displayed expressions is
f0(1)
2n−1
∑
k=0

Ik
n
∏
j=1
f j(r j(t))dt =
 1
0
n
∏
j=0
f j(r j(t))dt .
L. Grafakos, Classical Fourier Analysis, Graduate Texts in Mathematics 249,
DOI 10.1007/978-1-4939-1194-3, © Springer Science+Business Media New York 2014
585

586
C Rademacher Functions
C.2 Khintchine’s Inequalities
The following property of the Rademacher functions is of fundamental importance
and with far-reaching consequences in analysis:
For any 0 < p < ∞and for any real-valued square summable sequences {aj} and
{bj} we have
Bp

∑
j
|aj +ibj|2
1
2
≤
∑
j
(aj +ibj)r j

Lp([0,1]) ≤Ap

∑
j
|aj +ibj|2
1
2
for some constants 0 < Ap,Bp < ∞that depend only on p.
These inequalities reﬂect the orthogonality of the Rademacher functions in Lp
(especially when p ̸= 2). Khintchine [193] was the ﬁrst to prove a special form of
this inequality, and he used it to estimate the asymptotic behavior of certain random
walks. Later this inequality was systematically studied almost simultaneously by Lit-
tlewood [226] and by Paley and Zygmund [274], who proved the more general form
stated previously. The foregoing inequalities are usually referred to by Khintchine’s
name.
C.3 Derivation of Khintchine’s Inequalities
Both assertions in Appendix C.2 can be derived from an exponentially decaying
distributional inequality for the function
F(t) = ∑
j
(aj +ibj)r j(t),
t ∈[0,1],
when aj, bj are square summable real numbers.
We ﬁrst obtain a distributional inequality for the above function F under the
following three assumptions:
(a)The sequence {bj} is identically zero.
(b)All but ﬁnitely many terms of the sequence {aj} are zero.
(c)The sequence {aj} satisﬁes (∑j |aj|2)1/2 = 1.
Let ρ > 0. Under assumptions (a), (b), and (c), independence gives
 1
0 eρ ∑a jr j(t) dt = ∏
j
 1
0 eρa jr j(t) dt
= ∏
j
eρa j +e−ρa j
2
≤∏
j
e
1
2 ρ2a2
j = e
1
2 ρ2 ∑a2
j = e
1
2 ρ2 ,

C.3 Derivation of Khintchine’s Inequalities
587
where we used the inequality 1
2(ex +e−x) ≤e
1
2 x2 for all real x, which can be checked
using power series expansions. Since the same argument is also valid for −∑ajr j(t),
we obtain that
 1
0 eρ|F(t)| dt ≤2e
1
2 ρ2 .
From this it follows that
eρα|{t ∈[0,1] : |F(t)| > α}| ≤
 1
0 eρ|F(t)| dt ≤2e
1
2 ρ2
and hence we obtain the distributional inequality
dF(α) = |{t ∈[0,1] : |F(t)| > α}| ≤2e
1
2 ρ2−ρα = 2e−1
2 α2 ,
by picking ρ = α. The Lp norm of F can now be computed easily. Formula (1.1.6)
gives
F
p
Lp =
 ∞
0 pα p−1dF(α)dα ≤
 ∞
0 pα p−12e−α2
2 dα = 2
p
2 pΓ (p/2).
We have now proved that
F

Lp ≤
√
2

pΓ (p/2)
 1
p F

L2
under assumptions (a), (b), and (c).
We now dispose of assumptions (a), (b), and (c). Assumption (b) can be easily
eliminated by a limiting argument and (c) by a scaling argument. To dispose of
assumption (a), let aj and bj be real numbers. We have
∑
j
(aj +ibj)r j

Lp ≤

∑
j
ajr j
+
∑
j
bjr j


Lp
≤
∑
j
ajr j

Lp +
∑
j
bjr j

Lp
≤
√
2

pΓ (p/2)
 1
p

∑
j
|aj|21
2 +

∑
j
|bj|21
2

≤
√
2

pΓ (p/2)
 1
p √
2

∑
j
|aj +ibj|21
2 .
Let us now set Ap = 2

pΓ (p/2)
1/p when p > 2. Since we have the trivial esti-
mate
F

Lp ≤
F

L2 when 0 < p ≤2, we obtain the required inequality
F

Lp ≤
Ap
F

L2 with
Ap =

1
when 0 < p ≤2,
2 p
1
p Γ (p/2)
1
p
when 2 < p < ∞.

588
C Rademacher Functions
Using Sterling’s formula in Appendix A.6, we see that Ap is asymptotic to √p as
p →∞.
We now discuss the converse inequality Bp
F

L2 ≤
F

Lp. It is clear that
F

L2 ≤
F

Lp when p ≥2 and we may therefore take Bp = 1 for p ≥2. Let us
now consider the case 0 < p < 2. Pick an s such that 2 < s < ∞. Find a 0 < θ < 1
such that
1
2 = 1−θ
p
+ θ
s .
Then
F

L2 ≤
F
1−θ
Lp
F
θ
Ls ≤
F
1−θ
Lp Aθ
s
F
θ
L2 .
It follows that
F

L2 ≤A
θ
1−θ
s
F

Lp .
We have now proved the inequality Bp
F

L2 ≤
F

Lp with
Bp =
⎧
⎪
⎪
⎨
⎪
⎪
⎩
1
when 2 ≤p < ∞,
sup
s>2
A
−
1p −1
2
1
2 −1s
s
when 0 < p < 2.
Observe that the function s →A
−

1
p −1
2

/

1
2 −1
s

s
tends to zero as s →2+ and as
s →∞. Hence it must attain its maximum for some s = s(p) in the interval (2,∞).
We see that Bp ≥16·256−1/p when p < 2 by taking s = 4.
It is worthwhile to mention that the best possible values of the constants Ap and
Bp in Khintchine’s inequality are known when bj = 0. In this case Szarek [353]
showed that the best possible value of B1 is 1/
√
2, and later Haagerup [141] found
that when bj = 0 the best possible values of Ap and Bp are the numbers
Ap =

1
when 0 < p ≤2,
2
1
2 π−1
2p Γ ( p+1
2 )
when 2 < p < ∞,
and
Bp =
⎧
⎪
⎪
⎨
⎪
⎪
⎩
2
1
2 −1
p
when 0 < p ≤p0,
2
1
2 π−1
2p Γ ( p+1
2 )
when p0 < p < 2,
1
when 2 < p < ∞,
where p0 = 1.84742... is the unique solution of the equation 2Γ ( p+1
2 ) = √π in the
interval (1,2).

C.5 Extension to Several Variables
589
C.4 Khintchine’s Inequalities for Weak Type Spaces
We note that the following weak type estimates are valid:
4−1
p B p
2

∑
j
|aj +ibj|2
1
2
≤
∑
j
(aj +ibj)r j

Lp,∞≤Ap

∑
j
|aj +ibj|2
1
2
for all 0 < p < ∞.
Indeed, the upper estimate is a simple consequence of the fact that Lp is a sub-
space of Lp,∞. For the converse inequality we use the fact that Lp,∞([0,1]) is con-
tained in Lp/2([0,1]) and we have (see Exercise 1.1.11)
F

Lp/2 ≤4
1
p F

Lp,∞.
Since any Lorentz space Lp,q([0,1]) can be sandwiched between L2p([0,1]) and
Lp/2([0,1]), similar inequalities hold for all Lorentz spaces Lp,q([0,1]), 0 < p < ∞,
0 < q ≤∞.
C.5 Extension to Several Variables
We ﬁrst extend the inequality on the right in Appendix C.2 to several variables. For
a positive integer n we let
Fn(t1,...,tn) = ∑
j1
···∑
jn
cj1,..., jnr j1(t1)···r jn(tn),
for t j ∈[0,1], where cj1,..., jn is a sequence of complex numbers and Fn is a function
deﬁned on [0,1]n.
For any 0 < p < ∞and for any complex-valued square summable sequence of n
variables {cj1,..., jn}j1,..., jn, we have the following inequalities for Fn:
Bn
p

∑
j1
···∑
jn
|cj1,..., jn|2
1
2
≤
Fn

Lp([0,1]n) ≤An
p

∑
j1
···∑
jn
|cj1,..., jn|2
1
2
,
where Ap,Bp are the constants in Appendix C.2. The norms are over [0,1]n.
The case n = 2 is indicative of the general case. For p ≥2 we have
 1
0
 1
0 |F2(t1,t2)|p dt1 dt2 ≤Ap
p
 1
0

∑
j1
∑
j2
cj1, j2r j2(t2)
2
p
2
dt2
≤Ap
p

∑
j1
 1
0
∑
j2
cj1, j2r j2(t2)
p dt2
2
p p
2
≤A2p
p

∑
j1 ∑
j2
|cj1, jn|2
p
2
,

590
C Rademacher Functions
where we used Minkowski’s integral inequality (with exponent p/2 ≥1) in the sec-
ond inequality and the result in the case n = 1 twice.
The case p < 2 follows trivially from H¨older’s inequality with constant Ap = 1.
The reverse inequalities follow exactly as in the case of one variable. Replacing Ap
by An
p in the argument, giving the reverse inequality in the case n = 1, we obtain the
constant Bn
p.
Likewise one may extend the weak type inequalities of Appendix C.3 in several
variables.

Appendix D
Spherical Coordinates
D.1 Spherical Coordinate Formula
Switching integration from spherical coordinates to Cartesian is achieved via the
following identity:

RSn−1
f(x)dσ(x) =
 π
ϕ1=0···
 π
ϕn−2=0
 2π
ϕn−1=0f(x(ϕ))J(n,R,ϕ)dϕn−1 ···dϕ1,
where
x1 = Rcosϕ1 ,
x2 = Rsinϕ1 cosϕ2 ,
x3 = Rsinϕ1 sinϕ2 cosϕ3 ,
...
xn−1 = Rsinϕ1 sinϕ2 sinϕ3 ···sinϕn−2 cosϕn−1 ,
xn = Rsinϕ1 sinϕ2 sinϕ3 ···sinϕn−2 sinϕn−1 ,
and 0 ≤ϕ1,...,ϕn−2 ≤π, 0 ≤ϕn−1 = θ < 2π,
x(ϕ) = (x1(ϕ1,...,ϕn−1),...,xn(ϕ1,...,ϕn−1)),
and
J(n,R,ϕ) =
 n
∑
k=1
det
 ∂xi
∂ϕj

1≤i̸=k≤n
1≤j≤n−1

2 1
2
= Rn−1(sinϕ1)n−2 ···(sinϕn−3)2(sinϕn−2)
is the Jacobian of the transformation.
L. Grafakos, Classical Fourier Analysis, Graduate Texts in Mathematics 249,
DOI 10.1007/978-1-4939-1194-3, © Springer Science+Business Media New York 2014
591

592
D Spherical Coordinates
D.2 A Useful Change of Variables Formula
The following formula is useful in computing integrals over the sphere Sn−1 when
n ≥2. Let f be a function deﬁned on Sn−1. Then we have

RSn−1 f(x)dσ(x) =
 +R
−R

√
R2−s2 Sn−2
f

s,θ

dθ
Rds
√
R2 −s2 .
To prove this formula, let ϕ′ = (ϕ2,...,ϕn−1) and
x′ = x′(ϕ′) = (cosϕ2,sinϕ2 cosϕ3,...,sinϕ2 ···sinϕn−2 sinϕn−1).
Using the change of variables in Appendix D.1 we express

RSn−1 f(x)dσ(x)
as the iterated integral
 π
ϕ1=0
 π
ϕ2=0···
 2π
ϕn−1=0 f(Rcosϕ1,Rsinϕ1 x′(ϕ′))J(n−1,1,ϕ′)dϕ′

Rdϕ1
(Rsinϕ1)2−n ,
and we can realize the expression inside the square brackets as

Sn−2 f(Rcosϕ1,Rsinϕ1 x′)dσ(x′).
Consequently,

RSn−1 f(x)dσ(x) =
 π
ϕ1=0

Sn−2 f(Rcosϕ1,Rsinϕ1 x′)dσ(x′)Rn−1(sinϕ1)n−2dϕ1 ,
and the change of variables
s = Rcosϕ1 ,
ϕ1 ∈(0,π),
ds = −Rsinϕ1 dϕ1 ,
"
R2 −s2 = Rsinϕ1 ,
yields

RSn−1 f(x)dσ(x) =
 R
−R
$
Sn−2 f(s,
"
R2 −s2 θ)dθ
%"
R2 −s2 n−2
Rds
√
R2 −s2 .
Rescaling the sphere Sn−2 to
√
R2 −s2 Sn−2 yields the claimed identity.

D.4 The Computation of Another Integral over the Sphere
593
D.3 Computation of an Integral over the Sphere
Let K be a function on the line. We use the result in Appendix D.2 to show that for
n ≥2 we have

Sn−1 K(x·θ)dθ = 2π
n−1
2
Γ
 n−1
2

 +1
−1 K(s|x|)
"
1−s2 n−3 ds
when x ∈Rn \ {0}. Let x′ = x/|x| and pick a matrix A ∈O(n) such that Ae1 = x′,
where e1 = (1,0,...,0). We have

Sn−1 K(x·θ)dθ =

Sn−1 K(|x|(x′ ·θ))dθ
=

Sn−1 K(|x|(Ae1 ·θ))dθ
=

Sn−1 K(|x|(e1 ·A−1θ))dθ
=

Sn−1 K(|x|θ1)dθ
=
 +1
−1 K(|x|s)ωn−2
"
1−s2 n−2
ds
√
1−s2
= ωn−2
 +1
−1 K(s|x|)
"
1−s2 n−3 ds,
where ωn−2 = 2π
n−1
2 Γ
 n−1
2
−1 is the surface area of Sn−2.
For example, we have

Sn−1
dθ
|ξ ·θ|α = ωn−2
 +1
−1
1
|s|α|ξ|α (1−s2)
n−3
2 ds =
1
|ξ|α
2π
n−1
2 Γ
 1−α
2

Γ
 n−α
2

,
and the integral converges only when Reα < 1.
D.4 The Computation of Another Integral over the Sphere
We compute the following integral for n ≥2:

Sn−1
dθ
|θ −e1|α ,

594
D Spherical Coordinates
where e1 = (1,0,...,0). Applying the formula in Appendix D.2, we obtain

Sn−1
dθ
|θ −e1|α =
 +1
−1

θ∈√
1−s2 Sn−2
dθ
(|s−1|2 +|θ|2)
α
2
ds
√
1−s2
=
 +1
−1 ωn−2
(1−s2)
n−2
2

(1−s)2 +1−s2 α
2
ds
√
1−s2
= ωn−2
2
α
2
 +1
−1
(1−s2)
n−3
2
(1−s)
α
2
ds
= ωn−2
2
α
2
 +1
−1 (1−s)
n−3−α
2
(1+s)
n−3
2 ds,
which converges exactly when Reα < n−1.
D.5 Integration over a General Surface
Suppose that S is a hypersurface in Rn of the form S = {(u,Φ(u)) : u ∈D}, where
D is an open subset of Rn−1 and Φ is a continuously differentiable mapping from D
to R. Let σ be the canonical surface measure on S. If g is a function on S, then we
have

S g(y)dσ(y) =

D g(x,Φ(x))

1+
n−1
∑
j=1
|∂jΦ(x)|21
2 dx.
Specializing to the sphere, we obtain

Sn−1 g(θ)dθ =

ξ ′∈Rn−1
|ξ ′|<1
/
g(ξ ′,
!
1−|ξ ′|2)+g(ξ ′,−
!
1−|ξ ′|2)
0
dξ ′
"
1−|ξ ′|2 .
D.6 The Stereographic Projection
Deﬁne a map Π : Rn →Sn by the formula
Π(x1,...,xn) =

2x1
1+|x|2 ,...,
2xn
1+|x|2 , |x|2 −1
1+|x|2

.
It is easy to see that Π is a one-to-one map from Rn onto the sphere Sn minus the
north pole en+1 = (0,...,0,1). Its inverse is given by the formula
Π −1(θ1,...,θn+1) =

θ1
1−θn+1
,...,
θn
1−θn+1

.

D.6 The Stereographic Projection
595
The Jacobian of the map is veriﬁed to be JΠ(x) =

2
1+|x|2
−n , and the following
change of variables formulas are valid:

Sn F(θ)dθ =

Rn F(Π(x))JΠ(x)dx
and

Rn F(x)dx =

Sn F(Π −1(θ))JΠ−1(θ)dθ ,
where
JΠ−1(θ) =
1
JΠ(Π −1(θ)) =
'
|θ1|2 +···+|θn|2 +|1−θn+1|2
2|1−θn+1|2
(n
.
Another interesting formula about the stereographic projection Π is
|Π(x)−Π(y)| = 2|x−y|(1+|x|2)−1/2(1+|y|2)−1/2 ,
x,y ∈Rn .

Appendix E
Some Trigonometric Identities and Inequalities
The following inequalities are valid for t real:
0 < t < π
2 =⇒sin(t) < t < tan(t),
0 < |t| < π
2 =⇒2
π < sin(t)
t
< 1,
−∞< t < +∞=⇒|sin(t)| ≤|t|,
−∞< t < +∞=⇒|1−cos(t)| ≤|t|2
2 ,
−∞< t < +∞=⇒|1−eit| ≤|t|,
|t| ≤π
2 =⇒|sin(t)| ≥2|t|
π ,
|t| ≤π =⇒|1−cos(t)| ≥2|t|2
π2 ,
|t| ≤π =⇒|1−eit| ≥2|t|
π .
The following sum to product formulas are valid:
sin(a)+sin(b) = 2 sin
a+b
2

cos
a−b
2

,
sin(a)−sin(b) = 2 cos
a+b
2

sin
a−b
2

,
cos(a)+cos(b) = 2 cos
a+b
2

cos
a−b
2

,
cos(a)−cos(b) = −2 sin
a+b
2

sin
a−b
2

.
L. Grafakos, Classical Fourier Analysis, Graduate Texts in Mathematics 249,
DOI 10.1007/978-1-4939-1194-3, © Springer Science+Business Media New York 2014
597

598
E Some Trigonometric Identities and Inequalities
The following identities are also easily proved:
N
∑
k=1
cos(kx) = −1
2 + sin((N + 1
2)x)
2sin( x
2)
,
N
∑
k=1
sin(kx) = cos( x
2)−cos((N + 1
2)x)
2sin( x
2)
.

Appendix F
Summation by Parts
Let {ak}∞
k=0, {bk}∞
k=0 be two sequences of complex numbers. Then for N ≥1 we
have
N
∑
k=0
akbk = ANbN −
N−1
∑
k=0
Ak(bk+1 −bk),
where
Ak =
k
∑
j=0
aj .
More generally we have
N
∑
k=M
akbk = ANbN −AM−1bM −
N−1
∑
k=M
Ak(bk+1 −bk),
whenever 0 ≤M ≤N, where A−1 = 0 and
Ak =
k
∑
j=0
aj
for k ≥0.
L. Grafakos, Classical Fourier Analysis, Graduate Texts in Mathematics 249,
DOI 10.1007/978-1-4939-1194-3, © Springer Science+Business Media New York 2014
599

Appendix G
Basic Functional Analysis
A quasi-norm is a nonnegative functional ∥· ∥on a vector space X that satisﬁes
∥x + y∥X ≤K(∥x∥X + ∥y∥X) for some K ≥0 and all x,y ∈X and also ∥λx∥X =
|λ|∥x∥X for all scalars λ. When K = 1, the quasi-norm is called a norm. A quasi-
Banach space is a quasi-normed space that is complete with respect to the topology
generated by the quasi-norm. The proofs of the following theorems can be found in
several books including Albiac and Kalton [1], Kalton Peck and Roberts [188], and
Rudin [306].
The Hahn–Banach theorem. Let X be a normed vector space (over the real or
complex numbers), let Y be a subspace of X, and let P be a positively homogeneous
subadditive1 functional on X. Then for every linear functional Λ on Y that satisﬁes
|Λ(y)| ≤P(y)
for all y ∈Y, there is a linear functional Λ ′ on X such that
Λ ′(y) = Λ(y)
for all y ∈Y,
|Λ ′(x)| ≤P(x)
for all x ∈X.
In particular, every bounded linear functional on a subspace has an extension on
the entire space with the same norm.
Banach–Alaoglou theorem. Let X be a normed vector space and let X∗be the
space of all bounded linear functionals on X. Then the closed unit ball of X∗is
compact in the weak∗topology.
A special case is the sequential version of this theorem, which asserts that the
closed unit ball of the dual space of a separable normed vector space is sequentially
compact in the weak∗topology. Indeed, the weak∗topology on the closed unit ball
1 this means that P(x) ≥0 for all x ∈X, P(λx) = λP(x) for all λ > 0 and all x ∈X, and that
P(x+z) ≤P(x)+P(z) for all x,z ∈X.
L. Grafakos, Classical Fourier Analysis, Graduate Texts in Mathematics 249,
DOI 10.1007/978-1-4939-1194-3, © Springer Science+Business Media New York 2014
601

602
G Basic Functional Analysis
of the dual of a separable space is metrizable, and thus compactness and sequential
compactness are equivalent.
Open mapping theorem. Suppose that X and Y are quasi-Banach spaces and
T is a bounded surjective linear map from X onto Y. Then T maps open sets to
open sets, i.e., it is an open mapping. Moreover, if T is injective, then there exists a
constant K < ∞such that for all x ∈X we have
∥x∥X ≤K∥T(x)∥Y .
Closed graph theorem. Suppose that X and Y are quasi-Banach spaces and T is
a linear map from X to Y whose graph is a closed set, i.e., whenever xk,x ∈X and
(xk,T(xk)) →(x,y) in X ×Y for some y ∈Y, then T(x) = y. Then T is a bounded
linear map from X to Y.
Uniform boundedness principle. Suppose that X is a quasi-Banach space, Y is
a quasi-normed space and (Tα)α∈I is a family of bounded linear maps from X to Y
such that for all x ∈X there exists a Cx < ∞such that
sup
α∈I
∥Tα(x)∥Y ≤Cx .
Then there exists a constant K < ∞such that
sup
α∈I
∥Tα∥X→Y ≤K .

Appendix H
The Minimax Lemma
Minimax type results are used in the theory of games and have their origin in the
work of Von Neumann [369]. Much of the theory in this subject is based on convex
analysis techniques. For instance, this is the case with the next proposition, which
is needed in the “difﬁcult” inequality in the proof of the minimax lemma. We refer
to Fan [111] for a general account of minimax results. The following exposition is
based on the simple presentation in Appendix A2 of [122].
Minimax Lemma. Let A, B be convex subsets of certain vector spaces. Assume that
a topology is deﬁned in B for which it is a compact Hausdorff space and assume that
there is a function Φ : A×B →R{+∞} that satisﬁes the following:
(a) Φ(.,b) is a concave function on A for each b ∈B,
(b) Φ(a, .) is a convex function on B for each a ∈A,
(c) Φ(a, .) is lower semicontinuous on B for each a ∈A.
Then the following identity holds:
min
b∈B sup
a∈A
Φ(a,b) = sup
a∈A
min
b∈B Φ(a,b).
To prove the lemma we need the following proposition:
Proposition. Let B be a convex compact subset of a vector space and suppose that
gj : B →R{+∞}, j = 1,2,...,n, are convex and lower semicontinuous functions.
If
max
1≤j≤ngj(b) > 0
for all
b ∈B,
then there exist nonnegative numbers λ1,λ2,...,λn such that
λ1g1(b)+λ2g2(b)+···+λngn(b) > 0
for all
b ∈B.
Proof. We ﬁrst consider the case n = 2. Deﬁne subsets of B
B1 = {b ∈B : g1(b) ≤0},
B2 = {b ∈B : g2(b) ≤0}.
L. Grafakos, Classical Fourier Analysis, Graduate Texts in Mathematics 249,
DOI 10.1007/978-1-4939-1194-3, © Springer Science+Business Media New York 2014
603

604
H The Minimax Lemma
If B1 = /0, we take λ1 = 1 and λ2 = 0, and we similarly deal with the case B2 = /0. If
B1 and B2 are nonempty, then they are closed and thus compact. The hypothesis of
the proposition implies that g2(b) > 0 ≥g1(b) for all b ∈B1. Therefore, the function
−g1(b)/g2(b) is well deﬁned and upper semicontinuous on B1 and thus attains its
maximum. The same is true for −g2(b)/g1(b) deﬁned on B2. We set
μ1 = max
b∈B1
−g1(b)
g2(b) ≥0,
μ2 = max
b∈B2
−g2(b)
g1(b) ≥0.
We need to ﬁnd λ > 0 such that λg1(b) + g2(b) > 0 for all b ∈B. This is clearly
satisﬁed if b ̸∈B1
B2, while for b1 ∈B1 and b2 ∈B2 we have
λg1(b1)+g2(b1) ≥(1−λμ1)g2(b1),
λg1(b2)+g2(b2) ≥(λ −μ2)g1(b2).
Therefore, it sufﬁces to ﬁnd a λ > 0 such that 1−λμ1 > 0 and λ −μ2 > 0. Such a
λ exists if and only if μ1μ2 < 1. To prove that μ1μ2 < 1, we can assume that μ1 ̸= 0
and μ2 ̸= 0. Then we take b1 ∈B1 and b2 ∈B2, for which the maxima μ1 and μ2 are
attained, respectively. Then we have
g1(b1)+ μ1g2(b1) = 0,
g1(b2)+ 1
μ2
g2(b2) = 0.
But g1(b1) < 0 < g1(b2); thus taking bθ = θb1 +(1−θ)b2 for some θ in (0,1), we
have
g1(bθ) ≤θg1(b1)+(1−θ)g1(b2) = 0.
Considering the same convex combination of the last displayed equations and using
this identity, we obtain that
μ1μ2θg2(b1)+(1−θ)g2(b2) = 0.
The hypothesis of the proposition implies that g2(bθ) > 0 and the convexity of g2:
θg2(b1)+(1−θ)g2(b2) > 0.
Since g2(b1) > 0, we must have μ1μ2g2(b1) < g2(b1), which gives μ1μ2 < 1. This
proves the required claim and completes the case n = 2.
We now use induction to prove the proposition for arbitrary n. Assume that the
result has been proved for n−1 functions. Consider the subset of B
Bn = {b ∈B : gn(b) ≤0}.
If Bn = /0, we choose λ1 = λ2 = ··· = λn−1 = 0 and λn = 1. If Bn is not empty, then it
is compact and convex and we can restrict g1,g2,...,gn−1 to Bn. Using the induction
hypothesis, we can ﬁnd λ1,λ2,...,λn−1 ≥0 such that

H The Minimax Lemma
605
g0(b) = λ1g1(b)+λ2g2(b)+···+λn−1gn−1(b) > 0
for all b ∈Bn. Then g0 and gn are convex lower semicontinuous functions on B, and
max(g0(b),gn(b)) > 0 for all b ∈B. Using the case n = 2, which was ﬁrst proved,
we can ﬁnd λ0,λn ≥0 such that for all b ∈B we have
0 < λ0g0(b)+λngn(b)
= λ0λ1g1(b)+λ0λ2g2(b)+···+λ0λn−1gn−1(b)+λngn(b).
This establishes the case of n functions and concludes the proof of the induction and
hence of the proposition.
□
We now turn to the proof of the minimax lemma.
Proof. The fact that the left-hand side in the required conclusion of the minimax
lemma is at least as big as the right-hand side is obvious. We can therefore concen-
trate on the converse inequality. In doing this we may assume that the right-hand side
is ﬁnite. Without loss of generality we can subtract a ﬁnite constant from Φ(a,b),
and so we can also assume that
sup
a∈A
min
b∈B Φ(a,b) = 0.
Then, by hypothesis (c) of the minimax lemma, the subsets
Ba = {b ∈B : Φ(a,b) ≤0},
a ∈A
of B are closed and nonempty, and we show that they satisfy the ﬁnite intersection
property. Indeed, suppose that
Ba1 ∩Ba2 ∩···∩Ban = /0
for some a1,a2,...,an ∈A. We write gj(b) = Φ(aj,b), j = 1,2,...,n, and we ob-
serve that the conditions of the previous proposition are satisﬁed. Therefore we can
ﬁnd λ1,λ2,...,λn ≥0 such that for all b ∈B we have
λ1Φ(a1,b)+λ2Φ(a2,b)+···+λnΦ(an,b) > 0.
For simplicity we normalize the λ j’s by setting λ1 + λ2 + ··· + λn = 1. If we set
a0 = λ1a1 +λ2a2 +···+λnan, the concavity hypothesis (a) gives
Φ(a0,b) > 0
for all b ∈B, contradicting the fact that supa∈A minb∈B Φ(a,b) = 0. Therefore, the
family of closed subsets {Ba}a∈A of B satisﬁes the ﬁnite intersection property. The
compactness of B now implies 
a∈A Ba ̸= /0. Take b0 ∈
a∈A Ba. Then Φ(a,b0) ≤0
for every a ∈A, and therefore
min
b∈B sup
a∈A
Φ(a,b) ≤sup
a∈A
Φ(a,b0) ≤0
as required.
□

Appendix I
Taylor’s and Mean Value Theorem in Several
Variables
I.1 Mutlivariable Taylor’s Theorem
For a multiindex α = (α1,...,αn) ∈(Z+ ∪{0})n, we denote by |α| = α1 +···+αn
its size, we deﬁne α! = α1!···αn! its factorial, and we set
hα = hα1
1 ···hαn
n ,
where h = (h1,...,hn); here 00 = 1.
Let k ∈Z+ ∪{0}. Suppose a real-valued C k+1 function f is deﬁned on an open
convex subset Ω of Rn. Suppose that x ∈Ω and x+h ∈Ω. Then we have the Taylor
expansion formula
f(x+h) = ∑
|α|≤k
∂α f(x)
α!
hα +R(h,x,k),
where the remainder R(h,x,k) can be expressed either in Langrange’s mean value
form
R(h,x,k) = ∑
|α|=k+1
∂α f(x+ch)
α!
hα
for some c ∈(0,1), or in integral form
R(h,x,k) = (k +1) ∑
|α|=k+1
hα
α!
 1
0 (1−t)k∂α f(x+th)dt .
L. Grafakos, Classical Fourier Analysis, Graduate Texts in Mathematics 249,
DOI 10.1007/978-1-4939-1194-3, © Springer Science+Business Media New York 2014
607

608
I Taylor’s and Mean Value Theorem in Several Variables
I.2 The Mean value Theorem
Suppose that f is as above and k = 0. Then for given x,y ∈Ω we have
f(y)−f(x) =
 1
0 ∇f((1−t)x+ty)·(y−x)dt = ∇f((1−c)x+cy)·(y−x)
for some c ∈(0,1). This is a special case of Taylor’s formula when k = 0.

Appendix J
The Whitney Decomposition of Open Sets in Rn
J.1 Decomposition of Open Sets
An arbitrary open set in Rn can be decomposed as a union of disjoint cubes whose
lengths are proportional to their distance from the boundary of the open set. See, for
instance, Figure J.1 when the open set is the unit disk in R2. For a given cube Q in
Rn, we denote by ℓ(Q) its length.
Proposition. Let Ω be an open nonempty proper subset of Rn. Then there exists a
family of closed dyadic cubes {Qj}j (called the Whitney cubes of Ω) such that
(a) 
j Qj = Ω and the Qj’s have disjoint interiors.
(b) √nℓ(Qj) ≤dist(Qj,Ω c) ≤4√nℓ(Qj). Thus 10√nQj meets Ω c.
(c) If the boundaries of two cubes Qj and Qk touch, then
1
4 ≤ℓ(Qj)
ℓ(Qk) ≤4.
(d) For a given Q j there exist at most 12n −4n cubes Qk that touch it.
(e) Let 0 < ε < 1/4. If Q∗
j has the same center as Qj and ℓ(Q∗
j) = (1+ε)ℓ(Qj) then
χΩ = ∑
j
χQ∗
j ≤12n −4n +1.
Proof. Let Dk be the collection of all dyadic cubes of the form
{(x1,...,xn) ∈Rn : mj2−k ≤xj < (mj +1)2−k},
where mj ∈Z. Observe that each cube in Dk gives rise to 2n cubes in Dk+1 by
bisecting each side.
Write the set Ω as the union of the sets
Ωk = {x ∈Ω : 2√n2−k < dist(x,Ω c) ≤4√n2−k}
L. Grafakos, Classical Fourier Analysis, Graduate Texts in Mathematics 249,
DOI 10.1007/978-1-4939-1194-3, © Springer Science+Business Media New York 2014
609

610
J The Whitney Decomposition of Open Sets in Rn
over all k ∈Z. Let F ′ be the set of all cubes Q in Dk for some k ∈Z such that
Q∩Ωk ̸= /0. We show that the collection F ′ satisﬁes property (b). Let Q ∈F ′ and
pick x ∈Ωk ∩Q for some k ∈Z. Observe that
√n2−k ≤dist(x,Ω c)−√nℓ(Q) ≤dist(Q,Ω c) ≤dist(x,Ω c) ≤4√n2−k ,
which proves (b).
Next we observe that

Q∈F ′
Q = Ω .
Indeed, every Q in F ′ is contained in Ω (since it has positive distance from its
complement) and every x ∈Ω lies in some Ωk and in some dyadic cube in Dk.
Fig. J.1 The Whitney decom-
position of the unit disk.
The problem is that the cubes in the collection F ′ may not be disjoint. We have
to reﬁne the collection F ′ by eliminating those cubes that are contained in some
other cubes in the collection. Recall that two dyadic cubes have disjoint interiors or
else one contains the other. For every cube Q in F ′ we can therefore consider the
unique maximal cube Qmax in F ′ that contains it. Two different such maximal cubes
must have disjoint interiors by maximality. Now set F = {Qmax : Q ∈F ′}.
The collection of cubes {Qj}j = F clearly satisﬁes (a) and (b), and we now turn
our attention to the proof of (c). Observe that if Qj and Qk in F touch then
√nℓ(Qj) ≤dist(Qj,Ω c) ≤dist(Qj,Qk)+dist(Qk,Ω c) ≤0+4√nℓ(Qk),
which proves (c). To prove (d), note that any cube Q in Dk is touched by exactly
3n −1 other cubes in Dk. But each cube Q in Dk can contain at most 4n cubes of F
of length at least one-quarter of the length of Q. This fact combined with (c) yields
(d). To prove (e), notice that each Q∗
j is contained in Ω by part (b). If x ∈Ω, then

J.2 Partition of Unity adapted to Whitney cubes
611
x ∈Qk0 for some k0. If Qj does not touch Qk0, then Q∗
j does not touch Qk0 as well.
Consequently, the given x ∈Ω may lie only in Q∗
k for these cubes Qk that touch Qk0
and there are 12n −4n +1 such cubes including Qk0.
□
J.2 Partition of Unity adapted to Whitney cubes
Let us ﬁx an ε such that 0 < ε < 1/4. For each cube Q we denote by Q∗the cube
with the same center as Q and side length (1+ε)ℓ(Q), where ℓ(Q) is the side length
of Q. Let us ﬁx a nonnegative smooth function φ that is equal to 1 on the unit cube
Q0 = [−1/2,1/2]n and equal to zero outside Q∗
0.
Let {Qk}k be the family of Whitney cubes of Ω. We denote by ck the center of Qk
and by ℓk its side length. Since dist (Qk,Ω c) ≥√nℓk, and dist ((Q∗
k)c,Qk) ≤ε√nℓk,
it follows that
dist (Q∗
k,Ω c) ≥(1−ε)√nℓk > 0,
hence Q∗
k is contained in Ω. Since the union of Qk is Ω, then the union of Q∗
k is
also Ω.
For each k we deﬁne
φk(x) = φ
x−ck
ℓk

and we set
Φ(x) = ∑
k
φk(x).
We notice that Φ is smooth and that Φ ≥1 on Ω. Then we deﬁne
ϕk(x) = φk(x)
Φ(x) .
Obviously ϕk are supported in Q∗
k, the union of Q∗
k is Ω, and we have
∑
k
ϕk = χΩ .
We would like to control |∂αϕk(x)| in terms of ℓk. To achieve this we use the
Leibniz rule of differentiation. For a ﬁxed k we have that
∂α
∂xα ϕk(x) = ∑
β≤α
α1
β1

···
αn
βn
 ∂β
∂xβ
1
Φ(x)
 ∂α−β
∂xα−β φk(x)
and obviously
∂α−βφk(x)
 ≤ℓ−|α|+|β|
k
. A simple inductive argument shows that
 ∂β
∂xβ
1
Φ(x)
 ≤C
∑
0≤q j≤|β|
q1+···+qn=|β|
∂q1
1 ···∂qn
n Φ(x)

Φ(x)2
,

612
J The Whitney Decomposition of Open Sets in Rn
for some constant C, and since for a given x ∈Ω, Φ(x) is the sum of at most 12n
functions with nonzero values, it follows that
∂q1
1 ···∂qn
n Φ(x)
 ≤Cn ℓ−(q1+···+qn)
k
when x ∈Q∗
k and thus
 ∂β
∂xβ
1
Φ(x)
 ≤C′
n,β ℓ−|β|
k
for x ∈Q∗
k. We conclude that for every multiindex α there is a constant Cα,n such
that
 ∂α
∂xα ϕk(x)
 ≤Cα,n ℓ−|α| .
More on Whitney decompositions can be found in the article of Whitney [373]
and the books of Stein [338], Krantz and Parks [204].

Glossary
A ⫅B
A is a subset of B (also denoted by A ⊆B)
A ⫋B
A is a proper subset of B
A ⊃B
B is a proper subset of A
Ac
the complement of a set A
χE
the characteristic function of the set E
df
the distribution function of a function f
f ∗
the decreasing rearrangement of a function f
fn ↑f
fn increases monotonically to a function f
Z
the set of all integers
Z+
the set of all positive integers {1,2,3,...}
Zn
the n-fold product of the integers
R
the set of real numbers
R+
the set of positive real numbers
Rn
the Euclidean n-space
Q
the set of rationals
Qn
the set of n-tuples with rational coordinates
C
the set of complex numbers
Cn
the n-fold product of complex numbers
T
the unit circle identiﬁed with the interval [0,1]
Tn
the n-dimensional torus [0,1]n
|x|
"
|x1|2 +···+|xn|2 when x = (x1,...,xn) ∈Rn
L. Grafakos, Classical Fourier Analysis, Graduate Texts in Mathematics 249,
DOI 10.1007/978-1-4939-1194-3, © Springer Science+Business Media New York 2014
613

614
Glossary
Sn−1
the unit sphere {x ∈Rn : |x| = 1}
ej
the vector (0,...,0,1,0,...,0) with 1 in the jth entry and 0 elsewhere
logt
the logarithm with base e of t > 0
logat
the logarithm with base a of t > 0 (1 ̸= a > 0)
log+t
max(0,logt) for t > 0
[t]
the integer part of the real number t
x·y
the quantity ∑n
j=1 xjyj when x = (x1,...,xn) and y = (y1,...,yn)
B(x,R)
the ball of radius R centered at x in Rn
ωn−1
the surface area of the unit sphere Sn−1
vn
the volume of the unit ball {x ∈Rn : |x| < 1}
|A|
the Lebesgue measure of the set A ⊆Rn
dx
Lebesgue measure
AvgB f
the average
1
|B|

B f(x)dx of f over the set B
4
f,g
5
the real inner product

Rn f(x)g(x)dx
4
f |g
5
the complex inner product

Rn f(x)g(x)dx
4
u, f
5
the action of a distribution u on a function f
p′
the number p/(p−1), whenever 0 < p ̸= 1 < ∞
1′
the number ∞
∞′
the number 1
f = O(g)
means | f(x)| ≤M|g(x)| for some M for x near x0
f = o(g)
means | f(x)||g(x)|−1 →0 as x →x0
At
the transpose of the matrix A
A∗
the conjugate transpose of a complex matrix A
A−1
the inverse of the matrix A
O(n)
the space of real matrices satisfying A−1 = At
∥T∥X→Y
the norm of the (bounded) operator T : X →Y
A ≈B
means that there exists a c > 0 such that c−1 ≤B
A ≤c
|α|
indicates the size |α1|+···+|αn| of a multi-index α = (α1,...,αn)
∂m
j f
the mth partial derivative of f(x1,...,xn) with respect to xj
∂α f
∂α1
1 ···∂αn
n f

Glossary
615
C k
the space of functions f with ∂α f continuous for all |α| ≤k
C0
the space of continuous functions with compact support
C00
the space of continuous functions that vanish at inﬁnity
C ∞
0
the space of smooth functions with compact support
D
the space of smooth functions with compact support
S
the space of Schwartz functions
S0
the space of Schwartz functions ϕ with the property

Rn xγϕ(x)dx = 0
for all multi-indices γ.
C ∞
the space of smooth functions ∞
k=1 C k
D′(Rn)
the space of distributions on Rn
S ′(Rn)
the space of tempered distributions on Rn
E ′(Rn)
the space of distributions with compact support on Rn
P
the set of all complex-valued polynomials of n real variables
S ′(Rn)/P the space of tempered distributions on Rn modulo polynomials
ℓ(Q)
the side length of a cube Q in Rn
∂Q
the boundary of a cube Q in Rn
Lp(X,μ)
the Lebesgue space over the measure space (X,μ)
Lp(Rn)
the space Lp(Rn,|·|)
Lp,q(X,μ)
the Lorentz space over the measure space (X,μ)
Lp
loc(Rn)
the space of functions that lie in Lp(K) for any compact set K in Rn
|dμ|
the total variation of a ﬁnite Borel measure μ on Rn
M (Rn)
the space of all ﬁnite Borel measures on Rn
Mp(Rn)
the space of Lp Fourier multipliers, 1 ≤p ≤∞
M p,q(Rn)
the space of translation-invariant operators that map Lp(Rn) to Lq(Rn)
∥μ∥M

Rn |dμ| the norm of a ﬁnite Borel measure μ on Rn
M
the centered Hardy–Littlewood maximal operator with respect to balls
M
the uncentered Hardy–Littlewood maximal operator with respect to balls
Mc
the centered Hardy–Littlewood maximal operator with respect to cubes
Mc
the uncentered Hardy–Littlewood maximal operator with respect to
cubes

616
Glossary
Mμ
the centered maximal operator with respect to a measure μ
Mμ
the uncentered maximal operator with respect to a measure μ
Ms
the strong maximal operator
Md
the dyadic maximal operator

References
1. Albiac, F., Kalton, N. J., Topics in Banach Space Theory, Graduate Texts in Mathematics,
233, Springer, New York, 2006.
2. Aldaz, J. M., The weak type (1,1) bounds for the maximal function associated to cubes grow
to inﬁnity with the dimension, Ann. of Math. (2nd Ser.) 173 (2011), no. 2, 1013–1023.
3. Alimov, Sh. A., Ashurov, R. R., Pulatov, A. K., Multiple Fourier series and Fourier integrals,
Proc. Commutative Harmonic Analysis, IV, pp. 1–95, Encyclopaedia Math. Sci. 42, Springer,
Berlin, 1992.
4. Alvarez, J., P´erez, C., Estimates with A∞weights for various singular integral operators,
Boll. Un. Mat. Ital. A (7) 8 (1994), no. 1, 123–133.
5. Antonov, N. Yu., Convergence of Fourier series, Proceedings of the XX Workshop on Func-
tion Theory (Moscow, 1995), East J. Approx. 2 (1996), no. 2, pp. 187–196.
6. Antonov, N. Yu., The behavior of partial sums of trigonometric Fourier series [Russian], Ph.
D. Thesis, Institute of Mathematics and Mechanics, Ural Branch of the Russian Academy of
Sciences, Ekaterinburg, 1998.
7. Aoki, T., Locally bounded spaces, Proc. Imp. Acad. Tokyo 18 (1942), no. 10, 585–634.
8. Arhipov, G. I., Karachuba, A. A., ˇCubarikov, V. N., Trigonometric integrals, Math. USSR
Izvestija 15 (1980), 211–239.
9. Arias de Reyna, J., Pointwise convergence of Fourier series, J. London Math. Soc. (2) 65
(2002), no. 1, 139–153.
10. Arias de Reyna, J., Pointwise Convergence of Fourier Series, Lecture Notes in Mathematics,
1785, Springer-Verlag, Berlin, 2002.
11. Ash, J. M., Multiple trigonometric series, Studies in Harmonic Analysis (Proc. Conf., De-
Paul Univ., Chicago, IL, 1974), pp. 76–96, MAA Stud. Math., Vol. 13, Math. Assoc. Amer.,
Washington, D. C., 1976.
12. Asmar, N., Berkson, E., Gillespie, T. A., Summability methods for transferring Fourier multi-
pliers and transference of maximal inequalities, Analysis and Partial Differential Equations,
pp. 1–34, Lecture Notes in Pure and Appl. Math. 122, Dekker, New York, 1990.
13. Asmar, N., Berkson, E., Gillespie, T. A., On Jodeit’s multiplier extension theorems, J. Anal.
Math. 64 (1994), 337–345.
14. Astala, K., Iwaniec, T., Saksman, E., Beltrami operators in the plane, Duke Math. J. 107
(2001), no. 1, 27–56.
15. Aubrun, G., Maximal inequality for high-dimensional cubes, Conﬂuentes Math. 1 (2009),
no. 2, 169–179.
16. Babenko, K. I., An inequality in the theory of Fourier integrals [Russian], Izv. Akad. Nauk
SSSR Ser. Mat. 25 (1961), 531–542.
17. Baernstein II, A., Some sharp inequalities for conjugate functions, Indiana Univ. Math. J. 27
(1978), 833–852.
L. Grafakos, Classical Fourier Analysis, Graduate Texts in Mathematics 249,
DOI 10.1007/978-1-4939-1194-3, © Springer Science+Business Media New York 2014
617

618
References
18. Bagby, R., Kurtz, D. S., Covering lemmas and the sharp function, Proc. Amer. Math. Soc. 93
(1985), no. 2, 291–296.
19. Bagby, R., Kurtz, D. S., A rearranged good-λ inequality, Trans. Amer. Math. Soc. 293
(1986), no. 1, 71–81.
20. Bary, N., A Treatise on Trigonometric Series, Vols. I, II, Authorized translation by Margaret
F. Mullins, A Pergamon Press Book, The Macmillan Co., New York, 1964.
21. Beckner, W., Inequalities in Fourier analysis, Ann. of Math. (2nd Ser.) 102 (1975), no. 1,
159–182.
22. Benedek, A., Calder´on, A.-P., Panzone, R., Convolution operators on Banach-space valued
functions, Proc. Nat. Acad. Sci. U.S.A. 48 (1962), 356–365.
23. Benedetto, J., Frazier, M. (eds.), Wavelets: Mathematics and Applications, CRC Press, Boca
Raton, FL, 1994.
24. Bennett, C., Sharpley, R., Interpolation of Operators, Pure and Applied Mathematics, 129
Academic Press, Inc., Boston, MA, 1988.
25. Bergh, J., L¨ofstr¨om, J., Interpolation Spaces, An Introduction, Grundlehren der Mathematis-
chen Wissenschaften, No. 223, Springer-Verlag, Berlin-New York, 1976.
26. Bernstein, S., Sur la convergence absolue des s´eries trigonom´etriques, Comptes Rendus des
S´eances de l’ Acad´emie des Sciences, Paris, 158 (1914), 1661–1663.
27. Besicovitch, A., A general form of the covering principle and relative differentiation of addi-
tive functions, Proc. of Cambridge Philos. Soc. 41 (1945), 103–110.
28. Boas, R. P., Bochner, S., On a theorem of M. Riesz for Fourier series, J. London Math. Soc.
14 (1939), no. 1, 62–73.
29. Bˆocher, M., Introduction to the theory of Fourier’s series, Ann. of Math. (2nd Ser.) 7 (1906),
no. 3, 81–152.
30. Bochner, S., Summation of multiple Fourier series by spherical means, Trans. Amer. Math.
Soc. 40 (1936), no. 2, 175–207.
31. Bochner, S., Harmonic Analysis and the Theory of Probability, University of California
Press, Berkeley and Los Angeles, 1955.
32. Bochner, S., Lectures on Fourier Integrals, (with an author’s supplement on monotonic func-
tions, Stieltjes integrals, and harmonic analysis), Translated by Morris Tenenbaum and Harry
Pollard. Annals of Mathematics Studies, No. 42, Princeton University Press, Princeton, NJ,
1959.
33. Bojarski, B., Remarks on Markov’s inequalities and some properties of polynomials (Russian
summary), Bull. Polish Acad. Sci. Math. 33 (1985), no. 7-8, 355–365.
34. Bourgain, J., On square functions on the trigonometric system, Bull. Soc. Math. Belg. S´er. B
37 (1985), no. 1, 20–26.
35. Bourgain, J., Estimations de certaines fonctions maximales, C. R. Acad. Sci. Paris S´er. I
Math. 301 (1985), no. 10, 499–502.
36. Bourgain, J., Averages in the plane over convex curves and maximal operators, J. Analyse
Math. 47 (1986), 69–85.
38. Buckley, S. M., Estimates for operator norms on weighted spaces and reverse Jensen in-
equalities, Trans. Amer. Math. Soc. 340 (1993), no. 1, 253–272.
39. Burkholder, D. L., Martingale transforms, Ann. Math. Statist. 37 (1966), 1494–1505.
40. Burkholder, D. L., Gundy, R. F., Extrapolation and interpolation of quasilinear operators on
martingales, Acta Math. 124 (1970), no. 1, 249–304.
41. Calder´on, A. P., On the theorems of M. Riesz and Zygmund, Proc. Amer. Math. Soc. 1 (1950),
533–535.
42. Calder´on, A. P., Intermediate spaces and interpolation, the complex method, Studia Math. 24
(1964), 113–190.
43. Calder´on, A. P., Singular integrals, Bull. Amer. Math. Soc. 72 (1966), 427–465.
44. Calder´on, A. P., Algebras of singular integral operators, Singular Integrals (Proc. Sympos.
Pure Math. (Chicago, IL, 1966), pp. 18–55, Amer. Math. Soc., Providence, RI, 1967.
37. Bourgain, J., On the Hardy-Littlewood maximal function for the cube, Israel J. Math. 203
(2014), 275–293.

References
619
45. Calder´on, A. P., Torchinsky, A., Parabolic maximal functions associated with a distribution,
II, Advances in Math. 24 (1977), no. 2, 101–171.
46. Calder´on, A. P., Zygmund, A., On the existence of certain singular integrals, Acta Math. 88
(1952), no. 1, 85–139.
47. Calder´on, A. P., Zygmund, A., A note on interpolation of sublinear operators, Amer. J. Math.
78 (1956), 282–288.
48. Calder´on, A. P., Zygmund, A., On singular integrals, Amer. J. Math. 78 (1956), 289–309.
49. Calder´on, A. P., Zygmund, A., Algebras of certain singular integral operators, Amer. J. Math.
78 (1956), 310–320.
50. Calder´on, C., Lacunary spherical means, Illinois J. Math. 23 (1979), no. 3, 476–484.
51. Carbery, A., An almost-orthogonality principle with applications to maximal functions asso-
ciated to convex bodies, Bull. Amer. Math. Soc. (N.S.) 14 (1986), no. 2, 269–273.
52. Carbery, A., Variants of the Calder´on–Zygmund theory for Lp-spaces, Rev. Mat. Iberoamer-
icana 2 (1986), no. 4, 381–396.
53. Carbery, A., Christ, M., Wright, J., Multidimensional van der Corput and sublevel set esti-
mates, J. Amer. Math. Soc. 12 (1999), no. 4, 981–1015.
54. Carleson, L., On convergence and growth of partial sums of Fourier series, Acta Math. 116
(1966), no. 1, 135–157.
55. Carleson, L., On the Littlewood–Paley Theorem, Mittag-Lefﬂer Institute Report, Djursholm,
Sweden, 1967.
56. Carro, M. J., New extrapolation estimates, J. Funct. Anal. 174 (2000), no. 1, 155–166.
57. Carro, M. J., Raposo, J. A., Soria, J., Recent developments in the theory of Lorentz spaces
and weighted inequalities, Mem. Amer. Math. Soc. 187 (2007), no. 877.
58. Carro, M. J., Torres, R. H., Soria, J., Rubio de Francia’s extrapolation theory: estimates for
the distribution function, J. Lond. Math. Soc. (2) 85 (2012), no. 2, 430–454.
59. Christ, M., A convolution inequality for Cantor-Lebesgue measures, Rev. Mat. Iberoameri-
cana 1 (1985), no. 4, 79–83.
60. Christ, M., Weak type (1,1) bounds for rough operators I, Ann. of Math. (2nd Ser.) 128
(1988), no. 1, 19–42.
61. Christ, M., Fefferman, R., A note on weighted norm inequalities for the Hardy–Littlewood
maximal operator, Proc. Amer. Math. Soc. 87 (1983), no. 3, 447–448.
62. Christ, M., Grafakos, L., Best constants for two nonconvolution inequalities, Proc. Amer.
Math. Soc. 123 (1995), no. 6, 1687–1693.
63. Christ, M., Rubio de Francia, J.L.. Weak type (1,1) bounds for rough operators II, Invent.
Math. 93 (1988), no. 1, 225–237.
64. Chui, C. (ed.), Wavelets: A Tutorial in Theory and Applications, Academic Press, San Diego,
CA, 1992.
65. Coifman, R. R., Distribution function inequalities for singular integrals, Proc. Nat. Acad.
Sci. U.S.A. 69 (1972), 2838–2839.
66. Coifman, R. R., Fefferman, C., Weighted norm inequalities for maximal functions and sin-
gular integrals, Studia Math. 51 (1974), 241–250.
67. Coifman, R. R., Jones, P., Rubio de Francia, J. L., Constructive decomposition of BMO func-
tions and factorization of Ap weights, Proc. Amer. Math. Soc. 87 (1983), no. 4, 675–676.
68. Coifman, R. R., Rochberg, R., Another characterization of BMO, Proc. Amer. Math. Soc. 79
(1980), no. 2, 249–254.
69. Coifman, R. R., Rubio de Francia, J.-L., Semmes, S., Multiplicateurs de Fourier de Lp(R) et
estimations quadratiques, C. R. Acad. Sci. Paris S´er. I Math. 306 (1988), no. 8, 351–354.
70. Coifman, R. R., Weiss, G., Transference Methods in Analysis, Conference Board of the Math-
ematical Sciences Regional Conference Series in Mathematics, No. 31, American Mathemat-
ical Society, Providence, RI, 1976.
71. Coifman, R. R., Weiss, G., Book review of “Littlewood–Paley and multiplier theory”, Bull.
Amer. Math. Soc. 84 (1978), no. 2, 242–250.
72. Connett, W. C., Singular integrals near L1, Harmonic Analysis in Euclidean Spaces,
(Williams Coll., Williamstown, MA, 1978), Part 1, pp. 163–165, Proc. Sympos. Pure Math.,
XXXV, Part, Amer. Math. Soc., Providence, RI, 1979.

620
References
73. C´ordoba, A., Fefferman, R., A geometric proof of the strong maximal theorem, Ann. of Math.
(2nd Ser.) 102 (1975), no. 1, 95–100.
74. C´ordoba, A., Fefferman, C., A weighted norm inequality for singular integrals, Studia Math.
57 (1976), no. 1, 97–101.
75. Cotlar, M., A uniﬁed theory of Hilbert transforms and ergodic theorems, Rev. Mat. Cuyana,
1 (1955), 105–167.
76. Cowling, M., Mauceri, G., On maximal functions, Rend. Sem. Mat. Fis. Milano 49 (1979),
79–87.
77. Cruz-Uribe, D., New proofs of two-weight norm inequalities for the maximal operator, Geor-
gian Math. J. 7 (2000), no. 1, 33–42.
78. Cruz-Uribe, D., Martell, J. M., P´erez, C., Extrapolation results for A∞weights and applica-
tions, J. Funct. Anal. 213 (2004), no. 2, 412–439.
79. Cruz-Uribe, D., Martell, J. M., P´erez, C., Sharp weighted estimates for approximating dyadic
operators, Electron. Res. Announc. Math. Sci. 17 (2010), 12–19.
80. Cruz-Uribe, D., Martell, J. M., P´erez, C., Weights, extrapolation and the theory of Rubio de
Francia, Operator Theory: Advances and Applications, 215, Birkh¨auser/Springer Basel AG,
Basel, 2011.
81. Cruz-Uribe, D., Martell, J. M., P´erez, C., Sharp weighted estimates for classical operators,
Adv. Math. 229 (2012), no. 1, 408–441.
82. Cruz-Uribe, D., Neugebauer, C. J., The structure of the reverse H¨older classes, Trans. Amer.
Math. Soc. 347 (1995), no. 8, 2941–2960.
83. Cwikel, M., The dual of weak Lp, Ann. Inst. Fourier (Grenoble) 25 (1975), no. 2, 81–126.
84. Cwikel, M., Fefferman, C., Maximal seminorms on weak L1, Studia Math. 69 (1980/81), no.
2, 149–154.
85. Cwikel, M., Fefferman, C., The canonical seminorm on Weak L1, Studia Math. 78 (1984),
no. 3, 275–278.
86. Daly, J. E., A necessary condition for Calder´on–Zygmund singular integral operators, J.
Fourier Anal. Appl. 5 (1999), no. 4, 303–308.
87. Daly, J. E., Phillips, K., On the classiﬁcation of homogeneous multipliers bounded on
H1(R2), Proc. Amer. Math. Soc. 106 (1989), no. 3, 685–696.
88. Daubechies, I., Orthonormal bases of compactly supported wavelets, Comm. Pure Appl.
Math. 41 (1988), no. 7, 909–996.
89. Daubechies, I., Ten Lectures on Wavelets, CBMS-NSF Regional Conference Series in Ap-
plied Math, 61, Society for Industrial and Applied Mathematics (SIAM), Philadelphia, PA,
1992.
90. Davis, B., On the integrability of the martingale square function, Israel J. Math. 8 (1970),
187–190.
91. Davis, B., On the weak type (1,1) inequality for conjugate functions, Proc. Amer. Math. Soc.
44 (1974), 307–311.
92. de Guzm´an, M., Real Variable Methods in Fourier Analysis, North-Holland Mathematics
Studies, 46, Notas de Matem´atica (75), North-Holland Publishing Co., Amsterdam-New
York, 1981.
93. de Guzm´an, M., Differentiation of Integrals in Rn, Lecture Notes in Math. 481, Springer-
Verlag, Berlin-New York, 1975.
94. de Leeuw, K., On Lp multipliers, Ann. of Math. (2nd Ser.) 81 (1965), no. 2, 364–379.
95. Diestel, J., Uhl, J. J. Jr., Vector Measures, With a foreword by B. J. Pettis, Mathematical
Surveys, No. 15, American Mathematical Society, Providence, RI, 1977.
96. Dirichlet, P. G., Sur la convergence des s´eries trigonom´etriques qui servent `a repr´esenter une
fonction arbitraire entre des limites donn´ees, J. Reine und Angew. Math. 4 (1829), 157–169.
97. Doob, J. L., Stochastic Processes, John Wiley & Sons, Inc., New York; Chapman & Hall,
Limited, London, 1953.
98. Dragiˇcevi´c, O., Grafakos, L., C. Pereyra, and S. Petermichl, Extrapolation and sharp norm
estimates for classical operators on weighted Lebesgue spaces, Publ. Mat. 49 (2005), no. 1,
73–91.

References
621
99. Dunford, N., Schwartz, J. T., Linear Operators, I, General Theory, With the assistance of W.
G. Bade and R. G. Bartle, Pure and Applied Mathematics, Vol. 7, Interscience Publishers,
Inc., New York; Interscience Publishers, Ltd., London, 1958.
100. Duoandikoetxea, J., Fourier Analysis, Grad. Studies in Math. 29, American Mathematical
Society, Providence, RI, 2001.
101. Duoandikoetxea, J., Extrapolation of weights revisited: new proofs and sharp bounds, J.
Funct. Anal. 260 (2011), no. 6, 1886–1901.
102. Duoandikoetxea, J., Rubio de Francia, J.-L., Maximal and singular integral operators via
Fourier transform estimates, Invent. Math. 84 (1986), no. 3, 541–561.
103. Duoandikoetxea, J., Vega, L., Spherical means and weighted inequalities, J. London Math.
Soc. (2) 53 (1996), no. 2, 343–353.
104. Duong, X. T., McIntosh, A., Singular integral operators with non-smooth kernels on irregular
domains, Rev. Mat. Iberoamericana 15 (1999), no. 2, 233–265.
105. Dym, H., McKean, H. P., Fourier Series and Integrals, Probability and Mathematical Statis-
tics, No. 14, Academic Press, New York-London, 1972.
106. Edwards, R. E., Fourier Series: A Modern Introduction. Vol. 1, 2nd edition, Graduate Texts
in Mathematics, 64, Springer-Verlag, New York-Berlin, 1979.
107. Erd´elyi, A., Asymptotic Expansions, Dover Publications Inc., New York, 1956.
108. Ess´en, M., A superharmonic proof of the M. Riesz conjugate function theorem, Arkiv Math.
22 (1984), no. 2, 241–249.
109. Fan, D., Guo, K., Pan, Y., A note of a rough singular integral operator, Math. Inequal. and
Appl. 2 (1999), no. 1, 73–81.
110. Fan, D., Pan, Y., Singular integral operators with rough kernels supported by subvarieties,
Amer J. Math. 119 (1997), no. 4, 799–839.
111. Fan, K., Minimax theorems, Proc. Nat. Acad. Sci. U. S. A. 39 (1953), 42–47.
112. Fefferman, C., On the convergence of multiple Fourier series, Bull. Amer. Math. Soc. 77
(1971), 744–745.
113. Fefferman, C., The multiplier problem for the ball, Ann. of Math. (2nd Ser.) 94 (1971), no. 2,
330–336.
114. Fefferman, C., The uncertainty principle, Bull. Amer. Math. Soc. (N. S.) 9 (1983), no. 2,
129–206.
115. Fefferman, C., Stein, E. M., Some maximal inequalities, Amer. J. Math. 93 (1971), 107–115.
116. Fefferman, R., A theory of entropy in Fourier analysis, Adv. in Math. 30 (1978), no. 3,
171–201.
117. Fefferman, R., Strong differentiation with respect to measures, Amer J. Math. 103 (1981), no.
1, 33–40.
118. Folland, G. B., Sitaram, A., The uncertainty principle: a mathematical survey, J. Fourier
Anal. Appl. 3 (1997), no. 3, 207–238.
119. Fourier, J., Th´eorie Analytique de la Chaleur, Institut de France, Paris, 1822.
120. Frazier, M., An Introduction to Wavelets Through Linear Algebra, Undergraduate Texts in
Mathematics, Springer-Verlag, New York, 1999.
121. Garc´ıa-Cuerva, J., An extrapolation theorem in the theory of Ap weights, Proc. Amer. Math.
Soc. 87 (1983), no. 3, 422–426.
122. Garc´ıa-Cuerva, J., Rubio de Francia, J.-L., Weighted Norm Inequalities and Related Top-
ics, North-Holland Mathematics Studies, 116, Notas de Matem´atica (104), North-Holland
Publishing Co., Amsterdam, 1985.
123. Garnett, J., Jones, P., The distance in BMO to L∞, Ann. of Math. 108 (1978), no. 2, 373–393.
124. Garrig´os, G., Seeger, A., Characterizations of Hankel multipliers, Math. Ann. 342 (2008),
no. 1, 31–68.
125. Gehring, F. W., The Lp-integrability of the partial derivatives of a quasiconformal mapping,
Acta Math. 130 (1973), no. 1, 265–277.
126. Gelfand, I. M., ˇSilov, G. E., Generalized Functions, Vol. 1: Properties and Operations, Aca-
demic Press, New York-London, 1964.
127. Gelfand, I. M., ˇSilov, G. E., Generalized Functions, Vol. 2: Spaces of Fundamental and Gen-
eralized Functions, Academic Press, New York-London, 1968.

622
References
128. Gibbs, J. W., Fourier’s Series, Nature 59 (1899), 606.
129. Gohberg, I., Krupnik, N., Norm of the Hilbert transformation in the Lp space, Funct. Anal.
Appl. 2 (1968), 180–181.
130. Grafakos, L., Best bounds for the Hilbert transform on Lp(R1), Math. Res. Lett. 4 (1997), no.
4, 469–471.
131. Grafakos, L., Modern Fourier Analysis, 3rd edition, Graduate Texts in Math. 250, Springer,
New York, 2014.
132. Grafakos, L., Honz´ık, P., Ryabogin, D., On the p-independence property of Calder´on–
Zygmund theory, J. Reine Angew. Math. 602 (2007), 227–234.
133. Grafakos, L., Kalton, N., The Marcinkiewicz multiplier condition for bilinear operators, Stu-
dia Math. 146 (2001), no. 2, 115–156.
134. Grafakos, L., Kinnunen, J., Sharp inequalities for maximal functions associated to general
measures, Proc. Roy. Soc. Edinburgh Sect. A 128 (1998), no. 4, 717–723.
135. Grafakos, L., Martell, J. M., Extrapolation of weighted norm inequalities for multivariable
operators and applications J. Geom. Anal. 14 (2004), no. 1, 19–46.
136. Grafakos, L., Montgomery-Smith, S., Best constants for uncentred maximal functions, Bull.
London Math. Soc. 29 (1997), no. 1, 60–64.
137. Grafakos, L., Morpurgo, C., A Selberg integral formula and applications, Paciﬁc J. Math.
191 (1999), no. 1, 85–94.
138. Grafakos, L., Stefanov, A., Lp bounds for singular integrals and maximal singular integrals
with rough kernels, Indiana Univ. Math. J. 47 (1998), no. 2, 455–469.
139. Grafakos, L., Stefanov, A., Convolution Calder´on–Zygmund singular integral operators with
rough kernels, Analysis of Divergence (Orono, ME, 1997), pp. 119–143, Appl. Numer. Har-
mon. Anal., Birkh¨auser Boston, Boston, MA, 1999.
140. Gr¨ochenig, K., Foundations of Time-Frequency Analysis, Applied and Numerical Harmonic
Analysis Birkh¨auser Boston, Inc., Boston, MA, 2001.
141. Haagerup, U., The best constants in Khintchine’s inequality, Studia Math. 70 (1981), no. 3,
231–283.
142. Hahn, L.-S., On multipliers of p-integrable functions, Trans. Amer. Math. Soc. 128 (1967),
321–335.
143. Hardy, G. H., Theorems relating to the summability and convergence of slowly oscillating
series, Proc. London Math. Soc. (2) 8 (1910), no. 1, 301–320.
144. Hardy, G. H., Note on a theorem of Hilbert, Math. Z. 6 (1920), no. 3-4, 314–317.
145. Hardy, G. H., Note on some points in the integral calculus, LX. An inequality between inte-
grals, Messenger of Math. 54 (1925), 150–156.
146. Hardy, G. H., Littlewood, J. E., A maximal theorem with function-theoretic applications, Acta
Math. 54 (1930), no. 1, 81–116.
147. Hardy, G. H., Littlewood, J. E., Some more theorems concerning Fourier series and Fourier
power series, Duke Math. J. 2 (1936), no. 2, 354–381.
148. Hardy, G. H., Littlewood, J. E., P´olya, G., Inequalities, 2nd edition, Cambridge University
Press, Cambridge, 1952.
149. Helson, H., Szeg˝o, G., A problem in prediction theory, Ann. Mat. Pura Appl. (4) 51 (1960),
107–138.
150. Heo, Y., Nazarov, F., Seeger, A., Radial Fourier multipliers in high dimensions, Acta Math.
206 (2011), no. 1, 55–92.
151. H´ernandez, E., Weiss, G., A First Course on Wavelets (Studies in Advanced Mathematics),
CRC Press, Boca Raton, FL, 1996.
152. Hewitt, E., Ross, K., Abstract Harmonic Analysis, Vol I, 2nd edition, Grundlehren der math-
ematischen Wissenschaften, 115, Springer-Verlag, Berlin, New York, 1979.
153. Hewitt, E., Stromberg, K., Real and Abstract Analysis, Graduate Texts in Math. 25, Springer-
Verlag, New York, 1965.
154. Hirschman, I. I. Jr., A convexity theorem for certain groups of transformations, J. Analyse
Math. 2 (1953), 209–218.
155. Hofmann, S., Weak (1,1) boundedness of singular integrals with nonsmooth kernel, Proc.
Amer. Math. Soc. 103 (1988), no. 1, 260–264.

References
623
156. Hollenbeck, B., Verbitsky, I. E., Best constants for the Riesz projection, J. Funct. Anal. 175
(2000), no. 2, 370–392.
157. Honz´ık, P., An example of an unbounded maximal singular operator, J. Geom. Anal. 20
(2010), 153–167.
158. Honz´ık, P., On p dependent boundedness of singular integral operators, Math. Z. 267 (2011),
no. 3–4, 931–937.
159. H¨ormander, L., Estimates for translation invariant operators in Lp spaces, Acta Math. 104
(1960), no. 1–2, 93–140.
160. H¨ormander, L., The Analysis of Linear Partial Differential Operators I, 2nd edition, Springer-
Verlag, Berlin, 1990.
161. Hrusˇcev, S. V., A description of weights satisfying the A∞condition of Muckenhoupt, Proc.
Amer. Math. Soc. 90 (1984), no. 2, 253–257.
162. Hudson, S., A covering lemma for maximal operators with unbounded kernels, Michigan
Math. J. 34 (1987), no. 1, 147–151.
163. Hunt, R., An extension of the Marcinkiewicz interpolation theorem to Lorentz spaces, Bull.
Amer. Math. Soc. 70 (1964), 803–807.
164. Hunt, R., On L(p,q) spaces, Einseignement Math. (2) 12 (1966), 249–276.
165. Hunt, R., On the convergence of Fourier series, Orthogonal Expansions and Their Contin-
uous Analogues (Proc. Conf., Edwardsville, IL, 1967), pp. 235–255, Southern Illinois Univ.
Press, Carbondale IL, 1968.
166. Hunt, R., Kurtz, D., Neugebauer, C. J., A note on the equivalence of Ap and Sawyer’s condi-
tion for equal weights, Conference on Harmonic Analysis in Honor of Antoni Zygmund, Vol.
I, II (Chicago, IL, 1981), pp. 156–158, Wadsworth Math. Ser., Wadsworth, Belmont, CA,
1983.
167. Hunt, R., Muckenhoupt, B., Wheeden, R., Weighted norm inequalities for the conjugate func-
tion and the Hilbert transform, Trans. Amer. Math. Soc. 176 (1973), 227–251.
168. Hyt¨onen, T. P., The sharp weighted bound for general Calder´on-Zygmund operators, Ann. of
Math. (2nd Ser.) 175 (2012), no.3, 1473–1506.
169. Hyt¨onen, T. P., Lacey, M. T., P´erez, C., Sharp weighted bounds for the q-variation of singular
integrals, Bull. Lond. Math. Soc. 45 (2013), no. 3, 529–540.
170. Hyt¨onen, T. P., P´erez, C., Sharp weighted bounds involving A∞, Anal. PDE 6 (2013), no. 4,
777–818.
171. Igari, S., Lectures on Fourier Series of Several Variables, Univ. Wisconsin Lecture Notes,
Madison, WI, 1968.
172. Ionescu, A. D., An endpoint estimate for the Kunze-Stein phenomenon and related maximal
operators, Ann. Math. (2) 152 ( 2000), no. 1, 259–275.
173. Iosevich, A., Sawyer, E., Maximal averages over surfaces, Adv. Math. 132 (1997), no. 1,
46–119.
174. Ismagilov, R. S., On the Pauli problem, Funct. Anal. Appl. 30 (1996), no. 2, 138–140.
175. Iwaniec, T., Martin, G., Riesz transforms and related singular integrals, J. Reine Angew.
Math. 473 (1996), 25–57.
176. Jessen, B., Marcinkiewicz, J., Zygmund, A., Note on the differentiability of multiple integrals,
Fund. Math. 25 (1935), 217–234.
177. Jodeit, M. Jr., Restrictions and extensions of Fourier multipliers, Studia Math. 34 (1970),
215–226.
178. Jodeit, M., A note on Fourier multipliers, Proc. Amer. Math. Soc. 27 (1971), 423–424.
179. Jones, P., Factorization of Ap weights, Ann. of Math. (2nd Ser.) 111 (1980), no. 3, 511–530.
180. Jordan, C., Sur la s´erie de Fourier, Comptes Rendus Hebdomadaires des S´eances de l’
Acad´emie des Sciences 92 (1881), 228–230.
181. Journ´e, J.- L., Calder´on–Zygmund operators on product spaces, Rev. Mat. Iberoamericana 1
(1985), no. 3, 55–91.
182. Kahane, J.-P., The heritage of Fourier, Perspectives in Analysis, 83–95, Math. Phys. Stud.,
27, Springer, Berlin, 2005.
183. Kahane, J.-P., Katznelson, Y., Sur les ensembles de divergence des s´eries trigonom´etriques,
Studia Math. 26 (1966), 305–306.

624
References
184. Kaiser, G., A Friendly Guide to Wavelets, Birkh¨auser, Boston, MA, 1994.
185. Kalton, N. J., Convexity, type, and the three space problem, Studia Math. 69 (1980/81), no.
3, 247–287.
186. Kalton, N. J., Plurisubharmonic functions on quasi-Banach spaces, Studia Math. 84 (1986),
no. 3, 297–323.
187. Kalton, N. J., Analytic functions in non-locally convex spaces and applications, Studia Math.
83 (1986), no. 3, 275–303.
188. Kalton, N. J., Peck, N. T., Roberts, J. W., An F-space Sampler, London Mathematical Society
Lecture Notes Series, 89, Cambridge University Press, Cambridge, 1984.
189. Katznelson, Y., Sur les ensembles de divergence des s´eries trigonom´etriques, Studia Math.
26 (1966), 301–304.
190. Katznelson, Y., An Introduction to Harmonic Analysis, 2nd corrected edition, Dover Publi-
cations, Inc., New York, 1976.
191. Kendall, D. G., On the number of lattice points inside a random oval, Quart. J. Math., Oxford
Ser. 19 (1948), 1–26.
192. Kenig, C., Tomas, P. A., Maximal operators deﬁned by Fourier multipliers, Studia Math. 68
(1980), no. 1, 79–83.
193. Khintchine, A., ¨Uber dyadische Br¨uche, Math. Z. 18 (1923), no. 1, 109–116.
194. Kislyakov, S., Kruglyak, N., Extremal Problems in Interpolation Theory, Whitney–
Besicovitch Coverings, and Singular Integrals, Birkh¨user/Springer Basel AG, Basel, 2013.
195. Kolmogorov, A. N., Une s´erie de Fourier–Lebesgue divergente presque partout, Fund. Math.
4 (1923), 324–328.
196. Kolmogorov, A. N., Une contribution `a l’ ´etude de la convergence des s´eries de Fourier,
Fund. Math. 5 (1924), 96–97.
197. Kolmogorov, A. N., Sur les fonctions harmoniques conjugu´ees et les s´eries de Fourier, Fund.
Math. 7 (1925), 23–28.
198. Kolmogorov, A. N., Une s´erie de Fourier–Lebesgue divergente partout, C. R. Acad. Sci. Paris
183 (1926), 1327–1328.
199. Kolmogorov, A. N., Zur Normierbarkeit eines topologischen Raumes, Studia Math. 5 (1934),
29–33.
200. Konyagin, S. V., On the divergence everywhere of trigonometric Fourier series, Sb. Math.
191 (2000), no. 1–2, 97–120.
201. Korenovskyy, A. A., Lerner, A. K., Stokolos, A. M., A note on the Gurov–Reshetnyak condi-
tion, Math. Res. Lett. 9 (2002), no. 5–6, 579–583.
202. K¨orner, T. W., Fourier Analysis, Cambridge University Press, Cambridge, 1988.
203. Krantz, S. G., A panorama of Harmonic Analysis, Carus Mathematical Monographs, 27,
Mathematical Association of America, Washington, DC, 1999.
204. Krantz, S. G., Parks, H. R., The Geometry of Domains in Space, Birkh¨auser Advanced Texts:
Basler Lehrb¨ucher, Birkh¨auser Boston, Inc., Boston, MA, 1999.
205. Krantz, S. G., Parks, H. R., A Primer of Real Analytic Functions, 2nd edition, Birkh¨auser
Advanced Texts: Basler Lehrb¨ucher, Birkh¨auser Boston, Inc., Boston, MA, 2002.
206. Krivine, J. L., Th´eor`emes de factorisation dans les espaces r´eticul´es, S´eminaire Maurey-
Schwartz 1973–74: Espaces Lp, applications radoniﬁantes et g´eom´etrie des espaces de Ba-
nach, Exp. Nos. 22 et 23, Centre de Math., ´Ecole Polytech., Paris, 1974.
207. Kruglyak, N., An elementary proof of the real version of the Riesz-Thorin theorem, Inter-
polation Theory and Applications, pp. 179–182, Contemp. Math. 445, Amer. Math. Soc.,
Providence, RI, 2007.
208. Kurtz, D., Operator estimates using the sharp function, Paciﬁc J. Math. 139 (1989), no. 2,
267–277.
209. Kurtz, D., Wheeden, R., Results on weighted norm inequalities for multipliers, Trans. Amer.
Math. Soc. 255 (1979), 343–362.
210. Lacey, M. T., Petermichl, S., Reguera, M. C., Sharp A2 inequality for Haar shift operators,
Math. Ann. 348 (2010), no. 1, 127–141.
211. Laeng, E., On the Lp norms of the Hilbert transform of a characteristic function, J. Funct.
Anal. 262 (2012), no. 10, 4534–4539.

References
625
212. Landau, E., Zur analytischen Zahlentheorie der deﬁniten quadratischen Formen ( ¨Uber die
Gitterpunkte in einem mehrdimensionalen Ellipsoid), Berl. Sitzungsber. 31 (1915), 458–476;
reprinted in E. Landau “Collected Works,” Vol. 6, pp. 200–218, Thales-Verlag, Essen, 1986.
213. Lang, S., Real Analysis, 2nd edition, Addison-Wesley Publishing Company, Advanced Book
Program, Reading, MA, 1983.
214. Lebesgue, H., Int´egrale, longeur, aire, Annali Mat. Pura Appl. 7 (1902), 231–359.
215. Lebesgue, H., Oeuvres Scientiﬁques (en cinq volumes), Vol. I, (French) Sous la r´edaction de
F. Chˆatelet et G. Choquet, Institut de Math´ematiques de l’ Universit´e de Gen`eve, Geneva,
1972.
216. Lemari´e, P., Meyer, Y., Ondelettes et bases hilbertiennes, Rev. Mat. Iberoamericana 2 (1986),
no. 1–2, 1–18.
217. Lerner, A. K., On pointwise estimates for maximal and singular integral operators, Studia
Math. 138 (2000), no. 3, 285–291.
218. Lerner, A. K., An elementary approach to several results on the Hardy–Littlewood maximal
operator, Proc. Amer. Math. Soc., 136 (2008), no. 8, 2829–2833.
219. Lerner, A. K., A pointwise estimate for the local sharp maximal function with applications to
singular integrals, Bull. London Math. Soc. 42 (2010), no. 5, 843–856.
220. Lerner, A. K., On an estimate of Calder´on-Zygmund operators by dyadic positive operators,
J. Anal. Math. 121 (2013), 141–161.
221. Lerner, A. K., A simple proof of the A2 conjecture, Int. Math. Res. Not. IMRN 14 (2013),
3159–3170.
222. Lerner, A. K., Mixed Ap-Ar inequalities for classical singular integrals and Littlewood-Paley
operators, J. Geom. Anal. 23 (2013), no. 3, 1343–1354.
223. Lerner, A. K., Ombrosi, S., P´erez, C., A1 bounds for Calder´on–Zygmund operators related
to a problem of Muckenhoupt and Wheeden, Math. Res. Lett. 16 (2009), no. 1, 149–156.
224. Liang, Y. Y., Liu, L. G., Yang, D. C., An Off-diagonal Marcinkiewicz interpolation theorem
on Lorentz spaces, Acta Math. Sin. (Engl. Ser.) 27 (2011), no. 8, 1477–1488.
225. Lions, J.-L., Peetre, J., Sur une classe d’espaces d’ interpolation, Inst. Hautes ´Etudes Sci.
Publ. Math. No. 19 (1964), 5–68.
226. Littlewood, J. E., On a certain bilinear form, Quart. J. Math. Oxford Ser. 1 (1930), 164–174.
227. Littlewood, J. E., Paley, R. E. A. C., Theorems on Fourier series and power series, J. London
Math. Soc. 6 (1931), no. 3, 230–233.
228. Littlewood, J. E., Paley, R. E. A. C., Theorems on Fourier series and power series (II), Proc.
London Math. Soc. 42 (1936), no. 1, 52–89.
229. Littlewood, J. E., Paley, R. E. A. C., Theorems on Fourier series and power series (III), Proc.
London Math. Soc. 43 (1937), no. 2, 105–126.
230. Loomis, L. H., A note on the Hilbert transform, Bull. Amer. Math. Soc. 52 (1946),
1082–1086.
231. Loomis, L. H., Whitney, H., An inequality related to the isoperimetric inequality, Bull. Amer.
Math. Soc. 55 (1949), 961–962.
232. Lorentz, G. G., Some new function spaces, Ann. of Math. (2nd Ser.) 51 (1950), no. 1, 37–55.
233. Lorentz, G. G., On the theory of spaces Λ, Paciﬁc. J. Math. 1 (1951), 411–429.
234. Lu, S., Ding, Y., Yan, D., Singular Integrals and Related Topics, World Scientiﬁc Publishing
Co. Pte. Ltd., Hackensack, NJ, 2007.
235. Luzin, N., Sur la convergence des s´eries trigonom´etriques de Fourier, C. R. Acad. Sci. Paris
156 (1913), 1655–1658.
236. Lyapunov, A., Sur les fonctions-vecteurs compl`etement additives [Russian], Izv. Akad. Nauk
SSSR Ser. Mat. 4 (1940), 465–478.
237. Magyar, A., Stein, E. M., Wainger, S., Discrete analogues in harmonic analysis: spherical
averages, Ann. of Math. (2nd Ser.) 155 (2002), no. 1, 189–208.
238. Mallat, S., Multiresolution approximations and wavelet orthonormal bases of L2(R), Trans.
Amer. Math. Soc. 315 (1989), no. 1, 69–87.
239. Mallat, S., A Wavelet Tour of Signal Processing, Academic Press, Inc., San Diego, CA, 1998.
240. Marcinkiewicz, J., Sur l’interpolation d’operations, C. R. Acad. Sci. Paris 208 (1939),
1272–1273.

626
References
241. Marcinkiewicz, J., Sur les multiplicateurs des s´eries de Fourier, Studia Math. 8 (1939),
78–91.
242. Marcinkiewicz, J., Zygmund, A., Quelques in´egalit´es pour les op´erations lin´eaires, Fund.
Math. 32 (1939), 112–121.
243. Marcinkiewicz, J., Zygmund, A., On the summability of double Fourier series, Fund. Math.
32 (1939), 122–132.
244. Mateu, J., Orobitg, J., Verdera, J., Estimates for the maximal singular integral in terms of
the singular integral: the case of even kernels, Ann. of Math. (2nd Ser.) 174 (2011), no. 3,
1429–1483.
245. Mateu, J., Verdera, J., Lp and weak L1 estimates for the maximal Riesz transform and the
maximal Beurling transform, Math. Res. Lett. 13 (2006), no. 5–6, 957–966.
246. Mattila, P., Geometry of sets and measures in Euclidean spaces. Fractals and rectiﬁability,
Cambridge Studies in Advanced Mathematics, 44, Cambridge University Press, Cambridge,
1995.
247. Maurey, B., Th´eor`emes de factorization pour les op´erateurs lin´eaires `a valeurs dans les es-
pace Lp, Ast´erisque, No. 11, Soci´et´e Math´ematique de France, Paris, 1974.
248. Melas, A., The best constant for the centered Hardy–Littlewood maximal inequality, Ann. of
Math. (2nd Ser.) 157 (2003), no. 2, 647–688.
249. Meyer, Y., Principe d’ incertitude, bases hilbertiennes et alg`ebres d’ op´erateurs, S´eminaire
Bourbaki, Vol. 1985/86, Ast´erisque No. 145-146 (1987) 4, 209–223.
250. Meyer, Y., Ondelettes et Op´erateurs, I, Ondelletes, Hermann, Paris, 1990.
251. Meyer, Y., Ondelettes et Op´erateurs, II, Op´erateurs de Calder´on-Zygmund, Hermann, Paris,
1990.
252. Meyer, Y., Wavelets, Vibrations, and Scalings, CRM Monograph Series, 9, American Math-
ematical Society, Providence, RI, 1998.
253. Meyer, Y., Coifman, R. R., Ondelettes et Op´erateurs, III, Op´erateurs multilin´eaires , Her-
mann, Paris, 1991.
254. Mihlin, S. G., On the multipliers of Fourier integrals [Russian], Dokl. Akad. Nauk. SSSR
(N.S.) 109 (1956), 701–703.
255. Miyachi, A., On some singular Fourier multipliers, J. Fac. Sci. Univ. Tokyo Sect. IA Math.
28 (1981), no. 2, 267–315.
256. Mockenhaupt, G., Seeger, A., Sogge, C., Wave front sets, local smoothing and Bourgain’s
circular maximal theorem, Ann. of Math. (2nd Ser.) 136 (1992), no. 1, 207–218.
257. Moon, K. H., On restricted weak type (1,1), Proc. Amer. Math. Soc. 42 (1974), 148–152.
258. Morse, A. P., Perfect blankets, Trans. Amer. Math. Soc. 69 (1947), 418–442.
259. Muckenhoupt, B., On certain singular integrals, Paciﬁc J. Math. 10 (1960), 239–261.
260. Muckenhoupt, B., Weighted norm inequalities for the Hardy maximal function, Trans. Amer.
Math. Soc. 165 (1972), 207–226.
261. Muckenhoupt, B., The equivalence of two conditions for weight functions, Studia Math. 49
(1973/1974), 101–106.
262. Muckenhoupt, B., Wheeden, R. L., Two weight function norm inequalities for the Hardy–
Littlewood maximal function and the Hilbert transform, Studia Math. 55 (1976), no. 3,
279–294.
263. M¨uller, D., A geometric bound for maximal functions associated to convex bodies, Paciﬁc J.
Math. 142 (1990), no. 2, 297–312.
264. Nagel, A., Stein, E. M., Wainger, S., Differentiation in lacunary directions, Proc. Nat. Acad.
Sci. U.S.A. 75 (1978), no. 3, 1060–1062.
265. Nazarov, F., Reznikov, A., Vasyunin, V., Volberg, A., A1 conjecture: weak norm estimates of
weighted singular integrals and Bellman functions, http://sashavolberg.wordpress.com
266. Nazarov, F., Treil, S., Volberg, A., The Bellman functions and two-weight inequalities for
Haar multipliers, J. Amer. Math. Soc. 12 (1999), no. 4, 909–928.
267. Nazarov, F., Treil, S., Volberg, A., Bellman function in stochastic control and harmonic anal-
ysis, Systems, Approximation, Singular Integral Operators, and Related Topics (Bordeaux,
2000), pp. 393–423, Oper. Theory Adv. Appl. 129, Birkh¨auser, Basel, 2001.

References
627
268. Nazarov, F., Treil, S., Volberg, A., Two weight inequalities for individual Haar multipliers
and other well localized operators, Math. Res. Lett. 15 (2008), no. 3, 583–597.
269. Nguyen, H. V., A maximal Fourier integral operator and an application, J. of Pseudodiffen-
tial Operators 4 (2013), 443–456.
270. Nyquist, H., Certain topics in telegraph transmission theory, Trans. AIEE 47 (Apr. 1928),
617–64.
271. Olver, F. W. J., Asymptotics and Special Functions, Academic Press, New York, London,
1974.
272. Orobitg, J., P´erez, C., Ap weights for nondoubling measures in Rn and applications, Trans.
Amer. Math. Soc. 354 (2002), no. 5, 2013–2033 (electronic).
273. Paley, R. E. A. C., A remarkable series of orthogonal functions (II), Proc. London Math. Soc.
34 (1932), 241–264.
274. Paley, R. E. A. C., Zygmund, A., On some series of functions, Proc. Cambridge Phil. Soc. 26
(1930), 337–357.
275. Peetre, J., Nouvelles propri´et´es d’ espaces d’ interpolation, C. R. Acad. Sci. Paris 256 (1963),
1424–1426.
276. Pereyra, M. C., Lecture Notes on Dyadic Harmonic Analysis, Second Summer School in
Analysis and Mathematical Physics (Cuernavaca, 2000), pp. 1–60, Contemp. Math., 289,
American Mathematical Society, Providence, RI, 2001.
277. P´erez, C., Weighted norm inequalities for singular integral operators, J. London Math. Soc.
(2) 49 (1994), no. 2, 296–308.
278. P´erez, C., Some topics from Calder´on–Zygmund theory related to Poincar´e-Sobolev inequal-
ities, fractional integrals and singular integral operators, Function Spaces Lectures, Spring
School in Analysis, pp. 31–94, Jaroslav Lukeˇs and Luboˇs Pick (eds.), Paseky, 1999.
279. Petermichl, S., The sharp bound for the Hilbert transform on weighted Lebesgue spaces in
terms of the classical Ap characteristic, Amer. J. Math. 129 (2007), no. 5, 1355–1375.
280. Petermichl, S., The sharp weighted bound for the Riesz transforms, Proc. Amer. Math. Soc.
136 (2008), no. 4, 1237–1249.
281. Petermichl, S., Volberg, A., Heating of the Ahlfors-Beurling operator: weakly quasiregular
maps on the plane are quasiregular, Duke Math. J. 112 (2002), no. 2, 281–305.
282. Pichorides, S., On the best values of the constants in the theorems of M. Riesz, Zygmund and
Kolmogorov, Studia Math. 44 (1972), 165–179.
283. Pinsky, M., Introduction to Fourier Analysis and Wavelets, Graduate Studies in Mathematics
102, American Mathematical Society, Providence, RI, 2009.
284. Pinsky, M., Stanton, N. K., Trapa, P. E., Fourier series of radial functions in several variables,
J. Funct. Anal. 116 (1993), no. 1, 111–132.
285. Plancherel, M., P´olya, G., Fonctions enti`eres et int´egrales de fourier multiples, Comment.
Math. Helv. 10 (1937), no. 1, 110–163.
286. Reed, M., Simon, B., Methods of Modern Mathematical Physics, II, Fourier analysis, self-
adjointness, Academic Press, New York, London, 1975.
287. Reguera, M. C., On Muckenhoupt-Wheeden conjecture, Adv. Math. 227 (2011), no. 4, 1436–
1450.
288. Reguera, M., C., Thiele, C., The Hilbert transform does not map L1(Mw) to L1,∞(w), Math.
Res. Lett. 19 (2012), no. 1, 1–7.
289. Ricci, F., Weiss, G., A characterization of H1(Σn−1), Harmonic Analysis in Euclidean Spaces
Proc. Sympos. Pure Math. (Williams Coll., Williamstown, MA, 1978), Part 1, pp. 289–294,
Amer. Math. Soc., Providence, RI, 1979.
290. Riesz, F., Untersuchungen ¨uber Systeme integrierbarer Funktionen, Math. Ann. 69 (1910),
no. 4, 449–497.
291. Riesz, F., Sur un th´eor`eme du maximum de Mm. Hardy et Littlewood, J. London Math. Soc.
7 (1932), 10–13.
292. Riesz, M., Les fonctions conjugu´ees et les s´eries de Fourier, C. R. Acad. Sci. Paris 178 (1924),
1464–1467.
293. Riesz, M., Sur les maxima des formes bilin´eaires et sur les fonctionnelles lin´eaires, Acta
Math. 49 (1927), no. 3-4, 465–497.

628
References
294. Riesz, M., Sur les fonctions conjugu´ees, Math. Z. 27 (1928), no. 1, 218–244.
295. Riesz, M., L’int´egrale de Riemann–Liouville et le probl`eme de Cauchy, Acta Math. 81 (1949),
no. 1, 1–223.
296. Riviere, N., Singular integrals and multiplier operators, Ark. Mat. 9 (1971), 243–278.
297. Rolewicz, S., Metric Linear Spaces, 2nd edition, Mathematics and its Applications (East Eu-
ropean Series), 20. D. Reidel Publishing Co., Dordrecht; PWN–Polish Scientiﬁc Publishers,
Warsaw, 1985.
298. Rosenblum, M., Summability of Fourier series in Lp(dμ), Trans. Amer. Math. Soc. 105
(1962), 32–42.
299. Rubio de Francia, J.-L., Weighted norm inequalities and vector valued inequalities, Harmonic
Analysis (Minneapolis, MN, 1981), pp. 86–101, Lect. Notes in Math. 908, Springer, Berlin,
New York, 1982.
300. Rubio de Francia, J.-L., Factorization theory and Ap weights, Amer. J. Math. 106 (1984), no.
3, 533–547.
301. Rubio de Francia, J.-L., A Littlewood–Paley inequality for arbitrary intervals, Rev. Mat.
Iberoamericana 1 (1985), no. 2, 1–14.
302. Rubio de Francia, J.-L., Maximal functions and Fourier transforms, Duke Math. J. 53 (1986),
no. 2, 395–404.
303. Rubio de Francia, J.-L., Ruiz, F. J., Torrea, J. L., Calder´on–Zygmund theory for operator-
valued kernels, Adv. in Math. 62 (1986), no. 1, 7–48.
304. Rubio de Francia, J.-L., Torrea, J. L., Vector extensions of operators in Lp spaces, Paciﬁc J.
Math. 105 (1983), no. 1, 227–235.
305. Rudin, W., Trigonometric series with gaps, J. Math. Mech. 9 (1960), 203–227.
306. Rudin, W., Functional Analysis, Tata McGraw-Hill Publishing Company, New Delhi, 1973.
307. Rudin, W., Real and Complex Analysis, 2nd edition, Tata McGraw-Hill Publishing Company,
New Delhi, 1974.
308. Ryabogin, D., Rubin, B., Singular integrals generated by zonal measures, Proc. Amer. Math.
Soc. 130 (2002), no. 3, 745–751.
309. Sadosky, C., Interpolation of Operators and Singular Integrals, Marcel Dekker Inc., New
York, 1979.
310. Saks, S., Theory of the Integral, Hafner Publ. Co, New York, 1938.
311. Sato, S., Note on a Littlewood–Paley operator in higher dimensions, J. London Math. Soc.
(2) 42 (1990), no. 3, 527–534.
312. Sawyer, E., A characterization of a two-weight norm inequality for maximal operators, Studia
Math. 75 (1982), no. 1, 1–11.
313. Schlag, W., A geometric proof of the circular maximal theorem, Duke Math. J. 93 (1998), no.
3, 505–533.
314. Schwartz, L., Th´eorie de Distributions. Tome I, Hermann & Cie, Paris, 1950.
315. Schwartz, L., Th´eorie de Distributions. Tome II, Hermann & Cie, Paris, 1951.
316. Seeger, A., Some inequalities for singular convolution operators in Lp-spaces, Trans. Amer.
Math. Soc. 308 (1988), no. 1, 259–272.
317. Seeger, A., Singular integral operators with rough convolution kernels, J. Amer. Math. Soc.
9 (1996), no. 1, 95–105.
318. Seeger, A., Tao, T., Sharp Lorentz estimates for rough operators, Math. Ann. 320 (2001), no.
2, 381–415.
319. Shannon, C. E., Communication in the presence of noise, Proc. I.R.E. 37 (1949), 10–21.
320. Shapiro, V. L., Fourier series in several variables, Bull. Amer. Math. Soc. 70 (1964), 48–93.
321. Shapiro, V. L., Fourier series in several variables with applications to partial differential
equations, Chapman & Hall/CRC Applied Mathematics and Nonlinear Science Series, CRC
Press, Boca Raton, FL, 2011.
322. Siegel, A., Historical review of the isoperimetric theorem in 2-D, and its place in elementary
plane geometry, http://www.cs.nyu.edu/faculty/siegel/SCIAM.pdf
323. Sj¨ogren, P., A remark on the maximal function for measures in Rn, Amer. J. Math. 105 (1983),
no. 5, 1231–1233

References
629
324. Sj¨ogren, P., Soria, F., Rough maximal operators and rough singular integral operators ap-
plied to integrable radial functions, Rev. Math. Iberoamericana 13 (1997), no. 1, 1–18.
325. Sj¨olin, P., Convergence almost everywhere of certain singular integrals and multiple Fourier
series, Ark. Math. 9 (1971), 65–90.
326. Sj¨olin, P., A note on Littlewood–Paley decompositions with arbitrary intervals, J. Approx.
Theory 48 (1986), no. 3, 328–334.
327. Sj¨olin, P., Soria, F., Remarks on a theorem by N. Yu. Antonov, Studia Math. 158 (2003), no.
1, 79–97.
328. Sogge, C., Fourier Integrals in Classical Analysis, Cambridge Tracts in Mathematics, 105,
Cambridge University Press, Cambridge, 1993.
329. Soria, F., A note on a Littlewood–Paley inequality for arbitrary intervals in R2, J. London
Math. Soc. (2) 36 (1987), no. 1, 137–142.
330. Soria, F., On an extrapolation theorem of Carleson-Sj¨olin with applications to a.e. conver-
gence of Fourier series, Studia Math. 94 (1989), no. 3, 235–244.
331. Stein, E. M., Interpolation of linear operators, Trans. Amer. Math. Soc. 83 (1956), 482–492.
332. Stein, E. M., Note on singular integrals, Proc. Amer. Math. Soc. 8 (1957), 250–254.
333. Stein, E. M., Localization and summability of multiple Fourier series, Acta Math. 100 (1958),
no. 1–2, 93–147.
334. Stein, E. M., On the functions of Littlewood–Paley, Lusin, and Marcinkiewicz, Trans. Amer.
Math. Soc. 88 (1958), 430–466.
335. Stein, E. M., On limits of sequences of operators, Ann. of Math. (2nd Ser.) 74 (1961), no. 1,
140–170.
336. Stein, E. M., Note on the class LlogL, Studia Math. 32 (1969), 305–310.
337. Stein, E. M., Topics in Harmonic Analysis Related to the Littlewood–Paley Theory, Annals
of Mathematics Studies, No. 63, Princeton University Press, Princeton, NJ, 1970.
338. Stein, E. M., Singular Integrals and Differentiability Properties of Functions, Princeton
Mathematical Series, No. 30, Princeton University Press, Princeton, NJ, 1970.
339. Stein, E. M., Maximal functions I: Spherical means, Proc. Nat. Acad. Sci. U.S.A. 73 (1976),
no. 7, 2174–2175.
340. Stein, E. M., The development of square functions in the work of A. Zygmund, Bull. Amer.
Math. Soc. (N.S.) 7 (1982), no. 2, 359–376.
341. Stein, E. M., Some results in harmonic analysis in Rn, for n →∞, Bull. Amer. Math. Soc.
(N.S.) 9 (1983), no. 1, 71–73.
342. Stein, E. M., Boundary behavior of harmonic functions on symmetric spaces: Maximal esti-
mates for Poisson integrals, Invent. Math. 74 (1983), no. 1, 63–83.
343. Stein, E. M., Oscillatory integrals in Fourier analysis, Beijing Lectures in Harmonic Analysis
(Beijing, 1984), pp. 307–355, Annals of Math. Studies 112, Princeton Univ. Press, Princeton,
NJ, 1986.
344. Stein, E. M., Harmonic Analysis, Real Variable Methods, Orthogonality, and Oscillatory In-
tegrals, Princeton Mathematical Series, 43, Monographs in Harmonic Analysis, III, Princeton
University Press, Princeton, NJ, 1993.
345. Stein, E. M., Str¨omberg, J.-O., Behavior of maximal functions in Rn for large n, Ark. Math.
21 (1983), no. 2, 259–269.
346. Stein, E. M., Weiss, G., Interpolation of operators with change of measures, Trans. Amer.
Math. Soc. 87 (1958), 159–172.
347. Stein, E. M., Weiss, G., An extension of theorem of Marcinkiewicz and some of its applica-
tions, J. Math. Mech. 8 (1959), 263–284.
348. Stein, E. M., Weiss, G., Introduction to Fourier Analysis on Euclidean Spaces, Princeton
Mathematical Series, No. 32, Princeton University Press, Princeton, NJ, 1971.
349. Stein, E. M., Weiss, N. J., On the convergence of Poisson integrals, Trans. Amer. Math. Soc.
140 (1969), 34–54.
350. Stein, P., On a theorem of M. Riesz, J. London Math. Soc. 8 (1933), no. 4, 242–247.
351. Stepanov, V. D., Convolution integral operators [Russian], Dokl. Akad. Nauk SSSR 243
(1978), no. 1, 45–48.

630
References
352. Str¨omberg, J.-O., A modiﬁed Franklin system and higher-order spline systems on Rn as un-
conditional bases for Hardy spaces, Conference on Harmonic Analysis in Honor of Antoni
Zygmund, Vol. I, II (Chicago, IL, 1981), pp. 475–494, Wadsworth Math. Ser., Wadsworth,
Belmont, CA, 1983.
353. Szarek, S. J., On the best constant in the Khinchin inequality, Studia Math. 58 (1976), no. 2,
197–208.
354. Tamarkin, J. D., Zygmund, A., Proof of a theorem of Thorin, Bull. Amer. Math. Soc. 50
(1944), 279–282.
355. Tao, T., The weak type (1,1) of LlogL homogeneous convolution operators, Indiana Univ.
Math. J. 48 (1999), no. 4, 1547–1584.
356. Tao, T., A converse extrapolation theorem for translation-invariant operators, J. Funct. Anal.
180 (2001), no. 1, 1–10.
357. Tao, T., Wright, J., Endpoint multiplier theorems of Marcinkiewicz type, Rev. Mat. Iberoamer-
icana 17 (2001), no. 3, 521–558.
358. Tauber, A., Ein Satz aus der Theorie der unendlichen Reihen Monatsh. Math. Phys. 8 (1897),
no. 1, 273–277.
359. Tevzadze, N. R., The convergence of the double Fourier series of quadratic at a square
summable function, Sakharth. SSR Mecn. Akad. Moambe 58 (1970), 277–279.
360. Thorin, G. O., An extension of a convexity theorem due to M. Riesz, Fys. S¨aellsk. F¨orh. 8
(1938), No. 14.
361. Thorin, G. O., Convexity theorems generalizing those of M. Riesz and Hadamard with some
applications, Comm. Sem. Math. Univ. Lund [Medd. Lunds Univ. Mat. Sem.] 9 (1948), 1–58.
362. Titchmarsh, E. C., The Theory of the Riemann Zeta Function, Oxford, at the Clarendon Press,
1951.
363. Torchinsky, A., Real-Variable Methods in Harmonic Analysis, Pure and Applied Mathemat-
ics, 123, Academic Press, Inc., Orlando, FL, 1986.
364. van der Corput, J. G., Zahlentheoretische Absch¨atzungen, Math. Ann. 84 (1921), no. 1–2,
53–79.
365. Vargas, A., On the maximal function for rotation invariant measures in Rn, Studia Math. 110
(1994), no. 1, 9–17.
366. Verbitsky, I. E., Estimate of the norm of a function in a Hardy space in terms of the norms of
its real and imaginary part, Amer. Math. Soc. Transl. 124 (1984), 11–15.
367. Verbitsky, I. E., Weighted norm inequalities for maximal operators and Pisier’s theorem on
factorization through Lp∞, Integral Equations Operator Theory 15 (1992), no. 1, 124–153.
368. Vitali, G., Sui gruppi di punti e sulle funzioni di variabili reali, Atti Accad. Sci. Torino 43
(1908), 229–246.
369. Von Neuman, J., Zur Theorie des Gesellschaftsspiele, Math. Ann. 100 (1928), 295–320.
370. Wainger, S., Special trigonometric series in k dimensions, Mem. Amer. Math. Soc. 59, 1965.
371. Watson, G. N., A Treatise on the Theory of Bessel Functions, Cambridge University Press,
Cambridge, England, The Macmillan Company, New York, 1944.
372. Weiss, M., Zygmund, A., An example in the theory of singular integrals, Studia Math. 26
(1965), 101–111.
373. Whitney, H., Analytic extensions of differentiable functions deﬁned in closed sets, Trans.
Amer. Math. Soc. 36 (1934), no. 1, 63–89.
374. Wickerhauser, M. V., Adapted Wavelet Analysis from Theory to Software, A. K. Peters, Ltd.,
Wellesley, MA, 1994.
375. Wiener, N., The ergodic theorem, Duke Math. J. 5 (1939), no. 1, 1–18.
376. Wilbraham, H., On a certain periodic function, The Cambridge and Dublin Mathematical
Journal, 3 (1848), 198–201.
377. Wilson, J. M., Weighted norm inequalities for the continuous square function, Trans. Amer.
Math. Soc. 314 (1989), no. 2, 661–692.
378. Wilson, M., Weighted Littlewood–Paley Theory and Exponential-Square Integrability, Lec-
ture Notes in Mathematics, 1924 Springer, Berlin, 2008.
379. Wojtaszczyk, P., A Mathematical Introduction to Wavelets, London Mathematical Society
Student Texts 37, Cambridge University Press, Cambridge, 1997.

References
631
380. Yano, S., Notes on Fourier analysis, XXIX, An extrapolation theorem, J. Math. Soc. Japan 3
(1951), 296–305.
381. Yanushauskas, A. I., Multiple trigonometric series [Russian], ”Nauka” Sibirsk. Otdel.,
Novosibirsk, 1986.
382. Yosida, K., Functional Analysis, Reprint of the 6th edition (1980), Classics in Mathematics
Springer-Verlag, Berlin, 1995.
383. Zhizhiashvili, L. V., Some problems in the theory of simple and multiple trigonometric and
orthogonal series, Russian Math. Surveys, 28 (1973), 65–127.
384. Zhizhiashvili, L. V., Trigonometric Fourier Series and Their Conjugates, Mathematics and
Its Applications, 372, Kluwer Academic Publishers Group, Dordrecht,1996.
385. Ziemer, W. P., Weakly Differentiable Functions, Sobolev Spaces and Functions of Bounded
Variation, Graduate Texts in Mathematics, 120, Springer-Verlag, New York, 1989.
386. Zo, F., A note on approximation of the identity, Studia Math. 55 (1976), no. 2, 111–122.
387. Zygmund, A., On a theorem of Marcinkiewicz concerning interpolation of operators, J. Math.
Pures Appl. (9) 35 (1956), 223–248.
388. Zygmund, A., Trigonometric Series, Vol. I, 2nd edition, Cambridge University Press, New
York, 1959.
389. Zygmund, A., Trigonometric Series, Vol. II, 2nd edition, Cambridge University Press, New
York, 1959.
390. Zygmund, A., Notes on the history of Fourier series, Studies in harmonic analysis, (Proc.
Conf. DePaul Univ., Chicago, IL, 1974) pp. 1–19, MAA Stud. Math., Vol. 13, Math. Assoc.
Amer., Washington, DC, 1976.

Index
C k functions on the torus, 175
σ-ﬁnite, 2
absolutely summable Fourier series, 200
adjoint of an operator, 150
admissible growth, 40
almost everywhere convergence, 285
almost orthogonality, 459, 471
analytic family of operators, 40
Aoki–Rolewicz theorem, 76
A1 condition, 502
Ap condition, 503
necessity of, 543
approximate identity, 26
asymptotics
of Bessel function, 580
asymptotics of gamma function, 567
atom
in a measure space, 56
bad function, 356
Banach–Alaoglou theorem, 601
Banach-valued extension of a linear operator,
391
Banach-valued extension of an operator, 396
Banach-valued measurable function, 392
Banach-valued singular integral, 402
band limited function, 490
Bernoulli polynomials, 299
Bernstein’s inequality, 133
Bernstein’s theorem, 191
Bessel function, 168, 573
asymptotics, 580
large arguments, 579
small arguments, 578
beta function, 564
beta integral identity, 145
Boas and Bochner inequality, 391
Bochner integral, 394
Bochner–Riesz means, 244
Bochner–Riesz operator, 244
Borel measures, 2
bounded variation, 199
BV, functions of bounded variation, 199
Calder´on–Zygmund operator, 532
Calder´on–Zygmund decomposition, 356
Calder´on–Zygmund decomposition on Lq, 373
Calder´on–Zygmund operator
maximal, 533
cancellation condition
for a kernel, 375
Carleson operator, 286
Cauchy sequence in measure, 9
centered Hardy–Littlewood maximal function,
86
centered maximal function with respect to
cubes, 99
Ces`aro means, 184, 216
characteristic constant of a pair of weights, 524
Characteristic constant of a weight
Ap, 503
characteristic constant of a weight
A1, 503
characterization
of A1 weights, 519
of A∞weights, 527, 531
Chebyshev’s inequality, 6
circular Dirichlet kernel, 178
circular means, 250
circular partial sum, 184
class (Ap,Ap), 524
class of A1 weights, 502
class of Ap weights, 503
L. Grafakos, Classical Fourier Analysis, Graduate Texts in Mathematics 249,
DOI 10.1007/978-1-4939-1194-3, © Springer Science+Business Media New York 2014
633

634
Index
closed
under translations, 146
closed graph theorem, 602
commutes with translations, 146
compactly supported distribution, 120
complete orthonormal system, 185
completeness
of Lorentz spaces, 54
completeness of Lp, p < 1, 13
conditional expectation, 464
cone multiplier, 158
conjugate function, 245
conjugate harmonic, 318
conjugate harmonic functions, 253
conjugate Poisson kernel, 253, 318, 331
continuously differentiable function
of order N, 104
continuously differentiable functions
on the torus, 175
convergence
in C ∞
0 , 119
in S , 106, 119
in Lp, 7
in C ∞, 119
in measure, 6
in weak Lp, 7
convex sequence, 193
convolution, 20, 125
Cotlar’s inequality, 364
countably simple, 56
countably simple function, 2
countably subadditive operator, 47
covering lemma, 88
critical Bochner–Riesz index, 252
critical point, 162
Darboux’s equation, 476
de la Vall´ee Poussin kernel, 182
decay of Fourier coefﬁcients, 193
decomposition of open sets, 609
decreasing rearrangement, 48
of a simple function, 49
degree of a trigonometric polynomial, 177
deLeeuw’s theorem, 157
derivative
of a distribution, 123
of a function (partial), 104
differentiation
of approximate identities, 96
theory, 93
dilation
L1 dilation, 90
of a function, 109
of a tempered distribution, 124
Dini condition, 384
Dini’s theorem, 212
Dirac mass, 121
directional Hilbert transform, 339
Dirichlet kernel, 178
Dirichlet problem, 92
on the sphere, 144
distribution, 120
homogeneous, 132, 136
of lattice points, 305
supported at a point, 134
tempered, 120
with compact support, 120, 129
distribution function, 3
of a simple function, 4
distributional derivative, 123
divergence
of Bochner–Riesz means at the critical
index, 261
of the Fourier series of a continuous
function, 210
of the Fourier series of an L1 function, 255
doubling condition
on a measure, 98
doubling measure, 98, 505
doubly truncated kernel, 363
doubly truncated singular integrals, 363
duals of Lorentz spaces, 57
duBois Reymond’s theorem, 210
duplication formula
for the gamma function, 570
dyadic cube, 464
dyadic decomposition, 428
dyadic interval, 464
dyadic martingale difference operator, 465
dyadic martingale square function, 469
dyadic maximal function, 103
dyadic spherical maximal function, 461
eigenvalues
of the Fourier transform, 116
equidistributed, 48
equidistributed sequence, 302
essential inﬁmum, 502
Euler’s constant, 569
Euler’s limit formula for the gamma function,
568
inﬁnite product form, 569
expectation
conditional, 464
extrapolation, 47
extrapolation theorem, 548, 553
factorization of Ap weights, 546
Fej´er kernel, 27, 180

Index
635
Fej´er means, 184
Fej´er’s theorem, 205
ﬁnite Borel measure, 2
ﬁnitely simple function, 2
Fourier coefﬁcient, 175
of a measure, 175
Fourier inversion, 112, 185
on L1, 117
on L2, 114
Fourier multiplier, 155
Fourier series, 176
Fourier transform
of a radial function, 577
of a Schwartz function, 108
of surface measure, 577
on L1, 113
on L2, 113
on Lp, 1 < p < 2, 114
properties of, 109
Fr´echet space, 106
frame
tight, 496
Fresnel integral, 145
fundamental solution, 135
fundamental theorem of algebra, 143
g-function, 461, 477
gamma function, 563
asymptotics, 567
duplication formula, 570
meromorphic extension, 566
generalized Cauchy-Riemann equations, 332
good function, 356, 372
good lambda inequality, 533
consequences of, 539
gradient, 104
gradient condition
for a kernel, 359
Green’s identity, 135
H¨older condition, 384
H¨older’s inequality, 3, 11
for weak spaces, 16
H¨ormander’s condition, 359
H¨ormander–Mihlin multiplier theorem, 446
Haar function, 465
Haar measure, 18
Haar wavelet, 483
Hadamard’s three lines lemma, 39
Hahn–Banach theorem, 601
Hardy’s inequalities, 31
Hardy–Littlewood maximal function
centered, 86
uncentered, 87
harmonic distribution, 135
harmonic function, 92
Hausdorff–Young, 191
Hausdorff–Young inequality, 114
heat equation, 295
heat kernel, 296
Heisenberg group, 19
Hilbert transform, 314
maximal, 322, 339
maximal directional, 339
truncated, 314
Hirschman’s lemma, 41
homogeneous distribution, 132, 136
homogeneous Lipschitz functions, 195
homogeneous maximal singular integrals, 333
homogeneous singular integrals, 333
improved integrability
of Ap weights, 518
inductive limit topology, 120
inﬁnitely differentiable function, 104
inhomogeneous Lipschitz functions, 196
inner product
complex, 150
real, 150
inner regular measure, 98
interpolation
Banach-valued Marcinkiewicz theorem, 400
Banach-valued Riesz–Thorin theorem, 399
for analytic families of operators, 41
Marcinkiewicz theorem, 33
off-diagonal Marcinkiewicz theorem, 61
Riesz–Thorin theorem, 37
Stein’s theorem, 41
with change of measure, 78
inverse Fourier transform, 112
isoperimetric inequality, 17
Jensen’s inequality, 12, 525
Jones’s factorization theorem, 546
Khintchine’s inequalities, 586
for weak type spaces, 589
Kolmogorov’s inequality, 100
Kolmogorov’s theorem, 255
Kronecker’s lemma, 255
lacunary Carleson–Hunt theorem, 454
lacunary sequence, 227
Laplace’s equation, 328
Laplacian, 135
lattice points, 305
Lebesgue constants, 182
Lebesgue differentiation theorem, 95, 101

636
Index
left Haar measure, 18
left maximal function, 102
Leibniz’s rule, 105, 131
linear operator, 33
Liouville’s theorem, 143
Lipschitz condition, 384
for a kernel, 359
Lipschitz space
homogeneous, 195
inhomogeneous, 196
Littlewood–Paley operator, 420
Littlewood–Paley theorem, 421
localization principle, 213
locally compact topological group, 18
locally ﬁnite measure, 98
locally integrable functions, 11
logconvexity of weak L1, 78
Lorentz spaces, 52
M. Riesz’s theorem, 247
majorant
radial decreasing, 92
Marcinkiewicz and Zygmund theorem, 386
Marcinkiewicz function, 415
Marcinkiewicz interpolation theorem, 33
Marcinkiewicz multiplier theorem
on Rn, 441
on R, 439
maximal Calder´on–Zygmund operator, 533
maximal function
centered with respect to cubes, 99
dyadic, 103
dyadic spherical, 461
Hardy–Littlewood centered, 86
Hardy–Littlewood uncentered, 87
left, 102
right, 102
strong, 101
uncentered with respect to cubes, 99
with respect to a general measure, 98
maximal Hilbert transform, 322
maximal singular integral, 334
doubly truncated, 363
maximal singular integrals with even kernels,
347
maximal truncated singular integral, 363
measurable set, 2
method of rotations, 339
metrizability
of Lorentz space Lp,q, 74
of weak Lp, 14
Mihlin-H¨ormander multiplier theorem, 446
minimally supported frequency wavelet, 486
minimax lemma, 556, 603
Minkowski’s inequality, 3, 12, 21
integral form, 13
Minkowski’s integral inequality, 13
Muckenhoupt characteristic constant, 503
Muckenhoupt characteristic constant of a
weight, 503
multi-index, 104
multiplier, 155
on the torus, 272
multiplier theorems, 437
necessity of Ap condition, 543
nonatomic measure space, 56
nonsmooth Littlewood–Paley theorem, 427,
428
normability
p-normability of weak Lp for p < 1, 16
of Lorentz space Lp,q, 74
of Lorentz spaces, 74
of weak Lp for p > 1, 14
normability of weak L1 (lack of), 15
off-diagonal Marcinkiewicz interpolation
theorem, 61
open mapping theorem, 602
operator
commuting with translations, 146
of strong type (p,q), 33
of weak type (p,q), 33
orthonormal set, 185, 484
orthonormal system
complete, 185
oscillation of a function, 94
oscillatory integral, 161
overshoot, 221, 224
Parseval’s relation, 112, 186
partial derivative, 104
partition of unity, 611
phase, 161
Plancherel’s identity, 112, 186
pointwise convergence of Fourier series, 204
Poisson kernel, 26, 92, 95, 183, 317
Poisson kernel for the sphere, 144
Poisson representation formula
of Bessel functions, 573
Poisson summation formula, 187
polarization, 186
positive operator, 397
power weights, 506
principal value integral, 314
principle of localization, 213
quasi-linear operator, 33, 61
quasi-subadditive operator, 45

Index
637
Rademacher functions, 585
radial decreasing majorant, 92
radial function, 90
real analytic function, 262
reﬂection
of a function, 109
of a tempered distribution, 124
reﬂection formula
for the gamma function, 570
regulated function, 275
restricted weak type, 77
restricted weak type (1,1), 81
restricted weak type (p,q) with constant C, 61
reverse H¨older condition
of order q, 523
reverse H¨older property of Ap weights, 514
RHq(μ), 523
Riemann zeta function, 301
Riemann’s principle of localization, 213
Riemann–Lebesgue lemma, 114, 193, 215
Riesz product, 232
Riesz projection, 245
Riesz transform, 325
Riesz–Thorin interpolation theorem, 37
right maximal function, 102
right Haar measure, 18
rotations method, 339
rough singular integrals, 455
Rubio de Francia’s extrapolation theorem, 548
sampling theorem, 491
Schwartz function, 105
Schwartz seminorm, 105
self-adjoint operator, 151
self-transpose operator, 151
Sidon set, 235
simple function, 2
sine integral function, 218
singular integrals with even kernels, 341
size condition
for a kernel, 358, 374
smooth bump, 120
smooth function, 104, 119
smooth function with compact support, 104,
119
smoothly truncated maximal singular integral,
374
smoothness condition
for a kernel, 359, 375
space
L∞, 2
Lp, 2
Lp,∞, 5
Lp,q, 52
M 1,1(Rn), 153
M 2,2(Rn), 154
M ∞,∞(Rn), 154
M p,q(Rn), 151
Mp(Rn), 155
C N, 104
C ∞, 104
C ∞
0 , 104
spectrum of the Fourier transform, 116
spherical maximal function, 475
spherical average, 476
spherical coordinates, 591
spherical Dirichlet kernel, 178
spherical partial sum, 184
square Dirichlet kernel, 178
square function, 421, 458
dyadic martingale, 469
square function of Littlewood–Paley, 421
square partial sum, 184
standard kernel, 532
Stein’s interpolation theorem, 41
stereographic projection, 594
Stirling’s formula, 567
stopping-time, 97
stopping-time argument, 356
strong maximal function, 101
strong type (p,q), 33
sublinear operator, 33, 61
summation by parts, 599
support of a distribution, 125
surface area of the unit sphere Sn−1, 565
Taylor formula, 607
tempered distribution, 120
test function, 119
tight frame, 496
tiling of Rn, 428
topological group, 18
torus, 174
total order of differentiation, 104
transference of maximal multipliers, 281
transference of multipliers, 275
translation
of a function, 109
of a tempered distribution, 124
translation operator, 271
translation-invariant operator, 146
transpose of an operator, 150
trigonometric monomial, 177
trigonometric polynomial, 177
truncated Hilbert transform, 314
truncated maximal singular integral, 374
truncated singular integral, 334, 363

638
Index
uncentered Hardy–Littlewood maximal
function, 87
uncentered maximal function with respect to a
general measure, 98
uncentered maximal function with respect to
cubes, 99
uncertainty principle, 118
uniform boundedness principle, 602
unitary matrix, 387
Vandermonde determinant, 165
variation of a function, 199
vector-valued
extrapolation theorem, 554
Hardy–Littlewood maximal inequality, 412,
557
inequalities, 555
vector-valued extension of a linear operator,
390
vector-valued inequalities, 408, 409, 414
vector-valued Littlewood–Paley theorem, 426
vector-valued singular integral, 401
volume of the unit ball in Rn, 565
wave equation, 475
wavelet, 482
of minimally supported frequency, 486
wavelet transform, 496
weak Lp, 5
weak type (1,1), 88
weak type (p,q), 33
Weierstrass approximation theorem, 32
for trigonometric polynomials, 183
Weierstrass’s theorem, 229
weight, 499
of class A1, 502
of class A∞, 525
of class Ap, 503
weighted estimates
for singular integral operators, 540
Weyl’s theorem, 302
Whitney decomposition, 609
Young’s covering lemma, 98
Young’s inequality, 22, 400
for weak type spaces, 23, 73

