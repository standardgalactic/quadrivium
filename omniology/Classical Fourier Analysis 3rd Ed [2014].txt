Graduate Texts in Mathematics
Classical 
Fourier 
Analysis
Loukas Grafakos
Third Edition

Graduate Texts in Mathematics
249

Graduate Texts in Mathematics
Series Editors:
Sheldon Axler
San Francisco State University, San Francisco, CA, USA
Kenneth Ribet
University of California, Berkeley, CA, USA
Advisory Board:
Colin Adams, Williams College, Williamstown, MA, USA
Alejandro Adem, University of British Columbia, Vancouver, BC, Canada
Ruth Charney, Brandeis University, Waltham, MA, USA
Irene M. Gamba, The University of Texas at Austin, Austin, TX, USA
Roger E. Howe, Yale University, New Haven, CT, USA
David Jerison, Massachusetts Institute of Technology, Cambridge, MA, USA
Jeffrey C. Lagarias, University of Michigan, Ann Arbor, MI, USA
Jill Pipher, Brown University, Providence, RI, USA
Fadil Santosa, University of Minnesota, Minneapolis, MN, USA
Amie Wilkinson, University of Chicago, Chicago, IL, USA
Graduate Texts in Mathematics bridge the gap between passive study and creative
understanding, offering graduate-level introductions to advanced topics in mathe-
matics. The volumes are carefully written as teaching aids and highlight character-
istic features of the theory. Although these books are frequently used as textbooks
in graduate courses, they are also suitable for individual study.
For further volumes:
http://www.springer.com/series/136

Loukas Grafakos
Classical Fourier Analysis
Third Edition
123

Loukas Grafakos
Department of Mathematics
University of Missouri
Columbia, MO, USA
ISSN 0072-5285
ISSN 2197-5612 (electronic)
ISBN 978-1-4939-1193-6
ISBN 978-1-4939-1194-3 (eBook)
DOI 10.1007/978-1-4939-1194-3
Springer New York Heidelberg Dordrecht London
Library of Congress Control Number: 2014946585
Mathematics Subject ClassiÔ¨Åcation (2010): 42Axx, 42Bxx
¬© Springer Science+Business Media New York 2000, 2008, 2014
This work is subject to copyright. All rights are reserved by the Publisher, whether the whole or part of
the material is concerned, speciÔ¨Åcally the rights of translation, reprinting, reuse of illustrations, recitation,
broadcasting, reproduction on microÔ¨Ålms or in any other physical way, and transmission or information
storage and retrieval, electronic adaptation, computer software, or by similar or dissimilar methodology
now known or hereafter developed. Exempted from this legal reservation are brief excerpts in connection
with reviews or scholarly analysis or material supplied speciÔ¨Åcally for the purpose of being entered
and executed on a computer system, for exclusive use by the purchaser of the work. Duplication of
this publication or parts thereof is permitted only under the provisions of the Copyright Law of the
Publisher‚Äôs location, in its current version, and permission for use must always be obtained from Springer.
Permissions for use may be obtained through RightsLink at the Copyright Clearance Center. Violations
are liable to prosecution under the respective Copyright Law.
The use of general descriptive names, registered names, trademarks, service marks, etc. in this publication
does not imply, even in the absence of a speciÔ¨Åc statement, that such names are exempt from the relevant
protective laws and regulations and therefore free for general use.
While the advice and information in this book are believed to be true and accurate at the date of pub-
lication, neither the authors nor the editors nor the publisher can accept any legal responsibility for any
errors or omissions that may be made. The publisher makes no warranty, express or implied, with respect
to the material contained herein.
Printed on acid-free paper
Springer is part of Springer Science+Business Media (www.springer.com)

To Suzanne


Preface
The great response to the publication of my book Classical and Modern Fourier
Analysis in 2004 has been especially gratifying to me. I was delighted when Springer
offered to publish the second edition in 2008 in two volumes: Classical Fourier
Analysis, 2nd Edition, and Modern Fourier Analysis, 2nd Edition. I am now elated
to have the opportunity to write the present third edition of these books, which
Springer has also kindly offered to publish. The third edition was born from my
desire to improve the exposition in several places, Ô¨Åx a few inaccuracies, and add
some new material. I have been very fortunate to receive several hundred e-mail
messages that helped me improve the proofs and locate mistakes and misprints in
the previous editions.
In this edition, I maintain the same style as in the previous ones. The proofs con-
tain details that unavoidably make the reading more cumbersome. Although it will
behoove many readers to skim through the more technical aspects of the presenta-
tion and concentrate on the Ô¨Çow of ideas, the fact that details are present will be
comforting to some. (This last sentence is based on my experience as a graduate
student.) Readers familiar with the second edition will notice that the chapter on
weights has been moved from the second volume to the Ô¨Årst.
This Ô¨Årst volume Classical Fourier Analysis is intended to serve as a text for
a one-semester course with prerequisites of measure theory, Lebesgue integration,
and complex variables. I am aware that this book contains signiÔ¨Åcantly more ma-
terial than can be taught in a semester course; however, I hope that this additional
information will be useful to researchers. Based on my experience, the following list
of sections (or parts of them) could be taught in a semester without affecting the
logical coherence of the book: Sections 1.1, 1.2, 1.3, 2.1, 2.2., 2.3, 3.1, 3.2, 3.3, 4.4,
4.5, 5.1, 5.2, 5.3, 5.5, 5.6, 6.1, 6.2.
A long list of people have assisted me in the preparation of this book, but I remain
solely responsible for any misprints, mistakes, and omissions contained therein.
Please contact me directly (grafakosl@missouri.edu) if you have corrections or com-
ments. Any corrections to this edition will be posted to the website
http://math.missouri.edu/Àúloukas/FourierAnalysis.html
vii

viii
Preface
which I plan to update regularly. I have prepared solutions to all of the exercises for
the present edition which will be available to instructors who teach a course out of
this book.
Athens, Greece,
Loukas Grafakos
March 2014

Acknowledgments
I am extremely fortunate that several people have pointed out errors, misprints, and
omissions in the previous editions of the books in this series. All these individuals
have provided me with invaluable help that resulted in the improved exposition of
the text. For these reasons, I would like to express my deep appreciation and sincere
gratitude to the all of the following people.
ix
First edition acknowledgements: Georgios Alexopoulos, Nakhl¬¥e Asmar, Bruno
Calado, Carmen Chicone, David Cramer, Geoffrey Diestel, Jakub Duda, Brenda
Frazier, Derrick Hart, Mark Hoffmann, Steven Hofmann, Helge Holden, Brian
Hollenbeck, Petr Honz¬¥ƒ±k, Alexander Iosevich, Tunde Jakab, Svante Janson, Ana
Jim¬¥enez del Toro, Gregory Jones, Nigel Kalton, Emmanouil Katsoprinakis, Dennis
Kletzing, Steven Krantz, Douglas Kurtz, George Lobell, Xiaochun Li, Jos¬¥e Mar¬¥ƒ±a
Martell, Antonios Melas, Keith Mersman, Stephen Montgomery-Smith, Andrea
Nahmod, Nguyen Cong Phuc, Krzysztof Oleszkiewicz, Cristina Pereyra, Carlos
P¬¥erez, Daniel Redmond, Jorge Rivera-Noriega, Dmitriy Ryabogin, Christopher
Sansing, Lynn Savino Wendel, Shih-Chi Shen, Roman Shvidkoy, Elias M. Stein,
Atanas Stefanov, Terence Tao, Erin Terwilleger, Christoph Thiele, Rodolfo Torres,
Deanie Tourville, Nikolaos Tzirakis, Don Vaught, Igor Verbitsky, Brett Wick, James
Wright, and Linqiao Zhao.
Second edition acknowledgements: Marco Annoni, Pascal Auscher, Andrew
Bailey, Dmitriy Bilyk, Marcin Bownik, Juan Cavero de Carondelet Fiscowich,
Leonardo Colzani, Simon Cowell, Mita Das, Geoffrey Diestel, Yong Ding, Jacek
Dziubanski, Frank Ganz, Frank McGuckin, Wei He, Petr Honz¬¥ƒ±k, Heidi Hulsizer,
Philippe Jaming, Svante Janson, Ana Jim¬¥enez del Toro, John Kahl, Cornelia Kaiser,
Nigel Kalton, Kim Jin Myong, Doowon Koh, Elena Koutcherik, David Kramer,
Enrico Laeng, Sungyun Lee, Qifan Li, Chin-Cheng Lin, Liguang Liu, Stig-Olof
Londen, Diego Maldonado, Jos¬¥e Mar¬¥ƒ±a Martell, Mieczys≈Çaw Masty≈Ço, Parasar
Mohanty, Carlo Morpurgo, Andrew Morris, Mihail Mourgoglou, Virginia Naibo,
Tadahiro Oh, Marco Peloso, Maria Cristina Pereyra, Carlos P¬¥erez, Humberto Rafeiro,
Maria Carmen Reguera Rodr¬¥ƒ±guez, Alexander Samborskiy, Andreas Seeger, Steven
Senger, Sumi Seo, Christopher Shane, Shu Shen, Yoshihiro Sawano, Mark Spencer,
Vladimir Stepanov, Erin Terwilleger, Rodolfo H. Torres, Suzanne Tourville,

x
Acknowledgments
Among all these people, I would like to give special thanks to an individual who
has studied extensively the two books in the series and has helped me more than
anyone else in the preparation of the third edition: Danqing He. I am indebted to him
for all the valuable corrections, suggestions, and constructive help he has provided
me with in this work. Without him, these books would have been a lot poorer.
Finally, I would also like to thank the University of Missouri for granting me
a research leave during the academic year 2013-2014. This time off enabled me to
Ô¨Ånish the third edition of this book on time. I spent my leave in Greece.
Ignacio Uriarte-Tuero, Kunyang Wang, Huoxiong Wu, KÀÜozÀÜo Yabuta, Takashi
Yamamoto, and Dachun Yang.
Third edition acknowledgments: Marco Annoni, Mark Ashbaugh, Daniel
Azagra, Andrew Bailey, ¬¥Arpad B¬¥enyi, Dmitriy Bilyk, Nicholas Boros, Almut
Burchard, Mar¬¥ƒ±a Carro, Jameson Cahill, Juan Cavero de Carondelet Fiscowich,
Xuemei Chen, Andrea Fraser, Shai Dekel, Fausto Di Biase, Zeev Ditzian, Jianfeng
Dong, Oliver DragiÀácevi¬¥c, Sivaji Ganesh, Friedrich Gesztesy, Zhenyu Guo, Piotr
Haj≈Çasz, Danqing He, Andreas Heinecke, Steven Hofmann, Takahisa Inui, Junxiong
Jia, Kasinathan Kamalavasanthi, Hans Koelsch, Richard Laugesen, Kaitlin Leach,
Andrei Lerner, Yiyu Liang, Calvin Lin, Liguang Liu, Elizabeth Loew, Chao Lu,
Richard Lynch, Diego Maldonado, Lech Maligranda, Richard Marcum, Mieczys≈Çaw
Masty≈Ço, Mariusz Mirek, Carlo Morpurgo, Virginia Naibo, Hanh Van Nguyen,
Seungly Oh, Tadahiro Oh, Yusuke Oi, Lucas da Silva Oliveira, Kevin O‚ÄôNeil, Hesam
Oveys, Manos Papadakis, Marco Peloso, Carlos P¬¥erez, Jesse Peterson, Dmitry
Prokhorov, Amina Ravi, Maria Carmen Reguera Rodr¬¥ƒ±guez, Yoshihiro Sawano,
Mirye Shin, Javier Soria, Patrick Spencer, Marc Strauss, Krystal Taylor, Naohito
Tomita, Suzanne Tourville, Rodolfo H. Torres, Fujioka Tsubasa, Ignacio Uriarte-
Tuero, Brian Tuomanen, Shibi Vasudevan, Michael Wilson, Dachun Yang, Kai Yang,
Yandan Zhang, Fayou Zhao, and Lifeng Zhao.

Contents
1
Lp Spaces and Interpolation
1
1.1
Lp and Weak Lp . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1
1.1.1
The Distribution Function . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
3
1.1.2
Convergence in Measure . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
6
1.1.3
A First Glimpse at Interpolation . . . . . . . . . . . . . . . . . . . . . . . .
9
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
11
1.2
Convolution and Approximate Identities . . . . . . . . . . . . . . . . . . . . . . .
17
1.2.1
Examples of Topological Groups . . . . . . . . . . . . . . . . . . . . . . .
18
1.2.2
Convolution . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
19
1.2.3
Basic Convolution Inequalities . . . . . . . . . . . . . . . . . . . . . . . . .
21
1.2.4
Approximate Identities. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30
1.3
Interpolation. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 33
1.3.1
Real Method: The Marcinkiewicz Interpolation Theorem . . . 33
1.3.2
Complex Method: The Riesz‚ÄìThorin Interpolation
Theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36
1.3.3
Interpolation of Analytic Families of Operators . . . . . . . . . . . 40
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45
1.4
Lorentz Spaces. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 48
1.4.1
Decreasing Rearrangements . . . . . . . . . . . . . . . . . . . . . . . . . . . 48
1.4.2
Lorentz Spaces . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 52
1.4.3
Duals of Lorentz Spaces . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 56
1.4.4
The Off-Diagonal Marcinkiewicz Interpolation Theorem . . . 60
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
74
2
Maximal Functions, Fourier Transform, and Distributions
85
2.1
Maximal Functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 86
2.1.1
The Hardy‚ÄìLittlewood Maximal Operator. . . . . . . . . . . . . . . . 86
2.1.2
Control of Other Maximal Operators . . . . . . . . . . . . . . . . . . . . 90
xi

xii
Contents
2.1.3
Applications to Differentiation Theory . . . . . . . . . . . . . . . . . . 93
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 98
2.2
The Schwartz Class and the Fourier Transform . . . . . . . . . . . . . . . . . . 104
2.2.1
The Class of Schwartz Functions . . . . . . . . . . . . . . . . . . . . . . . 105
2.2.2
The Fourier Transform of a Schwartz Function . . . . . . . . . . . 108
2.2.3
The Inverse Fourier Transform and Fourier Inversion . . . . . . 111
2.2.4
The Fourier Transform on L1 +L2 . . . . . . . . . . . . . . . . . . . . . . 113
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 116
2.3
The Class of Tempered Distributions . . . . . . . . . . . . . . . . . . . . . . . . . . 119
2.3.1
Spaces of Test Functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 119
2.3.2
Spaces of Functionals on Test Functions . . . . . . . . . . . . . . . . . 120
2.3.3
The Space of Tempered Distributions . . . . . . . . . . . . . . . . . . . 123
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 131
2.4
More About Distributions and the Fourier Transform . . . . . . . . . . . . . 133
2.4.1
Distributions Supported at a Point . . . . . . . . . . . . . . . . . . . . . . 134
2.4.2
The Laplacian . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 135
2.4.3
Homogeneous Distributions . . . . . . . . . . . . . . . . . . . . . . . . . . . 136
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 143
2.5
Convolution Operators on Lp Spaces and Multipliers . . . . . . . . . . . . . 146
2.5.1
Operators That Commute with Translations . . . . . . . . . . . . . . 146
2.5.2
The Transpose and the Adjoint of a Linear Operator . . . . . . . 150
2.5.3
The Spaces M p,q(Rn) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 151
2.5.4
Characterizations of M 1,1(Rn) and M 2,2(Rn) . . . . . . . . . . . . 153
2.5.5
The Space of Fourier Multipliers Mp(Rn) . . . . . . . . . . . . . . . 155
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 159
2.6
Oscillatory Integrals . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 161
2.6.1
Phases with No Critical Points . . . . . . . . . . . . . . . . . . . . . . . . . 161
2.6.2
Sublevel Set Estimates and the Van der Corput Lemma. . . . . 164
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 169
3
Fourier Series
173
3.1
Fourier CoefÔ¨Åcients . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 173
3.1.1
The n-Torus Tn . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 174
3.1.2
Fourier CoefÔ¨Åcients . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 175
3.1.3
The Dirichlet and Fej¬¥er Kernels . . . . . . . . . . . . . . . . . . . . . . . . 178
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 182
3.2
Reproduction of Functions from Their Fourier CoefÔ¨Åcients . . . . . . . . 183
3.2.1
Partial sums and Fourier inversion . . . . . . . . . . . . . . . . . . . . . . 183
3.2.2
Fourier series of square summable functions . . . . . . . . . . . . . 185
3.2.3
The Poisson Summation Formula . . . . . . . . . . . . . . . . . . . . . . . 187
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 191
3.3
Decay of Fourier CoefÔ¨Åcients . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 192
3.3.1
Decay of Fourier CoefÔ¨Åcients of Arbitrary Integrable
Functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 193
3.3.2
Decay of Fourier CoefÔ¨Åcients of Smooth Functions . . . . . . . . 195

Contents
xiii
3.3.3
Functions with Absolutely Summable Fourier
CoefÔ¨Åcients . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 200
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 202
3.4
Pointwise Convergence of Fourier Series . . . . . . . . . . . . . . . . . . . . . . . 204
3.4.1
Pointwise Convergence of the Fej¬¥er Means . . . . . . . . . . . . . . . 204
3.4.2
Almost Everywhere Convergence of the Fej¬¥er Means . . . . . . 207
3.4.3
Pointwise Divergence of the Dirichlet Means . . . . . . . . . . . . . 210
3.4.4
Pointwise Convergence of the Dirichlet Means . . . . . . . . . . . . 212
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 214
3.5
A Tauberian theorem and Functions of Bounded Variation . . . . . . . . 216
3.5.1
A Tauberian theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 216
3.5.2
The sine integral function . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 218
3.5.3
Further properties of functions of bounded variation . . . . . . . 219
3.5.4
Gibbs phenomenon. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 221
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 225
3.6
Lacunary Series and Sidon Sets . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 226
3.6.1
DeÔ¨Ånition and Basic Properties of Lacunary Series . . . . . . . . 227
3.6.2
Equivalence of Lp Norms of Lacunary Series . . . . . . . . . . . . . 229
3.6.3
Sidon sets . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 235
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 237
4
Topics on Fourier Series
241
4.1
Convergence in Norm, Conjugate Function,
and Bochner‚ÄìRiesz Means . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 241
4.1.1
Equivalent Formulations of Convergence in Norm . . . . . . . . . 242
4.1.2
The Lp Boundedness of the Conjugate Function. . . . . . . . . . . 246
4.1.3
Bochner‚ÄìRiesz Summability . . . . . . . . . . . . . . . . . . . . . . . . . . . 250
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 253
4.2
A. E. Divergence of Fourier Series and Bochner‚ÄìRiesz means . . . . . 255
4.2.1
Divergence of Fourier Series of Integrable Functions . . . . . . 255
4.2.2
Divergence of Bochner‚ÄìRiesz Means of Integrable
Functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 261
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 270
4.3
Multipliers, Transference, and Almost Everywhere Convergence . . . 271
4.3.1
Multipliers on the Torus. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 271
4.3.2
Transference of Multipliers . . . . . . . . . . . . . . . . . . . . . . . . . . . . 275
4.3.3
Applications of Transference. . . . . . . . . . . . . . . . . . . . . . . . . . . 280
4.3.4
Transference of Maximal Multipliers . . . . . . . . . . . . . . . . . . . . 281
4.3.5
Applications to Almost Everywhere Convergence . . . . . . . . . 285
4.3.6
Almost Everywhere Convergence of Square Dirichlet
Means . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 287
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 289

xiv
Contents
4.4
Applications to Geometry and Partial Differential Equations. . . . . . . 292
4.4.1
The Isoperimetric Inequality . . . . . . . . . . . . . . . . . . . . . . . . . . . 292
4.4.2
The Heat Equation with Periodic Boundary Condition . . . . . 294
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 298
4.5
Applications to Number theory and Ergodic theory . . . . . . . . . . . . . . 299
4.5.1
Evaluation of the Riemann Zeta Function at even Natural
numbers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 299
4.5.2
Equidistributed sequences . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 302
4.5.3
The Number of Lattice Points inside a Ball . . . . . . . . . . . . . . . 305
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 308
5
Singular Integrals of Convolution Type
313
5.1
The Hilbert Transform and the Riesz Transforms . . . . . . . . . . . . . . . . 313
5.1.1
DeÔ¨Ånition and Basic Properties of the Hilbert Transform . . . 314
5.1.2
Connections with Analytic Functions. . . . . . . . . . . . . . . . . . . . 317
5.1.3
Lp Boundedness of the Hilbert Transform . . . . . . . . . . . . . . . . 319
5.1.4
The Riesz Transforms . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 324
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 329
5.2
Homogeneous Singular Integrals and the Method of Rotations . . . . . 333
5.2.1
Homogeneous Singular and Maximal Singular Integrals . . . . 333
5.2.2
L2 Boundedness of Homogeneous Singular Integrals . . . . . . 336
5.2.3
The Method of Rotations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 339
5.2.4
Singular Integrals with Even Kernels . . . . . . . . . . . . . . . . . . . . 341
5.2.5
Maximal Singular Integrals with Even Kernels . . . . . . . . . . . 347
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 353
5.3
The Calder¬¥on‚ÄìZygmund Decomposition and Singular Integrals . . . . 355
5.3.1
The Calder¬¥on‚ÄìZygmund Decomposition . . . . . . . . . . . . . . . . . 355
5.3.2
General Singular Integrals . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 358
5.3.3
Lr Boundedness Implies Weak Type (1,1) Boundedness. . . . 359
5.3.4
Discussion on Maximal Singular Integrals . . . . . . . . . . . . . . . 362
5.3.5
Boundedness for Maximal Singular Integrals Implies
Weak Type (1,1) Boundedness . . . . . . . . . . . . . . . . . . . . . . . . . 366
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 371
5.4
SufÔ¨Åcient Conditions for Lp Boundedness . . . . . . . . . . . . . . . . . . . . . . 374
5.4.1
SufÔ¨Åcient Conditions for Lp Boundedness of Singular
Integrals . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 375
5.4.2
An Example . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 378
5.4.3
Necessity of the Cancellation Condition . . . . . . . . . . . . . . . . . 379
5.4.4
SufÔ¨Åcient Conditions for Lp Boundedness of Maximal
Singular Integrals . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 380
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 384
5.5
Vector-Valued Inequalities . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 385
5.5.1
‚Ñì2-Valued Extensions of Linear Operators . . . . . . . . . . . . . . . . 386
5.5.2
Applications and ‚Ñìr-Valued Extensions of Linear
Operators . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 390

Contents
xv
5.5.3
General Banach-Valued Extensions . . . . . . . . . . . . . . . . . . . . . 391
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 398
5.6
Vector-Valued Singular Integrals . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 401
5.6.1
Banach-Valued Singular Integral Operators. . . . . . . . . . . . . . . 402
5.6.2
Applications . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 408
5.6.3
Vector-Valued Estimates for Maximal Functions . . . . . . . . . . 411
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 414
6
Littlewood‚ÄìPaley Theory and Multipliers
419
6.1
Littlewood‚ÄìPaley Theory . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 419
6.1.1
The Littlewood‚ÄìPaley Theorem . . . . . . . . . . . . . . . . . . . . . . . . 420
6.1.2
Vector-Valued Analogues. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 426
6.1.3
Lp Estimates for Square Functions Associated
with Dyadic Sums . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 426
6.1.4
Lack of Orthogonality on Lp . . . . . . . . . . . . . . . . . . . . . . . . . . . 431
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 434
6.2
Two Multiplier Theorems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 437
6.2.1
The Marcinkiewicz Multiplier Theorem on R . . . . . . . . . . . . . 439
6.2.2
The Marcinkiewicz Multiplier Theorem on Rn . . . . . . . . . . . . 441
6.2.3
The Mihlin‚ÄìH¬®ormander Multiplier Theorem on Rn . . . . . . . . 445
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 450
6.3
Applications of Littlewood‚ÄìPaley Theory . . . . . . . . . . . . . . . . . . . . . . 453
6.3.1
Estimates for Maximal Operators . . . . . . . . . . . . . . . . . . . . . . . 453
6.3.2
Estimates for Singular Integrals with Rough Kernels . . . . . . . 455
6.3.3
An Almost Orthogonality Principle on Lp . . . . . . . . . . . . . . . . 459
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 461
6.4
The Haar System, Conditional Expectation, and Martingales . . . . . . 463
6.4.1
Conditional Expectation and Dyadic Martingale
Differences . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 464
6.4.2
Relation Between Dyadic Martingale Differences
and Haar Functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 465
6.4.3
The Dyadic Martingale Square Function . . . . . . . . . . . . . . . . . 469
6.4.4
Almost Orthogonality Between the Littlewood‚ÄìPaley
Operators and the Dyadic Martingale Difference
Operators . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 471
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 474
6.5
The Spherical Maximal Function . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 475
6.5.1
Introduction of the Spherical Maximal Function . . . . . . . . . . 475
6.5.2
The First Key Lemma . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 478
6.5.3
The Second Key Lemma . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 479
6.5.4
Completion of the Proof . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 481
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 481
6.6
Wavelets and Sampling . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 482
6.6.1
Some Preliminary Facts . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 483
6.6.2
Construction of a Nonsmooth Wavelet . . . . . . . . . . . . . . . . . . . 485

xvi
Contents
6.6.3
Construction of a Smooth Wavelet . . . . . . . . . . . . . . . . . . . . . . 486
6.6.4
Sampling . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 490
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 494
7
Weighted Inequalities
499
7.1
The Ap Condition . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 499
7.1.1
Motivation for the Ap Condition . . . . . . . . . . . . . . . . . . . . . . . . 500
7.1.2
Properties of Ap Weights . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 503
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 511
7.2
Reverse H¬®older Inequality for Ap Weights and Consequences . . . . . . 514
7.2.1
The Reverse H¬®older Property of Ap Weights . . . . . . . . . . . . . . 514
7.2.2
Consequences of the Reverse H¬®older Property . . . . . . . . . . . . 518
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 521
7.3
The A‚àûCondition . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 525
7.3.1
The Class of A‚àûWeights . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 525
7.3.2
Characterizations of A‚àûWeights . . . . . . . . . . . . . . . . . . . . . . . 527
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 530
7.4
Weighted Norm Inequalities for Singular Integrals . . . . . . . . . . . . . . . 532
7.4.1
Singular Integrals of Non Convolution type . . . . . . . . . . . . . . 532
7.4.2
A Good Lambda Estimate for Singular Integrals . . . . . . . . . . 533
7.4.3
Consequences of the Good Lambda Estimate . . . . . . . . . . . . . 539
7.4.4
Necessity of the Ap Condition. . . . . . . . . . . . . . . . . . . . . . . . . . 543
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 545
7.5
Further Properties of Ap Weights. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 546
7.5.1
Factorization of Weights . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 546
7.5.2
Extrapolation from Weighted Estimates on a Single Lp0 . . . . 548
7.5.3
Weighted Inequalities Versus Vector-Valued Inequalities. . . . 554
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 558
A
Gamma and Beta Functions
563
A.1
A Useful Formula . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 563
A.2 DeÔ¨Ånitions of Œì (z) and B(z,w) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 563
A.3 Volume of the Unit Ball and Surface of the Unit Sphere. . . . . . . . . . . 565
A.4 Computation of Integrals Using Gamma Functions. . . . . . . . . . . . . . . 565
A.5 Meromorphic Extensions of B(z,w) and Œì (z) . . . . . . . . . . . . . . . . . . . 566
A.6 Asymptotics of Œì (x) as x ‚Üí‚àû. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 567
A.7 Euler‚Äôs Limit Formula for the Gamma Function . . . . . . . . . . . . . . . . . 568
A.8 ReÔ¨Çection and Duplication Formulas for the Gamma Function . . . . . 570
B
Bessel Functions
573
B.1
DeÔ¨Ånition . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 573
B.2
Some Basic Properties . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 573
B.3
An Interesting Identity . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 576
B.4
The Fourier Transform of Surface Measure on Sn‚àí1 . . . . . . . . . . . . . . 577
B.5
The Fourier Transform of a Radial Function on Rn . . . . . . . . . . . . . . . 577

Contents
xvii
B.6
Bessel Functions of Small Arguments . . . . . . . . . . . . . . . . . . . . . . . . . 578
B.7
Bessel Functions of Large Arguments. . . . . . . . . . . . . . . . . . . . . . . . . . 579
B.8
Asymptotics of Bessel Functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 580
B.9
Bessel Functions of general complex indices . . . . . . . . . . . . . . . . . . . . 582
C
Rademacher Functions
585
C.1
DeÔ¨Ånition of the Rademacher Functions. . . . . . . . . . . . . . . . . . . . . . . . 585
C.2
Khintchine‚Äôs Inequalities . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 586
C.3
Derivation of Khintchine‚Äôs Inequalities . . . . . . . . . . . . . . . . . . . . . . . . 586
C.4
Khintchine‚Äôs Inequalities for Weak Type Spaces . . . . . . . . . . . . . . . . . 589
C.5
Extension to Several Variables . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 589
D
Spherical Coordinates
591
D.1
Spherical Coordinate Formula . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 591
D.2 A Useful Change of Variables Formula . . . . . . . . . . . . . . . . . . . . . . . . 592
D.3 Computation of an Integral over the Sphere . . . . . . . . . . . . . . . . . . . . . 593
D.4 The Computation of Another Integral over the Sphere . . . . . . . . . . . . 593
D.5 Integration over a General Surface . . . . . . . . . . . . . . . . . . . . . . . . . . . . 594
D.6 The Stereographic Projection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 594
E
Some Trigonometric Identities and Inequalities
597
F
Summation by Parts
599
G
Basic Functional Analysis
601
H
The Minimax Lemma
603
I
Taylor‚Äôs and Mean Value Theorem in Several Variables
607
I.1
Mutlivariable Taylor‚Äôs Theorem. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 607
I.2
The Mean value Theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 608
J
The Whitney Decomposition of Open Sets in Rn
609
J.1
Decomposition of Open Sets . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 609
J.2
Partition of Unity adapted to Whitney cubes . . . . . . . . . . . . . . . . . . . . 611
Glossary
613
References
617
Index
633

Chapter 1
Lp Spaces and Interpolation
Many quantitative properties of functions are expressed in terms of their integra-
bility to a power. For this reason it is desirable to acquire a good understanding
of spaces of functions whose modulus to a power p is integrable. These are called
Lebesgue spaces and are denoted by Lp. Although an in-depth study of Lebesgue
spaces falls outside the scope of this book, it seems appropriate to devote a chapter
to reviewing some of their fundamental properties.
The emphasis of this review is basic interpolation between Lebesgue spaces.
Many problems in Fourier analysis concern boundedness of operators on Lebesgue
spaces, and interpolation provides a framework that often simpliÔ¨Åes this study. For
instance, in order to show that a linear operator maps Lp to itself for all 1 < p < ‚àû,
it is sufÔ¨Åcient to show that it maps the (smaller) Lorentz space Lp,1 into the (larger)
Lorentz space Lp,‚àûfor the same range of p‚Äôs. Moreover, some further reductions can
be made in terms of the Lorentz space Lp,1. This and other considerations indicate
that interpolation is a powerful tool in the study of boundedness of operators.
Although we are mainly concerned with Lp subspaces of Euclidean spaces, we
discuss in this chapter Lp spaces of arbitrary measure spaces, since they represent
a useful general setting. Many results in the text require working with general mea-
sures instead of Lebesgue measure.
1.1 Lp and Weak Lp
A measure space is a set X equipped with a œÉ-algebra of subsets of it and a function
Œº from the œÉ-algebra to [0,‚àû] that satisÔ¨Åes Œº(/0) = 0 and
Œº
 ‚àû

j=1
Bj

=
‚àû
‚àë
j=1
Œº(Bj)
for any sequence Bj of pairwise disjoint elements of the œÉ-algebra. The function Œº
is called a (positive) measure on X and elements of the œÉ-algebra of X are called
L. Grafakos, Classical Fourier Analysis, Graduate Texts in Mathematics 249,
DOI 10.1007/978-1-4939-1194-3 1, ¬© Springer Science+Business Media New York 2014
1

2
1 Lp Spaces and Interpolation
measurable sets. Measure spaces will be assumed to be complete, i.e., subsets of
the œÉ-algebra of measure zero also belong to the œÉ-algebra. A measure space X is
called œÉ-Ô¨Ånite if there is a sequence of measurable subsets Xn of it such that
X =
‚àû

n=1
Xn
and Œº(Xn) < ‚àû. A real-valued function f on a measure space is called measurable if
the set {x ‚ààX : f(x) > Œª} is measurable for all real numbers Œª. A complex-valued
function is measurable if and only if its real and imaginary parts are measurable. A
simple function is a Ô¨Ånite linear combination of characteristic functions of measur-
able subsets of X; these subsets may have inÔ¨Ånite measure. A Ô¨Ånitely simple function
has the form
N
‚àë
j=1
cjœáB j
where N < ‚àû, cj ‚ààC, and Bj are pairwise disjoint measurable sets with Œº(Bj) < ‚àû.
If N = ‚àû, this function will be called countably simple. Finitely simple functions
are exactly the integrable simple functions. Every nonnegative measurable function
is the pointwise limit of an increasing sequence of simple functions; if the space is
œÉ-Ô¨Ånite, these simple functions can be chosen to be Ô¨Ånitely simple.
For 0 < p < ‚àû, Lp(X,Œº) denotes the set of all complex-valued Œº-measurable
functions on X whose modulus to the pth power is integrable. L‚àû(X,Œº) is the set of
all complex-valued Œº-measurable functions f on X such that for some B > 0, the set
{x : | f(x)| > B} has Œº-measure zero. Two functions in Lp(X,Œº) are considered equal
if they are equal Œº-almost everywhere. When 0 < p < ‚àûÔ¨Ånitely simple functions
are dense in Lp(X,Œº). Within context and in the absence of ambiguity, Lp(X,Œº) is
simply written as Lp.
The notation Lp(Rn) is reserved for the space Lp(Rn,| ¬∑ |), where | ¬∑ | denotes n-
dimensional Lebesgue measure. Lebesgue measure on Rn is also denoted by dx.
Other measures will be considered on the Borel œÉ-algebra of Rn, i.e., is the smallest
œÉ-algebra that contains the closed subsets of Rn. Measures on the œÉ-algebra of Borel
measurable subsets are called Borel measures; such measures will be assumed to be
Ô¨Ånite on compact subsets of Rn. A Borel measure Œº with Œº(Rn) < ‚àûis called a Ô¨Ånite
Borel measure. A Borel measure on Rn is called regular for all Borel measurable
sets E we have
Œº(E) = inf{Œº(O) : E ‚´ÖO, O open} = sup{Œº(K) : K ‚´ÖE, K compact}.
The space Lp(Z) equipped with counting measure is denoted by ‚Ñìp(Z) or simply ‚Ñìp.
For 0 < p < ‚àû, we deÔ¨Åne the Lp norm of a function f (or quasi-norm if p < 1) by
 f

Lp(X,Œº) =

X | f(x)|p dŒº(x)
 1
p
(1.1.1)

1.1 Lp and Weak Lp
3
and for p = ‚àûby
f

L‚àû(X,Œº) = ess.sup| f| = inf
	
B > 0 : Œº({x : | f(x)| > B}) = 0

.
(1.1.2)
It is well known that Minkowski‚Äôs (or the triangle) inequality
f +g

Lp(X,Œº) ‚â§
f

Lp(X,Œº) +
g

Lp(X,Œº)
(1.1.3)
holds for all f, g in Lp = Lp(X,Œº), whenever 1 ‚â§p ‚â§‚àû. Since in addition
‚à•f‚à•Lp(X,Œº) = 0 implies that f = 0 (Œº-a.e.), the Lp spaces are normed linear spaces
for 1 ‚â§p ‚â§‚àû. For 0 < p < 1, inequality (1.1.3) is reversed when f,g ‚â•0. However,
the following substitute of (1.1.3) holds:
f +g

Lp(X,Œº) ‚â§2
1‚àíp
p  f

Lp(X,Œº) +
g

Lp(X,Œº)

,
(1.1.4)
and thus Lp(X,Œº) is a quasi-normed linear space. See also Exercise 1.1.5. For all
0 < p ‚â§‚àû, it can be shown that every Cauchy sequence in Lp(X,Œº) is convergent,
and hence the spaces Lp(X,Œº) are complete. For the case 0 < p < 1 we refer to
Exercise 1.1.8. Therefore, the Lp spaces are Banach spaces for 1 ‚â§p ‚â§‚àûand quasi-
Banach spaces for 0 < p < 1. For any p ‚àà(0,‚àû)\{1} we use the notation p‚Ä≤ =
p
p‚àí1.
Moreover, we set 1‚Ä≤ = ‚àûand ‚àû‚Ä≤ = 1, so that p‚Ä≤‚Ä≤ = p for all p ‚àà(0,‚àû]. H¬®older‚Äôs
inequality says that for all p ‚àà[1,‚àû] and all measurable functions f,g on (X,Œº) we
have
fg

L1 ‚â§
 f

Lp
g

Lp‚Ä≤ .
It is a well-known fact that the dual (Lp)‚àóof Lp is isometric to Lp‚Ä≤ for all 1 ‚â§p < ‚àû.
Furthermore, the Lp norm of a function can be obtained via duality when 1 ‚â§p ‚â§‚àû
as follows:
f

Lp =
sup
‚à•g‚à•Lp‚Ä≤ =1


X f gdŒº
.
For the endpoint cases p = 1, p = ‚àû, see Exercise 1.4.12 (a), (b).
1.1.1 The Distribution Function
DeÔ¨Ånition 1.1.1. For f a measurable function on X, the distribution function of f is
the function df deÔ¨Åned on [0,‚àû) as follows:
df (Œ±) = Œº({x ‚ààX : | f(x)| > Œ±}).
(1.1.5)
The distribution function df provides information about the size of f but not
about the behavior of f itself near any given point. For instance, a function on Rn and
each of its translates have the same distribution function. It follows from DeÔ¨Ånition
1.1.1 that df is a decreasing function of Œ± (not necessarily strictly).

4
1 Lp Spaces and Interpolation
f (x)
a3
a2
a1
E3
E1
B1
B2
B3
E2
x
a1
a2
a3
0
0
Œ±
Œ±
f (  )
d
.
.
.
.
Fig. 1.1 The graph of a simple function f =‚àë3
k=1 akœáEk and its distribution function df (Œ±). Here
Bj =‚àëj
k=1 Œº(Ek).
Example 1.1.2. For pedagogical reasons we compute the distribution function df of
a nonnegative simple function
f(x) =
N
‚àë
j=1
ajœáE j(x),
where the sets Ej are pairwise disjoint and a1 > ¬∑¬∑¬∑ > aN > 0. If Œ± ‚â•a1, then clearly
df (Œ±) = 0. However, if a2 ‚â§Œ± < a1 then | f(x)| > Œ± precisely when x ‚ààE1, and in
general, if aj+1 ‚â§Œ± < aj, then | f(x)| > Œ± precisely when x ‚ààE1 ‚à™¬∑¬∑¬∑‚à™Ej. Setting
Bj =
j
‚àë
k=1
Œº(Ek),
for j ‚àà{1,...,N}, B0 = aN+1 = 0, and a0 = ‚àû, we have
df (Œ±) =
N
‚àë
j=0
Bjœá[a j+1,a j)(Œ±).
Note that these formulas are valid even when Œº(Ei) = ‚àûfor some i. Figure 1.1
presents an illustration of this example when N = 3 and Œº(Ej) < ‚àûfor all j.
Proposition 1.1.3. Let f and g be measurable functions on (X,Œº). Then for all
Œ±,Œ≤ > 0 we have
(1) |g| ‚â§| f| Œº-a.e. implies that dg ‚â§df ;
(2) dc f (Œ±) = df (Œ±/|c|), for all c ‚ààC\{0};
(3) df+g(Œ± +Œ≤) ‚â§df (Œ±)+dg(Œ≤);
(4) dfg(Œ±Œ≤) ‚â§df (Œ±)+dg(Œ≤).

1.1 Lp and Weak Lp
5
Proof. The simple proofs are left to the reader.
‚ñ°
Knowledge of the distribution function df provides sufÔ¨Åcient information to eval-
uate the Lp norm of a function f precisely. We state and prove the following impor-
tant description of the Lp norm in terms of the distribution function.
Proposition 1.1.4. Let (X,Œº) be a œÉ-Ô¨Ånite measure space. Then for f in Lp(X,Œº),
0 < p < ‚àû, we have
f
p
Lp = p
 ‚àû
0 Œ± p‚àí1df (Œ±)dŒ± .
(1.1.6)
Moreover, for any increasing continuously differentiable function œï on [0,‚àû) with
œï(0) = 0 and every measurable function f on X with œï(| f|) integrable on X, we
have

X œï(| f|)dŒº =
 ‚àû
0 œï‚Ä≤(Œ±)df (Œ±)dŒ± .
(1.1.7)
Proof. Indeed, we have
p
 ‚àû
0 Œ± p‚àí1df (Œ±)dŒ± = p
 ‚àû
0 Œ± p‚àí1

X œá{x: | f(x)|>Œ±} dŒº(x)dŒ±
=

X
 | f(x)|
0
pŒ± p‚àí1 dŒ± dŒº(x)
=

X | f(x)|p dŒº(x)
=
f
p
Lp ,
where in the second equality we used Fubini‚Äôs theorem, which requires the measure
space to be œÉ-Ô¨Ånite. This proves (1.1.6). Identity (1.1.7) follows similarly, replacing
the function Œ± p by the more general function œï(Œ±) which has similar properties. ‚ñ°
DeÔ¨Ånition 1.1.5. For 0 < p < ‚àû, the space weak Lp(X,Œº) is deÔ¨Åned as the set of
all Œº-measurable functions f such that
f

Lp,‚àû= inf

C > 0 : df (Œ±) ‚â§Cp
Œ± p
for all
Œ± > 0

(1.1.8)
= sup
	
Œ≥ df (Œ≥)1/p : Œ≥ > 0

(1.1.9)
is Ô¨Ånite. The space weak L‚àû(X,Œº) is by deÔ¨Ånition L‚àû(X,Œº).
One should check that (1.1.9) and (1.1.8) are in fact equal. The weak Lp spaces are
denoted by Lp,‚àû(X,Œº). Two functions in Lp,‚àû(X,Œº) are considered equal if they are
equal Œº-a.e. The notation Lp,‚àû(Rn) is reserved for Lp,‚àû(Rn,|¬∑|). Using Proposition
1.1.3 (2), we can easily show that
k f

Lp,‚àû= |k|
f

Lp,‚àû,
(1.1.10)

6
1 Lp Spaces and Interpolation
for any complex constant k. The analogue of (1.1.3) is
 f +g

Lp,‚àû‚â§cp
 f

Lp,‚àû+
g

Lp,‚àû

,
(1.1.11)
where cp = max(2,21/p), a fact that follows from Proposition 1.1.3 (3), taking both
Œ± and Œ≤ equal to Œ±/2. We also have that
 f

Lp,‚àû(X,Œº) = 0 ‚áíf = 0
Œº-a.e.
(1.1.12)
In view of (1.1.10), (1.1.11), and (1.1.12), Lp,‚àûis a quasi-normed linear space for
0 < p < ‚àû.
The weak Lp spaces are larger than the usual Lp spaces. We have the following:
Proposition 1.1.6. For any 0 < p < ‚àûand any f in Lp(X,Œº) we have
 f

Lp,‚àû‚â§
 f

Lp .
Hence the embedding Lp(X,Œº) ‚´ÖLp,‚àû(X,Œº) holds.
Proof. This is just a trivial consequence of Chebyshev‚Äôs inequality:
Œ± pdf (Œ±) ‚â§

{x:| f(x)|>Œ±} | f(x)|p dŒº(x) ‚â§‚à•f‚à•p
Lp .
Using (1.1.9) we obtain that ‚à•f‚à•Lp,‚àû‚â§‚à•f‚à•Lp.
‚ñ°
The inclusion Lp ‚´ÖLp,‚àûis strict. For example, on Rn with the usual Lebesgue
measure, let h(x) = |x|‚àín
p . Obviously, h is not in Lp(Rn) but h is in Lp,‚àû(Rn) with
‚à•h‚à•Lp,‚àû(Rn) = v1/p
n
, where vn is the measure of the unit ball of Rn.
It is not immediate from their deÔ¨Ånition that the weak Lp spaces are complete
with respect to the quasi-norm ‚à•¬∑‚à•Lp,‚àû. The completeness of these spaces is proved
in Theorem 1.4.11, but it is also a consequence of Theorem 1.1.13, proved in this
section.
1.1.2 Convergence in Measure
Next we discuss some convergence notions. The following notion is important in
probability theory.
DeÔ¨Ånition 1.1.7. Let f, fn, n = 1,2,..., be measurable functions on the measure
space (X,Œº). The sequence fn is said to converge in measure to f if for all Œµ > 0
there exists an n0 ‚ààZ+ such that
n > n0 =‚áíŒº({x ‚ààX : | fn(x)‚àíf(x)| > Œµ}) < Œµ .
(1.1.13)

1.1 Lp and Weak Lp
7
Remark 1.1.8. The preceding deÔ¨Ånition is equivalent to the following statement:
For all Œµ > 0
lim
n‚Üí‚àûŒº({x ‚ààX : | fn(x)‚àíf(x)| > Œµ}) = 0.
(1.1.14)
Clearly (1.1.14) implies (1.1.13). To see the converse given Œµ > 0, pick 0 < Œ¥ < Œµ
and apply (1.1.13) for this Œ¥. There exists an n0 ‚ààZ+ such that
Œº({x ‚ààX : | fn(x)‚àíf(x)| > Œ¥}) < Œ¥
holds for n > n0. Since
Œº({x ‚ààX : | fn(x)‚àíf(x)| > Œµ}) ‚â§Œº({x ‚ààX : | fn(x)‚àíf(x)| > Œ¥}),
we conclude that
Œº({x ‚ààX : | fn(x)‚àíf(x)| > Œµ}) < Œ¥
for all n > n0. Let n ‚Üí‚àûto deduce that
limsup
n‚Üí‚àû
Œº({x ‚ààX : | fn(x)‚àíf(x)| > Œµ}) ‚â§Œ¥ .
(1.1.15)
Since (1.1.15) holds for all 0 < Œ¥ < Œµ, (1.1.14) follows by letting Œ¥ ‚Üí0.
Convergence in measure is a weaker notion than convergence in either Lp or Lp,‚àû,
0 < p ‚â§‚àû, as the following proposition indicates:
Proposition 1.1.9. Let 0 < p ‚â§‚àûand fn, f be in Lp,‚àû(X,Œº).
(1) If fn, f are in Lp and fn ‚Üíf in Lp, then fn ‚Üíf in Lp,‚àû.
(2) If fn ‚Üíf in Lp,‚àû, then fn converges to f in measure.
Proof. Fix 0 < p < ‚àû. Proposition 1.1.6 gives that for all Œµ > 0 we have
Œº({x ‚ààX : | fn(x)‚àíf(x)| > Œµ}) ‚â§1
Œµ p

X | fn ‚àíf|p dŒº .
This shows that convergence in Lp implies convergence in weak Lp. The case p = ‚àû
is tautological.
Given Œµ > 0 Ô¨Ånd an n0 such that for n > n0, we have
fn ‚àíf

Lp,‚àû= sup
Œ±>0
Œ±Œº({x ‚ààX : | fn(x)‚àíf(x)| > Œ±})
1
p < Œµ
1
p +1 .
Taking Œ± = Œµ, we conclude that convergence in Lp,‚àûimplies convergence in mea-
sure.
‚ñ°
Example 1.1.10. Note that there is no general converse of statement (2) in the pre-
ceding proposition. Fix 0 < p < ‚àûand on [0,1] deÔ¨Åne the functions
fk, j = k1/pœá( j‚àí1
k , j
k ),
k ‚â•1, 1 ‚â§j ‚â§k.

8
1 Lp Spaces and Interpolation
Consider the sequence {f1,1, f2,1, f2,2, f3,1, f3,2, f3,3,...}. Observe that
|{x : fk, j(x) > 0}| = 1/k.
Therefore, fk, j converges to 0 in measure. Likewise, observe that
fk, j

Lp,‚àû= sup
Œ±>0
Œ±|{x : fk, j(x) > Œ±}|1/p ‚â•sup
k‚â•1
(k ‚àí1/k)1/p
k1/p
= 1,
which implies that fk, j does not converge to 0 in Lp,‚àû.
It turns out that every sequence convergent in Lp(X,Œº) or in Lp,‚àû(X,Œº) has a
subsequence that converges a.e. to the same limit.
Theorem 1.1.11. Let fn and f be complex-valued measurable functions on a mea-
sure space (X,Œº) and suppose that fn converges to f in measure. Then some subse-
quence of fn converges to f Œº-a.e.
Proof. For all k = 1,2,... choose inductively nk such that
Œº({x ‚ààX : | fnk(x)‚àíf(x)| > 2‚àík}) < 2‚àík
(1.1.16)
and such that n1 < n2 < ¬∑¬∑¬∑ < nk < ¬∑¬∑¬∑. DeÔ¨Åne the sets
Ak = {x ‚ààX : | fnk(x)‚àíf(x)| > 2‚àík}.
Equation (1.1.16) implies that
Œº
 ‚àû

k=m
Ak

‚â§
‚àû
‚àë
k=m
Œº(Ak) ‚â§
‚àû
‚àë
k=m
2‚àík = 21‚àím
(1.1.17)
for all m = 1,2,3,.... It follows from (1.1.17) that
Œº
 ‚àû

k=1
Ak

‚â§1 < ‚àû.
(1.1.18)
Using (1.1.17) and (1.1.18), we conclude that the sequence of the measures of the sets
{‚àû
k=m Ak}‚àû
m=1 converges as m ‚Üí‚àûto
Œº
 ‚àû

m=1
‚àû

k=m
Ak

= 0.
(1.1.19)
To Ô¨Ånish the proof, observe that the null set in (1.1.19) contains the set of all x ‚ààX
for which fnk(x) does not converge to f(x).
‚ñ°
In many situations we are given a sequence of functions and we would like to
extract a convergent subsequence. One way to achieve this is via the next theorem,
which is a useful variant of Theorem 1.1.11. We Ô¨Årst give a relevant deÔ¨Ånition.

1.1 Lp and Weak Lp
9
DeÔ¨Ånition 1.1.12. We say that a sequence of measurable functions {fn} on the mea-
sure space (X,Œº) is Cauchy in measure if for every Œµ > 0, there exists an n0 ‚ààZ+
such that for n,m > n0 we have
Œº({x ‚ààX : | fm(x)‚àífn(x)| > Œµ}) < Œµ.
Theorem 1.1.13. Let (X,Œº) be a measure space and let {fn} be a complex-valued
sequence on X that is Cauchy in measure. Then some subsequence of fn converges
Œº-a.e.
Proof. The proof is very similar to that of Theorem 1.1.11. For all k = 1,2,... choose
nk inductively such that
Œº({x ‚ààX : | fnk(x)‚àífnk+1(x)| > 2‚àík}) < 2‚àík
(1.1.20)
and such that n1 < n2 < ¬∑¬∑¬∑ < nk < nk+1 < ¬∑¬∑¬∑. DeÔ¨Åne
Ak = {x ‚ààX : | fnk(x)‚àífnk+1(x)| > 2‚àík}.
As shown in the proof of Theorem 1.1.11, (1.1.20) implies that
Œº
 ‚àû

m=1
‚àû

k=m
Ak

= 0.
(1.1.21)
For x /‚àà‚àû
k=m Ak and i ‚â•j ‚â•j0 ‚â•m (and j0 large enough) we have
| fni(x)‚àífn j(x)| ‚â§
i‚àí1
‚àë
l= j
| fnl(x)‚àífnl+1(x)| ‚â§
i‚àí1
‚àë
l= j
2‚àíl ‚â§21‚àíj ‚â§21‚àíj0 .
This implies that the sequence {fni(x)}i is Cauchy for every x in the set (‚àû
k=m Ak)c
and therefore converges for all such x. We deÔ¨Åne a function
f(x) =
‚éß
‚é®
‚é©
lim
j‚Üí‚àûfn j(x)
when x /‚àà‚àû
m=1
‚àû
k=m Ak ,
0
when x ‚àà‚àû
m=1
‚àû
k=m Ak .
Then fn j ‚Üíf almost everywhere.
‚ñ°
1.1.3 A First Glimpse at Interpolation
It is a useful fact that if a function f is in Lp(X,Œº) and in Lq(X,Œº), then it also lies
in Lr(X,Œº) for all p < r < q. The usefulness of the spaces Lp,‚àûcan be seen from the
following sharpening of this statement:

10
1 Lp Spaces and Interpolation
Proposition 1.1.14. Let 0 < p < q ‚â§‚àûand let f in Lp,‚àû(X,Œº)‚à©Lq,‚àû(X,Œº), where
X is a œÉ-Ô¨Ånite measure space. Then f is in Lr(X,Œº) for all p < r < q and
f

Lr ‚â§

r
r ‚àíp +
r
q‚àír
1
r f

1r ‚àí1q
1p ‚àí1q
Lp,‚àû
 f

1p ‚àí1r
1p ‚àí1q
Lq,‚àû,
(1.1.22)
with the interpretation that 1/‚àû= 0.
Proof. Let us take Ô¨Årst q < ‚àû. We know that
df (Œ±) ‚â§min
f
p
Lp,‚àû
Œ± p
,
f
q
Lq,‚àû
Œ±q

.
(1.1.23)
Set
B =
 f
q
Lq,‚àû
 f
p
Lp,‚àû

1
q‚àíp
.
(1.1.24)
We now estimate the Lr norm of f. By (1.1.23), (1.1.24), and Proposition 1.1.4 we
have
 f
r
Lr(X,Œº) = r
 ‚àû
0 Œ±r‚àí1df (Œ±)dŒ±
‚â§r
 ‚àû
0 Œ±r‚àí1 min
f
p
Lp,‚àû
Œ± p
,
f
q
Lq,‚àû
Œ±q

dŒ±
= r
 B
0 Œ±r‚àí1‚àípf
p
Lp,‚àûdŒ± +r
 ‚àû
B Œ±r‚àí1‚àíq f
q
Lq,‚àûdŒ±
=
r
r ‚àíp
f
p
Lp,‚àûBr‚àíp +
r
q‚àír
f
q
Lq,‚àûBr‚àíq
=

r
r ‚àíp +
r
q‚àír
f
p
Lp,‚àû
 q‚àír
q‚àíp f
q
Lq,‚àû
 r‚àíp
q‚àíp .
(1.1.25)
Observe that the integrals converge, since r ‚àíp > 0 and r ‚àíq < 0.
The case q = ‚àûis easier. Since df (Œ±) = 0 for Œ± > ‚à•f‚à•L‚àûwe need to use only
the inequality df (Œ±) ‚â§Œ±‚àíp‚à•f‚à•p
Lp,‚àûfor Œ± ‚â§‚à•f‚à•L‚àûin estimating the Ô¨Årst integral in
(1.1.25). We obtain
 f
r
Lr ‚â§
r
r ‚àíp
 f
p
Lp,‚àû
f
r‚àíp
L‚àû,
which is nothing other than (1.1.22) when q = ‚àû. This completes the proof.
‚ñ°
Note that (1.1.22) holds with constant 1 if Lp,‚àûand Lq,‚àûare replaced by Lp and
Lq, respectively. It is often convenient to work with functions that are only locally in
some Lp space. This leads to the following deÔ¨Ånition.
DeÔ¨Ånition 1.1.15. For 0 < p < ‚àû, the space Lp
loc(Rn,| ¬∑ |) or simply Lp
loc(Rn) is the
set of all Lebesgue-measurable functions f on Rn that satisfy

K | f(x)|p dx < ‚àû
(1.1.26)

1.1 Lp and Weak Lp
11
for any compact subset K of Rn. Functions that satisfy (1.1.26) with p = 1 are called
locally integrable functions on Rn.
The union of all Lp(Rn) spaces for 1 ‚â§p ‚â§‚àûis contained in L1
loc(Rn). More
generally, for 0 < p < q < ‚àûwe have the following:
Lq(Rn) ‚´ÖLq
loc(Rn) ‚´ÖLp
loc(Rn).
Functions in Lp(Rn) for 0 < p < 1 may not be locally integrable. For example,
take f(x) = |x|‚àín‚àíŒ±œá|x|‚â§1, which is in Lp(Rn) when Œ± > 0 and p < n/(n+Œ±), and
observe that f is not integrable over any open set in Rn containing the origin.
Exercises
1.1.1. Suppose f and fn are measurable functions on (X,Œº). Prove that
(a) df is right continuous on [0,‚àû).
(b) If | f| ‚â§liminfn‚Üí‚àû| fn| Œº-a.e., then df ‚â§liminfn‚Üí‚àûdfn.
(c) If | fn| ‚Üë| f|, then dfn ‚Üëdf .

Hint: Part (a): Let tn be a decreasing sequence of positive numbers that tends to
zero. Show that df (Œ±0 + tn) ‚Üëdf (Œ±0) using a convergence theorem. Part (b): Let
E = {x ‚ààX : | f(x)| > Œ±} and En = {x ‚ààX : | fn(x)| > Œ±}. Use that Œº
‚àû
n=m En

‚â§
liminf
n‚Üí‚àûŒº(En) and E ‚´Ö‚àû
m=1
‚àû
n=m En Œº-a.e.

1.1.2. (H¬®older‚Äôs inequality) Let 0 < p, p1,..., pk ‚â§‚àû, where k ‚â•2, and let f j be in
Lp j = Lp j(X,Œº). Assume that
1
p = 1
p1
+¬∑¬∑¬∑+ 1
pk
.
(a) Show that the product f1 ¬∑¬∑¬∑ fk is in Lp and that
 f1 ¬∑¬∑¬∑ fk

Lp ‚â§
f1

Lp1 ¬∑¬∑¬∑
fk

Lpk .
(b) When no pj is inÔ¨Ånite, show that if equality holds in part (a), then it must be the
case that c1| f1|p1 = ¬∑¬∑¬∑ = ck| fk|pk Œº-a.e. for some cj ‚â•0.
(c) Let 0 < q < 1 and q‚Ä≤ =
q
q‚àí1. For r < 0 and g > 0 almost everywhere, deÔ¨Åne
‚à•g‚à•Lr = ‚à•g‚àí1‚à•‚àí1
L|r|. Show that if g is strictly positive Œº-a.e. and lies in Lq‚Ä≤ and f is
measurable such that fg belongs to L1, we have
 fg

L1 ‚â•
 f

Lq
g

Lq‚Ä≤ .
1.1.3. Let (X,Œº) be a measure space.
(a) If f is in Lp0(X,Œº) for some p0 < ‚àû, prove that
lim
p‚Üí‚àû
f

Lp =
 f

L‚àû.

12
1 Lp Spaces and Interpolation
(b) (Jensen‚Äôs inequality) Suppose that Œº(X) = 1. Show that
f

Lp ‚â•exp

X log| f(x)|dŒº(x)

for all 0 < p < ‚àû.
(c) If Œº(X) = 1 and f is in some Lp0(X,Œº) for some p0 > 0, then
lim
p‚Üí0
 f

Lp = exp

X log| f(x)|dŒº(x)

with the interpretation e‚àí‚àû= 0.

Hint: Part (a): If 0 < ‚à•f‚à•L‚àû< ‚àû, use that ‚à•f‚à•Lp ‚â§‚à•f‚à•(p‚àíp0)/p
L‚àû
‚à•f‚à•p0/p
Lp0
to obtain
limsupp‚Üí‚àû‚à•f‚à•Lp ‚â§‚à•f‚à•L‚àû. Conversely, let EŒ≥ = {x ‚ààX : | f(x)| > Œ≥‚à•f‚à•L‚àû} for Œ≥ in
(0,1). Then Œº(EŒ≥) > 0, ‚à•f‚à•Lp0(EŒ≥) > 0, and ‚à•f‚à•Lp ‚â•

Œ≥‚à•f‚à•L‚àû(p‚àíp0)/p‚à•f‚à•p0/p
Lp0(EŒ≥),
hence liminfp‚Üí‚àû‚à•f‚à•Lp ‚â•Œ≥‚à•f‚à•L‚àû. If ‚à•f‚à•L‚àû= ‚àû, set Gn = {| f| > n} and use that
‚à•f‚à•Lp ‚â•‚à•f‚à•Lp(Gn) ‚â•nŒº(Gn)
1
p to obtain liminfp‚Üí‚àû‚à•f‚à•Lp ‚â•n. Part (b) is a direct
consequence of Jensen‚Äôs inequality

X log|h|dŒº ‚â§log

X |h|dŒº

. Part (c): Fix a
sequence 0 < pn < p0 such that pn ‚Üì0 and deÔ¨Åne
hn(x) = 1
p0
(| f(x)|p0 ‚àí1)‚àí1
pn
(| f(x)|pn ‚àí1).
Use that 1
p(t p ‚àí1) ‚Üìlogt as p ‚Üì0 for all t > 0. The Lebesgue monotone convergence
theorem yields

X hn dŒº ‚Üë

X hdŒº, hence

X
1
pn (| f|pn ‚àí1)dŒº ‚Üì

X log| f|dŒº, where
the latter could be ‚àí‚àû. Use
exp

X log| f|dŒº

‚â§

X | f|pn dŒº
 1
pn
‚â§exp

X
1
pn
(| f|pn ‚àí1)dŒº

to complete the proof.

1.1.4. Let aj be a sequence of positive reals. Show that
(a)

‚àë‚àû
j=1 aj
Œ∏ ‚â§‚àë‚àû
j=1 aŒ∏
j , for any 0 ‚â§Œ∏ ‚â§1.
(b) ‚àë‚àû
j=1 aŒ∏
j ‚â§

‚àë‚àû
j=1 aj
Œ∏, for any 1 ‚â§Œ∏ < ‚àû.
(c)

‚àëN
j=1 aj
Œ∏ ‚â§NŒ∏‚àí1 ‚àëN
j=1 aŒ∏
j , when 1 ‚â§Œ∏ < ‚àû.
(d) ‚àëN
j=1 aŒ∏
j ‚â§N1‚àíŒ∏
‚àëN
j=1 aj
Œ∏, when 0 ‚â§Œ∏ ‚â§1.
1.1.5. Let {f j}N
j=1 be a sequence of Lp(X,Œº) functions.
(a) (Minkowski‚Äôs inequality) For 1 ‚â§p ‚â§‚àûshow that

N
‚àë
j=1
f j

Lp ‚â§
N
‚àë
j=1
 f j

Lp .

1.1 Lp and Weak Lp
13
(b) (Reverse Minkowski inequality) For 0 < p < 1 and f j ‚â•0 prove that
N
‚àë
j=1
f j

Lp ‚â§

N
‚àë
j=1
f j

Lp .
(c) For 0 < p < 1 show that

N
‚àë
j=1
f j

Lp ‚â§N
1‚àíp
p
N
‚àë
j=1
f j

Lp .
(d) The constant N
1‚àíp
p
in part (c) is best possible.

Hint: Part (c): Use Exercise 1.1.4 (c). Part (d): Take {f j}N
j=1 to be characteristic
functions of disjoint sets with the same measure.

1.1.6. (a) (Minkowski‚Äôs integral inequality) Let (X,Œº) and (T,ŒΩ) be two œÉ-Ô¨Ånite
measure spaces and let 1 ‚â§p < ‚àû. Show that for every nonnegative measurable
function F on the product space (X,Œº)√ó(T,ŒΩ) we have

T

X F(x,t)dŒº(x)
p
dŒΩ(t)
 1
p
‚â§

X

T F(x,t)p dŒΩ(t)
 1
p
dŒº(x),
(b) State and prove an analogous inequality when p = ‚àû.
(c) Prove that when 0 < p < 1, then the preceding inequality is reversed.
(d) (Y. Sawano) Consider the example X = T = [0,1], Œº is counting measure, ŒΩ is
Lebesgue measure, F(x,t) = 1 when x = t and zero otherwise. What is the relevance
of this example with the inequalities in (a) and (b)?

Hint: Part (a) Split the power p as 1 + (p ‚àí1) and apply H¬®older‚Äôs inequality with
exponents p and p‚Ä≤. Part (b) Let p ‚Üí‚àûon subsets of X with Ô¨Ånite measure.

1.1.7. Let f1,..., fN be in Lp,‚àû(X,Œº).
(a) Prove that for 1 ‚â§p < ‚àûwe have

N
‚àë
j=1
f j

Lp,‚àû‚â§N
N
‚àë
j=1
f j

Lp,‚àû.
(b) Show that for 0 < p < 1 we have

N
‚àë
j=1
f j

Lp,‚àû‚â§N
1
p
N
‚àë
j=1
f j

Lp,‚àû.

Hint: Use that Œº({| f1 + ¬∑¬∑¬∑ + fN| > Œ±}) ‚â§‚àëN
j=1 Œº({| f j| > Œ±/N}) and Exercise
1.1.4 (a) and (c).

1.1.8. Let 0 < p < ‚àû. Prove that Lp(X,Œº) is a complete quasi-normed space. This
means that every quasi-norm Cauchy sequence is quasi-norm convergent.

14
1 Lp Spaces and Interpolation

Hint: Let fn be a Cauchy sequence in Lp. Pass to a subsequence {ni}i such that
‚à•fni+1 ‚àífni‚à•Lp ‚â§2‚àíi. Then the series f = fn1 +‚àë‚àû
i=1( fni+1 ‚àífni) converges in Lp.

1.1.9. Let (X,Œº) be a measure space with Œº(X) < ‚àû. Suppose that a sequence of
measurable functions fn on X converges to f Œº-a.e. Prove that fn converges to f in
measure.

Hint: For Œµ > 0,
	
x ‚ààX : fn(x) ‚Üíf(x)} ‚´Ö
‚àû
m=1
‚àû
n=m
{x ‚ààX : | fn(x)‚àíf(x)| < Œµ

.

1.1.10. Let f be a measurable function on (X,Œº) such such df (Œ±) < ‚àûfor all Œ± > 0.
Fix Œ≥ > 0 and deÔ¨Åne fŒ≥ = f œá| f|>Œ≥ and f Œ≥ = f ‚àífŒ≥ = f œá| f|‚â§Œ≥.
(a) Prove that
dfŒ≥(Œ±) =

df (Œ±)
when
Œ± > Œ≥,
df (Œ≥)
when
Œ± ‚â§Œ≥,
df Œ≥(Œ±) =

0
when
Œ± ‚â•Œ≥,
df (Œ±)‚àídf (Œ≥)
when
Œ± < Œ≥.
(b) If f ‚ààLp(X,Œº) then
fŒ≥
p
Lp = p
 ‚àû
Œ≥ Œ± p‚àí1df (Œ±)dŒ± +Œ≥ pdf (Œ≥),
f Œ≥p
Lp = p
 Œ≥
0 Œ± p‚àí1df (Œ±)dŒ± ‚àíŒ≥ pdf (Œ≥),

Œ≥<| f|‚â§Œ¥ | f|p dŒº = p
 Œ¥
Œ≥ df (Œ±)Œ± p‚àí1 dŒ± ‚àíŒ¥ pdf (Œ¥)+Œ≥ pdf (Œ≥).
(c) If f is in Lp,‚àû(X,Œº) prove that f Œ≥ is in Lq(X,Œº) for any q > p and fŒ≥ is in
Lq(X,Œº) for any q < p. Thus Lp,‚àû‚´ÖLp0 +Lp1 when 0 < p0 < p < p1 ‚â§‚àû.
1.1.11. Let (X,Œº) be a measure space and let E be a subset of X with Œº(E) < ‚àû.
Assume that f is in Lp,‚àû(X,Œº) for some 0 < p < ‚àû.
(a) Show that for 0 < q < p we have

E | f(x)|q dŒº(x) ‚â§
p
p‚àíqŒº(E)1‚àíq
p f
q
Lp,‚àû.
(b) Conclude that if Œº(X) < ‚àûand 0 < q < p, then
Lp(X,Œº) ‚´ÖLp,‚àû(X,Œº) ‚´ÖLq(X,Œº).

Hint: Part (a): Use Œº

E ‚à©{| f| > Œ±}

‚â§min

Œº(E),Œ±‚àípf
p
Lp,‚àû

.

1.1.12. (Normability of weak Lp for p > 1) Let (X,Œº) be a œÉ-Ô¨Ånite measure space
and let 0 < p < ‚àû. Pick 0 < r < p and deÔ¨Åne
‚èê‚èê‚èê‚èê‚èê‚èêf
‚èê‚èê‚èê‚èê‚èê‚èê
Lp,‚àû=
sup
0<Œº(E)<‚àû
Œº(E)‚àí1
r + 1
p

E | f|rdŒº
 1
r
,

1.1 Lp and Weak Lp
15
where the supremum is taken over all measurable subsets E of X of Ô¨Ånite measure.
(a) Use Exercise 1.1.11 with q = r to conclude that
‚èê‚èê‚èê‚èê‚èê‚èêf
‚èê‚èê‚èê‚èê‚èê‚èê
Lp,‚àû‚â§

p
p‚àír
 1
r f

Lp,‚àû
for all f in Lp,‚àû(X,Œº). (It is not needed that X be œÉ-Ô¨Ånite here).
(b) Prove that for all f in Lp,‚àû(X,Œº) we have
f

Lp,‚àû‚â§
‚èê‚èê‚èê‚èê‚èê‚èêf
‚èê‚èê‚èê‚èê‚èê‚èê
Lp,‚àû.
(Y. Oi) Notice that if X = {1,2}, Œº({1}) = 1, Œº({2}) = ‚àû, then X is not œÉ-Ô¨Ånite,
and verify that for the function f = 1 the preceding inequality fails.
(c) Show that Lp,‚àû(X,Œº) is metrizable for all 0 < p < ‚àû, i.e., there is a metric on the
space that generates the same topology as the quasi-norm. Also show that Lp,‚àû(X,Œº)
is normable when p > 1, i.e., there is a norm on the space equivalent to ‚à•¬∑‚à•Lp,‚àû.
(d) Use the characterization of the weak Lp quasi-norm obtained in parts (a) and (b)
to prove Fatou‚Äôs lemma for this space: For all measurable functions gn on X we have
liminf
n‚Üí‚àû|gn|

Lp,‚àû‚â§Cp liminf
n‚Üí‚àû
gn

Lp,‚àû
for some constant Cp that depends only on p ‚àà(0,‚àû).

Hint: Part (b): Write X = ‚àû
k=1 Xk with Œº(Xk) < ‚àûand take E = {| f| > Œ±}‚à©Xk.

1.1.13. Consider the N! functions on the line
fœÉ =
N
‚àë
j=1
N
œÉ( j)œá[ j‚àí1
N , j
N ) ,
where œÉ is a permutation of the set {1,2,...,N}.
(a) Show that each fœÉ satisÔ¨Åes ‚à•fœÉ‚à•L1,‚àû= 1.
(b) Show that ‚à•‚àëœÉ‚ààSN fœÉ‚à•L1,‚àû= N!

1+ 1
2 +¬∑¬∑¬∑+ 1
N

.
(c) Conclude that the space L1,‚àû(R) is not normable (this means that ‚à•¬∑‚à•L1,‚àûis not
equivalent to a norm).
(d) Use a similar argument to prove that L1,‚àû(Rn) is not normable by considering
the functions
fœÉ(x1,...,xn) =
N
‚àë
j1=1
¬∑¬∑¬∑
N
‚àë
jn=1
Nn
œÉ(œÑ( j1,..., jn))œá[ j1‚àí1
N
, j1
N )(x1)¬∑¬∑¬∑œá[ jn‚àí1
N
, jn
N )(xn),
where œÉ is a permutation of the set {1,2,...,Nn} and œÑ is a Ô¨Åxed injective map
from the set of all n-tuples of integers with coordinates 1 ‚â§j ‚â§N onto the set
{1,2,...,Nn}. One may take
œÑ( j1,..., jn) = j1 +N( j2 ‚àí1)+N2( j3 ‚àí1)+¬∑¬∑¬∑+Nn‚àí1( jn ‚àí1),
for instance.

16
1 Lp Spaces and Interpolation
1.1.14. Let (X,Œº) be a measure space and let s > 0.
(a) Let f be a measurable function on X. Show that if 0 < p < q < ‚àûwe have

| f|‚â§s | f|q dŒº ‚â§
q
q‚àíp sq‚àíp f
p
Lp,‚àû.
(b) Let f j, 1 ‚â§j ‚â§m, be measurable functions on X and let 0 < p < ‚àû. Show that
 max
1‚â§j‚â§m| f j|

p
Lp,‚àû‚â§
m
‚àë
j=1
f j
p
Lp,‚àû.
(c) Conclude from part (b) that for 0 < p < 1 we have
f1 +¬∑¬∑¬∑+ fm
p
Lp,‚àû‚â§2‚àíp
1‚àíp
m
‚àë
j=1
f j
p
Lp,‚àû.
The latter estimate is referred to as the p-normability of weak Lp.

Hint: Part (a): Use the distribution function. Part (c): First obtain the estimate
df1+¬∑¬∑¬∑+ fm(Œ±) ‚â§Œº({| f1+¬∑¬∑¬∑+ fm|>Œ±,max| f j|‚â§Œ±})+dmaxj | f j|(Œ±)
for all Œ± > 0 and then use part (b).

1.1.15. (H¬®older‚Äôs inequality for weak spaces) Let f j be in Lp j,‚àûof a measure space
X where 0 < pj < ‚àûand 1 ‚â§j ‚â§k. Let
1
p = 1
p1
+¬∑¬∑¬∑+ 1
pk
.
Prove that
f1 ¬∑¬∑¬∑ fk

Lp,‚àû‚â§p‚àí1
p
k
‚àè
j=1
p
1
p j
j
k
‚àè
j=1
f j

Lp j,‚àû.

Hint: Take ‚à•f j‚à•Lp j,‚àû= 1 for all j. Control df1¬∑¬∑¬∑fk(Œ±) by
Œº({| f1|>Œ±/s1})+¬∑¬∑¬∑+ Œº({| fk‚àí1|>sk‚àí2/sk‚àí1})+ Œº({| fk|>sk‚àí1})
‚â§(s1/Œ±)p1 +(s2/s1)p2 +¬∑¬∑¬∑+(sk‚àí1/sk‚àí2)pk‚àí1 +(1/sk‚àí1)pk .
Set x1 = s1/Œ±, x2 = s2/s1,...,xk = 1/sk‚àí1. Minimize xp1
1 +¬∑¬∑¬∑+xpk
k subject to the
constraint x1 ¬∑¬∑¬∑xk = 1/Œ±.

1.1.16. Let 0 < p0 < p < p1 ‚â§‚àûand let 1
p = 1‚àíŒ∏
p0 + Œ∏
p1 for some Œ∏ ‚àà[0,1]. Prove
the following:
f

Lp ‚â§
 f
1‚àíŒ∏
Lp0
f
Œ∏
Lp1 ,
f

Lp,‚àû‚â§
 f
1‚àíŒ∏
Lp0,‚àû
f
Œ∏
Lp1,‚àû.

1.2 Convolution and Approximate Identities
17
1.1.17. ([231]) Follow the steps below to prove the isoperimetric inequality. For
n ‚â•2 and 1 ‚â§j ‚â§n deÔ¨Åne the projection maps œÄ j : Rn ‚ÜíRn‚àí1 by setting for
x = (x1,...,xn),
œÄ j(x) = (x1,...,xj‚àí1,xj+1,...,xn),
with the obvious interpretations when j = 1 or j = n.
(a) For maps f j : Rn‚àí1 ‚ÜíC prove that
Œõ( f1,..., fn) =

Rn
n
‚àè
j=1
f j ‚ó¶œÄ j
dx ‚â§
n
‚àè
j=1
f j

Ln‚àí1(Rn‚àí1) .
(b) Let Œ© be a compact set with a rectiÔ¨Åable boundary in Rn where n ‚â•2. Show
that there is a constant cn independent of Œ© such that
|Œ©| ‚â§cn|‚àÇŒ©|
n
n‚àí1 ,
where the expression |‚àÇŒ©| denotes the (n‚àí1)-dimensional surface measure of the
boundary of Œ©.

Hint: Part (a): Use induction starting with n = 2. For n ‚â•3 write
Œõ( f1,..., fn) ‚â§

Rn‚àí1 P(x1,...,xn‚àí1)| fn(œÄn(x))|dx1 ¬∑¬∑¬∑dxn‚àí1
‚â§‚à•P‚à•
L
n‚àí1
n‚àí2 (Rn‚àí1)
fn ‚ó¶œÄn

Ln‚àí1(Rn‚àí1) ,
where P(x1,...,xn‚àí1) =

R | f1(œÄ1(x))¬∑¬∑¬∑ fn‚àí1(œÄn‚àí1(x))|dxn, and apply the induc-
tion hypothesis to the n‚àí1 functions

R f j(œÄ j(x))n‚àí1 dxn

1
n‚àí2
,
for j = 1,...,n‚àí1, to obtain the required conclusion. Part (b): Specialize part (a) to
the case f j = œáœÄ j[Œ©] to obtain
|Œ©| ‚â§|œÄ1[Œ©]|
1
n‚àí1 ¬∑¬∑¬∑|œÄn[Œ©]|
1
n‚àí1
and then use that |œÄ j[Œ©]| ‚â§1
2|‚àÇŒ©|.

1.2 Convolution and Approximate Identities
The notion of convolution can be deÔ¨Åned on measure spaces endowed with a group
structure. It turns out that the most natural environment to deÔ¨Åne convolution is the
context of topological groups. Although the focus of this book is harmonic analysis
on Euclidean spaces, we develop the notion of convolution on general groups. This
allows us to study this concept on Rn, Zn, and Tn, in a uniÔ¨Åed way. Moreover,

18
1 Lp Spaces and Interpolation
since the basic properties of convolutions and approximate identities do not require
commutativity of the group operation, we may assume that the underlying groups
are not necessarily abelian. Thus, the results in this section can be also applied to
nonabelian structures such as the Heisenberg group.
1.2.1 Examples of Topological Groups
A topological group G is a Hausdorff topological space that is also a group with law
(x,y) ‚Üíxy
(1.2.1)
such that the maps (x,y) ‚Üíxy and x ‚Üíx‚àí1 are continuous. The identity element of
the group is the unique element e with the property xe = ex = x for all x ‚ààG. We
adopt the standard notation
AB = {ab : a ‚ààA,b ‚ààB},
A‚àí1 = {a‚àí1 : a ‚ààA}
for subsets A and B of G. Note that (AB)‚àí1 = B‚àí1A‚àí1. Every topological group
G has an open basis at e consisting of symmetric neighborhoods, i.e., open sets U
satisfying U = U‚àí1. A topological group is called locally compact if there is an
open set U containing the identity element such that U is compact. Then every point
in the group has an open neighborhood with compact closure.
Let G be a locally compact group. It is known that G possesses a positive measure
Œª on the Borel sets that is nonzero on all nonempty open sets, Ô¨Ånite on compact sets,
and is left invariant, meaning that
Œª(tA) = Œª(A),
(1.2.2)
for all measurable sets A and all t ‚ààG. Such a measure Œª is called a (left) Haar
measure on G. Similarly, G possesses a right Haar measure which is right invariant,
i.e., Œª(At) = Œª(A) for all measurable A ‚´ÖG and all t ‚ààG. For the existence of Haar
measure we refer to [152, ¬ß15] or [213, ¬ß16.3]. Furthermore, Haar measure is unique
up to positive multiplicative constants. If G is abelian then any left Haar measure on
G is a constant multiple of any given right Haar measure on G. A locally compact
group which is a countable union of compact subsets is a œÉ-Ô¨Ånite measure space
under left or right Haar measure. This is case for connected locally compact groups.
Example 1.2.1. The standard examples are provided by the spaces Rn and Zn with
the usual topology and the usual addition of n-tuples. Another example is the space
Tn = Rn/Zn deÔ¨Åned as follows:
Tn = [0,1)√ó¬∑¬∑¬∑√ó[0,1)


 
n times

1.2 Convolution and Approximate Identities
19
with the usual topology and group law:
(x1,...,xn)+(y1,...,yn) = ((x1 +y1) mod1,...,(xn +yn) mod1).
Example 1.2.2. Let G = R‚àó= R\{0} with group law the usual multiplication. It is
easy to verify that the measure Œª = dx/|x| is invariant under multiplicative transla-
tions, that is,
 ‚àû
‚àí‚àûf(tx) dx
|x| =
 ‚àû
‚àí‚àûf(x) dx
|x| ,
for all f in L1(G,Œº) and all t ‚ààR‚àó. Therefore, dx/|x| is a Haar measure. [Taking
f = œáA gives Œª(tA) = Œª(A).]
Example 1.2.3. Similarly, on the multiplicative group G = R+, a Haar measure is
dx/x.
Example 1.2.4. Counting measure is a Haar measure on the group Zn with the usual
addition as group operation.
Example 1.2.5. The Heisenberg group Hn is the set Cn√óR with the group operation
(z1,...,zn,t)(w1,...,wn,s) =

z1 +w1,...,zn +wn,t +s+2Im
n
‚àë
j=1
z jwj

.
It can easily be seen that the identity element e of this group is 0 ‚ààCn √ó R and
(z1,...,zn,t)‚àí1 = (‚àíz1,...,‚àízn,‚àít). Topologically the Heisenberg group is identi-
Ô¨Åed with Cn √óR, and both left and right Haar measure on Hn is Lebesgue measure.
The norm
|(z1,...,zn,t)| =
 n
‚àë
j=1
|z j|22
+t2
 1
4
introduces balls Br(x) = {y ‚ààHn : |y‚àí1x| < r} on the Heisenberg group that are quite
different from Euclidean balls. For x close to the origin, the balls Br(x) are not far
from being Euclidean, but for x far away from e = 0 they look like slanted truncated
cylinders. The Heisenberg group can be naturally identiÔ¨Åed as the boundary of the
unit ball in Cn and plays an important role in quantum mechanics.
1.2.2 Convolution
Throughout the rest of this section, we Ô¨Åx a locally compact group G and a left
invariant Haar measure Œª on G. We assume that G is a countable union of compact
subsets, hence the pair (G,Œª) forms a œÉ-Ô¨Ånite measure space. The spaces Lp(G,Œª)
and Lp,‚àû(G,Œª) are simply denoted by Lp(G) and Lp,‚àû(G).

20
1 Lp Spaces and Interpolation
Left invariance of Œª is equivalent to the fact that for all t ‚ààG and all nonnegative
measurable functions f on G we have

G f(tx)dŒª(x) =

G f(x)dŒª(x).
(1.2.3)
Equation (1.2.3) is a restatement of (1.2.2) if f is a characteristic function. Obviously
(1.2.3) also holds for f ‚ààL1(G) by linearity and approximation.
We are now ready to deÔ¨Åne the operation of convolution.
DeÔ¨Ånition 1.2.6. Let f, g be in L1(G). DeÔ¨Åne the convolution f ‚àóg by
( f ‚àóg)(x) =

G f(y)g(y‚àí1x)dŒª(y).
(1.2.4)
For instance, if G = Rn with the usual additive structure, then y‚àí1 = ‚àíy and the
integral in (1.2.4) is written as
( f ‚àóg)(x) =

Rn f(y)g(x‚àíy)dy.
Remark 1.2.7. The right-hand side of (1.2.4) is deÔ¨Åned a.e., since the following
double integral converges absolutely:

G

G | f(y)||g(y‚àí1x)|dŒª(y)dŒª(x)
=

G

G | f(y)||g(y‚àí1x)|dŒª(x)dŒª(y)
=

G | f(y)|

G |g(y‚àí1x)|dŒª(x)dŒª(y)
=

G | f(y)|

G |g(x)|dŒª(x)dŒª(y)
by (1.2.2)
=
f

L1(G)
g

L1(G) < +‚àû.
The change of variables z = x‚àí1y yields that (1.2.4) is in fact equal to
( f ‚àóg)(x) =

G f(xz)g(z‚àí1)dŒª(z),
(1.2.5)
where the substitution of dŒª(y) by dŒª(z) is justiÔ¨Åed by left invariance.
Example 1.2.8. On R let f(x) = 1 when ‚àí1 ‚â§x ‚â§1 and zero otherwise. We see
that ( f ‚àóf)(x) is equal to the length of the intersection of the intervals [‚àí1,1] and
[x ‚àí1,x + 1]. It follows that ( f ‚àóf)(x) = 2 ‚àí|x| for |x| ‚â§2 and zero otherwise.
Observe that f ‚àóf is a smoother function than f. Similarly, we obtain that f ‚àóf ‚àóf
is a smoother function than f ‚àóf.
There is an analogous calculation when g is the characteristic function of the unit
disk B(0,1) in R2. A simple computation gives

1.2 Convolution and Approximate Identities
21
(g‚àóg)(x) =
B

0,1

‚à©B

x,1
 =
 +
!
1‚àí1
4 |x|2
‚àí
!
1‚àí1
4 |x|2

2
"
1‚àít2 ‚àí|x|

dt
= 2arcsin
!
1‚àí1
4|x|2

‚àí|x|
!
1‚àí1
4|x|2
when x = (x1,x2) in R2 satisÔ¨Åes |x| ‚â§2, while (g‚àóg)(x) = 0 if |x| ‚â•2.
A calculation similar to that in Remark 1.2.7 yields that
f ‚àóg

L1(G) ‚â§
f

L1(G)
g

L1(G) ,
(1.2.6)
that is, the convolution of two integrable functions is also an integrable function
with L1 norm less than or equal to the product of the L1 norms.
Proposition 1.2.9. For all f, g, h in L1(G), the following properties are valid:
(1) f ‚àó(g‚àóh) = ( f ‚àóg)‚àóh (associativity)
(2) f ‚àó(g+h) = f ‚àóg+ f ‚àóh and ( f +g)‚àóh = f ‚àóh+g‚àóh (distributivity)
Proof. The easy proofs are omitted.
‚ñ°
Proposition 1.2.9 implies that L1(G) is a (not necessarily commutative) Banach
algebra under the convolution product.
1.2.3 Basic Convolution Inequalities
The most fundamental inequality involving convolutions is the following.
Theorem 1.2.10. (Minkowski‚Äôs inequality) Let 1 ‚â§p ‚â§‚àû. For f in Lp(G) and g in
L1(G) we have that g‚àóf exists Œª-a.e. and satisÔ¨Åes
g‚àóf

Lp(G) ‚â§
g

L1(G)
f

Lp(G) .
(1.2.7)
Proof. Estimate (1.2.7) follows directly from Exercise 1.1.6. Here we give a direct
proof. We may assume that 1 < p < ‚àû, since the cases p = 1 and p = ‚àûare simple.
We Ô¨Årst show that the convolution |g|‚àó| f| exists Œª-a.e. Indeed,
(|g|‚àó| f|)(x) =

G | f(y‚àí1x)||g(y)|dŒª(y).
(1.2.8)
Apply H¬®older‚Äôs inequality in (1.2.8) with respect to the measure |g(y)|dŒª(y) to the
functions y ‚Üíf(y‚àí1x) and 1 with exponents p and p‚Ä≤ = p/(p‚àí1), respectively. We
obtain
(|g|‚àó| f|)(x) ‚â§

G | f(y‚àí1x)|p|g(y)|dŒª(y)
1
p 
G |g(y)|dŒª(y)
1
p‚Ä≤
.
(1.2.9)

22
1 Lp Spaces and Interpolation
Taking Lp norms of both sides of (1.2.9) we deduce
|g|‚àó| f|

Lp ‚â§
g
p‚àí1
L1

G

G | f(y‚àí1x)|p|g(y)|dŒª(y)dŒª(x)
1
p
=
g
p‚àí1
L1

G

G | f(y‚àí1x)|p dŒª(x)|g(y)|dŒª(y)
1
p
=
g
p‚àí1
L1

G

G | f(x)|p dŒª(x)|g(y)|dŒª(y)
1
p
by (1.2.3)
=
 f
p
Lp
g

L1
g
p‚àí1
L1
1
p
=
 f

Lp
g

L1 < ‚àû,
where the second equality follows by Fubini‚Äôs theorem. This shows that |g| ‚àó| f| is
Ô¨Ånite Œª-a.e. and satisÔ¨Åes (1.2.7); then g ‚àóf exists Œª-a.e. and also satisÔ¨Åes (1.2.7),
since |g‚àóf| ‚â§|g|‚àó| f|.
‚ñ°
Remark 1.2.11. Theorem 1.2.10 may fail for nonabelian groups if g ‚àóf is replaced
by f ‚àóg in (1.2.7). Note, however, that if for all h ‚ààL1(G) we have
h

L1 =
#h

L1 ,
(1.2.10)
where #h(x) = h(x‚àí1), then (1.2.7) holds when the quantity ‚à•g ‚àóf‚à•Lp(G) is replaced
by ‚à•f ‚àóg‚à•Lp(G). To see this, observe that if (1.2.10) holds, then we can use (1.2.5) to
conclude that if f in Lp(G) and g in L1(G), then
f ‚àóg

Lp(G) ‚â§
g

L1(G)
f

Lp(G) .
(1.2.11)
If the left Haar measure satisÔ¨Åes
Œª(A) = Œª(A‚àí1)
(1.2.12)
for all measurable A ‚´ÖG, then (1.2.10) holds and thus (1.2.11) is satisÔ¨Åed for all g in
L1(G) and f ‚ààLp(G). This is, for instance, the case for the Heisenberg group Hn.
Minkowski‚Äôs inequality (1.2.11) is only a special case of Young‚Äôs inequality in
which the function g can be in any space Lr(G) for 1 ‚â§r ‚â§‚àû.
Theorem 1.2.12. (Young‚Äôs inequality) Let 1 ‚â§p,q,r ‚â§‚àûsatisfy
1
q +1 = 1
p + 1
r .
(1.2.13)
Then for all f in Lp(G) and all g in Lr(G) satisfying
g

Lr(G) =
#g

Lr(G) we have
f ‚àóg exists Œª-a.e. and satisÔ¨Åes
f ‚àóg

Lq(G) ‚â§
g

Lr(G)
f

Lp(G) .
(1.2.14)

1.2 Convolution and Approximate Identities
23
Proof. Young‚Äôs inequality is proved in a way similar to Minkowski‚Äôs inequality. We
do a suitable splitting of the product | f(y)||g(y‚àí1x)| and apply H¬®older‚Äôs inequality.
Observe that when r < ‚àû, the hypotheses on the indices imply that
1
r‚Ä≤ + 1
q + 1
p‚Ä≤ = 1,
p
q + p
r‚Ä≤ = 1,
r
q + r
p‚Ä≤ = 1.
Using H¬®older‚Äôs inequality with exponents r‚Ä≤, q, and p‚Ä≤, we obtain
|(| f|‚àó|g|)(x)| ‚â§

G | f(y)||g(y‚àí1x)|dŒª(y)
=

G | f(y)|
p
r‚Ä≤ 
| f(y)|
p
q |g(y‚àí1x)|
r
q 
|g(y‚àí1x)|
r
p‚Ä≤ dŒª(y)
‚â§
 f

p
r‚Ä≤
Lp

G | f(y)|p|g(y‚àí1x)|r dŒª(y)
1
q 
G |g(y‚àí1x)|r dŒª(y)
 1
p‚Ä≤
=
 f

p
r‚Ä≤
Lp

G | f(y)|p|g(y‚àí1x)|r dŒª(y)
1
q 
G |#g(x‚àí1y)|r dŒª(y)
 1
p‚Ä≤
=

G | f(y)|p|g(y‚àí1x)|r dŒª(y)
 1
q f

p
r‚Ä≤
Lp
#g

r
p‚Ä≤
Lr ,
where we used left invariance. Now take Lq norms (in x) and apply Fubini‚Äôs theorem
to deduce that
| f|‚àó|g|

Lq ‚â§
f

p
r‚Ä≤
Lp
#g

r
p‚Ä≤
Lr

G

G | f(y)|p|g(y‚àí1x)|r dŒª(x)dŒª(y)
1
q
=
f

p
r‚Ä≤
Lp
#g

r
p‚Ä≤
Lr
 f

p
q
Lp
g

r
q
Lr
=
g

Lr
 f

Lp< ‚àû,
using the hypothesis on g. This implies that | f| ‚àó|g| is Ô¨Ånite Œª-a.e. and satisÔ¨Åes
(1.2.14); then f ‚àóg exists Œª-a.e. and also satisÔ¨Åes (1.2.14).
Finally, note that if r = ‚àû, the assumptions on p and q imply that p = 1 and q = ‚àû,
in which case the required inequality trivially holds.
‚ñ°
We now give a version of Theorem 1.2.12 for weak Lp spaces. Theorem 1.2.13 is
improved in Section 1.4.
Theorem 1.2.13. (Young‚Äôs inequality for weak type spaces) Let G be a locally com-
pact group with left Haar measure Œª that satisÔ¨Åes (1.2.12). Let 1 ‚â§p < ‚àûand
1 < q,r < ‚àûsatisfy
1
q +1 = 1
p + 1
r .
(1.2.15)
Then there exists a constant Cp,q,r > 0 such that for all f in Lp(G) and g in Lr,‚àû(G),
the convolution f ‚àóg exists Œª-a.e. and satisÔ¨Åes
f ‚àóg

Lq,‚àû(G) ‚â§Cp,q,r
g

Lr,‚àû(G)
f

Lp(G) .
(1.2.16)

24
1 Lp Spaces and Interpolation
Proof. As in the proofs of Theorems 1.2.10 and 1.2.12, we Ô¨Årst obtain (1.2.16) for the
convolution of the absolute values of the functions. This implies that | f| ‚àó|g| < ‚àû
Œª-a.e., and thus f ‚àóg exists Œª-a.e. and satisÔ¨Åes | f ‚àóg| ‚â§| f|‚àó|g|. We may therefore
assume that f,g ‚â•0 Œª-a.e. The proof is based on a suitable splitting of the function
g. Let M be a positive real number to be chosen later. DeÔ¨Åne g1 = gœá|g|‚â§M and
g2 = gœá|g|>M. In view of Exercise 1.1.10 (a) we have
dg1(Œ±) =

0
if Œ± ‚â•M,
dg(Œ±)‚àídg(M)
if Œ± < M,
(1.2.17)
dg2(Œ±) =

dg(Œ±)
if Œ± > M,
dg(M)
if Œ± ‚â§M.
(1.2.18)
Proposition 1.1.3 gives for all Œ≤ > 0
df‚àóg(Œ≤) ‚â§df‚àóg1(Œ≤/2)+df‚àóg2(Œ≤/2),
(1.2.19)
and thus it sufÔ¨Åces to estimate the distribution functions of f ‚àóg1 and f ‚àóg2. Since
g1 is the ‚Äúsmall‚Äù part of g, it is in Ls for any s > r. In fact, we have

G g1(x)s dŒª(x) = s
 ‚àû
0 Œ±s‚àí1dg1(Œ±)dŒ±
= s
 M
0
Œ±s‚àí1(dg(Œ±)‚àídg(M))dŒ±
‚â§s
 M
0
Œ±s‚àí1‚àírg
r
Lr,‚àûdŒ± ‚àís
 M
0
Œ±s‚àí1dg(M)dŒ±
=
s
s‚àírMs‚àírg
r
Lr,‚àû‚àíMsdg(M),
(1.2.20)
when s < ‚àû.
Similarly, since g2 is the ‚Äúlarge‚Äù part of g, it is in Lt for any t < r, and

G g2(x)t dŒª(x) = t
 ‚àû
0 Œ±t‚àí1dg2(Œ±)dŒ±
= t
 M
0
Œ±t‚àí1dg(M)dŒ± +t
 ‚àû
M Œ±t‚àí1dg(Œ±)dŒ±
‚â§Mtdg(M)+t
 ‚àû
M Œ±t‚àí1‚àírg
r
Lr,‚àûdŒ±
‚â§Mt‚àírg
r
Lr,‚àû+
t
r ‚àít Mt‚àírg
r
Lr,‚àû
=
r
r ‚àít Mt‚àírg
r
Lr,‚àû.
(1.2.21)
Since 1/r = 1/p‚Ä≤ + 1/q, it follows that 1 < r < p‚Ä≤. Select t = 1 and s = p‚Ä≤.
H¬®older‚Äôs inequality and (1.2.20) give when p‚Ä≤ < ‚àû
|( f ‚àóg1)(x)| ‚â§
 f

Lp
g1

Lp‚Ä≤ ‚â§
 f

Lp

p‚Ä≤
p‚Ä≤ ‚àírMp‚Ä≤‚àírg
r
Lr,‚àû
 1
p‚Ä≤
(1.2.22)

1.2 Convolution and Approximate Identities
25
and
|( f ‚àóg1)(x)| ‚â§
 f

LpM
(1.2.23)
when p‚Ä≤ = ‚àû. If p‚Ä≤ < ‚àûchoose an M such that the right-hand side of (1.2.22) is equal
to Œ≤/2. If p‚Ä≤ = ‚àûchoose M such that the right-hand side of (1.2.23) is also equal to
Œ≤/2. That is, choose
M = (Œ≤ p‚Ä≤2‚àíp‚Ä≤rq‚àí1‚à•f‚à•‚àíp‚Ä≤
Lp ‚à•g‚à•‚àír
Lr,‚àû)1/(p‚Ä≤‚àír)
if p‚Ä≤ < ‚àûand M = Œ≤/(2‚à•f‚à•L1) if p‚Ä≤ = ‚àû. For these choices of M we have that
df‚àóg1(Œ≤/2) = 0.
Next by Theorem 1.2.10 and (1.2.21) with t = 1 we obtain
f ‚àóg2

Lp ‚â§
f

Lp
g2

L1 ‚â§
f

Lp
r
r ‚àí1M1‚àírg
r
Lr,‚àû.
(1.2.24)
For the value of M chosen, using (1.2.24) and Chebyshev‚Äôs inequality, we obtain
df‚àóg(Œ≤) ‚â§df‚àóg2(Œ≤/2)
‚â§(2
f ‚àóg2

LpŒ≤ ‚àí1)p
‚â§(2r
 f

LpM1‚àírg
r
Lr,‚àû(r ‚àí1)‚àí1Œ≤ ‚àí1)p
= Cq
p,q,rŒ≤ ‚àíqf
q
Lp
g
q
Lr,‚àû,
(1.2.25)
which is the required inequality. This proof gives that the constant Cp,q,r blows up
like (r ‚àí1)‚àíp/q as r ‚Üí1.
‚ñ°
Example 1.2.14. Theorem 1.2.13 may fail at some endpoints:
(1) r = 1 and 1 ‚â§p = q ‚â§‚àû. On R take g(x) = 1/|x| and f = œá[0,1]. Clearly, g is in
L1,‚àûand f in Lp for all 1 ‚â§p ‚â§‚àû, but the convolution of f and g is identically
equal to inÔ¨Ånity on the interval [0,1]. Therefore, (1.2.16) fails in this case.
(2) q = ‚àûand 1 < r = p‚Ä≤ < ‚àû. On R let f(x) = (|x|1/p log|x|)‚àí1 for |x| ‚â•2 and zero
otherwise, and also let g(x) = |x|‚àí1/r. We see that ( f ‚àóg)(x) = ‚àûfor |x| ‚â§1.
Thus (1.2.16) fails in this case also.
(3) r = q = ‚àûand p = 1. Then inequality (1.2.16) trivially holds.
1.2.4 Approximate Identities
We now introduce the notion of approximate identities. The Banach algebra L1(G)
may not have a unit element, that is, an element f0 such that
f0 ‚àóf = f = f ‚àóf0
(1.2.26)

26
1 Lp Spaces and Interpolation
for all f ‚ààL1(G). In particular, this is the case when G = R; in fact, the only f0 that
satisÔ¨Åes (1.2.26) for all f ‚ààL1(R) is not a function but the Dirac delta distribution,
introduced in Chapter 2. It is reasonable therefore to introduce the notion of approx-
imate unit or identity, a family of functions kŒµ with the property kŒµ ‚àóf ‚Üíf in L1 as
Œµ ‚Üí0.
DeÔ¨Ånition 1.2.15. An approximate identity (as Œµ ‚Üí0) is a family of L1(G) functions
kŒµ with the following three properties:
(i)
There exists a constant c > 0 such that ‚à•kŒµ‚à•L1(G) ‚â§c for all Œµ > 0.
(ii)

G kŒµ(x)dŒª(x) = 1 for all Œµ > 0.
(iii)
For any neighborhood V of the identity element e of the group G we have

V c |kŒµ(x)|dŒª(x) ‚Üí0 as Œµ ‚Üí0.
The construction of approximate identities on general locally compact groups G
is beyond the scope of this book and is omitted; see [152] for details. In this book we
are interested only in groups with Euclidean structure, where approximate identities
exist in abundance.
Sometimes we think of approximate identities as sequences {kn}n. In this case
property (iii) holds as n ‚Üí‚àû. It is best to visualize approximate identities as se-
quences of positive functions kn that spike near 0 in such a way that the signed area
under the graph of each function remains constant (equal to one) but the support
shrinks to zero. See Figure 1.2.
Example 1.2.16. On R let P(x) = (œÄ(x2 +1))‚àí1 and PŒµ(x) = Œµ‚àí1P(Œµ‚àí1x) for Œµ > 0.
Since PŒµ and P have the same L1 norm and
 +‚àû
‚àí‚àû
1
x2 +1 dx = lim
x‚Üí+‚àû

arctan(x)‚àíarctan(‚àíx)

= (œÄ/2)‚àí(‚àíœÄ/2) = œÄ ,
property (ii) is satisÔ¨Åed. Property (iii) follows from the fact that
1
œÄ

|x|‚â•Œ¥
1
Œµ
1
(x/Œµ)2 +1 dx = 1‚àí2
œÄ arctan(Œ¥/Œµ) ‚Üí0
as Œµ ‚Üí0,
for all Œ¥ > 0. The function PŒµ is called the Poisson kernel.
The Poisson kernel may be replaced by any integrable function of integral 1 as
the following example indicates.
Example 1.2.17. On Rn let k(x) be an integrable function with integral one. Let
kŒµ(x) = Œµ‚àínk(Œµ‚àí1x). It is straightforward to see that kŒµ(x) is an approximate identity.
Property (iii) follows from the fact that

|x|‚â•Œ¥/Œµ |k(x)|dx ‚Üí0
as Œµ ‚Üí0 for Œ¥ Ô¨Åxed.

1.2 Convolution and Approximate Identities
27
-0.4
-0.2
0.2
0.4
1
2
3
4
5
6
Fig. 1.2 The Fej¬¥er kernel F5 plotted on the interval [‚àí1
2, 1
2].
Example 1.2.18. On the circle group T1 let
FN(t) =
N
‚àë
j=‚àíN

1‚àí
| j|
N +1

e2œÄi jt =
1
N +1
sin(œÄ(N +1)t)
sin(œÄt)
2
.
(1.2.27)
To check the previous equality we use that
sin2(x) = (2‚àíe2ix ‚àíe‚àí2ix)/4,
and we carry out the calculation. FN is called the Fej¬¥er kernel. See Figure 1.2. To
see that the sequence {FN}N is an approximate identity, we check conditions (i), (ii),
and (iii) in DeÔ¨Ånition 1.2.15. Property (iii) follows from the expression giving FN in
terms of sines, while property (i) follows from the expression giving FN in terms of
exponentials. Property (ii) is identical to property (i), since FN is nonnegative.
Next comes the basic theorem concerning approximate identities.
Theorem 1.2.19. Let kŒµ be an approximate identity on a locally compact group G
with left Haar measure Œª.
(1) If f lies in Lp(G) for 1 ‚â§p < ‚àû, then ‚à•kŒµ ‚àóf ‚àíf‚à•Lp(G) ‚Üí0 as Œµ ‚Üí0.
(2) Let f be a function in L‚àû(G) that is uniformly continuous on a subset K of
G, in the sense that for all Œ¥ > 0 there is a neighborhood V of the identity
element such that for all x ‚ààK and y ‚ààV we have | f(y‚àí1x)‚àíf(x)| < Œ¥. Then
we have that ‚à•kŒµ ‚àóf ‚àíf‚à•L‚àû(K) ‚Üí0 as Œµ ‚Üí0. In particular, if f is bounded and
continuous at a point x0 ‚ààG, then (kŒµ ‚àóf)(x0) ‚Üíf(x0) as Œµ ‚Üí0.
Proof. We start with the case 1 ‚â§p < ‚àû. We recall that continuous functions with
compact support are dense in Lp of locally compact Hausdorff spaces equipped
with measures arising from nonnegative linear functionals; see [152, Theorem
12.10]. For a continuous function g supported in a compact set L we have we have
|g(h‚àí1x) ‚àíg(x)|p ‚â§(2‚à•g‚à•L‚àû)pœáW ‚àí1L for h in a relatively compact neighborhood

28
1 Lp Spaces and Interpolation
W of the identity element e. By the Lebesgue dominated convergence theorem we
obtain

G |g(h‚àí1x)‚àíg(x)|p dŒª(x) ‚Üí0
(1.2.28)
as h ‚Üíe. Now approximate a given f in Lp(G) by a continuous function with com-
pact support g to deduce that

G | f(h‚àí1x)‚àíf(x)|p dŒª(x) ‚Üí0
as
h ‚Üíe.
(1.2.29)
Because of (1.2.29), given a Œ¥ > 0 there exists a neighborhood V of e such that
h ‚ààV =‚áí

G | f(h‚àí1x)‚àíf(x)|p dŒª(x) <
 Œ¥
2c
p
,
(1.2.30)
where c is the constant that appears in DeÔ¨Ånition 1.2.15 (i). Since kŒµ has integral one
for all Œµ > 0, we have
(kŒµ ‚àóf)(x)‚àíf(x) = (kŒµ ‚àóf)(x)‚àíf(x)

G kŒµ(y)dŒª(y)
=

G( f(y‚àí1x)‚àíf(x))kŒµ(y)dŒª(y)
=

V( f(y‚àí1x)‚àíf(x))kŒµ(y)dŒª(y)
+

V c( f(y‚àí1x)‚àíf(x))kŒµ(y)dŒª(y).
(1.2.31)
Now take Lp norms in x in (1.2.31). In view of (1.2.30),


V( f(y‚àí1x)‚àíf(x))kŒµ(y)dŒª(y)

Lp(G,dŒª(x))
‚â§

V
f(y‚àí1x)‚àíf(x)

Lp(G,dŒª(x))|kŒµ(y)|dŒª(y)
‚â§

V
Œ¥
2c|kŒµ(y)|dŒª(y) < Œ¥
2 ,
(1.2.32)
while


V c( f(y‚àí1x)‚àíf(x))kŒµ(y)dŒª(y)

Lp(G,dŒª(x))
‚â§

V c 2
f

Lp(G)|kŒµ(y)|dŒª(y) < Œ¥
2 ,
(1.2.33)
provided we have that

V c |kŒµ(x)|dŒª(x) <
Œ¥
4
 f

Lp +1
 .
(1.2.34)

1.2 Convolution and Approximate Identities
29
Choose Œµ0 > 0 such that (1.2.34) is valid for Œµ < Œµ0 by property (iii). Now (1.2.32)
and (1.2.33) imply the required conclusion.
The case p = ‚àûfollows similarly. Let f be a bounded function on G that is
uniformly continuous on K. Given Œ¥ > 0, there is a neighborhood V of e such that,
whenever y ‚ààV and x ‚ààK we have
| f(y‚àí1x)‚àíf(x)| < Œ¥
2c ,
(1.2.35)
where c is as in DeÔ¨Ånition 1.2.15 (i). By property (iii) in DeÔ¨Ånition 1.2.15, there is
an Œµ0 > 0 such that for 0 < Œµ < Œµ0 we have

V c |kŒµ(y)|dŒª(y) <
Œ¥
4

‚à•f‚à•L‚àû(G) +1
 .
(1.2.36)
Using (1.2.35) and (1.2.36), we deduce that
sup
x‚ààK
|(kŒµ ‚àóf)(x)‚àíf(x)|
‚â§

V |kŒµ(y)|sup
x‚ààK
| f(y‚àí1x)‚àíf(x)|dŒª(y)+

V c |kŒµ(y)|sup
x‚ààK
| f(y‚àí1x)‚àíf(x)|dŒª(y)
‚â§c Œ¥
2c +
Œ¥
4

‚à•f‚à•L‚àû(G) +1
 2‚à•f‚à•L‚àû(G) ‚â§Œ¥.
This shows that kŒµ ‚àóf converge uniformly to f on K as Œµ ‚Üí0. In particular, if
K = {x0} and f is bounded and continuous at x0, we have (kŒµ ‚àóf)(x0) ‚Üíf(x0). ‚ñ°
Remark 1.2.20. Observe that if Haar measure satisÔ¨Åes (1.2.12), then the conclusion
of Theorem 1.2.19 also holds for f ‚àókŒµ.
A simple modiÔ¨Åcation in the proof of Theorem 1.2.19 yields the following vari-
ant, which presents a signiÔ¨Åcant difference only when a = 0.
Theorem 1.2.21. Let kŒµ be a family of functions on a locally compact group G that
satisÔ¨Åes properties (i) and (iii) of DeÔ¨Ånition 1.2.15 and also

G kŒµ(x)dŒª(x) = a
for some Ô¨Åxed a ‚ààC and for all Œµ > 0. Let f ‚ààLp(G) for some 1 ‚â§p ‚â§‚àû.
(a) If 1 ‚â§p < ‚àû, then ‚à•kŒµ ‚àóf ‚àíaf‚à•Lp(G) ‚Üí0 as Œµ ‚Üí0.
(b) If p = ‚àûand f is uniformly continuous on a subset K of G, in the sense that
for any Œ¥ > 0 there is a neighborhood V of the identity element of G such that
supx‚ààG supy‚ààV | f(y‚àí1x)‚àíf(x)| ‚â§Œ¥, then we have that ‚à•kŒµ ‚àóf ‚àíaf‚à•L‚àû(K) ‚Üí0
as Œµ ‚Üí0.

30
1 Lp Spaces and Interpolation
Exercises
1.2.1. Let G be a locally compact group and let f,g in L1(G) be supported in the
subsets A and B of G, respectively. Prove that f ‚àóg is supported in the algebraic
product set AB.
1.2.2. For a function f on a locally compact group G and t ‚ààG, let tf(x) = f(tx)
and f t(x) = f(xt). Show that
tf ‚àóg = t( f ‚àóg)
and
f ‚àógt = ( f ‚àóg)t
whenever f,g ‚ààL1(G), equipped with left Haar measure.
1.2.3. Let G be a locally compact group with left Haar measure. Let f ‚ààLp(G)
and Àúg ‚ààLp‚Ä≤(G), where 1 < p < ‚àû; recall that #g(x) = g(x‚àí1). For t,x ‚ààG, let
tg(x) = g(tx). Show that for any Œµ > 0 there exists a relatively compact symmet-
ric neighborhood of the origin U such that u ‚ààU implies ‚à•u#g ‚àí#g‚à•Lp‚Ä≤(G) < Œµ and
therefore
|( f ‚àóg)(v)‚àí( f ‚àóg)(w)| <
f

Lp Œµ
whenever v‚àí1w ‚ààU.
1.2.4. (a) Prove that compactly supported functions are dense in Lp(Rn) for all 0 <
p < ‚àû.
(b) Show that smooth functions with compact support are dense in Lp(Rn) for all
1 ‚â§p < ‚àû.

Hint: Part (b): Use Theorem 1.2.19 with kŒµ(x) = Œµ‚àínk(Œµ‚àí1x) and k smooth and
compactly supported function.

1.2.5. Show that a Haar measure Œª for the multiplicative group of all positive real
numbers is
Œª(A) =
 ‚àû
0 œáA(t) dt
t .
1.2.6. Let G = R2 \{(0,y) : y ‚ààR} with group operation (x,y)(z,w) = (xz,xw+y).
[Think of G as the group of all 2 √ó 2 matrices with bottom row (0,1) and nonzero
top left entry.] Show that a left Haar measure on G is
Œª(A) =
 +‚àû
‚àí‚àû
 +‚àû
‚àí‚àûœáA(x,y) dxdy
x2
,
while a right Haar measure on G is
œÅ(A) =
 +‚àû
‚àí‚àû
 +‚àû
‚àí‚àûœáA(x,y) dxdy
|x| .

1.2 Convolution and Approximate Identities
31
1.2.7. ([144], [145]) Use Theorem 1.2.10 to prove that
 ‚àû
0
1
x
 x
0 | f(t)|dt
p
dx
1
p
‚â§
p
p‚àí1
f

Lp(0,‚àû),
 ‚àû
0
 ‚àû
x | f(t)|dt
p
dx
1
p
‚â§p
 ‚àû
0 | f(t)|pt p dt
1
p
,
when 1 < p < ‚àû.

Hint: On the multiplicative group (R+, dt
t ) consider the convolution of the function
| f(x)|x
1
p with the function x‚àí1
p‚Ä≤ œá[1,‚àû) and the convolution of the function | f(x)|x1+ 1
p
with x
1
p œá(0,1].

1.2.8. (G. H. Hardy) Let 0 < b < ‚àûand 1 ‚â§p < ‚àû. Prove that
 ‚àû
0
 x
0 | f(t)|dt
p
x‚àíb‚àí1 dx
1
p
‚â§p
b
 ‚àû
0 | f(t)|pt p‚àíb‚àí1 dt
1
p
,
 ‚àû
0
 ‚àû
x | f(t)|dt
p
xb‚àí1 dx
1
p
‚â§p
b
 ‚àû
0 | f(t)|pt p+b‚àí1 dt
1
p
.

Hint: On the multiplicative group (R+, dt
t ) consider the convolution of the function
| f(x)|x1‚àíb
p with x‚àíb
p œá[1,‚àû) and of the function | f(x)|x1+ b
p with x
b
p œá(0,1].

1.2.9. On Rn let T( f) = f ‚àóK, where K is a positive L1 function and f is in Lp,
1 ‚â§p ‚â§‚àû. Prove that the operator norm of T : Lp ‚ÜíLp is equal to ‚à•K‚à•L1.

Hint: Clearly, ‚à•T‚à•Lp‚ÜíLp ‚â§‚à•K‚à•L1. Conversely, Ô¨Åx 0 < Œµ < 1 and let N be a positive
integer. Let œáN = œáB(0,N) and for any R > 0 let KR = KœáB(0,R), where B(x,R) is the
ball of radius R centered at x. Observe that for |x| ‚â§(1‚àíŒµ)N, we have B(0,NŒµ) ‚´Ö
B(x,N); thus

Rn œáN(x‚àíy)KNŒµ(y)dy =

Rn KNŒµ(y)dy =
KNŒµ

L1. Then
K ‚àóœáN
p
Lp
‚à•œáN‚à•p
Lp
‚â•
KNŒµ ‚àóœáN
p
Lp(B(0,(1‚àíŒµ)N)
œáN
p
Lp
‚â•
KNŒµ
p
L1(1‚àíŒµ)n .
Let N ‚Üí‚àûÔ¨Årst and then Œµ ‚Üí0.

1.2.10. On the multiplicative group (R+, dt
t ) let T( f) = f ‚àóK, where K is a positive
L1 function and f is in Lp, 1 ‚â§p ‚â§‚àû. Prove that the operator norm of T : Lp ‚ÜíLp
is equal to the L1 norm of K. Deduce that the constants p/(p‚àí1) and p/b are sharp
in Exercises 1.2.7 and 1.2.8.

Hint: Adapt the idea of Exercise 1.2.9 to this setting.

1.2.11. Let Qk(t) = ck(1‚àít2)k for t ‚àà[‚àí1,1] and zero elsewhere, where ck is cho-
sen such that
 1
‚àí1 Qk(t)dt = 1 for all k = 1,2,....
(a) Show that ck <
‚àö
k.

32
1 Lp Spaces and Interpolation
(b) Use part (a) to show that {Qk}k is an approximate identity on R as k ‚Üí‚àû.
(c) Given a continuous function f on R that vanishes outside the interval [‚àí1,1],
show that f ‚àóQk converges to f uniformly on [‚àí1,1] as k ‚Üí‚àû.
(d) (Weierstrass) Prove that every continuous function on [‚àí1,1] can be approxi-
mated uniformly by polynomials.

Hint: Part (a): Estimate the integral

|t|‚â§k‚àí1/2 Qk(t)dt from below using the in-
equality (1 ‚àít2)k ‚â•1 ‚àíkt2 for |t| ‚â§1. Part (d): Consider the function g(t) =
f(t)‚àíf(‚àí1)‚àít+1
2 ( f(1)‚àíf(‚àí1)).

1.2.12. Show that the Laplace transform L( f)(x) =
 ‚àû
0 f(t)e‚àíxtdt maps L2(0,‚àû) to
itself with norm at most ‚àöœÄ.

Hint: Consider convolution with the kernel ‚àöt e‚àít on the group L2((0,‚àû), dt
t ).

1.2.13. ([62]) Let F ‚â•0, G ‚â•0 be measurable functions on the sphere Sn‚àí1 and let
K ‚â•0 be a measurable function on [‚àí1,1]. Prove that

Sn‚àí1

Sn‚àí1 F(Œ∏)G(œï)K(Œ∏ ¬∑œï)dœï dŒ∏ ‚â§C‚à•F‚à•Lp(Sn‚àí1)‚à•G‚à•Lp‚Ä≤(Sn‚àí1) ,
where 1 ‚â§p ‚â§‚àû, Œ∏ ¬∑œï = ‚àën
j=1 Œ∏ jœïj andC =

Sn‚àí1 K(Œ∏ ¬∑œï)dœï, which is independent
of Œ∏. Moreover, show that C is the best possible constant in the preceding inequality.
Using duality, compute the norm of the linear operator
F(Œ∏) ‚Üí

Sn‚àí1 F(Œ∏)K(Œ∏ ¬∑œï)dœï
from Lp(Sn‚àí1) to itself.

Hint: Observe that

Sn‚àí1

Sn‚àí1 F(Œ∏)G(œï)K(Œ∏ ¬∑œï)dœï dŒ∏ is bounded by the quantity
$
Sn‚àí1

Sn‚àí1 F(Œ∏)K(Œ∏ ¬∑œï)dŒ∏
p
dœï
% 1
p
‚à•G‚à•Lp‚Ä≤(Sn‚àí1).
Apply H¬®older‚Äôs inequality to the functions F and 1 with respect to the measure
K(Œ∏ ¬∑œï)dŒ∏ to deduce that

Sn‚àí1 F(Œ∏)K(Œ∏ ¬∑œï)dŒ∏ is controlled by

Sn‚àí1 F(Œ∏)pK(Œ∏ ¬∑œï)dŒ∏
1/p
Sn‚àí1 K(Œ∏ ¬∑œï)dŒ∏
1/p‚Ä≤
.
Use Fubini‚Äôs theorem to bound the latter by
‚à•F‚à•Lp(Sn‚àí1)‚à•G‚à•Lp‚Ä≤(Sn‚àí1)

Sn‚àí1 K(Œ∏ ¬∑œï)dœï.
Note that equality is attained if and only if both F and G are constants.


1.3 Interpolation
33
1.3 Interpolation
The theory of interpolation of operators is vast and extensive. In this section we
are mainly concerned with a couple of basic interpolation results that appear in a
variety of applications and constitute the foundation of the Ô¨Åeld. These results are
the Marcinkiewicz interpolation theorem and the Riesz‚ÄìThorin interpolation theo-
rem. These theorems are traditionally proved using real and complex variables tech-
niques, respectively. A byproduct of the Riesz‚ÄìThorin interpolation theorem, Stein‚Äôs
theorem on interpolation of analytic families of operators, has also proved to be an
important and useful tool in many applications and is presented at the end of the
section.
We begin by setting up the background required to formulate the results of this
section. Let (X,Œº) and (Y,ŒΩ) be two measure spaces. Suppose we are given a linear
operator T, initially deÔ¨Åned on the set of simple functions on X, such that for all f
simple on X, T( f) is a ŒΩ-measurable function on Y. Let 0 < p < ‚àûand 0 < q < ‚àû.
If there exists a constant Cp,q > 0 such that for all simple functions f on X we have
T( f)

Lq(Y,ŒΩ) ‚â§Cp,q
f

Lp(X,Œº) ,
(1.3.1)
then by density, T admits a unique bounded extension from Lp(X,Œº) to Lq(Y,ŒΩ).
This extension is also denoted by T. Operators that map Lp to Lq are called of strong
type (p,q) and operators that map Lp to Lq,‚àûare called weak type (p,q).
1.3.1 Real Method: The Marcinkiewicz Interpolation Theorem
DeÔ¨Ånition 1.3.1. Let T be an operator deÔ¨Åned on a linear space of complex-valued
measurable functions on a measure space (X,Œº) and taking values in the set of all
complex-valued Ô¨Ånite almost everywhere measurable functions on a measure space
(Y,ŒΩ). Then T is called linear if for all f, g in the domain of T and all Œª ‚ààC we
have
T( f +g) = T( f)+T(g)
and
T(Œª f) = ŒªT( f).
(1.3.2)
T is called sublinear if for all f, g in the domain of T and all Œª ‚ààC we have
|T( f +g)| ‚â§|T( f)|+|T(g)|
and
|T(Œª f)| = |Œª||T( f)|.
(1.3.3)
T is called quasi-linear if for all f, g in the domain of T and all Œª ‚ààC we have
|T( f +g)| ‚â§K(|T( f)|+|T(g)|)
and
|T(Œª f)| = |Œª||T( f)|
(1.3.4)
for some constant K > 0. Sublinearity is a special case of quasi-linearity.
For instance, T1 and T2 are linear operators, then (|T1|p +|T2|p)1/p is sublinear if
p ‚â•1 and quasi-linear if 0 < p < 1.

34
1 Lp Spaces and Interpolation
Theorem 1.3.2. Let (X,Œº) be a œÉ-Ô¨Ånite measure space, let (Y,ŒΩ) be another mea-
sure space, and let 0 < p0 < p1 ‚â§‚àû. Let T be a sublinear operator deÔ¨Åned on
Lp0(X)+Lp1(X) = {f0 + f1 : f j ‚ààLp j(Xj), j = 0,1} and taking values in the space
of measurable functions on Y. Assume that there exist A0,A1 < ‚àûsuch that
T( f)

Lp0,‚àû(Y) ‚â§A0
 f

Lp0(X)
for all f ‚ààLp0(X),
(1.3.5)
T( f)

Lp1,‚àû(Y) ‚â§A1
 f

Lp1(X)
for all f ‚ààLp1(X).
(1.3.6)
Then for all p0 < p < p1 and for all f in Lp(X) we have the estimate
T( f)

Lp(Y) ‚â§A
f

Lp(X) ,
(1.3.7)
where
A = 2

p
p‚àíp0
+
p
p1 ‚àíp
1
p
A
1p ‚àí1p1
1p0 ‚àí1p1
0
A
1p0 ‚àí1p
1p0 ‚àí1p1
1
.
(1.3.8)
Proof. Assume Ô¨Årst that p1 < ‚àû. Fix f a function in Lp(X) and Œ± > 0. We split
f = f Œ±
0 + f Œ±
1 , where f Œ±
0 is in Lp0 and f Œ±
1 is in Lp1. The splitting is obtained by
cutting | f| at height Œ¥Œ± for some Œ¥ > 0 to be determined later. Set
f Œ±
0 (x) =

f(x)
for
| f(x)| > Œ¥Œ±,
0
for
| f(x)| ‚â§Œ¥Œ±,
f Œ±
1 (x) =

f(x)
for
| f(x)| ‚â§Œ¥Œ±,
0
for
| f(x)| > Œ¥Œ±.
It can be checked easily that f Œ±
0 (the unbounded part of f) is an Lp0 function and
that f Œ±
1 (the bounded part of f) is an Lp1 function. Indeed, since p0 < p, we have
f Œ±
0
p0
Lp0 =

| f|>Œ¥Œ± | f(x)|p| f(x)|p0‚àíp dŒº(x) ‚â§(Œ¥Œ±)p0‚àípf
p
Lp
and similarly, since p < p1,
f Œ±
1
p1
Lp1 ‚â§(Œ¥Œ±)p1‚àípf
p
Lp.
In view of the subadditivity property of T contained in (1.3.3) we obtain that
|T( f)| ‚â§|T( f Œ±
0 )|+|T( f Œ±
1 )|,
which implies
{y ‚ààY : |T( f)(y)| > Œ±} ‚´Ö{y ‚ààY : |T( f Œ±
0 )(y)| > Œ±/2}‚à™{y ‚ààY : |T( f Œ±
1 )(y)| > Œ±/2},
and therefore
dT( f)(Œ±) ‚â§dT( f Œ±
0 )(Œ±/2)+dT( f Œ±
1 )(Œ±/2).
(1.3.9)

1.3 Interpolation
35
Hypotheses (1.3.5) and (1.3.6) together with (1.3.9) now give
dT( f)(Œ±) ‚â§
Ap0
0
(Œ±/2)p0

| f|>Œ¥Œ± | f(x)|p0 dŒº(x)+
Ap1
1
(Œ±/2)p1

| f|‚â§Œ¥Œ± | f(x)|p1 dŒº(x).
In view of the last estimate and Proposition 1.1.4, we obtain that
T( f)
p
Lp ‚â§p(2A0)p0
 ‚àû
0 Œ± p‚àí1Œ±‚àíp0

| f|>Œ¥Œ± | f(x)|p0 dŒº(x)dŒ±
+ p(2A1)p1
 ‚àû
0 Œ± p‚àí1Œ±‚àíp1

| f|‚â§Œ¥Œ± | f(x)|p1 dŒº(x)dŒ±
= p(2A0)p0

X | f(x)|p0

1
Œ¥ | f(x)|
0
Œ± p‚àí1‚àíp0 dŒ± dŒº(x)
+ p(2A1)p1

X | f(x)|p1
 ‚àû
1
Œ¥ | f(x)| Œ± p‚àí1‚àíp1 dŒ± dŒº(x)
= p(2A0)p0
p‚àíp0
1
Œ¥ p‚àíp0

X | f(x)|p0| f(x)|p‚àíp0 dŒº(x)
+ p(2A1)p1
p1 ‚àíp
1
Œ¥ p‚àíp1

X | f(x)|p1| f(x)|p‚àíp1 dŒº(x)
= p
(2A0)p0
p‚àíp0
1
Œ¥ p‚àíp0 + (2A1)p1
p1 ‚àíp Œ¥ p1‚àíp
 f
p
Lp ,
and the convergence of the integrals in Œ± is justiÔ¨Åed from p0 < p < p1, while the
interchange of the integrals (Fubini‚Äôs theorem) uses the hypothesis that (X,Œº) is a
œÉ-Ô¨Ånite measure space. We pick Œ¥ > 0 such that
(2A0)p0
1
Œ¥ p‚àíp0 = (2A1)p1Œ¥ p1‚àíp ,
and observe that the last displayed constant is equal to the pth power of the constant
in (1.3.8). We have therefore proved the theorem when p1 < ‚àû.
We now consider the case p1 = ‚àû. Write f = f Œ±
0 + f Œ±
1 , where
f Œ±
0 (x) =

f(x)
for
| f(x)| > Œ≥Œ±,
0
for
| f(x)| ‚â§Œ≥Œ±,
f Œ±
1 (x) =

f(x)
for
| f(x)| ‚â§Œ≥Œ±,
0
for
| f(x)| > Œ≥Œ±.
We have
T( f Œ±
1 )

L‚àû‚â§A1
f Œ±
1

L‚àû‚â§A1Œ≥Œ± = Œ±/2,

36
1 Lp Spaces and Interpolation
provided we choose Œ≥ = (2A1)‚àí1. It follows that the set {y ‚ààY : |T( f Œ±
1 )(y)| > Œ±/2}
has measure zero. Therefore,
dT( f)(Œ±) ‚â§dT( f Œ±
0 )(Œ±/2).
Since T maps Lp0 to Lp0,‚àûwith norm at most A0, it follows that
dT( f Œ±
0 )(Œ±/2) ‚â§(2A0)p0f Œ±
0
p0
Lp0
Œ± p0
= (2A0)p0
Œ± p0

| f|>Œ≥Œ± | f(x)|p0 dŒº(x).
(1.3.10)
Using (1.3.10) and Proposition 1.1.4, we obtain
T( f)
p
Lp = p
 ‚àû
0 Œ± p‚àí1dT( f)(Œ±)dŒ±
‚â§p
 ‚àû
0 Œ± p‚àí1dT( f Œ±
0 )(Œ±/2)dŒ±
‚â§p
 ‚àû
0 Œ± p‚àí1 (2A0)p0
Œ± p0

| f|>Œ±/(2A1) | f(x)|p0 dŒº(x)dŒ±
= p(2A0)p0

X | f(x)|p0
 2A1| f(x)|
0
Œ± p‚àíp0‚àí1 dŒ± dŒº(x)
= p(2A1)p‚àíp0(2A0)p0
p‚àíp0

X | f(x)|p dŒº(x).
This proves the theorem with constant
A = 2

p
p‚àíp0
 1
p
A
1‚àíp0
p
1
A
p0
p
0 .
(1.3.11)
Observe that when p1 = ‚àû, the constant in (1.3.11) coincides with that in (1.3.8). ‚ñ°
Remark 1.3.3. Notice that the proof of Theorem 1.3.2 only makes use of the subad-
ditivity property |T( f +g)| ‚â§|T( f)|+|T(g)| of T in hypothesis (1.3.3).
If T is a linear operator (instead of sublinear), then we can relax the hypotheses
of Theorem 1.3.2 by assuming that (1.3.5) and (1.3.6) hold for all simple functions
f on X. Then the functions f Œ±
0 and f Œ±
1 constructed in the proof are also simple, and
we conclude that (1.3.7) holds for all simple functions f on X. By density, T has a
unique extension on Lp(X) that also satisÔ¨Åes (1.3.7).
1.3.2 Complex Method: The Riesz‚ÄìThorin Interpolation Theorem
The next interpolation theorem assumes stronger endpoint estimates, but yields a
more natural bound on the norm of the operator on the intermediate spaces. Unfor-
tunately, it is mostly applicable for linear operators and in some cases for sublinear

1.3 Interpolation
37
operators (often via a linearization process) but it does not apply to quasi-linear
operators without some loss in the constant.
Recall that a simple function is called Ô¨Ånitely simple if it is supported in a set
of Ô¨Ånite measure. Finitely simple functions are dense in Lp(X,Œº) for 0 < p < ‚àû,
whenever (X,Œº) is a œÉ-Ô¨Ånite measure space.
Theorem 1.3.4. Let (X,Œº) and (Y,ŒΩ) be two œÉ-Ô¨Ånite measure spaces. Let T be a
linear operator deÔ¨Åned on the set of all Ô¨Ånitely simple functions on X and taking
values in the set of measurable functions on Y. Let 1 ‚â§p0, p1,q0,q1 ‚â§‚àûand assume
that
T( f)

Lq0 ‚â§M0
f

Lp0 ,
T( f)

Lq1 ‚â§M1
f

Lp1 ,
(1.3.12)
for all Ô¨Ånitely simple functions f on X. Then for all 0 < Œ∏ < 1 we have
T( f)

Lq ‚â§M1‚àíŒ∏
0
MŒ∏
1
f

Lp
(1.3.13)
for all Ô¨Ånitely simple functions f on X, where
1
p = 1‚àíŒ∏
p0
+ Œ∏
p1
and
1
q = 1‚àíŒ∏
q0
+ Œ∏
q1
.
(1.3.14)
Consequently, when p < ‚àû, by density, T has a unique bounded extension from
Lp(X,Œº) to Lq(Y,ŒΩ) when p and q are as in (1.3.14).
Proof. Let
f =
m
‚àë
k=1
akeiŒ±kœáAk
be a Ô¨Ånitely simple function on X, where ak > 0, Œ±k are real, and Ak are pairwise
disjoint subsets of X with Ô¨Ånite measure.
We need to control
T( f)

Lq(Y,ŒΩ) = sup
g


Y T( f)(y)g(y)dŒΩ(y)
,
where the supremum is taken over all Ô¨Ånitely simple functions g on Y with Lq‚Ä≤ norm
less than or equal to 1. Write
g =
n
‚àë
j=1
bjeiŒ≤ jœáB j ,
where bj > 0, Œ≤ j are real, and Bj are pairwise disjoint subsets of Y with Ô¨Ånite ŒΩ-
measure. Let
P(z) = p
p0
(1‚àíz)+ p
p1
z
and
Q(z) = q‚Ä≤
q‚Ä≤
0
(1‚àíz)+ q‚Ä≤
q‚Ä≤
1
z.
(1.3.15)

38
1 Lp Spaces and Interpolation
For z in the closed strip S = {z ‚ààC : 0 ‚â§Rez ‚â§1}, deÔ¨Åne
fz =
m
‚àë
k=1
aP(z)
k
eiŒ±kœáAk,
gz =
n
‚àë
j=1
bQ(z)
j
eiŒ≤ jœáB j ,
(1.3.16)
and
F(z) =

Y T( fz)(y)gz(y)dŒΩ(y).
Notice that fŒ∏ = f and gŒ∏ = f. By linearity we have
F(z) =
m
‚àë
k=1
n
‚àë
j=1
aP(z)
k
bQ(z)
j
eiŒ±keiŒ≤ j

Y T(œáAk)(y)œáB j(y)dŒΩ(y).
Since ak,bj > 0, F is analytic in z, and the expression

Y T(œáAk)(y)œáB j(y)dŒΩ(y)
is a Ô¨Ånite constant, being an absolutely convergent integral; this is seen by H¬®older‚Äôs
inequality with exponents q0 and q‚Ä≤
0 (or q1 and q‚Ä≤
1) and (1.3.12).
By the disjointness of the sets Ak we have (even when p0 = ‚àû)
fit

Lp0 =
f

p
p0
Lp ,
since |aP(it)
k
| = a
p
p0
k , and by the disjointness of the Bj‚Äôs we have (even when q0 = 1)
git

Lq‚Ä≤
0 =
g

q‚Ä≤
q‚Ä≤
0
Lq‚Ä≤ ,
since |bQ(it)
j
| = b
q‚Ä≤
q‚Ä≤
0
j . Thus H¬®older‚Äôs inequality and the hypothesis give
|F(it)| ‚â§
T( fit)

Lq0
git

Lq‚Ä≤
0
‚â§M0
 fit

Lp0
git

Lq‚Ä≤
0
= M0
 f

p
p0
Lp
g

q‚Ä≤
q‚Ä≤
0
Lq‚Ä≤ .
(1.3.17)
By similar calculations, which are valid even when p1 = ‚àûand q1 = 1, we have
f1+it

Lp1 =
 f

p
p1
Lp
and
g1+it

Lq‚Ä≤
1 =
g

q‚Ä≤
q‚Ä≤
1
Lq‚Ä≤ .

1.3 Interpolation
39
Also, in a way analogous to that we obtained (1.3.17) we deduce that
|F(1+it)| ‚â§M1
f

p
p1
Lp
g

q‚Ä≤
q‚Ä≤
1
Lq‚Ä≤ .
(1.3.18)
To Ô¨Ånish the proof we will need the following lemma, known as Hadamard‚Äôs
three lines lemma.
Lemma 1.3.5. Let F be analytic in the open strip S = {z ‚ààC : 0 < Re z < 1},
continuous and bounded on its closure, such that |F(z)| ‚â§B0 when Re z = 0 and
|F(z)| ‚â§B1 when Re z = 1, for some 0 < B0,B1 < ‚àû. Then |F(z)| ‚â§B1‚àíŒ∏
0
BŒ∏
1 when
Re z = Œ∏, for any 0 ‚â§Œ∏ ‚â§1.
To prove the lemma we deÔ¨Åne analytic functions
G(z) = F(z)(B1‚àíz
0
Bz
1)‚àí1
and
Gn(z) = G(z)e(z2‚àí1)/n
for z in the unit strip S, for n = 1,2,.... Since F is bounded on S and
|B1‚àíz
0
Bz
1| ‚â•min(1,B0)min(1,B1) > 0
for all z ‚ààS, we conclude that G is bounded by some constant M on S. Since
|Gn(x+iy)| ‚â§Me‚àíy2/ne(x2‚àí1)/n ‚â§Me‚àíy2/n ,
we deduce that Gn(x + iy) converges to zero uniformly in 0 ‚â§x ‚â§1 as |y| ‚Üí‚àû.
Select y(n) > 0 such that for |y| ‚â•y(n), we have |Gn(x + iy)| ‚â§1 for all x ‚àà[0,1].
Also, the assumptions on F imply that G is bounded by one on the two lines forming
the boundary of S. By the maximum principle we obtain that |Gn(z)| ‚â§1 for all z in
the rectangle [0,1]√ó[‚àíy(n),y(n)]; hence |Gn(z)| ‚â§1 everywhere in the closed strip.
Letting n ‚Üí‚àû, we conclude that |G(z)| ‚â§1 in the closed strip. Taking z = Œ∏ +it we
deduce that
|F(Œ∏ +it)| ‚â§|B1‚àíŒ∏‚àíit
0
BŒ∏+it
1
| = B1‚àíŒ∏
0
BŒ∏
1
whenever t is real. This proves the required conclusion.
‚ñ°
Returning to the proof of Theorem 1.3.4, we observe that F is analytic in the open
strip S and continuous on its closure. Also, F is bounded on the closed unit strip (by
some constant that depends on f and g). Therefore, (1.3.17), (1.3.18), and Lemma
1.3.5 give
|F(z)| ‚â§

M0
 f

p
p0
Lp
g

q‚Ä≤
q‚Ä≤
0
Lq‚Ä≤
1‚àíŒ∏
M1
f

p
p1
Lp
g

q‚Ä≤
q‚Ä≤
1
Lq‚Ä≤
Œ∏
= M1‚àíŒ∏
0
MŒ∏
1
f

Lp
g

Lq‚Ä≤ ,
when Rez = Œ∏. Observe that P(Œ∏) = Q(Œ∏) = 1 and hence
F(Œ∏) =

Y T( f)gdŒΩ .

40
1 Lp Spaces and Interpolation
Taking the supremum over all Ô¨Ånitely simple functions g on Y with Lq‚Ä≤ norm less
than or equal to one, we conclude the proof of the theorem.
‚ñ°
We now give an application of Theorem 1.3.4.
Example 1.3.6. One may prove Young‚Äôs inequality (Theorem 1.2.12) using the
Riesz‚ÄìThorin interpolation theorem (Theorem 1.3.4). Fix a function g in Lr and
let T( f) = f ‚àóg. Since T : L1 ‚ÜíLr with norm at most ‚à•g‚à•Lr and T : Lr‚Ä≤ ‚ÜíL‚àûwith
norm at most ‚à•g‚à•Lr, Theorem 1.3.4 gives that T maps Lp to Lq with norm at most
the quantity ‚à•g‚à•Œ∏
Lr‚à•g‚à•1‚àíŒ∏
Lr
= ‚à•g‚à•Lr, where
1
p = 1‚àíŒ∏
1
+ Œ∏
r‚Ä≤
and
1
q = 1‚àíŒ∏
r
+ Œ∏
‚àû.
(1.3.19)
Finally, observe that equations (1.3.19) give (1.2.13).
1.3.3 Interpolation of Analytic Families of Operators
Theorem 1.3.4 can be extended to the case in which the interpolated operators are
allowed to vary. In particular, if a family of operators depends analytically on a
parameter z, then the proof of this theorem can be adapted to work in this setting.
We describe the setup for this theorem. Let (X,Œº) and (Y,ŒΩ) be œÉ-Ô¨Ånite measure
spaces. Suppose that for every z in the closed strip S = {z ‚ààC : 0 ‚â§Rez ‚â§1} there
is an associated linear operator Tz deÔ¨Åned on the space of Ô¨Ånitely simple functions
on X and taking values in the space of measurable functions on Y such that

Y |Tz(œáA)œáB|dŒΩ < ‚àû
(1.3.20)
whenever A and B are subsets of Ô¨Ånite measure of X and Y, respectively. The family
{Tz}z is said to be analytic if for all f,g Ô¨Ånitely simple functions we have that the
function
z ‚Üí

Y Tz( f)gdŒΩ
(1.3.21)
is analytic in the open strip S = {z ‚ààC : 0 < Rez < 1} and continuous on its closure.
The analytic family {Tz}z is called of admissible growth if there is a constant œÑ0 with
0 ‚â§œÑ0 < œÄ such that for Ô¨Ånitely simple functions f on X and g on Y there is constant
C( f,g) such that
log


Y Tz( f)gdŒΩ
 ‚â§C( f,g)eœÑ0|Imz|
(1.3.22)
for all z satisfying 0 ‚â§Rez ‚â§1. Note that if there is œÑ0 ‚àà(0,œÄ) such that for all
measurable subsets A of X and B of Y of Ô¨Ånite measure there is a constant c(A,B)
such that
log


B Tz(œáA)dŒΩ
 ‚â§c(A,B)eœÑ0|Imz| ,
(1.3.23)

1.3 Interpolation
41
then (1.3.22) holds for f = ‚àëM
k=1 akœáAk and g = ‚àëN
j=1 bjœáB j and
C( f,g) = log(MN)+
M
‚àë
k=1
N
‚àë
j=1

c(Ak,Bj)+
log|ak bj|

.
The extension of the Riesz‚ÄìThorin interpolation theorem is as follows.
Theorem 1.3.7. Let Tz be an analytic family of linear operators of admissible growth
deÔ¨Åned on the space of Ô¨Ånitely simple functions of a œÉ-Ô¨Ånite measure space (X,Œº)
and taking values in the set of measurable functions of another œÉ-Ô¨Ånite measure
space (Y,ŒΩ). Let 1 ‚â§p0, p1,q0,q1 ‚â§‚àûand suppose that M0 and M1 are positive
functions on the real line such that for some œÑ1 with 0 ‚â§œÑ1 < œÄ we have
sup
‚àí‚àû<y<+‚àû
e‚àíœÑ1|y| logMj(y) < ‚àû
(1.3.24)
for j = 0,1. Fix 0 < Œ∏ < 1 and deÔ¨Åne p,q by the equations
1
p = 1‚àíŒ∏
p0
+ Œ∏
p1
and
1
q = 1‚àíŒ∏
q0
+ Œ∏
q1
.
(1.3.25)
Suppose that for all Ô¨Ånitely simple functions f on X we have
Tiy( f)

Lq0 ‚â§M0(y)
f

Lp0 ,
(1.3.26)
T1+iy( f)

Lq1 ‚â§M1(y)
f

Lp1 .
(1.3.27)
Then for all Ô¨Ånitely simple functions f on X we have
TŒ∏( f)

Lq ‚â§M(Œ∏)
f

Lp
(1.3.28)
where for 0 < x < 1
M(x) = exp
$sin(œÄx)
2
 ‚àû
‚àí‚àû

logM0(t)
cosh(œÄt)‚àícos(œÄx) +
logM1(t)
cosh(œÄt)+cos(œÄx)

dt
%
.
Thus, by density, TŒ∏ has a unique bounded extension from Lp(X,Œº) to Lq(Y,ŒΩ) when
p and q are as in (1.3.25).
Note that in view of (1.3.24), the integral deÔ¨Åning M(t) converges absolutely. The
proof of the previous theorem is based on an extension of Lemma 1.3.5.
Lemma 1.3.8. Let F be analytic on the open strip S = {z ‚ààC : 0 < Re z < 1} and
continuous on its closure such that for some A < ‚àûand 0 ‚â§œÑ0 < œÄ we have
log|F(z)| ‚â§AeœÑ0|Im z|
(1.3.29)

42
1 Lp Spaces and Interpolation
for all z ‚ààS. Then
|F(x+iy)| ‚â§exp
$sin(œÄx)
2
 ‚àû
‚àí‚àû

log|F(it +iy)|
cosh(œÄt)‚àícos(œÄx) + log|F(1+it +iy)|
cosh(œÄt)+cos(œÄx)

dt
%
whenever 0 < x < 1, and y is real.
Assuming Lemma 1.3.8, we prove Theorem 1.3.7.
Proof. Fix 0 < Œ∏ < 1 and Ô¨Ånitely simple functions f on X and g on Y such that
‚à•f‚à•Lp = ‚à•g‚à•Lq‚Ä≤ = 1. Note that since 0 < Œ∏ < 1 we must have 1 < p,q < ‚àû. Let
f =
m
‚àë
k=1
akeiŒ±kœáAk
and
g =
n
‚àë
j=1
bjeiŒ≤ jœáB j ,
where ak > 0, bj > 0, Œ±k, Œ≤ j are real, Ak are pairwise disjoint subsets of X with Ô¨Ånite
measure, and Bj are pairwise disjoint subsets of Y with Ô¨Ånite measure for all k, j.
Let P(z), Q(z) be as in (1.3.15) and fz, gz as in (1.3.16). DeÔ¨Åne for z ‚ààS
F(z) =

Y Tz( fz)gz dŒΩ .
(1.3.30)
Linearity gives that
F(z) =
m
‚àë
k=1
n
‚àë
j=1
aP(z)
k
bQ(z)
j
eiŒ±keiŒ≤ j

Y Tz(œáAk)(x)œáB j(x)dŒΩ(x),
and conditions (1.3.20) together with the fact that {Tz}z is an analytic family imply
that F(z) is a well-deÔ¨Åned analytic function on the unit strip that extends continu-
ously to its boundary.
Since {Tz}z is a family of admissible growth, (1.3.23) holds for some c(Ak,Bj)
and œÑ0 ‚àà(0,œÄ) and this combined with the facts that
|aP(z)
k
| ‚â§a
p
p0 + p
p1
k
and
|bQ(z)
j
| ‚â§b
q‚Ä≤
q‚Ä≤
0
+ q‚Ä≤
q‚Ä≤
1
j
for all z with 0 < Re z < 1, implies (1.3.29) with œÑ0 as in (1.3.23) and
A = log(mn)+
m
‚àë
k=1
n
‚àë
j=1

c(Ak,Bj)+
 p
p0
+ p
p1
log ak
+
 q‚Ä≤
q‚Ä≤
0
+ q‚Ä≤
q‚Ä≤
1
log bj


.
Thus F satisÔ¨Åes the hypotheses of Lemma 1.3.8. Moreover, the calculations in the
proof of Theorem 1.3.4 show that (even when p0 = ‚àû, q0 = 1, p1 = ‚àû, q1 = 1)
 fiy

Lp0 =
 f

p
p0
Lp = 1 =
g

q‚Ä≤
q‚Ä≤
0
Lq‚Ä≤ =
giy

Lq‚Ä≤
0
when y ‚ààR,
(1.3.31)
 f1+iy

Lp1 =
f

p
p1
Lp = 1 =
g

q‚Ä≤
q‚Ä≤
1
Lq‚Ä≤ =
g1+iy

Lq‚Ä≤
1
when y ‚ààR.
(1.3.32)

1.3 Interpolation
43
H¬®older‚Äôs inequality, (1.3.31), and the hypothesis (1.3.26) now give
|F(iy)| ‚â§
Tiy( fiy)

Lq0
giy

Lq‚Ä≤
0 ‚â§M0(y)
fiy

Lp0
giy

Lq‚Ä≤
0 = M0(y)
for all y real. Similarly, (1.3.32), and (1.3.27) imply
|F(1+iy)| ‚â§
T1+iy( f1+iy)

Lq1
g1+iy

Lq‚Ä≤
1 ‚â§M1(y)
f1+iy

Lp1
g1+iy

Lq‚Ä≤
1 = M1(y)
for all y ‚ààR. These inequalities and the conclusion of Lemma 1.3.8 yield
|F(x)| ‚â§exp
$sin(œÄx)
2
 ‚àû
‚àí‚àû

logM0(t)
cosh(œÄt)‚àícos(œÄx) +
logM1(t)
cosh(œÄt)+cos(œÄx)

dt
%
= M(x)
for all 0 < x < 1. But notice that
F(Œ∏) =

Y TŒ∏( f)gdŒΩ .
(1.3.33)
Taking absolute values and the supremum over all Ô¨Ånitely simple functions g on Y
with Lq‚Ä≤ norm equal to one, we conclude the proof of (1.3.28) for Ô¨Ånitely simple
functions f with Lp norm one. Then (1.3.28) follows by replacing f by f/‚à•f‚à•Lp. ‚ñ°
We end this section with the proof of Lemma 1.3.8.
Proof of Lemma 1.3.8. Recall the Poisson integral formula
U(z) = 1
2œÄ
 +œÄ
‚àíœÄ U(Reiœï)
R2 ‚àíœÅ2
|Reiœï ‚àíœÅeiŒ∏|2 dœï ,
z = œÅeiŒ∏,
(1.3.34)
which is valid for a harmonic function U deÔ¨Åned on the unit disk D = {z : |z| < 1}
when |z| < R < 1. See [307, p. 258].
Consider now a subharmonic function u on D that is continuous on the circle
|Œ∂| = R < 1. When U = u, the right side of (1.3.34) deÔ¨Ånes a harmonic function on
the set {z ‚ààC : |z| < R} that coincides with u on the circle |Œ∂| = R. The maximum
principle for subharmonic functions ([307, p. 362]) implies that for |z| < R < 1 we
have
u(z) ‚â§1
2œÄ
 +œÄ
‚àíœÄ u(Reiœï)
R2 ‚àíœÅ2
|Reiœï ‚àíœÅeiŒ∏|2 dœï ,
z = œÅeiŒ∏.
(1.3.35)
This is valid for all subharmonic functions u on D that are continuous on the circle
|Œ∂| = R when œÅ < R < 1.
It is not difÔ¨Åcult to verify that
h(Œ∂) = 1
œÄi log

i1+Œ∂
1‚àíŒ∂

is a conformal map from D onto the strip S = (0,1) √ó R. Indeed, i(1 + Œ∂)/(1 ‚àíŒ∂)
lies in the upper half-plane and the preceding complex logarithm is a well deÔ¨Åned
holomorphic function that takes the upper half-plane onto the strip R√ó(0,œÄ). Since

44
1 Lp Spaces and Interpolation
F ‚ó¶h is a holomorphic function on D, log|F ‚ó¶h| is a subharmonic function on D.
Applying (1.3.35) to the function z ‚Üílog|F(h(z))|, we obtain
log|F(h(z))| ‚â§1
2œÄ
 +œÄ
‚àíœÄ log|F(h(Reiœï))|
R2 ‚àíœÅ2
R2 ‚àí2œÅRcos(Œ∏ ‚àíœï)+œÅ2 dœï
(1.3.36)
when z = œÅeiŒ∏ and |z| = œÅ < R. Observe that when |Œ∂| = 1 and Œ∂ Ã∏= ¬±1, h(Œ∂) has
real part zero or one. It follows from the hypothesis that
log|F(h(Œ∂))| ‚â§AeœÑ0|Imh(Œ∂)| = AeœÑ0
Im 1
œÄi log

i 1+Œ∂
1‚àíŒ∂
 = Ae
œÑ0
œÄ
log
 1+Œ∂
1‚àíŒ∂

 .
Therefore, log|F(h(Œ∂))| is bounded by a multiple of |1+Œ∂|‚àíœÑ0/œÄ|1‚àíŒ∂|‚àíœÑ0/œÄ, which
is integrable over the set |Œ∂| = 1, since œÑ0 < œÄ. Fix now z = œÅeiŒ∏ with œÅ < R and let
R ‚Üí1 in (1.3.36). The Lebesgue dominated convergence theorem gives that
log|F(h(œÅeiŒ∏))| ‚â§1
2œÄ
 +œÄ
‚àíœÄ log|F(h(eiœï))|
1‚àíœÅ2
1‚àí2œÅ cos(Œ∏ ‚àíœï)+œÅ2 dœï .
(1.3.37)
Setting x = h(œÅeiŒ∏), we obtain that
œÅeiŒ∏ = h‚àí1(x) = eœÄix ‚àíi
eœÄix +i = ‚àíi
cos(œÄx)
1+sin(œÄx) =

cos(œÄx)
1+sin(œÄx)

e‚àíi(œÄ/2) ,
from which it follows that œÅ = (cos(œÄx))/(1 + sin(œÄx)) and Œ∏ = ‚àíœÄ/2 when 0 <
x ‚â§1
2, while œÅ = ‚àí(cos(œÄx))/(1+sin(œÄx)) and Œ∏ = œÄ/2 when 1
2 ‚â§x < 1. In either
case we easily deduce that
1‚àíœÅ2
1‚àí2œÅ cos(Œ∏ ‚àíœï)+œÅ2 =
sin(œÄx)
1+cos(œÄx)sin(œï) .
Using this we write (1.3.37) as
log|F(x)| ‚â§1
2œÄ
 œÄ
‚àíœÄ
sin(œÄx)
1+cos(œÄx)sin(œï) log|F(h(eiœï))|dœï .
(1.3.38)
We now change variables. On the interval [‚àíœÄ,0) we use the change of variables
it = h(eiœï) or, equivalently, eiœï = ‚àítanh(œÄt)‚àíisech(œÄt). Observe that as œï ranges
from ‚àíœÄ to 0, t ranges from +‚àûto ‚àí‚àû. Furthermore, dœï = ‚àíœÄ sech(œÄt)dt. We
have
1
2œÄ
 0
‚àíœÄ
sin(œÄx)
1+cos(œÄx)sin(œï) log|F(h(eiœï))|dœï
= 1
2
 ‚àû
‚àí‚àû
sin(œÄx)
cosh(œÄt)‚àícos(œÄx) log|F(it)|dt .
(1.3.39)

1.3 Interpolation
45
On the interval (0,œÄ] we use the change of variables 1+it = h(eiœï) or, equivalently,
eiœï = ‚àítanh(œÄt) + isech(œÄt). Observe that as œï ranges from 0 to œÄ, t ranges from
‚àí‚àûto +‚àû. Furthermore, dœï = œÄ sech(œÄt)dt. Similarly, we obtain
1
2œÄ
 œÄ
0
sin(œÄt)
1+cos(œÄt)sin(œï) log|F(h(eiœï))|dœï
= 1
2
 +‚àû
‚àí‚àû
sin(œÄx)
cosh(œÄt)+cos(œÄx) log|F(1+it)|dt.
(1.3.40)
Adding (1.3.39) and (1.3.40) and using (1.3.38) we conclude the proof when y = 0.
We now consider the case where y Ã∏= 0. Fix y Ã∏= 0 and deÔ¨Åne the function G(z) =
F(z + iy). Then G is analytic on the open strip S = {z ‚ààC : 0 < Re z < 1} and
continuous on its closure. Moreover, for some A < ‚àûand 0 ‚â§œÑ0 < œÄ we have
log|G(z)| = log|F(z+iy)| ‚â§AeœÑ0|Im z+y| ‚â§AeœÑ0|y| eœÑ0|Im z|
for all z ‚ààS. Then the case y = 0 for G (with A replaced by AeœÑ0|y|) yields
|G(x)| ‚â§exp
$sin(œÄx)
2
 ‚àû
‚àí‚àû

log|G(it)|
cosh(œÄt)‚àícos(œÄx) +
log|G(1+it)|
cosh(œÄt)+cos(œÄx)

dt
%
,
which yields the required conclusion for any real y, since G(x) = F(x+iy), G(it) =
F(it +iy), and G(1+it) = F(1+it +iy).
‚ñ°
Exercises
1.3.1. Generalize Theorem 1.3.2 to the situation in which T is quasi-subadditive,
that is, it satisÔ¨Åes for some K > 0,
|T( f +g)| ‚â§K(|T( f)|+|T(g)|),
for all f, g in the domain of T. Prove that in this case, the constant A in (1.3.7) can
be taken to be K times the constant in (1.3.8).
1.3.2. Let (X,Œº), (Y,ŒΩ) be two œÉ-Ô¨Ånite measure spaces. Let 1 < p < r ‚â§‚àûand
suppose that T be a sublinear operator deÔ¨Åned on the space Lp0(X) + Lp1(X) and
taking values in the space of measurable functions on Y. Assume that T maps L1(X)
to L1,‚àû(Y) with norm A0 and Lr(X) to Lr(Y) with norm A1. Let 0 < p0 < p1 ‚â§‚àû.
Prove that T maps Lp to Lp with norm at most
8(p‚àí1)‚àí1
p A
1p ‚àí1r
1‚àí1r
0
A
1‚àí1p
1‚àí1r
1
.

Hint: First interpolate between L1 and Lr using Theorem 1.3.2 and then interpolate
between L
p+1
2
and Lr using Theorem 1.3.4.


46
1 Lp Spaces and Interpolation
1.3.3. Let 0 < p0 < p < p1 ‚â§‚àûand let T be an operator as in Theorem 1.3.2 that
also satisÔ¨Åes
|T( f)| ‚â§T(| f|),
for all f ‚ààLp0 +Lp1.
(a) If p0 = 1 and p1 = ‚àû, prove that T maps Lp to Lp with norm at most
p
p‚àí1A
1
p
0 A
1‚àí1
p
1
.
(b) More generally, if p0 < p < ‚àû, prove that the norm of T from Lp to Lp is at most
p1+ 1
p
B(p0 +1, p‚àíp0)
pp0
0 (p‚àíp0)p‚àíp0
 1
p
A
p0
p
0 A
1‚àíp0
p
1
,
where B(s,t) =
 1
0 xs‚àí1(1‚àíx)t‚àí1 dx is the usual Beta function.
(c) When 0 < p0 < p1 < ‚àû, then the norm of T from Lp to Lp is at most
min
0<Œª<1 p
1
p
B(p‚àíp0, p0 +1)
(1‚àíŒª)p0
+
p1‚àíp+1
p1‚àíp
Œª p1
 1
p
A
1p ‚àí1p1
1p0 ‚àí1p1
0
A
1p0 ‚àí1p
1p0 ‚àí1p1
1
.

Hint: The hypothesis |T( f)| ‚â§T(| f|) reduces matters to nonnegative functions.
Parts (a), (b): Given f ‚â•0 and Œ± > 0 write f = f0 + f1, where f0 = f ‚àíŒªŒ±/A1
when f ‚â•ŒªŒ±/A1 and zero otherwise. Here 0 < Œª < 1 to be chosen later. Then we
have that |{|T( f)| > Œ±}| ‚â§|{|T( f0)| > (1 ‚àíŒª)Œ±}|. Part (c): Write f = f0 + f1,
where f0 = f ‚àíŒ¥Œ± when f ‚â•Œ¥Œ± and zero otherwise. Use that
|{|T( f)| > Œ±}| ‚â§|{|T( f0)| > (1‚àíŒª)Œ±}|+|{|T( f1)| > ŒªŒ±}|
and optimize over Œ¥ > 0.

1.3.4. Let 0 ‚â§Œ≥,Œ¥ < œÄ. For every z ‚ààSa,b = {z ‚ààC : a < Rez < b}, let Tz be a
family of linear operators deÔ¨Åned on Ô¨Ånetely simple functions on a œÉ-Ô¨Ånite measure
space (X,Œº) and taking values in another œÉ-Ô¨Ånite measure space (Y,ŒΩ). Assume that
{Tz}z is an analytic on of Sa,b, in the sense of (1.3.21), continuous on its closure, and
that for all simple functions f on X and g on Y there is a constant Cf,g < ‚àûsuch that
for all z ‚ààSa,b,
log


Y Tz( f)gdŒΩ
 ‚â§Cf,g eŒ≥|Imz|/(b‚àía) .
Let 1 ‚â§p0,q0, p1,q1 ‚â§‚àû. Suppose that Ta+iy maps Lp0(X) to Lq0(Y) with bound
M0(y) and Tb+iy maps Lp1(X) to Lq1(Y) with bound M1(y), where
sup
‚àí‚àû<y<‚àû
e‚àíŒ¥|y|/(b‚àía) logMj(y) < ‚àû,
j = 0,1.

1.3 Interpolation
47
Then for a < t < b, Tt maps Lp(X) to Lq(Y), where
1
p =
b‚àít
b‚àía
p0
+
t‚àía
b‚àía
p1
and
1
q =
b‚àít
b‚àía
q0
+
t‚àía
b‚àía
q1
.
1.3.5. ([331]) On Rn let x = (x1,...,xn) and |x| = (x2
1 +¬∑¬∑¬∑+x2
n)1/2. Let
KŒª(x) = œÄ
n‚àí1
2 Œì (Œª +1)
Œì (Œª + n+1
2 )
 +1
‚àí1 e2œÄis|x|(1‚àís2)Œª+ n‚àí1
2 ds = Œì (Œª +1)
œÄŒª|x|Œª+ n
2 JŒª+ n
2 (2œÄ|x|),
where Œª is a complex number and JŒª+ n
2 is the Bessel function of order Œª + n
2. Let TŒª
be the operator given by convolution with KŒª. Show that TŒª maps Lp(Rn) to itself
for ReŒª > (n‚àí1)| 1
2 ‚àí1
p|.

Hint: In view of the calculation of the Fourier transform of KŒª contained in Ap-
pendix B.5, we have that when ReŒª = 0, TŒª maps L2(Rn) to itself with norm 1. Us-
ing the estimates in Appendices B.6 and B.7, conclude that KŒª is integrable and thus
TŒª maps L1(Rn) to itself with an appropriate constant when Re Œª = (n ‚àí1)/2 + Œ¥
(for Œ¥ > 0). Then use Exercise 1.3.4.

1.3.6. Observe that Theorem 1.3.7 yields the stronger conclusion
Tz( f)

Lq ‚â§M(z)
f

Lp
for z ‚ààS = {z ‚ààC : 0 < Re z < 1}, where for z = x+iy
M(z) = exp
$sin(œÄx)
2
 ‚àû
‚àí‚àû

logM0(t +y)
cosh(œÄt)‚àícos(œÄx) +
logM1(t +y)
cosh(œÄt)+cos(œÄx)

dt
%
.
1.3.7. ([380]) Let (X,Œº) and (Y,ŒΩ) be two measure spaces with Œº(X) < ‚àûand
ŒΩ(Y) < ‚àû. Let T be a countably subadditive operator that maps Lp(X) to Lp(Y)
for every 1 < p ‚â§2 with norm ‚à•T‚à•Lp‚ÜíLp ‚â§A(p ‚àí1)‚àíŒ± for some Ô¨Åxed A,Œ± > 0.
(Countably subadditive means that |T(‚àëj f j)| ‚â§‚àëj |T( f j)| for all f j in Lp(X) with
‚àëj f j ‚ààLp.) Prove that for all f measurable on X we have

Y |T( f)|dŒΩ ‚â§6A(1+ŒΩ(Y))
1
2

X | f|(log+
2 | f|)Œ± dŒº +CŒ± + Œº(X)
1
2

,
where CŒ± = ‚àë‚àû
k=1 kŒ±(2/3)k. This result provides an example of extrapolation.

Hint: Write
f =
‚àû
‚àë
k=0
f œáSk ,
where Sk = {2k ‚â§| f| < 2k+1} when k ‚â•1 and S0 = {| f| < 2}. Using H¬®older‚Äôs
inequality and the hypotheses on T, obtain that

Y |T( f œáSk)|dŒΩ ‚â§2AŒΩ(Y)
1
k+1 2kkŒ±Œº(Sk)
k
k+1

48
1 Lp Spaces and Interpolation
for k ‚â•1. Note that for k ‚â•1 we have ŒΩ(Y)
1
k+1 ‚â§max(1,ŒΩ(Y))
1
2 and consider the
cases Œº(Sk) ‚â•3‚àík‚àí1 and Œº(Sk) ‚â§3‚àík‚àí1 when summing in k ‚â•1. The term with
k = 0 is easier.

1.3.8. Prove that for 0 < x < 1 we have
sin(œÄx)
2
 +‚àû
‚àí‚àû
1
cosh(œÄt)+cos(œÄx) dt = x,
sin(œÄx)
2
 +‚àû
‚àí‚àû
1
cosh(œÄt)‚àícos(œÄx) dt = 1‚àíx,
and conclude that Lemma 1.3.8 reduces to Lemma 1.3.5 when the functions M0(y)
and M1(y) are constant and assumption (1.3.29) is replaced by the stronger assump-
tion that F is bounded on S.

Hint: In the Ô¨Årst integral write cosh(œÄt) = 1
2(eœÄt + e‚àíœÄt). Then use the change of
variables s = eœÄt.

1.3.9. Let (X,Œº), (Y,ŒΩ) be œÉ-Ô¨Ånite measure spaces, and let 0 < p0 < p1 ‚â§‚àû. Let
T be a sublinear operator deÔ¨Åned on the space Lp0(X) + Lp1(X) and taking values
in the space of measurable functions on Y. Suppose T is a sublinear operator such
that maps Lp0 to L‚àûwith constant A0 and Lp1 to L‚àûwith constant A1. Prove T maps
Lp to L‚àûwith constant 2A1‚àíŒ∏
0
AŒ∏
1 where
1‚àíŒ∏
p0
+ Œ∏
p1
= 1
p .
1.4 Lorentz Spaces
Suppose that f is a measurable function on a measure space (X,Œº). It would be de-
sirable to have another function f ‚àódeÔ¨Åned on [0,‚àû) that is decreasing and equidis-
tributed with f. By this we mean
df (Œ±) = df ‚àó(Œ±)
(1.4.1)
for all Œ± ‚â•0. This is achieved via a simple construction discussed in this section.
1.4.1 Decreasing Rearrangements
DeÔ¨Ånition 1.4.1. Let f be a complex-valued function deÔ¨Åned on X. The decreasing
rearrangement of f is the function f ‚àódeÔ¨Åned on [0,‚àû) by
f ‚àó(t) = inf{s > 0 : df (s) ‚â§t} = inf{s ‚â•0 : df (s) ‚â§t}.
(1.4.2)

1.4 Lorentz Spaces
49
We adopt the convention inf /0 = ‚àû, thus having f ‚àó(t) = ‚àûwhenever df (Œ±) > t for
all Œ± ‚â•0. Observe that f ‚àóis decreasing and supported in [0,Œº(X)].
Before we proceed with properties of the function f ‚àó, we work out three
examples.
f (x)
a3
a2
a1
E3
E1
B2
B3
E2
x
a1
a2
a3
0
0
B1
t
f*(t)
.
.
.
.
Fig. 1.3 The graph of a simple function f(x) and its decreasing rearrangement f ‚àó(t).
Example 1.4.2. Consider the simple function of Example 1.1.2,
f(x) =
N
‚àë
j=1
ajœáE j(x),
where Ej are pairwise disjoint sets of Ô¨Ånite measure and a1 > ¬∑¬∑¬∑ > aN > 0. We saw
in Example 1.1.2 that
df (Œ±) =
N
‚àë
j=0
Bjœá[a j+1,a j)(Œ±),
where
Bj =
j
‚àë
i=1
Œº(Ei)
and aN+1 = B0 = 0 and a0 = ‚àû. Observe that for B0 ‚â§t < B1, the smallest s > 0
with df (s) ‚â§t is a1. Similarly, for B1 ‚â§t < B2, the smallest s > 0 with df (s) ‚â§t is
a2. Arguing this way, it is not difÔ¨Åcult to see that
f ‚àó(t) =
N
‚àë
j=1
ajœá[B j‚àí1,B j)(t).
See Figure 1.3.
Example 1.4.3. On (Rn,dx) let
f(x) =
1
1+|x|p ,
0 < p < ‚àû.

50
1 Lp Spaces and Interpolation
A computation shows that
df (Œ±) =

vn( 1
Œ± ‚àí1)
n
p
if Œ± < 1,
0
if Œ± ‚â•1,
and therefore
f ‚àó(t) =
1
(t/vn)p/n +1 ,
where vn is the volume of the unit ball in Rn.
Example 1.4.4. Again on (Rn,dx) let g(x) = 1 ‚àíe‚àí|x|2. We can easily see that
dg(Œ±) = 0 if Œ± ‚â•1 and dg(Œ±) = ‚àûif Œ± < 1. We conclude that g‚àó(t) = 1 for all
t ‚â•0. This example indicates that although quantitative information is preserved,
signiÔ¨Åcant qualitative information is lost in passing from a function to its decreasing
rearrangement.
It is clear from the previous examples that f ‚àóis continuous from the right and
decreasing. The following are some properties of the function f ‚àó.
Proposition 1.4.5. For f, g, fn Œº-measurable, k ‚ààC, and 0 ‚â§t,s,t1,t2 < ‚àûwe have
(1)
f ‚àó(df (Œ±)) ‚â§Œ± whenever Œ± > 0.
(2)
df ( f ‚àó(t)) ‚â§t.
(3)
f ‚àó(t) > s if and only if t < df (s); that is, {t ‚â•0 : f ‚àó(t) > s} = [0,df (s)).
(4)
|g| ‚â§| f| Œº-a.e. implies that g‚àó‚â§f ‚àóand | f|‚àó= f ‚àó.
(5)
(k f)‚àó= |k| f ‚àó.
(6)
( f +g)‚àó(t1 +t2) ‚â§f ‚àó(t1)+g‚àó(t2).
(7)
( fg)‚àó(t1 +t2) ‚â§f ‚àó(t1)g‚àó(t2).
(8)
| fn| ‚Üë| f| Œº-a.e. implies f ‚àó
n ‚Üëf ‚àó.
(9)
| f| ‚â§liminf
n‚Üí‚àû| fn| Œº-a.e. implies f ‚àó‚â§liminf
n‚Üí‚àûf ‚àó
n .
(10)
f ‚àóis right continuous on [0,‚àû).
(11)
If f ‚àó(t) < ‚àû, c > 0, and Œº({| f| ‚â•f ‚àó(t)‚àíc}) < ‚àû, then t ‚â§Œº({| f| ‚â•f ‚àó(t)}).
(12)
df = df ‚àó.
(13)
(| f|p)‚àó= ( f ‚àó)p when 0 < p < ‚àû.
(14)

X | f|p dŒº =
 ‚àû
0
f ‚àó(t)p dt when 0 < p < ‚àû.
(15)
 f

L‚àû= f ‚àó(0).
(16)
sup
t>0
tq f ‚àó(t) = sup
Œ±>0
Œ±

df (Œ±)
q for 0 < q < ‚àû.

1.4 Lorentz Spaces
51
Proof. Property (1): The set A = {s > 0 : df (s) ‚â§df (Œ±)} contains Œ± and thus
f ‚àó(df (Œ±)) = infA ‚â§Œ±.
Property (2): Let sn ‚àà{s > 0 : df (s) ‚â§t} be such that sn ‚Üìf ‚àó(t). Then df (sn) ‚â§t,
and the right continuity of df (Exercise 1.1.1 (a)) implies that df ( f ‚àó(t)) ‚â§t.
Property (3): If s < f ‚àó(t) = inf{u > 0 : df (u) ‚â§t}, then s /‚àà{u > 0 : df (u) ‚â§t}
which gives df (s) > t. Conversely, if for some t < df (s) we had f ‚àó(t) ‚â§s, applying
df and using property (2) would yield the contradiction df (s) ‚â§df ( f ‚àó(t)) ‚â§t.
Properties (4) and (5) are left to the reader.
Properties (6) and (7): Let A = {s1 > 0 : df (s1) ‚â§t1}, B = {s2 > 0 : dg(s2) ‚â§t2},
P = {s > 0 : dfg(s) ‚â§t1 +t2}, and S = {s > 0 : df+g(s) ‚â§t1 +t2}. Then A+B ‚´ÖS
and A¬∑B ‚´ÖP; thus ( f +g)‚àó(t1+t2) = infS ‚â§s1+s2 and ( fg)‚àó(t1+t2) = infP ‚â§s1s2
are valid for all s1 ‚ààA and s2 ‚ààB. Taking the inÔ¨Åmum over all s1 ‚ààA and s2 ‚ààB
yields the conclusions.
Property (8): It follows from the deÔ¨Ånition of decreasing rearrangements that
f ‚àó
n ‚â§f ‚àó
n+1 ‚â§f ‚àófor all n. Let h = limn‚Üí‚àûf ‚àó
n ; then obviously h ‚â§f ‚àó. Since f ‚àó
n ‚â§h,
we have dfn(h(t)) ‚â§dfn( f ‚àó
n (t)) ‚â§t, which implies, in view of Exercise 1.1.1 (c), that
df (h(t)) ‚â§t by letting n ‚Üí‚àû. It follows that f ‚àó‚â§h, hence h = f ‚àó.
Property (9): Set Fn = infm‚â•n | fm| and h = liminfn‚Üí‚àû| fn| = supn‚â•1 Fn. Since Fn ‚Üë
h, property (8) yields that F‚àó
n ‚Üëh‚àóas n ‚Üí‚àû. By hypothesis we have | f| ‚â§h, hence
f ‚àó‚â§h‚àó= supn F‚àó
n . Since Fn ‚â§| fm| for m ‚â•n, it follows that F‚àó
n ‚â§f ‚àó
m for m ‚â•n; thus
F‚àó
n ‚â§infm‚â•n f ‚àó
m. Putting these facts together, we obtain f ‚àó‚â§h‚àó‚â§supn infm‚â•n f ‚àó
m =
liminfn‚Üí‚àûf ‚àó
n .
Property (10): If f ‚àó(t0) = 0, then f ‚àó(t) = 0 for all t > t0 and thus f ‚àóis right
continuous at t0. Suppose f ‚àó(t0) > 0. Pick Œ± such that 0 < Œ± < f ‚àó(t0) and let {tn}‚àû
n=1
be a sequence of real numbers decreasing to zero. The deÔ¨Ånition of f ‚àóyields that
df ( f ‚àó(t0) ‚àíŒ±) > t0. Since tn ‚Üì0, there is an n0 ‚ààZ+ such that df ( f ‚àó(t0) ‚àíŒ±) >
t0 +tn for all n ‚â•n0. Property (3) yields that for all n ‚â•n0 we have f ‚àó(t0) ‚àíŒ± <
f ‚àó(t0 +tn), and since the latter is at most f ‚àó(t0), the right continuity of f ‚àófollows.
Property (11): The deÔ¨Ånition of f ‚àóyields that the set An = {| f| > f ‚àó(t) ‚àíc/n}
has measure Œº(An) > t. The sets An form a decreasing sequence as n increases and
Œº(A1) < ‚àûby assumption. Consequently, {| f| ‚â•f ‚àó(t)} = ‚àû
n=1 An has measure
greater than or equal to t.
Property (12): This is immediate for nonnegative simple functions in view of
Examples 1.1.2 and 1.4.2. For an arbitrary measurable function f, Ô¨Ånd a sequence of
nonnegative simple functions fn such that fn ‚Üë| f| and apply (9).
Property (13): It follows from d| f|p(Œ±) = df (Œ±1/p) = df ‚àó(Œ±1/p) = d( f ‚àó)p(Œ±) for
all Œ± > 0.
Property (14): This is a consequence of property (12) and of Proposition 1.1.4.
Property (15): This is a restatement of (1.1.2).
Property (16): Given Œ± > 0, without loss of generality we may assume df (Œ±) > 0.
Pick Œµ satisfying 0 < Œµ < df (Œ±). Property (3) yields f ‚àó(df (Œ±) ‚àíŒµ) > Œ±, which
implies that
sup
t>0
tq f ‚àó(t) ‚â•(df (Œ±)‚àíŒµ)q f ‚àó(df (Œ±)‚àíŒµ) > (df (Œ±)‚àíŒµ)qŒ± .

52
1 Lp Spaces and Interpolation
We Ô¨Årst let Œµ ‚Üí0 and then take the supremum over all Œ± > 0 to obtain one direction.
Conversely, given t > 0, assume without loss of generality that f ‚àó(t) > 0, and pick
Œµ such that 0 < Œµ < f ‚àó(t). Property (3) yields df ( f ‚àó(t) ‚àíŒµ) > t. This implies that
supŒ±>0 Œ±(df (Œ±))q ‚â•( f ‚àó(t)‚àíŒµ)(df ( f ‚àó(t)‚àíŒµ))q > ( f ‚àó(t)‚àíŒµ)tq. We Ô¨Årst let Œµ ‚Üí0
and then take the supremum over all t > 0 to obtain the opposite direction of the
claimed equality.
‚ñ°
1.4.2 Lorentz Spaces
Having disposed of the basic properties of decreasing rearrangements of functions,
we proceed with the deÔ¨Ånition of the Lorentz spaces.
DeÔ¨Ånition 1.4.6. Given f a measurable function on a measure space (X,Œº) and
0 < p,q ‚â§‚àû, deÔ¨Åne
 f

Lp,q =
‚éß
‚é™
‚é™
‚é®
‚é™
‚é™
‚é©
 ‚àû
0

t
1
p f ‚àó(t)
q dt
t
 1
q
if q < ‚àû,
sup
t>0
t
1
p f ‚àó(t)
if q = ‚àû.
The set of all f with ‚à•f‚à•Lp,q < ‚àûis denoted by Lp,q(X,Œº) and is called the Lorentz
space with indices p and q.
As in Lp and in weak Lp, two functions in Lp,q(X,Œº) are considered equal if they
are equal Œº-almost everywhere. Observe that the previous deÔ¨Ånition implies that
L‚àû,‚àû= L‚àû, Lp,‚àû= weak Lp in view of Proposition 1.4.5 (16) and that Lp,p = Lp.
Remark 1.4.7. Observe that for all 0 < p,r < ‚àûand 0 < q ‚â§‚àûwe have
|g|r
Lp,q =
g
r
Lpr,qr .
(1.4.3)
On Rn let Œ¥ Œµ( f)(x) = f(Œµx), Œµ > 0, be the dilation operator. It is straightforward
that dŒ¥ Œµ( f)(Œ±) = Œµ‚àíndf (Œ±) and (Œ¥ Œµ( f))‚àó(t) = f ‚àó(Œµnt). It follows that Lorentz norms
satisfy the following dilation identity:
Œ¥ Œµ( f)

Lp,q = Œµ‚àín/pf

Lp,q .
(1.4.4)
Next, we calculate the Lorentz norms of a Ô¨Ånitely simple function.
Example 1.4.8. Using the notation of Example 1.4.2, when 0 < p,q < ‚àûwe have
f

Lp,q =
 p
q
 1
q 
aq
1B
q
p
1 +aq
2

B
q
p
2 ‚àíB
q
p
1

+¬∑¬∑¬∑+aq
N

B
q
p
N ‚àíB
q
p
N‚àí1
 1
q
,

1.4 Lorentz Spaces
53
and also
f

Lp,‚àû= sup
1‚â§j‚â§N
ajB
1
p
j .
Next, we calculate ‚à•f‚à•L‚àû,q for the simple function f of Example 1.4.2. when
q < ‚àû. It turns out that
f

L‚àû,q =

aq
1 log
B1
B0

+aq
2 log
B2
B1

+¬∑¬∑¬∑+aq
N log
 BN
BN‚àí1
 1
q
= ‚àû,
since B0 = 0. We conclude that the only nonnegative simple function with Ô¨Ånite L‚àû,q
norm is the zero function. Given a general nonzero function g ‚ààL‚àû,q with 0 < q < ‚àû,
there is a nonzero simple function s with 0 ‚â§s ‚â§g. Then s has inÔ¨Ånite norm, and
therefore so does g. We deduce that L‚àû,q(X) = {0} when 0 < q < ‚àû.
Proposition 1.4.9. For 0 < p < ‚àûand 0 < q ‚â§‚àû, we have the identity
f

Lp,q =
‚éß
‚é™
‚é®
‚é™
‚é©
p
1
q
 ‚àû
0

df (s)
1
p s
q ds
s
 1
q
when q < ‚àû
sups>0 sdf (s)
1
p
when q = ‚àû.
(1.4.5)
Proof. The case q = ‚àûis statement (16) in Proposition 1.4.5, and we may therefore
concentrate on the case q < ‚àû. If f is the simple function of Example 1.1.2, then
df (s) =
N
‚àë
j=1
Bjœá[a j+1,a j)(s)
with the understanding that aN+1 = 0. Using the this formula and identity in Exam-
ple 1.4.8, we obtain the validity of (1.4.5) for simple functions. In general, given a
measurable function f, Ô¨Ånd a sequence of nonnegative simple functions such that
fn ‚Üë| f| a.e. Then dfn ‚Üëdf (Exercise 1.1.1 (c)) and f ‚àó
n ‚Üëf ‚àó(Proposition 1.4.5 (8)).
Using the Lebesgue monotone convergence theorem we deduce (1.4.5).
‚ñ°
Since Lp,p ‚´ÖLp,‚àû, one may wonder whether these spaces are nested. The next
result shows that for any Ô¨Åxed p, the Lorentz spaces Lp,q increase as the exponent q
increases.
Proposition 1.4.10. Suppose 0 < p ‚â§‚àûand 0 < q < r ‚â§‚àû. Then there exists a
constant cp,q,r (which depends on p, q, and r) such that
f

Lp,r ‚â§cp,q,r
f

Lp,q .
(1.4.6)
In other words, Lp,q is a subspace of Lp,r.

54
1 Lp Spaces and Interpolation
Proof. We may assume p < ‚àû, since the case p = ‚àûis trivial. We have
t1/p f ‚àó(t) =
$ q
p
 t
0 [s1/p f ‚àó(t)]q ds
s
%1/q
‚â§
$ q
p
 t
0 [s1/p f ‚àó(s)]q ds
s
%1/q
since f ‚àóis decreasing,
‚â§
 q
p
1/q f

Lp,q .
Hence, taking the supremum over all t > 0, we obtain
f

Lp,‚àû‚â§
 q
p
1/q f

Lp,q .
(1.4.7)
This establishes (1.4.6) in the case r = ‚àû. Finally, when r < ‚àû, we have
 f

Lp,r =
$ ‚àû
0 [t1/p f ‚àó(t)]r‚àíq+q dt
t
%1/r
‚â§
 f
(r‚àíq)/r
Lp,‚àû
f
q/r
Lp,q .
(1.4.8)
Inequality (1.4.7) combined with (1.4.8) gives (1.4.6) with cp,q,r = (q/p)(r‚àíq)/rq. ‚ñ°
Unfortunately, the functionals ‚à•¬∑ ‚à•Lp,q do not satisfy the triangle inequality. For
instance, consider the functions f(t) = t and g(t) = 1 ‚àít deÔ¨Åned on [0,1]. Then
f ‚àó(Œ±) = g‚àó(Œ±) = (1 ‚àíŒ±)œá[0,1](Œ±). A simple calculation shows that the inequality
‚à•f +g‚à•Lp,q ‚â§‚à•f‚à•Lp,q +‚à•g‚à•Lp,q would be equivalent to
p
q ‚â§2q Œì (q+1)Œì (q/p)
Œì (q+1+q/p) ,
which fails in general. However, since for all t > 0 we have
( f +g)‚àó(t) ‚â§f ‚àó(t/2)+g‚àó(t/2),
the estimate
 f +g

Lp,q ‚â§cp,q
 f

Lp,q +
g

Lp,q

,
(1.4.9)
where cp,q = 21/p max(1,2(1‚àíq)/q), is a consequence of (1.1.4). Also, if ‚à•f‚à•Lp,q = 0
then we must have f = 0 Œº-a.e. Therefore, Lp,q is a quasi-normed space for all p,q
with 0 < p,q ‚â§‚àû. Is this space complete with respect to its quasi-norm? The next
theorem answers this question.
Theorem 1.4.11. Let (X,Œº) be a measure space. Then for all 0 < p,q ‚â§‚àû, the
spaces Lp,q(X,Œº) are complete with respect to their quasi-norm and they are there-
fore quasi-Banach spaces.

1.4 Lorentz Spaces
55
Proof. We consider only the case p < ‚àû. First we note that convergence in Lp,q
implies convergence in measure. When q = ‚àû, this is proved in Proposition 1.1.9.
When q < ‚àû, in view of Proposition 1.4.5 (16) and (1.4.7), it follows that
sup
t>0
t1/p f ‚àó(t) = sup
Œ±>0
Œ±df (Œ±)1/p ‚â§
 q
p
1/q f

Lp,q
for all f ‚ààLp,q, and from this it follows that convergence in Lp,q implies convergence
in measure.
Now let {fn} be a Cauchy sequence in Lp,q. Then {fn} is Cauchy in measure,
and hence it has a subsequence {fnk} that converges almost everywhere to some f by
Theorem 1.1.13. Fix k0 and apply property (9) in Proposition 1.4.5. Since | f ‚àífnk0| =
limk‚Üí‚àû| fnk ‚àífnk0|, it follows that
( f ‚àífnk0)‚àó(t) ‚â§liminf
k‚Üí‚àû( fnk ‚àífnk0)‚àó(t).
(1.4.10)
Raise (1.4.10) to the power q, multiply by tq/p, integrate with respect to dt/t over
(0,‚àû), and apply Fatou‚Äôs lemma to obtain
 f ‚àífnk0
q
Lp,q ‚â§liminf
k‚Üí‚àû
fnk ‚àífnk0
q
Lp,q.
(1.4.11)
Now let k0 ‚Üí‚àûin (1.4.11) and use the fact that {fn} is Cauchy to conclude that fnk
converges to f in Lp,q. It is a general fact that if a Cauchy sequence has a convergent
subsequence in a quasi-normed space, then the sequence is convergent to the same
limit. It follows that fn converges to f in Lp,q.
‚ñ°
Remark 1.4.12. It can be shown that the spaces Lp,q are normable when p, q are
bigger than 1; see Exercise 1.4.3. Therefore, these spaces can be normed to become
Banach spaces.
It is well known that Ô¨Ånitely simple functions are dense in Lp of any measure
space, when 0 < p < ‚àû. It is natural to ask whether Ô¨Ånitely simple functions are also
dense in Lp,q. This is in fact the case when q Ã∏= ‚àû.
Theorem 1.4.13. Finitely simple functions are dense in Lp,q(X,Œº) when 0 < q < ‚àû.
Proof. Let f ‚ààLp,q(X,Œº). Assume without loss of generality that f ‚â•0. Since f
lies in Lp,q ‚´ÖLp,‚àûwe have Œº({f > Œµ})1/pŒµ ‚â§‚à•f‚à•Lp,q < ‚àûfor every Œµ > 0 and
consequently for any A > 0, Œº({f > A}) is Ô¨Ånite and tends to zero as A ‚Üí‚àû. Thus
for every n = 1,2,3,..., there is an An > 0 such that Œº({f > An}) < 2‚àín.
For each n = 1,2,3,... deÔ¨Åne the function
œïn(x) =
1+2nAn
‚àë
k=0
k
2n œá{k2‚àín< f‚â§(k+1)2‚àín}œá{2‚àín< f‚â§An} .

56
1 Lp Spaces and Interpolation
Then œïn is supported in the set {2‚àín < f ‚â§An} which has Ô¨Ånite Œº measure, thus œïn
is Ô¨Ånitely simple and satisÔ¨Åes
f(x)‚àí2‚àín ‚â§œïn(x) ‚â§f(x)
for every x ‚àà{x ‚ààX : 2‚àín < f(x) ‚â§An}. It follows that
Œº({x ‚ààX : | f(x)‚àíœïn(x)| > 2‚àín}) < 2‚àín
which implies that ( f ‚àíœïn)‚àó(t) ‚â§2‚àín for t ‚â•2‚àín. Thus
( f ‚àíœïn)‚àó(t) ‚Üí0
as n ‚Üí‚àûand
œï‚àó
n(t) ‚â§f ‚àó(t)
for all t > 0.
Since ( f ‚àíœïn)‚àó(t) ‚â§f ‚àó(t), an application of the Lebesgue dominated convergence
theorem gives that ‚à•œïn ‚àíf‚à•Lp,q ‚Üí0 as n ‚Üí‚àû.
‚ñ°
Remark 1.4.14. One may wonder whether simple functions are dense in Lp,‚àû. This
turns out to be false for all 0 < p ‚â§‚àû. However, countable linear combinations of
characteristic functions of sets with Ô¨Ånite measure are dense in Lp,‚àû(X,Œº). We call
such functions countably simple. See Exercise 1.4.4 for details.
1.4.3 Duals of Lorentz Spaces
Given a quasi-Banach space Z with norm ‚à•¬∑ ‚à•Z, its dual Z‚àóis deÔ¨Åned as the space
of all continuous linear functionals T on Z equipped with the norm
T

Z‚àó= sup
‚à•x‚à•Z=1
|T(x)|.
Observe that the dual of a quasi-Banach space is always a Banach space.
We are now considering the following question: What are the dual spaces (Lp,q)‚àó
of Lp,q? The answer to this question presents some technical difÔ¨Åculties for general
measure spaces. In this exposition we restrict our attention to œÉ-Ô¨Ånite nonatomic
measure spaces, where the situation is simpler.
DeÔ¨Ånition 1.4.15. A measurable subset A of a measure space (X,Œº) is called an
atom if Œº(A) > 0 and every measurable subset B of A has measure either equal to
zero or equal to Œº(A). A measure space (X,Œº) is called nonatomic if it contains no
atoms. In other words, X is nonatomic if and only if for any A ‚´ÖX with Œº(A) > 0,
there exists a proper subset B ‚´ãA with Œº(B) > 0 and Œº(A\B) > 0.
For instance, R with Lebesgue measure is nonatomic, but any measure space
with counting measure is atomic. Nonatomic spaces have the property that every
measurable subset of them with strictly positive measure contains subsets of any
given measure smaller than the measure of the original subset. See Exercise 1.4.5.

1.4 Lorentz Spaces
57
Theorem 1.4.16. Suppose that (X,Œº) is a nonatomic œÉ-Ô¨Ånite measure space. Then
(i)
(Lp,q)‚àó= {0},
when 0 < p < 1, 0 < q ‚â§‚àû,
(ii)
(Lp,q)‚àó= L‚àû,
when p = 1, 0 < q ‚â§1,
(iii)
(Lp,q)‚àó= {0},
when p = 1, 1 < q < ‚àû,
(iv)
(Lp,q)‚àóÃ∏= {0},
when p = 1, q = ‚àû,
(v)
(Lp,q)‚àó= Lp‚Ä≤,‚àû,
when 1 < p < ‚àû, 0 < q ‚â§1,
(vi)
(Lp,q)‚àó= Lp‚Ä≤,q‚Ä≤,
when 1 < p < ‚àû, 1 < q < ‚àû,
(vii)
(Lp,q)‚àóÃ∏= {0},
when 1 < p < ‚àû, q = ‚àû,
(viii)
(Lp,q)‚àóÃ∏= {0},
when p = q = ‚àû.
Proof. Since X is œÉ-Ô¨Ånite, we have X = ‚àû
N=1 KN, where KN is an increasing se-
quence of sets with Œº(KN) < ‚àû. Let A be the œÉ-algebra on which Œº is deÔ¨Åned
and deÔ¨Åne AN = {A ‚à©KN : A ‚ààA }. Given T ‚àà(Lp,q)‚àó, where 0 < p,q < ‚àû, for
each N = 1,2,..., consider the measure œÉN(E) = T(œáE) deÔ¨Åned on AN. Since œÉN
satisÔ¨Åes |œÉN(E)| ‚â§(p/q)1/q‚à•T‚à•Œº(E)1/p, it follows that œÉN is absolutely continu-
ous with respect to Œº restricted on AN. By the Radon‚ÄìNikodym theorem (see [153]
(19.36)), there exists a unique (up to a set of Œº-measure zero) complex-valued mea-
surable function gN which satisÔ¨Åes

KN |gN|dŒº < ‚àûsuch that

KN
f dœÉN =

KN
gN f dŒº
(1.4.12)
for all f in L1(KN,AN,œÉN). Since œÉN = œÉN+1 on AN, it follows that gN = gN+1
Œº-a.e. on KN and hence there is a well-deÔ¨Åned measurable function g on X that co-
incides with each gN on KN. But the linear functionals f ‚ÜíT( f) and f ‚Üí

KN f dœÉN
coincide on simple functions supported in KN and therefore they must be equal on
L1(KN,AN,œÉN)‚à©Lp,q(X,Œº) by density; consequently, (1.4.12) is also equal to T( f)
for f in L1(KN,AN,œÉN)‚à©Lp,q(X,Œº).
Note that if f ‚ààL‚àû(KN,Œº), then f ‚ààLp,q(KN,Œº) and also in L‚àû(KN,œÉN), which is
contained in L1(KN,AN,œÉN). It follows from (1.4.12) and the preceding discussion
that
T( f) =

X g f dŒº
(1.4.13)
for every f ‚ààL‚àû(KN). We have now proved that for every linear functional T on
Lp,q(X,Œº) with 0 < p,q < ‚àûthere is a function g satisfying

KN |g|dŒº < ‚àûfor all
N = 1,2,... such that (1.4.13) holds for all f ‚ààL‚àû(KN).
We now examine each case (i)‚Äì(viii) separately.
(i) We consider the case 0 < p < 1. Let f = ‚àën anœáEn be a Ô¨Ånitely simple function
on X (which is taken to be countably simple when q = ‚àû). Since X is nonatomic,
we split each En as a union of m disjoint sets Ej,n, j = 1,2,...,m, each having
measure m‚àí1Œº(En). Let f j = ‚àën anœáE j,n. We see that ‚à•f j‚à•Lp,q = m‚àí1/p‚à•f‚à•Lp,q. Now
if T ‚àà(Lp,q)‚àó, it follows that

58
1 Lp Spaces and Interpolation
|T( f)| ‚â§
m
‚àë
j=1
|T( f j)| ‚â§‚à•T‚à•
m
‚àë
j=1
f j

Lp,q = ‚à•T‚à•m1‚àí1/p‚à•f‚à•Lp,q .
Let m ‚Üí‚àûand use that p < 1 to obtain that T = 0.
(ii) We now consider the case p = 1 and 0 < q ‚â§1. Clearly, every h ‚ààL‚àûgives a
bounded linear functional on L1,q, since


X f hdŒº
 ‚â§
h

L‚àû
f

L1 ‚â§Cq
h

L‚àû
 f

L1,q .
Conversely, suppose that T ‚àà(L1,q)‚àówhere q ‚â§1. The function g given in (1.4.13)
satisÔ¨Åes


E gdŒº
 =
T(œáE)
 ‚â§
T
q‚àí1/qŒº(E)
for all E ‚´ÖKN, and hence |g| ‚â§q‚àí1/q‚à•T‚à•Œº-a.e. on every KN; see [307, Theorem
1.40 on p. 31] for a proof of this fact. It follows that ‚à•g‚à•L‚àû‚â§q‚àí1/q‚à•T‚à•and hence
(L1,q)‚àó= L‚àû.
(iii) Let us now take p = 1, 1 < q < ‚àû, and suppose that T ‚àà(L1,q)‚àó. Then


X fgdŒº
 ‚â§‚à•T‚à•
f

L1,q,
(1.4.14)
where g is the function in (1.4.13) and f ‚ààL‚àû(KN). We will show that g = 0 a.e.
Suppose that |g| ‚â•Œ¥ on some set E0 with Œº(E0) > 0. Then there exists N such that
Œº(E0 ‚à©KN) > 0. Let f = g|g|‚àí2œáE0‚à©KNhœáh‚â§M, where h is a nonnegative function.
Then (1.4.14) implies for all h ‚â•0 that
hœáh‚â§M

L1(E0‚à©KN) ‚â§‚à•T‚à•
hœáh‚â§M

L1,q(E0‚à©KN) .
Letting M ‚Üí‚àû, we obtain that L1,q(E0 ‚à©KN) is contained in L1(E0 ‚à©KN), but
since the reverse inclusion is always valid, these spaces must be equal. Since X
is nonatomic, this can‚Äôt happen; see Exercise 1.4.8 (d). Thus g = 0 Œº-a.e. and T = 0.
(iv) In the case p = 1, q = ‚àûan interesting phenomenon appears. Since every
continuous linear functional on L1,‚àûextends to a continuous linear functional on
L1,q for 1 < q < ‚àû, it must necessarily vanish on all simple functions by part (iii).
However, (L1,‚àû)‚àócontains nontrivial linear functionals; see [84], [85].
(v) We now take up the case 1 < p < ‚àûand 0 < q ‚â§1. Using Exercise 1.4.1 (b)
and Proposition 1.4.10, we see that if f ‚ààLp,q and h ‚ààLp‚Ä≤,‚àû, then

X | f h|dŒº ‚â§
 ‚àû
0 t
1
p f ‚àó(t)t
1
p‚Ä≤ h‚àó(t) dt
t
‚â§
f

Lp,1‚à•h‚à•Lp‚Ä≤,‚àû
‚â§Cp,q
f

Lp,q‚à•h‚à•Lp‚Ä≤,‚àû;

1.4 Lorentz Spaces
59
thus every h ‚ààLp‚Ä≤,‚àûgives rise to a bounded linear functional f ‚Üí
 h f dŒº on Lp,q
with norm at most Cp,q‚à•h‚à•Lp‚Ä≤,‚àû. Conversely, let T ‚àà(Lp,q)‚àówhere 1 < p < ‚àûand
0 < q ‚â§1. Let g satisfy (1.4.13) for all f ‚ààL‚àû(KN). Taking f = g|g|‚àí1œáKN‚à©{|g|>Œ±}
for Œ± > 0 and using that


X fgdŒº
 ‚â§‚à•T‚à•‚à•f‚à•Lp,q ,
we obtain that
Œ±Œº(KN ‚à©{|g| > Œ±}) ‚â§(p/q)1/qT
Œº(KN ‚à©{|g| > Œ±})
1
p .
Divide by Œº(KN ‚à©{|g| > Œ±})
1
p , let N ‚Üí‚àû, and take the supremum over Œ± > 0 to
obtain that ‚à•g‚à•Lp‚Ä≤,‚àû‚â§(p/q)1/q‚à•T‚à•.
(vi) Using Exercise 1.4.1 (b) and H¬®older‚Äôs inequality, we obtain


X f œï dŒº
 ‚â§
 ‚àû
0 t
1
p f ‚àó(t)t
1
p‚Ä≤ œï‚àó(t) dt
t ‚â§
f

Lp,q
œï

Lp‚Ä≤,q‚Ä≤ ;
thus every œï ‚ààLp‚Ä≤,q‚Ä≤ gives a bounded linear functional on Lp,q with norm at most
‚à•œï‚à•Lp‚Ä≤,q‚Ä≤. Conversely, let T be in (Lp,q)‚àó. By (1.4.13), T is given by integration
against a locally integrable function g. It remains to prove that g ‚ààLp‚Ä≤,q‚Ä≤. We let
gN,M = gœáKN œá|g|‚â§M. Then (gN,M)‚àó‚â§g‚àófor all M,N = 1,2,... and (gN,M)‚àó‚Üëg‚àóas
M,N ‚Üí‚àûby Proposition 1.4.5 (4), (8).
For a bounded function f in Lp,q(X) we have
 ‚àû
0
f ‚àó(t)(gN,M)‚àó(t)dt =
sup
h: dh=d f


X hgN,M dŒº

=
sup
h: dh=d f


KN
hœá|g|‚â§M gdŒº

=
sup
h: dh=d f
T(hœáKN œá|g|‚â§M)

‚â§
sup
h: dh=d f
T
 hœáKN œá|g|‚â§M

Lp,q
‚â§
sup
h: dh=d f
T
 h

Lp,q
=
T
 f

Lp,q ,
(1.4.15)
where the Ô¨Årst equality is a consequence of the fact that X is nonatomic (see Exercise
1.4.5 (d)). Using the result of Exercise 1.4.5 (b), pick a function f on X such that
f ‚àó(t) =
 ‚àû
t/2 s
q‚Ä≤
p‚Ä≤ ‚àí1(gN,M)‚àó(s)q‚Ä≤‚àí1 ds
s ,
(1.4.16)

60
1 Lp Spaces and Interpolation
noting that the preceding integral converges since (gN,M)‚àó(s) ‚â§M œá[0,Œº(KN)](s). It
follows that f ‚àó‚â§cp,q Mq‚Ä≤‚àí1, which implies that f is bounded, and also that f ‚àó(t) = 0
when t > 2Œº(KN), which implies that f is supported in a set of measure at most
2Œº(KN); thus the function f deÔ¨Åned in (1.4.16) is bounded and lies in Lp,q(X).
We have the following calculation regarding the Lp,q norm of f:
f

Lp,q =
 ‚àû
0 t
q
p
 ‚àû
t/2 s
q‚Ä≤
p‚Ä≤ ‚àí1(gN,M)‚àó(s)q‚Ä≤‚àí1 ds
s
q dt
t
 1
q
‚â§C1(p,q)
 ‚àû
0 (t
1
p‚Ä≤ (gN,M)‚àó(t))q‚Ä≤ dt
t
 1
q
= C1(p,q)
gN,M
q‚Ä≤/q
Lp‚Ä≤,q‚Ä≤ < ‚àû,
(1.4.17)
which is a consequence of Hardy‚Äôs second inequality in Exercise 1.2.8 with b = q/p.
Using (1.4.15) and (1.4.17) we deduce that
 ‚àû
0
f ‚àó(t)(gN,M)‚àó(t)dt ‚â§
T
  f

Lp,q ‚â§C1(p,q)
T
 gN,M
q‚Ä≤‚àí1
Lp‚Ä≤,q‚Ä≤ .
(1.4.18)
On the other hand, we have
 ‚àû
0
f ‚àó(t)(gN,M)‚àó(t)dt ‚â•
 ‚àû
0
 t
t/2 s
q‚Ä≤
p‚Ä≤ ‚àí1(gN,M)‚àó(s)q‚Ä≤‚àí1 ds
s (gN,M)‚àó(t)dt
‚â•
 ‚àû
0 (gN,M)‚àó(t)q‚Ä≤  t
t/2 s
q‚Ä≤
p‚Ä≤ ‚àí1 ds
s dt
= C2(p,q)
gN,M
q‚Ä≤
Lp‚Ä≤,q‚Ä≤.
(1.4.19)
Combining (1.4.18) and (1.4.19), and using the fact that ‚à•gN,M‚à•Lp‚Ä≤,q‚Ä≤ < ‚àû, we obtain
‚à•gN,M‚à•Lp‚Ä≤,q‚Ä≤ ‚â§C(p,q)‚à•T‚à•. Letting N,M ‚Üí‚àûwe deduce ‚à•g‚à•Lp‚Ä≤,q‚Ä≤ ‚â§C(p,q)‚à•T‚à•and
this proves the reverse inequality required to complete case (vi).
(vii) For a complete characterization of this space, we refer to [83].
(viii) The dual of L‚àû= L‚àû,‚àûcan be identiÔ¨Åed with the set of all bounded Ô¨Ånitely
additive set functions; see [99].
‚ñ°
Remark 1.4.17. Some parts of Theorem 1.4.16 are false if X is atomic. For instance,
the dual of ‚Ñìp(Z) contains ‚Ñì‚àûwhen 0 < p < 1 and thus it is not equal to {0}.
1.4.4 The Off-Diagonal Marcinkiewicz Interpolation Theorem
We now present the main result of this section, the off-diagonal extension of
Marcinkiewicz‚Äôs interpolation theorem (Theorem 1.3.2). For a measure space (X,Œº),
let S(X) be the space of Ô¨Ånitely simple functions on X and S+
0 (X) be the subset of
S(X) of functions of the form

1.4 Lorentz Spaces
61
n
‚àë
i=m
2‚àíiœáAi
where m < n are integers and Ai are subsets of X of Ô¨Ånite measure. The sets Ai are
not required to be different nor disjoint; consequently, the sum of two elements in
S+
0 (X) also belong to S+
0 (X). We deÔ¨Åne Sreal
0
(X) = S+
0 (X)‚àíS+
0 (X) be the space of
all functions of the form f1 ‚àíf2, where f1, f2 lie in S+
0 (X) and S0(X) be the space
of functions of the form h1 +ih2, where h1,h2 lie in Sreal
0
(X).
An operator T deÔ¨Åned on S0(X) is called quasi-linear if there is a K ‚â•1 such
that
|T(Œª f)| = |Œª||T( f)|
and
|T( f +g)| ‚â§K(|T( f)|+|T(g)|),
for all Œª ‚ààC and all functions f, g in S0(X). If K = 1, then T is called sublinear.
DeÔ¨Ånition 1.4.18. Let T be a linear operator deÔ¨Åned on the space of Ô¨Ånitely simple
functions S(X) on a measure space (X,Œº) and let 0 < p,q ‚â§‚àû. We say that T is of
restricted weak type (p,q) if
T(œáA)

Lq,‚àû‚â§C Œº(A)1/p
(1.4.20)
for all measurable subsets A of X with Ô¨Ånite measure. Estimates of the form (1.4.20)
are called restricted weak type estimates.
It is important to observe that if an operator is of restricted weak type (p0,q0) and
of restricted weak type (p1,q1), then it is of restricted weak type (p,q), where the
indices are as in (1.4.23). It will be a considerable effort to extend the latter estimate
to all functions in S0(X). The next theorem addresses this extension.
Theorem 1.4.19. Let 0 < r ‚â§‚àû, 0 < p0 Ã∏= p1 ‚â§‚àû, and 0 < q0 Ã∏= q1 ‚â§‚àûand let
(X,Œº), (Y,ŒΩ) be œÉ-Ô¨Ånite measure spaces. Let T be a quasi-linear operator deÔ¨Åned
on the space of simple functions on X and taking values in the set of measurable
functions on Y. Assume that for some M0,M1 < ‚àûthe following restricted weak type
estimates hold:
T(œáA)

Lq0,‚àû‚â§M0 Œº(A)1/p0 ,
(1.4.21)
T(œáA)

Lq1,‚àû‚â§M1 Œº(A)1/p1 ,
(1.4.22)
for all measurable subsets A of X with Œº(A) < ‚àû. Fix 0 < Œ∏ < 1 and let
1
p = 1‚àíŒ∏
p0
+ Œ∏
p1
and
1
q = 1‚àíŒ∏
q0
+ Œ∏
q1
.
(1.4.23)
Then there exists a constant C‚àó(p0,q0, p1,q1,K,r,Œ∏) < ‚àûsuch that for all functions
f in S0(X) we have
T( f)

Lq,r ‚â§C‚àó(p0,q0, p1,q1,K,r,Œ∏)M1‚àíŒ∏
0
MŒ∏
1
f

Lp,r.
(1.4.24)

62
1 Lp Spaces and Interpolation
Additionally, if 0 < p,r < ‚àûand if T is linear (or sublinear with nonnegative val-
ues), then it admits a unique bounded extension from Lp,r(X) to Lq,r(Y,ŒΩ) such that
(1.4.24) holds for all f in Lp,r.
Before we give the proof of Theorem 1.4.19, we state and prove a lemma that is
interesting on its own.
Lemma 1.4.20. Let 0 < p < ‚àûand 0 < q ‚â§‚àûand let (X,Œº), (Y,ŒΩ) be œÉ-Ô¨Ånite
measure spaces. Let T be a quasi-linear operator deÔ¨Åned on S(X) and taking values
in the set of measurable functions on Y. Suppose that there exists a constant M > 0
such that for all measurable subsets A of X of Ô¨Ånite measure we have
T(œáA)

Lq,‚àû‚â§M Œº(A)
1
p .
(1.4.25)
Then for all Œ± with 0 < Œ± < min(q, log2
log2K ) there exists a constant C(p,q,K,Œ±) > 0
such that for all functions f in S0(X) we have the estimate
T( f)

Lq,‚àû‚â§C(p,q,K,Œ±)M
f

Lp,Œ±
(1.4.26)
where
C(p,q,K,Œ±) = 28+ 2
p + 2
q K3

q
q‚àíŒ±
 2
Œ±
(1‚àí2‚àíŒ±)‚àí1
Œ± (log2)‚àí1
Œ± .
Proof. A function f in S0(X) can be written as f = h1 ‚àíh2 + i(h3 ‚àíh4), where
hj are in S+
0 (X). We write f = f1 ‚àíf2 + i( f3 ‚àíf4), where f1 = max(h1 ‚àíh2,0),
f2 = max(‚àí(h1 ‚àíh2),0), f3 = max(h3 ‚àíh4,0), and f4 = max(‚àí(h3 ‚àíh4),0). We
note that f j lie in S+
0 (X); indeed, if h1 = ‚àë‚Ñì2‚àí‚ÑìœáA‚Ñìand h2 = ‚àëk 2‚àíkœáBk, where both
sums are Ô¨Ånite, then
f1 =
‚àë
‚Ñì: A‚Ñì‚à©(‚à™kBk)=/0
2‚àí‚ÑìœáA‚Ñì+
‚àë
(‚Ñì,k): ‚Ñì<k, A‚Ñì‚à©BkÃ∏=/0
(2‚àí‚Ñì‚àí2‚àík)œáA‚Ñì‚à©Bk .
Since the second sum is equal to ‚àëk
s=‚Ñì+1 2‚àísœáA‚Ñì‚à©Bk, we obtain that h1 ‚ààS+
0 (X).
Likewise we can show that f2, f3, f4 lie in S+
0 (X). Moreover, we have f j ‚â§| f| and
Proposition 1.4.5(4), yields
‚à•f j‚à•Lp,Œ±(X) ‚â§‚à•f‚à•Lp,Œ±(X)
for all j = 1,2,3,4. Suppose now that (1.4.26) holds for functions in S+
0 (X) with
constant C‚Ä≤(p,q,Œ±) in place of C(p,q,K,Œ±). By the quasi-linearity of T we have

1.4 Lorentz Spaces
63
‚à•T( f)‚à•Lq,‚àû(Y) ‚â§K3

4
‚àë
j=1
|T( f j)|

Lq,‚àû(Y)
‚â§K341+ 1
q
4
‚àë
j=1
‚à•T( f j)‚à•Lq,‚àû(Y)
‚â§K342+ 2
q MC‚Ä≤(p,q,K,Œ±)‚à•f‚à•Lp,Œ±(X)
which proves (1.4.26) for all f in S0(X) with constant
C(p,q,K,Œ±) = 24+ 2
q K3C‚Ä≤(p,q,Œ±).
We now prove (1.4.26) for functions in S+
0 (X) with constant C‚Ä≤(p,q,Œ±) in place
of C(p,q,K,Œ±). It follows from the Aoki‚ÄìRolewicz theorem (Exercise 1.4.6) that for
all N ‚ààZ+ and for all f1,..., fN in S+
0 (X) we have the pointwise inequality
|T( f1 +¬∑¬∑¬∑+ fN)| ‚â§4
 N
‚àë
j=1
|T( f j)|Œ±1
 1
Œ±1 ‚â§4
 N
‚àë
j=1
|T( f j)|Œ±
 1
Œ±
,
(1.4.27)
where 0 < Œ± ‚â§Œ±1 and Œ±1 satisÔ¨Åes the equation (2K)Œ±1 = 2. The second inequality
in (1.4.27) is a simple consequence of the fact that Œ± ‚â§Œ±1. Fix Œ±0 with
0 < Œ±0 ‚â§Œ±1 = log2
log2K
and
Œ±0 < q.
This ensures that the quasi-normed space Lq/Œ±,‚àûis normable when Œ± ‚â§Œ±0. In fact,
since Y is œÉ-Ô¨Ånite, Exercise 1.1.12 gives that the space Ls,‚àûis normable as long as
s > 1 and there is an equivalent norm ||| f|||Ls,‚àûsuch that
 f

Ls,‚àû‚â§
‚èê‚èê‚èê‚èê‚èê‚èêf
‚èê‚èê‚èê‚èê‚èê‚èê
Ls,‚àû‚â§
s
s‚àí1
f

Ls,‚àû.
Next we claim that for any nonnegative function f in S+
0 (X) we have
T( f œáA)

Lq,‚àû‚â§4

q
q‚àíŒ±
 1
Œ± (1‚àí2‚àíŒ±)‚àí1
Œ± M Œº(A)
1
p f œáA

L‚àû.
(1.4.28)
To show this, we write f = ‚àën
j=m 2‚àíjœáS j, where m < n are integers, Sj are subsets of
X of Ô¨Ånite measure for all j ‚àà{m,m+1,...,n}, Œº(Sm) Ã∏= 0 and Œº(Sn) Ã∏= 0. Setting
Bj = Sj ‚à©A we have
f œáA =
n
‚àë
j=m
2‚àíjœáB j
and 2‚àím ‚â§‚à•f œáA‚à•L‚àû(X).

64
1 Lp Spaces and Interpolation
We use (1.4.27) once and (1.4.3) twice in the following argument. We have
T( f œáA)

Lq,‚àû‚â§4


n
‚àë
j=m
2‚àíjŒ±|T(œáB j)|Œ± 1
Œ± 
Lq,‚àû
= 4

n
‚àë
j=m
2‚àíjŒ±|T(œáB j)|Œ±
1
Œ±
Lq/Œ±,‚àû
‚â§4
‚èê‚èê‚èê
‚èê‚èê‚èê
‚èê‚èê‚èê
n
‚àë
j=m
2‚àíjŒ±|T(œáB j)|Œ±‚èê‚èê‚èê
‚èê‚èê‚èê
‚èê‚èê‚èê
1
Œ±
Lq/Œ±,‚àû
‚â§4

n
‚àë
j=m
2‚àíjŒ±‚èê‚èê‚èê
‚èê‚èê‚èê
‚èê‚èê‚èê|T(œáB j)|Œ±‚èê‚èê‚èê
‚èê‚èê‚èê
‚èê‚èê‚èê
Lq/Œ±,‚àû
 1
Œ±
‚â§4

q
q‚àíŒ±
 1
Œ±

n
‚àë
j=m
2‚àíjŒ±|T(œáB j)|Œ±
Lq/Œ±,‚àû
 1
Œ±
= 4

q
q‚àíŒ±
 1
Œ±

n
‚àë
j=m
2‚àíjŒ±T(œáB j)
Œ±
Lq,‚àû
 1
Œ±
‚â§4

q
q‚àíŒ±
 1
Œ± M

n
‚àë
j=m
2‚àíjŒ±Œº(Bj)
Œ±
p
 1
Œ±
‚â§4

q
q‚àíŒ±
 1
Œ± (1‚àí2‚àíŒ±)‚àí1
Œ± M Œº(A)
1
p 2‚àím,
using Bj ‚´ÖA. Using that 2‚àím ‚â§‚à•f œáA‚à•L‚àûestablishes (1.4.28).
We now apply (1.4.28) to obtain (1.4.26). For any f ‚ààS+
0 (X) we deÔ¨Åne measur-
able sets
Ak = {x ‚ààX : f ‚àó(2k+1) < | f(x)| ‚â§f ‚àó(2k)}
(1.4.29)
and we note that these sets are pairwise disjoint. We may write the Ô¨Ånitely simple
function f as ‚àën
j=1 ajœáE j, where 0 < aj < ‚àû, E1 ‚´ÖE2 ‚´Ö¬∑¬∑¬∑ ‚´ÖEn and 0 < Œº(Ej) < ‚àû
for j ‚àà{1,2,...,n}. Clearly, we have
f ‚àó=
n
‚àë
j=1
ajœá[0,Œº(E j)).
Thus, when t ‚àà(Œº(En),‚àû), f ‚àó(t) vanishes, and when t ‚àà(0,Œº(E1)), f ‚àó(t) = ‚àën
j=1 aj
is a positive constant. So there exists N ‚ààZ+ such that f ‚àó(2k) = 0 when k > N, and
that f ‚àó(2k) is a positive constant when k < ‚àíN. This also implies that Ak = /0 if
|k| > N and thus we express
f =
N
‚àë
k=‚àíN
f œáAk.

1.4 Lorentz Spaces
65
Proposition 1.4.5(2) implies Œº(Ak) ‚â§df ( f ‚àó(2k+1)) ‚â§2k+1. Using (1.4.27) we obtain
T( f)

Lq,‚àû(Y) ‚â§4


N
‚àë
k=‚àíN
|T( f œáAk)|Œ± 1
Œ± 
Lq,‚àû(Y)
= 4

N
‚àë
k=‚àíN
|T( f œáAk)|Œ±
1
Œ±
Lq/Œ±,‚àû(Y)
‚â§4
‚èê‚èê‚èê
‚èê‚èê‚èê
‚èê‚èê‚èê
N
‚àë
k=‚àíN
|T( f œáAk)|Œ±‚èê‚èê‚èê
‚èê‚èê‚èê
‚èê‚èê‚èê
1
Œ±
Lq/Œ±,‚àû(Y)
‚â§4

N
‚àë
k=‚àíN
‚èê‚èê‚èê
‚èê‚èê‚èê
‚èê‚èê‚èê|T( f œáAk)|Œ±‚èê‚èê‚èê
‚èê‚èê‚èê
‚èê‚èê‚èê
Lq/Œ±,‚àû(Y)
 1
Œ±
‚â§4

q
q‚àíŒ±
 1
Œ±

N
‚àë
k=‚àíN
|T( f œáAk)|Œ±
Lq/Œ±,‚àû(Y)
 1
Œ±
‚â§4

q
q‚àíŒ±
 1
Œ±
'
N
‚àë
k=‚àíN
‚à•T( f œáAk)‚à•Œ±
Lq,‚àû(Y)
( 1
Œ±
‚â§16

q
q‚àíŒ±
 2
Œ±
(1‚àí2‚àíŒ±)‚àí1
Œ± M
'
N
‚àë
k=‚àíN
Œº(Ak)
Œ±
p f œáAk
Œ±
L‚àû
( 1
Œ±
‚â§16

q
q‚àíŒ±
 2
Œ±
(1‚àí2‚àíŒ±)‚àí1
Œ± 2
1
p M
'
‚àû
‚àë
k=‚àí‚àû
[ f ‚àó(2k)]Œ±2
kŒ±
p
( 1
Œ±
‚â§16

q
q‚àíŒ±
 2
Œ±
(1‚àí2‚àíŒ±)‚àí1
Œ± 2
2
p (log2)‚àí1
Œ± M‚à•f‚à•Lp,Œ±(X),
where we made use of (1.4.28) and in the last inequality, we used
‚à•f‚à•Œ±
Lp,Œ±(X) =
‚àû
‚àë
k=‚àí‚àû
 2k
2k‚àí1 t
Œ±
p [ f ‚àó(t)]Œ± dt
t
‚â•
‚àû
‚àë
k=‚àí‚àû
(2k‚àí1)
Œ±
p [ f ‚àó(2k)]Œ±
 2k
2k‚àí1
dt
t
= 2‚àíŒ±
p log2
‚àû
‚àë
k=‚àí‚àû
[ f ‚àó(2k)]Œ±2
kŒ±
p .
This completes the proof of the required inequality for nonnegative functions in
S+
0 (X) with constant
C‚Ä≤(p,q,Œ±) = 16

q
q‚àíŒ±
 2
Œ±
(1‚àí2‚àíŒ±)‚àí1
Œ± 2
2
p (log2)‚àí1
Œ±
As noted, the constant in general is C(p,q,K,Œ±) = 24+ 2
p K3C‚Ä≤(p,q,Œ±).
‚ñ°

66
1 Lp Spaces and Interpolation
We now proceed with the proof of Theorem 1.4.19.
Proof. We assume that p0 < p1, since if p0 > p1 we may simply reverse the roles
of p0 and p1. We Ô¨Årst consider the case p1,r < ‚àû. Lemma 1.4.20 implies that
T( f)

Lq0,‚àû‚â§M‚Ä≤
0
f

Lp0,m ,
T( f)

Lq1,‚àû‚â§M‚Ä≤
1
f

Lp1,m ,
(1.4.30)
for all f in S0(X), where m = 1
2 min

q0,q1, log2
log2K ,2r

, M‚Ä≤
0 = C(p0,q0,K,m)M0,
M‚Ä≤
1 = C(p1,q1,K,m)M1, and C(p,q,K,Œ±) is as in (1.4.26).
Fix a function f in S0(X). Split f = f t + ft as follows:
f t(x) =

f(x)
if | f(x)| > f ‚àó(Œ¥tŒ≥),
0
if | f(x)| ‚â§f ‚àó(Œ¥tŒ≥),
ft(x) =

0
if | f(x)| > f ‚àó(Œ¥tŒ≥),
f(x)
if | f(x)| ‚â§f ‚àó(Œ¥tŒ≥),
where Œ¥ is to be determined later and Œ≥ is the following nonzero real number:
Œ≥ =
1
q0 ‚àí1
q
1
p0 ‚àí1
p
=
1
q ‚àí1
q1
1
p ‚àí1
p1
.
Using Exercise 1.1.10 we write
df t(v) =

df (v)
when v > f ‚àó(Œ¥tŒ≥)
df ( f ‚àó(Œ¥tŒ≥))
when v ‚â§f ‚àó(Œ¥tŒ≥)
dft(v) =

0
when v ‚â•f ‚àó(Œ¥tŒ≥)
df (v)‚àídf ( f ‚àó(Œ¥tŒ≥))
when v < f ‚àó(Œ¥tŒ≥).
Observe the following facts
v ‚â•Œ¥tŒ≥ =‚áí( f t)‚àó(v) ‚â§inf
	
s ‚àà(0, f ‚àó(Œ¥tŒ≥)] : df t(s) ‚â§v

= inf
	
s ‚àà(0, f ‚àó(Œ¥tŒ≥)] : df ( f ‚àó(Œ¥tŒ≥)) ‚â§v

= inf(0, f ‚àó(Œ¥tŒ≥)]
= 0,
v < Œ¥tŒ≥ =‚áí( f t)‚àó(v) ‚â§inf
	
s > f ‚àó(Œ¥tŒ≥) : df t(s) ‚â§v

= inf
	
s > f ‚àó(Œ¥tŒ≥) : df (s) ‚â§v

= inf
	
s > 0 : df (s) ‚â§v

‚à©

f ‚àó(Œ¥tŒ≥),‚àû

= f ‚àó(v),
since f ‚àó(v) ‚â•f ‚àó(Œ¥tŒ≥),

1.4 Lorentz Spaces
67
v ‚â•Œ¥tŒ≥ =‚áí( ft)‚àó(v) = inf
	
s > 0 : dft(s) ‚â§v

‚â§inf
	
s > 0 : df (s) ‚â§v

since dft ‚â§df
= f ‚àó(v),
v < Œ¥tŒ≥ =‚áí( ft)‚àó(v) = inf
	
s > 0 : dft(s) ‚â§v

‚â§f ‚àó(Œ¥tŒ≥),
since f ‚àó(Œ¥tŒ≥) ‚àà{s > 0 : dft(s) ‚â§v

.
We summarize these observations in a couple of inequalities:
( f t)‚àó(s) ‚â§

f ‚àó(s)
if 0 < s < Œ¥tŒ≥,
0
if s ‚â•Œ¥tŒ≥,
( ft)‚àó(s) ‚â§

f ‚àó(Œ¥tŒ≥)
if 0 < s < Œ¥tŒ≥,
f ‚àó(s)
if s ‚â•Œ¥tŒ≥.
It follows from these inequalities that f t lies in Lp0,m and ft lies in Lp1,m for all t > 0.
The quasi-linearity of the operator T and (1.4.9) imply
T( f)

Lq,r
=
t
1
q T( f)‚àó(t)

Lr( dt
t )
‚â§K
t
1
q (|T( ft)|+|T( f t)|)‚àó(t)

Lr( dt
t )
‚â§K
t
1
q T( ft)‚àó( t
2)+t
1
q T( f t)‚àó( t
2)

Lr( dt
t )
‚â§Kar
t
1
q T( ft)‚àó( t
2)

Lr( dt
t ) +
t
1
q T( f t)‚àó( t
2)

Lr( dt
t )

‚â§K max{1,2
1
r ‚àí1}
t
1
q T( ft)‚àó( t
2)

Lr( dt
t ) +
t
1
q T( f t)‚àó( t
2)

Lr( dt
t )

.
(1.4.31)
It follows from (1.4.30) that
t
1
q0 T( f t)‚àó( t
2) ‚â§2
1
q0 sup
s>0
s
1
q0 T( f t)‚àó(s) ‚â§2
1
q0 M‚Ä≤
0
 f t
Lp0,m ,
(1.4.32)
t
1
q1 T( ft)‚àó( t
2) ‚â§2
1
q1 sup
s>0
s
1
q1 T( ft)‚àó(s) ‚â§2
1
q1 M‚Ä≤
1
 ft

Lp1,m ,
(1.4.33)
for all t > 0. Now use (1.4.32), (1.4.33), and the facts that
t
1
q T( f t)‚àó( t
2) = t
1
q ‚àí1
q0 t
1
q0 T( f t)‚àó( t
2) ‚â§t
1
q ‚àí1
q0 2
1
q0 M‚Ä≤
0
 f t
Lp0,m
t
1
q T( f t)‚àó( t
2) = t
1
q ‚àí1
q1 t
1
q1 T( f t)‚àó( t
2) ‚â§t
1
q ‚àí1
q1 2
1
q1 M‚Ä≤
1
f t
Lp1,m ,

68
1 Lp Spaces and Interpolation
to estimate (1.4.31) by
K max{1,2
1
r ‚àí1}
)
2
1
q0 M‚Ä≤
0
t
1
q ‚àí1
q0  f t
Lp0,m

Lr( dt
t )
+2
1
q1 M‚Ä≤
1
t
1
q ‚àí1
q1  ft

Lp1,m

Lr( dt
t )
*
,
which is the same as
K max{1,2
1
r ‚àí1}2
1
q0 M‚Ä≤
0
t‚àíŒ≥( 1
p0 ‚àí1
p )f t
Lp0,m

Lr( dt
t )
(1.4.34)
+K max{1,2
1
r ‚àí1}2
1
q1 M‚Ä≤
1
tŒ≥( 1
p ‚àí1
p1 )ft

Lp1,m

Lr( dt
t )
.
(1.4.35)
Next, we change variables u = Œ¥tŒ≥ in the Lr quasi-norm in (1.4.34) to obtain
t‚àíŒ≥( 1
p0 ‚àí1
p )f t
Lp0,m

Lr( dt
t )
‚â§Œ¥
1
p0 ‚àí1
p
|Œ≥|
1
r
u‚àí( 1
p0 ‚àí1
p )
 u
0 f ‚àó(s)ms
m
p0 ds
s
 1
m

Lr( du
u )
‚â§Œ¥
1
p0 ‚àí1
p
|Œ≥|
1
r
)
r
m
r( 1
p0 ‚àí1
p)
* 1
m  ‚àû
0 (s
1
p0 f ‚àó(s))rs‚àír( 1
p0 ‚àí1
p ) ds
s
 1
r
=
Œ¥
1
p0 ‚àí1
p
m
1
m |Œ≥|
1
r ( 1
p0 ‚àí1
p)
1
m
f

Lp,r ,
where the last inequality is a consequence of Hardy‚Äôs inequality:
 ‚àû
0
 u
0 g(s) ds
s
p
u‚àíb du
u
 1
p
‚â§p
b
 ‚àû
0 g(u)p u‚àíb du
u
 1
p
(1.4.36)
with g(s) = f ‚àó(s)msm/p0 ‚â•0, p = r/m ‚â•1 and b = r/p0 ‚àír/p > 0. See Exercise
1.2.8 for the proof of (1.4.36).
Likewise, change variables u = Œ¥tŒ≥ in the Lr quasi-norm of (1.4.35) to obtain
tŒ≥( 1
p ‚àí1
p1 ) ft

Lp1,m

Lr( dt
t )
‚â§Œ¥ ‚àí( 1
p ‚àí1
p1 )
|Œ≥|
1
r
u
1
p ‚àí1
p1
 u
0 f ‚àó(u)ms
m
p1 ds
s +
 ‚àû
u
f ‚àó(s)ms
m
p1 ds
s
 1
m

Lr( du
u )
= Œ¥ ‚àí( 1
p ‚àí1
p1 )
|Œ≥|
1
r
u
m
p ‚àím
p1
 u
0 f ‚àó(u)ms
m
p1 ds
s +
 ‚àû
u
f ‚àó(s)ms
m
p1 ds
s

1
m
Lr/m( du
u )

1.4 Lorentz Spaces
69
‚â§Œ¥ ‚àí( 1
p ‚àí1
p1 )
|Œ≥|
1
r
u
m
p ‚àím
p1 f ‚àó(u)m
 u
0 s
m
p1 ds
s

Lr/m( du
u )
+
u
m
p ‚àím
p1
 ‚àû
u
f ‚àó(s)ms
m
p1 ds
s

Lr/m( du
u )
+ 1
m
‚â§Œ¥ ‚àí( 1
p ‚àí1
p1 )
|Œ≥|
1
r

p1
m
 f
m
Lp,r +
r
m
r( 1
p‚àí1
p1 )
 ‚àû
0

f ‚àó(u)mu
m
p1  r
m u
r
p ‚àír
p1 du
u
 m
r
+ 1
m
= Œ¥ ‚àí( 1
p ‚àí1
p1 )
m
1
m |Œ≥|
1
r

p1
p
1
p‚àí1
p1
+ 1
m f

Lp,r ,
where the last inequality above is Hardy‚Äôs inequality:
 ‚àû
0
 ‚àû
u g(s) ds
s
p
ub du
u
 1
p
‚â§p
b
 ‚àû
0 g(u)p ub du
u
 1
p
(1.4.37)
with g(s) = f ‚àó(s)msm/p1 ‚â•0, p = r/m ‚â•1 and b = r/p ‚àír/p1 > 0. See Exercise
1.2.8 for the proof of (1.4.37).
Combining these elements we deduce that given f in S0(X), we have that the
expression in (1.4.34) plus the expression in (1.4.35) is at most
K max{1,2
1
r ‚àí1}
m
1
m |Œ≥|
1
r
‚éß
‚é®
‚é©
2
1
q0 M‚Ä≤
0 Œ¥
1
p0 ‚àí1
p
( 1
p0 ‚àí1
p)
1
m
+
2
1
q1 ( p1
p )
1
m M‚Ä≤
1 Œ¥ ‚àí( 1
p ‚àí1
p1 )
( 1
p‚àí1
p1 )
1
m
‚é´
‚é¨
‚é≠
f

Lp,r
We choose Œ¥ > 0 such that the two terms in the curly brackets above are equal. We
deduce that
T( f)

Lq,r ‚â§2K max{1,2
1
r ‚àí1}
m
1
m |Œ≥|
1
r
‚éß
‚é®
‚é©
2
1‚àíŒ∏
q0 (M‚Ä≤
0)1‚àíŒ∏
( 1
p0 ‚àí1
p)
1‚àíŒ∏
m
2
Œ∏
q1 ( p1
p )
Œ∏
m (M‚Ä≤
1)Œ∏
( 1
p‚àí1
p1 )
Œ∏
m
‚é´
‚é¨
‚é≠
 f

Lp,r
where Œ∏ is as in (1.4.23), i.e.,
Œ∏ =
1
p0 ‚àí1
p
1
p0 ‚àí1
p1
.
This proves (1.4.24) in the case p1,r < ‚àûwith constant C‚àó(p0,q0, p1,q1,K,r,Œ∏)
equal to
2K max{1,2
1
r ‚àí1}
m
1
m |Œ≥|
1
r
‚éß
‚é®
‚é©
2
1‚àíŒ∏
q0 C(p0,q0,K,m)1‚àíŒ∏2
Œ∏
q1 ( p1
p )
Œ∏
m C(p1,q1,K,m)Œ∏
( 1
p0 ‚àí1
p)
1‚àíŒ∏
m ( 1
p‚àí1
p1 )
Œ∏
m
‚é´
‚é¨
‚é≠,
where we recall that m = 1
2 min

q0,q1, log2
log2K ,2r

and C(pj,qj,K,m) is as in Lemma
1.4.20.

70
1 Lp Spaces and Interpolation
We now turn to the remaining cases p = ‚àûor r = ‚àû. The restriction r < ‚àûcan
be removed since C‚àó(p0,q0, p1,q1,K,r,Œ∏) has a Ô¨Ånite limit as r ‚Üí‚àûand, moreover,
‚à•f‚à•Lp,r = ‚à•t1/p f ‚àó(t)‚à•Lr(dt/t) ‚Üí‚à•t1/p f ‚àó(t)‚à•L‚àû(dt/t) = ‚à•f‚à•Lp,‚àûas r ‚Üí‚àûand likewise
‚à•T( f)‚à•Lp,r ‚Üí‚à•T( f)‚à•Lp,‚àûas r ‚Üí‚àû; see Exercise 1.1.3 (a). The restriction p1 < ‚àû
can be removed as follows. Suppose that p1 = ‚àû. Then, since Œ∏ ‚àà(0,1) it follows
that p < ‚àûand we pick p2 > p and p2 < ‚àû. It is easy to see T satisÔ¨Åes the restricted
weak type (p2,q2) estimate
sup
Œ±>0
Œ±ŒΩ({|T(œáA)| > Œ±})
1
q2 ‚â§M1‚àíœï
0
Mœï
1 Œº(A)
1
p2 ,
where
1‚àíœï
p0
+ œï
‚àû= 1
p2
,
1‚àíœï
q0
+ œï
q1
= 1
q2
.
(1.4.38)
Using the result obtained when p1 < ‚àûwith p2 in place of p1 we obtain that
T( f)

Lq,r ‚â§C‚àó(p0,q0, p2,q2,K,r,œÅ)M1‚àíœÅ
0
(M1‚àíœï
0
Mœï
1 )œÅf

Lp,r
(1.4.39)
for all functions f in S0(X), where
1‚àíœÅ
p0
+ œÅ
p2
= 1
p,
1‚àíœÅ
q0
+ œÅ
q2
= 1
q .
(1.4.40)
Combining (1.4.38) and (1.4.40) and using (1.4.23) we deduce that Œ∏ = œÅœï and
hence (1.4.39) yields (1.4.24) in the case where p1 = ‚àû. In this case we have
C‚àó(p0,q0,‚àû,q1,K,r,Œ∏) = C‚àó(p0,q0,
p0
1‚àíœï ,( 1‚àíœï
q0 + œï
q1 )‚àí1,K,r, Œ∏
œï ),
where œï is any number satisfying 1 > œï > 1‚àíp0
p .
Finally, we address the last assertion of the theorem which claims that when
p,r < ‚àûand K = 1, the linear (or sublinear with nonnegative values) operator T
initially deÔ¨Åned on Ô¨Ånitely simple functions has a unique bounded extension from
Lp,r(X) to Lq,r(Y), which also satisÔ¨Åes (1.4.24) (with the same constant). To obtain
this conclusion, we will need to know that the space S0(X) is dense in Lp,r(X)
whenever 0 < p,r < ‚àû. This is proved in Proposition 1.4.21 below. Assuming this
proposition, we deÔ¨Åne the extension of T on Lp,r(X) as follows:
Given f in Lp,r(X) a sequence of functions f j in S0(X) that converge to f in
Lp,r(X), notice that the linearity (or the sublinearity and the fact that T( f) ‚â•0 for
all f in S0(X)) implies
|T( f j)‚àíT( fk)| ‚â§|T( f j ‚àífk)|.
Using the boundedness of T from Lp,r(X) to Lq,r(Y) we obtain that the sequence
{T( f j)}j is Cauchy in Lq,r(Y) and by the completeness of this space, it must con-
verge to a limit which we call T( f). We observe that T( f) is independent of the
choice of the sequence {f j}j that converges to f in Lp,r. Moreover, one can show
that T is linear (or sublinear with nonnegative values), T( f) coincides with T( f)

1.4 Lorentz Spaces
71
on S0(X) and T is bounded from Lp,r(X) to Lq,r(Y). Thus T is the unique bounded
extension of T on the entire space Lp,r(X). For details, see Exercise 1.4.17.
‚ñ°
Proposition 1.4.21. For all 0 < p,r < ‚àûthe space S0(X) is dense in Lp,r(X).
Proof. Let f ‚ààLp,r(X) and assume Ô¨Årst that f ‚â•0. Using (1.4.5) and the fact that
df is decreasing on [0,‚àû), we obtain for any n ‚ààZ+,
 f
r
Lp,r(X) = p
 ‚àû
0
/
df (s)
1
p s
0r ds
s
‚â•p
 2‚àín
0

df (2‚àín)
 r
p sr‚àí1 ds
= p2‚àínr
r

df (2‚àín)
 r
p ,
which implies that df (2‚àín) < ‚àû. Likewise, again in view of (1.4.5), we have
f
r
Lp,r(X) ‚â•p
 2n
0

df (s)
 r
p sr‚àí1 ds = p2nr
r

df (2n)
 r
p ,
which implies that limn‚Üí‚àûdf (2n) = 0. Thus, for any n ‚ààZ+, there exists kn ‚ààN
such that
df (2kn) = Œº
	
x ‚ààX : f(x) > 2kn

< 2‚àín.
Let En =
	
x ‚ààX : 2‚àín < f(x) ‚â§2kn
and note that Œº (En) ‚â§df (2‚àín) < ‚àûfor each
n ‚ààZ+. We write f œáEn in binary expansion, that is, f œáEn(x) = ‚àë‚àû
j=‚àíkn dj(x)2‚àíj,
where dj(x) = 0 or 1. Let Bj = {x ‚ààEn : dj(x) = 1}. Then, Œº(Bj) ‚â§Œº(En) and
f œáEn can be expressed as f œáEn = ‚àë‚àû
j=‚àíkn 2‚àíjœáB j.
Set fn = ‚àën
j=‚àíkn 2‚àíjœáB j. It is obvious that fn ‚ààS+
0 (X) and fn ‚â§f œáEn ‚â§f. Ob-
serve that when x ‚ààEn, we have
f(x)‚àífn(x) =
‚àû
‚àë
j=n+1
2‚àíjœáB j ‚â§2‚àín,
and that when x /‚ààEn, we have fn(x) = 0 and f(x) > 2kn or f(x) ‚â§2‚àín. It follows
from these facts that
df‚àífn(2‚àín) = Œº

En ‚à©{f ‚àífn > 2‚àín}

+ Œº

Ec
n ‚à©{f ‚àífn > 2‚àín}

< 2‚àín.
Hence, for 2‚àín ‚â§t < ‚àûone has
( f ‚àífn)‚àó(t) ‚â§( f ‚àífn)‚àó(2‚àín) = inf
	
s > 0 : df‚àífn(s) ‚â§2‚àín
‚â§2‚àín.
This implies that limn‚Üí‚àû( f ‚àífn)‚àó(t) = 0 for all t ‚àà(0,‚àû). By Proposition 1.4.5 (5),
(6), we obtain for all t ‚àà(0,‚àû)
( f ‚àífn)‚àó(t) ‚â§f ‚àó(t/2)+ f ‚àó
n (t/2) ‚â§2f ‚àó(t/2).

72
1 Lp Spaces and Interpolation
The Lebesgue dominated convergence theorem gives ‚à•fn ‚àíf‚à•Lp,r(X) ‚Üí0 as n ‚Üí‚àû
which yields the required conclusion for nonnegative functions f in Lp,r(X).
For a complex-valued function f ‚ààLp,r(X), we write f = f1 ‚àíf2 + i( f3 ‚àíf4),
where f j are nonnegative functions in Lp,r(X). By the preceding conclusion, there
exist sequences {f j
n}n‚ààZ+, j = 1,2,3,4, in S+
0 (X) such that f j
n ‚Üíf j in Lp,r(X) as
n ‚Üí‚àû. Set fn = f 1
n ‚àíf 2
n +i( f 3
n ‚àíf 4
n ). Using the fact that ‚à•¬∑‚à•Lp,r(X) is a quasi-norm
we obtain
 f ‚àífn

Lp,r(X) ‚â§C(p,r)
4
‚àë
j=1
 f j ‚àíf j
n

Lp,r(X)
which tends to zero as n ‚Üí‚àû. This completes the proof.
‚ñ°
Corollary 1.4.22. Let T be as in the statement of Theorem 1.4.19 and let 0 < p0 Ã∏=
p1 ‚â§‚àûand 0 < q0 Ã∏= q1 ‚â§‚àû. If T is restricted weak type (p0,q0) and (p1,q1) with
constants M0 and M1, respectively, and for some 0 < Œ∏ < 1 we have
1
p = 1‚àíŒ∏
p0
+ Œ∏
p1
,
1
q = 1‚àíŒ∏
q0
+ Œ∏
q1
,
and p ‚â§q, then T satisÔ¨Åes the strong type estimate
T( f)

Lq ‚â§C(p0,q0, p1,q1,Œ∏)M1‚àíŒ∏
0
MŒ∏
1
f

Lp
(1.4.41)
for all f in S0(X). Moreover, if T is linear (or sublinear with nonnegative values),
then it has a unique bounded extension from Lp(X,Œº) to Lq(Y,ŒΩ) that satisÔ¨Åes es-
timate (1.4.41) for all f ‚ààLp(X) with the constant C(p0,q0, p1,q1,Œ∏) replaced by
C(p0,q0, p1,q1,Œ∏)22/p max(1,21/p‚àí1)2.
Proof. Since Œ∏ ‚àà(0,1) we must have p,q < ‚àû. Take r = q in Theorem 1.4.19 and
note that ‚à•f‚à•Lp,r ‚â§‚à•f‚à•Lp since p ‚â§q = r; see Proposition 1.4.10. The last assertion
follows using Exercise 1.4.17.
‚ñ°
We now give examples to indicate why the assumptions p0 Ã∏= p1 and q0 Ã∏= q1
cannot be dropped in Theorem 1.4.19.
Example 1.4.23. Let X = Y = R and
T( f)(x) = |x|‚àí1/2
 1
0 f(t)dt .
Then Œ±|{x : |T(œáA)(x)| > Œ±}|1/2 = 21/2|A‚à©[0,1]| and thus T is of restricted weak
types (1,2) and (3,2). But observe that T does not map L2 = L2,2 to Lq,2. Thus
Theorem 1.4.19 fails if the assumption q0 Ã∏= q1 is dropped. The dual operator
S( f)(x) = œá[0,1](x)
 +‚àû
‚àí‚àûf(t)|t|‚àí1/2 dt

1.4 Lorentz Spaces
73
satisÔ¨Åes Œ±|{x : |S(œáA)(x)| > Œ±}|1/q ‚â§c|A|1/2 when q = 1 or 3, and thus it furnishes
an example of an operator of restricted weak types (2,1) and (2,3) that is not L2
bounded. Thus Theorem 1.4.19 fails if the assumption p0 Ã∏= p1 is dropped.
As an application of Theorem 1.4.19, we give the following strengthening of
Theorem 1.2.13.
We end this chapter with a corollary of the proof of Theorem 1.4.19.
Corollary 1.4.24. Let 1 ‚â§r < ‚àû, 1 ‚â§p0 Ã∏= p1 < ‚àû, and 0 < q0 Ã∏= q1 ‚â§‚àûand let
(X,Œº) and (Y,ŒΩ) be œÉ-Ô¨Ånite measure spaces. Let T be a quasi-linear operator de-
Ô¨Åned on Lp0(X)+Lp1(X) and taking values in the set of measurable functions on Y.
Assume that for some M‚Ä≤
0,M‚Ä≤
1 < ‚àûthe following estimates hold for j = 0,1
T( f)

Lq j,‚àû(Y) ‚â§M‚Ä≤
j
f

Lp j (X) ,
(1.4.42)
for all functions f ‚ààLp j(X). Fix 0 < Œ∏ < 1 and let
1
p = 1‚àíŒ∏
p0
+ Œ∏
p1
and
1
q = 1‚àíŒ∏
q0
+ Œ∏
q1
.
(1.4.43)
Then there exists a constant C‚àó(p0,q0, p1,q1,K,r,Œ∏) < ‚àûsuch that for all functions
f in Lp(X) we have
T( f)

Lq,p ‚â§C‚àó(p0,q0, p1,q1,K,r,Œ∏)(M‚Ä≤
0)1‚àíŒ∏(M‚Ä≤
1)Œ∏ f

Lp.
(1.4.44)
Proof. Since Lp(X) is contained in the sum Lp0(X)+Lp1(X), the operator T is well
deÔ¨Åned on Lp(X). Hypothesis (1.4.42) implies that (1.4.30) holds for all f ‚ààLp j,1.
Repeat the proof of Theorem 1.4.19 starting from (1.4.30) Ô¨Åxing a function f in
Lp(X), m = 1 and r = p. We obtain the required conclusion.
Theorem 1.4.25. (Young‚Äôs inequality for weak type spaces) Let G be a locally com-
pact group with left Haar measure Œª that satisÔ¨Åes (1.2.12) for all measurable subsets
A of G. Let 1 < p,q,r < ‚àûsatisfy
1
q +1 = 1
p + 1
r .
(1.4.45)
Then there exists a constant Bp,q,r > 0 such that for all f in Lp(G) and g in Lr,‚àû(G)
we have
 f ‚àóg

Lq(G) ‚â§Bp,q,r
g

Lr,‚àû(G)
 f

Lp(G) .
(1.4.46)
Proof. We Ô¨Åx 1 < p,q < ‚àû. Since p and q range in an open interval, we can Ô¨Ånd
p0 < p < p1, q0 < q < q1, and 0 < Œ∏ < 1 such that (1.4.23) and (1.4.45) hold.
Let T( f) = f ‚àóg, deÔ¨Åned for all functions f on G. By Theorem 1.2.13, T extends
to a bounded operator from Lp0 to Lq0,‚àûand from Lp1 to Lq1,‚àû. It follows from
the Corollary 1.4.24 that T extends to a bounded operator from Lp(G) to Lq(G).
Notice that since G is locally compact, (G,Œª) is a œÉ-Ô¨Ånite measure space and for
this reason, we were able to apply Corollary 1.4.24.
‚ñ°

74
1 Lp Spaces and Interpolation
Exercises
1.4.1. (a) Let g be a nonnegative integrable function on a measure space (X,Œº) and
let A be a measurable subset of X. Prove that

A gdŒº ‚â§
 Œº(A)
0
g‚àó(t)dt.
(b) (G. H. Hardy and J. E. Littlewood) For f and g measurable on a œÉ-Ô¨Ånite measure
space (X,Œº), prove that

X | f(x)g(x)|dŒº(x) ‚â§
 ‚àû
0
f ‚àó(t)g‚àó(t)dt.
Compare this result to the classical Hardy‚ÄìLittlewood result asserting that for
aj,bj > 0, the sum ‚àëj ajbj is greatest when both aj and bj are rearranged in de-
creasing order (for this see [148, p. 261]).
1.4.2. Let (X,Œº) be a measure space. Prove that if f ‚ààLq0,‚àû(X)‚à©Lq1,‚àû(X) for some
0 < q0 < q1 ‚â§‚àû, then f ‚ààLq,s(X) for all 0 < s ‚â§‚àûand q0 < q < q1.
1.4.3. ([164]) Given 0 < p,q < ‚àû, Ô¨Åx an r = r(p,q) > 0 such that r ‚â§1, r ‚â§q and
r < p. Let (X,Œº) be a measure space. For t < Œº(X) deÔ¨Åne
f ‚àó‚àó(t) = sup
Œº(E)‚â•t

1
Œº(E)

E | f|r dŒº
1/r
,
while for t ‚â•Œº(X) (if Œº(X) < ‚àû) let
f ‚àó‚àó(t) =
1
t

X | f|r dŒº
1/r
.
Also deÔ¨Åne
‚èê‚èê‚èê‚èê‚èê‚èêf
‚èê‚èê‚èê‚èê‚èê‚èê
Lp,q =
 ‚àû
0

t
1
p f ‚àó‚àó(t)
q dt
t
 1
q
.
(The function f ‚àó‚àóand the functional f ‚Üí||| f|||Lp,q depend on r.)
(a) Prove that the inequality ((( f +g)‚àó‚àó)(t))r ‚â§( f ‚àó‚àó(t))r +(g‚àó‚àó(t))r is valid for all
t ‚â•0. Since r ‚â§q, conclude that the functional f ‚Üí||| f|||r
Lp,q is subadditive and
hence it is a norm when r = 1 (this is possible only if p > 1).
(b) Show that for all f we have
f

Lp,q ‚â§
‚èê‚èê‚èê‚èê‚èê‚èêf
‚èê‚èê‚èê‚èê‚èê‚èê
Lp,q ‚â§

p
p‚àír
1/r f

Lp,q.
(c) Conclude that Lp,q(X) is metrizable and normable when 1 < p,q < ‚àû.

1.4 Lorentz Spaces
75
1.4.4. Show that on a measure space (X,Œº) the set of countable linear combinations
of simple functions is dense in Lp,‚àû(X).
(b) Prove that Ô¨Ånitely simple functions are not dense in Lp,‚àû(R) for any 0 < p ‚â§‚àû.

Hint: Part (b): Show that the function h(x) = x‚àí1/pœáx>0 cannot be approximated
in Lp,‚àûby a sequence of Ô¨Ånitely simple functions. Given a Ô¨Ånitely simple function s
which is nonzero on a set A with |A| > 0, show that ‚à•s‚àíh‚à•Lp,‚àû‚â•sup0<Œª<|A|1/p Œª(Œª ‚àíp
‚àí|A|)1/p = 1.

1.4.5. Let (X,Œº) be a nonatomic measure space.
(a) If A0 ‚´ÖA1 ‚´ÖX, 0 < Œº(A1) < ‚àû, and Œº(A0) ‚â§t ‚â§Œº(A1), show that there exists
an Et ‚´ÖA1 with Œº(Et) = t.
(b) Given a nonnegative continuous and decreasing function œï on [0,‚àû) such that
œï(t) = 0 whenever t ‚â•Œº(X), prove that there exists a measurable function f on X
with f ‚àó(t) = œï(t) for all t > 0.
(c) Given A ‚´ÖX with 0 < Œº(A) < ‚àûand g an integrable function on X, show that
there exists a subset #A of X with Œº(#A) = Œº(A) such that

#A |g|dŒº =
 Œº(A)
0
g‚àó(s)ds.
(d) If X is œÉ-Ô¨Ånite, f ‚ààL‚àû(X), and g ‚ààL1(X), prove that
sup
h: dh=d f


X hgdŒº
 =
 ‚àû
0
f ‚àó(s)g‚àó(s)ds,
where the supremum is taken over all functions h on X equidistributed with f.

Hint: Part (a): Reduce matters to the situation in which A0 = /0. Consider Ô¨Årst the
case that for all A ‚´ÖX there exists a subset B of X satisfying
1
10 Œº(A) ‚â§Œº(B) ‚â§
9
10 Œº(A). Then we can Ô¨Ånd subsets of A1 of measure in any arbitrarily small inter-
val, and by continuity the required conclusion follows. Next consider the case in
which there is a subset A1 of X such that every B ‚´ÖA1 satisÔ¨Åes Œº(B) < 1
10 Œº(A1)
or Œº(B) > 9
10 Œº(A1). Without loss of generality, normalize Œº so that Œº(A1) = 1. Let
Œº1 = sup{Œº(C) : C ‚´ÖA1, Œº(C) < 1
10} and pick B1 ‚´ÖA1 such that 1
2 Œº1 ‚â§Œº(B1) ‚â§
Œº1. Set A2 = A1 \B1 and deÔ¨Åne Œº2 = sup{Œº(C) : C ‚´ÖA2, Œº(C) < 1
10}. Continue in
this way and deÔ¨Åne sets A1 ‚´ÜA2 ‚´ÜA3 ‚´Ü¬∑¬∑¬∑ and numbers 1
10 ‚â•Œº1 ‚â•Œº2 ‚â•Œº3 ‚â•¬∑¬∑¬∑.
If C ‚´ÖAn+1 with Œº(C) < 1
10, then C‚à™Bn ‚´ÖAn with Œº(C‚à™Bn) < 1
5 < 9
10, and hence
by assumption we must have Œº(C ‚à™Bn) < 1
10. Conclude that Œºn+1 ‚â§1
2Œºn and that
Œº(An) ‚â•4
5 for all n = 1,2,.... Then the set ‚àû
n=1 An must be an atom. Part (b):
First show that when d is a simple right continuous decreasing function on [0,‚àû)
there exists a measurable f on X such that f ‚àó= d. For general continuous func-
tions, use approximation. Part (c): Let t = Œº(A) and deÔ¨Åne A1 = {x : |g(x)| > g‚àó(t)}
and A2 = {x : |g(x)| ‚â•g‚àó(t)}. Then A1 ‚´ÖA2 and Œº(A1) ‚â§t ‚â§Œº(A2). Pick #A such
that A1 ‚´Ö#A ‚´ÖA2 and Œº(#A) = t = Œº(A) by part (a). Then

#A gdŒº =

X gœá#A dŒº =
 ‚àû
0 (gœá#A)‚àóds =
 Œº(#A)
0
g‚àó(s)ds. Part (d): Reduce matters to functions f,g ‚â•0. Let

76
1 Lp Spaces and Interpolation
f = ‚àëN
j=1 ajœáA j where a1 > a2 > ¬∑¬∑¬∑ > aN > 0 and the Aj are pairwise disjoint.
Write f as ‚àëN
j=1 bjœáB j, where bj = (aj ‚àíaj+1) and Bj = A1 ‚à™¬∑¬∑¬∑‚à™Aj. Pick #Bj as in
part (c). Then #B1 ‚´Ö¬∑¬∑¬∑ ‚´Ö#BN and the function f1 = ‚àëN
j=1 bjœá#B j has the same distri-
bution function as f. It follows from part (c) that

X f1gdŒº =
 ‚àû
0 f ‚àó(s)g‚àó(s)ds. The
case of a general f ‚ààL‚àû(X) follows by approximation by Ô¨Ånitely simple functions.

1.4.6. ([7], [297]) Let K ‚â•1 and let ‚à•¬∑ ‚à•be a nonnegative functional on a vector
space X that satisÔ¨Åes
‚à•x+y‚à•‚â§K

‚à•x‚à•+‚à•y‚à•

for all x,y ‚ààX. For a Ô¨Åxed Œ± ‚â§1 satisfying (2K)Œ± = 2 show that
‚à•x1 +¬∑¬∑¬∑+xn‚à•Œ± ‚â§4(‚à•x1‚à•Œ± +¬∑¬∑¬∑+‚à•xn‚à•Œ±)
for all n = 1,2,... and all x1, x2, ..., xn in X. This inequality is referred to as the
Aoki-Rolewicz theorem.

Hint: Quasi-linearity implies that ‚à•x1 + ¬∑¬∑¬∑ + xn‚à•‚â§max1‚â§j‚â§n[(2K) j‚à•xj‚à•] for all
x1,...,xn in X (use that K ‚â•1). DeÔ¨Åne H : X ‚ÜíR by setting H(0) = 0 and
H(x) = 2j/Œ± if 2j‚àí1 < ‚à•x‚à•Œ± ‚â§2j. Then ‚à•x‚à•‚â§H(x) ‚â§21/Œ±‚à•x‚à•for all x ‚ààX. Prove by
induction that ‚à•x1 +¬∑¬∑¬∑+xn‚à•Œ± ‚â§2(H(x1)Œ± +¬∑¬∑¬∑+H(xn)Œ±). Suppose that this state-
ment is true when n = m. To show its validity for n = m+1, without loss of general-
ity assume that ‚à•x1‚à•‚â•‚à•x2‚à•‚â•¬∑¬∑¬∑ ‚â•‚à•xm+1‚à•. Then H(x1) ‚â•H(x2) ‚â•¬∑¬∑¬∑ ‚â•H(xm+1).
Assume that all the H(xj)‚Äôs are distinct. Then since H(xj)Œ± are distinct powers of 2,
they must satisfy H(xj)Œ± ‚â§2‚àíj+1H(x1)Œ±. Then
‚à•x1 +¬∑¬∑¬∑+xm+1‚à•Œ± ‚â§

max
1‚â§j‚â§m+1(2K) j‚à•xj‚à•
Œ±
‚â§

max
1‚â§j‚â§m+1(2K) jH(xj)
Œ±
‚â§

max
1‚â§j‚â§m+1(2K) j21/Œ±2‚àíj/Œ±H(x1)
Œ±
= 2H(x1)Œ±
‚â§2(H(x1)Œ± +¬∑¬∑¬∑+H(xm+1)Œ±).
We now consider the case that H(xj) = H(xj+1) for some 1 ‚â§j ‚â§m. Then for some
integer r we must have 2r‚àí1 < ‚à•xj+1‚à•Œ± ‚â§‚à•xj‚à•Œ± ‚â§2r and H(xj) = 2r/Œ±. Next note
that
‚à•xj +xj+1‚à•Œ± ‚â§KŒ±(‚à•xj‚à•+‚à•xj+1‚à•)Œ± ‚â§KŒ±(2 2r/Œ±)Œ± = 2r+1.
This implies
H(xj +xj+1)Œ± ‚â§2r+1 = 2r +2r = H(xj)Œ± +H(xj+1)Œ±.
Now apply the inductive hypothesis to x1,...,xj‚àí1,xj + xj+1,xj+1,...,xm and use
the previous inequality to obtain the required conclusion.

1.4.7. (a) ([347]) Let (X,Œº) and (Y,ŒΩ) be measure spaces. Let Z be a Banach space
of complex-valued measurable functions on Y. Assume that Z is closed under abso-

1.4 Lorentz Spaces
77
lute values and satisÔ¨Åes ‚à•f‚à•Z = ‚à•| f|‚à•Z. Suppose that T is a linear operator deÔ¨Åned
on the space of Ô¨Ånitely simple functions on (X,Œº) and taking values in Z. Suppose
that for some constant A > 0 the following restricted weak type estimate
T(œáE)

Z ‚â§AŒº(E)1/p
holds for some 0 < p < ‚àûand for all E measurable subsets of X of Ô¨Ånite measure.
Show that for all Ô¨Ånitely simply functions f on X we have
T( f)

Z ‚â§p‚àí1A
f

Lp,1 .
Consequently T has a bounded extension from Lp,1(X) to Z.
(b) ([172]) As an application of part (a) prove that for any U, V measurable subsets
of Rn with |U|,|V| < ‚àûand any f measurable on U √óV we have

U
 f(u,¬∑)
2
L2,1(V) du
 1
2
‚â§1
2
f

L2,1(U√óV) .

Hint: Part (a): Let f = ‚àëN
j=1 ajœáE j ‚â•0, where a1 > a2 > ¬∑¬∑¬∑ > aN > 0, Œº(Ej) < ‚àû
pairwise disjoint. Let Fj = E1 ‚à™¬∑¬∑¬∑ ‚à™Ej, B0 = 0, and Bj = Œº(Fj) for j ‚â•1. Write
f = ‚àëN
j=1(aj ‚àíaj+1)œáFj, where aN+1 = 0. Then
T( f)

Z =
|T( f)|

Z
‚â§
N
‚àë
j=1
(aj ‚àíaj+1)
T(œáFj)

Z
‚â§A
N
‚àë
j=1
(aj ‚àíaj+1)(Œº(Fj))1/p
= A
N‚àí1
‚àë
j=0
aj+1(B1/p
j+1 ‚àíB1/p
j
)
= p‚àí1A
 f

Lp,1 ,
where the penultimate equality follows by a summation by parts; see Appendix F.

1.4.8. Let 0 < p,q,Œ±,Œ≤ < ‚àû. Also let 0 < q1 < q2 < ‚àû.
(a) Show that the function fŒ±,Œ≤(t) = t‚àíŒ±(logt‚àí1)‚àíŒ≤ œá[0,e‚àíŒ≤/Œ±)(t) lies in Lp,q(R) if
and only if either p < 1/Œ± or both p = 1/Œ± and q > 1/Œ≤ hold. Conclude that the
function t ‚Üít‚àí1/p(logt‚àí1)‚àí1/q1œá[0,e‚àíp/q1)(t) lies in Lp,q2(R) but not in Lp,q1(R).
(b) Find a necessary and sufÔ¨Åcient condition in terms of p,Œ±,Œ≤ for the function
gŒ±,Œ≤(t) = (1+t)‚àíŒ±(log(2+t))‚àíŒ≤ œá[0,‚àû) to lie in Lp,q(R).

78
1 Lp Spaces and Interpolation
(c) Let œà(t) be smooth decreasing function on [0,‚àû) and let F(x) = œà(|x|) for x
in Rn, where |x| is the modulus of x. Show that F‚àó(t) = f((t/vn)1/n), where vn is
the volume of the unit ball. Use this formula to construct examples showing that
Lp,q1(Rn) ‚´ãLp,q2(Rn).
(d) On a general nonatomic measure space (X,Œº) prove that there does not exist a
constant C(p,q1,q2) > 0 such that for all f in Lp,q2(X) the following is valid:
f

Lp,q1 ‚â§C(p,q1,q2)
f

Lp,q2 .

Hint: Parts (a), (b): Use that fŒ±,Œ≤ and gŒ±,Œ≤ are equal to their decreasing rearrange-
ments. Part (d): Use Exercise 1.4.5 (b) with œï(t) = g1/p,1/q1(t).

1.4.9. ([346]) Let Lp(œâ) denote the space of all measurable functions f on Rn such
that ‚à•f‚à•p
Lp(œâ) =

Rn | f(x)|p œâ(x)dx < ‚àû, where 0 < œâ < ‚àûa.e. Let T be a sublinear
operator that maps Lp0(œâ0) to Lq0,‚àû(œâ) and Lp1(œâ1) to Lq1,‚àû(œâ), where œâ0,œâ1,œâ
are positive functions and 1 ‚â§p0 < p1 < ‚àû, 0 < q0,q1 < ‚àû. Suppose that
1
pŒ∏
= 1‚àíŒ∏
p0
+ Œ∏
p1
,
1
qŒ∏
= 1‚àíŒ∏
q0
+ Œ∏
q1
.
Let Œ©Œ∏ = œâ
1‚àíŒ∏
p0 pŒ∏
0
œâ
Œ∏
p1 pŒ∏
1
. Show that T maps LpŒ∏ 
Œ©Œ∏

‚ÜíLqŒ∏ ,pŒ∏ (œâ).

Hint: DeÔ¨Åne L( f) = (œâ1/œâ0)
1
p1‚àíp0 f and observe that for each Œ∏ ‚àà[0,1], L maps
LpŒ∏ 
Œ©Œ∏

‚ÜíLpŒ∏ 
(œâ p1
0 œâ‚àíp0
1
)
1
p1‚àíp0 
isometrically. Then apply Corollary 1.4.24 to
the sublinear operator T ‚ó¶L‚àí1.

1.4.10. ([185], [349]) Let Œªn be a sequence of positive numbers with ‚àën Œªn ‚â§1 and
‚àën Œªn log( 1
Œªn ) = K < ‚àû. Suppose all sequences are indexed by a Ô¨Åxed countable set.
(a) Let fn be a sequence of complex-valued functions in L1,‚àû(X) with ‚à•fn‚à•L1,‚àû‚â§1
uniformly in n. Prove that ‚àën Œªn fn lies in L1,‚àû(X) with norm at most 2(K +2). (This
property is referred to as the logconvexity of L1,‚àû.)
(b) Let Tn be a sequence of sublinear operators that map L1(X) to L1,‚àû(Y) with
norms ‚à•Tn‚à•L1‚ÜíL1,‚àû‚â§B uniformly in n. Use part (a) to prove that ‚àën ŒªnTn maps
L1(X) to L1,‚àû(Y) with norm at most 2B(K +2).
(c) Given Œ¥ > 0 pick 0 < Œµ < Œ¥ and use the simple estimate
Œº

{
‚àû
‚àë
n=1
2‚àíŒ¥n fn >Œ±}

‚â§
‚àû
‚àë
n=1
Œº

{2‚àíŒ¥n fn >(2Œµ ‚àí1)2‚àíŒµnŒ±}

to obtain a simple proof of the statement in part (a) when Œªn = 2‚àíŒ¥n, n = 1,2,....

Hint: Part (a): For Ô¨Åxed Œ± > 0, write fn = un + vn + wn, where un = fnœá| fn|‚â§Œ±
2 ,
vn = fnœá| fn|> Œ±
2Œªn , and wn = fnœá Œ±
2 <| fn|‚â§Œ±
2Œªn . Let u = ‚àën Œªnun, v = ‚àën Œªnvn, and w =
‚àën Œªnwn. Clearly |u| ‚â§Œ±
2 . Also {v Ã∏= 0} ‚´Ö
n{| fn| >
Œ±
2Œªn }; hence Œº({v Ã∏= 0}) ‚â§2
Œ± .
Finally,

1.4 Lorentz Spaces
79

X |w|dŒº ‚â§‚àë
n
Œªn

X | fn|œá Œ±
2 <| fn|‚â§Œ±
2Œªn dŒº
‚â§‚àë
n
Œªn
 Œ±/(2Œªn)
Œ±/2
dfn(Œ≤)dŒ≤ +
 Œ±/2
0
dfn(Œ±/2)dŒ≤

‚â§K +1.
Using Œº({|u+v+w| > Œ±}) ‚â§Œº({|u| > Œ±/2})+ Œº({|v| Ã∏= 0})+ Œº({|w| > Œ±/2}),
deduce the conclusion.

1.4.11. Let {fn}n be a sequence of measurable functions on a measure space (X,Œº).
Let 0 < q,s ‚â§‚àû.
(a) Suppose that fn ‚â•0 for all n. Show that
liminf
n‚Üí‚àûfn

Lq,s ‚â§liminf
n‚Üí‚àû
fn

Lq,s .
(b) Let gn ‚Üíg in Lq,s as n ‚Üí‚àû. Show that ‚à•gn‚à•Lq,s ‚Üí‚à•g‚à•Lq,s as n ‚Üí‚àû.
1.4.12. (a) Suppose that X is a quasi-Banach space and let X‚àóbe its dual (which is
always a Banach space). Prove that for all T ‚ààX‚àówe have
T

X‚àó= sup
x‚ààX
‚à•x‚à•X‚â§1
|T(x)|.
(b) Now suppose that X is a Banach space. Use the Hahn‚ÄìBanach theorem to prove
that for every x ‚ààX we have
‚à•x‚à•X =
sup
T‚ààX‚àó
‚à•T‚à•X‚àó‚â§1
|T(x)|.
Observe that this result may fail for quasi-Banach spaces. For example, if X = L1,‚àû,
every linear functional on X‚àóvanishes on the set of simple functions.
(c) Let 1 < p < ‚àû, X = Lp,1(Y), and X‚àó= Lp‚Ä≤,‚àû(Y), where (Y,Œº) is nonatomic
œÉ-Ô¨Ånite measure space. Conclude that
f

Lp,1 ‚âà
sup
‚à•g‚à•Lp‚Ä≤,‚àû‚â§1


Y fgdŒº
,
f

Lp,‚àû‚âà
sup
‚à•g‚à•Lp‚Ä≤,1‚â§1


Y fgdŒº
.
1.4.13. Let 0 < p,q < ‚àû. Prove that any function in Lp,q(X,Œº) can be written as
f =
+‚àû
‚àë
n=‚àí‚àû
cn fn,

80
1 Lp Spaces and Interpolation
where fn is a function bounded by 2‚àín/p, supported on a set of measure 2n, and the
sequence {ck}k lies in ‚Ñìq and satisÔ¨Åes
2‚àí1
p (log2)
1
q {ck}k

‚Ñìq ‚â§
f

Lp,q ‚â§
{ck}k

‚Ñìq 2
1
p (log2)
1
q .

Hint: Let cn = 2n/p f ‚àó(2n), An = {x : f ‚àó(2n+1) < | f(x)| ‚â§f ‚àó(2n))}, and fn =
c‚àí1
n f œáAn.

1.4.14. (T. Tao) Let 0 < p < ‚àû, 0 < Œ≥ < 1, A,B > 0, and let f be a measurable func-
tion on a measure space (X,Œº).
(a) Suppose that ‚à•f‚à•Lp,‚àû‚â§A. Then for every measurable set E of Ô¨Ånite measure
there exists a measurable subset E‚Ä≤ of E with Œº(E‚Ä≤) ‚â•Œ≥ Œº(E) such that f is inte-
grable on E‚Ä≤ and


E‚Ä≤ f dŒº
 ‚â§(1‚àíŒ≥)‚àí1/p AŒº(E)1‚àí1
p .
(b) Suppose that (X,Œº) is a œÉ-Ô¨Ånite measure space and that f has the property that
for any measurable subset E of X with Œº(E) < ‚àûthere is a measurable subset E‚Ä≤ of
E with Œº(E‚Ä≤) ‚â•Œ≥ Œº(E) such that f is integrable on E‚Ä≤ and


E‚Ä≤ f dŒº
 ‚â§BŒº(E)1‚àí1
p .
Then we have that ‚à•f‚à•Lp,‚àû‚â§B41/pŒ≥‚àí1‚àö
2.
(c) Conclude that if (X,Œº) is a œÉ-Ô¨Ånite measure space then
f

Lp,‚àû‚âà
sup
E‚´ÖX
0<Œº(E)<‚àû
inf
E‚Ä≤‚´ÖE
Œº(E‚Ä≤)‚â•1
2 Œº(E)
f‚ààL1(E‚Ä≤)
Œº(E)‚àí1+ 1
p


E‚Ä≤ f dŒº
.

Hint: Part (a): Take E‚Ä≤ = E \ {| f| > A(1 ‚àíŒ≥)‚àí1
p Œº(E)‚àí1
p }. Part (b): Write X =
‚àû
n=1 Xn with Œº(Xn) < ‚àû. Given Œ± > 0, note that the set
	
| f| > Œ±

is contained in
	
Re f > Œ±
‚àö
2

‚à™
	
Im f > Œ±
‚àö
2

‚à™
	
Re f <‚àíŒ±
‚àö
2

‚à™
	
Im f <‚àíŒ±
‚àö
2

.
Let En be any of the preceding four sets intersected with Xn, let E‚Ä≤
n be a subset of
it with measure at least Œ≥ Œº(En) as in the hypothesis. Then

E‚Ä≤n f dŒº
 ‚â•Œ±
‚àö
2Œ≥ Œº(En),
from which it follows that Œ±Œº(En)1/p ‚â§B
‚àö
2Œ≥‚àí1, and let n ‚Üí‚àû.

1.4.15. Let T be a linear operator deÔ¨Åned on the set of Ô¨Ånitely simple functions on
a œÉ-Ô¨Ånite measure space (X,Œº) and taking values in the set of measurable functions
on a œÉ-Ô¨Ånite measure space (Y,ŒΩ) and Tt be a linear operator deÔ¨Åned on the set
of Ô¨Ånitely simple functions on (Y,ŒΩ) and taking values in the set of measurable
functions of (X,Œº). Suppose that for all A subsets of X and B subsets of Y of Ô¨Ånite
measure we have

1.4 Lorentz Spaces
81

B |T(œáA)|dŒΩ +

A |Tt(œáB)|dŒº < ‚àû
and that T and Tt are related via the ‚Äútranspose identity‚Äù

Y T(œáA)œáB dŒΩ =

X Tt(œáB)œáA dŒº = Œõ(A,B).
Assume that whenever Œº(An)+ŒΩ(Bn) ‚Üí0 as n ‚Üí‚àû, we have Œõ(An,Bn) ‚Üí0. Sup-
pose that T and Tt are restricted weak type (1,1) operators, with constants C1 and
C2, respectively. Show that, for all 1 < p < ‚àû, T is of restricted weak type (p, p).
Precisely, show that there exists a constant Kp such that
T(œáA)

Lp(Y) ‚â§KpC
1
p
1 C
1‚àí1
p
2
Œº(A)
1
p
for all measurable subsets A of X with Œº(A) < ‚àû.

Hint: Suppose that C1Œº(F) > C2ŒΩ(E) and pick m so that C1Œº(F) ‚àº2mC2ŒΩ(E).
Since Tt is restricted weak type (1,1) there is an F‚Ä≤ ‚´ÖF such that Œº(F‚Ä≤) ‚â•1
2Œº(F)
and |Œõ(F‚Ä≤,E)| ‚â§2C2ŒΩ(E). Find by induction sets F( j) ‚´ÖF \ (F‚Ä≤ ‚à™¬∑¬∑¬∑ ‚à™F( j‚àí1))
such that Œº(F( j)) ‚â•1
2Œº(F \ (F‚Ä≤ ‚à™¬∑¬∑¬∑ ‚à™F( j‚àí1))) and |Œõ(F( j),E)| ‚â§2C2ŒΩ(E), j =
1,2,...,m. Stop when F(m) = F \(F‚Ä≤ ‚à™¬∑¬∑¬∑‚à™F(m‚àí1)) satisÔ¨Åes C1Œº(F(m)) ‚â§C2ŒΩ(E).
Since T is restricted weak type (1,1) there is a subset E‚Ä≤ of E such that ŒΩ(E‚Ä≤) ‚â•
1
2ŒΩ(E) and |Œõ(F(m),E‚Ä≤)| ‚â§2C1Œº(F(m)) ‚â§2C2ŒΩ(E). Now write
Œõ(F,E) =
m‚àí1
‚àë
j=1
Œõ(F( j),E)+Œõ(F(m),E‚Ä≤)+Œõ(F(m),E \E‚Ä≤)
from which it follows that
|Œõ(F,E)| ‚â§2C2ŒΩ(E)

1+log2
C1Œº(F)
C2ŒΩ(E)

+|Œõ(F1,E1)|
where F1 = F(m) and E1 = E \ E‚Ä≤. Note that the Ô¨Årst term in the sum above is
at most K‚Ä≤
p(C1Œº(F))1/p(C2ŒΩ(E))1/p‚Ä≤ and that the identical estimate holds if the
roles of E and F are reversed. Also observe that Œº(F1) ‚â§1
2Œº(F) and ŒΩ(E1) ‚â§
1
2ŒΩ(E). Continuing this process we Ô¨Ånd sets (Fn,En) with Œº(Fn+1) ‚â§1
2Œº(Fn) and
ŒΩ(En+1) ‚â§1
2ŒΩ(En).Using Œõ(Fn,En) ‚Üí0 as n ‚Üí‚àûwe deduce that |Œõ(F,E)| ‚â§
2K‚Ä≤
p(C1Œº(F))1/p(C2ŒΩ(E))1/p‚Ä≤. Considering the sets E+ = E ‚à©{T(œáF) > 0} and
E‚àí= E ‚à©{T(œáF) < 0}, obtain that

E
T(œáF)
dŒΩ ‚â§4K‚Ä≤
p

C1Œº(F)
 1
p 
C2ŒΩ(E)
 1
p‚Ä≤
for all F and E measurable sets of Ô¨Ånite measure. Exercise 1.1.12 (a) with r = 1
yields that ‚à•T(œáF)‚à•Lp,‚àû‚â§4KpC1/p
1
C1/p‚Ä≤
2
Œº(F)1/p.

1.4.16. ([35]) Let 0 < p0 < p1 < ‚àûand 0 < Œ±,Œ≤,A,B < ‚àû. Suppose that a family of
sublinear operators Tk is of restricted weak type (p0, p0) with constant A2‚àíkŒ± and
of restricted weak type (p1, p1) with constant B2kŒ≤ for all k ‚ààZ. Show that there

82
1 Lp Spaces and Interpolation
is a constant C = C(Œ±,Œ≤, p0, p1) such that ‚àëk‚ààZ Tk is of restricted weak type (p, p)
with constant CA1‚àíŒ∏BŒ∏, where Œ∏ = Œ±/(Œ± +Œ≤) and
1
p = 1‚àíŒ∏
p0
+ Œ∏
p1
.

Hint: Estimate Œº({|T(œáE)| > Œª}) by the sum ‚àëk‚â•k0 Œº({|Tk(œáE)| > cŒª2Œ±‚Ä≤(k0‚àík)})+
‚àëk‚â§k0 Œº({|Tk(œáE)| > cŒª2Œ≤ ‚Ä≤(k‚àík0)}), where c is a suitable constant and 0 < Œ±‚Ä≤ < Œ±,
0 < Œ≤ ‚Ä≤ < Œ≤. Apply the restricted weak type (p0, p0) hypothesis on each term of the
Ô¨Årst sum, the restricted weak type (p1, p1) hypothesis on each term of the second
sum, and choose k0 to optimize the resulting expression.

1.4.17. Let (X,Œº), (Y,ŒΩ) be measure spaces, 0 < p,r,q,s ‚â§‚àûand 0 < B < ‚àû. Sup-
pose that a sublinear operator T is deÔ¨Åned on a dense subspace D of Lp,r(X), takes
values in the space of measurable functions of another measure space Y, and satisÔ¨Åes
T( f) ‚â•0 for all f in D. Assume that
T(œï)

Lq,s ‚â§B
œï

Lp,r
for all œï in D. Prove that T admits a unique sublinear extension T on Lp,r(X) such
that
T( f)

Lq,s ‚â§B
f

Lp,r
for all f ‚ààLp,r(X).

Hint: Given f ‚ààLp,r(X) Ô¨Ånd a sequence of functions œïj in D such that œïj ‚Üíf in
Lp,r. Use the inequality |T(œïj)‚àíT(œïk)| ‚â§|T(œïj ‚àíœïk)|, to obtain that the sequence
{T(œïj)}j is Cauchy in Lq,s and thus it has a unique limit T( f) which is independent
of the choice of sequence œïj. Boundedness of T follows by density. To prove that T
is sublinear use that convergence in Lq,s implies convergence in measure and thus a
subsequence of T(œïj) converges ŒΩ-a.e. to T( f). Also use Exercise 1.4.11.

HISTORICAL NOTES
The modern theory of measure and integration was founded with the publication of Lebesgue‚Äôs
dissertation [214]; see also [215]. The theory of the Lebesgue integral reshaped the course of in-
tegration. The spaces Lp([a,b]), 1 < p < ‚àû, were Ô¨Årst investigated by Riesz [290], who obtained
many important properties of them. A rigorous treatise of harmonic analysis on general groups
can be found in the book of Hewitt and Ross [152]. The best possible constant Cpqr in Young‚Äôs
inequality ‚à•f ‚àóg‚à•Lr(Rn) ‚â§Cpqr‚à•f‚à•Lp(Rn)‚à•g‚à•Lq(Rn), 1
p + 1
q = 1
r + 1, 1< p,q,r <‚àû, was shown by
Beckner [21] to be Cpqr = (BpBqBr‚Ä≤)n, where B2
p = p1/p(p‚Ä≤)‚àí1/p‚Ä≤.
Theorem 1.3.2 Ô¨Årst appeared without proof in Marcinkiewicz‚Äôs brief note [240]. After his death
in World War II, this theorem seemed to have escaped attention until Zygmund reintroduced it
in [387]. This reference presents the more difÔ¨Åcult off-diagonal version of the theorem, derived
by Zygmund. Stein and Weiss [347] strengthened Zygmund‚Äôs theorem by assuming that the initial
estimates are of restricted weak type whenever 1 ‚â§p0, p1,q0,q1 ‚â§‚àû. The extension of this result
to the case 0 < p0, p1,q0,q1 < 1 in Theorem 1.4.19 is due to the author. The critical Lemma 1.4.20
was suggested by Kalton. Improvements of these results, in particular, the appearance of the space
S0(X) and the presence of the factor M1‚àíŒ∏
0
MŒ∏
1 in (1.4.24) appeared in Liang, Liu, and Yang [224].
Equivalence of restricted weak type (1,1) and weak type (1,1) properties for certain maximal

1.4 Lorentz Spaces
83
multipliers was obtained by Moon [257]. The following partial converse of Theorem 1.2.13 is due
to Stepanov [351]: If a convolution operator maps L1(Rn) to Lq,‚àû(Rn) for some 1 < q < ‚àûthen its
kernel must be in Lq,‚àû.
The extrapolation result of Exercise 1.3.7 is due to Yano [380]; see also Zygmund [389, pp.
119‚Äì120] and the related work of Carro [56], Soria [330], and Tao [356].
The original version of Theorem 1.3.4 was proved by Riesz [293] in the context of bilinear
forms. This version is called the Riesz convexity theorem, since it says that the logarithm of the
function M(Œ±,Œ≤) = infx,y
‚àën
j=1 ‚àëm
k=1 ajkxjyk
‚à•x‚à•‚àí1
‚Ñì1/Œ± ‚à•y‚à•‚àí1
‚Ñì1/Œ≤ (where the inÔ¨Åmum is taken over all
sequences {xj}n
j=1 in ‚Ñì1/Œ± and {yk}m
k=1 in ‚Ñì1/Œ≤) is a convex function of (Œ±,Œ≤) in the triangle 0 ‚â§
Œ±,Œ≤ ‚â§1, Œ± + Œ≤ ‚â•1. Riesz‚Äôs student Thorin [360] extended this triangle to the unit square 0 ‚â§
Œ±,Œ≤ ‚â§1 and generalized this theorem by replacing the maximum of a bilinear form with the
maximum of the modulus of an entire function in many variables. After the end of World War II,
Thorin published his thesis [361], building the subject and giving a variety of applications. The
original proof of Thorin was rather long, but a few years later, Tamarkin and Zygmund [354] gave
a very elegant short proof using the maximum modulus principle in a more efÔ¨Åcient way. Today,
this theorem is referred to as the Riesz‚ÄìThorin interpolation theorem.
Calder¬¥on [42] elaborated the complex-variables proof of the Riesz‚ÄìThorin theorem into a gen-
eral method of interpolation between Banach spaces. The complex interpolation method can also be
deÔ¨Åned for pairs of quasi-Banach spaces, although certain complications arise in this setting; how-
ever, the Riesz‚ÄìThorin theorem is true for pairs of Lp spaces (with the ‚Äúcorrect‚Äù geometric mean
constant) for all 0 < p ‚â§‚àûand also for Lorentz spaces. In this setting, duality cannot be used, but
a well-developed theory of analytic functions with values in quasi-Banach spaces is crucial. We
refer to the articles of Kalton [186] and [187] for details. Complex interpolation for sublinear maps
is also possible; see the article of Calder¬¥on and Zygmund [47]. Interpolation for analytic families
of operators (Theorem 1.3.7) is due to Stein [331]. The critical Lemma 1.3.8 used in the proof was
previously obtained by Hirschman [154].
The fact that nonatomic measure spaces contain subsets of all possible measures is classical.
An extension of this result to countably additive vector measures with values in Ô¨Ånite-dimensional
Banach spaces was obtained by Lyapunov [236]; for a proof of this fact, see Diestel and Uhl [95,
p. 264]. The Aoki‚ÄìRolewicz theorem (Exercise 1.4.6) was proved independently by Aoki [7] and
Rolewicz [297]. For a proof of this fact and a variety of its uses in the context of quasi-Banach
spaces we refer to the book of Kalton, Peck, and Roberts [188].
Decreasing rearrangements of functions were introduced by Hardy and Littlewood [146]; the
authors attribute their motivation to understanding cricket averages. The Lp,q spaces were intro-
duced by Lorentz in [232] and in [233]. A general treatment of Lorentz spaces is given in the
article of Hunt [164]. The normability of the spaces Lp,q (which holds exactly when 1 < p ‚â§‚àû
and 1 ‚â§q ‚â§‚àû) can be traced back to general principles obtained by Kolmogorov [199]. The in-
troduction of the function f ‚àó‚àó, which was used in Exercise 1.4.3, to explicitly deÔ¨Åne a norm on
the normable spaces Lp,q is due to Calder¬¥on [42]. These spaces appear as intermediate spaces in
the general interpolation theory of Calder¬¥on [42] and in that of Lions and Peetre [225]. The latter
was pointed out by Peetre [275]. For a systematic study of the duals of Lorentz spaces we refer to
Cwikel [83] and Cwikel and Fefferman [84], [85]. An extension of the Marcinkiewicz interpolation
theorem to Lorentz spaces was obtained by Hunt [163]. Carro, Raposo, and Soria [57] provide a
comprehensive presentation of the theory of Lorentz spaces in the context of weighted inequali-
ties. For further topics on interpolation one may consult the books of Bennett and Sharpley [24],
Bergh and L¬®ofstr¬®om [25], Sadosky [309], Kislyakov and Kruglyak [194], and Chapter 5 in Stein
and Weiss [348].

Chapter 2
Maximal Functions, Fourier Transform,
and Distributions
We have already seen that the convolution of a function with a Ô¨Åxed density is a
smoothing operation that produces a certain average of the function. Averaging is an
important operation in analysis and naturally arises in many situations. The study of
averages of functions is better understood by the introduction of the maximal func-
tion which is deÔ¨Åned as the largest average of a function over all balls containing a
Ô¨Åxed point. Maximal functions are used to obtain almost everywhere convergence
for certain integral averages and play an important role in this area, which is called
differentiation theory. Although maximal functions do not preserve qualitative in-
formation about the given functions, they maintain crucial quantitative information,
a fact of great importance in the subject of Fourier analysis.
Another important operation we study in this chapter is the Fourier transform,
the father of all oscillatory integrals. This is as fundamental to Fourier analysis as
marrow is to the human bone. It is a powerful transformation that carries a func-
tion from its spatial domain to its frequency domain. By doing this, it inverts the
function‚Äôs localization properties. If applied one more time, then magically repro-
duces the function composed with a reÔ¨Çection. It changes convolution to multipli-
cation, translation to modulation, and expanding dilation to shrinking dilation. Its
decay at inÔ¨Ånity encodes information about the local smoothness of the function.
The study of the Fourier transform also motivates the launch of a thorough study
of general oscillatory integrals. We take a quick look at this topic with emphasis on
one-dimensional results.
Distributions suppy a mathematical framework for many operations that do not
exactly qualify to be called functions. These operations found their mathematical
place in the world of functionals applied to smooth functions (called test functions).
These functionals also introduced the correct interpretation for many physical ob-
jects, such as the Dirac delta function. Distributions have become an indispensable
tool in analysis and have enhanced our perspective.
L. Grafakos, Classical Fourier Analysis, Graduate Texts in Mathematics 249,
DOI 10.1007/978-1-4939-1194-3 2, ¬© Springer Science+Business Media New York 2014
85

86
2 Maximal Functions, Fourier Transform, and Distributions
2.1 Maximal Functions
Given a Lebesgue measurable subset A of Rn, we denote by |A| its Lebesgue mea-
sure. For x ‚ààRn and r > 0, we denote by B(x,r) the open ball of radius r centered at
x. We also use the notation aB(x,Œ¥) = B(x,aŒ¥), for a > 0, for the ball with the same
center and radius aŒ¥. Given Œ¥ > 0 and f a locally integrable function on Rn, let
Avg
B(x,Œ¥)
| f| =
1
|B(x,Œ¥)|

B(x,Œ¥) | f(y)|dy
denote the average of | f| over the ball of radius Œ¥ centered at x.
2.1.1 The Hardy‚ÄìLittlewood Maximal Operator
DeÔ¨Ånition 2.1.1. Let f be a locally integrable function on Rn. The function
M( f)(x) = sup
Œ¥>0
Avg
B(x,Œ¥)
| f| = sup
Œ¥>0
1
vnŒ¥ n

|y|<Œ¥ | f(x‚àíy)|dy
is called the centered Hardy‚ÄìLittlewood maximal function of f.
Obviously we have M( f) = M(| f|) ‚â•0; thus the maximal function is a positive
operator. Information concerning cancellation of the function f is lost by passing
to M( f). We show later that M( f) pointwise controls f (i.e., M( f) ‚â•| f| almost
everywhere). Note that M maps L‚àûto itself, that is, we have
M( f)

L‚àû‚â§
f

L‚àû.
Let us compute the Hardy‚ÄìLittlewood maximal function of a speciÔ¨Åc function.
Example 2.1.2. On R, let f be the characteristic function of the interval [a,b]. For
x ‚àà(a,b), clearly M( f) = 1. For x ‚â•b, a simple calculation shows that the largest
average of f over all intervals (x‚àíŒ¥,x+Œ¥) is obtained when Œ¥ = x‚àía. Similarly,
when x ‚â§a, the largest average is obtained when Œ¥ = b‚àíx. Therefore,
M( f)(x) =
‚éß
‚é™
‚é®
‚é™
‚é©
(b‚àía)/2|x‚àíb|
when x ‚â§a,
1
when x ‚àà(a,b),
(b‚àía)/2|x‚àía|
when x ‚â•b.
Observe that M( f) has a jump at x = a and x = b equal to one-half that of f.
M is a sublinear operator, i.e., it satisÔ¨Åes M( f +g) ‚â§M( f)+M(g) and M(Œª f) =
|Œª|M( f) for all locally integrable functions f and g and all complex constants Œª. It
also has some interesting properties:

2.1 Maximal Functions
87
If f is locally integrable, then by considering the average of f over the ball
B(x,|x|+R), which contains the ball B(0,R), we obtain
M( f)(x) ‚â•

B(0,R) | f(y)|dy
vn(|x|+R)n
,
(2.1.1)
for all x ‚ààRn, where vn is the volume of the unit ball in Rn. An interesting conse-
quence of (2.1.1) is the following: suppose that f Ã∏= 0 on a set of positive measure
E, then M( f) is not in L1(Rn). In other words, if f is in L1
loc(Rn) and M( f) is in
L1(Rn), then f = 0 a.e. To see this, integrate (2.1.1) over the ball Rn to deduce that
‚à•f œáB(0,R)‚à•L1 = 0 and thus f(x) = 0 for almost all x in the ball B(0,R). Since this is
valid for all R = 1,2,3,..., it follows that f = 0 a.e. in Rn.
Another remarkable locality property of M is that if M( f)(x0) = 0 for some x0 in
Rn, then f = 0 a.e. To see we take x = x0 in (2.1.1) to deduce that ‚à•f œáB(0,R)‚à•L1 = 0
and as before we have that f = 0 a.e. on every ball centered at the origin, i.e., f = 0
a.e. in Rn.
A related analogue of M( f) is its uncentered version M( f), deÔ¨Åned as the supre-
mum of all averages of f over all open balls containing a given point.
DeÔ¨Ånition 2.1.3. The uncentered Hardy‚ÄìLittlewood maximal function of f,
M( f)(x) =
sup
Œ¥>0
|y‚àíx|<Œ¥
Avg
B(y,Œ¥)
| f|,
is deÔ¨Åned as the supremum of the averages of | f| over all open balls B(y,Œ¥) that
contain the point x.
Clearly M( f) ‚â§M( f); in other words, M is a larger operator than M. However,
M( f) ‚â§2nM( f) and the boundedness properties of M are identical to those of M.
Example 2.1.4. On R, let f be the characteristic function of the interval I = [a,b].
For x ‚àà(a,b), clearly M( f)(x) = 1. For x > b, a calculation shows that the largest
average of f over all intervals (y ‚àíŒ¥,y + Œ¥) that contain x is obtained when Œ¥ =
1
2(x ‚àía) and y = 1
2(x + a). Similarly, when x < a, the largest average is obtained
when Œ¥ = 1
2(b‚àíx) and y = 1
2(b+x). We conclude that
M( f)(x) =
‚éß
‚é™
‚é®
‚é™
‚é©
(b‚àía)/|x‚àíb|
when x ‚â§a,
1
when x ‚àà(a,b),
(b‚àía)/|x‚àía|
when x ‚â•b.
Observe that M does not have a jump at x = a and x = b and is in fact equal to the
function

1+ dist(x,I)
|I|
‚àí1.
We are now ready to obtain some basic properties of maximal functions. We need
the following simple covering lemma.

88
2 Maximal Functions, Fourier Transform, and Distributions
Lemma 2.1.5. Let {B1,B2,...,Bk} be a Ô¨Ånite collection of open balls in Rn. Then
there exists a Ô¨Ånite subcollection {Bj1,...,Bjl} of pairwise disjoint balls such that
l
‚àë
r=1
Bjr
 ‚â•3‚àín
k
i=1
Bi
.
(2.1.2)
Proof. Let us reindex the balls so that
|B1| ‚â•|B2| ‚â•¬∑¬∑¬∑ ‚â•|Bk|.
Let j1 = 1. Having chosen j1, j2,..., ji, let ji+1 be the least index s > ji such that
i
m=1 Bjm is disjoint from Bs. Since we have a Ô¨Ånite number of balls, this process will
terminate, say after l steps. We have now selected pairwise disjoint balls Bj1,...,Bjl.
If some Bm was not selected, that is, m /‚àà{j1,..., jl}, then Bm must intersect a
selected ball Bjr for some jr < m. Then Bm has smaller size than Bjr and we must
have Bm ‚´Ö3Bjr. This shows that the union of the unselected balls is contained in the
union of the triples of the selected balls. Therefore, the union of all balls is contained
in the union of the triples of the selected balls. Thus

k
i=1
Bi
 ‚â§

l
r=1
3Bjr
 ‚â§
l
‚àë
r=1
|3Bjr| = 3n
l
‚àë
r=1
|Bjr|,
and the required conclusion follows.
‚ñ°
It was noted earlier that M( f) and M( f) never map into L1. However, it is true
that these functions are in L1,‚àûwhen f is in L1. Operators that map L1 to L1,‚àûare
said to be weak type (1,1). The centered and uncentered maximal functions M and
M are of weak type (1,1) as shown in the next theorem.
Theorem 2.1.6. The uncentered and centered Hardy‚ÄìLittlewood maximal operators
M and M map L1(Rn) to L1,‚àû(Rn) with constant at most 3n and also Lp(Rn) to
Lp(Rn) for 1 < p < ‚àûwith constant at most 3n/pp(p ‚àí1)‚àí1. For any f ‚ààL1(Rn)
we also have
	
M( f) > Œ±

 ‚â§3n
Œ±

{M( f)>Œ±} | f(y)|dy.
(2.1.3)
Proof. We claim that the set EŒ± = {x ‚ààRn : M( f)(x) > Œ±} is open. Indeed, for
x ‚ààEŒ±, there is an open ball Bx that contains x such that the average of | f| over Bx
is strictly bigger than Œ±. Then the uncentered maximal function of any other point
in Bx is also bigger than Œ±, and thus Bx is contained in EŒ±. This proves that EŒ± is
open.
Let K be a compact subset of EŒ±. For each x ‚ààK there exists an open ball Bx
containing the point x such that

Bx
| f(y)|dy > Œ±|Bx|.
(2.1.4)

2.1 Maximal Functions
89
Observe that Bx ‚äÇEŒ± for all x. By compactness there exists a Ô¨Ånite subcover
{Bx1,...,Bxk} of K. Using Lemma 2.1.5 we Ô¨Ånd a subcollection of pairwise disjoint
balls Bx j1,...,Bx jl such that (2.1.2) holds. Using (2.1.4) and (2.1.2) we obtain
|K| ‚â§

k
i=1
Bxi
 ‚â§3n
l
‚àë
i=1
|Bx ji| ‚â§3n
Œ±
l
‚àë
i=1

Bx ji
| f(y)|dy ‚â§3n
Œ±

EŒ±
| f(y)|dy,
since all the balls Bx ji are disjoint and contained in EŒ±. Taking the supremum over
all compact K ‚äÜEŒ± and using the inner regularity of Lebesgue measure, we deduce
(2.1.3). We have now proved that M maps L1 ‚ÜíL1,‚àûwith constant 3n. It is a trivial
fact that M maps L‚àû‚ÜíL‚àûwith constant 1. Since M is well deÔ¨Åned and Ô¨Ånite a.e.
on L1 + L‚àû, it is also on Lp(Rn) for 1 < p < ‚àû. The Marcinkiewicz interpolation
theorem (Theorem 1.3.2) implies that M maps Lp(Rn) to Lp(Rn) for all 1 < p < ‚àû.
Using Exercise 1.3.3, we obtain the following estimate for the operator norm of M
on Lp(Rn):
M

Lp‚ÜíLp ‚â§p3
n
p
p‚àí1 .
(2.1.5)
Observe that a direct application of Theorem 1.3.2 would give the slightly worse
bound of 2

p
p‚àí1
 1
p 3
n
p . Finally the boundedness of M follows from that of M.
‚ñ°
Remark 2.1.7. The previous proof gives a bound on the operator norm of M on
Lp(Rn) that grows exponentially with the dimension. One may wonder whether this
bound could be improved to a better one that does not grow exponentially in the
dimension n, as n ‚Üí‚àû. This is not possible; see Exercise 2.1.8.
Example 2.1.8. Let R > 0. Then we have
Rn
(|x|+R)n ‚â§M(œáB(0,R))(x) ‚â§
6n Rn
(|x|+R)n .
(2.1.6)
The lower estimate in (2.1.6), is an easy consequence of the fact that the ball
B(x,|x| + R) contains the ball B(0,R). For the upper estimate, we Ô¨Årst consider the
case where |x| ‚â§2R, when clearly M(œáB(0,R))(x) ‚â§1 ‚â§
3n Rn
(|x|+R)n . In the case where
|x| > 2R, if the balls B(x,r) and B(0,R) intersect, we must have that r > |x|‚àíR. But
note that |x|‚àíR > 1
3(|x|+R), since |x| > 2R. We conclude that for |x| > 2R we have
M(œáB(0,R))(x) ‚â§sup
r>0
|B(x,r)‚à©B(0,R)|
|B(x,r)|
‚â§
sup
r>|x|‚àíR
vnRn
vnrn ‚â§
Rn
 1
3(|x|+R)
n
and thus the upper estimate in (2.1.6) holds since M(œáB(0,R)) ‚â§2nM(œáB(0,R)). Thus
in both cases the upper estimate in (2.1.6) is valid.
Next we estimate M(M(œáB(0,R)))(x). First we write
Rn
(|x|+R)n ‚â§œáB(0,R) +
‚àû
‚àë
k=0
Rn
(R+2kR)n œáB(0,2k+1R)\B(0,2kR) .

90
2 Maximal Functions, Fourier Transform, and Distributions
Using the upper estimate in (2.1.6) and the sublinearity of M, we obtain
M

Rn
(|¬∑|+R)n

(x) ‚â§M(œáB(0,R))(x)+
‚àû
‚àë
k=0
1
(1+2k)n M(œáB(0,2k+1R))(x)
‚â§
6n Rn
(|x|+R)n +
‚àû
‚àë
k=0
1
2nk
6n (2k+1R)n
(|x|+2k+1R)n
‚â§Cn log(e+|x|/R)
(1+|x|/R)n
,
where the last estimate follows by summing separately over k satisfying 2k+1 ‚â§|x|/R
and 2k+1 ‚â•|x|/R. Note that the presence of the logarithm does not affect the Lp
boundedness of this function when p > 1.
2.1.2 Control of Other Maximal Operators
We now study some properties of the Hardy‚ÄìLittlewood maximal function. We
begin with a notational deÔ¨Ånition that we plan to use throughout this book.
DeÔ¨Ånition 2.1.9. Given a function g on Rn and Œµ > 0, we denote by gŒµ the following
function:
gŒµ(x) = Œµ‚àíng(Œµ‚àí1x).
(2.1.7)
As observed in Example 1.2.17, if g is an integrable function with integral equal
to 1, then the family deÔ¨Åned by (2.1.7) is an approximate identity. Therefore, convo-
lution with gŒµ is an averaging operation. The Hardy‚ÄìLittlewood maximal function
M( f) is obtained as the supremum of the averages of a function f with respect to
the dilates of the kernel k = v‚àí1
n œáB(0,1) in Rn; here vn is the volume of the unit ball
B(0,1). Indeed, we have
M( f)(x) = sup
Œµ>0
1
vnŒµn

Rn | f(x‚àíy)|œáB(0,1)
 y
Œµ

dy
= sup
Œµ>0
(| f|‚àókŒµ)(x).
Note that the function k = v‚àí1
n œáB(0,1) has integral equal to 1, and convolving with kŒµ
is an averaging operation.
It turns out that the Hardy‚ÄìLittlewood maximal function controls the averages of
a function with respect to any radially decreasing L1 function. Recall that a function
f on Rn is called radial if f(x) = f(y) whenever |x| = |y|. Note that a radial func-
tion f on Rn has the form f(x) = œï(|x|) for some function œï on R+. We have the
following result.

2.1 Maximal Functions
91
Theorem 2.1.10. Let k ‚â•0 be a function on [0,‚àû) that is continuous except at a
Ô¨Ånite number of points. Suppose that K(x) = k(|x|) is an integrable function on Rn
that satisÔ¨Åes
K(x) ‚â•K(y),
whenever |x| ‚â§|y|,
(2.1.8)
i.e., k is decreasing. Then the following estimate is true:
sup
Œµ>0
(| f|‚àóKŒµ)(x) ‚â§
K

L1M( f)(x)
(2.1.9)
for all locally integrable functions f on Rn.
Proof. We prove (2.1.9) when K is radial, satisÔ¨Åes (2.1.8), and is compactly sup-
ported and continuous. When this case is established, select a sequence Kj of radial,
compactly supported, continuous functions that increase to K as j ‚Üí‚àû. This is pos-
sible, since the function k is continuous except at a Ô¨Ånite number of points. If (2.1.9)
holds for each Kj, passing to the limit implies that (2.1.9) also holds for K. Next,
we observe that it sufÔ¨Åces to prove (2.1.9) for x = 0. When this case is established,
replacing f(t) by f(t +x) implies that (2.1.9) holds for all x.
Let us now Ô¨Åx a radial, continuous, and compactly supported function K with
support in the ball B(0,R), satisfying (2.1.8). Also Ô¨Åx an f ‚ààL1
loc and take x = 0. Let
e1 be the vector (1,0,0,...,0) on the unit sphere Sn‚àí1. Polar coordinates give

Rn | f(y)|KŒµ(‚àíy)dy =
 ‚àû
0

Sn‚àí1 | f(rŒ∏)|KŒµ(re1)rn‚àí1 dŒ∏ dr.
(2.1.10)
DeÔ¨Åne functions
F(r) =

Sn‚àí1 | f(rŒ∏)|dŒ∏ ,
G(r) =
 r
0 F(s)sn‚àí1 ds,
where dŒ∏ denotes surface measure on Sn‚àí1. Using these functions, (2.1.10), and
integration by parts, we obtain

Rn | f(y)|KŒµ(y)dy =
 ŒµR
0
F(r)rn‚àí1KŒµ(re1)dr
= G(ŒµR)KŒµ(ŒµRe1)‚àíG(0)KŒµ(0)‚àí
 ŒµR
0
G(r)dKŒµ(re1)
=
 ‚àû
0 G(r)d(‚àíKŒµ(re1)),
(2.1.11)
where two of the integrals are of Lebesgue‚ÄìStieltjes type and we used our assump-
tions that G(0) = 0, KŒµ(0) < ‚àû, G(ŒµR) < ‚àû, and KŒµ(ŒµRe1) = 0. Let vn be the volume
of the unit ball in Rn. Since
G(r) =
 r
0 F(s)sn‚àí1 ds =

|y|‚â§r | f(y)|dy ‚â§M( f)(0)vnrn ,

92
2 Maximal Functions, Fourier Transform, and Distributions
it follows that the expression in (2.1.11) is dominated by
M( f)(0)vn
 ‚àû
0 rnd(‚àíKŒµ(re1)) = M( f)(0)
 ‚àû
0 nvnrn‚àí1KŒµ(re1)dr
= M( f)(0)
K

L1 .
Here we used integration by parts and the fact that the surface measure of the unit
sphere Sn‚àí1 is equal to nvn. See Appendix A.3. The theorem is now proved.
‚ñ°
Remark 2.1.11. Theorem 2.1.10 can be generalized as follows. If K is an L1 function
on Rn such that |K(x)| ‚â§k0(|x|) = K0(x), where k0 is a nonnegative decreasing func-
tion on [0,‚àû) that is continuous except at a Ô¨Ånite number of points, then (2.1.9) holds
with ‚à•K‚à•L1 replaced by ‚à•K0‚à•L1. Such a K0 is called a radial decreasing majorant of
K. This observation is formulated as the following corollary.
Corollary 2.1.12. If a function œï has an integrable radially decreasing majorant Œ¶,
then the estimate
sup
t>0
|( f ‚àóœït)(x)| ‚â§
Œ¶

L1M( f)(x)
is valid for all locally integrable functions f on Rn.
Example 2.1.13. Let
P(x) =
cn
(1+|x|2)
n+1
2
,
where cn is a constant such that

Rn P(x)dx = 1.
The function P is called the Poisson kernel. We deÔ¨Åne L1 dilates Pt of the Poisson
kernel P by setting
Pt(x) = t‚àínP(t‚àí1x)
for t > 0. It is straightforward to verify that when n ‚â•2,
d2
dt2 Pt +
n
‚àë
j=1
‚àÇ2
j Pt = 0,
that is, Pt(x1,...,xn) is a harmonic function of the variables (x1,...,xn,t). Therefore,
for f ‚ààLp(Rn), 1 ‚â§p < ‚àû, the function
u(x,t) = ( f ‚àóPt)(x)
is harmonic in Rn+1
+
and converges to f(x) in Lp(dx) as t ‚Üí0, since {Pt}t>0 is an
approximate identity. If we knew that f ‚àóPt converged to f a.e. as t ‚Üí0, then we
could say that u(x,t) solves the Dirichlet problem

2.1 Maximal Functions
93
‚àÇ2
t u+
n
‚àë
j=1
‚àÇ2
j u = 0
on Rn+1
+ ,
u(x,0) = f(x)
a.e. on Rn.
(2.1.12)
Solving the Dirichlet problem (2.1.12) motivates the study of the almost everywhere
convergence of the expressions f ‚àóPt.
Let us now compute the value of the constant cn. Denote by œân‚àí1 the surface area
of Sn‚àí1. Using polar coordinates, we obtain
1
cn
=

Rn
dx
(1+|x|2)
n+1
2
= œân‚àí1
 ‚àû
0
rn‚àí1
(1+r2)
n+1
2
dr
= œân‚àí1
 œÄ/2
0
(sinœï)n‚àí1 dœï
(r = tanœï)
= 2œÄ
n
2
Œì ( n
2)
1
2
Œì ( n
2)Œì ( 1
2)
Œì ( n+1
2 )
=
œÄ
n+1
2
Œì ( n+1
2 ) ,
where we used the formula for œân‚àí1 in Appendix A.3 and an identity in Appendix
A.4. We conclude that
cn = Œì ( n+1
2 )
œÄ
n+1
2
and that the Poisson kernel on Rn is given by
P(x) = Œì ( n+1
2 )
œÄ
n+1
2
1
(1+|x|2)
n+1
2
.
(2.1.13)
Theorem 2.1.10 implies that the solution of the Dirichlet problem (2.1.12) is point-
wise bounded by the Hardy‚ÄìLittlewood maximal function of f.
2.1.3 Applications to Differentiation Theory
We continue this section by obtaining some applications of the boundedness of the
Hardy‚ÄìLittlewood maximal function in differentiation theory.

94
2 Maximal Functions, Fourier Transform, and Distributions
We now show that the weak type (1,1) property of the Hardy‚ÄìLittlewood max-
imal function implies almost everywhere convergence for a variety of families of
functions. We deduce this from the more general fact that a certain weak type prop-
erty for the supremum of a family of linear operators implies almost everywhere
convergence.
Here is our setup. Let (X,Œº), (Y,ŒΩ) be measure spaces and let 0 < p ‚â§‚àû, 0 <
q < ‚àû. Suppose that D is a dense subspace of Lp(X,Œº). This means that for all
f ‚ààLp and all Œ¥ > 0 there exists a g ‚ààD such that ‚à•f ‚àíg‚à•Lp < Œ¥. Suppose that for
every Œµ > 0, TŒµ is a linear operator that maps Lp(X,Œº) into a subspace of measurable
functions, which are deÔ¨Åned everywhere on Y. For y ‚ààY, deÔ¨Åne a sublinear operator
T‚àó( f)(y) = sup
Œµ>0
|TŒµ( f)(y)|
(2.1.14)
and assume that T‚àó( f) is ŒΩ- measurable for any f ‚ààLp(X,Œº). We have the following.
Theorem 2.1.14. Let 0 < p < ‚àû, 0 < q < ‚àû, and TŒµ and T‚àóas previously. Suppose
that for some B > 0 and all f ‚ààLp(X) we have
T‚àó( f)

Lq,‚àû‚â§B
 f

Lp
(2.1.15)
and that for all f ‚ààD,
lim
Œµ‚Üí0TŒµ( f) = T( f)
(2.1.16)
exists and is Ô¨Ånite ŒΩ-a.e. (and deÔ¨Ånes a linear operator on D). Then for all func-
tions f in Lp(X,Œº) the limit (2.1.16) exists and is Ô¨Ånite ŒΩ-a.e., and deÔ¨Ånes a linear
operator T on Lp(X) (uniquely extending T deÔ¨Åned on D) that satisÔ¨Åes
T( f)

Lq,‚àû‚â§B
f

Lp
(2.1.17)
for all functions f in Lp(X).
Proof. Given f in Lp, we deÔ¨Åne the oscillation of f:
Of (y) = limsup
Œµ‚Üí0
limsup
Œ∏‚Üí0
|TŒµ( f)(y)‚àíTŒ∏( f)(y)|.
We would like to show that for all f ‚ààLp and Œ¥ > 0,
ŒΩ({y ‚ààY : Of (y) > Œ¥}) = 0.
(2.1.18)
Once (2.1.18) is established, given f ‚ààLp(X), we obtain that Of (y) = 0 for ŒΩ-almost
all y, which implies that TŒµ( f)(y) is Cauchy for ŒΩ-almost all y, and it therefore
converges ŒΩ-a.e. to some T( f)(y) as Œµ ‚Üí0. The operator T deÔ¨Åned this way on
Lp(X) is linear and extends T deÔ¨Åned on D.
To approximate Of we use density. Given Œ∑ > 0, Ô¨Ånd a function g ‚ààD such that
‚à•f ‚àíg‚à•Lp < Œ∑. Since TŒµ(g) ‚ÜíT(g) ŒΩ-a.e, it follows that Og = 0 ŒΩ-a.e. Using this
fact and the linearity of the TŒµ‚Äôs, we conclude that
Of (y) ‚â§Og(y)+Of‚àíg(y) = Of‚àíg(y)
ŒΩ-a.e.

2.1 Maximal Functions
95
Now for any Œ¥ > 0 we have
ŒΩ({y ‚ààY : Of (y) > Œ¥}) ‚â§ŒΩ({y ‚ààY : Of‚àíg(y) > Œ¥})
‚â§ŒΩ({y ‚ààY : 2T‚àó( f ‚àíg)(y) > Œ¥})
‚â§

2B
 f ‚àíg

Lp/Œ¥
q
‚â§(2BŒ∑/Œ¥)q .
Letting Œ∑ ‚Üí0, we deduce (2.1.18). We conclude that TŒµ( f) is a Cauchy sequence,
and hence it converges ŒΩ-a.e. to some T( f). Since |T( f)| ‚â§|T‚àó( f)|, the conclusion
(2.1.17) of the theorem follows easily.
‚ñ°
We now derive some applications. First we return to the issue of almost every-
where convergence of the expressions f ‚àóPy, where P is the Poisson kernel.
Example 2.1.15. Fix 1 ‚â§p < ‚àûand f ‚ààLp(Rn). Let
P(x) = Œì ( n+1
2 )
œÄ
n+1
2
1
(1+|x|2)
n+1
2
be the Poisson kernel on Rn and let PŒµ(x) = Œµ‚àínP(Œµ‚àí1x). We deduce from the previ-
ous theorem that the family f ‚àóPŒµ converges to f a.e. Let D be the set of all contin-
uous functions with compact support on Rn. Since the family (PŒµ)Œµ>0 is an approx-
imate identity, Theorem 1.2.19 (2) implies that for f in D we have that f ‚àóPŒµ ‚Üíf
uniformly on compact subsets of Rn and hence pointwise everywhere. In view of
Theorem 2.1.10, the supremum of the family of linear operators TŒµ( f) = f ‚àóPŒµ is
controlled by the Hardy‚ÄìLittlewood maximal function, and thus it maps Lp to Lp,‚àû
for 1 ‚â§p < ‚àû. Theorem 2.1.14 now gives that f ‚àóPŒµ converges to f a.e. for all f ‚ààLp.
Here is another application of Theorem 2.1.14. Exercise 2.1.10 contains other ap-
plications.
Corollary 2.1.16. (Lebesgue‚Äôs differentiation theorem) For any locally integrable
function f on Rn we have
lim
r‚Üí0
1
|B(x,r)|

B(x,r) f(y)dy = f(x)
(2.1.19)
for almost all x in Rn. Consequently we have | f| ‚â§M( f) a.e. There is also an
analogous statement to (2.1.19) in which balls are replaced by cubes centered at x.
Precisely, for any locally integrable function f on Rn we have
lim
r‚Üí0
1
(2r)n

x+[‚àír,r]n f(y)dy = f(x)
(2.1.20)
for almost all x in Rn.

96
2 Maximal Functions, Fourier Transform, and Distributions
Proof. Since Rn is the union of the balls B(0,N) for N = 1,2,3..., it sufÔ¨Åces to
prove the required conclusion for almost all x inside a Ô¨Åxed ball B(0,N). Given a
locally integrable function f on Rn, consider the function fN = f œáB(0,N+1). Then
fN lies in L1(Rn). Let TŒµ be the operator given with convolution with kŒµ, where
k = v‚àí1
n œáB(0,1) and 0 < Œµ < 1. We know that the corresponding maximal operator T‚àó
is controlled by the centered Hardy‚ÄìLittlewood maximal function M, which maps L1
to L1,‚àû. It is straightforward to verify that (2.1.19) holds for all continuous functions
f with compact support. Since this set of functions is dense in L1, and T‚àómaps L1
to L1,‚àû, Theorem 2.1.14 implies that (2.1.19) holds for all integrable functions on Rn,
in particular for fN. But for 0 < Œµ < 1 and x ‚ààB(0,N) we have f œáB(x,Œµ) = fNœáB(x,Œµ),
so it follows that
lim
Œµ‚Üí0
1
|B(x,Œµ)|

B(x,Œµ) f(y)dy = lim
Œµ‚Üí0
1
|B(x,Œµ)|

B(x,Œµ) fN(y)dy = fN(x)
for almost all x ‚ààRn, in particular for almost all x in B(0,N). But on this set fN = f,
so the required conclusion follows. The assertion that | f| ‚â§M( f) a.e. is an easy
consequence of (2.1.19) when the limit is replaced by a supremum.
Finally, with minor modiÔ¨Åcations, the proof can be adjusted to work for cubes in
place of balls. To prove (2.1.20), for f ‚ààL1
loc(Rn) we introduce the maximal operator
Mc( f)(x) = sup
r>0
1
(2r)n

x+[‚àír,r]n | f(y)|dy.
Then Exercise 2.1.3 yields that Mc maps L1(Rn) to weak L1(Rn) and the preceding
proof with Mc in place of M yields (2.1.20).
‚ñ°
The following corollaries were inspired by Example 2.1.15.
Corollary 2.1.17. (Differentiation theorem for approximate identities) Let K be an
L1 function on Rn with integral 1 that has a continuous integrable radially decreas-
ing majorant. Then f ‚àóKŒµ ‚Üíf a.e. as Œµ ‚Üí0 for all f ‚ààLp(Rn), 1 ‚â§p < ‚àû.
Proof. It follows from Example 1.2.17 that KŒµ is an approximate identity. Theorem
1.2.19 now implies that f ‚àóKŒµ ‚Üíf uniformly on compact sets when f is continuous.
Let D be the space of all continuous functions with compact support. Then f ‚àóKŒµ ‚Üí
f a.e. for f ‚ààD. It follows from Corollary 2.1.12 that T‚àó( f) = supŒµ>0 | f ‚àóKŒµ| maps
Lp to Lp,‚àûfor 1 ‚â§p < ‚àû. Using Theorem 2.1.14, we conclude the proof of the
corollary.
‚ñ°
Remark 2.1.18. Fix f ‚ààLp(Rn) for some 1 ‚â§p < ‚àû. Theorem 1.2.19 implies that
f ‚àóKŒµ converges to f in Lp and hence some subsequence f ‚àóKŒµn of f ‚àóKŒµ converges
to f a.e. as n ‚Üí‚àû, (Œµn ‚Üí0). Compare this result with Corollary 2.1.17, which gives
a.e. convergence for the whole family f ‚àóKŒµ as Œµ ‚Üí0.
Corollary 2.1.19. (Differentiation theorem for multiples of approximate identi-
ties) Let K be a function on Rn that has an integrable radially decreasing majorant.

2.1 Maximal Functions
97
Let a =

Rn K(x)dx. Then for all f ‚ààLp(Rn) and 1 ‚â§p < ‚àû, ( f ‚àóKŒµ)(x) ‚Üíaf(x)
for almost all x ‚ààRn as Œµ ‚Üí0.
Proof. Use Theorem 1.2.21 instead of Theorem 1.2.19 in the proof of Corollary
2.1.17.
‚ñ°
The following application of the Lebesgue differentiation theorem uses a simple
stopping-time argument. This is the sort of argument in which a selection procedure
stops when it is exhausted at a certain scale and is then repeated at the next scale. A
certain reÔ¨Ånement of the following proposition is of fundamental importance in the
study of singular integrals given in Chapter 4.
Proposition 2.1.20. Given a nonnegative integrable function f on Rn and Œ± > 0,
there exists a collection of disjoint (possibly empty) open cubes Q j such that for
almost all x ‚àà

j Qj
c we have f(x) ‚â§Œ± and
Œ± <
1
|Qj|

Qj
f(t)dt ‚â§2nŒ± .
(2.1.21)
Proof. The proof provides an excellent paradigm of a stopping-time argument. Start
by decomposing Rn as a union of cubes of equal size, whose interiors are disjoint,
and whose diameter is so large that |Q|‚àí1 
Q f(x)dx ‚â§Œ± for every Q in this mesh.
This is possible since f is integrable and |Q|‚àí1 
Q f(x)dx ‚Üí0 as |Q| ‚Üí‚àû. Call the
union of these cubes E0.
Divide each cube in the mesh into 2n congruent cubes by bisecting each of the
sides. Call the new collection of cubes E1. Select a cube Q in E1 if
1
|Q|

Q f(x)dx > Œ±
(2.1.22)
and call the set of all selected cubes S1. Now subdivide each cube in E1 \ S1 into
2n congruent cubes by bisecting each of the sides as before. Call this new collection
of cubes E2. Repeat the same procedure and select a family of cubes S2 that satisfy
(2.1.22). Continue this way ad inÔ¨Ånitum and call the cubes in ‚àû
m=1 Sm ‚Äúselected.‚Äù
If Q was selected, then there exists Q1 in Em‚àí1 containing Q that was not selected at
the (m‚àí1)th step for some m ‚â•1. Therefore,
Œ± < 1
|Q|

Q f(x)dx ‚â§2n 1
|Q1|

Q1
f(x)dx ‚â§2nŒ± .
Now call F the closure of the complement of the union of all selected cubes. If
x ‚ààF, then there exists a sequence of cubes containing x whose diameter shrinks
down to zero such that the average of f over these cubes is less than or equal to Œ±.
By Corollary 2.1.16, it follows that f(x) ‚â§Œ± almost everywhere in F. This proves
the proposition.
‚ñ°
In the proof of Proposition 2.1.20 it was not crucial to assume that f was deÔ¨Åned
on all Rn, but only on a cube. We now give a local version of this result.

98
2 Maximal Functions, Fourier Transform, and Distributions
Corollary 2.1.21. Let f ‚â•0 be an integrable function over a cube Q in Rn and let
Œ± ‚â•
1
|Q|

Q f dx. Then there exist disjoint (possibly empty) open subcubes Q j of Q
such that for almost all x ‚ààQ\ 
j Qj we have f ‚â§Œ± and (2.1.21) holds for all Qj.
Proof. The proof easily follows by a simple modiÔ¨Åcation of Proposition 2.1.20 in
which Rn is replaced by the Ô¨Åxed cube Q. To apply Corollary 2.1.16, we extend f to
be zero outside the cube Q.
‚ñ°
See Exercise 2.1.4 for an application of Proposition 2.1.20 involving maximal
functions.
Exercises
2.1.1. A positive Borel measure Œº on Rn is called inner regular if for any open
subset U of Rn we have Œº(U) = sup{Œº(K) : K ‚´ÖU, K compact} and Œº is called
locally Ô¨Ånite if Œº(B) < ‚àûfor all balls B.
(a) Let Œº be a positive inner regular locally Ô¨Ånite measure on Rn that satisÔ¨Åes the
following doubling condition: There exists a constant D(Œº) > 0 such that for all
x ‚ààRn and r > 0 we have
Œº(3B(x,r)) ‚â§D(Œº)Œº(B(x,r)).
For f ‚ààL1
loc(Rn,Œº) deÔ¨Åne the uncentered maximal function MŒº( f) with respect to
Œº by
MŒº( f)(x) = sup
r>0
sup
z: |z‚àíx|<r
Œº(B(z,r))Ã∏=0
1
Œº(B(z,r))

B(z,r) f(y)dŒº(y).
Show that MŒº maps L1(Rn,Œº) to L1,‚àû(Rn,Œº) with constant at most D(Œº) and
Lp(Rn,Œº) to itself with constant at most 2

p
p‚àí1
 1
p D(Œº)
1
p .
(b) Obtain as a consequence a differentiation theorem analogous to Corollary 2.1.16.

Hint: Part (a): For f ‚ààL1(Rn,Œº) show that the set EŒ± = {MŒº( f) > Œ±} is open.
Then use the argument of the proof of Theorem 2.1.6 and the inner regularity of Œº.

2.1.2. On R consider the maximal function MŒº of Exercise 2.1.1.
(a) (W. H. Young) Prove the following covering lemma. Given a Ô¨Ånite set F of open
intervals in R, prove that there exist two subfamilies each consisting of pairwise dis-
joint intervals such that the union of the intervals in the original family is equal to the
union of the intervals of both subfamilies. Use this result to show that the maximal
function MŒº of Exercise 2.1.1 maps L1(Œº) ‚ÜíL1,‚àû(Œº) with constant at most 2.

2.1 Maximal Functions
99
(b) ([134]) Prove that for any œÉ-Ô¨Ånite positive measure Œº on R, Œ± > 0, and f ‚àà
L1
loc(R,Œº) we have
1
Œ±

A | f|dŒº ‚àíŒº(A) ‚â§1
Œ±

{| f|>Œ±} | f|dŒº ‚àíŒº({| f| > Œ±}).
Use this result and part (a) to prove that for all Œ± > 0 and all locally integrable f we
have
Œº({| f| > Œ±})+ Œº({MŒº( f) > Œ±}) ‚â§1
Œ±

{| f|>Œ±} | f|dŒº + 1
Œ±

{MŒº( f)>Œ±} | f|dŒº
and note that equality is obtained when Œ± = 1 and f(x) = |x|‚àí1/p.
(c) Conclude that MŒº maps Lp(Œº) to Lp(Œº), 1 < p < ‚àû, with bound at most the
unique positive solution Ap of the equation
(p‚àí1)xp ‚àípxp‚àí1 ‚àí1 = 0.
(d) ([136]) If Œº is the Lebesgue measure show that for 1 < p < ‚àûwe have
M

Lp‚ÜíLp = Ap ,
where Ap is the unique positive solution of the equation in part (c).

Hint: Part (a): Select a subset G of F with minimal cardinality such that 
J‚ààG J =

I‚ààF I. Part (d): One direction follows from part (c). Conversely, M(|x|‚àí1/p)(1) =
p
p‚àí1
Œ≥1/p‚Ä≤+1
Œ≥+1 , where Œ≥ is the unique positive solution of the equation
p
p‚àí1
Œ≥1/p‚Ä≤+1
Œ≥+1
=
Œ≥‚àí1/p. Conclude that M(|x|‚àí1/p)(1) = Ap and that M(|x|‚àí1/p) = Ap|x|‚àí1/p. Since
this function is not in Lp, consider the family fŒµ(x) = |x|‚àí1/p min(|x|‚àíŒµ,|x|Œµ), Œµ > 0,
and show that M( fŒµ)(x) ‚â•(1+Œ≥
1
p‚Ä≤ +Œµ)(1+Œ≥)‚àí1( 1
p‚Ä≤ +Œµ)‚àí1 fŒµ(x) for 0 < Œµ < p‚Ä≤.

2.1.3. DeÔ¨Åne the centered Hardy‚ÄìLittlewood maximal function Mc and the uncen-
tered Hardy‚ÄìLittlewood maximal function Mc using cubes with sides parallel to the
axes instead of balls in Rn. Prove that
1 ‚â§M( f)
M( f) ‚â§2n ,
1
n
n
2
2n
vn
‚â§M( f)
Mc( f) ‚â§2n
vn
,
1
n
n
2
2n
vn
‚â§M( f)
Mc( f) ‚â§2n
vn
,
where vn is the volume of the unit ball in Rn. Conclude that Mc and Mc are weak
type (1,1) and they map Lp(Rn) to Lp(Rn) for 1 < p ‚â§‚àû.
2.1.4. (a) Prove the estimate:
|{x ‚ààRn : M( f)(x) > 2Œ±}| ‚â§3n
Œ±

{| f|>Œ±} | f(y)|dy
and conclude that M maps Lp to Lp,‚àûwith norm at most 2¬∑3n/p for 1 ‚â§p < ‚àû.

100
2 Maximal Functions, Fourier Transform, and Distributions
(b) Deduce that if f log+(2| f|) is integrable over a ball B, then M( f) is integrable
over the same ball B.
(c) ([375], [336]) Apply Proposition 2.1.20 to | f| and Œ± > 0 and Exercise 2.1.3 to
show that with cn = 2n(nn/2vn)‚àí1 we have
|{x ‚ààRn : M( f)(x) > cn Œ±}| ‚â•2‚àín
Œ±

{| f|>Œ±} | f(y)|dy.
(d) Suppose that f is integrable and supported in a ball B(0,œÅ). Show that for x in
B(0,2œÅ)\B(0,œÅ) we have M( f)(x) ‚â§M( f)(œÅ2|x|‚àí2x). Conclude that

B(0,2œÅ) M( f)dx ‚â§(4n +1)

B(0,œÅ) M( f)dx
and from this deduce a similar inequality for M( f).
(e) Suppose that f is integrable and supported in a ball B and that M( f) is integrable
over B. Let Œª0 = 2n|B|‚àí1‚à•f‚à•L1. Use part (b) to prove that f log+(Œª ‚àí1
0 cn | f|) is inte-
grable over B.

Hint: Part (a): Write f = f œá| f|>Œ± + f œá| f|‚â§Œ±. Part (b): Show that M( f œáE) is inte-
grable over B, where E = {| f| ‚â•1/2}. Part (c): Use Proposition 2.1.20. Part (d): Let
x‚Ä≤ = œÅ2|x|‚àí2x for some œÅ < |x| < 2œÅ. Show that for R > |x|‚àíœÅ, we have that

B(x,R) | f(z)|dz ‚â§

B(x‚Ä≤,R) | f(z)|dz
by showing that B(x,R)‚à©B(0,œÅ) ‚äÇB(x‚Ä≤,R). Part (e): For x /‚àà2B we have M( f)(x) ‚â§
Œª0, hence

2B M( f)(x)dx ‚â•
 ‚àû
Œª0 |{x ‚àà2B : M( f)(x) > Œ±}|dŒ±.

2.1.5. (A. Kolmogorov) Let S be a sublinear operator that maps L1(Rn) to L1,‚àû(Rn)
with norm B. Suppose that f ‚ààL1(Rn). Prove that for any set A of Ô¨Ånite Lebesgue
measure and for all 0 < q < 1 we have

A |S( f)(x)|q dx ‚â§(1‚àíq)‚àí1Bq|A|1‚àíq f
q
L1,
and in particular, for the Hardy‚ÄìLittlewood maximal operator,

A M( f)(x)q dx ‚â§(1‚àíq)‚àí13nq|A|1‚àíqf
q
L1 .

Hint: Use the identity

A |S( f)(x)|q dx =
 ‚àû
0 qŒ±q‚àí1|{x‚ààA : S( f)(x)>Œ±}|dŒ±
and estimate the last measure by min(|A|, B
Œ± ‚à•f‚à•L1).


2.1 Maximal Functions
101
2.1.6. Let Ms( f)(x) be the supremum of the averages of | f| over all rectangles with
sides parallel to the axes containing x. The operator Ms is called the strong maximal
function.
(a) Prove that Ms maps Lp(Rn) to itself.
(b) Show that the operator norm of Ms is An
p, where Ap is as in Exercise 2.1.2 (c).
(c) Prove that Ms is not weak type (1,1).
2.1.7. Prove that if
|œï(x1,...,xn)| ‚â§A(1+|x1|)‚àí1‚àíŒµ ¬∑¬∑¬∑(1+|xn|)‚àí1‚àíŒµ
for some A,Œµ > 0, and œït1,...,tn(x) = t‚àí1
1
¬∑¬∑¬∑t‚àí1
n œï(t‚àí1
1 x1,...,t‚àí1
n xn), then the maximal
operator
f ‚Üí
sup
t1,...,tn>0
| f ‚àóœït1,...,tn|
is pointwise controlled by the strong maximal function.
2.1.8. Prove that for any Ô¨Åxed 1 < p < ‚àû, the operator norm of M on Lp(Rn) tends
to inÔ¨Ånity as n ‚Üí‚àû.

Hint: Let f0 be the characteristic function of the unit ball in Rn. Consider the aver-
ages |Bx|‚àí1 
Bx f0 dy, where Bx = B
 1
2(|x|‚àí|x|‚àí1) x
|x|, 1
2(|x|+|x|‚àí1)

for |x| > 1.

2.1.9. (a) In R2 let M0( f)(x) be the maximal function obtained by taking the supre-
mum of the averages of | f| over all rectangles (of arbitrary orientation) containing
x. Prove that M0 is not bounded on Lp(Rn) for p ‚â§2 and conclude that M0 is not
weak type (1,1).
(b) Let M00( f)(x) be the maximal function obtained by taking the supremum of the
averages of | f| over all rectangles in R2 of arbitrary orientation but Ô¨Åxed eccentricity
containing x. (The eccentricity of a rectangle is the ratio of its longer side to its
shorter side.) Using a covering lemma, show that M00 is weak type (1,1) with a
bound proportional to the square of the eccentricity.
(c) On Rn deÔ¨Åne a maximal function by taking the supremum of the averages
of | f| over all products of intervals I1 √ó ¬∑¬∑¬∑ √ó In containing a point x with |I2| =
a2|I1|,...,|In| = an|I1| and a2,...,an > 0 Ô¨Åxed. Show that this maximal function is
of weak type (1,1) with bound independent of the numbers a2,...,an.

Hint: Part (b): Let b be the eccentricity. If two rectangles with the same eccentricity
intersect, then the smaller one is contained in the bigger one scaled 4b times. Then
use an argument similar to that in Lemma 2.1.5.

2.1.10. (a) Let 0 < p,q < ‚àûand let X,Y be measure spaces. Suppose that TŒµ are
maps from Lp(X) to Lq,‚àû(Y) satisfy |TŒµ( f +g)| ‚â§K(|TŒµ( f)|+|TŒµ(g)|) for all Œµ > 0
and all f,g ‚ààLp(X), and also limŒµ‚Üí0 TŒµ( f) = 0 a.e. for all f in some dense subspace
D of Lp(X). Assume furthermore that the maximal operator T‚àó( f) = supŒµ>0 |TŒµ( f)|
maps Lp(X) to Lq,‚àû(Y). Prove that limŒµ‚Üí0 TŒµ( f) = 0 a.e. for all f in Lp(X).
(b) Use the result in part (a) to prove the following version of the Lebesgue differ-
entiation theorem: Let f ‚ààLp(Rn) for some 0 < p < ‚àû. Then for almost all x ‚ààRn
we have

102
2 Maximal Functions, Fourier Transform, and Distributions
lim
|B|‚Üí0
B‚àãx
1
|B|

B |g(y)‚àíg(x)|p dy = 0,
where the limit is taken over all open balls B containing x and shrinking to {x}.
(c) Conclude that for any f in L1
loc(Rn) and for almost all x ‚ààRn we have
lim
|B|‚Üí0
B‚àãx
1
|B|

B f(y)dy = f(x),
where the limit is taken over all open balls B containing x and shrinking to {x}.

Hint: (a) DeÔ¨Åne an oscillation Of (y) = limsupŒµ‚Üí0 |TŒµ( f)(y)|. For all f in Lp(X)
and g ‚ààD we have that Of (y) ‚â§KOf‚àíg(y). Then use the argument in the proof of
Theorem 2.1.14. (b) Apply part (a) with
TŒµ( f)(x) =
sup
B(z,Œµ)‚àãx

1
|B(z,Œµ)|

B(z,Œµ) | f(y)‚àíf(x)|p dy
1/p
,
observing that T‚àó( f) = supŒµ>0 TŒµ( f) ‚â§max(1,2
1‚àíp
p )

| f|+M(| f|p)
1
p 
. (c) Follows
from part (b) with p = 1. Note that part (b) can be proved without part (a) but using
part (c) as follows: for every rational number a there is a set Ea of Lebesgue measure
zero such that for x ‚ààRn \Ea we have limB‚àãx,|B|‚Üí0
1
|B|

B |g(y)‚àía|p dy = |g(x)‚àía|p,
since the function y ‚Üí| f(y)‚àía|p is in L1
loc(Rn). By considering an enumeration of
the rationals, Ô¨Ånd a set of measure zero E such for x /‚ààE the preceding limit exists
for all rationals a and by continuity for all real numbers a, in particular for a = g(x).

2.1.11. Let f be in L1(R). DeÔ¨Åne the right maximal function MR( f) and the left
maximal function ML( f) as follows:
ML( f)(x) = sup
r>0
1
r
 x
x‚àír | f(t)|dt ,
MR( f)(x) = sup
r>0
1
r
 x+r
x
| f(t)|dt .
(a) Show that for all Œ± > 0 and f ‚ààL1(R) we have
|{x ‚ààR : ML( f)(x) > Œ±}| = 1
Œ±

{ML( f)>Œ±} | f(t)|dt ,
|{x ‚ààR : MR( f)(x) > Œ±}| = 1
Œ±

{MR( f)>Œ±} | f(t)|dt .
(b) Extend the deÔ¨Ånition of ML( f) and MR( f) for f ‚ààLp(R) for 1 ‚â§p ‚â§‚àû. Show
that ML and MR map Lp to Lp with norm at most p/(p‚àí1) for all p with 1 < p < ‚àû.
(c) Construct examples to show that the operator norms of ML and MR on Lp(R) are
exactly p/(p‚àí1) for 1 < p < ‚àû.

2.1 Maximal Functions
103
(d) Prove that M = max(MR,ML).
(e) Let N = min(MR,ML). Obtain the following consequence of part (a),

R M( f)p +N( f)p dx =
p
p‚àí1

R | f|

M( f)p‚àí1 +N( f)p‚àí1
dx,
(f) Use part (e) to prove that
(p‚àí1)
M( f)
p
Lp ‚àíp
f

Lp
M( f)
p‚àí1
Lp
‚àí
f
p
Lp ‚â§0.

Hint: (a) Write the set EŒ± = {MR( f) > Œ±} as a union of open intervals (aj,bj).
For each x in (aj,bj), let Nx =
	
s ‚ààR :
 s
x | f| > Œ±(s‚àíx)

‚à©(x,bj]. Show that Nx is
nonempty and that supNx = bj for every x ‚àà(aj,bj). Conclude that
 b j
a j | f(t)|dt ‚â•
Œ±(bj ‚àíaj), which implies that each aj is Ô¨Ånite. For the reverse inequality use that
aj /‚ààEŒ±. Part (d) is due to K. L. Phillips. (e) First obtain a version of the equality
with MR in the place of M and ML in the place of N. Then use that M( f)q +N( f)q =
ML( f)q +MR( f)q for all q. (f) Use that | f|N( f)p‚àí1 ‚â§1
p| f|p + 1
p‚Ä≤ N( f)p. This alter-
native proof of the result in Exercise 2.1.2(c) was suggested by J. Duoandikoetxea.

2.1.12. A cube Q = [a12k,(a1 + 1)2k) √ó ¬∑¬∑¬∑ √ó [an2k,(an + 1)2k) on Rn is called
dyadic if k, a1,...,an ‚ààZ. Observe that either two dyadic cubes are disjoint or one
contains the other. DeÔ¨Åne the dyadic maximal function
Md( f)(x) = sup
Q‚àãx
1
|Q|

Q f(y)dy,
where the supremum is taken over all dyadic cubes Q containing x.
(a) Prove that Md maps L1 to L1,‚àûwith constant at most one. Presicely, show that for
all Œ± > 0 and f ‚ààL1(Rn) we have
|{x ‚ààRn : Md( f)(x) > Œ±}| ‚â§1
Œ±

{Md( f)>Œ±} f(t)dt .
(b) Conclude that Md maps Lp(Rn) to itself with constant at most p/(p‚àí1).
2.1.13. Observe that the proof of Theorem 2.1.6 yields the estimate
Œª|{M( f) > Œª}|
1
p ‚â§3n|{M( f) > Œª}|‚àí1+ 1
p

{M( f)>Œª} | f(y)|dy
for Œª > 0 and f locally integrable. Use the result of Exercise 1.1.12(a) to prove that
the Hardy‚ÄìLittlewood maximal operator M maps the space Lp,‚àû(Rn) to itself for
1 < p < ‚àû.

104
2 Maximal Functions, Fourier Transform, and Distributions
2.1.14. Let K(x) = (1+|x|)‚àín‚àíŒ¥ be deÔ¨Åned on Rn. Prove that there exists a constant
Cn,Œ¥ such that for all Œµ0 > 0 we have the estimate
sup
Œµ>Œµ0
(| f|‚àóKŒµ)(x) ‚â§Cn,Œ¥ sup
Œµ>Œµ0
1
Œµn

|y‚àíx|‚â§Œµ | f(y)|dy,
for all f locally integrable on Rn.

Hint: Apply only a minor modiÔ¨Åcation to the proof of Theorem 2.1.10.

2.2 The Schwartz Class and the Fourier Transform
In this section we introduce the single most important tool in harmonic analysis, the
Fourier transform. It is often the case that the Fourier transform is introduced as an
operation on L1 functions. In this exposition we Ô¨Årst deÔ¨Åne the Fourier transform
on a smaller class, the space of Schwartz functions, which turns out to be a very
natural environment. Once the basic properties of the Fourier transform are derived,
we extend its deÔ¨Ånition to other spaces of functions.
We begin with some preliminaries. Given x = (x1,...,xn) ‚ààRn, we set |x| =
(x2
1 + ¬∑¬∑¬∑ + x2
n)1/2. The partial derivative of a function f on Rn with respect to the
jth variable xj is denoted by ‚àÇj f while the mth partial derivative with respect to
the jth variable is denoted by ‚àÇm
j f. The gradient of a function f is the vector ‚àáf =
(‚àÇ1 f,...,‚àÇn f). A multi-index Œ± is an ordered n-tuple of nonnegative integers. For
a multi-index Œ± = (Œ±1,...,Œ±n), ‚àÇŒ± f denotes the derivative ‚àÇŒ±1
1 ¬∑¬∑¬∑‚àÇŒ±n
n f. If Œ± =
(Œ±1,...,Œ±n) is a multi-index, |Œ±| = Œ±1+¬∑¬∑¬∑+Œ±n denotes its size and Œ±! = Œ±1!¬∑¬∑¬∑Œ±n!
denotes the product of the factorials of its entries. The number |Œ±| indicates the total
order of differentiation of ‚àÇŒ± f. The space of functions in Rn all of whose derivatives
of order at most N ‚ààZ+ are continuous is denoted by C N(Rn) and the space of all
inÔ¨Ånitely differentiable functions on Rn by C ‚àû(Rn). The space of C ‚àûfunctions with
compact support on Rn is denoted by C ‚àû
0 (Rn). This space is nonempty; see Exercise
2.2.1(a).
For x ‚ààRn and Œ± = (Œ±1,...,Œ±n) a multi-index, we set xŒ± = xŒ±1
1 ¬∑¬∑¬∑xŒ±n
n . Multi-
indices will be denoted by the letters Œ±,Œ≤,Œ≥,Œ¥,.... It is a simple fact to verify that
|xŒ±| ‚â§cn,Œ±|x||Œ±| ,
(2.2.1)
for some constant that depends on the dimension n and on Œ±. In fact, cn,Œ± is
the maximum of the continuous function (x1,...,xn) ‚Üí|xŒ±1
1 ¬∑¬∑¬∑xŒ±n
n | on the sphere
Sn‚àí1 = {x ‚ààRn : |x| = 1}. The converse inequality in (2.2.1) fails. However, the
following substitute of the converse of (2.2.1) is of great use: for k ‚ààZ+ we have
|x|k ‚â§Cn,k ‚àë
|Œ≤|=k
|xŒ≤|
(2.2.2)
for all x ‚ààRn \{0}. To prove (2.2.2), take 1/Cn,k to be the minimum of the function
x ‚Üí‚àë
|Œ≤|=k
|xŒ≤|

2.2 The Schwartz Class and the Fourier Transform
105
on Sn‚àí1; this minimum is positive since this function has no zeros on Sn‚àí1. A related
inequality is
(1+|x|)k ‚â§2k(1+Cn,k) ‚àë
|Œ≤|‚â§k
|xŒ≤|.
(2.2.3)
This follows from (2.2.2) for |x| ‚â•1, while for |x| < 1 we note that the sum in (2.2.3)
is at least one since |x(0,...,0)| = 1.
We end the preliminaries by noting the validity of the one-dimensional Leibniz
rule
dm
dtm ( fg) =
m
‚àë
k=0
m
k
dk f
dtk
dm‚àíkg
dtm‚àík ,
(2.2.4)
for all C m functions f,g on R, and its multidimensional analogue
‚àÇŒ±( fg) = ‚àë
Œ≤‚â§Œ±
Œ±1
Œ≤1

¬∑¬∑¬∑
Œ±n
Œ≤n

(‚àÇŒ≤ f)(‚àÇŒ±‚àíŒ≤g),
(2.2.5)
for f,g in C |Œ±|(Rn) for some multi-index Œ±, where the notation Œ≤ ‚â§Œ± in (2.2.5)
means that Œ≤ ranges over all multi-indices satisfying 0 ‚â§Œ≤ j ‚â§Œ±j for all 1 ‚â§j ‚â§n.
We observe that identity (2.2.5) is easily deduced by repeated application of (2.2.4),
which in turn is obtained by induction.
2.2.1 The Class of Schwartz Functions
We now introduce the class of Schwartz functions on Rn. Roughly speaking, a func-
tion is Schwartz if it is smooth and all of its derivatives decay faster than the recip-
rocal of any polynomial at inÔ¨Ånity. More precisely, we give the following deÔ¨Ånition.
DeÔ¨Ånition 2.2.1. A C ‚àûcomplex-valued function f on Rn is called a Schwartz func-
tion if for every pair of multi-indices Œ± and Œ≤ there exists a positive constant CŒ±,Œ≤
such that
œÅŒ±,Œ≤( f) = sup
x‚ààRn |xŒ±‚àÇŒ≤ f(x)| = CŒ±,Œ≤ < ‚àû.
(2.2.6)
The quantities œÅŒ±,Œ≤( f) are called the Schwartz seminorms of f. The set of all
Schwartz functions on Rn is denoted by S (Rn).
Example 2.2.2. The function e‚àí|x|2 is in S (Rn) but e‚àí|x| is not, since it fails to be
differentiable at the origin. The C ‚àûfunction g(x) = (1+|x|4)‚àía, a > 0, is not in S
since it decays only like the reciprocal of a Ô¨Åxed polynomial at inÔ¨Ånity. The set of
all smooth functions with compact support, C ‚àû
0 (Rn), is contained in S (Rn).
Remark 2.2.3. If f1 is in S (Rn) and f2 is in S (Rm), then the function of m + n
variables f1(x1,...,xn) f2(xn+1,...,xn+m) is in S (Rn+m). If f is in S (Rn) and P(x)
is a polynomial of n variables, then P(x) f(x) is also in S (Rn). If Œ± is a multi-index
and f is in S (Rn), then ‚àÇŒ± f is in S (Rn). Also note that

106
2 Maximal Functions, Fourier Transform, and Distributions
f ‚ààS (Rn) ‚áê‚áísup
x‚ààRn |‚àÇŒ±(xŒ≤ f(x))| < ‚àû
for all multi-indices Œ±, Œ≤.
Remark 2.2.4. The following alternative characterization of Schwartz functions is
very useful. A C ‚àûfunction f is in S (Rn) if and only if for all positive integers N
and all multi-indices Œ± there exists a positive constant CŒ±,N such that
|(‚àÇŒ± f)(x)| ‚â§CŒ±,N(1+|x|)‚àíN.
(2.2.7)
The simple proofs are omitted. We now discuss convergence in S (Rn).
DeÔ¨Ånition 2.2.5. Let fk, f be in S (Rn) for k = 1,2,.... We say that the sequence
fk converges to f in S (Rn) if for all multi-indices Œ± and Œ≤ we have
œÅŒ±,Œ≤( fk ‚àíf) = sup
x‚ààRn |xŒ±(‚àÇŒ≤( fk ‚àíf))(x)| ‚Üí0
as
k ‚Üí‚àû.
For instance, for any Ô¨Åxed x0 ‚ààRn, f(x + x0/k) ‚Üíf(x) in S (Rn) for any f in
S (Rn) as k ‚Üí‚àû.
This notion of convergence is compatible with a topology on S (Rn) under which
the operations ( f,g) ‚Üíf + g, (a, f) ‚Üíaf, and f ‚Üí‚àÇŒ± f are continuous for all
complex scalars a and multi-indices Œ± ( f,g ‚ààS (Rn)). A subbasis for open sets
containing 0 in this topology is
{f ‚ààS : œÅŒ±,Œ≤( f) < r},
for all Œ±, Œ≤ multi-indices and all r ‚ààQ+. Observe the following: If œÅŒ±,Œ≤( f) = 0, then
f = 0. This means that S (Rn) is a locally convex topological vector space equipped
with the family of seminorms œÅŒ±,Œ≤ that separate points. We refer to Reed and Simon
[286] for the pertinent deÔ¨Ånitions. Since the origin in S (Rn) has a countable base,
this space is metrizable. In fact, the following is a metric on S (Rn):
d( f,g) =
‚àû
‚àë
j=1
2‚àíj
œÅ j( f ‚àíg)
1+œÅ j( f ‚àíg) ,
where œÅ j is an enumeration of all the seminorms œÅŒ±,Œ≤, Œ± and Œ≤ multi-indices. One
may easily verify that S is complete with respect to the metric d. Indeed, a Cauchy
sequence {hj}j in S would have to be Cauchy in L‚àûand therefore it would con-
verge uniformly to some function h. The same is true for the sequences {‚àÇŒ≤hj}j
and {xŒ±hj(x)}j, and the limits of these sequences can be shown to be the functions
‚àÇŒ≤h and xŒ±h(x), respectively. It follows that the sequence {hj} converges to h in S .
Therefore, S (Rn) is a Fr¬¥echet space (complete metrizable locally convex space).
We note that convergence in S is stronger than convergence in all Lp. We have
the following.
Proposition 2.2.6. Let f, fk, k = 1,2,3,..., be in S (Rn). If fk ‚Üíf in S then
fk ‚Üíf in Lp for all 0 < p ‚â§‚àû. Moreover, there exists a Cp,n > 0 such that

2.2 The Schwartz Class and the Fourier Transform
107
‚àÇŒ≤ f

Lp ‚â§Cp,n
‚àë
|Œ±|‚â§[ n+1
p ]+1
œÅŒ±,Œ≤( f)
(2.2.8)
for all f for which the right-hand side is Ô¨Ånite.
Proof. Observe that when p < ‚àûwe have
‚àÇŒ≤ f

Lp ‚â§

|x|‚â§1 |‚àÇŒ≤ f(x)|p dx+

|x|‚â•1 |x|n+1|‚àÇŒ≤ f(x)|p|x|‚àí(n+1) dx
1/p
‚â§

vn
‚àÇŒ≤ f
p
L‚àû+

sup
|x|‚â•1
|x|n+1|‚àÇŒ≤ f(x)|p

|x|‚â•1 |x|‚àí(n+1) dx
1/p
‚â§Cp,n
‚àÇŒ≤ f

L‚àû+ sup
|x|‚â•1
(|x|[ n+1
p ]+1|‚àÇŒ≤ f(x)|)

.
The preceding inequality is also trivially valid when p = ‚àû. Now set m =
 n+1
p

+1
and use (2.2.2) to obtain
sup
|x|‚â•1
|x|m|‚àÇŒ≤ f(x)| ‚â§sup
|x|‚â•1
Cn,m ‚àë
|Œ±|=m
|xŒ±‚àÇŒ≤ f(x)| ‚â§Cn,m ‚àë
|Œ±|‚â§m
œÅŒ±,Œ≤( f).
Conclusion (2.2.8) now follows immediately. This shows that convergence in S
implies convergence in Lp.
‚ñ°
We now show that the Schwartz class is closed under certain operations.
Proposition 2.2.7. Let f, g be in S (Rn). Then fg and f ‚àóg are in S (Rn). More-
over,
‚àÇŒ±( f ‚àóg) = (‚àÇŒ± f)‚àóg = f ‚àó(‚àÇŒ±g)
(2.2.9)
for all multi-indices Œ±.
Proof. Fix f and g in S (Rn). Let ej be the unit vector (0,...,1,...,0) with 1 in the
jth entry and zeros in all the other entries. Since
f(y+hej)‚àíf(y)
h
‚àí(‚àÇj f)(y) ‚Üí0
(2.2.10)
as h ‚Üí0, and since the expression in (2.2.10) is pointwise bounded by some constant
depending on f, the integral of the expression in (2.2.10) with respect to the measure
g(x ‚àíy)dy converges to zero as h ‚Üí0 by the Lebesgue dominated convergence
theorem. This proves (2.2.9) when Œ± = (0,...,1,...,0). The general case follows by
repeating the previous argument and using induction.
We now show that the convolution of two functions in S is also in S . For each
N > 0 there is a constant CN such that


Rn f(x‚àíy)g(y)dy
 ‚â§CN

Rn(1+|x‚àíy|)‚àíN(1+|y|)‚àíN‚àín‚àí1dy.
(2.2.11)

108
2 Maximal Functions, Fourier Transform, and Distributions
Inserting the simple estimate
(1+|x‚àíy|)‚àíN ‚â§(1+|y|)N(1+|x|)‚àíN
in (2.2.11) we obtain that
|( f ‚àóg)(x)| ‚â§CN(1+|x|)‚àíN

Rn(1+|y|)‚àín‚àí1dy = C‚Ä≤
N (1+|x|)‚àíN .
This shows that f ‚àóg decays like (1+|x|)‚àíN at inÔ¨Ånity, but since N > 0 is arbitrary
it follows that f ‚àóg decays faster than the reciprocal of any polynomial.
Since ‚àÇŒ±( f ‚àóg) = (‚àÇŒ± f) ‚àóg, replacing f by ‚àÇŒ± f in the previous argument, we
also conclude that all the derivatives of f ‚àóg decay faster than the reciprocal of any
polynomial at inÔ¨Ånity. Using (2.2.7), we conclude that f ‚àóg is in S . Finally, the fact
that fg is in S follows directly from Leibniz‚Äôs rule (2.2.5) and (2.2.7).
‚ñ°
2.2.2 The Fourier Transform of a Schwartz Function
The Fourier transform is often introduced as an operation on L1. In that setting,
problems of convergence arise when certain manipulations of functions are per-
formed. Also, Fourier inversion requires the additional assumption that the Fourier
transform is in L1. Here we initially introduce the Fourier transform on the space
of Schwartz functions. The rapid decay of Schwartz functions at inÔ¨Ånity allows us
to develop its fundamental properties without encountering any convergence prob-
lems. The Fourier transform is a homeomorphism of the Schwartz class and Fourier
inversion holds in it. For these reasons, this class is a natural environment for it.
For x = (x1,...,xn), y = (y1,...,yn) in Rn we use the notation
x¬∑y =
n
‚àë
j=1
xjyj .
DeÔ¨Ånition 2.2.8. Given f in S (Rn) we deÔ¨Åne
1f(Œæ) =

Rn f(x)e‚àí2œÄix¬∑Œæ dx.
We call 1f the Fourier transform of f.
Example 2.2.9. If f(x) = e‚àíœÄ|x|2 deÔ¨Åned on Rn, then 1f(Œæ) = f(Œæ). To prove this,
observe that the function
s ‚Üí
 +‚àû
‚àí‚àûe‚àíœÄ(t+is)2dt,
s ‚ààR,

2.2 The Schwartz Class and the Fourier Transform
109
deÔ¨Åned on the line is constant (and thus equal to
 +‚àû
‚àí‚àûe‚àíœÄt2dt), since its derivative is
 +‚àû
‚àí‚àû‚àí2œÄi(t +is)e‚àíœÄ(t+is)2dt =
 +‚àû
‚àí‚àûi d
dt (e‚àíœÄ(t+is)2)dt = 0.
Using this fact, we calculate the Fourier transform of the function t ‚Üíe‚àíœÄt2 on R
by completing the squares as follows:

R e‚àíœÄt2e‚àí2œÄitœÑdt =

R e‚àíœÄ(t+iœÑ)2eœÄ(iœÑ)2dt =
 +‚àû
‚àí‚àûe‚àíœÄt2dt

e‚àíœÄœÑ2 = e‚àíœÄœÑ2,
where œÑ ‚ààR, and we used that
 +‚àû
‚àí‚àûe‚àít2dt = ‚àöœÄ ,
(2.2.12)
a fact that can be found in Appendix A.1.
Remark 2.2.10. It follows from the deÔ¨Ånition of the Fourier transform that if f is in
S (Rn) and g is in S (Rm), then
[ f(x1,...,xn)g(xn+1,...,xn+m)]1= 1f(Œæ1,...,Œæn)1g(Œæn+1,...,Œæn+m),
where the Ô¨Årst 1 denotes the Fourier transform on Rn+m. In other words, the Fourier
transform preserves separation of variables. Combining this observation with the
result in Example 2.2.9, we conclude that the function f(x) = e‚àíœÄ|x|2 deÔ¨Åned on Rn
is equal to its Fourier transform.
We now continue with some properties of the Fourier transform. Before we do
this we introduce some notation. For a measurable function f on Rn, x ‚ààRn, and
a > 0 we deÔ¨Åne the translation, dilation, and reÔ¨Çection of f by
(œÑy f)(x) = f(x‚àíy)
(Œ¥ a f)(x) = f(ax)
#f(x) = f(‚àíx).
(2.2.13)
Also recall the notation fa = a‚àínŒ¥ 1/a( f) introduced in DeÔ¨Ånition 2.1.9.
Proposition 2.2.11. Given f, g in S (Rn), y ‚ààRn, b ‚ààC, Œ± a multi-index, and t > 0,
we have
(1)
 1f

L‚àû‚â§
f

L1,
(2)

f +g = 1f + 1g,
(3)
2
bf = b 1f,

110
2 Maximal Functions, Fourier Transform, and Distributions
(4)
1#f = #1f ,
(5)
1f = #1f ,
(6)
3
œÑy f(Œæ) = e‚àí2œÄiy¬∑Œæ 1f(Œæ),
(7)
(e2œÄix¬∑y f(x))1(Œæ) = œÑy( 1f )(Œæ),
(8)
(Œ¥t f)1= t‚àínŒ¥t‚àí1 1f = ( 1f )t ,
(9)
(‚àÇŒ± f)1(Œæ) = (2œÄiŒæ)Œ± 1f(Œæ),
(10)
(‚àÇŒ± 1f )(Œæ) = ((‚àí2œÄix)Œ± f(x))1(Œæ),
(11)
1f ‚ààS ,
(12)
3
f ‚àóg = 1f 1g,
(13)
3
f ‚ó¶A(Œæ) = 1f(AŒæ), where A is an orthogonal matrix and Œæ is a column vector.
Proof. Property (1) follows directly from DeÔ¨Ånition 2.2.8. Properties (2)‚Äì(5) are
trivial. Properties (6)‚Äì(8) require a suitable change of variables but they are omitted.
Property (9) is proved by integration by parts (which is justiÔ¨Åed by the rapid decay
of the integrands):
(‚àÇŒ± f)1(Œæ) =

Rn(‚àÇŒ± f)(x)e‚àí2œÄix¬∑Œæ dx
= (‚àí1)|Œ±|

Rn f(x)(‚àí2œÄiŒæ)Œ±e‚àí2œÄix¬∑Œæ dx
= (2œÄiŒæ)Œ± 1f(Œæ).
To prove (10), let Œ± = ej = (0,...,1,...,0), where all entries are zero except for
the jth entry, which is 1. Since
e‚àí2œÄix¬∑(Œæ+he j) ‚àíe‚àí2œÄix¬∑Œæ
h
‚àí(‚àí2œÄixj)e‚àí2œÄix¬∑Œæ ‚Üí0
(2.2.14)
as h ‚Üí0 and the preceding function is bounded by C|x| for all h and Œæ, the Lebesgue
dominated convergence theorem implies that the integral of the function in (2.2.14)
with respect to the measure f(x)dx converges to zero. This proves (10) for Œ± = ej.
For other Œ±‚Äôs use induction. To prove (11) we use (9), (10), and (1) in the following
way:
xŒ±(‚àÇŒ≤ 1f )(x)

L‚àû= (2œÄ)|Œ≤|
(2œÄ)|Œ±|
(‚àÇŒ±(xŒ≤ f(x)))1

L‚àû‚â§(2œÄ)|Œ≤|
(2œÄ)|Œ±|
‚àÇŒ±(xŒ≤ f(x))

L1 < ‚àû.

2.2 The Schwartz Class and the Fourier Transform
111
Identity (12) follows from the following calculation:
3
f ‚àóg(Œæ) =

Rn

Rn f(x‚àíy)g(y)e‚àí2œÄix¬∑Œæ dydx
=

Rn

Rn f(x‚àíy)g(y)e‚àí2œÄi(x‚àíy)¬∑Œæe‚àí2œÄiy¬∑Œæ dydx
=

Rn g(y)

Rn f(x‚àíy)e‚àí2œÄi(x‚àíy)¬∑Œædx e‚àí2œÄiy¬∑Œæ dy
= 1f(Œæ)1g(Œæ),
where the application of Fubini‚Äôs theorem is justiÔ¨Åed by the absolute convergence
of the integrals. Finally, we prove (13). We have
3
f ‚ó¶A(Œæ) =

Rn f(Ax)e‚àí2œÄix¬∑Œæ dx
=

Rn f(y)e‚àí2œÄiA‚àí1y¬∑Œæ dy
=

Rn f(y)e‚àí2œÄiAty¬∑Œæ dy
=

Rn f(y)e‚àí2œÄiy¬∑AŒæ dy
= 1f(AŒæ),
where we used the change of variables y = Ax and the fact that |detA| = 1.
‚ñ°
Corollary 2.2.12. The Fourier transform of a radial function is radial. Products and
convolutions of radial functions are radial.
Proof. Let Œæ1, Œæ2 in Rn with |Œæ1| = |Œæ2|. Then for some orthogonal matrix A we have
AŒæ1 = Œæ2. Since f is radial, we have f = f ‚ó¶A. Then
1f(Œæ2) = 1f(AŒæ1) = 3
f ‚ó¶A(Œæ1) = 1f(Œæ1),
where we used (13) in Proposition 2.2.11 to justify the second equality. Products and
convolutions of radial functions are easily seen to be radial.
‚ñ°
2.2.3 The Inverse Fourier Transform and Fourier Inversion
We now deÔ¨Åne the inverse Fourier transform.
DeÔ¨Ånition 2.2.13. Given a Schwartz function f, we deÔ¨Åne
f ‚à®(x) = 1f(‚àíx),

112
2 Maximal Functions, Fourier Transform, and Distributions
for all x ‚ààRn. The operation
f ‚Üíf ‚à®
is called the inverse Fourier transform.
It is straightforward that the inverse Fourier transform shares the same properties
as the Fourier transform. One may want to list (and prove) properties for the inverse
Fourier transform analogous to those in Proposition 2.2.11.
We now investigate the relation between the Fourier transform and the inverse
Fourier transform. In the next theorem, we prove that one is the inverse operation of
the other. This property is referred to as Fourier inversion.
Theorem 2.2.14. Given f, g, and h in S (Rn), we have
(1)

Rn f(x)1g(x)dx =

Rn
1f(x)g(x)dx,
(2) (Fourier Inversion)
( 1f )‚à®= f = ( f ‚à®)‚àß,
(3) (Parseval‚Äôs relation)

Rn f(x)h(x)dx =

Rn
1f(Œæ)1h(Œæ)dŒæ ,
(4) (Plancherel‚Äôs identity)
f

L2 =
 1f

L2 =
 f ‚à®
L2 ,
(5)

Rn f(x)h(x)dx =

Rn
1f(x)h‚à®(x)dx.
Proof. (1) follows immediately from the deÔ¨Ånition of the Fourier transform and
Fubini‚Äôs theorem. To prove (2) we use (1) with
g(Œæ) = e2œÄiŒæ¬∑te‚àíœÄ|ŒµŒæ|2 .
By Proposition 2.2.11 (7) and (8) and Example 2.2.9, we have that
1g(x) = 1
Œµn e‚àíœÄ|(x‚àít)/Œµ|2,
which is an approximate identity. Now (1) gives

Rn f(x)Œµ‚àíne‚àíœÄŒµ‚àí2|x‚àít|2 dx =

Rn
1f(Œæ)e2œÄiŒæ¬∑te‚àíœÄ|ŒµŒæ|2 dŒæ .
(2.2.15)
Now let Œµ ‚Üí0 in (2.2.15). The left-hand side of (2.2.15) converges to f(t) uniformly
on compact sets by Theorem 1.2.19. The right-hand side of (2.2.15) converges to
( 1f )‚à®(t) as Œµ ‚Üí0 by the Lebesgue dominated convergence theorem. We conclude
that ( 1f )‚à®= f on Rn. Replacing f by #f and using the result just proved, we conclude
that ( f ‚à®)‚àß= f.
Note that if g = 1h, then Proposition 2.2.11 (5) and identity (2) imply that 1g = h.
Then (3) follows from (1) by expressing h in terms of g. Identity (4) is a trivial

2.2 The Schwartz Class and the Fourier Transform
113
consequence of (3). (Sometimes the polarized identity (3) is also referred to as
Plancherel‚Äôs identity.) Finally, (5) easily follows from (1) and (2) with 1g = h.
‚ñ°
Next we have the following simple corollary of Theorem 2.2.14.
Corollary 2.2.15. The Fourier transform is a homeomorphism from S (Rn) onto
itself.
Proof. The continuity of the Fourier transform (and its inverse) follows from Exer-
cise 2.2.2, while Fourier inversion yields that this map is bijective.
‚ñ°
2.2.4 The Fourier Transform on L1 +L2
We have deÔ¨Åned the Fourier transform on S (Rn). We now extend this deÔ¨Ånition to
the space L1(Rn)+L2(Rn).
We begin by observing that the Fourier transform given in DeÔ¨Ånition 2.2.8,
1f(Œæ) =

Rn f(x)e‚àí2œÄix¬∑Œæ dx,
makes sense as a convergent integral for functions f ‚ààL1(Rn). This allows us to
extend the deÔ¨Ånition of the Fourier transform on L1. Moreover, this operator satisÔ¨Åes
properties (1)‚Äì(8) as well as (12) and (13) in Proposition 2.2.11, with f,g integrable.
We also deÔ¨Åne the inverse Fourier transform on L1 by setting f ‚à®(x) = 1f(‚àíx) for
f ‚ààL1(Rn) and we note that analogous properties hold for it. One problem in this
generality is that when f is integrable, one may not necessarily have ( 1f )‚à®= f a.e.
This inversion is possible when 1f is also integrable; see Exercise 2.2.6.
The integral deÔ¨Åning the Fourier transform does not converge absolutely for func-
tions in L2(Rn); however, the Fourier transform has a natural deÔ¨Ånition in this space
accompanied by an elegant theory. In view of the result in Exercise 2.2.8, the Fourier
transform is an L2 isometry on L1 ‚à©L2, which is a dense subspace of L2. By density,
there is a unique bounded extension of the Fourier transform on L2. Let us denote
this extension by F. Then F is also an isometry on L2, i.e.,
F( f)

L2 =
f

L2
for all f ‚ààL2(Rn), and any sequence of functions fN ‚ààL1(Rn)‚à©L2(Rn) converging
to a given f in L2(Rn) satisÔ¨Åes
2
fN ‚àíF( f)

L2 ‚Üí0,
(2.2.16)
as N ‚Üí‚àû. In particular, the sequence of functions fN(x) = f(x)œá|x|‚â§N yields that
2
fN(Œæ) =

|x|‚â§N f(x)e‚àí2œÄix¬∑Œæ dx
(2.2.17)

114
2 Maximal Functions, Fourier Transform, and Distributions
converges to F( f)(Œæ) in L2 as N ‚Üí‚àû. If f is both integrable and square inte-
grable, the expressions in (2.2.17) also converge to 1f(Œæ) pointwise. Also, in view of
Theorem 1.1.11 and (2.2.16), there is a subsequence of 2
fN that converges to F( f)
pointwise a.e. Consequently, for f in L1(Rn)‚à©L2(Rn) the expressions 1f and F( f)
coincide pointwise a.e. For this reason we often adopt the notation 1f to denote the
Fourier transform of functions f in L2 as well.
In a similar fashion, we let F ‚Ä≤ be the isometry on L2(Rn) that extends the op-
erator f ‚Üíf ‚à®, which is an L2 isometry on L1 ‚à©L2; the last statement follows
by adapting the result of Exercise 2.2.8 to the inverse Fourier transform. Since
œï‚à®(x) = 1œï(‚àíx) for œï in the Schwartz class, which is dense in L2 (Exercise 2.2.5),
it follows that F ‚Ä≤( f)(x) = F( f)(‚àíx) for all f ‚ààL2 and almost all x ‚ààRn. The
operators F and F ‚Ä≤ are L2-isometries that satisfy F ‚Ä≤ ‚ó¶F = F ‚ó¶F ‚Ä≤ = Id on the
Schwartz space. By density this identity also holds for L2 functions and implies that
F and F ‚Ä≤ are injective and surjective mappings from L2 to itself; consequently, F ‚Ä≤
coincides with the inverse operator F ‚àí1 of F : L2 ‚ÜíL2, and Fourier inversion
f = F ‚àí1 ‚ó¶F( f) = F ‚ó¶F ‚àí1( f)
a.e.
holds on L2.
Having set down the basic facts concerning the action of the Fourier transform
on L1 and L2, we extend its deÔ¨Ånition on Lp for 1 < p < 2. Given a function f in
Lp(Rn), with 1 < p < 2, we deÔ¨Åne 1f = 1f1 + 1f2, where f1 ‚ààL1(Rn), f2 ‚ààL2(Rn),
and f = f1 + f2; we may take, for instance, f1 = f œá| f|>1 and f2 = f œá| f|‚â§1. The
deÔ¨Ånition of 1f is independent of the choice of f1 and f2, for if f1 + f2 = h1 +h2 for
f1,h1 ‚ààL1(Rn) and f2,h2 ‚ààL2(Rn), we have f1 ‚àíh1 = h2 ‚àíf2 ‚ààL1(Rn)‚à©L2(Rn).
Since these functions are equal on L1(Rn) ‚à©L2(Rn), their Fourier transforms are
also equal, and we obtain 1f1 ‚àí1h1 = 1h2 ‚àí1f2, which yields 
f1 + f2 = 
h1 +h2. We
have the following result concerning the action of the Fourier transform on Lp.
Proposition 2.2.16. (Hausdorff‚ÄìYoung inequality) For every function f in Lp(Rn)
we have the estimate
 1f

Lp‚Ä≤ ‚â§
f

Lp
whenever 1 ‚â§p ‚â§2.
Proof. This follows easily from Theorem 1.3.4. Interpolate between the estimates
‚à•1f ‚à•L‚àû‚â§‚à•f‚à•L1 (Proposition 2.2.11 (1)) and ‚à•1f ‚à•L2 ‚â§‚à•f‚à•L2 to obtain ‚à•1f ‚à•Lp‚Ä≤ ‚â§
‚à•f‚à•Lp. We conclude that the Fourier transform is a bounded operator from Lp(Rn)
to Lp‚Ä≤(Rn) with norm at most 1 when 1 ‚â§p ‚â§2.
‚ñ°
Next, we are concerned with the behavior of the Fourier transform at inÔ¨Ånity.
Proposition 2.2.17. (Riemann‚ÄìLebesgue lemma) For a function f in L1(Rn) we
have that
| 1f(Œæ)| ‚Üí0
as
|Œæ| ‚Üí‚àû.

2.2 The Schwartz Class and the Fourier Transform
115
Proof. Consider the function œá[a,b] on R. A simple computation gives
3
œá[a,b](Œæ) =
 b
a e‚àí2œÄixŒæ dx = e‚àí2œÄiŒæa ‚àíe‚àí2œÄiŒæb
2œÄiŒæ
,
which tends to zero as |Œæ| ‚Üí‚àû. Likewise, if g = ‚àèn
j=1 œá[a j,b j] on Rn, then
1g(Œæ) =
n
‚àè
j=1
e‚àí2œÄiŒæ ja j ‚àíe‚àí2œÄiŒæ jb j
2œÄiŒæ j
.
Given a Œæ = (Œæ1,...,Œæn) Ã∏= 0, there is j0 such that |Œæ j0| > |Œæ|/‚àön. Then

n
‚àè
j=1
e‚àí2œÄiŒæ ja j ‚àíe‚àí2œÄiŒæ jb j
2œÄiŒæ j
 ‚â§2‚àön
2œÄ|Œæ|
sup
1‚â§j0‚â§n ‚àè
jÃ∏= j0
(bj ‚àíaj)
which also tends to zero as |Œæ| ‚Üí‚àûin Rn.
Given a general integrable function f on Rn and Œµ > 0, there is a simple function
h, which is a Ô¨Ånite linear combination of characteristic functions of rectangles (like
g), such that ‚à•f ‚àíh‚à•L1 < Œµ
2. Then there is an M is such that for |Œæ| > M we have
|1h(Œæ)| < Œµ
2. It follows that
| 1f(Œæ)| ‚â§| 1f(Œæ)‚àí1h(Œæ)|+|1h(Œæ)| ‚â§
f ‚àíh

L1 +|1h(Œæ)| < Œµ
2 + Œµ
2 ,
provided |Œæ| > M. This implies that | 1f(Œæ)| ‚Üí0 as |Œæ| ‚Üí‚àû.
A different proof can be given by taking the function h in the preceding paragraph
to be a Schwartz function and using that Schwartz functions are dense in L1(Rn);
see Exercise 2.2.5 about the last assertion.
‚ñ°
We end this section with an example that illustrates some of the practical uses of
the Fourier transform.
Example 2.2.18. We would like to Ô¨Ånd a Schwartz function f(x1,x2,x3) on R3 that
satisÔ¨Åes the partial differential equation
f(x)+‚àÇ2
1 ‚àÇ2
2 ‚àÇ4
3 f(x)+4i‚àÇ2
1 f(x)+‚àÇ7
2 f(x) = e‚àíœÄ|x|2.
Taking the Fourier transform on both sides of this identity and using Proposition
2.2.11 (2), (9) and the result of Example 2.2.9, we obtain
1f(Œæ)
/
1+(2œÄiŒæ1)2(2œÄiŒæ2)2(2œÄiŒæ3)4 +4i(2œÄiŒæ1)2 +(2œÄiŒæ2)7 0
= e‚àíœÄ|Œæ|2 .
Let p(Œæ) = p(Œæ1,Œæ2,Œæ3) be the polynomial inside the square brackets. We observe
that p(Œæ) has no real zeros and we may therefore write
1f(Œæ) = e‚àíœÄ|Œæ|2 p(Œæ)‚àí1 =‚áíf(x) =

e‚àíœÄ|Œæ|2 p(Œæ)‚àí1‚à®(x).

116
2 Maximal Functions, Fourier Transform, and Distributions
In general, let
P(Œæ) = ‚àë
|Œ±|‚â§N
CŒ±Œæ Œ±
be a polynomial in Rn with constant complex coefÔ¨Åcients CŒ± indexed by multi-
indices Œ±. If P(2œÄiŒæ) has no real zeros, and u is in S (Rn), then the partial differ-
ential equation
P(‚àÇ) f = ‚àë
|Œ±|‚â§N
CŒ±‚àÇŒ± f = u
is solved as before to give
f =

1u(Œæ)P(2œÄiŒæ)‚àí1‚à®.
Since P(2œÄiŒæ) has no real zeros and u ‚ààS (Rn), the function
1u(Œæ)P(2œÄiŒæ)‚àí1
is smooth and therefore a Schwartz function. Then f is also in S (Rn) by Proposition
2.2.11 (11).
Exercises
2.2.1. (a) Construct a Schwartz function supported in the unit ball of Rn.
(b) Construct a C ‚àû
0 (Rn) function equal to 1 on the annulus 1 ‚â§|x| ‚â§2 and vanishing
off the annulus 1/2 ‚â§|x| ‚â§4.
(c) Construct a nonnegative nonzero Schwartz function f on Rn whose Fourier
transform is nonnegative and compactly supported.

Hint: Part (a): Try the construction in dimension one Ô¨Årst using the C ‚àûfunction
Œ∑(x) = e‚àí1/x for x > 0 and Œ∑(x) = 0 for x < 0. Part (c): Take f = |œÜ ‚àó#œÜ|2, where 1œÜ
is odd, real-valued, and compactly supported; here #œÜ(x) = œÜ(‚àíx).

2.2.2. If fk, f ‚ààS (Rn) and fk ‚Üíf in S (Rn), then 1fk ‚Üí1f and f ‚à®
k ‚Üíf ‚à®in S (Rn).
2.2.3. Find the spectrum (i.e., the set of all eigenvalues of the Fourier transform),
that is, all complex numbers Œª for which there exist nonzero functions f such that
1f = Œª f .

Hint: Apply the Fourier transform three times to the preceding identity. Consider
the functions xe‚àíœÄx2, (a + bx2)e‚àíœÄx2, and (cx + dx3)e‚àíœÄx2 for suitable a,b,c,d to
show that all fourth roots of unity are indeed eigenvalues of the Fourier transform.

2.2.4. Use the idea of the proof of Proposition 2.2.7 to show that if the functions f,
g deÔ¨Åned on Rn satisfy | f(x)| ‚â§A(1 + |x|)‚àíM and |g(x)| ‚â§B(1 + |x|)‚àíN for some
M,N > n, then

2.2 The Schwartz Class and the Fourier Transform
117
|( f ‚àóg)(x)| ‚â§ABC(1+|x|)‚àíL ,
where L = min(N,M) and C = C(N,M) > 0.
2.2.5. Show that C ‚àû
0 (Rn) is dense on Lp(Rn) for 0 < p < ‚àûbut not for p = ‚àû.

Hint: Use a smooth approximate identity when p ‚â•1. Reduce the case p < 1 to
p = 1.

2.2.6. (a) Prove that if f ‚ààL1, then 1f is uniformly continuous on Rn.
(b) Prove that for f,g ‚ààL1(Rn) we have

Rn f(x)1g(x)dx =

Rn
1f(y)g(y)dy.
(c) Take 1g(x) = Œµ‚àíne‚àíœÄŒµ‚àí2|x‚àít|2 in (b) and let Œµ ‚Üí0 to prove that if f and 1f are both
in L1, then ( 1f )‚à®= f a.e. This fact is called Fourier inversion on L1.
2.2.7. (a) Prove that if a function f in L1(Rn)‚à©L‚àû(Rn) is continuous at 0, then
lim
Œµ‚Üí0

Rn
1f(x)e‚àíœÄ|Œµx|2dx = f(0).
(b) Let f ‚ààL1(Rn) ‚à©L‚àû(Rn) be continuous at zero and satisfy 1f ‚â•0. Show that 1f
is in L1 and conclude that Fourier inversion holds at zero f(0) = ‚à•1f ‚à•L1, and also
f = ( 1f )‚à®a.e. in general.

Hint: Part (a): Let g(x) = e‚àíœÄ|Œµx|2 in Exercise 2.2.6(b) and use Theorem 1.2.19 (2).

2.2.8. Given f in L1(Rn)‚à©L2(Rn), without appealing to density, prove that
 1f

L2 =
 f

L2 .

Hint: Let h = f ‚àó#f , where #f(x) = f(‚àíx) and the bar indicates complex conjuga-
tion. Then h ‚ààL1(Rn)‚à©L‚àû(Rn), 1h = | 1f|2 ‚â•0, and h is continuous at zero. Exercise
2.2.7(b) yields ‚à•1f ‚à•2
L2 = ‚à•1h‚à•L1 = h(0) =

Rn f(x) #f(‚àíx)dx = ‚à•f‚à•2
L2.

2.2.9. (a) Prove that for all 0 < Œµ < t < ‚àûwe have

 t
Œµ
sin(Œæ)
Œæ
dŒæ
 ‚â§4.
(b) If f is an odd L1 function on the line, conclude that for all t > Œµ > 0 we have

 t
Œµ
1f(Œæ)
Œæ
dŒæ
 ‚â§4
f

L1 .
(c) Let g(Œæ) be a continuous odd function that is equal to 1/log(Œæ) for Œæ ‚â•2. Show
that there does not exist an L1 function whose Fourier transform is g.

118
2 Maximal Functions, Fourier Transform, and Distributions
2.2.10. Let f be in L1(R). Prove that
 +‚àû
‚àí‚àûf

x‚àí1
x

dx =
 +‚àû
‚àí‚àûf(u)du.

Hint: For x ‚àà(‚àí‚àû,0) use the change of variables u = x‚àí1
x or x = 1
2

u‚àí
‚àö
4+u2 
.
For x ‚àà(0,‚àû) use the change of variables u = x‚àí1
x or x = 1
2

u+
‚àö
4+u2 
.

2.2.11. (a) Use Exercise 2.2.10 with f(x) = e‚àítx2 to obtain the subordination
identity
e‚àí2t =
1
‚àöœÄ
 ‚àû
0 e‚àíy‚àít2/y dy
‚àöy ,
where t > 0.
(b) Set t = œÄ|x| and integrate with respect to e‚àí2œÄiŒæ¬∑xdx to prove that
(e‚àí2œÄ|x|)1(Œæ) = Œì ( n+1
2 )
œÄ
n+1
2
1
(1+|Œæ|2)
n+1
2
.
This calculation gives the Fourier transform of the Poisson kernel.
2.2.12. Let 1 ‚â§p ‚â§‚àûand let p‚Ä≤ be its dual index.
(a) Prove that Schwartz functions f on the line satisfy the estimate
f
2
L‚àû‚â§2
 f

Lp
 f ‚Ä≤
Lp‚Ä≤ .
(b) Prove that all Schwartz functions f on Rn satisfy the estimate
f
2
L‚àû‚â§
‚àë
|Œ±+Œ≤|=n
‚àÇŒ± f

Lp
‚àÇŒ≤ f

Lp‚Ä≤ ,
where the sum is taken over all pairs of multi-indices Œ± and Œ≤ whose sum has size n.

Hint: Part (a): Write f(x)2 =
 x
‚àí‚àû
d
dt f(t)2 dt.

2.2.13. The uncertainty principle says that the position and the momentum of a
particle cannot be simultaneously localized. Prove the following inequality, which
presents a quantitative version of this principle:
f
2
L2(Rn) ‚â§4œÄ
n
inf
y‚ààRn

Rn |x‚àíy|2| f(x)|2 dx
1
2
inf
z‚ààRn

Rn |Œæ ‚àíz|2| 1f(Œæ)|2 dŒæ
1
2
,
where f is a Schwartz function on Rn (or an L2 function with sufÔ¨Åcient decay at
inÔ¨Ånity).

Hint: Let y be in Rn. Start with
f
2
L2 = 1
n

Rn f(x) f(x)
n
‚àë
j=1
‚àÇ
‚àÇxj
(xj ‚àíyj)dx,

2.3 The Class of Tempered Distributions
119
integrate by parts, apply the Cauchy‚ÄìSchwarz inequality, Plancherel‚Äôs identity, and
the identity ‚àën
j=1 |3
‚àÇj f(Œæ)|2 = 4œÄ2|Œæ|2| 1f(Œæ)|2 for all Œæ ‚ààRn. Then replace f(x) by
f(x)e2œÄix¬∑z.

2.2.14. Let ‚àí‚àû< Œ± < n
2 < Œ≤ < +‚àû. Prove the validity of the following inequality:
g

L1(Rn) ‚â§C
|x|Œ±g(x)

Œ≤‚àín/2
Œ≤‚àíŒ±
L2(Rn)
|x|Œ≤g(x)

n/2‚àíŒ±
Œ≤‚àíŒ±
L2(Rn)
for some constant C = C(n,Œ±,Œ≤) independent of g.

Hint: First prove ‚à•g‚à•L1 ‚â§C‚à•|x|Œ±g(x)‚à•L2 + ‚à•|x|Œ≤g(x)‚à•L2 and then replace g(x) by
g(Œªx) for some suitable Œª > 0.

2.3 The Class of Tempered Distributions
The fundamental idea of the theory of distributions is that it is generally easier to
work with linear functionals acting on spaces of ‚Äúnice‚Äù functions than to work with
‚Äúbad‚Äù functions directly. The set of ‚Äúnice‚Äù functions we consider is closed under
the basic operations in analysis, and these operations are extended to distributions
by duality. This wonderful interpretation has proved to be an indispensable tool that
has clariÔ¨Åed many situations in analysis.
2.3.1 Spaces of Test Functions
We recall the space C ‚àû
0 (Rn) of all smooth functions with compact support, and
C ‚àû(Rn) of all smooth functions on Rn. We are mainly interested in the three spaces
of ‚Äúnice‚Äù functions on Rn that are nested as follows:
C ‚àû
0 (Rn) ‚äÜS (Rn) ‚äÜC ‚àû(Rn).
Here S (Rn) is the space of Schwartz functions introduced in Section 2.2.
DeÔ¨Ånition 2.3.1. We deÔ¨Åne convergence of sequences in these spaces. We say that
fk ‚Üíf in C ‚àû
‚áê‚áí
fk, f ‚ààC ‚àûand lim
k‚Üí‚àûsup
|x|‚â§N
|‚àÇŒ±( fk ‚àíf)(x)| = 0
‚àÄŒ± multi-indices and all N = 1,2,....
fk ‚Üíf in S
‚áê‚áí
fk, f ‚ààS and lim
k‚Üí‚àûsup
x‚ààRn |xŒ±‚àÇŒ≤( fk ‚àíf)(x)| = 0
‚àÄŒ±,Œ≤ multi-indices.
fk ‚Üíf in C ‚àû
0
‚áê‚áí
fk, f ‚ààC ‚àû
0 , support( fk) ‚äÜB for all k, B compact,
and lim
k‚Üí‚àû
‚àÇŒ±( fk ‚àíf)

L‚àû= 0 ‚àÄŒ± multi-indices.

120
2 Maximal Functions, Fourier Transform, and Distributions
It follows that convergence in C ‚àû
0 (Rn) implies convergence in S (Rn), which in
turn implies convergence in C ‚àû(Rn).
Example 2.3.2. Let œï be a nonzero C ‚àû
0
function on R. We call such functions
smooth bumps. DeÔ¨Åne the sequence of smooth bumps œïk(x) = œï(x ‚àík)/k. Then
œïk(x) does not converge to zero in C ‚àû
0 (R), even though œïk (and all of its deriva-
tives) converge to zero uniformly. Furthermore, we see that œïk does not converge to
any function in S (R). Clearly œïk ‚Üí0 in C ‚àû(R).
The space C ‚àû(Rn) is equipped with the family of seminorms
#œÅŒ±,N( f) = sup
|x|‚â§N
|(‚àÇŒ± f)(x)|,
(2.3.1)
where Œ± ranges over all multi-indices and N ranges over Z+. It can be shown that
C ‚àû(Rn) is complete with respect to this countable family of seminorms, i.e., it is a
Fr¬¥echet space. However, it is true that C ‚àû
0 (Rn) is not complete with respect to the
topology generated by this family of seminorms.
The topology of C ‚àû
0 given in DeÔ¨Ånition 2.3.1 is the inductive limit topology, and
under this topology it is complete. Indeed, letting C ‚àû
0 (B(0,k)) be the space of all
smooth functions with support in B(0,k), then C ‚àû
0 (Rn) is equal to ‚àû
k=1 C ‚àû
0 (B(0,k))
and each space C ‚àû
0 (B(0,k)) is complete with respect to the topology generated by
the family of seminorms #œÅŒ±,N; hence so is C ‚àû
0 (Rn). Nevertheless, C ‚àû
0 (Rn) is not
metrizable. Details on the topologies of these spaces can be found in [286].
2.3.2 Spaces of Functionals on Test Functions
The dual spaces (i.e., the spaces of continuous linear functionals on the sets of test
functions) we introduced is denoted by
(C ‚àû
0 (Rn))‚Ä≤ = D‚Ä≤(Rn),
(S (Rn))‚Ä≤ = S ‚Ä≤(Rn),
(C ‚àû(Rn))‚Ä≤ = E ‚Ä≤(Rn).
By deÔ¨Ånition of the topologies on the dual spaces, we have
Tk ‚ÜíT
in D‚Ä≤
‚áê‚áí
Tk,T ‚ààD‚Ä≤ and Tk( f) ‚ÜíT( f) for all f ‚ààC ‚àû
0 .
Tk ‚ÜíT
in S ‚Ä≤
‚áê‚áí
Tk,T ‚ààS ‚Ä≤ and Tk( f) ‚ÜíT( f) for all f ‚ààS .
Tk ‚ÜíT
in E ‚Ä≤
‚áê‚áí
Tk,T ‚ààE ‚Ä≤ and Tk( f) ‚ÜíT( f) for all f ‚ààC ‚àû.
The dual spaces are nested as follows:
E ‚Ä≤(Rn) ‚äÜS ‚Ä≤(Rn) ‚äÜD‚Ä≤(Rn).

2.3 The Class of Tempered Distributions
121
DeÔ¨Ånition 2.3.3. Elements of the space D‚Ä≤(Rn) are called distributions. Elements of
S ‚Ä≤(Rn) are called tempered distributions. Elements of the space E ‚Ä≤(Rn) are called
distributions with compact support.
Before we discuss some examples, we give alternative characterizations of distri-
butions, which are very useful from the practical point of view. The action of a
distribution u on a test function f is represented in either one of the following two
ways:
4
u, f
5
= u( f).
Proposition 2.3.4. (a) A linear functional u on C ‚àû
0 (Rn) is a distribution if and only
if for every compact K ‚äÜRn, there exist C > 0 and an integer m such that
4
u, f
5 ‚â§C ‚àë
|Œ±|‚â§m
‚àÇŒ± f

L‚àû,
for all f ‚ààC ‚àûwith support in K.
(2.3.2)
(b) A linear functional u on S (Rn) is a tempered distribution if and only if there
exist C > 0 and k, m integers such that
4
u, f
5 ‚â§C ‚àë
|Œ±|‚â§m
|Œ≤|‚â§k
œÅŒ±,Œ≤( f),
for all f ‚ààS (Rn).
(2.3.3)
(c) A linear functional u on C ‚àû(Rn) is a distribution with compact support if and
only if there exist C > 0 and N, m integers such that
4
u, f
5 ‚â§C ‚àë
|Œ±|‚â§m
#œÅŒ±,N( f),
for all f ‚ààC ‚àû(Rn).
(2.3.4)
The seminorms œÅŒ±,Œ≤ and #œÅŒ±,N are deÔ¨Åned in (2.2.6) and (2.3.1), respectively.
Proof. We prove only (2.3.3), since the proofs of (2.3.2) and (2.3.4) are similar. It is
clear that (2.3.3) implies continuity of u. Conversely, it was pointed out in Section
2.2 that the family of sets {f ‚ààS (Rn) : œÅŒ±,Œ≤( f) < Œ¥}, where Œ±, Œ≤ are multi-
indices and Œ¥ > 0, forms a subbasis for the topology of S . Thus if u is a continuous
functional on S , there exist integers k, m and a Œ¥ > 0 such that
|Œ±| ‚â§m, |Œ≤| ‚â§k,
and œÅŒ±,Œ≤( f) < Œ¥ =‚áí
4
u, f
5 ‚â§1.
(2.3.5)
We see that (2.3.3) follows from (2.3.5) with C = 1/Œ¥.
‚ñ°
Examples 2.3.5. We now discuss some important examples.
1. The Dirac mass at the origin Œ¥0. This is deÔ¨Åned for œï ‚ààC ‚àû(Rn) by
4
Œ¥0,œï
5
= œï(0).

122
2 Maximal Functions, Fourier Transform, and Distributions
We claim that Œ¥0 is in E ‚Ä≤. To see this we observe that if œïk ‚Üíœï in C ‚àûthen
4
Œ¥0,œïk
5
‚Üí
4
Œ¥0,œï
5
. The Dirac mass at a point a ‚ààRn is deÔ¨Åned similarly by
4
Œ¥a,œï
5
= œï(a).
2. Some functions g can be thought of as distributions via the identiÔ¨Åcation g ‚ÜíLg,
where Lg is the functional
Lg(œï) =

Rn œï(x)g(x)dx.
Here are some examples: The function 1 is in S ‚Ä≤ but not in E ‚Ä≤. Compactly sup-
ported integrable functions are in E ‚Ä≤. The function e|x|2 is in D‚Ä≤ but not in S ‚Ä≤.
3. Functions in L1
loc are distributions. To see this, Ô¨Årst observe that if g ‚ààL1
loc, then
the integral
Lg(œï) =

Rn œï(x)g(x)dx
is well deÔ¨Åned for all œï ‚ààD and satisÔ¨Åes |Lg(œï)| ‚â§

K |g(x)|dx

‚à•œï‚à•L‚àûfor all
smooth functions œï supported in the compact set K.
4. Functions in Lp, 1 ‚â§p ‚â§‚àû, are tempered distributions, but may not in E ‚Ä≤ unless
they have compact support.
5. Any Ô¨Ånite Borel measure Œº is a tempered distribution via the identiÔ¨Åcation
LŒº(œï) =

Rn œï(x)dŒº(x).
To see this, observe that œïk ‚Üíœï in S implies that LŒº(œïk) ‚ÜíLŒº(œï). Finite Borel
measures may not be distributions with compact support.
6. Every function g that satisÔ¨Åes |g(x)| ‚â§C(1 + |x|)k, for some real number k, is a
tempered distribution. To see this, observe that
Lg(œï)
 ‚â§sup
x‚ààRn(1+|x|)m|œï(x)|

Rn(1+|x|)k‚àímdx,
where m > n+k and the expression supx‚ààRn(1+|x|)m|œï(x)| is bounded by a Ô¨Ånite
sum of Schwartz seminorms œÅŒ±,Œ≤(œï).
7. The function log|x| is a tempered distribution; indeed for any œï ‚ààS (Rn), the
integral of œï(x)log|x| is bounded by a Ô¨Ånite number of Schwartz seminorms of
œï. More generally, any function that is integrable on a ball |x| ‚â§M and for some
C > 0 satisÔ¨Åes |g(x)| ‚â§C(1+|x|)k for |x| ‚â•M, is a tempered distribution.
8. Here is an example of a compactly supported distribution on R that is neither a
locally integrable function nor a Ô¨Ånite Borel measure:
4
u,œï
5
= lim
Œµ‚Üí0

Œµ‚â§|x|‚â§1
œï(x)dx
x = lim
Œµ‚Üí0

Œµ‚â§|x|‚â§1
(œï(x)‚àíœï(0))dx
x .
We have that |‚ü®u,œï‚ü©| ‚â§2‚à•œï‚Ä≤‚à•L‚àû([‚àí1,1]) and notice that ‚à•œï‚Ä≤‚à•L‚àû([‚àí1,1]) is a #œÅŒ±,N
seminorm of œï.

2.3 The Class of Tempered Distributions
123
2.3.3 The Space of Tempered Distributions
Having set down the basic deÔ¨Ånitions of distributions, we now focus our study on the
space of tempered distributions. These distributions are the most useful in harmonic
analysis. The main reason for this is that the subject is concerned with boundedness
of translation-invariant operators, and every such bounded operator from Lp(Rn) to
Lq(Rn) is given by convolution with a tempered distribution. This fact is shown in
Section 2.5.
Suppose that f and g are Schwartz functions and Œ± a multi-index. Integrating by
parts |Œ±| times, we obtain

Rn(‚àÇŒ± f)(x)g(x)dx = (‚àí1)|Œ±|

Rn f(x)(‚àÇŒ±g)(x)dx.
(2.3.6)
If we wanted to deÔ¨Åne the derivative of a tempered distribution u, we would have to
give a deÔ¨Ånition that extends the deÔ¨Ånition of the derivative of the function and that
satisÔ¨Åes (2.3.6) for g in S ‚Ä≤ and f ‚ààS if the integrals in (2.3.6) are interpreted as
actions of distributions on functions. We simply use equation (2.3.6) to deÔ¨Åne the
derivative of a distribution.
DeÔ¨Ånition 2.3.6. Let u ‚ààS ‚Ä≤ and Œ± a multi-index. DeÔ¨Åne
4
‚àÇŒ±u, f
5
= (‚àí1)|Œ±|4
u,‚àÇŒ± f
5
.
(2.3.7)
If u is a function, the derivatives of u in the sense of distributions are called distri-
butional derivatives.
In view of Theorem 2.2.14, it is natural to give the following:
DeÔ¨Ånition 2.3.7. Let u ‚ààS ‚Ä≤. We deÔ¨Åne the Fourier transform 1u and the inverse
Fourier transform u‚à®of a tempered distribution u by
4
1u, f
5
=
4
u, 1f
5
and
4
u‚à®, f
5
=
4
u, f ‚à®5
,
(2.3.8)
for all f in S .
Example 2.3.8. We observe that 1Œ¥0 = 1. More generally, for any multi-index Œ± we
have
(‚àÇŒ±Œ¥0)‚àß= (2œÄix)Œ±.
To see this, observe that for all f ‚ààS we have
4
(‚àÇŒ±Œ¥0)‚àß, f
5
=
4
‚àÇŒ±Œ¥0 , 1f
5
= (‚àí1)|Œ±|4
Œ¥0 , ‚àÇŒ± 1f
5
= (‚àí1)|Œ±|4
Œ¥0 , ((‚àí2œÄix)Œ± f(x))‚àß5
= (‚àí1)|Œ±|((‚àí2œÄix)Œ± f(x))‚àß(0)

124
2 Maximal Functions, Fourier Transform, and Distributions
= (‚àí1)|Œ±|

Rn(‚àí2œÄix)Œ± f(x)dx
=

Rn(2œÄix)Œ± f(x)dx.
This calculation indicates that (‚àÇŒ±Œ¥0)‚àßcan be identiÔ¨Åed with the function (2œÄix)Œ±.
Example 2.3.9. Recall that for x0 ‚ààRn, Œ¥x0( f) =
4
Œ¥x0, f
5
= f(x0). Then
42
Œ¥x0,h
5
=
4
Œ¥x0,1h
5
= 1h(x0) =

Rn h(x)e‚àí2œÄix¬∑x0 dx,
h ‚ààS (Rn),
that is, 2
Œ¥x0 can be identiÔ¨Åed with the function x ‚Üíe‚àí2œÄix¬∑x0. In particular, 1Œ¥0 = 1.
Example 2.3.10. The function e|x|2 is not in S ‚Ä≤(Rn) and therefore its Fourier trans-
form is not deÔ¨Åned as a distribution. However, the Fourier transform of any locally
integrable function with polynomial growth at inÔ¨Ånity is deÔ¨Åned as a tempered dis-
tribution.
Now observe that the following are true whenever f, g are in S .

Rn g(x) f(x‚àít)dx =

Rn g(x+t) f(x)dx,

Rn g(ax) f(x)dx =

Rn g(x)a‚àín f(a‚àí1x)dx,

Rn #g(x) f(x)dx =

Rn g(x) #f(x)dx,
(2.3.9)
for all t ‚ààRn and a > 0. Recall now the deÔ¨Ånitions of œÑt, Œ¥ a, and # given in (2.2.13).
Motivated by (2.3.9), we give the following:
DeÔ¨Ånition 2.3.11. The translation œÑtu, the dilation Œ¥ au, and the reÔ¨Çection #u of a
tempered distribution u are deÔ¨Åned as follows:
4
œÑtu, f
5
=
4
u,œÑ‚àít f
5
,
(2.3.10)
4
Œ¥ au, f
5
=
4
u,a‚àínŒ¥ 1/a f
5
,
(2.3.11)
4
#u, f
5
=
4
u, #f
5
,
(2.3.12)
for all t ‚ààRn and a > 0. Let A be an invertible matrix. The composition of a distri-
bution u with an invertible matrix A is the distribution
4
uA,œï
5
= |det A|‚àí14
u,œïA‚àí15
,
(2.3.13)
where œïA‚àí1(x) = œï(A‚àí1x).

2.3 The Class of Tempered Distributions
125
It is easy to see that the operations of translation, dilation, reÔ¨Çection, and differ-
entiation are continuous on tempered distributions.
Example 2.3.12. The Dirac mass at the origin Œ¥0 is equal to its reÔ¨Çection, while
Œ¥ aŒ¥0 = a‚àínŒ¥0. Also, œÑxŒ¥0 = Œ¥x for any x ‚ààRn.
Now observe that for f, g, and h in S we have

Rn(h‚àóg)(x) f(x)dx =

Rn g(x)(#h‚àóf)(x)dx.
(2.3.14)
Motivated by (2.3.14), we deÔ¨Åne the convolution of a function with a tempered dis-
tribution as follows:
DeÔ¨Ånition 2.3.13. Let u ‚ààS ‚Ä≤ and h ‚ààS . DeÔ¨Åne the convolution h‚àóu by
4
h‚àóu, f
5
=
4
u,#h‚àóf
5
,
f ‚ààS .
(2.3.15)
Example 2.3.14. Let u = Œ¥x0 and f ‚ààS . Then f ‚àóŒ¥x0 is the function x ‚Üíf(x‚àíx0),
for when h ‚ààS , we have
4
f ‚àóŒ¥x0,h
5
=
4
Œ¥x0, #f ‚àóh
5
= ( #f ‚àóh)(x0) =

Rn f(x‚àíx0)h(x)dx.
It follows that convolution with Œ¥0 is the identity operator.
We now deÔ¨Åne the product of a function and a distribution.
DeÔ¨Ånition 2.3.15. Let u ‚ààS ‚Ä≤ and let h be a C ‚àûfunction that has at most polynomial
growth at inÔ¨Ånity and the same is true for all of its derivatives. This means that for
all Œ± it satisÔ¨Åes |(‚àÇŒ±h)(x)| ‚â§CŒ±(1 + |x|)kŒ± for some CŒ±,kŒ± > 0. Then deÔ¨Åne the
product hu of h and u by
4
hu, f
5
=
4
u,hf
5
,
f ‚ààS .
(2.3.16)
Note that hf is in S and thus (2.3.16) is well deÔ¨Åned. The product of an arbitrary
C ‚àûfunction with a tempered distribution is not deÔ¨Åned.
We observe that if a function g is supported in a set K, then for all f ‚ààC ‚àû
0 (Kc)
we have

Rn f(x)g(x)dx = 0.
(2.3.17)
Moreover, the support of g is the intersection of all closed sets K with the property
(2.3.17) for all f in C ‚àû
0 (Kc). Motivated by the preceding observation we give the
following:
DeÔ¨Ånition 2.3.16. Let u be in D‚Ä≤(Rn). The support of u (suppu) is the intersection
of all closed sets K with the property
œï ‚ààC ‚àû
0 (Rn),
suppœï ‚äÜRn \K =‚áí
4
u,œï
5
= 0.
(2.3.18)

126
2 Maximal Functions, Fourier Transform, and Distributions
Distributions with compact support are exactly those whose support (as deÔ¨Åned
in the previous deÔ¨Ånition) is a compact set. To prove this assertion, we start with a
distribution u with compact support as deÔ¨Åned in DeÔ¨Ånition 2.3.3. Then there exist
C,N,m > 0 such that (2.3.4) holds. For a C ‚àûfunction f whose support is contained
in B(0,N)c, the expression on the right in (2.3.4) vanishes and we must therefore
have ‚ü®u, f‚ü©= 0. This shows that the support of u is contained in B(0,N) hence it is
bounded, and since it is already closed (as an intersection of closed sets), it must be
compact. Conversely, if the support of u as deÔ¨Åned in DeÔ¨Ånition 2.3.16 is a compact
set, then there exists an N > 0 such that suppu is contained in B(0,N). We take a
smooth function Œ∑ that is equal to 1 on B(0,N) and vanishes off B(0,N +1). Then
for h ‚ààC ‚àû
0 the support of h(1‚àíŒ∑) does not meet the support of u, and we must have
4
u,h
5
=
4
u,hŒ∑
5
+
4
u,h(1‚àíŒ∑)
5
=
4
u,hŒ∑
5
.
The distribution u can be thought of as an element of E ‚Ä≤ by deÔ¨Åning for f ‚ààC ‚àû(Rn)
4
u, f
5
=
4
u, fŒ∑
5
.
Taking m to be the integer that corresponds to the compact set K = B(0,N +1)
in (2.3.2), and using that the L‚àûnorm of ‚àÇŒ±( fŒ∑) is controlled by a Ô¨Ånite sum of
seminorms #œÅŒ±,N+1( f) with |Œ±| ‚â§m, we obtain the validity of (2.3.4) for f ‚ààC ‚àû.
Example 2.3.17. The support of the Dirac mass at x0 is the set {x0}.
Along the same lines, we give the following deÔ¨Ånition:
DeÔ¨Ånition 2.3.18. We say that a distribution u in D‚Ä≤(Rn) coincides with the function
h on an open set Œ© if
4
u, f
5
=

Rn f(x)h(x)dx
for all f in C ‚àû
0 (Œ©).
(2.3.19)
When (2.3.19) occurs we often say that u agrees with h away from Œ© c.
This deÔ¨Ånition implies that the support of the distribution u ‚àíh is contained in
the set Œ© c.
Example 2.3.19. The distribution |x|2 +Œ¥a1 +Œ¥a2, where a1, a2 are in Rn, coincides
with the function |x|2 on any open set not containing the points a1 and a2. Also, the
distribution in Example 2.3.5 (8) coincides with the function x‚àí1œá|x|‚â§1 away from
the origin in the real line.
Having ended the streak of deÔ¨Ånitions regarding operations with distributions,
we now discuss properties of convolutions and Fourier transforms.

2.3 The Class of Tempered Distributions
127
Theorem 2.3.20. If u ‚ààS ‚Ä≤ and œï ‚ààS , then œï ‚àóu is a C ‚àûfunction and
(œï ‚àóu)(x) = ‚ü®u,œÑx #œï‚ü©
for all x ‚ààRn. Moreover, for all multi-indices Œ± there exist constants CŒ±,kŒ± > 0
such that
|‚àÇŒ±(œï ‚àóu)(x)| ‚â§CŒ±(1+|x|)kŒ± .
Furthermore, if u has compact support, then œï ‚àóu is a Schwartz function.
Proof. Let œà be in S (Rn). We have
4
œï ‚àóu,œà
5
=
4
u, #œï ‚àóœà
5
= u

Rn #œï(¬∑ ‚àíy)œà(y)dy

= u

Rn(œÑy #œï)(¬∑)œà(y)dy

(2.3.20)
=

Rn
4
u,œÑy #œï
5
œà(y)dy,
where the last step is justiÔ¨Åed by the continuity of u and by the fact that the Riemann
sums of the inner integral in (2.3.20) converge to that integral in the topology of S ,
a fact that will be justiÔ¨Åed later. This calculation identiÔ¨Åes the function œï ‚àóu as
(œï ‚àóu)(x) =
4
u,œÑx #œï
5
.
(2.3.21)
We now show that (œï ‚àóu)(x) is a C ‚àûfunction. Let ej = (0,...,1,...,0) with 1
in the jth entry and zero elsewhere. Then
œÑ‚àíhe j(œï ‚àóu)(x)‚àí(œï ‚àóu)(x)
h
= u
œÑ‚àíhe j(œÑx #œï)‚àíœÑx #œï
h

‚Üí
4
u,œÑx(‚àÇj #œï)
5
by the continuity of u and the fact that

œÑ‚àíhe j(œÑx #œï) ‚àíœÑx #œï

/h tends to ‚àÇjœÑx #œï =
œÑx(‚àÇj #œï) in S as h ‚Üí0; see Exercise 2.3.5 (a). The same calculation for higher-order
derivatives shows that œï ‚àóu ‚ààC ‚àûand that ‚àÇŒ≥(œï ‚àóu) = (‚àÇŒ≥œï)‚àóu for all multi-indices
Œ≥. It follows from (2.3.3) that for some C, m, and k we have
|‚àÇŒ±(œï ‚àóu)(x)| ‚â§C ‚àë
|Œ≥|‚â§m
|Œ≤|‚â§k
sup
y‚ààRn |yŒ≥œÑx(‚àÇŒ±+Œ≤ #œï)(y)|
= C ‚àë
|Œ≥|‚â§m
|Œ≤|‚â§k
sup
y‚ààRn |(x+y)Œ≥(‚àÇŒ±+Œ≤ #œï)(y)|
‚â§Cm ‚àë
|Œ≤|‚â§k
sup
y‚ààRn(1+|x|m +|y|m)|(‚àÇŒ±+Œ≤ #œï)(y)|,
(2.3.22)
and this clearly implies that ‚àÇŒ±(œï ‚àóu) grows at most polynomially at inÔ¨Ånity.

128
2 Maximal Functions, Fourier Transform, and Distributions
We now indicate why œï ‚àóu is Schwartz whenever u has compact support. Apply-
ing estimate (2.3.4) to the function y ‚Üíœï(x‚àíy) yields that
4
u,œï(x‚àí¬∑)
5 = |(œï ‚àóu)(x)| ‚â§C ‚àë
|Œ±|‚â§m
sup
|y|‚â§N
|‚àÇŒ±
y œï(x‚àíy)|
for some constants C,m,N. Since for |x| ‚â•2N we have
|‚àÇŒ±
y œï(x‚àíy)| ‚â§CŒ±,M(1+|x‚àíy|)‚àíM ‚â§CŒ±,M,N(1+|x|)‚àíM,
it follows that œï ‚àóu decays rapidly at inÔ¨Ånity. Since ‚àÇŒ≥(œï ‚àóu) = (‚àÇŒ≥œï)‚àóu, the same
argument yields that all the derivatives of œï ‚àóu decay rapidly at inÔ¨Ånity; hence œï ‚àóu
is a Schwartz function. Incidentally, this argument actually shows that any Schwartz
seminorm of œï ‚àóu is controlled by a Ô¨Ånite sum of Schwartz seminorms of œï.
We now return to the point left open concerning the convergence of the Riemann
sums in (2.3.20) in the topology of S (Rn). For each N = 1,2,..., consider a parti-
tion of [‚àíN,N]n into (2N2)n cubes Qm of side length 1/N and let ym be the center
of each Qm. For multi-indices Œ±,Œ≤, we must show that
DN(x) =
(2N2)n
‚àë
m=1
xŒ±‚àÇŒ≤
x #œï(x‚àíym)œà(ym)|Qm|‚àí

Rn xŒ±‚àÇŒ≤
x #œï(x‚àíy)œà(y)dy
converges to zero in L‚àû(Rn) as N ‚Üí‚àû. We have
xŒ±‚àÇŒ≤
x #œï(x‚àíym)œà(ym)|Qm|‚àí

Qm
xŒ±‚àÇŒ≤
x #œï(x‚àíy)œà(y)dy
=

Qm
xŒ±(y‚àíym)¬∑‚àá

‚àÇŒ≤
x #œï(x‚àí¬∑)œà

(Œæ)dy
for some Œæ = y+Œ∏(ym ‚àíy), where Œ∏ ‚àà[0,1]. Distributing the gradient to both fac-
tors, we see that the last integrand is at most
C|x||Œ±|
‚àön
N
1
(1+|x‚àíŒæ|)M/2
1
(2+|Œæ|)M
for M large (pick M > 2|Œ±|), which in turn is at most
C‚Ä≤ |x||Œ±|
‚àön
N
1
(1+|x|)M/2
1
(2+|Œæ|)M/2 ‚â§C‚Ä≤ |x||Œ±|
‚àön
N
1
(1+|x|)M/2
1
(1+|y|)M/2 ,
since |y| ‚â§|Œæ|+Œ∏|y‚àíym| ‚â§|Œæ|+‚àön/N ‚â§|Œæ|+1 for N ‚â•‚àön. Inserting the estimate
obtained for the integrand in the last displayed integral, we obtain
|DN(x)| ‚â§C‚Ä≤‚Ä≤
N
|x||Œ±|
(1+|x|)M/2

[‚àíN,N]n
dy
(1+|y|)M/2 +

([‚àíN,N]n)c
|xŒ±‚àÇŒ≤
x #œï(x‚àíy)œà(y)|dy.

2.3 The Class of Tempered Distributions
129
But the second integral in the preceding expression is bounded by

([‚àíN,N]n)c
C‚Ä≤‚Ä≤‚Ä≤|x||Œ±|
(1+|x‚àíy|)M
dy
(1+|y|)M ‚â§
C‚Ä≤‚Ä≤‚Ä≤|x||Œ±|
(1+|x|)M/2

([‚àíN,N]n)c
dy
(1+|y|)M/2 .
Using these estimates it is now easy to see that limN‚Üí‚àûsupx‚ààRn |DN(x)| = 0.
‚ñ°
Next we have the following important result regarding distributions with compact
support:
Theorem 2.3.21. If u is in E ‚Ä≤(Rn), then 1u is a real analytic function on Rn. In par-
ticular, 1u is a C ‚àûfunction. Furthermore, 1u and all of its derivatives have polynomial
growth at inÔ¨Ånity. Moreover, 1u has a holomorphic extension on Cn.
Proof. Given a distribution u with compact support and a polynomial p(Œæ), the ac-
tion of u on the C ‚àûfunction Œæ ‚Üíp(Œæ)e‚àí2œÄix¬∑Œæ is a well deÔ¨Åned function of x, which
we denote by u(p(¬∑)e‚àí2œÄix¬∑(¬∑)). Here x is an element of Rn but the same assertion
is valid if x = (x1,...,xn) ‚ààRn is replaced by z = (z1,...,zn) ‚ààCn. In this case we
deÔ¨Åne the dot product of Œæ and z via Œæ ¬∑z = ‚àën
k=1 Œækzk.
It is straightforward to verify that the function of z = (z1,...,zn)
F(z) = u

e‚àí2œÄi(¬∑)¬∑z
deÔ¨Åned on Cn is holomorphic, in fact entire. Indeed, the continuity and linearity of
u and the fact that (e‚àí2œÄiŒæ jh ‚àí1)/h ‚Üí‚àí2œÄiŒæ j in C ‚àû(Rn) as h ‚Üí0, h ‚ààC, imply
that F is holomorphic in every variable and its derivative with respect to z j is the
action of the distribution u to the C ‚àûfunction
Œæ ‚Üí(‚àí2œÄiŒæ j)e‚àí2œÄi‚àën
j=1 Œæ jz j .
By induction it follows that for all multi-indices Œ± we have
‚àÇŒ±1
z1 ¬∑¬∑¬∑‚àÇŒ±n
zn F = u

(‚àí2œÄi(¬∑))Œ±e‚àí2œÄi‚àën
j=1(¬∑)z j
.
Since F is entire, its restriction on Rn, i.e., F(x1,...,xn), where xj = Re z j, is real
analytic. Also, an easy calculation using (2.3.4) and Leibniz‚Äôs rule yield that the
restriction of F on Rn and all of its derivatives have polynomial growth at inÔ¨Ånity.
Now for f in S (Rn) we have
4
1u, f
5
=
4
u, 1f
5
= u

Rn f(x)e‚àí2œÄix¬∑Œæ dx

=

Rn f(x)u(e‚àí2œÄix¬∑(¬∑))dx,
provided we can justify the passage of u inside the integral. The reason for this
is that the Riemann sums of the integral of f(x)e‚àí2œÄix¬∑Œæ over Rn converge to it in
the topology of C ‚àû, and thus the linear functional u can be interchanged with the
integral. We conclude that the tempered distribution 1u can be identiÔ¨Åed with the real
analytic function x ‚ÜíF(x) whose derivatives have polynomial growth at inÔ¨Ånity.

130
2 Maximal Functions, Fourier Transform, and Distributions
To justify the fact concerning the convergence of the Riemann sums, we argue as
in the proof of the previous theorem. For each N = 1,2,..., consider a partition of
[‚àíN,N]n into (2N2)n cubes Qm of side length 1/N and let ym be the center of each
Qm. For a multi-index Œ± let
DN(Œæ) =
(2N2)n
‚àë
m=1
f(ym)(‚àí2œÄiym)Œ±e‚àí2œÄiym¬∑Œæ|Qm|‚àí

Rn f(x)(‚àí2œÄix)Œ±e‚àí2œÄix¬∑Œæ dx.
We must show that for every M > 0, sup|Œæ|‚â§M |DN(Œæ)| converges to zero as N ‚Üí‚àû.
Setting g(x) = f(x)(‚àí2œÄix)Œ±, we write
DN(Œæ) =
(2N2)n
‚àë
m=1

Qm

g(ym)e‚àí2œÄiym¬∑Œæ ‚àíg(x)e‚àí2œÄix¬∑Œæ
dx+

([‚àíN,N]n)c g(x)e‚àí2œÄix¬∑Œæ dx.
Using the mean value theorem, we bound the absolute value of the expression inside
the square brackets by

|‚àág(zm)|+2œÄ|Œæ||g(zm)|
‚àön
N ‚â§CK (1+|Œæ|)
(1+|zm|)K
‚àön
N ,
for some point zm in the cube Qm. Since
(2N2)n
‚àë
m=1

Qm
CK (1+|Œæ|)
(1+|zm|)K dx ‚â§C‚Ä≤
K(1+M) < ‚àû
for |Œæ| ‚â§M, it follows that sup|Œæ|‚â§M |DN(Œæ)| ‚Üí0 as N ‚Üí‚àû.
‚ñ°
Next we give a proposition that extends the properties of the Fourier transform to
tempered distributions.
Proposition 2.3.22. Given u, v in S ‚Ä≤(Rn), f j, f ‚ààS , y ‚ààRn, b a complex scalar,
Œ± a multi-index, and a > 0, we have
(1)
3
u+v = 1u+ 1v,
(2) 1bu = b1u,
(3) If f j ‚Üíf in S , then 1f j ‚Üí1f in S and if uj ‚Üíu in S ‚Ä≤, then 1uj ‚Üí1u in S ‚Ä≤ ,
(4) (#u)1= (1u)#,
(5) (œÑyu)1= e‚àí2œÄiy¬∑Œæ 1u,
(6) (e2œÄix¬∑yu)1= œÑy1u ,
(7) (Œ¥ au)1= (1u)a = a‚àínŒ¥ a‚àí11u ,
(8) (‚àÇŒ±u)1= (2œÄiŒæ)Œ± 1u,
(9) ‚àÇŒ± 1u = ((‚àí2œÄix)Œ±u)1,

2.3 The Class of Tempered Distributions
131
(10) (1u)‚à®= u,
(11) 3
f ‚àóu = 1f 1u,
(12) 2
fu = 1f ‚àó1u,
(13) (Leibniz‚Äôs rule) ‚àÇm
j ( fu) = ‚àëm
k=0
m
k

(‚àÇk
j f)(‚àÇm‚àík
j
u), m ‚ààZ+ ,
(14) (Leibniz‚Äôs rule) ‚àÇŒ±( fu) = ‚àëŒ±1
Œ≥1=0 ¬∑¬∑¬∑‚àëŒ±n
Œ≥n=0
Œ±1
Œ≥1

¬∑¬∑¬∑
Œ±n
Œ≥n

(‚àÇŒ≥ f)(‚àÇŒ±‚àíŒ≥u),
(15) If uk, u ‚ààLp(Rn) and uk ‚Üíu in Lp (1 ‚â§p ‚â§‚àû), then uk ‚Üíu in S ‚Ä≤(Rn).
Therefore, convergence in S implies convergence in Lp, which in turn implies
convergence in S ‚Ä≤(Rn).
Proof. All the statements can be proved easily using duality and the corresponding
statements for Schwartz functions.
‚ñ°
We continue with an application of Theorem 2.3.21.
Proposition 2.3.23. Given u ‚ààS ‚Ä≤(Rn), there exists a sequence of C ‚àû
0 functions fk
such that fk ‚Üíu in the sense of tempered distributions; in particular, C ‚àû
0 (Rn) is
dense in S ‚Ä≤(Rn).
Proof. Fix a function in C ‚àû
0 (Rn) with œï(x) = 1 in a neighborhood of the origin.
Let œïk(x) = Œ¥ 1/k(œï)(x) = œï(x/k). It follows from Exercise 2.3.5 (b) that for u ‚àà
S ‚Ä≤(Rn), œïku ‚Üíu in S ‚Ä≤. By Proposition 2.3.22 (3), we have that the map u ‚Üí
(œïk1u)‚à®is continuous on S ‚Ä≤(Rn). Now Theorem 2.3.21 gives that (œïk1u)‚à®is a C ‚àû
function and therefore œïj(œïk1u)‚à®is in C ‚àû
0 (Rn). As observed, œïj(œïk1u)‚à®‚Üí(œïk1u)‚à®in
S ‚Ä≤ when k is Ô¨Åxed and j ‚Üí‚àû. Exercise 2.3.5 (c) gives that the diagonal sequence
œïk(œïk f)‚àßconverges to 1f in S as k ‚Üí‚àûfor all f ‚ààS . Using duality and Exercise
2.2.2, we conclude that the sequence of C ‚àû
0 functions œïk(œïk1u)‚à®converges to u in
S ‚Ä≤ as k ‚Üí‚àû.
‚ñ°
Exercises
2.3.1. Show that a positive measure Œº that satisÔ¨Åes

Rn
dŒº(x)
(1+|x|)k < +‚àû,
for some k > 0, can be identiÔ¨Åed with a tempered distribution. Show that if we think
of Lebesgue measure as a tempered distribution, then it coincides with the constant
function 1 also interpreted as a tempered distribution.
2.3.2. Let œï, f ‚ààS (Rn), and for Œµ > 0 let œïŒµ(x) = Œµ‚àínœï(Œµ‚àí1x). Prove that
œïŒµ ‚àóf ‚Üíb f in S , where b is the integral of œï.

132
2 Maximal Functions, Fourier Transform, and Distributions
2.3.3. Prove that for all a > 0, u ‚ààS ‚Ä≤(Rn), and f ‚ààS (Rn) we have
(Œ¥ a f)‚àó(Œ¥ au) = a‚àínŒ¥ a( f ‚àóu).
2.3.4. (a) Prove that the derivative of œá[a,b] is Œ¥a ‚àíŒ¥b.
(b) Compute ‚àÇjœáB(0,1) on R2.
(c) Compute the Fourier transforms of the locally integrable functions sinx and cosx.
(d) Prove that the derivative of the distribution log|x| ‚ààS ‚Ä≤(R) is the distribution
u(œï) = lim
Œµ‚Üí0

Œµ‚â§|x|
œï(x)dx
x .
2.3.5. Let f ‚ààS (Rn) and let œï ‚ààC ‚àû
0 be identically equal to 1 in a neighborhood
of the origin. DeÔ¨Åne œïk(x) = œï(x/k) as in the proof of Proposition 2.3.23.
(a) Prove that (œÑ‚àíhe j f ‚àíf)/h ‚Üí‚àÇj f in S as h ‚Üí0.
(b) Prove that œïk f ‚Üíf in S as k ‚Üí‚àû.
(c) Prove that the sequence œïk(œïk f)‚àßconverges to 1f in S as k ‚Üí‚àû.
2.3.6. Use Theorem 2.3.21 to show that there does not exist a nonzero C ‚àû
0 function
whose Fourier transform is also a C ‚àû
0 function.
2.3.7. Let f ‚ààLp(Rn) for some 1 ‚â§p < ‚àû. Show that the sequence of functions
gN(Œæ) =

B(0,N) f(x)e‚àí2œÄix¬∑Œæ dx
converges to 1f in S ‚Ä≤.
2.3.8. Let (ck)k‚ààZn be a sequence that satisÔ¨Åes |ck| ‚â§A(1+|k|)M for all k and some
Ô¨Åxed M and A > 0. Let Œ¥k denote Dirac mass at the integer k. Show that the sequence
of distributions
‚àë
|k|‚â§N
ckŒ¥k
converges to some tempered distribution u in S ‚Ä≤(Rn) as N ‚Üí‚àû. Also show that 1u
is the S ‚Ä≤ limit of the sequence of functions
hN(Œæ) = ‚àë
|k|‚â§N
cke‚àí2œÄiŒæ¬∑k .
2.3.9. A distribution in S ‚Ä≤(Rn) is called homogeneous of degree Œ≥ ‚ààC if for all
Œª > 0 and for all œï ‚ààS (Rn) we have
4
u,Œ¥ Œªœï
5
= Œª ‚àín‚àíŒ≥4
u,œï
5
.
(a) Prove that this deÔ¨Ånition agrees with the usual deÔ¨Ånition for functions.
(b) Show that Œ¥0 is homogeneous of degree ‚àín.
(c) Prove that if u is homogeneous of degree Œ≥, then ‚àÇŒ±u is homogeneous of degree
Œ≥ ‚àí|Œ±|.

2.4 More About Distributions and the Fourier Transform
133
(d) Show that u is homogeneous of degree Œ≥ if and only if 1u is homogeneous of
degree ‚àín‚àíŒ≥.
2.3.10. (a) Show that the functions einx and e‚àíinx converge to zero in S ‚Ä≤ and D‚Ä≤ as
n ‚Üí‚àû. Conclude that multiplication of distributions is not a continuous operation
even when it is deÔ¨Åned.
(b) What is the limit of ‚àön(1+n|x|2)‚àí1 in D‚Ä≤(R) as n ‚Üí‚àû?
2.3.11. (S. Bernstein) Let f be a bounded function on Rn with 1f supported in the
ball B(0,R). Prove that for all multi-indices Œ± there exist constants CŒ±,n (depending
only on Œ± and on the dimension n) such that
‚àÇŒ± f

L‚àû‚â§CŒ±,nR|Œ±| f

L‚àû.

Hint: Write f = f ‚àóh1/R, where h is a Schwartz function h in Rn whose Fourier
transform is equal to one on the ball B(0,1) and vanishes outside the ball B(0,2).

2.3.12. Let 1Œ¶ be a C ‚àû
0 function that is equal to 1 in B(0,1) and let 1Œò be a C ‚àû
function that is equal to 1 in a neighborhood of inÔ¨Ånity and equal to zero in a neigh-
borhood of the origin. Prove the following.
(a) For all u in S ‚Ä≤(Rn) we have

1Œ¶

Œæ/2N
1u
‚à®
‚Üíu
in S ‚Ä≤(Rn) as N ‚Üí‚àû.
(b) For all u in S ‚Ä≤(Rn) we have

1Œò

Œæ/2N
1u
‚à®
‚Üí0
in S ‚Ä≤(Rn) as N ‚Üí‚àû.
2.3.13. Prove that there exists a function in Lp for 2 < p < ‚àûwhose distributional
Fourier transform is not a locally integrable function.

Hint: Assume the converse. Then for all f ‚ààLp(Rn), 1f is locally integrable and
hence the map f ‚Üí1f is a well deÔ¨Åned linear operator from Lp(Rn) to L1(B(0,M))
for all M > 0 (i.e. ‚à•1f ‚à•L1(B(0,M)) < ‚àûfor all f ‚ààLp(Rn)). Use the closed graph
theorem to deduce that ‚à•1f ‚à•L1(B(0,M)) ‚â§CM‚à•f‚à•Lp(Rn) for some CM < ‚àû. To violate
this inequality whenever p > 2, take fN(x) = (1 + iN)‚àín/2e‚àíœÄ(1+iN)‚àí1|x|2 and let
N ‚Üí‚àû, noting that 2
fN(Œæ) = e‚àíœÄ|Œæ|2(1+iN).

2.4 More About Distributions and the Fourier Transform
In this section we discuss further properties of distributions and Fourier transforms
and bring up certain connections that arise between harmonic analysis and partial
differential equations.

134
2 Maximal Functions, Fourier Transform, and Distributions
2.4.1 Distributions Supported at a Point
We begin with the following characterization of distributions supported at a single
point.
Proposition 2.4.1. If u ‚ààS ‚Ä≤(Rn) is supported in the singleton {x0}, then there exists
an integer k and complex numbers aŒ± such that
u = ‚àë
|Œ±|‚â§k
aŒ±‚àÇŒ±Œ¥x0.
Proof. Without loss of generality we may assume that x0 = 0. By (2.3.3) we have
that for some C, m, and k,
4
u, f
5 ‚â§C ‚àë
|Œ±|‚â§m
|Œ≤|‚â§k
sup
x‚ààRn |xŒ±(‚àÇŒ≤ f)(x)|
for all f ‚ààS (Rn).
We now prove that if œï ‚ààS satisÔ¨Åes
(‚àÇŒ±œï)(0) = 0
for all |Œ±| ‚â§k,
(2.4.1)
then
4
u,œï
5
= 0. To see this, Ô¨Åx a œï satisfying (2.4.1) and let Œ∂(x) be a smooth
function on Rn that is equal to 1 when |x| ‚â•2 and equal to zero for |x| ‚â§1. Let
Œ∂ Œµ(x) = Œ∂(x/Œµ). Then, using (2.4.1) and the continuity of the derivatives of œï at the
origin, it is not hard to show that œÅŒ±,Œ≤(Œ∂ Œµœï ‚àíœï) ‚Üí0 as Œµ ‚Üí0 for all |Œ±| ‚â§m and
|Œ≤| ‚â§k. Then
4
u,œï
5 ‚â§
4
u,Œ∂ Œµœï
5+
4
u,Œ∂ Œµœï ‚àíœï
5 ‚â§0+C ‚àë
|Œ±|‚â§m
|Œ≤|‚â§k
œÅŒ±,Œ≤(Œ∂ Œµœï ‚àíœï) ‚Üí0
as Œµ ‚Üí0. This proves our assertion.
Now let f ‚ààS (Rn). Let Œ∑ be a C ‚àû
0 function on Rn that is equal to 1 in a neigh-
borhood of the origin. Write
f(x) = Œ∑(x)

‚àë
|Œ±|‚â§k
(‚àÇŒ± f)(0)
Œ±!
xŒ± +h(x)

+(1‚àíŒ∑(x)) f(x),
(2.4.2)
where h(x) = O(xk+1) as |x| ‚Üí0. Then Œ∑h satisÔ¨Åes (2.4.1) and hence
4
u,Œ∑h
5
= 0
by the claim. Also,
4
u,

(1‚àíŒ∑) f
5
= 0
by our hypothesis. Applying u to both sides of (2.4.2), we obtain
4
u, f
5
= ‚àë
|Œ±|‚â§k
(‚àÇŒ± f)(0)
Œ±!
u(xŒ±Œ∑(x)) = ‚àë
|Œ±|‚â§k
aŒ±(‚àÇŒ±Œ¥0)( f),
with aŒ± = (‚àí1)|Œ±|u(xŒ±Œ∑(x))/Œ±!. This proves the proposition.
‚ñ°

2.4 More About Distributions and the Fourier Transform
135
An immediate consequence is the following result.
Corollary 2.4.2. Let u ‚ààS ‚Ä≤(Rn). If 1u is supported in the singleton {Œæ0}, then u is
a Ô¨Ånite linear combination of functions (‚àí2œÄiŒæ)Œ±e2œÄiŒæ¬∑Œæ0, where Œ± is a multi-index.
In particular, if 1u is supported at the origin, then u is a polynomial.
Proof. Proposition 2.4.1 gives that 1u is a linear combination of derivatives of Dirac
masses at Œæ0. Then Proposition 2.3.22 (8) yields the required conclusion.
‚ñ°
2.4.2 The Laplacian
The Laplacian Œî is a partial differential operator acting on tempered distributions
on Rn as follows:
Œî(u) =
n
‚àë
j=1
‚àÇ2
j u.
Solutions of Laplace‚Äôs equation Œî(u) = 0 are called harmonic distributions. We have
the following:
Corollary 2.4.3. Let u ‚ààS ‚Ä≤(Rn) satisfy Œî(u) = 0. Then u is a polynomial.
Proof. Taking Fourier transforms, we obtain that 
Œî(u) = 0. Therefore,
‚àí4œÄ2|Œæ|21u = 0
in S ‚Ä≤.
This implies that 1u is supported at the origin, and by Corollary 2.4.2 it follows that
u must be polynomial.
‚ñ°
Liouville‚Äôs classical theorem that every bounded harmonic function must be con-
stant is a consequence of Corollary 2.4.3. See Exercise 2.4.2.
Next we would like to compute the fundamental solutions of Laplace‚Äôs equation
in Rn. A distribution is called a fundamental solution of a partial differential operator
L if we have L(u) = Œ¥0. The following result gives the fundamental solution of the
Laplacian.
Proposition 2.4.4. For n ‚â•3 we have
Œî(|x|2‚àín) = ‚àí(n‚àí2) 2œÄn/2
Œì (n/2)Œ¥0 ,
(2.4.3)
while for n = 2,
Œî(log|x|) = 2œÄŒ¥0 .
(2.4.4)
Proof. We use Green‚Äôs identity

Œ©

vŒî(u)‚àíuŒî(v)

dx =

‚àÇŒ©

v ‚àÇu
‚àÇŒΩ ‚àíu ‚àÇv
‚àÇŒΩ

ds,

136
2 Maximal Functions, Fourier Transform, and Distributions
where Œ© is an open set in Rn with smooth boundary and ‚àÇv/‚àÇŒΩ denotes the
derivative of v with respect to the outer unit normal vector. Take Œ© = Rn \B(0,Œµ),
v = |x|2‚àín, and u = f a C ‚àû
0 (Rn) function in the previous identity. The normal deriva-
tive of f(rŒ∏) is the derivative with respect to the radial variable r. Observe that
Œî(|x|2‚àín) = 0 for x Ã∏= 0. We obtain

|x|>Œµ Œî( f)(x)|x|2‚àín dx = ‚àí

|Œ∏|=Œµ

Œµ2‚àín ‚àÇf
‚àÇr ‚àíf(rŒ∏)‚àÇr2‚àín
‚àÇr

dŒ∏,
(2.4.5)
where dŒ∏ denotes surface measure on the sphere |Œ∏| = Œµ. Now observe two things:
Ô¨Årst, that for some C = C( f) we have


|Œ∏|=Œµ
‚àÇf
‚àÇr dŒ∏
 ‚â§CŒµn‚àí1 ;
second, that

|Œ∏|=Œµ f(rŒ∏)Œµ1‚àín dŒ∏ ‚Üíœân‚àí1 f(0)
as Œµ ‚Üí0. Letting Œµ ‚Üí0 in (2.4.5), we obtain that
lim
Œµ‚Üí0

|x|>Œµ Œî( f)(x)|x|2‚àín dx = ‚àí(n‚àí2)œân‚àí1 f(0),
which implies (2.4.3) in view of the formula for œân‚àí1 given in Appendix A.3.
The proof of (2.4.4) is identical. The only difference is that the quantity ‚àÇr2‚àín/‚àÇr
in (2.4.5) is replaced by ‚àÇlogr/‚àÇr.
‚ñ°
2.4.3 Homogeneous Distributions
The fundamental solutions of the Laplacian are locally integrable functions on Rn
and also homogeneous of degree 2 ‚àín when n ‚â•3. Since homogeneous distribu-
tions often arise in applications, it is desirable to pursue their study. Here we do not
undertake such a study in depth, but we discuss a few important examples.
Our Ô¨Årst goal is to understand the action of the distribution |t|z on Rn when
Rez ‚â§‚àín. Let us consider Ô¨Årst the case n = 1. The tempered distribution
‚ü®wz,œï‚ü©=
 1
‚àí1 |t|z œï(t)dt
is well-deÔ¨Åned when Rez > ‚àí1. But we can extend the deÔ¨Ånition for all z with
Rez > ‚àí3 and z Ã∏= ‚àí1 by rewriting it as
‚ü®wz,œï‚ü©=
 1
‚àí1 |t|z 
œï(t)‚àíœï(0)‚àítœï‚Ä≤(0)

dt +
2
z+1œï(0),
(2.4.6)

2.4 More About Distributions and the Fourier Transform
137
and noting that for all œï ‚ààS (R) we have
‚ü®wz,œï‚ü©
 ‚â§
1
z+3‚à•œï‚Ä≤‚Ä≤‚à•L‚àû+
2
z+1‚à•œï‚à•L‚àû,
thus wz ‚ààS ‚Ä≤(R). Subtracting the Taylor polynomial of degree 3 centered at zero
from œï(t) instead of the linear one, as in (2.4.6), allows us to extend the deÔ¨Ånition
for Rez > ‚àí5 and Rez /‚àà{‚àí1,‚àí3}. Subtracting higher order Taylor polynomials
allows us to extend the deÔ¨Ånition of wz for all z ‚ààC except at the negative odd
integers. To be able to include the points z = ‚àí1,‚àí3,‚àí5,‚àí7,... we need to multiply
wz by an entire function that has simple zeros at all the negative odd integers to be
able to eliminate the simple poles at these points. Such a function is Œì
 z+1
2
‚àí1. This
discussion leads to the following deÔ¨Ånition.
DeÔ¨Ånition 2.4.5. For z ‚ààC we deÔ¨Åne a distribution uz as follows:
4
uz, f
5
=

Rn
œÄ
z+n
2
Œì
 z+n
2
|x|z f(x)dx.
(2.4.7)
Clearly the uz‚Äôs coincide with the locally integrable functions
œÄ
z+n
2 Œì
 z+n
2
‚àí1|x|z
when Rez > ‚àín and the deÔ¨Ånition makes sense only for that range of z‚Äôs. It follows
from its deÔ¨Ånition that uz is a homogeneous distribution of degree z.
We would like to extend the deÔ¨Ånition of uz for z ‚ààC. Let Re z > ‚àín Ô¨Årst. Fix N
to be a positive integer. Given f ‚ààS (Rn), write the integral in (2.4.7) as follows:

|x|<1
œÄ
z+n
2
Œì ( z+n
2 )

f(x)‚àí‚àë
|Œ±|‚â§N
(‚àÇŒ± f)(0)
Œ±!
xŒ±
+
|x|z dx
+

|x|>1
œÄ
z+n
2
Œì ( z+n
2 ) f(x)|x|z dx+

|x|<1
œÄ
z+n
2
Œì ( z+n
2 ) ‚àë
|Œ±|‚â§N
(‚àÇŒ± f)(0)
Œ±!
xŒ±|x|z dx.
The preceding expression is equal to

|x|<1
œÄ
z+n
2
Œì ( z+n
2 )

f(x)‚àí‚àë
|Œ±|‚â§N
(‚àÇŒ± f)(0)
Œ±!
xŒ±
+
|x|z dx
+

|x|>1
œÄ
z+n
2
Œì ( z+n
2 ) f(x)|x|z dx
+ ‚àë
|Œ±|‚â§N
(‚àÇŒ± f)(0)
Œ±!
œÄ
z+n
2
Œì ( z+n
2 )
 1
r=0

Sn‚àí1(rŒ∏)Œ± rz+n‚àí1 drdŒ∏ ,

138
2 Maximal Functions, Fourier Transform, and Distributions
where we switched to polar coordinates in the penultimate integral. Now set
b(n,Œ±,z) =
œÄ
z+n
2
Œì ( z+n
2 )
1
Œ±!

Sn‚àí1Œ∏ Œ± dŒ∏
 1
0 r|Œ±|+n+z‚àí1 dr
=
œÄ
z+n
2
Œì ( z+n
2 )
1
Œ±!

Sn‚àí1 Œ∏ Œ± dŒ∏
|Œ±|+z+n
,
where Œ± = (Œ±1,...,Œ±n) is a multi-index. These coefÔ¨Åcients are zero when at least
one Œ±j is odd. Consider now the case that all the Œ±j‚Äôs are even; then |Œ±| is also even.
The function Œì ( z+n
2 ) has simple poles at the points
z = ‚àín, z = ‚àí(n+2), z = ‚àí(n+4),
and so on;
see Appendix A.5. These poles cancel exactly the poles of the function
z ‚Üí(|Œ±|+z+n)‚àí1
at z = ‚àín‚àí|Œ±| when |Œ±| is an even integer in [0,N]. We therefore have
4
uz, f
5
=

|x|‚â•1
œÄ
z+n
2
Œì ( z+n
2 ) f(x)|x|z dx+ ‚àë
|Œ±|‚â§N
b(n,Œ±,z)(‚àí1)|Œ±|4
‚àÇŒ±Œ¥0, f
5
+

|x|<1
œÄ
z+n
2
Œì ( z+n
2 )

f(x)‚àí‚àë
|Œ±|‚â§N
(‚àÇŒ± f)(0)
Œ±!
xŒ±
+
|x|z dx.
(2.4.8)
Both integrals converge absolutely when Re z > ‚àíN ‚àín ‚àí1, since the expression
inside the curly brackets above is bounded by a constant multiple of |x|N+1, and
the resulting function of z in (2.4.8) is a well deÔ¨Åned analytic function in the range
Re z > ‚àíN ‚àín‚àí1.
Since N was arbitrary, ‚ü®uz, f‚ü©has an analytic extension to all of C. Therefore,
uz is a distribution-valued entire function of z, i.e., for all œï ‚ààS (Rn), the function
z ‚Üí‚ü®uz,œï‚ü©is entire.
Next we would like to calculate the Fourier transform of uz. We know by Exercise
2.3.9 that 1uz is a homogeneous distribution of degree ‚àín‚àíz. The choice of constant
in the deÔ¨Ånition of uz was made to justify the following result:
Theorem 2.4.6. For all z ‚ààC we have 1uz = u‚àín‚àíz.
Proof. The idea of the proof is straightforward. First we show that for a certain range
of z‚Äôs we have

Rn |Œæ|z 1œï(Œæ)dŒæ = C(n,z)

Rn |x|‚àín‚àízœï(x)dx,
(2.4.9)

2.4 More About Distributions and the Fourier Transform
139
for some Ô¨Åxed constant C(n,z) and all œï ‚ààS (Rn). Next we pick a speciÔ¨Åc œï to
evaluate the constant C(n,z). Then we use analytic continuation to extend the va-
lidity of (2.4.9) for all z‚Äôs. Use polar coordinates by setting Œæ = œÅœï and x = rŒ∏ in
(2.4.9). We have

Rn |Œæ|z 1œï(Œæ)dŒæ
=
 ‚àû
0 œÅz+n‚àí1
 ‚àû
0

Sn‚àí1 œï(rŒ∏)

Sn‚àí1 e‚àí2œÄirœÅ(Œ∏¬∑œï)dœï

dŒ∏ rn‚àí1 drdœÅ
=
 ‚àû
0
 ‚àû
0 œÉn(rœÅ)œÅz+n‚àí1 dœÅ

Sn‚àí1 œï(rŒ∏)dŒ∏

rn‚àí1 dr
= C(n,z)
 ‚àû
0 r‚àíz‚àín

Sn‚àí1 œï(rŒ∏)dŒ∏

rn‚àí1 dr
= C(n,z)

Rn |x|‚àín‚àízœï(x)dx,
where we set
œÉn(t) =

Sn‚àí1 e‚àí2œÄit(Œ∏¬∑œï) dœï =

Sn‚àí1 e‚àí2œÄit(œï1) dœï ,
(2.4.10)
C(n,z) =
 ‚àû
0 œÉn(t)tz+n‚àí1 dt ,
(2.4.11)
and the second equality in (2.4.10) is a consequence of rotational invariance. It re-
mains to prove that the integral in (2.4.11) converges for some range of z‚Äôs.
If n = 1, then
œÉ1(t) =

S0 e‚àí2œÄitœïdœï = e‚àí2œÄit +e2œÄit = 2cos(2œÄt)
and the integral in (2.4.11) converges conditionally for ‚àí1 < Re z < 0.
Let us therefore assume that n ‚â•2. Since |œÉn(t)| ‚â§œân‚àí1, the integral converges
near zero when ‚àín < Re z. Let us study the behavior of œÉn(t) for t large. Using the
formula in Appendix D.2 and the deÔ¨Ånition of Bessel functions in Appendix B.1, we
write
œÉn(t) = œân‚àí2
 1
‚àí1 e2œÄits"
1‚àís2 n‚àí2
ds
‚àö
1‚àís2 = cnt‚àín‚àí2
2 J n‚àí2
2 (2œÄt),
for some constant cn. Since n ‚â•2 we have when n‚àí2 > ‚àí1/2. Then the asymptotics
for Bessel functions (Appendix B.7) apply and yield |œÉn(t)| ‚â§ct‚àí(n‚àí1)/2 for t ‚â•1.
Splitting the integral in (2.4.11) in t ‚â§1 and t ‚â•1 and using the corresponding
estimates, we notice that it converges absolutely on [0,1] when Rez > ‚àín and on
[1,‚àû) when Re z+n‚àí1‚àín‚àí1
2
< ‚àí1.
We have now proved that when ‚àín < Re z < ‚àín+1
2
and n ‚â•2 we have
1uz = C(n,z)u‚àín‚àíz

140
2 Maximal Functions, Fourier Transform, and Distributions
for some constant C(n,z) that we wish to compute. Insert the function œï(x) = e‚àíœÄ|x|2
in (2.4.9). Example 2.2.9 gives that this function is equal to its Fourier transform.
Use polar coordinates to write
œân‚àí1
 ‚àû
0 rz+n‚àí1e‚àíœÄr2dr = C(n,z)œân‚àí1
 ‚àû
0 r‚àíz‚àín+n‚àí1e‚àíœÄr2dr.
Change variables s = œÄr2 and use the deÔ¨Ånition of the gamma function to obtain
that
C(n,z) = Œì ( z+n
2 )
Œì (‚àíz
2)
œÄ‚àíz+n
2
œÄ
z
2
.
It follows that 1uz = u‚àín‚àíz for the range of z‚Äôs considered.
At this point observe that for every f ‚ààS (Rn), the function z ‚Üí‚ü®1uz ‚àíu‚àíz‚àín, f‚ü©
is entire and vanishes for ‚àín < Rez < ‚àín + 1/2. Therefore, it must vanish every-
where and the theorem is proved.
‚ñ°
Homogeneous distributions were introduced in Exercise 2.3.9. We already saw
that the Dirac mass on Rn is a homogeneous distribution of degree ‚àín. There is
another important example of a homogeneous distributions of degree ‚àín, which we
now discuss.
Let Œ© be an integrable function on the sphere Sn‚àí1 with integral zero. DeÔ¨Åne a
tempered distribution WŒ© on Rn by setting
4
WŒ©, f
5
= lim
Œµ‚Üí0

|x|‚â•Œµ
Œ©(x/|x|)
|x|n
f(x)dx.
(2.4.12)
We check that WŒ© is a well deÔ¨Åned tempered distribution on Rn. Indeed, since
Œ©(x/|x|)/|x|n has integral zero over all annuli centered at the origin, we obtain
4
WŒ©,œï
5 =
lim
Œµ‚Üí0

Œµ‚â§|x|‚â§1
Œ©(x/|x|)
|x|n
(œï(x)‚àíœï(0))dx+

|x|‚â•1
Œ©(x/|x|)
|x|n
œï(x)dx

‚â§
‚àáœï

L‚àû

|x|‚â§1
|Œ©(x/|x|)|
|x|n‚àí1
dx+

sup
x‚ààRn |x||œï(x)|

|x|‚â•1
|Œ©(x/|x|)|
|x|n+1
dx
‚â§C1
‚àáœï

L‚àû
Œ©

L1(Sn‚àí1) +C2 ‚àë
|Œ±|‚â§1
œï(x)xŒ±
L‚àû
Œ©

L1(Sn‚àí1) ,
for suitable constants C1 and C2 in view of (2.2.2).
One can verify that WŒ© ‚ààS ‚Ä≤(Rn) is a homogeneous distribution of degree ‚àín
just like the Dirac mass at the origin. It is an interesting fact that all homogeneous
distributions on Rn of degree ‚àín that coincide with a smooth function away from
the origin arise in this way. We have the following result.
Proposition 2.4.7. Suppose that m is a C ‚àûfunction on Rn\{0} that is homogeneous
of degree zero. Then there exist a scalar b and a C ‚àûfunction Œ© on Sn‚àí1 with integral
zero such that
m‚à®= bŒ¥0 +WŒ© ,
(2.4.13)
where WŒ© denotes the distribution deÔ¨Åned in (2.4.12).

2.4 More About Distributions and the Fourier Transform
141
To prove this result we need the following proposition, whose proof we postpone
until the end of this section.
Proposition 2.4.8. Suppose that u is a C ‚àûfunction on Rn \{0} that is homogeneous
of degree z ‚ààC. Then 1u is a C ‚àûfunction on Rn \{0}.
We now prove Proposition 2.4.7 using Proposition 2.4.8.
Proof. Let a be the integral of the smooth function m over Sn‚àí1. The function m‚àía
is homogeneous of degree zero and thus locally integrable on Rn; hence it can be
thought of as a tempered distribution that we call 1u (the Fourier transform of a
tempered distribution u). Since 1u is a C ‚àûfunction on Rn \ {0}, Proposition 2.4.8
implies that u is also a C ‚àûfunction on Rn \ {0}. Let Œ© be the restriction of u on
Sn‚àí1. Then Œ© is a well deÔ¨Åned C ‚àûfunction on Sn‚àí1. Since u is a homogeneous
function of degree ‚àín that coincides with the smooth function Œ© on Sn‚àí1, it follows
that u(x) = Œ©(x/|x|)/|x|n for x in Rn \{0}.
We show that Œ© has mean value zero over Sn‚àí1. Pick a nonnegative, radial,
smooth, and nonzero function œà on Rn supported in the annulus 1 < |x| < 2. Switch-
ing to polar coordinates, we write
4
u,œà
5
=

Rn
Œ©(x/|x|)
|x|n
œà(x)dx = cœà

Sn‚àí1 Œ©(Œ∏)dŒ∏,
4
u,œà
5
=
4
1u, 1œà
5
=

Rn(m(Œæ)‚àía) 1œà(Œæ)dŒæ = c‚Ä≤
œà

Sn‚àí1

m(Œ∏)‚àía

dŒ∏ = 0,
and thus Œ© has mean value zero over Sn‚àí1 (since cœà Ã∏= 0).
We can now legitimately deÔ¨Åne the distribution WŒ©, which coincides with the
function Œ©(x/|x|)/|x|n on Rn \ {0}. But the distribution u also coincides with this
function on Rn \ {0}. It follows that u ‚àíWŒ© is supported at the origin. Proposition
2.4.1 now gives that u ‚àíWŒ© is a sum of derivatives of Dirac masses. Since both
distributions are homogeneous of degree ‚àín, it follows that
u‚àíWŒ© = cŒ¥0 .
But u = (m‚àía)‚à®= m‚à®‚àíaŒ¥0, and thus m‚à®= (c+a)Œ¥0 +WŒ©. This proves the propo-
sition.
‚ñ°
We now turn to the proof of Proposition 2.4.8.
Proof. Let u ‚ààS ‚Ä≤ be homogeneous of degree z and C ‚àûon Rn \ {0}. We need to
show that 1u is C ‚àûaway from the origin. We prove that 1u is C M for all M. Fix M ‚ààZ+
and let Œ± be any multi-index such that
|Œ±| > n+M +Re z.
(2.4.14)

142
2 Maximal Functions, Fourier Transform, and Distributions
Pick a C ‚àûfunction œï on Rn that is equal to 1 when |x| ‚â•2 and equal to zero for
|x| ‚â§1. Write u0 = (1‚àíœï)u and u‚àû= œïu. Then
‚àÇŒ±u = ‚àÇŒ±u0 +‚àÇŒ±u‚àû
and thus
3
‚àÇŒ±u = 
‚àÇŒ±u0 + 
‚àÇŒ±u‚àû,
where the operations are performed in the sense of distributions. Since u0 is com-
pactly supported, Theorem 2.3.21 implies that 
‚àÇŒ±u0 is C ‚àû. Now Leibniz‚Äôs rule gives
that
‚àÇŒ±u‚àû= v+œï‚àÇŒ±u,
where v is a smooth function supported in the annulus 1 ‚â§|x| ‚â§2. Then 1v is
C ‚àûand we need to show only that 
œï‚àÇŒ±u is C M. The function œï‚àÇŒ±u is ac-
tually C ‚àû, and by the homogeneity of ‚àÇŒ±u (Exercise 2.3.9 (c)) we obtain that
(‚àÇŒ±u)(x) = |x|‚àí|Œ±|+z(‚àÇŒ±u)(x/|x|). Since œï is supported away from zero, it follows
that
|œï(x)(‚àÇŒ±u)(x)| ‚â§
CŒ±
(1+|x|)|Œ±|‚àíRe z
(2.4.15)
for some CŒ± > 0. It is now straightforward to see that if a function satisÔ¨Åes (2.4.15),
then its Fourier transform is C M whenever (2.4.14) is satisÔ¨Åed. See Exercise 2.4.1.
We conclude that 
‚àÇŒ±u‚àûis a C M function whenever (2.4.14) is satisÔ¨Åed; thus so
is 3
‚àÇŒ±u. Since 3
‚àÇŒ±u(Œæ) = (2œÄiŒæ)Œ± 1u(Œæ), we deduce smoothness for 1u away from the
origin. Let Œæ Ã∏= 0. Pick a neighborhood V of Œæ such that for Œ∑ in V we have Œ∑j Ã∏= 0
for some j ‚àà{1,...,n}. Consider the multi-index (0,...,|Œ±|,...,0) with |Œ±| in the
jth coordinate and zeros elsewhere. Then (2œÄiŒ∑j)|Œ±|1u(Œ∑) is a C M function on V,
and thus so is 1u(Œ∑), since we can divide by Œ∑|Œ±|
j . We conclude that 1u(Œæ) is C M on
Rn \{0}. Since M is arbitrary, the conclusion follows.
‚ñ°
We end this section with an example that illustrates the usefulness of some of the
ideas discussed in this section.
Example 2.4.9. Let Œ∑ be a smooth radial function on Rn that is equal to 1 on the
set |x| ‚â•1/2 and vanishes on the set |x| ‚â§1/4. Fix z ‚ààC satisfy 0 < Rez < n. Let
g =

Œ∑(x)|x|‚àíz‚àßbe the distributional Fourier transform of Œ∑(x)|x|‚àíz. We show that
g is a function that decays faster than |Œæ|‚àíN at inÔ¨Ånity (for sufÔ¨Åciently large positive
number N) and that
g(Œæ)‚àíœÄz‚àín
2Œì ( n‚àíz
2 )
Œì ( z
2)
|Œæ|z‚àín
(2.4.16)
is a C ‚àûfunction on Rn. This example indicates the interplay between the smooth-
ness of a function and the decay of its Fourier transform. The smoothness of the
function Œ∑(x)|x|‚àíz near zero has as a consequence the rapid decay of g near inÔ¨Ånity,
while the slow decay of Œ∑(x)|x|‚àíz at inÔ¨Ånity reÔ¨Çects the lack of smoothness of g(Œæ)
at zero, in view of the moderate blowup |Œæ|Rez‚àín as |Œæ| ‚Üí0.

2.4 More About Distributions and the Fourier Transform
143
To show that g is a function we write it as g = (|x|‚àíz)‚àß+

(Œ∑(x)‚àí1)|x|‚àíz‚àßand
we observe that the Ô¨Årst term is a function, since 0 < Rez < n. Using Theorem 2.4.6
we write
g(Œæ) = œÄz‚àín
2Œì ( n‚àíz
2 )
Œì ( z
2)
|Œæ|z‚àín + 1œï(Œæ),
where 1œï(Œæ) =

(Œ∑(x)‚àí1)|x|‚àíz‚àß(Œæ) is a C ‚àûfunction, since it is the Fourier trans-
form of a compactly supported integrable function. This proves that g is a function
and that the difference in (2.4.16) is C ‚àû.
Finally, we assert that every derivative of g satisÔ¨Åes |‚àÇŒ≥g(Œæ)| ‚â§CŒ≥,N|Œæ|‚àíN for all
sufÔ¨Åciently large positive integers N when Œæ Ã∏= 0. Indeed, Ô¨Åx a multi-index Œ≥ and
write ‚àÇŒ≥g(Œæ) = (|x|‚àízŒ∑(x)(‚àí2œÄix)Œ≥)‚àß(Œæ). It follows that
(4œÄ2|Œæ|2)N|‚àÇŒ≥g(Œæ)| =

Œî N(|x|‚àízŒ∑(x)(‚àí2œÄix)Œ≥)
‚àß(Œæ)

for all N ‚ààZ+, where Œî is the Laplacian in the x variable. Using Leibniz‚Äôs rule
we distribute Œî N to the product. If a derivative falls on Œ∑, we obtain a compactly
supported smooth function, hence integrable. If all derivatives fall on |x|‚àízxŒ≥, then
we obtain a term that decays like |x|‚àíRez+|Œ≥|‚àí2N at inÔ¨Ånity, which is also integrable
if N is sufÔ¨Åciently large. Thus the function |Œæ|2N|‚àÇŒ≥g(Œæ)| is equal to the Fourier
transform of an L1 function, hence it is bounded, when 2N > n‚àíRez+|Œ≥|.
Exercises
2.4.1. Suppose that a function f satisÔ¨Åes the estimate
| f(x)| ‚â§
C
(1+|x|)N ,
for some C > 0 and N > n+1. Then 1f is C M for all M ‚ààZ+ with 1 ‚â§M < N ‚àín.
2.4.2. Use Corollary 2.4.3 to prove Liouville‚Äôs theorem that every bounded har-
monic function on Rn must be a constant. Derive as a consequence the fundamental
theorem of algebra, stating that every polynomial on C must have a complex root.
2.4.3. Prove that ex is not in S ‚Ä≤(R) but that exeiex is in S ‚Ä≤(R).
2.4.4. Show that the Schwartz function x ‚Üísech(œÄx), x ‚ààR, coincides with its
Fourier transform.

Hint: Integrate the function eiaz over the rectangular contour with corners (‚àíR,0),
(R,0), (R,iœÄ), and (‚àíR,iœÄ).

2.4.5. ([174]) Construct an uncountable family of linearly independent Schwartz
functions fa such that | fa| = | fb| and | 1fa| = | 1fb| for all fa and fb in the family.

Hint: Let w be a smooth nonzero function whose Fourier transform is supported

144
2 Maximal Functions, Fourier Transform, and Distributions
in the interval [‚àí1/2,1/2] and let œÜ be a real-valued smooth nonconstant periodic
function with period 1. Then take fa(x) = w(x)eiœÜ(x‚àía) for a ‚ààR.

2.4.6. Let Py be the Poisson kernel deÔ¨Åned in (2.1.13). Prove that for f ‚ààLp(Rn),
1 ‚â§p < ‚àû, the function
(x,y) ‚Üí(Py ‚àóf)(x)
is a harmonic function on Rn+1
+ . Use the Fourier transform and Exercise 2.2.11 to
prove that (Py1 ‚àóPy2)(x) = Py1+y2(x) for all x ‚ààRn.
2.4.7. (a) For a Ô¨Åxed x0 ‚ààSn‚àí1, show that the function
v(x;x0) = 1‚àí|x|2
|x‚àíx0|n
is harmonic on Rn \{x0}.
(b) For Ô¨Åxed x0 ‚ààSn‚àí1, prove that the family of functions Œ∏ ‚Üív(rx0;Œ∏), 0 < r < 1,
deÔ¨Åned on the sphere satisÔ¨Åes
lim
r‚Üë1

Œ∏‚ààSn‚àí1
|Œ∏‚àíx0|>Œ¥
v(rx0;Œ∏)dŒ∏ = 0
uniformly in x0. The function v(rx0;Œ∏) is called the Poisson kernel for the sphere.
(c) Show that
1
œân‚àí1
(1‚àí|x|2)

Sn‚àí1
1
|x‚àíŒ∏|n dŒ∏ = 1
for all |x| < 1.
(d) Let f be a continuous function on Sn‚àí1. Prove that the function
u(x) =
1
œân‚àí1
(1‚àí|x|2)

Sn‚àí1
f(Œ∏)
|x‚àíŒ∏|n dŒ∏
solves the Dirichlet problem Œî(u) = 0 on |x| < 1 with boundary values u = f on
Sn‚àí1, in the sense limr‚Üë1 u(rx0) = f(x0) when |x0| = 1.

Hint: Part (c): Apply the mean value property over spheres to the harmonic function
y ‚Üí(1‚àí|x|2|y|2)
|x|y‚àíx
|x|
‚àín.

2.4.8. Fix n ‚ààZ+ with n ‚â•2 and a real number Œª, 0 < Œª < n. Also Ô¨Åx Œ∑ ‚ààSn and
y ‚ààRn.
(a) Prove that

Sn |Œæ ‚àíŒ∑|‚àíŒª dŒæ = 2n‚àíŒª œÄ
n
2Œì ( n‚àíŒª
2 )
Œì (n‚àíŒª
2 )
.
(b) Prove that

Rn |x‚àíy|‚àíŒª(1+|x|2)
Œª
2 ‚àín dx = œÄ
n
2Œì ( n‚àíŒª
2 )
Œì (n‚àíŒª
2 )
(1+|y|2)‚àíŒª
2 .

2.4 More About Distributions and the Fourier Transform
145

Hint: Part (a): See Appendix D.4 Part (b): Use the stereographic projection in
Appendix D.6.

2.4.9. Prove the following beta integral identity:

Rn
dt
|x‚àít|Œ±1|y‚àít|Œ±2 = œÄ
n
2 Œì
 n‚àíŒ±1
2

Œì
 n‚àíŒ±2
2

Œì
 Œ±1+Œ±2‚àín
2

Œì
 Œ±1
2

Œì
 Œ±2
2

Œì

n‚àíŒ±1+Œ±2
2

|x‚àíy|n‚àíŒ±1‚àíŒ±2,
where 0 < Œ±1,Œ±2 < n, Œ±1 +Œ±2 > n.

Hint: Reduce to the case y = 0, interpret the integral as a convolution, and use
Theorem 2.4.6.

2.4.10. (a) Prove that if a continuous integrable function f on Rn (n ‚â•2) is constant
on the spheres rSn‚àí1 for all r > 0, then so is its Fourier transform.
(b) If a continuous integrable function on Rn (n ‚â•3) is constant on all (n ‚àí2)‚Äì
dimensional spheres orthogonal to e1 = (1,0,...,0), then its Fourier transform has
the same property.
2.4.11. ([137]) Suppose that 0 < d1,d2,d3 < n satisfy d1 +d2 +d3 = 2n. Prove that
for any distinct x,y,z ‚ààRn we have the identity

Rn |x‚àít|‚àíd2|y‚àít|‚àíd3|z‚àít|‚àíd1dt
= œÄ
n
2
 3
‚àè
j=1
Œì

n‚àíd j
2

Œì
 d j
2


|x‚àíy|d1‚àín|y‚àíz|d2‚àín|z‚àíx|d3‚àín.

Hint: Reduce matters to the case that z = 0 and y = e1. Then take the Fourier
transform in x and use that the function h(t) = |t ‚àíe1|‚àíd3|t|‚àíd1 satisÔ¨Åes 1h(Œæ) =
1h(A‚àí2
Œæ Œæ) for all Œæ Ã∏= 0, where AŒæ is an orthogonal matrix with AŒæe1 = Œæ/|Œæ|.

2.4.12. (a) Integrate the function eiz2 over the contour consisting of the three pieces
P1 = {x+i0 : 0 ‚â§x ‚â§R}, P2 = {ReiŒ∏ : 0 ‚â§Œ∏ ‚â§œÄ
4 }, and P3 = {rei œÄ
4 : 0 ‚â§r ‚â§R}
(with the proper orientation) to obtain the Fresnel integral identity:
lim
R‚Üí‚àû
 R
0 eix2 dx =
‚àö
2œÄ
4 (1+i).
(b) Use the result in part (a) to show that the Fourier transform of the function eiœÄ|x|2
in Rn is equal to ei œÄn
4 e‚àíiœÄ|Œæ|2.

Hint: Part (a): On P2 we have e‚àíR2sin(2Œ∏) ‚â§e‚àí4
œÄ R2Œ∏, and the integral over P2 tends
to 0. Part (b): Try Ô¨Årst n = 1.


146
2 Maximal Functions, Fourier Transform, and Distributions
2.5 Convolution Operators on Lp Spaces and Multipliers
In this section we study the class of operators that commute with translations. We
prove in this section that bounded operators that commute with translations must be
of convolution type. Convolution operators arise in many situations, and we would
like to know under what circumstances they are bounded between Lp spaces.
2.5.1 Operators That Commute with Translations
DeÔ¨Ånition 2.5.1. A vector space X of measurable functions on Rn is called closed
under translations if for f ‚ààX we have œÑz( f) ‚ààX for all z ‚ààRn. Let X and Y be
vector spaces of measurable functions on Rn that are closed under translations. Let
also T be an operator from X to Y. We say that T commutes with translations or is
translation-invariant if
T(œÑy( f)) = œÑy(T( f))
for all f ‚ààX and all y ‚ààRn.
It is straightforward to see that convolution operators commute with translations,
i.e., œÑy( f ‚àóg) = œÑy( f) ‚àóg whenever the convolution is deÔ¨Åned. One of the goals of
this section is to prove the converse: every bounded linear operator that commutes
with translations is of convolution type. We have the following:
Theorem 2.5.2. Let 1 ‚â§p,q ‚â§‚àûand suppose T is a bounded linear operator from
Lp(Rn) to Lq(Rn) that commutes with translations. Then there exists a unique tem-
pered distribution w such that
T( f) = f ‚àów
a.e. for all f ‚ààS .
A very important point to make is that if p = ‚àû, the restriction of T on S does
not uniquely determine T on the entire L‚àû; see Example 2.5.9 and the comments
preceding it about this. The theorem is a consequence of the following two results:
Lemma 2.5.3. Under the hypotheses of Theorem 2.5.2 and for f ‚ààS (Rn), the dis-
tributional derivatives of T( f) are Lq functions that satisfy
‚àÇŒ±
T( f)

= T(‚àÇŒ± f),
for all multi-indices Œ±.
(2.5.1)
Lemma 2.5.4. Let 1 ‚â§q ‚â§‚àûand let h ‚ààLq(Rn). If all distributional derivatives
‚àÇŒ±h are also in Lq, then h is almost everywhere equal to a continuous function H
satisfying
|H(0)| ‚â§Cn,q ‚àë
|Œ±|‚â§n+1
‚àÇŒ±h

Lq .
(2.5.2)

2.5 Convolution Operators on Lp Spaces and Multipliers
147
Proof. Assuming Lemmas 2.5.3 and 2.5.4, we prove Theorem 2.5.2.
Given f ‚ààS (Rn), by Lemmas 2.5.3 and 2.5.4, there is a continuous function H
such that T( f) = H a.e. and such that
|H(0)| ‚â§Cn,q ‚àë
|Œ±|‚â§n+1
‚àÇŒ±T( f)

Lq
holds. DeÔ¨Åne a linear functional u on S by setting
4
u, f
5
= H(0).
This functional is well-deÔ¨Åned, for, if there is another continuous function G such
that G = T( f) a.e., then G = H a.e. and since both functions are continuous, it
follows that H = G everywhere and thus H(0) = G(0).
By (2.5.1), (2.5.2), and the boundedness of T, we have
4
u, f
5 ‚â§Cn,q ‚àë
|Œ±|‚â§n+1
‚àÇŒ±T( f)

Lq
‚â§Cn,q ‚àë
|Œ±|‚â§n+1
T(‚àÇŒ± f)

Lq
‚â§Cn,q
T

Lp‚ÜíLq ‚àë
|Œ±|‚â§n+1
‚àÇŒ± f

Lp
‚â§C‚Ä≤
n,q
T

Lp‚ÜíLq
‚àë
|Œ≥|‚â§[ n+1
p ]+1
|Œ±|‚â§n+1
œÅŒ≥,Œ±( f),
where the last estimate uses (2.2.8). This implies that u is in S ‚Ä≤. We now set w = #u
and we claim that for all x ‚ààRn we have
4
u,œÑ‚àíx f
5
= H(x).
(2.5.3)
Assuming (2.5.3) we prove that T( f) = f ‚àów for f ‚ààS . To see this, by Theorem
2.3.20 and by the translation invariance of T, for a given f ‚ààS (Rn) we have
( f ‚àów)(x) =
4
#u,œÑx #f
5
=
4
u,œÑ‚àíx f
5
= H(x) = T( f)(x),
where the last equality holds for almost all x, by the deÔ¨Ånition of H. Thus f ‚àów =
T( f) a.e., as claimed. The uniqueness of w follows from the simple observation that
if f ‚àów = f ‚àów‚Ä≤ for all f ‚ààS (Rn), then w = w‚Ä≤.
We now turn to the proof of (2.5.3). Given f ‚ààS (Rn) and x ‚ààRn and let Hx
be the continuous function such that Hx = T(œÑ‚àíx f). We show that Hx(0) = H(x).
Indeed, we have
Hx(y) = T(œÑ‚àíx f)(y) = œÑ‚àíxT( f)(y) = T( f)(x+y) = H(x+y) = œÑ‚àíxH(y),

148
2 Maximal Functions, Fourier Transform, and Distributions
where the equality T( f)(x + y) = H(x + y) holds a.e. in y. Thus the continuous
functions Hx and œÑ‚àíxH are equal a.e. and thus they must be everywhere equal,
in particular, when y = 0. This proves that Hx(0) = H(x), which is a restatement
of (2.5.3).
‚ñ°
We now return to Lemmas 2.5.3 and 2.5.4. We begin with Lemma 2.5.3.
Proof. Consider Ô¨Årst the multi-index Œ± = (0,...,1,...,0), where 1 is in the jth
entry and 0 is elsewhere. Let ej = (0,...,1,...,0), where 1 is in the jth entry and
zero elsewhere. We have

Rn T( f)(y)œï(y+hej)‚àíœï(y)
h
dy =

Rn œï(y)T
œÑhe j( f)‚àíf
h

(y)dy
(2.5.4)
since both of these expressions are equal to

Rn œï(y)T( f)(y‚àíhej)‚àíT( f)(y)
h
dy
and T commutes with translations. We will let h ‚Üí0 in both sides of (2.5.4). We
write
œï(y+hej)‚àíœï(y)
h
=
 1
0 ‚àÇjœï(y+htej)dt ,
from which it follows that for |h| < 1/2 we have

œï(y+hej)‚àíœï(y)
h
 ‚â§
 1
0
CM dt
(1+|y+htej|)M ‚â§
 1
0
CM dt
(1+|y|‚àí1
2)M ‚â§
C‚Ä≤
M
(|y|+1)M .
The integrand on the left-hand side of (2.5.4) is bounded by the integrable function
|T( f)(y)|C‚Ä≤
M(|y| + 1)‚àíM and converges to T( f)(y)‚àÇjœï(y) as h ‚Üí0. The Lebesgue
dominated convergence theorem yields that the integral on the left-hand side of
(2.5.4) converges to

Rn T( f)(y)‚àÇjœï(y)dy.
(2.5.5)
Moreover, for a Schwartz function f we have
œÑhe j( f)(y)‚àíf(y)
h
=
 1
0 ‚àÇj f(y+htej)dt ,
which converges to ‚àÇj f(y) pointwise as h ‚Üí0 and is bounded by C‚Ä≤
M(1+|y|)‚àíM for
|h| < 1/2 by an argument similar to the preceding one for œï in place of f. Thus
œÑhe j( f)‚àíf
h
‚Üí‚àÇj f
in Lp as h ‚Üí0,
(2.5.6)

2.5 Convolution Operators on Lp Spaces and Multipliers
149
by the Lebesgue dominated convergence theorem. The boundedness of T from Lp
to Lq yields that
T
œÑhe j( f)‚àíf
h

‚ÜíT(‚àÇj f)
in Lq as h ‚Üí0.
(2.5.7)
Since œï ‚ààLq‚Ä≤, by H¬®older‚Äôs inequality, the right-hand side of (2.5.4) converges to

Rn œï(y)T(‚àÇj f)(y)dy
as h ‚Üí0. This limit is equal to (2.5.5) and the required conclusion follows for Œ± =
(0,...,0,1,0,...,0). The general case follows by induction on |Œ±|.
‚ñ°
We now prove Lemma 2.5.4.
Proof. Let R ‚â•1. Fix a C ‚àû
0 function œïR that is equal to 1 in the ball |x| ‚â§R and
equal to zero when |x| ‚â•2R. Since h is in Lq(Rn), it follows that œïRh is in L1(Rn).
We show that 3
œïRh is also in L1. We begin with the inequality
1 ‚â§Cn(1+|x|)‚àí(n+1) ‚àë
|Œ±|‚â§n+1
|(‚àí2œÄix)Œ±|,
(2.5.8)
which is just a restatement of (2.2.3). Now multiply (2.5.8) by |3
œïRh(x)| to obtain
|3
œïRh(x)| ‚â§Cn(1+|x|)‚àí(n+1) ‚àë
|Œ±|‚â§n+1
|(‚àí2œÄix)Œ± 3
œïRh(x)|
‚â§Cn(1+|x|)‚àí(n+1) ‚àë
|Œ±|‚â§n+1
(‚àÇŒ±(œïRh))‚àß
L‚àû
‚â§Cn(1+|x|)‚àí(n+1) ‚àë
|Œ±|‚â§n+1
‚àÇŒ±(œïRh)

L1
‚â§Cn(2nRnvn)1/q‚Ä≤(1+|x|)‚àí(n+1) ‚àë
|Œ±|‚â§n+1
‚àÇŒ±(œïRh)

Lq
‚â§Cn,R(1+|x|)‚àí(n+1) ‚àë
|Œ±|‚â§n+1
‚àÇŒ±h

Lq ,
where we used Leibniz‚Äôs rule (Proposition 2.3.22 (14)) and the fact that all deriva-
tives of œïR are pointwise bounded by constants depending on R.
Integrate the previously displayed inequality with respect to x to obtain
3
œïRh

L1 ‚â§CR,n ‚àë
|Œ±|‚â§n+1
‚àÇŒ±h

Lq < ‚àû.
(2.5.9)
Therefore, Fourier inversion holds for œïRh (see Exercise 2.2.6). This implies that
œïRh is equal a.e. to a continuous function, namely the inverse Fourier transform of
its Fourier transform. Since œïR = 1 on the ball B(0,R), we conclude that h is a.e.
equal to a continuous function in this ball. Since R > 0 was arbitrary, it follows that

150
2 Maximal Functions, Fourier Transform, and Distributions
h is a.e. equal to a continuous function on Rn, which we denote by H. Finally, (2.5.2)
is a direct consequence of (2.5.9) with R = 1, since |H(0)| ‚â§‚à•3
œï1h‚à•L1.
‚ñ°
2.5.2 The Transpose and the Adjoint of a Linear Operator
We brieÔ¨Çy discuss the notions of the transpose and the adjoint of a linear operator.
We Ô¨Årst recall real and complex inner products. For f,g measurable functions on
Rn, we deÔ¨Åne the complex inner product
4
f |g
5
=

Rn f(x)g(x)dx,
whenever the integral converges absolutely. We reserve the notation
4
f,g
5
=

Rn f(x)g(x)dx
for the real inner product on L2(Rn) and also for the action of a distribution f on
a test function g. (This notation also makes sense when a distribution f coincides
with a function.)
Let 1 ‚â§p,q ‚â§‚àû. For a bounded linear operator T from Lp(X,Œº) to Lq(Y,ŒΩ) we
denote by T ‚àóits adjoint operator deÔ¨Åned by
4
T( f)|g
5
=

Y T( f)gdŒΩ =

X f T ‚àó(g)dŒº =
4
f |T ‚àó(g)
5
(2.5.10)
for f in Lp(X,Œº) and g in Lq‚Ä≤(Y,ŒΩ) (or in a dense subspace of it). We also deÔ¨Åne the
transpose of T as the unique operator Tt that satisÔ¨Åes
4
T( f),g
5
=

Y T( f)gdx =

X f Tt(g)dx =
4
f,Tt(g)
5
for all f ‚ààLp(X,Œº) and all g ‚ààLq‚Ä≤(Y,ŒΩ).
If T is an integral operator of the form
T( f)(x) =

X K(x,y) f(y)dŒº(y),
then T ‚àóand Tt are also integral operators with kernels K‚àó(x,y) = K(y,x) and
Kt(x,y) = K(y,x), respectively. If T has the form T( f) = ( 1fm)‚à®, that is, it is given
by multiplication on the Fourier transform by a (complex-valued) function m(Œæ),
then T ‚àóis given by multiplication on the Fourier transform by the function m(Œæ).
Indeed for f,g in S (Rn) we have

2.5 Convolution Operators on Lp Spaces and Multipliers
151

Rn f T ‚àó(g)dx =

Rn T( f) gdx
=

Rn

T( f) 1gdŒæ
=

Rn
1f m 1gdŒæ
=

Rn f (m 1g)‚à®dx.
A similar argument (using Theorem 2.2.14 (5)) gives that if T is given by multipli-
cation on the Fourier transform by the function m(Œæ), then Tt is given by multipli-
cation on the Fourier transform by the function m(‚àíŒæ). Since the complex-valued
functions m(Œæ) and m(‚àíŒæ) may be different, the operators T ‚àóand Tt may be dif-
ferent in general. Also, if m(Œæ) is real-valued, then T is self-adjoint (i.e., T = T ‚àó)
while if m(Œæ) is even, then T is self-transpose (i.e., T = Tt).
2.5.3 The Spaces M p,q(Rn)
DeÔ¨Ånition 2.5.5. Given 1 ‚â§p,q ‚â§‚àû, we denote by M p,q(Rn) the set of all bounded
linear operators from Lp(Rn) to Lq(Rn) that commute with translations.
By Theorem 2.5.2 we have that every T in M p,q is given by convolution with a
tempered distribution. We introduce a norm on M p,q by setting
T

M p,q =
T

Lp‚ÜíLq,
that is, the norm of T in M p,q is the operator norm of T as an operator from Lp to
Lq. It is a known fact that under this norm, M p,q is a complete normed space (i.e.,
a Banach space).
Next we show that when p > q the set M p,q consists of only one element, namely
the zero operator T = 0. This means that the only interesting classes of operators
arise when p ‚â§q.
Theorem 2.5.6. M p,q = {0} whenever 1 ‚â§q < p < ‚àû.
Proof. Let f be a nonzero C ‚àû
0 function and let h ‚ààRn. We have
œÑh(T( f))+T( f)

Lq =
T(œÑh( f)+ f)

Lq ‚â§
T

Lp‚ÜíLq
œÑh( f)+ f

Lp.
Now let |h| ‚Üí‚àûand use Exercise 2.5.1. We conclude that
2
1
q T( f)

Lq ‚â§
T

Lp‚ÜíLq2
1
p f

Lp ,
which is impossible if q < p unless T is the zero operator.
‚ñ°

152
2 Maximal Functions, Fourier Transform, and Distributions
Next we have a theorem concerning the duals of the spaces M p,q(Rn).
Theorem 2.5.7. Let 1 < p ‚â§q < ‚àûand T ‚ààM p,q(Rn). Then T can be deÔ¨Åned on
Lq‚Ä≤(Rn), coinciding with its previous deÔ¨Ånition on the subspace Lp(Rn)‚à©Lq‚Ä≤(Rn) of
Lp(Rn), so that it maps Lq‚Ä≤(Rn) to Lp‚Ä≤(Rn) with norm
T

Lq‚Ä≤‚ÜíLp‚Ä≤ =
T

Lp‚ÜíLq .
(2.5.11)
In other words, we have the following isometric identiÔ¨Åcation of spaces:
M q‚Ä≤,p‚Ä≤(Rn) = M p,q(Rn).
Proof. We Ô¨Årst observe that if T : Lp ‚ÜíLq is given by convolution with u ‚ààS ‚Ä≤, then
the adjoint operator T ‚àó: Lq‚Ä≤ ‚ÜíLp‚Ä≤ is given by convolution with #u ‚ààS ‚Ä≤. Indeed, for
f,g ‚ààS (Rn) we have

Rn f T ‚àó(g)dx =

RnT( f)gdx
=

Rn( f ‚àóu)gdx
=

Rn f (g‚àó#u)dx
=

Rn f g‚àó#udx.
Therefore T ‚àóis given by convolution with #u when applied to Schwartz functions.
Next we observe the validity of the identity
f ‚àó#u = ( #f ‚àóu)#,
f ‚ààS .
(2.5.12)
It remains to show that T (convolution with u) and T ‚àó(convolution with #u) map Lq‚Ä≤
to Lp‚Ä≤ with the same norm. But this easily follows from (2.5.12), which implies that
f ‚àó#u

Lp‚Ä≤
 f

Lq‚Ä≤
=
 #f ‚àóu

Lp‚Ä≤
 #f

Lq‚Ä≤
,
for all nonzero Schwartz functions f. We conclude that
‚à•T ‚àó‚à•Lq‚Ä≤‚ÜíLp‚Ä≤ = ‚à•T‚à•Lq‚Ä≤‚ÜíLp‚Ä≤
and therefore
‚à•T‚à•Lp‚ÜíLq = ‚à•T‚à•Lq‚Ä≤‚ÜíLp‚Ä≤ .
This establishes the claimed assertion.
‚ñ°
We next focus attention on the spaces M p,q(Rn) whenever p = q. These spaces
are of particular interest, since they include the singular integral operators, which
we study in Chapter 5.

2.5 Convolution Operators on Lp Spaces and Multipliers
153
2.5.4 Characterizations of M 1,1(Rn) and M 2,2(Rn)
It would be desirable to have a characterization of the spaces M p,p in terms of
properties of the convolving distribution. Unfortunately, this is unknown at present
(it is not clear whether it is possible) except for certain cases.
Theorem 2.5.8. An operator T is in M 1,1(Rn) if and only if it is given by convo-
lution with a Ô¨Ånite Borel (complex-valued) measure. In this case, the norm of the
operator is equal to the total variation of the measure.
Proof. If T is given with convolution with a Ô¨Ånite Borel measure Œº, then clearly T
maps L1 to itself and ‚à•T‚à•L1‚ÜíL1 ‚â§‚à•Œº‚à•M , where ‚à•Œº‚à•M is the total variation of Œº.
Conversely, let T be an operator bounded from L1 to L1 that commutes with trans-
lations. By Theorem 2.5.2, T is given by convolution with a tempered distribution
u. Let
fŒµ(x) = Œµ‚àíne‚àíœÄ|x/Œµ|2 .
Since the functions fŒµ are uniformly bounded in L1, it follows from the boundedness
of T that fŒµ ‚àóu are also uniformly bounded in L1. Since L1 is naturally embedded in
the space of Ô¨Ånite Borel measures, which is the dual of the space C00 of continuous
functions that tend to zero at inÔ¨Ånity, we obtain that the family fŒµ ‚àóu lies in a Ô¨Åxed
multiple of the unit ball of C ‚àó
00. By the Banach‚ÄìAlaoglu theorem, this is a weak‚àó
compact set. Therefore, some subsequence of fŒµ ‚àóu converges in the weak‚àótopology
to a measure Œº. That is, for some Œµk ‚Üí0 and all g ‚ààC00(Rn) we have
lim
k‚Üí‚àû

Rn g(x)( fŒµk ‚àóu)(x)dx =

Rn g(x)dŒº(x).
(2.5.13)
We claim that u = Œº. To see this, Ô¨Åx g ‚ààS . Equation (2.5.13) implies that
4
u, #fŒµk ‚àóg
5
=
4
u, fŒµk ‚àóg
5
‚Üí
4
Œº,g
5
as k ‚Üí‚àû. Exercise 2.3.2 gives that g‚àófŒµk converges to g in S . Therefore,
4
u, fŒµk ‚àóg
5
‚Üí
4
u,g
5
.
It follows from (2.5.13) that ‚ü®u,g‚ü©= ‚ü®Œº,g‚ü©, and since g was arbitrary, u = Œº.
Next, (2.5.13) implies that for all g ‚ààC00 we have


Rn g(x)dŒº(x)
 ‚â§
g

L‚àûsup
k
 fŒµk ‚àóu

L1 ‚â§
g

L‚àû
T

L1‚ÜíL1.
(2.5.14)
The Riesz representation theorem gives that the norm of the functional
g ‚Üí

Rn g(x)dŒº(x)
on C00 is exactly ‚à•Œº‚à•M . It follows from (2.5.14) that ‚à•T‚à•L1‚ÜíL1 ‚â•‚à•Œº‚à•M . Since the
reverse inequality is obvious, we conclude that ‚à•T‚à•L1‚ÜíL1 = ‚à•Œº‚à•M .
‚ñ°

154
2 Maximal Functions, Fourier Transform, and Distributions
Let Œº be a Ô¨Ånite Borel measure. The operator h ‚Üíh ‚àóŒº maps Lp(Rn) to itself
for all 1 ‚â§p ‚â§‚àû; hence M 1,1(Rn) can be identiÔ¨Åed with a subspace of M ‚àû,‚àû(Rn).
But there exist bounded linear operators Œ¶ on L‚àûthat commute with translations
for which there does not exist a Ô¨Ånite Borel measure Œº such that Œ¶(h) = h ‚àóŒº for
all h ‚ààL‚àû(Rn). The following example captures such a behavior.
Example 2.5.9. Let (X,‚à•¬∑ ‚à•L‚àû) be the space of all complex-valued bounded func-
tions on the real line such that
Œ¶( f) = lim
R‚Üí+‚àû
1
R
 R
0 f(t)dt
exists. Then Œ¶ is a bounded linear functional on X with norm 1 and has a bounded
extension #Œ¶ on L‚àûwith norm 1, by the Hahn‚ÄìBanach theorem. We may view #Œ¶
as a bounded linear operator from L‚àû(R) to the space of constant functions, which
is contained in L‚àû(R). We note that #Œ¶ commutes with translations, since for all
f ‚ààL‚àû(R) and x ‚ààR we have
#Œ¶(œÑx( f))‚àíœÑx( #Œ¶( f)) = #Œ¶(œÑx( f))‚àí#Œ¶( f) = #Œ¶(œÑx( f)‚àíf) = Œ¶(œÑx( f)‚àíf) = 0,
where the last two equalities follow from the fact that for L‚àûfunctions f the expres-
sion 1
R
 R
0 ( f(t ‚àíx)‚àíf(t))dt is bounded by |x|
R ‚à•f‚à•L‚àûwhen R > |x| and thus tends to
zero as R ‚Üí‚àû. If Œ¶(œï) = œï ‚àóu for some u ‚ààS ‚Ä≤(Rn) and all œï ‚ààS (Rn), since Œ¶
vanishes on S , the uniqueness in Theorem 2.5.2 yields that u = 0. Hence, if there
existed a Ô¨Ånite Borel measure Œº such that #Œ¶(h) = h‚àóŒº all h ‚ààL‚àû, in particular we
would have 0 = Œ¶(œï) = œï ‚àóŒº for all œï ‚ààS , hence Œº would be the zero measure.
But obviously, this is not the case, since Œ¶ is not the zero operator on X.
We now study the case p = 2. We have the following theorem:
Theorem 2.5.10. An operator T is in M 2,2(Rn) if and only if it is given by convo-
lution with some u ‚ààS ‚Ä≤ whose Fourier transform 1u is an L‚àûfunction. In this case
the norm of T : L2 ‚ÜíL2 is equal to ‚à•1u‚à•L‚àû.
Proof. If 1u ‚ààL‚àû, Plancherel‚Äôs theorem gives

Rn | f ‚àóu|2 dx =

Rn | 1f(Œæ)1u(Œæ)|2 dŒæ ‚â§
1u
2
L‚àû
 1f
2
L2 ;
therefore, ‚à•T‚à•L2‚ÜíL2 ‚â§‚à•1u‚à•L‚àû, and hence T is in M 2,2(Rn).
Now suppose that T ‚ààM 2,2(Rn) is given by convolution with a tempered distri-
bution u. We show that 1u is a bounded function. For R > 0 let œïR be a C ‚àû
0 function
supported inside the ball B(0,2R) and equal to one on the ball B(0,R). The product
of the function œïR with the distribution 1u is œïR1u = ((œïR)‚à®‚àóu)1= T(œï‚à®
R )1, which
is an L2 function. Since the L2 function œïR1u coincides with the distribution 1u on
the set B(0,R), it follows that 1u is in L2(B(0,R)) for all R > 0 and therefore it is

2.5 Convolution Operators on Lp Spaces and Multipliers
155
in L2
loc. If f ‚ààL‚àû(Rn) has compact support, the function f 1u is in L2, and therefore
Plancherel‚Äôs theorem and the boundedness of T give

Rn | f(x)1u(x)|2 dx =

Rn |T( f ‚à®)(x)|2 dx ‚â§
T
2
L2‚ÜíL2

Rn | f(x)|2 dx.
We conclude that for all bounded functions with compact support f we have

Rn

‚à•T‚à•2
L2‚ÜíL2 ‚àí|1u(x)|2
| f(x)|2 dx ‚â•0.
Taking f(x1,...,xn) = (2r)‚àín/2 ‚àèn
j=1 œá[‚àír,r](xj) for r > 0 and using Corollary 2.1.16,
we obtain that ‚à•T‚à•2
L2‚ÜíL2 ‚àí|1u(x)|2 ‚â•0 for almost all x. Hence 1u is in L‚àûand ‚à•1u‚à•L‚àû‚â§
‚à•T‚à•L2‚ÜíL2. Combining this with the estimate ‚à•T‚à•L2‚ÜíL2 ‚â§‚à•1u‚à•L‚àû, which holds if
1u ‚ààL‚àû, we deduce that ‚à•T‚à•L2‚ÜíL2 = ‚à•1u‚à•L‚àû.
‚ñ°
2.5.5 The Space of Fourier Multipliers Mp(Rn)
We have now characterized all convolution operators that map L2 to L2. Suppose
now that T is in M p,p, where 1 < p < 2. As discussed in Theorem 2.5.7, T also
maps Lp‚Ä≤ to Lp‚Ä≤. Since p < 2 < p‚Ä≤, by Theorem 1.3.4, it follows that T also maps L2
to L2. Thus T is given by convolution with a tempered distribution whose Fourier
transform is a bounded function.
DeÔ¨Ånition 2.5.11. Given 1 ‚â§p < ‚àû, we denote by Mp(Rn) the space of all bounded
functions m on Rn such that the operator
Tm( f) = ( 1f m)‚à®,
f ‚ààS ,
is bounded on Lp(Rn) (or is initially deÔ¨Åned in a dense subspace of Lp(Rn) and has
a bounded extension on the whole space). The norm of m in Mp(Rn) is deÔ¨Åned by
m

Mp =
Tm

Lp‚ÜíLp.
(2.5.15)
DeÔ¨Ånition 2.5.11 implies that m ‚ààMp if and only if Tm ‚ààM p,p. Elements of
the space Mp are called Lp multipliers or Lp Fourier multipliers. It follows from
Theorem 2.5.10 that M2, the set of all L2 multipliers, is L‚àû. Theorem 2.5.8 implies
that M1(Rn) is the set of the Fourier transforms of Ô¨Ånite Borel measures that is
usually denoted by M (Rn). Theorem 2.5.7 states that a bounded function m is an
Lp multiplier if and only if it is an Lp‚Ä≤ multiplier, and in this case
m

Mp =
m

Mp‚Ä≤ ,
1 < p < ‚àû.

156
2 Maximal Functions, Fourier Transform, and Distributions
It is a consequence of Theorem 1.3.4 that the normed spaces Mp are nested, that is,
for 1 ‚â§p ‚â§q ‚â§2 we have
M1 ‚´ÖMp ‚´ÖMq ‚´ÖM2 = L‚àû.
Moreover, if m ‚ààMp and 1 ‚â§p ‚â§2 ‚â§p‚Ä≤, Theorem 1.3.4 gives
Tm

L2‚ÜíL2 ‚â§
Tm

1
2
Lp‚ÜíLp
Tm

1
2
Lp‚Ä≤‚ÜíLp‚Ä≤ =
Tm

Lp‚ÜíLp ,
(2.5.16)
since 1/2 = (1/2)/p+(1/2)/p‚Ä≤. Theorem 1.3.4 also gives that
m

Mp ‚â§
m

Mq
whenever 1 ‚â§q ‚â§p ‚â§2. Thus the Mp‚Äôs form an increasing family of spaces as p
increases from 1 to 2.
Example 2.5.12. The function m(Œæ) = e2œÄiŒæ¬∑b is an Lp multiplier for all b ‚ààRn,
since the corresponding operator Tm( f)(x) = f(x+b) is bounded on Lp(Rn). Clearly
‚à•m‚à•Mp = 1.
Proposition 2.5.13. For 1 ‚â§p < ‚àû, the normed space

Mp,‚à•¬∑ ‚à•Mp

is a Banach
space. Furthermore, Mp is closed under pointwise multiplication and is a Banach
algebra.
Proof. It sufÔ¨Åces to consider the case 1 ‚â§p ‚â§2. It is straightforward that if m1, m2
are in Mp and b ‚ààC then m1 + m2 and bm1 are also in Mp. Observe that m1m2 is
the multiplier that corresponds to the operator Tm1Tm2 = Tm1m2 and thus
m1m2

Mp =
Tm1Tm2

Lp‚ÜíLp ‚â§
m1

Mp
m2

Mp.
This proves that Mp is an algebra. To show that Mp is a complete normed space,
consider a Cauchy sequence mj in Mp. It follows from (2.5.16) that mj is Cauchy in
L‚àû, and hence it converges to some bounded function m in the L‚àûnorm; moreover
all the mj are a.e. bounded by some constant C uniformly in j. We have to show that
m ‚ààMp. Fix f ‚ààS . We have
Tmj( f)(x) =

Rn
1f(Œæ)mj(Œæ)e2œÄix¬∑Œæ dŒæ ‚Üí

Rn
1f(Œæ)m(Œæ)e2œÄix¬∑Œæ dŒæ = Tm( f)(x)
a.e. by the Lebesgue dominated convergence theorem, since C| 1f | is an integrable
upper bound of all integrands on the left in the preceding expression. Since {mj}j
is a Cauchy sequence in Mp, it is bounded in Mp, and thus sup j ‚à•mj‚à•Mp < +‚àû. An
application of Fatou‚Äôs lemma yields that

Rn |Tm( f)|p dx =

Rn liminf
j‚Üí‚àû|Tmj( f)|p dx
‚â§liminf
j‚Üí‚àû

Rn |Tmj( f)|p dx
‚â§liminf
j‚Üí‚àû
mj
p
Mp
f
p
Lp ,

2.5 Convolution Operators on Lp Spaces and Multipliers
157
which implies that m ‚ààMp. This argument shows that if mj ‚ààMp and mj ‚Üím
uniformly, then m is in Mp and satisÔ¨Åes
‚à•m‚à•Mp ‚â§liminf
j‚Üí‚àû‚à•mj‚à•Mp .
Apply this inequality to mk ‚àímj in place of mj and mk ‚àím in place of m, for some
Ô¨Åxed k. We obtain
‚à•mk ‚àím‚à•Mp ‚â§liminf
j‚Üí‚àû‚à•mk ‚àímj‚à•Mp
(2.5.17)
for each k. Given Œµ > 0, by the Cauchy criterion, there is an N such that for j,k > N
we have ‚à•mk ‚àímj‚à•Mp < Œµ. Using (2.5.17) we conclude that ‚à•mk ‚àím‚à•Mp ‚â§Œµ when
k > N, thus mk converges to m in Mp.
This proves that Mp is a Banach space.
‚ñ°
The following proposition summarizes some simple properties of multipliers.
Proposition 2.5.14. For all m ‚ààMp, 1 ‚â§p < ‚àû, x ‚ààRn, and h > 0 we have
œÑx(m)

Mp =
m

Mp ,
(2.5.18)
Œ¥ h(m)

Mp =
m

Mp ,
(2.5.19)
#m

Mp =
m

Mp ,
e2œÄi(¬∑)¬∑xm

Mp =
m

Mp ,
m‚ó¶A

Mp =
m

Mp,
A is an orthogonal matrix.
Proof. See Exercise 2.5.2.
‚ñ°
Example 2.5.15. We show that for ‚àí‚àû<a<b<‚àûwe have ‚à•œá[a,b]‚à•Mp = ‚à•œá[0,1]‚à•Mp.
Indeed, using (2.5.18) we obtain that ‚à•œá[a,b]‚à•Mp = ‚à•œá[0,b‚àía]‚à•Mp , and the latter is
equal to ‚à•œá[0,1]‚à•Mp in view of (2.5.19). The fact that we have ‚à•œá[0,1]‚à•Mp < ‚àûfor all
1 < p < ‚àûis shown in Chapter 5.
We continue with the following interesting result.
Theorem 2.5.16. Suppose that m(Œæ,Œ∑) ‚ààMp(Rn+m), where 1 < p < ‚àû. Then for
almost every Œæ ‚ààRn the function Œ∑ ‚Üím(Œæ,Œ∑) is in Mp(Rm), with
m(Œæ,¬∑)

Mp(Rm) ‚â§
m

Mp(Rn+m).
Proof. Since m lies in L‚àû(Rn+m), it follows by Fubini‚Äôs theorem that for almost all
Œæ ‚ààRn, the function Œ∑ ‚Üím(Œæ,Œ∑) lies in L‚àû(Rm) and
m(Œæ, ¬∑)

L‚àû(Rm) ‚â§
m

L‚àû(Rn+m) .
(2.5.20)

158
2 Maximal Functions, Fourier Transform, and Distributions
Fix f1, g1 in S (Rn) and f2, g2 in S (Rm). DeÔ¨Åne the functions ( f1 ‚äóf2)(x,y) =
f1(x) f2(y) when x ‚ààRn and y ‚ààRm. For all Œæ for which (2.5.20) is satisÔ¨Åed deÔ¨Åne
M(Œæ) =

Rm

m(Œæ, ¬∑) 1f2
‚à®(y)g2(y)dy =

Rm m(Œæ,Œ∑) 1f2(Œ∑)g2‚à®(Œ∑)dŒ∑
and observe that


Rn

M(¬∑) 1f1
‚à®(x)g1(x)dx
 =


Rn M(Œæ) 1f1(Œæ)g1‚à®(Œæ)dŒæ

=


Rn+m m(Œæ,Œ∑) 
f1 ‚äóf2(Œæ,Œ∑)(g1 ‚äóg2)‚à®(Œæ,Œ∑)dŒæ dŒ∑

=


Rn+m(m 
f1 ‚äóf2)‚à®(x,y)(g1 ‚äóg2)(x,y)dxdy

‚â§
m

Mp(Rn+m)
 f1

Lp
f2

Lp
g1

Lp‚Ä≤
g2

Lp‚Ä≤ .
In view of the identity
(M(¬∑) 1f1)‚à®
Lp =
sup
‚à•g1‚à•Lp‚Ä≤ ‚â§1


Rn

M(¬∑) 1f1
‚à®(x)g1(x)dx
,
it follows that, for the Œæ that satisfy (2.5.20), M(Œæ) lies in Mp(Rn) with
M

Mp(Rn) ‚â§
m

Mp(Rn+m)
f2

Lp
g2

Lp‚Ä≤ .
Since ‚à•M‚à•L‚àû‚â§‚à•M‚à•Mp for almost all Œæ ‚ààRn, we obtain


Rm(m(Œæ,¬∑) 1f2)‚à®(y)g2(y)dy
 = |M(Œæ)| ‚â§
m

Mp(Rn+m)
f2

Lp
g2

Lp‚Ä≤ , (2.5.21)
which of course implies the required conclusion, by taking the supremum over all
g2 in Lp‚Ä≤ with norm at most 1.
‚ñ°
Example 2.5.17. (The cone multiplier) On Rn+1 deÔ¨Åne the function
mŒª(Œæ1,...,Œæn+1) =
'
1‚àíŒæ 2
1 +¬∑¬∑¬∑+Œæ 2
n
Œæ 2
n+1
(Œª
+
,
Œª > 0,
where the plus sign indicates that mŒª = 0 if the expression inside the parentheses is
negative. The multiplier mŒª is called the cone multiplier with parameter Œª. If mŒª is
in Mp(Rn+1), then the function bŒª(Œæ) = (1‚àí|Œæ|2)Œª
+ deÔ¨Åned on Rn is in Mp(Rn).
Indeed, by Theorem 2.5.16 we have that for some Œæn+1 = h, bŒª(Œæ1/h,...,Œæn/h) is in
Mp(Rn) and hence so is bŒª by property (2.5.19).

2.5 Convolution Operators on Lp Spaces and Multipliers
159
Exercises
2.5.1. Prove that if f ‚ààLq(Rn) and 0 < q < ‚àû, then
œÑh( f)+ f

Lq ‚Üí21/qf

Lq
as |h| ‚Üí‚àû.
2.5.2. Prove Proposition 2.5.14. Also prove that if Œ¥
h j
j
is a dilation operator in the
jth variable (for instance Œ¥ h1
1 f(x) = f(h1x1,x2,...,xn)), then
Œ¥ h1
1 ¬∑¬∑¬∑Œ¥ hn
n m

Mp =
m

Mp.
2.5.3. Let m ‚ààMp(Rn) where 1 ‚â§p < ‚àû.
(a) If œà is a function on Rn whose inverse Fourier transform is an integrable func-
tion, then prove that
œàm

Mp ‚â§
œà‚à®
L1
m

Mp .
(b) If œà is in L1(Rn), then prove that
œà ‚àóm

Mp ‚â§
œà

L1
m

Mp .
2.5.4. Fix a multi-index Œ≥.
(a) Prove that the map T( f) = f ‚àó‚àÇŒ≥Œ¥0 maps S continuously into S .
(b) Prove that when 1/p‚àí1/q Ã∏= |Œ≥|/n, T does not extend to an element of the space
M p,q.
2.5.5. Let KŒ≥(x) = |x|‚àín+Œ≥, where 0 < Œ≥ < n. Use Theorem 1.4.25 to show that the
operator
TŒ≥( f) = f ‚àóKŒ≥,
f ‚ààS ,
extends to a bounded operator in M p,q(Rn), where 1/p‚àí1/q = Œ≥/n, 1 < p < q < ‚àû.
This provides an example of a nontrivial operator in M p,q(Rn) when p < q.
2.5.6. (a) Use the ideas of the proof of Proposition 2.5.13 to show that if mj ‚ààMp,
1 ‚â§p < ‚àû, ‚à•mj‚à•Mp ‚â§C for all j = 1,2,..., and mj ‚Üím a.e., then m ‚ààMp and
m

Mp(Rn) ‚â§liminf
j‚Üí‚àû
mj

Mp(Rn) ‚â§C.
(b) Prove that if m ‚ààMp, 1 ‚â§p < ‚àû, and the limit m0(Œæ) = lim
R‚Üí‚àûm(Œæ/R) exists for
all Œæ ‚ààRn, then m0 is a radial function in Mp(Rn) and satisÔ¨Åes ‚à•m0‚à•Mp ‚â§‚à•m‚à•Mp.
(c) If m ‚ààMp(R) has left and right limits at the origin, then prove that
m

Mp(R) ‚â•max(|m(0+)|,|m(0‚àí)|).

160
2 Maximal Functions, Fourier Transform, and Distributions
(d) Suppose that for some 1 ‚â§p < ‚àû, mt ‚ààMp(Rn) for all 0 < t < ‚àû. Prove that
 ‚àû
0
mt

Mp(Rn)
dt
t < ‚àû=‚áí
m(Œæ) =
 ‚àû
0 mt(Œæ)dt
t ‚ààMp .
2.5.7. Let 1 ‚â§p < ‚àûand suppose that m ‚ààMp(Rn) satisÔ¨Åes |m(Œæ)| ‚â•c(1+|Œæ|)‚àíN
for some c,N > 0. Prove that the operator T( f) = ( 1f m‚àí1)‚à®satisÔ¨Åes ‚à•T( f)‚à•Lp ‚â•
cp‚à•f‚à•Lp for all f ‚ààS (Rn), where cp = ‚à•m‚à•‚àí1
Mp.
2.5.8. (a) Prove that if m ‚ààL‚àû(Rn) satisÔ¨Åes m‚à®‚â•0, then for all 1 ‚â§p < ‚àûwe have
m

Mp =
m‚à®
L1 .
(b) (L. Colzani and E. Laeng) On the real line let
m1(Œæ) =

‚àí1
for Œæ > 0
1
for Œæ < 0,
m2(Œæ) =

min(Œæ ‚àí1,0)
for Œæ > 0
max(Œæ +1,0)
for Œæ < 0.
Prove that
m1

Mp =
m2

Mp
for all 1 < p < ‚àû.

Hint: Part (a): Use Exercise 1.2.9. Part (b): Use part (a) to show that ‚à•m2m‚àí1
1 ‚à•Mp =
1. Deduce that ‚à•m2‚à•Mp ‚â§‚à•m1‚à•Mp. For the converse use Exercise 2.5.6 (c).

2.5.9. ([94]) Let 1 < p < ‚àûand 0 < A < ‚àû. Prove that the following are equivalent:
(a) The operator f ‚Üí‚àëm‚ààZn am f(x‚àím) is bounded on Lp(Rn) with norm A.
(b) The Mp norm of the function ‚àëm‚ààZn ame‚àí2œÄim¬∑x is exactly A.
(c) The operator given by convolution with the sequence {am} is bounded on ‚Ñìp(Zn)
with norm A.
2.5.10. ([177]) Let m(Œæ) in Mp(Rn) be supported in [0,1]n. Then the periodic ex-
tension of m in Rn,
M(Œæ) = ‚àë
k‚ààZn
m(Œæ ‚àík),
is also in Mp(Rn).
2.5.11. Suppose that u is a C ‚àûfunction on Rn \{0} that is homogeneous of degree
‚àín+iœÑ, œÑ ‚ààR. Prove that the operator given by convolution with u maps L2(Rn) to
L2(Rn).
2.5.12. ([142]) Let m1 ‚ààLr(Rn) and m2 ‚ààLr‚Ä≤(Rn) for some 2 ‚â§r ‚â§‚àû. Prove that
m1 ‚àóm2 ‚ààMp(Rn) when 1
p ‚àí1
2 = 1
r and 1 ‚â§p ‚â§2.

Hint: Prove that the trilinear operator (m1,m2, f)‚Üí

(m1‚àóm2) 1f
‚à®is bounded from
L2 √ó L2 √ó L1 ‚ÜíL1 and L‚àû√ó L1 √ó L2 ‚ÜíL2. Apply trilinear complex interpolation
(Corollary 7.2.11 in [131]) to deduce the required conclusion for 1 ‚â§p ‚â§2.


2.6 Oscillatory Integrals
161
2.5.13. Show that the function ei|Œæ|2 is an Lp Fourier multiplier on Rn if and only if
p = 2.

Hint: By Exercise 2.4.12 the inverse Fourier transform of ei|Œæ|2 is in L‚àû, thus the
operator f ‚Üí
 1f(Œæ)eiœÄ|Œæ|2‚à®maps L1 to L‚àû. Since this operator also maps L2 to L2,
it should map Lp to Lp‚Ä≤ for all 1 ‚â§p ‚â§2.

2.6 Oscillatory Integrals
Oscillatory integrals have played an important role in harmonic analysis from its
outset. The Fourier transform is the prototype of oscillatory integrals and provides
the simplest example of a nontrivial phase, a linear function of the variable of in-
tegration. More complicated phases naturally appear in the subject; for instance,
Bessel functions provide examples of oscillatory integrals in which the phase is a
sinusoidal function.
In this section we take a quick look at oscillatory integrals. We mostly concentrate
on one-dimensional results, which already require some signiÔ¨Åcant analysis. We
examine only a very simple higher-dimensional situation. Our analysis here is far
from adequate.
DeÔ¨Ånition 2.6.1. An oscillatory integral is an expression of the form
I(Œª) =

Rn eiŒªœï(x)œà(x)dx,
(2.6.1)
where Œª is a positive real number, œï is a real-valued function on Rn called the
phase, and œà is a complex-valued and smooth integrable function on Rn, which is
often taken to have compact support.
2.6.1 Phases with No Critical Points
We begin by studying the simplest possible one-dimensional case. Suppose that œï
and œà are smooth functions on the real line such that suppœà is a closed interval and
œï‚Ä≤(x) Ã∏= 0
for all x ‚ààsuppœà.
Since œï‚Ä≤ has no zeros, it must be either strictly positive or strictly negative every-
where on the support of œà. It follows that œï is monotonic on the support of œà and
we are allowed to change variables
u = œï(x)

162
2 Maximal Functions, Fourier Transform, and Distributions
in (2.6.1). Then dx = (œï‚Ä≤(x))‚àí1du = (œï‚àí1)‚Ä≤(u)du, where œï‚àí1 is the inverse function
of œï. We transform the integral in (2.6.1) into

R eiŒªuœà(œï‚àí1(u))(œï‚àí1)‚Ä≤(u)du
(2.6.2)
and we note that the function Œ∏(u) = œà(œï‚àí1(u))(œï‚àí1)‚Ä≤(u) is smooth and has com-
pact support on R. We therefore interpret the integral in (2.6.1) as 1Œ∏(‚àíŒª/2œÄ), where
1Œ∏ is the Fourier transform of Œ∏. Since Œ∏ is a smooth function with compact support,
it follows that the integral in (2.6.2) has rapid decay as Œª ‚Üí‚àû.
A quick way to see that the expression 1Œ∏(‚àíŒª/2œÄ) has decay of order Œª ‚àíN for all
N > 0 as Œª tends to ‚àûis the following. Write
eiŒªu =
1
(iŒª)N
dN
duN (eiŒªu)
and integrate by parts N times to express the integral in (2.6.2) as
(‚àí1)N
(iŒª)N

R eiŒªu dNŒ∏(u)
duN
du,
from which the assertion follows. Hence
|I(Œª)| = |1Œ∏(‚àíŒª/2œÄ)| ‚â§CNŒª ‚àíN ,
(2.6.3)
where CN = ‚à•Œ∏ (N)‚à•L1, which depends on derivatives of œï and œà.
We now turn to a higher-dimensional analogue of this situation.
DeÔ¨Ånition 2.6.2. We say that a point x0 is a critical point of a phase function œï if
‚àáœï(x0) =

‚àÇ1œï(x0),...,‚àÇnœï(x0)

= 0.
Example 2.6.3. Let Œæ ‚ààRn \ {0}. Then the phase functions œï1(x) = x ¬∑ Œæ, œï2(x) =
ex¬∑Œæ have no critical points, while the phase function œï3(x) = |x|2 ‚àíx ¬∑ Œæ has one
critical point at x0 = 1
2Œæ.
The next result concerns the behavior of oscillatory integrals whose phase func-
tions have no critical points.
Proposition 2.6.4. Suppose that œà is a compactly supported smooth function on Rn
and that œï is a real-valued C ‚àûfunction on Rn that has no critical points on the
support of œà. Then the oscillatory integral
I(Œª) =

Rn eiŒªœï(x)œà(x)dx
(2.6.4)
obeys a bound of the form |I(Œª)| ‚â§CNŒª ‚àíN for all Œª ‚â•1 and all N > 0, where CN
depends on N and on œï and œà.

2.6 Oscillatory Integrals
163
Proof. Since the case n = 1 has already been discussed, we concentrate on dimen-
sions n ‚â•2. For each y in the support of œà there is a unit vector Œ∏y such that
Œ∏y ¬∑‚àáœï(y) = |‚àáœï(y)|.
By the continuity of ‚àáœï there is a small neighborhood B(y,ry) of y such that for all
x ‚ààB(y,ry) we have
Œ∏y ¬∑‚àáœï(x) ‚â•1
2|‚àáœï(y)| > 0.
Cover the support of œà by a Ô¨Ånite number of balls B(yj,ry j), j = 1,...,m, and pick
c = minj 1
2|‚àáœï(yj)|; we have
Œ∏y j ¬∑‚àáœï(x) ‚â•c > 0
(2.6.5)
for all x ‚ààB(yj,ry j) and j = 1,...,m.
Next we Ô¨Ånd a smooth partition of unity of Rn such that each member Œ∂k of the
partition is supported in some ball B(yj,ry j) or lies outside the support of œà. We
therefore write
I(Œª) = ‚àë
k

Rn eiŒªœï(x)œà(x)Œ∂k(x)dx,
(2.6.6)
where the sum contains only a Ô¨Ånite number of indices, since only a Ô¨Ånite number
of the Œ∂k‚Äôs meet the support of œà. It sufÔ¨Åces to show that every term in the sum in
(2.6.6) has rapid decay in Œª as Œª ‚Üí‚àû.
To this end, we Ô¨Åx a k and we pick a j such that the support of œàŒ∂k is contained
in some ball B(yj,ry j). We Ô¨Ånd unit vectors Œ∏y j,2,...,Œ∏y j,n, such that the system
{Œ∏y j,Œ∏y j,2,...,Œ∏y j,n} is an orthonormal basis of Rn. Let ej be the unit (column)
vector on Rn whose jth coordinate is one and whose remaining coordinates are zero.
We Ô¨Ånd an orthogonal matrix R such that Rte1 = Œ∏y j and we introduce the change
of variables u = yj +R(x‚àíyj) in the integral
Ik(Œª) =

Rn eiŒªœï(x)œà(x)Œ∂k(x)dx.
The map x ‚Üíu = (u1,...,un) is a rotation that Ô¨Åxes yj and preserves the ball
B(yj,ry j). DeÔ¨Åning œï(x) = œïo(u), œà(x) = œào(u), Œ∂k(x) = Œ∂ o
k (u), under this new
coordinate system we write
Ik(Œª) =

K
$
R eiŒªœïo(u)œào(u1,...,un)Œ∂ o
k (u1,...,un)du1
%
du2 ¬∑¬∑¬∑dun ,
(2.6.7)
where K is a compact subset of Rn‚àí1. Since R is an orthogonal matrix, R‚àí1 = Rt,
and the change of variables x = yj +Rt(u‚àíyj) implies that
‚àÇx
‚àÇu1
= Ô¨Årst column of Rt = Ô¨Årst row of R = Rte1 = Œ∏y j .

164
2 Maximal Functions, Fourier Transform, and Distributions
Thus for all x ‚ààB(yj,r j) we have
‚àÇœïo(u)
‚àÇu1
= ‚àÇœï(yj +Rt(u‚àíyj))
‚àÇu1
= ‚àáœï(x)¬∑ ‚àÇx
‚àÇu1
= ‚àáœï(x)¬∑Œ∏y j ‚â•c > 0
in view of condition (2.6.5). This lower estimate is valid for all u ‚ààB(yj,ry j), and
therefore the inner integral inside the curly brackets in (2.6.7) is at most CNŒª ‚àíN by
estimate (2.6.3). Integrating over K results in the same conclusion for I(Œª) deÔ¨Åned
in (2.6.4).
‚ñ°
2.6.2 Sublevel Set Estimates and the Van der Corput Lemma
We discuss a sharp decay estimate for one-dimensional oscillatory integrals. This
estimate is obtained as a consequence of delicate size estimates for the Lebesgue
measures of the sublevel sets {|u| ‚â§Œ±} for a function u. In what follows, u(k) denotes
the kth derivative of a function u(t) deÔ¨Åned on R, and C k the space of all functions
whose kth derivative exists and is continuous.
Lemma 2.6.5. Let k ‚â•1 and suppose that a0,...,ak are distinct real numbers. Let
a = min(aj) and b = max(aj) and let f be a real-valued C k‚àí1 function on [a,b] that
is C k on (a,b). Then there exists a point y in (a,b) such that
k
‚àë
m=0
cm f(am) = f (k)(y),
where cm = (‚àí1)k k!
k
‚àè
‚Ñì=0
‚ÑìÃ∏=m
(a‚Ñì‚àíam)‚àí1.
Proof. Suppose we could Ô¨Ånd a polynomial pk(x) = ‚àëk
j=0 bjx j such that the function
œï(x) = f(x)‚àípk(x)
(2.6.8)
satisÔ¨Åes œï(am) = 0 for all 0 ‚â§m ‚â§k. Since the aj are distinct, we apply Rolle‚Äôs
theorem k times to Ô¨Ånd a point y in (a,b) such that
f (k)(y) = k!bk .
The existence of a polynomial pk such that (2.6.8) is satisÔ¨Åed is equivalent to the
existence of a solution to the matrix equation

2.6 Oscillatory Integrals
165
‚éõ
‚éú
‚éú
‚éú
‚éú
‚éú
‚éù
ak
0
ak‚àí1
0
...
a0
1
ak
1
ak‚àí1
1
...
a1
1
...
...
...
...
...
ak
k‚àí1 ak‚àí1
k‚àí1 ... ak‚àí1 1
ak
k
ak‚àí1
k
...
ak
1
‚éû
‚éü
‚éü
‚éü
‚éü
‚éü
‚é†
‚éõ
‚éú
‚éú
‚éú
‚éú
‚éú
‚éù
bk
bk‚àí1
...
b1
b0
‚éû
‚éü
‚éü
‚éü
‚éü
‚éü
‚é†
=
‚éõ
‚éú
‚éú
‚éú
‚éú
‚éú
‚éù
f(a0)
f(a1)
...
f(ak‚àí1)
f(ak)
‚éû
‚éü
‚éü
‚éü
‚éü
‚éü
‚é†
.
The determinant of the square matrix on the left is called the Vandermonde deter-
minant and is equal to
k‚àí1
‚àè
‚Ñì=0
k
‚àè
j=‚Ñì+1
(a‚Ñì‚àíaj) Ã∏= 0.
Since the aj are distinct, it follows that the system has a unique solution. Using
Cramer‚Äôs rule, we solve this system to obtain
bk =
k
‚àë
m=0
(‚àí1)m f(am)
k‚àí1
‚àè
‚Ñì=0
‚ÑìÃ∏=m
k
‚àè
j=‚Ñì+1
jÃ∏=m
(a‚Ñì‚àíaj)
k‚àí1
‚àè
‚Ñì=0
k
‚àè
j=‚Ñì+1
(a‚Ñì‚àíaj)
=
k
‚àë
m=0
(‚àí1)m f(am)
k
‚àè
‚Ñì=0
‚ÑìÃ∏=m
(a‚Ñì‚àíam)‚àí1(‚àí1)k‚àím .
The required conclusion now follows with cm as claimed.
‚ñ°
Lemma 2.6.6. Let E be a measurable subset of R with Ô¨Ånite nonzero Lebesgue mea-
sure and let k ‚ààZ+. Then there exist a0,...,ak in E such that for all ‚Ñì= 0,1,...,k
we have
k
‚àè
j=0
jÃ∏=‚Ñì
|aj ‚àía‚Ñì| ‚â•(|E|/2e)k .
(2.6.9)
Proof. Given a measurable set E with Ô¨Ånite measure, pick a compact subset E‚Ä≤ of
E such that |E \ E‚Ä≤| < Œ¥, for some Œ¥ > 0. For x ‚ààR deÔ¨Åne T(x) = |(‚àí‚àû,x) ‚à©E‚Ä≤|.
Then T enjoys the distance-decreasing property
|T(x)‚àíT(y)| ‚â§|x‚àíy|
for all x,y ‚ààE‚Ä≤; consequently, by the intermediate value theorem, T is a surjective
map from E‚Ä≤ to [0,|E‚Ä≤|]. Let aj be points in E‚Ä≤ such that T(aj) = j
k|E‚Ä≤| for j =
0,1,...,k. For k an even integer, we have
k
‚àè
j=0
jÃ∏=‚Ñì
|aj ‚àía‚Ñì| ‚â•
k
‚àè
j=0
jÃ∏=‚Ñì
 j
k|E‚Ä≤|‚àí‚Ñì
k|E‚Ä≤|
 ‚â•
k
‚àè
j=0
jÃ∏= k
2
 j
k ‚àí1
2
|E‚Ä≤|k =
k
2 ‚àí1
‚àè
r=0
r ‚àík
2
k
2
|E‚Ä≤|k ,
and it is easily shown that

(k/2)!
2k‚àík ‚â•(2e)‚àík.

166
2 Maximal Functions, Fourier Transform, and Distributions
For k an odd integer we have
k
‚àè
j=0
jÃ∏=‚Ñì
|aj ‚àía‚Ñì| ‚â•
k
‚àè
j=0
jÃ∏=‚Ñì
 j
k|E‚Ä≤|‚àí‚Ñì
k|E‚Ä≤|
 ‚â•
k
‚àè
j=0
jÃ∏= k+1
2
 j
k ‚àík +1
2k
|E‚Ä≤|k ,
while the last product is at least
1
k ¬∑ 2
k ¬∑¬∑¬∑
k‚àí1
2
k
2 k +1
2k
‚â•(2e)‚àík .
We have therefore proved (2.6.9) with E‚Ä≤ replacing E. Since |E \E‚Ä≤| < Œ¥ and Œ¥ > 0
is arbitrarily small, the required conclusion follows.
‚ñ°
The following is the main result of this section.
Proposition 2.6.7. (a) Let u be a real-valued C k function, k ‚ààZ+, that satisÔ¨Åes
u(k)(t) ‚â•1 for all t ‚ààR. Then the following estimate is valid for all Œ± > 0:
	
t ‚ààR : |u(t)| ‚â§Œ±

 ‚â§(2e)((k +1)!)
1
k Œ±
1
k .
(2.6.10)
(b) Let ‚àí‚àû< a < b < ‚àû. For all k ‚â•2, for every real-valued C k function u on the
line that satisÔ¨Åes u(k)(t) ‚â•1 for all t ‚àà[a,b], and every Œª ‚ààR\{0} we have:

 b
a eiŒªu(t)dt
 ‚â§12k|Œª|‚àí1
k .
(2.6.11)
(c) If k = 1, u‚Ä≤(t) is monotonic on (a,b), and u‚Ä≤(t) ‚â•1 for all t ‚àà(a,b), then for all
nonzero real numbers Œª we have

 b
a eiŒªu(t)dt
 ‚â§3|Œª|‚àí1 .
(2.6.12)
Proof. Part (a): Let E = {t ‚ààR : |u(t)| ‚â§Œ±}. If |E| is nonzero, then by Lemma
2.6.6 there exist a0,a1,...,ak in E such that for all ‚Ñìwe have
|E|k ‚â§(2e)k
k
‚àè
j=0
jÃ∏=‚Ñì
|aj ‚àía‚Ñì|.
(2.6.13)
Lemma 2.6.5 implies that there exists y ‚àà

minaj,maxaj

such that
u(k)(y) = (‚àí1)k k!
k
‚àë
m=0
u(am)
k
‚àè
‚Ñì=0
‚ÑìÃ∏=m
(a‚Ñì‚àíam)‚àí1 .
(2.6.14)

2.6 Oscillatory Integrals
167
Using (2.6.13), we obtain that the expression on the right in (2.6.14) is in absolute
value at most
(k +1)! max
0‚â§j‚â§k|u(aj)|(2e)k |E|‚àík ‚â§(k +1)!Œ± (2e)k |E|‚àík ,
since aj ‚ààE. The bound u(k)(t) ‚â•1 now implies
|E|k ‚â§(k +1)!(2e)k Œ±
as claimed. This proves (2.6.10).
Part (b): We now take k ‚â•2 and we split the interval (a,b) in (2.6.11) into the
sets
R1 = {t ‚àà(a,b) : |u‚Ä≤(t)| ‚â§Œ≤},
R2 = {t ‚àà(a,b) : |u‚Ä≤(t)| > Œ≤},
for some parameter Œ≤ to be chosen momentarily. The function v = u‚Ä≤ satisÔ¨Åes
v(k‚àí1) ‚â•1 and k ‚àí1 ‚â•1. It follows from part (a) that


R1
eiŒªu(t) dt
 ‚â§|R1| ‚â§2e(k!)
1
k‚àí1 Œ≤
1
k‚àí1 ‚â§6kŒ≤
1
k‚àí1 .
To obtain the corresponding estimate over R2, we note that if u(k) ‚â•1, then the set
{|u‚Ä≤| > Œ≤} is the union of at most 2k ‚àí2 intervals on each of which u‚Ä≤ is monotone.
Let (c,d) be one of these intervals on which u‚Ä≤ is monotone. Then u‚Ä≤ has a Ô¨Åxed sign
on (c,d) and we have

 d
c eiŒªu(t) dt
 =

 d
c

eiŒªu(t)‚Ä≤
1
Œªu‚Ä≤(t) dt

‚â§

 d
c eiŒªu(t)
1
Œªu‚Ä≤(t)
‚Ä≤
dt
+ 1
|Œª|
eiŒªu(d)
u‚Ä≤(d) ‚àíeiŒªu(c)
u‚Ä≤(c)

‚â§1
|Œª|
 d
c

 1
u‚Ä≤(t)
‚Ä≤dt +
2
|Œª|Œ≤
= 1
|Œª|

 d
c
 1
u‚Ä≤(t)
‚Ä≤
dt
+
2
|Œª|Œ≤
= 1
|Œª|

1
u‚Ä≤(d) ‚àí
1
u‚Ä≤(c)
+
2
|Œª|Œ≤
‚â§
3
|Œª|Œ≤ ,
where we use the monotonicity of 1/u‚Ä≤(t) in moving the absolute value from inside
the integral to outside. It follows that


R2
eiŒªu(t) dt
 ‚â§6k
|Œª|Œ≤ .

168
2 Maximal Functions, Fourier Transform, and Distributions
Choosing Œ≤ = |Œª|‚àí(k‚àí1)/k to optimize and adding the corresponding estimates for
R1 and R2, we deduce the claimed estimate (2.6.11).
Part (c): Repeat the argument in part (b) setting Œ≤ = 1 and replacing the interval
(c,d) by (a,b).
‚ñ°
Corollary 2.6.8. Let (a,b), u(t), Œª > 0, and k be as in Proposition 2.6.7. Then for
any function œà on (a,b) with an integrable derivative and k ‚â•2, we have

 b
a eiŒªu(t)œà(t)dt
 ‚â§12kŒª ‚àí1/k

|œà(b)|+
 b
a |œà‚Ä≤(s)|ds

.
We also have

 b
a eiŒªu(t)œà(t)dt
 ‚â§3Œª ‚àí1

|œà(b)|+
 b
a |œà‚Ä≤(s)|ds

,
when k = 1 and u‚Ä≤ is monotonic on (a,b).
Proof. Set
F(x) =
 x
a eiŒªu(t) dt
and use integration by parts to write
 b
a eiŒªu(t)œà(t)dt = F(b)œà(b)‚àí
 b
a F(t)œà‚Ä≤(t)dt .
The conclusion easily follows.
‚ñ°
Example 2.6.9. The Bessel function of order m is deÔ¨Åned as
Jm(r) = 1
2œÄ
 2œÄ
0
eirsinŒ∏e‚àíimŒ∏ dŒ∏ .
Here we take both r and m to be real numbers, and we suppose that m > ‚àí1
2; we refer
to Appendix B for an introduction to Bessel functions and their basic properties.
We use Corollary 2.6.8 to calculate the decay of the Bessel function Jm(r) as
r ‚Üí‚àû. Set
œï(Œ∏) = sin(Œ∏)
and note that œï‚Ä≤(Œ∏) vanishes only at Œ∏ = œÄ/2 and 3œÄ/2 inside the interval [0,2œÄ] and
that œï‚Ä≤‚Ä≤(œÄ/2) = ‚àí1, while œï‚Ä≤‚Ä≤(3œÄ/2) = 1. We now write 1 = œà1 +œà2 +œà3, where
œà1 is smooth and compactly supported in a small neighborhood of œÄ/2, and œà2 is
smooth and compactly supported in a small neighborhood of 3œÄ/2. For j = 1,2,
Corollary 2.6.8 yields

 2œÄ
0
eirsin(Œ∏)
œàj(Œ∏)e‚àíimŒ∏
dŒ∏
 ‚â§Cmr‚àí1/2

2.6 Oscillatory Integrals
169
for some constant C, while the corresponding integral containing œà3 has arbitrary
decay in r in view of estimate (2.6.3) (or Proposition 2.6.4 when n = 1).
Exercises
2.6.1. Suppose that u is a real-valued C k function deÔ¨Åned on the line that satisÔ¨Åes
|u(k)(t)| ‚â•c0 > 0 for some k ‚â•2 and all t ‚àà(a,b). Prove that for Œª ‚ààR \ {0} we
have

 b
a eiŒªu(t) dt
 ‚â§12k(Œªc0)‚àí1/k
and that the same conclusion is valid when k = 1, provided u‚Ä≤ is monotonic.
2.6.2. Show that if u‚Ä≤ is not monotonic in part (c) of Proposition 2.6.7, then the
conclusion may fail.

Hint: Let œï(t) be a real-valued smooth function that is equal to 2t on intervals
[2œÄk+Œµk,2œÄ(k+ 1
2)‚àíŒµk] and equal to t on intervals [2œÄ(k+ 1
2)+Œµk,2œÄ(k+1)‚àíŒµk],
where 0 ‚â§k ‚â§N, for some N ‚ààZ+. Show that the absolute value of the integral of
eiœï(t) over the interval [Œµ0,2œÄ(N +1)‚àíŒµN] tends to inÔ¨Ånity as N ‚Üí‚àû.

2.6.3. Prove that the dependence on k of the constant in part (b) of Proposition 2.6.7
is indeed linear.

Hint: Take u(t) = tk/k! over the interval (0,k!).

2.6.4. Follow the steps below to give an alternative proof of part (b) of Proposition
2.6.7. Assume that the statement is known for some k ‚â•2 and some constant C(k)
for all intervals [a,b] and all C k functions satisfying u(k) ‚â•1 on [a,b]. Fix a C k+1
function u such that u(k+1) ‚â•1 on an interval [a,b]. Let c be the unique point at
which the function u(k) attains its minimum in [a,b].
(a) If u(k)(c) = 0, then for all Œ¥ > 0 we have u(k)(t) ‚â•Œ¥ in the complement of the
interval (c‚àíŒ¥,c+Œ¥) and derive the bound

 b
a eiŒªu(t)dt
 ‚â§2C(k)(ŒªŒ¥)‚àí1/k +2Œ¥ .
(b) If u(k)(c) Ã∏= 0, then we must have c ‚àà{a,b}. Obtain the bound

 b
a eiŒªu(t)dt
 ‚â§C(k)(ŒªŒ¥)‚àí1/k +Œ¥ .
(c) Choose a suitable Œ¥ to optimize and deduce the validity of the statement for k+1
with C(k +1) = 2C(k)+2, hence C(k) = 3¬∑2k‚àí1 +2k ‚àí2, since C(1) = 3.
2.6.5. (a) Prove that for some constant C and all Œª ‚ààR and Œµ ‚àà(0,1) we have


Œµ‚â§|t|‚â§1 eiŒªt dt
t
 ‚â§C.

170
2 Maximal Functions, Fourier Transform, and Distributions
(b) Prove that for some C‚Ä≤ < ‚àû, all Œª ‚ààR, k > 0, and Œµ ‚àà(0,1) we have


Œµ‚â§|t|‚â§1 eiŒªt¬±tk dt
t
 ‚â§C‚Ä≤ .
(c) Show that there is a constant C‚Ä≤‚Ä≤ such that for any 0 < Œµ < N < ‚àû, for all Œæ1,Œæ2
in R, and for all integers k ‚â•2, we have


Œµ‚â§|s|‚â§N ei(Œæ1s+Œæ2sk) ds
s
 ‚â§C‚Ä≤‚Ä≤ .

Hint: Part (a): For |Œª| small use the inequality |eiŒªt ‚àí1| ‚â§|Œªt|. If |Œª| is large,
split the domains of integration into the regions |t| ‚â§|Œª|‚àí1 and |t| ‚â•|Œª|‚àí1 and use
integration by parts in the second case. Part (b): Write
ei(Œªt¬±tk) ‚àí1
t
= eiŒªt e¬±itk ‚àí1
t
+ eiŒªt
t
and use part (a). Part (c): When Œæ1 = Œæ2 = 0 it is trivial. If Œæ2 = 0, Œæ1 Ã∏= 0, change
variables t = Œæ1s and then split the domain of integration into the sets |t| ‚â§1 and
|t| ‚â•1. In the interval over the set |t| ‚â§1 apply part (b) and over the set |t| ‚â•1 use
integration by parts. In the case Œæ2 Ã∏= 0, change variables t = |Œæ2|1/ks and split the
domain of integration into the sets |t| ‚â•1 and |t| ‚â§1. When |t| ‚â§1 use part (b) and
in the case |t| ‚â•1 use Corollary 2.6.8, noting that dk(Œæ1|Œæ2|‚àí1/kt¬±tk)
dt
= k! ‚â•1.

2.6.6. (a) Show that for all a > 0 and Œª > 0 the following is valid:

 aŒª
0
eiŒª logt dt
 ‚â§a.
(b) Prove that there is a constant c > 0 such that for all b > Œª > 10 we have

 b
0 eiŒªt logt dt
 ‚â§
c
Œª logŒª .

Hint: Part (b): Consider the intervals (0,Œ¥) and [Œ¥,b) for some Œ¥. Apply Proposi-
tion 2.6.7 with k = 1 on one of these intervals and with k = 2 on the other. Then
choose a suitable Œ¥.

2.6.7. Show that there is a constant C < ‚àûsuch that for all nonintegers Œ≥ > 1 and
all Œª,b > 1 we have

 b
0 eiŒªtŒ≥dt
 ‚â§C
Œª Œ≥ .

Hint: On the interval (0,Œ¥) apply Proposition 2.6.7 with k = [Œ≥] + 1 and on the
interval (Œ¥,b) with k = [Œ≥]. Then optimize by choosing Œ¥ = Œª ‚àí1/Œ≥.


2.6 Oscillatory Integrals
171
HISTORICAL NOTES
The one-dimensional maximal function originated in the work of Hardy and Littlewood [146].
Its n-dimensional analogue was introduced by Wiener [375], who used Lemma 2.1.5, a variant of
the Vitali covering lemma, to derive its Lp boundedness. One may consult the books of de Guzm¬¥an
[92], [93] for extensions and other variants of such covering lemmas. The actual covering lemma
proved by Vitali [368] says that if a family of closed cubes in Rn has the property that for every point
x ‚ààA ‚äÜRn there exists a sequence of cubes in the family that tends to x, then it is always possible
to extract a sequence of pairwise disjoint cubes Ej from the family such that |A \ 
j Ej| = 0. We
refer to Saks [310] for details and extensions of this theorem.
The class LlogL was introduced by Zygmund to give a sufÔ¨Åcient condition on the local integra-
bility of the Hardy‚ÄìLittlewood maximal operator. The necessity of this condition was observed by
Stein [336]. Stein [341] also showed that the Lp(Rn) norm of the centered Hardy‚ÄìLittlewood max-
imal operator M is bounded above by some dimension-free constant; see also Stein and Str¬®omberg
[345]. Analogous results for maximal operators associated with convex bodies are contained in
Bourgain [35], Carbery [51], and M¬®uller [263]. Bourgain [37] showed the the Hardy-Littlewood
maximal operator associated with cubes is bounded on Lp(Rn) with dimension-free bounds when
p > 1. Aldaz [2] studied the corresponding weak type (1,1) bounds and proved that they grow
to inÔ¨Ånity with the dimension; the constant was improved by Aubrun [15]. The situation for the
uncentered maximal operator M on Lp is different, since given any 1 < p < ‚àûthere exists Cp > 1
such that ‚à•M‚à•Lp(Rn)‚ÜíLp(Rn) ‚â•Cn
p (see Exercise 2.1.8 for a value of such a constant Cp and also the
article of Grafakos and Montgomery-Smith [136] for a larger value).
The centered maximal function MŒº with respect to a general inner regular locally Ô¨Ånite posi-
tive measure Œº on Rn is bounded on Lp(Rn,Œº) without the additional hypothesis that the measure
is doubling; see Fefferman [117]. The proof of this result requires the following covering lemma,
obtained by Besicovitch [27]: Given any family of closed balls whose centers form a bounded sub-
set of Rn, there exists an at most countable subfamily of balls that covers the set of centers and has
bounded overlap, i.e., no point in Rn belongs to more than a Ô¨Ånite number (depending on the dimen-
sion) of the balls in the subfamily. A similar version of this lemma was obtained independently by
Morse [258]. See also Ziemer [385] for an alternative formulation. The uncentered maximal opera-
tor MŒº of Exercise 2.1.1 may not be weak type (1,1) if the measure Œº is nondoubling, as shown by
Sj¬®ogren [323]; related positive weak type (1,1) results are contained in the article of Vargas [365].
The precise value of the operator norm of the uncentered Hardy‚ÄìLittlewood maximal function on
Lp(R) was shown by Grafakos and Montgomery-Smith [136] to be the unique positive solution of
the equation (p ‚àí1)xp ‚àípxp‚àí1 ‚àí1 = 0. This constant raised to the power n is the operator norm
of the strong maximal function Ms on Lp(Rn) for 1 < p ‚â§‚àû. The best weak type (1,1) constant
for the centered Hardy‚ÄìLittlewood maximal operator was shown by Melas [248] to be the largest
root of the quadratic equation 12x2 ‚àí22x + 5 = 0. The strong maximal operator Ms is not weak
type (1,1), but it satisÔ¨Åes the substitute inequality dMs( f)(Œ±) ‚â§C

Rn |f(x)|
Œ±
(1 + log+ |f(x)|
Œ±
)n‚àí1 dx.
This result is due to Jessen, Marcinkiewicz, and Zygmund [176], but a geometric proof of it was
obtained by C¬¥ordoba and Fefferman [73].
The basic facts about the Fourier transform go back to Fourier [119]. The theory of distributions
was developed by Schwartz [314], [315]. For a concise introduction to the theory of distributions
we refer to H¬®ormander [160] and Yosida [382]. Homogeneous distributions were considered by
Riesz [295] in the study of the Cauchy problem in partial differential equations, although some
earlier accounts are found in the work of Hadamard. They were later systematically studied by
Gelfand and ÀáSilov [126], [127]. References on the uncertainty principle include the articles of
Fefferman [114] and Folland and Sitaram [118]. The best possible constant Bp in the Hausdorff‚Äì
Young inequality ‚à•1f ‚à•Lp‚Ä≤ (Rn) ‚â§Bp‚à•f‚à•Lp(Rn) when 1 ‚â§p ‚â§2 was shown by Beckner [21] to be
Bp = (p1/p(p‚Ä≤)‚àí1/p‚Ä≤)n/2. This best constant was previously obtained by Babenko [16] in the case
when p‚Ä≤ is an even integer.
A nice treatise of the spaces M p,q is found in H¬®ormander [159]. This reference also con-
tains Theorem 2.5.6, which is due to him. Theorem 2.5.16 is due to de Leeuw [94], but the proof
presented here is taken from Jodeit [178]. De Leeuw‚Äôs result in Exercise 2.5.9 says that periodic

172
2 Maximal Functions, Fourier Transform, and Distributions
elements of Mp(Rn) can be isometrically identiÔ¨Åed with elements of M (Tn), the latter being the
space of all multipliers on ‚Ñìp(Zn). The hint in Exercise 2.5.13 was suggested by M. Peloso.
Parts (b) and (c) of Proposition 2.6.7 are due to van der Corput [364] and are referred to in
the literature as van der Corput‚Äôs lemma. The reÔ¨Ånement in part (a) was subsequently obtained by
Arhipov, Karachuba, and ÀáCubarikov [8]. The treatment of these results in the text is based on the
article of Carbery, Christ, and Wright [53], which also investigates higher-dimensional analogues
of the theory. Precise asymptotics can be obtained for a variety of oscillatory integrals via the
method of stationary phase; see H¬®ormander [160]. References on oscillatory integrals include the
books of Titchmarsh [362], Erd¬¥elyi [107], Zygmund [388], [389], Stein [344], and Sogge [328].
The latter provides a treatment of Fourier integral operators.

Chapter 3
Fourier Series
Principles of Fourier series go back to ancient times. The attempts of the Pythagorean
school to explain musical harmony in terms of whole numbers embrace early ele-
ments of a trigonometric nature. The theory of epicycles in the Almagest of Ptolemy,
based on work related to the circles of Appolonius, contains ideas of astronomical
periodicities that we would interpret today as harmonic analysis. Early studies of
acoustical and optical phenomena, as well as periodic astronomical and geophysical
occurrences, provided a stimulus in the physical sciences toward the rigorous study
of expansions of periodic functions. This study is carefully pursued in this chapter.
The modern theory of Fourier series begins with attempts to solve boundary
value problems using trigonometric functions. The work of d‚ÄôAlembert, Bernoulli,
Euler, and Clairaut on the vibrating string led to the belief that it might be possible
to represent arbitrary periodic functions as sums of sines and cosines. Fourier an-
nounced belief in this possibility in his solution of the problem of heat distribution
in spatial bodies (in particular, for the cube T3) by expanding an arbitrary function
of three variables as a triple sine series. Fourier‚Äôs approach, although heuristic, was
appealing and eventually attracted attention. It was carefully studied and further de-
veloped by many scientists, but most notably by Laplace and Dirichlet, who were
the Ô¨Årst to investigate the validity of the representation of a function in terms of its
Fourier series. This is the main topic of study in this chapter.
3.1 Fourier CoefÔ¨Åcients
We discuss some basic facts of Fourier analysis on the torus Tn. Throughout this
chapter, n denotes the dimension, i.e., a Ô¨Åxed positive integer.
L. Grafakos, Classical Fourier Analysis, Graduate Texts in Mathematics 249,
DOI 10.1007/978-1-4939-1194-3 3, ¬© Springer Science+Business Media New York 2014
173

174
3 Fourier Series
3.1.1 The n-Torus Tn
The n-torus Tn is the cube [0,1]n with opposite sides identiÔ¨Åed. This means that
the points (x1,...,0,...,xn) and (x1,...,1,...,xn) are identiÔ¨Åed whenever 0 and 1
appear in the same coordinate. A more precise deÔ¨Ånition can be given as follows:
We say that x,y in Rn are equivalent and we write
x ‚â°y
(3.1.1)
if x ‚àíy ‚ààZn. Here Zn is the additive subgroup of all points in Rn with integer
coordinates. It is a simple fact that ‚â°is an equivalence relation that partitions Rn
into equivalence classes. The n-torus Tn is then deÔ¨Åned as the set Rn/Zn of all such
equivalence classes. When n = 1, this set can be geometrically viewed as a circle
by bending the line segment [0,1] so that its endpoints are brought together. When
n = 2, the identiÔ¨Åcation brings together the left and right sides of the unit square
[0,1]2 as well as the top and bottom sides. The resulting Ô¨Ågure is a two-dimensional
manifold embedded in R3 that looks like a donut. See Figure 3.1.
Fig. 3.1 The graph of the
two-dimensional torus T2.
x1
x3
x2
The n-torus is an additive group. The identity element of the group is 0, which
of course coincides with every ej = (0,...,0,1,0,...,0). To avoid multiple appear-
ances of the identity element in the group, we often think of the n-torus as the
set [‚àí1/2,1/2]n. Since the group Tn is additive, the inverse of an element x ‚ààTn
is denoted by ‚àíx. For example, ‚àí(1/3,1/4) ‚â°(2/3,3/4) on T2, or, equivalently,
‚àí(1/3,1/4)‚àí(2/3,3/4) ‚ààZ2.
The n-torus Tn can also be thought of as the following subset of Cn,
{(e2œÄix1,...,e2œÄixn) ‚ààCn : (x1,...,xn) ‚àà[0,1]n},
(3.1.2)
in a way analogous to which the unit interval [0,1] can be thought of as the unit
circle in C once 1 and 0 are identiÔ¨Åed.
Functions on Tn are functions f on Rn that satisfy f(x+m) = f(x) for all x ‚ààRn
and m ‚ààZn. Such functions are called 1-periodic in every coordinate. Haar mea-
sure on the n-torus is the restriction of n-dimensional Lebesgue measure to the set

3.1 Fourier CoefÔ¨Åcients
175
Tn = [0,1]n. This measure is still denoted by dx, while the measure of a set A ‚äÜTn
is denoted by |A|. Translation invariance of Lebesgue measure and the periodicity
of functions on Tn imply that for all integrable functions f on Tn, we have

Tn f(x)dx =

[‚àí1/2,1/2]n f(x)dx =

[a1,1+a1]√ó¬∑¬∑¬∑√ó[an,1+an] f(x)dx
(3.1.3)
for any real numbers a1,...,an. In view of periodicity, integration by parts on the
torus does not produce boundary terms; given f,g continuously differentiable func-
tions on Tn we have

Tn ‚àÇj f(x)g(x)dx = ‚àí

Tn ‚àÇjg(x) f(x)dx.
Elements of Zn are denoted by m = (m1,...,mn). For m ‚ààZn, we deÔ¨Åne the total
size of m to be the number |m| = (m2
1 +¬∑¬∑¬∑+m2
n)1/2. Recall that for x = (x1,...,xn)
and y = (y1,...,yn) in Rn,
x¬∑y = x1y1 +¬∑¬∑¬∑+xnyn
denotes the usual dot product. Finally, for x ‚ààTn, |x| denotes the usual Euclidean
norm of x. If we identify Tn with [‚àí1/2,1/2]n, then |x| can be interpreted as the
distance of the element x from the origin, and then we have 0 ‚â§|x| ‚â§‚àön/2 for all
x ‚ààTn.
Multi-indices are elements of (Z+ ‚à™{0})n. For a multi-index Œ± = (Œ±1,...,Œ±n),
we denote the partial derivative ‚àÇŒ±1
1 ¬∑¬∑¬∑‚àÇŒ±n
n f by ‚àÇŒ± f. The spaces C k(Tn) of con-
tinuously differentiable functions of order k, where k ‚ààZ+, are deÔ¨Åned as the sets
of functions œï for which ‚àÇŒ±œï exist and are continuous for all |Œ±| ‚â§k. When k = 0
we set C 0(Tn) = C (Tn) to be the space of continuous functions on Tn. The space
C ‚àû(Tn) of inÔ¨Ånitely differentiable functions on Tn is the union of all the C k(Tn).
All of these spaces are contained in Lp(Tn), which are nested, with L1(Tn) being
the largest.
3.1.2 Fourier CoefÔ¨Åcients
DeÔ¨Ånition 3.1.1. For a complex-valued function f in L1(Tn) and m in Zn, we deÔ¨Åne
1f(m) =

Tn f(x)e‚àí2œÄim¬∑xdx.
(3.1.4)
We call 1f(m) the mth Fourier coefÔ¨Åcient of f. We note that 1f(Œæ) is not deÔ¨Åned for
Œæ ‚ààRn \Zn, since the function x ‚Üíe‚àí2œÄiŒæ¬∑x is not 1-periodic in any coordinate and
therefore not well deÔ¨Åned on Tn. For a Ô¨Ånite Borel measure Œº on Tn and m ‚ààZn the
expression
1Œº(m) =

Tn e‚àí2œÄim¬∑xdŒº
(3.1.5)
is called the mth Fourier coefÔ¨Åcient of Œº.

176
3 Fourier Series
The Fourier series of f at x ‚ààTn is the series
‚àë
m‚ààZn
1f(m)e2œÄim¬∑x.
(3.1.6)
It is not clear at present in which sense and for which x ‚ààTn (3.1.6) converges. The
study of convergence of Fourier series is the main topic of study in this chapter.
We quickly recall the notation we introduced in Chapter 2. We denote by f the
complex conjugate of the function f, by #f the function #f(x) = f(‚àíx), and by œÑy( f)
the function œÑy( f)(x) = f(x‚àíy) for all y ‚ààTn. We mention some elementary prop-
erties of Fourier coefÔ¨Åcients.
Proposition 3.1.2. Let f, g be in L1(Tn). Then for all m,k ‚ààZn, Œª ‚ààC, y ‚ààTn, and
all multi-indices Œ± we have
(1) 
f +g(m) = 1f(m)+ 1g(m),
(2) 2
Œª f(m) = Œª 1f(m),
(3) 1f (m) = 1f(‚àím),
(4) 1#f (m) = 1f(‚àím),
(5)

œÑy( f)(m) = 1f(m)e‚àí2œÄim¬∑y ,
(6) (e2œÄik(¬∑) f)1(m) = 1f(m‚àík),
(7) 1f(0) =

Tn f(x)dx,
(8)
sup
m‚ààZn | 1f(m)| ‚â§
 f

L1(Tn) ,
(9)
3
f ‚àóg(m) = 1f(m)1g(m),
(10) 3
‚àÇŒ± f(m) = (2œÄim)Œ± 1f(m), whenever f ‚ààC Œ±.
Proof. The proof of properties (1)‚Äì(10) is rather easy and is left to the reader. We
only sketch the proof of (9). We have
3
f ‚àóg(m) =

Tn

Tn f(x‚àíy)g(y)e‚àí2œÄim¬∑(x‚àíy)e‚àí2œÄim¬∑y dydx = 1f(m)1g(m),
where the interchange of integrals is justiÔ¨Åed by the absolute convergence of the
integrals and Fubini‚Äôs theorem.
‚ñ°
Remark 3.1.3. The Fourier coefÔ¨Åcients have the following property. For a function
f1 on Tn1 and a function f2 on Tn2, the tensor function
( f1 ‚äóf2)(x1,x2) = f1(x1) f2(x2)

3.1 Fourier CoefÔ¨Åcients
177
is a periodic function on Tn1+n2 whose Fourier coefÔ¨Åcients are

f1 ‚äóf2(m1,m2) = 1f1(m1) 1f2(m2),
(3.1.7)
for all m1 ‚ààZn1 and m2 ‚ààZn2.
DeÔ¨Ånition 3.1.4. A trigonometric polynomial on Tn is a function of the form
P(x) = ‚àë
m‚ààZn
ame2œÄim¬∑x,
(3.1.8)
where {am}m‚ààZn is a Ô¨Ånitely supported sequence in Zn. The degree of P is the largest
number |q1|+¬∑¬∑¬∑+|qn| such that aq is nonzero, where q = (q1,...,qn). Observe that
in view of the orthonormality of the exponentials we have for all m ‚ààZn
1P(m) = am .
Example 3.1.5. If the sequence {am}m has only one nonzero term, then the trigono-
metric polynomial of DeÔ¨Ånition 3.1.4 reduces to a trigonometric monomial, which
has the form
P(x) = ae2œÄi(q1x1+¬∑¬∑¬∑+qnxn)
for some q = (q1,...,qn) ‚ààZn and a ‚ààC.
Let
P(x) = ‚àë
|m|‚â§N
ame2œÄim¬∑x = ‚àë
|m|‚â§N
1P(m)e2œÄim¬∑x
be a trigonometric polynomial on Tn and let Œº be a Ô¨Ånite Borel measure on Tn. Then
we have
(P‚àóŒº)(x) =

Tn ‚àë
|m|‚â§N
1P(m)e2œÄim¬∑(x‚àíy) dŒº(y) = ‚àë
|m|‚â§N
1P(m)1Œº(m)e2œÄim¬∑x.
(3.1.9)
In particular, if f is an integrable function on Tn we have
(P‚àóf)(x) =

Tn f(y) ‚àë
|m|‚â§N
1P(m)e2œÄim¬∑(x‚àíy) dy = ‚àë
|m|‚â§N
1P(m) 1f(m)e2œÄim¬∑x.
(3.1.10)
This implies that the partial sums
‚àë
|m|‚â§N
1f(m)e2œÄim¬∑x
of the Fourier series of f in (3.1.6) can be obtained by convolving f with the function
DN(x) = ‚àë
|m|‚â§N
e2œÄim¬∑x .
(3.1.11)
This function is called the Dirichlet kernel.

178
3 Fourier Series
3.1.3 The Dirichlet and Fej¬¥er Kernels
DeÔ¨Ånition 3.1.6. Let 0 ‚â§R < ‚àû. The square Dirichlet kernel on Tn is the function
Dn
R(x) = ‚àë
m‚ààZn
|mj|‚â§R
e2œÄim¬∑x .
(3.1.12)
The circular (or spherical) Dirichlet kernel on Tn is the function
‚ó¶Dn
R(x) = ‚àë
m‚ààZn
|m|‚â§R
e2œÄim¬∑x .
(3.1.13)
In dimension n = 1 these functions coincide and are denoted by
DR(x) = D1
R(x) =
‚ó¶
D1
R(x).
This function is called the Dirichlet kernel and coincides with DN(x) in (3.1.11)
when N ‚â§R < N +1 and N ‚ààZ+ ‚à™{0}; see Figure 3.2.
-0.4
-0.2
0.2
0.4
-2
2
4
6
8
10
Fig. 3.2 The graph of the Dirichlet kernel D5 plotted on the interval [‚àí1/2,1/2].
Both the square and circular (or spherical) Dirichlet kernels are trigonomet-
ric polynomials. The square Dirichlet kernel on Tn is equal to a product of one-
dimensional Dirichlet kernels, that is,
Dn
R(x1,...,xn) = DR(x1)¬∑¬∑¬∑DR(xn).
(3.1.14)
We have the following two equivalent ways to write the Dirichlet kernel DN:
DN(x) = ‚àë
|m|‚â§N
e2œÄim¬∑x = sin((2N +1)œÄx)
sin(œÄx)
,
(3.1.15)

3.1 Fourier CoefÔ¨Åcients
179
for x ‚àà[0,1]. To verify the validity of (3.1.15), we write
‚àë
|m|‚â§N
e2œÄim¬∑x = e‚àí2œÄiNx e2œÄi(2N+1)x ‚àí1
e2œÄix ‚àí1
= e2œÄi(N+1)x ‚àíe‚àí2œÄiNx
eœÄix(eœÄix ‚àíe‚àíœÄix)
= sin((2N +1)œÄx)
sin(œÄx)
.
It follows that for R ‚ààR+ ‚à™{0} we have
DR(x) = sin(œÄx(2[R]+1))
sin(œÄx)
.
(3.1.16)
It is reasonable to ask whether the family {DR}R>0 forms an approximate identity
as R ‚Üí‚àû. Using (3.1.15) we see that each DR is integrable over [‚àí1/2,1/2] and
has integral equal to 1. But it follows from Exercise 3.1.5 that ‚à•DR‚à•L1 ‚âàlogR as
R ‚Üí‚àû, and therefore property (i) in DeÔ¨Ånition 1.2.15 fails for DR. We conclude
that the family {DR}R>0 is not an approximate identity on T1, which signiÔ¨Åcantly
complicates the study of Fourier series. Consequently, the family {Dn
R}R>0 is not an
approximate identity on Tn, since ‚à•Dn
R‚à•L1(T1) ‚âà(logR)n. The same is true for the
family of circular (or spherical) Dirichlet kernels {
‚ó¶Dn
R}R>0. Although this is harder
to prove, it will be a consequence of the results in Section 4.2.
A typical situation encountered in analysis is that the means of a sequence behave
better than the original sequence. This fact led Ces`aro and independently Fej¬¥er to
consider the arithmetic means of the Dirichlet kernel in dimension 1, that is, the
expressions
FN(x) =
1
N +1

D0(x)+D1(x)+D2(x)+¬∑¬∑¬∑+DN(x)

.
(3.1.17)
The expression in (3.1.17) is in fact equal to the Fej¬¥er kernel given in Example 1.2.18.
We have the following identity concerning the kernel FN.
Proposition 3.1.7. For every nonnegative integer N the identity holds
FN(x) =
N
‚àë
j=‚àíN

1‚àí
| j|
N +1

e2œÄi jx =
1
N +1
sin(œÄ(N +1)x)
sin(œÄx)
2
(3.1.18)
for all x ‚ààT1. Thus 2
FN(m) = 1‚àí|m|
N+1 if |m| ‚â§N and zero otherwise.
Proof. The fact that the expression in (3.1.17) is equal to the middle term in (3.1.18)
is a consequence of the trivial calculation:
1
N +1
N
‚àë
k=0
Dk(x) =
1
N +1
N
‚àë
k=0 ‚àë
| j|‚â§k
e2œÄi jx = ‚àë
| j|‚â§N
#{k ‚ààZ : | j| ‚â§k ‚â§N}
N +1
e2œÄi jx .
To verify the second equality in (3.1.18) we use the simple geometric series identity
1+r +r2 +¬∑¬∑¬∑+rN = 1‚àírN+1
1‚àír
to write for x Ã∏= 0

180
3 Fourier Series
N
‚àë
j=1
e2œÄi jx = e2œÄi(N+1)x ‚àí1
e2œÄix ‚àí1
‚àí1 = eiœÄ(N+1)x
eiœÄx
eœÄi(N+1)x ‚àíe‚àíœÄi(N+1)x
eœÄix ‚àíe‚àíœÄix
‚àí1
from which it follows that
N
‚àë
j=1
| j|e2œÄi jx = 1
2œÄi
d
dx

eiœÄNx sin(œÄ(N +1)x)
sin(œÄx)

.
(3.1.19)
Likewise we prove that
‚àí1
‚àë
j=‚àíN
| j|e2œÄi jx = ‚àí1
2œÄi
d
dx

e‚àíiœÄNx sin(œÄ(N +1)x)
sin(œÄx)

.
(3.1.20)
Adding (3.1.19) and (3.1.20) we deduce
‚àë
| j|‚â§N
| j|e2œÄi jx = 1
œÄ
d
dx
sin(œÄNx)sin(œÄ(N +1)x)
sin(œÄx)

.
(3.1.21)
Multiplying (3.1.21) by ‚àí
1
N+1 and adding DN(x) we obtain
N
‚àë
j=‚àíN

1‚àí
| j|
N +1

e2œÄi jx = sin(œÄ(2N +1)x)
sin(œÄx)
‚àí1
œÄ
d
dx

sin(œÄNx) sin(œÄ(N +1)x)
(N +1)sin(œÄx)

.
Writing the preceding expression on the right as
(N+1)sin(œÄ(N+1)x)cos(œÄNx)sin(œÄx)+(N+1)cos(œÄ(N+1)x)sin(œÄNx)sin(œÄx)
(N+1)sin2(œÄx)
‚àí1
œÄ
d
dx
	
sin(œÄNx)sin(œÄ(N+1)x)

sin(œÄx)‚àí
	
sin(œÄNx)sin(œÄ(N+1)x)

œÄ cos(œÄx)
(N+1)sin2(œÄx)
,
computing the derivative of the expression in the curly brackets, and simplifying,
we Ô¨Ånally obtain that
N
‚àë
j=‚àíN

1‚àí
| j|
N +1

e2œÄi jx =
1
N +1
sin(œÄ(N +1)x)
sin(œÄx)
2
.
(3.1.22)
This proves the second identity in (3.1.18).
‚ñ°
DeÔ¨Ånition 3.1.8. Let N be a nonnegative integer. The function FN on T1 given by
(3.1.22) is called the Fej¬¥er kernel.
The Fej¬¥er kernel Fn
N on Tn is deÔ¨Åned as the product of the 1-dimensional Fej¬¥er
kernels, or as the average of the product of the Dirichlet kernels in each variable,
precisely, F1
N(x) = FN(x) and

3.1 Fourier CoefÔ¨Åcients
181
Fn
N(x1,...,xn) =
n
‚àè
j=1
FN(xj)
=
n
‚àè
j=1

1
N +1
N
‚àë
k=0
Dk(xj)

=
1
(N +1)n
N
‚àë
k1=0
...
N
‚àë
kn=0
Dk1(x1)¬∑¬∑¬∑Dkn(xn).
Note that Fn
N is a trigonometric polynomial of degree nN.
Remark 3.1.9. Using the identities for FN in (3.1.18), we may write for all N ‚â•0
Fn
N(x1,...,xn) = ‚àë
m‚ààZn
|mj|‚â§N

1‚àí|m1|
N +1

¬∑¬∑¬∑

1‚àí|mn|
N +1

e2œÄim¬∑x
(3.1.23)
=
1
(N +1)n
n
‚àè
j=1
sin(œÄ(N +1)xj)
sin(œÄxj)
2
,
(3.1.24)
thus Fn
N ‚â•0. Observe that Fn
0 (x) = 1 for all x ‚ààTn and that Fn
N(0) = (N +1)n.
Proposition 3.1.10. The family of Fej¬¥er kernels {Fn
N}‚àû
N=0 is an approximate identity
on Tn.
Proof. Since Fn
N ‚â•0 we have that ‚à•Fn
N‚à•L1 =

Tn Fn
N dx. Also

Tn Fn
N dx = 1, in view
of identity (3.1.23). Thus properties (i) and (ii) of approximate identities (according
to DeÔ¨Ånition 1.2.15) hold. To prove property (iii) of the deÔ¨Ånition we make use of
identity (3.1.24). Using the fact that 1 ‚â§
|t|
|sint| ‚â§œÄ
2 when |t| ‚â§œÄ
2 , we obtain
FN(x) ‚â§
1
N +1 min
(N +1)|œÄx|
|sin(œÄx)| ,
1
|sin(œÄx)|
2
‚â§
1
N +1
œÄ2
4 min

N +1, 1
|œÄx|
2
when |x| ‚â§1
2. This implies that for Œ¥ > 0 we have

Œ¥‚â§|x|‚â§1
2
FN(x)dx ‚â§
1
N +1
œÄ2
4

Œ¥‚â§|x|‚â§1
2
dx
|œÄŒ¥|2 ‚â§
1
4Œ¥ 2
1
N +1 ‚Üí0
as N ‚Üí‚àû. In higher dimensions, given x = (x1,...,xn) ‚àà[‚àí1/2,1/2]n with |x| ‚â•Œ¥,
there is a j ‚àà{1,...,n} such that |xj| ‚â•Œ¥/‚àön and thus

x‚ààTn
|x|‚â•Œ¥
Fn
N(x)dx ‚â§
n
‚àë
j=1

|x j|‚â•Œ¥
‚àön
FN(xj)dxj‚àè
kÃ∏= j

T1 FN(xk)dxk ‚â§
n
4(Œ¥/‚àön)2
1
N +1 ‚Üí0.
This proves the claim.
‚ñ°

182
3 Fourier Series
Exercises
3.1.1. Identify T1 with [‚àí1/2,1/2] and let h(t) be an integrable function on T1.
(a) If h(t) ‚â•0 is even, show that 1h(m) is real and |1h(m)| ‚â§1h(0) for all m ‚ààZ.
(b) If h(t) is odd and h(t) ‚â•0 on [0,1/2), then i1h(m) is real and |1h(m)| ‚â§im1h(1)
for all m ‚ààZ.
3.1.2. Suppose that h is a periodic integrable function on [‚àí1/2,1/2) with integral
zero. DeÔ¨Åne another periodic function H on T1 by setting
H(x) =
 x
‚àí1/2 h(t)dt .
Compute 1H(m) in terms of 1h(m) for m ‚ààZ.
3.1.3. Suppose that {gŒµ}Œµ>0 is an approximate identity on Rn as Œµ ‚Üí0 and let
GŒµ(x) = ‚àë
‚Ñì‚ààZn
gŒµ(x+‚Ñì).
Show that the family {GŒµ}Œµ>0 is an approximate identity on Tn.
3.1.4. On T1 deÔ¨Åne the de la Vall¬¥ee Poussin kernel
VN(x) = 2F2N+1(x)‚àíFN(x).
(a) Show that the sequence VN is an approximate identity.
(b) Prove that 2
VN(m) = 1 when |m| ‚â§N +1, and 2
VN(m) = 0 when |m| ‚â•2N +2.
3.1.5. (a) Show that for all |t| ‚â§œÄ
2 we have

1
sin(t) ‚àí1
t
 ‚â§1‚àí2
œÄ .
(b) Let DN be the Dirichlet kernel on T1. Prove that for N ‚ààZ+ we have
4
œÄ2
N
‚àë
k=1
1
k ‚â§
DN

L1 ‚â§3‚àí2
œÄ + 4
œÄ2
N
‚àë
k=1
1
k .
Conclude that the numbers ‚à•DN‚à•L1 grow logarithmically as N ‚Üí‚àûand therefore
the family {DN}‚àû
N=1 is not an approximate identity on T1. The numbers ‚à•DN‚à•L1,
N = 1,2,... are called the Lebesgue constants.

Hint: Part (a): Show that the derivative of
1
sin(t) ‚àí1
t is nonnegative on (0, œÄ
2 ], or
equivalently prove that tan(t)sin(t) ‚â•t2 on (0, œÄ
2 ]; this is a consequence of the in-
equality
"
sin(t)tan(t) ‚â•2(
1
sin(t) +
1
tan(t))‚àí1 = 2tan( t
2) ‚â•t. Part (b): Replace DN(t)
by sin((2N+1)œÄt)
œÄt
and estimate the difference using part (a).


3.2 Reproduction of Functions from Their Fourier CoefÔ¨Åcients
183
3.1.6. Let DN be the Dirichlet kernel on T1. Prove that for all 1 < p < ‚àûthere exist
two constants Cp,cp > 0 such that
cp (2N +1)1/p‚Ä≤ ‚â§
DN

Lp ‚â§Cp (2N +1)1/p‚Ä≤.

Hint: Consider the two closest zeros of DN near the origin and split the integral
into the intervals thus obtained.

3.1.7. The Poisson kernel on Tn is the function
Pr1,...,rn(x) = ‚àë
m‚ààZn
r|m1|
1
¬∑¬∑¬∑r|mn|
n
e2œÄim¬∑x
and is deÔ¨Åned for 0 < r1,...,rn < 1. Prove that Pr1,...,rn can be written as
Pr1,...,rn(x1,...,xn) =
n
‚àè
j=1
Re
1+r je2œÄix j
1‚àír je2œÄix j

=
n
‚àè
j=1
1‚àír2
j
1‚àí2r j cos(2œÄxj)+r2
j
,
and conclude that Pr,...,r(x) is an approximate identity as r ‚Üë1.
3.2 Reproduction of Functions from Their Fourier CoefÔ¨Åcients
We can obtain very interesting results using the Fej¬¥er kernel.
Proposition 3.2.1. The set of trigonometric polynomials is dense in Lp(Tn) for 1 ‚â§
p < ‚àû.
Proof. Given f in Lp(Tn) for 1 ‚â§p < ‚àû, consider f ‚àóFn
N. Clearly f ‚àóFn
N is also a
trigonometric polynomial. In view of Theorem 1.2.19 (1), f ‚àóFn
N converges to f in
Lp as N ‚Üí‚àû.
‚ñ°
Corollary 3.2.2. (Weierstrass approximation theorem for trigonometric polyno-
mials) Every continuous function on the torus is a uniform limit of trigonometric
polynomials.
Proof. Since f is continuous on Tn, which is a compact set, Theorem 1.2.19 (2)
gives that f ‚àóFn
N converges uniformly to f as N ‚Üí‚àû. But f ‚àóFn
N is a trigonomet-
ric polynomial, and so we conclude that every continuous function on Tn can be
uniformly approximated by trigonometric polynomials.
‚ñ°
3.2.1 Partial sums and Fourier inversion
We now deÔ¨Åne the partial sums of Fourier series.

184
3 Fourier Series
DeÔ¨Ånition 3.2.3. Let R ‚â•0 and N ‚ààZ+ ‚à™{0}. The expressions
( f ‚àóDn
R)(x) = ‚àë
m‚ààZn
|mj|‚â§R
1f(m)e2œÄim¬∑x
are called the square partial sums of the Fourier series of f. Then the expressions
( f ‚àó
‚ó¶Dn
R)(x) = ‚àë
m‚ààZn
|m|‚â§R
1f(m)e2œÄim¬∑x
are called the circular (or spherical) partial sums of the Fourier series of f. The
expressions
( f ‚àóFn
N)(x) = ‚àë
m‚ààZn
|mj|‚â§N

1‚àí|m1|
N +1

¬∑¬∑¬∑

1‚àí|mn|
N +1

1f(m)e2œÄim¬∑x
are called the square Ces`aro means (or square Fej¬¥er means) of f.
Finally, for R ‚â•0 the expressions
( f ‚àó
‚ó¶Fn
R )(x) = ‚àë
m‚ààZn
|m|‚â§R

1‚àí|m|
R

1f(m)e2œÄim¬∑x
are called the circular Ces`aro means (or circular Fej¬¥er means) of f.
Observe that f ‚àó
‚ó¶Fn
R is equal to the average of the expressions f ‚àó
‚ó¶Dn
r in the
following sense:
( f ‚àó
‚ó¶Fn
R )(x) = 1
R
 R
0 ( f ‚àó
‚ó¶Dn
r)(x)dr.
This is analogous to the fact that the Fej¬¥er kernel FN is the average of the Dirichlet
kernels D0, D1,...,DN.
A fundamental problem is in what sense the partial sums of the Fourier series
converge back to the function as R ‚Üí‚àûor N ‚Üí‚àû. This problem is of central im-
portance in harmonic analysis and is in part investigated in this chapter.
We now ask the question whether the Fourier coefÔ¨Åcients uniquely determine the
function. The answer is afÔ¨Årmative and simple.
Proposition 3.2.4. If f,g ‚ààL1(Tn) satisfy 1f(m) = 1g(m) for all m in Zn, then
f = g a.e.
Proof. By linearity of the problem, it sufÔ¨Åces to assume that g = 0. If 1f(m) = 0
for all m ‚ààZn, DeÔ¨Ånition 3.2.3 implies that Fn
N ‚àóf = 0 for all N ‚ààZ+. In view of
Proposition 3.1.10, the sequence {Fn
N}N‚ààZ+ is an approximate identity as N ‚Üí‚àû.
Therefore,
f ‚àíFn
N ‚àóf

L1 ‚Üí0
as N ‚Üí‚àû; hence ‚à•f‚à•L1 = 0, from which we conclude that f = 0 a.e.
‚ñ°

3.2 Reproduction of Functions from Their Fourier CoefÔ¨Åcients
185
A useful consequence of the result just proved is the following.
Proposition 3.2.5. (Fourier inversion) Suppose that f ‚ààL1(Tn) and that
‚àë
m‚ààZn
| 1f(m)| < ‚àû.
Then
f(x) = ‚àë
m‚ààZn
1f(m)e2œÄim¬∑x
a.e.,
(3.2.1)
and therefore f is almost everywhere equal to a continuous function.
Proof. It is straightforward to check that both functions in (3.2.1) are well deÔ¨Åned
and have the same Fourier coefÔ¨Åcients. Therefore, they must be almost everywhere
equal by Proposition 3.2.4. Moreover, the function on the right in (3.2.1) is every-
where continuous.
‚ñ°
3.2.2 Fourier series of square summable functions
Let H be a separable Hilbert space with complex inner product ‚ü®¬∑|¬∑‚ü©. Recall that
a subset E of H is called orthonormal if ‚ü®f |g‚ü©= 0 for all f, g in E with f Ã∏= g,
while ‚ü®f | f‚ü©= 1 for all f in E. A complete orthonormal system is a subset of H
having the additional property that the only vector orthogonal to all of its elements
is the zero vector. We summarize basic properties about orthonormal systems in the
proposition below (see [307]).
Proposition 3.2.6. Let H be a separable Hilbert space and let {œïk}k‚ààZ be an or-
thonormal system in H. Then the following are equivalent:
(1) {œïk}k‚ààZ is a complete orthonormal system.
(2) For every f ‚ààH we have
 f
2
H = ‚àë
k‚ààZ
|‚ü®f |œïk‚ü©|2 .
(3) For every f ‚ààH we have
f = lim
N‚Üí‚àû‚àë
|k|‚â§N
‚ü®f |œïk‚ü©œïk ,
where the series converges in H.
Now consider the Hilbert space space L2(Tn) with inner product
4
f |g
5
=

Tn f(t)g(t)dt .

186
3 Fourier Series
Let œïm be the sequence of functions Œæ ‚Üíe2œÄim¬∑Œæ indexed by m ‚ààZn. The orthonor-
mality of the sequence {œïm} is a consequence of the following simple but crucial
identity:

[0,1]n e2œÄim¬∑x e2œÄik¬∑x dx =

1
when m = k,
0
when m Ã∏= k.
The completeness of the sequence {œïm} is also evident. Since
4
f |œïm
5
= 1f(m) for
all f ‚ààL2(Tn), it follows from Proposition 3.2.4 that if
4
f |œïm
5
= 0 for all m ‚ààZn,
then f = 0 a.e.
The next result is a consequence of Proposition 3.2.6.
Proposition 3.2.7. The following are valid for f,g ‚ààL2(Tn):
(1) (Plancherel‚Äôs identity)
 f
2
L2 = ‚àë
m‚ààZn
| 1f(m)|2 .
(2) The function f(t) is a.e. equal to the L2(Tn) limit of the sequence
lim
M‚Üí‚àû‚àë
|m|‚â§M
1f(m)e2œÄim¬∑t .
(3) (Parseval‚Äôs relation)

Tn f(t)g(t)dt = ‚àë
m‚ààZn
1f(m)1g(m).
(4) The map f ‚Üí{ 1f(m)}m‚ààZn is an isometry from L2(Tn) onto ‚Ñì2.
(5) For all k ‚ààZn we have
2
fg(k) = ‚àë
m‚ààZn
1f(m)1g(k ‚àím) = ‚àë
m‚ààZn
1f(k ‚àím)1g(m).
Proof. (1) and (2) follow from the corresponding statements in Proposition 3.2.6.
Notice that both sides of (3) converge by the Cauchy-Schwarz inequality. Parseval‚Äôs
relation (3) follows from polarization. By this we mean the following procedure.
First replace f by f +g in (1) and expand the squares to obtain
‚à•f‚à•2
L2 +‚à•g‚à•2
L2 +2Re‚ü®f |g‚ü©=‚à•f +g‚à•2
L2
= ‚àë
m‚ààZn
| 1f(m)+ 1g(m)|2
= ‚àë
m‚ààZn
| 1f(m)|2 + ‚àë
m‚ààZn
|1g(m)|2 +2Re ‚àë
m‚ààZn
1f(m)1g(m)
and from this it follows that the real parts of the expressions in (3) are equal. Next
replace f by f +ig in (1) and expand the squares. Using Re(‚àíiw) = Imw we obtain

3.2 Reproduction of Functions from Their Fourier CoefÔ¨Åcients
187
‚à•f‚à•2
L2 +‚à•g‚à•2
L2 +2Im‚ü®f |g‚ü©=‚à•f +ig‚à•2
L2
= ‚àë
m‚ààZn
| 1f(m)+i 1g(m)|2
= ‚àë
m‚ààZn
| 1f(m)|2 + ‚àë
m‚ààZn
|1g(m)|2 +2Im ‚àë
m‚ààZn
1f(m)1g(m),
and thus the imaginary parts of the expressions in (3) are equal. Thus (3) holds.
Next we prove (4). We already know that the map f ‚Üí{ 1f(m)}m‚ààZn is an injective
isometry. It remains to show that it is onto. Given a square summable sequence
{am}m‚ààZn of complex numbers, deÔ¨Åne
fN(t) = ‚àë
|m|‚â§N
ame2œÄim¬∑t.
Observe that fN is a Cauchy sequence in L2(Tn) and it therefore converges to some
f ‚ààL2(Tn). Then we have 1f(m) = am for all m ‚ààZn. Finally, (5) is a consequence
of (3) and Proposition 3.1.2 (6) and (3).
‚ñ°
3.2.3 The Poisson Summation Formula
We end this section with an important result that connects Fourier analysis on the
torus with Fourier analysis on Rn. Suppose that f is an integrable function on Rn
and let 1f be its Fourier transform. Restrict 1f on Zn and form the ‚ÄúFourier series‚Äù
(assuming that it converges)
‚àë
m‚ààZn
1f(m)e2œÄim¬∑x.
What does this series represent? Since the preceding function is 1-periodic in every
variable, it follows that it cannot be equal to f, unless f is itself periodic. However,
it should not come as a surprise that it is in fact equal to the periodization of f
on Rn. In other words, the Fourier expansion of a function on Rn reproduces the
periodization of the function.
Theorem 3.2.8. (Poisson summation formula) Let f be a continuous function on
Rn which satisÔ¨Åes for some C,Œ¥ > 0 and for all x ‚ààRn
| f(x)| ‚â§C(1+|x|)‚àín‚àíŒ¥,
and whose Fourier transform 1f restricted on Zn satisÔ¨Åes
‚àë
m‚ààZn
| 1f(m)| < ‚àû.
(3.2.2)

188
3 Fourier Series
Then for all x ‚ààRn we have
‚àë
m‚ààZn
1f(m)e2œÄim¬∑x = ‚àë
k‚ààZn
f(x+k),
(3.2.3)
and in particular
‚àë
m‚ààZn
1f(m) = ‚àë
k‚ààZn
f(k).
Proof. DeÔ¨Åne a 1-periodic function on Tn by setting
F(x) = ‚àë
k‚ààZn
f(x+k).
It is straightforward to verify that ‚à•F‚à•L1([0,1]n) = ‚à•f‚à•L1(Rn), thus F lies in L1(Tn). We
prove that the sequence of the Fourier coefÔ¨Åcients of F coincides with the restriction
of the Fourier transform of f on Zn. This follows from the calculation
1F(m) =

Tn ‚àë
k‚ààZn
f(x+k)e‚àí2œÄim¬∑x dx
= ‚àë
k‚ààZn

Tn f(x+k)e‚àí2œÄim¬∑x dx
= ‚àë
k‚ààZn

[‚àí1
2 , 1
2 ]n‚àík f(x)e‚àí2œÄim¬∑x dx
=

Rn f(x)e‚àí2œÄim¬∑x dx
= 1f(m),
in which the interchange of the sum and the integral is justiÔ¨Åed by the Weierstrass
M-test of uniform convergence of series, since
‚àë
k‚ààZn
1
(1+|k +x|)n+Œ¥ ‚â§‚àë
k‚ààZn
(1+‚àön)n+Œ¥
(1+‚àön+|k +x|)n+Œ¥ ‚â§‚àë
k‚ààZn
Cn,Œ¥
(1+|k|)n+Œ¥ < ‚àû,
where we used |k + x| ‚â•|k| ‚àí|x| ‚â•|k| ‚àí‚àön. This calculation also shows that F is
the sum of a uniformly convergent series of continuous functions on [0,1]n, thus
it is itself continuous. It follows that (3.2.2) holds with |1F(m)| in place of | 1f(m)|.
Hence, Proposition 3.2.5 applies, and given the fact that F is continuous, it yields
conclusion (3.2.3) for all x ‚ààTn and, by periodicity, for all x ‚ààRn.
‚ñ°
Example 3.2.9. We have seen earlier (Exercise 2.2.11) that the following identity
gives the Fourier transform of the Poisson kernel in Rn:
(e‚àí2œÄ|x|)1(Œæ) = Œì ( n+1
2 )
œÄ
n+1
2
1
(1+|Œæ|2)
n+1
2
.

3.2 Reproduction of Functions from Their Fourier CoefÔ¨Åcients
189
The Poisson summation formula yields the identity
Œì ( n+1
2 )
œÄ
n+1
2
‚àë
k‚ààZn
Œµ‚àín
(1+ |k+x|2
Œµ2
)
n+1
2
= ‚àë
m‚ààZn
e‚àí2œÄŒµ|m|e‚àí2œÄim¬∑x
(3.2.4)
which implies
Œì ( n+1
2 )
œÄ
n+1
2
‚àë
k‚ààZn
1
(1+|k|2)
n+1
2
= ‚àë
m‚ààZn
e‚àí2œÄ|m| .
(3.2.5)
It follows from (3.2.4) that
‚àë
k‚ààZn\{0}
1
(Œµ2 +|k|2)
n+1
2
= 1
Œµ
 œÄ
n+1
2
Œì ( n+1
2 ) ‚àë
m‚ààZn
e‚àí2œÄŒµ|m| ‚àí1
Œµn

,
from which we obtain the identity
‚àë
k‚ààZn\{0}
1
|k|n+1 = lim
Œµ‚Üí0
1
Œµ
 œÄ
n+1
2
Œì ( n+1
2 ) ‚àë
m‚ààZn
e‚àí2œÄŒµ|m| ‚àí1
Œµn

.
(3.2.6)
The limit in (3.2.6) can be easily calculated in dimension 1 using that
lim
Œ¥‚Üí0
œÄ2
Œ¥
1+e‚àí2Œ¥
1‚àíe‚àí2Œ¥ ‚àí1
Œ¥

= œÄ2
3 ,
and this yields
‚àë
kÃ∏=0
1
k2 = œÄ2
3 .
Also, in dimension 1, from (3.2.5) we obtain the related identity
‚àë
k‚ààZ
1
1+k2 = œÄ ‚àë
m‚ààZ
e‚àí2œÄ|m| = œÄ 1+e‚àí2œÄ
1‚àíe‚àí2œÄ .
Example 3.2.10. Let 0 < Re Œ± < n. We introduce a smooth function 1Œ¶(Œæ) which is
equal to 1 on the ball |Œæ| ‚â§1 and vanishes outside the ball |Œæ| ‚â§2. We investigate
the behavior as x ‚Üí0 of the expression
lim
R‚Üí‚àû
‚àë
m‚ààZn\{0}
e2œÄim¬∑x
|m|Œ±
1Œ¶
m
R

when x ‚àà[‚àí1
2, 1
2)n \{0}. As in Example 2.4.9, let Œ∑ be a smooth radial function on
Rn that is equal to 1 outside the ball B(0,1/2) and vanishes on the ball B(0,1/4)
and deÔ¨Åne
g = (Œ∑(Œæ)|Œæ|‚àíŒ±)1.

190
3 Fourier Series
Let Œ¶Œ¥(x) = Œ¥ ‚àínŒ¶(x/Œ¥). The Poisson summation formula (Theorem 3.2.8) gives
‚àë
k‚ààZn\{0}
e2œÄik¬∑x
|k|Œ±
1Œ¶
 k
R

= ‚àë
k‚ààZn
Œ∑(k)e2œÄik¬∑x
|k|Œ±
1Œ¶
 k
R

= (g‚àóŒ¶1/R)(x)+
‚àë
m‚ààZn\{0}
(g‚àóŒ¶1/R)(x+m).
It was shown in Example 2.4.9 that g(y) decays faster than the reciprocal of any
polynomial at inÔ¨Ånity and is equal to œÄŒ±‚àín
2Œì ( n‚àíŒ±
2 )Œì ( Œ±
2 )‚àí1|y|Œ±‚àín + h(y), where h
is a smooth function on Rn. Since x Ã∏= 0, it follows that g is smooth in a small rela-
tively compact neighborhood of x and, since {Œ¶1/R}R>0 is an approximate identity,
Theorem 1.2.19 (2) yields that (g‚àóŒ¶1/R)(x) ‚Üíg(x) as R ‚Üí‚àû. Assume for a moment
that
lim
R‚Üí‚àû
‚àë
m‚ààZn\{0}
(g‚àóŒ¶1/R)(x+m) =
‚àë
m‚ààZn\{0}
lim
R‚Üí‚àû(g‚àóŒ¶1/R)(x+m).
(3.2.7)
Since x + m does not vanish for any m ‚ààZn \ {0}, the function g is smooth in a
relatively compact neighborhood of x + m, and thus (g ‚àóŒ¶1/R)(x + m) ‚Üíg(x + m)
as R ‚Üí‚àû. Consequently, the sum on the right in (3.2.7) is equal to
‚àë
m‚ààZn\{0}
g(x+m).
We conclude that
lim
R‚Üí‚àû
‚àë
m‚ààZn\{0}
e2œÄim¬∑x
|m|Œ±
1Œ¶
m
R

= œÄŒ±‚àín
2Œì ( n‚àíŒ±
2 )
Œì ( Œ±
2 )
|x|Œ±‚àín +h1(x),
where h1 is a C ‚àûfunction on [‚àí1
2, 1
2)n given by
h1(t) = h(t)+
‚àë
m‚ààZn\{0}
g(t +m).
We now explain the passage of the limit inside the sum in (3.2.7). This is a con-
sequence of the Lebesgue dominated convergence theorem, provided we know that
|(g‚àóŒ¶1/R)(x+m)| ‚â§
C
|m|n+1 ,
|m| > 5‚àön
(3.2.8)
for some constant C independent of R ‚â•1 and of m. Indeed, the expression on the
left of this inequality is bounded by I +II, where
I = Cn,Œ±

|x+m‚àíy|‚â§2‚àön |x+m‚àíy|Œ±‚àín
Rn
(1+R|y|)2n+2 dy
II = Cn,Œ±

|x+m‚àíy|‚â•2‚àön
1
(1+|x+m‚àíy|)2n+2
Rn
(1+R|y|)2n+2 dy.

3.2 Reproduction of Functions from Their Fourier CoefÔ¨Åcients
191
In I we have
1+R|y| ‚â•R|x+m|‚àíR|x+m‚àíy| ‚â•R|m|‚àí1
2R‚àön‚àí2R‚àön ‚â•1
2R|m|,
hence
I ‚â§C‚Ä≤
n,Œ±R‚àín‚àí2|m|‚àí2n‚àí2 ‚â§C‚Ä≤
n,Œ±|m|‚àí2n‚àí2 .
In II we use
(1+|x+m‚àíy|)n+1(1+R|y|)n+1 ‚â•(1+|m|)n+1
while the term left produces a convergent integral, which is uniformly bounded in
R ‚â•1. This proves (3.2.8).
Exercises
3.2.1. On T1 let P be a trigonometric polynomial of degree N > 0. Show that P has
at most 2N zeros. Construct a trigonometric polynomial with exactly 2N zeros.
3.2.2. (Hausdorff‚ÄìYoung inequality) Prove that when f ‚ààLp(Tn), 1 ‚â§p ‚â§2, the
sequence of Fourier coefÔ¨Åcients of f is in ‚Ñìp‚Ä≤(Zn) and

‚àë
m‚ààZn
| 1f(m)|p‚Ä≤1/p‚Ä≤
‚â§
f

Lp(Tn).
Also observe that 1 is the best constant in the preceding inequality.
3.2.3. Use without proof that there exists a constant C > 0 such that for all t ‚ààR we
have

N
‚àë
k=2
eiklogkeikt
 ‚â§C
‚àö
N,
N = 2,3,4,...,
to construct an example of a continuous function g on T1 with
‚àë
m‚ààZ
|1g(m)|q = ‚àû
for all q < 2. Thus the Hausdorff‚ÄìYoung inequality of Exercise 3.2.2 fails for p > 2.

Hint: Consider g(x) = ‚àë‚àû
k=2
eiklogk
k1/2(logk)2 e2œÄikx. For a proof of the previous estimate,
see Zygmund [388, Theorem (4.7) p. 199].

3.2.4. (S. Bernstein) Let P(x) be a trigonometric polynomial of degree N on T1.
Prove that ‚à•P‚Ä≤‚à•L‚àû‚â§4œÄN‚à•P‚à•L‚àû.

Hint: Prove Ô¨Årst that P‚Ä≤(x)/2œÄiN is equal to

(e‚àí2œÄiN(¬∑)P)‚àóFN‚àí1

(x)e2œÄiNx ‚àí

(e2œÄiN(¬∑)P)‚àóFN‚àí1

(x)e‚àí2œÄiNx
and then take L‚àûnorms.


192
3 Fourier Series
3.2.5. (Fej¬¥er and F. Riesz) Let P(Œæ) = ‚àëN
k=‚àíN ake2œÄikŒæ be a trigonometric polyno-
mial on T1 of degree N such that P(Œæ) > 0 for all Œæ. Prove that there exists a trigono-
metric polynomial Q(Œæ) of the form ‚àëN
k=0 bke2œÄikŒæ such that P(Œæ) = |Q(Œæ)|2.

Hint: Since P ‚â•0 the complex-variable polynomial R(z) = ‚àëN
k=‚àíN akzk+N must
satisfy R(z) = z2NR(1/z), and thus it must have N zeros inside the unit circle and
the other N outside. Therefore we may write R(z) = aN ‚àès
k=1(z ‚àízk)rk(z ‚àí1/zk)rk
for some 0 < |zk| < 1 and rk ‚â•1 with ‚àës
k=1 rk = N. Then take z = e2œÄiŒæ.

3.2.6. Let g be a function on Rn that satisÔ¨Åes |g(x)| + |1g(x)| ‚â§C(1 + |x|)‚àín‚àíŒ¥ for
some C,Œ¥ > 0 and all x ‚ààRn. Prove that
Œª n ‚àë
m‚ààZn
1g(Œªm+Œ±)e2œÄix¬∑(m+ Œ±
Œª ) = ‚àë
k‚ààZn
g
x+k
Œª

e‚àí2œÄi k¬∑Œ±
Œª
for any x,Œ± ‚ààRn and Œª > 0.
3.2.7. Verify the following identity when 0 < r < 1 and x ‚ààRn
Œì ( n+1
2 )
œÄ
n+1
2
‚àë
k‚ààZn
1
2œÄ log 1
r

( 1
2œÄ log 1
r )2 +|x‚àík|2 n+1
2
= ‚àë
m‚ààZn
r|m|e2œÄim¬∑x .
In the special case n = 1 and x ‚ààR we have
1
œÄ ‚àë
k‚ààZ
1
2œÄ log 1
r
( 1
2œÄ log 1
r )2 +|x‚àík|2 =
1‚àír2
1‚àí2rcos(2œÄx)+r2 .

Hint: Use identity (3.2.4) and Exercise 3.1.7 when n = 1.

3.2.8. Let Œ≥ ‚ààR and Œª > 0. Show that
‚àë
k‚ààZ
cos(2œÄkŒ≥)
Œª 2 +k2
= œÄ
Œª
cosh(2œÄŒª(Œ≥ ‚àí[Œ≥]‚àí1
2))
sinh(œÄŒª)
.

Hint: Use Exercise 3.2.6 when n = 1 with x = 0, Œ± = ‚àíŒ≥Œª, g(x) = 1
œÄ
1
1+x2 and sum
in m.

3.3 Decay of Fourier CoefÔ¨Åcients
In this section we investigate the interplay between the smoothness of a function and
the decay of its Fourier coefÔ¨Åcients.

3.3 Decay of Fourier CoefÔ¨Åcients
193
3.3.1 Decay of Fourier CoefÔ¨Åcients of Arbitrary Integrable
Functions
We begin with the classical result asserting that the Fourier coefÔ¨Åcients of any inte-
grable function tend to zero at inÔ¨Ånity. One should compare the following proposi-
tion with Proposition 2.2.17.
Proposition 3.3.1. (Riemann‚ÄìLebesgue lemma) Given a function f in L1(Tn), we
have that | 1f(m)| ‚Üí0 as |m| ‚Üí‚àû.
Proof. Given f ‚ààL1(Tn) and Œµ > 0, let P be a trigonometric polynomial such that
‚à•f ‚àíP‚à•L1 < Œµ. If |m| > degree(P), then 1P(m) = 0 and thus
| 1f(m)| = | 1f(m)‚àí1P(m)| ‚â§
f ‚àíP

L1 < Œµ.
This proves that | 1f(m)| ‚Üí0 as |m| ‚Üí‚àû.
‚ñ°
Several questions are naturally raised. How fast can the Fourier coefÔ¨Åcients of an
L1 function tend to zero? Does additional smoothness of the function imply faster
decay of the Fourier coefÔ¨Åcients? Can such a decay be quantitatively expressed in
terms of the smoothness of the function?
We answer the Ô¨Årst question. Fourier coefÔ¨Åcients of an L1 function may tend to
zero arbitrarily slowly, that is, slower than any given rate of decay. To achieve this,
we need the following two lemmas.
Lemma 3.3.2. Given a sequence of positive real numbers {am}‚àû
m=0 that tends to
zero as m ‚Üí‚àû, there exists a sequence {cm}‚àû
m=0 that satisÔ¨Åes
cm ‚â•am,
cm ‚Üì0,
and
cm+2 +cm ‚â•2cm+1
(3.3.1)
for all m = 0,1,.... A sequence {cm}‚àû
m=0 that satisÔ¨Åes (3.3.1) is called convex.
Proof. Let k0 = 0 and suppose that am ‚â§M for all m ‚â•0. Find k1 > k0 such that
for m ‚â•k1 we have am ‚â§M/2. Now Ô¨Ånd k2 > k1 + k1‚àík0
2
such that for m ‚â•k2 we
have am ‚â§M/4. Next Ô¨Ånd k3 > k2 + k2‚àík1
2
such that for m ‚â•k3 we have am ‚â§M/8.
Continue inductively in this way and construct a subsequence k0 < k1 < k2 < ¬∑¬∑¬∑ of
the integers such that for m ‚â•kj+1 we have am ‚â§2‚àíj‚àí1M and kj+1 > kj + k j‚àík j‚àí1
2
for j ‚â•1. Join the points (k0,2M), (k1,M), (k2,M/2), (k3,M/4),... by straight
lines and note that by the choice of the sequence {kj}‚àû
j=0 the resulting piecewise
linear function h is convex on [0,‚àû). DeÔ¨Åne cm = h(m) and observe that the se-
quence {cm}‚àû
m=0 satisÔ¨Åes the required properties. Exercise 3.3.1 contains an alterna-
tive proof.
‚ñ°
Lemma 3.3.3. Given a convex decreasing sequence {cm}‚àû
m=0 of positive real num-
bers satisfying limm‚Üí‚àûcm = 0 and a Ô¨Åxed integer s ‚â•0, we have that

194
3 Fourier Series
‚àû
‚àë
r=0
(r +1)(cr+s +cr+s+2 ‚àí2cr+s+1) = cs .
(3.3.2)
Proof. We begin by observing the validity of the telescoping sum
N
‚àë
r=0
(r +1)(cr+s +cr+s+2 ‚àí2cr+s+1)
= cs ‚àí(N +1)(cs+N+1 ‚àícs+N+2)‚àícs+N+1 .
(3.3.3)
To show that the last expression tends to cs as N ‚Üí‚àû, we take M = [ N
2 ] and we use
convexity

cs+M+ j‚àícs+M+ j+1 ‚â•cs+M+ j+1‚àícs+M+ j+2

to obtain
cs+M+1 ‚àícs+N+2 = cs+M+1 ‚àícs+M+2
+cs+M+2 ‚àícs+M+3
+¬∑¬∑¬∑
+cs+N+1 ‚àícs+N+2
‚â•(N ‚àíM +1)(cs+N+1 ‚àícs+N+2)
‚â•N+1
2 (cs+N+1 ‚àícs+N+2) ‚â•0.
The preceding calculation implies that (N + 1)(cs+N+1 ‚àícs+N+2) tends to zero as
N ‚Üí‚àûand thus the expression in (3.3.3) converges to cs as N ‚Üí‚àû.
‚ñ°
The proof of Lemma 3.3.3 appears more natural after examining Exercise 3.3.3(a).
We now state the theorem we alluded to earlier.
Theorem 3.3.4. Let (dm)m‚ààZn be a sequence of positive real numbers with dm ‚Üí0
as |m| ‚Üí‚àû. Then there exists a function f ‚ààL1(Tn) such that 1f(m) ‚â•dm for all
m ‚ààZn. In other words, given any rate of decay, there exists an integrable function
on the torus whose Fourier coefÔ¨Åcients have slower rate of decay.
Proof. We are given a sequence of positive numbers {am}m‚ààZ that converges to zero
as |m| ‚Üí‚àûand we would like to Ô¨Ånd an integrable function on T1 with 1f(m) ‚â•am
for all m ‚ààZ. Apply Lemma 3.3.2 to the sequence {am +a‚àím}m‚â•0 to Ô¨Ånd a convex
sequence {cm}m‚â•0 that dominates {am +a‚àím}m‚â•0 and decreases to zero as m ‚Üí‚àû.
Extend cm for m < 0 by setting cm = c|m|. Now deÔ¨Åne
f(x) =
‚àû
‚àë
j=0
( j +1)(cj +cj+2 ‚àí2cj+1)Fj(x),
(3.3.4)
where Fj is the (one-dimensional) Fej¬¥er kernel. The convexity of the sequence cm
and the positivity of the Fej¬¥er kernel imply that f ‚â•0. Lemma 3.3.3 with s = 0 gives
that
‚àû
‚àë
j=0
( j +1)(cj +cj+2 ‚àí2cj+1)
Fj

L1 = c0 < ‚àû,
(3.3.5)

3.3 Decay of Fourier CoefÔ¨Åcients
195
since ‚à•Fj‚à•L1 = 1 for all j. Therefore (3.3.4) deÔ¨Ånes an integrable function f on T1.
We now compute the Fourier coefÔ¨Åcients of f. Since the series in (3.3.4) converges
in L1, for m ‚ààZ we have
1f(m) =
‚àû
‚àë
j=0
( j +1)(cj +cj+2 ‚àí2cj+1) 1Fj(m)
=
‚àû
‚àë
j=|m|
( j +1)(cj +cj+2 ‚àí2cj+1)

1‚àí|m|
j +1

=
‚àû
‚àë
r=0
(r +1)(cr+|m| +cr+|m|+2 ‚àí2cr+|m|+1)
= c|m| = cm ,
(3.3.6)
where we used Lemma 3.3.3 with s = |m|.
Let us now extend this result on Tn. Let (dm)m‚ààZn be a positive sequence with
dm ‚Üí0 as |m| ‚Üí‚àû. By Exercise 3.3.2, there exists a positive sequence (aj) j‚ààZ with
am1 ¬∑¬∑¬∑amn ‚â•d(m1,...,mn) and aj ‚Üí0 as | j| ‚Üí‚àû. Let
f(x1,...,xn) = f(x1)¬∑¬∑¬∑ f(xn),
where f is the function previously constructed when n = 1 so that 1f(m) ‚â•am. It can
be seen easily using (3.1.7) that 1f(m) ‚â•dm.
‚ñ°
3.3.2 Decay of Fourier CoefÔ¨Åcients of Smooth Functions
We next study the decay of the Fourier coefÔ¨Åcients of functions that possess a cer-
tain amount of smoothness. In this section we see that the decay of the Fourier
coefÔ¨Åcients reÔ¨Çects the smoothness of the function in a rather precise quantitative
way. Conversely, one can infer some information about the smoothness of a function
from the decay of its Fourier coefÔ¨Åcients.
DeÔ¨Ånition 3.3.5. Given 0 < Œ≥ < 1 and f a function on Tn, deÔ¨Åne the homogeneous
Lipschitz seminorm of order Œ≥ of f by
f
.
ŒõŒ≥ = sup
x,h‚ààTn
hÃ∏=0
| f(x+h)‚àíf(x)|
|h|Œ≥
and deÔ¨Åne the homogeneous Lipschitz space of order Œ≥ as
.
ŒõŒ≥(Tn) = {f : Tn ‚ÜíC with
 f
.
ŒõŒ≥ < ‚àû}.
Functions in .
ŒõŒ≥(Tn) are called homogeneous Lipschitz functions of order Œ≥.
There is an analogous deÔ¨Ånition for the inhomogeneous norm.

196
3 Fourier Series
DeÔ¨Ånition 3.3.6. For 0 < Œ≥ < 1 and f a function on Tn, deÔ¨Åne the inhomogeneous
Lipschitz norm of order Œ≥ of f by
f

ŒõŒ≥ =
 f

L‚àû+ sup
x,h‚ààTn
hÃ∏=0
| f(x+h)‚àíf(x)|
|h|Œ≥
=
f

L‚àû+
f
.
ŒõŒ≥ .
Also deÔ¨Åne the inhomogeneous Lipschitz space of order Œ≥ as
ŒõŒ≥(Tn) = {f : Tn ‚ÜíC with
 f

ŒõŒ≥ < ‚àû}.
Functions in ŒõŒ≥(Tn) are called inhomogeneous Lipschitz functions of order Œ≥.
Remark 3.3.7. Functions in both spaces ŒõŒ≥(Tn) and .
ŒõŒ≥(Tn) are obviously contin-
uous and therefore bounded. Moreover, the functional ‚à•¬∑ ‚à•ŒõŒ≥ is a norm on ŒõŒ≥(Tn).
The positive functional ‚à•¬∑ ‚à•.
ŒõŒ≥ satisÔ¨Åes the triangle inequality, but it does not satisfy
the property ‚à•f‚à•.
ŒõŒ≥ = 0 =‚áíf = 0 required to be a norm. It is therefore a semi-
norm on .
ŒõŒ≥(Tn). However, if we identify functions whose difference is a constant,
we form a space of the equivalence classes .
ŒõŒ≥(Tn)/{constants} on which ‚à•¬∑ ‚à•.
ŒõŒ≥ is
a norm.
Remark 3.3.8. We already observed that elements of .
ŒõŒ≥(Tn) are continuous and
thus bounded. Therefore, .
ŒõŒ≥(Tn) ‚äÜL‚àû(Tn) in the set-theoretic sense. However, the
norm inequality ‚à•f‚à•L‚àû‚â§C‚à•f‚à•.
ŒõŒ≥ for all f ‚àà.
ŒõŒ≥ fails for all constants C. For exam-
ple, take f = N +sin(2œÄx1) on Tn and let N ‚Üí‚àûto see that this is the case.
The following theorem indicates how the smoothness of a function is reÔ¨Çected
by the decay of its Fourier coefÔ¨Åcients.
Theorem 3.3.9. Let s ‚ààZ with s ‚â•0.
(a) Suppose that ‚àÇŒ± f exist and are integrable for all |Œ±| ‚â§s. Then
| 1f(m)| ‚â§
‚àön
2œÄ
s max
|Œ±|=s| 3
‚àÇŒ± f(m)|
|m|s
,
m Ã∏= 0,
(3.3.7)
and thus
| 1f(m)|(1+|m|s) ‚Üí0
as |m| ‚Üí‚àû. In particular this holds when f lies in C s(Tn).
(b) Suppose that ‚àÇŒ± f exist for all |Œ±| ‚â§s and whenever |Œ±| = s, ‚àÇŒ± f are in .
ŒõŒ≥(Tn)
for some 0 < Œ≥ < 1. Then
| 1f(m)| ‚â§(‚àön)s+Œ≥
(2œÄ)s2Œ≥+1
max
|Œ±|=s
‚àÇŒ± f
.
ŒõŒ≥
|m|s+Œ≥
,
m Ã∏= 0.
(3.3.8)

3.3 Decay of Fourier CoefÔ¨Åcients
197
Proof. Fix m ‚ààZn \ {0} and pick a j such that |mj| = sup1‚â§k‚â§n |mk|. Then clearly
mj Ã∏= 0. Integrating by parts s times with respect to the variable xj, we obtain
1f(m) =

Tn f(x)e‚àí2œÄix¬∑m dx = (‚àí1)s

Tn(‚àÇs
j f)(x) e‚àí2œÄix¬∑m
(‚àí2œÄimj)s dx,
(3.3.9)
where the boundary terms all vanish because of the periodicity of the integrand.
Taking absolute values and using |m| ‚â§‚àön|mj|, we obtain assertion (3.3.7).
We now turn to the second part of the theorem. Let ej = (0,...,1,...,0) be the
element of the torus Tn whose jth coordinate is one and all the others are zero. A
simple change of variables together with the fact that eœÄi = ‚àí1 gives that

Tn(‚àÇs
j f)(x)e‚àí2œÄix¬∑m dx = ‚àí

Tn(‚àÇs
j f)(x‚àíe j
2mj )e‚àí2œÄix¬∑m dx,
which implies that

Tn(‚àÇs
j f)(x)e‚àí2œÄix¬∑m dx = 1
2

Tn

(‚àÇs
j f)(x)‚àí(‚àÇs
j f)(x‚àíe j
2mj )

e‚àí2œÄix¬∑m dx.
Now use the estimate
|(‚àÇs
j f)(x)‚àí(‚àÇs
j f)(x‚àíe j
2mj )| ‚â§
‚àÇs
j f
.
ŒõŒ≥
(2|mj|)Œ≥
and identity (3.3.9) to conclude the proof of (3.3.8).
‚ñ°
The following is an immediate consequence.
Corollary 3.3.10. Let s ‚ààZ with s ‚â•0.
(a) Suppose that ‚àÇŒ± f exist and are integrable for all |Œ±| ‚â§s. Then for some constant
cn,s we have
| 1f(m)| ‚â§cn,s
max

‚à•f‚à•L1,max|Œ±|=s ‚à•‚àÇŒ± f‚à•L1

(1+|m|)s
.
(3.3.10)
(b) Suppose that ‚àÇŒ± f exist for all |Œ±| ‚â§s and whenever |Œ±| = s, ‚àÇŒ± f are in .
ŒõŒ≥(Tn)
for some 0 < Œ≥ < 1. Then for some constant c‚Ä≤
n,s we have
| 1f(m)| ‚â§c‚Ä≤
n,s
max

‚à•f‚à•L1,max|Œ±|=s ‚à•‚àÇŒ± f‚à•ÀôŒõŒ≥

(1+|m|)s+Œ≥
.
(3.3.11)
Remark 3.3.11. The conclusions of Theorem 3.3.9 and Corollary 3.3.10 are also
valid when Œ≥ = 1. In this case the spaces ÀôŒõŒ≥ should be replaced by the space Lip1
equipped with the seminorm
 f

Lip1 = sup
x,h‚ààTn
hÃ∏=0
| f(x+h)‚àíf(x)|
|h|
.

198
3 Fourier Series
There is a slight lack of uniformity in the notation here, since in the theory of Lips-
chitz spaces the notation .
Œõ1 is usually reserved for the space with seminorm
 f
.
Œõ1 = sup
x,h‚ààTn
hÃ∏=0
| f(x+h)+ f(x‚àíh)‚àí2f(x)|
|h|
.
The following proposition provides a partial converse to Theorem 3.3.9. We
denote below by [[s]] the largest integer strictly less than a given real number s.
Then [[s]] is equal to the integer part [s] of s, unless s is an integer, in which case
[[s]] = [s]‚àí1.
Proposition 3.3.12. Let s > 0 and suppose that f is an integrable function on the
torus with
| 1f(m)| ‚â§C(1+|m|)‚àís‚àín
(3.3.12)
for all m ‚ààZn. Then f has partial derivatives of all orders |Œ±| ‚â§[[s]], and for 0 <
Œ≥ < s‚àí[[s]], ‚àÇŒ± f ‚àà.
ŒõŒ≥ for all multi-indices Œ± satisfying |Œ±| = [[s]].
Proof. Since f has an absolutely convergent Fourier series, Proposition 3.2.5 gives
that
f(x) = ‚àë
m‚ààZn
1f(m)e2œÄix¬∑m ,
(3.3.13)
for almost all x ‚ààTn.
Suppose that a series g = ‚àëm gm satisÔ¨Åes ‚àëm ‚à•‚àÇŒ≤gm‚à•L‚àû< ‚àûfor all |Œ≤| ‚â§M. Then
the function g is in C M and ‚àÇŒ≤g = ‚àëm ‚àÇŒ≤gm; indeed this can be proved by induction
on the degree of the multi-index, since for all |Œ≤| ‚â§M ‚àí1 we have
lim
t‚Üí0
‚àÇŒ≤g(x+tej)‚àí‚àÇŒ≤g(x)
t
= ‚àë
m
lim
t‚Üí0
‚àÇŒ≤gm(x+tej)‚àí‚àÇŒ≤gm(x)
t
= ‚àë
m
‚àÇj‚àÇŒ≤g(x),
where the passage of the limit inside the sum is due to the Lebesgue dominated con-
vergence theorem, which can be applied using the uniform convergence of ‚àëm ‚àÇj‚àÇŒ≤g
via the mean value theorem.
Using the preceding observation, the function f in (3.3.13) is C [[s]](Tn) and
(‚àÇŒ± f)(x) = ‚àë
m‚ààZn
1f(m)(2œÄim)Œ±e2œÄix¬∑m
for all multi-indices (Œ±1,...,Œ±n) with |Œ±| ‚â§[[s]], since
‚àë
m‚ààZn
1f(m) sup
x‚ààTn
(2œÄim)Œ±e2œÄix¬∑m < ‚àû,
which holds because of (3.3.12).

3.3 Decay of Fourier CoefÔ¨Åcients
199
Now suppose that |Œ±| = [[s]] and that 0 < Œ≥ < s‚àí[[s]]. Then
|(‚àÇŒ± f)(x+h)‚àí(‚àÇŒ± f)(x)| =
 ‚àë
m‚ààZn
1f(m)(2œÄim)Œ±e2œÄix¬∑m
e2œÄim¬∑h ‚àí1

‚â§(2œÄ)[[s]] ‚àë
m‚ààZn
|m|[[s]]C21‚àíŒ≥(2œÄ)Œ≥|h|Œ≥|m|Œ≥
(1+|m|)n+s
‚â§C21‚àíŒ≥(2œÄ)s|h|Œ≥ ,
where we used the relation [[s]]+Œ≥ ‚àís‚àín < ‚àín to conclude the convergence of the
series and the fact that
|e2œÄim¬∑h ‚àí1| ‚â§min(2,2œÄ|m||h|) ‚â§21‚àíŒ≥(2œÄ)Œ≥|m|Œ≥|h|Œ≥ .
‚ñ°
Next we recall the deÔ¨Ånition of functions of bounded variation.
DeÔ¨Ånition 3.3.13. A measurable function f on T1 is said to be of bounded variation
if it is deÔ¨Åned everywhere and
Var( f) = sup
 M
‚àë
j=1
| f(xj)‚àíf(xj‚àí1)| : 0 = x0 < x1 < ¬∑¬∑¬∑ < xM = 1

< ‚àû,
where the supremum is taken over all partitions of the interval [0,1]. The expression
Var( f) is called the total variation of f. The class of functions of bounded variation
on T1 is denoted by BV(T1).
Examples of functions of bounded variation can be constructed as follows: given
f1, f2 nonnegative integrable functions on [0,1] with
 1
0 f1(t)dt =
 1
0 f2(t)dt ,
then the periodic function
g(x) =
 x
0 f1(t)dt ‚àí
 x
0 f2(t)dt ,
deÔ¨Åned on[0,1], is of bounded variation. Analogous examples can be constructed
when f1 and f2 are replaced by nonnegative Ô¨Ånite Borel measures on [0,1].
Every function of bounded variation can be represented as the difference of two
(not necessarily strictly) increasing functions and thus it has a Ô¨Ånite derivative at
almost every point. Moreover, for functions of bounded variation, the Lebesgue‚Äì
Stieltjes integral with respect to d f is well deÔ¨Åned.

200
3 Fourier Series
Proposition 3.3.14. If f is in BV(T1), then
| 1f(m)| ‚â§Var( f)
2œÄ|m|
whenever m Ã∏= 0.
Proof. Integration by parts gives
1f(m) =

T1 f(x)e‚àí2œÄimx dx =

T1
e‚àí2œÄimx
‚àí2œÄim d f ,
where the boundary terms vanish because of periodicity. The conclusion follows
from the fact that the norm of the measure d f is the total variation of f.
‚ñ°
The following chart (Table 3.1) summarizes the decay of Fourier coefÔ¨Åcients in
terms of scales of spaces measuring the smoothness of the functions. Recall that
for q ‚â•0, 1f(m) = o(|m|‚àíq) means that | 1f(m)||m|q ‚Üí0 as |m| ‚Üí‚àûand 1f(m) =
O(|m|‚àíq) means that | 1f(m)| ‚â§C|m|‚àíq when |m| is large. In this chart, we denote by
C s,Œ≥(Tn) the space of all C s functions on Tn, all of whose derivatives of total order
s lie in ŒõŒ≥(Tn), for some 0 < Œ≥ < 1.
SPACE
SEQUENCE OF FOURIER COEFFICIENTS
L1(Tn)
o(1)
Lp(Tn)
‚Ñìp‚Ä≤(Zn)
L2(Tn)
‚Ñì2(Zn)
.
ŒõŒ≥(Tn)
O(|m|‚àíŒ≥)
BV(T1)
O(|m|‚àí1)
C 1(Tn)
o(|m|‚àí1)
C 1,Œ≥(Tn)
O(|m|‚àí1‚àíŒ≥)
C 2(Tn)
o(|m|‚àí2)
C 2,Œ≥(Tn)
O(|m|‚àí2‚àíŒ≥)
C 3(Tn)
o(|m|‚àí3)
¬∑¬∑¬∑
¬∑¬∑¬∑
C ‚àû(Tn)
o(|m|‚àíN) for all N > 0
Table 3.1 Interconnection between smoothness of functions and decay of their Fourier coefÔ¨Å-
cients. We take 0 < Œ≥ < 1 and 1 < p < 2.
3.3.3 Functions with Absolutely Summable Fourier CoefÔ¨Åcients
Decay for the Fourier coefÔ¨Åcients can also be indirectly deduced from knowledge
about the summability of these coefÔ¨Åcients. The simplest kind of summability is in
the sense of ‚Ñì1. It is therefore natural to consider the class of functions on the torus
whose Fourier coefÔ¨Åcients form an absolutely summable series.

3.3 Decay of Fourier CoefÔ¨Åcients
201
DeÔ¨Ånition 3.3.15. An integrable function f on the torus is said to have an absolutely
convergent Fourier series if
‚àë
m‚ààZn
| 1f(m)| < +‚àû.
We denote by A(Tn) the space of all integrable functions on the torus Tn whose
Fourier series are absolutely convergent. We then introduce a norm on A(Tn) by
setting
f

A(Tn) = ‚àë
m‚ààZn
| 1f(m)|.
In view of Proposition 3.2.5, every function f in A(Tn) can be changed on a set of
measure zero to be made continuous and under this modiÔ¨Åcation, Fourier inversion
f(x) = ‚àë
m‚ààZn
1f(m)e2œÄim¬∑x
holds for all x ‚ààTn. Thus functions in A(Tn) are continuous and bounded. More-
over, Theorem 3.3.9 yields that every function in C n(Tn) whose partial derivatives
of order n are in .
ŒõŒ≥, Œ≥ > 0, must lie in A(Tn). The following theorem gives us a
signiÔ¨Åcantly better sufÔ¨Åcient condition for a function to be in A(Tn).
Theorem 3.3.16. Suppose f is a given function in C [n/2](Tn) and that all partial
derivatives of order [ n
2] of f lie in .
ŒõŒ≥(Tn) for some Œ≥ with n
2 ‚àí[ n
2] < Œ≥ < 1. Then f
lies in A(Tn) and
f

A(Tn) ‚â§| 1f(0)|+C(n,Œ≥) sup
|Œ±|=[ n
2 ]
‚àÇŒ± f
.
ŒõŒ≥(Tn),
where C(n,Œ≥) is a constant depending on n and Œ≥.
Proof. For each ‚Ñì= 0,1,2,..., let
S‚Ñì=

‚àë
2‚Ñì‚â§|m|<2‚Ñì+1
| 1f(m)|2
1/2
.
We begin by writing
f

A(Tn) = | 1f(0)|+
‚àû
‚àë
‚Ñì=0
‚àë
2‚Ñì‚â§|m|<2‚Ñì+1
| 1f(m)| ‚â§| 1f(0)|+‚àöcn
‚àû
‚àë
‚Ñì=0
2
‚Ñìn
2 S‚Ñì,
(3.3.14)
where we used the Cauchy-Schwarz inequality and the fact that there are at most
cn2‚Ñìn points in Zn inside the open ball B(0,2‚Ñì+1), for some dimensional constant cn.
Notice that for a multi-index m = (m1,...,mn) satisfying 2‚Ñì‚â§|m| ‚â§2‚Ñì+1 and for
j in {1,...,n} such that |mj| = supk |mk| we have
|mj|
2‚Ñì‚â•|m|
2‚Ñì‚àön ‚â•1
‚àön .
(3.3.15)

202
3 Fourier Series
For 1 ‚â§j ‚â§n, let ej be the element of Rn with zero entries except for the jth
coordinate, which is 1, and deÔ¨Åne
h‚Ñì
j = 2‚àí‚Ñì‚àí2ej .
(3.3.16)
Using the elementary fact that |t| ‚â§œÄ =‚áí|eit ‚àí1| ‚â•2|t|/œÄ, we obtain
|e2œÄim¬∑h‚Ñì
j ‚àí1| = |e2œÄimj2‚àí‚Ñì‚àí2 ‚àí1| ‚â•2
œÄ
|2œÄmj|
2‚Ñì+2
= |mj|
2‚Ñì‚â•1
‚àön ,
(3.3.17)
whenever |2œÄmj|
2‚Ñì+2 ‚â§œÄ, which is always true since |2œÄmj|
2‚Ñì+2 ‚â§2œÄ2‚Ñì+1
2‚Ñì+2
‚â§œÄ.
We now have
S2
‚Ñì=
n
‚àë
j=1
‚àë
2‚Ñì‚â§|m|<2‚Ñì+1
|mj|=supk |mk|
| 1f(m)|2
‚â§n
n
‚àë
j=1
‚àë
2‚Ñì‚â§|m|<2‚Ñì+1
|mj|=supk |mk|
|e2œÄim¬∑h‚Ñì
j ‚àí1|2| 1f(m)|2 |2œÄimj|2[ n
2 ]
|2œÄmj|2[ n
2 ]
‚â§n
n[ n
2 ]
(2œÄ2‚Ñì)2[ n
2 ]
n
‚àë
j=1 ‚àë
m‚ààZn
|e2œÄim¬∑h‚Ñì
j ‚àí1|2| 
‚àÇ[n/2]
j
f(m)|2
= Cn2‚àí2‚Ñì[ n
2 ]
n
‚àë
j=1
‚àÇ[n/2]
j
f(¬∑ +h‚Ñì
j)‚àí‚àÇ[n/2]
j
f
2
L2
‚â§Cn2‚àí2‚Ñì[ n
2 ]
n
‚àë
j=1
‚àÇ[n/2]
j
f(¬∑ +h‚Ñì
j)‚àí‚àÇ[n/2]
j
f
2
L‚àû
‚â§C‚Ä≤
n2‚àí2‚Ñì[ n
2 ] sup
|Œ±|=[ n
2 ]
‚àÇŒ± f
2.
ŒõŒ≥
n
‚àë
j=1
|h‚Ñì
j|2Œ≥
= C‚Ä≤
n,Œ≥ 2‚àí2‚Ñì[ n
2 ]‚àí2‚ÑìŒ≥ sup
|Œ±|=[ n
2 ]
‚àÇŒ± f
2.
ŒõŒ≥ ,
where we used (3.3.17), (3.3.15), and (3.3.16). We conclude that
S‚Ñì‚â§C‚Ä≤‚Ä≤
n,Œ≥ 2‚àí‚Ñì([ n
2 ]+Œ≥) sup
|Œ±|=[ n
2 ]
‚àÇŒ± f
.
ŒõŒ≥
which inserted in (3.3.14) yields the desired conclusion since Œ≥ > n
2 ‚àí[ n
2].
‚ñ°
Exercises
3.3.1. Given a sequence {an}‚àû
n=0 of positive numbers such that an ‚Üí0 as n ‚Üí‚àû,
Ô¨Ånd a nonnegative integrable function h on [0,1] such that

3.3 Decay of Fourier CoefÔ¨Åcients
203
 1
0 h(t)tm dt ‚â•am.
Use this result to deduce a different proof of Lemma 3.3.2.

Hint: Try h = e
‚àû
‚àë
k=0
(sup
j‚â•k
aj ‚àísup
j‚â•k+1
aj)(k +2)œá[ k+1
k+2 ,1].

3.3.2. Prove that given a positive sequence {dm}m‚ààZn with dm ‚Üí0 as |m| ‚Üí‚àû,
there exists a positive sequence {aj}j‚ààZ with am1 ¬∑¬∑¬∑amn ‚â•d(m1,...,mn) and aj ‚Üí0 as
| j| ‚Üí‚àû.
3.3.3. (a) Use the idea of the proof of Lemma 3.3.3 to prove that if a twice contin-
uously differentiable function f ‚â•0 is deÔ¨Åned on (0,‚àû) and satisÔ¨Åes f ‚Ä≤(x) ‚â§0 and
f ‚Ä≤‚Ä≤(x) ‚â•0 for all x > 0, then limx‚Üí‚àûx f ‚Ä≤(x) = 0.
(b) Suppose that a continuously differentiable function g is deÔ¨Åned on (0,‚àû) and
satisÔ¨Åes g ‚â•0, g‚Ä≤ ‚â§0, and
 ‚àû
1 g(x)dx < +‚àû. Prove that
lim
x‚Üí‚àûxg(x) = 0.
3.3.4. Prove that for 0 < Œ≥ < Œ¥ < 1 we have ‚à•f‚à•.
ŒõŒ≥ ‚â§Cn,Œ≥,Œ¥‚à•f‚à•.
ŒõŒ¥ for all functions
f and thus .
ŒõŒ¥ is a subspace of .
ŒõŒ≥.
3.3.5. Suppose that f is a differentiable function on T1 whose derivative f ‚Ä≤ is in
L2(T1). Prove that f ‚ààA(T1) and that
 f

A(T1) ‚â§
f

L1 + 1
2œÄ
 ‚àë
jÃ∏=0
j‚àí21/2f ‚Ä≤
L2.
3.3.6. (a) Prove that the product of two functions in A(Tn) is also in A(Tn) and that
 fg

A(Tn) ‚â§
f

A(Tn)
g

A(Tn).
(b) Prove that the convolution of two square integrable functions on Tn always gives
a function in A(Tn).
3.3.7. Fix 0 < Œ± < 1 and deÔ¨Åne f on T1 by setting
f(x) =
‚àû
‚àë
k=0
2‚àíŒ±ke2œÄi2kx.
Prove that the function f lies in .
ŒõŒ±(T1). Conclude that there does not exist positive
Œ≤ > Œ± such that for all f in .
ŒõŒ±(T1) we have supm‚ààZ |m|Œ≤| 1f(m)| < ‚àû.

Hint: For h Ã∏= 0 pick N ‚ààZ+ such that 2N|h| > 1 ‚â•2N‚àí1|h|. To estimate the differ-
ence | f(x+h)‚àíf(x)|, consider the cases k ‚â§N and k ‚â•N +1 in the sum.


204
3 Fourier Series
3.3.8. Use without proof that there exists a constant C > 0 such that
sup
t‚ààR

N
‚àë
k=2
eiklogkeikt
 ‚â§C
‚àö
N,
N = 2,3,4,...,
to prove that the function
g(x) =
‚àû
‚àë
k=2
eiklogk
k
e2œÄikx
is in .
Œõ1/2(T1) but not in A(T1). Conclude that the restriction s > 1/2 in Theorem
3.3.16 is sharp.

Hint: Estimate the difference |g(x+h)‚àíg(x)| using the summation by parts iden-
tity in Appendix F, taking sums of the sequence eiklogke2œÄikx and differences of the
sequence e2œÄikh‚àí1
k
.

3.3.9. Show that there exist sequences {am}m‚ààZn that tend to zero as |m| ‚Üí‚àûfor
which there do not exist functions f in L1(Tn) with 1f(m) = am for all m.

Hint: Suppose the contrary. Then the open mapping theorem would imply the in-
equality ‚à•f‚à•L1(Tn) ‚â§A‚à•1f ‚à•‚Ñì‚àû(Zn) for some A > 0. To contradict it, Ô¨Åx a smooth
nonzero function h equal to 1 on B(0, 1
4) and supported in B(0, 1
2). For b > 0 de-
Ô¨Åne gb(x) = h(x)e‚àíœÄ(1+ib)|x|2 and extend gb to a 1-periodic function in each variable
on Rn. Use that 1gb(m) =

Rn 1h(y)(1 + ib)‚àín/2e‚àí
œÄ
1+ib |m‚àíy|2dy, and let b ‚Üí‚àûin the
inequality ‚à•gb‚à•L1(Tn) ‚â§A‚à•1gb ‚à•‚Ñì‚àû(Zn) to obtain a contradiction.

3.4 Pointwise Convergence of Fourier Series
In this section we are concerned with the pointwise convergence of the square partial
sums and the Fej¬¥er means of a function deÔ¨Åned on the torus.
3.4.1 Pointwise Convergence of the Fej¬¥er Means
We saw in Section 3.1 that the Fej¬¥er kernel is an approximate identity. This implies
that the Fej¬¥er (or Ces`aro) means of an Lp function f on Tn converge to it in Lp for any
1 ‚â§p < ‚àû. Moreover, if f is continuous at x0, then the means (Fn
N ‚àóf)(x0) converge
to f(x0) as N ‚Üí‚àûin view of Theorem 1.2.19 (2). Although this is a satisfactory
result, it is natural to ask what happens for more general functions.

3.4 Pointwise Convergence of Fourier Series
205
Using properties of the Fej¬¥er kernel, we obtain the following one-dimensional
result regarding the convergence of the Fej¬¥er means:
Theorem 3.4.1. (Fej¬¥er) If a function f in L1(T1) has left and right limits at a point
x0, denoted by f(x0‚àí) and f(x0+), respectively, then
(FN ‚àóf)(x0) ‚Üí1
2

f(x0+)+ f(x0‚àí)

as
N ‚Üí‚àû.
(3.4.1)
In particular, this is the case for functions of bounded variation.
Proof. Let us identify T1 with [‚àí1/2,1/2]. Given Œµ > 0, Ô¨Ånd Œ¥ ‚àà(0,1/2) such that
0 < t < Œ¥ =‚áí

f(x0 +t)+ f(x0 ‚àít)
2
‚àíf(x0+)+ f(x0‚àí)
2
 < Œµ .
(3.4.2)
Using the second expression for FN in (3.1.18), we can Ô¨Ånd an N0 > 0 such that for
N ‚â•N0 we have
sup
Œ¥‚â§t‚â§1
2
FN(t) =
1
N +1 sup
Œ¥‚â§t‚â§1
2
sin(œÄ(N +1)t)
sin(œÄt)
2
‚â§
1
N +1
1
sin2(œÄŒ¥) < Œµ.
(3.4.3)
We now have
(FN ‚àóf)(x0)‚àíf(x0+) =

T1 FN(t)

f(x0 +t)‚àíf(x0+)

dt ,
(FN ‚àóf)(x0)‚àíf(x0‚àí) =

T1 FN(t)

f(x0 ‚àít)‚àíf(x0‚àí)

dt .
Averaging these two identities and using that the integrand is even, we obtain
(FN ‚àóf)(x0)‚àíf(x0+)+ f(x0‚àí)
2
= 2
 1/2
0
FN(t)
 f(x0 +t)+ f(x0 ‚àít)
2
‚àíf(x0+)+ f(x0‚àí)
2

dt .
(3.4.4)
We split the integral in (3.4.4) into two pieces, the integral over [0,Œ¥) and the inte-
gral over [Œ¥,1/2]. By (3.4.2), the integral over [0,Œ¥) is controlled by Œµ

T1 FN(t)dt =
Œµ. Also (3.4.3) gives that for N ‚â•N0

 1/2
Œ¥
FN(t)
 f(x0 ‚àít)+ f(x0 +t)
2
‚àíf(x0‚àí)+ f(x0+)
2

dt

‚â§Œµ
2
 f ‚àíf(x0‚àí)

L1 +
f ‚àíf(x0+)

L1

= Œµ c( f,x0),
where c( f,x0) is a constant depending on f and x0. We have now proved that given
Œµ > 0 there exists an N0 such that for N ‚â•N0 the second expression in (3.4.4) is
bounded by 2Œµ (c( f,x0)+1). This proves the required conclusion.

206
3 Fourier Series
Functions of bounded variation can be written as differences of increasing func-
tions, and since increasing functions have left and right limits everywhere, (3.4.1)
holds for these functions.
‚ñ°
We continue with an elementary but very useful application of the preceding
result.
Proposition 3.4.2. Let x0 ‚ààT1 and let f be a complex-valued function on T1. Sup-
pose that the left and right limits of f exist as x ‚Üíx0 and that the partial sums
(Dirichlet means) (DN ‚àóf)(x0) converge. Then
(DN ‚àóf)(x0) ‚Üí1
2

f(x0+)+ f(x0‚àí)

as N ‚Üí‚àû.
Proof. If (DN ‚àóf)(x0) ‚ÜíL(x0) as N ‚Üí‚àû, then
(FN ‚àóf)(x0) = (D0 ‚àóf)(x0)+(D1 ‚àóf)(x0)+¬∑¬∑¬∑+(DN ‚àóf)(x0)
N +1
‚ÜíL(x0)
as N ‚Üí‚àû. But (FN ‚àóf)(x0) ‚Üí1
2

f(x0+)+ f(x0‚àí)

as N ‚Üí‚àûin view of Theorem
3.4.1. We conclude that
L(x0) = 1
2

f(x0+)+ f(x0‚àí)

,
Thus (DN ‚àóf)(x0) ‚Üí1
2

f(x0+)+ f(x0‚àí)

as N ‚Üí‚àû.
‚ñ°
This theorem is quite useful when we have a priori knowledge that the Fourier
series converges. For instance, consider the following example.
Example 3.4.3. On (‚àí1/2,1/2) let f(t) = t and f(1/2) = f(‚àí1/2) = 1000. Then
f is discontinuous at the point ‚àí1/2 ‚â°1/2 but it has left and right limits at this
point:
lim
t‚Üí‚àí1
2 +
f(t) = ‚àí1
2
lim
t‚Üí1
2 ‚àí
f(t) = 1
2 .
(3.4.5)
Moreover 1f(m) = i(‚àí1)m
2œÄm
when m Ã∏= 0 and 1f(0) = 0 by Exercise 3.4.1 (a). It is not
hard to see that the series
(DN ‚àóf)(x) = i
2œÄ
‚àë
0<|m|‚â§N
(‚àí1)m
m
e2œÄimx = i
2œÄ
‚àë
0<|m|‚â§N
e2œÄim(x+ 1
2 )
m
(3.4.6)

3.4 Pointwise Convergence of Fourier Series
207
converges for every x ‚àà(‚àí1/2,1/2). Indeed, by Appendix F, (3.4.6) equals
i
2œÄ
1
N
N
‚àë
m=1

e2œÄim(x+ 1
2 ) ‚àíe‚àí2œÄim(x+ 1
2 )
‚àíi
2œÄ
N‚àí1
‚àë
k=1

k
‚àë
m=1

e2œÄim(x+ 1
2 ) ‚àíe‚àí2œÄim(x+ 1
2 )
1
k +1 ‚àí1
k

which has a limit as N ‚Üí‚àû, since the geometric sums
N
‚àë
m=1
e¬±2œÄim(x+ 1
2 ) = 1‚àíe¬±2œÄi(N+1)(x+ 1
2 )
1‚àíe¬±2œÄi(x+ 1
2 )
‚àí1
are bounded above independently of N when x ‚àà(‚àí1/2,1/2). We conclude that
f(x) = x = lim
N‚Üí‚àû
i
2œÄ
‚àë
0<|m|‚â§N
e2œÄim(x+ 1
2 )
m
= ‚àílim
N‚Üí‚àû‚àë
0<|m|‚â§N
sin(2œÄm(x+ 1
2))
2œÄm
whenever |x| < 1/2. Moreover, we have that
(DN ‚àóf)(1/2) = lim
N‚Üí‚àû
i
2œÄ
‚àë
0<|m|‚â§N
0
m = 0,
which is the average of the left and right limits in (3.4.5) as Proposition 3.4.2 states.
Exercise 3.4.2 contains other applications of this sort.
3.4.2 Almost Everywhere Convergence of the Fej¬¥er Means
We have seen that the Fej¬¥er means of a relatively nice function (such as of bounded
variation) converge everywhere. What can we say about the Fej¬¥er means of a general
integrable function? Since the Fej¬¥er kernel is an approximate identity that satisÔ¨Åes
good estimates, the following result should not come as a surprise.
Theorem 3.4.4. (a) For f ‚ààL1(Tn), let
H ( f) = sup
N‚ààZ+ | f ‚àóFn
N|.
Then H maps L1(Tn) to L1,‚àû(Tn) and Lp(Tn) to itself for 1 < p ‚â§‚àû.
(b) For any function f ‚ààL1(Tn), we have as N ‚Üí‚àû
(Fn
N ‚àóf) ‚Üíf
a.e.
Proof. It is an elementary fact that |t| ‚â§œÄ
2 =‚áí|sint| ‚â•2
œÄ |t|; see Appendix E.
Using this fact and the expression (3.1.18) we obtain for all t in [‚àí1
2, 1
2],

208
3 Fourier Series
|FN(t)| =
1
N +1

sin(œÄ(N +1)t)
sin(œÄt)

2
‚â§N +1
4

sin(œÄ(N +1)t)
(N +1)t

2
‚â§N +1
4
min

œÄ2,
1
(N +1)2t2

‚â§œÄ2
2
N +1
1+(N +1)2|t|2 .
For t ‚ààR let us set œï(t) = (1 + |t|2)‚àí1 and œïŒµ(t) = 1
Œµ œï( t
Œµ ) for Œµ > 0. For x =
(x1,...,xn) ‚ààRn and Œµ > 0 we also set
Œ¶(x) = œï(x1)¬∑¬∑¬∑œï(xn)
and Œ¶Œµ(x) = Œµ‚àínŒ¶(Œµ‚àí1x). Then for |t| ‚â§1
2 we have |FN(t)| ‚â§œÄ2
2 œïŒµ(t) with Œµ =
(N +1)‚àí1, and for y ‚àà[‚àí1
2, 1
2]n we have
|Fn
N(y)| ‚â§( œÄ2
2 )n Œ¶Œµ(y),
with Œµ = (N +1)‚àí1.
Now let f be an integrable function on Tn and let f0 denote its periodic extension
on Rn. For x ‚àà[‚àí1
2, 1
2]n we have
H ( f)(x) = sup
N>0


Tn Fn
N(y) f(x‚àíy)dy

‚â§( œÄ2
2 )n sup
Œµ>0

[‚àí1
2 , 1
2 ]n |Œ¶Œµ(y)|| f0(x‚àíy)|dy
‚â§5n sup
Œµ>0

Rn |Œ¶Œµ(y)| |( f0œáQ)(x‚àíy)|dy
= 5nG ( f0œáQ)(x),
(3.4.7)
where Q is the cube [‚àí1,1]n and G is the operator deÔ¨Åned on integrable functions
on Rn by
G (h) = sup
Œµ>0
|h|‚àóŒ¶Œµ .
If we can show that G maps L1(Rn) to L1,‚àû(Rn), the corresponding conclusion for
H on Tn would follow from the fact H ( f) ‚â§5nG ( f0œáQ) proved in (3.4.7) and the
sequence of inequalities
H ( f)

L1,‚àû(Tn) ‚â§5nG ( f0œáQ)

L1,‚àû(Rn) ‚â§5nC
 f0œáQ

L1(Rn) = C‚Ä≤f

L1(Tn).

3.4 Pointwise Convergence of Fourier Series
209
Moreover, the Lp conclusion about H follows from the weak type (1,1) result and
the trivial L‚àûinequality, in view of the Marcinkiewicz interpolation theorem (The-
orem 1.3.2). The required weak type (1,1) estimate for G on Rn is a consequence of
Lemma 3.4.5. Modulo the proof of this lemma, part (a) of the theorem is proved.
To prove the statement in part (b) observe that for f ‚ààC ‚àû(Tn), which is a dense
subspace of L1, we have Fn
N ‚àóf ‚Üíf uniformly on Tn as N ‚Üí‚àû, since the sequence
{FN}N is an approximate identity. Since by part (a), H maps L1(Tn) to L1,‚àû(Tn),
Theorem 2.1.14 yields that for f ‚ààL1(Tn), Fn
N ‚àóf ‚Üíf a.e.
‚ñ°
We now prove the weak type (1,1) boundedness of G used earlier.
Lemma 3.4.5. Let Œ¶(x1,...,xn) = (1 + |x1|2)‚àí1 ¬∑¬∑¬∑(1 + |xn|2)‚àí1 and for Œµ > 0 let
Œ¶Œµ(x) = Œµ‚àínŒ¶(Œµ‚àí1x). Then the maximal operator
G ( f) = sup
Œµ>0
| f|‚àóŒ¶Œµ
maps L1(Rn) to L1,‚àû(Rn).
Proof. Let I0 = [‚àí1,1] and Ik = {t ‚ààR : 2k‚àí1 ‚â§|t| ‚â§2k} for k = 1,2,.... Also, let
#Ik be the convex hull of Ik, that is, the interval [‚àí2k,2k]. For a2,...,an Ô¨Åxed positive
numbers, let Ma2,...,an be the maximal operator obtained by averaging a function on
Rn over all products of closed intervals J1 √ó¬∑¬∑¬∑√óJn containing a given point with
|J1| = 2a2|J2| = ¬∑¬∑¬∑ = 2an|Jn|.
In view of Exercise 2.1.9(c), we have that Ma2,...,an maps L1 to L1,‚àûwith some con-
stant independent of the aj‚Äôs. (This is due to the nice doubling property of this family
of rectangles.) For a Ô¨Åxed Œµ > 0 we estimate the expression
(Œ¶Œµ ‚àó| f|)(0) =

Rn
| f(‚àíŒµy)|dy
(1+y2
1)¬∑¬∑¬∑(1+y2n) .
Split Rn into n! regions of the form |yj1| ‚â•¬∑¬∑¬∑ ‚â•|yjn|, where {j1,..., jn} is a per-
mutation of the set {1,...,n} and y = (y1,...,yn). By symmetry, we examine the
region R where |y1| ‚â•¬∑¬∑¬∑ ‚â•|yn|. Then for some constant C > 0 we have

R
| f(‚àíŒµy)|dy
(1+y2
1)¬∑¬∑¬∑(1+y2n) ‚â§C
‚àû
‚àë
k1=0
k1
‚àë
k2=0
¬∑¬∑¬∑
kn‚àí1
‚àë
kn=0
2‚àí(2k1+¬∑¬∑¬∑+2kn)

Ik1
¬∑¬∑¬∑

Ikn
| f(‚àíŒµy)|dykn¬∑¬∑¬∑dy1,
and the last expression is trivially controlled by the corresponding expression, where
the Ik‚Äôs are replaced by the #Ik‚Äôs. This, in turn, is controlled by
C‚Ä≤
‚àû
‚àë
k1=0
k1
‚àë
k2=0
¬∑¬∑¬∑
kn‚àí1
‚àë
kn=0
2‚àí(k1+¬∑¬∑¬∑+kn)Mk1‚àík2,...,k1‚àíkn( f)(0).
(3.4.8)

210
3 Fourier Series
Now set s2 = k1 ‚àík2,...,sn = k1 ‚àíkn, observe that s j ‚â•0, use that
2‚àí(k1+¬∑¬∑¬∑+kn) ‚â§2‚àík1
2 2‚àís2
2n ¬∑¬∑¬∑2‚àísn
2n ,
and change the indices of summation to estimate the expression in (3.4.8) by
C‚Ä≤‚Ä≤
‚àû
‚àë
k1=0
‚àû
‚àë
s2=0
¬∑¬∑¬∑
‚àû
‚àë
sn=0
2‚àík1
2 2‚àís2
2n ¬∑¬∑¬∑2‚àísn
2n Ms2,...,sn( f)(0).
Argue similarly for the remaining regions |yj1| ‚â•¬∑¬∑¬∑ ‚â•|yjn|. Finally, translate to an
arbitrary point x to obtain the estimate
|(Œ¶Œµ ‚àóf)(x)| ‚â§C‚Ä≤‚Ä≤n!
‚àû
‚àë
s2=0
¬∑¬∑¬∑
‚àû
‚àë
sn=0
2‚àís2
2n ¬∑¬∑¬∑2‚àísn
2n Ms2,...,sn( f)(x).
Now take the supremum over all Œµ > 0 and use the fact that the maximal functions
Ms2,...,sn map L1 to L1,‚àûuniformly in s2,...,sn as well as the result of Exercise 1.4.10
to obtain the desired conclusion for G .
‚ñ°
3.4.3 Pointwise Divergence of the Dirichlet Means
We now pass to the more difÔ¨Åcult question of convergence of the square partial sums
of a Fourier series. It is natural to start our investigation with the class of continuous
functions. Do the partial sums of the Fourier series of continuous functions converge
pointwise? The following simple proposition warns about the behavior of partial
sums.
Proposition 3.4.6. (a) (duBois Reymond) There exists a continuous function f on
T1 whose partial sums diverge at a point. Precisely, for some point x0 ‚ààT1 we have
limsup
N‚Üí‚àû
 ‚àë
m‚ààZ
|mj|‚â§N
1f(m)e2œÄix0m
 = ‚àû.
(b) There exists a continuous function F on Tn and x0 ‚ààT1 such that the sequence
limsup
N‚Üí‚àû
 ‚àë
m‚ààZn
|mj|‚â§N
1F(m)e2œÄi(x0m1+x2m2+¬∑¬∑¬∑+xnmn)
 = ‚àû
for all x2,...,xm in T1.

3.4 Pointwise Convergence of Fourier Series
211
Proof. The proof of part (b) is obtained by considering the continuous function
F(x1,...,xn) = f(x1), where f is as in part (a). Then we have
(F ‚àóDn
N)(x1,...,xn) = ( f ‚àóDN)(x1)
and thus the square partial sums of F diverge on the (n ‚àí1)-dimensional plane
{(x0,x2,...,xn) : x2,...,xn ‚ààT1}.
We now prove part (a) using functional analysis. For a constructive proof, see
Exercise 3.4.7. Let C(T1) be the Banach space of all continuous functions on the
circle equipped with the L‚àûnorm. Consider the continuous linear functionals
f ‚ÜíTN( f) = (DN ‚àóf)(0)
on C(T1) for N = 1,2,.... We show that the norms of the TN‚Äôs on C(T1) converge to
inÔ¨Ånity as N ‚Üí‚àû. To see this, given any integer N ‚â•100, let œïN(x) be a continuous
even function on [‚àí1
2, 1
2] that is bounded by 1 and is equal to the sign of DN(x)
except at small intervals of length (2N +1)‚àí2 around the 2N +1 zeros of DN. Call
the union of all these intervals BN and set AN = [‚àí1
2, 1
2]\BN. Then

BN
DN(x)
dx+


BN
œïN(x)DN(x)dx
 ‚â§2|BN|(2N +1) = 2.
Using this estimate we obtain
TN

C(T1)‚ÜíC ‚â•|TN(œïN)| =


T1 DN(‚àíx)œïN(x)dx

‚â•

AN
DN(x)
dx‚àí


BN
DN(x)œïN(x)dx

=

T1
DN(x)
dx‚àí


BN
DN(x)œïN(x)dx
‚àí

BN
DN(x)
dx
‚â•4
œÄ2
N
‚àë
k=1
1
k ‚àí2.
It follows that the norms of the linear functionals TN are not uniformly bounded. The
uniform boundedness principle now implies the existence of a function f ‚ààC(T1)
and of a sequence Nj ‚Üí‚àûsuch that
|TNj( f)| ‚Üí‚àû
as j ‚Üí‚àû. The Fourier series of this f diverges at x0 = 0.
‚ñ°

212
3 Fourier Series
3.4.4 Pointwise Convergence of the Dirichlet Means
We have seen that continuous functions may have divergent Fourier series. How
about Lipschitz continuous functions? As it turns out, there is a more general condi-
tion that implies convergence for the Fourier series of functions that satisfy a certain
integrability condition.
Theorem 3.4.7. (Dini) Let f be an integrable function on T1, let t0 be a point on T1
for which f(t0) is deÔ¨Åned and assume that

|t|‚â§1
2
| f(t +t0)‚àíf(t0)|
|t|
dt < ‚àû.
(3.4.9)
Then (Dn
N ‚àóf)(t0) ‚Üíf(t0) as N ‚Üí‚àû.
(Tonelli) Let f be an integrable function on Tn and let a = (a1,...,an) ‚ààTn. If f is
deÔ¨Åned at a and

|x1|‚â§1
2
¬∑¬∑¬∑

|xn|‚â§1
2
| f(x+a)‚àíf(a)|
|x1|¬∑¬∑¬∑|xn|
dxn ¬∑¬∑¬∑dx1 < ‚àû,
(3.4.10)
then we have (Dn
N ‚àóf)(a) ‚Üíf(a) as N ‚Üí‚àû.
Proof. Since the one-dimensional result is contained in the multidimensional one,
we prove the latter. Replacing f(x) by f(x + a) ‚àíf(a), we may assume that a = 0
and f(a) = 0. Using identities (3.1.15) and (3.1.14), we can write
(Dn
N ‚àóf)(0) =

Tn f(‚àíx)
n
‚àè
j=1
sin((2N +1)œÄxj)
sin(œÄxj)
dxn ¬∑¬∑¬∑dx1
(3.4.11)
=

Tn f(‚àíx)
n
‚àè
j=1
sin(2NœÄxj)cos(œÄxj)
sin(œÄxj)
+cos(2NœÄxj)

dxn ¬∑¬∑¬∑dx1 .
Expand out the product to express the integrand as a sum of terms of the form
$
f(‚àíx)‚àè
j‚ààI
cos(œÄxj)
sin(œÄxj)
%
‚àè
j‚ààI
sin(2NœÄxj)
‚àè
k‚àà{1,2,...,n}\I
cos(2NœÄxk),
(3.4.12)
where I is a subset of {1,2,...,n}; here we use the convention that the product over
an empty set of indices is 1. The function fI inside the curly brackets in (3.4.12)
is integrable on [‚àí1
2, 1
2)n except possibly in a neighborhood of the origin, since
|sin(œÄxj)| ‚â•2|xj| when |xj| ‚â§1
2. But condition (3.4.10) with a = 0 and f(a) = 0
guarantees that fI is also integrable in a neighborhood of the origin. Expressing the
sines and cosines in (3.4.12) in terms of exponentials, we obtain that the integral of
(3.4.12) over [‚àí1
2, 1
2)n is a Ô¨Ånite linear combination of Fourier coefÔ¨Åcients of fI at
the points (¬±N,...,¬±N) ‚ààZn. Applying Lemma 3.3.1 yields that the expression in
(3.4.11) tends to zero as N ‚Üí‚àû.
‚ñ°

3.4 Pointwise Convergence of Fourier Series
213
The following are consequences of this test.
Corollary 3.4.8. (a) (Riemann‚Äôs principle of localization) Let f be an integrable
function on T1 that vanishes on an open interval I. Then DN ‚àóf converges to zero
on the interval I.
(b) Let a = (a1,...,an) ‚ààTn and suppose that an integrable function f on Tn is
constant on the cross
{x = (x1,...,xn) ‚ààTn : |xj ‚àíaj| < Œ¥ j
for some j},
where 0 < Œ¥ j < 1/2 are Ô¨Åxed. Then (Dn
N ‚àóf)(a) ‚Üíf(a) as N ‚Üí‚àû.
Proof. (a) Let t0 ‚ààI. If f vanishes on I, condition (3.4.9) holds, since the function
t ‚Üíf(t +t0)‚àíf(t0) vanishes on ‚àít0 +I, which is an interval containing the origin,
and is integrable outside ‚àít0 +I. Thus (DN ‚àóf)(t0) ‚Üíf(t0) = 0 for every t0 ‚ààI.
(b) We need to show that the function
| f(x+a)‚àíf(a)|
|x1|¬∑¬∑¬∑|xn|
is integrable over Tn = [‚àí1/2,1/2)n. The integral of this function over Tn is equal
to its integral over the region
S = {(x1,...,xn) ‚ààTn : |xk| ‚â•Œ¥k
for all k},
since f(x+a)‚àíf(a) vanishes whenever |xj| < Œ¥ j for some j ‚àà{1,2,...,n}. But on
S we have that
| f(x+a)‚àíf(a)|
|x1|¬∑¬∑¬∑|xn|
‚â§| f(x+a)‚àíf(a)|
Œ¥1 ¬∑¬∑¬∑Œ¥n
and this function is integrable over S, since f is. We deduce that (3.4.10) holds.
‚ñ°
Corollary 3.4.9. Let a ‚ààTn and suppose that f ‚ààL1(Tn) satisÔ¨Åes
| f(x)‚àíf(a)| ‚â§C|x1 ‚àía1|Œµ1 ¬∑¬∑¬∑|xn ‚àían|Œµn
for some C,Œµ j > 0 and for all x ‚ààTn. Then the square partial sums (Dn
N ‚àóf)(a)
converge to f(a).
Proof. Note that condition (3.4.10) holds.
‚ñ°
Corollary 3.4.10. (Dirichlet) If f is deÔ¨Åned on T1 and is a differentiable function
at a point a in T1, then (DN ‚àóf)(a) ‚Üíf(a).
Proof. There exists a Œ¥ > 0 (say less than 1/2) such that | f(x) ‚àíf(a)|/|x ‚àía| is
bounded by | f ‚Ä≤(a)| + 1 for |x ‚àía| ‚â§Œ¥. Also | f(x) ‚àíf(a)|/|x ‚àía| is bounded by
| f(x)‚àíf(a)|/Œ¥ when |x‚àía| > Œ¥. It follows that condition (3.4.9) holds.
‚ñ°

214
3 Fourier Series
Exercises
3.4.1. Identify T1 with [‚àí1/2,1/2) and Ô¨Åx 0 < b < 1/2. Prove the following:
(a) The mth Fourier coefÔ¨Åcient of the function x is i (‚àí1)m
2œÄm when m Ã∏= 0 and 0 when
m = 0.
(b) The mth Fourier coefÔ¨Åcient of the function œá[‚àíb,b] is sin(2œÄbm)
mœÄ
when m Ã∏= 0 and
2b when m = 0.
(c) The mth Fourier coefÔ¨Åcient of the function

1‚àí|x|
b

+ is sin2(œÄbm)
bm2œÄ2
when m Ã∏= 0
and b when m = 0.
(d) The mth Fourier coefÔ¨Åcient of the function |x| is ‚àí
1
2m2œÄ2 + (‚àí1)m
2m2œÄ2 when m Ã∏= 0
and 1
4 when m = 0.
(e) The mth Fourier coefÔ¨Åcient of the function x2 is (‚àí1)m
2m2œÄ2 when m Ã∏= 0 and
1
12
when m = 0.
(f) The mth Fourier coefÔ¨Åcient of the function cosh(2œÄx) is (‚àí1)m
1+m2
sinhœÄ
œÄ
.
(g) The mth Fourier coefÔ¨Åcient of the function sinh(2œÄx) is im(‚àí1)m
1+m2
sinhœÄ
œÄ
.
3.4.2. Use Exercise 3.4.1 and Proposition 3.4.2 to prove that
‚àë
k‚ààZ
1
(2k +1)2 = œÄ2
4
‚àë
k‚ààZ\{0}
1
k2 = œÄ2
3
‚àë
k‚ààZ\{0}
(‚àí1)k+1
k2
= œÄ2
6
‚àë
k‚ààZ
(‚àí1)k
k2 +1 =
2œÄ
eœÄ ‚àíe‚àíœÄ .
3.4.3. Let M > N be given positive integers.
(a) For f ‚ààL1(T1), prove the following identity:
(DN ‚àóf)(x) = M +1
M ‚àíN (FM ‚àóf)(x)‚àíN +1
M ‚àíN (FN ‚àóf)(x)
‚àíM +1
M ‚àíN
‚àë
N<| j|‚â§M

1‚àí
| j|
M +1

1f( j)e2œÄi jx .
(b) (G. H. Hardy) Suppose that a function f on T1 satisÔ¨Åes the following condition:
for any Œµ > 0 there exists an a > 1 and a k0 > 0 such that for all k ‚â•k0 we have
‚àë
k<|m|‚â§[ak]
| 1f(m)| < Œµ.
Use part (a) to prove that if (FN ‚àóf)(x) converges (uniformly) to A(x) as N ‚Üí‚àû,
then (DN ‚àóf)(x) also converges (uniformly) to A(x) as N ‚Üí‚àû.

3.4 Pointwise Convergence of Fourier Series
215
3.4.4. Use Proposition 3.4.2 to show that for 0 < b < 1
2 we have
lim
N‚Üí‚àû
N
‚àë
m=‚àíN
mÃ∏=0
sin(2œÄbm)
mœÄ
e2œÄibm = 1
2 ‚àí2b.

Hint: Use Exercise 3.4.1(b).

3.4.5. Let f be an integrable function on Tn and g be a bounded function on Tn
and let K be a compact subset of Tn. Consider the family F = {fw : w ‚ààK}, where
fw(x) = f(x‚àíw)g(x) for all x ‚ààTn. Prove that the Riemann‚ÄìLebesgue lemma holds
uniformly for the family F. This means that given Œµ > 0 there exists an N0(K) > 0
such that for |m| ‚â•N0 we have | 1fw(m)| ‚â§Œµ for all w ‚ààK.
3.4.6. Prove the following version of Corollary 3.4.8 (b). Suppose that a function f
on Tn is constant on the cross U = {(x1,...,xn) ‚ààTn : |xj ‚àíaj| < Œ¥ for some j},
for some Œ¥ < 1/2. Then Dn
N ‚àóf converges to f(a) uniformly on compact subsets of
the box W = {(x1,...,xn) ‚ààTn : |xj| < Œ¥ for all j}.

Hint: Use Exercise 3.4.5.

3.4.7. Follow the steps given to obtain a constructive proof of the existence of a
continuous function whose Fourier series diverges at a point. Identify T1 with [0,1)
and deÔ¨Åne
g(x) = ‚àí2œÄi(x‚àí1/2).
(a) Prove that 1g(m) = 1/m when m Ã∏= 0 and zero otherwise.
(b) Prove that for all nonnegative integers M and N we have

(e2œÄiN(¬∑)(g‚àóDN))‚àóDM

(x) = e2œÄiNx ‚àë
1‚â§|r|‚â§N
1
r e2œÄirx
when M ‚â•2N and

(e2œÄiN(¬∑)(g‚àóDN))‚àóDM

(x) = e2œÄiNx
‚àë
‚àíN‚â§r‚â§M‚àíN
rÃ∏=0
1
r e2œÄirx
when M < 2N. Conclude that there exists a constant C > 0 such that for all M, N,
and x Ã∏= 0 we have
|

e2œÄiN(¬∑)(g‚àóDN)

‚àóDM(x)| ‚â§C
|x| .
(c) Show that there exists a constant C1 > 0 such that
sup
N>0
sup
x‚ààT1
(g‚àóDN)(x)
 = sup
N>0
sup
x‚ààT1
 ‚àë
1‚â§|r|‚â§N
1
r e2œÄirx
 ‚â§C1 < ‚àû.

216
3 Fourier Series
(d) Let Œªk = 1+eek. DeÔ¨Åne
f(x) =
‚àû
‚àë
k=1
1
k2 e2œÄiŒªkx(g‚àóDŒªk)(x)
and prove that f is continuous on T1 and that its Fourier series converges at every
x Ã∏= 0, but limsupM‚Üí‚àû|( f ‚àóDM)(0)| = ‚àû.

Hint: Take M = eem with m ‚Üí‚àû. The inequality in part (b) follows by summation
by parts.

3.5 A Tauberian theorem and Functions of Bounded Variation
The relation between the partial sums of a Fourier series and the Fej¬¥er means is a
particular situation of a relation between sequences of complex numbers and their
arithmetic means. Given a sequence {ak}‚àû
k=0 of complex numbers, we denote its
partial sums by
sN = a1 +¬∑¬∑¬∑+aN
for N ‚â•0, and its arithmetic or Ces`aro means by
œÉN =
1
N +1
N
‚àë
k=0
sk =
1
N +1
N
‚àë
k=0
(N +1‚àík)ak .
A classical result says that if sN ‚ÜíL as N ‚Üí‚àû, then œÉN ‚ÜíL as N ‚Üí‚àû. The converse
is not true, as the example ak = (‚àí1)k indicates. But in a particular situation the
reverse implication holds.
3.5.1 A Tauberian theorem
We have the following result concerning the convergence of {sk}‚àû
k=0 as a conse-
quence of that of {œÉk}‚àû
k=0.
Theorem 3.5.1. (a) Suppose that for a sequence {ak}‚àû
k=0 of complex numbers we
have that œÉN ‚ÜíL as N ‚Üí‚àûand that |kak| ‚â§M < ‚àûfor all k = 0,1,2,.... Then
sk ‚ÜíL as k ‚Üí‚àû.
(b) Let X be a nonempty set. Suppose that for a sequence {ak(x)}‚àû
k=0 of complex-
valued functions on X we have that œÉN(x) ‚ÜíL(x) uniformly in x ‚ààX as N ‚Üí‚àû
and that supk‚â•0 supx‚ààX |kak(x)| ‚â§M < ‚àû. Then sk(x) ‚ÜíL(x) uniformly in x ‚ààX as
k ‚Üí‚àû.

3.5 A Tauberian theorem and Functions of Bounded Variation
217
Proof. We prove part (b), noting that the proof of part (a) is subsumed in that of (b).
For 0 ‚â§k < m < ‚àûwe have
(m+1)œÉm(x)‚àí(k +1)œÉk(x)‚àí
m
‚àë
j=k+1
(m+1‚àíj)aj(x)
=
m
‚àë
j=0
(m+1‚àíj)aj(x)‚àí
k
‚àë
j=0
(k +1‚àíj)aj(x)‚àí
m
‚àë
j=k+1
(m+1‚àíj)aj(x)
=(m‚àík)
k
‚àë
j=0
aj(x)
=(m‚àík)sk(x).
Therefore we have
m+1
m‚àík œÉm(x)‚àík +1
m‚àíkœÉk(x)‚àí
1
m‚àík
m
‚àë
j=k+1
(m+1‚àíj)aj(x) = sk(x)
and thus
sk(x)‚àíœÉk(x) = m+1
m‚àík (œÉm(x)‚àíœÉk(x))‚àím+1
m‚àík
m
‚àë
j=k+1
1
j ‚àí
1
m+1

jaj(x). (3.5.1)
Notice that
m
‚àë
j=k+1
1
j ‚àí
1
m+1

‚â§
 m
k
dt
t ‚àí
m
‚àë
j=k+1
1
m+1 = log m
k ‚àím‚àík
m+1 .
(3.5.2)
Now Ô¨Åx Œµ > 0 such that Œµ < 1. For each k ‚ààZ+ pick an mk ‚àà{k,k+1,...,2k} such
that mk
k ‚Üí1+Œµ. Then mk+1
mk‚àík converges to Œµ‚àí1 +1 as k ‚Üí‚àû, hence it is bounded by
some constant CŒµ. Then (3.5.1) and (3.5.2) with mk in place of m yield
sup
x‚ààX
sk(x)‚àíœÉk(x)
 ‚â§CŒµ sup
x‚ààX
|œÉmk(x)‚àíœÉk(x)|+M mk +1
mk ‚àík
/
log mk
k ‚àímk ‚àík
mk +1
0
.
Taking the limsupk‚Üí‚àûin the preceding inequality and using that
limsup
k‚Üí‚àû
sup
x‚ààX
|œÉmk(x)‚àíœÉk(x)| = 0,
which is a consequence of the hypothesis that œÉk (and thus œÉmk) converges to L
uniformly, we obtain
limsup
k‚Üí‚àû
sup
x‚ààX
sk(x)‚àíœÉk(x)
 ‚â§M
/
1+ 1
Œµ

log(1+Œµ)‚àí1
0
.

218
3 Fourier Series
In view of the Taylor expansion
log(1+Œµ) = Œµ ‚àí1
2Œµ2 + 1
3Œµ3 ‚àí¬∑¬∑¬∑ = Œµ +O(Œµ2),
which is valid for 0 < Œµ < 1, we conclude that
limsup
k‚Üí‚àû
sup
x‚ààX
sk(x)‚àíœÉk(x)
 ‚â§M cŒµ
for some absolute constant c > 0. Since Œµ > 0 was arbitrary, we Ô¨Ånally deduce that
sk(x) converges uniformly to the same limit as œÉk(x), which is L(x).
‚ñ°
Corollary 3.5.2. Suppose that a function f on T1 is continuous and there is a con-
stant M > 0 such that | 1f(m)| ‚â§M|m|‚àí1 for all m ‚ààZ+ \{0}. Then the Fourier series
of f converges uniformly to f. In particular, if f is a continuous function of bounded
variation on the circle, then f ‚àóDN ‚Üíf uniformly on T1 as N ‚Üí‚àû.
Proof. The Fej¬¥er means {FN}‚àû
N=0 are an approximate identity on Tn (Proposition
3.1.10) and so FN ‚àóf converge uniformly to f on T1 as N ‚Üí‚àûin view of Theorem
1.2.19 (2). Moreover, we have |m|| 1f(m)| ‚â§M for all m ‚ààZ. It follows from Theorem
3.5.1 that DN ‚àóf converges uniformly to f.
If, additionally, f is a function of bounded variation, then |m|| 1f(m)| ‚â§1
2œÄ Var( f),
as shown in Proposition 3.3.14. Then the claimed conclusion follows.
‚ñ°
3.5.2 The sine integral function
We examine a few useful properties of the antiderivative of sin(t)/t.
DeÔ¨Ånition 3.5.3. For 0 ‚â§x < ‚àûdeÔ¨Åne the sine integral function
Si(x) =
 x
0
sin(t)
t
dt .
(3.5.3)
Integrating by parts we write
Si(x) =
 1
0
sin(t)
t
dt + ‚àícos(x)
x
+cos(1)‚àí
 x
1
cos(t)
t2
dt ,
from which it follows that the limit of Si(x) as x ‚Üí‚àûexists and is equal to
lim
x‚Üí‚àûSi(x) =
 1
0
sin(t)
t
dt +cos(1)‚àí
 ‚àû
1
cos(t)
t2
dt .

3.5 A Tauberian theorem and Functions of Bounded Variation
219
To precisely evaluate the limit of Si(x) as x ‚Üí‚àûwe write
Si((N + 1
2)œÄ) =œÄ

1
2
0
sin((2N +1)œÄt)
œÄt
dt
=œÄ

1
2
0
sin((2N +1)œÄt)
sin(œÄt)
dt +œÄ

1
2
0 sin((2N +1)œÄt)
$ 1
œÄt ‚àí
1
sin(œÄt)
%
dt
=œÄ
2

1
2
‚àí1
2
DN(t)dt + œÄ
2

1
2
‚àí1
2
e(2N+1)œÄit ‚àíe‚àí(2N+1)œÄit
2i
$ 1
œÄt ‚àí
1
sin(œÄt)
%
dt,
which converges to œÄ/2 + 0 as N ‚Üí‚àû, in view of the Riemann-Lebesgue lemma
(Proposition 3.3.1), since the function inside the curly brackets is integrable over the
circle. We conclude that limx‚Üí‚àûSi(x) = œÄ/2.
Note that Si‚Ä≤ vanishes at nœÄ, n = 0,1,2,... and Si‚Ä≤‚Ä≤(nœÄ) = (‚àí1)n/nœÄ. Conse-
quently, Si(x) has local maxima at the points œÄ, 3œÄ, 5œÄ, ... and local minima at the
points 2œÄ, 4œÄ, 6œÄ, .... Moreover, it is increasing on the intervals [2kœÄ,(2k + 1)œÄ]
and decreasing on [(2k +1)œÄ,(2k +2)œÄ], k = 0,1,2,.... Also, observe that
Si(3œÄ)‚àíSi(œÄ) =
 2œÄ
œÄ
sin(t)
t
dt +
 2œÄ
œÄ
sin(t +œÄ)
t +œÄ
dt =
 2œÄ
œÄ
sin(t)
1
t ‚àí
1
t +œÄ

dt < 0
and likewise we can prove the remaining inequalities in the sequence
Si(œÄ) > Si(3œÄ) > Si(5œÄ) > Si(7œÄ) > ¬∑¬∑¬∑ > œÄ
2 .
Similarly, one can show that
Si(2œÄ) < Si(4œÄ) < Si(6œÄ) < ¬∑¬∑¬∑ < œÄ
2 .
Hence Si(œÄ) is the absolute maximum of Si(x) on [0,‚àû), while 0 is the absolute
minimum of Si(x) on [0,‚àû); Si(œÄ) is the absolute minimum of Si(x) on [œÄ,‚àû).
3.5.3 Further properties of functions of bounded variation
Next we have the following theorem concerning functions of bounded variation.
Recall that functions of bounded variation are differences of increasing functions
and thus have left and right limits at every point.
Theorem 3.5.4. Let 0 < Œ¥ ‚â§1/2. Suppose that f is an integrable function on T1
which is of bounded variation on the neighborhood [t0 ‚àíŒ¥,t0 + Œ¥] of the point
t0 ‚ààT1. Then
lim
N‚Üí‚àû( f ‚àóDN)(t0) = f(t0+)+ f(t0‚àí)
2
.

220
3 Fourier Series
Proof. We write W for the neighborhood (‚àíŒ¥,Œ¥) of 0, Ft0(t) = f(t0‚àít)+ f(t0+t)
2
, and
Lt0 = f(t0+)+ f(t0‚àí)
2
. We have
( f ‚àóDN)(t0) =

T1 f(t0 ‚àít)DN(t)dt =

T1 f(t0 +t)DN(t)dt ,
hence, averaging yields
( f ‚àóDN)(t0) =

T1
f(t0 ‚àít)+ f(t0 +t)
2
DN(t)dt =

T1 Ft0(t)DN(t)dt .
Therefore we have
( f ‚àóDN)(t0)‚àíLt0 =

W

Ft0(t)‚àíLt0

DN(t)dt +

T1\W

Ft0(t)‚àíLt0

DN(t)dt
and since in the second integral |t| ‚â•Œ¥, the Riemann-Lebesgue lemma shows that
the second term is o(1), i.e., it tends to zero as N ‚Üí‚àû. We now show that the Ô¨Årst
integral also goes to zero. We write

W

Ft0(t)‚àíLt0

DN(t)dt =

W

Ft0(t)‚àíLt0
sin((2N +1)œÄt)
œÄt
dt
(3.5.4)
+

W

Ft0(t)‚àíLt0

1
sin(œÄt) ‚àí1
œÄt

sin((2N +1)œÄt)dt ,
but since the function 1
œÄt ‚àí
1
sin(œÄt) remains bounded on [‚àí1
2, 1
2] (Exercise 3.1.5 (a)), it
follows from the Riemann-Lebesgue lemma that the second term is o(1) as N ‚Üí‚àû.
Consequently,
( f ‚àóDN)(t0)‚àíLt0 = 1
œÄ

W

Ft0(t)‚àíLt0
sin((2N +1)œÄt)
t
dt +o(1)
as N ‚Üí‚àû. To prove the required conclusion, it will sufÔ¨Åce to show that
2
œÄ
 Œ¥
0

Ft0(t)‚àíLt0
sin((2N +1)œÄt)
t
dt ‚Üí0
(3.5.5)
as N ‚Üí‚àû. Let Si(t) be as deÔ¨Åned in (3.5.3). We express the integral in (3.5.5) as
 Œ¥
0

Ft0(t)‚àíLt0

Si‚Ä≤((2N +1)œÄt)dt
(3.5.6)
Integrating by parts we obtain that (3.5.6) is equal to
(Ft0(Œ¥‚àí)‚àíLt0)Si((2N +1)œÄŒ¥)‚àí
 Œ¥
0 Si((2N +1)œÄt)dFt0(t).
(3.5.7)

3.5 A Tauberian theorem and Functions of Bounded Variation
221
Letting N ‚Üí‚àûand using the Lebesgue dominated convergence theorem, we con-
clude that (3.5.7) converges to
(Ft0(Œ¥‚àí)‚àíLt0)œÄ
2 ‚àí
 Œ¥
0
œÄ
2 dFt0(t) = (Ft0(Œ¥‚àí)‚àíLt0)œÄ
2 ‚àí(Ft0(Œ¥‚àí)‚àíFt0(0+))œÄ
2 = 0
noticing that Lt0 = Ft0(0+).
‚ñ°
Next, we obtain an explicit bound for the partial sums of functions of bounded
variation. Let Si(t) be as in (3.5.3).
Theorem 3.5.5. Suppose that f is a function of bounded variation on the circle T1.
Then the partial sums of the Fourier series of f are uniformly bounded, in particular,
we have
sup
t0‚ààT1 sup
N‚ààZ+ |( f ‚àóDN)(t0)| ‚â§

1‚àí2
œÄ +Si(œÄ)

‚à•f‚à•L‚àû+Si(œÄ)Var( f).
(3.5.8)
Proof. We take Œ¥ = 1/2 in the proof of the preceding theorem. For a point t0 ‚ààT1,
let Ft0(t) = f(t0‚àít)+ f(t0+t)
2
. We have that
( f ‚àóDN)(t0) =

T1 Ft0(t)sin((2N +1)œÄt)
œÄt
dt
+

T1 Ft0(t)

1
sin(œÄt) ‚àí1
œÄt

sin((2N +1)œÄt)dt .
(3.5.9)
Using that

1
sin(œÄt) ‚àí1
œÄt
 ‚â§1‚àí2
œÄ when |t| ‚â§1
2 (Exercise 3.1.5 (a)), we obtain that the
second integral in (3.5.9) is bounded by (1‚àí2
œÄ )‚à•f‚à•L‚àû. Integrating by parts as in the
proof of the preceding theorem, we express the Ô¨Årst integral in (3.5.9) as
Ft0( 1
2‚àí)Si((2N +1)œÄ 1
2)‚àí

1
2
0 Si((2N +1)œÄt)dFt0(t),
(3.5.10)
which is bounded (in absolute value) by ‚à•f‚à•L‚àûSi(œÄ) + Si(œÄ)Var( f). Assertion
(3.5.8) now follows.
‚ñ°
3.5.4 Gibbs phenomenon
It is not reasonable to expect that the Fourier series of a discontinuous function
converges uniformly in a neighborhood of a discontinuity. The lack of uniformity in
the convergence can be measured in terms of the worst jump, called the overshoot.
The exact form of nonuniform convergence is illustrated in the following example:

222
3 Fourier Series
Example 3.5.6. Consider the function
h(t) =
‚éß
‚é™
‚é®
‚é™
‚é©
1
2 ‚àít
when 0 < t ‚â§1
2
0
when t = 0
‚àí1
2 ‚àít
when ‚àí1
2 < t < 0.
(3.5.11)
Clearly h(t) is a function of bounded variation and is continuous except at the point
t = 0 at which it has a jump discontinuity. Since h is an odd function, its Fourier
coefÔ¨Åcients are
1h(m) =
 1/2
‚àí1/2 h(t)e‚àí2œÄimt dt = ‚àí2i
 1/2
0
( 1
2 ‚àít)sin(2œÄmt)dt = ‚àí
i
2mœÄ
when m Ã∏= 0 and 1h(0) = 0. The partial sums of the Fourier series of h are
(h‚àóDN)(t) = ‚àíi
2œÄ ‚àë
|m|‚â§N
mÃ∏=0
e2œÄimt
m
.
Notice that
d
dt (h‚àóDN)(t) = ‚àë
|m|‚â§N
mÃ∏=0
e2œÄimt = DN(t)‚àí1.
Then, if we deÔ¨Åne d(s) =
1
sin(œÄs) ‚àí1
œÄs, we can write
(h‚àóDN)(t) =
 t
0 DN(s)‚àí1ds
= ‚àít +
 t
0
sin((2N +1)œÄs)
sin(œÄs)
ds
= ‚àít +
 t
0 d(s)sin((2N +1)œÄs)ds+
 t
0
sin((2N +1)œÄs)
œÄs
ds.
Notice that d(s) is continuous at zero and d(0) = 0, while lims‚Üí0
d(s)
s = œÄ
6 ; thus d is a
differentiable function on [0, 1
2] and d‚Ä≤(0) = œÄ
6 . Moreover, lims‚Üí0 d‚Ä≤(s) = d‚Ä≤(0), thus
d is continuously differentiable on [0, 1
2]. Additionally both d and d‚Ä≤ are nonnegative
and increasing on [0, 1
2], thus d‚Ä≤ ‚â§4
œÄ ; see the hint of Exercise 3.1.5. It follows that
 t
0 d(s)sin((2N +1)œÄs)ds = ‚àícos((2N +1)œÄt)
(2N +1)œÄ
d(t)+
 t
0 d‚Ä≤(s)cos((2N +1)œÄs)
(2N +1)œÄ
ds
and the preceding expression is bounded in absolute value by ( d( 1
2 )
œÄ
+ 1
2
d‚Ä≤( 1
2 )
œÄ
)
1
2N+1.
We deduce that
(h‚àóDN)(t) = ‚àít + 1
œÄ
 t
0
sin((2N +1)œÄs)
s
ds+O

1
2N +1

,

3.5 A Tauberian theorem and Functions of Bounded Variation
223
where O

1
2N+1

is a function bounded by 1
œÄ
1
2N+1. Consequently,
(h‚àóDN)(t) = ‚àít + 1
œÄ
 (2N+1)œÄt
0
sin(s)
s
ds+O

1
2N +1

.
Hence for t ‚àà(0,‚àí1
2] we have limN‚Üí‚àû(h‚àóDN)(t) = ‚àít + 1
œÄ
œÄ
2 = 1
2 ‚àít as expected.
Analogously for t ‚àà[‚àí1
2,0) we have limN‚Üí‚àû(h ‚àóDN)(t) = ‚àí1
2 ‚àít. Also for t = 0,
limN‚Üí‚àû(h‚àóDN)(0) = 0. Thus the Fourier series of h at zero converges to the ‚Äúfair‚Äù
value of the average of h(0+) and h(0‚àí) which happens to be h(0) = 0.
To quantitatively estimate the nonuniformity of the convergence of (h ‚àóDN)(t)
we note that
(h‚àóDN)(t)‚àí( 1
2 ‚àít) = 1
œÄ
 (2N+1)œÄt
0
sin(s)
s
ds‚àí1
2 +O

1
2N +1

.
Thus for all N = 1,2,... and t ‚àà(0, 1
2] we have
(h‚àóDN)(t)‚àíh(t) ‚â§Si(œÄ)
œÄ
‚àí1
2 + 1
œÄ
1
2N +1 ‚â§.08949¬∑¬∑¬∑+
œÄ‚àí1
2N +1 .
Also, for any sequence tN ‚Üí0+ we have
limsup
N‚Üí‚àû

(h‚àóDN)(tN)‚àíh(tN)

‚â§Si(œÄ)
œÄ
‚àí1
2 = .08949...,
(3.5.12)
while if for each N we consider the value tN = 1/(2N +1), we obtain that
limsup
N‚Üí‚àû

(h‚àóDN)(tN)‚àíh(tN)

= Si(œÄ)
œÄ
‚àí1
2 = .08949....
(3.5.13)
‚àí0.4
‚àí0.2
0.2
0.4
‚àí0.6
‚àí0.4
‚àí0.2
0.2
0.4
0.6
Fig. 3.3 The partial sums (h‚àóD40)(t) showing the overshoot of approximately 9% of the jump of
h at zero.

224
3 Fourier Series
The quantity .08949... is called the overshoot of the partial sums of the Fourier
series of the function h in a neighborhood of zero. See Figure 3.3.
We now examine the preceding phenomenon in the setting of functions of
bounded variation. These functions can be written as a differences of two increasing
functions, so they have countable sets of discontinuities. Suppose we are given a
function f ‚ààL1(T1) of bounded variation, and for the sake of simplicity, let us con-
sider the situation where it has exactly one discontinuity, say at the point t0 ‚ààT1.
Consider the function h deÔ¨Åned in (3.5.11) and deÔ¨Åne
f0(t) =

f(t0+)‚àíf(t0‚àí)

h(t ‚àít0)+ f(t0+)+ f(t0‚àí)
2
when t Ã∏= t0,
f(t0)
when t = t0.
(3.5.14)
Now the function f ‚àíf0 is of bounded variation and is also continuous and satisÔ¨Åes
( f ‚àíf0)(t0) = 0. In view of Corollary 3.5.2, the Fourier series of f ‚àíf0 converges
uniformly to f ‚àíf0 and so the lack of uniformity of the convergence of the partial
sums of f is due to the presence of f0.
We express these observations as a theorem.
Theorem 3.5.7. (a) Let h be deÔ¨Åned in (3.5.11). Then the set of accumulation points
of sets of the form {(h‚àóDN)(tN)}N‚ààZ+, where tN ‚àà[0,1/2], is the interval

0, Si(œÄ)
œÄ

=

0,0.58949...

.
In particular if tN ‚Üí0 such that NtN ‚Üí1
2, then
lim
N‚Üí‚àû(h‚àóDN)(tN) = Si(œÄ)
œÄ
= 0.58949... .
(b) Let f be a function of bounded variation on the circle with a single discontinuity
at the point t0, such that f(t0+)‚àíf(t0‚àí) > 0. Then the set of accumulation points
of sets of the form {( f ‚àóDN)(tN)}N‚ààZ+, where tN ‚àà[t0,t0 +Œ¥], for some Œ¥ > 0, is the
interval
/
f(t0+)+ f(t0‚àí)
2
, f(t0+)+ f(t0‚àí)
2
+ Si(œÄ)
œÄ

f(t0+)‚àíf(t0‚àí)
0
.
In particular if tN ‚Üít0+ such that N(tN ‚àít0) ‚Üí1
2, then
lim
N‚Üí‚àû( f ‚àóDN)(tN) = f(t0+)+ f(t0‚àí)
2
+ Si(œÄ)
œÄ

f(t0+)‚àíf(t0‚àí)

.
Proof. (a) Since h ‚â•0 on (0, 1
2] and (h ‚àóDN)(t) ‚Üí1
2 ‚àít for 0 < t ‚â§1
2 we have
that all accumulation points of sequences (h‚àóDN)(tN) are nonnegative. We showed
in (3.5.12) that all accumulation points of sequences (h ‚àóDN)(tN) ‚àíh(tN) are at
most Si(œÄ)
œÄ
‚àí1
2; but h(tN) ‚â§1
2, when tN ‚àà[0, 1
2], hence all accumulation points of
sequences (h‚àóDN)(tN) are at most Si(œÄ)
œÄ
and thus contained in

0, Si(œÄ)
œÄ

. Also, 0 is
attained as the accumulation point of (h‚àóDN)(0) and the number Si(œÄ)
œÄ
is attained as
the accumulation point of the sequence (h‚àóDN)(
1
2N+1) as shown in (3.5.13); notice

3.5 A Tauberian theorem and Functions of Bounded Variation
225
that the same assertion is valid for any other sequence tN ‚Üí0 such that NtN ‚Üí1
2.
Now, since the functions (h‚àóDN)(t) are continuous, given any c in

0, Si(œÄ)
œÄ

, there
is a t‚Ä≤
N between 0 and
1
2N+1 such that (h ‚àóDN)(t‚Ä≤
N) = c for all N; this shows that
the set of accumulation points of sequences of the form {( f ‚àóDN)(tN)}N‚ààZ+ is the
interval

0, Si(œÄ)
œÄ

.
(b) To examine the behavior of f ‚àóDN near the point of a single jump discon-
tinuity t0 of f, we reduce matters to the preceding situation as alluded earlier, by
introducing the function f0 deÔ¨Åned in (3.5.14). Then for a sequence tN converging
to t0 from the right we have
( f ‚àóDN)(tN)
= ( f ‚àíf0)‚àóDN(tN)+

f(t0+)‚àíf(t0‚àí)

(h‚àóDN)(tN ‚àít0)+ f(t0+)+ f(t0‚àí)
2
=

f(t0+)‚àíf(t0‚àí)
/
(h‚àóDN)(tN ‚àít0)‚àíh(tN ‚àít0)
0
+

f(t0+)‚àíf(t0‚àí)

h(tN ‚àít0)+( f ‚àíf0)‚àóDN(tN)+ f(t0+)+ f(t0‚àí)
2
.
Applying limsupN‚Üí‚àûand using (3.5.12), we obtain as N ‚Üí‚àû
limsup
N‚Üí‚àû
( f ‚àóDN)(tN) ‚â§

f(t0+)‚àíf(t0‚àí)
 Si(œÄ)
œÄ
‚àí1
2 + 1
2

+ f(t0+)+ f(t0‚àí)
2
,
where we used the following consequence of Theorem 3.5.4
limsup
N‚Üí‚àû
( f ‚àíf0)‚àóDN(tN) = ( f ‚àíf0)(t0) = 0.
This shows that all accumulation points of sequences of the form {( f ‚àóDN)(tN)}N‚ààZ+
are at most

f(t0+)‚àíf(t0‚àí)
 Si(œÄ)
œÄ
+ 1
2

f(t0+)+ f(t0‚àí)

. Also, since all accumu-
lation points of sequences (h ‚àóDN)(tN) are nonnegative, when tN lies to the right
of t0, it follows from the identity f = ( f ‚àíf0) + f0 and (3.5.14) that all accumula-
tion points of {( f ‚àóDN)(tN)}N‚ààZ+ are at least 1
2

f(t0+) + f(t0‚àí)

. As in part (a)
the intermediate value theorem implies that every point in the interval having the
aforementioned endpoints is also an accumulation point for the sequence at hand. ‚ñ°
Exercises
3.5.1. Let Si(t) be the sine function as deÔ¨Åned in (3.5.3).
(a) Prove that | œÄ
2 ‚àíSi(t)| ‚â§2
t .
(b) Show that Si(Nt) ‚ÜíœÄ
2 uniformly in t ‚àà[Œ¥,‚àû) for any Œ¥ > 0.
3.5.2. Show that the sine integral function has the following expansion
Si(x) =
‚àû
‚àë
k=1
(‚àí1)kx2k+1
(2k +1)(2k +1)! .

226
3 Fourier Series
3.5.3. Let L1
1(T1) be the space of all differentiable functions on T1 whose deriva-
tives are integrable. Obtain the inclusions L1
1(T1) ‚äÜBV(T1) ‚äÜL‚àû(T1) as follows:
(a) If f ‚ààL1
1(T1), then Var( f) ‚â§‚à•f ‚Ä≤‚à•L1.
(b) If f ‚ààBV(T1), then ‚à•f‚à•L‚àû‚â§Var( f)+| f(0)|.
3.5.4. (a) Let ak ‚â•0, sN = ‚àëN
k=‚àíN ak, and œÉN =
1
N+1(œÉ0 +¬∑¬∑¬∑+œÉN). Suppose that
œÉN ‚ÜíL < ‚àûas N ‚Üí‚àû. Prove that sN ‚ÜíL as N ‚Üí‚àû.
(b) Apply the preceding result to show that if a complex-valued function h on T1 is
continuous in a neighborhood of 0 and 1h(m) ‚â•0 for all m ‚ààZ, then h(0) ‚â•0 and
‚àëm‚ààZ1h(m) = h(0) < ‚àû; i.e., the partial sums of the Fourier series of h converge at
zero.
3.5.5. Let h ‚ààL1(T1), t0 ‚ààT1, and 0 < Œ¥ < 1/2.
(a) Show that (h‚àóDN)(t0) ‚ÜíL as N ‚Üí‚àûif and only if
lim
M‚Üí‚àû
 Œ¥
0
h(t0 ‚àít)+h(t0 +t)
2
‚àíL
sin(Mt)
t
dt = 0.
(b) Conclude that if an integrable function h on T1 satisÔ¨Åes
 Œ¥
0
|h(t0 ‚àít)+h(t0 +t)‚àí2L|
t
dt < ‚àû,
then (h‚àóDN)(t0) ‚ÜíL as N ‚Üí‚àû.
(c) In particular, if there are constants C,Œ≤ > 0 with Œ≤ < 1 such that for all t with
0 < t < Œ¥ we have
|h(t0 ‚àít)+h(t0 +t)‚àí2h(t0)| ‚â§CtŒ≤ ,
then (h‚àóDN)(t0) ‚Üíh(t0) as N ‚Üí‚àû.
(d) If h is an odd function, then (h‚àóDN)(0) ‚Üí0 as N ‚Üí‚àû.
3.5.6. Let f ‚ààL1(T1) and suppose that (a,b) is an interval in T1. Then we have
lim
N‚Üí‚àû
 b
a ( f ‚àóDN)(t)dt =
 b
a f(t)dt .

Hint: Use Theorems 3.5.4 and 3.5.5 and the fact that the operator f ‚Üíf ‚àóDN is
self-adjoint.

3.6 Lacunary Series and Sidon Sets
Lacunary series provide examples of 1-periodic functions on the line that possess
certain remarkable properties.

3.6 Lacunary Series
227
3.6.1 DeÔ¨Ånition and Basic Properties of Lacunary Series
We begin by deÔ¨Åning lacunary sequences.
DeÔ¨Ånition 3.6.1. A sequence of positive integers Œõ = {Œªk}‚àû
k=1 is called lacunary if
there exists a constant A > 1 such that Œªk+1 ‚â•AŒªk for all k ‚ààZ+.
Examples of lacunary sequences are provided by exponential sequences, such as
Œªk = 2k,3k,4k,.... Observe that polynomial sequences such as Œªk = 1 + k2 are not
lacunary. Note that lacunary sequences tend to inÔ¨Ånity as k ‚Üí‚àû.
An important observation about lacunary sequences is the following: for any
m,k0 ‚ààZ+ we have
1 ‚â§|m‚àíŒªk0| < (1‚àíA‚àí1)Œªk0 =‚áím /‚ààŒõ .
(3.6.1)
Indeed, to prove this assertion, notice that the closest numbers to Œªk0 among of the
terms of the sequence {Œªk}‚àû
k=1 are Œªk0+1 and Œªk0‚àí1 (the latter only if k0 > 1) and
thus if j > k0 we have
|Œª j ‚àíŒªk0| ‚â•Œªk0+1 ‚àíŒªk0 ‚â•AŒªk0 ‚àíŒªk0 = (A‚àí1)Œªk0 ‚â•(1‚àíA‚àí1)Œªk0 ,
while if j < k0
|Œª j ‚àíŒªk0| ‚â•Œªk0 ‚àíŒªk0‚àí1 ‚â•Œªk0 ‚àí1
AŒªk0 = (1‚àíA‚àí1)Œªk0 .
Thus (3.6.1) follows.
We begin with the following result.
Proposition 3.6.2. Let {Œªk}‚àû
k=1 be a lacunary sequence and let f be an integrable
function on the circle that is differentiable at a point and has Fourier coefÔ¨Åcients
1f(m) =

am
when m = Œªk ,
0
when m Ã∏= Œªk .
(3.6.2)
Then we have
lim
k‚Üí+‚àû
1f(Œªk)Œªk = 0.
Proof. Applying translation, we may assume that the point at which f is differen-
tiable is the origin. Replacing f by the 1-periodic function
g(t) = f(t)‚àíf(0)cos(2œÄt)‚àíf ‚Ä≤(0)sin(2œÄt)
2œÄ
we may assume that f(0) = f ‚Ä≤(0) = 0. (We have 1g(m) = 1f(m) for |m| ‚â•2 and thus
the Ô¨Ånal conclusion for f is equivalent to that for g.)

228
3 Fourier Series
Using (3.6.1) and (3.6.2), we obtain that for any m ‚ààZ we have
1 ‚â§|m‚àíŒªk| < (1‚àíA‚àí1)Œªk =‚áí1f(m) = 0.
(3.6.3)
Let [t] denote the integer part of t. Given Œµ > 0, pick a positive integer k0 such that
if [(1‚àíA‚àí1)Œªk0] = 2N0, then N‚àí2
0
< Œµ, and
sup
|x|<N
‚àí1
4
0

f(x)
x
 < Œµ .
(3.6.4)
The expression in (3.6.4) can be made arbitrarily small, since f is differentiable at
the origin. Now take an integer k with k ‚â•k0 and set 2N = [min(A‚àí1,1‚àíA‚àí1)Œªk],
which is of course at least 2N0. Using (3.6.3), we obtain that for any trigonometric
polynomial KN of degree 2N with 2
KN(0) = 1 we have
1f(Œªk) =

|x|‚â§1
2
f(x)KN(x)e‚àí2œÄiŒªkx dx.
(3.6.5)
We take KN = (FN/‚à•FN‚à•L2)2, where FN is the Fej¬¥er kernel. Using (3.1.18), we obtain
Ô¨Årst the identity
FN
2
L2 =
N
‚àë
j=‚àíN

1‚àí
| j|
N +1
2
= 1+ 1
3
N(2N +1)
N +1
> N
3
(3.6.6)
and also the estimate
FN(x)2 ‚â§

1
N +1
1
4x2
2
,
(3.6.7)
which is valid for |x| ‚â§1/2. In view of (3.6.6) and (3.6.7), we have the estimate
KN(x) ‚â§3
16
1
N3
1
x4 .
(3.6.8)
We now use (3.6.5) to obtain
Œªk 1f(Œªk) = Œªk

|x|‚â§1
2
f(x)KN(x)e‚àí2œÄiŒªkx dx = I1
k +I2
k +I3
k ,
where
I1
k = Œªk

|x|‚â§N‚àí1 f(x)KN(x)e‚àí2œÄiŒªkx dx,
I2
k = Œªk

N‚àí1<|x|‚â§N‚àí1
4 f(x)KN(x)e‚àí2œÄiŒªkx dx,
I3
k = Œªk

N‚àí1
4 <|x|‚â§1
2
f(x)KN(x)e‚àí2œÄiŒªkx dx.

3.6 Lacunary Series
229
Since ‚à•KN‚à•L1 = 1, it follows that
|I1
k | ‚â§Œªk
N
sup
|x|<N‚àí1

f(x)
x
 ‚â§
(2N +1)Œµ
min(A‚àí1,1‚àíA‚àí1)N ,
which can be made arbitrarily small if Œµ is small. Also, using (3.6.8), we obtain
|I2
k | ‚â§3Œªk
16N3
sup
|x|<N‚àí1
4

f(x)
x


N‚àí1<|x|‚â§N‚àí1
4
dx
|x|3 ‚â§3Œªk
16N
sup
|x|<N‚àí1
4

f(x)
x
,
which, as observed, is bounded by a constant multiple of Œµ. Finally, using again
(3.6.8), we obtain
|I3
k | ‚â§
3
16N3 NŒªk

N‚àí1
4 <|x|‚â§1
2
| f(x)|dx ‚â§
3
16N2
 f

L1 < 3Œµ
16
f

L1 .
It follows that for all k ‚â•k0 we have
|Œªk 1f(Œªk)| ‚â§|I1
k |+|I2
k |+|I3
k | ‚â§C( f)Œµ
for some Ô¨Åxed constant C( f). This proves the required conclusion.
‚ñ°
Corollary 3.6.3. (Weierstrass) There exists a continuous function on the circle that
is nowhere differentiable.
Proof. Consider the 1-periodic function
f(t) =
‚àû
‚àë
k=0
2‚àíke2œÄi3kt .
Since this series converges absolutely and uniformly, f is a continuous function. If f
were differentiable at a point, then by Proposition 3.6.2 we would have that 3k 1f(3k)
tends to zero as k ‚Üí‚àû. Since 1f(3k) = 2‚àík for k ‚â•0, this is not the case. Therefore, f
is nowhere differentiable. The real and imaginary parts of this function are displayed
in Figure 3.4.
‚ñ°
3.6.2 Equivalence of Lp Norms of Lacunary Series
We now turn to one of the most important properties of lacunary series, equivalence
of their norms. It is a remarkable result that lacunary Fourier series have comparable
Lp norms for 1 ‚â§p < ‚àû. More precisely, we have the following theorem:
Theorem 3.6.4. Let 1 ‚â§Œª1 < Œª2 < Œª3 < ¬∑¬∑¬∑ be a lacunary sequence with constant
A > 1. Set Œõ = {Œªk : k ‚ààZ+}. Then for all 1 ‚â§p < ‚àû, there exists a constant Cp(A)
such that for all f ‚ààL1(T1), with 1f(k) = 0, when k ‚ààZ\Œõ we have

230
3 Fourier Series
-0.4
-0.2
0.2
0.4
-2
-1
1
2
-0.4
-0.2
0.2
0.4
-1
-0.5
0.5
1
Fig. 3.4 The graph of the real and imaginary parts of the function f(t) = ‚àë‚àû
k=0 2‚àíke2œÄi3kt.
f

Lp(T1) ‚â§Cp(A)
f

L1(T1) .
(3.6.9)
Moreover, the converse inequality to (3.6.9) is valid, and thus all Lp norms of lacu-
nary Fourier series are equivalent for 1 ‚â§p < ‚àû.
Proof. We suppose initially that f ‚ààL2(T1) and f is nonzero. We deÔ¨Åne
fN(x) =
N
‚àë
j=1
1f(Œª j)e2œÄiŒª jx .
(3.6.10)
Given 2 ‚â§p < ‚àû, we pick an integer m with 2m > p and we also pick a positive
integer r such that Ar > m. Then we can write fN as a sum of r functions œïs, s =
1,2,...,r, where each œïs has Fourier coefÔ¨Åcients that vanish except possibly on the
lacunary set
{Œªkr+s : k ‚ààZ+ ‚à™{0}} = {Œº1,Œº2,Œº3,...}.
It is a simple fact that the sequence {Œºk}k is lacunary with constant Ar. Then we
have
 1
0 |œïs(x)|2m dx =
‚àë
1‚â§j1,..., jm,k1,...,km‚â§N
Œº j1+¬∑¬∑¬∑+Œº jm=Œºk1+¬∑¬∑¬∑+Œºkm
1œïs(Œº j1)¬∑¬∑¬∑ 1œïs(Œº jm) 1œïs(Œºk1)¬∑¬∑¬∑ 1œïs(Œºkm).
We claim that if Œº j1 +¬∑¬∑¬∑+ Œº jm = Œºk1 +¬∑¬∑¬∑+ Œºkm, then
max(Œº j1,...,Œº jm) = max(Œºk1,...,Œºkm).
Indeed, if max(Œº j1,...,Œº jm) > max(Œºk1,...,Œºkm), then
max(Œº j1,...,Œº jm) ‚â§Œºk1 +¬∑¬∑¬∑+ Œºkm ‚â§mmax(Œºk1,...,Œºkm).
But since
Ar max(Œºk1,...,Œºkm) ‚â§max(Œº j1,...,Œº jm),

3.6 Lacunary Series
231
it would follow that Ar ‚â§m, which contradicts our choice of r. Likewise, we elimi-
nate the case max(Œº j1,...,Œº jm) < max(Œºk1,...,Œºkm). We conclude that these num-
bers are equal. We can now continue the same reasoning using induction to conclude
that if Œº j1 +¬∑¬∑¬∑+ Œº jm = Œºk1 +¬∑¬∑¬∑+ Œºkm, then
{Œºk1,...,Œºkm} = {Œº j1,...,Œº jm}.
Using this fact in the evaluation of the previous multiple sum, we obtain
 1
0 |œïs(x)|2m dx =
N
‚àë
j1=1
¬∑¬∑¬∑
N
‚àë
jm=1
| 1œïs(Œº j1)|2 ¬∑¬∑¬∑| 1œïs(Œº jm)|2 =
œïs
2
L2
m ,
which implies that ‚à•œïs‚à•L2m = ‚à•œïs‚à•L2 for all s ‚àà{1,2,...,r}. Then we have
fN

Lp ‚â§
fN

L2m ‚â§‚àör
 r
‚àë
s=1
œïs
2
L2m
 1
2 = ‚àör
 r
‚àë
s=1
œïs
2
L2
 1
2 = ‚àör
fN

L2 ,
since the functions œïs are orthogonal in L2. Since r can be chosen to be [logA m]+1
and m can be taken to be [ p
2]+1, we have now established the inequality
fN

Lp(T1) ‚â§cp(A)
fN

L2(T1) ,
p ‚â•2,
(3.6.11)
with cp(A) =
!
1+

logA

[ p
2]+1

for every fN of the form (3.6.10).
To replace fN by f in (3.6.11), we recall our assumption that f ‚ààL2(T1). We
observe that fN ‚Üíf in L2 and thus fNj tends to f a.e. for some subsequence. Then
Fatou‚Äôs lemma and (3.6.11) imply for 1 < p < ‚àû
 1
0 | f(x)|p dx =
 1
0 liminf
j‚Üí‚àû| fNj(x)|p dx
‚â§liminf
j‚Üí‚àû
 1
0 | fNj(x)|p dx
‚â§cp(A)p liminf
j‚Üí‚àû
fNj
p
L2
= cp(A)pf
p
L2 .
We conclude that
f

Lp(T1) ‚â§cp(A)
f

L2(T1) ,
p ‚â•2.
(3.6.12)
By interpolation we obtain
 f

L2 ‚â§
f

2
3
L4
f

1
3
L1 ‚â§

[logA 3]+1
 1
2 ¬∑ 2
3 f

2
3
L2
 f

1
3
L1 .

232
3 Fourier Series
We are assuming that 0 < ‚à•f‚à•L2 < ‚àûand the preceding inequality implies that
f

L2(T1) ‚â§

[logA 3]+1
 f

L1(T1) .
(3.6.13)
Finally an easy consequence of H¬®older‚Äôs inequality is that
 f

Lp(T1) ‚â§
f

L2(T1) ,
1 ‚â§p < 2.
(3.6.14)
Combining (3.6.12) and (3.6.14) with (3.6.13) yields (3.6.9) with
Cp(A) = cp(A)

[logA 3]+1

for all 1 ‚â§p < ‚àûunder the hypothesis that 1f(k) = 0 for all k ‚ààZ \ Œõ and the
additional assumption that f ‚ààL2.
We now extend the result to f ‚ààL1(T1). Given f ‚ààL1(T1) with 1f(k) = 0 when
k ‚ààZ\Œõ, consider the functions f ‚àóFM, where FM is the Fej¬¥er kernel and M ‚ààZ+.
Then f ‚àóFM lie in L2, f ‚àóFM converge to f in L1 and in Lp, and 
f ‚àóFM(k) = 0 when
k ‚ààZ\Œõ. The inequality
f ‚àóFM

Lp(T1) ‚â§Cp(A)
f ‚àóFM

L1(T1)
(3.6.15)
holds since f ‚àóFM lie in L2, so letting M ‚Üí‚àûyields (3.6.9).
‚ñ°
Theorem 3.6.4 describes the equivalence of the Lp norms of lacunary Fourier
series for p < ‚àû. The question that remains is whether there is a similar charac-
terization for the L‚àûnorms of lacunary Fourier series. Such a characterization is
investigated below. Before we state and prove this theorem, we need a classical tool,
referred to as a Riesz product.
DeÔ¨Ånition 3.6.5. A Riesz product is a function of the form
PN(x) =
N
‚àè
j=1

1+aj cos(2œÄŒª jx+2œÄŒ≥ j)

,
(3.6.16)
where N is a positive integer, Œª1 < Œª2 < ¬∑¬∑¬∑ < ŒªN is a lacunary sequence of positive
integers, aj are real numbers in [‚àí1,1], and Œ≥ j ‚àà[0,1].
We make a few observations about Riesz products. A simple calculation gives
that if PN, j(x) = 1+aj cos(2œÄŒª jx+2œÄŒ≥ j), then
3
PN, j(m) =
‚éß
‚é™
‚é™
‚é™
‚é®
‚é™
‚é™
‚é™
‚é©
1
when m = 0,
1
2aje2œÄiŒ≥ j
when m = Œª j,
1
2aje‚àí2œÄiŒ≥ j
when m = ‚àíŒª j,
0
when m /‚àà{0}‚àû
j=1{Œª j,‚àíŒª j}.
(3.6.17)
Assume that the constant A associated with the lacunary sequence Œª1<Œª2<¬∑¬∑¬∑<ŒªN
satisÔ¨Åes A ‚â•3. Then each integer m has at most one representation as a sum

3.6 Lacunary Series
233
m = Œµ1Œª1 +¬∑¬∑¬∑+ŒµNŒªN ,
where Œµ j ‚àà{‚àí1,1,0}; see Exercise 3.6.1. We now calculate the Fourier coefÔ¨Åcients
of the Riesz product deÔ¨Åned in (3.6.16). For a Ô¨Åxed integer b, let us denote by Œ¥b the
sequence of integers that is equal to 1 at b and zero otherwise. Then, using (3.6.17),
we obtain that
3
PN, j = Œ¥0 + 1
2aje2œÄiŒ≥ jŒ¥Œª j + 1
2aje‚àí2œÄiŒ≥ jŒ¥‚àíŒª j ,
and thus 2
PN is the N-fold convolution of these functions. Using that Œ¥a ‚àóŒ¥b = Œ¥a+b,
we obtain
2
PN(m) =
‚éß
‚é™
‚é®
‚é™
‚é©
1
when m = 0,
‚àèN
j=1
1
2aje2œÄiŒµ jŒ≥ j
when m = ‚àëN
j=1 Œµ jŒª j and ‚àëN
j=1 |Œµ j| > 0,
0
otherwise.
It follows that 2
PN(Œª j) = 0 since for j ‚â•N + 1, Œª j cannot be expressed as a linear
combination of Œª1,...,ŒªN with coefÔ¨Åcients in {¬±1,0}. Also 2
PN(Œªk) = 1
2aje2œÄiŒ≥k for
1 ‚â§k ‚â§N, since each Œªk is written uniquely as 0¬∑Œª1 +¬∑¬∑¬∑+0¬∑Œªk‚àí1 +1¬∑Œªk. Hence
when A ‚â•3 we have that 2
PN(Œªk) = 1
2aje2œÄiŒ≥k when 1 ‚â§k ‚â§N and 2
PN(Œªk) = 0 for
k ‚â•N +1.
Next, we discuss an important property of Riesz products. Suppose that for some
m ‚ààZ we have 2
PN(m) Ã∏= 0. We write m = ‚àëN
j=1 Œµ jŒª j uniquely with Œµ j ‚àà{‚àí1,0,1}.
Let k be the largest integer less than or equal to N such that Œµk Ã∏= 0. Then we have
|m|‚àíŒªk
 ‚â§Œª1 +¬∑¬∑¬∑+Œªk‚àí1 ‚â§
Œªk
Ak‚àí1 +¬∑¬∑¬∑+ Œªk
A ‚â§Œªk
A
1
1‚àí1
A
=
Œªk
A‚àí1 .
(3.6.18)
Another important property of the Riesz product is that since PN ‚â•0 we have
‚à•PN‚à•L1 =

T1 PN(t)dt = 2
PN(0) = 1.
We recall the space A(T1) of all functions with absolutely summable Fourier
coefÔ¨Åcients normed with the ‚Ñì1 norm of the coefÔ¨Åcients.
Theorem 3.6.6. Let 1 < Œª1 < Œª2 < Œª3 < ¬∑¬∑¬∑ be a lacunary sequence of integers with
constant A > 1. Set Œõ = {Œªk : k ‚ààZ+}. Then there exists a constant C(A) such that
for all f ‚ààL‚àû(T1) with 1f(k) = 0 when k ‚ààZ\Œõ we have
 f

A(T1) = ‚àë
k‚ààŒõ
| 1f(k)| ‚â§C(A)
f

L‚àû(T1) .
(3.6.19)
Proof. Let us assume Ô¨Årst that A ‚â•3. Also Ô¨Åx f ‚ààL‚àû(T1). We consider the Riesz
product
PN(x) =
N
‚àè
j=1

1+cos(2œÄŒª jx+2œÄŒ≥ j)

,

234
3 Fourier Series
where Œ≥ j is chosen to satisfy the identity | 1f(Œª j)| = e2œÄiŒ≥ j 1f(Œª j). In view of Parseval‚Äôs
relation and of the fact that ‚à•PN‚à•L1 = 1 we obtain
 ‚àë
m‚ààZ
2
PN(m) 1f(m)
 =

 1
0 PN(x) f(x)dx
 ‚â§
f

L‚àû,
(3.6.20)
and the sum in (3.6.20) is Ô¨Ånite, since the Fourier coefÔ¨Åcients of 2
PN form a Ô¨Ånitely
supported sequence. But 1f(m) = 0 for m /‚ààŒõ, while 2
PN(Œª j) = 1
2e2œÄiŒ≥ j for 1 ‚â§j ‚â§N
since A ‚â•3, and moreover, 2
PN(Œª j) = 0 for j ‚â•N + 1, as observed earlier. Thus
(3.6.20) reduces to
1
2
N
‚àë
j=1
 1f(Œª j)
 =

N
‚àë
j=1
1
2e2œÄiŒ≥ j 1f(Œª j)
 ‚â§
f

L‚àû.
Letting N ‚Üí‚àû, we deduce that ‚àë‚àû
j=1 | 1f(Œª j)| ‚â§2‚à•f‚à•L‚àû, which proves (3.6.19) when
A ‚â•3.
We now consider the case A < 3. We Ô¨Åx 1 < A < 3 and we pick a positive integer
r such that
Ar > 3
and
1
Ar ‚àí1 < 1‚àí1
A .
(3.6.21)
This is possible, since (Ar ‚àí1)‚àí1 ‚Üí0 as r ‚Üí‚àû.
For each s ‚àà{1,...,r}, deÔ¨Åne the sequences Œª s
k = Œªs+(k‚àí1)r indexed by k =
1,2,3,... and observe that Œª s
(k+1) > ArŒª s
k for all k = 1,2,...; i.e., each such se-
quence is lacunary with constant Ar. We consider the Riesz product
Ps
N(x) =
N
‚àè
k=1

1+cos(2œÄŒª s
k x+2œÄŒ≥s
k)

,
where Œ≥s
k is deÔ¨Åned via the identity | 1f(Œª s
k)| = e2œÄiŒ≥s
k 1f(Œª s
k).
Using (3.6.18) we obtain that, if m ‚ààZ is such that 2
Ps
N(m) Ã∏= 0, then there exists
a k ‚àà{1,2 ...,N} such that
|m|‚àíŒª s
k
 <
Œª s
k
Ar ‚àí1 .
This combined with (3.6.21) yields
|m|‚àíŒª s
k
 <

1‚àí1
A

Œª s
k .
Using (3.6.1) we obtain that either m = ¬±Œª s
k or |m| /‚ààŒõ. Thus we have
{m ‚ààZ+ : 2
Ps
N(m) Ã∏= 0} ‚´Ö{Œª s
1,Œª s
2,...,Œª s
N}‚à™Œõ c .

3.6 Lacunary Series
235
This observation, the fact that 1f is supported in Œõ, and Parseval‚Äôs relation yield

N
‚àë
k=1
2
Ps
N(Œª s
k) 1f(Œª s
k)
 =
 ‚àë
m‚ààZ
2
Ps
N(m) 1f(m)
 =

 1
0 Ps
N(x) f(x)dx
 ‚â§
f

L‚àû. (3.6.22)
Since 2
PN(Œª s
k) = 1
2e2œÄiŒ≥s
k for 1 ‚â§k ‚â§N, (3.6.22) reduces to
1
2
N
‚àë
k=1
 1f(Œª s
k)
 ‚â§
f

L‚àû.
Letting N ‚Üí‚àûgives
‚àû
‚àë
j=1
 1f(Œª s
j)
 ‚â§2
f

L‚àû.
Summing over s in the set {1,2,...,r}, we obtain the required conclusion with
C(A) = 2r and note that r can be taken to be [max(logA
2A‚àí1
A‚àí1 ,log3 A)]+2.
‚ñ°
Corollary 3.6.7. Let Œõ = {Œªk : k ‚ààZ+} be a lacunary set and let f be a bounded
function on the circle that satisÔ¨Åes 1f(k) = 0 when k ‚ààZ \Œõ. Then f is almost ev-
erywhere equal to the absolutely (and uniformly) convergent series
f(x) = ‚àë
k‚ààŒõ
1f(k)e2œÄikx
a.e.
(3.6.23)
and thus it is almost everywhere equal to a continuous function.
Proof. It follows from Theorem 3.6.6 that if 1f(k) = 0 when k ‚ààZ\Œõ, then we have
that f ‚ààA(T1). Applying the inversion result in Proposition 3.2.5 we obtain that f is
almost everywhere equal to a continuous function and that (3.6.23) holds for almost
all x ‚ààT1.
‚ñ°
3.6.3 Sidon sets
Given a subset E of the integers, we denote by CE the space of all continuous func-
tions on T1 such that
m ‚ààZ\E =‚áí1f(m) = 0.
(3.6.24)
It is straightforward that CE is a closed subspace of all bounded functions on the
circle T1 with the standard L‚àûnorm.
DeÔ¨Ånition 3.6.8. A set of integers E is called a Sidon set if every function in CE has
an absolutely convergent Fourier series.
There are several characterizations of Sidon sets. We state them below.
Proposition 3.6.9. The following assertions are equivalent for a subset E of Z.

236
3 Fourier Series
(1) There is a constant K such that for all trigonometric polynomials P with 1P
supported in E we have
‚àë
m‚ààZ
|1P(m)| ‚â§K
P

L‚àû
(2) There exists a constant K such that
 1f

‚Ñì1(Z) ‚â§K
 f

L‚àû(T1)
for every bounded function f on T1 with 1f supported in E.
(3) Every function f in CE has an absolutely convergent Fourier series; i.e., E is a
Sidon set.
(4) For every bounded function b on E there is a Ô¨Ånite Borel measure Œº on T1 such
that 1Œº(m) = b(m) for all m ‚ààE.
(5) For every function b on Z with the property b(m) ‚Üí0 as m ‚Üí‚àû, there is a
function g ‚ààL1(T1) such that 1g(m) = b(m) for all m ‚ààE.
Proof. Suppose that (1) holds. Given f in L‚àû(T1) with 1f is supported in E, write
( f ‚àóFN)(x) =
N
‚àë
m=‚àíN

1‚àí|m|
N +1

1f(m)e2œÄimx ,
where FN is the Fej¬¥er kernel. These are trigonometric polynomials whose Fourier
coefÔ¨Åcients vanish on Z\E. Applying (1) we obtain
‚àë
k‚ààZ

1‚àí|m|
N +1

| 1f(m)| ‚â§K
f ‚àóFN

L‚àû.
Letting N ‚Üí‚àûwe obtain (2).
It is trivial that (2) implies (3).
If (3) holds, then the map f ‚Üí1f is a linear bijection from CE to ‚Ñì1(E). Moreover
its inverse mapping 1f ‚Üíf is continuous, since
 f

L‚àû(T1) ‚â§sup
t‚àà[0,1]
 ‚àë
k‚ààZ
1f(k)e2œÄikt ‚â§‚àë
k‚ààZ
| 1f(k)| =
 1f

‚Ñì1(Z) .
By the open mapping theorem, it follows that f ‚Üí1f is a continuous mapping, which
proves the existence of a constant K such that (1) holds.
We have now proved the equivalence of (1), (2), and (3).
We show that (2) implies (4). If E is a Sidon set and if b is a bounded function
on E, say ‚à•b‚à•‚Ñì‚àû‚â§1, then the mapping
f ‚Üí‚àë
m‚ààE
1f(m)1b(m)

3.6 Lacunary Series
237
is a bounded linear functional on CE with norm at most K. By the Hanh-Banach
theorem this functional admits an extension to C (T1) with the same norm. Hence
there is a measure Œº, whose total variation ‚à•Œº‚à•does not exceed K, such that
‚àë
m‚ààE
1f(m)1b(m) =

T1 f(t)dŒº(t).
Taking f(t) = e2œÄimt in (2) we obtain 1Œº(m) = b(m) for all m ‚ààE.
If (4) holds and b(m) ‚Üí0 as |m| ‚Üí‚àû, using Lemma 3.3.2 there is a con-
vex sequence c(m) such that c(m) > 0, c(m) ‚Üí0 as |m| ‚Üí‚àû, c(‚àím) = c(m),
and |b(m)| ‚â§c(m) for all m ‚ààZ. By (4), there is a Ô¨Ånite Borel measure Œº with
1Œº(m) = b(m)/c(m) for all m ‚ààE.
By Theorem 3.3.4, there is a function g in L1(T1) such that 1g(m) = c(m) for all
m ‚ààZ. Then b(m) = 1g(m)1Œº(m) for all m ‚ààE. Since f = g ‚àóŒº is in L1, we have
b(m) = 1f(m) for all m ‚ààE, and thus (4) implies (5).
Finally, if (5) holds, we show (3). Given f ‚ààCE, we show that for an arbi-
trary sequence dm tending to zero, we have ‚àëm‚ààZ | 1f(m)dm| < ‚àû; this implies that
‚àëm‚ààZ | 1f(m)| < ‚àû. Given a sequence dm ‚Üí0, pick a function g in L1 such that
1g(m) 1f(m) = | 1f(m)||dm| for all m ‚ààE by assumption (5). Then the series
‚àë
m‚ààZ
1g(m) 1f(m) = ‚àë
m‚ààZ
3
f ‚àóg(m)
(3.6.25)
has nonnegative terms and the function f ‚àóg is continuous, thus FN ‚àó( f ‚àóg)(0) ‚Üí
( f ‚àóg)(0) as N ‚Üí‚àû. It follows that DN ‚àó( f ‚àóg)(0) ‚Üí( f ‚àóg)(0), thus the series in
(3.6.25) converges (see Exercise 3.5.4) and hence ‚àëm‚ààZ | 1f(m)dm| < ‚àû.
‚ñ°
Example 3.6.10. Every lacunary set is a Sidon set. Indeed, suppose that E is a lacu-
nary set with constant A. If f is a continuous function which satisÔ¨Åes (3.6.24), then
Theorem 3.6.6 gives that
‚àë
m‚ààŒõ
| 1f(m)| ‚â§C(A)
f

L‚àû< ‚àû;
hence f has an absolutely convergent Fourier series.
Example 3.6.11. There exist subsets of Z that are not Sidon. For example, Z \ {0}
is not a Sidon set. See Exercise 3.6.7.
Exercises
3.6.1. Suppose that 0 < Œª1 < Œª2 < ¬∑¬∑¬∑ < ŒªN is a lacunary sequence of integers
with constant A ‚â•3. Prove that for every integer m there exists at most one N-tuple
(Œµ1,...,ŒµN) with each Œµ j ‚àà{‚àí1,1,0} such that
m = Œµ1Œª1 +¬∑¬∑¬∑+ŒµNŒªN .

238
3 Fourier Series

Hint: Suppose there exist two such N-tuples. Pick the largest k such that the coefÔ¨Å-
cients of Œªk are different.

3.6.2. Is the sequence Œªk =

e(logk)2
, k = 2,3,4,... lacunary?
3.6.3. Let ak ‚â•0 for all k ‚ààZ+ and 1 ‚â§p < ‚àû. Show that there exist constants
Cp,cp such that for all N ‚ààZ+ we have
cp
 N
‚àë
k=1
|ak|2 1
2 ‚â§
 1
0

N
‚àë
k=1
ake2œÄi2kx
p
dx
 1
p
‚â§Cp
 N
‚àë
k=1
|ak|2 1
2 ,
while
sup
x‚àà[0,1]

N
‚àë
k=1
ake2œÄi2kx =
N
‚àë
k=1
|ak|.
3.6.4. Suppose that 0 < Œª1 < Œª2 < ¬∑¬∑¬∑ is a lacunary sequence and let f be a bounded
function on the circle that satisÔ¨Åes 1f(m) = 0 whenever m ‚ààZ\{Œª1,Œª2,...}. Suppose
also that
sup
tÃ∏=0
| f(t)‚àíf(0)|
|t|Œ±
= B < ‚àû
for some 0 < Œ± < 1.
(a) Prove that there is a constant C such that | 1f(Œªk)| ‚â§CBŒª ‚àíŒ±
k
for all k ‚â•1.
(b) Prove that f ‚àà.
ŒõŒ±(T1).

Hint: Let 2N = [(1 ‚àíA‚àí1)Œªk] and let KN be as in the proof of Proposition 3.6.2.
Write
1f(Œªk) =

|x|‚â§N‚àí1( f(x)‚àíf(0))e‚àí2œÄiŒªkxKN(x)dx
+

N‚àí1‚â§|x|‚â§1
2
( f(x)‚àíf(0))e‚àí2œÄiŒªkxKN(x)dx .
Use that ‚à•KN‚à•L1 = 1 and also the estimate (3.6.7). Part (b): Use the estimate in
part (a).

3.6.5. Let f be an integrable function on the circle whose Fourier coefÔ¨Åcients van-
ish outside a lacunary set Œõ = {Œª1,Œª2,Œª3,...}. Suppose that f vanishes identically
in a small neighborhood of the origin. Show that f is in C ‚àû(T1).

Hint: Let 2N = [(1 ‚àíA‚àí1)Œªk] and let KN be as in the proof of Proposition 3.6.2.
Write
1f(Œªk) =

|x|‚â§1
2
f(x)e‚àí2œÄiŒªkxKN(x)dx
and use estimate (3.6.7) to obtain that f is in C 2. Continue by induction.

3.6.6. Let 1 < a,b < ‚àû. Consider the 1-periodic function
f(x) =
‚àû
‚àë
k=0
a‚àíke2œÄibkx .

3.6 Lacunary Series
239
Prove that the following statements are equivalent:
(a) f is differentiable at a point.
(b) b < a.
(c) f is differentiable everywhere.
3.6.7. Use the example in Proposition 3.4.6 (a) to show that Z\{q1,...,qL} is not
a Sidon set for any Ô¨Ånite subset {q1,...,qL} of the integers.
3.6.8. Let 0 < Œ¥ < 1. Let E be a subset of the integers such that for any sequence
of complex numbers {dm}m‚ààE with |dm| = 1 there is a Ô¨Ånite Borel measure Œº on T1
such that
|1Œº(m)‚àídm| < 1‚àíŒ¥
for all m ‚ààE. Show that E is a Sidon set.

Hint: Given f be in CE deÔ¨Åne dm via the identity dm 1f(m) = | 1f(m)| if 1f(m) Ã∏=
0, otherwise set dm = 1. For the measure Œº given by the hypothesis, notice that
Re(1Œº(m) 1f(m)) ‚â•Œ¥| 1f(m)| for all m ‚ààZ.

HISTORICAL NOTES
Trigonometric series in one dimension were Ô¨Årst considered in the study of the vibrating string
problem and are implicitly contained in the work of d‚ÄôAlembert, D. Bernoulli, Clairaut, and Euler.
The analogous problem for vibrating higher-dimensional bodies naturally suggested the use of mul-
tiple trigonometric series. However, it was the work of Fourier on steady-state heat conduction that
inspired the subsequent systematic development of such series. Fourier announced his results in
1811, although his classical book Th¬¥eorie de la chaleur was published in 1822. This book contains
several examples of heuristic use of trigonometric expansions and motivated other mathematicians
to carefully study such expansions. The systematic development of the theory of Fourier series
began by Dirichlet [96], who studied the pointwise convergence of the Fourier series of piecewise
monotonic functions via the use of the kernel DN, today called the Dirichlet kernel.
The fact that the Fourier series of a continuous function can diverge was Ô¨Årst observed by
DuBois Reymond in 1873. The Riemann‚ÄìLebesgue lemma was Ô¨Årst proved by Riemann in his
memoir on trigonometric series (appeared between 1850 and 1860). It carries Lebesgue‚Äôs name
today because Lebesgue later extended it to his notion of integral. The rebuilding of the theory
of Fourier series based on Lebesgue‚Äôs integral was mainly achieved by de la Vall¬¥ee-Poussin and
Fatou.
Theorem 3.3.16 was obtained by Bernstein [26] in dimension n = 1. Higher-dimensional ana-
logues of the Hardy‚ÄìLittlewood series of Exercise 3.3.8 were studied by Wainger [370]. These
series can be used to produce examples indicating that the restriction s > Œ± + n/2 in Bernstein‚Äôs
theorem is sharp even in higher dimensions. Part (b) of Theorem 3.4.4 is due to Lebesgue when
n = 1 and Marcinkiewicz and Zygmund [243] when n = 2. Marcinkiewicz and Zygmund‚Äôs proof
also extends to higher dimensions. The proof given here is based on Lemma 3.4.5 proved by Stein
[342] in a different context. The proof of Lemma 3.4.5 presented here was suggested by T. Tao.
Abel proved that if an inÔ¨Ånite series ‚àë‚àû
k=0 ak converges and has sum L, then the power series
f(x) = ‚àë‚àû
k=0 akxk converges for |x| < 1 and tends to L as x ‚Üí1‚àí. The converse of this theorem
under the additional assumption that kak ‚Üí0 as k ‚Üí‚àûwas proved by Tauber [358]. Hardy [143]
extended Tauber‚Äôs result (Theorem 3.5.1) for Ces`aro summability under the weaker assumption that
the sequence kak is bounded. Jordan [180] studied of functions of bounded variation and proved
Theorem 3.5.4. The existence of a continuous function which is nowhere differentiable (Corollary
3.6.3) was Ô¨Årst published in 1872 by K. Weierstrass, although earlier Ô¨Åndings of such functions
were published later. The exposition on Sidon sets is taken from the classical article of Rudin
[305], which also contains Exercise 3.6.8.

240
3 Fourier Series
The Gibbs phenomenon (a version of Theorem 3.5.7) was discovered by Wilbraham [376] and
rediscovered by Gibbs [128]; this phenomenon describes the particular way in which the Fourier
sums of a piecewise continuously differentiable periodic function have large oscillations and over-
shoot at the jump discontinuity of the function. BÀÜocher [29] gave a detailed mathematical analysis
of that overshoot, which he called the ‚ÄúGibbs phenomenon‚Äù.
The main references for trigonometric series are the books of Bary [20] and Zygmund [388],
[389]. Other references for one-dimensional Fourier series include the books of Edwards [106],
Dym and McKean [105], Katznelson [190], K¬®orner [202], Pinsky [283], and the Ô¨Årst eight chapters
in Torchinsky [363]. The reader may also consult the book of Krantz [203] for a historical intro-
duction to the subject of Fourier series. A review of the heritage and continuing signiÔ¨Åcance of
Fourier Analysis is written by Kahane [182].
A classical treatment of multiple Fourier series can be found in the last chapter of Bochner‚Äôs
book [32] and in parts of his other book [31]. Other references include the last chapter in Zygmund
[389], the books of Yanushauskas [381] (in Russian) and Zhizhiashvili [384], the last chapter in
Stein and Weiss [348], and the article of Alimov, Ashurov, and Pulatov in [3]. A brief survey article
on the subject was written by Ash [11]. More extensive expositions were written by Shapiro [320],
Igari [171], and Zhizhiashvili [383]. A short note on the history of Fourier series was written by
Zygmund [390]. The book of Shapiro [321] contains a very detailed study of Fourier series in
several variables as well as applications of this theory.

Chapter 4
Topics on Fourier Series
In this chapter we go deeper into the theory of Fourier series and we study topics
such as convergence in norm and the conjugate function, divergence of Fourier se-
ries and Bochner‚ÄìRiesz summability. We also study transference of multipliers on
the torus and of maximal multipliers. This is a powerful technique that allows one
to infer results concerning Fourier series from corresponding results about Fourier
integrals and vice versa.
We also take a quick look at applications of Fourier series such as the isoperti-
metric inequality problem, the distribution of lattice points in a ball, and the heat
equation. The power of Fourier series techniques manifests itself in the study of
these problems which represent only a small part of the wide and vast range of ap-
plications of the subject known today.
4.1 Convergence in Norm, Conjugate Function,
and Bochner‚ÄìRiesz Means
In this section we address the following fundamental question: Do Fourier series
converge in norm? We begin with some abstract necessary and sufÔ¨Åcient conditions
that guarantee such a convergence. In one dimension, we are able to reduce matters
to the study of the so-called conjugate function on the circle, a sister operator of
the Hilbert transform, which is the center of study of the next chapter. In higher
dimensions the situation is more complicated, but we are able to give a positive
answer in the case of square summability.
L. Grafakos, Classical Fourier Analysis, Graduate Texts in Mathematics 249,
DOI 10.1007/978-1-4939-1194-3 4, ¬© Springer Science+Business Media New York 2014
241

242
4 Topics on Fourier Series
4.1.1 Equivalent Formulations of Convergence in Norm
The question we pose is for which indices p, with 1 ‚â§p < ‚àû, we have
Dn
N ‚àóf ‚àíf

Lp(Tn) ‚Üí0
as N ‚Üí‚àû,
(4.1.1)
and similarly for the circular Dirichlet kernel
‚ó¶Dn
N. We tackle this question by looking
at an equivalent formulation of it.
Theorem 4.1.1. For R > 0 and m ‚ààZn, let a(m,R) be complex numbers such that
(i) For every R > 0 there is a qR such that a(m,R) = 0 if |m| > qR.
(ii) There is an M0 < ‚àûsuch that |a(m,R)| ‚â§M0 for all m ‚ààZn and all R > 0.
(iii) For each m ‚ààZn, the limit of a(m,R) exists as R ‚Üí‚àûand limR‚Üí‚àûa(m,R) = am.
Let 1 ‚â§p < ‚àû. For f ‚ààLp(Tn) and x ‚ààTn deÔ¨Åne
SR( f)(x) = ‚àë
m‚ààZn
a(m,R) 1f(m)e2œÄim¬∑x
noting that the sum is well deÔ¨Åned because of (i). Also, for h ‚ààC ‚àû(Tn) deÔ¨Åne
A(h)(x) = ‚àë
m‚ààZn
am1h(m)e2œÄim¬∑x.
Then for all f ‚ààLp(Tn) the sequence SR( f) converges in Lp as R ‚Üí‚àûif and only if
there exists a constant K < ‚àûsuch that
sup
R>0
SR

Lp‚ÜíLp ‚â§K.
(4.1.2)
Furthermore, if (4.1.2) holds, then for the same constant K we have
sup
h‚ààC ‚àû
hÃ∏=0
A(h)

Lp
h

Lp
‚â§K ,
(4.1.3)
and then A extends to a bounded operator #A from Lp(Tn) to itself; moreover, for
every f ‚ààLp(Tn) we have that SR( f) ‚Üí#A( f) in Lp as R ‚Üí‚àû.
Proof. If SR( f) converges in Lp, then ‚à•SR( f)‚à•Lp ‚â§Cf for some constant Cf that
depends on f ‚ààLp(Tn). Moreover, each SR is a bounded operator from Lp(Tn) to
itself with norm at most #{m ‚ààZn : |m| ‚â§qR}M0. Thus {SR}R>0 is a family of Lp-
bounded linear operators that satisfy supR>0 ‚à•SR( f)‚à•Lp ‚â§Cf for each f ‚ààLp(Tn).
The uniform boundedness theorem applies and yields that the operator norms of SR
from Lp to Lp are bounded uniformly in R. This proves (4.1.2).
Conversely, assume (4.1.2). For h ‚ààC ‚àû(Tn), we have that
lim
R‚Üí‚àû‚àë
m‚ààZn
a(m,R)1h(m)e2œÄim¬∑x = ‚àë
m‚ààZn
am1h(m)e2œÄim¬∑x

4.1 Convergence in Norm, Conjugate Function, and Bochner‚ÄìRiesz Means
243
in view of property (ii) and of the Lebesgue dominated convergence theorem, since
‚àëm‚ààZn |1h(m)| < ‚àû. Fatou‚Äôs lemma now gives
A(h)

Lp =
 lim
R‚Üí‚àûSR(h)

Lp ‚â§liminf
R‚Üí‚àû
SR(h)

Lp ‚â§K
h

Lp ;
hence (4.1.3) holds. Thus A extends to a bounded operator #A on Lp(Tn) by density.
We show that for all f ‚ààLp(Tn) we have SR( f) ‚Üí#A( f) in Lp as R ‚Üí‚àû. Fix
f in Lp(Tn) and let Œµ > 0 be given. Pick a trigonometric polynomial P satisfying
‚à•f ‚àíP‚à•Lp ‚â§Œµ. Let d be the degree of P. Then there is an R0 > 0 such that for all
R > R0 we have
‚àë
|m1|+¬∑¬∑¬∑+|mn|‚â§d
|a(m,R)‚àíam||1P(m)| ‚â§Œµ
since a(m,R) ‚Üíam for every m with |m1|+¬∑¬∑¬∑+|mn| ‚â§d. We deduce that
SR(P)‚àíA(P)

Lp ‚â§
SR(P)‚àíA(P)

L‚àû
‚â§
‚àë
|m1|+¬∑¬∑¬∑+|mn|‚â§d
|a(m,R)‚àíam||1P(m)|
‚â§Œµ ,
whenever R > R0. Then
SR( f)‚àí#A( f)

Lp ‚â§
SR( f)‚àíSR(P)

Lp +
SR(P)‚àí#A(P)

Lp +
#A(P)‚àí#A( f)

Lp
‚â§KŒµ +Œµ +KŒµ = (2K +1)Œµ
for R > R0. This proves that SR( f) converges to #A( f) in Lp as R ‚Üí‚àû.
‚ñ°
The most interesting situation arises, of course, when a(m,R) ‚Üíam = 1 for all
m ‚ààZn. In this case A (and #A) is the identity operator, and thus we expect the oper-
ators SR( f) to converge back to f as R ‚Üí‚àû. We should keep in mind the following
three examples:
(a) The sequence a(m,R) = 1 when |mj| ‚â§R for all j ‚àà{1,2,...,n} and zero other-
wise, in which case the operator SR of Theorem 4.1.1 is
SR( f) = f ‚àóDn
R ;
(4.1.4)
(b) The sequence a(m,R) = 1 when |m| ‚â§R and zero otherwise, in which case the
SR of Theorem 4.1.1 is
‚ó¶SR( f) = f ‚àó
‚ó¶Dn
R ;
(4.1.5)
(c) The sequence a(m,R) =

1 ‚àí|m|2
R2
Œ±
+, for some Œ± > 0, in which case we denote
SR by BŒ±
R.

244
4 Topics on Fourier Series
DeÔ¨Ånition 4.1.2. The Bochner‚ÄìRiesz operator or Bochner‚ÄìRiesz means of order
Œ± ‚â•0 is the operator
BŒ±
R( f)(x) = ‚àë
m‚ààZn
|m|‚â§R

1‚àí|m|2
R2
Œ± 1f(m)e2œÄim¬∑x
(4.1.6)
deÔ¨Åned on integrable functions f on Tn.
Corollary 4.1.3. Let 1 ‚â§p < ‚àûand Œ± ‚â•0. Let SR and
‚ó¶SR be as in (4.1.4) and (4.1.5),
respectively, and let BŒ±
R be the Bochner‚ÄìRiesz means as deÔ¨Åned in (4.1.6). Then
‚àÄf ‚ààLp(Tn), lim
R‚Üí‚àû
Dn
R ‚àóf ‚àíf

Lp = 0
‚áê‚áí
sup
R‚â•0
SR

Lp‚ÜíLp < ‚àû,
‚àÄf ‚ààLp(Tn), lim
R‚Üí‚àû
 ‚ó¶Dn
R ‚àóf ‚àíf

Lp = 0
‚áê‚áí
sup
R‚â•0
 ‚ó¶SR

Lp‚ÜíLp < ‚àû,
‚àÄf ‚ààLp(Tn), lim
R‚Üí‚àû
BŒ±
R ‚àóf ‚àíf

Lp = 0
‚áê‚áí
sup
R‚â•0
BŒ±
R

Lp‚ÜíLp < ‚àû.
Example 4.1.4. We investigate the one-dimensional case in some detail. We take
n = 1, and we deÔ¨Åne a(m,N) = 1 for all ‚àíN ‚â§m ‚â§N, and zero otherwise. Then
SN( f) =
‚ó¶SN( f) = DN ‚àóf, where DN is the Dirichlet kernel. Clearly, the expressions
‚à•SN‚à•Lp‚ÜíLp are bounded above by the L1 norm of DN, but this estimation yields a
bound that blows up as N ‚Üí‚àû. We later show, via a more delicate argument, that
the expressions ‚à•SN‚à•Lp‚ÜíLp are uniformly bounded in N when 1 < p < ‚àû.
This reasoning, however, allows us to deduce that for some function g ‚ààL1(T1),
SN(g) may not converge in L1. This is also a consequence of the proof of Theorem
4.2.1; see (4.2.13). Note that since the Fej¬¥er kernel FM has L1 norm 1, we have
SN

L1‚ÜíL1 ‚â•lim
M‚Üí‚àû
DN ‚àóFM

L1 =
DN

L1 .
This implies that the expressions ‚à•SN‚à•L1‚ÜíL1 are not uniformly bounded in N, and
therefore Corollary 4.1.3 gives that for some f0 ‚ààL1(T1), SN( f0) does not converge
to f0 in L1.
Although the partial sums of Fourier series fail to convergence in L1(Tn), it is a
consequence of Plancherel‚Äôs theorem that they converge in L2(Tn). More precisely,
if f ‚ààL2(Tn), then
 ‚ó¶Dn
N ‚àóf ‚àíf
2
L2 = ‚àë
|m|>N
| 1f(m)|2 ‚Üí0
as N ‚Üí‚àûand the same result is true for Dn
N ‚àóf and for BŒ±
R ‚àóf; for the latter, we
apply Theorem 4.1.1, noting that
BŒ±
R( f)
2
L2 = ‚àë
m‚ààZn


1‚àí|m|2
R2
Œ±
+

2
| 1f(m)|2 ‚â§‚àë
m‚ààZn
| 1f(m)|2 =
f
2
L2
and thus supR>0 ‚à•BŒ±
R‚à•L2‚ÜíL2 ‚â§1.

4.1 Convergence in Norm, Conjugate Function, and Bochner‚ÄìRiesz Means
245
Motivated by the preceding discussion for p = 2, it is natural to pose the follow-
ing question. Can 2 be replaced by p Ã∏= 2 in the preceding results? This question has
an afÔ¨Årmative answer in dimension one for DN. In higher dimensions an interesting
dichotomy appears. As a consequence of the one-dimensional result, the square par-
tial sums Dn
N ‚àóf converge in Lp to a given f in Lp(Tn), but for the circular partial
sums this may not be the case.
We begin the discussion with the one-dimensional situation.
DeÔ¨Ånition 4.1.5. For f ‚ààC ‚àû(T1) deÔ¨Åne the conjugate function #f by
#f(x) = ‚àíi ‚àë
m‚ààZ1
sgn(m) 1f(m)e2œÄimx,
where sgn(m) = 1 for m > 0, ‚àí1 for m < 0, and 0 for m = 0. Also deÔ¨Åne the Riesz
projections P+ and P‚àíby
P+( f)(x) =
‚àû
‚àë
m=1
1f(m)e2œÄimx ,
(4.1.7)
P‚àí( f)(x) =
‚àí1
‚àë
m=‚àí‚àû
1f(m)e2œÄimx .
(4.1.8)
Observe that f = P+( f) + P‚àí( f) + 1f(0), while #f = ‚àíiP+( f) + iP‚àí( f), when f
is in C ‚àû(T1). Consequently, one has
P+( f) = 1
2( f +i #f )‚àí1
2
1f(0)
(4.1.9)
and therefore the Lp boundedness of the operator f ‚Üí#f is equivalent to that of the
operator f ‚ÜíP+( f), since the identity and the operator f ‚Üí1f(0) are obviously
Lp bounded. Clearly, these statements are also valid for the other Riesz projection
f ‚ÜíP‚àí( f). The following is a consequence of Theorem 4.1.1.
Proposition 4.1.6. Let 1 ‚â§p < ‚àû. Then the expressions SN( f) = DN ‚àóf converge to
f in Lp(T1) as N ‚Üí‚àûif and only if there exists a constant Cp > 0 such that for all
smooth functions f on Tn we have ‚à•#f ‚à•Lp(T1) ‚â§Cp‚à•f‚à•Lp(T1).
Proof. In view of Corollary 4.1.3, the fact that for all f ‚ààLp(T1), SN( f) ‚Üíf in Lp
as N ‚Üí‚àûis equivalent to the uniform (in N) Lp boundedness of SN.
We note the validity of the identity
e‚àí2œÄiNx
2N
‚àë
m=0

f(¬∑)e2œÄiN(¬∑)1(m)e2œÄimx =
N
‚àë
m=‚àíN
1f(m)e2œÄimx .
Since multiplication by exponentials does not affect Lp norms, this identity implies
that the norm of the operator SN( f) = DN ‚àóf from Lp to Lp is equal to that of the
operator

246
4 Topics on Fourier Series
S‚Ä≤
N(g)(x) =
2N
‚àë
m=0
1g(m)e2œÄimx
from Lp to Lp. Therefore,
sup
N‚â•0
SN

Lp‚ÜíLp < ‚àû‚áê‚áísup
N‚â•0
S‚Ä≤
N

Lp‚ÜíLp < ‚àû,
(4.1.10)
and both of these statements are equivalent to the fact that for all f ‚ààLp(T1),
SN( f) ‚Üíf in Lp as N ‚Üí‚àû.
We have already observed that the Lp boundedness of the conjugate function is
equivalent to that of P+. Therefore, it sufÔ¨Åces to show that the Lp boundedness of
P+ is equivalent to the uniform Lp boundedness of S‚Ä≤
N.
Suppose Ô¨Årst that supN‚â•0 ‚à•S‚Ä≤
N‚à•Lp‚ÜíLp < ‚àû. Theorem 4.1.1 applied to the sequence
a(m,R) = 1 for 0 ‚â§m ‚â§R and a(m,R) = 0 otherwise gives that the operator A( f) =
P+( f)+ 1f(0) is bounded on Lp(T1). Hence so is P+.
Conversely, suppose that P+ extends to a bounded operator from Lp(T1) to itself.
For all h in C ‚àû(Tn) we can write
S‚Ä≤
N(h)(x) =
‚àû
‚àë
m=0
1h(m)e2œÄimx ‚àí
‚àû
‚àë
m=2N+1
1h(m)e2œÄimx
=
‚àû
‚àë
m=1
1h(m)e2œÄimx +1h(0)‚àíe2œÄi(2N)x
‚àû
‚àë
m=1
1h(m+2N)e2œÄimx
= P+(h)(x)‚àíe2œÄi(2N)xP+(e‚àí2œÄi(2N)(¬∑)h)+1h(0).
This identity implies that
sup
N‚â•0
S‚Ä≤
N( f)

Lp ‚â§

2
P+

Lp‚ÜíLp +1
 f

Lp
(4.1.11)
for all f smooth, and by density for all f ‚ààLp(T1). Note that S‚Ä≤
N is well deÔ¨Åned on
Lp(T1). Thus the operators S‚Ä≤
N are uniformly bounded on Lp(Tn).
Thus the uniform Lp boundedness of SN is equivalent to the uniform Lp bound-
edness of S‚Ä≤
N, which is equivalent to the Lp boundedness of P+, which in turn is
equivalent to the Lp boundedness of the conjugate function.
‚ñ°
4.1.2 The Lp Boundedness of the Conjugate Function
We know now that convergence of Fourier series in Lp is equivalent to the Lp bound-
edness of the conjugate function or either of the two Riesz projections. It is natural
to ask whether these operators are Lp bounded.

4.1 Convergence in Norm, Conjugate Function, and Bochner‚ÄìRiesz Means
247
Theorem 4.1.7. Given 1 < p < ‚àû, there is a constant Ap > 0 such that for all f in
C ‚àû(T1) we have
 #f

Lp ‚â§Ap
f

Lp.
(4.1.12)
Thus the operator f ‚Üí#f has a bounded extension on Lp(T1) that also satisÔ¨Åes
(4.1.12).
Consequently, the Fourier series of Lp functions on the circle converge back to
the functions in the Lp norm for 1 < p < ‚àû.
Proof. In proving the inequality (4.1.12), we make the following reductions:
(a) We assume that f is trigonometric polynomial.
(b) We assume that 1f(0) = 0.
(c) We assume that f is real valued.
Since f is a real-valued function, we have that 1f(‚àím) = 1f(m) for all m, and since
1f(0) = 0, we can write
#f(t) = ‚àíi
‚àû
‚àë
m=1
1f(m)e2œÄimt +i
‚àû
‚àë
m=1
1f(‚àím)e‚àí2œÄimt = 2Re

‚àíi
‚àû
‚àë
m=1
1f(m)e2œÄimt

,
which implies that #f is also real-valued (see also Exercise 4.1.4(b)). Therefore the
polynomial f +i #f contains only positive frequencies. Thus for k ‚ààZ+ we have

T1( f(t)+i #f(t))2k dt = 0.
Expanding the 2k power and taking real parts, we obtain
k
‚àë
j=0
(‚àí1)k‚àíj
2k
2j

T1
#f(t)2k‚àí2 j f(t)2 j dt = 0,
where we used that f is real-valued. Therefore,
 #f
2k
L2k ‚â§
k
‚àë
j=1
2k
2j

T1
#f(t)2k‚àí2 j f(t)2 j dt
‚â§
k
‚àë
j=1
2k
2j
 #f
2k‚àí2 j
L2k
 f
2 j
L2k ,
by applying H¬®older‚Äôs inequality with exponents 2k/(2k‚àí2j) and 2k/(2j) to the jth
term of the sum. Dividing the last inequality by ‚à•f‚à•2k
L2k, we obtain
R2k ‚â§
k
‚àë
j=1
2k
2j

R2k‚àí2 j,
(4.1.13)

248
4 Topics on Fourier Series
where R = ‚à•#f ‚à•L2k/‚à•f‚à•L2k. If R > 0 satisÔ¨Åes (4.1.13), then R ‚â§C2k, where C2k is the
largest real root of the polynomial g(t) = t2k ‚àí‚àëk
j=1
2k
2 j

t2k‚àí2 j. (Since g(0) < 0 and
limt‚Üí‚àûg(t) = ‚àû, g has at least one real root.) We conclude that if f satisÔ¨Åes (a), (b),
and (c), then we have for all k = 1,2,...
 #f

L2k ‚â§C2k
f

L2k .
(4.1.14)
We now remove assumptions (a), (b), and (c). We Ô¨Årst remove assumption (c).
Given a complex-valued trigonometric polynomial f with 1f(0) = 0, we write
f(t) =
N
‚àë
j=‚àíN
cje2œÄi jt =

N
‚àë
j=‚àíN
cj +c‚àíj
2
e2œÄi jt

+i

N
‚àë
j=‚àíN
cj ‚àíc‚àíj
2i
e2œÄi jt

(with c0 = 0) and we note that the expressions inside the square brackets are real-
valued trigonometric polynomials. Thus we can express f as P + iQ, where P and
Q are real-valued trigonometric polynomials, and applying (4.1.14) to P and Q we
obtain the inequality
 #f

L2k ‚â§2C2k
f

L2k
(4.1.15)
for all trigonometric polynomials f with 1f(0) = 0.
Next, we remove the assumption that 1f(0) = 0. We write f = ( f ‚àí1f(0))+ 1f(0),
we observe that the conjugate function of a constant is zero, and we apply (4.1.15)
to obtain
 #f

L2k ‚â§2C2k
f ‚àí1f(0)

L2k ‚â§2C2k
/f

L2k +‚à•f‚à•L1
0
‚â§4C2k
 f

L2k .
Since trigonometric polynomials are dense in Lp, it follows that the operator f ‚Üí#f
has a bounded extension on L2k that satisÔ¨Åes (4.1.12) for all f ‚ààL2k, and in particular
for all f ‚ààC ‚àû(T1).
Every real number p ‚â•2 lies in an interval of the form [2k,2k + 2], for some
k ‚ààZ+. Theorem 1.3.4 gives that for all 2 ‚â§p < ‚àûthere is a constant Ap such that
 #f

Lp ‚â§Ap
 f

Lp
(4.1.16)
when f is a simple function. Thus the conjugate function has a bounded extension
on Lp that satisÔ¨Åes (4.1.16) when p ‚â•2.
To extend this result for p < 2 we use duality. We observe that the adjoint operator
of f ‚Üí#f is f ‚Üí‚àí#f. Indeed, for f,g in C ‚àû(T1) we have
‚ü®#f |g‚ü©= ‚àë
m‚ààZ
‚àíisgn(m) 1f(m)1g(m) = ‚àí‚àë
m‚ààZ
1f(m)‚àíisgn(m)1g(m) = ‚àí‚ü®f | #g‚ü©.
By duality, estimate (4.1.16) is also valid for 1 < p ‚â§2 with constant Ap‚Ä≤ = Ap.
‚ñ°
We extend the preceding result to higher dimensions.

4.1 Convergence in Norm, Conjugate Function, and Bochner‚ÄìRiesz Means
249
Theorem 4.1.8. Let 1 < p < ‚àûand f ‚ààLp(Tn). Then Dn
N ‚àóf converges to f in Lp
as N ‚Üí‚àû.
Proof. As a consequence of Corollary 4.1.3, Proposition 4.1.6, and Theorem 4.1.7,
it sufÔ¨Åces to show that for all f trigonometric polynomials on Tn we have
sup
N>0
 1
0 ¬∑¬∑¬∑
 1
0
(Dn
N ‚àóf)(x)
p dx1 ¬∑¬∑¬∑dxn ‚â§Knpf
p
Lp(Tn) .
Obviously, this inequality is valid in dimension n = 1. We extend it by induction
to all dimensions. We assume that it is valid in dimension n ‚àí1 and we prove it in
dimension n.
Let x‚Ä≤ = (x2,...,xn) ‚ààTn‚àí1. For a Ô¨Åxed trigonometric polynomial f, and for Ô¨Åxed
N ‚â•0 and x‚Ä≤ ‚ààTn‚àí1, deÔ¨Åne a trigonometric polynomial gN,x‚Ä≤ on T1 by setting
gN,x‚Ä≤(x1) = ‚àë
m1‚ààZ

‚àë
|m2|,...,|mn|‚â§N
e2œÄim‚Ä≤¬∑x‚Ä≤ 1f(m1,m‚Ä≤)

e2œÄim1x1
where m‚Ä≤ = (m2,...,mn). Then we have
gN,x‚Ä≤(x1) =
‚àë
|m2|,...,|mn|‚â§N
e2œÄim‚Ä≤¬∑x‚Ä≤
‚àë
m1‚ààZ
e2œÄim1x1 1f(m1,m‚Ä≤)

=
‚àë
|m2|,...,|mn|‚â§N
e2œÄim‚Ä≤¬∑x‚Ä≤
Tn‚àí1 f(x1,y‚Ä≤)e‚àí2œÄim‚Ä≤¬∑y‚Ä≤dy‚Ä≤

=
‚àë
|m2|,...,|mn|‚â§N
e2œÄim‚Ä≤¬∑x‚Ä≤ 2
fx1(m‚Ä≤)
= (Dn‚àí1
N
‚àófx1)(x‚Ä≤),
where fx1 is the trigonometric polynomial of n ‚àí1 variables deÔ¨Åned by fx1(x‚Ä≤) =
f(x1,x‚Ä≤). We also have that
(DN ‚àógN,x‚Ä≤)(x1) = (Dn
N ‚àóf)(x1,x‚Ä≤).
Combining this information, we write

Tn‚àí1
 1
0
(Dn
N ‚àóf)(x1,x‚Ä≤)
p dx1 dx‚Ä≤
=

Tn‚àí1
 1
0
(DN ‚àógN,x‚Ä≤)(x1)
p dx1 dx‚Ä≤
‚â§Kp

Tn‚àí1
 1
0
gN,x‚Ä≤(x1)
p dx1 dx‚Ä≤
= Kp
 1
0

Tn‚àí1
(Dn‚àí1
N
‚àófx1)(x‚Ä≤)
p dx‚Ä≤ dx1

250
4 Topics on Fourier Series
‚â§KpK(n‚àí1)p

Tn‚àí1
 1
0
fx1(x‚Ä≤)
p dx‚Ä≤ dx1
= Knpf
p
Lp(Tn),
where the penultimate inequality follows from the induction hypothesis.
‚ñ°
4.1.3 Bochner‚ÄìRiesz Summability
In dimension 1 the Fej¬¥er means of an integrable function are better behaved than the
Dirichlet means. We investigate whether there is a similar phenomenon in higher
dimensions. Recall that the circular (or spherical) partial sums of the Fourier series
of f are given by
( f ‚àó
‚ó¶Dn
R)(x) = ‚àë
m‚ààZn
|m|‚â§R
1f(m)e2œÄim¬∑x ,
where R ‚â•0. Taking the averages of these expressions, we obtain
1
R
 R
0 ( f ‚àó
‚ó¶Dn
r)(x)dr = ‚àë
m‚ààZn
|m|‚â§R

1‚àí|m|
R
 1f(m)e2œÄim¬∑x = B1
R( f)(x),
and we call these expressions the circular Ces`aro means (or circular Fej¬¥er means)
of f. It turns out that the circular Ces`aro means of integrable functions on T2 always
converge in L1, but in dimension 3, this may fail. Theorem 4.2.5 gives an example of
an integrable function f on T3 whose circular Ces`aro means diverge a.e. However,
we show below that this is not the case if the circular Ces`aro means of a function f
in L1(T3) are replaced by the only slightly different-looking means
‚àë
m‚ààZn
|m|‚â§R

1‚àí|m|
R
1+Œµ 1f(m)e2œÄim¬∑x ,
for some Œµ > 0. This discussion suggests that the preceding expressions behave bet-
ter as Œµ increases, but for a Ô¨Åxed Œµ they get worse as the dimension increases. The
need to understand the behavior of these operators for different values of Œ± ‚â•0 led
to introduction of the operators BŒ±
R given in DeÔ¨Ånition 4.1.2.
The family of operators BŒ±
R forms a natural ‚Äúspherical‚Äù analogue of the Ces`aro‚Äì
Fej¬¥er sums. It turns out that there is no signiÔ¨Åcant difference in the behavior of
these means if the expression

1 ‚àí|m|2
R2
Œ± in (4.1.6) is replaced by the expression

1‚àí|m|
R
Œ±; see Exercise 4.3.1. The advantage of the quadratic expression in (4.1.6)
is that it has an easily computable kernel and yields the elegant reproducing formula
BŒ±
R( f) =
2Œì (Œ± +1)
Œì (Œ± ‚àíŒ≤)Œì (Œ≤ +1)
1
R
 R
0

1‚àír2
R2
Œ±‚àíŒ≤‚àí1 r2
R2
Œ≤+ 1
2
BŒ≤
r ( f)dr, (4.1.17)

4.1 Convergence in Norm, Conjugate Function, and Bochner‚ÄìRiesz Means
251
which precisely quantiÔ¨Åes the way in which BŒ±
R is smoother than BŒ≤
R when Œ± > Œ≤.
Identity (4.1.17) also says that when Œ± > Œ≤, the operator BŒ±
R( f) is an average of the
operators BŒ≤
r ( f), 0 < r < R, with respect to a certain density.
Note that the Bochner‚ÄìRiesz means of order zero coincide with the circular (or
spherical) Dirichlet means, and, as we have seen, these converge in L2(Tn). We
address an analogous question on Lp(Tn) for p Ã∏= 2.
Proposition 4.1.9. Let 1 ‚â§p < ‚àûand f ‚ààLp(Tn). Then the Bochner‚ÄìRiesz means
BŒ±
R( f) converge to f in Lp(Tn) as R ‚Üí‚àûwhen Œ± > (n‚àí1)
 1
p ‚àí1
2
. Moreover, if f
is continuous on Tn and Œ± > n‚àí1
2 , then BŒ±
R( f) converges to f uniformly as R ‚Üí‚àû.
Proof. For z ‚ààC with Rez ‚â•0, consider the function
mz(Œæ) = (1‚àí|Œæ|2)z
+
deÔ¨Åned for Œæ in Rn. Note that ‚à•mz‚à•L‚àû= 1. Using an identity proved in Appendix
B.5, we have that
(mz)‚à®(y) = Kz(y) = Œì (z+1)
œÄz
J n
2 +z(2œÄ|y|)
|y|
n
2 +z
,
(4.1.18)
where y ‚ààRn and JŒΩ is the Bessel function of order ŒΩ. The estimates in Appendices
B.6 and B.7 imply that there is a constant C(ReŒΩ) such that
|JŒΩ(r)| ‚â§C(ReŒΩ)e10|ImŒΩ|2(1+r)‚àí1
2
whenever ReŒΩ > 0. This yields that if Rez > n‚àí1
2 , then there is a constant C‚Ä≤(t) such
that the function Kz obeys the estimate
|Kz(y)| ‚â§C‚Ä≤( n
2 +Rez)e10|Imz|2(1+|y|)‚àín‚àí(Rez‚àín‚àí1
2 ) ,
(4.1.19)
and hence it lies in L1(Rn). Using identity (3.1.10), whenever Rez > n‚àí1
2 , we deÔ¨Åne
for an integrable function f on Tn and x ‚ààTn the operator
Bz
R( f)(x) = ‚àë
‚Ñì‚ààZn
mz( ‚Ñì
R) 1f(‚Ñì)e2œÄi‚Ñì¬∑x = ( f ‚àóLz,R)(x),
where Lz,R is a function whose sequence of Fourier coefÔ¨Åcients is {mz( ‚Ñì
R)}‚Ñì‚ààZn.
But the function Lz,R can be precisely identiÔ¨Åed. By the Poisson summation for-
mula (Theorem 3.2.8), which applies since both Kz(x) and mz(x) are bounded by a
constant multiple of (1+|x|)‚àín‚àíŒ¥ for some Œ¥ > 0, we have
Lz,R(x) = ‚àë
k‚ààZn
mz( k
R)e2œÄix¬∑k = Rn ‚àë
‚Ñì‚ààZn
Kz((x+‚Ñì)R)

252
4 Topics on Fourier Series
for all x ‚ààTn. We show that the family {Lz,R}R>0 is an approximate identity on Tn
when Rez > n‚àí1
2 ; on this see the related Exercise 3.1.3. Obviously, using (4.1.19) we
have that

Tn |Lz,R(x)|dx =

Rn |Kz(y)|dy = C‚Ä≤‚Ä≤(n,Rez)e10|Imz|2 < ‚àû
(4.1.20)
for some constant C‚Ä≤‚Ä≤(n,Rez), and also

Tn Lz,R(x)dx =

Rn Kz(y)dy = mz(0) = 1
for all R > 0 when Rez > n‚àí1
2 . Moreover, for Œ¥ < 1
2 using (4.1.19) we have

Œ¥‚â§supj |x j|‚â§1
2
Lz,R(x)
dx ‚â§
Cn,z
RRez‚àín‚àí1
2

Œ¥‚â§supj |x j|‚â§1
2 ‚àë
‚Ñì‚ààZn
1
|x+‚Ñì|n+Rez‚àín‚àí1
2
dx ‚Üí0,
thus the integral of Lz,R over [‚àí1/2,1/2]n \[‚àíŒ¥,Œ¥]n tends to zero as R ‚Üí‚àû.
Using Theorem 1.2.19, we obtain these conclusions for Rez > n‚àí1
2 :
(a) For f ‚ààL1(Tn), Bz
R( f) converge to f in L1 as R ‚Üí‚àû.
(b) For f continuous on Tn, Bz
R( f) converge to f uniformly as R ‚Üí‚àû.
We turn to the corresponding results for 1 < p < ‚àû. We have that
Rez > n‚àí1
2
=‚áísup
R>0
Bz
R

L1(Tn)‚ÜíL1(Tn) = C‚Ä≤‚Ä≤(n,Rez)e10|Imz|2
(4.1.21)
Rez = 0 =‚áísup
R>0
Bz
R

L2(Tn)‚ÜíL2(Tn) = ‚à•mz‚à•L‚àû= 1.
(4.1.22)
The family of operators f ‚ÜíBz
R( f) is of admissible growth for all Rez ‚â•0, since
for all measurable subsets A, B of Tn we have


Tn Bz
R(œáA)œáB dx
 =
 ‚àë
k‚ààZn
2
œáA(k)mz(k)2
œáB(k)
 ‚â§‚àë
|k|‚â§R
1 ‚â§CnRn ,
thus condition (1.3.23) holds. Moreover, hypothesis (1.3.24) of Theorem 1.3.7 holds
in view of (4.1.21) and (4.1.22). Applying Theorem 1.3.7 (or rather Exercise 1.3.4 in
which the strip [0,1]√óR is replaced by the more general strip [a,b]√óR) we obtain
that when Œ± = Rez > (n‚àí1)| 1
p ‚àí1
2|, we have
sup
R>0
BŒ±
R

Lp(Tn)‚ÜíLp(Tn) < ‚àû.
Finally, using Corollary 4.1.3, we deduce that BŒ±
R( f) ‚Üíf in Lp(Tn) as R ‚Üí‚àûfor
all f ‚ààLp(Tn).
‚ñ°
The preceding result is sharp in the case p = 1 (Theorem 4.2.5). For this rea-
son, the number Œ± = (n‚àí1)/2 is referred to as the critical index of Bochner‚ÄìRiesz
summability.

4.1 Convergence in Norm, Conjugate Function, and Bochner‚ÄìRiesz Means
253
Exercises
4.1.1. If f ‚ààC ‚àû(Tn), then show that Dn
N ‚àóf and
‚ó¶Dn
N ‚àóf converge to f uniformly
and in Lp for 1 ‚â§p ‚â§‚àû.
4.1.2. Prove that
‚à•P+‚à•L2(T1)‚ÜíL2(T1) = ‚à•P‚àí‚à•L2(T1)‚ÜíL2(T1) = ‚à•W‚à•L2(T1)‚ÜíL2(T1) = 1,
where W( f) = #f is the conjugate function on the circle. Moreover, show that the
mappings f ‚ÜíW( f)+ 1f(0) and f ‚ÜíW( f)‚àí1f(0) are isometries on L2(T1).
4.1.3. Let ‚àí‚àû‚â§aj < bj ‚â§+‚àûfor 1 ‚â§j ‚â§n. Consider the rectangular projection
operator deÔ¨Åned on C ‚àû(Tn) by
P( f)(x) =
‚àë
a j‚â§mj‚â§b j
1f(m)e2œÄi(m1x1+¬∑¬∑¬∑+mnxn) .
Prove that when 1 < p < ‚àû, P extends to a bounded operator from Lp(Tn) to itself
with bounds independent of the aj,bj.

Hint: Express P in terms of the Riesz projection P+.

4.1.4. Let Pr(t) be the Poisson kernel on T1 as deÔ¨Åned in Exercise 3.1.7. For 0 <
r < 1, deÔ¨Åne the conjugate Poisson kernel Qr(t) on the circle by
Qr(t) = ‚àíi
+‚àû
‚àë
m=‚àí‚àû
sgn (m)r|m|e2œÄimt .
(a) For 0 < r < 1, prove the identity
Qr(t) =
2rsin(2œÄt)
1‚àí2rcos(2œÄt)+r2 .
(b) Prove that #f(t) = limr‚Üí1(Qr ‚àóf)(t) whenever f is smooth. Conclude that if f is
real-valued, then so is #f.
(c) Let f ‚ààL1(T1). Prove that the function
z ‚Üí(Pr ‚àóf)(t)+i(Qr ‚àóf)(t)
is analytic in z = re2œÄit on the open unit disc {z ‚ààC : |z| < 1}.
(d) Let f ‚ààL1(T1). Conclude that the functions z ‚Üí(Pr ‚àóf)(t) and z ‚Üí(Qr ‚àóf)(t)
are conjugate harmonic functions of z = re2œÄit in the region |z| < 1. The term con-
jugate Poisson kernel stems from this property.

254
4 Topics on Fourier Series
4.1.5. Let f be in .
ŒõŒ±(T1) for some 0 < Œ± < 1. Prove that the conjugate function #f
is well deÔ¨Åned and can be written as
#f(x) = lim
Œµ‚Üí0

Œµ‚â§|t|‚â§1/2 f(x‚àít)cot(œÄt)dt
=

|t|‚â§1/2

f(x‚àít)‚àíf(x)

cot(œÄt)dt.

Hint: Use part (b) of Exercise 4.1.4 and the fact that Qr has integral zero over the
circle to write ( f ‚àóQr)(x) =

( f ‚àíf(x)) ‚àóQr

(x), allowing use of the Lebesgue
dominated convergence theorem.

4.1.6. Suppose that f is a real-valued function on T1 with | f| ‚â§1 and 0 ‚â§Œª < œÄ/2.
(a) Prove that

T1 eŒª #f(t) dt ‚â§
1
cos(Œª) .
(b) Conclude that for 0 ‚â§Œª < œÄ/2 we have

T1 eŒª| #f(t)| dt ‚â§
2
cos(Œª) .

Hint: Part (a): Consider the analytic function F(z) on the disk |z| < 1 deÔ¨Åned by
F(z) = ‚àíi(Pr ‚àóf)(Œ∏) + (Qr ‚àóf)(Œ∏), where z = re2œÄiŒ∏. Then Re eŒªF(z) is harmonic
and its average over the circle |z| = r is equal to its value at the origin, which is
cos(Œª f(0)) ‚â§1. Let r ‚Üë1 and use that for z = e2œÄit on the circle we have Re eŒªF(z) ‚â•
eŒª #f(t) cos(Œª).

4.1.7. Prove that for 0 < Œ± < 1 there is a constant CŒ± such that
 #f
.
ŒõŒ±(T1) ‚â§CŒ±
 f
.
ŒõŒ±(T1) .

Hint: Using Exercise 4.1.5, for |h| ‚â§1/10 write #f(x+h)‚àí#f(x) as

|t|‚â§5|h|

f(x‚àít)‚àíf(x+h)

cot(œÄ(t +h))dt
‚àí

|t|‚â§5|h|

f(x‚àít)‚àíf(x)

cot(œÄt)dt
+

5|h|‚â§|t|‚â§1/2

f(x‚àít)‚àíf(x)

cot(œÄ(t +h))‚àícot(œÄt)

dt
+

f(x)‚àíf(x+h)

5|h|‚â§|t|‚â§1/2 cot(œÄ(t +h))dt .
You may use the fact that cot(œÄt) = 1
œÄt + b(t), where b(t) is a bounded function
when |t| ‚â§1/2. The case |h| ‚â•1/10 is easy.


4.2 Divergence Theorems
255
4.1.8. The beta function is deÔ¨Åned in Appendix A.2. Derive the identity
tŒ± =
1
B(Œ±‚àíŒ≤,Œ≤ +1)
 t
0 (t ‚àís)Œ±‚àíŒ≤‚àí1sŒ≤ ds
and show that the function KŒ±
R (x) = ‚àë|m|‚â§R

1‚àí|m|2
R2
Œ±e2œÄim¬∑x satisÔ¨Åes (4.1.17).

Hint: Take t = 1‚àí|m|2
R2 and change variables s = r2‚àí|m|2
R2
in the displayed identity.

4.2 A. E. Divergence of Fourier Series and Bochner‚ÄìRiesz means
We saw in Proposition 3.4.6 that the Fourier series of a continuous function may
diverge at a point. As expected, the situation can only get worse as the functions
get worse. In this section we present an example, due to A. N. Kolmogorov, of an
integrable function on T1 whose Fourier series diverges almost everywhere. We also
prove an analogous result for the Bochner‚ÄìRiesz means at the critical index.
4.2.1 Divergence of Fourier Series of Integrable Functions
It is natural to start our investigation with the case n = 1. We begin with the follow-
ing important result:
Theorem 4.2.1. There exists an integrable function on the circle T1 whose Fourier
series diverges almost everywhere.
Proof. The proof of this theorem is a bit involved, and we need a sequence of lem-
mas, which we prove Ô¨Årst.
Lemma 4.2.2. (Kronecker) Suppose that N ‚ààZ+ and
{x1,x2,...,xN,1}
is a linearly independent set over the rationals. Then for any Œµ > 0 and any complex
numbers z1,z2,...,zN with |z j| = 1, there exists an integer L ‚ààZ such that
|e2œÄiLx j ‚àíz j| < Œµ
for all
1 ‚â§j ‚â§N.
Proof. Suppose that the assertion claimed is false. Then there is an Œµ > 0 and com-
plex numbers z j = e2œÄiŒ∏ j, j = 1,...,N, with 0 ‚â§Œ∏ j < 1, such that
{m(x1,...,xN) : m ‚ààZ}‚à©B

(Œ∏1,...,Œ∏N),Œµ

= /0,

256
4 Topics on Fourier Series
where B

(Œ∏1,...,Œ∏N),Œµ

denotes a neighborhood in TN of radius Œµ centered at the
point (Œ∏1,...,Œ∏N). Pick a smooth, nonzero, and nonnegative function f on TN sup-
ported in B

(Œ∏1,...,Œ∏N),Œµ

. Then f(m(x1,...,xN)) = 0 for all m ‚ààZ, but
1f(0) =

TN f(y)dy > 0.
(4.2.1)
Set x = (x1,...,xN). Then we have
0 = 1
M
M‚àí1
‚àë
m=0
f(mx) = 1
M
M‚àí1
‚àë
m=0

‚àë
‚Ñì‚ààZN
1f(‚Ñì)e2œÄi‚Ñì¬∑mx

= ‚àë
‚Ñì‚ààZN
1f(‚Ñì)
 1
M
M‚àí1
‚àë
m=0
e2œÄim(‚Ñì¬∑x)

= 1f(0)+
‚àë
‚Ñì‚ààZN\{0}
1f(‚Ñì)
 1
M
e2œÄiM(‚Ñì¬∑x) ‚àí1
e2œÄi(‚Ñì¬∑x) ‚àí1

.
Note that e2œÄi(‚Ñì¬∑x) ‚àí1 Ã∏= 0 because ‚Ñì¬∑x = ‚Ñì1x1 +¬∑¬∑¬∑+‚ÑìNxN /‚ààZ, since by assumption
the set {x1,x2,...,xN,1} is linearly independent over the rationals. Observe that
1f(‚Ñì) 1
M
e2œÄiM(‚Ñì¬∑x) ‚àí1
e2œÄi(‚Ñì¬∑x) ‚àí1 = 1f(‚Ñì) 1
M
M‚àí1
‚àë
m=0
e2œÄim(‚Ñì¬∑x)
tends to 0 as M ‚Üí‚àûfor every Ô¨Åxed ‚Ñì‚ààZN and is bounded uniformly in M by
| 1f(‚Ñì)| which satisÔ¨Åes ‚àë‚Ñì‚ààZN | 1f(‚Ñì)| < ‚àû. Using the Lebesgue dominated convergence
theorem, we obtain that
0 = 1f(0)+ lim
M‚Üí‚àû
‚àë
‚Ñì‚ààZN\{0}
1f(‚Ñì)
 1
M
e2œÄiM(‚Ñì¬∑x) ‚àí1
e2œÄi(‚Ñì¬∑x) ‚àí1

= 1f(0)+
‚àë
‚Ñì‚ààZN\{0}
1f(‚Ñì) lim
M‚Üí‚àû
 1
M
e2œÄiM(‚Ñì¬∑x) ‚àí1
e2œÄi(‚Ñì¬∑x) ‚àí1

= 1f(0)+0,
which contradicts (4.2.1). Therefore the claimed L exists.
‚ñ°
Lemma 4.2.3. There exists a positive constant c > 0 such that given any integer
N ‚â•2 there exists a positive measure ŒºN on T1 with ŒºN(T1) = 1 such that
sup
L‚â•1
(ŒºN ‚àóDL

(x)| = sup
L‚â•1

L
‚àë
k=‚àíL
2
ŒºN(k)e2œÄikx
 ‚â•clogN
(4.2.2)
for almost all x ‚ààT1 (c is a Ô¨Åxed constant).

4.2 Divergence Theorems
257
Proof. Given irrational real numbers x1,...,xN such that the set {x1,...,xN,1} is
linearly independent over the rationals, we deÔ¨Åne Q[x1,...,xN] to be the Ô¨Åeld exten-
sion of Q consisting of all linear combinations of the form q0 + q1x1 + ¬∑¬∑¬∑ + qNxN,
where qj are rational numbers. Obviously Q[x1,...,xN] is a countable set. Fix
N ‚â•100 and choose points xj as follows:
0 < x1 < 1
N < x2 < 2
N < x3 < 3
N < ¬∑¬∑¬∑ < N ‚àí1
N
< xN < 1
(4.2.3)
and such that x1 /‚ààQ, x2 /‚ààQ[x1], ..., xN /‚ààQ[x1,...,xN‚àí1]. Then obviously the set
{x1,...,xN,1} is linearly independent over the rationals. Let
EN =
	
x ‚àà[0,1] : {x‚àíx1,...,x‚àíxN,1}
is linearly independent over Q

and observe that every x in [0,1] \ Q[x1,...,xN] belongs to EN. Indeed, if x /‚ààEN,
then there are rational numbers qj such that
q0 +q1(x‚àíx1)+¬∑¬∑¬∑+qN(x‚àíxN) = 0.
Then q = q1 +¬∑¬∑¬∑+qN Ã∏= 0, since {x1,...,xN,1} are linearly independent over Q. It
follows that
x = ‚àíq‚àí1q0 +q‚àí1q1x1 +¬∑¬∑¬∑+q‚àí1qNxN,
thus x ‚ààQ[x1,...,xN]. We conclude that EN has full measure.
Next, we deÔ¨Åne the probability measure
ŒºN = 1
N
N
‚àë
j=1
Œ¥x j ,
where Œ¥x j are Dirac delta masses at the points xj. For this measure we have

L
‚àë
k=‚àíL
2
ŒºN(k)e2œÄikx
 =

L
‚àë
k=‚àíL
 1
N
N
‚àë
j=1
e‚àí2œÄikx j

e2œÄikx

=

1
N
N
‚àë
j=1
DL(x‚àíxj)

=

1
N
N
‚àë
j=1
sin(2œÄ(L+ 1
2)(x‚àíxj))
sin(œÄ(x‚àíxj))

=

1
N
N
‚àë
j=1
Im

e2œÄi(L+ 1
2 )(x‚àíx j)
sgn

sin(œÄ(x‚àíxj))

|sin(œÄ(x‚àíxj))|
,
(4.2.4)
where the signum function is deÔ¨Åned as sgna = 1 for a > 0, ‚àí1 for a < 0, and zero
if a = 0. By Lemma 4.2.2, for all x ‚ààEN there exists an L ‚ààZ+ such that
e2œÄiL(x‚àíx j) ‚àíie‚àí2œÄi 1
2 (x‚àíx j)sgn

sin(œÄ(x‚àíxj))
 < 1
2 ,

258
4 Topics on Fourier Series
which can be equivalently written as
e2œÄi(L+ 1
2 )(x‚àíx j)sgn

sin(œÄ(x‚àíxj))

‚àíi
 < 1
2 .
(4.2.5)
It follows from (4.2.5) that
Im

e2œÄi(L+ 1
2 )(x‚àíx j)
sgn

sin(œÄ(x‚àíxj))

> 1
2 .
Combining this with the result of the calculation in (4.2.4), we obtain that

L
‚àë
k=‚àíL
2
ŒºN(k)e2œÄikx
 > 1
2N
N
‚àë
j=1
1
|sin(œÄ(x‚àíxj))| ‚â•
1
2œÄN
N
‚àë
j=1
1
|x‚àíxj| .
But for every x ‚àà[0,1), there exists a j0 such that x ‚àà[xj0,xj0+1). It follows from
(4.2.3) that |x‚àíxj| ‚â§C(| j ‚àíj0|+1)N‚àí1, and thus
N
‚àë
j=1
1
|x‚àíxj| ‚â•c‚Ä≤N logN .
Thus for every x ‚ààEN there exists an L ‚ààZ+ such that
DL ‚àóŒºN(x)
 =

L
‚àë
k=‚àíL
2
ŒºN(k)e2œÄikx
 > clogN ,
which proves the required conclusion since EN is a set of measure 1.
‚ñ°
Lemma 4.2.4. For each 0 < M < ‚àûthere exists a trigonometric polynomial gM and
a measurable subset AM of T1 with measure |AM| > 1‚àí2‚àíM such that ‚à•gM‚à•L1 = 1,
and such that
inf
x‚ààAM sup
L‚â•1
(DL ‚àógM)(x)
 = inf
x‚ààAM sup
L‚â•1

L
‚àë
k=‚àíL
2
gM(k)e2œÄikx
 > 2M .
(4.2.6)
Proof. Given an M ‚ààZ+, we pick an integer N(M) such that clogN(M) > 2M+2,
where c is as in (4.2.2), and we also pick the measure ŒºN(M), which satisÔ¨Åes (4.2.2).
By Fatou‚Äôs lemma we have
1 =
	
x ‚ààT1 : sup
L‚â•1
|(DL ‚àóŒºN(M))(x)| ‚â•2M+2

=
 
L‚â•1
	
x ‚ààT1 :
sup
1‚â§j‚â§L
|(Dj ‚àóŒºN(M))(x)| ‚â•2M+2

=

T1 lim
L‚Üí‚àûœá{x‚ààT1: sup1‚â§j‚â§L |(Dj‚àóŒºN(M))(x)|‚â•2M+2}dx
‚â§liminf
L‚Üí‚àû
	
x ‚ààT1 :
sup
1‚â§j‚â§L
|(Dj ‚àóŒºN(M))(x)| ‚â•2M+2
,

4.2 Divergence Theorems
259
and thus we can Ô¨Ånd a positive integer L(M) such that the set
AM =
	
x ‚ààT1 :
sup
1‚â§L‚â§L(M)
|(DL ‚àóŒºN(M))(x)| ‚â•2M+2
has measure greater than 1‚àí2‚àíM. We pick a positive integer K(M) such that
sup
1‚â§j‚â§L(M)
FK(M) ‚àóDj ‚àíDj

L‚àû‚â§1,
where FK is the Fej¬¥er kernel. This is possible, since the Fej¬¥er kernel is an approx-
imate identity and {Dj : 1 ‚â§j ‚â§L(M)} is a Ô¨Ånite family of continuous functions.
Then we deÔ¨Åne gM = ŒºN(M)‚àóFK(M). Since ŒºN(M) is a probability measure, we obtain
|(Dj ‚àógM)(x)‚àí(Dj ‚àóŒºN(M))(x)| ‚â§
Dj ‚àóFK(M) ‚àíDj

L‚àû‚â§1
for all x ‚àà[0,1] and 1 ‚â§j ‚â§L(M). But given x ‚ààAM there exists an L in {1,...,L(M)}
such that |(DL ‚àóŒºN(M))(x)| ‚â•2M+2 and for this L we have
|(DL ‚àógM)(x)| ‚â•|(DL ‚àóŒºN(M))(x)|‚àí1 ‚â•2M+2 ‚àí1 ‚â•2M+1 > 2M .
Therefore, (4.2.6) is satisÔ¨Åed for this gM and AM. Since ŒºN is a nonnegative measure
and FK(M) is nonnegative and has L1 norm 1, we have that
gM

L1 =
ŒºN(M) ‚àóFK(M)

L1 =
ŒºN(M)

M
FK(M)

L1 = 1,
showing that gM has L1 norm equal to one.
‚ñ°
We now have the tools needed to construct an example of a function whose
Fourier series diverges almost everywhere. The example is given as a series of func-
tions whose behavior worsens as its index becomes bigger. The function we wish to
construct is a sum of the form
g =
‚àû
‚àë
j=1
Œµ jgMj ,
(4.2.7)
for a choice of sequences Œµ j ‚Üí0 and Mj ‚Üí‚àû, where gM are as in Lemma 4.2.4.
Let us be speciÔ¨Åc. First, we set d0 = 1 and for N ‚â•1
dN = max
1‚â§s‚â§N degree(gMs),
(4.2.8)
where gM is the trigonometric polynomial of Lemma 4.2.4. We set Œµ0 = M0 = 1.
Assume that we have deÔ¨Åned Œµ j and Mj for all 1 ‚â§j < N for some N ‚â•2. We set
ŒµN = 2‚àíN(3dN‚àí1)‚àí1
(4.2.9)

260
4 Topics on Fourier Series
and then we pick MN such that
2MN ‚â•

2N +dN‚àí1 +1

Œµ‚àí1
N .
(4.2.10)
This deÔ¨Ånes ŒµN and MN for a given positive integer N, provided Œµj and Mj are known
for all j < N. This way we deÔ¨Åne ŒµN and MN for all natural numbers N.
We observe that the selections of Œµ j and Mj force the inequalities Œµ j ‚â§2‚àíj and
dj ‚â§dj+1 for all j ‚â•1. Since each gMj has L1 norm 1 and Œµ j ‚â§2‚àíj, the function g
in (4.2.7) is integrable and has L1 norm at most 1.
For a given j ‚â•1 and x ‚ààAMj, by Lemma 4.2.4 there exists an L ‚â•1 such that
|(DL ‚àógMj)(x)| > 2Mj. Set
k = k(x) = min(L,dj).
Then we have
|(Dk ‚àóg)(x)| ‚â•Œµ j|(Dk ‚àógMj)(x)|‚àí‚àë
1‚â§s< j
Œµs|(Dk ‚àógMs)(x)|‚àí‚àë
s> j
Œµs|(Dk ‚àógMs)(x)|.
We make the following observations:
(i) |(Dk ‚àógMj)(x)| = |(DL ‚àógMj)(x)| > 2Mj.
(ii) |(Dk ‚àógMs)(x)| = |(Dmin(ds,k) ‚àógMs)(x)| ‚â§
Dmin(ds,L)

L‚àû‚â§3ds, when s < j.
(iii) |(Dk ‚àógMs)(x)| = |(Dmin(ds,k) ‚àógMs)(x)| ‚â§
Dmin(d j,L)

L‚àû‚â§3dj, when s > j.
In these estimates we have used that k = min(L,dj),
Dm

L‚àû‚â§2m + 1 ‚â§3m, and
that
Dr ‚àógMs = Dmin(r,ds) ‚àógMs ,
which follows easily by examining the corresponding Fourier coefÔ¨Åcients.
Using the estimates in (i), (ii), and (iii), for a Ô¨Åxed x ‚ààAMj and k = k(x) we obtain
|(Dk ‚àóg)(x)| ‚â•Œµ j 2Mj ‚àí3 ‚àë
1‚â§s< j
Œµs ds ‚àí3‚àë
s> j
Œµs dj .
(4.2.11)
Our selection of Œµ j and Mj now ensures that (4.2.11) is a large number. In fact, we
have
3‚àë
s> j
Œµs dj = ‚àë
s> j
2‚àísdj(ds‚àí1)‚àí1 ‚â§‚àë
s> j
2‚àís ‚â§1
and
3 ‚àë
1‚â§s< j
Œµs ds ‚â§3dj‚àí1 ‚àë
1‚â§s< j
Œµs ‚â§dj‚àí1 ‚àë
1‚â§s< j
2‚àís(ds‚àí1)‚àí1 ‚â§dj‚àí1 .

4.2 Divergence Theorems
261
Therefore, the expression in (4.2.11) is at least Œµ j2Mj ‚àídj‚àí1 ‚àí1 ‚â•2j. It follows that
for every j ‚â•1 and every x ‚ààAMj there exists a k = k(x) ‚ààZ+ such that
|(Dk ‚àóg)(x)| ‚â•2j .
We conclude that for every r ‚â•1 and x ‚àà
‚àû
j=r
AMj,
sup
k‚â•1
|(Dk ‚àóg)(x)| ‚â•2j ‚â•2r ,
(4.2.12)
since x belongs to some AMj with j ‚â•r. For given r ‚â•1, Lemma 4.2.4 yields that
1 ‚â•

‚àû

j=r
AMj
 ‚â•liminf
j‚Üí‚àû|AMj| ‚â•lim
j‚Üí‚àû(1‚àí2‚àíMj) = 1.
Then the set
A =
‚àû

r=0
‚àû

j=r
AMj
has measure 1, since it is a countable intersection of subsets of T1 of full measure.
In view of (4.2.12) we have that for all x in A
sup
k‚â•1
|(Dk ‚àóg)(x)| ‚â•sup
r‚â•1
2r = ‚àû
(4.2.13)
and thus the required conclusion follows.
‚ñ°
4.2.2 Divergence of Bochner‚ÄìRiesz Means of Integrable Functions
We now turn to the corresponding n-dimensional problem for spherical summability
of Fourier series. The situation here is quite similar at the critical index Œ± = n‚àí1
2 .
Theorem 4.2.5. Let n > 1. There exists an integrable function f on Tn such that
limsup
R‚Üí‚àû
B
n‚àí1
2
R
( f)(x)
 = limsup
R‚Üí‚àû
 ‚àë
m‚ààZn
|m|‚â§R

1‚àí|m|2
R2
 n‚àí1
2 1f(m)e2œÄim¬∑x
 = ‚àû
for almost all x ‚ààTn. Furthermore, such a function can be constructed such that it
is supported in an arbitrarily small given neighborhood of the origin.
We will need a couple of lemmas.
Lemma 4.2.6. Let n ‚â•2. The complement of the set
S =
	
x ‚ààRn : {1}‚à™{|x‚àím| : m ‚ààZn} is linearly independent over Q

has n-dimensional Lebesgue measure zero.

262
4 Topics on Fourier Series
Proof. Recall that a function g deÔ¨Åned on an open subset Œ© of Rn is called real
analytic if for every point x0 in Œ© there is a ball B(x0,Œµ) is contained in Œ© and there
exist coefÔ¨Åcients cŒ≤(x0) such that g(x) = ‚àëŒ≤ cŒ≤(x0)(x ‚àíx0)Œ≤ for all |x ‚àíx0| < Œµ,
where the sum is taken over all multiindices. We will need two facts about real
analytic functions. First, the function x ‚Üí|x| is real analytic on Rn \ {0}. Indeed,
given x0 Ã∏= 0, for |x‚àíx0| < |x0|/3 we have that
|x‚àíx0|2
|x0|2
+2(x‚àíx0)¬∑ x0
|x0|2 < 1.
This allows us to write
|x| = |x0|

1+ |x‚àíx0|2
|x0|2
+2(x‚àíx0)¬∑ x0
|x0|2
 1
2
= |x0|
‚àû
‚àë
k=0
1/2
k
|x‚àíx0|2
|x0|2
+2(x‚àíx0)¬∑ x0
|x0|2
k
,
which is a power series of the form ‚àëŒ≤ cŒ≤(x0)(x‚àíx0)Œ≤.
Secondly, we need the fact that a real analytic function deÔ¨Åned on an open con-
nected subset of Rn cannot vanish on a set of positive measure, unless it is identically
equal to zero; a proof of this in dimension one and an outline of the proof in higher
dimensions is contained in [205].
We return to the proof of the lemma which requires us to show that S has full
measure in Rn. Indeed, if x ‚ààRn \ S, then there exist k ‚ààZ+, m1,...mk ‚ààZn, and
q0,q1,...,qk nonzero rational numbers such that
q0 +
k
‚àë
j=1
qj|x‚àímj| = 0.
(4.2.14)
Since the function
y ‚Üíq0 +
k
‚àë
j=1
qj|y‚àímj|
is nonzero and real analytic on Rn \ Zn, it must vanish only on a set of Lebesgue
measure zero. Therefore, there exists a set Am1,...,mk,q0,q1,...,qk of Lebesgue measure
zero such that (4.2.14) holds exactly when x is in this set. Then
Rn \S ‚äÜ
‚àû

k=1

m1,...,mk‚ààZn

q0,q1,...,qk‚ààQ
Am1,...,mk,q0,q1,...,qk ,
from which it follows that Rn \S has Lebesgue measure zero.
‚ñ°

4.2 Divergence Theorems
263
Let us denote the Bochner‚ÄìRiesz kernel by
KŒ±
R (x) = ‚àë
|m|‚â§R

1‚àí|m|2
R2
Œ±e2œÄim¬∑x
when x ‚ààTn. We need the following lemma regarding KŒ±
R :
Lemma 4.2.7. Let n ‚â•2. For almost every x ‚ààTn we have
limsup
R‚Üí‚àû
|K
n‚àí1
2
R
(x)| = ‚àû.
It is noteworthy to compare the result of this lemma with the analogous one-
dimensional statement
limsup
R‚Üí‚àû
|DR(x)| = ‚àû
for the Dirichlet kernel, which holds exactly when x = 0. Thus the uniform ill be-
havior of the kernel K
n‚àí1
2
R
reÔ¨Çects in some sense its lack of localization.
Proof. Fix n ‚â•2 and Ô¨Åx x0 ‚àà

[‚àí1/2,1/2)n \ {0}

‚à©S, where S is as in Lemma
4.2.6. Using (4.1.18) and the Poisson summation formula (Theorem 3.2.8), for each
Œ± > n‚àí1
2
we obtain the identity
KŒ±
R (x0) = Œì (Œ± +1)
œÄŒ±
Rn ‚àë
m‚ààZn
J n
2 +Œ±(2œÄR|x0 ‚àím|)
(R|x0 ‚àím|)
n
2 +Œ±
(4.2.15)
and the sum converges absolutely because of the asymptotics for the Bessel func-
tions in Appendix B.8. The term with m = 0 in the sum in (4.2.15) is a Ô¨Ånite constant
since by Appendix B.6 the function
y ‚Üí
J n
2 +Œ±(2œÄR|y|)
|y|
n
2 +Œ±
is smooth and therefore bounded. But for m Ã∏= 0 in (4.2.15) we have |m‚àíx0| ‚â•1/2.
The asymptotics in Appendix B.8 imply that for R ‚â•2 we have
J n
2 +Œ±(2œÄR|x0 ‚àím|) = e2œÄiR|x0‚àím|e‚àíi œÄ
2 ( n
2 +Œ±)‚àíi œÄ
4 +e‚àí2œÄiR|x0‚àím|ei œÄ
2 ( n
2 +Œ±)+i œÄ
4
œÄ
"
R|x0 ‚àím|
+O

(R|x0 ‚àím|)‚àí3
2 
for all Œ± > n‚àí1
2 . We insert this expression in (4.2.15), we multiply by e2œÄiŒªR for some
Œª real, and then we average in R from 1 to T, for some T > 10. We obtain

264
4 Topics on Fourier Series
1
T
 T
1 KŒ±
R (x0)e2œÄiŒªR dR
= Œì (Œ±+1)
œÄŒ±
‚àë
m‚ààZn\{0}
e‚àíi œÄ
2 ( n
2 +Œ±)‚àíi œÄ
4
|x0 ‚àím|
n+1
2 +Œ±
1
T
 T
1 e2œÄiR(Œª+|x0‚àím|)R
n‚àí1
2 ‚àíŒ± dR
+ Œì (Œ±+1)
œÄŒ±
‚àë
m‚ààZn\{0}
ei œÄ
2 ( n
2 +Œ±)+i œÄ
4
|x0 ‚àím|
n+1
2 +Œ±
1
T
 T
1 e2œÄiR(Œª‚àí|x0‚àím|)R
n‚àí1
2 ‚àíŒ± dR
+ Œì (Œ±+1)
œÄŒ±
‚àë
m‚ààZn\{0}
O

1
|x0 ‚àím|
n+3
2 +Œ±
 1
T
 T
1 R
n‚àí3
2 ‚àíŒ± dR
+ Œì (Œ±+1)
œÄŒ±
1
T
 T
1
J n
2 +Œ±(2œÄR|x0|)
(R|x0|)
n
2 +Œ±
e2œÄiŒªR Rn dR.
(4.2.16)
Assume that we are able to pass the limit as Œ± ‚Üín‚àí1
2 + through the sums and
integrals in the preceding identity; we justify this step momentarily. Then we obtain
1
T
 T
1 K
n‚àí1
2
R
(x0)e2œÄiŒªR dR
= Œì ( n+1
2 )
œÄ
n‚àí1
2
‚àë
m‚ààZn\{0}
e‚àíi œÄ
2 ( 2n‚àí1
2
)‚àíi œÄ
4
|x0 ‚àím|n
1
T
 T
1 e2œÄiR(Œª+|x0‚àím|) dR
+ Œì ( n+1
2 )
œÄ
n‚àí1
2
‚àë
m‚ààZn\{0}
ei œÄ
2 ( 2n‚àí1
2
)+i œÄ
4
|x0 ‚àím|n
1
T
 T
1 e2œÄiR(Œª‚àí|x0‚àím|) dR
+ Œì ( n+1
2 )
œÄ
n‚àí1
2
‚àë
m‚ààZn\{0}
O

1
|x0 ‚àím|n+1
 1
T
 T
1
dR
R
+ Œì ( n+1
2 )
œÄ
n‚àí1
2
1
T
 T
1
Jn‚àí1
2 (2œÄR|x0|)
(R|x0|)n‚àí1
2
e2œÄiŒªR Rn dR.
(4.2.17)
We now justify the passage of the limit in Œ± inside the sums and the integrals in
(4.2.16) to obtain (4.2.17). First, when |m| ‚â§R ‚â§T and Œ± > n‚àí1
2 , the mean value
theorem gives


1‚àí|m|2
R2
 n‚àí1
2
e2œÄix0¬∑m ‚àí

1‚àí|m|2
R2
Œ±
e2œÄix0¬∑m

‚â§

Œ± ‚àín‚àí1
2

1‚àí|m|2
R2
 n‚àí1
2
log
1
1‚àí|m|2
R2
‚â§

Œ± ‚àín‚àí1
2

sup
0<t‚â§1
t
n‚àí1
2 log 1
t ,

4.2 Divergence Theorems
265
thus KŒ±
R (x0) converges to K
n‚àí1
2
R
(x0) uniformly in R ‚àà[1,T] as Œ± ‚Üín‚àí1
2 and therefore
the integral over [1,T] of the former converges to the integral over [1,T] of the latter.
Next, an integration by parts shows that the integral
 T
1 e2œÄiR(Œª+|x0‚àím|)R
n‚àí1
2 ‚àíŒ± dR
is bounded by a constant multiple of (Œª +|x0 ‚àím|)‚àí1, which makes the Ô¨Årst inÔ¨Ånite
sum in (4.2.16) converge absolutely and uniformly in Œ± ‚â•n‚àí1
2 , thus one may pass
the limit in Œ± inside the sum. Also, the integral
 T
1 e2œÄiR(Œª‚àí|x0‚àím|)R
n‚àí1
2 ‚àíŒ± dR
is bounded by a constant multiple of (Œª ‚àí|x0 ‚àím|)‚àí1 whenever Œª is not in the set
Œõx0 = {|x0 ‚àím| : m ‚ààZn} = {Œª1,Œª2,Œª3,...},
where 0 < Œª1 < Œª2 < Œª3 < ¬∑¬∑¬∑. Thus for Œª /‚ààŒõx0, the preceding argument explains
the passage of the limit in Œ± inside the second inÔ¨Ånite sum in (4.2.16). If Œª happens
to be in Œõx0, then there is at most one m0 Ã∏= 0, such that Œª = |x0 ‚àím0| and the
second sum in (4.2.16) restricted to m ‚ààZn \ {0,m0} converges absolutely, while
for the single term with m = m0, letting Œ± ‚Üín‚àí1
2 + is trivial. Finally, for the term
involving the Bessel function Jn‚àí1
2 , the passage of the limit in Œ± inside the integral
is straightforward since the function
(Œ±,R) ‚Üí
J n
2 +Œ±(2œÄR|x0|)
(R|x0|)
n
2 +Œ±
is continuous on the compact set [ n‚àí1
2 , n
2] √ó [1,T]. This completes the proof of
(4.2.17).
There are four terms to the right of (4.2.17) and we observe that if Œª Ã∏= ¬±|x0 ‚àím0|
for any m0 ‚ààZn, then all these terms converge to zero as T ‚Üí‚àû. This assertion
is trivial for the Ô¨Årst three of these four terms, while for the last we assume that
T > |x0|‚àí1. We split the integral
1
T
 T
1
Jn‚àí1
2 (2œÄR|x0|)
(R|x0|)n‚àí1
2
e2œÄiŒªR Rn dR
(4.2.18)
as a sum of the integral over [1,|x0|‚àí1], which obviously converges to zero as T ‚Üí‚àû
by Appendix B.6, and of the integral over [|x0|‚àí1,T]. For the latter, we use the
asymptotics in Appendix B.8 to write
Jn‚àí1
2 (2œÄR|x0|) = e2œÄiR|x0|e‚àíi œÄ
2 ( 2n‚àí1
2
)‚àíi œÄ
4 +e‚àí2œÄiR|x0|ei œÄ
2 ( 2n‚àí1
2
)+i œÄ
4
œÄ
"
R|x0|
+O

(R|x0|)‚àí3
2 
.

266
4 Topics on Fourier Series
The part of the integral in (4.2.18) over [|x0|‚àí1,T] corresponding to O

(R|x0|)‚àí3
2 
grows like log(T|x0|) which divided by T obviously tends to zero. The part of the
integral in (4.2.18) over [|x0|‚àí1,T] corresponding to the main term is
1
T
1
œÄ
"
|x0|
 T
|x0|‚àí1 e2œÄiR(Œª+|x0|)e‚àíi œÄ
2 ( 2n‚àí1
2
)‚àíi œÄ
4 +e2œÄiR(Œª‚àí|x0|)ei œÄ
2 ( 2n‚àí1
2
)+i œÄ
4 dR
which tends to zero as T ‚Üí‚àûby an integration by parts, since Œª Ã∏= |x0| because we
are considering the case where Œª Ã∏= ¬±|x0 ‚àím| for any m ‚ààZn.
Now consider the case where Œª = ¬±|x0 ‚àím0| for some m0 ‚ààZn. In this case the
expression to the right in (4.2.17) converges to
Œì ( n+1
2 )
œÄ
n‚àí1
2
e¬±i( œÄ
2 ( 2n‚àí1
2
)+ œÄ
4 )
|x0 ‚àím0|n
= Œì ( n+1
2 )
œÄ
n‚àí1
2
e¬±i œÄn
2
|x0 ‚àím0|n
as T ‚Üí‚àû. Next observe that
‚àû
‚àë
j=1
1
Œª n
j
= ‚àû.
(4.2.19)
We have now shown that
lim
T‚Üí‚àû
1
T
 T
1 K
n‚àí1
2
t
(x0)e2œÄiŒªt dt =
‚éß
‚é™
‚é™
‚é™
‚é™
‚é®
‚é™
‚é™
‚é™
‚é™
‚é©
Œì ( n+1
2
)
œÄ
n‚àí1
2
ei œÄn
2
Œª n
j
if Œª = Œª j,
0
if Œª Ã∏= ¬±Œª j,
Œì ( n+1
2
)
œÄ
n‚àí1
2
e‚àíi œÄn
2
Œª n
j
if Œª = ‚àíŒª j.
(4.2.20)
Since x0 lies in S, the set {1} ‚à™{Œª1,Œª2,Œª3,...} is linearly independent over the
rationals and thus no expression of the form ¬±Œª j1 ¬±¬∑¬∑¬∑¬±Œª js is equal to an integer.
It follows from this fact and (4.2.20) that
lim
T‚Üí‚àû
1
T
 T
1 K
n‚àí1
2
t
(x0)
N
‚àè
j=1

1+ e‚àíi œÄn
2 e2œÄiŒª jt +ei œÄn
2 e‚àí2œÄiŒª jt
2

dt = Œì ( n+1
2 )
œÄ
n‚àí1
2
N
‚àë
j=1
1
Œª n
j
.
Suppose we had that
sup
R‚â•1
|K
n‚àí1
2
R
(x0)| ‚â§Ax0 < ‚àû.
Then, setting cn =
Œì ( n+1
2
)
œÄ
n‚àí1
2
, we would have
cn
N
‚àë
j=1
1
Œª n
j
= lim
T‚Üí‚àû
1
T
 T
1 K
n‚àí1
2
t
(x0)
N
‚àè
j=1

1+ e‚àíi œÄn
2 e2œÄiŒª jt +ei œÄn
2 e‚àí2œÄiŒª jt
2

dt
= limsup
T‚Üí‚àû
1
T
 T
1 |K
n‚àí1
2
t
(x0)|
N
‚àè
j=1
1+ e‚àíi œÄn
2 e2œÄiŒª jt +ei œÄn
2 e‚àí2œÄiŒª jt
2
dt

4.2 Divergence Theorems
267
‚â§Ax0 limsup
T‚Üí‚àû
1
T
 T
1
N
‚àè
j=1

1+ e‚àíi œÄn
2 e2œÄiŒª jt +ei œÄn
2 e‚àí2œÄiŒª jt
2

dt
= Ax0 ,
which contradicts (4.2.19) by letting N ‚Üí‚àû. Here, once again, we used the fact
that no expression of the form ¬±Œª j1 ¬± ¬∑¬∑¬∑ ¬± Œª js is equal to an integer and thus the
preceding limsup is a limit and is equal to 1, since the integral of all the exponentials
produces another exponential which remains bounded.
We deduce that supR‚â•1 |K
n‚àí1
2
R
(x0)| = ‚àûfor every point x0 ‚ààS ‚à©[‚àí1
2, 1
2)n \ {0}
and this concludes the proof of Lemma 4.2.7.
‚ñ°
Proof. We now prove Theorem 4.2.5. This part of the proof is similar to the proof
of Theorem 4.2.1. Lemma 4.2.7 says that the means B
n‚àí1
2
R
(Œ¥0)(x), where Œ¥0 is the
Dirac mass at 0, do not converge for almost all x ‚ààTn. Our goal is to replace this
Dirac mass by a series of integrable functions on Tn that have a peak at the origin.
Let us Ô¨Åx a nonnegative C ‚àûradial function 1Œ¶ on Rn that is supported in the unit
ball |Œæ| ‚â§1 and has integral equal to 1. We set
œïŒµ(x) = ‚àë
m‚ààZn
1
Œµn 1Œ¶( x+m
Œµ ) = ‚àë
m‚ààZn
Œ¶(Œµm)e2œÄim¬∑x,
where the identity is valid because of the Poisson summation formula. It follows that
the mth Fourier coefÔ¨Åcient of œïŒµ is Œ¶(Œµm). Therefore, we have the estimate
sup
x‚ààTn sup
R>0
|B
n‚àí1
2
R
(œïŒµ)(x)| ‚â§‚àë
m‚ààZn
|Œ¶(Œµm)| ‚â§‚àë
m‚ààZn
C‚Ä≤
n
(1+Œµ|m|)n+1 ‚â§Cn
Œµn .
(4.2.21)
For any k ‚â•1, we construct measurable subsets Ek of Tn with |Ek| ‚â•1 ‚àí1
k, a se-
quence of positive numbers R1 < R2 < ¬∑¬∑¬∑, with Rk ‚Üë‚àû, and two sequences of posi-
tive numbers Œµk ‚Üì0 and Œ≥k ‚Üì0 such that Œµk ‚â§Œ≥k for all k and
sup
R‚â§Rk
B
n‚àí1
2
R
 ‚àû
‚àë
s=1
2‚àís(œïŒµs ‚àíœïŒ≥s)

(x)
 ‚â•k
for x ‚ààEk.
(4.2.22)
We pick E1 = /0, R1 = 1, and Œµ1 = Œ≥1 = 1. Let k > 1 and suppose that we have selected
Ej, Rj, Œ≥ j, and Œµ j for all 1 ‚â§j ‚â§k ‚àí1 such that (4.2.22) is satisÔ¨Åed. We construct
Ek, Rk, Œ≥k, and Œµk such that (4.2.22) is satisÔ¨Åed with j = k. We begin by choosing Œ≥k.
Let B be a constant such that
|Œ¶(x)‚àíŒ¶(y)| ‚â§B|x‚àíy|
for all x,y ‚ààRn. DeÔ¨Åne Œ≥k such that
BŒ≥k
‚àë
|m|‚â§Rk‚àí1
|m| = 1.
(4.2.23)

268
4 Topics on Fourier Series
Then deÔ¨Åne
Ak = Cn2‚àíkŒ≥‚àín
k
+Cn
k‚àí1
‚àë
j=1
2‚àíj(Œµ‚àín
j
+Œ≥‚àín
j ),
where Cn is the constant in (4.2.21), and observe that in view of (4.2.21) we have
sup
x‚ààTn sup
R>0
B
n‚àí1
2
R

‚àí2‚àíkœïŒ≥k +
k‚àí1
‚àë
j=1
2‚àíj(œïŒµ j ‚àíœïŒ≥ j)

(x)
 ‚â§Ak .
(4.2.24)
Let Œ¥0 be the Dirac mass at the origin in Tn. Since by Fatou‚Äôs lemma and Lemma
4.2.7 we have
liminf
R‚Ä≤‚Üí‚àû


x ‚ààTn :
sup
0<R‚â§R‚Ä≤
B
n‚àí1
2
R
(Œ¥0)(x)
 > 2k(Ak +k +2)
 = 1,
there exists an Rk > max(Rk‚àí1,k) such that the set
Ek =

x ‚ààTn :
sup
0<R‚â§Rk
B
n‚àí1
2
R
(2‚àíkŒ¥0)(x)
 > Ak +k +2

has measure at least 1 ‚àí1
k. Note that since Rk is increasing and tends to inÔ¨Ånity,
(4.2.23) yields that Œ≥k is decreasing and tends to zero.
We now choose Œµk such that Œµk ‚â§Œ≥k, Œµk ‚â§Œµk‚àí1, and that
sup
x‚ààTn sup
R‚â§Rk
2‚àíkB
n‚àí1
2
R
(Œ¥0)(x)‚àíB
n‚àí1
2
R
(œïŒµk)(x)
 ‚â§‚àë
|m|‚â§Rk
2‚àík
1‚àí|m|2
R2
k
 n‚àí1
2 |1‚àí2
œïŒµk(m)| ‚â§1.
This is possible, since for a Ô¨Åxed Rk, the preceding sum tends to zero as Œµk ‚Üí0.
Then for x ‚ààEk we have
inf
x‚ààEk
sup
R‚â§Rk
2‚àíkB
n‚àí1
2
R
(œïŒµk)(x)
 ‚â•Ak +k +1.
(4.2.25)
The inductive selection of the parameters can be schematically described as follows:
{Œ≥k‚àí1,Rk‚àí1,Ek‚àí1,Œµk‚àí1} =‚áíŒ≥k =‚áíAk =‚áí{Rk,Ek} =‚áíŒµk =‚áí{Œ≥k,Rk,Ek,Œµk}.
Observe that the construction of Œ≥k gives for all s ‚â•k +1 the estimate
sup
x‚ààTn sup
R‚â§Rk
|B
n‚àí1
2
R
(œïŒµs ‚àíœïŒ≥s)(x)| ‚â§‚àë
|m|‚â§Rk
|Œ¶(Œµsm)‚àíŒ¶(Œ≥sm)|
‚â§B(Œ≥s ‚àíŒµs) ‚àë
|m|‚â§Rk
|m|
‚â§BŒ≥s ‚àë
|m|‚â§Rk
|m|
‚â§BŒ≥k+1 ‚àë
|m|‚â§Rk
|m| = 1,
(4.2.26)
using (4.2.23) and the fact that the sequence Œ≥k is decreasing.

4.2 Divergence Theorems
269
We now prove (4.2.22). For x ‚ààTn write
B
n‚àí1
2
R
 ‚àû
‚àë
s=1
2‚àís(œïŒµs‚àíœïŒ≥s)

(x) = B
n‚àí1
2
R

‚àí2‚àíkœïŒ≥k +
k‚àí1
‚àë
s=1
2‚àís(œïŒµs‚àíœïŒ≥s)

(x)
+B
n‚àí1
2
R

2‚àíkœïŒµk

(x)
+B
n‚àí1
2
R

‚àû
‚àë
s=k+1
2‚àís(œïŒµs‚àíœïŒ≥s)

(x),
from which it follows that
sup
R‚â§Rk
B
n‚àí1
2
R
 ‚àû
‚àë
s=1
2‚àís(œïŒµs‚àíœïŒ≥s)

(x)
 ‚â•sup
R‚â§Rk
B
n‚àí1
2
R

2‚àíkœïŒµk

(x)

‚àísup
R‚â§Rk
B
n‚àí1
2
R

‚àí2‚àíkœïŒ≥k +
k‚àí1
‚àë
s=1
2‚àís(œïŒµs‚àíœïŒ≥s)

(x)

‚àísup
R‚â§Rk
B
n‚àí1
2
R

‚àû
‚àë
s=k+1
2‚àís(œïŒµs‚àíœïŒ≥s)

(x)
.
In view of (4.2.25), (4.2.24), and (4.2.26) for all x ‚ààEk, we obtain
sup
R‚â§Rk
B
n‚àí1
2
R
 ‚àû
‚àë
s=1
2‚àís(œïŒµs ‚àíœïŒ≥s)

(x)
 ‚â•(Ak +k +1)‚àíAk ‚àí
‚àû
‚àë
s=k+1
2‚àís ‚â•k,
which clearly implies (4.2.22). Setting
f =
‚àû
‚àë
s=1
2‚àís(œïŒµs ‚àíœïŒ≥s) ‚ààL1(Tn),
we deduce that supR>0
B
n‚àí1
2
R
( f)(x)
 ‚â•k for all x in ‚àû
r=k Er, and thus
sup
R>0
B
n‚àí1
2
R
( f)(x)
 = ‚àû
for all x in
‚àû

k=1
‚àû

r=k
Er .
Since this set has full measure in Tn, the required conclusion follows.
By taking Œµ1 arbitrarily small (instead of picking Œµ1 = 1), we force f to be sup-
ported in an arbitrarily small neighborhood of the origin.
‚ñ°
The previous argument shows that the Bochner‚ÄìRiesz means BŒ±
R are badly be-
haved on L1(Tn) when Œ± = n‚àí1
2 . It follows that the ‚Äúrougher‚Äù spherical Dirichlet
means
‚ó¶Dn
N ‚àóf (which correspond to Œ± = 0) are also ill behaved on L1(Tn). See
Exercise 4.2.2.

270
4 Topics on Fourier Series
Exercises
4.2.1. Using Theorem 4.2.1 construct a function F on Tn such that
limsup
N‚Üí‚àû
|(Dn
N ‚àóF)(x1,...,xn)| = ‚àû
for almost all (x1,...,xn) ‚ààTn.
4.2.2. For any 0 ‚â§Œ± < ‚àûand R > 0 consider the Bochner‚ÄìRiesz kernel
KŒ±
R (x) = ‚àë
|m|‚â§R

1‚àí|m|2
R2
Œ±e2œÄim¬∑x .
Use Exercise 4.1.8 to obtain that if for some x0 ‚ààTn we have
limsup
R‚Üí‚àû
|KŒ±
R (x0)| < ‚àû,
then for all Œ≤ > Œ± we have
sup
R>0
|KŒ≤
R (x0)| < ‚àû.
Conclude that whenever 0 ‚â§Œ± ‚â§n‚àí1
2 , the Bochner‚ÄìRiesz means of order Œ± of
the function f constructed in the proof of Theorem 4.2.5, in particular the circu-
lar (spherical) Dirichlet means of this function, diverge a.e.
4.2.3. (a) Show that for M,N positive integers we have
(FM ‚àóDN)(x) =
‚éß
‚é®
‚é©
FM(x)
for M ‚â§N,
FN(x)+
M‚àíN
(M+1)(N+1)
‚àë
|k|‚â§N
|k|e2œÄikx
for M > N.
(b) Prove that for some constant c > 0 we have

T1
 ‚àë
|k|‚â§N
|k|e2œÄikx
dx ‚â•cN logN
as N ‚Üí‚àû.

Hint: Part (b): Show that for x ‚àà[‚àí1
2, 1
2] we have
‚àë
|k|‚â§N
|k|e2œÄikx = (N +1)(DN(x)‚àíFN(x))
and use the result of Exercise 3.1.5.


4.3 Multipliers, Transference, and A. E. Convergence
271
4.2.4. Given the integrable functions
f1(x) =
‚àû
‚àë
j=0
2‚àíjF
222 j (x),
f2(x) =
‚àû
‚àë
j=1
1
j2 F22 j (x),
x ‚ààT1,
show that ‚à•f1 ‚àóDN‚à•L1 ‚Üí‚àûand ‚à•f2 ‚àóDN‚à•L1 ‚Üí‚àûas N ‚Üí‚àû.

Hint: Let Mj = 222 j
or Mj = 22 j depending on the situation. For Ô¨Åxed N let jN
be the least integer j such that Mj > N. Then for j ‚â•jN + 1 we have Mj ‚â•M2
jN >
N2 ‚â•2N +1, hence Mj‚àíN
Mj+1 ‚â•1
2. Split the summation indices into the sets j ‚â•jN and
j < jN. Conclude that ‚à•f1 ‚àóDN‚à•L1 and ‚à•f2 ‚àóDN‚à•L1 tend to inÔ¨Ånity as N ‚Üí‚àûusing
Exercise 4.2.3.

4.3 Multipliers, Transference, and Almost Everywhere
Convergence
In Chapter 2 we saw that bounded operators from Lp(Rn) to Lq(Rn) that commute
with translations are given by convolution with tempered distributions on Rn. In par-
ticular, when p = q, these tempered distributions have bounded Fourier transforms,
called Fourier multipliers. Convolution operators that commute with translations
can also be deÔ¨Åned on the torus. These lead to Fourier multipliers on the torus.
4.3.1 Multipliers on the Torus
In analogy with the nonperiodic case, we could identify convolution operators on Tn
with appropriate distributions on the torus; see Exercise 4.3.2 for an introduction to
this topic. However, it is simpler to avoid this point of view and consider the study
of multipliers directly, bypassing the discussion of distributions on the torus.
For h ‚ààTn we deÔ¨Åne the translation operator œÑh acting on a periodic function
f as follows: œÑh( f)(x) = f(x ‚àíh) for x ‚ààTn. We say that a linear operator T act-
ing on functions on the torus commutes with translations if for all h ‚ààTn we have
œÑh(T( f))(x) = T(œÑh f)(x) for almost all x ‚ààTn.
Theorem 4.3.1. Suppose that T is a linear operator that commutes with translations
and maps Lp(Tn) to Lq(Tn) for some 1 ‚â§p,q ‚â§‚àû. Then there exists a bounded
sequence {am}m‚ààZn such that
T( f)(x) = ‚àë
m‚ààZn
am 1f(m)e2œÄim¬∑x
(4.3.1)

272
4 Topics on Fourier Series
for all f ‚ààC ‚àû(Tn). Moreover, we have
{am}

‚Ñì‚àû‚â§
T

Lp‚ÜíLq .
Proof. Consider the functions em(x) = e2œÄim¬∑x deÔ¨Åned on Tn for m in Zn. Since
T commutes with translations, for every h ‚ààTn there is a subset Fh of Tn of full
measure such that
T(em)(x‚àíh) = T(œÑh(em))(x) = e‚àí2œÄim¬∑hT(em)(x)
for every x ‚ààFh. Note that

Tn |{h ‚ààTn : x ‚ààFh}|dx =

Tn

Tn œá{(h,x)‚ààTn√óTn: x‚ààFh} dhdx
=

Tn

Tn œá{(h,x)‚ààTn√óTn: x‚ààFh} dxdh
=

Tn |Fh|dh = 1.
Therefore there exists an x0 ‚ààTn such that |{h ‚ààTn : x0 ‚ààFh}| = 1. It follows that
for almost all h ‚ààTn we have T(em)(x0 ‚àíh) = e‚àí2œÄim¬∑hT(em)(x0). Replacing x0 ‚àíh
by x, we obtain
T(em)(x) = e2œÄim¬∑x
e‚àí2œÄim¬∑x0T(em)(x0)

= amem(x)
(4.3.2)
for almost all x ‚ààTn, where we set am = e‚àí2œÄim¬∑x0T(em)(x0), for m ‚ààZn. Taking Lq
norms in (4.3.2), we deduce |am| = ‚à•T(em)‚à•Lq ‚â§‚à•T‚à•Lp‚ÜíLq, and thus am is bounded.
Moreover, since T(em) = amem for all m in Zn, it follows that (4.3.1) holds for all
trigonometric polynomials. By density this extends to all f ‚ààC ‚àû(Tn) and the theo-
rem is proved.
‚ñ°
DeÔ¨Ånition 4.3.2. Let 1 ‚â§p,q ‚â§‚àû. We call a bounded sequence {am}m‚ààZn an
(Lp,Lq) multiplier if the corresponding operator given by (4.3.1) maps Lp(Tn)
to Lq(Tn). If p = q, (Lp,Lp) multipliers are simply called Lp multipliers. When
1 ‚â§p < ‚àû, the space of all Lp multipliers on Tn is denoted by Mp(Zn). This no-
tation follows the convention that Mp( 1G) denote the space of Lp multipliers on
Lp(G), where G is a locally compact group and 1G is its dual group. The norm of
an element {am} in Mp(Zn) is the norm of the operator T given by (4.3.1) from
Lp(Tn) to itself. This norm is denoted by
{am}

Mp.
We now examine some special cases. We begin with the case p = q = 2. As
expected, it turns out that M2(Zn) = ‚Ñì‚àû(Zn).
Theorem 4.3.3. A linear operator T that commutes with translations maps L2(Tn)
to itself if and only if there exists a sequence {am}m‚ààZn in ‚Ñì‚àû(Zn) such that
T( f)(x) = ‚àë
m‚ààZn
am 1f(m)e2œÄim¬∑x
(4.3.3)
for all f ‚ààC ‚àû(Tn). Moreover, in this case we have
T

L2‚ÜíL2 =
{am}m

‚Ñì‚àû.

4.3 Multipliers, Transference, and A. E. Convergence
273
Proof. The existence of such a sequence is guaranteed by Theorem 4.3.1, which also
gives ‚à•{am}m‚à•‚Ñì‚àû‚â§‚à•T‚à•L2‚ÜíL2. Conversely, any operator of the form (4.3.3) satisÔ¨Åes
T( f)
2
L2 = ‚àë
m‚ààZn
|am 1f(m)|2 ‚â§
{am}m
2
‚Ñì‚àû‚àë
m‚ààZn
| 1f(m)|2 ,
and thus ‚à•T‚à•L2‚ÜíL2 ‚â§‚à•{am}m‚à•‚Ñì‚àû.
‚ñ°
We continue with the case p = q = 1. Recall the deÔ¨Ånition of a Ô¨Ånite Borel mea-
sure on Tn. Given such a measure Œº, its Fourier coefÔ¨Åcients are deÔ¨Åned by
1Œº(m) =

Tn e‚àí2œÄix¬∑m dŒº(x),
m ‚ààZn .
Clearly, all the Fourier coefÔ¨Åcients of the measure Œº are bounded by the total vari-
ation
Œº
 of Œº. See Exercise 4.3.3 for basic properties of Fourier transforms of
distributions on the torus.
Theorem 4.3.4. A linear operator T that commutes with translations maps L1(Tn)
to itself if and only if there exists a Ô¨Ånite Borel measure Œº on the torus such that
T( f)(x) = ‚àë
m‚ààZn
1Œº(m) 1f(m)e2œÄim¬∑x
(4.3.4)
for all f ‚ààC ‚àû(Tn). Moreover, in this case we have ‚à•T‚à•L1‚ÜíL1 = ‚à•Œº‚à•. In other words,
M1(Zn) is the set of all sequences given by Fourier coefÔ¨Åcients of Ô¨Ånite Borel mea-
sures on Tn.
Proof. Fix f ‚ààL1(Tn). If (4.3.4) is valid, then 
T( f)(m) = 1f(m)1Œº(m) for all m ‚ààZn.
But Exercise 4.3.3 gives that 
f ‚àóŒº(m) = 1f(m)1Œº(m) for all m ‚ààZn; therefore, the
integrable functions f ‚àóŒº and T( f) have the same Fourier coefÔ¨Åcients, and they
must be equal. Thus T( f) = f ‚àóŒº, which implies that T is bounded on L1 and
‚à•T( f)‚à•L1 ‚â§‚à•Œº‚à•‚à•f‚à•L1.
To prove the converse direction, we suppose that T commutes with translations
and maps L1(Tn) to itself. We recall the Poisson kernel PŒµ deÔ¨Åned on Tn, which can
be expressed in the following two ways:
PŒµ(x) = ‚àë
m‚ààZn
e‚àí2œÄ|m|Œµe2œÄim¬∑x = Œì ( n+1
2 )
œÄ
n+1
2
‚àë
m‚ààZn
Œµ‚àín
(1+| x+m
Œµ |2)
n+1
2
‚â•0
(4.3.5)
for all x ‚ààTn, in view of the identity obtained in (3.2.4). The preceding identity says
that PŒµ ‚â•0; hence, ‚à•PŒµ‚à•L1 =

Tn PŒµ(x)dx. Integrating the Ô¨Årst series in (4.3.5) over
Tn we conclude that ‚à•PŒµ‚à•L1(Tn) = 1. The boundedness of T now gives
T(PŒµ)

L1(Tn) ‚â§
T

L1‚ÜíL1

274
4 Topics on Fourier Series
for all Œµ > 0. The Banach‚ÄìAlaoglu theorem implies that there exist a sequence Œµj ‚Üì0
and a Ô¨Ånite Borel measure Œº on Tn such that T(PŒµ j) tends to Œº weakly as j ‚Üí‚àû.
This means that for all continuous functions g on Tn we have
lim
j‚Üí‚àû

Tn g(x)T(PŒµ j)(x)dx =

Tn g(x)dŒº(x).
(4.3.6)
It follows from (4.3.6) that for all g continuous on Tn we have


Tn g(x)dŒº(x)
 ‚â§sup
j
T(PŒµ j)

L1
g

L‚àû‚â§
T

L1‚ÜíL1
g

L‚àû.
Since, by the Riesz representation theorem we have that the norm of the linear func-
tional
g ‚Üí

Tn g(x)dŒº(x)
on the space of continuous functions C (Tn) is ‚à•Œº‚à•, it follows that
‚à•Œº‚à•‚â§
T

L1‚ÜíL1.
(4.3.7)
It remains to prove that T has the form given in (4.3.4). By Theorem 4.3.1 we have
that there exists a bounded sequence {am} on Zn such that (4.3.1) is satisÔ¨Åed. Taking
g(x) = e‚àí2œÄik¬∑x in (4.3.6) and using the representation for T in (4.3.1), we obtain
1Œº(k) =

Tn e‚àí2œÄik¬∑x dŒº(x)
= lim
j‚Üí‚àû

Tn e‚àí2œÄik¬∑x ‚àë
m‚ààZn
ame‚àí2œÄŒµ j|m|e2œÄim¬∑x dx
= lim
j‚Üí‚àû‚àë
m‚ààZn

Tn e‚àí2œÄik¬∑xame‚àí2œÄŒµ j|m|e2œÄim¬∑x dx
= lim
j‚Üí‚àûake‚àí2œÄŒµ j|k| = ak .
This proves assertion (4.3.4). It follows from (4.3.4) that T( f) = f ‚àóŒº and thus
‚à•T‚à•L1‚ÜíL1 ‚â§‚à•Œº‚à•. This fact combined with (4.3.7) gives ‚à•T‚à•L1‚ÜíL1 = ‚à•Œº‚à•.
‚ñ°
Remark 4.3.5. It is not hard to see that most basic properties of the space Mp(Rn)
of Lp Fourier multipliers on Rn are also valid for Mp(Zn). In particular, Mp(Zn) is
a closed subspace of ‚Ñì‚àû(Zn) and thus a Banach space itself. Moreover, sums, scalar
multiples, and products of elements of Mp(Zn) are also in Mp(Zn), which makes
this space a Banach algebra. As in the nonperiodic case, we also have Mp(Zn) =
Mp‚Ä≤(Zn) when 1 < p < ‚àû.

4.3 Multipliers, Transference, and A. E. Convergence
275
4.3.2 Transference of Multipliers
It is clear by now that multipliers on L1(Tn) and L1(Rn) are very similar, and the
same is true for L2(Tn) and L2(Rn). These similarities became obvious when we
characterized L1 and L2 multipliers on both Rn and Tn. So far, it is not known if a
nontrivial characterization of Mp(Rn) exists, but we might ask whether this space is
related to Mp(Zn). There are several connections of this type and there are general
ways to produce multipliers on the torus from multipliers on Rn and vice versa.
General methods of this sort are called transference of multipliers.
We begin with a useful deÔ¨Ånition.
DeÔ¨Ånition 4.3.6. Let t0 ‚ààRn. A bounded function b on Rn is called regulated at the
point t0 if
lim
Œµ‚Üí0
1
Œµn

|t|‚â§Œµ

b(t0 ‚àít)‚àíb(t0)

dt = 0.
(4.3.8)
The function b is called regulated if it is regulated at every t0 ‚ààRn.
Clearly, if t0 is a Lebesgue point of b, then b is regulated at t0. In particular, this
is the case if b is continuous at t0. If b(t0) = 0, condition (4.3.8) also holds when
b(t0 ‚àít) = ‚àíb(t0 +t) whenever |t| ‚â§Œµ for some Œµ > 0; for instance the function
b(t) = ‚àíisgn(t ‚àít0) has this property.
An example of a regulated function is the following modiÔ¨Åcation of the charac-
teristic function of the cube [‚àí1,1]n
#œá[‚àí1,1]n(x1,...,xn) =
‚éß
‚é™
‚é™
‚é™
‚é®
‚é™
‚é™
‚é™
‚é©
1
when all |xj| < 1,
2k‚àín
if (x1,...,xn) belongs to some k-dimensional
face of the boundary of [‚àí1,1]n,
0
when some |xj| > 1,
with the understanding that points are zero-dimensional.
The Ô¨Årst transference result we discuss is the following.
Theorem 4.3.7. Suppose that b is a regulated function at every point m ‚ààZn and
that b lies in Mp(Rn) for some 1 < p < ‚àû. Then the sequence {b(m)}m‚ààZn is in
Mp(Zn) and moreover,
{b(m)}m‚ààZn
Mp(Zn) ‚â§‚à•b‚à•Mp(Rn) .
If b is regulated everywhere, then for all R > 0 the sequences {b(m/R)}m‚ààZn are
in Mp(Zn) and we have
sup
R>0
{b(m/R)}m‚ààZn
Mp(Zn) ‚â§‚à•b‚à•Mp(Rn) .
The second conclusion of the theorem is a consequence of the Ô¨Årst, since for a
given R > 0 the function b(Œæ/R) is regulated on Zn and has the same Mp(Rn) norm
as b(Œæ). Before we prove this result, we state and prove a couple of lemmas.

276
4 Topics on Fourier Series
Lemma 4.3.8. Suppose that the function b on Rn is regulated at the point x0. Let
KŒµ(x) = Œµ‚àíne‚àíœÄ|x/Œµ|2 for Œµ > 0. Then we have that (b‚àóKŒµ)(x0) ‚Üíb(x0) as Œµ ‚Üí0.
Proof. For r > 0 deÔ¨Åne the function
Fx0(r) = 1
rn

|t|‚â§r

b(x0‚àít)‚àíb(x0)

dt = 1
rn
 r
0

Sn‚àí1

b(x0‚àísŒ∏)‚àíb(x0)

dŒ∏sn‚àí1ds.
Let Œ∑ > 0. Since b is regulated at x0 there is a Œ¥ > 0 such that for r ‚â§Œ¥ we have
|Fx0(r)| ‚â§Œ∑. Fix such a Œ¥ and write
(b‚àóKŒµ)(x0)‚àíb(x0) =

y‚ààRn

b(x0 ‚àíy)‚àíb(x0)

KŒµ(y)dy = AŒµ
1 +AŒµ
2,
where
AŒµ
1 =

|y|‚â•Œ¥

b(x0 ‚àíy)‚àíb(x0)

KŒµ(y)dy
and
AŒµ
2 =

|y|<Œ¥

b(x0 ‚àíy)‚àíb(x0))KŒµ(y)

dy
=
 Œ¥
0
1
Œµn e‚àíœÄ(r/Œµ)2 
Sn‚àí1

b(x0 ‚àírŒ∏)‚àíb(x0)

rndr
=
 Œ¥
0
1
Œµn e‚àíœÄ(r/Œµ)2 d
dr(rnFx0(r))dr.
For our given Œ∑ > 0 there is an Œµ0 > 0 such that for Œµ < Œµ0 we have
|AŒµ
1| ‚â§2‚à•b‚à•L‚àû

|y|‚â•Œ¥
Œµ
e‚àíœÄ|y|2dy < Œ∑ .
Via an integration by parts AŒµ
2 can be written as
|AŒµ
2| =
Œ¥ nFx0(Œ¥) 1
Œµn e‚àíœÄ(Œ¥/Œµ)2 ‚àí0+2œÄ
 Œ¥
0
r
Œµn+2 e‚àíœÄ(r/Œµ)2rnFx0(r)dr

=
Fx0(Œ¥)Œ¥ n
Œµn e‚àíœÄ(Œ¥/Œµ)2 +2œÄ
 Œ¥/Œµ
0
rn+1Fx0(Œµr)e‚àíœÄr2dr

‚â§
Fx0(Œ¥)
Œ¥ n
Œµn e‚àíœÄ(Œ¥/Œµ)2 + sup
0<r‚â§Œ¥
Œµ
|Fx0(Œµr)|2œÄ
 Œ¥/Œµ
0
rn+1e‚àíœÄr2dr
‚â§
Fx0(Œ¥)
Cn + sup
0<r‚â§Œ¥
|Fx0(r)|C‚Ä≤
n
‚â§(Cn +C‚Ä≤
n)Œ∑ ,
where we set Cn = supt>0tne‚àíœÄt2 and C‚Ä≤
n = 2œÄ
 ‚àû
0 rn+1e‚àíœÄr2dr. Then for Œµ < Œµ0 we
have |(b‚àóKŒµ)(x0 ‚àíb(x0)| < (Cn +C‚Ä≤
n +1)Œ∑, thus (b‚àóKŒµ)(x0) ‚Üíb(x0) as Œµ ‚Üí0. ‚ñ°

4.3 Multipliers, Transference, and A. E. Convergence
277
Lemma 4.3.9. Let T be the operator on Rn whose multiplier is b(Œæ), and let S be
the operator on Tn whose multiplier is the sequence {b(m)}m‚ààZn. Assume that b(Œæ)
is regulated at every point Œæ = m ‚ààZn. Suppose that P and Q are trigonometric
polynomials on Tn and let LŒµ(x) = e‚àíœÄŒµ|x|2 for x ‚ààRn and Œµ > 0. Then the following
identity is valid whenever Œ±,Œ≤ > 0 and Œ± +Œ≤ = 1:
lim
Œµ‚Üí0Œµ
n
2

Rn T(PLŒµŒ±)(x)Q(x)LŒµŒ≤(x)dx =

Tn S(P)(x)Q(x)dx.
(4.3.9)
Proof. It sufÔ¨Åces to prove the required assertion for P(x) = e2œÄim¬∑x and Q(x) =
e2œÄik¬∑x, k,m ‚ààZn, since the general case follows from this case by linearity. In view
of Parseval‚Äôs relation (Proposition 3.2.7 (3)), we have

Tn S(P)(x)Q(x)dx = ‚àë
r‚ààZn
b(r)1P(r) 1Q(r) =

b(m)
when k = m,
0
when k Ã∏= m.
(4.3.10)
On the other hand, using the identity in Theorem 2.2.14 (3), we obtain
Œµ
n
2

Rn T(PLŒµŒ±)(x)Q(x)LŒµŒ≤(x)dx
= Œµ
n
2

Rn b(Œæ)
PLŒµŒ±(Œæ) 
QLŒµŒ≤(Œæ)dŒæ
= Œµ
n
2

Rn b(Œæ)(ŒµŒ±)‚àín
2 e‚àíœÄ |Œæ‚àím|2
ŒµŒ±
(ŒµŒ≤)‚àín
2 e‚àíœÄ |Œæ‚àík|2
ŒµŒ≤
dŒæ
= (ŒµŒ±Œ≤)‚àín
2

Rn b(Œæ)e‚àíœÄ |Œæ‚àím|2
ŒµŒ±
e‚àíœÄ |Œæ‚àík|2
ŒµŒ≤
dŒæ .
(4.3.11)
Now if m = k, since Œ± +Œ≤ = 1, the expression in (4.3.11) is equal to
(ŒµŒ±Œ≤)‚àín
2

Rn b(Œæ)e‚àíœÄ |Œæ‚àím|2
ŒµŒ±Œ≤ dŒæ ,
(4.3.12)
which tends to b(m) in view of Lemma 4.3.8, since b is regulated at every point
m ‚ààZn.
We now consider the case m Ã∏= k in (4.3.11). Since |m ‚àík| ‚â•1, then every Œæ in
Rn must satisfy either |Œæ ‚àím| ‚â•1/2 or |Œæ ‚àík| ‚â•1/2. Therefore, the expression in
(4.3.11) is controlled by
(ŒµŒ±Œ≤)‚àín
2

|Œæ‚àím|‚â•1
2
b(Œæ)e‚àíœÄ
4ŒµŒ± e‚àíœÄ |Œæ‚àík|2
ŒµŒ≤
dŒæ +

|Œæ‚àík|‚â•1
2
b(Œæ)e‚àíœÄ
4ŒµŒ≤ e‚àíœÄ |Œæ‚àím|2
ŒµŒ±
dŒæ

,
which is in turn controlled by
‚à•b‚à•L‚àû
Œ±‚àín
2 e‚àíœÄ
4ŒµŒ± +Œ≤ ‚àín
2 e‚àíœÄ
4ŒµŒ≤ 
,

278
4 Topics on Fourier Series
which tends to zero as Œµ ‚Üí0. This proves that the expression in (4.3.10) is equal
to the limit of the expression in (4.3.11) as Œµ ‚Üí0. This completes the proof of
Lemma 4.3.9
‚ñ°
Proof (Theorem 4.3.7). We are assuming that T maps Lp(Rn) to itself and we need
to show that S maps Lp(Tn) to itself. We prove this using duality. For P and Q
trigonometric polynomials, using Lemma 4.3.9, we have


TnS(P)(x)Q(x)dx

=
 lim
Œµ‚Üí0Œµ
n
2

Rn T(PLŒµ/p)(x)Q(x)LŒµ/p‚Ä≤(x)dx

‚â§
T

Lp‚ÜíLp limsup
Œµ‚Üí0
Œµ
n
2 PLŒµ/p

Lp(Rn)
QLŒµ/p‚Ä≤

Lp‚Ä≤(Rn)
=
T

Lp‚ÜíLp limsup
Œµ‚Üí0

Œµ
n
2

Rn|P(x)|pe‚àíŒµœÄ|x|2 dx
1
p
Œµ
n
2

Rn|Q(x)|p‚Ä≤e‚àíŒµœÄ|x|2 dx
 1
p‚Ä≤
=
T

Lp‚ÜíLp

Tn |P(x)|p dx
1
p 
Tn |Q(x)|p‚Ä≤ dx
 1
p‚Ä≤
,
provided for all continuous 1-periodic functions g on Rn we have that
lim
Œµ‚Üí0Œµ
n
2

Rn g(x)e‚àíŒµœÄ|x|2 dx =

Tn g(x)dx.
(4.3.13)
Assuming (4.3.13) for the moment, we take the supremum over all trigonometric
polynomials Q on Tn with Lp‚Ä≤ norm at most 1 to obtain that S maps Lp(Tn) to itself
with norm at most ‚à•T‚à•Lp‚ÜíLp, yielding the required conclusion.
We now prove (4.3.13). Use the Poisson summation formula to write the left-hand
side of (4.3.13) as
Œµ
n
2 ‚àë
k‚ààZn

Tn g(x‚àík)e‚àíŒµœÄ|x‚àík|2 dx =

Tn g(x)Œµ
n
2 ‚àë
k‚ààZn
e‚àíŒµœÄ|x‚àík|2 dx
=

Tn g(x) ‚àë
k‚ààZn
e‚àíœÄ|k|2/Œµe2œÄix¬∑k dx
=

Tn g(x)dx+AŒµ ,
where
|AŒµ| ‚â§
g

L‚àû‚àë
|k|‚â•1
e‚àíœÄ|k|2/Œµ ‚Üí0
as Œµ ‚Üí0. This completes the proof of Theorem 4.3.7.
‚ñ°
We now obtain a converse of Theorem 4.3.7. If b(Œæ) is a bounded function on Rn
and the sequence {b(m)}m‚ààZn is in Mp(Zn), then we cannot necessarily obtain that

4.3 Multipliers, Transference, and A. E. Convergence
279
b is in Mp(Rn), since such a conclusion would depend on the values of b on the in-
teger lattice, which is a set of measure zero. However, a converse can be formulated
if we assume that for all R > 0, the sequences {b(m/R)}m‚ààZn are in Mp(Zn) uni-
formly in R. Then we obtain that b(Œæ/R) is in Mp(Rn) uniformly in R > 0, which is
equivalent to saying that b ‚ààMp(Rn), since dilations of multipliers on Rn do not af-
fect their norms (see Proposition 2.5.14). These remarks can be precisely expressed
in the following theorem.
Theorem 4.3.10. Suppose that b(Œæ) is a bounded function deÔ¨Åned on Rn which is
Riemann integrable over any cube. Suppose that the sequences {b( m
R )}m‚ààZn are in
Mp(Zn) uniformly in R > 0 for some 1 < p < ‚àû. Then b is in Mp(Rn) and we have
‚à•b‚à•Mp(Rn) ‚â§sup
R>0
{b( m
R )}m‚ààZn
Mp(Zn).
(4.3.14)
Proof. Suppose that f and g are smooth functions with compact support on Rn.
Then there is an R0 > 0 such that for R ‚â•R0, the functions x ‚Üíf(Rx) and x ‚Üíg(Rx)
are supported in [‚àí1/2,1/2]n. We deÔ¨Åne periodic functions
FR(x) = ‚àë
k‚ààZn
f(R(x‚àík))
and
GR(x) = ‚àë
k‚ààZn
g(R(x‚àík))
on Tn. Observe that the mth Fourier coefÔ¨Åcient of FR is 2
FR(m) = R‚àín 1f(m/R) and
that of GR is 2
GR(m) = R‚àín1g(m/R).
Now for R ‚â•R0 we have
 ‚àë
m‚ààZn
b(m/R) 1f(m/R)1g(m/R) Volume
 m
R +[0, 1
R]n
(4.3.15)
=
Rn ‚àë
m‚ààZn
b(m/R)2
FR(m)2
GR(m)

=
Rn

Tn

‚àë
m‚ààZn
b(m/R)2
FR(m)e2œÄim¬∑x

GR(x)dx

‚â§Rn{b(m/R)}m

Mp(Zn)
FR

Lp(Tn)
GR

Lp‚Ä≤(Tn)
‚â§sup
R>0
{b(m/R)}m‚ààZn
Mp(Zn) RnFR

Lp(Rn)
GR

Lp‚Ä≤(Rn)
= sup
R>0
{b(m/R)}m‚ààZn
Mp(Zn)
f

Lp(Rn)
g

Lp‚Ä≤(Rn).
(4.3.16)
Since b is bounded and Riemann integrable over any cube in Rn, the function
b(Œæ) 1f(Œæ)1g(Œæ) is Riemann integrable over Rn. The expressions in (4.3.15) are sums
associated with the partition {[ m
R , m+1
R )n}m‚ààZn of Rn which tend to


Rn b(Œæ) 1f(Œæ)1g(Œæ)dŒæ


280
4 Topics on Fourier Series
as R ‚Üí‚àûby the deÔ¨Ånition of the Riemann integral. We deduce that the absolute
value of

Rn b(Œæ) 1f(Œæ)1g(Œæ)dŒæ =

Rn(b 1f )‚à®(x)g(x)dx
is bounded by the expression in (4.3.16). This proves the theorem via duality.
‚ñ°
4.3.3 Applications of Transference
Having established two main transference theorems, we turn to an application.
Corollary 4.3.11. Let 1 < p < ‚àû, f ‚ààLp(Tn), and Œ± ‚â•0. Then
(a)
Dn
R ‚àóf ‚àíf

Lp(Tn) ‚Üí0 as R ‚Üí‚àûif and only if œá[‚àí1,1]n ‚ààMp(Rn).
(b)
 ‚ó¶Dn
R ‚àóf ‚àíf

Lp(Tn) ‚Üí0 as R ‚Üí‚àûif and only if œáB(0,1) ‚ààMp(Rn).
(c)
BŒ±
R( f)‚àíf

Lp(Tn) ‚Üí0 as R ‚Üí‚àûif and only if (1‚àí|Œæ|2)Œ±
+ ‚ààMp(Rn).
Proof. First observe that in view of Corollary 4.1.3, the assertions on the left in (a),
(b), and (c) are equivalent to the statements
sup
R>0
Dn
R ‚àóf

Lp(Tn) ‚â§Cp
f

Lp(Tn) ,
sup
R>0
 ‚ó¶Dn
R ‚àóf

Lp(Tn) ‚â§Cp
f

Lp(Tn) ,
sup
R>0
BŒ±
R( f)

Lp(Tn) ‚â§Cp
f

Lp(Tn) ,
for some constant 0 < Cp < ‚àûand all f in Lp(Tn). These statements can be
rephrased as
sup
R>0
{œá[‚àí1,1]n(m/R)}m‚ààZn
Mp(Zn) <‚àû,
sup
R>0
{œáB(0,1)(m/R)}m‚ààZn
Mp(Zn) <‚àû,
sup
R>0
{(1‚àí|m/R|2)Œ±
+}m‚ààZn
Mp(Zn) <‚àû.
If these statements hold, then Theorem 4.3.10 gives that the functions œá[‚àí1,1]n(Œæ),
œáB(0,1)(Œæ), and (1‚àí|Œæ|2)Œ±
+ lie in Mp(Rn).
To prove the converse implication, for any given R‚Ä≤ ‚ààR+ \ {|m| : m ‚ààZn}, the
functions œá[‚àí1,1]n(Œæ/R‚Ä≤), œáB(0,1)(Œæ/R‚Ä≤) are Riemann integrable over Rn and are reg-
ulated (actually continuous) at every point in Zn. Moreover, the function (1‚àí|Œæ|2)Œ±
+
is continuous, regulated, and Riemann integrable over Rn. Then the hypotheses of
Theorem 4.3.7 are satisÔ¨Åed and its conclusion yields that
{œá[‚àí1,1]n(m/R‚Ä≤)}m‚ààZn
Mp(Zn) ‚â§
œá[‚àí1,1]n

Mp ,
(4.3.17)

4.3 Multipliers, Transference, and A. E. Convergence
281
{œáB(0,1)(m/R‚Ä≤)}m‚ààZn
Mp(Zn) ‚â§
œáB(0,1)

Mp ,
(4.3.18)
sup
R>0
{(1‚àí|m/R|2)Œ±
+}m‚ààZn
Mp(Zn) ‚â§
(1‚àí| ¬∑ |2)Œ±
+

Mp.
Notice that the Ô¨Årst and second estimates are uniform in R‚Ä≤, so one may insert a
supremum over R‚Ä≤ ‚ààR+ \{|m| : m ‚ààZn} in (4.3.17) and (4.3.18). To replace R‚Ä≤ by a
general R ‚ààZ+ simply notice that for any R > 0 there is an R‚Ä≤ ‚ààR+ \{|m| : m ‚ààZn}
such that
Dn
R ‚àóf = Dn
R‚Ä≤ ‚àóf
and
‚ó¶Dn
R ‚àóf =
‚ó¶
Dn
R‚Ä≤ ‚àóf
for any f ‚ààLp(Tn). Then using (4.3.17) we obtain
sup
R>0
Dn
R ‚àóf

Lp = sup
R>0
Dn
R‚Ä≤ ‚àóf

Lp = sup
R‚Ä≤>0
Dn
R‚Ä≤ ‚àóf

Lp ‚â§
œá[‚àí1,1]n

Mp
f

Lp
and likewise for
‚ó¶Dn
R.
‚ñ°
4.3.4 Transference of Maximal Multipliers
We now prove a theorem concerning maximal multipliers analogous to Theorems
4.3.7 and 4.3.10. This enables us to reduce problems related to almost everywhere
convergence of Fourier series on the torus to problems of boundedness of maximal
operators on Rn.
Let b be a bounded function deÔ¨Åned on all of Rn. For R > 0, we introduce the
multiplier operators
Sb,R(F)(x) = ‚àë
m‚ààZn
b(m/R)1F(m)e2œÄim¬∑x ,
(4.3.19)
Tb,R( f)(x) =

Rn b(Œæ/R) 1f(Œæ)e2œÄiŒæ¬∑x dŒæ ,
(4.3.20)
initially deÔ¨Åned for smooth functions with compact support f on Rn and smooth
functions F on Tn.
We introduce the maximal operators
Mb(F)(x) = sup
R>0
Sb,R(F)(x)
,
(4.3.21)
Nb( f)(x) = sup
R>0
Tb,R( f)(x)
,
(4.3.22)
deÔ¨Åned for smooth functions F on Tn and smooth functions with compact support
f on Rn. Let œÑy(b)(Œæ) = b(Œæ ‚àíy) be a translation operator deÔ¨Åned for y ‚ààRn. We
have the following result concerning these operators.
Theorem 4.3.12. Let b be a function deÔ¨Åned on Rn. Suppose that b is bounded,
regulated, Riemann integrable over any cube, and assume that for all Œæ ‚ààRn the

282
4 Topics on Fourier Series
function t ‚Üíb(Œæ/t) has only countably many discontinuities on R+. Let 1 < p < ‚àû
and Cp < ‚àû, and suppose that b lies in Mp(Rn). Let Mb and Nb be as in (4.3.21)
and (4.3.22). Then the following assertions are equivalent:
Mb(F)

Lp(Tn) ‚â§Cp
b

Mp
F

Lp(Tn) ,
F ‚ààC ‚àû(Tn),
(4.3.23)
Nb( f)

Lp(Rn) ‚â§Cp
b

Mp
 f

Lp(Rn) ,
f ‚ààC ‚àû
0 (Rn).
(4.3.24)
Proof. Let F = {t1,...,tk} be a Ô¨Ånite subset of R+. We prove the claimed equiva-
lences for the maximal operators
MF
b (G)(x) = sup
t‚ààF
Sb,t(G)(x)
,
NF
b (g)(x) = sup
t‚ààF
Tb,t(g)(x)
,
with constants that are uniform in the Ô¨Ånite set F. Then MF
b
may be viewed as
an operator deÔ¨Åned on the dense subspace C ‚àû(Tn) of Lp(Tn) and taking values in
Lp(Tn,‚Ñì‚àû(F)), which is the dual space of Lp‚Ä≤(Tn,‚Ñì1(F)). Likewise, NF
b is deÔ¨Åned
on the dense subspace C ‚àû
0 (Rn) of Lp(Rn) and takes values in Lp(Rn,‚Ñì‚àû(F)), which
is the dual space of Lp‚Ä≤(Rn,‚Ñì1(F)). Using duality, with respect to the complex inner
product, estimates (4.3.23) and (4.3.24) are equivalent to the pair of inequalities
 ‚àë
m‚ààZn
1G(m)
k
‚àë
j=1
b
m
t j

1Fj(m)
 ‚â§Cp
b

Mp
G

Lp(Tn)

k
‚àë
j=1
|Fj|

Lp‚Ä≤(Tn) ,
(4.3.25)


Rn 1g(Œæ)
k
‚àë
j=1
b
Œæ
t j

1f j(Œæ)dŒæ
 ‚â§Cp
b

Mp
g

Lp(Rn)

k
‚àë
j=1
| f j|

Lp‚Ä≤(Rn),
(4.3.26)
where g, f j ‚ààC ‚àû
0 (Rn), and G,Fj ‚ààC ‚àû(Tn). In proving the equivalence of (4.3.25)
and (4.3.26), by density, we work with smooth functions with compact support g, f j
and trigonometric polynomials G,Fj.
Suppose that (4.3.25) holds and let f1,..., fk,g be smooth functions with com-
pact support on Rn. Then there is an R0 > 0 such that for R ‚â•R0 the functions
Fj,R(x) = f j(Rx) and GR(x) = g(Rx) are supported in [‚àí1/2,1/2]n and thus they
can be viewed as functions on Tn once they are periodized. Also, the mth Fourier
coefÔ¨Åcient of Fj,R is 3
Fj,R(m) = R‚àín 1f j(m/R) and that of GR is 2
GR(m) = R‚àín1g(m/R).
Since b lies in Mp(Rn) we have
‚à•b‚à•Mp(Rn) = sup
R>0
{b(m/R)}m‚ààZn
Mp(Zn)
in view of Theorems 4.3.7 and 4.3.10, which are both applicable in view of the
hypotheses of b.

4.3 Multipliers, Transference, and A. E. Convergence
283
As in the proof of Theorem 4.3.10, for R ‚â•R0 we have
 ‚àë
m‚ààZn
k
‚àë
j=1
b(m/Rt j)1f j(m/R)1g(m/R)Volume
 m
R +[0, 1
R]n
(4.3.27)
=
Rn ‚àë
m‚ààZn
k
‚àë
j=1
b(m/Rt j)3
Fj,R(m)2
GR(m)

‚â§Cp‚à•b‚à•MpRn
k
‚àë
j=1
|Fj,R|

Lp‚Ä≤(Tn)
GR

Lp(Tn)
= Cp‚à•b‚à•Mp

k
‚àë
j=1
| f j|

Lp‚Ä≤(Rn)‚à•g‚à•Lp(Rn) ,
where we applied (4.3.25) in the Ô¨Årst inequality above for the function Œæ ‚Üíb(Œæ/R),
which has the same Mp norm as b.
Since b is bounded and Riemann integrable over any cube in Rn, the functions
b(Œæ/t j)1f j(Œæ) 1gj(Œæ) are Riemann integrable over Rn. Realizing the limit of the partial
sums in (4.3.27) when R ‚Üí‚àûas a Riemann integral, we obtain


Rn
k
‚àë
j=1
b(Œæ/t j) 1f j(Œæ)1g(Œæ)dŒæ
 ‚â§Cp
b

Mp

k
‚àë
j=1
| f j|

Lp‚Ä≤(Rn)‚à•g‚à•Lp(Rn)
and thus we showed that (4.3.25) implies (4.3.26).
We now turn to the converse. Assume that (4.3.26) holds. We will prove (4.3.25)
for trigonometric polynomials and then by density we extend it to all C ‚àûfunctions
on Tn. Expressing 1g in terms of g in (4.3.26) and taking the supremum in (4.3.26)
over all C ‚àû
0 functions g with Lp norm 1 we deduce that


Rn
k
‚àë
j=1
b
Œæ
t j

1f j(Œæ)e2œÄi(¬∑)¬∑Œæ dŒæ

Lp‚Ä≤ ‚â§Cp
b

Mp

k
‚àë
j=1
| f j|

Lp‚Ä≤(Rn) .
(4.3.28)
Let P1,...,Pk and Q be trigonometric polynomials on Tn. Set LŒµ(x) = e‚àíœÄŒµ|x|2.
Since b is regulated at every point in Rn, Lemma 4.3.9 gives
 ‚àë
m‚ààZn
k
‚àë
j=1
1Q(m)b(m/t j) 1Pj(m)

=


Tn

‚àë
m‚ààZn
k
‚àë
j=1
1Pj(m)b(m/t j)e2œÄim¬∑x

Q(x)dx

=
 lim
Œµ‚Üí0Œµ
n
2

Rn

Rn
k
‚àë
j=1

PjLŒµ/p‚Ä≤(Œæ)b(Œæ/t j)e2œÄiŒæ¬∑xdŒæ

Q(x)LŒµ/p(x)dx


284
4 Topics on Fourier Series
‚â§Cp‚à•b‚à•Mp limsup
Œµ‚Üí0

Œµ
n
2

k
‚àë
j=1
PjLŒµ/p‚Ä≤


Lp‚Ä≤(Rn)
QLŒµ/p

Lp(Rn)

= Cp‚à•b‚à•Mp limsup
Œµ‚Üí0

Œµ
n
2p‚Ä≤
 k
‚àë
j=1
Pj


LŒµ/p‚Ä≤

Lp‚Ä≤(Rn)

Œµ
n
2

Rn|Q(x)|pe‚àíŒµœÄ|x|2dx
1
p 
= Cp‚à•b‚à•Mp

k
‚àë
j=1
Pj


Lp‚Ä≤(Rn)
Q

Lp(Tn),
where we used H¬®older‚Äôs inequality and (4.3.28) in the only inequality above and
(4.3.13) in the last equality. Thus we obtain that (4.3.26) implies (4.3.25), and this
completes the equivalence of boundedness of MF
b and NF
b .
We now prove the claimed equivalence for the operators Mb and Nb. We Ô¨Årst
show that if MF
b
is bounded on (C ‚àû(Tn),‚à•¬∑ ‚à•Lp) with bound independent of the
Ô¨Ånite set F, then Mb is bounded on (C ‚àû(Tn),‚à•¬∑‚à•Lp).
For each Œæ ‚ààRn, let AŒæ be the null subset of R+ such that t ‚Üíb(Œæ/t) is contin-
uous on R+ \AŒæ. We Ô¨Åx a function F in C ‚àû(Tn), and we note that for each x ‚ààTn
the function
t ‚ÜíSb,t(F)(x) = ‚àë
m‚ààZn
b(m/t)1F(m)e2œÄim¬∑x
(4.3.29)
is continuous on the set R+ \ 
m‚ààZn Am. We pick a countable dense subset D‚Ä≤ of
R+ \ 
m‚ààZn Am, and we let D = D‚Ä≤ ‚à™
m‚ààZn Am. Then D is a countable set and the
Lebesgue monotone convergence theorem gives that
sup
t‚ààD
|Sb,t(F)|

Lp(Tn) = lim
k‚Üí‚àû
MFk
b (F)

Lp(Tn) ‚â§Cp‚à•b‚à•Mp
F

Lp(Tn) ,
(4.3.30)
where Fk is an increasing sequence of Ô¨Ånite sets whose union is D. Using that the
function in (4.3.29) is continuous on R+ \ D, we conclude that the supremum over
t ‚ààD in (4.3.30) can be replaced by the supremum over t ‚ààZ+ (Exercise 4.3.7).
Assume now that NF
b
is bounded on (C ‚àû
0 (Rn),‚à•¬∑ ‚à•Lp) with bound independent
of the Ô¨Ånite set F. We show that Nb is bounded on (C ‚àû
0 (Rn),‚à•¬∑ ‚à•Lp). Let f be in
C ‚àû
0 (Rn). We have that the map
t ‚ÜíTb,t( f)(x) =

Rn b(Œæ/t) 1f(Œæ)e2œÄiŒæ¬∑x dŒæ = tn

Rn b(Œæ) 1f(tŒæ)e2œÄiŒæ¬∑tx dŒæ
(4.3.31)
is a continuous function on R+ since 1f is continuous. Thus the estimate
sup
t‚ààD
|Tb,t( f)|

Lp(Rn) ‚â§Cp‚à•b‚à•Mp
f

Lp(Rn)
(4.3.32)
for a countable dense subset D of R+ (such as D = Q+) can be easily extended by
replacing the supremum over D by the supremum over R+. And estimate (4.3.32)
for D = Q+ follows from the corresponding estimate on Ô¨Ånite sets via the Lebesgue
monotone convergence theorem.
‚ñ°

4.3 Multipliers, Transference, and A. E. Convergence
285
Remark 4.3.13. Under the hypotheses of Theorem 4.3.12, the following two in-
equalities are also equivalent:
Mb(G)

Lp,‚àû(Tn) ‚â§Cp‚à•b‚à•Mp
G

Lp(Tn) ,
G ‚ààC ‚àû(Tn),
(4.3.33)
Nb(g)

Lp,‚àû(Rn) ‚â§C‚Ä≤
p‚à•b‚à•Mp‚à•g‚à•Lp(Rn) ,
g ‚ààC ‚àû
0 (Rn),
(4.3.34)
with C‚Ä≤
p ‚â§Cp ‚â§C(n, p)C‚Ä≤
p for some other constant C(n, p). Indeed, Exercise 1.4.12
gives that the pair of inequalities (4.3.33) and (4.3.34) is equivalent to the pair of
inequalities
 ‚àë
m‚ààZn
k
‚àë
j=1
1Fj(m)b(m/t j) 1G(m)
 ‚â§Cp‚à•b‚à•Mp
G

Lp(Tn)

k
‚àë
j=1
|Fj|

Lp‚Ä≤,1(Tn) , (4.3.35)


Rn
k
‚àë
j=1
1f j(Œæ)b(Œæ/t j)1g(Œæ)dŒæ
 ‚â§C‚Ä≤
p‚à•b‚à•Mp‚à•g‚à•Lp(Rn)

k
‚àë
j=1
| f j|

Lp‚Ä≤,1(Rn) ,
(4.3.36)
where Lp‚Ä≤,1 is the Lorentz space and f j ‚ààC ‚àû
0 (Rn) and Fj ‚ààC ‚àû(Tn).
Now (4.3.36) follows from (4.3.35) just like (4.3.26) follows from (4.3.25) with
the only exception being that H¬®older‚Äôs inequality for Lp and Lp‚Ä≤ is replaced by
H¬®older‚Äôs inequality for Lp,‚àûand Lp‚Ä≤,1 and we use that ‚à•g‚à•Lp,‚àû‚â§‚à•g‚à•Lp. Conversely,
assuming (4.3.36), in order to prove (4.3.35) it will sufÔ¨Åce to know that
sup
0<Œµ<1
Œµ
n
2q

 k
‚àë
j=1
Pj


LŒµ/q

Lq,1(Rn) ‚â§C(n,q)

k
‚àë
j=1
Pj


Lq,1(Tn) .
(4.3.37)
For this we refer to Exercise 4.3.6.
4.3.5 Applications to Almost Everywhere Convergence
As an application of the preceding results, we relate the almost everywhere conver-
gence of Fourier series of functions on T1 with the almost everywhere convergence
of Fourier integrals of functions on R. In this subsection we show that the following
two results are equivalent:
Theorem 4.3.14. For every 1 < p < ‚àûthere exists a Ô¨Ånite constant Cp such that for
all F ‚ààC ‚àû(T1) we have
 sup
N‚ààZ+ |F ‚àóDN|

Lp ‚â§Cp
F

Lp.
(4.3.38)
Theorem 4.3.15. For every 1 < p < ‚àûthere exists a Ô¨Ånite constant Cp such that for
all f ‚ààC ‚àû
0 (R) we have
C‚àó‚àó( f)

Lp(R) ‚â§Cp‚à•f‚à•Lp(R)
(4.3.39)

286
4 Topics on Fourier Series
where
C‚àó‚àó( f)(x) = sup
R>0


|Œæ|‚â§R
1f(Œæ)e2œÄixŒæ dŒæ

is the Carleson operator.
As a consequence of Theorem 4.3.14, we obtain that for any F ‚ààLp(T1), we have
lim
N‚Üí‚àû‚àë
|m|‚â§N
1F(m)e2œÄimx = F(x)
for almost every x ‚àà[0,1].
Theorem 4.3.14 can be proved directly, but we do not pursue this here. Instead,
we show the equivalence of the two theorems and refer the interested reader to [131],
which contains the proof of Theorem 4.3.15.
We observe that both operators F ‚ÜíC‚àó(F) = supN>0 |F ‚àóDN| and f ‚ÜíC‚àó‚àó( f)
are sublinear and take nonnegative values. Thus they satisfy the inequalities
|C‚àó(F)‚àíC‚àó(G)| ‚â§C‚àó(F ‚àíG)
|C‚àó‚àó( f)‚àíC‚àó‚àó(g)| ‚â§C‚àó‚àó( f ‚àíg)
for all F,G in C ‚àû(T1) and f,g in C ‚àû
0 (R). Then, by density (see the argument in
the proof of Theorem 1.4.19 or Exercise 1.4.17), they admit bounded extensions to
Lp(T1) and Lp(R), respectively, so that (4.3.38) and (4.3.39) hold for all F ‚ààLp(T1)
and f ‚ààLp(R).
Next, we discuss the details of the transference argument that claims the equiva-
lence of Theorems 4.3.14 and 4.3.15.
Consider the following function deÔ¨Åned on R:
b(x) =
‚éß
‚é™
‚é®
‚é™
‚é©
1
when |x| < 1,
1/2
when |x| = 1,
0
when |x| > 1.
(4.3.40)
Then b is bounded and Riemann integrable over any interval, and is easily seen to
be regulated; also, given any x ‚ààR, the function t ‚Üíb(x/t) is discontinuous only
for t ‚àà{x,‚àíx}.
Let Sb,R be as in (4.3.19), where b is deÔ¨Åned in (4.3.40). We note that inequality
(4.3.38) is equivalent to
sup
R>0
|Sb,R(F)|

Lp ‚â§C‚Ä≤
p
F

Lp
(4.3.41)
for all F ‚ààC ‚àû(T1), where {DR}R>0 is the family of Dirichlet kernels as deÔ¨Åned in
(3.1.16), depending on the continuous parameter R. Indeed, we have

4.3 Multipliers, Transference, and A. E. Convergence
287
Sb,R(F)(x) =
‚éß
‚é™
‚é™
‚é®
‚é™
‚é™
‚é©
‚àë|m|‚â§[R] 1F(m)e2œÄimx
if R /‚ààZ+,
(DR‚àí1 ‚àóF)(x)+
1F(R)e2œÄixR+ 1F(‚àíR)e‚àí2œÄixR
2
if R ‚ààZ+.
(4.3.42)
Since supR>0 |1F(¬±R)| ‚â§‚à•F‚à•L1 ‚â§‚à•F‚à•Lp, it follows that if (4.3.38) holds, then
(4.3.41) also holds with C‚Ä≤
p = Cp +1.
The only hypothesis of Theorem 4.3.12 missing is that b lies in Mp(R). We
obtain this from the fact that supR>0 ‚à•b(¬∑/R)‚à•Mp(Z) < ‚àûvia Theorem 4.3.10, since
sup
R>0
F ‚àóDR

Lp(T1) = sup
N‚ààZ+
F ‚àóDN

Lp(T1) ‚â§C‚Ä≤‚Ä≤
p
F‚à•Lp(T1) ,
(4.3.43)
where the last estimate follows from Proposition 4.1.6, Theorem 4.1.7, and Corollary
4.1.3. The preceding equality is due to the fact that DR = DR+Œµ whenever 0 < Œµ < 1.
Now all hypotheses of Theorem 4.3.12 are valid. As a consequence we obtain the
equivalence of the boundedness of the the maximal operator
Nb( f)(x) = C‚àó‚àó( f)(x) = sup
R>0

 +R
‚àíR
1f(Œæ)e2œÄixŒæ dŒæ

on Lp(R) and of
Mb(F)(x) = sup
R>0
 ‚àë
m‚ààZ
1F(m)e2œÄimxb
m
R
 = sup
R>0
|Sb,R(F)(x)|,
on Lp(T1). But in view of (4.3.42) and of the fact that supR>0 |1F(¬±R)| ‚â§‚à•F‚à•Lp, the
Lp boundedness of Mb is equivalent to the Lp boundedness of C‚àóon Lp(T1). This
discussion concludes the equivalence of Theorems 4.3.14 and 4.3.15.
4.3.6 Almost Everywhere Convergence of Square Dirichlet Means
The extension of Theorem 4.3.14 to higher dimensions is a rather straightforward
consequence of the one-dimensional result.
Theorem 4.3.16. For every 1 < p < ‚àû, there exists a Ô¨Ånite constant Cp,n such that
for all f ‚ààLp(Tn) we have
 sup
N>0
|Dn
N ‚àóf|

Lp(Tn) ‚â§Cp,n
f

Lp(Tn)
(4.3.44)
and consequently
lim
N‚Üí‚àû‚àë
m‚ààZn
|mj|‚â§N
1f(m)e2œÄim¬∑x = f(x)
for almost every x ‚ààTn and f ‚ààLp(Tn).

288
4 Topics on Fourier Series
Proof. We prove Theorem 4.3.16 when n = 2. Fix a p with 1 < p < ‚àû. Since the
Riesz projection P+ is bounded on Lp(T1) (Theorem 4.1.7 and identity (4.1.9)), ap-
plying Theorem 4.3.10 with b(Œæ) = œá(0,‚àû), we obtain that that the function œá(0,‚àû)
is in Mp(R). It follows that the characteristic function of the half-space Œæ1 > 0 in
R2 lies in Mp(R2). Since rotations and translations of multipliers preserve their
Mp norms (Proposition 2.5.14), it follows that the characteristic function of any half
space created by a line in R2 lies in Mp(R2) with a Ô¨Åxed norm. The product of three
multipliers is a multiplier (Proposition 2.5.13); thus the characteristic function of the
triangle T created by the lines Œæ2 = Œæ1 ‚àí1
4, Œæ2 = ‚àíŒæ1 ‚àí1
4, Œæ2 = L + 1
4 lies also in
Mp(R2) with norm independent of L ‚ààZ+. The regulated function
œÉ(Œæ1,Œæ2) =
‚éß
‚é™
‚é™
‚é™
‚é™
‚é™
‚é™
‚é®
‚é™
‚é™
‚é™
‚é™
‚é™
‚é™
‚é©
1
if (Œæ1,Œæ2) ‚ààT \‚àÇT
0
if (Œæ1,Œæ2) /‚ààT
1
2
if (Œæ1,Œæ2) ‚àà‚àÇT \{(0,‚àí1
4),(L+ 1
2,L+ 1
4),(‚àíL‚àí1
2,L+ 1
4)}
1
8
if (Œæ1,Œæ2) ‚àà{(L+ 1
2,L+ 1
4),(‚àíL‚àí1
2,L+ 1
4)}
1
4
if (Œæ1,Œæ2) = (0,‚àí1
4)
is a.e. equal to the characteristic function of T. Thus Theorem 4.3.7 gives that the
restriction of œÉ on Z2, i.e., the sequence {am1,m2}m1,m2 deÔ¨Åned by am1,m2 = 1 when
|m1| ‚â§|m2| ‚â§L and zero otherwise, lies in Mp(Z2) with norm independent of L in
Z+. This means that for some constant Bp we have the following inequality for all f
in Lp(T2):

T2
 ‚àë
m2‚ààZ
|m2|‚â§L
‚àë
m1‚ààZ
|m1|‚â§|m2|
1f(m1,m2)e2œÄi(m1x1+m2x2)

p
dx2 dx1 ‚â§Bp
p
f
p
Lp(T2) ,
(4.3.45)
where Bp is independent of L ‚ààZ+. There is also a a version of (4.3.45), proved
similarly, in which |m1| ‚â§|m2| is replaced by the strict inequality |m1| < |m2|.
Now let 1 < p < ‚àû, L ‚ààZ+, and f ‚ààLp(T2). For Ô¨Åxed x1 ‚ààT1 deÔ¨Åne
f L
x1(x2) = ‚àë
m2‚ààZ
|m2|‚â§L

‚àë
m1‚ààZ
|m1|‚â§|m2|
1f(m1,m2)e2œÄim1x1

e2œÄim2x2 = ‚àë
m2‚ààZ
|m2|‚â§L
2
f Lx1(m2)e2œÄim2x2
and for Ô¨Åxed x2 ‚ààT1 deÔ¨Åne
f x2
L (x1) = ‚àë
m1‚ààZ
|m1|‚â§L

‚àë
m2‚ààZ
|m2|<|m1|
1f(m1,m2)e2œÄim2x2

e2œÄim1x1 = ‚àë
m1‚ààZ
|m1|‚â§L
2
f x2
L (m1)e2œÄim1x1 .

4.3 Multipliers, Transference, and A. E. Convergence
289
We have

T1

T1 sup
0<N‚â§L
 ‚àë
|m1|‚â§N ‚àë
|m2|‚â§N
1f(m1,m2)e2œÄim1x1e2œÄim2x2

p
dx2 dx1
‚â§2p‚àí1

T1

T1 sup
0<N‚â§L
 ‚àë
|m2|‚â§N

‚àë
|m1|‚â§|m2|
1f(m1,m2)e2œÄim1x1

e2œÄim2x2

p
+ sup
0<N‚â§L
 ‚àë
|m1|‚â§N

‚àë
|m2|<|m1|
1f(m1,m2)e2œÄim2x2

e2œÄim1x1

p
dx1 dx2
= 2p‚àí1

T1

T1 sup
0<N‚â§L
(DN ‚àóf L
x1)(x2)
p dx2 dx1
+

T1

T1 sup
0<N‚â§L
(DN ‚àóf x2
L )(x1)
p dx1 dx2

‚â§2p‚àí1

T1

T1 sup
N‚ààZ+
(DN ‚àóf L
x1)(x2)
p dx2dx1
+

T1

T1 sup
N‚ààZ+
(DN ‚àóf x2
L )(x1)
p dx1 dx2

‚â§2p‚àí1Cp
p

T1

T1 | f L
x1(x2)|p dx2 dx1 +2p‚àí1Cp
p

T1

T1 | f x2
L (x1)|p dx1 dx2
‚â§2pCp
pBp
p
 f
p
Lp(T2),
where we used Theorem 4.3.14 in the penultimate inequality and estimate (4.3.45)
in the last inequality. Since the last estimate we obtained is independent of L ‚ààZ+,
letting L ‚Üí‚àûand applying Fatou‚Äôs lemma, we obtain the conclusion (4.3.44) for
n = 2. When n ‚â•3 the idea of the proof is similar, but the notation a bit more
cumbersome.
‚ñ°
Exercises
4.3.1. Let Œ± ‚â•0. Prove that the function (1‚àí|Œæ|2)Œ±
+ is in Mp(Rn) if and only if the
function (1‚àí|Œæ|)Œ±
+ is in Mp(Rn).

Hint: Use that smooth functions with compact support lie in Mp(Rn).

4.3.2. The purpose of this exercise is to introduce distributions on the torus. The
set of test functions on the torus is C ‚àû(Tn) equipped with the following topology.
Given f j, f in C ‚àû(Tn), we say that f j ‚Üíf in C ‚àû(Tn) if
‚àÇŒ± f j ‚àí‚àÇŒ± f

L‚àû(Tn) ‚Üí0
as j ‚Üí‚àû, ‚àÄŒ±.
Under this notion of convergence, C ‚àû(Tn) is a topological vector space with topol-
ogy induced by the family of seminorms œÅŒ±(œï) = supx‚ààTn |(‚àÇŒ± f)(x)|, where Œ±

290
4 Topics on Fourier Series
ranges over all multi-indices. The dual space of C ‚àû(Tn) under this topology is the
set of all distributions on Tn and is denoted by D‚Ä≤(Tn). The deÔ¨Ånition implies that
for uj and u in D‚Ä≤(Tn) we have uj ‚Üíu in D‚Ä≤(Tn) if and only if
4
uj, f
5
‚Üí
4
u, f
5
as j ‚Üí‚àûfor all f ‚ààC ‚àû(Tn).
The following operations can be deÔ¨Åned on elements of D‚Ä≤(Tn): differentiation (as
in DeÔ¨Ånition 2.3.6), translation and reÔ¨Çection (as in DeÔ¨Ånition 2.3.11), convolution
with a C ‚àûfunction (as in DeÔ¨Ånition 2.3.13), multiplication by a C ‚àûfunction (as
in DeÔ¨Ånition 2.3.15), the support of a distribution (as in DeÔ¨Ånition 2.3.16). Use the
same ideas as in Rn to prove the following:
(a) Prove that if u ‚ààD‚Ä≤(Tn) and f ‚ààC ‚àû(Tn), then ( f ‚àóu)(x) = ‚ü®u,œÑx( #f )‚ü©is a C ‚àû
function.
(b) In contrast to Rn, the convolution of two distributions on Tn can be deÔ¨Åned. For
u,v ‚ààD‚Ä≤(Tn) and f ‚ààC ‚àû(Tn) deÔ¨Åne
4
u‚àóv, f
5
=
4
u, f ‚àó#v
5
.
Check that convolution of distributions on D‚Ä≤(Tn) is associative, commutative, and
distributive.
(c) Prove the analogue of Proposition 2.3.23, i.e., that C ‚àû(Tn) is dense in D‚Ä≤(Tn).
4.3.3. For u ‚ààD‚Ä≤(Tn) and m ‚ààZn deÔ¨Åne the Fourier coefÔ¨Åcient 1u(m) by
1u(m) = u(e‚àí2œÄim¬∑(¬∑)) =
4
u,e‚àí2œÄim¬∑(¬∑)5
.
Prove properties (1), (2), (4), (5), (6), (8), (9), (11), and (12) of Proposition 2.3.22
regarding the Fourier coefÔ¨Åcients of distributions on the circle. Moreover, prove that
for any u, v in D‚Ä≤(Tn) we have (u ‚àóv)1(m) = 1u(m)1v(m). In particular, this is valid
for Ô¨Ånite Borel measures.
4.3.4. Let Œº be a Ô¨Ånite Borel measure on Rn and let ŒΩ be the periodization of Œº,
that is, ŒΩ is a measure on Tn deÔ¨Åned by
ŒΩ(A) = ‚àë
m‚ààZn
Œº(A+m)
for all measurable subsets A of Tn. Prove that the restriction of the Fourier transform
of Œº on Zn coincides with the sequence of the Fourier coefÔ¨Åcients of the measure ŒΩ.
4.3.5. Let vn be the volume of the unit ball in Rn and e1 = (1,0,...,0). Prove that
lim
Œµ‚Üí0
1
vnŒµn

|x‚àíe1|‚â§Œµ œá|x|‚â§1 dx = 1
2 .

4.3 Multipliers, Transference, and A. E. Convergence
291
Conclude that the function
#œáB(0,1)(x) =
‚éß
‚é™
‚é®
‚é™
‚é©
1
when |x| < 1,
1/2
when |x| = 1,
0
when |x| > 1
is regulated.
4.3.6. Let LŒµ(x) = e‚àíœÄŒµ|x|2 be deÔ¨Åned for Œµ > 0 and x ‚ààRn and let 1 < q < ‚àû.
Prove that there is a constant C(n,q) < ‚àûsuch that for any 1-periodic continuous
function g on Rn we have
sup
0<Œµ<1
Œµ
n
2q gLŒµ/q

Lq,1(Rn) ‚â§C(n,q)‚à•g‚à•Lq,1(Tn) .

Hint: Reduce matters to the situation where g = ‚àëk‚ààZn œák+E, where E is a measur-
able subset of [‚àí1/2,1/2)n. Express the Lq,1 norm of gLŒµ/q in terms of its distribu-
tion function and for 0 < Œª < 1 estimate the measure
{LŒµ/q > Œª}
 
k‚ààZn
(k +E)
=
B

0,
 q
œÄŒµ log 1
Œª
 1
2  
k‚ààZn
(k +E)

by Cn
‚àön+
 q
œÄŒµ log 1
Œª
1/2)n |E|.

4.3.7. Let 0 < C0 < ‚àû. Suppose that {ft}t‚ààR+ is a family of measurable functions
on a measure space X that satisÔ¨Åes
sup
t‚ààF
| ft|

Lp ‚â§C0
for every Ô¨Ånite subset F of R+.
(a) Suppose that for each x ‚ààX, the function t ‚Üíft(x) is continuous. Show that
sup
t>0
| ft|

Lp ‚â§C0 .
(b) Prove that for any t > 0 there is a measurable function #ft on X that is a.e. equal
to ft such that
 sup
t‚ààR+ | #ft|

Lp ‚â§C0 .

Hint: Part (a): Notice that in view of the Lebesgue monotone convergence theo-
rem, we have
supt‚ààQ | ft|

Lp ‚â§C0. Also, for each x ‚ààX we have supt‚ààQ | ft(x)| =
supt‚ààR+ | ft(x)| by continuity. Part (b): Let a = supF ‚à•supt‚ààF | ft|‚à•Lp ‚â§C0, where the
supremum is taken over all Ô¨Ånite subsets F of R. Pick an increasing sequence of
Ô¨Ånite sets Fn such that ‚à•supt‚ààFn | ft|‚à•Lp ‚Üía as n ‚Üí‚àû. Let g = supn supt‚ààFn | ft| and
note that ‚à•g‚à•Lp = a. Then for any s ‚ààR we have

292
4 Topics on Fourier Series
max(| fs|,sup
t‚ààFk
| ft|)

Lp ‚â§a.
This implies ‚à•max(| fs|,g)‚à•Lp ‚â§a = ‚à•g‚à•Lp, so that | fs| ‚â§g a.e. for all s ‚ààR.

4.3.8. (E. Prestini) Show that for f ‚ààL2(T2) we have that
‚àë
|m1|‚â§N
|m2|‚â§N2
1f(m1,m2)e2œÄi(m1x1+m2x2) ‚Üíf(x1,x2)
for almost all (x1,x2) in T2.

Hint: Use the splitting 1f(m1,m2) = 1f(m1,m2)œá|m2|‚â§|m1|2 + 1f(m1,m2)œá|m2|>|m1|2
and apply the idea of the proof of Theorem 4.3.16.

4.4 Applications to Geometry and Partial Differential Equations
In this section we discuss two applications of Fourier series. The Ô¨Årst concerns a
classical result in planar geometry and the other the heat equation.
4.4.1 The Isoperimetric Inequality
Suppose we are given a closed positively oriented nonself intersecting C 1 curve C
in the (x,y) plane of length L that encloses a region R of area A. The curve can be
described in terms of its parametric equations x = x(t) and y = y(t), where t ‚àà[0,1].
Since the curve is closed, we have (x(0),y(0)) = (x(1),y(1)) and the C 1 functions
x(t),y(t) can be thought of as 1-periodic functions on the circle. The perimeter L of
the curve is given by the equation
L =
 1
0
!
|x‚Ä≤(t)|2 +|y‚Ä≤(t)|2 dt
while the area of the region R enclosed by the curve is equal to
A =

R 1dxdy
=

R
‚àÇ
‚àÇx
x
2 ‚àí‚àÇ
‚àÇy

‚àíy
2

dxdy
=1
2
<
C xdy‚àíydx
=1
2
 1
0 x(t)y‚Ä≤(t)‚àíx‚Ä≤(t)y(t)dt ,
where we made use of Green‚Äôs theorem in the third equality above.

4.4 Applications to Geometry and Partial Differential Equations
293
A C 1 curve Œ≥(t) is regular if Œ≥‚Ä≤(t) Ã∏= 0 for all t. We have the following result
relating the perimeter and the enclosed area of a region enclosed by a closed C 1
curve.
Theorem 4.4.1. Given a closed, positively oriented, nonself intersecting, regular,
C 1 planar curve of length L that encloses a region of area A, we have that
A ‚â§L2/4œÄ
(4.4.1)
with equality holding if and only if the curve is a circle.
Proof. Assume that the curve has parametric equations x = x(t), y = y(t), 0 ‚â§t ‚â§1.
We may assume that the curve has constant speed, i.e., it satisÔ¨Åes
!
|x‚Ä≤(t)|2 +|y‚Ä≤(t)|2 = L
for all t ‚àà[0,1]. This is achieved via the reparametrization of the curve in terms of
the inverse function s‚àí1(t) = Œ≥(t) of the normalized arc length function
s(t) = 1
L
 t
0
!
|x‚Ä≤(u)|2 +|y‚Ä≤(u)|2 du.
Since |(x‚Ä≤(t),y‚Ä≤(t))| Ã∏= 0, t ‚Üís(t) is a one-to-one and onto continuous map from
[0,1] to [0,1]. Then the curve t ‚Üí(x(Œ≥(t)),y(Œ≥(t))) has constant speed, since
|x‚Ä≤(Œ≥(t))|2|Œ≥‚Ä≤(t)|2 +|y‚Ä≤(Œ≥(t))|2|Œ≥‚Ä≤(t)|2 = |x‚Ä≤(s‚àí1(t))|2 +|y‚Ä≤(s‚àí1(t))|2
|s‚Ä≤(s‚àí1(t))|2
= L2 .
So we can replace the map (x(t),y(t)) by (x(Œ≥(t)),y(Œ≥(t))) which produces the same
curve. Let
f(t) = x(t)+iy(t)
for t ‚àà[0,1]. Then in view of the preceding discussion, we may assume that the
function f(t) = x(t)+iy(t) satisÔ¨Åes | f ‚Ä≤(t)| = L for all t ‚àà[0,1].
Under the assumption | f ‚Ä≤(t)| = L for all t ‚àà[0,1], we now show that (4.4.1) holds,
with equality if and only if f(t) = c0e2œÄit +C0 for some c0,C0 ‚ààC with |c0| = L
2œÄ .
To prove this claim we argue as follows:
A = 1
2 Im
 1
0 f ‚Ä≤(t) f(t)dt
= 1
2 Im
 1
0 f ‚Ä≤(t)

f(t)‚àí1f(0)

dt
‚â§1
2 L
 f ‚àí1f(0)

L2
‚â§L
2
1
2œÄ
 f ‚Ä≤
L2
= L2
4œÄ ,

294
4 Topics on Fourier Series
establishing (4.4.1), but we need to explain why the inequality
‚à•f ‚àí1f(0)‚à•L2 ‚â§1
2œÄ ‚à•f ‚Ä≤‚à•L2
(4.4.2)
is valid. Indeed, we have
f ‚Ä≤(t) = ‚àë
m‚ààZ
2œÄim 1f(m)e2œÄimt
where the series converges in L2. Thus we have
f ‚Ä≤
L2 = 2œÄ

‚àë
m‚ààZ
|m 1f(m)|2
 1
2
‚â•2œÄ

‚àë
m‚ààZ\{0}
| 1f(m)|2
 1
2
= 2œÄ
f‚àí1f(0)

L2 , (4.4.3)
which proves (4.4.2).
Now suppose that equality holds in (4.4.1), then we must have equality in (4.4.2)
and thus in (4.4.3), which implies that 1f(m) = 0 when |m| ‚â•2; hence for all t ‚àà[0,1]
we must have
f(t) = ce2œÄit +c‚Ä≤e‚àí2œÄit + 1f(0)
(4.4.4)
where c,c‚Ä≤ are complex numbers. But since ‚à•f ‚Ä≤‚à•L2 = L, it follows that
4œÄ2(|c|2 +|c‚Ä≤|2) = L2 ,
(4.4.5)
and since | f ‚Ä≤(t)| = L for all t ‚àà[0,1], it follows that
 L
2œÄ
2
= |c|2 +|c‚Ä≤|2 ‚àí2Re

cc‚Ä≤e2œÄi2t
(4.4.6)
for all t ‚àà[0,1]. Combining (4.4.5) and (4.4.6) we obtain
Re

cc‚Ä≤e2œÄi2t
= 0.
(4.4.7)
Inserting t = 0 and t = 1/8 in (4.4.7) and using that Im(iz) = ‚àíRez, we deduce that
Recc‚Ä≤ = Imcc‚Ä≤ = 0. This implies that either c or c‚Ä≤ is zero. In either case (4.4.4) and
(4.4.5) imply that f(t) is a circle of radius L/2œÄ centered at the point 1f(0).
‚ñ°
4.4.2 The Heat Equation with Periodic Boundary Condition
Let k > 0 be a Ô¨Åxed quantity. Consider the partial differential equation
‚àÇ
‚àÇt F(x,t) = k
n
‚àë
j=1
‚àÇ2
‚àÇx2
j
F(x,t)
t ‚àà(0,‚àû),
x ‚ààRn ,
(4.4.8)

4.4 Applications to Geometry and Partial Differential Equations
295
which is called the heat equation. Assume that there is an initial condition
F(0,x) = f(x)
x ‚ààRn
(4.4.9)
for a given C ‚àûfunction f on Rn which is assumed to be 1-periodic in every variable.
We would like to Ô¨Ånd a continuous function F(t,x) on [0,‚àû) √ó Rn which is C ‚àû
on (0,‚àû)√óRn such that
F(t,x+ej) = F(t,x)
for all t ‚â•0 and all ej = (0,...,0,1,0,...,0), so that F solves the equation (4.4.8).
The function F(t,x) represents the temperature of a body at time t > 0 at the
location (x1,...,xn). Since the initial temperature f is 1-periodic in each variable,
we expect F(t,¬∑) to also be periodic in each variable. For example, F(t,x) is a good
model for the temperature of the torus {(e2œÄix1,...,e2œÄixn) : xj ‚ààR} at time t > 0,
given that its temperature at time t = 0 is f(x). When n = 1, F(t,x) models the
temperature of a inÔ¨Ånitesimally thin ring, thought of as the unit circle, at time t > 0
at the location e2œÄix.
Let us suppose there is a continuous function F(t,x) on [0,‚àû)√óRn which is C ‚àû
on (0,‚àû) √ó Rn that solves the equation (4.4.8) and satisÔ¨Åes F(t,x + ej) = F(t,x)
for all x ‚ààRn and t ‚â•0. Denote by cm(t) the Fourier coefÔ¨Åcient of the function
x ‚ÜíF(t,x) deÔ¨Åned by
cm(t) =

Tn F(t,x)e‚àí2œÄim¬∑x dx.
Then cm(t) is a continuous function on [0,‚àû) since F is continuous in the variable
t. For the same reason, cm is a smooth function on (0,‚àû) whose jth derivative is
given by
d j
dt j cm(t) =

Tn
‚àÇj
‚àÇt j F(t,x)e‚àí2œÄim¬∑x dx
for any j = 1,2,.... Using equation (4.4.8) we obtain that
c‚Ä≤
m(t) =

Tn
‚àÇ
‚àÇt F(t,x)e‚àí2œÄim¬∑x dx =

Tn k ‚àÇ2
‚àÇ2xF(t,x)e‚àí2œÄim¬∑x dx = ‚àí4œÄ2|m|2kcm(t),
where the last identity is due to an integration by parts in which the boundary terms
cancel each other in view of the periodicity of the integrand in x. Also cm(0) = 1f(m).
The ordinary differential equation c‚Ä≤
m(t) = ‚àí4œÄ2|m|2kcm(t) with initial condition
cm(0) = 1f(m) is easily solved by separating the variables
dcm(t)
cm(t) = ‚àí4œÄ2|m|2kdt ,
(4.4.10)
yielding the solution
cm(t) = 1f(m)e‚àí4œÄ2|m|2kt .

296
4 Topics on Fourier Series
We may therefore deÔ¨Åne the function
F(t,x) = ‚àë
m‚ààZn
1f(m)e‚àí4œÄ2|m|2kte2œÄim¬∑x
(4.4.11)
on [0,‚àû)√óRn and observe the following:
(a) F is continuous on [0,‚àû)√óRn and C ‚àûon (0,‚àû)√óRn.
(b) F satisÔ¨Åes the heat equation (4.4.8) and the initial condition (4.4.9).
(c) F is 1-periodic in each of the last n variables.
These statements can be easily proved by passing the differentiation inside the
sum, in view of the rapid convergence of the series in (4.4.11) due to the fact that
the periodic function f is C ‚àû(Rn). Furthermore, F is unique with properties (a),
(b), and (c), since any other function G(x,t) with these properties is derived in the
preceding way, and so it has to be equal to F(x,t).
DeÔ¨Ånition 4.4.2. DeÔ¨Åne the heat kernel
Ht(x) = ‚àë
m‚ààZn
e‚àí4œÄ2|m|2kte2œÄim¬∑x
for t > 0. Notice that the series deÔ¨Åning Ht is absolutely convergent for any t > 0.
The importance of the heat kernel lies in the fact that one can express the solution
F(x,t) of (4.4.8) in terms of the convolution F(x,t) = ( f ‚àóHt)(x).
We summarize these facts in the following proposition.
Proposition 4.4.3. Let k > 0 be Ô¨Åxed and let f be in C ‚àû(Rn). Assume that f is
1-periodic function in each variable. Then the heat equation
‚àÇ
‚àÇt F(x,t) = kŒîxF(x,t)
t ‚àà(0,‚àû),
x ‚ààRn
(4.4.12)
under the initial condition
F(0,x) = f(x)
x ‚ààRn
(4.4.13)
has a unique solution which is continuous on [0,‚àû) √ó Rn and C ‚àûon (0,‚àû) √ó Rn
given by
F(x,t) = ( f ‚àóHt)(x) = ‚àë
m‚ààZn
1f(m)e‚àí4œÄ2|m|2kte2œÄim¬∑x .
(4.4.14)
Proof. Since f is C ‚àû, the series in (4.4.14) is rapidly convergent in m and thus it
gives a continuous function on [0,‚àû)√óRn. Moreover, the series can be differentiated
term by term in the variable t > 0, and thus it produces a C ‚àûfunction on (0,‚àû)√óRn.
By Fourier inversion (Proposition 3.2.5), F satisÔ¨Åes the initial condition (4.4.13).
Finally, to verify (4.4.12), we simply notice that

4.4 Applications to Geometry and Partial Differential Equations
297
‚àÇ
‚àÇt F(x,t) = ‚àë
m‚ààZn
‚àÇ
‚àÇt
1f(m)e‚àí4œÄ2|m|2kte2œÄim¬∑x
= ‚àí4œÄ2k ‚àë
m‚ààZn
1f(m)e‚àí4œÄ2|m|2kt|m|2e2œÄim¬∑x
= k ‚àë
m‚ààZn
1f(m)e‚àí4œÄ2|m|2kt ‚àÇ2
‚àÇ2x1
+¬∑¬∑¬∑+ ‚àÇ2
‚àÇ2xn

e2œÄim¬∑x
= k
 ‚àÇ2
‚àÇ2x1
+¬∑¬∑¬∑+ ‚àÇ2
‚àÇ2xn

‚àë
m‚ààZn
1f(m)e‚àí4œÄ2|m|2kte2œÄim¬∑x
= k ‚àÇ2
‚àÇ2xF(x,t),
where the rapid convergence of the series in m makes it possible to pass the differ-
entiations in and out of the sum. Finally, to show uniqueness, assume that there is
another solution G(t,x), continuous on [0,‚àû)√óRn and C ‚àûon (0,‚àû)√óRn, that can
be expanded in Fourier series as follows:
G(t,x) = ‚àë
m‚ààZn
cm(t)e2œÄim¬∑x .
Conditions (4.4.12) and the rapid decay of the coefÔ¨Åcients cm(t) yield the ordinary
differential equation (4.4.10) with initial condition cm(0) = 1f(m), which has the
solution cm(t) = 1f(m)e‚àí4œÄ2|m|2kt. Thus G = F on [0,‚àû)√óRn.
‚ñ°
It is important to observe that the family {Ht}t>0 is an approximate identity on
T1. Indeed, the Poisson summation formula (Theorem 3.2.8) and the fact that the
inverse Fourier transform of e‚àí4œÄ2kt|Œæ|2 is e‚àí|x|2/4kt/(2
‚àö
œÄkt)n [Example 2.2.9 and
Proposition 2.2.11 (8)] yield that for all x ‚àà[0,1]n we have
Ht(x) =
1
(2
‚àö
œÄkt)n ‚àë
‚Ñì‚ààZ
e‚àí|x+‚Ñì|2
4kt .
This identity implies that Ht(x) ‚â•0 for all t > 0 and that

Tn Ht(x)dx =

Rn
1
(2
‚àö
œÄkt)n e‚àí|x|2
4kt dx =

Rn e‚àíœÄ|x|2 dx = 1
for all t > 0 and that

Œ¥‚â§|u| Ht(u)du ‚â§

|x|‚â•Œ¥
1
(2
‚àö
œÄkt)n e‚àí|x|2
4kt dx =

|x|‚â•
Œ¥
2
‚àö
kœÄt
e‚àíœÄ|x|2 dx
which tends to zero as t ‚Üí0 for any Œ¥ > 0 in view of the Lebesgue differentiation
theorem. Thus properties (i), (ii), and (iii) of approximate identities hold.
As a consequence, we have that ‚à•F(t,¬∑) ‚àíf‚à•Lp(Tn) ‚Üí0 as t ‚Üí0 for 1 ‚â§p < ‚àû
and F(t,¬∑) converges to f uniformly on Tn; see Theorem 1.2.19.

298
4 Topics on Fourier Series
Exercises
4.4.1. Let f,F be as in Proposition 4.4.3. Prove that the total heat on the torus
remains constant in time by showing that for all t ‚â•0 we have

Tn F(t,x)dx =

Tn f(x)dx.
Moreover, show that the temperature at any Ô¨Åxed point x ‚ààTn on the torus tends to
the average initial temperature, i.e., it satisÔ¨Åes
lim
t‚Üí‚àûF(t,x) =

Tn f(y)dy.
4.4.2. Derive the following property of the heat kernel,
Ht ‚àóHs = Ht+s
for all t,s > 0.
4.4.3. Consider the heat equation on [0,‚àû)√óR
‚àÇ
‚àÇt u(x,t) = ‚àÇ2
‚àÇx2 u(x,t)
without a boundary condition. Show that u = 2t +x2 and u(t,x) = e‚àíq2teiqx, as well
as constant functions, are solutions of this equation. Prove that the set of solutions
is a vector space over the Ô¨Åeld of complex numbers C.
4.4.4. Suppose that a square-integrable function g(x) on Rn is supported in a cube
[‚àíA,A]n for some A > 0. Then we have the following representation:
g(x) = ‚àë
m‚ààZn

1
(2A)n

Rn g(y)e‚àí2œÄi m¬∑y
2A dy

e2œÄi x¬∑m
2A œá[‚àíA,A]n ,
where the series converges in L2
4.4.5. This exercise provides an application of Fourier series in complex analysis.
Let z ‚ààC\Z. Consider the function hz(x) = cos(2œÄzx) deÔ¨Åned on [‚àí1
2, 1
2] extended
periodically on the entire line [notice hz(‚àí1
2) = hz( 1
2)].
(a) Compute the Fourier coefÔ¨Åcients of hz.
(b) Obtain a Fourier series expansion of hz noticing that it is a Lipschitz function.
(c) Plug in x = 1/2 to prove that
cot(œÄz) = 1
œÄz + 1
œÄ
‚àû
‚àë
m=1
2z
z2 ‚àím2 .

4.5 Applications to Number theory and Ergodic theory
299
4.5 Applications to Number theory and Ergodic theory
In this section we discuss three applications of Fourier series techniques to number
theory and ergodic theory.
4.5.1 Evaluation of the Riemann Zeta Function at even Natural
numbers
DeÔ¨Ånition 4.5.1. We deÔ¨Åne the Bernoulli polynomials {Bk}‚àû
k=0 on [0,1] recursively
as follows:
B0(x) = 1
B‚Ä≤
k(x) = kBk‚àí1(x)
for k = 1,2,..., and
 1
0 Bk(x)dx = 0.
In view of this deÔ¨Ånition we Ô¨Ånd the Ô¨Årst few polynomials B1(x) = x ‚àí1
2, B2(x) =
x2 ‚àíx+ 1
6, B3(x) = x3 ‚àí3
2x2 + 1
2x, etc. Unlike orthogonal polynomials, the Bernoulli
polynomials have the remarkable property that their number of zeros in the unit
interval does not increase as the degree of the polynomials increases; in fact all
Bernoulli polynomials have at most three zeros in [0,1].
Notice that for k ‚â•2 we have
Bk(1)‚àíBk(0) =
 1
0 B‚Ä≤
k(x)dx = k
 1
0 Bk‚àí1(x)dx = 0,
thus we may think of these polynomials as functions on the circle T1. We extend the
Bernoulli polynomials to the whole line periodically by setting Bk(x+l) = Bk(x) for
x ‚àà[0,1]. We now compute the Fourier coefÔ¨Åcients of Bk. We have
2
B1(m) =
 1
0 (t ‚àí1
2)e‚àí2œÄimt dt =

0
if m = 0
‚àí
1
2œÄim
if m Ã∏= 0.
Therefore, using Corollary 3.4.10, we can write
B1(x) = ‚àë
mÃ∏=0
‚àí
1
2œÄime2œÄimx
where the series converges at every x ‚àà(0,1).
We have the following result concerning the Fourier expansion of the Bernoulli
polynomials.

300
4 Topics on Fourier Series
Theorem 4.5.2. For each k ‚â•2 we have
Bk(x) = ‚àík! ‚àë
m‚ààZ\{0}
1
(2œÄim)k e2œÄimx ,
(4.5.1)
where the series converges absolutely and uniformly on [0,1]. When k = 1 we have
B1(x) = ‚àí‚àë
m‚ààZ\{0}
1
2œÄime2œÄimx
(4.5.2)
for all x ‚àà(0,1) and the series converges conditionally.
Proof. We have already proved (4.5.2) and we focus attention to the case k ‚â•2. As
a consequence of B‚Ä≤
k = kBk‚àí1 we obtain
Bk(x) = k
 x
0 Bk‚àí1(t)dt +Ck .
Using the property that Bk has integral zero over [0,1] we evaluate the constant Ck.
We have
0 =
 1
0

k
 x
0 Bk‚àí1(t)dt +Ck

dx
= k
 1
0
 1
t dx

Bk‚àí1(t)dt +Ck
= ‚àík
 1
0 tBk‚àí1(t)dt +Ck .
Thus
Ck = k
 1
0 tBk‚àí1(t)dt .
The Fourier series of Bk(x) can be obtained by integrating the one for Bk‚àí1(x)
for all k ‚â•2 by induction via the identity
Bk(x) = k
 x
0 Bk‚àí1(t)dt +k
 1
0 tBk‚àí1(t)dt .
(4.5.3)
Indeed, assume that (4.5.1) holds for some k ‚â•2. Then using (4.5.3) we obtain
Bk(x) =
 x
0 lim
N‚Üí‚àû‚àë
|m|‚â§N
mÃ∏=0
‚àík (k ‚àí1)!
(2œÄim)k‚àí1 e2œÄimt dt ‚àí
 1
0 t lim
N‚Üí‚àû‚àë
|m|‚â§N
mÃ∏=0
k (k ‚àí1)!
(2œÄim)k‚àí1 e2œÄimt dt
= lim
N‚Üí‚àû
 x
0 ‚àë
|m|‚â§N
mÃ∏=0
‚àík (k ‚àí1)!
(2œÄim)k‚àí1 e2œÄimt dt ‚àílim
N‚Üí‚àû
 1
0 t ‚àë
|m|‚â§N
mÃ∏=0
k (k ‚àí1)!
(2œÄim)k‚àí1 e2œÄimt dt

4.5 Applications to Number theory and Ergodic theory
301
= ‚àílim
N‚Üí‚àû‚àë
|m|‚â§N
mÃ∏=0
k!
(2œÄim)k‚àí1
e2œÄimx ‚àí1
2œÄim
‚àílim
N‚Üí‚àû‚àë
|m|‚â§N
mÃ∏=0
k!
(2œÄim)k‚àí1

t e2œÄimt
2œÄim
t=1
t=0
= ‚àík! ‚àë
mÃ∏=0
e2œÄimx
(2œÄim)k .
Passing the limit from inside the integral to outside is allowed due to the uniform
convergence of the series when k ‚â•3. In the case k = 2, one may use Exercise 3.5.6
which says that for all [a,b] ‚´ÖT1 and g integrable functions over [a,b] one has
lim
N‚Üí‚àû
 b
a (g‚àóDN)(t)dt =
 b
a lim
N‚Üí‚àû(g‚àóDN)(t)dt =
 b
a g(t)dt .
This argument proves identity (4.5.1) for all k ‚â•2 by induction and concludes the
proof.
‚ñ°
We recall the following deÔ¨Ånition from number theory.
DeÔ¨Ånition 4.5.3. For s > 1 we deÔ¨Åne
Œ∂(s) =
‚àû
‚àë
k=1
1
ks
called the Riemann zeta function.
We use the Fourier expansions of the Bernoulli polynomials to obtain the values
of the Riemann zeta function for integers. When k is an even integer, identity (4.5.1)
can also be written as
Bk(x) = 2(‚àí1)1+ k
2 k!
‚àû
‚àë
n=1
cos(2œÄnx)
(2œÄn)k
and inserting x = 0 yields
Œ∂(k) =
‚àû
‚àë
n=1
1
nk = Bk(0)(2œÄ)k
2(‚àí1)1+ k
2 k!
.
The polynomial B1(x) = x ‚àí1/2 has rational coefÔ¨Åcients and thus so do all the Bk
by a straightforward inductive argument that uses the identity (4.5.3). Thus Bk(0) is
a rational number for all k ‚â•1. We conclude that
Œ∂(2m) = B2m(0)(2œÄ)2m
2(‚àí1)1+m(2m)!
(4.5.4)
which is a rational multiple of (2œÄ)2m, hence transcendental, since œÄ is a transcen-
dental number. We have therefore obtained the following.

302
4 Topics on Fourier Series
Corollary 4.5.4. (Euler) The value of the Riemann zeta function Œ∂(2m), m =
1,2,..., is equal to a rational multiple of (2œÄ)2m; hence it is a transcendental
number.
The corresponding statement for odd integers remains unresolved in general, as
of this writing.
4.5.2 Equidistributed sequences
Here we discuss Weyl‚Äôs theorem on equidistributed sequences.
DeÔ¨Ånition 4.5.5. A sequence {ak}‚àû
k=0 with values in Tn is called equidistributed if
for every cube Q in Tn we have
lim
N‚Üí‚àû
#{k : 0 ‚â§k ‚â§N ‚àí1,
ak ‚ààQ}
N
= |Q|.
Theorem 4.5.6. The following statements are equivalent:
(a) The sequence {ak}‚àû
k=0 is equidistributed.
(b) For every smooth function f on Tn we have that
lim
N‚Üí‚àû
1
N
N‚àí1
‚àë
k=0
f(ak) =

Tn f(x)dx.
(c) For every m ‚ààZn \{0} we have
lim
N‚Üí‚àû
1
N
N‚àí1
‚àë
k=0
e2œÄim¬∑ak = 0.
Proof. We Ô¨Årst prove the equivalence of (a) and (b). We begin by observing that
(b) is a restatement of (a) if f = œáQ and Q is a cube in Tn. Thus, if (a) holds,
then (b) holds for all step functions, i.e., Ô¨Ånite linear combinations of characteristic
functions of cubes. We prove that (a) implies (b) for smooth functions. Given a
smooth function f on Tn and given Œµ > 0, by the uniform continuity of f, there is a
step function g = ‚àëm
j=1 cjœáQj (cj ‚ààC and Qj are cubes in Tn) such that ‚à•f ‚àíg‚à•L‚àû<
Œµ
3. Since g is a Ô¨Ånite linear combination of step functions, there is an N0 such that
for N ‚â•N0 we have

1
N
N‚àí1
‚àë
k=0
g(ak)‚àí

Tn g(x)dx
 < Œµ
3 .
Since


Tn f(x)dx‚àí

Tn g(x)dx
 ‚â§‚à•f ‚àíg‚à•L‚àû< Œµ
3

4.5 Applications to Number theory and Ergodic theory
303
and

1
N
N‚àí1
‚àë
k=0
g(ak)‚àí1
N
N‚àí1
‚àë
k=0
f(ak)
 ‚â§‚à•f ‚àíg‚à•L‚àû< Œµ
3 ,
it follows that for N ‚â•N0 we have

1
N
N‚àí1
‚àë
k=0
f(ak)‚àí

Tn f(x)dx
 < Œµ ,
thus (b) holds.
To prove that (b) implies (a) given a cube Q in Tn pick two smooth functions g
and h such that
0 ‚â§h ‚â§œáQ ‚â§g
and such that g is equal to 1 on Q and vanishes off (1+Œµ)Q while h is equal to 1 on
(1‚àíŒµ)Q and vanishes off Q. Observe that
|Q|‚àícn Œµ ‚â§

Tn h(x)dx ‚â§|Q| ‚â§

Tn g(x)dx ‚â§|Q|+cn Œµ .
for some cn > 0. Since
1
N
N‚àí1
‚àë
k=0
h(ak) ‚â§1
N
N‚àí1
‚àë
k=0
œáQ(ak) ‚â§1
N
N‚àí1
‚àë
k=0
g(ak),
the sandwich theorem implies that
|Q|‚àícn Œµ ‚â§liminf
N‚Üí‚àû
1
N
N‚àí1
‚àë
k=0
œáQ(ak) ‚â§limsup
N‚Üí‚àû
1
N
N‚àí1
‚àë
k=0
œáQ(ak) ‚â§|Q|+cn Œµ .
Since Œµ > 0 was arbitrary the conclusion follows.
The implication (b) =‚áí(c) is trivial.
We now prove that (c) =‚áí(b).
Given a smooth function f on Tn we write
1
N
N‚àí1
‚àë
k=0
f(ak) = 1
N
N‚àí1
‚àë
k=0 ‚àë
m‚ààZn
1f(m)e2œÄim¬∑ak = 1f(0)+ ‚àë
m‚ààZn\{0}
1f(m)
 1
N
N‚àí1
‚àë
k=0
e2œÄim¬∑ak

.
Because of the rapid decay of the Fourier coefÔ¨Åcients of f we can pass the limit as
N ‚Üí‚àûinside the sum in m. It follows that
lim
N‚Üí‚àû
1
N
N‚àí1
‚àë
k=0
f(ak) = 1f(0) =

Tn f(x)dx.
‚ñ°

304
4 Topics on Fourier Series
Example 4.5.7. The sequence {k
‚àö
2‚àí[k
‚àö
2]}‚àû
k=0 is equidistributed on T1. We check
this by verifying condition (c) of Theorem 4.5.6. Indeed if m ‚ààZ\{0} then
lim
N‚Üí‚àû
1
N
N‚àí1
‚àë
k=0
e2œÄim(k
‚àö
2‚àí[k
‚àö
2]) = lim
N‚Üí‚àû
1
N
e2œÄiN(m
‚àö
2) ‚àí1
e2œÄi(m
‚àö
2) ‚àí1
= 0,
since m
‚àö
2 is never a rational and thus the denominator never vanishes.
Naturally, the same conclusion is valid for any other irrational number in place
of
‚àö
2.
Example 4.5.8. We examine the sequence of the Ô¨Årst digits of powers of 2. Consider
the following sequence of numbers deÔ¨Åned for m = 1,2,...
dm = Ô¨Årst digit of 2m.
For instance we have d1 = 2,d2 = 4,d3 = 8,d4 = 1,d5 = 3,....
Fix an integer k ‚àà{1,2,3,4,5,6,7,8,9}. We would like to Ô¨Ånd the frequency in
which k appears as a Ô¨Årst digit of 2m, precisely, we would like to compute
lim
N‚Üí‚àû
#
	
m ‚àà{1,2,...,N} : dm = k

N
.
The crucial observation is that the Ô¨Årst digit of 2m is equal to k if and only if there is
a nonnegative integer s such that
k10s ‚â§2m < (k +1)10s .
Taking logarithms with base 10 we obtain
s+log10(k) ‚â§mlog10 2 < s+log10(k +1),
but since 0 ‚â§log10(k) and log10(k +1) ‚â§1, taking fractional parts we obtain that
s = [mlog10 2]
and that
log10(k) ‚â§mlog10 2‚àí[mlog10 2] < log10(k +1).
Since the number log10 2 is irrational, it follows from Example 4.5.7 that the
sequence
	
mlog10 2‚àí[mlog10 2]

‚àû
m=1
is equidistributed in [0,1). Using DeÔ¨Ånition 4.5.5 in dimension n = 1 with
Q = [a,b] =

log10(k),log10(k +1)


4.5 Applications to Number theory and Ergodic theory
305
we obtain that
lim
N‚Üí‚àû
#
	
m ‚àà{1,2,...,N} : dm = k

N
= log10(k +1)‚àílog10(k) = log10(1+ 1
k).
This gives the frequency in which k appears as Ô¨Årst digit of 2m. Notice that
9
‚àë
k=1
log10(1+ 1
k) =
9
‚àë
k=1

log10(k +1)‚àílog10(k)

= 1,
as expected, and that the digit with the highest frequency that appears Ô¨Årst in a
term of the sequence {1,2,4,8,16,32,64,...} is 1, while the one with the lowest
frequency is 9.
4.5.3 The Number of Lattice Points inside a Ball
Points in Zn are called lattice points. In this subsection we obtain the number of
lattice points N(R) inside a closed ball of radius R in Rn centered at the origin,
precisely, we compute the asymptotic behavior of
N(R) = |B(0,R)‚à©Zn|
as R ‚Üí‚àû. We denote by vn the volume of the closed unit ball in Rn. We have the
following result.
Theorem 4.5.9. Let n ‚â•2. If N(R) is the number of lattice points inside the closed
ball of radius R centered at zero in Rn, then we have that
N(R) = vnRn +O(Rn n‚àí1
n+1 ),
as R ‚Üí‚àû.
Proof. Let B be the closed unit ball in Rn and œáB its characteristic function. Using
the result in Appendix B.5 we have 2
œáB(Œæ) =
Jn/2(2œÄ|Œæ|)
|Œæ|n/2
. Now in view of the behavior
of the Bessel function given in Appendix B.6 for |Œæ| <
1
2œÄ we have Jn/2(2œÄ|Œæ|) ‚â§
C|Œæ|
n
2 . Also for |Œæ| ‚â•
1
2œÄ we have Jn/2(2œÄ|Œæ|) ‚â§C|Œæ|‚àí1
2 , in view of the result in
Appendix B.7. Consequently, there is a constant Cn such that for all Œæ ‚ààRn we have
|2
œáB(Œæ)| ‚â§Cn(1+|Œæ|)‚àín+1
2 .
Fix a smooth nonnegative radial function Œ∂ supported in |x| ‚â§1
2 with integral
equal to 1 and deÔ¨Åne Œ∂Œµ(x) = 1
Œµn Œ∂( x
Œµ ) for Œµ > 0. For 0 < Œµ < 1
10, deÔ¨Åne functions
Œ¶Œµ = œá(1‚àíŒµ
2 )B ‚àóŒ∂Œµ
Œ® Œµ = œá(1+ Œµ
2 )B ‚àóŒ∂Œµ.

306
4 Topics on Fourier Series
These functions are even, hence their Fourier transforms are real-valued. We observe
that
Œ¶Œµ(x) = 1 when |x| ‚â§1‚àíŒµ
and
Œ¶Œµ(x) = 0 when |x| ‚â•1.
(4.5.5)
Indeed, we have
Œ¶Œµ(x) =

Rn œá(1‚àíŒµ
2 )B(y)Œ∂Œµ(x‚àíy)dy
=

|y|‚â§1‚àíŒµ
2
1
Œµn Œ∂( x‚àíy
Œµ )dy
=

|y|‚â§1
Œµ ‚àí1
2
Œ∂( x
Œµ ‚àíy)dy.
For |x| ‚â§1‚àíŒµ, | x
Œµ | ‚â§1
Œµ ‚àí1, so | x
Œµ ‚àít| ‚â§1
Œµ ‚àí1+ 1
2 = 1
Œµ ‚àí1
2 for |t| ‚â§1
2, which means
Œ¶Œµ(x) =

|y|‚â§1
Œµ ‚àí1
2
Œ∂( x
Œµ ‚àíy)dy =

|t|‚â§1
2
Œ∂(t)dt = 1.
For |x| ‚â•1,| x
Œµ ‚àíy| ‚â•1
Œµ ‚àí1
Œµ + 1
2 = 1
2, so
Œ¶Œµ(x) =

|y|‚â§1
Œµ ‚àí1
2
Œ∂( x
Œµ ‚àíy)dy = 0,
proving (4.5.5). Likewise one can show that
Œ® Œµ(x) = 1 when |x| ‚â§1
and
Œ® Œµ(x) = 0 when |x| ‚â•1+Œµ.
(4.5.6)
Next we claim that
2
Œ¶Œµ(Œæ)
+
2
Œ® Œµ(Œæ)
 ‚â§Cn,N(1+|Œæ|)‚àín+1
2 (1+Œµ|Œæ|)‚àíN
(4.5.7)
for every Œæ ‚ààRn and N a large positive number. Indeed to show (4.5.7) for Œ¶Œµ we
write
|2
Œ¶Œµ(Œæ)| = | 
œá(1‚àíŒµ
2 )B(Œæ)1Œ∂(ŒæŒµ)|
‚â§(1‚àíŒµ
2)nCn(1+|Œæ|(1‚àíŒµ
2))‚àín+1
2 |1Œ∂(ŒæŒµ)|
‚â§Cn,N(1+|Œæ|)‚àín+1
2 (1+Œµ|Œæ|)‚àíN
(4.5.8)
since Œ∂ ‚ààS (R) and 0 < Œµ < 1
10. The proof for Œ® Œµ is completely similar.
We now notice that for R > 0, m ‚ààZn \{0}, and x ‚àà[0,1]n we have
1+|m+x|R ‚â§1+(‚àön+|m|)R ‚â§2‚àön(1+|m|R).

4.5 Applications to Number theory and Ergodic theory
307
This implies that for Œµ < 1/10 we have
‚àë
m‚ààZn\{0}
Rn(1+R|m|)‚àín+1
2 (1+ŒµR|m|)‚àíN
‚â§C‚Ä≤

[0,1]n
‚àë
m‚ààZn\{0}
Rn(1+R|m+x|)‚àín+1
2 (1+ŒµR|m+x|)‚àíNdx
‚â§C‚Ä≤

Rn Rn(1+R|x|)‚àín+1
2 (1+ŒµR|x|)‚àíNdx
‚â§C‚Ä≤‚Ä≤Œµ‚àín‚àí1
2 ,
(4.5.9)
where the proof of (4.5.9) is easily deduced by considering the cases (a) |x| ‚â§R‚àí1
which yields a constant, (b) R‚àí1 ‚â§|x| ‚â§(RŒµ)‚àí1 which yields a constant multiple of
Œµ‚àín‚àí1
2 , and (c) (RŒµ)‚àí1 ‚â§|x| which also produces a constant multiple of Œµ‚àín‚àí1
2 if we
pick N > n‚àí1
2 .
Using (4.5.5) and the Poisson summation formula we write
‚àë
m‚ààZn
œáB( m
R ) ‚â•‚àë
m‚ààZn
Œ¶Œµ( m
R )
= Rn 2
Œ¶Œµ(0)+
‚àë
m‚ààZn\{0}
Rn 2
Œ¶Œµ(Rm)
‚â•vnRn(1‚àíŒµ)n ‚àíCn,N
‚àë
m‚ààZn\{0}
Rn(1+R|m|)‚àín+1
2 (1+ŒµR|m|)‚àíN
‚â•vnRn ‚àínvnRnŒµ ‚àíC‚Ä≤
n,NŒµ‚àín‚àí1
2 ,
where we used that (1 ‚àíŒµ)n ‚â•1 ‚àínŒµ, (4.5.8), and (4.5.9). Now pick Œµ such that
ŒµRn = Œµ‚àín‚àí1
2 , or equivalently Œµ = R‚àí2n
n+1 to deduce the estimate
N(R) ‚â•vnRn ‚àíO(Rn n‚àí1
n+1 )
as R ‚Üí‚àû.
Finally, making use of (4.5.6), and via a similar argument we write
‚àë
m‚ààZn
œáB( m
R ) ‚â§‚àë
m‚ààZn
Œ® Œµ( m
R ) = Rn 2
Œ® Œµ(0)+
‚àë
m‚ààZn\{0}
Rn 2
Œ® Œµ(Rm)
‚â§vnRn(1+Œµ)n +Cn,N
‚àë
m‚ààZn\{0}
Rn(1+R|m|)‚àín+1
2 (1+ŒµR|m|)‚àíN
‚â§vnRn +vn 2n RnŒµ +Cn,NŒµ‚àín‚àí1
2 .
The same choice of Œµ = R‚àí2n
n+1 , yields the upper estimate for N(R).

308
4 Topics on Fourier Series
Combining the upper and lower estimates for N(R) we obtain
N(R) = vnRn +O(Rn n‚àí1
n+1 ),
as R ‚Üí‚àû.
‚ñ°
Exercise 4.5.8 contains an application of Theorem 4.5.9.
Exercises
4.5.1. Prove that for all x ‚àà[0,1] we have
‚àû
‚àë
j=1
sin(2œÄ jx)
j2m+1
= (‚àí1)m+1
2
(2œÄ)2m+1
(2m+1)!B2m+1(x).
4.5.2. Show that for all z ‚ààC with |z| < 1 we have
œÄzcot(œÄz) = 1‚àí2
‚àû
‚àë
k=0
z2k+2Œ∂(2k +2).

Hint: Use the result of Exercise 4.4.5.

4.5.3. Suppose that a point x = (x1,...,xn) ‚àà[0,1]n has the property that m¬∑x is irra-
tional for all m ‚ààZn\{0}. Show that the sequence {(kx1‚àí[kx1],...,kxn‚àí[kxn])}‚àû
k=0
is equidistributed in Tn.
4.5.4. ([191]) Let N(x,R) be the number of lattice points inside the closed ball of
radius R > 0 centered at x ‚ààRn. Show that

Tn
N(x,R)‚àívnRn2 dx = O(Rn‚àí1)
as R ‚Üí‚àû, where vn is the volume of the unit ball on Rn.
4.5.5. (Minkowski) Let S be an open convex symmetric set in Rn and assume that
the Fourier transform of its characteristic function satisÔ¨Åes the decay estimate
| 1œáS(Œæ)| ‚â§C(1+|Œæ|)‚àín+1
2 .
(This is the case if the boundary of S has nonzero Gaussian curvature.) Assume that
|S| > 2n. Prove that S contains at least one lattice point other than the origin.

Hint: Assume the contrary, set f = œá 1
2 S ‚àóœá 1
2 S, and apply the Poisson summation
formula to f to prove that f(0) ‚â•1f(0).


4.5 Applications to Number theory and Ergodic theory
309
4.5.6. For t ‚àà[0,‚àû) let
N(t) = #{m ‚ààZn : |m| ‚â§t}.
Let 0 = r0 < r1 < r2 < ¬∑¬∑¬∑ be the sequence all of numbers r for which there exist
m ‚ààZn such that |m| = r.
(a) Observe that N is right continuous and constant on intervals of the form [r j,r j+1).
(b) Show that the distributional derivative of N is the measure
Œº(t) = #{m ‚ààZn : |m| = t},
deÔ¨Åned via the identity ‚ü®Œº,œï‚ü©= ‚àë‚àû
j=0 #{m ‚ààZn : |m| = r j}œï(r j).
4.5.7. Let f ‚ààC 1((0,‚àû)), and let 0 < a < b < ‚àû. Derive the identity
‚àë
m‚ààZn
a<|m|‚â§b
f(|m|) =
 b
a f(t)dN(t) = f(b)N(b)‚àíf(a)N(a)‚àí
 b
a f ‚Ä≤(x)N(x)dx,
where N is deÔ¨Åned in Exercise 4.5.6 and
 b
a f(t)dN(t) is the Riemann-Stieltjes in-
tegral of f with respect to N.
4.5.8. Let n ‚ààZ+ and 0 < Œª < ‚àû.
(a) Prove that for k ‚ààZ+ ‚à™{0} we have
‚àë
m‚ààZn
a<|m|‚â§b
ei|m|
|m|Œª = ‚àíiœân‚àí1 eib
bŒª‚àí(n‚àí1) ‚àí‚àíiœân‚àí1 eia
aŒª‚àí(n‚àí1) +O(a‚àíŒª+(n‚àí1)‚àín‚àí1
n+1 )
for all 0 < a < b < ‚àûwith b‚àía ‚â§1, where œân‚àí1 is the volume of Sn‚àí1.
(b) Show that when Œª > n‚àín‚àí1
n+1, the limit
lim
R‚Üí‚àû
‚àë
m‚ààZn\{0}
|m|‚â§R
ei|m|
|m|Œª
exists.
(c) Prove, however, that when n‚àí1‚àín‚àí1
n+1 < Œª ‚â§n‚àí1, the limit in part (b) does not
exist.

Hint: Use Exercise 4.5.7 and Theorem 4.5.9. Part (b): For R > 1 use the identity
‚àë
m‚ààZn\{0}
|m|‚â§R
ei|m|
|m|Œª =
[R‚àí1
2 ]‚àí1
‚àë
k=0

‚àë
m‚ààZn
k+ 1
2 <|m|‚â§k+ 3
2
ei|m|
|m|Œª

+
$
‚àë
m‚ààZn
[R‚àí1
2 ]+ 1
2 <|m|‚â§R
ei|m|
|m|Œª
%
.
Notice that the main term in the Ô¨Årst sum on the right is telescoping. Part (c): Show
that limR‚Üí‚àû‚àëm‚ààZn\{0}
R<|m|‚â§R+1
ei|m|
|m|Œª does not tend to zero.


310
4 Topics on Fourier Series
HISTORICAL NOTES
The boundedness of the conjugate function on the circle (Theorem 4.1.7) and, hence, the Lp
convergence of one-dimensional Fourier series was announced by Riesz in [292], but its proof ap-
peared a little later in [293]. The proof of Theorem 4.1.7 in the text is attributed to S. Bochner.
Luzin‚Äôs conjecture [235] on almost everywhere convergence of the Fourier series of continuous
functions was announced in 1913 and settled by Carleson [54] in 1965 for the more general class
of square summable functions (Theorem 4.3.14). Carleson‚Äôs theorem was later extended by Hunt
[165] for the class of Lp functions for all 1 < p < ‚àû(Theorem 4.3.15). Sj¬®olin [325] sharpened
this result by showing that the Fourier series of functions f with | f|(log+ | f|)(log+ log+ | f|) in-
tegrable over T1 converge almost everywhere. Antonov [5] improved Sj¬®olin‚Äôs result by extend-
ing it to functions f with | f|(log+ | f|)(log+ log+ log+ | f|) integrable over T1. One should also
consult the related results of Soria [330] and Arias de Reyna [9]. The book [10] of Arias de
Reyna contains a historically motivated comprehensive study of topics related to the Carleson‚Äì
Hunt theorem. Counterexamples due to Konyagin [200] show that Fourier series of functions f
with | f|(log+ | f|)
1
2 (log+ log+ | f|)‚àí1
2 ‚àíŒµ integrable over T1 may diverge when Œµ > 0. Examples of
continuous functions whose Fourier series diverge exactly on given sets of measure zero are given
in Katznelson [189] and Kahane and Katznelson [183].
The extension of the Carleson‚ÄìHunt theorem to higher dimensions for square summability of
Fourier series (Theorem 4.3.16) is a rather straightforward consequence of the one-dimensional
result and was independently obtained by Fefferman [112], Sj¬®olin [325], and Tevzadze [359]. An
example showing that the circular partial sums of a Fourier series may not converge in Lp(Tn) for
n ‚â•2 and p Ã∏= 2 was obtained by Fefferman [113]. This example also shows that there exist Lp
functions on Tn for n ‚â•2 whose circular partial sums do not converge almost everywhere when
1 ‚â§p < 2. Indeed, if the opposite happened, then the maximal operator f ‚ÜísupN‚â•0 |#D(n,N)‚àóf|
would have to be Ô¨Ånite a.e. for all f ‚ààLp(Tn), and by Stein‚Äôs theorem [335] it would have to be of
weak type (p, p) for some 1 < p < 2. But this would contradict Fefferman‚Äôs counterexample on Lp1
for some p < p1 < 2. On the other hand, almost everywhere is valid for the square partial sums of
functions f with | f|(log+ | f|)n(log+ log+ log+ | f|) integrable over Tn, as shown by Antonov [6];
see also Sj¬®olin and Soria [327].
The development of the complex methods in the study of Fourier series was pioneered by
the Russian school, especially Luzin and his students Kolmogorov, Menshov, and Privalov. The
existence of an integrable function on T1 whose Fourier series diverges almost everywhere (The-
orem 4.2.1) is due to Kolmogorov [195]. An example of an integrable function whose Fourier
series diverges everywhere was also produced by Kolmogorov [198] three years later. Localiza-
tion of the Bochner‚ÄìRiesz means at the critical exponent Œ± = n‚àí1
2
fails for L1 functions on Tn
(see Bochner [30]) but holds for functions f such that | f|log+ | f| is integrable over Tn (see Stein
[333]). The latter article also contains the Lp boundedness of the maximal Bochner‚ÄìRiesz oper-
ator supR>0 |BŒ±
R( f)| for 1 < p < ‚àûwhen Œ± > | 1
p ‚àí1
2|. Proposition 4.1.9 is due to Stein [331] and
Theorem 4.2.5 is also due to Stein [335]. The technique that involves the points for which the set
{|x‚àím| : m ‚ààZn} is linearly independent over the rationals was introduced by Bochner [30].
Transference of regulated multipliers originated in the article of de Leeuw [94]. The methods
of transference in Section 4.3 were beautifully placed into the framework of a general theory by
Coifman and Weiss [70]. The key Lemma 4.3.8 is attributed to G. Weiss. Transference of maximal
multipliers (Theorem 4.3.12) was Ô¨Årst obtained by Kenig and Tomas [192] and later elaborated by
Asmar, Berkson, and Gillespie [12], [13].
Paraphrasing Pappus of Alexandria, bees know than a hexagon will hold more honey than a
triangle or square of the same length, but people claim a greater share of wisdom knowing that the
circle of a given length holds the maximum area among all geometric shapes of equal perimeter.
This reÔ¨Çection captures the isoperimetric inequality, which was Ô¨Årst recorded by Pappus in the
fourth century A.D. and was credited it to Zenodorus (second century B.C.). Archimedes also
studied the problem, but his work on the subject, like the original writings of Zenodorus, has been
lost. Rigorous modern-day proofs of this inequality can be traced to J. Steiner, K. Weierstrass, and

4.5 Applications to Number theory and Ergodic theory
311
F. Edler, whose methods are based in geometry and calculus. The proof in the text is due to A.
Hurwitz. On the history of the isoperimetric inequality see [322].
The mean square error for lattice points (Exercise 4.5.4) is due to Kendall [191] while the more
delicate pointwise asymptotic formula of Theorem 4.5.9 was obtained by Landau [212]. Using
Landau‚Äôs formula Pinsky, Stanton, and Trapa [284] showed that the spherical partial sums of the
Fourier series of the characteristic function of a sufÔ¨Åciently small ball in Tn converge at the center
of the ball if and only if the dimension n is strictly less than three; this property is valid for the
characteristic function of any ball as shown in Pinsky [283].

Chapter 5
Singular Integrals of Convolution Type
The topic of singular integrals is motivated by its intimate connection with some of
the most important problems in Fourier analysis, such as that of the convergence of
Fourier series. As we have seen, the Lp boundedness of the conjugate function on
the circle is equivalent to the Lp convergence of Fourier series of Lp functions. And
since the Hilbert transform on the real line provides an analogue of the conjugate
function on the circle, it is deeply connected with the Lp convergence of Fourier
integrals. It also appears in the theory of harmonic functions on the upper half space
and has so many remarkable properties that deserve a careful investigation. The
Hilbert transform is the prototype of all singular integrals and provides inspiration
for subsequent development of the subject.
Historically, the theory of the Hilbert transform depended on techniques of com-
plex analysis. With the development of the Calder¬¥on‚ÄìZygmund school, and the
extension of one-dimensional theory to higher dimensions, real-variable methods
slowly replaced complex analysis. The higher-dimensional framework proved to be
Ô¨Çexible enough for generalizations and led to the introduction of singular integrals
in other areas of mathematics. Singular integrals are nowadays intimately connected
with partial differential equations, operator theory, several complex variables, and
other Ô¨Åelds. In this chapter we study singular integrals given by convolution with
tempered distributions. We call such operators singular integrals of convolution
type.
5.1 The Hilbert Transform and the Riesz Transforms
We begin the investigation of singular integrals with a careful study of the Hilbert
transform which provides inspiration for the subsequent development of the theory.
L. Grafakos, Classical Fourier Analysis, Graduate Texts in Mathematics 249,
DOI 10.1007/978-1-4939-1194-3 5, ¬© Springer Science+Business Media New York 2014
313

314
5 Singular Integrals of Convolution Type
5.1.1 DeÔ¨Ånition and Basic Properties of the Hilbert Transform
There are several equivalent ways to introduce the Hilbert transform; in this ex-
position we Ô¨Årst deÔ¨Åne it as a convolution operator with a certain principal value
distribution, but we later discuss other equivalent deÔ¨Ånitions.
We begin by deÔ¨Åning a distribution W0 in S ‚Ä≤(R) as follows:
4
W0,œï
5
= 1
œÄ lim
Œµ‚Üí0

Œµ‚â§|x|‚â§1
œï(x)
x
dx+ 1
œÄ

|x|‚â•1
œï(x)
x
dx,
(5.1.1)
for œï in S (R). The function 1/x integrated over [‚àí1,‚àíŒµ][Œµ,1] has mean value
zero, and we may replace œï(x) by œï(x) ‚àíœï(0) in the Ô¨Årst integral in (5.1.1). Since
(œï(x) ‚àíœï(0))x‚àí1 is controlled by ‚à•œï‚Ä≤‚à•L‚àû, it follows that the limit in (5.1.1) exists.
To see that W0 is indeed in S ‚Ä≤(R), we note that the estimate
4
W0,œï
5 ‚â§2
œÄ
œï‚Ä≤
L‚àû+ 2
œÄ sup
x‚ààR
|xœï(x)|
(5.1.2)
is valid. This says that W0 ‚ààS ‚Ä≤(R).
DeÔ¨Ånition 5.1.1. The truncated Hilbert transform (at height Œµ) of a function f in
Lp(R), 1 ‚â§p < ‚àû, is deÔ¨Åned by
H(Œµ)( f)(x) = 1
œÄ

|y|‚â•Œµ
f(x‚àíy)
y
dy = 1
œÄ

|x‚àíy|‚â•Œµ
f(y)
x‚àíy dy.
(5.1.3)
The Hilbert transform of œï ‚ààS (R) is deÔ¨Åned by
H(œï)(x) = (W0 ‚àóœï)(x) = lim
Œµ‚Üí0H(Œµ)(œï)(x).
(5.1.4)
Observe that H(Œµ)( f) is well deÔ¨Åned for all f ‚ààLp, 1 ‚â§p < ‚àû. This follows from
H¬®older‚Äôs inequality, since 1/x is integrable to the power p‚Ä≤ on the set |x| ‚â•Œµ.
For Schwartz functions œï, the integral
 +‚àû
‚àí‚àû
œï(x‚àíy)
y
dy
may not converge absolutely for any real number x, but is deÔ¨Åned as a limit of the
absolutely convergent integrals

|y|‚â•Œµ
œï(x‚àíy)
y
dy,
as Œµ ‚Üí0. Such limits are called principal value integrals and are denoted by the
letters p.v. Using this notation, the Hilbert transform of a Schwartz function œï is
H(œï)(x) = 1
œÄ p.v.
 +‚àû
‚àí‚àû
œï(x‚àíy)
y
dy = 1
œÄ p.v.
 +‚àû
‚àí‚àû
œï(y)
x‚àíy dy.
(5.1.5)

5.1 The Hilbert Transform and the Riesz Transforms
315
Remark 5.1.2. We extend the deÔ¨Ånition of the Hilbert transform to a bigger class
of functions. Suppose that f is an integrable function on R that satisÔ¨Åes a H¬®older
condition near every point x; that is, for any x ‚ààR there are Cx > 0 and Œµx > 0 such
that
| f(x)‚àíf(y)| ‚â§Cx|x‚àíy|Œµx
whenever |y‚àíx| < Œ¥x. Then we write
H(Œµ)( f)(x) = 1
œÄ

Œµ<|x‚àíy|<Œ¥x
f(y)
x‚àíy dy+ 1
œÄ

|x‚àíy|‚â•Œ¥x
f(y)
x‚àíy dy
= 1
œÄ

Œµ<|x‚àíy|<Œ¥x
f(y)‚àíf(x)
x‚àíy
dy+ 1
œÄ

|x‚àíy|‚â•Œ¥x
f(y)
x‚àíy dy.
Both integrals converge absolutely; hence the limit of H(Œµ)( f)(x) exists as Œµ ‚Üí0.
Fig. 5.1 The graph of the
function H(œáE) when E is
a union of three disjoint
intervals J1 ‚à™J2 ‚à™J3.
Example 5.1.3. For the characteristic function œá[a,b] of an interval [a,b] we show
that
H(œá[a,b])(x) = 1
œÄ log |x‚àía|
|x‚àíb| .
(5.1.6)
Let us verify this identity. Pick Œµ < min(|x ‚àía|,|x ‚àíb|). To show (5.1.6) consider
the three cases 0 < x ‚àíb, x ‚àía < 0, and x ‚àíb < 0 < x ‚àía. In the Ô¨Årst two cases,
(5.1.6) follows immediately. In the third case we have
H(œá[a,b])(x) = 1
œÄ lim
Œµ‚Üí0

log |x‚àía|
Œµ
+log
Œµ
|x‚àíb|

,
(5.1.7)

316
5 Singular Integrals of Convolution Type
which yields (5.1.6). Observe that the cancellation of Œµ in (5.1.7) reÔ¨Çects the fact
that 1/x has integral zero on symmetric intervals Œµ < |x| < c. Note that H(œá[a,b])(x)
blows up logarithmically in x near the points a and b and decays like |x|‚àí1 as x ‚Üí‚àû.
See Figure 5.1.
Example 5.1.4. Let log+ x = logx when x ‚â•1 and zero otherwise. Observe that the
calculation in the previous example actually gives
H(Œµ)(œá[a,b])(x) =
‚éß
‚é™
‚é™
‚é™
‚é™
‚é™
‚é™
‚é™
‚é™
‚é™
‚é™
‚é®
‚é™
‚é™
‚é™
‚é™
‚é™
‚é™
‚é™
‚é™
‚é™
‚é™
‚é©
1
œÄ log+
|x‚àía|
max(Œµ,|x‚àíb|)
when x > b,
‚àí1
œÄ log+
|x‚àíb|
max(Œµ,|x‚àía|)
when x < a,
1
œÄ log+ |x‚àía|
Œµ
‚àí1
œÄ log+ |x‚àíb|
Œµ
when a < x < b.
We now give an alternative characterization of the Hilbert transform using the
Fourier transform. To achieve this we need to compute the Fourier transform of the
distribution W0 deÔ¨Åned in (5.1.1). Fix a Schwartz function œï on R. Then
42
W0,œï
5
=
4
W0, 1œï
5
(5.1.8)
= 1
œÄ lim
Œµ‚Üí0

|Œæ|‚â•Œµ
1œï(Œæ) dŒæ
Œæ
= 1
œÄ lim
Œµ‚Üí0

1
Œµ ‚â•|Œæ|‚â•Œµ

R œï(x)e‚àí2œÄixŒæ dx dŒæ
Œæ
= lim
Œµ‚Üí0

R œï(x)
 1
œÄ

1
Œµ ‚â•|Œæ|‚â•Œµ e‚àí2œÄixŒæ dŒæ
Œæ

dx
= lim
Œµ‚Üí0

R œï(x)
‚àíi
œÄ

1
Œµ ‚â•|Œæ|‚â•Œµ sin(2œÄxŒæ) dŒæ
Œæ

dx
= lim
Œµ‚Üí0

R œï(x)
‚àíi
œÄ sgnx

1
2œÄŒµ ‚â•|Œæ|‚â•Œµ
2œÄ
sin(|x|Œæ) dŒæ
Œæ

dx.
(5.1.9)
Here we used the signum function
sgnx =
‚éß
‚é™
‚é®
‚é™
‚é©
+1
when x > 0,
0
when x = 0,
‚àí1
when x < 0.
(5.1.10)
Using the results (a) and (b) in Exercise 5.1.1 we obtain that the integrals inside the
square brackets in (5.1.9) are uniformly bounded by 8 and converge to 2 œÄ
2 = œÄ as
Œµ ‚Üí0, whenever x Ã∏= 0. These observations make possible the use of the Lebesgue
dominated convergence theorem that allows the passage of the limit inside the inte-
gral in (5.1.9). We obtain that
42
W0,œï
5
=

R œï(x)(‚àíisgn(x))dx.
(5.1.11)

5.1 The Hilbert Transform and the Riesz Transforms
317
This implies that
2
W0(Œæ) = ‚àíisgnŒæ .
(5.1.12)
In particular, identity (5.1.12) says that 2
W0 is a (bounded) function.
We now use identity (5.1.12) to write
H( f)(x) =
 1f(Œæ)(‚àíisgnŒæ)
‚à®(x).
(5.1.13)
This formula can be used to give an alternative deÔ¨Ånition of the Hilbert transform.
An immediate consequence of (5.1.13) is that
H( f)

L2 =
f

L2 ,
(5.1.14)
that is, H is an isometry on L2(R). Moreover, H satisÔ¨Åes
H2 = HH = ‚àíI ,
(5.1.15)
where I is the identity operator. Equation (5.1.15) is a simple consequence of the
fact that (‚àíisgnŒæ)2 = ‚àí1. The adjoint operator H‚àóof H is uniquely deÔ¨Åned via the
identity
4
f |H(g)
5
=

R f H(g)dx =

R H‚àó( f) gdx =
4
H‚àó( f)|g
5
,
and we can easily obtain that H‚àóhas multiplier ‚àíisgnŒæ = isgnŒæ. We conclude that
H‚àó= ‚àíH. Likewise, we obtain Ht = ‚àíH.
5.1.2 Connections with Analytic Functions
We now investigate connections of the Hilbert transform with the Poisson kernel.
Recall the deÔ¨Ånition of the Poisson kernel Py given in Example 1.2.17. Then for a
real-valued function f in Lp(R), 1 ‚â§p < ‚àû, we have
(Py ‚àóf)(x) = y
œÄ
 +‚àû
‚àí‚àû
f(t)
(x‚àít)2 +y2 dt ,
(5.1.16)
and the integral in (5.1.16) converges absolutely by H¬®older‚Äôs inequality, since the
function t ‚Üí((x‚àít)2 +y2)‚àí1 is in Lp‚Ä≤(R) whenever y > 0.
Let Re z and Im z denote the real and imaginary parts of a complex number z.
Observe that
(Py ‚àóf)(x) = Re
 i
œÄ
 +‚àû
‚àí‚àû
f(t)
x‚àít +iy dt

= Re
 i
œÄ
 +‚àû
‚àí‚àû
f(t)
z‚àít dt

,

318
5 Singular Integrals of Convolution Type
where z = x+iy. The function
Ff (z) = i
œÄ
 +‚àû
‚àí‚àû
f(t)
z‚àít dt
deÔ¨Åned on
R2
+ = {z = x+iy : y > 0}
is analytic, since its ‚àÇ/‚àÇz derivative is zero. The real part of Ff (x+iy) is (Py ‚àóf)(x).
The imaginary part of Ff (x+iy) is
Im
 i
œÄ
 +‚àû
‚àí‚àû
f(t)
x‚àít +iy dt

= 1
œÄ
 +‚àû
‚àí‚àû
f(t)(x‚àít)
(x‚àít)2 +y2 dt = ( f ‚àóQy)(x),
where Qy is called the conjugate Poisson kernel and is given by
Qy(x) = 1
œÄ
x
x2 +y2 .
(5.1.17)
The function uf +ivf is analytic and thus uf (x+iy) = ( f ‚àóPy)(x) and vf (x+iy) =
( f ‚àóQy)(x) are conjugate harmonic functions. Since the family Py, y > 0, is an ap-
proximate identity, it follows from Theorem 1.2.19 that Py‚àóf ‚Üíf in Lp(R) as y ‚Üí0.
The following question therefore arises: What is the limit of f ‚àóQy as y ‚Üí0? The
next result addresses this question.
Theorem 5.1.5. Let 1 ‚â§p < ‚àû. For any f ‚ààLp(R) we have
f ‚àóQŒµ ‚àíH(Œµ)( f) ‚Üí0
(5.1.18)
in Lp and almost everywhere as Œµ ‚Üí0. Moreover, for œï in S (R) we have
Fœï(x+iy) = i
œÄ
 +‚àû
‚àí‚àû
œï(t)
x+iy‚àít dt ‚Üíœï(x)+iH(œï)(x)
(5.1.19)
as y ‚Üí0+ for all x ‚ààR.
Proof. We see that
(QŒµ ‚àóf)(x)‚àí1
œÄ

|t|‚â•Œµ
f(x‚àít)
t
dt = 1
œÄ ( f ‚àóœàŒµ)(x),
where œàŒµ(x) = Œµ‚àí1œà(Œµ‚àí1x) and
œà(t) =

t
t2+1 ‚àí1
t
when |t| ‚â•1,
t
t2+1
when |t| < 1.
(5.1.20)

5.1 The Hilbert Transform and the Riesz Transforms
319
Note that œà is integrable over the line and has integral zero. Furthermore, the inte-
grable function
Œ®(t) =

1
t2+1
when |t| ‚â•1,
1
when |t| < 1,
(5.1.21)
is a radially decreasing majorant of œà, i.e., it is even, decreasing on [0,‚àû), and
satisÔ¨Åes |œà| ‚â§Œ®. It follows from Theorem 1.2.21 (with a = 0) that f ‚àóœàŒµ ‚Üí0 in
Lp. Also Corollary 2.1.19 (with a = 0) implies that f ‚àóœàŒµ ‚Üí0 almost everywhere
as Œµ ‚Üí0.
Assertion (5.1.19) is a consequence of (5.1.18), the discussion preceding Theorem
5.1.5, and the observation that H(Œµ)(œï) converges to H(œï) pointwise everywhere as
Œµ ‚Üí0.
‚ñ°
Remark 5.1.6. We will show later that for f ‚ààLp(R), 1 ‚â§p < ‚àû, the expressions
H(Œµ)( f) converge a.e. (and also in Lp when p > 1) to a function #H( f). This will
be a consequence of Theorem 5.1.12 (or Corollary 5.3.6 when p = 1), combined
with Theorem 2.1.14 and the observation that for Schwartz functions œï, H(Œµ)(œï)
converge to H(œï) as Œµ ‚Üí0. The linear operator #H deÔ¨Åned in this way extends the
Hilbert transform H initially deÔ¨Åned on Schwartz functions and will still be denoted
by H. Thus for f ‚ààLp(R), 1 ‚â§p < ‚àû, one has
lim
Œµ‚Üí0 f ‚àóQŒµ = H( f)
a.e.
This convergence is also valid in Lp in view of the preceding observations and The-
orem 5.1.5.
5.1.3 Lp Boundedness of the Hilbert Transform
As a consequence of the result in Exercise 5.1.4 and of the fact that
x ‚â§1
2(ex ‚àíe‚àíx),
x ‚â•0,
we obtain that
|{x : |H(œáE)(x)| > Œ±}| ‚â§2
œÄ
|E|
Œ± ,
Œ± > 0,
(5.1.22)
for all subsets E of the real line of Ô¨Ånite measure. Theorem 1.4.19 with p0 = q0 = 1
and p1 = q1 = 2 now implies that H is bounded on Lp for 1 < p < 2. Duality gives
that H‚àó= ‚àíH is bounded on Lp for 2 < p < ‚àûand hence so is H.
We give another proof of the boundedness of the Hilbert transform H on Lp(R),
which has the advantage that it gives the best possible constant in the resulting norm
inequality when p is a power of 2.

320
5 Singular Integrals of Convolution Type
Theorem 5.1.7. For all 1 < p < ‚àû, there exists a positive constant Cp such that
H( f)

Lp ‚â§Cp
 f

Lp
for all f in S (R). Moreover, the constant Cp satisÔ¨Åes Cp ‚â§2p for 2 ‚â§p < ‚àûand
Cp ‚â§2p/(p‚àí1) for 1 < p ‚â§2. Therefore, the Hilbert transform H admits an exten-
sion to a bounded operator on Lp(R) when 1 < p < ‚àû.
Proof. The proof we give is based on the interesting identity
H( f)2 = f 2 +2H( fH( f)),
(5.1.23)
which is valid whenever f is a real-valued Schwartz function. We prove (5.1.23) in
two different ways. First we consider the analytic function
Ff (z) = i
œÄ

R
f(t)
z‚àít dt
deÔ¨Åned on the upper half space. We compute its square. Fix z ‚ààC with Rez > 0 and
f a real-valued Schwartz function. Then for Œµ > 0 we have
Ff (z)2 =
 i
œÄ
2 
R

R
f(t) f(s)
(z‚àít)(z‚àís) dtds
=
 i
œÄ
2
R

|t‚àís|>Œµ
f(t) f(s)
t ‚àís
 1
z‚àít ‚àí
1
z‚àís

dtds‚àí1
œÄ2

|t‚àís|‚â§Œµ
f(t) f(s)dtds
(z‚àít)(z‚àís)
=
 i
œÄ
2
R f(t)

|t‚àís|>Œµ
f(s)
t ‚àís ds dt
z‚àít ‚àí
 i
œÄ
2 
R f(s)

|t‚àís|>Œµ
f(t)
t ‚àís dt ds
z‚àís
‚àí1
œÄ2

|t‚àís|‚â§Œµ
f(t) f(s)dtds
(z‚àít)(z‚àís) .
Letting Œµ ‚Üí0 and passing the limit inside the integral by the Lebesgue dominated
convergence theorem, we deduce
Ff (z)2 = i i
œÄ

R
2f(t)H( f)(t)
z‚àít
dt .
(5.1.24)
We now let Imz ‚Üí0+ in (5.1.24) and use (5.1.19) in Theorem 5.1.5. We obtain
f 2 ‚àíH( f)2 +i2f H( f) =

f +iH( f)
2 = i

2fH( f)+iH

2fH( f)

,
and equating the real parts we deduce (5.1.23).
To give an alternative proof of (5.1.23) we take Fourier transforms. Let
m(Œæ) = ‚àíisgnŒæ

5.1 The Hilbert Transform and the Riesz Transforms
321
be the symbol of the Hilbert transform. We have
1f 2(Œæ)+2[H( fH( f))]1(Œæ)
= ( 1f ‚àó1f)(Œæ)+2m(Œæ)( 1f ‚àó
H( f))(Œæ)
=

R
1f(Œ∑) 1f(Œæ ‚àíŒ∑)dŒ∑ +2m(Œæ)

R
1f(Œ∑) 1f(Œæ ‚àíŒ∑)m(Œ∑)dŒ∑
(5.1.25)
=

R
1f(Œ∑) 1f(Œæ ‚àíŒ∑)dŒ∑ +2m(Œæ)

R
1f(Œ∑) 1f(Œæ ‚àíŒ∑)m(Œæ ‚àíŒ∑)dŒ∑. (5.1.26)
Averaging (5.1.25) and (5.1.26) we obtain
1f 2(Œæ)+2[H( fH( f))]1(Œæ) =

R
1f(Œ∑) 1f(Œæ ‚àíŒ∑)

1+m(Œæ)

m(Œ∑)+m(Œæ ‚àíŒ∑)

dŒ∑ .
But the last displayed expression is equal to

R
1f(Œ∑) 1f(Œæ ‚àíŒ∑)m(Œ∑)m(Œæ ‚àíŒ∑)dŒ∑ = (
H( f)‚àó
H( f))(Œæ)
in view of the identity
m(Œ∑)m(Œæ ‚àíŒ∑) = 1+m(Œæ)m(Œ∑)+m(Œæ)m(Œæ ‚àíŒ∑),
which is valid for all (Œæ,Œ∑) ‚ààR2 \{(0,0)} for the function m(Œæ) = ‚àíisgnŒæ.
Having established (5.1.23), we can easily obtain Lp bounds for H when p = 2k
is a power of 2. We already know that H is bounded on Lp with norm one when
p = 2k and k = 1. Suppose that H is bounded on Lp with bound cp for p = 2k for
some k ‚ààZ+. Then for a nonzero real-valued function f in C ‚àû
0 we have
H( f)

L2p =
H( f)2
1
2
Lp ‚â§
f 2
Lp +
2H( fH( f))

Lp
 1
2
‚â§
f
2
L2p +2cp
fH( f)

Lp
 1
2
‚â§
f
2
L2p +2cp
f

L2p
H( f)

L2p
 1
2 .
Since ‚à•H( f)‚à•L2p < ‚àû, we obtain that
H( f)

L2p
f

L2p
2
‚àí2cp
H( f)

L2p
f

L2p
‚àí1 ‚â§0.
If follows that
H( f)

L2p
f

L2p
‚â§cp +
!
c2p +1,
and from this we conclude that H is bounded on L2p with bound
c2p ‚â§cp +
!
c2p +1.
(5.1.27)

322
5 Singular Integrals of Convolution Type
This completes the induction. We have proved that H maps Lp to Lp when p = 2k,
k = 1,2,.... Interpolation now gives that H maps Lp to Lp for all p ‚â•2. Since
H‚àó= ‚àíH, duality gives that H is also bounded on Lp for 1 < p ‚â§2.
The previous proof of the boundedness of the Hilbert transform provides us with
some useful information about the norm of this operator on Lp(R). Let us begin
with the identity
cot x
2 = cotx+
"
1+cot2 x,
valid for 0 < x < œÄ
2 . If cp ‚â§cot œÄ
2p, then (5.1.27) gives that
c2p ‚â§cp +
!
c2p +1 ‚â§cot œÄ
2p +
=
1+cot2 œÄ
2p = cot
œÄ
2¬∑2p ,
and since 1 = cot œÄ
4 = cot œÄ
2¬∑2, we obtain by induction that the numbers cot œÄ
2p are
indeed bounds for the norm of H on Lp when p = 2k, k = 1,2,.... Duality now
gives that the numbers cot œÄ
2p‚Ä≤ = tan œÄ
2p are bounds for the norm of H on Lp when
p =
2k
2k‚àí1, k = 1,2,.... These bounds allow us to derive good estimates for the norm
‚à•H‚à•Lp‚ÜíLp as p ‚Üí1 and p ‚Üí‚àû. Indeed, since cot œÄ
2p ‚â§p when p ‚â•2, the Riesz‚Äì
Thorin interpolation theorem gives that ‚à•H‚à•Lp‚ÜíLp ‚â§2p for 2 ‚â§p < ‚àûand by du-
ality ‚à•H‚à•Lp‚ÜíLp ‚â§
2p
p‚àí1 for 1 < p ‚â§2. This completes the proof which is worth
comparing with that of Theorem 4.1.7.
‚ñ°
Remark 5.1.8. The numbers cot œÄ
2p for 2 ‚â§p < ‚àûand tan œÄ
2p for 1 < p ‚â§2 are
indeed equal to the norms of the Hilbert transform H on Lp(R). This requires a
more delicate argument; see Exercise 5.1.12.
Remark 5.1.9. We may wonder what happens when p = 1 or p = ‚àû. The Hilbert
transform of œá[a,b] computed in Example 5.1.3 is easily seen to be unbounded and not
integrable, since it behaves like 1/|x| as x ‚Üí‚àû. This behavior near inÔ¨Ånity suggests
that the Hilbert transform may map L1 to L1,‚àû. This is indeed the case, but this will
not be shown until Section 5.3.
We now introduce the maximal Hilbert transform.
DeÔ¨Ånition 5.1.10. The maximal Hilbert transform is the operator
H(‚àó)( f)(x) = sup
Œµ>0
H(Œµ)( f)(x)

(5.1.28)
deÔ¨Åned for all f in Lp, 1 ‚â§p < ‚àû. For such f, H(Œµ)( f) is well deÔ¨Åned as a convergent
integral by H¬®older‚Äôs inequality. Hence H(‚àó)( f) makes sense for f ‚ààLp(R), although
for some values of x, H(‚àó)( f)(x) may be inÔ¨Ånite.
Example 5.1.11. Using the result of Example 5.1.4, we obtain that
H(‚àó)(œá[a,b])(x) = 1
œÄ
log |x‚àía|
|x‚àíb|
.
(5.1.29)

5.1 The Hilbert Transform and the Riesz Transforms
323
We see that in general, H(‚àó)( f)(x) Ã∏= |H( f)(x)| by taking f to be the characteristic
function of the union of two disjoint closed intervals.
The deÔ¨Ånition of H gives that H(Œµ)( f) converges pointwise to H( f) whenever f
lies in C ‚àû
0 (R). If we have the estimate ‚à•H(‚àó)( f)‚à•Lp ‚â§Cp‚à•f‚à•Lp for f ‚ààLp(R), The-
orem 2.1.14 yields that H(Œµ)( f) converges to H( f) a.e. as Œµ ‚Üí0 for any f ‚ààLp. This
almost everywhere limit provides a way to describe H( f) for general f ‚ààLp(R).
Note that Theorem 5.1.7 implies only that H has a (unique) bounded extension on
Lp, but it does not provide a way to describe H( f) when f is a general Lp function.
The next theorem is a simple consequence of these ideas.
Theorem 5.1.12. There exists a constant C such that for all 1 < p < ‚àûwe have
H(‚àó)( f)

Lp ‚â§Cmax

p,(p‚àí1)‚àí2f

Lp .
(5.1.30)
Moreover, for all f in Lp(R), H(Œµ)( f) converges to H( f) a.e. and in Lp.
Proof. Another proof of this theorem is given in Theorem 4.2.4 in [131] in which
the asserted bound is improved.
Recall the kernels PŒµ and QŒµ deÔ¨Åned in (5.1.16) and (5.1.17). Fix 1 < p < ‚àûand
suppose momentarily that
f ‚àóQŒµ = H( f)‚àóPŒµ ,
Œµ > 0,
(5.1.31)
holds whenever f is an Lp function. Then we have
H(Œµ)( f) = H(Œµ)( f)‚àíf ‚àóQŒµ +H( f)‚àóPŒµ .
(5.1.32)
Using the identity
H(Œµ)( f)(x)‚àí( f ‚àóQŒµ)(x) = ‚àí1
œÄ

R f(x‚àít)œàŒµ(t)dt ,
(5.1.33)
where œà is as in (5.1.20), and applying Corollary 2.1.12, we obtain the estimate
sup
Œµ>0
|H(Œµ)( f)(x)‚àí( f ‚àóQŒµ)(x)| ‚â§1
œÄ
Œ®

L1M( f)(x),
(5.1.34)
where Œ® is as in (5.1.21) and M is the Hardy‚ÄìLittlewood maximal function. In view
of (5.1.32) and (5.1.34), we obtain for f ‚ààLp(Rn) that
|H(‚àó)( f)(x)| ‚â§
Œ®

L1M( f)(x)+M(H( f))(x).
(5.1.35)
It follows immediately from (5.1.35) that H(‚àó) is Lp bounded with norm at most
Cmax

p,(p‚àí1)‚àí2
.

324
5 Singular Integrals of Convolution Type
We now turn to the proof of (5.1.31). It sufÔ¨Åces to prove (5.1.31) for Schwartz
functions since, given f ‚ààLp there is a sequence œÜ j ‚ààS such that ‚à•f ‚àíœÜ j‚à•Lp ‚Üí0
as j ‚Üí‚àûand PŒµ, QŒµ lie in Lp‚Ä≤. Taking Fourier transforms, we see that (5.1.31) is a
consequence of the identity

(‚àíisgnŒæ)e‚àí2œÄ|Œæ|‚à®(x) = 1
œÄ
x
x2 +1 .
(5.1.36)
To prove (5.1.36) we write

(‚àíisgnŒæ)e‚àí2œÄ|Œæ|‚à®(x) =
 +‚àû
‚àí‚àûe‚àí2œÄ|Œæ|(‚àíisgnŒæ)e2œÄixŒæ dŒæ
= 2
 ‚àû
0 e‚àí2œÄŒæ sin(2œÄxŒæ)dŒæ
= 1
œÄ
 ‚àû
0 e‚àíŒæ sin(xŒæ)dŒæ
(5.1.37)
= 1
œÄ
 ‚àû
0 (e‚àíŒæ)‚Ä≤‚Ä≤ sin(xŒæ)dŒæ
= ‚àíx
œÄ
 ‚àû
0 (e‚àíŒæ)‚Ä≤ cos(xŒæ)dŒæ
= ‚àíx
œÄ

‚àí1+x
 ‚àû
0 e‚àíŒæ sin(xŒæ)dŒæ

(5.1.38)
and we equate (5.1.38) and (5.1.37).
The statement in the theorem about the almost everywhere convergence of
H(Œµ)( f) to H( f) is a consequence of (5.1.30), of the fact that the alleged conver-
gence holds for Schwartz functions, and of Theorem 2.1.14. Finally, the Lp conver-
gence follows from the almost everywhere convergence and the Lebesgue dominated
convergence theorem in view of the validity of (5.1.35).
‚ñ°
5.1.4 The Riesz Transforms
We now study an n-dimensional analogue of the Hilbert transform. It turns out that
there exist n operators in Rn, called the Riesz transforms, with properties analogous
to those of the Hilbert transform on R.
To deÔ¨Åne the Riesz transforms, we Ô¨Årst introduce tempered distributions Wj on
Rn, for 1 ‚â§j ‚â§n, as follows. For œï ‚ààS (Rn), let
4
Wj,œï
5
= Œì ( n+1
2 )
œÄ
n+1
2
lim
Œµ‚Üí0

|y|‚â•Œµ
yj
|y|n+1 œï(y)dy.
One should check that indeed Wj ‚ààS ‚Ä≤(Rn). Observe that the normalization of Wj
is similar to that of the Poisson kernel.

5.1 The Hilbert Transform and the Riesz Transforms
325
DeÔ¨Ånition 5.1.13. For 1 ‚â§j ‚â§n, the jth Riesz transform of f is given by convolution
with the distribution Wj, that is,
Rj( f)(x) = ( f ‚àóWj)(x) = Œì ( n+1
2 )
œÄ
n+1
2
p.v.

Rn
xj ‚àíyj
|x‚àíy|n+1 f(y)dy,
(5.1.39)
for all f ‚ààS (Rn). DeÔ¨Ånition 5.1.13 makes sense for any integrable function f that
has the property that for all x there exist Cx > 0, Œµx > 0, and Œ¥x > 0 such that for
y satisfying |y ‚àíx| < Œ¥x we have | f(x) ‚àíf(y)| ‚â§Cx|x ‚àíy|Œµx. The principal value
integral in (5.1.39) is as in DeÔ¨Ånition 5.1.1.
We now give a characterization of Rj using the Fourier transform. For this we
need to compute the Fourier transform of Wj.
Proposition 5.1.14. The jth Riesz transform Rj is given on the Fourier transform
side by multiplication by the function ‚àíiŒæ j/|Œæ|. That is, for any f in S (Rn) we
have
Rj( f)(x) =

‚àíiŒæ j
|Œæ|
1f(Œæ)
‚à®
(x).
(5.1.40)
Proof. The proof is essentially a reprise of the corresponding proof for the Hilbert
transform, but it involves a few technical difÔ¨Åculties. Fix a Schwartz function œï on
Rn. Then for 1 ‚â§j ‚â§n we have
42
Wj,œï
5
=
4
Wj, 1œï
5
(5.1.41)
= Œì ( n+1
2 )
œÄ
n+1
2
lim
Œµ‚Üí0

|Œæ|‚â•Œµ
1œï(Œæ)
Œæ j
|Œæ|n+1 dŒæ
= Œì ( n+1
2 )
œÄ
n+1
2
lim
Œµ‚Üí0

1
Œµ ‚â•|Œæ|‚â•Œµ

Rn œï(x)e‚àí2œÄix¬∑Œæ dx
Œæ j
|Œæ|n+1 dŒæ
= lim
Œµ‚Üí0

Rn œï(x)
)
Œì ( n+1
2 )
œÄ
n+1
2

1
Œµ ‚â•|Œæ|‚â•Œµ e‚àí2œÄix¬∑Œæ
Œæ j
|Œæ|n+1 dŒæ
*
dx
= lim
Œµ‚Üí0

Rn œï(x)
Œì ( n+1
2 )
œÄ
n+1
2

Sn‚àí1

Œµ‚â§r‚â§1
Œµ
e‚àí2œÄirx¬∑Œ∏
r
rn+1 rn‚àí1drŒ∏ jdŒ∏

dx
=

Rn œï(x)
)
‚àíiŒì ( n+1
2 )
œÄ
n+1
2

Sn‚àí1
 ‚àû
0 sin(2œÄrx¬∑Œ∏) dr
r Œ∏ j dŒ∏
*
dx
=

Rn œï(x)
)
‚àíiœÄ
2
Œì ( n+1
2 )
œÄ
n+1
2

Sn‚àí1 sgn(x¬∑Œ∏)Œ∏ j dŒ∏
*
dx
=

Rn ‚àíiœï(x) xj
|x|dx,

326
5 Singular Integrals of Convolution Type
where in the penultimate equality we used the identity
 ‚àû
0
sint
t dt = œÄ
2 , for which we
refer to Exercise 5.1.1, while in the last equality we used the identity
‚àíiœÄ
2
Œì ( n+1
2 )
œÄ
n+1
2

Sn‚àí1 sgn(x¬∑Œ∏)Œ∏ j dŒ∏ = ‚àíi xj
|x| ,
(5.1.42)
which needs to be established. The passage of the limit inside the integral in the
previous calculation is a consequence of the Lebesgue dominated convergence the-
orem, which is justiÔ¨Åed from the fact that

 1/Œµ
Œµ
sin(2œÄrŒ∏)
r
dr
 ‚â§4
(5.1.43)
for all Œµ > 0. For a proof of (5.1.43) we again refer to Exercise 5.1.1.
‚ñ°
It remains to establish (5.1.42). Let us recall that O(n) is the set of all orthogonal
n √ó n matrices with real entries. An invertible matrix A is called orthogonal if its
transpose At is equal to its inverse A‚àí1, that is, AAt = AtA = I.
Lemma 5.1.15. The following identity is valid for all Œæ ‚ààRn \{0}:

Sn‚àí1 sgn(Œæ ¬∑Œ∏)Œ∏ j dŒ∏ = 2œÄ
n‚àí1
2
Œì ( n+1
2 )
Œæ j
|Œæ| .
(5.1.44)
Therefore (5.1.42) holds.
Proof. We begin with the identity

Sn‚àí1 sgn(Œ∏k)Œ∏ j dŒ∏ =
‚éß
‚é™
‚é™
‚é®
‚é™
‚é™
‚é©
0
if k Ã∏= j,

Sn‚àí1 |Œ∏ j|dŒ∏
if k = j,
(5.1.45)
which can be proved by noting that for k Ã∏= j, sgn(Œ∏k) has a constant sign on the
hemispheres Œ∏k > 0 and Œ∏k < 0, on either of which the function Œ∏ ‚ÜíŒ∏ j has integral
zero.
It sufÔ¨Åces to prove (5.1.44) for a unit vector Œæ. Given Œæ ‚ààSn‚àí1, pick an orthogonal
n√ón matrix A = (akl)k,l such that Aej = Œæ. Then the jth column of the matrix A is
the vector (Œæ1,Œæ2,...,Œæn)t. We have

Sn‚àí1 sgn(Œæ ¬∑Œ∏)Œ∏ j dŒ∏ =

Sn‚àí1 sgn(Aej ¬∑Œ∏)Œ∏ j dŒ∏
=

Sn‚àí1 sgn(ej ¬∑AtŒ∏)(AAtŒ∏) j dŒ∏
=

Sn‚àí1 sgn(ej ¬∑Œ∏)(AŒ∏) j dŒ∏
=

Sn‚àí1 sgn(Œ∏ j)(aj1Œ∏1 +¬∑¬∑¬∑+Œæ jŒ∏ j +¬∑¬∑¬∑+ajnŒ∏n)dŒ∏

5.1 The Hilbert Transform and the Riesz Transforms
327
= Œæ j

Sn‚àí1 sgn(Œ∏ j)Œ∏ j dŒ∏ +
‚àë
1‚â§mÃ∏= j‚â§n
0
= Œæ j
|Œæ|

Sn‚àí1 |Œ∏ j|dŒ∏ .
Next, for all j ‚àà{1,2,...,n}, we compute the value of the integral

Sn‚àí1 |Œ∏ j|dŒ∏ =

Sn‚àí1 |Œ∏1|dŒ∏ ,
which is obviously independent of j by symmetry. In view of the result of Appendix
D.2, we write

Sn‚àí1 |Œ∏1|dŒ∏ =
 1
‚àí1 |s|

‚àö
1‚àís2 Sn‚àí2 dœï
ds
(1‚àís2)
1
2
= œân‚àí2
 1
‚àí1 |s|(1‚àís2)
n‚àí3
2 ds
= œân‚àí2
 1
0 u
n‚àí3
2 du
= 2œân‚àí2
n‚àí1
=
2œÄ
n‚àí1
2
Œì ( n‚àí1
2 ) n‚àí1
2
= 2œÄ
n‚àí1
2
Œì ( n+1
2 ) ,
having used the expression for œân‚àí2 in Appendix A.3. This proves (5.1.44). The
proof of the lemma and hence that of Proposition 5.1.14 is complete.
‚ñ°
Proposition 5.1.16. The Riesz transforms satisfy
‚àíI =
n
‚àë
j=1
R2
j ,
on L2(Rn),
(5.1.46)
where I is the identity operator.
Proof. Use the Fourier transform and the identity ‚àën
j=1(‚àíiŒæ j/|Œæ|)2 = ‚àí1 to obtain
that ‚àën
j=1 R2
j( f) = ‚àíf for any f in L2(Rn).
‚ñ°
We can express the mixed derivatives of Schwartz function in terms of its Lapla-
cian using the Riesz transforms.

328
5 Singular Integrals of Convolution Type
Proposition 5.1.17. For œï in S (Rn) and 1 ‚â§j,k ‚â§n we have
‚àÇj‚àÇkœï(x) = ‚àíRjRkŒîœï(x)
(5.1.47)
for all x ‚ààRn.
Proof. We verify the claimed identity by taking Fourier transforms. We have

‚àÇj‚àÇkœï
1(Œæ) = (2œÄiŒæ j)(2œÄiŒæk)1œï(Œæ)
= ‚àí

‚àíiŒæ j
|Œæ|

‚àíiŒæk
|Œæ|

(‚àí4œÄ2|Œæ|2)1œï(Œæ)
= ‚àí

RjRkŒîœï
1(Œæ)
and taking the inverse Fourier transform, identity (5.1.47) follows.
‚ñ°
Next we discuss a use of the Riesz transforms to partial differential equations.
Example 5.1.18. Suppose that f is a given function in L2(Rn) and that u is a tem-
pered distribution on Rn that solves Laplace‚Äôs equation
Œîu = f .
(5.1.48)
We express all second-order derivatives of u in terms of the Riesz transforms of f.
To solve equation (5.1.48) we Ô¨Årst show that the tempered distribution

‚àÇj‚àÇku+RjRk( f)
1
is supported at {0}. In view of Proposition 2.4.1, this implies that
‚àÇj‚àÇku = ‚àíRjRk( f)+P
where P is a polynomial of n variables (that depends on j and k) and provides a way
to express the mixed partials of u in terms of the Riesz transforms of f.
To verify that

‚àÇj‚àÇku+RjRk( f)

1 is supported at {0}, we Ô¨Åx a Schwartz function
œà whose support does not contain the origin. Then œà vanishes in a neighborhood
of zero and we can pick C ‚àûfunction Œ∑ which vanishes in a smaller neighborhood
of zero and is equal to 1 on the support of œà. We deÔ¨Åne
Œ∂(Œæ) = ‚àíŒ∑(Œæ)

‚àíiŒæ j
|Œæ|

‚àíiŒæk
|Œæ|

and we notice that Œ∂ is a bounded C ‚àûfunction and so are all of its derivatives; also
Œ∑(Œæ)(2œÄiŒæ j)(2œÄiŒæk) = Œ∂(Œæ)(‚àí4œÄ2|Œæ|2).
Taking the Fourier transform of both sides of (5.1.48) we obtain
(‚àí4œÄ2|Œæ|2) 1u(Œæ) = 1f(Œæ)

5.1 The Hilbert Transform and the Riesz Transforms
329
and multiplying by Œ∂ (which is allowed since all derivatives of Œ∂ lie in L‚àû‚à©C ‚àû)
Œ∂(Œæ)(‚àí4œÄ2|Œæ|2) 1u = Œ∂(Œæ) 2
Œîu = Œ∂(Œæ) 1f(Œæ).
It follows that for all 1 ‚â§j,k ‚â§n we have
4
(‚àÇj‚àÇku)1,œà
5
=
4
(2œÄiŒæ j)(2œÄiŒæk)1u,œà
5
=
4
(2œÄiŒæ j)(2œÄiŒæk)1u,Œ∑œà
5
=
4
Œ∑(Œæ)(2œÄiŒæ j)(2œÄiŒæk)1u,œà
5
=
4
Œ∂(Œæ)(‚àí4œÄ2|Œæ|2)1u,œà
5
=
4
Œ∂(Œæ) 1f(Œæ),œà
5
=
4
‚àíŒ∑(Œæ)

‚àíiŒæ j
|Œæ|

‚àíiŒæk
|Œæ|
 1f(Œæ),œà
5
=
4
‚àíŒ∑(Œæ)(RjRk( f))1(Œæ),œà
5
= ‚àí
4
(RjRk( f))1,Œ∑œà
5
= ‚àí
4
(RjRk( f))1,œà
5
and since this holds for all Schwartz functions œà whose support does not contain
the origin, it follows that

‚àÇj‚àÇku+RjRk( f)

1 is supported at {0}.
Exercises
5.1.1. (a) Show that for all 0 < a < b < ‚àûwe have

 b
a
sinx
x
dx
 ‚â§4.
(b) For a > 0 deÔ¨Åne
I(a) =
 ‚àû
0
sinx
x e‚àíax dx
and show that I(a) is continuous at zero. Differentiate in a and look at the behavior
of I(a) as a ‚Üí‚àûto obtain the identity
I(a) = œÄ
2 ‚àíarctan(a).
Deduce that I(0) = œÄ
2 and also derive the following identity used in (5.1.10):
 +‚àû
‚àí‚àû
sin(bx)
x
dx = œÄ sgn(b).

330
5 Singular Integrals of Convolution Type
(c) Argue as in part (b) to prove for a ‚â•0 the identity
 ‚àû
0
1‚àícosx
x2
e‚àíax dx = œÄ
2 ‚àíarctan(a)+alog
a
‚àö
1+a2 .

Hint: Part (a): Consider the cases b ‚â§1, a ‚â§1 ‚â§b, 1 ‚â§a. When a ‚â•1, integrate
by parts.

5.1.2. (a) Let œï be a compactly supported C m+1 function on R for some m in
Z+ {0}. Prove that if œï(m) is the mth derivative of œï, then
|H(œï(m))(x)| ‚â§Cm,œï (1+|x|)‚àím‚àí1
for some Cm,œï > 0.
(b) Let œï be a compactly supported C m+1 function on Rn for some m ‚ààZ+. Show
that
|Rj(‚àÇŒ±œï)(x)| ‚â§Cn,m,œï (1+|x|)‚àín‚àím
for some Cn,m,œï > 0 and all multi-indices Œ± with |Œ±| = m.
(c) Let I be an interval on the line and assume that a function h is equal to 1 on the
left half of I, is equal to ‚àí1 on the right half of I, and vanishes outside I. Prove that
for x /‚àà2I we have
|H(h)(x)| ‚â§4|I|2|x‚àícenter(I)|‚àí2 .

Hint: Use that when |t| ‚â§1
2 we have log(1+t) = t +R1(t), where |R1(t)| ‚â§2|t|2.

5.1.3. (a) Using identity (5.1.13) one may deÔ¨Åne H( f) as an element of S ‚Ä≤(R) for
bounded functions f on the line whose Fourier transform vanishes in a neighbor-
hood of the origin. Using this interpretation, prove that
H(eix) = ‚àíieix ,
H(cosx) = sinx,
H(sinx) = ‚àícosx,
H(sin(œÄx)/œÄx) = (1‚àícos(œÄx))/œÄx.
(b) Show that the operators given by convolution with the smooth function sin(t)/t
and the distribution p.v. cos(t)/t are bounded on Lp(R) whenever 1 < p < ‚àû.

Hint: Use that the Fourier transform of the distribution eix is Œ¥1/2œÄ.

5.1.4. ([347]) Show that the distribution function of the Hilbert transform of the
characteristic function of a measurable subset E of the real line of Ô¨Ånite measure is
dH(œáE)(Œ±) =
4|E|
eœÄŒ± ‚àíe‚àíœÄŒ± ,
Œ± > 0.

Hint: First take E = N
j=1(aj,bj), where bj < aj+1. Show that the equation
H(œáE)(x) = Œ± has exactly one root œÅ j in each open interval (aj,bj) for 1 ‚â§j ‚â§N
and exactly one root r j in each interval (bj,aj+1) for 1 ‚â§j ‚â§N, (aN+1 = ‚àû). Then

5.1 The Hilbert Transform and the Riesz Transforms
331
|{x ‚ààR : H(œáE)(x) > Œ±}| = ‚àëN
j=1 r j ‚àí‚àëN
j=1 œÅ j, and this can be expressed in terms
of ‚àëN
j=1 aj and ‚àëN
j=1 bj. Argue similarly for the set {x ‚ààR : H(œáE)(x) < ‚àíŒ±}. For a
general measurable set E, Ô¨Ånd sets En such that each En is a Ô¨Ånite union of intervals
and that œáEn ‚ÜíœáE in L2. Then H(œáEn) ‚ÜíH(œáE) in measure; thus H(œáEnk ) ‚ÜíH(œáE)
a.e. for some subsequence nk. The Lebesgue dominated convergence theorem gives
dH(œáEnk ) ‚ÜídH(œáE). See Figure 5.1.

5.1.5. Let 1 ‚â§p < ‚àûand let T be a linear operator deÔ¨Åned on the space of Schwartz
functions that commutes with dilations, i.e., T(Œ¥ Œª f) = Œ¥ ŒªT( f) for all f ‚ààS (Rn)
and all Œª > 0. (Here Œ¥ Œª( f)(x) = f(Œªx).) Suppose that there exists a constant C > 0
such that for all f ‚ààS (Rn) with Lp norm one we have
|{x : |T( f)(x)| > 1}| ‚â§C.
Prove that T admits a bounded extension from Lp(Rn) to Lp,‚àû(Rn) with norm at
most C1/p.

Hint: Try functions of the form Œª ‚àín/p f(Œª ‚àí1x)/‚à•f‚à•Lp with Œª > 0.

5.1.6. Let œï be in S (R). Prove that
lim
N‚Üí‚àûp.v.

R
e2œÄiNx
x
œï(x)dx = œï(0)œÄi,
lim
N‚Üí‚àí‚àûp.v.

R
e2œÄiNx
x
œï(x)dx = ‚àíœï(0)œÄi.
5.1.7. Let TŒ±, Œ± ‚ààR, be the operator given by convolution with the distribution
whose Fourier transform is the function
uŒ±(Œæ) = e‚àíœÄiŒ± sgnŒæ .
(a) Show that the TŒ±‚Äôs are isometries on L2(R) that satisfy
(TŒ±)‚àí1 = T2‚àíŒ± .
(b) Express TŒ± in terms of the identity operator and the Hilbert transform.
5.1.8. Let Q( j)
y
be the jth conjugate Poisson kernel of Py deÔ¨Åned by
Q( j)
y (x) = Œì ( n+1
2 )
œÄ
n+1
2
xj
(|x|2 +y2)
n+1
2
.
Prove that
(Q( j)
y )‚àß(Œæ) = ‚àíi Œæ j
|Œæ|e‚àí2œÄy|Œæ| .
Conclude that Rj(Py) = Q( j)
y
and that for f in L2(Rn) we have Rj( f)‚àóPy = f ‚àóQ( j)
y .
These results are analogous to the statements 2
Qy(Œæ) = ‚àíisgn(Œæ) 1Py(Œæ), H(Py) = Qy,
and H( f)‚àóPy = f ‚àóQy.

332
5 Singular Integrals of Convolution Type
5.1.9. Fix n ‚â•2. Let f0, f1,..., fn be in L2(Rn) and, for 0 ‚â§j ‚â§n, let uj(x,x0) =
(Px0 ‚àóf j)(x) be the Poisson integrals of f j where x = (x1,...,xn) ‚ààRn and x0 > 0.
Show that a necessary and sufÔ¨Åcient condition for
f j = Rj( f0),
j = 1,...,n,
is that the following system of generalized Cauchy-Riemann equations holds:
n
‚àë
j=0
‚àÇuj
‚àÇxj
(x,x0) = 0,
‚àÇuj
‚àÇxk
(x,x0) = ‚àÇuk
‚àÇxj
(x,x0),
0 ‚â§j Ã∏= k ‚â§n.
5.1.10. Prove the distributional identity
‚àÇj|x|‚àín+1 = (1‚àín)p.v.
xj
|x|n+1 .
Then take Fourier transforms of both sides and use Theorem 2.4.6 to obtain another
proof of Proposition 5.1.14.
5.1.11. (a) Prove that if T is a bounded linear operator on L2(R) that commutes
with translations and dilations and anticommutes with the reÔ¨Çection f(x) ‚Üí#f(x) =
f(‚àíx), then T is a constant multiple of the Hilbert transform.
(b) Prove that if T is a bounded linear operator on L2(R) that commutes with transla-
tions and dilations and vanishes when applied to functions whose Fourier transform
is supported in [0,‚àû), then T is a constant multiple of the operator f ‚Üí
 1f œá(‚àí‚àû,0]
‚à®.
5.1.12. ([282]) Fix 1 < p ‚â§2.
(a) Show that the function G(x,y) = Re (|x|+iy)p is subharmonic on R2.
(b) Let u(x,y),v(x,y) be real-valued functions on R2 such that u + iv is a holomor-
phic function of x+iy. Prove that G(u,v) is a subharmonic function on R2.
(c) Prove that there is a constant Bp such that for all a and b reals we have
|b|p ‚â§

tan œÄ
2p
p
|a|p ‚àíBp Re (|a|+ib)p .
(d) Prove that for f in C ‚àû
0 (R) we have

R Re (| f(x)|+iH( f)(x))p dx ‚â•0.
(e) Combine the results in parts (d) and (c) with a = f(x), b = H( f)(x) to obtain
that
H

Lp‚ÜíLp ‚â§tan œÄ
2p .

5.2 Singular Integrals and the Method of Rotations
333
(f) To deduce that this constant is sharp, take œÄ/2p‚Ä≤ < Œ≥ < œÄ/2p and let fŒ≥(x) =
(x+1)‚àí1|x+1|2Œ≥/œÄ|x‚àí1|‚àí2Œ≥/œÄ cosŒ≥. Then
H( fŒ≥)(x) =
‚éß
‚é®
‚é©
1
x+1
|x+1|
|x‚àí1|
2Œ≥/œÄ sinŒ≥
when |x| > 1,
‚àí1
x+1
|x+1|
|x‚àí1|
2Œ≥/œÄ sinŒ≥
when |x| < 1.

Hint: Part (d): Let CR be the circle of radius R centered at (0,R) in R2. Use that
the integral of the subharmonic function G((Py ‚àóf)(x),Qy ‚àóf)(x)) over CR is at
least 2œÄRRe (|(PR ‚àóf)(0)|+i(QR ‚àóf)(0))p and let R ‚Üí‚àû. Part (f): The formula for
H( fŒ≥) is best derived by considering the restriction of the analytic function
F(z) = (z+1)‚àí1
iz+i
z‚àí1
2Œ≥/œÄ
on the real line.

5.2 Homogeneous Singular Integrals and the Method
of Rotations
So far we have introduced the Hilbert and the Riesz transforms and we have de-
rived the Lp boundedness of the former. The boundedness properties of the Riesz
transforms on Lp spaces are consequences of the results discussed in this section.
5.2.1 Homogeneous Singular and Maximal Singular Integrals
We introduce singular integral operators on Rn that appropriately generalize the
Riesz transforms on Rn. Here is the setup. We Ô¨Åx Œ© to be an integrable function of
the unit sphere Sn‚àí1 with mean value zero. Observe that the kernel
KŒ©(x) = Œ©(x/|x|)
|x|n
,
x Ã∏= 0,
(5.2.1)
is homogeneous of degree ‚àín just like the functions xj/|x|n+1. Since KŒ© is not
in L1(Rn), convolution with KŒ© cannot be deÔ¨Åned as an operation on Schwartz
functions on Rn. For this reason we introduce a distributionWŒ© in S ‚Ä≤(Rn) by setting
4
WŒ©,œï
5
= lim
Œµ‚Üí0

|x|‚â•Œµ KŒ©(x)œï(x)dx = lim
Œµ‚Üí0

Œµ‚â§|x|‚â§Œµ‚àí1 KŒ©(x)œï(x)dx
(5.2.2)

334
5 Singular Integrals of Convolution Type
for œï ‚ààS (Rn). Using the fact that Œ© has mean value zero, we can easily see that
WŒ© is a well deÔ¨Åned tempered distribution on Rn. Indeed, since KŒ© has integral zero
over all annuli centered at the origin, we have
4
WŒ©,œï
5 =
lim
Œµ‚Üí0

Œµ‚â§|x|‚â§1
Œ©(x/|x|)
|x|n
(œï(x)‚àíœï(0))dx+

|x|‚â•1
Œ©(x/|x|)
|x|n
œï(x)dx

‚â§
‚àáœï

L‚àû

|x|‚â§1
|Œ©(x/|x|)|
|x|n‚àí1
dx+ sup
y‚ààRn |y||œï(y)|

|x|‚â•1
|Œ©(x/|x|)|
|x|n+1
dx
‚â§C1
‚àáœï

L‚àû
Œ©

L1 +C2 ‚àë
|Œ±|‚â§1
œï(x)xŒ±
L‚àû
Œ©

L1,
for suitable C1 and C2, where we used (2.2.2) in the last estimate. Note that the
distribution WŒ© coincides with the function KŒ© on Rn \{0}.
The Hilbert transform and the Riesz transforms are examples of these general
operators TŒ©. For instance, the function Œ©(Œ∏) =
Œ∏
œÄ|Œ∏| = 1
œÄ sgnŒ∏ deÔ¨Åned on the unit
sphere S0 = {‚àí1,1} ‚´ÖR gives rise to the Hilbert transform, while the function
Œ©(Œ∏) = Œì ( n+1
2 )
œÄ
n+1
2
Œ∏ j
|Œ∏|
deÔ¨Åned on Sn‚àí1 ‚´ÖRn gives rise to the jth Riesz transform.
DeÔ¨Ånition 5.2.1. Let Œ© be integrable on the sphere Sn‚àí1 with mean value zero. For
0 < Œµ < N and f ‚àà
1‚â§p<‚àûLp(Rn) we deÔ¨Åne the truncated singular integral
T (Œµ,N)
Œ©
( f)(x) =

Œµ‚â§|y|‚â§N f(x‚àíy) Œ©(y/|y|)
|y|n
dy.
(5.2.3)
Note that for f ‚ààLp(Rn) we have
T (Œµ,N)
Œ©
( f)

Lp ‚â§
Œ©

L1 log(N/Œµ)
f

Lp(Rn) ,
which implies that (5.2.3) is Ô¨Ånite a.e. and therefore well deÔ¨Åned. We denote by TŒ©
the singular integral operator whose kernel is the distribution WŒ©, that is,
TŒ©( f)(x) = ( f ‚àóWŒ©)(x) = lim
Œµ‚Üí0
N‚Üí‚àû
T (Œµ,N)
Œ©
( f)(x),
deÔ¨Åned for f ‚ààS (Rn). The associated maximal singular integral is deÔ¨Åned by
T (‚àó‚àó)
Œ©
( f) =
sup
0<N<‚àû
sup
0<Œµ<N
T (Œµ,N)
Œ©
( f)
.
(5.2.4)

5.2 Singular Integrals and the Method of Rotations
335
We note that if Œ© is bounded, there is no need to use the upper truncations in
the deÔ¨Ånition of T (Œµ,N)
Œ©
given in (5.2.3). In this case the maximal singular integrals
could be deÔ¨Åned as
T (‚àó)
Œ© ( f) = sup
Œµ>0
T (Œµ)
Œ© ( f)
,
(5.2.5)
where for f ‚àà
1‚â§p<‚àûLp(R), Œµ > 0, and x ‚ààRn, T (Œµ)
Œ© ( f)(x) is deÔ¨Åned in terms of
the absolutely convergent integral
T (Œµ)
Œ© ( f)(x) =

|y|‚â•Œµ f(x‚àíy)Œ©(y/|y|)
|y|n
dy.
To examine the relationship between T (‚àó)
Œ©
and T (‚àó‚àó)
Œ©
for Œ© ‚ààL‚àû(Sn‚àí1), notice that


Œµ‚â§|y|‚â§N f(x‚àíy)Œ©(y/|y|)
|y|n
dy
 ‚â§
sup
0<N<‚àû
T (Œµ,N)
Œ©
( f)(x)
.
(5.2.6)
Then for f ‚ààLp(Rn), 1 ‚â§p < ‚àû, we let N ‚Üí‚àûon the left in (5.2.6) and we note
that the limit exists in view of the absolute convergence of the integral. Then we
take the supremum over Œµ > 0 to deduce that T (‚àó)
Œ©
is pointwise bounded by T (‚àó‚àó)
Œ©
.
Since T (Œµ,N)
Œ©
= T (Œµ)
Œ©
‚àíT (N)
Œ© , it also follows that T (‚àó‚àó)
Œ©
‚â§2T (‚àó)
Œ© ; thus T (‚àó)
Œ©
and T (‚àó‚àó)
Œ©
are pointwise comparable when Œ© lies in L‚àû(Sn‚àí1). This is the case with the Hilbert
transform, that is, H(‚àó‚àó) is comparable to H(‚àó); likewise with the Riesz transforms.
A certain class of multipliers can be realized as singular integral operators of the
kind discussed. Recall from Proposition 2.4.7 that if m is homogeneous of degree 0
and inÔ¨Ånitely differentiable on the sphere, then m‚à®is given by
m‚à®= cŒ¥0 +WŒ©,
for some complex constant c and some smooth Œ© on Sn‚àí1 with mean value zero.
Therefore, all convolution operators whose multipliers are homogeneous of degree
zero smooth functions on Sn‚àí1 can be realized as a constant multiple of the identity
plus an operator of the form TŒ©.
Example 5.2.2. Let P(Œæ) = ‚àë|Œ±|=k bŒ±Œæ Œ± be a homogeneous polynomial of degree
k in Rn that vanishes only at the origin. Let Œ± be a multi-index of order k. Then the
function
m(Œæ) = Œæ Œ±
P(Œæ)
(5.2.7)
is inÔ¨Ånitely differentiable on the sphere and homogeneous of degree zero. The oper-
ator given by multiplication on the Fourier transform by m(Œæ) is a constant multiple
of the identity plus an operator given by convolution with a distribution of the form
WŒ© for some Œ© in C ‚àû(Sn‚àí1) with mean value zero. In this section we establish
the Lp boundedness of such operators when Œ© has appropriate smoothness on the
sphere. This, in particular, implies that m(Œæ) deÔ¨Åned by (5.2.7) lies in the space
Mp(Rn), deÔ¨Åned in Section 2.5, for 1 < p < ‚àû.

336
5 Singular Integrals of Convolution Type
5.2.2 L2 Boundedness of Homogeneous Singular Integrals
Next we would like to compute the Fourier transform of WŒ©. This provides infor-
mation as to whether the operator given by convolution with KŒ© is L2 bounded. We
have the following result.
Proposition 5.2.3. Let n ‚â•2 and Œ© ‚ààL1(Sn‚àí1) have mean value zero. Then the
Fourier transform of WŒ© is a (Ô¨Ånite a.e.) function given by the formula
2
WŒ©(Œæ) =

Sn‚àí1 Œ©(Œ∏)

log
1
|Œæ ¬∑Œ∏| ‚àíiœÄ
2 sgn (Œæ ¬∑Œ∏)

dŒ∏ .
(5.2.8)
Remark 5.2.4. We need to show that the function of Œæ on the right in (5.2.8) is well
deÔ¨Åned and Ô¨Ånite for almost all Œæ in Rn. Write Œæ = |Œæ|Œæ ‚Ä≤ where Œæ ‚Ä≤ ‚ààSn‚àí1 and notice
that
log
1
|Œæ ¬∑Œ∏| = log 1
|Œæ| +log
1
|Œæ ‚Ä≤ ¬∑Œ∏| .
Since Œ© has mean value zero, the term log 1
|Œæ| multiplied by Œ©(Œ∏) vanishes when
integrated over the sphere.
We need to show that

Sn‚àí1 |Œ©(Œ∏)|log
1
|Œæ ‚Ä≤ ¬∑Œ∏| dŒ∏ < ‚àû
(5.2.9)
for almost all Œæ ‚Ä≤ ‚ààSn‚àí1. Integrate (5.2.9) over Œæ ‚Ä≤ ‚ààSn‚àí1 and apply Fubini‚Äôs theorem
to obtain

Sn‚àí1 |Œ©(Œ∏)|

Sn‚àí1 log
1
|Œæ ‚Ä≤ ¬∑Œ∏| dŒæ ‚Ä≤ dŒ∏
=

Sn‚àí1 |Œ©(Œ∏)|

Sn‚àí1 log 1
|Œæ1| dŒæ dŒ∏
= œân‚àí2

Sn‚àí1 |Œ©(Œ∏)|
 +1
‚àí1

log 1
|s|

(1‚àís2)
n‚àí3
2 dsdŒ∏
= Cn
Œ©

L1(Sn‚àí1) < ‚àû,
since we are assuming that n ‚â•2. (The second-to-last identity follows from the
identity in Appendix D.2.) We conclude that (5.2.9) holds for almost all Œæ ‚Ä≤ ‚ààSn‚àí1.
Since the function of Œæ on the right in (5.2.8) is homogeneous of degree zero, it
follows that it is a locally integrable function on Rn.
Before we return to the proof of Proposition 5.2.3, we discuss the following
lemma:
Lemma 5.2.5. Let a be a nonzero real number. Then for 0 < Œµ < N < ‚àûwe have
lim
Œµ‚Üí0
N‚Üí‚àû
 N
Œµ
cos(ra)‚àícos(r)
r
dr = log 1
|a| ,
(5.2.10)

5.2 Singular Integrals and the Method of Rotations
337

 N
Œµ
cos(ra)‚àícos(r)
r
dr
 ‚â§2
log 1
|a|

for all N > Œµ > 0,
(5.2.11)
lim
Œµ‚Üí0
N‚Üí‚àû
 N
Œµ
e‚àíira ‚àícos(r)
r
dr = log 1
|a| ‚àíiœÄ
2 sgn a,
(5.2.12)

 N
Œµ
e‚àíira ‚àícos(r)
r
dr
 ‚â§2
log 1
|a|
+4
for all N > Œµ > 0.
(5.2.13)
Proof. We Ô¨Årst prove (5.2.10) and (5.2.11). By the fundamental theorem of calculus
we write
 N
Œµ
cos(ra)‚àícos(r)
r
dr =
 N
Œµ
cos(r|a|)‚àícos(r)
r
dr
= ‚àí
 N
Œµ
 |a|
1
sin(tr)dt dr
= ‚àí
 |a|
1
 N
Œµ sin(tr)drdt
= ‚àí
 |a|
1
cos(Œµt)
t
dt +
 N|a|
N
cos(t)
t
dt ,
and from this expression, we clearly obtain (5.2.11). But the Ô¨Årst integral of the
same expression converges to ‚àílog|a| as Œµ ‚Üí0 while the second integral converges
to zero as N ‚Üí‚àûby an integration by parts. This proves (5.2.10).
To prove (5.2.12) and (5.2.13) we need to know that the expressions

 N
Œµ
sin(ra)
r
dr
 =

 N|a|
Œµ|a|
sin(r)
r
dr

(5.2.14)
tend to œÄ
2 as Œµ ‚Üí0 and N ‚Üí‚àûand are bounded by 4. Both statements follow from
Exercise 5.1.1.
‚ñ°
Let us now prove Proposition 5.2.3.
Proof. Let us set Œæ ‚Ä≤ = Œæ/|Œæ|. We have the following:
4 2
WŒ©,œï
5
=
4
WŒ©, 1œï
5
= lim
Œµ‚Üí0

|x|‚â•Œµ
Œ©(x/|x|)
|x|n
1œï(x)dx
= lim
Œµ‚Üí0
N‚Üí‚àû

Œµ‚â§|x|‚â§N
Œ©(x/|x|)
|x|n
1œï(x)dx
= lim
Œµ‚Üí0
N‚Üí‚àû

Rn œï(Œæ)

Œµ‚â§|x|‚â§N
Œ©(x/|x|)
|x|n
e‚àí2œÄix¬∑Œæ dx dŒæ
= lim
Œµ‚Üí0
N‚Üí‚àû

Rn œï(Œæ)

Sn‚àí1 Œ©(Œ∏)

Œµ‚â§r‚â§N
e‚àí2œÄirŒ∏¬∑Œæ dr
r dŒ∏ dŒæ

338
5 Singular Integrals of Convolution Type
= lim
Œµ‚Üí0
N‚Üí‚àû

Rn œï(Œæ)

Sn‚àí1 Œ©(Œ∏)

Œµ‚â§r‚â§N

e‚àí2œÄr|Œæ|iŒ∏¬∑Œæ ‚Ä≤ ‚àícos(2œÄr|Œæ|)
dr
r dŒ∏ dŒæ
= lim
Œµ‚Üí0
N‚Üí‚àû

Rn œï(Œæ)

Sn‚àí1 Œ©(Œ∏)

Œµ
2œÄ|Œæ| ‚â§r‚â§
N
2œÄ|Œæ|
e‚àíirŒ∏¬∑Œæ ‚Ä≤ ‚àícos(r)
r
drdŒ∏ dŒæ
=

Rn œï(Œæ)

Sn‚àí1 Œ©(Œ∏)

log
1
|Œæ ‚Ä≤ ¬∑Œ∏| ‚àíiœÄ
2 sgn(Œæ ¬∑Œ∏)

dŒ∏ dŒæ,
where we used the Lebesgue dominated convergence theorem to pass the limit in-
side, Lemma 5.2.5, and Remark 5.2.4. We were able to subtract cos(2œÄr|Œæ|) from
the r integral in the previous calculation, since Œ© has mean value zero over the
sphere. Also, the use of the dominated convergence theorem is justiÔ¨Åed from the
fact that the function
(Œ∏,Œæ) ‚Üí|Œ©(Œ∏)||œï(Œæ)|

log
1
|Œæ ‚Ä≤ ¬∑Œ∏| +4

lies in L1(Sn‚àí1 √ó Rn). Moreover, all the interchanges of integrals are well justiÔ¨Åed
by Fubini‚Äôs theorem.
‚ñ°
Corollary 5.2.6. Let Œ© ‚ààL1(Sn‚àí1) have mean value zero. Then for almost all Œæ ‚Ä≤ in
Sn‚àí1 the integral

Sn‚àí1 Œ©(Œ∏)log
1
|Œæ ‚Ä≤ ¬∑Œ∏|dŒ∏
(5.2.15)
converges absolutely. Moreover, the associated operator TŒ© maps L2(Rn) to itself if
and only if
ess.sup
Œæ ‚Ä≤‚ààSn‚àí1


Sn‚àí1 Œ©(Œ∏)log
1
|Œæ ‚Ä≤ ¬∑Œ∏|dŒ∏
 < ‚àû.
(5.2.16)
Proof. To obtain the absolute convergence of the integral in (5.2.15) we integrate
over Œæ ‚Ä≤ ‚ààSn‚àí1 and we apply Fubini‚Äôs theorem. The assertion concerning the bound-
edness of TŒ© on L2 is an immediate consequence of Proposition 5.2.3 and Theorem
2.5.10.
‚ñ°
There exist functions Œ© in L1(Sn‚àí1) with mean value zero such that the ex-
pressions in (5.2.16) are equal to inÔ¨Ånity; consequently, not all such Œ© give rise
to bounded operators on L2(Rn). Observe, however, that for Œ© odd i.e., Œ©(‚àíŒ∏) =
‚àíŒ©(Œ∏) for all Œ∏ ‚ààSn‚àí1, (5.2.16) trivially holds, since log
1
|Œæ¬∑Œ∏| is even and its prod-
uct against an odd function must have integral zero over Sn‚àí1. We conclude that
singular integrals TŒ© with odd Œ© are always L2 bounded.

5.2 Singular Integrals and the Method of Rotations
339
5.2.3 The Method of Rotations
Having settled the issue of L2 boundedness for singular integrals of the form TŒ© with
Œ© odd, we turn our attention to their Lp boundedness. A simple procedure called the
method of rotations plays a crucial role in the study of operators TŒ© when Œ© is an
odd function. This method is based on the use of the directional Hilbert transforms.
Fix a unit vector Œ∏ in Rn. For a Schwartz function f on Rn let
HŒ∏( f)(x) = 1
œÄ p.v.
 +‚àû
‚àí‚àûf(x‚àítŒ∏)dt
t .
(5.2.17)
We call HŒ∏( f) the directional Hilbert transform of f in the direction Œ∏. For func-
tions f ‚ààS (Rn) the integral in (5.2.17) is well deÔ¨Åned, since it converges rapidly at
inÔ¨Ånity and by subtracting the constant f(x), it also converges near zero.
Likewise, we deÔ¨Åne the directional maximal Hilbert transforms. For a function
f in 
1‚â§p<‚àûLp(Rn) and 0 < Œµ < N < ‚àûwe let
H (Œµ,N)
Œ∏
( f)(x) = 1
œÄ

Œµ‚â§|t|‚â§N
f(x‚àítŒ∏)dt
t ,
H (‚àó‚àó)
Œ∏
( f)(x) =
sup
0<Œµ<N<‚àû
H (Œµ,N)
Œ∏
( f)(x)
.
We observe that for any Ô¨Åxed 0 < Œµ < N < ‚àûand f ‚ààLp(Rn), H (Œµ,N)
Œ∏
( f) is well
deÔ¨Åned almost everywhere. Indeed, by Minkowski‚Äôs integral inequality we obtain
H (Œµ,N)
Œ∏
( f)

Lp(Rn) ‚â§2
œÄ
f

Lp(Rn) log N
Œµ < ‚àû,
which implies that H (Œµ,N)
Œ∏
( f)(x) is Ô¨Ånite for almost all x ‚ààRn. Thus H (‚àó‚àó)
Œ∏
( f) is
well deÔ¨Åned for f in 
1‚â§p<‚àûLp(Rn).
Theorem 5.2.7. If Œ© is odd and integrable over Sn‚àí1, then TŒ© and T (‚àó‚àó)
Œ©
are Lp
bounded for all 1 < p < ‚àû. More precisely, TŒ© initially deÔ¨Åned on Schwartz func-
tions has a bounded extension on Lp(Rn) (which is also denoted by TŒ©).
Proof. Let ej be the usual unit vectors in Sn‚àí1. The operator He1 is obtained by
applying the Hilbert transform in the Ô¨Årst variable followed by the identity operator
in the remaining variables. Clearly, He1 is bounded on Lp(Rn) with norm equal to
that of the Hilbert transform on Lp(R). Next observe that the following identity is
valid for all matrices A ‚ààO(n):
HA(e1)( f)(x) = He1( f ‚ó¶A)(A‚àí1x).
(5.2.18)
This implies that the Lp boundedness of HŒ∏ can be reduced to that of He1. We
conclude that HŒ∏ is Lp bounded for 1 < p < ‚àûwith norm bounded by the norm of
the Hilbert transform on Lp(R) for every Œ∏ ‚ààSn‚àí1.

340
5 Singular Integrals of Convolution Type
Identity (5.2.18) is also valid for H (Œµ,N)
Œ∏
and H (‚àó‚àó)
Œ∏
. Consequently, H (‚àó‚àó)
Œ∏
is
bounded on Lp(Rn) for 1 < p < ‚àûwith norm at most that of H(‚àó‚àó) on Lp(R).
Next we realize a general singular integral TŒ© with Œ© odd as an average of the
directional Hilbert transforms HŒ∏. We start with f in 
1‚â§p<‚àûLp(Rn) and the fol-
lowing identities:

Œµ‚â§|y|‚â§N
Œ©(y/|y|)
|y|n
f(x‚àíy)dy = +

Sn‚àí1 Œ©(Œ∏)
 N
r=Œµ f(x‚àírŒ∏) dr
r dŒ∏
= ‚àí

Sn‚àí1 Œ©(Œ∏)
 N
r=Œµ f(x+rŒ∏) dr
r dŒ∏,
where the Ô¨Årst follows by switching to polar coordinates and the second one is a
consequence of the Ô¨Årst one and the fact that Œ© is odd via the change variables
Œ∏ ‚Üí‚àíŒ∏. Averaging the two identities, we obtain

Œµ‚â§|y|‚â§N
Œ©(y/|y|)
|y|n
f(x‚àíy)dy
= 1
2

Sn‚àí1 Œ©(Œ∏)
 N
r=Œµ
f(x‚àírŒ∏)‚àíf(x+rŒ∏)
r
drdŒ∏
= œÄ
2

Sn‚àí1 Œ©(Œ∏)H (Œµ,N)
Œ∏
( f)(x)dŒ∏.
(5.2.19)
It follows from the identity in (5.2.19) that

Œµ‚â§|y|‚â§N
Œ©(y/|y|)
|y|n
f(x‚àíy)dy = œÄ
2

Sn‚àí1 Œ©(Œ∏)H (Œµ,N)
Œ∏
( f)(x)dŒ∏ ,
(5.2.20)
from which we conclude that
T (‚àó‚àó)
Œ©
( f)(x) ‚â§œÄ
2

Sn‚àí1 |Œ©(Œ∏)|H (‚àó‚àó)
Œ∏
( f)(x)dŒ∏ .
(5.2.21)
Using the Lebesgue dominated convergence theorem, we see that for f in S (Rn),
we can pass the limits as Œµ ‚Üí0 and N ‚Üí‚àûinside the integral in (5.2.20), concluding
that
TŒ©( f)(x) = œÄ
2

Sn‚àí1 Œ©(Œ∏)HŒ∏( f)(x)dŒ∏ ,
(5.2.22)
for f ‚ààS (Rn). The Lp boundedness of TŒ© and T (‚àó‚àó)
Œ©
for Œ© odd are then trivial
consequences of (5.2.22) and (5.2.21) via Minkowski‚Äôs integral inequality.
‚ñ°
Corollary 5.2.8. The Riesz transforms R j and the maximal Riesz transforms R(‚àó)
j
are bounded on Lp(Rn) for 1 < p < ‚àû.
Proof. The assertion follows from the fact that the Riesz transforms have odd ker-
nels. Since the kernel of Rj decays like |x|‚àín near inÔ¨Ånity, it follows that R(‚àó)
j ( f) is
well deÔ¨Åned for f ‚ààLp(Rn). Since R(‚àó)
j
is pointwise bounded by 2R(‚àó‚àó)
j
, the conclu-
sion follows from Theorem 5.2.7.
‚ñ°

5.2 Singular Integrals and the Method of Rotations
341
Remark 5.2.9. It follows from the proof of Theorem 5.2.7 and from Theorems 5.1.7
and 5.1.12 that whenever Œ© is an odd function on Sn‚àí1, we have
TŒ©

Lp‚ÜíLp ‚â§
Œ©

L1

a p
when p ‚â•2,
a(p‚àí1)‚àí1
when 1 < p ‚â§2,
T (‚àó‚àó)
Œ©

Lp‚ÜíLp ‚â§
Œ©

L1

a p
when p ‚â•2,
a(p‚àí1)‚àí1
when 1 < p ‚â§2,
for some a > 0 independent of p and the dimension.
5.2.4 Singular Integrals with Even Kernels
Since a general integrable function Œ© on Sn‚àí1 with mean value zero can be written
as a sum of an odd and an even function, it sufÔ¨Åces to study singular integral opera-
tors TŒ© with even kernels. For the rest of this section, Ô¨Åx an integrable even function
Œ© on Sn‚àí1 with mean value zero. The following idea is fundamental in the study of
such singular integrals. Proposition 5.1.16 implies that
TŒ© = ‚àí
n
‚àë
j=1
RjRjTŒ© .
(5.2.23)
If RjTŒ© were another singular integral operator of the form TŒ© j for some odd Œ© j,
then the boundedness of TŒ© would follow from that of TŒ© j via the identity (5.2.23)
and Theorem 5.2.7. It turns out that RjTŒ© does have an odd kernel, but it may not be
integrable on Sn‚àí1 unless Œ© itself possesses an additional amount of integrability.
The amount of extra integrability needed is logarithmic, more precisely of this sort:
cŒ© =

Sn‚àí1 |Œ©(Œ∏)|log+ |Œ©(Œ∏)|dŒ∏ < ‚àû.
(5.2.24)
Observe that
Œ©

L1 ‚â§cŒ© +eœân‚àí1 ‚â§Cn (cŒ© +1),
which says that the norm ‚à•Œ©‚à•L1 is always controlled by a dimensional constant
multiple of cŒ© +1. The following theorem is the main result of this section.
Theorem 5.2.10. Let n ‚â•2 and let Œ© be an even integrable function on Sn‚àí1 with
mean value zero that satisÔ¨Åes (5.2.24). Then the corresponding singular integral
TŒ© is bounded on Lp(Rn), 1 < p < ‚àû, with norm at most a dimensional constant
multiple of the quantity max

(p‚àí1)‚àí2, p2
(cŒ© +1).
If the operator TŒ© in Theorem 5.2.10 is weak type (1,1), then the estimate on the
Lp operator norm of TŒ© can be improved to ‚à•TŒ©‚à•Lp‚ÜíLp ‚â§Cn(p ‚àí1)‚àí1 as p ‚Üí1.
This is indeed the case; see the historical comments at the end of this chapter.

342
5 Singular Integrals of Convolution Type
Proof. Let WŒ© be the distributional kernel of TŒ©. We have that WŒ© coincides with
the function Œ©(x/|x|)|x|‚àín on Rn \{0}. Using Proposition 5.2.3 and the fact that Œ©
is an even function, we obtain the formula
2
WŒ©(Œæ) =

Sn‚àí1 Œ©(Œ∏)log
1
|Œæ ¬∑Œ∏| dŒ∏ ,
(5.2.25)
which implies that 2
WŒ© is itself an even function. Now, using Exercise 5.2.3 and
condition (5.2.24), we conclude that 2
WŒ© is a bounded function. Therefore, TŒ© is L2
bounded. To obtain the Lp boundedness of TŒ©, we use the idea mentioned earlier
involving the Riesz transforms. In view of (5.1.46), we have that
TŒ© = ‚àí
n
‚àë
j=1
RjTj,
(5.2.26)
where Tj = RjTŒ©. Equality (5.2.26) makes sense as an operator identity on L2(Rn),
since TŒ© and each Rj are well deÔ¨Åned and bounded on L2(Rn).
The kernel of the operator Tj is the inverse Fourier transform of the distribu-
tion ‚àíi Œæ j
|Œæ| 2
WŒ©(Œæ), which we denote by Kj. At this point we know only that Kj is
a tempered distribution whose Fourier transform is the function ‚àíi Œæ j
|Œæ| 2
WŒ©(Œæ). Our
Ô¨Årst goal is to show that Kj coincides with an integrable function on an annulus. To
prove this assertion we write
WŒ© = W 0
Œ© +W 1
Œ© +W ‚àû
Œ© ,
where W 0
Œ© is a distribution and W 1
Œ©,W ‚àû
Œ© are functions deÔ¨Åned by
4
W 0
Œ©,œï
5
= lim
Œµ‚Üí0

Œµ<|x|‚â§1
2
Œ©(x/|x|)
|x|n
œï(x)dx,
W 1
Œ©(x) = Œ©(x/|x|)
|x|n
œá 1
2 ‚â§|x|‚â§2 ,
W ‚àû
Œ© (x) = Œ©(x/|x|)
|x|n
œá2<|x| .
We now Ô¨Åx a j ‚àà{1,2,...,n} and we write
Kj = K0
j +K1
j +K‚àû
j ,
where
K0
j =

‚àíi Œæ j
|Œæ| 2
W 0
Œ©(Œæ)
‚à®,
K1
j =

‚àíi Œæ j
|Œæ| 2
W 1
Œ©(Œæ)
‚à®,
K‚àû
j =

‚àíi Œæ j
|Œæ|3
W ‚àû
Œ© (Œæ)
‚à®.
Notice that K0
j is well deÔ¨Åned via Theorem 2.3.21.

5.2 Singular Integrals and the Method of Rotations
343
DeÔ¨Åne the annulus
A = {x ‚ààRn : 2/3 < |x| < 3/2}.
For a smooth function œÜ supported in the annulus 2/3 < |x| < 3/2 we have
4
K0
j ,œÜ
5
=
4
(‚àíi Œæ j
|Œæ| 2
W 0
Œ©(Œæ)
‚à®,œÜ
5
=
4
‚àíi Œæ j
|Œæ| 2
W 0
Œ©(Œæ),œÜ ‚à®(Œæ)
5
=
4 2
W 0
Œ©(Œæ),‚àíi Œæ j
|Œæ|œÜ ‚à®(Œæ)
5
=
4
W 0
Œ©,

‚àíi Œæ j
|Œæ|œÜ ‚à®(Œæ)
‚àß5
= ‚àí
4
W 0
Œ©,
Rj(œÜ)
5
= ‚àílim
Œµ‚Üí0

Œµ<|y|<1/2
Œ©(y/|y|)
|y|n
Rj(œÜ)(‚àíy)dy
(Œ© is even)
= ‚àíŒì ( n+1
2 )
œÄ
n+1
2
lim
Œµ‚Üí0

Œµ<|y|<1/2
Œ©(y/|y|)
|y|n

Rn
yj ‚àíxj
|y‚àíx|n+1 œÜ(x)dxdy,
where the action of the distribution W 0
Œ© on Rj(œÜ) is justiÔ¨Åed by fact that Rj(œÜ)(y) is
smooth on the support of W 0
Œ©; note |x ‚àíy| ‚â•1/6. Moreover, ‚ü®2
W 0
Œ©(Œæ),‚àíi Œæ j
|Œæ|œÜ ‚à®(Œæ)‚ü©
should be interpreted as a convergent integral.
It follows that for x ‚ààA, the absolute value of the convolution of W 0
Œ© with the
kernel of the Riesz transform Rj is

Œì ( n+1
2 )
œÄ
n+1
2
lim
Œµ‚Üí0

Œµ<|y|< 1
2
xj ‚àíyj
|x‚àíy|n+1
Œ©(y/|y|)
|y|n
dy

(5.2.27)
=

Œì ( n+1
2 )
œÄ
n+1
2

|y|< 1
2
 xj ‚àíyj
|x‚àíy|n+1 ‚àí
xj
|x|n+1
 Œ©(y/|y|)
|y|n
dy

(5.2.28)
‚â§

|y|‚â§1
2
Cn|y| |Œ©(y/|y|)|
|y|n
dy
= C‚Ä≤
n
Œ©

L1 ,
where we used the fact that Œ©(y/|y|)|y|‚àín has integral zero over annuli of the form
Œµ < |y| < 1
2, the mean value theorem applied to the function xj|x|‚àí(n+1), and the fact
that |x‚àíy| ‚â•1/6 for x in the annulus A. We conclude that on A, K0
j coincides with
the bounded function inside the absolute value in (5.2.27).

344
5 Singular Integrals of Convolution Type
Likewise, for x ‚ààA we have
Œì ( n+1
2 )
œÄ
n+1
2


|y|>2
xj ‚àíyj
|x‚àíy|n+1
Œ©(y/|y|)
|y|n
dy

(5.2.29)
‚â§Œì ( n+1
2 )
œÄ
n+1
2

|y|>2
1
|x‚àíy|n
|Œ©(y/|y|)|
|y|n
dy
‚â§Œì ( n+1
2 )
œÄ
n+1
2

|y|>2
4n
|y|2n |Œ©(y/|y|)|dy
= C
Œ©

L1,
from which it follows that on the annulus A, K‚àû
j coincides with the bounded function
inside the absolute value in (5.2.29) or in (5.2.28).
Now observe that condition (5.2.24) gives that the function W 1
Œ© satisÔ¨Åes

|x|‚â§2 |W 1
Œ©(x)| log+ |W 1
Œ©(x)|dx
‚â§
 2
1/2

Sn‚àí1
|Œ©(Œ∏)|
rn
log+[2n|Œ©(Œ∏)|]dŒ∏rn‚àí1 dr
r
‚â§(log4)

n(log2)
Œ©

L1 +cŒ©

< ‚àû.
Since the Riesz transform Rj is countably subadditive and maps Lp to Lp with norm
at most 4(p‚àí1)‚àí1 for 1 < p < 2, it follows from Exercise 1.3.7 that K1
j = Rj(W 1
Œ©)
is integrable over the ball |x| ‚â§3/2 and moreover, it satisÔ¨Åes

A |K1
j (x)|dx ‚â§Cn

|x|‚â§2 |W 1
Œ©(x)| log+ |W 1
Œ©(x)|dx+1

‚â§C‚Ä≤
n(cŒ© +1).
Furthermore, since 2
Kj is homogeneous of degree zero, Kj is a homogeneous
distribution of degree ‚àín (Exercise 2.3.9). This means that for all test functions œï
and all Œª > 0 we have
4
Kj,Œ¥ Œª(œï)
5
=
4
Kj,œï
5
,
(5.2.30)
where Œ¥ Œª(œï)(x) = œï(Œªx). But for œï ‚ààC ‚àû
0 supported in the annulus 3/4 < |x| < 4/3
and for Œª in (8/9,9/8) we have that Œ¥ Œª ‚àí1(œï) is supported in A and thus we can
express (5.2.30) as convergent integrals as follows:

Rn Kj(x)œï(x)dx =

Rn Kj(x)œï(Œª ‚àí1x)dx =

Rn Œª nKj(Œªx)œï(x)dx.
(5.2.31)
From this it would be ideal to be able to directly obtain that Kj(x) = Œª nKj(Œªx) for all
8/9 < |x| < 9/8 and 8/9 < Œª < 9/8, in particular when Œª = |x|‚àí1. But unfortunately,
we can only deduce that for every Œª ‚àà(8/9,9/8), Kj(x) = Œª nKj(Œªx) holds for all x
in the annulus except a set of measure zero that depends on Œª. To be able to deÔ¨Åne
the restriction of Kj on Sn‚àí1, we employ a more delicate argument.

5.2 Singular Integrals and the Method of Rotations
345
For any J subinterval of [8/9,9/8] we obtain from (5.2.31) that

Rn Kj(x)œï(x)dx =

Rn ‚àí

J Œª nKj(Œªx)dŒª œï(x)dx,
where integral with the slashed integral denotes the average of a function over the set
J. Since œï was an arbitrary C ‚àû
0 function supported in the annulus 3/4 < |x| < 4/3,
it follows that for every J subinterval of [8/9,9/8], there is a null subset EJ of the
annulus A‚Ä≤ = {x : 27/32 < |x| < 32/27} such that
Kj(x) = ‚àí

J Œª nKj(Œªx)dŒª
(5.2.32)
for all x ‚ààA‚Ä≤ \EJ.
Let J0 = [
"
8/9,
"
9/8]. We claim that there is a set of null subset E of A‚Ä≤ such
that for all x ‚ààA‚Ä≤ \E we have
‚àí

J0
Œª nKj(Œªx)dŒª = ‚àí

rJ0
Œª nKj(Œªx)dŒª
(5.2.33)
for every r in J0. Indeed, let E be the union of ErJ0 over all r in J0 ‚à©Q. Then in
view of (5.2.32), identity (5.2.33) holds for x ‚ààA‚Ä≤ \E and J0 ‚à©Q. But for a Ô¨Åxed x in
A‚Ä≤ \E, the function of r on the right hand side of (5.2.33) is constant on the rationals
and is also continuous (in r), hence it must be constant for all r ‚ààJ0. Thus the claim
follows since both sides of (5.2.33) are equal to (5.2.32).
Writing x = Œ¥Œ∏, where 27/32 < Œ¥ < 32/27 and Œ∏ ‚ààSn‚àí1, it follows by Fubini‚Äôs
theorem that there is a Œ¥ ‚àà(27/32,32/27) (in fact almost all Œ¥ have this property)
such that
‚àí

J0
Œª nKj(ŒªŒ¥Œ∏)dŒª = ‚àí

rJ0
Œª nKj(ŒªŒ¥Œ∏)dŒª
(5.2.34)
for almost all Œ∏ ‚ààSn‚àí1 and all r ‚ààJ0. We Ô¨Åx such a Œ¥, which we denote Œ¥0.
We now deÔ¨Åne a function Œ© j on Sn‚àí1 by setting
Œ© j(Œ∏) = ‚àí

J0
Œ¥ n
0 Œª nKj(ŒªŒ¥0Œ∏)dŒª = ‚àí

rJ0
Œ¥ n
0 Œª nKj(ŒªŒ¥0Œ∏)dŒª
for all r ‚ààJ0. The function Œ© j is deÔ¨Åned almost everywhere and is integrable over
Sn‚àí1, since Kj is integrable over the annulus A.
Let e1 = (1,0,...,0). Let Œ® be a C ‚àû
0 (Rn) nonzero, nonnegative, radial, and sup-
ported in the annulus 32/(27
‚àö
2) < |x| < 27
‚àö
2/32 around Sn‚àí1. We start with
Œ© j(Œ∏) = ‚àí

r‚àí1J0
Œ¥ n
0 Œª nKj(ŒªŒ¥0Œ∏)dŒª = ‚àí

J0
Œ¥ n
0 rnŒª nKj(rŒªŒ¥0Œ∏)dŒª ,
which holds for all r ‚ààJ0, we multiply by Œ®(re1), and we integrate over Sn‚àí1 and
over (0,‚àû) with respect to the measure dr/r. We obtain

346
5 Singular Integrals of Convolution Type
 ‚àû
0 Œ®(re1)dr
r

Sn‚àí1Œ© j(Œ∏)dŒ∏ = ‚àí

J0
 ‚àû
0

Sn‚àí1Œ¥ n
0 Œª nKj(ŒªŒ¥0rŒ∏)Œ®(re1)rndŒ∏ dr
r dŒª
= ‚àí

J0

Rn Œ¥ n
0 Œª nKj(ŒªŒ¥0x)Œ®(x)dxdŒª
= ‚àí

J0

Rn Kj(x)Œ®((ŒªŒ¥0)‚àí1x)dxdŒª
= ‚àí

J0
4
Kj,Œ®
5
dŒª ,
=
4
Kj,Œ®
5
in view of the homogeneity of Kj. But also, for some constant c‚Ä≤
Œ® we have
4
Kj,Œ®
5
=
42
Kj, 1
Œ®
5
=

Rn
‚àíiŒæ j
|Œæ|
2
WŒ©(Œæ) 1
Œ®(Œæ)dŒæ = c‚Ä≤
Œ®

Sn‚àí1
‚àíiŒ∏ j
|Œ∏|
2
WŒ©(Œ∏)dŒ∏ = 0,
since by (5.2.25), ‚àíiŒæ j
|Œæ| 2
WŒ©(Œæ) is an odd function. We conclude that Œ© j has mean
value zero over Sn‚àí1.
Thus Œ© ‚ààL1(Sn‚àí1) has mean value zero and the distribution WŒ© j is well deÔ¨Åned.
We claim that
Kj = WŒ© j .
(5.2.35)
To establish (5.2.35), we show Ô¨Årst that
4
Kj,œï
5
=
4
WŒ© j,œï
5
whenever œï is sup-
ported in the annulus 8/9 < |x| < 9/8. Using (5.2.32) we have

Rn Kj(x)œï(x)dx =

Rn ‚àí

J0
Kj(Œ¥0Œªx)Œ¥ n
0 Œª ndŒª œï(x)dx
=
 ‚àû
0

Sn‚àí1 ‚àí

J0
Kj(Œ¥0ŒªrŒ∏)Œ¥ n
0 Œª nrn dŒª œï(rŒ∏)dŒ∏ dr
r
=
 ‚àû
0

Sn‚àí1 ‚àí

rJ0
Kj(Œ¥0Œª ‚Ä≤Œ∏)Œ¥ n
0 (Œª ‚Ä≤)ndŒª ‚Ä≤ œï(rŒ∏)dŒ∏ dr
r
=
 ‚àû
0

Sn‚àí1 Œ© j(Œ∏)œï(rŒ∏)dŒ∏ dr
r
=
4
WŒ© j,œï
5
,
having used (5.2.34) in the second to last equality.
Given a general C ‚àû
0 function œï whose support is contained in an annulus of the
form M‚àí1 < |x| < M, for some M > 0, via a smooth partition of unity, we write œï as a
Ô¨Ånite sum of smooth functions œïk whose supports are contained in annuli of the form
8s/9 < |x| < 9s/8 for some s > 0. These annuli can be brought inside the annulus
8/9 < |x| < 9/8 by a dilation. Since both Kj and WŒ© j are homogeneous distributions
of degree ‚àín and agree on the annulus 8/9 < |x| < 9/8 they must agree on annuli
8s/9 < |x| < 9s/8. Consequently, ‚ü®Kj,œï‚ü©= ‚ü®WŒ© j,œï‚ü©for all œï ‚ààC ‚àû
0 (Rn \ {0}).
Therefore, Kj ‚àíWŒ© j is supported at the origin, and since it is homogeneous of degree
‚àín, it must be equal to bŒ¥0, a constant multiple of the Dirac mass. But 2
Kj is an

5.2 Singular Integrals and the Method of Rotations
347
odd function and hence Kj is also odd. It follows that WŒ© j is an odd function on
Rn \{0}, which implies that Œ© j is an odd function. We say that u ‚ààS ‚Ä≤(Rn) is odd
if #u = ‚àíu, where #u is deÔ¨Åned by ‚ü®#u,œà‚ü©= ‚ü®u, #œà‚ü©for all œà ‚ààS (Rn) and #œà(x) =
œà(‚àíx). We have that Kj ‚àíWŒ© j is an odd distribution, and thus bŒ¥0 must be an odd
distribution. But if bŒ¥0 is odd, then b = 0. We conclude that for each j there exists an
odd integrable function Œ© j on Sn‚àí1 with ‚à•Œ© j‚à•L1 controlled by a constant multiple
of cŒ© +1 such that (5.2.35) holds.
Then we use (5.2.26) and (5.2.35) to write
TŒ© = ‚àí
n
‚àë
j=1
RjTŒ© j ,
and appealing to the boundedness of each TŒ© j (Theorem 5.2.7) and to that of the
Riesz transforms, we obtain the required Lp boundedness for TŒ©.
‚ñ°
We note that Theorem 5.2.10 holds for all Œ© ‚ààL1(Sn‚àí1) that satisfy (5.2.24), not
necessarily even Œ©. Simply write Œ© = Œ©e + Œ©o , where Œ©e is even and Œ©o is odd,
and check that condition (5.2.24) holds for Œ©e.
5.2.5 Maximal Singular Integrals with Even Kernels
We have the corresponding theorem for maximal singular integrals.
Theorem 5.2.11. Let Œ© be an even integrable function on Sn‚àí1 with mean value
zero that satisÔ¨Åes (5.2.24). Then the corresponding maximal singular integral T (‚àó‚àó)
Œ©
,
deÔ¨Åned in (5.2.4), is bounded on Lp(Rn) for 1 < p < ‚àûwith norm at most a dimen-
sional constant multiple of max(p2,(p‚àí1)‚àí2)(cŒ© +1).
Proof. For f ‚ààL1
loc(Rn), x deÔ¨Åne the maximal function of f in the direction Œ∏ by
setting
MŒ∏( f)(x) = sup
a>0
1
2a

|r|‚â§a | f(x‚àírŒ∏)|dr.
(5.2.36)
In view of Exercise 5.2.5 we have that MŒ∏ is bounded on Lp(Rn) with norm at most
3 p(p‚àí1)‚àí1.
Fix Œ¶ a smooth radial function such that Œ¶(x) = 0 for |x| ‚â§1/4, Œ¶(x) = 1 for
|x| ‚â•3/4, and 0 ‚â§Œ¶(x) ‚â§1 for all x in Rn. For f ‚ààLp(Rn) and 0 < Œµ < N < ‚àûwe
introduce the smoothly truncated singular integral
#T (Œµ,N)
Œ©
( f)(x) =

Rn
Œ©
 y
|y|

|y|n

Œ¶
 y
Œµ

‚àíŒ¶
 y
N

f(x‚àíy)dy
and the corresponding maximal singular integral operator
#T (‚àó‚àó)
Œ©
( f) =
sup
0<N<‚àû
sup
0<Œµ<N
|#T (Œµ,N)
Œ©
( f)|.
(5.2.37)
Computing the supremum in (5.2.37), we Ô¨Årst consider the case where N > 4Œµ.

348
5 Singular Integrals of Convolution Type
For f in Lp(Rn) (for some 1 < p < ‚àû), we have
#T (Œµ,N)
Œ©
( f)(x)‚àíT (Œµ,N)
Œ©
( f)(x)

=


Œµ
4 ‚â§|y|‚â§Œµ
Œ©
 y
|y|

|y|n
Œ¶
 y
Œµ

f(x‚àíy)dy‚àí

N
4 ‚â§|y|‚â§N
Œ©
 y
|y|

|y|n
Œ¶
 y
N

f(x‚àíy)dy

‚â§


Œµ
4 ‚â§|y|‚â§Œµ
|Œ©
 y
|y|

|
|y|n
| f(x‚àíy)|dy+

N
4 ‚â§|y|‚â§N
|Œ©
 y
|y|

|
|y|n
| f(x‚àíy)|dy

‚â§

Sn‚àí1
|Œ©(Œ∏)|
4
Œµ
 Œµ
Œµ
4
| f(x‚àírŒ∏)|dr + 4
N
 N
N
4
| f(x‚àírŒ∏)|dr

dŒ∏
‚â§16

Sn‚àí1 |Œ©(Œ∏)|MŒ∏( f)(x)dŒ∏ .
Now if N ‚â§4Œµ, then the function Œ¶
 y
Œµ

‚àíŒ¶
 y
N

‚àíœáŒµ‚â§|y|‚â§N is bounded by 3 and is
supported in the annulus Œµ
4 ‚â§|y| ‚â§4Œµ. In this case we obtain
#T (Œµ,N)
Œ©
( f)(x)‚àíT (Œµ,N)
Œ©
( f)(x)
 ‚â§3

Sn‚àí1
|Œ©(Œ∏)|
 4Œµ
Œµ
4
| f(x‚àírŒ∏)| dr
r dŒ∏
‚â§96

Sn‚àí1 |Œ©(Œ∏)|MŒ∏( f)(x)dŒ∏ .
We deduce from these estimates that
sup
0<Œµ<N<‚àû
#T (Œµ,N)
Œ©
( f)(x)‚àíT (Œµ,N)
Œ©
( f)(x)
 ‚â§96

Sn‚àí1 |Œ©(Œ∏)|MŒ∏( f)(x)dŒ∏ .
Using the result of Exercise 5.2.5 we conclude that
#T (‚àó‚àó)
Œ©
( f)‚àíT (‚àó‚àó)
Œ©
( f)

Lp ‚â§600
Œ©

L1 max(p,(p‚àí1)‚àí1)
f

Lp .
This implies that it sufÔ¨Åces to obtain the required Lp bound for the smoothly trun-
cated maximal singular integral operator #T (‚àó‚àó)
Œ©
.
Let Kj, Œ© j, and Tj be as in the previous theorem, and let Fj be the Riesz transform
of the function Œ©(x/|x|)Œ¶(x)|x|‚àín. Let f ‚ààLp(Rn). A calculation yields the identity
#T (Œµ,N)
Œ©
( f)(x) =

Rn
 1
Œµn
Œ©( y
Œµ /| y
Œµ |)
| y
Œµ |n
Œ¶( y
Œµ )‚àí1
Nn
Œ©( y
N /| y
N |)
| y
N |n
Œ¶( y
N )

f(x‚àíy)dy
= ‚àí
 n
‚àë
j=1
/
1
Œµn Fj
 ¬∑
Œµ

‚àí1
Nn Fj
 ¬∑
N
0
‚àóRj( f)

(x),

5.2 Singular Integrals and the Method of Rotations
349
where in the last step we used Proposition 5.1.16. Therefore we may write
‚àí#T (Œµ,N)
Œ©
( f)(x) =
n
‚àë
j=1

Rn

1
Œµn Fj
 x‚àíy
Œµ

‚àí1
Nn Fj
 x‚àíy
N

Rj( f)(y)dy
= A(Œµ,N)
1
( f)(x)+A(Œµ,N)
2
( f)(x)+A(Œµ,N)
3
( f)(x),
(5.2.38)
where
A(Œµ,N)
1
( f)(x) =
n
‚àë
j=1
1
Œµn

|x‚àíy|‚â§Œµ Fj
 x‚àíy
Œµ

Rj( f)(y)dy
‚àí
n
‚àë
j=1
1
Nn

|x‚àíy|‚â§N Fj
 x‚àíy
N

Rj( f)(y)dy,
A(Œµ,N)
2
( f)(x) =
n
‚àë
j=1

Rn
/
1
Œµn œá|x‚àíy|>Œµ
	
Fj
 x‚àíy
Œµ

‚àíKj
 x‚àíy
Œµ

‚àí1
Nn œá|x‚àíy|>N
	
Fj
 x‚àíy
N

‚àíKj
 x‚àíy
N

0
Rj( f)(y)dy,
A(Œµ,N)
3
( f)(x) =
n
‚àë
j=1

Rn
/
1
Œµn œá|x‚àíy|>ŒµKj
 x‚àíy
Œµ

‚àí1
Nn œá|x‚àíy|>NKj
 x‚àíy
N
0
Rj( f)(y)dy.
It follows from the deÔ¨Ånitions of Fj and Kj that
Fj(z)‚àíKj(z) = Œì ( n+1
2 )
œÄ
n+1
2
lim
Œµ‚Üí0

Œµ‚â§|y|
Œ©(y/|y|)
|y|n

Œ¶(y)‚àí1
 z j ‚àíyj
|z‚àíy|n+1 dy
= Œì ( n+1
2 )
œÄ
n+1
2

|y|‚â§3
4
Œ©(y/|y|)
|y|n

Œ¶(y)‚àí1
$ z j ‚àíyj
|z‚àíy|n+1 ‚àí
z j
|z|n+1
%
dy
whenever |z| ‚â•1. But using the mean value theorem, the last expression is easily
seen to be bounded by
Cn

|y|‚â§3
4
Œ©(y/|y|)
|y|n
|y|
|z|n+1 dy = C‚Ä≤
n
Œ©

L1|z|‚àí(n+1) ,
whenever |z| ‚â•1. Using this estimate, we obtain that the jth term in A(Œµ,N)
2
( f)(x) is
bounded by
Cn
‚à•Œ©‚à•L1
Œµn

|x‚àíy|>Œµ
|Rj( f)(y)|dy
(|x‚àíy|/Œµ)n+1 ‚â§Cn
2‚à•Œ©‚à•L1
2‚àínŒµn

Rn
|Rj( f)(y)|dy

1+ |x‚àíy|
Œµ
n+1 .
It follows that for functions f in Lp we have
sup
0<Œµ<N<‚àû
|A(Œµ,N)
2
( f)| ‚â§Cn
Œ©

L1M(Rj( f)),

350
5 Singular Integrals of Convolution Type
in view of Theorem 2.1.10. (M here is the Hardy‚ÄìLittlewood maximal operator.)
By Theorem 2.1.6, M maps Lp(Rn) to itself with norm bounded by a dimensional
constant multiple of max(1,(p‚àí1)‚àí1). Since by Remark 5.2.9 the norm
Rj

Lp‚ÜíLp
is controlled by a dimensional constant multiple of max(p,(p‚àí1)‚àí1), it follows that

sup
0<Œµ<N<‚àû
|A(Œµ,N)
2
( f)|

Lp ‚â§Cn
Œ©

L1 max(p,(p‚àí1)‚àí1)
f

Lp .
(5.2.39)
Next, recall that in the proof of Theorem 5.2.10 we showed that
Kj(x) = Œ© j(x/|x|)
|x|n
,
where Œ© j are integrable functions on Sn‚àí1 that satisfy
Œ© j

L1 ‚â§Cn(cŒ© +1).
(5.2.40)
Consequently, for functions f in Lp(Rn) we have
sup
0<Œµ<N<‚àû
|A(Œµ,N)
3
( f)| ‚â§2
n
‚àë
j=1
T (‚àó‚àó)
Œ© j (Rj( f)),
and by Remark 5.2.9 this last expression has Lp norm at most a dimensional constant
multiple of
Œ© j

L1 max(p,(p‚àí1)‚àí1)
Rj( f)

Lp. It follows that

sup
0<Œµ<N<‚àû
|A(Œµ,N)
3
( f)|

Lp ‚â§Cn max(p2,(p‚àí1)‚àí2)(cŒ© +1)
f

Lp .
(5.2.41)
Finally, we turn our attention to the term A(Œµ,N)
1
( f). To prove the required esti-
mate, we Ô¨Årst show that there exist nonnegative homogeneous of degree zero func-
tions Gj on Rn that satisfy
|Fj(x)| ‚â§Gj(x)
when |x| ‚â§1
(5.2.42)
and

Sn‚àí1 |Gj(Œ∏)|dŒ∏ ‚â§Cn(cŒ© +1).
(5.2.43)
To prove (5.2.42), Ô¨Årst note that if |x| ‚â§1/8, then
|Fj(x)| = Œì ( n+1
2 )
œÄ
n+1
2


Rn
Œ©(y/|y|)
|y|n
Œ¶(y) xj ‚àíyj
|x‚àíy|n+1 dy

‚â§Cn

|y|‚â•1
4
|Œ©(y/|y|)|
|y|2n
dy
‚â§C‚Ä≤
n
Œ©

L1 .

5.2 Singular Integrals and the Method of Rotations
351
We now Ô¨Åx an x satisfying 1/8 ‚â§|x| ‚â§1 and we write
|Fj(x)| ‚â§Œ¶(x)|Kj(x)|+|Fj(x)‚àíŒ¶(x)Kj(x)|
‚â§|Kj(x)|+ Œì ( n+1
2 )
œÄ
n+1
2
 lim
Œµ‚Üí0

|y|>Œµ
xj ‚àíyj
|x‚àíy|n+1

Œ¶(y)‚àíŒ¶(x)
Œ©(y/|y|)
|y|n
dy

= |Kj(x)|+ Œì ( n+1
2 )
œÄ
n+1
2

P1(x)+P2(x)+P3(x)

,
where
P1(x) =


|y|‚â§1
16
 xj ‚àíyj
|x‚àíy|n+1 ‚àí
xj
|x|n+1

Œ¶(y)‚àíŒ¶(x)
Œ©(y/|y|)
|y|n
dy
,
P2(x) =


1
16 ‚â§|y|‚â§2
xj ‚àíyj
|x‚àíy|n+1

Œ¶(y)‚àíŒ¶(x)
Œ©(y/|y|)
|y|n
dy
,
P3(x) =


|y|‚â•2
xj ‚àíyj
|x‚àíy|n+1

Œ¶(y)‚àíŒ¶(x)
Œ©(y/|y|)
|y|n
dy
.
But since 1/8 ‚â§|x| ‚â§1, we see that
P1(x) ‚â§Cn

|y|‚â§1
16
|y|
|x|n+1
|Œ©(y/|y|)|
|y|n
dy ‚â§C‚Ä≤
n
Œ©

L1
and that
P3(x) ‚â§Cn

|y|‚â•2
|Œ©(y/|y|)|
|y|2n
dy ‚â§C‚Ä≤
n
Œ©

L1 .
For P2(x) we use the estimate |Œ¶(y)‚àíŒ¶(x)| ‚â§C|x‚àíy| to obtain
P2(x) ‚â§

1
16 ‚â§|y|‚â§2
C
|x‚àíy|n‚àí1
|Œ©(y/|y|)|
|y|n
dy
‚â§4C

1
16 ‚â§|y|‚â§2
|Œ©(y/|y|)|
|x‚àíy|n‚àí1|y|n‚àí1
2
dy
‚â§4C

Rn
|Œ©(y/|y|)|
|x‚àíy|n‚àí1|y|n‚àí1
2
dy.
Recall that Kj(x) = Œ© j(x/|x|)|x|‚àín. We now set
Gj(x) = Cn
Œ©

L1 +
Œ© j
 x
|x|
+|x|n‚àí3
2

Rn
|Œ©(y/|y|)|dy
|x‚àíy|n‚àí1|y|n‚àí1
2

(5.2.44)
and we observe that Gj is a homogeneous of degree zero function, it satisÔ¨Åes
(5.2.42), and it is integrable over the annulus 1
2 ‚â§|x| ‚â§2. To verify the last assertion,
we split up the double integral

352
5 Singular Integrals of Convolution Type
I =

1
2 ‚â§|x|‚â§2

Rn
|Œ©(y/|y|)|dy
|x‚àíy|n‚àí1|y|n‚àí1
2
dx
into the pieces 1/4 ‚â§|y| ‚â§4, |y| > 4, and |y| < 1/4. The part of I where 1/4 ‚â§|y| ‚â§4
is pointwise bounded by a constant multiple of

1
4 ‚â§|y|‚â§4
Œ©
 y
|y|


1
2 ‚â§|x|‚â§2
dx
|y‚àíx|n‚àí1 dy ‚â§

1
4 ‚â§|y|‚â§4
Œ©
 y
|y|


|x‚àíy|‚â§6
dx
|y‚àíx|n‚àí1 dy,
which is pointwise controlled by a constant multiple of ‚à•Œ©‚à•L1. In the part of I where
|y| > 4 we use that |x ‚àíy|‚àín+1 ‚â§(|y|/2)‚àín+1 to obtain rapid decay in y and hence
a bound by a constant multiple of ‚à•Œ©‚à•L1. Finally, in the part of I where |y| < 1/4
we use that |x ‚àíy|‚àín+1 ‚â§(1/4)‚àín+1, and then we also obtain a similar bound. It
follows from (5.2.44) and (5.2.40) that

1
2 ‚â§|x|‚â§2 |Gj(x)|dx ‚â§Cn

‚à•Œ©‚à•L1 +‚à•Œ© j‚à•L1 +‚à•Œ©‚à•L1

‚â§Cn(cŒ© +1).
Since Gj is homogeneous of degree zero, we deduce (5.2.43).
To complete the proof, we argue as follows:
sup
0<Œµ<N<‚àû
|A(Œµ,N)
1
( f)(x)|
‚â§2sup
Œµ>0
n
‚àë
j=1
1
Œµn

|z|‚â§Œµ |Fj(z)||Rj( f)(x‚àíz)|dz
‚â§2sup
Œµ>0
n
‚àë
j=1
1
Œµn
 Œµ
r=0

Sn‚àí1 |Fj(rŒ∏)||Rj( f)(x‚àírŒ∏)|rn‚àí1 dŒ∏ dr
‚â§2
n
‚àë
j=1

Sn‚àí1 |Gj(Œ∏)|
$
sup
Œµ>0
1
Œµn
 Œµ
r=0 |Rj( f)(x‚àírŒ∏)|rn‚àí1 dr
%
dŒ∏
‚â§4
n
‚àë
j=1

Sn‚àí1 |Gj(Œ∏)|MŒ∏(Rj( f))(x)dŒ∏ .
Using (5.2.43) together with the Lp boundedness of the Riesz transforms and of MŒ∏
we obtain

sup
0<Œµ<N<‚àû
|A(Œµ,N)
1
( f)|

Lp ‚â§Cn max(p,(p‚àí1)‚àí2)(cŒ© +1)
f

Lp .
(5.2.45)
Combining (5.2.45), (5.2.39), and (5.2.41), we obtain the required conclusion.
‚ñ°
The following corollary is a consequence of Theorem 5.2.11.
Corollary 5.2.12. Let Œ© be as in Theorem 5.2.11. Then for 1 < p < ‚àûand f in
Lp(Rn) the functions T (Œµ,N)
Œ©
( f) converge to TŒ©( f) in Lp and almost everywhere as
Œµ ‚Üí0 and N ‚Üí‚àû.

5.2 Singular Integrals and the Method of Rotations
353
Proof. The a.e. convergence is a consequence of Theorem 2.1.14. The Lp conver-
gence is a consequence of the Lebesgue dominated convergence theorem since for
f ‚ààLp(Rn) we have that |T (Œµ,N)
Œ©
( f)| ‚â§T (‚àó‚àó)
Œ©
( f) and T (‚àó‚àó)
Œ©
( f) is in Lp(Rn).
‚ñ°
Exercises
5.2.1. Show that the directional Hilbert transform HŒ∏ is given by convolution with
the distribution wŒ∏ in S ‚Ä≤(Rn) deÔ¨Åned by
4
wŒ∏,œï
5
= 1
œÄ p.v.
 +‚àû
‚àí‚àû
œï(tŒ∏)
t
dt.
Compute the Fourier transform of wŒ∏ and prove that HŒ∏ maps L1(Rn) to L1,‚àû(Rn).
5.2.2. Extend the deÔ¨Ånitions of WŒ© and TŒ© to Œ© = dŒº a Ô¨Ånite signed Borel measure
on Sn‚àí1 with mean value zero. Compute the Fourier transform of WdŒº and Ô¨Ånd a
necessary and sufÔ¨Åcient condition on measures dŒº so that TdŒº is L2 bounded. Notice
that the directional Hilbert transform HŒ∏ is a special case of such an operator TdŒº.
5.2.3. Use the inequality AB ‚â§AlogA + eB for A ‚â•1 and B > 0 to prove that if
Œ© satisÔ¨Åes (5.2.24) then it must satisfy (5.2.16). Conclude that if |Œ©|log+ |Œ©| is in
L1(Sn‚àí1), then TŒ© is L2 bounded.

Hint: Use that

Sn‚àí1 |Œæ ¬∑Œ∏|‚àíŒ± dŒ∏ converges when Œ± < 1. See Appendix D.3.

5.2.4. Let Œ© be a nonzero integrable function on Sn‚àí1 with mean value zero. Let
f ‚â•0 be nonzero and integrable over Rn. Prove that TŒ©( f) is not in L1(Rn).

Hint: Show that 
TŒ©( f) cannot be continuous at zero.

5.2.5. Let Œ∏ ‚ààSn‚àí1. Use an identity similar to (5.2.18) to show that the maximal
operators
sup
a>0
1
a
 a
0 | f(x‚àírŒ∏)|dr,
sup
a>0
1
2a
 +a
‚àía | f(x‚àírŒ∏)|dr
are Lp(Rn) bounded for 1 < p < ‚àûwith norm at most 3 p(p‚àí1)‚àí1.
5.2.6. For Œ© ‚ààL1(Sn‚àí1) and f locally integrable on Rn, deÔ¨Åne
MŒ©( f)(x) = sup
R>0
1
vnRn

|y|‚â§R |Œ©(y/|y|)|| f(x‚àíy)|dy.
Apply the method of rotations to prove that MŒ© maps Lp(Rn) to itself for 1 < p < ‚àû.
5.2.7. Let Œ©(x,Œ∏) be a function on Rn √óSn‚àí1 satisfying
(a) Œ©(x,‚àíŒ∏) = ‚àíŒ©(x,Œ∏) for all x and Œ∏.
(b) supx |Œ©(x,Œ∏)| is in L1(Sn‚àí1).

354
5 Singular Integrals of Convolution Type
Use the method of rotations to prove that
TŒ©( f)(x) = p.v.

Rn
Œ©(x,y/|y|)
|y|n
f(x‚àíy)dy
is bounded on Lp(Rn) for 1 < p < ‚àû.
5.2.8. Let Œ© ‚ààL1(Sn‚àí1) have mean value zero. Prove that if TŒ© maps Lp(Rn) to
Lq(Rn), then p = q.

Hint: Use dilations.

5.2.9. Prove that for all 1 < p < ‚àûthere exists a constant Ap > 0 such that for every
complex-valued C 2(R2) function f with compact support we have the bound
‚àÇx1 f

Lp +
‚àÇx2 f

Lp ‚â§Ap
‚àÇx1 f +i‚àÇx2 f

Lp.
5.2.10. (a) Let Œî = ‚àën
j=1 ‚àÇ2
x j be the usual Laplacian on Rn. Prove that for all 1 <
p < ‚àûthere exists a constant Ap > 0 such that for all C 2 functions f with compact
support we have the bound
‚àÇx j‚àÇxk f

Lp ‚â§Ap
Œî f

Lp.
(b) Let Œî m =
m times

 

Œî ‚ó¶¬∑¬∑¬∑‚ó¶Œî. Show that for any 1 < p < ‚àûthere exists a Cp > 0 such
that for all f of class C 2m with compact support and all differential monomials ‚àÇŒ±
x
of order |Œ±| = 2m we have
‚àÇŒ±
x f

Lp ‚â§Cp
Œî m f

Lp.
5.2.11. Use the same idea as in Lemma 5.2.5 to show that if f is continuous on
[0,‚àû), differentiable in (0,‚àû), and satisÔ¨Åes
lim
N‚Üí‚àû
 Na
N
f(u)
u
du = 0
for all a > 0, then
lim
Œµ‚Üí0
N‚Üí‚àû
 N
Œµ
f(at)‚àíf(t)
t
dt = f(0)log 1
a .
5.2.12. Let Œ©o be an odd integrable function on Sn‚àí1 and Œ©e an even function on
Sn‚àí1 that satisÔ¨Åes (5.2.24). Let f be a function supported in a ball B in Rn. Prove
that
(a) If | f|log+ | f| is integrable over a ball B, then TŒ©o( f) and T (‚àó‚àó)
Œ©o ( f) are integrable
over B.
(b) If | f|(log+ | f|)2 is integrable over a ball B, then TŒ©e( f) and T (‚àó‚àó)
Œ©e ( f) are inte-
grable over B.

Hint: Use Exercise 1.3.7.


5.3 Calder¬¥on‚ÄìZygmund Decomposition and Singular Integrals
355
5.2.13. ([324]) Let Œ© be integrable on Sn‚àí1 with mean value zero. Use Jensen‚Äôs
inequality to show that for some C > 0 and every radial function f ‚ààL2(Rn) we
have
TŒ©( f)

L2 ‚â§C
f

L2 .
This inequality subsumes that TŒ© is well deÔ¨Åned on radial L2(Rn) functions.
5.3 The Calder¬¥on‚ÄìZygmund Decomposition and Singular
Integrals
The behavior of singular integral operators on L1(Rn) is a more subtle issue than
that on Lp for 1 < p < ‚àû. It turns out that singular integrals are not bounded from
L1 to L1. See Example 5.1.3 and also Exercise 5.2.4. In this section we see that
singular integrals map L1 into the larger space L1,‚àû. This result strengthens their Lp
boundedness.
5.3.1 The Calder¬¥on‚ÄìZygmund Decomposition
To make some advances in the theory of singular integrals, we need to introduce
the Calder¬¥on‚ÄìZygmund decomposition. This is a powerful stopping-time construc-
tion that has many other interesting applications. We have already encountered an
example of a stopping-time argument in Section 2.1.
Recall that a dyadic cube in Rn is the set
[2km1,2k(m1 +1))√ó¬∑¬∑¬∑√ó[2kmn,2k(mn +1)),
where k,m1,...,mn ‚ààZ. Two dyadic cubes are either disjoint or related by inclusion.
Theorem 5.3.1. Let f ‚ààL1(Rn) and Œ± > 0. Then there exist functions g and b on
Rn such that
(1)
f = g+b.
(2)
‚à•g‚à•L1 ‚â§‚à•f‚à•L1 and ‚à•g‚à•L‚àû‚â§2nŒ±.
(3)
b = ‚àëj bj, where each bj is supported in a dyadic cube Qj. Furthermore, the
cubes Qk and Qj are disjoint when j Ã∏= k.
(4)

Qj
bj(x)dx = 0.
(5)
‚à•bj‚à•L1 ‚â§2n+1Œ±|Qj|.
(6)
‚àëj |Qj| ‚â§Œ±‚àí1‚à•f‚à•L1.

356
5 Singular Integrals of Convolution Type
Remark 5.3.2. This decomposition is called the Calder¬¥on‚ÄìZygmund decomposition
of f at height Œ±. The function g is called the good function of the decomposition,
since it is both integrable and bounded; hence the letter g. The function b is called
the bad function, since it contains the singular part of f (hence the letter b), but it
is carefully chosen to have mean value zero. It follows from (1) and (2) that the bad
function b is integrable and satisÔ¨Åes
b

L1 ‚â§
f

L1 +
g

L1 ‚â§2
 f

L1.
By (2) the good function is integrable and bounded; hence it lies in all the Lp spaces
for 1 ‚â§p ‚â§‚àû. More speciÔ¨Åcally, we have the following estimate:
g

Lp ‚â§
g

1
p
L1
g
1‚àí1
p
L‚àû
‚â§
f

1
p
L1(2nŒ±)1‚àí1
p = 2
n
p‚Ä≤ Œ±
1
p‚Ä≤ f

1
p
L1.
(5.3.1)
Proof. Decompose Rn into a mesh of disjoint dyadic cubes of the same size such
that
|Q| ‚â•1
Œ±
 f

L1
for every cube Q in the mesh. Call these cubes of zero generation. Subdivide each
cube of zero generation into 2n congruent cubes by bisecting each of its sides. We
now have a new mesh of dyadic cubes, which we call of generation one. Select a
cube Q of generation one if
1
|Q|

Q | f(x)|dx > Œ±.
(5.3.2)
Let S(1) be the set of all selected cubes of generation one. Now subdivide each
nonselected cube of generation one into 2n congruent subcubes by bisecting each
side and call these cubes of generation two. Then select all cubes Q of generation
two if (5.3.2) holds. Let S(2) be the set of all selected cubes of generation two. Repeat
this procedure indeÔ¨Ånitely.
The set of all selected cubes ‚àû
m=1 S(m) is countable and is exactly the set of the
cubes Qj proclaimed in the proposition. Note that in some instances this set may
be empty, in which case b = 0 and g = f. Let us observe that the selected cubes
are disjoint, for otherwise some Qk would be a proper subset of some Qj, which is
impossible since the selected cube Qj was never subdivided. Now deÔ¨Åne
bj =

f ‚àí
1
|Qj|

Qj
f dx

œáQj ,
b = ‚àëj bj, and g = f ‚àíb.
For a selected cube Qj there exists a unique nonselected cube Q‚Ä≤ with twice its
side length that contains Qj. Let us call this cube the parent of Qj. Since the parent
Q‚Ä≤ of Qj was not selected, we have |Q‚Ä≤|‚àí1 
Q‚Ä≤ | f|dx ‚â§Œ±. Then

5.3 Calder¬¥on‚ÄìZygmund Decomposition and Singular Integrals
357
1
|Qj|

Qj
| f(x)|dx ‚â§
1
|Qj|

Q‚Ä≤ | f(x)|dx = 2n
|Q‚Ä≤|

Q‚Ä≤ | f(x)|dx ‚â§2nŒ±.
Consequently,

Qj
|bj|dx ‚â§

Qj
| f|dx+|Qj|

1
|Qj|

Qj
f dx
 ‚â§2

Qj
| f|dx ‚â§2n+1Œ±|Qj|,
which proves (5). To prove (6), simply observe that
‚àë
j
|Qj| ‚â§1
Œ± ‚àë
j

Qj
| f|dx = 1
Œ±


j Qj
| f|dx ‚â§1
Œ±
 f

L1.
Next we need to obtain the estimates concerning g. We obviously have
g =
‚éß
‚é®
‚é©
f
on Rn \ 
j Qj,
1
|Qj|

Qj
f dx
on Qj.
(5.3.3)
On the cube Qj, g is equal to the constant |Qj|‚àí1 
Qj f dx, and this is bounded by
2nŒ±. It sufÔ¨Åces to show that g is bounded outside the union of the Qj‚Äôs. Indeed, for
each x ‚ààRn \ 
j Qj and for each k = 0,1,2,... there exists a unique nonselected
dyadic cube Q(k)
x
of generation k that contains x. Then for each k ‚â•0, we have

1
|Q(k)
x |

Q(k)
x
f(y)dy
 ‚â§
1
|Q(k)
x |

Q(k)
x
| f(y)|dy ‚â§Œ±.
The intersection of the closures of the cubes Q(k)
x
is the singleton {x}. Using Corol-
lary 2.1.16, we deduce that for almost all x ‚ààRn \ 
j Qj we have
f(x) = lim
k‚Üí‚àû
1
|Q(k)
x |

Q(k)
x
f(y)dy.
Since these averages are at most Œ±, we conclude that | f| ‚â§Œ± a.e. on Rn \ 
j Qj,
hence |g| ‚â§Œ± a.e. on this set. Finally, it follows from (5.3.3) that ‚à•g‚à•L1 ‚â§‚à•f‚à•L1.
This Ô¨Ånishes the proof of the theorem.
‚ñ°
We now apply the Calder¬¥on‚ÄìZygmund decomposition to obtain weak type (1,1)
bounds for a wide class of singular integral operators that includes the operators TŒ©
we studied in the previous section.

358
5 Singular Integrals of Convolution Type
5.3.2 General Singular Integrals
The kernels of the general singular integrals we will study are tempered distributions
that coincide with functions away from the origin. The setup as follows. Let K be
a measurable function deÔ¨Åned on Rn \{0} that is integrable on compact subsets of
Rn \{0} and satisÔ¨Åes the size condition
sup
R>0

R‚â§|x|‚â§2R |K(x)|dx = A1 < ‚àû.
(5.3.4)
This condition is less restrictive than the standard size estimate
sup
x‚ààRn |x|n|K(x)| < ‚àû,
(5.3.5)
but it is strong enough to capture size properties of kernels K(x) = Œ©(x/|x|)/|x|n,
where Œ© ‚ààL1(Sn‚àí1). We also note that condition (5.3.4) is equivalent to
sup
R>0
1
R

|x|‚â§R |K(x)||x|dx < ‚àû.
(5.3.6)
See Exercise 5.3.1.
The size condition (5.3.4) is sufÔ¨Åcient to make the restriction of K(x) on |x| > Œ¥
a tempered distribution (for any Œ¥ > 0). Indeed, for œï ‚ààS (Rn) we have

|x|‚â•1 |K(x)œï(x)|dx ‚â§
‚àû
‚àë
m=0

2m+1‚â•|x|‚â•2m
|K(x)|(1+|x|)N|œï(x)|
(1+2m)N
dx
‚â§
‚àû
‚àë
m=0
A1
(1+2m)N sup
x‚ààRn(1+|x|)N|œï(x)|,
and this expression is bounded by a constant times a Ô¨Ånite sum of Schwartz semi-
norms of œï.
We are interested in tempered distributions W on Rn that extend the function K
deÔ¨Åned on Rn \{0} and have the form
‚ü®W,œï‚ü©= lim
j‚Üí‚àû

|x|‚â•Œ¥ j
K(x)œï(x)dx,
œï ‚ààS (Rn),
(5.3.7)
for some sequence Œ¥ j ‚Üì0 as j ‚Üí‚àû. It is not hard to see that there exists a tempered
distribution W satisfying (5.3.7) for all œï ‚ààS (Rn) if and only if
lim
j‚Üí‚àû

1‚â•|x|‚â•Œ¥ j
K(x)dx = L
(5.3.8)
exists. See Exercise 5.3.2. If such a distribution W exists it may not be unique, since
it depends on the choice of the sequence Œ¥ j. Two different sequences tending to zero

5.3 Calder¬¥on‚ÄìZygmund Decomposition and Singular Integrals
359
may give two different tempered distributions W of the form (5.3.7), both coinciding
with the function K on Rn \{0}. See Example 5.4.2 and Remark 5.4.3.
If condition (5.3.8) is satisÔ¨Åed, we can deÔ¨Åne
‚ü®W,œï‚ü©= lim
j‚Üí‚àû

j‚â•|x|‚â•Œ¥ j
K(x)œï(x)dx
(5.3.9)
and the limit exists as j ‚Üí‚àûfor all œï ‚ààS (Rn) and is equal to
‚ü®W,œï‚ü©=

|x|‚â§1 K(x)(œï(x)‚àíœï(0))dx+œï(0)L+

|x|‚â•1 K(x)œï(x)dx.
Moreover, the previous calculations show that W is an element of S ‚Ä≤(Rn).
Next we assume that the given function K on Rn \{0} satisÔ¨Åes a certain smooth-
ness condition. There are three kinds of smoothness conditions that we encounter:
Ô¨Årst, the gradient condition
|‚àáK(x)| ‚â§A2|x|‚àín‚àí1,
x Ã∏= 0;
(5.3.10)
next, the weaker Lipschitz condition,
|K(x‚àíy)‚àíK(x)| ‚â§A2
|y|Œ¥
|x|n+Œ¥ ,
whenever |x| ‚â•2|y|;
(5.3.11)
and Ô¨Ånally the even weaker smoothness condition
sup
yÃ∏=0

|x|‚â•2|y| |K(x‚àíy)‚àíK(x)|dx = A2 ,
(5.3.12)
for some A2 < ‚àû. One should verify that (5.3.12) is a weaker condition than (5.3.11),
which in turn is weaker than (5.3.10). Condition (5.3.12) is often referred to as
H¬®ormander‚Äôs condition.
5.3.3 Lr Boundedness Implies Weak Type (1,1) Boundedness
This next theorem provides the most classical application of the Calder¬¥on‚ÄìZygmund
decomposition.
Theorem 5.3.3. Let K be a function on Rn \{0} that satisÔ¨Åes (5.3.4)1 and (5.3.12)
for some A1,A2 < ‚àû. Let W be an element of S ‚Ä≤(Rn) related to K as in (5.3.7).
Suppose that the operator T given by convolution with W has a bounded extension
that maps Lr(Rn) to itself with norm B for some 1 < r ‚â§‚àû. Then T has an extension
that maps L1(Rn) to L1,‚àû(Rn) with norm
1 this condition could be replaced by the assumption that K is integrable over any compact set that
does not contain the origin.

360
5 Singular Integrals of Convolution Type
T

L1‚ÜíL1,‚àû‚â§Cn (A2 +B),
(5.3.13)
and T also extends to a bounded operator from Lp(Rn) to itself for 1 < p < ‚àûwith
norm
T

Lp‚ÜíLp ‚â§C‚Ä≤
n max

p,(p‚àí1)‚àí1
(A2 +B),
(5.3.14)
where Cn,C‚Ä≤
n are constants that depend on the dimension but not on r or p.
Proof. We discuss the case r < ‚àûand we refer to Exercise 5.3.7 for the case r = ‚àû.
Let Œ± > 0 be given. We Ô¨Åx a step function f given as a Ô¨Ånite linear combination of
characteristic functions of disjoint dyadic intervals. The class of such functions is
dense in all the Lp spaces. Once (5.3.13) is obtained for such functions, a density ar-
gument gives that T admits an extension on L1 that also satisÔ¨Åes (5.3.13). Therefore
it sufÔ¨Åces to prove (5.3.13) for such a function f.
Apply the Calder¬¥on‚ÄìZygmund decomposition to f at height Œ≥Œ±, where Œ≥ is a
positive constant to be chosen later. That is, write the function f as the sum
f = g+b = g+‚àë
j
bj,
where conditions (1)‚Äì(6) of Theorem 5.3.1 are satisÔ¨Åed with the constant Œ± replaced
by Œ≥Œ±. Since f is a Ô¨Ånite linear combination of characteristic functions of disjoint
dyadic cubes, there are only Ô¨Ånitely many cubes Qj that appear in the Calder¬¥on‚Äì
Zygmund decomposition to f. Each bj is supported in a dyadic cube Qj with center
yj and the Qj‚Äôs are pairwise disjoint. We denote by ‚Ñì(Q) the side length of a cube
Q. Let Q‚àó
j be the unique cube with sides parallel to the axes having the same center
as Qj and having side length ‚Ñì(Q‚àó
j) = 2‚àön‚Ñì(Qj). Because of the form of f, each
bj is a bounded function supported in Qj, hence it is in Lr, thus each T(bj) is a
well-deÔ¨Åned Lr function. We observe that for all j and all x /‚ààQ‚àó
j we have
T(bj)(x) = lim
k‚Üí‚àû

k‚â•|x‚àíy|‚â•Œ¥k
K(x‚àíy)bj(y)dy =

Qj
K(x‚àíy)bj(y)dy,
where the last integral converges absolutely. This is a consequence of the Lebesgue
dominated convergence theorem, based on the facts that bj is bounded, that K is
integrable over any compact annulus that does not contain the origin (cf. (5.3.4)),
and that x‚àíQj is contained in such a compact annulus, since x /‚ààQ‚àó
j.
Next we use the cancellation of bj in the following way:

(‚à™iQ‚àó
i )c‚àë
j
T(bj)(x)
 dx
=

(
i Q‚àó
i )c‚àë
j


Qj
bj(y)

K(x‚àíy)‚àíK(x‚àíyj)

dy
dx
‚â§‚àë
j

(Q‚àó
j)c

Qj
|bj(y)||K(x‚àíy)‚àíK(x‚àíyj)|dydx

5.3 Calder¬¥on‚ÄìZygmund Decomposition and Singular Integrals
361
= ‚àë
j

Qj
|bj(y)|

(Q‚àó
j)c |K(x‚àíy)‚àíK(x‚àíyj)|dxdy
= ‚àë
j

Qj
|bj(y)|

‚àíy j+(Q‚àó
j)c |K(x‚àí(y‚àíyj))‚àíK(x)|dxdy
‚â§‚àë
j

Qj
|bj(y)|

|x|‚â•2|y‚àíy j| |K(x‚àí(y‚àíyj))‚àíK(x)|dxdy
‚â§A2‚àë
j
bj

L1
‚â§A22n+1 f

L1 < ‚àû,
where we used (5.3.12) since if x ‚àà‚àíyj + (Q‚àó
j)c then |x| ‚â•1
2‚Ñì(Q‚àó
j) = ‚àön‚Ñì(Qj)
and since y ‚àíyj ‚àà‚àíyj + Qj we have |y ‚àíyj| ‚â§
‚àön
2 ‚Ñì(Qj), thus |x| ‚â•2|y ‚àíyj|. See
Figure 5.2.
Fig. 5.2 The cubes ‚àíyj +Qj
and ‚àíyj +Q‚àó
j.
0.
.x
j*
j
‚àí y + Q
j
j
‚àí y + Q
.
j
y ‚àí y
Thus we proved that

(
i Q‚àó
i )c‚àë
j
|T(bj)(x)|dx ‚â§2n+1A2
f

L1 ,
an inequality we use below. We have
	
x ‚ààRn : |T( f)(x)| > Œ±


‚â§


x ‚ààRn : |T(g)(x)| > Œ±
2
+


x ‚ààRn : |T(b)(x)| > Œ±
2

‚â§2r
Œ±r
T(g)
r
Lr +


i
Q‚àó
i
+


x /‚àà

i
Q‚àó
i : |T
‚àë
j
bj

(x)| > Œ±
2


362
5 Singular Integrals of Convolution Type
= 2r
Œ±r
T(g)
r
Lr +


i
Q‚àó
i
+


x /‚àà

i
Q‚àó
i : |‚àë
j
T(bj)(x)| > Œ±
2

‚â§2r
Œ±r Brg
r
Lr +‚àë
i
|Q‚àó
i |+ 2
Œ±

(
i Q‚àó
i )c‚àë
j
|T(bj)(x)|dx
‚â§2r
Œ±r 2
nr
r‚Ä≤ Br(Œ≥Œ±)
r
r‚Ä≤ f

L1 +(2‚àön)n
f

L1
Œ≥Œ±
+ 2
Œ± 2n+1A2
f

L1
‚â§
(2n+1BŒ≥)r
2nŒ≥
+ (2‚àön)n
Œ≥
+2n+2A2
 f

L1
Œ±
.
Choosing Œ≥ = 2‚àí(n+1)B‚àí1, we deduce the weak type (1,1) estimate (5.3.13) for T
with Cn = 2+2n+1(2‚àön)n +2n+2.
It follows from Exercise 1.3.2 that T has an extension that maps Lp to Lp with
bound at most C‚Ä≤
n(A2 + B)(p ‚àí1)‚àí1/p when 1 < p < r. The adjoint operator T ‚àóof
T, deÔ¨Åned by
4
T( f)|g
5
=
4
f |T ‚àó(g)
5
,
has a kernel that coincides with the function K‚àó(x) = K(‚àíx) on Rn \{0}. We notice
that since K satisÔ¨Åes (5.3.12), then so does K‚àóand with the same bound. Therefore,
T ‚àó, which maps Lr‚Ä≤ to Lr‚Ä≤, has a kernel that satisÔ¨Åes (5.3.12). By the preceding
argument, T ‚àómaps Lp‚Ä≤ to Lp‚Ä≤ with bound at most C‚Ä≤
n(A2 +B)(p‚àí1)‚àí1/p whenever
1 < p‚Ä≤ < r‚Ä≤. By duality this yields that T maps Lp(Rn) to Lp(Rn) with bound at most
C‚Ä≤
n(A2 +B)(p‚àí1)1‚àí1/p whenever r‚Ä≤ < p < ‚àû. Using interpolation we obtain that T
maps Lp to itself with norm at most C‚Ä≤
n(A2 +B)max((p‚àí1)‚àí1/p,(p‚àí1)1‚àí1/p) for
p in the interval (r,r‚Ä≤), which is nonempty only if r < 2. Then (5.3.14) holds since
max((p‚àí1)‚àí1/p,(p‚àí1)1‚àí1/p) ‚â§max((p‚àí1)‚àí1, p).
‚ñ°
5.3.4 Discussion on Maximal Singular Integrals
In this subsection we introduce maximal singular integrals and we derive their
boundedness under certain smoothness conditions on the kernels, assuming bound-
edness of the associated linear operator.
Suppose that K is a kernel on Rn \{0} that satisÔ¨Åes the size condition
|K(x)| ‚â§A1|x|‚àín
(5.3.15)
for x Ã∏= 0. Then for any Œµ > 0 the function K(Œµ)(x) = K(x)œá|x|‚â•Œµ lies in Lp‚Ä≤(Rn)
(with norm bounded by cp,n A1Œµ‚àín/p) for all 1 ‚â§p < ‚àû. Consequently, by H¬®older‚Äôs
inequality, the integral
( f ‚àóK(Œµ))(x) =

|y|‚â•Œµ f(x‚àíy)K(y)dy
converges absolutely for all x ‚ààRn and all f ‚ààLp(Rn), when 1 ‚â§p < ‚àû.

5.3 Calder¬¥on‚ÄìZygmund Decomposition and Singular Integrals
363
Let f ‚àà
1‚â§p<‚àûLp(Rn). We deÔ¨Åne the truncated singular integrals T (Œµ)( f) asso-
ciated with the kernel K by setting
T (Œµ)( f) = f ‚àóK(Œµ) ;
we also deÔ¨Åne the maximal truncated singular integral operator associated with K
by setting
T (‚àó)( f) = sup
Œµ>0
|( f ‚àóK(Œµ))| = sup
Œµ>0
|T (Œµ)( f)|.
This operator is well deÔ¨Åned, but possibly inÔ¨Ånite, for certain points in Rn.
We now consider the situation in which the kernel K satisÔ¨Åes an integrability
condition over concentric annuli centered at the origin, a condition that is certainly
a weaker condition than (5.3.15). Precisely, suppose that K is a measurable function
on Rn \ {0}, that is integrable on compact subsets of Rn \ {0}, for which there is a
constant A1 < ‚àûsuch that
sup
R>0

R‚â§|x|‚â§2R |K(x)|dx ‚â§A1 < ‚àû.
(5.3.16)
Such kernels may not be integrable to the power p‚Ä≤ > 1 over the region |x| ‚â•Œµ.
For this reason, it is not possible to deÔ¨Åne T (Œµ) as an absolutely convergent integral.
To overcome this difÔ¨Åculty, we consider double truncations. We deÔ¨Åne the doubly
truncated kernel K(Œµ,N) by setting
K(Œµ,N)(x) = K(x)œáŒµ‚â§|x|‚â§N(x).
(5.3.17)
A repeated application of (5.3.16) yields that

|K(Œµ,N)(x)|dx ‚â§A1
/
log2
N
Œµ
0
+1

,
which implies that K(Œµ,N) is integrable over concentric annuli centered at the origin.
Next, we deÔ¨Åne the doubly truncated singular integrals T (Œµ,N) by setting
T (Œµ,N)( f) = f ‚àóK(Œµ,N) ,
and we observe that these operators are well deÔ¨Åned when f in Lp, for 1 ‚â§p ‚â§‚àû.
Indeed, Theorem 1.2.10 yields that
T (Œµ,N)( f)

Lp ‚â§
 f

Lp

|K(Œµ,N)(x)|dx < ‚àû
for functions f in Lp, 1 ‚â§p ‚â§‚àû. Consequently, for almost every x ‚ààRn we have
|T (Œµ,N)( f)(x)| < ‚àû.
For functions in 
1‚â§p‚â§‚àûLp(Rn) we deÔ¨Åne the doubly truncated maximal singular
integral operator T (‚àó‚àó) associated with K by setting

364
5 Singular Integrals of Convolution Type
T (‚àó‚àó)( f) =
sup
0<Œµ<N<‚àû
|T (Œµ,N)( f)|.
(5.3.18)
For such functions and for almost all x ‚ààRn, T (‚àó‚àó)( f)(x) is well deÔ¨Åned, but poten-
tially inÔ¨Ånite.
One observation is that under condition (5.3.16), one can also deÔ¨Åne T (‚àó)(g)
for general integrable functions g with compact support. In this case, say that the
ball B(0,R) contains the support of g. Let x ‚ààB(0,M) and N = M + R. Then
|T (Œµ)(g)(x)| ‚â§|g| ‚àó|K(Œµ,N)|(x), which is Ô¨Ånite a.e. as the convolution of two L1
functions; consequently, the integral deÔ¨Åning T (Œµ)(g)(x) converges absolutely for
all x ‚ààB(0,R). Since R > 0 is arbitrary, T (Œµ)(g)(x) is deÔ¨Åned and Ô¨Ånite for almost
all x ‚ààRn.
Obviously T (‚àó) and T (‚àó‚àó) are related. If K satisÔ¨Åes condition (5.3.15), then


Œµ‚â§|y| f(x‚àíy)K(y)dy
 ‚â§sup
N>0


Œµ‚â§|y|‚â§N f(x‚àíy)K(y)dy
,
which implies that
T (‚àó)( f) ‚â§T (‚àó‚àó)( f)
for all f ‚àà
1‚â§p<‚àûLp. Also, T (Œµ,N)( f) = T (Œµ)( f)‚àíT (N)( f); hence
T (‚àó‚àó)( f) ‚â§2T (‚àó)( f).
Therefore, for kernels satisfying (5.3.15), T (‚àó‚àó) and T (‚àó) are comparable and the
boudnedness properties of T (‚àó‚àó) and T (‚àó) are equivalent
Theorem 5.3.4. (Cotlar‚Äôs inequality) Let 0 < A1,A2,A3 < ‚àûand suppose that K is
deÔ¨Åned on Rn \{0} and satisÔ¨Åes the size condition,
|K(x)| ‚â§A1|x|‚àín ,
x Ã∏= 0,
(5.3.19)
the smoothness condition
|K(x‚àíy)‚àíK(x)| ‚â§A2|y|Œ¥ |x|‚àín‚àíŒ¥ ,
(5.3.20)
whenever |x| ‚â•2|y| > 0, and the cancellation condition
sup
0<r<R<‚àû


r<|x|<R K(x)dx
 ‚â§A3 .
(5.3.21)
Let W in S ‚Ä≤(Rn) be related to K via (5.3.7) and let T be the operator given by
convolution with W. Then there is a constant Cn,Œ¥ such that the following inequality
is valid:
T (‚àó)( f) ‚â§M(T( f))+Cn,Œ¥ (A1 +A2 +A3)M( f),
(5.3.22)

5.3 Calder¬¥on‚ÄìZygmund Decomposition and Singular Integrals
365
for all f ‚ààS (Rn), where M is the Hardy‚ÄìLittlewood maximal operator. Conse-
quently, T (‚àó) is bounded on Lp(Rn) when 1 < p < ‚àû.
Proof. Let œï be a radially decreasing smooth function with integral 1 supported
in the ball B(0,1/2). For a function g and Œµ > 0 we use the notation gŒµ(x) =
Œµ‚àíng(Œµ‚àí1x). For a distribution W we deÔ¨Åne WŒµ analogously, i.e. as the unique dis-
tribution with the property ‚ü®WŒµ,œà‚ü©= Œµ‚àín‚ü®W,œàŒµ‚àí1‚ü©. We begin by observing that
KŒµ‚àí1(x) = ŒµnK(Œµx) satisÔ¨Åes (5.3.19), (5.3.20), and (5.3.21) uniformly in Œµ > 0.
Set, as before, K(Œµ)(x) = K(x)œá|x|‚â•Œµ. Fix f ‚ààS (Rn) for some 1 < p < ‚àû. Obvi-
ously we have
f ‚àóK(Œµ) = f ‚àó

(KŒµ‚àí1)(1)
Œµ = f ‚àóW ‚àóœïŒµ + f ‚àó

(KŒµ‚àí1)(1) ‚àíWŒµ‚àí1 ‚àóœï

Œµ .
(5.3.23)
Next we prove the following estimate for all Œµ > 0:

(KŒµ‚àí1)(1) ‚àíWŒµ‚àí1 ‚àóœï

(x)
 ‚â§C(A1 +A2 +A3)(1+|x|)‚àín‚àíŒ¥
(5.3.24)
for all x ‚ààRn. Indeed, for |x| ‚â•1 we express the left-hand side in (5.3.24) as


Rn

KŒµ‚àí1(x)‚àíKŒµ‚àí1(x‚àíy)

œï(y)dy
.
Since œï is supported in |y| ‚â§1/2, we have |x| ‚â•2|y|, and condition (5.3.20) yields
that the expression on the left-hand side of (5.3.24) is bounded by
A2
|x|n+Œ¥

Rn |y|Œ¥|œï(y)|dy ‚â§c
A2
(1+|x|)n+Œ¥ ,
which proves (5.3.24) in the case |x| ‚â•1. When |x| < 1, the left-hand side of (5.3.24)
equals
(WŒµ‚àí1 ‚àóœï)(x) = lim
Œ¥ j‚Üí0

|x‚àíy|‚â•Œ¥ j
KŒµ‚àí1(x‚àíy)œï(y)dy
(5.3.25)
for some sequence Œ¥ j ‚Üì0; see the discussion in Section 5.3.2. The expression in
(5.3.25) is equal to
I1 +I2 +I3 ,
where
In I1 we have 1/8 ‚â§|x ‚àíy| ‚â§1 + 1/2 = 3/2; hence I1 is bounded by a multiple of
A1. Since |œï(x) ‚àíœï(y)| ‚â§c|x ‚àíy|, the same is valid for I2. Finally, I3 is bounded
by a multiple of A3. Combining these facts yields the proof of (5.3.24) in the case
|x| < 1 as well.
I1 =

|x‚àíy|> 1
8
KŒµ‚àí1(x‚àíy)œï(y)dy,
I2 =

|x‚àíy|‚â§1
8
KŒµ‚àí1(x‚àíy)

œï(y)‚àíœï(x)

dy,
I3 = œï(x) lim
Œ¥ j‚Üí0

1
8 ‚â•|x‚àíy|‚â•Œ¥ j
KŒµ‚àí1(x‚àíy)dy.

366
5 Singular Integrals of Convolution Type
Use Corollary 2.1.12 to deduce that
sup
Œµ>0
 f ‚àó

(KŒµ‚àí1)(1) ‚àíKŒµ‚àí1 ‚àóœï

Œµ
 ‚â§c(A1 +A2 +A3)M( f).
Finally, take the supremum over Œµ > 0 in (5.3.23) and use (5.3.24) and Corollary
2.1.12 one more time to deduce the estimate
T (‚àó)( f) ‚â§M( f ‚àóW)+C(A1 +A2 +A3)M( f),
where C depends on n and Œ¥; this concludes the proof of (5.3.22) for all functions
f ‚ààS (Rn). Thus T (‚àó) is bounded on Lp, 1 < p < ‚àû, when restricted to Schwartz
functions.
Now given a general function g in Lp(Rn) we Ô¨Ånd a sequence hj in S (Rn) such
that ‚à•hj ‚àíg‚à•Lp ‚Üí0 as j ‚Üí‚àû. Then we have the pointwise estimate
|T (Œµ)(g)| ‚â§|T (Œµ)(g‚àíhj)|+|T (Œµ)(hj)| ‚â§cp,n A1Œµ
‚àín
p
0
‚à•g‚àíhj‚à•Lp +|T (‚àó)(hj)|
for all Œµ ‚â•Œµ0. Taking the supremum over Œµ ‚â•Œµ0 and then Lp norm over the ball
B(0,R), we obtain
 sup
Œµ‚â•Œµ0
|T (Œµ)(g)|

Lp(B(0,R)) ‚â§c‚Ä≤
p,n A1Œµ
‚àín
p
0
R
n
p ‚à•g‚àíhj‚à•Lp +C‚Ä≤ (A1 +A2 +A3)‚à•hj‚à•Lp .
Now we let j ‚Üí‚àûÔ¨Årst, and then R ‚Üí‚àûand Œµ0 ‚Üí0 to deduce the boundedness of
T (‚àó) on Lp(Rn) via the Lebesgue monotone convergence theorem.
‚ñ°
5.3.5 Boundedness for Maximal Singular Integrals Implies
Weak Type (1,1) Boundedness
We now state and prove a result analogous to that in Theorem 5.3.3 for maximal
singular integrals.
Theorem 5.3.5. Let K(x) be function on Rn \ {0} satisfying (5.3.4) with constant
A1 < ‚àûand H¬®ormander‚Äôs condition (5.3.12) with constant A2 < ‚àû. Suppose that the
operator T (‚àó‚àó) as deÔ¨Åned in (5.3.18) maps L2(Rn) to itself with norm B. Then T (‚àó‚àó)
maps L1(Rn) to L1,‚àû(Rn) with norm
T (‚àó‚àó)
L1‚ÜíL1,‚àû‚â§Cn(A1 +A2 +B),
where Cn is some dimensional constant.
Proof. The proof of this theorem is only a little more involved than the proof of
Theorem 5.3.3. We Ô¨Åx an L1(Rn) function f. We apply the Calder¬¥on‚ÄìZygmund
decomposition of f at height Œ≥Œ± for some Œ≥,Œ± > 0. We then write f = g+b, where

5.3 Calder¬¥on‚ÄìZygmund Decomposition and Singular Integrals
367
b = ‚àëj bj and each bj is supported in some cube Qj. We deÔ¨Åne Q‚àó
j as the cube
with the same center as Qj and with sides parallel to the sides of Qj having length
‚Ñì(Q‚àó
j) = 5‚àön‚Ñì(Qj). This is only a minor change compared with the deÔ¨Ånition of Qj
in Theorem 5.3.3. The main change in the proof is in the treatment of the term


x ‚àà

j
Q‚àó
j
c
: |T (‚àó‚àó)(b)(x)| > Œ±
2
.
(5.3.26)
We show that for all Œ≥ ‚â§(2n+5A1)‚àí1 we have


x ‚àà

j
Q‚àó
j
c
: |T (‚àó‚àó)(b)(x)| > Œ±
2
 ‚â§2n+8A2
f

L1
Œ±
.
(5.3.27)
Let us conclude the proof of the theorem assuming for the moment the validity of
(5.3.27). As in the proof of Theorem 5.3.3, we can show that


x ‚ààRn : |T (‚àó‚àó)(g)(x)| > Œ±
2
+


j
Q‚àó
j
 ‚â§

2n+2B2Œ≥ + (5‚àön)n
Œ≥
f

L1
Œ±
.
Combining this estimate with (5.3.27) and choosing
Œ≥ = (2n+5(A1 +A2 +B))‚àí1 ,
we obtain the required estimate
	
x ‚ààRn : |T (‚àó‚àó)( f)(x)| > Œ±

 ‚â§Cn(A1 +A2 +B)
f

L1
Œ±
with Cn = 2‚àí3 +(5‚àön)n2n+5 +2n+8.
It remains to prove (5.3.27). This estimate will be a consequence of the fact that
for x ‚àà

j Q‚àó
j
c we have the key inequality
T (‚àó‚àó)(b)(x) ‚â§4E1(x)+2n+2Œ±Œ≥E2(x)+2n+3Œ±Œ≥A1 ,
(5.3.28)
where
E1(x) = ‚àë
j

Qj
|K(x‚àíy)‚àíK(x‚àíyj)||bj(y)|dy,
E2(x) = ‚àë
j

Qj
|K(x‚àíy)‚àíK(x‚àíyj)|dy,
and yj is the center of Qj.
If we had (5.3.28), then we could easily derive (5.3.27). Indeed, Ô¨Åx a Œ≥ satisfying
Œ≥ ‚â§(2n+5A1)‚àí1. Then we have 2n+3Œ±Œ≥A1 < Œ±
3 , and using (5.3.28), we obtain

368
5 Singular Integrals of Convolution Type


x ‚àà

j
Q‚àó
j
c
: |T (‚àó‚àó)(b)(x)| > Œ±
2

‚â§


x ‚àà

j
Q‚àó
j
c
: 4E1(x) > Œ±
12

+


x ‚àà

j
Q‚àó
j
c
: 2n+2Œ±Œ≥E2(x) > Œ±
12

‚â§48
Œ±

(
j Q‚àó
j)c E1(x)dx+2n+6Œ≥

(
j Q‚àó
j)c E2(x)dx,
(5.3.29)
since Œ±
2 = Œ±
3 + Œ±
12 + Œ±
12. We have

(
j Q‚àó
j)c E1(x)dx
‚â§‚àë
j

Qj
|bj(y)|

(Q‚àó
j)c |K(x‚àíy)‚àíK(x‚àíyj)|dxdy
‚â§‚àë
j

Qj
|bj(y)|

|x‚àíy j|‚â•2|y‚àíy j| |K(x‚àíy)‚àíK(x‚àíyj)|dxdy
‚â§A2‚àë
j

Qj
|bj(y)|dy = A2‚àë
j
bj

L1 ‚â§A22n+1f

L1 ,
(5.3.30)
where we used the fact that if x ‚àà(Q‚àó
j)c, then |x ‚àíyj| ‚â•1
2‚Ñì(Q‚àó
j) = 5
2
‚àön‚Ñì(Qj). But
since |y‚àíyj| ‚â§
‚àön
2 ‚Ñì(Qj), this implies that |x‚àíyj| ‚â•2|y‚àíyj|. Here we used the fact
that the diameter of a cube is equal to ‚àön times its side length. Likewise, we obtain
that

(
j Q‚àó
j)c E2(x)dx ‚â§A2‚àë
j
|Qj| ‚â§A2
f

L1
Œ±Œ≥
.
(5.3.31)
Combining (5.3.30) and (5.3.31) with (5.3.29) yields (5.3.27).
Fig. 5.3 The cubes Qj
and Q‚àó
j.
x
y
y0
Q j
Qj*
j. .
.

5.3 Calder¬¥on‚ÄìZygmund Decomposition and Singular Integrals
369
Therefore, the main task of the proof is to prove (5.3.28). Since b = ‚àëj bj, to
estimate T (‚àó‚àó)(b), it sufÔ¨Åces to estimate each |T (Œµ,N)(bj)| uniformly in Œµ and N. To
achieve this we use the estimate
|T (Œµ,N)(bj)| ‚â§|T (Œµ)(bj)|+|T (N)(bj)|,
(5.3.32)
noting that the truncated singular integrals T (Œµ)(bj) are well deÔ¨Åned. Indeed, say x
lies in a compact set K0. Pick M such that K0 ‚àíQj is contained in a ball B(0,M).
Then
|T (Œµ)(bj)(x)| ‚â§|bj|‚àó|K(Œµ,M)|(x),
which is Ô¨Ånite a.e. as the convolution of two L1 functions; thus the integral deÔ¨Åning
T (Œµ)(bj)(x) converges absolutely and the expression T (Œµ)(bj)(x) is well deÔ¨Åned for
almost all x.
We work with T (Œµ) and we note that T (N) can be treated similarly. Fix x /‚àà
j Q‚àó
j
and Œµ > 0 and deÔ¨Åne
J1(x,Œµ) = {j : ‚àÄy ‚ààQj we have |x‚àíy| < Œµ},
J2(x,Œµ) = {j : ‚àÄy ‚ààQj we have |x‚àíy| > Œµ},
J3(x,Œµ) = {j : ‚àÉy ‚ààQj we have |x‚àíy| = Œµ}.
Note that
T (Œµ)(bj)(x) = 0
whenever x /‚àà
j Q‚àó
j and j ‚ààJ1(x,Œµ). Also note that
K(Œµ)(x‚àíy) = K(x‚àíy)
whenever x /‚àà
j Q‚àó
j, j ‚ààJ2(x,Œµ) and y ‚ààQj. Therefore,
sup
Œµ>0
|T (Œµ)(b)(x)| ‚â§sup
Œµ>0
 ‚àë
j‚ààJ2(x,Œµ)
T(bj)(x)
+sup
Œµ>0
 ‚àë
j‚ààJ3(x,Œµ)
T(bjœá|x‚àí¬∑|‚â•Œµ)(x)
,
but since
sup
Œµ>0
 ‚àë
j‚ààJ2(x,Œµ)
T(bj)(x)
 ‚â§‚àë
j
|T(bj)(x)| ‚â§E1(x),
(5.3.33)
it sufÔ¨Åces to estimate the term
sup
Œµ>0
 ‚àë
j‚ààJ3(x,Œµ)
T(bjœá|x‚àí¬∑|‚â•Œµ)(x)
.
We now make some geometric observations; see Figure 5.3. Fix Œµ > 0 and a cube
Qj with j ‚ààJ3(x,Œµ); recall that x lies in (
j Q‚àó
j)c. Then we have
Œµ ‚â•1
2

‚Ñì(Q‚àó
j)‚àí‚Ñì(Qj)

= 1
2(5‚àön‚àí1)‚Ñì(Qj) ‚â•2‚àön‚Ñì(Qj).
(5.3.34)

370
5 Singular Integrals of Convolution Type
Since j ‚ààJ3(x,Œµ), there exists a y0 ‚ààQj with
|x‚àíy0| = Œµ .
Using (5.3.34), we obtain that for any y ‚ààQj we have
Œµ
2 ‚â§Œµ ‚àí‚àön‚Ñì(Qj) ‚â§|x‚àíy0|‚àí|y‚àíy0| ‚â§|x‚àíy|,
|x‚àíy| ‚â§|x‚àíy0|+|y‚àíy0| ‚â§Œµ +‚àön‚Ñì(Qj) ‚â§3Œµ
2 .
Therefore, we have proved that

j‚ààJ3(x,Œµ)
Qj ‚´ÖB(x, 3Œµ
2 )\B(x, Œµ
2).
Letting
cj(Œµ) =
1
|Qj|

Qj
bj(y)œá|x‚àíy|‚â•Œµ(y)dy,
we note that in view of property (5) of the Calder¬¥on‚ÄìZygmund decomposition (The-
orem 5.3.1), the estimate
|cj(Œµ)| ‚â§2n+1Œ±Œ≥
holds. Then
sup
Œµ>0
 ‚àë
j‚ààJ3(x,Œµ)

Qj
K(x‚àíy)bj(y)œá|x‚àíy|‚â•Œµ(y)dy

‚â§sup
Œµ>0
 ‚àë
j‚ààJ3(x,Œµ)

Qj
K(x‚àíy)

bj(y)œá|x‚àíy|‚â•Œµ(y)‚àícj(Œµ)

dy

+sup
Œµ>0
 ‚àë
j‚ààJ3(x,Œµ)
cj(Œµ)

Qj
K(x‚àíy)dy

‚â§sup
Œµ>0
 ‚àë
j‚ààJ3(x,Œµ)

Qj

K(x‚àíy)‚àíK(x‚àíyj)

bj(y)œá|x‚àíy|‚â•Œµ(y)‚àícj(Œµ)

dy

+2n+1Œ±Œ≥ sup
Œµ>0

B(x, 3Œµ
2 )\B(x, Œµ
2 ) |K(x‚àíy)|dy
‚â§‚àë
j

Qj
K(x‚àíy)‚àíK(x‚àíyj)

|bj(y)|+2n+1Œ±Œ≥

dy
+2n+1Œ±Œ≥ sup
Œµ>0

Œµ
2 ‚â§|x‚àíy|‚â§3Œµ
2
|K(x‚àíy)|dy
‚â§E1(x)+2n+1Œ±Œ≥E2(x)+2n+1Œ±Œ≥(2A1).
The last estimate, together with (5.3.33), with (5.3.32), and with the analogous esti-
mate for supN>0 |T (N)(bj)(x)| (which is similarly obtained), yields (5.3.28).
‚ñ°

5.3 Calder¬¥on‚ÄìZygmund Decomposition and Singular Integrals
371
The value of the previous theorem lies in the following: Since we know that for
some sequences Œµ j ‚Üì0, Nj ‚Üë‚àûthe pointwise limit T (Œµ j,Nj)( f) exists a.e. for all f in a
dense subclass of L1, then Theorem 5.3.5 allows us to deduce that T (Œµ j,Nj)( f) exists
a.e. for all f in L1(Rn).
If the singular integrals have kernels of the form Œ©(x/|x|)|x|‚àín with Œ© in L‚àû,
such as the Hilbert transform and the Riesz transforms, then the upper truncations
are not needed for K in (5.3.17). In this case
T (Œµ)
Œ© ( f)(x) =

|y|‚â•Œµ f(x‚àíy)Œ©(y/|y|)
|y|n
dy
is well deÔ¨Åned for f ‚àà
1‚â§p<‚àûLp(Rn) by H¬®older‚Äôs inequality and is equal to
lim
N‚Üí‚àû

Œµ‚â§|y|‚â§N f(x‚àíy)Œ©(y/|y|)
|y|n
dy.
Corollary 5.3.6. The maximal Hilbert transform H(‚àó) and the maximal Riesz trans-
forms R(‚àó)
j
are weak type (1,1). Secondly, limŒµ‚Üí0 H(Œµ)( f) and limŒµ‚Üí0 R(Œµ)
j (g) exist
a.e. for all f ‚ààL1(R) and g ‚ààL1(Rn), as Œµ ‚Üí0.
Proof. Since the kernels 1/x on R and xj/|x|n on Rn satisfy (5.3.10), the Ô¨Årst state-
ment in the corollary is an immediate consequence of Theorem 5.3.5. The second
statement follows from Theorem 2.1.14 and Corollary 5.2.8, since these limits exist
for Schwartz functions.
‚ñ°
Corollary 5.3.7. Under the hypotheses of Theorem 5.3.5, T (‚àó‚àó) maps Lp(Rn) to itself
for 1 < p < 2 with norm
T (‚àó‚àó)
Lp‚ÜíLp ‚â§Cn(A1 +A2 +B)
p‚àí1
,
where Cn is some dimensional constant.
Exercises
5.3.1. Let A1 be deÔ¨Åned in (5.3.4). Prove that
1
2A1 ‚â§sup
R>0
1
R

|x|‚â§R |K(x)||x|dx ‚â§2A1 ;
thus the expressions in (5.3.6) and (5.3.4) are equivalent.
5.3.2. Suppose that K is a locally integrable function on Rn \ {0} that satisÔ¨Åes
(5.3.4). Suppose that Œ¥ j ‚Üì0. Prove that the principal value operation
‚ü®W,œï‚ü©= lim
j‚Üí‚àû

Œ¥ j‚â§|x|‚â§1 K(x)œï(x)dx

372
5 Singular Integrals of Convolution Type
deÔ¨Ånes a distribution in S ‚Ä≤(Rn) if and only if the following limit exists:
lim
j‚Üí‚àû

Œ¥ j‚â§|x|‚â§1 K(x)dx.
5.3.3. Suppose that a function K on Rn \ {0} satisÔ¨Åes condition (5.3.4) with con-
stant A1 and condition (5.3.12) with constant A2.
(a) Show that the functions K(x)œá|x|‚â•Œµ also satisfy condition (5.3.12) uniformly in
Œµ > 0 with constant A1 +A2.
(b) Obtain the same conclusion for the upper truncations K(x)œá|x|‚â§N.
(c) Deduce a similar conclusion for the double truncations K(Œµ,N)(x) = K(x)œáŒµ‚â§|x|‚â§N.
5.3.4. Modify the proof of Theorem 5.3.5 to prove that if T (‚àó‚àó) maps Lr to Lr,‚àûfor
some 1 < r < ‚àû, and K satisÔ¨Åes condition (5.3.12), then T (‚àó‚àó) maps L1 to L1,‚àû.
5.3.5. Assume that T is a linear operator acting on measurable functions on Rn
such that whenever a function f is supported in a cube Q, then T( f) is supported in
a Ô¨Åxed multiple of Q.
(a) Suppose that T maps Lp to itself for some 1 < p < ‚àûwith norm B. Prove that T
extends to a bounded operator from L1 to L1,‚àûwith norm a constant multiple of B.
(b) Suppose that T maps Lp to Lq for some 1 < q < p < ‚àûwith norm B. Prove that
T extends to a bounded operator from L1 to Ls,‚àûwith norm a multiple of B, where
1
p‚Ä≤ + 1
q = 1
s .
5.3.6. (a) Let 1 < q < ‚àû. Show that the good function g in Theorem 5.3.1 lies in the
Lorentz space Lq,1 and that ‚à•g‚à•Lq,1 ‚â§Cn,qŒ±1/q‚Ä≤‚à•f‚à•1/q
L1 for some constant Cn,q.
(b) Let 1 < r < ‚àû. Obtain a generalization of Theorem 5.3.3 in which the assumption
that T maps Lr to Lr is replaced by that T maps Lr,1 to Lr,‚àûwith norm B.
(c) Let 1 < r < ‚àû. Obtain a further generalization of Theorem 5.3.3 in which the
assumption that T maps Lr to Lr is replaced by that it is of restricted weak type
(r,r), i.e., it satisÔ¨Åes
|{x : |T(œáE)(x)| > Œ±}| ‚â§Br |E|
Œ±r
for all subsets E of Rn with Ô¨Ånite measure.
5.3.7. Let K satisfy (5.3.12) for some A2 > 0, let W ‚ààS ‚Ä≤(Rn) be an extension of K
on Rn as in (5.3.7), and let T be the operator given by convolution with W. Obtain
the case r = ‚àûin Theorem 5.3.3. Precisely, prove that if T maps L‚àû(Rn) to itself
with constant B, then T has an extension on L1 +L‚àûthat satisÔ¨Åes
T

L1‚ÜíL1,‚àû‚â§C‚Ä≤
n (A2 +B),

5.3 Calder¬¥on‚ÄìZygmund Decomposition and Singular Integrals
373
and for 1 < p < ‚àûit satisÔ¨Åes
T

Lp‚ÜíLp ‚â§Cn
1
(p‚àí1)1/p (A2 +B),
where Cn,C‚Ä≤
n are constants that depend only on the dimension.

Hint: Apply the Calder¬¥on‚ÄìZygmund decomposition f = g+b at height Œ±Œ≥, where
Œ≥ = (2n+1B)‚àí1. Since |g| ‚â§2nŒ±Œ≥, observe that
|{x : |T( f)(x)| > Œ±}| ‚â§|{x : |T(b)(x)| > Œ±/2}|.
For the interpolation use the result of Exercise 1.3.2.

5.3.8. (Calder¬¥on‚ÄìZygmund decomposition on Lq) Fix a function f ‚ààLq(Rn) for
some 1 ‚â§q < ‚àûand let Œ± > 0. Then there exist functions g and b on Rn such that
(1) f = g+b.
(2) ‚à•g‚à•Lq ‚â§‚à•f‚à•Lq and ‚à•g‚à•L‚àû‚â§2
n
q Œ±.
(3) b = ‚àëj bj, where each bj is supported in a cube Qj. Furthermore, the cubes Qk
and Qj have disjoint interiors when j Ã∏= k.
(4) ‚à•bj‚à•q
Lq ‚â§2n+qŒ±q|Qj|.
(5)

Qj bj(x)dx = 0.
(6) ‚àëj |Qj| ‚â§Œ±‚àíq‚à•f‚à•q
Lq.
(7) ‚à•b‚à•Lq ‚â§2
n+q
q ‚à•f‚à•Lq and ‚à•b‚à•L1 ‚â§2Œ±1‚àíq‚à•f‚à•q
Lq.

Hint: Imitate the basic idea of the proof of Theorem 5.3.1, but select a cube Q if
 1
|Q|

Q | f(x)|q dx
1/q > Œ±. DeÔ¨Åne g and b as in the proof of Theorem 5.3.1.

5.3.9. Let f ‚ààL1(Rn). Then for any Œ± > 0, prove that there exist disjoint cubes Qj
in Rn such that the set EŒ± = {x ‚ààRn : Mc( f)(x) > Œ±} is contained in 
j 3Qj and
Œ±
4n <
1
|Qj|

Qj | f(t)|dt ‚â§Œ±
2n .

Hint: For given Œ± > 0, select all maximal dyadic cubes Qj(Œ±) such that the average
of f over them is bigger than Œ±. Given x ‚ààEŒ±, pick a cube R that contains x such
that the average of | f| over R is bigger than Œ± and Ô¨Ånd a dyadic cube Q such that
2‚àín|Q| < |R| ‚â§|Q| and that

R‚à©Q | f|dx > 2‚àínŒ±|R|. Conclude that Q is contained
in some Qk(4‚àínŒ±) and thus R is contained in 3Qk(4‚àínŒ±). The collection of all
Qj = Qj(4‚àínŒ±) is the required one.

5.3.10. Let K(x) be a function on Rn \{0} that satisÔ¨Åes |K(x)| ‚â§A|x|‚àín. Let Œ∑(x)
be a smooth function equal to 1 when |x| ‚â•2 and vanishing when |x| ‚â§1. For f ‚ààLp,
1 ‚â§p < ‚àû, deÔ¨Åne truncated singular integral operators

374
5 Singular Integrals of Convolution Type
T (Œµ)( f)(x) =

|y|‚â•Œµ K(y) f(x‚àíy)dy,
T (Œµ)
Œ∑ ( f)(x) =

Rn Œ∑(y/Œµ)K(y) f(x‚àíy)dy.
Show that the truncated maximal singular integral T (‚àó)( f) = supŒµ>0 |T (Œµ)( f)| is Lp
bounded for 1 < p < ‚àûif and only if the smoothly truncated maximal singular in-
tegral T (‚àó)
Œ∑ ( f) = supŒµ>0 |T (Œµ)
Œ∑ ( f)| is Lp bounded. Formulate an analogous statement
for p = 1.
5.3.11. (M. Masty≈Ço) Let 1 ‚â§p < ‚àû. Suppose that TŒµ are linear operators deÔ¨Åned
on Lp(Rn) such that for all f ‚ààLp(Rn) we have |TŒµ( f)| ‚â§AŒµ‚àía‚à•f‚à•Lp for some
0 < a,A < ‚àû. Also suppose that there is a constant C < ‚àûsuch that the maximal
operator T‚àó( f) = supŒµ>0 |TŒµ( f)| satisÔ¨Åes
T‚àó(h)‚à•Lp ‚â§C‚à•h‚à•Lp for all h ‚ààS (Rn).
Prove that the same inequality is valid for all f ‚ààLp(Rn).

Hint: For a Ô¨Åxed Œ¥ > 0 deÔ¨Åne SŒ¥( f) = supŒµ>Œ¥ |TŒµ( f)|, which is a subadditive func-
tional on Lp(Rn). For a Ô¨Åxed f0 ‚ààLp(Rn) deÔ¨Åne a linear space X0 = {Œª f0 : Œª ‚ààC}
and a linear functional T0 on X0 by setting T0(Œª f0) = ŒªSŒ¥( f0). By the Hahn‚Äì
Banach theorem there is an extension #T0 of T0 that satisÔ¨Åes |#T0( f)| ‚â§SŒ¥( f) for
all f ‚ààLp(Rn). Since SŒ¥ is Lp is bounded on Schwartz functions with norm at most
C, then so is #T0. But #T0 is linear and by density it is bounded on Lp(Rn) with norm
at most C; consequently, ‚à•SŒ¥( f0)‚à•Lp = ‚à•T0( f0)‚à•Lp = ‚à•#T0( f0)‚à•Lp ‚â§C‚à•f0‚à•Lp. The
required conclusion for T‚àófollows by Fatou‚Äôs lemma.

5.4 SufÔ¨Åcient Conditions for Lp Boundedness
We have used the Calder¬¥on‚ÄìZygmund decomposition to prove weak type (1,1)
boundedness for singular integral and maximal singular integral operators, assum-
ing that these operators are already L2 bounded. It is therefore natural to ask for
sufÔ¨Åcient conditions that imply L2 boundedness for such operators. Precisely, what
are sufÔ¨Åcient conditions on functions K on Rn \ {0} so that the corresponding sin-
gular and maximal singular integral operators associated with K are L2 bounded?
We saw in Section 5.2 that if K has the special form K(x) = Œ©(x/|x|)/|x|n for some
Œ© ‚ààL1(Sn‚àí1) with mean value zero, then condition (5.2.16) is necessary and suf-
Ô¨Åcient for the L2 boundedness of T, while the L2 boundedness of T (‚àó) requires the
stronger smoothness condition (5.2.24).
For the general K considered in this section (for which the corresponding op-
erator does not necessarily commute with dilations), we only give some sufÔ¨Åcient
conditions for L2 boundedness of T and T (‚àó‚àó).
Throughout this section K denotes a locally integrable function on Rn \{0} that
satisÔ¨Åes the ‚Äúsize‚Äù condition
sup
R>0

R‚â§|x|‚â§2R |K(x)|dx = A1 < ‚àû,
(5.4.1)

5.4 SufÔ¨Åcient Conditions for Lp Boundedness
375
the ‚Äúsmoothness‚Äù condition
sup
yÃ∏=0

|x|‚â•2|y| |K(x‚àíy)‚àíK(x)|dx = A2 < ‚àû,
(5.4.2)
and the ‚Äúcancellation‚Äù condition
sup
0<R1<R2<‚àû


R1<|x|<R2
K(x)dx
 = A3 < ‚àû,
(5.4.3)
for some A1,A2,A3 > 0. As mentioned earlier, condition (5.4.2) is often referred to
as H¬®ormander‚Äôs condition. In this section we show that these three conditions give
rise to convolution operators that are bounded on Lp.
5.4.1 SufÔ¨Åcient Conditions for Lp Boundedness of Singular
Integrals
We Ô¨Årst note that under conditions (5.4.1), (5.4.2), and (5.4.3), there exists a tem-
pered distribution W of the form (5.3.7) that coincides with K on Rn \{0}. Indeed,
condition (5.4.3) implies that there exists a sequence Œ¥ j ‚Üì0 such that
lim
j‚Üí‚àû

Œ¥ j<|x|‚â§1 K(x)dx = L
exists. Using (5.3.8), we conclude that there exists such a tempered distribution W.
Note that we must have |L| ‚â§A3.
We observe that the difference of two distributions W and W ‚Ä≤ that coincide with
K on Rn \{0} must be supported at the origin.
Theorem 5.4.1. Assume that K satisÔ¨Åes (5.4.1), (5.4.2), and (5.4.3), and let W be a
tempered distribution of the form (5.3.7) that coincides with K on Rn \{0}. Then we
have
sup
0<Œµ<N<‚àû
sup
Œæ‚ààRn |(KœáŒµ<|¬∑|<N)‚àß(Œæ)| ‚â§15(A1 +A2 +A3)
(5.4.4)
and consequently
sup
Œæ‚ààRn | 1W(Œæ)| ‚â§15(A1 +A2 +A3).
(5.4.5)
Thus the operator given by convolution with W maps L2(Rn) to itself with norm at
most 15(A1 +A2 +A3). Consequently, it also maps L1(Rn) to L1,‚àû(Rn) with bound
at most a dimensional constant multiple of A1 + A2 + A3 and Lp(Rn) to itself with
bound at most Cn max(p,(p‚àí1)‚àí1)(A1 +A2 +A3), when 1 < p < ‚àû, where Cn is a
dimensional constant.

376
5 Singular Integrals of Convolution Type
Proof. Let us set K(Œµ,N)(x) = K(x)œáŒµ<|x|<N. Estimate (5.4.4) implies that for all f
in S (Rn) we have
 f ‚àóK(Œ¥ j, j)
L2 ‚â§15(A1 +A2 +A3)
f

L2
uniformly in j. Using this, (5.3.9), and Fatou‚Äôs lemma, we obtain that
 f ‚àóW

L2 ‚â§15(A1 +A2 +A3)
f

L2 ,
for all f ‚ààS (Rn), and this is equivalent to (5.4.5).
Case 1: Suppose that Œµ < |Œæ|‚àí1 < N. Then we write

K(Œµ,N)(Œæ) = I1(Œæ)+I2(Œæ),
where
I1(Œæ) =

Œµ<|x|<|Œæ|‚àí1 K(x)e‚àí2œÄix¬∑Œæ dx,
I2(Œæ) =

|Œæ|‚àí1<|x|<N K(x)e‚àí2œÄix¬∑Œæ dx.
We now have
I1(Œæ) =

Œµ<|x|<|Œæ|‚àí1 K(x)dx+

Œµ<|x|<|Œæ|‚àí1 K(x)(e‚àí2œÄix¬∑Œæ ‚àí1)dx.
(5.4.6)
It follows that
|I1(Œæ)| ‚â§A3 +2œÄ|Œæ|

|x|<|Œæ|‚àí1 |x||K(x)|dx ‚â§A3 +2œÄ(2A1)
uniformly in Œµ. Let us now examine I2(Œæ). Let z =
Œæ
2|Œæ|2 so that e2œÄiz¬∑Œæ = ‚àí1 and
2|z| = |Œæ|‚àí1. By changing variables x = x‚Ä≤ ‚àíz, rewrite I2 as
I2(Œæ) = ‚àí

|Œæ|‚àí1<|x‚Ä≤‚àíz|<N K(x‚Ä≤ ‚àíz)e‚àí2œÄix‚Ä≤¬∑Œæ dx‚Ä≤ ;
hence averaging gives
I2(Œæ) = 1
2

|Œæ|‚àí1<|x|<NK(x)e‚àí2œÄix¬∑Œædx‚àí1
2

|Œæ|‚àí1<|x‚àíz|<NK(x‚àíz)e‚àí2œÄix¬∑Œæ dx.
Now use that

A F dx‚àí

B Gdx =

B(F ‚àíG)dx+

A\B F dx‚àí

B\A F dx
(5.4.7)

5.4 SufÔ¨Åcient Conditions for Lp Boundedness
377
to write I2(Œæ) = J1(Œæ)+J2(Œæ)+J3(Œæ)+J4(Œæ)+J5(Œæ), where
J1(Œæ) = + 1
2

|Œæ|‚àí1<|x‚àíz|<N

K(x)‚àíK(x‚àíz)

e‚àí2œÄix¬∑Œæ dx,
(5.4.8)
J2(Œæ) = + 1
2

|Œæ|‚àí1<|x|<N
|x‚àíz|‚â§|Œæ|‚àí1
K(x)e‚àí2œÄix¬∑Œæ dx,
(5.4.9)
J3(Œæ) = + 1
2

|Œæ|‚àí1<|x|<N
|x‚àíz|‚â•N
K(x)e‚àí2œÄix¬∑Œæ dx,
(5.4.10)
J4(Œæ) = ‚àí1
2

|Œæ|‚àí1<|x‚àíz|<N
|x|‚â§|Œæ|‚àí1
K(x)e‚àí2œÄix¬∑Œæ dx,
(5.4.11)
J5(Œæ) = ‚àí1
2

|Œæ|‚àí1<|x‚àíz|<N
|x|‚â•N
K(x)e‚àí2œÄix¬∑Œæ dx.
(5.4.12)
Since 2|z| = |Œæ|‚àí1, J1(Œæ) is bounded in absolute value by 1
2A2, in view of (5.4.2).
Next observe that |Œæ|‚àí1 ‚â§|x| ‚â§3
2|Œæ|‚àí1 in (5.4.9), while 1
2|Œæ|‚àí1 ‚â§|x| ‚â§|Œæ|‚àí1 in
(5.4.11); hence both J2 and J4 are bounded by 1
2A1. Finally, we have 1
2N < |x| < N
in (5.4.10) (since |x| > N ‚àí1
2|Œæ|‚àí1), and similarly we have N ‚â§|x| < 3
2N in (5.4.12).
Thus both J3 and J5 are bounded above by 1
2A1.
Case 2: If Œµ < N ‚â§|Œæ|‚àí1, then we write

Œµ<|x|<N K(x)e‚àí2œÄix¬∑Œæ dx =

Œµ<|x|<N K(x)dx+

Œµ<|x|<N K(x)(e‚àí2œÄix¬∑Œæ ‚àí1)dx
which is bounded in absolute value by
A3 +2œÄ|Œæ|

|x|‚â§|Œæ|‚àí1 |K(x)||x|dx ‚â§A3 +4œÄA1.
Notice that if Œæ = 0, only the Ô¨Årst term appears which is bounded by A3.
Case 2: If |Œæ|‚àí1 ‚â§Œµ < N, we write

Œµ<|x|<NK(x)e‚àí2œÄix¬∑Œædx =

|Œæ|‚àí1<|x|<NK(x)e‚àí2œÄix¬∑Œædx‚àí

|Œæ|‚àí1<|x|<ŒµK(x)e‚àí2œÄix¬∑Œædx,
and both of the terms on the right are similar to I2(Œæ) which was shown to be
bounded by 2A1 + 1
2A2.
In all cases (5.4.4) holds.
‚ñ°

378
5 Singular Integrals of Convolution Type
5.4.2 An Example
We now give an example of a distribution that satisÔ¨Åes conditions (5.4.1), (5.4.2),
and (5.4.3).
Example 5.4.2. Let œÑ be a nonzero real number and let K(x) =
1
|x|n+iœÑ deÔ¨Åned for
x ‚ààRn \{0}. For a sequence Œ¥k ‚Üì0 and œï a Schwartz function on Rn, deÔ¨Åne
4
W,œï
5
= lim
k‚Üí‚àû

Œ¥k‚â§|x| œï(x)
dx
|x|n+iœÑ ,
(5.4.13)
whenever the limit exists. We claim that for some choices of sequences Œ¥k, W is a
well deÔ¨Åned tempered distribution on Rn. Take, for example, Œ¥k = e‚àí2œÄk/œÑ. For this
sequence Œ¥k, observe that

Œ¥k‚â§|x|‚â§1
1
|x|n+iœÑ dx = œân‚àí1
1‚àí(e‚àí2œÄk/œÑ)‚àíiœÑ
‚àíiœÑ
= 0,
and thus
4
W,œï
5
=

|x|‚â§1(œï(x)‚àíœï(0))
dx
|x|n+iœÑ +

|x|‚â•1 œï(x)
dx
|x|n+iœÑ ,
(5.4.14)
which implies that W ‚ààS ‚Ä≤(Rn), since
4
W,œï
5 ‚â§C
‚àáœï

L‚àû+
|x|œï(x)

L‚àû

.
If œï is supported in Rn \{0}, then
4
W,œï
5
=

Rn K(x)œï(x)dx.
Therefore W coincides with the function K away from the origin. Moreover, (5.4.1)
and (5.4.2) are clearly satisÔ¨Åed for K, while (5.4.3) is also satisÔ¨Åed, since


R1<|x|<R2
1
|x|n+iœÑ dx
 = œân‚àí1

R‚àíiœÑ
1
‚àíR‚àíiœÑ
2
‚àíiœÑ
 ‚â§2œân‚àí1
|œÑ|
.
Remark 5.4.3. It is important to emphasize that the limit in (5.4.13) may not exist
for all sequences Œ¥k ‚Üí0. For example, the limit in (5.4.13) does not exist if Œ¥k =
e‚àíœÄk/œÑ. Moreover, for a different choice of a sequence Œ¥k for which the limit in
(5.4.13) exists (for example, Œ¥k = e‚àíœÄ(2k+1)/œÑ), we obtain a different distribution W1
that coincides with the function K(x) = |x|‚àín‚àíiœÑ on Rn \{0}.
We discuss a point of caution. We can directly check that the distributions W
deÔ¨Åned by (5.4.13) are not homogeneous distributions of degree ‚àín ‚àíiœÑ. In fact,
the only homogeneous distribution of degree ‚àín‚àíiœÑ that coincides with the func-
tion |x|‚àín‚àíiœÑ away from zero is a multiple of the distribution u‚àín‚àíiœÑ, where uz is

5.4 SufÔ¨Åcient Conditions for Lp Boundedness
379
deÔ¨Åned in (2.4.7). Let us investigate the relationship between u‚àín‚àíiœÑ and W deÔ¨Åned
in (5.4.14). Recall that (2.4.8) gives
4
u‚àín‚àíiœÑ,œï
5
=

|x|‚â•1 œï(x) œÄ‚àíi œÑ
2
Œì (‚àíi œÑ
2)|x|‚àín‚àíiœÑ dx
+

|x|‚â§1(œï(x)‚àíœï(0)) œÄ‚àíi œÑ
2
Œì (‚àíi œÑ
2)|x|‚àín‚àíiœÑ dx+ œân‚àí1œÄ‚àíi œÑ
2
‚àíiœÑŒì (‚àíi œÑ
2)œï(0).
Using (5.4.14), we conclude that u‚àín‚àíiœÑ ‚àíc1W = c2Œ¥0 for suitable nonzero constants
c1 and c2. Since the Dirac mass at the origin is not a homogeneous distribution of
degree ‚àín‚àíiœÑ, it follows that neither is W.
Since

u‚àín‚àíiœÑ = uiœÑ = c3|Œæ|iœÑ ,
the identity u‚àín‚àíiœÑ ‚àíc1W = c2Œ¥0 can be used to obtain a formula for the Fourier
transform of W and thus produce a different proof that convolution with W is a
bounded operator on L2(Rn).
5.4.3 Necessity of the Cancellation Condition
Although conditions (5.4.1), (5.4.2), and (5.4.3) are sufÔ¨Åcient for L2 boundedness,
they might not necessary. However, we show that (5.4.3) is a necessary condition,
given (5.4.1).
Proposition 5.4.4. Suppose that K is a function on Rn \ {0} that satisÔ¨Åes (5.4.1).
Let W be a tempered distribution on Rn related to K as in (5.3.7). If the operator
T given by convolution with W maps L2(Rn) to itself (equivalently if 1W is an L‚àû
function), then the function K must satisfy (5.4.3).
Proof. Pick a radial C ‚àûfunction œï supported in the ball |x| ‚â§2 with 0 ‚â§œï ‚â§1,
and œï(x) = 1 when |x| ‚â§1. For R > 0 let œïR(x) = œï(x/R). Fourier inversion for
distributions gives the second equality,
(W ‚àóœïR)(0) =
4
W,œïR5
=
4 1W, 2
œïR5
=

Rn 1W(Œæ)Rn 1œï(RŒæ)dŒæ ,
and the preceding identity implies that
|(W ‚àóœïR)(0)| ‚â§
 1W

L‚àû
1œï

L1 =
T

L2‚ÜíL2
1œï

L1
uniformly in R > 0. Fix 0 < R1 < R2 < ‚àû. If R2 ‚â§2R1, we have


R1<|x|<R2
K(x)dx
 ‚â§

R1<|x|<2R1
|K(x)|dx ‚â§A1 ,

380
5 Singular Integrals of Convolution Type
which implies the required conclusion. We may therefore assume that 2R1 < R2.
Since the part of the integral in (5.4.3) over the set R1 < |x| < 2R1 is controlled by
A1, it sufÔ¨Åces to control the integral of K(x) over the set 2R1 < |x| < R2. Since the
function œïR2 ‚àíœïR1 is supported away from the origin, the action of the distribution
W on it can be written as integration against the function K. We have

RnK(x)(œïR2(x)‚àíœïR1(x))dx
=

2R1<|x|<R2
K(x)dx+

R1<|x|<2R1
K(x)(1‚àíœïR1(x))dx+

R2<|x|<2R2
K(x)œïR2(x)dx.
The sum of the last two integrals is bounded by 3A1 (since 0 ‚â§œï ‚â§1), while the
Ô¨Årst integral is equal to
(W ‚àóœïR2)(0)‚àí(W ‚àóœïR1)(0)
and is therefore bounded by 2‚à•T‚à•L2‚ÜíL2‚à•1œï ‚à•L1. We conclude that the function K
must satisfy (5.4.3) with constant
A3 ‚â§3A1 +2‚à•1œï ‚à•L1‚à•T‚à•L2‚ÜíL2 ‚â§c

A1 +‚à•T‚à•L2‚ÜíL2

.
This establishes the assertion.
‚ñ°
5.4.4 SufÔ¨Åcient Conditions for Lp Boundedness of Maximal
Singular Integrals
We now discuss the analogous result to Theorem 5.4.1 for the maximal singular
integral operator T (‚àó‚àó).
Theorem 5.4.5. Suppose that K satisÔ¨Åes (5.4.1), (5.4.2), and (5.4.3) and let T (‚àó‚àó) be
as in (5.3.18). Then T (‚àó‚àó) is bounded on Lp(Rn), 1 < p < ‚àû, with norm
T (‚àó‚àó)
Lp‚ÜíLp ‚â§Cn max(p,(p‚àí1)‚àí1)(A1 +A2 +A3),
where Cn is a dimensional constant.
Proof. We Ô¨Årst deÔ¨Åne an operator T associated with K that satisÔ¨Åes (5.4.1), (5.4.2),
and (5.4.3). Because of condition (5.4.3), there exists a sequence Œ¥ j ‚Üì0 such that
lim
j‚Üí‚àû

Œ¥ j<|x|‚â§1 K(x)dx
exists. Therefore, for œï ‚ààS (Rn) we can deÔ¨Åne a tempered distribution
4
W,œï
5
= lim
j‚Üí‚àû

Œ¥ j‚â§|x|‚â§j K(x)œï(x)dx

5.4 SufÔ¨Åcient Conditions for Lp Boundedness
381
and an operator T given by T( f) = f ‚àóW for f ‚ààS (Rn). In view of Theorems 5.4.1
and 5.3.3, T admits an Lp bounded extension (1 < p < ‚àû) with
T

Lp‚ÜíLp ‚â§cn max(p,(p‚àí1)‚àí1)(A1 +A2 +A3)
(5.4.15)
and is weak type (1,1). This extension is still denoted by T.
Fix 1 < p < ‚àûand f ‚ààLp(Rn)‚à©L‚àû(Rn) with compact support. We have
T (Œµ,N)( f)(x)
=

Œµ‚â§|x‚àíy|<N K(x‚àíy) f(y)dy = T (Œµ)( f)(x)‚àíT (N)( f)(x)
=

Œµ‚â§|x‚àíy| K(x‚àíy) f(y)dy‚àí

N‚â§|x‚àíy| K(x‚àíy) f(y)dy
=

Œµ‚â§|x‚àíy|(K(x‚àíy)‚àíK(z1 ‚àíy)) f(y)dy+

Œµ‚â§|x‚àíy| K(z1 ‚àíy) f(y)dy
‚àí

N‚â§|x‚àíy|(K(x‚àíy)‚àíK(z2 ‚àíy)) f(y)dy‚àí

N‚â§|x‚àíy| K(z2 ‚àíy) f(y)dy
=

Œµ‚â§|x‚àíy|(K(x‚àíy)‚àíK(z1 ‚àíy)) f(y)dy+T( f)(z1)‚àíT( f œá|x‚àí¬∑|<Œµ)(z1)
‚àí

N‚â§|x‚àíy|(K(x‚àíy)‚àíK(z2 ‚àíy)) f(y)dy‚àíT( f)(z2)+T( f œá|x‚àí¬∑|<N)(z2),
where z1 and z2 are arbitrary points in Rn that satisfy |z1 ‚àíx| ‚â§Œµ
2 and |z2 ‚àíx| ‚â§N
2 .
We used that f has compact support in order to be able to write T (Œµ)( f)(x) and
T (N)( f)(x) as convergent integrals for almost every x.
At this point we take absolute values, average over |z1 ‚àíx| ‚â§Œµ
2 and |z2 ‚àíx| ‚â§N
2 ,
and we apply H¬®older‚Äôs inequality in two terms. We obtain the estimate
|T (Œµ,N)( f)(x)|
‚â§1
vn
2
Œµ
n 
|z1‚àíx|‚â§Œµ
2

|x‚àíy|‚â•Œµ |K(x‚àíy)‚àíK(z1 ‚àíy)|| f(y)|dydz1
+ 1
vn
2
Œµ
n 
|z1‚àíx|‚â§Œµ
2
|T( f)(z1)|dz1
+
 1
vn
2
Œµ
n 
|z1‚àíx|‚â§Œµ
2
|T( f œá|x‚àí¬∑|<Œµ)(z1)|p dz1
 1
p
+ 1
vn
 2
N
n 
|z2‚àíx|‚â§N
2

|x‚àíy|‚â•N |K(x‚àíy)‚àíK(z2 ‚àíy)|| f(y)|dydz2
+ 1
vn
 2
N
n 
|z2‚àíx|‚â§N
2
|T( f)(z2)|dz2
+
 1
vn
 2
N
n 
|z2‚àíx|‚â§N
2
|T( f œá|x‚àí¬∑|<N)(z2)|p dz2
 1
p
,

382
5 Singular Integrals of Convolution Type
where vn is the volume of the unit ball in Rn. Applying condition (5.4.2) and estimate
(5.4.15), we obtain for f in Lp(Rn)‚à©L‚àû(Rn) with compact support that
|T (Œµ,N)( f)(x)|
‚â§1
vn
2
Œµ
n 
|z1‚àíx|‚â§Œµ
2
|T( f)(z1)|dz1 + 1
vn
 2
N
n 
|z2‚àíx|‚â§N
2
|T( f)(z2)|dz2
+cn
 3
‚àë
j=1
Aj

max(p,(p‚àí1)‚àí1)
 1
vn
2
Œµ
n 
|z1‚àíx|‚â§Œµ | f(z1)|p dz1
 1
p
+cn
 3
‚àë
j=1
Aj

max(p,(p‚àí1)‚àí1)
 1
vn
 2
N
n 
|z2‚àíx|‚â§N | f(z2)|p dz2
 1
p
+2A2
 f

L‚àû.
We now use density to remove the compact support condition on f and obtain the
last displayed estimate for all functions f in Lp(Rn)‚à©L‚àû(Rn). Taking the supremum
over all 0 < Œµ < N and over all N > 0, we deduce that for all f in Lp(Rn)‚à©L‚àû(Rn)
we have the estimate
T (‚àó‚àó)( f)(x) ‚â§2A2
f

L‚àû+Sp( f)(x),
(5.4.16)
where Sp is the sublinear operator deÔ¨Åned by
Sp( f)(x) = 2M(T( f))(x)+3n+1cn
 3
‚àë
j=1
Aj

max(p,(p‚àí1)‚àí1)(M(| f|p)(x))
1
p ,
and M is the Hardy‚ÄìLittlewood maximal operator.
Recalling that M maps L1 to L1,‚àûwith bound at most 3n and also Lp to Lp,‚àûwith
bound at most 2 ¬∑ 3n/p for 1 < p < ‚àû(Exercise 2.1.4), we conclude that Sp maps
Lp(Rn) to Lp,‚àû(Rn) with norm at most
Sp

Lp‚ÜíLp,‚àû‚â§#cn(A1 +A2 +A3)max(p,(p‚àí1)‚àí1),
(5.4.17)
where #cn is another dimensional constant.
Now write f = fŒ± + f Œ±, where
fŒ± = f œá| f|‚â§Œ±/(16A2)
and
f Œ± = f œá| f|>Œ±/(16A2).
The function fŒ± is in L‚àû‚à©Lp and f Œ± is in L1 ‚à©Lp. Moreover, we see that
f Œ±
L1 ‚â§(16A2/Œ±)p‚àí1f
p
Lp.
(5.4.18)

5.4 SufÔ¨Åcient Conditions for Lp Boundedness
383
Apply the Calder¬¥on‚ÄìZygmund decomposition (Theorem 5.3.1) to the function f Œ± at
height Œ±Œ≥ to write f Œ± = gŒ± + bŒ±, where gŒ± is the good function and bŒ± is the bad
function of this decomposition. Using (5.3.1), we obtain
gŒ±
Lp ‚â§2n/p‚Ä≤(Œ±Œ≥)1/p‚Ä≤ f Œ±1/p
L1 ‚â§2(n+4)/p‚Ä≤(A2Œ≥)1/p‚Ä≤ f

Lp.
(5.4.19)
We now use (5.4.16) to get
|{x ‚ààRn : T (‚àó‚àó)( f)(x) > Œ±}| ‚â§b1 +b2 +b3 ,
(5.4.20)
where
b1 = |{x ‚ààRn : 2A2
 fŒ±

L‚àû+Sp( fŒ±)(x) > Œ±/4}|,
b2 = |{x ‚ààRn : 2A2
gŒ±
L‚àû+Sp(gŒ±)(x) > Œ±/4}|,
b3 = |{x ‚ààRn : T (‚àó‚àó)(bŒ±)(x) > Œ±/2}|.
Observe that 2A2‚à•fŒ±‚à•L‚àû‚â§Œ±/8. Selecting Œ≥ = 2‚àín‚àí5(A1 + A2)‚àí1 and using prop-
erty (2) in Theorem 5.3.1, we obtain
2A2
gŒ±
L‚àû‚â§A22n+1Œ±Œ≥ ‚â§Œ±2‚àí4 < Œ±
8
and therefore
b1 ‚â§|{x ‚ààRn : Sp( fŒ±)(x) > Œ±/8}|,
b2 ‚â§|{x ‚ààRn : Sp(gŒ±)(x) > Œ±/8}|.
(5.4.21)
Since Œ≥ ‚â§(2n+5A1)‚àí1, it follows from (5.3.27) that
b3 ‚â§


j
Q‚àó
j
+2n+8A2
f Œ±
L1
Œ±
‚â§
(5‚àön)n
Œ≥
+2n+8A2
f Œ±
L1
Œ±
,
and using (5.4.18), we obtain
b3 ‚â§Cn(A1 +A2)pŒ±‚àípf
p
Lp.
Using Chebyshev‚Äôs inequality in (5.4.21) and (5.4.17), we Ô¨Ånally obtain that
b1 +b2 ‚â§(8/Œ±)p (#cn)p(A1+A2+A3)p max(p,(p‚àí1)‚àí1)pf
p
Lp +
gŒ±p
Lp

.
Combining the estimates for b1,b2, and b3 and using (5.4.19), we deduce
T (‚àó‚àó)( f)

Lp,‚àû‚â§Cn(A1 +A2 +A3)max(p,(p‚àí1)‚àí1)
f

Lp(Rn) .
(5.4.22)
Finally, we need to obtain a similar estimate to (5.4.22), in which the weak Lp norm
on the left is replaced by the Lp norm. This is a consequence of Theorem 1.3.2 via

384
5 Singular Integrals of Convolution Type
interpolation between the estimates L
p+1
2 ‚ÜíL
p+1
2 ,‚àûand L2p ‚ÜíL2p,‚àûfor 2 < p < ‚àû
and between the estimates L2p ‚ÜíL2p,‚àûand L1 ‚ÜíL1,‚àûfor 1 < p < 2. The latter
estimate follows from Theorem 5.3.5. See also Corollary 5.3.7.
‚ñ°
Exercises
5.4.1. Let T be a convolution operator that is L2 bounded. Suppose that a given
function f0 ‚ààL1(Rn) ‚à©L2(Rn) has vanishing integral and that T( f0) is integrable.
Prove that T( f0) also has vanishing integral.
5.4.2. Let K satisfy (5.4.1), (5.4.2), and (5.4.3) and let W ‚ààS ‚Ä≤ be an extension of
K on Rn. Let f be a compactly supported C 1 function on Rn with mean value zero.
Prove that the function f ‚àóW is in L1(Rn).
5.4.3. Suppose K is a function on Rn \{0} that satisÔ¨Åes (5.4.1), (5.4.2), and (5.4.3).
Let K(Œµ,N)(x) = K(x)œáŒµ<|x|<N for 0 < Œµ < N < ‚àûand let T (Œµ,N) be the operator given
by convolution with K(Œµ,N). Let 1 < p < ‚àûand f ‚ààLp(Rn). Prove that for some
sequence Œµ j ‚Üì0, T (Œµ j,N)( f) converges almost everywhere as j ‚Üí‚àûand N ‚Üí‚àû.

Hint: Use Theorems 5.4.5 and 2.1.14.

5.4.4. (a) Prove that for all x,y ‚ààRn that satisfy 0 Ã∏= x Ã∏= y we have

x‚àíy
|x‚àíy| ‚àíx
|x|
 ‚â§2 |y|
|x| .
(b) Let Œ© be an integrable function with mean value zero on the sphere Sn‚àí1. Sup-
pose that Œ© satisÔ¨Åes a Lipschitz (H¬®older) condition of order 0 < Œ± < 1 on Sn‚àí1.
This means that
|Œ©(Œ∏1)‚àíŒ©(Œ∏2)| ‚â§B0|Œ∏1 ‚àíŒ∏2|Œ±
for all Œ∏1,Œ∏2 ‚ààSn‚àí1. Prove that K(x) = Œ©(x/|x|)/|x|n satisÔ¨Åes H¬®ormander‚Äôs condi-
tion (5.4.3) with constant at most a multiple of B0 +‚à•Œ©‚à•L‚àû.
5.4.5. Let Œ© be an L1 function on Sn‚àí1 with mean value zero.
(a) Let œâ‚àû(t) = sup{|Œ©(Œ∏1) ‚àíŒ©(Œ∏2)| : Œ∏1,Œ∏2 ‚ààSn‚àí1, |Œ∏1 ‚àíŒ∏2| ‚â§t} and suppose
that the following Dini condition holds:
 1
0 œâ‚àû(t)dt
t < ‚àû.
Prove that the function K(x)=Œ©(x/|x|)|x|‚àín satisÔ¨Åes H¬®ormander‚Äôs condition.
(b) (A. Calder¬¥on and A. Zygmund) For A ‚ààO(n), let
A
 = sup{|Œ∏ ‚àíA(Œ∏)| : Œ∏ ‚ààSn‚àí1}.

5.5 Vector-Valued Inequalities
385
Suppose that Œ© satisÔ¨Åes the more general Dini-type condition
 1
0 œâ1(t)dt
t < ‚àû,
where
œâ1(t) = sup
A‚ààO(n)
‚à•A‚à•‚â§t

Sn‚àí1 |Œ©(A(Œ∏))‚àíŒ©(Œ∏)|dŒ∏ .
Prove the same conclusion as in part (a).

Hint: Part (b): Use the result in part (a) of Exercise 5.4.4 and switch to polar
coordinates.

5.5 Vector-Valued Inequalities
Certain nonlinear expressions that appear in Fourier analysis, such as maximal func-
tions and square functions, can be viewed as linear quantities taking values in some
Banach space. This point of view provides the motivation for a systematic study of
Banach-valued operators. Let us illustrate this line of thinking via an example. Let
T be a linear operator acting on Lp of some measure space (X,Œº) and taking values
in the set of measurable functions of another measure space (Y,ŒΩ). The seemingly
nonlinear inequality


‚àë
j
|T( f j)|21
2 
Lp ‚â§Cp


‚àë
j
| f j|21
2 
Lp
(5.5.1)
can be transformed to a linear one with only a slight change of view. Let us denote
by Lp(X,‚Ñì2) the Banach space of all sequences {f j}j of measurable functions on X
that satisfy
{f j}j

Lp(X,‚Ñì2) =

X

‚àë
j
| f j|2p
2 dŒº
1
p
< ‚àû.
(5.5.2)
DeÔ¨Åne a linear operator acting on such sequences by setting
‚ÉóT({f j}j) = {T( f j)}j.
(5.5.3)
Then (5.5.1) is equivalent to the inequality
‚ÉóT({f j}j)

Lp(Y,‚Ñì2) ‚â§Cp
{f j}j

Lp(X,‚Ñì2) ,
(5.5.4)
in which ‚ÉóT is thought of as a linear operator acting on the Lp space of ‚Ñì2-valued
functions on X. This is the basic idea of vector-valued inequalities. A nonlinear
inequality such as (5.5.1) can be viewed as a linear norm estimate for an operator
acting and taking values in suitable Banach spaces.

386
5 Singular Integrals of Convolution Type
5.5.1 ‚Ñì2-Valued Extensions of Linear Operators
The following result is classical and fundamental in the subject of vector-valued
inequalities.
Theorem 5.5.1. Let 0 < p,q < ‚àûand let (X,Œº) and (Y,ŒΩ) be two œÉ-Ô¨Ånite measure
spaces. The following are valid:
(a) Suppose that T is a bounded linear operator from Lp(X) to Lq(Y) with norm N.
Then T has an ‚Ñì2-valued extension, that is, for all complex-valued functions f j in
Lp(X) we have


‚àë
j
|T( f j)|21
2 
Lq(Y) ‚â§Cp,q N


‚àë
j
| f j|21
2 
Lp(X)
(5.5.5)
for some constant Cp,q that satisÔ¨Åes Cp,q = 1 if p ‚â§q. Moreover, if T maps real-
valued Lp functions to real-valued Lq functions with norm Nreal, then (5.5.5) holds
for real-valued functions f j with Nreal in place of N.
(b) Suppose that T is a bounded linear operator from Lp(X) to Lq,‚àû(Y) with norm
M. Then T has an ‚Ñì2-valued extension, that is,


‚àë
j
|T( f j)|21
2 
Lq,‚àû(Y) ‚â§Dp,q M


‚àë
j
| f j|21
2 
Lp(X)
(5.5.6)
for some constant Dp,q that depends only on p and q. Moreover, if T maps real-
valued Lp functions to real-valued Lq,‚àûfunctions with norm Mreal, then (5.5.5) holds
for real-valued functions f j with Mreal in place of M.
To prove this theorem, we need the following identities.
Lemma 5.5.2. For any 0 < r < ‚àû, deÔ¨Åne constants
Ar =
Œì ( r+1
2 )
œÄ
r+1
2
1
r
and
Br =
Œì ( r
2+1)
œÄ
r
2
1
r
.
(5.5.7)
Then for any Œª1,Œª2,...,Œªn ‚ààR we have

Rn |Œª1x1 +¬∑¬∑¬∑+Œªnxn|re‚àíœÄ|x|2dx
1
r
= Ar (Œª 2
1 +¬∑¬∑¬∑+Œª 2
n )
1
2 ,
(5.5.8)
where dx = dx1 ¬∑¬∑¬∑dxn. Also for all w1,w2,...,wn ‚ààC we have

Cn |w1z1 +¬∑¬∑¬∑+wnzn|re‚àíœÄ|z|2dz
1
r
= Br(|w1|2 +¬∑¬∑¬∑+|wn|2)
1
2 ,
(5.5.9)
where dz = dz1 ¬∑¬∑¬∑dzn = dx1dy1 ¬∑¬∑¬∑dxndyn if z j = xj +iyj.

5.5 Vector-Valued Inequalities
387
Proof. Dividing both sides of (5.5.8) by (Œª 2
1 + ¬∑¬∑¬∑ + Œª 2
n )
1
2 , we reduce things to the
situation in which Œª 2
1 + ¬∑¬∑¬∑ + Œª 2
n = 1. Let e1 = (1,0,...,0)t be the standard basis
column unit vector on Rn and Ô¨Ånd an orthogonal n√ón matrix A ‚ààO(n) (orthogonal
means a real matrix satisfying At = A‚àí1) such that A‚àí1e1 = (Œª1,...,Œªn)t. Then the
Ô¨Årst coordinate of Ax is
(Ax)1 = Ax¬∑e1 = x¬∑Ate1 = x¬∑A‚àí1e1 = Œª1x1 +¬∑¬∑¬∑+Œªnxn .
Now change variables y = Ax in the integral in (5.5.8) and use the fact that |Ax| = |x|
to obtain

Rn |Œª1x1 +¬∑¬∑¬∑+Œªnxn|re‚àíœÄ|x|2dx
1
r
=

Rn |y1|re‚àíœÄ|y|2dy
1
r
=

2
 ‚àû
0 tre‚àíœÄt2dt
1
r
=
 ‚àû
0 s
r‚àí1
2 e‚àíœÄsds
1
r
=
Œì ( r+1
2 )
œÄ
r+1
2
1
r
= Ar ,
which proves (5.5.8). We used the fact that

R e‚àíœÄ|x|2dx = 1.
The proof of (5.5.9) is almost identical. We normalize by assuming that
|w1|2 +¬∑¬∑¬∑+|wn|2 = 1,
and we let Œµ1 be the column vector of Cn having 1 in the Ô¨Årst entry and zero
elsewhere. We Ô¨Ånd a unitary n √ó n matrix A such that A ‚àí1Œµ1 = (w1,...,wn)t.
Unitary means A ‚àí1 = A ‚àó, where A ‚àóis the conjugate transpose matrix of A ,
i.e., the matrix whose entries are the complex conjugates of A t and that satis-
Ô¨Åes u ¬∑ A v = A ‚àóu ¬∑ v for all u,v ‚ààCn. Then (A z)1 = w1z1 + ¬∑¬∑¬∑ + wnzn and also
|A z| = |z|; therefore, changing variables Œ∂ = A z in the integral in (5.5.9), we can
rewrite that integral as

Cn |Œ∂1|re‚àíœÄ|Œ∂|2dŒ∂
1
r
=

C |Œ∂1|re‚àíœÄ|Œ∂1|2dŒ∂1
1
r
=

2œÄ
 ‚àû
0 tre‚àíœÄt2t dt
1
r
=

œÄ
 ‚àû
0 s
r
2 e‚àíœÄsds
1
r

388
5 Singular Integrals of Convolution Type
=
Œì ( r
2+1)
œÄ
r
2
1
r
= Br ,
where the second equality follows by polar coordinates and the third by the change
of variables s = t2.
‚ñ°
We now continue with the proof of Theorem 5.5.1.
Proof. The proof is based on conclusion (5.5.9) of Lemma 5.5.2.
Part (a): Assume Ô¨Årst that q < p and let Br be as in (5.5.7). We may assume
that the sequence {f j}j is indexed by Z+. Use successively identity (5.5.9), the
boundedness of T, H¬®older‚Äôs inequality with exponents p/q and (p/q)‚Ä≤ with respect
to the measure e‚àíœÄ|z|2dz, and identity (5.5.9) again to deduce for n ‚ààZ+

 n
‚àë
j=1
|T( f j)|21
2 
q
Lq(Y) = (Bq)‚àíq

Y

Cn |z1T( f1)+¬∑¬∑¬∑+znT( fn)|qe‚àíœÄ|z|2dzdŒΩ
= (Bq)‚àíq

Cn

Y |T(z1 f1 +¬∑¬∑¬∑+zn fn)|q dŒΩ e‚àíœÄ|z|2dz
‚â§(Bq)‚àíqNq

Cn

X |z1 f1 +¬∑¬∑¬∑+zn fn|p dŒº
 q
p
e‚àíœÄ|z|2dz
‚â§(Bq)‚àíqNq

Cn

X |z1 f1 +¬∑¬∑¬∑+zn fn|p dŒº e‚àíœÄ|z|2dz
 q
p
= (Bq)‚àíqNq

Bp
p

X
 n
‚àë
j=1
| f j|2 p
2 dŒº
 q
p
= (BpB‚àí1
q )qNq
 n
‚àë
j=1
| f j|21
2 
q
Lp(X) .
Now, letting n ‚Üí‚àûin the previous inequality, we obtain the required conclusion
with Cp,q = BpB‚àí1
q
when q < p.
We now turn to the case q ‚â•p. Using similar reasoning, we obtain

 n
‚àë
j=1
|T( f j)|21
2 
q
Lq(Y) = (Bq)‚àíq

Y

Cn |z1T( f1)+¬∑¬∑¬∑+znT( fn)|qe‚àíœÄ|z|2dzdŒΩ
= (Bq)‚àíq

Cn

Y |T(z1 f1 +¬∑¬∑¬∑+zn fn)|q dŒΩ e‚àíœÄ|z|2dz
‚â§(NB‚àí1
q )q

Cn

X |z1 f1 +¬∑¬∑¬∑+zn fn|p dŒº
 q
p
e‚àíœÄ|z|2dz
= (NB‚àí1
q )q

X |z1 f1 +¬∑¬∑¬∑+zn fn|p dŒº

q/p
L
q
p (Cn,e‚àíœÄ|z|2dz)
‚â§(NB‚àí1
q )q
$
X
|z1 f1 +¬∑¬∑¬∑+zn fn|p
L
q
p (Cn,e‚àíœÄ|z|2dz)dŒº
%q
p

5.5 Vector-Valued Inequalities
389
= (NB‚àí1
q )q
$
X

Cn |z1 f1 +¬∑¬∑¬∑+zn fn|qe‚àíœÄ|z|2dz
p
q
dŒº
%q
p
= (NB‚àí1
q )q
$
X(Bq)p n
‚àë
j=1
| f j|2 p
2 dŒº
% q
p
= Nq
 n
‚àë
j=1
| f j|21
2 
q
Lp(X) .
Note that we made use of Minkowski‚Äôs integral inequality (Exercise 1.1.6) in the last
inequality. Letting n ‚Üí‚àûproves the required conclusion with Cp,q = 1 if q ‚â•p.
If T happens to map real-valued functions to real-valued functions, then we adapt
the preceding argument by taking f j to be real-valued functions, we replace Bp by
Ap, Bq by Aq, N by Nreal and we use identity (5.5.8) instead of (5.5.9).
Part (b): Inequality (5.5.6) will be a consequence of (5.5.5) and of the following
result of Exercise 1.1.12 which holds when Y is œÉ-Ô¨Ånite:
‚à•g‚à•Lq,‚àû‚â§
sup
0<ŒΩ(E)<‚àû
ŒΩ(E)
1
q ‚àí1
r

E |g|r dŒΩ
1
r
‚â§

q
q‚àír
1
r ‚à•g‚à•Lq,‚àû,
(5.5.10)
where 0 < r < q and the supremum is taken over all subsets E of Y of Ô¨Ånite measure.
Using (5.5.10), we obtain


‚àë
j
|T( f j)|21
2 
Lq,‚àû(Y)
‚â§
sup
0<ŒΩ(E)<‚àû
ŒΩ(E)
1
q ‚àí1
r

E

‚àë
j
|T( f j)|2r
2 dŒΩ
1
r
=
sup
0<ŒΩ(E)<‚àû
ŒΩ(E)
1
q ‚àí1
r

Y

‚àë
j
|œáE T( f j)|2r
2 dŒΩ
1
r
‚â§
sup
0<ŒΩ(E)<‚àû
ŒΩ(E)
1
q ‚àí1
r TE

Lp‚ÜíLrCp,r

X

‚àë
j
| f j|2p
2 dŒº
1
p
,
(5.5.11)
where TE is deÔ¨Åned by TE( f) = œáE T( f). Since for any function f in Lp(X) we have
ŒΩ(E)
1
q ‚àí1
r TE( f)

Lr ‚â§

q
q‚àír
1
r T( f)

Lq,‚àû‚â§

q
q‚àír
1
r M
f

Lp ,
it follows that for any measurable set E of Ô¨Ånite measure the estimate
ŒΩ(E)
1
q ‚àí1
r TE

Lp‚ÜíLr ‚â§

q
q‚àír
1
r M
(5.5.12)
is valid. Inserting (5.5.12) in (5.5.11), we obtain (5.5.6) with Dp,q = Cp,r
 q
q‚àír
1
r and
0 < r < q. Recall that Cp,r = 1 if r ‚â•p and Cp,r = BpB‚àí1
r
if r < p.

390
5 Singular Integrals of Convolution Type
If T happens to map real-valued functions to real-valued functions, then we take
f j to be real-valued and we replace M by Mreal, Br by Ar, and Bq by Aq in the
preceding argument.
‚ñ°
5.5.2 Applications and ‚Ñìr-Valued Extensions of Linear Operators
Here is an application of Theorem 5.5.1:
Example 5.5.3. On the real line consider the intervals Ij = [bj,‚àû) for j ‚ààZ. Let Tj
be the operator given by multiplication on the Fourier transform by the characteristic
function of Ij. Then we have the following two inequalities:


‚àë
j‚ààZ
|Tj( f j)|21
2 
Lp(R) ‚â§Cp


‚àë
j‚ààZ
| f j|21
2 
Lp(R) ,
(5.5.13)


‚àë
j‚ààZ
|Tj( f j)|21
2 
L1,‚àû(R) ‚â§C


‚àë
j‚ààZ
| f j|21
2 
L1(R) ,
(5.5.14)
for 1 < p < ‚àû. To prove these, Ô¨Årst observe that the operator T = 1
2(I +iH) is given
on the Fourier transform by multiplication by the characteristic function of the half-
axis [0,‚àû) [precisely, the Fourier multiplier of T is equal to 1 on the set (0,‚àû)
and 1/2 at the origin; this function is almost everywhere equal to the characteristic
function of the half-axis [0,‚àû)]. Moreover, each Tj is given by
Tj( f)(x) = e2œÄib jxT(e‚àí2œÄib j(¬∑) f)(x)
and thus with gj(x) = e‚àí2œÄib jx f(x), (5.5.13) and (5.5.14) can be written respectively
as


‚àë
j‚ààZ
|T(gj)|21
2 
Lp(R) ‚â§Cp


‚àë
j‚ààZ
|gj|21
2 
Lp(R),


‚àë
j‚ààZ
|T(gj)|21
2 
L1,‚àû(R) ‚â§C


‚àë
j‚ààZ
|gj|21
2 
L1(R).
Theorem 5.5.1 gives that both of the previous estimates are valid by in view of the
boundedness of T = 1
2(I + iH) from Lp to Lp and from L1 ‚ÜíL1,‚àû. For a slight
generalization and an extension to higher dimensions, see Exercise 5.6.1.
We have now seen that bounded operators from Lp to Lq (or to Lq,‚àû) always
admit ‚Ñì2-valued extensions. It is natural to ask whether they also admit ‚Ñìr-valued
extensions for some r Ã∏= 2. For some values of r we may answer this question. Here
is a straightforward corollary of Theorem 5.5.1.

5.5 Vector-Valued Inequalities
391
Corollary 5.5.4. Let (X,Œº) and (Y,ŒΩ) be œÉ-Ô¨Ånite measure spaces. Suppose that T
is a linear bounded operator from Lp(X) to Lp(Y) with norm A for some 1 < p < ‚àû.
Let r be a number between p and 2. Then we have


‚àë
j
|T( f j)|r1
r 
Lp(Y) ‚â§A


‚àë
j
| f j|r1
r 
Lp(X) .
(5.5.15)
Proof. Using Exercise 5.5.2 we interpolate between the trivial bound Lp(X,‚Ñìp) ‚Üí
Lp(Y,‚Ñìp) and the bound Lp(X,‚Ñì2) ‚ÜíLp(Y,‚Ñì2), which follows from Theorem 5.5.1.
We obtain the bound Lp(X,‚Ñìr) ‚ÜíLp(Y,‚Ñìr) since r lies between p and 2.
‚ñ°
Example 5.5.5. The result of Corollary 5.5.4 may fail if r does not lie in the interval
with endpoints p and 2. Let us take, for example, 1 < p < 2 and consider an r < p.
Take X = Y = R and deÔ¨Åne a linear operator T by setting
T( f)(x) = 1f(x)œá[0,1](x).
Then T is Lp bounded, since ‚à•T( f)‚à•Lp ‚â§‚à•T( f)‚à•Lp‚Ä≤ ‚â§‚à•f‚à•Lp. Now take f j = œá[ j‚àí1, j]
for j = 1,...,N. A simple calculation gives
 N
‚àë
j=1
|T( f j)(x)|r1
r = N
1
r

e‚àí2œÄix ‚àí1
‚àí2œÄix
œá[0,1](x)
 ,
while
 N
‚àë
j=1
| f j|r1
r = œá[0,N] .
It follows that N1/r ‚â§CN1/p for all N > 1, and hence (5.5.15) cannot hold if p > r.
We have now seen that ‚Ñìr-valued extensions for r Ã∏= 2 may fail in general. But do
they fail for some speciÔ¨Åc operators of interest in Fourier analysis? For instance, is
the inequality


‚àë
j‚ààZ
|H( f j)|r1
r 
Lp ‚â§Cp,r


‚àë
j‚ààZ
| f j|r1
r 
Lp
(5.5.16)
true for the Hilbert transform H whenever 1 < p,r < ‚àû? The answer to this question
is afÔ¨Årmative. Inequality (5.5.16) is indeed valid and was Ô¨Årst proved using complex
function theory. In the next section we plan to study inequalities such as (5.5.16)
for general singular integrals using the Calder¬¥on‚ÄìZygmund theory of the previous
section applied to the context of Banach-valued functions.
5.5.3 General Banach-Valued Extensions
Let B be a Banach space over the Ô¨Åeld of complex numbers with norm ‚à•‚à•B, and let
B‚àóbe its dual (with norm ‚à•‚à•B‚àó). A function F deÔ¨Åned on a measure space (X,Œº)

392
5 Singular Integrals of Convolution Type
and taking values in B is called B-measurable if there exists a measurable subset
X0 of X such that Œº(X \X0) = 0, F[X0] is contained in some separable subspace B0
of B, and for every u‚àó‚ààB‚àóthe complex-valued map
x ‚Üí
4
u‚àó,F(x)
5
is measurable. A consequence of this deÔ¨Ånition is that the positive function x ‚Üí
‚à•F(x)‚à•B on X is measurable; to see this, use the relevant result in [382, p. 131].
For 0 < p ‚â§‚àûwe denote by Lp(X) the space Lp(X,C). Let Lp(X)‚äóB be the set
of all Ô¨Ånite linear combinations of elements of B with coefÔ¨Åcients in Lp(X), that is,
elements of the form
F = f1u1 +¬∑¬∑¬∑+ fmum,
(5.5.17)
where f j ‚ààLp(X), uj ‚ààB, and m ‚ààZ+. We deÔ¨Åne Lp(X,B) to be the space of all
B-measurable functions F on X satisfying

X
F(x)
p
B dŒº(x)
1
p
< ‚àû,
(5.5.18)
with the obvious modiÔ¨Åcation when p = ‚àû. Similarly deÔ¨Åne Lp,‚àû(X,B) as the space
of all B-measurable functions F on X satisfying

F(¬∑)

B

Lp,‚àû(X) < ‚àû.
(5.5.19)
Then Lp(X,B) (respectively, Lp,‚àû(X,B)) is called the Lp (respectively, Lp,‚àû) space
of functions on X with values in B. The quantity in (5.5.18) (respectively, in (5.5.19))
is the norm of F in Lp(X,B) (respectively, in Lp,‚àû(X,B)).
Proposition 5.5.6. Let B be a Banach space and (X,Œº) a œÉ-Ô¨Ånite measure space.
(a) The set {‚àëm
j=1 œáE j uj : uj ‚ààB, Ej ‚´ÖX are pairwise disjoint and Œº(Ej) < ‚àû} is
dense in Lp(X,B) whenever 0 < p < ‚àû.
(b) The set {‚àë‚àû
j=0 œáE j uj : uj ‚ààB, Ej ‚´ÖX are pairwise disjoint and X = ‚à™‚àû
j=0Ej} is
dense in L‚àû(X,B).
(c) The space C ‚àû
0 ‚äóB of functions of the form ‚àëm
j=1 œïj uj, where uj ‚ààB, œïj are in
C ‚àû
0 (Rn), is dense in Lp(Rn,B) for 1 ‚â§p < ‚àû.
Proof. If F ‚ààLp(X,B) for 0 < p ‚â§‚àû, then F is B-measurable; thus there exists
X0 ‚´ÖX satisfying Œº(X \ X0) = 0 and F[X0] ‚´ÖB0, where B0 is some separable
subspace of B. Choose a countable dense sequence {uj}‚àû
j=1 of B0.
(a) First assume that p < ‚àû. Since X is œÉ-Ô¨Ånite, for any Œµ > 0, there exists a
measurable subset X1 of X0 with Œº(X1) < ‚àûsuch that

X\X1
F(x)
p
B dŒº < Œµ p
3 .
Setting
#B(uj,Œµ) =
	
u ‚ààB0 : ‚à•u‚àíuj‚à•B < Œµ(3Œº(X1))‚àí1
p 
,

5.5 Vector-Valued Inequalities
393
we have B0 ‚´Ö‚àû
j=1 #B(uj,Œµ). Let A1 = #B(u1,Œµ) and Aj = #B(uj,Œµ)\(j‚àí1
i=1 #B(ui,Œµ))
for j ‚â•2. It is easily seen that {Aj}‚àû
j=1 are pairwise disjoint and ‚àû
j=1 Aj =
‚àû
j=1 #B(uj,Œµ). Set Ej = F‚àí1[Aj] ‚à©X1. Then X1 = ‚àû
j=1 Ej and {Ej}‚àû
j=1 are pair-
wise disjoint. Since Œº(X1) = ‚àë‚àû
j=1 Œº(Ej) < ‚àû, it follows that Œº(Ej) < ‚àûand also
that for some m ‚ààZ+,

‚àû
j=m+1 E j
‚à•F(x)‚à•p
B dŒº < Œµ p
3 .
(5.5.20)
Moreover, one can easily verify that ‚àëm
j=1 œáE juj is B-measurable. Notice that
‚à•F(x) ‚àíuj‚à•B < Œµ(3Œº(X1))‚àí1/p for any x ‚ààEj and j ‚àà{1,...,m}. This fact com-
bined with (5.5.20) and the mutual disjointness of {Ej}m
j=1 yields that

X
F(x)‚àí
m
‚àë
j=1
œáE j(x)uj

p
B
dŒº =

X\X1
F(x)
p
B dŒº +

‚à™‚àû
j=m+1E j
F(x)
p
B dŒº
+

m
j=1 E j

m
‚àë
j=1
œáE j(x)[F(x)‚àíuj]

p
B
dŒº
< Œµ p
3 + Œµ p
3 + Œµ p
3 = Œµ p .
(b) Now consider the case p = ‚àû. Obviously we have B0 ‚´Ö‚àû
j=1 B(uj,Œµ), where
B(uj,Œµ) = {u ‚ààB0 : ‚à•u ‚àíuj‚à•B < Œµ}. Let A1 = B(u1,Œµ) and for j ‚â•2 deÔ¨Åne sets
Aj = B(uj,Œµ)\(j‚àí1
i=1 B(ui,Œµ)). Let Ej = F‚àí1[Aj] for j ‚â•1 and E0 = X \(‚àû
j=1 Ej).
Then Œº(E0) = 0. As in the proof of the case p < ‚àû, we have that {Ej}‚àû
j=0 are
pairwise disjoint and X0 ‚´Ö‚àû
j=0 Ej. Pick u0 = 0. Notice that ‚àë‚àû
j=0 œáE juj is B-
measurable. Since ‚à•F(x)‚àíuj‚à•B < Œµ for any x ‚ààEj and j ‚â•0, we have
F ‚àí
‚àû
‚àë
j=0
œáE juj

L‚àû(X,B)
=

‚àû
‚àë
j=0
œáE j(F ‚àíuj)

L‚àû(X,B)
< Œµ ,
which completes the proof in the case p = ‚àû.
(c) For the last assertion, we Ô¨Åx a smooth function with supported in the unit ball
of Rn with integral one. Let œïŒ¥(x) = Œ¥ ‚àínœï(x/Œ¥) for x ‚ààRn and Œ¥ > 0. Given a
function ‚àëm
j=1 œáE j uj as in part (a) approximating a given f in Lp ‚äóB, we consider
the function ‚àëm
j=1(œáE j ‚àóœïŒ¥)uj which lies in C ‚àû
0 ‚äóB. Since ‚à•œáE j ‚àóœïŒ¥ ‚àíœáE j‚à•Lp ‚Üí0
as Œ¥ ‚Üí0 when 1 ‚â§p < ‚àû, ‚àëm
j=1(œáE j ‚àóœïŒ¥)uj tends to ‚àëm
j=1 œáE j uj in Lp ‚äóB as
Œ¥ ‚Üí0, and the conclusion follows.
‚ñ°
Let (X,Œº) be a measure space. If F is an element of L1(X) ‚äóB given as in
(5.5.17), we deÔ¨Åne its integral (which is an element of B) by setting

X F(x)dŒº(x) =
m
‚àë
j=1

X f j(x)dŒº(x)

uj.

394
5 Singular Integrals of Convolution Type
Observe that for every F ‚ààL1(X)‚äóB we have


X F(x)dŒº(x)

B =
sup
‚à•u‚àó‚à•B‚àó‚â§1

>
u‚àó,
m
‚àë
j=1

X f j dŒº

uj
?
=
sup
‚à•u‚àó‚à•B‚àó‚â§1


X
4
u‚àó,
m
‚àë
j=1
f juj
5
dŒº

‚â§

X
sup
‚à•u‚àó‚à•B‚àó‚â§1
4
u‚àó,
m
‚àë
j=1
f juj
5dŒº
=
F

L1(X,B) .
Thus the linear operator
F ‚ÜíIF =

X F(x)dŒº(x)
is bounded from L1(X) ‚äóB into B. Since every element of L1(X,B) is a (norm)
limit (Proposition 5.5.6 (c)) of a sequence of elements in L1(X)‚äóB, by continuity,
the operator F ‚ÜíIF has a unique extension on L1(X,B) that we call the Bochner
integral of F and denote by

X F(x)dŒº(x).
L1(X,B) is called the space of all Bochner integrable functions from X to B. Since
the Bochner integral is an extension of IF, for each F ‚ààL1(X,B) we have


X F(x)dx

B ‚â§

X
F(x)

B dx.
Consequently, measurable functions F with

X ‚à•F(x)‚à•B dx < ‚àûare Bochner inte-
grable over X. It is not difÔ¨Åcult to show that the Bochner integral of F is the only
element of B that satisÔ¨Åes
@
u‚àó,

X F(x)dŒº(x)
A
=

X
4
u‚àó,F(x)
5
dŒº(x)
(5.5.21)
for all u‚àó‚ààB‚àó. The next result concerns duality in this context when X = Rn.
Proposition 5.5.7. Let B be a Banach space and 1 ‚â§p ‚â§‚àû.
(a) For any F ‚ààLp(Rn,B) we have
‚à•F‚à•Lp(Rn,B) =
sup
‚à•G‚à•Lp‚Ä≤ (Rn,B‚àó)‚â§1


Rn‚ü®G(x),F(x)‚ü©dx
 .
Consequently, Lp(Rn,B) isometrically embeds in (Lp‚Ä≤(Rn,B‚àó))‚àó.
(b) for any G ‚ààLp‚Ä≤(Rn,B‚àó) one has
‚à•G‚à•Lp‚Ä≤(Rn,B‚àó) =
sup
‚à•F‚à•Lp(Rn,B)‚â§1


Rn‚ü®G(x),F(x)‚ü©dx

and thus Lp‚Ä≤(Rn,B‚àó) isometrically embeds in (Lp(Rn,B))‚àó.

5.5 Vector-Valued Inequalities
395
Proof. H¬®older‚Äôs inequality yields that the right-hand side of (a) is controlled by its
left-hand side. It remains to establish the reverse inequality.
For F ‚ààLp(Rn,B) and Œµ > 0, by Proposition 5.5.6, there is FŒµ(x)=‚àëm
j=1 œáE j(x)uj
with m ‚ààZ+ or m = ‚àû(when p = ‚àû) such that ‚à•FŒµ ‚àíF‚à•Lp(Rn,B) < Œµ/2, where
{Ej}m
j=1 are pairwise disjoint subsets of Rn and uj ‚ààB. Since FŒµ ‚ààLp(Rn,B), we
choose a nonnegative function h satisfying ‚à•h‚à•Lp‚Ä≤(Rn) ‚â§1 such that
FŒµ

Lp(Rn,B) =

Rn
FŒµ(x)
p
B dx
 1
p
<

Rn h(x)
FŒµ(x)

B dx+ Œµ
4 .
(5.5.22)
When 1 ‚â§p < ‚àû, we can further choose h ‚ààLp‚Ä≤(Rn) to be a function with bounded
support, which ensures that it is integrable. For given uj ‚ààB, there exists u‚àó
j ‚ààB‚àó
satisfying ‚à•u‚àó
j‚à•B‚àó= 1 and
‚à•uj‚à•B < ‚ü®u‚àó
j,uj‚ü©+
Œµ
4(‚à•h‚à•L1(Rn) +1) .
(5.5.23)
Set G(x) = ‚àëm
j=1 h(x)œáE j(x)u‚àó
j. Clearly G is B‚àó-measurable and ‚à•G‚à•Lp‚Ä≤(Rn,B‚àó) ‚â§1.
It follows from (5.5.22) and (5.5.23) that

Rn‚ü®G(x),FŒµ(x)‚ü©dx =

Rn h(x)
m
‚àë
j=1
œáE j(x)‚ü®u‚àó
j,uj‚ü©dx
‚â•

Rn h(x)
m
‚àë
j=1
'
‚à•uj‚à•B ‚àí
Œµ
4(‚à•h‚à•L1(Rn) +1)
(
œáE j(x)dx
‚â•
FŒµ

Lp(Rn,B) ‚àíŒµ
4 ‚àíŒµ
4 .
Using H¬®older‚Äôs inequality we have


Rn‚ü®G(x),FŒµ(x)‚àíF(x)‚ü©dx
 ‚â§‚à•G‚à•Lp‚Ä≤(Rn,B‚àó)‚à•F ‚àíFŒµ‚à•Lp(Rn,B) < Œµ
2 ,
hence we obtain
FŒµ

Lp(Rn,B) ‚â§
sup
‚à•G‚à•Lp‚Ä≤ (Rn,B‚àó)‚â§1


Rn‚ü®G(x),F(x)‚ü©dx
+Œµ .
Letting Œµ ‚Üí0 yields the desired inequality in part (a).
(b) The duality statement |‚ü®G(x),F(x)‚ü©| ‚â§‚à•G(x)‚à•B‚àó‚à•F(x)‚à•B together with
H¬®older‚Äôs inequality imply the ‚â•inequality in part (b). We prove the ‚â§inequal-
ity via an argument symmetric with that in case (a). For completeness we in-
clude the details. For a given G in Lp‚Ä≤(Rn,B) and Œµ > 0, by Proposition 5.5.6,
there is GŒµ(x) = ‚àëm
j=1 œáE j(x)u‚àó
j with m ‚ààZ+ or m = ‚àû(when p = 1) such that
‚à•GŒµ ‚àíG‚à•Lp‚Ä≤(Rn,B‚àó) < Œµ/2, where {Ej}m
j=1 are pairwise disjoint subsets of Rn and

396
5 Singular Integrals of Convolution Type
u‚àó
j ‚ààB‚àó. Since GŒµ lies in Lp‚Ä≤(Rn,B‚àó), we choose a nonnegative function h satisfy-
ing ‚à•h‚à•Lp(Rn) ‚â§1 such that
GŒµ

Lp‚Ä≤(Rn,B‚àó) =

Rn
GŒµ(x)
p‚Ä≤
B‚àódx
 1
p‚Ä≤
<

Rn h(x)
GŒµ(x)

B‚àódx+ Œµ
4 . (5.5.24)
When 1 < p ‚â§‚àû, we can further choose h ‚ààLp(Rn) to be a function with bounded
support, which ensures that it is integrable. For each u‚àó
j ‚ààB, there exists uj ‚ààB
satisfying ‚à•uj‚à•B = 1 and
‚à•u‚àó
j‚à•B‚àó< ‚ü®u‚àó
j,uj‚ü©+
Œµ
4(‚à•h‚à•L1(Rn) +1) .
(5.5.25)
Set F(x) = ‚àëm
j=1 h(x)œáE j(x)uj. Clearly F is B-measurable and ‚à•F‚à•Lp(Rn,B) ‚â§1. It
follows from (5.5.24) and (5.5.25) that

Rn‚ü®GŒµ(x),F(x)‚ü©dx =

Rn h(x)
m
‚àë
j=1
œáE j(x)‚ü®u‚àó
j,uj‚ü©dx
‚â•

Rn h(x)
m
‚àë
j=1
'
‚à•u‚àó
j‚à•B‚àó‚àí
Œµ
4(‚à•h‚à•L1(Rn) +1)
(
œáE j(x)dx
‚â•
GŒµ

Lp‚Ä≤(Rn,B‚àó) ‚àíŒµ
2 .
Hence, for any Œµ > 0, we have
GŒµ

Lp‚Ä≤(Rn,B‚àó) ‚â§
sup
‚à•F‚à•Lp(Rn,B)‚â§1


Rn‚ü®G(x),F(x)‚ü©dx
+Œµ
which implies the reverse inequality in part (b) by letting Œµ ‚Üí0.
‚ñ°
DeÔ¨Ånition 5.5.8. Let X,Y be measure spaces. Let T be a linear operator that maps
Lp(X) to Lq(Y) (respectively, Lp(X) to Lq,‚àû(Y)) for some 0 < p,q ‚â§‚àû. We deÔ¨Åne
another operator ‚ÉóT acting on Lp(X)‚äóB by setting
‚ÉóT
 m
‚àë
j=1
f juj

=
m
‚àë
j=1
T( f j)uj.
If ‚ÉóT happens to have a bounded extension from Lp(X,B) to Lq(Y,B) (respectively
from Lp(X,B) to Lq,‚àû(Y,B)), then we say that T has a bounded B-valued exten-
sion. In this case we also denote by ‚ÉóT the B-valued extension of T.
Example 5.5.9. Let B = ‚Ñìr for some 1 ‚â§r < ‚àû. Then a measurable function
F : X ‚ÜíB is just a sequence {f j}j of measurable functions f j : X ‚ÜíC. The
space Lp(X,‚Ñìr) consists of all measurable complex-valued sequences {f j}j on X
that satisfy
{f j}j

Lp(X,‚Ñìr) =


‚àë
j
| f j|r1
r 
Lp(X) < ‚àû.

5.5 Vector-Valued Inequalities
397
The space Lp(X)‚äó‚Ñìr is the set of all Ô¨Ånite sums
m
‚àë
j=1
(aj1,aj2,aj3,...)gj ,
where gj ‚ààLp(X) and (aj1,aj2,aj3,...) ‚àà‚Ñìr, j = 1,...,m. This is certainly a sub-
space of Lp(X,‚Ñìr). Now given ( f1, f2,...) ‚ààLp(X,‚Ñìr), let Fm = e1 f1 + ¬∑¬∑¬∑ + em fm,
where ej is the inÔ¨Ånite sequence with zeros everywhere except at the jth entry, where
it has 1. Then Fm ‚ààLp(X) ‚äó‚Ñìr and approximates f in the norm of Lp(X,‚Ñìr). This
shows the density of Lp(X)‚äó‚Ñìr in Lp(X,‚Ñìr).
If T is a linear operator bounded from Lp(X) to Lq(Y), then ‚ÉóT is deÔ¨Åned by
‚ÉóT({f j}j) = {T( f j)}j.
According to DeÔ¨Ånition 5.5.8, T has a bounded ‚Ñìr-extension if and only if the in-
equality


‚àë
j
|T( f j)|r1
r 
Lq ‚â§C


‚àë
j
| f j|r1
r 
Lp
is valid.
A linear operator T acting on measurable functions is called positive if it satisÔ¨Åes
f ‚â•0 =‚áíT( f) ‚â•0. It is straightforward to verify that positive operators satisfy
f ‚â§g =‚áíT( f) ‚â§T(g),
|T( f)| ‚â§T(| f|),
sup
j
|T( f j)| ‚â§T

sup
j
| f j|

,
(5.5.26)
for all f,g, f j measurable functions. We have the following result regarding vector-
valued extensions of positive operators:
Proposition 5.5.10. Let 0 < p,q ‚â§‚àûand (X,Œº), (Y,ŒΩ) be two measure spaces. Let
T be a positive linear operator mapping Lp(X) to Lq(Y) (respectively, to Lq,‚àû(Y))
with norm A. Let B be a Banach space. Then T has a B-valued extension ‚ÉóT that
maps Lp(X,B) to Lq(Y,B) (respectively, to Lq,‚àû(Y,B)) with the same norm.
Proof. Let us Ô¨Årst understand this theorem when B = ‚Ñìr for 1 ‚â§r ‚â§‚àû. The two
endpoint cases r = 1 and r = ‚àûcan be checked easily using the properties in (5.5.26).
For instance, for r = 1 we have
‚àë
j
|T( f j)|

Lq ‚â§
‚àë
j
T(| f j|)

Lq =
T

‚àë
j
| f j|

Lq ‚â§A
‚àë
j
| f j|

Lp ,
while for r = ‚àûwe have
sup
j
|T( f j)|

Lq ‚â§
T(sup
j
| f j|)

Lq ‚â§A
sup
j
| f j|

Lp .

398
5 Singular Integrals of Convolution Type
The required inequality for 1 < r < ‚àû,


‚àë
j
|T( f j)|r1
r 
Lq ‚â§A


‚àë
j
| f j|r1
r 
Lp ,
follows from the Riesz‚ÄìThorin interpolation theorem (see Exercise 5.5.2).
The result for a general Banach space B can be proved using the following in-
equality:
‚ÉóT(F)(x)

B ‚â§T

‚à•F‚à•B

(x),
x ‚ààX,
(5.5.27)
by simply taking Lq norms. To prove (5.5.27), let us take F = ‚àën
j=1 f juj. Then
‚ÉóT(F)(x)

B =

n
‚àë
j=1
T( f j)(x)uj

B =
sup
‚à•u‚àó‚à•B‚àó‚â§1

4
u‚àó,
n
‚àë
j=1
T( f j)(x)uj
5
=
sup
‚à•u‚àó‚à•B‚àó‚â§1
T
 n
‚àë
j=1
f j
4
u‚àó,uj
5
(x)

‚â§T

sup
‚à•u‚àó‚à•B‚àó‚â§1
4
u‚àó,
n
‚àë
j=1
f juj
5

(x)
= T

n
‚àë
j=1
f juj

B

(x)
= T

‚à•F‚à•B

(x),
where the inequality makes use of the fact that T is a positive operator.
‚ñ°
Exercises
5.5.1. ([207]) Let (X,Œº) and (Y,ŒΩ) be œÉ-Ô¨Ånite measure spaces and suppose that
0 < p1, p1 ‚â§‚àû, 1 ‚â§q0,q1 ‚â§‚àû, and that p0 > p1. For 0 < Œ∏ < 1 deÔ¨Åne p,q by
1
p = 1‚àíŒ∏
p0
+ Œ∏
p1
,
1
q = 1‚àíŒ∏
q0
+ Œ∏
q1
.
Let B1 and B2 be Banach spaces and let ‚ÉóT be a linear operator that maps
Lp0(X,B1) to Lq0(Y,B2) with norm A0 and Lp1(X,B1) to Lq1(Y,B2) with norm
A1. Show that ‚ÉóT has an extension that maps Lp(X,B1) to Lq(Y,B2) with norm at
most 9A1‚àíŒ∏
0
AŒ∏
1 , by following the steps below:
(a) Let i ‚àà{0,1}. If Fj, j = 1,...,m are in Lpi(B1) with disjoint supports, using
max j‚àà{1,...,m} ‚à•‚ÉóT(Fj)(y)‚à•B2 ‚â§1
2m ‚àëŒµk=¬±1
‚àëm
k=1 Œµk‚ÉóT(Fk)(y)

B2 for y ‚ààY show that
 max
j=1,...,m‚à•‚ÉóT(Fj)‚à•B2

Lqi ‚â§Ai

m
‚àë
j=1
Fj

Lpi(X,B1) .

5.5 Vector-Valued Inequalities
399
(b) Assume that F lies in a dense subspace of B1, it satisÔ¨Åes ‚à•‚à•F‚à•B1‚à•Lp = 1, and
it takes only Ô¨Ånitely many values. For a Œª > 1 pick a large integer N such that
Œª ‚àíN < ‚à•F(x)‚à•B1 ‚â§Œª N for all x ‚ààX such that ‚à•F(x)‚à•B1 Ã∏= 0 and deÔ¨Åne Fj = FœáŒ© j,
where Œ© j = {x : 2j < ‚à•F‚à•B1 ‚â§2j+1}. Let a = p
p1 ‚àíp
p0 . Prove the inequalities
‚àë
j
Œª ‚àíjaŒ∏Fj

p0
Lp0(X,B1) ‚â§Œª aŒ∏ p0
and
‚àë
j
Œª jaŒ∏Fj

p1
Lp1(X,B1) ‚â§1.
(c) DeÔ¨Åne g0(y) = max j Œª ‚àíjaŒ∏‚à•‚ÉóT(Fj)(y)‚à•B2, g1(y) = max j Œª ja(1‚àíŒ∏)‚à•‚ÉóT(Fj)(y)‚à•B2
for y ‚ààY and show that
‚à•g0‚à•Lq0(Y) ‚â§A0 Œª aŒ∏
and
‚à•g1‚à•Lq1(Y) ‚â§A1 .
(d) Prove that for all y ‚ààY we have
‚à•‚ÉóT(F)(y)‚à•B2 ‚â§‚àë
j
‚à•‚ÉóT(Fj)(y)‚à•B2 ‚â§g0(y)1‚àíŒ∏g1(y)Œ∏

2+
1
Œª aŒ∏ ‚àí1 +
1
Œª a(1‚àíŒ∏) ‚àí1

and conclude that ‚à•‚ÉóT(F)‚à•Lp(Y,B2) ‚â§9A1‚àíŒ∏
0
AŒ∏
1 by picking Œª = (1+
‚àö
2)aŒ∏.

Hint: Part (d): Split the sum according to whether Œª ja > g1(y)
g0(y) and Œª ja ‚â§g1(y)
g0(y).

5.5.2. Prove the following version of the Riesz‚ÄìThorin interpolation theorem. Let
(X,Œº) and (Y,ŒΩ) be œÉ-Ô¨Ånite measure spaces. Let 1 < p0,q0,, p1,q1,r0,s0,r1,s1 < ‚àû
and 0 < Œ∏ < 1 satisfy
1‚àíŒ∏
p0
+ Œ∏
p1
= 1
p ,
1‚àíŒ∏
q0
+ Œ∏
q1
= 1
q ,
1‚àíŒ∏
r0
+ Œ∏
r1
= 1
r ,
1‚àíŒ∏
s0
+ Œ∏
s1
= 1
s .
Suppose that T is a linear operator that maps Lp0(X) to Lq0(Y) and Lp1(X) to
Lq1(Y). DeÔ¨Åne a vector-valued operator ‚ÉóT by setting ‚ÉóT({f j}j) = {T( f j)}j acting
on sequences of complex-valued functions deÔ¨Åned on X. Suppose that ‚ÉóT maps
Lp0(X,‚Ñìr0(C)) to Lq0(Y,‚Ñìs0(C)) with norm M0 and Lp1(X,‚Ñìr1(C)) to Lq1(Y,‚Ñìs1(C))
with norm M1. Prove that ‚ÉóT maps Lp(X,‚Ñìr(C)) to Lq(Y,‚Ñìs(C)) with norm at most
M1‚àíŒ∏
0
MŒ∏
1 .

Hint: Use the idea of the proof of Theorem 1.3.4. Apply Lemma 1.3.5 to the
function
F(z) =
m
‚àë
k=1
n
‚àë
j=1‚àë
l‚ààZ
aP(z)
k,l eiŒ±k,l
‚à•{ak,l}l‚à•R(z)‚àíP(z)
‚Ñìr
bQ(z)
j,l eiŒ≤ j,l
‚à•{bk,l}l‚à•S(z)‚àíQ(z)
‚Ñìs‚Ä≤

Y T(œáAk)(y)œáB j(y)dŒΩ(y)

400
5 Singular Integrals of Convolution Type
where P(z) = p
p0 (1‚àíz)+ p
p1 z, Q(z) = q‚Ä≤
q‚Ä≤
0 (1‚àíz)+ q‚Ä≤
q‚Ä≤
1 z, R(z) = r
r0 (1‚àíz)+ r
r1 z, and
S(z) = s‚Ä≤
s‚Ä≤
0 (1‚àíz)+ s‚Ä≤
s‚Ä≤
1 z, {ak,l}l‚ààZ,{bj,l}l‚ààZ are Ô¨Ånitely supported sequences of pos-
itive reals, Œ±k,l,Œ≤k,l ‚ààR, Ak are pairwise disjoint subsets of X with Ô¨Ånite measure,
and Bj are pairwise disjoint subsets of Y with Ô¨Ånite measure.

5.5.3. Prove the following version of the Marcinkiewicz interpolation theorem. Let
(X,Œº) and (Y,ŒΩ) be œÉ-Ô¨Ånite measure spaces and let 0 < p0 < p < p1 ‚â§‚àûand
0 < Œ∏ < 1 satisfy
1‚àíŒ∏
p0
+ Œ∏
p1
= 1
p .
Let B1,B2 be Banach spaces and ‚ÉóT be deÔ¨Åned on Lp0(X,B1) + Lp1(X,B1) such
that for every y ‚ààY and for all F,G ‚ààLp0(X,B1)+Lp1(X,B1) we have
‚ÉóT(F +G)(y)

B2 ‚â§
‚ÉóT(F)(y)

B2 +
‚ÉóT(G)(y)

B2 .
(a) Suppose that ‚ÉóT maps Lp0(X,B1) to Lp0,‚àû(Y,B2) with norm A0 and Lp1(X,B1)
to Lp1,‚àû(Y,B2) with norm A1. Show that ‚ÉóT maps Lp(X,B1) to Lp(Y,B2) with norm
at most 2

p
p‚àíp0 +
p
p1‚àíp
 1
p A1‚àíŒ∏
0
AŒ∏
1 .
(b) Let p0 = 1. If ‚ÉóT is linear and maps L1(X,B1) to L1,‚àû(Y,B2) with norm A0 and
Lp1(X,B1) to Lp1(Y,B2) with norm A1, show that ‚ÉóT maps Lp(X,B1) to Lp(Y,B2)
with norm at most 72

p‚àí1
‚àí1/pA1‚àíŒ∏
0
AŒ∏
1 .

Hint: Part (a): Copy the proof of Theorem 1.3.2. Part (b): Use Exercise 5.5.1.

5.5.4. For all x ‚ààRn let ‚ÉóK(x) be a bounded linear operator from B1 to B2 and
let Q ‚äóB1 the space of all Ô¨Ånite linear combinations of elements of the form F =
‚àëm
i=1 œáEiui , where Ei are disjoint measurable subsets of Rn of Ô¨Ånite measure, ui in
B1, and m ‚ààZ+.
(a) Suppose that ‚ÉóK satisÔ¨Åes

Rn
‚ÉóK(x)

B1‚ÜíB2 dx = C1 < ‚àû.
Prove that the operator
‚ÉóT(F)(x) =

Rn ‚ÉóK(x‚àíy)(F(y))dy,
initially deÔ¨Åned on Q ‚äóB1, has an extension that maps Lp(Rn,B1) to Lp(Rn,B2)
with norm at most C1 for 1 ‚â§p < ‚àû.
(b) (Young‚Äôs inequality) Let 1 ‚â§p,q,s ‚â§‚àûbe such that p < ‚àû, s > 1, 1/q + 1 =
1/s+1/p. Suppose that ‚ÉóK satisÔ¨Åes

‚ÉóK(¬∑)

B1‚ÜíB2

Ls(Rn) = C2 < ‚àû.

5.6 Vector-Valued Singular Integrals
401
Prove that the ‚ÉóT deÔ¨Åned in part (a) has an extension that maps Lp(Rn,B1) to
Lq(Rn,B2) with norm at most C2.
(c) (Young‚Äôs inequality for weak type spaces) Suppose that 1 < p,s < ‚àû, 1/q+1 =
1/s+1/p, and that ‚ÉóK satisÔ¨Åes

‚ÉóK(¬∑)

B1‚ÜíB2

Ls,‚àû(Rn) = C3 < ‚àû.
Prove that the ‚ÉóT deÔ¨Åned in part (a) has an extension that maps Lp(Rn,B1) to
Lq(Rn,B2).
(d) Prove the following (slight) generalization of the assertion in part (a). Suppose
that ‚ÉóK satisÔ¨Åes

Rn
‚ÉóK(x)(u)

B2 dx ‚â§C1‚à•u‚à•B1
for all u ‚ààB1. Then ‚ÉóT has an extension that maps L1(Rn,B1) to L1(Rn,B2) with
norm at most C1.
5.5.5. Use the inequality for the Rademacher functions in Appendix C.2 instead of
Lemma 5.5.2 to prove part (a) of Theorem 5.5.1 in the special case p = q. Notice
that this approach does not yield a sharp constant.
5.5.6. Let 0 < p Ã∏= 2 ‚â§‚àûand suppose that Tj are uniformly bounded linear operators
from Lp(R) to Lp(R). Show that the inequality

 ‚àë
j‚ààZ
|Tj( f j)|21
2

Lp ‚â§Cp

 ‚àë
j‚ààZ
| f j|21
2

Lp
may fail.

Hint: Let Tj(g)(x) = g(x‚àíj). When p > 2 take f j(x) = œá[‚àíj,1‚àíj] for j = 1,2,...,N.
When p < 2 take f j = œá[0,1] for j = 1,2,...,N.

5.5.7. Suppose that T is a linear operator that takes real-valued functions to real-
valued functions. Use Theorem 5.5.1(a) with p = q to prove that
sup
f real-valued
fÃ∏=0
T( f)

Lp
f

Lp
=
sup
f complex-valued
fÃ∏=0
T( f)

Lp
f

Lp
.
5.6 Vector-Valued Singular Integrals
We now discuss some results about vector-valued singular integrals. By this we
mean singular integral operators acting on functions deÔ¨Åned on Rn and taking values
in Banach spaces.

402
5 Singular Integrals of Convolution Type
5.6.1 Banach-Valued Singular Integral Operators
Suppose that B1 and B2 are Banach spaces. We denote by L(B1,B2) the space
of all bounded linear operators from B1 to B2. We consider a kernel ‚ÉóK deÔ¨Åned on
Rn \ {0} that takes values in L(B1,B2). In other words, for all x ‚ààRn \ {0}, ‚ÉóK(x)
is a bounded linear operator from B1 to B2 with norm ‚à•‚ÉóK(x)‚à•B1‚ÜíB2. Thus for any
v ‚ààB1 and any x ‚ààRn \{0} we have
‚ÉóK(x)(v)

B2 ‚â§‚à•‚ÉóK(x)‚à•B1‚ÜíB2‚à•v‚à•B1 .
We assume that there is a constant A < ‚àûsuch that the size condition holds
‚ÉóK(x)

B1‚ÜíB2 ‚â§A|x|‚àín ,
(5.6.1)
and also the regularity condition
sup
y‚ààRn\{0}

|x|‚â•2|y|
‚ÉóK(x‚àíy)‚àí‚ÉóK(x)

B1‚ÜíB2 dx ‚â§A < ‚àû.
(5.6.2)
Moreover, we assume that there is a sequence Œµk ‚Üì0 as k ‚Üí‚àûand an element ‚ÉóK0 of
L(B1,B2) such that
lim
k‚Üí‚àû


Œµk‚â§|y|‚â§1
‚ÉóK(y)dy‚àí‚ÉóK0

B1‚ÜíB2
= 0.
(5.6.3)
Given these assumptions, we deÔ¨Åne an operator ‚ÉóT on C ‚àû
0 ‚äóB1 as follows:
For functions fi ‚ààC ‚àû
0 (Rn) and ui ‚ààB1 we deÔ¨Åne
‚ÉóT
 m
‚àë
i=1
fiui

(x) = lim
k‚Üí‚àû

Œµk‚â§|y|
‚ÉóK(y)
 m
‚àë
i=1
fi(x‚àíy)ui

dy
(5.6.4)
=
m
‚àë
i=1

|y|‚â§1( fi(x‚àíy)‚àífi(x))‚ÉóK(y)(ui)dy+
m
‚àë
i=1
fi(x)‚ÉóK0(ui)
+

|y|>1
m
‚àë
i=1
fi(x‚àíy)‚ÉóK(y)(ui)dy.
(5.6.5)
Notice that for each i ‚àà{1,...,m} we have

|y|‚â§1| fi(x‚àíy)‚àífi(x)|‚à•‚ÉóK(y)(ui)‚à•B2dy ‚â§‚à•‚àáfi‚à•L‚àû‚à•ui‚à•B1

|y|‚â§1|y|‚à•‚ÉóK(y)‚à•B1‚ÜíB2dy
and this is a Ô¨Ånite integral in view of (5.6.1). Thus the function
( fi(x‚àíy)‚àífi(x))‚ÉóK(y)(ui)

5.6 Vector-Valued Singular Integrals
403
is B2-integrable and the expression

|y|‚â§1( fi(x‚àíy)‚àífi(x))‚à•‚ÉóK(y)(ui)‚à•B2 dy
is a well-deÔ¨Åned element of B2. Also the integral in (5.6.5) is over the compact set
1 ‚â§|y| ‚â§|x|+M, where the ball B(0,M) contains the supports of all fi, and thus it
also converges in B2, using (5.6.1).
The following vector-valued extension of Theorem 5.3.3 is the main result of this
section.
Theorem 5.6.1. Let B1 and B2 be Banach spaces. Suppose that ‚ÉóK(x) satisÔ¨Åes
(5.6.1), (5.6.2), and (5.6.3) for some A > 0 and ‚ÉóK0 ‚ààL(B1,B2). Let ‚ÉóT be the
operator associated with ‚ÉóK as in (5.6.4). Assume that ‚ÉóT is a bounded linear op-
erator from Lr(Rn,B1) to Lr(Rn,B2) with norm B‚ãÜfor some 1 < r ‚â§‚àû. Then ‚ÉóT
has well-deÔ¨Åned extensions on Lp(Rn,B1) for all 1 ‚â§p < ‚àû. Moreover, there exist
dimensional constants Cn and C‚Ä≤
n such that
‚ÉóT(F)

L1,‚àû(Rn,B2) ‚â§C‚Ä≤
n(A+B‚ãÜ)
F

L1(Rn,B1)
(5.6.6)
for all F in L1(Rn,B1) and
‚ÉóT(F)

Lp(Rn,B2) ‚â§Cn max

p,(p‚àí1)‚àí1
(A+B‚ãÜ)
F

Lp(Rn,B1)
(5.6.7)
whenever 1 < p < ‚àûand F is in Lp(Rn,B1).
Proof. Although ‚ÉóT is deÔ¨Åned on the entire L1(Rn,B1)‚à©Lr(Rn,B1), it will be con-
venient to work with its restriction to a smaller dense subspace of L1(Rn,B1). We
make the observation that the space Q ‚äóB1 of all functions of the form ‚àëm
i=1 œáRiui,
where Ri are disjoint dyadic cubes and ui ‚ààB1, is dense in L1(Rn,B1). Indeed, by
Proposition 5.5.6 (b) it sufÔ¨Åces to approximate a C ‚àû
0 ‚äóB1-valued function with a
Q ‚äóB1-valued function. But this is immediate since any function in C ‚àû
0 (Rn) can
be approximated in L1(Rn) by Ô¨Ånite linear combinations of characteristic functions
of disjoint dyadic cubes.
Case 1: r = ‚àû. We Ô¨Åx F = ‚àëm
i=1 œáRiui in Q ‚äóB1 and we notice that for each
x ‚ààRn we have ‚à•F(x)‚à•B1 = ‚àëm
i=1 œáRi(x)‚à•ui‚à•B1, which is also a Ô¨Ånite linear combi-
nation of characteristic functions of dyadic cubes. Apply the Calder¬¥on-Zygmund
decomposition to ‚à•F‚à•B1 at height Œ≥Œ±, where Œ≥ = 2‚àín‚àí1B‚àí1
‚ãÜ
as in the proof of
Theorem 6.3.1. We extract a Ô¨Ånite collection of closed dyadic cubes {Qj}j satis-
fying ‚àëj |Qj| ‚â§(Œ≥Œ±)‚àí1‚à•F‚à•L1(Rn,B1) and we deÔ¨Åne the good function of the decom-
position
G(x) =

F(x)
for x /‚àà‚à™jQj
|Qj|‚àí1 
Qj F(x)dx
for x ‚ààQj.

404
5 Singular Integrals of Convolution Type
Also deÔ¨Åne the bad function B(x) = F(x)‚àíG(x). Then B(x) = ‚àëj Bj(x), where each
Bj is supported in Qj and has mean value zero over Qj. Moreover,
‚à•G‚à•L1(Rn,B1) ‚â§‚à•F‚à•L1(Rn,B1)
(5.6.8)
‚à•G‚à•L‚àû(Rn,B1) ‚â§2nŒ≥Œ±
(5.6.9)
and ‚à•Bj‚à•L1(Rn,B1) ‚â§2n+1Œ≥Œ±|Qj|, by an argument similar to that given in the proof
of Theorem 5.3.1. We only verify (5.6.9). On the cube Qj, G is equal to the constant
|Qj|‚àí1 
Qj F(x)dx, and this is bounded by 2nŒ≥Œ±. For each x ‚ààRn \ 
j Qj and for
each k = 0,1,2,... there exists a unique nonselected dyadic cube Q(k)
x
of generation
k that contains x. Then for each k ‚â•0, we have

1
|Q(k)
x |

Q(k)
x
F(y)dy

B1
‚â§
1
|Q(k)
x |

Q(k)
x
‚à•F(y)‚à•B1 dy ‚â§Œ≥Œ±.
The intersection of the closures of the cubes Q(k)
x
is the singleton {x}. Using Corol-
lary 2.1.16, we deduce that for almost all x ‚ààRn \ 
j Qj we have
F(x) =
m
‚àë
i=1
œáRi(x)ui =
m
‚àë
i=1
lim
k‚Üí‚àû

1
|Q(k)
x |

Q(k)
x
œáRi(y)dy

ui = lim
k‚Üí‚àû
1
|Q(k)
x |

Q(k)
x
F(y)dy.
Since these averages are at most Œ≥Œ±, we conclude that ‚à•F‚à•B1 ‚â§Œ≥Œ± almost every-
where on Rn \ 
j Qj, hence ‚à•G‚à•B1 ‚â§Œ≥Œ± a.e. on this set. This proves (5.6.9).
By assumption we have
‚à•‚ÉóT(G)‚à•L‚àû(Rn,B) ‚â§B‚ãÜ‚à•G‚à•L‚àû(Rn,B) ‚â§2nŒ≥Œ±B‚ãÜ= Œ±/2.
Then the set
	
x ‚ààRn : ‚à•‚ÉóT(G)(x)‚à•B2 > Œ±/2

is null and we have
	
x ‚ààRn : ‚à•‚ÉóT(F)(x)‚à•B2 > Œ±

 ‚â§
	
x ‚ààRn : ‚à•‚ÉóT(B)(x)‚à•B2 > Œ±/2

.
Let Q‚àó
j = 2‚àönQj. We have
{x ‚ààRn : ‚à•T(B)(x)‚à•B2 > Œ±/2}

‚â§

j
Q‚àó
j
+
	
x /‚àà

j
Q‚àó
j : ‚à•‚ÉóT(B)(x)‚à•B2 > Œ±/2


‚â§(2‚àön)n
Œ≥
‚à•F‚à•L1(Rn,B1)
Œ±
+ 2
Œ±

(‚à™jQ‚àó
j)c ‚à•‚ÉóT(B)(x)‚à•B2 dx
‚â§(2‚àön)n
Œ≥
‚à•F‚à•L1(Rn,B1)
Œ±
+ 2
Œ± ‚àë
j

(Q‚àó
j)c ‚à•T(Bj)(x)‚à•B2 dx,
since B = ‚àëj Bj. It sufÔ¨Åces to estimate the last sum. Denoting by yj is the center of
the cube Qj and using the fact that Bj has mean value zero over Qj, we write

5.6 Vector-Valued Singular Integrals
405
‚àë
j

(Q‚àó
j)c
‚ÉóT(Bj)(x)

B2 dx
= ‚àë
j

(Q‚àó
j)c


Qj
‚ÉóK(x‚àíy)‚àí‚ÉóK(x‚àíyj)

(Bj(y))dy

B2
dx
‚â§‚àë
j

Qj
Bj(y)

B1

(Q‚àó
j)c
‚ÉóK(x‚àíy)‚àí‚ÉóK(x‚àíyj)

B1‚ÜíB2 dxdy
‚â§‚àë
j

Qj
Bj(y)

B1

|x‚àíy j|‚â•2|y‚àíy j|
‚ÉóK(x‚àíy)‚àí‚ÉóK(x‚àíyj)

B1‚ÜíB2 dxdy
‚â§A‚àë
j
‚à•Bj‚à•L1(Qj,B1)
‚â§2n+1A‚à•F‚à•L1(Rn,B1),
where we used the fact that |x‚àíyj| ‚â•2|y‚àíyj| for all x /‚ààQ‚àó
j and y ‚ààQj and (5.6.2).
Consequently,
	
x ‚ààRn : ‚à•‚ÉóT( f)(x)‚à•B2 > Œ±

 ‚â§(2‚àön)n
Œ≥
‚à•F‚à•L1(Rn,B1)
Œ±
+ 2
Œ± 2n+1A‚à•F‚à•L1(Rn,B1)
=

(2‚àön)n2n+1B‚ãÜ+2n+1A
‚à•F‚à•L1(Rn,B1)
Œ±
‚â§C‚Ä≤
n (A+B‚ãÜ)
‚à•F‚à•L1(Rn,B1)
Œ±
,
where C‚Ä≤
n = (2‚àön)n2n+1 +2n+1. Thus ‚ÉóT has an extension that maps L1(Rn,B1) to
L1,‚àû(Rn,B2) with constant Cn(A+B‚ãÜ). By interpolation (Exercise 5.5.3 (b)) it has
an extension that satisÔ¨Åes (5.6.7).
Case 2: 1 < r < ‚àû. We Ô¨Åx F = ‚àëm
i=1 œáRiui in Q ‚äóB1 and we notice that for each
x ‚ààRn we have ‚à•F(x)‚à•B1 = ‚àëm
i=1 œáRi(x)‚à•ui‚à•B1. Thus the function x ‚Üí‚à•F(x)‚à•B1 is
a Ô¨Ånite linear combination of characteristic functions of disjoint dyadic cubes. We
prove the weak type estimate (5.6.6) by applying the Calder¬¥on‚ÄìZygmund decompo-
sition to the function x ‚Üí‚à•F(x)‚à•B1 deÔ¨Åned on Rn. Then we decompose F = G+B,
where G and B satisfy properties analogous to the case r = ‚àû. The new ingredient in
this case is that the set
	
x ‚ààRn : ‚à•‚ÉóT(G)(x)‚à•B2 > Œ±/2

is not null but its measure
can be estimated as follows:
	
x ‚ààRn : ‚à•‚ÉóT(G)(x)‚à•B2 > Œ±/2

 ‚â§
2B‚ãÜ
Œ±
r
‚à•G‚à•r
L2(Rn,B1) ‚â§2
Œ± ‚à•F‚à•L1(Rn,B1) ,
where the Ô¨Årst inequality is a consequence of the boundedness of ‚ÉóT on Lr and the
second is obtained by combining (5.6.8) and (5.6.9). Combining this estimate for
the good function with the one for the bad function obtained in the preceding case,
it follows that ‚ÉóT has an extension that satisÔ¨Åes (5.6.6), i.e., it maps ‚ÉóT : L1(Rn,B1)
to L1,‚àû(Rn,B2) with constant C‚Ä≤
n (A+B‚ãÜ), where C‚Ä≤
n = 2+(2‚àön)n2n+1 +2n+1.

406
5 Singular Integrals of Convolution Type
Next we interpolate between the estimates ‚ÉóT : L1(Rn,B1) ‚ÜíL1,‚àû(Rn,B2)
and ‚ÉóT : Lr(Rn,B1) ‚ÜíLr(Rn,B2). Using Exercise 5.5.3 (b) and the fact that
(p‚àí1)‚àí1/p ‚â§(p‚àí1)‚àí1 when 1 < p < 2, we obtain
‚ÉóT(F)

Lp(Rn,B2) ‚â§Cn(p‚àí1)‚àí1(A+B‚ãÜ)‚à•F‚à•Lp(Rn,B1) ,
(5.6.10)
when 1 < p < min(r,2), where Cn is independent of r, p, B1, and B2.
We prove (5.6.7) for p > r via duality. Since ‚ÉóK(x) is an operator from B1 to B2,
its adjoint ‚ÉóK‚àó(x) is an operator from B‚àó
2 to B‚àó
1. Obviously ‚ÉóK‚àó(x) and ‚ÉóK(x) have the
same norm, so (5.6.1) holds. For the same reason, condition (5.6.2) also holds for
‚ÉóK‚àó, Finally condition (5.6.3) also holds since for any Œµk ‚Üìas k ‚Üí‚àûwe have


Œµk‚â§|y|‚â§1
‚ÉóK‚àó(y)dy‚àí‚ÉóK0‚àó

B‚àó
2‚ÜíB‚àó
1
=


Œµk‚â§|y|‚â§1
‚ÉóK(y)dy‚àí‚ÉóK0

B1‚ÜíB2
‚Üí0.
Let ‚ÉóT ‚Ä≤ be the Banach-valued operator with kernel ‚ÉóK‚àó(‚àíx). Clearly ‚ÉóT ‚Ä≤ is well
deÔ¨Åned on C ‚àû
0 ‚äóB‚àó
2. For F(y) = ‚àëm
i=1 fi(y)w‚àó
i in C ‚àû
0 ‚äóB‚àó
2 and G(z) = ‚àël
j=1 gj(z)vj
in C ‚àû
0 ‚äóB1 we prove the following duality relation

Rn
4‚ÉóT ‚Ä≤(F)(x),G(x)
5
dx =

Rn
4
F(z),‚ÉóT(G)(z)
5
dz.
(5.6.11)
Indeed, for each index i ‚àà{1,...,m} and j ‚àà{1,...,l} we have

Rn
>
lim
k‚Üí‚àû

|y|‚â•Œµk
‚ÉóK‚àó(‚àíy)( fi(x‚àíy)w‚àó
i )dy,gj(x)vj
?
dx
= lim
k‚Üí‚àû

|y|‚â•Œµk

Rn
>
‚ÉóK‚àó(‚àíy)( fi(x‚àíy)w‚àó
i ),gj(x)vj
?
dxdy
= lim
k‚Üí‚àû

|y|‚â•Œµk

Rn
>
‚ÉóK‚àó(‚àíy)( fi(z)w‚àó
i ),gj(z+y)vj
?
dzdy
= lim
k‚Üí‚àû

|y|‚â•Œµk

Rn
>
fi(z)w‚àó
i ,‚ÉóK(‚àíy)(gj(z+y)vj)
?
dzdy
=

Rn
>
fi(z)w‚àó
i , lim
k‚Üí‚àû

|y|‚â•Œµk
‚ÉóK(y)(gj(z‚àíy)vj)dy
?
dz,
proving (5.6.11), provided we can justify the interchange the x (or z)-integral with the
y-integral paired with the limit. These justiÔ¨Åcations can be given using the deÔ¨Ånition
in (5.6.4). For the part of the y-integral where |y| ‚â•1 the interchange is easily justi-
Ô¨Åed in view of the absolute convergence of the double integral and (5.5.21). For the
part of the y-integral where |y| ‚â§1 we introduce the operators ‚ÉóK0‚àóand ‚ÉóK0 and we use
the facts that |gj(z ‚àíy) ‚àígj(z)| ‚â§‚à•‚àágj‚à•L‚àû|y| and | fi(x ‚àíy) ‚àífi(x)| ‚â§‚à•‚àáfi‚à•L‚àû|y|
together with the assumption ‚à•‚ÉóK(y)‚à•B1‚ÜíB2 ‚â§A|y|‚àín and (5.5.21) to obtain the ab-
solute convergence of the double integral, and thus justify the interchange.

5.6 Vector-Valued Singular Integrals
407
We claim that ‚ÉóT ‚Ä≤ is bounded from Lr‚Ä≤(Rn,B‚àó
2) to Lr‚Ä≤(Rn,B‚àó
1). Indeed, to verify
this assertion, we Ô¨Åx F in C ‚àû
0 ‚äóB‚àó
2 and use Proposition 5.5.7 (b). Using (5.6.11),
for each G ‚ààC ‚àû
0 ‚äóB1, we write


Rn
4‚ÉóT ‚Ä≤(F)(x),G(x)
5
dx
 =


Rn
4
F(x),‚ÉóT(G)(x)
5
dx

‚â§

Rn
F(x)

B‚àó
2
‚ÉóT(G)(x)

B2 dx
‚â§‚à•F‚à•Lr‚Ä≤(Rn,B‚àó
2)
‚ÉóT(G)

Lr(Rn,B2)
‚â§‚à•F‚à•Lr‚Ä≤(Rn,B‚àó
2)B‚ãÜ‚à•G‚à•Lr(Rn,B1) ,
so taking the supremum over all G ‚ààC ‚àû
0 ‚äóB1 with ‚à•G‚à•Lr(Rn,B1) ‚â§1 we deduce
that
‚ÉóT ‚Ä≤(F)

Lr‚Ä≤(Rn,B‚àó
1) ‚â§B‚ãÜ‚à•F‚à•Lr‚Ä≤(Rn,B‚àó
2) .
Collecting these facts, we have that ‚ÉóT ‚Ä≤ is associated with a kernel ‚ÉóK‚àó(‚àíx) which
satisÔ¨Åes (5.6.1), (5.6.2), and (5.6.3) (with ‚ÉóK0‚àóin place of ‚ÉóK0), and moreover it has a
bounded extension that maps Lr‚Ä≤(Rn,B‚àó
2) to Lr‚Ä≤(Rn,B‚àó
1). The Calder¬¥on-Zygmund
decomposition in the vector-valued setting (discussed in the Ô¨Årst paragraph of the
proof) yields that ‚ÉóT ‚Ä≤ has an extension that satisÔ¨Åes
‚ÉóT ‚Ä≤(F)

L1,‚àû(Rn,B‚àó
1) ‚â§C‚Ä≤
n(A+B‚ãÜ)‚à•F‚à•L1(Rn,B‚àó
2) .
Using interpolation (Exercise 5.5.3 (b)) and the fact that (p‚Ä≤ ‚àí1)1/p‚Ä≤ ‚â§p, we obtain
that for 1 < p‚Ä≤ < r‚Ä≤, ‚ÉóT ‚Ä≤ has an extension on Lp‚Ä≤(Rn,B‚àó
2) that satisÔ¨Åes
‚ÉóT ‚Ä≤(F)

Lp‚Ä≤(Rn,B‚àó
1) ‚â§Cn p(A+B‚ãÜ)‚à•F‚à•Lp‚Ä≤(Rn,B‚àó
2) .
(5.6.12)
Let F = ‚àëm
i=1 œïi ui be in the dense subspace C ‚àû
0 ‚äóB1 of Lp(Rn,B1). We observe
that ‚à•‚ÉóT(F)‚à•Lp(Rn,B2) < ‚àû. Indeed, all œïi are supported in |x| ‚â§R, then for |x| ‚â•2R
we have


|y|‚â§R
‚ÉóK(x‚àíy)
 m
‚àë
i=1
œïi ui

dy

B2
‚â§A
|x|
2
‚àín m
‚àë
i=1
‚à•œïi‚à•L1‚à•ui‚à•B1
(5.6.13)
which is integrable to the power p > 1 in the region |x| ‚â•2R. Also using the deÔ¨Å-
nition in (5.6.4) we see that the expression on the left in (5.6.13) is bounded, hence
integrable to the power p in the region |x| ‚â§2R. For a Ô¨Åxed r < p < ‚àû, we are now
able to apply Proposition 5.5.7 (a) to write
‚ÉóT(F)

Lp(Rn,B2) ‚â§
sup
‚à•G‚à•Lp‚Ä≤ (Rn,B‚àó
2)‚â§1


Rn
4
G(x),‚ÉóT(F)(x)
5
dx

=
sup
‚à•G‚à•Lp‚Ä≤ (Rn,B‚àó
2)‚â§1


Rn
4‚ÉóT ‚Ä≤(G)(x),F(x)
5
dx


408
5 Singular Integrals of Convolution Type
‚â§
sup
‚à•G‚à•Lp‚Ä≤ (Rn,B‚àó
2)‚â§1
‚ÉóT ‚Ä≤(G)

Lp‚Ä≤(Rn,B‚àó
1)‚à•F‚à•Lp(Rn,B1)
‚â§Cn p(A+B‚ãÜ)‚à•F‚à•Lp(Rn,B1) ,
where we used (5.6.12). This combined with (5.6.10) implies the required conclu-
sion whenever r < ‚àûand p ‚àà

1,min(r,2)

‚à™(r,‚àû). The remaining p‚Äôs follow by
interpolation (Exercise 5.5.3 (a)).
‚ñ°
5.6.2 Applications
We proceed with some applications. An important consequence of Theorem 5.6.1 is
the following:
Corollary 5.6.2. Let A,B > 0 and let Wj be a sequence of tempered distributions
on Rn whose Fourier transforms are uniformly bounded functions (i.e., |2
Wj| ‚â§B).
Suppose that for each j, Wj coincides with a function Kj on Rn \{0} that satisÔ¨Åes
|Kj(x)| ‚â§A|x|‚àín ,
x Ã∏= 0,
(5.6.14)
lim
Œµk‚Üí0

|x|‚â•Œµk
Kj(x)dx = Lj ,
(5.6.15)
for some complex constant Lj, and
sup
y‚ààRn\{0}

|x|‚â•2|y| sup
j
|Kj(x‚àíy)‚àíKj(x)|dx ‚â§A.
(5.6.16)
Then there are constants Cn,C‚Ä≤
n > 0 such that for all 1 < p,r < ‚àûwe have


‚àë
j
|Wj ‚àóf j|r1
r 
L1,‚àû‚â§C‚Ä≤
n max(r,(r‚àí1)‚àí1)(A+B)


‚àë
j
| f j|r1
r 
L1,


‚àë
j
|Wj ‚àóf j|r1
r 
Lp ‚â§Cn c(p,r)(A+B)


‚àë
j
| f j|r1
r 
Lp,
where c(p,r) = max(p,(p‚àí1)‚àí1)max(r,(r ‚àí1)‚àí1).
Proof. Let Tj be the operator given by convolution with the distribution Wj. Clearly
Tj is L2 bounded with norm at most B. It follows from Theorem 5.3.3 that the Tj‚Äôs
are of weak type (1,1) and also bounded on Lr with bounds at most a dimensional
constant multiple of max(r,(r‚àí1)‚àí1)(A+B), uniformly in j. We set B1 = B2 = ‚Ñìr
and deÔ¨Åne
‚ÉóT({f j}j) = {Wj ‚àóf j}j

5.6 Vector-Valued Singular Integrals
409
for {f j}j ‚ààLr(Rn,‚Ñìr). It is immediate to verify that ‚ÉóT maps Lr(Rn,‚Ñìr) to itself
with norm at most a dimensional constant multiple of max(r,(r‚àí1)‚àí1)(A+B). The
kernel of ‚ÉóT is ‚ÉóK in L(‚Ñìr,‚Ñìr) deÔ¨Åned by
‚ÉóK(x)({t j}j) = {Kj(x)t j}j,
{t j}j ‚àà‚Ñìr.
Obviously, we have
‚ÉóK(x‚àíy)‚àí‚ÉóK(x)

‚Ñìr‚Üí‚Ñìr ‚â§sup
j
|Kj(x‚àíy)‚àíKj(x)|,
and therefore condition (5.6.3) holds for ‚ÉóK as a consequence of (5.6.16). Moreover,
(5.6.1) and (5.6.2) with ‚ÉóK0 = {Lj}j are also valid for this ‚ÉóK, in view of assumptions
(5.6.14) and (5.6.15). The desired conclusion follows from Theorem 5.6.1.
‚ñ°
If all the Wj‚Äôs are equal, we obtain the following corollary, which contains in
particular the inequality (5.5.16) mentioned earlier.
Corollary 5.6.3. Let W be an element of S ‚Ä≤(Rn) whose Fourier transform is a func-
tion bounded in absolute value by some B > 0. Suppose that W coincides with some
locally integrable function K on Rn \{0} that satisÔ¨Åes
|K(x)| ‚â§A|x|‚àín ,
x Ã∏= 0,
lim
Œµk‚Üí0

Œµk‚â§|x|‚â§1 K(x)dx = L,
and
sup
y‚ààRn\{0}

|x|‚â•2|y| |K(x‚àíy)‚àíK(x)|dx ‚â§A.
(5.6.17)
Let T be the operator given by convolution with W. Then there exist constants
Cn,C‚Ä≤
n > 0 such that for all 1 < p,r < ‚àûwe have that


‚àë
j
|T( f j)|r1
r 
L1,‚àû‚â§C‚Ä≤
n max(r,(r‚àí1)‚àí1)(A+B)


‚àë
j
| f j|r1
r 
L1 ,


‚àë
j
|T( f j)|r1
r 
Lp ‚â§Cnc(p,r)(A+B)


‚àë
j
| f j|r1
r 
Lp ,
where c(p,r) = max(p,(p‚àí1)‚àí1)max(r,(r‚àí1)‚àí1). In particular, these inequalities
are valid for the Hilbert transform and the Riesz transforms.
Interestingly enough, we can use the very statement of Theorem 5.6.1 to obtain
its corresponding vector-valued version.
Proposition 5.6.4. Let let 1 < p,r < ‚àûand let B1 and B2 be two Banach spaces.
Suppose that ‚ÉóT given by (5.6.4) is a bounded linear operator from Lr(Rn,B1) to
Lr(Rn,B2) with norm B = B(r). Also assume that for all x ‚ààRn \ {0}, ‚ÉóK(x) is a

410
5 Singular Integrals of Convolution Type
bounded linear operator from B1 to B2 that satisÔ¨Åes conditions (5.6.1) , (5.6.2),
(5.6.3) for some A > 0 and ‚ÉóK0 ‚ààL(B1,B2). Then there exist positive constants
Cn,C‚Ä≤
n such that for all B1-valued functions Fj we have


‚àë
j
‚ÉóT(Fj)
r
B2
1
r 
L1,‚àû(Rn) ‚â§C‚Ä≤
n(A+B)


‚àë
j
Fj
r
B1
1
r 
L1(Rn),


‚àë
j
‚ÉóT(Fj)
r
B2
1
r 
Lp(Rn) ‚â§Cn(A+B)c(p)


‚àë
j
Fj
r
B1
1
r 
Lp(Rn),
where c(p) = max(p,(p‚àí1)‚àí1).
Proof. Let us denote by ‚Ñìr(B1) the Banach space of all B1-valued sequences {uj}j
that satisfy
{uj}j

‚Ñìr(B1) =
‚àë
j
uj
r
B1
1
r < ‚àû.
Now consider the operator ‚ÉóS deÔ¨Åned on Lr(Rn,‚Ñìr(B1)) by
‚ÉóS({Fj}j) = {‚ÉóT(Fj)}j .
It is obvious that ‚ÉóS maps Lr(Rn,‚Ñìr(B1)) to Lr(Rn,‚Ñìr(B2)) with norm at most B.
Moreover, ‚ÉóS has kernel #K(x) ‚ààL(‚Ñìr(B1),‚Ñìr(B2)) given by
#K(x)({uj}j) = {‚ÉóK(x)(uj)}j,
where ‚ÉóK is the kernel of ‚ÉóT. It is not hard to verify that for x ‚ààRn \{0} we have
 #K(x)

‚Ñìr(B1)‚Üí‚Ñìr(B2) =
‚ÉóK(x)

B1‚ÜíB2 ,
hence for x Ã∏= y ‚ààRn we also have
 #K(x‚àíy)‚àí#K(x)

‚Ñìr(B1)‚Üí‚Ñìr(B2) =
‚ÉóK(x‚àíy)‚àí‚ÉóK(x)

B1‚ÜíB2 .
Moreover, if we deÔ¨Åne B
K0 ‚ààL

‚Ñìr(B1),‚Ñìr(B2)

by
B
K0({uj}j) =
	‚ÉóK0(y)(uj)

j .
for {uj}j ‚àà‚Ñìr(B1), then we have
lim
k‚Üí‚àû

Œµk‚â§|y|‚â§1
#K(y)dy = B
K0,
in L

‚Ñìr(B1),‚Ñìr(B2)

.
We conclude that #K satisÔ¨Åes conditions (5.6.1) , (5.6.2), (5.6.3). Hence the oper-
ator ‚ÉóS associate with #K satisÔ¨Åes the conclusion of Theorem 5.6.1, that is, the desired
inequalities for ‚ÉóT.
‚ñ°

5.6 Vector-Valued Singular Integrals
411
5.6.3 Vector-Valued Estimates for Maximal Functions
Next, we discuss applications of vector-valued inequalities to some nonlinear opera-
tors. We Ô¨Åx an integrable function Œ¶ on Rn and for t > 0 deÔ¨Åne Œ¶t(x) =t‚àínŒ¶(t‚àí1x).
We suppose that Œ¶ satisÔ¨Åes the following regularity condition:
sup
y‚ààRn\{0}

|x|‚â•2|y| sup
t>0
|Œ¶t(x‚àíy)‚àíŒ¶t(x)|dx = AŒ¶ < ‚àû.
(5.6.18)
We consider the maximal operator
MŒ¶( f)(x) = sup
t>0
|( f ‚àóŒ¶t)(x)|
deÔ¨Åned for f in L1 + L‚àû. We are interested in obtaining Lp estimates for MŒ¶. We
observe that the trivial estimate
MŒ¶( f)

L‚àû‚â§‚à•Œ¶‚à•L1‚à•f‚à•L‚àû
(5.6.19)
holds when p = ‚àû. It is natural to set
B1 = C
and
B2 = L‚àû(R+)
and view MŒ¶ as the linear operator f ‚Üí{f ‚àóŒ¶Œ¥}Œ¥>0 that maps B1-valued functions
to B2-valued functions.
To do this precisely, for each x ‚ààRn we deÔ¨Åne a bounded linear operator ‚ÉóKŒ¶(x)
from B1 to B2 by setting for c ‚ààC
‚ÉóKŒ¶(x)(c) = {c Œ¶Œ¥(x)}Œ¥‚ààR+ .
Clearly we have
‚ÉóKŒ¶(x)

C‚ÜíL‚àû(R+) = sup
Œ¥>0
|Œ¶Œ¥(x)|.
Now (5.6.18) implies condition (5.6.2) for the kernel ‚ÉóKŒ¶. Also condition (5.6.1)
holds (for some A < depending on n) since
sup
Œ¥>0
|Œ¶Œ¥(x)| ‚â§A|x|‚àín
and also condition (5.6.3) holds since for every Œ¥ > 0 we have
lim
Œµ‚Üí0

Œµ‚â§|y|‚â§1 Œ¶Œ¥(y)dy =

|y|‚â§1 Œ¶Œ¥(y)dy.
We also deÔ¨Åne a B2-valued linear operator acting on complex-valued functions
on Rn by
‚ÉóMŒ¶( f) = f ‚àó‚ÉóKŒ¶ = {f ‚àóŒ¶Œ¥}Œ¥‚ààR+ .
Obvisouly ‚ÉóMŒ¶ maps L‚àû(Rn,B1) to L‚àû(Rn,B2) with norm at most ‚à•Œ¶‚à•L1.

412
5 Singular Integrals of Convolution Type
Applying Theorem 5.6.1 with r = ‚àûwe obtain for 1 < p < ‚àû,
‚ÉóMŒ¶( f)

Lp(Rn,B2) ‚â§Cn max(p,(p‚àí1)‚àí1)

AŒ¶ +‚à•Œ¶‚à•L1
f

Lp(Rn) ,
(5.6.20)
which can be immediately improved to
‚ÉóMŒ¶( f)

Lr(Rn,B2) ‚â§Cn max(1,(r ‚àí1)‚àí1)

AŒ¶ +‚à•Œ¶‚à•L1
f

Lr(Rn)
(5.6.21)
via interpolation with estimate (5.6.19) for all 1 < r < ‚àû.
Next we use estimate (5.6.21) to obtain vector-valued estimates for the sublinear
operator MŒ¶.
Corollary 5.6.5. Let Œ¶ be an integrable function on Rn that satisÔ¨Åes (5.6.18). Then
there exist dimensional constants Cn and C‚Ä≤
n such that for all 1 < p,r < ‚àûthe fol-
lowing vector-valued inequalities are valid:


‚àë
j
|MŒ¶( f j)|r1
r 
L1,‚àû‚â§C‚Ä≤
nc(r)

AŒ¶+‚à•Œ¶‚à•L1


‚àë
j
| f j|r1
r 
L1 ,
(5.6.22)
where c(r) = 1+(r‚àí1)‚àí1, and


‚àë
j
|MŒ¶( f j)|r1
r 
Lp ‚â§Cnc(p,r)

AŒ¶+‚à•Œ¶‚à•L1


‚àë
j
| f j|r1
r 
Lp ,
(5.6.23)
where c(p,r) =

1+(r‚àí1)‚àí1
p+(p‚àí1)‚àí1
.
Proof. We set B1 = C and B2 = L‚àû(R+). We use estimate (5.6.21) as a start-
ing point in Proposition 5.6.4, which immediately yields the required conclusions
(5.6.22) and (5.6.23).
‚ñ°
Similar estimates hold for the Hardy‚ÄìLittlewood maximal operator.
Theorem 5.6.6. For 1 < p,r < ‚àûthe Hardy‚ÄìLittlewood maximal function M satis-
Ô¨Åes the vector-valued inequalities


‚àë
j
|M( f j)|r1
r 
L1,‚àû‚â§C‚Ä≤
n

1+(r‚àí1)‚àí1

‚àë
j
| f j|r1
r 
L1 ,
(5.6.24)


‚àë
j
|M( f j)|r1
r 
Lp ‚â§Cn c(p,r)


‚àë
j
| f j|r1
r 
Lp ,
(5.6.25)
where c(p,r) =

1+(r‚àí1)‚àí1
p+(p‚àí1)‚àí1
.
Proof. Let us Ô¨Åx a positive radial symmetrically decreasing Schwartz function Œ¶ on
Rn that satisÔ¨Åes Œ¶(x) ‚â•1 when |x| ‚â§1. Then the Hardy‚ÄìLittlewood maximal func-
tion M( f) is pointwise controlled by a constant multiple of the function MŒ¶(| f|).

5.6 Vector-Valued Singular Integrals
413
In view of Corollary 5.6.5, it sufÔ¨Åces to check that for such a Œ¶, (5.6.18) holds. First
observe that in view of the decreasing character of Œ¶, we have
sup
j
| f|‚àóŒ¶2 j ‚â§MŒ¶(| f|) ‚â§2n sup
j
| f|‚àóŒ¶2 j ,
and for this reason we choose to work with the easier dyadic maximal operator
Md
Œ¶( f) = sup
j
| f ‚àóŒ¶2 j|.
We observe the validity of the simple inequalties
2‚àín M( f) ‚â§M( f) ‚â§MŒ¶(| f|) ‚â§2nMd
Œ¶(| f|).
(5.6.26)
If we can show that
sup
y‚ààRn\{0}

|x|‚â•2|y| sup
j‚ààZ
|Œ¶2 j(x‚àíy)‚àíŒ¶2 j(x)|dx = Cn < ‚àû,
(5.6.27)
then (5.6.22) and (5.6.23) are satisÔ¨Åed with Md
Œ¶ replacing MŒ¶. We therefore turn
our attention to (5.6.27). We have

|x|‚â•2|y| sup
j‚ààZ
|Œ¶2 j(x‚àíy)‚àíŒ¶2 j(x)|dx
‚â§‚àë
j‚ààZ

|x|‚â•2|y| |Œ¶2 j(x‚àíy)‚àíŒ¶2 j(x)|dx
‚â§‚àë
2 j>|y|

|x|‚â•2|y|
|y||‚àáŒ¶
 x‚àíŒ∏y
2 j

|
2(n+1) j
dx+ ‚àë
2 j‚â§|y|

|x|‚â•2|y|(|Œ¶2 j(x‚àíy)|+|Œ¶2 j(x)|)dx
‚â§‚àë
2 j>|y|

|x|‚â•2|y|
|y|
2(n+1) j
CN dx
(1+|2‚àíj(x‚àíŒ∏y)|)N +2 ‚àë
2 j‚â§|y|

|x|‚â•|y| |Œ¶2 j(x)|dx
‚â§‚àë
2 j>|y|

|x|‚â•2|y|
|y|
2(n+1) j
CN
(1+|2‚àíj‚àí1x|)N dx+2 ‚àë
2 j‚â§|y|

|x|‚â•2‚àíj|y| |Œ¶(x)|dx
‚â§‚àë
2 j>|y|

|x|‚â•2‚àíj|y|
|y|
2j
CN
(1+|x|)N dx+2 ‚àë
2 j‚â§|y|
CN(2‚àíj|y|)‚àíN
‚â§CN ‚àë
2 j>|y|
|y|
2j +CN
‚â§3CN ,
where CN > 0 depends on N > n, Œ∏ ‚àà[0,1], and |x‚àíŒ∏y| ‚â•|x|/2 when |x| ‚â•2|y|.
Now apply (5.6.22) and (5.6.23) to Md
Œ¶ and use (5.6.26) to obtain the desired
vector-valued inequalities.
‚ñ°

414
5 Singular Integrals of Convolution Type
Remark 5.6.7. Observe that (5.6.24) and (5.6.25) also hold for r = ‚àû. These end-
point estimates can be proved directly by observing that
sup
j
M( f j) ‚â§M(sup
j
| f j|).
The same is true for estimates (5.6.22) and (5.6.23). Finally, estimates (5.6.25) and
(5.6.23) also hold for p = ‚àû.
Exercises
5.6.1. (a) For all j ‚ààZ, let Ij be an interval in R and let Tj be the operator given
on the Fourier transform by multiplication by the characteristic function of Ij. Prove
that there exists a constant C > 0 such that for all 1 < p,r < ‚àûand for all square
integrable functions f j on R we have


‚àë
j
|Tj( f j)|r1
r 
Lp(R) ‚â§C max

r,
1
r‚àí1

max

p,
1
p‚àí1


‚àë
j
| f j|r1
r 
Lp(R),


‚àë
j
|Tj( f j)|r1
r 
L1,‚àû(R) ‚â§Cmax

r,
1
r‚àí1


‚àë
j
| f j|r1
r 
L1(R) .
(b) Let Rj be arbitrary rectangles on Rn with sides parallel to the axes and let Sj be
the operators given on the Fourier transform by multiplication by the characteristic
functions of Rj. Prove that there exists a dimensional constant Cn < ‚àûsuch that for
all indices 1 < p,r < ‚àûand for all square integrable functions f j in Lp(Rn) we have


‚àë
j
|Sj( f j)|r1
r 
Lp(Rn)‚â§Cn max

r,
1
r‚àí1
n
max

p,
1
p‚àí1
n

‚àë
j
| f j|r1
r 
Lp(Rn) .

Hint: Part (a): Use Theorem 5.5.1 and the identity Tj = i
2

MaHM‚àía ‚àíMbHM‚àíb
,
if Ij is œá(a,b), where Ma( f)(x) = f(x)e2œÄiax and H is the Hilbert transform. Part (b):
Apply the result in part (a) in each variable.

5.6.2. Let (T,dŒº) be a œÉ-Ô¨Ånite measure space. For every t ‚ààT, let R(t) be a rect-
angle in Rn with sides parallel to the axes such that the map t ‚ÜíR(t) is measurable.
Then there is a constant Cn > 0 such that for all 1 < p < ‚àûand for all families of
square integrable functions {ft}t‚ààT on Rn such that t ‚Üíft(x) is measurable for all
x ‚ààRn we have


T |(1ftœáR(t))‚à®|2 dŒº(t)
1
2 
Lp ‚â§Cn max(p,(p‚àí1)‚àí1)n


T | ft|2 dŒº(t)
1
2 
Lp,

5.6 Vector-Valued Singular Integrals
415

Hint: When n = 1 reduce matters to an Lp(L2(T,dŒº),L2(T,dŒº)) inequality for the
Hilbert transform, via the hint in the preceding exercise. Verify the inequality p = 2
and then use Theorem 5.6.1 for the other p‚Äôs. Obtain the n-dimensional inequality
by iterating the one-dimensional.

5.6.3. Let Œ¶ be a function on Rn that satisÔ¨Åes supx‚ààRn |x|n|Œ¶(x)| ‚â§A and

Rn |Œ¶(x‚àíy)‚àíŒ¶(x)|dx ‚â§Œ∑(y),

|x|‚â•R |Œ¶(x)|dx ‚â§Œ∑(R‚àí1),
for all R ‚â•1, where Œ∑ is a continuous increasing function on [0,2] that satisÔ¨Åes
Œ∑(0) = 0 and
 2
0
Œ∑(t)
t
dt < ‚àû.
(a) Prove that (5.6.27) holds.
(b) Show that if Œ¶ lies in L1(Rn), then the maximal function f ‚Üísupj‚ààZ | f ‚àóŒ¶2 j|
maps Lp(Rn) to itself for 1 < p ‚â§‚àû.

Hint: Part (a): Modify the calculation in the proof of Theorem 5.6.6. Part (b): Use
Theorem 5.6.1 with r = ‚àû.

5.6.4. (a) On R, take f j = œá[2 j‚àí1,2 j] to prove that inequality (5.6.25) fails when p = ‚àû
and 1 < r < ‚àû.
(b) Again on R, take N > 2 and f j = œá[ j‚àí1
N , j
N ] for j = 1,2,...,N to prove that (5.6.25)
fails when 1 < p < ‚àûand r = 1.
5.6.5. Let K be an integrable function on the real line and assume that the operator
f ‚Üíf ‚àóK is bounded on Lp(R) for some 1 < p < ‚àû. Prove that the vector-valued
inequality


‚àë
j
|K ‚àóf j|q1
q 
Lp ‚â§Cp,q


‚àë
j
| f j|q1
q 
Lp
may fail in general when q < 1.

Hint: Take K = œá[‚àí1,1] and f j = œá[ j‚àí1
N , j
N ] for 1 ‚â§j ‚â§N.

5.6.6. Let {Qj}j be a countable collection of cubes in Rn with disjoint interiors.
Let cj be the center of the cube Qj and dj its diameter. For Œµ > 0, deÔ¨Åne the
Marcinkiewicz function associated with the family {Qj}j as follows:
MŒµ(x) = ‚àë
j
dn+Œµ
j
|x‚àícj|n+Œµ +dn+Œµ
j
.
Prove that for some constants Cn,Œµ,p and Cn,Œµ one has
MŒµ

Lp ‚â§Cn,Œµ,p

‚àë
j
|Qj|
 1
p ,
p >
n
n+Œµ ,
MŒµ

L
n
n+Œµ ,‚àû‚â§Cn,Œµ

‚àë
j
|Qj|
 n+Œµ
n ,
and consequently

Rn MŒµ(x)dx ‚â§Cn,Œµ ‚àëj |Qj|.

416
5 Singular Integrals of Convolution Type

Hint: Verify that
dn+Œµ
j
|x‚àícj|n+Œµ +dn+Œµ
j
‚â§CM(œáQj)(x)
n+Œµ
n
and use Theorem 5.6.6.

HISTORICAL NOTES
The Lp boundedness of the conjugate function on the circle was announced in 1924 by Riesz
[292], but its Ô¨Årst proof appeared three years later in [294]. In view of the identiÔ¨Åcation of the
Hilbert transform with the conjugate function, the Lp boundedness of the Hilbert transform is also
attributed to M. Riesz. Riesz‚Äôs proof was Ô¨Årst given for p = 2k, k ‚ààZ+, via an argument similar to
that in the proof of Theorem 4.1.7. For p Ã∏= 2k this proof relied on interpolation and was completed
with the simultaneous publication of Riesz‚Äôs article on interpolation of bilinear forms [293]. The
weak type (1,1) property of the Hilbert transform is due to Kolmogorov [197]. Additional proofs
of the boundedness of the Hilbert transform have been obtained by Stein [350], Loomis [230], and
Calder¬¥on [41]. The proof of Theorem 5.1.7, based on identity (5.1.23), is a reÔ¨Ånement of a proof
given by Cotlar [75].
The norm of the conjugate function on Lp(T1), and consequently that of the Hilbert transform
on Lp(R), was shown by Gohberg and Krupnik [129] to be cot(œÄ/2p) when p is a power of 2. Du-
ality gives that this norm is tan(œÄ/2p) for 1 < p ‚â§2 whenever p‚Ä≤ is a power of 2. Pichorides [282]
extended this result to all 1 < p < ‚àûby reÔ¨Åning Calder¬¥on‚Äôs proof of Riesz‚Äôs theorem. This result
was also independently obtained by B. Cole (unpublished). The direct and simpliÔ¨Åed proof for the
Hilbert transform given in Exercise 5.1.12 is in Grafakos [130]. The norm of the operators 1
2(I¬±iH)
for real-valued functions was found to be 1
2

min(cos(œÄ/2p),sin(œÄ/2p))
‚àí1 by Verbitsky [366] and
later independently by Ess¬¥en [108]. The norm of the same operators for complex-valued functions
was shown to be equal to [sin(œÄ/p)]‚àí1 by Hollenbeck and Verbitsky [156]. Exact formulas for the
Lp norm, 1 ‚â§p < ‚àûof the Hilbert transform acting on a characteristic function were obtained by
Laeng [211]. The best constant in the weak type (1,1) estimate for the Hilbert transform is equal
to (1 + 1
32 + 1
52 + ¬∑¬∑¬∑)(1 ‚àí1
32 + 1
52 ‚àí¬∑¬∑¬∑)‚àí1 as shown by Davis [91] using Brownian motion; an
alternative proof was later obtained by Baernstein [17]. Iwaniec and Martin [175] showed that the
norms of the Riesz transforms on Lp(Rn) coincide with that of the Hilbert transform on Lp(R) for
1 < p < ‚àû.
Operators of the kind TŒ© as well as the stopping-time decomposition of Theorem 5.3.1 were
introduced by Calder¬¥on and Zygmund [46]. In the same article, Calder¬¥on and Zygmund used this
decomposition to prove Theorem 5.3.3 for operators of the form TŒ© when Œ© satisÔ¨Åes a certain
weak smoothness condition. The more general condition (5.3.12) Ô¨Årst appeared in H¬®ormander‚Äôs
article [159]. A more Ô¨Çexible condition sufÔ¨Åcient to yield weak type (1,1) bounds is contained
in the article of Duong and McIntosh [104]. Theorems 5.2.10 and 5.2.11 are also due to Calder¬¥on
and Zygmund [48]. The latter article contains the method of rotations. Algebras of operators of the
form TŒ© were studied in [49]. For more information on algebras of singular integrals see the article
of Calder¬¥on [44]. Theorem 5.4.1 is due to Benedek, Calder¬¥on, and Panzone [22], while Example
5.4.2 is taken from Muckenhoupt [259]. Theorem 5.4.5 is due to Riviere [296]. A weaker version
of this theorem, applicable for smoother singular integrals such as the maximal Hilbert transform,
was obtained by Cotlar [75] (Theorem 5.3.4). Improvements of the main inequality in Theorem
5.3.4 for homogeneous singular integrals were obtained by Mateu and Verdera [245] and Mateu,
Orobitg, and Verdera [244]. For a general overview of singular integrals and their applications, one
may consult the expository article of Calder¬¥on [43].
Part (a) of Theorem 5.5.1 is due to Marcinkiewicz and Zygmund [242], although the case p = q
was proved earlier by Paley [273] with a larger constant. The values of r for which a general linear
operator of weak or strong type (p,q) admits bounded ‚Ñìr extensions are described in Rubio de
Francia and Torrea [304]. The Lp and weak Lp spaces in Theorem 5.5.1 can be replaced by general
Banach lattices, as shown by Krivine [206] using Grothendieck‚Äôs inequality. Hilbert-space-valued

5.6 Vector-Valued Singular Integrals
417
estimates for singular integrals were obtained by Benedek, Calder¬¥on, and Panzone [22]. Other
operator-valued singular integral operators were studied by Rubio de Francia, Ruiz, and Torrea
[303]. Banach-valued singular integrals are studied in great detail in the book of Garc¬¥ƒ±a-Cuerva
and Rubio de Francia [122], which provides an excellent presentation of the subject. The ‚Ñìr-valued
estimates (5.5.16) for the Hilbert transform were Ô¨Årst obtained by Boas and Bochner [28]. The
corresponding vector-valued estimates for the Hardy‚ÄìLittlewood maximal function in Theorem
5.6.6 are due to Fefferman and Stein [115]. Conditions of the form (5.6.18) have been applied to
several situations and can be traced in Zo [386].
The sharpness of the logarithmic condition (5.2.24) was indicated by Weiss and Zygmund [372],
who constructed an example of an integrable function Œ© with vanishing integral on S1 satisfying

Sn‚àí1 |Œ©(Œ∏)|log+ |Œ©(Œ∏)|

log(2 + log(2 + |Œ©(Œ∏)|))
‚àíŒ¥ dŒ∏ = ‚àûfor all Œ¥ > 0 and of a continuous
function in Lp(R2) for all 1 < p < ‚àûsuch that limsupŒµ‚Üí0 |T (Œµ)
Œ© ( f)(x)| = ‚àûfor almost all x ‚ààR2.
The proofs of Theorems 5.2.10 and 5.2.11 can be modiÔ¨Åed to give that if Œ© is in the Hardy space
H1 of Sn‚àí1, then TŒ© and T (‚àó)
Œ©
map Lp to Lp for 1 < p < ‚àû. For TŒ© this fact was proved by Connett
[72] and independently by Ricci and Weiss [289]; for T (‚àó)
Œ©
this was proved by Fan and Pan [110]
and independently by Grafakos and Stefanov [139]. The latter authors [138] also obtained that the
logarithmic condition ess.sup|Œæ|=1

Sn‚àí1 |Œ©(Œ∏)|(log
1
|Œæ¬∑Œ∏||)1+Œ± dŒ∏ < ‚àû, Œ± > 0, implies Lp bounded-
ness for TŒ© and T (‚àó)
Œ©
for some p Ã∏= 2. See also Fan, Guo, and Pan [109] as well as Ryabogin and
Rubin [308] for extensions. Examples of functions Œ© for which TŒ© maps Lp to Lp for a certain
range of p‚Äôs but not for other ranges of p‚Äôs is given in Grafakos, Honz¬¥ƒ±k, and Ryabogin [132]. A
different example of this sort was provided later by Honz¬¥ƒ±k [158]; the range of p‚Äôs for which bound-
edness holds are different for these examples. Honz¬¥ƒ±k [157] also constructed a delicate example of
an integrable function Œ© with mean value zero over S1 such that TŒ© is bounded on L2(R) but T (‚àó)
Œ©
is not.
The relatively weak condition |Œ©|log+ |Œ©| ‚ààL1(Sn‚àí1) also implies weak type (1,1) bound-
edness for operators TŒ©. This was obtained by Seeger [317] and later extended by Tao [355] to
situations in which there is no Fourier transform structure. Earlier partial results are in Christ and
Rubio de Francia [63] and in the simultaneous work of Hofmann [155], both inspired by the work
of Christ [60]. Soria and Sj¬®ogren [324] showed that for arbitrary Œ© in L1(Sn‚àí1), TŒ© is weak type
(1,1) when restricted to radial functions. Examples due to Christ (published in [139]) indicate
that even for bounded functions Œ© on Sn‚àí1, TŒ© may not map the endpoint Hardy space H1(Rn) to
L1(Rn). However, Seeger and Tao [318] have showed that TŒ© always maps the Hardy space H1(Rn)
to the Lorentz space L1,2(Rn) when |Œ©|(log+ |Œ©|)2 is integrable over Sn‚àí1. This result is sharp in
the sense that for such Œ©, TŒ© may not map H1(Rn) to L1,q(Rn) when q < 2 in general. If TŒ© maps
H1(Rn) to itself, Daly and Phillips [87] (in dimension n = 2) and Daly [86] (in dimensions n ‚â•3)
showed that Œ© must lie in the Hardy space H1(Sn‚àí1). There are also results concerning the singu-
lar maximal operator MŒ©( f)(x) = supr>0
1
vnrn

|y|‚â§r | f(x ‚àíy)||Œ©(y)|dy, where Œ© is an integrable
function on Sn‚àí1 of not necessarily vanishing integral. Such operators were studied by Fefferman
[116], Christ [60], and Hudson [162]. An excellent treatment of several kinds of singular integral
operators with rough kernels is contained in the book of Lu, Ding, and Yan [234].

Chapter 6
Littlewood‚ÄìPaley Theory and Multipliers
In this chapter we are concerned with orthogonality properties of the Fourier trans-
form. This orthogonality is easily understood on L2, but at this point it is not clear
how it manifests itself on other spaces. Square functions introduce a way to express
and quantify orthogonality of the Fourier transform on Lp and other function spaces.
The introduction of square functions in this setting was pioneered by Littlewood and
Paley, and the theory that subsequently developed is named after them. The extent
to which Littlewood‚ÄìPaley theory characterizes function spaces is remarkable.
Historically, Littlewood‚ÄìPaley theory Ô¨Årst appeared in the context of one-dimen-
sional Fourier series and depended on complex function theory. With the develop-
ment of real-variable methods, the whole theory became independent of complex
methods and was extended to Rn. This is the approach that we follow in this chapter.
It turns out that the Littlewood‚ÄìPaley theory is intimately related to the Calder¬¥on‚Äì
Zygmund theory introduced in the previous chapter. This connection is deep and
far-reaching, and its central feature is that one is able to derive the main results of
one theory from the other.
The thrust and power of the Littlewood‚ÄìPaley theory become apparent in some of
the applications we discuss in this chapter. Such applications include the derivation
of certain multiplier theorems, that is, theorems that yield sufÔ¨Åcient conditions for
bounded functions to be Lp multipliers. As a consequence of Littlewood‚ÄìPaley the-
ory we also prove that the lacunary partial Fourier integrals

|Œæ|‚â§2N 1f(Œæ)e2œÄix¬∑Œæ dŒæ
converge almost everywhere to an Lp function f on Rn.
6.1 Littlewood‚ÄìPaley Theory
We begin by examining more closely what we mean by orthogonality of the Fourier
transform. If the functions f j deÔ¨Åned on Rn have Fourier transforms 1f j supported in
disjoint sets, then they are orthogonal in the sense that
L. Grafakos, Classical Fourier Analysis, Graduate Texts in Mathematics 249,
DOI 10.1007/978-1-4939-1194-3 6, ¬© Springer Science+Business Media New York 2014
419

420
6 Littlewood‚ÄìPaley Theory and Multipliers
‚àë
j
f j
2
L2 = ‚àë
j
 f j
2
L2.
(6.1.1)
Unfortunately, when 2 is replaced by some p Ã∏= 2 in (6.1.1), the previous quanti-
ties may not even be comparable, as we show in Examples 6.1.8 and 6.1.9. The
Littlewood‚ÄìPaley theorem provides a substitute inequality to (6.1.1) expressing the
fact that certain orthogonality considerations are also valid in Lp(Rn).
6.1.1 The Littlewood‚ÄìPaley Theorem
The orthogonality we are searching for is best seen in the context of one-dimensional
Fourier series (which was the setting in which Littlewood and Paley formulated
their result). The primary observation is that the exponential e2œÄi2kx oscillates half
as much as e2œÄi2k+1x and is therefore nearly constant in each period of the latter.
This observation was instrumental in the proof of Theorem 3.6.4, which implied in
particular that for all 1 < p < ‚àûwe have

N
‚àë
k=1
ake2œÄi2kx
Lp[0,1] ‚âà
 N
‚àë
k=1
|ak|2 1
2 .
(6.1.2)
In other words, we can calculate the Lp norm of ‚àëN
k=1 ake2œÄi2kx in almost a pre-
cise fashion to obtain (modulo multiplicative constants) the same answer as in the
L2 case. Similar calculations are valid for more general blocks of exponentials in
the dyadic range {2k + 1,...,2k+1 ‚àí1}, since the exponentials in each such block
behave independently from those in each previous block. In particular, the Lp inte-
grability of a function on T1 is not affected by the randomization of the sign of its
Fourier coefÔ¨Åcients in the previous dyadic blocks. This is the intuition behind the
Littlewood‚ÄìPaley theorem.
Motivated by this discussion, we introduce the Littlewood‚ÄìPaley operators in the
continuous setting.
DeÔ¨Ånition 6.1.1. Let Œ® be an integrable function on Rn and j ‚ààZ. We deÔ¨Åne the
Littlewood‚ÄìPaley operator Œî j associated with Œ® by
Œî j( f) = f ‚àóŒ®2‚àíj,
where Œ®2‚àíj(x) = 2jnŒ®(2jx) for all x in Rn. Thus we have 3
Œ®2‚àíj(Œæ) = 1
Œ®(2‚àíjŒæ) for
all Œæ in Rn. We note that whenever Œ® is a Schwartz function and f is a tempered
distribution, the quantity Œî j( f) is a well deÔ¨Åned function.
These operators depend on the choice of the function Œ®; in most applications
we choose Œ® to be a smooth function with compactly supported Fourier transform.
Observe that if 1
Œ® is supported in some annulus 0 < c1 < |Œæ| < c2 < ‚àû, then the
Fourier transform of Œî j is supported in the annulus c12j < |Œæ| < c22j; in other

6.1 Littlewood‚ÄìPaley Theory
421
words, it is localized near the frequency |Œæ| ‚âà2j. Thus the purpose of Œî j is to
isolate the part of frequency of a function concentrated near |Œæ| ‚âà2j.
The square function associated with the Littlewood‚ÄìPaley operators Œî j is
deÔ¨Åned by
f ‚Üí

‚àë
j‚ààZ
|Œî j( f)|2 1
2 .
This quadratic expression captures the intrinsic orthogonality of the function f.
Theorem 6.1.2. (Littlewood‚ÄìPaley theorem) Suppose that Œ® is an integrable C 1
function on Rn with mean value zero that satisÔ¨Åes
|Œ®(x)|+|‚àáŒ®(x)| ‚â§B(1+|x|)‚àín‚àí1 .
(6.1.3)
Then there exists a constant Cn < ‚àûsuch that for all 1 < p < ‚àûand all f in Lp(Rn)
we have


‚àë
j‚ààZ
|Œî j( f)|2 1
2 
Lp(Rn) ‚â§CnBmax

p,(p‚àí1)‚àí1 f

Lp(Rn).
(6.1.4)
There also exists a C‚Ä≤
n < ‚àûsuch that for all f in L1(Rn) we have


‚àë
j‚ààZ
|Œî j( f)|2 1
2 
L1,‚àû(Rn) ‚â§C‚Ä≤
nB
 f

L1(Rn).
(6.1.5)
Conversely, let Œ® be a Schwartz function such that either 1
Œ®(0) = 0 and
‚àë
j‚ààZ
| 1
Œ®(2‚àíjŒæ)|2 = 1,
for all Œæ ‚ààRn \{0},
(6.1.6)
or 1
Œ® is compactly supported away from the origin and
‚àë
j‚ààZ
1
Œ®(2‚àíjŒæ) = 1,
for all Œæ ‚ààRn \{0}.
(6.1.7)
Then there is a constant Cn,Œ®, such that for any f ‚ààS ‚Ä≤(Rn) with

‚àëj‚ààZ |Œî j( f)|2 1
2
in Lp(Rn) for some 1 < p < ‚àû, there exists a unique polynomial Q such that the
tempered distribution f ‚àíQ coincides with an Lp function, and we have
f ‚àíQ

Lp(Rn) ‚â§Cn,Œ® Bmax

p,(p‚àí1)‚àí1

‚àë
j‚ààZ
|Œî j( f)|2 1
2 
Lp(Rn) .
(6.1.8)
Consequently, if g lies in Lp(Rn) for some 1 < p < ‚àû, then
g‚à•Lp(Rn) ‚âà


‚àë
j‚ààZ
|Œî j(g)|2 1
2 
Lp(Rn) .

422
6 Littlewood‚ÄìPaley Theory and Multipliers
Proof. We Ô¨Årst prove (6.1.4) when p = 2. Using Plancherel‚Äôs theorem, we see that
(6.1.4) is a consequence of the inequality
‚àë
j
| 1
Œ®(2‚àíjŒæ)|2 ‚â§CnB2
(6.1.9)
for some Cn < ‚àû. Because of (6.1.3), Fourier inversion holds for Œ®. Furthermore, Œ®
has mean value zero and we may write
1
Œ®(Œæ) =

Rn e‚àí2œÄix¬∑ŒæŒ®(x)dx =

Rn(e‚àí2œÄix¬∑Œæ ‚àí1)Œ®(x)dx,
(6.1.10)
from which we obtain the estimate
| 1
Œ®(Œæ)| ‚â§
"
4œÄ|Œæ|

Rn |x|
1
2 |Œ®(x)|dx ‚â§CnB|Œæ|
1
2 .
(6.1.11)
For Œæ = (Œæ1,...,Œæn) Ã∏= 0, let j be such that |Œæ j| ‚â•|Œæk| for all k ‚àà{1,...,n}. Integrate
by parts with respect to ‚àÇj in (6.1.10) to obtain
1
Œ®(Œæ) = ‚àí

Rn(‚àí2œÄiŒæ j)‚àí1e‚àí2œÄix¬∑Œæ(‚àÇjŒ®)(x)dx,
from which we deduce the estimate
| 1
Œ®(Œæ)| ‚â§‚àön|Œæ|‚àí1

Rn |‚àáŒ®(x)|dx ‚â§CnB|Œæ|‚àí1.
(6.1.12)
We now break the sum in (6.1.9) into the parts where 2‚àíj|Œæ| ‚â§1 and 2‚àíj|Œæ| ‚â•1
and use (6.1.11) and (6.1.12), respectively, to obtain (6.1.9). (See also Exercise 6.1.2.)
This proves (6.1.4) when p = 2.
We now turn our attention to the case p Ã∏= 2 in (6.1.4). We view (6.1.4) and (6.1.5)
as vector-valued inequalities in the spirit of Section 5.5. DeÔ¨Åne an operator ‚ÉóT acting
on functions on Rn as follows:
‚ÉóT( f)(x) = {Œî j( f)(x)}j .
The inequalities (6.1.4) and (6.1.5) we wish to prove say simply that ‚ÉóT is a bounded
operator from Lp(Rn,C) to Lp(Rn,‚Ñì2) and from L1(Rn,C) to L1,‚àû(Rn,‚Ñì2). We just
proved that this statement is true when p = 2, and therefore the Ô¨Årst hypothesis of
Theorem 5.6.1 is satisÔ¨Åed. We observe that the operator ‚ÉóT can be written in the form
‚ÉóT( f)(x) =
$
RnŒ®2‚àíj(x‚àíy) f(y)dy
%
j
=

Rn ‚ÉóK(x‚àíy)( f(y))dy,
where for each x ‚ààRn, ‚ÉóK(x) is a bounded linear operator from C to ‚Ñì2 given by
‚ÉóK(x)(a) = {Œ®2‚àíj(x)a}j.
(6.1.13)

6.1 Littlewood‚ÄìPaley Theory
423
We clearly have that ‚à•‚ÉóK(x)‚à•C‚Üí‚Ñì2 =

‚àëj |Œ®2‚àíj(x)|2 1
2 , and to be able to apply
Theorem 5.6.1 we need to know that for some constant Cn we have
‚ÉóK(x)

C‚Üí‚Ñì2 ‚â§Cn B|x|‚àín ,
(6.1.14)
lim
Œµ‚Üì0

Œµ‚â§|y|‚â§1
‚ÉóK(y)dy =
$ 1
0 Œ®2 j(y)dy
%
j‚ààZ
,
(6.1.15)
sup
yÃ∏=0

|x|‚â•2|y|
‚ÉóK(x‚àíy)‚àí‚ÉóK(x)

C‚Üí‚Ñì2 dx ‚â§CnB.
(6.1.16)
Of these, (6.1.14) is easily obtained using (6.1.3), (6.1.15) i.e. trivial, and so we focus
on (6.1.16). Since Œ® is a C 1 function, for |x| ‚â•2|y| we have
|Œ®2‚àíj(x‚àíy)‚àíŒ®2‚àíj(x)|
‚â§2(n+1) j|‚àáŒ®(2j(x‚àíŒ∏y))||y|
for some Œ∏ ‚àà[0,1],
‚â§B2(n+1) j
1+2j|x‚àíŒ∏y|
‚àí(n+1)|y|
‚â§B2n j
1+2j‚àí1|x|
‚àí(n+1)2j|y|
since |x‚àíŒ∏y| ‚â•1
2|x|.
(6.1.17)
We also have that
|Œ®2‚àíj(x‚àíy)‚àíŒ®2‚àíj(x)|
‚â§2n j|Œ®(2j(x‚àíy))|+2jn|Œ®(2jx)|
‚â§B2n j
1+2j|x|
‚àí(n+1) +B2jn
1+2j‚àí1|x|
‚àí(n+1)
‚â§2B2n j
1+2j‚àí1|x|
‚àí(n+1).
(6.1.18)
Taking the geometric mean of (6.1.17) and (6.1.18), we obtain for any Œ≥ ‚àà[0,1]
|Œ®2‚àíj(x‚àíy)‚àíŒ®2‚àíj(x)| ‚â§21‚àíŒ≥ B2n j(2j|y|)Œ≥
1+2j‚àí1|x|
‚àí(n+1) .
(6.1.19)
Using this estimate, when |x| ‚â•2|y|, we obtain
‚ÉóK(x‚àíy)‚àí‚ÉóK(x)

C‚Üí‚Ñì2 =

‚àë
j‚ààZ
Œ®2‚àíj(x‚àíy)‚àíŒ®2‚àíj(x)
2
1/2
‚â§‚àë
j‚ààZ
Œ®2‚àíj(x‚àíy)‚àíŒ®2‚àíj(x)

‚â§2B

|y| ‚àë
2 j< 2
|x|
2(n+1) j +|y|
1
2 ‚àë
2 j‚â•2
|x|
2(n+ 1
2 ) j(2j‚àí1|x|)‚àí(n+1)
‚â§CnB

|y||x|‚àín‚àí1 +|y|
1
2 |x|‚àín‚àí1
2 
,
where we used (6.1.19) with Œ≥ = 1 in the Ô¨Årst sum and (6.1.19) with Œ≥ = 1/2 in
the second sum. Using this bound, we easily deduce (6.1.16) by integrating over the

424
6 Littlewood‚ÄìPaley Theory and Multipliers
region |x| ‚â•2|y|. Finally, using Theorem 5.6.1 we conclude the proofs of (6.1.4) and
(6.1.5), which establishes one direction of the theorem.
We now turn to the converse direction. Let Œî ‚àó
j be the adjoint operator of Œî j
given by 3
Œî ‚àó
j f = 1f 3
Œ®2‚àíj. Let f be in S ‚Ä≤(Rn). Then the series ‚àëj‚ààZ Œî ‚àó
j Œî j( f) con-
verges in S ‚Ä≤(Rn). To see this, it sufÔ¨Åces to show that the sequence of partial sums
uN = ‚àë| j|<N Œî ‚àó
j Œî j( f) converges in S ‚Ä≤. This means that if we test this sequence
against a Schwartz function g, then it is a Cauchy sequence and hence it converges as
N ‚Üí‚àû. But an easy argument using duality and the Cauchy‚ÄìSchwarz and H¬®older‚Äôs
inequalities shows that for M > N we have
|‚ü®uN,g‚ü©‚àí‚ü®uM,g‚ü©| ‚â§


‚àë
j
|Œî j( f)|2 1
2

Lp


‚àë
N‚â§| j|‚â§M
|Œî j(g)|2 1
2 
Lp‚Ä≤ ,
and this can be made small by picking M > N ‚â•N0(g). Since the sequence ‚ü®uN,g‚ü©is
Cauchy, it converges to some Œõ(g). Now it remains to show that the map g ‚ÜíŒõ(g)
is a tempered distribution. Obviously Œõ(g) is a linear functional. Also,
|Œõ(g)| ‚â§


‚àë
j
|Œî j( f)|2 1
2

Lp


‚àë
j
|Œî j(g)|2 1
2 
Lp‚Ä≤
‚â§Cp‚Ä≤


‚àë
j
|Œî j( f)|2 1
2

Lp
g

Lp‚Ä≤ ,
and since ‚à•g‚à•Lp‚Ä≤ is controlled by a Ô¨Ånite number of Schwartz seminorms of g, it
follows that Œõ is in S ‚Ä≤. The distribution Œõ is the limit of the series ‚àëj Œî ‚àó
j Œî j.
Under hypothesis (6.1.6), the Fourier transform of the tempered distribution f ‚àí
‚àëj‚ààZ Œî ‚àó
j Œî j( f) is supported at the origin. This implies that there exists a polynomial
Q such that f ‚àíQ = ‚àëj‚ààZ Œî ‚àó
j Œî j( f). Now let g be a Schwartz function. We have
4
f ‚àíQ, g
5 =
4 ‚àë
j‚ààZ
Œî ‚àó
j Œî j( f),g
5
=
 ‚àë
j‚ààZ
4
Œî ‚àó
j Œî j( f),g
5
=
 ‚àë
j‚ààZ
4
Œî j( f),Œî j(g)
5
=


Rn ‚àë
j‚ààZ
Œî j( f) Œî j(g)dx

‚â§

Rn

‚àë
j‚ààZ
|Œî j( f)|2 1
2 
‚àë
j‚ààZ
|Œî j(g)|2 1
2 dx
‚â§


‚àë
j‚ààZ
|Œî j( f)|2 1
2 
Lp


‚àë
j‚ààZ
|Œî j(g)|2 1
2 
Lp‚Ä≤

6.1 Littlewood‚ÄìPaley Theory
425
‚â§


‚àë
j‚ààZ
|Œî j( f)|2 1
2 
LpCnBmax

p‚Ä≤,(p‚Ä≤ ‚àí1)‚àí1g

Lp‚Ä≤ ,
(6.1.20)
having used the deÔ¨Ånition of the adjoint (Section 2.5.2), the Cauchy‚ÄìSchwarz in-
equality, H¬®older‚Äôs inequality, and (6.1.4). Taking the supremum over all g in Lp‚Ä≤
with norm at most one, we obtain that the tempered distribution f ‚àíQ is a bounded
linear functional on Lp‚Ä≤. By the Riesz representation theorem, f ‚àíQ coincides with
an Lp function whose norm satisÔ¨Åes the estimate
f ‚àíQ

Lp ‚â§CnBmax

p,(p‚àí1)‚àí1

‚àë
j‚ààZ
|Œî j( f)|2 1
2 
Lp .
We now show uniqueness. If Q1 is another polynomial, with f ‚àíQ1 ‚ààLp, then
Q ‚àíQ1 must be an Lp function; but the only polynomial that lies in Lp is the zero
polynomial. This completes the proof of the converse of the theorem under hypoth-
esis (6.1.6).
To obtain the same conclusion under the hypothesis (6.1.7) we argue in a similar
way but we leave the details as an exercise. (One may adapt the argument in the
proof of Corollary 6.1.7 to this setting.)
‚ñ°
Remark 6.1.3. We make some observations. If 1
Œ® is real-valued, then the operators
Œî j are self-adjoint. Indeed,

Rn Œî j( f)gdx =

Rn
1f 3
Œ®2‚àíj 1gdŒæ =

Rn
1f 3
Œ®2‚àíj 1gdŒæ =

Rn f Œî j(g)dx.
Moreover, if Œ® is a radial function, we see that the operators Œî j are self-transpose,
that is, they satisfy

Rn Œî j( f)gdx =

Rn f Œî j(g)dx.
Assume now that Œ® is both radial and has a real-valued Fourier transform. Suppose
also that Œ® satisÔ¨Åes (6.1.3) and that it has mean value zero. Then the inequality
 ‚àë
j‚ààZ
Œî j( f j)

Lp ‚â§CnBmax

p,(p‚àí1)‚àí1

‚àë
j‚ààZ
| f j|21
2 
Lp
(6.1.21)
is true for sequences of functions {f j}j. To see this we use duality. Let
‚ÉóT( f) = {Œî j( f)}j .
Then
‚ÉóT ‚àó({gj}j) = ‚àë
j
Œî j(gj).
Inequality (6.1.4) says that the operator ‚ÉóT maps Lp(Rn,C) to Lp(Rn,‚Ñì2), and its dual
statement is that ‚ÉóT ‚àómaps Lp‚Ä≤(Rn,‚Ñì2) to Lp‚Ä≤(Rn,C). This is exactly the statement in
(6.1.21) if p is replaced by p‚Ä≤. Since p is any number in (1,‚àû), (6.1.21) is proved.

426
6 Littlewood‚ÄìPaley Theory and Multipliers
6.1.2 Vector-Valued Analogues
We now obtain a vector-valued extension of Theorem 6.1.2. We have the following.
Proposition 6.1.4. Let Œ® be an integrable C 1 function on Rn with mean value zero
that satisÔ¨Åes (6.1.3) and let Œî j be the Littlewood‚ÄìPaley operator associated with Œ®.
Then there exists a constant Cn < ‚àûsuch that for all 1 < p,r < ‚àûand all sequences
of Lp functions f j we have


‚àë
j‚ààZ

‚àë
k‚ààZ
|Œîk( f j)|2r
2 1
r 
Lp(Rn) ‚â§CnB #Cp,r


‚àë
j‚ààZ
| f j|r1
r 
Lp(Rn) ,
where #Cp,r = max(p,(p ‚àí1)‚àí1)max(r,(r ‚àí1)‚àí1). Moreover, for some C‚Ä≤
n > 0 and
all sequences of L1 functions f j we have


‚àë
j‚ààZ

‚àë
k‚ààZ
|Œîk( f j)|2r
2 1
r 
L1,‚àû(Rn) ‚â§C‚Ä≤
nBmax(r,(r ‚àí1)‚àí1)


‚àë
j‚ààZ
| f j|r1
r 
L1(Rn) .
In particular,


‚àë
j‚ààZ
|Œî j( f j)|r1
r 
Lp(Rn) ‚â§CnB #Cp,r


‚àë
j‚ààZ
| f j|r1
r 
Lp(Rn) .
(6.1.22)
Proof. We introduce Banach spaces B1 = C and B2 = ‚Ñì2 and for f ‚ààLp(Rn) deÔ¨Åne
an operator
‚ÉóT( f) = {Œîk( f)}k‚ààZ .
In the proof of Theorem 6.1.2 we showed that ‚ÉóT has a kernel ‚ÉóK that satisÔ¨Åes con-
dition (6.1.16). Furthermore, ‚ÉóT obviously maps Lr(Rn,C) to Lr(Rn,‚Ñìr). Applying
Proposition 5.6.4, we obtain the Ô¨Årst two statements of the proposition. Restricting
to k = j yields (6.1.22).
‚ñ°
6.1.3 Lp Estimates for Square Functions Associated with Dyadic
Sums
Let us pick a Schwartz function Œ® whose Fourier transform is compactly supported
in the annulus 2‚àí1 ‚â§|Œæ| ‚â§22 such that (6.1.6) is satisÔ¨Åed. (Clearly (6.1.6) has no
chance of being satisÔ¨Åed if 1
Œ® is supported only in the annulus 1 ‚â§|Œæ| ‚â§2.) The
Littlewood‚ÄìPaley operation f ‚ÜíŒî j( f) represents the smoothly truncated frequency
localization of a function f near the dyadic annulus |Œæ| ‚âà2j. Theorem 6.1.2 says that
the square function formed by these localizations has Lp norm comparable to that of
the original function. In other words, this square function characterizes the Lp norm
of a function. This is the main feature of Littlewood‚ÄìPaley theory.

6.1 Littlewood‚ÄìPaley Theory
427
One may ask whether Theorem 6.1.2 still holds if the Littlewood‚ÄìPaley operators
Œî j are replaced by their nonsmooth versions
f ‚Üí

œá2 j‚â§|Œæ|<2 j+1 1f(Œæ)
‚à®(x).
(6.1.23)
This question has a surprising answer that already signals that there may be some
fundamental differences between one-dimensional and higher-dimensional Fourier
analysis. The square function formed by the operators in (6.1.23) can be used to
characterize Lp(R) in the same way Œî j did, but not Lp(Rn) when n > 1 and p Ã∏= 2.
The problem lies in the fact that the characteristic function of the unit disk is not
an Lp multiplier on Rn when n ‚â•2 unless p = 2; see Section 5.1 in [131]. The
one-dimensional result we alluded to earlier is the following.
For j ‚ààZ we introduce the one-dimensional operator
Œî #
j ( f)(x) = ( 1f œáIj)‚à®(x),
(6.1.24)
where
Ij = [2j,2j+1)‚à™(‚àí2j+1,‚àí2j],
and Œî #
j is a version of the operator Œî j in which the characteristic function of the set
2j ‚â§|Œæ| < 2j+1 replaces the function 1
Œ®(2‚àíjŒæ).
Theorem 6.1.5. There exists a constant C1 such that for all 1 < p < ‚àûand all f in
Lp(R) we have
f

Lp(Rn)
C1(p+
1
p‚àí1)2 ‚â§


‚àë
j‚ààZ
|Œî #
j ( f)|21
2 
Lp(Rn) ‚â§C1(p+
1
p‚àí1)2f

Lp(Rn).
(6.1.25)
Proof. Pick a Schwartz function œà on the line whose Fourier transform is supported
in the set 2‚àí1 ‚â§|Œæ| ‚â§22 and is equal to 1 on the set 1 ‚â§|Œæ| ‚â§2. Let Œî j be the
Littlewood‚ÄìPaley operator associated with œà. Observe that Œî jŒî #
j = Œî #
j Œî j = Œî #
j ,
since 1œà is equal to one on the support of Œî #
j ( f)1. We now use Exercise 5.6.1(a) to
obtain


‚àë
j‚ààZ
|Œî #
j ( f)|21
2 
Lp =


‚àë
j‚ààZ
|Œî #
j Œî j( f)|21
2 
Lp
‚â§Cmax(p,(p‚àí1)‚àí1)


‚àë
j‚ààZ
|Œî j( f)|21
2 
Lp
‚â§CBmax(p,(p‚àí1)‚àí1)2f

Lp ,
where the last inequality follows from Theorem 6.1.2. The reverse inequality for
1 < p < ‚àûfollows just like the reverse inequality (6.1.8) of Theorem 6.1.2 by simply
replacing the Œî j‚Äôs by the Œî #
j ‚Äôs and setting the polynomial Q equal to zero. (There is
no need to use the Riesz representation theorem here, just the fact that the Lp norm

428
6 Littlewood‚ÄìPaley Theory and Multipliers
of f can be realized as the supremum of expressions |‚ü®f,g‚ü©| where g has Lp‚Ä≤ norm
at most 1.)
‚ñ°
There is a higher-dimensional version of Theorem 6.1.5 with dyadic rectan-
gles replacing the dyadic intervals. As has already been pointed out, the higher-
dimensional version with dyadic annuli replacing the dyadic intervals is false.
Let us introduce some notation. For j ‚ààZ, we denote by Ij the dyadic set
[2j,2j+1)(‚àí2j+1,‚àí2j] as in the statement of Theorem 6.1.5. For j1,..., jn ‚ààZ
deÔ¨Åne a dyadic rectangle
Rj1,..., jn = Ij1 √ó¬∑¬∑¬∑√óIjn
in Rn. Actually Rj1,..., jn is not a rectangle but a union of 2n rectangles; with some
abuse of language we still call it a rectangle. For notational convenience we write
Rj = Rj1,..., jn ,
where j = ( j1,..., jn) ‚ààZn.
Observe that for different j,j‚Ä≤ ‚ààZn the rectangles Rj and Rj‚Ä≤ have disjoint interiors
and that the union of all the Rj‚Äôs is equal to Rn \{0}. In other words, the family of
Rj‚Äôs, where j ‚ààZn, forms a tiling of Rn, which we call the dyadic decomposition of
Rn. We now introduce operators
Œî #
j ( f)(x) = ( 1f œáRj)‚à®(x),
(6.1.26)
and we have the following n-dimensional extension of Theorem 6.1.5.
Theorem 6.1.6. For a Schwartz function œà on the line with integral zero we deÔ¨Åne
the operator
Œîj( f)(x) =
 1œà(2‚àíj1Œæ1)¬∑¬∑¬∑ 1œà(2‚àíjnŒæn) 1f(Œæ)
‚à®(x),
(6.1.27)
where j = ( j1,..., jn) ‚ààZn. Then there is a dimensional constant Cn such that


‚àë
j‚ààZn
|Œîj( f)|21
2 
Lp(Rn) ‚â§Cn(p+(p‚àí1)‚àí1)n f

Lp(Rn) .
(6.1.28)
Let Œî #
j be the operators deÔ¨Åned in (6.1.26). Then there exists a positive constant Cn
such that for all 1 < p < ‚àûand all f ‚ààLp(Rn) we have
f

Lp(Rn)
Cn(p+
1
p‚àí1)2n ‚â§


‚àë
j‚ààZn
|Œî #
j ( f)|21
2 
Lp(Rn) ‚â§Cn(p+
1
p‚àí1)2n f

Lp(Rn). (6.1.29)
Proof. We Ô¨Årst prove (6.1.28). Note that if j = ( j1,..., jn) ‚ààZn, then the operator
Œîj is equal to
Œîj( f) = Œî ( j1)
j1
¬∑¬∑¬∑Œî ( jn)
jn ( f),

6.1 Littlewood‚ÄìPaley Theory
429
where the Œî ( jr)
jr
are one-dimensional operators given on the Fourier transform
by multiplication by 1œà(2‚àíjrŒær), with the remaining variables Ô¨Åxed. Inequality in
(6.1.28) is a consequence of the one-dimensional case. For instance, we discuss the
case n = 2. Using Proposition 6.1.4, we obtain


‚àë
j‚ààZ2
|Œîj( f)|21
2 
p
Lp(R2)
=

R

R

‚àë
j1‚ààZ ‚àë
j2‚ààZ
|Œî (1)
j1 Œî (2)
j2 ( f)(x1,x2)|2p
2 dx1

dx2
‚â§Cp max(p,(p‚àí1)‚àí1)p

R

R

‚àë
j2‚ààZ
|Œî (2)
j2 ( f)(x1,x2)|2p
2 dx1

dx2
= Cp max(p,(p‚àí1)‚àí1)p

R

R

‚àë
j2‚ààZ
|Œî (2)
j2 ( f)(x1,x2)|2p
2 dx2

dx1
‚â§C2p max(p,(p‚àí1)‚àí1)2p

R

R | f(x1,x2)|p dx2

dx1
= C2p max(p,(p‚àí1)‚àí1)2pf
p
Lp(R2) ,
where we also used Theorem 6.1.2 in the calculation. Higher-dimensional versions
of this estimate may easily be obtained by induction.
We now turn to the upper inequality in (6.1.29). We pick a Schwartz function œà
whose Fourier transform is supported in the union [‚àí4,‚àí1/2][1/2,4] and is equal
to 1 on [‚àí2,‚àí1][1,2]. Then we clearly have
Œî #
j = Œî #
j Œîj ,
since 1œà(2‚àíj1Œæ1)¬∑¬∑¬∑ 1œà(2‚àíjnŒæn) is equal to 1 on the rectangle Rj. We now use Exercise
5.6.1(b) and estimate (6.1.28) to obtain


‚àë
j‚ààZn
|Œî #
j ( f)|21
2 
Lp =


‚àë
j‚ààZn
|Œî #
j Œîj( f)|21
2 
Lp
‚â§Cmax(p,(p‚àí1)‚àí1)n

‚àë
j‚ààZn
|Œîj( f)|21
2 
Lp
‚â§CBmax(p,(p‚àí1)‚àí1)2n f

Lp .
The lower inequality in (6.1.29) for 1 < p < ‚àûis proved like inequality (6.1.8) in
Theorem 6.1.2. The fundamental ingredient in the proof is that f = ‚àëj‚ààZn Œî #
j Œî #
j ( f)
for all Schwartz functions f, where the sum is interpreted as the L2-limit of the se-
quence of partial sums. Thus the series converges in S ‚Ä≤, and pairing with a Schwartz
function g, we obtain the lower inequality in (6.1.29) for Schwartz functions, by
applying the steps that prove (6.1.20) (with Q = 0). To prove the lower inequality

430
6 Littlewood‚ÄìPaley Theory and Multipliers
in (6.1.29) for a general function f ‚ààLp(Rn) we approximate an Lp function by a
sequence of Schwartz functions in the Lp norm. Then both sides of the lower in-
equality in (6.1.29) for the approximating sequence converge to the corresponding
sides of the lower inequality in (6.1.29) for f; the convergence of the sequence of
Lp norms of the square functions requires the upper inequality in (6.1.29) that was
previously established. This concludes the proof of the theorem.
‚ñ°
Next we observe that if the Schwartz function œà is suitably chosen, then the
reverse inequality in estimate (6.1.28) also holds. More precisely, suppose 1œà(Œæ) is
an even smooth real-valued function supported in the set
9
10 ‚â§|Œæ| ‚â§21
10 in R that
satisÔ¨Åes
‚àë
j‚ààZ
1œà(2‚àíjŒæ) = 1,
Œæ ‚ààR\{0};
(6.1.30)
then we have the following.
Corollary 6.1.7. Suppose that œà satisÔ¨Åes (6.1.30) and let Œîj be as in (6.1.27). Let f
be an Lp function on Rn such that the function

‚àëj‚ààZn |Œîj( f)|21
2 is in Lp(Rn). Then
there is a constant Cn that depends only on the dimension and œà such that the lower
estimate
f

Lp
Cn(p+
1
p‚àí1)n ‚â§


‚àë
j‚ààZn
|Œîj( f)|21
2 
Lp
(6.1.31)
holds.
Proof. If we had ‚àëj‚ààZ | 1œà(2‚àíjŒæ)|2 = 1 instead of (6.1.30), then we could apply the
method used in the lower estimate of Theorem 6.1.2 to obtain the required conclu-
sion. In this case we provide another argument that is very similar in spirit.
We Ô¨Årst prove (6.1.31) for Schwartz functions f. Then the series ‚àëj‚ààZn Œîj( f)
converges in L2 (and hence in S ‚Ä≤) to f. Now let g be another Schwartz function. We
express the inner product
4
f,g
5
as the action of the distribution ‚àëj‚ààZn Œîj( f) on the
test function g:
4
f,g
5 =

4 ‚àë
j‚ààZn
Œîj( f),g
5
=
 ‚àë
j‚ààZn
4
Œîj( f),g
5
=
 ‚àë
j‚ààZn
‚àë
k=(k1,...,kn)‚ààZn
‚àÉr |kr‚àíjr|‚â§1}
4
Œîj( f),Œîk(g)
5
‚â§

Rn ‚àë
j‚ààZn
‚àë
k=(k1,...,kn)‚ààZn
‚àÉr |kr‚àíjr|‚â§1}
Œîj( f)
Œîk(g)
dx
‚â§3n

Rn

‚àë
j‚ààZn
Œîj( f)
2 1
2 
‚àë
k‚ààZn
Œîk(g)
2 1
2 dx

6.1 Littlewood‚ÄìPaley Theory
431
‚â§3n

‚àë
j‚ààZn
Œîj( f)
2 1
2 
Lp


‚àë
k‚ààZn
Œîk(g)
2 1
2 
Lp‚Ä≤
‚â§C‚àí1
n max

p‚Ä≤,(p‚Ä≤ ‚àí1)‚àí1ng

Lp‚Ä≤


‚àë
j‚ààZn
Œîj( f)
2 1
2 
Lp ,
where we used the fact that Œîj( f) and Œîk(g) are orthogonal operators unless every
coordinate of k is within 1 unit of the corresponding coordinate of j; this is an easy
consequence of the support properties of 1œà. We now take the supremum over all g
in Lp‚Ä≤ with norm at most 1, to obtain (6.1.31) for Schwartz functions f.
To extend this estimate to general Lp functions f, we use the density argument
described in the last paragraph in the proof of Theorem 6.1.6.
‚ñ°
6.1.4 Lack of Orthogonality on Lp
We discuss two examples indicating why (6.1.1) cannot hold if the exponent 2 is
replaced by some other exponent q Ã∏= 2. More precisely, we show that if the functions
f j have Fourier transforms supported in disjoint sets, then the inequality
‚àë
j
f j

p
Lp ‚â§Cp‚àë
j
f j
p
Lp
(6.1.32)
cannot hold if p > 2, and similarly, the inequality
‚àë
j
f j
p
Lp ‚â§Cp
‚àë
j
f j

p
Lp
(6.1.33)
cannot hold if p < 2. In both (6.1.32) and (6.1.33) the constants Cp are supposed to
be independent of the functions f j.
Example 6.1.8. Pick a Schwartz function Œ∂ whose Fourier transform is positive and
supported in the interval |Œæ| ‚â§1/4. Let N be a large integer and let
f j(x) = e2œÄi jxŒ∂(x).
Then
1f j(Œæ) = 1Œ∂(Œæ ‚àíj)
and the 1f j‚Äôs have disjoint Fourier transforms. We obviously have
N
‚àë
j=0
 f j
p
Lp = (N +1)
Œ∂
p
Lp.

432
6 Littlewood‚ÄìPaley Theory and Multipliers
On the other hand, we have the estimate

N
‚àë
j=0
f j

p
Lp =

R
 e2œÄi(N+1)x‚àí1
e2œÄix‚àí1
p|Œ∂(x)|p dx
‚â•c

|x|< 1
10 (N+1)‚àí1
(N+1)p|x|p
|x|p
|Œ∂(x)|p dx
= CŒ∂(N +1)p‚àí1 ,
since Œ∂ does not vanish in a neighborhood of zero. We conclude that (6.1.32) cannot
hold for this choice of f j‚Äôs for p > 2.
Example 6.1.9. We now indicate why (6.1.33) cannot hold for p < 2. We pick a
smooth function Œ® on the line whose Fourier transform 1
Œ® is supported in
 7
8, 17
8

,
is nonnegative, is equal to 1 on
 9
8, 15
8

, and satisÔ¨Åes
‚àë
j‚ààZ
1
Œ®(2‚àíjŒæ)2 = 1,
Œæ > 0.
Extend 1
Œ® to be an even function on the whole line and let Œî j be the Littlewood‚Äì
Paley operator associated with Œ®. Also pick a nonzero Schwartz function œï on the
real line whose Fourier transform is nonnegative and supported in the set
 11
8 , 13
8

.
Fix N a large positive integer and let
f j(x) = e2œÄi 12
8 2 jxœï(x),
(6.1.34)
for j = 1,2,...,N. Then the function 1f j(Œæ) = 1œï(Œæ ‚àí12
8 2j) is supported in the set
 11
8 + 12
8 2j, 13
8 + 12
8 2j
, which is contained in
 9
82j, 15
8 2j
for j ‚â•3. In other words,
1
Œ®(2‚àíjŒæ) is equal to 1 on the support of 1f j. This implies that
Œî j( f j) = f j
for
j ‚â•3.
This observation combined with (6.1.21) gives for N ‚â•3,

N
‚àë
j=3
f j

Lp =

N
‚àë
j=3
Œî j( f j)

Lp ‚â§Cp

 N
‚àë
j=3
| f j|21
2 
Lp = Cp
œï

Lp(N ‚àí2)
1
2 ,
where 1 < p < ‚àû. On the other hand, (6.1.34) trivially yields that
 N
‚àë
j=3
f j
p
Lp
 1
p =
œï

Lp(N ‚àí2)
1
p .
Letting N ‚Üí‚àûwe see that (6.1.33) cannot hold for p < 2 even when the f j‚Äôs have
Fourier transforms supported in disjoint sets.

6.1 Littlewood‚ÄìPaley Theory
433
Example 6.1.10. A similar idea illustrates the necessity of the ‚Ñì2 norm in (6.1.4). To
see this, let Œ® and Œî j be as in Example 6.1.9. Let us Ô¨Åx 1 < p < ‚àûand q < 2. We
show that the inequality


‚àë
j‚ààZ
|Œî j( f)|q1
q 
Lp ‚â§Cp,q
 f

Lp
(6.1.35)
cannot hold. Take f = ‚àëN
j=3 f j, where the f j are as in (6.1.34) and N ‚â•3. Then
the left-hand side of (6.1.35) is bounded from below by ‚à•œï‚à•Lp(N ‚àí2)1/q, while the
right-hand side is bounded above by ‚à•œï‚à•Lp(N ‚àí2)1/2. Letting N ‚Üí‚àû, we deduce
that (6.1.35) is impossible when q < 2.
Example 6.1.11. For 1 < p < ‚àûand 2 < q < ‚àû, the inequality
g

Lp ‚â§Cp,q


‚àë
j‚ààZ
|Œî j(g)|q1
q 
Lp
(6.1.36)
cannot hold even under assumption (6.1.6) on Œ®. Let Œî j be as in Example 6.1.9.
Let us suppose that (6.1.36) did hold for some q > 2 for these Œî j‚Äôs. Then the self-
adjointness of the Œî j‚Äôs and duality would give


‚àë
k‚ààZ
|Œîk(g)|q‚Ä≤ 1
q‚Ä≤ 
Lp‚Ä≤
=
sup
‚à•{hk}k‚à•‚Ñìq

Lp‚â§1


R ‚àë
k‚ààZ
Œîk(g)hk dx

‚â§
g

Lp‚Ä≤
sup
‚à•{hk}k‚à•‚Ñìq

Lp‚â§1
 ‚àë
k‚ààZ
Œîk(hk)

Lp
‚â§C
g

Lp‚Ä≤
sup
‚à•{hk}k‚à•‚Ñìq

Lp‚â§1


‚àë
j‚ààZ
Œî j

‚àë
k‚ààZ
Œîk(hk)

q1
q 
Lp
by (6.1.36)
‚â§C‚Ä≤g

Lp‚Ä≤
sup
‚à•{hk}k‚à•‚Ñìq

Lp‚â§1
$
1
‚àë
l=‚àí1


‚àë
j‚ààZ
|Œî jŒî j+l(hj)|q1
q 
Lp
%
‚â§C‚Ä≤‚Ä≤g

Lp‚Ä≤
sup
‚à•{hk}k‚à•‚Ñìq

Lp‚â§1


‚àë
j‚ààZ
|hj|q1
q 
Lp = C‚Ä≤‚Ä≤g

Lp‚Ä≤ ,
where the next-to-last inequality follows from (6.1.22) applied twice, while the one
before that follows from support considerations. But since q‚Ä≤ < 2, this exactly proves
(6.1.35), previously shown to be false, a contradiction.
We conclude that if both assertions (6.1.4) and (6.1.8) of Theorem 6.1.2 were to
hold, then the ‚Ñì2 norm inside the Lp norm could not be replaced by an ‚Ñìq norm for
some q Ã∏= 2. Exercise 6.1.6 indicates the crucial use of the fact that ‚Ñì2 is a Hilbert
space in the converse inequality (6.1.8) of Theorem 6.1.2.

434
6 Littlewood‚ÄìPaley Theory and Multipliers
Exercises
6.1.1. Construct a Schwartz function Œ® that satisÔ¨Åes ‚àëj‚ààZ | 1
Œ®(2‚àíjŒæ)|2 = 1 for all
Œæ ‚ààRn \{0} and whose Fourier transform is supported in the annulus 6
7 ‚â§|Œæ| ‚â§2
and is equal to 1 on the annulus 1 ‚â§|Œæ| ‚â§14
7 .

Hint: Set 1
Œ®(Œæ) = Œ∑(Œæ)

‚àëk‚ààZ |Œ∑(2‚àíkŒæ)|2‚àí1/2 for a suitable Œ∑ ‚ààC ‚àû
0 (Rn) .

6.1.2. Suppose that Œ® is an integrable function on Rn that satisÔ¨Åes | 1
Œ®(Œæ)| ‚â§
B min(|Œæ|Œµ,|Œæ|‚àíŒµ‚Ä≤) for some Œµ‚Ä≤,Œµ > 0. Show that for some constant CŒµ,Œµ‚Ä≤ < ‚àûwe
have
sup
Œæ‚ààRn
 ‚àû
0 | 1
Œ®(tŒæ)|2 dt
t
 1
2
+ sup
Œæ‚ààRn

‚àë
j‚ààZ
| 1
Œ®(2‚àíjŒæ)|2 1
2 ‚â§CŒµ,Œµ‚Ä≤ B.
6.1.3. Let Œ® be an integrable function on Rn with mean value zero that satisÔ¨Åes
|Œ®(x)| ‚â§B(1+|x|)‚àín‚àíŒµ,

Rn |Œ®(x‚àíy)‚àíŒ®(x)|dx ‚â§B|y|Œµ‚Ä≤,
for some B,Œµ‚Ä≤,Œµ > 0 and for all y Ã∏= 0.
(a) Prove that | 1
Œ®(Œæ)| ‚â§cn,Œµ,Œµ‚Ä≤ B min(|Œæ|min( Œµ
2 ,1),|Œæ|‚àíŒµ) for some constant cn,Œµ,Œµ‚Ä≤ and
conclude that (6.1.4) holds for p = 2.
(b) Deduce the validity of (6.1.4) and (6.1.5).
(c) If Œµ < 1 and the assumption |Œ®(x)| ‚â§B(1 + |x|)‚àín‚àíŒµ is weakened to |Œ®(x)| ‚â§
B|x|‚àín‚àíŒµ for all x ‚ààRn, then show that | 1
Œ®(Œæ)| ‚â§cn,Œµ,Œµ‚Ä≤ B min(|Œæ|
Œµ
2 ,|Œæ|‚àíŒµ) and thus
(6.1.4) and (6.1.5) are valid.

Hint: Part (a): Make use of the identity
1
Œ®(Œæ) =

Rn e‚àí2œÄix¬∑ŒæŒ®(x)dx = ‚àí

Rn e‚àí2œÄix¬∑ŒæŒ®(x‚àíy)dx,
where y = 1
2
Œæ
|Œæ|2 when |Œæ| ‚â•1. For |Œæ| ‚â§1 use the mean value property ofŒ® to write
1
Œ®(Œæ) =

|x|‚â§1Œ®(x)(e‚àí2œÄix¬∑Œæ ‚àí1)dx and split the integral in the regions |x| ‚â§1 and
|x| ‚â•1. Part (b): If ‚ÉóK is deÔ¨Åned by (6.1.13), then control the ‚Ñì2(Z) norm by the ‚Ñì1(Z)
norm to prove (6.1.16). Then split the sum ‚àëj‚ààZ

|x|‚â•2|y|
Œ®2‚àíj(x ‚àíy) ‚àíŒ®2‚àíj(x)
dx
into the parts ‚àë2 j‚â§|y|‚àí1 and ‚àë2 j>|y|‚àí1. Part (c): Notice that when Œµ < 1, we have
|

|x|‚â§1Œ®(x)(e‚àí2œÄix¬∑Œæ ‚àí1)dx| ‚â§Cn B|Œæ|
Œµ
2 .

6.1.4. Let Œ® be an integrable function on Rn with mean value zero that satisÔ¨Åes
|Œ®(x)| ‚â§B(1+|x|)‚àín‚àíŒµ,

Rn |Œ®(x‚àíy)‚àíŒ®(x)|dx ‚â§B|y|Œµ‚Ä≤,

6.1 Littlewood‚ÄìPaley Theory
435
for some B,Œµ‚Ä≤,Œµ > 0 and for all y Ã∏= 0. Let Œ®t(x) = t‚àínŒ®(x/t). (a) Prove that there
are constants cn,c‚Ä≤
n such that
 ‚àû
0 |Œ®t(x)|2 dt
t dx
 1
2
‚â§cn B|x|‚àín ,
sup
y‚ààRn\{0}

|x|‚â•2|y|
 ‚àû
0 |Œ®t(x‚àíy)‚àíŒ®t(x)|2 dt
t
 1
2
dx ‚â§c‚Ä≤
n B.
(b) Show that there exist constants Cn,C‚Ä≤
n such that for all 1 < p < ‚àûand for all
f ‚ààLp(Rn) we have

 ‚àû
0 | f ‚àóŒ®t|2 dt
t
1
2 
Lp(Rn) ‚â§CnBmax(p,(p‚àí1)‚àí1)
f

Lp(Rn)
and also for all f ‚ààL1(Rn) we have

 ‚àû
0 | f ‚àóŒ®t|2 dt
t
1
2 
L1,‚àû(Rn) ‚â§C‚Ä≤
nB
 f

L1(Rn) .
(c) Under the additional hypothesis that 0 <
 ‚àû
0 | 1
Œ®(tŒæ)|2 dt
t = c0 for all Œæ ‚ààRn \{0},
prove that for all f ‚ààLp(Rn) we have
f

Lp(Rn) ‚â§C‚Ä≤‚Ä≤
n B max(p,(p‚àí1)‚àí1)

 ‚àû
0 | f ‚àóŒ®t|2 dt
t
1
2 
Lp(Rn)

Hint: Part (a): Use the Cauchy-Schwarz inequality to obtain

|x|‚â•2|y|
 ‚àû
0 |Œ®t(x‚àíy)‚àíŒ®t(x)|2 dt
t
 1
2
dx
‚â§cn|y|‚àíŒµ
2

|x|‚â•2|y| |x|n+Œµ
 ‚àû
0 |Œ®t(x‚àíy)‚àíŒ®t(x)|2 dt
t dx
 1
2
,
and split the integral on the right into the regions t ‚â§|y| and t > |y|. In the second
region use that Œ® is bounded to replace the square by the Ô¨Årst power. Part (b): Use
Exercise 6.1.2 and part (a) of Exercise 6.1.3 and to deduce the inequality when p = 2.
Then apply Theorem 5.6.1. Part (c): Prove the inequality Ô¨Årst for f ‚ààS (Rn) using
duality.

6.1.5. Prove the following generalization of Theorem 6.1.2. Let A > 0. Suppose that
{Kj}j‚ààZ is a sequence of locally integrable functions on Rn \{0} that satisÔ¨Åes
sup
xÃ∏=0
|x|n
‚àë
j‚ààZ
|Kj(x)|2 1
2 ‚â§A ,
sup
y‚ààRn\{0}

|x|‚â•2|y|

‚àë
j‚ààZ
|Kj(x‚àíy)‚àíKj(x)|21
2 dx ‚â§A < ‚àû,

436
6 Littlewood‚ÄìPaley Theory and Multipliers
and for each j ‚ààZ there is a number Lj such that
lim
Œµk‚Üì0

Œµk‚â§|y|‚â§1 Kj(y)dy = Lj .
If the Kj coincide with tempered distributions Wj that satisfy
‚àë
j‚ààZ
|2
Wj(Œæ)|2 ‚â§B2 ,
then the operator
f ‚Üí

‚àë
j‚ààZ
|Kj ‚àóf|21
2
maps Lp(Rn) to itself and is weak type (1,1) norms at most multiples of A+B.
6.1.6. Suppose that H is a Hilbert space with inner product ‚ü®¬∑, ¬∑‚ü©H . Let A > 0 and
1 < p < ‚àû. Suppose that an operator T from L2(Rn) ‚ÜíL2(Rn,H ) is a multiple of
an isometry, that is,
T(g)

L2(Rn,H ) = A
g

L2(Rn)
for all g ‚ààL2(Rn,H ). Then the inequality ‚à•T( f)‚à•Lp(Rn,H ) ‚â§Cp‚à•f‚à•Lp(Rn) for all
f ‚ààS (Rn) implies
f

Lp‚Ä≤(Rn) ‚â§Cp‚Ä≤A‚àí2T( f)

Lp‚Ä≤(Rn,H )
for all in f ‚ààS (Rn).

Hint: Use the inner product structure and polarization to obtain
A2


Rn f(x)g(x)dx
 =


Rn
>
T( f)(x),T(g)(x)
?
H dx

and then argue as in the proof of inequality (6.1.8).

6.1.7. Suppose that {mj}j‚ààZ is a sequence of bounded functions supported in the
intervals [2j,2j+1]. Let Tj( f) = ( 1f mj)‚à®be the corresponding multiplier operators.
Assume that for all sequences of functions {f j}j the vector-valued inequality


‚àë
j
|Tj( f j)|21
2 
Lp ‚â§Ap


‚àë
j
| f j|21
2 
Lp
is valid for some 1 < p < ‚àû. Prove there is a Cp > 0 such that for all Ô¨Ånite subsets S
of Z we have
‚àë
j‚ààS
mj

Mp ‚â§Cp Ap.

Hint: Use that
4
‚àëj‚ààS Tj( f),g
5
= ‚àëj‚ààS
4
Œî #
j Tj( f),Œî #
j (g)
5
.


6.2 Two Multiplier Theorems
437
6.1.8. Let m be a bounded function on Rn that is supported in the annulus
1 ‚â§|Œæ| ‚â§2 and deÔ¨Åne Tj( f) =
 1f(Œæ)m(2‚àíjŒæ)
‚à®. Suppose that the square func-
tion f ‚Üí

‚àëj‚ààZ |Tj( f)|21/2 is bounded on Lp(Rn) for some 1 < p < ‚àû. Show that
for every Ô¨Ånite subset S of the integers we have
‚àë
j‚ààS
Tj( f)

Lp(Rn) ‚â§Cp,n
 f

Lp(Rn)
for some constant Cp,n independent of S.
6.1.9. Fix a nonzero Schwartz function h on the line whose Fourier transform is
supported in the interval

‚àí1
8, 1
8

. For {aj} a sequence of numbers, set
f(x) =
‚àû
‚àë
j=1
aje2œÄi2 jxh(x).
Prove that for all 1 < p < ‚àûthere exists a constant Cp such that
‚à•f‚à•Lp(R) ‚â§Cp
‚àë
j
|aj|2 1
2 ‚à•h‚à•Lp .

Hint: Write f = ‚àë‚àû
j=1 Œî j(aje2œÄi2 j(¬∑)h), where Œî j is given by convolution with œï2‚àíj
for some œï whose Fourier transform is supported in the interval
 6
8, 10
8

and is equal
to 1 on
 7
8, 9
8

. Then use (6.1.21).

6.1.10. Let Œ® be a Schwartz function whose Fourier transform is supported in the
annulus 1
2 ‚â§|Œæ| ‚â§2 and that satisÔ¨Åes (6.1.7). DeÔ¨Åne a Schwartz function Œ¶ by
setting
1Œ¶(Œæ) =

‚àëj‚â§0 1
Œ®(2‚àíjŒæ)
when Œæ Ã∏= 0,
1
when Œæ = 0.
Let S0 be the operator given by convolution with Œ¶. Let 1 < p < ‚àûand f ‚ààLp(Rn).
Show that
f

Lp ‚âà
S0( f)

Lp +

 ‚àû
‚àë
j=1
|Œî j( f)|2 1
2 
Lp .

Hint: Use Theorem 6.1.2 together with the identity S0 +‚àë‚àû
j=1 Œî j = I.

6.2 Two Multiplier Theorems
We now return to the spaces Mp introduced in Section 2.5. We seek sufÔ¨Åcient con-
ditions on L‚àûfunctions deÔ¨Åned on Rn to be elements of Mp. In this section we are
concerned with two fundamental theorems that provide such sufÔ¨Åcient conditions.

438
6 Littlewood‚ÄìPaley Theory and Multipliers
These are the Marcinkiewicz and the H¬®ormander‚ÄìMihlin multiplier theorems. Both
multiplier theorems are consequences of the Littlewood‚ÄìPaley theory discussed in
the previous section.
Using the dyadic decomposition of Rn, we can write any L‚àûfunction m as the
sum
m = ‚àë
j‚ààZn
mœáRj
a.e.,
where j = ( j1,..., jn), Rj = Ij1 √ó¬∑¬∑¬∑√óIjn, and Ik = [2k,2k+1)(‚àí2k+1,‚àí2k]. For j
in Zn we set mj = mœáRj. A consequence of the ideas developed so far is the following
characterization of Mp(Rn) in terms of a vector-valued inequality.
Proposition 6.2.1. Let m ‚ààL‚àû(Rn) and let mj = mœáRj. Then m lies in Mp(Rn), that
is, for some cp we have
( 1fm)‚à®
Lp ‚â§cp
f

Lp ,
f ‚ààLp(Rn),
if and only if for some Cp > 0 we have


‚àë
j‚ààZn
|(1fjmj)‚à®|21
2 
Lp ‚â§Cp


‚àë
j‚ààZn
| fj|21
2 
Lp
(6.2.1)
for all sequences of functions fj in Lp(Rn).
Proof. Suppose that m ‚ààMp(Rn). Exercise 5.6.1 gives the Ô¨Årst inequality below


‚àë
j‚ààZn
|(œáRjm1fj)‚à®|21
2 
Lp ‚â§Cp


‚àë
j‚ààZn
|(m1fj)‚à®|21
2 
Lp ‚â§Cp


‚àë
j‚ààZn
| fj|21
2 
Lp ,
while the second inequality follows from Theorem 5.5.1. (Observe that when p = q
in Theorem 5.5.1, then Cp,q = 1.) Conversely, suppose that (6.2.1) holds for all se-
quences of functions fj. Fix a function f and apply (6.2.1) to the sequence ( 1f œáRj)‚à®,
where Rj is the dyadic rectangle indexed by j = ( j1,..., jn) ‚ààZn. We obtain


‚àë
j‚ààZn
|( 1f mœáRj)‚à®|21
2 
Lp ‚â§Cp


‚àë
j‚ààZn
|( 1f œáRj)‚à®|21
2 
Lp.
Using Theorem 6.1.6, we obtain that the previous inequality is equivalent to the
inequality
( 1f m)‚à®
Lp ‚â§cp
f

Lp ,
which implies that m ‚ààMp(Rn).
‚ñ°

6.2 Two Multiplier Theorems
439
6.2.1 The Marcinkiewicz Multiplier Theorem on R
Proposition 6.2.1 suggests that the behavior of m on each dyadic rectangle Rj should
play a crucial role in determining whether m is an Lp multiplier. The Marcinkiewicz
multiplier theorem provides such sufÔ¨Åcient conditions on m restricted to any dyadic
rectangle Rj. Before stating this theorem, we illustrate its main idea via the follow-
ing example. Suppose that m is a bounded function that vanishes near ‚àí‚àû, that is
differentiable at every point, and whose derivative is integrable. Then we may write
m(Œæ) =
 Œæ
‚àí‚àûm‚Ä≤(t)dt =
 +‚àû
‚àí‚àûœá[t,‚àû)(Œæ)m‚Ä≤(t)dt ,
from which it follows that for a Schwartz function f we have
( 1fm)‚à®=

R( 1f œá[t,‚àû))‚à®m‚Ä≤(t)dt.
Since the operators f ‚Üí( 1f œá[t,‚àû))‚à®map Lp(R) to itself independently of t, it follows
that
( 1fm)‚à®
Lp ‚â§Cp
m‚Ä≤
L1
f

Lp ,
thus yielding that m is in Mp(R). The next multiplier theorem is an improvement
of this result and is based on the Littlewood‚ÄìPaley theorem. We begin with the one-
dimensional case, which already captures the main ideas.
Theorem 6.2.2. (Marcinkiewicz multiplier theorem) Let m : R ‚ÜíR be a bounded
function that is C 1 in every dyadic set (2j,2j+1)(‚àí2j+1,‚àí2j) for j ‚ààZ. Assume
that the derivative m‚Ä≤ of m satisÔ¨Åes
sup
j
 ‚àí2 j
‚àí2 j+1 |m‚Ä≤(Œæ)|dŒæ +
 2 j+1
2 j
|m‚Ä≤(Œæ)|dŒæ

‚â§A < ‚àû.
(6.2.2)
Then for all 1 < p < ‚àûwe have that m ‚ààMp(R) and for some C > 0 we have
m

Mp(R) ‚â§Cmax

p,(p‚àí1)‚àí16m

L‚àû+A

.
(6.2.3)
Proof. Since the function m has an integrable derivative on (2j,2j+1), it has
bounded variation in this interval and hence it is a difference of two increasing
functions. Therefore, m has left and right limits at the points 2j and 2j+1, and by
redeÔ¨Åning m at these points we may assume that m is right continuous at the points
2j and left continuous at the points ‚àí2j.
Set Ij = [2j,2j+1) ‚à™(‚àí2j+1,‚àí2j] and I+
j = [2j,2j+1) whenever j ‚ààZ. Given
an interval I in R, we introduce an operator ŒîI deÔ¨Åned by ŒîI( f) = ( 1f œáI)‚à®. With
this notation ŒîI+
j ( f) is ‚Äúhalf‚Äù of the operator Œî #
j introduced in the previous section.
Given m as in the statement of the theorem, we write m(Œæ) = m+(Œæ) + m‚àí(Œæ),
where m+(Œæ) = m(Œæ)œáŒæ‚â•0 and m‚àí(Œæ) = m(Œæ)œáŒæ<0. We show that both m+ and m‚àí

440
6 Littlewood‚ÄìPaley Theory and Multipliers
are Lp multipliers. Since m‚Ä≤ is integrable over all intervals of the form [2j,Œæ] when
2j ‚â§Œæ < 2j+1, the fundamental theorem of calculus gives
m(Œæ) = m(2j)+
 Œæ
2 j m‚Ä≤(t)dt,
for 2j ‚â§Œæ < 2j+1,
from which it follows that for a Schwartz function f on the real line we have
m(Œæ) 1f(Œæ)œáI+
j (Œæ) = m(2j) 1f(Œæ)œáI+
j (Œæ)+
 2 j+1
2 j
1f(Œæ)œá[t,‚àû)(Œæ)œáI+
j (Œæ)m‚Ä≤(t)dt .
We therefore obtain the identity
( 1f œáIjm+)‚à®= ( 1fmœáI+
j )‚à®= m(2j)ŒîI+
j ( f)+
 2 j+1
2 j
Œî[t,‚àû)ŒîI+
j ( f)m‚Ä≤(t)dt ,
which implies that
|( 1f œáIjm+)‚à®| ‚â§‚à•m‚à•L‚àû|ŒîI+
j ( f)|+A
1
2
 2 j+1
2 j
Œî[t,‚àû)ŒîI+
j ( f)
2 |m‚Ä≤(t)|dt
1
2
,
using the hypothesis (6.2.2). Taking ‚Ñì2(Z) norms we obtain

‚àë
j‚ààZ
|( 1f œáIjm+)‚à®|21
2 ‚â§‚à•m‚à•L‚àû

‚àë
j‚ààZ
|ŒîI+
j ( f)|21
2
+A
1
2
 ‚àû
0
Œî[t,‚àû)Œî #
[log2 t]( f)
2 |m‚Ä≤(t)|dt
1
2
.
Exercise 5.6.2 gives
A
1
2

 ‚àû
0
Œî[t,‚àû)Œî #
[log2 t]( f)
2|m‚Ä≤(t)|dt
1
2 
Lp
‚â§Cmax(p,(p‚àí1)‚àí1)A
1
2

 ‚àû
0
Œî #
[log2 t]( f)
2|m‚Ä≤(t)|dt
1
2 
Lp ,
while the hypothesis on m‚Ä≤ implies the inequality


‚àë
j‚ààZ
ŒîI+
j ( f)
2 
I+
j
|m‚Ä≤(t)|dt
1
2 
Lp ‚â§A
1
2


‚àë
j
|ŒîI+
j ( f)|21
2 
Lp .
Using Theorem 6.1.5 we obtain that


‚àë
j
|ŒîI+
j ( f)|21
2 
Lp ‚â§C‚Ä≤ max(p,(p‚àí1)‚àí1)2 1f œá(0,‚àû)
‚à®
Lp ,

6.2 Two Multiplier Theorems
441
and the latter is at most a constant multiple of max(p,(p ‚àí1)‚àí1)3f

Lp. Putting
things together we deduce that


‚àë
j
|( 1f œáIjm+)‚à®|21
2 
Lp ‚â§C‚Ä≤‚Ä≤ max(p,(p‚àí1)‚àí1)4
A+‚à•m‚à•L‚àû f

Lp ,
(6.2.4)
from which we obtain the estimate
( 1fm+)‚à®
Lp ‚â§Cmax(p,(p‚àí1)‚àí1)6
A+‚à•m‚à•L‚àû f

Lp ,
using the lower estimate of Theorem 6.1.5. This proves (6.2.3) for m+. A similar
argument also works for m‚àí, and this concludes the proof by summing the corre-
sponding estimates for m+ and m‚àí.
‚ñ°
We remark that the same proof applies under the more general assumption that
m is a function of bounded variation on every interval [2j,2j+1] and [‚àí2j+1,‚àí2j].
In this case the measure |m‚Ä≤(t)|dt should be replaced by the total variation |dm(t)|
of the Lebesgue‚ÄìStieltjes measure dm(t).
Example 6.2.3. Any bounded function that is constant on dyadic intervals is an Lp
multiplier. Also, the function
m(Œæ) = |Œæ|2‚àí[log2 |Œæ|]
is an Lp multiplier on R for 1 < p < ‚àû.
6.2.2 The Marcinkiewicz Multiplier Theorem on Rn
We now extend this theorem on Rn. As usual we denote the coordinates of a point
Œæ ‚ààRn by (Œæ1,...,Œæn). We recall the notation Ij = (‚àí2j+1,‚àí2j][2j,2j+1) and
Rj = Ij1 √ó¬∑¬∑¬∑√óIjn whenever j = ( j1,..., jn) ‚ààZn.
Theorem 6.2.4. Let m be a bounded function on Rn such that for all Œ± = (Œ±1,...,Œ±n)
with |Œ±1|,...,|Œ±n| ‚â§1 the derivatives ‚àÇŒ±m are continuous up to the boundary of Rj
for all j ‚ààZn. Assume that there is a constant A < ‚àûsuch that for all partitions
{s1,...,sk}‚à™{r1,...,r‚Ñì} = {1,2,...,n} with n = k +‚Ñìand all Œæ ‚ààRj we have
sup
Œær1‚ààIjr1
¬∑¬∑¬∑ sup
Œær‚Ñì‚ààIjr‚Ñì

Ijs1
¬∑¬∑¬∑

Ijsk
(‚àÇs1 ¬∑¬∑¬∑‚àÇskm)(Œæ1,...,Œæn)
dŒæsk ¬∑¬∑¬∑dŒæs1 ‚â§A
(6.2.5)
for all j = ( j1,..., jn) ‚ààZn. Then m is in Mp(Rn) whenever 1 < p < ‚àûand there is
a constant Cn < ‚àûsuch that
‚à•m‚à•Mp(Rn) ‚â§Cn

A+‚à•m‚à•L‚àû
max

p,(p‚àí1)‚àí16n.
(6.2.6)

442
6 Littlewood‚ÄìPaley Theory and Multipliers
Proof. We prove this theorem only in dimension n = 2, since the general case
presents no substantial differences but only some notational inconvenience. We de-
compose the given function m as
m(Œæ) = m++(Œæ)+m‚àí+(Œæ)+m+‚àí(Œæ)+m‚àí‚àí(Œæ),
where each of the last four terms is supported in one of the four quadrants. For
instance, the function m+‚àí(Œæ1,Œæ2) is supported in the quadrant Œæ1 ‚â•0 and Œæ2 < 0.
As in the one-dimensional case, we work with each of these pieces separately. By
symmetry we choose to work with m++ in the following argument.
Using the fundamental theorem of calculus, we obtain the following simple iden-
tity, valid for 2j1 ‚â§Œæ1 < 2j1+1 and 2j2 ‚â§Œæ2 < 2j2+1:
m(Œæ1,Œæ2) = m(2j1,2j2)+
 Œæ1
2 j1 (‚àÇ1m)(t1,2j2)dt1
+
 Œæ2
2 j2 (‚àÇ2m)(2j1,t2)dt2
+
 Œæ1
2 j1
 Œæ2
2 j2 (‚àÇ1‚àÇ2m)(t1,t2)dt2 dt1 .
(6.2.7)
We introduce operators Œî (r)
I , r ‚àà{1,2}, acting in the rth variable (with the other
variable remaining Ô¨Åxed) given by multiplication on the Fourier transform side by
the characteristic function of the interval I. Likewise, we introduce operators Œî #(r)
j
,
r ‚àà{1,2} (also acting in the rth variable), given by multiplication on the Fourier
transform side by the characteristic function of the set (‚àí2j+1,‚àí2j][2j,2j+1). For
notational convenience, for a given Schwartz function f we write
f++ =
 1f œá(0,‚àû)2
‚à®,
and likewise we deÔ¨Åne f+‚àí, f‚àí+, and f‚àí‚àí.
Multiplying both sides of (6.2.7) by the function 1f œáRjœá(0,‚àû)2 and taking inverse
Fourier transforms yields
( 1f œáRjm++)‚à®= m(2j1,2j2)Œî #(1)
j1
Œî #(2)
j2
( f++)
+
 2 j1+1
2 j1
Œî #(2)
j2
Œî (1)
[t1,‚àû)Œî #(1)
j1
( f++)(‚àÇ1m)(t1,2j2)dt1
+
 2 j2+1
2 j2
Œî #(1)
j1
Œî (2)
[t2,‚àû)Œî #(2)
j2
( f++)(‚àÇ2m)(2j1,t2)dt2
+
 2 j1+1
2 j1
 2 j2+1
2 j2
Œî (1)
[t1,‚àû)Œî #(1)
j1
Œî (2)
[t2,‚àû)Œî #(2)
j2
( f++)(‚àÇ1‚àÇ2m)(t1,t2)dt2 dt1 .
(6.2.8)
We apply the Cauchy‚ÄìSchwarz inequality in the last three terms of (6.2.8) with re-
spect to the measures |(‚àÇ1m)(t1,2j2)|dt1, |(‚àÇ2m)(2j1,t2)|dt2, |(‚àÇ1‚àÇ2m)(t1,t2)|dt2dt1
and we use hypothesis (6.2.5) to deduce

6.2 Two Multiplier Theorems
443
( 1f œáRjm++)‚à® ‚â§‚à•m‚à•L‚àûŒî #(1)
j1
Œî #(2)
j2
( f++)

+ A
1
2
 2 j1+1
2 j1
Œî #(2)
j2
Œî (1)
[t1,‚àû)Œî #(1)
j1
( f++)
2 |(‚àÇ1m)(t1,2j2)|dt1
 1
2
+ A
1
2
 2 j2+1
2 j2
Œî #(1)
j1
Œî (2)
[t2,‚àû)Œî #(2)
j2
( f++)
2 |(‚àÇ2m)(2j1,t2)|dt2
 1
2
+ A
1
2
 2 j1+1
2 j1
 2 j2+1
2 j2
Œî (1)
[t1,‚àû)Œî #(1)
j1
Œî (2)
[t2,‚àû)Œî #(2)
j2
( f++)
2 |(‚àÇ1‚àÇ2m)(t1,t2)|dt2 dt1
 1
2
.
Both sides of the preceding inequality are sequences indexed by j ‚ààZ2. We apply
‚Ñì2(Z2) norms and use Minkowski‚Äôs inequality to deduce the pointwise estimate

‚àë
j‚ààZ2
( 1f œáRjm++)‚à®21
2 ‚â§‚à•m‚à•L‚àû

‚àë
j‚ààZ2
Œî #
j ( f++)
21
2
+A
1
2
 ‚àû
0
 ‚àû
0
Œî (1)
[t1,‚àû)Œî #(2)
[log2 t2]Œî #(1)
[log2 t1]( f++)
2 (‚àÇ1m)(t1,2[log2 t2])
dt1dŒΩ(t2)
1
2
+A
1
2
 ‚àû
0
 ‚àû
0
Œî (2)
[t2,‚àû)Œî #(1)
[log2 t1]Œî #(2)
[log2 t2]( f++)
2 (‚àÇ2m)(2[log2 t1],t2)
dŒΩ(t1)dt2
1
2
+A
1
2
 ‚àû
0
 ‚àû
0
Œî (1)
[t1,‚àû)Œî (2)
[t2,‚àû)Œî #(1)
[log2 t1]Œî #(2)
[log2 t2]( f++)
2(‚àÇ1‚àÇ2m)(t1,t2)
dt1dt2
1
2
,
where ŒΩ is the counting measure ‚àëj‚ààZ Œ¥2 j deÔ¨Åned by ŒΩ(A) = #{j ‚ààZ : 2j ‚ààA}
for subsets A of (0,‚àû). We now take Lp(R2) norms and we estimate separately the
contribution of each of the four terms on the right side. Using Exercise 5.6.2 we
obtain


‚àë
j‚ààZ2
( 1f œáRjm++)‚à®21
2

Lp ‚â§‚à•m‚à•L‚àû


‚àë
j‚ààZ2
Œî #
j ( f++)
21
2

Lp
+ C2 A
1
2 max

p,(p‚àí1)‚àí12
√ó

 ‚àû
0
 ‚àû
0
Œî #(2)
[log2 t2]Œî #(1)
[log2 t1]( f++)
2 (‚àÇ1m)(t1,2[log2 t2])
dt1 dŒΩ(t2)
1
2 
Lp
+

 ‚àû
0
 ‚àû
0
Œî #(1)
[log2 t1]Œî #(2)
[log2 t2]( f++)
2 (‚àÇ2m)(2[log2 t1],t2)
dŒΩ(t1)dt2
1
2 
Lp
+

 ‚àû
0
 ‚àû
0
Œî #(1)
[log2 t1]Œî #(2)
[log2 t2]( f++)
2(‚àÇ1‚àÇ2m)(t1,t2)
dt1dt2
1
2 
Lp
+
.

444
6 Littlewood‚ÄìPaley Theory and Multipliers
But the functions (t1,t2) ‚ÜíŒî #(1)
[log2 t1]Œî #(2)
[log2 t2]( f++) are constant on products of inter-
vals of the form [2j1,2j1+1) √ó [2j2,2j2+1); hence using hypothesis (6.2.5) again we
deduce the estimate


‚àë
j‚ààZ2
( 1f œáRjm++)‚à®21
2

Lp(R2)
‚â§C2

‚à•m‚à•L‚àû+A

max

p,(p‚àí1)‚àí12


‚àë
j‚ààZ2
Œî #
j ( f++)
21
2

Lp(R2)
‚â§C2

‚à•m‚à•L‚àû+A

max

p,(p‚àí1)‚àí16( 1f œá(0,‚àû)2)‚à®
Lp(R2)
‚â§C2

‚à•m‚à•L‚àû+A

max

p,(p‚àí1)‚àí18f

Lp(R2) ,
where the penultimate estimate follows from Theorem 6.1.6 and the last estimate
by the boundedness of the Hilbert transform (Theorem 5.1.7). We now appeal
to inequality (6.1.29) which yields the required estimate for the Lp(R2) norm of
( 1f m++)‚à®. A similar argument also works for the remaining parts of m+‚àí, m‚àí+,
m‚àí‚àí, and summing concludes the proof of (6.2.6).
The analogous estimate on Rn is


‚àë
j‚ààZn
( 1f œáRjm+¬∑¬∑¬∑+)‚à®21
2

Lp(Rn)
‚â§Cn

‚à•m‚à•L‚àû+A

max

p,(p‚àí1)‚àí14n f

Lp(Rn)
which is obtained in a similar fashion. Using (6.1.29), this implies that
( 1fm+¬∑¬∑¬∑+)‚à®
Lp(Rn) ‚â§Cn

‚à•m‚à•L‚àû+A

max

p,(p‚àí1)‚àí16nf

Lp(Rn) .
A similar inequality holds when some (or all) +‚Äôs are replaced by ‚àí‚Äôs.
‚ñ°
We now give a condition that implies (6.2.5) and is well suited for a variety of
applications.
Corollary 6.2.5. Let m be a bounded C n function deÔ¨Åned away from the coordinate
axes on Rn. Assume that for all k ‚àà{1,...,n}, all distinct j1,..., jk ‚àà{1,2,...,n},
and all Œær ‚ààR\{0} for r /‚àà{j1,..., jk} we have
(‚àÇj1 ¬∑¬∑¬∑‚àÇjkm)(Œæ1,...,Œæn)
 ‚â§A|Œæ j1|‚àí1 ¬∑¬∑¬∑|Œæ jk|‚àí1 .
(6.2.9)
Then m satisÔ¨Åes (6.2.6).
Proof. Simply observe that condition (6.2.9) implies (6.2.5).
‚ñ°

6.2 Two Multiplier Theorems
445
Example 6.2.6. The following are examples of functions that satisfy the hypotheses
of Corollary 6.2.5:
m1(Œæ) =
Œæ1
Œæ1 +i(Œæ 2
2 +¬∑¬∑¬∑+Œæ 2n ) ,
m2(Œæ) =
|Œæ1|Œ±1 ¬∑¬∑¬∑|Œæn|Œ±n
(Œæ 2
1 +Œæ 2
2 +¬∑¬∑¬∑+Œæ 2n )Œ±/2 ,
where Œ±1 +Œ±2 +¬∑¬∑¬∑+Œ±n = Œ±, Œ±j > 0,
m3(Œæ) =
Œæ2Œæ 2
3
iŒæ1 +Œæ 2
2 +Œæ 4
3
.
The functions m1 and m2 are deÔ¨Åned on Rn \{0} and m3 on R3 \{0}.
The previous examples and many other examples that satisfy the hypothesis
(6.2.9) of Corollary 6.2.5 are invariant under a set of dilations in the following sense:
suppose that there exist k1,...,kn ‚ààR+ and s ‚ààR such that the smooth function m
on Rn \{0} satisÔ¨Åes
m(Œª k1Œæ1,...,Œª knŒæn) = Œª ism(Œæ1,...,Œæn)
for all Œæ1,...,Œæn ‚ààR and Œª > 0. Then m satisÔ¨Åes condition (6.2.9). Indeed, differ-
entiation gives
Œª Œ±1k1+¬∑¬∑¬∑+Œ±nkn‚àÇŒ±m(Œª k1Œæ1,...,Œª knŒæn) = Œª is‚àÇŒ±m(Œæ1,...,Œæn)
for every multi-index Œ± = (Œ±1,...,Œ±n). Now for every Œæ ‚ààRn \{0} pick the unique
ŒªŒæ > 0 such that (Œª k1
Œæ Œæ1,...,Œª kn
Œæ Œæn) ‚ààSn‚àí1. Then Œª
k jŒ± j
Œæ
‚â§|Œæ j|‚àíŒ± j, and it follows
that
|‚àÇŒ±m(Œæ1,...,Œæn)| ‚â§

sup
Sn‚àí1 |‚àÇŒ±m|

Œª Œ±1k1+¬∑¬∑¬∑+Œ±nkn
Œæ
‚â§CŒ±|Œæ1|‚àíŒ±1 ¬∑¬∑¬∑|Œæn|‚àíŒ±n.
6.2.3 The Mihlin‚ÄìH¬®ormander Multiplier Theorem on Rn
We now discuss another multiplier theorem that also requires decay of derivatives.
We will consider the situation where each differentiation produces uniform decay in
all variables, quantitatively expressed via the condition
|‚àÇŒ±
Œæ m(Œæ)| ‚â§CŒ±|Œæ|‚àí|Œ±|
(6.2.10)

446
6 Littlewood‚ÄìPaley Theory and Multipliers
for each multi-index Œ±. The decay can also be expressed in terms of a square inte-
grable estimate that has the form

R<|Œæ|<2R |‚àÇŒ±
Œæ m(Œæ)|2 dŒæ
 1
2
‚â§C‚Ä≤
Œ± R
n
2 ‚àí|Œ±| < ‚àû
(6.2.11)
for all multi-indices Œ± and all R > 0. Obviously (6.2.10) implies (6.2.11)
Theorem 6.2.7. Let m(Œæ) be a complex-valued bounded function on Rn \ {0} that
satisÔ¨Åes for some A < ‚àû

R<|Œæ|<2R |‚àÇŒ±
Œæ m(Œæ)|2 dŒæ
 1
2
‚â§AR
n
2 ‚àí|Œ±| < ‚àû
(6.2.12)
for all multi-indices |Œ±| ‚â§[n/2]+1 and all R > 0.
Then for all 1 < p < ‚àû, m lies in Mp(Rn) and the following estimate is valid:
‚à•m‚à•Mp ‚â§Cn max(p,(p‚àí1)‚àí1)

A+‚à•m‚à•L‚àû
.
(6.2.13)
Moreover, the operator f ‚Üí( 1fm)‚à®maps L1(Rn) to L1,‚àû(Rn) with norm at most a
dimensional constant multiple of A+‚à•m‚à•L‚àû.
We remark that in most applications, condition (6.2.12) appears in the form
|‚àÇŒ±
Œæ m(Œæ)| ‚â§CŒ±|Œæ|‚àí|Œ±| ,
(6.2.14)
which should be, in principle, easier to verify.
Proof. Since m is a bounded function, the operator given by convolution with W =
m‚à®is bounded on L2(Rn). To prove that this operator maps L1(Rn) to L1,‚àû(Rn), it
sufÔ¨Åces to prove that the distribution W coincides with a function K on Rn \{0} that
satisÔ¨Åes H¬®ormander‚Äôs condition.
Let 1Œ∂ be a smooth function supported in the annulus 1
2 ‚â§|Œæ| ‚â§2 such that
‚àë
j‚ààZ
1Œ∂(2‚àíjŒæ) = 1,
when Œæ Ã∏= 0.
Set mj(Œæ) = m(Œæ)1Œ∂(2‚àíjŒæ) for j ‚ààZ and Kj = m‚à®
j . We begin by observing that
‚àëN
‚àíN Kj converges to W in S ‚Ä≤(Rn). Indeed, for all œï ‚ààS (Rn) we have
>
N
‚àë
j=‚àíN
Kj,œï
?
=
>
N
‚àë
j=‚àíN
mj,œï ‚à®?
‚Üí
4
m,œï ‚à®5
=
4
W,œï
5
.
We set n0 = [ n
2]+1. We claim that there is a constant #Cn such that
sup
j‚ààZ

Rn |Kj(x)|(1+2j|x|)
1
4 dx ‚â§#CnA,
(6.2.15)
sup
j‚ààZ
2‚àíj

Rn |‚àáKj(x)|(1+2j|x|)
1
4 dx ‚â§#CnA.
(6.2.16)

6.2 Two Multiplier Theorems
447
To prove (6.2.15) we multiply and divide the integrand in (6.2.15) by the expression
(1 + 2j|x|)n0. Applying the Cauchy‚ÄìSchwarz inequality to |Kj(x)|(1 + 2j|x|)n0 and
(1+2j|x|)‚àín0+ 1
4 , we control the integral in (6.2.15) by the product

Rn |Kj(x)|2(1+2j|x|)2n0 dx
1
2 
Rn(1+2j|x|)‚àí2n0+ 1
2 dx
1
2
.
(6.2.17)
We now note that ‚àí2n0 + 1
2 < ‚àín, and hence the second factor in (6.2.17) is equal
to a constant multiple of 2‚àíjn/2. To estimate the Ô¨Årst integral in (6.2.17) we use the
simple fact that
(1+2j|x|)n0 ‚â§C(n) ‚àë
|Œ≥|‚â§n0
|(2jx)Œ≥|.
We now have that the expression inside the supremum in (6.2.15) is controlled by
C‚Ä≤(n)2‚àíjn/2 ‚àë
|Œ≥|‚â§n0

Rn |Kj(x)|222 j|Œ≥||xŒ≥|2 dx
1
2
,
(6.2.18)
which, by Plancherel‚Äôs theorem, is equal to
2‚àíjn/2 ‚àë
|Œ≥|‚â§n0
CŒ≥2j|Œ≥|

Rn |(‚àÇŒ≥mj)(Œæ)|2 dŒæ
1
2
(6.2.19)
for some constants CŒ≥.
For multi-indices Œ¥ = (Œ¥1,...,Œ¥n) and Œ≥ = (Œ≥1,...,Œ≥n) we introduce the notation
Œ¥ ‚â§Œ≥ to mean Œ¥ j ‚â§Œ≥ j for all j = 1,...,n . For any |Œ≥| ‚â§n0 we use Leibniz‚Äôs rule to
obtain for some constants CŒ¥,Œ≥

Rn |(‚àÇŒ≥mj)(Œæ)|2 dŒæ
1
2
‚â§‚àë
Œ¥‚â§Œ≥
CŒ¥,Œ≥

Rn
2‚àíj|Œ≥‚àíŒ¥|(‚àÇŒ≥‚àíŒ¥
Œæ
1Œ∂)(2‚àíjŒæ)(‚àÇŒ¥
Œæ m)(Œæ)
2dŒæ
1
2
‚â§‚àë
Œ¥‚â§Œ≥
CŒ¥,Œ≥2‚àíj|Œ≥|2j|Œ¥|

2 j‚àí1‚â§|Œæ|‚â§2 j+1 |(‚àÇŒ¥
Œæ m)(Œæ)
2 dŒæ
1
2
‚â§‚àë
Œ¥‚â§Œ≥
CŒ¥,Œ≥2‚àíj|Œ≥|2j|Œ¥| 2A2jn/22‚àíj|Œ¥|
= #Cn A2jn/22‚àíj|Œ≥| ,
which inserted in (6.2.19) and combined with (6.2.18) yields (6.2.15). To obtain
(6.2.16) we repeat the same argument for every derivative ‚àÇrKj. Since the Fourier
transform of (‚àÇrKj)(x)xŒ≥ is equal to a constant multiple of ‚àÇŒ≥
Œærm(Œæ)1Œ∂(2‚àíjŒæ)

,
we observe that the extra factor 2‚àíj in (6.2.16) can be combined with Œær to write
2‚àíj‚àÇŒ≥
Œærm(Œæ)1Œ∂(2‚àíjŒæ)

as ‚àÇŒ≥
m(Œæ)1Œ∂r(2‚àíjŒæ)

, where 1Œ∂r(Œæ) = Œær1Œ∂(Œæ). The pre-
vious calculation with 1Œ∂r replacing 1Œ∂ can then be used to complete the proof of
(6.2.16).

448
6 Littlewood‚ÄìPaley Theory and Multipliers
We now show that for all x Ã∏= 0, the series ‚àëj‚ààZ Kj(x) converges to a function,
which we denote by K(x). Indeed, as a consequence of (6.2.15) we have that
(1+2jŒ¥)
1
4

|x|‚â•Œ¥ |Kj(x)|dx ‚â§#CnA,
for any Œ¥ > 0, which implies that the function ‚àëj>0 |Kj(x)| is integrable away from
the origin and satisÔ¨Åes

Œ¥‚â§|x|‚â§2Œ¥ ‚àëj>0 |Kj(x)|dx < ‚àû. Now note that (6.2.15) also
holds with ‚àí1
4 in place of 1
4. Using this observation we obtain
(1+2j2Œ¥)‚àí1
4

|x|‚â§2Œ¥ |Kj(x)|dx ‚â§

|x|‚â§2Œ¥ |Kj(x)|(1+2j|x|)‚àí1
4 dx ‚â§#CnA,
and from this it follows that

Œ¥‚â§|x|‚â§2Œ¥ ‚àëj‚â§0 |Kj(x)|dx < ‚àû.
We conclude that the series ‚àëj‚ààZ Kj(x) converges a.e. on Rn \{0} to a function
K(x) that coincides with the distribution W = m‚à®on Rn \{0} and satisÔ¨Åes
sup
Œ¥>0

Œ¥‚â§|x|‚â§2Œ¥ |K(x)|dx < ‚àû.
We now prove that the function K = ‚àëj‚ààZ Kj (deÔ¨Åned on Rn \ {0}) satisÔ¨Åes
H¬®ormander‚Äôs condition. It sufÔ¨Åces to prove that for all y Ã∏= 0 we have
‚àë
j‚ààZ

|x|‚â•2|y| |Kj(x‚àíy)‚àíKj(x)|dx ‚â§2C‚Ä≤
nA.
(6.2.20)
Fix a y ‚ààRn \{0} and pick a k ‚ààZ such that 2‚àík ‚â§|y| ‚â§2‚àík+1. The part of the sum
in (6.2.20) where j > k is bounded by
‚àë
j>k

|x|‚â•2|y| |Kj(x‚àíy)|+|Kj(x)|dx ‚â§2 ‚àë
j>k

|x|‚â•|y| |Kj(x)|dx
‚â§2 ‚àë
j>k

|x|‚â•|y| |Kj(x)|(1+2j|x|)
1
4
(1+2j|x|)
1
4
dx
‚â§‚àë
j>k
2#CnA
(1+2j|y|)
1
4
‚â§‚àë
j>k
2#CnA
(1+2j2‚àík)
1
4
= C‚Ä≤
nA,
where we used (6.2.15). The part of the sum in (6.2.20) where j ‚â§k is bounded by
‚àë
j‚â§k

|x|‚â•2|y| |Kj(x‚àíy)‚àíKj(x)|dx
‚â§‚àë
j‚â§k

|x|‚â•2|y|
 1
0 |‚àíy¬∑‚àáKj(x‚àíŒ∏y)|dŒ∏ dx

6.2 Two Multiplier Theorems
449
‚â§
 1
0 ‚àë
j‚â§k
2‚àík+1

Rn |‚àáKj(x‚àíŒ∏y)|(1+2j|x‚àíŒ∏y|)
1
4 dxdŒ∏
‚â§
 1
0 ‚àë
j‚â§k
2‚àík+1 #CnA2j dŒ∏ ‚â§C‚Ä≤
nA,
using (6.2.16). H¬®ormander‚Äôs condition is satisÔ¨Åed for K, and we appeal to Theorem
5.3.3 to complete the proof of (6.2.13).
‚ñ°
Example 6.2.8. Let m be a smooth function away from the origin that is homoge-
neous of imaginary order, i.e., for some Ô¨Åxed œÑ real and all Œª > 0 we have
m(ŒªŒæ) = Œª iœÑm(Œæ).
(6.2.21)
Then m is an Lp Fourier multiplier for 1 < p < ‚àû. Indeed, differentiating both sides
of (6.2.21) with respect to ‚àÇŒ±
Œæ we obtain
Œª |Œ±|‚àÇŒ±
Œæ m(ŒªŒæ) = Œª iœÑ‚àÇŒ±
Œæ m(Œæ)
and taking Œª = |Œæ|‚àí1, we deduce condition (6.2.14) with CŒ± = sup|Œ∏|=1 |‚àÇŒ±m(Œ∏)|.
An explicit example of such a function is m(Œæ) = |Œæ|iœÑ. Another example is
m0(Œæ1,Œæ2,Œæ3) =
Œæ 2
1 +Œæ 2
2
Œæ 2
1 +i(Œæ 2
2 +Œæ 2
3 )
which is homogeneous of degree zero and also smooth on Rn \{0}.
Example 6.2.9. Let z be a complex numbers with Rez ‚â•0. Then the functions
m1(Œæ) =

|Œæ|2
1+|Œæ|2
z
,
m2(Œæ) =

1
1+|Œæ|2
z
deÔ¨Åned on Rn are Lp Fourier multipliers for 1 < p < ‚àû. To prove this assertion for
m1, we verify condition (6.2.14). To achieve this, introduce the function on Rn+1
M1(Œæ1,...,Œæn,t) =

|Œæ1|2 +¬∑¬∑¬∑+|Œæn|2
t2 +|Œæ1|2 +¬∑¬∑¬∑+|Œæn|2
z
=

|Œæ|2
t2 +|Œæ|2
z
,
where Œæ = (Œæ1,...,Œæn). Then M is homogeneous of degree 0 and smooth on
Rn+1 \{0}. The derivatives ‚àÇŒ≤M1 are homogeneous of degree ‚àí|Œ≤| and by the cal-
culation in the preceding example they satisfy |‚àÇŒ≤M1(Œæ,t)| ‚â§CŒ≤|(Œæ,t)|‚àí|Œ≤|, with
CŒ≤ = sup|Œ∏|=1 |‚àÇŒ≤M1(Œ∏)|, whenever (Œæ,t) Ã∏= 0 and Œ≤ is a multi index of n+1 vari-
ables. In particular, taking Œ≤ = (Œ±,0), we obtain
‚àÇŒ±1
Œæ1 ¬∑¬∑¬∑‚àÇŒ±n
Œæn M1(Œæ1,...,Œæn,t)
 ‚â§
CŒ±
(t2 +|Œæ|2)|Œ±|/2 ,
and setting t = 1 we deduce that |‚àÇŒ±m1(Œæ)| ‚â§CŒ±(1+|Œæ|2)‚àí|Œ±|/2 ‚â§CŒ±|Œæ|‚àí|Œ±|.

450
6 Littlewood‚ÄìPaley Theory and Multipliers
For m2 we introduce the function
M2(Œæ1,...,Œæn,t) =

1
t2 +|Œæ1|2 +¬∑¬∑¬∑+|Œæn|2
z
on Rn+1, which is homogeneous of degree ‚àí2z. Then the derivative ‚àÇŒ≤M2 is homo-
geneous of degree ‚àí|Œ≤| ‚àí2z, hence it satisÔ¨Åes |‚àÇŒ≤M2(Œæ,t)| ‚â§CŒ≤|(Œæ,t)|‚àí|Œ≤|‚àí2Rez
for all multi-indices Œ≤ of n+1 variables. In particular, taking Œ≤ = (Œ±,0), we obtain
‚àÇŒ±1
Œæ1 ¬∑¬∑¬∑‚àÇŒ±n
Œæn M2(Œæ1,...,Œæn,t)
 ‚â§
CŒ±
(t2 +|Œæ|2)
|Œ±|
2 +Rez ,
and setting t = 1, we deduce |‚àÇŒ±m2(Œæ)| ‚â§CŒ±(1+|Œæ|2)‚àí|Œ±|/2 ‚â§CŒ±|Œæ|‚àí|Œ±|, where in
the Ô¨Årst inequality we used that Rez ‚â•0.
We end this section by comparing Theorems 6.2.2 and 6.2.4 with Theorem 6.2.7.
It is obvious that in dimension n = 1, Theorem 6.2.2 is stronger than Theorem 6.2.7
in view of the inequality

2 j<|Œæ|<2 j+1 |m‚Ä≤(Œæ)|dŒæ ‚â§2j/2

2 j<|Œæ|<2 j+1 |m‚Ä≤(Œæ)|2 dŒæ
 1
2
,
which implies that (6.2.2) is weaker than (6.2.12). Note also that in Theorem 6.2.2
the multiplier m is not required to be differentiable at the points ¬±2j. But in higher
dimensions neither theorem includes the other. In Theorem 6.2.4 the multiplier is
allowed to be singular on a set of measure zero but is required to be differentiable in
every variable, i.e., to be at least C n in the complement of this null set. In Theorem
6.2.7, the multiplier is only allowed to be singular only at the origin, but it is assumed
to be C [n/2]+1, requiring almost half the differentiability called for by condition
(6.2.9). It should be noted that both theorems have their shortcomings. In particular,
they are not Lp sensitive, i.e., delicate enough to detect whether m is a bounded
Fourier multiplier on some Lp but not on some other Lq.
Exercises
6.2.1. Let œà(Œæ) be a smooth function supported in [3/4,2]‚à™[‚àí2,‚àí3/4] and equal
to 1 on [1,3/2] ‚à™[‚àí3/2,‚àí1] that satisÔ¨Åes ‚àëj‚ààZ œà(2‚àíjŒæ) = 1 for all Œæ Ã∏= 0. Let
1 ‚â§k ‚â§n. Prove that m ‚ààMp(Rn) if and only if (6.2.1) is satisÔ¨Åed with mj(Œæ) re-
placed by the function m(Œæ)œà(2‚àíj1Œæ1)¬∑¬∑¬∑œà(2‚àíjkŒæk).

Hint: To prove one direction, partition Zk in 2k sets such that for every j =
( j1,..., jk) in each of these sets, ji has a Ô¨Åxed remainder modulo 2. For the
other direction, use Theorem 6.1.6 in the variables x1,...,xk. Also use the inequal-
ity ‚à•f‚à•Lp(Rn) ‚â§Cp‚à•(‚àëj‚ààZk |( 1f œáRj)‚à®|2)1/2‚à•Lp(Rn), Rj = ([‚àí2,‚àí1
2] ‚à™[ 1
2,2])k √ó Rn‚àík,
which can be derived by duality from the identity ‚àëj‚ààZk œáRj = 2k.


6.2 Two Multiplier Theorems
451
6.2.2. Let œï be a smooth function on the real line supported in the interval [‚àí1,1].
Let œà(t) be a smooth function on the real line that is equal to 1 when |t| ‚â•10 and
vanishes when |t| ‚â§9. Show that for the function m(Œæ1,Œæ2) = eiŒæ 2
2 /Œæ1œï(Œæ2)œà(Œæ1)
lies in Mp(R2), 1 < p < ‚àû, using Theorem 6.2.4. Also show that Theorem 6.2.7
does not apply.
6.2.3. Consider the differential operators
L1 = ‚àÇ1 ‚àí‚àÇ2
2 +‚àÇ4
3 ,
L2 = ‚àÇ1 +‚àÇ2
2 +‚àÇ2
3 .
Prove that for every 1 < p < ‚àûthere exists a constant Cp < ‚àûsuch that for all
Schwartz functions f on R3 we have
‚àÇ2‚àÇ2
3 f

Lp ‚â§Cp
L1( f)

Lp ,
‚àÇ1 f

Lp ‚â§Cp
L2( f)

Lp .

Hint: Use Corollary 6.2.5 and the idea of Example 6.2.6.

6.2.4. Suppose that m(Œæ) is a real-valued function that satisÔ¨Åes either (6.2.9) or
|‚àÇŒ±m(Œæ)| ‚â§CŒ±|Œæ|‚àí|Œ±| for all multi-indices Œ± with |Œ±| ‚â§[ n
2]+1 and all Œæ ‚ààRn\{0}.
Show that eim(Œæ) lies in Mp(Rn) for any 1 < p < ‚àû.

Hint: Prove by induction and use that
‚àÇŒ±
eim(Œæ)
= eim(Œæ)
‚àë
l j‚â•0,Œ≤ j‚â§Œ±
l1Œ≤ 1+¬∑¬∑¬∑+lkŒ≤ k=Œ±
cŒ≤ 1,...,Œ≤ k(‚àÇŒ≤ 1m(Œæ))l1 ¬∑¬∑¬∑(‚àÇŒ≤ km(Œæ))lk ,
where the sum is taken over all partitions of the multi-index Œ± as a linear combina-
tion of multi-indices Œ≤ j with coefÔ¨Åcients l j ‚ààZ+ ‚à™{0}.

6.2.5. Suppose that œï(Œæ) is a smooth function on Rn that vanishes in a neighbor-
hood of the origin and is equal to 1 in a neighborhood of inÔ¨Ånity. Prove that the
function eiŒæ j|Œæ|‚àí1œï(Œæ) is in Mp(Rn) for 1 < p < ‚àû.
6.2.6. Let œÑ,œÑ1,...,œÑn be real numbers and œÅ1,...,œÅn be even natural numbers.
Prove that the following functions are Lp multipliers on Rn for 1 < p < ‚àû:
|Œæ1|iœÑ1 ¬∑¬∑¬∑|Œæn|iœÑn ,
(|Œæ1|œÅ1 +¬∑¬∑¬∑+|Œæn|œÅn)iœÑ ,
(|Œæ1|‚àíœÅ1 +|Œæ2|‚àíœÅ2)iœÑ .

452
6 Littlewood‚ÄìPaley Theory and Multipliers
6.2.7. Let 1Œ∂(Œæ) be a smooth function on Rn is supported in a compact set that does
not contain the origin and let aj be a bounded sequence of complex numbers. Prove
that the function
m(Œæ) = ‚àë
j‚ààZ
aj 1Œ∂(2‚àíjŒæ)
is in Mp(Rn) for all 1 < p < ‚àû.
6.2.8. Let 1Œ∂(Œæ) be a smooth function on Rn supported in a compact set that does
not contain the origin and let Œî Œ∂
j ( f) =
 1f(Œæ)1Œ∂(2‚àíjŒæ)
‚à®. Show that the operator
f ‚Üísup
N‚ààZ
 ‚àë
j<N
Œî Œ∂
j ( f)

is bounded on Lp(R) when 1 < p < ‚àû.

Hint: Pick a Schwartz function œï satisfying ‚àëj‚ààZ 1œï(2‚àíjŒæ) = 1 on Rn \ {0} with
1œï(Œæ) supported in 6
7 ‚â§|Œæ| ‚â§2. Then Œî œï
k Œî Œ∂
j = 0 if | j ‚àík| < c0 and we have
‚àë
j<N
Œî Œ∂
j = ‚àë
k<N+c0
Œî œï
k ‚àë
j<N
Œî Œ∂
j = ‚àë
k<N+c0
Œî œï
k ‚àë
j
Œî Œ∂
j ‚àí‚àë
k<N+c0
Œî œï
k ‚àë
j‚â•N
Œî Œ∂
j ,
which is a Ô¨Ånite sum plus a term controlled by a multiple of the operator
f ‚ÜíM
 ‚àë
j‚ààZ
Œî Œ∂
j ( f)

,
where M is the Hardy‚ÄìLittlewood maximal function.

6.2.9. Let Œ® be a Schwartz function whose Fourier transform is real-valued, sup-
ported in a compact set that does not contain the origin, and satisÔ¨Åes
‚àë
j‚ààZ
1
Œ®(2‚àíjŒæ) = 1
when Œæ Ã∏= 0.
Let Œî j be the Littlewood‚ÄìPaley operator associated with Œ®. Prove that
 ‚àë
| j|<N
Œî j(g)‚àíg

Lp ‚Üí0
as N ‚Üí‚àûfor all functions g ‚ààS (Rn). Deduce that Schwartz functions whose
Fourier transforms have compact supports that do not contain the origin are dense
in Lp(Rn) for 1 < p < ‚àû.

Hint: Use the result of Exercise 6.2.8 and the Lebesgue dominated convergence
theorem.


6.3 Applications of Littlewood‚ÄìPaley Theory
453
6.3 Applications of Littlewood‚ÄìPaley Theory
We now turn our attention to some important applications of Littlewood‚ÄìPaley the-
ory. We are interested in obtaining bounds for singular and maximal operators.
These bounds are obtained by controlling the corresponding operators by quadratic
expressions.
6.3.1 Estimates for Maximal Operators
One way to control the maximal operator supk |Tk( f)| is by introducing a good aver-
aging function œï and using the majorization
sup
k
|Tk( f)| ‚â§sup
k
|Tk( f)‚àíf ‚àóœï2‚àík|+sup
k
| f ‚àóœï2‚àík|
‚â§

‚àë
k
|Tk( f)‚àíf ‚àóœï2‚àík|2 1
2 +Cœï M( f)
(6.3.1)
for some constant Cœï depending on œï. We apply this idea to prove the following
theorem.
Theorem 6.3.1. Let m be a bounded function on Rn that is C 1 in a neighborhood
of the origin and satisÔ¨Åes m(0) = 1 and |m(Œæ)| ‚â§C|Œæ|‚àíŒµ for some C,Œµ > 0 and
all Œæ Ã∏= 0. For each k ‚ààZ deÔ¨Åne Tk( f)(x) = ( 1f(Œæ)m(2‚àíkŒæ))‚à®(x). Then there is a
constant Cn such that for all L2 functions f on Rn we have
sup
k‚ààZ
|Tk( f)|

L2 ‚â§Cn
f

L2.
(6.3.2)
Proof. Select a Schwartz function œï such that 1œï(0) = 1. Then there are positive
constants C1 and C2 such that |m(Œæ)‚àí1œï(Œæ)| ‚â§C1|Œæ|‚àíŒµ for |Œæ| away from zero and
|m(Œæ)‚àí1œï(Œæ)| ‚â§C2|Œæ| for |Œæ| near zero. These two inequalities imply that
‚àë
k
|m(2‚àíkŒæ)‚àí1œï(2‚àíkŒæ)|2 ‚â§C3 < ‚àû,
from which the L2 boundedness of the operator
f ‚Üí
‚àë
k
|Tk( f)‚àíf ‚àóœï2‚àík|21/2
follows easily. Using estimate (6.3.1) and the well-known L2 estimate for the Hardy‚Äì
Littlewood maximal function, we obtain (6.3.2).
‚ñ°
If m(Œæ) is the characteristic function of a rectangle with sides parallel to the axes,
this result can be extended to Lp.

454
6 Littlewood‚ÄìPaley Theory and Multipliers
Theorem 6.3.2. Let 1 < p < ‚àûand let U be the n-fold product of open intervals that
contain zero. For each k ‚ààZ deÔ¨Åne Tk( f)(x) = ( 1f(Œæ)œáU(2‚àíkŒæ))‚à®(x). Then there is
a constant Cp,n such that for all Lp functions f on Rn we have
sup
k‚ààZ
|Tk( f)|

Lp(Rn) ‚â§Cp,n
f

Lp(Rn).
Proof. Let us Ô¨Åx an open annulus A whose interior contains the boundary of U and
take a smooth function with compact support 1œà that vanishes in a neighborhood of
zero and a neighborhood of inÔ¨Ånity and is equal to 1 on the annulus A. Then the
function 1œï = (1 ‚àí1œà )œáU is Schwartz. Since œáU = œáU 1œà + 1œï, it follows that for all
f ‚ààLp(Rn) we have
Tk( f) = Tk( f)‚àíf ‚àóœï2‚àík + f ‚àóœï2‚àík = Tk( f ‚àóœà2‚àík)+ f ‚àóœï2‚àík .
Taking the supremum over k and using Corollary 2.1.12 we obtain
sup
k‚ààZ
|Tk( f)| ‚â§
‚àë
k
|Tk( f)‚àíf ‚àóœï2‚àík|21/2 +Cœï M( f).
(6.3.3)
The operator Tk( f) ‚àíf ‚àóœï2‚àík is given by multiplication on the Fourier transform
side by the multiplier
œáU(2‚àíkŒæ)‚àí1œï(2‚àíkŒæ) = œáU(2‚àíkŒæ) 1œà(2‚àíkŒæ) = œá2kU(Œæ) 1œà(2‚àíkŒæ).
Since {2kU}k‚ààZ is a measurable family of rectangles with sides parallel to the axes,
Exercise 5.6.1(b) yields the following inequality:

 ‚àë
k‚ààZ
|Tk( f)‚àíf ‚àóœï2‚àík|2 1
2

Lp ‚â§Cp,n

 ‚àë
k‚ààZ
| f ‚àóœà2‚àík|2 1
2

Lp .
(6.3.4)
Since f ‚àóœà2‚àík = Œî œà
j ( f), estimate (6.1.4) of Theorem 6.1.2 yields that the expres-
sion on the right in (6.3.4) is controlled by a multiple of ‚à•f‚à•Lp. Taking Lp norms in
(6.3.3) and using the Lp estimate for the square function yields the required conclu-
sion.
‚ñ°
The following lacunary version of the Carleson‚ÄìHunt theorem is yet another in-
dication of the powerful techniques of Littlewood‚ÄìPaley theory.
Corollary 6.3.3. (a) Let f be in L2(Rn) and let Œ© be an open set that contains the
origin in Rn. Then
lim
k‚Üí‚àû

2kŒ©
1f(Œæ)e2œÄix¬∑Œæ dŒæ = f(x)
for almost all x ‚ààRn.
(b) Let f be in Lp(Rn) for some 1 < p < ‚àû. Then
lim
k‚Üí‚àû

|Œæ1|<2k
...
|Œæn|<2k
1f(Œæ)e2œÄix¬∑Œæ dŒæ = f(x)
for almost all x ‚ààRn.

6.3 Applications of Littlewood‚ÄìPaley Theory
455
Proof. Both limits exist everywhere for functions f in the Schwartz class. To obtain
almost everywhere convergence for general f in Lp we appeal to Theorem 2.1.14.
The required control of the corresponding maximal operator is a consequence of
Theorem 6.3.1 with m = œáŒ© in case (a) and Theorem 6.3.2 in case (b).
‚ñ°
6.3.2 Estimates for Singular Integrals with Rough Kernels
We now turn to another application of the Littlewood‚ÄìPaley theory involving singu-
lar integrals.
Theorem 6.3.4. Suppose that Œº is a Ô¨Ånite Borel measure on Rn with compact sup-
port that satisÔ¨Åes |1Œº(Œæ)| ‚â§Bmin

|Œæ|‚àíb,|Œæ|b
for some b > 0 and all Œæ Ã∏= 0. DeÔ¨Åne
measures Œº j by setting 1Œº j(Œæ) = 1Œº(2‚àíjŒæ). Then the operator
TŒº( f)(x) = ‚àë
j‚ààZ
( f ‚àóŒº j)(x)
is bounded on Lp(Rn) for all 1 < p < ‚àû.
Proof. It is natural to begin with the L2 boundedness of TŒº. The estimate on 1Œº
implies that
‚àë
j‚ààZ
|1Œº(2‚àíjŒæ)| ‚â§‚àë
j‚ààZ
Bmin

|2‚àíjŒæ|b,|2‚àíjŒæ|‚àíb
‚â§CbB < ‚àû.
(6.3.5)
The L2 boundedness of TŒº is an immediate consequence of (6.3.5).
We now turn to the Lp boundedness of TŒº for 1 < p < ‚àû. We Ô¨Åx a radial Schwartz
function œà whose Fourier transform is supported in the annulus 1
2 < |Œæ| < 2 that
satisÔ¨Åes
‚àë
j‚ààZ
1œà(2‚àíjŒæ) = 1
(6.3.6)
whenever Œæ Ã∏= 0. We let œà2‚àík(x) = 2knœà(2kx), so that 3
œà2‚àík(Œæ) = 1œà(2‚àíkŒæ), and we
observe that the identity
Œº j = ‚àë
k‚ààZ
Œº j ‚àóœà2‚àíj‚àík
is valid by taking Fourier transforms and using (6.3.6). We now deÔ¨Åne operators Sk
by setting
Sk( f) = ‚àë
j‚ààZ
Œº j ‚àóœà2‚àíj‚àík ‚àóf = ‚àë
j‚ààZ
(Œº ‚àóœà2‚àík)2‚àíj ‚àóf .
Then for f in S we have that
TŒº( f) = ‚àë
j‚ààZ
Œº j ‚àóf = ‚àë
j‚ààZ ‚àë
k‚ààZ
Œº j ‚àóœà2‚àíj‚àík ‚àóf = ‚àë
k‚ààZ
Sk( f).

456
6 Littlewood‚ÄìPaley Theory and Multipliers
It sufÔ¨Åces therefore to obtain Lp boundedness for the sum of the Sk‚Äôs. We begin
by investigating the L2 boundedness of each Sk. Since the product 
œà2‚àíj‚àík 
œà2‚àíj‚Ä≤‚àík is
nonzero only when j‚Ä≤ ‚àà{j ‚àí1, j, j +1}, it follows that
Sk( f)
2
L2 ‚â§‚àë
j‚ààZ ‚àë
j‚Ä≤‚ààZ

Rn | 1Œº j(Œæ) 2
Œº j‚Ä≤ (Œæ) 1œà(2‚àíj‚àíkŒæ) 1œà(2‚àíj‚Ä≤‚àíkŒæ)|| 1f(Œæ)|2 dŒæ
‚â§C1 ‚àë
j‚ààZ
j+1
‚àë
j‚Ä≤= j‚àí1

|Œæ|‚âà2 j+k
| 1Œº j(Œæ)2
Œº j‚Ä≤(Œæ)|| 1f(Œæ)|2 dŒæ
‚â§C2 ‚àë
j‚ààZ

|Œæ|‚âà2 j+k
B2 min(|2‚àíjŒæ|b,|2‚àíjŒæ|‚àíb)2| 1f(Œæ)|2 dŒæ
‚â§C2
3B22‚àí2|k|b ‚àë
j‚ààZ

|Œæ|‚âà2 j+k
| 1f(Œæ)|2 dŒæ
= C2
3B2 2‚àí2|k|bf
2
L2 .
We have therefore obtained that for all k ‚ààZ and f ‚ààS (Rn) we have
Sk( f)

L2 ‚â§C3 B2‚àíb|k|f

L2 .
(6.3.7)
We notice that for any R > 0 we have

R‚â§|x|‚â§2R ‚àë
j‚ààZ

Œº ‚àóœà2‚àík

2‚àíj(x)
dx = ‚àë
j‚ààZ

2 jR‚â§|x|‚â§2 j+1R

Œº ‚àóœà2‚àík

(x)
dx
=

Rn

Œº ‚àóœà2‚àík

(x)
dx
‚â§
Œº
‚à•œà‚à•L1 ,
thus condition (5.3.4) of Theorem 5.3.3 is satisÔ¨Åed.
Next we verify that the kernel of each Sk satisÔ¨Åes H¬®ormander‚Äôs condition with
constant at most a multiple of (1+|k|). Fix y Ã∏= 0. Then

|x|‚â•2|y|
 ‚àë
j‚ààZ

(Œº ‚àóœà2‚àík)2‚àíj(x‚àíy)‚àí(Œº ‚àóœà2‚àík)2‚àíj(x)
dx
‚â§‚àë
j‚ààZ

|x|‚â•2|y| 2jn(Œº ‚àóœà2‚àík)(2jx‚àí2jy)‚àí(Œº ‚àóœà2‚àík)(2jx)
dx
= ‚àë
j‚ààZ
Ij,k(y),
where
Ij,k(y) =

|x|‚â•2 j+1|y|
(Œº ‚àóœà2‚àík)(x‚àí2jy)‚àí(Œº ‚àóœà2‚àík)(x)
dx.

6.3 Applications of Littlewood‚ÄìPaley Theory
457
We observe that Ij,k(y) ‚â§C4‚à•Œº‚à•M . Let |Œº| be the total variation of Œº. To obtain a
more delicate estimate for Ij,k(y) we argue as follows:
Ij,k(y) ‚â§

|x|‚â•2 j+1|y|

Rn
œà2‚àík(x‚àí2jy‚àíz)‚àíœà2‚àík(x‚àíz)
d|Œº|(z)dx
=

Rn 2kn

|x|‚â•2 j+1|y|
œà(2kx‚àí2kz‚àí2j+ky)‚àíœà(2kx‚àí2kz)
dxd|Œº|(z)
‚â§C5

|x|‚â•2 j+1|y|

Rn 2kn2j+k|y|
‚àáœà(2kx‚àí2kz‚àíŒ∏)
d|Œº|(z)dx
‚â§C62j+k

Rn

|x|‚â•2 j+1|y|
2kn|y|

1+|2kx‚àí2kz‚àíŒ∏|
‚àín‚àí2 dxd|Œº|(z)
= C62j+k|y|

Rn

|x|‚â•2 j+k+1|y|

1+|x‚àí2kz‚àíŒ∏|
‚àín‚àí2 dxd|Œº|(z),
where |Œ∏| ‚â§2j+k|y|. Note that Œ∏ depends on j,k, and y. From this and from Ij,k(y) ‚â§
C4‚à•Œº‚à•M we obtain
Ij,k(y) ‚â§C7
Œº

M min

1,2j+k|y|

,
(6.3.8)
which is valid for all j,k, and y Ã∏= 0. To estimate the last double integral even more
delicately, we consider the following two cases: |x| ‚â•2k+2|z| and |x| < 2k+2|z|. In
the Ô¨Årst case we have |x ‚àí2kz ‚àíŒ∏| ‚â•1
4|x|, given the fact that |x| ‚â•2j+k+1|y|. In
the second case we have that |x| ‚â§2k+2R, where B(0,R) contains the support of
Œº. Applying these observations in the last double integral, we obtain the following
estimate:
Ij,k(y) ‚â§C82j+k|y|

Rn


|x|‚â•2 j+k+1|y|
|x|‚â•2k+2|z|
dx

1+ 1
4|x|
n+2 +

|x|‚â•2 j+k+1|y|
|x|<2k+2R
dx

d|Œº|(z)
‚â§C92j+k|y|
Œº

M

1
(2j+k|y|)2 +0

= C9(2j+k|y|)‚àí1Œº

M ,
provided 2j|y| ‚â•2R. Combining this estimate with (6.3.8), we obtain
Ij,k(y) ‚â§C10
Œº

M

min

1,2j+k|y|

for all j,k and y,
(2j+k|y|)‚àí1
when 2j|y| ‚â•2R.
(6.3.9)

458
6 Littlewood‚ÄìPaley Theory and Multipliers
We now estimate ‚àëj Ij,k(y). When 2k ‚â•(2R)‚àí1 we use (6.3.9) to obtain
‚àë
j
Ij,k(y) ‚â§C10
Œº

M
/
‚àë
2 j‚â§
1
2k|y|
2j+k|y|+
‚àë
1
2k|y| ‚â§2 j‚â§2R
|y|
1+ ‚àë
2 j‚â•2R
|y|
(2j+k|y|)‚àí10
‚â§C11
Œº

M (|logR|+|k|).
Also when 2k < (2R)‚àí1 we again use (6.3.9) to obtain
‚àë
j
Ij,k(y) ‚â§C10
Œº

M
/
‚àë
2 j‚â§
1
2k|y|
2j+k|y|+ ‚àë
2 j‚â•
1
2k|y|
(2j+k|y|)‚àí10
‚â§C12
Œº

M ,
since in the second sum we have 2j|y| ‚â•2‚àík > 2R, which justiÔ¨Åes use of the corre-
sponding estimate in (6.3.9). This gives
‚àë
j
Ij,k(y) ‚â§C13
Œº

M (1+|k|),
(6.3.10)
where the constant C13 depends on the dimension and on R. We now use esti-
mates (6.3.7) and (6.3.10) and Theorem 5.3.3 to obtain that each Sk maps L1(Rn)
to L1,‚àû(Rn) with constant at most
Cn(2‚àíb|k| +1+|k|)
Œº

M ‚â§Cn(2+|k|)
Œº

M .
It follows from the Marcinkiewicz interpolation theorem (Theorem 1.3.2) that Sk
maps Lp(Rn) to itself for 1 < p < 2 with bound at most Cp,n2‚àíb|k|Œ∏p(1 + |k|)1‚àíŒ∏p,
when 1
p = Œ∏p
2 +1‚àíŒ∏p. Summing over all k ‚ààZ, we obtain that TŒº maps Lp(Rn) to
itself for 1 < p < 2. The boundedness of TŒº for p > 2 follows by duality.
‚ñ°
An immediate consequence of the previous result is the following.
Corollary 6.3.5. Suppose that Œº is a Ô¨Ånite Borel measure on Rn with compact sup-
port that satisÔ¨Åes |1Œº(Œæ)| ‚â§Bmin

|Œæ|‚àíb,|Œæ|b
for some b > 0 and all Œæ Ã∏= 0. DeÔ¨Åne
measures Œº j by setting 1Œº j(Œæ) = 1Œº(2‚àíjŒæ). Then the square function
G( f) =

‚àë
j‚ààZ
|Œº j ‚àóf|2 1
2
(6.3.11)
maps Lp(Rn) to itself whenever 1 < p < ‚àû.
Proof. To obtain the boundedness of the square function in (6.3.11) we use the
Rademacher functions r j(t), introduced in Appendix C.1, reindexed so that their
index set is the set of all integers (not the set of nonnegative integers). For each t we
introduce the operators
Tt
Œº( f) = ‚àë
j‚ààZ
r j(t)( f ‚àóŒº j).

6.3 Applications of Littlewood‚ÄìPaley Theory
459
Next we observe that for each t in [0,1] the operators Tt
Œº map Lp(Rn) to itself with
the same constant as the operator TŒº, which is in particular independent of t. Using
that the square function in (6.3.11) raised to the power p is controlled by a multiple
of the quantity
 1
0
 ‚àë
j‚ààZ
r j(t)( f ‚àóŒº j)

p
dt ,
a fact stated in Appendix C.2, we obtain the required conclusion by integrating
over Rn.
‚ñ°
6.3.3 An Almost Orthogonality Principle on Lp
Suppose that Tj are multiplier operators given by Tj( f) = ( 1fmj)‚à®, for some multi-
pliers mj. If the functions mj have disjoint supports and they are bounded uniformly
in j, then the operator
T = ‚àë
j
Tj
is bounded on L2. The following theorem gives an Lp analogue of this result.
Theorem 6.3.6. Suppose that 1 < p ‚â§2 ‚â§q < ‚àû. Let mj be Schwartz functions
supported in the annuli 2j‚àí1 ‚â§|Œæ| ‚â§2j+1 and let Tj( f) = ( 1fmj)‚à®. Suppose that the
Tj‚Äôs are uniformly bounded operators from Lp(Rn) to Lq(Rn), i.e.,
sup
j
Tj

Lp‚ÜíLq = A < ‚àû.
Then for each f ‚ààLp(Rn), the series
T( f) = ‚àë
j
Tj( f)
converges in the Lq norm and there exists a constant Cp,q,n < ‚àûsuch that
T

Lp‚ÜíLq ‚â§Cp,q,nA.
(6.3.12)
Proof. Fix a radial Schwartz function œï whose Fourier transform 1œï is real, equal to
one on the annulus 1
2 ‚â§|Œæ| ‚â§2, and vanishes outside the annulus 1
4 ‚â§|Œæ| ‚â§4. We
set œï2‚àíj(x) = 2jnœï(2jx), so that 3
œï2‚àíj is equal to 1 on the support of each mj. Setting
Œî j( f) = f ‚àóœï2‚àíj, we observe that
Tj = Œî jTjŒî j
for all j ‚ààZ. For a positive integer N we set
T N = ‚àë
| j|‚â§N
Œî jTjŒî j .

460
6 Littlewood‚ÄìPaley Theory and Multipliers
Fix f ‚ààLp(Rn). Clearly for every N, T N( f) is in Lq(Rn). Using (6.1.21) we obtain
T N( f)

Lq =
 ‚àë
| j|‚â§N
Œî jTjŒî j( f)

Lq
‚â§C‚Ä≤
q

 ‚àë
j‚ààZ
|TjŒî j( f)|2 1
2

Lq
= C‚Ä≤
q
 ‚àë
j‚ààZ
|TjŒî j( f)|2
1
2
Lq/2
‚â§C‚Ä≤
q

‚àë
j‚ààZ
|TjŒî j( f)|2
Lq/2
 1
2
= C‚Ä≤
q

‚àë
j‚ààZ
TjŒî j( f)
2
Lq
 1
2 ,
where we used Minkowski‚Äôs inequality, since q/2 ‚â•1. Using the uniform bounded-
ness of the Tj‚Äôs from Lp to Lq, we deduce that
C‚Ä≤
q

‚àë
j‚ààZ
TjŒî j( f)
2
Lq
 1
2 ‚â§C‚Ä≤
q A

‚àë
j‚ààZ
Œî j( f)
2
Lp
1
2
= C‚Ä≤
q A

‚àë
j‚ààZ
|Œî j( f)|2
Lp/2
1
2
‚â§C‚Ä≤
q A
 ‚àë
j‚ààZ
|Œî j( f)|2
Lp/2
1
2
= C‚Ä≤
q A


‚àë
j‚ààZ
|Œî j( f)|2 1
2 
Lp
‚â§C‚Ä≤
qCp A
 f

Lp(Rn) ,
where we used the result of Exercise 1.1.5(b), since p ‚â§2, and Theorem 6.1.2. We
conclude that the operators T N are uniformly bounded from Lp(Rn) to Lq(Rn).
If 1h is compactly supported in a subset of Rn \ {0}, then the sequence T N(h)
becomes independent of N for N large enough and hence it is Cauchy in Lq. But in
view of Exercise 6.2.9, the set of all such h is dense in Lp(Rn). Combining these
two results with the uniform boundedness of the T N‚Äôs from Lp to Lq, a simple Œµ
3
argument gives that for all f ‚ààLp the sequence T N( f) is Cauchy in Lq. Therefore,
for all f ‚ààLp the sequence {T N( f)}N converges in Lq to some T( f). Fatou‚Äôs lemma
gives
T( f)

Lq ‚â§C‚Ä≤
qCp A
 f

Lp,
which proves (6.3.12).
‚ñ°

6.3 Applications of Littlewood‚ÄìPaley Theory
461
Exercises
6.3.1. (The g-function) Let Pt(x) = Œì ( n+1
2 )œÄ‚àín+1
2 t(t2 +|x|2)‚àín+1
2
be the Poisson
kernel on Rn.
(a) Use Exercise 6.1.4 with Œ®(x) = ‚àÇ
‚àÇt Pt(x)

t=1 to obtain that the operator
f ‚Üí
 ‚àû
0 t
 ‚àÇ
‚àÇt (Pt ‚àóf)(x)
2 dt
1/2
is bounded from Lp(Rn) to Lp(Rn) for 1 < p < ‚àû.
(b ) Use Exercise 6.1.4 with Œ®(x) = ‚àÇkP1(x) to obtain that the operator
f ‚Üí
 ‚àû
0 t|‚àÇk(Pt ‚àóf)(x)|2 dt
1/2
is bounded from Lp(Rn) to Lp(Rn) for 1 < p < ‚àû.
(c) Conclude that the g-function
g( f)(x) =
 ‚àû
0 t|‚àáx,t(Pt ‚àóf)(x)|2 dt
1/2
is bounded from Lp(Rn) to Lp(Rn) for 1 < p < ‚àû.
6.3.2. Suppose that Œº is a Ô¨Ånite Borel measure on Rn with compact support that sat-
isÔ¨Åes 1Œº(0) = 0 and |1Œº(Œæ)| ‚â§C|Œæ|‚àía for some a > 0 and all Œæ Ã∏= 0. DeÔ¨Åne measures
Œº j by setting 1Œº j(Œæ) = 1Œº(2‚àíjŒæ). Show that the operator
TŒº( f)(x) = ‚àë
j‚ààZ
( f ‚àóŒº j)(x)
is bounded from Lp(Rn) to Lp(Rn) for all 1 < p < ‚àû.

Hint: Use Theorem 6.3.4

6.3.3. ([50], [71]) (a) Suppose that Œº is a Ô¨Ånite Borel measure on Rn with compact
support that satisÔ¨Åes |1Œº(Œæ)| ‚â§C|Œæ|‚àía for some a > 0 and all Œæ Ã∏= 0. Show that the
maximal function
MŒº( f)(x) = sup
j‚ààZ


Rn f(x‚àí2jy)dŒº(y)

is bounded from Lp(Rn) to Lp(Rn) for all 1 < p < ‚àû.
(b) Let Œº be the surface measure on the sphere Sn‚àí1 when n ‚â•2. Conclude that the
dyadic spherical maximal function MŒº is bounded on Lp(Rn) for all 1 < p < ‚àû.

Hint: Part (a): Pick a C ‚àû
0 function œï on Rn with 1œï(0) = 1. Then the measure
œÉ = Œº ‚àí1Œº(0)œï satisÔ¨Åes the hypotheses of Corollary 6.3.5. Since,
MŒº( f)(x) ‚â§

‚àë
j
|(œÉj ‚àóf)(x)|21/2
+|1Œº(0)|M( f)(x),

462
6 Littlewood‚ÄìPaley Theory and Multipliers
it follows that MŒº is bounded on Lp(Rn) whenever 1 < p < ‚àû. Part (b): If Œº = dœÉ
is surface measure on Sn‚àí1, then |2
dœÉ(Œæ)| ‚â§C|Œæ|‚àín‚àí1
2
(Appendices B.4 and B.7).

6.3.4. Let Œ© be in Lq(Sn‚àí1) for some 1 < q < ‚àûand deÔ¨Åne the absolutely continu-
ous measure
dŒº(x) = Œ©(x/|x|)
|x|n
œá1<|x|‚â§2 dx.
Show that for all a < 1/q‚Ä≤ we have that |1Œº(Œæ)| ‚â§C|Œæ|‚àía. Under the additional hy-
pothesis that Œ© has mean value zero, conclude that the singular integral operator
TŒ©( f)(x) = p.v.

Rn
Œ©(y/|y|)
|y|n
f(x‚àíy)dy = ‚àë
j
f ‚àóŒº j
is Lp bounded for all 1 < p < ‚àû. This provides an alternative proof of Theorem
5.2.10 under the hypothesis that Œ© ‚ààLq(Sn‚àí1).
6.3.5. For a continuous function F on R deÔ¨Åne
u(F)(x) =
 ‚àû
0 |F(x+t)+F(x‚àít)‚àí2F(x)|2 dt
t3
 1
2
.
Given f ‚ààL1
loc(R) we denote by Ff the indeÔ¨Ånite integral of f, that is,
Ff (x) =
 x
0 f(t)dt .
Prove that for all 1 < p < ‚àûthere exist constants cp and Cp such that for all functions
f ‚ààLp(R) we have
cp
f

Lp ‚â§
u(Ff )

Lp ‚â§Cp
f

Lp .

Hint: Let œï = œá[‚àí1,0] ‚àíœá[0,1]. Then
(œït ‚àóf)(x) = 1
t

Ff (x+t)+Ff (x‚àít)‚àí2Ff (x)

and the double inequality follows from parts (b) and (c) of Exercise 6.1.4.

6.3.6. Let m be a bounded function on Rn that is C 1 in a neighborhood of zero, it
satisÔ¨Åes m(0) = 1 and |m(Œæ)| ‚â§B|Œæ|‚àíŒµ for all Œæ Ã∏= 0, for some B,Œµ > 0. DeÔ¨Åne an
operator Tt by setting Tt( f)1(Œæ) = 1f(Œæ)m(tŒæ). Show that the maximal operator
sup
N>0
 1
N
 N
0
Tt( f)(x)
2 dt
1
2
maps L2(Rn) to itself.

6.4 Haar System, Conditional Expectation, and Martingales
463

Hint: Majorize this maximal operator by a constant multiple of the sum
M( f)(x)+
 ‚àû
0 |Tt( f)(x)‚àí( f ‚àóœït)(x)|2 dt
t
 1
2 ,
where œï is a C ‚àû
0 function such that 1œï(0) = 1.

6.3.7. ([150]) Let 0 < Œ≤ < 1 and p0 = (1 ‚àíŒ≤/2)‚àí1. Suppose that {f j}j‚ààZ are L2
functions on the real line with norm at most 1. Assume that each f j is supported in
interval of length 1 and that the orthogonality relation
4
f j | fk‚ü©
 ‚â§(1 + | j ‚àík|)‚àíŒ≤
holds for all j,k ‚ààZ.
(a) Let I ‚´ÖZ be such that for all j ‚ààI the functions f j are supported in a Ô¨Åxed
interval of length 3. Show that for all p satisfying 0 < p ‚â§2 there is Cp,Œ≤ < ‚àûsuch
that
‚àë
j‚ààI
Œµ j f j

Lp ‚â§Cp,Œ≤ |I|1‚àíŒ≤
2
whenever Œµ j are complex numbers with |Œµ j| ‚â§1.
(b) Under the same hypothesis as in part (a), prove that for all 0 < p < p0 there is a
constant C‚Ä≤
p,Œ≤ < ‚àûsuch that
‚àë
j‚ààI
cj f j

Lp ‚â§C‚Ä≤
p,Œ≤

‚àë
j‚ààZ
|cj|p 1
p
for all complex-valued sequences {cj}j in ‚Ñìp.
(c) Derive the conclusion of part (b) without the assumption that the f j are sup-
ported in a Ô¨Åxed interval of length 3.

Hint: Part (a): Pass from Lp to L2 and use the hypothesis. Part (b): Assume
‚àëj‚ààZ |cj|p = 1. For each k = 0,1,..., set Ik = {j ‚ààZ : 2‚àík‚àí1 < |cj| ‚â§2‚àík}. Write
‚àëj‚ààZ cj f j

Lp ‚â§‚àë‚àû
k=0 2‚àík‚àëj‚ààIk(cj2k) f j

Lp, use part (b), H¬®older‚Äôs inequality, and
the fact that ‚àë‚àû
k=0 2‚àíkp|Ik| ‚â§2p. Part (c): Write ‚àëj‚ààZ cj f j = ‚àëm‚ààZ Fm, where Fm is
the sum of cj f j over all j such that the support of f j meets the interval [m,m + 1].
These Fm‚Äôs are supported in [m‚àí1,m+2] and are almost orthogonal.

6.4 The Haar System, Conditional Expectation, and Martingales
There is a very strong connection between the Littlewood‚ÄìPaley operators and cer-
tain notions from probability, such as conditional expectation and martingale differ-
ence operators. The conditional expectation we are concerned with is with respect
to the increasing œÉ-algebra of all dyadic cubes on Rn.

464
6 Littlewood‚ÄìPaley Theory and Multipliers
6.4.1 Conditional Expectation and Dyadic Martingale Differences
We recall the deÔ¨Ånition of dyadic cubes.
DeÔ¨Ånition 6.4.1. A dyadic interval in R is an interval of the form

m2‚àík,(m+1)2‚àík
where m,k are integers. A dyadic cube in Rn is a product of dyadic intervals of the
same length. That is, a dyadic cube is a set of the form
n
‚àè
j=1

mj2‚àík,(mj +1)2‚àík
for some integers m1,...,mn,k.
We deÔ¨Åned dyadic intervals to be closed on the left and open on the right, so that
different dyadic intervals of the same length are always disjoint sets.
Given a cube Q in Rn we denote by |Q| its Lebesgue measure and by ‚Ñì(Q) its
side length. We clearly have |Q| = ‚Ñì(Q)n. We introduce some more notation.
DeÔ¨Ånition 6.4.2. For k ‚ààZ we denote by Dk the set of all dyadic cubes in Rn whose
side length is 2‚àík. We also denote by D the set of all dyadic cubes in Rn. Then we
have
D =

k‚ààZ
Dk ,
and moreover, the œÉ-algebra œÉ(Dk) of measurable subsets of Rn formed by count-
able unions and complements of elements of Dk is increasing as k increases.
We observe the fundamental property of dyadic cubes, which clearly justiÔ¨Åes
their usefulness. Any two dyadic intervals of the same side length either are disjoint
or coincide. Moreover, either two given dyadic intervals are disjoint, or one contains
the other. Similarly, either two dyadic cubes are disjoint, or one contains the other.
DeÔ¨Ånition 6.4.3. Given a locally integrable function f on Rn, we denote by
Avg
Q
f = 1
|Q|

Q f(t)dt
the average of f over a cube Q.
The conditional expectation of a locally integrable function f on Rn with respect
to the increasing family of œÉ-algebras œÉ(Dk) generated by Dk is deÔ¨Åned as
Ek( f)(x) = ‚àë
Q‚ààDk
(Avg
Q
f)œáQ(x),

6.4 Haar System, Conditional Expectation, and Martingales
465
for all k ‚ààZ. We also deÔ¨Åne the dyadic martingale difference operator Dk as follows:
Dk( f) = Ek( f)‚àíEk‚àí1( f),
also for k ‚ààZ.
Next we introduce the family of Haar functions.
DeÔ¨Ånition 6.4.4. For a dyadic interval I = [m2‚àík,(m + 1)2‚àík) we deÔ¨Åne IL =
[m2‚àík,(m+ 1
2)2‚àík) and IR = [(m+ 1
2)2‚àík,(m+1)2‚àík) to be the left and right parts
of I, respectively. The function
hI(x) = |I|‚àí1
2 œáIL ‚àí|I|‚àí1
2 œáIR
is called the Haar function associated with the interval I.
We remark that Haar functions are constructed in such a way that they have L2
norm equal to 1. Moreover, the Haar functions have the following fundamental or-
thogonality property:

R hI(x)hI‚Ä≤(x)dx =

0
when I Ã∏= I‚Ä≤,
1
when I = I‚Ä≤.
(6.4.1)
To see this, observe that the Haar functions have L2 norm equal to 1 by construction.
Moreover, if I Ã∏= I‚Ä≤, then I and I‚Ä≤ must have different lengths, say we have |I‚Ä≤| < |I|.
If I and I‚Ä≤ are not disjoint, then I‚Ä≤ is contained either in the left or in the right half of
I, on either of which hI is constant. Thus (6.4.1) follows.
We recall the notation
4
f,g
5
=

R f(x)g(x)dx
valid for square integrable functions. Under this notation, (6.4.1) can be rewritten as
4
hI,hI‚Ä≤5
= Œ¥I,I‚Ä≤, where the latter is 1 when I = I‚Ä≤ and zero otherwise.
6.4.2 Relation Between Dyadic Martingale Differences and Haar
Functions
We have the following result relating the Haar functions to the dyadic martingale
difference operators in dimension one.
Proposition 6.4.5. For every locally integrable function f on R and for all k ‚ààZ we
have the identity
Dk( f) = ‚àë
I‚ààDk‚àí1
4
f,hI
5
hI
(6.4.2)

466
6 Littlewood‚ÄìPaley Theory and Multipliers
and also
Dk( f)
2
L2 = ‚àë
I‚ààDk‚àí1
4
f,hI
52.
(6.4.3)
Proof. We observe that every interval J in Dk is either an IL or an IR for some unique
I ‚ààDk‚àí1. Thus we can write
Ek( f) = ‚àë
J‚ààDk
(Avg
J
f)œáJ
= ‚àë
I‚ààDk‚àí1
 2
|I|

IL
f(t)dt

œáIL +
 2
|I|

IR
f(t)dt

œáIR

.
(6.4.4)
But we also have
Ek‚àí1( f) = ‚àë
I‚ààDk‚àí1
(Avg
I
f)œáI
= ‚àë
I‚ààDk‚àí1
 1
|I|

IL
f(t)dt + 1
|I|

IR
f(t)dt

œáIL + œáIR

.
(6.4.5)
Now taking the difference between (6.4.4) and (6.4.5) we obtain
Dk( f) = ‚àë
I‚ààDk‚àí1
 1
|I|

IL
f(t)dt

œáIL ‚àí
 1
|I|

IR
f(t)dt

œáIL
+
 1
|I|

IR
f(t)dt

œáIR ‚àí
 1
|I|

IL
f(t)dt

œáIR

,
which is easily checked to be equal to
‚àë
I‚ààDk‚àí1

I f(t)hI(t)dt

hI = ‚àë
I‚ààDk‚àí1
4
f,hI
5
hI.
Finally, (6.4.3) is a consequence of (6.4.1).
‚ñ°
Theorem 6.4.6. Every function f ‚ààL2(Rn) can be written as
f = ‚àë
k‚ààZ
Dk( f),
(6.4.6)
where the series converges almost everywhere and in L2. We also have
f
2
L2(Rn) = ‚àë
k‚ààZ
Dk( f)
2
L2(Rn).
(6.4.7)
Moreover, when n = 1 we have the representation
f = ‚àë
I‚ààD
4
f,hI
5
hI ,
(6.4.8)

6.4 Haar System, Conditional Expectation, and Martingales
467
where the sum converges a.e. and in L2 and also
f
2
L2(R) = ‚àë
I‚ààD
4
f,hI
52 .
(6.4.9)
Proof. In view of the Lebesgue differentiation theorem, Corollary 2.1.16, given a
function f ‚ààL2(Rn) there is a set Nf of measure zero on Rn such that for all x ‚àà
Rn \Nf we have that
Avg
Qj
f ‚Üíf(x)
whenever Qj is a sequence of decreasing cubes such that 
j Qj = {x}. Given x
in Rn \ Nf there exists a unique sequence of dyadic cubes Qj(x) ‚ààD j such that
‚àû
j=0 Qj(x) = {x}. Then for all x ‚ààRn \Nf we have
lim
j‚Üí‚àûEj( f)(x) = lim
j‚Üí‚àû‚àë
Q‚ààD j
(Avg
Q
f)œáQ(x) = lim
j‚Üí‚àûAvg
Qj(x)
f = f(x).
From this we conclude that Ej( f) ‚Üíf a.e. as j ‚Üí‚àû. We also observe that since
|Ej( f)| ‚â§Mc( f), where Mc denotes the uncentered maximal function with respect
to cubes, we have that |Ej( f) ‚àíf| ‚â§2Mc( f), which allows us to obtain from the
Lebesgue dominated convergence theorem that Ej( f) ‚Üíf in L2 as j ‚Üí‚àû.
Next we study convergence of Ej( f) as j ‚Üí‚àí‚àû. For a given x ‚ààRn and Qj(x)
as before we have that
|Ej( f)(x)| =
 Avg
Qj(x)
f
 ‚â§

1
|Qj(x)|

Qj(x) | f(t)|2 dt
1
2
‚â§2
jn
2  f

L2 ,
which tends to zero as j ‚Üí‚àí‚àû, since the side length of each Qj(x) is 2‚àíj. Since
|Ej( f)| ‚â§Mc( f), the Lebesgue dominated convergence theorem allows us to con-
clude that Ej( f) ‚Üí0 in L2 as j ‚Üí‚àí‚àû. To obtain the conclusion asserted in (6.4.6)
we simply observe that
N
‚àë
k=M
Dk( f) = EN( f)‚àíEM‚àí1( f) ‚Üíf
in L2 and almost everywhere as N ‚Üí‚àûand M ‚Üí‚àí‚àû.
To prove (6.4.7) we Ô¨Årst observe that we can rewrite Dk( f) as
Dk( f) = ‚àë
Q‚ààDk
(Avg
Q
f)œáQ ‚àí‚àë
R‚ààDk‚àí1
(Avg
R
f)œáR
= ‚àë
R‚ààDk‚àí1

‚àë
Q‚ààDk
Q‚äÜR
(Avg
Q
f)œáQ ‚àí(Avg
R
f)œáR


468
6 Littlewood‚ÄìPaley Theory and Multipliers
= ‚àë
R‚ààDk‚àí1

‚àë
Q‚ààDk
Q‚äÜR
(Avg
Q
f)œáQ ‚àí1
2n ‚àë
Q‚ààDk
Q‚äÜR
(Avg
Q
f)œáR

= ‚àë
R‚ààDk‚àí1 ‚àë
Q‚ààDk
Q‚äÜR
(Avg
Q
f)

œáQ ‚àí2‚àínœáR

.
(6.4.10)
Using this identity we obtain that for given integers k‚Ä≤ > k we have

Rn Dk( f)(x)Dk‚Ä≤( f)(x)dx
= ‚àë
R‚ààDk‚àí1 ‚àë
Q‚ààDk
Q‚äÜR
(Avg
Q
f) ‚àë
R‚Ä≤‚ààDk‚Ä≤‚àí1 ‚àë
Q‚Ä≤‚ààDk‚Ä≤
Q‚Ä≤‚äÜR‚Ä≤
(Avg
Q‚Ä≤ f)
 
œáQ ‚àí2‚àínœáR

œáQ‚Ä≤ ‚àí2‚àínœáR‚Ä≤
dx.
Since k‚Ä≤ > k, the last integral may be nonzero only when R‚Ä≤ ‚´ãR. If this is the case,
then R‚Ä≤ ‚äÜQR‚Ä≤ for some dyadic cube QR‚Ä≤ ‚ààDk with QR‚Ä≤ ‚´ãR. See Figure 6.1.
Fig. 6.1 Picture of the cubes
R, R‚Ä≤, and QR‚Ä≤.
Then the function œáQ‚Ä≤ ‚àí2‚àínœáR‚Ä≤ is supported in the cube QR‚Ä≤ and the function
œáQ ‚àí2‚àínœáR is constant on any dyadic subcube Q of R (of half its side length) and in
particular is constant on QR‚Ä≤. Then
‚àë
Q‚Ä≤‚ààDk‚Ä≤
Q‚Ä≤‚äÜR‚Ä≤

Avg
Q‚Ä≤ f

QR‚Ä≤
œáQ‚Ä≤ ‚àí2‚àínœáR‚Ä≤ dx = ‚àë
Q‚Ä≤‚ààDk‚Ä≤
Q‚Ä≤‚äÜR‚Ä≤

Avg
Q‚Ä≤ f

|Q‚Ä≤|‚àí2‚àín|R‚Ä≤|

= 0,
since |R‚Ä≤| = 2n|Q‚Ä≤|. We conclude that
4
Dk( f),Dk‚Ä≤( f)
5
= 0 whenever k Ã∏= k‚Ä≤, from
which we easily derive (6.4.7).
Now observe that (6.4.8) is a direct consequence of (6.4.2), and (6.4.9) is a direct
consequence of (6.4.3).
‚ñ°

6.4 Haar System, Conditional Expectation, and Martingales
469
6.4.3 The Dyadic Martingale Square Function
As a consequence of identity (6.4.7), proved in the previous subsection, we obtain
that


‚àë
k‚ààZ
|Dk( f)|2 1
2 
L2(Rn) =
 f

L2(Rn) ,
(6.4.11)
which says that the dyadic martingale square function
S( f) =

‚àë
k‚ààZ
|Dk( f)|2 1
2
is L2 bounded. It is natural to ask whether there exist Lp analogues of this result, and
this is the purpose of the following theorem.
Theorem 6.4.7. For any 1 < p < ‚àûthere exists a constant cp,n such that for every
function f in Lp(Rn) we have
1
cp‚Ä≤,n
f

Lp(Rn) ‚â§
S( f)

Lp(Rn) ‚â§cp,n
f

Lp(Rn) .
(6.4.12)
The lower inequality subsumes the fact that if
S( f)

Lp(Rn) < ‚àû, then f must be an
Lp function.
Proof. Let {r j}j be the Rademacher functions (see Appendix C.1) enumerated in
such a way that their index set is the set of integers. We rewrite the upper estimate
in (6.4.12) as
 1
0

Rn
 ‚àë
k‚ààZ
rk(œâ)Dk( f)(x)

p
dxdœâ ‚â§Cp
p
f
p
Lp .
(6.4.13)
We prove a stronger estimate than (6.4.13), namely that for all œâ ‚àà[0,1] we have

Rn
Tœâ( f)(x)

p
dx ‚â§Cp
p
f
p
Lp ,
(6.4.14)
where
Tœâ( f)(x) = ‚àë
k‚ààZ
rk(œâ)Dk( f)(x).
In view of the L2 estimate (6.4.11), we have that the operator Tœâ is L2 bounded with
norm 1. We show that Tœâ is weak type (1,1).
To show that Tœâ is of weak type (1,1) we Ô¨Åx a function f ‚ààL1 and Œ± > 0. We
apply the Calder¬¥on‚ÄìZygmund decomposition (Theorem 5.3.1) to f at height Œ± to
write
f = g+b,
b = ‚àë
j

f ‚àíAvg
Qj
f

œáQj ,

470
6 Littlewood‚ÄìPaley Theory and Multipliers
where Qj are dyadic cubes that satisfy ‚àëj |Qj| ‚â§1
Œ±
f

L1 and g has L2 norm at
most (2nŒ±
 f

L1)
1
2 ; see (5.3.1). To achieve this decomposition, we apply the proof
of Theorem 5.3.1 starting with a dyadic mesh of large cubes such that |Q| ‚â•1
Œ±
f

L1
for all Q in the mesh. Then we subdivide each Q in the mesh by halving each side,
and we select those cubes for which the average of f over them is bigger than Œ± (and
thus at most 2nŒ±). Since the original mesh consists of dyadic cubes, the stopping-
time argument of Theorem 5.3.1 ensures that each selected cube is dyadic.
We observe (and this is the key observation) that Tœâ(b) is supported in 
j Qj. To
see this, we use identity (6.4.10) to write Tœâ(b) as
‚àë
j

‚àë
k
rk(œâ) ‚àë
R‚ààDk‚àí1 ‚àë
Q‚ààDk
Q‚äÜR
Avg
Q
[( f ‚àíAvg
Qj
f)œáQj]

œáQ ‚àí2‚àínœáR

.
(6.4.15)
We consider the following three cases for the cubes Q that appear in the inner sum in
(6.4.15): (i) Qj ‚äÜQ, (ii) Qj ‚à©Q = /0, and (iii) Q ‚´ãQj. It is simple to see that in cases
(i) and (ii) we have AvgQ[( f ‚àíAvgQj f)œáQj] = 0. Therefore the inner sum in (6.4.15)
is taken over all Q that satisfy Q ‚´ãQj. But then we must have that the unique dyadic
parent R of Q is also contained in Qj. It follows that the expression inside the square
brackets in (6.4.15) is supported in R and therefore in Qj. We conclude that Tœâ(b)
is supported in 
j Qj. Using Exercise 5.3.5(a) we obtain that Tœâ is weak type (1,1)
with norm at most
Œ±
{|Tœâ(g)| > Œ±
2 }
+Œ±

j Qj

‚à•f‚à•L1
‚â§
Œ±4Œ±‚àí2‚à•g‚à•2
L2 +‚à•f‚à•L1
‚à•f‚à•L1
‚â§2n+2 +1.
We have now established that Tœâ is weak type (1,1). Since Tœâ is L2 bounded with
norm 1, it follows by interpolation that Tœâ is Lp bounded for all 1 < p < 2. The
Lp boundedness of Tœâ for the remaining p > 2 follows by duality. (Note that the
operators Dk and Ek are self-transpose.) We conclude the validity of (6.4.14), which
implies that of (6.4.13). As observed, this is equivalent to the upper estimate in
(6.4.12).
Finally, we notice that the lower estimate in (6.4.12) is a consequence of the
upper estimate as in the case of the Littlewood‚ÄìPaley operators Œî j. Indeed, we need
to observe that in view of (6.4.6) we have
4
f,g
5 =
4‚àë
k
Dk( f),‚àë
k‚Ä≤
Dk‚Ä≤(g)
5
=
‚àë
k ‚àë
k‚Ä≤
4
Dk( f),Dk‚Ä≤(g)
5
=
‚àë
k
4
Dk( f),Dk(g)
5
[Exercise 6.4.6(a)]
‚â§

Rn‚àë
k
|Dk( f)(x)||Dk(g)(x)|dx

6.4 Haar System, Conditional Expectation, and Martingales
471
‚â§

Rn S( f)(x)S(g)(x)dx
(Cauchy‚ÄìSchwarz inequality)
‚â§
S( f)

Lp
S(g)

Lp‚Ä≤
(H¬®older‚Äôs inequality)
‚â§
S( f)

Lp cp‚Ä≤,n
g

Lp‚Ä≤ .
Taking the supremum over all functions g on Rn with Lp‚Ä≤ norm at most 1, we obtain
that f gives rise to a bounded linear functional on Lp‚Ä≤. It follows by the Riesz repre-
sentation theorem that f must be an Lp function that satisÔ¨Åes the lower estimate in
(6.4.12).
‚ñ°
6.4.4 Almost Orthogonality Between the Littlewood‚ÄìPaley
Operators and the Dyadic Martingale Difference Operators
Next, we discuss connections between the Littlewood‚ÄìPaley operators Œî j and the
dyadic martingale difference operators Dk. It turns out that these operators are al-
most orthogonal in the sense that the L2 operator norm of the composition DkŒî j
decays exponentially as the indices j and k get farther away from each other.
For the purposes of the next theorem we deÔ¨Åne the Littlewood‚ÄìPaley operators
Œî j as convolution operators with the function Œ®2‚àíj, where
1
Œ®(Œæ) = 1Œ¶(Œæ)‚àí1Œ¶(2Œæ)
and Œ¶ is a Ô¨Åxed radial Schwartz function whose Fourier transform 1Œ¶ is real-valued,
supported in the ball |Œæ| < 2, and equal to 1 on the ball |Œæ| < 1. In this case we
clearly have the identity
‚àë
j‚ààZ
1
Œ®(2‚àíjŒæ) = 1,
Œæ Ã∏= 0.
Then we have the following theorem.
Theorem 6.4.8. There exists a constant C such that for every k, j in Z the following
estimate on the operator norm of DkŒî j : L2(Rn) ‚ÜíL2(Rn) is valid:
DkŒî j

L2(Rn)‚ÜíL2(Rn) =
Œî jDk

L2(Rn)‚ÜíL2(Rn) ‚â§C2‚àí1
2 | j‚àík|.
(6.4.16)
Proof. Since Œ® is a radial function, it follows that Œî j is equal to its transpose oper-
ator on L2. Moreover, the operator Dk is also equal to its transpose. Thus
(DkŒî j)t = Œî jDk
and it therefore sufÔ¨Åces to prove only that
DkŒî j

L2‚ÜíL2 ‚â§C2‚àí1
2 | j‚àík| .
(6.4.17)

472
6 Littlewood‚ÄìPaley Theory and Multipliers
By a simple dilation argument it sufÔ¨Åces to prove (6.4.17) when k = 0. In this
case we have the estimate
D0Œî j

L2‚ÜíL2 =
E0Œî j ‚àíE‚àí1Œî j

L2‚ÜíL2
‚â§
E0Œî j ‚àíŒî j

L2‚ÜíL2 +
E‚àí1Œî j ‚àíŒî j

L2‚ÜíL2 ,
and since the Dk‚Äôs and Œî j‚Äôs are self-transposes, we have
D0Œî j

L2‚ÜíL2 =
Œî jD0

L2‚ÜíL2 =
Œî jE0 ‚àíŒî jE‚àí1

L2‚ÜíL2
‚â§
Œî jE0 ‚àíE0

L2‚ÜíL2 +
Œî jE‚àí1 ‚àíE0

L2‚ÜíL2.
Estimate (6.4.17) when k = 0 will be a consequence of the pair of inequalities
E0Œî j ‚àíŒî j

L2‚ÜíL2 +
E‚àí1Œî j ‚àíŒî j

L2‚ÜíL2 ‚â§C2
j
2 for j ‚â§0,
(6.4.18)
Œî jE0 ‚àíE0

L2‚ÜíL2 +
Œî jE‚àí1 ‚àíE0

L2‚ÜíL2 ‚â§C2‚àí1
2 j for j ‚â•0.
(6.4.19)
We start by proving (6.4.18). We consider only the term E0Œî j ‚àíŒî j, since the term
E‚àí1Œî j ‚àíŒî j is similar. Let f ‚ààL2(Rn). Then
E0Œî j( f)‚àíŒî j( f)
2
L2
= ‚àë
Q‚ààD0
 f ‚àóŒ®2‚àíj ‚àíAvg
Q
( f ‚àóŒ®2‚àíj)
2
L2(Q)
‚â§‚àë
Q‚ààD0

Q

Q |( f ‚àóŒ®2‚àíj)(x)‚àí( f ‚àóŒ®2‚àíj)(t)|2 dt dx
‚â§3 ‚àë
Q‚ààD0

Q

Q

5‚àönQ | f(y)||Œ®2‚àíj(x‚àíy)|dy
2
dt dx
+3 ‚àë
Q‚ààD0

Q

Q

5‚àönQ | f(y)||Œ®2‚àíj(t ‚àíy)|dy
2
dt dx
+3 ‚àë
Q‚ààD0

Q

Q

(5‚àönQ)c | f(y)|2jn+ j|‚àáŒ®(2j(Œæx,t ‚àíy))|dy
2
dt dx,
where Œæx,t lies on the line segment joining x and t. Applying the Cauchy-Schwarz
inequality to the Ô¨Årst two terms, we see that the last expression is bounded by
C2jn ‚àë
Q‚ààD0

5‚àönQ | f(y)|2 dy+CM22 j ‚àë
Q‚ààD0

Q

Rn
2jn| f(y)|dy
(1+2j|x‚àíy|)M
2
dx,
which is clearly controlled by C(2jn+22 j)‚à•f‚à•2
L2 ‚â§2C2j‚à•f‚à•2
L2. This proves (6.4.18).
We now turn to the proof of (6.4.19). We set Sj = ‚àëk‚â§j Œîk. Since Œî j is the differ-
ence of two Sj‚Äôs, it sufÔ¨Åces to prove (6.4.19), where Œî j is replaced by Sj. We work
only with the term SjE0 ‚àíE0, since the other term can be treated similarly. We have

6.4 Haar System, Conditional Expectation, and Martingales
473
SjE0( f)‚àíE0( f)
2
L2 =
 ‚àë
Q‚ààD0
(Avg
Q
f)(Œ¶2‚àíj ‚àóœáQ ‚àíœáQ)

2
L2
‚â§2
 ‚àë
Q‚ààD0
(Avg
Q
f)(Œ¶2‚àíj ‚àóœáQ ‚àíœáQ)œá5‚àönQ

2
L2
+2
 ‚àë
Q‚ààD0
(Avg
Q
f)(Œ¶2‚àíj ‚àóœáQ)œá(5‚àönQ)c

2
L2.
Since the functions appearing inside the sum in the Ô¨Årst term have supports with
bounded overlap, we obtain
 ‚àë
Q‚ààD0
(Avg
Q
f)(Œ¶2‚àíj ‚àóœáQ ‚àíœáQ)œá5‚àönQ

2
L2 ‚â§C ‚àë
Q‚ààD0
(Avg
Q
| f|)2Œ¶2‚àíj ‚àóœáQ ‚àíœáQ
2
L2,
and the crucial observation is that
Œ¶2‚àíj ‚àóœáQ ‚àíœáQ
2
L2 ‚â§C2‚àíj,
a consequence of Plancherel‚Äôs identity and the fact that |1 ‚àí1Œ¶(2‚àíjŒæ)| ‚â§œá|Œæ|‚â•2 j.
Putting these observations together, we deduce
 ‚àë
Q‚ààD0
(Avg
Q
f)(Œ¶2‚àíj ‚àóœáQ ‚àíœáQ)œá3Q

2
L2 ‚â§C ‚àë
Q‚ààD0
(Avg
Q
| f|)22‚àíj ‚â§C2‚àíjf
2
L2,
and the required conclusion will be proved if we can show that
 ‚àë
Q‚ààD0
(Avg
Q
f)(Œ¶2‚àíj ‚àóœáQ)œá(3Q)c

2
L2 ‚â§C2‚àíjf
2
L2.
(6.4.20)
We prove (6.4.20) by using an estimate based purely on size. Let cQ be the center of
the dyadic cube Q. For x /‚àà3Q we have the estimate
|(Œ¶2‚àíj ‚àóœáQ)(x)| ‚â§
CM2jn
(1+2j|x‚àícQ|)M ‚â§
CM2jn
(1+2j)M/2
1
(1+|x‚àícQ|)M/2 ,
since both 2j ‚â•1, and |x‚àícQ| ‚â•1. We now control the left-hand side of (6.4.20) by
2j(2n‚àíM) ‚àë
Q‚ààD0 ‚àë
Q‚Ä≤‚ààD0
(Avg
Q
| f|)(Avg
Q‚Ä≤ | f|)

Rn
CM dx
(1+|x‚àícQ|)
M
2 (1+|x‚àícQ‚Ä≤|)
M
2
‚â§2j(2n‚àíM) ‚àë
Q‚ààD0 ‚àë
Q‚Ä≤‚ààD0
(Avg
Q
| f|)(Avg
Q‚Ä≤ | f|)
(1+|cQ ‚àícQ‚Ä≤|)
M
4

Rn
CM dx
(1+|x‚àícQ|)
M
4 (1+|x‚àícQ‚Ä≤|)
M
4
‚â§2j(2n‚àíM) ‚àë
Q‚ààD0 ‚àë
Q‚Ä≤‚ààD0
CM
(1+|cQ ‚àícQ‚Ä≤|)
M
4

Q | f(y)|2 dy+

Q‚Ä≤ | f(y)|2 dy


474
6 Littlewood‚ÄìPaley Theory and Multipliers
‚â§CM2j(2n‚àíM) ‚àë
Q‚ààD0

Q | f(y)|2 dy
= CM2j(2n‚àíM)f
2
L2.
By taking M large enough, we obtain (6.4.20) and thus (6.4.19).
‚ñ°
Exercises
6.4.1. (a) Prove that no dyadic cube in Rn contains the point 0 in its interior.
(b) Prove that every interval [a,b] is contained in the union of three dyadic intervals
of length less than b‚àía.
(c) Prove that every cube of length l in Rn is contained in the union of 3n dyadic
cubes, each having length less than l.
6.4.2. Let k ‚ààZ. Show that the set [m2‚àík,(m + s)2‚àík) is a dyadic interval if and
only if s = 2p for some p ‚ààZ and m is an integer multiple of s.
6.4.3. Given a cube Q in Rn of side length ‚Ñì(Q) ‚â§2k‚àí1 for some integer k, prove
that there is a dyadic cube DQ of side length 2k such that Q ‚´ÖœÉ + DQ for some
œÉ = (œÉ1,...,œÉn), where œÉj ‚àà{0,1/3,‚àí1/3}.
6.4.4. Show that the martingale maximal function f ‚Üísupk‚ààZ |Ek( f)| is weak type
(1,1) with constant at most 1.

Hint: Use Exercise 2.1.12.

6.4.5. (a) Show that EN( f) ‚Üíf a.e. as N ‚Üí‚àûfor all f ‚ààL1
loc(Rn).
(b) Prove that EN( f) ‚Üíf in Lp as N ‚Üí‚àûfor all f ‚ààLp(Rn) whenever 1 < p < ‚àû.
6.4.6. (a) Let k,k‚Ä≤ ‚ààZ be such that k Ã∏= k‚Ä≤. Show that for functions f and g in L2(Rn)
we have
4
Dk( f),Dk‚Ä≤(g)
5
= 0.
(b) Conclude that for functions f j in L2(Rn) we have
 ‚àë
j‚ààZ
Dj( f j)

L2(Rn) =

‚àë
j‚ààZ
Dj( f j)
2
L2(Rn)
 1
2 .
(c) Let Œî j and C be as in the statement of Theorem 6.4.8. Show that for any r ‚ààZ
we have
 ‚àë
j‚ààZ
DjŒî j+rDj

L2(Rn)‚ÜíL2(Rn) ‚â§C2‚àí1
2 |r| .
6.4.7. ([133]) Let Dj, Œî j be as in Theorem 6.4.8.
(a) Prove that the operator
Vr = ‚àë
j‚ààZ
DjŒî j+r
is bounded from L2(Rn) to itself with norm at most a multiple of 2‚àí1
2 |r|.

6.5 The Spherical Maximal Function
475
(b) Show that Vr is Lp(Rn) bounded for all 1 < p < ‚àûwith a constant depending
only on p and n.
(c) Conclude that for each 1 < p < ‚àûthere is a constant cp > 0 such that Vr is
bounded on Lp(Rn) with norm at most a multiple of 2‚àícp |r|.

Hint: Part (a): Write Œî j = Œî j #Œî j, where #Œî j is another family of Littlewood‚ÄìPaley
operators and use Exercise 6.4.6 (b). Part (b): Use duality and (6.1.21).

6.5 The Spherical Maximal Function
In this section we discuss yet another consequence of the Littlewood‚ÄìPaley theory,
the boundedness of the spherical maximal operator.
6.5.1 Introduction of the Spherical Maximal Function
We denote throughout this section by dœÉ the normalized Lebesgue measure on the
sphere Sn‚àí1. For f in Lp(Rn), 1 ‚â§p ‚â§‚àû, we deÔ¨Åne the maximal operator
M ( f)(x) = sup
t>0


Sn‚àí1 f(x‚àítŒ∏)dœÉ(Œ∏)

(6.5.1)
and we observe that by Minkowski‚Äôs integral inequality each expression inside the
supremum in (6.5.1) is well deÔ¨Åned for f ‚ààLp for almost all x ‚ààRn. The operator
M is called the spherical maximal function. It is unclear at this point for which
functions f we have M ( f) < ‚àûa.e. and for which values of p < ‚àûthe maximal
inequality
M ( f)

Lp(Rn) ‚â§Cp
f

Lp(Rn)
(6.5.2)
holds for all functions f ‚ààLp(Rn).
Spherical averages often make their appearance as solutions of partial differential
equations. For instance, the spherical average
u(x,t) = 1
4œÄ

S2 t f(x‚àíty)dœÉ(y)
(6.5.3)
is a solution of the wave equation
Œîx(u)(x,t) = ‚àÇ2u
‚àÇt2 (x,t),
u(x,0) = 0,
‚àÇu
‚àÇt (x,0) = f(x),

476
6 Littlewood‚ÄìPaley Theory and Multipliers
in R3. The introduction of the spherical maximal function is motivated by the fact
that the related spherical average
u(x,t) = 1
4œÄ

S2 f(x‚àíty)dœÉ(y)
(6.5.4)
solves Darboux‚Äôs equation
Œîx(u)(x,t) = ‚àÇ2u
‚àÇt2 (x,t)+ 2
t
‚àÇu
‚àÇt (x,t),
u(x,0) = f(x),
‚àÇu
‚àÇt (x,0) = 0,
in R3. It is rather remarkable that the Fourier transform can be used to study almost
everywhere convergence for several kinds of maximal averaging operators such as
the spherical averages in (6.5.4). This is achieved via the boundedness of the cor-
responding maximal operator; the maximal operator controlling the averages over
Sn‚àí1 is given in (6.5.1).
Before we begin the analysis of the spherical maximal function, we recall that
2
dœÉ(Œæ) =
2œÄ
|Œæ|
n‚àí2
2
J n‚àí2
2 (2œÄ|Œæ|),
as shown in Appendix B.4. Using the estimates in Appendices B.6 and B.7 and the
identity
d
dt JŒΩ(t) = 1
2(JŒΩ‚àí1(t)‚àíJŒΩ+1(t))
derived in Appendix B.2, we deduce the crucial estimate
|2
dœÉ(Œæ)|+|‚àá2
dœÉ(Œæ)| ‚â§
Cn
(1+|Œæ|)
n‚àí1
2
.
(6.5.5)
Theorem 6.5.1. Let n ‚â•3. For each
n
n‚àí1 < p ‚â§‚àû, there is a constant Cp such that
M ( f)

Lp(Rn) ‚â§Cp
f

Lp(Rn)
(6.5.6)
holds for all f in Lp(Rn). Consequently, for all
n
n‚àí1 < p ‚â§‚àûand f ‚ààLp(Rn) we
have
lim
t‚Üí0
1
œân‚àí1

Sn‚àí1 f(x‚àítŒ∏)dœÉ(Œ∏) = f(x)
(6.5.7)
for almost all x ‚ààRn. Here we set œân‚àí1 = |Sn‚àí1|.

6.5 The Spherical Maximal Function
477
The proof of this theorem is given in the rest of this section. Before we present the
proof we explain the validity of (6.5.7). Clearly this assertion is valid for functions
f ‚ààS (Rn). Using inequality (6.5.6) and Theorem 2.1.14 we obtain that (6.5.7) holds
for all functions in f ‚ààLp(Rn).
We now focus on (6.5.6). DeÔ¨Åne m(Œæ) = 2
dœÉ(Œæ) and notice that m(Œæ) is a C ‚àû
function. To study the maximal multiplier operator
sup
t>0
 1f(Œæ)m(tŒæ)
‚à®
we decompose the multiplier m(Œæ) into radial pieces as follows: We Ô¨Åx a radial C ‚àû
function œï0 in Rn such that œï0(Œæ) = 1 when |Œæ| ‚â§1 and œï0(Œæ) = 0 when |Œæ| ‚â•2.
For j ‚â•1 we let
œïj(Œæ) = œï0(2‚àíjŒæ)‚àíœï0(21‚àíjŒæ)
(6.5.8)
and we observe that œïj(Œæ) is localized near |Œæ| ‚âà2j. Then we have
‚àû
‚àë
j=0
œïj = 1.
Set mj = œïjm for all j ‚â•0. The mj‚Äôs are C ‚àû
0 functions that satisfy
m =
‚àû
‚àë
j=0
mj .
Also, the following estimate is valid:
M ( f) ‚â§
‚àû
‚àë
j=0
M j( f),
where
M j( f)(x) = sup
t>0
 1f(Œæ)mj(tŒæ)
‚à®(x)
.
Since the function m0 is C ‚àû
0 , we have that M0 maps Lp to itself for all 1 < p ‚â§‚àû.
(See Exercise 6.5.1.)
We deÔ¨Åne g-functions associated with mj as follows:
Gj( f)(x) =
 ‚àû
0 |Aj,t( f)(x)|2 dt
t
1
2
,
where Aj,t( f)(x) =
 1f(Œæ)mj(tŒæ)
‚à®(x).

478
6 Littlewood‚ÄìPaley Theory and Multipliers
6.5.2 The First Key Lemma
We have the following lemma:
Lemma 6.5.2. There is a constant C = C(n) < ‚àûsuch that for any j ‚â•1 we have
the estimate
M j( f)

L2 ‚â§C2( 1
2 ‚àín‚àí1
2 ) jf

L2
for all functions f in L2(Rn).
Proof. We deÔ¨Åne a function
#mj(Œæ) = Œæ ¬∑‚àámj(Œæ),
we let #Aj,t( f)(x) =
 1f(Œæ) #mj(tŒæ)
‚à®(x), and we let
#Gj( f)(x) =
 ‚àû
0 |#Aj,t( f)(x)|2 dt
t
1
2
be the associated g-function. For f ‚ààL2(Rn), the identity
s dAj,s
ds ( f) = #Aj,s( f)
is clearly valid for all j and s. Since Aj,s( f) = f ‚àó(m‚à®
j )s and m‚à®
j has integral zero for
j ‚â•1 (here (m‚à®
j )s(x) = s‚àínm‚à®
j (s‚àí1x)), it follows from Corollary 2.1.19 that
lim
s‚Üí0Aj,s( f)(x) = 0
for all x ‚ààRn \Ef , where Ef is some set of Lebesgue measure zero. By the funda-
mental theorem of calculus for x ‚ààRn \Ef we deduce that
(Aj,t( f)(x))2 =
 t
0
d
ds(Aj,s( f)(x))2 ds
= 2
 t
0 Aj,s( f)(x)sdAj,s
ds ( f)(x) ds
s
= 2
 t
0 Aj,s( f)(x)#Aj,s( f)(x) ds
s ,
from which we obtain the estimate
Aj,t( f)(x)
2 ‚â§2
 ‚àû
0
Aj,s( f)(x)
#Aj,s( f)(x)
 ds
s .
(6.5.9)

6.5 The Spherical Maximal Function
479
Taking the supremum over all t > 0 on the left-hand side in (6.5.9) and integrating
over Rn, we obtain the estimate
M j( f)
2
L2 ‚â§2

Rn
 ‚àû
0
Aj,s( f)(x)
#Aj,s( f)(x)
 ds
s dx
‚â§2

Rn Gj( f)(x) #Gj( f)(x)dx
‚â§2
Gj( f)

L2
 #Gj( f)

L2 ,
by applying the Cauchy‚ÄìSchwarz inequality twice. Next we claim that as a conse-
quence of (6.5.5) we have for some c,#c < ‚àû,
mj

L‚àû‚â§c2‚àíj n‚àí1
2
and
#mj

L‚àû‚â§#c2j(1‚àín‚àí1
2 ) .
Using these facts together with the facts that the functions mj and #mj are sup-
ported in the annuli 2 j‚àí1 ‚â§|Œæ| ‚â§2j+1, we obtain that the g-functions Gj and #Gj
are L2 bounded with norms at most a constant multiple of the quantities 2‚àíj n‚àí1
2 and
2j(1‚àín‚àí1
2 ), respectively; see Exercise 6.5.2. Note that since n ‚â•3, both exponents are
negative. We conclude that
M j( f)

L2 ‚â§C2j( 1
2 ‚àín‚àí1
2 )f

L2 ,
which is what we needed to prove.
‚ñ°
6.5.3 The Second Key Lemma
Next we need the following lemma.
Lemma 6.5.3. There exists a constant C = C(n) < ‚àûsuch that for all j ‚â•1 and for
all f in L1(Rn) we have
M j( f)

L1,‚àû‚â§C2jf

L1 .
Proof. Let K( j) = (œïj)‚à®‚àódœÉ = Œ¶2‚àíj ‚àódœÉ, where Œ¶ is a Schwartz function. Setting
(K( j))t(x) = t‚àínK( j)(t‚àí1x)
we have that
M j( f) = sup
t>0
|(K( j))t ‚àóf|.
(6.5.10)
The proof of the lemma is based on the estimate:
M j( f) ‚â§C2j M( f)
(6.5.11)

480
6 Littlewood‚ÄìPaley Theory and Multipliers
and the weak type (1,1) boundedness of the Hardy‚ÄìLittlewood maximal operator M
(Theorem 2.1.6). To establish (6.5.11), it sufÔ¨Åces to show that for any M > n there is
a constant CM < ‚àûsuch that
|K( j)(x)| = |(Œ¶2‚àíj ‚àódœÉ)(x)| ‚â§
CM 2j
(1+|x|)M .
(6.5.12)
Then Theorem 2.1.10 yields (6.5.11) and hence the required conclusion.
Using the fact that Œ¶ is a Schwartz function, we have for every N > 0,
|(Œ¶2‚àíj ‚àódœÉ)(x)| ‚â§CN

Sn‚àí1
2n j dœÉ(y)
(1+2j|x‚àíy|)N .
We pick an N to depend on M (6.5.12); in fact, any N > M sufÔ¨Åces for our purposes.
We split the last integral into the regions
S‚àí1(x) = Sn‚àí1 ‚à©{y ‚ààRn : 2j|x‚àíy| ‚â§1}
and for r ‚â•0,
Sr(x) = Sn‚àí1 ‚à©{y ‚ààRn : 2r < 2j|x‚àíy| ‚â§2r+1}.
The key observation is that whenever B(y,R) is a ball of radius R in Rn centered at
y ‚ààSn‚àí1, then the spherical measure of the set Sn‚àí1 ‚à©B(y,R) is at most a dimen-
sional constant multiple of Rn‚àí1. This implies that the spherical measure of each
Sr(x) is at most cn2(r+1‚àíj)(n‚àí1), an estimate that is useful only when r ‚â§j. Using
this observation, together with the fact that for y ‚ààSr(x) we have |x| ‚â§2r+1‚àíj + 1,
we obtain the following estimate for the expression |(Œ¶2‚àíj ‚àódœÉ)(x)|:
j
‚àë
r=‚àí1

Sr(x)
CN2n j dœÉ(y)
(1+2j|x‚àíy|)N +
‚àû
‚àë
r= j+1

Sr(x)
CN2n j dœÉ(y)
(1+2j|x‚àíy|)N
‚â§C‚Ä≤
N2n j

j
‚àë
r=‚àí1
dœÉ(Sr(x))œáB(0,3)(x)
2rN
+
‚àû
‚àë
r= j+1
dœÉ(Sr(x))œáB(0,2r+1‚àíj+1)(x)
2rN

‚â§C‚Ä≤
N2n j

j
‚àë
r=‚àí1
cn2(r+1‚àíj)(n‚àí1)œáB(0,3)(x)
2rN
+
‚àû
‚àë
r= j+1
œân‚àí1 œáB(0,2r+2‚àíj)(x)
2rN

‚â§CN,n

2jœáB(0,3)(x)+2n j
‚àû
‚àë
r= j+1
1
2rN
(1+2r+2‚àíj)M
(1+|x|)M

‚â§C‚Ä≤
M,n
2j
(1+|x|)M

1+
‚àû
‚àë
r= j+1
2(r‚àíj)(M‚àíN)
2j(N+1‚àín)

‚â§
C‚Ä≤‚Ä≤
M,n2j
(1+|x|)M ,
where we used that N > M > n. This establishes (6.5.12).
‚ñ°

6.5 The Spherical Maximal Function
481
6.5.4 Completion of the Proof
It remains to combine the previous ingredients to complete the proof of the theorem.
Interpolating between the L2 ‚ÜíL2 and L1 ‚ÜíL1,‚àûestimates obtained in Lemmas
6.5.2 and 6.5.3, we obtain
M j( f)

Lp(Rn) ‚â§Cp2( n
p ‚àí(n‚àí1)) j f

Lp(Rn)
for all 1 < p ‚â§2. When p >
n
n‚àí1 the series ‚àë‚àû
j=1 2( n
p ‚àí(n‚àí1)) j converges and we
conclude that M is Lp bounded for these p‚Äôs. The boundedness of M on Lp for
p > 2 follows by interpolation between Lq for q < 2 and the estimate M : L‚àû‚ÜíL‚àû.
Exercises
6.5.1. Let m be in L1(Rn)‚à©L‚àû(Rn) that satisÔ¨Åes |m‚à®(x)| ‚â§C(1+|x|)‚àín‚àíŒ¥ for some
Œ¥ > 0. Show that the maximal multiplier
Mm( f)(x) = sup
t>0
 1f(Œæ)m(tŒæ)
‚à®(x)

is Lp bounded for all 1 < p < ‚àû.
6.5.2. Suppose that the function m is supported in the annulus R ‚â§|Œæ| ‚â§2R and is
bounded by A. Show that the g-function
G( f)(x) =
 ‚àû
0 |(m(tŒæ) 1f(Œæ))‚à®(x)|2 dt
t
1
2
maps L2(Rn) to L2(Rn) with bound at most A‚àölog2.
6.5.3. ([302]) Let A,a,b > 0 with a+b > 1. Use the idea of Lemma 6.5.2 to show
that if m(Œæ) satisÔ¨Åes |m(Œæ)| ‚â§A(1 + |Œæ|)‚àía and |‚àám(Œæ)| ‚â§A(1 + |Œæ|)‚àíb for all
Œæ ‚ààRn, then the maximal operator
Mm( f)(x) = sup
t>0
 1f(Œæ)m(tŒæ)
‚à®(x)

is bounded from L2(Rn) to itself.

Hint: Use that
Mm ‚â§
‚àû
‚àë
j=0
Mm, j ,
where Mm, j corresponds to the multiplier œïjm; here œïj is as in (6.5.8). Show that
Mm, j( f)

L2 ‚â§C
œïjm

1
2
L‚àû
œïj #m

1
2
L‚àû
 f

L2 ‚â§C2j 1‚àí(a+b)
2
f

L2,
where #m(Œæ) = Œæ ¬∑‚àám(Œæ).


482
6 Littlewood‚ÄìPaley Theory and Multipliers
6.5.4. Let A,c > 0, a > 1/2, 0 < b < n. Follow the idea of the proof of Theorem
6.5.1 to obtain the following more general result: If dŒº is a Ô¨Ånite Borel measure
supported in the closed unit ball that satisÔ¨Åes |2
dŒº(Œæ)| ‚â§A(1+|Œæ|)‚àía for all Œæ ‚ààRn
and dŒº(B(y,R)) ‚â§cRb for all R > 0, then the maximal operator
f ‚Üísup
t>0


Rn f(x‚àíty)dŒº(y)

maps Lp(Rn) to itself when p > 2n‚àí2b+2a‚àí1
n‚àíb+2a‚àí1 .

Hint: Using the notation of the preceding exercise, show that ‚à•Mm, j( f)‚à•L2 ‚â§
C2j( 1
2 ‚àía)‚à•f‚à•L2 and that ‚à•Mm, j( f)‚à•L1,‚àû‚â§C2j(n‚àíb)‚à•f‚à•L1 for all j ‚ààZ+, where C
is a constant depending on the given parameters.

6.5.5. Show that Theorem 6.5.1 is false when n = 1, that is, show that the maximal
operator
M1( f)(x) = sup
t>0
| f(x+t)+ f(x‚àít)|
2
is unbounded on Lp(R) for all p < ‚àû.
6.5.6. Show that when n ‚â•2 and p ‚â§
n
n‚àí1 there exists an Lp(Rn) function f such
that M ( f)(x) = ‚àûfor all x ‚ààRn. Hence Theorem 6.5.1 is false is this case.

Hint: Choose a compactly supported and radial function equal to |y|1‚àín(‚àílog|y|)‚àí1
when |y| ‚â§1/2.

6.6 Wavelets and Sampling
In this section we construct orthonormal bases of L2(R) generated by translations
and dilations of a single function. An example of such base is given by the Haar
functions we encountered in Section 6.4. The Haar functions are generated by in-
teger translations and dyadic dilations of the single function œá[0, 1
2 ) ‚àíœá[ 1
2 ,1). This
function is not smooth, and the main question addressed in this section is whether
there exist smooth analogues of the Haar functions.
DeÔ¨Ånition 6.6.1. A square integrable function œï on Rn is called a wavelet if the
family of functions
œïŒΩ,k(x) = 2
ŒΩn
2 œï(2ŒΩx‚àík),
where ŒΩ ranges over Z and k over Zn, is an orthonormal basis of L2(Rn). This
means that the functions œïŒΩ,k are mutually orthogonal and span L2(Rn), and œï is
normalized to have L2 norm equal to 1. Note that the Fourier transform of œïŒΩ,k is
given by
3
œïŒΩ,k(Œæ) = 2‚àíŒΩn
2 1œï(2‚àíŒΩŒæ)e‚àí2œÄi2‚àíŒΩŒæ¬∑k .
(6.6.1)

6.6 Wavelets and Sampling
483
Rephrasing the question posed earlier, the main issue addressed in this section is
whether smooth wavelets actually exist. Before we embark on this topic, we recall
that we have already encountered examples of nonsmooth wavelets.
Example 6.6.2. (The Haar wavelet) Recall the family of functions
hI(x) = |I|‚àí1
2 (œáIL ‚àíœáIR),
where I ranges over D (the set of all dyadic intervals) and IL is the left part of I and
IR is the right part of I. Note that if I = [2‚àíŒΩk,2‚àíŒΩ(k +1)), then
hI(x) = 2
ŒΩ
2 œï(2ŒΩx‚àík),
where
œï(x) = œá[0, 1
2 ) ‚àíœá[ 1
2 ,1) .
(6.6.2)
The single function œï in (6.6.2) therefore generates the Haar basis by taking trans-
lations and dilations. Moreover, we observed in Section 6.4 that the family {hI}I is
orthonormal. Moreover, in Theorem 6.4.6 we obtained the representation
f = ‚àë
I‚ààD
4
f,hI
5
hI
in L2 ,
which proves the completeness of the system {hI}I‚ààD in L2(R).
6.6.1 Some Preliminary Facts
Before we look at more examples, we make some observations. We begin with the
following useful fact.
Proposition 6.6.3. Let g ‚ààL1(Rn). Then
1g(m) = 0
for all m ‚ààZn \{0}
if and only if
‚àë
k‚ààZn
g(x+k) =

Rn g(t)dt
for almost all x ‚ààTn.
Proof. We deÔ¨Åne the periodic function
G(x) = ‚àë
k‚ààZn
g(x+k),

484
6 Littlewood‚ÄìPaley Theory and Multipliers
which is easily shown to be in L1(Tn). Moreover, we have
1G(m) = 1g(m)
for all m ‚ààZn, where 1G(m) denotes the mth Fourier coefÔ¨Åcient of G and 1g(m) de-
notes the Fourier transform of g at Œæ = m. If 1g(m) = 0 for all m ‚ààZn \ {0}, then
all the Fourier coefÔ¨Åcients of G (except for m = 0) vanish, which means that the
sequence { 1G(m)}m‚ààZn lies in ‚Ñì1(Zn) and hence Fourier inversion applies. We con-
clude that for almost all x ‚ààTn we have
G(x) = ‚àë
m‚ààZn
1G(m)e2œÄim¬∑x = 1G(0) = 1g(0) =

Rn g(t)dt .
Conversely, if G is a constant, then 1G(m) = 0 for all m ‚ààZn \{0}, and so the same
holds for g.
‚ñ°
A consequence of the preceding proposition is the following.
Proposition 6.6.4. Let œï ‚ààL2(Rn). Then the sequence
{œï(x‚àík)}k‚ààZn
(6.6.3)
forms an orthonormal set in L2(Rn) if and only if
‚àë
k‚ààZn
|1œï(Œæ +k)|2 = 1
(6.6.4)
for almost all Œæ ‚ààRn.
Proof. Observe that either (6.6.4) or the hypothesis that the sequence in (6.6.3) is
orthonormal implies that ‚à•œï‚à•L2 = 1. Also the orthonormality condition

Rn œï(x‚àíj)œï(x‚àík)dx =

1
when j = k,
0
when j Ã∏= k,
is equivalent to

Rn e‚àí2œÄik¬∑Œæ 1œï(Œæ)e‚àí2œÄi j¬∑Œæ 1œï(Œæ)dŒæ = (|1œï|2)1(k ‚àíj) =

1
when j = k,
0
when j Ã∏= k,
in view of Parseval‚Äôs identity. Proposition 6.6.3 with g(Œæ) = |1œï(Œæ)|2 gives that the
latter is equivalent to
‚àë
k‚ààZn
|1œï(Œæ +k)|2 =

Rn |1œï(t)|2 dt = 1
for almost all Œæ ‚ààRn.
‚ñ°

6.6 Wavelets and Sampling
485
Corollary 6.6.5. Let œï ‚ààL2(Rn) and suppose that the sequence
{œï(x‚àík)}k‚ààZn
(6.6.5)
forms an orthonormal set in L2(Rn). Then the measure of the support of 1œï is at least
1, that is,
|supp 1œï| ‚â•1.
(6.6.6)
Moreover, if |supp 1œï| = 1, then |1œï(Œæ)| = 1 for almost all Œæ ‚ààsupp 1œï.
Proof. It follows from (6.6.4) that |1œï| ‚â§1 for almost all Œæ ‚ààRn and thus
|supp 1œï| ‚â•

Rn |1œï(Œæ)|2 dŒæ =

[0,1)n ‚àë
k‚ààZn
|1œï(Œæ +k)|2 dŒæ =

[0,1)n 1dŒæ = 1.
If equality holds in (6.6.6), then equality holds in the preceding inequality, and since
|1œï| ‚â§1 a.e., it follows that |1œï(Œæ)| = 1 for almost all Œæ in supp 1œï.
‚ñ°
6.6.2 Construction of a Nonsmooth Wavelet
Having established these preliminary facts, we now start searching for examples of
wavelets. It follows from Corollary 6.6.5 that the support of the Fourier transform of
a wavelet must have measure at least 1. It is reasonable to ask whether this support
can have measure exactly 1. Example 6.6.6 indicates that this can indeed happen. As
dictated by the same corollary, the Fourier transform of such a wavelet must satisfy
|1œï(Œæ)| = 1 for almost all Œæ ‚ààsupp 1œï, so it is natural to look for a wavelet œï such
that 1œï = œáA for some set A. We can start by asking whether the function
1œï = œá[‚àí1
2 , 1
2 ]
on R is an appropriate Fourier transform of a wavelet, but a moment‚Äôs thought shows
that the functions œïŒº,0 and œïŒΩ,0 cannot be orthogonal to each other when Œº Ã∏= 0.
The problem here is that the Fourier transforms of the functions œïŒΩ,k cluster near
the origin and do not allow for the needed orthogonality. We can Ô¨Åx this problem
by considering a function whose Fourier transform vanishes near the origin. Among
such functions, a natural candidate is
œá[‚àí1,‚àí1
2 ) + œá[ 1
2 ,1) ,
(6.6.7)
which is indeed the Fourier transform of a wavelet.
Example 6.6.6. Let A = [‚àí1,‚àí1
2)[ 1
2,1) and deÔ¨Åne a function œï on R by setting
1œï = œáA .

486
6 Littlewood‚ÄìPaley Theory and Multipliers
Then we assert that the family of functions
{œïŒΩ,k(x)}k‚ààZ,ŒΩ‚ààZ = {2ŒΩ/2œï(2ŒΩx‚àík)}k‚ààZ,ŒΩ‚ààZ
is an orthonormal basis of L2(R) (i.e., the function œï is a wavelet). This is an exam-
ple of a wavelet with minimally supported frequency.
To verify this assertion, Ô¨Årst note that {œï0,k}k‚ààZ is an orthonormal set, since
(6.6.4) is easily seen to hold. Dilating by 2ŒΩ, it follows that {œïŒΩ,k}k‚ààZ is also an
orthonormal set for every Ô¨Åxed ŒΩ ‚ààZ. Next, observe that if Œº Ã∏= ŒΩ, then
supp 3
œïŒΩ,k ‚à©supp 3
œïŒº,l = /0.
(6.6.8)
This implies that the family {2ŒΩ/2œï(2ŒΩx‚àík)}k‚ààZ,ŒΩ‚ààZ is also orthonormal.
Next, we observe that the completeness of {œïŒΩ,k}ŒΩ,k‚ààZ is equivalent to that of
{3
œïŒΩ,k(Œæ)}ŒΩ,k‚ààZ = {2‚àíŒΩ/2e‚àí2œÄikŒæ2‚àíŒΩ œá2ŒΩA(Œæ)}ŒΩ,k‚ààZ. Let f ‚ààL2(R), Ô¨Åx any ŒΩ ‚ààZ,
and deÔ¨Åne
h(Œæ) = 2ŒΩ/2 f(2ŒΩŒæ).
Suppose that for all k ‚ààZ,
0 = ‚ü®f, 3
œïŒΩ,k‚ü©=

2ŒΩA f(Œæ)2‚àíŒΩ/2e‚àí2œÄikŒæ2‚àíŒΩdŒæ
=

A 2ŒΩ/2 f(2ŒΩŒæ)e‚àí2œÄikŒædŒæ
= ‚ü®œáAh,e‚àí2œÄikŒæ‚ü©.
Exercise 6.6.1(a) shows {e‚àí2œÄikŒæ}k‚ààZ is an orthonormal basis of L2(A), and there-
fore œáAh = 0 almost everywhere. From the deÔ¨Ånition of h it follows that œá2ŒΩA f = 0
almost everywhere. Now suppose for all ŒΩ,k ‚ààZ
0 = ‚ü®f, 3
œïŒΩ,k‚ü©.
Then œá2ŒΩA f = 0 almost everywhere for all ŒΩ ‚ààZ. Since ‚à™ŒΩ‚ààZ2ŒΩA = R \ {0}, it
follows that f = 0 almost everywhere. We conclude {3
œïŒΩ,k}ŒΩ,k‚ààZ is complete.
6.6.3 Construction of a Smooth Wavelet
The wavelet basis of L2(Rn) constructed in Example 6.6.6 is forced to have slow
decay at inÔ¨Ånity, since the Fourier transforms of the elements of the basis are non-
smooth. Smoothing out the function 1œï but still expecting œï to be wavelet is a bit
tricky, since property (6.6.8) may be violated when Œº Ã∏= ŒΩ, and moreover, (6.6.4)
may be destroyed. These two obstacles are overcome by the careful construction of
the next theorem.

6.6 Wavelets and Sampling
487
Theorem 6.6.7. There exists a Schwartz function œï on the real line that is a wavelet,
that is, the collection of functions {œïŒΩ,k}k,ŒΩ‚ààZ with œïŒΩ,k(x) = 2
ŒΩ
2 œï(2ŒΩx ‚àík) is an
orthonormal basis of L2(R). Moreover, the function œï can be constructed so that its
Fourier transform satisÔ¨Åes
supp 1œï ‚äÜ

‚àí4
3,‚àí1
3

‚à™
 1
3, 4
3

.
(6.6.9)
Note that in view of condition (6.6.9), the function œï must have vanishing mo-
ments of all orders.
Proof. We start with an odd smooth real-valued function Œò on the real line such that
Œò(t) = œÄ
4 for t ‚â•1
6 and such that Œò is strictly increasing on the interval

‚àí1
6, 1
6

.
We set
Œ±(t) = sin(Œò(t)+ œÄ
4 ),
Œ≤(t) = cos(Œò(t)+ œÄ
4 ),
and we observe that
Œ±(t)2 +Œ≤(t)2 = 1
and that
Œ±(‚àít) = Œ≤(t)
for all real t. Next we introduce the smooth function œâ deÔ¨Åned via
œâ(t) =
‚éß
‚é™
‚é™
‚é™
‚é®
‚é™
‚é™
‚é™
‚é©
Œ≤(‚àít
2 ‚àí1
2) = Œ±( t
2 + 1
2)
when t ‚àà

‚àí4
3,‚àí2
3

,
Œ±(‚àít ‚àí1
2) = Œ≤(t + 1
2)
when t ‚àà

‚àí2
3,‚àí1
3

,
Œ±(t ‚àí1
2)
when t ‚àà
 1
3, 2
3

,
Œ≤( t
2 ‚àí1
2)
when t ‚àà
 2
3, 4
3

,
on the interval

‚àí4
3,‚àí1
3
 1
3, 4
3

. Note that œâ is an even function. Finally we deÔ¨Åne
the function œï by letting
1œï(Œæ) = e‚àíœÄiŒæœâ(Œæ),
and we note that
œï(x) =

R œâ(Œæ)e2œÄiŒæ(x‚àí1
2 )dŒæ = 2
 ‚àû
0 œâ(Œæ)cos

2œÄ(x‚àí1
2)Œæ

dŒæ .
It follows that the function œï is symmetric about the number 1
2, that is, we have
œï(x) = œï(1‚àíx)
for all x ‚ààR. Note that œï is a Schwartz function whose Fourier transform is sup-
ported in the set

‚àí4
3,‚àí1
3
 1
3, 4
3

.
Having deÔ¨Åned œï, we proceed by showing that it is a wavelet. In view of identity
(6.6.1) we have that 3
œïŒΩ,k is supported in the set 1
32ŒΩ ‚â§|Œæ| ‚â§4
32ŒΩ, while 3
œïŒº, j is
supported in the set 1
32Œº ‚â§|Œæ| ‚â§4
32Œº. The intersection of these sets has measure
zero when |Œº ‚àíŒΩ| ‚â•2, which implies that such wavelets are orthogonal to each
other. Therefore, it sufÔ¨Åces to verify orthogonality between adjacent scales (i.e.,
when ŒΩ = Œº and ŒΩ = Œº +1).

488
6 Littlewood‚ÄìPaley Theory and Multipliers
We begin with the case ŒΩ = Œº, which, by a simple dilation, is reduced to the case
ŒΩ = Œº = 0. Thus to obtain the orthogonality of the functions œï0,k(x) = œï(x‚àík) and
œï0, j(x) = œï(x‚àíj), in view of Proposition 6.6.4, it sufÔ¨Åces to show that
‚àë
k‚ààZ
|1œï(Œæ +k)|2 = 1.
(6.6.10)
Since the sum in (6.6.10) is 1-periodic, we check that is equal to 1 only for Œæ in
 1
3, 4
3

. First for Œæ ‚àà
 1
3, 2
3

, the sum in (6.6.10) is equal to
|1œï(Œæ)|2 +|1œï(Œæ ‚àí1)|2 = œâ(Œæ)2 +œâ(Œæ ‚àí1)2
= Œ±(Œæ ‚àí1
2)2 +Œ≤((Œæ ‚àí1)+ 1
2)2
= 1
from the deÔ¨Ånition of œâ. A similar argument also holds for Œæ ‚àà
 2
3, 4
3

, and this
completes the proof of (6.6.10). As a consequence of this identity we also obtain
that the functions œï0,k have L2 norm equal to 1, and thus so have the functions œïŒΩ,k,
via a change of variables.
Next we prove the orthogonality of the functions œïŒΩ,k and œïŒΩ+1, j for general
ŒΩ,k, j ‚ààZ. We begin by observing the validity of the following identity:
1œï(Œæ)1œï( Œæ
2 ) =

e‚àíœÄiŒæ/2Œ≤( Œæ
2 ‚àí1
2)Œ±( Œæ
2 ‚àí1
2)
when 2
3 ‚â§Œæ ‚â§4
3,
e‚àíœÄiŒæ/2Œ±( Œæ
2 + 1
2)Œ≤( Œæ
2 + 1
2)
when ‚àí4
3 ‚â§Œæ ‚â§‚àí2
3.
(6.6.11)
Indeed, from the deÔ¨Ånition of œï, it follows that
1œï(Œæ)1œï( Œæ
2 ) = e‚àíœÄiŒæ/2œâ(Œæ)œâ( Œæ
2 ).
This function is supported in
{Œæ ‚ààR : 1
3 ‚â§|Œæ| ‚â§4
3}‚à©{Œæ ‚ààR : 2
3 ‚â§|Œæ| ‚â§8
3} = {Œæ ‚ààR : 2
3 ‚â§|Œæ| ‚â§4
3},
and on this set it is equal to
e‚àíœÄiŒæ/2

Œ≤( Œæ
2 ‚àí1
2)Œ±( Œæ
2 ‚àí1
2)
when 2
3 ‚â§Œæ ‚â§4
3,
Œ±( Œæ
2 + 1
2)Œ≤( Œæ
2 + 1
2)
when ‚àí4
3 ‚â§Œæ ‚â§‚àí2
3,
by the deÔ¨Ånition of œâ. This establishes (6.6.11).
We now turn to the orthogonality of the functions œïŒΩ,k and œïŒΩ+1, j for general
ŒΩ,k, j ‚ààZ. Using (6.6.1) and (6.6.11) we have
4
œïŒΩ,k |œïŒΩ+1, j
5
=
43
œïŒΩ,k | 
œïŒΩ+1, j
5
=

R 2‚àíŒΩ
2 1œï(2‚àíŒΩŒæ)e‚àí2œÄi Œæ k
2ŒΩ 2‚àíŒΩ+1
2 1œï(2‚àí(ŒΩ+1)Œæ)e‚àí2œÄi
Œæ j
2ŒΩ+1 dŒæ

6.6 Wavelets and Sampling
489
=
1
‚àö
2

R
1œï(Œæ)1œï( Œæ
2 )e‚àí2œÄiŒæ(k‚àíj
2 ) dŒæ
=
1
‚àö
2
 ‚àí2
3
‚àí4
3
Œ±( Œæ
2 + 1
2)Œ≤( Œæ
2 + 1
2)e‚àí2œÄiŒæ(k‚àíj
2 + 1
4 ) dŒæ
+
1
‚àö
2

4
3
2
3
Œ±( Œæ
2 ‚àí1
2)Œ≤( Œæ
2 ‚àí1
2)e‚àí2œÄiŒæ(k‚àíj
2 + 1
4 ) dŒæ
= 0,
where the last identity follows from the change of variables Œæ = Œæ ‚Ä≤‚àí2 in the second-
to-last integral, which transforms its range of integration to
 2
3, 4
3

and its integrand
to the negative of that of the last displayed integral.
Our Ô¨Ånal task is to show that the orthonormal system {œïŒΩ,k}ŒΩ,k‚ààZ is complete.
We show this by proving that whenever a square-integrable function f satisÔ¨Åes
4
f |œïŒΩ,k
5
= 0
(6.6.12)
for all ŒΩ,k ‚ààZ, then f must be zero. Suppose that (6.6.12) holds. Plancherel‚Äôs iden-
tity yields

R
1f(Œæ)2‚àíŒΩ
2 1œï(2‚àíŒΩŒæ)e‚àí2œÄi2‚àíŒΩŒæk dŒæ = 0
for all ŒΩ,k and thus

R
1f(2ŒΩŒæ)1œï(Œæ)e2œÄiŒæk dŒæ =
 1f(2ŒΩ(¬∑)) 1œï
1(‚àík) = 0
(6.6.13)
for all ŒΩ,k ‚ààZ. It follows from Proposition 6.6.3 and (6.6.13) (with k = 0) that
‚àë
k‚ààZ
1f(2ŒΩ(Œæ +k))1œï(Œæ +k) =

R
1f(2ŒΩŒæ) 1œï(Œæ)dŒæ =
 1f(2ŒΩ(¬∑)) 1œï
1(0) = 0
for all ŒΩ ‚ààZ.
Next, we show that the identity
‚àë
k‚ààZ
1f(2ŒΩ(Œæ +k))1œï(Œæ +k) = 0
(6.6.14)
for all ŒΩ ‚ààZ implies that 1f is identically equal to zero. Suppose that 1
3 ‚â§Œæ ‚â§2
3. In
this case the support properties of 1œï imply that the only terms in the sum in (6.6.14)
that do not vanish are k = 0 and k = ‚àí1. Thus for 1
3 ‚â§Œæ ‚â§2
3 the identity in (6.6.14)
reduces to
0 = 1f(2ŒΩ(Œæ ‚àí1))1œï(Œæ ‚àí1)+ 1f(2ŒΩŒæ)1œï(Œæ)
= 1f(2ŒΩ(Œæ ‚àí1))eœÄi(Œæ‚àí1)Œ≤((Œæ ‚àí1)+ 1
2)+ 1f(2ŒΩŒæ)eœÄiŒæŒ±(Œæ ‚àí1
2);

490
6 Littlewood‚ÄìPaley Theory and Multipliers
hence
‚àí1f(2ŒΩ(Œæ ‚àí1))Œ≤(Œæ ‚àí1
2)+ 1f(2ŒΩŒæ)Œ±(Œæ ‚àí1
2) = 0,
1
3 ‚â§Œæ ‚â§2
3 .
(6.6.15)
Next we observe that when 2
3 ‚â§Œæ ‚â§4
3, only the terms with k = 0 and k = ‚àí2 survive
in the identity in (6.6.14). This is because when k = ‚àí1, Œæ +k = Œæ ‚àí1 ‚àà

‚àí1
3, 1
3

and
this interval has null intersection with the support of 1œï. Therefore, (6.6.14) reduces
to
0 = 1f(2ŒΩ(Œæ ‚àí2))1œï(Œæ ‚àí2)+ 1f(2ŒΩŒæ)1œï(Œæ)
= 1f(2ŒΩ(Œæ ‚àí2))eœÄi(Œæ‚àí2)Œ±( Œæ‚àí2
2 + 1
2)+ 1f(2ŒΩŒæ)eœÄiŒæŒ≤( Œæ
2 ‚àí1
2);
hence
1f(2ŒΩ(Œæ ‚àí2))Œ±( Œæ
2 ‚àí1
2)+ 1f(2ŒΩŒæ)Œ≤( Œæ
2 ‚àí1
2) = 0,
2
3 ‚â§Œæ ‚â§4
3 .
(6.6.16)
Replacing Ô¨Årst ŒΩ by ŒΩ ‚àí1 and then Œæ
2 by Œæ in (6.6.16), we obtain
1f(2ŒΩ(Œæ ‚àí1))Œ±(Œæ ‚àí1
2)+ 1f(2ŒΩŒæ)Œ≤(Œæ ‚àí1
2) = 0,
1
3 ‚â§Œæ ‚â§2
3 .
(6.6.17)
Now consider the 2 √ó 2 system of equations given by (6.6.15) and (6.6.17) with
unknown 1f(2ŒΩ(Œæ ‚àí1)) and 1f(2ŒΩŒæ). The determinant of the system is
det

‚àíŒ≤(Œæ ‚àí1/2) Œ±(Œæ ‚àí1/2)
Œ±(Œæ ‚àí1/2) Œ≤(Œæ ‚àí1/2)

= ‚àí1 Ã∏= 0.
Therefore, the system has the unique solution
1f(2ŒΩ(Œæ ‚àí1)) = 1f(2ŒΩŒæ) = 0,
which is valid for all ŒΩ ‚ààZ and all Œæ ‚àà[ 1
3, 2
3]. We conclude that 1f(Œæ) = 0 for all Œæ ‚ààR
and thus f = 0. This proves the completeness of the system {œïŒΩ,k}. We conclude that
the function œï is a wavelet.
‚ñ°
6.6.4 Sampling
Next we discuss how one can recover a band-limited function by its values at a
countable number of points.
DeÔ¨Ånition 6.6.8. An integrable function on Rn is called band limited if its Fourier
transform has compact support.
For every band-limited function there is a B > 0 such that its Fourier transform
is supported in the cube [‚àíB,B]n. In such a case we say that the function is band
limited on the cube [‚àíB,B]n.

6.6 Wavelets and Sampling
491
It is an interesting observation that such functions are completely determined by
their values at the points x = k/2B, where k ‚ààZn. We have the following result.
Theorem 6.6.9. (a) Let f in L1(Rn) be band limited on the cube [‚àíB,B]n. Then f
can be sampled by its values at the points x = k/2B, where k ‚ààZn. In particular, we
have
f(x1,...,xn) = ‚àë
k‚ààZn
f
 k
2B
 n
‚àè
j=1
sin(2œÄBxj ‚àíœÄkj)
2œÄBxj ‚àíœÄkj
(6.6.18)
for almost all x ‚ààRn.
(b) Suppose that f is band-limited on the cube [‚àíB‚Ä≤,B‚Ä≤]n where 0 < B‚Ä≤ < B. Then f
can be sampled by its values at the points x = k/2B, k ‚ààZn as follows
f(x1,...,xn) = ‚àë
k‚ààZn
f
 k
2B

Œ¶(x‚àík),
(6.6.19)
for some Schwartz function Œ¶ that depends on B,B‚Ä≤.
Proof. Since the function 1f is supported in [‚àíB,B]n, we use Exercise 6.6.2 to obtain
1f(Œæ) =
1
(2B)n ‚àë
k‚ààZn
11f
 k
2B

e2œÄi k
2B ¬∑Œæ
=
1
(2B)n ‚àë
k‚ààZn
f

‚àík
2B

e2œÄi k
2B ¬∑Œæ .
Inserting this identity in the inversion formula
f(x) =

[‚àíB,B]n
1f(Œæ)e2œÄix¬∑Œæ dŒæ ,
which holds for almost all x ‚ààRn since 1f is continuous and therefore integrable over
[‚àíB,B]n, we obtain
f(x) =

[‚àíB,B]n
1
(2B)n ‚àë
k‚ààZn
f

‚àík
2B

e2œÄi k
2B ¬∑Œæe2œÄix¬∑Œæ dŒæ
= ‚àë
k‚ààZn
f

‚àík
2B

1
(2B)n

[‚àíB,B]n e2œÄi( k
2B +x)¬∑Œæ dŒæ
(6.6.20)
= ‚àë
k‚ààZn
f

‚àík
2B
 n
‚àè
j=1
sin(2œÄBxj +œÄkj)
2œÄBxj +œÄkj
.
(6.6.21)
This is exactly (6.6.18) when we change k to ‚àík and thus part (a) is proved. For part
(b) we argue similarly, except that we replace œá[‚àíB,B]n by 1Œ¶, where 1Œ¶ is smooth,
equal to 1 on [‚àíB‚Ä≤,B‚Ä≤]n and vanishes outside [‚àíB,B]n. Then we can insert the func-
tion 1Œ¶(Œæ) in (6.6.20) and instead of (6.6.21) we obtain the expression on the right
in (6.6.19).
‚ñ°

492
6 Littlewood‚ÄìPaley Theory and Multipliers
Remark 6.6.10. Identity (6.6.18) holds for any B‚Ä≤‚Ä≤ > B. In particular, we have
‚àë
k‚ààZn
f
 k
2B
 n
‚àè
j=1
sin(2œÄBxj ‚àíœÄkj)
2œÄBxj ‚àíœÄkj
= ‚àë
k‚ààZn
f
 k
2B‚Ä≤‚Ä≤
 n
‚àè
j=1
sin(2œÄB‚Ä≤‚Ä≤xj ‚àíœÄkj)
2œÄB‚Ä≤‚Ä≤xj ‚àíœÄkj
for all x ‚ààRn whenever f is band-limited in [‚àíB,B]n. In particular, band-limited
functions in [‚àíB,B]n can be sampled by their values at the points k/2B‚Ä≤‚Ä≤ for any
B‚Ä≤‚Ä≤ ‚â•B.
However, band-limited functions in [‚àíB,B]n cannot be sampled by the points
k/2B‚Ä≤ for any B‚Ä≤ < B, as the following example indicates.
Example 6.6.11. For 0 < B‚Ä≤ < B, let f(x) = g(x)sin(2œÄB‚Ä≤x), where 1g is supported
in the interval [‚àí(B ‚àíB‚Ä≤),B ‚àíB‚Ä≤]. Then f is band limited in [‚àíB,B], but it cannot
be sampled by its values at the points k/2B‚Ä≤, since it vanishes at these points and f
is not identically zero if g is not the zero function.
Next, we give a couple of results that relate the Lp norm of a given function with
the ‚Ñìp norm (or quasi-norm) of its sampled values.
Theorem 6.6.12. Let f be a tempered1 function whose Fourier transform is sup-
ported in the closed ball B(0,t) for some 0 < t < ‚àû. Assume that f lies in Lp(Rn)
for some 0 < p ‚â§‚àû. Then there is a constant C(n, p) such that
{f(k)}k‚ààZn

‚Ñìp(Zn) ‚â§C(n, p)t (1+t
2n
p )
f

Lp(Rn) .
Proof. The proof is based on the following fact, whose proof can be found in [131]
(Lemma 2.2.3). Let 0 < r < ‚àû. Then there exists a constant C2 = C2(n,r) such that
for all t > 0 and for all C 1 functions u on Rn whose distributional Fourier transform
is supported in the ball |Œæ| ‚â§t we have
sup
z‚ààRn
1
t
|‚àáu(x‚àíz)|
(1+t|z|)
n
r ‚â§C2 M(|u|r)(x)
1
r ,
(6.6.22)
where M denotes the Hardy‚ÄìLittlewood maximal operator.
Notice that f is a C ‚àûfunction since its Fourier transform is compactly supported.
Assuming (6.6.22), for each k ‚ààZn and x ‚àà[0,1]n we use the mean value theorem
to obtain
| f(k)| ‚â§| f(x+k)|+‚àön
sup
z‚àà[0,1]n |‚àáf(z+k)|
‚â§| f(x+k)|+‚àön
sup
z‚ààB(x+k,‚àön)
|‚àáf(z)|.
We raise this inequality to the power p, we integrate over the cube [0,1]n, we sum
over k ‚ààZn, and then we take the 1/p power. Let cp = max(1,21/p‚àí1) and c(n,r,t) =
1 A function is called tempered if there are constants C,M such that | f(x)| ‚â§C(1 + |x|)M for all
x ‚ààRn. Tempered functions are tempered distributions.

6.6 Wavelets and Sampling
493
‚àönt(1+t‚àön)n/r. The sum over k and the integral over [0,1]n yield an integral over
Rn and thus we obtain
/
‚àë
k‚ààZn
| f(k)|p0 1
p ‚â§

Rn | f(x)+‚àön
sup
z‚ààB(x,‚àön)
|‚àáf(z)|p dx
 1
p
‚â§cp
f

Lp +‚àön

Rn
sup
z‚ààB(0,‚àön)
|‚àáf(x‚àíz)|p dx
 1
p 
‚â§cp
f

Lp +c(n,r,t)

Rn
$
sup
z‚ààB(0,‚àön)
|‚àáf(x‚àíz)|
t(1+t|z|)
n
r
%p
dx
 1
p 
‚â§cp
f

Lp +c(n,r,t)

Rn
$
sup
z‚ààRn
|‚àáf(x‚àíz)|
t(1+t|z|)
n
r
%p
dx
 1
p 
‚â§cp
f

Lp +c(n,r,t)C2

Rn[M(| f|r)(x)]
p
r dx
 1
p 
,
where the last step uses (6.6.22). We now select r = p/2 if p < ‚àûand r to be
any number if p = ‚àû. The required inequality follows from the boundedness of the
Hardy-Littlewood maximal operator on L2 if p < ‚àûor on L‚àûif p = ‚àû.
‚ñ°
The next theorem could be considered a partial converse of Theorem 6.6.13
Theorem 6.6.13. Suppose that an integrable function f has Fourier transform sup-
ported in the cube [‚àí( 1
2 ‚àíŒµ), 1
2 ‚àíŒµ]n for some 0 < Œµ < 1/2. Furthermore, suppose
that the sequence of coefÔ¨Åcients {f(k)}k‚ààZn lies in ‚Ñìp(Zn) for some 0 < p ‚â§‚àû. Then
f lies in Lp(Rn) and the following estimate is valid
f

Lp(Rn) ‚â§Cn,p,Œµ
{f(k)}k

‚Ñìp(Zn) .
(6.6.23)
Proof. We Ô¨Åx a smooth function 1Œ¶ supported in [‚àí1
2, 1
2]n and equal to 1 on the
smaller cube [‚àí( 1
2 ‚àíŒµ), 1
2 ‚àíŒµ]n. Then we may write f = f ‚àóŒ¶, since 1Œ¶ is equal to
one on the support of 1f. Writing 1f in terms of its Fourier series we have
1f(Œæ) = ‚àë
k‚ààZn
11f(k)e2œÄik¬∑Œæ œá[‚àí1
2 , 1
2 ]n = ‚àë
k‚ààZn
f(‚àík)e2œÄik¬∑Œæ œá[‚àí1
2 , 1
2 ]n
(6.6.24)
Since f is integrable, 1f is continuous and thus integrable over [‚àí1
2, 1
2]n. By Fourier
inversion we have
f(x) =

[‚àí1
2 , 1
2 ]n
1f(Œæ)e2œÄix¬∑ŒædŒæ =

[‚àí1
2 , 1
2 ]n
1f(Œæ) 1Œ¶(Œæ)e2œÄix¬∑ŒædŒæ
(6.6.25)
for almost all x ‚ààRn. Inserting (6.6.25) in (6.6.24) we obtain
f(x) =

[‚àí1
2 , 1
2 ]n ‚àë
k‚ààZn
f(‚àík)e2œÄik¬∑Œæe2œÄix¬∑Œæ 1Œ¶(Œæ)dŒæ

494
6 Littlewood‚ÄìPaley Theory and Multipliers
= ‚àë
k‚ààZn
f(k)

[‚àí1
2 , 1
2 ]n e‚àí2œÄik¬∑Œæe2œÄix¬∑Œæ 1Œ¶(Œæ)dŒæ
= ‚àë
k‚ààZn
f(k)Œ¶(x‚àík).
This identity combined with the rapid decay of Œ¶ yields (6.6.23) as follows. For
0 < p ‚â§1 we have
 f
p
Lp ‚â§

Rn ‚àë
k‚ààZn
| f(k)|p|Œ¶(x‚àík)|p =
{f(k)}k‚à•p
‚Ñìp(Zn)‚à•Œ¶‚à•p
Lp
while for 1 < p ‚â§‚àû, setting Q = [‚àí1
2, 1
2]n we write:
 f

Lp(Rn) ‚â§

‚àë
l‚ààZn

l+Q

‚àë
k‚ààZn
| f(k)||Œ¶(x‚àík)|
p
dx
 1
p
‚â§Cn,N

‚àë
l‚ààZn

l+Q

‚àë
k‚ààZn
| f(k)|
1
(2‚àön+|x‚àík|)N
p
dx
 1
p
‚â§C‚Ä≤
n,N

‚àë
l‚ààZn

l+Q

‚àë
k‚ààZn
| f(k)|
1
(‚àön+|l ‚àík|)N
p
dx
 1
p
‚â§C‚Ä≤
n,N

‚àë
l‚ààZn

‚àë
k‚ààZn
| f(k)|
1
(‚àön+|l ‚àík|)N
p 1
p
.
The preceding expression can be viewed as the ‚Ñìp norm of the discrete convolution
of the sequences {f(k)}k and
1
(‚àön+|k|)N and thus it is bounded by a constant multiple
of
{f(k)}k

‚Ñìp(Zn), since the sequence
1
(‚àön+|k|)N is in ‚Ñì1(Zn) if N is large enough.
This completes the proof.
‚ñ°
Exercise 6.6.6 gives examples of functions for which Theorem 6.6.13 fails
if Œµ = 0.
Exercises
6.6.1. (a) Let A = [‚àí1,‚àí1
2)[ 1
2,1). Show that the family {e2œÄimx}m‚ààZ is an
orthonormal basis of L2(A).
(b) Obtain the same conclusion for the family {e2œÄim¬∑x}m‚ààZn in L2(An).

Hint: To show completeness, given f ‚ààL2(A), deÔ¨Åne h on [0,1] by setting h(x) =
f(x‚àí1) for x ‚àà[0, 1
2) and h(x) = f(x) for x ‚àà[ 1
2,1). Observe that 1h(m) = 1f(m) for
all m ‚ààZ and expand h in Fourier series.


6.6 Wavelets and Sampling
495
6.6.2. Let g be an integrable function on Rn.
(a) Suppose that g is supported in [‚àíb,b]n for some b > 0 and that the sequence
{1g(k/2b)}k‚ààZn lies in ‚Ñì2(Zn). Show that
g(x) = (2b)‚àín ‚àë
k‚ààZn
1g( k
2b)e2œÄi k
2b ¬∑xœá[‚àíb,b]n ,
where the series converges in L2(Rn) and deduce that g is in L2(Rn).
(b) Suppose that g is supported in [0,b]n for some b > 0 and that the sequence
{1g(k/b)}k‚ààZn lies in ‚Ñì2(Zn). Show that
g(x) = b‚àín ‚àë
k‚ààZn
1g( k
b)e2œÄi k
b ¬∑xœá[0,b]n ,
where the series converges in L2(Rn) and deduce that g is in L2(Rn).
(c) When n = 1, obtain the same as the conclusion in part (b) for x ‚àà[‚àíb,‚àíb
2)
[ b
2,b), provided g is supported in this set.

Hint: Part (c): Use the result in Exercise 6.6.1.

6.6.3. Show that the sequence of functions
Hk(x1,...,xn) = (2B)
n
2
n
‚àè
j=1
sin

œÄ(2Bxj ‚àíkj)

œÄ(2Bxj ‚àíkj)
,
k ‚ààZn ,
is orthonormal in L2(Rn).

Hint: Interpret the functions Hk as the Fourier transforms of known functions.

6.6.4. Prove the following spherical multidimensional version of Theorem 6.6.9.
Suppose that 1f is supported in the ball |Œæ| ‚â§R. Show that
f(x) = ‚àë
k‚ààZn
f

‚àík
2R
 1
2n
J n
2 (2œÄ|Rx+ k
2|)
|Rx+ k
2|
n
2
,
where Ja is the Bessel function of order a.
6.6.5. Let {ak}k‚ààZn be in ‚Ñìp for some 1 < p < ‚àû. Show that the partial sums
‚àë
k‚ààZn
|k|‚â§N
ak
n
‚àè
j=1
sin(2œÄBxj ‚àíœÄkj)
2œÄBxj ‚àíœÄkj
converge in S ‚Ä≤(Rn) as N ‚Üí‚àûto an Lp function on Rn whose Fourier transform
is supported in [‚àíB,B]n. Here k = (k1,...,kn). Moreover, the Lp norm of A is con-
trolled by a constant multiple of the ‚Ñìp norm of {ak}k.
6.6.6. Consider the function ‚àèn
j=1 sin(œÄxj)/(œÄxj) on Rn to show that Theorem
6.6.13 fails when Œµ = 0 and p ‚â§1. When 1 < p ‚â§‚àûconsider the function x1 +
‚àèn
j=1 sin(œÄxj)/(œÄxj).

496
6 Littlewood‚ÄìPaley Theory and Multipliers
6.6.7. (a) Let œà(x) be a nonzero continuous integrable function on R that satisÔ¨Åes

R œà(x)dx = 0 and
Cœà =
 +‚àû
‚àí‚àû
| 1œà(t)|2
|t|
dt < ‚àû.
DeÔ¨Åne the wavelet transform of f in L2(R) by setting
W( f;a,b) =
1
"
|a|
 +‚àû
‚àí‚àûf(x)œà
x‚àíb
a

dx
when a Ã∏= 0 and W( f;0,b) = 0. Show that for any f ‚ààL2(R) the following inversion
formula holds:
f(x) = 1
Cœà
 +‚àû
‚àí‚àû
 +‚àû
‚àí‚àû
1
|a|
1
2
œà
x‚àíb
a

W( f;a,b)db da
a2 .
(b) State and prove an analogous wavelet transform inversion property on Rn.

Hint: Apply Theorem 2.2.14 (5) in the b-integral and use Fourier inversion.

6.6.8. (P. Casazza) On Rn let ej be the vector whose coordinates are zero every-
where except for the jth entry, which is 1. Set qj = ej ‚àí1
n ‚àën
k=1 ek for 1 ‚â§j ‚â§n and
also qn+1 =
1
‚àön ‚àën
k=1 ek. Prove that
n+1
‚àë
j=1
|qj ¬∑x|2 = |x|2
for all x ‚ààRn. This provides an example of a tight frame on Rn.
HISTORICAL NOTES
An early account of square functions in the context of Fourier series appears in the work of
Kolmogorov [196], who proved the almost everywhere convergence of lacunary partial sums of
Fourier series of periodic square-integrable functions. This result was systematically studied and
extended to Lp functions, 1 < p < ‚àû, by Littlewood and Paley [227], [228], [229] using complex-
analysis techniques. The real-variable treatment of the Littlewood and Paley theorem was pioneered
by Stein [334] and allowed the higher-dimensional extension of the theory. The use of vector-valued
inequalities in the proof of Theorem 6.1.2 is contained in Benedek, Calder¬¥on, and Panzone [22]. A
Littlewood‚ÄìPaley theorem for lacunary sectors in R2 was obtained by Nagel, Stein, and Wainger
[264].
An interesting Littlewood‚ÄìPaley estimate holds for 2 ‚â§p < ‚àû: There exists a constant Cp such
that for all families of disjoint open intervals Ij in R the estimate ‚à•(‚àëj |( 1f œáIj)‚à®|2)
1
2 ‚à•Lp ‚â§Cp‚à•f‚à•Lp
holds for all functions f ‚ààLp(R). This was proved by Rubio de Francia [301], but the special case
in which Ij = ( j, j+1) was previously obtained by Carleson [55]. An alternative proof of Rubio de
Francia‚Äôs theorem was obtained by Bourgain [34]. A higher-dimensional analogue of this estimate
for arbitrary disjoint open rectangles in Rn with sides parallel to the axes was obtained by Journ¬¥e
[181]. Easier proofs of the higher-dimensional result were subsequently obtained by Sj¬®olin [326],
Soria [329], and Sato [311].
Part (a) of Theorem 6.2.7 is due to Mihlin [254] and the generalization in part (b) to H¬®ormander
[159]. Theorem 6.2.2 can be found in Marcinkiewicz‚Äôs article [241] in the context of one-
dimensional Fourier series. Calder¬¥on and Torchinsky [45] have improved Theorem 6.2.7 in the

6.6 Wavelets and Sampling
497
following way: if for a suitable smooth bump Œ∑ supported in an annulus the functions m(2kŒæ)Œ∑(Œæ)
lie in the Sobolev space Lr
Œ≥ uniformly in k ‚ààZ, where Œ≥ > n( 1
p ‚àí1
2), 1 < p < 2, 1
r = 1
p ‚àí1
2, then m
lies in Mp(Rn). The power 6 in estimate (6.2.3) that appears in the statement of Theorem 6.2.2 is
not optimal. Tao and Wright [357] proved that in dimension 1, the best power of (p‚àí1)‚àí1 in this
theorem is 3
2 as p ‚Üí1. An improvement of the Marcinkiewicz multiplier theorem in one dimen-
sion was obtained by Coifman, Rubio de Francia, and Semmes [69]. Weighted norm estimates for
H¬®ormander‚ÄìMihlin multipliers were obtained by Kurtz and Wheeden [209] and for Marcinkiwiecz
multipliers by Kurtz [208]. Heo, Nazarov, and Seeger [150] have obtained a very elegant charac-
terization of radial Lp multipliers in large dimensions; precisely, they showed that for dimensions
n ‚â•4 and 1 < p < 2n‚àí2
n+1 , a radial function m on Rn is an Lp Fourier multiplier if and only if there
exists a nonzero Schwartz function Œ∑ such that supt>0tn/p‚à•(m(¬∑)Œ∑(t ¬∑))‚à®‚à•Lp < ‚àû. This characteri-
zation builds on and extends a previously obtained simple characterization by Garrig¬¥os and Seeger
[124] of radial multipliers on the invariant subspace of radial Lp functions when 1 < p <
2n
n+1.
The method of proof of Theorem 6.3.4 is adapted from Duoandikoetxea and Rubio de Francia
[102]. The method in this article is rather general and can be used to obtain Lp boundedness for a
variety of rough singular integrals. A version of Theorem 6.3.6 was used by Christ [59] to obtain
Lp smoothing estimates for Cantor‚ÄìLebesgue measures. When p = q Ã∏= 2, Theorem 6.3.6 is false
in general, but it is true for all r satisfying | 1
r ‚àí1
2| < | 1
p ‚àí1
2| under the additional assumption that
the mj‚Äôs are Lipschitz functions uniformly at all scales. This result was independently obtained
by Carbery [52] and Seeger [316]. Miyachi [255] has obtained a complete characterization of the
indices a,b > 0 such that the functions |x|‚àíbei|x|aœà(x) are Lp Fourier multipliers; here œà is a smooth
function that is equal to 1 near inÔ¨Ånity and vanishes near zero.
The probabilistic notions of conditional expectations and martingales have a strong connection
with the Littlewood‚ÄìPaley theory discussed in this chapter. For the purposes of this exposition we
considered only the case of the sequence of œÉ-algebras generated by the dyadic cubes of side length
2‚àík in Rn. The Lp boundedness of the maximal conditional expectation (Doob [97]) is analogous
to the Lp boundedness of the dyadic maximal function; likewise with the corresponding weak type
(1,1) estimate. The Lp boundedness of the dyadic martingale square function was obtained by
Burkholder [39] and is analogous to Theorem 6.1.2. Moreover, the estimate
supk |Ek( f)|

Lp ‚âà
S( f)

Lp, 0 < p < ‚àû, obtained by Burkholder and Gundy [40] and also by Davis [90] is analogous
to the square-function characterization of the Hardy space H p norm. For an exposition on the
different and unifying aspects of Littlewood‚ÄìPaley theory we refer to Stein [337]. The proof of
Theorem 6.4.8, which quantitatively expresses the almost orthogonality of the Littlewood‚ÄìPaley
and the dyadic martingale difference operators, is taken from Grafakos and Kalton [133].
The use of quadratic expressions in the study of certain maximal operators has a long history.
We refer to the article of Stein [340] for a historical survey. Theorem 6.5.1 was Ô¨Årst proved by Stein
[339]. The proof in the text is taken from an article of Rubio de Francia [302]. Another proof when
n ‚â•3 is due to Cowling and Mauceri [76]. The more difÔ¨Åcult case n = 2 was settled by Bour-
gain [36] about 10 years later. Alternative proofs when n = 2 were given by Mockenhaupt, Seeger,
and Sogge [256] as well as Schlag [313]. The boundedness of maximal operators associated to
more general smooth measures on compact surfaces of Ô¨Ånite type were investigated by Iosevich
and Sawyer [173]. The powerful machinery of Fourier integral operators was used by Sogge [328]
to obtain the boundedness of spherical maximal operators on compact manifolds without bound-
ary and positive injectivity radius; a simple proof for the boundedness of the spherical maximal
function on the sphere was given by Nguyen [269]. Weighted norm inequalities for the spheri-
cal maximal operator were obtained by Duoandikoetxea and Vega [103]. The discrete spherical
maximal function was studied by Magyar, Stein, and Wainger [237].
Much of the theory of square functions and the ideas associated with them has analogues in the
dyadic setting. A dyadic analogue of the theory discussed here can be obtained. For an introduction
to the area of dyadic harmonic analysis, we refer to Pereyra [276].
The idea of expressing (or reproducing) a signal as a weighted average of translations and
dilations of a single function appeared in early work of Calder¬¥on [42]. This idea is in some sense a
forerunner of wavelets. An early example of a wavelet was constructed by Str¬®omberg [352] in his

498
6 Littlewood‚ÄìPaley Theory and Multipliers
search for unconditional bases for Hardy spaces. Another example of a wavelet basis was obtained
by Meyer [249]. The construction of an orthonormal wavelet presented in Theorem 6.6.7 is in
Lemari¬¥e and Meyer [216]. A compactly supported wavelet was constructed by Daubechies [88].
Mallat [238] introduced the notion of multiresolution analysis, which led to a systematic production
of wavelets. Theorem 6.6.9 is Shannon‚Äôs [319] version of Nyquist‚Äôs theorem [270] and is referred
to as the Nyquist-Shannon sampling theorem. It is a fundamental result in telecommunications and
signal processing, since it describes how to reconstruct a signal that contains no frequencies higher
than B Hertz in terms of its values at a sequence of points spaced 1/(2B) seconds apart.
The area of wavelets has taken off signiÔ¨Åcantly since its inception, spurred by these early re-
sults. A general theory of wavelets and its use in Fourier analysis was carefully developed in the
two-volume monograph of Meyer [250], [251] and its successor Meyer and Coifman [253]. For
further study and a deeper account of developments on the subject the reader may consult the
books of Daubechies [89], Chui [64], Wickerhauser [374], Kaiser [184], Benedetto and Frazier
[23], H¬¥ernandez and Weiss [151], Wojtaszczyk [379], Mallat [239], Meyer [252], Frazier [120],
Gr¬®ochenig [140], and the references therein. Theorems 6.6.12 and 6.6.13 Ô¨Årst appeared in a com-
bined form in the work of Plancherel and P¬¥olya [285] for restrictions of entire functions of expo-
nential type on the real line.

Chapter 7
Weighted Inequalities
Weighted inequalities arise naturally in Fourier analysis, but their use is best justiÔ¨Åed
by the variety of applications in which they appear. For example, the theory of
weights plays an important role in the study of boundary value problems for
Laplace‚Äôs equation on Lipschitz domains. Other applications of weighted inequal-
ities include extrapolation theory, vector-valued inequalities, and estimates for cer-
tain classes of nonlinear partial differential equations.
The theory of weighted inequalities is a natural development of the principles and
methods we have acquainted ourselves with in earlier chapters. Although a variety
of ideas related to weighted inequalities appeared almost simultaneously with the
birth of singular integrals, it was only in the 1970s that a better understanding of
the subject was obtained. This was spurred by Muckenhoupt‚Äôs characterization of
positive functions w for which the Hardy‚ÄìLittlewood maximal operator M maps
Lp(Rn,w(x)dx) to itself. This characterization led to the introduction of the class
Ap and the development of weighted inequalities. We pursue exactly this approach
in the next section to motivate the introduction of the Ap classes.
7.1 The Ap Condition
A weight is a nonnegative locally integrable function on Rn that takes values in
(0,‚àû) almost everywhere. Therefore, weights are allowed to be zero or inÔ¨Ånite only
on a set of Lebesgue measure zero. Hence, if w is a weight and 1/w is locally inte-
grable, then 1/w is also a weight.
Given a weight w and a measurable set E, we use the notation
w(E) =

E w(x)dx
L. Grafakos, Classical Fourier Analysis, Graduate Texts in Mathematics 249,
DOI 10.1007/978-1-4939-1194-3 7, ¬© Springer Science+Business Media New York 2014
499

500
7 Weighted Inequalities
to denote the w-measure of the set E. Since weights are locally integrable functions,
w(E) < ‚àûfor all sets E contained in some ball. The weighted Lp spaces are denoted
by Lp(Rn,w) or simply Lp(w). Recall the uncentered Hardy‚ÄìLittlewood maximal
operators on Rn over balls
M( f)(x) = sup
B‚àãx
Avg
B
| f| = sup
B‚àãx
1
|B|

B | f(y)|dy,
and over cubes
Mc( f)(x) = sup
Q‚àãx
Avg
Q
| f| = sup
Q‚àãx
1
|Q|

Q | f(y)|dy,
where the suprema are taken over all balls B and cubes Q (with sides parallel to the
axes) that contain the given point x. A classical result (Theorem 2.1.6) states that for
all 1 < p < ‚àûthere is a constant Cp(n) > 0 such that

Rn M( f)(x)p dx ‚â§Cp(n)p

Rn | f(x)|p dx
(7.1.1)
for all functions f ‚ààLp(Rn). We are concerned with the situation in which the mea-
sure dx in (7.1.1) is replaced by w(x)dx for some weight w(x).
7.1.1 Motivation for the Ap Condition
The question we raise is whether there is a characterization of all weights w(x) such
that the strong type (p, p) inequality

Rn M( f)(x)p w(x)dx ‚â§Cp
p

Rn | f(x)|p w(x)dx
(7.1.2)
is valid for all f ‚ààLp(w).
Suppose that (7.1.2) is valid for some weight w and all f ‚ààLp(w) for some
1 < p < ‚àû. Apply (7.1.2) to the function f œáB supported in a ball B and use that
AvgB | f| ‚â§M( f œáB)(x) for all x ‚ààB to obtain
w(B)

Avg
B
| f|
p ‚â§

B M( f œáB)p wdx ‚â§Cp
p

B | f|p wdx.
(7.1.3)
It follows that
 1
|B|

B | f(t)|dt
p
‚â§Cp
p
w(B)

B | f(x)|p w(x)dx
(7.1.4)
for all balls B and all functions f. At this point, it is tempting to choose a function
such that the two integrands are equal. We do so by setting f = w‚àíp‚Ä≤/p, which gives

7.1 The Ap Condition
501
f pw = w‚àíp‚Ä≤/p. Under the assumption that infB w > 0 for all balls B, it would follow
from (7.1.4) that
sup
B balls
 1
|B|

B w(x)dx
 1
|B|

B w(x)‚àí
1
p‚àí1 dx
p‚àí1
‚â§Cp
p .
(7.1.5)
If infB w = 0 for some balls B, we take f = (w+Œµ)‚àíp‚Ä≤/p to obtain
 1
|B|

B w(x)dx
 1
|B|

B(w(x)+Œµ)‚àíp‚Ä≤
p dx
p 1
|B|

B
w(x)dx
(w(x)+Œµ)p‚Ä≤
‚àí1
‚â§Cp
p (7.1.6)
for all Œµ > 0. Replacing w(x)dx by (w(x) + Œµ)dx in the last integral in (7.1.6) we
obtain a smaller expression, which is also bounded by Cp
p. Since ‚àíp‚Ä≤/p = ‚àíp‚Ä≤ +1,
(7.1.6) implies that
 1
|B|

B w(x)dx
 1
|B|

B(w(x)+Œµ)‚àíp‚Ä≤
p dx
p‚àí1
‚â§Cp
p ,
(7.1.7)
from which we can still deduce (7.1.5) via the Lebesgue monotone convergence the-
orem by letting Œµ ‚Üí0. We have now obtained that every weight w that satisÔ¨Åes
(7.1.2) must also satisfy the rather strange-looking condition (7.1.5), which we refer
to in the sequel as the Ap condition. It is a remarkable fact, to be proved in this chap-
ter, that the implication obtained can be reversed, that is, (7.1.2) is a consequence
of (7.1.5). This is the Ô¨Årst signiÔ¨Åcant achievement of the theory of weights [i.e., a
characterization of all functions w for which (7.1.2) holds]. This characterization is
based on some deep principles discussed in the next section and provides a solid
motivation for the introduction and careful examination of condition (7.1.5).
Before we study the converse statements, we consider the case p = 1. Assume
that for some weight w the weak type (1,1) inequality
w

{x ‚ààRn : M( f)(x) > Œ±}

‚â§C1
Œ±

Rn | f(x)|w(x)dx
(7.1.8)
holds for all functions f ‚ààL1(Rn). Since M( f)(x) ‚â•AvgB | f| for all x ‚ààB, it follows
from (7.1.8) that for all Œ± < AvgB | f| we have
w(B) ‚â§w

{x ‚ààRn : M( f)(x) > Œ±}

‚â§C1
Œ±

Rn | f(x)|w(x)dx.
(7.1.9)
Taking f œáB instead of f in (7.1.9), we deduce that
Avg
B
| f| = 1
|B|

B | f(t)|dt ‚â§
C1
w(B)

B | f(x)|w(x)dx
(7.1.10)

502
7 Weighted Inequalities
for all functions f and balls B. Taking f = œáS, we obtain
|S|
|B| ‚â§C1
w(S)
w(B) ,
(7.1.11)
where S is any measurable subset of the ball B.
Recall that the essential inÔ¨Åmum of a function w over a set E is deÔ¨Åned as
ess.inf
E
(w) = inf
	
b > 0 : |{x ‚ààE : w(x) < b}| > 0

.
Then for every a > ess.infB(w) there exists a subset Sa of B with positive measure
such that w(x) < a for all x ‚ààSa. Applying (7.1.11) to the set Sa, we obtain
1
|B|

B w(t)dt ‚â§C1
|Sa|

Sa
w(t)dt ‚â§C1a,
(7.1.12)
which implies
1
|B|

B w(t)dt ‚â§C1w(x)
for all balls B and almost all x ‚ààB.
(7.1.13)
It remains to understand what condition (7.1.13) really means. For every ball B, there
exists a null set N(B) such that (7.1.13) holds for all x in B\N(B). Let N be the union
of all the null sets N(B) for all balls B with centers in Qn and rational radii. Then
N is a null set and for every x in B \ N, (7.1.13) holds for all balls B with centers in
Qn and rational radii. By density, (7.1.13) must also hold for all balls B that contain
a Ô¨Åxed x in Rn \N. It follows that for x ‚ààRn \N we have
M(w)(x) = sup
B‚àãx
1
|B|

B w(t)dt ‚â§C1w(x).
(7.1.14)
Therefore, assuming (7.1.8), we have arrived at the condition
M(w)(x) ‚â§C1w(x)
for almost all x ‚ààRn,
(7.1.15)
where C1 is the same constant as in (7.1.13).
We later see that this deduction can be reversed and we can obtain (7.1.8) as a
consequence of (7.1.15). This motivates a careful study of condition (7.1.15), which
we refer to as the A1 condition. Since in all the previous arguments we could have
replaced balls with cubes, we give the following deÔ¨Ånitions in terms of cubes.
DeÔ¨Ånition 7.1.1. A function w(x) ‚â•0 is called an A1 weight if
M(w)(x) ‚â§C1w(x)
for almost all x ‚ààRn
(7.1.16)
for some constant C1. If w is an A1 weight, then the (Ô¨Ånite) quantity
[w]A1 =
sup
Q cubes in Rn
 1
|Q|

Q w(t)dt

‚à•w‚àí1‚à•L‚àû(Q)
(7.1.17)

7.1 The Ap Condition
503
is called the A1 Muckenhoupt characteristic constant of w, or simply the A1 charac-
teristic constant of w. Note that A1 weights w satisfy
1
|Q|

Q w(t)dt ‚â§[w]A1 ess.inf
y‚ààQ w(y)
(7.1.18)
for all cubes Q in Rn.
Remark 7.1.2. We also deÔ¨Åne
[w]balls
A1
=
sup
B balls in Rn
 1
|B|

B w(t)dt
w‚àí1
L‚àû(B) .
(7.1.19)
Using (7.1.13), we see that the smallest constant C1 that appears in (7.1.16) is equal
to the A1 characteristic constant of w as deÔ¨Åned in (7.1.19). This is also equal to the
smallest constant that appears in (7.1.13). All these constants are bounded above and
below by dimensional multiples of [w]A1.
We now recall condition (7.1.5), which motivates the following deÔ¨Ånition of Ap
weights for 1 < p < ‚àû.
DeÔ¨Ånition 7.1.3. Let 1 < p < ‚àû. A weight w is said to be of class Ap if
sup
Q cubes in Rn
 1
|Q|

Q w(x)dx
 1
|Q|

Q w(x)‚àí
1
p‚àí1 dx
p‚àí1
< ‚àû.
(7.1.20)
The expression in (7.1.20) is called the Ap Muckenhoupt characteristic constant of
w (or simply the Ap characteristic constant of w) and is denoted by [w]Ap.
Remark 7.1.4. Note that DeÔ¨Ånitions 7.1.1 and 7.1.3 could have been given with the
set of all cubes in Rn replaced by the set of all balls in Rn. DeÔ¨Åning [w]balls
Ap
as in
(7.1.20) except that cubes are replaced by balls, we see that

vn2‚àínp ‚â§[w]Ap
[w]balls
Ap
‚â§

nn/2vn2‚àínp .
(7.1.21)
7.1.2 Properties of Ap Weights
It is straightforward that translations, isotropic dilations, and scalar multiples of Ap
weights are also Ap weights with the same Ap characteristic. We summarize some
basic properties of Ap weights in the following proposition.
Proposition 7.1.5. Let w ‚ààAp for some 1 ‚â§p < ‚àû. Then
(1) [Œ¥ Œª(w)]Ap = [w]Ap, where Œ¥ Œª(w)(x) = w(Œªx1,...,Œªxn).
(2) [œÑz(w)]Ap = [w]Ap, where œÑz(w)(x) = w(x‚àíz), z ‚ààRn.

504
7 Weighted Inequalities
(3) [Œªw]Ap = [w]Ap for all Œª > 0.
(4) When 1 < p < ‚àû, the function w‚àí
1
p‚àí1 is in Ap‚Ä≤ with characteristic constant

w‚àí
1
p‚àí1 
Ap‚Ä≤ = [w]
1
p‚àí1
Ap .
Therefore, w ‚ààA2 if and only if w‚àí1 ‚ààA2 and both weights have the same A2
characteristic constant.
(5) [w]Ap ‚â•1 for all w ‚ààAp. Equality holds if and only if w is a constant.
(6) The classes Ap are increasing as p increases; precisely, for 1 ‚â§p < q < ‚àûwe
have
[w]Aq ‚â§[w]Ap.
(7) lim
q‚Üí1+[w]Aq = [w]A1 if w ‚ààA1.
(8) The following is an equivalent characterization of the Ap characteristic constant
of w:
[w]Ap = sup
Qcubes
in Rn
sup
f ‚ààLp(Q,wdt)

Q | f|pwdt>0
$
 1
|Q|

Q | f(t)|dt
p
1
w(Q)

Q | f(t)|pw(t)dt
%
.
(9) The measure w(x)dx is doubling: precisely, for all Œª > 1 and all cubes Q we
have
w(ŒªQ) ‚â§Œª np[w]Ap w(Q).
(ŒªQ denotes the cube with the same center as Q and side length Œª times the side
length of Q.)
Proof. The simple proofs of (1), (2), and (3) are left as an exercise. Property (4) is
also easy to check and plays the role of duality in this context. To prove (5) we use
H¬®older‚Äôs inequality with exponents p and p‚Ä≤ to obtain
1 = 1
|Q|

Q dx = 1
|Q|

Q w(x)
1
p w(x)‚àí1
p dx ‚â§[w]
1
p
Ap ,
with equality holding only when w(x)
1
p = cw(x)‚àí1
p for some c > 0 (i.e., when w is a
constant). To prove (6), observe that 0 < q‚Ä≤ ‚àí1 < p‚Ä≤ ‚àí1 ‚â§‚àûand that the statement
[w]Aq ‚â§[w]Ap
is equivalent to the fact
w‚àí1
Lq‚Ä≤‚àí1(Q, dx
|Q| ) ‚â§
w‚àí1
Lp‚Ä≤‚àí1(Q, dx
|Q| ) .
Property (7) is a consequence of part (a) of Exercise 1.1.3.

7.1 The Ap Condition
505
To prove (8), apply H¬®older‚Äôs inequality with exponents p and p‚Ä≤ to get
(Avg
Q
| f|)p =
 1
|Q|

Q | f(x)|dx
p
=
 1
|Q|

Q | f(x)|w(x)
1
p w(x)‚àí1
p dx
p
‚â§
1
|Q|p

Q | f(x)|pw(x)dx

Q w(x)‚àíp‚Ä≤
p dx
 p
p‚Ä≤
=

1
œâ(Q)

Q | f(x)|pw(x)dx
 1
|Q|

Q w(x)dx
 1
|Q|

Q w(x)‚àí
1
p‚àí1 dx
p‚àí1
‚â§[w]Ap

1
œâ(Q)

Q | f(x)|pw(x)dx

.
This argument proves the inequality ‚â•in (8) when p > 1. In the case p = 1 the
obvious modiÔ¨Åcation yields the same inequality. The reverse inequality follows by
taking f = (w+Œµ)‚àíp‚Ä≤/p as in (7.1.6) and letting Œµ ‚Üí0.
Applying (8) to the function f = œáQ and putting ŒªQ in the place of Q in (8), we
obtain
w(ŒªQ) ‚â§Œª np[w]Apw(Q),
which says that w(x)dx is a doubling measure. This proves (9).
‚ñ°
Example 7.1.6. A positive measure dŒº is called doubling if for some C < ‚àû,
Œº(2B) ‚â§CŒº(B)
(7.1.22)
for all balls B. We show that the measures |x|a dx are doubling when a > ‚àín. We
divide all balls B(x0,R) in Rn into two categories: balls of type I that satisfy |x0| ‚â•
3R and type II that satisfy |x0| < 3R. For balls of type I we observe that

B(x0,2R) |x|a dx ‚â§vn(2R)n

(|x0|+2R)a
when a ‚â•0,
(|x0|‚àí2R)a
when a < 0,

B(x0,R) |x|a dx ‚â•vnRn

(|x0|‚àíR)a
when a ‚â•0,
(|x0|+R)a
when a < 0.
Since |x0| ‚â•3R, we have |x0|+2R ‚â§4(|x0|‚àíR) and |x0|‚àí2R ‚â•1
4(|x0|+R), from
which (7.1.22) follows with C = 23n4|a|.
For balls of type II, we have |x0| ‚â§3R and we note two things: Ô¨Årst

B(x0,2R) |x|a dx ‚â§

|x|‚â§5R |x|a dx = cnRn+a,

506
7 Weighted Inequalities
and second, since |x|a is radially decreasing for a < 0 and radially increasing for
a ‚â•0, we have

B(x0,R) |x|a dx ‚â•
‚éß
‚é™
‚é™
‚é™
‚é™
‚é®
‚é™
‚é™
‚é™
‚é™
‚é©

B(0,R) |x|a dx
when a ‚â•0,

B(3R x0
|x0| ,R) |x|a dx
when a < 0.
For x ‚ààB(3R x0
|x0|,R) we must have |x| ‚â•2R, and hence both integrals on the right
are at least a multiple of Rn+a. This establishes (7.1.22) for balls of type II.
Example 7.1.7. We investigate for which real numbers a the power function |x|a is
an Ap weight on Rn. For 1 < p < ‚àû, we examine for which a the following expression
is Ô¨Ånite:
sup
B balls
 1
|B|

B |x|a dx
 1
|B|

B |x|‚àía p‚Ä≤
p dx
 p
p‚Ä≤
.
(7.1.23)
As in the previous example we split the balls in Rn into those of type I and those of
type II. If B = B(x0,R) is of type I, then for x satisfying |x‚àíx0| ‚â§R we must have
2
3|x0| ‚â§|x0|‚àíR ‚â§|x| ‚â§|x0|+R ‚â§4
3|x0|,
thus the expression inside the supremum in (7.1.23) is comparable to
|x0|a
|x0|‚àía p‚Ä≤
p  p
p‚Ä≤ = 1.
If B(x0,R) is a ball of type II, then B(0,5R) has size comparable to B(x0,R) and
contains it. Since the measure |x|a dx is doubling, the integrals of the function |x|a
over B(x0,R) and over B(0,5R) are comparable. It sufÔ¨Åces therefore to estimate the
expression inside the supremum in (7.1.23), in which we have replaced B(x0,R) by
B(0,5R). But this is

1
vn(5R)n

B(0,5R)|x|a dx

1
vn(5R)n

B(0,5R) |x|‚àía p‚Ä≤
p dx
 p
p‚Ä≤
=

n
(5R)n
 5R
0
ra+n‚àí1dr

n
(5R)n
 5R
0
r‚àía p‚Ä≤
p +n‚àí1dr
 p
p‚Ä≤
,
which is seen easily to be Ô¨Ånite and independent of R exactly when ‚àín < a < n p
p‚Ä≤ .
We conclude that |x|a is an Ap weight, 1 < p < ‚àû, if and only if ‚àín < a < n(p‚àí1).
The previous proof can be suitably modiÔ¨Åed to include the case p = 1. In this case
we obtain that |x|a is an A1 weight if and only if ‚àín < a ‚â§0. As we have seen, the
measure |x|a dx is doubling on the larger range ‚àín < a < ‚àû. Thus for a > n(p‚àí1),
the function |x|a provides an example of a doubling measure that is not in Ap.

7.1 The Ap Condition
507
Example 7.1.8. On Rn the function
u(x) =

log 1
|x|
when |x| < 1
e,
1
otherwise,
is an A1 weight. Indeed, to check condition (7.1.19) it sufÔ¨Åces to consider balls of
type I and type II as deÔ¨Åned in Example 7.1.6. In either case the required estimate
follows easily.
We now return to a point alluded to earlier, that the Ap condition implies the
boundedness of the Hardy‚ÄìLittlewood maximal function M on the space Lp(w). To
this end we introduce four maximal functions acting on functions f that are locally
integrable with respect to w:
Mw( f)(x) = sup
B‚àãx
1
w(B)

B | f|wdy,
where the supremum is taken over open balls B that contain the point x and
Mw( f)(x) = sup
Œ¥>0
1
w(B(x,Œ¥))

B(x,Œ¥) | f|wdy,
Mw
c ( f)(x) = sup
Q‚àãx
1
w(Q)

Q | f|wdy,
where Q is an open cube containing the point x, and
Mw
c ( f)(x) = sup
Œ¥>0
1
w(Q(x,Œ¥))

Q(x,Œ¥) | f|wdy,
where Q(x,Œ¥) = ‚àèn
j=1(xj ‚àíŒ¥,xj + Œ¥) is a cube of side length 2Œ¥ centered at
x = (x1,...,xn). When w = 1, these maximal functions reduce to the standard ones
M( f), M( f), Mc( f), and Mc( f), the uncentered and centered Hardy‚ÄìLittlewood
maximal functions with respect to balls and cubes, respectively.
Theorem 7.1.9. (a) Let w ‚ààA1. Then we have
Mc

L1(w)‚ÜíL1,‚àû(w) ‚â§3n[w]A1 .
(7.1.24)
(b) Let w ‚ààAp(Rn) for some 1 < p < ‚àû. Then there is a constant Cn,p such that
Mc

Lp(w)‚ÜíLp(w) ‚â§Cn,p[w]
1
p‚àí1
Ap .
(7.1.25)
Since the operators Mc, Mc, M, and M are pointwise comparable, a similar conclu-
sions hold for the other three as well.
Proof. (a) Since dŒº = wdx is a doubling measure and dŒº(3Q) ‚â§3n[w]A1Œº(Q),
using Proposition 7.1.5 (9) and Exercise 2.1.1 we obtain that Mw
c maps L1(w) to
L1,‚àû(w) with norm at most 3n[w]A1. This proves (7.1.24).

508
7 Weighted Inequalities
(b) Fix a weight w in Ap and let œÉ = w‚àí
1
p‚àí1 be its dual weight. Fix an open cube
Q = Q(x0,r) in Rn with center x0 and side length 2r and write
1
|Q|

Q | f|dy = w(Q)
1
p‚àí1 œÉ(3Q)
|Q|
p
p‚àí1
$ |Q|
w(Q)

1
œÉ(3Q)

Q | f|dy
p‚àí1%
1
p‚àí1
.
(7.1.26)
For any x ‚ààQ, consider the cube Q(x,2r). Then Q ‚´ÖQ(x,2r) ‚´Ö3Q = Q(x0,3r) and
thus
1
œÉ(3Q)

Q | f|dy ‚â§
1
œÉ(Q(x,2r))

Q(x,2r) | f|dy ‚â§MœÉ
c (| f|œÉ‚àí1)(x)
for any x ‚ààQ. Inserting this expression in (7.1.26), we obtain
1
|Q|

Q | f|dy ‚â§w(Q)
1
p‚àí1 œÉ(3Q)
|Q|
p
p‚àí1
$
1
w(Q)

Q MœÉ
c (| f|œÉ‚àí1)p‚àí1 dy
%
1
p‚àí1
.
(7.1.27)
Since one may easily verify that
w(Q)œÉ(3Q)p‚àí1
|Q|p
‚â§3np[w]Ap ,
it follows that
1
|Q|

Q | f|dy ‚â§3
np
p‚àí1 [w]
1
p‚àí1
Ap

Mw
c

MœÉ
c (| f|œÉ‚àí1)
p‚àí1w‚àí1
(x0)

1
p‚àí1 ,
since x0 is the center of Q. Hence, we have
Mc( f) ‚â§3
np
p‚àí1 [w]
1
p‚àí1
Ap

Mw
c

MœÉ
c (| f|œÉ‚àí1)
p‚àí1w‚àí1
1
p‚àí1 .
Applying Lp(w) norms, we deduce
Mc( f)

Lp(w) ‚â§3
np
p‚àí1 [w]
1
p‚àí1
Ap
Mw
c

MœÉ
c (| f|œÉ‚àí1)
p‚àí1w‚àí1
1
p‚àí1
Lp‚Ä≤(w)
‚â§3
np
p‚àí1 [w]
1
p‚àí1
Ap
Mw
c

1
p‚àí1
Lp‚Ä≤(w)‚ÜíLp‚Ä≤(w)

MœÉ
c (| f|œÉ‚àí1)
p‚àí1w‚àí1
1
p‚àí1
Lp‚Ä≤(w)
= 3
np
p‚àí1 [w]
1
p‚àí1
Ap
Mw
c

1
p‚àí1
Lp‚Ä≤(w)‚ÜíLp‚Ä≤(w)
MœÉ
c (| f|œÉ‚àí1)

Lp(œÉ)
‚â§3
np
p‚àí1 [w]
1
p‚àí1
Ap
Mw
c

1
p‚àí1
Lp‚Ä≤(w)‚ÜíLp‚Ä≤(w)
MœÉ
c

Lp(œÉ)‚ÜíLp(œÉ)
f

Lp(w) ,
and conclusion (7.1.25) follows, provided we show that
Mw
c

Lq(w)‚ÜíLq(w) ‚â§C(q,n) < ‚àû
(7.1.28)
for any 1 < q < ‚àûand any weight w.

7.1 The Ap Condition
509
We obtain this estimate by interpolation. Obviously (7.1.28) is valid when q = ‚àû
with C(‚àû,n) = 1. If we prove that
Mw
c

L1(w)‚ÜíL1,‚àû(w) ‚â§C(1,n) < ‚àû,
(7.1.29)
then (7.1.28) will follow from Theorem 1.3.2.
To prove (7.1.29) we Ô¨Åx f ‚ààL1(Rn,wdx). We Ô¨Årst show that the set
EŒª = {Mw
c ( f) > Œª}
is open. For any r > 0, let Q(x,r) denote an open cube of side length 2r with center
x ‚ààRn. If we show that for any r > 0 and x ‚ààRn the function
x ‚Üí
1
w(Q(x,r))

Q(x,r) | f|wdy
(7.1.30)
is continuous, then Mw
c ( f) is the supremum of continuous functions; hence it is
lower semicontinuous and thus the set EŒª is open. But this is straightforward. If
xn ‚Üíx0, then w(Q(xn,r)) ‚Üíw(Q(x0,r)) and also

Q(xn,r) | f|wdy ‚Üí

Q(x0,r) | f|wdy
by the Lebesgue dominated convergence theorem. Since w(Q(x0,r)) Ã∏= 0, it follows
that the function in (7.1.30) is continuous.
Given K a compact subset of EŒª, for any x ‚ààK select an open cube Qx centered
at x such that
1
w(Qx)

Qx
| f|wdy > Œª .
Applying Lemma 7.1.10 (proved immediately afterward) we Ô¨Ånd a subfamily
{Qx j}m
j=1 of the family of the balls {Qx : x ‚ààK} such that (7.1.31) and (7.1.32)
hold. Then
w(K) ‚â§
m
‚àë
j=1
w(Qx j) ‚â§
m
‚àë
j=1
1
Œª

Qx j
| f|wdy ‚â§24n
Œª

Rn | f|wdy,
where the last inequality follows by multiplying (7.1.32) by | f|w and integrating
over Rn. Taking the supremum over all compact subsets K of EŒª and using the inner
regularity of wdx, which is a consequence of the Lebesgue monotone convergence
theorem, we deduce that Mw
c maps L1(w) to L1,‚àû(w) with constant at most 24n. Thus
(7.1.29) holds with C(1,n) = 24n.
‚ñ°
Lemma 7.1.10. Let K be a bounded set in Rn and for every x ‚ààK, let Qx be an open
cube with center x and sides parallel to the axes. Then there are an m ‚ààZ+ ‚à™{‚àû}
and a sequence of points {xj}m
j=1 in K such that
K ‚´Ö
m

j=1
Qx j
(7.1.31)

510
7 Weighted Inequalities
and for almost all y ‚ààRn one has
m
‚àë
j=1
œáQx j (y) ‚â§24n .
(7.1.32)
Proof. Let s0 = sup{‚Ñì(Qx) : x ‚ààK}. If s0 = ‚àû, then there exists x1 ‚ààK such that
‚Ñì(Qx1) > 4L, where [‚àíL,L]n contains K. Then K is contained in Qx1 and the state-
ment of the lemma is valid with m = 1.
Suppose now that s0 < ‚àû. Select x1 ‚ààK such that ‚Ñì(Qx1) > s0/2. Then deÔ¨Åne
K1 = K \Qx1 ,
s1 = sup{‚Ñì(Qx) : x ‚ààK1},
and select x2 ‚ààK1 such that ‚Ñì(Qx2) > s1/2. Next deÔ¨Åne
K2 = K \(Qx1 ‚à™Qx2),
s2 = sup{‚Ñì(Qx) : x ‚ààK2},
and select x3 ‚ààK2 such that ‚Ñì(Qx3) > s2/2. Continue until the Ô¨Årst integer m is
found such that Km is an empty set. If no such integer exists, continue this process
indeÔ¨Ånitely and set m = ‚àû.
We claim that for all i Ã∏= j we have 1
3Qxi ‚à©1
3Qx j = /0. Indeed, suppose that i > j.
Then xi ‚ààKi‚àí1 = K \(Qx1 ‚à™¬∑¬∑¬∑‚à™Qxi‚àí1); thus xi /‚ààQj. Also xi ‚ààKi‚àí1 ‚´ÖKj‚àí1, which
implies that ‚Ñì(Qxi) ‚â§s j‚àí1 < 2‚Ñì(Qx j). If xi /‚ààQj and ‚Ñì(Qx j) > 1
2‚Ñì(Qxi), it easily
follows that 1
3Qxi ‚à©1
3Qx j = /0.
We now prove (7.1.31). If m < ‚àû, then Km = /0 and therefore K ‚´Öm
j=1 Qx j. If
m = ‚àû, then there is an inÔ¨Ånite number of selected cubes Qx j. Since the cubes 1
3Qx j
are pairwise disjoint and have centers in a bounded set, it must be the case that
some subsequence of the sequence of their lengths converges to zero. If there exists
a y ‚ààK \ ‚àû
j=1 Qx j, this y would belong to all Kj, j = 1,2,..., and then s j ‚â•‚Ñì(Qy)
for all j. Since some subsequence of the s j‚Äôs tends to zero, it would follow that
‚Ñì(Qy) = 0, which would force the open cube Qy to be the empty set, a contradiction.
Thus (7.1.31) holds.
Finally, we show that ‚àëm
j=1 œáQx j (y) ‚â§24n for almost every point y ‚ààRn. To prove
this we consider the n hyperplanes Hi that are parallel to the coordinate hyperplanes
and pass through the point y. Then we write Rn as a union of n hyperplanes Hi of
n-dimensional Lebesgue measure zero and 2n higher-dimensional open ‚Äúoctants‚Äù
Or, henceforth called orthants. We Ô¨Åx a y ‚ààRn and we show that there are only
12n points xj such that y lies in Or ‚à©Qx j for a given open orthant Or. To prove this
assertion, setting |z|‚Ñì‚àû= sup1‚â§i‚â§n |zi| for points z = (z1,...,zn) in Rn, we pick an
xk0 ‚ààK ‚à©Or such that Qxk0 contains y and |xk0 ‚àíy|‚Ñì‚àûis the largest possible among
all |xj ‚àíy|‚Ñì‚àû. If xj is another point in K ‚à©Or such that Qx j contains y, then we claim
that xj ‚ààQxk0. Indeed, to show this we notice that for each i ‚àà{1,...,n} we have
|xj,i ‚àíxk0,i| =
xj,i ‚àíyi ‚àí(xk0,i ‚àíyi)

=
|xj,i ‚àíyi|‚àí|xk0,i ‚àíyi|


7.1 The Ap Condition
511
‚â§max

|xk0,i ‚àíyi|,|xj,i ‚àíyi|

‚â§max

|xk0 ‚àíy|‚Ñì‚àû,|xj ‚àíy|‚Ñì‚àû
= |xk0 ‚àíy|‚Ñì‚àû
< 1
2‚Ñì(Qxk0),
where the second equality is due to the fact that xj,xk0 lie in the same orthant and
the last inequality in the fact that y ‚ààQxk0; it follows that xj lies in Qxk0.
We observed previously that i > j implies xi /‚ààQj. Since xj lies in Qxk0, one must
then have j ‚â§k0, which implies that 1
2‚Ñì(Qxk0) < ‚Ñì(Qx j). Thus all cubes Qx j with
centers in K ‚à©Or that contain the Ô¨Åxed point y have side lengths comparable to that
of Qxk0. A simple geometric argument now gives that there are at most Ô¨Ånitely many
cubes Qx j of side length between Œ± and 2Œ± that contain the given point y such that
1
3Qx j are pairwise disjoint. Indeed, let Œ± = 1
2‚Ñì(Qxk0) and let {Qxr}r‚ààI be the cubes
with these properties. Then we have
Œ±n|I|
3n
‚â§‚àë
r‚ààI
 1
3Qxr
 =
 
r‚ààI
1
3Qxr
 ‚â§
 
r‚ààI
Qxr
 ‚â§(4Œ±)n ,
since all the cubes Qxr contain the point y and have length at most 2Œ± and they
must therefore be contained in a cube of side length 4Œ± centered at y. This obser-
vation shows that |I| ‚â§12n, and since there are 2n sets Or, we conclude the proof
of (7.1.32).
‚ñ°
Remark 7.1.11. Without use of the covering Lemma 7.1.10, (7.1.29) can be proved
via the doubling property of w (cf. Exercise 2.1.1(a)), but then the resulting constant
C(q,n) would depend on the doubling constant of the measure wdx and thus on
[w]Ap; this would yield a worse dependence on [w]Ap in the constant in (7.1.25).
Exercises
7.1.1. Let k be a nonnegative measurable function such that k,k‚àí1 are in L‚àû(Rn).
Prove that if w is an Ap weight for some 1 ‚â§p < ‚àû, then so is kw.
7.1.2. Let w1, w2 be two A1 weights and let 1 < p < ‚àû. Prove that w1w1‚àíp
2
is an Ap
weight by showing that
[w1w1‚àíp
2
]Ap ‚â§[w1]A1[w2]p‚àí1
A1 .
7.1.3. Suppose that w ‚ààAp for some p ‚àà[1,‚àû) and 0 < Œ¥ < 1. Prove that wŒ¥ ‚ààAq,
where q = Œ¥ p+1‚àíŒ¥, by showing that
[wŒ¥]Aq ‚â§[w]Œ¥
Ap .

512
7 Weighted Inequalities
7.1.4. Show that if the Ap characteristic constants of a weight w are uniformly
bounded for all p > 1, then w ‚ààA1.
7.1.5. Let w0 ‚ààAp0 and w1 ‚ààAp1 for some 1 ‚â§p0, p1 < ‚àû. Let 0 ‚â§Œ∏ ‚â§1 and deÔ¨Åne
1
p = 1‚àíŒ∏
p0
+ Œ∏
p1
and
w
1
p = w
1‚àíŒ∏
p0
0
w
Œ∏
p1
1 .
Prove that
[w]Ap ‚â§[w0]
(1‚àíŒ∏) p
p0
Ap0
[w1]
Œ∏ p
p1
Ap1 ;
thus w is in Ap.
7.1.6. ([122]) Fix 1 < p < ‚àû. A pair of weights (u,w) that satisÔ¨Åes
[u,w](Ap,Ap) = sup
Q cubes
in Rn
 1
|Q|

Q udx
 1
|Q|

Q w‚àí
1
p‚àí1 dx
p‚àí1
< ‚àû
is said to be of class (Ap,Ap). The quantity [u,w](Ap,Ap) is called the (Ap,Ap) char-
acteristic constant of the pair (u,w).
(a) Suppose that pair of weights (u,w) is of class (Ap,Ap). Show that for all non-
negative measurable functions f and all cubes Q‚Ä≤ we have
 1
|Q‚Ä≤|

Q‚Ä≤ | f|dx
p
u(Q‚Ä≤) ‚â§C0

Q‚Ä≤ | f|pwdx,
where C0 = [u,w](Ap,Ap).
(b) Suppose that a pair of weights (u,w) satisÔ¨Åes the inequality in part (a) for some
constant C0. Prove that M maps Lp(w) to Lp,‚àû(u) with norm at most C(n, p)C1/p
0
,
where C(n, p) is a Ô¨Åxed constant.
(c) Suppose that for a pair of weights (u,w), M maps Lp(w) to Lp,‚àû(u). Show that
the pair (u,w) is of class (Ap,Ap).

Hint: Part (b): Replacing f by f œáQ in part (a), where Q ‚äÜQ‚Ä≤, obtain that
u(Q‚Ä≤) ‚â§C0|Q‚Ä≤|p

Q | f|pwdx

Q | f|dx
p .
Then use Exercise 5.3.9 to Ô¨Ånd disjoint cubes Qj such that the set EŒ± = {x ‚ààRn :
Mc( f)(x) > Œ±} is contained in the union of 3Qj and Œ±
4n <
1
|Qj|

Qj | f(t)|dt ‚â§Œ±
2n .
Then u(EŒ±) ‚â§‚àëj u(3Qj), and bound each u(3Qj) by taking Q‚Ä≤ = 3Qj and Q = Qj in
the preceding estimate. Part (c): First prove the assertion in part (b) and then derive
the inequality in part (a) by adapting the idea in the discussion in the beginning of
Subsection 7.1.1.


7.1 The Ap Condition
513
7.1.7. ([122]) Let 1 < p < ‚àûand let (u,w) be a pair of weights of class (Ap,Ap).
Show that for any q with p < q < ‚àûthere is a constant Cp,q,n < ‚àûsuch that for all
f ‚ààLq(w) we have

Rn M( f)(x)qu(x)dx
1/q
‚â§Cp,q,n

Rn f(x)qw(x)dx
1/q
.

Hint: Use Exercise 7.1.6 and interpolate between Lp and L‚àû.

7.1.8. Let k > 0. For an A1 weight w show that [min(w,k)]A1 ‚â§[w]A1. If 1 < p < ‚àû
and w ‚ààAp, show that
[min(w,k)]Ap ‚â§cp[w]Ap ,
where cp = 1 if 1 < p ‚â§2 and cp = 2p‚àí1 if 2 < p < ‚àû.

Hint: Use the inequality
1
|Q|

Q min(w,k)‚àí
1
p‚àí1 dx ‚â§1
|Q|

Q w‚àí
1
p‚àí1 dx+k‚àí
1
p‚àí1 and also
1
|Q|

Q min(w,k)dx ‚â§min
	
k, 1
|Q|

Q wdx

.

7.1.9. Suppose that wj ‚ààAp j with 1 ‚â§j ‚â§m for some 1 ‚â§p1,..., pm < ‚àûand let
0 < Œ∏1,...,Œ∏m < 1 be such that Œ∏1 +¬∑¬∑¬∑+Œ∏m = 1. Show that
wŒ∏1
1 ¬∑¬∑¬∑wŒ∏m
m ‚ààAmax{p1,...,pm} .

Hint: First note that each weight wj lies in Amax{p1,...,pm} and then apply H¬®older‚Äôs
inequality.

7.1.10. Let w1 ‚ààAp1 and w2 ‚ààAp2 for some 1 ‚â§p1, p2 < ‚àû. Prove that
[w1 +w2]Ap ‚â§[w1]Ap1 +[w2]Ap2 ,
where p = max(p1, p2).
7.1.11. Show that the function
u(x) =

log 1
|x|
when |x| < 1
e,
1
otherwise,
in Example 7.1.8 is an A1 weight on Rn.

Hint: Use [u]balls
A1
instead of [u]A1 and consider balls of type I and II as in Example
7.1.7.

7.1.12. Let 1 < p < ‚àûand w ‚ààA1. Show that the uncentered Hardy-Littlewood
maximal function M maps Lp,‚àû(w) to itself.

Hint: Prove Ô¨Årst the inequality
w({M(g) > Œª}) ‚â§
3n([w]balls
A1
)2
Œª

{M(g)>Œª} |g|wdx
and then use the characterization of Lp,‚àûgiven in Exercise 1.1.12.]

514
7 Weighted Inequalities
7.2 Reverse H¬®older Inequality for Ap Weights and Consequences
An essential property of Ap weights is that they assign to subsets of balls mass
proportional to the percentage of the Lebesgue measure of the subset within the
ball. The following lemma provides a way to quantify this statement.
Lemma 7.2.1. Let w ‚ààAp for some 1 ‚â§p < ‚àûand let 0 < Œ± < 1. Then there exists
Œ≤ < 1 such that whenever S is a measurable subset of a cube Q that satisÔ¨Åes |S| ‚â§
Œ±|Q|, we have w(S) ‚â§Œ≤ w(Q).
Proof. Taking f = œáA in property (8) of Proposition 7.1.5, we obtain
 |A|
|Q|
p
‚â§[w]Ap
w(A)
w(Q) .
(7.2.1)
We write S = Q\A to get

1‚àí|S|
|Q|
p
‚â§[w]Ap

1‚àíw(S)
w(Q)

.
(7.2.2)
Given 0 < Œ± < 1, set
Œ≤ = 1‚àí(1‚àíŒ±)p
[w]Ap
(7.2.3)
and use (7.2.2) to obtain the required conclusion.
‚ñ°
7.2.1 The Reverse H¬®older Property of Ap Weights
We are now ready to state and prove one of the main results of the theory of weights,
the reverse H¬®older inequality for Ap weights.
Theorem 7.2.2. Let w ‚ààAp for some 1 ‚â§p < ‚àû. Then there exist constants C and
Œ≥ > 0 that depend only on the dimension n, on p, and on [w]Ap such that for every
cube Q we have
 1
|Q|

Q w(t)1+Œ≥ dt

1
1+Œ≥
‚â§C
|Q|

Q w(t)dt .
(7.2.4)
Proof. Let us Ô¨Åx a cube Q and set
Œ±0 = 1
|Q|

Q w(x)dx.
We also Ô¨Åx 0 < Œ± < 1. We deÔ¨Åne an increasing sequence of scalars
Œ±0 < Œ±1 < Œ±2 < ¬∑¬∑¬∑ < Œ±k < ¬∑¬∑¬∑

7.2 Reverse H¬®older Inequality and Consequences
515
for k ‚â•0 by setting
Œ±k+1 = 2nŒ±‚àí1Œ±k
or
Œ±k = (2nŒ±‚àí1)kŒ±0,
and for each k ‚â•1 we apply a Calder¬¥on‚ÄìZygmund decomposition to w at height Œ±k.
Precisely, for dyadic subcubes R of Q, we let
1
|R|

R w(x)dx > Œ±k
(7.2.5)
be the selection criterion. Since Q does not satisfy the selection criterion, it is not
selected. We divide the cube Q into a mesh of 2n subcubes of equal side length, and
among these cubes we select those that satisfy (7.2.5). We subdivide each unselected
subcube into 2n cubes of equal side length and we continue in this way indeÔ¨Ånitely.
We denote by {Qk, j}j the collection of all selected subcubes of Q. We observe that
the following properties are satisÔ¨Åed:
(1) Œ±k <
1
|Qk, j|

Qk, j
w(t)dt ‚â§2nŒ±k.
(2) For almost all x /‚ààUk we have w(x) ‚â§Œ±k, where Uk = 
j
Qk, j.
(3) Each Qk+1, j is contained in some Qk,l.
Property (1) is satisÔ¨Åed since the unique dyadic parent of Qk, j was not chosen in the
selection procedure. Property (2) follows from the Lebesgue differentiation theorem
using the fact that for almost all x /‚ààUk there exists a sequence of unselected cubes
of decreasing lengths whose closures‚Äô intersection is the singleton {x}. Property (3)
is satisÔ¨Åed since each Qk, j is the maximal subcube of Q satisfying (7.2.5). And since
the average of w over Qk+1, j is also bigger than Œ±k, it follows that Qk+1, j must be
contained in some maximal cube that possesses this property.
We now compute the portion of Qk,l that is covered by cubes of the form Qk+1, j
for some j. We have
2nŒ±k ‚â•
1
|Qk,l|

Qk,l‚à©Uk+1
w(t)dt
=
1
|Qk,l|
‚àë
j:Qk+1, j‚äÜQk,l
|Qk+1, j|
1
|Qk+1, j|

Qk+1, j
w(t)dt
>
Qk,l ‚à©Uk+1

|Qk,l|
Œ±k+1
=
Qk,l ‚à©Uk+1

|Qk,l|
2nŒ±‚àí1Œ±k .
It follows that
Qk,l ‚à©Uk+1
 ‚â§Œ±|Qk,l|; thus, applying Lemma 7.2.1, we obtain
w(Qk,l ‚à©Uk+1)
w(Qk,l)
< Œ≤ = 1‚àí(1‚àíŒ±)p
[w]Ap
,

516
7 Weighted Inequalities
from which, summing over all l, we obtain
w(Uk+1) ‚â§Œ≤w(Uk).
The latter gives w(Uk) ‚â§Œ≤ kw(U0). We also have |Uk+1| ‚â§Œ±|Uk|; hence |Uk| ‚Üí0 as
k ‚Üí‚àû. Therefore, the intersection of the Uk‚Äôs is a set of Lebesgue measure zero. We
can therefore write
Q =

Q\U0
 ‚àû

k=0
Uk \Uk+1

modulo a set of Lebesgue measure zero. Let us now Ô¨Ånd a Œ≥ > 0 such that the reverse
H¬®older inequality (7.2.4) holds. We have w(x) ‚â§Œ±k for almost all x in Q \Uk and
therefore

Q w(t)1+Œ≥ dt =

Q\U0
w(t)Œ≥w(t)dt +
‚àû
‚àë
k=0

Uk\Uk+1
w(t)Œ≥w(t)dt
‚â§Œ±Œ≥
0w(Q\U0)+
‚àû
‚àë
k=0
Œ±Œ≥
k+1w(Uk)
‚â§Œ±Œ≥
0w(Q\U0)+
‚àû
‚àë
k=0
((2nŒ±‚àí1)k+1Œ±0)Œ≥Œ≤ kw(U0)
‚â§Œ±Œ≥
0

1+(2nŒ±‚àí1)Œ≥
‚àû
‚àë
k=0
(2nŒ±‚àí1)Œ≥kŒ≤ k

w(Q)
=
 1
|Q|

Q w(t)dt
Œ≥
1+
(2nŒ±‚àí1)Œ≥
1‚àí(2nŒ±‚àí1)Œ≥Œ≤

Q w(t)dt ,
provided Œ≥ > 0 is chosen small enough that (2nŒ±‚àí1)Œ≥Œ≤ < 1. Keeping track of the
constants, we conclude the proof of the theorem with
Œ≥ = 1
2
‚àílogŒ≤
log2n ‚àílogŒ± = log

[w]Ap

‚àílog

[w]Ap ‚àí(1‚àíŒ±)p
2log 2n
Œ±
(7.2.6)
and
CŒ≥+1 = 1+
(2nŒ±‚àí1)Œ≥
1‚àí(2nŒ±‚àí1)Œ≥Œ≤
= 1+
(2nŒ±‚àí1)Œ≥
1‚àí(2nŒ±‚àí1)Œ≥
1‚àí(1‚àíŒ±)p
[w]Ap

= 1+
1
(2nŒ±‚àí1)‚àíŒ≥ ‚àí

1‚àí(1‚àíŒ±)p
[w]Ap
 ,

7.2 Reverse H¬®older Inequality and Consequences
517
which yields
C =

1+
1

1‚àí(1‚àíŒ±)p
[w]Ap
 1
2 ‚àí

1‚àí(1‚àíŒ±)p
[w]Ap


2log 2n
Œ±
2log 2n
Œ± ‚àílog

1‚àí(1‚àíŒ±)p
[w]Ap

.
(7.2.7)
Note that up to this point, Œ± was an arbitrary number in (0,1).
‚ñ°
Remark 7.2.3. It is worth observing that for Œ± such that (1‚àíŒ±)p = 3
4, the constant
Œ≥ in (7.2.6) decreases as [w]Ap increases, while the constant C in (7.2.7) increases as
[w]Ap increases. This is because 1‚àí3
4[w]‚àí1
Ap ‚â•1
4 and for t ‚àà( 1
4,1) the function ‚àöt ‚àít
is decreasing. This allows us to obtain the following stronger version of Theorem
7.2.2: For any 1 ‚â§p < ‚àûand B > 1, there exist positive constants C = C(n, p,B)
and Œ≥ = Œ≥(n, p,B) such that for all w ‚ààAp satisfying [w]Ap ‚â§B the reverse H¬®older
condition (7.2.4) holds for every cube Q. See Exercise 7.2.4(a) for details.
Observe that in the proof of Theorem 7.2.2 it was crucial to know that for some
0 < Œ±,Œ≤ < 1 we have
|S| ‚â§Œ± |Q| =‚áíw(S) ‚â§Œ≤ w(Q)
(7.2.8)
whenever S is a subset of the cube Q. No special property of Lebesgue measure was
used in the proof of Theorem 7.2.2 other than its doubling property. Therefore, it is
reasonable to ask whether Lebesgue measure in (7.2.8) can be replaced by a general
measure Œº satisfying the doubling property
Œº(3Q) ‚â§Cn Œº(Q) < ‚àû
(7.2.9)
for all cubes Q in Rn. A straightforward adjustment of the proof of the previous
theorem indicates that this is indeed the case.
Corollary 7.2.4. Let w be a weight and let Œº be a measure on Rn satisfying (7.2.9).
Suppose that there exist 0 < Œ±,Œ≤ < 1, such that
Œº(S) ‚â§Œ± Œº(Q) =‚áí

S w(t)dŒº(t) ‚â§Œ≤

Q w(t)dŒº(t)
whenever S is a Œº-measurable subset of a cube Q. Then there exist 0 < C,Œ≥ < ‚àû
[which depend only on the dimension n, the constant Cn in (7.2.9), Œ±, and Œ≤] such
that for every cube Q in Rn we have

1
Œº(Q)

Q w(t)1+Œ≥ dŒº(t)

1
1+Œ≥
‚â§
C
Œº(Q)

Q w(t)dŒº(t).
(7.2.10)
Proof. The proof of the corollary can be obtained almost verbatim from that of
Theorem 7.2.2 by replacing Lebesgue measure with the doubling measure dŒº and
the constant 2n by Cn.

518
7 Weighted Inequalities
Precisely, we deÔ¨Åne Œ±k = (CnŒ±‚àí1)kŒ±0, where Œ±0 is the Œº-average of w over Q;
then properties (1), (2), (3) concerning the selected cubes {Qk, j}j are replaced by
(1Œº) Œ±k <
1
Œº(Qk, j)

Qk, j
w(t)dŒº(t) ‚â§Cn Œ±k.
(2Œº) On Q\Uk we have w ‚â§Œ±k Œº-almost everywhere, where Uk = 
j
Qk, j.
(3Œº) Each Qk+1, j is contained in some Qk,l.
To prove the upper inequality in (1Œº) we use that the dyadic parent of each selected
cube Qk, j was not selected and is contained in 3Qk, j. To prove (2Œº) we need a dif-
ferentiation theorem for doubling measures, analogous to that in Corollary 2.1.16.
This can be found in Exercise 2.1.1. The remaining details of the proof are trivially
adapted to the new setting. The conclusion is that for
0 < Œ≥ <
‚àílogŒ≤
logCn ‚àílogŒ±
(7.2.11)
and
C =

1+
(CnŒ±‚àí1)Œ≥
1‚àí(CnŒ±‚àí1)Œ≥Œ≤

1
Œ≥+1
,
(7.2.12)
(7.2.10) is satisÔ¨Åed. Notice that the choice of the constants (7.2.6) and (7.2.7) is valid
in this case with Cn in place of 2n.
‚ñ°
7.2.2 Consequences of the Reverse H¬®older Property
Having established the crucial reverse H¬®older inequality for Ap weights, we now
pass to some very important applications. Among them, the Ô¨Årst result of this section
yields that an Ap weight that lies a priori in L1
loc(Rn) must actually lie in the better
space L1+œÉ
loc (Rn) for some œÉ > 0 depending on the weight.
Theorem 7.2.5. If w ‚ààAp for some 1 ‚â§p < ‚àû, then there exists a number Œ≥ > 0
(that depends on n, p, and [w]Ap) such that w1+Œ≥ ‚ààAp.
Proof. Let C be the constant in the proof of Theorem 7.2.2. When p = 1, we apply
the reverse H¬®older inequality of Theorem 7.2.2 to the weight w to obtain
1
|Q|

Q w(t)1+Œ≥ dt ‚â§
 C
|Q|

Q w(t)dt
1+Œ≥
‚â§C1+Œ≥[w]1+Œ≥
A1 w(x)1+Œ≥
for almost all x in the cube Q. Therefore, w1+Œ≥ is an A1 weight with characteristic
constant at most C1+Œ≥[w]1+Œ≥
A1 . When p > 1, there exist Œ≥1,Œ≥2 > 0 and C1,C2 > 0 such
that the reverse H¬®older inequality of Theorem 7.2.2 holds for the weights w ‚ààAp
and w‚àí
1
p‚àí1 ‚ààAp‚Ä≤, that is,

7.2 Reverse H¬®older Inequality and Consequences
519
 1
|Q|

Q w(t)1+Œ≥1dt

1
1+Œ≥1 ‚â§C1
|Q|

Q w(t)dt,
 1
|Q|

Q w(t)‚àí
1
p‚àí1 (1+Œ≥2)dt

1
1+Œ≥2 ‚â§C2
|Q|

Q w(t)‚àí
1
p‚àí1 dt .
Taking Œ≥ = min(Œ≥1,Œ≥2), both inequalities are satisÔ¨Åed with Œ≥ in the place of Œ≥1, Œ≥2. It
follows that w1+Œ≥ is in Ap and satisÔ¨Åes
[w1+Œ≥]Ap ‚â§(C1Cp‚àí1
2
)1+Œ≥[w]1+Œ≥
Ap .
(7.2.13)
This concludes the proof of the theorem.
‚ñ°
Corollary 7.2.6. For any 1 < p < ‚àûand for every w ‚ààAp there is a q = q(n, p,[w]Ap)
with q < p such that w ‚ààAq. In other words, we have
Ap =

q‚àà(1,p)
Aq .
Proof. Given w ‚ààAp, let Œ≥,C1,C2 be as in the proof of Theorem 7.2.5. In view of
the result in Exercise 7.1.3 with Œ¥ = 1/(1+Œ≥), if w1+Œ≥ ‚ààAp and
q = p
1
1+Œ≥ +1‚àí
1
1+Œ≥ = p+Œ≥
1+Œ≥ ,
then w ‚ààAq and
[w]Aq = [(w1+Œ≥)
1
1+Œ≥ ]Aq ‚â§

w1+Œ≥
1
1+Œ≥
Ap ‚â§C1Cp‚àí1
2
[w]Ap ,
where the last estimate comes from (7.2.13). Since 1 < q = p+Œ≥
1+Œ≥ < p, the required
conclusion follows. Observe that the constants C1Cp‚àí1
2
, q, and 1
Œ≥ increase as [w]Ap
increases.
‚ñ°
Another powerful consequence of the reverse H¬®older property of Ap weights is
the following characterization of all A1 weights.
Theorem 7.2.7. Let w be an A1 weight. Then there exist 0 < Œµ < 1, a nonnegative
function k such that k,k‚àí1 ‚ààL‚àû, and a nonnegative locally integrable function f
that satisÔ¨Åes M( f) < ‚àûa.e. such that
w(x) = k(x)M( f)(x)Œµ .
(7.2.14)
Conversely, given a nonnegative function k such that k,k‚àí1 ‚ààL‚àûand given a
nonnegative locally integrable function f that satisÔ¨Åes M( f) < ‚àûa.e., deÔ¨Åne w via
(7.2.14). Then w is an A1 weight that satisÔ¨Åes
[w]A1 ‚â§
Cn
1‚àíŒµ ‚à•k‚à•L‚àû‚à•k‚àí1‚à•L‚àû,
(7.2.15)
where Cn is a universal dimensional constant.

520
7 Weighted Inequalities
Proof. In view of Theorem 7.2.2, there exist 0 < Œ≥,C < ‚àûsuch that the reverse
H¬®older condition
 1
|Q|

Q w(t)1+Œ≥ dt

1
1+Œ≥
‚â§C
|Q|

Q w(t)dt ‚â§C[w]A1w(x)
(7.2.16)
holds for all cubes Q and for all x in Q\EQ, where EQ is a null subset of Q. We set
Œµ =
1
1+Œ≥
and
f(x) = w(x)1+Œ≥ = w(x)
1
Œµ .
Letting N be the union of EQ over all Q with rational radii and centers in Qn, it
follows from (7.2.16) that the uncentered Hardy‚ÄìLittlewood maximal function Mc( f)
with respect to cubes satisÔ¨Åes
Mc( f)(x) ‚â§C1+Œ≥[w]1+Œ≥
A1 f(x)
for x ‚ààRn \N.
This implies that M( f) ‚â§CnC1+Œ≥[w]1+Œ≥
A1 f a.e. for some constant Cn that depends
only on the dimension. We now set
k(x) =
f(x)Œµ
M( f)(x)Œµ ,
and we observe that C‚àí1C‚àíŒµ
n [w]‚àí1
A1 ‚â§k ‚â§1 a.e.
It remains to prove the converse. Given a weight w = kM( f)Œµ in the form (7.2.14)
and a cube Q, it sufÔ¨Åces to show that
1
|Q|

Q M( f)(t)Œµ dt ‚â§
Cn
1‚àíŒµ M( f)Œµ(x)
for almost all x ‚ààQ,
(7.2.17)
since then (7.2.15) follows trivially from (7.2.17) with w = kM( f)Œµ using that
k,k‚àí1 ‚ààL‚àû. To prove (7.2.17), we write
f = f œá3Q + f œá(3Q)c .
Then
1
|Q|

Q M( f œá3Q)(t)Œµ dt ‚â§
C‚Ä≤
n
1‚àíŒµ
 1
|Q|

Rn( f œá3Q)(t)dt
Œµ
(7.2.18)
in view of Kolmogorov‚Äôs inequality (Exercise 2.1.5). But the last expression in
(7.2.18) is at most a dimensional multiple of M( f)(x)Œµ for almost all x ‚ààQ, which
proves (7.2.17) when f is replaced by f œá3Q on the left-hand side of the inequality.
And for f œá(3Q)c we only need to notice that
M( f œá(3Q)c)(t) ‚â§2nM( f œá(3Q)c)(t) ‚â§2nn
n
2 M( f)(x)

7.2 Reverse H¬®older Inequality and Consequences
521
for all x,t in Q, since any ball B centered at t that gives a nonzero average for
f œá(3Q)c must have radius at least the side length of Q, and thus ‚àönB must also
contain x. (Here M is the centered Hardy‚ÄìLittlewood maximal operator introduced
in DeÔ¨Ånition 2.1.1.) Hence (7.2.17) also holds when f is replaced by f œá(3Q)c on the
left-hand side. Combining these two estimates and using the subadditivity property
M( f1 + f2)Œµ ‚â§M( f1)Œµ +M( f2)Œµ, we obtain (7.2.17).
‚ñ°
We end this section with the following consequence of the reverse H¬®older prop-
erty of Ap weights which can be viewed as a reverse property to (7.2.1).
Proposition 7.2.8. Let 1 ‚â§p < ‚àûand w ‚ààAp. Then there exist Œ¥ ‚àà(0,1) and C > 0
depending only on n, p, and [w]Ap such that for any cube Q and any measurable
subset S of Q we have
w(S)
w(Q) ‚â§C
 |S|
|Q|
Œ¥
.
Proof. Let C and Œ≥ be as in Theorem 7.2.2. We use H¬®older‚Äôs inequality to write
w(S)
w(Q) =
1
w(Q)

Q w(x)œáS(x)dx
‚â§
1
w(Q)

Q w(x)1+Œ≥ dx

1
1+Œ≥
|S|
Œ≥
1+Œ≥
=
1
w(Q)
 1
|Q|

Q w(x)1+Œ≥ dx

1
1+Œ≥
|Q|
1
1+Œ≥ |S|
Œ≥
1+Œ≥
=
C
w(Q)

Q w(x)dx

|Q|‚àí
Œ≥
1+Œ≥ |S|
Œ≥
1+Œ≥
= C
 |S|
|Q|
Œ¥
,
where Œ¥ =
Œ≥
1+Œ≥ . This proves the assertion.
‚ñ°
Exercises
7.2.1. Let w ‚ààAp for some 1 < p < ‚àûand let 1 ‚â§q < ‚àû. Prove that the sublinear
operator
S( f) =

M(| f|qw)w‚àí1 1
q
is bounded on Lp‚Ä≤q(w).
7.2.2. Let v be a real-valued locally integrable function on Rn and let 1 < p < ‚àû.
For a cube Q, let ŒΩQ be the average of ŒΩ over Q.

522
7 Weighted Inequalities
(a) If ev is an Ap weight, show that
sup
Q cubes
1
|Q|

Q ev(t)‚àívQ dt ‚â§[eŒΩ]Ap ,
sup
Q cubes
1
|Q|

Q e‚àí(v(t)‚àívQ)
1
p‚àí1 dt ‚â§[eŒΩ]Ap .
(b) Conversely, if the preceding inequalities hold with some constant C in place of
[ŒΩ]Ap, then ŒΩ lies in Ap with [ŒΩ]Ap ‚â§C.

Hint: Part (a): If ev ‚ààAp, use that
1
|Q|

Q ev(t)‚àívQ dt ‚â§

Avg
Q
e‚àí
v
p‚àí1
p‚àí1 
Avg
Q
ev
and obtain a similar estimate for the second quantity.

7.2.3. This exercise assumes familiarity with the space BMO.
(a) Show that if œï ‚ààA2, then logœï ‚ààBMO and ‚à•logœï‚à•BMO ‚â§[œï]A2.
(b) Prove that every BMO function is equal to a constant multiple of the logarithm
of an A2 weight. Precisely, given f ‚ààBMO show that

ec f 
A2 ‚â§1+2e,
where c = 1/(2n+1‚à•f‚à•BMO).
(c) Prove that if œï is in Ap for some 1 < p < ‚àû, then logœï is in BMO by showing
that
logœï

BMO ‚â§
‚éß
‚é®
‚é©
[œï]Ap
when 1 < p ‚â§2,
(p‚àí1)[œï]
1
p‚àí1
Ap
when 2 < p < ‚àû.

Hint: Part (a): Use Exercise 7.2.2 with p = 2. Part (b): Use Exercise 7.2.2 and
Corollary 3.1.7 in [131]. Use Part (c): Use that œï‚àí
1
p‚àí1 ‚ààAp‚Ä≤ when p > 2.

7.2.4. Prove
the
following
quantitative
versions
of
Theorem
7.2.2
and
Corollary 7.2.6.
(a) For any 1 ‚â§p < ‚àûand B > 1, there exists a positive constant C3(n, p,B) and
Œ≥ = Œ≥(n, p,B) such that for all w ‚ààAp satisfying [w]Ap ‚â§B, (7.2.4) holds for every
cube Q with C3(n, p,B) in place of C.
(b) Given any 1 < p < ‚àûand B > 1 there exists a constant C4(n, p,B) and Œ¥ =
Œ¥(n, p,B) such that for all w ‚ààAp we have
[w]Ap ‚â§B =‚áí[w]Ap‚àíŒ¥ ‚â§C4(n, p,B).
7.2.5. Given a positive doubling measure Œº on Rn, deÔ¨Åne the characteristic constant
[w]Ap(Œº) and the class Ap(Œº) for 1 < p < ‚àû.
(a) Show that statement (8) of Proposition 7.1.5 remains valid if Lebesgue measure
is replaced by Œº.

7.2 Reverse H¬®older Inequality and Consequences
523
(b) Obtain as a consequence that if w ‚ààAp(Œº), then for all cubes Q and all Œº-
measurable subsets A of Q we have
 Œº(A)
Œº(Q)
p
‚â§[w]Ap(Œº)
w(A)
w(Q) .
Conclude that if Lebesgue measure is replaced by Œº in Lemma 7.2.1, then the lemma
is valid for w ‚ààAp(Œº).
(c) Use Corollary 7.2.4 to obtain that weights in Ap(Œº) satisfy a reverse H¬®older
condition.
(d) Prove that given a weight w ‚ààAp(Œº), there exists 1 < q < p, which depends on
[w]Ap(Œº), such that w ‚ààAq(Œº).
7.2.6. Let 1 < q < ‚àûand Œº a positive measure on Rn. We say that a positive function
K on Rn satisÔ¨Åes a reverse H¬®older condition of order q with respect to Œº, symboli-
cally K ‚ààRHq(Œº), if
[K]RHq(Œº) =
sup
Qcubes in Rn

1
Œº(Q)

Q Kq dŒº
 1
q
1
Œº(Q)

Q K dŒº
< ‚àû.
For positive functions u,v on Rn and 1 < p < ‚àû, show that
[vu‚àí1]RHp‚Ä≤(udx) = [uv‚àí1]
1
p
Ap(vdx) ,
that is, vu‚àí1 satisÔ¨Åes a reverse H¬®older condition of order p‚Ä≤ with respect to udx if
and only if uv‚àí1 is in Ap(vdx). Conclude that
w ‚ààRHp‚Ä≤(dx) ‚áê‚áíw‚àí1 ‚ààAp(wdx),
w ‚ààAp(dx) ‚áê‚áíw‚àí1 ‚ààRHp‚Ä≤(wdx).
7.2.7. ([125]) Suppose that a positive function K on Rn lies in RHp(dx) for some
1 < p < ‚àû. Show that there exists a Œ¥ > 0 such that K lies in RHp+Œ¥(dx).

Hint: By Exercise 7.2.6, K ‚ààRHp(dx) is equivalent to the fact that K‚àí1 ‚ààAp‚Ä≤(K dx),
and the index p‚Ä≤ can be improved by Exercise 7.2.5 (d).

7.2.8. (a) Show that for any w ‚ààA1 and any cube Q in Rn and a > 1 we have
ess.inf
Q
w ‚â§an[w]A1 ess.inf
aQ
w.
(b) Prove that there is a constant Cn such that for all locally integrable functions f
on Rn and all cubes Q in Rn we have
ess.inf
Q
M( f) ‚â§Cn ess.inf
3Q
M( f),
and an analogous statement is valid for Mc.

524
7 Weighted Inequalities

Hint: Part (a): Use (7.1.18). Part (b): Apply part (a) to M( f)
1
2 , which is an A1 weight
in view of Theorem 7.2.7.

7.2.9. ([223]) For a weight w ‚ààA1(Rn) deÔ¨Åne a quantity r = 1 +
1
2n+1[w]A1 . Show
that
Mc(wr)
1
r ‚â§2[w]A1 w
a.e.

Hint: Fix a cube Q and consider the family FQ of all cubes obtained by subdividing
Q into a mesh of (2n)m subcubes of side length 2‚àím‚Ñì(Q) for all m = 1,2,.... DeÔ¨Åne
Md
Q( f)(x) = supR‚ààFQ,R‚àãx |R|‚àí1 
R | f|dy. Using Corollary 2.1.21 obtain

Q‚à©{Md
Q(w)>Œª} w(x)dx ‚â§2nŒª|{x ‚ààQ : Md
Q(w)(x) > Œª}|
for Œª > wQ =
1
|Q|

Q wdt. Multiply by Œª Œ¥‚àí1 and integrate to obtain

Q Md
Q(w)Œ¥wdx ‚â§(wQ)Œ¥

Q wdx+ 2nŒ¥
Œ¥ +1

Q Md
Q(w)Œ¥+1dx.
Replace w by wk = min(k,w) and select Œ¥ =
1
2n+1[w]A1 to deduce
1
|Q|

Q wŒ¥+1
k
dx ‚â§1
|Q|

Q Md
Q(wk)Œ¥wk dx ‚â§2(wQ)Œ¥+1,
using [wk]A1 ‚â§[w]A1. Then let k ‚Üí‚àû.

7.2.10. Let 1 < p < ‚àû. Recall that a pair of weights (u,w) that satisÔ¨Åes
[u,w](Ap,Ap) = sup
Q cubes
in Rn
 1
|Q|

Q udx
 1
|Q|

Q w‚àí
1
p‚àí1 dx
p‚àí1
< ‚àû
is said to be of class (Ap,Ap). The quantity [u,w](Ap,Ap) is called the (Ap,Ap) char-
acteristic constant of the pair (u,w).
(a) Show that for any g ‚ààL1
loc(Rn) with 0 < g < ‚àûa.e., the pair (g,M(g)) is of class
(Ap,Ap) with characteristic constant independent of f.
(b) If (u,w) is of class (Ap,Ap), then the Hardy‚ÄìLittlewood maximal operator M
may not map Lp(w) to Lp(u).
(c) Given g ‚ààL1
loc(Rn) with 0 < g < ‚àûa.e., conclude that Hardy‚ÄìLittlewood max-
imal operator M maps Lp(M(g)dx) to Lp,‚àû(gdx) and also Lq(M(g)dx) to Lq(gdx)
for any q with p < q < ‚àû.

Hint: Part (a): Use H¬®older‚Äôs inequality and Theorem 7.2.7. Part (b): Try the pair

M(g)1‚àíp,|g|1‚àíp
for a suitable g. Part (c): Use Exercises 7.1.6 and 7.1.7.


7.3 The A‚àûCondition
525
7.3 The A‚àûCondition
In this section we examine more closely the class of all Ap weights. It turns out that
Ap weights possess properties that are p-independent but delicate enough to char-
acterize them without reference to a speciÔ¨Åc value of p. The Ap classes increase
as p increases, and it is only natural to consider their limit as p ‚Üí‚àû. Not surpris-
ingly, a condition obtained as a limit of the Ap conditions as p ‚Üí‚àûprovides some
unexpected but insightful characterizations of the class of all Ap weights.
7.3.1 The Class of A‚àûWeights
Let us start by recalling a simple consequence of Jensen‚Äôs inequality:

X |h(t)|q dŒº(t)
 1
q
‚â•exp

X log|h(t)|dŒº(t)

,
(7.3.1)
which holds for all measurable functions h on a probability space (X,Œº) and all
0 < q < ‚àû. See Exercise 1.1.3(b). Moreover, part (c) of the same exercise says that
the limit of the expressions on the left in (7.3.1) as q ‚Üí0 is equal to the expression
on the right in (7.3.1).
We apply (7.3.1) to the function h = w‚àí1 for some weight w in Ap with q =
1/(p‚àí1). We obtain
w(Q)
|Q|
 1
|Q|

Q w(t)‚àí
1
p‚àí1 dt
p‚àí1
‚â•w(Q)
|Q| exp
 1
|Q|

Q logw(t)‚àí1 dt

,
(7.3.2)
and the limit of the expressions on the left in (7.3.2) as p ‚Üí‚àûis equal to the ex-
pression on the right in (7.3.2). This observation provides the motivation for the
following deÔ¨Ånition.
DeÔ¨Ånition 7.3.1. A weight w is called an A‚àûweight if
[w]A‚àû=
sup
Q cubes in Rn
$ 1
|Q|

Q w(t)dt

exp
 1
|Q|

Q logw(t)‚àí1 dt
%
< ‚àû.
The quantity [w]A‚àûis called the A‚àûcharacteristic constant of w.
It follows from the previous deÔ¨Ånition and (7.3.2) that for all 1 ‚â§p < ‚àûwe have
[w]A‚àû‚â§[w]Ap .
This means that

1‚â§p<‚àû
Ap ‚äÜA‚àû,
(7.3.3)

526
7 Weighted Inequalities
but the remarkable thing is that equality actually holds in (7.3.3), a deep property
that requires some work.
Before we examine this and other characterizations of A‚àûweights, we discuss
some of their elementary properties.
Proposition 7.3.2. Let w ‚ààA‚àû. Then
(1) [Œ¥ Œª(w)]A‚àû= [w]A‚àû, where Œ¥ Œª(w)(x) = w(Œªx1,...,Œªxn) and Œª > 0.
(2) [œÑz(w)]A‚àû= [w]A‚àû, where œÑz(w)(x) = w(x‚àíz), z ‚ààRn.
(3) [Œªw]A‚àû= [w]A‚àûfor all Œª > 0.
(4) [w]A‚àû‚â•1.
(5) The following is an equivalent characterization of the A‚àûcharacteristic constant
of w:
[w]A‚àû= sup
Qcubes
in Rn
sup
log| f| ‚ààL1(Q)

Q | f|wdt > 0
$
w(Q)

Q | f(t)|w(t)dt exp
 1
|Q|

Q log| f(t)|dt
%
.
(6) The measure w(x)dx is doubling; precisely, for all Œª > 1 and all cubes Q we
have
w(ŒªQ) ‚â§2Œª n[w]Œª n
A‚àûw(Q).
As usual, ŒªQ here denotes the cube with the same center as Q and side length
Œª times that of Q.
We note that estimate (6) is not as good as Œª ‚Üí‚àûbut it can be substantially
improved using the case Œª = 2. We refer to Exercise 7.3.1 for an improvement.
Proof. Properties (1)‚Äì(3) are elementary, while property (4) is a consequence of
Exercise 1.1.3(b). To show (5), Ô¨Årst observe that by taking f = w‚àí1, the expression
on the right in (5) is at least as big as [w]A‚àû. Conversely, (7.3.1) gives
exp
 1
|Q|

Q log

| f(t)|w(t)

dt

‚â§1
|Q|

Q | f(t)|w(t)dt ,
which, after a simple algebraic manipulation, can be written as
w(Q)

Q | f|wdt exp
 1
|Q|

Q log| f|dt

‚â§w(Q)
|Q| exp

‚àí1
|Q|

Q log|w|dt

,
whenever f does not vanish almost everywhere on Q. Taking the supremum over all
such f and all cubes Q in Rn, we obtain that the expression on the right in (5) is at
most [w]A‚àû.

7.3 The A‚àûCondition
527
To prove the doubling property for A‚àûweights, we Ô¨Åx Œª > 1 and we apply prop-
erty (5) to the cube ŒªQ in place of Q and to the function
f =

c
on Q,
1
on Rn \Q,
(7.3.4)
where c is chosen so that c1/Œª n = 2[w]A‚àû. We obtain
w(ŒªQ)
w(ŒªQ\Q)+cw(Q) exp
logc
Œª n

‚â§[w]A‚àû,
which implies (6) if we take into account the chosen value of c.
‚ñ°
7.3.2 Characterizations of A‚àûWeights
Having established some elementary properties of A‚àûweights, we now turn to some
of their deeper properties, one of which is that every A‚àûweight lies in some Ap
for p < ‚àû. It also turns out that A‚àûweights are characterized by the reverse H¬®older
property, which as we saw is a fundamental property of Ap weights. The following
is the main theorem of this section.
Theorem 7.3.3. Suppose that w is a weight. Then w is in A‚àûif and only if any one
of the following conditions holds:
(a) There exist 0 < Œ≥,Œ¥ < 1 such that for all cubes Q in Rn we have
	
x ‚ààQ : w(x) ‚â§Œ≥ Avg Qw

 ‚â§Œ¥ |Q|.
(b) There exist 0 < Œ±,Œ≤ < 1 such that for all cubes Q and all measurable subsets A
of Q we have
|A| ‚â§Œ± |Q| =‚áíw(A) ‚â§Œ≤ w(Q).
(c) The reverse H¬®older condition holds for w, that is, there exist 0 < C1,Œµ < ‚àûsuch
that for all cubes Q we have
 1
|Q|

Q w(t)1+Œµ dt
 1
1+Œµ
‚â§C1
|Q|

Q w(t)dt .
(d) There exist 0 < C2,Œµ0 < ‚àûsuch that for all cubes Q and all measurable subsets
A of Q we have
w(A)
w(Q) ‚â§C2
 |A|
|Q|
Œµ0
.
(e) There exist 0 < Œ±‚Ä≤,Œ≤ ‚Ä≤ < 1 such that for all cubes Q and all measurable subsets
A of Q we have
w(A) < Œ±‚Ä≤ w(Q) =‚áí|A| < Œ≤ ‚Ä≤ |Q|.

528
7 Weighted Inequalities
(f) There exist p,C3 < ‚àûsuch that [w]Ap ‚â§C3. In other words, w lies in Ap for some
p ‚àà[1,‚àû).
All the constants C1,C2,C3,Œ±,Œ≤,Œ≥,Œ¥,Œ±‚Ä≤,Œ≤ ‚Ä≤,Œµ,Œµ0, and p in (a)‚Äì(f) depend only
on the dimension n and on [w]A‚àû. Moreover, if any of the statements in (a)‚Äì(f) is
valid, then so is any other statement in (a)‚Äì(f) with constants that depend only on
the dimension n and the constants that appear in the assumed statement.
Proof. The proof follows from the sequence of implications
w ‚ààA‚àû=‚áí(a) =‚áí(b) =‚áí(c) =‚áí(d) =‚áí(e) =‚áí( f) =‚áíw ‚ààA‚àû.
At each step we keep track of the way the constants depend on the constants of the
previous step. This is needed to validate the last assertion of the theorem.
w ‚ààA‚àû=‚áí(a)
Fix a cube Q. Since multiplication of an A‚àûweight with a positive scalar does
not alter its A‚àûcharacteristic, we may assume that

Q logw(t)dt = 0. This implies
that AvgQ w ‚â§[w]A‚àû. Then we have
{x ‚ààQ : w(x) ‚â§Œ≥ Avg
Q
w}
 ‚â§
{x ‚ààQ : w(x) ‚â§Œ≥[w]A‚àû}

=
{x ‚ààQ : log(1+w(x)‚àí1) ‚â•log(1+(Œ≥[w]A‚àû)‚àí1)}

‚â§
1
log(1+(Œ≥[w]A‚àû)‚àí1)

Q log 1+w(t)
w(t)
dt
=
1
log(1+(Œ≥[w]A‚àû)‚àí1)

Q log(1+w(t))dt
‚â§
1
log(1+(Œ≥[w]A‚àû)‚àí1)

Q w(t)dt
‚â§
[w]A‚àû|Q|
log(1+(Œ≥[w]A‚àû)‚àí1)
= 1
2|Q|,
which proves (a ) with Œ≥ = [w]‚àí1
A‚àû(e2[w]A‚àû‚àí1)‚àí1 and Œ¥ = 1
2.
(a) =‚áí(b)
Let Q be Ô¨Åxed and let A be a subset of Q with w(A) > Œ≤w(Q) for some Œ≤ to be
chosen later. Setting S = Q\A, we have w(S) < (1‚àíŒ≤)w(Q). We write S = S1 ‚à™S2,
where
S1 = {x ‚ààS : w(x) > Œ≥ Avg Qw}
and
S2 = {x ‚ààS : w(x) ‚â§Œ≥ Avg Qw}.
For S2 we have |S2| ‚â§Œ¥|Q| by assumption (a ). For S1 we use Chebyshev‚Äôs inequality
to obtain
|S1| ‚â§
1
Œ≥ Avg
Q
w

S w(t)dt = |Q|
Œ≥
w(S)
w(Q) ‚â§1‚àíŒ≤
Œ≥
|Q|.

7.3 The A‚àûCondition
529
Adding the estimates for |S1| and |S2|, we obtain
|S| ‚â§|S1|+|S2| ‚â§1‚àíŒ≤
Œ≥
|Q|+Œ¥|Q| =

Œ¥ + 1‚àíŒ≤
Œ≥

|Q|.
Choosing numbers Œ±,Œ≤ in (0,1) such that Œ¥ + 1‚àíŒ≤
Œ≥
= 1‚àíŒ±, for example Œ± = 1‚àíŒ¥
2
and Œ≤ = 1‚àí(1‚àíŒ¥)Œ≥
2
, we obtain |S| ‚â§(1‚àíŒ±)|Q|, that is, |A| > Œ±|Q|.
(b) =‚áí(c)
This was proved in Corollary 7.2.4. To keep track of the constants, we note that
the choices
Œµ =
‚àí1
2 logŒ≤
log2n ‚àílogŒ±
and
C1 = 1+
(2nŒ±‚àí1)Œµ
1‚àí(2nŒ±‚àí1)ŒµŒ≤
as given in (7.2.6) and (7.2.7) serve our purposes.
(c) =‚áí(d )
We apply Ô¨Årst H¬®older‚Äôs inequality with exponents 1 + Œµ and (1 + Œµ)/Œµ and then
the reverse H¬®older estimate to obtain

A w(x)dx ‚â§

A w(x)1+Œµ dx

1
1+Œµ
|A|
Œµ
1+Œµ
‚â§
 1
|Q|

Q w(x)1+Œµ dx

1
1+Œµ
|Q|
1
1+Œµ |A|
Œµ
1+Œµ
‚â§C1
|Q|

Q w(x)dx |Q|
1
1+Œµ |A|
Œµ
1+Œµ ,
which gives
w(A)
w(Q) ‚â§C1
 |A|
|Q|

Œµ
1+Œµ .
This proves (d ) with Œµ0 =
Œµ
1+Œµ and C2 = C1.
(d ) =‚áí(e)
Pick an 0 < Œ±‚Ä≤‚Ä≤ < 1 small enough that Œ≤ ‚Ä≤‚Ä≤ = C2(Œ±‚Ä≤‚Ä≤)Œµ0 < 1. It follows from (d )
that
|A| < Œ±‚Ä≤‚Ä≤|Q| =‚áíw(A) < Œ≤ ‚Ä≤‚Ä≤w(Q)
(7.3.5)
for all cubes Q and all A measurable subsets of Q. Replacing A by Q\A, the impli-
cation in (7.3.5) can be equivalently written as
|A| ‚â•(1‚àíŒ±‚Ä≤‚Ä≤)|Q| =‚áíw(A) ‚â•(1‚àíŒ≤ ‚Ä≤‚Ä≤)w(Q).
In other words, for measurable subsets A of Q we have
w(A) < (1‚àíŒ≤ ‚Ä≤‚Ä≤)w(Q) =‚áí|A| < (1‚àíŒ±‚Ä≤‚Ä≤)|Q|,
(7.3.6)

530
7 Weighted Inequalities
which is the statement in (e ) if we set Œ±‚Ä≤ = (1 ‚àíŒ≤ ‚Ä≤‚Ä≤) and Œ≤ ‚Ä≤ = 1 ‚àíŒ±‚Ä≤‚Ä≤. Note that
(7.3.5) and (7.3.6) are indeed equivalent.
(e) =‚áí( f)
We begin by examining condition (e ), which can be written as

A w(t)dt ‚â§Œ±‚Ä≤

Q w(t)dt =‚áí

A w(t)‚àí1w(t)dt ‚â§Œ≤ ‚Ä≤

Q w(t)‚àí1w(t)dt ,
or, equivalently, as
Œº(A) ‚â§Œ±‚Ä≤Œº(Q) =‚áí

A w(t)‚àí1 dŒº(t) ‚â§Œ≤ ‚Ä≤

Q w(t)‚àí1 dŒº(t)
after deÔ¨Åning the measure dŒº(t) = w(t)dt. As we have already seen, the assertions
in (7.3.5) and (7.3.6) are equivalent. Therefore, we may use Exercise 7.3.2 to deduce
that the measure Œº is doubling, i.e., it satisÔ¨Åes property (7.2.9) for some constant
Cn = Cn(Œ±‚Ä≤,Œ≤ ‚Ä≤), and hence the hypotheses of Corollary 7.2.4 are satisÔ¨Åed. We con-
clude that the weight w‚àí1 satisÔ¨Åes a reverse H¬®older estimate with respect to the
measure Œº, that is, if Œ≥,C are deÔ¨Åned as in (7.2.11) and (7.2.12) [in which Œ± is re-
placed by Œ±‚Ä≤, Œ≤ by Œ≤ ‚Ä≤, and Cn is the doubling constant of w(x)dx], then we have

1
Œº(Q)

Q w(t)‚àí1‚àíŒ≥ dŒº(t)

1
1+Œ≥
‚â§
C
Œº(Q)

Q w(t)‚àí1 dŒº(t)
(7.3.7)
for all cubes Q in Rn. Setting p = 1+ 1
Œ≥ and raising to the pth power, we can rewrite
(7.3.7) as the Ap condition for w. We can therefore take C3 = Cp to conclude the
proof of (f).
( f) =‚áíw ‚ààA‚àû
This is trivial, since [w]A‚àû‚â§[w]Ap.
‚ñ°
An immediate consequence of the preceding theorem is the following result
relating A‚àûto Ap.
Corollary 7.3.4. The following equality is valid:
A‚àû=

1‚â§p<‚àû
Ap.
Exercises
7.3.1. Let Œª > 0, Q be a cube in Rn, and w ‚ààA‚àû(Rn).
(a) Show that property (6) in Proposition 7.3.2 can be improved to
w(ŒªQ) ‚â§min
Œµ>0
(1+Œµ)Œª n[w]Œª n
A‚àû‚àí1
Œµ
w(Q).

7.3 The A‚àûCondition
531
(b) Prove that
w(ŒªQ) ‚â§(2Œª)2n(1+log2[w]A‚àû)w(Q).

Hint: Part (a): Take c in (7.3.4) such that c1/Œª n = (1 + Œµ)[w]A‚àû. Part (b): Use the
estimate in property (6) of Proposition 7.3.2 with Œª = 2.

7.3.2. Suppose that Œº is a positive Borel measure on Rn with the property that for
all cubes Q and all measurable subsets A of Q we have
|A| < Œ±|Q| =‚áíŒº(A) < Œ≤Œº(Q)
for some Ô¨Åxed 0 < Œ±,Œ≤ < 1. Show that Œº is doubling [i.e., it satisÔ¨Åes (7.2.9)].

Hint: Use that |S| > (1‚àíŒ±)|Q| ‚áíŒº(S) > (1‚àíŒ≤)Œº(Q) when S ‚´ÖQ.

7.3.3. Prove that a weight w is in Ap if and only if both w and w‚àí
1
p‚àí1 are in A‚àû.

Hint: You may want to use the result of Exercise 7.2.2.

7.3.4. ([33], [343]) Prove that if P(x) is a polynomial of degree k in Rn, then
log|P(x)| is in BMO with norm depending only on k and n and not on the coef-
Ô¨Åcients of the polynomial.

Hint: Use that all norms on the Ô¨Ånite-dimensional space of polynomials of degree
at most k are equivalent to show that |P(x)| satisÔ¨Åes a reverse H¬®older inequality.
Therefore, |P(x)| is an A‚àûweight and thus Exercise 7.2.3 (c) is applicable.

7.3.5. Show that the product of two A1 weights may not be an A‚àûweight.
7.3.6. Let g be in Lp(w) for some 1 ‚â§p ‚â§‚àûand w ‚ààAp. Prove that g ‚ààL1
loc(Rn).

Hint: Let B be a ball. In the case p < ‚àû, write

B |g|dx =

B(|g|w‚àí1
p )w
1
p dx and
apply H¬®older‚Äôs inequality. In the case p = ‚àû, use that w ‚ààAp0 for some p0 < ‚àû.

7.3.7. ([278]) Show that a weight w lies in A‚àûif and only if there exist Œ≥,C > 0 such
that for all cubes Q we have
w
	
x ‚ààQ : w(x) > Œª


‚â§CŒª
	
x ‚ààQ : w(x) > Œ≥Œª


for all Œª > AvgQ w.

Hint: The displayed condition easily implies that
1
|Q|

Q w1+Œµ
k
dx ‚â§
w(Q)
|Q|
Œµ+1
+ C‚Ä≤Œ¥
Œ≥1+Œµ
1
|Q|

Q w1+Œµ
k
dx,
where k > 0, wk = min(w,k) and Œ¥ = Œµ/(1+Œµ). Take Œµ > 0 small enough to obtain
the reverse H¬®older condition (c ) in Theorem 7.3.3 for wk. Let k ‚Üí‚àûto obtain the
same conclusion for w. Conversely, Ô¨Ånd constants Œ≥,Œ¥ ‚àà(0,1) as in condition (a) of
Theorem 7.3.3 and for Œª > AvgQ w write the set {w > Œª}‚à©Q as a union of maximal
dyadic cubes Qj such that Œª < AvgQj w ‚â§2nŒª for all j. Then w(Qj) ‚â§2nŒª|Qj| ‚â§
2nŒª
1‚àíŒ¥ |Qj ‚à©{w > Œ≥Œª}| and the required conclusion follows by summing on j.


532
7 Weighted Inequalities
7.4 Weighted Norm Inequalities for Singular Integrals
We now address a topic of great interest in the theory of singular integrals, their
boundedness properties on weighted Lp spaces. It turns out that a certain amount
of regularity must be imposed on the kernels of these operators to obtain the afore-
mentioned weighted estimates.
7.4.1 Singular Integrals of Non Convolution type
We introduce some deÔ¨Ånitions.
DeÔ¨Ånition 7.4.1. Let 0 < Œ¥,A < ‚àû. A function K(x,y) deÔ¨Åned for x,y ‚ààRn with
x Ã∏= y is called a standard kernel (with constants Œ¥ and A) if
|K(x,y)| ‚â§
A
|x‚àíy|n ,
x Ã∏= y,
(7.4.1)
and whenever |x‚àíx‚Ä≤| ‚â§1
2 max

|x‚àíy|,|x‚Ä≤ ‚àíy|

we have
|K(x,y)‚àíK(x‚Ä≤,y)| ‚â§
A|x‚àíx‚Ä≤|Œ¥
(|x‚àíy|+|x‚Ä≤ ‚àíy|)n+Œ¥
(7.4.2)
and also when |y‚àíy‚Ä≤| ‚â§1
2 max

|x‚àíy|,|x‚àíy‚Ä≤|

we have
|K(x,y)‚àíK(x,y‚Ä≤)| ‚â§
A|y‚àíy‚Ä≤|Œ¥
(|x‚àíy|+|x‚àíy‚Ä≤|)n+Œ¥ .
(7.4.3)
The class of all kernels that satisfy (7.4.1), (7.4.2), and (7.4.3) is denoted by
SK(Œ¥,A).
DeÔ¨Ånition 7.4.2. Let 0 < Œ¥,A < ‚àûand K in SK(Œ¥,A). A Calder¬¥on‚ÄìZygmund opera-
tor associated with K is a linear operator T deÔ¨Åned on S (Rn) that admits a bounded
extension on L2(Rn),
T( f)

L2 ‚â§B
 f

L2 ,
(7.4.4)
and that satisÔ¨Åes
T( f)(x) =

Rn K(x,y) f(y)dy
(7.4.5)
for all f ‚ààC ‚àû
0 and x not in the support of f. The class of all Calder¬¥on‚ÄìZygmund
operators associated with kernels in SK(Œ¥,A) that are bounded on L2 with norm at
most B is denoted by CZO(Œ¥,A,B). Note that there is no unique T associated with
a given K. Given a Calder¬¥on‚ÄìZygmund operator T in CZO(Œ¥,A,B), we deÔ¨Åne the
truncated operator T (Œµ) as
T (Œµ)( f)(x) =

|x‚àíy|>Œµ K(x,y) f(y)dy

7.4 Weighted Norm Inequalities for Singular Integrals
533
and the maximal operator associated with T as follows:
T (‚àó)( f)(x) = sup
Œµ>0
T (Œµ)( f)(x)
.
We note that if T is in CZO(Œ¥,A,B), then T (Œµ)( f) and T (‚àó)( f) are well deÔ¨Åned
for all f in 
1‚â§p<‚àûLp(Rn). It is also well deÔ¨Åned whenever f is locally integrable
and satisÔ¨Åes

|x‚àíy|‚â•Œµ | f(y)||x‚àíy|‚àíndy < ‚àûfor all x ‚ààRn and Œµ > 0.
The class of kernels in SK(Œ¥,A) extends the family of convolution kernels that
satisfy conditions (5.3.10), (5.3.11), and (5.3.12). Obviously, the associated operators
in CZO(Œ¥,A,B) generalize the associated convolution operators.
A fundamental property of operators in CZO(Œ¥,A,B) is that they have bounded
extensions on all the Lp(Rn) spaces and also from L1(Rn) to weak L1(Rn). This is
proved via an adaptation of Theorem 5.3.3; see Theorem 4.2.2 in [131]. There are
analogous results for the maximal counterparts T (‚àó) of elements of CZO(Œ¥,A,B).
In fact, an analogue of Theorem 5.3.5 yields that T (‚àó) is Lp bounded for 1 < p < ‚àû
and weak type (1,1); this result is contained in Theorem 4.2.4 in [131].
We discuss weighted inequalities for singular integrals for general operators in
CZO(Œ¥,A,B). In Subsections 7.4.2 and 7.4.3, the reader may wish to replace kernels
in SK(Œ¥,A) by the more familiar functions K(x) deÔ¨Åned on Rn \ {0} that satisfy
(5.3.10), (5.3.11), and (5.3.12).
7.4.2 A Good Lambda Estimate for Singular Integrals
The following theorem is the main result of this section.
Theorem 7.4.3. Let 1 ‚â§p ‚â§‚àû, w ‚ààAp, and T in CZO(Œ¥,A,B). Then there exist
positive constants1 C0 = C0(n, p,[w]Ap), Œµ0 = Œµ0(n, p,[w]Ap), and c0(n,Œ¥), such that
if Œ≥0 = c0(n,Œ¥)/A, then for all 0 < Œ≥ < Œ≥0 we have
w

{T (‚àó)( f) > 3Œª}‚à©{M( f) ‚â§Œ≥Œª}

‚â§C0Œ≥Œµ0(A+B)Œµ0w

{T (‚àó)( f) > Œª}

, (7.4.6)
for all locally integrable functions f for which

|x‚àíy|‚â•Œµ | f(y)||x‚àíy|‚àíndy < ‚àû
for all x ‚ààRn and Œµ > 0. Here M denotes the Hardy‚ÄìLittlewood maximal operator.
Proof. We write the open set
Œ© = {T (‚àó)( f) > Œª} =

j
Qj ,
1 the dependence on p is relevant only when p < ‚àû

534
7 Weighted Inequalities
where Qj are the Whitney cubes (see Appendix J). We set
Q‚àó
j = 10‚àönQj ,
Q‚àó‚àó
j = 10‚àönQ‚àó
j ,
where aQ denotes the cube with the same center as Q whose side length is a‚Ñì(Q),
where ‚Ñì(Q) is the side length of Q. We note that in view of the properties of the
Whitney cubes, the distance from Qj to Œ© c is at most 4‚àön‚Ñì(Qj). But the distance
from Qj to the boundary of Q‚àó
j is (5‚àön‚àí1
2)‚Ñì(Qj), which is bigger than 4‚àön‚Ñì(Qj).
Therefore, Q‚àó
j must meet Œ© c and for every cube Qj we Ô¨Åx a point yj in Œ© c ‚à©Q‚àó
j. See
Figure 7.1.
Qj
Qj
Qj
**
*
yj.
..
.
x
zj
t
c
(50
-
-
 n  5   n ) l(Q )
j 
(5   n 
) l(Q )
j
1
2
Œ©
Œ©
Fig. 7.1 A picture of the proof.
We also Ô¨Åx f in 
1‚â§p<‚àûLp(Rn), and for each j we write f = f j
0 + f j
‚àû, where
f j
0 = f œáQ‚àó‚àó
j is the part of f near Qj and f j
‚àû= f œá(Q‚àó‚àó
j )c is the part of f away from Qj.
We now claim that the following estimate is true:
Qj ‚à©{T (‚àó)( f) > 3Œª}‚à©{M( f) ‚â§Œ≥Œª}
 ‚â§Cn Œ≥ (A+B)
Qj
.
(7.4.7)
Once the validity of (7.4.7) is established, we apply Theorem 7.3.3 (d) when p = ‚àû
or Proposition 7.2.8 when p < ‚àûto obtain constants Œµ0,C2 > 0, which depend on
[w]Ap, p, n when p < ‚àûand on [w]A‚àûand n when p = ‚àû, such that
w

Q j ‚à©{T (‚àó)( f) > 3Œª}‚à©{M( f) ‚â§Œ≥Œª}

‚â§C2 (Cn)Œµ0 Œ≥Œµ0 (A+B)Œµ0 w(Qj).

7.4 Weighted Norm Inequalities for Singular Integrals
535
Then a simple summation in j gives (7.4.6) with C0 = C2(Cn)Œµ0, and recall that C2
and Œµ0 depend on n and [w]Ap and on p if p < ‚àû.
In proving estimate (7.4.7), we may assume that for each cube Qj there exists a
z j ‚ààQj such that M( f)(z j) ‚â§Œ≥ Œª; otherwise, the set on the left in (7.4.7) is empty.
We now invoke Theorem 4.2.4 in [131], which states that T (‚àó) maps L1(Rn) to
L1,‚àû(Rn) with norm at most C(n)(A+B). We have the estimate
Qj ‚à©{T (‚àó)( f) > 3Œª}‚à©{M( f) ‚â§Œ≥Œª}
 ‚â§IŒª
0 +IŒª
‚àû,
(7.4.8)
where
IŒª
0 =
Qj ‚à©{T (‚àó)( f j
0) > Œª}‚à©{M( f) ‚â§Œ≥Œª}
,
IŒª
‚àû=
Qj ‚à©{T (‚àó)( f j
‚àû) > 2Œª}‚à©{M( f) ‚â§Œ≥Œª}
.
To control IŒª
0 we note that f j
0 is in L1(Rn) and we argue as follows:
IŒª
0 ‚â§
{T (‚àó)( f j
0) > Œª}

‚â§‚à•T (‚àó)‚à•L1‚ÜíL1,‚àû
Œª

Rn | f j
0(x)|dx
‚â§C(n)(A+B)
|Q‚àó‚àó
j |
Œª
1
|Q‚àó‚àó
j |

Q‚àó‚àó
j
| f(x)|dx
‚â§C(n)(A+B)
|Q‚àó‚àó
j |
Œª
Mc( f)(z j)
‚â§#C(n)(A+B)
|Q‚àó‚àó
j |
Œª
M( f)(z j)
‚â§#C(n)(A+B)
|Q‚àó‚àó
j |
Œª
Œª Œ≥
= Cn (A+B)Œ≥ |Qj|.
(7.4.9)
Next we claim that IŒª
‚àû= 0 if we take Œ≥ sufÔ¨Åciently small. We Ô¨Årst show that for all
x ‚ààQj we have
sup
Œµ>0
T (Œµ)( f j
‚àû)(x)‚àíT (Œµ)( f j
‚àû)(yj)
 ‚â§C(1)
n,Œ¥ AM( f)(z j).
(7.4.10)
Indeed, let us Ô¨Åx an Œµ > 0. We have
T (Œµ)( f j
‚àû)(x)‚àíT (Œµ)( f j
‚àû)(yj)
 =


|t‚àíx|>Œµ
K(x,t) f j
‚àû(t)dt ‚àí

|t‚àíy j|>Œµ
K(yj,t) f j
‚àû(t)dt

‚â§L1 +L2 +L3 ,

536
7 Weighted Inequalities
where
L1 =


|t‚àíy j|>Œµ

K(x,t)‚àíK(yj,t)

f j
‚àû(t)dt
,
L2 =


|t‚àíx|>Œµ
|t‚àíy j|‚â§Œµ
K(x,t) f j
‚àû(t)dt
,
L3 =


|t‚àíx|‚â§Œµ
|t‚àíy j|>Œµ
K(x,t) f j
‚àû(t)dt
,
in view of identity (5.4.7).
We now make a couple of observations. For t /‚ààQ‚àó‚àó
j , x,z j ‚ààQj, and yj ‚ààQ‚àó
j we
have
3
4 ‚â§|t ‚àíx|
|t ‚àíyj| ‚â§5
4 ,
48
49 ‚â§|t ‚àíx|
|t ‚àíz j| ‚â§50
49 .
(7.4.11)
Indeed,
|t ‚àíyj| ‚â•(50n‚àí5‚àön)‚Ñì(Qj) ‚â•44n‚Ñì(Qj)
and
|x‚àíyj| ‚â§1
2
‚àön‚Ñì(Qj)+‚àön10‚àön‚Ñì(Qj) ‚â§11n‚Ñì(Qj) ‚â§1
4 |t ‚àíyj|.
Using this estimate and the inequalities
3
4 |t ‚àíyj| ‚â§|t ‚àíyj|‚àí|x‚àíyj| ‚â§|t ‚àíx| ‚â§|t ‚àíyj|+|x‚àíyj| ‚â§5
4 |t ‚àíyj|,
we obtain the Ô¨Årst estimate in (7.4.11). Likewise, we have
|x‚àíz j| ‚â§‚àön‚Ñì(Qj) ‚â§n‚Ñì(Qj)
and
|t ‚àíz j| ‚â•(50n‚àí1
2)‚Ñì(Qj) ‚â•49n‚Ñì(Qj),
and these give
48
49 |t ‚àíz j| ‚â§|t ‚àíz j|‚àí|x‚àíz j| ‚â§|t ‚àíx| ‚â§|t ‚àíz j|+|x‚àíz j| ‚â§50
49 |t ‚àíz j|,
yielding the second estimate in (7.4.11).
Since |x‚àíyj| ‚â§1
2|t ‚àíyj| ‚â§1
2 max

|t ‚àíx|,|t ‚àíyj|

, we have
|K(x,t)‚àíK(yj,t)| ‚â§
A|x‚àíyj|Œ¥
(|t ‚àíx|+|t ‚àíyj|)n+Œ¥ ‚â§C‚Ä≤
n,Œ¥A
‚Ñì(Qj)Œ¥
|t ‚àíz j|n+Œ¥ ;

7.4 Weighted Norm Inequalities for Singular Integrals
537
hence, we obtain
L1 ‚â§

|t‚àíz j|‚â•49n‚Ñì(Qj)
C‚Ä≤
n,Œ¥A
‚Ñì(Qj)Œ¥
|t ‚àíz j|n+Œ¥ | f(t)|dt ‚â§C‚Ä≤‚Ä≤
n,Œ¥AM( f)(z j)
using Theorem 2.1.10. Using (7.4.11) we deduce
L2 ‚â§

|t‚àíz j|‚â§5
4 ¬∑ 49
48 Œµ
A
|x‚àít|n œá|t‚àíx|‚â•Œµ | f j
‚àû(t)|dt ‚â§C‚Ä≤
nAM( f)(z j).
Again using (7.4.11), we obtain
L3 ‚â§

|t‚àíz j|‚â§49
48 Œµ
A
|x‚àít|n œá|t‚àíx|‚â•3
4 Œµ | f j
‚àû(t)|dt ‚â§C‚Ä≤‚Ä≤
nAM( f)(z j).
This proves (7.4.10) with constant C(1)
n,Œ¥ = C‚Ä≤‚Ä≤
n,Œ¥ +C‚Ä≤
n +C‚Ä≤‚Ä≤
n.
Having established (7.4.10), we next claim that
sup
Œµ>0
T (Œµ)( f j
‚àû)(yj)
 ‚â§T (‚àó)( f)(yj)+C(2)
n AM( f)(z j).
(7.4.12)
To prove (7.4.12) we Ô¨Åx a cube Qj and Œµ > 0. We let Rj be the smallest number such
that
Q‚àó‚àó
j ‚äÜB(yj,Rj).
See Figure 7.2. We consider the following two cases.
Q j
Qj
Qj
**
*
yj.
Rj
Fig. 7.2 The ball B(yj,Rj).

538
7 Weighted Inequalities
Case (1): Œµ ‚â•Rj. Since Q‚àó‚àó
j ‚äÜB(yj,Œµ), we have B(yj,Œµ)c ‚äÜ(Q‚àó‚àó
j )c and therefore
T (Œµ)( f j
‚àû)(yj) = T (Œµ)( f)(yj),
so (7.4.12) holds easily in this case.
Case (2): 0 < Œµ < Rj. Note that if t ‚àà(Q‚àó‚àó
j )c, then |t ‚àíyj| ‚â•40n‚Ñì(Qj). On the
other hand, Rj ‚â§diam(Q‚àó‚àó
j ) = 100n
3
2 ‚Ñì(Qj). This implies that
Rj ‚â§5‚àön
2 |t ‚àíyj|,
when
t ‚àà(Q‚àó‚àó
j )c .
Notice also that in this case we have B(yj,Rj)c ‚äÜ(Q‚àó‚àó
j )c, hence
T (R j)( f j
‚àû)(yj) = T (R j)( f)(yj).
Therefore, we have
T (Œµ)( f j
‚àû)(yj)
 ‚â§
T (Œµ)( f j
‚àû)(yj)‚àíT (R j)( f j
‚àû)(yj)
+
T (R j)( f)(yj)

‚â§

Œµ‚â§|y j‚àít|‚â§R j
|K(yj,t)| | f j
‚àû(t)|dt +T (‚àó)( f)(yj)
‚â§

2
5‚àön R j‚â§|y j‚àít|‚â§R j
|K(yj,t)|| f j
‚àû(t)|dt +T (‚àó)( f)(yj)
‚â§
A(
2
5‚àön)‚àín
Rn
j

|z j‚àít|‚â§5
4 ¬∑ 49
48 R j
| f(t)|dt +T (‚àó)( f)(yj)
‚â§C(2)
n AM( f)(z j)+T (‚àó)( f)(yj),
where in the penultimate estimate we used (7.4.11). The proof of (7.4.12) follows
with the required bound C(2)
n A.
Combining (7.4.10) and (7.4.12), we obtain
T (‚àó)( f j
‚àû)(x) ‚â§T (‚àó)( f)(yj)+

C(1)
n,Œ¥ +C(2)
n

AM( f)(z j).
Recalling that yj /‚ààŒ© and that M( f)(z j) ‚â§Œ≥Œª, we deduce
T (‚àó)( f j
‚àû)(x) ‚â§Œª +

C(1)
n,Œ¥ +C(2)
n

AŒ≥Œª .
Setting Œ≥0 =

C(1)
n,Œ¥ +C(2)
n
‚àí1 A‚àí1 = c0(n,Œ¥)A‚àí1, for 0 < Œ≥ < Œ≥0, we have that the set
Qj ‚à©{T (‚àó)( f j
‚àû) > 2Œª}‚à©{M( f) ‚â§Œ≥Œª}

7.4 Weighted Norm Inequalities for Singular Integrals
539
is empty. This shows that the quantity IŒ≥
‚àûvanishes if Œ≥ is smaller than Œ≥0. Returning
to (7.4.8) and using the estimate (7.4.9) proved earlier, we conclude the proof of
(7.4.7), which, as indicated earlier, implies the theorem.
‚ñ°
Remark 7.4.4. We observe that for any Œ¥ > 0, estimate (7.4.6) also holds for the
operator
T (‚àó)
Œ¥
( f)(x) = sup
Œµ‚â•Œ¥
|T (Œµ)( f)(x)|
(7.4.13)
with the same constant (which is independent of Œ¥).
To see the validity of (7.4.6) for T (‚àó)
Œ¥
, it sufÔ¨Åces to prove
T (‚àó)
Œ¥
( f j
‚àû)(yj)
 ‚â§T (‚àó)
Œ¥
( f)(yj)+C(2)
n AM( f)(z j),
(7.4.14)
which is a version of (7.4.12) with T (‚àó) replaced by T (‚àó)
Œ¥
. The following cases arise:
Case (1‚Ä≤): Rj ‚â§Œ¥ ‚â§Œµ or Œ¥ ‚â§Rj ‚â§Œµ. Here, as in Case (1) we have
|T (Œµ)( f j
‚àû)(yj)| = |T (Œµ)( f)(yj)| ‚â§T (‚àó)
Œ¥
( f)(yj).
Case (2‚Ä≤): Œ¥ ‚â§Œµ < Rj. As in Case (2) we have
T (R j)( f j
‚àû)(yj) = T (R j)( f)(yj),
thus
T (Œµ)( f j
‚àû)(yj)
 ‚â§
T (Œµ)( f j
‚àû)(yj)‚àíT (R j)( f j
‚àû)(yj)
+
T (R j)( f)(yj)
.
As in the proof of Case (2), we bound the Ô¨Årst term on the right of the last displayed
expression by C(2)
n AM( f)(z j) while the second term is at most T (‚àó)
Œ¥
( f)(yj).
7.4.3 Consequences of the Good Lambda Estimate
Having obtained the important good lambda weighted estimate for singular inte-
grals, we now pass to some of its consequences. We begin with the following lemma:
Lemma 7.4.5. Let 1 ‚â§p < ‚àû, Œµ > 0, w ‚ààAp, x ‚ààRn, and f ‚ààLp(w). Then we have

|x‚àíy|‚â•Œµ
| f(y)|
|x‚àíy|n dy ‚â§C00(w,n, p,x,Œµ)
f

Lp(w)
for some constant C00 depending on the stated parameters. In particular, T (Œµ)( f)
and T (‚àó)( f) are deÔ¨Åned for f ‚ààLp(w).
Proof. For each Œµ > 0 and x pick a cube Q0 = Q0(x,Œµ) of side length cnŒµ (for some
constant cn) such that Q0 ‚´ÖB(x,Œµ). Set Qj = 2jQ0 for j ‚â•0. We have

540
7 Weighted Inequalities

|y‚àíx|‚â•Œµ
| f(y)|
|x‚àíy|n dy ‚â§Cn
‚àû
‚àë
j=0
(2jŒµ)‚àín

Qj+1\Qj
| f(y)|dy
‚â§Cn
‚àû
‚àë
j=1
 1
|Qj|

Qj
| f(y)|pwdy
 1
p  1
|Qj|

Qj
w‚àíp‚Ä≤
p dy
 1
p‚Ä≤
‚â§Cn [w]
1
p
Ap
‚àû
‚àë
j=1

Qj
| f(y)|pwdy
 1
p 
1
w(Qj)
 1
p
‚â§Cn [w]
1
p
Ap
 f

Lp(w)
‚àû
‚àë
j=1

w(Qj)
‚àí1
p .
But Proposition 7.2.8 gives for some Œ¥ = Œ¥(n, p,[w]Ap) that
w(Q0)
w(Qj) ‚â§C(n, p,[w]Ap)|Q0|Œ¥
|Qj|Œ¥ ,
from which it follows that
w(Qj)‚àí1
p ‚â§C‚Ä≤(n, p,[w]Ap)2‚àíj nŒ¥
p w(Q0)‚àí1
p .
In view of this estimate, the previous series converges. Note that C‚Ä≤ and thus C00
depend on [w]Ap,n, p,x,Œµ, and w(Q0).
This argument is also valid in the case p = 1 by an obvious modiÔ¨Åcation.
‚ñ°
Theorem 7.4.6. Let A,B,Œ≤ > 0 and let T be a CZO(Œ≤,A,B). Then given 1 < p < ‚àû,
there is a constant Cp = Cp(n,Œ≤,[w]Ap) such that
T (‚àó)( f)

Lp(w) ‚â§Cp (A+B)
f

Lp(w)
(7.4.15)
for all w ‚ààAp and f ‚ààLp(w). There is also a constant C1 =C1(n,Œ≤,[w]A1) such that
T (‚àó)( f)

L1,‚àû(w) ‚â§C1 (A+B)
f

L1(w)
(7.4.16)
for all w ‚ààA1 and f ‚ààL1(w).
Proof. This theorem is a consequence of the estimate proved in the previous the-
orem. For technical reasons, it is useful to Ô¨Åx a Œ¥ > 0 and work with the auxil-
iary maximal operator T (‚àó)
Œ¥
deÔ¨Åned in (7.4.13) instead of T (‚àó). We begin by taking
1 < p < ‚àûand f ‚ààLp(w) for some w ‚ààAp. We write
T (‚àó)
Œ¥
( f)
p
Lp(w) =
 ‚àû
0 pŒª p‚àí1w

{T (‚àó)
Œ¥
( f) > Œª}

dŒª
= 3p
 ‚àû
0 pŒª p‚àí1w

{T (‚àó)
Œ¥
( f) > 3Œª}

dŒª ,

7.4 Weighted Norm Inequalities for Singular Integrals
541
which we control by
3p
 ‚àû
0 pŒª p‚àí1w

{T (‚àó)
Œ¥
( f) > 3Œª}‚à©{M( f) ‚â§Œ≥Œª}

dŒª
+ 3p
 ‚àû
0 pŒª p‚àí1w

{M( f) > Œ≥Œª}

dŒª .
Using Theorem 7.4.3 (or rather Remark 7.4.4), there are C0 = C0(n,[w]Ap), Œµ0 =
Œµ0(n,[w]Ap), and Œ≥0 = c0(n,Œ≤)A‚àí1, such that the preceding displayed expression is
bounded by
3pC0Œ≥Œµ0(A+B)Œµ0
 ‚àû
0 pŒª p‚àí1w

{T (‚àó)
Œ¥
( f) > Œª}

dŒª
+ 3p
Œ≥ p
 ‚àû
0 pŒª p‚àí1w

{M( f) > Œª}

dŒª ,
which is equal to
3pC0Œ≥Œµ0(A+B)Œµ0T (‚àó)
Œ¥
( f)
p
Lp(w) + 3p
Œ≥ p
M( f)
p
Lp(w) .
Taking Œ≥ = min
 1
2c0(n,Œ≤)A‚àí1, 1
2(2C03p)‚àí1
Œµ0 (A+B)‚àí1
< Œ≥0, we conclude that
T (‚àó)
Œ¥
( f)
p
Lp(w)
‚â§1
2
T (‚àó)
Œ¥
( f)
p
Lp(w) + #Cp(n,Œ≤,[w]Ap)(A+B)pM( f)
p
Lp(w) .
(7.4.17)
We now prove a similar estimate when p = 1. For f ‚ààL1(w) and w ‚ààA1 we have
3Œªw
	
T (‚àó)
Œ¥
( f) > 3Œª


‚â§3Œªw
	
T (‚àó)
Œ¥
( f) > 3Œª

‚à©{M( f) ‚â§Œ≥Œª}

+3Œªw

{M( f) > Œ≥Œª}

,
and this expression is controlled by
3ŒªC0Œ≥Œµ0(A+B)Œµ0w
	
T (‚àó)
Œ¥
( f) > Œª


+ 3
Œ≥
M( f)

L1,‚àû(w) .
Recalling that Œ≥0 = c0(n,Œ≤)A‚àí1 and choosing Œ≥ = min
 1
2Œ≥0, 1
2(6C0)‚àí1
Œµ0 (A+B)‚àí1
,
it follows that
T (‚àó)
Œ¥
( f)

L1,‚àû(w)
‚â§1
2
T (‚àó)
Œ¥
( f)

L1,‚àû(w)+ #C1(n,Œ≤,[w]A1)(A+B)
M( f)

L1,‚àû(w).
(7.4.18)

542
7 Weighted Inequalities
Estimate (7.4.15) would follow from (7.4.17) if we knew that ‚à•T (‚àó)
Œ¥
( f)‚à•Lp(w) < ‚àû
whenever 1 < p < ‚àû, w ‚ààAp and f ‚ààLp(w), while (7.4.16) would follow from
(7.4.18) if we had ‚à•T (‚àó)
Œ¥
( f)‚à•L1,‚àû(w) < ‚àûwhenever w ‚ààA1 and f ‚ààL1(w). Since we
do not know that these quantities are Ô¨Ånite, a certain amount of work is needed.
To deal with this problem we momentarily restrict attention to a special class
of functions on Rn, the class of bounded functions with compact support. Such
functions are dense in Lp(w) when w ‚ààAp and 1 ‚â§p < ‚àû; see Exercise 7.4.1. Let
h be a bounded function with compact support on Rn. Then T (‚àó)
Œ¥
(h) ‚â§C1Œ¥ ‚àín‚à•h‚à•L1
and T (‚àó)
Œ¥
(h)(x) ‚â§C2(h)|x|‚àín for x away from the support of h. It follows that
T (‚àó)
Œ¥
(h)(x) ‚â§C3(h,Œ¥)(1+|x|)‚àín
for all x ‚ààRn. Furthermore, if h is nonzero, then
M(h)(x) ‚â•
C4(h)
(1+|x|)n ,
and therefore for w ‚ààA1,
T (‚àó)
Œ¥
(h)

L1,‚àû(wdx) ‚â§C5(h,Œ¥)
M(h)

L1,‚àû(wdx) < ‚àû,
while for 1 < p < ‚àûand w ‚ààAp,

Rn(T (‚àó)
Œ¥
(h)(x))pw(x)dx ‚â§C5(h, p,Œ¥)

Rn M(h)(x)pw(x)dx < ‚àû
in view of Theorem 7.1.9. Using these facts, (7.4.17), (7.4.18), and Theorem 7.1.9
once more, we conclude that for all Œ¥ > 0 and 1 < p < ‚àûwe have
T (‚àó)
Œ¥
(h)
p
Lp(w) ‚â§2 #Cp
M(h)
p
Lp(w) ‚â§#C‚Ä≤
p[w]
p
p‚àí1
Ap
h
p
Lp(w) = Cp
p
h
p
Lp(w),
T (‚àó)
Œ¥
(h)

L1,‚àû(w) ‚â§2 #C1
M(h)

L1,‚àû(w) ‚â§#C1[w]A1
h

L1(w) = C1
h

L1(w),
(7.4.19)
whenever h a bounded function with compact support. The constants #Cp, #C‚Ä≤
p, and Cp
depend only on the parameters n, Œ≤, p, and [w]Ap.
We now extend estimates (7.4.16) and (7.4.15) to functions in Lp(Rn,wdx). Given
1 ‚â§p < ‚àû, w ‚ààAp, and f ‚ààLp(w), let
fN(x) = f(x)œá| f|‚â§Nœá|x|‚â§N .
Then fN is a bounded function with compact support that converges to f in Lp(w)
(i.e., ‚à•fN ‚àíf‚à•Lp(w) ‚Üí0 as N ‚Üí‚àû) by the Lebesgue dominated convergence theo-
rem. Also | fN| ‚â§| f| for all N. Sublinearity and Lemma 7.4.5 give for all x ‚ààRn,
|T (‚àó)
Œ¥
( fN)(x)‚àíT (‚àó)
Œ¥
( f)(x)| ‚â§T (‚àó)
Œ¥
( f ‚àífN)(x)
‚â§AC00(w,n, p,x,Œ¥)
fN ‚àíf

Lp(w) ,

7.4 Weighted Norm Inequalities for Singular Integrals
543
and this converges to zero as N ‚Üí‚àûsince C00(w,n, p,x,Œ¥) < ‚àû. Therefore
T (‚àó)
Œ¥
( f) = lim
N‚Üí‚àûT (‚àó)
Œ¥
( fN)
pointwise, and Fatou‚Äôs lemma for weak type spaces [see Exercise 1.1.12 (d)] gives
for w ‚ààA1 and f ‚ààL1(w),
T (‚àó)
Œ¥
( f)

L1,‚àû(w) =
liminf
N‚Üí‚àûT (‚àó)
Œ¥
( fN)

L1,‚àû(w)
‚â§liminf
N‚Üí‚àû
T (‚àó)
Œ¥
( fN)

L1,‚àû(w)
‚â§C1 liminf
N‚Üí‚àû
M( fN)

L1,‚àû(w)
‚â§C1
M( f)

L1,‚àû(w) ,
since | fN| ‚â§| f| for all N. An analogous argument gives the estimate
T (‚àó)
Œ¥
( f)

Lp(w) ‚â§Cp
f

Lp(w)
for w ‚ààAp and f ‚ààLp(w) when 1 < p < ‚àû.
It remains to prove (7.4.15) and (7.4.16) for T (‚àó). But this is also an easy conse-
quence of Fatou‚Äôs lemma, since the constants Cp and C1 are independent of Œ¥ and
lim
Œ¥‚Üí0T (‚àó)
Œ¥
( f) = T (‚àó)( f)
for all f ‚ààLp(w).
‚ñ°
We end this subsection by making the comment that if a given T in CZO(Œ¥,A,B)
is pointwise controlled by T (‚àó), then the estimates of Theorem 7.4.6 also hold for it.
This is the case for the Hilbert transform, the Riesz transforms, and other classical
singular integral operators.
7.4.4 Necessity of the Ap Condition
We have established the main theorems relating Calder¬¥on‚ÄìZygmund operators and
Ap weights, namely that such operators are bounded on Lp(w) whenever w lies in
Ap. It is natural to ask whether the Ap condition is necessary for the boundedness of
singular integrals on Lp. We end this section by indicating the necessity of the Ap
condition for the boundedness of the Riesz transforms on weighted Lp spaces.
Theorem 7.4.7. Let w be a weight in Rn and let 1 ‚â§p < ‚àû. Suppose that each of the
Riesz transforms Rj is of weak type (p, p) with respect to w. Then w must be an Ap
weight. Similarly, let w be a weight in R. If the Hilbert transform H is of weak type
(p, p) with respect to w, then w must be an Ap weight.

544
7 Weighted Inequalities
Proof. We prove the n-dimensional case, n ‚â•2. The one-dimensional case is essen-
tially contained in following argument, suitably adjusted.
Let Q be a cube and let f be a nonnegative function on Rn supported in Q that
satisÔ¨Åes AvgQ f > 0. Let Q‚Ä≤ be the cube that shares a corner with Q, has the same
length as Q, and satisÔ¨Åes xj ‚â•yj for all 1 ‚â§j ‚â§n whenever x ‚ààQ‚Ä≤ and y ‚ààQ. Then
for x ‚ààQ‚Ä≤ we have

n
‚àë
j=1
Rj( f)(x)
 = Œì ( n+1
2 )
œÄ
n+1
2
n
‚àë
j=1

Q
xj ‚àíyj
|x‚àíy|n+1 f(y)dy ‚â•Œì ( n+1
2 )
œÄ
n+1
2

Q
f(y)
|x‚àíy|n dy.
But if x ‚ààQ‚Ä≤ and y ‚ààQ we must have that |x ‚àíy| ‚â§2‚àön‚Ñì(Q), which implies that
|x ‚àíy|‚àín ‚â•(2‚àön)‚àín|Q|‚àí1. Let Cn = Œì ( n+1
2 )(2‚àön)‚àínœÄ‚àín+1
2 . It follows that for all
0 < Œ± < Cn AvgQ f we have
Q‚Ä≤ ‚äÜ

x ‚ààRn :

n
‚àë
j=1
Rj( f)(x)
 > Œ±

.
Since the operator ‚àën
j=1 Rj is of weak type (p, p) with respect to w (with constant
C), we must have
w(Q‚Ä≤) ‚â§Cp
Œ± p

Q f(x)pw(x)dx
for all Œ± < Cn AvgQ f, which implies that

Avg
Q
f
p ‚â§C‚àíp
n Cp
w(Q‚Ä≤)

Q f(x)pw(x)dx.
(7.4.20)
We observe that we can reverse the roles of Q and Q‚Ä≤ and obtain

Avg
Q‚Ä≤ g
p ‚â§C‚àíp
n Cp
w(Q)

Q‚Ä≤ g(x)pw(x)dx
(7.4.21)
for all g supported in Q‚Ä≤. In particular, taking g = œáQ‚Ä≤ in (7.4.21) gives that
w(Q) ‚â§C‚àíp
n Cpw(Q‚Ä≤).
Using this estimate and (7.4.20), we obtain

Avg
Q
f
p ‚â§(C‚àíp
n Cp)2
w(Q)

Q f(x)pw(x)dx.
(7.4.22)
Using the characterization of the Ap characteristic constant in Proposition 7.1.5 (8),
it follows that
[w]Ap ‚â§(C‚àíp
n Cp)2 < ‚àû;
hence w ‚ààAp.
‚ñ°

7.4 Weighted Norm Inequalities for Singular Integrals
545
Exercises
7.4.1. Let 1 ‚â§p < ‚àûand let w ‚ààL1
loc(Rn) satisfy w > 0 a.e. Show that C ‚àû
0 (Rn) is
dense in Lp(w). In particular this assertion holds for any w ‚ààA‚àû.
7.4.2. ([74]) Let T be in CZO(Œ¥,A,B). Show that for all Œµ > 0 and all 1 < p < ‚àû
there exists a constant Cn,p,Œµ,Œ¥ such that for all f ‚ààLp(Rn) and for all measurable
nonnegative functions u with u1+Œµ ‚ààL1
loc(Rn) and M(u1+Œµ) < ‚àûa.e. we have

Rn |T (‚àó)( f)|p udx ‚â§Cn,p,Œµ,Œ¥(A+B)p

Rn | f|pM(u1+Œµ)
1
1+Œµ dx.

Hint: Obtain this result as a consequence of Theorems 7.4.6 and 7.2.7.

7.4.3. Use the idea of the proof of Theorem 7.4.6 to prove the following result.
Suppose that for some Ô¨Åxed A,B > 0 the nonnegative Œº-measurable functions F
and G on a œÉ-Ô¨Ånite measure space (X,Œº) satisfy the distributional inequality
Œº

{G > Œ±}‚à©{F ‚â§cŒ±}

‚â§AŒº

{G > BŒ±}

for all Œ± > 0. Given 0 < p < ‚àû, if A < Bp and ‚à•G‚à•Lp(Œº) < ‚àû, show that
‚à•G‚à•Lp(Œº) ‚â§
B
(Bp ‚àíA)1/p
1
c ‚à•F‚à•Lp(Œº) .
7.4.4. Let Œ± > 0, w ‚ààA1, and f ‚ààL1(Rn,w) ‚à©L1(Rn). Let f = g + b be the
Calder¬¥on‚ÄìZygmund decomposition of f at height Œ± > 0 given in Theorem 5.3.1,
such that b = ‚àëj bj, where each bj is supported in a dyadic cube Qj,

Qj bj(x)dx = 0,
and Qj and Qk have disjoint interiors when j Ã∏= k. Prove that
(a) ‚à•g‚à•L1(w) ‚â§[w]A1‚à•f‚à•L1(w) and ‚à•g‚à•L‚àû(w) = ‚à•g‚à•L‚àû‚â§2nŒ±,
(b) ‚à•bj‚à•L1(w) ‚â§(1+[w]A1)‚à•f‚à•L1(Qj,w) and ‚à•b‚à•L1(w) ‚â§(1+[w]A1)‚à•f‚à•L1(w),
(c) ‚àëj w(Qj) ‚â§
[w]A1
Œ± ‚à•f‚à•L1(w).
7.4.5. Assume that T is an operator associated with a kernel in SK(Œ¥,A). Suppose
that T maps L2(w) to L2(w) for all w ‚ààA1 with bound Bw. Prove that there is a
constant Cn,Œ¥ such that
‚à•T‚à•L1(w)‚ÜíL1,‚àû(w) ‚â§Cn,Œ¥(A+Bw)[w]2
A1
for all w ‚ààA1.

Hint: Apply the idea of the proof of Theorem 5.3.3 using the Calder¬¥on-Zygmund
decomposition f = g+b of Exercise 7.4.4 at height Œ≥Œ± for a suitable Œ≥. To estimate

546
7 Weighted Inequalities
T(g) use an L2(w) estimate and Exercise 7.4.4. To estimate T(b) use the mean value
property, the fact that

Rn\Q‚àó
j
|y‚àícj|Œ¥
|x‚àícj|n+Œ¥ w(x)dx ‚â§CŒ¥,nM(w)(y) ‚â§C‚Ä≤
Œ¥,n[w]A1 w(y),
and Exercise 7.4.4 to obtain the required estimate.

7.4.6. Recall that the transpose Tt of a linear operator T is deÔ¨Åned by
4
T( f),g
5
=
4
f,Tt(g)
5
for all suitable f and g. Suppose that T is a linear operator that maps Lp(Rn,vdx)
to itself for some 1 < p < ‚àûand some v ‚ààAp. Show that the transpose operator Tt
maps Lp‚Ä≤(Rn,wdx) to itself with the same norm, where w = v1‚àíp‚Ä≤ ‚ààAp‚Ä≤.
7.4.7. Suppose that T is a linear operator that maps L2(Rn,vdx) to itself for all v
such that v‚àí1 ‚ààA1. Show that the transpose operator Tt of T maps L2(Rn,wdx) to
itself for all w ‚ààA1.
7.4.8. Let 1 < p < ‚àû. Suppose that T is a linear operator that maps Lp(v) to itself
for all v satisfying v‚àí1 ‚ààAp. Show that the transpose operator Tt of T maps Lp‚Ä≤(w)
to itself for all w satisfying w‚àí1 ‚ààAp‚Ä≤.
7.5 Further Properties of Ap Weights
In this section we discuss other properties of Ap weights. Many of these proper-
ties indicate deep connections with other branches of analysis. We focus attention
on three such properties: factorization, extrapolation, and relations of weighted in-
equalities to vector-valued inequalities.
7.5.1 Factorization of Weights
Recall the simple fact that if w1,w2 are A1 weights, then w = w1 w1‚àíp
2
is an Ap
weight (Exercise 7.1.2). The factorization theorem for weights says that the converse
of this statement is true. This provides a surprising and striking representation of Ap
weights.
Theorem 7.5.1. Suppose that w is an Ap weight for some 1 < p < ‚àû. Then there
exist A1 weights w1 and w2 such that
w = w1 w1‚àíp
2
.

7.5 Further Properties of Ap Weights
547
Proof. Let us Ô¨Åx a p ‚â•2 and w ‚ààAp. We deÔ¨Åne an operator T as follows:
T( f) =

w‚àí1
p M( f p‚àí1w
1
p )

1
p‚àí1 +w
1
p M( fw‚àí1
p ),
where M is the Hardy‚ÄìLittlewood maximal operator. We observe that T is well
deÔ¨Åned and bounded on Lp(Rn). This is a consequence of the facts that w‚àí
1
p‚àí1
is an Ap‚Ä≤ weight and that M maps Lp‚Ä≤(w‚àí
1
p‚àí1 ) to itself and also Lp(w) to itself.
Thus the norm of T on Lp depends only on the Ap characteristic constant of w.
Let B(w) = ‚à•T‚à•Lp‚ÜíLp, the norm of T on Lp. Next, we observe that for f,g ‚â•0 in
Lp(Rn) and Œª ‚â•0 we have
T( f +g) ‚â§T( f)+T(g),
T(Œª f) = ŒªT( f).
(7.5.1)
To see the Ô¨Årst assertion, we need only note that for every ball B, the operator
f ‚Üí
 1
|B|

B | f|p‚àí1w
1
p dx

1
p‚àí1
is sublinear as a consequence of Minkowski‚Äôs integral inequality, since p‚àí1 ‚â•1.
We now Ô¨Åx an Lp function f0 with ‚à•f0‚à•Lp = 1 and we deÔ¨Åne a function œï in
Lp(Rn) as the sum of the Lp convergent series
œï =
‚àû
‚àë
j=1
(2B(w))‚àíjT j( f0).
(7.5.2)
We deÔ¨Åne
w1 = w
1
p œï p‚àí1 ,
w2 = w‚àí1
p œï ,
so that w = w1 w1‚àíp
2
. It remains to show that w1,w2 are A1 weights. Applying T and
using (7.5.1), we obtain
T(œï) ‚â§2B(w)
‚àû
‚àë
j=1
(2B(w))‚àíj‚àí1T j+1( f0)
= 2B(w)

œï ‚àíT( f0)
2B(w)

‚â§2B(w)œï ,
that is,

w‚àí1
p M(œï p‚àí1w
1
p )

1
p‚àí1 +w
1
p M(œïw‚àí1
p ) ‚â§2B(w)œï .
Using that œï = (w‚àí1
p w1)
1
p‚àí1 = w
1
p w2, we obtain
M(w1) ‚â§(2B(w))p‚àí1w1
and
M(w2) ‚â§2B(w)w2 .

548
7 Weighted Inequalities
These show that w1 and w2 are A1 weights whose characteristic constants depend on
[w]Ap (and also the dimension n and p). This concludes the case p ‚â•2.
We now turn to the case p < 2. Given a weight w ‚ààAp for 1 < p < 2, we consider
the weight w‚àí1/(p‚àí1), which is in Ap‚Ä≤. Since p‚Ä≤ > 2, using the result we obtained, we
write w‚àí1/(p‚àí1) = v1v1‚àíp‚Ä≤
2
, where v1, v2 are A1 weights. It follows that w = v1‚àíp
1
v2,
and this completes the asserted factorization of Ap weights.
‚ñ°
Combining the result just obtained with Theorem 7.2.7, we obtain the following
description of Ap weights.
Corollary 7.5.2. Let w be an Ap weight for some 1 < p < ‚àû. Then there exist locally
integrable functions f1 and f2 with
M( f1)+M( f2) < ‚àû
a.e.,
constants 0 < Œµ1,Œµ2 < 1, and a nonnegative function k satisfying k,k‚àí1 ‚ààL‚àûsuch
that
w = kM( f1)Œµ1M( f2)Œµ2(1‚àíp) .
(7.5.3)
7.5.2 Extrapolation from Weighted Estimates on a Single Lp0
Our next topic concerns a striking application of the class of Ap weights. It says
that an estimate on Lp0(v) for a single p0 and all Ap0 weights v implies a similar Lp
estimate for all p in (1,‚àû). This property is referred to as extrapolation.
Surprisingly the operator T is not needed to be linear or sublinear in the following
extrapolation theorem. The only condition required is that T be well deÔ¨Åned on

1‚â§q<‚àû

w‚ààAq Lq(w). If T happens to be a linear operator, this condition can be
relaxed to T being well deÔ¨Åned on C ‚àû
0 (Rn).
Theorem 7.5.3. Suppose that T is deÔ¨Åned on 
1‚â§q<‚àû

w‚ààAq Lq(w) and takes values
in the space of measurable complex-valued functions. Let 1 ‚â§p0 < ‚àûand suppose
that there exists a positive increasing function N on [1,‚àû) such that for all weights
v in Ap0 we have
T

Lp0(v)‚ÜíLp0(v) ‚â§N

[v]Ap0

.
(7.5.4)
Then for any 1 < p < ‚àûand for all weights w in Ap we have
T

Lp(w)‚ÜíLp(w) ‚â§K

n, p, p0,[w]Ap

,
(7.5.5)
where
K

n, p, p0,[w]Ap

=
‚éß
‚é™
‚é™
‚é™
‚é®
‚é™
‚é™
‚é™
‚é©
2N

Œ∫1(n, p, p0)[w]
p0‚àí1
p‚àí1
Ap

when p < p0,
2
p‚àíp0
p0(p‚àí1) N

Œ∫2(n, p, p0) [w]Ap

when p > p0,
and Œ∫1(n, p, p0) and Œ∫2(n, p, p0) are constants that depend on n, p, and p0.

7.5 Further Properties of Ap Weights
549
Proof. Let 1 < p < ‚àûand w ‚ààAp. We deÔ¨Åne an operator
M‚Ä≤( f) = M( fw)
w
,
where M is the Hardy‚ÄìLittlewood maximal operator. We observe that since w1‚àíp‚Ä≤ is
in Ap‚Ä≤, the operator M‚Ä≤ maps Lp‚Ä≤(w) to itself; indeed, we have
M‚Ä≤
Lp‚Ä≤(w)‚ÜíLp‚Ä≤(w) =
M

Lp‚Ä≤(w1‚àíp‚Ä≤)‚ÜíLp‚Ä≤(w1‚àíp‚Ä≤)
‚â§Cn,p[w1‚àíp‚Ä≤]
1
p‚Ä≤‚àí1
Ap‚Ä≤
= Cn,p[w]Ap
(7.5.6)
in view of Theorem 7.1.9 and property (4) of Proposition 7.1.5.
We introduce operators M0( f) = | f| and Mk = M ‚ó¶M ‚ó¶¬∑¬∑¬∑ ‚ó¶M, where M is the
Hardy‚ÄìLittlewood maximal function and the composition is taken k times. Likewise,
we introduce powers (M‚Ä≤)k of M‚Ä≤ for k ‚ààZ+ ‚à™{0}. The following lemma provides
the main tool in the proof of Theorem 7.5.3. Its simple proof uses Theorem 7.1.9 and
(7.5.6) and is omitted.
Lemma 7.5.4. Let 1 < p < ‚àûand w ‚ààAp. DeÔ¨Åne operators R and R‚Ä≤
R( f) =
‚àû
‚àë
k=0
Mk( f)

2‚à•M‚à•Lp(w)‚ÜíLp(w)
k
for functions f in Lp(w) and also
R‚Ä≤( f) =
‚àû
‚àë
k=0
(M‚Ä≤)k( f)

2
M‚Ä≤
Lp‚Ä≤(w)‚ÜíLp‚Ä≤(w)
k
for functions f in Lp‚Ä≤(w). Then there exist constants C1(n, p) and C2(n, p) that de-
pend on n and p such that
| f| ‚â§R( f),
(7.5.7)
R( f)

Lp(w) ‚â§2
f

Lp(w) ,
(7.5.8)
M(R( f)) ‚â§C1(n, p)[w]
1
p‚àí1
Ap R( f),
(7.5.9)
for all functions f in Lp(w) and such that
|h| ‚â§R‚Ä≤(h),
(7.5.10)
R‚Ä≤(h)

Lp‚Ä≤(w) ‚â§2
h

Lp‚Ä≤(w) ,
(7.5.11)
M‚Ä≤(R‚Ä≤(h)) ‚â§C2(n, p)[w]Ap R‚Ä≤(h),
(7.5.12)
for all functions h in Lp‚Ä≤(w).

550
7 Weighted Inequalities
We now proceed with the proof of the theorem. It is natural to split the proof into
the cases p < p0 and p > p0.
Case (1): p < p0. Assume momentarily that R( f)
‚àí
p0
(p0/p)‚Ä≤ is an Ap0 weight. Then we
have
T( f)
p
Lp(w)
=

Rn |T( f)|pR( f)
‚àí
p
(p0/p)‚Ä≤ R( f)
p
(p0/p)‚Ä≤ wdx
‚â§

Rn |T( f)|p0R( f)
‚àí
p0
(p0/p)‚Ä≤ wdx
 p
p0 
Rn R( f)p wdx

1
(p0/p)‚Ä≤
‚â§N

R( f)
‚àí
p0
(p0/p)‚Ä≤ 
Ap0
p
Rn | f|p0R( f)
‚àí
p0
(p0/p)‚Ä≤ wdx
 p
p0 
Rn R( f)p wdx

1
(p0/p)‚Ä≤
‚â§N

R( f)
‚àí
p0
(p0/p)‚Ä≤ 
Ap0
p
Rn R( f)p0R( f)
‚àí
p0
(p0/p)‚Ä≤ wdx
 p
p0
Rn R( f)p wdx

1
(p0/p)‚Ä≤
= N

R( f)
‚àí
p0
(p0/p)‚Ä≤ 
Ap0
p
Rn R( f)pwdx
 p
p0 
Rn R( f)p wdx

1
(p0/p)‚Ä≤
‚â§N

R( f)
‚àí
p0
(p0/p)‚Ä≤ 
Ap0
p
2
 f

Lp(w)
p ,
where we used H¬®older‚Äôs inequality with exponents p0/p and (p0/p)‚Ä≤, the hypothesis
of the theorem, (7.5.7), and (7.5.8). Thus, we have the estimate
T( f)

Lp(w) ‚â§2N

R( f)
‚àí
p0
(p0/p)‚Ä≤ 
Ap0
f

Lp(w)
(7.5.13)
and it remains to obtain a bound for the Ap0 characteristic constant of R( f)
‚àí
p0
(p0/p)‚Ä≤ .
In view of (7.5.9), the function R( f) is an A1 weight with characteristic constant at
most a constant multiple of [w]
1
p‚àí1
Ap . Consequently, there is a constant C‚Ä≤
1 such that
R( f)‚àí1 ‚â§C‚Ä≤
1 [w]
1
p‚àí1
Ap
 1
|Q|

Q R( f)dx
‚àí1
for any cube Q in Rn. Thus we have
1
|Q|

Q R( f)
‚àí
p0
(p0/p)‚Ä≤ wdx
‚â§

C‚Ä≤
1 [w]
1
p‚àí1
Ap

p0
(p0/p)‚Ä≤
 1
|Q|

Q R( f)dx
‚àí
p0
(p0/p)‚Ä≤ 1
|Q|

Q wdx

.
(7.5.14)

7.5 Further Properties of Ap Weights
551
Next we have
 1
|Q|

Q

R( f)
‚àí
p0
(p0/p)‚Ä≤ w
1‚àíp‚Ä≤
0 dx
p0‚àí1
=
 1
|Q|

Q R( f)
p0(p‚Ä≤
0‚àí1)
(p0/p)‚Ä≤ w1‚àíp‚Ä≤
0 dx
p0‚àí1
‚â§
 1
|Q|

Q R( f)dx

p0
(p0/p)‚Ä≤  1
|Q|

Q w1‚àíp‚Ä≤p‚àí1
,
(7.5.15)
where we applied H¬®older‚Äôs inequality with exponents
 p‚Ä≤ ‚àí1
p‚Ä≤
0 ‚àí1
‚Ä≤
and
p‚Ä≤ ‚àí1
p‚Ä≤
0 ‚àí1 ,
and we used that
p0(p‚Ä≤
0 ‚àí1)
(p0/p)‚Ä≤
 p‚Ä≤ ‚àí1
p‚Ä≤
0 ‚àí1
‚Ä≤
= 1
and
p0 ‚àí1

p‚Ä≤‚àí1
p‚Ä≤
0‚àí1
‚Ä≤ =
p0
(p0/p)‚Ä≤ .
Multiplying (7.5.14) by (7.5.15) and taking the supremum over all cubes Q in Rn we
deduce that
/
R( f)
‚àí
p0
(p0/p)‚Ä≤ 0
Ap0
‚â§

C‚Ä≤
1 [w]
1
p‚àí1
Ap

p0
(p0/p)‚Ä≤ [w]Ap = Œ∫1(n, p, p0)[w]
p0‚àí1
p‚àí1
Ap
.
Combining this estimate with (7.5.13) and using the fact that N is an increasing
function, we obtain the validity of (7.5.5) in the case p < p0.
Case (2): p > p0. In this case we set r = p/p0 > 1. Then we have
T( f)
p
Lp(w) =
|T( f)|p0r
Lr(w) =

Rn |T( f)|p0hwdx
r
(7.5.16)
for some nonnegative function h with Lr‚Ä≤(w) norm equal to 1. We deÔ¨Åne a function
H =

R‚Ä≤
h
r‚Ä≤
p‚Ä≤  p‚Ä≤
r‚Ä≤ .
Obviously, we have 0 ‚â§h ‚â§H and thus

Rn |T( f)|p0hwdx ‚â§

Rn |T( f)|p0H wdx
‚â§N

[H w]Ap0
p0 f
p0
Lp0(H w)
‚â§N

[H w]Ap0
p0| f|p0
Lr(w)
H

Lr‚Ä≤(w)
‚â§2
p‚Ä≤
r‚Ä≤ N

[H w]Ap0
p0f
p0
Lp(w) ,
(7.5.17)

552
7 Weighted Inequalities
noting that
H
r‚Ä≤
Lr‚Ä≤(w) =

Rn R‚Ä≤(hr‚Ä≤/p‚Ä≤)p‚Ä≤ wdx ‚â§2p‚Ä≤ 
Rn hr‚Ä≤ wdx = 2p‚Ä≤ ,
which is valid in view of (7.5.11). Moreover, this argument is based on the hypothesis
of the theorem and requires that H w be an Ap0 weight. To see this, we observe that
condition (7.5.12) implies that Hr‚Ä≤/p‚Ä≤w is an A1 weight with characteristic constant
at most a multiple of [w]A1. Thus, there is a constant C‚Ä≤
2 that depends only on n and
p such that
1
|Q|

Q H
r‚Ä≤
p‚Ä≤ wdx ‚â§C‚Ä≤
2 [w]ApH
r‚Ä≤
p‚Ä≤ w
for all cubes Q in Rn. From this it follows that
(H w)‚àí1 ‚â§Œ∫2(n, p, p0)[w]
p‚Ä≤
r‚Ä≤
Ap
 1
|Q|

Q H
r‚Ä≤
p‚Ä≤ wdx
‚àíp‚Ä≤
r‚Ä≤
w
p‚Ä≤
r‚Ä≤ ‚àí1 ,
where we set Œ∫2(n, p, p0) = (C‚Ä≤
2)p‚Ä≤/r‚Ä≤. We raise the preceding displayed expression
to the power p‚Ä≤
0 ‚àí1, we average over the cube Q, and then we raise to the power
p0 ‚àí1. We deduce the estimate
 1
|Q|

Q(H w)1‚àíp‚Ä≤
0 dx
p0‚àí1
‚â§Œ∫2(n, p, p0)[w]
p‚Ä≤
r‚Ä≤
Ap
 1
|Q|

Q H
r‚Ä≤
p‚Ä≤ wdx
‚àíp‚Ä≤
r‚Ä≤  1
|Q|

Q w1‚àíp‚Ä≤ dx
p0‚àí1
,
(7.5.18)
where we use the fact that
 p‚Ä≤
r‚Ä≤ ‚àí1

p‚Ä≤
0 ‚àí1

= 1‚àíp‚Ä≤ .
Note that r‚Ä≤/p‚Ä≤ ‚â•1, since p0 ‚â•1. Using H¬®older‚Äôs inequality with exponents r‚Ä≤/p‚Ä≤
and (r‚Ä≤/p‚Ä≤)‚àí1 we obtain that
1
|Q|

Q H wdx ‚â§
 1
|Q|

Q H
r‚Ä≤
p‚Ä≤ wdx
 p‚Ä≤
r‚Ä≤  1
|Q|

Q wdx
 p0‚àí1
p‚àí1
,
(7.5.19)
where we used that
1
( r‚Ä≤
p‚Ä≤ )‚Ä≤ = p0 ‚àí1
p‚àí1 .
Multiplying (7.5.18) by (7.5.19), we deduce the estimate

H w

Ap0 ‚â§Œ∫2(n, p, p0)[w]
p‚Ä≤
r‚Ä≤
Ap [w]
p0‚àí1
p‚àí1
Ap
= Œ∫2(n, p, p0)[w]Ap .

7.5 Further Properties of Ap Weights
553
Inserting this estimate in (7.5.17) we obtain

Rn |T( f)|p0hwdx ‚â§2
p‚Ä≤
r‚Ä≤ N

Œ∫2(n, p, p0)[w]Ap
p0f
p0
Lp(w) ,
and combining this with (7.5.16) we conclude that
T( f)
p
Lp(w) ‚â§2
p‚Ä≤r
r‚Ä≤ N

Œ∫2(n, p, p0)[w]Ap
p0rf
p0r
Lp(w) .
This proves the required estimate (7.5.5) in the case p > p0.
‚ñ°
There is a version of Theorem 7.5.3 in which the initial strong type assumption
is replaced by a weak type estimate.
Theorem 7.5.5. Suppose that T is a well deÔ¨Åned operator on 
1<q<‚àû

w‚ààAq Lq(w)
that takes values in the space of measurable complex-valued functions. Fix 1 ‚â§
p0 < ‚àûand suppose that there is an increasing function N on [1,‚àû) such that for all
weights v in Ap0 we have
T

Lp0(v)‚ÜíLp0,‚àû(v) ‚â§N([v]Ap0).
(7.5.20)
Then for any 1 < p < ‚àûand for all weights w in Ap we have
T

Lp(w)‚ÜíLp,‚àû(w) ‚â§K

n, p, p0,[w]Ap

,
(7.5.21)
where K

n, p, p0,[w]Ap

is as in Theorem 7.5.3.
Proof. For every Ô¨Åxed Œª > 0 we deÔ¨Åne
TŒª( f) = Œªœá|T( f)|>Œª .
The operator TŒª is not linear but is well deÔ¨Åned on 
1<q<‚àû

w‚ààAq Lq(w), since T is
well deÔ¨Åned on this union. We show that TŒª maps Lp0(v) to Lp0(v) for every v ‚ààAp0.
Indeed, we have

Rn |TŒª( f)|p0 vdx
 1
p0 =

Rn Œª p0œá|T( f)|>Œª vdx
 1
p0
=

Œª p0v

{|T( f)| > Œª}
 1
p0
‚â§N([v]Ap0)
f

Lp0(v)
using the hypothesis on T. Applying Theorem 7.5.3, we obtain that TŒª maps Lp(w)
to itself for all 1 < p < ‚àûand all w ‚ààAp with a constant independent of Œª. Precisely,
for any w ‚ààAp and any f ‚ààLp(w) we have
TŒª( f)

Lp(w) ‚â§K

n, p, p0,[w]Ap
 f

Lp(w) .

554
7 Weighted Inequalities
Since
T( f)

Lp,‚àû(w) = sup
Œª>0
TŒª( f)

Lp(w) ,
it follows that T maps Lp(w) to Lp,‚àû(w) with the asserted norm.
‚ñ°
Assuming that the operator T in the preceding theorem is sublinear (or quasi-
sublinear), we obtain the following result that contains a stronger conclusion.
Corollary 7.5.6. Suppose that T is a sublinear operator on 
1<q<‚àû

w‚ààAq Lq(w)
that takes values in the space of measurable complex-valued functions. Fix 1 ‚â§
p0 < ‚àûand suppose that there is an increasing function N on [1,‚àû) such that for all
weights v in Ap0 we have
T

Lp0(v)‚ÜíLp0,‚àû(v) ‚â§N([v]Ap0).
(7.5.22)
Then for any 1 < p < ‚àûand any weight w in Ap there is a constant K‚Ä≤(n, p, p0,[w]Ap)
such that
T( f)

Lp(w) ‚â§K‚Ä≤(n, p, p0,[w]Ap)
f

Lp(w) .
Proof. The proof follows from Theorem 7.5.5 and the Marcinkiewicz interpolation
theorem.
‚ñ°
We end this subsection by observing that the conclusion of the extrapolation The-
orem 7.5.3 can be strengthened to yield vector-valued estimates. This strengthening
may be achieved by a simple adaptation of the proof discussed.
Corollary 7.5.7. Suppose that T is deÔ¨Åned on 
1‚â§q<‚àû

w‚ààAq Lq(w) and takes val-
ues in the space of all measurable complex-valued functions. Fix 1 ‚â§p0 < ‚àûand
suppose that there is an increasing function N on [1,‚àû) such that for all weights v
in Ap0 we have
T

Lp0(v)‚ÜíLp0(v) ‚â§N

[v]Ap0

.
Then for every 1 < p < ‚àûand every weight w ‚ààAp we have


‚àë
j
|T( f j)|p0
 1
p0 
Lp(w) ‚â§K(n, p, p0,[w]Ap)


‚àë
j
| f j|p0
 1
p0 
Lp(w)
for all sequences of functions f j in Lp(w), where K

n, p, p0,[w]Ap

is as in Theorem
7.5.3.
Proof. To derive the claimed vector-valued inequality follow the proof of Theorem
7.5.3 replacing the function f by (‚àëj | f j|p0)
1
p0 and T( f) by (‚àëj |T( f j)|p0)
1
p0 .
‚ñ°
7.5.3 Weighted Inequalities Versus Vector-Valued Inequalities
We now discuss connections between weighted inequalities and vector-valued
inequalities. The next result provides strong evidence that there is a nontrivial

7.5 Further Properties of Ap Weights
555
connection of this sort. The following is a general theorem saying that any vector-
valued inequality is equivalent to some weighted inequality. The proof of the the-
orem is based on a minimax lemma whose precise formulation and proof can be
found in Appendix H.
Theorem 7.5.8. (a) Let 0 < p < q,r < ‚àû. Let {Tj}j be a sequence of sublinear
operators that map Lq(Œº) to Lr(ŒΩ), where Œº and ŒΩ are arbitrary measures. Then
the vector-valued inequality

‚àë
j
|Tj( f j)|p1
p

Lr ‚â§C

‚àë
j
| f j|p1
p

Lq
(7.5.23)
holds for all f j ‚ààLq(Œº) if and only if for every u ‚â•0 in L
r
r‚àíp (ŒΩ) there exists U ‚â•0
in L
q
q‚àíp (Œº) with
‚à•U‚à•
L
q
q‚àíp ‚â§‚à•u‚à•L
r
r‚àíp ,
sup
j

|Tj( f)|p udŒΩ ‚â§Cp

| f|pU dŒº .
(7.5.24)
(b) Let 0 < q,r < p < ‚àû. Let {Tj}j be as before. Then the vector-valued inequality
(7.5.23) holds for all f j ‚ààLq(Œº) if and only if for every u ‚â•0 in L
q
p‚àíq (Œº) there exists
U ‚â•0 in L
r
p‚àír (ŒΩ) with
‚à•U‚à•L
r
p‚àír ‚â§‚à•u‚à•
L
q
p‚àíq ,
sup
j

|Tj( f)|pU‚àí1 dŒΩ ‚â§Cp

| f|p u‚àí1 dŒº .
(7.5.25)
Proof. We begin with part (a). Given f j ‚ààLq(Rn,Œº), we use (7.5.24) to obtain


‚àë
j
|Tj( f j)|p 1
p 
Lr(ŒΩ) =
‚àë
j
|Tj( f j)|p
1
p
L
rp (ŒΩ)
=
sup
‚à•u‚à•
L
r
r‚àíp ‚â§1

Rn‚àë
j
|Tj( f j)|p udŒΩ
1
p
‚â§
sup
‚à•u‚à•
L
r
r‚àíp ‚â§1
C

Rn‚àë
j
| f j|pU dŒº
1
p
‚â§
sup
‚à•u‚à•
L
r
r‚àíp ‚â§1
C
‚àë
j
| f j|p
1
p
L
q
p (Œº)‚à•U‚à•
1
p
L
q
q‚àíp
‚â§C


‚àë
j
| f j|p 1
p 
Lq(Œº) ,

556
7 Weighted Inequalities
which proves (7.5.23) with the same constant C as in (7.5.24). To prove the converse,
given a nonnegative u ‚ààL
r
r‚àíp (ŒΩ) with ‚à•u‚à•L
r
r‚àíp = 1, we deÔ¨Åne
A =
	
a = (a0,a1) : a0 = ‚àë
j
| f j|p,
a1 = ‚àë
j
|Tj( f j)|p,
f j ‚ààLq(Œº)

and
B =
	
b ‚ààL
q
q‚àíp (Œº) : b ‚â•0,
‚à•b‚à•
L
q
q‚àíp ‚â§1 = ‚à•u‚à•L
r
r‚àíp

.
Notice that A and B are convex sets and B is weakly compact. (The sublinearity of
each Tj is used here.) We deÔ¨Åne the function Œ¶ on A√óB by setting
Œ¶(a,b) =

a1udŒΩ ‚àíCp

a0bdŒº = ‚àë
j

|Tj( f j)|pudŒΩ ‚àíCp

| f j|pbdŒº

.
Then Œ¶ is concave on A and weakly continuous and convex on B. Thus the minimax
lemma in Appendix H is applicable. This gives
min
b‚ààB sup
a‚ààA
Œ¶(a,b) = sup
a‚ààA
min
b‚ààB Œ¶(a,b).
(7.5.26)
At this point observe that for a Ô¨Åxed a =

‚àëj | f j|p,‚àëj |Tj( f j)|p
in A we have
min
b‚ààB Œ¶(a,b) ‚â§
‚àë
j
|Tj( f j)|p
L
rp (ŒΩ)‚à•u‚à•L
r
r‚àíp ‚àíCp max
b‚ààB

‚àë
j
| f j|p bdŒº
‚â§
‚àë
j
|Tj( f j)|p
L
rp (ŒΩ) ‚àíCp‚àë
j
| f j|p
L
q
p (Œº) ‚â§0
using the hypothesis (7.5.23). It follows that supa‚ààA minb‚ààB Œ¶(a,b) ‚â§0 and hence
(7.5.26) yields minb‚ààB supa‚ààA Œ¶(a,b) ‚â§0. Thus there exists a U ‚ààB such that
Œ¶(a,U) ‚â§0 for every a ‚ààA. This completes the proof of part (a).
The proof of part (b) is similar. Using the result of Exercise 7.5.1 and (7.5.25),
given f j ‚ààLq(Rn,Œº) we have

‚àë
j
| f j|p 1
p

Lq(Œº) =
‚àë
j
| f j|p
1
p
L
q
p (Œº)
=
inf
‚à•u‚à•
L
q
p‚àíq ‚â§1

Rn‚àë
j
| f j|p u‚àí1 dŒº
1
p
‚â•1
C
inf
‚à•U‚à•
L
r
p‚àír ‚â§1

Rn‚àë
j
|Tj( f j)|pU‚àí1 dŒΩ
1
p

7.5 Further Properties of Ap Weights
557
= 1
C
‚àë
j
|Tj( f j)|p
1
p
L
rp (ŒΩ)
= 1
C


‚àë
j
|Tj( f j)|p 1
p 
Lr(ŒΩ) .
To prove the converse direction in part (b), given a Ô¨Åxed u ‚â•0 in L
q
p‚àíq (Œº) with
u

L
q
p‚àíq = 1, we deÔ¨Åne A as in part (a) and
B =
	
b ‚ààL
p
p‚àír (ŒΩ) : b ‚â•0,
‚à•b‚à•
L
p
p‚àír ‚â§1 = ‚à•u‚à•
L
q
p‚àíq

.
We also deÔ¨Åne the function Œ¶ on A√óB by setting
Œ¶(a,b) =

a1b‚àí1dŒΩ ‚àíCp

a0u‚àí1 dŒº
= ‚àë
j

|Tj( f j)|pb‚àí1 dŒΩ ‚àíCp

| f j|pu‚àí1 dŒº

.
Then Œ¶ is concave on A and weakly continuous and convex on B. Also, using Exer-
cise 7.5.1, for any a =

‚àëj | f j|p,‚àëj |Tj( f j)|p
in A, we have
min
b‚ààB Œ¶(a,b) ‚â§
‚àë
j
|Tj( f j)|p
L
rp (ŒΩ) ‚àíCp‚àë
j
| f j|p
L
q
p (Œº) ‚â§0.
Thus supa‚ààA minb‚ààB Œ¶(a,b) ‚â§0. Using (7.5.26), yields minb‚ààB supa‚ààA Œ¶(a,b) ‚â§0,
and the latter implies the existence of a U in B such that Œ¶(a,U) ‚â§0 for all a ‚ààA.
This proves (7.5.25).
‚ñ°
Example 7.5.9. We use the previous theorem to obtain another proof of the vector-
valued Hardy‚ÄìLittlewood maximal inequality in Corollary 5.6.5. We take Tj = M for
all j. For given 1 < p < q < ‚àûand u in L
q
q‚àíp we set s =
q
q‚àíp andU = ‚à•M‚à•‚àí1
Ls‚ÜíLs M(u).
In view of Exercise 7.1.7 we have
‚à•U‚à•Ls ‚â§‚à•u‚à•Ls
and

Rn M( f)p udx ‚â§Cp

Rn | f|pU dx.
Using Theorem 7.5.8, we obtain

‚àë
j
|M( f j)|p1
p

Lq ‚â§Cn,p,q

‚àë
j
| f j|p1
p

Lq
(7.5.27)
whenever 1 < p < q < ‚àû, an inequality obtained earlier in (5.6.25).
It turns out that no speciÔ¨Åc properties of the Hardy‚ÄìLittlewood maximal function
were used in the preceding inequality, and one could obtain a general result along
these lines.

558
7 Weighted Inequalities
Exercises
7.5.1. Let (X,Œº) be a measure space, 0 < s < 1, and f ‚ààLs(X,Œº). Show that
f

Ls = inf
$
X | f|u‚àí1 dŒº : ‚à•u‚à•L
s
1‚àís ‚â§1
%
and that the inÔ¨Åmum is attained.

Hint: Try u = c| f|1‚àís for a suitable constant c.

7.5.2. (K. Yabuta) Let w ‚ààAp for some 1 < p < ‚àûand let f be in Lp
loc(Rn,wdx).
Show that f lies in L1
loc(Rn).

Hint: Write w = w1/wp‚àí1
2
via Theorem 7.5.1.

7.5.3. Use the same idea of the proof of Theorem 7.5.1 to prove the following gen-
eral result: Let Œº be a positive measure on a measure space X and let T be a bounded
sublinear operator on Lp(X,Œº) for some 1 ‚â§p < ‚àû. Suppose that T( f) ‚â•0 for all f
in Lp(X,Œº). Prove that for all f0 ‚ààLp(X,Œº), there exists an f ‚ààLp(X,Œº) such that
(a) f0(x) ‚â§f(x) for Œº-almost all x ‚ààX.
(b) ‚à•f‚à•Lp(X) ‚â§2‚à•f0‚à•Lp(X).
(c) T( f)(x) ‚â§2‚à•T‚à•Lp‚ÜíLp f(x) for Œº-almost all x ‚ààX.

Hint: Try the expression in (7.5.2) starting the sum at j = 0.

7.5.4. ([100]) Suppose that T is an operator deÔ¨Åned on 
1<q<‚àû

w‚ààAq Lq(w) that
satisÔ¨Åes ‚à•T‚à•Lr(v)‚ÜíLr(v) ‚â§N([v]Ar) for some increasing function N : [1,‚àû) ‚ÜíR+.
Without using Theorem 7.5.3 prove that for 1 < q < r and all v ‚ààA1, T maps Lq(v)
to Lq(v) with constant depending on q,r, n, and [v]A1.

Hint: H¬®older‚Äôs inequality gives that
T( f)

Lq(v) ‚â§

Rn |T( f)(x)|rM( f)(x)q‚àír v(x)dx
1
r 
Rn M( f)(x)qv(x)dx
r‚àíq
rq
.
Then use the fact that the weight M( f)
r‚àíq
r‚àí1 is in A1 and Exercise 7.1.2.

7.5.5. Let T be a sublinear operator deÔ¨Åned on 
2‚â§q<‚àûLq. Suppose that for all
functions f and u we have

Rn |T( f)|2udx ‚â§

Rn | f|2M(u)dx.
Prove that T maps Lp(Rn) to itself for all 2 < p < ‚àû.

Hint: Use that
T( f)

Lp =
sup
‚à•u‚à•L(p/2)‚Ä≤ ‚â§1

Rn |T( f)|2udx
1
2
and H¬®older‚Äôs inequality.


7.5 Further Properties of Ap Weights
559
7.5.6. (X. C. Li) Let T be a sublinear operator deÔ¨Åned on 
1<q‚â§2

w‚ààAq Lq(w).
Suppose that T maps L2(w) to L2(w) for all weights w that satisfy w‚àí1 ‚ààA1. Prove
that T maps Lp to itself for all 1 < p < 2.

Hint: We have
T( f)

Lp ‚â§

Rn |T( f)|2M( f)‚àí(2‚àíp) dx
1
2 
Rn M( f)p dx
2‚àíp
2p
by H¬®older‚Äôs inequality. Apply the hypothesis to the Ô¨Årst term of the product.

HISTORICAL NOTES
Weighted inequalities can probably be traced back to the beginning of integration, but the
Ap condition Ô¨Årst appeared in a paper of Rosenblum [298] in a somewhat different form. The
characterization of Ap when n = 1 in terms of the boundedness of the Hardy‚ÄìLittlewood maximal
operator was obtained by Muckenhoupt [260]. The estimate on the norm in (7.1.25) can also be
reversed, as shown by Buckley [38]. The simple proof of Theorem 7.1.9 is contained in Lerner‚Äôs
article [218] and yields both the Muckenhoupt theorem and Buckley‚Äôs optimal growth of the norm
of the Hardy‚ÄìLittlewood maximal operator in terms of the Ap characteristic constant of the weight.
Another proof of this result is given by Christ and Fefferman [61]. Versions of Lemma 7.1.10 for
balls were Ô¨Årst obtained by Besicovitch [27] and independently by Morse [258]. The particular
version of Lemma 7.1.10 that appears in the text is adapted from that in de Guzm¬¥an [93]. Another
version of this lemma is contained in the book of Mattila [246]. The fact that A‚àûis the union
of the Ap spaces was independently obtained by Muckenhoupt [261] and Coifman and Fefferman
[66]. The latter paper also contains a proof that Ap weights satisfy the crucial reverse H¬®older
condition. This condition Ô¨Årst appeared in the work of Gehring [125] in the following context: If F
is a quasiconformal homeomorphism from Rn into itself, then |det(‚àáF)| satisÔ¨Åes a reverse H¬®older
inequality. The characterization of A1 weights is due to Coifman and Rochberg [68]. The fact that
M( f)Œ¥ is in A‚àûwhen Œ¥ < 1 was previously obtained by C¬¥ordoba and Fefferman [74]. The different
characterizations of A‚àû(Theorem 7.3.3) are implicit in [260] and [66]. Another characterization of
A‚àûin terms of the Gurov-Reshetnyak condition supQ
1
|Q|

Q | f ‚àíAvgQ f|dx ‚â§Œµ AvgQ f for f ‚â•0
and 0 < Œµ < 2 was obtained by Korenovskyy, Lerner, and Stokolos [201]. The deÔ¨Ånition of A‚àû
using the reverse Jensen inequality herein was obtained as an equivalent characterization of that
space by Garc¬¥ƒ±a-Cuerva and Rubio de Francia [122] (p. 405) and independently by HrusÀácev [161].
The reverse H¬®older condition was extensively studied by Cruz-Uribe and Neugebauer [82].
Weighted inequalities with weights of the form |x|a for the Hilbert transform were Ô¨Årst obtained
by Hardy and Littlewood [147] and later by Stein [332] for other singular integrals. The necessity
and sufÔ¨Åciency of the Ap condition for the boundedness of the Hilbert transform on weighted Lp
spaces was obtained by Hunt, Muckenhoupt, and Wheeden [167]. Historically, the Ô¨Årst result re-
lating Ap weights and the Hilbert transform is the Helson-SzegÀùo theorem [149], which says that
the Hilbert transform is bounded on L2(w) if and only if logw = u+Hv, where u,v ‚ààL‚àû(R) and
‚à•v‚à•L‚àû< œÄ
2 . The Helson-SzegÀùo condition easily implies the A2 condition, but the only known direct
proof for the converse gives ‚à•v‚à•L‚àû< œÄ; see Coifman, Jones, and Rubio de Francia [67]. A related
result in higher dimensions was obtained by Garnett and Jones [123]. Weighted Lp estimates con-
trolling Calder¬¥on‚ÄìZygmund operators by the Hardy‚ÄìLittlewood maximal operator were obtained
by Coifman [65]. Coifman and Fefferman [66] extended one-dimensional weighted norm inequal-
ities to higher dimensions and also obtained good lambda inequalities for A‚àûweights for more
general singular integrals and maximal singular integrals (Theorem 7.4.3). Bagby and Kurtz [19],
and later Alvarez and P¬¥erez [4], gave a sharper version of Theorem 7.4.3, by replacing the good
lambda inequality by a rearrangement inequality. See also the related work of Lerner [217]. The
following relation ‚à•Md( f)‚à•Lp(w) ‚â§C(p,n,[w]A‚àû)‚à•M#( f)‚à•Lp(w) between the dyadic maximal func-
tion and the sharp maximal function is valid for any w ‚ààA‚àûunder the condition M( f) ‚ààLp0 but

560
7 Weighted Inequalities
also under the weaker assumption that w({| f| > t}) < ‚àûfor every t > 0; see Kurtz [208]. Using
that min(M,w) is an A‚àûweight with constant independent of M and Fatou‚Äôs lemma, this condition
can be relaxed to |{| f| > t}| < ‚àûfor every t > 0. A rearrangement inequality relating f and M#( f)
is given in Bagby and Kurtz [18].
The factorization of Ap weights was conjectured by Muckenhoupt and proved by Jones [179].
The simple proof given in the text can be found in [67]. Extrapolation of operators (Theorem 7.5.3)
is due to Rubio de Francia [300]. An alternative proof of this theorem was given later by Garc¬¥ƒ±a-
Cuerva [121]. The value of the constant K(n, p, p0,[w]Ap) Ô¨Årst appeared in DragiÀácevi¬¥c, Grafakos,
Pereyra, and Petermichl [98]. Another proof with sharp bounds (in terms of the characteristic con-
stant of the weights) was given by Duoandikoetxea [101]. The present treatment of Theorem 7.5.3,
based on crucial Lemma 7.5.4, was communicated to the author by J. M. Martell. One may also
consult the related work of Cruz-Uribe, Martell, and P¬¥erez [80]. The simple proof of Theorem 7.5.5
was conceived by J. M. Martell and Ô¨Årst appeared in the treatment of extrapolation of operators of
many variables; see Grafakos and Martell [135]. The idea of extrapolation can be carried to general
pairs of functions, see Cruz-Uribe, Martell, and P¬¥erez [78]. Estimates for the distribution function
in extrapolation theory were obtained by Carro, Torres, and Soria [58]. The equivalence between
vector-valued inequalities and weighted norm inequalities of Theorem 7.5.8 is also due to Rubio de
Francia [299]. The difÔ¨Åcult direction in this equivalence is obtained using a minimax principle (see
Fan [111]). Alternatively, one can use the factorization theory of Maurey [247], which brings an
interesting connection with Banach space theory. The book of Garc¬¥ƒ±a-Cuerva and Rubio de Francia
[122] provides an excellent reference on this and other topics related to weighted norm inequalities.
A primordial double-weighted norm inequality is the observation of Fefferman and Stein [115]
that the maximal function maps Lp(M(w)) to Lp(w) for nonnegative measurable functions w (Exer-
cise 7.1.7). Sawyer [312] obtained that the condition supQ

Q v1‚àíp‚Ä≤dx
‚àí1
Q M(v1‚àíp‚Ä≤œáQ)pwdx < ‚àû
provides a characterization of all pairs of weights (v,w) for which the Hardy‚ÄìLittlewood maximal
operator M maps Lp(v) to Lp(w). Simpler proofs of this result were obtained by Cruz-Uribe [77]
and Verbitsky [367]. The fact that Sawyer‚Äôs condition reduces to the usual Ap condition when v = w
was shown by Hunt, Kurtz, and Neugebauer [166]. The two-weight problem for singular integrals
is more delicate, since they are not necessarily bounded from Lp(M(w)) to Lp(w). Known results
in this direction are that singular integrals map Lp(M[p]+1(w)) to Lp(w), where Mr denotes the rth
iterate of the maximal operator. See Wilson [377] (for 1 < p < 2) and P¬¥erez [277] for the remaining
p‚Äôs. A necessary condition for the boundedness of the Hilbert transform from Lp(v) to Lp(w) was
obtained by Muckenhoupt and Wheeden [262].
For an approach to two-weighted inequalities using Bellman functions, we refer to the article of
Nazarov, Treil, and Volberg [266]. The notion of Bellman functions originated in control theory;
the article [267] of the previous authors analyzes the connections between optimal control and
harmonic analysis. Bellman functions have been used to derive estimates for the norms of classical
operators on weighted Lebesgue spaces; for instance, Petermichl [279] showed that for w ‚ààA2(R),
the norm of the Hilbert transform from L2(R,w) to L2(R,w) is bounded by a constant times the
characteristic constant [w]A2.
The theory of Ap weights in this chapter carries through to the situation in which Lebesgue
measure is replaced by a general doubling measure. This theory also has a substantial analogue
when the underlying measure is nondoubling but satisÔ¨Åes Œº(‚àÇQ) = 0 for all cubes Q in Rn with
sides parallel to the axes; see Orobitg and P¬¥erez [272]. A thorough account of weighted Littlewood‚Äì
Paley theory and exponential-square function integrability is contained in the book of Wilson [378].
The conjecture whether ‚à•T‚à•L1(M(w))‚ÜíL1,‚àû(w) < ‚àûholds for a weight w was disproved by
Reguera [287] when T is a Haar multiplier and then by Reguera and Thiele [288] for the Hilbert
transform. However, the slightly weaker version of this inequality, in which M(w) is replaced by
the Orlicz maximal operator ML(logL)Œµ (w), holds for any Œµ > 0 and any Calder¬¥on-Zygmund oper-
ator T, as shown by P¬¥erez [277]. For A1 weights w the aforementioned conjecture would imply
‚à•T‚à•L1(w)‚ÜíL1,‚àû(w) ‚â§C[w]A1. However, Nazarov, Reznikov, Vasyunin, and Volberg [265] disproved
the weaker inequality ‚à•T‚à•L1(w)‚ÜíL1,‚àû(w) ‚â§C[w]A1

log(e + [w]A1)
Œ± for Œ± < 1
5. Lerner, Ombrosi,
and P¬¥erez [223] had previously shown that the preceding inequality holds with Œ± = 1 for any
Calder¬¥on-Zygmund operator T.

7.5 Further Properties of Ap Weights
561
Concerning the sharp weighted bound ‚à•T‚à•L2(w)‚ÜíL2(w) ‚â§cT [w]A2 for a Calder¬¥on-Zygmund op-
erator T we have the work of Petermichl and Volberg [281] which answered a question by Astala,
Iwaniecz and Saksman [14] on the regularity of solutions to the Beltrami equation. The proofs of
this inequality for the Hilbert and Riesz transforms via the Bellman function technique were ob-
tained soon afterwards by Petermichl [279], [280]. The use of Bellman functions was Ô¨Årst avoided
in the work of Lacey, Petermichl, and Reguera [210], whose proof recovered the already known
cases and used Haar shift operators, the two-weight theory for them of Nazarov, Treil and Volberg
[268], and corona decompositions. The simplest proof for these classical operators was obtained
by Cruz-Uribe, Martell, and P¬¥erez [79], [81] using a very powerful inequality due to Lerner [219].
The complete proof for a general Calder¬¥on-Zygmund operator was given by Hyt¬®onen [168]. A sim-
pliÔ¨Åed proof was provided by Lerner [220], [221]. For other improvements and estimates involving
Ap and A‚àûconstants see the work of Lerner [222], Hyt¬®onen and P¬¥erez [170], and Lacey, Hyt¬®onen,
and P¬¥erez [169].

Appendix A
Gamma and Beta Functions
A.1 A Useful Formula
The following formula is valid:

Rn e‚àí|x|2dx =
‚àöœÄ
n .
This is an immediate consequence of the corresponding one-dimensional identity
 +‚àû
‚àí‚àûe‚àíx2dx = ‚àöœÄ ,
which is usually proved from its two-dimensional version by switching to polar
coordinates:
I2 =
 +‚àû
‚àí‚àû
 +‚àû
‚àí‚àûe‚àíx2e‚àíy2 dydx = 2œÄ
 ‚àû
0 re‚àír2 dr = œÄ .
A.2 DeÔ¨Ånitions of Œì (z) and B(z,w)
For a complex number z with Rez > 0 deÔ¨Åne
Œì (z) =
 ‚àû
0 tz‚àí1e‚àítdt.
Œì (z) is called the gamma function. It follows from its deÔ¨Ånition that Œì (z) is analytic
on the right half-plane Rez > 0.
Two fundamental properties of the gamma function are that
Œì (z+1) = zŒì (z)
and
Œì (n) = (n‚àí1)!,
L. Grafakos, Classical Fourier Analysis, Graduate Texts in Mathematics 249,
DOI 10.1007/978-1-4939-1194-3, ¬© Springer Science+Business Media New York 2014
563

564
A Gamma and Beta Functions
where z is a complex number with positive real part and n ‚ààZ+. Indeed, integration
by parts yields
Œì (z) =
 ‚àû
0 tz‚àí1e‚àít dt =
tze‚àít
z
‚àû
0
+ 1
z
 ‚àû
0 tze‚àít dt = 1
z Œì (z+1).
Since Œì (1) = 1, the property Œì (n) = (n ‚àí1)! for n ‚ààZ+ follows by induction.
Another important fact is that
Œì
 1
2

= ‚àöœÄ .
This follows easily from the identity
Œì
 1
2

=
 ‚àû
0 t‚àí1
2 e‚àít dt = 2
 ‚àû
0 e‚àíu2 du = ‚àöœÄ .
Next we deÔ¨Åne the beta function. Fix z and w complex numbers with positive real
parts. We deÔ¨Åne
B(z,w) =
 1
0 tz‚àí1(1‚àít)w‚àí1 dt =
 1
0 tw‚àí1(1‚àít)z‚àí1 dt.
We have the following relationship between the gamma and the beta functions:
B(z,w) = Œì (z)Œì (w)
Œì (z+w) ,
when z and w have positive real parts.
The proof of this fact is as follows:
Œì (z+w)B(z,w) = Œì (z+w)
 1
0 tw‚àí1(1‚àít)z‚àí1 dt
= Œì (z+w)
 ‚àû
0 uw‚àí1

1
1+u
z+w
du
t = u/(1+u)
=
 ‚àû
0
 ‚àû
0 uw‚àí1

1
1+u
z+w
vz+w‚àí1e‚àív dvdu
=
 ‚àû
0
 ‚àû
0 uw‚àí1sz+w‚àí1e‚àís(u+1) dsdu
s = v/(1+u)
=
 ‚àû
0 sze‚àís
 ‚àû
0 (us)w‚àí1e‚àísu duds
=
 ‚àû
0 sz‚àí1e‚àísŒì (w)ds
= Œì (z)Œì (w).

A.4 Computation of Integrals Using Gamma Functions
565
A.3 Volume of the Unit Ball and Surface of the Unit Sphere
We denote by vn the volume of the unit ball in Rn and by œân‚àí1 the surface area of
the unit sphere Sn‚àí1. We have the following:
œân‚àí1 = 2œÄ
n
2
Œì ( n
2)
and
vn = œân‚àí1
n
= 2œÄ
n
2
nŒì ( n
2) =
œÄ
n
2
Œì ( n
2 +1) .
The easy proofs are based on the formula in Appendix A.1. We have
‚àöœÄ
n =

Rn e‚àí|x|2dx = œân‚àí1
 ‚àû
0 e‚àír2rn‚àí1 dr,
by switching to polar coordinates. Now change variables t = r2 to obtain that
œÄ
n
2 = œân‚àí1
2
 ‚àû
0 e‚àítt
n
2 ‚àí1 dt = œân‚àí1
2 Œì
 n
2

.
This proves the formula for the surface area of the unit sphere in Rn.
To compute vn, write again using polar coordinates
vn = |B(0,1)| =

|x|‚â§1 1dx =

Sn‚àí1
 1
0 rn‚àí1 drdŒ∏ = 1
n œân‚àí1 .
Here is another way to relate the volume to the surface area. Let B(0,R) be the
ball in Rn of radius R > 0 centered at the origin. Then the volume of the shell
B(0,R + h) \ B(0,R) divided by h tends to the surface area of B(0,R) as h ‚Üí0. In
other words, the derivative of the volume of B(0,R) with respect to the radius R is
equal to the surface area of B(0,R). Since the volume of B(0,R) is vnRn, it follows
that the surface area of B(0,R) is nvnRn‚àí1. Taking R = 1, we deduce œân‚àí1 = nvn.
A.4 Computation of Integrals Using Gamma Functions
Let k1,...,kn be nonnegative even integers. The integral

Rn xk1
1 ¬∑¬∑¬∑xkn
n e‚àí|x|2dx1 ¬∑¬∑¬∑dxn =
n
‚àè
j=1
 +‚àû
‚àí‚àûx
k j
j e‚àíx2
j dxj =
n
‚àè
j=1
Œì
kj +1
2

expressed in polar coordinates is equal to

Sn‚àí1 Œ∏ k1
1 ¬∑¬∑¬∑Œ∏ kn
n dŒ∏
 ‚àû
0 rk1+¬∑¬∑¬∑+knrn‚àí1e‚àír2dr,

566
A Gamma and Beta Functions
where Œ∏ = (Œ∏1,...,Œ∏n). This leads to the identity

Sn‚àí1 Œ∏ k1
1 ¬∑¬∑¬∑Œ∏ kn
n dŒ∏ = 2Œì
k1 +¬∑¬∑¬∑+kn +n
2
‚àí1
n
‚àè
j=1
Œì
kj +1
2

.
Another classical integral that can be computed using gamma functions is the
following:
 œÄ/2
0
(sinœï)a(cosœï)b dœï = 1
2
Œì ( a+1
2 )Œì ( b+1
2 )
Œì ( a+b+2
2
)
,
whenever a and b are complex numbers with Rea > ‚àí1 and Reb > ‚àí1.
Indeed, change variables u = (sinœï)2; then du = 2(sinœï)(cosœï)dœï, and the pre-
ceding integral becomes
1
2
 1
0 u
a‚àí1
2 (1‚àíu)
b‚àí1
2 du = 1
2 B
a+1
2
, b+1
2

= 1
2
Œì ( a+1
2 )Œì ( b+1
2 )
Œì ( a+b+2
2
)
.
A.5 Meromorphic Extensions of B(z,w) and Œì (z)
Using the identity Œì (z + 1) = zŒì (z), we can easily deÔ¨Åne a meromorphic exten-
sion of the gamma function on the whole complex plane starting from its known
values on the right half-plane. We give an explicit description of the meromorphic
extension of Œì (z) on the whole plane. First write
Œì (z) =
 1
0 tz‚àí1e‚àítdt +
 ‚àû
1 tz‚àí1e‚àítdt
and observe that the second integral is an analytic function of z for all z ‚ààC. Write
the Ô¨Årst integral as
 1
0 tz‚àí1

e‚àít ‚àí
N
‚àë
j=0
(‚àít) j
j!
+
dt +
N
‚àë
j=0
(‚àí1) j/j!
z+ j
.
The last integral converges when Rez > ‚àíN‚àí1, since the expression inside the curly
brackets is O(tN+1) as t ‚Üí0. It follows that the gamma function can be deÔ¨Åned to be
an analytic function on Rez > ‚àíN ‚àí1 except at the points z = ‚àíj, j = 0,1,...,N, at
which it has simple poles with residues (‚àí1) j
j! . Since N was arbitrary, it follows that
the gamma function has a meromorphic extension on the whole plane.
In view of the identity
B(z,w) = Œì (z)Œì (w)
Œì (z+w) ,
the deÔ¨Ånition of B(z,w) can be extended to C√óC. It follows that B(z,w) is a mero-
morphic function in each argument.

A.6 Asymptotics of Œì (x) as x ‚Üí‚àû
567
A.6 Asymptotics of Œì (x) as x ‚Üí‚àû
We now derive Stirling‚Äôs formula:
lim
x‚Üí‚àû
Œì (x+1)
 x
e
x‚àö
2œÄx = 1.
First change variables t = x+sx
!
2
x to obtain
Œì (x+1) =
 ‚àû
0 e‚àíttx dt =
x
e
x‚àö
2x
 +‚àû
‚àí‚àö
x/2

1+s
!
2
x
x
e2s‚àö
x/2
ds.
Setting y = " x
2, we obtain
Œì (x+1)
 x
e
x‚àö
2x
=
 +‚àû
‚àí‚àû
'
1+ s
y
y
es
(2y
œá(‚àíy,‚àû)(s)ds.
To show that the last integral converges to ‚àöœÄ as y ‚Üí‚àû, we need the following:
(1) The fact that
lim
y‚Üí‚àû

1+s/y
y
es
2y
‚Üíe‚àís2 ,
which follows easily by taking logarithms and applying L‚ÄôHÀÜopital‚Äôs rule twice.
(2) The estimate, valid for y ‚â•1,
'
1+ s
y
y
es
(2y
‚â§
‚éß
‚é™
‚é®
‚é™
‚é©
(1+s)2
es
when s ‚â•0,
e‚àís2
when ‚àíy < s < 0,
which can be easily checked using calculus. Using these facts, the Lebesgue dom-
inated convergence theorem, the trivial fact that œá‚àíy<s<‚àû‚Üí1 as y ‚Üí‚àû, and the
identity in Appendix A.1, we obtain that
lim
x‚Üí‚àû
Œì (x+1)
 x
e
x‚àö
2x
= lim
y‚Üí‚àû
 +‚àû
‚àí‚àû
'
1+ s
y
y
es
(2y
œá(‚àíy,‚àû)(s)ds
=
 +‚àû
‚àí‚àûe‚àís2ds
= ‚àöœÄ.

568
A Gamma and Beta Functions
As a consequence of Stirling‚Äôs formula, for any t > 0, we obtain
lim
x‚Üí‚àû
Œì (x)
Œì (x+t) = 0.
A.7 Euler‚Äôs Limit Formula for the Gamma Function
For n a positive integer and Rez > 0 we consider the functions
Œìn(z) =
 n
0

1‚àít
n
n
tz‚àí1 dt
We show that
Œìn(z) =
n!nz
z(z+1)¬∑¬∑¬∑(z+n)
and we obtain Euler‚Äôs limit formula for the gamma function
lim
n‚Üí‚àûŒìn(z) = Œì (z).
We write Œì (z)‚àíŒìn(z) = I1(z)+I2(z)+I3(z), where
I1(z) =
 ‚àû
n e‚àíttz‚àí1 dt ,
I2(z) =
 n
n/2

e‚àít ‚àí

1‚àít
n
n
tz‚àí1 dt ,
I3(z) =
 n/2
0

e‚àít ‚àí

1‚àít
n
n
tz‚àí1 dt .
Obviously I1(z) tends to zero as n ‚Üí‚àû. For I2 and I3 we have that 0 ‚â§t < n, and by
the Taylor expansion of the logarithm we obtain
log

1‚àít
n
n
= nlog

1‚àít
n

= ‚àít ‚àíL,
where
L = t2
n
1
2 + 1
3
t
n + 1
4
t2
n2 +¬∑¬∑¬∑

.
It follows that
0 < e‚àít ‚àí

1‚àít
n
n
= e‚àít ‚àíe‚àíLe‚àít ‚â§e‚àít ,
and thus I2(z) tends to zero as n ‚Üí‚àû. For I3 we have t/n ‚â§1/2, which implies that
L ‚â§t2
n
‚àû
‚àë
k=0
1
(k +1)2k‚àí1 = t2
n c.

A.7 Euler‚Äôs Limit Formula for the Gamma Function
569
Consequently, for t/n ‚â§1/2 we have
0 ‚â§e‚àít ‚àí

1‚àít
n
n
= e‚àít(1‚àíe‚àíL) ‚â§e‚àítL ‚â§e‚àít ct2
n .
Plugging this estimate into I3, we deduce that
|I3(z)| ‚â§c
n Œì (Rez+2),
which certainly tends to zero as n ‚Üí‚àû.
Next, n integrations by parts give
Œìn(z) = n
nz
n‚àí1
n(z+1)
n‚àí2
n(z+2) ¬∑¬∑¬∑
1
n(z+n‚àí1)
 n
0 tz+n‚àí1 dt =
n!nz
z(z+1)¬∑¬∑¬∑(z+n) .
This can be written as
1 = Œìn(z)zexp

z

1+ 1
2 + 1
3 +¬∑¬∑¬∑+ 1
n ‚àílogn
 n
‚àè
k=1

1+ z
k

e‚àíz/k .
Taking limits as n ‚Üí‚àû, we obtain an inÔ¨Ånite product form of Euler‚Äôs limit formula,
1 = Œì (z)zeŒ≥z
‚àû
‚àè
k=1

1+ z
k

e‚àíz/k ,
where Rez > 0 and Œ≥ is Euler‚Äôs constant
Œ≥ = lim
n‚Üí‚àû1+ 1
2 + 1
3 +¬∑¬∑¬∑+ 1
n ‚àílogn.
The inÔ¨Ånite product converges uniformly on compact subsets of the complex plane
that excludes z = 0,‚àí1,‚àí2,..., and thus it represents a holomorphic function in this
domain. This holomorphic function multiplied by Œì (z)zeŒ≥z is equal to 1 on Rez > 0
and by analytic continuation it must be equal to 1 on C\{0,‚àí1,‚àí2,...}. But Œì (z)
has simple poles, while the inÔ¨Ånite product vanishes to order one, at the nonpositive
integers. We conclude that Euler‚Äôs limit formula holds for all complex numbers z;
consequently, Œì (z) has no zeros and Œì (z)‚àí1 is entire.
An immediate consequence of Euler‚Äôs limit formula is the identity
1
|Œì (x+iy)|2 =
1
|Œì (x)|2
‚àû
‚àè
k=0

1+
y2
(k +x)2

,
which holds for x and y real with x /‚àà{0,‚àí1,‚àí2,...}. As a consequence we have
that
|Œì (x+iy)| ‚â§|Œì (x)|

570
A Gamma and Beta Functions
and also that
1
|Œì (x+iy)| ‚â§
1
|Œì (x)|eC(x)|y|2 ,
where
C(x) = 1
2
‚àû
‚àë
k=0
1
(k +x)2 ,
whenever y ‚ààR and x ‚ààR \ {0,‚àí1,‚àí2,...}. Before we Ô¨Ånd a similar estimate for
x ‚àà{0,‚àí1,‚àí2,...} we provide a simpler expression for this estimate when x > 0.
When x > 0 we have
C(x) ‚â§1
2x2 + 1
2
‚àû
‚àë
k=1
1
(k +x)2 ‚â§1
2x2 + 1
2
 ‚àû
0
dt
(t +x)2 = 1
2x2 + 1
2x
 ‚àû
1
dt
t2 = 1
2x2 + 1
2x.
Thus we conclude that when x > 0 and y ‚ààR we have
1
|Œì (x+iy)| ‚â§
1
|Œì (x)|emax{x‚àí2,x‚àí1}|y|2 .
When x = 0 we write Œì (iy)iy = Œì (1+iy) and use the preceding inequality to obtain
1
|Œì (iy)| ‚â§
|iy|
|Œì (1)|e|y|2 = |y|e|y|2
and more generally for x = ‚àíN ‚àà{‚àí1,‚àí2,...} and y ‚ààR we obtain by induction
1
|Œì (‚àíN +iy)| ‚â§|iy||1+iy||2+iy| ¬∑¬∑¬∑|N +iy|e|y|2 .
A.8 ReÔ¨Çection and Duplication Formulas for the Gamma
Function
The reÔ¨Çection formula relates the values of the gamma function of a complex num-
ber z and its reÔ¨Çection about the point 1/2 in the following way:
sin(œÄz)
œÄ
=
1
Œì (z)
1
Œì (1‚àíz) .
The duplication formula relates the entire functions Œì (2z)‚àí1 and Œì (z)‚àí1 as follows:
1
Œì (z)Œì (z+ 1
2) = œÄ‚àí1
2 22z‚àí1
Œì (2z)
.

A.8 ReÔ¨Çection and Duplication Formulas for the Gamma Function
571
Both of these could be proved using Euler‚Äôs limit formula. The reÔ¨Çection formula
also uses the identity
‚àû
‚àè
k=1

1‚àíz2
k2

= sin(œÄz)
œÄz
,
while the duplication formula makes use of the fact that
lim
n‚Üí‚àû
(n!)2 22n+1
(2n)!n1/2 = 2œÄ1/2 .
These and other facts related to the gamma function can be found in Olver [271].

Appendix B
Bessel Functions
B.1 DeÔ¨Ånition
We survey some basics from the theory of Bessel functions JŒΩ of complex order
ŒΩ with ReŒΩ > ‚àí1/2. We deÔ¨Åne the Bessel function JŒΩ of order ŒΩ by its Poisson
representation formula
JŒΩ(t) =
 t
2
ŒΩ
Œì (ŒΩ + 1
2)Œì ( 1
2)
 +1
‚àí1 eits(1‚àís2)ŒΩ
ds
‚àö
1‚àís2 ,
where ReŒΩ > ‚àí1/2 and t ‚â•0. Although this deÔ¨Ånition is also valid when t is a
complex number, for the applications we have in mind, it sufÔ¨Åces to consider the
case that t is real and nonnegative; in this case JŒΩ(t) is also a real number.
B.2 Some Basic Properties
Let us summarize a few properties of Bessel functions. We take t > 0.
(1) We have the following recurrence formula:
d
dt

t‚àíŒΩJŒΩ(t)

= ‚àít‚àíŒΩJŒΩ+1(t),
ReŒΩ > ‚àí1/2.
(2) We also have the companion recurrence formula:
d
dt

tŒΩJŒΩ(t)

= tŒΩJŒΩ‚àí1(t),
ReŒΩ > 1/2.
L. Grafakos, Classical Fourier Analysis, Graduate Texts in Mathematics 249,
DOI 10.1007/978-1-4939-1194-3, ¬© Springer Science+Business Media New York 2014
573

574
B Bessel Functions
(3) JŒΩ(t) satisÔ¨Åes the differential equation:
t2 d2
dt2 (JŒΩ(t))+t d
dt (JŒΩ(t))+(t2 ‚àíŒΩ2)JŒΩ(t) = 0.
(4) If ŒΩ ‚ààZ+, then we have the following identity, which was taken by Bessel as the
deÔ¨Ånition of JŒΩ for integer ŒΩ:
JŒΩ(t) = 1
2œÄ
 2œÄ
0
eit sinŒ∏e‚àíiŒΩŒ∏ dŒ∏ = 1
2œÄ
 2œÄ
0
cos(t sinŒ∏ ‚àíŒΩŒ∏)dŒ∏ .
(5) For ReŒΩ > ‚àí1/2 we have the following identity:
JŒΩ(t) =
1
Œì ( 1
2)
 t
2
ŒΩ
‚àû
‚àë
j=0
(‚àí1) j
Œì ( j + 1
2)
Œì ( j +ŒΩ +1)
t2 j
(2j)! ,
which can also be written as
JŒΩ(t) =
‚àû
‚àë
j=0
(‚àí1) j
j!
1
Œì ( j +ŒΩ +1)
 t
2
2 j+ŒΩ
,
using the equality (2j)! = 22 j j!( j ‚àí1
2)( j ‚àí3
2)¬∑¬∑¬∑ 1
2 = 22 j j!Œì ( j + 1
2)Œì ( 1
2)‚àí1.
(6) For ReŒΩ > 1/2 the identity below is valid:
d
dt (JŒΩ(t)) = 1
2

JŒΩ‚àí1(t)‚àíJŒΩ+1(t)

.
We Ô¨Årst verify property (1). We have
d
dt

t‚àíŒΩJŒΩ(t)

=
i
2ŒΩŒì (ŒΩ + 1
2)Œì ( 1
2)
 1
‚àí1 seits(1‚àís2)ŒΩ‚àí1
2 ds
=
i
2ŒΩŒì (ŒΩ + 1
2)Œì ( 1
2)
 1
‚àí1
it
2 eits (1‚àís2)ŒΩ+ 1
2
ŒΩ + 1
2
ds
= ‚àít‚àíŒΩJŒΩ+1(t),
where we integrated by parts and used the fact that Œì (x+1) = xŒì (x).
We now prove Property (2) for ReŒΩ > 1/2:
d
dt

tŒΩJŒΩ(t)

=
2ŒΩt2ŒΩ‚àí12‚àíŒΩ
Œì (ŒΩ + 1
2)Œì ( 1
2)
 1
‚àí1 eits(1‚àís2)ŒΩ‚àí1
2 ds+
t2ŒΩ2‚àíŒΩ
Œì (ŒΩ + 1
2)Œì ( 1
2)i
 1
‚àí1 eitsis(1‚àís2)ŒΩ‚àí1
2 ds

B.2 Some Basic Properties
575
=
2ŒΩt2ŒΩ‚àí12‚àíŒΩ
Œì (ŒΩ + 1
2)Œì ( 1
2)
 1
‚àí1 eits(1‚àís2)ŒΩ‚àí1
2 ds+
t2ŒΩ2‚àíŒΩ
Œì (ŒΩ + 1
2)Œì ( 1
2)
 1
‚àí1
eits
t
‚Ä≤
(1‚àís2)ŒΩ‚àí1
2 sds
=
2ŒΩt2ŒΩ‚àí12‚àíŒΩ
Œì (ŒΩ + 1
2)Œì ( 1
2)
 1
‚àí1 eits(1‚àís2)ŒΩ‚àí1
2 ds‚àí
t2ŒΩ2‚àíŒΩ
Œì (ŒΩ + 1
2)Œì ( 1
2)
 1
‚àí1
eits
t

(1‚àís2)ŒΩ‚àí1
2 s
‚Ä≤ds
=
t2ŒΩ‚àí12‚àíŒΩ
Œì (ŒΩ + 1
2)Œì ( 1
2)
 1
‚àí1 eits/
2ŒΩ(1‚àís2)ŒΩ‚àí1
2 ‚àí

(1‚àís2)ŒΩ‚àí1
2 s
‚Ä≤0
ds
=
t2ŒΩ‚àí12‚àíŒΩ
Œì (ŒΩ + 1
2)Œì ( 1
2)
 1
‚àí1 eits(2ŒΩ ‚àí1)(1‚àís2)ŒΩ‚àí3
2 ds
= t2ŒΩ‚àí12‚àí(ŒΩ‚àí1)
Œì (ŒΩ ‚àí1
2)Œì ( 1
2)
 1
‚àí1 eits(1‚àís2)ŒΩ‚àí1
2
ds
‚àö
1‚àís2
= tŒΩJŒΩ‚àí1(t).
We proceed with the proof of property (3). A calculation using the deÔ¨Ånition of
the Bessel function gives that the left-hand side of (3) is equal to
2‚àíŒΩtŒΩ+1
Œì (ŒΩ + 1
2)Œì ( 1
2)
 +1
‚àí1 eist

(1‚àís2)t +2is(ŒΩ + 1
2)

(1‚àís2)ŒΩ‚àí1
2 ds,
which in turn is equal to
‚àíi
2‚àíŒΩtŒΩ+1
Œì (ŒΩ + 1
2)Œì ( 1
2)
 +1
‚àí1
d
ds

eist(1‚àís2)ŒΩ+ 1
2 
ds = 0.
Property (4) can be derived directly from (1). DeÔ¨Åne
GŒΩ(t) = 1
2œÄ
 2œÄ
0
eit sinŒ∏e‚àíiŒΩŒ∏ dŒ∏,
for ŒΩ = 0,1,2,... and t > 0. We can show easily that G0 = J0. If we had
d
dt

t‚àíŒΩGŒΩ(t)

= ‚àít‚àíŒΩGŒΩ+1(t),
t > 0,
for ŒΩ ‚ààZ+, we would immediately conclude that GŒΩ = JŒΩ for ŒΩ ‚ààZ+. We have
d
dt

t‚àíŒΩGŒΩ(t)

= ‚àít‚àíŒΩ
ŒΩ
t GŒΩ(t)‚àídGŒΩ
dt (t)

= ‚àít‚àíŒΩ
 2œÄ
0
ŒΩ
2œÄt eit sinŒ∏e‚àíiŒΩŒ∏ ‚àí1
2œÄ
 d
dt eit sinŒ∏

e‚àíiŒΩŒ∏ dŒ∏
= ‚àít‚àíŒΩ
2œÄ
 2œÄ
0
i d
dŒ∏
eit sinŒ∏‚àíiŒΩŒ∏
t

+(cosŒ∏ ‚àíisinŒ∏)eit sinŒ∏e‚àíiŒΩŒ∏ dŒ∏
= ‚àít‚àíŒΩ
2œÄ
 2œÄ
0
eit sinŒ∏e‚àíi(ŒΩ+1)Œ∏ dŒ∏
= ‚àít‚àíŒΩGŒΩ+1(t).

576
B Bessel Functions
For t real, the identity in (5) can be derived by inserting the expression
‚àû
‚àë
j=0
(‚àí1) j (ts)2 j
(2j)! +isin(ts)
for eits in the deÔ¨Ånition of the Bessel function JŒΩ(t) in Appendix B.1. Algebraic
manipulations yield
JŒΩ(t) = (t/2)ŒΩ
Œì ( 1
2)
‚àû
‚àë
j=0
(‚àí1) j
1
Œì (ŒΩ + 1
2)
t2 j
(2j)!2
 1
0 s2 j‚àí1(1‚àís2)ŒΩ‚àí1
2 sds
= (t/2)ŒΩ
Œì ( 1
2)
‚àû
‚àë
j=0
(‚àí1) j
1
Œì (ŒΩ + 1
2)
t2 j
(2j)!
Œì ( j + 1
2)Œì (ŒΩ + 1
2)
Œì ( j +ŒΩ +1)
= (t/2)ŒΩ
Œì ( 1
2)
‚àû
‚àë
j=0
(‚àí1) j
Œì ( j + 1
2)
Œì ( j +ŒΩ +1)
t2 j
(2j)! .
To derive property (6) we Ô¨Årst multiply (1) by tŒΩ and (2) by t‚àíŒΩ; then we use the
product rule for differentiation and we add the resulting expressions.
For further identities on Bessel functions, one may consult Watson‚Äôs mono-
graph [371].
B.3 An Interesting Identity
Let ReŒº > ‚àí1
2, ReŒΩ > ‚àí1, and t > 0. Then the following identity is valid:
 1
0 JŒº(ts)sŒº+1(1‚àís2)ŒΩ ds = Œì (ŒΩ +1)2ŒΩ
tŒΩ+1
JŒº+ŒΩ+1(t).
To prove this identity we use formula (5) in Appendix B.2. We have
 1
0 JŒº(ts)sŒº+1(1‚àís2)ŒΩ ds
=
 t
2
Œº
Œì ( 1
2)
 1
0
‚àû
‚àë
j=0
(‚àí1) jŒì ( j + 1
2)t2 j
Œì ( j + Œº +1)(2j)!s2 j+Œº+Œº(1‚àís2)ŒΩsds
= 1
2
 t
2
Œº
Œì ( 1
2)
‚àû
‚àë
j=0
(‚àí1) jŒì ( j + 1
2)t2 j
Œì ( j + Œº +1)(2j)!
 1
0 uj+Œº(1‚àíu)ŒΩ du
= 1
2
 t
2
Œº
Œì ( 1
2)
‚àû
‚àë
j=0
(‚àí1) jŒì ( j + 1
2)t2 j
Œì ( j + Œº +1)(2j)!
Œì (Œº + j +1)Œì (ŒΩ +1)
Œì (Œº +ŒΩ + j +2)
= 2ŒΩŒì (ŒΩ +1)
tŒΩ+1
 t
2
Œº+ŒΩ+1
Œì ( 1
2)
‚àû
‚àë
j=0
(‚àí1) jŒì ( j + 1
2)t2 j
Œì ( j + Œº +ŒΩ +2)(2j)!
= Œì (ŒΩ +1)2ŒΩ
tŒΩ+1
JŒº+ŒΩ+1(t).

B.5 The Fourier Transform of a Radial Function on Rn
577
B.4 The Fourier Transform of Surface Measure on Sn‚àí1
Let dœÉ denote surface measure on Sn‚àí1 for n ‚â•2. Then the following is true:
2
dœÉ(Œæ) =

Sn‚àí1 e‚àí2œÄiŒæ¬∑Œ∏dŒ∏ =
2œÄ
|Œæ|
n‚àí2
2
J n‚àí2
2 (2œÄ|Œæ|).
To see this, use the result in Appendix D.3 to write
2
dœÉ(Œæ) =

Sn‚àí1 e‚àí2œÄiŒæ¬∑Œ∏ dŒ∏
= 2œÄ
n‚àí1
2
Œì ( n‚àí1
2 )
 +1
‚àí1 e‚àí2œÄi|Œæ|s(1‚àís2)
n‚àí2
2
ds
‚àö
1‚àís2
= 2œÄ
n‚àí1
2
Œì ( n‚àí1
2 )
Œì ( n‚àí2
2 + 1
2)Œì ( 1
2)
(œÄ|Œæ|)
n‚àí2
2
J n‚àí2
2 (2œÄ|Œæ|)
=
2œÄ
|Œæ|
n‚àí2
2
J n‚àí2
2 (2œÄ|Œæ|).
B.5 The Fourier Transform of a Radial Function on Rn
Let f(x) = f0(|x|) be a radial function deÔ¨Åned on Rn, where f0 is deÔ¨Åned on [0,‚àû).
Then the Fourier transform of f is given by the formula
1f(Œæ) =
2œÄ
|Œæ|
n‚àí2
2
 ‚àû
0
f0(r)J n
2 ‚àí1(2œÄr|Œæ|)r
n
2 dr.
To obtain this formula, use polar coordinates to write
1f(Œæ) =

Rn f(x)e‚àí2œÄiŒæ¬∑x dx
=
 ‚àû
0

Sn‚àí1 f0(r)e‚àí2œÄiŒæ¬∑rŒ∏dŒ∏ rn‚àí1dr
=
 ‚àû
0
f0(r) 2
dœÉ(rŒæ)rn‚àí1dr
=
 ‚àû
0
f0(r)
2œÄ
(r|Œæ|)
n‚àí2
2
J n‚àí2
2 (2œÄr|Œæ|)rn‚àí1dr
=
2œÄ
|Œæ|
n‚àí2
2
 ‚àû
0
f0(r)J n
2 ‚àí1(2œÄr|Œæ|)r
n
2 dr.

578
B Bessel Functions
As an application we take f(x) = œáB(0,1)(x), where B(0,1) is the unit ball in Rn.
We obtain
(œáB(0,1))1(Œæ) =
2œÄ
|Œæ|
n‚àí2
2
 1
0 J n
2 ‚àí1(2œÄ|Œæ|r)r
n
2 dr =
J n
2 (2œÄ|Œæ|)
|Œæ|
n
2
,
in view of the result in Appendix B.3. More generally, for ReŒª > ‚àí1, let
mŒª(Œæ) =

(1‚àí|Œæ|2)Œª
for |Œæ| ‚â§1,
0
for |Œæ| > 1.
Then
mŒª
‚à®(x) =
2œÄ
|x|
n‚àí2
2
 1
0 J n
2 ‚àí1(2œÄ|x|r)r
n
2 (1‚àír2)Œª dr = Œì (Œª +1)
œÄŒª
J n
2 +Œª(2œÄ|x|)
|x|
n
2 +Œª
,
using again the identity in Appendix B.3.
B.6 Bessel Functions of Small Arguments
We seek the behavior of Jk(r) as r ‚Üí0+. We Ô¨Åx ŒΩ ‚ààC with ReŒΩ > ‚àí1
2. Then we
have the identity
JŒΩ(r) =
rŒΩ
2ŒΩŒì (ŒΩ +1) +SŒΩ(r),
where
SŒΩ(r) =
(r/2)ŒΩ
Œì (ŒΩ + 1
2)Œì ( 1
2)
 +1
‚àí1 (eirt ‚àí1)(1‚àít2)ŒΩ‚àí1
2 dt
and SŒΩ satisÔ¨Åes
|SŒΩ(r)| ‚â§
2‚àíReŒΩrReŒΩ+1
(ReŒΩ +1)|Œì (ŒΩ + 1
2)|Œì ( 1
2) .
To prove this estimate we note that
JŒΩ(r) =
(r/2)ŒΩ
Œì (ŒΩ + 1
2)Œì ( 1
2)
 +1
‚àí1 (1‚àít2)ŒΩ‚àí1
2 dt +SŒΩ(r)
=
(r/2)ŒΩ
Œì (ŒΩ + 1
2)Œì ( 1
2)
 œÄ
0 (sin2 œÜ)ŒΩ‚àí1
2 (sinœÜ)dœÜ +SŒΩ(r)
=
(r/2)ŒΩ
Œì (ŒΩ + 1
2)Œì ( 1
2)
Œì (ŒΩ + 1
2)Œì ( 1
2)
Œì (ŒΩ +1)
+SŒΩ(r),
where we evaluated the last integral using the result in Appendix A.4. Using that
|eirt ‚àí1| ‚â§r|t|, we deduce the assertion regarding the size of |SŒΩ(r)|.

B.7 Bessel Functions of Large Arguments
579
It follows from these facts and the estimate in Appendix A.7 that for 0 < r ‚â§1
and ReŒΩ > ‚àí1/2 we have
|JŒΩ(r)| ‚â§C0(ReŒΩ)e
max

1
(ReŒΩ+ 1
2 )2 ,
1
ReŒΩ+ 1
2

|ImŒΩ|2
rReŒΩ ,
where C0 is a constant that depends smoothly on ReŒΩ ‚àà(‚àí1/2,‚àû).
B.7 Bessel Functions of Large Arguments
For r > 0 and complex numbers ŒΩ with ReŒΩ > ‚àí1/2 we prove the identity
JŒΩ(r) =
(r/2)ŒΩ
Œì (ŒΩ + 1
2)Œì ( 1
2)

ie‚àíir
 ‚àû
0 e‚àírt(t2+2it)ŒΩ‚àí1
2 dt ‚àíieir
 ‚àû
0 e‚àírt(t2‚àí2it)ŒΩ‚àí1
2 dt

.
Fix 0 < Œ¥ < 1/10 < 10 < R < ‚àû. We consider the region Œ©Œ¥,R in the complex
plane whose boundary is the set consisting of the interval [‚àí1 + Œ¥,1 ‚àíŒ¥] union a
quarter circle centered at 1 of radius Œ¥ from 1‚àíŒ¥ to 1+iŒ¥, union the line segments
from 1+iŒ¥ to 1+iR, from 1+iR to ‚àí1+iR, and from ‚àí1+iR to ‚àí1+iŒ¥, union
a quarter circle centered at ‚àí1 of radius Œ¥ from ‚àí1+iŒ¥ to ‚àí1+Œ¥. This is a simply
connected region on the interior of which the holomorphic function (1‚àíz2) has no
zeros. Since Œ©Œ¥,R is contained in the complement of the negative imaginary axis,
there is a holomorphic branch of the logarithm such that log(t) is real, log(‚àít) =
log|t| + iœÄ, and log(it) = log|t| + iœÄ/2 for t > 0. Since the function log(1 ‚àíz2) is
well deÔ¨Åned and holomorphic in Œ©Œ¥,R, we may deÔ¨Åne the holomorphic function
(1‚àíz2)ŒΩ‚àí1
2 = e(ŒΩ‚àí1
2 )log(1‚àíz2)
for z ‚ààŒ©Œ¥,R. Since eirz(1‚àíz2)ŒΩ‚àí1
2 has no poles in Œ©Œ¥,R, Cauchy‚Äôs theorem yields
i
 R
Œ¥ eir(1+it)(t2 ‚àí2it)ŒΩ‚àí1
2 dt +
 1‚àíŒ¥
‚àí1+Œ¥ eirt(1‚àít2)ŒΩ‚àí1
2 dt
+i
 Œ¥
R eir(‚àí1+it)(t2 +2it)ŒΩ‚àí1
2 dt +E(Œ¥,R) = 0,
where E(Œ¥,R) is the sum of the integrals over the two small quarter-circles of radius
Œ¥ and the line segment from 1 + iR to ‚àí1 + iR. The Ô¨Årst two of these integrals are
bounded by constants times Œ¥, the latter by a constant times R2ReŒΩ‚àí1e‚àírR; hence
E(Œ¥,R) ‚Üí0 as Œ¥ ‚Üí0 and R ‚Üí‚àû. We deduce the identity
 +1
‚àí1 eirt(1‚àít2)ŒΩ‚àí1
2 dt = ie‚àíir
 ‚àû
0 e‚àírt(t2+2it)ŒΩ‚àí1
2 dt ‚àíieir
 ‚àû
0 e‚àírt(t2‚àí2it)ŒΩ‚àí1
2 dt .

580
B Bessel Functions
Estimating the two integrals on the right by putting absolute values inside and mul-
tiplying by the missing factor rŒΩ2‚àíŒΩ(Œì (ŒΩ + 1
2)Œì ( 1
2))‚àí1, we obtain
|JŒΩ(r)| ‚â§2 (r/2)ReŒΩ e
œÄ
2 |ImŒΩ|
|Œì (ŒΩ + 1
2)|Œì ( 1
2)
 ‚àû
0 e‚àírttReŒΩ‚àí1
2 "
t2 +4
ReŒΩ‚àí1
2 dt ,
since the absolute value of the argument of t2¬±2it is at most œÄ/2. When ReŒΩ > 1/2,
we use the inequality (
‚àö
t2 +4)ReŒΩ‚àí1
2 ‚â§2ReŒΩ‚àí3
2 
tReŒΩ‚àí1
2 +2ReŒΩ‚àí1
2 
to get
|JŒΩ(r)| ‚â§2 (r/2)ReŒΩ e
œÄ
2 |ImŒΩ|
|Œì (ŒΩ + 1
2)|Œì ( 1
2) 2ReŒΩ‚àí3
2
Œì (2ReŒΩ)
r2ReŒΩ
+2ReŒΩ Œì (ReŒΩ + 1
2)
rReŒΩ+ 1
2

.
When 1/2 ‚â•ReŒΩ > ‚àí1/2 we use that
‚àö
t2 +4
ReŒΩ‚àí1
2 ‚â§1 to deduce that
|JŒΩ(r)| ‚â§2 (r/2)ReŒΩ e
œÄ
2 |ImŒΩ|
|Œì (ŒΩ + 1
2)|Œì ( 1
2)
Œì (ReŒΩ + 1
2)
rReŒΩ+ 1
2
.
These estimates yield that for ReŒΩ > ‚àí1/2 and r ‚â•1 we have
|JŒΩ(r)| ‚â§C1(ReŒΩ) e

max((ReŒΩ+ 1
2 )‚àí2,(ReŒΩ+ 1
2 )‚àí1)+ œÄ
2

|ImŒΩ|2 r‚àí1/2
using the result in Appendix A.7, where C1 is a constant that depends smoothly on
ReŒΩ on the interval (‚àí1/2,‚àû).
B.8 Asymptotics of Bessel Functions
We obtain asymptotics for JŒΩ(r) as r ‚Üí‚àûwhenever ReŒΩ > ‚àí1/2. We have the
following identity for r > 0:
JŒΩ(r) =
=
2
œÄr cos

r ‚àíœÄŒΩ
2 ‚àíœÄ
4

+RŒΩ(r),
where RŒΩ is given by
RŒΩ(r) = (2œÄ)‚àí1
2 rŒΩ
Œì (ŒΩ + 1
2) ei(r‚àíœÄŒΩ
2 ‚àíœÄ
4 )
 ‚àû
0 e‚àírttŒΩ+ 1
2 
(1+ it
2 )ŒΩ‚àí1
2 ‚àí1
dt
t
+(2œÄ)‚àí1
2 rŒΩ
Œì (ŒΩ + 1
2) e‚àíi(r‚àíœÄŒΩ
2 ‚àíœÄ
4 )
 ‚àû
0 e‚àírttŒΩ+ 1
2 
(1‚àíit
2 )ŒΩ‚àí1
2 ‚àí1
dt
t
and satisÔ¨Åes |RŒΩ(r)| ‚â§CŒΩ r‚àí3/2 whenever r ‚â•1.

B.8 Asymptotics of Bessel Functions
581
To see the validity of this identity we write
ie‚àíir(t2 +2it)ŒΩ‚àí1
2 = (2t)ŒΩ‚àí1
2 e‚àíi(r‚àíŒΩœÄ
2 ‚àíœÄ
4 )(1‚àíit
2 )ŒΩ‚àí1
2 ,
‚àíieir(t2 ‚àí2it)ŒΩ‚àí1
2 = (2t)ŒΩ‚àí1
2 ei(r‚àíŒΩœÄ
2 ‚àíœÄ
4 )(1+ it
2 )ŒΩ‚àí1
2 .
Inserting these expressions into the corresponding integrals in the formula proved in
Appendix B.7, adding and subtracting 1 from each term (1¬± it
2 )ŒΩ‚àí1
2 , and multiplying
by the missing factor (r/2)ŒΩ/Œì (ŒΩ + 1
2)Œì ( 1
2), we obtain the claimed identity
JŒΩ(r) =
=
2
œÄr cos

r ‚àíœÄŒΩ
2 ‚àíœÄ
4

+RŒΩ(r).
It remains to estimate RŒΩ(r). We begin by noting that for a,b real with a > ‚àí1
we have the pair of inequalities
|(1¬±iy)a+ib ‚àí1| ‚â§3(|a|+|b|)

2
a+1
2 e
œÄ
2 |b|
y
when 0 < y < 1,
|(1¬±iy)a+ib ‚àí1| ‚â§(1+y2)
a
2 e
œÄ
2 |b| +1 ‚â§2

2
a+1
2 e
œÄ
2 |b|
ya
when 1 ‚â§y < ‚àû.
The Ô¨Årst inequality is proved by splitting into real and imaginary parts and applying
the mean value theorem in the real part. Taking ŒΩ ‚àí1
2 = a+ib, y = t/2, and inserting
these estimates into the integrals appearing in RŒΩ, we obtain
|RŒΩ(r)| ‚â§2
1
2 ReŒΩ+ 5
4 e
œÄ
2 |ImŒΩ|rReŒΩ
(2œÄ)1/2|Œì (ŒΩ + 1
2)|
3
‚àö
2|ŒΩ|
2
 2
0 e‚àírttReŒΩ+ 3
2 dt
t + 2
‚àö
2
2ReŒΩ
 ‚àû
2 e‚àírtt2ReŒΩ dt
t

.
It follows that for all r > 0 we have
|RŒΩ(r)| ‚â§2 2
1
2 ReŒΩe
œÄ
2 |ImŒΩ|
|Œì (ŒΩ + 1
2)|

|ŒΩ| Œì (ReŒΩ + 3
2)
r3/2
+ r‚àíReŒΩ
2ReŒΩ
 ‚àû
2r e‚àítt2ReŒΩ dt
t

‚â§2 2
1
2 ReŒΩe
œÄ
2 |ImŒΩ|
|Œì (ŒΩ + 1
2)|

|ŒΩ| Œì (ReŒΩ + 3
2)
r3/2
+ 2ReŒΩ
rReŒΩ
Œì (2ReŒΩ)
er

,
using that e‚àít ‚â§e‚àít/2e‚àír for t ‚â•2r. We conclude that for r ‚â•1 and ReŒΩ > ‚àí1/2
we have
|RŒΩ(r)| ‚â§2
1
2 ReŒΩe
œÄ
2 |ImŒΩ|
Œì (ReŒΩ + 1
2) emax((ReŒΩ+ 1
2 )‚àí2,(ReŒΩ+ 1
2 )‚àí1)|ImŒΩ|2

|ŒΩ| Œì (ReŒΩ + 3
2)
r3/2
+ 2ReŒΩ
rReŒΩ
Œì (2ReŒΩ)
er

‚â§C2(ReŒΩ)e

max((ReŒΩ+ 1
2 )‚àí2,(ReŒΩ+ 1
2 )‚àí1)+ œÄ
2 +1

|ImŒΩ|2 r‚àí3/2 ,
via the result in Appendix A.7, where C2 is a constant that depends smoothly on
ReŒΩ on the interval (‚àí1/2,‚àû).

582
B Bessel Functions
B.9 Bessel Functions of general complex indices
We now discuss how to extend JŒΩ(t) to complex values of ŒΩ when t > 0. Identity (5)
JŒΩ(t) =
‚àû
‚àë
j=0
(‚àí1) j
j!
1
Œì ( j +ŒΩ +1)
 t
2
2 j+ŒΩ
of Appendix B.2 expresses JŒΩ(t) as a power series when ŒΩ is a complex number with
ReŒΩ > ‚àí1/2. But this power series converges absolutely for all complex values of
ŒΩ by the ratio test. Indeed, for j sufÔ¨Åciently large we have

(‚àí1) j+1
( j+1)!
1
Œì ( j+1+ŒΩ+1)
 t
2
2 j+2+ŒΩ
(‚àí1) j
j!
1
Œì ( j+ŒΩ+1)
 t
2
2 j+ŒΩ
 =

Œì ( j +ŒΩ +1)
 t
2
2
( j +1)Œì ( j +ŒΩ +2)
 =

 t
2
2
( j +1)( j +ŒΩ +1)

which tends to zero as j ‚Üí‚àû, thus the ratio test applies.
Therefore the power series deÔ¨Ånes an entire function of ŒΩ. Since this entire func-
tion coincides with JŒΩ on (‚àí1
2,‚àû)√óR, by analytic continuation, JŒΩ(t) has an entire
extension for all t > 0.
We obtain an integral representation of Jz(t) when ‚àí1/2 ‚â•Rez > ‚àí3/2. Fix
t > 0. Then we write
Jz(t) =
 t
2
z
Œì (z+ 1
2)Œì ( 1
2)
 1
‚àí1 eits(1‚àís2)z
ds
‚àö
1‚àís2
=
2
 t
2
z
Œì (z+ 1
2)Œì ( 1
2)
 1
0 cos(ts)(1‚àís2)z‚àí1
2 ds
=
 t
2
z
Œì (z+ 1
2)Œì ( 1
2)
 1
0
cos(t‚àö1‚àíu)
‚àö1‚àíu
uz‚àí1
2 du,
where the last step follows by the change of variables u = 1‚àís2. By the mean value
theorem, there is a constant c in (0,1) such that
 t
2
z
Œì (z+ 1
2)Œì ( 1
2)
 1
0
cos(t‚àö1‚àíu)
‚àö1‚àíu
uz‚àí1
2 du
=
 t
2
z
Œì (z+ 1
2)‚àöœÄ
 1
0
d
du
cos(t‚àö1‚àíu)
‚àö1‚àíu

(c) uz+ 1
2 du+
 t
2
z cos(t)
‚àöœÄ
 1
0 uz‚àí1
2 du
Œì (z+ 1
2)
=
 t
2
z
Œì (z+ 1
2)‚àöœÄ
 1
0
d
du
cos(t‚àö1‚àíu)
‚àö1‚àíu

(c) uz+ 1
2 du+
 t
2
z cos(t)
‚àöœÄ
1
Œì (z+ 3
2) ,

B.9 Bessel Functions of general complex indices
583
where the second identity is due to the fact that the integral
 1
0 uz‚àí1
2 du is equal to
(z+ 1
2)‚àí1 when Rez > ‚àí1/2 and thus when divided by Œì (z+ 1
2) can be analytically
extended to an entire function. It follows from these calculations that
J‚àí1
2 (t) =
=
2
œÄ
cos(t)
‚àöt
.
We now estimate Jz(t) when ‚àí3/2 < Rez ‚â§‚àí1/2. Given q ‚àà(0,1) we write
Jz(t) = J1
z (t;q)+J2
z (t;q)+J3
z (t;q),
where
J1
z (t;q) =
 t
2
z
Œì (z+ 1
2)Œì ( 1
2)
 q
0
d
du
cos(t‚àö1‚àíu)
‚àö1‚àíu

(c) uz+ 1
2 du
J2
z (t;q) =
 t
2
z cos(t)
‚àöœÄ
qz+ 1
2
Œì (z+ 3
2)
J3
z (t;q) =
 t
2
z
Œì (z+ 1
2)Œì ( 1
2)
 1
q
cos(t‚àö1‚àíu)
‚àö1‚àíu
uz‚àí1
2 du
for some c satisfying 0 < c < q.
Suppose that t > 2. Then we pick q = 1/t. We have
|J1
z (t;1/t)| ‚â§
 t
2
Rez
Œì (z+ 1
2)
‚àöœÄ
t
"
1‚àí1/t
3
1
Rez+ 3
2
1
t
Rez+ 3
2 ‚â§C1(Rez) t‚àí1
2
Œì (z+ 1
2)
 ,
for some constant C1 depending on Rez. The second term obviously satisÔ¨Åes
|J2
z (t;1/t)| ‚â§C2(Rez) t‚àí1
2
Œì (z+ 3
2)
 .
In J3
z (t;1/t) we write cos(t‚àö1‚àíu)
‚àö1‚àíu
= ‚àí2
t
d
du

sin(t‚àö1‚àíu)

and integrate by parts to
obtain the estimate
|J3
z (t;1/t)| ‚â§
 t
2
Rez
Œì (z+ 1
2)
‚àöœÄ
2
t +
2
t
1
2 +Rez

‚â§C3(Rez) t‚àí1
2
Œì (z+ 1
2)

when ‚àí1/2 ‚â•Rez > ‚àí3/2. Thus for these z‚Äôs and t > 2 we have
|Jz(t)| ‚â§C0(Rez) t‚àí1
2

1
|Œì (z+ 1
2)| +
1
|Œì (z+ 3
2)|

.

584
B Bessel Functions
When 0 < t ‚â§2 we choose q = 1/2. Then each of |Jk
z (t;1/2)|, k = 1,2,3 is
bounded by a multiple of tRez and we obtain the estimate
|Jz(t)| ‚â§C00(Rez) tRez

1
|Œì (z+ 1
2)| +
1
|Œì (z+ 3
2)|

.
when ‚àí1/2 ‚â•Rez > ‚àí3/2 and 0 < t ‚â§2.
In the special case Rez = ‚àí1/2 or z = ‚àí1/2+iŒ∏, Œ∏ ‚ààR, we deduce
|J‚àí1
2 +iŒ∏(t)| ‚â§Ct‚àí1
2

1
|Œì (1+iŒ∏)| +
1
|Œì (iŒ∏)|

‚â§Ct‚àí1
2 (1+|Œ∏|)e|Œ∏|2
for some constant C independent of all parameters; see Appendix A.7 for the last
inequality.

Appendix C
Rademacher Functions
C.1 DeÔ¨Ånition of the Rademacher Functions
The Rademacher functions are deÔ¨Åned on [0,1] as follows: r0(t) = 1; r1(t) = 1 for
0 ‚â§t ‚â§1/2 and r1(t) = ‚àí1 for 1/2 < t ‚â§1; r2(t) = 1 for 0 ‚â§t ‚â§1/4, r2(t) = ‚àí1
for 1/4 < t ‚â§1/2, r2(t) = 1 for 1/2 < t ‚â§3/4, and r2(t) = ‚àí1 for 3/4 < t ‚â§1;
and so on. According to this deÔ¨Ånition, we have that r j(t) = sgn(sin(2jœÄt)) for j =
0,1,2,.... It is easy to check that the rj‚Äôs are mutually independent random variables
on [0,1]. This means that for all functions f j we have
 1
0
n
‚àè
j=0
f j(r j(t))dt =
n
‚àè
j=0
 1
0 f j(r j(t))dt .
To see the validity of this identity, we write its right-hand side as
f0(1)
n
‚àè
j=1
 1
0 f j(r j(t))dt = f0(1)
n
‚àè
j=1
f j(1)+ f j(‚àí1)
2
= f0(1)
2n
‚àë
S‚äÇ{1,2,...,n}‚àè
j‚ààS
f j(1)‚àè
j/‚ààS
f j(‚àí1)
and we observe that there is a one-to-one and onto correspondence between sub-
sets S of {1,2,...,n} and intervals Ik =
 k
2n , k+1
2n

, k = 0,1,...,2n ‚àí1, such that the
restriction of the function ‚àèn
j=1 f j(r j(t)) on Ik is equal to
‚àè
j‚ààS
f j(1)‚àè
j/‚ààS
f j(‚àí1).
It follows that the last of the three equal displayed expressions is
f0(1)
2n‚àí1
‚àë
k=0

Ik
n
‚àè
j=1
f j(r j(t))dt =
 1
0
n
‚àè
j=0
f j(r j(t))dt .
L. Grafakos, Classical Fourier Analysis, Graduate Texts in Mathematics 249,
DOI 10.1007/978-1-4939-1194-3, ¬© Springer Science+Business Media New York 2014
585

586
C Rademacher Functions
C.2 Khintchine‚Äôs Inequalities
The following property of the Rademacher functions is of fundamental importance
and with far-reaching consequences in analysis:
For any 0 < p < ‚àûand for any real-valued square summable sequences {aj} and
{bj} we have
Bp

‚àë
j
|aj +ibj|2
1
2
‚â§
‚àë
j
(aj +ibj)r j

Lp([0,1]) ‚â§Ap

‚àë
j
|aj +ibj|2
1
2
for some constants 0 < Ap,Bp < ‚àûthat depend only on p.
These inequalities reÔ¨Çect the orthogonality of the Rademacher functions in Lp
(especially when p Ã∏= 2). Khintchine [193] was the Ô¨Årst to prove a special form of
this inequality, and he used it to estimate the asymptotic behavior of certain random
walks. Later this inequality was systematically studied almost simultaneously by Lit-
tlewood [226] and by Paley and Zygmund [274], who proved the more general form
stated previously. The foregoing inequalities are usually referred to by Khintchine‚Äôs
name.
C.3 Derivation of Khintchine‚Äôs Inequalities
Both assertions in Appendix C.2 can be derived from an exponentially decaying
distributional inequality for the function
F(t) = ‚àë
j
(aj +ibj)r j(t),
t ‚àà[0,1],
when aj, bj are square summable real numbers.
We Ô¨Årst obtain a distributional inequality for the above function F under the
following three assumptions:
(a)The sequence {bj} is identically zero.
(b)All but Ô¨Ånitely many terms of the sequence {aj} are zero.
(c)The sequence {aj} satisÔ¨Åes (‚àëj |aj|2)1/2 = 1.
Let œÅ > 0. Under assumptions (a), (b), and (c), independence gives
 1
0 eœÅ ‚àëa jr j(t) dt = ‚àè
j
 1
0 eœÅa jr j(t) dt
= ‚àè
j
eœÅa j +e‚àíœÅa j
2
‚â§‚àè
j
e
1
2 œÅ2a2
j = e
1
2 œÅ2 ‚àëa2
j = e
1
2 œÅ2 ,

C.3 Derivation of Khintchine‚Äôs Inequalities
587
where we used the inequality 1
2(ex +e‚àíx) ‚â§e
1
2 x2 for all real x, which can be checked
using power series expansions. Since the same argument is also valid for ‚àí‚àëajr j(t),
we obtain that
 1
0 eœÅ|F(t)| dt ‚â§2e
1
2 œÅ2 .
From this it follows that
eœÅŒ±|{t ‚àà[0,1] : |F(t)| > Œ±}| ‚â§
 1
0 eœÅ|F(t)| dt ‚â§2e
1
2 œÅ2
and hence we obtain the distributional inequality
dF(Œ±) = |{t ‚àà[0,1] : |F(t)| > Œ±}| ‚â§2e
1
2 œÅ2‚àíœÅŒ± = 2e‚àí1
2 Œ±2 ,
by picking œÅ = Œ±. The Lp norm of F can now be computed easily. Formula (1.1.6)
gives
F
p
Lp =
 ‚àû
0 pŒ± p‚àí1dF(Œ±)dŒ± ‚â§
 ‚àû
0 pŒ± p‚àí12e‚àíŒ±2
2 dŒ± = 2
p
2 pŒì (p/2).
We have now proved that
F

Lp ‚â§
‚àö
2

pŒì (p/2)
 1
p F

L2
under assumptions (a), (b), and (c).
We now dispose of assumptions (a), (b), and (c). Assumption (b) can be easily
eliminated by a limiting argument and (c) by a scaling argument. To dispose of
assumption (a), let aj and bj be real numbers. We have
‚àë
j
(aj +ibj)r j

Lp ‚â§

‚àë
j
ajr j
+
‚àë
j
bjr j


Lp
‚â§
‚àë
j
ajr j

Lp +
‚àë
j
bjr j

Lp
‚â§
‚àö
2

pŒì (p/2)
 1
p

‚àë
j
|aj|21
2 +

‚àë
j
|bj|21
2

‚â§
‚àö
2

pŒì (p/2)
 1
p ‚àö
2

‚àë
j
|aj +ibj|21
2 .
Let us now set Ap = 2

pŒì (p/2)
1/p when p > 2. Since we have the trivial esti-
mate
F

Lp ‚â§
F

L2 when 0 < p ‚â§2, we obtain the required inequality
F

Lp ‚â§
Ap
F

L2 with
Ap =

1
when 0 < p ‚â§2,
2 p
1
p Œì (p/2)
1
p
when 2 < p < ‚àû.

588
C Rademacher Functions
Using Sterling‚Äôs formula in Appendix A.6, we see that Ap is asymptotic to ‚àöp as
p ‚Üí‚àû.
We now discuss the converse inequality Bp
F

L2 ‚â§
F

Lp. It is clear that
F

L2 ‚â§
F

Lp when p ‚â•2 and we may therefore take Bp = 1 for p ‚â•2. Let us
now consider the case 0 < p < 2. Pick an s such that 2 < s < ‚àû. Find a 0 < Œ∏ < 1
such that
1
2 = 1‚àíŒ∏
p
+ Œ∏
s .
Then
F

L2 ‚â§
F
1‚àíŒ∏
Lp
F
Œ∏
Ls ‚â§
F
1‚àíŒ∏
Lp AŒ∏
s
F
Œ∏
L2 .
It follows that
F

L2 ‚â§A
Œ∏
1‚àíŒ∏
s
F

Lp .
We have now proved the inequality Bp
F

L2 ‚â§
F

Lp with
Bp =
‚éß
‚é™
‚é™
‚é®
‚é™
‚é™
‚é©
1
when 2 ‚â§p < ‚àû,
sup
s>2
A
‚àí
1p ‚àí1
2
1
2 ‚àí1s
s
when 0 < p < 2.
Observe that the function s ‚ÜíA
‚àí

1
p ‚àí1
2

/

1
2 ‚àí1
s

s
tends to zero as s ‚Üí2+ and as
s ‚Üí‚àû. Hence it must attain its maximum for some s = s(p) in the interval (2,‚àû).
We see that Bp ‚â•16¬∑256‚àí1/p when p < 2 by taking s = 4.
It is worthwhile to mention that the best possible values of the constants Ap and
Bp in Khintchine‚Äôs inequality are known when bj = 0. In this case Szarek [353]
showed that the best possible value of B1 is 1/
‚àö
2, and later Haagerup [141] found
that when bj = 0 the best possible values of Ap and Bp are the numbers
Ap =

1
when 0 < p ‚â§2,
2
1
2 œÄ‚àí1
2p Œì ( p+1
2 )
when 2 < p < ‚àû,
and
Bp =
‚éß
‚é™
‚é™
‚é®
‚é™
‚é™
‚é©
2
1
2 ‚àí1
p
when 0 < p ‚â§p0,
2
1
2 œÄ‚àí1
2p Œì ( p+1
2 )
when p0 < p < 2,
1
when 2 < p < ‚àû,
where p0 = 1.84742... is the unique solution of the equation 2Œì ( p+1
2 ) = ‚àöœÄ in the
interval (1,2).

C.5 Extension to Several Variables
589
C.4 Khintchine‚Äôs Inequalities for Weak Type Spaces
We note that the following weak type estimates are valid:
4‚àí1
p B p
2

‚àë
j
|aj +ibj|2
1
2
‚â§
‚àë
j
(aj +ibj)r j

Lp,‚àû‚â§Ap

‚àë
j
|aj +ibj|2
1
2
for all 0 < p < ‚àû.
Indeed, the upper estimate is a simple consequence of the fact that Lp is a sub-
space of Lp,‚àû. For the converse inequality we use the fact that Lp,‚àû([0,1]) is con-
tained in Lp/2([0,1]) and we have (see Exercise 1.1.11)
F

Lp/2 ‚â§4
1
p F

Lp,‚àû.
Since any Lorentz space Lp,q([0,1]) can be sandwiched between L2p([0,1]) and
Lp/2([0,1]), similar inequalities hold for all Lorentz spaces Lp,q([0,1]), 0 < p < ‚àû,
0 < q ‚â§‚àû.
C.5 Extension to Several Variables
We Ô¨Årst extend the inequality on the right in Appendix C.2 to several variables. For
a positive integer n we let
Fn(t1,...,tn) = ‚àë
j1
¬∑¬∑¬∑‚àë
jn
cj1,..., jnr j1(t1)¬∑¬∑¬∑r jn(tn),
for t j ‚àà[0,1], where cj1,..., jn is a sequence of complex numbers and Fn is a function
deÔ¨Åned on [0,1]n.
For any 0 < p < ‚àûand for any complex-valued square summable sequence of n
variables {cj1,..., jn}j1,..., jn, we have the following inequalities for Fn:
Bn
p

‚àë
j1
¬∑¬∑¬∑‚àë
jn
|cj1,..., jn|2
1
2
‚â§
Fn

Lp([0,1]n) ‚â§An
p

‚àë
j1
¬∑¬∑¬∑‚àë
jn
|cj1,..., jn|2
1
2
,
where Ap,Bp are the constants in Appendix C.2. The norms are over [0,1]n.
The case n = 2 is indicative of the general case. For p ‚â•2 we have
 1
0
 1
0 |F2(t1,t2)|p dt1 dt2 ‚â§Ap
p
 1
0

‚àë
j1
‚àë
j2
cj1, j2r j2(t2)
2
p
2
dt2
‚â§Ap
p

‚àë
j1
 1
0
‚àë
j2
cj1, j2r j2(t2)
p dt2
2
p p
2
‚â§A2p
p

‚àë
j1 ‚àë
j2
|cj1, jn|2
p
2
,

590
C Rademacher Functions
where we used Minkowski‚Äôs integral inequality (with exponent p/2 ‚â•1) in the sec-
ond inequality and the result in the case n = 1 twice.
The case p < 2 follows trivially from H¬®older‚Äôs inequality with constant Ap = 1.
The reverse inequalities follow exactly as in the case of one variable. Replacing Ap
by An
p in the argument, giving the reverse inequality in the case n = 1, we obtain the
constant Bn
p.
Likewise one may extend the weak type inequalities of Appendix C.3 in several
variables.

Appendix D
Spherical Coordinates
D.1 Spherical Coordinate Formula
Switching integration from spherical coordinates to Cartesian is achieved via the
following identity:

RSn‚àí1
f(x)dœÉ(x) =
 œÄ
œï1=0¬∑¬∑¬∑
 œÄ
œïn‚àí2=0
 2œÄ
œïn‚àí1=0f(x(œï))J(n,R,œï)dœïn‚àí1 ¬∑¬∑¬∑dœï1,
where
x1 = Rcosœï1 ,
x2 = Rsinœï1 cosœï2 ,
x3 = Rsinœï1 sinœï2 cosœï3 ,
...
xn‚àí1 = Rsinœï1 sinœï2 sinœï3 ¬∑¬∑¬∑sinœïn‚àí2 cosœïn‚àí1 ,
xn = Rsinœï1 sinœï2 sinœï3 ¬∑¬∑¬∑sinœïn‚àí2 sinœïn‚àí1 ,
and 0 ‚â§œï1,...,œïn‚àí2 ‚â§œÄ, 0 ‚â§œïn‚àí1 = Œ∏ < 2œÄ,
x(œï) = (x1(œï1,...,œïn‚àí1),...,xn(œï1,...,œïn‚àí1)),
and
J(n,R,œï) =
 n
‚àë
k=1
det
 ‚àÇxi
‚àÇœïj

1‚â§iÃ∏=k‚â§n
1‚â§j‚â§n‚àí1

2 1
2
= Rn‚àí1(sinœï1)n‚àí2 ¬∑¬∑¬∑(sinœïn‚àí3)2(sinœïn‚àí2)
is the Jacobian of the transformation.
L. Grafakos, Classical Fourier Analysis, Graduate Texts in Mathematics 249,
DOI 10.1007/978-1-4939-1194-3, ¬© Springer Science+Business Media New York 2014
591

592
D Spherical Coordinates
D.2 A Useful Change of Variables Formula
The following formula is useful in computing integrals over the sphere Sn‚àí1 when
n ‚â•2. Let f be a function deÔ¨Åned on Sn‚àí1. Then we have

RSn‚àí1 f(x)dœÉ(x) =
 +R
‚àíR

‚àö
R2‚àís2 Sn‚àí2
f

s,Œ∏

dŒ∏
Rds
‚àö
R2 ‚àís2 .
To prove this formula, let œï‚Ä≤ = (œï2,...,œïn‚àí1) and
x‚Ä≤ = x‚Ä≤(œï‚Ä≤) = (cosœï2,sinœï2 cosœï3,...,sinœï2 ¬∑¬∑¬∑sinœïn‚àí2 sinœïn‚àí1).
Using the change of variables in Appendix D.1 we express

RSn‚àí1 f(x)dœÉ(x)
as the iterated integral
 œÄ
œï1=0
 œÄ
œï2=0¬∑¬∑¬∑
 2œÄ
œïn‚àí1=0 f(Rcosœï1,Rsinœï1 x‚Ä≤(œï‚Ä≤))J(n‚àí1,1,œï‚Ä≤)dœï‚Ä≤

Rdœï1
(Rsinœï1)2‚àín ,
and we can realize the expression inside the square brackets as

Sn‚àí2 f(Rcosœï1,Rsinœï1 x‚Ä≤)dœÉ(x‚Ä≤).
Consequently,

RSn‚àí1 f(x)dœÉ(x) =
 œÄ
œï1=0

Sn‚àí2 f(Rcosœï1,Rsinœï1 x‚Ä≤)dœÉ(x‚Ä≤)Rn‚àí1(sinœï1)n‚àí2dœï1 ,
and the change of variables
s = Rcosœï1 ,
œï1 ‚àà(0,œÄ),
ds = ‚àíRsinœï1 dœï1 ,
"
R2 ‚àís2 = Rsinœï1 ,
yields

RSn‚àí1 f(x)dœÉ(x) =
 R
‚àíR
$
Sn‚àí2 f(s,
"
R2 ‚àís2 Œ∏)dŒ∏
%"
R2 ‚àís2 n‚àí2
Rds
‚àö
R2 ‚àís2 .
Rescaling the sphere Sn‚àí2 to
‚àö
R2 ‚àís2 Sn‚àí2 yields the claimed identity.

D.4 The Computation of Another Integral over the Sphere
593
D.3 Computation of an Integral over the Sphere
Let K be a function on the line. We use the result in Appendix D.2 to show that for
n ‚â•2 we have

Sn‚àí1 K(x¬∑Œ∏)dŒ∏ = 2œÄ
n‚àí1
2
Œì
 n‚àí1
2

 +1
‚àí1 K(s|x|)
"
1‚àís2 n‚àí3 ds
when x ‚ààRn \ {0}. Let x‚Ä≤ = x/|x| and pick a matrix A ‚ààO(n) such that Ae1 = x‚Ä≤,
where e1 = (1,0,...,0). We have

Sn‚àí1 K(x¬∑Œ∏)dŒ∏ =

Sn‚àí1 K(|x|(x‚Ä≤ ¬∑Œ∏))dŒ∏
=

Sn‚àí1 K(|x|(Ae1 ¬∑Œ∏))dŒ∏
=

Sn‚àí1 K(|x|(e1 ¬∑A‚àí1Œ∏))dŒ∏
=

Sn‚àí1 K(|x|Œ∏1)dŒ∏
=
 +1
‚àí1 K(|x|s)œân‚àí2
"
1‚àís2 n‚àí2
ds
‚àö
1‚àís2
= œân‚àí2
 +1
‚àí1 K(s|x|)
"
1‚àís2 n‚àí3 ds,
where œân‚àí2 = 2œÄ
n‚àí1
2 Œì
 n‚àí1
2
‚àí1 is the surface area of Sn‚àí2.
For example, we have

Sn‚àí1
dŒ∏
|Œæ ¬∑Œ∏|Œ± = œân‚àí2
 +1
‚àí1
1
|s|Œ±|Œæ|Œ± (1‚àís2)
n‚àí3
2 ds =
1
|Œæ|Œ±
2œÄ
n‚àí1
2 Œì
 1‚àíŒ±
2

Œì
 n‚àíŒ±
2

,
and the integral converges only when ReŒ± < 1.
D.4 The Computation of Another Integral over the Sphere
We compute the following integral for n ‚â•2:

Sn‚àí1
dŒ∏
|Œ∏ ‚àíe1|Œ± ,

594
D Spherical Coordinates
where e1 = (1,0,...,0). Applying the formula in Appendix D.2, we obtain

Sn‚àí1
dŒ∏
|Œ∏ ‚àíe1|Œ± =
 +1
‚àí1

Œ∏‚àà‚àö
1‚àís2 Sn‚àí2
dŒ∏
(|s‚àí1|2 +|Œ∏|2)
Œ±
2
ds
‚àö
1‚àís2
=
 +1
‚àí1 œân‚àí2
(1‚àís2)
n‚àí2
2

(1‚àís)2 +1‚àís2 Œ±
2
ds
‚àö
1‚àís2
= œân‚àí2
2
Œ±
2
 +1
‚àí1
(1‚àís2)
n‚àí3
2
(1‚àís)
Œ±
2
ds
= œân‚àí2
2
Œ±
2
 +1
‚àí1 (1‚àís)
n‚àí3‚àíŒ±
2
(1+s)
n‚àí3
2 ds,
which converges exactly when ReŒ± < n‚àí1.
D.5 Integration over a General Surface
Suppose that S is a hypersurface in Rn of the form S = {(u,Œ¶(u)) : u ‚ààD}, where
D is an open subset of Rn‚àí1 and Œ¶ is a continuously differentiable mapping from D
to R. Let œÉ be the canonical surface measure on S. If g is a function on S, then we
have

S g(y)dœÉ(y) =

D g(x,Œ¶(x))

1+
n‚àí1
‚àë
j=1
|‚àÇjŒ¶(x)|21
2 dx.
Specializing to the sphere, we obtain

Sn‚àí1 g(Œ∏)dŒ∏ =

Œæ ‚Ä≤‚ààRn‚àí1
|Œæ ‚Ä≤|<1
/
g(Œæ ‚Ä≤,
!
1‚àí|Œæ ‚Ä≤|2)+g(Œæ ‚Ä≤,‚àí
!
1‚àí|Œæ ‚Ä≤|2)
0
dŒæ ‚Ä≤
"
1‚àí|Œæ ‚Ä≤|2 .
D.6 The Stereographic Projection
DeÔ¨Åne a map Œ† : Rn ‚ÜíSn by the formula
Œ†(x1,...,xn) =

2x1
1+|x|2 ,...,
2xn
1+|x|2 , |x|2 ‚àí1
1+|x|2

.
It is easy to see that Œ† is a one-to-one map from Rn onto the sphere Sn minus the
north pole en+1 = (0,...,0,1). Its inverse is given by the formula
Œ† ‚àí1(Œ∏1,...,Œ∏n+1) =

Œ∏1
1‚àíŒ∏n+1
,...,
Œ∏n
1‚àíŒ∏n+1

.

D.6 The Stereographic Projection
595
The Jacobian of the map is veriÔ¨Åed to be JŒ†(x) =

2
1+|x|2
‚àín , and the following
change of variables formulas are valid:

Sn F(Œ∏)dŒ∏ =

Rn F(Œ†(x))JŒ†(x)dx
and

Rn F(x)dx =

Sn F(Œ† ‚àí1(Œ∏))JŒ†‚àí1(Œ∏)dŒ∏ ,
where
JŒ†‚àí1(Œ∏) =
1
JŒ†(Œ† ‚àí1(Œ∏)) =
'
|Œ∏1|2 +¬∑¬∑¬∑+|Œ∏n|2 +|1‚àíŒ∏n+1|2
2|1‚àíŒ∏n+1|2
(n
.
Another interesting formula about the stereographic projection Œ† is
|Œ†(x)‚àíŒ†(y)| = 2|x‚àíy|(1+|x|2)‚àí1/2(1+|y|2)‚àí1/2 ,
x,y ‚ààRn .

Appendix E
Some Trigonometric Identities and Inequalities
The following inequalities are valid for t real:
0 < t < œÄ
2 =‚áísin(t) < t < tan(t),
0 < |t| < œÄ
2 =‚áí2
œÄ < sin(t)
t
< 1,
‚àí‚àû< t < +‚àû=‚áí|sin(t)| ‚â§|t|,
‚àí‚àû< t < +‚àû=‚áí|1‚àícos(t)| ‚â§|t|2
2 ,
‚àí‚àû< t < +‚àû=‚áí|1‚àíeit| ‚â§|t|,
|t| ‚â§œÄ
2 =‚áí|sin(t)| ‚â•2|t|
œÄ ,
|t| ‚â§œÄ =‚áí|1‚àícos(t)| ‚â•2|t|2
œÄ2 ,
|t| ‚â§œÄ =‚áí|1‚àíeit| ‚â•2|t|
œÄ .
The following sum to product formulas are valid:
sin(a)+sin(b) = 2 sin
a+b
2

cos
a‚àíb
2

,
sin(a)‚àísin(b) = 2 cos
a+b
2

sin
a‚àíb
2

,
cos(a)+cos(b) = 2 cos
a+b
2

cos
a‚àíb
2

,
cos(a)‚àícos(b) = ‚àí2 sin
a+b
2

sin
a‚àíb
2

.
L. Grafakos, Classical Fourier Analysis, Graduate Texts in Mathematics 249,
DOI 10.1007/978-1-4939-1194-3, ¬© Springer Science+Business Media New York 2014
597

598
E Some Trigonometric Identities and Inequalities
The following identities are also easily proved:
N
‚àë
k=1
cos(kx) = ‚àí1
2 + sin((N + 1
2)x)
2sin( x
2)
,
N
‚àë
k=1
sin(kx) = cos( x
2)‚àícos((N + 1
2)x)
2sin( x
2)
.

Appendix F
Summation by Parts
Let {ak}‚àû
k=0, {bk}‚àû
k=0 be two sequences of complex numbers. Then for N ‚â•1 we
have
N
‚àë
k=0
akbk = ANbN ‚àí
N‚àí1
‚àë
k=0
Ak(bk+1 ‚àíbk),
where
Ak =
k
‚àë
j=0
aj .
More generally we have
N
‚àë
k=M
akbk = ANbN ‚àíAM‚àí1bM ‚àí
N‚àí1
‚àë
k=M
Ak(bk+1 ‚àíbk),
whenever 0 ‚â§M ‚â§N, where A‚àí1 = 0 and
Ak =
k
‚àë
j=0
aj
for k ‚â•0.
L. Grafakos, Classical Fourier Analysis, Graduate Texts in Mathematics 249,
DOI 10.1007/978-1-4939-1194-3, ¬© Springer Science+Business Media New York 2014
599

Appendix G
Basic Functional Analysis
A quasi-norm is a nonnegative functional ‚à•¬∑ ‚à•on a vector space X that satisÔ¨Åes
‚à•x + y‚à•X ‚â§K(‚à•x‚à•X + ‚à•y‚à•X) for some K ‚â•0 and all x,y ‚ààX and also ‚à•Œªx‚à•X =
|Œª|‚à•x‚à•X for all scalars Œª. When K = 1, the quasi-norm is called a norm. A quasi-
Banach space is a quasi-normed space that is complete with respect to the topology
generated by the quasi-norm. The proofs of the following theorems can be found in
several books including Albiac and Kalton [1], Kalton Peck and Roberts [188], and
Rudin [306].
The Hahn‚ÄìBanach theorem. Let X be a normed vector space (over the real or
complex numbers), let Y be a subspace of X, and let P be a positively homogeneous
subadditive1 functional on X. Then for every linear functional Œõ on Y that satisÔ¨Åes
|Œõ(y)| ‚â§P(y)
for all y ‚ààY, there is a linear functional Œõ ‚Ä≤ on X such that
Œõ ‚Ä≤(y) = Œõ(y)
for all y ‚ààY,
|Œõ ‚Ä≤(x)| ‚â§P(x)
for all x ‚ààX.
In particular, every bounded linear functional on a subspace has an extension on
the entire space with the same norm.
Banach‚ÄìAlaoglou theorem. Let X be a normed vector space and let X‚àóbe the
space of all bounded linear functionals on X. Then the closed unit ball of X‚àóis
compact in the weak‚àótopology.
A special case is the sequential version of this theorem, which asserts that the
closed unit ball of the dual space of a separable normed vector space is sequentially
compact in the weak‚àótopology. Indeed, the weak‚àótopology on the closed unit ball
1 this means that P(x) ‚â•0 for all x ‚ààX, P(Œªx) = ŒªP(x) for all Œª > 0 and all x ‚ààX, and that
P(x+z) ‚â§P(x)+P(z) for all x,z ‚ààX.
L. Grafakos, Classical Fourier Analysis, Graduate Texts in Mathematics 249,
DOI 10.1007/978-1-4939-1194-3, ¬© Springer Science+Business Media New York 2014
601

602
G Basic Functional Analysis
of the dual of a separable space is metrizable, and thus compactness and sequential
compactness are equivalent.
Open mapping theorem. Suppose that X and Y are quasi-Banach spaces and
T is a bounded surjective linear map from X onto Y. Then T maps open sets to
open sets, i.e., it is an open mapping. Moreover, if T is injective, then there exists a
constant K < ‚àûsuch that for all x ‚ààX we have
‚à•x‚à•X ‚â§K‚à•T(x)‚à•Y .
Closed graph theorem. Suppose that X and Y are quasi-Banach spaces and T is
a linear map from X to Y whose graph is a closed set, i.e., whenever xk,x ‚ààX and
(xk,T(xk)) ‚Üí(x,y) in X √óY for some y ‚ààY, then T(x) = y. Then T is a bounded
linear map from X to Y.
Uniform boundedness principle. Suppose that X is a quasi-Banach space, Y is
a quasi-normed space and (TŒ±)Œ±‚ààI is a family of bounded linear maps from X to Y
such that for all x ‚ààX there exists a Cx < ‚àûsuch that
sup
Œ±‚ààI
‚à•TŒ±(x)‚à•Y ‚â§Cx .
Then there exists a constant K < ‚àûsuch that
sup
Œ±‚ààI
‚à•TŒ±‚à•X‚ÜíY ‚â§K .

Appendix H
The Minimax Lemma
Minimax type results are used in the theory of games and have their origin in the
work of Von Neumann [369]. Much of the theory in this subject is based on convex
analysis techniques. For instance, this is the case with the next proposition, which
is needed in the ‚ÄúdifÔ¨Åcult‚Äù inequality in the proof of the minimax lemma. We refer
to Fan [111] for a general account of minimax results. The following exposition is
based on the simple presentation in Appendix A2 of [122].
Minimax Lemma. Let A, B be convex subsets of certain vector spaces. Assume that
a topology is deÔ¨Åned in B for which it is a compact Hausdorff space and assume that
there is a function Œ¶ : A√óB ‚ÜíR{+‚àû} that satisÔ¨Åes the following:
(a) Œ¶(.,b) is a concave function on A for each b ‚ààB,
(b) Œ¶(a, .) is a convex function on B for each a ‚ààA,
(c) Œ¶(a, .) is lower semicontinuous on B for each a ‚ààA.
Then the following identity holds:
min
b‚ààB sup
a‚ààA
Œ¶(a,b) = sup
a‚ààA
min
b‚ààB Œ¶(a,b).
To prove the lemma we need the following proposition:
Proposition. Let B be a convex compact subset of a vector space and suppose that
gj : B ‚ÜíR{+‚àû}, j = 1,2,...,n, are convex and lower semicontinuous functions.
If
max
1‚â§j‚â§ngj(b) > 0
for all
b ‚ààB,
then there exist nonnegative numbers Œª1,Œª2,...,Œªn such that
Œª1g1(b)+Œª2g2(b)+¬∑¬∑¬∑+Œªngn(b) > 0
for all
b ‚ààB.
Proof. We Ô¨Årst consider the case n = 2. DeÔ¨Åne subsets of B
B1 = {b ‚ààB : g1(b) ‚â§0},
B2 = {b ‚ààB : g2(b) ‚â§0}.
L. Grafakos, Classical Fourier Analysis, Graduate Texts in Mathematics 249,
DOI 10.1007/978-1-4939-1194-3, ¬© Springer Science+Business Media New York 2014
603

604
H The Minimax Lemma
If B1 = /0, we take Œª1 = 1 and Œª2 = 0, and we similarly deal with the case B2 = /0. If
B1 and B2 are nonempty, then they are closed and thus compact. The hypothesis of
the proposition implies that g2(b) > 0 ‚â•g1(b) for all b ‚ààB1. Therefore, the function
‚àíg1(b)/g2(b) is well deÔ¨Åned and upper semicontinuous on B1 and thus attains its
maximum. The same is true for ‚àíg2(b)/g1(b) deÔ¨Åned on B2. We set
Œº1 = max
b‚ààB1
‚àíg1(b)
g2(b) ‚â•0,
Œº2 = max
b‚ààB2
‚àíg2(b)
g1(b) ‚â•0.
We need to Ô¨Ånd Œª > 0 such that Œªg1(b) + g2(b) > 0 for all b ‚ààB. This is clearly
satisÔ¨Åed if b Ã∏‚ààB1
B2, while for b1 ‚ààB1 and b2 ‚ààB2 we have
Œªg1(b1)+g2(b1) ‚â•(1‚àíŒªŒº1)g2(b1),
Œªg1(b2)+g2(b2) ‚â•(Œª ‚àíŒº2)g1(b2).
Therefore, it sufÔ¨Åces to Ô¨Ånd a Œª > 0 such that 1‚àíŒªŒº1 > 0 and Œª ‚àíŒº2 > 0. Such a
Œª exists if and only if Œº1Œº2 < 1. To prove that Œº1Œº2 < 1, we can assume that Œº1 Ã∏= 0
and Œº2 Ã∏= 0. Then we take b1 ‚ààB1 and b2 ‚ààB2, for which the maxima Œº1 and Œº2 are
attained, respectively. Then we have
g1(b1)+ Œº1g2(b1) = 0,
g1(b2)+ 1
Œº2
g2(b2) = 0.
But g1(b1) < 0 < g1(b2); thus taking bŒ∏ = Œ∏b1 +(1‚àíŒ∏)b2 for some Œ∏ in (0,1), we
have
g1(bŒ∏) ‚â§Œ∏g1(b1)+(1‚àíŒ∏)g1(b2) = 0.
Considering the same convex combination of the last displayed equations and using
this identity, we obtain that
Œº1Œº2Œ∏g2(b1)+(1‚àíŒ∏)g2(b2) = 0.
The hypothesis of the proposition implies that g2(bŒ∏) > 0 and the convexity of g2:
Œ∏g2(b1)+(1‚àíŒ∏)g2(b2) > 0.
Since g2(b1) > 0, we must have Œº1Œº2g2(b1) < g2(b1), which gives Œº1Œº2 < 1. This
proves the required claim and completes the case n = 2.
We now use induction to prove the proposition for arbitrary n. Assume that the
result has been proved for n‚àí1 functions. Consider the subset of B
Bn = {b ‚ààB : gn(b) ‚â§0}.
If Bn = /0, we choose Œª1 = Œª2 = ¬∑¬∑¬∑ = Œªn‚àí1 = 0 and Œªn = 1. If Bn is not empty, then it
is compact and convex and we can restrict g1,g2,...,gn‚àí1 to Bn. Using the induction
hypothesis, we can Ô¨Ånd Œª1,Œª2,...,Œªn‚àí1 ‚â•0 such that

H The Minimax Lemma
605
g0(b) = Œª1g1(b)+Œª2g2(b)+¬∑¬∑¬∑+Œªn‚àí1gn‚àí1(b) > 0
for all b ‚ààBn. Then g0 and gn are convex lower semicontinuous functions on B, and
max(g0(b),gn(b)) > 0 for all b ‚ààB. Using the case n = 2, which was Ô¨Årst proved,
we can Ô¨Ånd Œª0,Œªn ‚â•0 such that for all b ‚ààB we have
0 < Œª0g0(b)+Œªngn(b)
= Œª0Œª1g1(b)+Œª0Œª2g2(b)+¬∑¬∑¬∑+Œª0Œªn‚àí1gn‚àí1(b)+Œªngn(b).
This establishes the case of n functions and concludes the proof of the induction and
hence of the proposition.
‚ñ°
We now turn to the proof of the minimax lemma.
Proof. The fact that the left-hand side in the required conclusion of the minimax
lemma is at least as big as the right-hand side is obvious. We can therefore concen-
trate on the converse inequality. In doing this we may assume that the right-hand side
is Ô¨Ånite. Without loss of generality we can subtract a Ô¨Ånite constant from Œ¶(a,b),
and so we can also assume that
sup
a‚ààA
min
b‚ààB Œ¶(a,b) = 0.
Then, by hypothesis (c) of the minimax lemma, the subsets
Ba = {b ‚ààB : Œ¶(a,b) ‚â§0},
a ‚ààA
of B are closed and nonempty, and we show that they satisfy the Ô¨Ånite intersection
property. Indeed, suppose that
Ba1 ‚à©Ba2 ‚à©¬∑¬∑¬∑‚à©Ban = /0
for some a1,a2,...,an ‚ààA. We write gj(b) = Œ¶(aj,b), j = 1,2,...,n, and we ob-
serve that the conditions of the previous proposition are satisÔ¨Åed. Therefore we can
Ô¨Ånd Œª1,Œª2,...,Œªn ‚â•0 such that for all b ‚ààB we have
Œª1Œ¶(a1,b)+Œª2Œ¶(a2,b)+¬∑¬∑¬∑+ŒªnŒ¶(an,b) > 0.
For simplicity we normalize the Œª j‚Äôs by setting Œª1 + Œª2 + ¬∑¬∑¬∑ + Œªn = 1. If we set
a0 = Œª1a1 +Œª2a2 +¬∑¬∑¬∑+Œªnan, the concavity hypothesis (a) gives
Œ¶(a0,b) > 0
for all b ‚ààB, contradicting the fact that supa‚ààA minb‚ààB Œ¶(a,b) = 0. Therefore, the
family of closed subsets {Ba}a‚ààA of B satisÔ¨Åes the Ô¨Ånite intersection property. The
compactness of B now implies 
a‚ààA Ba Ã∏= /0. Take b0 ‚àà
a‚ààA Ba. Then Œ¶(a,b0) ‚â§0
for every a ‚ààA, and therefore
min
b‚ààB sup
a‚ààA
Œ¶(a,b) ‚â§sup
a‚ààA
Œ¶(a,b0) ‚â§0
as required.
‚ñ°

Appendix I
Taylor‚Äôs and Mean Value Theorem in Several
Variables
I.1 Mutlivariable Taylor‚Äôs Theorem
For a multiindex Œ± = (Œ±1,...,Œ±n) ‚àà(Z+ ‚à™{0})n, we denote by |Œ±| = Œ±1 +¬∑¬∑¬∑+Œ±n
its size, we deÔ¨Åne Œ±! = Œ±1!¬∑¬∑¬∑Œ±n! its factorial, and we set
hŒ± = hŒ±1
1 ¬∑¬∑¬∑hŒ±n
n ,
where h = (h1,...,hn); here 00 = 1.
Let k ‚ààZ+ ‚à™{0}. Suppose a real-valued C k+1 function f is deÔ¨Åned on an open
convex subset Œ© of Rn. Suppose that x ‚ààŒ© and x+h ‚ààŒ©. Then we have the Taylor
expansion formula
f(x+h) = ‚àë
|Œ±|‚â§k
‚àÇŒ± f(x)
Œ±!
hŒ± +R(h,x,k),
where the remainder R(h,x,k) can be expressed either in Langrange‚Äôs mean value
form
R(h,x,k) = ‚àë
|Œ±|=k+1
‚àÇŒ± f(x+ch)
Œ±!
hŒ±
for some c ‚àà(0,1), or in integral form
R(h,x,k) = (k +1) ‚àë
|Œ±|=k+1
hŒ±
Œ±!
 1
0 (1‚àít)k‚àÇŒ± f(x+th)dt .
L. Grafakos, Classical Fourier Analysis, Graduate Texts in Mathematics 249,
DOI 10.1007/978-1-4939-1194-3, ¬© Springer Science+Business Media New York 2014
607

608
I Taylor‚Äôs and Mean Value Theorem in Several Variables
I.2 The Mean value Theorem
Suppose that f is as above and k = 0. Then for given x,y ‚ààŒ© we have
f(y)‚àíf(x) =
 1
0 ‚àáf((1‚àít)x+ty)¬∑(y‚àíx)dt = ‚àáf((1‚àíc)x+cy)¬∑(y‚àíx)
for some c ‚àà(0,1). This is a special case of Taylor‚Äôs formula when k = 0.

Appendix J
The Whitney Decomposition of Open Sets in Rn
J.1 Decomposition of Open Sets
An arbitrary open set in Rn can be decomposed as a union of disjoint cubes whose
lengths are proportional to their distance from the boundary of the open set. See, for
instance, Figure J.1 when the open set is the unit disk in R2. For a given cube Q in
Rn, we denote by ‚Ñì(Q) its length.
Proposition. Let Œ© be an open nonempty proper subset of Rn. Then there exists a
family of closed dyadic cubes {Qj}j (called the Whitney cubes of Œ©) such that
(a) 
j Qj = Œ© and the Qj‚Äôs have disjoint interiors.
(b) ‚àön‚Ñì(Qj) ‚â§dist(Qj,Œ© c) ‚â§4‚àön‚Ñì(Qj). Thus 10‚àönQj meets Œ© c.
(c) If the boundaries of two cubes Qj and Qk touch, then
1
4 ‚â§‚Ñì(Qj)
‚Ñì(Qk) ‚â§4.
(d) For a given Q j there exist at most 12n ‚àí4n cubes Qk that touch it.
(e) Let 0 < Œµ < 1/4. If Q‚àó
j has the same center as Qj and ‚Ñì(Q‚àó
j) = (1+Œµ)‚Ñì(Qj) then
œáŒ© = ‚àë
j
œáQ‚àó
j ‚â§12n ‚àí4n +1.
Proof. Let Dk be the collection of all dyadic cubes of the form
{(x1,...,xn) ‚ààRn : mj2‚àík ‚â§xj < (mj +1)2‚àík},
where mj ‚ààZ. Observe that each cube in Dk gives rise to 2n cubes in Dk+1 by
bisecting each side.
Write the set Œ© as the union of the sets
Œ©k = {x ‚ààŒ© : 2‚àön2‚àík < dist(x,Œ© c) ‚â§4‚àön2‚àík}
L. Grafakos, Classical Fourier Analysis, Graduate Texts in Mathematics 249,
DOI 10.1007/978-1-4939-1194-3, ¬© Springer Science+Business Media New York 2014
609

610
J The Whitney Decomposition of Open Sets in Rn
over all k ‚ààZ. Let F ‚Ä≤ be the set of all cubes Q in Dk for some k ‚ààZ such that
Q‚à©Œ©k Ã∏= /0. We show that the collection F ‚Ä≤ satisÔ¨Åes property (b). Let Q ‚ààF ‚Ä≤ and
pick x ‚ààŒ©k ‚à©Q for some k ‚ààZ. Observe that
‚àön2‚àík ‚â§dist(x,Œ© c)‚àí‚àön‚Ñì(Q) ‚â§dist(Q,Œ© c) ‚â§dist(x,Œ© c) ‚â§4‚àön2‚àík ,
which proves (b).
Next we observe that

Q‚ààF ‚Ä≤
Q = Œ© .
Indeed, every Q in F ‚Ä≤ is contained in Œ© (since it has positive distance from its
complement) and every x ‚ààŒ© lies in some Œ©k and in some dyadic cube in Dk.
Fig. J.1 The Whitney decom-
position of the unit disk.
The problem is that the cubes in the collection F ‚Ä≤ may not be disjoint. We have
to reÔ¨Åne the collection F ‚Ä≤ by eliminating those cubes that are contained in some
other cubes in the collection. Recall that two dyadic cubes have disjoint interiors or
else one contains the other. For every cube Q in F ‚Ä≤ we can therefore consider the
unique maximal cube Qmax in F ‚Ä≤ that contains it. Two different such maximal cubes
must have disjoint interiors by maximality. Now set F = {Qmax : Q ‚ààF ‚Ä≤}.
The collection of cubes {Qj}j = F clearly satisÔ¨Åes (a) and (b), and we now turn
our attention to the proof of (c). Observe that if Qj and Qk in F touch then
‚àön‚Ñì(Qj) ‚â§dist(Qj,Œ© c) ‚â§dist(Qj,Qk)+dist(Qk,Œ© c) ‚â§0+4‚àön‚Ñì(Qk),
which proves (c). To prove (d), note that any cube Q in Dk is touched by exactly
3n ‚àí1 other cubes in Dk. But each cube Q in Dk can contain at most 4n cubes of F
of length at least one-quarter of the length of Q. This fact combined with (c) yields
(d). To prove (e), notice that each Q‚àó
j is contained in Œ© by part (b). If x ‚ààŒ©, then

J.2 Partition of Unity adapted to Whitney cubes
611
x ‚ààQk0 for some k0. If Qj does not touch Qk0, then Q‚àó
j does not touch Qk0 as well.
Consequently, the given x ‚ààŒ© may lie only in Q‚àó
k for these cubes Qk that touch Qk0
and there are 12n ‚àí4n +1 such cubes including Qk0.
‚ñ°
J.2 Partition of Unity adapted to Whitney cubes
Let us Ô¨Åx an Œµ such that 0 < Œµ < 1/4. For each cube Q we denote by Q‚àóthe cube
with the same center as Q and side length (1+Œµ)‚Ñì(Q), where ‚Ñì(Q) is the side length
of Q. Let us Ô¨Åx a nonnegative smooth function œÜ that is equal to 1 on the unit cube
Q0 = [‚àí1/2,1/2]n and equal to zero outside Q‚àó
0.
Let {Qk}k be the family of Whitney cubes of Œ©. We denote by ck the center of Qk
and by ‚Ñìk its side length. Since dist (Qk,Œ© c) ‚â•‚àön‚Ñìk, and dist ((Q‚àó
k)c,Qk) ‚â§Œµ‚àön‚Ñìk,
it follows that
dist (Q‚àó
k,Œ© c) ‚â•(1‚àíŒµ)‚àön‚Ñìk > 0,
hence Q‚àó
k is contained in Œ©. Since the union of Qk is Œ©, then the union of Q‚àó
k is
also Œ©.
For each k we deÔ¨Åne
œÜk(x) = œÜ
x‚àíck
‚Ñìk

and we set
Œ¶(x) = ‚àë
k
œÜk(x).
We notice that Œ¶ is smooth and that Œ¶ ‚â•1 on Œ©. Then we deÔ¨Åne
œïk(x) = œÜk(x)
Œ¶(x) .
Obviously œïk are supported in Q‚àó
k, the union of Q‚àó
k is Œ©, and we have
‚àë
k
œïk = œáŒ© .
We would like to control |‚àÇŒ±œïk(x)| in terms of ‚Ñìk. To achieve this we use the
Leibniz rule of differentiation. For a Ô¨Åxed k we have that
‚àÇŒ±
‚àÇxŒ± œïk(x) = ‚àë
Œ≤‚â§Œ±
Œ±1
Œ≤1

¬∑¬∑¬∑
Œ±n
Œ≤n
 ‚àÇŒ≤
‚àÇxŒ≤
1
Œ¶(x)
 ‚àÇŒ±‚àíŒ≤
‚àÇxŒ±‚àíŒ≤ œÜk(x)
and obviously
‚àÇŒ±‚àíŒ≤œÜk(x)
 ‚â§‚Ñì‚àí|Œ±|+|Œ≤|
k
. A simple inductive argument shows that
 ‚àÇŒ≤
‚àÇxŒ≤
1
Œ¶(x)
 ‚â§C
‚àë
0‚â§q j‚â§|Œ≤|
q1+¬∑¬∑¬∑+qn=|Œ≤|
‚àÇq1
1 ¬∑¬∑¬∑‚àÇqn
n Œ¶(x)

Œ¶(x)2
,

612
J The Whitney Decomposition of Open Sets in Rn
for some constant C, and since for a given x ‚ààŒ©, Œ¶(x) is the sum of at most 12n
functions with nonzero values, it follows that
‚àÇq1
1 ¬∑¬∑¬∑‚àÇqn
n Œ¶(x)
 ‚â§Cn ‚Ñì‚àí(q1+¬∑¬∑¬∑+qn)
k
when x ‚ààQ‚àó
k and thus
 ‚àÇŒ≤
‚àÇxŒ≤
1
Œ¶(x)
 ‚â§C‚Ä≤
n,Œ≤ ‚Ñì‚àí|Œ≤|
k
for x ‚ààQ‚àó
k. We conclude that for every multiindex Œ± there is a constant CŒ±,n such
that
 ‚àÇŒ±
‚àÇxŒ± œïk(x)
 ‚â§CŒ±,n ‚Ñì‚àí|Œ±| .
More on Whitney decompositions can be found in the article of Whitney [373]
and the books of Stein [338], Krantz and Parks [204].

Glossary
A ‚´ÖB
A is a subset of B (also denoted by A ‚äÜB)
A ‚´ãB
A is a proper subset of B
A ‚äÉB
B is a proper subset of A
Ac
the complement of a set A
œáE
the characteristic function of the set E
df
the distribution function of a function f
f ‚àó
the decreasing rearrangement of a function f
fn ‚Üëf
fn increases monotonically to a function f
Z
the set of all integers
Z+
the set of all positive integers {1,2,3,...}
Zn
the n-fold product of the integers
R
the set of real numbers
R+
the set of positive real numbers
Rn
the Euclidean n-space
Q
the set of rationals
Qn
the set of n-tuples with rational coordinates
C
the set of complex numbers
Cn
the n-fold product of complex numbers
T
the unit circle identiÔ¨Åed with the interval [0,1]
Tn
the n-dimensional torus [0,1]n
|x|
"
|x1|2 +¬∑¬∑¬∑+|xn|2 when x = (x1,...,xn) ‚ààRn
L. Grafakos, Classical Fourier Analysis, Graduate Texts in Mathematics 249,
DOI 10.1007/978-1-4939-1194-3, ¬© Springer Science+Business Media New York 2014
613

614
Glossary
Sn‚àí1
the unit sphere {x ‚ààRn : |x| = 1}
ej
the vector (0,...,0,1,0,...,0) with 1 in the jth entry and 0 elsewhere
logt
the logarithm with base e of t > 0
logat
the logarithm with base a of t > 0 (1 Ã∏= a > 0)
log+t
max(0,logt) for t > 0
[t]
the integer part of the real number t
x¬∑y
the quantity ‚àën
j=1 xjyj when x = (x1,...,xn) and y = (y1,...,yn)
B(x,R)
the ball of radius R centered at x in Rn
œân‚àí1
the surface area of the unit sphere Sn‚àí1
vn
the volume of the unit ball {x ‚ààRn : |x| < 1}
|A|
the Lebesgue measure of the set A ‚äÜRn
dx
Lebesgue measure
AvgB f
the average
1
|B|

B f(x)dx of f over the set B
4
f,g
5
the real inner product

Rn f(x)g(x)dx
4
f |g
5
the complex inner product

Rn f(x)g(x)dx
4
u, f
5
the action of a distribution u on a function f
p‚Ä≤
the number p/(p‚àí1), whenever 0 < p Ã∏= 1 < ‚àû
1‚Ä≤
the number ‚àû
‚àû‚Ä≤
the number 1
f = O(g)
means | f(x)| ‚â§M|g(x)| for some M for x near x0
f = o(g)
means | f(x)||g(x)|‚àí1 ‚Üí0 as x ‚Üíx0
At
the transpose of the matrix A
A‚àó
the conjugate transpose of a complex matrix A
A‚àí1
the inverse of the matrix A
O(n)
the space of real matrices satisfying A‚àí1 = At
‚à•T‚à•X‚ÜíY
the norm of the (bounded) operator T : X ‚ÜíY
A ‚âàB
means that there exists a c > 0 such that c‚àí1 ‚â§B
A ‚â§c
|Œ±|
indicates the size |Œ±1|+¬∑¬∑¬∑+|Œ±n| of a multi-index Œ± = (Œ±1,...,Œ±n)
‚àÇm
j f
the mth partial derivative of f(x1,...,xn) with respect to xj
‚àÇŒ± f
‚àÇŒ±1
1 ¬∑¬∑¬∑‚àÇŒ±n
n f

Glossary
615
C k
the space of functions f with ‚àÇŒ± f continuous for all |Œ±| ‚â§k
C0
the space of continuous functions with compact support
C00
the space of continuous functions that vanish at inÔ¨Ånity
C ‚àû
0
the space of smooth functions with compact support
D
the space of smooth functions with compact support
S
the space of Schwartz functions
S0
the space of Schwartz functions œï with the property

Rn xŒ≥œï(x)dx = 0
for all multi-indices Œ≥.
C ‚àû
the space of smooth functions ‚àû
k=1 C k
D‚Ä≤(Rn)
the space of distributions on Rn
S ‚Ä≤(Rn)
the space of tempered distributions on Rn
E ‚Ä≤(Rn)
the space of distributions with compact support on Rn
P
the set of all complex-valued polynomials of n real variables
S ‚Ä≤(Rn)/P the space of tempered distributions on Rn modulo polynomials
‚Ñì(Q)
the side length of a cube Q in Rn
‚àÇQ
the boundary of a cube Q in Rn
Lp(X,Œº)
the Lebesgue space over the measure space (X,Œº)
Lp(Rn)
the space Lp(Rn,|¬∑|)
Lp,q(X,Œº)
the Lorentz space over the measure space (X,Œº)
Lp
loc(Rn)
the space of functions that lie in Lp(K) for any compact set K in Rn
|dŒº|
the total variation of a Ô¨Ånite Borel measure Œº on Rn
M (Rn)
the space of all Ô¨Ånite Borel measures on Rn
Mp(Rn)
the space of Lp Fourier multipliers, 1 ‚â§p ‚â§‚àû
M p,q(Rn)
the space of translation-invariant operators that map Lp(Rn) to Lq(Rn)
‚à•Œº‚à•M

Rn |dŒº| the norm of a Ô¨Ånite Borel measure Œº on Rn
M
the centered Hardy‚ÄìLittlewood maximal operator with respect to balls
M
the uncentered Hardy‚ÄìLittlewood maximal operator with respect to balls
Mc
the centered Hardy‚ÄìLittlewood maximal operator with respect to cubes
Mc
the uncentered Hardy‚ÄìLittlewood maximal operator with respect to
cubes

616
Glossary
MŒº
the centered maximal operator with respect to a measure Œº
MŒº
the uncentered maximal operator with respect to a measure Œº
Ms
the strong maximal operator
Md
the dyadic maximal operator

References
1. Albiac, F., Kalton, N. J., Topics in Banach Space Theory, Graduate Texts in Mathematics,
233, Springer, New York, 2006.
2. Aldaz, J. M., The weak type (1,1) bounds for the maximal function associated to cubes grow
to inÔ¨Ånity with the dimension, Ann. of Math. (2nd Ser.) 173 (2011), no. 2, 1013‚Äì1023.
3. Alimov, Sh. A., Ashurov, R. R., Pulatov, A. K., Multiple Fourier series and Fourier integrals,
Proc. Commutative Harmonic Analysis, IV, pp. 1‚Äì95, Encyclopaedia Math. Sci. 42, Springer,
Berlin, 1992.
4. Alvarez, J., P¬¥erez, C., Estimates with A‚àûweights for various singular integral operators,
Boll. Un. Mat. Ital. A (7) 8 (1994), no. 1, 123‚Äì133.
5. Antonov, N. Yu., Convergence of Fourier series, Proceedings of the XX Workshop on Func-
tion Theory (Moscow, 1995), East J. Approx. 2 (1996), no. 2, pp. 187‚Äì196.
6. Antonov, N. Yu., The behavior of partial sums of trigonometric Fourier series [Russian], Ph.
D. Thesis, Institute of Mathematics and Mechanics, Ural Branch of the Russian Academy of
Sciences, Ekaterinburg, 1998.
7. Aoki, T., Locally bounded spaces, Proc. Imp. Acad. Tokyo 18 (1942), no. 10, 585‚Äì634.
8. Arhipov, G. I., Karachuba, A. A., ÀáCubarikov, V. N., Trigonometric integrals, Math. USSR
Izvestija 15 (1980), 211‚Äì239.
9. Arias de Reyna, J., Pointwise convergence of Fourier series, J. London Math. Soc. (2) 65
(2002), no. 1, 139‚Äì153.
10. Arias de Reyna, J., Pointwise Convergence of Fourier Series, Lecture Notes in Mathematics,
1785, Springer-Verlag, Berlin, 2002.
11. Ash, J. M., Multiple trigonometric series, Studies in Harmonic Analysis (Proc. Conf., De-
Paul Univ., Chicago, IL, 1974), pp. 76‚Äì96, MAA Stud. Math., Vol. 13, Math. Assoc. Amer.,
Washington, D. C., 1976.
12. Asmar, N., Berkson, E., Gillespie, T. A., Summability methods for transferring Fourier multi-
pliers and transference of maximal inequalities, Analysis and Partial Differential Equations,
pp. 1‚Äì34, Lecture Notes in Pure and Appl. Math. 122, Dekker, New York, 1990.
13. Asmar, N., Berkson, E., Gillespie, T. A., On Jodeit‚Äôs multiplier extension theorems, J. Anal.
Math. 64 (1994), 337‚Äì345.
14. Astala, K., Iwaniec, T., Saksman, E., Beltrami operators in the plane, Duke Math. J. 107
(2001), no. 1, 27‚Äì56.
15. Aubrun, G., Maximal inequality for high-dimensional cubes, ConÔ¨Çuentes Math. 1 (2009),
no. 2, 169‚Äì179.
16. Babenko, K. I., An inequality in the theory of Fourier integrals [Russian], Izv. Akad. Nauk
SSSR Ser. Mat. 25 (1961), 531‚Äì542.
17. Baernstein II, A., Some sharp inequalities for conjugate functions, Indiana Univ. Math. J. 27
(1978), 833‚Äì852.
L. Grafakos, Classical Fourier Analysis, Graduate Texts in Mathematics 249,
DOI 10.1007/978-1-4939-1194-3, ¬© Springer Science+Business Media New York 2014
617

618
References
18. Bagby, R., Kurtz, D. S., Covering lemmas and the sharp function, Proc. Amer. Math. Soc. 93
(1985), no. 2, 291‚Äì296.
19. Bagby, R., Kurtz, D. S., A rearranged good-Œª inequality, Trans. Amer. Math. Soc. 293
(1986), no. 1, 71‚Äì81.
20. Bary, N., A Treatise on Trigonometric Series, Vols. I, II, Authorized translation by Margaret
F. Mullins, A Pergamon Press Book, The Macmillan Co., New York, 1964.
21. Beckner, W., Inequalities in Fourier analysis, Ann. of Math. (2nd Ser.) 102 (1975), no. 1,
159‚Äì182.
22. Benedek, A., Calder¬¥on, A.-P., Panzone, R., Convolution operators on Banach-space valued
functions, Proc. Nat. Acad. Sci. U.S.A. 48 (1962), 356‚Äì365.
23. Benedetto, J., Frazier, M. (eds.), Wavelets: Mathematics and Applications, CRC Press, Boca
Raton, FL, 1994.
24. Bennett, C., Sharpley, R., Interpolation of Operators, Pure and Applied Mathematics, 129
Academic Press, Inc., Boston, MA, 1988.
25. Bergh, J., L¬®ofstr¬®om, J., Interpolation Spaces, An Introduction, Grundlehren der Mathematis-
chen Wissenschaften, No. 223, Springer-Verlag, Berlin-New York, 1976.
26. Bernstein, S., Sur la convergence absolue des s¬¥eries trigonom¬¥etriques, Comptes Rendus des
S¬¥eances de l‚Äô Acad¬¥emie des Sciences, Paris, 158 (1914), 1661‚Äì1663.
27. Besicovitch, A., A general form of the covering principle and relative differentiation of addi-
tive functions, Proc. of Cambridge Philos. Soc. 41 (1945), 103‚Äì110.
28. Boas, R. P., Bochner, S., On a theorem of M. Riesz for Fourier series, J. London Math. Soc.
14 (1939), no. 1, 62‚Äì73.
29. BÀÜocher, M., Introduction to the theory of Fourier‚Äôs series, Ann. of Math. (2nd Ser.) 7 (1906),
no. 3, 81‚Äì152.
30. Bochner, S., Summation of multiple Fourier series by spherical means, Trans. Amer. Math.
Soc. 40 (1936), no. 2, 175‚Äì207.
31. Bochner, S., Harmonic Analysis and the Theory of Probability, University of California
Press, Berkeley and Los Angeles, 1955.
32. Bochner, S., Lectures on Fourier Integrals, (with an author‚Äôs supplement on monotonic func-
tions, Stieltjes integrals, and harmonic analysis), Translated by Morris Tenenbaum and Harry
Pollard. Annals of Mathematics Studies, No. 42, Princeton University Press, Princeton, NJ,
1959.
33. Bojarski, B., Remarks on Markov‚Äôs inequalities and some properties of polynomials (Russian
summary), Bull. Polish Acad. Sci. Math. 33 (1985), no. 7-8, 355‚Äì365.
34. Bourgain, J., On square functions on the trigonometric system, Bull. Soc. Math. Belg. S¬¥er. B
37 (1985), no. 1, 20‚Äì26.
35. Bourgain, J., Estimations de certaines fonctions maximales, C. R. Acad. Sci. Paris S¬¥er. I
Math. 301 (1985), no. 10, 499‚Äì502.
36. Bourgain, J., Averages in the plane over convex curves and maximal operators, J. Analyse
Math. 47 (1986), 69‚Äì85.
38. Buckley, S. M., Estimates for operator norms on weighted spaces and reverse Jensen in-
equalities, Trans. Amer. Math. Soc. 340 (1993), no. 1, 253‚Äì272.
39. Burkholder, D. L., Martingale transforms, Ann. Math. Statist. 37 (1966), 1494‚Äì1505.
40. Burkholder, D. L., Gundy, R. F., Extrapolation and interpolation of quasilinear operators on
martingales, Acta Math. 124 (1970), no. 1, 249‚Äì304.
41. Calder¬¥on, A. P., On the theorems of M. Riesz and Zygmund, Proc. Amer. Math. Soc. 1 (1950),
533‚Äì535.
42. Calder¬¥on, A. P., Intermediate spaces and interpolation, the complex method, Studia Math. 24
(1964), 113‚Äì190.
43. Calder¬¥on, A. P., Singular integrals, Bull. Amer. Math. Soc. 72 (1966), 427‚Äì465.
44. Calder¬¥on, A. P., Algebras of singular integral operators, Singular Integrals (Proc. Sympos.
Pure Math. (Chicago, IL, 1966), pp. 18‚Äì55, Amer. Math. Soc., Providence, RI, 1967.
37. Bourgain, J., On the Hardy-Littlewood maximal function for the cube, Israel J. Math. 203
(2014), 275‚Äì293.

References
619
45. Calder¬¥on, A. P., Torchinsky, A., Parabolic maximal functions associated with a distribution,
II, Advances in Math. 24 (1977), no. 2, 101‚Äì171.
46. Calder¬¥on, A. P., Zygmund, A., On the existence of certain singular integrals, Acta Math. 88
(1952), no. 1, 85‚Äì139.
47. Calder¬¥on, A. P., Zygmund, A., A note on interpolation of sublinear operators, Amer. J. Math.
78 (1956), 282‚Äì288.
48. Calder¬¥on, A. P., Zygmund, A., On singular integrals, Amer. J. Math. 78 (1956), 289‚Äì309.
49. Calder¬¥on, A. P., Zygmund, A., Algebras of certain singular integral operators, Amer. J. Math.
78 (1956), 310‚Äì320.
50. Calder¬¥on, C., Lacunary spherical means, Illinois J. Math. 23 (1979), no. 3, 476‚Äì484.
51. Carbery, A., An almost-orthogonality principle with applications to maximal functions asso-
ciated to convex bodies, Bull. Amer. Math. Soc. (N.S.) 14 (1986), no. 2, 269‚Äì273.
52. Carbery, A., Variants of the Calder¬¥on‚ÄìZygmund theory for Lp-spaces, Rev. Mat. Iberoamer-
icana 2 (1986), no. 4, 381‚Äì396.
53. Carbery, A., Christ, M., Wright, J., Multidimensional van der Corput and sublevel set esti-
mates, J. Amer. Math. Soc. 12 (1999), no. 4, 981‚Äì1015.
54. Carleson, L., On convergence and growth of partial sums of Fourier series, Acta Math. 116
(1966), no. 1, 135‚Äì157.
55. Carleson, L., On the Littlewood‚ÄìPaley Theorem, Mittag-LefÔ¨Çer Institute Report, Djursholm,
Sweden, 1967.
56. Carro, M. J., New extrapolation estimates, J. Funct. Anal. 174 (2000), no. 1, 155‚Äì166.
57. Carro, M. J., Raposo, J. A., Soria, J., Recent developments in the theory of Lorentz spaces
and weighted inequalities, Mem. Amer. Math. Soc. 187 (2007), no. 877.
58. Carro, M. J., Torres, R. H., Soria, J., Rubio de Francia‚Äôs extrapolation theory: estimates for
the distribution function, J. Lond. Math. Soc. (2) 85 (2012), no. 2, 430‚Äì454.
59. Christ, M., A convolution inequality for Cantor-Lebesgue measures, Rev. Mat. Iberoameri-
cana 1 (1985), no. 4, 79‚Äì83.
60. Christ, M., Weak type (1,1) bounds for rough operators I, Ann. of Math. (2nd Ser.) 128
(1988), no. 1, 19‚Äì42.
61. Christ, M., Fefferman, R., A note on weighted norm inequalities for the Hardy‚ÄìLittlewood
maximal operator, Proc. Amer. Math. Soc. 87 (1983), no. 3, 447‚Äì448.
62. Christ, M., Grafakos, L., Best constants for two nonconvolution inequalities, Proc. Amer.
Math. Soc. 123 (1995), no. 6, 1687‚Äì1693.
63. Christ, M., Rubio de Francia, J.L.. Weak type (1,1) bounds for rough operators II, Invent.
Math. 93 (1988), no. 1, 225‚Äì237.
64. Chui, C. (ed.), Wavelets: A Tutorial in Theory and Applications, Academic Press, San Diego,
CA, 1992.
65. Coifman, R. R., Distribution function inequalities for singular integrals, Proc. Nat. Acad.
Sci. U.S.A. 69 (1972), 2838‚Äì2839.
66. Coifman, R. R., Fefferman, C., Weighted norm inequalities for maximal functions and sin-
gular integrals, Studia Math. 51 (1974), 241‚Äì250.
67. Coifman, R. R., Jones, P., Rubio de Francia, J. L., Constructive decomposition of BMO func-
tions and factorization of Ap weights, Proc. Amer. Math. Soc. 87 (1983), no. 4, 675‚Äì676.
68. Coifman, R. R., Rochberg, R., Another characterization of BMO, Proc. Amer. Math. Soc. 79
(1980), no. 2, 249‚Äì254.
69. Coifman, R. R., Rubio de Francia, J.-L., Semmes, S., Multiplicateurs de Fourier de Lp(R) et
estimations quadratiques, C. R. Acad. Sci. Paris S¬¥er. I Math. 306 (1988), no. 8, 351‚Äì354.
70. Coifman, R. R., Weiss, G., Transference Methods in Analysis, Conference Board of the Math-
ematical Sciences Regional Conference Series in Mathematics, No. 31, American Mathemat-
ical Society, Providence, RI, 1976.
71. Coifman, R. R., Weiss, G., Book review of ‚ÄúLittlewood‚ÄìPaley and multiplier theory‚Äù, Bull.
Amer. Math. Soc. 84 (1978), no. 2, 242‚Äì250.
72. Connett, W. C., Singular integrals near L1, Harmonic Analysis in Euclidean Spaces,
(Williams Coll., Williamstown, MA, 1978), Part 1, pp. 163‚Äì165, Proc. Sympos. Pure Math.,
XXXV, Part, Amer. Math. Soc., Providence, RI, 1979.

620
References
73. C¬¥ordoba, A., Fefferman, R., A geometric proof of the strong maximal theorem, Ann. of Math.
(2nd Ser.) 102 (1975), no. 1, 95‚Äì100.
74. C¬¥ordoba, A., Fefferman, C., A weighted norm inequality for singular integrals, Studia Math.
57 (1976), no. 1, 97‚Äì101.
75. Cotlar, M., A uniÔ¨Åed theory of Hilbert transforms and ergodic theorems, Rev. Mat. Cuyana,
1 (1955), 105‚Äì167.
76. Cowling, M., Mauceri, G., On maximal functions, Rend. Sem. Mat. Fis. Milano 49 (1979),
79‚Äì87.
77. Cruz-Uribe, D., New proofs of two-weight norm inequalities for the maximal operator, Geor-
gian Math. J. 7 (2000), no. 1, 33‚Äì42.
78. Cruz-Uribe, D., Martell, J. M., P¬¥erez, C., Extrapolation results for A‚àûweights and applica-
tions, J. Funct. Anal. 213 (2004), no. 2, 412‚Äì439.
79. Cruz-Uribe, D., Martell, J. M., P¬¥erez, C., Sharp weighted estimates for approximating dyadic
operators, Electron. Res. Announc. Math. Sci. 17 (2010), 12‚Äì19.
80. Cruz-Uribe, D., Martell, J. M., P¬¥erez, C., Weights, extrapolation and the theory of Rubio de
Francia, Operator Theory: Advances and Applications, 215, Birkh¬®auser/Springer Basel AG,
Basel, 2011.
81. Cruz-Uribe, D., Martell, J. M., P¬¥erez, C., Sharp weighted estimates for classical operators,
Adv. Math. 229 (2012), no. 1, 408‚Äì441.
82. Cruz-Uribe, D., Neugebauer, C. J., The structure of the reverse H¬®older classes, Trans. Amer.
Math. Soc. 347 (1995), no. 8, 2941‚Äì2960.
83. Cwikel, M., The dual of weak Lp, Ann. Inst. Fourier (Grenoble) 25 (1975), no. 2, 81‚Äì126.
84. Cwikel, M., Fefferman, C., Maximal seminorms on weak L1, Studia Math. 69 (1980/81), no.
2, 149‚Äì154.
85. Cwikel, M., Fefferman, C., The canonical seminorm on Weak L1, Studia Math. 78 (1984),
no. 3, 275‚Äì278.
86. Daly, J. E., A necessary condition for Calder¬¥on‚ÄìZygmund singular integral operators, J.
Fourier Anal. Appl. 5 (1999), no. 4, 303‚Äì308.
87. Daly, J. E., Phillips, K., On the classiÔ¨Åcation of homogeneous multipliers bounded on
H1(R2), Proc. Amer. Math. Soc. 106 (1989), no. 3, 685‚Äì696.
88. Daubechies, I., Orthonormal bases of compactly supported wavelets, Comm. Pure Appl.
Math. 41 (1988), no. 7, 909‚Äì996.
89. Daubechies, I., Ten Lectures on Wavelets, CBMS-NSF Regional Conference Series in Ap-
plied Math, 61, Society for Industrial and Applied Mathematics (SIAM), Philadelphia, PA,
1992.
90. Davis, B., On the integrability of the martingale square function, Israel J. Math. 8 (1970),
187‚Äì190.
91. Davis, B., On the weak type (1,1) inequality for conjugate functions, Proc. Amer. Math. Soc.
44 (1974), 307‚Äì311.
92. de Guzm¬¥an, M., Real Variable Methods in Fourier Analysis, North-Holland Mathematics
Studies, 46, Notas de Matem¬¥atica (75), North-Holland Publishing Co., Amsterdam-New
York, 1981.
93. de Guzm¬¥an, M., Differentiation of Integrals in Rn, Lecture Notes in Math. 481, Springer-
Verlag, Berlin-New York, 1975.
94. de Leeuw, K., On Lp multipliers, Ann. of Math. (2nd Ser.) 81 (1965), no. 2, 364‚Äì379.
95. Diestel, J., Uhl, J. J. Jr., Vector Measures, With a foreword by B. J. Pettis, Mathematical
Surveys, No. 15, American Mathematical Society, Providence, RI, 1977.
96. Dirichlet, P. G., Sur la convergence des s¬¥eries trigonom¬¥etriques qui servent `a repr¬¥esenter une
fonction arbitraire entre des limites donn¬¥ees, J. Reine und Angew. Math. 4 (1829), 157‚Äì169.
97. Doob, J. L., Stochastic Processes, John Wiley & Sons, Inc., New York; Chapman & Hall,
Limited, London, 1953.
98. DragiÀácevi¬¥c, O., Grafakos, L., C. Pereyra, and S. Petermichl, Extrapolation and sharp norm
estimates for classical operators on weighted Lebesgue spaces, Publ. Mat. 49 (2005), no. 1,
73‚Äì91.

References
621
99. Dunford, N., Schwartz, J. T., Linear Operators, I, General Theory, With the assistance of W.
G. Bade and R. G. Bartle, Pure and Applied Mathematics, Vol. 7, Interscience Publishers,
Inc., New York; Interscience Publishers, Ltd., London, 1958.
100. Duoandikoetxea, J., Fourier Analysis, Grad. Studies in Math. 29, American Mathematical
Society, Providence, RI, 2001.
101. Duoandikoetxea, J., Extrapolation of weights revisited: new proofs and sharp bounds, J.
Funct. Anal. 260 (2011), no. 6, 1886‚Äì1901.
102. Duoandikoetxea, J., Rubio de Francia, J.-L., Maximal and singular integral operators via
Fourier transform estimates, Invent. Math. 84 (1986), no. 3, 541‚Äì561.
103. Duoandikoetxea, J., Vega, L., Spherical means and weighted inequalities, J. London Math.
Soc. (2) 53 (1996), no. 2, 343‚Äì353.
104. Duong, X. T., McIntosh, A., Singular integral operators with non-smooth kernels on irregular
domains, Rev. Mat. Iberoamericana 15 (1999), no. 2, 233‚Äì265.
105. Dym, H., McKean, H. P., Fourier Series and Integrals, Probability and Mathematical Statis-
tics, No. 14, Academic Press, New York-London, 1972.
106. Edwards, R. E., Fourier Series: A Modern Introduction. Vol. 1, 2nd edition, Graduate Texts
in Mathematics, 64, Springer-Verlag, New York-Berlin, 1979.
107. Erd¬¥elyi, A., Asymptotic Expansions, Dover Publications Inc., New York, 1956.
108. Ess¬¥en, M., A superharmonic proof of the M. Riesz conjugate function theorem, Arkiv Math.
22 (1984), no. 2, 241‚Äì249.
109. Fan, D., Guo, K., Pan, Y., A note of a rough singular integral operator, Math. Inequal. and
Appl. 2 (1999), no. 1, 73‚Äì81.
110. Fan, D., Pan, Y., Singular integral operators with rough kernels supported by subvarieties,
Amer J. Math. 119 (1997), no. 4, 799‚Äì839.
111. Fan, K., Minimax theorems, Proc. Nat. Acad. Sci. U. S. A. 39 (1953), 42‚Äì47.
112. Fefferman, C., On the convergence of multiple Fourier series, Bull. Amer. Math. Soc. 77
(1971), 744‚Äì745.
113. Fefferman, C., The multiplier problem for the ball, Ann. of Math. (2nd Ser.) 94 (1971), no. 2,
330‚Äì336.
114. Fefferman, C., The uncertainty principle, Bull. Amer. Math. Soc. (N. S.) 9 (1983), no. 2,
129‚Äì206.
115. Fefferman, C., Stein, E. M., Some maximal inequalities, Amer. J. Math. 93 (1971), 107‚Äì115.
116. Fefferman, R., A theory of entropy in Fourier analysis, Adv. in Math. 30 (1978), no. 3,
171‚Äì201.
117. Fefferman, R., Strong differentiation with respect to measures, Amer J. Math. 103 (1981), no.
1, 33‚Äì40.
118. Folland, G. B., Sitaram, A., The uncertainty principle: a mathematical survey, J. Fourier
Anal. Appl. 3 (1997), no. 3, 207‚Äì238.
119. Fourier, J., Th¬¥eorie Analytique de la Chaleur, Institut de France, Paris, 1822.
120. Frazier, M., An Introduction to Wavelets Through Linear Algebra, Undergraduate Texts in
Mathematics, Springer-Verlag, New York, 1999.
121. Garc¬¥ƒ±a-Cuerva, J., An extrapolation theorem in the theory of Ap weights, Proc. Amer. Math.
Soc. 87 (1983), no. 3, 422‚Äì426.
122. Garc¬¥ƒ±a-Cuerva, J., Rubio de Francia, J.-L., Weighted Norm Inequalities and Related Top-
ics, North-Holland Mathematics Studies, 116, Notas de Matem¬¥atica (104), North-Holland
Publishing Co., Amsterdam, 1985.
123. Garnett, J., Jones, P., The distance in BMO to L‚àû, Ann. of Math. 108 (1978), no. 2, 373‚Äì393.
124. Garrig¬¥os, G., Seeger, A., Characterizations of Hankel multipliers, Math. Ann. 342 (2008),
no. 1, 31‚Äì68.
125. Gehring, F. W., The Lp-integrability of the partial derivatives of a quasiconformal mapping,
Acta Math. 130 (1973), no. 1, 265‚Äì277.
126. Gelfand, I. M., ÀáSilov, G. E., Generalized Functions, Vol. 1: Properties and Operations, Aca-
demic Press, New York-London, 1964.
127. Gelfand, I. M., ÀáSilov, G. E., Generalized Functions, Vol. 2: Spaces of Fundamental and Gen-
eralized Functions, Academic Press, New York-London, 1968.

622
References
128. Gibbs, J. W., Fourier‚Äôs Series, Nature 59 (1899), 606.
129. Gohberg, I., Krupnik, N., Norm of the Hilbert transformation in the Lp space, Funct. Anal.
Appl. 2 (1968), 180‚Äì181.
130. Grafakos, L., Best bounds for the Hilbert transform on Lp(R1), Math. Res. Lett. 4 (1997), no.
4, 469‚Äì471.
131. Grafakos, L., Modern Fourier Analysis, 3rd edition, Graduate Texts in Math. 250, Springer,
New York, 2014.
132. Grafakos, L., Honz¬¥ƒ±k, P., Ryabogin, D., On the p-independence property of Calder¬¥on‚Äì
Zygmund theory, J. Reine Angew. Math. 602 (2007), 227‚Äì234.
133. Grafakos, L., Kalton, N., The Marcinkiewicz multiplier condition for bilinear operators, Stu-
dia Math. 146 (2001), no. 2, 115‚Äì156.
134. Grafakos, L., Kinnunen, J., Sharp inequalities for maximal functions associated to general
measures, Proc. Roy. Soc. Edinburgh Sect. A 128 (1998), no. 4, 717‚Äì723.
135. Grafakos, L., Martell, J. M., Extrapolation of weighted norm inequalities for multivariable
operators and applications J. Geom. Anal. 14 (2004), no. 1, 19‚Äì46.
136. Grafakos, L., Montgomery-Smith, S., Best constants for uncentred maximal functions, Bull.
London Math. Soc. 29 (1997), no. 1, 60‚Äì64.
137. Grafakos, L., Morpurgo, C., A Selberg integral formula and applications, PaciÔ¨Åc J. Math.
191 (1999), no. 1, 85‚Äì94.
138. Grafakos, L., Stefanov, A., Lp bounds for singular integrals and maximal singular integrals
with rough kernels, Indiana Univ. Math. J. 47 (1998), no. 2, 455‚Äì469.
139. Grafakos, L., Stefanov, A., Convolution Calder¬¥on‚ÄìZygmund singular integral operators with
rough kernels, Analysis of Divergence (Orono, ME, 1997), pp. 119‚Äì143, Appl. Numer. Har-
mon. Anal., Birkh¬®auser Boston, Boston, MA, 1999.
140. Gr¬®ochenig, K., Foundations of Time-Frequency Analysis, Applied and Numerical Harmonic
Analysis Birkh¬®auser Boston, Inc., Boston, MA, 2001.
141. Haagerup, U., The best constants in Khintchine‚Äôs inequality, Studia Math. 70 (1981), no. 3,
231‚Äì283.
142. Hahn, L.-S., On multipliers of p-integrable functions, Trans. Amer. Math. Soc. 128 (1967),
321‚Äì335.
143. Hardy, G. H., Theorems relating to the summability and convergence of slowly oscillating
series, Proc. London Math. Soc. (2) 8 (1910), no. 1, 301‚Äì320.
144. Hardy, G. H., Note on a theorem of Hilbert, Math. Z. 6 (1920), no. 3-4, 314‚Äì317.
145. Hardy, G. H., Note on some points in the integral calculus, LX. An inequality between inte-
grals, Messenger of Math. 54 (1925), 150‚Äì156.
146. Hardy, G. H., Littlewood, J. E., A maximal theorem with function-theoretic applications, Acta
Math. 54 (1930), no. 1, 81‚Äì116.
147. Hardy, G. H., Littlewood, J. E., Some more theorems concerning Fourier series and Fourier
power series, Duke Math. J. 2 (1936), no. 2, 354‚Äì381.
148. Hardy, G. H., Littlewood, J. E., P¬¥olya, G., Inequalities, 2nd edition, Cambridge University
Press, Cambridge, 1952.
149. Helson, H., SzegÀùo, G., A problem in prediction theory, Ann. Mat. Pura Appl. (4) 51 (1960),
107‚Äì138.
150. Heo, Y., Nazarov, F., Seeger, A., Radial Fourier multipliers in high dimensions, Acta Math.
206 (2011), no. 1, 55‚Äì92.
151. H¬¥ernandez, E., Weiss, G., A First Course on Wavelets (Studies in Advanced Mathematics),
CRC Press, Boca Raton, FL, 1996.
152. Hewitt, E., Ross, K., Abstract Harmonic Analysis, Vol I, 2nd edition, Grundlehren der math-
ematischen Wissenschaften, 115, Springer-Verlag, Berlin, New York, 1979.
153. Hewitt, E., Stromberg, K., Real and Abstract Analysis, Graduate Texts in Math. 25, Springer-
Verlag, New York, 1965.
154. Hirschman, I. I. Jr., A convexity theorem for certain groups of transformations, J. Analyse
Math. 2 (1953), 209‚Äì218.
155. Hofmann, S., Weak (1,1) boundedness of singular integrals with nonsmooth kernel, Proc.
Amer. Math. Soc. 103 (1988), no. 1, 260‚Äì264.

References
623
156. Hollenbeck, B., Verbitsky, I. E., Best constants for the Riesz projection, J. Funct. Anal. 175
(2000), no. 2, 370‚Äì392.
157. Honz¬¥ƒ±k, P., An example of an unbounded maximal singular operator, J. Geom. Anal. 20
(2010), 153‚Äì167.
158. Honz¬¥ƒ±k, P., On p dependent boundedness of singular integral operators, Math. Z. 267 (2011),
no. 3‚Äì4, 931‚Äì937.
159. H¬®ormander, L., Estimates for translation invariant operators in Lp spaces, Acta Math. 104
(1960), no. 1‚Äì2, 93‚Äì140.
160. H¬®ormander, L., The Analysis of Linear Partial Differential Operators I, 2nd edition, Springer-
Verlag, Berlin, 1990.
161. HrusÀácev, S. V., A description of weights satisfying the A‚àûcondition of Muckenhoupt, Proc.
Amer. Math. Soc. 90 (1984), no. 2, 253‚Äì257.
162. Hudson, S., A covering lemma for maximal operators with unbounded kernels, Michigan
Math. J. 34 (1987), no. 1, 147‚Äì151.
163. Hunt, R., An extension of the Marcinkiewicz interpolation theorem to Lorentz spaces, Bull.
Amer. Math. Soc. 70 (1964), 803‚Äì807.
164. Hunt, R., On L(p,q) spaces, Einseignement Math. (2) 12 (1966), 249‚Äì276.
165. Hunt, R., On the convergence of Fourier series, Orthogonal Expansions and Their Contin-
uous Analogues (Proc. Conf., Edwardsville, IL, 1967), pp. 235‚Äì255, Southern Illinois Univ.
Press, Carbondale IL, 1968.
166. Hunt, R., Kurtz, D., Neugebauer, C. J., A note on the equivalence of Ap and Sawyer‚Äôs condi-
tion for equal weights, Conference on Harmonic Analysis in Honor of Antoni Zygmund, Vol.
I, II (Chicago, IL, 1981), pp. 156‚Äì158, Wadsworth Math. Ser., Wadsworth, Belmont, CA,
1983.
167. Hunt, R., Muckenhoupt, B., Wheeden, R., Weighted norm inequalities for the conjugate func-
tion and the Hilbert transform, Trans. Amer. Math. Soc. 176 (1973), 227‚Äì251.
168. Hyt¬®onen, T. P., The sharp weighted bound for general Calder¬¥on-Zygmund operators, Ann. of
Math. (2nd Ser.) 175 (2012), no.3, 1473‚Äì1506.
169. Hyt¬®onen, T. P., Lacey, M. T., P¬¥erez, C., Sharp weighted bounds for the q-variation of singular
integrals, Bull. Lond. Math. Soc. 45 (2013), no. 3, 529‚Äì540.
170. Hyt¬®onen, T. P., P¬¥erez, C., Sharp weighted bounds involving A‚àû, Anal. PDE 6 (2013), no. 4,
777‚Äì818.
171. Igari, S., Lectures on Fourier Series of Several Variables, Univ. Wisconsin Lecture Notes,
Madison, WI, 1968.
172. Ionescu, A. D., An endpoint estimate for the Kunze-Stein phenomenon and related maximal
operators, Ann. Math. (2) 152 ( 2000), no. 1, 259‚Äì275.
173. Iosevich, A., Sawyer, E., Maximal averages over surfaces, Adv. Math. 132 (1997), no. 1,
46‚Äì119.
174. Ismagilov, R. S., On the Pauli problem, Funct. Anal. Appl. 30 (1996), no. 2, 138‚Äì140.
175. Iwaniec, T., Martin, G., Riesz transforms and related singular integrals, J. Reine Angew.
Math. 473 (1996), 25‚Äì57.
176. Jessen, B., Marcinkiewicz, J., Zygmund, A., Note on the differentiability of multiple integrals,
Fund. Math. 25 (1935), 217‚Äì234.
177. Jodeit, M. Jr., Restrictions and extensions of Fourier multipliers, Studia Math. 34 (1970),
215‚Äì226.
178. Jodeit, M., A note on Fourier multipliers, Proc. Amer. Math. Soc. 27 (1971), 423‚Äì424.
179. Jones, P., Factorization of Ap weights, Ann. of Math. (2nd Ser.) 111 (1980), no. 3, 511‚Äì530.
180. Jordan, C., Sur la s¬¥erie de Fourier, Comptes Rendus Hebdomadaires des S¬¥eances de l‚Äô
Acad¬¥emie des Sciences 92 (1881), 228‚Äì230.
181. Journ¬¥e, J.- L., Calder¬¥on‚ÄìZygmund operators on product spaces, Rev. Mat. Iberoamericana 1
(1985), no. 3, 55‚Äì91.
182. Kahane, J.-P., The heritage of Fourier, Perspectives in Analysis, 83‚Äì95, Math. Phys. Stud.,
27, Springer, Berlin, 2005.
183. Kahane, J.-P., Katznelson, Y., Sur les ensembles de divergence des s¬¥eries trigonom¬¥etriques,
Studia Math. 26 (1966), 305‚Äì306.

624
References
184. Kaiser, G., A Friendly Guide to Wavelets, Birkh¬®auser, Boston, MA, 1994.
185. Kalton, N. J., Convexity, type, and the three space problem, Studia Math. 69 (1980/81), no.
3, 247‚Äì287.
186. Kalton, N. J., Plurisubharmonic functions on quasi-Banach spaces, Studia Math. 84 (1986),
no. 3, 297‚Äì323.
187. Kalton, N. J., Analytic functions in non-locally convex spaces and applications, Studia Math.
83 (1986), no. 3, 275‚Äì303.
188. Kalton, N. J., Peck, N. T., Roberts, J. W., An F-space Sampler, London Mathematical Society
Lecture Notes Series, 89, Cambridge University Press, Cambridge, 1984.
189. Katznelson, Y., Sur les ensembles de divergence des s¬¥eries trigonom¬¥etriques, Studia Math.
26 (1966), 301‚Äì304.
190. Katznelson, Y., An Introduction to Harmonic Analysis, 2nd corrected edition, Dover Publi-
cations, Inc., New York, 1976.
191. Kendall, D. G., On the number of lattice points inside a random oval, Quart. J. Math., Oxford
Ser. 19 (1948), 1‚Äì26.
192. Kenig, C., Tomas, P. A., Maximal operators deÔ¨Åned by Fourier multipliers, Studia Math. 68
(1980), no. 1, 79‚Äì83.
193. Khintchine, A., ¬®Uber dyadische Br¬®uche, Math. Z. 18 (1923), no. 1, 109‚Äì116.
194. Kislyakov, S., Kruglyak, N., Extremal Problems in Interpolation Theory, Whitney‚Äì
Besicovitch Coverings, and Singular Integrals, Birkh¬®user/Springer Basel AG, Basel, 2013.
195. Kolmogorov, A. N., Une s¬¥erie de Fourier‚ÄìLebesgue divergente presque partout, Fund. Math.
4 (1923), 324‚Äì328.
196. Kolmogorov, A. N., Une contribution `a l‚Äô ¬¥etude de la convergence des s¬¥eries de Fourier,
Fund. Math. 5 (1924), 96‚Äì97.
197. Kolmogorov, A. N., Sur les fonctions harmoniques conjugu¬¥ees et les s¬¥eries de Fourier, Fund.
Math. 7 (1925), 23‚Äì28.
198. Kolmogorov, A. N., Une s¬¥erie de Fourier‚ÄìLebesgue divergente partout, C. R. Acad. Sci. Paris
183 (1926), 1327‚Äì1328.
199. Kolmogorov, A. N., Zur Normierbarkeit eines topologischen Raumes, Studia Math. 5 (1934),
29‚Äì33.
200. Konyagin, S. V., On the divergence everywhere of trigonometric Fourier series, Sb. Math.
191 (2000), no. 1‚Äì2, 97‚Äì120.
201. Korenovskyy, A. A., Lerner, A. K., Stokolos, A. M., A note on the Gurov‚ÄìReshetnyak condi-
tion, Math. Res. Lett. 9 (2002), no. 5‚Äì6, 579‚Äì583.
202. K¬®orner, T. W., Fourier Analysis, Cambridge University Press, Cambridge, 1988.
203. Krantz, S. G., A panorama of Harmonic Analysis, Carus Mathematical Monographs, 27,
Mathematical Association of America, Washington, DC, 1999.
204. Krantz, S. G., Parks, H. R., The Geometry of Domains in Space, Birkh¬®auser Advanced Texts:
Basler Lehrb¬®ucher, Birkh¬®auser Boston, Inc., Boston, MA, 1999.
205. Krantz, S. G., Parks, H. R., A Primer of Real Analytic Functions, 2nd edition, Birkh¬®auser
Advanced Texts: Basler Lehrb¬®ucher, Birkh¬®auser Boston, Inc., Boston, MA, 2002.
206. Krivine, J. L., Th¬¥eor`emes de factorisation dans les espaces r¬¥eticul¬¥es, S¬¥eminaire Maurey-
Schwartz 1973‚Äì74: Espaces Lp, applications radoniÔ¨Åantes et g¬¥eom¬¥etrie des espaces de Ba-
nach, Exp. Nos. 22 et 23, Centre de Math., ¬¥Ecole Polytech., Paris, 1974.
207. Kruglyak, N., An elementary proof of the real version of the Riesz-Thorin theorem, Inter-
polation Theory and Applications, pp. 179‚Äì182, Contemp. Math. 445, Amer. Math. Soc.,
Providence, RI, 2007.
208. Kurtz, D., Operator estimates using the sharp function, PaciÔ¨Åc J. Math. 139 (1989), no. 2,
267‚Äì277.
209. Kurtz, D., Wheeden, R., Results on weighted norm inequalities for multipliers, Trans. Amer.
Math. Soc. 255 (1979), 343‚Äì362.
210. Lacey, M. T., Petermichl, S., Reguera, M. C., Sharp A2 inequality for Haar shift operators,
Math. Ann. 348 (2010), no. 1, 127‚Äì141.
211. Laeng, E., On the Lp norms of the Hilbert transform of a characteristic function, J. Funct.
Anal. 262 (2012), no. 10, 4534‚Äì4539.

References
625
212. Landau, E., Zur analytischen Zahlentheorie der deÔ¨Åniten quadratischen Formen ( ¬®Uber die
Gitterpunkte in einem mehrdimensionalen Ellipsoid), Berl. Sitzungsber. 31 (1915), 458‚Äì476;
reprinted in E. Landau ‚ÄúCollected Works,‚Äù Vol. 6, pp. 200‚Äì218, Thales-Verlag, Essen, 1986.
213. Lang, S., Real Analysis, 2nd edition, Addison-Wesley Publishing Company, Advanced Book
Program, Reading, MA, 1983.
214. Lebesgue, H., Int¬¥egrale, longeur, aire, Annali Mat. Pura Appl. 7 (1902), 231‚Äì359.
215. Lebesgue, H., Oeuvres ScientiÔ¨Åques (en cinq volumes), Vol. I, (French) Sous la r¬¥edaction de
F. ChÀÜatelet et G. Choquet, Institut de Math¬¥ematiques de l‚Äô Universit¬¥e de Gen`eve, Geneva,
1972.
216. Lemari¬¥e, P., Meyer, Y., Ondelettes et bases hilbertiennes, Rev. Mat. Iberoamericana 2 (1986),
no. 1‚Äì2, 1‚Äì18.
217. Lerner, A. K., On pointwise estimates for maximal and singular integral operators, Studia
Math. 138 (2000), no. 3, 285‚Äì291.
218. Lerner, A. K., An elementary approach to several results on the Hardy‚ÄìLittlewood maximal
operator, Proc. Amer. Math. Soc., 136 (2008), no. 8, 2829‚Äì2833.
219. Lerner, A. K., A pointwise estimate for the local sharp maximal function with applications to
singular integrals, Bull. London Math. Soc. 42 (2010), no. 5, 843‚Äì856.
220. Lerner, A. K., On an estimate of Calder¬¥on-Zygmund operators by dyadic positive operators,
J. Anal. Math. 121 (2013), 141‚Äì161.
221. Lerner, A. K., A simple proof of the A2 conjecture, Int. Math. Res. Not. IMRN 14 (2013),
3159‚Äì3170.
222. Lerner, A. K., Mixed Ap-Ar inequalities for classical singular integrals and Littlewood-Paley
operators, J. Geom. Anal. 23 (2013), no. 3, 1343‚Äì1354.
223. Lerner, A. K., Ombrosi, S., P¬¥erez, C., A1 bounds for Calder¬¥on‚ÄìZygmund operators related
to a problem of Muckenhoupt and Wheeden, Math. Res. Lett. 16 (2009), no. 1, 149‚Äì156.
224. Liang, Y. Y., Liu, L. G., Yang, D. C., An Off-diagonal Marcinkiewicz interpolation theorem
on Lorentz spaces, Acta Math. Sin. (Engl. Ser.) 27 (2011), no. 8, 1477‚Äì1488.
225. Lions, J.-L., Peetre, J., Sur une classe d‚Äôespaces d‚Äô interpolation, Inst. Hautes ¬¥Etudes Sci.
Publ. Math. No. 19 (1964), 5‚Äì68.
226. Littlewood, J. E., On a certain bilinear form, Quart. J. Math. Oxford Ser. 1 (1930), 164‚Äì174.
227. Littlewood, J. E., Paley, R. E. A. C., Theorems on Fourier series and power series, J. London
Math. Soc. 6 (1931), no. 3, 230‚Äì233.
228. Littlewood, J. E., Paley, R. E. A. C., Theorems on Fourier series and power series (II), Proc.
London Math. Soc. 42 (1936), no. 1, 52‚Äì89.
229. Littlewood, J. E., Paley, R. E. A. C., Theorems on Fourier series and power series (III), Proc.
London Math. Soc. 43 (1937), no. 2, 105‚Äì126.
230. Loomis, L. H., A note on the Hilbert transform, Bull. Amer. Math. Soc. 52 (1946),
1082‚Äì1086.
231. Loomis, L. H., Whitney, H., An inequality related to the isoperimetric inequality, Bull. Amer.
Math. Soc. 55 (1949), 961‚Äì962.
232. Lorentz, G. G., Some new function spaces, Ann. of Math. (2nd Ser.) 51 (1950), no. 1, 37‚Äì55.
233. Lorentz, G. G., On the theory of spaces Œõ, PaciÔ¨Åc. J. Math. 1 (1951), 411‚Äì429.
234. Lu, S., Ding, Y., Yan, D., Singular Integrals and Related Topics, World ScientiÔ¨Åc Publishing
Co. Pte. Ltd., Hackensack, NJ, 2007.
235. Luzin, N., Sur la convergence des s¬¥eries trigonom¬¥etriques de Fourier, C. R. Acad. Sci. Paris
156 (1913), 1655‚Äì1658.
236. Lyapunov, A., Sur les fonctions-vecteurs compl`etement additives [Russian], Izv. Akad. Nauk
SSSR Ser. Mat. 4 (1940), 465‚Äì478.
237. Magyar, A., Stein, E. M., Wainger, S., Discrete analogues in harmonic analysis: spherical
averages, Ann. of Math. (2nd Ser.) 155 (2002), no. 1, 189‚Äì208.
238. Mallat, S., Multiresolution approximations and wavelet orthonormal bases of L2(R), Trans.
Amer. Math. Soc. 315 (1989), no. 1, 69‚Äì87.
239. Mallat, S., A Wavelet Tour of Signal Processing, Academic Press, Inc., San Diego, CA, 1998.
240. Marcinkiewicz, J., Sur l‚Äôinterpolation d‚Äôoperations, C. R. Acad. Sci. Paris 208 (1939),
1272‚Äì1273.

626
References
241. Marcinkiewicz, J., Sur les multiplicateurs des s¬¥eries de Fourier, Studia Math. 8 (1939),
78‚Äì91.
242. Marcinkiewicz, J., Zygmund, A., Quelques in¬¥egalit¬¥es pour les op¬¥erations lin¬¥eaires, Fund.
Math. 32 (1939), 112‚Äì121.
243. Marcinkiewicz, J., Zygmund, A., On the summability of double Fourier series, Fund. Math.
32 (1939), 122‚Äì132.
244. Mateu, J., Orobitg, J., Verdera, J., Estimates for the maximal singular integral in terms of
the singular integral: the case of even kernels, Ann. of Math. (2nd Ser.) 174 (2011), no. 3,
1429‚Äì1483.
245. Mateu, J., Verdera, J., Lp and weak L1 estimates for the maximal Riesz transform and the
maximal Beurling transform, Math. Res. Lett. 13 (2006), no. 5‚Äì6, 957‚Äì966.
246. Mattila, P., Geometry of sets and measures in Euclidean spaces. Fractals and rectiÔ¨Åability,
Cambridge Studies in Advanced Mathematics, 44, Cambridge University Press, Cambridge,
1995.
247. Maurey, B., Th¬¥eor`emes de factorization pour les op¬¥erateurs lin¬¥eaires `a valeurs dans les es-
pace Lp, Ast¬¥erisque, No. 11, Soci¬¥et¬¥e Math¬¥ematique de France, Paris, 1974.
248. Melas, A., The best constant for the centered Hardy‚ÄìLittlewood maximal inequality, Ann. of
Math. (2nd Ser.) 157 (2003), no. 2, 647‚Äì688.
249. Meyer, Y., Principe d‚Äô incertitude, bases hilbertiennes et alg`ebres d‚Äô op¬¥erateurs, S¬¥eminaire
Bourbaki, Vol. 1985/86, Ast¬¥erisque No. 145-146 (1987) 4, 209‚Äì223.
250. Meyer, Y., Ondelettes et Op¬¥erateurs, I, Ondelletes, Hermann, Paris, 1990.
251. Meyer, Y., Ondelettes et Op¬¥erateurs, II, Op¬¥erateurs de Calder¬¥on-Zygmund, Hermann, Paris,
1990.
252. Meyer, Y., Wavelets, Vibrations, and Scalings, CRM Monograph Series, 9, American Math-
ematical Society, Providence, RI, 1998.
253. Meyer, Y., Coifman, R. R., Ondelettes et Op¬¥erateurs, III, Op¬¥erateurs multilin¬¥eaires , Her-
mann, Paris, 1991.
254. Mihlin, S. G., On the multipliers of Fourier integrals [Russian], Dokl. Akad. Nauk. SSSR
(N.S.) 109 (1956), 701‚Äì703.
255. Miyachi, A., On some singular Fourier multipliers, J. Fac. Sci. Univ. Tokyo Sect. IA Math.
28 (1981), no. 2, 267‚Äì315.
256. Mockenhaupt, G., Seeger, A., Sogge, C., Wave front sets, local smoothing and Bourgain‚Äôs
circular maximal theorem, Ann. of Math. (2nd Ser.) 136 (1992), no. 1, 207‚Äì218.
257. Moon, K. H., On restricted weak type (1,1), Proc. Amer. Math. Soc. 42 (1974), 148‚Äì152.
258. Morse, A. P., Perfect blankets, Trans. Amer. Math. Soc. 69 (1947), 418‚Äì442.
259. Muckenhoupt, B., On certain singular integrals, PaciÔ¨Åc J. Math. 10 (1960), 239‚Äì261.
260. Muckenhoupt, B., Weighted norm inequalities for the Hardy maximal function, Trans. Amer.
Math. Soc. 165 (1972), 207‚Äì226.
261. Muckenhoupt, B., The equivalence of two conditions for weight functions, Studia Math. 49
(1973/1974), 101‚Äì106.
262. Muckenhoupt, B., Wheeden, R. L., Two weight function norm inequalities for the Hardy‚Äì
Littlewood maximal function and the Hilbert transform, Studia Math. 55 (1976), no. 3,
279‚Äì294.
263. M¬®uller, D., A geometric bound for maximal functions associated to convex bodies, PaciÔ¨Åc J.
Math. 142 (1990), no. 2, 297‚Äì312.
264. Nagel, A., Stein, E. M., Wainger, S., Differentiation in lacunary directions, Proc. Nat. Acad.
Sci. U.S.A. 75 (1978), no. 3, 1060‚Äì1062.
265. Nazarov, F., Reznikov, A., Vasyunin, V., Volberg, A., A1 conjecture: weak norm estimates of
weighted singular integrals and Bellman functions, http://sashavolberg.wordpress.com
266. Nazarov, F., Treil, S., Volberg, A., The Bellman functions and two-weight inequalities for
Haar multipliers, J. Amer. Math. Soc. 12 (1999), no. 4, 909‚Äì928.
267. Nazarov, F., Treil, S., Volberg, A., Bellman function in stochastic control and harmonic anal-
ysis, Systems, Approximation, Singular Integral Operators, and Related Topics (Bordeaux,
2000), pp. 393‚Äì423, Oper. Theory Adv. Appl. 129, Birkh¬®auser, Basel, 2001.

References
627
268. Nazarov, F., Treil, S., Volberg, A., Two weight inequalities for individual Haar multipliers
and other well localized operators, Math. Res. Lett. 15 (2008), no. 3, 583‚Äì597.
269. Nguyen, H. V., A maximal Fourier integral operator and an application, J. of Pseudodiffen-
tial Operators 4 (2013), 443‚Äì456.
270. Nyquist, H., Certain topics in telegraph transmission theory, Trans. AIEE 47 (Apr. 1928),
617‚Äì64.
271. Olver, F. W. J., Asymptotics and Special Functions, Academic Press, New York, London,
1974.
272. Orobitg, J., P¬¥erez, C., Ap weights for nondoubling measures in Rn and applications, Trans.
Amer. Math. Soc. 354 (2002), no. 5, 2013‚Äì2033 (electronic).
273. Paley, R. E. A. C., A remarkable series of orthogonal functions (II), Proc. London Math. Soc.
34 (1932), 241‚Äì264.
274. Paley, R. E. A. C., Zygmund, A., On some series of functions, Proc. Cambridge Phil. Soc. 26
(1930), 337‚Äì357.
275. Peetre, J., Nouvelles propri¬¥et¬¥es d‚Äô espaces d‚Äô interpolation, C. R. Acad. Sci. Paris 256 (1963),
1424‚Äì1426.
276. Pereyra, M. C., Lecture Notes on Dyadic Harmonic Analysis, Second Summer School in
Analysis and Mathematical Physics (Cuernavaca, 2000), pp. 1‚Äì60, Contemp. Math., 289,
American Mathematical Society, Providence, RI, 2001.
277. P¬¥erez, C., Weighted norm inequalities for singular integral operators, J. London Math. Soc.
(2) 49 (1994), no. 2, 296‚Äì308.
278. P¬¥erez, C., Some topics from Calder¬¥on‚ÄìZygmund theory related to Poincar¬¥e-Sobolev inequal-
ities, fractional integrals and singular integral operators, Function Spaces Lectures, Spring
School in Analysis, pp. 31‚Äì94, Jaroslav LukeÀás and LuboÀás Pick (eds.), Paseky, 1999.
279. Petermichl, S., The sharp bound for the Hilbert transform on weighted Lebesgue spaces in
terms of the classical Ap characteristic, Amer. J. Math. 129 (2007), no. 5, 1355‚Äì1375.
280. Petermichl, S., The sharp weighted bound for the Riesz transforms, Proc. Amer. Math. Soc.
136 (2008), no. 4, 1237‚Äì1249.
281. Petermichl, S., Volberg, A., Heating of the Ahlfors-Beurling operator: weakly quasiregular
maps on the plane are quasiregular, Duke Math. J. 112 (2002), no. 2, 281‚Äì305.
282. Pichorides, S., On the best values of the constants in the theorems of M. Riesz, Zygmund and
Kolmogorov, Studia Math. 44 (1972), 165‚Äì179.
283. Pinsky, M., Introduction to Fourier Analysis and Wavelets, Graduate Studies in Mathematics
102, American Mathematical Society, Providence, RI, 2009.
284. Pinsky, M., Stanton, N. K., Trapa, P. E., Fourier series of radial functions in several variables,
J. Funct. Anal. 116 (1993), no. 1, 111‚Äì132.
285. Plancherel, M., P¬¥olya, G., Fonctions enti`eres et int¬¥egrales de fourier multiples, Comment.
Math. Helv. 10 (1937), no. 1, 110‚Äì163.
286. Reed, M., Simon, B., Methods of Modern Mathematical Physics, II, Fourier analysis, self-
adjointness, Academic Press, New York, London, 1975.
287. Reguera, M. C., On Muckenhoupt-Wheeden conjecture, Adv. Math. 227 (2011), no. 4, 1436‚Äì
1450.
288. Reguera, M., C., Thiele, C., The Hilbert transform does not map L1(Mw) to L1,‚àû(w), Math.
Res. Lett. 19 (2012), no. 1, 1‚Äì7.
289. Ricci, F., Weiss, G., A characterization of H1(Œ£n‚àí1), Harmonic Analysis in Euclidean Spaces
Proc. Sympos. Pure Math. (Williams Coll., Williamstown, MA, 1978), Part 1, pp. 289‚Äì294,
Amer. Math. Soc., Providence, RI, 1979.
290. Riesz, F., Untersuchungen ¬®uber Systeme integrierbarer Funktionen, Math. Ann. 69 (1910),
no. 4, 449‚Äì497.
291. Riesz, F., Sur un th¬¥eor`eme du maximum de Mm. Hardy et Littlewood, J. London Math. Soc.
7 (1932), 10‚Äì13.
292. Riesz, M., Les fonctions conjugu¬¥ees et les s¬¥eries de Fourier, C. R. Acad. Sci. Paris 178 (1924),
1464‚Äì1467.
293. Riesz, M., Sur les maxima des formes bilin¬¥eaires et sur les fonctionnelles lin¬¥eaires, Acta
Math. 49 (1927), no. 3-4, 465‚Äì497.

628
References
294. Riesz, M., Sur les fonctions conjugu¬¥ees, Math. Z. 27 (1928), no. 1, 218‚Äì244.
295. Riesz, M., L‚Äôint¬¥egrale de Riemann‚ÄìLiouville et le probl`eme de Cauchy, Acta Math. 81 (1949),
no. 1, 1‚Äì223.
296. Riviere, N., Singular integrals and multiplier operators, Ark. Mat. 9 (1971), 243‚Äì278.
297. Rolewicz, S., Metric Linear Spaces, 2nd edition, Mathematics and its Applications (East Eu-
ropean Series), 20. D. Reidel Publishing Co., Dordrecht; PWN‚ÄìPolish ScientiÔ¨Åc Publishers,
Warsaw, 1985.
298. Rosenblum, M., Summability of Fourier series in Lp(dŒº), Trans. Amer. Math. Soc. 105
(1962), 32‚Äì42.
299. Rubio de Francia, J.-L., Weighted norm inequalities and vector valued inequalities, Harmonic
Analysis (Minneapolis, MN, 1981), pp. 86‚Äì101, Lect. Notes in Math. 908, Springer, Berlin,
New York, 1982.
300. Rubio de Francia, J.-L., Factorization theory and Ap weights, Amer. J. Math. 106 (1984), no.
3, 533‚Äì547.
301. Rubio de Francia, J.-L., A Littlewood‚ÄìPaley inequality for arbitrary intervals, Rev. Mat.
Iberoamericana 1 (1985), no. 2, 1‚Äì14.
302. Rubio de Francia, J.-L., Maximal functions and Fourier transforms, Duke Math. J. 53 (1986),
no. 2, 395‚Äì404.
303. Rubio de Francia, J.-L., Ruiz, F. J., Torrea, J. L., Calder¬¥on‚ÄìZygmund theory for operator-
valued kernels, Adv. in Math. 62 (1986), no. 1, 7‚Äì48.
304. Rubio de Francia, J.-L., Torrea, J. L., Vector extensions of operators in Lp spaces, PaciÔ¨Åc J.
Math. 105 (1983), no. 1, 227‚Äì235.
305. Rudin, W., Trigonometric series with gaps, J. Math. Mech. 9 (1960), 203‚Äì227.
306. Rudin, W., Functional Analysis, Tata McGraw-Hill Publishing Company, New Delhi, 1973.
307. Rudin, W., Real and Complex Analysis, 2nd edition, Tata McGraw-Hill Publishing Company,
New Delhi, 1974.
308. Ryabogin, D., Rubin, B., Singular integrals generated by zonal measures, Proc. Amer. Math.
Soc. 130 (2002), no. 3, 745‚Äì751.
309. Sadosky, C., Interpolation of Operators and Singular Integrals, Marcel Dekker Inc., New
York, 1979.
310. Saks, S., Theory of the Integral, Hafner Publ. Co, New York, 1938.
311. Sato, S., Note on a Littlewood‚ÄìPaley operator in higher dimensions, J. London Math. Soc.
(2) 42 (1990), no. 3, 527‚Äì534.
312. Sawyer, E., A characterization of a two-weight norm inequality for maximal operators, Studia
Math. 75 (1982), no. 1, 1‚Äì11.
313. Schlag, W., A geometric proof of the circular maximal theorem, Duke Math. J. 93 (1998), no.
3, 505‚Äì533.
314. Schwartz, L., Th¬¥eorie de Distributions. Tome I, Hermann & Cie, Paris, 1950.
315. Schwartz, L., Th¬¥eorie de Distributions. Tome II, Hermann & Cie, Paris, 1951.
316. Seeger, A., Some inequalities for singular convolution operators in Lp-spaces, Trans. Amer.
Math. Soc. 308 (1988), no. 1, 259‚Äì272.
317. Seeger, A., Singular integral operators with rough convolution kernels, J. Amer. Math. Soc.
9 (1996), no. 1, 95‚Äì105.
318. Seeger, A., Tao, T., Sharp Lorentz estimates for rough operators, Math. Ann. 320 (2001), no.
2, 381‚Äì415.
319. Shannon, C. E., Communication in the presence of noise, Proc. I.R.E. 37 (1949), 10‚Äì21.
320. Shapiro, V. L., Fourier series in several variables, Bull. Amer. Math. Soc. 70 (1964), 48‚Äì93.
321. Shapiro, V. L., Fourier series in several variables with applications to partial differential
equations, Chapman & Hall/CRC Applied Mathematics and Nonlinear Science Series, CRC
Press, Boca Raton, FL, 2011.
322. Siegel, A., Historical review of the isoperimetric theorem in 2-D, and its place in elementary
plane geometry, http://www.cs.nyu.edu/faculty/siegel/SCIAM.pdf
323. Sj¬®ogren, P., A remark on the maximal function for measures in Rn, Amer. J. Math. 105 (1983),
no. 5, 1231‚Äì1233

References
629
324. Sj¬®ogren, P., Soria, F., Rough maximal operators and rough singular integral operators ap-
plied to integrable radial functions, Rev. Math. Iberoamericana 13 (1997), no. 1, 1‚Äì18.
325. Sj¬®olin, P., Convergence almost everywhere of certain singular integrals and multiple Fourier
series, Ark. Math. 9 (1971), 65‚Äì90.
326. Sj¬®olin, P., A note on Littlewood‚ÄìPaley decompositions with arbitrary intervals, J. Approx.
Theory 48 (1986), no. 3, 328‚Äì334.
327. Sj¬®olin, P., Soria, F., Remarks on a theorem by N. Yu. Antonov, Studia Math. 158 (2003), no.
1, 79‚Äì97.
328. Sogge, C., Fourier Integrals in Classical Analysis, Cambridge Tracts in Mathematics, 105,
Cambridge University Press, Cambridge, 1993.
329. Soria, F., A note on a Littlewood‚ÄìPaley inequality for arbitrary intervals in R2, J. London
Math. Soc. (2) 36 (1987), no. 1, 137‚Äì142.
330. Soria, F., On an extrapolation theorem of Carleson-Sj¬®olin with applications to a.e. conver-
gence of Fourier series, Studia Math. 94 (1989), no. 3, 235‚Äì244.
331. Stein, E. M., Interpolation of linear operators, Trans. Amer. Math. Soc. 83 (1956), 482‚Äì492.
332. Stein, E. M., Note on singular integrals, Proc. Amer. Math. Soc. 8 (1957), 250‚Äì254.
333. Stein, E. M., Localization and summability of multiple Fourier series, Acta Math. 100 (1958),
no. 1‚Äì2, 93‚Äì147.
334. Stein, E. M., On the functions of Littlewood‚ÄìPaley, Lusin, and Marcinkiewicz, Trans. Amer.
Math. Soc. 88 (1958), 430‚Äì466.
335. Stein, E. M., On limits of sequences of operators, Ann. of Math. (2nd Ser.) 74 (1961), no. 1,
140‚Äì170.
336. Stein, E. M., Note on the class LlogL, Studia Math. 32 (1969), 305‚Äì310.
337. Stein, E. M., Topics in Harmonic Analysis Related to the Littlewood‚ÄìPaley Theory, Annals
of Mathematics Studies, No. 63, Princeton University Press, Princeton, NJ, 1970.
338. Stein, E. M., Singular Integrals and Differentiability Properties of Functions, Princeton
Mathematical Series, No. 30, Princeton University Press, Princeton, NJ, 1970.
339. Stein, E. M., Maximal functions I: Spherical means, Proc. Nat. Acad. Sci. U.S.A. 73 (1976),
no. 7, 2174‚Äì2175.
340. Stein, E. M., The development of square functions in the work of A. Zygmund, Bull. Amer.
Math. Soc. (N.S.) 7 (1982), no. 2, 359‚Äì376.
341. Stein, E. M., Some results in harmonic analysis in Rn, for n ‚Üí‚àû, Bull. Amer. Math. Soc.
(N.S.) 9 (1983), no. 1, 71‚Äì73.
342. Stein, E. M., Boundary behavior of harmonic functions on symmetric spaces: Maximal esti-
mates for Poisson integrals, Invent. Math. 74 (1983), no. 1, 63‚Äì83.
343. Stein, E. M., Oscillatory integrals in Fourier analysis, Beijing Lectures in Harmonic Analysis
(Beijing, 1984), pp. 307‚Äì355, Annals of Math. Studies 112, Princeton Univ. Press, Princeton,
NJ, 1986.
344. Stein, E. M., Harmonic Analysis, Real Variable Methods, Orthogonality, and Oscillatory In-
tegrals, Princeton Mathematical Series, 43, Monographs in Harmonic Analysis, III, Princeton
University Press, Princeton, NJ, 1993.
345. Stein, E. M., Str¬®omberg, J.-O., Behavior of maximal functions in Rn for large n, Ark. Math.
21 (1983), no. 2, 259‚Äì269.
346. Stein, E. M., Weiss, G., Interpolation of operators with change of measures, Trans. Amer.
Math. Soc. 87 (1958), 159‚Äì172.
347. Stein, E. M., Weiss, G., An extension of theorem of Marcinkiewicz and some of its applica-
tions, J. Math. Mech. 8 (1959), 263‚Äì284.
348. Stein, E. M., Weiss, G., Introduction to Fourier Analysis on Euclidean Spaces, Princeton
Mathematical Series, No. 32, Princeton University Press, Princeton, NJ, 1971.
349. Stein, E. M., Weiss, N. J., On the convergence of Poisson integrals, Trans. Amer. Math. Soc.
140 (1969), 34‚Äì54.
350. Stein, P., On a theorem of M. Riesz, J. London Math. Soc. 8 (1933), no. 4, 242‚Äì247.
351. Stepanov, V. D., Convolution integral operators [Russian], Dokl. Akad. Nauk SSSR 243
(1978), no. 1, 45‚Äì48.

630
References
352. Str¬®omberg, J.-O., A modiÔ¨Åed Franklin system and higher-order spline systems on Rn as un-
conditional bases for Hardy spaces, Conference on Harmonic Analysis in Honor of Antoni
Zygmund, Vol. I, II (Chicago, IL, 1981), pp. 475‚Äì494, Wadsworth Math. Ser., Wadsworth,
Belmont, CA, 1983.
353. Szarek, S. J., On the best constant in the Khinchin inequality, Studia Math. 58 (1976), no. 2,
197‚Äì208.
354. Tamarkin, J. D., Zygmund, A., Proof of a theorem of Thorin, Bull. Amer. Math. Soc. 50
(1944), 279‚Äì282.
355. Tao, T., The weak type (1,1) of LlogL homogeneous convolution operators, Indiana Univ.
Math. J. 48 (1999), no. 4, 1547‚Äì1584.
356. Tao, T., A converse extrapolation theorem for translation-invariant operators, J. Funct. Anal.
180 (2001), no. 1, 1‚Äì10.
357. Tao, T., Wright, J., Endpoint multiplier theorems of Marcinkiewicz type, Rev. Mat. Iberoamer-
icana 17 (2001), no. 3, 521‚Äì558.
358. Tauber, A., Ein Satz aus der Theorie der unendlichen Reihen Monatsh. Math. Phys. 8 (1897),
no. 1, 273‚Äì277.
359. Tevzadze, N. R., The convergence of the double Fourier series of quadratic at a square
summable function, Sakharth. SSR Mecn. Akad. Moambe 58 (1970), 277‚Äì279.
360. Thorin, G. O., An extension of a convexity theorem due to M. Riesz, Fys. S¬®aellsk. F¬®orh. 8
(1938), No. 14.
361. Thorin, G. O., Convexity theorems generalizing those of M. Riesz and Hadamard with some
applications, Comm. Sem. Math. Univ. Lund [Medd. Lunds Univ. Mat. Sem.] 9 (1948), 1‚Äì58.
362. Titchmarsh, E. C., The Theory of the Riemann Zeta Function, Oxford, at the Clarendon Press,
1951.
363. Torchinsky, A., Real-Variable Methods in Harmonic Analysis, Pure and Applied Mathemat-
ics, 123, Academic Press, Inc., Orlando, FL, 1986.
364. van der Corput, J. G., Zahlentheoretische Absch¬®atzungen, Math. Ann. 84 (1921), no. 1‚Äì2,
53‚Äì79.
365. Vargas, A., On the maximal function for rotation invariant measures in Rn, Studia Math. 110
(1994), no. 1, 9‚Äì17.
366. Verbitsky, I. E., Estimate of the norm of a function in a Hardy space in terms of the norms of
its real and imaginary part, Amer. Math. Soc. Transl. 124 (1984), 11‚Äì15.
367. Verbitsky, I. E., Weighted norm inequalities for maximal operators and Pisier‚Äôs theorem on
factorization through Lp‚àû, Integral Equations Operator Theory 15 (1992), no. 1, 124‚Äì153.
368. Vitali, G., Sui gruppi di punti e sulle funzioni di variabili reali, Atti Accad. Sci. Torino 43
(1908), 229‚Äì246.
369. Von Neuman, J., Zur Theorie des Gesellschaftsspiele, Math. Ann. 100 (1928), 295‚Äì320.
370. Wainger, S., Special trigonometric series in k dimensions, Mem. Amer. Math. Soc. 59, 1965.
371. Watson, G. N., A Treatise on the Theory of Bessel Functions, Cambridge University Press,
Cambridge, England, The Macmillan Company, New York, 1944.
372. Weiss, M., Zygmund, A., An example in the theory of singular integrals, Studia Math. 26
(1965), 101‚Äì111.
373. Whitney, H., Analytic extensions of differentiable functions deÔ¨Åned in closed sets, Trans.
Amer. Math. Soc. 36 (1934), no. 1, 63‚Äì89.
374. Wickerhauser, M. V., Adapted Wavelet Analysis from Theory to Software, A. K. Peters, Ltd.,
Wellesley, MA, 1994.
375. Wiener, N., The ergodic theorem, Duke Math. J. 5 (1939), no. 1, 1‚Äì18.
376. Wilbraham, H., On a certain periodic function, The Cambridge and Dublin Mathematical
Journal, 3 (1848), 198‚Äì201.
377. Wilson, J. M., Weighted norm inequalities for the continuous square function, Trans. Amer.
Math. Soc. 314 (1989), no. 2, 661‚Äì692.
378. Wilson, M., Weighted Littlewood‚ÄìPaley Theory and Exponential-Square Integrability, Lec-
ture Notes in Mathematics, 1924 Springer, Berlin, 2008.
379. Wojtaszczyk, P., A Mathematical Introduction to Wavelets, London Mathematical Society
Student Texts 37, Cambridge University Press, Cambridge, 1997.

References
631
380. Yano, S., Notes on Fourier analysis, XXIX, An extrapolation theorem, J. Math. Soc. Japan 3
(1951), 296‚Äì305.
381. Yanushauskas, A. I., Multiple trigonometric series [Russian], ‚ÄùNauka‚Äù Sibirsk. Otdel.,
Novosibirsk, 1986.
382. Yosida, K., Functional Analysis, Reprint of the 6th edition (1980), Classics in Mathematics
Springer-Verlag, Berlin, 1995.
383. Zhizhiashvili, L. V., Some problems in the theory of simple and multiple trigonometric and
orthogonal series, Russian Math. Surveys, 28 (1973), 65‚Äì127.
384. Zhizhiashvili, L. V., Trigonometric Fourier Series and Their Conjugates, Mathematics and
Its Applications, 372, Kluwer Academic Publishers Group, Dordrecht,1996.
385. Ziemer, W. P., Weakly Differentiable Functions, Sobolev Spaces and Functions of Bounded
Variation, Graduate Texts in Mathematics, 120, Springer-Verlag, New York, 1989.
386. Zo, F., A note on approximation of the identity, Studia Math. 55 (1976), no. 2, 111‚Äì122.
387. Zygmund, A., On a theorem of Marcinkiewicz concerning interpolation of operators, J. Math.
Pures Appl. (9) 35 (1956), 223‚Äì248.
388. Zygmund, A., Trigonometric Series, Vol. I, 2nd edition, Cambridge University Press, New
York, 1959.
389. Zygmund, A., Trigonometric Series, Vol. II, 2nd edition, Cambridge University Press, New
York, 1959.
390. Zygmund, A., Notes on the history of Fourier series, Studies in harmonic analysis, (Proc.
Conf. DePaul Univ., Chicago, IL, 1974) pp. 1‚Äì19, MAA Stud. Math., Vol. 13, Math. Assoc.
Amer., Washington, DC, 1976.

Index
C k functions on the torus, 175
œÉ-Ô¨Ånite, 2
absolutely summable Fourier series, 200
adjoint of an operator, 150
admissible growth, 40
almost everywhere convergence, 285
almost orthogonality, 459, 471
analytic family of operators, 40
Aoki‚ÄìRolewicz theorem, 76
A1 condition, 502
Ap condition, 503
necessity of, 543
approximate identity, 26
asymptotics
of Bessel function, 580
asymptotics of gamma function, 567
atom
in a measure space, 56
bad function, 356
Banach‚ÄìAlaoglou theorem, 601
Banach-valued extension of a linear operator,
391
Banach-valued extension of an operator, 396
Banach-valued measurable function, 392
Banach-valued singular integral, 402
band limited function, 490
Bernoulli polynomials, 299
Bernstein‚Äôs inequality, 133
Bernstein‚Äôs theorem, 191
Bessel function, 168, 573
asymptotics, 580
large arguments, 579
small arguments, 578
beta function, 564
beta integral identity, 145
Boas and Bochner inequality, 391
Bochner integral, 394
Bochner‚ÄìRiesz means, 244
Bochner‚ÄìRiesz operator, 244
Borel measures, 2
bounded variation, 199
BV, functions of bounded variation, 199
Calder¬¥on‚ÄìZygmund operator, 532
Calder¬¥on‚ÄìZygmund decomposition, 356
Calder¬¥on‚ÄìZygmund decomposition on Lq, 373
Calder¬¥on‚ÄìZygmund operator
maximal, 533
cancellation condition
for a kernel, 375
Carleson operator, 286
Cauchy sequence in measure, 9
centered Hardy‚ÄìLittlewood maximal function,
86
centered maximal function with respect to
cubes, 99
Ces`aro means, 184, 216
characteristic constant of a pair of weights, 524
Characteristic constant of a weight
Ap, 503
characteristic constant of a weight
A1, 503
characterization
of A1 weights, 519
of A‚àûweights, 527, 531
Chebyshev‚Äôs inequality, 6
circular Dirichlet kernel, 178
circular means, 250
circular partial sum, 184
class (Ap,Ap), 524
class of A1 weights, 502
class of Ap weights, 503
L. Grafakos, Classical Fourier Analysis, Graduate Texts in Mathematics 249,
DOI 10.1007/978-1-4939-1194-3, ¬© Springer Science+Business Media New York 2014
633

634
Index
closed
under translations, 146
closed graph theorem, 602
commutes with translations, 146
compactly supported distribution, 120
complete orthonormal system, 185
completeness
of Lorentz spaces, 54
completeness of Lp, p < 1, 13
conditional expectation, 464
cone multiplier, 158
conjugate function, 245
conjugate harmonic, 318
conjugate harmonic functions, 253
conjugate Poisson kernel, 253, 318, 331
continuously differentiable function
of order N, 104
continuously differentiable functions
on the torus, 175
convergence
in C ‚àû
0 , 119
in S , 106, 119
in Lp, 7
in C ‚àû, 119
in measure, 6
in weak Lp, 7
convex sequence, 193
convolution, 20, 125
Cotlar‚Äôs inequality, 364
countably simple, 56
countably simple function, 2
countably subadditive operator, 47
covering lemma, 88
critical Bochner‚ÄìRiesz index, 252
critical point, 162
Darboux‚Äôs equation, 476
de la Vall¬¥ee Poussin kernel, 182
decay of Fourier coefÔ¨Åcients, 193
decomposition of open sets, 609
decreasing rearrangement, 48
of a simple function, 49
degree of a trigonometric polynomial, 177
deLeeuw‚Äôs theorem, 157
derivative
of a distribution, 123
of a function (partial), 104
differentiation
of approximate identities, 96
theory, 93
dilation
L1 dilation, 90
of a function, 109
of a tempered distribution, 124
Dini condition, 384
Dini‚Äôs theorem, 212
Dirac mass, 121
directional Hilbert transform, 339
Dirichlet kernel, 178
Dirichlet problem, 92
on the sphere, 144
distribution, 120
homogeneous, 132, 136
of lattice points, 305
supported at a point, 134
tempered, 120
with compact support, 120, 129
distribution function, 3
of a simple function, 4
distributional derivative, 123
divergence
of Bochner‚ÄìRiesz means at the critical
index, 261
of the Fourier series of a continuous
function, 210
of the Fourier series of an L1 function, 255
doubling condition
on a measure, 98
doubling measure, 98, 505
doubly truncated kernel, 363
doubly truncated singular integrals, 363
duals of Lorentz spaces, 57
duBois Reymond‚Äôs theorem, 210
duplication formula
for the gamma function, 570
dyadic cube, 464
dyadic decomposition, 428
dyadic interval, 464
dyadic martingale difference operator, 465
dyadic martingale square function, 469
dyadic maximal function, 103
dyadic spherical maximal function, 461
eigenvalues
of the Fourier transform, 116
equidistributed, 48
equidistributed sequence, 302
essential inÔ¨Åmum, 502
Euler‚Äôs constant, 569
Euler‚Äôs limit formula for the gamma function,
568
inÔ¨Ånite product form, 569
expectation
conditional, 464
extrapolation, 47
extrapolation theorem, 548, 553
factorization of Ap weights, 546
Fej¬¥er kernel, 27, 180

Index
635
Fej¬¥er means, 184
Fej¬¥er‚Äôs theorem, 205
Ô¨Ånite Borel measure, 2
Ô¨Ånitely simple function, 2
Fourier coefÔ¨Åcient, 175
of a measure, 175
Fourier inversion, 112, 185
on L1, 117
on L2, 114
Fourier multiplier, 155
Fourier series, 176
Fourier transform
of a radial function, 577
of a Schwartz function, 108
of surface measure, 577
on L1, 113
on L2, 113
on Lp, 1 < p < 2, 114
properties of, 109
Fr¬¥echet space, 106
frame
tight, 496
Fresnel integral, 145
fundamental solution, 135
fundamental theorem of algebra, 143
g-function, 461, 477
gamma function, 563
asymptotics, 567
duplication formula, 570
meromorphic extension, 566
generalized Cauchy-Riemann equations, 332
good function, 356, 372
good lambda inequality, 533
consequences of, 539
gradient, 104
gradient condition
for a kernel, 359
Green‚Äôs identity, 135
H¬®older condition, 384
H¬®older‚Äôs inequality, 3, 11
for weak spaces, 16
H¬®ormander‚Äôs condition, 359
H¬®ormander‚ÄìMihlin multiplier theorem, 446
Haar function, 465
Haar measure, 18
Haar wavelet, 483
Hadamard‚Äôs three lines lemma, 39
Hahn‚ÄìBanach theorem, 601
Hardy‚Äôs inequalities, 31
Hardy‚ÄìLittlewood maximal function
centered, 86
uncentered, 87
harmonic distribution, 135
harmonic function, 92
Hausdorff‚ÄìYoung, 191
Hausdorff‚ÄìYoung inequality, 114
heat equation, 295
heat kernel, 296
Heisenberg group, 19
Hilbert transform, 314
maximal, 322, 339
maximal directional, 339
truncated, 314
Hirschman‚Äôs lemma, 41
homogeneous distribution, 132, 136
homogeneous Lipschitz functions, 195
homogeneous maximal singular integrals, 333
homogeneous singular integrals, 333
improved integrability
of Ap weights, 518
inductive limit topology, 120
inÔ¨Ånitely differentiable function, 104
inhomogeneous Lipschitz functions, 196
inner product
complex, 150
real, 150
inner regular measure, 98
interpolation
Banach-valued Marcinkiewicz theorem, 400
Banach-valued Riesz‚ÄìThorin theorem, 399
for analytic families of operators, 41
Marcinkiewicz theorem, 33
off-diagonal Marcinkiewicz theorem, 61
Riesz‚ÄìThorin theorem, 37
Stein‚Äôs theorem, 41
with change of measure, 78
inverse Fourier transform, 112
isoperimetric inequality, 17
Jensen‚Äôs inequality, 12, 525
Jones‚Äôs factorization theorem, 546
Khintchine‚Äôs inequalities, 586
for weak type spaces, 589
Kolmogorov‚Äôs inequality, 100
Kolmogorov‚Äôs theorem, 255
Kronecker‚Äôs lemma, 255
lacunary Carleson‚ÄìHunt theorem, 454
lacunary sequence, 227
Laplace‚Äôs equation, 328
Laplacian, 135
lattice points, 305
Lebesgue constants, 182
Lebesgue differentiation theorem, 95, 101

636
Index
left Haar measure, 18
left maximal function, 102
Leibniz‚Äôs rule, 105, 131
linear operator, 33
Liouville‚Äôs theorem, 143
Lipschitz condition, 384
for a kernel, 359
Lipschitz space
homogeneous, 195
inhomogeneous, 196
Littlewood‚ÄìPaley operator, 420
Littlewood‚ÄìPaley theorem, 421
localization principle, 213
locally compact topological group, 18
locally Ô¨Ånite measure, 98
locally integrable functions, 11
logconvexity of weak L1, 78
Lorentz spaces, 52
M. Riesz‚Äôs theorem, 247
majorant
radial decreasing, 92
Marcinkiewicz and Zygmund theorem, 386
Marcinkiewicz function, 415
Marcinkiewicz interpolation theorem, 33
Marcinkiewicz multiplier theorem
on Rn, 441
on R, 439
maximal Calder¬¥on‚ÄìZygmund operator, 533
maximal function
centered with respect to cubes, 99
dyadic, 103
dyadic spherical, 461
Hardy‚ÄìLittlewood centered, 86
Hardy‚ÄìLittlewood uncentered, 87
left, 102
right, 102
strong, 101
uncentered with respect to cubes, 99
with respect to a general measure, 98
maximal Hilbert transform, 322
maximal singular integral, 334
doubly truncated, 363
maximal singular integrals with even kernels,
347
maximal truncated singular integral, 363
measurable set, 2
method of rotations, 339
metrizability
of Lorentz space Lp,q, 74
of weak Lp, 14
Mihlin-H¬®ormander multiplier theorem, 446
minimally supported frequency wavelet, 486
minimax lemma, 556, 603
Minkowski‚Äôs inequality, 3, 12, 21
integral form, 13
Minkowski‚Äôs integral inequality, 13
Muckenhoupt characteristic constant, 503
Muckenhoupt characteristic constant of a
weight, 503
multi-index, 104
multiplier, 155
on the torus, 272
multiplier theorems, 437
necessity of Ap condition, 543
nonatomic measure space, 56
nonsmooth Littlewood‚ÄìPaley theorem, 427,
428
normability
p-normability of weak Lp for p < 1, 16
of Lorentz space Lp,q, 74
of Lorentz spaces, 74
of weak Lp for p > 1, 14
normability of weak L1 (lack of), 15
off-diagonal Marcinkiewicz interpolation
theorem, 61
open mapping theorem, 602
operator
commuting with translations, 146
of strong type (p,q), 33
of weak type (p,q), 33
orthonormal set, 185, 484
orthonormal system
complete, 185
oscillation of a function, 94
oscillatory integral, 161
overshoot, 221, 224
Parseval‚Äôs relation, 112, 186
partial derivative, 104
partition of unity, 611
phase, 161
Plancherel‚Äôs identity, 112, 186
pointwise convergence of Fourier series, 204
Poisson kernel, 26, 92, 95, 183, 317
Poisson kernel for the sphere, 144
Poisson representation formula
of Bessel functions, 573
Poisson summation formula, 187
polarization, 186
positive operator, 397
power weights, 506
principal value integral, 314
principle of localization, 213
quasi-linear operator, 33, 61
quasi-subadditive operator, 45

Index
637
Rademacher functions, 585
radial decreasing majorant, 92
radial function, 90
real analytic function, 262
reÔ¨Çection
of a function, 109
of a tempered distribution, 124
reÔ¨Çection formula
for the gamma function, 570
regulated function, 275
restricted weak type, 77
restricted weak type (1,1), 81
restricted weak type (p,q) with constant C, 61
reverse H¬®older condition
of order q, 523
reverse H¬®older property of Ap weights, 514
RHq(Œº), 523
Riemann zeta function, 301
Riemann‚Äôs principle of localization, 213
Riemann‚ÄìLebesgue lemma, 114, 193, 215
Riesz product, 232
Riesz projection, 245
Riesz transform, 325
Riesz‚ÄìThorin interpolation theorem, 37
right maximal function, 102
right Haar measure, 18
rotations method, 339
rough singular integrals, 455
Rubio de Francia‚Äôs extrapolation theorem, 548
sampling theorem, 491
Schwartz function, 105
Schwartz seminorm, 105
self-adjoint operator, 151
self-transpose operator, 151
Sidon set, 235
simple function, 2
sine integral function, 218
singular integrals with even kernels, 341
size condition
for a kernel, 358, 374
smooth bump, 120
smooth function, 104, 119
smooth function with compact support, 104,
119
smoothly truncated maximal singular integral,
374
smoothness condition
for a kernel, 359, 375
space
L‚àû, 2
Lp, 2
Lp,‚àû, 5
Lp,q, 52
M 1,1(Rn), 153
M 2,2(Rn), 154
M ‚àû,‚àû(Rn), 154
M p,q(Rn), 151
Mp(Rn), 155
C N, 104
C ‚àû, 104
C ‚àû
0 , 104
spectrum of the Fourier transform, 116
spherical maximal function, 475
spherical average, 476
spherical coordinates, 591
spherical Dirichlet kernel, 178
spherical partial sum, 184
square Dirichlet kernel, 178
square function, 421, 458
dyadic martingale, 469
square function of Littlewood‚ÄìPaley, 421
square partial sum, 184
standard kernel, 532
Stein‚Äôs interpolation theorem, 41
stereographic projection, 594
Stirling‚Äôs formula, 567
stopping-time, 97
stopping-time argument, 356
strong maximal function, 101
strong type (p,q), 33
sublinear operator, 33, 61
summation by parts, 599
support of a distribution, 125
surface area of the unit sphere Sn‚àí1, 565
Taylor formula, 607
tempered distribution, 120
test function, 119
tight frame, 496
tiling of Rn, 428
topological group, 18
torus, 174
total order of differentiation, 104
transference of maximal multipliers, 281
transference of multipliers, 275
translation
of a function, 109
of a tempered distribution, 124
translation operator, 271
translation-invariant operator, 146
transpose of an operator, 150
trigonometric monomial, 177
trigonometric polynomial, 177
truncated Hilbert transform, 314
truncated maximal singular integral, 374
truncated singular integral, 334, 363

638
Index
uncentered Hardy‚ÄìLittlewood maximal
function, 87
uncentered maximal function with respect to a
general measure, 98
uncentered maximal function with respect to
cubes, 99
uncertainty principle, 118
uniform boundedness principle, 602
unitary matrix, 387
Vandermonde determinant, 165
variation of a function, 199
vector-valued
extrapolation theorem, 554
Hardy‚ÄìLittlewood maximal inequality, 412,
557
inequalities, 555
vector-valued extension of a linear operator,
390
vector-valued inequalities, 408, 409, 414
vector-valued Littlewood‚ÄìPaley theorem, 426
vector-valued singular integral, 401
volume of the unit ball in Rn, 565
wave equation, 475
wavelet, 482
of minimally supported frequency, 486
wavelet transform, 496
weak Lp, 5
weak type (1,1), 88
weak type (p,q), 33
Weierstrass approximation theorem, 32
for trigonometric polynomials, 183
Weierstrass‚Äôs theorem, 229
weight, 499
of class A1, 502
of class A‚àû, 525
of class Ap, 503
weighted estimates
for singular integral operators, 540
Weyl‚Äôs theorem, 302
Whitney decomposition, 609
Young‚Äôs covering lemma, 98
Young‚Äôs inequality, 22, 400
for weak type spaces, 23, 73

