Predicative topos theory and
models for constructive set theory
Predicatieve topostheorie en modellen voor constructieve verzamelingenleer
(met een samenvatting in het Nederlands)
Proefschrift
ter verkrijging van de graad van doctor aan de Universiteit Utrecht op gezag van de
rector magniÔ¨Åcus, prof. dr. W.H. Gispen, ingevolge het besluit van het college voor
promoties in het openbaar te verdedigen op maandag 22 mei 2006 des middags te
4.15 uur
door
Benno van den Berg
geboren op 1 november 1978 te Emmen

Promotor:
Prof. dr. I. Moerdijk


Beoordelingscommissie:
Prof. dr. T. Coquand
Prof. dr. J.M.E. Hyland
Prof. dr. B.P.F. Jacobs
Dr. J. van Oosten
Prof. dr. M. Rathjen
ISBN-10: 90-393-4259-8
ISBN-13: 978-90-393-4259-6
2000 Mathematics Subject ClassiÔ¨Åcation: 03E70,03F50,18C50

Contents
1
Introduction
7
1.1
Background . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
7
1.2
Contents and results
. . . . . . . . . . . . . . . . . . . . . . . . . . .
14
2
Induction in categories
17
2.1
W-types . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
18
2.2
Categories with W-types . . . . . . . . . . . . . . . . . . . . . . . . .
25
3
Exact completion and glueing
33
3.1
Exact completion of a cartesian category . . . . . . . . . . . . . . . .
33
3.2
Two existence results for W-types . . . . . . . . . . . . . . . . . . . .
36
3.3
Œ†W-pretoposes as exact completions
. . . . . . . . . . . . . . . . . .
41
3.4
More examples of Œ†W-pretoposes . . . . . . . . . . . . . . . . . . . .
50
3.5
Glueing and the free Œ†W-pretopos
. . . . . . . . . . . . . . . . . . .
60
4
Algebraic set theory and CZF
65
4.1
Introduction to CZF
. . . . . . . . . . . . . . . . . . . . . . . . . . .
65
4.2
Introduction to algebraic set theory . . . . . . . . . . . . . . . . . . .
67
4.3
A realisability model of CZF . . . . . . . . . . . . . . . . . . . . . . .
71
5
Coinduction in categories
81
5.1
Preliminaries
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
82
5.2
Existence results for M-types
. . . . . . . . . . . . . . . . . . . . . .
86
5.3
Closure properties . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
91
5.3.1
M-types and slicing . . . . . . . . . . . . . . . . . . . . . . . .
91
5.3.2
M-types and coalgebras . . . . . . . . . . . . . . . . . . . . . .
93
5

6
CONTENTS
5.3.3
M-types and presheaves
. . . . . . . . . . . . . . . . . . . . .
96
5.3.4
M-types and sheaves . . . . . . . . . . . . . . . . . . . . . . .
97
6
Non-well-founded set theory
101
6.1
Generating objects in indexed categories . . . . . . . . . . . . . . . .
102
6.2
Final coalgebra theorems . . . . . . . . . . . . . . . . . . . . . . . . .
109
6.2.1
An indexed Ô¨Ånal coalgebra theorem . . . . . . . . . . . . . . .
109
6.2.2
Small maps . . . . . . . . . . . . . . . . . . . . . . . . . . . .
112
6.2.3
Final coalgebras in categories with small maps . . . . . . . . .
114
6.3
The Ô¨Ånal Ps-coalgebra as a model of AFA
. . . . . . . . . . . . . . .
117
A Categorical background
123
B Type theory
133
C Pcas and realisability
145
Samenvatting in het Nederlands
159
Acknowledgements
163
Curriculum Vitae
165

Chapter 1
Introduction
1.1
Background
Mathematical logic is the study of formal systems. In this way, the logician claims
to understand something about mathematical reasoning. On the face of it, this is a
surprising claim: as formal systems hardly play any rÀÜole in the work of the ordinary
mathematician, how can they illuminate her practices?
In everyday life, a mathematician who gives an argument never makes all her
assumptions and reasoning steps fully explicit. She relies on her intuition: things
she Ô¨Ånds obvious and does not care to explain only remain implicit. This does not
prevent her from communicating with her peers, because they have the same tacit
understanding she has. If requested, she can explain herself more fully and Ô¨Åll in
the gaps. In the end, she expects to be able to go back to some basic axioms, those
of set theory, to make her argument absolutely rigorous, but this for her is an ideal
possibility she would not care to pursue, except in some extreme cases.
Nevertheless, her basic assumptions, which are most probably made fully precise
by the formal set theory ZFC, tell a lot about her conception of mathematics. From
a philosophical point of view, ZFC expresses a belief in a static universe of mathe-
matical objects, the properties of which she discovers rather than invents and which
are generally independent of her cognitive activity. But diÔ¨Äerent points of view are
possible. Some mathematicians and philosophers have objected to what are called
the non-constructive and impredicative aspects of ZFC.
Constructivism: An argument is constructive when the mathematical objects that
are claimed to exist can actually be eÔ¨Äectively found. Ordinary mathematics is
full of arguments that are non-constructive (think of non-principal ultraÔ¨Ålters,
bases for every vector space, maximal ideals in rings, etcetera). Such arguments
express a strong belief in the mind-independent nature of mathematical objects,
since it is hard to see how the objects that are claimed to exist can actually
be built by the mathematician. A constructivist may for various philosophical
7

8
CHAPTER 1. INTRODUCTION
reasons reject this picture, and insist that all arguments have to be constructive.
Constructivist views go back to Kronecker at least, but have found a coherent
and comprehensive expression in Brouwer‚Äôs intuitionism. Not all constructivists
have since then been intuitionists, but Brouwer‚Äôs identiÔ¨Åcation of the Law of
Excluded Middle as the main culprit of the non-constructive nature of classical
mathematics has been very inÔ¨Çuential.
Constructivism has its origin as a philosophy of mathematics, but is, ironically
enough, more inÔ¨Çuential nowadays in computer science than in mathematics. A
natural reading of the view that a constructive argument should always allow
one to Ô¨Ånd the objects that are asserted to exist, is that these objects can be
computed by an algorithm. In computer science, this has led to the paradigm
that constructive proofs can in fact be regarded as programs, and vice versa.
The same idea is behind what is called ‚Äúrealisability‚Äù: realisability is an inter-
pretation of the arguments of the constructive mathematician using the concepts
of recursion theory, the mathematical theory of algorithms and computation.
Predicativism: Besides non-constructive arguments, ZFC also allows for the for-
malisation of impredicative arguments. These have been criticised by mathe-
maticians like Russell, Poincar¬¥e and Weyl, also starting from a certain construc-
tivist bias.
The view is basically that sets do not exist in themselves, but are the result of
the mathematician collecting objects into a whole. Predicativists observe that
certain deÔ¨Ånitions in ordinary mathematics deÔ¨Åne an element x in terms of a
set A to which it might belong (think of a deÔ¨Åning a real x as the supremum
of a set of reals A bounded from above). If one thinks of the element x as
being built by giving the deÔ¨Ånition, there is a clear problem here. The element
x has to exist before the set was built (because it was collected in the set A),
but at the same time it cannot exist before the set A was built (because it
was deÔ¨Åned in terms of it). Usually, the Powerset Axiom and the unrestricted
Separation Axiom are considered to be the axioms that make the set theory
ZFC intrinsically impredicative.
The discovery that made the foundations of mathematics a part of mathematics,
was that ZFC and other foundational schemes, that are either intuitionistic or pred-
icative (or both), can be studied mathematically. For that purpose, all the principles
that the diÔ¨Äerent foundational stances are committed to, have to be made completely
explicit. Formalisation therefore not only makes fully precise what a conception of
mathematics is committed to, so that one can see whether an argument is correct
on such a conception, but it also allows the possibility of studying such conceptions
mathematically. And that is what happens in this thesis.
But what kind of questions could the mathematician try to answer about these
formal systems? She can compare diÔ¨Äerent schemes in terms of their strength, for
example, by providing a translation from one into the other. Or she can try to prove
consistency of a formal system within another or try to prove that one can, without

1.1. BACKGROUND
9
loosing consistency, add principles to a formal system. Another possibility is to prove
certain principles independent: where one usually proves that certain principles can
be proved by doing precisely that, one could also to try to prove that certain principles
cannot be proved within a certain formal system. A statement is independent from
a formal theory when it is both impossible to prove and to disprove it in the theory
(the most famous examples of such independence results being the consistency of
Peano Arithmetic within Peano Arithmetic, the Continuum Hypothesis in ZFC and
the Axiom of Choice in ZF).
There is immediately one complication: what mathematical principles does one
employ in studying formal systems? If this is to be a mathematical investigation, the
arguments have to be conducted (ideally) within a certain formal system. Unfortu-
nately, there is no Archimedean point from which one can judge any formal system
in absolute terms. Also the mathematical logician is working within a mathematical
theory, her ‚Äúmetatheory‚Äù, and the best she can do is to make this as weak as possible
(preferably, no stronger than the weakest theory she is studying). This is just a fact
of life.
The methods to establish metamathematical results can roughly be classiÔ¨Åed as
either ‚Äúsyntactic‚Äù (proof-theoretic) or ‚Äúsemantic‚Äù (model-theoretic). As I understand
it, proof theorists assign ordinals to formal theories in order to measure their strength.
The starting point is G¬®odel‚Äôs Incompleteness Theorem: a theory S that proves the
consistency of a theory T is stronger than T. So when Gentzen proves that adding
induction up to œµ0 to Peano Arithmetic (PA) allows you to prove the consistency
of the original system, PA plus induction up to œµ0 is a stronger system that PA
itself. Induction up to lower ordinals is provable in PA, so in a sense œµ0 measures the
strength of Peano Arithmetic. Theories that prove induction up to œµ0 are stronger
than PA and principles that imply this statement cannot be provable within Peano
Arithmetic.
This thesis takes a model-theoretic approach. A model-theorist proves the consis-
tency of a collection of statements by exhibiting a model, a mathematical structure in
which they are all correct. Suppose one takes the famous translation of 2-dimensional
elliptic geometry into 3-dimensional Euclidean geometry in which the plane is a 2-
sphere, points are diametrically opposed points, and lines are concentric circles. If
you believe in the existence of the 2-sphere, diametrically opposed points and con-
centric circles, you have to believe in the consistency of elliptic geometry. The work
of Cohen proceeds along the same lines: starting with a model of ZFC, one can ma-
nipulate it in such a way that it becomes a model of ZFC including the negation of
the Continuum Hypothesis. This shows that one can consistently add the negation
of Continuum Hypothesis to ZFC. Assuming ZFC has a model, of course, which is
(in view of G¬®odel‚Äôs Completeness theorem that guarantees the existence of models of
consistent (Ô¨Årst-order) theories) the same as assuming the consistency of ZFC.
The thesis will be about formal systems that are diÔ¨Äerent from ZFC, in that
they are constructive as well as predicative. Predicative systems with classical logic
descend from Weyl‚Äôs Das Kontinuum and have mainly been studied from a proof-

10
CHAPTER 1. INTRODUCTION
theoretic point of view, while constructive systems that are impredicative, like IZF
(which is basically ZF with intuitionistic logic) and higher-order type theory, have
also been studied from a more semantic point of view, in the form of topos theory (I
will come back to this).
The historical origin of the interest in formal systems that are both constructive
and predicative lies in Bishop‚Äôs book on constructive analysis [17]. The book did a lot
to rekindle the interest in constructive analysis (as can be seen from the diÔ¨Äerence in
the lengths of the bibliographies in the Ô¨Årst and second edition). There was of course
an intuitionistic school in constructive analysis, but many became disheartened by
the less attractive features of Brouwer‚Äôs thought.1 Bishop skillfully managed to avoid
those and showed that it is possible to develop constructive analysis in an elegant
and coherent fashion. Among other things, he managed not to unnerve the classical
mathematician by only using methods she also believed to be valid, and not making
analysis dependent on strange entities called choice sequences. He did manage to
include variants of the well-known results, possibly with stronger assumptions, and
was able to develop some ‚Äúhigher‚Äù mathematics (more, say, than the mathematical
theory covered in any Ô¨Årst-year analysis course). The impression the book left behind
on many people was that Bishop made the constructive program look much more
attractive than it had ever done.
The relative success of the book made it a worthwhile task to understand the
conception of mathematics that was expressed in the book. Although the book talked
about sets and functions in a way familiar to any mathematician, it is clear that
these terms cannot have the meaning they are usually taken to have (as is clear from
Bishop‚Äôs insistence that all his mathematical statements have ‚Äúnumerical meaning‚Äù).
But how the notions of sets and functions were now supposed to be understood,
Bishop did not make very explicit. It may be considered an advantage that Bishop
did not spend page after page to explain his basic notions and instead went straight
on to develop his mathematics, but, as I explained, a formal framework is essential
for studying such notions mathematically.
As Bishop did not make his commitments fully precise, the task of formalising his
approach to mathematics fell to other people. The Ô¨Årst attempt was made by Myhill
in [62]: he formulated a set theory CST that, he claimed, allows for a formalisation of
Bishop‚Äôs book. CST was a theory much like ordinary ZFC, which has the advantage
of looking familiar to the general mathematician. But it had the features of being
both constructive and predicative. That its underlying logic is intuitionistic, so as not
to include the Law of Excluded Middle, was to be expected, but Myhill also argued
1Think of the (in)famous obscurity of Brouwers philosophical views, which included a degree of
metaphysical solipsism, a considerable amount of mysticism and a distaste for formalisation. In
addition his views seemed to make doing mathematics very cumbersome as certain methods were
considered taboo, allowed for certain mathematical objects, like choice sequences, that were very
much unlike anything introduced into mathematics before, included mathematical principles that
are false from the classical point of view, and Ô¨Ånally seemed to be destructive of certain portions of
mathematics treasured by anyone who has ever studied it. One can understand why they were not
considered very inviting.

1.1. BACKGROUND
11
that the framework had to be formulated within predicativist limits. More precisely,
he argued for a restricted version of the Separation Axiom and the exclusion of the
Powerset Axiom. In general, one might think (as I do) that a consistent constructivist
has to be a predicativist as well, but that being as it may, in his book, Bishop abided
by predicativist strictures.
The set theory CST was extended by Aczel to a stronger set theory he called CZF.
Besides formulating a framework for doing Bishop-style constructive mathematics, he
also provided a clear constructive justiÔ¨Åcation, by interpreting CZF into Martin-L¬®of‚Äôs
type theory. Martin-L¬®of type theory is another attempt to elucidate the activity of
the constructive mathematician.
Its strength is that it provides a direct analysis
of the basic concept of constructivism: that of a mathematical construction. Thus
Aczel‚Äôs interpretation of CZF into type theory makes explicit how the constructive
nature of his theory is to be understood.
Martin-L¬®of type theory is a remarkable theory, which has made an impact on
computer science as well. While the system was originally formulated by Martin-L¬®of
as a formal analysis of constructivist mathematics, he also pointed out that it could
be regarded as a programming language. As such it has two noteworthy features:
Ô¨Årst, programs written within this system are always correct, in the following sense.
Typically, programs are written to calculate the solution to a problem which has been
speciÔ¨Åed in advance. While writing a program, one simultaneously (mathematically)
proves that the program computes what is the solution to the problem (and not some-
thing else). Furthermore, it is impossible to write programs that do not terminate:
so-called ‚Äúloops‚Äù are guaranteed not to occur.
Also in the mechanical veriÔ¨Åcation of mathematical arguments, type theory has
been inÔ¨Çuential.
The most impressive feat in this respect might be the complete
formal veriÔ¨Åcation of the Four Colour Theorem in the system COQ by Gonthier.
COQ is based on the Calculus of Constructions, an extension of Martin-L¬®of type
theory.
Both CZF and Martin-L¬®of type theory are still predicative formal theories. An
early formulation of Martin-L¬®of type theory allowed for impredicative deÔ¨Ånitions, but
as that turned out to be inconsistent (Girard‚Äôs paradox), its successors have been
formulated within predicative limits. And, like CST, CZF is not committed to the
existence of all powersets, and contains the Separation Axiom only in a restricted
form. Now that both CZF and Martin-L¬®of type theory have emerged as formal sys-
tems for doing constructive-predicative mathematics, and books are currently being
written on how to do that (on CZF by Aczel and Rathjen, on type theory by Dybjer,
Coquand, Setzer and Palmgren), the time seems ripe for a mathematical investigation
of these systems. This thesis hopes to contribute to that.
But before misunderstandings arise, several remarks should perhaps be made. As
a Ô¨Årst remark, I should say that I will focus on the set theory CZF. Implications
of my work for type theory will not be pursued and are left for the future. (I will,
however, say something about the connection in Appendix B.)

12
CHAPTER 1. INTRODUCTION
Secondly, I should say that I am not the Ô¨Årst and only person to work on CZF.
The Ô¨Årst results concerning CZF are, of course, due to Peter Aczel [2, 3, 4], but
recently the set theory has been investigated mainly from a proof-theoretic point
of view by Rathjen and Lubarsky [70, 74, 73, 75, 54, 53] (some of which is as yet
unpublished). Sheaf models (in particular, forcing) for CZF have been investigated
by Grayson [34] and, more recently, Gambino [30, 31, 32]. The best introduction to
CZF is [7]. My work distuingishes itself from the approach of these authors in its
heavy reliance on categorical language and methods and in emphasising inductively
generated sets.
My source of inspiration for the categorical approach to the subject is topos theory.
While topos theory was initially developed in the Grothendieck school for the pur-
poses of algebraic geometry, the theory became interesting for logicians when Lawvere
emphasised the importance of the ‚Äúsubobject classiÔ¨Åer‚Äù and gave the deÔ¨Ånition of an
elementary topos. For the logician, elementary toposes are models for a higher-order
intuitionistic type theory. Topos theory turned out to be a rich subject (as witnessed
by the two thick volumes of Johnstone‚Äôs Elephant [44] and [45], with a third to come),
with plenty of implications for higher-order intuitionistic type theory.
Not only type theory, but also (intuitionistic) set theory proÔ¨Åted from the develop-
ment of topos theory. In the eighties of the last century, the study of the constructive,
but impredicative set theory IZF, was conducted mainly within a topos-theoretic
framework (as can be seen from sources like [51], Part III and [81], Chapter 15).2
This thesis studies constructive-predicative formal theories in a similar spirit.
Some adaptations are in order, as a topos is a structure that is far too rich for my
purposes. Due to the subobject classiÔ¨Åer, it models impredicative structures as well.
Therefore one of the themes of this thesis is the quest of a predicative analogue to
the notion of a topos, a kind of ‚Äúpredicative topos‚Äù. Such predicative toposes should
have the same properties as toposes, especially having the same closure properties
that have proved important for logical applications, while simultaneously providing
models for constructive and predicative formal theories.
The idea of developing a predicative theory of toposes, helpful in studying set
theories like CZF and Martin-L¬®of type theory, goes back to two papers by Moerdijk
and Palmgren ([60] and [61]). In the Ô¨Årst, they put forward a categorical deÔ¨Ånition
of W-type and the notion of a Œ†W-pretopos, which I believe to be a very suitable
candidate for the title of ‚Äúpredicative topos‚Äù. They prove stability of Œ†W-pretoposes
under a number of topos-theoretic constructions, including slicing, taking sheaves and
glueing (over Sets).
In their second paper, Moerdijk and Palmgren use ‚Äúalgebraic set theory‚Äù to con-
nect Œ†W-pretoposes with set theory: with this machinery, they show how a model
of CZF can be built inside a Œ†W-pretopos. Essentially, this is a generalisation of
Aczel‚Äôs interpretation of CZF inside Martin-L¬®of type theory (this will be recapitu-
2The work by Cohen on the independence of the Continuum Hypothesis and the Axiom of Choice
from classical set theory can also be reformulated topos-theoretically (see [18] and [56], Chapter 6).

1.1. BACKGROUND
13
lated in Chapter 4 of this thesis).
The idea of categories as a place (‚Äútopos‚Äù) where models of set theory can live,
is the starting point of algebraic set theory. This subject dates back to a book by
Joyal and Moerdijk [47] with the same name and provides a uniform categorical
tool for studying formal set theories. In the meantime the approach has been taken
up by several categorical logicians, including Steve Awodey, Alex Simpson, Carsten
Butz, Thomas Streicher, Henrik Forsell, Michael Warren, my former colleague Claire
Kouwenhoven-Gentil and present colleague Jaap van Oosten.3 Steve Awodey and his
PhD-student Michael Warren have also studied constructive-predicative set theories
within the setting of algebraic set theory [10].
Besides the usage of categorical methods, another respect in which the approach
taken here diÔ¨Äers from that of other logicians working on CZF, is in emphasising
inductively deÔ¨Åned structures.
It is very natural to allow for a wide class of in-
ductively generated sets within a constructive-predicative viewpoint. For example,
Poincar¬¥e took in his philosophical papers the principle of induction as the only truly
mathematical (as opposed to logical) principle. Some predicative theories have been
proposed that do not allow for particular inductively deÔ¨Åned sets, but that looks un-
necessarily restrictive, and theories like CZF and Martin-L¬®of type theory have in one
form or another incorporated features to build inductively deÔ¨Åned sets. To be more
precise, Aczel extended CZF with a Regular Extension Axiom (REA) to allow for
inductively generated sets and Martin-L¬®of type theory contains a class of inductive
types called W-types.4 W-types are thought of as sets of well-founded trees, and the
categories I work with, will contain inductively deÔ¨Åned structures of that form.
The emphasis on inductively generated structures, is complemented by a discus-
sion of coinduction. I do not mean to give an introduction here to the notions of
coinduction and bisimulation (for that, see [42] and [83]), but I do want to provide
some historical background.
The idea of a ‚Äúnon-well-founded‚Äù analogue to set theory was popularised by Peter
Aczel in his book [5]. He forcefully argued that it would be worthwhile to investigate
alternatives to the Axiom of Foundation (or Regularity Axiom), which (classically)
says that there are no inÔ¨Ånitely descending œµ-chains. The axiom is not necessary
to prevent set-theoretic paradoxes, and has no relevance for the work of ‚Äúordinary‚Äù
mathematicians, but is mainly of use to metamathematicians, in that it provides
them with a convenient picture of the universe of sets (the so-called cumulative hier-
archy). In set-theoretic texts, it is usually pointed out that it does no harm to accept
the axiom (a result by Von Neumann), but that does not exclude the possibility of
interesting alternatives.
In his book, Peter Aczel made a case for one such alternative: the Anti-Foundation
Axiom. The name is a bit misleading in that it suggests it might be the only possible
3References
can
be
found
at
the
webpage
devoted
to
the
subject:
http://www.phil.cmu.edu/projects/ast/.
4As explained in Appendix B, all the types in Martin-L¬®of type theory are in a sense inductively
generated sets.

14
CHAPTER 1. INTRODUCTION
alternative, but it is more colourful than ‚ÄúX1-axiom‚Äù, as it was originally called
by Forti and Honsell [28]. Aczel‚Äôs starting point was the old idea that sets can be
presented as trees: the representation of a set x consists of a node, with one edge
into this node for every element of y of x, on which one sticks the representation
of that element, which consists of a node, etcetera. The Foundation Axiom implies
that only well-founded trees will now represent sets, and the sets they represent are
automatically unique (basically by the Extensionality Axiom). The idea of the Anti-
Foundation Axiom is to have all trees (well-founded or not) represent unique sets.
(Hence ‚Äúnon-well-founded‚Äù set theory.)
As Peter Aczel discovered, this means that one can solve systems of equations
like:
x
=
{x, y}
y
=
{x, {x, {y}}}
uniquely. This proved a very fruitful idea in computer science, where people lacked
a conceptual language to describe circular (and, more generally, non-terminating)
phenomena. The other concepts that Aczel isolated (coinduction, bisimulation), fre-
quently put in a category-theoretic framework, now belong to the standard arsenal of
tools in the theory of concurrency and program speciÔ¨Åcation, as well as in the study
of semantics for programming languages with coinductive types [23, 24, 42, 83, 12].
1.2
Contents and results
One of the main aims of this thesis is to convince the reader that the notion of a
Œ†W-pretopos is a sensible predicative analogue of the notion of a topos. In order to
make a persuasive case, I need to show two things: Ô¨Årst, I have to make clear that
the class of Œ†W-pretoposes shares many of the properties with the class of toposes.
This applies in particular to the closure properties that have been exploited in the
logical applications of topos theory. Secondly, I should explain how Œ†W-pretoposes
provide models for constructive and predicative formal theories, like Aczel‚Äôs CZF.
The contents of this thesis are therefore as follows. Chapter 2 introduces W-types
in a categorical context and Œ†W-pretoposes. It also proves a (new) characterisation
theorem that helps one to recognise W-types in categories.
This is then used to
identify and concretely describe W-types in various categories.
In Chapter 3, I prove two closure properties of Œ†W-pretoposes, both of them
new. The Ô¨Årst of these is the closure under exact completion. This result is surpris-
ing, as the corresponding result for toposes is false. As will be discussed, less than
the structure of Œ†W-pretopos is needed to get an exact completion that is a Œ†W-
pretopos. I identify weaker categorical structures (‚Äúweak Œ†W-pretoposes‚Äù), whose
exact completions are Œ†W-pretoposes. This is then used to give more examples of
Œ†W-pretoposes, one of which is a kind of predicative realisability topos. It shows
that Œ†W-pretoposes are closed under a notion of realisability, which promises to be

1.2. CONTENTS AND RESULTS
15
important for logical purposes. Finally, I prove closure of Œ†W-pretoposes under (gen-
eral) glueing. Combined with closure under exact completion, one obtains a result
concerning the projectives in the free Œ†W-pretopos.
Chapter 4 leaves the area of pure ‚Äúpredicative topos theory‚Äù and studies an ap-
plication to the set theory CZF. Using the framework of algebraic set theory along
the lines of [61], I prove that the models of CZF of Streicher in [80] and Lubarsky
in [53] exist as objects in the eÔ¨Äective topos, and are in fact the same. The model
is then further scrutinised and shown to validate a host of constructivist principles.
The result that these are therefore collectively consistent with CZF is new.
The two Ô¨Ånal Chapters are joint work with Federico De Marchi and are concerned
with categories with coinductively generated structures. In the same way as a W-type
is an inductively generated set of a particular type, which is to be thought of as a set
of well-founded trees, the dual notion of M-type is to be thought of as a coinductively
generated set of non-well-founded trees.
Chapter 5 studies M-types in categories. I prove some existence results concern-
ing M-types: the main result in this direction is that the existence of a Ô¨Åxpoint for a
polynomial functor implies the existence of an M-type. This is also used to strengthen
a result by Santocanale on the existence of M-types in locally cartesian closed pre-
toposes with natural number object. The Chapter also introduces the notion of a
Œ†M-pretopos and continues to investigate the possibility of developing a theory of
Œ†M-pretoposes analogous to the theory of Œ†W-pretoposes.
More particularly, it
studies the stability of Œ†M-pretoposes under various topos-theoretic constructions,
like slicing, coalgebras for a cartesian comonad and sheaves. In topos theory, these
closure properties have proved useful for logical applications and the hope is that
these results will have applications to models of non-well-founded set theory and type
theories with coinductive types.
An interesting question is whether coinductively deÔ¨Åned structures are essentially
impredicative. This question is also discussed by Rathjen in [72]: his conclusion is
that Aczel‚Äôs theory of non-well-founded sets can be developed without using such
impredicative objects as powersets and the like. For that reason, he feels that the
circularity that the predicativist discerns in impredicative deÔ¨Ånitions is of a diÔ¨Äerent
kind than the circularity in coinductively deÔ¨Åned sets. Such views are of course highly
philosophical, but are at least conÔ¨Årmed in that there are models of predicative formal
theories where the Anti-Foundation Axiom is valid. A general method for constructing
such models (classical or constructive, predicative or impredicative) is obtained in
Chapter 6.
Following Aczel [5], I use a Ô¨Ånal coalgebra theorem to construct such models.
Therefore I Ô¨Årst prove an abstract categorical Ô¨Ånal coalgebra theorem applicable in
the setting of algebraic set theory. This is then applied to prove the existence of
M-types and models of non-well-founded set theory in settings very much like that
of the original book on algebraic set theory by Joyal and Moerdijk [47]. This is also
joint work with Federico De Marchi.

16
CHAPTER 1. INTRODUCTION
The thesis concludes with three appendices that are meant to provide some back-
ground for this thesis. The Ô¨Årst introduces the category theory and categorical termi-
nology that is needed to understand this thesis, while the second gives an introduction
to Martin-L¬®of type theory. The third is on partial combinatory algebras and realis-
ability toposes.

Chapter 2
Induction in categories
Within a conception of mathematics that is constructive and predicative, it is very
natural to assume the existence of a wide variety of inductively generated struc-
tures. To allow for inductively deÔ¨Åned sets, Aczel extended his set theory CZF with
the Regular Extension Axiom (REA), while for the same purpose, Martin-L¬®of has
added well-founded types (or W-types) to his type theory. To study categorically
constructive-predicative theories characterised by this liberal attitude towards induc-
tively deÔ¨Åned sets, it is necessary to isolate categories in which there exist objects
that can be thought of as inductively generated.
In order to give a categorical formulation, the idea of an inductive deÔ¨Ånition is too
informal, and also too broad, so one has to restrict oneself to a class of sets that result
from an inductive deÔ¨Ånition of a determinate form. Following Moerdijk and Palmgren
[60], I take Martin-L¬®of‚Äôs W-types as the inductively deÔ¨Åned sets to incorporate: they
have a precise constructive justiÔ¨Åcation in type theory, while they are also suÔ¨Écient
for obtaining models for set theory (see [61], generalising the work of Aczel in [2]; I
will discuss this work in Chapter 4).
The categorical notion of a W-type will be discussed in the Ô¨Årst Section of this
Chapter. The main novelty of the discussion is a characterisation theorem which will
be helpful in recognizing W-types in concrete cases.
Two classes of categories with W-types are then deÔ¨Åned, ML-categories and Œ†W-
pretoposes.
The latter, Œ†W-pretoposes, were originally deÔ¨Åned by Moerdijk and
Palmgren, as predicative analogues of the notion of a topos. It is with these Œ†W-
pretoposes that Chapters 3 and 4 of this thesis will be concerned. ML-categories
are almost Œ†W-pretoposes, their only defect in this respect being that they are not
exact. But this ‚Äúdefect‚Äù can be remedied by taking their exact completion, as will be
discussed in Chapter 3.
The second Section of this Chapter discusses several examples of Œ†W-pretoposes
and ML-categories. More examples will be given in Chapter 3.
Parts of this Chapter have previously appeared in [14].
17

18
CHAPTER 2. INDUCTION IN CATEGORIES
2.1
W-types
Martin-L¬®of‚Äôs W-types are sets generated by an inductive deÔ¨Ånition with a particular
shape. The form of the inductive deÔ¨Ånition is determined by a signature: a set of
term constructors, each with a small (set-sized) arity.
The inductively generated
set (the W-type) is then the free term algebra over this signature. There are sets
which deserve to be called inductively generated, but are not of this form, but these
are beyond the scope of this thesis (see [27] for a broader framework for inductive
deÔ¨Ånitions).
To capture W-types categorically, the language of initial algebras (for an endo-
functor) immediately suggests itself, for, in general, it is the appropriate categorical
language to talk about inductively generated structures (see Appendix A for the ba-
sic facts and terminology on algebras and coalgebras on which this Section relies).
The question then becomes which endofunctors one should require to possess initial
algebras in order to have W-types. Moerdijk and Palmgren identiÔ¨Åed the following
class, deÔ¨Ånable in any lccc (also for categorical terminology and notation, one should
consult Appendix A).
DeÔ¨Ånition 2.1.1 In a cartesian category C, there is a polynomial functor 1 Pf asso-
ciated to every exponentiable map f: B
/ A. It is the endofunctor deÔ¨Åned as the
composite
C
B‚àó/ C/B
Œ†f / C/A
Œ£A
/ C.
A more insightful way of writing Pf(X) may be the following:
Pf(X) = Œ£A(X √ó A
/ A)(f:B
/ A),
or:
Pf(X) = Œ£a‚ààAXBa,
where Ba = f ‚àí1(a) is the Ô¨Åbre of f over a ‚ààA.
DeÔ¨Ånition 2.1.2 Let f: B
/ A be an exponentiable morphism in a cartesian cat-
egory C. The W-type associated to f is the initial Pf-algebra, when it exists; the
M-type associated to f is the Ô¨Ånal Pf-coalgebra, whenever it exists. If in a locally
cartesian closed category C, W-types (resp. M-types) exist for any map f, the category
C is said to have W-types (resp. M-types).
To understand this deÔ¨Ånition better, it helps to compute W-types and M-types in
the category of sets.
1Polynomial functors have received diÔ¨Äerent names in the literature: there is a tradition of calling
them partial product functors (they are called like this in [44], for example), while recently a group
of authors has emerged who use the name containers (for instance, see [1]).

2.1. W-TYPES
19
Fix a function f: B
/ A. One can think of f as specifying a signature: a term
constructor for every element a ‚ààA of arity Ba. The W-type Wf is now the set of all
terms over the signature speciÔ¨Åed by f. But it is even more suggestive to represent
such terms as well-founded trees of a particular type. The W-type for f is the set of
all well-founded trees in which nodes are labelled by elements a ‚ààA and edges are
labelled by elements b ‚ààB, in such a way that the edges into a certain node labelled
by a are enumerated by f ‚àí1(a), as illustrated in the following picture.
. . .
. . .
. . .
. . .
‚Ä¢
u
2222222
a
v

‚Ä¢
x
‚Ä¢
y

‚Ä¢
z
vvvvvvvvvvvv
f ‚àí1(a)
=
‚àÖ
f ‚àí1(b)
=
{u, v}
f ‚àí1(c)
=
{x, y, z}
. . .
a
x
E
E
E
E
E
E
E
E
E
E
b
y
c
z
{{{{{{{{{{
c
Let us Ô¨Årst try to understand why this set has the structure of a Pf-algebra. Now
Pf(X) for a set X can be written as:
Pf(X) =
X
a‚ààA
XBa.
So it consists of an element a ‚ààA together with a function t: Ba
/ X. Therefore
assume one is given an element a ‚ààA together with a function t: Ba
/ Wf. A new
well-founded tree of the appropriate type can be constructed as follows: take a fresh
node and label it with a. Draw edges into this node, one for every b ‚ààBa and label
these accordingly. Then stick to the edge labelled by b ‚ààBa the well-founded tree tb.
The new tree, which is easily seen to belong to Wf, is usually denoted by supa(t).
I have described an operation sup: Pf(Wf)
/ Wf, giving Wf the structure of a
Pf-algebra. The fact that the trees are well-founded means that one could actually
generate all of them by (transÔ¨Ånitely) repeating this sup-operation. This construction
terminates, because one has only a set of term constructors, and the arities are also
small, so there is only a set of trees with the appropriate labelling, well-founded or
not.
But this means that one can deÔ¨Åne functions by recursion on this generation
process. And this is precisely what yields initiality of Wf. For if m: Pf(X)
/ X
is any Pf-algebra and one wishes to build a function g: Wf
/ X, one can do so
by specifying the value of g on an element supa(t), assuming that one has already
speciÔ¨Åed the value on elements of the form tb, where b ‚ààBa. Therefore one can put:
g(supa(t)) = m(Œªb ‚ààf ‚àí1(a).g(tb)),
expressing that g is a Pf-algebra morphism. The Pf-algebra morphism so deÔ¨Åned is
automatically unique, because functions deÔ¨Åned by recursion always are. Although
much of what I have said, applies only literally in the case of sets, thinking in terms of

20
CHAPTER 2. INDUCTION IN CATEGORIES
well-founded trees and recursion is the right intuition also in the abstract categorical
case, to which I now turn.
Now let f: B
/ A be an exponentiable morphism in a Heyting category C. When
the W-type Wf associated to f exists, one can say right away that it has two proper-
ties, both for abstract categorical reasons (see appendix A). First of all, the structure
map sup: Pf(Wf)
/ Wf is an isomorphism, by Lambek‚Äôs lemma (see Lemma A.14).
Secondly, it will have the feature of possessing no proper Pf-subalgebras.
The second property is reÔ¨Çected as an induction principle in the internal logic. If
R is a subobject of W that is inductive in the sense that
‚àÄb ‚ààf ‚àí1(a)(tb ‚ààR) ‚áísupa(t) ‚ààR
holds in the internal logic, then R = W as subobjects of W. Induction also holds
when R depends on a parameter. This follows from the following fact (see [60, 33],
and Remark 2.1.6 below):
Theorem 2.1.3 Let f: B
/ A be an exponentiable morphism in a cartesian category
C. The polynomial functor Pf is automatically indexed. If C is Heyting, a W-type for
f is automatically an indexed well-founded Ô¨Åxpoint. If C is locally cartesian closed, a
W-type for f is automatically an indexed initial algebra.
As an illustration of this theme, there is this lemma:
Lemma 2.1.4 Let f: B
/ A be an exponentiable morphism in a Heyting category
C. When both the W-type and the M-type associated to f exist, the canonical map
i: Wf
/ Mf is monic.
Proof. There is a canonical morphism i, because an M-type is a Ô¨Åxpoint for the poly-
nomial functor and can therefore be regarded as a Pf-algebra (conversely, the W-type
can be regarded as Pf-coalgebra). I will now actually prove something stronger: the
Pf-algebra map i from Wf to any Pf-algebra with monic structure map m: PfX
/ X,
is a monomorphism.
For let
R = {w ‚ààWf | ‚àÄv ‚ààWf: i(w) = i(v) ‚áíw = v}.
Then R is inductive: for suppose w = supa(t) ‚ààWf is such that tb ‚ààR for all b ‚ààBa.
Let v ‚ààWf be such that i(w) = i(v). Since sup is an isomorphism, v is of the form
supa‚Ä≤(t‚Ä≤). Now
i(w) = m(a, Œªb ‚ààBa.itb) = m(a‚Ä≤, Œªb‚Ä≤ ‚ààBa‚Ä≤.it‚Ä≤b‚Ä≤) = i(v).
Since m is monic, a = a‚Ä≤ and itb = it‚Ä≤b for all b ‚ààBa. Using that tb ‚ààR, one sees
that tb = t‚Ä≤b for all b ‚ààBa, i.e. t = t‚Ä≤. Therefore w = v and the proof is Ô¨Ånished. ‚ñ°

2.1. W-TYPES
21
In many categories, the two properties of being a Ô¨Åxpoint and being well-founded
characterise W-types completely, as I will prove at the end of this Section. But before
I do that, I will discuss Pf-coalgebras and M-types.
In the category of sets, the M-type associated to a function f: B
/ A is the set of
all trees (well-founded or otherwise) labelled in the familiar way: nodes are labelled
by elements a ‚ààA, while edges into a node labelled by a are enumerated by b ‚ààBa.
If one wishes for a more concrete description, one could regard Mf as the set of all
sets S of sequences of the form
‚ü®a0, b0, a1, b1, . . . , an‚ü©
where ai ‚ààA and bi ‚ààB satisfy:
1. f(bi) = ai;
2. ‚ü®a‚ü©‚ààS for some a ‚ààA;
3. if ‚ü®a0, b0, a1, b1, . . . , an, bn, an+1‚ü©‚ààS, then also ‚ü®a0, b0, a1, b1, . . . , an‚ü©‚ààS;
4. if ‚ü®a0, b0, a1, b1, . . . , an‚ü©‚ààS and b ‚ààBan, then ‚ü®a0, b0, a1, b1, . . . , an, b, a‚ü©‚ààS for
some a ‚ààA.
That this yields the Ô¨Ånal Pf-coalgebra, one sees as follows.
There is the projection morphism Pf(X)
/ A for any X, so to any Pf-coalgebra
m: X
/ PfX one can associate a root map œÅ: X
/ A. The name is suggested by
the case of M-types and W-types, where œÅ assigns to a tree the label of its root (a
W-type is also naturally a Pf-coalgebra, because it is a Ô¨Åxpoint for Pf). Another
notion that makes sense in any Pf-coalgebra m: X
/ PfX is that of a path, the
name again being suggested by the case of W- and M-types. A sequence of the form
‚ü®x0, b0, x1, b1, . . . , xn‚ü©
is called a path from x0 to xn, if xi ‚ààX and bi ‚ààB are such that they satisfy the
following compatibility condition: if for an i < n, m(xi) is of the form (ai, ti), then
f(bi) = ai and xi+1 = tibi.
A Pf-coalgebra morphism g: X
/ Mf can now be obtained as follows: thinking
of trees as sets of paths, one sends an element x ‚ààX to the set of all sequences of
the form
‚ü®œÅ(x0), b0, œÅ(x1), b1, . . . , œÅ(xn)‚ü©,
where ‚ü®x0, b0, x1, b1, . . . , xn‚ü©is a path starting from x.
One readily sees that g is
well-deÔ¨Åned, a Pf-coalgebra morphism and the unique such.
An important observation is that the notions of a root and a path are readily
formalized in the internal logic of locally cartesian closed regular categories C with
Ô¨Ånite disjoint sums and natural number object: an object Paths = Paths(m) can
be deÔ¨Åned in any such C as the subobject of (X + B + 1)N consisting of those œÉ ‚àà
(X + B + 1)N for which one has:

22
CHAPTER 2. INDUCTION IN CATEGORIES
1. œÉ(0) ‚ààX.
2. If œÉ(n) ‚ààX for an even natural number n, then either œÉ(n+1) ‚ààB or œÉ(n+1) =
‚àó(with ‚àódenoting the unique element of 1).
3. If œÉ(n) = x and œÉ(n+1) = b for an even number n, then fb = a and œÉ(n+2) = tb,
where (a, t) = r(x).
4. n < k and œÉ(n) = ‚àóimply œÉ(k) = ‚àó.
5. There is a natural number n such that œÉ(n) = ‚àó.
Since paths will play a prominent rÀÜole in this thesis, I establish some terminology
and notation, which will also make sense in the internal logic of C. Because there is a
natural number n such that œÉ(n) = ‚àó, there is also a least such (this is a consequence of
the constructively valid principle that every inhabited decidable subset of the natural
numbers has a least element). That number will be called the length of œÉ. Then œÉ(0)
will be called the beginning, while œÉ(the length of œÉ ‚àí1) will be called the end of the
path. One has a map Paths ‚ÜíX deÔ¨Åned by assigning to a path the beginning of the
path. The Ô¨Åbre above x for this map will be denoted by Pathsx. Also in the internal
logic, I will continue to use the notation ‚ü®. . . , . . . , . . .‚ü©for writing down sequences and
‚àóas a symbol for concatenation.
One can then use the notion of path to deÔ¨Åne the notion of subtree. Once again,
this notion has a clear meaning in the case of W- and M-types, but makes sense in
any Pf-coalgebra. I will call y a subtree of x if there is a path œÉ in Pathsx such that
œÉ(n) = y for some even natural number n. If n can be chosen to be bigger than 1, y is
called a proper subtree. Observe that the subtree relation is reÔ¨Çexive and transitive.
For example, in a W-type, the tree t(b) is a subtree of w = supa(t) (the tbs are really
the immediate proper subtrees of supa(t)).
As an application of the notion of path, one has the following characterisation or
recursion theorem for W-types, which will be very helpful in recognizing W-types.
Theorem 2.1.5 (Characterisation Theorem) Let C be a locally cartesian closed
regular category with Ô¨Ånite disjoint sums and a natural number object, and f: B
/ A
a morphism in C. The following are equivalent for a Pf-algebra (W, s: Pf(W)
/ W):
1. It is the W-type for f.
2. It is an indexed well-founded Ô¨Åxpoint.
3. It is a well-founded Ô¨Åxpoint.
The idea of the proof of the characterisation theorem is essentially that of Cantor‚Äôs
general recursion theorem (see, for example, [49], Theorem 5.6): one builds a map
by pasting together ‚Äúattempts‚Äù (partial approximations). Some care has to be taken,

2.1. W-TYPES
23
because the argument has to be predicative. In the impredicative context of elemen-
tary toposes, the characterisation would follow from a general result (see Theorem
2.2.3), but that argument does not obviously carry over to a predicative one.
Proof. The diÔ¨Écult part will be to show that (3) implies (1). Before Theorem 2.1.3
I pointed out that (1) implies (2), while the implication from (2) to (3) is trivial.
So assume W is a Ô¨Åxpoint having no proper Pf-subalgebras. In particular, it is a
Pf-coalgebra and hence it makes sense to talk about paths in W. This can therefore
be used to deÔ¨Åne a notion of attempt.
Now let (X, m: Pf(X)
/ X) be an arbitrary Pf-algebra. An attempt for an element
w ‚ààW is a morphism g: Pathsw
/ X with the additional property that for any path
œÉ ‚ààPathsw ending with an element w‚Ä≤ = sa‚Ä≤(t‚Ä≤) the following equality holds:
g(œÉ) = m(Œªb‚Ä≤ ‚ààf ‚àí1(a‚Ä≤).g(œÉ ‚àó‚ü®b‚Ä≤, t‚Ä≤b‚Ä≤‚ü©))
Later it will become apparent that g(œÉ) is p(w‚Ä≤) where w‚Ä≤ is the last element of œÉ and
p is the unique Pf-algebra morphism p: W
/ X. So an attempt will turn out to be
the restriction to the subtrees of w of the unique Pf-algebra morphism p: W
/ X,
which I still have to construct.
Let S be the collection of all those w ‚ààW for which there exists a unique attempt.
Then S is a subalgebra of W. For let w = sa(t) be such that tb ‚ààS for all b ‚ààf ‚àí1(a).
This means that there are for every b ‚ààf ‚àí1(a) unique attempts gb for tb. Write
xb = gb(‚ü®tb‚ü©). Now deÔ¨Åne a morphism g: Pathsw
/ X for w as follows:
g(‚ü®w‚ü©)
=
m(Œªb ‚ààf ‚àí1(a).xb) and
g(‚ü®w, b‚ü©‚àóœÉ)
=
gb(œÉ)
The fact that this is an attempt is easily veriÔ¨Åed.
Uniqueness relies on the following observation: if œÉ is a path starting with w and
ending w‚Ä≤ and g is an attempt for w, then h(‚ü®w‚Ä≤‚ü©‚àóœÑ) = g(œÉ ‚àóœÑ) deÔ¨Ånes an attempt
for w‚Ä≤. So if h is any attempt for w, then hb(‚ü®tb‚ü©‚àóœÑ) = g(‚ü®w, b, tb‚ü©‚àóœÑ) deÔ¨Ånes an
attempt for tb for every b ‚ààf ‚àí1(a). So hb = gb and what remains is the proof of
h(‚ü®w‚ü©) = g(‚ü®w‚ü©). But that is established by an easy calculation:
h(‚ü®w‚ü©)
=
m(Œªb ‚ààf ‚àí1(a).h(‚ü®w, b, tb‚ü©)
=
m(Œªb ‚ààf ‚àí1(a).hb(‚ü®tb‚ü©)
=
m(Œªb ‚ààf ‚àí1(a).gb(‚ü®tb‚ü©)
=
g(‚ü®w‚ü©)
So h = g and w ‚ààS. Therefore S is a subalgebra of W.
As W has no proper subalgebras, S = W as subobjects of W. But that allows one
to deÔ¨Åne p: W
/ X by:
p(w) = g(‚ü®w‚ü©)

24
CHAPTER 2. INDUCTION IN CATEGORIES
for the unique attempt g for w. This deÔ¨Ånes a Pf-algebra morphism, which is actually
the unique such: for if q is another Pf-algebra morphism the equaliser of p and q is
a subalgebra of W.
‚ñ°
Remark 2.1.6 It would not be diÔ¨Écult to give a direct proof that (3) implies (2).
The crucial fact is that in case T is a PX‚àóf-subalgebra of X‚àóW in C/X, then
S = { w ‚ààW | ‚àÄx ‚ààX: (x, w) ‚ààT }
deÔ¨Ånes a Pf-subalgebra of W in C.
I can now give the following two, important, deÔ¨Ånitions:
DeÔ¨Ånition 2.1.7 A locally cartesian closed category C with Ô¨Ånite disjoint sums and
W-types is called an ML-category.
Observe that ML-categories possess a natural number object, because the functor
X 7‚Üí1 + X is polynomial, and an initial algebra for this functor is a nno (see
Appendix A). In fact, X 7‚Üí1 + X is X 7‚ÜíPf(X), where f is the right inclusion
1
/ 1 + 1.
DeÔ¨Ånition 2.1.8 A locally cartesian closed pretopos C with W-types is called a
Œ†W-pretopos. (So a Œ†W-pretopos is an exact ML-category.)
It is with these kinds of categories that the Ô¨Årst part of this thesis will mostly be
concerned. In Chapters 3 and 4, I will show that, for logical purposes, Œ†W-pretoposes
can be regarded as a kind of predicative toposes, in that a theory analogous to topos
theory, with similar closure conditions, can be developed for them, while they at the
same time provide a natural habitat for models of set theory.
In the next Section I will give a number of examples of ML-categories and Œ†W-
pretoposes. Once I have developed more theory, especially concerning exact comple-
tions, I will be able to give more.
Generalised polynomial functors 2.1.9
Which functors, aside from polynomial
ones, automatically have initial algebras in a category, when that category has W-
types? The question is interesting, but I will not attempt to give an answer.
However, in [33], Gambino and Hyland identify a class of functors that have initial
algebras, when all W-types exist. Suppose C is an ML-category, and recall that, since
C is an lccc, pullback functors
f ‚àó: C/X
/ C/Y
have left and right adjoints for all f: Y
/ X, called Œ£f and Œ†f, respectively. Consider
all possible compositions of such functors f ‚àó, Œ£f and Œ†f, possibly for diÔ¨Äerent f.

2.2. CATEGORIES WITH W-TYPES
25
When such a composition has the same slice of C as domain and codomain, the
functor is called generalised polynomial.
The class of generalised polynomial functors is less unwieldy than one might initially
think, because of the following ‚Äúnormal form lemma‚Äù.
Lemma 2.1.10 For any generalised polynomial functor ‚àÜthere is a (not necessarily
commutative) triangle
B
f
/
h
@
@
@
@
@
@
@
A
g
~~~~~~~
C
such that ‚àÜis naturally isomorphic to Œ£gŒ†fh‚àó.
In their paper, Gambino and Hyland prove:
Theorem 2.1.11 (See [33], Theorem 12.) All generalised polynomial functors on a
ML-category C have initial algebras in the appropriate slice.
One could prove an extension of the characterisation result Theorem 2.1.5 for ini-
tial algebras for generalised polynomial functors: when an algebra is a well-founded
Ô¨Åxpoint for a generalised polynomial functor, it is the initial algebra.
2.2
Categories with W-types
In this Section, I will introduce various examples of the notions of ML-category and
Œ†W-pretopos, introduced above. It is well known that these categories have this
structure, W-types excepted, and for proofs, the reader is therefore referred to the
literature. Frequently, a concrete description of W-types or M-types was not available
in the literature, and in some cases their presence was unknown. Therefore concrete
descriptions will be provided.
Toposes 2.2.1
Elementary toposes with a natural number object form an impor-
tant class of examples of Œ†W-pretoposes. Recall that a morphism ‚ä§: 1
/ ‚Ñ¶in a
cartesian category C is the subobject classiÔ¨Åer of C, when for any monomorphism
m: A
/ X there is a unique map cA: X
/ ‚Ñ¶such that
A
m

/ 1
‚ä§

X
cA
/ ‚Ñ¶
is a pullback. And recall that (elementary) topos is a cartesian closed category with
pullbacks and a subobject classiÔ¨Åer.

26
CHAPTER 2. INDUCTION IN CATEGORIES
Topos theory is a rich subject with plenty of examples, among which are Grothendieck
toposes, in particular categories of sheaves over a topological space (see [56]), the free
topos (with nno) (see [51]) and the eÔ¨Äective topos (see [39]). Any (good) book on
topos theory will prove that a topos is a Œ†-pretopos (for example, [44], Corollaries
A2.3.4 and A2.4.5). The fact that toposes with nno have W- and M-types is folklore.
The description that I gave of an M-type for a map f: B
/ A as consisting of sets
of sequences
‚ü®a0, b0, a1, b1, . . . , an‚ü©
having four properties, makes sense in the internal logic of any topos with nno. It is
a routine exercise in the use of internal logic to show that the object so deÔ¨Åned is the
M-type for the map f. Therefore:
Proposition 2.2.2 (See Lemma 2.4 in [46].) Toposes with nno have M-types.
The fact that toposes have W-types now follows from another folklore result:
Theorem 2.2.3 (See Proposition 1 in [43].) Let F be an indexed functor on a topos
E preserving pullbacks. If F has a Ô¨Åxpoint, it also has a well-founded Ô¨Åxpoint (see
Appendix A), which necessarily is the initial F-algebra.
Since M-types are Ô¨Åxpoints and polynomial functors are indexed and preserve pull-
backs, one immediately obtains:
Proposition 2.2.4 (See Proposition 2.3.5 in [68].) Toposes with nno have W-types.
Alternatively, one can simply select in the internal logic the trees in the M-type that
are well-founded (the internal logic of toposes is impredicative, so this is expressible),
and obtain the W-type in that way (see Proposition 3.6 in [60]).
The next couple of examples concern full subcategories of the realisability topos
RT(Q) on a pca Q. For a (brief) discussion of pcas and realisability toposes, see
Appendix C.
Convention 2.2.5
When in the name of a category depending on a pca Q, this
index is omitted, it is to be understood that the relativization is to K1, Kleene‚Äôs Ô¨Årst
pca. So RT is RT(K1), i.e. the eÔ¨Äective topos.
Assemblies 2.2.6
Fix a pca Q. An assembly on Q consists of set X together
with a function [‚àí]X: X
/ PiQ (by PiQ, I mean the set of non-empty subsets of
Q). Instead of q ‚àà[x]X, I will frequently write q ‚ä¢X x, or simply q ‚ä¢x, when X
is understood. In this case q is called a realiser of x. A function f: X
/ Y is a

2.2. CATEGORIES WITH W-TYPES
27
morphism of assemblies from (X, [‚àí]X) to (Y, [‚àí]Y ), when there is an element t ‚ààQ
such that for all x ‚ààX, q ‚ààQ:
q ‚ä¢X x ‚áít ¬∑ q ‚Üìand q ¬∑ p ‚ä¢Y f(x).
Such a t is said to track f, or to realise f. In this way, one obtains a category Asm(Q)
of assemblies on Q.
The category Asm(Q) is a regular ML-category for any pca Q. It is not a Œ†W-
pretopos, as it is not exact. Asm(Q) occurs as the full subcategory of RT(Q) con-
sisting of the ¬¨¬¨-separated objects, and the inclusion of Asm(Q) in RT(Q) preserves
the regular ML-category structure. These facts are well-known. Even the fact that
the category of assemblies has W-types and M-types, and that they are preserved
by the inclusion, seems to be familiar to many people, although it is seldom pointed
out explicitly (it is implicit in [67], for example). Also for the sake of completeness,
I explain the construction here, based on some unpublished notes by Ieke Moerdijk
(another description is contained in [37]).
But before I can give a concrete description of the W-types and M-types in the
category of assemblies for a pca Q, I Ô¨Årst need to investigate the behaviour of the
functor Pf for a morphism f: B
/ A of assemblies. The underlying set of Pf(X)
consists of those pairs (a, t) where a is an element of Q and t is a function from Ba
to X that has a realiser. An element n ‚ààA is a realiser for (a, t), if n = ‚ü®n0, n1‚ü©is
such that n0 realises a and n1 tracks t (the latter meaning, of course, that for every
b ‚ààBa and every realiser m of b, n1 ¬∑ m is deÔ¨Åned and equal to a realiser of tb).
The key concept behind the construction of the W-types is the notion of decoration.
This notion will recur a number of times, so I will take some time explaining it. The
idea behind this notion is as follows. Elements w of the W-type Wf belonging to a
function f: B
/ A are thought of as being constructed by repeated application of the
sup operation to maps of the form f ‚àí1(a)
/ Wf. When constructing the W-types in
Asm(Q), I only want those elements w of W(f) that can be constructed by applying
the operation sup to ‚Äútrackable‚Äù maps of the form f ‚àí1(a)
/ Wf. A decoration of
an element in the W-type speciÔ¨Åes for each application of the sup operation that has
been used to generate the element, a realiser for the ‚Äúapplicant‚Äù, i.e. both an element
in Q that tracks the map t: f ‚àí1(a)
/ Wf to which it has been applied, as well as a
realiser for a.
Therefore the W-type for f is constructed as follows. First construct the W-type
W for the underlying function f in the category of sets.
Next deÔ¨Åne a function
E: W
/ PQ by transÔ¨Ånite induction:
E(supat) consists of those elements n =
‚ü®n0, n1‚ü©‚ààQ such that (i) n0 realises a; and (ii) n1 tracks t, that is, for every b ‚ààBa
and every realiser m of b, n1 ¬∑ m is deÔ¨Åned and a member of E(tb). I call a member
n of E(w) a decoration or a realiser of the tree w ‚ààW. The trees w that have a
decoration are called decorable and V will be the name of the set of all decorable
trees.
The set V is the underlying set of an assembly whose realisability relation is deter-
mined by restriction of E to V . This assembly, also to be called V , is, I claim, the

28
CHAPTER 2. INDUCTION IN CATEGORIES
W-type for f in the category of assemblies. It is not hard to see that it has the
structure of a Pf-algebra. Let a be an element of A and t be a function Ba ‚ÜíV . The
element supa(t) ‚ààW is actually an element of V , because if n is a realiser of (a, t) in
Pf(V ), then n is a decoration of supa(t) (this is immediate from the deÔ¨Ånition of E
and the description of Pf(V )). So there is a map of assemblies s: Pf(V ) ‚ÜíV , which
is tracked by the identity.
To verify that the constructed object is the W-type, I appeal to the characterisation
theorem, Theorem 2.1.5. The map s is iso, basically because the underlying map sup
is, therefore I only need to show that V has no proper subalgebras.
Let (X, m: Pf(X)
/ X) be a subalgebra of V . One may assume that the underlying
set X is actually a subset of V and that m is the restriction of s to Pf(X) on the
level of underlying functions. First of all, one sees that X = V on the level of sets.
Let P be set of trees w ‚ààW for which one has that
w ‚ààV ‚áíw ‚ààX.
That P = W can be proved by transÔ¨Ånite induction, which immediately shows that
X = V as sets.
For suppose supat ‚ààW and tb ‚ààP for all b ‚ààBa (here a ‚àà
A, t: Ba
/ W, of course). One needs to show that supat ‚ààP, so assume that supat ‚àà
V . Because s is iso, one has that tb ‚ààV and hence, by induction hypothesis, tb ‚ààX.
Since on the level of sets, m is the restriction of s, which is a restriction of sup, one
has that supat is in X. This completes the proof.
To show, Ô¨Ånally, that the X and V are isomorphic as assemblies, I have to show that
the identity map i: V ‚ÜíX is tracked by some element r ‚ààQ. For this, let q be the
element in Q tracking m and let H be the element computing the composition of two
elements in Q (that is, H(x, y) ¬∑ n = x ¬∑ (y ¬∑ n)). Now use the fact that one can solve
recursion equations, to obtain an r satisfying the following equation:
r ¬∑ j(n0, n1) = q ¬∑ j(n0, H(r, n1)).
It is easy to see that r tracks i, by proving by a transÔ¨Ånite induction that for any tree
w ‚ààW and any decoration n of w, r ¬∑ n is deÔ¨Åned and a realiser of i(w).
This completes the proof of the fact that V is the W-type of f in the category of
assemblies. The fact that the inclusion of assemblies on Q into the realisability topos
on Q preserves W-types, is easily seen as follows. Since the inclusion preserves the
lccc structure, the inclusion also preserves the functor Pf in the sense that
Asm(Q)
i
/
Pf

RT(Q)
Pif

Asm(Q)
i
/ RT(Q)
commutes (up to natural isomorphism). Therefore the W-type in Asm(Q) is a Ô¨Åx-
point in RT(Q). It is also well-founded, because subobjects of ¬¨¬¨-separated objects

2.2. CATEGORIES WITH W-TYPES
29
are again ¬¨¬¨-separated. Therefore it is also the W-type in RT(Q) by either Theorem
2.1.5 or Theorem 2.2.3.
M-types are constructed in a similar fashion.
When f: B
/ A is a morphism of
assemblies, write M for the M-type of sets associated to the underlying function of
f in sets. Write sup for the inverse of the structure map of the coalgebra M. A
decoration for an element m = supa(t) ‚ààM is an element d ‚ààQ such that d codes
a pair ‚ü®d0, d1‚ü©, where d0 realises a = œÅ(m) and d1 ¬∑ y is deÔ¨Åned for every realiser y of
some b ‚ààBa and is a decoration of tb, in the sense that it codes a pair ‚ü®e0, e1‚ü©, where
. . . etcetera (somewhat pedantically, one can say that the notion of a decoration is
coinductively deÔ¨Åned). More formally, say that a sequence of elements
‚ü®d0, e0, d1, e1, . . . , dn‚ü©
in Q tracks a path
‚ü®m0, b0, m1, b1, . . . , mn‚ü©
in M, when j0(di) realises œÅ(mi), ei realises bi and j1(di)¬∑ei = ei+1. An element d ‚ààQ
is a decoration for m, when every path starting from m is tracked by a sequence
beginning with d. The advantage of deÔ¨Åning the M-type in this manner, is that it
makes clear that any reliance on impredicative methods turns out be only apparent.
Since this deÔ¨Ånition in the case of well-founded trees coincides with the deÔ¨Ånition
given above, this means that both the construction of the W-type as that of the
M-type can also be performed within a predicative metatheory, as long as W-types,
respectively M-types are available in that metatheory.
Modest sets 2.2.7
Again, Ô¨Åx a pca Q. A modest set on Q consists of a set X
together with a function [‚àí]X: X
/ PiQ mapping distinct elements of X to disjoint
subsets of Q. Again, one writes a ‚ä¢X x or simply a ‚ä¢x to mean a ‚àà[x]X, and one
says that a realises x. Equivalently, a modest set as a set X together with a relation
‚ä¢X‚äÜQ √ó X satisfying
x = y ‚áî‚àÉa ‚ààQ: a ‚ä¢x and a ‚ä¢y.
A morphism of modest sets from (X, ‚ä¢X) to (Y, ‚ä¢Y ) is a function of sets f: X
/ Y
having the property that there is a t ‚ààQ tracking f in the sense that for all a ‚àà
Q, x ‚ààX
a ‚ä¢x ‚áít ¬∑ a ‚Üìand t ¬∑ a ‚ä¢f(x).
In this way one obtains a category Mod(Q), another regular ML-category that is a
full subcategory of the realisability topos on Q, where the inclusion is a morphism of
regular ML-categories.
Mod(Q) is equivalent to the category PER(Q) of partial equivalence relations on Q.
A partial equivalence relation (or simply a PER) on Q is a symmetric, transitive
relation on Q. If R and S are partial equivalence relations on Q, one calls f ‚ààQ
equivalence preserving, when for all a, b ‚ààQ
aRb ‚áíf ¬∑ a ‚Üì, f ¬∑ b ‚Üìand (f ¬∑ a)S(f ¬∑ b).

30
CHAPTER 2. INDUCTION IN CATEGORIES
Two equivalence preserving elements f, g ‚ààP are considered equivalent when (f ¬∑
a)S(g ¬∑ a) for all a ‚ààP. A morphism of PERs is an equivalence class of equivalence
preserving elements. A good reference on modest sets and PERs is [13].
Usually, when people talk about PERs, they mean partial equivalence relation on the
pca K1, but the deÔ¨Ånition makes good sense for any pca. For example, as proved
in [13], when Q is Scott‚Äôs graph model Pœâ, PER(Q) is equivalent to the category
of countably based equilogical spaces, which, for that reason, is also a regular ML-
category.
That Mod(Q) for any pca Q has both W-types and M-types is pointed out in [13].
But the description there is not very concrete, and one can easily give a concrete
description along the lines of the previous example, so that is what I will do here.
Fix a morphism f: B
/ A of modest sets. Let W be the W-type of the underlying
map of f in sets. Again, deÔ¨Åne a function E: W
/ PQ by transÔ¨Ånite induction as
follows: E(supat) consists of those elements n = j(n0, n1) ‚ààQ such that (i) n0 realises
a; and (ii) n1 tracks t, that is, for every b ‚ààBa and every realiser m of b, n1 ¬∑ m is
deÔ¨Åned and a member of E(tb). I call a member n of E(w) a decoration or a realiser
of the tree w ‚ààW. By a straightforward proof by transÔ¨Ånite induction, one shows
that E maps distinct well-founded trees to disjoint subsets. So if V is a the set of
all decorated trees (w ‚ààW such that Ew Ã∏= ‚àÖ), then (V, E) is a modest set, which
is actually the W-type for f in modest sets. The proof of this fact is completely
similar to the one given above and therefore omitted. The inclusion of modest sets
over a pca into the realisability topos over that pca again preserves W-types, because
it preserves the lccc structure and modest sets are closed under subobjects in RT(Q).
Also the construction of M-types contains no surprises.
Heyting-valued sets 2.2.8
The category of sets valued on a frame forms another
regular ML-category. Let H be a frame (a.k.a. a complete Heyting algebra). An
object of the category H+ of H-valued sets is a set X together with a function
[‚àí]X: X
/ H. A function f: X
/ Y is a morphism of H-valued sets, whenever for
all x ‚ààX, [x]X ‚â§[f(x)]Y . It is not so hard to see that it is a regular ML-category, but
references seem to be scarce (some facts are collected in [59] and [66]). The presence
of W-types and M-types appears to be new.
For a morphism f: B
/ A of H-valued sets, Pf(X) for an H-valued set X is con-
structed as follows. Writing | . . . | for the obvious forgetful functor | . . . |: H+
/ Sets,
|Pf(X)| = P|f|(|X|). An element (a, t) ‚àà|Pf(X)| is then mapped to
^
b‚ààBa
([b] ‚áí[tb]) ‚àß[a].
The W-type Wf is then also computed as in sets on the level of the underlying sets.
An element supa(t) has the above expression as its value (this inductively deÔ¨Ånes an
element in H for the well-founded tree). M-types are a bit more involved, but not
harder, to describe, and will be omitted.

2.2. CATEGORIES WITH W-TYPES
31
Heyting algebras 2.2.9
Heyting algebras can be considered as categories, like any
poset. Considered in this way, they are cartesian closed, because of the implication ‚Üí:
ab = b ‚Üía. They are in fact locally cartesian closed, because for any a in a Heyting
algebra H, H/a = {x ‚ààH | x ‚â§a} is again a Heyting algebra, with implication given
by b ‚Üíb‚Ä≤ (in H/a) = (b ‚Üíb‚Ä≤)‚àßa. So it makes sense to ask whether Heyting algebras
possess W-types and/or M-types. The curious answer is that they have both: for a
map f: b
/ a (which simply means b ‚â§a),
Pf(x) = (b ‚Üí(x ‚àßa)) ‚àßa.
So the W-type is the least Ô¨Åxpoint for this, which is ¬¨b ‚àßa, and the M-type is the
greatest Ô¨Åxpoint, which is a.
Setoids 2.2.10
The last example, for now, is built from the syntax of (intensional)
Martin-L¬®of type theory (see Appendix B for an introduction to type theory). A setoid
is a type X together with an equivalence relation, meaning a type R(x, y) in the
context x ‚ààX, y ‚ààX with proof terms for reÔ¨Çexivity, symmetry and transitivity. A
morphism of setoids from (X, R) to (Y, S) is an equivalence class of terms t of type
X ‚ÜíY preserving the equivalence relation (meaning that there is a term of type
Œ†x, y ‚ààX. R(x, y) ‚ÜíS(tx, ty)). Such terms s and t are considered equivalent, when
there is a term of type Œ†x: ‚ààX. S(sx, tx). The category obtained in this fashion,
will be denoted by Setoids.
Theorem 2.2.11 (See [60], Section 7.) Setoids is a Œ†W-pretopos.
This theorem has ‚Äúideological‚Äù importance, in that it shows that a Œ†W-pretopos is
a predicative structure (I consider Martin-L¬®of type theory to be the paradigmatic
constructive-predicative theory). In the next Chapter, I will show that Setoids is
not the free Œ†W-pretopos. This is unfortunate, because if it were, there would have
been a way in which the theory of Œ†W-pretoposes would have been useful also for
studying intensional type theory. Now it seems that all light that it will shed on
type theory, will fall on the extensional version (see the Appendix for the diÔ¨Äerence
between intensional and extensional type theory).


Chapter 3
Exact completion and glueing
This Chapter will be an exercise in ‚Äúpure predicative topos theory‚Äù. I prove two
closure properties of Œ†W-pretoposes: closure under exact completion and under glue-
ing. Closure under exact completion is especially noteworthy, because toposes are not
closed under exact completion.
As an application of these two results, I give more examples of Œ†W-pretoposes
and prove a result on the projectives in the free Œ†W-pretopos. The latter will imply
that the free Œ†W-pretopos and the category of setoids are non-equivalent.
Parts of this Chapter have appeared in [14].
3.1
Exact completion of a cartesian category
The examples of Œ†W-pretoposes that we have seen so far are toposes with nno and
the category of setoids. The categorical construction called exact completion will
provide us with a host of other examples. To show that they are examples, I need a
set of conditions on a category C for its exact completion Cex to be a Œ†W-pretopos.
As always in the theory of exact completions, the category C has to satisfy the axioms
for a Œ†W-pretopos in a weaker sense. I identify a set of conditions and I show that
for the categories satisfying these conditions the exact completion is a Œ†W-pretopos.
As it turns out, ML-categories are examples of such ‚Äúweak Œ†W-pretoposes‚Äù. This
means that the exact completion of an ML-category is a Œ†W-pretoposes, so the
ML-categories of the previous Chapter can be remedied in this way to become Œ†W-
pretoposes. It also shows that the exact completion of a topos with nno is a Œ†W-
pretopos. As exact completions of toposes are rarely toposes, this shows that there
are many Œ†W-pretoposes that are not toposes.
Intuitively, the exact completion is the universal way of constructing an exact
category out of a cartesian category. In more precise (2-categorical) terms it is the
following. Write Cart for the large category of (small) cartesian categories and Exact
for the large category of (small) exact categories. The exact completion of a given a
33

34
CHAPTER 3. EXACT COMPLETION AND GLUEING
cartesian category C is an exact category Cex, together with a cartesian embedding
y: C
/ Cex, such that for any exact category D, composition with y induces an equiv-
alence Exact(Cex, D)
/ Cart(C, D). As Joyal discovered, it is possible to explicitly
describe Cex.
Explicit description of an exact completion 3.1.1
Two parallel arrows
R
r0
/
r1
/ X
in a cartesian category C form an pseudo-equivalence relation when for any object A
in C the image of the induced function
Hom(A, R)
/ Hom(A, X) √ó Hom(A, X)
is an equivalence relation on the set Hom(A, X). These pseudo-equivalence relations
are the objects in the category Cex. A morphism from
RX
x0
/
x1
/ X
to
RY
y0
/
y1
/ Y
in Cex is an equivalence class of arrows f: X
/ Y in C for which there exists a
g: RX
/ RY such that fxi = yig for i = 0, 1. Two such arrows f0, f1: X
/ Y are
equivalent if there exists an h: X
/ RY such that fi = yih for i = 0, 1.
The embedding y is given by the obvious functor y: C
/ Cex that sends an object A
in C to
A
1A /
1A
/ A.
Besides being cartesian, the functor is evidently full and faithful. The proof that
the category thus constructed is exact and actually the exact completion of C can be
found in [21], [20].
For both the objects in the exact completion that are in the image of y and
categories that arise as exact completions, there exist remarkable characterisation
results. To state these, I need the following terminology.
Projectives, external and internal 3.1.2
An object P in a category C is (exter-
nally) projective if for any cover g: X
/ Y and any morphism f: P
/ Y , there exists
a morphism h: P
/ X such that gh = f.1 When C is cartesian, this is equivalent to:
any cover p: X
/ P has a section. An object X is covered by a projective, if there
1Some mathematicians call such objects ‚Äúregular projectives‚Äù, but as this is to distinguish them
from a class of objects that does not concern me, I do not follow their terminology.

3.1. EXACT COMPLETION OF A CARTESIAN CATEGORY
35
exists a projective P and a cover f: P
/ X. A category C has enough projectives if
any object in C is covered by a projective.
These external projectives are to be distinguished from the following class of objects.
In a cartesian category C, an object P is called internally projective, when for any
cover Y
/ X and any arrow T √ó P
/ X, there exists a cover T ‚Ä≤
/ T and map
T ‚Ä≤ √ó P
/ Y such that the square
T ‚Ä≤ √ó P
/

Y

T √ó P
/ X
commutes.
A morphism f: Y
/ X is called a choice map, when it is internally
projective as an object of C/X.
In case P is exponentiable, this coincides with the more common deÔ¨Ånition: P is
internally projective iÔ¨Äthe functor (‚àí)P preserves covers.
This means that in a
Heyting category C, for an exponentiable object A that is also internally projective,
the axiom of choice is valid ‚Äúrelative to A‚Äù, in the sense that the following scheme is
valid in the internal logic of C:
‚àÄa ‚ààA ‚àÉx ‚ààX œÜ(a, x) ‚Üí‚àÉf ‚ààXA ‚àÄa ‚ààA œÜ(a, f(a)).
The two characterisation results now are (see [21]):
Lemma 3.1.3 The objects in the image of y: C
/ Cex are, up to isomorphism, the
projectives of Cex.
Proposition 3.1.4 An exact category C is an exact completion if and only if it has
enough projectives and the projectives are closed under Ô¨Ånite limits. In that case, C
is the exact completion of the full subcategory of its projectives.
An immediate consequence is (see [16]):
Proposition 3.1.5 If C is cartesian and A an object in C, then
(C/A)ex ‚àº= Cex/yA.
One combines this with the following observation (which I am not the Ô¨Årst to
point out, see [38]) to show that morphisms of the form yf in Cex are choice maps.
Lemma 3.1.6 In an exact completion Cex of a cartesian category C, the external and
internal projectives coincide.
Proof. An internal projective is also externally projective, because in an exact com-
pletion the terminal object 1 is projective. An external projective is also internally
projective, because in an exact completion, every object is covered by an external
projective and external projectives are closed under products.
‚ñ°

36
CHAPTER 3. EXACT COMPLETION AND GLUEING
3.2
Two existence results for W-types
For the main theorem of this Chapter, explaining which categories have a Œ†W-
pretopos as exact completion, I need two auxiliary results on the existence of W-types,
to be proved here. In both cases I rely essentially on the notion of path, introduced
in the previous Chapter. Its main use is to help to deÔ¨Åne in a predicative fashion
a certain predicate or relation, that would in an impredicative context (like that of
toposes) be deÔ¨Åned using transÔ¨Ånite induction.
To state the Ô¨Årst theorem, I need the following deÔ¨Ånition.
DeÔ¨Ånition 3.2.1 A square
D
/

C

B
/ A
in a cartesian category C is called a quasi-pullback, when the induced map D
/ B√óA
C is a cover.
Theorem 3.2.2 Suppose in a Œ†-pretopos E with a natural number object, one has a
diagram of the following form:
D
[‚àí]B / /
g

B
f

C
[‚àí]A
/ / A
(3.1)
Suppose furthermore that this diagram is a quasi-pullback and that g is a choice map
for which there exists a W-type. Then there also exists a W-type for f.
Proof. Write W for the W-type for g and sup for the structure map. The idea
is to use the well-founded trees in W, whose branching type is determined by g, to
represent well-founded trees whose branching type is determined by f. Intuitively this
representation works as follows: a well-founded tree with branching type determined
by f is represented by an element w ‚ààW if it can be obtained by ‚Äúbracketing‚Äù all
labels in w.
. . .
. . .
. . .
. . .
. . .
. . .
. . .
. . .
‚Ä¢
u 99999
a
v
					
‚Ä¢
x
‚Ä¢
y
      ‚Ä¢
z
ppppppppppp
‚Ä¢
[u] =====
[a]
[v]

‚Ä¢
[x]
‚Ä¢
[y]
     ‚Ä¢
[z]
pppppppppp
a
x
L
L
L
L
L
L
L
L
L
b
y
c
z
ttttttttt
‚áí
[a]
[x]
N
N
N
N
N
N
N
N
N
[b]
[y]
[c]
[z]
ppppppppp
c
[c]
While every tree with branching type determined by f can be so represented, not
every element in W is suitable for representing such a tree. A tree supc(t) in W is

3.2. TWO EXISTENCE RESULTS FOR W-TYPES
37
suitable for representing, or representing for short, whenever for any pair d, d‚Ä≤ ‚ààg‚àí1(c)
such that [d]B = [d‚Ä≤]B, the trees td and td‚Ä≤ are representing and represent the same
tree. The trees td and td‚Ä≤ are then identiÔ¨Åed in the bracketing process.
So the question is when two (representing) elements supc(t) and supc‚Ä≤(t‚Ä≤) in W repre-
sent the same tree (in which case I will write supc(t) ‚àºsupc‚Ä≤(t‚Ä≤)). They do, whenever
[c]A = [c‚Ä≤]A and td ‚àºt‚Ä≤d‚Ä≤ for all pairs d ‚ààg‚àí1(c), d‚Ä≤ ‚ààg‚àí1(c‚Ä≤). In an impredicative
context, like the internal logic of a topos, one could deÔ¨Åne ‚àºas the unique rela-
tion having this property. Here, with a predicative metatheory, one has to work a
little harder and deÔ¨Åne ‚àºexplicitly in terms of paths. Then the property of being
representing can be deÔ¨Åned as being self-related via ‚àº.
The binary relation ‚àºon W is deÔ¨Åned as follows: w ‚àºw‚Ä≤ if and only if
all paths œÉ in Pathsw and œÉ‚Ä≤ in Pathsw‚Ä≤ having the same length (2n + 1
say) and satisfying the equality
[œÉ(2k + 1)]B = [œÉ‚Ä≤(2k + 1)]B
for all k < n, also satisfy the equality
[œÅ(œÉ(2k))]A = [œÅ(œÉ‚Ä≤(2k))]A
for all k ‚â§n (œÅ being the canonical map W ‚àº= Œ£CW g
/ C).
The reader should now verify that ‚àºhas the desired property:
supc(t) ‚àºsupc‚Ä≤(t‚Ä≤),
if and only if [c] = [c‚Ä≤] and for all d ‚ààg‚àí1(c), d‚Ä≤ ‚ààg‚àí1(c‚Ä≤): if [d] = [d‚Ä≤], then td ‚àºt‚Ä≤d‚Ä≤
(one proves this by induction).
Symmetry and transitivity of ‚àºnow follow. Symmetry is immediate, while transitiv-
ity
w ‚àºw‚Ä≤ and w‚Ä≤ ‚àºw‚Ä≤‚Ä≤ imply w ‚àºw‚Ä≤‚Ä≤
is proved by induction on w‚Ä≤, as follows. Suppose supc(t) ‚àºsupc‚Ä≤(t‚Ä≤) and supc‚Ä≤(t‚Ä≤) ‚àº
supc‚Ä≤‚Ä≤(t‚Ä≤‚Ä≤). Now clearly [c] = [c‚Ä≤‚Ä≤], because [c] = [c‚Ä≤] and [c‚Ä≤‚Ä≤] = [c‚Ä≤]. Suppose d ‚ààg‚àí1(c)
and d‚Ä≤‚Ä≤ ‚ààg‚àí1(c‚Ä≤‚Ä≤) are such that [d] = [d‚Ä≤‚Ä≤]. Since diagram (3.1) is a quasi-pullback,
there exists a d‚Ä≤ ‚ààg‚àí1(c‚Ä≤) such that [d‚Ä≤] = [d] = [d‚Ä≤‚Ä≤]. One has now that td ‚àºt‚Ä≤d‚Ä≤
and t‚Ä≤d‚Ä≤ ‚àºt‚Ä≤‚Ä≤d‚Ä≤‚Ä≤, and so td ‚àºt‚Ä≤‚Ä≤d‚Ä≤‚Ä≤ by induction hypothesis. This shows that supc(t) ‚àº
supc‚Ä≤‚Ä≤(t‚Ä≤‚Ä≤).
A w = supc(t) ‚ààW such that w ‚àºw will be called a representing tree. The point is
that such a tree has the desired property that for any pair d, d‚Ä≤ ‚ààg‚àí1(c), td and td‚Ä≤
represent the same tree. Denote the set of all representing trees by R and observe
that R is closed under subtrees.

38
CHAPTER 3. EXACT COMPLETION AND GLUEING
Now, ‚àºis an equivalence relation on R and hence one can form the quotient V ,
together with a quotient map q: R
/ V . This map q sends a representing tree to the
tree it represents. Let me also deÔ¨Åne an object R‚àóin E/C by setting for c ‚ààC:
R‚àó
c
=
{ t ‚ààW g‚àí1(c) | supc(t) ‚ààR }
Or, equivalently: t ‚ààR‚àó
c if and only if
for any d, d‚Ä≤ ‚ààg‚àí1(c) such that [d]B = [d‚Ä≤]B, one has that t(d) ‚àºt(d‚Ä≤).
One clearly has a commuting diagram
Œ£CR‚àó/
/
sup

Œ£CW g
sup

R /
/ W
(in fact, this diagram is a pullback). I will now construct a commuting diagram of
the following form:
Œ£CR‚àó
q‚àó/ /
sup

Œ£AV f
s

R
q
/ / V
(3.2)
To see that there is a morphism q‚àó: Œ£CR‚àó
/ Œ£AV f in E, one needs to note that the
subobject
Q‚àó
=
{ (t, h) ‚ààŒ£CR‚àó√ó Œ£AV f | Q‚àó(t, h) }
where Q‚àó(t, h) is the statement:
for the particular c ‚ààC and a ‚ààA such that t ‚ààR‚àó
c and h ‚ààV f‚àí1(a), one
has that [c]A = a and for all d ‚ààg‚àí1(c) that q(t(d)) = h([d]B).
is functional (for the deÔ¨Ånition of a functional relation, see Appendix A). The map
q‚àóso constructed is a cover: for let h be an arbitrary element of V f‚àí1(a) for a certain
a ‚ààA. Pick a c ‚ààC such that [c]A = a. One has
‚àÄd ‚ààg‚àí1(c) ‚àÉr ‚ààR: q(r) = h([d]B),
since q is a cover. Since g is a choice map, there is a map t: g‚àí1(c)
/ R such that
q(t(d)) = h([d]B) for all d ‚ààg‚àí1(c). If d, d‚Ä≤ ‚ààg‚àí1(c) are such that [d]B = [d‚Ä≤]B, then
q(t(d)) = h([d]B) = h([d‚Ä≤]B) = q(t(d‚Ä≤)),
so t(d) ‚àºt(d‚Ä≤). This means that t ‚ààR‚àó
c and hence that (t, h) ‚ààQ‚àó. Since h was
arbitrary, this means that q‚àóis a cover.

3.2. TWO EXISTENCE RESULTS FOR W-TYPES
39
One now constructs s: Œ£AV f
/ V in E by using the fact that in a pretopos every
epi is the coequaliser of its kernel pair. So suppose for certain c, c‚Ä≤ ‚ààC elements
t: g‚àí1(c)
/ W ‚ààR‚àóand t‚Ä≤: g‚àí1(c‚Ä≤)
/ W ‚ààR‚àóare given such that q‚àó(t) = q‚àó(t‚Ä≤).
This implies that [c]A = [c‚Ä≤]A and that
‚àÄd ‚ààg‚àí1(c), d‚Ä≤ ‚ààg‚àí1(c‚Ä≤): [d]B = [d‚Ä≤]B ‚áítd ‚àºt‚Ä≤d‚Ä≤.
This means that supc(t) ‚àºsupc‚Ä≤(t‚Ä≤). Using the coequaliser property of q‚àó, this gives
a morphism s: Œ£AV f
/ V making (3.2) commute.
This map s is actually monic. For suppose sa(h) = sa‚Ä≤(h‚Ä≤) for some h: f ‚àí1(a)
/ V
and h‚Ä≤: f ‚àí1(a‚Ä≤)
/ V . There are t: g‚àí1(c)
/ W and t‚Ä≤: g‚àí1(c‚Ä≤)
/ W, both in Œ£CR‚àó,
such that q‚àót = h and q‚àóg‚Ä≤ = h‚Ä≤. But now qsupa(t) = qsupa‚Ä≤(t‚Ä≤), i.e. supa(t) ‚àº
supa‚Ä≤(t‚Ä≤). But this implies [c] = [c‚Ä≤], so a = a‚Ä≤, and also that for all d ‚ààg‚àí1(c) and
d‚Ä≤ ‚ààg‚àí1(c‚Ä≤) such that [d] = [d‚Ä≤], td ‚àºt‚Ä≤d‚Ä≤. Hence q‚àót = q‚àót‚Ä≤ and h = h‚Ä≤. So s is monic.
But as s is also clearly epic, s is in fact an isomorphism.
I now claim that the Pf-algebra (W, s: Pf(W)
/ W) is actually the W-type for f. I
work towards applying Theorem 2.1.5.
Now, if S is a subalgebra of V , i.e. a subobject of V for which one has that
‚àÄa ‚ààA ‚àÄh: f ‚àí1(a)
/ V (‚àÄb ‚ààf ‚àí1(a) (hb ‚ààS) ‚áísa(h) ‚ààS),
let T be the following subobject of W:
{ w ‚ààW | if w is representing, then q(w) ‚ààS }.
I prove that T = W as subobjects of W by induction. This will immediately imply
that S = V as subobjects of V . Suppose w = supc(t) ‚ààW is such that td ‚ààT for all
d ‚ààg‚àí1(c). I assume that w is representing and want to prove that qw ‚ààS.
Because w is representing, the trees td (d ‚ààg‚àí1(c)) are representing as well. Since
they belong to T, q(td) belongs to S. This means that for h = q‚àót, hb ‚ààS for all
b ‚ààf ‚àí1(a), where a = [c]. So sa(h) ‚ààS, but sa(h) = saq‚àó(t) = qsupc(t).
So V is the W-type for f by Theorem 2.1.5 and the proof of Theorem 3.2.2 is com-
pleted.
‚ñ°
Theorem 3.2.3 Let E be a Œ†-pretopos with natural number object and f: B
/ A be
a choice map in E. Assume that in a Pf-coalgebra V with the following two properties
exists: (1) its structure map s is a cover; (2) the only subobject R of V for which
v ‚ààV, s(v) = (a, t) and tb ‚ààR for all b ‚ààf ‚àí1(a) imply that v ‚ààR
is the subobject V itself. Then a W-type for f exists.
Proof. The idea is to turn s into an isomorphism. This means identifying those v
and v‚Ä≤, with the property that for (a, t) = s(v) and (a‚Ä≤, t‚Ä≤) = s(v‚Ä≤), one has that both

40
CHAPTER 3. EXACT COMPLETION AND GLUEING
a = a‚Ä≤ and t and t‚Ä≤ are extensionally equal functions. In other words, I need a relation
‚àºon V such that:
v ‚àºv‚Ä≤
‚áî
if (a, t) = s(v) and (a‚Ä≤, t‚Ä≤) = s(v‚Ä≤), then a = a‚Ä≤ and
tb ‚àºt‚Ä≤b for all b ‚ààf ‚àí1(a).
(3.3)
In other contexts, I might turn to a transÔ¨Ånite induction to construct such a relation,
but here I again rely on paths.
First, I deÔ¨Åne an equivalence relation on the object of paths in V . I will call œÉ and
œÉ‚Ä≤ equivalent if they satisfy three conditions:
1. they have the same length, 2n + 1 say.
2. they satisfy the equation
œÉ(2k + 1) = œÉ‚Ä≤(2k + 1)
for all k < n.
3. they satisfy the equation
œÅ(œÉ(2k)) = œÅ(œÉ‚Ä≤(2k))
for all k ‚â§n (œÅ being the root map).
Then I deÔ¨Åne the following equivalence relation on V :
v ‚àºv‚Ä≤
iÔ¨Ä
for every œÉ in Pathsv there exists an equivalent œÉ‚Ä≤
in Pathsv‚Ä≤ and for every œÉ‚Ä≤ in Pathsv‚Ä≤ there exists
an equivalent œÉ in Pathsv.
The reader should verify that ‚àºnow has the desired property 3.3.
Consider the quotient W = V/ ‚àºand the quotient map q: V
/ W. Note that Pfq
is also a cover, because f is a choice map. I now want to complete the following
diagram:
V
q
/ /
s 
V
m

PfV
Pfq
/ / PfV.
Using that in a pretopos every epi is the coequaliser of its kernel pair and the fact that
‚àºsatisÔ¨Åes 3.3, one can show that an isomorphism m making the diagram commute,
exists. Call its inverse n.
The proof will be completed once I show that (W, n: PfW
/ W) satisÔ¨Åes the condi-
tions of Theorem 2.1.5. n is certainly mono, so let A be an arbitary Pf-subalgebra of
W. DeÔ¨Åne
R = { v ‚ààV | q(v) ‚ààA }

3.3. Œ†W-PRETOPOSES AS EXACT COMPLETIONS
41
It is easy to see that R satisÔ¨Åes the hypothesis of condition (2): for assume s(v) = (a, t)
and tb ‚ààR for all b ‚ààf ‚àí1(a). This means that q(tb) ‚ààA for all b ‚ààf ‚àí1(a), and hence
na(qt) ‚ààA because A is subalgebra of W. But na(qt) = (nPfq)(a, t) = (nPfqs)(v) =
q(v). So R = V and hence A = W.
‚ñ°
3.3
Œ†W-pretoposes as exact completions
This Section isolates a set of conditions on a cartesian category C suÔ¨Écient for its
exact completion to be a Œ†W-pretopos.
SuÔ¨Écient (and necessary) conditions for
the exact completion to be a Œ†-pretopos can be extracted from the literature, but
suÔ¨Écient conditions for the exact completion to have W-types were unknown. I will
recall the results available from the literature and then introduce the notion of a
‚Äúweak W-type‚Äù. In this way, I arrive at the notion of a ‚Äúweak Œ†W-pretopos‚Äù, and
prove the main theorem of this Section:
Theorem 3.3.1 If C is a weak Œ†W-pretopos, then Cex is a Œ†W-pretopos.
How this can be used to give more examples of Œ†W-pretoposes will be the subject of
the next Section.
The following terminology and results are taken from the literature, especially
Menni‚Äôs PhD thesis [59]. C is always a cartesian category.
Proposition 3.3.2 (See [59], proposition 4.4.1.) The exact completion of C is a pre-
topos if and only if C has Ô¨Ånite, disjoint and stable sums. In this case, the embedding
y: C
/ Cex preserves the sums.
For the exact completion to be locally cartesian closed, one weakens the require-
ment for dependent products, by dropping the uniqueness clause. So:
DeÔ¨Ånition 3.3.3 For two morphisms c: C
/ J and t: J
/ I in a cartesian category
C, the dependent product of c along t is an object w: W
/ I in C/I together with
a morphism Œµ: t‚àów
/ c in C/J such that for any object m: M
/ I in C/I together
with a morphism h: t‚àóm
/ c in C/J there exists a unique morphism H: m
/ w in
C/I such that h = Œµ ‚ó¶t‚àóH in C/J.
DeÔ¨Ånition 3.3.4 For two morphisms c: C
/ J and t: J
/ I in a cartesian category
C, a weak dependent product of c along t is an object w: W
/ I in C/I together with
a morphism Œµ: t‚àów
/ c in C/J such that for any object m: M
/ I in C/I together
with a morphism h: t‚àóm
/ c in C/J there exists a (not necessarily unique) morphism
H: m
/ w in C/I such that h = Œµ ‚ó¶t‚àóH in C/J. One says that a cartesian category
C has weak dependent products if it has all possible weak dependent products.

42
CHAPTER 3. EXACT COMPLETION AND GLUEING
The following proposition is contained in [22] (see also [16]):
Proposition 3.3.5 The exact completion Cex of a cartesian category C is locally
cartesian closed if and only if C has weak dependent products.
Remark 3.3.6 Unfortunately, the authors do not point out, although it follows
from their proofs, that in case C has genuine dependent products, the embedding
y: C
/ Cex preserves them. Hence the following argument.
By Proposition 3.1.5, it suÔ¨Éces to show that y preserves exponentials. How are
exponentials of projectives A and B computed in Cex? It is not hard to see that you
can compute BA in C and obtain the exponential in Cex by taking the quotient of the
following equivalence relation:
R = {(f, g) |‚àÄb ‚ààB.f(b) = g(b)}
/
/ y(BA).
For the purpose of computing the universal quantiÔ¨Åer ‚àÄb ‚ààB, let me introduce the
notion of a proof.
For any object X in C, pre-order the slice category C/X by declaring that
A
/ X ‚â§B
/ X,
whenever there is a morphism A
/ B making the obvious triangle commute. The set
of proofs (or weak subobjects) Prf X is then the poset obtained by identifying A
/ X
and B
/ X in case both A
/ X ‚â§B
/ X and B
/ X ‚â§A
/ X. Clearly, any
morphism f: Y
/ X in C induces an order-preserving map f ‚àó: Prf X
/ Prf Y by
pullback.
The fact that C has weak dependent products means precisely that f ‚àó
always has a right adjoint. When C has genuine dependent products, these right
adjoints can be computed by taking these real dependent products.
The functor y now induces an order-preserving bijection Prf X
/ Prf yX, ba-
sically by taking images, commuting with f ‚àófor any morphism f: Y
/ X in C.
This means that in Cex, the operation of pulling back subobjects along a morphism
f: Y
/ X between projectives, has a right adjoint, and for this reason universal
quantiÔ¨Åers along such f exist. The universal quantiÔ¨Åer that concerns me is precisely
of this form, so, in a way, it can be computed ‚Äútype-theoretically‚Äù (by taking Œ†f) in
the original category C.
Therefore, to compute R in Cex, I should take the following object in C:
Œ£f,g‚ààABŒ†b‚ààB{‚àó| f(b) = g(b)}.
But this is just AB, because the principle of extensionality holds in C. So the equiv-
alence relation in question takes the following form:
y(BA)
/
/ y(BA).
Hence its quotient is simply y(BA), and therefore y preserves exponentials.

3.3. Œ†W-PRETOPOSES AS EXACT COMPLETIONS
43
There are a number of special cases of the notion of a weak dependent product
that will be important later on. There is the weak exponential, which is a weakening
of the familiar notion of an exponential. A weak version of the exponential Y X can be
deÔ¨Åned as a weak dependent product of the projection X √ó Y
/ X along X
/ 1.
More concretely this means that it is an object Z together with a ‚Äúweak evaluation‚Äù
Œµ: Z √ó X
/ Y such that for every map h: X √ó A
/ Y there is a (not necessarily
unique) morphism H: A
/ Z such that h = Œµ ‚ó¶(X √ó H).
Furthermore, there is the notion of a weak simple product. Not surprisingly, this
is the weakening of the notion of a simple product, which may not be so familiar.
One calls
W √ó K
œµ
/
w√óK
L
L
L
L
%L
L
L
L
C
c

I √ó K
(3.4)
a simple product diagram, if for any other such diagram
X √ó K
f
/
x√óK
K
K
K
K
%K
K
K
K
C
c

I √ó K
there exists a unique f ‚Ä≤: X
/ W over I such that f = œµ ‚ó¶(f ‚Ä≤ √ó K). In this case
w: W
/ I together with œµ will be the simple product of c: C
/ I √ó K with respect
to K. (Observe that this is equivalent to being the dependent product of c: C
/ I√óK
along the projection I √ó K
/ I.)
If one drops the uniqueness condition for f ‚Ä≤, then diagram (3.4) is called a weak
simple product diagram.
w together with œµ will be called a weak simple product
and this is equivalent to being a weak dependent product of c along the projection
I √ó K ‚ÜíI.
In addition, one can weaken the notion of a natural number object.
DeÔ¨Ånition 3.3.7 Let C be a cartesian category. A diagram
1
/ A
/ A
is called an inductive structure. t: A
/ B is a morphism of inductive structures with
domain 1
/ A ‚ÜíA and codomain 1
/ B
/ B, if the following diagram commutes:
A
/
t

A
t

1
?







?
?
?
?
?
?
?
?
B
/ B

44
CHAPTER 3. EXACT COMPLETION AND GLUEING
A natural number object is an inductive structure
1
0
/ N
s
/ N
that is initial in the category of inductive structures. It is a weak natural number
object if it is weakly initial in the category of inductive structures (meaning that for
any inductive structure 1
/ A
/ A there exists a morphism of inductive structures
t: N
/ A).
The following result follows from Proposition 5.1 in [16]:
Proposition 3.3.8 If C is cartesian category with weak dependent products and a
weak natural number object, then Cex has a natural number object.
The results contained in the literature can therefore be summarized as follows:
Corollary 3.3.9 When C is a cartesian category with Ô¨Ånite, disjoint sums, weak
dependent products and a weak natural number object, Cex is a Œ†-pretopos with a
natural number object.
Proof. Combine Proposition 3.3.2, Proposition 3.3.5 and Proposition 3.3.8.
‚ñ°
What is missing is a suÔ¨Écient condition for the exact completion to have W-types.
To Ô¨Åll this gap, I will introduce the notion of a ‚Äúweak W-type‚Äù, inspired by Theorem
2.1.5, and subsequently prove that it has the desired property. Unfortunately, it is
also rather involved. To make things easier it will be good to set some notation and
terminology.
Fix a morphism f: B
/ A in a cartesian category C. As in any cartesian category,
one has for any object X in C two functors: X‚àó: C
/ C/X (the pullback along
X
/ 1) and Œ£X: C/X
/ C (its left adjoint, given by composition).
DeÔ¨Ånition 3.3.10 A Pf-structure is a quadruple (4-tuple) x = (X, X‚àó, œÉX, ŒµX) with
X an object in C, X‚àóan object in C/A, œÉX a map Œ£A(X‚àó) ‚ÜíX in C and ŒµX a map
X‚àó√óf
/ A‚àóX in C/A. A homomorphism of Pf-structures from x = (X, X‚àó, œÉX, ŒµX)
to z = (Z, Z‚àó, œÉZ, ŒµZ) is a pair t = (t, t‚àó), where t is a map in C from X to Z, and t‚àóis
a map from X‚àóto Z‚àóin C/A. Furthermore, the following diagrams should commute:
Œ£AX‚àóŒ£At‚àó/
œÉX

Œ£AZ‚àó
œÉZ

X
t
/ Z
X‚àó√ó f
t‚àó√óf /
ŒµX

Z‚àó√ó f
ŒµZ

A‚àóX
A‚àót
/ A‚àóZ
It is easy to see that this deÔ¨Ånes a category, one I shall denote by Pf(C).

3.3. Œ†W-PRETOPOSES AS EXACT COMPLETIONS
45
DeÔ¨Ånition 3.3.11 A map t: x
/ z in Pf(C) is said to be a weak Pf-substructure
map, if for the pullback L in this diagram in C/A:
L
p0
/
p1

Z‚àó√ó f
ŒµZ

A‚àóX
A‚àót
/ A‚àóZ
the following is a weak simple product diagram:
X‚àó√ó f
Œ±X
/
t‚àó√óf
%K
K
K
K
K
K
K
K
K
K
L
p0

Z‚àó√ó f
where Œ±X = ‚ü®(t‚àó√ó f), ŒµX‚ü©.
Before I can deÔ¨Åne weak W-types, I Ô¨Årst have to deÔ¨Åne the notion of a weak
Pf-algebra.
DeÔ¨Ånition 3.3.12 A weak Pf-algebra is a Pf-structure
x = (X, X‚àó, œÉX, ŒµX)
such that X‚àóis a weak version of the exponential (A‚àóX)f in C/A with ŒµX as weak
evaluation map. The morphisms of weak Pf-algebras are simply the morphisms of Pf-
structures. (So the category of weak Pf-algebras is a full subcategory of the category
of Pf-structures.)
DeÔ¨Ånition 3.3.13 A morphism t = (t, t‚àó: x
/ z) is a weak Pf-subalgebra, if it is a
weak Pf-substructure and both x and z are weak Pf-algebras.
It would have been enough to require that z is weak Pf-algebra, in view of the
following easy lemma.
Lemma 3.3.14 If t: x
/ z is a weak Pf-substructure map and z is a weak Pf-
algebra, then so is x.
And Ô¨Ånally:
DeÔ¨Ånition 3.3.15 A weak W-type for f is a weak Pf-algebra v with two properties:
(i) its structure map œÉV is an isomorphism; (ii) every weak Pf-subalgebra i: x
/ v
has a section.

46
CHAPTER 3. EXACT COMPLETION AND GLUEING
The second property (ii) is supposed the be a weakening of the property of having no
proper subalgebras. Although very technical, I would like to stress that the property
is precisely what one would expect, in that it is the strong property with unique-
ness clauses dropped and subobjects replaced by ‚Äúweak subobjects‚Äù or ‚Äúproofs‚Äù (see
above).
In the deÔ¨Ånition, it would have been suÔ¨Écient to require that the structure map
œÉV is monic, because of the following lemma:
Lemma 3.3.16 If w = (W, W ‚àó, œÉW, ŒµW) is a weak Pf-algebra for some f in a carte-
sian category C with weak dependent products with the property that every weak Pf-
subalgebra t: x
/ w has a section, then the structure map œÉW has a section.
(For those who know how to derive Lambek‚Äôs result concerning initial algebras, prov-
ing this lemma should be easy.)
Lemma 3.3.17 Let C be a locally cartesian closed category.
A W-type Wf for a
morphism f: B
/ A is also a weak W-type for f.
Proof. It is easy to see that Wf can be considered as a weak Pf-algebra w. Then the
Ô¨Årst condition for being a weak W-type is certainly satisÔ¨Åed, because sup: PfWf
/ Wf
is an isomorphism. To verify the second condition, let x = (X, X‚àó, œÉX, ŒµX) be any
weak Pf-algebra and t = (t, t‚àó): x
/ w be a weak Pf-subalgebra morphism in C. Be-
cause t is a weak Pf-subalgebra, there is a morphism r: (A‚àóX)f
/ X‚àóin C/A such
that t‚àór = (A‚àót)f. Now (X, œÉXŒ£Ar: PfX
/ X) is a Pf-algebra and t is a morphism
of Pf-algebras from this algebra to Wf. Hence t has a section u in the category of
Pf-algebras. Then s = (u, r(A‚àóu)f) is a section of t.
‚ñ°
DeÔ¨Ånition 3.3.18 A cartesian category C is called a weak Œ†W-pretopos, if it has
Ô¨Ånite disjoint and stable sums, weak dependent products, a weak natural number
object and weak W-types for all morphisms.
Now the main theorem of this Section has a precise meaning.
Theorem 3.3.19 (= Theorem 3.3.1.) If C is a weak Œ†W-pretopos, then Cex is a
Œ†W-pretopos.
To prove this theorem, it suÔ¨Éces to show that Cex has W-types for all maps lying
in the image of y (proof: use the remark before Lemma 3.1.6 to see that these are
choice maps and then apply Theorem 3.2.2). So the main theorem will follow from:
Proposition 3.3.20 Let C be a cartesian category with Ô¨Ånite disjoint and stable
sums, weak dependent products and a weak natural number object. If C has a weak
W-type for a map f in C, then Cex has a genuine W-type for the map yf.

3.3. Œ†W-PRETOPOSES AS EXACT COMPLETIONS
47
To prove Proposition 3.3.20, I will make use of Theorem 3.2.3. What I show is
that if w = (W, W ‚àó, œÉW, ŒµW) is a weak W-type in C for a map f: B
/ A, then yW
has the structure of a Pyf-coalgebra in Cex, with the special properties formulated in
Theorem 3.2.3. This is established by the following sequence of lemmas.
Warning 3.3.21
In the remainder of this Section, I will drop the occurences of y;
I trust that the reader will not get confused.
From now on, suppose C is a cartesian category with Ô¨Ånite disjoint and stable
sums, weak dependent products and a weak natural number object, and suppose that
w = (W, W ‚àó, œÉW, ŒµW) is a weak W-type for a map f: B
/ A in C.
Lemma 3.3.22 The unique map q: W ‚àó
/ (A‚àóW)f in Cex/A such that
W ‚àó√ó f
q√óf
/
ŒµW
%J
J
J
J
J
J
J
J
J
J
(A‚àóW)f √ó f
ev
xpppppppppp
A‚àóW
commutes is a cover.
Proof. Since w is a weak Pf-algebra, one knows that W ‚àóis a weak version of (A‚àóW)f
in C/A. One can now deÔ¨Åne the equivalence relation
Ra = { (g, h) ‚ààW ‚àó
a √ó W ‚àó
a | ‚àÄb ‚ààf ‚àí1(a): ŒµW(g, b) = ŒµW(h, b) }
on W ‚àó
a (a ‚ààA) in Cex/A. It is not diÔ¨Écult to see that the quotient W ‚àó/R in Cex/A
is a strong version of the exponential (A‚àóW)f. So q is (up to iso) the quotient map
and hence a cover.
‚ñ°
This establishes that W has the structure of a Pf-coalgebra in Cex, with an epic
structure map
n: W
œÉ‚àí1
W / / Œ£AW ‚àóŒ£Aq / / PfW = Œ£A(A‚àóW)f.
Notice that w is also a Pf-structure in Cex, via y.
Lemma 3.3.23 If r = (R, R‚àó, œÉR, ŒµR) is a Pf-structure in Cex and t: r
/ w is a
weak Pf-substructure map, then t has a section in Pf(Cex).
Proof. Consider the pullback L in Cex/A in the diagram
L
p0
/
p1

W ‚àó√ó f
ŒµW

A‚àóR
A‚àót
/ A‚àóW

48
CHAPTER 3. EXACT COMPLETION AND GLUEING
Since t is a weak Pf-substructure map, the following is a weak simple product dia-
gram:
R‚àó√ó f
Œ±R
/
t‚àó√óf
%L
L
L
L
L
L
L
L
L
L
L
p0

W ‚àó√ó f
where Œ±R = ‚ü®(t‚àó√ó f), ŒµR‚ü©.
Let Œæ: K
/ R be a cover by an object in the image of y. Now consider the following
two pasted pullback diagrams:
L‚Ä≤
l0
/
l1

L
p0
/
p1

W ‚àó√ó f
ŒµW

A‚àóK
A‚àóŒæ
/ A‚àóR
A‚àót
/ A‚àóW
Since the objects K, W and W ‚àó√ó f lie in the image of y, and since this functor
preserves pullbacks, I may assume that L‚Ä≤ also lies in the image of y.
Construct the following pullback:
L‚Ä≤‚Ä≤
j0
/
j1

L‚Ä≤
l0

R‚àó√ó f
Œ±R / L
And construct the strong version of Œ†œÄ0(j1) in Cex/A (where œÄ0 is the projection
R‚àó√ó f
/ R‚àó). This means that one has an object K‚àó
0 with maps Œæ‚àó
2: K‚àó
0
/ R‚àóand
Œ±K0: K‚àó
0 √ó f
/ L‚Ä≤‚Ä≤ such that
K‚àó
0 √ó f
Œ±K0
/
Œæ‚àó
2√óf
%K
K
K
K
K
K
K
K
K
K
L‚Ä≤‚Ä≤
j1

R‚àó√ó f
is a simple product diagram.
It is not hard to verify that
K‚àó
0 √ó f
j0Œ±K0
/
(t‚àóŒæ‚àó
2)√óf
L
L
L
%LLLL
L‚Ä≤
p0l0

W ‚àó√ó f
is a weak simple product diagram. Now let Œæ‚àó
1: K‚àó
/ K‚àó
0 be a cover by an element
in the image of y. This implies that
K‚àó√ó f
Œ±K
/
(t‚àóŒæ‚àó)√óf
L
L
L
L
%L
L
L
L
L‚Ä≤
p0l0

W ‚àó√ó f
(3.5)

3.3. Œ†W-PRETOPOSES AS EXACT COMPLETIONS
49
with Œ±K = j0Œ±K0(Œæ‚àó
1√óf) and Œæ‚àó= Œæ‚àó
2Œæ‚àó
1, can be seen as a weak simple product diagram
in C/A.
Using the fact that K‚àóis projective, one constructs a map œÉK making
Œ£AK‚àóŒ£AŒæ‚àó/
œÉK

Œ£AR‚àó
œÉR

K
Œæ
/ / R
commutative. This means that one has a Pf-structure k = (K, K‚àó, œÉK, ŒµK = l1Œ±K) in
Cex, that can also be seen as a Pf-structure in C, and a Pf-structure map Œæ = (Œæ, Œæ‚àó)
in Cex. Now tŒæ can be seen as a Pf-structure map in C, and it is actually a weak
Pf-substructure map in C (since (3.5) is a weak simple product diagram). Therefore
k can be seen as a weak Pf-algebra in C, and since w is a weak W-type in C, one has
a Pf-structure map s‚Ä≤ such that (tŒæ)s‚Ä≤ = 1W in Pf(C) and Pf(Cex). So s = Œæs‚Ä≤ is a
Pf-structure map in Cex that is a section of t.
‚ñ°
Corollary 3.3.24 Let R ‚äÜW be a subobject in Cex and assume that the following
statement holds in the internal logic of Cex:
‚àÄw ‚ààW ( If n(w) = (a, t) and ‚àÄb ‚ààf ‚àí1(a): tb ‚ààR , then w ‚ààR ).
(3.6)
Then R = W as subobjects of W.
Proof. DeÔ¨Åne the following object in Cex/A: for any a ‚ààA
R‚àó
a = { œÑ ‚ààW ‚àó
a | ‚àÄb ‚ààf ‚àí1(a): projW(ŒµW(œÑ, b)) ‚ààR }.
Or, equivalently:
R‚àó
a = { œÑ ‚ààW ‚àó
a | ‚àÄb ‚ààf ‚àí1(a): qa(œÑ)(b) ‚ààR }.
The validity of statement (3.6) implies that for the inclusion map j‚àó: R‚àó
/ W ‚àó,
œÉWŒ£Aj‚àófactors through R. For if œÑ ‚ààR‚àó
a, write w = (œÉWŒ£j‚àó)(œÑ). Since n(w) =
(qŒ£j‚àó)(œÑ) = (a, q(œÑ)), q(œÑ)(b) ‚ààR for all b ‚ààf ‚àí1(a), and so w ‚ààR. Hence there is a
map œÉR making
Œ£R‚àó
Œ£j‚àó/
œÉR

Œ£W ‚àó
œÉW

R
j
/ W
commute. By the Ô¨Årst deÔ¨Ånition of R‚àó, the map ŒµW(j‚àó√ó f) factors through A‚àóR, so
one has a map ŒµR making
R‚àó√ó f
j‚àó√óf /
ŒµR

W ‚àó√ó f
ŒµW

A‚àóR
A‚àój
/ A‚àóW

50
CHAPTER 3. EXACT COMPLETION AND GLUEING
commute. So r = (R, R‚àó, œÉR, ŒµR) is a Pf-structure in Cex and j = (j, j‚àó) is a Pf-
structure map. It is actually a weak Pf-substructure map, so j has a section s: w
/ r.
This implies that j is iso, and R = W as subobjects.
‚ñ°
This completes the proof of the main result, Theorem 3.3.1.
3.4
More examples of Œ†W-pretoposes
I have identiÔ¨Åed a categorical structure, that of a weak Œ†W-pretopos, whose exact
completion always is a Œ†W-pretopos. Using this, I give several more examples of Œ†W-
pretoposes. One of them is what one might call a ‚Äúpredicative realisability topos‚Äù,
which is analogous to the realisability toposes in topos theory.
Exact completion of an ML-category 3.4.1
Any ML-category C is a weak Œ†W-
pretopos. It is clear that a category that has genuine dependent products, also has
weak dependent products, and in Lemma 3.3.17, I also showed that it has all weak
W-types. Therefore:
Theorem 3.4.2 The exact completion Cex of an ML-category C is again an ML-
category. Moreover, the embedding y: C
/ Cex is a morphism of ML-categories.
Proof. That Cex is an ML-category is a direct application of Theorem 3.3.1. Of
course, y is cartesian (it always is), but it also preserves the sums and the dependent
products by Proposition 3.3.2 and Remark 3.3.6. It remains to check to y preserves
W-types.
Because y preserves Œ†, it is clear that whenever W is the W-type for a morphism
f: B
/ A in C, yW is also an algebra for Pyf in Cex. It is weakly initial for the
following reason: when X is an object with a Pyf-algebra structure t: PyfX
/ X,
cover X with a projective Y via some map q: Y
/ X. Since PyfY is again projective
(because it can be computed in C), the following diagram can be Ô¨Ålled:
PyfY
Pyfq
/

PyfX
t

Y
q
/ / X.
Therefore Y has the structure of a Pf-algebra in C and there exists a Pf-algebra
morphism p: W
/ Y . Then qp is a Pyf-algebra morphism in Cex.
But then yW is initial, because it possesses no non-trivial Pf-algebra endomorphisms.
For if m: yW
/ yW is a Pyf-algebra morphism in Cex, m is also a Pf-algebra mor-
phism in C, since y is full and faithful. Therefore m is the identity on yW. This
is suÔ¨Écient to prove that yW is initial, because whenever s, t: yW
/ X are two

3.4. MORE EXAMPLES OF Œ†W-PRETOPOSES
51
Pf-algebra morphisms, their equaliser i: E
/ yW is also a Pf-algebra, with i pre-
serving this structure. Because yW is weakly initial, there is a Pf-algebra morphism
k: yW
/ E. So ik is a Pf-algebra endomorphism on yW, hence the identity. There-
fore E = yW as subobjects of yW and s = t.
‚ñ°
This has several consequences.
First of all, the exact completions of all the ML-
categories discussed in Chapter 1 are Œ†W-pretoposes. In general, it shows that it is
not a serious loss of generality to require predicative toposes to be exact. The reason
for including it is that exactness is very useful in obtaining models of set theory.
Prima facie this might look unnecessarily restrictive, but I believe that this result
shows that this is not so. In particular, it shows that there is no reason not to develop
a predicative theory analogous to topos theory only for Œ†W-pretoposes and not for
general ML-categories, as I am doing in these Chapters.
Secondly, this theorem also shows that Œ†W-pretoposes are closed under exact com-
pletion. But beware, the inclusion y will rarely be a morphism of Œ†W-pretoposes.
In that case y: C
/ Cex would be exact, which can only happen when all objects in
C are projective and C is its own exact completion.
Finally, since the exact completion of a topos (with nno) is seldom again a topos, but
it is a Œ†W-pretopos, there are many examples of Œ†W-pretoposes that are not toposes.
It also shows that there is a closure property of ‚Äúpredicative toposes‚Äù that has no
analogue in the topos-theoretic case. This will be exploited in the next Section.
Realisability toposes 3.4.3
This example is basically a warm-up exercise for the
following one.
I am going to prove that the realisability topos RT(Q) is a Œ†W-
pretopos.
The point is that I try not to rely on the fact that RT(Q) is a topos
with nno, but instead try to give a predicative proof that admits relativisation to a
Œ†W-pretopos. But that is the next example.
So let Q be a pca with underlying set Q. A partitioned assembly (over a Q in Sets)
consists of a set X together with a morphism X
/ Q. A morphism of partitioned
assemblies from [‚àí]X: X
/ Q to [‚àí]Y : Y
/ Q is a function f: X
/ Y for which
there exists an element r ‚ààQ such that:
‚àÄx ‚ààX: r ¬∑ [x]X ‚Üìand r ¬∑ [x]X = [f(x)]Y .
This deÔ¨Ånes a category Pasm(Q), which, I claim, is a weak Œ†W-pretopos.
It is readily seen to be a full subcategory of the category Asm(Q). The Ô¨Ånite limits
and sums are computed as in this category. To be more explicit, assume that the
conventions for pcas as explained in Appendix C are in place. In particular, assume
one has chosen a pairing operator j with projections j0 and j1 and a set C of Church
numerals, which will simple be denoted by the standard natural numbers. A product
(X, [‚àí]X) √ó (Y, [‚àí]Y ) would then be constructed by taking X √ó Y as underlying set,
where a pair (x, y) is realised by ‚ü®[x]X, [y]Y ‚ü©. A sum (X, [‚àí]X) + (Y, [‚àí]Y ) has as
underlying set X + Y , where x is realised by ‚ü®0, x‚ü©and y by ‚ü®1, y‚ü©.

52
CHAPTER 3. EXACT COMPLETION AND GLUEING
If (X, [‚àí]X) and (Y, [‚àí]Y ) are partitioned assemblies, a weak version of XY is the
following: F = {(f, t) ‚ààXY √ó Q | t tracks f}.
So F consists of pairs (f, t) such
that for all x ‚ààX, the expression t ¬∑ [x]X is deÔ¨Åned and its value equals [f(x)]Y .
The map [‚àí]F: F
/ Q is given by the second projection and the evident evaluation
morphism F √óY
/ X is tracked by the element in Q coding application. To see that
this is indeed the weak exponential, let r be the realiser of some H: Z √ó Y
/ X in
Pasm(Q). The transpose of H in Sets, l: Z ‚ÜíXY , extends to a morphism h: Z ‚ÜíF
in Pasm(Q) by sending z to (l(z), Œªn ‚ààQ.r ¬∑ ‚ü®[z], n‚ü©).
(I will refer to the weak
exponentials constructed in this fashion as the ‚Äúcanonical‚Äù weak exponentials.)
More or less the same argument will establish that Pasm(Q) has weak dependent
products.
Let me just give the construction.
To construct the weak dependent
product of c: C
/ J along t: J
/ I one sets Wi, for every i ‚ààI, to be as follows:
{ (f, af, ai) ‚ààCJi √ó Q √ó Q | f is a section of c, af realises f and ai realises i }
The morphism W
/ Q is given by projection onto the last two coordinates (suitably
coded). The morphism Œµ is deÔ¨Åned on a j ‚ààJ by sending (f, af, ai) ‚ààt‚àóWi (where
i = t(j)) to f(j). (I will refer to the weak dependent products constructed in this
fashion as the ‚Äúcanonical‚Äù weak dependent products.)
Finally, the construction of the weak natural number object in Pasm(Q) is easy: it
is simply the set C of all Church numerals together with the inclusion of C in Q.
Weak W-types are constructed as follows. Recall the construction of real W-types in
Asm(Q) via the notion of a decoration. As I pointed out, a morphism f: B
/ A of
partitioned assemblies can also be regarded as a morphism of assemblies, and therefore
one can associate the set of decorations, a particular set of elements in Q, to every
well-founded tree w in the W-type associated to the underlying map of f in set. The
weak W-type associated to f is now the set of decorated trees, pairs (w, a) where a is
a decoration of the tree w, together with the projection on the second coordinate. A
proof of this claim will follow later.
An immediate corollary is that the exact completion of Pasm(Q) is a Œ†W-pretopos.
Assuming the axiom of choice, one can prove this is a topos, in fact it is the realisability
topos on Q (see [77]), so in that case this is something that is well-known. In case
one is unwilling to assume the axiom of choice, that it is a Œ†W-pretopos seems to be
the best one can say.
Intermezzo: W-types in realisability toposes 3.4.4
Since, under the assump-
tion of the axiom of choice, the realisability topos on a pca is the exact completion
of its full subcategory of partitioned assemblies, one can use the theory developed in
this Chapter to give a concrete description of W-types in realisability toposes. This
has been worked out in a small note by Claire Kouwenhoven-Gentil and me.
Since RT(Q) is the exact completion of Pasm(Q), every object in RT(Q) is covered
by a partitioned assembly (in fact, (X, =) is covered by {(x, n) ‚ààX √ó Q | n ‚ààE(x)}
with second projection). The partitioned assemblies are also internally projective and

3.4. MORE EXAMPLES OF Œ†W-PRETOPOSES
53
maps between partitioned assemblies are choice maps in RT(Q). This implies that for
any morphism f: B
/ A, there exists a choice map œÜ: B‚Ä≤
/ A‚Ä≤ between partitioned
assemblies such that
B‚Ä≤
{‚àí} / /
œÜ

B
f

A‚Ä≤
{‚àí}
/ / A
is a quasi-pullback.
By Theorem 3.2.2, given such a square, W: = Wf can be constructed as a subquo-
tient of W ‚Ä≤: = WœÜ. More precisely, consider the following relation on W ‚Ä≤, deÔ¨Åned
inductively in the internal logic by: supŒ±œÑ ‚àºsupŒ±‚Ä≤œÑ ‚Ä≤ iÔ¨Ä
{Œ±} = {Œ±‚Ä≤} ‚àß‚àÄŒ≤ ‚ààœÜ‚àí1(Œ±), ‚àÄŒ≤‚Ä≤ ‚ààœÜ‚àí1(Œ±‚Ä≤): {Œ≤} = {Œ≤‚Ä≤} ‚ÜíœÑŒ≤ ‚àºœÑ ‚Ä≤Œ≤‚Ä≤.
‚àºis symmetric and transitive. One now constructs W by considering the reÔ¨Çexive
elements and dividing out by the equivalence relation ‚àº.
Besides, the structure map s: Pf(W)
/ W is the unique arrow making the following
diagram commute:
Pf(W)
s

R‚àó
q‚àó
oo
/
/
sup

PœÜ(W ‚Ä≤)
sup

W
R
q
oo
/
/ W ‚Ä≤.
Here R is the object of reÔ¨Çexive elements, q the quotient map and q‚àóis deÔ¨Åned on a
pair (Œ±, œÑ: B‚Ä≤
Œ± ‚ÜíW ‚Ä≤) with supŒ±œÑ ‚ààR as the pair (a, t), with a = {Œ±} and t: Ba ‚ÜíW
deÔ¨Åned by t({Œ≤}) = [œÑ(Œ≤)] (which is well-deÔ¨Åned, as supŒ±œÑ ‚ààR).
Consider the following object in that category in RT(Q):
(WSets(œÜ), ‚àº),
where œÜ is as above, and r ‚ä¢w ‚àºw‚Ä≤ for w = supŒ±œÑ and w‚Ä≤ = supŒ±‚Ä≤œÑ ‚Ä≤, if and only if
r = ‚ü®r0, r1, r2‚ü©is such that the following hold:
‚Ä¢ r0 ‚ä¢Ew ‚àßEw‚Ä≤.
‚Ä¢ r1 ‚ä¢a = a‚Ä≤.
‚Ä¢ for all Œ≤, Œ≤‚Ä≤, m such that m ‚ä¢Œ≤ ‚ààœÜ‚àí1(Œ±)‚àßŒ≤‚Ä≤ ‚ààœÜ‚àí1(Œ±‚Ä≤)‚àßb = b‚Ä≤, r2 ¬∑m is deÔ¨Åned
and r2 ¬∑ m ‚ä¢œÑŒ≤ ‚àºœÑ ‚Ä≤Œ≤‚Ä≤.
In these conditions, a = {Œ±}, a‚Ä≤ = {Œ±‚Ä≤}, b = {Œ≤}, b‚Ä≤ = {Œ≤‚Ä≤} and Ew is the set of
decorations of w.
Corollary 3.4.5 The object under consideration is the W-type for f in RT(Q).

54
CHAPTER 3. EXACT COMPLETION AND GLUEING
Proof. From Chapter 2, one knows how to compute W-types for œÜ in the categories
of assemblies or in the realisability topos. Then the proof consists in rewriting in
terms of realisers the description given above in terms of the internal logic of RT(Q).
‚ñ°
Predicative realisability toposes 3.4.6
One can relativise the preceeding exam-
ple to a Ô¨Åxed Œ†W-pretopos E, which will then act as a kind of predicative metatheory.
But Ô¨Årst, one has to agree on a notion of an internal pca in E. The notion will have
to be more stringent than might be expected at Ô¨Årst, in order to circumvent problems
related to choice. What I will need is that the elements of the pca that are required
to exist in the condition of combinatory completeness are given as a function of the
initial data (by a morphism in E). For this it suÔ¨Éces to assume that the combinators
k and s are given as global elements (morphisms 1
/ Q).
Then the deÔ¨Ånition of a partitioned assembly can go through as follows: a partitioned
assembly over an internal pca Q in a Œ†W-pretopos E consists of an object X in
E together with a morphism [‚àí]X: X
/ Q. A morphism of partitioned assemblies
f: (X, [‚àí]X)
/ (Y, [‚àí]Y ) is a morphism f: X
/ Y for which there exists a global
element2 r: 1
/ Q such that:
‚àÄx ‚ààX: r ¬∑ [x]X ‚Üìand r ¬∑ [x]X = [f(x)]Y
holds in the internal logic of E. As usual, r is said to track or realise f.
The construction of the Ô¨Ånite limits, Ô¨Ånite sums and weak dependent products is
the same as in the more speciÔ¨Åc case of the previous example. That it has weak
W-types is far from obvious. One somehow needs to be able to deÔ¨Åne the notion of a
decoration predicatively, which is possible by giving a key rÀÜole to the notion of path.
DeÔ¨Åning decorations will thereby inevitably become a rather technical exercise, but
it can done, as I will now show.
Suppose f is a morphism in Pasm(Q).
Now Ô¨Åx a tree w ‚ààW(f).
A function
Œ∫: Pathsw
/ Q is called a decoration of w, if for any path œÉ ending with the subtree
w‚Ä≤ = supa(t), one has that Œ∫(œÉ) codes a pair ‚ü®n0, n1‚ü©where n0 equals [a] and n1 has
the property that
‚àÄb ‚ààf ‚àí1(a): n1 ¬∑ [b] is deÔ¨Åned and is equal to Œ∫(œÉ ‚àó‚ü®b, tb‚ü©).
Observe that there is a lot of redundancy in this deÔ¨Ånition. In fact, all the information
is already contained in the element Œ∫(‚ü®w‚ü©) ‚ààQ. One might call the element Œ∫ ‚àà
Q a decoration of w if for every path œÉ of length l, say, there exists a function
c: {0, 2, . . . , l ‚àí1}
/ Q such that (1) c(0) = Œ∫; (2) for any even m < l ‚àí1, c(m)
codes a pair ‚ü®n0, n1‚ü©such that (a) n0 = [œÅœÉ(m)] and (b) n1 ¬∑ [œÉ(m + 1)] is deÔ¨Åned and
2It is necessary to require the existence of a global element, rather than the existence of such
an r ‚ààQ in the internal logic of E, for otherwise the resulting category would not have weak
exponentials.

3.4. MORE EXAMPLES OF Œ†W-PRETOPOSES
55
equals c(m+2). Notice that for Ô¨Åxed Œ∫ and œÉ, a function c having these properties, if
it exists, is necessarily unique: Œ∫ determines c(0) by (1) and c(m) determines c(m+2)
by (2b). For this reason, I may write cœÉ, whenever Œ∫ is understood.
So one has a notion of decoration in the ‚Äúfunctional‚Äù and the ‚Äúelementary‚Äù sense.
The numerical deÔ¨Ånition of a decoration may contain less redundancy, but is, I feel,
somewhat opaque. It is convenient to have both perspectives available and I will
make use of both of them. (That they are indeed equivalent, as I am suggesting, is
something one may see as follows: every decoration Œ∫ in the functional sense induces
one in the elementary sense by taking Œ∫(‚ü®w‚ü©). Then the function cœÉ for a path œÉ is
given by cœÉ(m) = Œ∫‚ü®œÉ(0), . . . œÉ(m)‚ü©. Conversely, because c is a function of œÉ, one can
put Œ∫(œÉ) = cœÉ(l ‚àí1).)
A pair v = (w, Œ∫) ‚ààW(f) √ó Q such that Œ∫ is a decoration of w is called a decorated
tree. Furthermore, v‚Ä≤ = (w‚Ä≤, Œ∫‚Ä≤) will be called a decorated subtree of v = (w, Œ∫) if
there is a path œÉ in Pathsw, of length n say, such that œÉ(n ‚àí1) = w‚Ä≤ and Œ∫‚Ä≤ = Œ∫(œÉ).
(In the equation Œ∫‚Ä≤ = Œ∫(œÉ), Œ∫‚Ä≤ is a decoration in the elementary sense and Œ∫ is a
decoration in the functional sense. Here one clearly sees it pays oÔ¨Äto have both
perspectives available.) One might call v‚Ä≤ a proper decorated subtree, if the length n
can be chosen to be bigger than 1. I will denote the collection of decorated subtrees of
v by DSubTrv. One again sees that the notion of a decorated subtree is reÔ¨Çexive and
transitive, and that there are immediate decorated subtrees of (supa(t), Œ∫), namely
the (tb, Œ∫‚ü®supa(t), b, tb‚ü©)‚Äôs (b ‚ààf ‚àí1(a)). These are obviously proper.
After these preliminaries, the weak W-types in Pasm(Q) can quickly be constructed.
Set
V = { v = (w, Œ∫) ‚ààW(f) √ó Q | v is a decorated tree }
This is an object in Pasm(Q) by deÔ¨Åning [‚àí]V : V
/ Q to be the second projection.
Let V ‚àóbe the ‚Äúcanonical‚Äù weak version of V f in the slice over A, so:
V ‚àó
a = { (t, (n0, n1)) ‚ààV f‚àí1(a) √ó P | n1 tracks t and n0 = [a] }.
In more detail: (t, (n, m)) is in V ‚àó
a if m = [a] and n ¬∑ [b] is deÔ¨Åned and equal to the
‚Äúdecoration-component‚Äù of t(b) for every b ‚ààf ‚àí1(a). (Now ŒµW is, of course, the
corresponding weak evaluation.)
The morphism œÉV : Œ£AV ‚àó
/ V is deÔ¨Åned by sending (t, (n, m)) ‚ààV ‚àó
a to the pair
(supa(t), (n, m)), where the pair (n, m) is suitably coded. (The reader should verify
that this pair consists of a tree together with a decoration for this tree, and that œÉV
is tracked by the identity, basically.)
Observe that œÉV is actually an isomorphism. The unique element œÑ such that œÉ(œÑ) =
v = (w = supa(t), Œ∫) is ((a, Œªb ‚ààf ‚àí1(a).(tb, Œ∫(‚ü®w, b, tb‚ü©))), Œ∫).
This completes the construction of the quadruple v = (V, V ‚àó, œÉV , ŒµV ). That it is a
weak Pf-algebra is immediate by the construction. That it is the weak W-type is not
easy to show, but it follows from the following sequence of lemmas.
I have to show that every weak Pf-subalgebra morphism i: x ‚Üív has a section. So
suppose one has a weak Pf-algebra x = (X, X‚àó, œÉX, ŒµX), together with a weak Pf-
subalgebra map i: x
/ v. If L = (V ‚àó√ó f) √óV X and if p0 is the map L
/ V ‚àó√ó f,

56
CHAPTER 3. EXACT COMPLETION AND GLUEING
one may assume that i‚àó: X‚àó
/ V ‚àóis the ‚Äúcanonical‚Äù weak dependent product of p0
along the projection V ‚àó√ó f
/ V ‚àóconstructed above with ŒµX the ‚Äúcanonical‚Äù weak
evaluation map, in view of the following lemma:
Lemma 3.4.7 Let a weak Pf-algebra x = (X, X‚àó, œÉX, ŒµX) together with a weak Pf-
subalgebra morphism i: x
/ v in PASL(P) be given.
Now there exists a weak
Pf-algebra z = (Z, Z‚àó, œÉZ, ŒµZ) with a weak Pf-subalgebra morphism j: z
/ v where
j‚àó: Z‚àó
/ V ‚àóis the canonical weak dependent product of p0 along the projection Z‚àó√ó
f
/ Z‚àóand ŒµZ the canonical weak evaluation map, together with a weak Pf-algebra
morphism k: z
/ x.
Proof. Suppose a weak Pf-algebra x = (X, X‚àó, œÉX, ŒµX) is given together with a weak
Pf-subalgebra morphism i: x
/ v. Now put Z = X and j = i. Now let j‚àó: Z‚àó
/ V ‚àó
be the canonical weak dependent product of p0 along the projection V ‚àó√ó f
/ V ‚àó
and let ŒµZ be the canonical weak evaluation map. Let k: Z
/ X be the identity.
Because X‚àóis a weak dependent product of p0 along the projection V ‚àó√ó f
/ V ‚àó
there exists a morphism k‚àó: Z‚àó
/ X‚àósuch that ŒµX ‚ó¶(k‚àó√ó f) = k ‚ó¶ŒµZ. Now set
œÉZ = œÉX ‚ó¶k‚àó.
Now z = (Z, Z‚àó, œÉZ, ŒµZ) is a canonical weak Pf-subalgebra, with
j = (j, j‚àó) as weak Pf-subalgebra morphism. Furthermore, k = (k, k‚àó) is a weak
Pf-algebra morphism.
‚ñ°
So for a given œÑ in V ‚àó, one may assume that X‚àó
œÑ is deÔ¨Åned as
{(h ‚ààLf, nh ‚ààQ, nœÑ ‚ààQ) | (p0h)(‚àí) = (œÑ, ‚àí), nh realises h and nœÑ realises œÑ}.
Or, equivalently, deÔ¨Åned as
{(h ‚ààXf, nh ‚ààQ, nœÑ ‚ààQ) | ih = ŒµW(œÑ, ‚àí), nh realises h and nœÑ realises œÑ}.
The latter will be my working deÔ¨Ånition.
After making this simplifying assumption, one chooses an s: 1
/ Q such that s tracks
œÉX and constructs a solution r of the recursion equation:3
r ¬∑ j(n0, n1) = s ¬∑ j(n0, H(r, n1))
(here H is the realiser of the function yielding the code of the composition of two
elements).
The idea behind the construction of the Pf-algebra morphism d: v
/ x that is going
to be a section of i is essentially the same as that behind the construction of the
Pf-algebra morphism in Theorem 2.1.5, although technical details will make this
construction more complex. Again, the crux is an appropriate notion of an attempt.
Here I deÔ¨Åne an attempt for some element v of V as a function g: DSubTrv
/ X such
that:
3It is here that one needs the strict requirements on the pca Q.

3.4. MORE EXAMPLES OF Œ†W-PRETOPOSES
57
1. r ¬∑ [v‚Ä≤]V = [g(v‚Ä≤)]X for all decorated subtrees v‚Ä≤ of v.
2. If v‚Ä≤ = œÉX(œÑ) is some decorated subtree of v, then the function h = g ‚ó¶œÑ is
tracked by m = H(r, j1[v‚Ä≤]) and satisÔ¨Åes the equation (œÉX)œÑ(h, (m, [œÑ])) = g(v‚Ä≤).
3. ig(v‚Ä≤) = v‚Ä≤ for all decorated subtrees v‚Ä≤ of v.
One should think of an attempt as a partial approximation of a section d of i. Once
the construction of d is completed, a attempt will turn out to be a restriction of d to
the subtrees of a particular element v of V .
Concerning attempts one proves the following two lemmas.
Lemma 3.4.8 Attempts are unique, so if g and h are two maps DSubTrv
/ X both
satisfying the deÔ¨Åning condition for attempts for an element v, then g = h.
Proof. Let
Q = { w ‚ààW | For all decorations Œ∫ of w, attempts for (w, Œ∫) are unique. }
I use induction to show that Q = W: that will immediately imply the desired result.
Assume that w ‚ààW is such that for all proper subtrees w‚Ä≤ and decorations Œ∫‚Ä≤ of w‚Ä≤
attempts are unique for (w‚Ä≤, Œ∫‚Ä≤). Let Œ∫ be a decoration of w and notice that attempts
are unique for proper decorated subtrees of v = (w, Œ∫), in particular for the immediate
subtrees vb = (tb, Œ∫(‚ü®w, b, tb‚ü©)).
Suppose g is a attempt on v. The values of g on proper decorated subtrees of v are
uniquely determined by the fact that the restriction of a attempt to the decorated
subtrees of a particular decorated subtree is again a attempt for that decorated sub-
tree. In particular, the value of g on the immediate subtrees vb is Ô¨Åxed. Then the
second element in the deÔ¨Ånition of a attempt determines the value of g on v itself.
This completes the induction step and the proof.
‚ñ°
Lemma 3.4.9 Attempts exist for every v.
Proof. Let
Q = { w ‚ààW | For all decorations Œ∫ of w, attempts for (w, Œ∫) exist. }
Again, by induction I show that Q = W, which will prove the lemma. Now, assume
that w ‚ààW is such that for all proper subtrees w‚Ä≤ and decorations Œ∫‚Ä≤ of w‚Ä≤ attempts
exist for (w‚Ä≤, Œ∫‚Ä≤). Let Œ∫ be a decoration of w and observe that (necessarily unique)
attempts gb exist for the immediate subtrees vb = (tb, Œ∫(‚ü®w, b, tb‚ü©)).
If one wants to deÔ¨Åne a attempt g: DSubTrv
/ X on v, one is forced to put g(v‚Ä≤) =
gb(v‚Ä≤) if v‚Ä≤ is some decorated subtree of some vb with b ‚ààf ‚àí1(a) (this is independent
of the particular b involved in view of the previous lemma). It remains to deÔ¨Åne g(v).

58
CHAPTER 3. EXACT COMPLETION AND GLUEING
In the previous lemma, I already observed that I have no choice in how to deÔ¨Åne g(v).
Let me now be more detailed. Let
h = Œªb ‚ààf ‚àí1(a).gb(vb)
and m = H(r, j1Œ∫). Write œÑ = (t, Œ∫) ‚ààV ‚àó
a , so [œÑ] = Œ∫. First I claim that m tracks h.
Let b ‚ààf ‚àí1(a) be arbitrary and calculate:
m ¬∑ [b]
=
H(r, j1Œ∫) ¬∑ [b]
=
r ¬∑ (j1Œ∫ ¬∑ [b])
=
r ¬∑ Œ∫(‚ü®w, b, tb‚ü©)
=
r ¬∑ [vb]
=
[g(vb)].
This means that (h, (m, [œÑ])) is actually a member of X‚àó
œÑ and one puts (is even forced
to put) g(v) = œÉX(h, (m, [œÑ]).
The map g: DSubTrv
/ X satisÔ¨Åes the second condition for being a attempt by
construction. What about the Ô¨Årst?
r ¬∑ [v]
=
r ¬∑ Œ∫
=
s ¬∑ (j0Œ∫, H(r, j1Œ∫))
=
s ¬∑ [(h, ([a], m))]
=
[œÉX(h, ([a], m))]
=
[g(v)]
This being satisÔ¨Åed: what about the third?
ig(v)
=
i(œÉX)œÑ(h, (m, [œÑ]))
=
œÉV i‚àó
œÑ(h, (m, [œÑ]))
=
œÉV (œÑ)
=
v
So this one is also satisÔ¨Åed. This means that g has the required properties and hence
the induction step is completed. This also completes the proof.
‚ñ°
Using these two lemmas, one can deÔ¨Åne the map d: V
/ X by setting d(v) = g(v),
where g is the unique attempt g: SubTrv
/ X. It is immediate from the proof of
the second lemma, where the attempts were actually built, that the natural number
r tracks s and that s extends to a weak Pf-algebra map d that is a section of i. So
v is a weak W-type for f in Pasm(Q).
In this way, within a predicative metatheory, one shows that the exact completion
of Pasm(Q) is a Œ†W-pretopos. I would argue that this deserves to be called ‚Äúthe
predicative realisability topos on Q relative to E‚Äù, as it would yield RT(Q) in case E
= Sets. Then the argument shows that Œ†W-pretoposes are closed under a notion of
realisability, like toposes.

3.4. MORE EXAMPLES OF Œ†W-PRETOPOSES
59
Subcountables in the eÔ¨Äective topos 3.4.10
Again Ô¨Åx a pca Q. A base on Q
is a subobject X ‚äÜQ. A morphism f: X
/ Y of bases is a function f: X
/ Y that
is tracked by an element r ‚ààQ in the sense that
‚àÄx ‚ààX: r ¬∑ x ‚Üìand r ¬∑ x = f(x).
This yields a category, which will be denoted by Base(Q). Bases can be identiÔ¨Åed
by partitioned assemblies (X, [‚àí]X) where [‚àí]X is injective, so where realisers are
unique. It is then rather easy to see that the category of bases inherits the weak
Œ†W-pretopos structure of Pasm(Q).
In case Q = K1, and assuming the axiom of choice, the exact completion of the cate-
gory of bases is a subcategory of the eÔ¨Äective topos. Actually, it is the full subcategory
of subcountables, which is therefore a Œ†W-pretopos (an object is subcountable, when
it is covered by a subobject of the natural number object).
Corollary 3.4.11 The subcountable objects in the eÔ¨Äective topos form a Œ†W-preto-
pos.
Proof. To prove that the category of subcountables is the exact completion of the
category of bases, it suÔ¨Éces to show that both contain the same objects, as the exact
completion of the category of bases is also a full subcategory of the eÔ¨Äective topos,
since Eff = Pasmex and Base is a full subcategory of Pasm.
The natural number object N in Eff is the same as in assemblies: the underlying set
is that of the natural numbers, and n is realised solely by n, so En = {n}. As the
bases are precisely the ¬¨¬¨-closed subobjects of N, and objects in Baseex are covered
by bases, they are certainly subcountable. Conversely, a subobject of N in Eff can
be represented by a predicate P: N
/ PN such that ‚ä¢P(x) ‚ÜíEx. It is in Baseex,
because it can be obtained as the quotient:
{(x, m, m‚Ä≤) | m, m‚Ä≤ ‚ä¢P(x)}
/
/ {(x, m) | m ‚ä¢P(x)}.
A subcountable in Eff is represented by a symmetric, transitive relation on N in Eff,
more precisely, a function R: N √ó N
/ PN such that
‚ä¢R(x, x) ‚ÜíEx,
‚ä¢R(x, y) ‚ÜíR(y, x),
‚ä¢R(x, y) ‚àßR(y, z) ‚ÜíR(x, z).
Therefore it can be obtained as the following quotient of subobjects of N:
{(x, y) | R(x, y) Ã∏= ‚àÖ}
/
/ {x| R(x, x) Ã∏= ‚àÖ},
and hence it is in Baseex.
‚ñ°
The subcountables in the eÔ¨Äective topos will in the next Chapter be exploited to give
a model of constructive-predicative set theory, that validates a principle incompatible
with the existence of the powerset of the natural numbers.

60
CHAPTER 3. EXACT COMPLETION AND GLUEING
It would be interesting to see to what extent the subcountables in the eÔ¨Äective topos
can be regarded as a kind of ‚ÄúmodiÔ¨Åed PERs‚Äù. The point is that they are modiÔ¨Åed so
that the category will be exact, and it may therefore model quotient types in addition
to what is modelled by the category of ordinary PERs.
3.5
Glueing and the free Œ†W-pretopos
This Section discusses another closure property of Œ†W-pretoposes, one that they
share with toposes: closure under glueing. When combined with the theory of exact
completions, it yields a (to me) surprising fact concerning the free Œ†W-pretopos.
Among other things, it shows that the free Œ†W-pretopos cannot be the same as the
category of setoids.
Consider any cartesian functor F: E
/ F between Œ†W-pretoposes. Out of these
data, one builds a new category Gl(F) as follows. Objects are triples (A, X, Œ±), where
A and B are objects of E and F respectively and Œ±: B
/ FA in F. Such triples are
also sometimes denoted by Œ±: B
/ FA. Morphisms (A, X, Œ±)
/ (B, Y, Œ≤) are pairs
(f: A
/ B, g: X
/ Y ) such that
X
Œ± /
g

FA
Ff

Y
Œ≤
/ FB
commutes.
I will prove in an instant that the category Gl(F) so deÔ¨Åned is actually a Œ†W-
pretopos. But more is true. There is an adjoint pair of functors
E
bF
1
‚ä•
Gl(F),
P
s
where P is a forgetful functor, sending a triple (A, X, Œ±) to A, and bF sends an object
A to the triple (A, FA, 1FA). P will be a morphism of Œ†W-pretoposes, while bF will
typically preserve whatever F preserves (so it will be at least cartesian). Clearly,
P bF ‚àº= 1.
Theorem 3.5.1 If F: E
/ F is a cartesian functor between Œ†W-pretoposes, then
Gl(F) is a Œ†W-pretopos. Furthermore, there is a pair of adjoint functors
E
bF
1
‚ä•
Gl(F),
P
s
where P is a morphism of Œ†W-pretoposes, bF is cartesian, and P bF ‚àº= 1. In case F
is a morphism of ML-categories, so is bF.

3.5. GLUEING AND THE FREE Œ†W-PRETOPOS
61
Proof. All the claims will follow from the concrete description of the Œ†W-pretopos
structure of Gl(F).
That Gl(F) is cartesian is obvious, as Ô¨Ånite limits can be computed componentwise
and they are preserved by F.
There is no diÔ¨Éculty in seeing that Gl(F) has Ô¨Å-
nite, disjoint sums, because the sum of X
/ FA and Y
/ FB is X + Y
/ FA +
FB
/ F(A + B). To see that Gl(F) is regular, observe the following facts, where
(f, g) is a morphism in Gl(F).
1. When f and g are both monic, so is (f, g).
2. When f and g are both covers, so is (f, g).
3. When (f, g) is a cover (monic), so are both f and g.
4. Gl(F) is regular.
1 is obvious, while 2 follows from Joyal‚Äôs result that covers in a regular category
are the coequalisers of their kernel pair (see Lemma A.3). Now one can see that
any morphism (f, g) can be factored as a cover followed by a mono, by doing this
componentwise. Since such factorisations are unique up to isomorphism, 3 follows. 4
is then immediate.
That Gl(F) is a pretopos follows from the fact that coequalisers of equivalence re-
lations can be computed componentwise, and that it has a natural number object
is also trivial (it is N
/ FN). To see that Gl(F) is a Œ†-pretopos, it is suÔ¨Écient to
show that is a cartesian closed, because for any (A, X, Œ±) in Gl(F), the slice category
Gl(F)/(A, X, Œ±) is again a glueing category: it is Gl(G), where G is the composite:
E/A
FA / F/FA
Œ±‚àó
/ F/X.
More explicitly, t: B
/ A is sent by G to the upper side of the pullback square:
GB
œÉX

Gt
/ X
Œ±

FB
Ft
/ FA.
(3.7)
As the composite of two cartesian functors, G is cartesian as well.
Gl(F) is cartesian closed, because the exponential (A, X, Œ±)(B,Y,Œ≤) is computed by Ô¨Årst
forming the pullback (Œ∏ is the obvious comparison map):
Z
Œ≥

/ XY
Œ±Y

F(AB)
Œ∏
/ FAFB
FAŒ≤ / FAY ,
when it will be (AB, Z, Œ≥).

62
CHAPTER 3. EXACT COMPLETION AND GLUEING
It is more complicated to see that Gl(F) inherits W-types. First one should describe
polynomial functors for morphisms œÜ = (f, g): (B, Y, Œ≤)
/ (A, X, Œ±) in Gl(F). Let
G: E/A
/ F/X be as above, and observe that there is a natural transformation
œÑC: G(PfC)
/ Pg(FC),
which is the composite of
G(PfC) = GŒ£A(C √ó A
/ A)(B
/ A)
/ Œ£XG((C √ó A
/ A)(B
/ A))
/
Œ£XG(C √ó A
/ A)G(B
/ A) = PGf(FC),
and the natural transformation PGf
/ Pg induced by the commuting triangle:
Y
g
!D
D
D
D
D
D
D
D

GB
Gf
/ X,
obtained from (3.7) (see [60], Section 4.2).
For any triple (C, Z, Œ≥) in Gl(F), let
P C
g (Z, Œ≥) be deÔ¨Åned by taking the pullback:
P C
g (Z)
/
Œ¥

Pg(Z)
Pg(Œ≥)

G(PfC)
/ Pg(FC).
P C
g (Z, Œ≥) can be regarded as an object in F/(FPfC), by composing Œ¥ with œÉPfC. PœÜ
computed on the triple (C, Z, Œ≥) is now (PfC, P C
g Z, œÉPfCŒ¥).
When W is the initial Pf-algebra in E, W ‚àº= PfW, so P W
g
is an endofunctor on
F/FW. In the terminology of Gambino and Hyland [33], P W
g
is a generalised poly-
nomial functor, hence has an initial algebra (V, œà).
I claim that (W, V, œà) is the
W-type for œÜ in Gl(F). It is a Ô¨Åxpoint by construction, and it is not hard to see that
an extension of Theorem 2.1.5 will prove that it is initial.
‚ñ°
The promised application to the free Œ†W-pretopos is the following theorem. In
the remainder of the Section, write D for the free ML-category and E for the free
Œ†W-pretopos.
Theorem 3.5.2 If B: D
/ E is the unique morphism of ML-categories from the free
ML-category to the free Œ†W-pretopos, all the objects in the image of B are projective.
Proof.
The proof relies on the combination of Theorem 3.4.2 with the previous
theorem. Let E be the free Œ†W-pretopos, and take its exact completion Eex. From
Theorem 3.4.2, one knows that y: E
/ Eex is a morphism of ML-categories. If one

3.5. GLUEING AND THE FREE Œ†W-PRETOPOS
63
writes F for the Œ†W-pretopos obtained by glueing along y, one obtains by the pre-
vious result a pair of adjoint functors
E
by
+
‚ä§
F,
P
k
where P is a morphism of Œ†W-pretoposes, by is a morphism of ML-categories, and
P by ‚àº= 1. Since F is a Œ†W-pretopos and E is initial among Œ†W-pretoposes, there is
a morphism S: E
/ F of Œ†W-pretoposes, such that also PS ‚àº= 1. If B: D
/ E is
the unique morphism of ML-categories from the free ML-category to the free Œ†W-
pretopos, one also has byB ‚àº= SB.
It is easy to see that objects of the form byX are projective in F, because objects of
the form yX are, and y is full and faithful (also use the characterisation of covers
in Gl(F) given in the proof of the previous theorem). It is also not hard to that in
case SX is projective for an object X in E, X is itself projective, because S, as a
morphism of Œ†W-pretoposes, preserves covers. Since objects in the image of B are
such objects, the statement of the theorem is proved.
‚ñ°
What is most surprising (to me, at least) about this result is that it shows that
all higher types, like NN, are projective in the free Œ†W-pretopos. What is not true,
however, is that NN is internally projective in the free Œ†W-pretopos, as the following
result shows.
Proposition 3.5.3
1. If F is a Œ†-pretopos in which NN is internally projective,
then Church‚Äôs Thesis is false in the internal logic of F.
2. NN is not internally projective in the free Œ†W-pretopos.
Proof. If NN is internally projective in a Œ†W-pretopos F, its internal logic will model
HAœâ + AC1,0 + EXT. It is a well-known result by Troelstra [82] (see also [81]) that
this theory refutes Church‚Äôs Thesis.
Because the validity of statements in the internal logic is preserved by morphisms of
Œ†W-pretoposes, validity of the negation of Church‚Äôs Thesis in the free Œ†W-pretopos
would imply validity of the negation of Church‚Äôs Thesis in all Œ†W-pretoposes. But
since Church‚Äôs Thesis is valid in the eÔ¨Äective topos, for instance, this is impossible.
Therefore NN is not internally projective in the free Œ†W-pretopos.
‚ñ°
Corollary 3.5.4 The following three Œ†W-pretoposes are all diÔ¨Äerent:
‚Ä¢ The free Œ†W-pretopos E.
‚Ä¢ The exact completion Dex of the free ML-category D.

64
CHAPTER 3. EXACT COMPLETION AND GLUEING
‚Ä¢ The category Setoids.
Proof. This corollary is an immediate consequence of the following table:
Category
NN externally projective
NN internally projective
Setoids
No
No
E
Yes
No
Dex
Yes
Yes
The two bottom rows are consequences of the results obtained in this Chapter. The
entries for Dex follow immediately from Theorem 3.4.2 and Lemma 3.1.6, while the
previous two results give the entries for E.
The entries for the category of setoids are consequences of the following sequence of
facts. Among the setoids, there are the ‚Äúpure types‚Äù, consisting of a type with its
intensional equality as equivalence relation. These pure types are projective. This
includes the pure type 1 = N1, which is the terminal object in the category of setoids.
So the terminal object in Setoids is projective, and hence the internal projectives are
also externally projective.
The object NN in Setoids is the type N ‚ÜíN together with the ‚Äúextensional‚Äù equality
relation
Œ†n ‚ààN. Id(N, fn, gn).
This object is covered by the pure type N ‚ÜíN, so if it were projective, this cover
would have a section. This would imply that there is a deÔ¨Ånable operation s ‚àà(N ‚Üí
N) ‚Üí(N ‚ÜíN) such that the following types are provably inhabited:
Œ†f ‚ààN ‚ÜíN. EXTEQ(f, sf)
Œ†f, g ‚ààN ‚ÜíN. EXTEQ(f, g) ‚ÜíINTEQ(sf, sg),
where
INTEQ(f, g)
: =
Id(N ‚ÜíN, f, g)
EXTEQ(f, g)
: =
Œ†n ‚ààN. Id(N, fn, gn).
Such an s cannot exist, because if it would, one could decide extensional equality of
terms of type N ‚ÜíN, which is known to be impossible: for any two closed terms p, r
of type N ‚ÜíN, the type EXTEQ(p, r) is inhabited, iÔ¨ÄINTEQ(sp, sr) is inhabited,
iÔ¨Äsp and sr are convertible, which is decidable (many thanks to Thomas Streicher
for helping me out on this). Therefore NN is not projective in Setoids, and, a fortiori,
not internally projective either.
‚ñ°

Chapter 4
Algebraic set theory and CZF
This Chapter is meant to make good on the claim that Œ†W-pretoposes form a natural
context for models of constructive-predicative set theories, like CZF.
Aczel‚Äôs set theory CZF is introduced in the Ô¨Årst Section.
CZF provides not
only a setting in which one can practice Bishop-style constructive mathematics in
manner very similar to ordinary mathematics, but it also has a precise justiÔ¨Åcation
as a constructive theory. In [2] (see also [3] and [4]), Aczel interpreted his theory in
Martin-L¬®of type theory with W-types and one universe, a theory which is indisputably
constructive, and, in this sense, CZF has the best possible credentials for deserving
the epithet ‚Äúconstructive‚Äù.1
The connection with Œ†W-pretoposes goes via algebraic set theory. Algebraic set
theory is a Ô¨Çexible categorical framework for studying set theories of very diÔ¨Äerent
stripes. How this theory can be used to model CZF in Œ†W-pretoposes is the subject
of Moerdijk and Palmgren‚Äôs article [61]. This will be recapitulated in Section 2.
In Section 3, I explain how a recent model of CZF discovered independently by
Streicher and Lubarsky falls within this framework. The model is then further in-
vestigated and shown to validate some interesting principles incompatible with either
classical logic or the powerset axiom.
4.1
Introduction to CZF
This Section provides an introduction to Aczel‚Äôs set theory CZF. A good reference
for CZF is [7].
Like ordinary formal set theory, CZF is a Ô¨Årst-order theory with one non-logical
symbol œµ. But unlike ordinary set theory, its underlying logic is intuitionistic. To
1For the interpretation to work, the universe need not be closed under W-types. And one needs
only one W-type, which is then used to build a universe of well-founded sets.
65

66
CHAPTER 4. ALGEBRAIC SET THEORY AND CZF
formulate its axioms, I will use the following abbreviations:
‚àÉxœµa (. . .)
: =
‚àÉx (xœµa ‚àß. . .),
‚àÄxœµa (. . .)
: =
‚àÄx (xœµa ‚Üí. . .).
Recall that a formula is called bounded when all the quantiÔ¨Åers it contains are of one
of these two forms. Finally, I write B(xœµa, yœµb) œÜ to mean:
‚àÄxœµa ‚àÉyœµb œÜ ‚àß‚àÄyœµb ‚àÉxœµa œÜ.
Its axioms are the (universal closures of) the following formulas, in which œÜ is
arbitrary, unless otherwise stated.
(Extensionality) ‚àÄx (xœµa ‚Üîxœµb) ‚Üía = b
(Pairing) ‚àÉy ‚àÄx (xœµy ‚Üî(x = a ‚à®x = b))
(Union) ‚àÉy ‚àÄx (xœµy ‚Üî‚àÉz (xœµz ‚àßzœµa))
(Set Induction) ‚àÄx (‚àÄyœµx œÜ(y) ‚ÜíœÜ(x)) ‚Üí‚àÄx œÜ(x)
(InÔ¨Ånity) ‚àÉa (‚àÉx xœµa ‚àß‚àÄxœµa ‚àÉyœµa xœµy)
(‚àÜ0-Separation) ‚àÉy ‚àÄx (xœµy ‚Üî(œÜ(x) ‚àßxœµa)) for all bounded formulas œÜ not con-
taining v as a free variable
(Strong Collection) ‚àÄxœµa ‚àÉy œÜ(x, y) ‚Üí‚àÉb B(xœµa, yœµb) œÜ(x, y)
(Subset Collection) ‚àÉc ‚àÄz (‚àÄxœµa ‚àÉyœµb œÜ(x, y, z) ‚Üí‚àÉdœµc B(xœµa, yœµd) œÜ(x, y, z))
Set Induction is constructive version of the Axiom of Foundation (or Regularity
Axiom). Such a reformulation is in order, because the axiom as usually stated implies
the Law of Excluded Middle. Strong Collection can be considered as a strengthening
of the Replacement Axiom.
The Subset Collection Axiom has a more palatable
formulation (equivalent to it over the other axioms), called Fullness. Write mv(a, b)
for the class of all multi-valued functions from a set a to a set b, i.e. relations R such
that ‚àÄxœµa ‚àÉyœµb (a, b)œµR (pairs of sets can be coded by the standard trick).
(Fullness) ‚àÉz (z ‚äÜmv(a, b) ‚àß‚àÄxœµmv(a, b) ‚àÉcœµz (c ‚äÜx))
Using this formulation, it is also easier to see that Subset Collection implies Expo-
nentiation, the statement that the functions from a set a to a set b form a set.
In order to have a fully satisfactory theory of inductively deÔ¨Åned sets in CZF,
Aczel proposed to extend CZF with the Regular Extension Axiom.2
A set A is
2The extension is a good one in that the Regular Extension Axiom is validated by the interpreta-
tion of CZF in Martin-L¬®of type theory with W-types and one universe closed under W-types. This
is a stronger type theory than the one needed for CZF proper, but still indisputably constructive.

4.2. INTRODUCTION TO ALGEBRAIC SET THEORY
67
called regular, when it is transitive, and for every Rœµmv(a, A), where aœµA, there is
a bounding set bœµA such that B(xœµa, yœµb) (x, y)œµR. The Regular Extension Axiom
(REA for short) says:
(REA) ‚àÄx ‚àÉr (xœµr ‚àßr is regular)
For instance, this allows one to prove that, working inside CZF, the category of sets
has W-types (see [7]). In fact:
Theorem 4.1.1 The category of sets and functions of CZF + REA is a Œ†W-
pretopos.
4.2
Introduction to algebraic set theory
Algebraic set theory, as introduced by Joyal and Moerdijk in their book [47], is a
Ô¨Çexible categorical framework for studying formal set theories. The idea is that a
uniform categorical approach should be applicable to set theories with very diÔ¨Äerent
Ô¨Çavours: classical or constructive, predicative or impredicative, well-founded or non-
well-founded, etcetera.
The approach relies on the notion of a small map. In a category, whose objects and
morphisms are thought of as general classes and functional relations (possibly of the
size of a class) or general sets and functions, certain morphisms are singled out because
their Ô¨Åbres possess a special set-theoretic property, typically that of being relatively
small in some precise sense. One could think of being a set as opposed to being a
proper class, Ô¨Ånite as opposed to inÔ¨Ånite, countable as opposed to uncountable, but
also of being a small type as opposed to a type outside a particular type-theoretic
universe.
The Ô¨Çexibility of the approach resides in the fact that the axioms for the class of
small maps are not Ô¨Åxed once and for all: these are determined by the particular set
theory or set-theoretic notion one is interested in. This is something we will actually
see, because in this thesis, two diÔ¨Äerent sets of axioms will be introduced. But in this
Chapter the axioms for the class of small maps I will work with are those of Moerdijk
and Palmgren in [61]. This choice is determined by two things: my interest in the
predicative-constructive set theory CZF and my wish to see the category of setoids
as a natural example.3
This Section recaps deÔ¨Ånitions and results from [61].
Let S be a class of maps in an ambient category E, which I assume to be a
Œ†W-pretopos.
3For diÔ¨Äerent axiom systems, see [47], [9] and other references at the ‚ÄúAlgebraic Set Theory‚Äù
website: http://www.phil.cmu.edu/projects/ast/. And also Chapter 6.

68
CHAPTER 4. ALGEBRAIC SET THEORY AND CZF
DeÔ¨Ånition 4.2.1 S is called stable if it satisÔ¨Åes the following axioms:
(S1) (Pullback stability) In a pullback square
D
/
g

C
f

B
p
/ A
(4.1)
g belongs to S, whenever f does.
(S2) (Descent) If in a pullback diagram as in (4.1), p is epi, then f belongs to S,
whenever g does.
(S3) (Sum) If two maps f: B
/ A and f ‚Ä≤: B‚Ä≤
/ A‚Ä≤ belong to S, then so does f +
f ‚Ä≤: A + A‚Ä≤
/ B + B‚Ä≤.
These axioms express that maps belong to S by virtue of the properties of their Ô¨Åbres.
DeÔ¨Ånition 4.2.2 A class S is called a locally full subcategory, if it is stable and also
satisÔ¨Åes the following axiom:
(S4) In a commuting triangle
C
g
/
h
@
@
@
@
@
@
@
B
f
~~~~~~~
A
where f belongs to S, g belongs to S if and only if h does.
Remark 4.2.3 If (S1) holds and all identities belong to S, (S4) is equivalent to the
conjunction of the following two statements:
(S4a) Maps in S are closed under composition.
(S4b) If f: X
/ Y belongs to S, the diagonal X
/ X √óY X in E/Y also belongs
to S.
When thinking in terms of type constructors, this means that (S4) expresses that
smallness is closed under dependent sums and (extensional) equality types. I will
actually require the class of small maps to be closed under all type constructors,
hence the next deÔ¨Ånition.
For any object X in E, I write SX for the full subcategory of E/X whose objects
belong to S. An object X is called small, when the unique map X
/ 1 is small.

4.2. INTRODUCTION TO ALGEBRAIC SET THEORY
69
DeÔ¨Ånition 4.2.4 A locally full subcategory S in a Œ†W-pretopos E is called a class
of small maps, if for any object X of E, SX is a Œ†W-pretopos, and the inclusion
functor
SX /
/ E/X
preserves the structure of a Œ†W-pretopos.
Lemma 4.2.5 (See [61], Lemma 3.4.) A locally full subcategory S in a Œ†W-pretopos
E is class of small maps iÔ¨Äit has the following Ô¨Åve properties:
(F1) 1X ‚ààS for every object X in E.
(F2) 0
/ X is in S, and if Y
/ X and Z
/ X are in S then so is Y + Z
/ X.
(F3) For an exact diagram in E/X,
R
/
/
?
?
?
?
?
?
?
?
Y
/ /

Y/R
}zzzzzzzz
X
if R
/ X and Y
/ X belong to S then so does Y/R
/ X.
(F4) For any Y
/ X and Z
/ X in S, their exponent (Z
/ X)(Y
/ X) in E/X
belongs to S.
(F5) For a commutative diagram
B
f
/
 A
A
A
A
A
A
A
A
~~~~~~~~
X
with all maps in S, the W-type WX(f) taken in E/X (which is a map in E with
codomain X) belongs to S.
DeÔ¨Ånition 4.2.6 A stable class (locally full subcategory, class of small maps) S is
called representable, if there is a map œÄ: E
/ U in S such that any map f: B
/ A
in S Ô¨Åts into a double pullback diagram of the form
B
f

B‚Ä≤
/

o
E
œÄ

A
A‚Ä≤
p
oo
/ U
where p is epi, as indicated.

70
CHAPTER 4. ALGEBRAIC SET THEORY AND CZF
Representability formulates the existence of a weak version of a universe. The
map œÄ in the deÔ¨Ånition of representability is often called the universal small map,
even though it is not unique (not even up to isomorphism). In the internal logic of
E, representability means that a map f: B
/ A belongs to S iÔ¨Äit holds that
‚àÄa ‚ààA‚àÉu ‚ààU: Ba ‚àº= Eu.
In particular, it means that one can talk about ‚Äúbeing small‚Äù in the internal logic of
E.
The axioms for a class of small maps that I have given so far form the basic
deÔ¨Ånition.
The deÔ¨Ånition can be extended by adding various choice or collection
principles. There is the collection axiom (CA) in the sense of Joyal and Moerdijk in
[47]:
(CA) For any small map f: A
/ X and epi C
/ A, there exists a quasi-pullback
of the form
B
/
g

C
/ / A
f

Y
/ / X
where Y
/ X is epi and g: B
/ Y is small.
As discussed in [61], the collection axiom can be reformulated using the notion of
a collection map. Informally, a map g: D
/ C in E is a collection map, whenever it is
true (in the internal logic of E), that for any map f: F
/ Dc covering some Ô¨Åbre of g,
there is another Ô¨Åbre Dc‚Ä≤ covering Dc via a map p: Dc‚Ä≤
/ Dc which factors through
f.
DeÔ¨Ånition 4.2.7 A morphism g: D
/ C in E is a collection map, when for any map
T
/ C and any epi E
/ T √óC D there is a diagram of the form
D

D √óC T ‚Ä≤

o
/ E
/ / T √óC D

/ D

C
T ‚Ä≤
o
/ / T
/ C
where the middle square is a quasi-pullback with an epi on the bottom, while the two
outer squares are pullbacks. A map g: D
/ C over A is a collection map over A, if
it is a collection map in E/A.
Observe that a collection map is a categorical notion, and does not refer to or depend
on a class of small maps.
Proposition 4.2.8 (See [61], Proposition 4.5.) A map D
/ C is a collection map
over C if, and only if, it is a choice map.

4.3. A REALISABILITY MODEL OF CZF
71
In case the class of small maps is representable, the collection axiom is equivalent
to stating that the universal small map œÄ: E
/ U is a collection map.
(This is
imprecise, but in a harmless way: if one universal small map is a collection map, they
all are.)
In [61], Moerdijk and Palmgren work with a much stronger axiom: what they call
the axiom of multiple choice (AMC). Internally it says that for any small set B there
is a collection map D
/ C where D and C are small, and C is inhabited, together
with a map D
/ B making D
/ B √ó C into a surjection.
DeÔ¨Ånition 4.2.9 A class of small maps S satisÔ¨Åes the axiom of multiple choice
(AMC), iÔ¨Äfor any map B
/ A in S, there exists an epi A‚Ä≤
/ A and a quasi-
pullback of the form
D

/ B

C
/ / A‚Ä≤
/ / A
where D
/ C is a small collection map over A‚Ä≤ and C
/ A‚Ä≤ is a small epi.
Proposition 4.2.10 (See [61], Proposition 4.3.) The axiom of multiple choice im-
plies the collection axiom.
The idea of Moerdijk and Palmgren in [61] is to generalise Aczel‚Äôs interpretation of
CZF into Martin-L¬®of type theory with W-types and one universe, to an interpretation
of CZF into any Œ†W-pretopos E with a representable class of small maps, where one
expects to recover Aczel‚Äôs syntactic construction in case E is Setoids. In that light
one should see the following two results:
Theorem 4.2.11 (See [61], Section 12.) When intensional Martin-L¬®of type theory
is equipped with W-types and one universe, the category of setoids is equipped with a
representable class of small maps satisfying (AMC).
Theorem 4.2.12 (See [61], Theorem 7.1.) Let E be a Œ†W-pretopos equipped with a
representable class of small maps S satisfying (AMC). Then E contains a model of
the set theory CZF + REA.
4.3
A realisability model of CZF
To illustrate the framework of algebraic set theory, I will show here how the models
of CZF obtained by Streicher in [80] and by Lubarsky in [53] Ô¨Åt into it. Actually, I
will show that the models are the same.

72
CHAPTER 4. ALGEBRAIC SET THEORY AND CZF
Using category theory and some known results on the eÔ¨Äective topos, it will be
an easy exercise to establish the validity of a lot of constructivist principles in the
model. Their collective consistency is new. Finally, I show that CZF is consistent
with a general uniformity principle:
‚àÄx ‚àÉyœµa œÜ(x, y) ‚Üí‚àÉyœµa ‚àÄx œÜ(x, y),
which appears to be new.4
Our ambient category E is the eÔ¨Äective topos RT = Eff. Recall that a set is
called subcountable, when it is covered by a subset of the natural numbers. Since the
eÔ¨Äective topos is a topos with nno N, the notion also makes sense in the internal logic
of the eÔ¨Äective topos: Y is subcountable, when
‚àÉX ‚ààPN ‚àÉg: X
/ Y : g is a surjection.
Also recall that the eÔ¨Äective topos is the exact completion of its subcategory of
projectives, the partitioned assemblies, as discussed in the previous Chapter.
Lemma 4.3.1 The following are equivalent for a morphism f: A
/ B in Eff.
1. In the internal logic of Eff it is true that all Ô¨Åbres of f are subcountable.
2. The morphism f Ô¨Åts into a diagram of the following shape
Y √ó N
#G
G
G
G
G
G
G
G
G
X
o
o
/ /
g

A
f

Y
/ / B,
where the square is a quasi-pullback.
3. The morphism f Ô¨Åts into a diagram of the following shape
Q √ó N
#F
F
F
F
F
F
F
F
F
P
o
o
/ /
g

A
f

Q
/ / B,
where the square is a quasi-pullback, P is a ¬¨¬¨-closed subobject of Q √ó N and
g is a choice map between partitioned assemblies.
4The model, and my results, are obviously related to earlier work by Friedman in [29], but
especially his unpublished work as reported in Myhill‚Äôs paper [62]. I must confess I Ô¨Ånd it hard
to get a clear picture of Friedman‚Äôs work and therefore I am having diÔ¨Éculties in establishing its
precise relation to mine. Still, I think I can safely say that the set theories studied there are weaker
that CZF in not containing Subset Collection, there is no result on the regular extension axiom or
the presentation axiom, and the relationship to subcountable morphisms in the eÔ¨Äective topos.

4.3. A REALISABILITY MODEL OF CZF
73
Proof. The equivalence of 1 and 2 is a standard exercise in translating internal logic
into diagrammatic language, and vice versa. That 3 implies 2 is trivial.
2 ‚áí3: Because every object is covered by a partitioned assembly, X can be covered
by a partitioned assembly Q. Now Q √ó N is also a partitioned assembly, since N
is a partitioned assembly and partioned assemblies are closed under products. Now
the subobject Z = Q √óY X of Q √ó N can be covered by a ¬¨¬¨-closed subobject P of
Q √ó N. The idea is easy: the subobject Z ‚äÜQ √ó N can be identiÔ¨Åed with a function
Z: Q √ó N
/ PN such that there is a realiser for
‚ä¢Z(q, n) ‚Üí[q] ‚àß[n].
Then form P = { (q, n) | n1 ‚ààZ(q, n0) }, which is a partitioned assembly with
[(q, n)] = n, and actually a ¬¨¬¨-closed subobject of Q √ó N.
P covers Z, clearly.
The diagram
Z /
/ Q √ó N
P
OO
;
;w
w
w
w
w
w
w
w
does not commute, but composing with the projection Q √ó N
/ Q it does. (What I
am basically using here is Shanin‚Äôs Principle, a principle valid in the internal logic of
Eff, see [65], Proposition 1.7.) Finally, g: P ‚äÜQ √ó N
/ Q, as a morphism between
partitioned assemblies, is a choice map.
‚ñ°
Let S be the class of maps having any of the equivalent properties in this lemma.
This class of maps was already identiÔ¨Åed by Joyal and Moerdijk in [47] and baptised
‚Äúquasi-modest‚Äù, but I prefer simply ‚Äúsubcountable‚Äù. Joyal and Moerdijk prove many
useful properties of these subcountable morphisms, but they are not put to any use
in [47]. Here I will show that it leads to a model of CZF, actually the same one as
contained in both [80] and [53].
First I want to prove that S is a class of small maps. To do so, it will be useful
to introduce the the category of bases over a partitioned assembly X. When X is a
partitioned assembly, consider the full subcategory BaseX of Eff/X consisting of the
¬¨¬¨-closed subobjects of X √óN
/ X. The point is that BaseX has the structure of a
weak Œ†W-pretopos, and the inclusion of BaseX in Pasm/X preserves this structure.
(These are not exactly trivial, but entirely innocent generalisations of things we have
seen before.)
Lemma 4.3.2 The inclusion (BaseX)ex ‚äÜ(Pasm/X)ex = Eff/X is an inclusion of
Œ†W-pretoposes.
Proof. I will skip numbers of uninteresting details: the inclusion is exact, by con-
struction. That it preserves sums is easy to see. The inclusion of BaseX in Pasm/X
preserves weak Œ†, so the inclusion (BaseX)ex ‚äÜ(Pasm/X)ex, preserves Œ† by con-
struction (of genuine Œ† in the exact completion out of weak Œ† in the original category).

74
CHAPTER 4. ALGEBRAIC SET THEORY AND CZF
Then it also preserves polynomial functors Pf and hence also W-types by yet another
application of Theorem 2.1.5, because subcountables are closed under subobjects. ‚ñ°
Proposition 4.3.3 The class S of subcountable maps is a class of small maps in
Eff.
Proof. That S is a locally full subcategory can be found in [47]. Now I use Lemma
4.2.5 to see that is a class of small maps.
That it satisÔ¨Åes (F1) and (F2) is trivial (and can also be found in [47]). It also
satisÔ¨Åes (F3); actually, it is easy to see that in any triangle where the top is epi
B
/ /
g
@
@
@
@
@
@
@
C
f
~~~~~~~
A
and g is in S, f is also in S.
To check (F4), assume Y
/ X and Z
/ X are in S. Both Ô¨Åt into quasi-pullback
squares
P
/ /

Y

Q
/ / X
R
/ /

Z

S
/ / X,
where P
/ Q and R
/ S are morphisms in BaseR and BaseS, respectively, hence
choice maps.
Actually, one may assume Q = S and Q
/ X = S
/ X.
Then
(P
/ Q)(R
/ Q) is in (BaseQ)ex, hence in SQ. But (Y
/ X)(Z
/ X) is a subquo-
tient of this, hence in SX.
To check (F5), suppose f Ô¨Åts into a commutative diagram
B
f
/
 A
A
A
A
A
A
A
A
~~~~~~~~
X
where all arrows are in S. Now X can be covered by a partitioned assembly Y via a
map
Y
p / / X,
in such a way that in Eff/Y, we have a quasi-pullback diagram
B‚Ä≤
g

/ / p‚àóB
p‚àóf

A‚Ä≤
/ / p‚àóA,

4.3. A REALISABILITY MODEL OF CZF
75
where B‚Ä≤
/ Y and A‚Ä≤
/ Y are in BaseX‚Ä≤.
By the previous lemma, Wg is in
(BaseX‚Ä≤)ex, hence in SX‚Ä≤. By (the proof of) Theorem 3.2.2, Wp‚àóf ‚àº= p‚àóWf is a sub-
quotient of Wg, hence also subcountable. Then by stability of W-types and axiom
(S2), Wf is also subcountable.
‚ñ°
But the class S has more properties:
Lemma 4.3.4 The class S also has the following properties:
(R) The class S is representable.
(F) All the monos belong to S.
(Q) In any triangle where the top is epi
B
/ /
g
@
@
@
@
@
@
@
C
f
~~~~~~~
A
and g is in S, f is also in S.
(AMC) The class S satisÔ¨Åes AMC.
Proof. Properties (R), (F), (Q) are all proved in [47]. That it satisÔ¨Åes (AMC) is
trivial: every f ‚ààS Ô¨Åts into a quasi-pullback diagram
X
/ /
g

A
f

Y
/ / B,
where g: X
/ Y is a small choice map, hence a small collection map over Y (see
Proposition 4.2.8).
‚ñ°
Since S is representable and also satisÔ¨Åes (AMC), we know by Theorem 4.2.12
that the eÔ¨Äective topos contains a model V of CZF + REA based on the class of
subcountable maps. In the remainder of this Chapter, I will study this model V . In
eÔ¨Äect, I will show that it validates the following list of principles. Since the set of
natural numbers œâ is deÔ¨Ånable in CZF, I will freely use this symbol when formulating
these principles. I will also use 0 and the successor operation s.
Theorem 4.3.5 The following principles are valid in the model V :
(Full Separation) ‚àÉy ‚àÄx (xœµy ‚Üî(œÜ(x) ‚àßxœµa)) for all formulas œÜ not containing v
as a free variable.

76
CHAPTER 4. ALGEBRAIC SET THEORY AND CZF
(All sets subcountable) All sets are subcountable.
(Non-existence of Pœâ) The powerset of the set of natural numbers does not exist.
(Axiom of Countable Choice) ‚àÄiœµœâ ‚àÉx œà(i, x) ‚Üí‚àÉa, f: œâ
/ a ‚àÄiœµœâ œà(i, f(i)).
(Axiom of Relativised Dependent Choice) œÜ(x0) ‚àß‚àÄx (œÜ(x) ‚Üí‚àÉy (œà(x, y) ‚àß
œÜ(y))) ‚Üí‚àÉa ‚àÉf: œâ
/ a (f(0) = x0 ‚àß‚àÄi ‚ààœâ œÜ(f(i), f(si))).
(Presentation Axiom) Every set is the surjective image of a base (see below).
(Markov‚Äôs Principle) ‚àÄnœµœâ [œÜ(n) ‚à®¬¨œÜ(n)] ‚Üí[¬¨¬¨‚àÉn ‚ààœâ œÜ(n) ‚Üí‚àÉnœµœâ œÜ(n)].
(Independence of Premisses) (¬¨Œ∏ ‚Üí‚àÉx œà) ‚Üí‚àÉx (¬¨Œ∏ ‚Üíœà).
(Church‚Äôs Thesis) ‚àÄnœµœâ ‚àÉmœµœâ œÜ(n, m) ‚Üí‚àÉeœµœâ ‚àÄnœµœâ ‚àÉm, pœµœâ [T(e, n, p)‚àßU(p, m)‚àß
œÜ(n, m)] for every formula œÜ(u, v), where T and U are the set-theoretic predi-
cates which numeralwise represent, respectively, Kleene‚Äôs T and result-extraction
predicate U.
(Uniformity Principle) ‚àÄx ‚àÉyœµa œÜ(x, y) ‚Üí‚àÉyœµa ‚àÄx œÜ(x, y).
(Unzerlegbarkeit) ‚àÄx (œÜ(x) ‚à®¬¨œÜ(x)) ‚Üí‚àÄx œÜ ‚à®‚àÄx ¬¨œÜ.
Most of these principles also hold in the realisability models of Rathjen [70], except
for the subcountability of all sets, and the general Uniformity Principle. In order to
show all of this, I need to give a concrete description. In our case that is somewhat
easier than in [61], since the axiom (Q) is valid here.
On Eff, one can deÔ¨Åne the powerclass functor Ps. The idea is that Ps(X) is the
set of all subcountable subsets of X. This one can easily construct in terms of the
universal small map œÄ: E
/ U:
Ps(X) = { R ‚ààPX | ‚àÉu ‚ààU: R ‚àº= Eu }.
Ps is obviously a subfunctor of the powerobject functor P (which exists in any topos),
and inherits an elementhood relation ‚ààX‚äÜPs(X) √ó X from P.
The model for CZF is the initial algebra for the functor Ps, which happens to
exist. This means that it is a Ô¨Åxpoint V and there are mutually inverse mappings
I: Ps(V )
/ V and E: V
/ Ps(V ).
The internal elementhood relation œµ on V is
deÔ¨Åned in terms of ‚ààas follows:
xœµy ‚áîx ‚ààE(y).
One can see that the model V exists by slightly modifying the work of Moerdijk
and Palmgren in [61]. Call a map œÄ: E
/ U a weak representation for a class of

4.3. A REALISABILITY MODEL OF CZF
77
small maps S, when a morphism belongs to S, if and only if, there is a diagram of
the following form:
B
f

B‚Ä≤
/

o
E
œÄ

A
A‚Ä≤
p
oo
/ U
where the left square is a quasi-pullback, and the right square is a genuine pullback.
This expresses that every small map is locally a quotient of œÄ. Moerdijk and Palmgren
show how the initial Ps-algebra can be constructed from œÄ.
Our class of small maps has a weak representation of a relatively easy form:
‚ààN /
/
œÄ

‚ààN

P¬¨¬¨(N) /
/ P(N).
Therefore œÄ is a morphism between assemblies, where P¬¨¬¨(N) = ‚àáPN, i.e. the set
of all subsets A of the natural numbers, where A is realised by any natural number,
and ‚ààN= {(n, A) | n ‚ààA}, where (n, A) is realised simply by n.
According to Moerdijk and Palmgren, the initial Ps-algebra can be constructed
by Ô¨Årst taking the W-type associated to œÄ and then dividing out, internally, by
bisimulation:
supA(t) ‚àºsupA‚Ä≤(t‚Ä≤)
‚áî
‚àÄa ‚ààA ‚àÉa‚Ä≤ ‚ààA‚Ä≤: ta ‚àºt‚Ä≤a‚Ä≤ and ‚àÄa‚Ä≤ ‚ààA‚Ä≤ ‚àÉa ‚ààA: ta ‚àºt‚Ä≤a‚Ä≤.
The W-type associated to œÄ can be calculated in the category of assemblies, and
is the following. The underlying set consists of well-founded trees where the edges
are labelled by natural numbers, in such a way that the edges into a Ô¨Åxed node are
labelled by distinct natural numbers. The decorations (realisers) of such trees supA(t)
are those n ‚ààN such that n ¬∑ a ‚Üìfor all a ‚ààA and n ¬∑ a is a decoration of t(a).
Now I have to translate the bisimulation relation in terms of realisers. When using
the abbreviation:
m ‚ä¢x œµ supA(t)
‚áî
j0m ‚ààA and j1m ‚ä¢x ‚àºt(j0m),
it becomes:
n ‚ä¢supA(t) ‚àºsupA‚Ä≤(t‚Ä≤)
‚áî
‚àÄa ‚ààA: j0n ¬∑ a ‚Üìand j0n ¬∑ a ‚ä¢ta œµ supA‚Ä≤(t‚Ä≤) and
‚àÄa‚Ä≤ ‚ààA‚Ä≤: j1n ¬∑ a‚Ä≤ ‚Üìand j1n ¬∑ a‚Ä≤ ‚ä¢t‚Ä≤a‚Ä≤ œµ supA(t).
Using the Recursion Theorem, it is not hard to see that this deÔ¨Ånes a subobject ‚àºof
WœÄ √ó WœÄ, in fact, an equivalence relation on WœÄ. The quotient in Eff is V , which is
therefore WœÄ, with ‚àºas equality.
Using the description of Ps as a quotient of PœÄ in [47], one can see that:
Ps(X, =) = {(A ‚äÜN, t: A
/ X)},

78
CHAPTER 4. ALGEBRAIC SET THEORY AND CZF
where n ‚ä¢(A, t) = (A‚Ä≤, t‚Ä≤), when n realises the statement that t and t‚Ä≤ they have the
same image, i.e.:
‚àÄa ‚ààA ‚àÉa‚Ä≤ ‚ààA‚Ä≤: ta = t‚Ä≤a‚Ä≤ and ‚àÄa‚Ä≤ ‚ààA‚Ä≤ ‚àÉa ‚ààA: ta = t‚Ä≤a‚Ä≤.
I and E map (A, t) to supA(t) and vice versa, whereas the internal elementhood
relation is deÔ¨Åned by:
m ‚ä¢x œµ supA(t)
‚áî
j0m ‚ààA and j1m ‚ä¢x = t(j0m),
which was not just an abbreviation.
Proposition 4.3.6 As an object of the eÔ¨Äective topos, V is uniform, i.e. there is a
natural number n such that:
n ‚ä¢x = x
for all x ‚ààV .
Proof. It is clear that WœÄ is uniform (a solution for f = Œªn.f decorates every tree),
and V , as its quotient, is therefore also uniform.
‚ñ°
Corollary 4.3.7 The following clauses recursively deÔ¨Åne what it means that a certain
statement is realised by a natural number n in the model V :
n ‚ä¢x œµ supA(t)
‚áî
j0n ‚ààA and j1n ‚ä¢x = t(j0n).
n ‚ä¢supA(t) = supA‚Ä≤(t‚Ä≤)
‚áî
‚àÄa ‚ààA: j0n ¬∑ a ‚Üìand j0n ¬∑ a ‚ä¢ta œµ supA‚Ä≤(t‚Ä≤)) and
‚àÄa‚Ä≤ ‚ààA‚Ä≤: j0n ¬∑ a‚Ä≤ ‚Üìand j1n ¬∑ a‚Ä≤ ‚ä¢t‚Ä≤a‚Ä≤ œµ supA(t).
n ‚ä¢œÜ ‚àßœà
‚áî
j0n ‚ä¢œÜ and j1n ‚ä¢œà.
n ‚ä¢œÜ ‚à®œà
‚áî
n = ‚ü®0, m‚ü©and m ‚ä¢œÜ, or n = ‚ü®1, m‚ü©and m ‚ä¢œà.
n ‚ä¢œÜ ‚Üíœà
‚áî
For all m ‚ä¢œÜ, n ¬∑ m ‚Üìand n ¬∑ m ‚ä¢œà.
n ‚ä¢¬¨œÜ
‚áî
There is no m such that m ‚ä¢œÜ.
n ‚ä¢‚àÉx œÜ(x)
‚áî
n ‚ä¢œÜ(a) for some a ‚ààV.
n ‚ä¢‚àÄx œÜ(x)
‚áî
n ‚ä¢œÜ(a) for all a ‚ààV.
Therefore the model is the same as the one introduced by Lubarsky in [53]. One
could use these clauses to verify that all the principles that are listed in Theorem
4.3.5 are valid, but that is not what I recommend. Instead, it is easier to use that V
is Ô¨Åxpoint for Ps, together with properties of the class of subcountable maps S and
of the eÔ¨Äective topos.
Proof of Theorem 4.3.5.

4.3. A REALISABILITY MODEL OF CZF
79
(Full Separation) The model V satisÔ¨Åes full separation, because all monos belong
to S.
In more detail, assume w ‚ààV and œÜ(x) is a set-theoretic property.
W = E(w) is a small subset of V , and since monos are small, so is V = {x ‚àà
W | œÜ(x)}. Then take v = I(V ).
(All sets subcountable) Before we check the principle that all sets are subcount-
able in V , let us Ô¨Årst see how the natural numbers are interpreted in V . The
empty set ‚àÖis interpreted by I(0), where 0 ‚äÜV is the least subobject of V ,
which is small. s(x) = I(x ‚à™{x}) deÔ¨Ånes an operation on V , therefore there
is a mapping i: N
/ V . This is actually an inclusion, and its image is small
(because N is). So if one writes œâ = I(N), then this interprets the natural
numbers.
If x is an arbitrary element in V , E(x) is small, so (internally in Eff) Ô¨Åts into
a diagram like this:
A /
/
q 
N
E(x).
One embeds the graph of q in V , by deÔ¨Åning a morphism T: A
/ V , as follows:
T(a) = (i(a), q(a)) ‚ààV,
where I implicitly use the standard coding of pairs of sets. Since A is small,
T can also be considered as an element of Ps(V ). Now t = I(T) is inside V a
function that maps a subset of the natural numbers to x.
(Non-existence of Pœâ) The principle that all sets are subcountable immediately
implies the non-existence of Pœâ, using Cantor‚Äôs Diagonal Argument.
(Axiom of Countable Choice), (Axiom of Relativised Dependent Choice)
The Principle of Relativised Dependent Choice V inherits from the eÔ¨Äective
topos Eff.
(Presentation Axiom) Recall that a set b in CZF is called a base, when every
surjection q: x
/ b has a section. To see that every set is the surjective image
of a base, notice that in V every set is the surjective image of a ¬¨¬¨-closed subset
of œâ, and these are internally projective in Eff.
(Markov‚Äôs Principle), (Independence of Premisses) These hold in V , because
these principles are valid in Eff.
(Church‚Äôs Thesis) This is a bit harder: see below for an argument.
(Uniformity Principle), (Unzerlegbarkeit) To see that the uniformity principle
holds, observe that a realiser for a statement of the form ‚àÄx ‚àÉyœµa (. . .) spec-
iÔ¨Åes an yœµa that works uniformly for all x. Unzerlegbarkeit follows from the
uniformity principle, using a = {0, 1}.

80
CHAPTER 4. ALGEBRAIC SET THEORY AND CZF
‚ñ°
Remark 4.3.8 It may be good to point out that not only does Pœâ not exist in the
model, neither does Px when x consists of only one element, say x = {‚àÖ}. For if it
would, so would (Px)œâ, by Subset Collection. But it is not hard to see that (Px)œâ
can be reworked into the powerset of œâ.
Relationship with work of Streicher 4.3.9
In [80], Streicher builds a model of
CZF which in my terms can be understood as follows. He starts from a well-known
map œÅ: E
/ U in the category Asm of assemblies. Here U is the set of all modest
sets, with a modest set u realised by any natural number, and a Ô¨Åbre Eu in assemblies
being precisely the modest set u. He proceeds to build the W-type associated to œÅ,
takes it as a universe of sets, and then interprets equality as bisimulation. One cannot
literally quotient by bisimulation, for which one could pass to the eÔ¨Äective topos.
When considering œÅ as a morphism in the eÔ¨Äective topos, it is not hard to see that it
is in fact a ‚Äúweak representation‚Äù for the class of subcountable morphisms S: for all
Ô¨Åbres of ‚Äúmy‚Äù weak representation œÄ also occur as Ô¨Åbres of œÅ, and all Ô¨Åbres of œÅ are
quotients of Ô¨Åbres of œÄ. Therefore the model is again the initial Ps-algebra for the
class of subcountable morphisms S in the eÔ¨Äective topos, by the work of Moerdijk
and Palmgren.
Relationship with work of McCarty 4.3.10
In his PhD thesis [58], McCarty
introduced a realisability model U for the constructive, but impredicative set theory
IZF. U is very similar to the model V I have been investigating, but its exact relation
is not immediately obvious. In [48], the authors Kouwenhoven-Gentil and Van Oosten
show how also McCarty‚Äôs model U is the initial Pt-algebra for a class of small maps
T in the eÔ¨Äective topos. As S ‚äÜT, and hence Ps ‚äÜPt, U is also a Ps-algebra, so it
is clear that V embeds into U. Actually, V consists of those x ‚ààU that U believes
to be hereditarily subcountable.
To see this, write
A = {x ‚ààU | U |= x is hereditarily subcountable}.
A is a Ps-subalgebra of U, and it will be isomorphic to V , once one proves that is
initial. It is obviously a Ô¨Åxpoint, so it suÔ¨Éces to show that it is well-founded (see
[48]). So let B ‚äÜA be a Ps-subalgebra of A, and deÔ¨Åne
W = {x ‚ààU | x ‚ààA ‚áíx ‚ààB}.
It is not hard to see that this is a Pt-subalgebra of U, so W = U and A = B.
This also shows concerning Church‚Äôs Thesis, that, as it is valid in McCarty‚Äôs model U
and it concerns only sets that also exist in V , it is also valid in V . The same applies
to what is called Extended Church‚Äôs Thesis.

Chapter 5
Coinduction in categories
In the preceeding Chapters, I have been exploiting the connections between the three
concepts in the following picture.




CZF with
REA
O
O
O
O
O
O
O
O
O
O
O




Martin-L¬®of type theory
with W-types and a universe
kkkkkkkkkkkkkkk




Œ†W-pretopos with
a class of small maps
They all concern basic notions (the set theory CZF, Martin-L¬®of type theory, locally
cartesian closed pretoposes) extended with additional structure (REA, W-types and
the existence of certain initial algebras, respectively) to incorporate inductive deÔ¨Åni-
tions. The idea of Federico De Marchi and me was to investigate a possible ‚Äúnon-
well-founded‚Äù or ‚Äúcoinductive‚Äù analogue to this picture.
The question we asked ourselves is whether a set theory like CZF with the Anti-
Foundation Axiom instead of the Axiom of Foundation, has similar strong relations
with categories or type theories equipped with coinductive types, as does CZF+REA
with categories and type theories with inductive types. Categories with what I have
called M-types (see Chapter 2) seem the appropriate analogue to investigate. Where
W-types are the initial algebras for polynomial functors, M-types are their Ô¨Ånal coal-
gebras. As we have seen in the Chapter 1, W-types frequently consist of well-founded
trees, while M-types consist of general (‚Äúnon-well-founded‚Äù1) trees.
Type theory
with coinductive types (M-types) instead of W-types was introduced by Federico De
Marchi in [26], and the relation between categories with M-types and type theory
with coinductive types was investigated there.
1The phrase ‚Äúnon-well-founded‚Äù is a bit confusing: it does not mean ‚Äúnot well-founded‚Äù. It
means rather something like ‚Äúnot necessarily well-founded‚Äù. The function of the word ‚Äúnon-well-
founded‚Äù is more to warn the reader that one is thinking of arbitrary trees and is not restricting
oneself to the well-founded case.
81

82
CHAPTER 5. COINDUCTION IN CATEGORIES
A result by Lindstr¬®om [52] connected type theory and non-well-founded set the-
ory: she discovered how one can model non-well-founded set theory in Martin-L¬®of
type theory with one universe. Somewhat surprisingly, she did not need any kind of
coinductive types. A similar phenomenon will arise in the next Chapter where I will
discuss models of non-well-founded set theory in categories. On this point, the anal-
ogy with the inductive (well-founded) picture does not seem to be perfect: categorical
or type-theoretic W-types are necessary to build interpretations of well-founded set
theory in [2] and [61].
In this Chapter, I will be more concerned with categories possessing M-types
in themselves. In particular, I will prove existence results for M-types and closure
properties of categories with M-types (glueing, coalgebras for a cartesian comonad
and (pre)sheaves). In some cases, the results for categories with M-types are better
than the ones for Œ†W-pretoposes, on which they occasionally shed some light. As
discussed, these closure properties have proved most important in topos theory and led
to the formulation of various independence results. Hopefully, these closure properties
of categories with M-types will prove helpful in investigating non-well-founded set
theories and type theories.
This Chapter reports joint work with Federico De Marchi, and has been submitted
for publication.
5.1
Preliminaries
Throughout this Chapter, E will denote a locally cartesian closed pretopos with a
natural number object.
Recall from Chapter 1 that one associates to a morphism f: B
/ A in E, a
polynomial functor Pf: E
/ E, which is deÔ¨Åned as
Pf(X) = Œ£a‚ààAXBa
or, more formally, as
Pf(X) = Œ£A(A √ó X
p1 /A)(B
f
/A),
where the exponential is taken in the slice category E/A. The Ô¨Ånal coalgebra for Pf is
called the M-type for f, whenever it exists, and denoted by Mf. The intuition is that
f represents a signature, with the elements a in A representing term constructors
of arity Ba.
The elements of the M-type are then (possibly inÔ¨Ånite) terms over
this signature. Another intuition is that they are trees where nodes are labelled by
elements a in A and edges by elements b in B, in such a way that f ‚àí1(a) enumerates
the edges into a node labelled by a.
One says that E has M-types, if Ô¨Ånal coalgebras exist for every polynomial func-
tor. A Œ†M-pretopos will be a locally cartesian closed pretopos with a natural num-
ber object and M-types. It is the purpose of this Chapter to prove the closure of

5.1. PRELIMINARIES
83
Œ†M-pretoposes under slicing, formation of coalgebras for a cartesian comonad and
(pre)sheaves.
As already pointed out, by Lambek‚Äôs lemma (Lemma A.14), the Pf-coalgebra
structure map of an M-type Mf for a morphism f: B
/ A,
œÑf: Mf
/ Pf(Mf)
is an isomorphism, and therefore has a section, denoted by supf (or just sup, when f
is understood). Furthermore, because there is a natural transformation œÅ: Pf
/ A,
where A is the constant functor sending objects to A and morphisms to the identity on
A, whose component on an object X sends (a, t) ‚ààPf(X) to a ‚ààA, œÑ also determines
a root map
Mf
œÑf
/ Pf(Mf)
œÅ
/ A,
which, by an abuse of notation, will again be denoted by œÅ. I will also abuse termi-
nology by calling the components œÅX of the natural transformation ‚Äúroot maps‚Äù. I
am conÔ¨Ådent that this will not generate any confusion.
Given a pullback diagram in E
B‚Ä≤
f‚Ä≤

Œ≤
/ B
f

A‚Ä≤
Œ±
/ A,
one can think of Œ± as a morphism of signatures, since the Ô¨Åbre over each a‚Ä≤ ‚ààA‚Ä≤ is
isomorphic to the Ô¨Åbre over Œ±(a‚Ä≤) ‚ààA. It is therefore reasonable to expect, in such a
situation, an induced morphism between Mf‚Ä≤ and Mf, when these exist.
In fact, as already pointed out in [60], such a pullback square induces a natural
transformation eŒ±: Pf‚Ä≤
/ Pf such that
œÅeŒ± = Œ±œÅ.
(5.1)
Post-composition with eŒ± turns any Pf‚Ä≤-coalgebra into one for Pf. In particular, this
happens for Mf‚Ä≤, thus inducing a unique coalgebra homomorphism as in
Mf‚Ä≤
Œ±!
/
œÑf‚Ä≤

Mf
œÑf

Pf‚Ä≤(Mf‚Ä≤)
eŒ±

Pf(Mf‚Ä≤) Pf(Œ±!)
/ Pf(Mf).
(5.2)
Notice that, by (5.1), the morphism Œ±! preserves the root maps.

84
CHAPTER 5. COINDUCTION IN CATEGORIES
Again, extensive use will be made of the language of paths. Recall the observation
made in Chapter 2, that the notion of path can be deÔ¨Åned in the internal logic of E
for any Pf-coalgebra
X
Œ≥
/PfX.
The idea is that a Ô¨Ånite sequence of odd length ‚ü®x0, b0, x1, b1, . . . , xn‚ü©is called a path
in (X, Œ≥), if every xi is in X, every bi is in B and for every i < n one has
xi+1 = Œ≥(xi)(bi).
(5.3)
More precisely, if Œ≥(xi) = (ai, ti), then one is asking that f(bi) = ai and xi+1 = ti(bi).
An element x ‚ààX is called a child of y ‚ààX, when there is a path ‚ü®y, b, x‚ü©.
In the particular case when X is the Ô¨Ånal coalgebra Mf, a path ‚ü®m0, b0, . . . , mn‚ü©in
this sense coincides precisely with a path in the usual sense in the non-well-founded
tree m0. I will therefore say that such a path lies in m0, and by extension, a path
‚ü®x0, b0, . . . , xn‚ü©lies in x0 ‚ààX for any coalgebra (X, Œ≥). All paths in a coalgebra (X, Œ≥)
are collected into a subobject
Paths(Œ≥) ‚äÜ(X + B + 1)N.
Any morphism of coalgebras Œ±: (X, Œ≥)
/ (Y, Œ¥) induces a morphism
Œ±‚àó: Paths(Œ≥)
/ Paths(Œ¥)
(5.4)
between the objects of paths in the respective coalgebras. A path ‚ü®x0, b0, . . . , xn‚ü©is
sent by Œ±‚àóto ‚ü®Œ±(x0), b0, . . . , Œ±(xn)‚ü©. Furthermore, given a path œÑ = ‚ü®y0, b0, . . . , yn‚ü©in
Y and an x0 such that Œ±(x0) = y0, there is a unique path œÉ starting with x0 such
that Œ±‚àó(œÉ) = œÑ. (Proof: deÔ¨Åne xi+1 inductively for every i < n using (5.3) and put
œÉ = ‚ü®x0, b0, . . . , xn‚ü©.)
In fact, in order to introduce the concept of path, one needs even less than a
coalgebra: it is suÔ¨Écient to have a common environment in which to read equation
(5.3). Given a map f: B
/ A in E, consider the category Pf ‚àíprtclg of Pf-proto-
coalgebras. Its objects are pairs of maps
(Œ≥, m) = X
Œ≥
/ Y
Pf(X),
o
m
o
(5.5)
where m is monic. An arrow between (Œ≥, m) and (Œ≥‚Ä≤, m‚Ä≤) is a pair of maps (Œ±, Œ≤)
making the following commute:
X
Œ≥
/
Œ±

Y
Œ≤

Pf(X)
o
m
o
Pf(Œ±)

X‚Ä≤
Œ≥‚Ä≤
/ Y ‚Ä≤
Pf(X‚Ä≤).
o
m‚Ä≤
o
Notice that there is an obvious inclusion functor
I: Pf ‚àícoalg
/ Pf ‚àíprtclg,
(5.6)

5.1. PRELIMINARIES
85
mapping a coalgebra Œ≥: X
/ Pf(X) to the pair (Œ≥, idPfX). Proto-coalgebras do not
seem to be very interesting in themselves, but they will be very helpful for studying
M-types.
For a proto-coalgebra as in (5.5), one can introduce the notion of a path in the
following way. I shall call an element x ‚ààX branching if Œ≥(x) lies in the image of m.
Then, I call a sequence of odd length œÉ = ‚ü®x0, b0, x1, b1, . . . , xn‚ü©a path if it satisÔ¨Åes
the properties:
1. xi ‚ààX is branching for all i < n
2. bi ‚ààBai for all i < n
3. ti(bi) = xi+1 for all i < n
where (ai, ti) is the (unique) element in PfX such that Œ≥(xi) = m(ai, ti). An element
x ‚ààX is called coherent, if all paths starting with x end with a branching element.
So, all coherent elements are automatically branching, and their children, identiÔ¨Åed
through m, are themselves coherent. So the object Coh(Œ≥) of coherent elements has
a Pf-coalgebra structure. In fact, this is the biggest coalgebra which one can embed
in (Œ≥, m), i.e. a coreÔ¨Çection of the latter for the inclusion functor I of (5.6).
Proposition 5.1.1 The assignment (Œ≥, m)
/Coh(Œ≥) mapping any Pf-proto-coal-
gebra to the object of coherent elements in it, determines a right adjoint Coh to the
functor I: Pf ‚àícoalg
/ Pf ‚àíprtclg.
Proof. Consider a proto-coalgebra
X
Œ≥
/ Y
Pf(X),
o
m
o
and build the object Coh(Œ≥) of coherent elements in X. Because any coherent element
x ‚ààCoh(Œ≥) is also branching, one can Ô¨Ånd a (necessarily unique) pair (a, t) such that
Œ≥(x) = m(a, t).
By deÔ¨Åning œá(x) = (a, t), I equip Coh(Œ≥) with a Pf-coalgebra
structure (notice that, x being coherent, so are the elements in the image of t). The
coalgebra (Coh(Œ≥), œá) clearly Ô¨Åts in a commutative diagram
Coh(Œ≥) /
i
/
œá

X
Œ≥

Pf(Coh(Œ≥)) /
Pfi
/ Pf(X) /
m
/ Y.

86
CHAPTER 5. COINDUCTION IN CATEGORIES
Let now (X‚Ä≤, œá‚Ä≤) be any other Pf-coalgebra. Then, given a coalgebra morphism
X‚Ä≤
œÜ
/
œá‚Ä≤

Coh(Œ≥)
œá

Pf(X‚Ä≤)
PfœÜ
/ Pf(Coh(Œ≥)),
the pair (iœÜ, mPf(iœÜ)) clearly determines a proto-coalgebra morphism from I(X‚Ä≤, œá‚Ä≤)
to (Œ≥, m). Conversely, any proto-coalgebra morphism
X‚Ä≤
œá‚Ä≤
/
Œ±

Pf(X‚Ä≤)
Œ≤

Pf(X‚Ä≤)
Pf(Œ±)

X
Œ≥
/ Y
Pf(X)
o
m
o
has the property that Œ±(x‚Ä≤) is branching for any x‚Ä≤ ‚ààX‚Ä≤. Using an opportune exten-
sion to proto-coalgebras of the morphism Œ±‚àódescribed in (5.4) above, one can then
easily check that elements in the image of Œ± are coherent. Hence, Œ± factors through
the object Coh(Œ≥), inducing a coalgebra morphism from (X‚Ä≤, œá‚Ä≤) to (Coh(Œ≥), œá).
It is now easy to check that the two constructions are mutually inverse, thereby de-
scribing the desired adjunction.
‚ñ°
A particular subcategory of proto-coalgebras arises when one has another endo-
functor F on E and an injective natural transformation m: Pf /
/F . In this case, any
F-coalgebra œá: X
/ FX can easily be turned into the Pf-proto-coalgebra (œá, mX).
This determines a functor bm: F ‚àícoalg
/ Pf ‚àíprtclg, which is clearly faithful.
Proposition 5.1.2 The adjunction I ‚ä£Coh of Proposition 5.1.1 restricts to an ad-
junction m‚àó‚ä£Coh bm, if m‚àó: Pf ‚àícoalg
/ F ‚àícoalg takes œá: X
/ PfX to (X, mXœá).
Proof. Consider a Pf-coalgebra (Z, Œ≥) and an F-coalgebra (X, œá). Then, a sim-
ple diagram chase, using the naturality of m, shows that F-coalgebra morphisms
from m‚àó(Z, Œ≥) to (X, œá) correspond bijectively to morphisms of proto-coalgebras from
I(Z, Œ≥) to bm(X, œá), hence by Proposition 5.1.1 to Pf-coalgebra homomorphisms from
(Z, Œ≥) to Coh( bm(X, œá)).
‚ñ°
5.2
Existence results for M-types
The crucial point in showing that Œ†M-pretoposes are closed under the various con-
structions I am going to consider, will always be that of showing existence of M-types.
The machinery to do so will be set up in this Section. But the results are not just

5.2. EXISTENCE RESULTS FOR M-TYPES
87
useful for that. They are, I think, valuable in themselves and raise interesting ques-
tions.
Traditionally, one can recover non-well-founded trees from well-founded ones,
whenever the signature has one speciÔ¨Åed constant. In fact, the constant allows for
the deÔ¨Ånition of truncation functions, which cut a tree at a certain depth and replace
all the term constructors at that level by that speciÔ¨Åed constant. The way to recover
non-well-founded trees is then to consider sequences of trees (tn)n>0 such that each
tn is the truncation at depth n of tm for all m > n. Each such sequence is viewed as
the sequence of approximations of a non-well-founded tree.
Recall that the context is that of a Œ†-pretopos E with nno. In this context, I call
a map f: B
/ A pointed, when the signature it represents has a speciÔ¨Åed constant
symbol, i.e. if there exists a global element ‚ä•: 1
/ A such that the following is a
pullback:
0
/

B
f

1
‚ä•
/ A.
The next two statements make clear that, instead of starting with well-founded
trees, i.e. with the W-type for f, one can build these approximations from any Ô¨Åxpoint
of Pf.
Lemma 5.2.1 If for some pointed f in E, Pf has a Ô¨Åxpoint, then it also has a Ô¨Ånal
coalgebra.
Proof. Assume X is an algebra whose structure map sup: PfX
/ X is an isomor-
phism. Observe, Ô¨Årst of all, that X has a global element
‚ä•: 1
/ X,
(5.7)
namely sup‚ä•(t), where ‚ä•is the point of f and t is the unique map B‚ä•= 0
/ X.
DeÔ¨Åne, by induction, the following truncation functions trn: X
/ X:
tr0
=
‚ä•
trn+1
=
sup ‚ó¶Pf(trn) ‚ó¶sup‚àí1
Using these maps, one can deÔ¨Åne an object M, consisting of sequences (Œ±n ‚ààX)n>0
with the property:
Œ±n = trn(Œ±m) for all n < m.
Now, one deÔ¨Ånes a morphism œÑ: M
/ PfM as follows. Given a sequence Œ± = (Œ±n) ‚àà
M, observe that œÅ(Œ±n) is independent of n and is some element a ‚ààA. Hence, each
Œ±n is of the form supa(tn) for some tn: Ba
/ X, and I deÔ¨Åne t: Ba
/ M by putting

88
CHAPTER 5. COINDUCTION IN CATEGORIES
t(b)n = tn+1(b) for every b ‚ààBa; then œÑ(Œ±) = (a, t). Thus, M has the structure of a
Pf-coalgebra, and I claim it is the terminal one.
To show this, given another coalgebra œá: Y
/ PfY , I wish to deÔ¨Åne a map of coal-
gebras bp: Y
/ M. This means deÔ¨Åning maps bpn: Y
/ X for every n > 0, with the
property that bpn = trnbpm for all n < m. Intuitively, bpn maps a state of Y to its ‚Äúun-
folding up to level n‚Äù, which I can mimic in X. Formally, they are deÔ¨Åned inductively
by
bp0
=
‚ä•
bpn+1
=
sup ‚ó¶Pf(bpn) ‚ó¶œá.
It is now easy to show, by induction on n, that bpn = trnbpm for all m > n. For
n = 0, both sides of the equation become the constant map ‚ä•.
Supposing the
equation holds for a Ô¨Åxed n and any m > n, then for n + 1 and any m > n one has
bpn+1 = supPf(bpn)œá = supPf(trnbpm)œá = supPf(trn)sup‚àí1supPf(bpm)œá = trn+1bpm+1.
I leave to the reader the veriÔ¨Åcation that bp is the unique Pf-coalgebra morphism from
Y to M.
‚ñ°
Theorem 5.2.2 If Ô¨Åxpoints exist in E for all Pf (with f pointed), then E has M-types.
Proof. Let f: B
/ A be a map. I freely add a point to the signature represented
by f, by considering the composite
f‚ä•: B
f
/ A /
i
/ A + 1
(5.8)
(with the point j = ‚ä•: 1
/ A + 1). Notice that the obvious pullback
B
id
/
f

B
f‚ä•

A /
i
/ A + 1
determines a (monic) natural transformation i!: Pf
/ Pf‚ä•by (5.2); hence, by Propo-
sition 5.1.2, the functor (i!)‚àó: Pf ‚àícoalg
/ Pf‚ä•‚àícoalg has a right adjoint. Now ob-
serve that Pf‚ä•has a Ô¨Åxpoint, by assumption, hence a Ô¨Ånal coalgebra by Lemma 5.2.1.
This will be preserved by the right adjoint of (i!)‚àó, hence Pf has a Ô¨Ånal coalgebra.
‚ñ°
This proof gives a categorical counterpart of the standard set-theoretic construc-
tion: add a dummy constant to the signature, build inÔ¨Ånite trees by sequences of
approximations, then select the actual M-type by taking those inÔ¨Ånite trees which
involve only term constructors from the original signature. This last passage is per-
formed by the coreÔ¨Çection functor of Proposition 5.1.2, since branching elements are

5.2. EXISTENCE RESULTS FOR M-TYPES
89
trees in the M-type of f‚ä•whose root is not ‚ä•, and coherent ones are trees with no
occurrence of ‚ä•at any point.
From this last theorem, one readily deduces the following result, Ô¨Årst pointed out
by Abbott, Altenkirch and Ghani [1].
Corollary 5.2.3 Every Œ†W-pretopos is a Œ†M-pretopos.
Proof. Since the W-type associated to a (pointed) map f is a Ô¨Åxpoint for Pf, E also
has all M-types by the previous theorem.
‚ñ°
Remark 5.2.4 This result shows that there is a substantial class of examples of Œ†M-
pretoposes. It is an open problem to Ô¨Ånd a non-syntactic example of a Œ†M-pretopos
that is not a Œ†W-pretopos.
In Chapter 2, we have seen some examples of categories which have M-types, but
are not Œ†M-pretoposes; for instance, the category of modest sets, or that of assemblies
(or œâ-sets). The only reason these categories are not examples of Œ†M-pretoposes is
that they fail to be exact. However, notice that exactness is not necessary for the
proofs. In fact, regularity would be suÔ¨Écient to establish all the closure properties.
Although Theorem 5.2.2 is clearly helpful in proving that categories have M-types,
it is even more so, when combined with the following observation.
Lemma 5.2.5 Any preÔ¨Åxpoint Œ±: PfX
/ X, that is, an algebra whose structure map
is monic, has a subalgebra that is a Ô¨Åxpoint.
Proof. Any preÔ¨Åxpoint Œ±: PfX
/ X can be seen as a Pf-proto-coalgebra
X
id
/ X
PfX.
o
Œ±
o
Its coreÔ¨Çection Coh(id, Œ±), deÔ¨Åned in Proposition 5.1.1, is a Pf-coalgebra Œ≥: Y
/ PfY
(in fact, the largest) Ô¨Åtting in the following commutative square:
Y
/
i
/
Œ≥

X
PfY
/
Pfi
/ PfX.
O
Œ±
O
Now, consider the image under the functor I: Pf ‚àícoalg
/ Pf ‚àíprtclg of the coalge-
bra Pf(Œ≥): PfY
/ P 2
f Y . The morphism of proto-coalgebras
PfY
PfŒ≥ /
Œ±Pfi

P 2
f Y
Œ±Pf(Œ±)P 2
f i

P 2
f Y
o
id
o
Pf(Œ±)P 2
f i

X
id
/ X
PfX
o
Œ±
o

90
CHAPTER 5. COINDUCTION IN CATEGORIES
transposes through the adjunction I ‚ä£Coh to a morphism œÜ: (PfY, PfŒ≥)
/ (Y, Œ≥),
which is a right inverse of Œ≥: (Y, Œ≥)
/ (PfY, PfŒ≥) by the universal property of (Y, Œ≥).
Hence, I have Œ≥œÜ = Pf(œÜŒ≥) = id, proving that Œ≥ and œÜ are mutually inverse.
‚ñ°
Putting together Theorem 5.2.2 and Lemma 5.2.5, one gets at once the following:
Corollary 5.2.6 If E has preÔ¨Åxpoints for every polynomial functor, then E has M-
types.
As an application of the techniques in this Section, I present the following result,
which is to be compared with the one by Santocanale in [78]. An immediate corollary
of his Theorem 4.5 is that M-types exist in every locally cartesian closed pretopos
with a natural number object, for maps of the form f: B
/ A where A is a Ô¨Ånite sum
of copies of 1. Notice that such an object A has decidable equality, i.e. the diagonal
‚àÜ: A
/ A √ó A has a complement in the subobject lattice of A √ó A. I extend the
statement above to all maps whose codomain has decidable equality.
Proposition 5.2.7 When f: B
/ A is a morphism in E whose codomain A has
decidable equality, then the M-type for f exists.
Proof. Without loss of generality, one may assume that f is pointed; in fact, if one
replaces A by A‚ä•= A+1 and f by f‚ä•as in (5.8), then A‚ä•also has decidable equality,
and the existence of an M-type for the composite f‚ä•implies that of an M-type for
f (see the proof of Theorem 5.2.2). Then, by Lemma 5.2.5 and Lemma 5.2.1, it is
enough to show that Pf has a preÔ¨Åxpoint.
Let S be the object of all Ô¨Ånite sequences of the form
‚ü®a0, b0, a1, b1, . . . , an‚ü©
where f(bi) = ai for all i < n. (Like paths in a coalgebra, this object S can be
constructed using the internal logic of E.) Now, let V be the object of all decidable
subobjects of S (these can be considered as functions S
/ 1 + 1). DeÔ¨Åne the map
m: PfV
/ V taking a pair (a, t: Ba
/ V ) to the subobject P of S deÔ¨Åned by the
following clauses:
1. ‚ü®a0‚ü©‚ààP iÔ¨Äa0 = a.
2. ‚ü®a0, b0‚ü©‚àóœÉ ‚ààP iÔ¨Äa0 = a and œÉ ‚ààt(b0).
(Here, ‚àóis the symbol for concatenation.) P is obviously decidable, so m is well-
deÔ¨Åned. To see that it is monic, suppose P = m(a, t) and P ‚Ä≤ = m(a‚Ä≤, t‚Ä≤) are equal.
Then,
‚ü®a‚ü©‚ààP =‚áí‚ü®a‚ü©‚ààP ‚Ä≤ =‚áía = a‚Ä≤,

5.3. CLOSURE PROPERTIES
91
and, for every b ‚ààBa and œÉ ‚ààS,
œÉ ‚ààt(b)
‚áê‚áí
‚ü®a, b‚ü©‚àóœÉ ‚ààP
‚áê‚áí
‚ü®a, b‚ü©‚àóœÉ ‚ààP ‚Ä≤
‚áê‚áí
œÉ ‚ààt‚Ä≤(b),
so t = t‚Ä≤ and m is monic. Hence, (V, m) is a preÔ¨Åxpoint for Pf and the proof is
Ô¨Ånished.
‚ñ°
It is an interesting question whether this result can be generalised even further.
However, it is my feeling that not all M-types can be proved to exist in general.
Unfortunately, the lack of examples of Œ†-pretoposes with natural number object, but
without W-types makes it hard to give counterexamples.
Remark 5.2.8 To obtain a concrete description of the M-type for a map f with a
codomain with decidable equality, one should start with the objects S and V con-
structed in the proof of Proposition 5.2.7. Then one should deduce a Ô¨Åxpoint V ‚Ä≤ from
V , as in Corollary 5.2.6. This means selecting the coherent elements of V , and these
turn out to be those decidable subobjects P of S satisfying the following properties:
1. ‚ü®a‚ü©‚ààP for a unique a ‚ààA;
2. if ‚ü®a0, b0, . . . , an‚ü©‚ààP, then there exists a unique an+1 for any bn ‚ààBan such
that ‚ü®a0, b0, . . . , an, bn, an+1‚ü©‚ààP.
Next, one should turn this Ô¨Åxpoint into the M-type for f (as in Lemma 5.2.1), but
this step is redundant, since the choice of V is such that V ‚Ä≤ already is the desired
M-type.
5.3
Closure properties
After these preliminaries, I establish closure of Œ†M-pretoposes under slicing, coalge-
bras for a cartesian comonad, presheaves and sheaves.
5.3.1
M-types and slicing
I start by considering preservation of the Œ†M-pretopos structure under slicing. Let I
be an object in a Œ†-pretopos with nno E. Then, it is well-known that the slice category
E/I has again the same structure, and the reindexing functor x‚àó: E/I
/ E/J for any
map x: J
/ I in E preserves it. So, I can focus on showing the existence of M-types
in E/I. Their preservation under reindexing immediately follows from some results on
indexed categories (see Lemma A.19 and Lemma A.21). Therefore, I shall concentrate

92
CHAPTER 5. COINDUCTION IN CATEGORIES
on the existence of M-types in slice categories, proving a ‚Äúlocal existence‚Äù result, from
which I derive a global statement.
Let us consider a map
B
f
/
Œ≤
?
?
?
?
?
?
?
?
A
Œ±
       I
(5.9)
in E/I.
I shall denote by Pf the polynomial functor determined by f (or, more
precisely, by Œ£f) in E, and by P I
f the polynomial endofunctor determined in E/I.
The functor Pf: E
/ E can be extended to a functor Pf: E
/ E/I; in fact, PfX
lives over A via the root map, and the composite Œ±œÅ: PfX
/ I deÔ¨Ånes the desired
extension.
Lemma 5.3.1 There is an injective natural transformation of endofunctors on E/I
c: P I
f
/ PfŒ£I.
Proof. For an object Œæ: X
/ I in E/I and i ‚ààI:
P I
f (X
Œæ
/I)i = {(a, t: Ba
/ X) | Œ±(a) = i, ‚àÄb ‚ààBa: Œ≤t(b) = i}
and
Pf(Œ£I(X
Œæ
/I)) = {(a, t: Ba
/ X) | Œ±(a) = i}.
The Ô¨Årst in clearly contained in the second. Naturality is readily checked.
‚ñ°
Using the map c of Lemma 5.3.1, one can build an M-type for f in E/I, whenever
Mf exists in E.
Theorem 5.3.2 Let E be a locally cartesian closed pretopos with a natural number
object and I an object in E. Consider a map f: B
/ A over I, such that the functor
Pf: E
/ E has a Ô¨Ånal coalgebra. Then, f has an M-type in E/I.
Proof. Let œÑf: Mf
/ PfMf be the M-type associated to f in E. Mf can be consid-
ered as an object over I, by taking the composite ¬µ of the root map œÅ: Mf
/ A with
the map Œ±: A
/ I, and (Mf, œÑf) then becomes the Ô¨Ånal PfŒ£I-coalgebra, as one can
easily check. The adjunction determined by the natural transformation c: P I
f
/ PfŒ£I
as in Proposition 5.1.2 takes the Ô¨Ånal PfŒ£I-coalgebra (Mf, œÑf) to its coreÔ¨Çection M I
f ,
and because right adjoints preserve limits, this is the Ô¨Ånal P I
f -coalgebra.
‚ñ°
Remark 5.3.3 The injective natural transformation c of Lemma 5.3.1 identiÔ¨Åes as
branching elements in PfŒ£I those obtained by applying a term constructor in A to
elements living in its same Ô¨Åbre over I.

5.3. CLOSURE PROPERTIES
93
The coreÔ¨Çection process used to build M I
f out of the M-type (Mf, œÑf), helps to
understand which elements of the latter do actually belong to the former. Trees in
M I
f are coherent for the notion of branching determined by P I
f , hence, not only the
children of the root node live in its same Ô¨Åbre over I, but all the children of the
children do too, and so on. In other words, M I
f consists of those trees in Mf all nodes
of which live in the same Ô¨Åbre over I. As such, the object M I
f can also be described
as the equaliser
M I
f /
/ Mf
‚ü®id,Œ±‚ü©!
/
‚ü®id,Œ±œÅ‚ü©&M
M
M
M
M
M
M
Mf√óI,
Mf √ó I
œá
7o
o
o
o
o
o
where œá is the map coinductively deÔ¨Åned as
œá(supat, i) = sup(a,i)(œá‚ü®t, i‚ü©).
As an immediate consequence of Theorem 5.3.2, one gets the following:
Corollary 5.3.4 For any given object I of a Œ†M-pretopos E, the slice category E/I
is again a Œ†M-pretopos.
Remark 5.3.5 This last result could have also been proved directly by combining
Corollary 5.2.6 and Lemma 5.3.1. However, the proof of Theorem 5.3.2 shows that
the construction is actually simpler. More speciÔ¨Åcally, notice that, in this case, one
obtains the M-type for a map f directly after the coreÔ¨Çection, and it is not necessary
to add any dummy variable, nor to build sequences of approximations.
5.3.2
M-types and coalgebras
In this Section, I turn my attention to the construction of categories of coalgebras for
a cartesian comonad (G, œµ, Œ¥). See [55], Chapter VI, for the deÔ¨Ånition of a comonad
and a coalgebra for a comonad. By a cartesian comonad, I mean here that the functor
G is cartesian. As for the slicing case, I already know that most of the structure of a
Œ†M-pretopos is preserved by taking coalgebras for G:
Theorem 5.3.6 If E is a locally cartesian closed pretopos with natural number object,
then so is EG for a cartesian comonad G = (G, œµ, Œ¥) on E.
Proof. Theorem 4.2.1 on page 173 of [44] gives us that EG is cartesian, in fact lo-
cally cartesian closed, and that it has a natural number object. The two additional
requirements of having Ô¨Ånite disjoint sums and being exact are easily veriÔ¨Åed, using
in particular that the forgetful functor U: EG
/ E creates Ô¨Ånite limits.
‚ñ°

94
CHAPTER 5. COINDUCTION IN CATEGORIES
The aim of this Subsection is to prove that EG inherits M-types from E, in case they
exist in that category. The question whether Œ†W-pretoposes are closed under taking
coalgebras for a cartesian comonad, is still open.
Given a morphism f of coalgebras, this induces a polynomial functor Pf: EG
/ EG,
while its underlying map Uf determines the endofunctor PUf on E. The two are re-
lated as follows:
Proposition 5.3.7 Let f: (B, Œ≤)
/ (A, Œ±) be a map of G-coalgebras. Then, there is
an injective natural transformation
E
i‚Ü£
G

PUf
/ E
G

EG
Pf
/ EG,
whose mate under the adjunction U ‚ä£G, I shall denote by
j: UPf
/ PUfU: EG
/ E.
(5.10)
Proof. Recall from [44] that there is the following natural isomorphism
EG/(A, Œ±) ‚àº= (E/A)G‚Ä≤,
(5.11)
where G‚Ä≤ is a cartesian comonad on E/A, which is computed on an object t: X
/ A
in E/A by taking the following pullback:
G‚Ä≤X
G‚Ä≤t

/
/ GX
Gt

A /
Œ±
/ GA.
(5.12)
Notice that both horizontal arrows in this pullback are monic, because œµA is a retrac-
tion of the G-coalgebra Œ±.
Through the isomorphism (5.11), the object A√óGX
/ A corresponds to G‚Ä≤(p1: A√ó
X ‚ÜíA), whereas f corresponds to some map f ‚Ä≤ in (E/A)G‚Ä≤.
Therefore the ob-
ject Pf(GX) (i.e. the source of the exponential (A √ó GX
/ A)f in the category
EG/(A, Œ±)) corresponds to the exponential (G‚Ä≤p1)f‚Ä≤. Since U ‚Ä≤: (E/A)G‚Ä≤
/ E/A pre-
serves products because G‚Ä≤ does, there is the following chain of natural bijections:
Y
/
G‚Ä≤(pU‚Ä≤f‚Ä≤
1
)
U ‚Ä≤Y
/
pU‚Ä≤f‚Ä≤
1
U ‚Ä≤Y √ó U ‚Ä≤f ‚Ä≤
/
p1
U ‚Ä≤(Y √ó f ‚Ä≤)
/
p1
Y √ó f ‚Ä≤
/
(G‚Ä≤p1)
Y
/
(G‚Ä≤p1)f‚Ä≤.

5.3. CLOSURE PROPERTIES
95
So one deduces (G‚Ä≤p1)f‚Ä≤ ‚àº= G‚Ä≤(pU‚Ä≤f‚Ä≤
1
) = G‚Ä≤(pUf
1 ).
The latter Ô¨Åts in the following
pullback square, which is an instance of (5.12):
G‚Ä≤((A √ó X ‚ÜíA)Uf)

/ iX
/ G((A √ó X ‚ÜíA)Uf)

A /
Œ±
/ GA.
Now notice that the top-right entry of the diagram is exactly GPUf(X), hence the
map i therein deÔ¨Ånes the X-th component of a natural transformation of the desired
form.
‚ñ°
I am now ready to formulate a local existence result for M-types in categories of
coalgebras.
Theorem 5.3.8 Let f: (B, Œ≤)
/ (A, Œ±) be a map of G-coalgebras. If the underlying
map Uf has an M-type in E, then the functor Pf: EG
/ EG has a Ô¨Ånal coalgebra in
EG.
Proof. The natural transformation i of Proposition 5.3.7 allows one to turn any
PUf-coalgebra into a Pf-proto-coalgebra.
In particular, for the M-type œÑ: M =
MUf
/ PUfM in E, one obtains the proto-coalgebra
GM
GœÑ / GPUfM
PfGM,
o
iM
o
whose coreÔ¨Çection Coh(M) = Coh(GœÑ, iM) is Ô¨Ånal in Pf‚àícoalg. To see this, consider
another coalgebra (X, Œ≥) (therefore, X is a G-coalgebra, and Œ≥: X
/ PfX is a G-
coalgebra homomorphism).
To give a morphism of Pf-coalgebras from (X, Œ≥) to
Coh(M) is the same, through I ‚ä£Coh, as giving a map œà: X
/ GM in EG which is
a morphism of Pf-proto-coalgebras, i.e. that makes the following commute:
X
Œ≥
/
œà

PfX
Pfœà

GM
GœÑ
/ GPUfM
PfGM.
o
iM
o
This transposes, through U ‚ä£G, to the following diagram in E, where j is the natural
transformation deÔ¨Åned in (5.10):
UX
UŒ≥ /
bœà

UPfX
jX / PUfUX
PUf bœà

M
œÑ
/ PUfM.
But Ô¨Ånality of M implies that there is precisely one such bœà for any coalgebra (X, Œ≥),
hence Ô¨Ånality is proved.
‚ñ°

96
CHAPTER 5. COINDUCTION IN CATEGORIES
Corollary 5.3.9 If E is a Œ†M-pretopos and G = (G, œµ, Œ¥) is a cartesian comonad on
E, then the category EG of (Eilenberg-Moore) coalgebras for G is again a Œ†M-pretopos.
Remark 5.3.10 Notice that Corollary 5.3.9 could also be deduced by Corollary 5.2.6,
in conjunction with Proposition 5.3.7.
However, analogously to what happens in
the slicing case, Theorem 5.3.8 shows that one does not need to perform the whole
construction, since the coreÔ¨Çection step gives directly the Ô¨Ånal coalgebra.
Remark 5.3.11 In particular, this result shows stability of Œ†M-pretoposes under the
glueing construction, since this is a special case of taking coalgebras for a cartesian
comonad (see [44]).
5.3.3
M-types and presheaves
In this Section, I concern myself with the formation of presheaves for an internal
category in a Œ†M-pretopos. My aim is to show that the resulting category is again
a Œ†M-pretopos.
So consider an internal category C in a Œ†M-pretopos E, with object of objects C0
(see Appendix A for the deÔ¨Ånition of an internal category). By using the fact that the
category of presheaves Psh(C) is the category of coalgebras for a cartesian comonad
on the slice category E/C0 (see for instance [44], Example A.4.2.4 (b)), I get at once
Proposition 5.3.12 The presheaf category Psh(C) is a Œ†M-pretopos.
Unwinding the proof, it is possible to give a concrete description of the M-type in
presheaf categories, along the lines of the description of W-types in [61]. I will just
give the description and leave the veriÔ¨Åcations to the reader.
First of all, I need to introduce the functor |¬∑|: Psh(C)
/ E which takes a presheaf
A to its ‚Äúunderlying set‚Äù |A| = {(a, C) | a ‚ààA(C)}. This is just the composite of
the forgetful functor U: Psh(C)
/ E/C0 with Œ£C0: E/C0
/ E.
Let f: B
/ A be a morphism of presheaves.
Then, the ‚ÄúÔ¨Åbre‚Äù Ba of f over
a ‚ààA(C) for an object C in C is a presheaf, whose action on D is described in the
internal language of E as
Ba(D) = {(Œ≤, b) | Œ≤: D
/ C, a ¬∑ Œ≤ = f(b)}
and restriction along a morphism Œ¥: D‚Ä≤
/ D is deÔ¨Åned as
(Œ≤, b) ¬∑ Œ¥ = (Œ≤Œ¥, b ¬∑ Œ¥).
Now the presheaf morphism f also induces a map
f ‚Ä≤: Œ£(a,C)‚àà|A||Ba|
/ |A|

5.3. CLOSURE PROPERTIES
97
whose Ô¨Åbre over (a, C) is precisely |Ba|. Consider the M-type Mf‚Ä≤ in E: the M-type
M for f in presheaves will be built by selecting the right elements from this M-type.
Elements T ‚ààMf‚Ä≤ are of the form
T = sup(a,C)t,
where (a, C) ‚àà|A| and t: Ba
/ Mf‚Ä≤. Mf‚Ä≤ can be considered as an object in E/C0,
when one maps such a T to C. Write N(C) for the Ô¨Åbre over C ‚ààC0. N actually
possesses the structure of a presheaf, because for any T ‚ààN(C) and Œ±: C‚Ä≤
/ C,
T ¬∑ Œ± = supa‚Ä≤,C‚Ä≤teŒ±,
where a‚Ä≤ = a ¬∑ Œ± and eŒ± is the obvious morphism |Ba‚Ä≤|
/ |Ba|, deÔ¨Åned by sending
(Œ≤, b) to (Œ±Œ≤, b).
Out of this presheaf N, one has to select the coherent elements (the trees called
natural in [60]). Call a tree S composable, when all subtrees T = sup(a,C)t of S satisfy
t(Œ≤, b) ‚ààN(dom(Œ≤)).
Call S coherent or natural, when all subtrees T = sup(a,C)t of S in addition satisfy
that
t(Œ≤, b) ¬∑ Œ≥ = t(Œ≤Œ≥, b ¬∑ Œ≥).
These notions can be deÔ¨Åned using the language of paths. Let M be the subobject of
N consisting of the coherent elements. It is a presheaf, and, as the reader can verify,
the M-type for f in presheaves. So, in eÔ¨Äect, I have proved:
Theorem 5.3.13 Consider a map f: B
/ A in Psh(C). If the induced map f ‚Ä≤ has
an M-type in E, then f has an M-type in Psh(C).
5.3.4
M-types and sheaves
In this Section, I wish to show that Œ†M-pretoposes are closed under taking sheaves.
I approach this question in the following manner: I show that Œ†M-pretoposes are
closed under reÔ¨Çective subcategories with cartesian reÔ¨Çector (by the way, the ques-
tion whether the corresponding result for Œ†W-pretoposes holds, is still open). It is
well-known that in topos theory categories of sheaves are such subcategories of the
category of presheaves. Within a predicative metatheory, the construction of a sheaÔ¨Å-
Ô¨Åcation functor, a cartesian left adjoint for the inclusion of sheaves in presheaves, runs
into some problems. Solutions have been proposed in [61] and [15]. Here, I will sim-
ply assume that this problem can be solved. Then closure of Œ†M-pretoposes under
sheaves follows from closure under reÔ¨Çective subcategories, because I have just shown
that Œ†M-pretoposes are closed under taking presheaves for an internal site.
On cartesian reÔ¨Çectors and the universal closure operators they induce, the reader
should consult [44], Sections A4.3 and A4.4. Very brieÔ¨Çy, the story is like this. A

98
CHAPTER 5. COINDUCTION IN CATEGORIES
category D is a reÔ¨Çective subcategory of a cartesian category E, when the inclu-
sion functor i: D
/ E has a left adjoint L such that Li ‚àº= 1. Now the inclusion is
automatically full and faithful.
When the reÔ¨Çector L is cartesian, as I will always assume, it induces an operator
on the subobject lattice of any object X. The operator sends a subobject
m: X‚Ä≤ /
/ X
to the left side of the pullback square
c(X‚Ä≤)


/ iLX‚Ä≤

iLm

X
Œ∑X / iLX.
This operation is order-preserving, idempotent (c(c(X‚Ä≤)) = c(X‚Ä≤)) and inÔ¨Çationary
(X‚Ä≤ ‚â§c(X‚Ä≤)) and commutes with pullback along arbitrary morphisms. Such opera-
tors are called universal closure operators. In topos theory, every universal closure
operator derives from a cartesian reÔ¨Çector, but in the context of Œ†-pretoposes that is
probably not the case.
The objects in E that come from D can be characterised in terms of the closure
operator c as follows. Call a mono
m: X‚Ä≤ /
/ X
dense, when its closure c(X‚Ä≤) is the maximal object X ‚äÜX. An object Y in E is
from D in case any triangle
X‚Ä≤
f‚Ä≤
/

m

Y
X
f
>
with m a dense mono, can be Ô¨Ålled uniquely by a map f. These objects are, not
accidentally, called the sheaves for the closure operator c. Objects Y for which such
triangles have at most one Ô¨Ålling are called separated with respect to c. Also the
separated objects form a reÔ¨Çective subcategory of E.
It is well-known that in this setting D is a locally cartesian closed pretopos with
a natural number object. Parts of this result, especially that D is an lccc, can be
found in [44] in the aforementioned Sections: I will also need that i preserves the lccc
structure, which can also be found there. The same is true for the separated objects:
they are also an lccc (not a pretopos, though), where the inclusion also preserves the
lccc structure.
Theorem 5.3.14 Let f: B
/ A be a morphism in E.
1. When f is a morphism of separated objects, Mf is separated.

5.3. CLOSURE PROPERTIES
99
2. When f is a morphism of sheaves, Mf is a sheaf.
Proof. I will give the argument for sheaves, but the proof is the same in both cases.
Let M = Mf be the M-type in E associated to f, and obtain the sheaf LM by applying
the reÔ¨Çector to M. The object Pf(LM) is also a sheaf, because the inclusion preserves
the lccc structure. Because of the universal property of L the diagram
M
Œ∑M
/
œÑ

iLM

Pf(M)
Pf(Œ∑M)
/ Pf(iLM) ‚àº= iPf(LM)
can be Ô¨Ålled. Therefore iLM has the structure of Pf-coalgebra in such a way that
Œ∑M is a Pf-coalgebra morphism. By Ô¨Ånality of M, there is a Pf-coalgebra morphism
r: iLM
/ M such that rŒ∑M = 1. So Œ∑MrŒ∑M = Œ∑M = 1Œ∑M and the universal property
of Œ∑M immediately gives that also Œ∑Mr = 1. So M ‚àº= iLM and M is a sheaf.
‚ñ°
Remark 5.3.15 In both cases, it would have been enough to require that the co-
domain of f is a sheaf (respectively separated). This essentially because the sheaves
and separated objects both form exponential ideals in E.
Remark 5.3.16 In case the universal closure operator is not known to derive from a
cartesian reÔ¨Çector, it is still possible to show that the M-type M = Mf for a morphism
f: B
/ A with separated codomain is separated. For that purpose, write x =c x‚Ä≤ for
x, x‚Ä≤ ‚ààX, when (x, x‚Ä≤) ‚ààc(‚àÜ: X
/ X √ó X). An object X is then separated, when
x =c x‚Ä≤ ‚áíx = x‚Ä≤
(see [44], Lemma 4.3.6). To show that M is separated, consider
B = {(supa(t), supa‚Ä≤(t‚Ä≤)) ‚ààM √ó M | supa(t) =c supa‚Ä≤(t‚Ä≤)}.
B has the structure of a Pf-coalgebra in such a way that composing B ‚äÜM √ó M
with either of the two projections yields a Pf-coalgebra morphism. In other words,
B has the structure of a bisimulation on M. This is true, simply because whenever
supa(t) =c supa‚Ä≤(t‚Ä≤), then a =c a‚Ä≤, and hence a = a‚Ä≤, because A is separated. And
because one therefore also has that tb =c t‚Ä≤b for every b ‚ààBa.
But because of Ô¨Ånality of M, all bisimulations on M are contained in the diagonal
of M. Hence
supa(t) =c supa‚Ä≤(t‚Ä≤) ‚áísupa(t) = supa‚Ä≤(t‚Ä≤)
(5.13)
and M is separated.

100
CHAPTER 5. COINDUCTION IN CATEGORIES
Remark 5.3.17 As a corollary, one obtains that the subcategory of separated objects
for a universal closure operator on a Œ†W-pretopos E has W-types. E has M-types by
Corollary 5.2.3, and for morphisms f between separated objects, these M-types are
separated by the preceeding remark. But since W-types are subobjects of M-types (see
Lemma 2.1.4), and separated objects are easily seen to be closed under subobjects,
the W-types associated to such morphisms are separated as well. Another way of
showing this fact is by directly proving (5.13) by induction.
Theorem 5.3.14 now directly shows:
Theorem 5.3.18 If D is a reÔ¨Çective subcategory of a Œ†M-pretopos E with cartesian
reÔ¨Çector, D is also a Œ†M-pretopos.
Corollary 5.3.19 f C is an internal site in a Œ†M-pretopos E such that the inclu-
sion of internal sheaves in presheaves has a cartesian left adjoint (a ‚ÄúsheaÔ¨ÅÔ¨Åcation
functor‚Äù), then the category Sh(C) of internal sheaves for the site C in E is a Œ†M-
pretopos.

Chapter 6
Non-well-founded set theory
Since its Ô¨Årst appearance in the book by Joyal and Moerdijk [47], algebraic set theory
has always claimed the virtue of being able to describe, in a single framework, various
diÔ¨Äerent set theories. However, despite the suggestion in [47] to construct sheaf models
for the theory of non-well-founded set theory in the context of algebraic set theory,
it appears that up until now no one ever tried to put small maps to use in order to
model a set theory with the Anti-Foundation Axiom AFA.
This Chapter, which is joint work with Federico De Marchi, provides a Ô¨Årst step
in this direction. In particular, I build a categorical model of the weak constructive
theory CZF0 of (possibly) non-well-founded sets, studied by Aczel and Rathjen in
[7], extended by AFA. Classically, the universe of non-well-founded sets is known to
be the Ô¨Ånal coalgebra of the powerclass functor [5]. Therefore, it should come as no
surprise that one can build such a model from the Ô¨Ånal coalgebra for the functor Ps
determined by a class of small maps.
Perhaps more surprising is the fact that such a coalgebra always exists. I prove
this by means of a Ô¨Ånal coalgebra theorem, for a certain class of functors on a Ô¨Ånitely
complete and cocomplete category. The intuition that guides one along the argument
is a standard proof of a Ô¨Ånal coalgebra theorem by Aczel [5] for set-based functors on
the category of classes, that preserve inclusions and weak pullbacks. Given one such
functor, he Ô¨Årst considers the coproduct of all small coalgebras, and show that this
is a weakly terminal coalgebra. Then, he quotients by the largest bisimulation on it,
to obtain a Ô¨Ånal coalgebra. The argument works more generally for any functor of
which one knows that there is a generating family of coalgebras, for in that case one
can take the coproduct of that family, and perform the construction as above. The
condition of a functor being set-based assures that one is in such a situation.
My argument is a recasting of the given one in the internal language of a category.
Unfortunately, the technicalities that arise when externalising an argument which is
given in the internal language can be oÔ¨Ä-putting at times. For instance, the external-
isation of internal colimits forces one to work in the context of indexed categories and
indexed functors. Within this context, I say that an indexed functor (which turns
101

102
CHAPTER 6. NON-WELL-FOUNDED SET THEORY
pullbacks into weak pullbacks) is small-based when there is a ‚Äúgenerating family‚Äù of
coalgebras. For such functors I prove an indexed Ô¨Ånal coalgebra theorem. I then
apply this machinery to the case of a Heyting pretopos with a class of small maps,
to show that the functor Ps is small-based and therefore has a Ô¨Ånal coalgebra. As a
byproduct, I am able to build the M-type for any small map f (i.e. the Ô¨Ånal coalgebra
for the polynomial functor Pf associated to f).
For sake of clarity, I have tried to collect as much indexed category theory as I
could in a separate Section. This forms the content of Section 6.1. This should not
aÔ¨Äect readability of Section 6.2, where I prove the Ô¨Ånal coalgebra results. Finally, in
Section 6.3 I prove that the Ô¨Ånal Ps-coalgebra is a model of the theory CZF0+AFA.
The choice to focus on a weak set theory such as CZF0 is deliberate, since stronger
theories can be modelled simply by adding extra requirements for the class of small
maps. For example, one can model the theory CST of Myhill [62] (plus AFA), by
adding the Exponentiation Axiom, or IZF‚àí+AFA by adding the Powerset, Separa-
tion and Collection axioms. And one can force the theory to be classical by working
in a Boolean pretopos. This gives a model of ZF‚àí+AFA, the theory presented in
Aczel‚Äôs book [5], apart from the Axiom of Choice. And, Ô¨Ånally, by adding appropri-
ate axioms, it is possible to build a model of the theory CZF‚àí+AFA, which was
extensively studied by M. Rathjen in [71, 72].
The present results Ô¨Åt in the general picture described in the previous Chapter.1
Recall that there I set myself the task of investigating a non-well-founded analogue to
the established connection between Martin-L¬®of type theory, constructive set theory
and the theory of Œ†W-pretoposes.
In the well-founded picture, W-types in Œ†W-
pretoposes can be used to obtain models for (well-founded) set theories, as explained
in Chapter 4.
The analogy suggests that M-types in Œ†M-pretoposes provide the
means for constructing models for non-well-founded set theories. But in this Chapter,
it will turn out that the M-types in Œ†M-pretoposes are not necessary for that purpose.
This phenomenon resembles the situation in [52], where Lindstr¬®om built a model of
CZF‚àí+AFA out of (intensional) Martin-L¬®of type theory with one universe, without
making any use of M-types.
This Chapter has been submitted for publication.
6.1
Generating objects in indexed categories
As mentioned before, the aim is to prove a Ô¨Ånal coalgebra theorem for a special class
of functors on Ô¨Ånitely complete and cocomplete categories. The proof of such results
will be carried out by repeating in the internal language of such a category C a classical
set-theoretic argument. This forces one to consider C as an indexed category, via its
canonical indexing C, whose Ô¨Åbre over an object X is the slice category C/X. I shall
1Incidentally, I expect that, together with the results on sheaves therein, they should yield an
adequate response to the suggestion by Joyal and Moerdijk.

6.1. GENERATING OBJECTS IN INDEXED CATEGORIES
103
then focus on endofunctors on C which are components over 1 of indexed endofunctors
on C. For such functors, one can prove the existence of an indexed Ô¨Ånal coalgebra,
under suitable assumptions. The component over 1 of this indexed Ô¨Ånal coalgebra
will be the Ô¨Ånal coalgebra of the original C-endofunctor.
Although I apply this result in a rather speciÔ¨Åc context, it turns out that all the
basic machinery needed for the proof can be stated in a more general setting. This
Section collects as much of the indexed category theoretic material as possible, hoping
to make the other Sections easier to follow for a less experienced reader.
I will mostly be concerned with S-cocomplete indexed categories for a cartesian
base category S. The reader should consult Appendix A for the relevant deÔ¨Ånitions.
The notation follows closely that of Johnstone in Chapters B1 and B2 of [44].
The Ô¨Årst step, in the set-theoretic argument to build the Ô¨Ånal coalgebra, is to
identify a ‚Äúgenerating family‚Äù of coalgebras, in the sense that any other coalgebra is
the colimit of all coalgebras in that family mapping to it. When forming the internal
diagram of those coalgebras that map into a given one, say (A, Œ±), I need to select out
of an object of maps to A those which are coalgebra morphisms. In order to consider
such objects of arrows in the internal language, I need to introduce the following
concept:
DeÔ¨Ånition 6.1.1 Let E and A be two objects, respectively in Ô¨Åbres CU and CI of an
S-indexed category C. Whenever it exists, the object Hom(E, A) in S is called the
internal homset from E to A (in S), if it Ô¨Åts into a span
U
Hom(E, A)
s
o
t
/ I
(6.1)
in S and there is a generic arrow Œµ: s‚àóE
/ t‚àóA in CHom(E,A), with the following
universal property: for any other span in S
U
J
x
o
y
/ I
and any arrow œà: x‚àóE
/ y‚àóA in CJ, there is a unique arrow œá: J
/ Hom(E, A) in
S such that sŒæ = x, tœá = y and œá‚àóŒµ ‚àº= œà (via the canonical isomorphisms arising
from the two previous equalities). The object E is called exponentiable, if Hom(E, A)
exists for all A in some Ô¨Åbre of C.
Remark 6.1.2 It follows from the deÔ¨Ånition, via a standard diagram chasing, that
the reindexing along an arrow f: V
/ U in S of an exponentiable object E in CU is
again exponentiable.
Remark 6.1.3 The reader is advised to check that, in case C is a cartesian category
and C is its canonical indexing over itself, the notion of exponentiable object agrees
with the standard one of an exponentiable morphism (see Appendix A).

104
CHAPTER 6. NON-WELL-FOUNDED SET THEORY
Given an exponentiable object E in CU and an object A in CI, the canonical
cocone from E to A is in the internal language the cocone of those morphisms from E
to A. Formally, it is described as the internal diagram (KA, LA), where the internal
category KA and the diagram object LA are deÔ¨Åned as follows. KA
0 is the object
Hom(E, A), with arrows s and t as in (6.1), and KA
1 is the pullback
KA
1
d0
/
x

KA
0
s

Hom(E, E)
t
/ U,
where
U
Hom(E, E)
s
o
t
/ U
is the internal hom of E with itself. In the Ô¨Åbres over Hom(E, A) and Hom(E, E)
one has generic maps Œµ: s‚àóE
/ t‚àóA and Œµ: s‚àóE
/ t
‚àóE, respectively.
The codomain map d0 of KA is the top row of the pullback above, whereas d1 is
induced by the composite
(sx)‚àóE
x‚àóŒµ
‚àí‚àí‚Üí(tx)‚àóE ‚àº= (sd0)‚àóE
d‚àó
0Œµ
‚àí‚àí‚Üí(td0)‚àóA
via the universal property of Hom(E, A) and Œµ.
The internal diagram LA is now the object s‚àóE in CKA
0 , and the arrow from d‚àó
1LA
to d‚àó
0LA is (modulo the coherence isomorphisms) x‚àóŒµ.
When the colimit of the canonical cocone from E to A is A itself, one should
think of A as being generated by the maps from E to it. Therefore, it is natural to
introduce the following terminology.
DeÔ¨Ånition 6.1.4 The object E is called a generating object if, for any A in C = C1,
A = colimKALA.
Later, we shall see how F-coalgebras form an indexed category. Then, a generating
object for this category will provide, in the internal language, a ‚Äúgenerating family‚Äù
of coalgebras. The set-theoretic argument then goes on by taking the coproduct of all
coalgebras in that family. This provides a weakly terminal coalgebra. Categorically,
the argument translates to the following result.
Proposition 6.1.5 Let C be an S-cocomplete S-indexed category with a generating
object E in CU. Then, C = C1 has a weakly terminal object (an object is weakly
terminal if it is satisÔ¨Åes the existence but not necessarily the uniqueness requirement
for a terminal object).

6.1. GENERATING OBJECTS IN INDEXED CATEGORIES
105
Proof. One builds a weakly terminal object in C by taking the internal colimit Q
of the diagram (K, L) in C, where K0 = U, K1 = Hom(E, E) (with domain and
codomain maps s and t, respectively), L = E and the map from d‚àó
0L to d‚àó
1L is
precisely Œµ.
Given an object A = colimKALA in C, notice that the serially commuting diagram
KA
1
d0
/
d1
/
x

KA
0
s

Hom(E, E)
t
/
s
/ U
deÔ¨Ånes an internal functor J: KA
/ K. One has a commuting triangle of internal
S-categories
KA
J
/
 B
B
B
B
B
B
B
B
K

1.
Taking left adjoint along the reindexing functors which this induces on categories of
internal diagrams, one gets that colimKA ‚àº= colimK ‚ó¶LanJ. Hence, to give a map
from A = colimKALA to Q = colimKL it is suÔ¨Écient to give a morphism of internal
diagrams from (K, LanJLA) to (K, L), or, equivalently, from (KA, LA) to (KA, J‚àóL),
but the reader can easily check that these two diagrams are in fact the same.
‚ñ°
Once the coproduct of coalgebras in the ‚Äúgenerating family‚Äù is formed, the set-
theoretic argument is concluded by quotienting it by its largest bisimulation. One
way to build such a bisimulation constructively is to identify a generating family of
bisimulations and then taking their coproduct.
This suggests that to apply Proposition 6.1.5 twice; Ô¨Årst in the indexed category
of coalgebras, in order to obtain a weakly terminal coalgebra (G, Œ≥), and then in the
(indexed) category of bisimulations over (G, Œ≥). To this end, one needs to prove co-
completeness and existence of a generating object for these categories. The language
of inserters allows one to do that in a uniform way.
Instead of giving the general deÔ¨Ånition of an inserter in a 2-category, I will only
describe an inserter explicitly for the 2-category of S-indexed categories.
DeÔ¨Ånition 6.1.6 Given two S-indexed categories C and D and two parallel S-
indexed functors F, G: C
/ D, the inserter I = Ins(F, G) of F and G has as Ô¨Åbre IX
the category whose objects are pairs (A, Œ±) consisting of an object A in CX and an
arrow in DX from F XA to GXA, an arrow œÜ: (A, Œ±)
/ (B, Œ≤) being a map œÜ: A
/ B
in CX such that GX(œÜ)Œ± = Œ≤F X(œÜ).
The reindexing functor for a map f: Y
/ X in S takes an object (A, Œ±) in IX to
the object (f ‚àóA, f ‚àóŒ±), where f ‚àóŒ± has to be read modulo the coherence isomorphisms
of D, but I shall ignore these thoroughly.

106
CHAPTER 6. NON-WELL-FOUNDED SET THEORY
There is an indexed forgetful functor U: Ins(F, G)
/ C which takes a pair (A, Œ±)
to its carrier A; the maps Œ± determine an indexed natural transformation FU
/ GU.
The triple (Ins(F, G), U, FU
/ GU) has a universal property, like any good categor-
ical construction, but it will not be used. The situation is depicted as below:
Ins(F, G)
U
/ C
F
/
G
/ D.
(6.2)
A tedious but otherwise straightforward computation, yields the proof of the fol-
lowing:
Lemma 6.1.7 Given an inserter as in (6.2), if C and D are S-cocomplete and F
preserves indexed colimits, then Ins(F, G) is S-cocomplete and U preserves colimits
(in other words, U creates colimits). In particular, Ins(F, G) has all internal colimits,
and U preserves them.
Example 6.1.8 Here, we shall be concerned with two particular examples of insert-
ers. One is the indexed category F ‚àíCoalg of coalgebras for an indexed endofunctor
F on C, which can be presented as the inserter
Ins(Id, F)
U
/ C
Id
/
F
/ C.
(6.3)
More concretely, (F‚àíCoalg)I = F I‚àícoalg consists of pairs (A, Œ±) where A is an object
and Œ±: A
/ F IA a map in CI, and morphisms from such an (A, Œ±) to a pair (B, Œ≤)
are morphisms œÜ: A
/ B in CI such that F I(œÜ)Œ± = Œ≤œÜ. The reindexing functors are
the obvious ones.
The other inserter we shall encounter is the indexed category Span(M, N) of spans
over two objects M and N in C1 of an indexed category. This is the inserter
Ins(‚àÜ, ‚ü®M, N‚ü©)
U
/ C
‚àÜ
/
‚ü®M,N‚ü©
/ C√óC
(6.4)
Where C√óC is the product of C with itself (which is deÔ¨Åned Ô¨Åbrewise), ‚àÜis the
diagonal functor (also deÔ¨Åned Ô¨Åbrewise), and ‚ü®M, N‚ü©is the pairing of the two constant
indexed functors determined by M and N. By this I mean that an object in C is
mapped to the pair (M, N) and an object in CX is mapped to the pair (X‚àóM, X‚àóN).
Remark 6.1.9 Notice that, in both cases, the forgetful functors preserve S-indexed
colimits in C, hence both F ‚àíCoalg and Span(M, N) are S-cocomplete, and also
internally cocomplete, if C is.
In order to apply Proposition 6.1.5 to these indexed categories, one needs to Ô¨Ånd
generating objects for them. This will be achieved by means of the following two
lemmas.

6.1. GENERATING OBJECTS IN INDEXED CATEGORIES
107
First of all, consider an S-indexed inserter I = Ins(F, G) as in (6.2), such that F
preserves exponentiable objects. Then, given an exponentiable object E in CU, deÔ¨Åne
an arrow U
r‚àí‚ÜíU in S and an object (E, Œµ) in IU, as follows.
Then form the generic map Œµ: s‚àóF UE
/ t‚àóGUE associated to the internal hom of
F UE and GUE (which exists because F preserves exponentiable objects), and then
deÔ¨Åne U as the equaliser of the following diagram
U
e
/ Hom(F UE, GUE)
s
/
t
/ U,
(6.5)
the arrow r: U
/ U being one of the two equal composites se = te.
Put E = r‚àóE and
Œµ = F U(r‚àóE)
‚àº
=
/ e‚àós‚àóF UE
e‚àóŒµ / e‚àót‚àóGUE
‚àº
=
/ GU(r‚àóE).
The pair (E, Œµ) deÔ¨Ånes an object in IU.
Lemma 6.1.10 The object (E, Œµ) is exponentiable in Ins(F, G).
Proof. Consider an object (A, Œ±) in a Ô¨Åbre IX. Then, I deÔ¨Åne the internal hom
Hom((E, Œµ), (A, Œ±)) as follows.
First, I build the internal homset
U
L = Hom(E, A)
s
o
t
/ X
of A and E in C, with generic map œá: s‚àóE
/ t‚àóA. Because F preserves exponentiable
objects, it is also possible to form the internal hom in D
U
Hom(F UE, GXA)
s
o
t
/ X
with generic map œá: s‚àóF UE
/ t
‚àóGXA.
By the universal property of œá, the two
composites in DL
s‚àóF UE
‚àº
=
/ F Ls‚àóE
F Lœá / F L(t‚àóA)
‚àº
=
/ t‚àóF XA
t‚àóŒ±
/ t‚àóGXA
and
s‚àóF UE
s‚àóŒµ
/ s‚àóGUE
‚àº
=
/ GLs‚àóE
GLœá / GLt‚àóA
‚àº
=
/ t‚àóGXA
give rise to two maps p1, p2: L
/ Hom(F UE, GXA) in S, whose equaliser i: M
/ L
has as domain the internal hom Hom((E, Œµ), (A, Œ±)).
The generic map (si)‚àó(E, Œµ)
/ (ti)‚àó(A, Œ±) in IM associated to this internal hom
forms the central square of the following diagram, and this commutes because its

108
CHAPTER 6. NON-WELL-FOUNDED SET THEORY
outer sides are the reindexing along the maps p1i = p2i of the generic map œá above:
(si)‚àóF UE
(si)‚àóŒµ
/
‚àº
=

(si)‚àóGUE
‚àº
=

F M(si)‚àóE
(si)‚àó(E,Œµ)
/
F Mi‚àóœá

GM(si)‚àóE
GMi‚àóœá

F M(ti)‚àóA
(ti)‚àó(A,Œ±)
/
‚àº
=

GM(ti)‚àóA
‚àº
=

(ti)‚àóF XA
(ti)‚àóŒ±
/ (ti)‚àóGXA.
The veriÔ¨Åcation of its universal property is a lengthy but straightforward exercise. ‚ñ°
Next, I Ô¨Ånd a criterion for the exponentiable object (E, Œµ) to be generating.
Lemma 6.1.11 Consider an inserter of S-indexed categories as in (6.2), where C
and D are S-cocomplete, and F preserves S-indexed colimits. If (E, Œµ) is an exponen-
tiable object in IU and for any (A, Œ±) in I1 the equation
colimK(A,Œ±)UL(A,Œ±) ‚àº= U(A, Œ±) = A
holds, where (K(A,Œ±), L(A,Œ±)) is the canonical cocone from (E, Œµ) to (A, Œ±), then (E, Œµ)
is generating in Ins(F, G).
Proof. Recall from Lemma 6.1.7 that Ins(F, G) is internally cocomplete and the for-
getful functor U: Ins(F, G)
/ C preserves internal colimits. Therefore, given an arbi-
trary object (A, Œ±) in I1, one can always form the colimit (B, Œ≤) = colimK(A,Œ±)L(A,Œ±).
All I need to show is that (B, Œ≤) ‚àº= (A, Œ±). The isomorphism between B and A exists
because, by the assumption,
B = U(B, Œ≤) = UcolimK(A,Œ±)L(A,Œ±) ‚àº= colimK(A,Œ±)UL(A,Œ±) ‚àº= A.
Now, it is not too hard to show that the transpose of the composite
colimK(A,Œ±)F UU UL(A,Œ±) ‚àº= FUcolimK(A,Œ±)L(A,Œ±)
Œ≤‚àí‚ÜíGUcolimK(A,Œ±)L(A,Œ±)
is (modulo isomorphisms preserved through the adjunction colimK(A,Œ±) ‚ä£K(A,Œ±)‚àó) the
transpose of Œ±. Hence, Œ≤ ‚àº= Œ± and I am done.
‚ñ°
As an example, I show the following result about the indexed category of spans:
Proposition 6.1.12 Given an S-cocomplete indexed category C and two objects M
and N in C1, if C has a generating object, then so does the indexed category of spans
P = Span(M, N).

6.2. FINAL COALGEBRA THEOREMS
109
Proof.
Recall from Example 6.1.8 that the functor U: Span(M, N)
/ C creates
indexed and internal colimits.
If E in CU is a generating object for C, then, by
Lemma 6.1.10 one can build an exponentiable object
(E, Œµ) = M
E
Œµ1
o
Œµ2
/ N
in PU. I am now going to prove that Span(M, N) meets the requirements of Lemma
6.1.11 to show that E is a generating object.
To this end, consider a span
(A, Œ±) = M
A
Œ±1
o
Œ±2 / N
in P1. Then, I can form the canonical cocone (K(A,Œ±), L(A,Œ±)) from (E, Œµ) to (A, Œ±)
in Span(M, N), and the canonical cocone (KA, LA) from E to A in C. The map
r: U
/ U of (6.5) induces an internal functor u: K(A,Œ±)
/ KA, which is an isomor-
phism.
Therefore, the induced reindexing functor u‚àó: CKA
/ CK(A,Œ±) between the
categories of internal diagrams in C is also an isomorphism, and hence colimK(A,Œ±)u‚àó‚àº=
colimKA. Moreover, it is easily checked that u‚àóLA = UL(A,Œ±). Therefore, one has
colimK(A,Œ±)UL(A,Œ±) ‚àº= colimK(A,Œ±)u‚àóLA ‚àº= colimKALA ‚àº= A
and this Ô¨Ånishes the proof.
‚ñ°
6.2
Final coalgebra theorems
In this Section, I am going to use the machinery of Section 6.1 in order to prove an
indexed Ô¨Ånal coalgebra theorem. I then give an axiomatisation for class of small maps,
which is a bit diÔ¨Äerent from the one studied in Chapter 4, for a Heyting pretopos
with an (indexed) natural number object, and apply the theorem in order to derive
existence of Ô¨Ånal coalgebras for various functors in this context. In more detail, I
shall show that every small map has an M-type, and that the functor Ps has a Ô¨Ånal
coalgebra.
6.2.1
An indexed Ô¨Ånal coalgebra theorem
In this Section, C is a category with Ô¨Ånite limits and stable Ô¨Ånite colimits (that is,
its canonical indexing C is a C-cocomplete C-indexed category), and F is an indexed
endofunctor over it (I shall write F for F 1).
Recall from Remark 6.1.9 that the
indexed category F ‚àíCoalg is C-cocomplete (and the indexed forgetful functor U
preserves indexed colimits).

110
CHAPTER 6. NON-WELL-FOUNDED SET THEORY
I say that F is small-based whenever there is an exponentiable object (E, Œµ) in F U‚àí
coalg such that, for any other F-coalgebra (A, Œ±), the canonical cocone (K(A,Œ±), L(A,Œ±))
from (E, Œµ) to (A, Œ±) has the property that
colimK(A,Œ±)UL(A,Œ±) ‚àº= U(A, Œ±) = A.
(6.6)
It is immediate from Example 6.1.8 and Lemma 6.1.11 that, whenever there is
a pair (E, Œµ) making F small-based, this is automatically a generating object in
F ‚àíCoalg. I shall make an implicit use of this generating object in the proof of:
Theorem 6.2.1 Let F be a small-based indexed endofunctor on a category C as
above. If F 1 takes pullbacks to weak pullbacks, then F has an indexed Ô¨Ånal coalgebra.
Before giving a proof, I need to introduce a little technical lemma. A weak pullback
is a square that is satisÔ¨Åes the existence requirement for pullbacks (but not necessarily
the uniqueness requirement).
Lemma 6.2.2 If F = F 1 turns pullbacks into weak pullbacks, then every pair of
arrows
(A, Œ±)
œÜ
/ (C, Œ≥)
(B, Œ≤)
œà
o
can be completed to a commutative square by the arrows
(A, Œ±)
(P, œá)
¬µ
o
ŒΩ
/ (B, Œ≤)
in such a way that the underlying square in C is a pullback. Moreover, if œà is a
coequaliser in C, then so is ¬µ.
Proof. Build P as the pullback of œà and œÜ in C = C1. Then, since F turns pullbacks
into weak pullbacks, there is a map œá: P
/ FP, making both ¬µ and ŒΩ into coalge-
bra morphisms. The second statement follows at once by the assumption that Ô¨Ånite
colimits in C are stable.
‚ñ°
Proof of Theorem 6.2.1. Because F ‚àíCoalg is C-cocomplete, it is enough, by
Lemma A.19, to show that the Ô¨Åbre over 1 of this indexed category admits a terminal
object.
Given that (E, Œµ) is a generating object in F ‚àíCoalg, Proposition 6.1.5 implies the
existence of a weakly terminal F-coalgebra (G, Œ≥). The classical argument now goes
on taking the quotient of (G, Œ≥) by the maximal bisimulation on it, in order to obtain
a terminal coalgebra.
I do that as follows.
Let B = Span((G, Œ≥), (G, Œ≥)) be the
indexed category of spans over (G, Œ≥), i.e. bisimulations. Then, by Remark 6.1.9, B
is a C-cocomplete C-indexed category, and by Proposition 6.1.12 it has a generating

6.2. FINAL COALGEBRA THEOREMS
111
object. Applying again Proposition 6.1.5, I get a weakly terminal span (i.e. a weakly
terminal bisimulation)
(G, Œ≥)
(B, Œ≤)
Œª
o
œÅ
/ (G, Œ≥).
I now want to prove that the coequaliser
(B, Œ≤)
Œª
/
œÅ
/ (G, Œ≥)
q
/ (T, œÑ)
is a terminal F-coalgebra.
It is obvious that (T, œÑ) is weakly terminal, since (G, Œ≥) is. On the other hand, suppose
(A, Œ±) is an F-coalgebra and f, g: (A, Œ±)
/ (T, œÑ) are two coalgebra morphisms; then,
by Lemma 6.2.2, the pullback s (resp. t) in C of q along f (resp. g) is a coequaliser
in C, which carries the structure of a coalgebra morphism into (A, Œ±). One further
application of Lemma 6.2.2 to s and t yields a commutative square in F ‚àícoalg
(P, œÄ)
s‚Ä≤
/
t‚Ä≤

‚Ä¢
t

‚Ä¢
s
/ (A, Œ±)
whose underlying square in C is a pullback. Furthermore, the composite d = ts‚Ä≤ = st‚Ä≤
is a regular epi in C, hence an epimorphism in F ‚àícoalg.
Write es (resp. et) for the composite of t‚Ä≤ (resp. s‚Ä≤) with the projection of the pullback
of f (resp. g) and q to G. Then, the triple ((P, œÄ), es,et) is a span over (G, Œ≥); hence,
there is a morphism of spans
œá: ((P, œÄ), es,et)
/ ((B, Œ≤), Œª, œÅ).
It is now easy to compute that fd = qŒªœá = qœÅœá = gd, hence f = g, and the proof is
complete.
‚ñ°
As a particular instance of Theorem 6.2.1, one can recover the classical result from
Aczel [5, p. 87].
Corollary 6.2.3 (Final Coalgebra Theorem) Any standard functor (on the cat-
egory of classes) that preserves weak pullbacks has a Ô¨Ånal coalgebra.
Proof. First of all, notice that preservation of weak pullbacks is equivalent to our
requirement that pullbacks are mapped to weak pullbacks. Moreover, the category
of classes has Ô¨Ånite limits and stable Ô¨Ånite colimits. As an exponentiable object, take
the class U of all small coalgebras.
Now, consider a standard functor F on classes (in Aczel‚Äôs terminology). This can
easily be seen as an indexed endofunctor, since for any two classes X and I, one has

112
CHAPTER 6. NON-WELL-FOUNDED SET THEORY
X/I ‚àº= XI (so, the action of F can be deÔ¨Åned componentwise). It is now suÔ¨Écient to
observe that every F-coalgebra is the union of its small subcoalgebras, therefore the
functor is small-based in our sense.
‚ñ°
Remark 6.2.4 With a bit of eÔ¨Äort, the reader can see in the present proof of The-
orem 6.2.1 an abstract categorical reformulation of the classical argument given by
Aczel in his book [5]. In order for that to work, he had to assume that the functor
preserves weak pullbacks (and so did I, in my reformulation). Later, in a joint paper
with Nax Mendler [6], they gave a diÔ¨Äerent construction of Ô¨Ånal coalgebras, which
allowed them to drop this assumption. A translation of that argument in my set-
ting, would reveal that the construction relies heavily on the exactness properties of
the ambient category of classes. Since the functors in the following examples always
preserve weak pullbacks, I prefer sticking to the original version of the result (thus
making weaker assumptions on the category C), without bothering the reader with a
(presently unnecessary) second version, which, however, I believe can be proved.
More recently, the work of Ad¬¥amek et al. [8] has shown that every endofunctor on
the category of classes is small-based, thereby proving that it has a Ô¨Ånal coalgebra
(by Aczel and Mendler‚Äôs result).
Their proof makes a heavy use of set theoretic
machinery, which would be interesting to analyse in the present setting.
6.2.2
Small maps
I am now going to consider on C a class of small maps. This will allow us to show
that certain polynomial functors, as well as the powerclass functor, are small-based,
and therefore we will be able to apply Theorem 6.2.1 to obtain a Ô¨Ånal coalgebra for
them.
From now on, C will denote a Heyting pretopos with an (indexed) natural number
object. Recall that such categories have all Ô¨Ånite colimits, and these are stable under
pullback (see Lemma A.12).
As I explained in Chapter 4, there are various axiomatisations for a class of small
maps, starting with that of Joyal and Moerdijk in [47]. In this Chapter, I will follow
the formulation of Awodey et al. [9] and Awodey and Warren [10]. A comparison
with the original approach by Joyal and Moerdijk and the approach in Chapter 4,
will appear in Remark 6.2.5 below.
A class S of arrows in C is called a class of small maps if it satisÔ¨Åes the following
axioms:
(S1) S is closed under composition and identities;

6.2. FINAL COALGEBRA THEOREMS
113
(S2) if in a pullback square
A
/
g

B
f

C
/ D
f ‚ààS, then g ‚ààS;
(S3) for every object C in C, the diagonal ‚àÜC: C
/ C√óC is in S;
(S4) given an epi e: C
/ D and a commutative triangle
C
e
/ /
f
&
D
g
x
A,
if f is in S, then so is g;
(S5) if f: C
/ A and g: D
/ A are in S, then so is their copairing
[f, g]: C + D
/ A.
I have chosen labels that were also used in Chapter 4, but I do not think this will
lead to any confusion.
An arrow in S will be called small, and objects X will be called small in case
the unique arrow X
/ 1 is small. A small subobject R of an object A is a subobject
R /
/A in which R is small. A small relation between objects A and B is a subobject
R /
/A√óB such that its composite with the projection on A is small (notice that
this does not mean that R is a small subobject of A√óB).
On a class of small maps, I also require representability of small relations by means
of a powerclass object:
(P1) for any object C in C there is an object Ps(C) and a natural correspondence
between maps I
/ Ps(C) and small relations between I and C.
In particular, the identity on Ps(C) determines a small relation ‚ààC‚äÜPs(C)√óC. One
should think of Ps(C) as the object of all small subobjects of C; the relation ‚ààC then
becomes the membership relation between elements of C and small subobjects of C.
The association C 7‚ÜíPs(C) deÔ¨Ånes a covariant functor (in fact, a monad) on C. I
further require the two following axioms:
(I) The natural number object N is small;

114
CHAPTER 6. NON-WELL-FOUNDED SET THEORY
(R) There exists a universal small map œÄ: E
/ U in C, such that any other small
map f: A
/ B Ô¨Åts in a diagram
A
f

‚Ä¢
o

/ E
œÄ

B
‚Ä¢
/
q
oo
U
where both squares are pullbacks and q is epi.
It can now be proved that a class S satisfying these axioms induces a class of
small maps on each slice C/C. Moreover, the reindexing functor along a small map
f: C
/ D has a right adjoint Œ†f: C/C
/ C/D. In particular, it follows that all small
maps are exponentiable in C (see [10]).
Remark 6.2.5 The axioms that I have chosen for the class of small maps subsume
all of the Joyal-Moerdijk axioms in [47, pp. 6‚Äì8], except for the collection axiom (A7).
In particular, the Descent Axiom (A3) can be seen to follow from axioms (S1) ‚àí(S5)
and (P1).
Conversely, the axioms of Joyal and Moerdijk imply all of the present axioms
except for (S3) and (I). The results in Section 6.3 will imply that, by adding these
axioms, a model of the weak set theory CZF0 can be obtained in the setting of [47].
The axioms given here are in a similar manner incomparable in strength with
the axioms in Chapter 4. A class of small maps as deÔ¨Åned here need not satisfy the
axioms called (F4) and (F5) in the statement of Lemma 4.2.5, while a (representable)
class of small maps in the sense of Chapter 4 need not satisfy (S3) and (S4).
6.2.3
Final coalgebras in categories with small maps
From now on, I shall consider on C a class of small maps S. Using their properties, I
am able to prove the existence of the M-type for every small map f: D
/ C, as well
as the existence of a Ô¨Ånal Ps-coalgebra.
Recall that a polynomial functor Pf induced by an exponentiable map f: D
/ C
in a cartesian category C is indexed, see Theorem 2.1.3. In fact, it can be presented
as the composite Pf = Œ£CŒ†fD‚àóof three indexed functors preserving pullbacks. It
is therefore also immediate that Pf preserves pullbacks. Of course, the indexed M-
type of f is the indexed Ô¨Ånal coalgebra of Pf (if necessary, see Appendix A for the
deÔ¨Ånition of an indexed Ô¨Ånal coalgebra).
Theorem 6.2.6 If f: D
/ C is a small map in C, then f has an (indexed) M-type.
Proof. In order to obtain an (indexed) Ô¨Ånal Pf-coalgebra, I want to apply Theorem
6.2.1, and for this, what remains to be checked is that Pf is small-based. To this end,

6.2. FINAL COALGEBRA THEOREMS
115
I Ô¨Årst need to Ô¨Ånd an exponentiable coalgebra (E, Œµ), and then to verify condition
(6.6).
The universal small map œÄ: E
/ U in C is exponentiable, as I noticed after the
presentation of axiom (R). Hence, unwinding the construction preceding Lemma
6.1.10, I obtain an exponentiable object in Pf‚àíCoalg. Using the internal language of
C, I can describe (E, Œµ) as follows.
The object U on which E lives is described as
U = {(u ‚ààU, t: Eu
/ Pf(Eu))},
and E is now deÔ¨Åned as
E = {(u ‚ààU, t: Eu
/ Pf(Eu), e ‚ààEu)}.
The coalgebra structure Œµ: E
/ P U
f E takes a triple (u, t, e) (with te = (c, r)) to the
pair (c, s: Dc
/ E), where the map s takes an element d ‚ààDc to the triple (u, t, r(d)).
Given a coalgebra (A, Œ±), the canonical cocone from (E, Œµ) to it takes the following
form. The internal category K(A,Œ±) is given by
K(A,Œ±)
0
=
{(u ‚ààU, t: Eu ‚ÜíPf(Eu), m: Eu ‚ÜíA) | Pf(m)t = Œ±m};
K(A,Œ±)
1
=
{(u, t, m, u‚Ä≤, t‚Ä≤, m‚Ä≤, œÜ: Eu ‚ÜíEu‚Ä≤) | (u, t, m), (u‚Ä≤, t‚Ä≤, m‚Ä≤) ‚ààK(A,Œ±)
0
,
t‚Ä≤œÜ = Pf(œÜ)t and m‚Ä≤œÜ = m}.
(Notice that, in writing the formulas above, I have used the functor Pf in the internal
language of C; I can safely do that because the functor is indexed. I shall implicitly
follow the same reasoning in the proof of Theorem 6.3.4 below, in order to build an
(indexed) Ô¨Ånal Ps-coalgebra.)
The diagram L(A,Œ±) is speciÔ¨Åed by a coalgebra over K(A,Œ±)
0
, but for my purposes I only
need to consider its carrier, which is
UL(A,Œ±) = {(u, t, m, e) | (u, t, m) ‚ààK(A,Œ±)
0
and e ‚ààEu}.
Condition (6.6) says that the colimit of this internal diagram in C is A, but this is
implied by the conjunction of the two following statements, which I am now going to
prove:
1. For all a ‚ààA there exists (u, t, m, e) ‚ààUL(A,Œ±) such that me = a;
2. If (u0, t0, m0, e0) and (u1, t1, m1, e1) are elements of UL(A,Œ±) such that m0e0 =
m1e1, then there exist (u, t, m, e) ‚ààUL(A,Œ±) and coalgebra maps œÜi: Eu
/ Eui
(i = 0, 1) such that miœÜi = m and œÜie = ei.
Condition 2 is trivial: given (u0, t0, m0, e0) and (u1, t1, m1, e1), Lemma 6.2.2 allows
one to Ô¨Åll a square
(P, Œ≥)
/

(Eu0, t0)
m0

(Eu1, t1)
m1
/ (A, Œ±),

116
CHAPTER 6. NON-WELL-FOUNDED SET THEORY
in such a way that the underlying square in C is a pullback (hence, P is a small object).
Therefore, (P, Œ≥) is isomorphic to a coalgebra (Eu, t), and, under this isomorphism,
the span
(Eu0, t0)
(P, Œ≥)
o
/ (Eu1, t1)
takes the form
(Eu0, t0)
(Eu, t)
œÜ0
o
œÜ1 / (Eu1, t1).
Moreover, since m0e0 = m1e1, there is an e ‚ààEu such that œÜie = ei. Then, deÔ¨Åning
m as any of the two composites miœÜi, the element (u, t, m, e) in UL(A,Œ±) satisÔ¨Åes the
desired conditions.
As for condition 1, Ô¨Åx an element a ‚ààA.
One can build a subobject ‚ü®a‚ü©of A
inductively, as follows:
‚ü®a‚ü©0
=
{a};
‚ü®a‚ü©n+1
=
[
a‚Ä≤‚àà‚ü®a‚ü©n
t(Dc) where Œ±a‚Ä≤ = (c, t: Dc
/ A).
Then, each ‚ü®a‚ü©n is a small object, because it is a small-indexed union of small objects.
For the same reason (since, by axiom (I), N is a small object) their union ‚ü®a‚ü©=
S
n‚ààN‚ü®a‚ü©n is small, and it is a subobject of A. It is not hard to see that the coalgebra
structure Œ± induces a coalgebra Œ±‚Ä≤ on ‚ü®a‚ü©(in fact, ‚ü®a‚ü©is the smallest subcoalgebra of
(A, Œ±) containing a, i.e. the subcoalgebra generated by a), and, up to isomorphism,
this is a coalgebra t: Eu
/ PfEu, with embedding m: Eu
/ A. Via the isomorphism
Eu ‚àº= ‚ü®a‚ü©, the element a becomes an element e ‚ààEu such that me = a. Hence, one
gets the desired 4-tuple (u, t, m, e) in UL(A,Œ±).
This concludes the proof of the theorem.
‚ñ°
Theorem 6.2.7 The powerclass functor Ps has an (indexed) Ô¨Ånal coalgebra.
Proof. It is easy to check that Ps is the component on 1 of an indexed functor, and
that it maps pullbacks to weak pullbacks.
Therefore, once again, I just need to verify that Ps is small-based. I proceed exactly
like in the proof of Theorem 6.2.6 above, except for the construction of the coalgebra
(‚ü®a‚ü©, Œ±‚Ä≤) generated by an element a ‚ààA in 1. Given a Ps-coalgebra (A, Œ±), I construct
the subcoalgebra of (A, Œ±) generated by a as follows. First, I deÔ¨Åne inductively the
subobjects
‚ü®a‚ü©0
=
{a};
‚ü®a‚ü©n+1
=
[
a‚Ä≤‚àà‚ü®a‚ü©n
Œ±(a‚Ä≤).
Each ‚ü®a‚ü©n is a small object, and so is their union ‚ü®a‚ü©= S
n‚ààN‚ü®a‚ü©n. The coalgebra
structure Œ±‚Ä≤ is again induced by restriction of Œ± on ‚ü®a‚ü©.
‚ñ°

6.3. THE FINAL PS-COALGEBRA AS A MODEL OF AFA
117
6.3
The Ô¨Ånal Ps-coalgebra as a model of AFA
The standing assumption in this Section is that C is a Heyting pretopos with an
(indexed) natural number object and a class S of small maps. In the last Section, I
proved that in this case the Ps-functor has a Ô¨Ånal coalgebra in C. Now I will explain
how this Ô¨Ånal coalgebra can be used to model various set theories with the Anti-
Foundation Axiom. First I work out the case for the weak constructive theory CZF0,
and then indicate how the same method can be applied to obtain models for stronger,
better known or classical set theories.
The presentation of CZF0 follows that of Aczel and Rathjen in [7]; the same theory
appears under the name BCST* in the work of Awodey and Warren in [10]. It is a
Ô¨Årst-order theory whose underlying logic is intuitionistic; its non-logical symbols are
a binary relation symbol œµ and a constant œâ, to be thought of as membership and
the set of (von Neumann) natural numbers, respectively. Two more symbols will be
added for sake of readability, as I proceed to state the axioms. Notice that, as in
Chapter 4, in order to make a distinction between the membership relation of the set
theory and that induced by the powerclass functor, I shall denote the former by œµ and
the latter by ‚àà.
The conventions of Chapter 4 are assumed to be in place. In particular, I use the
following abbreviations:
‚àÉxœµa (. . .)
: =
‚àÉx (xœµa ‚àß. . .),
‚àÄxœµa (. . .)
: =
‚àÄx (xœµa ‚Üí. . .).
The axioms for CZF0 are (the universal closures) of the following statements:
(Extensionality) ‚àÄx (xœµa ‚Üîxœµb) ‚Üía = b
(Pairing) ‚àÉy ‚àÄx (xœµy ‚Üî(x = a ‚à®x = b))
(Union) ‚àÉy ‚àÄx(xœµy ‚Üî‚àÉz (xœµz ‚àßzœµa))
(Emptyset) ‚àÉy ‚àÄx (xœµy ‚Üî‚ä•)
(Intersection) ‚àÉy ‚àÄx (xœµy ‚Üî(xœµa ‚àßxœµb))
(Replacement) ‚àÄxœµa ‚àÉ!y œÜ ‚Üí‚àÉb ‚àÄy (yœµb ‚Üî‚àÉxœµ a œÜ)
Two more axioms will be added, but before I do so, I want to point out that all
instances of ‚àÜ0-separation follow from these axioms, i.e. one can deduce all instances
of
(‚àÜ0-Separation) ‚àÉy ‚àÄx (xœµy ‚Üî(xœµa ‚àßœÜ(x)))

118
CHAPTER 6. NON-WELL-FOUNDED SET THEORY
where œÜ is a formula in which y does not occur and all quantiÔ¨Åers are bounded.
Furthermore, in view of the above axioms, I can introduce a new constant ‚àÖto denote
the empty set, and a function symbol s which maps a set x to its ‚Äúsuccessor‚Äù x‚à™{x}.
This allows one to formulate concisely our last axioms:
(InÔ¨Ånity-1) ‚àÖœµœâ ‚àß‚àÄxœµœâ (sxœµœâ)
(InÔ¨Ånity-2) œà(‚àÖ) ‚àß‚àÄxœµœâ (œà(x) ‚Üíœà(sx)) ‚Üí‚àÄxœµœâ œà(x).
It is an old observation by Rieger that models for set theory can be obtained as
Ô¨Åxpoints for the powerclass functor (see [76]). The same is true in the context of
algebraic set theory (see, [19] for a similar result):
Theorem 6.3.1 Every Ps-Ô¨Åxpoint in C provides a model of CZF0.
Proof. Suppose there is a Ô¨Åxpoint E: V
/ PsV , with inverse I. Call y the name
of a small subobject A ‚äÜV , when E(y) is its corresponding element in Ps(V ). One
interprets the formula xœµy as an abbreviation of the statement x ‚ààE(y) in the internal
language of C. Then, the veriÔ¨Åcation of the axioms for CZF0 goes as follows.
Extensionality holds because two small subobjects E(x) and E(y) of V are equal if
and only if, in the internal language of C, z ‚ààE(x) ‚Üîz ‚ààE(y). The pairing of
two elements x and y represented by two arrows 1
/ V , is given by I(l), where l
is the name of the (small) image of their copairing [x, y]: 1 + 1
/ V . The union
of the sets contained in a set x is interpreted by applying the multiplication of the
monad Ps to (PsE)(E(x)). The intersection of two elements x and y in V is given by
I(E(x) ‚à©E(y)), where the intersection is taken in Ps(V ). The least subobject 0 ‚äÜV
is small, and its name ‚àÖ: 1
/ V models the empty set.
For the Replacement axiom, consider a, and suppose that for every xœµa there exists
a unique y such that œÜ. Then, the subobject {y | ‚àÉxœµa œÜ} of V is covered by E(a),
hence small. Applying I to its name, one obtains the image of œÜ.
Finally, the InÔ¨Ånity axioms follow from the axiom (I). The morphism ‚àÖ: 1
/ V to-
gether with the map s: V
/ V which takes an element x to x‚à™{x}, yields a morphism
Œ±: N
/ V . Since N is small, so is the image of Œ±, as a subobject of V , and applying I
to its name one gets an œâ in V which validates the axioms InÔ¨Ånity-1 and InÔ¨Ånity-2. ‚ñ°
This theorem shows that every Ô¨Åxpoint for the functor Ps models a very basic set
theory. Now, by demanding further properties of the Ô¨Åxpoint, one can deduce the
validity of more axioms. For example, in [47], it is shown how the initial Ps-algebra
(which is a Ô¨Åxpoint, after all) models the Axiom of Foundation. Here, I show that a
Ô¨Ånal Ps-coalgebra satisÔ¨Åes the Anti-Foundation Axiom. To formulate this axiom, I
deÔ¨Åne the following notions. A (directed) graph consists of a pair of sets (n, e) such
that n ‚äÜe √ó e. A colouring of such a graph is a function c assigning to every node
xœµn a set c(x) such that
c(x) = {c(y) | (x, y)œµe}.

6.3. THE FINAL PS-COALGEBRA AS A MODEL OF AFA
119
This can be formulated solely in terms of œµ using the standard encoding of pairs and
functions. In ordinary set theory (with classical logic and the Foundation Axiom),
the only graphs that have a colouring are well-founded trees and these colourings are
then necessarily unique.
The Anti-Foundation Axiom says:
(AFA) Every graph has a unique colouring.
Proposition 6.3.2 If C has an (indexed) Ô¨Ånal Ps-coalgebra, then this is a model for
the theory CZF0+AFA.
Proof. I clearly have to check just AFA, since any Ô¨Ånal coalgebra is a Ô¨Åxpoint. To
this end, note Ô¨Årst of all that, because (V, E) is an indexed Ô¨Ånal coalgebra, one can
think of it as a Ô¨Ånal Ps-coalgebra in the internal logic of C.
So, suppose one has a graph (n, e) in V . Then, n (internally) has the structure of a
Ps-coalgebra ŒΩ: n
/ Psn, by sending a node x œµ n to the (small) set of nodes y œµ n
such that (x, y)œµe. The colouring of n is now given by the unique Ps-coalgebra map
Œ≥: n
/ V .
‚ñ°
By Theorem 6.2.7, it then follows at once:
Corollary 6.3.3 Every Heyting pretopos with a natural number object and class of
small maps contains a model of CZF0+AFA.
This result can be extended to theories stronger than CZF0. For example, to the
set theory CST introduced by Myhill in [62]. This theory is closely related to (in
fact, intertranslatable with) CZF0+Exp, where Exp is (the universal closure of) the
following axiom.
(Exponentiation) ‚àÉt (fœµt ‚ÜîFun(f, x, y))
Here, the predicate Fun(f, x, y) expresses the fact that f is a function from x
to y, and it can be formally written as the conjunction of ‚àÄaœµx ‚àÉ!bœµy (a, b)œµf and
‚àÄzœµf ‚àÉaœµx, bœµy (z = (a, b)).
Theorem 6.3.4 Assume the class S of small maps also satisÔ¨Åes
(E) The functor Œ†f preserves small maps for any f in S.
Then, C contains a model of CST+AFA.

120
CHAPTER 6. NON-WELL-FOUNDED SET THEORY
Proof. We already saw how the Ô¨Ånal Ps-coalgebra (V, E) models CZF0+AFA. Now,
(E) implies that AB is small, if A and B are, so, E(y)E(x) is always small. This gives
rise to a small subobject of V , by considering the image of the morphism that sends
a function f ‚ààE(y)E(x) to the element in V representing its graph. The image under
I of the name of this small object is the desired exponential t.
‚ñ°
Another example of a stronger theory which can be obtained by imposing further
axioms for small maps is provided by IZF‚àí, which is intuitionistic ZF without the
Foundation Axiom. It is obtained by adding to CZF0 the following axioms:
(Powerset) ‚àÉy ‚àÄx(xœµy ‚Üî‚àÄzœµx(zœµa))
(Full Separation) ‚àÉy ‚àÄx(xœµy ‚Üî(xœµa ‚àßœÜ(x)))
(Collection) ‚àÄxœµa ‚àÉy œÜ(x, y) ‚Üí‚àÉb ‚àÄxœµa ‚àÉyœµb œÜ(x, y)
(In Full Separation, y is not allowed to occur in œÜ.)
By now, the proof of the following theorem should be routine (if not, the reader
should consult [19]):
Theorem 6.3.5 Assume the class of small maps S also satisÔ¨Åes
(P2) if X
/ B belongs to S, then so does Ps(X
/ B);
(M) every monomorphism is small;
(C) for any two arrows p: Y
/ X and f: X
/ A where p is epi and f belongs to
S, there exists a quasi-pullback square of the form
Z
g

/ Y
p / / X
f

B
h
/ / A
where h is epi and g belongs to S.
Then, C contains a model of IZF‚àí+AFA.
Corollary 6.3.6 If the pretopos C is Boolean, then classical logic is also true in the
model, which will therefore validate ZF‚àí+AFA, Zermelo-Fraenkel set theory with
Anti-Foundation instead of Foundation.
Finally, one can build a model for a non-well-founded version of Aczel‚Äôs set theory
CZF, discussed in Chapter 4. The set theory CZF‚àí+AFA is obtained by dropping
Set Induction and replacing it by AFA, and was studied by M. Rathjen in [71, 72].
It is obtained by adding to CZF0 the axiom AFA, as well as the following:

6.3. THE FINAL PS-COALGEBRA AS A MODEL OF AFA
121
(Strong Collection) ‚àÄxœµa ‚àÉy œÜ(x, y) ‚Üí‚àÉb B(xœµa, yœµb) œÜ(x, y)
(Subset Collection) ‚àÉc ‚àÄz (‚àÄxœµa ‚àÉyœµb œÜ(x, y, z) ‚Üí‚àÉdœµc B(xœµa, yœµd) œÜ(x, y, z)
Here B(xœµa, yœµb) œÜ abbreviates:
‚àÄxœµa ‚àÉyœµb œÜ ‚àß‚àÄyœµb ‚àÉxœµa œÜ.
In order for a class of small maps to give a model Subset Collection, the class has to
satisfy a rather involved axiom that will be called (F). In order to formulate it, I need
to introduce some notation. For two morphisms A
/ X and B
/ X, MX(A, B) will
denote the poset of multi-valued functions from A to B over X, i.e. jointly monic spans
in C/X,
A
P
oo
/ B
with P
/ X small and the map to A epic. By pullback, any f: Y
/ X determines
an order preserving function
f ‚àó: MX(A, B)
/ MY (f ‚àóA, f ‚àóB).
Theorem 6.3.7 Assume the class of small maps S also satisÔ¨Åes (C) as in Theorem
6.3.5, and the following axiom:
(F) for any two small maps A
/ X and B
/ X, there exist an epi p: X‚Ä≤
/ X, a
small map f: C
/ X‚Ä≤ and an element P ‚ààMC(f ‚àóp‚àóA, f ‚àóp‚àóB), such that for
any g: D
/ X‚Ä≤ and Q ‚ààMD(g‚àóp‚àóA, g‚àóp‚àóB), there are morphisms x: E
/ D
and y: E
/ C, with gx = fy and x epi, such that x‚àóQ ‚â•y‚àóP.
Then, C contains a model of CZF‚àí+AFA.
Proof. Any Ô¨Åxpoint for Ps will model Strong Collection in virtue of property (C) of
the class of small maps.
Because of (F) the Ô¨Åxpoint will also model the axiom called Fullness in Chapter 4.
But Fullness is equivalent to Subset Collection over CZF0 and Strong Collection (see
[7]).
‚ñ°
To illustrate that these are not empty theorems, I wish to conclude this Chapter
by presenting several cases to which they can be applied. Following [47], one can Ô¨Ånd
several examples of categories endowed with classes of small maps satisfying some
of the discussed axioms. I cannot study them in detail, but I would at least like to
present them brieÔ¨Çy. For a more complete treatment, the reader is advised to look
at [47]. A thorough study of the properties of the resulting models is the subject for
future research.
The most obvious example is clearly the category of classes, where the notion of
smallness is precisely that of a class function having as Ô¨Åbres just sets. This satisÔ¨Åes

122
CHAPTER 6. NON-WELL-FOUNDED SET THEORY
all the presented axioms. Along the same lines, one can consider the category of sets,
where the class of small maps consists of those functions whose Ô¨Åbres have cardinality
at most Œ∫, for a Ô¨Åxed inÔ¨Ånite regular cardinal Œ∫. This satisÔ¨Åes axioms (S1-5), (P1),
(I), (R), (M) and (C), but not (E). However, if Œ∫ is also inaccessible, then (E) is
satisÔ¨Åed, as well as (P2) and (F).
Consider the topos Sh(C) of sheaves over a site C, with pullbacks and a sub-
canonical topology. Then, for an inÔ¨Ånite regular cardinal Œ∫ greater than the number
of arrows in C, deÔ¨Åne the notion of smallness (relative to Œ∫) following [47], Chap-
ter IV.3. This satisÔ¨Åes the axioms (S1-5), (P1), (I) and (R). Moreover, if Œ∫ is
inaccessible, it satisÔ¨Åes also (P2), (M), (C).
Finally, on the eÔ¨Äective topos Eff one can deÔ¨Åne a class of small maps in at least
two diÔ¨Äerent ways. For the Ô¨Årst, consider the global section functor Œì: Eff
/ Sets,
and Ô¨Åx a regular cardinal Œ∫. Then, say that a map f: X
/ Y is small if it Ô¨Åts in a
quasi-pullback
P
/ /
g

X
f

Q
/ / Y
where P and Q are projectives and Œì(g) is Œ∫-small in Sets. With this deÔ¨Ånition, the
class of small maps satisÔ¨Åes all the basic axioms (S1-5), (P1), (I) and (R), as well
as (C) and (M). If Œ∫ is inaccessible, it also satisÔ¨Åes (P2).
Alternatively, one can take the class of small maps in Eff investigated in Chapter
4. This notion of smallness satisÔ¨Åes all the axioms apart from (P2).

Appendix A
Categorical background
This Appendix is meant to provide the prospective reader of this thesis with suÔ¨Écient
categorical background (or to refresh his, resp. her, memory). An excellent source on
these matters is the Ô¨Årst volume of Johnstone‚Äôs Elephant [44].
Cartesian categories A.1
A category C is called cartesian if it possesses all Ô¨Ånite
limits. A functor between cartesian categories is called cartesian if it preserves Ô¨Ånite
limits.
Practically all categories in this thesis are cartesian. Slightly better categories are
regular.
Regular categories A.2
There are several equivalent ways of deÔ¨Åning regular
categories. From a logical point of view, regular categories are cartesian categories
in which one can interpret the existential quantiÔ¨Åer. In any cartesian category, a
morphism f: Y
/ X induces a functor f ‚àó: Sub X
/ Sub Y , by pullback. In regular
categories, such functors f ‚àóhave left adjoints ‚àÉf. Applying ‚àÉf to the maximal sub-
object Y ‚äÜY , one obtains the image of f: a subobject X ‚äÜA is called the image
of a map f: Y
/ X in a category C, when it is the least subobject through which
f factors. A morphism f: Y
/ X having as image the maximal subobject X ‚äÜX
is called a cover. As one can see, the notions of image and cover make sense in any
category and will be used frequently in this thesis.
The notion of a regular category can now be deÔ¨Åned as follows. A cartesian category
C is called regular if every map in C factors, in a stable fashion, as a cover followed
by a monomorphism. A cartesian functor between regular categories is called regular
if it preserves covers.
For us, the most important fact about regular categories is the following result due
to Joyal:
Lemma A.3 In a regular category covers and regular epimorphism, i.e.
epimor-
phisms that arise as coequalisers, coincide.
123

124
APPENDIX A. CATEGORICAL BACKGROUND
To interpret full Ô¨Årst-order intuitionistic logic, regular categories have to be equipped
with more structure.
In fact, a regular category C needs to satisfy the following
two conditions to interpret disjunction and the universal quantiÔ¨Åer (and implication)
respectively:
‚Ä¢ The subobject lattice Sub X of any object X in C has Ô¨Ånite unions, preserved
by the operation f ‚àófor any f: Y
/ X.
‚Ä¢ For any morphism f: Y
/ X, the functor f ‚àó: Sub X
/ Sub Y has a right ad-
joint ‚àÄf.
When these are satisÔ¨Åed, the category C is called a Heyting category.
Lemma A.4 Let R ‚äÜA √ó B be a relation from A to B in a Heyting category C.
R is the graph of a (necessarily unique) morphism A
/ B in C, if and only if the
following two statements
‚àÄa ‚ààA ‚àÉb ‚ààB R(a, b)
‚àÄa ‚ààA ‚àÄb, b‚Ä≤ ‚ààB (R(a, b) ‚àßR(a, b‚Ä≤) ‚Üíb = b‚Ä≤)
are valid in the internal logic of C.
Relations R as in the lemma are called functional.
Even better than regular categories are exact categories, also called eÔ¨Äective reg-
ular categories (in [44], for example).
Exact categories A.5
The idea behind exact categories is that equivalence rela-
tions have ‚Äúgood‚Äù quotients. I will say in an instant what I mean by a good quotient,
but Ô¨Årst I have to deÔ¨Åne what I mean by an equivalence relation in a categorical
context.
DeÔ¨Ånition A.6 Two parallel arrows
R
r0
/
r1
/ X
in category C form an equivalence relation when for any object A in C the induced
function
Hom(A, R)
/ Hom(A, X)2
is an injection deÔ¨Åning an equivalence relation on the set Hom(A, X). A morphism
q: X
/ Q is called the quotient of the equivalence relation, if the diagram
R
r0
/
r1
/ X
q
/ Q

125
is both a pullback and a coequaliser. In this case, the diagram is called exact. The
diagram is called stably exact, when for any p: P
/ Q the diagram
p‚àóR
p‚àór0 /
p‚àór1
/ p‚àóX
p‚àóq / p‚àóQ
is also exact.
A regular category C is now called exact, when any equivalence relation Ô¨Åts into a
stably exact diagram.
A functor between exact categories is called exact, if it is
regular.
Among exact categories, pretoposes are of special interest. To identify these, one
needs the following deÔ¨Ånition.
DeÔ¨Ånition A.7 A cartesian category C has Ô¨Ånite disjoint, stable sums, when it has
an initial object 0 (the empty sum) and for any two objects A and B a binary sum
A + B that is disjoint in the sense that
0
/

A

B
/ A + B
is a pullback, and stable in the sense that for all maps A
/ X, B
/ X and Y
/ X,
the canonical map Y √óX A + Y √óX B
/ Y √óX (A + B) is an isomorphism.
A pretopos is an exact category with Ô¨Ånite disjoint, stable sums. On pretoposes there
is the following important result, that will frequently be used.
Lemma A.8 In a pretopos, every epimorphism Ô¨Åts into a stably exact diagram. Put
diÔ¨Äerently, every epimorphism is the coequaliser of its kernel pair.
In particular,
epimorphisms, regular epimorphisms and covers coincide.
Because of the sums, disjunction can be interpreted in a pretopos, but it does
not necessarily have the structure to interpret universal quantiÔ¨Åcation.
A preto-
pos C is therefore called Heyting, if for any morphism f: Y
/ X in C the functor
f ‚àó: Sub X
/ Sub Y induced by pullback, has a right adjoint Œ†f. So Heyting preto-
poses are exact Heyting categories.
Lcccs A.9
Lccc is an abbreviation for ‚Äúlocally cartesian closed category‚Äù.
The
quickest way to deÔ¨Åne an lccc is by Ô¨Årst observing that for any morphism f: Y
/ X
in a cartesian category C, pulling back along f determines a functor f ‚àó: C/X
/ C/Y .
Such functors always have a left adjoint Œ£f given by composition with f, but when
they also have right adjoints, the category C is an lccc. One also sometimes says that
C has dependent products.
This deÔ¨Ånition is the quickest, but it is not the one I will use most often. However,
to state the other equivalent deÔ¨Ånitions, I Ô¨Årst need to recall the deÔ¨Ånitions of an
exponential and a cartesian closed category.

126
APPENDIX A. CATEGORICAL BACKGROUND
DeÔ¨Ånition A.10 In a category C with products, an object Z is the exponential of
two objects A and B, if it is equipped with an evaluation morphism œµ: Z √ó A
/ B
such that for any morphism f: X √ó A
/ B there is a unique morphism f: X
/ Z
such that
X √ó A
f√ó1 /
f
%K
K
K
K
K
K
K
K
K
K
K
Z √ó A
œµ

B
commutes. In this case Z is often written as BA. An object A in C is called expo-
nentiable, if BA exists for any object B. A map f: X
/ Y is called exponentiable, if
it is exponentiable as an object of C/Y . A category C with products in which every
object is exponentiable, is called cartesian closed.
When an object A in a category C with products is exponentiable, the association
(‚àí)A: B 7‚ÜíBA is functorial. In fact, it is right adjoint to the functor (‚àí) √ó A: B 7‚Üí
B √ó A. Therefore, lcccs are certainly cartesian closed.
A cartesian category C is now locally cartesian closed, when it satisÔ¨Åes any of the
following equivalent conditions:
1. All pullback functors f ‚àó: C/X
/ C/Y for a map f: Y
/ X have a right adjoint
Œ†f.
2. Any morphism f: Y
/ X is exponentiable.
3. Any slice category of C is cartesian closed.
The existence of the right adjoints Œ†f has a number of consequences. For example,
since pullback functors are now also left adjoints, they preserve all colimits. This
means in particular that in an lccc, sums are always stable.
Furthermore, because Œ†f as a right adjoint preserves monos, right adjoints to the op-
eration of pulling back subobjects along an arbitrary map exist in an lccc. Therefore
universal quantiÔ¨Åers can be interpreted. This means that a locally cartesian closed
regular category with disjoint sums is a Heyting category. In particular, locally carte-
sian closed pretoposes, or Œ†-pretoposes as I will frequently call them, are Heyting
pretoposes.
Algebras and coalgebras A.11
The setting is that of a category C equipped with
an endofunctor T: C
/ C. A category of T-algebras can then be deÔ¨Åned as follows.
Objects are pairs consisting of an object X together with a morphism x: TX
/ X in
C. A morphism from (X, x: TX
/ X) to (Y, y: TY
/ Y ) is a morphism p: X
/ Y
in C such that
TX
Tp /
x

TY
y

X
p
/ Y

127
commutes.
I will frequently be interested in the initial object in this category, whenever it exists.
This initial object (I, i) is then called the initial or free T-algebra. As the name free
T-algebra suggests, the idea is that the structure of I has been freely generated so
as to make it a T-structure. Very often, at least in the cases I am interested in, I
has been generated by an inductive deÔ¨Ånition. Its initiality is then a consequence
of the recursive property such an inductively deÔ¨Åned object automatically possesses.
In fact, the language of initial algebras is the right categorical language for studying
inductively deÔ¨Åned structures.
For example, in case C is a Œ†-pretopos, consider the endofunctor T on C sending an
object X to 1 + X. Then T-algebras are morphisms x: 1 + X
/ X, or equivalently
pairs of morphisms (x0: 1
/ X, x1: X
/ X), usually depicted as:
1
x0 / X
x1 / X.
Morphisms of T-algebras are then commuting diagrams like:
1
=

x0 / X
p

x1
/ X
p

1
y0 / Y
y1
/ Y.
The initial T-algebra is called the natural number object (nno) in X and is usually
depicted as:
1
0
/ N
s
/ N.
It is easy to see that in the category of sets, this is precisely the set of natural
numbers with zero and successor, and to verify this fact one uses precisely the fact
that functions can be (uniquely) deÔ¨Åned by recursion on the natural numbers. One
sees that the language of initial algebras allows us to make sense of the notion of the
natural numbers in more general categories.
In case C is just a cartesian category, an indexed version of the above is more useful.
An indexed natural number object in a cartesian category C is an object N equipped
with the following structure
1
0
/ N
s
/ N,
such that for any (parameter) object P and any arrows f: P
/ Y and t: P √óY
/ Y ,
there is a unique f: P √ó N
/ Y for which the diagram
P √ó 1
‚àº
=

1√ó0 / P √ó N
(œÄ1,f)

1√ós / P √ó N
f

P
(1,f)
/ P √ó Y
t
/ Y
commutes. When C is cartesian closed, it is suÔ¨Écient to check this for P = 1 and the
diÔ¨Äerence between the two deÔ¨Ånitions disappears.
The following lemma is a result that illustrates the usefulness of an (indexed) nno.

128
APPENDIX A. CATEGORICAL BACKGROUND
Lemma A.12 A pretopos C with an indexed nno is cocartesian, i.e. it has all Ô¨Ånite
colimits and these are stable.
Initial algebras have special properties: they are well-founded Ô¨Åxpoints.
In some
cases, this characterises them completely, but that is not always the case.
DeÔ¨Ånition A.13 Let C be a category equipped with an endofunctor T: C
/ C. A
Ô¨Åxpoint is an object X together with an isomorphism TX ‚àº= X.
Fixpoints can always be regarded as T-algebras, and on the other hand one has the
following elementary, but very useful, result by Lambek (see [50]):
Lemma A.14 An initial T-algebra is a Ô¨Åxpoint.
DeÔ¨Ånition A.15 Let C be a category equipped with an endofunctor T: C
/ C. A
T-algebra X together with a morphism f to a T-algebra Y is called a T-subalgebra of
Y , when the underlying map of f in C is a monomorphism. A T-algebra Y is called
well-founded, when in all its T-subalgebras f: X
/ Y , f is an isomorphism.
Instead of saying ‚ÄúX is well-founded‚Äù, one also says that ‚ÄúX has no proper subalge-
bras‚Äù. It is a trivial observation that initial algebras are always well-founded.
Where algebras form the right categorical language to study inductively deÔ¨Åned struc-
tures, coalgebras are the right categorical language to study phenomena like coinduc-
tion and bisimulation, with which I will also be concerned.
The setting is again
that of a category C equipped with an endofunctor T: C
/ C and the category of
T-coalgebras is deÔ¨Åned dually to that of the category of T-algebras. So objects are
pairs consisting of an object X together with a morphism x: X
/ TX in C, and a
morphism p: X
/ Y in C is a morphism of T-coalgebras from (X, x: X
/ TX) to
(Y, y: Y
/ TY ), when (Tp)x = yp. The terminal object in this category, when it
exists, is called the Ô¨Ånal or cofree T-coalgebra. Some results on initial algebras simply
carry over by duality to Ô¨Ånal coalgebras, in particular Lambek‚Äôs result that they are
Ô¨Åxpoints.
Indexed categories A.16
Algebras and coalgebras can also be deÔ¨Åned in an in-
dexed setting. For more on indexed categories, see again the Elephant [44], whose
notational conventions I will follow.
An indexed category C is deÔ¨Åned by giving for every object I in a Ô¨Åxed category
S, the base of the indexed category, a category CI. Furthermore, there should be
so-called reindexing functors x‚àó: CI
/ CJ for every x: J
/ I in S. Finally, for any
two composable arrows x: J
/ I and y: K
/ J in S, the functors (xy)‚àóand y‚àóx‚àóare
required to be naturally isomorphic, and (idI)‚àóis supposed to be naturally isomorphic
to the identity on CI. The natural isomorphisms, which are part of the data of an
indexed category, are in turn demanded to satisfy a number of coherence conditions,
which I shall not state here.

129
An indexed terminal object is given by a family of objects TI, one for every I in
S, such that TI is Ô¨Ånal in every category CI, and for every x: J
/ I, x‚àóTI ‚àº= TJ.
The deÔ¨Ånition of an indexed initial object is similar. In case the base category S
has a terminal object 1, an indexed terminal object is given by the following data: a
terminal object T in C1, whose reindexings I‚àóT are still Ô¨Ånal for every I = I
/ 1 in
S.
An indexed functor F: C
/ D for two categories indexed over the same base category
S is given by a family of functors F I: CI
/ DI, one for every object I in S. These
functors are given together with natural isomorphisms for every x: J
/ I that Ô¨Åll
the squares
CI
F I

x‚àó
/ CJ
F J

DI
x‚àó/ DJ.
I will again omit the coherence conditions that these natural isomorphisms need to
satisfy.
For an indexed endofunctor F on an indexed category C, one can deÔ¨Åne a new indexed
category: the indexed category F‚àíAlg of F-algebras. For any I in S, its Ô¨Åbre (F‚àíAlg)I
is the category of F I-algebras in the category CI, and the reindexing functors are
deÔ¨Åned in the obvious way. By an indexed initial algebra, one means an indexed
initial object in this indexed category. These are automatically indexed well-founded
Ô¨Åxpoints: by this, I mean a family of algebras AI, one for every I in S, such that
each AI is a well-founded Ô¨Åxpoint for F I in CI.
For any cartesian category C, there is the canonical indexing of C over itself. The
Ô¨Åbre CI for any I in C is the slice C/I, while x‚àóis deÔ¨Åned by pullback. Remark that
C1 is really just C. By an indexed endofunctor on a cartesian category C, one means
an endofunctor that is indexed with respect to the canonical indexing of C over itself.
In this case, (F ‚àíAlg)1 is also just the ordinary category of F-algebras on C.
When F has an indexed initial algebra, this means that F has an ordinary initial
algebra A, with the additional property that for every object I in S, I‚àóA is initial in
(F‚àíAlg)I. These are also indexed well-founded Ô¨Åxpoints, that is, A is a well-founded
Ô¨Åxpoint for F, and so are all its reindexings. Indexed natural number objects are
examples of such indexed initial algebras.
The deÔ¨Ånitions of an indexed category of coalgebras for an indexed endofunctor on
an indexed category, and an indexed Ô¨Ånal coalgebra, should now be obvious.
Internal categories and colimits A.17
Suppose S is a cartesian category. An
internal category K in S consists of a diagram
K1
d1 /
d0
/ K0,

130
APPENDIX A. CATEGORICAL BACKGROUND
where d1 is the domain map, d0 is the codomain one, and they have a common left
inverse i. Furthermore there is a composition. If K2 is the object of composable
arrows, i.e. the object
K2
p1
/
p0

K1
d1

K1
d0
/ K0,
there is a morphism c: K2
/ K1 such that d1c = d1p0 and d0c = d0p1. Composition
behaves well with respect to identities: c‚ü®id, id0‚ü©= id and c‚ü®id1, id‚ü©= id. Finally,
composition is associative: if one forms the limit of
K1
d0
!B
B
B
B
B
B
B
B
K1
d1
}||||||||
d0
!C
C
C
C
C
C
C
C
K1
}{{{{{{{{
K0
K0,
then two possible composites K3
/ K2
/ K1 are equal. There is also a notion of
internal functor between internal categories, and this gives rise to the category of
internal categories in S (see Section B2.3 of [44] for the details).
An internal diagram L of shape K in an S-indexed category C consists of an internal
S-category K, an object L in CK0, and a map d‚àó
1L
/ d‚àó
0L in CK1 which interacts
properly with the categorical structure of K. Moreover, one can consider the notion
of a morphism of internal diagrams, and these data deÔ¨Åne the category CK of internal
diagrams of shape K in C.
An indexed functor F: C
/ D induces an ordinary functor F K: CK
/ DK between
the corresponding categories of internal diagrams of shape K. Dually, given an internal
functor F: K
/ J, this (contravariantly) determines by reindexing of C an ordinary
functor on the corresponding categories of internal diagrams: F ‚àó: CJ
/ CK. One
says that C has internal left Kan extensions if these reindexing functors have left
adjoints, denoted by LanF. In the particular case where J = 1, the trivial internal
category with one object, I write K‚àó: C
/ CK for the functor, and colimK for its left
adjoint LanK, and colimKL is called the internal colimit of L.
Furthermore, suppose C and D are S-indexed categories with internal colimits of
shape K. Then, one says that an S-indexed functor F: C
/ D preserves colimits if
the canonical natural transformation Ô¨Ålling the square
CK
colimK

F K / DK
colimK

C
F
/ D
is an isomorphism.

131
Indexed cocomplete categories A.18
A S-indexed category C is called S-co-
complete, in case every Ô¨Åbre is Ô¨Ånitely cocomplete, Ô¨Ånite colimits are preserved by rein-
dexing functors, and these functors have left adjoints satisfying the Beck-Chevalley
condition. If S has a terminal object, there is the following easy lemma:
Lemma A.19 If the Ô¨Åbre C = C1 of an S-cocomplete S-indexed category C has a
terminal object T, then this is an indexed terminal object, i.e. X‚àóT is terminal in CX
for all X in S.
From Proposition B2.3.20 in [44] it follows that:
Lemma A.20 If C is an S-cocomplete S-indexed category, then it has colimits of
internal diagrams and left Kan extensions along internal functors in S. Moreover, if
an indexed functor F: C
/ D between S-cocomplete categories preserves S-indexed
colimits, then it also preserves internal colimits.
The next result is pointed out in Chapter 6 (Remark 6.1.9):
Lemma A.21 If F is an indexed functor on a S-cocomplete indexed category C, the
indexed category F ‚àíCoalg of F-coalgebras is again S-cocomplete, and the indexed
forgetful functor U: F ‚àíCoalg
/ C preserves colimits (in other words, U creates
colimits).


Appendix B
Type theory
This Appendix is meant as a brief introduction to Martin-L¬®of type theory. Although
the relevance of the theory of Œ†W-pretoposes to type theory is not what will be
pursued in this thesis (it is applications to set theory that will be worked out), type
theory is ‚Äúideologically‚Äù important. It is certainly arguable, but in my opinion Martin-
L¬®of type theory is the paradigmatic constructive-predicative theory. It is not the
absence of the Law of Excluded Middle or the powerset axiom that vindicates the
constructive and predicative status of the set theory CZF, but its interpretation in
type theory. In the same vein I feel that the example of a Œ†W-pretopos deÔ¨Ånable from
type theory, proves that a Œ†W-pretopos is a constructive and predicative structure
(this example is discussed in the Chapter 2 of this thesis). For this reason I think it
is important to introduce Martin-L¬®of type theory. But I should say right away that I
realise that what I tell here can in no way compete with the book-length expositions
by the experts (see [57] and [63], and also [64]).
There is immediately one complication: there exist diÔ¨Äerent versions of this the-
ory, extensional and intensional, polymorphic and monomorphic. Following [63], I
have made the choice to introduce the polymorphic version, which I feel is easier to
motivate, but I am not unaware of the advantages of the monomorphic version (for
that, see [64]). Comments on these issues I have relegated to the footnotes. For the
polymorphic version, I will discuss both the intensional and extensional versions.
Per Martin-L¬®of created the type theory that bears his name in order to clarify
constructive mathematics. And, in fact, I believe that it is as an attempt to analyse
the practice of the constructive mathematician that it can best be introduced.
An exposition of type theory should be preceeded by a discussion of Martin-L¬®of‚Äôs
theory of expressions. I wish to treat this issue very quickly, referring to Chapter 3
of [63] for more details. The expression
y + sin y
is analysed as the application of a binary operation + to a variable y and an expression
consisting of the unary function sin applied to that same variable y. Using brackets
133

134
APPENDIX B. TYPE THEORY
for application, this expression should be written as:
+(y, sin(y)).
In the expression
Z x
1
y + sin y dy
the variable y is considered to be a dummy. Nothing depends essentially on it being
y, rather than z or Œ±. For that reason, the integral
R
is thought of as working on an
expression, the integrand y + sin y, in which y does not occur freely, but has rather
been abstracted away. This abstraction is denoted by
(y) + (y, sin(y)).
Certain expressions involving application and abstraction are considered equal (deÔ¨Å-
nitionally equal, denoted by ‚â°), like:
((x) e)(x) ‚â°e,
or
(x) b ‚â°(y) b‚Ä≤
if b‚Ä≤ is b, with all free occurences of y replaced by x. In fact, as explained in [63],
application and abstraction satisfy the rules of the typed lambda calculus (with the
Œ±, Œ≤ and Œ∑-rule).
After the development of the theory of expressions, the Ô¨Årst step in the analysis
of mathematics is that all the expressions (terms, like constants, variables etc.) are
always of a certain type. A mathematician who, in the course of an argument, intro-
duces a certain variable x never assumes that x is just an arbitrary set, but always
assumes that x is a mathematical object of a particular kind, like a natural number,
a 2 by 2 matrix, an element of a group etc. These mathematical kinds are called types
and a basic assumption in type theory is that all mathematical objects are always
presupposed to be of a certain type. That x is of type A is usually abbreviated as
x ‚ààA and that A is a type as A Type, the fact that A and A‚Ä≤ are equal types as
A = A‚Ä≤. An additional aspect in the analysis is that mathematical objects can only be
compared as elements of the same type. In type theory, it makes no sense to wonder
whether x, which is of type natural number, and y, which is of type 2 by 2 matrix,
are identical or not identical. More controversially perhaps, the question whether the
real number 2 is the same as the integer 2 is regarded as ill-posed. When a and b are
equal objects of type A, this is written as a = b ‚ààA. I have now enumerated all the
judgement forms, which are
A Type
A = A‚Ä≤
a ‚ààA
a = b ‚ààA.
These are the kind of statements that are recognised in Martin-L¬®of type theory.

135
Types have structure and the next two steps analyse this structure. The second
step is the recognition of dependent types: types can depend on the value of a term x
of another type. An example is Rn, which is a type dependent on the value of n ‚ààN.
Another example is from category theory, where the homset
Hom(A, B)
depends on the values of A and B of type ‚Äúobject in the category C‚Äù. The recognition
of dependent types is the main cause of the technical diÔ¨Éculty of the theory.
A third step is the recognition of type constructors. There are ways of building
new types from old types. For example, when œÉ and œÑ are types, there is the type
œÉ √ó œÑ
of pairs whose Ô¨Årst element is of type œÉ and second element is of type œÑ. For example,
one could form the type N √ó N of pairs of natural numbers. In this example, √ó is the
type constructor, but there are also type constructors acting on dependent types, as
in the next example. When B(a) is a type dependent on a ‚ààA, there is the type
Œ£a ‚ààA. B(a)
of pairs (a, b) where a ‚ààA and b ‚ààB(a). In set theory, one usually writes something
like `
a‚ààA Ba. This allows one to build the type
Œ£n ‚ààN. Rn
which is the type of Ô¨Ånite sequences of reals together with their length.
In the Ô¨Ånal (fourth) step, there is the rÀÜole of contexts. In the course of an argument,
when the mathematician has introduced all kinds of variables x, y . . . , and she is
reasoning about them, there is always implicit the typing information, which gives
the right types for all the variables she is working with.
In a formal system like
Martin-L¬®of type theory, all these assumptions are required to be made fully explicit.
Therefore judgements like
a ‚ààœÉ
are always made within a context Œì which gives explicitly all the types of the free
variables occurring in a and œÉ. For example, the statement that Rn is a type can only
be made within the context n ‚ààN:
n ‚ààN ‚ä¢Rn Type.
Therefore the statements that are premisses or conclusions in an argument are of the
following shapes:
Œì ‚ä¢A Type
Œì ‚ä¢A = A‚Ä≤
Œì ‚ä¢a ‚ààA
Œì ‚ä¢a = b ‚ààA,

136
APPENDIX B. TYPE THEORY
where Œì is a context.
The general form of a context is the following:
Œì = [a1 ‚ààœÉ1, a2 ‚ààœÉ2(a1), . . . , an ‚ààœÉn(a1, a2, . . . , an‚àí1)],
where the ai are distinct variables of the appropriate types. This includes the empty
context [] for n = 0. The presupposition here is that
a1 ‚ààœÉ1, . . . , ai ‚ààœÉi(a1, . . . ai‚àí1) ‚ä¢œÉi+1(a1, . . . , ai) Type
for all i < n.
A brief remark about these ‚Äúpresuppositions‚Äù: what they amount to in this case
is that Œì can never be a context occurring in a statement, without these presuppo-
sitions having been derived before. Typically in logic, the well-formed statements
are delineated, before formulating rules circumscribing which of those are provable.
Here, both processes occur simultaneously: well-formedness of types, for example, is
a property that has to be derived within the system (this is why there is a judgement
form A Type). This is also why the axiom A = A has as a premiss A Type, because
otherwise it could possibly not be well-formed.
Martin-L¬®of type theory is organized as follows: it is a system like natural deduc-
tion, with two sets of rules. First, there is a basic set of axioms, that essentially
regulates the use of =: it is an equivalence relation allowing substitution. Then there
are the rules for the diÔ¨Äerent type constructors, four for each.
The rules for = are:
a ‚ààA
a = a ‚ààA
a = b ‚ààA
b = a ‚ààA
a = b ‚ààA
b = c ‚ààA
a = c ‚ààA
A Type
A = A
A = B
B = A
A = B
B = C
A = C
a ‚ààA
A = B
a ‚ààB
a = b ‚ààA
A = B
a = b ‚ààB
These rules have to be read with the following convention in mind: when formulating
a rule, the context that is shared by all the premisses and conclusion is omitted. This
means that the Ô¨Årst rule in this list is really:
Œì ‚ä¢a ‚ààA
Œì ‚ä¢a = a ‚ààA
for any context Œì.

137
The substitution rules are as follows:
x ‚ààA ‚ä¢C(x) Type
a ‚ààA
C(a) Type
x ‚ààA ‚ä¢C(x)
a = b ‚ààA
C(a) = C(b)
x ‚ààA ‚ä¢c(x) ‚ààC(x)
a ‚ààA
c(a) ‚ààC(a)
x ‚ààA ‚ä¢c(x) ‚ààC(x)
a = b ‚ààA
c(a) = c(b) ‚ààC(a)
x ‚ààA ‚ä¢C(x) = D(x)
a ‚ààA
C(a) = D(a)
x ‚ààA ‚ä¢c(x) = d(x) ‚ààC
a ‚ààA
c(a) = d(a) ‚ààC
And Ô¨Ånally there is the following assumption rule:
A Type
x ‚ààA ‚ä¢x ‚ààA
The second set of rules consists of four rules for every type constructor. I start
with Œ†. It is analogous to the construction of the set Œ†i‚ààIAi for an indexed family
(Ai)i‚ààI in set theory: it is the set of functions that chooses for each i ‚ààI an element
in the corresponding Ai.
First there is the formation rule:
A Type
x ‚ààA ‚ä¢B Type
Œ†x ‚ààA. B(x) Type
The introduction rule:
x ‚ààA ‚ä¢b(x) ‚ààB(x)
Œª(b) ‚ààŒ†x ‚ààA. B(x).
The elimination rule:
f ‚ààŒ†x ‚ààA. B(x)
a ‚ààA
apply(f, a) ‚ààB(a),
and the equality rule:
x ‚ààA ‚ä¢b(x) ‚ààB(x)
a ‚ààA
apply(Œª(b), a) = b(a) ‚ààB(a).

138
APPENDIX B. TYPE THEORY
In case B does not contain x, one usually writes A ‚ÜíB instead of Œ†x ‚ààA. B(x).
These rules are secretly accompanied by rules for judgemental equality (=) like the
following:
x ‚ààA ‚ä¢b(x) = c(x) ‚ààB(x)
Œª(b) = Œª(c) ‚ààŒ†x ‚ààA. B(x).
But these will be omitted in the sequel.1
The other types are thought of as being inductively generated.2
The general
pattern can be observed from the rules for √ó, the (binary) product type. First, there
is the formation rule:
A Type
B Type
A √ó B Type
The introduction rule is:
a ‚ààA
b ‚ààB
pair(a, b) ‚ààA √ó B.
If one thinks of types as boxes, this rule tells us that there is a canonical way of
putting something into the box A √ó B: take elements a ‚ààA and b ‚ààB and pair
them (elements of the form pair(a, b) are therefore called canonical elements). The
elimination rule expresses that such elements exhaust the product type in the form
of an associated induction principle:
p ‚ààA √ó B
v ‚ààA √ó B ‚ä¢C(v)
x ‚ààA, y ‚ààB ‚ä¢e(x, y) ‚ààC(pair(a,b))
split(p, e) ‚ààC(p).
What this says, in terms of boxes, is that in case I am given a family of boxes C(v)
labelled by elements v in the type A√óB and that I am given a way of putting elements
into boxes for every box labelled by a canonical element (i.e. into C(pair(x, y)) for
every x ‚ààA and y ‚ààB), I have a way of putting elements in every box.
The
associated equality rule says that this way agrees with (extends) the given method
for the canonical elements:
a ‚ààA
b ‚ààB
x ‚ààA, y ‚ààB ‚ä¢e(x, y) ‚ààC(pair(x, y))
split(pair(a, b), e) = e(a, b) ‚ààC(pair(a, b)).
The rules for all the type constructors follow this pattern.
The rules for the
remaining type constructors will be given at the end of this Appendix.
So far any mathematician, even the classical one, may sympathise with the de-
velopment of the theory.
It is by taking the next step that the system becomes
essentially constructive. As one may have the feeling that I have only explained the
set-theoretic part of the system, one may wonder how logic is incorporated in it. This
is done following the propositions-as-types interpretation: a proposition is interpreted
1When the monomorphic version is formulated in terms of a logical framework, as is customary,
it is not necessary to add these rules.
2It is possible to formulate the monomorphic version in such a way that the elements of the
Œ†-types are also inductively generated.

139
as the type of its proofs. The type constructors correspond to the various logical con-
stants and a proposition is considered true, when its corresponding type of proofs is
inhabited, i.e. there is a term of the appropriate type. This in itself might not make
the system constructive, but the type-theoretic understanding of what a proof is,
does. The type-theoretic interpretation (which follows the BHK-interpretation) of a
proof of an existential proposition ‚àÉa ‚ààA. B(a) is as the Œ£-type Œ£a ‚ààA. B(a), which
therefore means that implicit in a proof of this proposition is an a ‚ààA which has
the desired property B(a). Likewise, the Œ†-type interprets the universal quantiÔ¨Åer ‚àÄ.
One can see that the natural deduction rules for ‚àÄare derived rules for the system:
x ‚ààA ‚ä¢B(x) True
‚àÄx ‚ààA. B(x) True
‚àÄx ‚ààA. B(x) True
a ‚ààA
B(a) True.
The √ó-type interprets conjunction ‚àßand the following are also derived rules:
A True
B True
A ‚àßB True
A ‚àßB True
A True
A ‚àßB True
B True.
In order to have a complete translation from Ô¨Årst-order intuitionistic logic into
type theory, one needs to have identity types. In the course of history, two sets of
rules have been formulated, an intensional version Id and an extensional version Eq,
resulting in two diÔ¨Äerent type theories: intensional and a stronger extensional type
theory.3
Id-type (intensional) Intuitive description: set of proofs of an identity statement.
Formation rule
A Type
a ‚ààA
b ‚ààA
Id(A, a, b) Type
Introduction rule
a ‚ààA
r(a) ‚ààId(A, a, a)
Elimination rule
a ‚ààA
b ‚ààA
c ‚ààId(A, a, b)
x ‚ààA, y ‚ààA, z ‚ààId(A, x, y) ‚ä¢C(x, y, z) Type
x ‚ààA ‚ä¢d(x) ‚ààC(x, x, r(x))
J(c, d) ‚ààC(a, b, c)
Equality rule
a ‚ààA
x ‚ààA, y ‚ààA, z ‚ààId(A, x, y) ‚ä¢C(x, y, z) Type
x ‚ààA ‚ä¢d(x) ‚ààC(x, x, r(x))
J(r(a), d) = d(a) ‚ààC(a, a, r(a))
3The extensional identity type does not Ô¨Åt into the monomorphic version of type theory as
formulated in [64].

140
APPENDIX B. TYPE THEORY
Eq-type (extensional) Intuitive description: set of proofs of an identity statement.
Formation rule
A Type
a ‚ààA
b ‚ààA
Eq(A, a, b) Type
Introduction rule
a ‚ààA
r ‚ààEq(A, a, a)
Elimination rule
c ‚ààEq(A, a, b)
a = b ‚ààA
Equality rule
c ‚ààEq(A, a, b)
c = r ‚ààEq(A, a, b)
One can see that the intensional version Ô¨Åts with the philosophy that types are induc-
tively generated sets and therefore with the general pattern, but the extensional ver-
sion is closer to category theory. Another important diÔ¨Äerence is that in type theory
with the extensional identity types, the judgemental equality = and the propositional
equality Eq collapse, thereby making judgmental equality and type checking unde-
cidable, while in a type theory with intensional equality types, the diÔ¨Äerent equalities
are kept apart and judgmental equality and type checking remain decidable.
Also because of this, Martin-L¬®of considers the intensional version the right one,
and although I appreciate the philosophical and computer-scientiÔ¨Åc reasons for this,
the category theorist in me is dismayed, as it makes the categorical properties of the
system much more akward. Also it makes the theory of ML-categories and Œ†W-
pretoposes less relevant to the study of Martin-L¬®of type theory.
From the syntax of type theory, whether intensional or extensional, one can build
a category in the following way. Objects are types (within the empty context) modulo
the judgemental equality =, while morphisms from a type A to a type B are terms of
type A ‚ÜíB, again modulo the equality =. The fact that one so obtains a category,
is entirely trivial.
It is an (extension of a) result by Seely [79] that for extensional type theory
this gives an ML-category.4
It would be very convenient if one could prove that
this was the initial ML-category, but, as people discovered, this overlooks subtle
coherence problems related to substitution. This is connected to the general problem
of interpreting extensional type theories in ML-categories.5
But solutions to the latter problem have been found: one can use the theory
of Ô¨Åbrations, see [36] and [41], or change the type theory by introducing explicit
substitution operators, see [25]. In either way, one can consider ML-categories and
Œ†W-pretoposes as models of extensional type theory.
It is on this fact that the
4But in this connection universes are essential to show that the sums are disjoint. Moreover, an
extension of the type theory with quotient types should yield a Œ†W-pretopos.
5Strictly speaking, a categorical semantics has only been worked out for the monomorphic version.

141
relevance of the theory of ML-categories and Œ†W-pretoposes is based, and this is
what is behind the PER models or œâ-set models of type theory. There are still some
obscurities. For example, what remains unclear to me is to what extend an analysis
of the initial ML-category can throw light on extensional type theory, but this is
manifestly a fruitful approach.
When one turns to intensional type theory, matters become very opaque. If one
performs the same construction as above starting from intensional type theory, the
structure of the category will be much less nice, but it will be something like a weak
Œ†W-pretopos, a notion introduced in Chapter 3. To get a ‚Äúdecent‚Äù category from
intensional type theory, one should perform the setoids construction explained in
Chapter 2. In this way, one obtains a Œ†W-pretopos. The importance of this result is
of ‚Äúideological‚Äù importance in the sense explained at the beginning of this Appendix,
but it does not make clear how Œ†W-pretoposes help to understand intensional type
theory.
I will end by formulating the rules for the remaining type constructors in Martin-
L¬®of type theory.
0-type Intuitive description: the empty set.
Formation rule
0 Type
Introduction rule
None.
Elimination rule
a ‚àà0
x ‚àà0 ‚ä¢C(x) Type
case(a) ‚ààC(a)
Equality rule
None.
1-type Intuitive description: the one-point set.
Formation rule
1 Type
Introduction rule
‚àó‚àà1
Elimination rule
a ‚àà1
x ‚àà1 ‚ä¢C(x) Type
b ‚ààC(‚àó)
case(a, b) ‚ààC(a)
Equality rule
x ‚àà1 ‚ä¢C(x) Type
b ‚ààC(‚àó)
case(‚àó, b) = b ‚ààC(‚àó)

142
APPENDIX B. TYPE THEORY
+-type Intuitive description: disjoint union of two sets.
Formation rule
A Type
B Type
A + B Type
Introduction rules
a ‚ààA
B Type
inl(a) ‚ààA + B
A Type
b ‚ààB
inr(b) ‚ààA + B
Elimination rule
c ‚ààA + B
v ‚ààA + B ‚ä¢C(v) Type
x ‚ààA ‚ä¢d(x) ‚ààC(inl(x))
y ‚ààB ‚ä¢e(y) ‚ààC(inr(y))
when(c, d, e) ‚ààC(c)
Equality rules
a ‚ààA
v ‚ààA + B ‚ä¢C(v) Type
x ‚ààA ‚ä¢d(x) ‚ààC(inl(x))
y ‚ààB ‚ä¢e(y) ‚ààC(inr(y))
when(inl(a), d, e) = d(a) ‚ààC(inl(a))
b ‚ààB
v ‚ààA + B ‚ä¢C(v) Type
x ‚ààA ‚ä¢d(x) ‚ààC(inl(x))
y ‚ààB ‚ä¢e(y) ‚ààC(inr(y))
when(inr(b), d, e) = e(b) ‚ààC(inr(b))
Œ£-type Intuitive description: disjoint union of a family of sets.
Formation rule
A Type
x ‚ààA ‚ä¢B(x) Type
Œ£x ‚ààA. B(x) Type
Introduction rule
a ‚ààA
x ‚ààA ‚ä¢B(x) Type
b ‚ààB(a)
‚ü®a, b‚ü©‚ààŒ£x ‚ààA. B(x)
Elimination rule
c ‚ààŒ£x ‚ààA. B(x)
v ‚ààŒ£x ‚ààA. B(x) ‚ä¢C(v) Type
x ‚ààA, y ‚ààB(x) ‚ä¢d(x, y) ‚ààC(‚ü®x, y‚ü©)
split(c, d) ‚ààC(c)
Equality rule
a ‚ààA
b ‚ààB
v ‚ààŒ£x ‚ààA. B(x) ‚ä¢C(v) Type
x ‚ààA, y ‚ààB(x) ‚ä¢d(x, y) ‚ààC(‚ü®x, y‚ü©)
split(‚ü®a, b‚ü©, d) = d(a, b) ‚ààC(‚ü®a, b‚ü©)

143
W-type Intuitive description: set of well-founded trees with Ô¨Åxed branching type
(see Chapter 2).
Formation rule
A Type
x ‚ààA ‚ä¢B(x) Type
Wx ‚ààA. B(x) Type
Introduction rule
a ‚ààA
t ‚ààB(a) ‚ÜíWx ‚ààA. B(x)
sup(a, t) ‚ààWx ‚ààA. B(x)
Elimination rule
a ‚ààWx ‚ààA. B(x)
v ‚ààWx ‚ààA. B(x) ‚ä¢C(v) Type
y ‚ààA, z ‚ààB(y) ‚ÜíWx ‚ààA. B(x),
u ‚ààŒ†x ‚ààB(y). C(z(x)) ‚ä¢b(y, z, u) ‚ààC(sup(y, z))
wrec(a, b) ‚ààC(a)
Equality rule
d ‚ààA
t ‚ààB(d) ‚ä¢e(t) ‚ààWx ‚ààA. B(x)
v ‚ààWx ‚ààA. B(x) ‚ä¢C(v) Type
y ‚ààA, z ‚ààB(y) ‚ÜíWx ‚ààA. B(x),
u ‚ààŒ†x ‚ààB(y). C(z(x)) ‚ä¢b(y, z, u) ‚ààC(sup(y, z))
wrec(sup(d, e), b) = b(d, e, Œª((t) wrec(e(t), b))) ‚ààC(sup(d, e)


Appendix C
Pcas and realisability
This Appendix brieÔ¨Çy discusses the deÔ¨Ånitions of pcas and realisability toposes. Ref-
erences for pcas are [11] and [35], while on realisability toposes the reader should
consult [40], [39] and [69].
Pcas C.1
Before being able to deÔ¨Åne pcas, I need the notion of a partial applicative
structure. A partial applicative structure Q = (Q, ¬∑) is a set Q equipped with a partial
binary operation (a, b) 7‚Üía ¬∑ b. The partial application ¬∑ is frequently not written
down: one very often writes ab instead of a¬∑b. The usual conventions for working with
partial operation are assumed to be in place. For two expressions œÜ and œà involving
elements of Q and the binary operation ¬∑, one writes œÜ ‚Üìto mean ‚ÄúœÜ is deÔ¨Åned‚Äù,
œÜ = œà to mean ‚ÄúœÜ and œà are deÔ¨Åned and equal‚Äù and œÜ ‚âÉœà to mean ‚Äúwhen œÜ or œà is
deÔ¨Åned, so is the other and they are equal‚Äù. Another convention is that of ‚Äúbracketing
to the left‚Äù: abc should be read as (ab)c.
Given a pca Q and a countable set of fresh variables x0, x1, x2, . . ., the set of terms
T(Q) is the smallest set closed under:
1. a ‚ààT(Q) for all a ‚ààQ,
2. xi ‚ààT(Q) for all i ‚ààN,
3. whenever a, b ‚ààT(Q), then (ab) ‚ààT(Q).
One should think of the elements of T(Q) as the set of polynomials with coeÔ¨Écients
in Q.
A partial combinatory algebra (pca) Q = (Q, ¬∑) is a partial applicative structure that
is combinatory complete, in the sense that for every term t(x0, . . . , xn) ‚ààT(Q) there
is an element q ‚ààQ such that for all a0, . . . , an ‚ààQ:
(i) qa0 . . . an‚àí1 ‚Üìand
(ii) qa0 . . . an ‚âÉt(a0, . . . , an).
As is well-known, to get combinatory completeness it is necessary and suÔ¨Écient to
require the existence of two elements k and s in Q satisfying the following laws:
145

146
APPENDIX C. PCAS AND REALISABILITY
1. kab = a,
2. sab ‚Üì,
3. sabc ‚âÉac(bc).
Actually, pcas are usually deÔ¨Åned in terms of k and s, but since there are in any pca
an indeÔ¨Ånite number of ks and ss having these properties, the deÔ¨Ånition in this form
is less canonical. And combinatory completeness is where pcas are all about.
The important facts about pcas, from my point of view, are the following.
Due
to combinatory completeness, elements in a pca may be denoted by lambda terms,
like Œªx0, . . . , xn.t(x0, . . . , xn). This is a bit tricky, since pcas are not models of the
lambda calculus, as there may be no good interpretation of lambda terms containing
free variables (see [11]).
But, like in the lambda calculus, one can solve Ô¨Åxpoint
equations, there is a choice of Church numerals in any pca (which will usually be
denoted by the ordinary numerals), and there are pairing operations with associated
projections. By the latter I mean that there are always elements j, j0, j1 in a pca Q
such jab ‚Üì, j0(jab) = a and j1(jab) = b for all a, b ‚ààQ. Instead of jab I will also
frequently write ‚ü®a, b‚ü©. Results of repeated pairings will often be denoted by terms of
the type ‚ü®a1, a2, . . . , an‚ü©, with the associated projections denoted by ji (1 ‚â§i ‚â§n).
The prime example of a pca is that of the natural numbers equipped with Kleene
application: one Ô¨Åxes a particular coding {‚àí} of the partial recursive functions as
natural numbers, so that {m} is the partial recursive function encoded by the natural
number m. Then deÔ¨Ånes m ¬∑ n ‚âÉ{m}n to obtain K1, Kleenes pca. Models of the
lambda calculus provide other examples, like Scott‚Äôs graph model Pœâ.
Heyting pre-algebras C.2
A Heyting pre-algebra is a pre-order, that has Ô¨Ånite
limits and colimits and is cartesian closed as a category. As for partial orders, products
and coproducts are denoted by ‚àßand ‚à®, respectively, while the exponentials ab are
denoted b ‚Üía. The order is usually denoted by ‚ä¢.
For any pca Q, write Œ£ = PQ for the powerset of Q. Œ£ carries the structure of
pre-order as follows: A ‚ä¢B, when there is a q ‚ààQ such that q ¬∑ a ‚Üìfor all a ‚ààA, and
q ¬∑ a ‚ààB. It has, in fact, the structure of a Heyting pre-algebra in which:
A ‚àßB
=
{‚ü®a, b‚ü©| a ‚ààA, b ‚ààB}
A ‚à®B
=
{‚ü®a, 0‚ü©| a ‚ààA} ‚à™{‚ü®b, 1‚ü©| b ‚ààB}
A ‚ÜíB
=
{q ‚ààQ | q ¬∑ a ‚Üìand q ¬∑ a ‚ààB for all a ‚ààA}.
For any set X, one could give Œ£X the structure of a Heyting pre-algebra, by deÔ¨Åning
the ordering pointwise. But there is another possibility, which is more important for
our purposes. Say F ‚ä¢G for F, G ‚ààŒ£X, when there is a q ‚ààQ such that for all
x ‚ààX, a ‚ààF(x), q ¬∑ a is deÔ¨Åned and in G(x). The point is commonly expressed by
saying that there should be a realiser q that works uniformly for all x ‚ààX. It can
easily be shown by extending the deÔ¨Ånitions above that also when the order of Œ£X is
deÔ¨Åned in this way, it has the structure of a Heyting pre-algebra.

147
Triposes C.3
A tripos (over Sets) is an indexed category P over Sets whose Ô¨Åbres
PI are Heyting pre-algebras, with some more properties. In particular, the reindexing
functors along functions f: J
/ I are required to preserve the structure of a Heyt-
ing pre-algebra, and the reindexing functors have left and right adjoints ‚àÉf and ‚àÄf,
satisfying the Beck-Chevalley condition. This means that triposes have the structure
to model many-sorted, Ô¨Årst-order intuitionistic logic. I will skip the formal details,
but the idea is that the elements of PI are predicates on the set I, and formulas
œÜ(i) in Ô¨Årst-order logic with a free variable of sort I can be interpreted in the tripos
as such predicates (formulas with more free variables, maybe of diÔ¨Äerent sorts, are
interpreted using the products in Sets). Then such formulas œÜ(i) are valid, when
their corresponding element in PI is isomorphic to the terminal object in that Ô¨Åbre.
One writes:
P ‚ä¢œÜ(i),
or simply ‚ä¢œÜ(i), when P is understood.
Any pca Q gives rise to a tripos P. The Ô¨Åbre PI is Œ£I, and reindexing is deÔ¨Åned by
precomposition. For a predicate F ‚ààŒ£J and a function f: J
/ I, the quantiÔ¨Åers are
deÔ¨Åned by:
‚àÉf(F)(i)
=
{q ‚ààQ | ‚àÉj ‚ààf ‚àí1(i). q ‚ààF(j)}
‚àÄf(F)(i)
=
{q ‚ààQ | ‚àÄj ‚ààf ‚àí1(i) ‚àÄa ‚ààQ. q ¬∑ a ‚Üìand q ¬∑ a ‚ààF(j)}.
Realisability toposes C.4
Given a tripos P, consider the following category. Ob-
jects are pairs (X, =), where X is a set, and = is an element of PX√óX, which the
tripos believes to be a partial equivalence relation (i.e. a symmetric and transitive
relation), in the sense that
P ‚ä¢x = x‚Ä≤ ‚Üíx‚Ä≤ = x
P ‚ä¢x = x‚Ä≤ ‚àßx‚Ä≤ = x‚Ä≤‚Ä≤ ‚Üíx = x‚Ä≤‚Ä≤.
The statement that x = x is sometimes abbreviated as Ex (and one thinks of this as
saying that ‚Äúx exists‚Äù).
Morphisms from (X, =) to (Y, =) are equivalence classes of functional relations. A
functional relation is an element F ‚ààPX√óY , such that the following are valid:
Fxy ‚àßx = x‚Ä≤ ‚àßy = y‚Ä≤ ‚ÜíFx‚Ä≤y‚Ä≤
Fxy ‚ÜíEx ‚àßEy
Fxy ‚àßFxy‚Ä≤ ‚Üíx = x‚Ä≤
Ex ‚Üí‚àÉy Fxy.
Two such functional relations F, G are equivalent, when they are extensionally equal
in the sense that
P ‚ä¢Fxy ‚ÜîGxy
(for this to obtain, the validity of one implication is suÔ¨Écient).

148
APPENDIX C. PCAS AND REALISABILITY
This deÔ¨Ånes a category (not quite, but identities and compositions can be con-
structed), which is actually a topos: for this, one uses some of the structure of a
tripos that I have not explained, but also does not concern me. The important thing
is the following theorem.
Theorem C.5 The category deÔ¨Åned out of a tripos in the way explained above, is a
topos.
When the tripos derives from a pca Q, the topos built in this fashion is called the
realisability topos over Q, and denoted by RT(Q).
Theorem C.6 The category RT(Q) is a topos with nno.
In case Q is Kleene‚Äôs pca K1, RT(Q) is what is called the eÔ¨Äective topos Eff, which
is therefore also a topos with nno.
In the thesis, I use many results on the eÔ¨Äective topos, but I do not think it is
worthwhile to summarise them here.
However, I do want to record the following
two facts, which are useful to know. They both concern canonical representations of
categorical notions in a realisability topos.
Subobjects of an object (X, =) in RT(Q) are in one-to-one correspondence to equiv-
alence classes of strict relations, i.e. elements R ‚ààPX such that the following are
valid:
Rx ‚àßx = x‚Ä≤ ‚ÜíRx‚Ä≤
Rx ‚ÜíEx.
Two such strict relations R, S are equivalent, when Rx ‚ÜîSx is valid.
Quotients of an object (X, =) in RT(Q) are in one-to-one correspondence to equiva-
lence classes of elements R ‚ààPX√óX satisfying the following:
P ‚ä¢Ex ‚ÜíRxx
P ‚ä¢Ex ‚àßEy ‚àßRxy ‚ÜíRyx
P ‚ä¢Ex ‚àßEy ‚àßEz ‚àßRxy ‚àßRyz ‚ÜíRxz.
Again, two such elements R, S ‚ààPX√óX are equivalent, when Rxy ‚ÜîSxy is valid.

Bibliography
[1] M. Abbott, T. Altenkirch, and N. Ghani.
Containers: constructing strictly
positive types. Theoret. Comput. Sci., 342(1):3‚Äì27, 2005.
[2] P. Aczel. The type theoretic interpretation of constructive set theory. In Logic
Colloquium ‚Äô77 (Proc. Conf., Wroc law, 1977), volume 96 of Stud. Logic Founda-
tions Math., pages 55‚Äì66. North-Holland Publishing Co., Amsterdam, 1978.
[3] P. Aczel. The type theoretic interpretation of constructive set theory: choice
principles. In The L. E. J. Brouwer Centenary Symposium (Noordwijkerhout,
1981), volume 110 of Stud. Logic Found. Math., pages 1‚Äì40. North-Holland Pub-
lishing Co., Amsterdam, 1982.
[4] P. Aczel. The type theoretic interpretation of constructive set theory: induc-
tive deÔ¨Ånitions. In Logic, methodology and philosophy of science, VII (Salzburg,
1983), volume 114 of Stud. Logic Found. Math., pages 17‚Äì49. North-Holland
Publishing Co., Amsterdam, 1986.
[5] P. Aczel. Non-well-founded sets, volume 14 of CSLI Lecture Notes. CSLI Publi-
cations, Stanford, CA, 1988.
[6] P. Aczel and N. Mendler. A Ô¨Ånal coalgebra theorem. In Category theory and
computer science (Manchester, 1989), volume 389 of Lecture Notes in Comput.
Sci., pages 357‚Äì365. Springer-Verlag, Berlin, 1989.
[7] P. Aczel and M. Rathjen. Notes on constructive set theory. Technical Report
No. 40, Institut Mittag-LeÔ¨Ñer, 2000/2001.
[8] J. Ad¬¥amek, S. Milius, and J. Velebil. On coalgebra based on classes. Theoret.
Comput. Sci., 316(1-3):3‚Äì23, 2004.
[9] S.
Awodey,
C.
Butz,
A.K.
Simpson,
and
T.
Streicher.
Relating
topos theory and set theory via categories of classes.
Available from
http://www.phil.cmu.edu/projects/ast/, June 2003.
[10] S. Awodey and M.A. Warren. Predicative algebraic set theory. Theory Appl. of
Categ., 15(1):1‚Äì39, 2005.
149

150
BIBLIOGRAPHY
[11] H.P. Barendregt. The lambda calculus ‚Äì Its syntax and semantics, volume 103
of Stud. Logic Foundations Math. North-Holland Publishing Co., Amsterdam,
1981.
[12] K.J. Barwise and L. Moss.
Vicious circles ‚Äì On the mathematics of non-
wellfounded phenomena, volume 60 of CSLI Lecture Notes. CSLI Publications,
Stanford, CA, 1996.
[13] A. Bauer. The realizability approach to computable analysis and topology. PhD
thesis, Carnegie Mellon University, 2000.
[14] B. van den Berg. Inductive types and exact completion. Ann. Pure Appl. Logic,
134:95‚Äì121, 2005.
[15] B. van den Berg.
Sheaves for predicative toposes.
Available from arXiv:
math.LO/0507480, July 2005.
[16] L. Birkedal, A. Carboni, G. Rosolini, and D.S. Scott. Type theory via exact
categories (extended abstract). In Thirteenth Annual IEEE Symposium on Logic
in Computer Science (Indianapolis, IN, 1998), pages 188‚Äì198. IEEE Computer
Soc., Los Alamitos, CA, 1998.
[17] E.A. Bishop. Foundations of constructive analysis. McGraw-Hill Book Co., New
York, 1967.
[18] A.R. Blass and A. Scedrov. Freyd‚Äôs models for the independence of the axiom
of choice. Mem. Am. Math. Soc., 79(404), 1989.
[19] C. Butz. Bernays-G¬®odel type theory. J. Pure Appl. Algebra, 178(1):1‚Äì23, 2003.
[20] A. Carboni. Some free constructions in realizability and proof theory. J. Pure
Appl. Algebra, 103:117‚Äì148, 1995.
[21] A. Carboni and R. Celia Magno. The free exact category on a left exact one. J.
Austral. Math. Soc., 33:295‚Äì301, 1982.
[22] A. Carboni and G. Rosolini. Locally cartesian closed exact completions. J. Pure
Appl. Algebra, 154:103‚Äì116, 2000.
[23] C. CÀÜƒ±rstea. A coequational approach to specifying behaviours. Electr. Notes
Theor. Comput. Sci., 19:142‚Äì163, 1999.
[24] B. Courcelle. Fundamental properties of inÔ¨Ånite trees. Theoret. Comput. Sci.,
25(2):95‚Äì169, 1983.
[25] P.-L. Curien. Substitution up to isomorphism. Fund. Inform., 19(1-2):51‚Äì85,
1993.

BIBLIOGRAPHY
151
[26] F. De Marchi. On the semantics of coinductive types in Martin-L¬®of type the-
ory. In J.L. Fiadeiro et al., editor, Algebra and Coalgebra in Computer Science
(CALCO 2005), volume 3629 of Lecture Notes in Comput. Sci., pages 114‚Äì126.
Springer-Verlag, Berlin, 2005.
[27] P. Dybjer and A. Setzer. Induction-recursion and initial algebras. Ann. Pure
Appl. Logic, 124(1-3):1‚Äì47, 2003.
[28] M. Forti and F. Honsell.
Set theory with free construction principles.
Ann.
Scuola Norm. Sup. Pisa Cl. Sci. (4), 10(3):493‚Äì522, 1983.
[29] H.M. Friedman. Set theoretic foundations for constructive analysis. Ann. of
Math. (2), 105(1):1‚Äì28, 1977.
[30] N. Gambino. Sheaf interpretations for generalised predicative intuitionistic sys-
tems. PhD thesis, University of Manchester, 2002.
[31] N. Gambino. Presheaf models for constructive set theories. In L. Crosilla and
P.M. Schuster, editors, From Sets and Types to Topology and Analysis: Towards
Practicable Foundations for Constructive Mathematics. Oxford University Press,
Oxford, 2005.
[32] N. Gambino. Heyting-valued interpretations for constructive set theory. Ann.
Pure Appl. Logic, 137(1-3):164‚Äì188, 2006.
[33] N. Gambino and J.M.E. Hyland. Wellfounded trees and dependent polynomial
functors. In Types for proofs and programs, volume 3085 of Lecture Notes in
Comput. Sci., pages 210‚Äì225. Springer-Verlag, Berlin, 2004.
[34] R.J. Grayson. Forcing in intuitionistic systems without power-set. J. Symb. Log.,
48(3):670‚Äì682, 1983.
[35] J.R. Hindley and J.P. Seldin. Introduction to combinators and Œª-calculus, vol-
ume 1 of London Mathematical Society Student Texts. Cambridge University
Press, Cambridge, 1986.
[36] M. Hofmann. On the interpretation of type theory in locally cartesian closed
categories. In Computer science logic (Kazimierz, 1994), volume 933 of Lecture
Notes in Comput. Sci., pages 427‚Äì441. Springer-Verlag, Berlin, 1995.
[37] M.
Hofmann,
J.
van
Oosten,
and
T.
Streicher.
Well-foundedness
in
realizability.
To
appear
in
Arch.
Math.
Logic.
Available
from
http://www.math.uu.nl/people/jvoosten/realizability.html.
[38] P.J.W. Hofstra. Completions in realizability. PhD thesis, University of Utrecht,
2003. Available at http://www.math.uu.nl/people/jvoosten/realizability.html.
[39] J.M.E. Hyland. The eÔ¨Äective topos. In The L.E.J. Brouwer Centenary Sym-
posium (Noordwijkerhout, 1981), volume 110 of Stud. Logic Foundations Math.,
pages 165‚Äì216. North-Holland Publishing Co., Amsterdam, 1982.

152
BIBLIOGRAPHY
[40] J.M.E. Hyland, P.T. Johnstone, and A.M. Pitts. Tripos theory. Math. Proc.
Cambridge Philos. Soc., 88(2):205‚Äì231, 1980.
[41] B.P.F. Jacobs.
Categorical logic and type theory, volume 141 of Stud. Logic
Foundations Math. North-Holland Publishing Co., Amsterdam, 1999.
[42] B.P.F. Jacobs and J. Rutten.
A tutorial on (co)algebras and (co)induction.
Bulletin of the EATCS, 62:222‚Äì259, 1996.
[43] M. Jibladze. A presentation of the initial lift-algebra. J. Pure Appl. Algebra,
116(1-3):185‚Äì198, 1997.
[44] P.T. Johnstone. Sketches of an elephant: a topos theory compendium. Volume
1, volume 43 of Oxf. Logic Guides. Oxford University Press, New York, 2002.
[45] P.T. Johnstone. Sketches of an elephant: a topos theory compendium. Volume
2, volume 44 of Oxf. Logic Guides. Oxford University Press, Oxford, 2002.
[46] P.T. Johnstone, A.J. Power, T. Tsujishita, H. Watanabe, and J. Worrell. On the
structure of categories of coalgebras. Theoret. Comput. Sci., 260(1-2):87‚Äì117,
2001.
[47] A. Joyal and I. Moerdijk. Algebraic set theory, volume 220 of London Mathe-
matical Society Lecture Note Series. Cambridge University Press, Cambridge,
1995.
[48] C. Kouwenhoven-Gentil and J. van Oosten. Algebraic set theory and the eÔ¨Äective
topos. J. Symbolic Logic, 70(3):879‚Äì890, 2005.
[49] K. Kunen.
Set theory ‚Äì An introduction to independence proofs, volume 102
of Stud. Logic Foundations Math. North-Holland Publishing Co., Amsterdam,
1980.
[50] J. Lambek. Subequalizers. Canadian Math. Bull., 13:337‚Äì349, 1970.
[51] J. Lambek and P.J. Scott. Introduction to higher order categorical logic, volume 7
of Camb. Stud. Adv. Math. Cambridge University Press, Cambridge, 1986.
[52] I. Lindstr¬®om. A construction of non-well-founded sets within Martin-L¬®of‚Äôs type
theory. J. Symbolic Logic, 54(1):57‚Äì64, 1989.
[53] R.S. Lubarsky. CZF and Second Order Arithmetic. Accepted for publication in
Ann. Pure Appl. Logic.
[54] R.S. Lubarsky. Independence results around constructive ZF. Ann. Pure Appl.
Logic, 132(2-3):209‚Äì225, 2005.
[55] S. Mac Lane. Categories for the working mathematician, volume 5 of Graduate
Texts in Mathematics. Springer-Verlag, New York, second edition, 1998.

BIBLIOGRAPHY
153
[56] S. Mac Lane and I. Moerdijk. Sheaves in geometry and logic ‚Äì A Ô¨Årst introduction
to topos theory. Universitext. Springer-Verlag, New York, 1992.
[57] P. Martin-L¬®of. Intuitionistic type theory, volume 1 of Studies in Proof Theory.
Lecture Notes. Bibliopolis, Naples, 1984.
[58] D.C. McCarty.
Realizability and recursive mathematics.
PhD thesis, Oxford
University, 1984.
[59] M. Menni. Exact completions and toposes. PhD thesis, University of Edinburgh,
2000. Available at http://www.math.uu.nl/people/jvoosten/realizability.html.
[60] I. Moerdijk and E. Palmgren. Wellfounded trees in categories. Ann. Pure Appl.
Logic, 104:189‚Äì218, 2000.
[61] I. Moerdijk and E. Palmgren. Type theories, toposes and constructive set theory:
predicative aspects of AST. Ann. Pure Appl. Logic, 114:155‚Äì201, 2002.
[62] J. Myhill. Constructive set theory. J. Symbolic Logic, 40(3):347‚Äì382, 1975.
[63] B. Nordstr¬®om, K. Petersson, and J.M. Smith.
Programming in Martin-L¬®of‚Äôs
type theory ‚Äì An introduction, volume 7 of International Series of Monographs
on Computer Science. Oxford University Press, New York, 1990.
[64] B. Nordstr¬®om, K. Petersson, and J.M. Smith.
Martin-L¬®of‚Äôs type theory.
In
Handbook of logic in computer science, Vol. 5, Oxford Sci. Publ., pages 1‚Äì37.
Oxford University Press, New York, 2000.
[65] J. van Oosten. Axiomatizing higher-order Kleene realizability. Ann. Pure Appl.
Logic, 70(1):87‚Äì111, 1994.
[66] J. van Oosten.
Basic category theory.
Lecture notes available from
http://www.math.uu.nl/people/jvoosten/onderwijs.html, July 2002.
[67] C.-E. Ore. The extended calculus of constructions (ECC) with inductive types.
Inform. and Comput., 99(2):231‚Äì264, 1992.
[68] R. Par¬¥e and D. Schumacher. Abstract families and the adjoint functor theorems.
In Indexed categories and their applications, volume 661 of Lecture Notes in
Math., pages 1‚Äì125. Springer-Verlag, Berlin, 1978.
[69] A.M. Pitts. The theory of triposes. PhD thesis, Cambridge University, 1981.
[70] M. Rathjen. Realizability for constructive Zermelo-Fraenkel set theory. To ap-
pear in J. V¬®a¬®an¬®anen and V. Stoltenberg-Hansen, editors, Proceedings of the Logic
Colloquium 2003.
[71] M. Rathjen. The anti-foundation axiom in constructive set theories. In Games,
logic, and constructive sets (Stanford, CA, 2000), volume 161 of CSLI Lecture
Notes, pages 87‚Äì108. CSLI Publications, Stanford, CA, 2003.

154
BIBLIOGRAPHY
[72] M. Rathjen. Predicativity, circularity, and anti-foundation. In One hundred years
of Russell‚Äôs paradox, volume 6 of de Gruyter Ser. Log. Appl., pages 191‚Äì219. De
Gruyter, Berlin, 2004.
[73] M. Rathjen. The disjunction and related properties for constructive Zermelo-
Fraenkel set theory. J. Symbolic Logic, 70(4):1232‚Äì1254, 2005.
[74] M. Rathjen. Replacement versus collection and related topics in constructive
Zermelo-Fraenkel set theory. Ann. Pure Appl. Logic, 136(1-2):156‚Äì174, 2005.
[75] M. Rathjen and R.S. Lubarsky. On the regular extension axiom and its variants.
MLQ Math. Log. Q., 49(5):511‚Äì518, 2003.
[76] L. Rieger. A contribution to G¬®odel‚Äôs axiomatic set theory. I. Czechoslovak Math.
J., 7(82):323‚Äì357, 1957.
[77] E.P. Robinson and G. Rosolini. Colimit completions and the eÔ¨Äective topos. J.
Symbolic Logic, 55(2):678‚Äì699, 1990.
[78] L. Santocanale. Logical construction of Ô¨Ånal coalgebras. Electr. Notes Theor.
Comput. Sci., 82(1):1‚Äì20, 2003.
[79] R.A.G. Seely. Locally cartesian closed categories and type theory. Math. Proc.
Camb. Philos. Soc., 95(1):33‚Äì48, 1984.
[80] T. Streicher. Realizability models for CZF+ ¬¨ Pow. Unpublished note, March
2005.
[81] A. S. Troelstra and D. van Dalen.
Constructivism in mathematics. Vol. II,
volume 123 of Stud. Logic Foundations Math. North-Holland Publishing Co.,
Amsterdam, 1988.
[82] A.S. Troelstra. A note on non-extensional operations in connection with continu-
ity and recursiveness. Nederl. Akad. Wetensch. Proc. Ser. A 80=Indag. Math.,
39(5):455‚Äì462, 1977.
[83] D. Turi and J. Rutten. On the foundations of Ô¨Ånal coalgebra semantics: non-
well-founded sets, partial orders, metric spaces. Math. Structures Comput. Sci.,
8(5):481‚Äì540, 1998.

Index
AFA, 119
algebra, 126
free, 127
indexed initial, 129
initial, 127
partial combinatory, 145
sub-, 128
weak Pf-, 45
algebraic set theory, 67‚Äì71
AMC, 71
Anti-Foundation Axiom, 119
assembly, 26
partitioned, 51, 54
Axiom of Countable Choice, 76
Axiom of Multiple Choice, 71
Axiom of Relativised Dependent Choice,
76
base (category of bases), 59
base (set-theoretic notion), 79
branching element, 85
CA, 70
category
base, 128
cartesian, 123
cartesian closed, 126
locally, 126
cocartesian, 128
exact, 125
Heyting, 124
indexed, 128
cocomplete, 131
of algebras, 129
of coalgebras, 129
internal, 130
ML-, 24
regular, 123
child, 84
Church‚Äôs Thesis, 76
class of maps
representable, 69
stable, 68
class of small maps, 69, 112
coalgebra, 128
cofree, 128
Ô¨Ånal, 128
indexed Ô¨Ånal, 129
proto-, 84
cocone
canonical, 104
coherent element, 85
colimit
internal, 130
Collection Axiom, 120
Strong, 66
Subset, 66
Collection Axiom (categorical), 70
combinatory completeness, 145
comonad
cartesian, 93
constructivism, 7
cover, 123
CST, 119
CZF, 65‚Äì67
CZF‚àí, 120
CZF0, 117
decoration, 27
diagram
exact, 125
internal, 130
stably exact, 125
Emptyset Axiom, 117
enough projectives, 35
155

156
INDEX
epimorphism
regular, 123
exact completion, 33
exponential, 126
weak, 43
Exponentiation axiom, 119
Extensionality Axiom, 66, 117
Ô¨Åxpoint, 128
indexed well-founded, 129
pre-, 89
well-founded, 128
formula
bounded, 66
Fullness Axiom, 66
functor
cartesian, 123
exact, 125
generalised polynomial, 25
indexed, 129
internal, 130
polynomial, 18
powerclass, 76
regular, 123
reindexing, 128
small-based, 110
glueing, 60
Heyting algebra, 31
Heyting pre-algebra, 146
Heyting-valued set, 30
homset
internal, 103
identity type
extensional, 139
intensional, 139
image of a map, 123
Independence of Premisses, 76
indexing
canonical, 129
InÔ¨Ånity Axiom, 66
inserter of indexed categories, 105
Intersection Axiom, 117
IZF‚àí, 120
Kan extension
internal left, 130
lccc, 125‚Äì126
M-type, 18, 82
in assemblies, 29
in Heyting algebra, 31
in sets, 21
in topos with nno, 26
map
choice, 35
collection, 70
exponentiable, 126
generic, 103
pointed, 87
root, 21, 83
small, 69, 113
subcountable, 73
universal small, 70, 114
weak Pf-substructure, 45
Markov‚Äôs Principle, 76
ML-category, 24
modest set, 29
nno, 127
indexed, 127
object
exponentiable, 126
in indexed category, 103
generating, 104
indexed terminal, 129
natural number, 44, 127
indexed, 127
weak, 44
powerclass, 113
separated, 98
small, 68, 113
subcountable, 59
weakly terminal, 104
operator
universal closure, 98
Pairing Axiom, 66, 117
Partial Equivalence Relation, 29

INDEX
157
path, 21, 84
pca, 145
internal, 54
PER, 29
Powerset Axiom, 120
predicativism, 8
preÔ¨Åxpoint, 89
Presentation Axiom, 76
pretopos, 125
Œ†M-, 82
Œ†W, 24
Œ†-, 126
Heyting, 125
weak Œ†W-, 46
product
dependent, 41, 125
simple, 43
weak dependent, 41
weak simple, 43
projective
external, 34
internal, 35
proof, 42
proto-coalgebra, 84
pullback
quasi-, 36
weak, 110
quasi-pullback, 36
quotient in a category, 124
reÔ¨Çector, 98
Regular Extension Axiom, 66
regular set, 67
relation in a category
equivalence, 124
functional, 124
pseudo-equivalence, 34
small, 113
Replacement axiom, 117
representation
weak, 76
Separation Axiom
‚àÜ0-, 66
Bounded, 66
Full, 120
Set Induction Axiom, 66
setoid, 31
sheaf, 98
span (indexed category of spans), 106
structure
Pf-, 44
subalgebra, 128
weak Pf-, 45
subcategory
locally full, 68
reÔ¨Çective, 98
subcountable, 72
in the eÔ¨Äective topos, 59, 72
subobject
small, 113
weak, 42
subobject classiÔ¨Åer, 25
subtree, 22
decorated, 55
proper, 22
sum
Ô¨Ånite disjoint and stable, 125
topos, 25
eÔ¨Äective, 148
predicative realisability, 54
realisability, 147
tree
coherent, 97
composable, 97
decorable, 27
decorated, 52
natural, 97
tripos, 147
type theory, 133‚Äì143
extensional, 139
intensional, 139
Uniformity Principle, 76
Union Axiom, 66, 117
Unzerlegbarkeit, 76
W-type, 18
characterisation theorem, 22
in assemblies, 27

158
INDEX
in Heyting algebra, 31
in Heyting-valued sets, 30
in modest sets, 30
in realisability topos, 52
in sets, 19
in topos with nno, 26
weak, 45
ZF‚àí, 120

Samenvatting in het Nederlands
Dit is een proefschrift in de wiskundige logica. Logica bestudeert formele systemen
met het doel meer te weten te komen over het wiskundige redeneren. Hoe gaat dat
in zijn werk?
Een wiskundige formuleert stellingen en probeert daar vervolgens een bewijs voor
te geven. Dergelijke bewijzen zijn aan nauw omschreven regels gebonden en in feite
laten de toegestane redeneerstappen zich zuiver formeel beschrijven. In andere woor-
den: of een redeneerstap geldig is hangt niet af van het onderwerp van de redenering,
maar alleen van haar vorm (zoals Aristoteles zich al realiseerde). Wiskundige logica
bestudeert de vormen van correct redeneren op een wiskundige manier.
Toch is het geen sinecure om een raamwerk te formuleren waarbinnen alle bestaan-
de wiskunde past. Niet alleen moet de logica worden vastgelegd, er moet ook een
conceptuele taal ontwikkeld worden waarin over uiteenlopende wiskundige entiteiten
gesproken kan worden (van getallen en driehoeken tot C‚àû-vari¬®eteiten en niet-abelse
groepen). En dan het liefst nog op een handzame en inzichtelijke manier.
De verzamelingenleer van Cantor biedt een dergelijke taal.
Het aantal typen
entiteiten is beperkt (er zijn alleen verzamelingen), het aantal relaties ook (alles is
gedeÔ¨Ånieerd in termen van de elementrelatie), er is een klein aantal axioma‚Äôs die
overwegend intu¬®ƒ±tief zeer aansprekend zijn en alle bekende wiskundige entiteiten laten
zich opvatten als verzamelingen. De manier waarop allerlei wiskundige objecten zich
laten coderen als verzamelingen is niet altijd vrij van een zekere kunstmatigheid of
willekeurigheid, maar dit stoort de meeste wiskundigen niet. Van belang is dat een
dergelijke verzamelingstheoretische reductie van de wiskunde in principe mogelijk is
en dat stellingen over de verzamelingenleer hiermee ook iets zeggen over de wiskunde
in het algemeen.
Het formuleren van de verzamelingenleer als een adequate logische theorie zon-
der tegenstrijdigheden kende zijn moeilijkheden, maar een periode van ontwikkeling
leverde uiteindelijk Zermelo-Fraenkel verzamelingenleer, inclusief het keuzeaxioma,
op dat aan de gestelde eisen lijkt te voldoen: het is een zuiver formeel te beschrijven
systeem, dat niet lijdt aan de bekende kinderziektes en waarin zich (nagenoeg) alle
wiskunde laat formaliseren. Tegenwoordig beroepen veel wiskundigen zich op deze
klassieke theorie als het logische fundament voor hun redeneringen en schikken zich
in haar oordeel waar het de correctheid daarvan aangaat.
Toch bestudeert dit proefschrift niet zozeer de klassieke verzamelingenleer, maar
eerder zijn alternatieven. Alternatieven kunnen in twee richtingen gezocht worden:
deze theorie onderschrijft het bestaan van entiteiten terwijl zij zich daar niet over uit
zou moeten laten of zij ontkent het bestaan van entiteiten waar ze die mogelijkheid
open zou moeten laten. Beide richtingen komen in dit proefschrift aan de orde.
Om met het eerste soort alternatief te beginnen: sommige axioma‚Äôs (en zelfs de on-
derliggende logica) van Zermelo-Fraenkel verzamelingenleer met keuze zijn het onder-
werp geworden van Ô¨ÅlosoÔ¨Åsche kritiek, omdat ze het bestaan impliceren van objecten
159

die als problematisch worden gezien. Twee groepen van critici zijn voor dit proef-
schrift van belang, te weten constructivisten en predicativisten. Zonder dit al te veel te
willen uitleggen, wil ik de bezwaren van beide groepen toch kort noemen: de bezwaren
van de constructivisten gelden objecten waarvoor slechts een niet-constructief bewijs
bestaat en de bezwaren van predicativisten gelden machtsverzamelingen en verza-
melingen gevormd door comprehensie voor willekeurige formules. Van belang is dat
beide groepen zich niet beperkten tot het leveren van kritiek, maar ze ook de noodzaak
voelden om in de vorm van een formeel systeem exact te beschrijven hoe wiskunde
eruit ziet die wel overeenkomt met hun Ô¨ÅlosoÔ¨Åsche opvattingen.
Constructieve Zermelo-Fraenkel verzamelingenleer is zo‚Äôn exact omschreven sys-
teem waarbinnen wiskunde bedreven kan worden die tegemoet komt aan de bezwaren
die door constructivisten en predicativisten naar voren zijn gebracht. Deze construc-
tieve theorie is daarmee een verzwakte vorm van de klassieke versie van de verzamelin-
genleer van Zermelo en Fraenkel, waar bepaalde axioma‚Äôs geschrapt zijn en mogelijk
vervangen door een voor constructivisten en predicativisten acceptabele versie. Zij is
voor het eerst geformuleerd door Peter Aczel in 1978 en staat recent weer opnieuw in
de belangstelling door het werk van diverse bewijstheoretici.
Dit proefschrift kiest een andere, meer model-theoretische, benadering voor het
bestuderen van Aczels constructieve verzamelingenleer en leunt daarbij sterk op ca-
tegorie¬®entheorie. Het laat zien dat er binnen categorie¬®en objecten bestaan die zich
gedragen als ‚Äúalternatieve wiskundige universa‚Äù. Vanuit het perspectief van de gewone
wiskundige gelden niet alle wiskundige en logische wetten binnen zo‚Äôn universum,
maar de regels van een zwakke verzamelingenleer als constructieve Zermelo-Fraenkel
verzamelingenleer gelden dan bijvoorbeeld wel. Zo‚Äôn alternatieve wiskundige wereld
waarin redeneringen binnen constructieve Zermelo-Fraenkel verzamelingenleer wel be-
trouwbaar zijn, maar argumenten die daarbuiten vallen mogelijk niet, heten modellen
voor constructieve Zermelo-Fraenkel verzamelingenleer. In dit proefschrift wordt deze
constructieve verzamelingenleer bestudeerd door zijn modellen onder de loep te ne-
men.
Zo mondt het eerste gedeelte van het proefschrift, na een analyse van categorie¬®en
waarbinnen dergelijke universa kunnen bestaan, uit in een bespreking van recente
modellen van Aczels theorie gegeven door Streicher en Lubarsky. Ik laat in de eerste
plaats zien dat ze hetzelfde zijn, maar verder bewijs ik dat dit alternatieve universum
een object is binnen een categorie (de zogenaamde eÔ¨Äectieve topos).
Dit gebruik
ik vervolgens om aan te tonen dat binnen dit model principes gelden die vanuit een
gebruikelijk wiskundig perspectief zoals dat van de klassieke verzamelingenleer onjuist
zijn. Het is alsof binnen dit universum niet alleen niet al onze natuurwetten gelden,
maar er andere wetten gelden, die in tegenspraak zijn met de onze.
Dit was tot
op zekere hoogte bekend, maar wordt in dit proefschrift systematisch onderzocht en
bewezen.
Maar om op de kwestie van de alternatieven voor de klassieke verzamelingenleer
terug te komen: constructieve Zermelo-Fraenkel verzamelingenleer is een beperkte
vorm daarvan, omdat het zich niet vastlegt op het bestaan van objecten waarvan
160

de existentie binnen de klassieke theorie bewezen kan worden. Het is aan de andere
kant ook mogelijk de wereld van de klassieke Zermelo-Fraenkel verzamelingenleer
uit te breiden met objecten waarvan het bestaan binnen deze theorie weerlegd kan
worden. Een voorbeeld hiervan wordt bestudeerd in de tweede helft van het proef-
schrift. Daar worden modellen onderzocht voor een verzamelingenleer waarbinnen
niet-welgefundeerde verzamelingen bestaan. Traditioneel sluit het zogenaamde fun-
deringsaxioma (of regulariteitsaxioma) de existentie van deze objecten uit, omdat deze
beweert dat alle verzamelingen welgefundeerd zijn, maar deze kan zonder problemen
vervangen worden door het anti-funderingsaxioma zodat naast de welgefundeerde
er ook niet-welgefundeerde verzamelingen bestaan.
Dergelijke niet-welgefundeerde
verzamelingen scheppen de mogelijkheid circulaire verschijnselen verzamelingtheo-
retisch te beschrijven, waarvan het belang vooral in de informatica ligt. Het laatste
hoofdstuk verruimt een bestaande methode om modellen te bouwen waarbinnen niet-
welgefundeerde verzamelingen bestaan door deze in een abstracte categorische context
te plaatsen en legt uit hoe deze in diverse situaties kan worden toegepast.
161


Acknowledgements
First of all, I would like to thank Ieke for being my supervisor. If I reached some
degree of professional maturity, it is thanks to him. I learned a lot of mathematics
from him, but equally important: he has assisted me with helpful advise during all
the stages of my PhD, while writing my Ô¨Årst article, this thesis, while organising a
workshop, while searching for sensible questions to investigate and while looking for
positions in the future. And he created the stimulating work environment in which I
have developed into some kind of independent researcher.
Next, I would like to thank Federico. For working with me on things non-well-
founded, which resulted in the last two chapters of this thesis, and for his helpful
comments on one of its earlier versions. And for being such a socially binding and
enterprising element in our group. I will never again make dismissive comments about
modern architecture in general, but I still don‚Äôt like Dal¬¥ƒ± or 2001: A Space Odyssey.
I would also like to thank my room mates for being such pleasant company. I
mean Hristina, Andor, Ittay and especially Claire. I enjoyed our brief collaboration
on W-types in the eÔ¨Äective topos and the moments which were spent in a way less
useful professionally. I can still feel my sense of shock when she decided to leave us.
And, of course, I would like to thank all the other members of our group for
making life at the department so enjoyable, whether they were logicians, topologists
or geometers: Jaap, Pieter, Pepijn, Marius, Alex, Camillo, David, Javier, Giorgio,
Andreas and Dmitry. I have developed an ambivalent relationship with that other
socially binding element of our group, coÔ¨Äee, but it would be foolish for me to deny
that it has given me many relaxing moments over the last years. Besides I enjoyed
the time I spent on playing football (also with other members of the department, and
the physicists), cards (also with Behrooz, Hamid and Erik) and chess.
On a professional level, I learned and proÔ¨Åted from discussions with Pieter Hof-
stra, Jaap van Oosten, Nicola Gambino, Erik Palmgren, Thomas Streicher and many
others.
Furthermore, I would like to thank the Netherlands Organization for ScientiÔ¨Åc
Research (NWO) for funding my stay in Sweden from March to May in 2005. And
Thierry Coquand and Erik Palmgren for being such excellent hosts and generously
sacriÔ¨Åcing their time to teach me some type theory.
Finally, I am grateful to my family and friends for their selÔ¨Çess concern for my
non-mathematical welfare.
163


Curriculum Vitae
Benno van den Berg was born on November 1, 1978, in Emmen, the Netherlands.
He attended the Esdal College in Emmen, before studying both mathematics and
philosophy at the University of Utrecht.
He started in 1996 and graduated with
honours in mathematics in 2001 under supervision of prof. Ieke Moerdijk and in
philosophy in 2002 under supervision of prof. Albert Visser. In 1998-99 he participated
in a Masterclass on Mathematical Logic, organised by the MRI. From September
2002 onwards, he was a PhD at the University of Utrecht, again under supervision of
prof. Ieke Moerdijk.
165

