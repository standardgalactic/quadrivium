Lecture Notes in Economics 
and Mathematical Systems
579
Founding Editors:
M. Beckmann
H.P. Künzi
Managing Editors:
Prof. Dr. G. Fandel
Fachbereich Wirtschaftswissenschaften
Fernuniversität Hagen
Feithstr. 140/AVZ II, 58084 Hagen, Germany
Prof. Dr. W. Trockel
Institut für Mathematische Wirtschaftsforschung (IMW)
Universität Bielefeld
Universitätsstr. 25, 33615 Bielefeld, Germany
Editorial Board:
A. Basile, A. Drexl, H. Dawid, K. Inderfurth, W. Kürsten, U. Schittko

Dieter Sondermann
Introduction
to Stochastic Calculus 
for Finance
A New Didactic Approach
With 6 Figures
123

Prof. Dr. Dieter Sondermann
Department of Economics
University of Bonn 
Adenauer Allee 24
53113 Bonn, Germany
E-mail: sondermann@uni-bonn.de
ISBN-10 3-540-34836-0
Springer Berlin Heidelberg New York
ISBN-13 978-3-540-34836-8
Springer Berlin Heidelberg New York
This work is subject to copyright. All rights are reserved, whether the whole or part of 
the material is concerned, speciﬁcally the rights of translation, reprinting, reuse of
illustrations, recitation, broadcasting, reproduction on microﬁlm or in any other way, 
and storage in data banks. Duplication of this publication or parts thereof is permitted
only under the provisions of the German Copyright Law of September 9, 1965, in its 
current version, and permission for use must always be obtained from Springer-Verlag.
Violations are liable for prosecution under the German Copyright Law.
Springer is a part of Springer Science+Business Media
springeronline.com
© Springer-Verlag Berlin Heidelberg 2006
Printed in Germany
The use of general descriptive names, registered names, trademarks, etc. in this publi-
cation does not imply, even in the absence of a speciﬁc statement, that such names are
exempt from the relevant protective laws and regulations and therefore free for general
use.
Typesetting: Camera ready by author
Cover: Erich Kirchner, Heidelberg
Production: LE-TEX, Jelonek, Schmidt & Vöckler GbR, Leipzig
SPIN 11769675
Printed on acid-free paper – 42/3100 – 5 4 3 2 1 0

To Freddy, Hans and Marek, who patiently helped me to a
deeper understanding of stochastic calculus.

Preface
There are by now numerous excellent books available on stochastic cal-
culus with speciﬁc applications to ﬁnance, such as Duﬃe (2001), Elliott-
Kopp (1999), Karatzas-Shreve (1998), Lamberton-Lapeyre (1995), and
Shiryaev (1999) on diﬀerent levels of mathematical sophistication.
What justiﬁes another contribution to this subject? The motivation is
mainly pedagogical. These notes start with an elementary approach to
continuous time methods of Itˆo’s calculus due to F¨ollmer. In an funda-
mental, but not well-known paper published in French in the Seminaire
de Probabilit´e in 1981 (see Foellmer (1981)), F¨ollmer showed that one
can develop Itˆo’s calculus without probabilities as an exercise in real
analysis. 1
The notes are based on courses oﬀered regularly to graduate students
in economics and mathematics at the University of Bonn choosing “ﬁ-
nancial economics” as special topic. To students interested in ﬁnance
the course opens a quick (but by no means “dirty”) road to the tools
required for advanced ﬁnance. One can start the course with what they
know about real analysis (e.g. Taylor’s Theorem) and basic probability
theory as usually taught in undergraduate courses in economic depart-
ments and business schools. What is needed beyond (collected in Chap.
1) can be explained, if necessary, in a few introductory hours.
The content of these notes was also presented, sometimes in condensed
form, to MA students at the IMPA in Rio, ETH Z¨urich, to practi-
1 An English translation of F¨ollmer’s paper is added to these notes in the Appendix.
In Chap. 2 we use F¨ollmer’s approach only for the relative simple case of processes
with continuous paths. F¨ollmer also treats the more diﬃcult case of jump-diﬀusion
processes, a topic deliberately left out in these notes.

VIII
Preface
tioners in the ﬁnance industry, and to PhD students and professors of
mathematics at the Weizmann institute. There was always a positive
feedback. In particular, the pathwise F¨ollmer approach to stochastic
calculus was appreciated also by mathematicians not so much famil-
iar with stochastics, but interested in mathematical ﬁnance. Thus the
course proved suitable for a broad range of participants with quite dif-
ferent background.
I am greatly indebted to many people who have contributed to this
course. In particular I am indebted to Hans F¨ollmer for generously al-
lowing me to use his lecture notes in stochastics. Most of Chapter 2 and
part of Chapter 3 follows closely his lecture. Without his contribution
these notes would not exist. Special thanks are due to my assistants, in
particular to R¨udiger Frey, Antje Mahayni, Philipp Sch¨onbucher, and
Frank Thierbach. They have accompanied my courses in Bonn with
great enthusiasm, leading the students with engagement through the
demanding course material in tutorials and contributing many useful
exercises. I also proﬁted from their critical remarks and from comments
made by Freddy Delbaen, Klaus Sch¨urger, Michael Suchanecki, and an
unknown referee. Finally, I am grateful to all those students who have
helped in typesetting, in particular to Florian Schr¨oder.
Bonn, June 2006
Dieter Sondermann

Contents
Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1
1
Preliminaries . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
3
1.1 Brief Sketch of Lebesgue’s Integral . . . . . . . . . . . . . . . . . . .
3
1.2 Convergence Concepts for Random Variables . . . . . . . . . .
7
1.3 The Lebesgue-Stieltjes Integral. . . . . . . . . . . . . . . . . . . . . . . 10
1.4 Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13
2
Introduction to Itˆo-Calculus . . . . . . . . . . . . . . . . . . . . . . . . . 15
2.1 Stochastic Calculus vs. Classical Calculus . . . . . . . . . . . . . 15
2.2 Quadratic Variation and 1-dimensional Itˆo-Formula . . . . 18
2.3 Covariation and Multidimensional Itˆo-Formula . . . . . . . . . 26
2.4 Examples . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31
2.5 First Application to Financial Markets . . . . . . . . . . . . . . . . 33
2.6 Stopping Times and Local Martingales . . . . . . . . . . . . . . . . 36
2.7 Local Martingales and Semimartingales . . . . . . . . . . . . . . . 44
2.8 Itˆo’s Representation Theorem . . . . . . . . . . . . . . . . . . . . . . . . 49
2.9 Application to Option Pricing . . . . . . . . . . . . . . . . . . . . . . . 50
3
The Girsanov Transformation . . . . . . . . . . . . . . . . . . . . . . . . 55
3.1 Heuristic Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 55
3.2 The General Girsanov Transformation . . . . . . . . . . . . . . . . 58
3.3 Application to Brownian Motion . . . . . . . . . . . . . . . . . . . . . 63
4
Application to Financial Economics . . . . . . . . . . . . . . . . . . 67
4.1 The Market Price of Risk and Risk-neutral Valuation . . . 68
4.2 The Fundamental Pricing Rule . . . . . . . . . . . . . . . . . . . . . . . 73
4.3 Connection with the PDE-Approach
(Feynman-Kac Formula) . . . . . . . . . . . . . . . . . . . . . . . . . . . . 76

X
Contents
4.4 Currency Options and Siegel-Paradox . . . . . . . . . . . . . . . . . 78
4.5 Change of Numeraire . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 79
4.6 Solution of the Siegel-Paradox . . . . . . . . . . . . . . . . . . . . . . . 84
4.7 Admissible Strategies and Arbitrage-free Pricing . . . . . . . 86
4.8 The “Forward Measure” . . . . . . . . . . . . . . . . . . . . . . . . . . . . 89
4.9 Option Pricing Under Stochastic Interest Rates . . . . . . . . 92
5
Term Structure Models . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 95
5.1 Diﬀerent Descriptions of the Term Structure of Interest
Rates . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 96
5.2 Stochastics of the Term Structure . . . . . . . . . . . . . . . . . . . . 99
5.3 The HJM-Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 102
5.4 Examples . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 105
5.5 The “LIBOR Market” Model . . . . . . . . . . . . . . . . . . . . . . . . 107
5.6 Caps, Floors and Swaps . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 111
6
Why Do We Need Itˆo-Calculus in Finance? . . . . . . . . . . 113
6.1 The Buy-Sell-Paradox . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 114
6.2 Local Times and Generalized Itˆo Formula . . . . . . . . . . . . . 115
6.3 Solution of the Buy-Sell-Paradox . . . . . . . . . . . . . . . . . . . . . 120
6.4 Arrow-Debreu Prices in Finance. . . . . . . . . . . . . . . . . . . . . . 121
6.5 The Time Value of an Option as Expected Local Time . . 123
7
Appendix: Itˆo Calculus Without Probabilities . . . . . . . . 125
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 135

Introduction
The lecture notes are organized as follows: Chapter 1 gives a concise
overview of the theory of Lebesgue and Stieltjes integration and con-
vergence theorems used repeatedly in this course. For mathematic stu-
dents, familiar e.g. with the content of Bauer (1996) or Bauer (2001),
this chapter can be skipped or used as additional reference .
Chapter 2 follows closely F¨ollmer’s approach to Itˆo’s calculus, and is
to a large extent based on lectures given by him in Bonn (see Foellmer
(1991)). A motivation for this approach is given in Sect. 2.1. This sec-
tion provides a good introduction to the course, since it starts with
familiar concepts from real analysis.
In Chap. 3 the Girsanov transformation is treated in more detail, as
usually contained in mathematical ﬁnance textbooks. Sect. 3.2 is taken
from Revuz-Yor (1991) and is basic for the following applications to
ﬁnance.
The core of this lecture is Chapter 4, which presents the fundamen-
tals of “ﬁnancial economics” in continuous time, such as the market
price of risk, the no-arbitrage principle, the fundamental pricing rule
and its invariance under numeraire changes. Special emphasis is laid
on the economic interpretation of the so-called “risk-neutral” arbitrage
measure and its relation to the “real world” measure considered in gen-
eral equilibrium theory, a topic sometimes leading to confusion between
economists and ﬁnancial engineers.
Using the general Girsanov transformation, as developed in Sect. 3.2,
the rather intricate problem of the change of numeraire can be treated
in a rigorous manner, and the so-called “two-country” or “Siegel” para-
dox serves as an illustration. The section on Feynman-Kac relates the
martingal approach used explicitly in these notes to the more classical
approach based on partial diﬀerential equations.
In Chap. 5 the preceding methods are applied to term structure mod-
els. By looking at a term structure model in continuous time in the
general form of Heath-Jarrow-Morton (1992) as an inﬁnite collection
of assets (the zerobonds of diﬀerent maturities), the methods developed
in Chap. 4 can be applied without modiﬁcation to this situation. Read-
ers who have gone through the original articles of HJM may appreciate
the simplicity of this approach, which leads to the basic results of HJM

2
Introduction
in a straightforward way. The same applies to the now quite popular
Libor Market Model treated in Sect. 5.5 .
Chapter 6 presents some more advanced topics of stochastic calculus
such as local times and the generalized Itˆo formula. The basic question
here is: Does one really need the apparatus of Itˆo’s calculus in ﬁnance?
A question which is tantamount to : are charts of ﬁnancial assets in re-
ality of unbounded variation? The answer is YES, as any practitioner
experienced in “delta-hedging” can conﬁrm. Chapter 6 provides the
theoretical background for this phenomenon.

1
Preliminaries
Recommended literature :
(Bauer 1996), (Bauer 2001)
We assume that the reader is familiar with the following basic con-
cepts:
(Ω, F, P) is a probability space, i.e.
F is a σ-algebra of subsets of the nonempty set Ω
P is a σ-additive measure on (Ω, F) with P[Ω] = 1
X is a random variable on (Ω, F, P) with values in IR := [−∞, ∞], i.e.
X is a map X : Ω−→IR with [X ≤a] ∈F for all a ∈IR
1.1 Brief Sketch of Lebesgue’s Integral
The Lebesgue integral of a random variable X can be deﬁned in three
steps.
(a) For a discrete random variable of the form X =
n
i=1
αi 1Ai , αi ∈IR,
Ai ∈F the integral (resp. the expectation) of X is deﬁned as
E[X] :=

Ω
X(ω) dP(ω) :=

i
αi P[Ai].

4
1 Preliminaries
Note: In the following we will drop the argument ω in the integral
and write shortly

Ω
X dP .
Let E denote the set of all discrete random variables.
(b) Consider the set of all random variables which are monotone limits
of discrete random variables, i.e. deﬁne
E∗:=

X : ∃
u1 ≤. . . , un ∈E , un ↑X

Remark: X random variable with X ≥0 =⇒X ∈E∗.
For X ∈E∗deﬁne

Ω
X dP :=
lim
n−→∞

Ω
un dP.
(c) For an arbitrary random variable X consider the decomposition
X = X+ −X−with
X+ := sup(X, 0)
,
X−:= sup(−X, 0).
According to (b), X+ , X−∈E∗.
If either E[X+] < ∞or E[X−] < ∞, deﬁne

Ω
X dP :=

Ω
X+ dP −

Ω
X−dP.
Properties of the Lebesgue Integral:
•
Linearity :

Ω
(α X + β Y ) dP = α

Ω
X dP + β

Ω
Y dP
•
Positivity : X ≥0 implies

X dP ≥0 and

X dP > 0 ⇐⇒P[X > 0] > 0.

1.1 Brief Sketch of Lebesgue’s Integral
5
•
Monotone Convergence (Beppo Levi).
Let (Xn) be a monotone sequence of random variables (i.e. Xn ≤
Xn+1) with X1 ≥C. Then
X := lim
n Xn ∈E∗
and
lim
n−→∞

Ω
Xn dP =

Ω
lim
n−→∞Xn dP =

Ω
X dP.
•
Fatou’s Lemma
(i) For any sequence (Xn) of random variables which are bounded
from below one has

Ω
lim
n−→∞inf Xn dP ≤
lim
n−→∞inf

Ω
Xn dP.
(ii) For any sequence (Xn) of random variables bounded from above
one has

Ω
lim
n−→∞sup Xn dP ≥
lim
n−→∞sup

Ω
Xn dP.
•
Jensen’s Inequality
Let X be an integrable random variable with values in IR and u :
IR −→¯IR a convex function.
Then one has
u(E[X]) ≤E[u(X)].
Jensen’s inequality is frequently applied, e.g. to u(X) = |X| , u(X) =
eX or u(X) = [X −a]+.
Lp-Spaces (1 ≤p < ∞)
Lp(Ω) denotes the set of all real-valued random variables X on (Ω, F, P)
with E[|X|p] < ∞for some 1 ≤p < ∞. For X ∈Lp, the Lp-norm is
deﬁned as
||X||p :=

E[|X|p]
 1
p .

6
1 Preliminaries
The Lp-norm has the following properties:
(a) H¨older’s Inequality
Given X ∈Lp(Ω) and Y ∈Lq(Ω) with 1
p + 1
q = 1, one has

Ω
|X| · |Y | dP ≤
 
Ω
|X|p dP
 1
p ·
 
Ω
|Y |q dP
 1
q dP < ∞,
In particular, since |X · Y | ≤|X| · |Y |, implies X · Y ∈L1(Ω).
(b) Lp(Ω) is a normed vector space. In particular, X, Y ∈Lp implies
X + Y ∈Lp and one has
||X + Y ||p ≤||X||p + ||Y ||p.
(triangle inequality)
(c) Lq ⊂Lp for p < q.
Important special case: p = 2.
On L2, the vector space of quadratically integrable random variables,
there exists even a scalar product deﬁned by
⟨X, Y ⟩:=

Ω
X · Y dP
Hence one has
||X||2 =
	
⟨X, X⟩
and H¨older’s inequality takes the form
⟨X, Y ⟩=

Ω
X · Y dP ≤||X||2 · ||Y ||2.

1.2 Convergence Concepts for Random Variables
7
1.2 Convergence Concepts for Random Variables
The strength of the Lebesgue integral, as compared with the Riemann
integral, consists in limit theorems - notably ’Lebesgue’s Theorem’ -
which allow to study the limit of random variables and their integrals.
Without the limit theorems - provided by the Lebesgue integration the-
ory - stochastic analysis would be impossible.
In this section we collect the basic convergence concepts for sequences
of random variables and their relationships.
Deﬁnition 1.2.1. Let (Xn)n∈IIN , X be random variables on (Ω, F, P).
(a) The sequence (Xn) converges to X P-almost surely if
P

{ω : Xn(ω) −→X(ω)}

= 1.
We will then write Xn −→X P-a.s.
(b) The sequence (Xn) converges in probability if, for every ϵ > 0
lim
n−→∞P

|Xn −X| > ϵ

= 0.
We will then write P −lim Xn = X.
(c) Let (Xn) be in Lp(Ω) for some p ∈[1, ∞).
The sequence (Xn) converges to X in Lp if
lim
n−→∞||Xn −X||p =
lim
n−→∞

E[|Xn −X|p]
 1
p = 0.
We will then write Xn −→X in Lp or Xn
Lp
−→X. (X is then also
in Lp).
Still another convergence concept for random variables is that of weak
convergence, also called convergence in distribution. Since here only the
distributions of a random variable matter, the random variables Xn
may be deﬁned on diﬀerent probability spaces. Let
Xn : (Ωn, Fn, P n) −→E and X : (Ω, F, P) −→E
be random variables with values in a metric space E (e.g. E = IR or
E = C[0, T] the space of all continuous real-valued functions on [0, T]).

8
1 Preliminaries
Deﬁnition 1.2.2. The sequence (Xn) converges to X weakly (or
in distribution) if, for every continuous bounded function f : E −→IR,
lim
n−→∞

Ωn
f(Xn) dPn =
lim
n−→∞

Ω
f(X) dP.
We will then write Xn −→X weakly or Xn
D
−→X.
Relations between the diﬀerent notions of convergence
(a) a.s.-convergence and convergence in probability
(i) Xn −→X P-a.s. =⇒P −lim Xn = X
(ii) P −lim Xn = X =⇒∃subsequence (Xn′) of (Xn)
with Xn′ −→X P−a.s.
(b) Convergence in probability and L1-convergence
Assume Xn −→X in L1.


Ω
Xn dP −

Ω
X dP

≤

Ω
|Xn −X| dP −→0
and hence
lim
n−→∞

Ω
Xn dP
=

Ω
lim
n−→∞Xn dP
Thus L1-convergence allows to exchange limit and integration, a
most important property for stochastic calculus.
Clearly L1-convergence implies convergence in probability. The fol-
lowing simple example shows that the converse does not hold.
Example:
Let Ω= [0, 1], F = Borel-σ-Algebra and P = Lebesgue measure.
Consider the sequence Xn(ω) := n · 1[0,1/n]. Then Xn −→0 P-a.s.,
hence also in probability. But

Ω
Xn dP = 1, for all n.

1.2 Convergence Concepts for Random Variables
9
The above example shows that an additional condition is needed
which prevents the Xn from growing too fast. A suﬃcient condition
(which is also necessary) is the following
Deﬁnition 1.2.3. The sequence (Xn) is called uniformly integrable
if
lim
C−→∞sup
n

|Xn|>C
|Xn| dP = 0.
Suﬃcient conditions for uniform integrability are the following:
1. sup
n
E[|X|p] < ∞for some p > 1,
2. There exists a random variable Y ∈L1 such that |Xn| ≤Y P-
a.s. for all n.
Condition 2. is Lebesgue’s ’dominated convergence’ condition.
The relation between L1-convergence and convergence in probabil-
ity is now given by
Proposition 1.2.4. (Lebesgue) The following are equivalent:
1. P −lim Xn = X and (Xn) is uniformly integrable,
2. Xn −→X in L1.
Application: (Changing the order of diﬀerentiation and integra-
tion)
Let X : IR×Ω−→IR be a family of random variables X(t, ·), which
is, for P-a.e. ω ∈Ω, diﬀerentiable in t. If there exists a random vari-
able Y ∈L1(Ω) such that
| ˙X(t, ω)| ≤Y (ω)
P-a.s.
then the function t −→

Ω
X(t, ω) dP(ω) is diﬀerentiable in t and
its derivative is

Ω
˙X(t, ω) dP(ω).

10
1 Preliminaries
(c) Convergence in distribution and convergence in probability
Convergence in probability always implies convergence in distribu-
tion, i.e.
P −lim Xn = X =⇒Xn
D
−→X.
The converse only holds if the limit X is P-a.s. constant.
1.3 The Lebesgue-Stieltjes Integral
From an elementary statistics course the following concepts and nota-
tions should be well-known.
Consider a real-valued random variable X on (Ω, F, P) and a Borel-
measurable mapping f : IR −→IR. I.e. we have
(Ω, F, P) X
−→(IR, B, PX)
f−→IR with
PX[B] := P[X−1(B)]
distribution of X
FX(x) := PX

] −∞, x]

= P[X ≤x]
distribution function of X.
Then the (Lebesgues-Stieltjes) integral

IR
f(x) dFX(x) is well deﬁned
due to the following integral transformation formula:
Proposition 1.3.1.

Ω
f ◦X dP =

IR
f dPX =

IR
f(x) dFX(x).
Proof. Let f = 1B be the characteristic function of the Borel set B ∈B.
Then by deﬁnition of PX and FX one has

Ω
f ◦X dP =

1X−1(B)dP = P[X−1(B)] = PX(B) =

IR
f dPX.
By linearity of the integral operator the relation is then also true for all
step functions f ∈E. By Beppo Levi’s monotone convergence theorem
it extends to all f ∈E∗and hence to all integrable functions f =
f+ −f−with f+, f−∈E∗.
⊓⊔

1.3 The Lebesgue-Stieltjes Integral
11
Corollary 1.3.2.
f ◦X ∈L1(Ω, P) =⇒f ∈L1(IR, PX).
Hence integration on Ωis reduced to integration on IR. In particular,
the moments of a random variable X can be computed as Lebesgue-
Stieltjes integral with respect to FX via
f(x) = xr =⇒E[Xr] =

IR
xr dFX.
We recall two well-known facts from elementary statistics.
Properties of F = FX:
(i) F is isotone, i.e. x ≤y =⇒F(x) ≤F(y),
(ii) F is right continuous,
(iii)
lim
x−→−∞F(x) = 0;
lim
x−→∞F(x) = 1.
Remark 1.1. (i) implies that F has left limits. Together with (ii) this
property is often called ’c`adl`ag’ (from the French “continu `a droite -
limites `a gauche”).
Proposition 1.3.3. X is a real random variable on (Ω, F, P) ⇐⇒FX
satisﬁes (i) - (iii)
Then, for any distribution function F and any Lebesgue-integrable real
function f, the Lebesgue-Stieltjes Integral

IR
f dF is well-deﬁned and
known from elementary statistics courses.
Generalization to functions of ﬁnite variation
We now consider real-valued right-continuous functions A on the time
interval [0, ∞[. The value of A at time t is denoted by A(t) or At (Note
that the integration variable x is now replaced by t).
Let Π be the set of all ﬁnite subdivisions π of the interval [0, t] with
0 = t0 < t1 < . . . < tn = t. Consider the sum
V π
t :=
n−1

i=0
|Ati+1 −Ati|
Deﬁnition 1.3.4. The function A is of ﬁnite variation if, for every t,
Vt(A) = sup
π∈Π
V π
t < +∞.

12
1 Preliminaries
The function t −→Vt is called the total variation of A. Let FV(IR+) de-
note the set of all real-valued right-continuous functions on IR+ = [0, ∞[
of ﬁnite variation.
Proposition 1.3.5. Every A ∈FV(IR+) is the diﬀerence of two iso-
tone c`adl`ag functions.
Proof. Obviously
At = 1
2 (Vt + At) −1
2 (Vt −At) = A+
t −A−
t
Both terms are also right-continuous and clearly isotone, hence c`adl`ag.
⊓⊔
As a result the function A has left limits at every t ∈]0, ∞[. We write
At−= lim
s↗t As and set A0−= 0.
In exactly the same way as a distribution function FX deﬁnes a measure
PX on (IR, B) via PX

] −∞, x]

= FX(x), every A ∈FV(IR+) deﬁnes
a measure µA on (IR+, B) given by
µ([0, t]) = At.
Note: Of course µA is no longer a probability measure and may take
negative values. Such a measure is called a signed measure.
Likewise as for distribution functions one has
µ([0, t[) = At−
and
µ({t}) = µA+ −µA−= ∆At
is the mass of µ concentrated in point t. Proposition 1.3.5 leads to the
decomposition
µA = µA+ −µA−
into two positive measures. Hence for any B-measurable real-valued
function f on IR+, the Lebesgue-Stieltjes integral is well deﬁned as

f dµ =

f dµ+ −

f dµ−=

f(s) µ(ds) =

f(s) dA(s).

1.4 Exercises
13
Deﬁnition 1.3.6.
t

0
fs dAs :=

1]0,t](s) fs dAs is called the integral
of f with respect to A integrated over the interval ]0, t].
In particular, it follows
t

0
dAs = µ([0, t]) −µ({0}) = At −A0.
1.4 Exercises
Sect. 1.1
1. Show that the Deﬁnition 1.1(a) is independent of the representation
of X ∈E.
(Hint: If X =
n
i=1
αi 1Ai =
m

J=1
βj 1Bj use a joint partition of Ωas
new representation)
2. Show that the Deﬁnition 1.1(b) is independent of the approximating
sequence of X ∈E∗.
Sect. 1.2
1. Let Ω= [0, 1] be the unit interval with F the σ-algebra of Borel
sets and P the Lebesgue measure. Consider the following sequence
Xn(ω) : [0, 1] −→IR :
X1(ω) =1[0,1/2], i.e. X1(ω) =

1,
ω ∈[0, 1/2]
0,
ω ∈[1/2, 1]
X2(ω) =1[1/2,1]
X3(ω) =1[0,1/3], X4(ω) = 1[1/3,2/3], X5(ω) = 1[2/3,1]
X6(ω) =1[0,1/4], . . . , X9(ω) = 1[3/4,1]
etc.
Show that (Xn) converges in probability, but does not converge P-
a.s.

14
1 Preliminaries
2. Consider (Ω, F, P) as in exercise 1. Deﬁne the sequence Xn by
Xn(ω) =

0,
ω < 1
2
1,
ω ≥1
2
for n even
Xn(ω) =

1,
ω < 1
2
0,
ω ≥1
2
for n odd
Show that Xn converges in distribution, but not in probability.

2
Introduction to Itˆo-Calculus
This chapter is based on Foellmer (1981) and follows closely Foellmer
(1991). For the techniques used in this chapter we refer to Chap. 1, or
to Bauer (1996) resp. Bauer (2001). Some results are quoted (without
proof) from Protter (1990) and Revuz-Yor (1991).
The ﬁrst elementary applications to option pricing in this chapter deal
with the standard Black-Scholes model (Black-Scholes (1973)), ﬁrst by
means of the classical PDE approach (Sect. 2.5), then by using the
martingale approach (Sect. 2.9).
2.1 Stochastic Calculus vs. Classical Calculus
Let X : [0, ∞] ↣IR be a real-valued function X(t) = Xt. For example
the function Xt can describe the speed or the acceleration of a solid
body in dependence of time t. But Xt can also represent the price of a
security over time, called the chart of the security X. However, there is
a fundamental diﬀerence between the two interpretations. In the ﬁrst
case X as a function of t is a “smooth” function, not only continuous
(natura non facit saltus!), but also (suﬃciently often) diﬀerentiable. For
this class of functions the well-known tools of classical calculus apply.
Using the notation
˙Xt := dXt
dt
for the diﬀerentiation of Xt w.r.t. time
t, as common in physics, the basic relation between diﬀerentiation and
integration can be stated as
Xt = X0 +
t

0
˙Xsds

16
2 Introduction to Itˆo-Calculus
or
dXt = ˙Xtdt.
Let F ∈C2(IR) be a twice continuously diﬀerentiable real-valued func-
tion on the real line IR. Then Taylor’s theorem states
△F(Xt) = F(Xt+△t) −F(Xt) = F ′(Xt)△Xt + 1
2F ′′(Xt)(△Xt)2
with △Xt = Xt+△t −Xt and some t ∈[t, t + △t].
Taking the limit for △t →0 gives
dF(Xt) = F ′(Xt)dXt
or, equivalently,
F(Xt) = F(X0) +
t

0
F ′(Xs)dXs
since, for a smooth function Xt, △Xt −−−−→
△t→0
dXt =
˙Xtdt , and the
terms of higher order, which are of order (dt)2, disappear.
However, this classical relation is no longer applicable for real-valued
functions occurring in mathematical ﬁnance. When in the 19th cen-
tury the German mathematician Weierstraß constructed a real-valued
function which is continuous, but nowhere diﬀerentiable, this was con-
sidered as nothing else but a mathematical curiosity. Unfortunately,
this “curiosity” is at the core of mathematical ﬁnance. Charts of ex-
change rates, interest rates, and liquid assets are practically continuous,
as the nowadays available high frequency data show. But they are of
unbounded variation in every given time interval, as argued in Chap. 6
of these notes. In particular, they are nowhere diﬀerentiable, thus the
Weierstraß function depicts a possible ﬁnance chart 1. Therefore classi-
cal calculus requires an extension to functions of unbounded variation,
a task for long time overlooked by mathematicians. This gap was ﬁlled
by the development of stochastic calculus, which can be considered as
the theory of diﬀerentiation and integration of stochastic processes.
1 However, as pointed out to me by Hans F¨ollmer, the Weierstraß function shows
deterministic cyclical behavior, hence as a ﬁnance chart it is only acceptable to
strong believers in business cycles.

2.1 Stochastic Calculus vs. Classical Calculus
17
As already mentioned in the preface, there are now numerous books
available developing stochastic calculus with emphasis on applications
to ﬁnancial markets on diﬀerent levels of mathematical sophistica-
tion. But here we follow the fundamentally diﬀerent approach due to
Foellmer (1981), who showed that one can develop Itˆo’s calculus with-
out probabilities as an exercise in real analysis.
What extension of the classical calculus is needed for real-valued func-
tions of unbounded variation? Simply, when forming the diﬀerential
dF(Xt) the second term of the Taylor formula can no longer be ne-
glected, since the term (∆Xt)2, the quadratic variation of Xt, does not
disappear for ∆t →0. Thus for functions of unbounded variation the
diﬀerential is of the form
dF(Xt) = F ′(Xt) dXt + 1
2 F ′′(Xt) (dXt)2
(1)
or, in explicit form,
F(Xt) = F(X0) +
t

0
F ′(Xs) dXs + 1
2
t

0
F ′′(Xs) (dXs)2
(2)
where (dXt)2 is the inﬁnitesimal quadratic variation of X.
Ironically, it was not the newly appearing second term which cre-
ated the main diﬃculty in developing stochastic calculus. For func-
tions of ﬁnite quadratic variation this F ′′-term is a well-deﬁned classi-
cal Lebesgue-Stieltjes integral. The real challenge was to give a precise
meaning to the ﬁrst integral, where both the argument of the integrand
and the integrator are of unbounded variation on any arbitrarily small
time interval. This task was ﬁrst 2 solved by Itˆo, hence the name Itˆo
formula for the relation (1) and Itˆo integral for the ﬁrst integral in (2).
For a lucid overview over the historic development of the subject see
e.g. Foellmer (1998).
2 Only recently it was discovered that the “Itˆo” formula was already found in the
year 1940 by the German-French mathematician Wolfgang D¨oblin. For the tragic
fate and the mathematical legacy of W. D¨oblin see Bru and Yor (2002).

18
2 Introduction to Itˆo-Calculus
Using the path-wise approach of F¨ollmer one can derive both the Itˆo
formula and the Itˆo integral without any recourse to probability theory.
By looking at a stochastic process “path by path” one can give a pre-
cise meaning to the expressions (1) and (2) by using only elementary
tools of classical real analysis.3 Only later probability theory is needed,
when we consider the interplay of all paths of stochastic processes like
diﬀusions and semimartingales.
2.2 Quadratic Variation and 1-dimensional Itˆo-Formula
Following Foellmer (1981) we start with a ﬁxed sequence (τn)n=1,2,... of
ﬁnite partitions
τn = {0 = t0 < t1 < . . . < tin < ∞}
of [0, ∞) with tin −→
n ∞and |τn| = sup
ti∈τn
|ti+1 −ti| −→
n 0.
Deﬁnition 2.2.1. Let X be a real-valued continuous function on
[0, ∞). If, for all t ≥0, the limit
⟨X⟩t = lim
n

ti ∈τn
ti ≤t
(Xti+1 −Xti)2
(3)
exists, the function t −→⟨X⟩t is called the quadratic variation of X.
Remark 2.1. Following Foellmer (1981) we start with the study of
the paths of a real-valued stochastic process, i.e. a real-valued function
t −→Xt(ω) for a ﬁxed ω ∈Ω. It will be shown later, that Deﬁnition
2.2.1 and the following results are, for almost all ω ∈Ω, independent
of the particular choice of the partition sequence (τn).
3 The F¨ollmer approach also applies to jump-diﬀusion processes. In these notes we
restrict ourselves deliberately to continuous processes.

2.2 Quadratic Variation and 1-dimensional Itˆo-Formula
19
Remark 2.2. Unlike the total variation Vt of X, for the quadratic
variation one has
⟨X⟩t ̸= sup
π

ti∈π
(Xti+1 −Xti)2
where the supremum is taken over all partitions
π = (0 = t0 < . . . < tn = t) of [0, t]. As will be shown, for the Brownian
motion one has ⟨X⟩t = t for almost all paths. However, the right-hand
side equals +∞, for almost all paths (see L´evy (1965)).
Proposition 2.2.2. X ∈FV(IR+) =⇒⟨Xt⟩≡0
for all t ≥0
Proof. One has, for any t ≥0,

t≥ti∈τn
(Xti+1 −Xti)2 ≤sup |Xti+1 −Xti| ·

|Xti+1 −Xti|.
Vt(X) < ∞implies that the second term is bounded. By continuity of
X the ﬁrst term converges to zero with |ti+1 −ti| −→
n 0.
⊓⊔
The above proposition implies that functions Xt with positive quadratic
variation ⟨X⟩t are of unbounded total variation. Hence the integral

f(Xt) dXt cannot be deﬁned as a ’classical’ Lebesgue-Stieltjes inte-
gral.
However t −→⟨X⟩t is a positive and isotone function and thus belongs
to FV(IR+). Hence, as shown in Sect. 1.3,
µ([0, t]) := ⟨X⟩t
deﬁnes a positive measure µ on (IR+, B) and the integral

f(s) dµ(s) =

f(s) d⟨X⟩s
with respect to the quadratic variation ⟨X⟩is well-deﬁned as Lebesgue-
Stieltjes integral.
Remark 2.3. The convergence (3) can be interpreted as weak conver-
gence of measures µn deﬁned by
µn =

ti∈τn

Xti+1 −Xti
2
δti
where δti denotes the Dirac measure with total mass one in t = ti. Then
the sequence (µn) converges weakly to the measure µ with dµ = d⟨X⟩.

20
2 Introduction to Itˆo-Calculus
Lemma 2.2.3. Let f be a real-valued continuous function on [0, t].
Then one has

ti ∈τn
ti ≤t
f(ti) (Xti+1 −Xti)2 =

f 1[0,t] dµn
−−−→
n↑∞

f 1[0,t] dµ =
t

0
f(s) d⟨X⟩s.
Quadratic Variation of the Brownian motion
Deﬁnition 2.2.4. A real-valued stochastic process (Bt)0≤t<∞on a
probability space (Ω, F, P) is called ’standard Brownian motion’
, if
(i) B0 = 0
(ii) t −→Bt(ω) is a continuous function P-a.s.
(iii) the increments Bt −Bs are independent and have normal distribu-
tion N(0, t −s), for any 0 ≤s < t.
Theorem 2.2.5. (L´evy) For P-almost all paths t −→Bt(ω) one has
⟨B⟩t(ω) = t
∀t ≥0,
(4)
Proof. It suﬃces prove the claim for a ﬁxed t0 ∈Q+, the set of non-
negative rational numbers. Then, since Q+ is countable, ⟨B⟩t(ω) = t
P-a.s for all t ∈Q+ which by P-a.s continuity of the paths implies P-a.s
convergence for all t ∈IR+.
Consider the sequence
Xn :=

ti ∈τn
ti ≤t0
(Bti+1 −Bti



=:Yi
)2 =

i
Y 2
i .
By condition (iii) the Yi are independent with normal distribution
N(0, ∆ti+1). One has
E[Y 2
i ] = σ2(Yi) = ∆ti+1
σ2(Y 2
i ) = E[Y 4
i ] −E[Y 2
i ]2 = 3σ4(Yi) −(∆ti+1)2 = 2(∆ti+1)2.

2.2 Quadratic Variation and 1-dimensional Itˆo-Formula
21
From the Central Limit Theorem it follows that, for suﬃciently large
n, the Xn are approximately distributed with normal distribution
N
 
i
∆ti , 2

i
(∆ti)2
Clearly, for n →∞, these distributions converge to N(t0, 0). Hence Xn
converges weakly to the constant t0, which (see section 1.2.(c)) implies
P −
lim
(τn)n=1,2,...
Xn = t0.
But this implies (see Sect. 1.2.(a)) that there exists a subsequence (τn′)
of (τn) such that
⟨B⟩t = lim Xn′ = t0 P −a.s..
⊓⊔
An immediate consequence of L´evy’s theorem is the following
Corollary 2.2.6. For any t > 0 , the paths of the Brownian motion
are of unbounded variation on the interval [0, t].
Theorem 2.2.7. (Itˆo’s formula in IR1) : Let X : [0, ∞) −→IR1 be
a continuous function with continuous quadratic variation ⟨X⟩t, and
F ∈C2(IR1) a twice continuously diﬀerentiable real function. Then for
any t ≥0
F(Xt) = F(X0) +
t

0
F ′(Xs) dXs + 1
2
t

0
F ′′(Xs) d⟨X⟩s
(5)
where
t

0
F ′(Xs) dXs = lim
n↑∞

ti ∈τn
ti ≤t
F ′(Xti) (Xti+1 −Xti)
(6)
= limit of non-anticipating Riemann sums
(i.e F ′ is evaluated at the left end of the interval)
= Itˆo integral of F ′(Xt) w.r.t. Xt

22
2 Introduction to Itˆo-Calculus
Remark 2.4. The Itˆo formula is often written in short notation as
dF(X) = F ′(X) dX + 1
2 F ′′(X) d⟨X⟩
(7)
called the stochastic diﬀerential of F(X). This is nothing else as an
equivalent notation for the relation (5). To make it meaningful the two
integrals in (5) must be well-deﬁned. This is the case for the second
integral which is well-deﬁned as Lebesgue-Stieltjes integral, since the
quadratic variation ⟨X⟩t is of ﬁnite variation (see Sect. 1.3). The im-
portant contribution of Itˆo consists in developing a well-deﬁned concept
for integrals of the ﬁrst type, where the integrator is of unbounded vari-
ation. The existence of the limit (6) is shown in the following proof.
Remark 2.5. For non-continuous functions X we refer to Foellmer
(1981) or Protter (1990)
Proof of the Theorem: Let t > 0 , ti ∈τn , ti ≤t. By Taylor’s theorem
one has
F(Xti+1) −F(Xti) = F ′(Xti) (Xti+1 −Xti



∆Xti
)
+ 1
2 F ′′(Xti) (∆Xti)2
ti ∈(ti, ti+1)
= F ′(Xti) ∆Xti + 1
2 F ′′(Xti) (∆Xti)2
+ 1
2

F ′′(Xti) −F ′′(Xti)

(∆Xti)2



Rn(ti)
Deﬁne δn =
max
ti∈τn,ti≤t |∆Xti|. Since F ′′ is uniformly continuous on
X[0, t], it follows
|Rn(ti)| ≤1
2
max
|x −y| ≤δn
x, y ∈X[0, t]
|F ′′(x) −F ′′(y)| (∆Xti)2
≤ϵn(∆Xti)2
for some ϵn > 0, which converges to zero as δn →0.

2.2 Quadratic Variation and 1-dimensional Itˆo-Formula
23
For n −→∞it follows
a)


t≥ti∈τn
Rn(ti)
 ≤ϵn ·

t≥ti∈τn
(∆Xti)2



bounded
−−−→
n↑∞0 .
b)

t≥ti∈τn
(F(Xti+1 −F(Xti)) −−−→
n↑∞F(Xt) −F(X0)
c)
 1
2 F ′′(Xti) (∆Xti)2 −−−→
n↑∞
1
2
t

0
F ′′(Xs) d⟨Xs⟩.
(Observe that the left-hand side of b) is an alternating sum, hence
all intermediate members cancel, and the sums in c) converge to the
Lebesgue-Stieltjes integral.)
Hence also

F ′(Xti) ∆Xti must converge and there exists
lim
n

t≥ti∈τn
F ′(Xti) ∆Xti =:
t

0
F ′(Xs) dXs.
□
Corollary 2.2.8. In the classical case (⟨X⟩≡0 or X ∈FV) Itˆo’s
formula reduces to
F(Xt) = F(X0) +
t

0
F ′(Xs) dXs
or in short notation, for X ∈C1,
dF(X) = F ′(X) dX = F ′(X) ˙X dt.

24
2 Introduction to Itˆo-Calculus
Examples:
1) F(x) = xn implies
Xn
t = Xn
0 + n
t

0
Xn−1
s
dXs + n(n −1)
2
t

0
Xn−2
s
d⟨X⟩s,
or in short notation
d(Xn) = n Xn−1 dX + n(n −1)
2
Xn−2 d⟨X⟩.
In particular, for n = 2 and Xt = Bt standard Brownian motion, it
follows
B2
t = 2
t

0
Bs. dBs +
t

0
d⟨B⟩s



=t
.
2) F(x) = eX implies
d(eX) = eX dX + 1
2 eX d⟨X⟩,
(i.e.
dF = F dX no longer holds for F(Xt) = eXt with ⟨X⟩̸≡0) .
3) F(x) = log x implies
d(log X) = dX
X −
1
2X2 d⟨X⟩.
Proposition 2.2.9. Let Xt = Mt + At with X and M continuous
and A ∈FV. Then the QV ⟨X⟩exists if and only if ⟨M⟩exists, and
⟨X⟩= ⟨M⟩.
Proof.

(∆X)2 =

(∆M)2 +

(∆A)2



−→
n
0
+2

∆M · ∆A


∆M · ∆A
 ≤sup
ti∈τn
|Mti+1 −Mti|



−→
n
0
·

|Ati+1 −Ati|



bounded
.
⊓⊔

2.2 Quadratic Variation and 1-dimensional Itˆo-Formula
25
Proposition 2.2.10. For F ∈C1 the quadratic variation of F(Xt) is
given by
⟨F(X)⟩t =
t

0
F ′(Xs)2 d⟨X⟩s
Proof. Consider t > 0, ti ∈τn, ti ≤t. By Taylor’s theorem one has, for
some ti ∈(ti, ti+1),
|F(Xti+1) −F(Xti)|2 = F(Xti)2(∆Xti)2
+ 1
2 (F ′(Xti) −F ′(Xti))2(∆Xti)2.
Since F ′ is uniformly continuous on X[t, 0] , it follows (see proof of
Theorem 2.2.7)

t≥ti∈τn
(F(Xti+1)−F(Xti))2 =

F ′(Xti)2 (∆Xti)2



−−−−−−−−→
Lemma 2.2.3
t
0
F ′(Xs)2d⟨Xs⟩
+ ϵn

(∆Xti)2



−−−→
n↑∞0
⊓⊔
Corollary 2.2.11. For f ∈C1 the Itˆo integral
Mt =
t

0
f(Xs) dXs
has the quadratic variation
⟨M⟩t =
t

0
f2(Xs) d⟨X⟩s.
Proof. (for the case that there exists a primitive function F with F ′ =
f) In this case the Itˆo formula for F(Xt) is
F(Xt) = F(X0) + Mt + 1
2
t

0
f′(Xs)d⟨X⟩s.

26
2 Introduction to Itˆo-Calculus
Thus, from Propositions 2.2.9 and 2.2.10, it follows
=⇒⟨M⟩t = ⟨F(X)⟩t =
t

0
(F ′)2 (Xs) d⟨X⟩s.
⊓⊔
Example: Mt =
t

0
Bs dBs has, according to Corollary 2.2.11, the
quadratic variation
⟨M⟩t =
t

0
B2
s d⟨B⟩s =
t

0
B2
s ds =⇒d⟨M⟩t = B2
t dt.
2.3 Covariation and Multidimensional Itˆo-Formula
Consider two functions X, Y ∈C0[0, ∞) with continuous quadratic
variations ⟨X⟩and ⟨Y ⟩w.r.t. to the (ﬁxed) partition sequence (τn).
We shall see later that all concepts developed w.r.t. to (τn) are inde-
pendent of the choice of this particular sequence.
Deﬁnition 2.3.1. If for any
t ≥0
⟨X, Y ⟩t = lim
n↑∞

ti ∈τn
ti ≤t
(Xti+1 −Xti)(Yti+1 −Yti)
exists, then the map t →⟨X, Y ⟩t is called the covariation of X and Y.
Proposition 2.3.2. ⟨X, Y ⟩exists if, and only if, ⟨X + Y ⟩exists, and
one has
⟨X, Y ⟩= 1
2

⟨X + Y ⟩−⟨X⟩−⟨Y ⟩

(Polarization formula).

2.3 Covariation and Multidimensional Itˆo-Formula
27
Proof. Follows immediately from
⟨X + Y ⟩t = lim

(∆X + ∆Y )2
= lim(

∆X2 +

∆Y 2 + 2

∆X∆Y )
⊓⊔
Remark 2.6. The polarization formula is obviously equivalent to
⟨X + Y ⟩= ⟨X⟩+ ⟨Y ⟩+ 2⟨X, Y ⟩
(8)
(compare the variance of the sum of two random variables).
Example Let Xt(w), Yt(w) be two independent Brownian motions on
(Ω, F, P). Then one has
⟨X, Y ⟩t(w) = 0
P-a.s.
∀t ≥0.
This follows from the fact that Xt + Yt
√
2
is again the Brownian motion
Hence ⟨X + Y ⟩t = 2t which by (8) implies ⟨X, Y ⟩≡0.
Remark 2.7. The covariation ⟨X, Y ⟩is the distribution function of a
signed measure µ = µ+ −µ−on [0, ∞) (see Sect. 1.3).
Proposition 2.3.3. Consider f, g ∈C1 and their Itˆo integrals
Yt =
t

0
f(Xs) dXs
Zt =
t

0
g(Xs) dXs
w.r.t. to Xt. Then their covariation is ⟨Y, Z⟩t =
t

0
f(Xs) g(Xs) d⟨X⟩s

28
2 Introduction to Itˆo-Calculus
Proof. From Corollary 2.2.11 it follows
⟨Y + Z⟩t =

t

0
(f + g)(Xs) dXs

t
=
t

0
(f + g)2(Xs) d⟨X⟩s
= ⟨Y ⟩t + ⟨Z⟩t + 2
t

0
(f · g) (Xs) d⟨X⟩s.
The proposition thus follows from the polarization formula resp.
formula (8).
⊓⊔
Let now X = (X1, . . . , Xd) : [0, ∞) −→IRd be continuous (i.e
X ∈C0[0, ∞)d) with continuous covariation
⟨Xk, Xl⟩t =
⎧
⎪
⎨
⎪
⎩
⟨Xk⟩t
k = l
1
2

⟨Xk + Xl⟩t −⟨Xk⟩t −⟨Xl⟩t

k ̸= l
Example: Brownian motion on IRd realized on Ω= C[0, ∞)d, i.e
Bt = (B1
t , . . . , Bd
t )
P =
d
i=1
Pi
Pi =Wiener measure
=⇒⟨Bk, Bl⟩t = t δkl P-a.s.,
where δkl =

1 k = l
0 k ̸= l
(For existence of Bt and the construction of the Wiener measure on the
path space C0[0, ∞)d see e.g. Bauer (1996))

2.3 Covariation and Multidimensional Itˆo-Formula
29
Given F ∈C2(IRd), we use the following notations:
∇F(x) =
 ∂F
∂x1
, . . . , ∂F
∂xd

(x) =

Fx1(x), . . . , Fxd(x)

= gradient of F
∆F(x) =
d

i=1
Fxi,xi(x) = Laplace-operator, i.e. ∆=
d

i=1
∂2
∂x2
i
dF(x) = ( ∇F(x), dx



scalar product
) =

i
Fxi(x) dxi

˙xi dt
classical diﬀerential.
Theorem 2.3.4. (d-dimensional Itˆo-formula): For F ∈C2(IRd) one
has
F(Xt) = F(X0) +
t

0
∇F(Xs) dXs



Itˆo integral
+1
2
d

k,l=1
t

0
Fxk,xl(Xs) d⟨Xk, Xl⟩s,
and the limit lim
n

ti ∈τn
ti ≤t

∇F(Xti), (Xti+1 −Xti)

=:
t

0
∇F(Xs) dXs
exists.
Proof. The proof is analogous to that of Prop. 2.2.7 by applying the
d-dimensional Taylor-formula to the discrete increments of F.
⊓⊔
In diﬀerential form the Itˆo-formula can be written as
dF(Xt) =

∇F(Xt), dXt

+ 1
2

k,l
∂2F
∂xk ∂xl
(Xt) d⟨Xk, Xl⟩t
which is the chain rule for stochastic diﬀerentials.
Example: For the d-dimensional Brownian motion Bt = (B1
t , . . . , Bd
t ),
⟨Bk, Bl⟩t = t δkl implies

30
2 Introduction to Itˆo-Calculus
dF(Bt) =

∇F(Bt), dBt

+ 1
2 ∆F(Bt) dt.
Corollary 2.3.5. (Product rule for Itˆo calculus):
For X, Y with continuous ⟨X⟩, ⟨Y ⟩, ⟨X, Y ⟩it follows
d(X · Y ) = X dY + Y dX + d⟨X, Y ⟩
i.e.
Xt Yt = X0 Y0 +
t

0
Xs dYs +
t

0
Ys dXs + ⟨X, Y ⟩t.
(9)
Proof. Apply Itˆo’s formula for d = 2 to the function F(X, Y ) = X ·Y ∈
C2(IR2)
⊓⊔
Remark 2.8. For Y ∈FV it follows that ⟨X + Y ⟩= ⟨X⟩, and hence
⟨Y ⟩= 0. Thus (9) takes the form
t

0
Ys dXs = Xt Yt −X0 Y0 −
t

0
Xs dYs
(10)
which is the classical partial integration formula. Observe that Xt may
be of inﬁnite variation, since the integral on the right-hand side is well-
deﬁned as Stieltjes integral, for Yt ∈FV . By this observation Wiener
ﬁrst obtained a “stochastic” integral for the integrator Xt = Bt and
Yt = h(t) a deterministic function, the so-called Wiener integral.
Corollary 2.3.6. (Itˆo’s formula for a time-dependent function)
For F ∈C2,1(IR2
+) and X : IR+ −→IR continuous with continuous ⟨X⟩
one has
1) F(X, t) = F(X0, 0) +
t

0
Fx(Xs, s) dXs +
t

0
Ft(Xs, s) ds
+1
2
t

0
Fxx(Xs, s) d⟨X⟩s
2) F(X, ⟨X⟩t) = F(X0, 0) +
t

0
Fx(Xs, ⟨X⟩s) dXs
+
t

0
(1
2 Fxx + Ft) (Xs, ⟨Xs⟩) d⟨X⟩s.

2.4 Examples
31
Proof. Apply Itˆo’s formula for d = 2, to F(X, Y ) and choose Yt = t
resp. Yt = ⟨X⟩t.
⊓⊔
Remark 2.9. The transformation t −→⟨X⟩t is called time change
according to the “interior clock” of the process Xt. In particular, if
F(X, t) satisﬁes the diﬀerential equation (dual heat equation)
1
2 Fxx + Ft = 0
(11)
it follows
F(X, ⟨X⟩t) = F(X0, 0) +
t

0
Fx(Xs, ⟨X⟩s) dXs.
(12)
2.4 Examples
1) dG = α G dX
(X0 = 0)
We show that the above stochastic diﬀerential equation (short:
SDE) has the solution
Gt = G0 +
t

0
α Gs dXs = G0 E(α Xt)
where E(Xt) := exp{Xt −1
2 ⟨X⟩t} is the so called stochastic expo-
nential or the Dol´eans-Dade exponential of Yt
Proof. F(x, t) = G0 exp

αx−1
2 α2t

satisﬁes the dual heat equa-
tion (11). Hence by (12), it follows
Gt = F(Xt , ⟨X⟩t) = G0E(αXt)
=⇒Gt −G0 = F(Xt , ⟨X⟩t) −F(X0, 0)
=
(12)
t

0
Fx(Xs , ⟨X⟩s) dXs =
t

0
α Gs dXs.
⊓⊔

32
2 Introduction to Itˆo-Calculus
Remark 2.10. Clearly, for ⟨X⟩t ≡0 one obtains the classical so-
lution Gt = G0 · eα Xt.
2) dG = µ G dt + σ G dX
Here a drift term µ is added. Using the previous result, it is easy
to check that
Gt = G0 E(σ Xt) eµ t = G0 exp

µ t + σ Xt −1
2 σ2⟨X⟩t

is a solution of the above SDE.
3) dSt
St
= µ(t) dt + σ(t) dBt
The above SDE deﬁnes a diﬀusion or Itˆo process. It is the standard
model used in ﬁnance for the returns of a security price process St
with inﬁnitesimal drift µ(t)dt and stochastic noise σ(t)dBt, where
σ(t) is called the volatility of St.
We show that the SDE has the solution
St = S0 exp

t

0

µ(s) −1
2 σ2(s)

ds +
t

0
σ(s) dBs

.
(13)
Proof. We give a proof using Itˆo’s product formula. The process
(13) can be written as
St = S0 exp

t

0
µ(s) ds

· E(Mt) = Yt · Zt
with Mt =
t

0
σ(s) dBs and ⟨M⟩t =
t

0
σ2(s) ds.
Since Yt is of ﬁnite variation, the product rule implies
dSt = Yt dZt + Zt dYt + d⟨Yt, Zt⟩
= Yt Zt dMt + Zt Yt µ(t) dt + 0
= St σ(t) dBt + St µ(t) dt.
⊓⊔

2.5 First Application to Financial Markets
33
2.5 First Application to Financial Markets
We consider a ﬁnancial market with only one security without interest
and divided payments. This market is modelled as follows:
(Ω, (Ft)t≥0, P) is a ﬁltered probability space, i.e., (Ft) is a family of
σ-algebras with Fs ⊂Ft
for s < t, representing the information
available at time t.
Xt = Xt(ω) is the price process of the security adapted to the ﬁltration
(Ft), i.e. Xt is Ft-measurable, for all t ≥0.
φt = φt(ω) is another stochastic process adapted to Ft, called a
portfolio strategy.
φt = φt(ω) denotes the number of shares of the security held by an
investor at time t in state ω. Adaptation to (Ft) means that the invest-
ment decision can only be based on the information available at time
t.
Given the portfolio strategy φt, the value of the portfolio at time t
is of the form
Vt = φtXt + ηt = V (Xt, t)
(14)
where ηt is a money account, yielding no interest.
A portfolio strategy ( short p.s.) is called self-ﬁnancing if, after an
initial investment V0 = η0, all changes in the value of the portfolio Vt
are only due to the accumulated gains (or losses) resulting from price
changes of Xt. Formally this means
Deﬁnition 2.5.1. The p.s. φt is self-ﬁnancing ←→
def.
Vt = V0+
t
0
φs dXs
←→dV = φ dX.
Recall that the Itˆo integral in (2.5.1) is deﬁned as
t

0
φs dXs := lim
n

t≥ti∈τn
φ(ti) (Xti+1 −Xti),

34
2 Introduction to Itˆo-Calculus
which means that φ(ti) has to be ﬁxed at the beginning of each invest-
ment interval. In other words: the Itˆo integral is non-anticipating, and
hence the appropriate concept for ﬁnance (in contrast to other stochas-
tic integrals like e.g. the Stratonovich integral).
Applying Itˆo’s formula to the value process V yields
dV = Vx dX + ˙V dt + 1
2 Vxx d⟨X⟩
= φ dX + ˙V dt + 1
2 Vxx d⟨X⟩
Hence φ is self-ﬁnancing if, and only if, V satisﬁes the diﬀerential equa-
tion
˙V dt + 1
2 Vxx d⟨X⟩= 0
(15)
for all t > 0,
where ˙V =
∂
∂tV (x, t).
Consequence: Let H = F(XT ) be a contingent claim (e.g. a ”call”
option H = (XT −K)+). If there exists a self-ﬁnancing p.s. φt with
VT = H then the arbitrage price Vt = V (Xt, t) of H at the time t
satisﬁes the partial diﬀerential equation (PDE) (15) with boundary
condition
V (XT , T) = H
and for any 0 ≤t ≤T
V (Xt, t) = V (X0, 0) +
t

0
Vx(Xs, s) dXs
Remark 2.11. For Xt = St as deﬁned in example 2.4.3 (Black-Scholes
model), one has d⟨X⟩t = σ2
t X2
t dt and (15) is equivalent to the (PDE)
˙V + 1
2 σ2 X2 Vxx = 0
This is the classical approach to option pricing, as pioneered by Black-
Scholes (1973) and Merton (1973), which leads to the solution of PDE’s
under boundary conditions.

2.5 First Application to Financial Markets
35
Assume now that there exists an additional security Yt = ert, i.e a
bond with ﬁxed compounded interest rate r > 0. Consider the follow-
ing portfolio strategy:
•
buy one contingent claim H at price V ,
•
sell φ = Vx shares of security X.
The value of this portfolio is
Π = V −Vx X.
According to Itˆo’s formula it follows
dΠ = dV −Vx dX = ˙V dt + 1
2 Vxx σ2X2 dt.
(16)
But, whereas the return dXt(ω) depends on ω, the right-hand side
of (16) does not, since X2
t (ω) is ﬁxed at t. Hence the portfolio Π is
riskless and by the no-arbitrage principle its return must equal the
riskless interest rate, i.e.
d Π = r Π dt.
(17)
Combining (16) and (17) gives the PDE
˙V + r X Vx + 1
2 σ2 X2 Vxx = r · V
(Black-Scholes PDE).
(18)
This PDE holds for any derivative of the form F(XT ). A simple example
is a forward contract on XT ﬁxed at time t = 0 at price K. It is easy
to check that
F(t) = Xt −K e−r(T−t) = V (Xt, t)
is the (unique) solution of (18) under the boundary constraint
F(T) = V (XT , T) = XT −K.

36
2 Introduction to Itˆo-Calculus
2.6 Stopping Times and Local Martingales
In the previous sections we have concentrated on real-valued func-
tions and shown how Itˆo’s calculus comes into play for functions of
unbounded variations. The concepts of integration and diﬀerentiation
of such functions are quite independent of any probability concept and
should indeed be considered as part of the calculus of real-valued func-
tions4. But such functions were considered as rather exotic and unin-
teresting for practical applications and thus neglected in the ’classical’
calculus5. Only the study of stochastic processes brought up the need
for such an extension of the classical calculus. As will be shown in the
following sections, the paths of non-trivial stochastic processes are of
unbounded variation.
We now consider stochastic processes X deﬁned on a probability space
(Ω, F, P) with real-valued continuous paths Xt(ω). Of course all con-
cepts developed for real-valued functions in the previous sections apply
to the paths of such processes.
In the following (Ω, (Ft)t≥0, P) always denotes a probability space with
right-continuous ﬁltration satisfying the usual conditions:
(i) Ft is a σ-algebra for all t ≥0
(ii) Fs ⊂Ft for s < t
(iii) Fs =

s<t
Ft for all s ≥0.
A stochastic process X = (Xt)t≥0 on (Ω, (Ft)) is called adapted if, for
any t, Xt is Ft-measurable, i.e.
{Xt ≤α} ∈Ft
∀α ∈IR.
or, shortly, Xt ∈Ft.
4 This was ﬁrst observed by Foellmer (1981) in his fundamental article ’Calcul de
Itˆo sans probabilit´e’ (see the Appendix for an English translation of this article).
5 The ﬁrst example of a function of unbounded variation is due to the 19th-century
mathematician Weierstraß, who constructed a continuous real-valued function
which is nowhere diﬀerentiable.

2.6 Stopping Times and Local Martingales
37
Deﬁnition 2.6.1. A stochastic process M on (Ω, (Ft), P) is called a
martingale, if
(i) (Mt) is adapted and integrable (i.e. Mt ∈L1(Ω, Ft, P)
∀t ≥0, )
(ii) E[Mt|Fs] = Ms P-a.s., for all 0 ≤s ≤t.
Remark 2.12. For a stochastic process X on a probability space
(Ω, F, P) consider the following ﬁltration:
F0
t := σ(Xs : s ≤t) σ-algebra generated by the sets
{Xs ≤α : s ≤t , α ∈IR}
Ft :=

t<u
F0
u
right-continuous modiﬁcation.
(Ft) is called the natural ﬁltration generated by (Xt). Clearly, if X has
right-continuous paths, Ft = F0
t .
Lemma 2.6.2. (Mt) martingale =⇒E[(Mt −M0)2] = E[M2
t ]−E[M2
0 ].
Proof. (Mt −M0)2 = M2
t −M 2
0 −2 M0 (Mt −M0)
=⇒E[(Mt −M0)2] = E[M2
t −M2
0 ] −2E

M0 E[Mt −M0|F0]



=0

⊓⊔
Examples of martingales:
Let B = (Bt)t≥0 be a Brownian motion on (Ω, F, P) with natural ﬁl-
tration (Ft)t≥0.
(e.g. Ω
= C[0, ∞) = all continuous paths
(Ft)
ﬁltration generated by (Bt)
F
= F∞= σ(Bt : t ≥0)
P
= Wiener measure)

38
2 Introduction to Itˆo-Calculus
Proposition 2.6.3. The following processes are martingales with re-
spect to the ﬁltration (Ft):
(1) Bt
(2) B2
t −t
(3) St = S0 exp

σ Bt −1
2 σ2 t

= S0 E(σ Bt).
Proof. (i) The processes are clearly adapted. Integrability follows from
(1) E[B2
t ] = t < ∞=⇒Bt ∈L2 ⊂L1,
(2) E[|St|] = E[St] = S0 exp

−1
2 σ2 t

· E[eσBt]
  
=exp{(1/2) σ2 t}
= S0 ∈L1.
Remark 2.13.
X ∼N(µ, σ2) =⇒E[eX] = exp{µ + 1
2 σ2}.
(ii) (1) Bt+h −Bt independent of Bt
=⇒E

Bt + h
  
s
−Bt
Ft

= E[Bt+h −Bt] = 0
=⇒E[Bs|Ft] = Bt + E[Bs −Bt|Ft]



=0
s ≥t.
(2) E[B2
t+h −B2
t |Ft] = E

(Bt+h −Bt)2 + 2 (Bt+h −Bt) Bt | Ft

= h + 2 Bt E[Bt+h −Bt|Ft]



=0
= h.
(3) E[St+h|Ft] = E

S0 E(σ Bt)



St
E

σ(Bt+h −Bt)
Ft

= St E

exp

σ(Bt+h −Bt) −1
2 σ2 h




=1
.
⊓⊔

2.6 Stopping Times and Local Martingales
39
Stopping Times
Deﬁnition 2.6.4. The random variable T : Ω−→[0, ∞] is called a
stopping time if
[T ≤t] ∈Ft
(t ≥0).
(19)
Lemma 2.6.5. For a right-continuous ﬁltration the condition (19) is
equivalent to
[T < t] ∈Ft
(t ≥0).
Proof. (=⇒) [T < t] = 
n
[T ≤t −1
n]



∈Ft−1/n
∈Ft
(⇐=) [T ≤t] = 
ϵ>0
[T < t + ϵ]



∈Ft+ϵ
right-continuous
=⇒
[T ≤t] ∈Ft
⊓⊔
Lemma 2.6.6. Every stopping time is a decreasing limit of discrete
stopping times.
Proof. Consider the sequence
Dn =

K 2−nK = 0, 1, 2, . . .

n=1,2,...
of dyadic partitions of the interval [0, ∞). Deﬁne, for any n,
Tn(ω) =

K 2−n if T(ω) ∈[(K −1) 2−n , K 2−n)
+∞if T(ω) = ∞
Clearly,
[Tn ≤d] = [Tn < d] ∈Fd
for d = K 2−n ∈Dn
and
[Tn ≤t] =

t≥d∈Dn
[Tn = d] ∈Ft.
Hence (Tn) are stopping times and Tn(ω) ↓T(ω)
∀ω ∈Ω.
⊓⊔

40
2 Introduction to Itˆo-Calculus
Deﬁnition 2.6.7. Let T be a stopping time.
FT :=

A ∈F∞: A ∩{T ≤t} ∈Ft
∀t ≥0

is called the σ-algebra of T-observable events.
Clearly, for discrete Tn, FTn is a σ-algebra. Hence, by Lemma 2.6.6,
FT = 
n
FTn
is a σ-algebra.
FT contains all events which are observable up to the stopping time T.
This is illustrated in the following Fig. 2.1, where Ω= {ω1, . . . , ω8}
is the set of all paths from t = 0 to t = 3 and FT = σ{A1, A2, A3}.
gestoppt
A1
A2
A3
w
t=0
t=1
t=3
t=2
Fig. 2.1. Tree of FT -observable events
Remark 2.14. One has
FT = σ{XT : X all adapted c`adl`ag processes }
(Protter (1990), p.6)
Lemma 2.6.8. For an adapted, right-continuous process X the map
XT : Ω−→(IRd, Bd)
ω −→XT (ω) := XT(ω)(ω)
is FT -measurable.

2.6 Stopping Times and Local Martingales
41
Proof. From Lemma 2.6.6 take Tn ↓T and d ∈Dn.
1) For XTn ∈FTn and B ∈Bd, t ≥0 it follows
{XTn ∈B} ∩{Tn ≤t} =

t≥d∈Dn
{XTn ∈B} ∩{Tn = d}
=

t≥d∈Dn
{Xd ∈B}



∈Fd



∈Ft
.
2) (Xt) right-continuous =⇒XT = lim
n XTn
∀ω ∈Ω
=⇒XT FT -measurable with

n
FTn = FT .
⊓⊔
For any stopping time T, one has

*
HHHHHH
j
T
XT
(XT∧t)t≥0
random variable on FT
new stoch. process adapted to FT
One of the most useful theorems of probability theory is the following
so-called ’Optional Stopping Theorem’.
Theorem 2.6.9. Let (Xt)t≥0 be a real-valued process which is adapted,
integrable and c`adl`ag.
The following statements are equivalent:
(i) (Xt)t≥0 is a martingale,
(ii) E[XT ] = E[X0] for any bounded stopping time T
(i.e. T(ω) ≤c
∀ω ∈Ω) ,
(iii) E[XT |FS] = XS for any bounded stopping times S ≤T.
Proof. We use the following notation:

A
Xs dP =: E[Xs 1A] =: E[Xs; A].

42
2 Introduction to Itˆo-Calculus
For Xt ∈L1 ∈(Ω, Ft, P) it then follows
(Xt) martingale ⇐⇒E[Xs; A] = E[Xt; A]
∀s ≤t
∀A ∈Fs.
(i) =⇒(ii):
Let T ≤c, and let Tn ↓T be a discretization with partition Dn (com-
pare Lemma 2.6.6), and A ∈FTn. Then it follows
E[XTn; A] =

d∈Dn
E[Xd ; A ∩{Tn = d}



=∅for d>c
]
=

d∈Dn
E[Xc ; A ∩{Tn = d}] , since X is a martingale
= E[Xc; A].
In particular E[XTn] = E[Xc; Ω] = E[X0].
Since XT = lim
n XTn P-a.s., Lebesgue’s theorem implies E[XT ] = E[X0].
(ii) =⇒(iii):
Let A ∈Fs , S ≤T ≤c. Deﬁne new stopping time
ˆS(ω) :=

S(ω) ω ∈A
T(ω) ω ∈Ac
Since ˆS and T are bounded, (ii) implies
E[X ˆS] = E[X0] = E[XT ] = E[XT ; A] + E[XT ; Ac].
On the other hand
E[X ˆS] = E[XS; A] + E[XT ; Ac],
which together with the above equation implies E[XS; A] = E[XT ; A].
(iii) =⇒(i):
Set
S ≡s and T ≡t
⊓⊔
Remark 2.15. By Lebesgue’s theorem the optional stopping theorem
also holds for ﬁnite stopping times T < ∞, P-a.s., for (XT∧n) uni-
formly integrable.

2.6 Stopping Times and Local Martingales
43
As an application of the optional stopping theorem we consider the
hitting times of a Brownian motion for an interval a ≤0 < b deﬁned
by
Ta,b(ω) := min{t : Bt(ω) /∈[a, b]}.
Proposition 2.6.10. P[BTa,b = b] =
|a|
b −a , P[BTa,b = a] =
b
b −a,
and
E[Ta,b] = |a| · b.
Proof.
1) 0 = E[B0] = E[BT ] = b · P[BT = b] + a (1 −P[BT = b])
=⇒P[BT = b] =
−a
b −a.
2) (B2
t −t) martingale
=⇒0 = E[B2
0 −0] = E[B2
T∧n −T ∧n]
=⇒E[B2
T∧n] = E[T ∧n] ↑E[T] (Beppo-Levi) .
On the other hand E[B2
T∧n] −−−→
n↑∞E[B2
T ], and it follows
E[T] = E[B2
T ] = b2 P[BT = b] + a2 P[BT = a]
=⇒E[T] = |a| · b.
⊓⊔
Corollary 2.6.11. For the hitting time of b > 0, Tb(ω) = inf{t :
Bt(ω) > b}, it follows
Tb < ∞P-a.s., but E[Tb] = +∞.
Proof.
P[Tb < ∞] = lim
a↓−∞P[Ta,b] = lim
|a|
b + |a| = 1
E[Tb] ≥E[Ta,b] = |a| · b −−−−→
a↓−∞∞
⊓⊔

44
2 Introduction to Itˆo-Calculus
Remark 2.16. This result is rather discouraging for gamblers who
follow the “realize-modest-gains” strategy, i.e. choose some b > 0, con-
tinue with ﬁxed stake till the cumulated gains reach the bound b, then
stop. If the game is “fair”, then, for any b > 0, the gains will surpass b
in ﬁnite time with probability one. But even for arbitrary small b > 0,
the average waiting for this to happen is inﬁnite. In the meantime the
cumulated losses can become arbitrarily large.
2.7 Local Martingales and Semimartingales
An important result of stochastic calculus is that Itˆo integrals with re-
spect to a martingale are again martingales. This is, however, not quite
correct: it is true for the class of local martingales, and more generally
for semimartingales.
Deﬁnition 2.7.1. An adapted c`adl`ag process (Mt)t≥0 is called a local
martingale, if there exist stopping times T1 ≤T2 ≤. . . such that
(i) sup
n Tn = ∞a.s.
(ii) (MTn∧t) is a martingale for all n.
Remark 2.17. By deﬁning new stopping times T ′
n = Tn ∧n the lo-
calizing sequence in the above deﬁnition can always be assumed to be
bounded (which implies that the martingales (MT ′n∧t) are uniformly in-
tegrable, as required in some standard textbooks). Furthermore, if M is
continuous, by setting Sn = inf{t : |Xt| > n} and T ′
n = Tn∧Sn one may
assume the martingales to be bounded (see Revuz-Yor (1991),p.117).
The following deﬁnition extends the Itˆo integral of stochastic integrands
with respect to local martingales in a straightforward way.
Deﬁnition 2.7.2. Let (Ht)t≥0 be an adapted c`adl`ag process and (Xt)t≥0
a continuous local martingale. If the following limit exists for all t ≥0
P-a.s.

2.7 Local Martingales and Semimartingales
45
Mt(ω) = lim
n

t≥ti∈τn
Hti(ω) (Xti+1(ω) −Xti(ω))
then Mt =
 t
0
Hs dXs is called the stochastic integral of (Ht) with
respect to (Xt).
Remark 2.18. We will see soon that this deﬁnition also does not de-
pend on the speciﬁc partition sequence (τn).
Theorem 2.7.3.
Mt =
t

0
Hs dXs
(20)
is a local martingale.
Proof. 1) First assume (Xt) and (Ht) are bounded, i.e.
|Xt(ω)| ≤k
and
|Ht(ω)| ≤l
∀t, ω.
We show (Mt)t≥0 is a L2-martingale. Deﬁne
M n
t :=

t≥ti∈τn
Hti (Xti+1 −Xti).
a) E[(Mn
t )2] =

E

H2
ti (Xti+1 −Xti)2
≤l2

t≥ti∈τn
E

X2
ti+1 −X2
ti −2 Xti (Xti+1 −Xti)

= l2 E

X2
tj −X2
t0

≤l2 c0 < ∞
where tj = inf{ti ∈τn : ti > t}, since E[Xti+1 −Xti] = 0
and the remaining term is an alternating sum.
=⇒M n
t ∈L2 and bounded .
b) Mn
t is a martingale, for any t = ti ∈τn
E

Mn
ti+1 −Mn
ti|Fti

= Hti E

(Xti+1 −Xti)|Fti

= 0
since X is a martingale.

46
2 Introduction to Itˆo-Calculus
c) Let s < t , As ∈Fs. To show:
E[Ms; As] = E[Mt; As].
(21)
Choose sn, tn ∈τn with s < sn < t < tn and sn ↓s , tn ↓t.
s < sn −→As ∈Fsn −→
b) E[Mn
sn; As] = E[Mn
tn; As].
Mn
sn(ω) −→Ms(ω) P-f.s.
M n
tn(ω) −→Mt(ω) P-f.s.

=⇒
Lebesgue(21)
2) The general case can be reduced to 1) by deﬁning the following
stopping times
Sn(ω) = inf{t : |Xt(ω)| > n}
Un(ω) = inf{t : |Ht(ω)| > n}.
Consider the stopping time Vn = Sn ∧Un ∧Tn where Tn is a local-
izing sequence of bounded stopping times for (Xt). By assumption
(XTn∧t) is a martingale. Since Vn ≤Tn, the stopping theorem im-
plies that (XVn∧t) is a martingale, and hence by 1) also (MVn∧t).
Clearly Vn ↑∞. Hence (Mt) is a local martingale.
⊓⊔
Corollary 2.7.4. If (Xt) is a local martingale, then
X2
t −⟨X⟩t
(t ≥0) is a local martingale.
Proof. dX2 =
Itˆo2 X dX + d⟨X⟩, i.e.
X2
t −⟨X⟩t = X2
0 + 2
t

0
Xs dXs



local martingale
.
⊓⊔

2.7 Local Martingales and Semimartingales
47
Corollary 2.7.5. Let X be a continuous local martingale with ⟨X⟩≡0
P-a.s. Then
Xt(ω) ≡X0(ω)
P-a.s.,
i.e., continuous local martingales with paths of ﬁnite variation are triv-
ial stochastic processes.
Proof. Mt = X2
t −⟨X⟩t = X2
t is a local martingale.
Let Tn = T ′
n ∧T ′′
n be a joint localizing sequence for Xt and X2
t .
=⇒(XTn∧t) , (X2
Tn∧t) are martingales. Hence if follows:
0 ≤E[(Xt −X0)2]
=
(Xt cont.)E

lim
n (XTn∧t −X0)2
≤
(Fatou) lim inf
n E

(XTn∧t −X0)2
=
(XTn∧t mart.)lim inf E

X2
Tn∧t −X2
0

=
(X2
Tn∧t mart.)
0
=⇒P[Xt = X0
∀t ∈Q] = 1
=⇒
(Xt cont.) P[Xt = X0
∀t] = 1
⊓⊔
Now we are able to prove the
Independence of the calculus from (τn):
Let X be a continuous local martingale. Then
X2
t = X2
0 + 2
t

0
Xs dXs + ⟨X⟩t.
Assume there exist two partition sequences (τ (1)
n ) and (τ (2)
n ) with

48
2 Introduction to Itˆo-Calculus
X2
t −X2
0 =

Itˆo integral(1) + ⟨X⟩(1)
t
Itˆo integral(2) + ⟨X⟩(2)
t
Then Mt = ⟨X⟩(1)
t
−⟨X⟩(2)
t , as the diﬀerence of two Itˆo integrals, is a
local martingale with paths of ﬁnite variation. Hence by corollary 2.7.5
Mt(ω) = M0 = 0
P −a.s.
But this implies
⟨X⟩(1)
t
−⟨X⟩(2)
t
≡0
P −a.s.
and
Itˆo integral(1) ≡Itˆo integral(2)
P −a.s.
The same argument applies to the stochastic integral Mt =
 t
0
Hs dXs,
since Mt is a continuous local martingale.
We end this section with several suﬃcient conditions for a local mar-
tingale to be actually a martingale.
Proposition 2.7.6. Let M be a local martingale. The following con-
ditions are suﬃcient for M to be a martingale (see Protter (1990)
Theorem47 (p.35) and Theorem27, Corollary 3 (p.66)):
1) E[sup
s≤t
|Ms|] < ∞
∀t ≥0 =⇒M is a martingale .
2) E[sup
t
|Mt|] < ∞=⇒M uniformly integrable martingale
(in particular M bounded) .
3) E[⟨M⟩t] < ∞
∀t ≥0 =⇒M is a L2-martingale and M2 −⟨M⟩
is a
L1-martingale .
Condition 3) is clearly satisﬁed by the Brownian motion (Bt)t≥0, since
E[⟨B⟩t] = t < ∞. Hence B is a L2-martingale and B2 −⟨B⟩L1-
martingale.
Condition 3) has an interesting interpretation. Let M be a local mar-
tingale satisfying 3). Then it follows, for any t > 0,
M 2
t −⟨M⟩t
martingale =⇒E

E[M2
t −⟨M⟩t|F0]



M2
0 −0

= E[M2
0 ].

2.8 Itˆo’s Representation Theorem
49
Thus
E[M2
t ] = E[M2
0 ] + E[⟨M⟩t], which implies
Var[Mt]



local in t
= E[M2
t ] −(E[Mt]
  
E[M0]
)2 =
E[⟨M⟩t]



global on [0,t]
.
I.e. the variance of M at time t equals the average quadratic variation
of all paths of M on the interval [0, t].
According to Theorem2.7.3 the class of local martingales is closed with
respect to stochastic integration. This property extends to the larger
class of semimartingales.
Deﬁnition 2.7.7. A continuous stochastic process X is called a semi-
martingale, if there exists a decomposition
Xt = X0 + Mt + At
with M0 = A0 = 0, M a local martingale and A a process of ﬁnite
variation.
If H is another semimartingale, for which

H dX exists, it follows

H dX =

H dM



local mart.
+

H dA



∈FV
.
Hence

H dX is again a semimartingale.
2.8 Itˆo’s Representation Theorem
Let B be a Brownian motion and H an adapted process. A suﬃcient
condition for the stochastic integral Mt =
 t
0 Hs dBs to be a martingale
(see Prop. 2.7.6 (3)) is
E[⟨M⟩t] = E

t

0
H2
s ds

< ∞
∀t

50
2 Introduction to Itˆo-Calculus
which implies that M is a L2-martingale and M2−⟨M⟩a L1-martingale.
The following theorem (see e.g. Revuz-Yor (1991) p.187) shows that
the converse also holds.
Theorem 2.8.1. (Itˆo’s representation theorem)
Let B a Brownian motion on (Ω, (Ft), P) with “natural” ﬁltration
(generated by (Bt) and all P-null sets) and M a L2-martingale on
(Ft, P).Then there exists an adapted process H with
E

t

0
H2
s ds
 
< ∞
t ≥0
such that
Mt = M0 +
t

0
Hs dBs
∀t ≥0.
2.9 Application to Option Pricing
Let B denote again a Brownian motion on (Ω, (Ft), P) with natural
ﬁltration.
Let (St)t≥0 be a price process adapted to (Ft) and C an option depend-
ing on the paths of (St)0≤t≤T , for some ﬁxed T.
Examples: C(ω) = [ST (ω) −K]+
call option
C(ω) = max
0≤t≤T St(ω)
lookback option
C(ω) = [ST (ω) −K]+ · 1{St(ω)>L ∀t≤T} knock-out call
(L < inf{S0, K})
Then C is a FT -measurable so-called contingent claim. Assume there
exists a self-ﬁnancing trading strategy (φt)0≤t≤T which generates C,
i.e. there exists a value process

2.9 Application to Option Pricing
51
Vt = V0 +
t

0
φs dSs
0 ≤t ≤T
with
VT = C.
If St is a martingale, according to Theorem 2.7.3 Vt is a local mar-
tingale, and, under suitable conditions on C (see Prop. 2.7.6), a mar-
tingale. Hence
Vt = E[VT |Ft] = E[C|Ft]
is the arbitrage price of C at time t.
In particular
V0 = E[C].
Existence of (φt):
If C is square-integrable, i.e. C ∈L2(FT , P), by Itˆo’s representation
Theorem (see Theorem 2.8.1) there exists an adapted process (Ht)0≤t≤T
with
E

T

0
H2
s ds

< ∞,
and
C = E[C] +
T

0
Hs dBs .
Assume St = S0 exp

σ Bt −1
2 σ2 t

= S0 · E(σ Bt) .
=⇒St is (Ft)-martingale with dSt = σ St dBt
=⇒C = E[C] +
T

0
Hs dBs = E[C]

premium
+
T

0
Hs
σ Ss
  
φs
dSs .

52
2 Introduction to Itˆo-Calculus
For the call option C = [ST −K]+ it follows
E[C] =

Ω
[ST (ω) −K]+ P(dω) =

[ST >K]
ST dP −K · P[ST > K]
= S0 Φ(g(K)) −K · Φ(h(K))
(22)
with
g(K) = ln(S0/K)
σ
√
T
+ 1
2 σ
√
T
h(K) = g(K) −σ
√
T
Φ(x) =
1
√
2π
x

−∞
e−1
2 z2dz
(standard normal distribution)
which is the Black-Scholes formula for r = 0.
This is the martingale approach to option pricing.
Proof. (of equation (22))
F(x) = P[ST ≤x]
distribution function of ST
= P[ln ST ≤ln x] = P

ln S0 + σ BT −1
2 σ2 T ≤ln x

= P

σ BT ≤ln x −ln S0 + 1
2 σ2 T

= P

 BT
√
T
≤ln(x/S0)
σ
√
T
+ 1
2 σ
√
T



−h(x)

= Φ(−h(x)).
Hence
K · P[ST > K] = K(1 −Φ(−h(K)) = K · Φ(h(K))
f(x) = F ′(x) = Φ′(−h(x)) d
dx (−h(x))
= ϕ(h(x))
1
x σ
√
T
= density of F(x)
with
ϕ(h) =
1
√
2π e−h2
2
density of N(0,1).

2.9 Application to Option Pricing
53
Lemma 2.9.1. g = h + σ
√
T =⇒ϕ(g(x)) = ϕ(h(x)) x
S0
(The proof is left for exercise).
It follows

[ST ≥K]
ST dP =
∞

K
x f(x) dx =
∞

K
ϕ(h(x))
σ
√
T
dx = S0
∞

K
ϕ(g(x))
x σ
√
T
dx
= S0

−Φ(g(x))
∞
K = S0 Φ(g(K)).
⊓⊔
Remark 2.19. The above example illustrates the martingale approach
to option pricing. It was pioneered by Harrison-Kreps (1979) and
Harrison-Pliska (1981) and has proved as a powerful tool in ﬁnance.
Whereas the original Black-Scholes approach leads to solving PDE’s
under boundary constraints, the martingale technique leads to option
prices as expectations under the “martingale measure”. This technique
will be developed in detail in Chap. 4. The Feynman-Kac Theorem es-
tablishes a relation between these two apparently so diﬀerent approaches
(see Sect. 4.3).
In the above example we have assumed that the security price process
St is already a martingale. But in general St will only be a semimartin-
gale under the given probability measure P. The technique of how to
transform P into an “equivalent martingale measure” is developed in
Chap. 3.

3
The Girsanov Transformation
The Girsanov transformation is an important tool in mathematical ﬁ-
nance. We ﬁrst give a heuristic introduction taken from Foellmer (1991)
(see also Karatzas-Shreve (1988), Sect.3.5). Using only elementary facts
of independent normally distributed random variables, it leads to the
Dol´eans-Dade exponential as new density under a change of measure
for the Brownian motion.
Sect. 3.2 deals with the Girsanov transformation in general form, as
can be found in Revuz-Yor (1991). The proofs are straightforward ap-
plications of tools developed in Chap. 2. This section, which at ﬁrst
sight looks rather abstract, is basic for the applications to ﬁnance in
Chapters 4 and 5, where the general Girsanov transformation is repeat-
edly used.
Sect. 3.3 treats the special case of the Brownian motion.
3.1 Heuristic Introduction
Following Foellmer (1991) we ﬁrst give a heuristic derivation of the Gir-
sanov transformation for the 1-dimensional Brownian motion based on
elementary probability concepts. This heuristic will help to understand
what happens under the Girsanov transformation.
Let X be a random variable (r.v.) on (Ω, F, P) which is standard-
normal, in short X ∼N(0, 1).

56
3 The Girsanov Transformation
=⇒P[X ≤a] =
1
√
2π
a

−∞
e−1
2 x2dx =
a

−∞
f(x)

n0,1(x)
dx
Consider now another density function:
!f(x) = e(µx−1
2 µ2)f(x).
=⇒!P[X ≤a] =
1
√
2π
a

−∞
e−1
2 (x−µ)2dx =
a

−∞
nµ,1(x) dx
=⇒X ∼N(µ, 1) under !P
Observe that the r.v. X has not been changed, but its distribution
has changed under the new measure !P.
Remark 3.1. Clearly !PX ∼PX and the Radon-Nikodym derivative is
d !PX
dPX
(x) = e(µx−1
2 µ2).
Under !P the r.v. !
X = X −µ has now the distribution N(0, 1), i.e.
PX
≡
!P !
X
distribution of X
distribution of !
X
under P
≡
under !P
For X ∼N(0, σ2) under P
X ∼N(µ, σ2) under !P (↔!
X = X −µ ∼N(0, σ2) under !P)
it follows
d !PX
dPX
(x) = nµ,σ2(x)
n0,σ2(x) = e
1
σ2 (µx−1
2 µ2).

3.1 Heuristic Introduction
57
Application to Brownian Motion
Let (Bt)0≤t≤1 be a BM on (Ω, (F)t, P).
=⇒Bt ∼N(0, t) under P
and ∆Bt = Bt+∆t −Bt ∼N(0, ∆t), independent of Bt
Consider now a BM with drift
!Bt = Bt −
t

0
Hs ds
for some stochastic process (Hs)0≤s≤1.
Question: Under which measure !P is ( !Bt) again a BM (without drift) ?
We discretize the unit interval [0, 1] by ti = i
n
(i = 0 . . . n).
It follows
B j
n =
j

i=1
B i
n −B i−1
n



:=Xi∼N(0,∆t) under P
j = 1 . . . n
n
i=1
N(0, ∆t)
joint distribution of X1, . . . , Xn (under P)
!
Xi = Xi −H i−1
n · ∆t



µi
=⇒!
Xi ∼N(0, ∆t) under !P
with Radon-Nikodym-derivative e
1
∆t (µixi−1
2 µ2
i ) w.r.t. P.

58
3 The Girsanov Transformation
Joint distribution of !
Xi under !P
d !P (n) =
n
"
i=1
exp
 1
∆t

H i−1
n ∆t · Xi −1
2 H2
i−1
n ∆t2
dP (n)
= exp

n

i=1
H i−1
n (B i
n −B i−1
n ) −1
2
n

i=1
H2
i−1
n ∆t

dP (n)
” −−−→
n→∞” exp

1

0
Hs dBs −1
2
1

0
H2
s ds

dP
(1)
=⇒
!P = E(L1) P
with L1 =
1

0
Hs dBs
= exp{L1 −1
2 ⟨L1⟩} · P
Remark 3.2. E(L1) = exp{L1 −1
2 ⟨L1⟩} is called the “stochastic ex-
ponential” or the “Dol´eans-Dade” exponential.
The limit process (1) is of course only a heuristic argument. A mathe-
matically rigorous derivation follows in Sect. 3.2 and 3.3.
3.2 The General Girsanov Transformation
Let (Ω, (Ft)0≤t, P) satisfy the usual conditions, i.e. the ﬁltration is right
continuous, complete and F∞= σ(
t
Ft).
M(c)
loc(P) := all (continuous) local martingales w.r.t. P
Deﬁnition 3.2.1. X is called P-semimartingale ⇐⇒
Def. X = M + A
with M ∈Mloc(P) and A ∈FV.

3.2 The General Girsanov Transformation
59
Let Q be another probability measure on (Ω, F∞).
Deﬁnition 3.2.2.
(i) Q << P ⇐⇒
Def. P[A] = 0 =⇒Q[A] = 0
∀A ∈F∞
(ii) Q ∼P ⇐⇒
Def. Q << P and P << Q
(i.e. Q and P have identical null sets)
Proposition 3.2.3. (Radon-Nikodym)
Let Q << P. Then there exists Z ∈L1(Ω, F∞) with Q = Z P, i.e.
Q[A] =

A
Z(ω) P(dω)
∀A ∈F∞
Notation:
Z = dQ
dP
=⇒Zt = EP [Z|Ft] = EP

dQ
dP |Ft

is a right continuous martingale, EP [Zt] ≡1. Furthermore
(i) Zt(ω) > 0
Q-a.s.
(ii) Zt = dQt
dPt
on Ft
Lemma 3.2.4. Let Q ∼P. Then one has
X ∈Mc
loc(Q) ←→X Z ∈Mc
loc(P).
Proof. Let s < t , A ∈Fs. Is X a martingale, then obviously
EQ[Xs; A] = EQ[Xt; A] ⇐⇒EP [Xs Zs; A] = EP [Xt Zt; A].
(2)
Let Tn ↑∞be a localizing stopping time for X. It follows
Q = ZTnP on FTn =⇒(2) for XTn, XTn ZTn
⊓⊔

60
3 The Girsanov Transformation
Notation: Following Protter (1990) we use the following short notation
for stochastic integrals: H •X =

HdX. Evaluating these processes at
t, we have
H • Xt =
t

0
HsdXs = H0X0 +

(0,t]
HsdXs
Theorem 3.2.5. (Girsanov)
Let Q << P with Z = dQ
dP continuous.
It follows
M ∈Mc
loc(P) =⇒#
M = M −Z−1 • ⟨M, Z⟩∈Mc
loc(Q)
(i.e.
#
Mt = Mt −
t

0
1
Zs
d⟨M, Z⟩s).
Proof. According to Lemma 3.2.4 one has to show: #
M Z ∈Mc
loc(P)
#
Mt Zt = #
M0 Z0 +
t

0
#
Ms dZs +
t

0
Zs d#
Ms + ⟨#
M, Z⟩t
= #
M0 Z0 +
t

0
#
Ms dZs



∈Mloc(P)
+
t

0
Zs dMs



∈Mloc(P)
−⟨M, Z⟩t + ⟨#
M, Z⟩t



=0 since #
M−M∈FV
⊓⊔
Let now Q ∼P.
Q << P −→Z = dQ
dP
> 0
Q-a.s.
P << Q −→Z
also P-a.s. strictly positive
Lemma 3.2.6. Any strictly positive process (Zt) can be represented as
Zt = exp

Lt −1
2 ⟨L⟩t

= E(L)t
with
Lt = log Z0 +
t

0
Z−1
s
dZs.

3.2 The General Girsanov Transformation
61
Proof.
Itˆo =⇒log Zt = log Z0 +
t

0
Z−1
s
dZs



Lt
−1
2
t

0
Z−2
s
d⟨Z⟩s



⟨L⟩t
,
since by Corollary 2.2.11
Mt =
t

0
f(Xs) dXs =⇒⟨M⟩t =
t

0
f2(Xs) d⟨X⟩s.
⊓⊔
Proposition 3.2.7. (Girsanov for Q ∼P): Let Q = E(L) · P. Then
one has
M ∈Mc
loc(P) ⇐⇒#
M = M −⟨M, L⟩∈Mc
loc(Q)
and
P = E(−L) · Q.
Proof. #
M = M −Z−1 • ⟨M, Z⟩∈Mc
loc(Q)
(Girsanov) , and
Lt = log Z0 +
t

0
1
Zs
dZs, i.e. L = Z−1 • Z. Thus
⟨M, L⟩t = ⟨M, Z−1 • Z⟩t =
t

0
Z−1
s
d⟨M, Z⟩s = (Z−1 • ⟨M, Z⟩)t
↑
computational rule for ⟨X, Y ⟩.
L ∈Mc
loc(P) −→−L = −L + ⟨L, L⟩
  
=⟨L⟩
∈Mc
loc(Q)
P = E(L)−1 · Q
E(L)−1
t
= exp

−Lt + 1
2 ⟨L⟩t

= exp

−Lt −1
2 ⟨L⟩t

=⟨L⟩t

= E(−L)t.

62
3 The Girsanov Transformation
Conversely one has
#
M ∈Mc
loc(Q) −→#
#
M = #
M −⟨#
M, −L⟩∈Mc
loc(P)
= #
M + ⟨#
M, L⟩
  
⟨M,L⟩
= M.
⊓⊔
Computational rule for covariation of stochastic integrals:
(see Protter (1990) , Theorem29, p.68)
Proposition 3.2.8. X, Y continuous semimartingales,
H, K admissible integrands (w.r.t. X, Y )
Then one has
⟨H • X, K • Y ⟩t =
t

0
Hs Ks d⟨X, Y ⟩s.
Remark 3.3. X = M + A
Y = N + B
M, N ∈M(c)
loc
=⇒⟨X, Y ⟩= ⟨M, N⟩
In particular, it follows:
⟨H • M, N⟩t =
t

0
Hs d⟨M, N⟩s
and
⟨M⟩=
$ t

0
f(X) dXs
%
= ⟨f(X) • X, f(X) • X⟩t =
t

0
f2(Xs) d⟨X⟩s.

3.3 Application to Brownian Motion
63
3.3 Application to Brownian Motion
Girsanov solves the following problem:
Given : X ∈Mloc(P)
Q ∼P

=⇒
Girsanov

X ∈Mloc(Q)
We now consider the inverse problem:
Given a semimartigale X = M +A w.r.t. P, i.e. M ∈Mloc(P), A ∈FV
∃Q ∼P :
X ∈Mloc(Q) ??
I.e., we are looking for a P-equivalent measure Q under which X is
a martingale (so-called equivalent martingale measure).
Approach: Q = E(L) · P
Girsanov =⇒#
M = M −⟨M, L⟩∈Mloc(Q)
#
M = X ⇐⇒A = −⟨M, L⟩.
However, there are two problems:
1) Determination of L
2) Under what conditions is Q = E(L) · P a probability measure ??
ad 2:
Q prob. measure ←→EP [E(L)t] ≡1
(3)
←→E(L)t is a martingale (since L0 = 0).
A suﬃcient condition for E(L)t to be a martingale is the so-called
Novikov condition (see e.g. Revuz-Yor (1991), p.308):
E

exp{1
2 ⟨L⟩t}

< ∞
∀t .
(4)
ad 1:
Solution for semimartingales of Brownian motion
Let Xt = Bt +
t

0
Hs ds



Drift =A

64
3 The Girsanov Transformation
with (Bt)0≤t≤T Brownian motion w.r.t. P and Ht(ω) adapted,
c`adl`ag (e.g. Ht = f(Bs; s ≤t)) .
Claim:
Lt = −
t

0
Hs dBs solves the problem.
Proof.
−⟨B, L⟩t = ⟨B, H • B⟩t =
t

0
Hs d⟨B⟩s =
t

0
Hs ds = A
=⇒Xt ∈Mloc(Q) for Q = E(L) · P.
⊓⊔
Furthermore it follows
⟨X⟩t = ⟨B⟩t = t < ∞=⇒(Xt)
L2-martingale.
It even follows: (Xt) is a Brownian motion w.r.t. Q ! This follows from
L´evy’s theorem:
(Xt) ∈Mc
loc(P) , ⟨X⟩t = t ∀t ≥0
P-a.s. =⇒(Xt) is B.M. w.r.t. P.
Example of a non-continuous local martingale with ⟨X⟩t = t:
Xt Poisson-Process (with parameter λ); i.e.
P[Xt = K] = e−λt (λ t)K
K!
,
E[Xt] = λ t = Var(Xt)
=⇒Mt = Xt −λ t martingale and M2
t −λ t martingale
=⇒⟨M⟩t = λ t
Thus for λ = 1, Mt is a martingale with ⟨M⟩t = t , but not contin-
uous.

3.3 Application to Brownian Motion
65
Same procedure for d-dimensional Brownian motion:
Let Bt = (B1
t , . . . , Bd
t ) be d-dimensional Brownian motion, i.e. (Bi
t)
(i = 1, . . . , d) are independent one-dimensional Brownian motions.
Proposition 3.3.1. (L´evy) For an (Ft)-adapted continuous d-dimens-
ional process Xt = (X1
t , . . . , Xd
t ) with X0 = 0 the following statements
are equivalent:
(i) X is a Brownian motion w.r.t. (Ft)
(ii) X is a continuous local martingale mit ⟨Xi, Xj⟩t = δij · t
∀i, j = 1 . . . d.
Proof. see Revuz-Yor (1991), p.141 .
⊓⊔
Proposition 3.3.2. (Girsanov for d-dimensional Brownian motion)
Let Xt = Bt +
t

0
Hs ds be a d-dimensional process with
E
&
exp
1
2
T

0
||Hs||2 ds
'
< ∞
(Novikov condition).
(5)
Deﬁne Q as dQ
dP = E

−
T

0
Hs dBs

.
Then under Q (Xt) is a d-dimensional Brownian motion for 0 ≤t ≤T.

4
Application to Financial Economics
In this chapter the methods developed in Chapter 2 and 3 are applied
to derive the fundamentals of “ﬁnancial economics” in continuous time,
such as the market price of risk, the no-arbitrage principle, the funda-
mental pricing rule and its invariance under numeraire changes, and
the forward measure, a useful tool to deal with stochastic interest rates.
Special emphasis is laid on the economic interpretation of the so-called
“risk-neutral” arbitrage measure and its relation to the “real world”
measure considered in general equilibrium theory, a topic sometimes
leading to confusion between economists and ﬁnancial engineers.
Using the general Girsanov transformation, as developed in Sect. 3.2,
the rather intricate problem of the change of numeraire can be treated
in a rigorous manner, and the so-called “two-country” or “Siegel” para-
dox serves as an illustration. The section on Feynman-Kac relates the
martingale approach used explicitly in these notes to the more classical
approach based on partial diﬀerential equations.

68
4 Application to Financial Economics
4.1 The Market Price of Risk and Risk-neutral Valuation
We consider an economy depending on d independent stochastic factors
modelled by a d-dimensional Brownian motion Bt = (B1
t , . . . , Bd
t ) on
the ﬁltered probability space (Ω, (Ft)0≤t≤T , P).
Let X be a security with returns
dXt
Xt
= µX(t) dt +
σX(t) ◦dBt



scalar product in IRd
0 ≤t ≤T
(1)
where µX(t), σX(t) = (σ1
X, ..., σd
X) are adapted processes on (Ω, (Ft), P)
We assume that there exists a Lebesgue-integrable real function φX(t)
on [0, T], such that |µX(t, ω)| ≤φX(t) and ||σX(t, ω)||2 ≤φX(t) P-a.s.
Remark 4.1. A process of the form (1) is a (positive) Itˆo-process.
Every strictly positive diﬀusion process Xt can be written as an Itˆo-
process by taking its logarithm (compare Lemma 3.2.6).
Furthermore we consider the following processes:
r(t) = r(t, ω) an adapted and bounded process of the “spot” inter-
est rate,
β(t) = β(t, ω) = exp
t

0
r(s, ω) ds the accumulation process .
β(t) is the “savings” account by rolling over one monetary unit at
the prevailing spot rate. Clearly, β(t) is an adapted continuous process
of ﬁnite variation.
Deﬁnition 4.1.1. Let λ(t) = (λ1, . . . , λd)t be an adapted process with
µX(t) = r(t) + λ(t) ◦σX(t)
(2)
= r(t) +
d

i=1
λi(t) σi
X(t).
Then λ(t) is called the process of the “market price of risk” and λi(t)
the price of the i-th risk-factor .

4.1 The Market Price of Risk and Risk-neutral Valuation
69
Remark 4.2. For d = 1 the relation (2) can be written as
E

dXt
Xt |Ft

−r(t) dt
(
Var

dXt
Xt |Ft

= λ(t) dt
which can be interpreted as the (expected) excess return per risk unit.
Let now Y be another security with
dYt
Yt
= µY (t) dt + σY (t) ◦dBt.
Let λX(t) and λY (t) be the corresponding risk price processes of X and
Y .
We assume that the underlying economy is in an equilibrium state, i.e.
all price processes X(t), Y (t), r(t) etc. are determined by supply and
demand of the agents in this economy. In order to determine such an
equilibrium one would have to know the consumption and investment
behavior of each agent depending on his initial endowment, preferences
over consumption streams, expectations and attitude towards risk, a
formidable task. The power of ﬁnancial economics consists in working
with a much weaker condition, which certainly is necessary for an econ-
omy to be in equilibrium, namely the condition of “No arbitrage”, i.e.
the absence of arbitrage proﬁts without taking risks. Such an arbitrage
opportunity would exist if, at any time t and any state ω, one could
form a riskless portfolio which has a higher return than the riskless in-
terest rate r(t, ω). By “No arbitrage” we mean that such an arbitrage
opportunity does not exist.

70
4 Application to Financial Economics
The fundamental consequence of the above assumption is the following
theorem:
Theorem 4.1.2. “No arbitrage” implies
λX(t, ω) = λY (t, ω)
for all (t, ω) ∈[0, T) × Ω.
Proof. We give a proof for d = 1 (for d > 1 see Ingersoll (1987)).
Assume there exists (t, ω) with λX(t, ω) > λY (t, ω). We may assume
that 0 < σX(t, ω) < σY (t, ω) (otherwise replace φ by −φ in the follow-
ing deﬁnition of φ).
Choose at time t the following portfolio of X and Y :
φX =
σY
(σY −σX) · Xt
,
φY = −
σX
(σY −σX) · Yt
.
The value of this portfolio is
Vt(φ) = φX Xt + φY Yt = 1
and its return
dVt = φX dXt + φY dYt
=
1
σY −σX

(σY µX −σX µY



µV
) dt + (σY σX −σX σY ) dBt



≡0

Hence Vt has a riskless return
µV =
1
σY −σX

σY (rt + λX σX) −σX(rt + λY σY )

= rt + σY · σX
σY −σX



>0
(λX −λY



>0
) > rt
which is in contradiction to the “No arbitrage” condition.
⊓⊔

4.1 The Market Price of Risk and Risk-neutral Valuation
71
Question: When is the process λ(t) P-a.s. uniquely determined ?
Assume there exist n securities X1, . . . , Xn with

(t) =
⎛
⎜
⎜
⎜
⎜
⎝
σX1(t)
.
.
.
σXn(t)
⎞
⎟
⎟
⎟
⎟
⎠
(n × d)-matrix of volatilities
and
µ(t)
=
⎛
⎜
⎜
⎜
⎜
⎝
µX1(t)
.
.
.
µXn(t)
⎞
⎟
⎟
⎟
⎟
⎠
, e =
⎛
⎜
⎜
⎜
⎜
⎝
1
.
.
.
1
⎞
⎟
⎟
⎟
⎟
⎠
.
No arbitrage implies
µ(t) = r(t) · e +

(t) ◦λ(t).
Hence λ(t, ω) is uniquely determined if and only if the stochastic ma-
trix

(t, ω) has full rank d, for all t, P-a.s.
Clearly a necessary condition is n ≥d, i.e. there must be at least
as many securities as stochastic factors in the economy. A suﬃcient
condition for d = 1 is σX(t, ω) > 0 for all t, ω.
Elimination of λ(t) by means of Girsanov:
Assume that the Novikov condition
E

exp{1
2
T

0
||λ(s)||2 ds}

< ∞
(3)
is fulﬁlled. Deﬁne
Lt = −
t

0
λ(s) ◦dBs
0 ≤t ≤T
P ∗= E(L) · P
, P ∗∼P.
Then the Girsanov theorem implies for each security price process Xt:

72
4 Application to Financial Economics
dXt
Xt
= µX(t) dt + σX(t) dBt = r(t) dt + σX(t) (dBt + λ(t) dt)
= r(t) dt + σX(t) dB∗
t
and B∗
t is a d-dimensional Brownian motion under P ∗.
Remark 4.3. Clearly P ∗is unique if λ(t) is unique.
Interpretation of P and P ∗:
We can interpret the original measure P as the (objective) ”real-world”
measure or, in the equilibrium interpretation, as the (subjective) ex-
pectation of the “representative investor”. For the equilibrium price
process Xt with respect to P one has
EP

dX
X |Ft

= r(t) dt + λ(t) σX(t) dt
(under P)
(4)
with λ(t) := market price of risk (varies with P !).
The measure P ∗can be interpreted as the expectation of a risk-neutral
investor, since
EP ∗

dX
X |Ft

= r(t) dt + zero-premium (under P ∗).
(5)
The relation (5) has been called by Cox-Ingersoll-Ross (1981) the “Lo-
cal Expectation Hypothesis”, a terminology which has led to some con-
fusion. Note that the equilibrium process has not been changed, it is
the same under both measures P and P ∗. Girsanov’s Theorem allows
us to replace the relation (4) through the equivalent simpler relation
(5). In particular, no assumption has been made about the existence
of risk-neutral investors. In a real economy neither a “representative”
nor a “risk-neutral” investor will exist, since both assumptions would
prevent the existence of a (stable) equilibrium. The great advantage of
the representation (5) under the (martingale) measure P ∗is that we
do not have to know anything about the individual expectations P and
the investors’ attitude towards risk.
In summary: Xt has not been changed. It is the same equilibrium
price process as under P, but in simpler representation under P ∗. P ∗is
called the “equivalent risk-neutral measure” or the “P-equivalent mar-
tingale measure”.

4.2 The Fundamental Pricing Rule
73
4.2 The Fundamental Pricing Rule
Let Zt > 0 be the price process of an arbitrary security without divi-
dend payments in [0, T] with dynamics
dZt
Zt
= µZ(t) dt + σZ(t) ◦dBt
(Itˆo-process under P).
with µZ(t), σZ(t) adapted processes as deﬁned in Sect. 4.1 .
Remark 4.4. Any strictly positive semimartingale of the Brownian
motion can be written as an Itˆo-process (see Lemma 3.2.6).
Theorem 4.2.1. The discounted process
!Zt = exp

−
t

0
r(s) ds

Zt = Zt
βt
is a martingale under the risk-neutral measure P ∗.
Proof. Under P ∗one has
dZt
Zt
= r(t) dt + σZ(t) dB∗
t .
By Itˆo it follows d !Zt = !Zt σZ(t) dB∗
t , hence !Zt is a local martingale
under P ∗, with solution !Zt = Z0 · E(Nt) where Nt =
t
0
||σZ(s)||2 dBs.
But ⟨N⟩t =
t
0
||σZ(s)||2 ds ≤
t
0
φZ(s) ds < ∞P ∗-a.s., which implies:
E∗
exp{1
2⟨N⟩t}

≤exp{1
2
t

0
φZ(s) ds} < ∞
∀t
and the Novikov condition (see Sect. 3.3 (4)) is satisﬁed. Hence !Zt is a
martingale under P ∗.
⊓⊔
Theorem 4.2.2. (Fundamental Pricing Rule)
Zt = E∗
&
exp

−
T

t
r(s) ds

· ZT
 Ft
'
0 ≤t ≤T
= E∗
 βt
βT
ZT
 Ft

.

74
4 Application to Financial Economics
Proof. Since !ZT is a P ∗- martingale, it follows:
!Zt = E∗[ !ZT
 Ft] = E∗
&
exp

−
T

0
r(s) ds

ZT
 Ft
'
Zt = E∗[βt !ZT
 Ft] = E∗
 βt
βT
ZT
 Ft

.
⊓⊔
Examples:
1. Zt = Pt(T) zero-bond with maturity T, i.e. PT (T) = 1.
=⇒Pt(T) = E∗
&
exp

−
T

t
r(s) ds
  Ft
'
2. Zt = (XT −K)+ call option on security X
=⇒Zt = E∗
&
exp

−
T

t
r(s) ds

(XT −K)+  Ft
'
special case: d = 1 , r(t, ω) ≡r
, σZ(t, ω) ≡σ
=⇒Zt = Xt · Φ(d1) −K · exp{−(T −t
  
s
) · r} Φ(d2)
with
d1,2 = ln(Xt/K · e−rs)
σ√s
± 1
2 σ√s
(Black-Scholes-formula) .
The proof can be given as exercise (or see Sect. 2.9).
Hint: B∗is a Brownian motion under P ∗, i.e.
P ∗[B∗
T ≤x] = Φ
 x
√
T

⇐⇒B∗
T ∼N(0, T)
under P ∗
⇐⇒B∗
T
√
T
∼N(0, 1).

4.2 The Fundamental Pricing Rule
75
Dividend paying securities
Let Z(t) be the price process of a security with continuous dividend
payments given by the dividend rate dZ(t) which is proportional to
Z(t).1 Assume that the dynamics of the (ex dividend) process is given
by
dZt
Zt
= µZ(t) dt + σZ(t) ◦dBt
(ex-dividend process)
(6)
Let Z(t) denote the process with accumulated dividends, i.e.
d Zt
Zt
= (µZ(t) + dZ(t)



µ Z(t)
) dt + σZ(t) ◦dBt
(cum-dividend process) (7)
Denote by ξ(t) = exp{
t
0
dZ(s) ds} the accumulated dividend process.
One easily checks that Zt = ξ(t)·Z(t) is a solution of (7). Since Zt does
not pay dividends, the Fundamental Pricing Rule implies
Zt = E∗
&
exp

−
T

t
r(s) ds

· ZT
 Ft
'
0 ≤t ≤T,
which implies
Zt =
Z(t)
ξ(t) = E∗
&
exp

−
T

t
r(s) ds
 ξ(T)
ξ(t) ZT
 Ft
'
= E∗
&
exp

−
T

t
(r(s) −dZ(s)) ds

ZT
 Ft
'
.
Remark 4.5. Both r(t) and dZ(t) may be stochastic.
1 Although this is an unrealistic assumption for a single stock, which rather pays
lump sum dividends, it is a good approximation to reality for stock indices, and
ﬁts exactly the case where Z(t) is a currency or an exchange rate (see the following
sections).

76
4 Application to Financial Economics
4.3 Connection with the PDE-Approach
(Feynman-Kac Formula)
In Sect. 4.2 general valuation formulas for securities and derivatives
were derived by martingale methods, which lead to the computation
of conditional expectations. The classical approach of Black-Scholes-
Merton is based on the solution of partial diﬀerential equations un-
der boundary conditions. A connection between these two at ﬁrst
sight fundamentally diﬀerent approaches is provided by the so-called
Feynman-Kac formula. If a number of technical conditions is satisﬁed,
the Feynman-Kac formula enables one to switch back and forth be-
tween the martingale and the PDE-approach. In other words, the two
seemingly so diﬀerent approaches appear as two diﬀerent sides of one
coin.
An essential condition for Feynman-Kac is, however, that the underly-
ing security processes have to be markovian diﬀusions, i.e. to be of the
form
dXt = µ(Xt, t) dt + σ(Xt, t) dBt
(8)
with (Bt) a Brownian motion under the measure P.
Feynman-Kac considers the following problem:
Find a solution f(x, t) ∈C2,1(IR × [0, T]) for the PDE
A f(x, t) −r(x, t) f(x, t) = 0
(x, t) ∈IR × [0, T)
(9)
under the boundary condition
f(x, T) = g(x)
x ∈IR
(10)
where
A f(x, t) = ft(x, t) + fx(x, t) µ(x, t) + 1
2 σ2(x, t) fxx(x, t).
(11)
Remark 4.6. A f is the so-called “inﬁnitesimal generator” of f(x, t),
deﬁned as the expected rate of change of f(Xt, t), given Xt = x, i.e.
A f(x, t) = lim
∆→0
1
∆

E[f(Xt+∆, t + ∆)|Xt = x] −f(x, t)

.
From Itˆo’s formula applied to df(Xt, t) and the local martingale property
of the Itˆo-integral one easily derives (11).

4.3 Connection with the PDE-Approach
(Feynman-Kac Formula)
77
The Feynman-Kac solution of (9) till (11), if it exists, is given by the
conditional expectation
f(x, t) = EP

exp

−
T

t
r(Xs, s) ds

g(XT )
Xt = x

(12)
where X is a solution of (8) with Xt = x.
For the necessary technical conditions (besides diﬀerentiability a num-
ber of Lipschitz- and polynomial boundary conditions are required) we
refer to Duﬃe (2001).
Under additional assumptions the solution (12) is unique. In this case
the Feynman-Kac formula also allows switching back: the conditional
expectation (12) can be computed as the solution of the PDE (9) under
the boundary constraint (10).
Application: Let Xt be a security process with return
dXt
Xt
= µX(t) dt + σX(t) dBt,
where µX and σX are deterministic integrable functions of t. Consider
a contingent claim ZT = g(XT ) with g : IR −→IR continuous. By
Girsanov there exists P ∗∼P with
dXt
Xt
= r(t) dt + σX(t) dB∗
t
(13)
Observe: In contrast to the martingale approach r(t) and σX(t) have
to be non-stochastic.
According to the Fundamental Pricing Rule (see Sect. 4.2) one has
Zt = EP ∗

exp

−
T

t
r(s) ds

g(XT )
Xt = x

.
(14)
Setting Zt = f(x, t) ∈C2,1 and
µ(Xt, t) = r(t) · Xt
,
σ(Xt, t) = σX(t) · Xt,
it follows from Feynman-Kac (when the technical FK-conditions are
satisﬁed):

78
4 Application to Financial Economics
Zt = f(x, t)
is solution of the PDE
−r(t) f(x, t)+ ft(x, t)+ r(t) x fx(x, t)+ 1
2 σ2
X(t) x2 fxx(x, t) = 0 (15)
under the boundary constraint
f(x, T) = g(x).
(16)
Thus the solution of (14) is reduced to the solution of the partial dif-
ferential equation (15) under the boundary constraint (16).
(Check the equivalence of equation (15) with the Black-Scholes PDE
in Sect. 2.5 (18)).
4.4 Currency Options and Siegel-Paradox
In nostalgic remembrance of our dear deceased Deutschmark we con-
sider the exchange rate USD/DM. (It is a good exercise to transfer this
and the following sections to the exchange rate EUR/USD).
We use the following notation:
rDM(t) = DM spot rate at t (valid for the period [t, t + dt])
r$(t)
= $ spot-rate at t
Xt
= exchange rate $/DM (price of 1 $ in DM at t)
Note that Xt is a security with continuous dividend payment r$(t).
According to Sect. 4.2 it follows
dXt
Xt
= (rDM(t) −r$(t)) dt + σX(t) dB∗
t
under P ∗
where P ∗is the risk-neutral expectation of a German investor.
Consider now the process Yt = X−1
t
· 100 which is (or was!) the ex-
change as quoted in the US for 1 DM in cents.
Yt is a security with continuous dividend rDM(t). Note that σY (t) =
−σX(t) since ln Yt = −ln Xt + c0.

4.5 Change of Numeraire
79
Question: Does the following relation hold
dYt
Yt
= (r$(t) −rDM(t)) dt + σY (t) dB∗
t
under P ∗
for a risk-neutral American investor ?
Answer: From Itˆo it follows
dYt
Yt
= dX−1
t
X−1
t
=

d 1
Xt

· Xt
d 1
Xt
= −1
X2
t
dXt + 1
2 · 2 · 1
X3
t
d⟨X⟩t
with
d⟨X⟩t = σ2
X(t) X2
t dt.
From σY (t) = −σX(t) it then follows
dYt
Yt
= −dXt
Xt
+ σ2
X(t) dt
=

r$(t) −rDM(t) + σ2
Y (t)

dt + σY (t) dB∗
t
Thus a “risk-neutral” American investor requires a positive risk pre-
mium of σ2
Y (t).
This is the so-called ”Siegel”- or ”Two-Country-Paradox” (see Siegel
(1972), McCulloch (1975)). The solution to this Paradox will be given
in Sect. 4.6.
4.5 Change of Numeraire
A fundamental law in economics - the “Walras law” - implies that
in equilibrium only relative prices can be determined. In order to ob-
tain absolute prices one has to choose one commodity as “numeraire”.
Which commodity is chosen as numeraire is a question of convenience.
The situation is similar in ﬁnancial economics. However, here a non-
trivial technical complication arises: the risk-neutral measure P ∗de-
pends in a crucial way on the choice of the numeraire.

80
4 Application to Financial Economics
Let Xt = (X0
t , . . . , Xn
t )(0≤t≤T) be the price process of n + 1 securities
of the form
dXi
t
Xi
t
= µi(t) dt + σi(t) dBt
under P
with µi(t), σi(t) (i = 0, . . . , n) adapted processes on (Ω, (Ft), P) satis-
fying the boundary condition as deﬁned in Sect. 4.1 .
Usually (X0
t ) is chosen as numeraire, e.g. dX0
t = r(t) X0
t dt (the accu-
mulation process). Then absolute security prices, measured in units of
X0, are given by the normed process
!
Xt =

1, X1
X0 , . . . , Xn
X0

t.
Consider a portfolio strategy (φ)t = (φ0, . . . , φn)t. Then Vt(φ) = φt◦Xt
is the value process with respect to Xt. Similarly !Vt(φ) = φt ◦!
Xt =
Vt(φ) · (X0
t )−1 is the value process with respect to !
Xt.
Recall:
(φt) is self-ﬁnancing w.r.t. Xt ⇐⇒
def
dVt(φ) = φt ◦dXt
⇐⇒Vt(φ) = φ0 ◦X0 +
t

0
φs ◦dXs
= (φ • X)t
0 ≤t ≤T
Recall: (meaning of the diﬀerent ’dots’)
· scalar multiplication
◦scalar product
• stochastic integral
Proposition 4.5.1. φt is self-ﬁnancing with respect to Xt if, and only
if, φt is self-ﬁnancing with respect to !
Xt.
Proof.
(=⇒)
By assumption one has dVt = φt ◦dXt.
Let Yt = (X0
t )−1. According to the rules for the covariation one
has
d⟨V, Y ⟩t = d⟨φ • X, Y ⟩t = φt ◦d⟨X, Y ⟩t .

4.5 Change of Numeraire
81
Thus according to Itˆo’s product rule
d!Vt = d(Vt · Yt) = Vt dYt + Yt dVt + d⟨V, Y ⟩t
= (φt ◦Xt) dYt + Yt(φt ◦dXt) + φt ◦d⟨X, Y ⟩t
= φ ◦

Xt dYt + Yt dXt + d⟨X, Y ⟩t

= φ ◦d(Xt · Yt) = φ ◦d !
Xt
(⇐=)
The procedure is analogous.
⊓⊔
Under the assumptions of Sect. 4.1, ”no arbitrage” and the Girsanov
theorem applied to the ”market price of risk” process λ(t) under the
Novikov condition (3) together with Prop. 4.2.1 imply:
∃P ∗∼P : !
Xt martingale under P ∗, and B∗
t B.M. w.r.t. P ∗.
Let CT ∈FT be a contingent claim with CT = VT (φ) for some self-
ﬁnancing portfolio strategy φ. Consider !CT = CT /X0
T = !VT (φ). Since
d!V = φ d !
X, !V is a local P ∗-martingale. If it is a martingale, then it
follows:
!Ct = E∗[!VT (φ)
 Ft] = E∗[ !CT
 Ft]
Ct = !Ct · X0
t = E∗
 X0
t
X0
T
· CT
 Ft

.
Question: Does the analysis depend on the choice of the numeraire ?
Let now Xi be the numeraire. Consider

Xt =
X0
Xi , . . . , 1, . . . , Xn
Xi

t
security prices measured in Xi ,
V = V
Xi
,
C = C
Xi .
According to Prop. 4.5.1 φ is also self-ﬁnancing with respect to 
X.
Proposition 4.5.2. 
Xt is a martingale under Q∗
i = E(Ni) · P ∗with
Ni(t) =
t

0

σi(s) −σ0(s)



σ !
Xi

dB∗
s
(0 ≤t ≤T)

82
4 Application to Financial Economics
Remark 4.7. For dX0 = X0r(t)dt one has σ0 = 0.
Proof. By assumption on σi and σ0, there exist Lebesgue-integrable
functions such that ||σi(s, ω) −σ0(s, ω)||2 ≤φi(s) + φ0(s) = ψ(s)
P-a.s., which implies
⟨Ni⟩t =
t

0
||σi −σ0||2 ds ≤
t

0
ψ(s)ds < ∞
∀t,
and the Novikov condition (see Sect. 3.3 (4)) is fulﬁlled. Thus Ni(t) is
a martingale =⇒Zt = E(Ni(t)) is a martingale. ⇒Q∗
i is a probability
measure.
Hence (see Lemma 3.2.4) for any j = 0, 1, . . . , n,

Xj ∈Mc
loc(Q∗
i ) ←→
Xj · Z ∈Mc
loc(P ∗).
We know d !
Xi
!
Xi = σ !
Xi(t) dB∗
t where B∗
t is a Brownian motion under P ∗
=⇒!
Xi
t = !
Xi
0 · E(Ni(t)).
(17)
Thus it follows

Xj · Z = Xj
Xi · Z = !
Xj · ( !
Xi)−1 · Z
= !
Xj · ( !
Xi
0)−1 · E(Ni)−1 · E(Ni) ∈Mc
loc(P ∗).
Therefore with (Xi) as numeraire, we have
d 
Xj
t

Xj
t
= σ 
Xj(t)
  
=σj−σi
dBi
t
where Bi
t Brownian motion under Q∗
i .
Again
t
0
||σ 
Xj(s)||2 ds ≤
t
0
ψ(s)ds < ∞implies that 
Xj is indeed a
martingale.
⊓⊔
Conclusion: P ∗is a martingale measure with respect to (X0) as nu-
meraire if, and only if, Q∗
i is a martingale measure with respect to (Xi)
as numeraire.

4.5 Change of Numeraire
83
Connection B∗
t ←→Bi
t:
B∗
t ∈Mc(P ∗) , Q∗
i = E(Ni) · P ∗=⇒
GirsanovBi
t = B∗
t −⟨B∗, Ni⟩t ∈Mc(Q∗
i )
=⇒Bi
t = B∗
t −
t

0
σ !
Xi(s)
  
σi−σ0
d⟨B⟩s = B∗
t +
t

0
(σ0 −σi)(s) ds.
Thus we have
Ct = E∗
i

 CT
Xi
T
 Ft

with Xi
t as numeraire.
The decisive result is now given by the following proposition:
Proposition 4.5.3.
Xi
t · Ct = X0
t · !Ct.
(i.e., the valuation of the contingent claim CT does not depend on the
numeraire.)
Lemma 4.5.4. (Bayes rule): Let Q = ZT · P on FT and
Y ∈L1(Ω, Ft, Q). Then, for any s < t ≤T, it follows
EQ[Y |Fs] = 1
Zs
EP [Y · Zt
 Fs].
Proof. Let A ∈Fs. Since dQt
dPt
= Zt = EP [ZT
 Ft] it follows
EQ[1A Y ] = EP [1A Y · Zt] = EP

1A EP [Y · Zt
 Fs]

= EQ

1A · 1
Zs
EP [Y · Zt
 Fs]

.
⊓⊔
Proof of Prop. 4.5.3:. According to (17) one has Zt = ( !
Xi
0)−1· !
Xi
t. Thus
Lemma 4.5.4 implies
Ct = E∗
i [ CT |Ft] = 1
Zt
E∗[ CT ZT
 Ft] =
!
Xi
0
!
Xi
t
E∗
 CT
Xi
T
·
!
Xi
T
!
Xi
0
 Ft

= 1
!
Xi
t
E∗
 CT
Xi
T
· Xi
T
X0
t



!CT
 Ft

= X0
t
Xi
t
!Ct.
⊓⊔

84
4 Application to Financial Economics
4.6 Solution of the Siegel-Paradox
The techniques developed in the previous section solve the Siegel-
Paradox. The spot price process for a portfolio in Deutschmark and
Dollars is given by
Zt = (Xt, Yt) = (βDM
t
, et β$
t )
with
et
= exchange rate $/DM
βDM
t
= exp
t

0
rDM(s) ds
β$
t
= exp
t

0
r$(s) ds.
From the view point of the German investor (Xt) is the numeraire.
Thus
!Zt = (1, !Yt)
with !Yt = et
β$
t
βDM
t
and
d!Yt
!Yt
= σ!Y (t) dBt
, σ!Y = σY −σX = σe
under the martingale measure P ∗which is the expectation of the risk-
neutral German investor.
Applying Itˆo’s product rule it follows:
=⇒det
et
= (rDM(t) −r$(t)) dt + σe(t) dBt
under P ∗.

4.6 Solution of the Siegel-Paradox
85
However, from the viewpoint of the American investor the numeraire
is (Yt).
=⇒Zt = ( 
Xt, 1)
with 
Xt = ft · βDM
t
β$
t
, ft = 1
et
(exch. rate DM/$)
New martingale measure :
Q∗= E(N) · P ∗
Nt =
t

0
σ!Y (s)
  
=σe
dBs.

X martingale under Q∗=⇒d 
Xt

Xt
= σ 
X(t) d Bt
with σ 
X = σX −σY = −σe = σf and d Bt = dBt + σf dt is Brownian
motion under Q∗.
=⇒
dft
ft
= (r$(t) −rDM(t)) dt + σf(t) d Bt
under Q∗
=

r$(t) −rDM(t) + σ2
f(t)

dt + σf(t) dBt
under P ∗
Thus also from the view point of the American investor there is no
risk premium under the correct martingale measure Q∗.

86
4 Application to Financial Economics
4.7 Admissible Strategies and Arbitrage-free Pricing
The “No arbitrage” condition given in section 4.1 rules out arbitrage
opportunities in a short (strictly speaking inﬁnitesimal) time interval.
As we have shown this condition implies that the “market price of
risk” process λ(t) must be identic for all security price processes in
the considered market, which under the “Novikov” condition implies
the existence of an equivalent martingale measure P ∗. Conversely, if an
equivalent martingale measure P ∗exists, then according to the relation
(5) inﬁnitesimal arbitrage opportunities cannot exist.
However, the “no arbitrage” condition used so far does not rule out,
that there may exist dynamic trading strategies φ which over a ﬁnite
time horizon allow arbitrage proﬁts.
Let Xt = (X0, . . . , Xn)0≤t≤T be the price process of n+1 securities sat-
isfying the conditions given in section 4.5 . Let (φ)t = (φ0, . . . , φn)t be
a self-ﬁnancing portfolio strategy, i.e. an adapted (n + 1)-dimensional
stochastic process with Vt(φ) = φt ◦Xt and dVt = φt ◦dXt. As shown in
Prop. 4.5.1, the property of φ of being self-ﬁnancing does not depend
on the choice of the numeraire.
Deﬁnition 4.7.1. An arbitrage opportunity is a self-ﬁnancing portfo-
lio strategy φ such that the wealth process Vt(φ) satisﬁes the following
conditions:
V0(φ) = 0,
P[VT (φ) ≥0] = 1,
and
P[VT (φ) > 0] > 0.
Such a portfolio or trading strategy would allow one to start with an
initial investment of zero and without adding money in the time interval
[0, T] to receive a positive amount at time T with positive probability.
Since even in the simplest case of the standard Black-Scholes model
(d = 1, µ and σ = const., r = 0) there exist self-ﬁnancing strategies
which allow arbitrage (see e.g. Harrison-Kreps (1979) or Duﬃe (2001))
we need some subclass of “admissible” strategies which rule out such
arbitrage opportunities.
Consider the case where X0
t = β(t) = exp
t

0
r(s) ds is chosen as nu-
meraire, and the discounted process is !
X = X/X0.

4.7 Admissible Strategies and Arbitrage-free Pricing
87
Let Φ0 be the class of self-ﬁnancing strategies which are integrable w.r.t.
!
X and for which there exists some constant k with
!Vt(φ) = Vt(φ)/X0
t = φt ◦!
Xt ≥k
∀t ∈[0, T]
(18)
The condition (18) can be interpreted as a credit constraint, which
means that short sales are allowed, but the wealth process must stay
above a lower bound k, which may be negative. The strategies in Φ0
are also called “tame” (w.r.t. X0).
Remark 4.8. If the short rate process r(t) is bounded, then obviously
the condition (18) is equivalent to: Vt(φ) is bounded below.
Let M( !
X) denote the set of equivalent martingale measures under
which !
X is a martingale.
Theorem 4.7.2. If M( !
X) ̸= ∅, then there is no arbitrage in Φ0.
Proof. Consider φ ∈Φ0 with V0(φ) = 0 and P[VT (φ) ≥0] = 1 . Then
!Vt(φ) = φt ◦!
Xt = Vt(φ) · (X0
t )−1 is the value process with respect to
!
Xt. Since X0 is strictly positive, Vt is positive iﬀ!Vt is positive. Since
Vt is self-ﬁnancing w.r.t. X, it is also self-ﬁnancing w.r.t. !
X. Hence
!Vt(φ) = φ • !
Xt is a local martingale for any P ∗∈M( !
X). Since !Vt is by
assumption bounded below, Fatou‘s lemma (see Sect. 1.1) applied to a
sequence of localizing stopping times of !Vt implies E∗[!VT ] ≤E∗[!V0] = 0,
which together with !VT ≥0 P ∗-a.s. implies P ∗[!VT > 0] = 0. Since
P ∗∼P this is equivalent to P[VT > 0] = 0.
⊓⊔
If CT ∈L1(Ω, FT , P ∗) is a (European) contingent claim, which settles
at time T, then the fundamental pricing rule implies that its price Πt
under P ∗∈M( !
X) at any 0 ≤t ≤T is given by the process
Πt = X0
t EP ∗[CT /X0
T
 Ft]
(19)
If there is a unique P ∗∈M( !
X) this process is also uniquely deter-
mined. However, there may be many diﬀerent equivalent martingale
measures in M( !
X), as is the case when the market is “incomplete”. In
this case the price process (19) is no longer uniquely determined by the
fundamental pricing rule, but depends on the choice of an equivalent
martingale measure. In particular this is the case if n < d, i.e. there
are less securities in the market than sources of uncertainty. Thus in
incomplete markets the price of an arbitrary contingent claim cannot
be determined by “no arbitrage” arguments.

88
4 Application to Financial Economics
Deﬁnition 4.7.3. A contingent claim CT ∈L1(Ω, FT , P ∗) is attainable
if there exists an admissible strategy φ ∈Φ0 with CT = VT (φ) and
!Vt(φ) = φt ◦Xt/X0
t is a P ∗-martingale for some P ∗∈M( !
X).
If any integrable contingent claim is attainable, the market is called
complete.
Proposition 4.7.4. The price Πt of any attainable contingent claim
CT is uniquely determined by no-arbitrage and is given by the relation
(19), where the expectation is taken for arbitrary P ∗∈M( !
X).
Proof. Let φ and ψ be two admissible strategies with VT (φ) = VT (ψ) =
CT and P ∗
1 , P ∗
2 ∈M( !
X). Then also !VT (φ) = !VT (ψ) = !CT . Consider
the two value processes
Vt(φ) = X0
t EP ∗
1 [!VT (φ) | Ft)]
(20)
Vt(ψ) = X0
t EP ∗
2 [!VT (ψ) | Ft)] .
(21)
Then !Vt(φ) = φt ◦!
Xt is a local P ∗
2 - martingale and, since it is bounded
from below, by Fatou’s lemma, a P ∗
2 - sub-martingale, which implies
!Vt(ψ) = EP ∗
2 [!VT (ψ) | Ft)] = EP ∗
2 [!VT (φ) | Ft)] ≤!Vt(φ) .
(22)
By the same argument it also follows !Vt(φ) ≤!Vt(ψ). Hence
Πt = Vt(φ) = Vt(ψ) is the unique arbitrage price of CT .
⊓⊔
Unfortunately the condition of “tameness” depends on the choice of
the numeraire. Thus an admissible strategy in Φ0 may not be admis-
sible for the numeraire Xi, although the property of self-ﬁnancing is
independent of the numeraire, as shown in Proposition 4.5.1. This is
unsatisfactory from an economic point of view. For the property of a
market to be “arbitrage free” or not should not depend on the choice
of the numeraire.
A satisfactory solution of this problem, which requires very advanced
technical methods, is beyond the scope of these notes. These problems
have been dealt with in a number of papers by Delbaen and Schacher-
mayer, see in particular Delbaen-Schachermayer (1995) and
Delbaen-Schachermayer (1997).

4.8 The “Forward Measure”
89
4.8 The “Forward Measure”
The “forward measure” is a useful tool when interest rates are stochas-
tic. Then the accumulation factor
βt(ω) = exp
t

0
r(s, ω) ds
is a stochastic process, making the computation of the conditional ex-
pectation in the Fundamental Pricing Rule (Theorem 4.2.2) cumber-
some.
Consider the following connection between $t (t = “today”) and $T
(T = “tomorrow”):
0
t
T
1
- βt
- βT
spot prices
zerobond prices
P0(T)
Pt(T)
1


Let Xt = (X0, X1, . . .)t be price processes of securities. Choosing X0
t =
βt as numeraire determines the martingale measure P ∗, under which
Xi
t = E∗
 βt
βT
Xi
T | Ft

i = 0, 1, 2 . . . , 0 ≤t ≤T.
Remark 4.9. P ∗is also called the “spot martingale measure”, since
the spot price process is chosen as numeraire.

90
4 Application to Financial Economics
In particular one has
Pt(T) = E∗
 βt
βT
| Ft

since PT (T) ≡1.
Thus
!Pt(T) = Pt(T)
βt
is a
P ∗−martingale
and
dPt(T)
Pt(T) = r(t) dt + σ(t, T) ◦dB∗
t
under P ∗.
Remark 4.10. Observe that σ(t, t) = 0 since Pt(t) ≡1.
Change of numeraire from $t to $T
Instead of βt choose now Pt(T) as numeraire. According to Sect. 4.5
the corresponding martingale measure PT is given by
PT = E(L(T)) · P ∗
with
Lt(T) =
t

0
σ !Pt(s) ◦dB∗
s =
t

0
σ(s, T) ◦dB∗
s
and one has
BT
t = B∗
t −⟨B∗
t , Lt⟩= B∗
t −
t

0
σ(s, T) ds.
Let HT ∈FT be a contingent claim. Then under P ∗:
Ht = E∗
 βt
βT
HT | Ft

(Price in $t.)
Under PT it follows :
HT =
HT
PT (T) = HT
Ht = ET [HT |Ft]
(Price in $T )
Ht = Ht · Pt(T)
(Price in $t) .

4.8 The “Forward Measure”
91
Thus we have proved
Ht = E∗
 βt
βT
HT | Ft

= Pt(T) · ET [HT | Ft]
PT = “forward measure” (see e.g. Geman-ElKaroui-Rochet (1995))
The connection with the deﬁnition of PT sometimes given in the liter-
ature is established by the following proposition :
Proposition 4.8.1. PT [A] = E∗
(βT ·P0(T))−1 | Ft

·P ∗[A]
for any A ∈
Ft.
Proof. !
Xt = !Pt(T) = Pt(T)
βt
is P ∗-martingale with
d !
Xt
!
Xt
= σ(t, T) ◦dBt = dLt(T)
=⇒!
Xt =
!
X0

=P0(T)
· E(Lt(T)).
For A ∈Ft one has
PT [A] = E∗[E(LT (T)) | Ft] · P ∗[A]
= E(Lt(T)) · P ∗[A].
(23)
Since !
Xt P ∗-martingale, it follows
E∗
 1
βT
| Ft

= E∗[ !
XT |Ft] = !
Xt = P0(T) · E(Lt(T))
which together with (23) completes the proof.
⊓⊔

92
4 Application to Financial Economics
4.9 Option Pricing Under Stochastic Interest Rates
As an application of the forward measure we now study currency op-
tions when interest rates are stochastic.
Let $t (= et) be the process of the exchange rate $/DM. This gives
rise to the following price processes for a portfolio in DM/$ :
(βDM
t
, $t β$
t )
“spot” price processes
0 ≤t ≤T
(DM,$ “today”)
(P DM
t
(T), $t · P $
t (T)) “forward” price processes 0 ≤t ≤T .
(DM,$ “tomorrow”)
Now choose P DM
t
(T) as numeraire, i.e. instead of DMt (”today”) cal-
culate in DMT (”tomorrow”). This leads to the following discounted
processes:
!Zt = (1, !Yt)
with !Yt = $t · P $
t (T)
P DM
t
(T)
(T-forward $-price at t)
By the Interest-rate-parity theorem, which is illustrated in the following
diagram, !Yt is, at time t, the forward price Ft(T) of one dollar delivered
at time T.
6

6

P $
t (T)
$today
$t
DMtoday
t
P DM
t
(T)
T
DMtomorrow
Ft(T) = !Yt
$tomorrow
Diagram: Interest-Rate-Parity Theorem

4.9 Option Pricing Under Stochastic Interest Rates
93
Under the forward measure PT , !Yt is a martingale.
Clearly $T = !YT . Thus it follows, that the price Ht of the call op-
tion HT = ($T −K)+ at time t is given by :
Ht = P DM
t
(T) ET [(!YT −K)+  Ft] = P DM
t
(T)

!Yt Φ(d1
t ) −K · Φ(d2
t )

= $t · P $
t (T) · Φ(d1
t ) −K · P DM
t
(T) · Φ(d2
t )
where d1,2
t
= ln(!Yt/K)
ηt
± 1
2 ηt with
η2
t =
T

t
||σ!Y (s)||2 ds =
T

t
||σ$(s) + σ$(s, T) −σDM(s, T)||2 ds
(σ$ resp. σDM are the volatilities of P $(T) resp. P DM(T))
Consider the following hedge strategy in T-forward contracts:
• Buy at t : Φ(d1
t )
Dollar at T
• Sell at t : −K · Φ(d2
t )
DM at T
=⇒Vt(φ) = Φ(d1
t ) · !Yt −K · Φ(d2
t ) DM at T
=⇒VT (φ) =

$T −K for $T = !Y > K
0
for $T ≤K

= HT
Hence the strategy φ duplicates the contingent claim HT .
Exercise: Show that the strategy φ is self-ﬁnancing.
Hint: Consider the function F(x, t) = x · Φ(d1(x, t)) −K · Φ(d2(x, t))
where d1,2(x, t) = ln(x/K)
ηt
± 1
2 ηt
with
η2
t =
T

t
||σX(s)||2 ds.
1) Show x · ϕ(d1) = K · ϕ(d2) where ϕ(z) =
1
√
2π e−1
2 z2
(density of Φ)

94
4 Application to Financial Economics
2) Using the relation 1) show Fx(x, t) = Φ(d1(x, t))
3) Show Ft(x, t) = x · ϕ(d1) · d
dt η(t)
4) Show d
dt η(t) = −1
2η · ||σX(t)||2
5) Show Ft + 1
2 Fxx x2 ||σX(t)||2 = 0
=⇒Vt(φ) = F(!Yt, t) is self-ﬁnancing (see Sect. 2.5 (15) and Rem. 2.11)
=⇒dVt(φ) = Φ(d1
t ) d!Yt

5
Term Structure Models
Term structure models are considered as one of the most complex and
mathematically demanding subjects in ﬁnance. Contrary to the valu-
ation of options, or more generally of contingent claims, the valuation
of interest rate dependent instruments requires the study of many in-
teracting markets, the so-called “term structure” of interest rates.
One of the ﬁrst term structure models was the short-rate model of Va-
sicek (1977). By modelling the “short rate” over time, the dynamics of
the “forward rate” is also implicitly determined. A drawback of short-
rate models is that they cannot be ﬁtted to the total term structure
(they only catch the ﬁrst point of the “yield curve”). This shortcoming
was ﬁrst overcome by the Ho-Lee model (see Ho-Lee (1986)), which
starts with the present term structure as given by the zerobond prices.
Both models are sketched in Sect. 5.4 as special HJM models.
A fundamental contribution was made by Heath-Jarrow-Morton (1992),
who start by modelling the complete term structure as given by the
(continuously compounded) forward rates. Most implementations of
the HJM model are “Gaussian”, meaning that the forward rates are
assumed to be normally distributed. But this implies that interest rates
may become negative, a rather undesirable property. This problem
was overcome by the “log-normal” models. However, assuming that
continuously compounded interest rates are log-normally distributed
led to new diﬃculties: the rates explode over time and thus these
models (see Black-Derman-Toy (1990) or Black-Karasinski (1991))
are unstable. This problem was solved by the (discrete) log-normal
Sandmann-Sondermann model (see Sandmann-Sondermann (1993)).
By switching from continuously compounded to “eﬀective”, i.e., an-

96
5 Term Structure Models
nually compounded rates, they showed that such models have stable
dynamics, and hence have a stable continuous limit (see Sandmann-
Sondermann (1994)). This approach ﬁnally led to the so-called “LI-
BOR” or “Market” models due to Sandmann-Sondermann-Miltersen
(1995) and Miltersen-Sandmann-Sondermann (1997), and further de-
veloped by Brace-Gatarek-Musiela (1997). These models have be-
come quite popular in the ﬁnance industry, since they are stable and
arbitrage-free, produce non-negative interest rates and, most impor-
tantly, reﬂect the market practice of Black’s caplet formula (see Sect.
5.5 and 5.6).
For a comprehensive treatment of Fixed Income Markets and term
structure models we refer to Musiela-Rutkowski (1997), who also give a
detailed overview of the historical development of this complex subject.
By looking at a term structure model in continuous time in the gen-
eral form of Heath-Jarrow-Morton (1992) as an inﬁnite collection of
assets (the zerobonds of diﬀerent maturities), the methods developed
in Chap. 4 can be applied without modiﬁcation to this situation. Read-
ers who have gone through the original articles of HJM may appreciate
the simplicity of this approach, which leads to the basic results of HJM
in a straightforward way. The same applies to the Libor Market Model
treated in Sect. 5.5 .
5.1 Diﬀerent Descriptions of the Term Structure of
Interest Rates
There are three equivalent descriptions of the term structure, namely
by means of
1) Zerobonds
P(t, T) = price of one Euro, deliverable at T, at time t
2) yields (continuously compounded)
y(t, T) := −
1
T −t log P(t, T)

5.1 Diﬀerent Descriptions of the Term Structure of Interest Rates
97
3) forward rates (continuously compounded)
f(t, T) := −∂
∂T log P(t, T).
Relations between 1), 2) and 3) :
1) =⇒2) + 3) by deﬁnition
2) =⇒P(t, T) = exp{−y(t, T) (T −t)}
f(t, T) = y(t, T) + (T −t) ∂
∂T y(t, T)
(1)
3) =⇒P(t, T) = exp

−
T

t
f(t, u) du

y(t, T) =
1
T −t
T

t
f(t, u) du.
Hence the term structure up to time T ∗is completely described by any
of the following families:
(i)

P(t, T) | 0 ≤T ≤T ∗, 0 ≤t ≤T

(ii)

y(t, T) | 0 ≤T ≤T ∗, 0 ≤t ≤T

(iii)

f(t, T) | 0 ≤T ≤T ∗, 0 ≤t ≤T

.
For ﬁxed t, T −→P(t, T) , t ≤T ≤T ∗is a (smooth) curve of bond
prices at t with diﬀerent maturities.
For ﬁxed T, t −→P(t, T) is the (stochastic) price process of a bond
maturing at T.
This is illustrated in the diagrams of Fig. 5.1 on page 98.

98
5 Term Structure Models
1
P(0,T)
T*
0
T
P(t,T*)
T*
0
1
t
Bond prices now (t = 0)
Price of a bond maturing at T ∗
Similar for y(t, T)
T*
y(0,T)
T*
y(t,T*)
yield rates now (t = 0)
yields rates maturing at T ∗
and for f(t, T)
T*
f(0,T)
T*
f(t,T*)
forward rates now (t = 0)
forward rates maturing at T ∗
Fig. 5.1. Diﬀerent descriptions of the Term Structure

5.2 Stochastics of the Term Structure
99
From (1) it follows
f(t, T)
⎛
⎝
>
=
<
⎞
⎠y(t, T) ⇐⇒yield curve is
⎛
⎝
rising
ﬂat
falling
⎞
⎠
In particular, the relation (1) implies: the longer the maturity T, the
more sensitive f(t, T) reacts to twists in the yield curve.
Deﬁnition 5.1.1. The instantaneous spot rate is deﬁned by
r(t) = f(t, t) = −∂
∂T (log P(t, T))T=t.
5.2 Stochastics of the Term Structure
Again we assume that there are d independent stochastic factors mod-
elled by a d-dimensional Brownian motion.
Bt = (B1
t , . . . , Bd
t )
on (Ω, (Ft)0≤t≤T ∗, P)
satisfying the usual conditions.
For each T ≤T ∗, consider the “asset” XT
t
= P(t, T). As before we
assume that, for any 0 ≤T ≤T ∗,
dP(t, T)
P(t, T) = µ(t, T) dt +
σ(t, T) ◦dBt



scalar product in IRd
0 ≤t ≤T
with µ(t, T), σ(t, T) adapted processes, satisfying boundary conditions
as deﬁned in Sect. 4.1 .
Thus we have a continuum of “assets”, whose dynamics are given by
Borel-measurable mappings
µ : C × Ω−→IR
, σ : C × Ω−→IRd
with
C =

(t, T) : 0 ≤t ≤T ≤T ∗
.

100
5 Term Structure Models
Assumption 5.2.1. (No-arbitrage)
There exists a d-dimensional adapted process λ(t)0≤t≤T ∗with
E

exp
/1
2
T ∗

0
||λ(s)||2 ds

< ∞
such that, for all 0 ≤t ≤T ≤T ∗
µ(t, T) = r(t) + λ(t) ◦σ(t, T)
= r(t) +
d

i=1
λi(t) σi(t, T).
Remark 5.1.
(1) As shown in Sect. 4.1, no arbitrage implies that the risk price pro-
cess is the same for all “assets”, i.e. does not depend on the maturity
T.
(2) Since there is now a continuum of assets, but only d factors, NA
imposes restrictions on the drift terms µ(t, T) (term structure mod-
els with ﬁnitely many factors are “over”-complete).
(3) λ(t) can be interpreted as a risk premium for long term investments,
since
E

dP(t, T)
P(t, T)
| Ft

= r(t) dt + λ(t) ◦σ(t, T) dt



excess return
.
As before Girsanov’s theorem allows us to eliminate λ(t) as follows:
Lt := −
t

0
λ(s) ◦dBs
P ∗= E(LT ∗) P
P ∗∼P on FT ∗
B∗
t = Bt +
t

0
λ(s) ds
BM under P ∗

5.2 Stochastics of the Term Structure
101
=⇒dP(t, T)
P(t, T) = r(t) dt + σ(t, T) ◦dB∗
t
0 ≤t ≤T ≤T ∗
=⇒EP ∗

dP(t, T)
P(t, T)
| Ft

= r(t) dt
(Local Expectation Hypothesis).
Again let
β(t) = exp

t

0
r(s) ds

be the accumulation factor (rolling over at the spot rate) = spot nu-
meraire.
As in Chap. 4 it follows, that the discounted price processes are mar-
tingales under P ∗, i.e.
ˆP(t, T) = P(t, T)
β(t)
has dynamics
d ˆP(t, T)
ˆP(t, T)
= σ(t, T) ◦dB∗
t
∀0 ≤t ≤T ≤T ∗.
More generally, for any Itˆo-Process (Zt)0≤t≤T≤T ∗on (Ω, (Ft), P), which
is of the form
dZt
Zt
= µZ(t) dt + σZ(t) ◦dBt
we have for ˆZt = Zt
βt
d ˆZt
ˆZt
= σZ(t) ◦dB∗
t
under P ∗
which again implies the Fundamental Pricing Rule:
Zt = E∗
exp

−
T

t
r(s) ds

ZT
Ft

= βt E∗[ ˆZT | Ft] ∀0 ≤t ≤T ≤T ∗
In particular, for any contingent claim HT which is FT -measurable (and
thus may depend on the whole term structure up to time T), we have :

102
5 Term Structure Models
Ht = βt E∗
HT
βT
Ft

= P(t, T) ET [HT |Ft],
where ET is the expectation w.r.t. the forward measure
PT = E∗[(βT P(0, T))−1 | Ft] P ∗
on Ft
i.e. PT is the martingale measure with P(t, T) as numeraire (see Sect.
4.8).
5.3 The HJM-Model
We have completely described the term structure by taking the zero-
bonds as building blocks. As we have seen all results, as derived in
Chap. 4 for asset prices and their derivatives, carry over to describe
the stochastic nature of the term structure. However, the term struc-
ture is usually described by interest rates instead of bond prices, e.g.
by the movements of the yield curve or the forward rate curve.
Therefore HJM start with modelling the dynamics of the forward rates
f(t, T) and assume that
df(t, T) = α(t, T) dt +
τ(t, T) ◦dBt



scalar product in IRd
0 ≤t ≤T ≤T ∗
under the same conditions as in Sect. 5.2. Since the dynamics of the
term structure is already completely described by the dynamics of
P(t, T), all what remains to do is to reveal the implied dynamics for
the forward rates f(t, T).
For the technical conditions on the processes α and τ needed for a
mathematical rigorous derivation of the HJM-model (in particular con-
ditions allowing the change of stochastic diﬀerentiation and integration)
we refer to Heath-Jarrow-Morton (1992).
Again, since there is a continuum of rates but only ﬁnitely many fac-
tors, the drift terms α(t, T) must satisfy certain restrictions for the
model to be consistent.

5.3 The HJM-Model
103
Theorem 5.3.1. No arbitrage implies the existence of an adapted pro-
cess λ(t) such that, for any 0 ≤t ≤T ≤T ∗,
α(t, T) = τ(t, T) ◦(λ(t) −σ(t, T))
(2)
where
σ(t, T) = −
T

t
τ(t, u) du.
Proof. We have the following relations between f(t, T) and P(t, T):
ln P(t, T) = −
T

t
f(t, u) du
f(t, T) = −∂
∂T ln P(t, T).
No arbitrage (see Sect. 4.1 and 5.2) implies the existence of a risk price
process λ(t), which is independent of T, with
E

dP(t, T)
P(t, T) |Ft

= r(t) dt + λ(t) ◦σ(t, T) dt
where σ(t, T) is the volatility of P(t, T). By Itˆo
d ln P(t, T) = dP(t, T)
P(t, T) −1
2
1
P(t, T)2 d⟨P(t, T)⟩t
=

r(t) + λ(t) ◦σ(t, T) −1
2||σ(t, T)||2
dt + σ(t, T) ◦dBt.
The crucial step now is that the HJM conditions allow changing dif-
ferentials. In doing so it follows:
df(t, T) = −∂
∂T d ln P(t, T)
= −

λ(t) ∂
∂T σ(t, T) −σ(t, T) ∂
∂T σ(t, T)

dt −∂
∂T σ(t, T)



:=τ(t,T)
dBt.
Hence
α(t, T) = λ(t) ◦τ(t, T) −σ(t, T) ◦τ(t, T)
and
σ(t, T) = −
T

t
τ(t, u) du.
⊓⊔

104
5 Term Structure Models
The relation (2) allows again the elimination of the risk process λ(t)
(which is the same for f(t, T) and P(t, T)) by Girsanov.
Since we have already done this change of measure from P to P ∗for
the bond prices, we can directly derive the dynamics of f(t, T) under
P ∗by the same technique as above.
Theorem 5.3.2. (HJM)
Under P ∗the dynamics of f(t, T) is
df(t, T) =

τ(t, T) ◦
T

t
τ(t, u) du

dt + τ(t, T) ◦dB∗
t .
Proof. Follows from
d ln P(t, T) =

r(t) −1
2 ||σ(t, T)||2
dt + σ(t, T) ◦dB∗
t
and
σ(t, T) = −
T

t
τ(t, u) du.
⊓⊔
Hence forward rates and spot rates under the (spot) martingale mea-
sure P ∗are given by
f(t, T) = f(0, T) −
t

0
τ(s, T) ◦σ(s, T) ds +
t

0
τ(s, T) ◦dB∗
s
r(t) = f(0, t) −
t

0
τ(s, t) ◦σ(s, t) ds +
t

0
τ(s, t) ◦dB∗
s,
where
σ(s, T) = −
T

s
τ(s, u) du.
Attention: Observe that the volatility τ of the forward rates and the
volatility σ of the zerobonds have opposite signs, since both depend on
the same Brownian motion. Hence, if forward rates move up, zerobond
prices move down, and vice versa.

5.4 Examples
105
5.4 Examples
Literature: Ho-Lee (1986), Vasicek (1977), Musiela-Rutkowski (1997).
1. Ho-Lee Model
d = 1
τ(t, T) = τ > 0
∀t, T
=⇒df(t, T) = α(t, T) + τ dBt
No arbitrage
⇐⇒
Theorem 5.3.1 α(t, T) = τ λ(t) + τ 2(T −t) .
Theorem 5.3.2 =⇒df(t, T) = τ 2(T −t) dt + τ dB∗
t
f(t, T) = f(0, T) + τ 2
t

0
(T −s) ds + τ B∗
t
= f(0, T) + τ 2 t(T −t
2) + τ B∗
t
r(t) = f(t, t) = f(0, t) + 1
2 τ 2 t2 + τ B∗
t .
-
6











T
f(t, T)
f(0, T) •
f(t, ·)
Ho-Lee turns any (ﬂat)
initial
forward
curve
into an upward sloping
curve at t .

106
5 Term Structure Models
Dynamics of P(t, T) of the Ho-Lee model:
dP(t, T)
P(t, T) = r(t) dt + σ(t, T) dB∗
t
=

f(0, t) + 1
2 τ 2 t2 + τ B∗
t

dt −τ(T −t) dB∗
t .
(3)
Proposition 5.4.1.
P(t, T) = P(0, T)
P(0, t) exp

−1
2 τ 2(T −t) T t −τ(T −t) B∗
t

.
Proof. To show
P(t, T) = P(0, T) eXt
with
Xt =
t

0
f(0, s) ds −1
2 τ 2(T −t) T t −τ(T −t) B∗
t
is the solution of (3).
Itˆo’s formula implies:
dP(t, T) = P(0, T)

eXtdXt + 1
2 eXtd⟨X⟩t

= P(t, T)

dXt + 1
2 d⟨X⟩t

dXt = f(0, t) dt −1
2 τ 2(−T t + (T −t) T



(T−t)2−t2
) dt + τ B∗
t dt −τ(T −t) dB∗
t
=

f(0, t) + 1
2 τ 2 t2 + τ B∗
t

dt −1
2 τ 2(T −t)2 dt



d⟨X⟩t
−τ(T −t) dB∗
t
=⇒dP(t, T)
P(t, T) = r(t) dt −τ(T −t) dB∗
t .
⊓⊔

5.5 The “LIBOR Market” Model
107
2. Vasicek-Model
d = 1
τ(t, T) = τ e−α(T−t)
α, τ > 0 ﬁxed
=⇒σ(t, T) = −
T

t
τ(t, u) du = τ
α

e−α(T−t) −1

.
HJM −→df(t, T) = −τ(t, T) σ(t, T) dt + τ(t, T) dB∗
t
= τ 2
α e−α(T−t) 
1 −e−α(T−t)
dt + τ e−α(T−t) dB∗
t
= τ e−α(T−t) 
−τ
α (e−α(T−t) −1) dt + dB∗
t

.
dP(t, T)
P(t, T) = r(t) dt −τ
α

1 −e−α(T−t)
dB∗
t
It can be shown (see e.g. Musiela-Rutkowski (1997) Chapt.13) that
the short rate is of the form
dr(t) =

a(t) −α r(t)

dt + τ dB∗
t
(Ornstein-Uhlenbeck process)
5.5 The “LIBOR Market” Model
Literature: see introduction to Chapter 5 .
Starting point are market rates (e.g. LIBOR = ”London Inter-Bank
Oﬀer Rate”).
f(t, T, δ) = nominal rate at t for period [T, T + δ], δ > 0
δ = 0.25 −→f(t, T, δ) = 3-month forward LIBOR rate
Assumption 5.5.1. (MSS)
df(t, T, δ)
f(t, T, δ) = µ(t, T) dt + γ(t, T) ◦dBt.

108
5 Term Structure Models
Corresponding HJM-Model
dP(t, T) = P(t, T) (r(t) + σ(t, T) ◦dB∗(t))
df(t, T, dt) = −τ(t, T) ◦σ(t, T) dt + τ(t, T) ◦dB∗(t)
σ(t, T) = −
T

t
τ(t, u) du.
Switching to the forward measure by choosing P(t, T) as numeraire
(see Sect. 4.8 and 5.2), we get that
B∗
T (t) = B∗(t) +
t

0
σ(s, T) ds
is Brownian motion under the forward measure
PT = E(LT ) P ∗
with
LT (t) = −
t

0
σ(s, T) ◦dB∗(s).
The connection between the rates f(t, T, δ) and P(t, T) is given by the
forward contracts
F(t, T, δ) := P(t, T + δ)
P(t, T)
=

1 + δ f(t, T, δ)
−1
.
Proposition 5.5.2.
dF(t, T, δ)
F(t, T, δ) = (σ(t, T) −σ(t, T + δ)) ◦dB∗
T (t)
= −
 T+δ

T
τ(t, u) du

◦dB∗
T (t).
Proof. Set X = P(t, T + δ),
and
Y = P(t, T). Then Itˆo implies
d(XY −1)
XY −1
= (µX −µY + σY ◦(σY −σX)) dt + (σX −σY ) ◦dB∗(t)
=

r(t) −r(t) + σ(t, T) ◦(σ(t, T) −σ(t, T + δ))

dt
+

σ(t, T) −σ(t, T + δ)

◦dB∗(t)
=

σ(t, T) −σ(t, T + δ)

◦(dB∗(t) + σ(t, T) dt



dB∗
T (t)
).

5.5 The “LIBOR Market” Model
109
⊓⊔
Theorem 5.5.3. The relation between the volatilities γ(t, T) and
σ(t, T) is given by
σ(t, T + δ) = σ(t, T) +
δ f(t, T, δ)
1 + δ f(t, T, δ) · γ(t, T).
Proof. Since Girsanov does not change volatilities we have from the
MSS-assumption
df(t, T, δ) = . . . dt + f(t, T, δ) · γ(t, T) ◦dB∗(t).
By Itˆo this implies
dF(t, T, δ) = d(1 + δ f)−1 = −F 2δ df −1
2 F 3 d⟨f⟩.
Hence
dF(t, Tδ)
F(t, T, δ) = −F δ f γ(t, T) ◦dB∗(t) + . . . dt
= −
δ f
1 + δ f γ(t, T) ◦dB∗(t) + . . . dt.
By Prop. 5.5.2 we have
dF(t, T, δ)
F(t, T, δ) = (σ(t, T) −σ(t, T + δ)) ◦dB∗
T (t).
Since Girsanov does not change the diﬀusion coeﬃcients, we get the
result by comparison of volatilities.
⊓⊔
Remark 5.2. The HJM-volatilities are no longer deterministic (even
if the γ(t, T) are assumed as deterministic), since they depend on
f(t, T, δ), i.e.
σ(t, T + δ, ω) = σ(t, T, f(t, T, δ)(ω)).
Starting with σ(0, T) = 0 and f(0, T, δ), T = 0, δ, 2δ, . . ., they can be
computed pathwise by a binomial lattice.
Theorem 5.5.4.
df(t, T, δ)
f(t, T, δ) = γ(t, T) ◦dB∗
T+δ(t).

110
5 Term Structure Models
Proof.
(1 + δ f(t, T, δ))−1 = F(t, T, T + δ) = P(t, T + δ)
P(t, T)
=⇒f = 1
δ

P(t, T)
P(t, T + δ) −1

.
Take P(t, T + δ) as numeraire
=⇒
P(t, T)
P(t, T + δ) is a martingale under B∗
T+δ
=⇒
f and df/f are martingales under B∗
T+δ
=⇒
df = f · γ(t, T) ◦dB∗
T+δ .
⊓⊔
The Market Caplet Formula
A “caplet” is deﬁned as the payoﬀ
C = δ (f(T, T, δ) −K)+
payable at T + δ.
By the Fundamental Pricing Rule we have
Ct = βt E∗
 C
βT+δ
Ft

= δ P(t, T + δ) ET+δ[(f −K)+|Ft].
Since df
f = γ(t, T) ◦dB∗
T+δ is a lognormal martingale under PT+δ,
ET+δ[(f −K)+] is the Black-Scholes formula for the call (f −K)+.
Hence
Ct = δ P(t, T + δ)

f(t, T, δ) Φ(d1) −K Φ(d2)

d1,2(t) =
1
η(t, T)

ln f(t, T, δ)
K
± 1
2η2(t, T)

η2(t, T) =
T

t
γ2(s, T) ds .

5.6 Caps, Floors and Swaps
111
For a “ﬂoorlet” F = δ [K−f(t, T, δ)]+ one obtains by the same method:
Ft = δ P(t, T + δ)

K Φ(−d2) −f(t, Tδ) Φ(−d1)

.
5.6 Caps, Floors and Swaps
Consider a sequence T = {T0 < T1 < . . . < Tn} of payment dates.
Let L(t, Ti) denote the forward LIBOR rate for [Ti, Ti+1], valid at
t , t ≤T0 , (i = 0, . . . , n −1).
Set δi = Ti+1 −Ti .
E.g.: 3-month LIBOR rates =⇒δi ≈0.25 (varies with calendar)
Deﬁnition 5.6.1. A cap at cap-rate K on L(t, Ti) is a collection of
caplets of the form
C(K, T ) =

δi [Li −K]+,
i = 0 . . . n −1

which pays the amount δi [L(Ti, Ti) −K]+ at each Ti+1 (payment in
arrear) resp. P(Ti, Ti+1) δi [Li −K]+ at Ti.
Similarly a ﬂoor on L(t, Ti) is given by
F(K, T ) =

δi [K −Li]+,
i = 0 . . . n −1

.
A swap at rate K is a sequence of payments
Swap (K, T ) =

δi (Li −K),
i = 0 . . . n −1

at each Ti+1 (arrear swap).
Let Ct(K), Ft(K), St(K) denote the price of these instruments at time
t ≤T0.
The relation a−b = [a−b]+ −[b−a]+ immediately gives the Cap-Floor
relation

112
5 Term Structure Models
Ct(K) = Ft(K) + St(K).
With the preceding result on caplets we obtain
Ct(K) =
n−1

i=0
δi P(t, Ti+1)

L(t, Ti) Φ(d1(t, Ti)) −K Φ(d2(t, Ti))

d1,2(t, Ti) =
1
η(t, T)

ln L(t, T)
K
± 1
2 η2(t, T)

η2(t, T) =
T

t
γ2(s, T) ds.
The price of a (forward) swap at t is given by
St(K) =
n−1

i=0
δi P(t, Ti+1) L(t, Ti) −
n−1

i=0
δi K P(t, Ti+1)
= P(t, T0) −

P(t, Tn) +
n

i=1
P(t, Ti) K (Ti −Ti−1)



Coupon bond with coupon=K

.
The “forward swap rate” K = K(t, T ) is deﬁned by the equation
St(K) = 0. This gives
K(t, T ) = (P(t, T0) −P(t, Tn))

n

i=1
δi−1 P(t, Ti)
−1
.
The “swap rate” K(T0, T ) is the rate which assigns a zero price to a
swap starting at T0. Hence
K(T0, T ) = 0 ⇐⇒
n

i=1
P(T0, Ti) K (Ti −Ti−1) + P(T0, Tn) = 1
⇐⇒CB(K, T ) = 1.
I.e. the swap rate is equal to the coupon rate of a coupon bond (with
payment dates T ) quoted at “pari”.

6
Why Do We Need Itˆo-Calculus in Finance?
As pointed out in Sect. 2.1, Itˆo’s calculus is a necessary extension of
real analysis to cope with functions of unbounded variation. Thus the
question, whether we need stochastic calculus in ﬁnance, is tantamount
to the question: are charts of stock prices, exchange or interest rates,
in reality of unbounded variation? Such functions, like the Weierstraß
function or a path of the Brownian motion, are pure mathematical
constructs. Nobody can draw the graph of such a function, and even
a computer can only give an approximate picture 1. Why should such
constructs represent what happens on the exchange markets?
The answer is given by contradiction. Let us assume that stock price
movements are in reality of ﬁnite variation. Then clever people could
make huge arbitrage proﬁts by generating options, which are traded in
the market at high premiums, at almost zero costs. Clearly a contra-
diction to reality!
This chapter requires some deeper results of stochastic analysis, like lo-
cal times and generalized Itˆo formulas, taken from Carr-Jarrow (1990)
and Revuz-Yor (1991). Section 6.4 should be of special interest to
economists, since it presents another view on option pricing by means
of Arrow-Debreu prices for contingent claims.
1 A colleague once made the self-ironic remark: the older you get, the better you
become in drawing paths of the Brownian motion.

114
6 Why Do We Need Itˆo-Calculus in Finance?
6.1 The Buy-Sell-Paradox
Literature: Carr-Jarrow (1990)
Let (Xt) be a security price process in an economy with a non-stochastic
interest rate r(t) and bond price
Pt(T) = exp

−
T

t
r(s) ds

as numeraire.
=⇒Ft =
Xt
Pt(T)
T-forward price.
For a call CT = (XT −K)+ consider the following hedging strategy
φt(ω) = 1{Ft(ω)>K} = 1{Xt(ω)>Pt(T)·K}
This strategy is realized as follows: buy one share of the stock when
up-crossing the strike price K, sell it when down-crossing the strike
(see Fig. 6.1).
0
K
Ft
T
Fig. 6.1. Buy-Sell strategy
=⇒Vt(φ) = 1{Ft>K} · Ft −1{Ft>K} · K
$ at T
= max{Ft −K, 0} = [Ft −K]+
=⇒VT (φ) = [FT −K]+ = [XT −K]+ = CT

6.2 Local Times and Generalized Itˆo Formula
115
The hedging strategy φ is ”apparently” self-ﬁnancing and generates
CT . Thus it follows:
CT
0 = V0(φ) = [F0 −K]+
initial investment in $ deliverable at T
=⇒C0 = P0(T) · V0(φ)
  
CT
0
= [X0 −K · P0(T)]+
price in $-today .
Thus for X0 ≤K · P0(T) =⇒the option at time t = 0 has price
zero.
This is paradoxical, since also “out-of-the-money” options have pos-
itive prices. To solve this paradox we need the concept of local times,
which is studied in the next two sections.
6.2 Local Times and Generalized Itˆo Formula
Literature: Revuz-Yor (1991), Chap. 6
Let Bt(ω) be a the path of the (1-dimensional) Brownian motion.
I = [a, b] ⊂IR;
λ Lebesgue measure on IR.
Deﬁnition 6.2.1.
Γt(I, ω) :=
t

0
1I(Bs(ω)) ds = λ{s ≤t : Bs(ω) ∈I}
is called the “occupation time in I till time t”
(see Fig. 6.2 on p.116).
For all
(t, ω), Γt(·, ω) deﬁnes a measure on the Borel sets B in IR.
A ∈B
λ(A) = 0 =⇒Γt(A) = 0
P-a.s.
=⇒Γt(·, ω) has density Lt(x, ω) w.r.t. the Lebesgue measure λ, given
by

116
6 Why Do We Need Itˆo-Calculus in Finance?
Lt(x, ω) = lim
ϵ↓0
1
2ϵ Γt(Iϵ
x, ω) = lim
ϵ↓0
1
2ϵ λ{s ≤t : |Bs(ω) −x| ≤ϵ}
= “local time in x till t”
where Iϵ
x = [x −ϵ, x + ϵ].
t
I
Fig. 6.2. Occupation time of the path in interval I
Consequence: g : IR −→IR
measurable
=⇒
t

0
g(Bs(ω)) ds =
∞

−∞
g(x) Lt(x, ω) dx.
(1)
Proof. As in Prop. 1.3.1 it suﬃces to consider, for any A ϵ B, the char-
acteristic function g = 1A
t

0
1A(Bs) ds = Γt(A, ω) =

IR
1A(x) · Lt(x) dx.
⊓⊔
Generalized Itˆo formula for convex functions
Let F : IR −→IR be a convex function, i.e.,
F(tx + (1 −t)y) ≤t F(x) + (1 −t) F(y) for 0 ≤t ≤1
(e.g. F(x) = [x −a]+).

6.2 Local Times and Generalized Itˆo Formula
117
Convexity =⇒F is continuous, a.s. diﬀerentiable, and one has
F ′
−(x) = lim
h↓0
F(x) −F(x −h)
h
,
the left derivative of F, exists ∀x
F ′
−∈FV =⇒F ′
−deﬁnes a measure µ on (IR, B) by
µ[a, b) =

[a,b)
dF ′
−= F ′
−(b) −F ′
−(a).
Notation: µ = F ′′
−· λ (2nd derivative measure of F)
Remark 6.1. F ∈C2 =⇒µ = F ′′ · λ. For one has
b

a
F ′′(x) dx = F ′
−(b) −F ′
−(a) =:

[a,b)
µ(dx).
For F(x) = [x −a]+ one has F ′
−(x) =

0 x ≤a
1 x > a
Thus for g : R −→R it follows

IR
g(x) µ(dx) =

IR
g(x) dF ′
−(x) = g(a) ,i.e. dF ′
−= δa Dirac-measure in a.
Theorem 6.2.2. (Generalized Itˆo Formula for convex functions)
Let F : IR −→IR be a convex function. Then one has
F(Bt) = F(B0) +
t

0
F ′
−(Bs) dBs + 1
2
∞

−∞
Lt(x) µ(dx)
where
µ = F ′′
−· λ
(2nd derivative measure of F) .
Remark 6.2. F ∈C2 −→F ′
−= F ′ , µ(dx) = F ′′(x) dx
∞

−∞
Lt(x) F ′′(x) dx =
(1)
t

0
F ′′(Bs) ds
=⇒“classical” Itˆo formula.

118
6 Why Do We Need Itˆo-Calculus in Finance?
Generalization to Semi-Martingales
Let X be a continuous semimartingale, A ⊂IR a Borel set.
Deﬁnition 6.2.3. Γt(A) =
t

0
1A(Xs)
d⟨X⟩s
  
interior clock
is called the “occupation time of X in A till t” .
Clearly Γt(A) is a continuous process with monotonically increasing
paths.
Proposition 6.2.4. There exits a family of continuous, adapted, mono-
tonically increasing processes (La
t )t≥0,a∈IR with
La
t = lim
ϵ↓0
1
2ϵ
t

0
1{|Xs−a|≤ϵ} d⟨X⟩s
and
Γt(A) =

A
La
t da.
(2)
La
t = La
t (X)(ω) is called the “local time of X in a till time t” .
The above proposition implies:
(2) =⇒
t

0
g(Xs) d⟨X⟩s =
∞

−∞
g(a) La
t da
for any real measurable
function g .
Corollary 6.2.5. g ≡1=⇒
(2)
⟨X⟩t =
t

0
d⟨X⟩s =
∞

−∞
La
t (X) da.
=⇒X ∈FV =⇒Lt(X) ≡0.
Let
Uϵ
t (a, ω)
denote the number of up-crossings by path Xt(ω) of
the interval [a, a + ϵ] (see Fig.
6.3 on page 119).

6.2 Local Times and Generalized Itˆo Formula
119
t
a
a+e
1
2
Fig. 6.3. U ϵ
t (a, ω) = # up-crossings from Xt(ω) of the interval [a, a + ϵ]
Proposition 6.2.6. (El-Karoui)
lim
ϵ↓0 2ϵ Uϵ
t (a, ω) = La
t (ω)
P-a.s.
Consequence: La
t (ω) > 0 =⇒the path X(ω) crosses the a-line till
time t inﬁnitely often.
Theorem 6.2.7. (Itˆo-Tanaka formula)
Let X be a continuous semimartingale, F a real convex function. Then
one has
F(Xt) = F(X0) +
t

0
F ′
−(Xs) dXs + 1
2
∞

−∞
La
t (X) F ′′
−(da)
with F ′′
−(da) 2nd derivative measure of F (Lebesgue-Stieltjes integral).
Remark 6.3. For F ∈C2 it follows
F(Xt) = F(X0) +
t

0
F ′(Xs) dXs + 1
2

IR
La
t (X) F ′′(a) da



=
(Rem.6.2)
t
0
F ′′(Xs) d⟨X⟩s

120
6 Why Do We Need Itˆo-Calculus in Finance?
6.3 Solution of the Buy-Sell-Paradox
g(x) = (x−K)+ is a convex function. Thus according to the Itˆo-Tanaka
formula :
g(FT ) = (FT −K)+ = (F0−K)++
T

0
g′
−(Fs) dFs



=
T
0
dV (φs)
PT -Mart.
(self-ﬁnancing)
+ 1
2
∞

−∞
La
t (F) g′′
−(da)
  
δK(da)



= 1
2 LK
T (F)
= lim
ϵ↓0 ϵ · Uϵ
T (K)
(transaction costs)
But for a process (Ft) of inﬁnite variation, its local time LK
T becomes
positive, once it crosses the barrier K. Hence the “buy-sell” strategy is
not self-ﬁnancing !
The transaction costs
1
2 LK
T (F), which by Prop. 6.2.6 are equal to
lim
ϵ↓0 ϵ · Uϵ
T (K), have a nice interpretation:
Assume that one tries to apply the Buy-Sell strategy in order to hedge
the payoﬀg(FT ) = (FT −K)+, i.e., buy the stock at price K when
up-crossing the barrier K, sell it again when down-crossing the barrier.
But you cannot sell it at the same price. You need a so-called “cutout”,
you can place only limit orders of the form: buy at K, sell at K −ε for
some ε > 0. The smaller you choose ε, the more cutouts you will face,
and in the limit the sum of these cutouts is just equal to the transaction
costs (see Fig. 6.4 on p. 121) .
Taking the expectation under the forward measure PT , it follows:
FT ∈M(PT ) =⇒CT
0 = ET [(FT −K)+] = (F0 −K)+



IV
+ ET

1
2 LK
T (F)




TV in $tomorrow
=⇒C0 = P0(T)·CT
0 = (X0 −K · P0(T))+



PIV
+ P0(T) ET

1
2 LK
T

in $today



PV of expected local time
Here ’IV’ stands for “interior value” and ’TV’ for “time value”. The
preﬁx ’P’ means “present”.

6.4 Arrow-Debreu Prices in Finance
121
0
0.2
0.4
0.6
0.8
1
time
K
K
stock price
Buy
Sell
Buy
Fig. 6.4. Transaction costs caused by ‘cutouts‘ ϵ
Remark 6.4. (Xt) ∈FV =⇒LK
T ≡0 =⇒TV = 0
=⇒out-of-the money options are worthless
However, this contradicts what we observe on the option markets which
attach a positive time value also to out-of-the-money options. Hence it
follows:
Consequence: =⇒(Xt) is of inﬁnite variation !
=⇒Itˆo is a ’must’ for Option Pricing
6.4 Arrow-Debreu Prices in Finance
Let Zt = (Xt, Yt)0≤t≤T be two security price processes with Yt as nu-
meraire.
1) Yt = βt = ert
numeraire: $-today
2) Yt = Pt(T) = e−r(T−t)
numeraire: $-tomorrow
3) Yt ≡1(⇐⇒r = 0)
=⇒$-today ≡$-tomorrow

122
6 Why Do We Need Itˆo-Calculus in Finance?
W.l.o.g. we can always assume that 3) holds by using the following
transformations:
!Zt =

!
Xt = Xt
Yt
, 1

;
!H = H
YT
∈FT
contingent claim
!Vt(φ) = Vt(φ)
Yt
,
!Ht = E∗[ !H|Ft]
Ht = !Ht · Yt
back-transformation.
Consider the following special contingent claim Ht(x) ∈Ft
Ht(x) = 1{Xt≤x} =

1 Xt ≤x
0 Xt > x
(= Arrow-Debreu security contingent on value of X at time t).
AD-price at t = 0 :
AD(t, x) = E∗[Ht(x)] = P ∗[Xt ≤x] = distribution of Xt under P ∗.
AD(t, x) has density f(t, x) deﬁned by f(t, x) = lim
ϵ↓0
1
2ϵ E∗[1{|Xt−x|≤ϵ}],
or
f(t, x) dx = E∗[1Ix(Xt)]
with Ix = (x −1
2 dx , x + 1
2 dx)
= density of AD-prices, given Xt = x.
Let C(Xt) be a contingent claim on Xt. According to Prop. 1.3.1
=⇒π0(Ct) = E∗[C(Xt)] =
∞

−∞
C(x) dP ∗
X(x) =
∞

−∞
C(x) f(t, x) dx.
Example: C(t, K) = (Xt −K)+ Call
P(t, K) = (K −Xt)+ Put
By partial integration one obtains:
π0(C) =
∞

K
(x −K) f(t, x) dx =
∞

K
(1 −AD(t, x)) dx
π0(P) =
K

0
(K −x) f(t, x) dx =
K

0
AD(t, x) dx.
(3)

6.5 The Time Value of an Option as Expected Local Time
123
Consequence: AD(t, K) =
d
dK π0(P(t, K))
f(t, K) =
∂2
∂K2 π0(P(t, K)) =
∂2
∂K2 π0(C(t, K)) .
Interpretation of (3): Payoﬀat t
K

0
Ht(x) dx =
K

0
1{Xt≤x}dx = λ{0 ≤x ≤K : Xt ≤x}
=

K −Xt Xt ≤K
0
Xt > K.
Exercise: For the standard Black-Scholes model (µ, σ constant, r = 0)
one has (compare Sect. 2.9 ):
AD(t, x) = 1 −Φ(h(t, x)) = Φ(−h(t, x)) with density f(t, x) = ϕ(h)
x σ
√
t ,
where
Φ(·) is the distribution function of N(0, 1), ϕ = Φ ′, and
h(t, x) = ln(X0/x)
σ
√
t
−1
2 σ
√
t.
6.5 The Time Value of an Option as Expected Local
Time
As shown in Sect. 6.2, the local time of the process Xt in K till maturity
T is given by
LK
T (ω) = lim
ϵ↓0
1
2ϵ
T

0
1{|Xt(ω)−K|≤ϵ} d⟨X(ω)⟩t.
Under suitable boundary conditions on µX(t), σX(t) one may commute
limit and integration to obtain

124
6 Why Do We Need Itˆo-Calculus in Finance?
=⇒1
2 E∗[LK
T ] = 1
2 E∗
T

0
lim
ϵ
1
2ϵ 1{|Xt−K|≤ϵ} d⟨X⟩t

= 1
2
T

0
f(t, K) d⟨Xt⟩Xt=K
= 1
2 · { AD-price of the quadr. variation of X in K till T},
which gives a new interpretation of the time value of an option.
For the standard Black-Scholes model one has:
d⟨Xt⟩Xt=K = σ2 K2 dt
and
f(t, K) = ϕ(h(t, K))
K σ
√
t
(see Exercise in Sect. 6.4). Hence it follows:
=⇒1
2 E∗[LT
K] = 1
2 K2 σ2
T

0
f(t, K) dt = 1
2 K2σ2
T

0
ϕ(h(t, K))
K · σ
√
t
dt
= 1
2 K σ
t

0
ϕ(h(t, K)) · 1
√
t dt
Hence by Itˆo-Tanaka for CT = (XT −K)+
C0 = E∗[(XT −K)+] = (X0 −K)+ + 1
2 K σ
T

0
ϕ(h(t, K)) · 1
√
t dt
(alternative BS-formula for forward price Xt = Ft (r = 0))

7
Appendix: Itˆo Calculus Without Probabilities
S´eminaire de Probabilit´es XV
1979/80
ITO CALCULUS WITHOUT PROBABILITIES
by H. F¨ollmer
The aim of this note is to show that the Itˆo calculus can be devel-
oped “path by path” in the strict meaning of this term. We will derive
Itˆo’s formula as an exercise in analysis for a class of real functions of
quadratic variation, including the construction of the stochastic inte-
gral

F ′(Xs−)dXs, by means of Riemann sums. Only afterwards we
shall speak of probabilities in order to verify that for certain stochas-
tic processes (semimartingales, processes of ﬁnite energy,...) almost all
paths belong to this class.
Let x be a real function on [0, ∞[ which is right continuous and has left
limits (also called c`adl`ag). We will use the following notation: xt = x(t),
△xt = xt −xt−, △x2
t = (△xt)2.
We deﬁne a subdivision to be any ﬁnite sequence τ = (to, · · · , tk) such
that 0 ≤to < · · · < tk < ∞, and we put tk+1 = ∞and x∞= 0. Let
(τn)n=1,2,··· be a sequence of subdivisions whose meshes converge to 0
on each compact interval. We say that x is of quadratic variation along
(τn) if the discrete measures

126
7 Appendix: Itˆo Calculus Without Probabilities
ξn =

ti∈τn
(xti+1 −xti)2εti
(1)
converge weakly to a Radon measure ξ on [0, ∞[ whose atomic part is
given by the quadratic jumps of x:
[x, x]t = [x, x]c
t +

s≤t
△x2
s,
(2)
where [x, x] denotes the distribution function of ξ and [x, x]c its con-
tinuous part.
Theorem. Let x be of quadratic variation along (τn) and F a function
of class C2 on IR. Then the Itˆo formula
F(xt) = F(xo) +
t

0
F(xs−)dxs + 1
2

]0,t]
F
′′(xs−)d[x, x]s
(3)
+

s≤t
[F(xs) −F(xs−) −F ′(xs−)△xs −1
2F
′′(xs−)△x2
s],
holds with
t

0
F ′(xs−)dxs = lim
n

τn∋ti≤t
F ′(xti)(xti+1 −xti),
(4)
and the series in (4) is absolutely convergent.
Remark. Due to (2) the last two terms of (3) can be written as
1
2
t

0
F
′′(xs−)d[x, x]c
s +

s≤t
[F(xs) −F(xs−) −F ′(xs−)△xs],
(5)
and we have
t

0
F
′′(xs−)d[x, x]c
s =
t

0
F
′′(xs)d[x, x]c
s,
(6)

7 Appendix: Itˆo Calculus Without Probabilities
127
since x is a c`adl`ag function.
Proof. Let t > 0. Since x is right continuous we have
F(xt) −F(xo) = lim
n

τn∋ti≤t
[F(xti+1) −F(xti)].
1) For the sake of clarity we ﬁrst treat the particularly simple case
where x is a continuous function. Taylor’s formula can be written
as

τn∋ti≤t
[F(xti+1) −F(xti)] =

F ′(xti)(xti+1 −xti)
+ 1
2

F
′′(xti)(xti+1 −xti)2 +

r(xti, xti+1),
where
r(a, b) ≤ϕ(|b −a|)(b −a)2,
(7)
and where ϕ(·) is an increasing function on [0, ∞[ such that ϕ(c) →
0 for c →0·. For n ↑∞the second sum of the right hand side
converges to
1
2

[0,t]
F
′′(xs)d[x, x]s = 1
2

]0,t]
F
′′(xs−)d[x, x]s
due to the weak convergence of the discrete measures (ξn); note that
by (2) the continuity of x implies the continuity of [x, x]. The third
sum, which is dominated by
ϕ( max
τn∋ti≤t |xti+1 −xti|)

τn∋ti≤t
(xti+1 −xti)2,
converges to 0 since x is continuous. Thus one obtains the existence
of the limit (4) and Itˆo’s formula (3).

128
7 Appendix: Itˆo Calculus Without Probabilities
2) Consider now the general case. Let ε > 0. We divide the jumps of
x on [0, t] into two classes: a ﬁnite class C1 = C1(ε, t), and a class
C2 = C2(ε, t) such that

s∈C2
△x2
s ≤ε2. Let us write

τn∋ti≤t
[F(xti+1)−F(xti)] =

1[F(xti+1−F(xti)]+

2[F(xti+1−F(xti)]
where 
1 indicates the summation over those ti ∈τn with ti ≤t
for which the interval ]ti, ti+1] contains a jump of class C1. We have
lim
n

1[F(xti+1) −F(xti)] =

s∈C1
[F(xs) −F(xs−)].
On the other hand, Taylor’s formula allows us to write

2[F(xti+1) −F(xti)] =

τn∋ti≤t
F ′(xti)(xti+1 −xti) + 1
2

τn∋ti≤t
F
′′(xti)(xti+1 −xti)2
−

1[F ′(xti)(xti+1−xti)+1
2F
′′(xti)(xti+1−xti)2]+

2r(xti, xti+1)
We will show below that the second sum on the right hand side
converges to
1
2

]0,t]
F
′′(xs−)[x, x]s,
as n ↑∞; see (9). The third sum converges to

s∈C1
[F ′(xs−)△xs + 1
2F
′′(xs−)△x2
s].
Due to the uniform continuity of F
′′ on the bounded set of values
xs (0 ≤s ≤t) we can assume (7), and this implies
lim sup
n

2r(xti, xti+1) ≤ϕ(ε+)[x, x]t+.
(8)

7 Appendix: Itˆo Calculus Without Probabilities
129
Let ε converge to 0. Then (8) converges to 0, and

s∈C1(ε,t)
[F(xs) −F(xs−) −F ′(xs−)△xs] −1
2

s∈C1(ε,t)
F
′′(xs−)△x2
s
converges to the series in (3). Furthermore the series converges ab-
solutely since

s≤t
|F(xs) −F(xs−) −F ′(xs−)△xs| ≤const

s≤t
△x2
s
by Taylor’s formula. Thus we obtain the existence of the limit in (4)
and Itˆo’s formula (3).
3) Let us show that
lim
n

τn∋ti≤t
f(xti)(xti+1 −xti)2 =

]0,t]
f(xs−)d[x, x]s
(9)
for any continuous function f on IR. Let ε > 0, and denote by z the
distribution function of the jumps in class C1 = C1(ε, t), i. e.,
zu =

C1∋s≤u
△xs
(u ≥0).
We have
lim
n

τn∋ti≤u
f(xti)(zti+1 −zti)2 =

C1∋s≤u
f(xs−)△x2
s
(10)
for each u ≥0. Denote by ζn and ηn the discrete measures associated
with z and y = x −z in the sense of (1). By (10) the measures ζn
converge weakly to the discrete measure
ζ =

s∈C1
△x2
sεs.

130
7 Appendix: Itˆo Calculus Without Probabilities
Since the last sum of

τn∋ti≤u
(xti+1 −xti)2 =

(yti+1 −yti)2 +

(zti+1 −zti)2
+2

(yti+1 −yti)(zti+1 −zti)
converges to 0, the measures ηn converge weakly to the measure
η = ξ−ζ whose atomic part has total mass ≤ε2. Hence the function
f ◦x is almost surely continuous with respect to the continuous part
of η, and this implies
lim
n sup|

τn∋ti≤t
f(xti)(yti+1−yti)2−

]0,t]
f(xs−)dη|≤2 ∥f ∥t ε2
(11)
where ∥f ∥t= sup{f(xs); 0 ≤s ≤t}. Combining (10) and (11) we
obtain (9), and this completes the proof. Let us emphasize that we
have followed closely the “classical ” argument; see Meyer [4]. The
only new contribution is the use of weak convergence, which allows
us to give a completely analytic version.
Remarks.
1) Let x = (x1, · · · , xn) be a c`adl`ag function on [0, ∞[ with values in
IRn. We say that x a is of quadratic variation along (τn) if this holds
for all real functions xi, xi + xj (1 ≤i, j ≤n) . In this case we put
[xi, xj]t = 1
2([xi + xj, xi + xj]t −[xi, xi]t −[xj, xj]t)
= [xi, xj]c
t +

s≤t
△xi
s△xj
s.
Then we have the Itˆo formula
F(xt)=F(xo)+
t

0
DF(xs−)dxs + 1
2

i,j
t

0
DiDjF(xs−)d[xi, xj]c
s
+

s≤t
[F(xs) −F(xs−) −

i
DiF(xs−)△xi
s]
(12)

7 Appendix: Itˆo Calculus Without Probabilities
131
for any function F of class C2 on IRn, where
t

0
DF(xs−)dxs = lim
n

τn∋ti≤t
< DF(xti), xti+1 −xti >
(13)
(< ·, · >= scalar product on IRn). The proof is the same as above,
but with more cumbersome notation.
2) The class of functions of quadratic variation is stable with respect to
C1 - operations. More precisely, if x = (x1, · · · , xn) is of quadratic
variation along (τn) and F a continuously diﬀerentiable function on
IRn then y = F ◦x is of quadratic variation along (τn), with
[y, y]t =

i,j
t

0
DiF(xs)DjF(xs)d[xi, xj]c
s +

s≤t
△y2
s.
(14)
This is the analytic version of a result of Meyer for semimartingales,
see [4] p. 359. The proof is analogous to the previous one.
Let us now turn to stochastic processes. Let (Xt)t≥0 be a semi-
martingale. Then, for any t ≥0, the sums
Sτ,t =

τ∋ti≤t
(Xti+1 −Xti)2
(15)
converge in probability to
[X, X]t =< Xc, Xc >t +

s≤t
△X2
s
when the mesh of the subdivision τ converges to 0 on [0, t]; see Meyer
[4] p. 358. For each sequence there exists thus a subsequence (τn)
such that, almost surely,
lim
n Sτn,t = [X, X]t
(16)
for each rational t . This implies that almost all paths are of
quadratic variation along
(τn). Furthermore the relation (16) is
valid for all t ≥0 due to (9). The Itˆo formula (3), applied strictly

132
7 Appendix: Itˆo Calculus Without Probabilities
pathwise, does not depend on the sequence (τn). In particular, we
obtain the convergence in probability of the Riemann sums in (4)
to the stochastic integral
t

0
F ′(Xs−)dXs,
when the mesh of τ goes to 0 on [0, t].
Remarks.
1) For Brownian motion and an arbitrary sequence of subdivisions (τn)
with mesh tending to 0 on each compact interval, almost all paths
are of quadratic variation along (τn). Indeed, by L´evy’s theorem we
have (16) without passing to subsequences.
2) For the above argument it suﬃces to know that the sums (15)
converge in probability to an increasing process [X, X] which has
paths of the form (2). The class of processes of quadratic varia-
tion is clearly larger than the class of semimartingales: Just con-
sider a deterministic process of quadratic variation which is of un-
bounded variation. Let us mention also the processes of ﬁnite energy
X = M + A where M is a local martingale and A is a process with
paths of quadratic variation 0 along the dyadic subdivisions. These
processes occur in the probabilistic study of Dirichlet spaces: see
Fukushima [3].
3) For a semimartingale it is known how to construct the stochastic
integral

Hs−dXs (H c`adl`ag and adapted) pathwise as a limit of
Riemann sums, in the sense that the sums converge almost surely
outside an exceptional set which depends on H; see Bichteler [1].
We have just shown that for the particular needs of Itˆo calculus,
where H = f ◦X (f of class C1), the exceptional set can be chosen
in advance, independently of H. It is possible to go beyond the class
C1 by treating local times “path by path”. But not too far beyond:
Stricker [5] has just shown that an extension to continuous functions
is only possible for processes with paths of ﬁnite variation.

7 Appendix: Itˆo Calculus Without Probabilities
133
References
1) Bichteler, K.: Stochastic Integration and Lp-theory of
semimartingales. Technical report no. 5, U. of Texas (1979).
2) Dellacherie, C., et Meyer, P.A.: Probabilit´es et Potentiel;
Th´eorie des Martingales. Hermann (1980).
3) Fukushima, M.: Dirichlet forms and Markov processes. North
Holland (1980).
4) Meyer, P.A.: Un cours sur les int´egrales stochastiques. Sem.
Prob. X, LN 511 (1976).
5) Stricker, C.: Quasimartingales et variations. Sem. Prob. XV,
LN 850 (1980).

References
Bauer, H. (1996): Probability Theory. De Gruyter.
(2001): Measure and Integration Theory. De Gruyter.
Black-Derman-Toy (1990): “A one-factor model of interest rates and its
application to Treasury bond options,” Financ. Analysts Journal, 46(1),
33–39.
Black-Karasinski (1991): “Bond and option pricing when short rates are
lognormal,” Financ. Analysts Journal, 47(4), 52–59.
Black-Scholes (1973): “The pricing of options and corporate liabilities,” J.
Polit. Economy, 81, 637–654.
Brace-Gatarek-Musiela (1997): “The Market Model of Interest Rate Dy-
namics,” Mathematical Finance, 7, 127–154.
Bru, B., and M. Yor (2002): “Comments on the life and mathematical
legacy of Wolfgang Doeblin,” Finance and Stochastics, 6(1), 3–47.
Carr-Jarrow (1990): “The Stop-Loss Start-Gain Paradox and Option Val-
uation: A New Decomposition into Intrinsic and Time Value,” Review of
Fin. Studies, 3(3).
Cox-Ingersoll-Ross (1981): “A re-examination of traditional hypotheses
about the term structure of interest rates,” Journal of Finance, 36, 769–
799.
Delbaen-Schachermayer (1995): “The No-Arbitrage property under a
change of numeraire,” Stochastics Stochastic Rep., 53, 213–226.
(1997): “The Banach space of workable contingent claims in arbitrage
theory,” Ann. Inst. H.Poincar´e Prob. Statist.
Duffie, D. (2001): Dynamic Asset Pricing Theory. 3rd Ed. Princeton UP.
Elliott-Kopp (1999): Mathematics of Financial Markets. Springer.
Foellmer, H. (1981): “Calcul d’Itˆo sans probabilit´e,” Seminaire de Proba-
bilit´e XV, Springer Lect. Notes 850, 143–150.
(1991): Vorlesungsmanuskript Stochastische Analysis. Ausarbeitung
Mueck.
(1998):
“Vom
Leibniz-Kalkuel
zur
stochastischen
Analysis,”
LEOPOLDINA (R.3), 43, 249–257.

136
References
Geman-ElKaroui-Rochet (1995): “Changes of numeraire, changes of prob-
ability measures and pricing of options,” J. Appl. Probability, 32, 443–458.
Harrison-Kreps (1979): “Martingales and arbitrage in multiperiod securi-
ties markets,” Journal of Economic Theory, 20, 381–408.
Harrison-Pliska (1981): “Martingales and stochastic integrals in the theory
of continuous trading,” Stochastic Process. Appl., 11, 215–260.
Heath-Jarrow-Morton (1992): “Bond Pricing and the Term Structure of
Interest Rates,” Econometrica, 60, 77–105.
Ho-Lee (1986): “Term structure movements and pricing interest rate contin-
gent claims,” Journal of Finance, 41, 1011–1029.
Ingersoll, J. J. (1987): Theory of Financial Decision Making. Rowman and
Littleﬁeld.
Karatzas-Shreve (1988): Brownian Motion and Stochastic Calculus.
Springer.
(1998): Methods of Mathematical Finance. Springer.
Lamberton-Lapeyre (1995): Introduction to Stochastic Calculus, applied to
Finance. Chapman and Hall, London.
L´evy, P. (1965): Processus stochastiques et Mouvement Brownien, 2nd Ed.
Gauthier-Villars.
McCulloch, J. (1975): “Operational Aspects of the Siegel Paradox,” Quart.
Journal of Economics, 89, 170–172.
Merton, R. (1973): “Theory of rational option pricing,” Bell J. Econom.
Managm. Sci, 4, 141–183.
Miltersen-Sandmann-Sondermann (1997): “Closed Form Solutions for
Term Structure Derivatives with Log-Normal Interest Rates,” Journal of
Finance, 52, 409–430.
Musiela-Rutkowski (1997): Martingale Methods in Financial Modelling.
Springer.
Protter, P. (1990): Stochastic Integration and Diﬀerential Equations.
Springer.
Revuz-Yor (1991): Continuous Martingales and Brownian Motion. Springer.
Sandmann-Sondermann (1993): “A term structure model and the pricing
of interest rate derivatives,” Rev. Futures Markets, 12, 391–423.
(1994): “On the stability of lognormal interest models and the pricing
of Eurodollar futures,” Working paper, University of Bonn.
Sandmann-Sondermann-Miltersen (1995): “Closed Form Term Structure
Derivatives in a Heath–Jarrow–Morton Model with Log–normal Annually
Compounded Interest Rates,” Research Symposium Proceedings CBOT, pp.
145–164.
Shiryaev, A. (1999): Essentials of Stochastic Finance. World Schientiﬁc Sin-
gapore.
Siegel, J. (1972): “Risk, interest rates, and forward exchange,” Quart. Jour-
nal of Economics, 86, 303–309.
Vasicek, O. (1977): “An equilibrium characterisation of the term structure,”
J. Finan. Econom., 5, 177–188.

Lecture Notes in Economics 
and Mathematical Systems
For information about Vols. 1–483
please contact your bookseller or Springer-Verlag
Vol. 488: B. Schmolck, Ommitted Variable Tests and
Dynamic Specification. X, 144 pages. 2000.
Vol. 489: T. Steger, Transitional Dynamics and Econom-
ic Growth in Developing Countries. VIII, 151 pages. 2000.
Vol. 490: S. Minner, Strategic Safety Stocks in Supply
Chains. XI, 214 pages. 2000.
Vol. 491: M. Ehrgott, Multicriteria Optimization. VIII, 242
pages. 2000.
Vol. 492: T. Phan Huy, Constraint Propagation in Flexible
Manufacturing. IX, 258 pages. 2000.
Vol. 493: J. Zhu, Modular Pricing of Options. X, 170
pages. 2000.
Vol. 494: D. Franzen, Design of Master Agreements for
OTC Derivatives. VIII, 175 pages. 2001.
Vol. 495: I. Konnov, Combined Relaxation Methods for
Variational Inequalities. XI, 181 pages. 2001.
Vol. 496: P. Weiß, Unemployment in Open Economies.
XII, 226 pages. 2001.
Vol. 497: J. Inkmann, Conditional Moment Estimation of
Nonlinear Equation Systems. VIII, 214 pages. 2001.
Vol. 498: M. Reutter, A Macroeconomic Model of West
German Unemployment. X, 125 pages. 2001.
Vol. 499: A. Casajus, Focal Points in Framed Games. XI,
131 pages. 2001.
Vol. 500: F. Nardini, Technical Progress and Economic
Growth. XVII, 191 pages. 2001.
Vol. 501: M. Fleischmann, Quantitative Models for
Reverse Logistics. XI, 181 pages. 2001.
Vol. 502: N. Hadjisavvas, J. E. Martínez-Legaz, J.-P. Penot
(Eds.), Generalized Convexity and Generalized Mono-
tonicity. IX, 410 pages. 2001.
Vol. 503: A. Kirman, J.-B. Zimmermann (Eds.), Econom-
ics with Heterogenous Interacting Agents. VII, 343 pages.
2001.
Vol. 504: P.-Y. Moix (Ed.), The Measurement of Market
Risk. XI, 272 pages. 2001.
Vol. 505: S. Voß, J. R. Daduna (Eds.), Computer-Aided
Scheduling of Public Transport. XI, 466 pages. 2001.
Vol. 506: B. P. Kellerhals, Financial Pricing Models in
Con-tinuous Time and Kalman Filtering. XIV, 247 pages.
2001.
Vol. 507: M. Koksalan, S. Zionts, Multiple Criteria Deci-
sion Making in the New Millenium. XII, 481 pages. 2001.
Vol. 508: K. Neumann, C. Schwindt, J. Zimmermann,
Project Scheduling with Time Windows and Scarce
Resources. XI, 335 pages. 2002.
Vol. 509: D. Hornung, Investment, R&D, and Long-Run
Growth. XVI, 194 pages. 2002.
Vol. 510: A. S. Tangian, Constructing and Applying
Objective Functions. XII, 582 pages. 2002.
Vol. 511: M. Külpmann, Stock Market Overreaction and
Fundamental Valuation. IX, 198 pages. 2002.
Vol. 512: W.-B. Zhang, An Economic Theory of Cities.XI,
220 pages. 2002.
Vol. 513: K. Marti, Stochastic Optimization Techniques.
VIII, 364 pages. 2002.
Vol. 514: S. Wang, Y. Xia, Portfolio and Asset Pricing.
XII, 200 pages. 2002.
Vol. 515: G. Heisig, Planning Stability in Material Require-
ments Planning System. XII, 264 pages. 2002.
Vol. 516: B. Schmid, Pricing Credit Linked Financial
Instruments. X, 246 pages. 2002.
Vol. 517: H. I. Meinhardt, Cooperative Decision Making
in Common Pool Situations. VIII, 205 pages. 2002.
Vol. 518: S. Napel, Bilateral Bargaining. VIII, 188 pages.
2002.
Vol. 519: A. Klose, G. Speranza, L. N. Van Wassenhove
(Eds.), Quantitative Approaches to Distribution Logistics
and Supply Chain Management. XIII, 421 pages. 2002.
Vol. 520: B. Glaser, Efficiency versus Sustainability in
Dynamic Decision Making. IX, 252 pages. 2002.
Vol. 521: R. Cowan, N. Jonard (Eds.), Heterogenous
Agents, Interactions and Economic Performance. XIV, 
339 pages. 2003.
Vol. 522: C. Neff, Corporate Finance, Innovation, and
Strategic Competition. IX, 218 pages. 2003.
Vol. 523: W.-B. Zhang, A Theory of Interregional Dynam-
ics. XI, 231 pages. 2003.
Vol. 524: M. Frölich, Programme Evaluation and Treat-
ment Choise. VIII, 191 pages. 2003.
Vol. 525: S. Spinler, Capacity Reservation for Capital-
Intensive Technologies. XVI, 139 pages. 2003.
Vol. 526: C. F. Daganzo, A Theory of Supply Chains. VIII,
123 pages. 2003.
Vol. 527: C. E. Metz, Information Dissemination in
Currency Crises. XI, 231 pages. 2003.
Vol. 528: R. Stolletz, Performance Analysis and Optimiza-
tion of Inbound Call Centers. X, 219 pages. 2003.
Vol. 529: W. Krabs, S. W. Pickl, Analysis, Controllability
and Optimization of Time-Discrete Systems and Dynami-
cal Games. XII, 187 pages. 2003.
Vol. 530: R. Wapler, Unemployment, Market Structure
and Growth. XXVII, 207 pages. 2003.

Vol. 531: M. Gallegati, A. Kirman, M. Marsili (Eds.), The
Complex Dynamics of Economic Interaction. XV, 402
pages, 2004.
Vol. 532: K. Marti, Y. Ermoliev, G. Pflug (Eds.), Dynam-
ic Stochastic Optimization. VIII, 336 pages. 2004.
Vol. 533: G. Dudek, Collaborative Planning in Supply
Chains. X, 234 pages. 2004.
Vol. 534: M. Runkel, Environmental and Resource Poli-
cy for Consumer Durables. X, 197 pages. 2004.
Vol. 535: X. Gandibleux, M. Sevaux, K. Sörensen, 
V. T’kindt (Eds.), Metaheuristics for Multiobjective Opti-
misation. IX, 249 pages. 2004.
Vol. 536: R. Brüggemann, Model Reduction Methods for
Vector Autoregressive Processes. X, 218 pages. 2004.
Vol. 537: A. Esser, Pricing in (In)Complete Markets. XI,
122 pages, 2004.
Vol. 538: S. Kokot, The Econometrics of Sequential Trade
Models. XI, 193 pages. 2004.
Vol. 539: N. Hautsch, Modelling Irregularly Spaced
Financial Data. XII, 291 pages. 2004.
Vol. 540: H. Kraft, Optimal Portfolios with Stochastic
Interest Rates and Defaultable Assets. X, 173 pages. 2004.
Vol. 541: G.-y. Chen, X. Huang, X. Yang, Vector Optimi-
zation. X, 306 pages. 2005.
Vol. 542: J. Lingens, Union Wage Bargaining and Econom-
ic Growth. XIII, 199 pages. 2004.
Vol. 543: C. Benkert, Default Risk in Bond and Credit
Derivatives Markets. IX, 135 pages. 2004.
Vol. 544: B. Fleischmann, A. Klose, Distribution Logis-
tics. X, 284 pages. 2004.
Vol. 545: R. Hafner, Stochastic Implied Volatility. XI, 229
pages. 2004.
Vol. 546: D. Quadt, Lot-Sizing and Scheduling for Flexi-
ble Flow Lines. XVIII, 227 pages. 2004.
Vol. 547: M. Wildi, Signal Extraction. XI, 279 pages. 
2005.
Vol. 548: D. Kuhn, Generalized Bounds for Convex Multi-
stage Stochastic Programs. XI, 190 pages. 2005.
Vol. 549: G. N. Krieg, Kanban-Controlled Manufacturing
Systems. IX, 236 pages. 2005.
Vol. 550: T. Lux, S. Reitz, E. Samanidou, Nonlinear
Dynamics and Heterogeneous Interacting Agents. XIII,
327 pages. 2005.
Vol. 551: J. Leskow, M. Puchet Anyul, L. F. Punzo, New
Tools of Economic Dynamics. XIX, 392 pages. 2005.
Vol. 552: C. Suerie, Time Continuity in Discrete Time
Models. XVIII, 229 pages. 2005.
Vol. 553: B. Mönch, Strategic Trading in Illiquid Markets.
XIII, 116 pages. 2005. 
Vol. 554: R. Foellmi, Consumption Structure and Macro-
economics. IX, 152 pages. 2005.
Vol. 555: J. Wenzelburger, Learning in Economic Systems
with Expectations Feedback (planned) 2005.
Vol. 556: R. Branzei, D. Dimitrov, S. Tijs, Models in
Cooperative Game Theory. VIII, 135 pages. 2005.
Vol. 557: S. Barbaro, Equity and Efficiency Considera-
tions of Public Higer Education. XII, 128 pages. 2005.
Vol. 558: M. Faliva, M. G. Zoia, Topics in Dynamic Mod-
el Analysis. X, 144 pages. 2005.
Vol. 559: M. Schulmerich, Real Options Valuation. XVI,
357 pages. 2005.
Vol. 560: A. von Schemde, Index and Stability in Bima-
trix Games. X, 151 pages. 2005.
Vol. 561: H. Bobzin, Principles of Network Economics.
XX, 390 pages. 2006. 
Vol. 562: T. Langenberg, Standardization and Expecta-
tions. IX, 132 pages. 2006.
Vol. 563: A. Seeger (Ed.), Recent Advances in Optimiza-
tion. XI, 455 pages. 2006.
Vol. 564: P. Mathieu, B. Beaufils, O. Brandouy (Eds.),
Artificial Economics. XIII, 237 pages. 2005.
Vol. 565: W. Lemke, Term Structure Modeling and Esti-
mation in a State Space Framework. IX, 224 pages. 2006. 
Vol. 566: M. Genser, A Structural Framework for the
Pricing of Corporate Securities. XIX, 176 pages. 2006.
Vol. 567: A. Namatame, T. Kaizouji, Y. Aruga (Eds.), The
Complex Networks of Economic Interactions. XI, 343
pages. 2006. 
Vol. 568: M. Caliendo, Microeconometric Evaluation of
Labour Market Policies. XVII, 258 pages. 2006.
Vol. 569: L. Neubecker, Strategic Competition in Oligo-
polies with Fluctuating Demand. IX, 233 pages. 2006.
Vol. 570: J. Woo, The Political Economy of Fiscal Policy.
X, 169 pages. 2006. 
Vol. 571: T. Herwig, Market-Conform Valuation of Options.
VIII, 104 pages. 2006.
Vol. 572: M. F. Jäkel, Pensionomics. XII, 316 pages. 
2006
Vol. 573: J. Emami Namini, International Trade and Multi-
national Activity, X, 159 pages, 2006.
Vol. 574: R. Kleber, Dynamic Inventory Management 
in Reverse Logisnes, XII, 181 pages, 2006.
Vol. 575: R. Hellermann, Capacity Options for Revenue
Management, XV, 199 pages, 2006.
Vol. 576: J. Zajac, Economics Dynamics, Information and
Equilibnum, X, 284 pages, 2006.
Vol. 577: K. Rudolph, Bargaining Power Effects in Finan-
cial Contracting, XVIII, 330 pages, 2006.
Vol. 578: J. Kühn, Optimal Risk-Return Trade-Offs of Com-
mercial Banks, IX, 149 pages, 2006.
Vol. 579: D. Sondermann, Introduction to Stochastic Cal-
culus for Finance, X, 136 pages, 2006.
Vol. 580: S. Seifert, Posted Price Offers in Internet Auc-
tion Markets, IX, 186 pages, 2006.
Vol. 581: K. Marti; Y. Ermoliev; M. Makowsk; G. Pflug
(Eds.), Coping with Uncertainty, XIII, 330 pages, 2006
(planned).

