Lecture Notes in Economics 
and Mathematical Systems
579
Founding Editors:
M. Beckmann
H.P. KÃ¼nzi
Managing Editors:
Prof. Dr. G. Fandel
Fachbereich Wirtschaftswissenschaften
FernuniversitÃ¤t Hagen
Feithstr. 140/AVZ II, 58084 Hagen, Germany
Prof. Dr. W. Trockel
Institut fÃ¼r Mathematische Wirtschaftsforschung (IMW)
UniversitÃ¤t Bielefeld
UniversitÃ¤tsstr. 25, 33615 Bielefeld, Germany
Editorial Board:
A. Basile, A. Drexl, H. Dawid, K. Inderfurth, W. KÃ¼rsten, U. Schittko

Dieter Sondermann
Introduction
to Stochastic Calculus 
for Finance
A New Didactic Approach
With 6 Figures
123

Prof. Dr. Dieter Sondermann
Department of Economics
University of Bonn 
Adenauer Allee 24
53113 Bonn, Germany
E-mail: sondermann@uni-bonn.de
ISBN-10 3-540-34836-0
Springer Berlin Heidelberg New York
ISBN-13 978-3-540-34836-8
Springer Berlin Heidelberg New York
This work is subject to copyright. All rights are reserved, whether the whole or part of 
the material is concerned, speciï¬cally the rights of translation, reprinting, reuse of
illustrations, recitation, broadcasting, reproduction on microï¬lm or in any other way, 
and storage in data banks. Duplication of this publication or parts thereof is permitted
only under the provisions of the German Copyright Law of September 9, 1965, in its 
current version, and permission for use must always be obtained from Springer-Verlag.
Violations are liable for prosecution under the German Copyright Law.
Springer is a part of Springer Science+Business Media
springeronline.com
Â© Springer-Verlag Berlin Heidelberg 2006
Printed in Germany
The use of general descriptive names, registered names, trademarks, etc. in this publi-
cation does not imply, even in the absence of a speciï¬c statement, that such names are
exempt from the relevant protective laws and regulations and therefore free for general
use.
Typesetting: Camera ready by author
Cover: Erich Kirchner, Heidelberg
Production: LE-TEX, Jelonek, Schmidt & VÃ¶ckler GbR, Leipzig
SPIN 11769675
Printed on acid-free paper â€“ 42/3100 â€“ 5 4 3 2 1 0

To Freddy, Hans and Marek, who patiently helped me to a
deeper understanding of stochastic calculus.

Preface
There are by now numerous excellent books available on stochastic cal-
culus with speciï¬c applications to ï¬nance, such as Duï¬ƒe (2001), Elliott-
Kopp (1999), Karatzas-Shreve (1998), Lamberton-Lapeyre (1995), and
Shiryaev (1999) on diï¬€erent levels of mathematical sophistication.
What justiï¬es another contribution to this subject? The motivation is
mainly pedagogical. These notes start with an elementary approach to
continuous time methods of ItË†oâ€™s calculus due to FÂ¨ollmer. In an funda-
mental, but not well-known paper published in French in the Seminaire
de ProbabilitÂ´e in 1981 (see Foellmer (1981)), FÂ¨ollmer showed that one
can develop ItË†oâ€™s calculus without probabilities as an exercise in real
analysis. 1
The notes are based on courses oï¬€ered regularly to graduate students
in economics and mathematics at the University of Bonn choosing â€œï¬-
nancial economicsâ€ as special topic. To students interested in ï¬nance
the course opens a quick (but by no means â€œdirtyâ€) road to the tools
required for advanced ï¬nance. One can start the course with what they
know about real analysis (e.g. Taylorâ€™s Theorem) and basic probability
theory as usually taught in undergraduate courses in economic depart-
ments and business schools. What is needed beyond (collected in Chap.
1) can be explained, if necessary, in a few introductory hours.
The content of these notes was also presented, sometimes in condensed
form, to MA students at the IMPA in Rio, ETH ZÂ¨urich, to practi-
1 An English translation of FÂ¨ollmerâ€™s paper is added to these notes in the Appendix.
In Chap. 2 we use FÂ¨ollmerâ€™s approach only for the relative simple case of processes
with continuous paths. FÂ¨ollmer also treats the more diï¬ƒcult case of jump-diï¬€usion
processes, a topic deliberately left out in these notes.

VIII
Preface
tioners in the ï¬nance industry, and to PhD students and professors of
mathematics at the Weizmann institute. There was always a positive
feedback. In particular, the pathwise FÂ¨ollmer approach to stochastic
calculus was appreciated also by mathematicians not so much famil-
iar with stochastics, but interested in mathematical ï¬nance. Thus the
course proved suitable for a broad range of participants with quite dif-
ferent background.
I am greatly indebted to many people who have contributed to this
course. In particular I am indebted to Hans FÂ¨ollmer for generously al-
lowing me to use his lecture notes in stochastics. Most of Chapter 2 and
part of Chapter 3 follows closely his lecture. Without his contribution
these notes would not exist. Special thanks are due to my assistants, in
particular to RÂ¨udiger Frey, Antje Mahayni, Philipp SchÂ¨onbucher, and
Frank Thierbach. They have accompanied my courses in Bonn with
great enthusiasm, leading the students with engagement through the
demanding course material in tutorials and contributing many useful
exercises. I also proï¬ted from their critical remarks and from comments
made by Freddy Delbaen, Klaus SchÂ¨urger, Michael Suchanecki, and an
unknown referee. Finally, I am grateful to all those students who have
helped in typesetting, in particular to Florian SchrÂ¨oder.
Bonn, June 2006
Dieter Sondermann

Contents
Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1
1
Preliminaries . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
3
1.1 Brief Sketch of Lebesgueâ€™s Integral . . . . . . . . . . . . . . . . . . .
3
1.2 Convergence Concepts for Random Variables . . . . . . . . . .
7
1.3 The Lebesgue-Stieltjes Integral. . . . . . . . . . . . . . . . . . . . . . . 10
1.4 Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13
2
Introduction to ItË†o-Calculus . . . . . . . . . . . . . . . . . . . . . . . . . 15
2.1 Stochastic Calculus vs. Classical Calculus . . . . . . . . . . . . . 15
2.2 Quadratic Variation and 1-dimensional ItË†o-Formula . . . . 18
2.3 Covariation and Multidimensional ItË†o-Formula . . . . . . . . . 26
2.4 Examples . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31
2.5 First Application to Financial Markets . . . . . . . . . . . . . . . . 33
2.6 Stopping Times and Local Martingales . . . . . . . . . . . . . . . . 36
2.7 Local Martingales and Semimartingales . . . . . . . . . . . . . . . 44
2.8 ItË†oâ€™s Representation Theorem . . . . . . . . . . . . . . . . . . . . . . . . 49
2.9 Application to Option Pricing . . . . . . . . . . . . . . . . . . . . . . . 50
3
The Girsanov Transformation . . . . . . . . . . . . . . . . . . . . . . . . 55
3.1 Heuristic Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 55
3.2 The General Girsanov Transformation . . . . . . . . . . . . . . . . 58
3.3 Application to Brownian Motion . . . . . . . . . . . . . . . . . . . . . 63
4
Application to Financial Economics . . . . . . . . . . . . . . . . . . 67
4.1 The Market Price of Risk and Risk-neutral Valuation . . . 68
4.2 The Fundamental Pricing Rule . . . . . . . . . . . . . . . . . . . . . . . 73
4.3 Connection with the PDE-Approach
(Feynman-Kac Formula) . . . . . . . . . . . . . . . . . . . . . . . . . . . . 76

X
Contents
4.4 Currency Options and Siegel-Paradox . . . . . . . . . . . . . . . . . 78
4.5 Change of Numeraire . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 79
4.6 Solution of the Siegel-Paradox . . . . . . . . . . . . . . . . . . . . . . . 84
4.7 Admissible Strategies and Arbitrage-free Pricing . . . . . . . 86
4.8 The â€œForward Measureâ€ . . . . . . . . . . . . . . . . . . . . . . . . . . . . 89
4.9 Option Pricing Under Stochastic Interest Rates . . . . . . . . 92
5
Term Structure Models . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 95
5.1 Diï¬€erent Descriptions of the Term Structure of Interest
Rates . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 96
5.2 Stochastics of the Term Structure . . . . . . . . . . . . . . . . . . . . 99
5.3 The HJM-Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 102
5.4 Examples . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 105
5.5 The â€œLIBOR Marketâ€ Model . . . . . . . . . . . . . . . . . . . . . . . . 107
5.6 Caps, Floors and Swaps . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 111
6
Why Do We Need ItË†o-Calculus in Finance? . . . . . . . . . . 113
6.1 The Buy-Sell-Paradox . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 114
6.2 Local Times and Generalized ItË†o Formula . . . . . . . . . . . . . 115
6.3 Solution of the Buy-Sell-Paradox . . . . . . . . . . . . . . . . . . . . . 120
6.4 Arrow-Debreu Prices in Finance. . . . . . . . . . . . . . . . . . . . . . 121
6.5 The Time Value of an Option as Expected Local Time . . 123
7
Appendix: ItË†o Calculus Without Probabilities . . . . . . . . 125
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 135

Introduction
The lecture notes are organized as follows: Chapter 1 gives a concise
overview of the theory of Lebesgue and Stieltjes integration and con-
vergence theorems used repeatedly in this course. For mathematic stu-
dents, familiar e.g. with the content of Bauer (1996) or Bauer (2001),
this chapter can be skipped or used as additional reference .
Chapter 2 follows closely FÂ¨ollmerâ€™s approach to ItË†oâ€™s calculus, and is
to a large extent based on lectures given by him in Bonn (see Foellmer
(1991)). A motivation for this approach is given in Sect. 2.1. This sec-
tion provides a good introduction to the course, since it starts with
familiar concepts from real analysis.
In Chap. 3 the Girsanov transformation is treated in more detail, as
usually contained in mathematical ï¬nance textbooks. Sect. 3.2 is taken
from Revuz-Yor (1991) and is basic for the following applications to
ï¬nance.
The core of this lecture is Chapter 4, which presents the fundamen-
tals of â€œï¬nancial economicsâ€ in continuous time, such as the market
price of risk, the no-arbitrage principle, the fundamental pricing rule
and its invariance under numeraire changes. Special emphasis is laid
on the economic interpretation of the so-called â€œrisk-neutralâ€ arbitrage
measure and its relation to the â€œreal worldâ€ measure considered in gen-
eral equilibrium theory, a topic sometimes leading to confusion between
economists and ï¬nancial engineers.
Using the general Girsanov transformation, as developed in Sect. 3.2,
the rather intricate problem of the change of numeraire can be treated
in a rigorous manner, and the so-called â€œtwo-countryâ€ or â€œSiegelâ€ para-
dox serves as an illustration. The section on Feynman-Kac relates the
martingal approach used explicitly in these notes to the more classical
approach based on partial diï¬€erential equations.
In Chap. 5 the preceding methods are applied to term structure mod-
els. By looking at a term structure model in continuous time in the
general form of Heath-Jarrow-Morton (1992) as an inï¬nite collection
of assets (the zerobonds of diï¬€erent maturities), the methods developed
in Chap. 4 can be applied without modiï¬cation to this situation. Read-
ers who have gone through the original articles of HJM may appreciate
the simplicity of this approach, which leads to the basic results of HJM

2
Introduction
in a straightforward way. The same applies to the now quite popular
Libor Market Model treated in Sect. 5.5 .
Chapter 6 presents some more advanced topics of stochastic calculus
such as local times and the generalized ItË†o formula. The basic question
here is: Does one really need the apparatus of ItË†oâ€™s calculus in ï¬nance?
A question which is tantamount to : are charts of ï¬nancial assets in re-
ality of unbounded variation? The answer is YES, as any practitioner
experienced in â€œdelta-hedgingâ€ can conï¬rm. Chapter 6 provides the
theoretical background for this phenomenon.

1
Preliminaries
Recommended literature :
(Bauer 1996), (Bauer 2001)
We assume that the reader is familiar with the following basic con-
cepts:
(â„¦, F, P) is a probability space, i.e.
F is a Ïƒ-algebra of subsets of the nonempty set â„¦
P is a Ïƒ-additive measure on (â„¦, F) with P[â„¦] = 1
X is a random variable on (â„¦, F, P) with values in IR := [âˆ’âˆ, âˆ], i.e.
X is a map X : â„¦âˆ’â†’IR with [X â‰¤a] âˆˆF for all a âˆˆIR
1.1 Brief Sketch of Lebesgueâ€™s Integral
The Lebesgue integral of a random variable X can be deï¬ned in three
steps.
(a) For a discrete random variable of the form X =
n
i=1
Î±i 1Ai , Î±i âˆˆIR,
Ai âˆˆF the integral (resp. the expectation) of X is deï¬ned as
E[X] :=

â„¦
X(Ï‰) dP(Ï‰) :=

i
Î±i P[Ai].

4
1 Preliminaries
Note: In the following we will drop the argument Ï‰ in the integral
and write shortly

â„¦
X dP .
Let E denote the set of all discrete random variables.
(b) Consider the set of all random variables which are monotone limits
of discrete random variables, i.e. deï¬ne
Eâˆ—:=

X : âˆƒ
u1 â‰¤. . . , un âˆˆE , un â†‘X

Remark: X random variable with X â‰¥0 =â‡’X âˆˆEâˆ—.
For X âˆˆEâˆ—deï¬ne

â„¦
X dP :=
lim
nâˆ’â†’âˆ

â„¦
un dP.
(c) For an arbitrary random variable X consider the decomposition
X = X+ âˆ’Xâˆ’with
X+ := sup(X, 0)
,
Xâˆ’:= sup(âˆ’X, 0).
According to (b), X+ , Xâˆ’âˆˆEâˆ—.
If either E[X+] < âˆor E[Xâˆ’] < âˆ, deï¬ne

â„¦
X dP :=

â„¦
X+ dP âˆ’

â„¦
Xâˆ’dP.
Properties of the Lebesgue Integral:
â€¢
Linearity :

â„¦
(Î± X + Î² Y ) dP = Î±

â„¦
X dP + Î²

â„¦
Y dP
â€¢
Positivity : X â‰¥0 implies

X dP â‰¥0 and

X dP > 0 â‡â‡’P[X > 0] > 0.

1.1 Brief Sketch of Lebesgueâ€™s Integral
5
â€¢
Monotone Convergence (Beppo Levi).
Let (Xn) be a monotone sequence of random variables (i.e. Xn â‰¤
Xn+1) with X1 â‰¥C. Then
X := lim
n Xn âˆˆEâˆ—
and
lim
nâˆ’â†’âˆ

â„¦
Xn dP =

â„¦
lim
nâˆ’â†’âˆXn dP =

â„¦
X dP.
â€¢
Fatouâ€™s Lemma
(i) For any sequence (Xn) of random variables which are bounded
from below one has

â„¦
lim
nâˆ’â†’âˆinf Xn dP â‰¤
lim
nâˆ’â†’âˆinf

â„¦
Xn dP.
(ii) For any sequence (Xn) of random variables bounded from above
one has

â„¦
lim
nâˆ’â†’âˆsup Xn dP â‰¥
lim
nâˆ’â†’âˆsup

â„¦
Xn dP.
â€¢
Jensenâ€™s Inequality
Let X be an integrable random variable with values in IR and u :
IR âˆ’â†’Â¯IR a convex function.
Then one has
u(E[X]) â‰¤E[u(X)].
Jensenâ€™s inequality is frequently applied, e.g. to u(X) = |X| , u(X) =
eX or u(X) = [X âˆ’a]+.
Lp-Spaces (1 â‰¤p < âˆ)
Lp(â„¦) denotes the set of all real-valued random variables X on (â„¦, F, P)
with E[|X|p] < âˆfor some 1 â‰¤p < âˆ. For X âˆˆLp, the Lp-norm is
deï¬ned as
||X||p :=

E[|X|p]
 1
p .

6
1 Preliminaries
The Lp-norm has the following properties:
(a) HÂ¨olderâ€™s Inequality
Given X âˆˆLp(â„¦) and Y âˆˆLq(â„¦) with 1
p + 1
q = 1, one has

â„¦
|X| Â· |Y | dP â‰¤
 
â„¦
|X|p dP
 1
p Â·
 
â„¦
|Y |q dP
 1
q dP < âˆ,
In particular, since |X Â· Y | â‰¤|X| Â· |Y |, implies X Â· Y âˆˆL1(â„¦).
(b) Lp(â„¦) is a normed vector space. In particular, X, Y âˆˆLp implies
X + Y âˆˆLp and one has
||X + Y ||p â‰¤||X||p + ||Y ||p.
(triangle inequality)
(c) Lq âŠ‚Lp for p < q.
Important special case: p = 2.
On L2, the vector space of quadratically integrable random variables,
there exists even a scalar product deï¬ned by
âŸ¨X, Y âŸ©:=

â„¦
X Â· Y dP
Hence one has
||X||2 =
	
âŸ¨X, XâŸ©
and HÂ¨olderâ€™s inequality takes the form
âŸ¨X, Y âŸ©=

â„¦
X Â· Y dP â‰¤||X||2 Â· ||Y ||2.

1.2 Convergence Concepts for Random Variables
7
1.2 Convergence Concepts for Random Variables
The strength of the Lebesgue integral, as compared with the Riemann
integral, consists in limit theorems - notably â€™Lebesgueâ€™s Theoremâ€™ -
which allow to study the limit of random variables and their integrals.
Without the limit theorems - provided by the Lebesgue integration the-
ory - stochastic analysis would be impossible.
In this section we collect the basic convergence concepts for sequences
of random variables and their relationships.
Deï¬nition 1.2.1. Let (Xn)nâˆˆIIN , X be random variables on (â„¦, F, P).
(a) The sequence (Xn) converges to X P-almost surely if
P

{Ï‰ : Xn(Ï‰) âˆ’â†’X(Ï‰)}

= 1.
We will then write Xn âˆ’â†’X P-a.s.
(b) The sequence (Xn) converges in probability if, for every Ïµ > 0
lim
nâˆ’â†’âˆP

|Xn âˆ’X| > Ïµ

= 0.
We will then write P âˆ’lim Xn = X.
(c) Let (Xn) be in Lp(â„¦) for some p âˆˆ[1, âˆ).
The sequence (Xn) converges to X in Lp if
lim
nâˆ’â†’âˆ||Xn âˆ’X||p =
lim
nâˆ’â†’âˆ

E[|Xn âˆ’X|p]
 1
p = 0.
We will then write Xn âˆ’â†’X in Lp or Xn
Lp
âˆ’â†’X. (X is then also
in Lp).
Still another convergence concept for random variables is that of weak
convergence, also called convergence in distribution. Since here only the
distributions of a random variable matter, the random variables Xn
may be deï¬ned on diï¬€erent probability spaces. Let
Xn : (â„¦n, Fn, P n) âˆ’â†’E and X : (â„¦, F, P) âˆ’â†’E
be random variables with values in a metric space E (e.g. E = IR or
E = C[0, T] the space of all continuous real-valued functions on [0, T]).

8
1 Preliminaries
Deï¬nition 1.2.2. The sequence (Xn) converges to X weakly (or
in distribution) if, for every continuous bounded function f : E âˆ’â†’IR,
lim
nâˆ’â†’âˆ

â„¦n
f(Xn) dPn =
lim
nâˆ’â†’âˆ

â„¦
f(X) dP.
We will then write Xn âˆ’â†’X weakly or Xn
D
âˆ’â†’X.
Relations between the diï¬€erent notions of convergence
(a) a.s.-convergence and convergence in probability
(i) Xn âˆ’â†’X P-a.s. =â‡’P âˆ’lim Xn = X
(ii) P âˆ’lim Xn = X =â‡’âˆƒsubsequence (Xnâ€²) of (Xn)
with Xnâ€² âˆ’â†’X Pâˆ’a.s.
(b) Convergence in probability and L1-convergence
Assume Xn âˆ’â†’X in L1.


â„¦
Xn dP âˆ’

â„¦
X dP

â‰¤

â„¦
|Xn âˆ’X| dP âˆ’â†’0
and hence
lim
nâˆ’â†’âˆ

â„¦
Xn dP
=

â„¦
lim
nâˆ’â†’âˆXn dP
Thus L1-convergence allows to exchange limit and integration, a
most important property for stochastic calculus.
Clearly L1-convergence implies convergence in probability. The fol-
lowing simple example shows that the converse does not hold.
Example:
Let â„¦= [0, 1], F = Borel-Ïƒ-Algebra and P = Lebesgue measure.
Consider the sequence Xn(Ï‰) := n Â· 1[0,1/n]. Then Xn âˆ’â†’0 P-a.s.,
hence also in probability. But

â„¦
Xn dP = 1, for all n.

1.2 Convergence Concepts for Random Variables
9
The above example shows that an additional condition is needed
which prevents the Xn from growing too fast. A suï¬ƒcient condition
(which is also necessary) is the following
Deï¬nition 1.2.3. The sequence (Xn) is called uniformly integrable
if
lim
Câˆ’â†’âˆsup
n

|Xn|>C
|Xn| dP = 0.
Suï¬ƒcient conditions for uniform integrability are the following:
1. sup
n
E[|X|p] < âˆfor some p > 1,
2. There exists a random variable Y âˆˆL1 such that |Xn| â‰¤Y P-
a.s. for all n.
Condition 2. is Lebesgueâ€™s â€™dominated convergenceâ€™ condition.
The relation between L1-convergence and convergence in probabil-
ity is now given by
Proposition 1.2.4. (Lebesgue) The following are equivalent:
1. P âˆ’lim Xn = X and (Xn) is uniformly integrable,
2. Xn âˆ’â†’X in L1.
Application: (Changing the order of diï¬€erentiation and integra-
tion)
Let X : IRÃ—â„¦âˆ’â†’IR be a family of random variables X(t, Â·), which
is, for P-a.e. Ï‰ âˆˆâ„¦, diï¬€erentiable in t. If there exists a random vari-
able Y âˆˆL1(â„¦) such that
| Ë™X(t, Ï‰)| â‰¤Y (Ï‰)
P-a.s.
then the function t âˆ’â†’

â„¦
X(t, Ï‰) dP(Ï‰) is diï¬€erentiable in t and
its derivative is

â„¦
Ë™X(t, Ï‰) dP(Ï‰).

10
1 Preliminaries
(c) Convergence in distribution and convergence in probability
Convergence in probability always implies convergence in distribu-
tion, i.e.
P âˆ’lim Xn = X =â‡’Xn
D
âˆ’â†’X.
The converse only holds if the limit X is P-a.s. constant.
1.3 The Lebesgue-Stieltjes Integral
From an elementary statistics course the following concepts and nota-
tions should be well-known.
Consider a real-valued random variable X on (â„¦, F, P) and a Borel-
measurable mapping f : IR âˆ’â†’IR. I.e. we have
(â„¦, F, P) X
âˆ’â†’(IR, B, PX)
fâˆ’â†’IR with
PX[B] := P[Xâˆ’1(B)]
distribution of X
FX(x) := PX

] âˆ’âˆ, x]

= P[X â‰¤x]
distribution function of X.
Then the (Lebesgues-Stieltjes) integral

IR
f(x) dFX(x) is well deï¬ned
due to the following integral transformation formula:
Proposition 1.3.1.

â„¦
f â—¦X dP =

IR
f dPX =

IR
f(x) dFX(x).
Proof. Let f = 1B be the characteristic function of the Borel set B âˆˆB.
Then by deï¬nition of PX and FX one has

â„¦
f â—¦X dP =

1Xâˆ’1(B)dP = P[Xâˆ’1(B)] = PX(B) =

IR
f dPX.
By linearity of the integral operator the relation is then also true for all
step functions f âˆˆE. By Beppo Leviâ€™s monotone convergence theorem
it extends to all f âˆˆEâˆ—and hence to all integrable functions f =
f+ âˆ’fâˆ’with f+, fâˆ’âˆˆEâˆ—.
âŠ“âŠ”

1.3 The Lebesgue-Stieltjes Integral
11
Corollary 1.3.2.
f â—¦X âˆˆL1(â„¦, P) =â‡’f âˆˆL1(IR, PX).
Hence integration on â„¦is reduced to integration on IR. In particular,
the moments of a random variable X can be computed as Lebesgue-
Stieltjes integral with respect to FX via
f(x) = xr =â‡’E[Xr] =

IR
xr dFX.
We recall two well-known facts from elementary statistics.
Properties of F = FX:
(i) F is isotone, i.e. x â‰¤y =â‡’F(x) â‰¤F(y),
(ii) F is right continuous,
(iii)
lim
xâˆ’â†’âˆ’âˆF(x) = 0;
lim
xâˆ’â†’âˆF(x) = 1.
Remark 1.1. (i) implies that F has left limits. Together with (ii) this
property is often called â€™c`adl`agâ€™ (from the French â€œcontinu `a droite -
limites `a gaucheâ€).
Proposition 1.3.3. X is a real random variable on (â„¦, F, P) â‡â‡’FX
satisï¬es (i) - (iii)
Then, for any distribution function F and any Lebesgue-integrable real
function f, the Lebesgue-Stieltjes Integral

IR
f dF is well-deï¬ned and
known from elementary statistics courses.
Generalization to functions of ï¬nite variation
We now consider real-valued right-continuous functions A on the time
interval [0, âˆ[. The value of A at time t is denoted by A(t) or At (Note
that the integration variable x is now replaced by t).
Let Î  be the set of all ï¬nite subdivisions Ï€ of the interval [0, t] with
0 = t0 < t1 < . . . < tn = t. Consider the sum
V Ï€
t :=
nâˆ’1

i=0
|Ati+1 âˆ’Ati|
Deï¬nition 1.3.4. The function A is of ï¬nite variation if, for every t,
Vt(A) = sup
Ï€âˆˆÎ 
V Ï€
t < +âˆ.

12
1 Preliminaries
The function t âˆ’â†’Vt is called the total variation of A. Let FV(IR+) de-
note the set of all real-valued right-continuous functions on IR+ = [0, âˆ[
of ï¬nite variation.
Proposition 1.3.5. Every A âˆˆFV(IR+) is the diï¬€erence of two iso-
tone c`adl`ag functions.
Proof. Obviously
At = 1
2 (Vt + At) âˆ’1
2 (Vt âˆ’At) = A+
t âˆ’Aâˆ’
t
Both terms are also right-continuous and clearly isotone, hence c`adl`ag.
âŠ“âŠ”
As a result the function A has left limits at every t âˆˆ]0, âˆ[. We write
Atâˆ’= lim
sâ†—t As and set A0âˆ’= 0.
In exactly the same way as a distribution function FX deï¬nes a measure
PX on (IR, B) via PX

] âˆ’âˆ, x]

= FX(x), every A âˆˆFV(IR+) deï¬nes
a measure ÂµA on (IR+, B) given by
Âµ([0, t]) = At.
Note: Of course ÂµA is no longer a probability measure and may take
negative values. Such a measure is called a signed measure.
Likewise as for distribution functions one has
Âµ([0, t[) = Atâˆ’
and
Âµ({t}) = ÂµA+ âˆ’ÂµAâˆ’= âˆ†At
is the mass of Âµ concentrated in point t. Proposition 1.3.5 leads to the
decomposition
ÂµA = ÂµA+ âˆ’ÂµAâˆ’
into two positive measures. Hence for any B-measurable real-valued
function f on IR+, the Lebesgue-Stieltjes integral is well deï¬ned as

f dÂµ =

f dÂµ+ âˆ’

f dÂµâˆ’=

f(s) Âµ(ds) =

f(s) dA(s).

1.4 Exercises
13
Deï¬nition 1.3.6.
t

0
fs dAs :=

1]0,t](s) fs dAs is called the integral
of f with respect to A integrated over the interval ]0, t].
In particular, it follows
t

0
dAs = Âµ([0, t]) âˆ’Âµ({0}) = At âˆ’A0.
1.4 Exercises
Sect. 1.1
1. Show that the Deï¬nition 1.1(a) is independent of the representation
of X âˆˆE.
(Hint: If X =
n
i=1
Î±i 1Ai =
m

J=1
Î²j 1Bj use a joint partition of â„¦as
new representation)
2. Show that the Deï¬nition 1.1(b) is independent of the approximating
sequence of X âˆˆEâˆ—.
Sect. 1.2
1. Let â„¦= [0, 1] be the unit interval with F the Ïƒ-algebra of Borel
sets and P the Lebesgue measure. Consider the following sequence
Xn(Ï‰) : [0, 1] âˆ’â†’IR :
X1(Ï‰) =1[0,1/2], i.e. X1(Ï‰) =

1,
Ï‰ âˆˆ[0, 1/2]
0,
Ï‰ âˆˆ[1/2, 1]
X2(Ï‰) =1[1/2,1]
X3(Ï‰) =1[0,1/3], X4(Ï‰) = 1[1/3,2/3], X5(Ï‰) = 1[2/3,1]
X6(Ï‰) =1[0,1/4], . . . , X9(Ï‰) = 1[3/4,1]
etc.
Show that (Xn) converges in probability, but does not converge P-
a.s.

14
1 Preliminaries
2. Consider (â„¦, F, P) as in exercise 1. Deï¬ne the sequence Xn by
Xn(Ï‰) =

0,
Ï‰ < 1
2
1,
Ï‰ â‰¥1
2
for n even
Xn(Ï‰) =

1,
Ï‰ < 1
2
0,
Ï‰ â‰¥1
2
for n odd
Show that Xn converges in distribution, but not in probability.

2
Introduction to ItË†o-Calculus
This chapter is based on Foellmer (1981) and follows closely Foellmer
(1991). For the techniques used in this chapter we refer to Chap. 1, or
to Bauer (1996) resp. Bauer (2001). Some results are quoted (without
proof) from Protter (1990) and Revuz-Yor (1991).
The ï¬rst elementary applications to option pricing in this chapter deal
with the standard Black-Scholes model (Black-Scholes (1973)), ï¬rst by
means of the classical PDE approach (Sect. 2.5), then by using the
martingale approach (Sect. 2.9).
2.1 Stochastic Calculus vs. Classical Calculus
Let X : [0, âˆ] â†£IR be a real-valued function X(t) = Xt. For example
the function Xt can describe the speed or the acceleration of a solid
body in dependence of time t. But Xt can also represent the price of a
security over time, called the chart of the security X. However, there is
a fundamental diï¬€erence between the two interpretations. In the ï¬rst
case X as a function of t is a â€œsmoothâ€ function, not only continuous
(natura non facit saltus!), but also (suï¬ƒciently often) diï¬€erentiable. For
this class of functions the well-known tools of classical calculus apply.
Using the notation
Ë™Xt := dXt
dt
for the diï¬€erentiation of Xt w.r.t. time
t, as common in physics, the basic relation between diï¬€erentiation and
integration can be stated as
Xt = X0 +
t

0
Ë™Xsds

16
2 Introduction to ItË†o-Calculus
or
dXt = Ë™Xtdt.
Let F âˆˆC2(IR) be a twice continuously diï¬€erentiable real-valued func-
tion on the real line IR. Then Taylorâ€™s theorem states
â–³F(Xt) = F(Xt+â–³t) âˆ’F(Xt) = F â€²(Xt)â–³Xt + 1
2F â€²â€²(Xt)(â–³Xt)2
with â–³Xt = Xt+â–³t âˆ’Xt and some t âˆˆ[t, t + â–³t].
Taking the limit for â–³t â†’0 gives
dF(Xt) = F â€²(Xt)dXt
or, equivalently,
F(Xt) = F(X0) +
t

0
F â€²(Xs)dXs
since, for a smooth function Xt, â–³Xt âˆ’âˆ’âˆ’âˆ’â†’
â–³tâ†’0
dXt =
Ë™Xtdt , and the
terms of higher order, which are of order (dt)2, disappear.
However, this classical relation is no longer applicable for real-valued
functions occurring in mathematical ï¬nance. When in the 19th cen-
tury the German mathematician WeierstraÃŸ constructed a real-valued
function which is continuous, but nowhere diï¬€erentiable, this was con-
sidered as nothing else but a mathematical curiosity. Unfortunately,
this â€œcuriosityâ€ is at the core of mathematical ï¬nance. Charts of ex-
change rates, interest rates, and liquid assets are practically continuous,
as the nowadays available high frequency data show. But they are of
unbounded variation in every given time interval, as argued in Chap. 6
of these notes. In particular, they are nowhere diï¬€erentiable, thus the
WeierstraÃŸ function depicts a possible ï¬nance chart 1. Therefore classi-
cal calculus requires an extension to functions of unbounded variation,
a task for long time overlooked by mathematicians. This gap was ï¬lled
by the development of stochastic calculus, which can be considered as
the theory of diï¬€erentiation and integration of stochastic processes.
1 However, as pointed out to me by Hans FÂ¨ollmer, the WeierstraÃŸ function shows
deterministic cyclical behavior, hence as a ï¬nance chart it is only acceptable to
strong believers in business cycles.

2.1 Stochastic Calculus vs. Classical Calculus
17
As already mentioned in the preface, there are now numerous books
available developing stochastic calculus with emphasis on applications
to ï¬nancial markets on diï¬€erent levels of mathematical sophistica-
tion. But here we follow the fundamentally diï¬€erent approach due to
Foellmer (1981), who showed that one can develop ItË†oâ€™s calculus with-
out probabilities as an exercise in real analysis.
What extension of the classical calculus is needed for real-valued func-
tions of unbounded variation? Simply, when forming the diï¬€erential
dF(Xt) the second term of the Taylor formula can no longer be ne-
glected, since the term (âˆ†Xt)2, the quadratic variation of Xt, does not
disappear for âˆ†t â†’0. Thus for functions of unbounded variation the
diï¬€erential is of the form
dF(Xt) = F â€²(Xt) dXt + 1
2 F â€²â€²(Xt) (dXt)2
(1)
or, in explicit form,
F(Xt) = F(X0) +
t

0
F â€²(Xs) dXs + 1
2
t

0
F â€²â€²(Xs) (dXs)2
(2)
where (dXt)2 is the inï¬nitesimal quadratic variation of X.
Ironically, it was not the newly appearing second term which cre-
ated the main diï¬ƒculty in developing stochastic calculus. For func-
tions of ï¬nite quadratic variation this F â€²â€²-term is a well-deï¬ned classi-
cal Lebesgue-Stieltjes integral. The real challenge was to give a precise
meaning to the ï¬rst integral, where both the argument of the integrand
and the integrator are of unbounded variation on any arbitrarily small
time interval. This task was ï¬rst 2 solved by ItË†o, hence the name ItË†o
formula for the relation (1) and ItË†o integral for the ï¬rst integral in (2).
For a lucid overview over the historic development of the subject see
e.g. Foellmer (1998).
2 Only recently it was discovered that the â€œItË†oâ€ formula was already found in the
year 1940 by the German-French mathematician Wolfgang DÂ¨oblin. For the tragic
fate and the mathematical legacy of W. DÂ¨oblin see Bru and Yor (2002).

18
2 Introduction to ItË†o-Calculus
Using the path-wise approach of FÂ¨ollmer one can derive both the ItË†o
formula and the ItË†o integral without any recourse to probability theory.
By looking at a stochastic process â€œpath by pathâ€ one can give a pre-
cise meaning to the expressions (1) and (2) by using only elementary
tools of classical real analysis.3 Only later probability theory is needed,
when we consider the interplay of all paths of stochastic processes like
diï¬€usions and semimartingales.
2.2 Quadratic Variation and 1-dimensional ItË†o-Formula
Following Foellmer (1981) we start with a ï¬xed sequence (Ï„n)n=1,2,... of
ï¬nite partitions
Ï„n = {0 = t0 < t1 < . . . < tin < âˆ}
of [0, âˆ) with tin âˆ’â†’
n âˆand |Ï„n| = sup
tiâˆˆÏ„n
|ti+1 âˆ’ti| âˆ’â†’
n 0.
Deï¬nition 2.2.1. Let X be a real-valued continuous function on
[0, âˆ). If, for all t â‰¥0, the limit
âŸ¨XâŸ©t = lim
n

ti âˆˆÏ„n
ti â‰¤t
(Xti+1 âˆ’Xti)2
(3)
exists, the function t âˆ’â†’âŸ¨XâŸ©t is called the quadratic variation of X.
Remark 2.1. Following Foellmer (1981) we start with the study of
the paths of a real-valued stochastic process, i.e. a real-valued function
t âˆ’â†’Xt(Ï‰) for a ï¬xed Ï‰ âˆˆâ„¦. It will be shown later, that Deï¬nition
2.2.1 and the following results are, for almost all Ï‰ âˆˆâ„¦, independent
of the particular choice of the partition sequence (Ï„n).
3 The FÂ¨ollmer approach also applies to jump-diï¬€usion processes. In these notes we
restrict ourselves deliberately to continuous processes.

2.2 Quadratic Variation and 1-dimensional ItË†o-Formula
19
Remark 2.2. Unlike the total variation Vt of X, for the quadratic
variation one has
âŸ¨XâŸ©t Ì¸= sup
Ï€

tiâˆˆÏ€
(Xti+1 âˆ’Xti)2
where the supremum is taken over all partitions
Ï€ = (0 = t0 < . . . < tn = t) of [0, t]. As will be shown, for the Brownian
motion one has âŸ¨XâŸ©t = t for almost all paths. However, the right-hand
side equals +âˆ, for almost all paths (see LÂ´evy (1965)).
Proposition 2.2.2. X âˆˆFV(IR+) =â‡’âŸ¨XtâŸ©â‰¡0
for all t â‰¥0
Proof. One has, for any t â‰¥0,

tâ‰¥tiâˆˆÏ„n
(Xti+1 âˆ’Xti)2 â‰¤sup |Xti+1 âˆ’Xti| Â·

|Xti+1 âˆ’Xti|.
Vt(X) < âˆimplies that the second term is bounded. By continuity of
X the ï¬rst term converges to zero with |ti+1 âˆ’ti| âˆ’â†’
n 0.
âŠ“âŠ”
The above proposition implies that functions Xt with positive quadratic
variation âŸ¨XâŸ©t are of unbounded total variation. Hence the integral

f(Xt) dXt cannot be deï¬ned as a â€™classicalâ€™ Lebesgue-Stieltjes inte-
gral.
However t âˆ’â†’âŸ¨XâŸ©t is a positive and isotone function and thus belongs
to FV(IR+). Hence, as shown in Sect. 1.3,
Âµ([0, t]) := âŸ¨XâŸ©t
deï¬nes a positive measure Âµ on (IR+, B) and the integral

f(s) dÂµ(s) =

f(s) dâŸ¨XâŸ©s
with respect to the quadratic variation âŸ¨XâŸ©is well-deï¬ned as Lebesgue-
Stieltjes integral.
Remark 2.3. The convergence (3) can be interpreted as weak conver-
gence of measures Âµn deï¬ned by
Âµn =

tiâˆˆÏ„n

Xti+1 âˆ’Xti
2
Î´ti
where Î´ti denotes the Dirac measure with total mass one in t = ti. Then
the sequence (Âµn) converges weakly to the measure Âµ with dÂµ = dâŸ¨XâŸ©.

20
2 Introduction to ItË†o-Calculus
Lemma 2.2.3. Let f be a real-valued continuous function on [0, t].
Then one has

ti âˆˆÏ„n
ti â‰¤t
f(ti) (Xti+1 âˆ’Xti)2 =

f 1[0,t] dÂµn
âˆ’âˆ’âˆ’â†’
nâ†‘âˆ

f 1[0,t] dÂµ =
t

0
f(s) dâŸ¨XâŸ©s.
Quadratic Variation of the Brownian motion
Deï¬nition 2.2.4. A real-valued stochastic process (Bt)0â‰¤t<âˆon a
probability space (â„¦, F, P) is called â€™standard Brownian motionâ€™
, if
(i) B0 = 0
(ii) t âˆ’â†’Bt(Ï‰) is a continuous function P-a.s.
(iii) the increments Bt âˆ’Bs are independent and have normal distribu-
tion N(0, t âˆ’s), for any 0 â‰¤s < t.
Theorem 2.2.5. (LÂ´evy) For P-almost all paths t âˆ’â†’Bt(Ï‰) one has
âŸ¨BâŸ©t(Ï‰) = t
âˆ€t â‰¥0,
(4)
Proof. It suï¬ƒces prove the claim for a ï¬xed t0 âˆˆQ+, the set of non-
negative rational numbers. Then, since Q+ is countable, âŸ¨BâŸ©t(Ï‰) = t
P-a.s for all t âˆˆQ+ which by P-a.s continuity of the paths implies P-a.s
convergence for all t âˆˆIR+.
Consider the sequence
Xn :=

ti âˆˆÏ„n
ti â‰¤t0
(Bti+1 âˆ’Bti



=:Yi
)2 =

i
Y 2
i .
By condition (iii) the Yi are independent with normal distribution
N(0, âˆ†ti+1). One has
E[Y 2
i ] = Ïƒ2(Yi) = âˆ†ti+1
Ïƒ2(Y 2
i ) = E[Y 4
i ] âˆ’E[Y 2
i ]2 = 3Ïƒ4(Yi) âˆ’(âˆ†ti+1)2 = 2(âˆ†ti+1)2.

2.2 Quadratic Variation and 1-dimensional ItË†o-Formula
21
From the Central Limit Theorem it follows that, for suï¬ƒciently large
n, the Xn are approximately distributed with normal distribution
N
 
i
âˆ†ti , 2

i
(âˆ†ti)2
Clearly, for n â†’âˆ, these distributions converge to N(t0, 0). Hence Xn
converges weakly to the constant t0, which (see section 1.2.(c)) implies
P âˆ’
lim
(Ï„n)n=1,2,...
Xn = t0.
But this implies (see Sect. 1.2.(a)) that there exists a subsequence (Ï„nâ€²)
of (Ï„n) such that
âŸ¨BâŸ©t = lim Xnâ€² = t0 P âˆ’a.s..
âŠ“âŠ”
An immediate consequence of LÂ´evyâ€™s theorem is the following
Corollary 2.2.6. For any t > 0 , the paths of the Brownian motion
are of unbounded variation on the interval [0, t].
Theorem 2.2.7. (ItË†oâ€™s formula in IR1) : Let X : [0, âˆ) âˆ’â†’IR1 be
a continuous function with continuous quadratic variation âŸ¨XâŸ©t, and
F âˆˆC2(IR1) a twice continuously diï¬€erentiable real function. Then for
any t â‰¥0
F(Xt) = F(X0) +
t

0
F â€²(Xs) dXs + 1
2
t

0
F â€²â€²(Xs) dâŸ¨XâŸ©s
(5)
where
t

0
F â€²(Xs) dXs = lim
nâ†‘âˆ

ti âˆˆÏ„n
ti â‰¤t
F â€²(Xti) (Xti+1 âˆ’Xti)
(6)
= limit of non-anticipating Riemann sums
(i.e F â€² is evaluated at the left end of the interval)
= ItË†o integral of F â€²(Xt) w.r.t. Xt

22
2 Introduction to ItË†o-Calculus
Remark 2.4. The ItË†o formula is often written in short notation as
dF(X) = F â€²(X) dX + 1
2 F â€²â€²(X) dâŸ¨XâŸ©
(7)
called the stochastic diï¬€erential of F(X). This is nothing else as an
equivalent notation for the relation (5). To make it meaningful the two
integrals in (5) must be well-deï¬ned. This is the case for the second
integral which is well-deï¬ned as Lebesgue-Stieltjes integral, since the
quadratic variation âŸ¨XâŸ©t is of ï¬nite variation (see Sect. 1.3). The im-
portant contribution of ItË†o consists in developing a well-deï¬ned concept
for integrals of the ï¬rst type, where the integrator is of unbounded vari-
ation. The existence of the limit (6) is shown in the following proof.
Remark 2.5. For non-continuous functions X we refer to Foellmer
(1981) or Protter (1990)
Proof of the Theorem: Let t > 0 , ti âˆˆÏ„n , ti â‰¤t. By Taylorâ€™s theorem
one has
F(Xti+1) âˆ’F(Xti) = F â€²(Xti) (Xti+1 âˆ’Xti



âˆ†Xti
)
+ 1
2 F â€²â€²(Xti) (âˆ†Xti)2
ti âˆˆ(ti, ti+1)
= F â€²(Xti) âˆ†Xti + 1
2 F â€²â€²(Xti) (âˆ†Xti)2
+ 1
2

F â€²â€²(Xti) âˆ’F â€²â€²(Xti)

(âˆ†Xti)2



Rn(ti)
Deï¬ne Î´n =
max
tiâˆˆÏ„n,tiâ‰¤t |âˆ†Xti|. Since F â€²â€² is uniformly continuous on
X[0, t], it follows
|Rn(ti)| â‰¤1
2
max
|x âˆ’y| â‰¤Î´n
x, y âˆˆX[0, t]
|F â€²â€²(x) âˆ’F â€²â€²(y)| (âˆ†Xti)2
â‰¤Ïµn(âˆ†Xti)2
for some Ïµn > 0, which converges to zero as Î´n â†’0.

2.2 Quadratic Variation and 1-dimensional ItË†o-Formula
23
For n âˆ’â†’âˆit follows
a)


tâ‰¥tiâˆˆÏ„n
Rn(ti)
 â‰¤Ïµn Â·

tâ‰¥tiâˆˆÏ„n
(âˆ†Xti)2



bounded
âˆ’âˆ’âˆ’â†’
nâ†‘âˆ0 .
b)

tâ‰¥tiâˆˆÏ„n
(F(Xti+1 âˆ’F(Xti)) âˆ’âˆ’âˆ’â†’
nâ†‘âˆF(Xt) âˆ’F(X0)
c)
 1
2 F â€²â€²(Xti) (âˆ†Xti)2 âˆ’âˆ’âˆ’â†’
nâ†‘âˆ
1
2
t

0
F â€²â€²(Xs) dâŸ¨XsâŸ©.
(Observe that the left-hand side of b) is an alternating sum, hence
all intermediate members cancel, and the sums in c) converge to the
Lebesgue-Stieltjes integral.)
Hence also

F â€²(Xti) âˆ†Xti must converge and there exists
lim
n

tâ‰¥tiâˆˆÏ„n
F â€²(Xti) âˆ†Xti =:
t

0
F â€²(Xs) dXs.
â–¡
Corollary 2.2.8. In the classical case (âŸ¨XâŸ©â‰¡0 or X âˆˆFV) ItË†oâ€™s
formula reduces to
F(Xt) = F(X0) +
t

0
F â€²(Xs) dXs
or in short notation, for X âˆˆC1,
dF(X) = F â€²(X) dX = F â€²(X) Ë™X dt.

24
2 Introduction to ItË†o-Calculus
Examples:
1) F(x) = xn implies
Xn
t = Xn
0 + n
t

0
Xnâˆ’1
s
dXs + n(n âˆ’1)
2
t

0
Xnâˆ’2
s
dâŸ¨XâŸ©s,
or in short notation
d(Xn) = n Xnâˆ’1 dX + n(n âˆ’1)
2
Xnâˆ’2 dâŸ¨XâŸ©.
In particular, for n = 2 and Xt = Bt standard Brownian motion, it
follows
B2
t = 2
t

0
Bs. dBs +
t

0
dâŸ¨BâŸ©s



=t
.
2) F(x) = eX implies
d(eX) = eX dX + 1
2 eX dâŸ¨XâŸ©,
(i.e.
dF = F dX no longer holds for F(Xt) = eXt with âŸ¨XâŸ©Ì¸â‰¡0) .
3) F(x) = log x implies
d(log X) = dX
X âˆ’
1
2X2 dâŸ¨XâŸ©.
Proposition 2.2.9. Let Xt = Mt + At with X and M continuous
and A âˆˆFV. Then the QV âŸ¨XâŸ©exists if and only if âŸ¨MâŸ©exists, and
âŸ¨XâŸ©= âŸ¨MâŸ©.
Proof.

(âˆ†X)2 =

(âˆ†M)2 +

(âˆ†A)2



âˆ’â†’
n
0
+2

âˆ†M Â· âˆ†A


âˆ†M Â· âˆ†A
 â‰¤sup
tiâˆˆÏ„n
|Mti+1 âˆ’Mti|



âˆ’â†’
n
0
Â·

|Ati+1 âˆ’Ati|



bounded
.
âŠ“âŠ”

2.2 Quadratic Variation and 1-dimensional ItË†o-Formula
25
Proposition 2.2.10. For F âˆˆC1 the quadratic variation of F(Xt) is
given by
âŸ¨F(X)âŸ©t =
t

0
F â€²(Xs)2 dâŸ¨XâŸ©s
Proof. Consider t > 0, ti âˆˆÏ„n, ti â‰¤t. By Taylorâ€™s theorem one has, for
some ti âˆˆ(ti, ti+1),
|F(Xti+1) âˆ’F(Xti)|2 = F(Xti)2(âˆ†Xti)2
+ 1
2 (F â€²(Xti) âˆ’F â€²(Xti))2(âˆ†Xti)2.
Since F â€² is uniformly continuous on X[t, 0] , it follows (see proof of
Theorem 2.2.7)

tâ‰¥tiâˆˆÏ„n
(F(Xti+1)âˆ’F(Xti))2 =

F â€²(Xti)2 (âˆ†Xti)2



âˆ’âˆ’âˆ’âˆ’âˆ’âˆ’âˆ’âˆ’â†’
Lemma 2.2.3
t
0
F â€²(Xs)2dâŸ¨XsâŸ©
+ Ïµn

(âˆ†Xti)2



âˆ’âˆ’âˆ’â†’
nâ†‘âˆ0
âŠ“âŠ”
Corollary 2.2.11. For f âˆˆC1 the ItË†o integral
Mt =
t

0
f(Xs) dXs
has the quadratic variation
âŸ¨MâŸ©t =
t

0
f2(Xs) dâŸ¨XâŸ©s.
Proof. (for the case that there exists a primitive function F with F â€² =
f) In this case the ItË†o formula for F(Xt) is
F(Xt) = F(X0) + Mt + 1
2
t

0
fâ€²(Xs)dâŸ¨XâŸ©s.

26
2 Introduction to ItË†o-Calculus
Thus, from Propositions 2.2.9 and 2.2.10, it follows
=â‡’âŸ¨MâŸ©t = âŸ¨F(X)âŸ©t =
t

0
(F â€²)2 (Xs) dâŸ¨XâŸ©s.
âŠ“âŠ”
Example: Mt =
t

0
Bs dBs has, according to Corollary 2.2.11, the
quadratic variation
âŸ¨MâŸ©t =
t

0
B2
s dâŸ¨BâŸ©s =
t

0
B2
s ds =â‡’dâŸ¨MâŸ©t = B2
t dt.
2.3 Covariation and Multidimensional ItË†o-Formula
Consider two functions X, Y âˆˆC0[0, âˆ) with continuous quadratic
variations âŸ¨XâŸ©and âŸ¨Y âŸ©w.r.t. to the (ï¬xed) partition sequence (Ï„n).
We shall see later that all concepts developed w.r.t. to (Ï„n) are inde-
pendent of the choice of this particular sequence.
Deï¬nition 2.3.1. If for any
t â‰¥0
âŸ¨X, Y âŸ©t = lim
nâ†‘âˆ

ti âˆˆÏ„n
ti â‰¤t
(Xti+1 âˆ’Xti)(Yti+1 âˆ’Yti)
exists, then the map t â†’âŸ¨X, Y âŸ©t is called the covariation of X and Y.
Proposition 2.3.2. âŸ¨X, Y âŸ©exists if, and only if, âŸ¨X + Y âŸ©exists, and
one has
âŸ¨X, Y âŸ©= 1
2

âŸ¨X + Y âŸ©âˆ’âŸ¨XâŸ©âˆ’âŸ¨Y âŸ©

(Polarization formula).

2.3 Covariation and Multidimensional ItË†o-Formula
27
Proof. Follows immediately from
âŸ¨X + Y âŸ©t = lim

(âˆ†X + âˆ†Y )2
= lim(

âˆ†X2 +

âˆ†Y 2 + 2

âˆ†Xâˆ†Y )
âŠ“âŠ”
Remark 2.6. The polarization formula is obviously equivalent to
âŸ¨X + Y âŸ©= âŸ¨XâŸ©+ âŸ¨Y âŸ©+ 2âŸ¨X, Y âŸ©
(8)
(compare the variance of the sum of two random variables).
Example Let Xt(w), Yt(w) be two independent Brownian motions on
(â„¦, F, P). Then one has
âŸ¨X, Y âŸ©t(w) = 0
P-a.s.
âˆ€t â‰¥0.
This follows from the fact that Xt + Yt
âˆš
2
is again the Brownian motion
Hence âŸ¨X + Y âŸ©t = 2t which by (8) implies âŸ¨X, Y âŸ©â‰¡0.
Remark 2.7. The covariation âŸ¨X, Y âŸ©is the distribution function of a
signed measure Âµ = Âµ+ âˆ’Âµâˆ’on [0, âˆ) (see Sect. 1.3).
Proposition 2.3.3. Consider f, g âˆˆC1 and their ItË†o integrals
Yt =
t

0
f(Xs) dXs
Zt =
t

0
g(Xs) dXs
w.r.t. to Xt. Then their covariation is âŸ¨Y, ZâŸ©t =
t

0
f(Xs) g(Xs) dâŸ¨XâŸ©s

28
2 Introduction to ItË†o-Calculus
Proof. From Corollary 2.2.11 it follows
âŸ¨Y + ZâŸ©t =

t

0
(f + g)(Xs) dXs

t
=
t

0
(f + g)2(Xs) dâŸ¨XâŸ©s
= âŸ¨Y âŸ©t + âŸ¨ZâŸ©t + 2
t

0
(f Â· g) (Xs) dâŸ¨XâŸ©s.
The proposition thus follows from the polarization formula resp.
formula (8).
âŠ“âŠ”
Let now X = (X1, . . . , Xd) : [0, âˆ) âˆ’â†’IRd be continuous (i.e
X âˆˆC0[0, âˆ)d) with continuous covariation
âŸ¨Xk, XlâŸ©t =
â§
âª
â¨
âª
â©
âŸ¨XkâŸ©t
k = l
1
2

âŸ¨Xk + XlâŸ©t âˆ’âŸ¨XkâŸ©t âˆ’âŸ¨XlâŸ©t

k Ì¸= l
Example: Brownian motion on IRd realized on â„¦= C[0, âˆ)d, i.e
Bt = (B1
t , . . . , Bd
t )
P =
d
i=1
Pi
Pi =Wiener measure
=â‡’âŸ¨Bk, BlâŸ©t = t Î´kl P-a.s.,
where Î´kl =

1 k = l
0 k Ì¸= l
(For existence of Bt and the construction of the Wiener measure on the
path space C0[0, âˆ)d see e.g. Bauer (1996))

2.3 Covariation and Multidimensional ItË†o-Formula
29
Given F âˆˆC2(IRd), we use the following notations:
âˆ‡F(x) =
 âˆ‚F
âˆ‚x1
, . . . , âˆ‚F
âˆ‚xd

(x) =

Fx1(x), . . . , Fxd(x)

= gradient of F
âˆ†F(x) =
d

i=1
Fxi,xi(x) = Laplace-operator, i.e. âˆ†=
d

i=1
âˆ‚2
âˆ‚x2
i
dF(x) = ( âˆ‡F(x), dx



scalar product
) =

i
Fxi(x) dxi

Ë™xi dt
classical diï¬€erential.
Theorem 2.3.4. (d-dimensional ItË†o-formula): For F âˆˆC2(IRd) one
has
F(Xt) = F(X0) +
t

0
âˆ‡F(Xs) dXs



ItË†o integral
+1
2
d

k,l=1
t

0
Fxk,xl(Xs) dâŸ¨Xk, XlâŸ©s,
and the limit lim
n

ti âˆˆÏ„n
ti â‰¤t

âˆ‡F(Xti), (Xti+1 âˆ’Xti)

=:
t

0
âˆ‡F(Xs) dXs
exists.
Proof. The proof is analogous to that of Prop. 2.2.7 by applying the
d-dimensional Taylor-formula to the discrete increments of F.
âŠ“âŠ”
In diï¬€erential form the ItË†o-formula can be written as
dF(Xt) =

âˆ‡F(Xt), dXt

+ 1
2

k,l
âˆ‚2F
âˆ‚xk âˆ‚xl
(Xt) dâŸ¨Xk, XlâŸ©t
which is the chain rule for stochastic diï¬€erentials.
Example: For the d-dimensional Brownian motion Bt = (B1
t , . . . , Bd
t ),
âŸ¨Bk, BlâŸ©t = t Î´kl implies

30
2 Introduction to ItË†o-Calculus
dF(Bt) =

âˆ‡F(Bt), dBt

+ 1
2 âˆ†F(Bt) dt.
Corollary 2.3.5. (Product rule for ItË†o calculus):
For X, Y with continuous âŸ¨XâŸ©, âŸ¨Y âŸ©, âŸ¨X, Y âŸ©it follows
d(X Â· Y ) = X dY + Y dX + dâŸ¨X, Y âŸ©
i.e.
Xt Yt = X0 Y0 +
t

0
Xs dYs +
t

0
Ys dXs + âŸ¨X, Y âŸ©t.
(9)
Proof. Apply ItË†oâ€™s formula for d = 2 to the function F(X, Y ) = X Â·Y âˆˆ
C2(IR2)
âŠ“âŠ”
Remark 2.8. For Y âˆˆFV it follows that âŸ¨X + Y âŸ©= âŸ¨XâŸ©, and hence
âŸ¨Y âŸ©= 0. Thus (9) takes the form
t

0
Ys dXs = Xt Yt âˆ’X0 Y0 âˆ’
t

0
Xs dYs
(10)
which is the classical partial integration formula. Observe that Xt may
be of inï¬nite variation, since the integral on the right-hand side is well-
deï¬ned as Stieltjes integral, for Yt âˆˆFV . By this observation Wiener
ï¬rst obtained a â€œstochasticâ€ integral for the integrator Xt = Bt and
Yt = h(t) a deterministic function, the so-called Wiener integral.
Corollary 2.3.6. (ItË†oâ€™s formula for a time-dependent function)
For F âˆˆC2,1(IR2
+) and X : IR+ âˆ’â†’IR continuous with continuous âŸ¨XâŸ©
one has
1) F(X, t) = F(X0, 0) +
t

0
Fx(Xs, s) dXs +
t

0
Ft(Xs, s) ds
+1
2
t

0
Fxx(Xs, s) dâŸ¨XâŸ©s
2) F(X, âŸ¨XâŸ©t) = F(X0, 0) +
t

0
Fx(Xs, âŸ¨XâŸ©s) dXs
+
t

0
(1
2 Fxx + Ft) (Xs, âŸ¨XsâŸ©) dâŸ¨XâŸ©s.

2.4 Examples
31
Proof. Apply ItË†oâ€™s formula for d = 2, to F(X, Y ) and choose Yt = t
resp. Yt = âŸ¨XâŸ©t.
âŠ“âŠ”
Remark 2.9. The transformation t âˆ’â†’âŸ¨XâŸ©t is called time change
according to the â€œinterior clockâ€ of the process Xt. In particular, if
F(X, t) satisï¬es the diï¬€erential equation (dual heat equation)
1
2 Fxx + Ft = 0
(11)
it follows
F(X, âŸ¨XâŸ©t) = F(X0, 0) +
t

0
Fx(Xs, âŸ¨XâŸ©s) dXs.
(12)
2.4 Examples
1) dG = Î± G dX
(X0 = 0)
We show that the above stochastic diï¬€erential equation (short:
SDE) has the solution
Gt = G0 +
t

0
Î± Gs dXs = G0 E(Î± Xt)
where E(Xt) := exp{Xt âˆ’1
2 âŸ¨XâŸ©t} is the so called stochastic expo-
nential or the DolÂ´eans-Dade exponential of Yt
Proof. F(x, t) = G0 exp

Î±xâˆ’1
2 Î±2t

satisï¬es the dual heat equa-
tion (11). Hence by (12), it follows
Gt = F(Xt , âŸ¨XâŸ©t) = G0E(Î±Xt)
=â‡’Gt âˆ’G0 = F(Xt , âŸ¨XâŸ©t) âˆ’F(X0, 0)
=
(12)
t

0
Fx(Xs , âŸ¨XâŸ©s) dXs =
t

0
Î± Gs dXs.
âŠ“âŠ”

32
2 Introduction to ItË†o-Calculus
Remark 2.10. Clearly, for âŸ¨XâŸ©t â‰¡0 one obtains the classical so-
lution Gt = G0 Â· eÎ± Xt.
2) dG = Âµ G dt + Ïƒ G dX
Here a drift term Âµ is added. Using the previous result, it is easy
to check that
Gt = G0 E(Ïƒ Xt) eÂµ t = G0 exp

Âµ t + Ïƒ Xt âˆ’1
2 Ïƒ2âŸ¨XâŸ©t

is a solution of the above SDE.
3) dSt
St
= Âµ(t) dt + Ïƒ(t) dBt
The above SDE deï¬nes a diï¬€usion or ItË†o process. It is the standard
model used in ï¬nance for the returns of a security price process St
with inï¬nitesimal drift Âµ(t)dt and stochastic noise Ïƒ(t)dBt, where
Ïƒ(t) is called the volatility of St.
We show that the SDE has the solution
St = S0 exp

t

0

Âµ(s) âˆ’1
2 Ïƒ2(s)

ds +
t

0
Ïƒ(s) dBs

.
(13)
Proof. We give a proof using ItË†oâ€™s product formula. The process
(13) can be written as
St = S0 exp

t

0
Âµ(s) ds

Â· E(Mt) = Yt Â· Zt
with Mt =
t

0
Ïƒ(s) dBs and âŸ¨MâŸ©t =
t

0
Ïƒ2(s) ds.
Since Yt is of ï¬nite variation, the product rule implies
dSt = Yt dZt + Zt dYt + dâŸ¨Yt, ZtâŸ©
= Yt Zt dMt + Zt Yt Âµ(t) dt + 0
= St Ïƒ(t) dBt + St Âµ(t) dt.
âŠ“âŠ”

2.5 First Application to Financial Markets
33
2.5 First Application to Financial Markets
We consider a ï¬nancial market with only one security without interest
and divided payments. This market is modelled as follows:
(â„¦, (Ft)tâ‰¥0, P) is a ï¬ltered probability space, i.e., (Ft) is a family of
Ïƒ-algebras with Fs âŠ‚Ft
for s < t, representing the information
available at time t.
Xt = Xt(Ï‰) is the price process of the security adapted to the ï¬ltration
(Ft), i.e. Xt is Ft-measurable, for all t â‰¥0.
Ï†t = Ï†t(Ï‰) is another stochastic process adapted to Ft, called a
portfolio strategy.
Ï†t = Ï†t(Ï‰) denotes the number of shares of the security held by an
investor at time t in state Ï‰. Adaptation to (Ft) means that the invest-
ment decision can only be based on the information available at time
t.
Given the portfolio strategy Ï†t, the value of the portfolio at time t
is of the form
Vt = Ï†tXt + Î·t = V (Xt, t)
(14)
where Î·t is a money account, yielding no interest.
A portfolio strategy ( short p.s.) is called self-ï¬nancing if, after an
initial investment V0 = Î·0, all changes in the value of the portfolio Vt
are only due to the accumulated gains (or losses) resulting from price
changes of Xt. Formally this means
Deï¬nition 2.5.1. The p.s. Ï†t is self-ï¬nancing â†â†’
def.
Vt = V0+
t
0
Ï†s dXs
â†â†’dV = Ï† dX.
Recall that the ItË†o integral in (2.5.1) is deï¬ned as
t

0
Ï†s dXs := lim
n

tâ‰¥tiâˆˆÏ„n
Ï†(ti) (Xti+1 âˆ’Xti),

34
2 Introduction to ItË†o-Calculus
which means that Ï†(ti) has to be ï¬xed at the beginning of each invest-
ment interval. In other words: the ItË†o integral is non-anticipating, and
hence the appropriate concept for ï¬nance (in contrast to other stochas-
tic integrals like e.g. the Stratonovich integral).
Applying ItË†oâ€™s formula to the value process V yields
dV = Vx dX + Ë™V dt + 1
2 Vxx dâŸ¨XâŸ©
= Ï† dX + Ë™V dt + 1
2 Vxx dâŸ¨XâŸ©
Hence Ï† is self-ï¬nancing if, and only if, V satisï¬es the diï¬€erential equa-
tion
Ë™V dt + 1
2 Vxx dâŸ¨XâŸ©= 0
(15)
for all t > 0,
where Ë™V =
âˆ‚
âˆ‚tV (x, t).
Consequence: Let H = F(XT ) be a contingent claim (e.g. a â€callâ€
option H = (XT âˆ’K)+). If there exists a self-ï¬nancing p.s. Ï†t with
VT = H then the arbitrage price Vt = V (Xt, t) of H at the time t
satisï¬es the partial diï¬€erential equation (PDE) (15) with boundary
condition
V (XT , T) = H
and for any 0 â‰¤t â‰¤T
V (Xt, t) = V (X0, 0) +
t

0
Vx(Xs, s) dXs
Remark 2.11. For Xt = St as deï¬ned in example 2.4.3 (Black-Scholes
model), one has dâŸ¨XâŸ©t = Ïƒ2
t X2
t dt and (15) is equivalent to the (PDE)
Ë™V + 1
2 Ïƒ2 X2 Vxx = 0
This is the classical approach to option pricing, as pioneered by Black-
Scholes (1973) and Merton (1973), which leads to the solution of PDEâ€™s
under boundary conditions.

2.5 First Application to Financial Markets
35
Assume now that there exists an additional security Yt = ert, i.e a
bond with ï¬xed compounded interest rate r > 0. Consider the follow-
ing portfolio strategy:
â€¢
buy one contingent claim H at price V ,
â€¢
sell Ï† = Vx shares of security X.
The value of this portfolio is
Î  = V âˆ’Vx X.
According to ItË†oâ€™s formula it follows
dÎ  = dV âˆ’Vx dX = Ë™V dt + 1
2 Vxx Ïƒ2X2 dt.
(16)
But, whereas the return dXt(Ï‰) depends on Ï‰, the right-hand side
of (16) does not, since X2
t (Ï‰) is ï¬xed at t. Hence the portfolio Î  is
riskless and by the no-arbitrage principle its return must equal the
riskless interest rate, i.e.
d Î  = r Î  dt.
(17)
Combining (16) and (17) gives the PDE
Ë™V + r X Vx + 1
2 Ïƒ2 X2 Vxx = r Â· V
(Black-Scholes PDE).
(18)
This PDE holds for any derivative of the form F(XT ). A simple example
is a forward contract on XT ï¬xed at time t = 0 at price K. It is easy
to check that
F(t) = Xt âˆ’K eâˆ’r(Tâˆ’t) = V (Xt, t)
is the (unique) solution of (18) under the boundary constraint
F(T) = V (XT , T) = XT âˆ’K.

36
2 Introduction to ItË†o-Calculus
2.6 Stopping Times and Local Martingales
In the previous sections we have concentrated on real-valued func-
tions and shown how ItË†oâ€™s calculus comes into play for functions of
unbounded variations. The concepts of integration and diï¬€erentiation
of such functions are quite independent of any probability concept and
should indeed be considered as part of the calculus of real-valued func-
tions4. But such functions were considered as rather exotic and unin-
teresting for practical applications and thus neglected in the â€™classicalâ€™
calculus5. Only the study of stochastic processes brought up the need
for such an extension of the classical calculus. As will be shown in the
following sections, the paths of non-trivial stochastic processes are of
unbounded variation.
We now consider stochastic processes X deï¬ned on a probability space
(â„¦, F, P) with real-valued continuous paths Xt(Ï‰). Of course all con-
cepts developed for real-valued functions in the previous sections apply
to the paths of such processes.
In the following (â„¦, (Ft)tâ‰¥0, P) always denotes a probability space with
right-continuous ï¬ltration satisfying the usual conditions:
(i) Ft is a Ïƒ-algebra for all t â‰¥0
(ii) Fs âŠ‚Ft for s < t
(iii) Fs =

s<t
Ft for all s â‰¥0.
A stochastic process X = (Xt)tâ‰¥0 on (â„¦, (Ft)) is called adapted if, for
any t, Xt is Ft-measurable, i.e.
{Xt â‰¤Î±} âˆˆFt
âˆ€Î± âˆˆIR.
or, shortly, Xt âˆˆFt.
4 This was ï¬rst observed by Foellmer (1981) in his fundamental article â€™Calcul de
ItË†o sans probabilitÂ´eâ€™ (see the Appendix for an English translation of this article).
5 The ï¬rst example of a function of unbounded variation is due to the 19th-century
mathematician WeierstraÃŸ, who constructed a continuous real-valued function
which is nowhere diï¬€erentiable.

2.6 Stopping Times and Local Martingales
37
Deï¬nition 2.6.1. A stochastic process M on (â„¦, (Ft), P) is called a
martingale, if
(i) (Mt) is adapted and integrable (i.e. Mt âˆˆL1(â„¦, Ft, P)
âˆ€t â‰¥0, )
(ii) E[Mt|Fs] = Ms P-a.s., for all 0 â‰¤s â‰¤t.
Remark 2.12. For a stochastic process X on a probability space
(â„¦, F, P) consider the following ï¬ltration:
F0
t := Ïƒ(Xs : s â‰¤t) Ïƒ-algebra generated by the sets
{Xs â‰¤Î± : s â‰¤t , Î± âˆˆIR}
Ft :=

t<u
F0
u
right-continuous modiï¬cation.
(Ft) is called the natural ï¬ltration generated by (Xt). Clearly, if X has
right-continuous paths, Ft = F0
t .
Lemma 2.6.2. (Mt) martingale =â‡’E[(Mt âˆ’M0)2] = E[M2
t ]âˆ’E[M2
0 ].
Proof. (Mt âˆ’M0)2 = M2
t âˆ’M 2
0 âˆ’2 M0 (Mt âˆ’M0)
=â‡’E[(Mt âˆ’M0)2] = E[M2
t âˆ’M2
0 ] âˆ’2E

M0 E[Mt âˆ’M0|F0]



=0

âŠ“âŠ”
Examples of martingales:
Let B = (Bt)tâ‰¥0 be a Brownian motion on (â„¦, F, P) with natural ï¬l-
tration (Ft)tâ‰¥0.
(e.g. â„¦
= C[0, âˆ) = all continuous paths
(Ft)
ï¬ltration generated by (Bt)
F
= Fâˆ= Ïƒ(Bt : t â‰¥0)
P
= Wiener measure)

38
2 Introduction to ItË†o-Calculus
Proposition 2.6.3. The following processes are martingales with re-
spect to the ï¬ltration (Ft):
(1) Bt
(2) B2
t âˆ’t
(3) St = S0 exp

Ïƒ Bt âˆ’1
2 Ïƒ2 t

= S0 E(Ïƒ Bt).
Proof. (i) The processes are clearly adapted. Integrability follows from
(1) E[B2
t ] = t < âˆ=â‡’Bt âˆˆL2 âŠ‚L1,
(2) E[|St|] = E[St] = S0 exp

âˆ’1
2 Ïƒ2 t

Â· E[eÏƒBt]
  
=exp{(1/2) Ïƒ2 t}
= S0 âˆˆL1.
Remark 2.13.
X âˆ¼N(Âµ, Ïƒ2) =â‡’E[eX] = exp{Âµ + 1
2 Ïƒ2}.
(ii) (1) Bt+h âˆ’Bt independent of Bt
=â‡’E

Bt + h
  
s
âˆ’Bt
Ft

= E[Bt+h âˆ’Bt] = 0
=â‡’E[Bs|Ft] = Bt + E[Bs âˆ’Bt|Ft]



=0
s â‰¥t.
(2) E[B2
t+h âˆ’B2
t |Ft] = E

(Bt+h âˆ’Bt)2 + 2 (Bt+h âˆ’Bt) Bt | Ft

= h + 2 Bt E[Bt+h âˆ’Bt|Ft]



=0
= h.
(3) E[St+h|Ft] = E

S0 E(Ïƒ Bt)



St
E

Ïƒ(Bt+h âˆ’Bt)
Ft

= St E

exp

Ïƒ(Bt+h âˆ’Bt) âˆ’1
2 Ïƒ2 h




=1
.
âŠ“âŠ”

2.6 Stopping Times and Local Martingales
39
Stopping Times
Deï¬nition 2.6.4. The random variable T : â„¦âˆ’â†’[0, âˆ] is called a
stopping time if
[T â‰¤t] âˆˆFt
(t â‰¥0).
(19)
Lemma 2.6.5. For a right-continuous ï¬ltration the condition (19) is
equivalent to
[T < t] âˆˆFt
(t â‰¥0).
Proof. (=â‡’) [T < t] = 
n
[T â‰¤t âˆ’1
n]



âˆˆFtâˆ’1/n
âˆˆFt
(â‡=) [T â‰¤t] = 
Ïµ>0
[T < t + Ïµ]



âˆˆFt+Ïµ
right-continuous
=â‡’
[T â‰¤t] âˆˆFt
âŠ“âŠ”
Lemma 2.6.6. Every stopping time is a decreasing limit of discrete
stopping times.
Proof. Consider the sequence
Dn =

K 2âˆ’nK = 0, 1, 2, . . .

n=1,2,...
of dyadic partitions of the interval [0, âˆ). Deï¬ne, for any n,
Tn(Ï‰) =

K 2âˆ’n if T(Ï‰) âˆˆ[(K âˆ’1) 2âˆ’n , K 2âˆ’n)
+âˆif T(Ï‰) = âˆ
Clearly,
[Tn â‰¤d] = [Tn < d] âˆˆFd
for d = K 2âˆ’n âˆˆDn
and
[Tn â‰¤t] =

tâ‰¥dâˆˆDn
[Tn = d] âˆˆFt.
Hence (Tn) are stopping times and Tn(Ï‰) â†“T(Ï‰)
âˆ€Ï‰ âˆˆâ„¦.
âŠ“âŠ”

40
2 Introduction to ItË†o-Calculus
Deï¬nition 2.6.7. Let T be a stopping time.
FT :=

A âˆˆFâˆ: A âˆ©{T â‰¤t} âˆˆFt
âˆ€t â‰¥0

is called the Ïƒ-algebra of T-observable events.
Clearly, for discrete Tn, FTn is a Ïƒ-algebra. Hence, by Lemma 2.6.6,
FT = 
n
FTn
is a Ïƒ-algebra.
FT contains all events which are observable up to the stopping time T.
This is illustrated in the following Fig. 2.1, where â„¦= {Ï‰1, . . . , Ï‰8}
is the set of all paths from t = 0 to t = 3 and FT = Ïƒ{A1, A2, A3}.
gestoppt
A1
A2
A3
w
t=0
t=1
t=3
t=2
Fig. 2.1. Tree of FT -observable events
Remark 2.14. One has
FT = Ïƒ{XT : X all adapted c`adl`ag processes }
(Protter (1990), p.6)
Lemma 2.6.8. For an adapted, right-continuous process X the map
XT : â„¦âˆ’â†’(IRd, Bd)
Ï‰ âˆ’â†’XT (Ï‰) := XT(Ï‰)(Ï‰)
is FT -measurable.

2.6 Stopping Times and Local Martingales
41
Proof. From Lemma 2.6.6 take Tn â†“T and d âˆˆDn.
1) For XTn âˆˆFTn and B âˆˆBd, t â‰¥0 it follows
{XTn âˆˆB} âˆ©{Tn â‰¤t} =

tâ‰¥dâˆˆDn
{XTn âˆˆB} âˆ©{Tn = d}
=

tâ‰¥dâˆˆDn
{Xd âˆˆB}



âˆˆFd



âˆˆFt
.
2) (Xt) right-continuous =â‡’XT = lim
n XTn
âˆ€Ï‰ âˆˆâ„¦
=â‡’XT FT -measurable with

n
FTn = FT .
âŠ“âŠ”
For any stopping time T, one has

*
HHHHHH
j
T
XT
(XTâˆ§t)tâ‰¥0
random variable on FT
new stoch. process adapted to FT
One of the most useful theorems of probability theory is the following
so-called â€™Optional Stopping Theoremâ€™.
Theorem 2.6.9. Let (Xt)tâ‰¥0 be a real-valued process which is adapted,
integrable and c`adl`ag.
The following statements are equivalent:
(i) (Xt)tâ‰¥0 is a martingale,
(ii) E[XT ] = E[X0] for any bounded stopping time T
(i.e. T(Ï‰) â‰¤c
âˆ€Ï‰ âˆˆâ„¦) ,
(iii) E[XT |FS] = XS for any bounded stopping times S â‰¤T.
Proof. We use the following notation:

A
Xs dP =: E[Xs 1A] =: E[Xs; A].

42
2 Introduction to ItË†o-Calculus
For Xt âˆˆL1 âˆˆ(â„¦, Ft, P) it then follows
(Xt) martingale â‡â‡’E[Xs; A] = E[Xt; A]
âˆ€s â‰¤t
âˆ€A âˆˆFs.
(i) =â‡’(ii):
Let T â‰¤c, and let Tn â†“T be a discretization with partition Dn (com-
pare Lemma 2.6.6), and A âˆˆFTn. Then it follows
E[XTn; A] =

dâˆˆDn
E[Xd ; A âˆ©{Tn = d}



=âˆ…for d>c
]
=

dâˆˆDn
E[Xc ; A âˆ©{Tn = d}] , since X is a martingale
= E[Xc; A].
In particular E[XTn] = E[Xc; â„¦] = E[X0].
Since XT = lim
n XTn P-a.s., Lebesgueâ€™s theorem implies E[XT ] = E[X0].
(ii) =â‡’(iii):
Let A âˆˆFs , S â‰¤T â‰¤c. Deï¬ne new stopping time
Ë†S(Ï‰) :=

S(Ï‰) Ï‰ âˆˆA
T(Ï‰) Ï‰ âˆˆAc
Since Ë†S and T are bounded, (ii) implies
E[X Ë†S] = E[X0] = E[XT ] = E[XT ; A] + E[XT ; Ac].
On the other hand
E[X Ë†S] = E[XS; A] + E[XT ; Ac],
which together with the above equation implies E[XS; A] = E[XT ; A].
(iii) =â‡’(i):
Set
S â‰¡s and T â‰¡t
âŠ“âŠ”
Remark 2.15. By Lebesgueâ€™s theorem the optional stopping theorem
also holds for ï¬nite stopping times T < âˆ, P-a.s., for (XTâˆ§n) uni-
formly integrable.

2.6 Stopping Times and Local Martingales
43
As an application of the optional stopping theorem we consider the
hitting times of a Brownian motion for an interval a â‰¤0 < b deï¬ned
by
Ta,b(Ï‰) := min{t : Bt(Ï‰) /âˆˆ[a, b]}.
Proposition 2.6.10. P[BTa,b = b] =
|a|
b âˆ’a , P[BTa,b = a] =
b
b âˆ’a,
and
E[Ta,b] = |a| Â· b.
Proof.
1) 0 = E[B0] = E[BT ] = b Â· P[BT = b] + a (1 âˆ’P[BT = b])
=â‡’P[BT = b] =
âˆ’a
b âˆ’a.
2) (B2
t âˆ’t) martingale
=â‡’0 = E[B2
0 âˆ’0] = E[B2
Tâˆ§n âˆ’T âˆ§n]
=â‡’E[B2
Tâˆ§n] = E[T âˆ§n] â†‘E[T] (Beppo-Levi) .
On the other hand E[B2
Tâˆ§n] âˆ’âˆ’âˆ’â†’
nâ†‘âˆE[B2
T ], and it follows
E[T] = E[B2
T ] = b2 P[BT = b] + a2 P[BT = a]
=â‡’E[T] = |a| Â· b.
âŠ“âŠ”
Corollary 2.6.11. For the hitting time of b > 0, Tb(Ï‰) = inf{t :
Bt(Ï‰) > b}, it follows
Tb < âˆP-a.s., but E[Tb] = +âˆ.
Proof.
P[Tb < âˆ] = lim
aâ†“âˆ’âˆP[Ta,b] = lim
|a|
b + |a| = 1
E[Tb] â‰¥E[Ta,b] = |a| Â· b âˆ’âˆ’âˆ’âˆ’â†’
aâ†“âˆ’âˆâˆ
âŠ“âŠ”

44
2 Introduction to ItË†o-Calculus
Remark 2.16. This result is rather discouraging for gamblers who
follow the â€œrealize-modest-gainsâ€ strategy, i.e. choose some b > 0, con-
tinue with ï¬xed stake till the cumulated gains reach the bound b, then
stop. If the game is â€œfairâ€, then, for any b > 0, the gains will surpass b
in ï¬nite time with probability one. But even for arbitrary small b > 0,
the average waiting for this to happen is inï¬nite. In the meantime the
cumulated losses can become arbitrarily large.
2.7 Local Martingales and Semimartingales
An important result of stochastic calculus is that ItË†o integrals with re-
spect to a martingale are again martingales. This is, however, not quite
correct: it is true for the class of local martingales, and more generally
for semimartingales.
Deï¬nition 2.7.1. An adapted c`adl`ag process (Mt)tâ‰¥0 is called a local
martingale, if there exist stopping times T1 â‰¤T2 â‰¤. . . such that
(i) sup
n Tn = âˆa.s.
(ii) (MTnâˆ§t) is a martingale for all n.
Remark 2.17. By deï¬ning new stopping times T â€²
n = Tn âˆ§n the lo-
calizing sequence in the above deï¬nition can always be assumed to be
bounded (which implies that the martingales (MT â€²nâˆ§t) are uniformly in-
tegrable, as required in some standard textbooks). Furthermore, if M is
continuous, by setting Sn = inf{t : |Xt| > n} and T â€²
n = Tnâˆ§Sn one may
assume the martingales to be bounded (see Revuz-Yor (1991),p.117).
The following deï¬nition extends the ItË†o integral of stochastic integrands
with respect to local martingales in a straightforward way.
Deï¬nition 2.7.2. Let (Ht)tâ‰¥0 be an adapted c`adl`ag process and (Xt)tâ‰¥0
a continuous local martingale. If the following limit exists for all t â‰¥0
P-a.s.

2.7 Local Martingales and Semimartingales
45
Mt(Ï‰) = lim
n

tâ‰¥tiâˆˆÏ„n
Hti(Ï‰) (Xti+1(Ï‰) âˆ’Xti(Ï‰))
then Mt =
 t
0
Hs dXs is called the stochastic integral of (Ht) with
respect to (Xt).
Remark 2.18. We will see soon that this deï¬nition also does not de-
pend on the speciï¬c partition sequence (Ï„n).
Theorem 2.7.3.
Mt =
t

0
Hs dXs
(20)
is a local martingale.
Proof. 1) First assume (Xt) and (Ht) are bounded, i.e.
|Xt(Ï‰)| â‰¤k
and
|Ht(Ï‰)| â‰¤l
âˆ€t, Ï‰.
We show (Mt)tâ‰¥0 is a L2-martingale. Deï¬ne
M n
t :=

tâ‰¥tiâˆˆÏ„n
Hti (Xti+1 âˆ’Xti).
a) E[(Mn
t )2] =

E

H2
ti (Xti+1 âˆ’Xti)2
â‰¤l2

tâ‰¥tiâˆˆÏ„n
E

X2
ti+1 âˆ’X2
ti âˆ’2 Xti (Xti+1 âˆ’Xti)

= l2 E

X2
tj âˆ’X2
t0

â‰¤l2 c0 < âˆ
where tj = inf{ti âˆˆÏ„n : ti > t}, since E[Xti+1 âˆ’Xti] = 0
and the remaining term is an alternating sum.
=â‡’M n
t âˆˆL2 and bounded .
b) Mn
t is a martingale, for any t = ti âˆˆÏ„n
E

Mn
ti+1 âˆ’Mn
ti|Fti

= Hti E

(Xti+1 âˆ’Xti)|Fti

= 0
since X is a martingale.

46
2 Introduction to ItË†o-Calculus
c) Let s < t , As âˆˆFs. To show:
E[Ms; As] = E[Mt; As].
(21)
Choose sn, tn âˆˆÏ„n with s < sn < t < tn and sn â†“s , tn â†“t.
s < sn âˆ’â†’As âˆˆFsn âˆ’â†’
b) E[Mn
sn; As] = E[Mn
tn; As].
Mn
sn(Ï‰) âˆ’â†’Ms(Ï‰) P-f.s.
M n
tn(Ï‰) âˆ’â†’Mt(Ï‰) P-f.s.

=â‡’
Lebesgue(21)
2) The general case can be reduced to 1) by deï¬ning the following
stopping times
Sn(Ï‰) = inf{t : |Xt(Ï‰)| > n}
Un(Ï‰) = inf{t : |Ht(Ï‰)| > n}.
Consider the stopping time Vn = Sn âˆ§Un âˆ§Tn where Tn is a local-
izing sequence of bounded stopping times for (Xt). By assumption
(XTnâˆ§t) is a martingale. Since Vn â‰¤Tn, the stopping theorem im-
plies that (XVnâˆ§t) is a martingale, and hence by 1) also (MVnâˆ§t).
Clearly Vn â†‘âˆ. Hence (Mt) is a local martingale.
âŠ“âŠ”
Corollary 2.7.4. If (Xt) is a local martingale, then
X2
t âˆ’âŸ¨XâŸ©t
(t â‰¥0) is a local martingale.
Proof. dX2 =
ItË†o2 X dX + dâŸ¨XâŸ©, i.e.
X2
t âˆ’âŸ¨XâŸ©t = X2
0 + 2
t

0
Xs dXs



local martingale
.
âŠ“âŠ”

2.7 Local Martingales and Semimartingales
47
Corollary 2.7.5. Let X be a continuous local martingale with âŸ¨XâŸ©â‰¡0
P-a.s. Then
Xt(Ï‰) â‰¡X0(Ï‰)
P-a.s.,
i.e., continuous local martingales with paths of ï¬nite variation are triv-
ial stochastic processes.
Proof. Mt = X2
t âˆ’âŸ¨XâŸ©t = X2
t is a local martingale.
Let Tn = T â€²
n âˆ§T â€²â€²
n be a joint localizing sequence for Xt and X2
t .
=â‡’(XTnâˆ§t) , (X2
Tnâˆ§t) are martingales. Hence if follows:
0 â‰¤E[(Xt âˆ’X0)2]
=
(Xt cont.)E

lim
n (XTnâˆ§t âˆ’X0)2
â‰¤
(Fatou) lim inf
n E

(XTnâˆ§t âˆ’X0)2
=
(XTnâˆ§t mart.)lim inf E

X2
Tnâˆ§t âˆ’X2
0

=
(X2
Tnâˆ§t mart.)
0
=â‡’P[Xt = X0
âˆ€t âˆˆQ] = 1
=â‡’
(Xt cont.) P[Xt = X0
âˆ€t] = 1
âŠ“âŠ”
Now we are able to prove the
Independence of the calculus from (Ï„n):
Let X be a continuous local martingale. Then
X2
t = X2
0 + 2
t

0
Xs dXs + âŸ¨XâŸ©t.
Assume there exist two partition sequences (Ï„ (1)
n ) and (Ï„ (2)
n ) with

48
2 Introduction to ItË†o-Calculus
X2
t âˆ’X2
0 =

ItË†o integral(1) + âŸ¨XâŸ©(1)
t
ItË†o integral(2) + âŸ¨XâŸ©(2)
t
Then Mt = âŸ¨XâŸ©(1)
t
âˆ’âŸ¨XâŸ©(2)
t , as the diï¬€erence of two ItË†o integrals, is a
local martingale with paths of ï¬nite variation. Hence by corollary 2.7.5
Mt(Ï‰) = M0 = 0
P âˆ’a.s.
But this implies
âŸ¨XâŸ©(1)
t
âˆ’âŸ¨XâŸ©(2)
t
â‰¡0
P âˆ’a.s.
and
ItË†o integral(1) â‰¡ItË†o integral(2)
P âˆ’a.s.
The same argument applies to the stochastic integral Mt =
 t
0
Hs dXs,
since Mt is a continuous local martingale.
We end this section with several suï¬ƒcient conditions for a local mar-
tingale to be actually a martingale.
Proposition 2.7.6. Let M be a local martingale. The following con-
ditions are suï¬ƒcient for M to be a martingale (see Protter (1990)
Theorem47 (p.35) and Theorem27, Corollary 3 (p.66)):
1) E[sup
sâ‰¤t
|Ms|] < âˆ
âˆ€t â‰¥0 =â‡’M is a martingale .
2) E[sup
t
|Mt|] < âˆ=â‡’M uniformly integrable martingale
(in particular M bounded) .
3) E[âŸ¨MâŸ©t] < âˆ
âˆ€t â‰¥0 =â‡’M is a L2-martingale and M2 âˆ’âŸ¨MâŸ©
is a
L1-martingale .
Condition 3) is clearly satisï¬ed by the Brownian motion (Bt)tâ‰¥0, since
E[âŸ¨BâŸ©t] = t < âˆ. Hence B is a L2-martingale and B2 âˆ’âŸ¨BâŸ©L1-
martingale.
Condition 3) has an interesting interpretation. Let M be a local mar-
tingale satisfying 3). Then it follows, for any t > 0,
M 2
t âˆ’âŸ¨MâŸ©t
martingale =â‡’E

E[M2
t âˆ’âŸ¨MâŸ©t|F0]



M2
0 âˆ’0

= E[M2
0 ].

2.8 ItË†oâ€™s Representation Theorem
49
Thus
E[M2
t ] = E[M2
0 ] + E[âŸ¨MâŸ©t], which implies
Var[Mt]



local in t
= E[M2
t ] âˆ’(E[Mt]
  
E[M0]
)2 =
E[âŸ¨MâŸ©t]



global on [0,t]
.
I.e. the variance of M at time t equals the average quadratic variation
of all paths of M on the interval [0, t].
According to Theorem2.7.3 the class of local martingales is closed with
respect to stochastic integration. This property extends to the larger
class of semimartingales.
Deï¬nition 2.7.7. A continuous stochastic process X is called a semi-
martingale, if there exists a decomposition
Xt = X0 + Mt + At
with M0 = A0 = 0, M a local martingale and A a process of ï¬nite
variation.
If H is another semimartingale, for which

H dX exists, it follows

H dX =

H dM



local mart.
+

H dA



âˆˆFV
.
Hence

H dX is again a semimartingale.
2.8 ItË†oâ€™s Representation Theorem
Let B be a Brownian motion and H an adapted process. A suï¬ƒcient
condition for the stochastic integral Mt =
 t
0 Hs dBs to be a martingale
(see Prop. 2.7.6 (3)) is
E[âŸ¨MâŸ©t] = E

t

0
H2
s ds

< âˆ
âˆ€t

50
2 Introduction to ItË†o-Calculus
which implies that M is a L2-martingale and M2âˆ’âŸ¨MâŸ©a L1-martingale.
The following theorem (see e.g. Revuz-Yor (1991) p.187) shows that
the converse also holds.
Theorem 2.8.1. (ItË†oâ€™s representation theorem)
Let B a Brownian motion on (â„¦, (Ft), P) with â€œnaturalâ€ ï¬ltration
(generated by (Bt) and all P-null sets) and M a L2-martingale on
(Ft, P).Then there exists an adapted process H with
E

t

0
H2
s ds
 
< âˆ
t â‰¥0
such that
Mt = M0 +
t

0
Hs dBs
âˆ€t â‰¥0.
2.9 Application to Option Pricing
Let B denote again a Brownian motion on (â„¦, (Ft), P) with natural
ï¬ltration.
Let (St)tâ‰¥0 be a price process adapted to (Ft) and C an option depend-
ing on the paths of (St)0â‰¤tâ‰¤T , for some ï¬xed T.
Examples: C(Ï‰) = [ST (Ï‰) âˆ’K]+
call option
C(Ï‰) = max
0â‰¤tâ‰¤T St(Ï‰)
lookback option
C(Ï‰) = [ST (Ï‰) âˆ’K]+ Â· 1{St(Ï‰)>L âˆ€tâ‰¤T} knock-out call
(L < inf{S0, K})
Then C is a FT -measurable so-called contingent claim. Assume there
exists a self-ï¬nancing trading strategy (Ï†t)0â‰¤tâ‰¤T which generates C,
i.e. there exists a value process

2.9 Application to Option Pricing
51
Vt = V0 +
t

0
Ï†s dSs
0 â‰¤t â‰¤T
with
VT = C.
If St is a martingale, according to Theorem 2.7.3 Vt is a local mar-
tingale, and, under suitable conditions on C (see Prop. 2.7.6), a mar-
tingale. Hence
Vt = E[VT |Ft] = E[C|Ft]
is the arbitrage price of C at time t.
In particular
V0 = E[C].
Existence of (Ï†t):
If C is square-integrable, i.e. C âˆˆL2(FT , P), by ItË†oâ€™s representation
Theorem (see Theorem 2.8.1) there exists an adapted process (Ht)0â‰¤tâ‰¤T
with
E

T

0
H2
s ds

< âˆ,
and
C = E[C] +
T

0
Hs dBs .
Assume St = S0 exp

Ïƒ Bt âˆ’1
2 Ïƒ2 t

= S0 Â· E(Ïƒ Bt) .
=â‡’St is (Ft)-martingale with dSt = Ïƒ St dBt
=â‡’C = E[C] +
T

0
Hs dBs = E[C]

premium
+
T

0
Hs
Ïƒ Ss
  
Ï†s
dSs .

52
2 Introduction to ItË†o-Calculus
For the call option C = [ST âˆ’K]+ it follows
E[C] =

â„¦
[ST (Ï‰) âˆ’K]+ P(dÏ‰) =

[ST >K]
ST dP âˆ’K Â· P[ST > K]
= S0 Î¦(g(K)) âˆ’K Â· Î¦(h(K))
(22)
with
g(K) = ln(S0/K)
Ïƒ
âˆš
T
+ 1
2 Ïƒ
âˆš
T
h(K) = g(K) âˆ’Ïƒ
âˆš
T
Î¦(x) =
1
âˆš
2Ï€
x

âˆ’âˆ
eâˆ’1
2 z2dz
(standard normal distribution)
which is the Black-Scholes formula for r = 0.
This is the martingale approach to option pricing.
Proof. (of equation (22))
F(x) = P[ST â‰¤x]
distribution function of ST
= P[ln ST â‰¤ln x] = P

ln S0 + Ïƒ BT âˆ’1
2 Ïƒ2 T â‰¤ln x

= P

Ïƒ BT â‰¤ln x âˆ’ln S0 + 1
2 Ïƒ2 T

= P

 BT
âˆš
T
â‰¤ln(x/S0)
Ïƒ
âˆš
T
+ 1
2 Ïƒ
âˆš
T



âˆ’h(x)

= Î¦(âˆ’h(x)).
Hence
K Â· P[ST > K] = K(1 âˆ’Î¦(âˆ’h(K)) = K Â· Î¦(h(K))
f(x) = F â€²(x) = Î¦â€²(âˆ’h(x)) d
dx (âˆ’h(x))
= Ï•(h(x))
1
x Ïƒ
âˆš
T
= density of F(x)
with
Ï•(h) =
1
âˆš
2Ï€ eâˆ’h2
2
density of N(0,1).

2.9 Application to Option Pricing
53
Lemma 2.9.1. g = h + Ïƒ
âˆš
T =â‡’Ï•(g(x)) = Ï•(h(x)) x
S0
(The proof is left for exercise).
It follows

[ST â‰¥K]
ST dP =
âˆ

K
x f(x) dx =
âˆ

K
Ï•(h(x))
Ïƒ
âˆš
T
dx = S0
âˆ

K
Ï•(g(x))
x Ïƒ
âˆš
T
dx
= S0

âˆ’Î¦(g(x))
âˆ
K = S0 Î¦(g(K)).
âŠ“âŠ”
Remark 2.19. The above example illustrates the martingale approach
to option pricing. It was pioneered by Harrison-Kreps (1979) and
Harrison-Pliska (1981) and has proved as a powerful tool in ï¬nance.
Whereas the original Black-Scholes approach leads to solving PDEâ€™s
under boundary constraints, the martingale technique leads to option
prices as expectations under the â€œmartingale measureâ€. This technique
will be developed in detail in Chap. 4. The Feynman-Kac Theorem es-
tablishes a relation between these two apparently so diï¬€erent approaches
(see Sect. 4.3).
In the above example we have assumed that the security price process
St is already a martingale. But in general St will only be a semimartin-
gale under the given probability measure P. The technique of how to
transform P into an â€œequivalent martingale measureâ€ is developed in
Chap. 3.

3
The Girsanov Transformation
The Girsanov transformation is an important tool in mathematical ï¬-
nance. We ï¬rst give a heuristic introduction taken from Foellmer (1991)
(see also Karatzas-Shreve (1988), Sect.3.5). Using only elementary facts
of independent normally distributed random variables, it leads to the
DolÂ´eans-Dade exponential as new density under a change of measure
for the Brownian motion.
Sect. 3.2 deals with the Girsanov transformation in general form, as
can be found in Revuz-Yor (1991). The proofs are straightforward ap-
plications of tools developed in Chap. 2. This section, which at ï¬rst
sight looks rather abstract, is basic for the applications to ï¬nance in
Chapters 4 and 5, where the general Girsanov transformation is repeat-
edly used.
Sect. 3.3 treats the special case of the Brownian motion.
3.1 Heuristic Introduction
Following Foellmer (1991) we ï¬rst give a heuristic derivation of the Gir-
sanov transformation for the 1-dimensional Brownian motion based on
elementary probability concepts. This heuristic will help to understand
what happens under the Girsanov transformation.
Let X be a random variable (r.v.) on (â„¦, F, P) which is standard-
normal, in short X âˆ¼N(0, 1).

56
3 The Girsanov Transformation
=â‡’P[X â‰¤a] =
1
âˆš
2Ï€
a

âˆ’âˆ
eâˆ’1
2 x2dx =
a

âˆ’âˆ
f(x)

n0,1(x)
dx
Consider now another density function:
!f(x) = e(Âµxâˆ’1
2 Âµ2)f(x).
=â‡’!P[X â‰¤a] =
1
âˆš
2Ï€
a

âˆ’âˆ
eâˆ’1
2 (xâˆ’Âµ)2dx =
a

âˆ’âˆ
nÂµ,1(x) dx
=â‡’X âˆ¼N(Âµ, 1) under !P
Observe that the r.v. X has not been changed, but its distribution
has changed under the new measure !P.
Remark 3.1. Clearly !PX âˆ¼PX and the Radon-Nikodym derivative is
d !PX
dPX
(x) = e(Âµxâˆ’1
2 Âµ2).
Under !P the r.v. !
X = X âˆ’Âµ has now the distribution N(0, 1), i.e.
PX
â‰¡
!P !
X
distribution of X
distribution of !
X
under P
â‰¡
under !P
For X âˆ¼N(0, Ïƒ2) under P
X âˆ¼N(Âµ, Ïƒ2) under !P (â†”!
X = X âˆ’Âµ âˆ¼N(0, Ïƒ2) under !P)
it follows
d !PX
dPX
(x) = nÂµ,Ïƒ2(x)
n0,Ïƒ2(x) = e
1
Ïƒ2 (Âµxâˆ’1
2 Âµ2).

3.1 Heuristic Introduction
57
Application to Brownian Motion
Let (Bt)0â‰¤tâ‰¤1 be a BM on (â„¦, (F)t, P).
=â‡’Bt âˆ¼N(0, t) under P
and âˆ†Bt = Bt+âˆ†t âˆ’Bt âˆ¼N(0, âˆ†t), independent of Bt
Consider now a BM with drift
!Bt = Bt âˆ’
t

0
Hs ds
for some stochastic process (Hs)0â‰¤sâ‰¤1.
Question: Under which measure !P is ( !Bt) again a BM (without drift) ?
We discretize the unit interval [0, 1] by ti = i
n
(i = 0 . . . n).
It follows
B j
n =
j

i=1
B i
n âˆ’B iâˆ’1
n



:=Xiâˆ¼N(0,âˆ†t) under P
j = 1 . . . n
n
i=1
N(0, âˆ†t)
joint distribution of X1, . . . , Xn (under P)
!
Xi = Xi âˆ’H iâˆ’1
n Â· âˆ†t



Âµi
=â‡’!
Xi âˆ¼N(0, âˆ†t) under !P
with Radon-Nikodym-derivative e
1
âˆ†t (Âµixiâˆ’1
2 Âµ2
i ) w.r.t. P.

58
3 The Girsanov Transformation
Joint distribution of !
Xi under !P
d !P (n) =
n
"
i=1
exp
 1
âˆ†t

H iâˆ’1
n âˆ†t Â· Xi âˆ’1
2 H2
iâˆ’1
n âˆ†t2
dP (n)
= exp

n

i=1
H iâˆ’1
n (B i
n âˆ’B iâˆ’1
n ) âˆ’1
2
n

i=1
H2
iâˆ’1
n âˆ†t

dP (n)
â€ âˆ’âˆ’âˆ’â†’
nâ†’âˆâ€ exp

1

0
Hs dBs âˆ’1
2
1

0
H2
s ds

dP
(1)
=â‡’
!P = E(L1) P
with L1 =
1

0
Hs dBs
= exp{L1 âˆ’1
2 âŸ¨L1âŸ©} Â· P
Remark 3.2. E(L1) = exp{L1 âˆ’1
2 âŸ¨L1âŸ©} is called the â€œstochastic ex-
ponentialâ€ or the â€œDolÂ´eans-Dadeâ€ exponential.
The limit process (1) is of course only a heuristic argument. A mathe-
matically rigorous derivation follows in Sect. 3.2 and 3.3.
3.2 The General Girsanov Transformation
Let (â„¦, (Ft)0â‰¤t, P) satisfy the usual conditions, i.e. the ï¬ltration is right
continuous, complete and Fâˆ= Ïƒ(
t
Ft).
M(c)
loc(P) := all (continuous) local martingales w.r.t. P
Deï¬nition 3.2.1. X is called P-semimartingale â‡â‡’
Def. X = M + A
with M âˆˆMloc(P) and A âˆˆFV.

3.2 The General Girsanov Transformation
59
Let Q be another probability measure on (â„¦, Fâˆ).
Deï¬nition 3.2.2.
(i) Q << P â‡â‡’
Def. P[A] = 0 =â‡’Q[A] = 0
âˆ€A âˆˆFâˆ
(ii) Q âˆ¼P â‡â‡’
Def. Q << P and P << Q
(i.e. Q and P have identical null sets)
Proposition 3.2.3. (Radon-Nikodym)
Let Q << P. Then there exists Z âˆˆL1(â„¦, Fâˆ) with Q = Z P, i.e.
Q[A] =

A
Z(Ï‰) P(dÏ‰)
âˆ€A âˆˆFâˆ
Notation:
Z = dQ
dP
=â‡’Zt = EP [Z|Ft] = EP

dQ
dP |Ft

is a right continuous martingale, EP [Zt] â‰¡1. Furthermore
(i) Zt(Ï‰) > 0
Q-a.s.
(ii) Zt = dQt
dPt
on Ft
Lemma 3.2.4. Let Q âˆ¼P. Then one has
X âˆˆMc
loc(Q) â†â†’X Z âˆˆMc
loc(P).
Proof. Let s < t , A âˆˆFs. Is X a martingale, then obviously
EQ[Xs; A] = EQ[Xt; A] â‡â‡’EP [Xs Zs; A] = EP [Xt Zt; A].
(2)
Let Tn â†‘âˆbe a localizing stopping time for X. It follows
Q = ZTnP on FTn =â‡’(2) for XTn, XTn ZTn
âŠ“âŠ”

60
3 The Girsanov Transformation
Notation: Following Protter (1990) we use the following short notation
for stochastic integrals: H â€¢X =

HdX. Evaluating these processes at
t, we have
H â€¢ Xt =
t

0
HsdXs = H0X0 +

(0,t]
HsdXs
Theorem 3.2.5. (Girsanov)
Let Q << P with Z = dQ
dP continuous.
It follows
M âˆˆMc
loc(P) =â‡’#
M = M âˆ’Zâˆ’1 â€¢ âŸ¨M, ZâŸ©âˆˆMc
loc(Q)
(i.e.
#
Mt = Mt âˆ’
t

0
1
Zs
dâŸ¨M, ZâŸ©s).
Proof. According to Lemma 3.2.4 one has to show: #
M Z âˆˆMc
loc(P)
#
Mt Zt = #
M0 Z0 +
t

0
#
Ms dZs +
t

0
Zs d#
Ms + âŸ¨#
M, ZâŸ©t
= #
M0 Z0 +
t

0
#
Ms dZs



âˆˆMloc(P)
+
t

0
Zs dMs



âˆˆMloc(P)
âˆ’âŸ¨M, ZâŸ©t + âŸ¨#
M, ZâŸ©t



=0 since #
Mâˆ’MâˆˆFV
âŠ“âŠ”
Let now Q âˆ¼P.
Q << P âˆ’â†’Z = dQ
dP
> 0
Q-a.s.
P << Q âˆ’â†’Z
also P-a.s. strictly positive
Lemma 3.2.6. Any strictly positive process (Zt) can be represented as
Zt = exp

Lt âˆ’1
2 âŸ¨LâŸ©t

= E(L)t
with
Lt = log Z0 +
t

0
Zâˆ’1
s
dZs.

3.2 The General Girsanov Transformation
61
Proof.
ItË†o =â‡’log Zt = log Z0 +
t

0
Zâˆ’1
s
dZs



Lt
âˆ’1
2
t

0
Zâˆ’2
s
dâŸ¨ZâŸ©s



âŸ¨LâŸ©t
,
since by Corollary 2.2.11
Mt =
t

0
f(Xs) dXs =â‡’âŸ¨MâŸ©t =
t

0
f2(Xs) dâŸ¨XâŸ©s.
âŠ“âŠ”
Proposition 3.2.7. (Girsanov for Q âˆ¼P): Let Q = E(L) Â· P. Then
one has
M âˆˆMc
loc(P) â‡â‡’#
M = M âˆ’âŸ¨M, LâŸ©âˆˆMc
loc(Q)
and
P = E(âˆ’L) Â· Q.
Proof. #
M = M âˆ’Zâˆ’1 â€¢ âŸ¨M, ZâŸ©âˆˆMc
loc(Q)
(Girsanov) , and
Lt = log Z0 +
t

0
1
Zs
dZs, i.e. L = Zâˆ’1 â€¢ Z. Thus
âŸ¨M, LâŸ©t = âŸ¨M, Zâˆ’1 â€¢ ZâŸ©t =
t

0
Zâˆ’1
s
dâŸ¨M, ZâŸ©s = (Zâˆ’1 â€¢ âŸ¨M, ZâŸ©)t
â†‘
computational rule for âŸ¨X, Y âŸ©.
L âˆˆMc
loc(P) âˆ’â†’âˆ’L = âˆ’L + âŸ¨L, LâŸ©
  
=âŸ¨LâŸ©
âˆˆMc
loc(Q)
P = E(L)âˆ’1 Â· Q
E(L)âˆ’1
t
= exp

âˆ’Lt + 1
2 âŸ¨LâŸ©t

= exp

âˆ’Lt âˆ’1
2 âŸ¨LâŸ©t

=âŸ¨LâŸ©t

= E(âˆ’L)t.

62
3 The Girsanov Transformation
Conversely one has
#
M âˆˆMc
loc(Q) âˆ’â†’#
#
M = #
M âˆ’âŸ¨#
M, âˆ’LâŸ©âˆˆMc
loc(P)
= #
M + âŸ¨#
M, LâŸ©
  
âŸ¨M,LâŸ©
= M.
âŠ“âŠ”
Computational rule for covariation of stochastic integrals:
(see Protter (1990) , Theorem29, p.68)
Proposition 3.2.8. X, Y continuous semimartingales,
H, K admissible integrands (w.r.t. X, Y )
Then one has
âŸ¨H â€¢ X, K â€¢ Y âŸ©t =
t

0
Hs Ks dâŸ¨X, Y âŸ©s.
Remark 3.3. X = M + A
Y = N + B
M, N âˆˆM(c)
loc
=â‡’âŸ¨X, Y âŸ©= âŸ¨M, NâŸ©
In particular, it follows:
âŸ¨H â€¢ M, NâŸ©t =
t

0
Hs dâŸ¨M, NâŸ©s
and
âŸ¨MâŸ©=
$ t

0
f(X) dXs
%
= âŸ¨f(X) â€¢ X, f(X) â€¢ XâŸ©t =
t

0
f2(Xs) dâŸ¨XâŸ©s.

3.3 Application to Brownian Motion
63
3.3 Application to Brownian Motion
Girsanov solves the following problem:
Given : X âˆˆMloc(P)
Q âˆ¼P

=â‡’
Girsanov

X âˆˆMloc(Q)
We now consider the inverse problem:
Given a semimartigale X = M +A w.r.t. P, i.e. M âˆˆMloc(P), A âˆˆFV
âˆƒQ âˆ¼P :
X âˆˆMloc(Q) ??
I.e., we are looking for a P-equivalent measure Q under which X is
a martingale (so-called equivalent martingale measure).
Approach: Q = E(L) Â· P
Girsanov =â‡’#
M = M âˆ’âŸ¨M, LâŸ©âˆˆMloc(Q)
#
M = X â‡â‡’A = âˆ’âŸ¨M, LâŸ©.
However, there are two problems:
1) Determination of L
2) Under what conditions is Q = E(L) Â· P a probability measure ??
ad 2:
Q prob. measure â†â†’EP [E(L)t] â‰¡1
(3)
â†â†’E(L)t is a martingale (since L0 = 0).
A suï¬ƒcient condition for E(L)t to be a martingale is the so-called
Novikov condition (see e.g. Revuz-Yor (1991), p.308):
E

exp{1
2 âŸ¨LâŸ©t}

< âˆ
âˆ€t .
(4)
ad 1:
Solution for semimartingales of Brownian motion
Let Xt = Bt +
t

0
Hs ds



Drift =A

64
3 The Girsanov Transformation
with (Bt)0â‰¤tâ‰¤T Brownian motion w.r.t. P and Ht(Ï‰) adapted,
c`adl`ag (e.g. Ht = f(Bs; s â‰¤t)) .
Claim:
Lt = âˆ’
t

0
Hs dBs solves the problem.
Proof.
âˆ’âŸ¨B, LâŸ©t = âŸ¨B, H â€¢ BâŸ©t =
t

0
Hs dâŸ¨BâŸ©s =
t

0
Hs ds = A
=â‡’Xt âˆˆMloc(Q) for Q = E(L) Â· P.
âŠ“âŠ”
Furthermore it follows
âŸ¨XâŸ©t = âŸ¨BâŸ©t = t < âˆ=â‡’(Xt)
L2-martingale.
It even follows: (Xt) is a Brownian motion w.r.t. Q ! This follows from
LÂ´evyâ€™s theorem:
(Xt) âˆˆMc
loc(P) , âŸ¨XâŸ©t = t âˆ€t â‰¥0
P-a.s. =â‡’(Xt) is B.M. w.r.t. P.
Example of a non-continuous local martingale with âŸ¨XâŸ©t = t:
Xt Poisson-Process (with parameter Î»); i.e.
P[Xt = K] = eâˆ’Î»t (Î» t)K
K!
,
E[Xt] = Î» t = Var(Xt)
=â‡’Mt = Xt âˆ’Î» t martingale and M2
t âˆ’Î» t martingale
=â‡’âŸ¨MâŸ©t = Î» t
Thus for Î» = 1, Mt is a martingale with âŸ¨MâŸ©t = t , but not contin-
uous.

3.3 Application to Brownian Motion
65
Same procedure for d-dimensional Brownian motion:
Let Bt = (B1
t , . . . , Bd
t ) be d-dimensional Brownian motion, i.e. (Bi
t)
(i = 1, . . . , d) are independent one-dimensional Brownian motions.
Proposition 3.3.1. (LÂ´evy) For an (Ft)-adapted continuous d-dimens-
ional process Xt = (X1
t , . . . , Xd
t ) with X0 = 0 the following statements
are equivalent:
(i) X is a Brownian motion w.r.t. (Ft)
(ii) X is a continuous local martingale mit âŸ¨Xi, XjâŸ©t = Î´ij Â· t
âˆ€i, j = 1 . . . d.
Proof. see Revuz-Yor (1991), p.141 .
âŠ“âŠ”
Proposition 3.3.2. (Girsanov for d-dimensional Brownian motion)
Let Xt = Bt +
t

0
Hs ds be a d-dimensional process with
E
&
exp
1
2
T

0
||Hs||2 ds
'
< âˆ
(Novikov condition).
(5)
Deï¬ne Q as dQ
dP = E

âˆ’
T

0
Hs dBs

.
Then under Q (Xt) is a d-dimensional Brownian motion for 0 â‰¤t â‰¤T.

4
Application to Financial Economics
In this chapter the methods developed in Chapter 2 and 3 are applied
to derive the fundamentals of â€œï¬nancial economicsâ€ in continuous time,
such as the market price of risk, the no-arbitrage principle, the funda-
mental pricing rule and its invariance under numeraire changes, and
the forward measure, a useful tool to deal with stochastic interest rates.
Special emphasis is laid on the economic interpretation of the so-called
â€œrisk-neutralâ€ arbitrage measure and its relation to the â€œreal worldâ€
measure considered in general equilibrium theory, a topic sometimes
leading to confusion between economists and ï¬nancial engineers.
Using the general Girsanov transformation, as developed in Sect. 3.2,
the rather intricate problem of the change of numeraire can be treated
in a rigorous manner, and the so-called â€œtwo-countryâ€ or â€œSiegelâ€ para-
dox serves as an illustration. The section on Feynman-Kac relates the
martingale approach used explicitly in these notes to the more classical
approach based on partial diï¬€erential equations.

68
4 Application to Financial Economics
4.1 The Market Price of Risk and Risk-neutral Valuation
We consider an economy depending on d independent stochastic factors
modelled by a d-dimensional Brownian motion Bt = (B1
t , . . . , Bd
t ) on
the ï¬ltered probability space (â„¦, (Ft)0â‰¤tâ‰¤T , P).
Let X be a security with returns
dXt
Xt
= ÂµX(t) dt +
ÏƒX(t) â—¦dBt



scalar product in IRd
0 â‰¤t â‰¤T
(1)
where ÂµX(t), ÏƒX(t) = (Ïƒ1
X, ..., Ïƒd
X) are adapted processes on (â„¦, (Ft), P)
We assume that there exists a Lebesgue-integrable real function Ï†X(t)
on [0, T], such that |ÂµX(t, Ï‰)| â‰¤Ï†X(t) and ||ÏƒX(t, Ï‰)||2 â‰¤Ï†X(t) P-a.s.
Remark 4.1. A process of the form (1) is a (positive) ItË†o-process.
Every strictly positive diï¬€usion process Xt can be written as an ItË†o-
process by taking its logarithm (compare Lemma 3.2.6).
Furthermore we consider the following processes:
r(t) = r(t, Ï‰) an adapted and bounded process of the â€œspotâ€ inter-
est rate,
Î²(t) = Î²(t, Ï‰) = exp
t

0
r(s, Ï‰) ds the accumulation process .
Î²(t) is the â€œsavingsâ€ account by rolling over one monetary unit at
the prevailing spot rate. Clearly, Î²(t) is an adapted continuous process
of ï¬nite variation.
Deï¬nition 4.1.1. Let Î»(t) = (Î»1, . . . , Î»d)t be an adapted process with
ÂµX(t) = r(t) + Î»(t) â—¦ÏƒX(t)
(2)
= r(t) +
d

i=1
Î»i(t) Ïƒi
X(t).
Then Î»(t) is called the process of the â€œmarket price of riskâ€ and Î»i(t)
the price of the i-th risk-factor .

4.1 The Market Price of Risk and Risk-neutral Valuation
69
Remark 4.2. For d = 1 the relation (2) can be written as
E

dXt
Xt |Ft

âˆ’r(t) dt
(
Var

dXt
Xt |Ft

= Î»(t) dt
which can be interpreted as the (expected) excess return per risk unit.
Let now Y be another security with
dYt
Yt
= ÂµY (t) dt + ÏƒY (t) â—¦dBt.
Let Î»X(t) and Î»Y (t) be the corresponding risk price processes of X and
Y .
We assume that the underlying economy is in an equilibrium state, i.e.
all price processes X(t), Y (t), r(t) etc. are determined by supply and
demand of the agents in this economy. In order to determine such an
equilibrium one would have to know the consumption and investment
behavior of each agent depending on his initial endowment, preferences
over consumption streams, expectations and attitude towards risk, a
formidable task. The power of ï¬nancial economics consists in working
with a much weaker condition, which certainly is necessary for an econ-
omy to be in equilibrium, namely the condition of â€œNo arbitrageâ€, i.e.
the absence of arbitrage proï¬ts without taking risks. Such an arbitrage
opportunity would exist if, at any time t and any state Ï‰, one could
form a riskless portfolio which has a higher return than the riskless in-
terest rate r(t, Ï‰). By â€œNo arbitrageâ€ we mean that such an arbitrage
opportunity does not exist.

70
4 Application to Financial Economics
The fundamental consequence of the above assumption is the following
theorem:
Theorem 4.1.2. â€œNo arbitrageâ€ implies
Î»X(t, Ï‰) = Î»Y (t, Ï‰)
for all (t, Ï‰) âˆˆ[0, T) Ã— â„¦.
Proof. We give a proof for d = 1 (for d > 1 see Ingersoll (1987)).
Assume there exists (t, Ï‰) with Î»X(t, Ï‰) > Î»Y (t, Ï‰). We may assume
that 0 < ÏƒX(t, Ï‰) < ÏƒY (t, Ï‰) (otherwise replace Ï† by âˆ’Ï† in the follow-
ing deï¬nition of Ï†).
Choose at time t the following portfolio of X and Y :
Ï†X =
ÏƒY
(ÏƒY âˆ’ÏƒX) Â· Xt
,
Ï†Y = âˆ’
ÏƒX
(ÏƒY âˆ’ÏƒX) Â· Yt
.
The value of this portfolio is
Vt(Ï†) = Ï†X Xt + Ï†Y Yt = 1
and its return
dVt = Ï†X dXt + Ï†Y dYt
=
1
ÏƒY âˆ’ÏƒX

(ÏƒY ÂµX âˆ’ÏƒX ÂµY



ÂµV
) dt + (ÏƒY ÏƒX âˆ’ÏƒX ÏƒY ) dBt



â‰¡0

Hence Vt has a riskless return
ÂµV =
1
ÏƒY âˆ’ÏƒX

ÏƒY (rt + Î»X ÏƒX) âˆ’ÏƒX(rt + Î»Y ÏƒY )

= rt + ÏƒY Â· ÏƒX
ÏƒY âˆ’ÏƒX



>0
(Î»X âˆ’Î»Y



>0
) > rt
which is in contradiction to the â€œNo arbitrageâ€ condition.
âŠ“âŠ”

4.1 The Market Price of Risk and Risk-neutral Valuation
71
Question: When is the process Î»(t) P-a.s. uniquely determined ?
Assume there exist n securities X1, . . . , Xn with

(t) =
â›
âœ
âœ
âœ
âœ
â
ÏƒX1(t)
.
.
.
ÏƒXn(t)
â
âŸ
âŸ
âŸ
âŸ
â 
(n Ã— d)-matrix of volatilities
and
Âµ(t)
=
â›
âœ
âœ
âœ
âœ
â
ÂµX1(t)
.
.
.
ÂµXn(t)
â
âŸ
âŸ
âŸ
âŸ
â 
, e =
â›
âœ
âœ
âœ
âœ
â
1
.
.
.
1
â
âŸ
âŸ
âŸ
âŸ
â 
.
No arbitrage implies
Âµ(t) = r(t) Â· e +

(t) â—¦Î»(t).
Hence Î»(t, Ï‰) is uniquely determined if and only if the stochastic ma-
trix

(t, Ï‰) has full rank d, for all t, P-a.s.
Clearly a necessary condition is n â‰¥d, i.e. there must be at least
as many securities as stochastic factors in the economy. A suï¬ƒcient
condition for d = 1 is ÏƒX(t, Ï‰) > 0 for all t, Ï‰.
Elimination of Î»(t) by means of Girsanov:
Assume that the Novikov condition
E

exp{1
2
T

0
||Î»(s)||2 ds}

< âˆ
(3)
is fulï¬lled. Deï¬ne
Lt = âˆ’
t

0
Î»(s) â—¦dBs
0 â‰¤t â‰¤T
P âˆ—= E(L) Â· P
, P âˆ—âˆ¼P.
Then the Girsanov theorem implies for each security price process Xt:

72
4 Application to Financial Economics
dXt
Xt
= ÂµX(t) dt + ÏƒX(t) dBt = r(t) dt + ÏƒX(t) (dBt + Î»(t) dt)
= r(t) dt + ÏƒX(t) dBâˆ—
t
and Bâˆ—
t is a d-dimensional Brownian motion under P âˆ—.
Remark 4.3. Clearly P âˆ—is unique if Î»(t) is unique.
Interpretation of P and P âˆ—:
We can interpret the original measure P as the (objective) â€real-worldâ€
measure or, in the equilibrium interpretation, as the (subjective) ex-
pectation of the â€œrepresentative investorâ€. For the equilibrium price
process Xt with respect to P one has
EP

dX
X |Ft

= r(t) dt + Î»(t) ÏƒX(t) dt
(under P)
(4)
with Î»(t) := market price of risk (varies with P !).
The measure P âˆ—can be interpreted as the expectation of a risk-neutral
investor, since
EP âˆ—

dX
X |Ft

= r(t) dt + zero-premium (under P âˆ—).
(5)
The relation (5) has been called by Cox-Ingersoll-Ross (1981) the â€œLo-
cal Expectation Hypothesisâ€, a terminology which has led to some con-
fusion. Note that the equilibrium process has not been changed, it is
the same under both measures P and P âˆ—. Girsanovâ€™s Theorem allows
us to replace the relation (4) through the equivalent simpler relation
(5). In particular, no assumption has been made about the existence
of risk-neutral investors. In a real economy neither a â€œrepresentativeâ€
nor a â€œrisk-neutralâ€ investor will exist, since both assumptions would
prevent the existence of a (stable) equilibrium. The great advantage of
the representation (5) under the (martingale) measure P âˆ—is that we
do not have to know anything about the individual expectations P and
the investorsâ€™ attitude towards risk.
In summary: Xt has not been changed. It is the same equilibrium
price process as under P, but in simpler representation under P âˆ—. P âˆ—is
called the â€œequivalent risk-neutral measureâ€ or the â€œP-equivalent mar-
tingale measureâ€.

4.2 The Fundamental Pricing Rule
73
4.2 The Fundamental Pricing Rule
Let Zt > 0 be the price process of an arbitrary security without divi-
dend payments in [0, T] with dynamics
dZt
Zt
= ÂµZ(t) dt + ÏƒZ(t) â—¦dBt
(ItË†o-process under P).
with ÂµZ(t), ÏƒZ(t) adapted processes as deï¬ned in Sect. 4.1 .
Remark 4.4. Any strictly positive semimartingale of the Brownian
motion can be written as an ItË†o-process (see Lemma 3.2.6).
Theorem 4.2.1. The discounted process
!Zt = exp

âˆ’
t

0
r(s) ds

Zt = Zt
Î²t
is a martingale under the risk-neutral measure P âˆ—.
Proof. Under P âˆ—one has
dZt
Zt
= r(t) dt + ÏƒZ(t) dBâˆ—
t .
By ItË†o it follows d !Zt = !Zt ÏƒZ(t) dBâˆ—
t , hence !Zt is a local martingale
under P âˆ—, with solution !Zt = Z0 Â· E(Nt) where Nt =
t
0
||ÏƒZ(s)||2 dBs.
But âŸ¨NâŸ©t =
t
0
||ÏƒZ(s)||2 ds â‰¤
t
0
Ï†Z(s) ds < âˆP âˆ—-a.s., which implies:
Eâˆ—
exp{1
2âŸ¨NâŸ©t}

â‰¤exp{1
2
t

0
Ï†Z(s) ds} < âˆ
âˆ€t
and the Novikov condition (see Sect. 3.3 (4)) is satisï¬ed. Hence !Zt is a
martingale under P âˆ—.
âŠ“âŠ”
Theorem 4.2.2. (Fundamental Pricing Rule)
Zt = Eâˆ—
&
exp

âˆ’
T

t
r(s) ds

Â· ZT
 Ft
'
0 â‰¤t â‰¤T
= Eâˆ—
 Î²t
Î²T
ZT
 Ft

.

74
4 Application to Financial Economics
Proof. Since !ZT is a P âˆ—- martingale, it follows:
!Zt = Eâˆ—[ !ZT
 Ft] = Eâˆ—
&
exp

âˆ’
T

0
r(s) ds

ZT
 Ft
'
Zt = Eâˆ—[Î²t !ZT
 Ft] = Eâˆ—
 Î²t
Î²T
ZT
 Ft

.
âŠ“âŠ”
Examples:
1. Zt = Pt(T) zero-bond with maturity T, i.e. PT (T) = 1.
=â‡’Pt(T) = Eâˆ—
&
exp

âˆ’
T

t
r(s) ds
  Ft
'
2. Zt = (XT âˆ’K)+ call option on security X
=â‡’Zt = Eâˆ—
&
exp

âˆ’
T

t
r(s) ds

(XT âˆ’K)+  Ft
'
special case: d = 1 , r(t, Ï‰) â‰¡r
, ÏƒZ(t, Ï‰) â‰¡Ïƒ
=â‡’Zt = Xt Â· Î¦(d1) âˆ’K Â· exp{âˆ’(T âˆ’t
  
s
) Â· r} Î¦(d2)
with
d1,2 = ln(Xt/K Â· eâˆ’rs)
Ïƒâˆšs
Â± 1
2 Ïƒâˆšs
(Black-Scholes-formula) .
The proof can be given as exercise (or see Sect. 2.9).
Hint: Bâˆ—is a Brownian motion under P âˆ—, i.e.
P âˆ—[Bâˆ—
T â‰¤x] = Î¦
 x
âˆš
T

â‡â‡’Bâˆ—
T âˆ¼N(0, T)
under P âˆ—
â‡â‡’Bâˆ—
T
âˆš
T
âˆ¼N(0, 1).

4.2 The Fundamental Pricing Rule
75
Dividend paying securities
Let Z(t) be the price process of a security with continuous dividend
payments given by the dividend rate dZ(t) which is proportional to
Z(t).1 Assume that the dynamics of the (ex dividend) process is given
by
dZt
Zt
= ÂµZ(t) dt + ÏƒZ(t) â—¦dBt
(ex-dividend process)
(6)
Let Z(t) denote the process with accumulated dividends, i.e.
d Zt
Zt
= (ÂµZ(t) + dZ(t)



Âµ Z(t)
) dt + ÏƒZ(t) â—¦dBt
(cum-dividend process) (7)
Denote by Î¾(t) = exp{
t
0
dZ(s) ds} the accumulated dividend process.
One easily checks that Zt = Î¾(t)Â·Z(t) is a solution of (7). Since Zt does
not pay dividends, the Fundamental Pricing Rule implies
Zt = Eâˆ—
&
exp

âˆ’
T

t
r(s) ds

Â· ZT
 Ft
'
0 â‰¤t â‰¤T,
which implies
Zt =
Z(t)
Î¾(t) = Eâˆ—
&
exp

âˆ’
T

t
r(s) ds
 Î¾(T)
Î¾(t) ZT
 Ft
'
= Eâˆ—
&
exp

âˆ’
T

t
(r(s) âˆ’dZ(s)) ds

ZT
 Ft
'
.
Remark 4.5. Both r(t) and dZ(t) may be stochastic.
1 Although this is an unrealistic assumption for a single stock, which rather pays
lump sum dividends, it is a good approximation to reality for stock indices, and
ï¬ts exactly the case where Z(t) is a currency or an exchange rate (see the following
sections).

76
4 Application to Financial Economics
4.3 Connection with the PDE-Approach
(Feynman-Kac Formula)
In Sect. 4.2 general valuation formulas for securities and derivatives
were derived by martingale methods, which lead to the computation
of conditional expectations. The classical approach of Black-Scholes-
Merton is based on the solution of partial diï¬€erential equations un-
der boundary conditions. A connection between these two at ï¬rst
sight fundamentally diï¬€erent approaches is provided by the so-called
Feynman-Kac formula. If a number of technical conditions is satisï¬ed,
the Feynman-Kac formula enables one to switch back and forth be-
tween the martingale and the PDE-approach. In other words, the two
seemingly so diï¬€erent approaches appear as two diï¬€erent sides of one
coin.
An essential condition for Feynman-Kac is, however, that the underly-
ing security processes have to be markovian diï¬€usions, i.e. to be of the
form
dXt = Âµ(Xt, t) dt + Ïƒ(Xt, t) dBt
(8)
with (Bt) a Brownian motion under the measure P.
Feynman-Kac considers the following problem:
Find a solution f(x, t) âˆˆC2,1(IR Ã— [0, T]) for the PDE
A f(x, t) âˆ’r(x, t) f(x, t) = 0
(x, t) âˆˆIR Ã— [0, T)
(9)
under the boundary condition
f(x, T) = g(x)
x âˆˆIR
(10)
where
A f(x, t) = ft(x, t) + fx(x, t) Âµ(x, t) + 1
2 Ïƒ2(x, t) fxx(x, t).
(11)
Remark 4.6. A f is the so-called â€œinï¬nitesimal generatorâ€ of f(x, t),
deï¬ned as the expected rate of change of f(Xt, t), given Xt = x, i.e.
A f(x, t) = lim
âˆ†â†’0
1
âˆ†

E[f(Xt+âˆ†, t + âˆ†)|Xt = x] âˆ’f(x, t)

.
From ItË†oâ€™s formula applied to df(Xt, t) and the local martingale property
of the ItË†o-integral one easily derives (11).

4.3 Connection with the PDE-Approach
(Feynman-Kac Formula)
77
The Feynman-Kac solution of (9) till (11), if it exists, is given by the
conditional expectation
f(x, t) = EP

exp

âˆ’
T

t
r(Xs, s) ds

g(XT )
Xt = x

(12)
where X is a solution of (8) with Xt = x.
For the necessary technical conditions (besides diï¬€erentiability a num-
ber of Lipschitz- and polynomial boundary conditions are required) we
refer to Duï¬ƒe (2001).
Under additional assumptions the solution (12) is unique. In this case
the Feynman-Kac formula also allows switching back: the conditional
expectation (12) can be computed as the solution of the PDE (9) under
the boundary constraint (10).
Application: Let Xt be a security process with return
dXt
Xt
= ÂµX(t) dt + ÏƒX(t) dBt,
where ÂµX and ÏƒX are deterministic integrable functions of t. Consider
a contingent claim ZT = g(XT ) with g : IR âˆ’â†’IR continuous. By
Girsanov there exists P âˆ—âˆ¼P with
dXt
Xt
= r(t) dt + ÏƒX(t) dBâˆ—
t
(13)
Observe: In contrast to the martingale approach r(t) and ÏƒX(t) have
to be non-stochastic.
According to the Fundamental Pricing Rule (see Sect. 4.2) one has
Zt = EP âˆ—

exp

âˆ’
T

t
r(s) ds

g(XT )
Xt = x

.
(14)
Setting Zt = f(x, t) âˆˆC2,1 and
Âµ(Xt, t) = r(t) Â· Xt
,
Ïƒ(Xt, t) = ÏƒX(t) Â· Xt,
it follows from Feynman-Kac (when the technical FK-conditions are
satisï¬ed):

78
4 Application to Financial Economics
Zt = f(x, t)
is solution of the PDE
âˆ’r(t) f(x, t)+ ft(x, t)+ r(t) x fx(x, t)+ 1
2 Ïƒ2
X(t) x2 fxx(x, t) = 0 (15)
under the boundary constraint
f(x, T) = g(x).
(16)
Thus the solution of (14) is reduced to the solution of the partial dif-
ferential equation (15) under the boundary constraint (16).
(Check the equivalence of equation (15) with the Black-Scholes PDE
in Sect. 2.5 (18)).
4.4 Currency Options and Siegel-Paradox
In nostalgic remembrance of our dear deceased Deutschmark we con-
sider the exchange rate USD/DM. (It is a good exercise to transfer this
and the following sections to the exchange rate EUR/USD).
We use the following notation:
rDM(t) = DM spot rate at t (valid for the period [t, t + dt])
r$(t)
= $ spot-rate at t
Xt
= exchange rate $/DM (price of 1 $ in DM at t)
Note that Xt is a security with continuous dividend payment r$(t).
According to Sect. 4.2 it follows
dXt
Xt
= (rDM(t) âˆ’r$(t)) dt + ÏƒX(t) dBâˆ—
t
under P âˆ—
where P âˆ—is the risk-neutral expectation of a German investor.
Consider now the process Yt = Xâˆ’1
t
Â· 100 which is (or was!) the ex-
change as quoted in the US for 1 DM in cents.
Yt is a security with continuous dividend rDM(t). Note that ÏƒY (t) =
âˆ’ÏƒX(t) since ln Yt = âˆ’ln Xt + c0.

4.5 Change of Numeraire
79
Question: Does the following relation hold
dYt
Yt
= (r$(t) âˆ’rDM(t)) dt + ÏƒY (t) dBâˆ—
t
under P âˆ—
for a risk-neutral American investor ?
Answer: From ItË†o it follows
dYt
Yt
= dXâˆ’1
t
Xâˆ’1
t
=

d 1
Xt

Â· Xt
d 1
Xt
= âˆ’1
X2
t
dXt + 1
2 Â· 2 Â· 1
X3
t
dâŸ¨XâŸ©t
with
dâŸ¨XâŸ©t = Ïƒ2
X(t) X2
t dt.
From ÏƒY (t) = âˆ’ÏƒX(t) it then follows
dYt
Yt
= âˆ’dXt
Xt
+ Ïƒ2
X(t) dt
=

r$(t) âˆ’rDM(t) + Ïƒ2
Y (t)

dt + ÏƒY (t) dBâˆ—
t
Thus a â€œrisk-neutralâ€ American investor requires a positive risk pre-
mium of Ïƒ2
Y (t).
This is the so-called â€Siegelâ€- or â€Two-Country-Paradoxâ€ (see Siegel
(1972), McCulloch (1975)). The solution to this Paradox will be given
in Sect. 4.6.
4.5 Change of Numeraire
A fundamental law in economics - the â€œWalras lawâ€ - implies that
in equilibrium only relative prices can be determined. In order to ob-
tain absolute prices one has to choose one commodity as â€œnumeraireâ€.
Which commodity is chosen as numeraire is a question of convenience.
The situation is similar in ï¬nancial economics. However, here a non-
trivial technical complication arises: the risk-neutral measure P âˆ—de-
pends in a crucial way on the choice of the numeraire.

80
4 Application to Financial Economics
Let Xt = (X0
t , . . . , Xn
t )(0â‰¤tâ‰¤T) be the price process of n + 1 securities
of the form
dXi
t
Xi
t
= Âµi(t) dt + Ïƒi(t) dBt
under P
with Âµi(t), Ïƒi(t) (i = 0, . . . , n) adapted processes on (â„¦, (Ft), P) satis-
fying the boundary condition as deï¬ned in Sect. 4.1 .
Usually (X0
t ) is chosen as numeraire, e.g. dX0
t = r(t) X0
t dt (the accu-
mulation process). Then absolute security prices, measured in units of
X0, are given by the normed process
!
Xt =

1, X1
X0 , . . . , Xn
X0

t.
Consider a portfolio strategy (Ï†)t = (Ï†0, . . . , Ï†n)t. Then Vt(Ï†) = Ï†tâ—¦Xt
is the value process with respect to Xt. Similarly !Vt(Ï†) = Ï†t â—¦!
Xt =
Vt(Ï†) Â· (X0
t )âˆ’1 is the value process with respect to !
Xt.
Recall:
(Ï†t) is self-ï¬nancing w.r.t. Xt â‡â‡’
def
dVt(Ï†) = Ï†t â—¦dXt
â‡â‡’Vt(Ï†) = Ï†0 â—¦X0 +
t

0
Ï†s â—¦dXs
= (Ï† â€¢ X)t
0 â‰¤t â‰¤T
Recall: (meaning of the diï¬€erent â€™dotsâ€™)
Â· scalar multiplication
â—¦scalar product
â€¢ stochastic integral
Proposition 4.5.1. Ï†t is self-ï¬nancing with respect to Xt if, and only
if, Ï†t is self-ï¬nancing with respect to !
Xt.
Proof.
(=â‡’)
By assumption one has dVt = Ï†t â—¦dXt.
Let Yt = (X0
t )âˆ’1. According to the rules for the covariation one
has
dâŸ¨V, Y âŸ©t = dâŸ¨Ï† â€¢ X, Y âŸ©t = Ï†t â—¦dâŸ¨X, Y âŸ©t .

4.5 Change of Numeraire
81
Thus according to ItË†oâ€™s product rule
d!Vt = d(Vt Â· Yt) = Vt dYt + Yt dVt + dâŸ¨V, Y âŸ©t
= (Ï†t â—¦Xt) dYt + Yt(Ï†t â—¦dXt) + Ï†t â—¦dâŸ¨X, Y âŸ©t
= Ï† â—¦

Xt dYt + Yt dXt + dâŸ¨X, Y âŸ©t

= Ï† â—¦d(Xt Â· Yt) = Ï† â—¦d !
Xt
(â‡=)
The procedure is analogous.
âŠ“âŠ”
Under the assumptions of Sect. 4.1, â€no arbitrageâ€ and the Girsanov
theorem applied to the â€market price of riskâ€ process Î»(t) under the
Novikov condition (3) together with Prop. 4.2.1 imply:
âˆƒP âˆ—âˆ¼P : !
Xt martingale under P âˆ—, and Bâˆ—
t B.M. w.r.t. P âˆ—.
Let CT âˆˆFT be a contingent claim with CT = VT (Ï†) for some self-
ï¬nancing portfolio strategy Ï†. Consider !CT = CT /X0
T = !VT (Ï†). Since
d!V = Ï† d !
X, !V is a local P âˆ—-martingale. If it is a martingale, then it
follows:
!Ct = Eâˆ—[!VT (Ï†)
 Ft] = Eâˆ—[ !CT
 Ft]
Ct = !Ct Â· X0
t = Eâˆ—
 X0
t
X0
T
Â· CT
 Ft

.
Question: Does the analysis depend on the choice of the numeraire ?
Let now Xi be the numeraire. Consider

Xt =
X0
Xi , . . . , 1, . . . , Xn
Xi

t
security prices measured in Xi ,
V = V
Xi
,
C = C
Xi .
According to Prop. 4.5.1 Ï† is also self-ï¬nancing with respect to 
X.
Proposition 4.5.2. 
Xt is a martingale under Qâˆ—
i = E(Ni) Â· P âˆ—with
Ni(t) =
t

0

Ïƒi(s) âˆ’Ïƒ0(s)



Ïƒ !
Xi

dBâˆ—
s
(0 â‰¤t â‰¤T)

82
4 Application to Financial Economics
Remark 4.7. For dX0 = X0r(t)dt one has Ïƒ0 = 0.
Proof. By assumption on Ïƒi and Ïƒ0, there exist Lebesgue-integrable
functions such that ||Ïƒi(s, Ï‰) âˆ’Ïƒ0(s, Ï‰)||2 â‰¤Ï†i(s) + Ï†0(s) = Ïˆ(s)
P-a.s., which implies
âŸ¨NiâŸ©t =
t

0
||Ïƒi âˆ’Ïƒ0||2 ds â‰¤
t

0
Ïˆ(s)ds < âˆ
âˆ€t,
and the Novikov condition (see Sect. 3.3 (4)) is fulï¬lled. Thus Ni(t) is
a martingale =â‡’Zt = E(Ni(t)) is a martingale. â‡’Qâˆ—
i is a probability
measure.
Hence (see Lemma 3.2.4) for any j = 0, 1, . . . , n,

Xj âˆˆMc
loc(Qâˆ—
i ) â†â†’
Xj Â· Z âˆˆMc
loc(P âˆ—).
We know d !
Xi
!
Xi = Ïƒ !
Xi(t) dBâˆ—
t where Bâˆ—
t is a Brownian motion under P âˆ—
=â‡’!
Xi
t = !
Xi
0 Â· E(Ni(t)).
(17)
Thus it follows

Xj Â· Z = Xj
Xi Â· Z = !
Xj Â· ( !
Xi)âˆ’1 Â· Z
= !
Xj Â· ( !
Xi
0)âˆ’1 Â· E(Ni)âˆ’1 Â· E(Ni) âˆˆMc
loc(P âˆ—).
Therefore with (Xi) as numeraire, we have
d 
Xj
t

Xj
t
= Ïƒ 
Xj(t)
  
=Ïƒjâˆ’Ïƒi
dBi
t
where Bi
t Brownian motion under Qâˆ—
i .
Again
t
0
||Ïƒ 
Xj(s)||2 ds â‰¤
t
0
Ïˆ(s)ds < âˆimplies that 
Xj is indeed a
martingale.
âŠ“âŠ”
Conclusion: P âˆ—is a martingale measure with respect to (X0) as nu-
meraire if, and only if, Qâˆ—
i is a martingale measure with respect to (Xi)
as numeraire.

4.5 Change of Numeraire
83
Connection Bâˆ—
t â†â†’Bi
t:
Bâˆ—
t âˆˆMc(P âˆ—) , Qâˆ—
i = E(Ni) Â· P âˆ—=â‡’
GirsanovBi
t = Bâˆ—
t âˆ’âŸ¨Bâˆ—, NiâŸ©t âˆˆMc(Qâˆ—
i )
=â‡’Bi
t = Bâˆ—
t âˆ’
t

0
Ïƒ !
Xi(s)
  
Ïƒiâˆ’Ïƒ0
dâŸ¨BâŸ©s = Bâˆ—
t +
t

0
(Ïƒ0 âˆ’Ïƒi)(s) ds.
Thus we have
Ct = Eâˆ—
i

 CT
Xi
T
 Ft

with Xi
t as numeraire.
The decisive result is now given by the following proposition:
Proposition 4.5.3.
Xi
t Â· Ct = X0
t Â· !Ct.
(i.e., the valuation of the contingent claim CT does not depend on the
numeraire.)
Lemma 4.5.4. (Bayes rule): Let Q = ZT Â· P on FT and
Y âˆˆL1(â„¦, Ft, Q). Then, for any s < t â‰¤T, it follows
EQ[Y |Fs] = 1
Zs
EP [Y Â· Zt
 Fs].
Proof. Let A âˆˆFs. Since dQt
dPt
= Zt = EP [ZT
 Ft] it follows
EQ[1A Y ] = EP [1A Y Â· Zt] = EP

1A EP [Y Â· Zt
 Fs]

= EQ

1A Â· 1
Zs
EP [Y Â· Zt
 Fs]

.
âŠ“âŠ”
Proof of Prop. 4.5.3:. According to (17) one has Zt = ( !
Xi
0)âˆ’1Â· !
Xi
t. Thus
Lemma 4.5.4 implies
Ct = Eâˆ—
i [ CT |Ft] = 1
Zt
Eâˆ—[ CT ZT
 Ft] =
!
Xi
0
!
Xi
t
Eâˆ—
 CT
Xi
T
Â·
!
Xi
T
!
Xi
0
 Ft

= 1
!
Xi
t
Eâˆ—
 CT
Xi
T
Â· Xi
T
X0
t



!CT
 Ft

= X0
t
Xi
t
!Ct.
âŠ“âŠ”

84
4 Application to Financial Economics
4.6 Solution of the Siegel-Paradox
The techniques developed in the previous section solve the Siegel-
Paradox. The spot price process for a portfolio in Deutschmark and
Dollars is given by
Zt = (Xt, Yt) = (Î²DM
t
, et Î²$
t )
with
et
= exchange rate $/DM
Î²DM
t
= exp
t

0
rDM(s) ds
Î²$
t
= exp
t

0
r$(s) ds.
From the view point of the German investor (Xt) is the numeraire.
Thus
!Zt = (1, !Yt)
with !Yt = et
Î²$
t
Î²DM
t
and
d!Yt
!Yt
= Ïƒ!Y (t) dBt
, Ïƒ!Y = ÏƒY âˆ’ÏƒX = Ïƒe
under the martingale measure P âˆ—which is the expectation of the risk-
neutral German investor.
Applying ItË†oâ€™s product rule it follows:
=â‡’det
et
= (rDM(t) âˆ’r$(t)) dt + Ïƒe(t) dBt
under P âˆ—.

4.6 Solution of the Siegel-Paradox
85
However, from the viewpoint of the American investor the numeraire
is (Yt).
=â‡’Zt = ( 
Xt, 1)
with 
Xt = ft Â· Î²DM
t
Î²$
t
, ft = 1
et
(exch. rate DM/$)
New martingale measure :
Qâˆ—= E(N) Â· P âˆ—
Nt =
t

0
Ïƒ!Y (s)
  
=Ïƒe
dBs.

X martingale under Qâˆ—=â‡’d 
Xt

Xt
= Ïƒ 
X(t) d Bt
with Ïƒ 
X = ÏƒX âˆ’ÏƒY = âˆ’Ïƒe = Ïƒf and d Bt = dBt + Ïƒf dt is Brownian
motion under Qâˆ—.
=â‡’
dft
ft
= (r$(t) âˆ’rDM(t)) dt + Ïƒf(t) d Bt
under Qâˆ—
=

r$(t) âˆ’rDM(t) + Ïƒ2
f(t)

dt + Ïƒf(t) dBt
under P âˆ—
Thus also from the view point of the American investor there is no
risk premium under the correct martingale measure Qâˆ—.

86
4 Application to Financial Economics
4.7 Admissible Strategies and Arbitrage-free Pricing
The â€œNo arbitrageâ€ condition given in section 4.1 rules out arbitrage
opportunities in a short (strictly speaking inï¬nitesimal) time interval.
As we have shown this condition implies that the â€œmarket price of
riskâ€ process Î»(t) must be identic for all security price processes in
the considered market, which under the â€œNovikovâ€ condition implies
the existence of an equivalent martingale measure P âˆ—. Conversely, if an
equivalent martingale measure P âˆ—exists, then according to the relation
(5) inï¬nitesimal arbitrage opportunities cannot exist.
However, the â€œno arbitrageâ€ condition used so far does not rule out,
that there may exist dynamic trading strategies Ï† which over a ï¬nite
time horizon allow arbitrage proï¬ts.
Let Xt = (X0, . . . , Xn)0â‰¤tâ‰¤T be the price process of n+1 securities sat-
isfying the conditions given in section 4.5 . Let (Ï†)t = (Ï†0, . . . , Ï†n)t be
a self-ï¬nancing portfolio strategy, i.e. an adapted (n + 1)-dimensional
stochastic process with Vt(Ï†) = Ï†t â—¦Xt and dVt = Ï†t â—¦dXt. As shown in
Prop. 4.5.1, the property of Ï† of being self-ï¬nancing does not depend
on the choice of the numeraire.
Deï¬nition 4.7.1. An arbitrage opportunity is a self-ï¬nancing portfo-
lio strategy Ï† such that the wealth process Vt(Ï†) satisï¬es the following
conditions:
V0(Ï†) = 0,
P[VT (Ï†) â‰¥0] = 1,
and
P[VT (Ï†) > 0] > 0.
Such a portfolio or trading strategy would allow one to start with an
initial investment of zero and without adding money in the time interval
[0, T] to receive a positive amount at time T with positive probability.
Since even in the simplest case of the standard Black-Scholes model
(d = 1, Âµ and Ïƒ = const., r = 0) there exist self-ï¬nancing strategies
which allow arbitrage (see e.g. Harrison-Kreps (1979) or Duï¬ƒe (2001))
we need some subclass of â€œadmissibleâ€ strategies which rule out such
arbitrage opportunities.
Consider the case where X0
t = Î²(t) = exp
t

0
r(s) ds is chosen as nu-
meraire, and the discounted process is !
X = X/X0.

4.7 Admissible Strategies and Arbitrage-free Pricing
87
Let Î¦0 be the class of self-ï¬nancing strategies which are integrable w.r.t.
!
X and for which there exists some constant k with
!Vt(Ï†) = Vt(Ï†)/X0
t = Ï†t â—¦!
Xt â‰¥k
âˆ€t âˆˆ[0, T]
(18)
The condition (18) can be interpreted as a credit constraint, which
means that short sales are allowed, but the wealth process must stay
above a lower bound k, which may be negative. The strategies in Î¦0
are also called â€œtameâ€ (w.r.t. X0).
Remark 4.8. If the short rate process r(t) is bounded, then obviously
the condition (18) is equivalent to: Vt(Ï†) is bounded below.
Let M( !
X) denote the set of equivalent martingale measures under
which !
X is a martingale.
Theorem 4.7.2. If M( !
X) Ì¸= âˆ…, then there is no arbitrage in Î¦0.
Proof. Consider Ï† âˆˆÎ¦0 with V0(Ï†) = 0 and P[VT (Ï†) â‰¥0] = 1 . Then
!Vt(Ï†) = Ï†t â—¦!
Xt = Vt(Ï†) Â· (X0
t )âˆ’1 is the value process with respect to
!
Xt. Since X0 is strictly positive, Vt is positive iï¬€!Vt is positive. Since
Vt is self-ï¬nancing w.r.t. X, it is also self-ï¬nancing w.r.t. !
X. Hence
!Vt(Ï†) = Ï† â€¢ !
Xt is a local martingale for any P âˆ—âˆˆM( !
X). Since !Vt is by
assumption bounded below, Fatouâ€˜s lemma (see Sect. 1.1) applied to a
sequence of localizing stopping times of !Vt implies Eâˆ—[!VT ] â‰¤Eâˆ—[!V0] = 0,
which together with !VT â‰¥0 P âˆ—-a.s. implies P âˆ—[!VT > 0] = 0. Since
P âˆ—âˆ¼P this is equivalent to P[VT > 0] = 0.
âŠ“âŠ”
If CT âˆˆL1(â„¦, FT , P âˆ—) is a (European) contingent claim, which settles
at time T, then the fundamental pricing rule implies that its price Î t
under P âˆ—âˆˆM( !
X) at any 0 â‰¤t â‰¤T is given by the process
Î t = X0
t EP âˆ—[CT /X0
T
 Ft]
(19)
If there is a unique P âˆ—âˆˆM( !
X) this process is also uniquely deter-
mined. However, there may be many diï¬€erent equivalent martingale
measures in M( !
X), as is the case when the market is â€œincompleteâ€. In
this case the price process (19) is no longer uniquely determined by the
fundamental pricing rule, but depends on the choice of an equivalent
martingale measure. In particular this is the case if n < d, i.e. there
are less securities in the market than sources of uncertainty. Thus in
incomplete markets the price of an arbitrary contingent claim cannot
be determined by â€œno arbitrageâ€ arguments.

88
4 Application to Financial Economics
Deï¬nition 4.7.3. A contingent claim CT âˆˆL1(â„¦, FT , P âˆ—) is attainable
if there exists an admissible strategy Ï† âˆˆÎ¦0 with CT = VT (Ï†) and
!Vt(Ï†) = Ï†t â—¦Xt/X0
t is a P âˆ—-martingale for some P âˆ—âˆˆM( !
X).
If any integrable contingent claim is attainable, the market is called
complete.
Proposition 4.7.4. The price Î t of any attainable contingent claim
CT is uniquely determined by no-arbitrage and is given by the relation
(19), where the expectation is taken for arbitrary P âˆ—âˆˆM( !
X).
Proof. Let Ï† and Ïˆ be two admissible strategies with VT (Ï†) = VT (Ïˆ) =
CT and P âˆ—
1 , P âˆ—
2 âˆˆM( !
X). Then also !VT (Ï†) = !VT (Ïˆ) = !CT . Consider
the two value processes
Vt(Ï†) = X0
t EP âˆ—
1 [!VT (Ï†) | Ft)]
(20)
Vt(Ïˆ) = X0
t EP âˆ—
2 [!VT (Ïˆ) | Ft)] .
(21)
Then !Vt(Ï†) = Ï†t â—¦!
Xt is a local P âˆ—
2 - martingale and, since it is bounded
from below, by Fatouâ€™s lemma, a P âˆ—
2 - sub-martingale, which implies
!Vt(Ïˆ) = EP âˆ—
2 [!VT (Ïˆ) | Ft)] = EP âˆ—
2 [!VT (Ï†) | Ft)] â‰¤!Vt(Ï†) .
(22)
By the same argument it also follows !Vt(Ï†) â‰¤!Vt(Ïˆ). Hence
Î t = Vt(Ï†) = Vt(Ïˆ) is the unique arbitrage price of CT .
âŠ“âŠ”
Unfortunately the condition of â€œtamenessâ€ depends on the choice of
the numeraire. Thus an admissible strategy in Î¦0 may not be admis-
sible for the numeraire Xi, although the property of self-ï¬nancing is
independent of the numeraire, as shown in Proposition 4.5.1. This is
unsatisfactory from an economic point of view. For the property of a
market to be â€œarbitrage freeâ€ or not should not depend on the choice
of the numeraire.
A satisfactory solution of this problem, which requires very advanced
technical methods, is beyond the scope of these notes. These problems
have been dealt with in a number of papers by Delbaen and Schacher-
mayer, see in particular Delbaen-Schachermayer (1995) and
Delbaen-Schachermayer (1997).

4.8 The â€œForward Measureâ€
89
4.8 The â€œForward Measureâ€
The â€œforward measureâ€ is a useful tool when interest rates are stochas-
tic. Then the accumulation factor
Î²t(Ï‰) = exp
t

0
r(s, Ï‰) ds
is a stochastic process, making the computation of the conditional ex-
pectation in the Fundamental Pricing Rule (Theorem 4.2.2) cumber-
some.
Consider the following connection between $t (t = â€œtodayâ€) and $T
(T = â€œtomorrowâ€):
0
t
T
1
- Î²t
- Î²T
spot prices
zerobond prices
P0(T)
Pt(T)
1


Let Xt = (X0, X1, . . .)t be price processes of securities. Choosing X0
t =
Î²t as numeraire determines the martingale measure P âˆ—, under which
Xi
t = Eâˆ—
 Î²t
Î²T
Xi
T | Ft

i = 0, 1, 2 . . . , 0 â‰¤t â‰¤T.
Remark 4.9. P âˆ—is also called the â€œspot martingale measureâ€, since
the spot price process is chosen as numeraire.

90
4 Application to Financial Economics
In particular one has
Pt(T) = Eâˆ—
 Î²t
Î²T
| Ft

since PT (T) â‰¡1.
Thus
!Pt(T) = Pt(T)
Î²t
is a
P âˆ—âˆ’martingale
and
dPt(T)
Pt(T) = r(t) dt + Ïƒ(t, T) â—¦dBâˆ—
t
under P âˆ—.
Remark 4.10. Observe that Ïƒ(t, t) = 0 since Pt(t) â‰¡1.
Change of numeraire from $t to $T
Instead of Î²t choose now Pt(T) as numeraire. According to Sect. 4.5
the corresponding martingale measure PT is given by
PT = E(L(T)) Â· P âˆ—
with
Lt(T) =
t

0
Ïƒ !Pt(s) â—¦dBâˆ—
s =
t

0
Ïƒ(s, T) â—¦dBâˆ—
s
and one has
BT
t = Bâˆ—
t âˆ’âŸ¨Bâˆ—
t , LtâŸ©= Bâˆ—
t âˆ’
t

0
Ïƒ(s, T) ds.
Let HT âˆˆFT be a contingent claim. Then under P âˆ—:
Ht = Eâˆ—
 Î²t
Î²T
HT | Ft

(Price in $t.)
Under PT it follows :
HT =
HT
PT (T) = HT
Ht = ET [HT |Ft]
(Price in $T )
Ht = Ht Â· Pt(T)
(Price in $t) .

4.8 The â€œForward Measureâ€
91
Thus we have proved
Ht = Eâˆ—
 Î²t
Î²T
HT | Ft

= Pt(T) Â· ET [HT | Ft]
PT = â€œforward measureâ€ (see e.g. Geman-ElKaroui-Rochet (1995))
The connection with the deï¬nition of PT sometimes given in the liter-
ature is established by the following proposition :
Proposition 4.8.1. PT [A] = Eâˆ—
(Î²T Â·P0(T))âˆ’1 | Ft

Â·P âˆ—[A]
for any A âˆˆ
Ft.
Proof. !
Xt = !Pt(T) = Pt(T)
Î²t
is P âˆ—-martingale with
d !
Xt
!
Xt
= Ïƒ(t, T) â—¦dBt = dLt(T)
=â‡’!
Xt =
!
X0

=P0(T)
Â· E(Lt(T)).
For A âˆˆFt one has
PT [A] = Eâˆ—[E(LT (T)) | Ft] Â· P âˆ—[A]
= E(Lt(T)) Â· P âˆ—[A].
(23)
Since !
Xt P âˆ—-martingale, it follows
Eâˆ—
 1
Î²T
| Ft

= Eâˆ—[ !
XT |Ft] = !
Xt = P0(T) Â· E(Lt(T))
which together with (23) completes the proof.
âŠ“âŠ”

92
4 Application to Financial Economics
4.9 Option Pricing Under Stochastic Interest Rates
As an application of the forward measure we now study currency op-
tions when interest rates are stochastic.
Let $t (= et) be the process of the exchange rate $/DM. This gives
rise to the following price processes for a portfolio in DM/$ :
(Î²DM
t
, $t Î²$
t )
â€œspotâ€ price processes
0 â‰¤t â‰¤T
(DM,$ â€œtodayâ€)
(P DM
t
(T), $t Â· P $
t (T)) â€œforwardâ€ price processes 0 â‰¤t â‰¤T .
(DM,$ â€œtomorrowâ€)
Now choose P DM
t
(T) as numeraire, i.e. instead of DMt (â€todayâ€) cal-
culate in DMT (â€tomorrowâ€). This leads to the following discounted
processes:
!Zt = (1, !Yt)
with !Yt = $t Â· P $
t (T)
P DM
t
(T)
(T-forward $-price at t)
By the Interest-rate-parity theorem, which is illustrated in the following
diagram, !Yt is, at time t, the forward price Ft(T) of one dollar delivered
at time T.
6

6

P $
t (T)
$today
$t
DMtoday
t
P DM
t
(T)
T
DMtomorrow
Ft(T) = !Yt
$tomorrow
Diagram: Interest-Rate-Parity Theorem

4.9 Option Pricing Under Stochastic Interest Rates
93
Under the forward measure PT , !Yt is a martingale.
Clearly $T = !YT . Thus it follows, that the price Ht of the call op-
tion HT = ($T âˆ’K)+ at time t is given by :
Ht = P DM
t
(T) ET [(!YT âˆ’K)+  Ft] = P DM
t
(T)

!Yt Î¦(d1
t ) âˆ’K Â· Î¦(d2
t )

= $t Â· P $
t (T) Â· Î¦(d1
t ) âˆ’K Â· P DM
t
(T) Â· Î¦(d2
t )
where d1,2
t
= ln(!Yt/K)
Î·t
Â± 1
2 Î·t with
Î·2
t =
T

t
||Ïƒ!Y (s)||2 ds =
T

t
||Ïƒ$(s) + Ïƒ$(s, T) âˆ’ÏƒDM(s, T)||2 ds
(Ïƒ$ resp. ÏƒDM are the volatilities of P $(T) resp. P DM(T))
Consider the following hedge strategy in T-forward contracts:
â€¢ Buy at t : Î¦(d1
t )
Dollar at T
â€¢ Sell at t : âˆ’K Â· Î¦(d2
t )
DM at T
=â‡’Vt(Ï†) = Î¦(d1
t ) Â· !Yt âˆ’K Â· Î¦(d2
t ) DM at T
=â‡’VT (Ï†) =

$T âˆ’K for $T = !Y > K
0
for $T â‰¤K

= HT
Hence the strategy Ï† duplicates the contingent claim HT .
Exercise: Show that the strategy Ï† is self-ï¬nancing.
Hint: Consider the function F(x, t) = x Â· Î¦(d1(x, t)) âˆ’K Â· Î¦(d2(x, t))
where d1,2(x, t) = ln(x/K)
Î·t
Â± 1
2 Î·t
with
Î·2
t =
T

t
||ÏƒX(s)||2 ds.
1) Show x Â· Ï•(d1) = K Â· Ï•(d2) where Ï•(z) =
1
âˆš
2Ï€ eâˆ’1
2 z2
(density of Î¦)

94
4 Application to Financial Economics
2) Using the relation 1) show Fx(x, t) = Î¦(d1(x, t))
3) Show Ft(x, t) = x Â· Ï•(d1) Â· d
dt Î·(t)
4) Show d
dt Î·(t) = âˆ’1
2Î· Â· ||ÏƒX(t)||2
5) Show Ft + 1
2 Fxx x2 ||ÏƒX(t)||2 = 0
=â‡’Vt(Ï†) = F(!Yt, t) is self-ï¬nancing (see Sect. 2.5 (15) and Rem. 2.11)
=â‡’dVt(Ï†) = Î¦(d1
t ) d!Yt

5
Term Structure Models
Term structure models are considered as one of the most complex and
mathematically demanding subjects in ï¬nance. Contrary to the valu-
ation of options, or more generally of contingent claims, the valuation
of interest rate dependent instruments requires the study of many in-
teracting markets, the so-called â€œterm structureâ€ of interest rates.
One of the ï¬rst term structure models was the short-rate model of Va-
sicek (1977). By modelling the â€œshort rateâ€ over time, the dynamics of
the â€œforward rateâ€ is also implicitly determined. A drawback of short-
rate models is that they cannot be ï¬tted to the total term structure
(they only catch the ï¬rst point of the â€œyield curveâ€). This shortcoming
was ï¬rst overcome by the Ho-Lee model (see Ho-Lee (1986)), which
starts with the present term structure as given by the zerobond prices.
Both models are sketched in Sect. 5.4 as special HJM models.
A fundamental contribution was made by Heath-Jarrow-Morton (1992),
who start by modelling the complete term structure as given by the
(continuously compounded) forward rates. Most implementations of
the HJM model are â€œGaussianâ€, meaning that the forward rates are
assumed to be normally distributed. But this implies that interest rates
may become negative, a rather undesirable property. This problem
was overcome by the â€œlog-normalâ€ models. However, assuming that
continuously compounded interest rates are log-normally distributed
led to new diï¬ƒculties: the rates explode over time and thus these
models (see Black-Derman-Toy (1990) or Black-Karasinski (1991))
are unstable. This problem was solved by the (discrete) log-normal
Sandmann-Sondermann model (see Sandmann-Sondermann (1993)).
By switching from continuously compounded to â€œeï¬€ectiveâ€, i.e., an-

96
5 Term Structure Models
nually compounded rates, they showed that such models have stable
dynamics, and hence have a stable continuous limit (see Sandmann-
Sondermann (1994)). This approach ï¬nally led to the so-called â€œLI-
BORâ€ or â€œMarketâ€ models due to Sandmann-Sondermann-Miltersen
(1995) and Miltersen-Sandmann-Sondermann (1997), and further de-
veloped by Brace-Gatarek-Musiela (1997). These models have be-
come quite popular in the ï¬nance industry, since they are stable and
arbitrage-free, produce non-negative interest rates and, most impor-
tantly, reï¬‚ect the market practice of Blackâ€™s caplet formula (see Sect.
5.5 and 5.6).
For a comprehensive treatment of Fixed Income Markets and term
structure models we refer to Musiela-Rutkowski (1997), who also give a
detailed overview of the historical development of this complex subject.
By looking at a term structure model in continuous time in the gen-
eral form of Heath-Jarrow-Morton (1992) as an inï¬nite collection of
assets (the zerobonds of diï¬€erent maturities), the methods developed
in Chap. 4 can be applied without modiï¬cation to this situation. Read-
ers who have gone through the original articles of HJM may appreciate
the simplicity of this approach, which leads to the basic results of HJM
in a straightforward way. The same applies to the Libor Market Model
treated in Sect. 5.5 .
5.1 Diï¬€erent Descriptions of the Term Structure of
Interest Rates
There are three equivalent descriptions of the term structure, namely
by means of
1) Zerobonds
P(t, T) = price of one Euro, deliverable at T, at time t
2) yields (continuously compounded)
y(t, T) := âˆ’
1
T âˆ’t log P(t, T)

5.1 Diï¬€erent Descriptions of the Term Structure of Interest Rates
97
3) forward rates (continuously compounded)
f(t, T) := âˆ’âˆ‚
âˆ‚T log P(t, T).
Relations between 1), 2) and 3) :
1) =â‡’2) + 3) by deï¬nition
2) =â‡’P(t, T) = exp{âˆ’y(t, T) (T âˆ’t)}
f(t, T) = y(t, T) + (T âˆ’t) âˆ‚
âˆ‚T y(t, T)
(1)
3) =â‡’P(t, T) = exp

âˆ’
T

t
f(t, u) du

y(t, T) =
1
T âˆ’t
T

t
f(t, u) du.
Hence the term structure up to time T âˆ—is completely described by any
of the following families:
(i)

P(t, T) | 0 â‰¤T â‰¤T âˆ—, 0 â‰¤t â‰¤T

(ii)

y(t, T) | 0 â‰¤T â‰¤T âˆ—, 0 â‰¤t â‰¤T

(iii)

f(t, T) | 0 â‰¤T â‰¤T âˆ—, 0 â‰¤t â‰¤T

.
For ï¬xed t, T âˆ’â†’P(t, T) , t â‰¤T â‰¤T âˆ—is a (smooth) curve of bond
prices at t with diï¬€erent maturities.
For ï¬xed T, t âˆ’â†’P(t, T) is the (stochastic) price process of a bond
maturing at T.
This is illustrated in the diagrams of Fig. 5.1 on page 98.

98
5 Term Structure Models
1
P(0,T)
T*
0
T
P(t,T*)
T*
0
1
t
Bond prices now (t = 0)
Price of a bond maturing at T âˆ—
Similar for y(t, T)
T*
y(0,T)
T*
y(t,T*)
yield rates now (t = 0)
yields rates maturing at T âˆ—
and for f(t, T)
T*
f(0,T)
T*
f(t,T*)
forward rates now (t = 0)
forward rates maturing at T âˆ—
Fig. 5.1. Diï¬€erent descriptions of the Term Structure

5.2 Stochastics of the Term Structure
99
From (1) it follows
f(t, T)
â›
â
>
=
<
â
â y(t, T) â‡â‡’yield curve is
â›
â
rising
ï¬‚at
falling
â
â 
In particular, the relation (1) implies: the longer the maturity T, the
more sensitive f(t, T) reacts to twists in the yield curve.
Deï¬nition 5.1.1. The instantaneous spot rate is deï¬ned by
r(t) = f(t, t) = âˆ’âˆ‚
âˆ‚T (log P(t, T))T=t.
5.2 Stochastics of the Term Structure
Again we assume that there are d independent stochastic factors mod-
elled by a d-dimensional Brownian motion.
Bt = (B1
t , . . . , Bd
t )
on (â„¦, (Ft)0â‰¤tâ‰¤T âˆ—, P)
satisfying the usual conditions.
For each T â‰¤T âˆ—, consider the â€œassetâ€ XT
t
= P(t, T). As before we
assume that, for any 0 â‰¤T â‰¤T âˆ—,
dP(t, T)
P(t, T) = Âµ(t, T) dt +
Ïƒ(t, T) â—¦dBt



scalar product in IRd
0 â‰¤t â‰¤T
with Âµ(t, T), Ïƒ(t, T) adapted processes, satisfying boundary conditions
as deï¬ned in Sect. 4.1 .
Thus we have a continuum of â€œassetsâ€, whose dynamics are given by
Borel-measurable mappings
Âµ : C Ã— â„¦âˆ’â†’IR
, Ïƒ : C Ã— â„¦âˆ’â†’IRd
with
C =

(t, T) : 0 â‰¤t â‰¤T â‰¤T âˆ—
.

100
5 Term Structure Models
Assumption 5.2.1. (No-arbitrage)
There exists a d-dimensional adapted process Î»(t)0â‰¤tâ‰¤T âˆ—with
E

exp
/1
2
T âˆ—

0
||Î»(s)||2 ds

< âˆ
such that, for all 0 â‰¤t â‰¤T â‰¤T âˆ—
Âµ(t, T) = r(t) + Î»(t) â—¦Ïƒ(t, T)
= r(t) +
d

i=1
Î»i(t) Ïƒi(t, T).
Remark 5.1.
(1) As shown in Sect. 4.1, no arbitrage implies that the risk price pro-
cess is the same for all â€œassetsâ€, i.e. does not depend on the maturity
T.
(2) Since there is now a continuum of assets, but only d factors, NA
imposes restrictions on the drift terms Âµ(t, T) (term structure mod-
els with ï¬nitely many factors are â€œoverâ€-complete).
(3) Î»(t) can be interpreted as a risk premium for long term investments,
since
E

dP(t, T)
P(t, T)
| Ft

= r(t) dt + Î»(t) â—¦Ïƒ(t, T) dt



excess return
.
As before Girsanovâ€™s theorem allows us to eliminate Î»(t) as follows:
Lt := âˆ’
t

0
Î»(s) â—¦dBs
P âˆ—= E(LT âˆ—) P
P âˆ—âˆ¼P on FT âˆ—
Bâˆ—
t = Bt +
t

0
Î»(s) ds
BM under P âˆ—

5.2 Stochastics of the Term Structure
101
=â‡’dP(t, T)
P(t, T) = r(t) dt + Ïƒ(t, T) â—¦dBâˆ—
t
0 â‰¤t â‰¤T â‰¤T âˆ—
=â‡’EP âˆ—

dP(t, T)
P(t, T)
| Ft

= r(t) dt
(Local Expectation Hypothesis).
Again let
Î²(t) = exp

t

0
r(s) ds

be the accumulation factor (rolling over at the spot rate) = spot nu-
meraire.
As in Chap. 4 it follows, that the discounted price processes are mar-
tingales under P âˆ—, i.e.
Ë†P(t, T) = P(t, T)
Î²(t)
has dynamics
d Ë†P(t, T)
Ë†P(t, T)
= Ïƒ(t, T) â—¦dBâˆ—
t
âˆ€0 â‰¤t â‰¤T â‰¤T âˆ—.
More generally, for any ItË†o-Process (Zt)0â‰¤tâ‰¤Tâ‰¤T âˆ—on (â„¦, (Ft), P), which
is of the form
dZt
Zt
= ÂµZ(t) dt + ÏƒZ(t) â—¦dBt
we have for Ë†Zt = Zt
Î²t
d Ë†Zt
Ë†Zt
= ÏƒZ(t) â—¦dBâˆ—
t
under P âˆ—
which again implies the Fundamental Pricing Rule:
Zt = Eâˆ—
exp

âˆ’
T

t
r(s) ds

ZT
Ft

= Î²t Eâˆ—[ Ë†ZT | Ft] âˆ€0 â‰¤t â‰¤T â‰¤T âˆ—
In particular, for any contingent claim HT which is FT -measurable (and
thus may depend on the whole term structure up to time T), we have :

102
5 Term Structure Models
Ht = Î²t Eâˆ—
HT
Î²T
Ft

= P(t, T) ET [HT |Ft],
where ET is the expectation w.r.t. the forward measure
PT = Eâˆ—[(Î²T P(0, T))âˆ’1 | Ft] P âˆ—
on Ft
i.e. PT is the martingale measure with P(t, T) as numeraire (see Sect.
4.8).
5.3 The HJM-Model
We have completely described the term structure by taking the zero-
bonds as building blocks. As we have seen all results, as derived in
Chap. 4 for asset prices and their derivatives, carry over to describe
the stochastic nature of the term structure. However, the term struc-
ture is usually described by interest rates instead of bond prices, e.g.
by the movements of the yield curve or the forward rate curve.
Therefore HJM start with modelling the dynamics of the forward rates
f(t, T) and assume that
df(t, T) = Î±(t, T) dt +
Ï„(t, T) â—¦dBt



scalar product in IRd
0 â‰¤t â‰¤T â‰¤T âˆ—
under the same conditions as in Sect. 5.2. Since the dynamics of the
term structure is already completely described by the dynamics of
P(t, T), all what remains to do is to reveal the implied dynamics for
the forward rates f(t, T).
For the technical conditions on the processes Î± and Ï„ needed for a
mathematical rigorous derivation of the HJM-model (in particular con-
ditions allowing the change of stochastic diï¬€erentiation and integration)
we refer to Heath-Jarrow-Morton (1992).
Again, since there is a continuum of rates but only ï¬nitely many fac-
tors, the drift terms Î±(t, T) must satisfy certain restrictions for the
model to be consistent.

5.3 The HJM-Model
103
Theorem 5.3.1. No arbitrage implies the existence of an adapted pro-
cess Î»(t) such that, for any 0 â‰¤t â‰¤T â‰¤T âˆ—,
Î±(t, T) = Ï„(t, T) â—¦(Î»(t) âˆ’Ïƒ(t, T))
(2)
where
Ïƒ(t, T) = âˆ’
T

t
Ï„(t, u) du.
Proof. We have the following relations between f(t, T) and P(t, T):
ln P(t, T) = âˆ’
T

t
f(t, u) du
f(t, T) = âˆ’âˆ‚
âˆ‚T ln P(t, T).
No arbitrage (see Sect. 4.1 and 5.2) implies the existence of a risk price
process Î»(t), which is independent of T, with
E

dP(t, T)
P(t, T) |Ft

= r(t) dt + Î»(t) â—¦Ïƒ(t, T) dt
where Ïƒ(t, T) is the volatility of P(t, T). By ItË†o
d ln P(t, T) = dP(t, T)
P(t, T) âˆ’1
2
1
P(t, T)2 dâŸ¨P(t, T)âŸ©t
=

r(t) + Î»(t) â—¦Ïƒ(t, T) âˆ’1
2||Ïƒ(t, T)||2
dt + Ïƒ(t, T) â—¦dBt.
The crucial step now is that the HJM conditions allow changing dif-
ferentials. In doing so it follows:
df(t, T) = âˆ’âˆ‚
âˆ‚T d ln P(t, T)
= âˆ’

Î»(t) âˆ‚
âˆ‚T Ïƒ(t, T) âˆ’Ïƒ(t, T) âˆ‚
âˆ‚T Ïƒ(t, T)

dt âˆ’âˆ‚
âˆ‚T Ïƒ(t, T)



:=Ï„(t,T)
dBt.
Hence
Î±(t, T) = Î»(t) â—¦Ï„(t, T) âˆ’Ïƒ(t, T) â—¦Ï„(t, T)
and
Ïƒ(t, T) = âˆ’
T

t
Ï„(t, u) du.
âŠ“âŠ”

104
5 Term Structure Models
The relation (2) allows again the elimination of the risk process Î»(t)
(which is the same for f(t, T) and P(t, T)) by Girsanov.
Since we have already done this change of measure from P to P âˆ—for
the bond prices, we can directly derive the dynamics of f(t, T) under
P âˆ—by the same technique as above.
Theorem 5.3.2. (HJM)
Under P âˆ—the dynamics of f(t, T) is
df(t, T) =

Ï„(t, T) â—¦
T

t
Ï„(t, u) du

dt + Ï„(t, T) â—¦dBâˆ—
t .
Proof. Follows from
d ln P(t, T) =

r(t) âˆ’1
2 ||Ïƒ(t, T)||2
dt + Ïƒ(t, T) â—¦dBâˆ—
t
and
Ïƒ(t, T) = âˆ’
T

t
Ï„(t, u) du.
âŠ“âŠ”
Hence forward rates and spot rates under the (spot) martingale mea-
sure P âˆ—are given by
f(t, T) = f(0, T) âˆ’
t

0
Ï„(s, T) â—¦Ïƒ(s, T) ds +
t

0
Ï„(s, T) â—¦dBâˆ—
s
r(t) = f(0, t) âˆ’
t

0
Ï„(s, t) â—¦Ïƒ(s, t) ds +
t

0
Ï„(s, t) â—¦dBâˆ—
s,
where
Ïƒ(s, T) = âˆ’
T

s
Ï„(s, u) du.
Attention: Observe that the volatility Ï„ of the forward rates and the
volatility Ïƒ of the zerobonds have opposite signs, since both depend on
the same Brownian motion. Hence, if forward rates move up, zerobond
prices move down, and vice versa.

5.4 Examples
105
5.4 Examples
Literature: Ho-Lee (1986), Vasicek (1977), Musiela-Rutkowski (1997).
1. Ho-Lee Model
d = 1
Ï„(t, T) = Ï„ > 0
âˆ€t, T
=â‡’df(t, T) = Î±(t, T) + Ï„ dBt
No arbitrage
â‡â‡’
Theorem 5.3.1 Î±(t, T) = Ï„ Î»(t) + Ï„ 2(T âˆ’t) .
Theorem 5.3.2 =â‡’df(t, T) = Ï„ 2(T âˆ’t) dt + Ï„ dBâˆ—
t
f(t, T) = f(0, T) + Ï„ 2
t

0
(T âˆ’s) ds + Ï„ Bâˆ—
t
= f(0, T) + Ï„ 2 t(T âˆ’t
2) + Ï„ Bâˆ—
t
r(t) = f(t, t) = f(0, t) + 1
2 Ï„ 2 t2 + Ï„ Bâˆ—
t .
-
6











T
f(t, T)
f(0, T) â€¢
f(t, Â·)
Ho-Lee turns any (ï¬‚at)
initial
forward
curve
into an upward sloping
curve at t .

106
5 Term Structure Models
Dynamics of P(t, T) of the Ho-Lee model:
dP(t, T)
P(t, T) = r(t) dt + Ïƒ(t, T) dBâˆ—
t
=

f(0, t) + 1
2 Ï„ 2 t2 + Ï„ Bâˆ—
t

dt âˆ’Ï„(T âˆ’t) dBâˆ—
t .
(3)
Proposition 5.4.1.
P(t, T) = P(0, T)
P(0, t) exp

âˆ’1
2 Ï„ 2(T âˆ’t) T t âˆ’Ï„(T âˆ’t) Bâˆ—
t

.
Proof. To show
P(t, T) = P(0, T) eXt
with
Xt =
t

0
f(0, s) ds âˆ’1
2 Ï„ 2(T âˆ’t) T t âˆ’Ï„(T âˆ’t) Bâˆ—
t
is the solution of (3).
ItË†oâ€™s formula implies:
dP(t, T) = P(0, T)

eXtdXt + 1
2 eXtdâŸ¨XâŸ©t

= P(t, T)

dXt + 1
2 dâŸ¨XâŸ©t

dXt = f(0, t) dt âˆ’1
2 Ï„ 2(âˆ’T t + (T âˆ’t) T



(Tâˆ’t)2âˆ’t2
) dt + Ï„ Bâˆ—
t dt âˆ’Ï„(T âˆ’t) dBâˆ—
t
=

f(0, t) + 1
2 Ï„ 2 t2 + Ï„ Bâˆ—
t

dt âˆ’1
2 Ï„ 2(T âˆ’t)2 dt



dâŸ¨XâŸ©t
âˆ’Ï„(T âˆ’t) dBâˆ—
t
=â‡’dP(t, T)
P(t, T) = r(t) dt âˆ’Ï„(T âˆ’t) dBâˆ—
t .
âŠ“âŠ”

5.5 The â€œLIBOR Marketâ€ Model
107
2. Vasicek-Model
d = 1
Ï„(t, T) = Ï„ eâˆ’Î±(Tâˆ’t)
Î±, Ï„ > 0 ï¬xed
=â‡’Ïƒ(t, T) = âˆ’
T

t
Ï„(t, u) du = Ï„
Î±

eâˆ’Î±(Tâˆ’t) âˆ’1

.
HJM âˆ’â†’df(t, T) = âˆ’Ï„(t, T) Ïƒ(t, T) dt + Ï„(t, T) dBâˆ—
t
= Ï„ 2
Î± eâˆ’Î±(Tâˆ’t) 
1 âˆ’eâˆ’Î±(Tâˆ’t)
dt + Ï„ eâˆ’Î±(Tâˆ’t) dBâˆ—
t
= Ï„ eâˆ’Î±(Tâˆ’t) 
âˆ’Ï„
Î± (eâˆ’Î±(Tâˆ’t) âˆ’1) dt + dBâˆ—
t

.
dP(t, T)
P(t, T) = r(t) dt âˆ’Ï„
Î±

1 âˆ’eâˆ’Î±(Tâˆ’t)
dBâˆ—
t
It can be shown (see e.g. Musiela-Rutkowski (1997) Chapt.13) that
the short rate is of the form
dr(t) =

a(t) âˆ’Î± r(t)

dt + Ï„ dBâˆ—
t
(Ornstein-Uhlenbeck process)
5.5 The â€œLIBOR Marketâ€ Model
Literature: see introduction to Chapter 5 .
Starting point are market rates (e.g. LIBOR = â€London Inter-Bank
Oï¬€er Rateâ€).
f(t, T, Î´) = nominal rate at t for period [T, T + Î´], Î´ > 0
Î´ = 0.25 âˆ’â†’f(t, T, Î´) = 3-month forward LIBOR rate
Assumption 5.5.1. (MSS)
df(t, T, Î´)
f(t, T, Î´) = Âµ(t, T) dt + Î³(t, T) â—¦dBt.

108
5 Term Structure Models
Corresponding HJM-Model
dP(t, T) = P(t, T) (r(t) + Ïƒ(t, T) â—¦dBâˆ—(t))
df(t, T, dt) = âˆ’Ï„(t, T) â—¦Ïƒ(t, T) dt + Ï„(t, T) â—¦dBâˆ—(t)
Ïƒ(t, T) = âˆ’
T

t
Ï„(t, u) du.
Switching to the forward measure by choosing P(t, T) as numeraire
(see Sect. 4.8 and 5.2), we get that
Bâˆ—
T (t) = Bâˆ—(t) +
t

0
Ïƒ(s, T) ds
is Brownian motion under the forward measure
PT = E(LT ) P âˆ—
with
LT (t) = âˆ’
t

0
Ïƒ(s, T) â—¦dBâˆ—(s).
The connection between the rates f(t, T, Î´) and P(t, T) is given by the
forward contracts
F(t, T, Î´) := P(t, T + Î´)
P(t, T)
=

1 + Î´ f(t, T, Î´)
âˆ’1
.
Proposition 5.5.2.
dF(t, T, Î´)
F(t, T, Î´) = (Ïƒ(t, T) âˆ’Ïƒ(t, T + Î´)) â—¦dBâˆ—
T (t)
= âˆ’
 T+Î´

T
Ï„(t, u) du

â—¦dBâˆ—
T (t).
Proof. Set X = P(t, T + Î´),
and
Y = P(t, T). Then ItË†o implies
d(XY âˆ’1)
XY âˆ’1
= (ÂµX âˆ’ÂµY + ÏƒY â—¦(ÏƒY âˆ’ÏƒX)) dt + (ÏƒX âˆ’ÏƒY ) â—¦dBâˆ—(t)
=

r(t) âˆ’r(t) + Ïƒ(t, T) â—¦(Ïƒ(t, T) âˆ’Ïƒ(t, T + Î´))

dt
+

Ïƒ(t, T) âˆ’Ïƒ(t, T + Î´)

â—¦dBâˆ—(t)
=

Ïƒ(t, T) âˆ’Ïƒ(t, T + Î´)

â—¦(dBâˆ—(t) + Ïƒ(t, T) dt



dBâˆ—
T (t)
).

5.5 The â€œLIBOR Marketâ€ Model
109
âŠ“âŠ”
Theorem 5.5.3. The relation between the volatilities Î³(t, T) and
Ïƒ(t, T) is given by
Ïƒ(t, T + Î´) = Ïƒ(t, T) +
Î´ f(t, T, Î´)
1 + Î´ f(t, T, Î´) Â· Î³(t, T).
Proof. Since Girsanov does not change volatilities we have from the
MSS-assumption
df(t, T, Î´) = . . . dt + f(t, T, Î´) Â· Î³(t, T) â—¦dBâˆ—(t).
By ItË†o this implies
dF(t, T, Î´) = d(1 + Î´ f)âˆ’1 = âˆ’F 2Î´ df âˆ’1
2 F 3 dâŸ¨fâŸ©.
Hence
dF(t, TÎ´)
F(t, T, Î´) = âˆ’F Î´ f Î³(t, T) â—¦dBâˆ—(t) + . . . dt
= âˆ’
Î´ f
1 + Î´ f Î³(t, T) â—¦dBâˆ—(t) + . . . dt.
By Prop. 5.5.2 we have
dF(t, T, Î´)
F(t, T, Î´) = (Ïƒ(t, T) âˆ’Ïƒ(t, T + Î´)) â—¦dBâˆ—
T (t).
Since Girsanov does not change the diï¬€usion coeï¬ƒcients, we get the
result by comparison of volatilities.
âŠ“âŠ”
Remark 5.2. The HJM-volatilities are no longer deterministic (even
if the Î³(t, T) are assumed as deterministic), since they depend on
f(t, T, Î´), i.e.
Ïƒ(t, T + Î´, Ï‰) = Ïƒ(t, T, f(t, T, Î´)(Ï‰)).
Starting with Ïƒ(0, T) = 0 and f(0, T, Î´), T = 0, Î´, 2Î´, . . ., they can be
computed pathwise by a binomial lattice.
Theorem 5.5.4.
df(t, T, Î´)
f(t, T, Î´) = Î³(t, T) â—¦dBâˆ—
T+Î´(t).

110
5 Term Structure Models
Proof.
(1 + Î´ f(t, T, Î´))âˆ’1 = F(t, T, T + Î´) = P(t, T + Î´)
P(t, T)
=â‡’f = 1
Î´

P(t, T)
P(t, T + Î´) âˆ’1

.
Take P(t, T + Î´) as numeraire
=â‡’
P(t, T)
P(t, T + Î´) is a martingale under Bâˆ—
T+Î´
=â‡’
f and df/f are martingales under Bâˆ—
T+Î´
=â‡’
df = f Â· Î³(t, T) â—¦dBâˆ—
T+Î´ .
âŠ“âŠ”
The Market Caplet Formula
A â€œcapletâ€ is deï¬ned as the payoï¬€
C = Î´ (f(T, T, Î´) âˆ’K)+
payable at T + Î´.
By the Fundamental Pricing Rule we have
Ct = Î²t Eâˆ—
 C
Î²T+Î´
Ft

= Î´ P(t, T + Î´) ET+Î´[(f âˆ’K)+|Ft].
Since df
f = Î³(t, T) â—¦dBâˆ—
T+Î´ is a lognormal martingale under PT+Î´,
ET+Î´[(f âˆ’K)+] is the Black-Scholes formula for the call (f âˆ’K)+.
Hence
Ct = Î´ P(t, T + Î´)

f(t, T, Î´) Î¦(d1) âˆ’K Î¦(d2)

d1,2(t) =
1
Î·(t, T)

ln f(t, T, Î´)
K
Â± 1
2Î·2(t, T)

Î·2(t, T) =
T

t
Î³2(s, T) ds .

5.6 Caps, Floors and Swaps
111
For a â€œï¬‚oorletâ€ F = Î´ [Kâˆ’f(t, T, Î´)]+ one obtains by the same method:
Ft = Î´ P(t, T + Î´)

K Î¦(âˆ’d2) âˆ’f(t, TÎ´) Î¦(âˆ’d1)

.
5.6 Caps, Floors and Swaps
Consider a sequence T = {T0 < T1 < . . . < Tn} of payment dates.
Let L(t, Ti) denote the forward LIBOR rate for [Ti, Ti+1], valid at
t , t â‰¤T0 , (i = 0, . . . , n âˆ’1).
Set Î´i = Ti+1 âˆ’Ti .
E.g.: 3-month LIBOR rates =â‡’Î´i â‰ˆ0.25 (varies with calendar)
Deï¬nition 5.6.1. A cap at cap-rate K on L(t, Ti) is a collection of
caplets of the form
C(K, T ) =

Î´i [Li âˆ’K]+,
i = 0 . . . n âˆ’1

which pays the amount Î´i [L(Ti, Ti) âˆ’K]+ at each Ti+1 (payment in
arrear) resp. P(Ti, Ti+1) Î´i [Li âˆ’K]+ at Ti.
Similarly a ï¬‚oor on L(t, Ti) is given by
F(K, T ) =

Î´i [K âˆ’Li]+,
i = 0 . . . n âˆ’1

.
A swap at rate K is a sequence of payments
Swap (K, T ) =

Î´i (Li âˆ’K),
i = 0 . . . n âˆ’1

at each Ti+1 (arrear swap).
Let Ct(K), Ft(K), St(K) denote the price of these instruments at time
t â‰¤T0.
The relation aâˆ’b = [aâˆ’b]+ âˆ’[bâˆ’a]+ immediately gives the Cap-Floor
relation

112
5 Term Structure Models
Ct(K) = Ft(K) + St(K).
With the preceding result on caplets we obtain
Ct(K) =
nâˆ’1

i=0
Î´i P(t, Ti+1)

L(t, Ti) Î¦(d1(t, Ti)) âˆ’K Î¦(d2(t, Ti))

d1,2(t, Ti) =
1
Î·(t, T)

ln L(t, T)
K
Â± 1
2 Î·2(t, T)

Î·2(t, T) =
T

t
Î³2(s, T) ds.
The price of a (forward) swap at t is given by
St(K) =
nâˆ’1

i=0
Î´i P(t, Ti+1) L(t, Ti) âˆ’
nâˆ’1

i=0
Î´i K P(t, Ti+1)
= P(t, T0) âˆ’

P(t, Tn) +
n

i=1
P(t, Ti) K (Ti âˆ’Tiâˆ’1)



Coupon bond with coupon=K

.
The â€œforward swap rateâ€ K = K(t, T ) is deï¬ned by the equation
St(K) = 0. This gives
K(t, T ) = (P(t, T0) âˆ’P(t, Tn))

n

i=1
Î´iâˆ’1 P(t, Ti)
âˆ’1
.
The â€œswap rateâ€ K(T0, T ) is the rate which assigns a zero price to a
swap starting at T0. Hence
K(T0, T ) = 0 â‡â‡’
n

i=1
P(T0, Ti) K (Ti âˆ’Tiâˆ’1) + P(T0, Tn) = 1
â‡â‡’CB(K, T ) = 1.
I.e. the swap rate is equal to the coupon rate of a coupon bond (with
payment dates T ) quoted at â€œpariâ€.

6
Why Do We Need ItË†o-Calculus in Finance?
As pointed out in Sect. 2.1, ItË†oâ€™s calculus is a necessary extension of
real analysis to cope with functions of unbounded variation. Thus the
question, whether we need stochastic calculus in ï¬nance, is tantamount
to the question: are charts of stock prices, exchange or interest rates,
in reality of unbounded variation? Such functions, like the WeierstraÃŸ
function or a path of the Brownian motion, are pure mathematical
constructs. Nobody can draw the graph of such a function, and even
a computer can only give an approximate picture 1. Why should such
constructs represent what happens on the exchange markets?
The answer is given by contradiction. Let us assume that stock price
movements are in reality of ï¬nite variation. Then clever people could
make huge arbitrage proï¬ts by generating options, which are traded in
the market at high premiums, at almost zero costs. Clearly a contra-
diction to reality!
This chapter requires some deeper results of stochastic analysis, like lo-
cal times and generalized ItË†o formulas, taken from Carr-Jarrow (1990)
and Revuz-Yor (1991). Section 6.4 should be of special interest to
economists, since it presents another view on option pricing by means
of Arrow-Debreu prices for contingent claims.
1 A colleague once made the self-ironic remark: the older you get, the better you
become in drawing paths of the Brownian motion.

114
6 Why Do We Need ItË†o-Calculus in Finance?
6.1 The Buy-Sell-Paradox
Literature: Carr-Jarrow (1990)
Let (Xt) be a security price process in an economy with a non-stochastic
interest rate r(t) and bond price
Pt(T) = exp

âˆ’
T

t
r(s) ds

as numeraire.
=â‡’Ft =
Xt
Pt(T)
T-forward price.
For a call CT = (XT âˆ’K)+ consider the following hedging strategy
Ï†t(Ï‰) = 1{Ft(Ï‰)>K} = 1{Xt(Ï‰)>Pt(T)Â·K}
This strategy is realized as follows: buy one share of the stock when
up-crossing the strike price K, sell it when down-crossing the strike
(see Fig. 6.1).
0
K
Ft
T
Fig. 6.1. Buy-Sell strategy
=â‡’Vt(Ï†) = 1{Ft>K} Â· Ft âˆ’1{Ft>K} Â· K
$ at T
= max{Ft âˆ’K, 0} = [Ft âˆ’K]+
=â‡’VT (Ï†) = [FT âˆ’K]+ = [XT âˆ’K]+ = CT

6.2 Local Times and Generalized ItË†o Formula
115
The hedging strategy Ï† is â€apparentlyâ€ self-ï¬nancing and generates
CT . Thus it follows:
CT
0 = V0(Ï†) = [F0 âˆ’K]+
initial investment in $ deliverable at T
=â‡’C0 = P0(T) Â· V0(Ï†)
  
CT
0
= [X0 âˆ’K Â· P0(T)]+
price in $-today .
Thus for X0 â‰¤K Â· P0(T) =â‡’the option at time t = 0 has price
zero.
This is paradoxical, since also â€œout-of-the-moneyâ€ options have pos-
itive prices. To solve this paradox we need the concept of local times,
which is studied in the next two sections.
6.2 Local Times and Generalized ItË†o Formula
Literature: Revuz-Yor (1991), Chap. 6
Let Bt(Ï‰) be a the path of the (1-dimensional) Brownian motion.
I = [a, b] âŠ‚IR;
Î» Lebesgue measure on IR.
Deï¬nition 6.2.1.
Î“t(I, Ï‰) :=
t

0
1I(Bs(Ï‰)) ds = Î»{s â‰¤t : Bs(Ï‰) âˆˆI}
is called the â€œoccupation time in I till time tâ€
(see Fig. 6.2 on p.116).
For all
(t, Ï‰), Î“t(Â·, Ï‰) deï¬nes a measure on the Borel sets B in IR.
A âˆˆB
Î»(A) = 0 =â‡’Î“t(A) = 0
P-a.s.
=â‡’Î“t(Â·, Ï‰) has density Lt(x, Ï‰) w.r.t. the Lebesgue measure Î», given
by

116
6 Why Do We Need ItË†o-Calculus in Finance?
Lt(x, Ï‰) = lim
Ïµâ†“0
1
2Ïµ Î“t(IÏµ
x, Ï‰) = lim
Ïµâ†“0
1
2Ïµ Î»{s â‰¤t : |Bs(Ï‰) âˆ’x| â‰¤Ïµ}
= â€œlocal time in x till tâ€
where IÏµ
x = [x âˆ’Ïµ, x + Ïµ].
t
I
Fig. 6.2. Occupation time of the path in interval I
Consequence: g : IR âˆ’â†’IR
measurable
=â‡’
t

0
g(Bs(Ï‰)) ds =
âˆ

âˆ’âˆ
g(x) Lt(x, Ï‰) dx.
(1)
Proof. As in Prop. 1.3.1 it suï¬ƒces to consider, for any A Ïµ B, the char-
acteristic function g = 1A
t

0
1A(Bs) ds = Î“t(A, Ï‰) =

IR
1A(x) Â· Lt(x) dx.
âŠ“âŠ”
Generalized ItË†o formula for convex functions
Let F : IR âˆ’â†’IR be a convex function, i.e.,
F(tx + (1 âˆ’t)y) â‰¤t F(x) + (1 âˆ’t) F(y) for 0 â‰¤t â‰¤1
(e.g. F(x) = [x âˆ’a]+).

6.2 Local Times and Generalized ItË†o Formula
117
Convexity =â‡’F is continuous, a.s. diï¬€erentiable, and one has
F â€²
âˆ’(x) = lim
hâ†“0
F(x) âˆ’F(x âˆ’h)
h
,
the left derivative of F, exists âˆ€x
F â€²
âˆ’âˆˆFV =â‡’F â€²
âˆ’deï¬nes a measure Âµ on (IR, B) by
Âµ[a, b) =

[a,b)
dF â€²
âˆ’= F â€²
âˆ’(b) âˆ’F â€²
âˆ’(a).
Notation: Âµ = F â€²â€²
âˆ’Â· Î» (2nd derivative measure of F)
Remark 6.1. F âˆˆC2 =â‡’Âµ = F â€²â€² Â· Î». For one has
b

a
F â€²â€²(x) dx = F â€²
âˆ’(b) âˆ’F â€²
âˆ’(a) =:

[a,b)
Âµ(dx).
For F(x) = [x âˆ’a]+ one has F â€²
âˆ’(x) =

0 x â‰¤a
1 x > a
Thus for g : R âˆ’â†’R it follows

IR
g(x) Âµ(dx) =

IR
g(x) dF â€²
âˆ’(x) = g(a) ,i.e. dF â€²
âˆ’= Î´a Dirac-measure in a.
Theorem 6.2.2. (Generalized ItË†o Formula for convex functions)
Let F : IR âˆ’â†’IR be a convex function. Then one has
F(Bt) = F(B0) +
t

0
F â€²
âˆ’(Bs) dBs + 1
2
âˆ

âˆ’âˆ
Lt(x) Âµ(dx)
where
Âµ = F â€²â€²
âˆ’Â· Î»
(2nd derivative measure of F) .
Remark 6.2. F âˆˆC2 âˆ’â†’F â€²
âˆ’= F â€² , Âµ(dx) = F â€²â€²(x) dx
âˆ

âˆ’âˆ
Lt(x) F â€²â€²(x) dx =
(1)
t

0
F â€²â€²(Bs) ds
=â‡’â€œclassicalâ€ ItË†o formula.

118
6 Why Do We Need ItË†o-Calculus in Finance?
Generalization to Semi-Martingales
Let X be a continuous semimartingale, A âŠ‚IR a Borel set.
Deï¬nition 6.2.3. Î“t(A) =
t

0
1A(Xs)
dâŸ¨XâŸ©s
  
interior clock
is called the â€œoccupation time of X in A till tâ€ .
Clearly Î“t(A) is a continuous process with monotonically increasing
paths.
Proposition 6.2.4. There exits a family of continuous, adapted, mono-
tonically increasing processes (La
t )tâ‰¥0,aâˆˆIR with
La
t = lim
Ïµâ†“0
1
2Ïµ
t

0
1{|Xsâˆ’a|â‰¤Ïµ} dâŸ¨XâŸ©s
and
Î“t(A) =

A
La
t da.
(2)
La
t = La
t (X)(Ï‰) is called the â€œlocal time of X in a till time tâ€ .
The above proposition implies:
(2) =â‡’
t

0
g(Xs) dâŸ¨XâŸ©s =
âˆ

âˆ’âˆ
g(a) La
t da
for any real measurable
function g .
Corollary 6.2.5. g â‰¡1=â‡’
(2)
âŸ¨XâŸ©t =
t

0
dâŸ¨XâŸ©s =
âˆ

âˆ’âˆ
La
t (X) da.
=â‡’X âˆˆFV =â‡’Lt(X) â‰¡0.
Let
UÏµ
t (a, Ï‰)
denote the number of up-crossings by path Xt(Ï‰) of
the interval [a, a + Ïµ] (see Fig.
6.3 on page 119).

6.2 Local Times and Generalized ItË†o Formula
119
t
a
a+e
1
2
Fig. 6.3. U Ïµ
t (a, Ï‰) = # up-crossings from Xt(Ï‰) of the interval [a, a + Ïµ]
Proposition 6.2.6. (El-Karoui)
lim
Ïµâ†“0 2Ïµ UÏµ
t (a, Ï‰) = La
t (Ï‰)
P-a.s.
Consequence: La
t (Ï‰) > 0 =â‡’the path X(Ï‰) crosses the a-line till
time t inï¬nitely often.
Theorem 6.2.7. (ItË†o-Tanaka formula)
Let X be a continuous semimartingale, F a real convex function. Then
one has
F(Xt) = F(X0) +
t

0
F â€²
âˆ’(Xs) dXs + 1
2
âˆ

âˆ’âˆ
La
t (X) F â€²â€²
âˆ’(da)
with F â€²â€²
âˆ’(da) 2nd derivative measure of F (Lebesgue-Stieltjes integral).
Remark 6.3. For F âˆˆC2 it follows
F(Xt) = F(X0) +
t

0
F â€²(Xs) dXs + 1
2

IR
La
t (X) F â€²â€²(a) da



=
(Rem.6.2)
t
0
F â€²â€²(Xs) dâŸ¨XâŸ©s

120
6 Why Do We Need ItË†o-Calculus in Finance?
6.3 Solution of the Buy-Sell-Paradox
g(x) = (xâˆ’K)+ is a convex function. Thus according to the ItË†o-Tanaka
formula :
g(FT ) = (FT âˆ’K)+ = (F0âˆ’K)++
T

0
gâ€²
âˆ’(Fs) dFs



=
T
0
dV (Ï†s)
PT -Mart.
(self-ï¬nancing)
+ 1
2
âˆ

âˆ’âˆ
La
t (F) gâ€²â€²
âˆ’(da)
  
Î´K(da)



= 1
2 LK
T (F)
= lim
Ïµâ†“0 Ïµ Â· UÏµ
T (K)
(transaction costs)
But for a process (Ft) of inï¬nite variation, its local time LK
T becomes
positive, once it crosses the barrier K. Hence the â€œbuy-sellâ€ strategy is
not self-ï¬nancing !
The transaction costs
1
2 LK
T (F), which by Prop. 6.2.6 are equal to
lim
Ïµâ†“0 Ïµ Â· UÏµ
T (K), have a nice interpretation:
Assume that one tries to apply the Buy-Sell strategy in order to hedge
the payoï¬€g(FT ) = (FT âˆ’K)+, i.e., buy the stock at price K when
up-crossing the barrier K, sell it again when down-crossing the barrier.
But you cannot sell it at the same price. You need a so-called â€œcutoutâ€,
you can place only limit orders of the form: buy at K, sell at K âˆ’Îµ for
some Îµ > 0. The smaller you choose Îµ, the more cutouts you will face,
and in the limit the sum of these cutouts is just equal to the transaction
costs (see Fig. 6.4 on p. 121) .
Taking the expectation under the forward measure PT , it follows:
FT âˆˆM(PT ) =â‡’CT
0 = ET [(FT âˆ’K)+] = (F0 âˆ’K)+



IV
+ ET

1
2 LK
T (F)




TV in $tomorrow
=â‡’C0 = P0(T)Â·CT
0 = (X0 âˆ’K Â· P0(T))+



PIV
+ P0(T) ET

1
2 LK
T

in $today



PV of expected local time
Here â€™IVâ€™ stands for â€œinterior valueâ€ and â€™TVâ€™ for â€œtime valueâ€. The
preï¬x â€™Pâ€™ means â€œpresentâ€.

6.4 Arrow-Debreu Prices in Finance
121
0
0.2
0.4
0.6
0.8
1
time
K
K
stock price
Buy
Sell
Buy
Fig. 6.4. Transaction costs caused by â€˜cutoutsâ€˜ Ïµ
Remark 6.4. (Xt) âˆˆFV =â‡’LK
T â‰¡0 =â‡’TV = 0
=â‡’out-of-the money options are worthless
However, this contradicts what we observe on the option markets which
attach a positive time value also to out-of-the-money options. Hence it
follows:
Consequence: =â‡’(Xt) is of inï¬nite variation !
=â‡’ItË†o is a â€™mustâ€™ for Option Pricing
6.4 Arrow-Debreu Prices in Finance
Let Zt = (Xt, Yt)0â‰¤tâ‰¤T be two security price processes with Yt as nu-
meraire.
1) Yt = Î²t = ert
numeraire: $-today
2) Yt = Pt(T) = eâˆ’r(Tâˆ’t)
numeraire: $-tomorrow
3) Yt â‰¡1(â‡â‡’r = 0)
=â‡’$-today â‰¡$-tomorrow

122
6 Why Do We Need ItË†o-Calculus in Finance?
W.l.o.g. we can always assume that 3) holds by using the following
transformations:
!Zt =

!
Xt = Xt
Yt
, 1

;
!H = H
YT
âˆˆFT
contingent claim
!Vt(Ï†) = Vt(Ï†)
Yt
,
!Ht = Eâˆ—[ !H|Ft]
Ht = !Ht Â· Yt
back-transformation.
Consider the following special contingent claim Ht(x) âˆˆFt
Ht(x) = 1{Xtâ‰¤x} =

1 Xt â‰¤x
0 Xt > x
(= Arrow-Debreu security contingent on value of X at time t).
AD-price at t = 0 :
AD(t, x) = Eâˆ—[Ht(x)] = P âˆ—[Xt â‰¤x] = distribution of Xt under P âˆ—.
AD(t, x) has density f(t, x) deï¬ned by f(t, x) = lim
Ïµâ†“0
1
2Ïµ Eâˆ—[1{|Xtâˆ’x|â‰¤Ïµ}],
or
f(t, x) dx = Eâˆ—[1Ix(Xt)]
with Ix = (x âˆ’1
2 dx , x + 1
2 dx)
= density of AD-prices, given Xt = x.
Let C(Xt) be a contingent claim on Xt. According to Prop. 1.3.1
=â‡’Ï€0(Ct) = Eâˆ—[C(Xt)] =
âˆ

âˆ’âˆ
C(x) dP âˆ—
X(x) =
âˆ

âˆ’âˆ
C(x) f(t, x) dx.
Example: C(t, K) = (Xt âˆ’K)+ Call
P(t, K) = (K âˆ’Xt)+ Put
By partial integration one obtains:
Ï€0(C) =
âˆ

K
(x âˆ’K) f(t, x) dx =
âˆ

K
(1 âˆ’AD(t, x)) dx
Ï€0(P) =
K

0
(K âˆ’x) f(t, x) dx =
K

0
AD(t, x) dx.
(3)

6.5 The Time Value of an Option as Expected Local Time
123
Consequence: AD(t, K) =
d
dK Ï€0(P(t, K))
f(t, K) =
âˆ‚2
âˆ‚K2 Ï€0(P(t, K)) =
âˆ‚2
âˆ‚K2 Ï€0(C(t, K)) .
Interpretation of (3): Payoï¬€at t
K

0
Ht(x) dx =
K

0
1{Xtâ‰¤x}dx = Î»{0 â‰¤x â‰¤K : Xt â‰¤x}
=

K âˆ’Xt Xt â‰¤K
0
Xt > K.
Exercise: For the standard Black-Scholes model (Âµ, Ïƒ constant, r = 0)
one has (compare Sect. 2.9 ):
AD(t, x) = 1 âˆ’Î¦(h(t, x)) = Î¦(âˆ’h(t, x)) with density f(t, x) = Ï•(h)
x Ïƒ
âˆš
t ,
where
Î¦(Â·) is the distribution function of N(0, 1), Ï• = Î¦ â€², and
h(t, x) = ln(X0/x)
Ïƒ
âˆš
t
âˆ’1
2 Ïƒ
âˆš
t.
6.5 The Time Value of an Option as Expected Local
Time
As shown in Sect. 6.2, the local time of the process Xt in K till maturity
T is given by
LK
T (Ï‰) = lim
Ïµâ†“0
1
2Ïµ
T

0
1{|Xt(Ï‰)âˆ’K|â‰¤Ïµ} dâŸ¨X(Ï‰)âŸ©t.
Under suitable boundary conditions on ÂµX(t), ÏƒX(t) one may commute
limit and integration to obtain

124
6 Why Do We Need ItË†o-Calculus in Finance?
=â‡’1
2 Eâˆ—[LK
T ] = 1
2 Eâˆ—
T

0
lim
Ïµ
1
2Ïµ 1{|Xtâˆ’K|â‰¤Ïµ} dâŸ¨XâŸ©t

= 1
2
T

0
f(t, K) dâŸ¨XtâŸ©Xt=K
= 1
2 Â· { AD-price of the quadr. variation of X in K till T},
which gives a new interpretation of the time value of an option.
For the standard Black-Scholes model one has:
dâŸ¨XtâŸ©Xt=K = Ïƒ2 K2 dt
and
f(t, K) = Ï•(h(t, K))
K Ïƒ
âˆš
t
(see Exercise in Sect. 6.4). Hence it follows:
=â‡’1
2 Eâˆ—[LT
K] = 1
2 K2 Ïƒ2
T

0
f(t, K) dt = 1
2 K2Ïƒ2
T

0
Ï•(h(t, K))
K Â· Ïƒ
âˆš
t
dt
= 1
2 K Ïƒ
t

0
Ï•(h(t, K)) Â· 1
âˆš
t dt
Hence by ItË†o-Tanaka for CT = (XT âˆ’K)+
C0 = Eâˆ—[(XT âˆ’K)+] = (X0 âˆ’K)+ + 1
2 K Ïƒ
T

0
Ï•(h(t, K)) Â· 1
âˆš
t dt
(alternative BS-formula for forward price Xt = Ft (r = 0))

7
Appendix: ItË†o Calculus Without Probabilities
SÂ´eminaire de ProbabilitÂ´es XV
1979/80
ITO CALCULUS WITHOUT PROBABILITIES
by H. FÂ¨ollmer
The aim of this note is to show that the ItË†o calculus can be devel-
oped â€œpath by pathâ€ in the strict meaning of this term. We will derive
ItË†oâ€™s formula as an exercise in analysis for a class of real functions of
quadratic variation, including the construction of the stochastic inte-
gral

F â€²(Xsâˆ’)dXs, by means of Riemann sums. Only afterwards we
shall speak of probabilities in order to verify that for certain stochas-
tic processes (semimartingales, processes of ï¬nite energy,...) almost all
paths belong to this class.
Let x be a real function on [0, âˆ[ which is right continuous and has left
limits (also called c`adl`ag). We will use the following notation: xt = x(t),
â–³xt = xt âˆ’xtâˆ’, â–³x2
t = (â–³xt)2.
We deï¬ne a subdivision to be any ï¬nite sequence Ï„ = (to, Â· Â· Â· , tk) such
that 0 â‰¤to < Â· Â· Â· < tk < âˆ, and we put tk+1 = âˆand xâˆ= 0. Let
(Ï„n)n=1,2,Â·Â·Â· be a sequence of subdivisions whose meshes converge to 0
on each compact interval. We say that x is of quadratic variation along
(Ï„n) if the discrete measures

126
7 Appendix: ItË†o Calculus Without Probabilities
Î¾n =

tiâˆˆÏ„n
(xti+1 âˆ’xti)2Îµti
(1)
converge weakly to a Radon measure Î¾ on [0, âˆ[ whose atomic part is
given by the quadratic jumps of x:
[x, x]t = [x, x]c
t +

sâ‰¤t
â–³x2
s,
(2)
where [x, x] denotes the distribution function of Î¾ and [x, x]c its con-
tinuous part.
Theorem. Let x be of quadratic variation along (Ï„n) and F a function
of class C2 on IR. Then the ItË†o formula
F(xt) = F(xo) +
t

0
F(xsâˆ’)dxs + 1
2

]0,t]
F
â€²â€²(xsâˆ’)d[x, x]s
(3)
+

sâ‰¤t
[F(xs) âˆ’F(xsâˆ’) âˆ’F â€²(xsâˆ’)â–³xs âˆ’1
2F
â€²â€²(xsâˆ’)â–³x2
s],
holds with
t

0
F â€²(xsâˆ’)dxs = lim
n

Ï„nâˆ‹tiâ‰¤t
F â€²(xti)(xti+1 âˆ’xti),
(4)
and the series in (4) is absolutely convergent.
Remark. Due to (2) the last two terms of (3) can be written as
1
2
t

0
F
â€²â€²(xsâˆ’)d[x, x]c
s +

sâ‰¤t
[F(xs) âˆ’F(xsâˆ’) âˆ’F â€²(xsâˆ’)â–³xs],
(5)
and we have
t

0
F
â€²â€²(xsâˆ’)d[x, x]c
s =
t

0
F
â€²â€²(xs)d[x, x]c
s,
(6)

7 Appendix: ItË†o Calculus Without Probabilities
127
since x is a c`adl`ag function.
Proof. Let t > 0. Since x is right continuous we have
F(xt) âˆ’F(xo) = lim
n

Ï„nâˆ‹tiâ‰¤t
[F(xti+1) âˆ’F(xti)].
1) For the sake of clarity we ï¬rst treat the particularly simple case
where x is a continuous function. Taylorâ€™s formula can be written
as

Ï„nâˆ‹tiâ‰¤t
[F(xti+1) âˆ’F(xti)] =

F â€²(xti)(xti+1 âˆ’xti)
+ 1
2

F
â€²â€²(xti)(xti+1 âˆ’xti)2 +

r(xti, xti+1),
where
r(a, b) â‰¤Ï•(|b âˆ’a|)(b âˆ’a)2,
(7)
and where Ï•(Â·) is an increasing function on [0, âˆ[ such that Ï•(c) â†’
0 for c â†’0Â·. For n â†‘âˆthe second sum of the right hand side
converges to
1
2

[0,t]
F
â€²â€²(xs)d[x, x]s = 1
2

]0,t]
F
â€²â€²(xsâˆ’)d[x, x]s
due to the weak convergence of the discrete measures (Î¾n); note that
by (2) the continuity of x implies the continuity of [x, x]. The third
sum, which is dominated by
Ï•( max
Ï„nâˆ‹tiâ‰¤t |xti+1 âˆ’xti|)

Ï„nâˆ‹tiâ‰¤t
(xti+1 âˆ’xti)2,
converges to 0 since x is continuous. Thus one obtains the existence
of the limit (4) and ItË†oâ€™s formula (3).

128
7 Appendix: ItË†o Calculus Without Probabilities
2) Consider now the general case. Let Îµ > 0. We divide the jumps of
x on [0, t] into two classes: a ï¬nite class C1 = C1(Îµ, t), and a class
C2 = C2(Îµ, t) such that

sâˆˆC2
â–³x2
s â‰¤Îµ2. Let us write

Ï„nâˆ‹tiâ‰¤t
[F(xti+1)âˆ’F(xti)] =

1[F(xti+1âˆ’F(xti)]+

2[F(xti+1âˆ’F(xti)]
where 
1 indicates the summation over those ti âˆˆÏ„n with ti â‰¤t
for which the interval ]ti, ti+1] contains a jump of class C1. We have
lim
n

1[F(xti+1) âˆ’F(xti)] =

sâˆˆC1
[F(xs) âˆ’F(xsâˆ’)].
On the other hand, Taylorâ€™s formula allows us to write

2[F(xti+1) âˆ’F(xti)] =

Ï„nâˆ‹tiâ‰¤t
F â€²(xti)(xti+1 âˆ’xti) + 1
2

Ï„nâˆ‹tiâ‰¤t
F
â€²â€²(xti)(xti+1 âˆ’xti)2
âˆ’

1[F â€²(xti)(xti+1âˆ’xti)+1
2F
â€²â€²(xti)(xti+1âˆ’xti)2]+

2r(xti, xti+1)
We will show below that the second sum on the right hand side
converges to
1
2

]0,t]
F
â€²â€²(xsâˆ’)[x, x]s,
as n â†‘âˆ; see (9). The third sum converges to

sâˆˆC1
[F â€²(xsâˆ’)â–³xs + 1
2F
â€²â€²(xsâˆ’)â–³x2
s].
Due to the uniform continuity of F
â€²â€² on the bounded set of values
xs (0 â‰¤s â‰¤t) we can assume (7), and this implies
lim sup
n

2r(xti, xti+1) â‰¤Ï•(Îµ+)[x, x]t+.
(8)

7 Appendix: ItË†o Calculus Without Probabilities
129
Let Îµ converge to 0. Then (8) converges to 0, and

sâˆˆC1(Îµ,t)
[F(xs) âˆ’F(xsâˆ’) âˆ’F â€²(xsâˆ’)â–³xs] âˆ’1
2

sâˆˆC1(Îµ,t)
F
â€²â€²(xsâˆ’)â–³x2
s
converges to the series in (3). Furthermore the series converges ab-
solutely since

sâ‰¤t
|F(xs) âˆ’F(xsâˆ’) âˆ’F â€²(xsâˆ’)â–³xs| â‰¤const

sâ‰¤t
â–³x2
s
by Taylorâ€™s formula. Thus we obtain the existence of the limit in (4)
and ItË†oâ€™s formula (3).
3) Let us show that
lim
n

Ï„nâˆ‹tiâ‰¤t
f(xti)(xti+1 âˆ’xti)2 =

]0,t]
f(xsâˆ’)d[x, x]s
(9)
for any continuous function f on IR. Let Îµ > 0, and denote by z the
distribution function of the jumps in class C1 = C1(Îµ, t), i. e.,
zu =

C1âˆ‹sâ‰¤u
â–³xs
(u â‰¥0).
We have
lim
n

Ï„nâˆ‹tiâ‰¤u
f(xti)(zti+1 âˆ’zti)2 =

C1âˆ‹sâ‰¤u
f(xsâˆ’)â–³x2
s
(10)
for each u â‰¥0. Denote by Î¶n and Î·n the discrete measures associated
with z and y = x âˆ’z in the sense of (1). By (10) the measures Î¶n
converge weakly to the discrete measure
Î¶ =

sâˆˆC1
â–³x2
sÎµs.

130
7 Appendix: ItË†o Calculus Without Probabilities
Since the last sum of

Ï„nâˆ‹tiâ‰¤u
(xti+1 âˆ’xti)2 =

(yti+1 âˆ’yti)2 +

(zti+1 âˆ’zti)2
+2

(yti+1 âˆ’yti)(zti+1 âˆ’zti)
converges to 0, the measures Î·n converge weakly to the measure
Î· = Î¾âˆ’Î¶ whose atomic part has total mass â‰¤Îµ2. Hence the function
f â—¦x is almost surely continuous with respect to the continuous part
of Î·, and this implies
lim
n sup|

Ï„nâˆ‹tiâ‰¤t
f(xti)(yti+1âˆ’yti)2âˆ’

]0,t]
f(xsâˆ’)dÎ·|â‰¤2 âˆ¥f âˆ¥t Îµ2
(11)
where âˆ¥f âˆ¥t= sup{f(xs); 0 â‰¤s â‰¤t}. Combining (10) and (11) we
obtain (9), and this completes the proof. Let us emphasize that we
have followed closely the â€œclassical â€ argument; see Meyer [4]. The
only new contribution is the use of weak convergence, which allows
us to give a completely analytic version.
Remarks.
1) Let x = (x1, Â· Â· Â· , xn) be a c`adl`ag function on [0, âˆ[ with values in
IRn. We say that x a is of quadratic variation along (Ï„n) if this holds
for all real functions xi, xi + xj (1 â‰¤i, j â‰¤n) . In this case we put
[xi, xj]t = 1
2([xi + xj, xi + xj]t âˆ’[xi, xi]t âˆ’[xj, xj]t)
= [xi, xj]c
t +

sâ‰¤t
â–³xi
sâ–³xj
s.
Then we have the ItË†o formula
F(xt)=F(xo)+
t

0
DF(xsâˆ’)dxs + 1
2

i,j
t

0
DiDjF(xsâˆ’)d[xi, xj]c
s
+

sâ‰¤t
[F(xs) âˆ’F(xsâˆ’) âˆ’

i
DiF(xsâˆ’)â–³xi
s]
(12)

7 Appendix: ItË†o Calculus Without Probabilities
131
for any function F of class C2 on IRn, where
t

0
DF(xsâˆ’)dxs = lim
n

Ï„nâˆ‹tiâ‰¤t
< DF(xti), xti+1 âˆ’xti >
(13)
(< Â·, Â· >= scalar product on IRn). The proof is the same as above,
but with more cumbersome notation.
2) The class of functions of quadratic variation is stable with respect to
C1 - operations. More precisely, if x = (x1, Â· Â· Â· , xn) is of quadratic
variation along (Ï„n) and F a continuously diï¬€erentiable function on
IRn then y = F â—¦x is of quadratic variation along (Ï„n), with
[y, y]t =

i,j
t

0
DiF(xs)DjF(xs)d[xi, xj]c
s +

sâ‰¤t
â–³y2
s.
(14)
This is the analytic version of a result of Meyer for semimartingales,
see [4] p. 359. The proof is analogous to the previous one.
Let us now turn to stochastic processes. Let (Xt)tâ‰¥0 be a semi-
martingale. Then, for any t â‰¥0, the sums
SÏ„,t =

Ï„âˆ‹tiâ‰¤t
(Xti+1 âˆ’Xti)2
(15)
converge in probability to
[X, X]t =< Xc, Xc >t +

sâ‰¤t
â–³X2
s
when the mesh of the subdivision Ï„ converges to 0 on [0, t]; see Meyer
[4] p. 358. For each sequence there exists thus a subsequence (Ï„n)
such that, almost surely,
lim
n SÏ„n,t = [X, X]t
(16)
for each rational t . This implies that almost all paths are of
quadratic variation along
(Ï„n). Furthermore the relation (16) is
valid for all t â‰¥0 due to (9). The ItË†o formula (3), applied strictly

132
7 Appendix: ItË†o Calculus Without Probabilities
pathwise, does not depend on the sequence (Ï„n). In particular, we
obtain the convergence in probability of the Riemann sums in (4)
to the stochastic integral
t

0
F â€²(Xsâˆ’)dXs,
when the mesh of Ï„ goes to 0 on [0, t].
Remarks.
1) For Brownian motion and an arbitrary sequence of subdivisions (Ï„n)
with mesh tending to 0 on each compact interval, almost all paths
are of quadratic variation along (Ï„n). Indeed, by LÂ´evyâ€™s theorem we
have (16) without passing to subsequences.
2) For the above argument it suï¬ƒces to know that the sums (15)
converge in probability to an increasing process [X, X] which has
paths of the form (2). The class of processes of quadratic varia-
tion is clearly larger than the class of semimartingales: Just con-
sider a deterministic process of quadratic variation which is of un-
bounded variation. Let us mention also the processes of ï¬nite energy
X = M + A where M is a local martingale and A is a process with
paths of quadratic variation 0 along the dyadic subdivisions. These
processes occur in the probabilistic study of Dirichlet spaces: see
Fukushima [3].
3) For a semimartingale it is known how to construct the stochastic
integral

Hsâˆ’dXs (H c`adl`ag and adapted) pathwise as a limit of
Riemann sums, in the sense that the sums converge almost surely
outside an exceptional set which depends on H; see Bichteler [1].
We have just shown that for the particular needs of ItË†o calculus,
where H = f â—¦X (f of class C1), the exceptional set can be chosen
in advance, independently of H. It is possible to go beyond the class
C1 by treating local times â€œpath by pathâ€. But not too far beyond:
Stricker [5] has just shown that an extension to continuous functions
is only possible for processes with paths of ï¬nite variation.

7 Appendix: ItË†o Calculus Without Probabilities
133
References
1) Bichteler, K.: Stochastic Integration and Lp-theory of
semimartingales. Technical report no. 5, U. of Texas (1979).
2) Dellacherie, C., et Meyer, P.A.: ProbabilitÂ´es et Potentiel;
ThÂ´eorie des Martingales. Hermann (1980).
3) Fukushima, M.: Dirichlet forms and Markov processes. North
Holland (1980).
4) Meyer, P.A.: Un cours sur les intÂ´egrales stochastiques. Sem.
Prob. X, LN 511 (1976).
5) Stricker, C.: Quasimartingales et variations. Sem. Prob. XV,
LN 850 (1980).

References
Bauer, H. (1996): Probability Theory. De Gruyter.
(2001): Measure and Integration Theory. De Gruyter.
Black-Derman-Toy (1990): â€œA one-factor model of interest rates and its
application to Treasury bond options,â€ Financ. Analysts Journal, 46(1),
33â€“39.
Black-Karasinski (1991): â€œBond and option pricing when short rates are
lognormal,â€ Financ. Analysts Journal, 47(4), 52â€“59.
Black-Scholes (1973): â€œThe pricing of options and corporate liabilities,â€ J.
Polit. Economy, 81, 637â€“654.
Brace-Gatarek-Musiela (1997): â€œThe Market Model of Interest Rate Dy-
namics,â€ Mathematical Finance, 7, 127â€“154.
Bru, B., and M. Yor (2002): â€œComments on the life and mathematical
legacy of Wolfgang Doeblin,â€ Finance and Stochastics, 6(1), 3â€“47.
Carr-Jarrow (1990): â€œThe Stop-Loss Start-Gain Paradox and Option Val-
uation: A New Decomposition into Intrinsic and Time Value,â€ Review of
Fin. Studies, 3(3).
Cox-Ingersoll-Ross (1981): â€œA re-examination of traditional hypotheses
about the term structure of interest rates,â€ Journal of Finance, 36, 769â€“
799.
Delbaen-Schachermayer (1995): â€œThe No-Arbitrage property under a
change of numeraire,â€ Stochastics Stochastic Rep., 53, 213â€“226.
(1997): â€œThe Banach space of workable contingent claims in arbitrage
theory,â€ Ann. Inst. H.PoincarÂ´e Prob. Statist.
Duffie, D. (2001): Dynamic Asset Pricing Theory. 3rd Ed. Princeton UP.
Elliott-Kopp (1999): Mathematics of Financial Markets. Springer.
Foellmer, H. (1981): â€œCalcul dâ€™ItË†o sans probabilitÂ´e,â€ Seminaire de Proba-
bilitÂ´e XV, Springer Lect. Notes 850, 143â€“150.
(1991): Vorlesungsmanuskript Stochastische Analysis. Ausarbeitung
Mueck.
(1998):
â€œVom
Leibniz-Kalkuel
zur
stochastischen
Analysis,â€
LEOPOLDINA (R.3), 43, 249â€“257.

136
References
Geman-ElKaroui-Rochet (1995): â€œChanges of numeraire, changes of prob-
ability measures and pricing of options,â€ J. Appl. Probability, 32, 443â€“458.
Harrison-Kreps (1979): â€œMartingales and arbitrage in multiperiod securi-
ties markets,â€ Journal of Economic Theory, 20, 381â€“408.
Harrison-Pliska (1981): â€œMartingales and stochastic integrals in the theory
of continuous trading,â€ Stochastic Process. Appl., 11, 215â€“260.
Heath-Jarrow-Morton (1992): â€œBond Pricing and the Term Structure of
Interest Rates,â€ Econometrica, 60, 77â€“105.
Ho-Lee (1986): â€œTerm structure movements and pricing interest rate contin-
gent claims,â€ Journal of Finance, 41, 1011â€“1029.
Ingersoll, J. J. (1987): Theory of Financial Decision Making. Rowman and
Littleï¬eld.
Karatzas-Shreve (1988): Brownian Motion and Stochastic Calculus.
Springer.
(1998): Methods of Mathematical Finance. Springer.
Lamberton-Lapeyre (1995): Introduction to Stochastic Calculus, applied to
Finance. Chapman and Hall, London.
LÂ´evy, P. (1965): Processus stochastiques et Mouvement Brownien, 2nd Ed.
Gauthier-Villars.
McCulloch, J. (1975): â€œOperational Aspects of the Siegel Paradox,â€ Quart.
Journal of Economics, 89, 170â€“172.
Merton, R. (1973): â€œTheory of rational option pricing,â€ Bell J. Econom.
Managm. Sci, 4, 141â€“183.
Miltersen-Sandmann-Sondermann (1997): â€œClosed Form Solutions for
Term Structure Derivatives with Log-Normal Interest Rates,â€ Journal of
Finance, 52, 409â€“430.
Musiela-Rutkowski (1997): Martingale Methods in Financial Modelling.
Springer.
Protter, P. (1990): Stochastic Integration and Diï¬€erential Equations.
Springer.
Revuz-Yor (1991): Continuous Martingales and Brownian Motion. Springer.
Sandmann-Sondermann (1993): â€œA term structure model and the pricing
of interest rate derivatives,â€ Rev. Futures Markets, 12, 391â€“423.
(1994): â€œOn the stability of lognormal interest models and the pricing
of Eurodollar futures,â€ Working paper, University of Bonn.
Sandmann-Sondermann-Miltersen (1995): â€œClosed Form Term Structure
Derivatives in a Heathâ€“Jarrowâ€“Morton Model with Logâ€“normal Annually
Compounded Interest Rates,â€ Research Symposium Proceedings CBOT, pp.
145â€“164.
Shiryaev, A. (1999): Essentials of Stochastic Finance. World Schientiï¬c Sin-
gapore.
Siegel, J. (1972): â€œRisk, interest rates, and forward exchange,â€ Quart. Jour-
nal of Economics, 86, 303â€“309.
Vasicek, O. (1977): â€œAn equilibrium characterisation of the term structure,â€
J. Finan. Econom., 5, 177â€“188.

Lecture Notes in Economics 
and Mathematical Systems
For information about Vols. 1â€“483
please contact your bookseller or Springer-Verlag
Vol. 488: B. Schmolck, Ommitted Variable Tests and
Dynamic Specification. X, 144 pages. 2000.
Vol. 489: T. Steger, Transitional Dynamics and Econom-
ic Growth in Developing Countries. VIII, 151 pages. 2000.
Vol. 490: S. Minner, Strategic Safety Stocks in Supply
Chains. XI, 214 pages. 2000.
Vol. 491: M. Ehrgott, Multicriteria Optimization. VIII, 242
pages. 2000.
Vol. 492: T. Phan Huy, Constraint Propagation in Flexible
Manufacturing. IX, 258 pages. 2000.
Vol. 493: J. Zhu, Modular Pricing of Options. X, 170
pages. 2000.
Vol. 494: D. Franzen, Design of Master Agreements for
OTC Derivatives. VIII, 175 pages. 2001.
Vol. 495: I. Konnov, Combined Relaxation Methods for
Variational Inequalities. XI, 181 pages. 2001.
Vol. 496: P. WeiÃŸ, Unemployment in Open Economies.
XII, 226 pages. 2001.
Vol. 497: J. Inkmann, Conditional Moment Estimation of
Nonlinear Equation Systems. VIII, 214 pages. 2001.
Vol. 498: M. Reutter, A Macroeconomic Model of West
German Unemployment. X, 125 pages. 2001.
Vol. 499: A. Casajus, Focal Points in Framed Games. XI,
131 pages. 2001.
Vol. 500: F. Nardini, Technical Progress and Economic
Growth. XVII, 191 pages. 2001.
Vol. 501: M. Fleischmann, Quantitative Models for
Reverse Logistics. XI, 181 pages. 2001.
Vol. 502: N. Hadjisavvas, J. E. MartÃ­nez-Legaz, J.-P. Penot
(Eds.), Generalized Convexity and Generalized Mono-
tonicity. IX, 410 pages. 2001.
Vol. 503: A. Kirman, J.-B. Zimmermann (Eds.), Econom-
ics with Heterogenous Interacting Agents. VII, 343 pages.
2001.
Vol. 504: P.-Y. Moix (Ed.), The Measurement of Market
Risk. XI, 272 pages. 2001.
Vol. 505: S. VoÃŸ, J. R. Daduna (Eds.), Computer-Aided
Scheduling of Public Transport. XI, 466 pages. 2001.
Vol. 506: B. P. Kellerhals, Financial Pricing Models in
Con-tinuous Time and Kalman Filtering. XIV, 247 pages.
2001.
Vol. 507: M. Koksalan, S. Zionts, Multiple Criteria Deci-
sion Making in the New Millenium. XII, 481 pages. 2001.
Vol. 508: K. Neumann, C. Schwindt, J. Zimmermann,
Project Scheduling with Time Windows and Scarce
Resources. XI, 335 pages. 2002.
Vol. 509: D. Hornung, Investment, R&D, and Long-Run
Growth. XVI, 194 pages. 2002.
Vol. 510: A. S. Tangian, Constructing and Applying
Objective Functions. XII, 582 pages. 2002.
Vol. 511: M. KÃ¼lpmann, Stock Market Overreaction and
Fundamental Valuation. IX, 198 pages. 2002.
Vol. 512: W.-B. Zhang, An Economic Theory of Cities.XI,
220 pages. 2002.
Vol. 513: K. Marti, Stochastic Optimization Techniques.
VIII, 364 pages. 2002.
Vol. 514: S. Wang, Y. Xia, Portfolio and Asset Pricing.
XII, 200 pages. 2002.
Vol. 515: G. Heisig, Planning Stability in Material Require-
ments Planning System. XII, 264 pages. 2002.
Vol. 516: B. Schmid, Pricing Credit Linked Financial
Instruments. X, 246 pages. 2002.
Vol. 517: H. I. Meinhardt, Cooperative Decision Making
in Common Pool Situations. VIII, 205 pages. 2002.
Vol. 518: S. Napel, Bilateral Bargaining. VIII, 188 pages.
2002.
Vol. 519: A. Klose, G. Speranza, L. N. Van Wassenhove
(Eds.), Quantitative Approaches to Distribution Logistics
and Supply Chain Management. XIII, 421 pages. 2002.
Vol. 520: B. Glaser, Efficiency versus Sustainability in
Dynamic Decision Making. IX, 252 pages. 2002.
Vol. 521: R. Cowan, N. Jonard (Eds.), Heterogenous
Agents, Interactions and Economic Performance. XIV, 
339 pages. 2003.
Vol. 522: C. Neff, Corporate Finance, Innovation, and
Strategic Competition. IX, 218 pages. 2003.
Vol. 523: W.-B. Zhang, A Theory of Interregional Dynam-
ics. XI, 231 pages. 2003.
Vol. 524: M. FrÃ¶lich, Programme Evaluation and Treat-
ment Choise. VIII, 191 pages. 2003.
Vol. 525: S. Spinler, Capacity Reservation for Capital-
Intensive Technologies. XVI, 139 pages. 2003.
Vol. 526: C. F. Daganzo, A Theory of Supply Chains. VIII,
123 pages. 2003.
Vol. 527: C. E. Metz, Information Dissemination in
Currency Crises. XI, 231 pages. 2003.
Vol. 528: R. Stolletz, Performance Analysis and Optimiza-
tion of Inbound Call Centers. X, 219 pages. 2003.
Vol. 529: W. Krabs, S. W. Pickl, Analysis, Controllability
and Optimization of Time-Discrete Systems and Dynami-
cal Games. XII, 187 pages. 2003.
Vol. 530: R. Wapler, Unemployment, Market Structure
and Growth. XXVII, 207 pages. 2003.

Vol. 531: M. Gallegati, A. Kirman, M. Marsili (Eds.), The
Complex Dynamics of Economic Interaction. XV, 402
pages, 2004.
Vol. 532: K. Marti, Y. Ermoliev, G. Pflug (Eds.), Dynam-
ic Stochastic Optimization. VIII, 336 pages. 2004.
Vol. 533: G. Dudek, Collaborative Planning in Supply
Chains. X, 234 pages. 2004.
Vol. 534: M. Runkel, Environmental and Resource Poli-
cy for Consumer Durables. X, 197 pages. 2004.
Vol. 535: X. Gandibleux, M. Sevaux, K. SÃ¶rensen, 
V. Tâ€™kindt (Eds.), Metaheuristics for Multiobjective Opti-
misation. IX, 249 pages. 2004.
Vol. 536: R. BrÃ¼ggemann, Model Reduction Methods for
Vector Autoregressive Processes. X, 218 pages. 2004.
Vol. 537: A. Esser, Pricing in (In)Complete Markets. XI,
122 pages, 2004.
Vol. 538: S. Kokot, The Econometrics of Sequential Trade
Models. XI, 193 pages. 2004.
Vol. 539: N. Hautsch, Modelling Irregularly Spaced
Financial Data. XII, 291 pages. 2004.
Vol. 540: H. Kraft, Optimal Portfolios with Stochastic
Interest Rates and Defaultable Assets. X, 173 pages. 2004.
Vol. 541: G.-y. Chen, X. Huang, X. Yang, Vector Optimi-
zation. X, 306 pages. 2005.
Vol. 542: J. Lingens, Union Wage Bargaining and Econom-
ic Growth. XIII, 199 pages. 2004.
Vol. 543: C. Benkert, Default Risk in Bond and Credit
Derivatives Markets. IX, 135 pages. 2004.
Vol. 544: B. Fleischmann, A. Klose, Distribution Logis-
tics. X, 284 pages. 2004.
Vol. 545: R. Hafner, Stochastic Implied Volatility. XI, 229
pages. 2004.
Vol. 546: D. Quadt, Lot-Sizing and Scheduling for Flexi-
ble Flow Lines. XVIII, 227 pages. 2004.
Vol. 547: M. Wildi, Signal Extraction. XI, 279 pages. 
2005.
Vol. 548: D. Kuhn, Generalized Bounds for Convex Multi-
stage Stochastic Programs. XI, 190 pages. 2005.
Vol. 549: G. N. Krieg, Kanban-Controlled Manufacturing
Systems. IX, 236 pages. 2005.
Vol. 550: T. Lux, S. Reitz, E. Samanidou, Nonlinear
Dynamics and Heterogeneous Interacting Agents. XIII,
327 pages. 2005.
Vol. 551: J. Leskow, M. Puchet Anyul, L. F. Punzo, New
Tools of Economic Dynamics. XIX, 392 pages. 2005.
Vol. 552: C. Suerie, Time Continuity in Discrete Time
Models. XVIII, 229 pages. 2005.
Vol. 553: B. MÃ¶nch, Strategic Trading in Illiquid Markets.
XIII, 116 pages. 2005. 
Vol. 554: R. Foellmi, Consumption Structure and Macro-
economics. IX, 152 pages. 2005.
Vol. 555: J. Wenzelburger, Learning in Economic Systems
with Expectations Feedback (planned) 2005.
Vol. 556: R. Branzei, D. Dimitrov, S. Tijs, Models in
Cooperative Game Theory. VIII, 135 pages. 2005.
Vol. 557: S. Barbaro, Equity and Efficiency Considera-
tions of Public Higer Education. XII, 128 pages. 2005.
Vol. 558: M. Faliva, M. G. Zoia, Topics in Dynamic Mod-
el Analysis. X, 144 pages. 2005.
Vol. 559: M. Schulmerich, Real Options Valuation. XVI,
357 pages. 2005.
Vol. 560: A. von Schemde, Index and Stability in Bima-
trix Games. X, 151 pages. 2005.
Vol. 561: H. Bobzin, Principles of Network Economics.
XX, 390 pages. 2006. 
Vol. 562: T. Langenberg, Standardization and Expecta-
tions. IX, 132 pages. 2006.
Vol. 563: A. Seeger (Ed.), Recent Advances in Optimiza-
tion. XI, 455 pages. 2006.
Vol. 564: P. Mathieu, B. Beaufils, O. Brandouy (Eds.),
Artificial Economics. XIII, 237 pages. 2005.
Vol. 565: W. Lemke, Term Structure Modeling and Esti-
mation in a State Space Framework. IX, 224 pages. 2006. 
Vol. 566: M. Genser, A Structural Framework for the
Pricing of Corporate Securities. XIX, 176 pages. 2006.
Vol. 567: A. Namatame, T. Kaizouji, Y. Aruga (Eds.), The
Complex Networks of Economic Interactions. XI, 343
pages. 2006. 
Vol. 568: M. Caliendo, Microeconometric Evaluation of
Labour Market Policies. XVII, 258 pages. 2006.
Vol. 569: L. Neubecker, Strategic Competition in Oligo-
polies with Fluctuating Demand. IX, 233 pages. 2006.
Vol. 570: J. Woo, The Political Economy of Fiscal Policy.
X, 169 pages. 2006. 
Vol. 571: T. Herwig, Market-Conform Valuation of Options.
VIII, 104 pages. 2006.
Vol. 572: M. F. JÃ¤kel, Pensionomics. XII, 316 pages. 
2006
Vol. 573: J. Emami Namini, International Trade and Multi-
national Activity, X, 159 pages, 2006.
Vol. 574: R. Kleber, Dynamic Inventory Management 
in Reverse Logisnes, XII, 181 pages, 2006.
Vol. 575: R. Hellermann, Capacity Options for Revenue
Management, XV, 199 pages, 2006.
Vol. 576: J. Zajac, Economics Dynamics, Information and
Equilibnum, X, 284 pages, 2006.
Vol. 577: K. Rudolph, Bargaining Power Effects in Finan-
cial Contracting, XVIII, 330 pages, 2006.
Vol. 578: J. KÃ¼hn, Optimal Risk-Return Trade-Offs of Com-
mercial Banks, IX, 149 pages, 2006.
Vol. 579: D. Sondermann, Introduction to Stochastic Cal-
culus for Finance, X, 136 pages, 2006.
Vol. 580: S. Seifert, Posted Price Offers in Internet Auc-
tion Markets, IX, 186 pages, 2006.
Vol. 581: K. Marti; Y. Ermoliev; M. Makowsk; G. Pflug
(Eds.), Coping with Uncertainty, XIII, 330 pages, 2006
(planned).

