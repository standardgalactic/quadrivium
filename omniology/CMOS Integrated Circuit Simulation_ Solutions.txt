Erik Bruun
CMOS Integrated Circuit Simulation:
Solutions
Download free books at

2
 
ERIK BRUUN
CMOS INTEGRATED 
CIRCUIT SIMULATION: 
SOLUTIONS  
Download free eBooks at bookboon.com

3
CMOS Integrated Circuit Simulation: Solutions
2nd edition
© 2017 Erik Bruun & bookboon.com
ISBN 978-87-403-1588-2
Peer reviewed by Ivan H.H. Jørgensen, Associate Professor, Technical University of Denmark
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
4
Contents
4
CONTENTS
	
Preface	
5
	
Introduction	
6
	
Tutorial 1 – Resistive Circuits	
9
	
Tutorial 2 – Circuits with Capacitors and Inductors	
23
	
Tutorial 3 – MOS Transistors	
35
	
Tutorial 4 – Basic Gain Stages	
53
	
Tutorial 5 – Hierarchical Design	
81
	
Tutorial 6 – Process and Parameter Variations	
93
	
Tutorial 7 – Importing and Exporting Files	
109
Download free eBooks at bookboon.com
Click on the ad to read more
www.sylvania.com
We do not reinvent  
the wheel we reinvent 
light.
Fascinating lighting offers an infinite spectrum of 
possibilities: Innovative technologies and new  
markets provide both opportunities and challenges. 
An environment in which your expertise is in high 
demand. Enjoy the supportive working atmosphere 
within our global group and benefit from international 
career paths. Implement sustainable ideas in close 
cooperation with other specialists and contribute to 
influencing our future. Come and join us in reinventing 
light every day.
Light is OSRAM

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
5
Preface
Preface
This book contains the end-of-chapter problems for each of the tutorials in the book ‘CMOS Integrated
Circuit Simulation with LTspice’ (2nd Edition, 2016, also published by Bookboon) and provides solutions
to the problems. For each of the problems, corresponding LTspice schematics are shown together with the
simulation outputs resulting from running the simulations speciﬁed in the schematic. Also, the required
interpretation of the simulation results is given.
Often, there is not just one possible way of solving the problems. Several options exist when drawing a
schematic in LTspice and several different simulations may be speciﬁed in order to arrive at a solution,
so the solutions given here should just be taken as examples of how the simulations may be performed.
The problems are reprinted from ‘CMOS Integrated Circuit Simulation with LTspice, 2nd Edition’, and
page and ﬁgure references given in the problems are to pages and ﬁgures from this book. However, for
convenience, several of the ﬁgures referred to in the problems are also shown here. When the problems
refer to the BSIM transistor models from Fig. 3.10 on page 86, Fig. 6.2 on page 193 (or Fig. P3.2 on
page 109 and Fig. P3.3 on page 110), you may turn to the Introduction in the present book to ﬁnd out
how to create the model ﬁle.
The simulations in this book have been performed using LTspice version XVII, dated 10 October 2016.
I hope you ﬁnd the problems and solutions useful. If you ﬁnd typos or errors, I would appreciate
your feedback. Suggestions for improvement are also welcome. You may send them to me by email,
eb@elektro.dtu.dk.
Erik Bruun
Department of Electrical Engineering, Technical University of Denmark.
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
6
Introduction
Introduction
In many of the solutions to the problems, waveform plots are used to ﬁnd values of voltages, currents,
frequencies, etc. The values are found using the cursors activated by a left-click on the name of the trace
appearing above the plot. The cursor position is inserted in the plot by the command ‘Plot Settings →
Notes & Annotations →Label Curs. Pos.’ or keyboard shortcut ‘F4’. When inserted, the position is
given with a large number of digits, typically eight. In most cases, this does not correspond to a relevant
precision, so the position is edited to a reasonable number of digits by an editing of the text appearing in
the text window resulting from a right-click on the label with the cursor position.
The ﬁle ‘
’ is used in several of the problems in this book. It is derived from the ﬁle
‘p35_model_card.inc’ contained in the zip archive ‘p35.zip’ which can be downloaded from (Chan Caru-
sone, Johns & Martin 2014). A few of the parameters in ‘p35_model_card.inc’ are deleted since they are
ignored by LTspice anyway, and the parameters
,
,
,
,
in ‘p35_model_card.inc’ which
depend on process corners are given their nominal values for a typical process. The parameters which are
deleted will not inﬂuence the simulation results signiﬁcantly for normal values of transistor geometries.
Also, the transistor models are named ‘NMOS-BSIM’ and ‘PMOS-BSIM’ rather than just ‘NMOS’ and
‘PMOS’ in order to emphasize that they are BSIM models, not just the default Spice models.
The following page shows the ﬁle ‘p35_model_card.inc’ with the modiﬁcations introduced for the model
ﬁle ‘
’ used in this book.
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
7
Introduction
*p35 model cardBSIM_035.lib
.MODEL NMOS-BSIM NMOS
 LEVEL   =   49
+VERSION
 =   3.1 TNOM    =   27  TOX =   '7.8E-9/proc_delta'
+XJ =   1E-07   NCH =   2.18E+17    VTH0
 =   '0.48+vt_shift'
+K1 =   6.07E-01
  K2  =   1.24E-03    K3  =   9.68E+01
+K3B
  = 
-9.84E+00   W0  =   2.02E-05
 NLX =   1.62E-07
+DVT0W  =   0   DVT1W   =   0   DVT2W   =   0
+DVT0   =   2.87E+00
  DVT1    =   5.86E-01 
 DVT2 
 =   -1.26E-01
+U0 =   '360*proc_delta*proc_delta' UA  =   -8.48E-10   UB  =   2.27E-18
+UC =   3.27E-11
  VSAT 
 =   1.87E+05    A0  =   1.22E+00
+AGS
 =   2.06E-01 
 B0  =   9.60E-07 
 B1  =   4.95E-06
+KETA   =   -1.67E-04   A1  =   0   A2  =   3.49E-01
+RDSW   =   8.18E+02
  PRWG    =   2.35E-02 
 PRWB    =   -8.12E-02
+WR =   9.98E-01
  WINT 
 =   1.55E-07 
 LINT 
 =   4.51E-10
+XL =   -5.00E-08   XW  =   1.50E-07
  DWG =  -4.27E-09
+DWB
 =   4.07E-09 
 VOFF 
 =   -4.14E-02   NFACTOR =   1.61E+00
+CIT
 =   0   CDSC    =   2.39E-04    CDSCD   =   0.00E+00
+CDSCB  =   0   ETA0
  =   1   ETAB    =   -1.99E-01
+DSUB   =   1   PCLM
  =   1.32E+00    PDIBLC1 =   2.42E-04
+PDIBLC2
 =   8.27E-03 
 PDIBLCB =  -9.99E-04   DROUT   =   9.72E-04
+PSCBE1 =   7.24E+08
  PSCBE2  =   9.96E-04 
 PVAG 
 =   1.00E-02
+DELTA  =   1.01E-02
 RSH =   3.33E+00    MOBMOD  =   1
+PRT
 =   0   UTE = 
-1.5    KT1 =   -1.11E-01
+KT1L   =   0   KT2 =   2.22E-02    UA1 =   4.34E-09
+UB1
  = 
-7.56E-18   UC1 =   -5.62E-11   AT  =   3.31E+04
+WL =   0   WLN =   9.95E-01    WW  =   0
+WWN
 =   1.00E+00    WWL =   0   LL  =   0
+LLN
  =   1   LW  =   0   LWN =   1
+LWL
 =   0   CAPMOD  =   2   XPART   =   0.5
+CGDO   =   2.76E-10
 CGSO 
 =   2.76E-10 
 CGBO 
 =   1.00E-12
+CJ =   '9e-4/proc_delta'   PB  =   7.95E-01
 MJ  =   3.53E-01
+CJSW   =   '2.8e-10/proc_delta'    PBSW
 =   7.98E-01   MJSW    =   1.73E-01
+CJSWG  =   1.81E-10
 PBSWG   =   7.96E-01 
 MJSWG   =   1.74E-01
+CF =   0   PVTH0   =   -1.80E-02   PRDSW   =   -7.56E+01
+PK2    =   4.48E-05 
 WKETA   =  -1.33E-03   LKETA   =   -8.91E-03
.MODEL PMOS-BSIM PMOS  
 LEVEL   =   49
+VERSION
 =   3.1 TNOM    =   2.69E+01 
 TOX =   '7.8E-9/proc_delta'
+XJ =   1.00E-07
  NCH =   8.44E+16 
VTH0    =   '-0.6+vt_shift'
+K1 =   4.82E-01
  K2  =   -2.13E-02   K3  =   8.27E+01
+K3B
  = 
-5  W0  =   5.24E-06    NLX =   2.49E-07
+DVT0W  =   0.00E+00
  DVT1W   =   0   DVT2W   =   0
+DVT0   =   3.54E-01
 DVT1 
 =   7.52E-01    DVT2    =
-2.98E-01
+U0 =   '150*proc_delta*proc_delta' UA  =   1E-10   UB  =   1.75E-18
+UC =   -2.27E-11   VSAT    =   2.01E+05
 A0  =   1.04E+00
+AGS
 =   2.90E-01 
 B0  =   1.94E-06 
 B1  =   5.01E-06
+KETA   =   -3.85E-03   A1  =   4.20E-03
  A2  =   1.00E+00
+RDSW   =   4000
 PRWG    = 
-9.54E-02   PRWB
 =   -1.92E-03
+WR =   1   WINT
 =   1.47E-07    LINT 
 =   1.04E-10
+XL =   -4.98E-08   XW  =   1.51E-07
  DWG =  -1.09E-08
+DWB
 =   1.14E-08 
 VOFF 
 =  -1.29E-01   NFACTOR = 
2.01E+00
+CIT
 =   0   CDSC    =   2.40E-04    CDSCD   =   0
+CDSCB  =   0   ETA0
  =   4.07E-02    ETAB 
 =   6.84E-03
+DSUB   =   3.21E-01
  PCLM    =   5.96E+00 
 PDIBLC1 =   2.89E-03
+PDIBLC2
  = 
-1.45E-06   PDIBLCB =   -1E-03  DROUT   =
9.93E-04
+PSCBE1 =   7.88E+10
  PSCBE2  =   5E-10   PVAG 
 =   15
+DELTA  =   9.96E-03
 RSH =   2.6 MOBMOD  =   1
+PRT
 =   0   UTE = 
-1.5    KT1 =   -1.09E-01
+KT1L   =   0   KT2 =   2.19E-02    UA1 =   4.34E-09
+UB1
  = 
-7.62E-18   UC1 =   -5.63E-11   AT  =   3.28E+04
+WL =   0   WLN =   1   WW  =   0
+WWN
 =   1.00E+00    WWL =   0   LL  =   0
+LLN
  =   1   LW  =   0   LWN =   1
+LWL
 =   0   CAPMOD  =   2.01E+00    XPART   =   0.5
+CGDO   =   2.10E-10
 CGSO 
 =   2.12E-10 
 CGBO 
 =   1.00E-12
+CJ =   '14e-4/proc_delta'
PB  =   9.83E-01
 MJ  =   5.79E-01
+CJSW   =   '3.2e-10/proc_delta'    PBSW
 =   9.92E-01   MJSW    =   3.60E-01
+CJSWG  =   4.41E-11
 PBSWG   =   9.85E-01 
 MJSWG   =   3.58E-01
+CF =   0  PVTH0   =   2.58E-02    PRDSW   =   -3.98E+01
+PK2
 =   2.02E-03 
 WKETA   =   2.72E-03 
 LKETA   =   -7.14E-03
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
8
Introduction
For several of the problems for Tutorial 6, the ﬁle ‘
’ is used. This ﬁle is derived from
the ﬁle ‘
’ by introducing the speed parameters ‘
’ and ‘
’ for the process dependent
parameters
,
,
,
,
. The nominal values for typical process parameters are replaced by
the expressions given below.
NMOS transistors:
VTH0
=
{0.48−SN/10}
TOX
=
{7.8E−9/(1+SN/20)}
U0
=
{360∗(1+SN/20)∗∗2}
CJ
=
{9e−4/(1+SN/20)}
CJSW
=
{2.8e−10/(1+SN/20)}
PMOS transistors:
VTH0
=
{−0.6+SP/10}
TOX
=
{7.8E−9/(1+SP/20)}
U0
=
{150∗(1+SP/20)∗∗2}
CJ
=
{14e−4/(1+SP/20)}
CJSW
=
{3.2e−10/(1+SP/20)}
References
Chan Carusone, T., Johns, D. & Martin, K. 2014, Analog Integrated Circuit Design, Netlist and model
ﬁles. Retrieved from http://analogicdesign.com/students/netlists-models/
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
9
Tutorial 1 – Resistive Circuits
Tutorial 1 – Resistive Circuits
1.1
Figure P1.1
For the circuit shown in Fig. P1.1,
ﬁnd the Thévenin voltage Vt and the
Thévenin resistance Rt. A load resis-
tor of RL = 3 kΩis now connected be-
tween the terminals a and b. Find the
power dissipated in RL.
Solution:
For ﬁnding the Thévenin voltage Vt, we run the ‘.op’ simulation shown below.
From the simulation output, we ﬁnd Vt =
= 9 V.
--- Operating Point ---
V(vt): 
 9 
voltage
V(n001): 
 5 
voltage
I(I1): 
 0.001 
 device_current
I(R2): 
 0.0004 
 device_current
I(R1): 
 0.0006 
 device_current
I(V1): 
 0.0004 
 device_current
For ﬁnding the Thévenin resistance Rt, we reset the voltage source and the current source and apply a
current source of 1 A between terminal a and b and ﬁnd the voltage between a and b as shown below.
From the simulation output, we ﬁnd Rt =
/1 A = 6 kΩ.
--- Operating Point ---
V(vt): 
 6000
voltage
V(n001): 
 0 
voltage
I(I2): 
 1 
device_current
I(I1): 
 0 
device_current
I(R2): 
 0.6
device_current
I(R1): 
 0.4
device_current
I(V1): 
 0.6
device_current
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
10
Tutorial 1 – Resistive Circuits
10
For ﬁnding the power dissipated in a load resistor of RL = 3 kΩconnected between the terminals a and
b, we run the ‘.op’ simulation shown below.
From the simulation output, we ﬁnd P =
= 3 V × 0.001 A = 3 mW. By moving the cursor
over
after the simulation, the dissipation can also be read directly in the status bar at the bottom of the
LTspice program window.
--- Operating Point ---
V(vt): 
 3 
voltage
V(n001): 
 5 
voltage
I(I1): 
 0.001 
 device_current
I(Rl): 
 0.001 
 device_current
I(R2):
-0.0002
device_current
I(R1):
0.0002
device_current
I(V1):
-0.0002
device_current
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
360°
thinking.
© Deloitte & Touche LLP and affiliated entities.
Discover the truth at www.deloitte.ca/careers 

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
11
Tutorial 1 – Resistive Circuits
1.2
Figure P1.2
For the circuit shown in Fig. P1.2, de-
termine the value of resistor Rx so that
the current im in the 10 kΩresistor is
30 µA.
Solution:
For this circuit, we run a simulation where Rx is varied over a suitable range, and we plot im versus Rx.
In the schematic below, im =
because
is inserted with just one rotation of the resistor symbol,
causing the positive direction of current ﬂow in
to be from right to left. From the simulation plot, we
ﬁnd that Rx = 3.31 kΩresults in im = 30 µA.
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
12
Tutorial 1 – Resistive Circuits
1.3
Figure P1.3
For the circuit shown in Fig. P1.3, de-
termine the value of the voltages v1 and
v2 and the current ix.
Solution:
For this circuit, we need a current controlled current source. This can be achieved using the arbitrary
controlled current source as shown below. The voltage source
is inserted because the controlling
current must be the current through a voltage source. The current ix is the current through
.
From the output ﬁle, we ﬁnd v1 = 6 V, v2 = 4 V and ix = I(Vs) = 0.4 mA.
--- Operating Point ---
V(v1): 
 6 
voltage
V(v2): 
 4 
voltage
V(v3): 
 4 
voltage
I(B1): 
 0.0002 
 device_current
I(I1): 
 0.001 
 device_current
I(R3): 
 0.0004 
 device_current
I(R2): 
 0.0002 
 device_current
I(R1): 
 0.0006 
 device_current
I(Vs): 
 0.0004 
 device_current
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
13
Tutorial 1 – Resistive Circuits
13
1.4
Figure P1.4
For the circuit shown in Fig. P1.4, ﬁnd
the equivalent resistance looking into
terminals a – b.
Solution:
For this circuit, we need a current controlled voltage source. This can be achieved using the arbitrary
controlled voltage source as shown below. The voltage source
is inserted because the controlling
current must be the current through a voltage source. Additionally, a current source of 1 A is connected
between terminals a and b, and the equivalent resistance is found as the voltage between a and b divided
by 1 A. From the output ﬁle, we ﬁnd Rab =
/1 A = 3.387 kΩ.
--- Operating Point ---
V(va): 
 3387.1 
 voltage
V(n002): 
 161.29 
 voltage
V(n001): 
 3387.1 
 voltage
I(B1): 
 0.290323 
 device_current
I(I1): 
 1 
device_current
I(R3): 
 0.322581 
 device_current
I(R2): 
 0.0322581 
 device_current
I(R1): 
 0.677419 
 device_current
I(V1): 
 0.322581 
 device_current
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
We will turn your CV into 
an opportunity of a lifetime
Do you like cars? Would you like to be a part of a successful brand?
We will appreciate and reward both your enthusiasm and talent.
Send us your CV. You will be surprised where it can take you.
Send us your CV on
www.employerforlife.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
14
Tutorial 1 – Resistive Circuits
1.5
Figure P1.5
For the circuit shown in Fig. P1.5, ﬁnd
the value of the gain Avoc which gives
an output power in RL of 1 W when
the signal voltage vs is 50 mV. With
this value of Avoc, plot the output power
versus the signal voltage vs for vs in the
range from 0 mV to 100 mV.
Also plot the output power versus the
input voltage vin for vs in the range
from 0 mV to 100 mV.
Solution:
For this circuit, we deﬁne Avoc as a parameter and step it over a suitable range when running a ‘.op’
simulation. From a plot of
, we ﬁnd that Avoc = 70 V/V results in a power of 1 W in RL,
see simulation below.
For simulating the output power versus the input voltage, we run a ‘.dc’ simulation with the parameter
set to 70, see simulation below, showing the output power versus vs.
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
15
Tutorial 1 – Resistive Circuits
15
For showing the output power versus vin, we move the cursor in the plot window to the x-axis and apply
a right-click on the mouse. This opens a speciﬁcation window for the x-axis as shown below where we
can change the ‘Quantity Plotted’ from
to
, resulting in a plot of the output power versus vin.
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
AXA Global 
Graduate Program
Find out more and apply

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
16
Tutorial 1 – Resistive Circuits
1.6
Figure P1.6
The circuit shown in Fig. P1.6 is a
transresistance ampliﬁer built from an
inverting voltage ampliﬁer with an in-
put resistance of 10 kΩ, an output resis-
tance of 1 kΩand an open circuit volt-
age gain of −50 V/V and a feedback
resistor with a value of 40 kΩ. Find the
open circuit transresistance Rmoc, the
input resistance Rin and the output re-
sistance Ro of the resulting transresis-
tance ampliﬁer.
Solution:
For ﬁnding the open circuit transresistance Rmoc and the input resistance Rin, we run a ‘.op’ simula-
tion with an input current signal source of 1 A, see below. The input resistance is found as vin/iin =
/1 A, and the transresistance is found as vo/iin =
/1 A.
From the output ﬁle, we ﬁnd Rmoc =
/1 A = −36.28 kΩand Rin =
/1 A = 744 Ω.
--- Operating Point ---
V(vin): 
 744.102 
 voltage
V(vo):
-36279.5
voltage
V(n001): 
-37205.1
voltage
I(Iin): 
1
device_current
I(R2):
0.92559
device_current
I(R3):
-0.92559
device_current
I(R1):
0.0744102
device_current
I(E1):
0.92559
device_current
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
17
Tutorial 1 – Resistive Circuits
17
For ﬁnding the output resistance Ro, we run a ‘.op’ simulation with a current source of 1 A connected to
the output and with the input current source reset. The output resistance is found as
/1 A.
From the output ﬁle, we ﬁnd Ro =
/1 A = 90.7 Ω.
--- Operating Point ---
V(vin): 
 18.1488 
 voltage
V(vo): 
 90.7441 
 voltage
V(n001): 
-907.441
voltage
I(I1):
1
device_current
I(Iin): 
0
device_current
I(R2):
0.998185
device_current
I(R3): 
 0.00181488 
 device_current
I(R1): 
 0.00181488 
 device_current
I(E1): 
 0.998185 
 device_current
An alternative simulation giving both input resistance, output resistance and transresistance in just one
simulation is the ‘.tf’ simulation shown below.
--- Transfer Function ---
Transfer_function:
 -36279.5
transfer
iin#Input_impedance: 
 744.102 
 impedance
output_impedance_at_V(vo): 
 90.7441 
 impedance
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
ibili
because 
e Graduate Programme  
for Engineers and Geoscientists
Month 16
I was a construction
supervisor in 
the North Sea 
advising and 
helping foremen 
solve problems
I was a
he
s
Real work 
International opportunities 

ree work placements
al 
Internationa
or

ree wo
I wanted real responsibili 
 I joined MITAS because 
www.discovermitas.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
18
Tutorial 1 – Resistive Circuits
1.7
Figure P1.7
Figure P1.7 shows a nonlinear trans-
conductance ampliﬁer.
Find the val-
ues of bias voltages and currents for an
input bias voltage (quiescent voltage)
of VIN = 1.0 V. Plot the output voltage
vO for the input voltage in the range
from 0.5 V to 1.8 V. Find the small-
signal voltage gain vo/vin for an input
bias voltage of VIN = 1.0 V and plot the
small-signal voltage gain as a function
of the input bias voltage for the input
bias voltage in the range from 0.5 V to
1.8 V.
Solution:
For ﬁnding the bias voltages and currents, we run a ‘.op’ simulation as shown below.
From the output ﬁle, we ﬁnd ID = I(B1) = 0.125 mA, IC = I(Rc) = 0.417 mA, IL = I(Rl) = 0.292 mA
and VO = V(vo) = 5.83 V.
--- Operating Point ---
V(vdd): 
 10
voltage
V(vo): 
 5.83333 
 voltage
V(vg): 
 1 
voltage
I(B1): 
 0.000125 
 device_current
I(Rl): 
 0.000291667 
 device_current
I(Rc): 
 0.000416667 
 device_current
I(Vin): 
 0 
device_current
I(Vdd): 
-0.000416667  device_current
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
19
Tutorial 1 – Resistive Circuits
For plotting the output voltage and the small-signal voltage gain versus input bias voltage, we run a ‘.dc’
simulation as shown below. The voltage gain is shown as the derivative of the output voltage,
.
The small-signal gain for VIN = 1.0 V may be found from the plot above, or it may be found from a ‘.tf’
simulation as shown below. From this, we ﬁnd a small-signal gain of −3.33 V/V.
--- Transfer Function ---
Transfer_function:
 -3.33333
transfer
vin#Input_impedance: 
 1e+020 
 impedance
output_impedance_at_V(vo): 
 6666.67 
 impedance
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
20
Tutorial 1 – Resistive Circuits
1.8
Figure P1.8
Figure P1.8 shows a series connection
of three resistors and a voltage source.
Try three different ways of drawing the
schematic:
(1): Insert the components and draw
the connections between them.
(2):
Insert the components (includ-
ing the ground symbols) and draw
an unbroken wire (hotkey ‘F3’) from
the leftmost ground symbol across the
components to the rightmost ground
symbol.
(3): Insert the ground symbols, draw an
unbroken wire between them, and then
insert the component directly on top of
the wire.
Observe how LTspice ‘cleans up’ the
wiring.
Find the voltages VA, VB and VC.
Solution:
(1) The ﬁgure below shows the resulting schematic and the output ﬁle for a ‘.op’ simulation. From the
output ﬁle, we ﬁnd VA = 3.0000 V, VB = 2.997 mV and VC = 2.997 nV.
--- Operating Point ---
V(vb): 
 0.00299701 
 voltage
V(va): 
 3 
voltage
V(vc): 
 2.997e-009 
 voltage
I(R3):
-2.997e-006 
 device_current
I(R2):
-2.997e-006 
 device_current
I(R1):
-2.997e-006 
 device_current
I(V1):
-2.997e-006 
 device_current
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
21
Tutorial 1 – Resistive Circuits
21
(2) When inserting the components and drawing a wire across the components, the wire appears across
the components during the insertion process as shown in the ﬁgure below, but when the insertion is com-
pleted, the wiring is cleaned up, resulting in the schematic shown above.
(3) When inserting an unbroken wire ﬁrst and the components afterwards on top of the wire, the cleaning
up takes place when completing the insertion. The ﬁgure below shows the schematic when the voltage
source insertion has been completed and the resistor insertion is in progress.
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
MASTER IN MANAGEMENT
mim.admissions@ie.edu
Follow us on IE MIM Experience
www.ie.edu/master-management
#10 WORLDWIDE
MASTER IN MANAGEMENT 
FINANCIAL TIMES
55 Nationalities
in class
5 Specializations
Personalize your program 
Length: 1O MONTHS
Av. Experience: 1 YEAR
Language: ENGLISH / SPANISH
Format: FULL-TIME
Intakes: SEPT / FEB
• STUDY IN THE CENTER OF MADRID AND TAKE ADVANTAGE OF THE UNIQUE OPPORTUNITIES
  THAT THE CAPITAL OF SPAIN OFFERS
• PROPEL YOUR EDUCATION BY EARNING A DOUBLE DEGREE THAT BEST SUITS YOUR
  PROFESSIONAL GOALS
• STUDY A SEMESTER ABROAD AND BECOME A GLOBAL CITIZEN WITH THE BEYOND BORDERS
  EXPERIENCE
93%
OF MIM STUDENTS ARE
WORKING IN THEIR SECTOR 3 MONTHS
FOLLOWING GRADUATION

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
22
Tutorial 1 – Resistive Circuits
1.9
Figure P1.9
Figure P1.9 shows a simple resistive
circuit with ﬁve resistors where only
three of the resistor values are known.
However, the voltage of node A is VA =
3 V, and the current IS supplied by the
dc voltage source VS is IS = 4.25 mA.
Use LTspice to ﬁnd the values of the
two resistors Rx and Ry.
Solution:
The ﬁgure below shows the LTspice schematic for the circuit with the unknown resistors values Rx and
Ry deﬁned as parameters. When inspecting the schematic, we notice that the current IS depends both on
Rx and Ry whereas VA depends only on Ry. Thus, we can select an arbitrary value for
and step
through a suitable range of values in a ‘.op’ simulation. In the ﬁgure below,
is selected to 1 kΩand
is varied from 1 kΩto 20 kΩin steps of 0.1 kΩ, and from the ‘.op’ simulation, VA is shown versus
Ry. From the plot, we ﬁnd that Ry = 14 kΩresults in VA = 3 V.
Next, we deﬁne
to be 14 kΩand step
from 1 kΩto 20 kΩin steps of 0.1 kΩ, and from the ‘.op’
simulation, we plot IS =
versus Rx. We see that Rx = 5 kΩresults in IS = 4.25 mA.
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
23
Tutorial 2 – Circuits with Capacitors and Inductors
Tutorial 2 – Circuits with Capacitors and Inductors
2.1
Figure P2.1
For the circuit shown in Fig. P2.1, as-
sume that the switch is closed at time
t = 0 and re-opened at time t = 100 ms.
Find the value of the voltage vR2 imme-
diately after the switch is closed. Find
the value of vR2 immediately before the
switch is re-opened. Find the value of
vR2 immediately after the switch is re-
opened. Plot vR2 versus time for 0 ≤
t ≤200 ms. Plot the capacitor voltage
versus time and ﬁnd the time constants
for the charging and discharging of the
capacitor C.
Solution:
The ﬁgure below shows the circuit with a voltage controlled switch, controlled by a voltage
speciﬁed
as a time varying voltage. For the speciﬁcation, we use a ‘
’ waveform with rise time and fall
time of 1 ns which is much shorter than the pulse width of 100 ms. For the voltage controlled switch,
a ‘.model’ speciﬁcation has been inserted, changing the on-resistance from the default value of 1 Ωto
a value of 0.1 Ω. From the ﬁgure, we ﬁnd the value of vR2 immediately after the switch is closed to be
10 V, and we ﬁnd the value of vR2 immediately before the switch is re-opened to be 6.5 V. The value of
vR2 immediately after the switch is re-opened is found to be 0 V.
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
24
Tutorial 2 – Circuits with Capacitors and Inductors
The time constants for charging and discharging of the capacitor may be evaluated from the previous
simulation but an easier, alternative approach is to run transient simulations with only dc voltage sources
and a speciﬁcation of initial voltages for the capacitor.
The ﬁgure below shows a simulation for ﬁnding the charging time constant. As the limiting value of vR2
for t →∞is VS R1/(R1 +R2), it is convenient to select VS = (1+R2/R1)/(1−e−1) = 3.955 V, implying
that a capacitor voltage of 1 V is reached for t = τ. Also, the initial value of the capacitor voltage must
be speciﬁed to 0 V. From the ﬁgure, we ﬁnd τ = 48 ms.
For ﬁnding the time constant for discharging with the switch open, we disconnect VS and specify the
initial value of the capacitor voltage to be e = 2.718 V so that the capacitor voltage reaches a value of
1 V after t = τ, see ﬁgure below. From this simulation, we ﬁnd τ = 80 ms.
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
25
Tutorial 2 – Circuits with Capacitors and Inductors
2.2
Figure P2.2
For the circuit shown in Fig. P2.2, plot
the output voltage vo versus time t for
0 ≤t ≤5 µs. You may assume that the
ampliﬁer has inﬁnite input resistance
and zero output resistance. Also, as-
sume that the initial value of the in-
put and output voltage at t = 0 is 0 V.
Which initial value of the input voltage
vin will result in a mean value of 0 V
for the output voltage vo?
Solution:
The ﬁgure below shows the circuit with the ampliﬁer modeled by a voltage controlled voltage source.
The time varying input current is speciﬁed by a ‘
’ waveform with rise time and fall time of 1 ns
which is much shorter than the pulse width of 1 µs, and with the speciﬁcation shown below, the mean
input current is 0. The initial value of the input voltage is set by the ‘
’ directive.
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
26
Tutorial 2 – Circuits with Capacitors and Inductors
26
From the plot of the resulting output waveform, we ﬁnd a mean value of −250 mV for the output voltage,
so in order to obtain a mean value of 0 V for the output voltage, the initial value of the input voltage must
be changed by −2.5 mV since the gain of the inverting voltage controlled voltage source is 100. Thus,
the required initial value of vin is −2.5 mV as conﬁrmed by the simulation shown below.
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
27
Tutorial 2 – Circuits with Capacitors and Inductors
2.3
Figure P2.3
For the circuit shown in Fig. P2.3,
ﬁnd the midband gain, the upper and
lower half-power (−3 dB) frequencies
and the 3-dB bandwidth. Plot the out-
put voltage Vo versus frequency in a
Bode plot covering a frequency range
which extends from approximately one
decade below the lower half-power fre-
quency to approximately one decade
above the upper half-power frequency.
Solution:
The ﬁgure below shows the circuit and the simulated Bode plot from 100 Hz to 3 MHz. From the Bode
plot, we ﬁnd a midband gain of 38 dB, a lower −3 dB frequency of 1.59 kHz and an upper −3 dB fre-
quency of 199 kHz. The 3-dB bandwidth is 199 kHz −1.59 kHz = 197.41 kHz.
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
28
Tutorial 2 – Circuits with Capacitors and Inductors
2.4
Figure P2.4
For the notch ﬁlter shown in Fig. P2.4,
plot Vo versus frequency in a frequency
range showing the notch and the 3-dB
bandwidth.
Assume L = 1 µH, C =
5 pF and R = 10 kΩ. From the plot,
ﬁnd the notch frequency, the bandwidth
and the quality factor Q.
Solution:
The ﬁgure below shows the circuit and the simulated Bode plot from 69 MHz Hz to 73 MHz. Notice
that a large number of points per octave has been speciﬁed (10000) in order to show the notch. In order
to ﬁnd the frequency range to plot, it may be a good idea to calculate the resonance frequency from
fres = (2π
√
LC)−1 = 71.18 MHz. From the Bode plot, we ﬁnd a notch frequency of 71.2 MHz, a 3-dB
bandwidth of (72.79−69.61) MHz = 3.18 MHz and a quality factor Q = 71.2/3.18 = 22.4.
Analytically, the quality factor is calculated from Q = R

C/L = 22.4.
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
29
Tutorial 2 – Circuits with Capacitors and Inductors
29
2.5
Figure P2.5
The circuit shown in Fig. P2.5 is a
dc-dc converter which converts a dc
voltage of 4 V into a high voltage
VO. The switch is an electronic switch
which opens and closes with a fre-
quency of 5 kHz and a duty cycle of
50%, starting at time t = 0. The diode
can be assumed to be modeled by the
default Shockley diode model.
Ini-
tially, the current in the inductor is 0
and the output voltage VO is 0. Find the
dc output voltage for t →∞and ﬁnd
the time required for VO to reach 90%
of the ﬁnal value.
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
“The perfect start 
of a successful, 
international career.”
CLICK HERE 
to discover why both socially 
and academically the University 
of Groningen is one of the best 
places for a student to be 
www.rug.nl/feb/education
Excellent Economics and Business programmes at:

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
30
Tutorial 2 – Circuits with Capacitors and Inductors
Solution:
The ﬁgure below shows the circuit with a voltage controlled switch controlled by a voltage
speciﬁed
as a time varying voltage. For the speciﬁcation, a ‘
’ waveform with rise time and fall time much
shorter than the pulse width is used. For the diode, no ‘.model’ speciﬁcation is needed for the default
Shockley model. For the voltage controlled switch, a ‘.model’ speciﬁcation has been inserted using the
default switch parameters. If you do not insert the ‘.model’ speciﬁcation, the simulation will still run
with the default switch model but an error message will be produced.
The ﬁgure below shows the simulated output voltage from 0 to 20 ms. From the simulation, we ﬁnd an
output voltage of about 51 V for t →∞and a rise time of about 7.5 ms for reaching 90% of the ﬁnal value.
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
31
Tutorial 2 – Circuits with Capacitors and Inductors
2.6
Figure P2.6
For the circuit shown in Fig. P2.6, as-
sume that the voltage vS is real and has
an ac amplitude of 1. Derive expres-
sions for ﬁnding R1, R2 and C from a
‘.ac’ simulation over a suitable range
of the frequency f, using asymptotic
values for f →0 and f →∞. Verify
your results by simulating the circuit
with R1 = 300 kΩ, R2 = 200 kΩand
C = 2 nF.
Solution:
Assuming that Vs( jω) is real, i.e. Vs( jω) = Vs, we ﬁnd from Fig. P2.6:
Re(i)+ jRe(i) = Vs
 1
R1
+
jωC
1+ jω R2C

= Vs
 1
R1
+ jωC(1−jω R2C)
1+(ω R2C)2

Equating the real parts, we ﬁnd:
Re(i) = Vs
 1
R1
+
R2(ωC)2
1+(ω R2C)2

From this expression, we ﬁnd that for ω →0, Re(i) →Vs/R1, so R1 can be found from a plot of
Vs/Re(i) =
for f →0 and an ac amplitude of 1 for
.
Also from this expression, we ﬁnd that for ω →∞, Re(i) →Vs(1/R1+1/R2), so from a plot ofVs/Re(i) =
for f →∞, we ﬁnd Req = R1 ∥R2, and R2 can be found from R2 = R1 Req/(R1 −Req).
Equating the imaginary parts, we ﬁnd:
Im(i) = Vs

ωC
1+(ω R2C)2

From this expression, we ﬁnd that for ω →0, Im(i) →Vs ωC, so C can be found from a plot of
Im(i)/(ωVs) =
for f →0 and an ac amplitude of 1 for
.
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
32
Tutorial 2 – Circuits with Capacitors and Inductors
32
The LTspice schematic for the circuit is shown below with the speciﬁed values of R1, R2 and C, and also
the plots for ﬁnding R1, R2 and C are shown (using linear y-axes). From the plots, we verify C = 2 nF,
R1 = 300 kΩand Req = 120 kΩ⇒R2 = 120×300 kΩ/(300−120) = 200 kΩ.
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
American online      
LIGS University 
▶▶enroll by September 30th, 2014 and 
▶▶save up to 16% on the tuition!
▶▶pay in 10 installments / 2 years
▶▶Interactive Online education
▶▶visit www.ligsuniversity.com to 
      find out more!
is currently enrolling in the
Interactive Online BBA, MBA, MSc, 
DBA and PhD  programs:
Note: LIGS University is not accredited by any 
nationally recognized accrediting agency listed 
by the US Secretary of Education. 
More info here. 

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
33
Tutorial 2 – Circuits with Capacitors and Inductors
2.7
Figure P2.7
Figure P2.7 shows an inverting am-
pliﬁer similar to the ampliﬁer from
Fig. 2.27 on page 69 but with a ﬁnite
output resistance Ro = 25 kΩfor the
controlled voltage source.
Assuming
that the input impedance has a topology
as shown in Fig. P2.6, ﬁnd the values of
R1, R2 and C in the input impedance.
Solution:
Applying the results from Problem 2.6, we use a ‘.ac’ simulation for ﬁnding the equivalent input impe-
dance. Assuming Zin = R1 ∥(R2+1/( jωC)), we ﬁndC from a plot of
for f →0 with an ac amplitude of 1 for
. From a plot of
(with an amplitude of 1 for
), we ﬁnd R1 for f →0 and Req = R1 ∥R2 for f →∞.
The LTspice schematic and the plots are shown below. From the plots, we ﬁnd C = 170 pF, R1 = 10 kΩ
and Req = 1.05 kΩ⇒R2 = 1.05×10 kΩ/(10−1.05) = 1.17 kΩ.
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
34
Tutorial 2 – Circuits with Capacitors and Inductors
2.8
For the ampliﬁer shown in Fig. P2.7,
use a ‘.ac’ simulation to ﬁnd the output
impedance by resetting the input volt-
age and replacing the load resistor RL
with an ac voltage source. Assume that
the output impedance is a parallel con-
nection of a resistor and a capacitor.
Solution:
In order to ﬁnd the output impedance, we run the ‘.ac’ simulation shown in the LTspice schematic below.
With the output impedance being a parallel connection of a resistor Ro and a capacitor Co, the resistor
is found from ‘
’, compare equation (2.15) on page 65, and the capacitor is
found from ‘
’, compare equation (2.16) on page 66
in ‘CMOS Integrated Circuit Simulation with LTspice’.
From the simulation, we ﬁnd Ro = 25 kΩand Co = 10 pF.
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
35
Tutorial 3 – MOS Transistors
Tutorial 3 – MOS Transistors
3.1
W = 10 µm, L = 1 µm,
Kp = 55 µA/V2, Vto = −0.71 V, λ = 0.16 V−1,
γ = 0.75
√
V, |2ΦF| = 0.7 V.
Figure P3.1
For the PMOS transistor shown in
Fig. P3.1, simulate and plot the in-
put characteristics ID versus VSG and
∂iD/∂vSG for VSD = 0, 0.5, 1.0, 1.5,
2.0, 2.5 and 3.0 V. Use the model
parameters and transistor dimensions
shown in the ﬁgure. Find the bias cur-
rent ID and the small-signal parameters
gm, gmb and gds for the bias point of
VSG = 1.5 V and VSD = 2.0V.
Solution:
The ﬁgure below shows the schematic for simulating the input characteristics. Also shown are the resul-
ting plots of ID versus VSG and ∂iD/∂vSG (or gm) for VSD = 0 V (green curves), 0.5 V (blue curves),
1.0 V (red curves), 1.5 V (cyan curves), 2.0 V (purple curves), 2.5 V (grey curves) and 3.0 V (dark
green curves). You may notice that when the transistor is in the triode region (|VDS| < |VGS| −|Vt|),
gm is independent of VSG, see equation (3.11) in ‘CMOS Integrated Circuit Simulation with LTspice’.
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
36
Tutorial 3 – MOS Transistors
36
For ﬁnding the bias current and the small-signal parameters for a bias point of VSG = 1.5 V and VSD =
2.0 V, we run a ‘.op’ simulation. The bias values and the small-signal parameters are given in the error
log ﬁle (‘Ctrl-L’) from this simulation, see below where the requested parameters are underlined.
Notice that in LTspice, the drain current is deﬁned positive into the transistor, whereas in Fig. P3.1, it is
deﬁned positive out of the transistor.
Semiconductor Device Operating Points:
--- MOSFET Transistors ---
Name:
m1
Model:       pmos-sh
Id:
-2.27e-04
Vgs:
-1.50e+00
Vds:
-2.00e+00
Vbs:
0.00e+00
Vth:
-7.10e-01
Vdsat:
-7.90e-01
Gm:
5.74e-04
Gds:
2.75e-05
Gmb:
2.57e-04
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
37
Tutorial 3 – MOS Transistors
3.2
.MODEL NMOS-BSIM NMOS LEVEL = 49
+VERSION = 3.1 TNOM = 27 TOX = 7.8E-9 
+XJ = 1E-07 NCH = 2.18E+17 VTH0 = 0.48
+K1 = 6.07E-01 K2 = 1.24E-03 K3 = 9.68E+01
+K3B = -9.84E+00 W0 = 2.02E-05 NLX = 1.62E-07
+DVT0W = 0 DVT1W = 0 DVT2W = 0
+DVT0 = 2.87E+00 DVT1 = 5.86E-01 DVT2 = -1.26E-01
+U0 = 360 UA = -8.48E-10 UB = 2.27E-18
+UC = 3.27E-11 VSAT = 1.87E+05 A0 = 1.22E+00
+AGS = 2.06E-01 B0 = 9.60E-07 B1 = 4.95E-06
+KETA = -1.67E-04 A1 = 0 A2 = 3.49E-01
+RDSW = 8.18E+02 PRWG = 2.35E-02 PRWB = -8.12E-02
+WR = 9.98E-01 WINT = 1.55E-07 LINT = 4.51E-10
+DWG = -4.27E-09
+DWB = 4.07E-09 VOFF = -4.14E-02 NFACTOR = 1.61E+00
+CIT = 0 CDSC = 2.39E-04 CDSCD = 0.00E+00
+CDSCB = 0 ETA0 = 1 ETAB = -1.99E-01
+DSUB = 1 PCLM = 1.32E+00 PDIBLC1 = 2.42E-04
+PDIBLC2 = 8.27E-03 PDIBLCB = -9.99E-04 DROUT = 9.72E-04
+PSCBE1 = 7.24E+08 PSCBE2 = 9.96E-04 PVAG = 1.00E-02
+DELTA = 1.01E-02 RSH = 3.33E+00 MOBMOD = 1
+PRT = 0 UTE = -1.5 KT1 = -1.11E-01
+KT1L = 0 KT2 = 2.22E-02 UA1 = 4.34E-09
+UB1 = -7.56E-18 UC1 = -5.62E-11 AT = 3.31E+04
+WL = 0 WLN = 9.95E-01 WW = 0
+WWN = 1.00E+00 WWL = 0 LL = 0
+LLN = 1 LW = 0 LWN = 1
+LWL = 0 CAPMOD = 2 XPART = 0.5
+CGDO = 2.76E-10 CGSO = 2.76E-10 CGBO = 1.00E-12
+CJ = 9e-4 PB = 7.95E-01 MJ = 3.53E-01
+CJSW = 2.8e-10 PBSW = 7.98E-01 MJSW = 1.73E-01
+CJSWG = 1.81E-10 PBSWG = 7.96E-01 MJSWG = 1.74E-01
+CF = 0 PVTH0 = -1.80E-02 PRDSW = -7.56E+01
+PK2 = 4.48E-05 WKETA = -1.33E-03 LKETA = -8.91E-03
Figure P3.2
For an NMOS transistor with the
transistor model shown in Fig. P3.2
(BSIM3 0.35 µm model, Fig. 3.10) and
channel width W = 10 µm, simulate
and plot ID versus the channel length
L in the interval 1 µm < L < 10 µm
for a bias point of VGS = 1.5 V, VDS =
2.0 V and VSB = 0 V. Find the bias cur-
rent ID and the small-signal parameters
gm, gmb and gds for L = 1 µm and for
L = 5 µm in the bias point.
Hint: Deﬁne L as a parameter, compare
page 26.
Solution:
The ﬁgure below shows the schematic for simulating the drain current. The channel length L is deﬁned
as a parameter which is stepped from 1 µm to 10 µm. The transistor model is included in a separate
model ﬁle, ‘
’. The drain current is found from a ‘.op’ simulation.
For ﬁnding the bias current ID and the small-signal parameters gm, gmb and gds for L = 1 µm and for
L = 5 µm in the bias point of VGS = 1.5 V, VDS = 2.0 V and VSB = 0 V, we specify the value of L
using a ‘.param’ directive with the ‘.step param’ directive changed into a comment, see the ﬁgure on the
following page with L = 1 µm.
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
38
Tutorial 3 – MOS Transistors
38
The bias point information is given in the error log ﬁle from a ‘.op’ simulation. The error log ﬁles for
L = 1 µm and L = 5 µm are shown below with an underlining of the requested parameters. We notice
that with the BSIM transistor model, neither the bias current, nor the transconductances (gm and gmb)
scale by a factor of 5 as predicted by the Shichman-Hodges model.
L=1e-6:
Semiconductor Device Operating Points:
--- BSIM3 MOSFETS ---
Name:        m1
Model:    nmos-bsim
Id:        5.48e-04
Vgs:       1.50e+00
Vds:       2.00e+00
Vbs:       0.00e+00
Vth:       5.43e-01
Vdsat:     6.21e-01
Gm:
9.92e-04
Gds:       1.03e-05
Gmb        2.63e-04
L=5e-6:
Semiconductor Device Operating Points:
--- BSIM3 MOSFETS ---
Name:        m1
Model:    nmos-bsim
Id:        1.27e-04
Vgs:       1.50e+00
Vds:       2.00e+00
Vbs:       0.00e+00
Vth:       5.10e-01
Vdsat:     7.45e-01
Gm:
2.45e-04
Gds:       1.94e-06
Gmb        6.53e-05
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
 
  
 
                . 

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
39
Tutorial 3 – MOS Transistors
3.3
.MODEL PMOS-BSIM PMOS LEVEL = 49
+VERSION = 3.1 TNOM = 2.69E+01 TOX = 7.8E-9 
+XJ = 1.00E-07 NCH = 8.44E+16 VTH0 = -0.6
+K1 = 4.82E-01 K2 = -2.13E-02 K3 = 8.27E+01
+K3B = -5 W0 = 5.24E-06 NLX = 2.49E-07
+DVT0W = 0.00E+00 DVT1W = 0 DVT2W = 0
+DVT0 = 3.54E-01 DVT1 = 7.52E-01 DVT2 = -2.98E-01
+U0 = 150 UA = 1E-10 UB = 1.75E-18
+UC = -2.27E-11 VSAT = 2.01E+05 A0 = 1.04E+00
+AGS = 2.90E-01 B0 = 1.94E-06 B1 = 5.01E-06
+KETA = -3.85E-03 A1 = 4.20E-03 A2 = 1.00E+00
+RDSW = 4000 PRWG = -9.54E-02 PRWB = -1.92E-03
+WR = 1 WINT = 1.47E-07 LINT = 1.04E-10
+DWG = -1.09E-08
+DWB = 1.14E-08 VOFF = -1.29E-01 NFACTOR = 2.01E+00
+CIT = 0 CDSC = 2.40E-04 CDSCD = 0
+CDSCB = 0 ETA0 = 4.07E-02 ETAB = 6.84E-03
+DSUB = 3.21E-01 PCLM = 5.96E+00 PDIBLC1 = 2.89E-03
+PDIBLC2 = -1.45E-06 PDIBLCB = -1E-03 DROUT = 9.93E-04
+PSCBE1 = 7.88E+10 PSCBE2 = 5E-10 PVAG = 15
+DELTA = 9.96E-03 RSH = 2.6 MOBMOD = 1
+PRT = 0 UTE = -1.5 KT1 = -1.09E-01
+KT1L = 0 KT2 = 2.19E-02 UA1 = 4.34E-09
+UB1 = -7.62E-18 UC1 = -5.63E-11 AT = 3.28E+04
+WL = 0 WLN = 1 WW = 0
+WWN = 1.00E+00 WWL = 0 LL = 0
+LLN = 1 LW = 0 LWN = 1
+LWL = 0 CAPMOD = 2.01E+00 XPART = 0.5
+CGDO = 2.10E-10 CGSO = 2.12E-10 CGBO = 1.00E-12
+CJ = 14e-4 PB = 9.83E-01 MJ = 5.79E-01
+CJSW = 3.2e-10 PBSW = 9.92E-01 MJSW = 3.60E-01
+CJSWG = 4.41E-11 PBSWG = 9.85E-01 MJSWG = 3.58E-01
+CF = 0 PVTH0 = 2.58E-02 PRDSW = -3.98E+01
+PK2 = 2.02E-03 WKETA = 2.72E-03 LKETA = -7.14E-03
Figure P3.3
For a PMOS transistor with the transis-
tor model shown in Fig. P3.3 (BSIM3
0.35 µm model, Fig. 3.10) and channel
width W = 10 µm and channel length
L = 1 µm, simulate and plot the input
characteristics ID versus VSG for VSD =
0, 0.5, 1.0, 1.5, 2.0, 2.5 and 3.0 V. As-
sume VBS = 0 V. Also simulate and plot
the output characteristics ID versus VSD
for VSG = 0, 0.5, 1.0, 1.5, 2.0, 2.5 and
3.0 V. Use the cursors to ﬁnd ID and
∂iD/∂vSD for VSG = 1.5 V, VBS = 0 V
and VSD = 2.0 V.
Solution:
The ﬁgure below shows the schematic for simulating the input characteristics. Also shown is the resulting
plot of ID versus VSG for VSD = 0 V (green curve), 0.5 V (blue curve), 1.0 V (red curve), 1.5 V (cyan
curve), 2.0 V (purple curve), 2.5 V (grey curve) and 3.0 V (dark green curve). Because of the difference
in sign conventions between textbooks and LTspice, the plot below shows
which is equal to ID
using the normal textbook convention.
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
40
Tutorial 3 – MOS Transistors
The ﬁgure below shows the schematic for simulating the output characteristics. Also shown is the result-
ing plot of ID versus VSD for VSG = 0 V (green curve, not visible because of the blue curve), 0.5 V (blue
curve), 1.0 V (red curve), 1.5 V (cyan curve), 2.0 V (purple curve), 2.5 V (grey curve) and 3.0 V (dark
green curve).
For ﬁnding ID for VSG = 1.5 V, VBS = 0 V and VSD = 2.0 V, the output characteristics above are used with
a cursor placed on the cyan curve, see ﬁgure below. The cursor is shifted from one curve to another by
the up/down arrow keys. We ﬁnd ID = 0.16 mA.
For ﬁnding ∂iD/∂vSD for VSG = 1.5 V, VBS = 0 V and VSD = 2.0 V, the derivative of ID is plotted as shown
below. It may be a good idea to zoom in on the relevant part of the characteristics as also shown in the
ﬁgure. We ﬁnd ∂iD/∂vSD = 7.3 µA/V.
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
41
Tutorial 3 – MOS Transistors
3.4
.MODEL PMOS-BSIM PMOS LEVEL = 49
+VERSION = 3.1 TNOM = 2.69E+01 TOX = 7.8E-9 
+XJ = 1.00E-07 NCH = 8.44E+16 VTH0 = -0.6
+K1 = 4.82E-01 K2 = -2.13E-02 K3 = 8.27E+01
+K3B = -5 W0 = 5.24E-06 NLX = 2.49E-07
+DVT0W = 0.00E+00 DVT1W = 0 DVT2W = 0
+DVT0 = 3.54E-01 DVT1 = 7.52E-01 DVT2 = -2.98E-01
+U0 = 150 UA = 1E-10 UB = 1.75E-18
+UC = -2.27E-11 VSAT = 2.01E+05 A0 = 1.04E+00
+AGS = 2.90E-01 B0 = 1.94E-06 B1 = 5.01E-06
+KETA = -3.85E-03 A1 = 4.20E-03 A2 = 1.00E+00
+RDSW = 4000 PRWG = -9.54E-02 PRWB = -1.92E-03
+WR = 1 WINT = 1.47E-07 LINT = 1.04E-10
+DWG = -1.09E-08
+DWB = 1.14E-08 VOFF = -1.29E-01 NFACTOR = 2.01E+00
+CIT = 0 CDSC = 2.40E-04 CDSCD = 0
+CDSCB = 0 ETA0 = 4.07E-02 ETAB = 6.84E-03
+DSUB = 3.21E-01 PCLM = 5.96E+00 PDIBLC1 = 2.89E-03
+PDIBLC2 = -1.45E-06 PDIBLCB = -1E-03 DROUT = 9.93E-04
+PSCBE1 = 7.88E+10 PSCBE2 = 5E-10 PVAG = 15
+DELTA = 9.96E-03 RSH = 2.6 MOBMOD = 1
+PRT = 0 UTE = -1.5 KT1 = -1.09E-01
+KT1L = 0 KT2 = 2.19E-02 UA1 = 4.34E-09
+UB1 = -7.62E-18 UC1 = -5.63E-11 AT = 3.28E+04
+WL = 0 WLN = 1 WW = 0
+WWN = 1.00E+00 WWL = 0 LL = 0
+LLN = 1 LW = 0 LWN = 1
+LWL = 0 CAPMOD = 2.01E+00 XPART = 0.5
+CGDO = 2.10E-10 CGSO = 2.12E-10 CGBO = 1.00E-12
+CJ = 14e-4 PB = 9.83E-01 MJ = 5.79E-01
+CJSW = 3.2e-10 PBSW = 9.92E-01 MJSW = 3.60E-01
+CJSWG = 4.41E-11 PBSWG = 9.85E-01 MJSWG = 3.58E-01
+CF = 0 PVTH0 = 2.58E-02 PRDSW = -3.98E+01
+PK2 = 2.02E-03 WKETA = 2.72E-03 LKETA = -7.14E-03
Figure P3.4
For a PMOS transistor with the transis-
tor model shown in Fig. P3.4 (BSIM3
0.35 µm model, Fig. 3.10) and channel
width W = 10 µm and channel length
L = 1 µm, ﬁnd the bias current ID and
the small-signal parameters gm, gmb
and gds in a bias point of VSG = 1.5 V,
VBS = 0 V and VSD = 2.0 V. From
these small-signal parameters and the
bias current, estimate parameters for a
Shichman-Hodges model for the tran-
sistor. Assume |2ΦF| = 0.7 V.
Simulate and plot the input character-
istics (ID versus VSG) and output char-
acteristics (ID versus VSD) using both
the BSIM model and the Shichman-
Hodges model with the parameters es-
timated from the simulation of small-
signal parameters in the bias point.
Solution:
The ﬁgure below shows the schematic for simulating the small-signal parameters and the resulting error
log ﬁle with the relevant parameters underlined.
Semiconductor Device Operating Points:
--- BSIM3 MOSFETS ---
Name:        m1
Model:    pmos-bsim
Id:
-1.60e-04
Vgs:
-1.50e+00
Vds:
-2.00e+00
Vbs:       0.00e+00
Vth:
-6.79e-01
Vdsat:
-6.96e-01
Gm:        3.39e-04
Gds:       7.31e-06
Gmb        7.54e-05
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
42
Tutorial 3 – MOS Transistors
42
From the small-signal parameters, the following Shichman-Hodges model parameters are calculated.
Beware of the signs. For a PMOS transistor, the easiest solution is to use numeric values in the equations
(3.12) to (3.15) in ‘CMOS Integrated Circuit Simulation with LTspice’. Remember that the threshold
voltage is negative for a PMOS transistor.
λ
=
gds
|ID|−gds|VDS| = 0.05 V−1
Vto
=
−

|VGS|−2|ID|
gm

= −0.556 V
Kp
=
 gm
|ID|
2 |ID|−gds|VDS|
2(W/L)

= 32.6 µA/V2
|2ΦF|
=
0.7 V
γ
=
2

|2ΦF| gmb
gm
= 1.67 gmb
gm
= 0.37
√
V
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
www.mastersopenday.nl
Visit us and find out why we are the best!
Master’s Open Day: 22 February 2014
Join the best at
the Maastricht University
School of Business and
Economics!
Top master’s programmes
• 33rd place Financial Times worldwide ranking: MSc 
International Business
• 1st place: MSc International Business
• 1st place: MSc Financial Economics
• 2nd place: MSc Management of Learning
• 2nd place: MSc Economics
• 2nd place: MSc Econometrics and Operations Research
• 2nd place: MSc Global Supply Chain Management and 
Change
Sources: Keuzegids Master ranking 2013; Elsevier ‘Beste Studies’ ranking 2012; 
Financial Times Global Masters in Management ranking 2012
Maastricht
University is
the best specialist
university in the
Netherlands
(Elsevier)

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
43
Tutorial 3 – MOS Transistors
For simulating the input characteristics and the output characteristics for both the BSIM3 transistor model
and the Shichman-Hodges transistor model, the schematic shown below is used. The ‘.dc’ command spe-
ciﬁcation shown gives the output characteristics. For the input characteristics, use
as the ﬁrst source
and
as the second source.
The simulations result in the characteristics shown below with the green curves for the BSIM3 model
and the blue curves for the Shichman-Hodges model.
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
44
Tutorial 3 – MOS Transistors
3.5
.MODEL NMOS-BSIM NMOS LEVEL = 49
+VERSION = 3.1 TNOM = 27 TOX = 7.8E-9 
+XJ = 1E-07 NCH = 2.18E+17 VTH0 = 0.48
+K1 = 6.07E-01 K2 = 1.24E-03 K3 = 9.68E+01
+K3B = -9.84E+00 W0 = 2.02E-05 NLX = 1.62E-07
+DVT0W = 0 DVT1W = 0 DVT2W = 0
+DVT0 = 2.87E+00 DVT1 = 5.86E-01 DVT2 = -1.26E-01
+U0 = 360 UA = -8.48E-10 UB = 2.27E-18
+UC = 3.27E-11 VSAT = 1.87E+05 A0 = 1.22E+00
+AGS = 2.06E-01 B0 = 9.60E-07 B1 = 4.95E-06
+KETA = -1.67E-04 A1 = 0 A2 = 3.49E-01
+RDSW = 8.18E+02 PRWG = 2.35E-02 PRWB = -8.12E-02
+WR = 9.98E-01 WINT = 1.55E-07 LINT = 4.51E-10
+DWG = -4.27E-09
+DWB = 4.07E-09 VOFF = -4.14E-02 NFACTOR = 1.61E+00
+CIT = 0 CDSC = 2.39E-04 CDSCD = 0.00E+00
+CDSCB = 0 ETA0 = 1 ETAB = -1.99E-01
+DSUB = 1 PCLM = 1.32E+00 PDIBLC1 = 2.42E-04
+PDIBLC2 = 8.27E-03 PDIBLCB = -9.99E-04 DROUT = 9.72E-04
+PSCBE1 = 7.24E+08 PSCBE2 = 9.96E-04 PVAG = 1.00E-02
+DELTA = 1.01E-02 RSH = 3.33E+00 MOBMOD = 1
+PRT = 0 UTE = -1.5 KT1 = -1.11E-01
+KT1L = 0 KT2 = 2.22E-02 UA1 = 4.34E-09
+UB1 = -7.56E-18 UC1 = -5.62E-11 AT = 3.31E+04
+WL = 0 WLN = 9.95E-01 WW = 0
+WWN = 1.00E+00 WWL = 0 LL = 0
+LLN = 1 LW = 0 LWN = 1
+LWL = 0 CAPMOD = 2 XPART = 0.5
+CGDO = 2.76E-10 CGSO = 2.76E-10 CGBO = 1.00E-12
+CJ = 9e-4 PB = 7.95E-01 MJ = 3.53E-01
+CJSW = 2.8e-10 PBSW = 7.98E-01 MJSW = 1.73E-01
+CJSWG = 1.81E-10 PBSWG = 7.96E-01 MJSWG = 1.74E-01
+CF = 0 PVTH0 = -1.80E-02 PRDSW = -7.56E+01
+PK2 = 4.48E-05 WKETA = -1.33E-03 LKETA = -8.91E-03
Figure P3.5
For an NMOS transistor with the
transistor model shown in Fig. P3.5
(BSIM3 0.35 µm model, Fig. 3.10), a
channel width W = 10 µm and channel
length L = 1 µm, assume a bias point
speciﬁed by VGS = VDS, VSB = 0 V and
ID = 140 µA. Find gm, gmb and gds
from a ‘.op’ simulation and estimate
parameters Kp, Vto, λ and γ for a
Shichman-Hodges model for the tran-
sistor. Assume |2ΦF| = 0.7 V.
Solution:
The ﬁgure below shows the schematic for simulating the small-signal parameters and the resulting error
log ﬁle with the relevant parameters underlined.
Semiconductor Device Operating Points:
--- BSIM3 MOSFETS ---
Name:        m1
Model:    nmos-bsim
Id:        1.40e-04
Vgs:       9.99e-01
Vds:       9.99e-01
Vbs:       0.00e+00
Vth:       5.43e-01
Vdsat:     3.36e-01
Gm:
5.84e-04
Gds:       6.04e-06
Gmb        1.67e-04
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
45
Tutorial 3 – MOS Transistors
45
From the small-signal parameters, the following Shichman-Hodges model parameters are calculated
using equations (3.12) to (3.15) in ‘CMOS Integrated Circuit Simulation with LTspice’.
λ
=
gds
ID −gdsVDS
= 0.045 V−1
Vto
=
VGS −2ID
gm
= 0.520 V
Kp
=
gm
ID
2 ID −gdsVDS
2(W/L)

= 117 µA/V2
|2ΦF|
=
0.7 V
γ
=
2

|2ΦF| gmb
gm
= 1.67 gmb
gm
= 0.48
√
V
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
46
Tutorial 3 – MOS Transistors
3.6
Kp = 190 µA/V2, Vto = 0.57 V, λ = 0.16 V−1,
γ = 0.5
√
V, |2ΦF| = 0.7 V.
Figure P3.6
For an NMOS transistor with the
Shichman-Hodges parameters shown
in Fig. P3.6 and a channel length L =
1 µm, simulate and plot gm and gds ver-
sus the drain current ID for W = 10 µm,
W = 30 µm and W = 50 µm, and 0 <
ID < 10 mA. Assume a drain-source
voltage of VDS = 1.2 V.
From the plots of gm and gds, ﬁnd
the maximum drain current for which
the transistor is in the active region
for each of the three values of channel
width.
Solution:
For simulating the small-signal parameters gm and gds, we use a circuit similar to the circuit shown in
Fig. 3.30 in ‘CMOS Integrated Circuit Simulation with LTspice’. For convenience, this ﬁgure is shown
below.
Figure 3.30: NMOS current mirror with voltage buffer for the drain voltage for simulating both gds and gm.
For the simulations for ﬁnding gm and gds versus ID, the LTspice schematic shown on the next page is
used. Two ‘.step’ directives are inserted, one for
and one for . The ‘.step’ directive for
is inserted
ﬁrst in order to deﬁne
as the ﬁrst parameter to step, i.e. deﬁning the x-axis in the output plot from
the simulation. The step size for
has been chosen to be small, 0.01 mA, in order to get a smooth
simulation plot all the way down to 0 mA.
From the ‘.tf’ simulation, the transconductance gm is found as ‘
’ and the output
conductance gds is found as ‘
’, both of which are shown on the next
page. The green curves are for W = 10 µm, the blue curves are for W = 30 µm, and the red curves are
for W = 50 µm.
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
47
Tutorial 3 – MOS Transistors
47
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Get Help Now
Go to www.helpmyassignment.co.uk for more info
Need help with your
dissertation?
Get in-depth feedback & advice from experts in your 
topic area. Find out what you can do to improve
the quality of your dissertation!

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
48
Tutorial 3 – MOS Transistors
Clearly, there is a kink in each of the curves, indicating the limit between the active region (small values
of drain current) and the triode region (large values of drain current). From the kinks, we ﬁnd the
following maximum values of drain current for which the transistor is in the active region:
W = 10 µm: IDmax = 1.65 mA; W = 30 µm: IDmax = 4.95 mA; W = 50 µm: IDmax = 8.23 mA.
In the active region, gm is found from
gm =

2µnCox
W
L

ID(1+λVDS)
showing a square root dependency on ID (Equation (3.8) in ‘CMOS Integrated Circuit Simulation with
LTspice’).
In the triode region, gm is found from
gm = µnCox
W
L

VDS(1+λVDS)
showing that gm does not depend on ID (Equation (3.11) in ‘CMOS Integrated Circuit Simulation with
LTspice’).
For gds, we note that in the active region,
gds =
λID
1+λVDS
showing that gds is independent ofW and linearly increasing with ID (Equation (3.8) in ‘CMOS Integrated
Circuit Simulation with LTspice’).
In the triode region, an approximate expression for gds (neglecting λ) is
gds = ∂iD
∂vDS
= µnCox
W
L

(VGS −Vt −VDS)
Using
ID = µnCox
W
L

[(VGS −Vt)VDS −V 2
DS/2] ⇒VGS −Vt =
ID/VDS
µnCox(W/L) +VDS/2
we ﬁnd
gds = ID
VDS
−1
2µnCox
W
L

VDS
showing that gds increases linearly with ID and decreases linearly with W as also found from the simula-
tion.
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
49
Tutorial 3 – MOS Transistors
3.7
Kp = 190 µA/V2, Vto = 0.57 V, λ = 0.16 V−1,
γ = 0.5
√
V, |2ΦF| = 0.7 V.
Figure P3.7
For an NMOS transistor with the
Shichman-Hodges parameters shown
in Fig. P3.7, a channel width W =
20 µm and a channel length L = 1 µm,
simulate
and
plot
gm/gds
versus
the drain current ID for 1 µA < ID <
100 µA. Assume a drain-source voltage
of VDS = 1.5 V.
Also plot gm/gds versus 1/√ID. Find
gm/gds for ID = 1 µA and ID = 100 µA.
Solution:
For simulating gm and gds, we use the circuit shown in Fig. 3.30 in ‘CMOS Integrated Circuit Simulation
with LTspice’ (also shown on page 46 in this book). The ﬁgure below shows the LTspice schematic and
a plot of gm/gds shown as ‘
’.
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
50
Tutorial 3 – MOS Transistors
50
From the plot, we ﬁnd gm/gds = 751 for ID = 1 µA and gm/gds = 75.1 for ID = 100 µA.
In order to show gm/gds versus 1/√ID, we move the cursor to the horizontal axis and right-click. In
the window for ‘Quantity plotted’, we enter ‘1/sqrt(Id)’. The resulting plot is shown below. It is clearly
seen that the intrinsic transistor gain gm/gds is inversely proportional to √ID when using the Shichman-
Hodges transistor model.
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
By 2020, wind could provide one-tenth of our planet’s 
electricity needs. Already today, SKF’s innovative know-
how is crucial to running a large proportion of the 
world’s wind turbines. 
Up to 25 % of the generating costs relate to mainte-
nance. These can be reduced dramatically thanks to our 
systems for on-line condition monitoring and automatic 
lubrication. We help make it more economical to create 
cleaner, cheaper energy out of thin air. 
By sharing our experience, expertise, and creativity, 
industries can boost performance beyond expectations. 
Therefore we need the best employees who can 
meet this challenge!
The Power of Knowledge Engineering
Brain power
Plug into The Power of Knowledge Engineering. 
Visit us at www.skf.com/knowledge

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
51
Tutorial 3 – MOS Transistors
3.8
W1 = W2 = 20 µm, L1 = L2 = 1 µm,
AD1 = AD2 = 20×10−12 m2,
PD1 = PD2 = 22 µm.
Figure P3.8
For
the
current
mirror
shown
in
Fig. P3.8, use a ‘.ac’ simulation to
ﬁnd the input resistance and the in-
put capacitance. Assume that the in-
put impedance can be approximated by
a parallel connection of a capacitance
and a resistance so that the equations
shown on page 65 - 66 can be used. As-
sume a dc value of 100 µA for the input
current and use the transistor dimen-
sions shown in the ﬁgure. Also, use
the BSIM3 transistor model shown in
Fig. P3.5 on page 112 (BSIM3 0.35 µm
model, Fig. 3.10).
Find the input resistance and input ca-
pacitance for two different values of the
load resistor:
RL = 0 Ωand RL = 10 kΩ.
Solution:
The LTspice schematic for simulating the current mirror is shown below. Notice the ‘.step’ directive for
RL. As LTspice does not accept a value of 0 for a resistor, RL is stepped between the values 0.01 Ωand
10 kΩ. For ﬁnding the input resistance and input capacitance, we plot ‘
’
and ‘
’, respectively, compare equations (2.15) and
(2.16) on page 65 - 66 in ‘CMOS Integrated Circuit Simulation with LTspice’. The plots are shown on
the following page. From the plots, we ﬁnd Rin = 1.206 kΩ, independent of RL, Cin = 0.146 pF for
RL = 0 Ωand Cin = 0.190 pF for RL = 10 kΩ.
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
52
Tutorial 3 – MOS Transistors
52
The increase in input capacitance for RL = 20 kΩis due to the gain from the gate to the drain of M2,
causing a Miller effect on the gate-drain capacitance of M2, compare for instance the example given in
Fig. 2.27 on page 69 in ‘CMOS Integrated Circuit Simulation with LTspice’.
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
53
Tutorial 4 – Basic Gain Stages
Tutorial 4 – Basic Gain Stages
4.1
W2 = W3 = 25 µm, L1 = L2 = L3 = 1 µm
CL = 3.2 pF, VDD = 3 V, IB = 100 µA.
Figure P4.1
For
the
common-source
ampliﬁer
shown in Fig. P4.1, design M1 so that
the gain-bandwidth product of the
stage is 50 MHz.
Assume transistor
models as speciﬁed in Fig. P3.2 on
page 109 and Fig. P3.3 on page
110 and use a channel length of
L1 = 1 µm. Use a channel width for
M1 which is a multiple of 1 µm.
Hint:
Design M1 to have the re-
quired
gm
for
the
gain-bandwidth
product with ID = 100 µA. Find gm
versus ID using the method shown
in Example 3.5 on page 100.
Find the dc bias value of the input
voltage for which the output voltage is
1.5 V and ﬁnd the small-signal voltage
gain Av at low frequencies.
Figures P3.2 and P3.3 are shown on page 37 and 39, respectively, in this book.
Solution:
From 2π · GBW = gm1/CL, we ﬁnd gm1 = 1.0 mA/V. In order to ﬁnd a transistor channel width giving
this value of gm, we run the simulation shown below. From this, we ﬁnd W1 = 28 µm.
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
54
Tutorial 4 – Basic Gain Stages
With W1 = 28 µm, the common-source ampliﬁer is shown in the ﬁgure below with a speciﬁcation for a
‘.dc’ simulation. From the resulting simulation, we ﬁnd an input bias voltage of VIN = 0.773 V for an
output bias voltage of 1.5 V.
With the bias value for
inserted and with an ac amplitude of 1 V for
, a ‘.ac’ simulation will
show both the gain at low frequencies and verify the gain-bandwidth product of 50 MHz. The ﬁgures
below show the schematic and the resulting simulation plot. From the plot, we ﬁnd a low-frequency gain
of 38 dB and a gain-bandwidth product of 50 MHz, found as the frequency where the gain has dropped
to 0 dB.
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
55
Tutorial 4 – Basic Gain Stages
55
4.2
VDD = VSS = 1.5 V, L1 = L2 = 1 µm
CL = 0.5 pF, RL = 10 kΩ
Figure P4.2
For the inverting ampliﬁer shown in
Fig. P4.2, design M1 and M2 so that
the dc bias value of the output volt-
age is within the range ±100 mV with
an input dc bias voltage of 0 V and
so that the low-frequency small-signal
gain with an input dc bias voltage of
0 V is −10 V/V. Assume transistor
models as speciﬁed in Fig. P3.2 on
page 109 and Fig. P3.3 on page 110
and use a channel length of L1 = L2 =
1 µm.
Use channel widths for M1
and M2 which are multiples of 0.5 µm.
What is the low-frequency small-signal
gain if the load resistor RL is omitted?
What is the gain-bandwidth product of
the ampliﬁer for RL = 10 kΩand for
RL = ∞?
Figures P3.2 and P3.3 are shown on page 37 and 39, respectively in this book.
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
56
Tutorial 4 – Basic Gain Stages
Solution:
We start the solution by ﬁnding a ratio between the channel widths for the NMOS transistor (M1) and
the PMOS transistor (M2). For this, we may run a simulation as shown below where the channel widths
are deﬁned as parameters. The width W1 is selected to be 10 µm while the width W2 is stepped from
2W1 (20 µm) to 4W1 (40 µm). From a ‘.op’ simulation, the output voltage is plotted versus W2. The plot
below shows that with W1 = 10 µm, W2 should be 32 µm in order to obtain an output voltage of 0 V.
Thus, the ratio between W2 and W1 is 3.2.
Next, we deﬁne the parameter
to be 3.2 times the parameter
and we step the parameter
over
a suitable range (5 µm to 15 µm) and run a ‘.tf’ simulation in order to ﬁnd the low-frequency gain as
a function of W1, see ﬁgures below. From the simulation plot, we ﬁnd that in order to obtain a gain of
−10 V/V, W1 should be 6.3 µm. Nearest multiple of 0.5 µm is W1 = 6.5 µm, and with this value of W1,
we ﬁnd W2 = 3.2W1 = 20.8 µm. Rounding off to nearest multiple of 0.5 µm gives W2 = 21 µm.
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
57
Tutorial 4 – Basic Gain Stages
57
With W1 = 6.5 µm and W2 = 21 µm, we run a ‘.op’ simulation to verify the bias value of the output
voltage and a ‘.tf’ simulation to verify the gain.
The outputs of these simulations are shown below, and we ﬁnd results reasonably close to the design
targets.
--- Operating Point ---
V(vout): 
 0.0203095 
 voltage
V(vin): 
 0 
voltage
V(vdd): 
 1.5
voltage
V(-vss): 
-1.5
voltage
--- Transfer Function ---
Transfer_function:
 -10.2859
transfer
vin#Input_impedance: 
 1e+020 
 impedance
output_impedance_at_V(vout):
7651.2 
 impedance
Finally, in order to ﬁnd low-frequency gain and gain-bandwidth product for RL = 10 kΩand RL = ∞, we
run a ‘.ac’ simulation with RL stepped between two values, 10k and 10G. From the simulation plot on
the following page, we ﬁnd that with RL = ∞(10G), the low-frequency gain is 32.6 dB (or −43.6 V/V),
and the gain-bandwidth product is 400 MHz, independent of RL.
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
EXPERIENCE THE POWER OF 
FULL ENGAGEMENT…
     RUN FASTER.
          RUN LONGER..
                RUN EASIER…
READ MORE & PRE-ORDER TODAY 
WWW.GAITEYE.COM
Challenge the way we run

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
58
Tutorial 4 – Basic Gain Stages
In order to verify that the ‘.ac’ simulation runs from a reasonable bias point, also when RL = ∞, a ‘.op’
simulation with
may be run. The output ﬁle from this simulation is shown below, conﬁrming
that the bias value of VO is less than 100 mV.
--- Operating Point ---
V(vout): 
 0.0856978 
 voltage
V(vin): 
 0 
voltage
V(vdd): 
 1.5
voltage
V(-vss): 
-1.5
voltage
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
59
Tutorial 4 – Basic Gain Stages
4.3
L1 = L2 = L3 = L4 = L5 = L6 = L7 = L8 = 0.35 µm
RL = 10 kΩ, VDD = VSS = 1.5 V.
Figure P4.3
Figure P4.3 shows a class AB buffer
ampliﬁer.
Design the output transis-
tors M1 and M2 so that the ampliﬁer
can deliver an output-voltage swing of
±0.5 V with a load resistor of 10 kΩ.
Assume that the gate voltage of M1 and
M2 can reach the positive and nega-
tive supply voltages, respectively. Se-
lect values of the channel widths which
are multiples of 10 µm. Use transis-
tor models as speciﬁed in Fig. P3.2 on
page 109 and Fig. P3.3 on page 110.
Design the bias network M3 −M8 and
RB to provide a bias current of 1 µA
for M3 −M8.
M5 −M8 should be
designed to have a saturation voltage
|VDSsat| of less than 50 mV, and the
channel widths should be multiples of
10 µm. M3 and M4 should be scaled to
channel widths of 0.1 times the chan-
nel widths of M1 and M2, respectively.
Plot the output voltage versus the input
voltage for −1.5 V < vIN < 1.5 V. Find
the open-circuit voltage gain and the
output resistance of the buffer for an
input bias voltage of 0 V. Find the bias
current in M1 and M2 for an output bias
voltage of VO = 0 V. Why is the current
scaling in M1−M2 / M3−M4 different
from the channel width scaling?
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
60
Tutorial 4 – Basic Gain Stages
60
Solution:
For ﬁnding the channel width W1, we run a ‘.op’ simulation on a single NMOS transistor with gate,
source, drain and bulk connected to voltages resulting in the highest value of output voltage. Using a
‘.step param’ directive, the output voltage is simulated versus the channel width. The ﬁgure below shows
the schematic and the simulation plot from which we ﬁnd W1 = 30 µm (using multiples of 10 µm) in
order to achieve an output voltage of +0.5 V.
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
PDF components for PHP developers
www.setasign.com
SETASIGN
This e-book  
is made with 
SetaPDF

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
61
Tutorial 4 – Basic Gain Stages
The channel width W2 is found in the same way as W1, running a ‘.op’ simulation on a single PMOS
transistor with gate, source, drain and bulk connected to voltages resulting in the lowest value of output
voltage. The ﬁgure below shows the schematic and the simulation plot from which we ﬁnd W2 = 240 µm
(using multiples of 10 µm) in order to achieve an output voltage of −0.5 V.
For the bias network, M3 and M4 are designed by scaling W1 and W2 by a factor of 10, respectively. This
gives W3 = 3 µm and W4 = 24 µm.
The transistors M5 - M8 should have a saturation voltage of less than 50 mV for a drain current of 1 µA.
For the PMOS transistors (M5 and M6), the channel width is found from the simulation shown in the
ﬁgure below. The simulation is run with different values of
in multiples of 10 µm and the smallest
value of
resulting in
< 50 mV is selected, i.e. W5 = W6 = 30 µm.
Semiconductor Device Operating Points:
--- BSIM3 MOSFETS ---
Name:        m5
Model:    pmos-bsim
Id:
-1.00e-06
Vgs:
-6.25e-01
Vds:
-6.25e-01
Vbs:       0.00e+00
Vth:
-7.26e-01
Vdsat:
-4.87e-02
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
62
Tutorial 4 – Basic Gain Stages
For the NMOS transistors (M7 and M8), the channel width is found from the simulation shown in the
ﬁgure below. The simulation is run with different values of
in multiples of 10 µm and the smallest
value of
resulting in
< 50 mV is selected, i.e. W7 = W8 = 10 µm.
Semiconductor Device Operating Points:
--- BSIM3 MOSFETS ---
Name:        m7
Model:    nmos-bsim
Id:        1.00e-06
Vgs:       5.36e-01
Vds:       5.36e-01
Vbs:       0.00e+00
Vth:       5.63e-01
Vdsat:     4.41e-02
With all transistor dimensions in place, the complete schematic can be drawn as shown below. The only
device still to be designed is RB. This can be found from a ‘.op’ simulation with RB stepped over a
suitable range. From the simulation plot shown below, we ﬁnd that RB = 1.84 MΩgives a bias current
of 1 µA for M6 and M8.
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
63
Tutorial 4 – Basic Gain Stages
63
Next, a ‘.dc’ simulation is run, resulting in the simulation plot shown below. For this simulation, the
‘.step param’ directive is changed into a comment and RB is deﬁned by the ‘.param’ command shown in
the schematic on the previous page.
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
www.sylvania.com
We do not reinvent  
the wheel we reinvent 
light.
Fascinating lighting offers an infinite spectrum of 
possibilities: Innovative technologies and new  
markets provide both opportunities and challenges. 
An environment in which your expertise is in high 
demand. Enjoy the supportive working atmosphere 
within our global group and benefit from international 
career paths. Implement sustainable ideas in close 
cooperation with other specialists and contribute to 
influencing our future. Come and join us in reinventing 
light every day.
Light is OSRAM

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
64
Tutorial 4 – Basic Gain Stages
For ﬁnding the open circuit voltage gain and output resistance for an input bias voltage of 0 V, we run a
‘.tf’ simulation with
disconnected. The output ﬁle is shown below, and we ﬁnd Avoc = 0.95 V/V and
ro = 1005 Ω.
--- Transfer Function ---
Transfer_function:
0.951633 
 transfer
vin#Input_impedance: 
 674020 
 impedance
output_impedance_at_V(vo):
1005.47 
 impedance
For ﬁnding the bias currents in M1 and M2 for an output voltage of 0 V, we use the ‘.dc’ simulation
shown on the previous page to ﬁnd the value of the input voltage resulting in
= 0. From the plot,
we ﬁnd an input voltage of 4.769 mV. With this value of
, we run a ‘.op’ simulation, and the error log
ﬁle from this gives all the transistor bias currents as shown below.
Semiconductor Device Operating Points:
--- BSIM3 MOSFETS ---
Name:        m6          m5          m2
m4
m8
Model:    pmos-bsim   pmos-bsim   pmos-bsim   pmos-bsim   nmos-bsim
Id:
-9.99e-07
-1.01e-06
 -1.89e-05
-1.05e-06    9.99e-07
Vgs:
-6.25e-01
-6.25e-01
-8.82e-01
-8.86e-01    5.36e-01
Vds:
-6.25e-01
-6.35e-01
-1.50e+00
-8.86e-01    5.36e-01
Vbs:       0.00e+00    0.00e+00    1.50e+00    1.50e+00    0.00e+00
Vth:
-7.26e-01
-7.26e-01
-9.53e-01
-9.77e-01    5.63e-01
Vdsat:
-4.87e-02
-4.87e-02
-5.94e-02
-5.54e-02    4.41e-02
Name:        m7
m3
m1
Model:    nmos-bsim   nmos-bsim   nmos-bsim
Id:        1.05e-06    1.01e-06
1.89e-05
Vgs:       5.36e-01    8.60e-01    8.65e-01
Vds:       6.18e-01    8.60e-01    1.50e+00
Vbs:       0.00e+00
-1.50e+00
-1.50e+00
Vth:       5.62e-01    8.45e-01    8.32e-01
Vdsat:     4.43e-02    5.94e-02    6.62e-02
We notice that the current scaling in M1 - M2 / M3 - M4 is larger than the channel width scaling. This is
caused by the larger |VDS| values for M1 - M2 than for M3 - M4, by the input offset voltage, and by the
smaller threshold voltages for M1 - M2 than for M3 - M4.
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
65
Tutorial 4 – Basic Gain Stages
4.4
L1 = L2 = 1 µm, W1 = W2 = 10 µm
IB = 20 µA, VB = 1.5 V, VDD = 3 V.
.MODEL NMOS-SH nmos (Kp=190u Vto=0.57
+Lambda=0.16 Gamma=0.50 Phi=0.7 TOX=8n
+CGSO=0.28n CGBO=1p CGDO=0.28n CJ=1m
+CJSW=0.4n)
Figure P4.4
For the telescopic cascode shown in
Fig. P4.4, ﬁnd the bias value of VIN re-
quired to give an output voltage of 2 V.
Also ﬁnd the small-signal gain Avoc and
output resistance ro at low frequencies.
Find the small-signal resistance rx to
ground from the node x between the
source of M2 and the drain of M1. As-
sume a transistor model as shown in
Fig. P4.4.
Solution:
The ﬁgure below shows the cascode stage with a speciﬁcation for a ‘.dc’ simulation. Also shown is the
resulting plot of the output voltage. Apparently, the simulation generates unrealistically high output volt-
ages, several MV. This is due to the fact that the drain of M2 is connected directly to an ideal dc current
source.
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
66
Tutorial 4 – Basic Gain Stages
66
In order to see
in a realistic range of output voltages, we set the range of the y-axis to 3 V, either
by the command ‘Plot Settings →Manual Limits’ or by moving the cursor to the y-axis and using a
right-click on the mouse. The resulting plot is shown below, left plot. We see that the output voltage
changes abruptly for an input voltage of about 0.7 V, and in order to ﬁnd the exact input voltage, we
zoom in on a small part of the plot, see right plot below. From this, we ﬁnd VIN = 708.21 mV. Notice
that this value has been speciﬁed with a resolution exceeding the step size in the ‘.dc’ command, so it is
based on an interpolation.
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
360°
thinking.
© Deloitte & Touche LLP and affiliated entities.
Discover the truth at www.deloitte.ca/careers 

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
67
Tutorial 4 – Basic Gain Stages
In order to verify the bias point, we run a ‘.op’ simulation with a dc value of VIN speciﬁed to 708.21 mV.
The output ﬁle from this is shown below, and we see that
is sufﬁciently close to 2 V.
--- Operating Point ---
V(vx): 
 0.638226 
 voltage
V(vin): 
 0.70821 
 voltage
V(vo): 
 1.97479 
 voltage
V(vb): 
 1.5
voltage
V(vdd): 
 3 
voltage
With the bias point in place, the small-signal gain Avoc and output resistance ro at low frequencies are
found from a ‘.tf’ simulation with
as the output and
as the source. The output ﬁle from this
‘.tf’ simulation is shown below. From this, we ﬁnd a gain of −14065 V/V or 83 dB and an output resis-
tance of 49 MΩ.
--- Transfer Function ---
Transfer_function:
 -14065.1
transfer
vin#Input_impedance: 
 1e+020 
 impedance
output_impedance_at_V(vo):
4.89777e+007
impedance
For ﬁnding the small-signal resistance rx to ground from the node x between the source of M2 and the
drain of M1, we run a ‘.tf’ simulation with
as the output and
as the source. The output ﬁle
from this ‘.tf’ simulation is shown below. From this, we ﬁnd a resistance rx of 344 kΩ.
--- Transfer Function ---
Transfer_function:
 -99.6727
transfer
vin#Input_impedance: 
 1e+020 
 impedance
output_impedance_at_V(vx): 
 344394 
 impedance
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
68
Tutorial 4 – Basic Gain Stages
4.5
L1 = L2 = 1 µm, W1 = 10 µm, W2 = 30 µm
IBP = 40 µA, IBN = 20 µA, VB = 1.5 V, VDD = 3 V.
.MODEL PMOS-SH pmos (Kp=55u Vto=-0.71
+Lambda=0.16 Gamma=0.75 Phi=0.7 TOX=8n
+CGSO=0.21n CGBO=1p CGDO=0.28n CJ=1.5m
+CJSW=0.4n)
Figure P4.5
For the folded cascode shown in
Fig. P4.5, ﬁnd the bias value of VIN
required to give an output voltage of
1 V. Also ﬁnd the small-signal gain
Avoc and output resistance ro at low fre-
quencies. Find the small-signal resis-
tance rx to ground from the node x be-
tween the source of M2 and the drain
of M1.
Assume transistor models as
shown in Figs. P4.4 and P4.5.
Solution:
The ﬁgure below shows the folded-cascode stage with a speciﬁcation for a ‘.dc’ simulation. Also shown
is the resulting plot of the output voltage. Apparently, the simulation generates unrealistically high out-
put voltages, several MV. This is due to the biasing by two ideal dc current sources. You may also notice
that the simulation time is quite long, and examining the error log ﬁle, you ﬁnd that LTspice has some
challenges in ﬁnding the operating points for the values of input voltage giving unrealistic values of out-
put voltage.
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
69
Tutorial 4 – Basic Gain Stages
69
In order to see
in a realistic range of output voltages, we set the range of the y-axis to 3 V, either
by the command ‘Plot Settings →Manual Limits’ or by moving the cursor to the y-axis and using a
right-click on the mouse. The resulting plot is shown below, left plot. We see that the output voltage
changes abruptly for an input voltage of about 0.7 V. Even when zooming in on a small part of the plot,
it is difﬁcult to ﬁnd the value of VIN resulting in an output voltage of 1 V, so in order to improve the
accuracy, we run a ‘.dc’ simulation from 690 mV to 694 mV with a step size of 1 µV. From this, we ﬁnd
VIN = 693.684 mV.
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
We will turn your CV into 
an opportunity of a lifetime
Do you like cars? Would you like to be a part of a successful brand?
We will appreciate and reward both your enthusiasm and talent.
Send us your CV. You will be surprised where it can take you.
Send us your CV on
www.employerforlife.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
70
Tutorial 4 – Basic Gain Stages
In order to verify the bias point, we run a ‘.op’ simulation with a dc value of VIN speciﬁed to 693.684 mV.
The output ﬁle from this is shown below, and we see that
is sufﬁciently close to 1 V, and also the
voltage at the intermediate node x has a reasonable value within the supply voltage range.
--- Operating Point ---
V(vx): 
 2.3512 
 voltage
V(vin): 
 0.693684 
 voltage
V(vdd): 
 3 
voltage
V(vb): 
 1.5
voltage
V(vo): 
 1.00213 
 voltage
With the bias point in place, the small-signal gain Avoc and output resistance ro at low frequencies are
found from a ‘.tf’ simulation with
as the output and
as the source. The output ﬁle from this
‘.tf’ simulation is shown below. From this, we ﬁnd a gain of −15109 V/V or 84 dB and an output resis-
tance of 47 MΩ.
--- Transfer Function ---
Transfer_function:
 -15108.9
transfer
vin#Input_impedance: 
 1e+020 
 impedance
output_impedance_at_V(vo):
4.70983e+007
impedance
For ﬁnding the small-signal resistance rx to ground from the node x between the source of M2 and the
drain of M1, we run a ‘.tf’ simulation with
as the output and
as the source. The output ﬁle
from this ‘.tf’ simulation is shown below. From this, we ﬁnd a resistance rx of 430 kΩ.
--- Transfer Function ---
Transfer_function:
 -139.083
transfer
vin#Input_impedance: 
 1e+020 
 impedance
output_impedance_at_V(vx): 
 430060 
 impedance
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
71
Tutorial 4 – Basic Gain Stages
71
4.6
Figure P4.6
Figure P4.6 shows an alternative ver-
sion of the LTspice schematic from
Fig. 4.23 with a different arrange-
ment for the input voltages.
Deﬁne
the ac amplitudes of ‘
’, ‘
’, ‘
’
and ‘
’ such that the ‘.ac’ simu-
lation shows the differential gain and
compare your simulation to Fig. 4.27.
Next, deﬁne the ac amplitudes of ‘
’,
‘
’, ‘
’ and ‘
’ such that the ‘.ac’
simulation shows the common-mode
gain and compare your simulation to
Fig. 4.28. Finally, deﬁne the ac am-
plitudes of ‘
’, ‘
’, ‘
’ and ‘
’
such that the ‘.ac’ simulation shows
the power-supply rejection and com-
pare your simulation to Fig. 4.29.
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
AXA Global 
Graduate Program
Find out more and apply

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
72
Tutorial 4 – Basic Gain Stages
For convenience, Fig. 4.23 is shown below.
Figure 4.23: LTspice schematic for simulations of a PMOS differential pair with NMOS active load.
Solution:
For the differential gain, we deﬁne the ac amplitudes in Fig. P4.6 as follows:
: AC Amplitude = 0,
: AC Amplitude = 0.5,
: AC Amplitude = 0.5,
: AC Amplitude = 0.
The resulting schematic and simulation plot is shown below. The simulation plot is identical to Fig. 4.27
in ‘CMOS Integrated Circuit Simulation with LTspice’.
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
73
Tutorial 4 – Basic Gain Stages
For the common-mode gain, we deﬁne the ac amplitudes in Fig. P4.6 as follows:
: AC Amplitude = 1,
: AC Amplitude = 0,
: AC Amplitude = 0,
: AC Amplitude = 0.
The resulting schematic and simulation plot is shown below. The simulation plot is identical to Fig. 4.28
in ‘CMOS Integrated Circuit Simulation with LTspice’.
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
74
Tutorial 4 – Basic Gain Stages
For the power supply rejection, we deﬁne the ac amplitudes in Fig. P4.6 as follows:
: AC Amplitude = 0,
: AC Amplitude = 0,
: AC Amplitude = 0,
: AC Amplitude = 1.
The resulting schematic and simulation plot is shown below. The simulation plot is identical to Fig. 4.29
in ‘CMOS Integrated Circuit Simulation with LTspice’.
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
75
Tutorial 4 – Basic Gain Stages
75
4.7
L1 = L2 = L3 = L4 = L5 = 1 µm
W1 = 30 µm, W2 = 33 µm, W3 = W4 = W5 = W6 = 10 µm
AD1 = AS1 = AD2 = AS2 = 30 (µm)2
AD3 = AS3 = AD4 = AS4 = AD5 = AS5 = AD6 = AS6 = 10 (µm)2
PD1 = PS1 = PD2 = PS2 = 32 µm
PD3 = PS3 = PD4 = PS4 = PD5 = PS5 = PD6 = PS6 = 12 µm
RB = 100 kΩ, CL = 0.5 pF, VDD = 3.0 V, VCM = 1 V
Figure P4.7
For the differential pair shown in
Fig. P4.7, we assume that a layout er-
ror has resulted in a mismatch between
M1 and M2 such that W1 = 30 µm
and W2 = 33 µm. Find the input off-
set voltage caused by this error for a
common-mode input voltage of VCM =
1 V and an output voltage of 0.7 V. Use
the Shichman-Hodges transistor model
from Figs. P4.4 and P4.5. Next, plot
the differential gain and the common-
mode gain versus frequency. Find the
gain-bandwidth product and calculate
the common-mode rejection ratio at
low frequencies.
Also plot the gain
from the power-supply to the output
and calculate the power-supply rejec-
tion ratio at low frequencies.
Figures P4.4 and P4.5 are shown on page 65 and 68, respectively, in this book.
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
ibili
because 
e Graduate Programme  
for Engineers and Geoscientists
Month 16
I was a construction
supervisor in 
the North Sea 
advising and 
helping foremen 
solve problems
I was a
he
s
Real work 
International opportunities 

ree work placements
al 
Internationa
or

ree wo
I wanted real responsibili 
 I joined MITAS because 
www.discovermitas.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
76
Tutorial 4 – Basic Gain Stages
Solution:
The ﬁgure below shows the schematic in LTspice. For ﬁnding the offset voltage, we use a ‘.dc’ simu-
lation with the input voltage
to the noninverting input as the source to sweep. From the simulation
plot below, we ﬁnd that a dc input voltage of −4.2 mV results in an output voltage of 0.7 V. Thus,
Voff =−4.2 mV.
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
77
Tutorial 4 – Basic Gain Stages
For ﬁnding the differential gain, we specify a dc value of −4.2 mV for
and an ac amplitude of 0.5 V
for both
and
in the schematic on the previous page. We use a ‘.ac’ simulation with a start frequency
of 10 kHz and a stop frequency of 100 MHz: ‘
’. This results in the output plot
below where we ﬁnd the differential low-frequency gain to be 37.6 dB and the gain-bandwidth product
to be 60.3 MHz.
For ﬁnding the common-mode gain, we specify a dc value of −4.2 mV for
and an ac amplitude of
0 V for both
and
in the schematic on the previous page. Also, we specify an ac amplitude of 1 V
for
. We use a ‘.ac’ simulation with a start frequency of 10 kHz and a stop frequency of 100 MHz:
‘
’. This results in the output plot below where we ﬁnd the common-mode
low-frequency gain to be −28.8 dB, so the common-mode rejection ratio is CMRR = 37.6 dB + 28.8 dB
= 66.4 dB.
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
78
Tutorial 4 – Basic Gain Stages
78
For ﬁnding the power supply rejection, we specify a dc value of −4.2 mV for
and an ac amplitude of
0 V for both
,
and
. Also, we specify an ac amplitude of 1 V for
. We use a ‘.ac’ simulation
with a start frequency of 10 kHz and a stop frequency of 100 MHz: ‘
’. This
results in the output plot below where we ﬁnd the power supply rejection at low frequency to be 19.0 dB,
so the power supply rejection ratio is PSRR = 37.6 dB + 19.0 dB = 56.6 dB
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
MASTER IN MANAGEMENT
mim.admissions@ie.edu
Follow us on IE MIM Experience
www.ie.edu/master-management
#10 WORLDWIDE
MASTER IN MANAGEMENT 
FINANCIAL TIMES
55 Nationalities
in class
5 Specializations
Personalize your program 
Length: 1O MONTHS
Av. Experience: 1 YEAR
Language: ENGLISH / SPANISH
Format: FULL-TIME
Intakes: SEPT / FEB
• STUDY IN THE CENTER OF MADRID AND TAKE ADVANTAGE OF THE UNIQUE OPPORTUNITIES
  THAT THE CAPITAL OF SPAIN OFFERS
• PROPEL YOUR EDUCATION BY EARNING A DOUBLE DEGREE THAT BEST SUITS YOUR
  PROFESSIONAL GOALS
• STUDY A SEMESTER ABROAD AND BECOME A GLOBAL CITIZEN WITH THE BEYOND BORDERS
  EXPERIENCE
93%
OF MIM STUDENTS ARE
WORKING IN THEIR SECTOR 3 MONTHS
FOLLOWING GRADUATION

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
79
Tutorial 4 – Basic Gain Stages
4.8
.MODEL PMOS-SH pmos (Kp=55u Vto=-0.71
+Lambda=0.16 Gamma=0.75 Phi=0.7 TOX=8n
+CGSO=0.21n CGBO=1p CGDO=0.21n CJ=1.5m
+CJSW=0.4n KF=5e-26)
.MODEL NMOS-SH nmos (Kp=190u Vto=0.57
+Lambda=0.16 Gamma=0.50 Phi=0.7 TOX=8n
+CGSO=0.28n CGBO=1p CGDO=0.28n CJ=1m
+CJSW=0.4n KF=1e-25)
Figure P4.8
For the differential pair shown in
Fig. P4.7 with W1 = W2 = 30 µm, as-
sume the transistor models shown in
Fig. P4.8 which include parameters for
the ﬂicker noise modeling.
Plot the
total noise spectral density of the out-
put voltage and the noise contributions
from M1 and M3 in the frequency range
20 kHz to 10 MHz, using logarithmic
axes. Find the total RMS output noise
voltage in this frequency range. Also
plot the input referred noise spectral
density and ﬁnd the total RMS input re-
ferred noise voltage in this frequency
range.
Solution:
The ﬁgure below shows the schematic in LTspice. For ﬁnding the noise voltage, we use a ‘.noise’ simu-
lation with
as the input and
as the output.
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
80
Tutorial 4 – Basic Gain Stages
When plotting the noise contribution, remember to change the y-axis to logarithmic scale and use rea-
sonable top and bottom limits. The output voltage is selected by pointing to the output node. The noise
contributions from transistors M1 and M3 are selected by pointing to the transistors. The total output
noise voltage is found by pointing to the green label ‘
’ above the plot and using a ‘Ctrl-left-
click’. This opens the information window shown below, and we ﬁnd Von(rms) = 1.3 mV.
The input referred spectral noise density is selected in the plot window by the command ‘Plot Settings
→Visible Traces’ and is shown below together with the information window resulting from a ‘Ctrl-left-
click’ on the label above the plot. We ﬁnd a total equivalent input noise of Vin(rms) = 48 µV.
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
81
Tutorial 5 – Hierarchical Design
81
Tutorial 5 – Hierarchical Design
5.1
Rs = 1 MΩ, VDD = 3 V,
C1 = 0.2 pF, Cc = 0.7 pF, CL = 1.5 pF.
Figure P5.1
An inverter as shown in Fig. 5.25
on page 181 may be used as an
inverting ampliﬁer.
Design a test
bench as shown in Fig. P5.1 using
a supply voltage of 3 V, a minimum
length of ‘
’, a fanout of
‘
’ and the BSIM3 transis-
tor model from Fig. 3.10 on page 86.
Find an input bias voltage VB which
gives an output bias voltage of 1.5 V.
With this value of VB, simulate the ac
response and ﬁnd the dominant pole.
Also, use the Miller approximation
(Chan Carusone, Johns & Martin 2012)
to calculate the dominant pole and
compare to the simulated value.
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
82
Tutorial 5 – Hierarchical Design
For convenience, Figs. 5.25 and 3.10 are shown below.
Figure 5.25: Inverter, schematic and symbol.
Generic BSIM3 model for 0.35 µm CMOS process. Adapted from (Carusone, Johns & Martin 2014).
*BSIM3_035.lib
.MODEL NMOS-BSIM NMOS LEVEL = 49
+VERSION = 3.1 TNOM = 27 TOX = 7.8E-9 
+XJ = 1E-07 NCH = 2.18E+17 VTH0 = 0.48
+K1 = 6.07E-01 K2 = 1.24E-03 K3 = 9.68E+01
+K3B = -9.84E+00 W0 = 2.02E-05 NLX = 1.62E-07
+DVT0W = 0 DVT1W = 0 DVT2W = 0
+DVT0 = 2.87E+00 DVT1 = 5.86E-01 DVT2 = -1.26E-01
+U0 = 360 UA = -8.48E-10 UB = 2.27E-18
+UC = 3.27E-11 VSAT = 1.87E+05 A0 = 1.22E+00
+AGS = 2.06E-01 B0 = 9.60E-07 B1 = 4.95E-06
+KETA = -1.67E-04 A1 = 0 A2 = 3.49E-01
+RDSW = 8.18E+02 PRWG = 2.35E-02 PRWB = -8.12E-02
+WR = 9.98E-01 WINT = 1.55E-07 LINT = 4.51E-10
+DWG = -4.27E-09
+DWB = 4.07E-09 VOFF = -4.14E-02 NFACTOR = 1.61E+00
+CIT = 0 CDSC = 2.39E-04 CDSCD = 0.00E+00
+CDSCB = 0 ETA0 = 1 ETAB = -1.99E-01
+DSUB = 1 PCLM = 1.32E+00 PDIBLC1 = 2.42E-04
+PDIBLC2 = 8.27E-03 PDIBLCB = -9.99E-04 DROUT = 9.72E-04
+PSCBE1 = 7.24E+08 PSCBE2 = 9.96E-04 PVAG = 1.00E-02
+DELTA = 1.01E-02 RSH = 3.33E+00 MOBMOD = 1
+PRT = 0 UTE = -1.5 KT1 = -1.11E-01
+KT1L = 0 KT2 = 2.22E-02 UA1 = 4.34E-09
+UB1 = -7.56E-18 UC1 = -5.62E-11 AT = 3.31E+04
+WL = 0 WLN = 9.95E-01 WW = 0
+WWN = 1.00E+00 WWL = 0 LL = 0
+LLN = 1 LW = 0 LWN = 1
+LWL = 0 CAPMOD = 2 XPART = 0.5
+CGDO = 2.76E-10 CGSO = 2.76E-10 CGBO = 1.00E-12
+CJ = 9e-4 PB = 7.95E-01 MJ = 3.53E-01
+CJSW = 2.8e-10 PBSW = 7.98E-01 MJSW = 1.73E-01
+CJSWG = 1.81E-10 PBSWG = 7.96E-01 MJSWG = 1.74E-01
+CF = 0 PVTH0 = -1.80E-02 PRDSW = -7.56E+01
+PK2 = 4.48E-05 WKETA = -1.33E-03 LKETA = -8.91E-03
.MODEL PMOS-BSIM PMOS LEVEL = 49
+VERSION = 3.1 TNOM = 2.69E+01 TOX = 7.8E-9 
+XJ = 1.00E-07 NCH = 8.44E+16 VTH0 = -0.6
+K1 = 4.82E-01 K2 = -2.13E-02 K3 = 8.27E+01
+K3B = -5 W0 = 5.24E-06 NLX = 2.49E-07
+DVT0W = 0.00E+00 DVT1W = 0 DVT2W = 0
+DVT0 = 3.54E-01 DVT1 = 7.52E-01 DVT2 = -2.98E-01
+U0 = 150 UA = 1E-10 UB = 1.75E-18
+UC = -2.27E-11 VSAT = 2.01E+05 A0 = 1.04E+00
+AGS = 2.90E-01 B0 = 1.94E-06 B1 = 5.01E-06
+KETA = -3.85E-03 A1 = 4.20E-03 A2 = 1.00E+00
+RDSW = 4000 PRWG = -9.54E-02 PRWB = -1.92E-03
+WR = 1 WINT = 1.47E-07 LINT = 1.04E-10
+DWG = -1.09E-08
+DWB = 1.14E-08 VOFF = -1.29E-01 NFACTOR = 2.01E+00
+CIT = 0 CDSC = 2.40E-04 CDSCD = 0
+CDSCB = 0 ETA0 = 4.07E-02 ETAB = 6.84E-03
+DSUB = 3.21E-01 PCLM = 5.96E+00 PDIBLC1 = 2.89E-03
+PDIBLC2 = -1.45E-06 PDIBLCB = -1E-03 DROUT = 9.93E-04
+PSCBE1 = 7.88E+10 PSCBE2 = 5E-10 PVAG = 15
+DELTA = 9.96E-03 RSH = 2.6 MOBMOD = 1
+PRT = 0 UTE = -1.5 KT1 = -1.09E-01
+KT1L = 0 KT2 = 2.19E-02 UA1 = 4.34E-09
+UB1 = -7.62E-18 UC1 = -5.63E-11 AT = 3.28E+04
+WL = 0 WLN = 1 WW = 0
+WWN = 1.00E+00 WWL = 0 LL = 0
+LLN = 1 LW = 0 LWN = 1
+LWL = 0 CAPMOD = 2.01E+00 XPART = 0.5
+CGDO = 2.10E-10 CGSO = 2.12E-10 CGBO = 1.00E-12
+CJ = 14e-4 PB = 9.83E-01 MJ = 5.79E-01
+CJSW = 3.2e-10 PBSW = 9.92E-01 MJSW = 3.60E-01
+CJSWG = 4.41E-11 PBSWG = 9.85E-01 MJSWG = 3.58E-01
+CF = 0 PVTH0 = 2.58E-02 PRDSW = -3.98E+01
+PK2 = 2.02E-03 WKETA = 2.72E-03 LKETA = -7.14E-03
Figure 3.10: Library ﬁle with BSIM3 models for a generic 0.35 µm CMOS process, adapted from (Chan Carusone, Johns & Martin
2014).
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
83
Tutorial 5 – Hierarchical Design
Solution:
The ﬁgure below shows the schematic drawn in LTspice. For ﬁnding the bias input voltage, we run
a ‘.dc’ simulation, the result of which is also shown below. From this, we ﬁnd that a bias voltage of
VB = 1.505 V results in an output voltage of 1.5 V.
With 1.505 V inserted as the dc value for
, we run a ‘.ac’ simulation from which we ﬁnd a low-
frequency gain of 24.9 dB (or Av = −17.6 V/V) and a dominant pole of 12 kHz, see simulation plot
below.
A calculation of the dominant gives fp = (2π Rs ((1−Av)Cc +C1))−1 = 12 kHz.
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
84
Tutorial 5 – Hierarchical Design
84
5.2
Av(s) = ω ta(1−s/ω z)
s(1+s/ωp2)
ωta = 2π ×120 MHz,
ω z = 2π ×200 MHz,
ωp2 = 2π ×76 MHz.
Figure P5.2
Simulate the ac response of the closed-
loop gain and the loop gain for the
opamp shown in Figs. 5.10 and 5.11
with C1 = 1 pF, C2 = 0.2 pF and CL =
1.5 pF using the generic ﬁlter blocks
from Table 5.3.
Assume a transfer
function for the opamp as speciﬁed
in Fig. P5.2.
Find the phase margin and the closed-
loop bandwidth and compare to the re-
sults found in Example 5.2.
For convenience, Figs. 5.10, 5.11 and Table 5.3 are shown on the next page.
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
“The perfect start 
of a successful, 
international career.”
CLICK HERE 
to discover why both socially 
and academically the University 
of Groningen is one of the best 
places for a student to be 
www.rug.nl/feb/education
Excellent Economics and Business programmes at:

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
85
Tutorial 5 – Hierarchical Design
Figure 5.10: Inverting opamp conﬁguration with capacitive feedback.
Figure 5.11: Open loop circuit for ﬁnding the loop gain L(s) = Vr(s)/Vt(s).
Transfer
function
Schematic
Symbol
Parameter
Zero in 0
T(j f) = j f/ ft
Unity-gain
frequency ft
Real zero
T(j f) =
1+ j f/ fz
Zero
frequency fz
Pole in 0
T(j f) = ft/(j f)
Unity-gain
frequency ft
Real pole
T(j f) =
1
1+ j f/ fp
Pole
frequency fp
Biquad
T(j f) =
1
(j f)2+( j f)f0/Q+f 2
0
Resonance
frequency f0
and quality
factor Q
Table 5.3: Generic ﬁlter blocks deﬁned as subcircuits.
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
86
Tutorial 5 – Hierarchical Design
Solution:
The opamp transfer function comprises a factor with a pole in 0, a factor with a real pole and a factor
with a real zero. The corresponding ﬁlter blocks from Table 5.3 in ‘CMOS Integrated Circuit Simulation
with LTspice’ are
,
and
.
The ﬁgure below shows the LTspice schematic corresponding to Fig. 5.10 with these ﬁlter blocks inserted
for the opamp and with parameters as speciﬁed in Fig. P5.2. Note that the ﬁlter block
has a right
half plane zero, so the parameter
must be speciﬁed as a negative frequency. In order to provide an
inverting input for the opamp, an inversion is obtained from the voltage controlled voltage source
.
For ﬁnding the closed-loop ac response, we run a ‘.ac’ simulation and the result of this is shown below.
From the plot, we ﬁnd a closed-loop bandwidth of 30.7 MHz. This is higher than the bandwidth found in
Example 5.2 because higher order poles and zeros are neglected when using the opamp transfer function
speciﬁed in Fig. P5.2.
The ﬁgure on the next page shows the LTspice schematic corresponding to Fig. 5.11.
For ﬁnding the loop gain ac response, we run a ‘.ac’ simulation, and the result of this is also shown on
the next page. From the plot, we ﬁnd a phase margin of 180.0◦−109.9◦= 70.1◦. This is more than the
phase margin found in Example 5.2 because higher order poles and zeros are neglected when using the
opamp transfer function speciﬁed in Fig. P5.2.
If you open the error log ﬁle after the simulations, you will notice some warnings about ﬂoating nodes.
However, since LTspice assumes a bias voltage of 0 V for these ﬂoating nodes, the simulations are not
compromised.
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
87
Tutorial 5 – Hierarchical Design
87
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
American online      
LIGS University 
▶▶enroll by September 30th, 2014 and 
▶▶save up to 16% on the tuition!
▶▶pay in 10 installments / 2 years
▶▶Interactive Online education
▶▶visit www.ligsuniversity.com to 
      find out more!
is currently enrolling in the
Interactive Online BBA, MBA, MSc, 
DBA and PhD  programs:
Note: LIGS University is not accredited by any 
nationally recognized accrediting agency listed 
by the US Secretary of Education. 
More info here. 

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
88
Tutorial 5 – Hierarchical Design
5.3
Figure P5.3
Design subcircuits for a two-input
NAND gate and two-input and three-
input NOR gates similar to the logic
gate and inverter designs shown in Ex-
ample 5.4.
Scale the PMOS transis-
tors relative to the NMOS transistors to
compensate for the difference in elec-
tron mobility and hole mobility, assum-
ing µn = 3µp. Use the BSIM3 tran-
sistor models from Fig. 3.10 on page
86 with a channel length of Lmin =
0.35 µm and a minimum channel width
of 3Lmin for NMOS transistors and
9Lmin for PMOS transistors.
What are the transistor channel widths
used for the gates?
For convenience, Fig. 3.10 is shown on page 82 in this book.
Solution:
The ﬁgures below and on the next page show the schematics and symbols for each of the gates NOR2,
NOR3 and NAND2. In order to compensate for the difference in hole mobility and electron mobility, the
channel widths have been selected as follows:
NOR2: Wn = 3Lmin, Wp = 18Lmin;
NOR3: Wn = 3Lmin, Wp = 27Lmin;
NAND2: Wn = 6Lmin, Wp = 9Lmin.
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
89
Tutorial 5 – Hierarchical Design
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
90
Tutorial 5 – Hierarchical Design
90
5.4
Figure P5.4
Use the inverter from Fig. 5.25 on page
181 to design a ring oscillator as shown
in Fig. P5.4.
Use the BSIM3 tran-
sistor models from Fig. 3.10 on page
86 with a channel length of Lmin =
0.35 µm and a supply voltage of 3 V.
With ‘
’ and CF = 0.2 pF,
ﬁnd the frequency of oscillation. Also
ﬁnd the inverter delay for an inverter
loaded with an identical inverter.
Repeat for ‘
’ for all of the
inverters.
Hint: To start the oscillation, inject a
short current pulse in the output node.
For convenience, Figs. 5.25 and 3.10 are shown on page 82 in this book.
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
91
Tutorial 5 – Hierarchical Design
Solution:
The ﬁgure below shows the oscillator schematic in LTspice. For ﬁnding the frequency of oscillation,
we run a ‘.tran’ simulation. The resulting plot of the output voltage is shown below. Using the cursors,
the time for 4 periods of oscillation, 4T, is found, and the frequency is found as fosc = 1/T = 4/4T =
4/(14.45 ns−8.09 ns) = 629 MHz.
For ﬁnding the inverter delay, we plot the voltages
and
deﬁned in the schematic. The delay
between rising edges of
and
corresponds to two inverter delays. The ﬁgure below shows the
simulation plot zoomed in on a short interval around 7.4 ns. Using the cursors, we ﬁnd the delay from
to
to be 144 ps, so the inverter delay is 72 ps.
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
92
Tutorial 5 – Hierarchical Design
Repeating the simulation with a fanout of 5 for the inverters, we ﬁnd fosc = 1076 MHz and td = 64 ps,
see simulations below.
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
93
Tutorial 6 – Process and Parameter Variations
93
Tutorial 6 – Process and Parameter Variations
6.1
Typical model:
Slow model:
Fast model:
Figure P6.1
For an NMOS transistor, assume that
typical, slow and fast models are given
by the Shichman-Hodges model pa-
rameters shown in Fig. P6.1.
De-
sign a transistor model which com-
bines the three models into one, using
a speed parameter ‘
’ with ‘
’ =
−1 for the slow model, 0 for the typ-
ical model and 1 for the fast model.
Find
the
gate-source
voltage,
the
transconductance and the output con-
ductance for a transistor with VGS =
VDS, ID = 0.4 mA, W = 20 µm and
L = 1 µm for typical model parameters
and for slow and fast process corners.
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
 
  
 
                . 

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
94
Tutorial 6 – Process and Parameter Variations
Solution:
For the transistor model, we use the basic Shichman-Hodges model with
,
and
deﬁned as
parameters. The deﬁnitions of
,
and
are done using equation (6.4) from ‘CMOS Integrated
Circuit Simulation with LTspiceIV’:
(6.4)
where the values for
,
and
are typical, slow and fast parameters, respectively, and
is the speed
parameter (
for an NMOS transistor and
for a PMOS transistor).
The resulting model and parameter deﬁnitions are shown in the ﬁgure below.
The ﬁgure also shows a schematic for simulating VGS, gds and gm + gds using the method described in
Example 3.6 (Fig. 3.26).
Running a ‘.op’ simulation results in a plot window where VGS can be shown versus the speed parameter
. From the plot, we ﬁnd: VGS = 0.996 V for a typical transistor (
= 0), VGS = 1.095 V for a slow
transistor (
= −1), and VGS = 0.853 V for a fast transistor (
= 1).
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
95
Tutorial 6 – Process and Parameter Variations
95
For ﬁnding the small-signal parameters, we run a ‘.tf’ simulation (shown as a comment in the ﬁgure on
the previous page).
For gds, we plot ‘
’. This output conductance is equal to gds and we
ﬁnd: gds = 55.2 µA/V for a typical transistor (
= 0), gds = 57.3 µA/V for a slow transistor (
= −1),
and gds = 50.0 µA/V for a fast transistor (
= 1).
For ﬁnding gm, we plot ‘
’. This conductance is equal to gm +gds, so subtract-
ing the results for gds from the readings from the plot, we ﬁnd gm = 1.88 mA/V for a typical transistor
(
= 0), gm = 1.80 mA/V for a slow transistor (
= −1), and gm = 1.99 mA/V for a fast transistor
(
= 1).
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
www.mastersopenday.nl
Visit us and find out why we are the best!
Master’s Open Day: 22 February 2014
Join the best at
the Maastricht University
School of Business and
Economics!
Top master’s programmes
• 33rd place Financial Times worldwide ranking: MSc 
International Business
• 1st place: MSc International Business
• 1st place: MSc Financial Economics
• 2nd place: MSc Management of Learning
• 2nd place: MSc Economics
• 2nd place: MSc Econometrics and Operations Research
• 2nd place: MSc Global Supply Chain Management and 
Change
Sources: Keuzegids Master ranking 2013; Elsevier ‘Beste Studies’ ranking 2012; 
Financial Times Global Masters in Management ranking 2012
Maastricht
University is
the best specialist
university in the
Netherlands
(Elsevier)

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
96
Tutorial 6 – Process and Parameter Variations
6.2
.MODEL PMOS-BSIM PMOS LEVEL = 49
*Speed parameter SP
+VERSION = 3.1 TNOM = 2.69E+01 TOX = {7.8E-9/(1+SP/20)}
+XJ = 1.00E-07 NCH = 8.44E+16 VTH0 = {-0.6+SP/10}
+K1 = 4.82E-01 K2 = -2.13E-02 K3 = 8.27E+01
+K3B = -5 W0 = 5.24E-06 NLX = 2.49E-07
+DVT0W = 0.00E+00 DVT1W = 0 DVT2W = 0
+DVT0 = 3.54E-01 DVT1 = 7.52E-01 DVT2 = -2.98E-01
+U0 = {150*(1+SP/20)**2} UA = 1E-10 UB = 1.75E-18
+UC = -2.27E-11 VSAT = 2.01E+05 A0 = 1.04E+00
+AGS = 2.90E-01 B0 = 1.94E-06 B1 = 5.01E-06
+KETA = -3.85E-03 A1 = 4.20E-03 A2 = 1.00E+00
+RDSW = 4000 PRWG = -9.54E-02 PRWB = -1.92E-03
+WR = 1 WINT = 1.47E-07 LINT = 1.04E-10
+DWG = -1.09E-08
+DWB = 1.14E-08 VOFF = -1.29E-01 NFACTOR = 2.01E+00
+CIT = 0 CDSC = 2.40E-04 CDSCD = 0
+CDSCB = 0 ETA0 = 4.07E-02 ETAB = 6.84E-03
+DSUB = 3.21E-01 PCLM = 5.96E+00 PDIBLC1 = 2.89E-03
+PDIBLC2 = -1.45E-06 PDIBLCB = -1E-03 DROUT = 9.93E-04
+PSCBE1 = 7.88E+10 PSCBE2 = 5E-10 PVAG = 15
+DELTA = 9.96E-03 RSH = 2.6 MOBMOD = 1
+PRT = 0 UTE = -1.5 KT1 = -1.09E-01
+KT1L = 0 KT2 = 2.19E-02 UA1 = 4.34E-09
+UB1 = -7.62E-18 UC1 = -5.63E-11 AT = 3.28E+04
+WL = 0 WLN = 1 WW = 0
+WWN = 1.00E+00 WWL = 0 LL = 0
+LLN = 1 LW = 0 LWN = 1
+LWL = 0 CAPMOD = 2.01E+00 XPART = 0.5
+CGDO = 2.10E-10 CGSO = 2.12E-10 CGBO = 1.00E-12
+CJ = {14e-4/(1+SP/20)} PB = 9.83E-01 MJ = 5.79E-01
+CJSW = {3.2e-10/(1+SP/20)} PBSW = 9.92E-01 MJSW = 3.60E-01
+CJSWG = 4.41E-11 PBSWG = 9.85E-01 MJSWG = 3.58E-01
+CF = 0 PVTH0 = 2.58E-02 PRDSW = -3.98E+01
+PK2 = 2.02E-03 WKETA = 2.72E-03 LKETA = -7.14E-03
Figure P6.2
Design a PMOS transistor to provide a
gm of at least 0.48 mA/V with VGS =
VDS and ID = 30 µA using a worst-
case combination of temperature and
process variations. Assume the BSIM3
model shown in Fig. P6.2 and a tem-
perature range from −40◦C to 85◦C.
Use a channel length of L = 1 µm.
Solution:
For ﬁnding gm versus the channel width W, we use the approach shown in Fig. 6.5. The schematic from
Fig. 6.5 is shown on the next page for a PMOS transistor. For a transistor with L = 1 µm, we assume
gm ≫gds, so the small-signal resistance of the diode-connected transistor is a good approximation to
1/gm.
For showing both temperature variations and process parameter variations, we step both temperature and
speed parameter as shown in the schematic on the next page. The ‘.step’ directives are inserted with the
W-directive ﬁrst, so that the x-axis of the plot is W. Next, the
-directive is inserted and ﬁnally the
‘.temp’ directive. Then the three curves for a temperature of −40◦C are runs 1 to 3 (starting with
=
−1), and the three curves for a temperature of 85◦C are runs 4 to 6 (starting with
= −1). From the
plot of ‘
’, we ﬁnd that the worst-case corner is a slow transistor operating at
85◦C, and we ﬁnd that W = 280 µm is required to obtain gm ≥0.48 mA/V.
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
97
Tutorial 6 – Process and Parameter Variations
97
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
98
Tutorial 6 – Process and Parameter Variations
6.3
Figure P6.3
For the common-source stage shown
in Fig. P6.3, assume L1 = L2 = L3 =
1 µm, W1 = 22 µm, W2 = W3 = 20 µm,
IB = 140 µA and VDD = 3 V. As-
sume the BSIM3 models shown in
Fig. 6.2 on page 193 and a tempera-
ture of 27◦C. Also assume that pro-
cess variations cause CL to have a
value in the range of 1.3 pF to 1.7 pF.
Find the process corners for the unity-
gain frequency.
For convenience, Fig. 6.2 is shown below.
Generic BSIM3 model for 0.35 µm CMOS process with speed parameters
and
to deﬁne process variations.
*BSIM3_035PVT.lib
.MODEL NMOS-BSIM NMOS LEVEL = 49
*Speed parameter SN
+VERSION = 3.1 TNOM = 27 TOX = {7.8E-9/(1+SN/20)}
+XJ = 1E-07 NCH = 2.18E+17 VTH0 = {0.48-SN/10}
+K1 = 6.07E-01 K2 = 1.24E-03 K3 = 9.68E+01
+K3B = -9.84E+00 W0 = 2.02E-05 NLX = 1.62E-07
+DVT0W = 0 DVT1W = 0 DVT2W = 0
+DVT0 = 2.87E+00 DVT1 = 5.86E-01 DVT2 = -1.26E-01
+U0 = {360*(1+SN/20)**2} UA = -8.48E-10 UB = 2.27E-18
+UC = 3.27E-11 VSAT = 1.87E+05 A0 = 1.22E+00
+AGS = 2.06E-01 B0 = 9.60E-07 B1 = 4.95E-06
+KETA = -1.67E-04 A1 = 0 A2 = 3.49E-01
+RDSW = 8.18E+02 PRWG = 2.35E-02 PRWB = -8.12E-02
+WR = 9.98E-01 WINT = 1.55E-07 LINT = 4.51E-10
+DWG = -4.27E-09
+DWB = 4.07E-09 VOFF = -4.14E-02 NFACTOR = 1.61E+00
+CIT = 0 CDSC = 2.39E-04 CDSCD = 0.00E+00
+CDSCB = 0 ETA0 = 1 ETAB = -1.99E-01
+DSUB = 1 PCLM = 1.32E+00 PDIBLC1 = 2.42E-04
+PDIBLC2 = 8.27E-03 PDIBLCB = -9.99E-04 DROUT = 9.72E-04
+PSCBE1 = 7.24E+08 PSCBE2 = 9.96E-04 PVAG = 1.00E-02
+DELTA = 1.01E-02 RSH = 3.33E+00 MOBMOD = 1
+PRT = 0 UTE = -1.5 KT1 = -1.11E-01
+KT1L = 0 KT2 = 2.22E-02 UA1 = 4.34E-09
+UB1 = -7.56E-18 UC1 = -5.62E-11 AT = 3.31E+04
+WL = 0 WLN = 9.95E-01 WW = 0
+WWN = 1.00E+00 WWL = 0 LL = 0
+LLN = 1 LW = 0 LWN = 1
+LWL = 0 CAPMOD = 2 XPART = 0.5
+CGDO = 2.76E-10 CGSO = 2.76E-10 CGBO = 1.00E-12
+CJ = {9e-4/(1+SN/20)} PB = 7.95E-01 MJ = 3.53E-01
+CJSW = {2.8e-10/(1+SN/20)} PBSW = 7.98E-01 MJSW = 1.73E-01
+CJSWG = 1.81E-10 PBSWG = 7.96E-01 MJSWG = 1.74E-01
+CF = 0 PVTH0 = -1.80E-02 PRDSW = -7.56E+01
+PK2 = 4.48E-05 WKETA = -1.33E-03 LKETA = -8.91E-03
.MODEL PMOS-BSIM PMOS LEVEL = 49
*Speed parameter SP
+VERSION = 3.1 TNOM = 2.69E+01 TOX = {7.8E-9/(1+SP/20)}
+XJ = 1.00E-07 NCH = 8.44E+16 VTH0 = {-0.6+SP/10}
+K1 = 4.82E-01 K2 = -2.13E-02 K3 = 8.27E+01
+K3B = -5 W0 = 5.24E-06 NLX = 2.49E-07
+DVT0W = 0.00E+00 DVT1W = 0 DVT2W = 0
+DVT0 = 3.54E-01 DVT1 = 7.52E-01 DVT2 = -2.98E-01
+U0 = {150*(1+SP/20)**2} UA = 1E-10 UB = 1.75E-18
+UC = -2.27E-11 VSAT = 2.01E+05 A0 = 1.04E+00
+AGS = 2.90E-01 B0 = 1.94E-06 B1 = 5.01E-06
+KETA = -3.85E-03 A1 = 4.20E-03 A2 = 1.00E+00
+RDSW = 4000 PRWG = -9.54E-02 PRWB = -1.92E-03
+WR = 1 WINT = 1.47E-07 LINT = 1.04E-10
+DWG = -1.09E-08
+DWB = 1.14E-08 VOFF = -1.29E-01 NFACTOR = 2.01E+00
+CIT = 0 CDSC = 2.40E-04 CDSCD = 0
+CDSCB = 0 ETA0 = 4.07E-02 ETAB = 6.84E-03
+DSUB = 3.21E-01 PCLM = 5.96E+00 PDIBLC1 = 2.89E-03
+PDIBLC2 = -1.45E-06 PDIBLCB = -1E-03 DROUT = 9.93E-04
+PSCBE1 = 7.88E+10 PSCBE2 = 5E-10 PVAG = 15
+DELTA = 9.96E-03 RSH = 2.6 MOBMOD = 1
+PRT = 0 UTE = -1.5 KT1 = -1.09E-01
+KT1L = 0 KT2 = 2.19E-02 UA1 = 4.34E-09
+UB1 = -7.62E-18 UC1 = -5.63E-11 AT = 3.28E+04
+WL = 0 WLN = 1 WW = 0
+WWN = 1.00E+00 WWL = 0 LL = 0
+LLN = 1 LW = 0 LWN = 1
+LWL = 0 CAPMOD = 2.01E+00 XPART = 0.5
+CGDO = 2.10E-10 CGSO = 2.12E-10 CGBO = 1.00E-12
+CJ = {14e-4/(1+SP/20)} PB = 9.83E-01 MJ = 5.79E-01
+CJSW = {3.2e-10/(1+SP/20)} PBSW = 9.92E-01 MJSW = 3.60E-01
+CJSWG = 4.41E-11 PBSWG = 9.85E-01 MJSWG = 3.58E-01
+CF = 0 PVTH0 = 2.58E-02 PRDSW = -3.98E+01
+PK2 = 2.02E-03 WKETA = 2.72E-03 LKETA = -7.14E-03
Figure 6.2: Library ﬁle with BSIM3 models for a generic 0.35 µm CMOS process with speed parameters SN and SP to deﬁne
process variations, adapted from (Chan Carusone, Johns & Martin 2014). Speed parameter is 0 for typical model, –1 for slow
model and +1 for fast model.
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
99
Tutorial 6 – Process and Parameter Variations
Solution:
For simulating the unity-gain frequency, we need a ‘.ac’ simulation. In order to ensure a correct dc bias
point for the ‘.ac’ simulation in all process corners, we apply a dc feedback as shown in Fig. 6.15(a). For
convenience, this ﬁgure is shown below.
Figure 6.15(a): Inverting ampliﬁer with dc feedback to provide a suitable dc bias point.
For ﬁnding the process corners, we step the speed parameters
and
between the values −1 and 1,
and we step the capacitor CL between the two values 1.3 pF (fast) and 1.7 pF (slow) using the ‘.step’
directives shown in the schematic below. The ‘.step’ directives are inserted with the
-directive ﬁrst, so
that
is stepped ﬁrst. Next, the
-directive is inserted and ﬁnally the CL-directive. We may ﬁnd the
unity-gain frequency from the plots resulting from a ‘.ac’ simulation but it is easier to use a ‘.measure’
directive as shown in the schematic below.
The plot resulting from a ‘.ac’ simulation is shown below. It has a total of eight traces, one for each
corner, but some of the traces are almost overlapping. This can be seen from the close-up on the plot
around the unity-gain frequency also shown below.
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
100
Tutorial 6 – Process and Parameter Variations
Rather than using the cursors to ﬁnd the process corners, we use the results from the ‘.measure’ directive
found in the error log ﬁle (‘Ctrl-L’) shown below.
Direct Newton iteration for .op point succeeded.
.step sn=-1 sp=-1 cl=1.3e-012
.step sn=1 sp=-1 cl=1.3e-012
.step sn=-1 sp=1 cl=1.3e-012
.step sn=1 sp=1 cl=1.3e-012
.step sn=-1 sp=-1 cl=1.7e-012
.step sn=1 sp=-1 cl=1.7e-012
.step sn=-1 sp=1 cl=1.7e-012
.step sn=1 sp=1 cl=1.7e-012
Measurement: gbw
step
abs(v(vout))=1
1 
1.09824e+008
2 
1.30765e+008
3 
1.10805e+008
4 
1.31945e+008
5 
8.45606e+007
6 
1.00653e+008
7 
8.52814e+007
8 
1.0155e+008
From this, we can compile the following table:
Step
NMOS
PMOS
CL
Unity-gain frequency
1
slow
slow
fast
109.8 MHz
2
fast
slow
fast
130.8 MHz
3
slow
fast
fast
110.8 MHz
4
fast
fast
fast
131.9 MHz
5
slow
slow
slow
84.6 MHz
6
fast
slow
slow
100.7 MHz
7
slow
fast
slow
85.3 MHz
8
fast
fast
slow
101.6 MHz
The results may also be shown graphically by right-clicking in the error log ﬁle and selecting ‘Plot
.step’ed .meas data’. The ﬁgure below shows this plot with a labeling indicating the process corners.
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
101
Tutorial 6 – Process and Parameter Variations
6.4
For the digital inverter
in Fig. 6.18
on page 205, ﬁnd the worst-case de-
lay time considering both process vari-
ations,
temperature variations from
−40◦C to 85◦C and supply voltage
variations from 2.7 V to 3.3 V.
For convenience, Fig. 6.18 is shown below.
Figure 6.18: LTspice schematic of the inverter used as a digital inverter (top) and the result of a transient simulation (bottom).
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
102
Tutorial 6 – Process and Parameter Variations
102
Solution:
Compared to the simulation in Fig. 6.18, we need to vary also the temperature and the supply voltage.
Thus, we have a total of four parameters to be stepped which is more than LTspice can handle. However,
we know from the simulations of the transistor characteristics that the high temperature (85◦C) is the
more critical one, and – intuitively – a low supply voltage will give longer delays as the transistor over-
drive voltages are smaller. Thus, a pragmatic approach is to repeat the simulation from Fig. 6.18 with
a temperature of 85◦C and a supply voltage of 2.7 V. In the ‘.meas’ directives, the threshold voltages
for rising and falling edge should be modiﬁed accordingly, i.e. to VDD/2 V. Also the threshold voltages
for rise time and fall time are modiﬁed although rise and fall time simulations are not requested in the
problem.
The schematic with these changes are shown on the next page, and also a plot from the transient sim-
ulation and the results from the error log ﬁle are shown. We ﬁnd that the worst-case delay occurs for
a falling output with a slow NMOS transistor and a fast PMOS transistor. The maximum delay time is
199 ps. Also shown on the next page is a close-up on the falling output edge around 2 ns. The up and
down arrow keys are used to place the cursor on the correct trace (step 3) and a right mouse click on the
cursor is used to open a window with information about which trace the cursor is following.
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Get Help Now
Go to www.helpmyassignment.co.uk for more info
Need help with your
dissertation?
Get in-depth feedback & advice from experts in your 
topic area. Find out what you can do to improve
the quality of your dissertation!

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
103
Tutorial 6 – Process and Parameter Variations
Direct Newton iteration for .op point succeeded.
.step sn=-1 sp=-1 
.step sn=1 sp=-1 
.step sn=-1 sp=1
.step sn=1 sp=1
Measurement: tdelayr
step
tdelayr
FROM
TO
1 
1.76492e-010
1.0868e-009
1.26329e-009
2 
1.75295e-010
1.06988e-009
1.24517e-009
3 
1.32493e-010
1.08991e-009
1.2224e-009
4 
1.30468e-010
1.07231e-009
1.20278e-009
Measurement: tdelayf
step
tdelayf
FROM
TO
1 
1.90873e-010
2.1032e-009
2.29407e-009
2 
1.47291e-010
2.10361e-009
2.2509e-009
3 
1.99271e-010
2.08364e-009
2.28291e-009
4 
1.53242e-010
2.08384e-009
2.23708e-009
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
104
Tutorial 6 – Process and Parameter Variations
6.5
Figure P6.5
For the common-source stage shown
in Fig. P6.5, ﬁnd the worst-case cor-
ner for unity-gain bandwidth (low-
est unity-gain bandwidth) for tem-
perature variations and supply volt-
age variations. Assume CL = 1.5 pF,
L1 = L2 = L3 = 1 µm, W1 = 22 µm,
W2 = W3 = 20 µm,
VDD = 3 V
and IB = (VDD −0.9 V)/(15 kΩ).
Assume the BSIM3 models shown
in Fig. 6.2 on page 193 with typical
process parameters, temperature varia-
tions from −40◦C to 85◦C and supply
voltage variations from 2.7 V to 3.3 V.
Run a Monte Carlo simulation for the
worst-case combination of tempera-
ture and supply voltage with stochas-
tic variations of the process parame-
ters for the transistors and the capac-
itor CL. Assume a standard deviation
of 0.4 for the process speed parame-
ters and a capacitor tolerance of ±5%.
Estimate mean value and standard de-
viation of the unity-gain frequency for
the worst-case combination of tempe-
rature and supply voltage.
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
105
Tutorial 6 – Process and Parameter Variations
105
Solution:
For simulating the unity-gain frequency, we need a ‘.ac’ simulation. In order to ensure a correct dc bias
point for the ‘.ac’ simulation in all process corners, we apply a dc feedback as shown in Fig. 6.15(a)
(also shown on page 99 in this book). For ﬁnding corners for supply voltage variation and temperature
variation, we step the supply voltage
and the temperature using the ‘.step’ directive and the ‘.temp’
directive shown in the schematic on the next page. We may ﬁnd the unity-gain frequency from the plots
resulting from a ‘.ac’ simulation but it is easier to use a ‘.measure’ directive to calculate the process
corner values of the unity-gain frequency. The ‘.measure’ directive is shown in the schematic on the next
page.
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
By 2020, wind could provide one-tenth of our planet’s 
electricity needs. Already today, SKF’s innovative know-
how is crucial to running a large proportion of the 
world’s wind turbines. 
Up to 25 % of the generating costs relate to mainte-
nance. These can be reduced dramatically thanks to our 
systems for on-line condition monitoring and automatic 
lubrication. We help make it more economical to create 
cleaner, cheaper energy out of thin air. 
By sharing our experience, expertise, and creativity, 
industries can boost performance beyond expectations. 
Therefore we need the best employees who can 
meet this challenge!
The Power of Knowledge Engineering
Brain power
Plug into The Power of Knowledge Engineering. 
Visit us at www.skf.com/knowledge

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
106
Tutorial 6 – Process and Parameter Variations
The results from the ‘.measure’ directive are found in the error log ﬁle shown below, and we ﬁnd that the
worst-case corner is the combination of a low supply voltage and a high temperature.
The process corners can also be shown graphically by right-clicking in the error log ﬁle and selecting
‘Plot .step’ed .meas data’. The ﬁgure below shows the resulting plot.
Direct Newton iteration for .op point succeeded.
.step vdd=2.7 temp=-40°C
.step vdd=3.3 temp=-40°C
.step vdd=2.7 temp=85°C
.step vdd=3.3 temp=85°C
Measurement: gbw
step
abs(v(vout))=1
1 
1.23642e+008
2 
1.39998e+008
3 
8.42695e+007
4 
9.40421e+007
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
107
Tutorial 6 – Process and Parameter Variations
For running a Monte Carlo simulation with a supply voltage of 2.7 V and a temperature of 85◦C, we
deﬁne
and
to have these values. Also, we deﬁne
,
and
to have stochastic variations us-
ing the functions ‘
’ and ‘
’. For a Monte Carlo simulation with 50 simulations, a step
count parameter
must be deﬁned as shown in the schematic below. Also a plot of the output voltage
resulting from the simulation is shown.
The error log ﬁle from the simulation gives the calculated values of the unity-gain bandwidth for each of
the 50 steps in the Monte Carlo simulation. The results are shown on the next page. By right-clicking
in the error log ﬁle and selecting ‘Plot .step’ed .meas data’, the results can also be plotted graphically as
also shown on the next page.
The results from the error log ﬁle may be copied into an Excel spreadsheet, and from this, we ﬁnd a mean
value of 85 MHz and a standard deviation of 4 MHz.
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
108
Tutorial 6 – Process and Parameter Variations
Measurement: gbw
step
abs(v(vout))=1
1 
8.17271e+007
2 
7.92561e+007
3 
8.97408e+007
4 
8.67015e+007
5 
8.50062e+007
6 
8.82216e+007
7 
8.74819e+007
8 
8.38107e+007
9 
8.57428e+007
10
8.34513e+007
11
8.11149e+007
12
9.0147e+007
13
7.982e+007
14
7.90185e+007
15
9.11583e+007
16
8.71882e+007
17
8.1665e+007
18
8.76643e+007
19
8.4134e+007
20
9.25686e+007
21
9.00365e+007
22
8.22461e+007
23
8.85673e+007
24
8.5306e+007
25
8.32077e+007
26
8.09493e+007
27
8.22352e+007
28
7.99386e+007
29
8.83158e+007
30
8.22246e+007
31
9.11552e+007
32
8.30066e+007
33
7.83127e+007
34
8.09654e+007
35
8.51145e+007
36
8.50773e+007
37
8.60746e+007
38
8.83669e+007
39
7.90209e+007
40
7.94301e+007
41
9.22594e+007
42
8.69342e+007
43
8.88345e+007
44
8.85208e+007
45
8.13371e+007
46
9.11521e+007
47
8.43626e+007
48
8.66154e+007
49
7.90699e+007
50
8.74e+007
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
109
Tutorial 7 – Importing and Exporting Files
109
Tutorial 7 – Importing and Exporting Files
7.1
*Differential NMOS pair with 
*resistive load and differential output
*Noninverting input: Node 3
*Inverting input: Node 2
*Noninverting output: Node 4
*Inverting output: Node 5
*Supply voltage: Node 1
*Bias current: IB from node 6 to ground
*Circuit description
R1 1 4 2.7k
R2 1 5 2.7k
M1 4 2 6 0 NMOS-BSIM L=0.7u W=16u
M2 5 3 6 0 NMOS-BSIM L=0.7u W=16u
Figure P7.1
Figure P7.1 shows a netlist for a dif-
ferential NMOS pair with differential
output. Create a netlist ﬁle for LTspice
for simulating the circuit with a supply
voltage of 3 V, a bias current of 250 µA
and a common-mode input voltage of
1.5 V. Use the BSIM3 transistor model
from Fig. 3.10 on page 86. Find the
bias values of the output voltages and
the small-signal differential gain.
Figure 3.10 is shown on page 82 in this book.
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
110
Tutorial 7 – Importing and Exporting Files
Solution:
For the netlist ﬁle for LTspice, we need to add the supply voltage, the bias current, and the input voltages
(common-mode and differential-mode). Also, a simulation directive must be speciﬁed. In the ﬁle shown
below, the input voltages are added using the scheme from Problem 4.6, and the differential input voltage
is varied using a ‘.step’ directive in combination with a ‘.op’ simulation.
*Differential NMOS pair with 
*resistive load and differential output
*Noninverting input: Node 3
*Inverting input: Node 2
*Noninverting output: Node 4
*Inverting output: Node 5
*Supply voltage: Node 1
*Bias current: IB from node 6 to ground
*Circuit description
R1 1 4 2.7k
R2 1 5 2.7k
M1 4 2 6 0 NMOS-BSIM L=0.7u W=16u
M2 5 3 6 0 NMOS-BSIM L=0.7u W=16u
*Transistor models
.include BSIM3_035.lib
*Supply voltage and bias current
VDD 1 0 3
IB 6 0 250u
*input voltages
vcm 11 0 1.5
vdp 3 11 {vid/2}
vdn 2 11 {-vid/2}
.step param vid -0.3 0.3 0.001
.op
.end
The simulation is run directly from the netlist ﬁle in LTspice using the ‘Simulate →Run’ command (or
‘Ctrl-R’), and in the plot window which opens, the traces to plot are selected using ‘Plot Setting →Add
trace’ (or ‘Ctrl-A’). For ﬁnding the common-mode output voltage, we plot the noninverting output (
)
and read the value for an input voltage of 0 V. For ﬁnding the differential gain, we plot the derivative of
the differential output voltage, i.e.
and ﬁnd the value for an input voltage of 0 V. From
the plots below, we ﬁnd a common-mode output voltage of 1.75 V and a differential gain of 9.12 V/V.
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
111
Tutorial 7 – Importing and Exporting Files
7.2
Figure P7.2
Use the netlist from Fig. P7.1 to
design a subcircuit and a subcir-
cuit
symbol
for
the
differential
pair.
Use
the
BSIM3
transistor
model from Fig. 3.10 on page 86.
Design the subcircuit to have separate
terminals for the supply voltage and
the bias current.
Insert the diffe-
rential pair in a test bench as shown
in Fig. P7.2 and ﬁnd the −3 dB
frequency for the differential gain.
Use
VDD = 3
V,
IB = 250
µA,
VCM = 1.5 V and CL = 3 pF.
Figure 3.10 is shown on page 82 in this book.
Solution:
The netlist from Fig. P7.1 is modiﬁed by including a ‘.subckt’ directive and a ‘.ends’ directive as shown
below. By placing the cursor in the ‘.subckt’ line and right-clicking, a symbol is generated, and using the
graphic symbol editor, this may be modiﬁed into the symbol shown below.
*Differential NMOS pair with 
*resistive load and differential output
*Noninverting input: Node 3
*Inverting input: Node 2
*Noninverting output: Node 4
*Inverting output: Node 5
*Supply voltage: Node 1
*Bias current: IB from node 6 to ground
.subckt difpair 1 2 3 4 5 6
*Circuit description
R1 1 4 2.7k
R2 1 5 2.7k
M1 4 2 6 0 NMOS-BSIM L=0.7u W=16u
M2 5 3 6 0 NMOS-BSIM L=0.7u W=16u
.ends
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
112
Tutorial 7 – Importing and Exporting Files
112
The ﬁgure below shows a testbench corresponding to Fig. P7.2 and a plot of the differential output
voltage. From the plot, we ﬁnd a −3 dB frequency of 2.84 MHz.
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
113
Tutorial 7 – Importing and Exporting Files
7.3
Redeﬁne
the
subcircuit
from
Pro-
blem 7.2 to have the transistor chan-
nel
width
as
a
parameter
which
can be deﬁned at top level.
Use the testbench from Fig. P7.2 to ﬁnd
the low-frequency gain as a function
of the channel width for 5 µm≤W ≤
30 µm. What is the value of the low-
frequency gain for W = 5 µm and W =
30 µm?
Solution:
The netlist from Problem 7.2 is modiﬁed by specifying the channel width as a parameter. Also, the sub-
circuit is renamed to ‘
’ with a corresponding symbol as shown below.
*Differential NMOS pair with 
*resistive load and differential output
*Noninverting input: Node 3
*Inverting input: Node 2
*Noninverting output: Node 4
*Inverting output: Node 5
*Supply voltage: Node 1
*Bias current: IB from node 6 to ground
.subckt difpairw 1 2 3 4 5 6
*Circuit description
R1 1 4 2.7k
R2 1 5 2.7k
M1 4 2 6 0 NMOS-BSIM L=0.7u W={W}
M2 5 3 6 0 NMOS-BSIM L=0.7u W={W}
.ends
Download free eBooks at bookboon.com

CMOS INTEGRATED CIRCUIT 
SIMULATION: SOLUTIONS
114
Tutorial 7 – Importing and Exporting Files
The testbench from Problem 7.2 is modiﬁed by replacing the subcircuit ‘
’ with ‘
’
and including a ‘.step’ directive to sweep the channel width. Also, a ‘.measure’ directive for ﬁnding the
low-frequency gain is inserted as shown below. The resulting ‘.ac’ simulation has many traces, see below.
In order to ﬁnd the low-frequency gain versus channel width, we open the error log ﬁle and right-click
to ‘Plot .step’ed .meas data’. The plot is shown below, and from the plot, we ﬁnd a gain of 4.15 V/V for
W = 5 µm and 12.9 V/V for W = 30 µm.
Download free eBooks at bookboon.com

