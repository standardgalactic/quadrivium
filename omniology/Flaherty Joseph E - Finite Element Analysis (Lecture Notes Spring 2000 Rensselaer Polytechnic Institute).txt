CSCI
MA
TH

FINITE
ELEMENT
ANAL
YSIS
Lecture
Notes
Spring

Joseph
E
Flahert
y
Amos
Eaton
Professor
Departmen
t
of
Computer
Science
Departmen
t
of
Mathematical
Sciences
Rensselaer
P
olytec
hnic
Institute
T
ro
y

New
Y
ork


c

Joseph
E
Flahert
y

all
righ
ts
reserv
ed
These
notes
are
in
tended
for
classro
om
use
b
y
Rensselaer
studen
ts
taking
courses
CSCI
MA
TH

Cop
ying
or
do
wnloading
b
y
others
for
p
ersonal
use
is
acceptable
with
notication
of
the
author
ii

CSCI
MA
TH

Finite
Elemen
t
Analysis
Spring

Outline

In
tro
duction

Historical
P
ersp
ectiv
e

W
eigh
ted
Residual
Metho
ds

A
Simple
Finite
Elemen
t
Problem

One
Dimensional
Finite
Elemen
t
Metho
ds

In
tro
duction

Galerkins
Metho
d
and
Extremal
Principles

Essen
tial
and
Natural
Boundary
Conditions

Piecewise
Lagrange
Appro
ximation

Hierarc
hical
Bases

In
terp
olation
Errors

Multi
Dimensional
V
ariational
Principles

Galerkins
Metho
d
and
Extremal
Principles

F
unction
Spaces
and
Appro
ximation

Ov
erview
of
the
Finite
Elemen
t
Metho
d

Finite
Elemen
t
Appro
ximation

In
tro
duction

Lagrange
Bases
on
T
riangles

Lagrange
Bases
on
Rectangles

Hierarc
hical
Bases

Three
dimensional
Bases

In
terp
olation
Errors

Mesh
Generation
and
Assem
bly

In
tro
duction
iii


Mesh
Generation

Data
Structures

Co
ordinate
T
ransformations

Generation
of
Elemen
t
Matrices
and
Their
Assem
bly

Assem
bly
of
V
ector
Systems

Numerical
In
tegration

In
tro
duction

One
Dimensional
Gaussian
Quadrature

Multi
Dimensional
Gaussian
Quadrature

Discretization
Errors

In
tro
duction

Con
v
ergence
and
Optimalit
y

P
erturbations

Adaptivit
y

In
tro
duction

h
Renemen
t

p
and
hp
Renemen
t
	
P
arab
olic
Problems
	
In
tro
duction
	
Semi
Discrete
Galerkin
Metho
ds
The
Metho
d
of
Lines
	
Finite
Elemen
t
Metho
ds
in
Time
	
Con
v
ergence
and
Stabilit
y
	
Con
v
ection
Diusion
Systems

Hyp
erb
olic
Problems

In
tro
duction

Flo
w
Problems
and
Up
wind
W
eigh
ting

Articial
Diusion
iv


Streamline
W
eigh
ting

Linear
Systems
Solution

In
tro
duction

Banded
Gaussian
Elimination
and
Prole
T
ec
hniques

Nested
Dissection
and
Domain
Decomp
osition

Conjugate
Gradien
t
Metho
ds

Nonlinear
Problems
and
Newtons
Metho
d
v

vi

Bibliograph
y

AK
Aziz
editor
The
Mathematic
al
Foundations
of
the
Finite
Element
Metho
d
with
Applic
ations
to
Partial
Dier
ential
Equations
New
Y
ork
	
Academic
Press

I
Babu

sk
a
J
Chandra
and
JE
Flahert
y

editors
Adaptive
Computational
Metho
ds
for
Partial
Dier
ential
Equations
Philadelphia
	
SIAM

I
Babu

sk
a
OC
Zienkiewicz
J
Gago
and
ER
de
A
Oliv
eira
editors
Ac
cur
acy
Estimates
and
Adaptive
Renements
in
Finite
Element
Computations
John
Wiley
and
Sons
Chic
hester
	

K
J
Bathe
Finite
Element
Pr
o
c
e
dur
es
Pren
tice
Hall
Englew
o
o
d
Clis
		

EB
Bec
k
er
GF
Carey

and
JT
Oden
Finite
Elements
A
n
Intr
o
duction
v
ol
ume
I
Pren
tice
Hall
Englew
o
o
d
Clis
	

MW
Bern
JE
Flahert
y

and
M
Luskin
editors
Grid
Gener
ation
and
A
daptive
A
lgorithms
v
olume

of
The
IMA
V
olumes
in
Mathematics
and
its
Applic
ations
New
Y
ork
			
Springer

CA
Brebia
The
Boundary
Element
Metho
d
for
Engine
ers
P
en
tec
h
Press
London
second
edition
	

SC
Brenner
and
LR
Scott
The
Mathematic
al
The
ory
of
Finite
Element
Metho
ds
Springer
V
erlag
New
Y
ork
		
	
GF
Carey

Computational
Grids
Gener
ation
A
daptation
and
Solution
Str
ate
gies
Series
in
Computational
and
Ph
ysical
Pro
cesses
in
Mec
hanics
and
Thermal
science
T
a
ylor
and
F
rancis
New
Y
ork
		

GF
Carey
and
JT
Oden
Finite
Elements
A
Se
c
ond
Course
v
olume
I
I
Pren
tice
Hall
Englew
o
o
d
Clis
	

GF
Carey
and
JT
Oden
Finite
Elements
Computational
Asp
e
cts
v
olume
I
I
I
Pren
tice
Hall
Englew
o
o
d
Clis
	
vii


P
G
Ciarlet
The
Finite
Element
Metho
d
for
El
liptic
Pr
oblems
North
Holland
Amsterdam
	

K
Clark
JE
Flahert
y

and
MS
Shephard
editors
Applie
d
Numeric
al
Mathemat
ics
v
olume

		
Sp
ecial
Issue
on
Adaptiv
e
Metho
ds
for
P
artial
Dieren
tial
Equations

RD
Co
ok
DS
Malkus
and
ME
Plesha
Conc
epts
and
Applic
ations
of
Finite
Element
A
nalysis
John
Wiley
and
Sons
New
Y
ork
third
edition
		

K
Eriksson
D
Estep
P

Hansb
o
and
C
Johnson
Computational
Dier
ential
Equation
Cam
bridge
Cam
bridge
		

G
F
airw
eather
Finite
Element
Metho
ds
for
Dier
ential
Equations
Marcel
Dekk
er
Basel
	

B
Finla
yson
The
Metho
d
of
Weighte
d
R
esiduals
and
V
ariational
Principles
Aca
demic
Press
New
Y
ork
	

JE
Flahert
y

P
J
P
aslo
w
MS
Shephard
and
JD
V
asilakis
editors
A
daptive
metho
ds
for
Partial
Dier
ential
Equations
Philadelphia
		
SIAM
	
RH
Gallagher
JT
Oden
C
T
a
ylor
and
OC
Zienkiewicz
editors
Finite
El
ements
in
Fluids
Mathematic
al
F
oundations
A
er
o
dynamics
and
Lubric
ation
v
ol
ume

London
	
John
Wiley
and
Sons

RH
Gallagher
JT
Oden
C
T
a
ylor
and
OC
Zienkiewicz
editors
Finite
Ele
ments
in
Fluids
Visc
ous
Flow
and
Hydr
o
dynamics
v
olume

London
	
John
Wiley
and
Sons

RH
Gallagher
OC
Zienkiewicz
JT
Oden
M
Morandi
Cecc
hi
and
C
T
a
ylor
editors
Finite
Elements
in
Fluids
v
olume

London
	
John
Wiley
and
Sons

V
Girault
and
P
A
Ra
viart
Finite
Element
Appr
oximations
of
the
NavierStokes
Equations
Num
b
er
	
in
Lecture
Notes
in
Mathematics
Springer
V
erlag
Berlin
		

TJR
Hughes
editor
Finite
Element
Metho
ds
for
Conve
ction
Dominate
d
Flows
v
olume

of
AMD
New
Y
ork
		
ASME

TJR
Hughes
The
Finite
Element
Metho
d
Line
ar
Static
and
Dynamic
Finite
Element
A
nalysis
Pren
tice
Hall
Englew
o
o
d
Clis
	
viii


BM
Irons
and
S
Ahmed
T
e
chniques
of
Finite
Elements
Ellis
Horw
o
o
d
London
	

C
Johnson
Numeric
al
Solution
of
Partial
Dier
ential
Equations
by
the
Finite
Ele
ment
metho
d
Cam
bridge
Cam
bridge
	

N
Kikuc
hi
Finite
Element
Metho
ds
in
Me
chanics
Cam
bridge
Cam
bridge
	

YW
Kw
on
and
H
Bang
The
Finite
Element
Metho
d
Using
Matlab
CR
C
Mec
han
ical
Engineering
Series
CR
C
Bo
ca
Raton
		
	
L
Lapidus
and
GF
Pinder
Numeric
al
Solution
of
Partial
Dier
ential
Equations
in
Scienc
e
and
Engine
ering
Wiley
In
terscience
New
Y
ork
	

DL
Logan
A
First
Course
in
the
Finite
Element
Metho
d
using
ALGOR
PWS
Boston
		

JT
Oden
Finite
Elements
of
Nonline
ar
Continua
Mc
Gra
w
Hill
New
Y
ork
	

JT
Oden
and
GF
Carey

Finite
Elements
Mathematic
al
Asp
e
cts
v
olume
IV
Pren
tice
Hall
Englew
o
o
d
Clis
	

DRJ
Ow
en
and
E
Hin
ton
Finite
Elements
in
PlasticityThe
ory
and
Pr
actic
e
Pineridge
Sw
ansea
	

DD
Reddy
and
BD
Reddy

Intr
o
ductory
F
unctional
A
nalysis
With
Applic
ations
to
Boundary
V
alue
Pr
oblems
and
Finite
Elements
Num
b
er

in
T
exts
in
Applied
Mathematics
Springer
V
erlag
Berlin
		

JN
Reddy

The
Finite
Element
Metho
d
in
He
at
T
r
ansfer
and
Fluid
Dynamics
CR
C
Bo
ca
Raton
		

C
Sc
h
w
ab
P
A
nd
Hp
Finite
Element
Metho
ds
The
ory
and
Applic
ations
in
Solid
and
Fluid
Me
chanics
Numerical
Mathematics
and
Scien
tic
Computation
Claren
don
London
			

G
Strang
and
G
Fix
A
nalysis
of
the
Finite
Element
Metho
d
Pren
tice
Hall
En
glew
o
o
d
Clis
	

B
Szab
o
and
I
Babu

sk
a
Finite
Element
A
nalysis
John
Wiley
and
Sons
New
Y
ork
		
	
F
Thomasset
Implementation
of
Finite
Element
Metho
ds
for
NavierStokes
Equa
tions
Springer
Series
in
Computational
Ph
ysics
Springer
V
erlag
New
Y
ork
	
ix


V
Thom

ee
Galerkin
Finite
Element
Metho
ds
for
Par
ab
olic
Pr
oblems
Num
b
er

in
Lecture
Notes
in
Mathematics
Springer
V
erlag
Berlin
	

R
V
erf

urth
A
R
eview
of
Posteriori
Err
or
Estimation
and
A
daptive
Mesh
R
enement
T
e
chniques
T
eubner
Wiley

Stuttgart
		

R
Vic
hev
etsky

Computer
Metho
ds
for
Partial
Dier
ential
Equations
El
liptic
Equa
tions
and
the
FiniteElement
Metho
d
v
olume

Pren
tice
Hall
Englew
o
o
d
Clis
	

R
W
ait
and
AR
Mitc
hell
The
Finite
Element
A
nalysis
and
Applic
ations
John
Wiley
and
Sons
Chic
hester
	

RE
White
A
n
Intr
o
duction
to
the
Finite
Element
Metho
d
with
Applic
ations
to
Nonline
ar
Pr
oblems
John
Wiley
and
Sons
New
Y
ork
	

JR
Whiteman
editor
The
Mathematics
of
Finite
Elements
and
Applic
ations
V
MAFELAP
	
London
	
Academic
Press

JR
Whiteman
editor
The
Mathematics
of
Finite
Elements
and
Applic
ations
VI
MAFELAP
	
London
	
Academic
Press

OC
Zienkiewicz
The
Finite
Element
Metho
d
Mc
Gra
w
Hill
New
Y
ork
third
edition
	

OC
Zienkiewicz
and
RL
T
a
ylor
Finite
Element
Metho
d
Solid
and
Fluid
Me
chan
ics
Dynamics
and
NonLine
arity
Mc
Gra
w
Hill
New
Y
ork
		
x

Chapter

In
tro
duction

Historical
P
ersp
ectiv
e
The
nite
elemen
t
metho
d
is
a
computational
tec
hnique
for
obtaining
appro
ximate
solu
tions
to
the
partial
dieren
tial
equations
that
arise
in
scien
tic
and
engineering
applica
tions
Rather
than
appro
ximating
the
partial
dieren
tial
equation
directly
as
with
eg
nite
dierence
metho
ds
the
nite
elemen
t
metho
d
utilizes
a
variational
pr
oblem
that
in
v
olv
es
an
in
tegral
of
the
dieren
tial
equation
o
v
er
the
problem
domain
This
domain
is
divided
in
to
a
n
um
b
er
of
sub
domains
called
nite
elements
and
the
solution
of
the
partial
dieren
tial
equation
is
appro
ximated
b
y
a
simpler
p
olynomial
function
on
eac
h
elemen
t
These
p
olynomials
ha
v
e
to
b
e
pieced
together
so
that
the
appro
ximate
solution
has
an
appropriate
degree
of
smo
othness
o
v
er
the
en
tire
domain
Once
this
has
b
een
done
the
v
ariational
in
tegral
is
ev
aluated
as
a
sum
of
con
tributions
from
eac
h
nite
el
emen
t
The
result
is
an
algebraic
system
for
the
appro
ximate
solution
ha
ving
a
nite
size
rather
than
the
original
innitedimensional
partial
dieren
tial
equation
Th
us
lik
e
nite
dierence
metho
ds
the
nite
elemen
t
pro
cess
has
discr
etize
d
the
partial
dieren
tial
equation
but
unlik
e
nite
dierence
metho
ds
the
appro
ximate
solution
is
kno
wn
throughout
the
domain
as
a
pieceise
p
olynomial
function
and
not
just
at
a
set
of
p
oin
ts
Logan

	
attributes
the
disco
v
ery
of
the
nite
elemen
t
metho
d
to
Hrennik
of
	
and
McHenry

	
who
decomp
osed
a
t
w
odimensional
problem
domain
in
to
an
assem
bly
of
onedimensional
bars
and
b
eams
In
a
pap
er
that
w
as
not
recognized
for
sev
eral
y
ears
Couran
t
	
used
a
variational
formulation
to
describ
e
a
partial
dieren
tial
equation
with
a
piecewise
linear
p
olynomial
appro
ximation
of
the
solution
relativ
e
to
a
decomp
osition
of
the
problem
domain
in
to
triangular
elemen
ts
to
solv
e
equilibrium
and
vibration
problems
This
is
essen
tially
the
mo
dern
nite
elemen
t
metho
d
and
represen
ts
the
rst
application
where
the
elemen
ts
w
ere
pieces
of
a
con
tin
uum
rather
than
structural
mem
b
ers
T
urner
et
al
	
wrote
a
seminal
pap
er
on
the
sub
ject
that
is
widely
regarded



In
tro
duction
as
the
b
eginning
of
the
nite
elemen
t
era
They
sho
w
ed
ho
w
to
solv
e
one
and
t
w
o
dimensional
problems
using
actual
structural
elemen
ts
and
triangular
and
rectangular
elemen
t
decomp
ositions
of
a
con
tin
uum
Their
timing
w
as
b
etter
than
Couran
ts
	
since
success
of
the
nite
elemen
t
metho
d
is
dep
enden
t
on
digital
computation
whic
h
w
as
emerging
in
the
late
	s
The
concept
w
as
extended
to
more
complex
problems
suc
h
as
plate
and
shell
deformation
cf
the
historical
discussion
in
Logan
	
Chapter

and
it
has
no
w
b
ecome
one
of
the
most
imp
ortan
t
n
umerical
tec
hniques
for
solving
partial
dieren
tial
equations
It
has
a
n
um
b
er
of
adv
an
tages
relativ
e
to
other
metho
ds
including

the
treatmen
t
of
problems
on
complex
irregular
regions

the
use
of
non
uniform
meshes
to
reect
solution
gradations

the
treatmen
t
of
b
oundary
conditions
in
v
olving
uxes
and

the
construction
of
highorder
appro
ximations
Originally
used
for
steady
elliptic
problems
the
nite
elemen
t
metho
d
is
no
w
used
to
solv
e
transien
t
parab
olic
and
h
yp
erb
olic
problems
Estimates
of
discretization
errors
ma
y
b
e
obtained
for
reasonable
costs
These
are
b
eing
used
to
v
erify
the
accuracy
of
the
computation
and
also
to
con
trol
an
adaptiv
e
pro
cess
whereb
y
meshes
are
automatically
rened
and
coarsened
andor
the
degrees
of
p
olynomial
appro
ximations
are
v
aried
so
as
to
compute
solutions
to
desired
accuracies
in
an
optimal
fashion







	

W
eigh
ted
Residual
Metho
ds
Our
goal
in
this
in
tro
ductory
c
hapter
is
to
in
tro
duce
the
basic
principles
and
to
ols
of
the
nite
elemen
t
metho
d
using
a
linear
t
w
op
oin
t
b
oundary
v
alue
problem
of
the
form
Lu	


d
dx
px
du
dx


q
xu

f
x


x


a
u

u


b
The
nite
elemen
t
metho
d
is
primarily
used
to
address
partial
dieren
tial
equations
and
is
hardly
used
for
t
w
op
oin
t
b
oundary
v
alue
problems
By
fo
cusing
on
this
problem
w
e
hop
e
to
in
tro
duce
the
fundamen
tal
concepts
without
the
geometric
complexities
encoun
tered
in
t
w
o
and
three
dimensions
Problems
lik
e

arise
in
man
y
situations
including
the
longitudinal
deformation
of
an
elastic
ro
d
steady
heat
conduction
and
the
transv
erse
deection
of
a
supp
orted


W
eigh
ted
Residual
Metho
ds

cable
In
the
latter
case
for
example
ux
represen
ts
the
lateral
deection
at
p
osition
x
of
a
cable
ha
ving
scaled
unit
length
that
is
sub
jected
to
a
tensile
force
p
loaded
b
y
a
transv
erse
force
p
er
unit
length
f
x
and
supp
orted
b
y
a
series
of
springs
with
elastic
mo
dulus
q
Figure

The
situation
resem
bles
the
cable
of
a
susp
ension
bridge
The
tensile
force
p
is
indep
enden
t
of
x
for
the
assumed
small
deformations
of
this
mo
del
but
the
applied
loading
and
spring
mo
duli
could
v
ary
with
p
osition








q(x)
u(x)
x
p
p
f(x)
Figure

Deection
u
of
a
cable
under
tension
p
loaded
b
y
a
force
f
p
er
unit
length
and
supp
orted
b
y
springs
ha
ving
elastic
mo
dulus
q

Mathematically

w
e
will
assume
that
px
is
p
ositiv
e
and
con
tin
uously
dieren
tiable
for
x


	
q
x
is
nonnegativ
e
and
con
tin
uous
on

	
and
f
x
is
con
tin
uous
on

	
Ev
en
problems
of
this
simplicit
y
cannot
generally
b
e
solv
ed
in
terms
of
kno
wn
func
tions
th
us
the
rst
topic
on
our
agenda
will
b
e
the
dev
elopmen
t
of
a
means
of
calculating
appro
ximate
solutions
of

With
nite
dierence
tec
hniques
deriv
ativ
es
in
a
are
appro
ximated
b
y
nite
dierences
with
resp
ect
to
a
mesh
in
tro
duced
on

	
	
With
the
nite
elemen
t
metho
d
the
metho
d
of
weighte
d
r
esiduals
MWR
is
used
to
construct
an
in
tegral
form
ulation
of

called
a
variational
pr
oblem
T
o
this
end
let
us
m
ultiply
a
b
y
a
test
or
weight
function
v
and
in
tegrate
o
v
er


to
obtain
v

Lu	

f



a
W
e
ha
v
e
in
tro
duced
the
L

inner
pr
o
duct
v

u

Z


v
udx
b
to
represen
t
the
in
tegral
of
a
pro
duct
of
t
w
o
functions
The
solution
of

is
also
a
solution
of
a
for
all
functions
v
for
whic
h
the
inner
pro
duct
exists
W
ell
express
this
requiremen
t
b
y
writing
v

L



All
functions
of
class
L



are
square
in
tegrable
on


th
us
v

v

exists
With
this
viewp
oin
t
and
notation
w
e
write
a
more
precisely
as
v

Lu	

f



v

L



c


In
tro
duction
Equation
c
is
referred
to
as
a
variational
form
of
problem

The
reason
for
this
terminology
will
b
ecome
clearer
as
w
e
dev
elop
the
topic
Using
the
metho
d
of
w
eigh
ted
residuals
w
e
construct
appro
ximate
solutions
b
y
re
placing
u
and
v
b
y
simpler
functions
U
and
V
and
solving
c
relativ
e
to
these
c
hoices
Sp
ecically

w
ell
consider
appro
ximations
of
the
form
ux

U
x

N
X
j

c
j

j
x
a
v
x

V
x

N
X
j

d
j

j
x
b
The
functions

j
x
and

j
x
j







N

are
preselected
and
our
goal
is
to
determine
the
co
ecien
ts
c
j

j







N

so
that
U
is
a
go
o
d
appro
ximation
of
u
F
or
example
w
e
migh
t
select

j
x


j
x

sin
j

x
j







N

to
obtain
appro
ximations
in
the
form
of
discrete
F
ourier
series
In
this
case
ev
ery
function
satises
the
b
oundary
conditions
b
whic
h
seems
lik
e
a
go
o
d
idea
The
appro
ximation
U
is
called
a
trial
function
and
as
noted
V
is
called
a
test
func
tion
Since
the
dieren
tial
op
erator
Lu	
is
second
order
w
e
migh
t
exp
ect
u

C



Actually

u
can
b
e
sligh
tly
less
smo
oth
but
C

will
suce
for
the
presen
t
discussion
Th
us
its
natural
to
exp
ect
U
to
also
b
e
an
elemen
t
of
C



Mathematically

w
e
re
gard
U
as
b
elonging
to
a
nitedimensional
function
space
that
is
a
subspace
of
C



W
e
express
this
condition
b
y
writing
U

S
N



C



The
restriction
of
these
functions
to
the
in
terv
al


x


will
henceforth
b
e
understo
o
d
and
w
e
will
no
longer
write
the


With
this
in
terpretation
w
ell
call
S
N
the
trial
sp
ac
e
and
regard
the
preselected
functions

j
x
j







N

as
forming
a
b
asis
for
S
N

Lik
ewise
since
v

L


w
ell
regard
V
as
b
elonging
to
another
nitedimensional
function
space

S
N
called
the
test
sp
ac
e
Th
us
V


S
N

L

and

j
x
j







N

pro
vide
a
basis
for

S
N

No
w
replacing
v
and
u
in
c
b
y
their
appro
ximations
V
and
U

w
e
ha
v
e
V

LU
	

f



V


S
N

a
The
r
esidual
r
x

LU
	

f
x
b


W
eigh
ted
Residual
Metho
ds

is
apparen
t
and
claries
the
name
metho
d
of
w
eigh
ted
residuals
The
v
anishing
of
the
inner
pro
duct
a
implies
that
the
residual
is
orthogonal
in
L

to
all
functions
V
in
the
test
space

S
N

Substituting

in
to
a
and
in
terc
hanging
the
sum
and
in
tegral
yields
N
X
j

d
j

j

LU
	

f



d
j

j







N


Ha
ving
selected
the
basis

j

j







N

the
requiremen
t
that
a
b
e
satised
for
all
V


S
N
implies
that

b
e
satised
for
all
p
ossible
c
hoices
of
d
k

k







N

This
in
turn
implies
that

j

LU
	

f



j







N


Shortly

b
y
example
w
e
shall
see
that

represen
ts
a
linear
algebraic
system
for
the
unkno
wn
co
ecien
ts
c
k

k







N

One
ob
vious
c
hoice
is
to
select
the
test
space

S
N
to
b
e
the
same
as
the
trial
space
and
use
the
same
basis
for
eac
h
th
us

k
x


k
x
k







N

This
c
hoice
leads
to
Galerkin
s
metho
d

j

Lu	

f



j







N


whic
h
in
a
sligh
tly
dieren
t
form
will
b
e
our
w
ork
horse
With

j

C


j







N

the
test
space
clearly
has
more
con
tin
uit
y
than
necessary

In
tegrals
lik
e

or

exist
for
some
prett
y
wild
c
hoices
of
V

V
alid
metho
ds
exist
when
V
is
a
Dir
ac
delta
function
although
suc
h
functions
are
not
elemen
ts
of
L


and
when
V
is
a
piecewise
constan
t
function
cf
Problems

and

at
the
end
of
this
section
There
are
man
y
reasons
to
prefer
a
more
symmetric
v
ariational
form
of

than

eg
problem

is
symmetric
selfadjoin
t
and
the
v
ariational
form
should
reect
this
Additionally

w
e
migh
t
w
an
t
to
c
ho
ose
the
same
trial
and
test
spaces
as
with
Galerkins
metho
d
but
ask
for
less
con
tin
uit
y
on
the
trial
space
S
N

This
is
t
ypically
the
case
As
w
e
shall
see
it
will
b
e
dicult
to
construct
con
tin
uously
dieren
tiable
appro
ximations
of
nite
elemen
t
t
yp
e
in
t
w
o
and
three
dimensions
W
e
can
construct
the
symmetric
v
ariational
form
that
w
e
need
b
y
in
tegrating
the
second
deriv
ativ
e
terms
in
a
b
y
parts
th
us
using
a
Z


v
pu




q
u

f
	dx

Z


v

pu


v
q
u

v
f
dx

v
pu

j





where




d
dx
The
treatmen
t
of
the
last
b
oundary
term
will
need
greater
atten
tion
F
or
the
momen
t
let
v
satisfy
the
same
trivial
b
oundary
conditions
b
as


In
tro
duction
u
In
this
case
the
b
oundary
term
v
anishes
and

b
ecomes
Av

u

v

f



	a
where
Av

u

Z


v

pu


v
q
udx
	b
The
in
tegration
b
y
parts
has
eliminated
second
deriv
ativ
e
terms
from
the
form
ulation
Th
us
solutions
of
	
migh
t
ha
v
e
less
con
tin
uit
y
than
those
satisfying
either

or

F
or
this
reason
they
are
called
we
ak
solutions
in
con
trast
to
the
str
ong
solutions
of

or

W
eak
solutions
ma
y
lac
k
the
con
tin
uit
y
to
b
e
strong
solutions
but
strong
solutions
are
alw
a
ys
w
eak
solutions
In
situations
where
w
eak
and
strong
solutions
dier
the
w
eak
solution
is
often
the
one
of
ph
ysical
in
terest
Since
w
ev
e
added
a
deriv
ativ
e
to
v
b
y
the
in
tegration
b
y
parts
v
m
ust
b
e
restricted
to
a
space
where
functions
ha
v
e
more
con
tin
uit
y
than
those
in
L


Ha
ving
symmetry
in
mind
w
e
will
select
functions
u
and
v
that
pro
duce
b
ounded
v
alues
of
Au
u

Z


pu




q
u

	dx
Actually

since
p
and
q
are
smo
oth
functions
it
suces
for
u
and
v
to
ha
v
e
b
ounded
v
alues
of
Z


u




u

	dx

F
unctions
where

exists
are
said
to
b
e
elemen
ts
of
the
Sob
olev
space
H


W
ev
e
also
required
that
u
and
v
satisfy
the
b
oundary
conditions
b
W
e
iden
tify
those
functions
in
H

that
also
satisfy
b
as
b
eing
elemen
ts
of
H



Th
us
in
summary

the
v
ariational
problem
consists
of
determining
u

H


suc
h
that
Av

u

v

f

v

H




The
bilinear
form
Av

u
is
called
the
str
ain
ener
gy
In
mec
hanical
systems
it
frequen
tly
corresp
onds
to
the
stored
or
in
ternal
energy
in
the
system
W
e
obtain
appro
ximate
solutions
of

in
the
manner
describ
ed
earlier
for
the
more
general
metho
d
of
w
eigh
ted
residuals
Th
us
w
e
replace
u
and
v
b
y
their
appro
xi
mations
U
and
V
according
to

Both
U
and
V
are
regarded
as
b
elonging
to
the
same
nitedimensional
subspace
S
N

of
H


and

j

j







N

forms
a
basis
for
S
N


Th
us
U
is
determined
as
the
solution
of
AV

U


V

f

V

S
N


a


W
eigh
ted
Residual
Metho
ds

The
substitution
of
b
with

j
replaced
b
y

j
in
a
again
rev
eals
the
more
explicit
form
A
j

U



j

f

j







N

b
Finally

to
mak
e
b
totally
explicit
w
e
eliminate
U
using
a
and
in
terc
hange
a
sum
and
in
tegral
to
obtain
N
X
k

c
k
A
j


k



j

f

j







N

c
Th
us
the
co
ecien
ts
c
k

k







N

of
the
appro
ximate
solution
a
are
deter
mined
as
the
solution
of
the
linear
algebraic
equation
c
Dieren
t
c
hoices
of
the
basis

j

j







N

will
mak
e
the
in
tegrals
in
v
olv
ed
in
the
strain
energy
	b
and
L

inner
pro
duct
b
easy
or
dicult
to
ev
aluate
They
also
aect
the
accuracy
of
the
appro
ximate
solution
An
example
using
a
nite
elemen
t
basis
is
presen
ted
in
the
next
section
Problems

Consider
the
v
ariational
form

and
select

j
x


x

x
j

j







N

where

x
is
the
Dirac
delta
function
satisfying

x


x


Z



xdx


and


x


x






x
N


Sho
w
that
this
c
hoice
of
test
function
leads
to
the
c
ol
lo
c
ation
metho
d
LU
	

f
xj
xx
j


j







N

Th
us
the
dieren
tial
equation

is
satised
exactly
at
N
distinct
p
oin
ts
on



The
sub
domain
metho
d
uses
piecewise
con
tin
uous
test
functions
ha
ving
the
basis

j
x



if
x

x
j


x
j



otherwise

where
x
j


x
j

x
j


Using

sho
w
that
the
appro
ximate
solution
U
x
satises
the
dieren
tial
equation
a
on
the
a
v
erage
on
eac
h
subin
terv
al
x
j


x
j


j







N



In
tro
duction

Consider
the
t
w
op
oin
t
b
oundary
v
alue
problem
u


u

x


x


u

u


whic
h
has
the
exact
solution
ux

x

sinh
x
sinh


Solv
e
this
problem
using
Galerkins
metho
d
c
using
the
trial
function
U
x

c

sin

x
Th
us
N




x



x

sin

x
in

Calculate
the
error
in
strain
energy
as
Au
u

AU
U

where
Au
v

is
giv
en
b
y
	b

A
Simple
Finite
Elemen
t
Problem
Finite
elemen
t
metho
ds
are
w
eigh
ted
residuals
metho
ds
that
use
bases
of
piecewise
p
oly
nomials
ha
ving
small
supp
ort
Th
us
the
functions
x
and

x
of


are
nonzero
only
on
a
small
p
ortion
of
problem
domain
Since
con
tin
uit
y
ma
y
b
e
dicult
to
imp
ose
bases
will
t
ypically
use
the
minim
um
con
tin
uit
y
necessary
to
ensure
the
existence
of
in
tegrals
and
solution
accuracy

The
use
of
piecewise
p
olynomial
functions
simplify
the
ev
aluation
of
in
tegrals
in
v
olv
ed
in
the
L

inner
pro
duct
and
strain
energy
b
	b
and
help
automate
the
solution
pro
cess
Cho
osing
bases
with
small
supp
ort
leads
to
a
sparse
w
ellconditioned
linear
algebraic
system
c
for
the
solution
Let
us
illustrate
the
nite
elemen
t
metho
d
b
y
solving
the
t
w
op
oin
t
b
oundary
v
alue
problem

with
constan
t
co
ecien
ts
ie
pu


q
u

f
x


x


u

u



where
p
	

and
q


As
describ
ed
in
Section

w
e
construct
a
v
ariational
form
of

using
Galerkins
metho
d

F
or
this
constan
tco
ecien
t
problem
w
e
seek
to
determine
u

H


satisfying
Av

u

v

f

v

H



a
where
v

u

Z


v
udx
b
Av

u

Z


v

pu


v
q
udx
c


A
Simple
Finite
Elemen
t
Problem
	
With
u
and
v
b
elonging
to
H



w
e
are
sure
that
the
in
tegrals
bc
exist
and
that
the
trivial
b
oundary
conditions
are
satised
W
e
will
subsequen
tly
sho
w
that
functions
of
one
v
ariable
b
elonging
to
H

m
ust
necessarily
b
e
con
tin
uous
Accepting
this
for
the
momen
t
let
us
establish
the
goal
of
nding
the
simplest
con
tin
uous
piecewise
p
olynomial
appro
ximations
of
u
and
v

This
w
ould
b
e
a
piecewise
linear
p
olynomial
with
resp
ect
to
a
mesh


x


x






x
N



in
tro
duced
on

	
Eac
h
subin
terv
al
x
j


x
j

j







N

is
called
a
nite
element
The
basis
is
created
from
the
hat
function

j
x






xx
j

x
j
x
j


if
x
j

	
x

x
j
x
j

x
x
j

x
j

if
x
j
	
x

x
j


otherwise

a
x
x
x
x
1
x
j
j-1
0
j+1
j (x)
N
x
φ
Figure

Onedimensional
nite
elemen
t
mesh
and
piecewise
linear
hat
function

j
x
As
sho
wn
in
Figure


j
x
is
nonzero
only
on
the
t
w
o
elemen
ts
con
taining
the
no
de
x
j

It
rises
and
descends
linearly
on
these
t
w
o
elemen
ts
and
has
a
maximal
unit
v
alue
at
x

x
j

Indeed
it
v
anishes
at
all
no
des
but
x
j

ie

j
x
k



j
k



if
x
k

x
j

otherwise

b
Using
this
basis
with

w
e
consider
appro
ximations
of
the
form
U
x

N

X
j

c
j

j
x

Lets
examine
this
result
more
closely



In
tro
duction
x
x
x
x
x
x
j
j-1
0
j+1
N
φj (x)
φj-1 (x)
c
c
j
j-1
j+1
c
1
U(x)
Figure

Piecewise
linear
nite
elemen
t
solution
U
x

Since
eac
h

j
x
is
a
con
tin
uous
piecewise
linear
function
of
x
their
summation
U
is
also
con
tin
uous
and
piecewise
linear
Ev
aluating
U
at
a
no
de
x
k
of
the
mesh
using
b
yields
U
x
k


N

X
j

c
j

j
x
k


c
k

Th
us
the
co
ecien
ts
c
k

k







N


are
the
v
alues
of
U
at
the
in
terior
no
des
of
the
mesh
Figure


By
selecting
the
lo
w
er
and
upp
er
summation
indices
as

and
N


w
e
ha
v
e
ensured
that

satises
the
prescrib
ed
b
oundary
conditions
U


U



As
an
alternativ
e
w
e
could
ha
v
e
added
basis
elemen
ts


x
and

N
x
to
the
appro
ximation
and
written
the
nite
elemen
t
solution
as
U
x

N
X
j

c
j

j
x

Since
using
b
U
x



c

and
U
x
N


c
N

the
b
oundary
conditions
are
satised
b
y
requiring
c


c
N


Th
us
the
represen
tations

or

are
iden
tical
ho
w
ev
er

w
ould
b
e
useful
with
nontrivial
b
oundary
data

The
restriction
of
the
nite
elemen
t
solution

or

to
the
elemen
t
x
j


x
j
	
is
the
linear
function
U
x

c
j


j

x

c
j

j
x
x

x
j


x
j
	



A
Simple
Finite
Elemen
t
Problem

since

j

and

j
are
the
only
nonzero
basis
elemen
ts
on
x
j


x
j
	
Figure

Using
Galerkins
metho
d
in
the
form
c
w
e
ha
v
e
to
solv
e
N

X
k

c
k
A
j


k



j

f

j







N



Equation

can
b
e
ev
aluated
in
a
straigh
tforw
ard
manner
b
y
substituting
replacing

k
and

j
using

and
ev
aluating
the
strain
energy
and
L

inner
pro
duct
according
to
bc
This
dev
elopmen
t
is
illustrated
in
sev
eral
texts
eg
		
Section

W
ell
tak
e
a
sligh
tly
more
complex
path
to
the
solution
in
order
to
fo
cus
on
the
computer
implemen
tation
of
the
nite
elemen
t
metho
d
Th
us
write
a
as
the
summation
of
con
tributions
from
eac
h
elemen
t
N
X
j

A
j
V

U


V

f

j
	


V

S
N


	a
where
A
j
V

U


A
S
j
V

U


A
M
j
V

U

	b
A
S
j
V

U


Z
x
j
x
j

pV

U

dx
	c
A
M
j
V

U


Z
x
j
x
j

q
V
U
dx
	d
V

f

j

Z
x
j
x
j

V
f
dx
	e
It
is
customary
to
divide
the
strain
energy
in
to
t
w
o
parts
with
A
S
j
arising
from
in
ternal
energies
and
A
M
j
arising
from
inertial
eects
or
sources
of
energy

Matrices
are
simple
data
structures
to
manipulate
on
a
computer
so
let
us
write
the
restriction
of
U
x
to
x
j


x
j
	
according
to

as
U
x

c
j


c
j
	


j

x

j
x



j

x

j
x	

c
j

c
j


x

x
j


x
j
	
a
W
e
can
lik
ewise
use
b
to
write
the
restriction
of
the
test
function
V
x
to
x
j


x
j
	
in
the
same
form
V
x

d
j


d
j
	


j

x

j
x



j

x

j
x	

d
j

d
j


x

x
j


x
j
	
b


In
tro
duction
Our
task
is
to
substitute

in
to
	ce
and
ev
aluate
the
in
tegrals
Let
us
b
egin
b
y
dieren
tiating
a
while
using
a
to
obtain
U

x

c
j


c
j
	

h
j
h
j


h
j

h
j
	

c
j

c
j


x

x
j


x
j
	
a
where
h
j

x
j

x
j


j







N

b
Th
us
U

x
is
constan
t
on
x
j


x
j
	
and
is
giv
en
b
y
the
rst
divide
d
dier
enc
e
U

x

c
j

c
j

h
j

x

x
j


x
j
	
Substituting

and
a
similar
expression
for
V

x
in
to
	b
yields
A
S
j
V

U


Z
x
j
x
j

pd
j


d
j
	

h
j
h
j

h
j

h
j
	

c
j

c
j

dx
or
A
S
j
V

U


d
j


d
j
	

Z
x
j
x
j

p

h

j
h

j
h

j
h

j

dx
	

c
j

c
j


The
in
tegrand
is
constan
t
and
can
b
e
ev
aluated
to
yield
A
S
j
V

U


d
j


d
j
	K
j

c
j

c
j


K
j

p
h
j








The



matrix
K
j
is
called
the
element
stiness
matrix
It
dep
ends
on
j
through
h
j

but
w
ould
also
ha
v
e
suc
h
dep
endence
if
p
v
aried
with
x
The
k
ey
observ
ation
is
that
K
j
can
b
e
ev
aluated
without
kno
wing
c
j


c
j

d
j


or
d
j
and
this
greatly
simplies
the
automation
of
the
nite
elemen
t
metho
d
The
ev
aluation
of
A
M
j
pro
ceeds
similarly
b
y
substituting

in
to
	d
to
obtain
A
M
j
V

U


Z
x
j
x
j

q
d
j


d
j
	


j


j


j



j
	

c
j

c
j

dx
With
q
a
constan
t
the
in
tegrand
is
a
quadratic
p
olynomial
in
x
that
ma
y
b
e
in
tegrated
exactly
cf
Problem

at
the
end
of
this
section
to
yield
A
M
j
V

U


d
j


d
j
	M
j

c
j

c
j


M
j

q
h
j









where
M
j
is
called
the
element
mass
matrix
b
ecause
as
noted
it
often
arises
from
inertial
loading


A
Simple
Finite
Elemen
t
Problem

The
nal
in
tegral
	e
cannot
b
e
ev
aluated
exactly
for
arbitrary
functions
f
x
Without
examining
this
matter
carefully

let
us
appro
ximate
it
b
y
its
linear
in
terp
olan
t
f
x

f
j


j

x

f
j

j
x
x

x
j


x
j
	

where
f
j

f
x
j

Substituting

and
b
in
to
	e
and
ev
aluating
the
in
tegral
yields
V

f

j

Z
x
j
x
j

d
j


d
j
	


j


j


j



j
	

f
j

f
j

dx

d
j


d
j
	l
j
a
where
l
j

h
j


f
j


f
j
f
j


f
j


b
The
v
ector
l
j
is
called
the
element
lo
ad
ve
ctor
and
is
due
to
the
applied
loading
f
x
The
next
step
in
the
pro
cess
is
the
substitution
of


and

in
to
	a
and
the
summation
o
v
er
the
elemen
ts
Since
this
our
rst
example
w
ell
simplify
matters
b
y
making
the
mesh
uniform
with
h
j

h


N

j







N

and
summing
A
S
j

A
M
j

and
V

f

j
separately

Th
us
summing

N
X
j

A
S
j

N
X
j

d
j


d
j
	
p
h







c
j

c
j


The
rst
and
last
con
tributions
ha
v
e
to
b
e
mo
died
b
ecause
of
the
b
oundary
conditions
whic
h
as
noted
prescrib
e
c


c
N

d


d
N


Th
us
N
X
j

A
S
j

d

	
p
h
	c

	

d


d

	
p
h







c

c






d
N


d
N

	
p
h







c
N

c
N



d
N

	
p
h
	c
N

	
Although
this
form
of
the
summation
can
b
e
readily
ev
aluated
it
obscures
the
need
for
the
matrices
and
complicates
implemen
tation
issues
Th
us
at
the
risk
of
further
complexit
y

w
ell
expand
eac
h
matrix
and
v
ector
to
dimension
N


and
write
the
summation
as
N
X
k

A
S
j

d


d






d
N

	
p
h


















c

c




c
N








In
tro
duction
d


d






d
N

	
p
h





















c

c




c
N











d


d






d
N

	
p
h





















c

c




c
N






d


d





d
N

	
p
h


















c

c




c
N






Zero
elemen
ts
of
the
matrices
ha
v
e
not
b
een
sho
wn
for
clarit
y

With
all
matrices
and
v
ectors
ha
ving
the
same
dimension
the
summation
is
N
X
j

A
S
j

d
T
Kc
a
where
K

p
h









































b
c

c


c






c
N

	
T

c
d

d


d






d
N

	
T

d
The
matrix
K
is
called
the
glob
al
stiness
matrix
It
is
symmetric
p
ositiv
e
denite
and
tridiagonal
In
the
form
that
w
e
ha
v
e
dev
elop
ed
the
results
the
summation
o
v
er
elemen
ts
is
regarded
as
an
assembly
pro
cess
where
the
elemen
t
stiness
matrices
are
added
in
to
their
prop
er
places
in
the
global
stiness
matrix
It
is
not
necessary
to
actually
extend
the
dimensions
of
the
elemen
t
matrices
to
those
of
the
global
stiness
matrix
As
indicated
in
Figure

the
elemen
tal
indices
determine
the
prop
er
lo
cation
to
add
a
lo
cal
matrix
in
to
the
global
matrix
Th
us
the



elemen
t
stiness
matrix
K
j
is
added
to
ro
ws


A
Simple
Finite
Elemen
t
Problem

A
S


d

p
h
	
z
c

A
S


d


d

	
p
h







z


c

c


A
S


d


d

	
p
h







z


c

c


K

p
h































Figure

Assem
bly
of
the
rst
three
elemen
t
stiness
matrices
in
to
the
global
stiness
matrix
j


and
j
and
columns
j


and
j

Some
mo
dications
are
needed
for
the
rst
and
last
elemen
ts
to
accoun
t
for
the
b
oundary
conditions
The
summations
of
A
M
j
and
V

f

j
pro
ceed
in
the
same
manner
and
using

and

w
e
obtain
N
X
j

A
M
j

d
T
Mc
a
N
X
j

V

f

j

d
T
l
b
where
M

q
h



































c
l

h






f


f


f

f


f


f




f
N


f
N


f
N






d


In
tro
duction
The
matrix
M
and
the
v
ector
l
are
called
the
glob
al
mass
matrix
and
glob
al
lo
ad
ve
ctor
resp
ectiv
ely

Substituting
a
and
ab
in
to
	ab
giv
es
d
T
K

Mc

l	



As
noted
in
Section

the
requiremen
t
that
	a
hold
for
al
l
V

S
N

is
equiv
alen
t
to
satisfying

for
all
c
hoices
of
d
This
is
only
p
ossible
when
K

Mc

l
	
Th
us
the
no
dal
v
alues
c
k

k







N


of
the
nite
elemen
t
solution
are
deter
mined
b
y
solving
a
linear
algebraic
system
With
c
kno
wn
the
piecewise
linear
nite
elemen
t
U
can
b
e
ev
aluated
for
an
y
x
using
a
The
matrix
K

M
is
symmetric
p
ositiv
e
denite
and
tridiagonal
Suc
h
systems
ma
y
b
e
solv
ed
b
y
the
tridiagonal
algo
rithm
cf
Problem

at
the
end
of
this
section
in
O
N

op
erations
where
an
op
eration
is
a
scalar
m
ultiply
follo
w
ed
b
y
an
addition
The
discrete
system
	
is
similar
to
the
one
that
w
ould
b
e
obtained
from
a
cen
tered
nite
dierence
appro
ximation
of

whic
h
is

	
K

D

c


l

a
where
D

q
h


















l

h





f

f




f
N








c







c


c





c
N







b
Th
us
the
q
u
and
f
terms
in

are
appro
ximated
b
y
diagonal
matrices
with
the
nite
dierence
metho
d
In
the
nite
elemen
t
metho
d
they
are
smo
othed
b
y
coupling
diagonal
terms
with
their
nearest
neigh
b
ors
using
Simpsons
rule
w
eigh
ts
The
diagonal
matrix
D
is
sometimes
called
a
lump
ed
appro
ximation
of
the
c
onsistent
mass
matrix
M
Both
nite
dierence
and
nite
elemen
t
solutions
b
eha
v
e
similarly
for
the
presen
t
problem
and
ha
v
e
the
same
order
of
accuracy
at
the
no
des
of
a
uniform
mesh
Example

Consider
the
nite
elemen
t
solution
of
u


u

x


x


u

u


whic
h
has
the
exact
solution
ux

x

sinh
x
sinh




A
Simple
Finite
Elemen
t
Problem

Relativ
e
to
the
more
general
problem

this
example
has
p

q


and
f
x

x
W
e
solv
e
it
using
the
piecewiselinear
nite
elemen
t
metho
d
dev
elop
ed
in
this
section
on
uniform
meshes
with
spacing
h


N
for
N








Before
presen
ting
results
it
is
w
orth
while
men
tioning
that
the
load
v
ector

is
exact
for
this
example
Ev
en
though
w
e
replaced
f
x
b
y
its
piecewise
linear
in
terp
olan
t
according
to

this
in
tro
duced
no
error
since
f
x
is
a
linear
function
of
x
Letting
ex

ux

U
x

denote
the
discr
etization
err
or
in
T
able

w
e
displa
y
the
maxim
um
error
of
the
nite
elemen
t
solution
and
of
its
rst
deriv
ativ
e
at
the
no
des
of
a
mesh
ie
jej


max
j
N
jex
j
j
je

j


max
j
N
je

x

j
j

W
e
ha
v
e
seen
that
U

x
is
a
piecewise
constan
t
function
with
jumps
at
no
des
Data
in
T
able

w
ere
obtained
b
y
using
deriv
ativ
es
from
the
left
ie
x

j

lim

x
j



With
this
in
terpretation
the
results
of
second
and
fourth
columns
of
T
able

indicate
that
jej

h

and
je

j

h
are
essen
tially
constan
ts
hence
w
e
ma
y
conclude
that
jej


O
h


and
je

j


O
h
N
jej

jej

h

je

j

je

j

h

	







	










	




	



	
	
T
able

Maxim
um
no
dal
errors
of
the
piecewiselinear
nite
elemen
t
solution
and
its
deriv
ativ
e
for
Example

Num
b
ers
in
paren
thesis
indicate
a
p
o
w
er
of

The
nite
elemen
t
and
exact
solutions
of
this
problem
are
displa
y
ed
in
Figure

for
a
uniform
mesh
with
eigh
t
elemen
ts
It
app
ears
that
the
p
oin
t
wise
discretization
errors
are
m
uc
h
smaller
at
no
des
than
they
are
globally

W
ell
see
that
this
phenomena
called
sup
er
c
onver
genc
e
applies
more
generally
than
this
single
example
w
ould
imply

Since
nite
elemen
t
solutions
are
dened
as
con
tin
uous
functions
of
x
w
e
can
also
appraise
their
b
eha
vior
in
some
global
norms
in
addition
to
the
discr
ete
err
or
norms
used
in
T
able

Man
y
norms
could
pro
vide
useful
information
One
that
w
e
will
use
quite


In
tro
duction
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
0
0.01
0.02
0.03
0.04
0.05
0.06
Figure

Exact
and
piecewiselinear
nite
elemen
t
solutions
of
Example

on
an
elemen
t
mesh
often
is
the
square
ro
ot
of
the
strain
energy
of
the
error
th
us
using
c
kek
A

p
Ae
e


Z


pe




q
e

	dx



a
This
expression
ma
y
easily
b
e
ev
aluated
as
a
summation
o
v
er
the
elemen
ts
in
the
spirit
of
	a
With
p

q


for
this
example
kek

A

Z


e




e

	dx
The
in
tegral
is
the
square
of
the
norm
used
on
the
Sob
olev
space
H


th
us
kek



Z


e




e

	dx



b
Other
global
error
measures
will
b
e
imp
ortan
t
to
our
analyses
ho
w
ev
er
the
only
one


A
Simple
Finite
Elemen
t
Problem
	
that
w
e
will
in
tro
duce
at
the
momen
t
is
the
L

norm
kek



Z


e

xdx



c
Results
for
the
L

and
strain
energy
errors
presen
ted
in
T
able

for
this
example
indicate
that
kek


O
h


and
kek
A

O
h
The
error
in
the
H

norm
w
ould
b
e
iden
tical
to
that
in
strain
energy

Later
w
e
will
pro
v
e
that
these
a
priori
error
estimates
are
correct
for
this
and
similar
problems
Errors
in
strain
energy
con
v
erge
slo
w
er
than
those
in
L

b
ecause
solution
deriv
ativ
es
are
in
v
olv
ed
and
their
no
dal
con
v
ergence
is
O
h
T
able

N
kek

kek

h

kek
A
kek
A
h



	




	




		




	











T
able

Errors
in
L

and
strain
energy
for
the
piecewiselinear
nite
elemen
t
solution
of
Example

Num
b
ers
in
paren
thesis
indicate
a
p
o
w
er
of

Problems

The
in
tegral
in
v
olv
ed
in
obtaining
the
mass
matrix
according
to

ma
y

of
course
b
e
done
sym
b
olically

It
ma
y
also
b
e
ev
aluated
n
umerically
b
y
Simpsons
rule
whic
h
is
exact
in
this
case
since
the
in
tegrand
is
a
quadratic
p
olynomial
Recall
that
Simpsons
rule
is
Z
h

Fxdx

h

F

Fh

Fh	
The
mass
matrix
is
M
j

Z
x
j
x
j



j


j


j



j
	dx
Using

determine
M
j
b
y
Simpsons
rule
to
v
erify
the
result

The
use
of
Simpsons
rule
ma
y
b
e
simpler
than
sym
b
olic
in
tegration
for
this
example
since
the
trial
functions
are
zero
or
unit
y
at
the
ends
of
an
elemen
t
and
one
half
at
its
cen
ter

Consider
the
solution
of
the
linear
system
AX

F
a


In
tro
duction
where
F
and
X
are
N
dimensional
v
ectors
and
A
is
an
N

N
tridiagonal
matrix
ha
ving
the
form
A








a

c

b

a

c










b
N

a
N

c
N

b
N
a
N








b
Assume
that
piv
oting
is
not
necessary
and
factor
A
as
A

LU

a
where
L
and
U
are
lo
w
er
and
upp
er
bidiagonal
matrices
ha
ving
the
form
L









l


l








l
N









b
U








u

v

u

v







u
N

v
N

u
N








c
Once
the
co
ecien
ts
l
j

j







N

u
j

j







N

and
v
j

j







N


ha
v
e
b
een
determined
the
system
a
ma
y
easily
b
e
solv
ed
b
y
forw
ard
and
bac
kw
ard
substitution
Th
us
using
a
in
a
giv
es
LUX

F
a
Let
UX

Y

b
then
L
Y

F
c

Using

and

sho
w
u


a


l
j

b
j
u
j


u
j

a
j

l
j
c
j


j







N

v
j

c
j

j







N



A
Simple
Finite
Elemen
t
Problem


Sho
w
that
Y
and
X
are
computed
as
Y


F


Y
j

F
j

l
j
Y
j


j







N

X
N

y
N
u
N

X
j

Y
j

v
j
X
j

u
j

j

N


N








Dev
elop
a
pro
cedure
to
implemen
t
this
sc
heme
for
solving
tridiagonal
systems
The
input
to
the
pro
cedure
should
b
e
N
and
v
ectors
con
taining
the
co
ecien
ts
a
j

b
j

c
j

f
j

j







N

The
pro
cedure
should
output
the
solution
X
The
co
ecien
ts
a
j

b
j

etc
j







N

should
b
e
replaced
b
y
u
j

v
j

etc
j







N

in
order
to
sa
v
e
storage
If
y
ou
w
an
t
the
solution
X
can
b
e
returned
in
F

Estimate
the
n
um
b
er
of
arithmetic
op
erations
necessary
to
factor
A
and
for
the
forw
ard
and
bac
kw
ard
substitution
pro
cess

Consider
the
linear
b
oundary
v
alue
problem
pu


q
u

f
x


x


u

u




where
p
and
q
are
p
ositiv
e
constan
ts
and
f
x
is
a
smo
oth
function

Sho
w
that
the
Galerkin
form
of
this
b
oundaryv
alue
problem
consists
of
nding
u

H


satisfying
Av

u

v

f


Z


v

pu


v
q
udx

Z


v
f
dx


v

H



F
or
this
problem
functions
ux

H


are
required
to
b
e
elemen
ts
of
H

and
satisfy
the
Diric
hlet
b
oundary
condition
u


The
Neumann
b
oundary
condition
at
x


need
not
b
e
satised
b
y
either
u
or
v


In
tro
duce
N
equally
spaced
elemen
ts
on

	
x
	

with
no
des
x
j

j
h
j







N
h


N

Appro
ximate
u
b
y
U
ha
ving
the
form
U
x

N
X
j

c
k

k
x
where

j
x
j







N

is
the
piecewise
linear
basis

and
use
Galerkins
metho
d
to
obtain
the
global
stiness
and
mass
matrices
and
the
load
v
ector
for
this
problem
Again
the
appro
ximation
U
x
do
es
not
satisfy
the
natur
al
b
oundary
c
ondition
u




nor
do
es
it
ha
v
e
to
W
e
will
discuss
this
issue
in
Chapter



In
tro
duction

W
rite
a
program
to
solv
e
this
problem
using
the
nite
elemen
t
metho
d
dev
el
op
ed
in
P
art
b
and
the
tridiagonal
algorithm
of
Problem

Execute
y
our
program
with
p


q


and
f
x

x
and
f
x

x


In
eac
h
case
use
N




and

Let
ex

ux

U
x
and
for
eac
h
v
alue
of
N

com
pute
jej


je

x
N
j
and
kek
A
according
to

and
a
Y
ou
ma
y
optionally
also
compute
kek

as
dened
b
y
c
In
eac
h
case
estimate
the
rate
of
con
v
ergence
of
the
nite
elemen
t
solution
to
the
exact
solution

The
Galerkin
form
of

consists
of
determining
u

H


suc
h
that

is
satised
Similarly

the
nite
elemen
t
solution
U

S
N


H


satises

Letting
ex

ux

U
x
sho
w
Ae
e

Au
u

AU
U

where
the
strain
energy
Av

u
is
giv
en
b
y
c
W
e
ha
v
e
th
us
sho
wn
that
the
strain
energy
of
the
error
is
the
error
of
the
strain
energy


Bibliograph
y
	
I
Babu

sk
a
J
Chandra
and
JE
Flahert
y

editors
Adaptive
Computational
Metho
ds
for
Partial
Dier
ential
Equations
Philadelphia
	
SIAM
	
I
Babu

sk
a
OC
Zienkiewicz
J
Gago
and
ER
de
A
Oliv
eira
editors
Ac
cur
acy
Estimates
and
Adaptive
Renements
in
Finite
Element
Computations
John
Wiley
and
Sons
Chic
hester
	
	
MW
Bern
JE
Flahert
y

and
M
Luskin
editors
Grid
Gener
ation
and
A
daptive
A
lgorithms
v
olume

of
The
IMA
V
olumes
in
Mathematics
and
its
Applic
ations
New
Y
ork
			
Springer
	
GF
Carey

Computational
Grids
Gener
ation
A
daptation
and
Solution
Str
ate
gies
Series
in
Computational
and
Ph
ysical
Pro
cesses
in
Mec
hanics
and
Thermal
science
T
a
ylor
and
F
rancis
New
Y
ork
		
	
K
Clark
JE
Flahert
y

and
MS
Shephard
editors
Applie
d
Numeric
al
Mathemat
ics
v
olume

		
Sp
ecial
Issue
on
Adaptiv
e
Metho
ds
for
P
artial
Dieren
tial
Equations
	
R
Couran
t
V
ariational
metho
ds
for
the
solution
of
problems
of
equilibrium
and
vibrations
Bul
letin
of
the
A
meric
an
Mathematics
So
ciety
	 
	
	
JE
Flahert
y

P
J
P
aslo
w
MS
Shephard
and
JD
V
asilakis
editors
A
daptive
metho
ds
for
Partial
Dier
ential
Equations
Philadelphia
		
SIAM
	
A
Hrennik
o
Solutions
of
problems
in
elasticit
y
b
y
the
frame
w
ork
metho
d
Journal
of
Applie
d
Me
chanics
	 
	
		
C
Johnson
Numeric
al
Solution
of
Partial
Dier
ential
Equations
by
the
Finite
Ele
ment
metho
d
Cam
bridge
Cam
bridge
	
	
DL
Logan
A
First
Course
in
the
Finite
Element
Metho
d
using
ALGOR
PWS
Boston
		



In
tro
duction
	
D
McHenry

A
lattice
analogy
for
the
solution
of
plane
stress
problems
Journal
of
the
Institute
of
Civil
Engine
ers
	 
	
	
JC
Strikw
erda
Finite
Dier
enc
e
Schemes
and
Partial
Dier
ential
Equations
Chapman
and
Hall
P
acic
Gro
v
e
		
	
MJ
T
urner
RW
Clough
HC
Martin
and
LJ
T
opp
Stiness
and
deection
analysis
of
complex
structures
Journal
of
the
A
er
onautic
al
Scienc
es
 
	
	
R
V
erf
!
urth
A
R
eview
of
Posteriori
Err
or
Estimation
and
A
daptive
Mesh
R
enement
T
e
chniques
T
eubnerWiley

Stuttgart
		

Chapter

OneDimensional
Finite
Elemen
t
Metho
ds

In
tro
duction
The
piecewiselinear
Galerkin
nite
elemen
t
metho
d
of
Chapter

can
b
e
extended
in
sev
eral
directions
The
most
imp
ortan
t
of
these
is
m
ultidimensional
problems
ho
w
ev
er
w
ell
p
ostp
one
this
un
til
the
next
c
hapter
Here
w
ell
address
and
answ
er
some
other
questions
that
ma
y
b
e
inferred
from
our
brief
encoun
ter
with
the
metho
d

Is
the
Galerkin
metho
d
the
b
est
w
a
y
to
construct
a
v
ariational
principal
for
a
partial
dieren
tial
system	

Ho
w
do
w
e
construct
v
ariational
principals
for
more
complex
problems	
Sp
ecically

ho
w
do
w
e
treat
b
oundary
conditions
other
than
Diric
hlet	

The
nite
elemen
t
metho
d
app
eared
to
con
v
erge
as
O
h
in
strain
energy
and
O
h


in
L

for
the
example
of
Section

Is
this
true
more
generally	

Can
the
nite
elemen
t
solution
b
e
impro
v
ed
b
y
using
higherdegree
piecewise
p
olynomial
appro
ximations	
What
are
the
costs
and
b
enets
of
doing
this	
W
ell
tac
kle
the
Galerkin
form
ulations
in
the
next
t
w
o
sections
examine
higherdegree
piecewise
p
olynomials
in
Sections

and

and
conclude
with
a
discussion
of
appro
x
imation
errors
in
Section


Galerkins
Metho
d
and
Extremal
Principles
F
or
since
the
fabric
of
the
univ
erse
is
most
p
erfect
and
the
w
ork
of
a
most
wise
creator
nothing
at
all
tak
es
place
in
the
univ
erse
in
whic
h
some
rule
of
maxim
um
or
minim
um
do
es
not
app
ear



OneDimensional
Finite
Elemen
t
Metho
ds

L
e
onhar
d
Euler
Although
the
construction
of
v
ariational
principles
from
dieren
tial
equations
is
an
imp
ortan
t
asp
ect
of
the
nite
elemen
t
metho
d
it
will
not
b
e
our
main
ob
jectiv
e
W
ell
explore
some
prop
erties
of
v
ariational
principles
with
a
goal
of
dev
eloping
a
more
thorough
understanding
of
Galerkins
metho
d
and
of
answ
ering
the
questions
raised
in
Section

In
particular
w
ell
fo
cus
on
b
oundary
conditions
appro
ximating
spaces
and
extremal
prop
erties
of
Galerkins
metho
d
Once
again
w
ell
use
the
mo
del
t
w
op
oin
t
Diric
hlet
problem
Lu

pxu




q
xu

f
x


x


a
u

u


b
with
px


q
x


and
f
x
b
eing
smo
oth
functions
on


x


As
describ
ed
in
Chapter

the
Galerkin
form
of

is
obtained
b
y
m
ultiplying
a
b
y
a
test
function
v

H



in
tegrating
the
result
on


and
in
tegrating
the
secondorder
term
b
y
parts
to
obtain
Av

u

v

f

v

H



a
where
v

f


Z


v
f
dx
b
and
Av

u

v


pu



v

q
u

Z


v

pu


v
q
udx
c
and
functions
v
b
elonging
to
the
Sob
olev
space
H

ha
v
e
b
ounded
v
alues
of
Z


v




v

dx
F
or

a
function
v
is
in
H


if
it
also
satises
the
trivial
b
oundary
conditions
v


v



As
w
e
shall
disco
v
er
in
Section

the
denition
of
H


will
dep
end
on
the
t
yp
e
of
b
oundary
conditions
b
eing
applied
to
the
dieren
tial
equation
There
is
a
connection
b
et
w
een
selfadjoin
t
dieren
tial
problems
suc
h
as

and
the
minim
um
problem
nd
w

H


that
minimizes
I
w


Aw

w


w

f


Z


pw




q
w


w
f
dx



Galerkins
Metho
d
and
Extremal
Principles

Maxim
um
and
minim
um
v
ariational
principles
o
ccur
throughout
mathematics
and
ph
ysics
and
a
discipline
called
the
Calculus
of
V
ariations
arose
in
order
to
study
them
The
initial
goal
of
this
eld
w
as
to
extend
the
elemen
tary
theory
of
the
calculus
of
the
maxima
and
minima
of
functions
to
problems
of
nding
the
extrema
of
functionals
suc
h
as
I
w

A
functional
is
an
op
erator
that
maps
functions
on
to
real
n
um
b
ers
The
construction
of
the
Galerkin
form

of
a
problem
from
the
dieren
tial
form

is
straigh
t
forw
ard
ho
w
ev
er
the
construction
of
the
extremal
problem

is
not
W
e
do
not
pursue
this
matter
here
Instead
w
e
refer
readers
to
a
text
on
the
calculus
of
v
ariations
suc
h
as
Couran
t
and
Hilb
ert

Accepting

w
e
establish
that
the
solution
u
of
Galerkins
metho
d

is
optimal
in
the
sense
of
minimizing

Theorem

The
function
u

H


that
minimizes

is
the
one
that
satises
a
and
c
onversely
Pr
o
of
Supp
ose
rst
that
ux
is
the
solution
of
a
W
e
c
ho
ose
a
real
parameter

and
an
y
function
v
x

H


and
dene
the
c
omp
arison
function
w
x

ux

v
x

F
or
eac
h
function
v
x
w
e
ha
v
e
a
one
parameter
family
of
comparison
functions
w
x

H


with
the
solution
ux
of
a
obtained
when



By
a
suitable
c
hoice
of

and
v
x
w
e
can
use

to
represen
t
an
y
function
in
H



A
comparison
function
w
x
and
its
variation
v
x
are
sho
wn
in
Figure

0
1
ε v(x)
w(x)
u, w
u(x)
x
Figure

A
comparison
function
w
x
and
its
v
ariation
v
x
from
ux
Substituting

in
to

I
w


I
u

v


Au

v

u

v


u

v

f



OneDimensional
Finite
Elemen
t
Metho
ds
Expanding
the
strain
energy
and
L

inner
pro
ducts
using
bc
I
w


Au
u

u
f


Av

u

v

f




Av

v

By
h
yp
othesis
u
satises
a
so
the
O

term
v
anishes
Using

w
e
ha
v
e
I
w


I
u



Av

v

With
p


and
q


w
e
ha
v
e
Av

v



th
us
u
minimizes

In
order
to
pro
v
e
the
con
v
erse
assume
that
ux
minimizes

and
use

to
obtain
I
u

I
u

v

F
or
a
particular
c
hoice
of
v
x
let
us
regard
I
u

v

as
a
function

ie
I
u

v




Au

v

u

v


u

v

f

A
necessary
condition
for
a
minim
um
to
o
ccur
at



is





th
us
dieren
tiating




Av

v


Av

u

v

f

and
setting







Av

u

v

f



Th
us
u
is
a
solution
of
a
The
follo
wing
corollary
v
eries
that
the
minimizing
function
u
is
also
unique
Corollary

The
solution
u
of
a
or

is
unique
Pr
o
of
Supp
ose
there
are
t
w
o
functions
u


u


H


satisfying
a
ie
Av

u



v

f

Av

u



v

f

v

H



Subtracting
Av

u


u




v

H



Since
this
relation
is
v
alid
for
al
l
v

H



c
ho
ose
v

u


u

to
obtain
Au


u


u


u




If
q
x


x



then
Au


u


u


u


is
p
ositiv
e
unless
u


u


Th
us
it
suces
to
consider
cases
when
either
i
q
x


x



or
ii
q
x
v
anishes
at
isolated
p
oin
ts
or
subin
terv
als
of


F
or
simplicit
y

let
us
consider
the
former
case
The
analysis
of
the
latter
case
is
similar
When
q
x


x



Au


u


u


u


can
v
anish
when
u



u




Th
us
u


u

is
a
constan
t
Ho
w
ev
er
b
oth
u

and
u

satisfy
the
trivial
b
oundary
conditions
b
th
us
the
constan
t
is
zero
and
u


u




Galerkins
Metho
d
and
Extremal
Principles

Corollary

If
u
w
ar
e
smo
oth
enough
to
p
ermit
inte
gr
ating
Au
v

by
p
arts
then
the
minimizer
of

the
solution
of
the
Galerkin
pr
oblem
a
and
the
solution
of
the
twop
oint
b
oundary
value
pr
oblem

ar
e
al
l
e
quivalent
Pr
o
of
In
tegrate
the
dieren
tiated
term
in

b
y
parts
to
obtain
I
w


Z


w
pw




q
w


f
w
dx

w
pw

j



The
last
term
v
anishes
since
w

H



th
us
using
a
and
b
w
e
ha
v
e
I
w


w

Lw


w

f


No
w
follo
w
the
steps
used
in
Theorem

to
sho
w
Av

u

v

f


v

Lu

f



v

H



and
hence
establish
the
result
The
minimization
problems

and

are
equiv
alen
t
when
w
has
sucien
t
smo
othness
Ho
w
ev
er
minimizers
of

ma
y
lac
k
the
smo
othness
to
satisfy

When
this
o
ccurs
the
solutions
with
less
smo
othness
are
often
the
ones
of
ph
ysical
in
terest
Problems

Consider
the
stationary
v
alue
problem
nd
functions
w
x
that
giv
e
stationary
v
alues
maxima
minima
or
saddle
p
oin
ts
of
I
w


Z


F
x
w

w

dx
a
when
w
satises
the
essen
tial
Diric
hlet
b
oundary
conditions
w




w




b
Let
w

H

E

where
the
subscript
E
denotes
that
w
satises
b
and
consider
comparison
functions
of
the
form

where
u

H

E
is
the
function
that
mak
es
I
w

stationary
and
v

H


is
arbitrary

F
unctions
in
H


satisfy
trivial
v
ersions
of
b
ie
v


v



Using

as
an
example
w
e
w
ould
ha
v
e
F
x
w

w



pxw




q
xw


w
f
x





Smo
oth
stationary
v
alues
of

w
ould
b
e
minima
in
this
case
and
corresp
ond
to
solutions
of
the
dieren
tial
equation
a
and
b
oundary
conditions
b


OneDimensional
Finite
Elemen
t
Metho
ds
Dieren
tial
equations
arising
from
minim
um
principles
lik
e

or
from
station
ary
v
alue
principles
lik
e

are
called
EulerL
agr
ange
e
quations
Beginning
with

follo
w
the
steps
used
in
pro
ving
Theorem

to
determine
the
Galerkin
equations
satised
b
y
u
Also
determine
the
EulerLagrange
equations
for
smo
oth
stationary
v
alues
of


Essen
tial
and
Natural
Boundary
Conditions
The
analyses
of
Section

readily
extend
to
problems
ha
ving
non
trivial
Diric
hlet
b
ound
ary
conditions
of
the
form
u



u



a
In
this
case
functions
u
satisfying
a
or
w
satisfying

m
ust
b
e
mem
b
ers
of
H

and
satisfy
a
W
ell
indicate
this
b
y
writing
u
w

H

E

with
the
subscript
E
denoting
that
u
and
w
satisfy
the
essential
Diric
hlet
b
oundary
conditions
a
Since
u
and
w
satisfy
a
w
e
ma
y
use

or
the
in
terpretation
of
v
as
a
v
ariation
sho
wn
in
Figure

to
conclude
that
v
should
still
v
anish
at
x


and

and
hence
b
elong
to
H



When
u
is
not
prescrib
ed
at
x


andor

the
function
v
need
not
v
anish
there
Let
us
illustrate
this
when
a
is
sub
ject
to
conditions
u



pu





b
Th
us
an
essen
tial
or
Diric
hlet
condition
is
sp
ecied
at
x


and
a
Neumann
condition
is
sp
ecied
at
x


Let
us
construct
a
Galerkin
form
of
the
problem
b
y
again
m
ultiplying
a
b
y
a
test
function
v

in
tegrating
on


and
in
tegrating
the
second
deriv
ativ
e
terms
b
y
parts
to
obtain
Z


v
pu




q
u

f
dx

Av

u

v

f


v
pu

j





With
an
essen
tial
b
oundary
condition
at
x


w
e
sp
ecify
u


and
v



ho
w
ev
er
u
and
v

remain
unsp
ecied
W
e
still
classify
u

H

E
and
v

H


since
they
satisfy

resp
ectiv
ely

the
essen
tial
and
trivial
essen
tial
b
oundary
conditions
sp
ecied
with
the
problem
With
v



and
pu





w
e
use

to
establish
the
Galerkin
problem
for
a
b
as
determine
u

H

E
satisfying
Av

u

v

f


v


v

H






Essen
tial
and
Natural
Boundary
Conditions

Let
us
reiterate
that
the
subscript
E
on
H

restricts
functions
to
satisfy
Diric
hlet
essen
tial
b
oundary
conditions
but
not
an
y
Neumann
conditions
The
subscript

restricts
functions
to
satisfy
trivial
v
ersions
of
an
y
Diric
hlet
conditions
but
once
again
Neumann
conditions
are
not
imp
osed
As
with
problem

there
is
a
minimization
problem
corresp
onding
to

determine
w

H

E
that
minimizes
I
w


Aw

w


w

f


w



F
urthermore
in
analogy
with
Theorem

w
e
ha
v
e
an
equiv
alence
b
et
w
een
the
Galerkin

and
minimization

problems
Theorem

The
function
u

H

E
that
minimizes

is
the
one
that
satises

and
c
onversely
Pr
o
of
The
pro
of
is
so
similar
to
that
of
Theorem

that
w
ell
only
pro
v
e
that
the
function
u
that
minimizes

also
satises

The
remainder
of
the
pro
of
is
stated
as
Problem

as
the
end
of
this
section
Again
create
the
comparison
function
w
x

ux

v
x

ho
w
ev
er
as
sho
wn
in
Figure

v

need
not
v
anish
By
h
yp
othesis
w
e
ha
v
e
x
u, w
0
1
ε
α
u(x)
v(x)
w(x)
Figure

Comparison
function
w
x
and
v
ariation
v
x
when
Diric
hlet
data
is
pre
scrib
ed
at
x


and
Neumann
data
is
prescrib
ed
at
x


I
u

I
u

v




Au

v

u

v


u

v

f


u

v




OneDimensional
Finite
Elemen
t
Metho
ds
Dieren
tiating
with
resp
ect
to

yields
the
necessary
condition
for
a
minim
um
as




Av

u

v

f


v




th
us
u
satises

As
exp
ected
Theorem

can
b
e
extended
when
the
minimizing
function
u
is
smo
oth
Corollary

Smo
oth
functions
u

H

E
satisfying

or
minimizing

also
satisfy
a
b
Pr
o
of
Using
c
in
tegrate
the
dieren
tiated
term
in

b
y
parts
to
obtain
Z


v
pu




q
u

f
dx

v
pu







v

H




Since

m
ust
b
e
satised
for
all
p
ossible
test
functions
it
m
ust
v
anish
for
those
functions
satisfying
v



Th
us
w
e
conclude
that
a
is
satised
Similarly

b
y
considering
test
functions
v
that
are
nonzero
in
just
a
small
neigh
b
orho
o
d
of
x


w
e
conclude
that
the
b
oundary
condition
b
m
ust
b
e
satised
Since

m
ust
b
e
satised
for
al
l
test
functions
v

the
solution
u
m
ust
satisfy
a
in
the
in
terior
of
the
domain
and
b
at
x


Neumann
b
oundary
conditions
or
other
b
oundary
conditions
prescribing
deriv
ativ
es
cf
Problem

at
the
end
of
this
section
are
called
natur
al
b
oundary
c
onditions
b
e
cause
they
follo
w
directly
from
the
v
ariational
principle
and
are
not
explicitly
imp
osed
Essen
tial
b
oundary
conditions
constrain
the
space
of
functions
that
ma
y
b
e
used
as
trial
or
comparison
functions
Natural
b
oundary
conditions
imp
ose
no
constrain
ts
on
the
function
spaces
but
rather
alter
the
v
ariational
principle
Problems

Pro
v
e
the
remainder
of
Theorem

ie
sho
w
that
functions
that
satisfy

also
minimize


Sho
w
that
the
Galerkin
form
a
with
the
Robin
b
oundary
conditions
pu





u




pu





u



is
determine
u

H

satisfying
Av

u

v

f


v





u

v





u
v

H


Also
sho
w
that
the
function
w

H

that
minimizes
I
w


Aw

w


w

f




w




w





w




w


is
u
the
solution
of
the
Galerkin
problem


Piecewise
Lagrange
P
olynomials
	

Construct
the
Galerkin
form
of

when
px



if


x

	

if
	

x



Suc
h
a
situation
can
arise
in
a
steady
heatconduction
problem
when
the
medium
is
made
of
t
w
o
dieren
t
materials
that
are
joined
at
x

	
What
conditions
m
ust
u
satisfy
at
x

		

Piecewise
Lagrange
P
olynomials
The
nite
elemen
t
metho
d
is
not
limited
to
piecewiselinear
p
olynomial
appro
ximations
and
its
exten
tion
to
higherdegree
p
olynomials
is
straigh
t
forw
ard
There
is
ho
w
ev
er
a
question
of
the
b
est
basis
Man
y
p
ossibilities
are
a
v
ailable
from
design
and
appro
ximation
theory

Of
these
splines
and
Hermite
appro
ximations

are
generally
not
used
b
ecause
they
oer
more
smo
othness
andor
a
larger
supp
ort
than
needed
or
desired
Lagrange
in
terp
olation


and
a
hierarc
hical
appro
ximation
in
the
spirit
of
Newtons
divided
dierence
p
olynomials
will
b
e
our
c
hoices
The
piecewiselinear
hat
function

j
x






xx
j

x
j
x
j


if
x
j


x

x
j
x
j

x
x
j

x
j

if
x
j

x

x
j


otherwise
a
on
the
mesh
x


x






x
N
b
is
a
mem
b
er
of
b
oth
classes
It
has
t
w
o
desirable
prop
erties
i

j
x
is
unit
y
at
no
de
j
and
v
anishes
at
all
other
no
des
and
ii

j
is
only
nonzero
on
those
elemen
ts
con
tain
ing
no
de
j

The
rst
prop
ert
y
simplies
the
determination
of
solutions
at
no
des
while
the
second
simplies
the
solution
of
the
algebraic
system
that
results
from
the
nite
elemen
t
discretization
The
Lagrangian
basis
main
tains
these
prop
erties
with
increasing
p
olynomial
degree
Hierarc
hical
appro
ximations
on
the
other
hand
main
tain
only
the
second
prop
ert
y

They
are
constructed
b
y
adding
highdegree
corrections
to
lo
w
erdegree
mem
b
ers
of
the
series
W
e
will
examine
Lagrange
bases
in
this
section
b
eginning
with
the
quadratic
p
oly
nomial
basis
These
are
constructed
b
y
adding
an
extra
no
de
x
j

at
the
midp
oin
t
of
eac
h
elemen
t
x
j


x
j

j







N
Figure

As
with
the
piecewiselinear
basis
a
one
basis
function
is
asso
ciated
with
eac
h
no
de
Those
asso
ciated
with
v
ertices
are


OneDimensional
Finite
Elemen
t
Metho
ds
x
x
0
x
x
x
x
2
xN-1
U(x)
3/2
N-1/2
1/2
1
N
x
x
Figure

Finite
elemen
t
mesh
for
piecewisequadratic
Lagrange
p
olynomial
appro
xi
mations

j
x









xx
j
h
j



xx
j
h
j



if
x
j


x

x
j



xx
j
h
j




xx
j
h
j




if
x
j

x

x
j


otherwise

j







N

a
and
those
asso
ciated
with
elemen
t
midp
oin
ts
are

j

x





xx
j

h
j



if
x
j


x

x
j

otherwise

j







N

b
Here
h
j

x
j

x
j


j







N

c
These
functions
are
sho
wn
in
Figure

Their
construction
to
b
e
describ
ed
in
v
o
vles
satsifying

j
x
k




if
j

k

otherwise

j
k


	





N


N

	
N


Basis
functions
asso
ciated
with
a
v
ertex
are
nonzero
on
at
most
t
w
o
elemen
ts
and
those
asso
ciated
with
an
elemen
t
midp
oin
t
are
nonzero
on
only
one
elemen
t
Th
us
as
noted
the
Lagrange
basis
function

j
is
nonzero
only
on
elemen
ts
con
taining
no
de
j

The
functions
ab
are
quadratic
p
olynomials
on
eac
h
elemen
t
Their
construction
and
trivial
extension
to
other
nite
elemen
ts
guaran
tees
that
they
are
con
tin
uous
o
v
er
the
en
tire
mesh
and
lik
e

are
mem
b
ers
of
H


The
nite
elemen
t
trial
function
U
x
is
a
linear
com
bination
of
ab
o
v
er
the
v
ertices
and
elemen
t
midp
oin
ts
of
the
mesh
that
ma
y
b
e
written
as
U
x

N
X
j

c
j

j
x

N
X
j

c
j


j

x

N
X
j

c
j


j

x



Piecewise
Lagrange
P
olynomials

−1
−0.8
−0.6
−0.4
−0.2
0
0.2
0.4
0.6
0.8
1
−0.2
0
0.2
0.4
0.6
0.8
1
1.2
−1
−0.8
−0.6
−0.4
−0.2
0
0.2
0.4
0.6
0.8
1
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Figure

Piecewisequadratic
Lagrange
basis
functions
for
a
v
ertex
at
x


left
and
an
elemen
t
midp
oin
t
at
x


righ
t
When
comparing
with

set
x
j



x
j



x
j


x
j



and
x
j



Using

w
e
see
that
U
x
k


c
k

k


	





N

	
N

Cubic
quartic
etc
Lagrangian
p
olynomials
are
generated
b
y
adding
no
des
to
elemen
t
in
teriors
Ho
w
ev
er
prior
to
constructing
them
lets
in
tro
duce
some
terminology
and
simplify
the
no
de
n
um
b
ering
to
b
etter
suit
our
task
Finite
elemen
t
bases
are
constructed
implicitly
in
an
elemen
tb
yelemen
t
manner
in
terms
of
shap
e
functions
A
shap
e
function
is
the
restriction
of
a
basis
function
to
an
elemen
t
Th
us
for
the
piecewisequadratic
Lagrange
p
olynomial
there
are
three
non
trivial
shap
e
functions
on
the
elemen
t

j

x
j


x
j


the
righ
t
p
ortion
of

j

x
N
j
j
x




x

x
j

h
j



x

x
j

h
j



a


j

x
N
j
j
x




x

x
j

h
j



b

and
the
left
p
ortion
of

j
x
N
jj
x




x

x
j
h
j



x

x
j
h
j



x


j

c
Figure

In
these
equations
N
k
j
is
the
shap
e
function
asso
ciated
with
no
de
k

k

j


j

	
j

of
elemen
t
j
the
subin
terv
al

j

W
e
ma
y
use

and

to
write
the
restriction
of
U
x
to

j
as
U
x

c
j

N
j
j

c
j

N
j
j

c
j
N
jj

x


j



OneDimensional
Finite
Elemen
t
Metho
ds
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
−0.2
0
0.2
0.4
0.6
0.8
1
1.2
Figure

The
three
quadratic
Lagrangian
shap
e
functions
on
the
elemen
t
x
j


x
j

When
comparing
with

set
x
j



x
j



and
x
j


More
generally

w
e
will
asso
ciate
the
shap
e
function
N
k
e
x
with
mesh
entity
k
of
elemen
t
e
A
t
presen
t
the
only
mesh
en
tities
that
w
e
kno
w
of
are
v
ertices
and
no
des
on
elemen
ts
ho
w
ev
er
edges
and
faces
will
b
e
in
tro
duced
in
t
w
o
and
three
dimensions
The
k
ey
construction
concept
is
that
the
shap
e
function
N
k
e
x
is

nonzero
only
on
elemen
t
e
and

nonzero
only
if
mesh
en
tit
y
k
b
elongs
to
elemen
t
e
A
onedimensional
Lagrange
p
olynomial
shap
e
function
of
degree
p
is
constructed
on
an
elemen
t
e
using
t
w
o
v
ertex
no
des
and
p


no
des
in
terior
to
the
elemen
t
The
generation
of
shap
e
functions
is
straigh
t
forw
ard
but
it
is
customary
and
con
v
enien
t
to
do
this
on
a
canonical
elemen
t
Th
us
w
e
map
an
arbitrary
elemen
t

e

x
j


x
j

on
to





b
y
the
linear
transformation
x






x
j






x
j






No
des
on
the
canonical
elemen
t
are
n
um
b
ered
according
to
some
simple
sc
heme
ie

to
p
with





p


and













p


Figure

These
are
mapp
ed
to
the
actual
ph
ysical
no
des
x
j


x
j
p





x
j
on

e
using

Th
us
x
j
ip




i

x
j





i

x
j

i







p


Piecewise
Lagrange
P
olynomials

ξ
ξ
(ξ)
ξ   = 1
ξ1
1
N
−1 = ξ0
N
k
k,e
Figure

An
elemen
t
e
used
to
construct
a
p
thdegree
Lagrangian
shap
e
function
and
the
shap
e
function
N
k
e
x
asso
ciated
with
no
de
k

The
Lagrangian
shap
e
function
N
k
e


of
degree
p
has
a
unit
v
alue
at
no
de
k
of
elemen
t
e
and
v
anishes
at
all
other
no
des
th
us
N
k
e

l



k
l



if
k

l

otherwise

l







p
a
It
is
extended
trivially
when

	



The
conditions
expressed
b
y
a
imply
that
N
k
e



p
Y
l

l
k



l

k


l
















k




k








p


k




k








k


k


k


k






k


p


b
W
e
easily
c
hec
k
that
N
k
e
i
is
a
p
olynomial
of
degree
p
in

and
ii
it
satises
conditions
a
It
is
sho
wn
in
Figure

W
ritten
in
terms
of
shap
e
function
the
restriction
of
U
to
the
canonical
elemen
t
is
U



p
X
k

c
k
N
k
e



Example

Let
us
construct
the
quadratic
Lagrange
shap
e
functions
on
the
canonical
elemen
t
b
y
setting
p


in
b
to
obtain
N
e
























N
e
























N
e


























OneDimensional
Finite
Elemen
t
Metho
ds
Setting








and




yields
N
e









N
e








N
e








	
These
ma
y
easily
b
e
sho
wn
to
b
e
iden
tical
to

b
y
using
the
transformation

see
Problem

at
the
end
of
this
section
Example

Setting
p


in
b
w
e
obtain
the
linear
shap
e
functions
on
the
canonical
elemen
t
as
N
e






N
e







The
t
w
o
no
des
needed
for
these
shap
e
functions
are
at
the
v
ertices




and




Using
the
transformation

these
yield
the
t
w
o
pieces
of
the
hat
function
a
W
e
also
note
that
these
shap
e
functions
w
ere
used
in
the
linear
co
ordinate
transformation

This
will
arise
again
in
Chapter

Problems

Sho
w
the
the
quadratic
Lagrange
shap
e
functions
	
on
the
canonical


elemen
t
transform
to
those
on
the
ph
ysical
elemen
t

up
on
use
of


Construct
the
shap
e
functions
for
a
cubic
Lagrange
p
olynomial
from
the
general
form
ula

b
y
using
t
w
o
v
ertex
no
des
and
t
w
o
in
terior
no
des
equally
spaced
on
the
canonical


elemen
t
Sk
etc
h
the
shap
e
functions
W
rite
the
basis
functions
for
a
v
ertex
and
an
in
terior
no
de

Hierarc
hical
Bases
With
a
hierarc
hical
p
olynomial
represen
tation
the
basis
of
degree
p


is
obtained
as
a
correction
to
that
of
degree
p
Th
us
the
en
tire
basis
need
not
b
e
reconstructed
when
increasing
the
p
olynomial
degree
With
nite
elemen
t
metho
ds
they
pro
duce
algebraic
systems
that
are
less
susceptible
to
roundo
error
accum
ulation
at
high
order
than
those
pro
duced
b
y
a
Lagrange
basis
With
the
linear
hierarc
hical
basis
b
eing
the
usual
hat
functions

let
us
b
egin
with
the
piecewisequadratic
hierarc
hical
p
olynomial
The
restriction
of
this
function
to
elemen
t

e

x
j


x
j

has
the
form
U

x

U

x

c
j

N

j
e
x
x


e

a
where
U

x
is
the
piecewiselinear
nite
elemen
t
appro
ximation
on

e
U

x

c
j

N

j
e
x

c
j
N

je
x
b


Hierarc
hical
Bases

Sup
erscripts
ha
v
e
b
een
added
to
U
and
N
je
to
iden
tify
their
p
olynomial
degree
Th
us
N

j
e
x


x
j
x
h
j

if
x


e

otherwise

c
N

je
x


xx
j

h
j

if
x


e

otherwise
d
are
the
usual
hat
function

asso
ciated
with
a
piecewiselinear
appro
ximation
U

x
The
quadratic
correction
N

j
e
x
is
required
to
i
b
e
a
quadratic
p
olynomial
ii
v
anish
when
x
	


e

and
iii
b
e
con
tin
uous
These
conditions
imply
that
N

j
e
is
prop
ortional
to
the
quadratic
Lagrange
shap
e
function
b
and
w
e
will
tak
e
it
to
b
e
iden
tical
th
us
N

j
e
x





xx
j

h
j



if
x


e

otherwise

e
The
normalization
N

j
e
x
j




is
not
necessary

but
seems
con
v
enien
t
Lik
e
the
quadratic
Lagrange
appro
ximation
the
quadratic
hierarc
hical
p
olynomial
has
three
non
trivial
shap
e
functions
p
er
elemen
t
ho
w
ev
er
t
w
o
of
them
are
linear
and
only
one
is
quadratic
Figure

The
basis
ho
w
ev
er
still
spans
quadratic
p
olynomials
Examining

w
e
see
that
c
j


U
x
j


and
c
j

U
x
j

ho
w
ev
er
U
x
j



c
j


c
j


c
j


Dieren
tiating
a
t
wice
with
resp
ect
to
x
giv
es
an
in
terpretation
to
c
j

as
c
j



h


U


x
j


This
in
terpretation
ma
y
b
e
useful
but
is
not
necessary

A
basis
ma
y
b
e
constructed
from
the
shap
e
functions
in
the
manner
describ
ed
for
Lagrange
p
olynomials
With
a
mesh
ha
ving
the
structure
used
for
the
piecewisequadratic
Lagrange
p
olynomials
Figure

the
piecewisequadratic
hierarc
hical
functions
ha
v
e
the
form
U
x

N
X
j

c
j


j
x

N
X
j

c
j



j

x

where


j
x
is
the
hat
function
basis
a
and


j
x

N

je
x
Higherdegree
hierarc
hical
p
olynomials
are
obtained
b
y
adding
more
correction
terms
to
the
lo
w
erdegree
p
olynomials
It
is
con
v
enien
t
to
construct
and
displa
y
these
p
oly
nomials
on
the
canonical


elemen
t
used
in
Section

The
linear
transformation


OneDimensional
Finite
Elemen
t
Metho
ds
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Figure

Quadratic
hierarc
hical
shap
e
on
x
j


x
j

When
comparing
with

set
x
j



and
x
j



is
again
used
to
map
an
arbitrary
elemen
t
x
j


x
j

on
to





The
v
ertex
no
des
at



and

are
asso
ciated
with
the
linear
shap
e
functions
and
for
simplicit
y

w
e
will
index
them
as

and

The
remaining
p


shap
e
functions
are
on
the
elemen
t
in
terior
They
need
not
b
e
asso
ciated
with
an
y
no
des
but
for
con
v
enience
w
e
will
asso
ciate
all
of
them
with
a
single
no
de
indexed
b
y

at
the
cen
ter



of
the
elemen
t
The
restriction
of
the
nite
elemen
t
solution
U


to
the
canonical
elemen
t
has
the
form
U



c

N





c

N





p
X
i
c
i
N
i








W
e
ha
v
e
dropp
ed
the
elemen
tal
index
e
on
N
i
je
since
w
e
are
only
concerned
with
ap
pro
ximations
on
the
canonical
elemen
t
The
v
ertex
shap
e
functions
N


and
N


are
the
hat
function
segmen
ts

on
the
canonical
elemen
t
N










N















Once
again
the
higherdegree
shap
e
functions
N
i



i







p
are
required
to
ha
v
e
the
prop
er
degree
and
v
anish
at
the
elemen
ts
ends




to
main
tain
con
tin
uit
y

An
y
normalization
is
arbitrary
and
ma
y
b
e
c
hosen
to
satisfy
a
sp
ecied
condition
eg
N





W
e
use
a
normalization
of
Szab 
o
and
Babu
!
sk
a

whic
h
relies
on
Legendre
p
olynomials
The
Legendre
p
olynomial
P
i


i


is
a
p
olynomial
of
degree
i
in

satisfying



Hierarc
hical
Bases


the
dieren
tial
equation




P


i


P

i

ii

P
i







i


a

the
normalization
P
i



i


b

the
orthogonalit
y
relation
Z


P
i

P
j

d


i




if
i

j

otherwise

c

the
symmetry
condition
P
i




i
P
i


i


d

the
recurrence
relation
i

P
i



i


P
i



iP
i


i


e
and

the
dieren
tiation
form
ula
P

i



i

P
i



P

i


i


f
The
rst
six
Legendre
p
olynomials
are
P





P






P










P










P













P














With
these
preliminaries
w
e
dene
the
shap
e
functions
N
i




r
i



Z


P
i

d

i


a
Using
df

w
e
readily
sho
w
that
N
i




P
i



P
i


p
i



i


b


OneDimensional
Finite
Elemen
t
Metho
ds
Use
of
the
normalization
and
symmetry
prop
erties
bd
further
rev
eal
that
N
i



N
i




i


c
and
use
of
the
orthogonalit
y
prop
ert
y
c
indicates
that
Z


dN
i



d
dN
j



d
d


ij

i
j


d
Substituting

in
to
b
giv
es
N







p





N







p






N







p








N





	

p










Shap
e
functions
N
i



i








are
sho
wn
in
Figure

−1
−0.8
−0.6
−0.4
−0.2
0
0.2
0.4
0.6
0.8
1
−0.8
−0.6
−0.4
−0.2
0
0.2
0.4
0.6
Figure

Onedimensional
hierarc
hical
shap
e
functions
of
degrees

solid


	


and

"
on
the
canonical
elemen
t





The
represen
tation

with
use
of
bd
rev
eals
that
the
parameters
c

and
c

corresp
ond
to
the
v
alues
of
U

and
U

resp
ectiv
ely
ho
w
ev
er
the
remaining
parameters
c
i

i


do
not
corresp
ond
to
solution
v
alues
In
particular
using



Hierarc
hical
Bases
	
d
and
b
yields
U


c


c



p
X
i
c
i
N
i


Hierarc
hical
bases
can
b
e
constructed
so
that
c
i
is
prop
ortional
to
d
i
U
	d
i

i


cf

Section

ho
w
ev
er
the
shap
e
functions

based
on
Legendre
p
olynomials
reduce
sensitivit
y
of
the
basis
to
roundo
error
accum
ulation
This
is
v
ery
imp
ortan
t
when
using
highorder
nite
elemen
t
appro
ximations
Example

Let
us
solv
e
the
t
w
op
oin
t
b
oundary
v
alue
problem
pu


q
u

f
x


x


u

u


	
using
the
nite
elemen
t
metho
d
with
piecewisequadratic
hierarc
hical
appro
ximations
As
in
Chapter

w
e
simplify
matters
b
y
assuming
that
p


and
q


are
constan
ts
By
no
w
w
e
are
a
w
are
that
the
Galerkin
form
of
this
problem
is
giv
en
b
y

As
in
Chapter

in
tro
duce
cf
	
A
S
j
v

u

Z
x
j
x
j

pv

u

dx
W
e
use

to
map
x
j


x
j

to
the
canonical


elemen
t
as
A
S
j
v

u


h
j
Z


p
dv
d
du
d
d


Using

w
e
write
the
restriction
of
the
piecewisequadratic
trial
and
text
functions
to
x
j


x
j

as
U



c
j


c
j

c
j




N


N


N





V



d
j


d
j

d
j




N


N


N






Substituting

in
to

A
S
j
V

U


d
j


d
j

d
j

K
j


c
j

c
j
c
j



a
where
K
j
is
the
elemen
t
stiness
matrix
K
j

p
h
j
Z


d
d


N


N


N




d
d
N



N



N


d



OneDimensional
Finite
Elemen
t
Metho
ds
Substituting
for
the
basis
denitions


K
j

p
h
j
Z





	
	

q





	
	

r


d

In
tegrating
K
j

p
h
j
Z




	
	

p
	
	
	

p
	

p
	

p
	


	


d

p
h
j














b
The
orthogonalit
y
relation
d
has
simplied
the
stiness
matrix
b
y
uncoupling
the
linear
and
quadratic
mo
des
In
a
similar
manner
A
M
j
V

U


Z
x
j
x
j

q
V
U
dx

q
h
j

Z


V
U
d

a
Using

A
M
j
V

U


d
j


d
j

d
j

M
j


c
j

c
j
c
j



b
where
up
on
use
of


the
elemen
t
mass
matrix
M
j
satises
M
j

q
h
j

Z




N


N


N




N



N



N


d

q
h
j






p
	



p
	

p
	

p
	
	



c
The
higher
and
lo
w
er
order
terms
of
the
elemen
t
mass
matrix
ha
v
e
not
decoupled
Com
paring
b
and
c
with
the
forms
dev
elop
ed
in
Section

for
piecewiselinear
appro
ximations
w
e
see
that
the
piecewise
linear
stiness
and
mass
matrices
are
con
tained
as
the
upp
er

	

p
ortions
of
these
matrices
This
will
b
e
the
case
for
linear
problems
th
us
eac
h
higherdegree
p
olynomial
will
add
a
b
order
to
the
lo
w
erdegree
stiness
and
mass
matrices
Finally

consider
V

f

j

Z
x
j
x
j

V
f
dx

h
j

Z


V
f
d

a
Using

V

f

j

d
j


d
j

d
j

l
j
b


Hierarc
hical
Bases

where
l
j

h
j

Z




N


N


N




f
x
d

c
As
in
Section

w
e
appro
ximate
f
x
b
y
piecewiselinear
in
terp
olation
whic
h
w
e
write
as
f
x

N



f
j


N



f
j
with
f
j

f
x
j

The
manner
of
appro
ximating
f
x
should
clearly
b
e
related
to
the
degree
p
and
w
e
will
need
a
more
careful
analysis
P
ostp
oning
this
un
til
Chapters

and

w
e
ha
v
e
l
j

h
j

Z




N


N


N




N



N


d

f
j

f
j


h
j



f
j


f
j
f
j


f
j

p
	
f
j


f
j



d
Using
a
with
a
a
and
a
w
e
see
that
assem
bly
requires
evluating
the
sum
N
X
j

A
S
j
V

U


A
M
j
V

U


V

f

j



F
ollo
wing
the
strategy
used
for
the
piecewiselinear
solution
of
Section

the
lo
cal
stiness
and
mass
matrices
and
load
v
ectors
are
added
in
to
their
prop
er
lo
cations
in
their
global
coun
terparts
Imp
osing
the
condition
that
the
system
b
e
satised
for
all
c
hoices
of
d
j

j

	

	




N


yields
the
linear
algebraic
system
K

Mc

l

The
structure
of
the
stiness
and
mass
matrices
K
and
M
and
load
v
ector
l
dep
end
on
the
ordering
of
the
unkno
wns
c
and
virtual
co
ordinates
d
One
p
ossibilit
y
is
to
order
them
b
y
increasing
index
ie
c

c


c


c


c






c
N


c
N


T


As
with
the
piecewiselinear
basis
w
e
ha
v
e
assumed
that
the
homogeneous
b
oundary
conditions
ha
v
e
explicitly
eliminated
c


c
N


Assem
bly
for
this
ordering
is
similar
to
the
one
used
in
Section

cf
Problem

at
the
end
of
this
section
This
is
a
natural
ordering
and
the
one
most
used
for
this
appro
ximation
ho
w
ev
er
for
v
ariet
y

let
us
order
the
unkno
wns
b
y
listing
the
v
ertices
rst
follo
w
ed
b
y
those
at
elemen
t
midp
oin
ts
ie
c


c
L
c
Q


c
L






c

c




c
N







c
Q






c

c




c
N










OneDimensional
Finite
Elemen
t
Metho
ds
In
this
case
K
M
and
l
ha
v
e
a
blo
c
k
structure
and
ma
y
b
e
partitioned
as
K


K
L


K
Q


M


M
L
M
LQ
M
T
LQ
M
Q


l


l
L
l
Q


where
for
uniform
mesh
spacing
h
j

h
j







N

these
matrices
are
K
L

p
h


































K
Q

p
h






















	
M
L

q
h



































M
LQ


q
h

r































M
Q

q
h
























l
L

h






f


f


f

f


f


f




f
N


f
N


f
N






l
Q


h
p






f


f

f


f




f
N


f
N







With
N


v
ertex
unkno
wns
c
L
and
N
elemen
tal
unkno
wns
c
Q

the
matrices
K
L
and
M
L
are
N


	
N


K
Q
and
M
Q
are
N
	
N

and
M
LQ
is
N


	
N

Similarly

l
L
and
l
Q
ha
v
e
dimension
N


and
N

resp
ectiv
ely

The
indicated
ordering
implies
that
the

	

elemen
t
stiness
and
mass
matrices
b
and
c
for
elemen
t
j
are
added
to
ro
ws
and
columns
j


j

and
N



j
of
their
global
coun
terparts
The
rst
ro
w
and
column
of
the
elemen
t
stiness
and
mass
matrices
are
deleted
when
j


to
satisfy
the
left
b
oundary
condition
Lik
ewise
the
second
ro
w
and
column
of
these
matrices
are
deleted
when
j

N
to
satisfy
the
righ
t
b
oundary
condition
The
structure
of
the
system
matrix
K

M
is
K

M


K
L

M
L
M
LQ
M
T
LQ
K
Q

M
Q





Hierarc
hical
Bases

The
matrix
K
L

M
L
is
the
same
one
used
for
the
piecewiselinear
solution
of
this
problem
in
Section

Th
us
an
assem
bly
and
factorization
of
this
matrix
done
during
a
prior
piecewiselinear
nite
elemen
t
analysis
could
b
e
reused
A
solution
pro
cedure
using
this
factorization
is
presen
ted
as
Problem

at
the
end
of
this
section
F
urthermore
if
q


then
M
LQ


cf
b
and
the
linear
and
quadratic
p
ortions
of
the
system
uncouple
In
Example

w
e
solv
ed
	
with
p


q


and
f
x

x
using
piecewise
linear
nite
elemen
ts
Let
us
solv
e
this
problem
again
using
piecewisequadratic
hier
arc
hical
appro
ximations
and
compare
the
results
Recall
that
the
exact
solution
of
this
problem
is
ux

x

sinh
x
sinh


Results
for
the
error
in
the
L

norm
are
sho
wn
in
T
able

for
solutions
obtained
with
piecewiselinear
and
quadratic
appro
ximations
The
results
indicate
that
solutions
with
piecewisequadratic
appro
ximations
are
con
v
erging
as
O
h


as
opp
osed
to
O
h


for
piecewiselinear
appro
ximations
Subsequen
tly

w
e
shall
sho
w
that
smo
oth
solutions
generally
con
v
erge
as
O
h
p

in
the
L

norm
and
as
O
h
p

in
the
strain
energy
or
H


norm
N
Linear
Quadratic
DOF
jjejj

jjejj

	h

DOF
jjejj

jjejj

	h














	





	
	




T
able

Errors
in
L

and
degrees
of
freedom
DOF
for
piecewiselinear
and
piecewse
quadratic
solutions
of
Example

The
n
um
b
er
of
elemen
ts
N
is
not
the
only
measure
of
computational
complexit
y

With
higherorder
metho
ds
the
n
um
b
er
of
unkno
wns
degrees
of
freedom
pro
vides
a
b
etter
index
Since
the
piecewisequadratic
solution
has
appro
ximately
t
wice
the
n
um
b
er
of
unkno
wns
of
the
linear
solution
w
e
should
compare
the
linear
solution
with
spacing
h
and
the
quadratic
solution
with
spacing
h
Ev
en
with
this
analysis
the
sup
eriorit
y
of
the
higherorder
metho
d
in
T
able

is
clear
Problems

Consider
the
appro
ximation
in
strain
energy
of
a
giv
en
function
u






b
y
a
p
olynomial
U


in
the
hierarc
hical
form

The
problem
consists
of


OneDimensional
Finite
Elemen
t
Metho
ds
determining
U


as
the
solution
of
the
Galerkin
problem
AV

U


AV

u
V

S
p

where
S
p
is
a
space
of
p
thdegree
p
olynomials
on


F
or
simplicit
y

let
us
tak
e
the
strain
energy
as
Av

u

Z


v

u

d

With
c


u
and
c


u
nd
expressions
for
determining
the
remaining
co
ecien
ts
c
i

i







p
so
that
the
appro
ximation
satises
the
sp
ecied
Galerkin
pro
jection

Sho
w
ho
w
to
generate
the
global
stiness
and
mass
matrices
and
load
v
ector
for
Example

when
the
equations
and
unkno
wns
are
written
in
order
of
increasing
index


Supp
ose
K
L

M
L
ha
v
e
b
een
assem
bled
and
factored
b
y
Gaussian
elimination
as
part
of
a
nite
elemen
t
analysis
with
piecewiselinear
appro
ximations
Devise
an
algorithm
to
solv
e

for
c
L
and
c
Q
that
utilizes
the
giv
en
factorization

In
terp
olation
Errors
Errors
of
nite
elemen
t
solutions
can
b
e
measured
in
sev
eral
norms
W
e
ha
v
e
already
in
tro
duced
p
oin
t
wise
and
global
metrics
In
this
in
tro
ductory
section
on
error
analysis
w
ell
dene
some
basic
principles
and
study
in
terp
olation
errors
As
w
e
shall
see
shortly

errors
in
in
terp
olating
a
function
u
b
y
a
piecewise
p
olynomial
appro
ximation
U
will
pro
vide
b
ounds
on
the
errors
of
nite
elemen
t
solutions
Once
again
consider
a
Galerkin
problem
for
a
secondorder
dieren
tial
equation
nd
u

H


suc
h
that
Av

u

v

f

v

H




Also
consider
its
nite
elemen
t
coun
terpart
nd
U

S
N

suc
h
that
AV

U


V

f

V

S
N



Let
the
appro
ximating
space
S
N


H


consist
of
piecewisep
olynomials
of
degree
p
on
N
elemen
t
meshes
W
e
b
egin
with
t
w
o
fundamen
tal
results
regarding
Galerkins
metho
d
and
nite
elemen
t
appro
ximations


In
terp
olation
Errors

Theorem

L
et
u

H


and
U

S
N


H


satisfy

and

r
esp
e
ctively
then
AV

u

U



V

S
N



Pr
o
of
Since
V

S
N

it
also
b
elongs
to
H



Th
us
it
ma
y
b
e
used
to
replace
v
in

Doing
this
and
subtracting

yields
the
result
W
e
shall
subsequen
tly
sho
w
that
the
strain
energy
furnishes
an
inner
pro
duct
With
this
in
terpretation
w
e
ma
y
regard

as
an
orthogonalit
y
condition
in
a
strain
energy
space
where
Av

u
is
an
inner
pro
duct
and
p
Au
u
is
a
norm
Th
us
the
nite
elemen
t
solution
error
ex

ux

U
x

is
orthogonal
in
strain
energy
to
all
functions
V
in
the
subspace
S
N


W
e
use
this
orthog
onalit
y
to
sho
w
that
solutions
obtained
b
y
Galerkins
metho
d
are
optimal
in
the
sence
of
minimizing
the
error
in
strain
energy

Theorem

Under
the
c
onditions
of
The
or
em

Au

U
u

U


min
V
S
N

Au

V

u

V


Pr
o
of
Consider
Au

U
u

U


Au
u

Au
U


AU
U

Use

with
V
replaced
b
y
U
to
write
this
as
Au

U
u

U


Au
u

Au
U


AU
U


Au

U
U

or
Au

U
u

U


Au
u

AU
U

Again
using

for
an
y
V

S
N

Au

U
u

U


Au
u

AU
U


AV

V


AV

V


Au

U
V

or
Au

U
u

U


Au

V

u

V


AU

V

U

V

Since
the
last
term
on
the
righ
t
is
nonnegativ
e
w
e
can
drop
it
to
obtain
Au

U
u

U


Au

V

u

V

V

S
N


W
e
see
that
equalit
y
is
attained
when
V

U
and
th
us

is
established


OneDimensional
Finite
Elemen
t
Metho
ds
With
optimalit
y
of
Galerkins
metho
d
w
e
ma
y
obtain
estimates
of
nite
elemen
t
discretization
errors
b
y
b
ounding
the
righ
t
side
of

for
particular
c
hoices
of
V

Con
v
enien
t
b
ounds
are
obtained
b
y
selecting
V
to
b
e
an
in
terp
olan
t
of
the
exact
solution
u
Bounds
furnished
in
this
manner
generally
pro
vide
the
exact
order
of
con
v
ergence
in
the
mesh
spacing
h
F
urthermore
results
similar
to

ma
y
b
e
obtained
in
other
norms
They
are
rarely
as
precise
as
those
in
strain
energy
and
t
ypically
indicate
that
the
nite
elemen
t
solution
diers
b
y
no
more
than
a
constan
t
from
the
optimal
solution
in
the
considered
norm
Th
us
w
e
will
study
the
errors
asso
ciated
with
in
terp
olation
problems
This
can
b
e
done
either
on
a
ph
ysical
or
a
canonical
elemen
t
but
w
e
will
pro
ceed
using
a
canonical
elemen
t
since
w
e
constructed
shap
e
functions
in
this
manner
F
or
our
presen
t
purp
oses
w
e
regard
u

as
a
kno
wn
function
that
is
in
terp
olated
b
y
a
p
thdegree
p
olynomial
U


on
the
canonical
elemen
t


An
y
form
of
the
in
terp
olating
p
olynomial
ma
y
b
e
used
W
e
use
the
Lagrange
form

where
U



p
X
k

c
k
N
k



with
N
k


giv
en
b
y
b
W
e
ha
v
e
omitted
the
elemen
tal
index
e
on
N
k
for
clarit
y
since
w
e
are
concerned
with
one
elemen
t
An
analysis
of
in
terp
olation
errors
whith
hi
erarc
hical
shap
e
functions
ma
y
also
b
e
done
cf
Problem

at
the
end
of
this
section
Although
the
Lagrangian
and
hierarc
hical
shap
e
functions
dier
the
resulting
in
terp
ola
tion
p
olynomials
U


and
their
errors
are
the
same
since
the
in
terp
olation
problem
has
a
unique
solution


Selecting
p


distinct
p
oin
ts
xi
i



i







p
the
in
terp
olation
conditions
are
U

i


u
i


u
i

c
i

j







p

where
the
righ
tmost
condition
follo
ws
from
a
There
are
man
y
estimates
of
p
oin
t
wise
in
terp
olation
errors
Here
is
a
t
ypical
result
Theorem

L
et
u


C
p


then
for
e
ach




ther
e
exists
a
p
oint






such
that
the
err
or
in
interp
olating
u

by
a
p
thde
gr
e
e
p
olynomial
U


is
e


u
	p


p

#
p
Y
i



i


Pr
o
of
Although
the
pro
of
is
not
dicult
w
ell
just
sk
etc
h
the
essen
tial
details
A
com
plete
analysis
is
giv
en
in
n
umerical
analysis
texts
suc
h
as
Burden
and
F
aires

Chapter

and
Isaacson
and
Keller

Chapter



In
terp
olation
Errors

Since
e



e







e
p



the
error
m
ust
ha
v
e
the
form
e


g


p
Y
i



i

The
error
in
in
terp
olating
a
p
olynomial
of
degree
p
or
less
is
zero
th
us
g


m
ust
b
e
prop
ortional
to
u
	p

W
e
ma
y
use
a
T
a
ylors
series
argumen
t
to
infer
the
existence
of






and
e


C
u
	p


p
Y
i



i

Selecting
u
to
b
e
a
p
olynomial
of
degree
p


and
dieren
tiating
this
expression
p


times
yields
C
as
	p

#
and

The
p
oin
t
wise
error

can
b
e
used
to
obtain
a
v
ariet
y
of
global
error
estimates
Let
us
estimate
the
error
when
in
terp
olating
a
smo
oth
function
u

b
y
a
linear
p
olyno
mial
U


at
the
v
ertices




and




of
an
elemen
t
Using

with
p


rev
eals
e


u













	
Th
us
je
j



max


ju


j
max


j


j
No
w
max


j


j


Th
us
je
j



max


ju



j
Deriv
ativ
es
in
this
expression
are
tak
en
with
resp
ect
to


In
most
cases
w
e
w
ould
lik
e
results
expressed
in
ph
ysical
terms
The
linear
transformation

pro
vides
the
necessary
con
v
ersion
from
the
canonical
elemen
t
to
elemen
t
j

x
j


x
j

Th
us
d

u

d


h

j

d

u

dx

with
h
j

x
j

x
j


Letting
kf
k
j

max
x
j

xx
j
jf
xj



OneDimensional
Finite
Elemen
t
Metho
ds
denote
the
lo
cal
maxim
um
norm
of
f
x
on
x
j


x
j

w
e
ha
v
e
kek
j

h

j

ku

k
j


Argumen
ts
ha
v
e
b
een
replaced
b
y
a

to
emphasize
that
the
actual
norm
do
esnt
dep
end
on
x
If
ux
w
ere
in
terp
olated
b
y
a
piecewiselinear
function
U
x
on
N
elemen
ts
x
j


x
j

j







N

then

could
b
e
used
on
eac
h
elemen
t
to
obtain
an
estimate
of
the
maxim
um
error
as
kek


h


ku


k


a
where
kf
k


max
j
N
kf
k
j

b
and
h

max
j
N
x
j

x
j


c
As
a
next
step
let
us
use
	
and

to
compute
an
error
estimate
in
the
L

norm
th
us
Z
x
j
x
j

e

xdx

h
j

Z



u










d

Since
j


j


w
e
ha
v
e
Z
x
j
x
j

e

xdx

h
j

Z


u





d

In
tro
duce
the
lo
cal
L

norm
of
a
function
f
x
as
kf
k
j


Z
x
j
x
j

f

xdx




Then
kek

j

h
j

Z


u






d

It
is
tempting
to
replace
the
in
tegral
on
the
righ
t
side
of
our
error
estimate
b
y
ku


k

j

This
is
almost
correct
ho
w
ev
er





W
e
w
ould
ha
v
e
to
v
erify
that

v
aries
smo
othly
with


Here
w
e
will
assume
this
to
b
e
the
case
and
expand
u

using
T
a
ylors
theorem
to
obtain
u




u




u







u




O
j


j








In
terp
olation
Errors
	
or
ju



j

C
ju



j
The
constan
t
C
absorbs
our
careless
treatmen
t
of
the
higherorder
term
in
the
T
a
ylors
expansion
Th
us
using

w
e
ha
v
e
kek

j

C

h
j

Z


u




d

C

h

j

Z
x
j
x
j

u

x

dx
where
deriv
ativ
es
in
the
righ
tmost
expression
are
with
resp
ect
to
x
Using

kek

j

C

h

j

ku

k

j


If
w
e
sum

o
v
er
the
N
nite
elemen
ts
of
the
mesh
and
tak
e
a
square
ro
ot
w
e
obtain
kek


C
h

ku

k


a
where
kf
k



N
X
j

kf
k

j

b
The
constan
t
C
in
a
replaces
the
constan
t
C
	
of

but
w
e
w
ont
b
e
precise
ab
out
iden
tifying
dieren
t
constan
ts
With
a
goal
of
estimating
the
error
in
H


let
us
examine
the
error
u




U



Dieren
tiating
	
with
resp
ect
to

e




u





u




d
d




Assuming
that
d
	d
is
b
ounded
w
e
use

and

to
obtain
ke

k

j

Z
x
j
x
j


dex
dx


dx


h
j
Z


u




u






d
d





d

F
ollo
wing
the
argumen
ts
that
led
to

w
e
nd
ke

k

j

C
h

j
ku

k

j

Summing
o
v
er
the
N
elemen
ts
ke

k



C
h

ku

k





OneDimensional
Finite
Elemen
t
Metho
ds
T
o
obtain
an
error
estimate
in
the
H

norm
w
e
com
bine
a
and

to
get
kek


C
hku

k

a
where
kf
k



N
X
j

kf

k

j

kf
k

j

b
The
metho
dology
dev
elop
ed
ab
o
v
e
ma
y
b
e
applied
to
estimate
in
terp
olation
errors
of
higherdegree
p
olynomial
appro
ximations
A
t
ypical
result
follo
ws
Theorem

Intr
o
duc
e
a
mesh
a

x


x






x
N

b
such
that
U
x
is
a
p
olynomial
of
de
gr
e
e
p
or
less
on
every
subinterval
x
j


x
j

and
U

H

a
b
L
et
U
x
interp
olate
ux

H
p
a
b
such
that
no
err
or
r
esults
when
ux
is
any
p
olynomial
of
de
gr
e
e
p
or
less
Then
ther
e
exists
a
c
onstant
C
p


dep
ending
on
p
such
that
ku

U
k


C
p
h
p
ku
	p
k

a
and
ku

U
k


C
h
p
p
ku
	p
k


b
wher
e
h
satises
c
Pr
o
of
The
analysis
follo
ws
the
one
used
for
linear
p
olynomials
Problems

Cho
ose
a
hierarc
hical
p
olynomial

on
a
canonical
elemen
t


and
sho
w
ho
w
to
determine
the
co
ecien
ts
c
j

j








p
to
solv
e
the
in
terp
olation
problem


Bibliograph
y

M
Abromo
witz
and
IA
Stegun
Handb
o
ok
of
Mathematic
al
F
unctions
v
olume

of
Applie
d
Mathematics
Series
National
Bureau
of
Standards
Gathersburg
	

RL
Burden
and
JD
F
aires
Numeric
al
A
nalysis
PWSKen
t
Boston
fth
edition
		

GF
Carey
and
JT
Oden
Finite
Elements
A
Se
c
ond
Course
v
olume
I
I
Pren
tice
Hall
Englew
o
o
d
Clis
	

R
Couran
t
and
D
Hilb
ert
Metho
ds
of
Mathematic
al
Physics
v
olume

Wiley
In
terscience
New
Y
ork
	

C
de
Bo
or
A
Pr
actic
al
Guide
to
Splines
SpringerV
erlag
New
Y
ork
	

E
Isaacson
and
HB
Keller
A
nalysis
of
Numeric
al
Metho
ds
John
Wiley
and
Sons
New
Y
ork
	

B
Szab 
o
and
I
Babu
!
sk
a
Finite
Element
A
nalysis
John
Wiley
and
Sons
New
Y
ork
		


Chapter

MultiDimensional
V
ariational
Principles

Galerkins
Metho
d
and
Extremal
Principles
The
construction
of
Galerkin
form
ulations
presen
ted
in
Chapters

and

for
onedimensional
problems
readily
extends
to
higher
dimensions
F
ollo
wing
our
prior
dev
elopmen
ts
w
ell
fo
cus
on
the
mo
del
t
w
odimensional
selfadjoin
t
diusion
problem
Lu	

px
y
u
x

x

px
y
u
y

y

q
x
y
u

f
x
y

x
y



a
where




with
b
oundary


Figure

and
px
y



q
x
y



x
y



Essen
tial
b
oundary
conditions
ux
y



x
y

x
y




E

b
are
prescrib
ed
on
the
p
ortion


E
of


and
natural
b
oundary
conditions
px
y


ux
y


n

pru

n

pu
x
cos


u
y
sin




x
y

x
y




N

c
are
prescrib
ed
on
the
remaining
p
ortion


N
of


The
angle

is
the
angle
b
et
w
een
the
xaxis
and
the
out
w
ard
normal
n
to


Figure

The
Galerkin
form
of

is
obtained
b
y
m
ultiplying
a
b
y
a
test
function
v
and
in
tegrating
o
v
er

to
obtain
Z
Z

v
pu
x

x

pu
y

y

q
u

f
	dxdy



In
order
to
in
tegrate
the
second
deriv
ativ
e
terms
b
y
parts
in
t
w
o
and
three
dimensions
w
e
use
Greens
theorem
or
the
div
ergence
theorem
Z
Z

r

adxdy

Z


a

nds
a



MultiDimensional
V
ariational
Principles
x
y
n
s
pu  = β
n
θ
Ω
u = α
Figure

Tw
odimensional
region

with
b
oundary


and
normal
v
ector
n
to


where
s
is
a
co
ordinate
on


a

a


a

	
T

and
r

a


a


x


a


y

b
In
order
to
use
this
result
in
the
presen
t
circumstances
let
us
in
tro
duce
v
ector
notation
pu
x

x

pu
y

y

r

pru
and
use
the
pro
duct
rule
for
the
div
ergence
and
gradien
t
op
erators
r

v
pru

rv


pru

v
r

pru
c
Th
us
Z
Z

v
r

prudxdy

Z
Z

rv


pru

r

v
pru	dxdy

No
w
apply
the
div
ergence
theorem

to
the
second
term
to
obtain
Z
Z

v
r

prudxdy

Z
Z

rv

prudxdy

Z


v
pru

nds
Th
us

b
ecomes
Z
Z

rv

pru

v
q
u

f
	dxdy

Z


v
pu
n
ds





Galerkins
Metho
d
and
Extremal
Principles

where
c
w
as
used
to
simplify
the
surface
in
tegral
The
in
tegrals
in

m
ust
exist
and
with
u
and
v
of
the
same
class
and
p
and
q
smo
oth
this
implies
Z
Z

u

x

u

y

u

dxdy
exists
This
is
the
t
w
odimensional
Sob
olev
space
H


Dra
wing
up
on
our
exp
eriences
in
one
dimension
w
e
exp
ect
u

H

E

where
functions
in
H

E
are
in
H

and
satisfy
the
Diric
hlet
b
oundary
conditions
b
on

E

Lik
ewise
w
e
exp
ect
v

H



whic
h
denotes
that
v


on


E

Th
us
the
v
ariation
v
should
v
anish
where
the
trial
function
u
is
prescrib
ed
Let
us
extend
the
onedimensional
notation
as
w
ell
Th
us
the
L

inner
pro
duct
is
v

f


Z
Z

v
f
dxdy
a
and
the
strain
energy
is
Av

u

rv

pru

v

q
u

Z
Z

pv
x
u
x

v
y
u
y


q
v
u	dxdy

b
W
e
also
in
tro
duce
a
b
oundary
L

inner
pro
duct
as

v

w

Z


N
v
w
ds
c
The
b
oundary
in
tegral
ma
y
b
e
restricted
to


N
since
v


on


E

With
this
nomen
clature
the
v
ariational
problem

ma
y
b
e
stated
as
nd
u

H

E
satisfying
Av

u

v

f


v



v

H




The
Neumann
b
oundary
condition
c
w
as
used
to
replace
pu
n
in
the
b
oundary
inner
pro
duct
The
v
ariational
problem

has
the
same
form
as
the
onedimensional
problem

Indeed
the
theory
and
extremal
principles
dev
elop
ed
in
Chapter

apply
to
m
ultidimensional
problems
of
this
form
Theorem

The
function
w

H

E
that
minimizes
I
w
	

Aw

w


w

f




w





is
the
one
that
satises

and
c
onversely
Pr
o
of
The
pro
of
is
similar
to
that
of
Theorem

and
app
ears
as
Problem

at
the
end
of
this
section


MultiDimensional
V
ariational
Principles
Corollary

Smo
oth
functions
u

H

E
satisfying

or
minimizing

also
satisfy

Pr
o
of
Again
the
pro
of
is
left
as
an
exercise
Example

Supp
ose
that
the
Neumann
b
oundary
conditions
c
are
c
hanged
to
Robin
b
oundary
conditions
pu
n

	
u



x
y




N

a
V
ery
little
c
hanges
in
the
v
ariational
statemen
t
of
the
problem
ab

Instead
of
replacing
pu
n
b
y

in
the
b
oundary
inner
pro
duct
c
w
e
replace
it
b
y


	
u
Th
us
the
Galerkin
form
of
the
problem
is
nd
u

H

E
satisfying
Av

u

v

f


v



	
u

v

H



b
Example

V
ariational
principles
for
nonlinear
problems
and
v
ector
systems
of
partial
dieren
tial
equations
are
constructed
in
the
same
manner
as
for
the
linear
scalar
problems

As
an
example
consider
a
thin
elastic
sheet
o
ccup
ying
a
t
w
o
dimensional
region

As
sho
wn
in
Figure

the
Cartesian
comp
onen
ts
u


u


of
the
displacemen
t
v
ector
v
anish
on
the
p
ortion


E
of
of
the
b
oundary


and
the
com
p
onen
ts
of
the
traction
are
prescrib
ed
as
S


S


on
the
remaining
p
ortion


N
of


The
equations
of
equilibrium
for
suc
h
a
problem
are
cf
eg
	
Chapter





x





y


	a




x





y


x
y



	b
where

ij

i
j



are
the
comp
onen
ts
of
the
t
w
odimensional
symmetric
stress
tensor
matrix
The
stress
comp
onen
ts
are
related
to
the
displacemen
t
comp
onen
ts
b
y
Ho
ok
es
la
w



E






u


x



u


y

a



E






u


x


u


y

b



E






u


y


u


x

c


Galerkins
Metho
d
and
Extremal
Principles

x
y
n
s
θ
S
S2
1
u  = 0
1
2
u  = 0,
Ω
Figure

Tw
odimensional
elastic
sheet
o
ccup
ying
the
region

Displacemen
t
com
p
onen
ts
u


u


v
anish
on


E
and
traction
comp
onen
ts
S


S


are
prescrib
ed
on


N

where
E
and

are
constan
ts
called
Y
oungs
mo
dulus
and
P
oissons
ratio
resp
ectiv
ely

The
displacemen
t
and
traction
b
oundary
conditions
are
u

x
y



u

x
y



x
y




E

a
n




n




S


n




n




S


x
y




N

b
where
n

n


n

	
T

cos


sin

	
T
is
the
unit
out
w
ard
normal
v
ector
to


Figure

F
ollo
wing
the
onedimensional
form
ulations
the
Galerkin
form
of
this
problem
is
obtained
b
y
m
ultiplying
	a
and
	b
b
y
test
functions
v

and
v


resp
ectiv
ely

in
tegrated
o
v
er

and
using
the
div
ergence
theorem
With
u

and
u

b
eing
comp
onen
ts
of
a
displacemen
t
eld
the
functions
v

and
v

are
referred
to
as
comp
onen
ts
of
the
virtual
displac
ement
eld
W
e
use
	a
to
illustrate
the
pro
cess
th
us
m
ultiplying
b
y
v

and
in
tegrating
o
v
er

w
e
nd
Z
Z

v






x





y
	dxdy


The
three
stress
comp
onen
ts
are
dep
enden
t
on
the
t
w
o
displacemen
t
comp
onen
ts
and
are
t
ypically
replaced
b
y
these
using

W
ere
this
done
the
v
ariational
principle


MultiDimensional
V
ariational
Principles
w
ould
in
v
olv
e
second
deriv
ativ
es
of
u

and
u


Hence
w
e
w
ould
w
an
t
to
use
the
div
ergence
theorem
to
obtain
a
symmetric
v
ariational
form
and
reduce
the
con
tin
uit
y
requiremen
ts
on
u

and
u


W
ell
do
this
but
omit
the
explicit
substitution
of

to
simplify
the
presen
tation
Th
us
w
e
regard


and


as
comp
onen
ts
of
a
t
w
ov
ector
w
e
use
the
div
ergence
theorem

to
obrain
Z
Z



v


x




v


y


	dxdy

Z


v

n




n



	ds
Selecting
v


H


implies
that
the
b
oundary
in
tegral
v
anishes
on


E

This
and
the
subsequen
t
use
of
the
natural
b
oundary
condition
b
giv
e
Z
Z



v


x




v


y


	dxdy

Z


N
v

S

ds
v


H



a
Similar
treatmen
t
of
	b
giv
es
Z
Z



v


x




v


y


	dxdy

Z


N
v

S

ds
v


H



b
Equations
a
and
b
ma
y
b
e
com
bined
and
written
in
a
v
ector
form
Letting
u

u


u

	
T

etc
w
e
add
a
and
b
to
obtain
the
Galerkin
problem
nd
u

H


suc
h
that
Av

u


v

S

v

H



a
where
Av

u

Z
Z



v


x




v


y





v


y


v


x


	dxdy

b

v

S

Z


N
v

S


v

S

ds
c
When
a
v
ector
function
b
elongs
to
H


w
e
mean
that
eac
h
of
its
comp
onen
ts
is
in
H


The
spaces
H

E
and
H


are
iden
tical
since
the
displacemen
t
is
trivial
on


E

The
solution
of

also
satises
the
follo
wing
minim
um
problem
Theorem

A
mong
al
l
functions
w

w


w

	
T

H

E
the
solution
u

u


u

	
T
of

is
the
one
that
minimizes
I
w
	

E





Z
Z

f




w


x





w


y


	




w


x


w


y




Galerkins
Metho
d
and
Extremal
Principles









w


y


w


x


gdxdy

Z


N
w

S


w

S

ds
and
c
onversely
Pr
o
of
The
pro
of
is
similar
to
that
of
Theorem

The
stress
comp
onen
ts

ij

i
j



ha
v
e
b
een
eliminated
in
fa
v
or
of
the
displacemen
ts
using

Let
us
conclude
this
section
with
a
brief
summary


A
solution
of
the
dieren
tial
problem
eg

is
called
a
classical
or
strong
solution
The
function
u

H

B

where
functions
in
H

ha
v
e
nite
v
alues
of
Z
Z

u
xx



u
xy



u
y
y



u
x



u
y



u

	dxdy
and
functions
in
H

B
also
satisfy
al
l
prescrib
ed
b
oundary
conditions
eg
bc

Solutions
of
a
Galerkin
problem
suc
h
as

are
called
w
eak
solutions
They
ma
y
b
e
elemen
ts
of
a
larger
class
of
functions
than
strong
solutions
since
the
high
order
deriv
ativ
es
are
missing
from
the
v
ariational
statemen
t
of
the
problem
F
or
the
secondorder
dieren
tial
equations
that
w
e
ha
v
e
b
een
studying
the
v
ariational
form
eg

only
con
tains
rst
deriv
ativ
es
and
u

H

E

F
unctions
in
H

ha
v
e
nite
v
alues
of
Z
Z

u
x



u
y



u

	dxdy

and
functions
in
H

E
also
satisfy
the
prescrib
ed
essen
tial
Diric
hlet
b
oundary
con
dition
b
T
est
functions
v
are
not
v
aried
where
essen
tial
data
is
prescrib
ed
and
are
elemen
ts
of
H



They
satisfy
trivial
v
ersions
of
the
essen
tial
b
oundary
conditions

While
essen
tial
b
oundary
conditions
constrain
the
trial
and
test
spaces
natural
Neumann
or
Robin
b
oundary
conditions
alter
the
v
ariational
statemen
t
of
the
problem
As
with

and

inhomogeneous
conditions
add
b
oundary
inner
pro
duct
terms
to
the
v
ariational
statemen
t

Smo
oth
solutions
of
the
Galerkin
problem
satisfy
the
original
partial
dieren
tial
equations
and
natural
b
oundary
conditions
and
con
v
ersely


Galerkin
problems
arising
from
selfadjoin
t
dieren
tial
equations
also
satisfy
ex
tremal
problems
In
this
case
appro
ximate
solutions
found
b
y
Galerkins
metho
d
are
b
est
in
the
sense
of

ie
in
the
sense
of
minimizing
the
strain
energy
of
the
error


MultiDimensional
V
ariational
Principles
Problems

Pro
v
e
Theorem

and
its
Corollary


Pro
v
e
Theorem

and
aslo
sho
w
that
smo
oth
solutions
of

satisfy
the
dieren
tial
system
	



Consider
an
innite
solid
medium
of
material
M
con
taining
an
innite
n
um
b
er
of
p
erio
dically
spaced
circular
cylindrical
b
ers
made
of
material
F

The
b
ers
are
arranged
in
a
square
arra
y
with
cen
ters
t
w
o
units
apart
in
the
x
and
y
directions
Figure

The
radius
of
eac
h
b
er
is
a


The
aim
of
this
problem
is
to
nd
a
Galerkin
problem
that
can
b
e
used
to
determine
the
eectiv
e
conductivit
y
of
the
comp
osite
medium
Because
of
em
b
edded
symmetries
it
suces
to
solv
e
a
y
x
M
F
a
θ
1
1
r
Figure

Comp
osite
medium
consisting
of
a
regular
arra
y
of
circular
cylindrical
b
ers
em
b
edded
in
in
a
matrix
left
Quadran
t
of
a
P
erio
dicit
y
cell
used
to
solv
e
this
problem
righ
t
problem
on
one
quarter
of
a
p
erio
dicit
y
cell
as
sho
wn
on
the
righ
t
of
Figure

The
go
v
erning
dieren
tial
equations
and
b
oundary
conditions
for
the
temp
erature


Galerkins
Metho
d
and
Extremal
Principles
	
or
p
oten
tial
etc
ux
y

within
this
quadran
t
are
r

pru


x
y



F
	

M

u
x

y


u
x

y





y


ux



ux





x


u

C


pu
r

C


x
y


x


y


a



The
subscripts
F
and
M
are
used
to
indicate
the
regions
and
prop
erties
of
the
b
er
and
matrix
resp
ectiv
ely

Th
us
letting


fx
y
j


x




y

g
w
e
ha
v
e

F

fr


j


r

a





g
and

M




F

The
conductivit
y
p
of
the
b
er
and
matrix
will
generally
b
e
dieren
t
and
hence
p
will
jump
at
r

a
If
necessary

w
e
can
write
px
y



p
F

if
x


y


a

p
M

if
x


y


a


Although
the
conductivities
are
discon
tin
uous
the
last
b
oundary
condition
conrms
that
the
temp
erature
u
and
ux
pu
r
are
con
tin
uous
at
r

a

F
ollo
wing
the
steps
leading
to

sho
w
that
the
Galerkin
form
of
this
problem
consists
of
determining
u

H

E
as
the
solution
of
Z
Z

F

M
pu
x
v
x

u
y
v
y
dxdy


v

H



Dene
the
spaces
H

E
and
H


for
this
problem
The
Galerkin
problem
app
ears
to
b
e
the
same
as
it
w
ould
for
a
homogeneous
medium
There
is
no
indication
of
the
con
tin
uit
y
conditions
at
r

a

Sho
w
that
the
function
w

H

E
that
minimizes
I
w
	

Z
Z

F

M
pw

x

w

y
dxdy
is
the
solution
u
of
the
Galerkin
problem
and
con
v
ersely

Again
there
is
little
evidence
that
the
problem
in
v
olv
es
an
inhomogeneous
medium


MultiDimensional
V
ariational
Principles

F
unction
Spaces
and
Appro
ximation
Let
us
try
to
formalize
some
of
the
considerations
that
w
ere
raised
ab
out
the
prop
erties
of
function
spaces
and
their
smo
othness
requiremen
ts
Consider
a
Galerkin
problem
in
the
form
of

Using
Galerkins
metho
d
w
e
nd
appro
ximate
solutions
b
y
solving

in
a
nitedimensional
subspace
S
N
of
H


Selecting
a
basis
f
j
g
N
j

for
S
N

w
e
consider
appro
ximations
U

S
N
E
of
u
in
the
form
U
x
y


N
X
j

c
j

j
x
y


With
appro
ximations
V

S
N

of
v
ha
ving
a
similar
form
w
e
determine
U
as
the
solution
of
AV

U


V

f


V



V

S
N



Non
trivial
essen
tial
b
oundary
conditions
in
tro
duce
dierences
b
et
w
een
S
N
E
and
S
N

and
w
e
ha
v
e
not
explicitly
iden
tied
these
dierences
in

W
ev
e
men
tioned
the
criticalit
y
of
kno
wing
the
minim
um
smo
othness
requiremen
ts
of
an
appro
ximating
space
S
N

Smo
oth
eg
C


appro
ximations
are
dicult
to
con
struct
on
non
uniform
t
w
o
and
threedimensional
meshes
W
e
ha
v
e
already
seen
that
smo
othness
requiremen
ts
of
the
solutions
of
partial
dieren
tial
equations
are
usually
ex
pressed
in
terms
of
Sob
olev
spaces
so
let
us
dene
these
spaces
and
examine
some
of
their
prop
erties
First
lets
review
some
preliminaries
from
linear
algebra
and
functional
analysis
Denition

V
is
a
line
ar
sp
ac
e
if

u
v

V
then
u

v

V


u

V
then

u

V

for
all
constan
ts


and

u
v

V
then

u


v

V

for
all
constan
ts




Denition

Au
v

is
a
biline
ar
form
on
V

V
if
for
u
v

w

V
and
all
constan
ts

and



Au
v



and

Au
v

is
linear
in
eac
h
argumen
t
th
us
Au

v


w



Au
v



Au
w

A
u


v

w



Au
w



Av

w



F
unction
Spaces
and
Appro
ximation

Denition

An
inner
pr
o
duct
Au
v

is
a
bilinear
form
on
V

V
that

is
symmetric
in
the
sense
that
Au
v


Av

u
u
v

V

and

Au
u


u


and
A



u

V

Denition

The
norm
k

k
A
asso
ciated
with
the
inner
pro
duct
Au
v

is
kuk
A

p
Au
u

and
it
satises

kuk
A


u


kk
A



ku

v
k
A

kuk
A

kv
k
A

and

k
uk
A

j
jkuk
A

for
all
constan
ts


The
in
tegrals
in
v
olv
ed
in
the
norms
and
inner
pro
ducts
are
Leb
esgue
in
tegrals
rather
than
the
customary
Riemann
in
tegrals
F
unctions
that
are
Riemann
in
tegrable
are
also
Leb
esgue
in
tegrable
but
not
con
v
ersely

W
e
ha
v
e
neither
time
nor
space
to
delv
e
in
to
Leb
esgue
in
tegration
nor
will
it
b
e
necessary
for
most
of
our
discussions
It
is
ho
w
ev
er
helpful
when
seeking
understanding
of
the
con
tin
uit
y
requiremen
ts
of
the
v
arious
function
spaces
So
w
ell
mak
e
a
few
brief
remarks
and
refer
those
seeking
more
information
to
texts
on
functional
analysis



	
With
Leb
esgue
in
tegration
the
concept
of
the
length
of
a
subin
terv
al
is
replaced
b
y
the
me
asur
e
of
an
arbitr
ary
p
oint
set
Certain
sets
are
so
sparse
as
to
ha
v
e
me
asur
e
zer
o
An
example
is
the
set
of
rational
n
um
b
ers
on

	
Indeed
all
coun
tably
innite
sets
ha
v
e
measure
zero
If
a
function
u

V
p
ossesses
a
giv
en
prop
ert
y
except
on
a
set
of
measure
zero
then
it
is
said
to
ha
v
e
that
prop
ert
y
almost
ev
erywhere
A
relev
an
t
prop
ert
y
is
the
notion
of
an
e
quivalenc
e
class
Tw
o
functions
u
v

V
b
elong
to
the
same
e
quivalenc
e
class
if
ku

v
k
A


With
Leb
esgue
in
tegration
t
w
o
functions
in
the
same
equiv
alence
class
are
equal
almost
ev
erywhere
Th
us
if
w
e
are
giv
en
a
function
u

V
and
c
hange
its
v
alues
on
a
set
of
measure
zero
to
obtain
a
function
v

then
u
and
v
b
elong
to
the
same
equiv
alence
class
W
e
need
one
more
concept
the
notion
of
c
ompleteness
A
Cauchy
se
quenc
e
fu
n
g

n

V
is
one
where
lim
mn
ku
m

u
n
k
A




MultiDimensional
V
ariational
Principles
If
fu
n
g

n
con
v
erges
in
k

k
A
to
a
function
u

V
then
it
is
a
Cauc
h
y
sequence
Th
us
using
the
triangular
inequalit
y

lim
mn
ku
m

u
n
k
A

lim
mn
fku
m

uk
A

ku

u
n
k
A
g


A
space
V
where
the
con
v
erse
is
true
ie
where
all
Cauc
h
y
sequences
fu
n
g

n
con
v
erge
in
k

k
A
to
functions
u

V

is
said
to
b
e
c
omplete
Denition

A
complete
linear
space
V
with
inner
pro
duct
Au
v

and
corresp
ond
ing
norm
kuk
A

u
v

V
is
called
a
Hilb
ert
sp
ac
e
Lets
list
some
relev
an
t
Hilb
ert
spaces
for
use
with
v
ariational
form
ulations
of
b
ound
ary
v
alue
problems
W
ell
presen
t
their
denitions
in
t
w
o
space
dimensions
Their
ex
tension
to
one
and
three
dimensions
is
ob
vious
Denition

The
space
L


consists
of
functions
satisfying
L



fuj
Z
Z

u

dxdy

g
a
It
has
the
inner
pro
duct
u
v


Z
Z

uv
dxdy
b
and
norm
kuk


p
u
u

c
Denition

The
Sob
olev
sp
ac
e
H
k
consists
of
functions
u
whic
h
b
elong
to
L

with
their
rst
k


deriv
ativ
es
The
space
has
the
inner
pro
duct
and
norm
u
v

k

X
j
jk
D

u
D

v

a
kuk
k

p
u
u
k

b
where







	
T

j
j







c
with


and


nonnegativ
e
in
tegers
and
D

u






u

x



y



d


F
unction
Spaces
and
Appro
ximation

In
particular
the
space
H

has
the
inner
pro
duct
and
norm
u
v



u
v


u
x

v
x


u
y

v
y


Z
Z

uv

u
x
v
x

u
y
v
y
dxdy
a
kuk




Z
Z

u


u

x

u

y
dxdy




b
Lik
ewise
functions
u

H

ha
v
e
nite
v
alues
of
kuk



Z
Z

u

xx

u

xy

u

y
y

u

x

u

y

u

	dxdy

Example

W
e
ha
v
e
b
een
studying
secondorder
dieren
tial
equations
of
the
form

and
seeking
w
eak
solutions
u

H

and
U

S
N

H

of

and

resp
ectiv
ely

Let
us
v
erify
that
H

is
the
correct
space
at
least
in
one
dimension
Th
us
consider
a
basis
of
the
familiar
piecewiselinear
hat
functions
on
a
uniform
mesh
with
spacing
h


N

j
x




x

x
j

h
if
x
j


x

x
j
x
j


xh
if
x
j

x

x
j


otherwise


Since
S
N

H



j
and


j
m
ust
b
e
in
L


j




N

Consider
C

appro
ximations
of

j
x
and


j
x
obtained
b
y
rounding
corners
in
O
hnneigh
b
orho
o
ds
of
the
no
des
x
j


x
j

x
j

as
sho
wn
in
Figure
A
p
ossible
smo
oth
appro
ximation
of


j
x
is


j
x



jn
x


h
tanh
nx

x
j


h

tanh
nx

x
j


h


tanh
nx

x
j

h
	
A
smo
oth
appro
ximation

jn
of

j
is
obtained
b
y
in
tegration
as

jn
x

h
n
ln
	
cosh
nx

x
j

h
cosh
nx

x
j

h
cosh

nx

x
j
h


Clearly


jn
and


jn
are
elemen
ts
of
L


The
rounding
disapp
ears
as
n


and
lim
n
Z




jn
x	

dx

hh


h
The
explicit
calculations
are
somewhat
in
v
olv
ed
and
will
not
b
e
sho
wn
Ho
w
ev
er
it
seems
clear
that
the
limiting
function


j

L

and
hence

j

S
N
for
xed
h


MultiDimensional
V
ariational
Principles
−1.5
−1
−0.5
0
0.5
1
1.5
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
−1.5
−1
−0.5
0
0.5
1
1.5
−1
−0.8
−0.6
−0.4
−0.2
0
0.2
0.4
0.6
0.8
1
−1.5
−1
−0.5
0
0.5
1
1.5
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Figure

Smo
oth
v
ersion
of
a
piecewise
linear
hat
function

top
its
rst
deriv
ativ
e
cen
ter
and
the
square
of
its
rst
deriv
ativ
e
b
ottom
Results
are
sho
wn
with
x
j



x
j


x
j



h


and
n


Example

Consider
the
piecewiseconstan
t
basis
function
on
a
uniform
mesh

j
x



if
x
j


x

x
j

otherwise


A
smo
oth
v
ersion
of
this
function
and
its
rst
deriv
ativ
e
are
sho
wn
in
Figure

and
ma
y
b
e
written
as

jn
x



tanh
nx

x
j


h

tanh
nx

x
j

h
	


jn
x

n
h
sec
h

nx

x
j


h

sec
h

nx

x
j

h
	
As
n



jn
approac
hes
a
square
pulse
ho
w
ev
er


jn
is
prop
ortional
to
the
com
bi
nation
of
delta
functions


jn
x


x

x
j




x

x
j



F
unction
Spaces
and
Appro
ximation

Th
us
w
e
an
ticipate
problems
since
delta
functions
are
not
elemen
ts
of
L


Squaring


jn
x


jn
x	



n
h


sec
h

nx

x
j


h
sec
h

nx

x
j


h
sec
h

nx

x
j

h
sec
h

nx

x
j

h
	
As
sho
wn
in
Figure

the
function
sec
h
nx

x
j
h
is
largest
at
x
j
and
deca
ys
exp
onen
tially
fast
from
x
j

th
us
the
cen
ter
term
in
the
ab
o
v
e
expression
is
exp
onen
tially
small
relativ
e
to
the
rst
and
third
terms
Neglecting
it
yields


jn
x	



n
h


sec
h

nx

x
j


h

sec
h

nx

x
j

h
	
Th
us
Z




jn
x	

dx

n
h
tanh
nx

x
j


h


sec
h

nx

x
j


h


tanh
nx

x
j

h


sec
h

nx

x
j

h
	



This
is
un
b
ounded
as
n


hence


j
x


L

and

j
x


H


−0.5
0
0.5
1
1.5
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
−0.5
0
0.5
1
1.5
−10
−8
−6
−4
−2
0
2
4
6
8
10
Figure

Smo
oth
v
ersion
of
a
piecewise
constan
t
function

left
and
its
rst
deriv
ativ
e
righ
t
Results
are
sho
wn
with
x
j



x
j


h


and
n


Although
the
previous
examples
lac
k
rigor
w
e
ma
y
conclude
that
a
basis
of
con
tin
uous
functions
will
b
elong
to
H

in
one
dimension
More
generally

u

H
k
implies
that
u

C
k

in
one
dimension
The
situation
is
not
as
simple
in
t
w
o
and
three
dimensions
The
Sob
olev
space
H
k
is
the
completion
with
resp
ect
to
the
norm

of
C
k
functions
whose
rst
k
partial
deriv
ativ
es
are
elemen
ts
of
L


Th
us
for
example
u

H

implies
that
u
u
x

and
u
y
are
all
elemen
ts
of
L


This
is
not
sucien
t
to
ensure
that
u
is
con
tin
uous
in
t
w
o
and
three
dimensions
T
ypically

if


is
smo
oth
then
u

H
k
implies
that
u

C
s

	


where
s
is
the
largest
in
teger
less
than
k

d
in
d
dimensions

	
In
t
w
o
and
three
dimensions
this
condition
implies
that
u

C
k


Problems


MultiDimensional
V
ariational
Principles

Assuming
that
px
y



and
q
x
y



x
y



nd
an
y
other
conditions
that
m
ust
b
e
satised
for
the
strain
energy
Av

u

Z
Z

pv
x
u
x

v
y
u
y


q
v
u	dxdy
to
b
e
an
inner
pro
duct
and
norm
ie
to
satisfy
Denitions

and


Construct
a
v
ariational
problem
for
the
fourthorder
biharmonic
equation
pu

f
x
y

x
y



where
u

u
xx

u
y
y
and
px
y



is
smo
oth
Assume
that
u
satises
the
essen
tial
b
oundary
conditions
ux
y



u
n
x
y



x
y




where
n
is
a
unit
out
w
ard
normal
v
ector
to


T
o
what
function
space
should
the
w
eak
solution
of
the
v
ariational
problem
b
elong

Ov
erview
of
the
Finite
Elemen
t
Metho
d
Let
us
conclude
this
c
hapter
with
a
brief
summary
of
the
k
ey
steps
in
constructing
a
nite
elemen
t
solution
in
t
w
o
or
three
dimensions
Although
not
necessary

w
e
will
con
tin
ue
to
fo
cus
on

as
a
mo
del

Construct
a
variational
form
of
the
pr
oblem
Generally

w
e
will
use
Galerkins
metho
d
to
construct
a
v
ariational
problem
As
describ
ed
this
in
v
olv
es
m
ultiplying
the
dieren
tial
equation
b
e
a
suitable
test
function
and
using
the
div
ergence
theorem
to
get
a
symmetric
form
ulation
The
trial
function
u

H

E
and
hence
satises
an
y
prescrib
ed
essen
tial
b
oundary
conditions
The
test
function
v

H


and
hence
v
anishes
where
essen
tial
b
oundary
conditions
are
prescrib
ed
An
y
prescrib
ed
Neumann
or
Robin
b
ound
ary
conditions
are
used
to
alter
the
v
ariational
problem
as
eg
with

or
b
resp
ectiv
ely

Non
trivial
essen
tial
b
oundary
conditions
in
tro
duce
dierences
in
the
spaces
H

E
and
H



F
urthermore
the
nite
elemen
t
subspace
S
N
E
cannot
satisfy
nonp
olynomial
b
ound
ary
conditions
One
w
a
y
of
o
v
ercoming
this
is
to
transform
the
dieren
tial
equation
to
one
ha
ving
trivial
essen
tial
b
oundary
conditions
cf
Problem

at
the
end
of
this
sec
tion
This
approac
h
is
dicult
to
use
when
the
b
oundary
data
is
discon
tin
uous
or
when
the
problem
is
nonlinear
It
is
more
imp
ortan
t
for
theoretical
than
for
practical
reasons


Ov
erview
of
the
Finite
Elemen
t
Metho
d

The
usual
approac
h
for
handling
non
trivial
Diric
hlet
data
is
to
in
terp
olate
it
b
y
the
nite
elemen
t
trial
function
Th
us
consider
appro
ximations
in
the
usual
form
U
x
y


N
X
j

c
j

j
x
y


ho
w
ev
er
w
e
include
basis
functions

k
for
mesh
en
tities
v
ertices
edges
k
that
are
on


E

The
co
ecien
ts
c
k
asso
ciated
with
these
no
des
are
not
v
aried
during
the
solu
tion
pro
cess
but
rather
are
selected
to
in
terp
olate
the
b
oundary
data
Th
us
with
a
Lagrangian
basis
where

k
x
j

y
j



k
j

w
e
ha
v
e
U
x
k

y
k



x
k

y
k


c
k

x
k

y
k




E

The
in
terp
olation
is
more
dicult
with
hierarc
hical
functions
but
it
is
manageable
cf
Section

W
e
will
ha
v
e
to
appraise
the
eect
of
this
in
terp
olation
on
solution
accuracy

Although
the
spaces
S
N
E
and
S
N

dier
the
stiness
and
mass
matrices
can
b
e
made
symmetric
for
selfadjoin
t
linear
problems
cf
Section

A
third
metho
d
of
satisfying
essen
tial
b
oundary
conditions
is
giv
en
as
Problem

at
the
end
of
this
section

Discr
etize
the
domain
Divide

in
to
nite
elements
ha
ving
simple
shap
es
suc
h
as
triangles
or
quadrilaterals
in
t
w
o
dimensions
and
tetrahedra
and
hexahedra
in
three
dimensions
This
non
trivial
task
generally
in
tro
duces
errors
near


Th
us
the
problem
is
t
ypically
solv
ed
on
a
p
olygonal
region
 

dened
b
y
the
nite
elemen
t
mesh
Figure

rather
than
on

Suc
h
errors
ma
y
b
e
reduced
b
y
using
nite
elemen
ts
with
curv
ed
sides
and!or
faces
near


cf
Chapter

The
relativ
e
adv
an
tages
of
using
few
er
curv
ed
elemen
ts
or
a
larger
n
um
b
er
of
smaller
straigh
tsided
or
planarfaced
elemen
ts
will
ha
v
e
to
b
e
determined

Gener
ate
the
element
stiness
and
mass
matric
es
and
element
lo
ad
ve
ctor
Piece
wise
p
olynomial
appro
ximations
U

S
N
E
of
u
and
V

S
N

of
v
are
c
hosen
The
appro
x
imating
spaces
S
N
E
and
S
N

are
supp
osed
to
b
e
subspaces
of
H

E
and
H



resp
ectiv
ely
ho
w
ev
er
this
ma
y
not
b
e
the
case
b
ecause
of
errors
in
tro
duced
in
appro
ximating
the
essen
tial
b
oundary
conditions
and!or
the
domain

These
eects
will
also
ha
v
e
to
b
e
appraised
cf
Section

Cho
osing
a
basis
for
S
N

w
e
write
U
and
V
in
the
form
of

The
v
ariational
problem
is
written
as
a
sum
of
con
tributions
o
v
er
the
elemen
ts
and
the
elemen
t
stiness
and
mass
matrices
and
load
v
ectors
are
generated
F
or
the
mo
del
problem

this
w
ould
in
v
olv
e
solving
N

X
e
A
e
V

U


V

f

e


V



e
	


V

S
N


a


MultiDimensional
V
ariational
Principles































n
s
n
θ
u = α
β
γ
pu  +   u =
U
x
y
4
7
8
2
3
5
6
1
4
7
8
e
=
K
1 2 3 4 5 6 7 8
1
2
3
4
5
6
7
8
1
2
3
4
5
6
7
8
l =
K  , le
Figure

Tw
odimensional
domain

ha
ving
b
oundary





E
	


N
with
unit
normal
n
discretized
b
y
triangular
nite
elemen
ts
Sc
hematic
represen
tation
of
the
as
sem
bly
of
the
elemen
t
stiness
matrix
K
e
and
elemen
t
load
v
ector
l
e
in
to
the
global
stiness
matrix
K
and
load
v
ector
l
where
A
e
V

U


Z
Z

e
V
x
pU
x

V
y
pU
y

V
q
U
dxdy

b


Ov
erview
of
the
Finite
Elemen
t
Metho
d
	
V

f

e

Z
Z

e
V
f
dxdy

c

V



e

Z


e



N
V

ds
d

e
is
the
domain
o
ccupied
b
y
elemen
t
e
and
N
	
is
the
n
um
b
er
of
elemen
ts
in
the
mesh
The
b
oundary
in
tegral
d
is
zero
unless
a
p
ortion
of


e
coincides
with
the
b
oundary
of
the
nite
elemen
t
domain

 


Galerkin
form
ulations
for
selfadjoin
t
problems
suc
h
as

lead
to
minim
um
prob
lems
in
the
sense
of
Theorem

Th
us
the
nite
elemen
t
solution
is
the
b
est
solution
in
S
N
in
the
sense
of
minimizing
the
strain
energy
of
the
error
Au

U
u

U

The
strain
energy
of
the
error
is
orthogonal
to
all
functions
V
in
S
N
E
as
illustrated
in
Figure

for
threev
ectors











u
SE
N
H1
E
U
Figure

Subspace
S
N
E
of
H

E
illustrating
the
b
est
appro
ximation
prop
ert
y
of
the
solution
of
Galerkins
metho
d

Assemble
the
glob
al
stiness
and
mass
matric
es
and
lo
ad
ve
ctor
The
elemen
t
stiness
and
mass
matrices
and
load
v
ectors
that
result
from
ev
aluating
bd
are
added
directly
in
to
global
stiness
and
mass
matrices
and
a
load
v
ector
As
depicted
in
Figure

the
indices
assigned
to
unkno
wns
asso
ciated
with
mesh
en
tities
v
ertices
as
sho
wn
determine
the
correct
p
ositions
of
the
elemen
tal
matrices
and
v
ectors
in
the
global
stiness
and
mass
matrices
and
load
v
ector


MultiDimensional
V
ariational
Principles

Solve
the
algebr
aic
system
F
or
linear
problems
the
assem
bly
of

giv
es
rise
to
a
system
of
the
form
d
T
K

Mc

l	



a
where
K
and
M
are
the
global
stiness
and
mass
matrices
l
is
the
global
load
v
ector
c
T

c


c



c
N
	
T

b
and
d
T

d


d



d
N
	
T

c
Since
a
m
ust
b
e
satised
for
al
l
c
hoices
of
d
w
e
m
ust
ha
v
e
K

Mc

l

F
or
the
mo
del
problem

K

M
will
b
e
sparse
and
p
ositiv
e
denite
With
prop
er
treatmen
t
of
the
b
oundary
conditions
it
will
also
b
e
symmetric
cf
Chapter

Eac
h
step
in
the
nite
elemen
t
solution
will
b
e
examined
in
greater
detail
Basis
construction
is
describ
ed
in
Chapter

mesh
generation
and
assem
bly
app
ear
in
Chapter

error
analysis
is
discussed
in
Chapter

and
linear
algebraic
solution
strategies
are
presen
ted
in
Chapter

Problems

By
in
tro
ducing
the
transformation
"
u

u


sho
w
that

can
b
e
c
hanged
to
a
problem
with
homogeneous
essen
tial
b
ound
ary
conditions
Th
us
w
e
can
seek
"
u

H




Another
metho
d
of
treating
essen
tial
b
oundary
conditions
is
to
remo
v
e
them
b
y
using
a
p
enalt
y
function
P
enalt
y
metho
ds
are
rarely
used
for
this
purp
ose
but
they
are
imp
ortan
t
for
other
reasons
This
problem
will
in
tro
duce
the
concept
and
reinforce
the
material
of
Section

Consider
the
v
ariational
statemen
t

as
an
example
and
mo
dify
it
b
y
including
the
essen
tial
b
oundary
conditions
Av

u

v

f


v





N


v



u



E

v

H


Here

is
a
p
enalt
y
parameter
and
subscripts
on
the
b
oundary
in
tegral
indicate
their
domain
No
b
oundary
conditions
are
applied
and
the
problem
is
solv
ed
for
u
and
v
ranging
o
v
er
the
whole
of
H




Ov
erview
of
the
Finite
Elemen
t
Metho
d

Sho
w
that
smo
oth
solutions
of
this
v
ariational
problem
satisfy
the
dieren
tial
equa
tion
a
as
w
ell
as
the
natural
b
oundary
conditions
c
and
u

p


u

n



x
y



E

The
p
enalt
y
parameter

m
ust
b
e
selected
large
enough
for
this
natural
b
oundary
condition
to
appro
ximate
the
prescrib
ed
essen
tial
condition
b
This
can
b
e
tric
ky

If
selected
to
o
large
it
will
in
tro
duce
illconditioning
in
to
the
resulting
algebraic
system


MultiDimensional
V
ariational
Principles

Bibliograph
y
	
RA
Adams
Sob
olev
Sp
ac
es
Academic
Press
New
Y
ork
	
	
O
Axelsson
and
VA
Bark
er
Finite
Element
Solution
of
Boundary
V
alue
Pr
oblems
Academic
Press
Orlando
	
	
C
Geoman
and
G
P
edric
k
First
Course
in
F
unctional
A
nalysis
Pren
ticeHall
Englew
o
o
d
Clis
	
	
P
R
Halmos
Me
asur
e
The
ory
SpringerV
erlag
New
Y
ork
		
	
JT
Oden
and
LF
Demk
o
wicz
Applie
d
F
unctional
A
nalysis
CR
C
Press
Bo
ca
Raton
		
	
R
W
ait
and
AR
Mitc
hell
The
Finite
Element
A
nalysis
and
Applic
ations
John
Wiley
and
Sons
Chic
hester
	


Chapter

Finite
Elemen
t
Appro
ximation

In
tro
duction
Our
goal
in
this
c
hapter
is
the
dev
elopmen
t
of
piecewisep
olynomial
appro
ximations
U
of
a
t
w
o
or
threedimensional
function
u
F
or
this
purp
ose
it
suces
to
regard
u
as
b
eing
kno
wn
and
to
determine
U
as
its
in
terp
olan
t
on
a
domain

Concen
trating
on
t
w
o
dimensions
for
the
momen
t
let
us
partition

in
to
a
collection
of
nite
elemen
ts
and
write
U
in
the
customary
form
U
x
y

	
N
X
j

c
j

j
x
y


As
w
e
discussed
it
is
con
v
enien
t
to
asso
ciate
eac
h
basis
function

j
with
a
mesh
en
tit
y

eg
a
v
ertex
edge
or
elemen
t
in
t
w
o
dimensions
and
a
v
ertex
edge
face
or
elemen
t
in
three
dimensions
W
e
will
discuss
these
en
tities
and
their
hierarc
hical
relationship
further
in
Chapter

F
or
no
w
if

j
is
asso
ciated
with
the
en
tit
y
indexed
b
y
j

then
as
describ
ed
in
Chapters

and

nite
elemen
t
bases
are
constructed
so
that

j
is
nonzero
only
on
elemen
ts
con
taining
en
tit
y
j

The
supp
ort
of
t
w
odimensional
basis
functions
asso
ciated
with
a
v
ertex
an
edge
and
an
elemen
t
in
terior
is
sho
wn
in
Figure

As
in
one
dimension
nite
elemen
t
bases
are
constructed
implicitly
in
an
elemen
t
b
yelemen
t
manner
in
terms
of
shap
e
functions
cf
Section

Once
again
a
shap
e
function
on
an
elemen
t
e
is
the
restriction
of
a
basis
function

j
x
y

to
elemen
t
e
W
e
pro
ceed
b
y
constructing
shap
e
functions
on
triangular
elemen
ts
Section


quadrilaterals
Sections


tetrahedra
Section

and
hexahedra
Section




Finite
Elemen
t
Appro
ximation








































































Figure

Supp
ort
of
basis
functions
asso
ciated
with
a
v
ertex
edge
and
elemen
t
in
terior
left
to
righ
t

Lagrange
Shap
e
F
unctions
on
T
riangles
P
erhaps
the
simplest
t
w
odimensional
Lagrangian
nite
elemen
t
basis
is
a
piecewiselinear
p
olynomial
on
a
grid
of
triangular
elemen
ts
It
is
the
t
w
odimensional
analog
of
the
hat
functions
in
tro
duced
in
Section

Consider
an
arbitrary
triangle
e
with
its
v
ertices
indexed
as


and

and
v
ertex
j
ha
ving
co
ordinates
x
j

y
j

j
	



Figure

The
linear
shap
e
function
N
j
x
y

asso
ciated
with
v
ertex
j
satises
N
j
x
k

y
k

	

jk

j
k
	




Again
w
e
omit
the
subscript
e
from
N
je
whenev
er
it
is
clear
that
w
e
are
discussing
a
single
elemen
t
Let
N
j
ha
v
e
the
form
N
j
x
y

	
a

bx

cy

x
y



e

where

e
is
the
domain
o
ccupied
b
y
elemen
t
e
Imp
osing
conditions

pro
duces







	



x
j
y
j

x
k
y
k

x
l
y
l




a
b
c



k
	
l
	
j
j
k

l
	



Solving
this
system
b
y
Crammers
rule
yields
N
j
x
y

	
D
k
l
x
y

C
jk
l

k
	
l
	
j
j
k

l
	



a
where
D
k
l
	
det



x
y

x
k
y
k

x
l
y
l



b


Lagrange
Shap
e
F
unctions
on
T
riangles












2
3
1
(x  ,y  )
(x  ,y  )
(x  ,y  )
1
1
2
2
3
3
Figure

T
riangular
elemen
t
with
v
ertices



ha
ving
co
ordinates
x


y


x


y


and
x


y


2
1
3
N
1
2
3
φ1
1
Figure

Shap
e
function
N

for
No
de

of
elemen
t
e
left
and
basis
function


for
a
cluster
of
four
nite
elemen
ts
at
No
de

C
jk
l
	
det



x
j
y
j

x
k
y
k

x
l
y
l



c
Basis
functions
are
constructed
b
y
com
bining
shap
e
functions
on
neigh
b
oring
elemen
ts
as
describ
ed
in
Section

A
sample
basis
function
for
a
fourelemen
t
cluster
is
sho
wn
in
Figure

The
implicit
construction
of
the
basis
in
terms
of
shap
e
function
eliminates
the
need
to
kno
w
detailed
geometric
information
suc
h
as
the
n
um
b
er
of
elemen
ts
sharing


Finite
Elemen
t
Appro
ximation
a
no
de
Placing
the
three
no
des
at
elemen
t
v
ertices
guaran
tees
a
con
tin
uous
basis
While
in
terp
olation
at
three
noncolinear
p
oin
ts
is
necessary
and
sucien
t
to
determine
a
unique
linear
p
olynomial
it
will
not
determine
a
con
tin
uous
appro
ximation
With
v
ertex
placemen
t
the
shap
e
function
eg
N
j

along
an
y
elemen
t
edge
is
a
linear
function
of
a
v
ariable
along
that
edge
This
linear
function
is
determined
b
y
the
no
dal
v
alues
at
the
t
w
o
v
ertex
no
des
on
that
edge
eg
j
and
k

As
sho
wn
in
Figure

the
shap
e
function
on
a
neigh
b
oring
edge
is
determined
b
y
the
same
t
w
o
no
dal
v
alues
th
us
the
basis
eg

j

is
con
tin
uous
The
restriction
of
U
x
y

to
elemen
t
e
has
the
form
U
x
y

	
c

N

x
y


c

N

x
y


c

N

x
y

x
y



e


Using

w
e
ha
v
e
c
j
	
U
x
j

y
j

j
	



The
construction
of
higherorder
Lagrangian
shap
e
functions
pro
ceeds
in
the
same
manner
In
order
to
construct
a
p
thdegree
p
olynomial
appro
ximation
on
elemen
t
e
w
e
in
tro
duce
N
j
x
y

j
	






n
p

shap
e
functions
at
n
p
no
des
where
n
p
	
p

p




is
the
n
um
b
er
of
monomial
terms
in
a
complete
p
olynomial
of
degree
p
in
t
w
o
dimensions
W
e
ma
y
write
a
shap
e
function
in
the
form
N
j
x
y

	
n
p
X
i
a
i
q
i
x
y

	
a
T
qx
y

a
where
q
T
x
y

	

x
y

x


xy

y






y
p

b
Th
us
for
example
a
second
degree
p
	

p
olynomial
w
ould
ha
v
e
n

	

co
ecien
ts
and
q
T
x
y

	

x
y

x


xy

y


Including
all
n
p
monomial
terms
in
the
p
olynomial
appro
ximation
ensures
isotrop
y
in
the
sense
that
the
degree
of
the
trial
function
is
conserv
ed
under
co
ordinate
translation
and
rotation
With
six
parameters
w
e
consider
constructing
a
quadratic
Lagrange
p
olynomial
b
y
placing
no
des
at
the
v
ertices
and
midsides
of
a
triangular
elemen
t
The
in
tro
duction
of
no
des
is
unnecessary

but
it
is
a
con
v
enience
Indexing
of
no
des
and
other
en
tities
will
b
e
discussed
in
Chapter

Here
since
w
ere
dealing
with
a
single
elemen
t
w
e
n
um
b
er
the


Lagrange
Shap
e
F
unctions
on
T
riangles







































































1
2
3
4
5
6
1
2
3
4
5
6
7
8
9
10
Figure

Arrangemen
t
of
no
des
for
quadratic
left
and
cubic
righ
t
Lagrange
nite
elemen
t
appro
ximations
no
des
from

to

as
sho
wn
in
Figure

The
shap
e
functions
ha
v
e
the
form

with
n

	

N
j
	
a


a

x

a

y

a

x


a

xy

a

y


and
the
six
co
ecien
ts
a
j

j
	







are
determined
b
y
requiring
N
j
x
k

y
k

	

jk

j
k
	







The
basis

j
	

N

e
N
je
x
y

is
con
tin
uous
b
y
virtue
of
the
placemen
t
of
the
no
des
The
shap
e
function
N
je
is
a
quadratic
function
of
a
lo
cal
co
ordinate
on
eac
h
edge
of
the
triangle
This
quadratic
function
of
a
single
v
ariable
is
uniquely
determined
b
y
the
v
alues
of
the
shap
e
functions
at
the
three
no
des
on
the
giv
en
edge
Shap
e
functions
on
shared
edges
of
neigh
b
oring
triangles
are
determined
b
y
the
same
no
dal
v
alues
hence
ensuring
that
the
basis
is
globally
of
class
C


The
construction
of
cubic
appro
ximations
w
ould
pro
ceed
in
the
same
manner
A
complete
cubic
in
t
w
o
dimensions
has

parameters
These
parameters
can
b
e
deter
mined
b
y
selecting

no
des
on
eac
h
elemen
t
F
ollo
wing
the
reasoning
describ
ed
ab
o
v
e
w
e
should
place
four
no
des
on
eac
h
edge
since
a
cubic
function
of
one
v
ariable
is
uniquely
determined
b
y
prescribing
four
quan
tities
This
accoun
ts
for
nine
of
the
ten
no
des
The
last
no
de
can
b
e
placed
at
the
cen
troid
as
sho
wn
in
Figure

The
construction
of
Lagrangian
appro
ximations
is
straigh
t
forw
ard
but
algebraically
complicated
Complexit
y
can
b
e
signican
tly
reduced
b
y
using
one
of
the
follo
wing
t
w
o
co
ordinate
transformations


Finite
Elemen
t
Appro
ximation






























































3 (x  ,y  )
1 (x  ,y  )
y
x
1
1
3
3
1 (0,0)
2 (1,0)
3 (0,1)
ξ
η
N  = 0
2
1
1
3
1
3
N  = 1
2 (x  ,y  )
2
2
N  = 0
2
1
N  = 1
Figure

Mapping
an
arbitrary
triangular
elemen
t
in
the
x
y
plane
left
to
a
canonical


righ
t
triangle
in
the



plane
righ
t

T
r
ansformation
to
a
c
anonic
al
element
The
idea
is
to
transform
an
arbitrary
elemen
t
in
the
ph
ysical
x
y
plane
to
one
ha
ving
a
simpler
geometry
in
a
computational



plane
F
or
purp
oses
of
illustration
consider
an
arbitrary
triangle
ha
ving
v
ertex
no
des
n
um
b
ered


and

whic
h
is
mapp
ed
b
y
a
linear
transformation
to
a
unit


righ
t
triangle
as
sho
wn
in
Figure

Consider
N


and
N


as
dened
b
y

A
sup
erscript

has
b
een
added
to
emphasize
that
the
shap
e
functions
are
linear
p
olynomials
The
equation
of
the
line
connecting
No
des

and

of
the
triangular
elemen
t
sho
wn
on
the
left
of
Figure

is
N


	

Lik
ewise
the
equation
of
a
line
passing
through
No
de

and
parallel
to
the
line
passing
through
No
des

and

is
N


	

Th
us
to
map
the
line
N


	

on
to
the
line

	

in
the
canonical
plane
w
e
should
set

	
N


x
y

Similarly

the
line
joining
No
des

and

satises
the
equation
N


	

W
e
w
ould
lik
e
this
line
to
b
ecome
the
line

	

in
the
transformed
plane
so
our
mapping
m
ust
b
e

	
N


x
y

Therefore
using


	
N


x
y

	
det



x
y

x

y


x

y



det



x

y


x

y


x

y





	
N


x
y

	
det



x
y

x

y


x

y



det



x

y


x

y


x

y





As
a
c
hec
k
ev
aluate
the
determinan
ts
and
v
erify
that
x


y





x


y





and
x


y





P
olynomials
ma
y
no
w
b
e
dev
elop
ed
on
the
canonical
triangle
to
simplify
the
algebraic


Lagrange
Shap
e
F
unctions
on
T
riangles





























































2
3
4
5
6
7
8
1
9
N  = 0
N  = 0
N  = 1/3
N  = 2/3
10
1
1
1
1
1
1
1
2
Figure

Geometry
of
a
triangular
nite
elemen
t
for
a
cubic
p
olynomial
Lagrange
appro
ximation
complexit
y
and
subsequen
tly
transformed
bac
k
to
the
ph
ysical
elemen
t

T
r
ansformation
using
triangular
c
o
or
dinates
A
simple
pro
cedure
for
constructing
Lagrangian
appro
ximations
in
v
olv
es
the
use
of
a
redundan
t
co
ordinate
system
The
construction
ma
y
b
e
describ
ed
in
general
terms
but
an
example
suces
to
illustrate
the
pro
cedure
Th
us
consider
the
construction
of
a
cubic
appro
ximation
on
the
triangular
elemen
t
sho
wn
in
Figure

The
v
ertex
no
des
are
n
um
b
ered


and

edge
no
des
are
n
um
b
ered

to
	
and
the
cen
troid
is
n
um
b
ered
as
No
de

Observ
e
that

the
line
N


	

passes
through
No
des



and


the
line
N


	

passes
through
No
des


and

and

the
line
N


	

passes
through
No
des

and
	
Since
N


m
ust
v
anish
at
No
des



and
b
e
a
cubic
p
olynomial
it
m
ust
ha
v
e
the
form
N


x
y

	

N


N



N




where
the
constan
t

is
determined
b
y
normalizing
N


x


y


	

Since
N


x


y


	

w
e
nd

	
	
and
N


x
y

	
	

N


N



N




The
shap
e
function
for
an
edge
no
de
is
constructed
in
a
similar
manner
F
or
example
in
order
to
obtain
N


w
e
observ
e
that

the
line
N


	

passes
through
No
des

	

and



Finite
Elemen
t
Appro
ximation

the
line
N


	

passes
through
No
des



and

and

the
line
N


	

passes
through
No
des


and

Th
us
N


m
ust
ha
v
e
the
form
N


x
y

	

N


N


N




Normalizing
N


x


y


	

giv
es
N


x


y


	












Hence

	

and
N


x
y

	


N


N


N




Finally

the
shap
e
function
N


m
ust
v
anish
on
the
b
oundary
of
the
triangle
and
is
th
us
determined
as
N


x
y

	
N


N


N



The
cubic
shap
e
functions
N



N



and
N


are
sho
wn
in
Figure

The
three
linear
shap
e
functions
N

j

j
	



can
b
e
regarded
as
a
redundan
t
co
ordinate
system
kno
wn
as
triangular
or
barycen
tric
co
ordinates
T
o
b
e
more
sp
ecic
consider
an
arbitrary
triangle
with
v
ertices
n
um
b
ered


and

as
sho
wn
in
Figure

Let
	

	
N



	

	
N



	

	
N




and
dene
the
transformation
from
triangular
to
ph
ysical
co
ordinates
as


x
y



	


x

x

x

y

y

y








	

	

	





Observ
e
that
	


	


	


has
v
alue

at
v
ertex


at
v
ertex

and

at
v
ertex

An
alternate
and
more
common
denition
of
the
triangular
co
ordinate
system
in
v
olv
es
ratios
of
areas
of
subtriangles
to
the
whole
triangle
Th
us
let
P
b
e
an
arbitrary
p
oin
t
in
the
in
terior
of
the
triangle
then
the
triangular
co
ordinates
of
P
are
	

	
A
P

A


	

	
A
P

A


	

	
A
P

A


	
where
A

is
the
area
of
the
triangle
A
P

is
the
area
of
the
subtriangle
ha
ving
v
ertices
P



etc


Lagrange
Shap
e
F
unctions
on
T
riangles
	
0
0.2
0.4
0.6
0.8
1
0
0.2
0.4
0.6
0.8
1
−0.2
0
0.2
0.4
0.6
0.8
1
1.2
0
0.2
0.4
0.6
0.8
1
0
0.2
0.4
0.6
0.8
1
−0.4
−0.2
0
0.2
0.4
0.6
0.8
1
1.2
0
0.2
0.4
0.6
0.8
1
0
0.2
0.4
0.6
0.8
1
0
0.2
0.4
0.6
0.8
1
Figure

Cubic
Lagrange
shap
e
functions
asso
ciated
with
a
v
ertex
left
an
edgerigh
t
and
the
cen
troid
b
ottom
of
a
righ
t


triangular
elemen
t
The
triangular
co
ordinate
system
is
redundan
t
since
t
w
o
quan
tities
suce
to
lo
cate
a
p
oin
t
in
a
plane
This
redundancy
is
expressed
b
y
the
third
of
equations

whic
h
states
that
	


	


	

	

This
relation
also
follo
ws
b
y
adding
equations
	
Although
seemingly
distinct
triangular
co
ordinates
and
the
canonical
co
ordinates
are
closely
related
The
triangular
co
ordinate
	

is
equiv
alen
t
to
the
canonical
co
ordinate

and
	

is
equiv
alen
t
to


as
seen
from

and

Problems

With
reference
to
the
no
dal
placemen
t
and
n
um
b
ering
sho
wn
on
the
left
of
Figure

construct
the
shap
e
functions
for
No
des

and

of
the
quadratic
Lagrange
p
olynomial
Deriv
e
y
our
answ
er
using
triangular
co
ordinates
Ha
ving
done
this
also
express
y
our
answ
er
in
terms
of
the
canonical




co
ordinates
Plot
or
sk
etc
h


Finite
Elemen
t
Appro
ximation
3 (0,0,1)
2 (0,1,0)
1 (1,0,0)
P( ζ  ,ζ  ,ζ  )
1
2
3
ζ  = 0
ζ  = 0
ζ  = 0
1
2
3
1ζ  = 1
Figure

T
riangular
co
ordinate
system
the
t
w
o
shap
e
functions
on
the
canonical
elemen
t

A
Lagrangian
appro
ximation
of
degree
p
on
a
triangle
has
three
no
des
at
the
v
ertices
and
p


no
des
along
eac
h
edge
that
are
not
at
v
ertices
As
w
ev
e
discussed
the
latter
placemen
t
ensures
con
tin
uit
y
on
a
mesh
of
triangular
elemen
ts
If
no
additional
no
des
are
placed
on
edges
ho
w
man
y
no
des
are
in
terior
to
the
elemen
t
if
the
appro
ximation
is
to
b
e
complete

Lagrange
Shap
e
F
unctions
on
Rectangles
The
triangle
in
t
w
o
dimensions
and
the
tetrahedron
in
three
dimensions
are
the
p
oly
hedral
shap
es
ha
ving
the
minim
um
n
um
b
er
of
edges
and
faces
They
are
optimal
for
dening
complete
C

Lagrangian
p
olynomials
Ev
en
so
Lagrangian
in
terp
olan
ts
are
simple
to
construct
on
rectangles
and
hexahedra
b
y
taking
pro
ducts
of
onedimensional
Lagrange
p
olynomials
Multidimensional
p
olynomials
formed
in
this
manner
are
called
tensorpro
duct
appro
ximations
w
ell
pro
ceed
b
y
constructing
p
olynomial
shap
e
func
tions
on
canonical



square
elemen
ts
and
mapping
these
elemen
ts
to
an
arbitrary
quadrilateral
elemen
ts
W
e
describ
e
a
simple
bilinear
mapping
here
and
p
ostp
one
more
complex
mappings
to
Chapter

W
e
consider
the
canonical



square
f


j







g
sho
wn
in
Figure

F
or
simplicit
y

the
v
ertices
of
the
elemen
t
ha
v
e
b
een
indexed
with
a
double
subscript
as






and


A
t
times
it
will
b
e
con
v
enien
t
to
index
the
v
ertex
co
ordinats
as


	



	



	

and


	

With
no
des
at
eac
h
v
ertex
w
e
construct
a
bilinear
Lagrangian
p
olynomial
U




whose
restriction
to
the
canonical


Lagrange
Shap
e
F
unctions
on
Rectangles





















































x
1,1
1,2
y
1,2
2,1
2,2
3,2
2,2
2,1
3,1
1,1
3,3
2,3
1,3
Figure

No
de
indexing
for
canonical
square
elemen
ts
with
bilinear
left
and
bi
quadratic
righ
t
p
olynomial
shap
e
functions
elemen
t
has
the
form
U




	
c

N






c

N






c

N






c

N





a
As
with
Lagrangian
p
olynomials
on
triangles
the
shap
e
function
N
ij




satises
N
ij

k


l

	

ik

jl

k

l
	


b
Once
again
U

k


l

	
c
k
l

ho
w
ev
er
no
w
N
ij
is
the
pro
duct
of
onedimensional
hat
functions
N
ij




	

N
i



N
j


c
with

N



	





d

N



	










e
Similar
form
ulas
apply
to

N
j


j
	


with

replaced
b
y

and
i
replaced
b
y
j

The
shap
e
function
N

is
sho
wn
in
Figure

By
examination
of
either
this
gure
or
ce
w
e
see
that
N
ij




is
a
bilinear
function
of
the
form
N
ij




	
a


a



a



a












The
shap
e
function
is
linear
along
the
t
w
o
edges
con
taining
no
de
i
j

and
it
v
anishes
along
the
t
w
o
opp
osite
edges
A
basis
ma
y
b
e
constructed
b
y
uniting
shap
e
functions
on
elemen
ts
sharing
a
no
de
The
piecewise
bilinear
basis
functions

ij
when
No
de
i
j

is
at
the
in
tersection
of
four


Finite
Elemen
t
Appro
ximation
−1
−0.5
0
0.5
1
−1
−0.5
0
0.5
1
0
0.2
0.4
0.6
0.8
1
−1
−0.5
0
0.5
1
−1
−0.5
0
0.5
1
0
0.2
0.4
0.6
0.8
1
Figure

Bilinear
shap
e
function
N

on
the





canonical
square
elemen
t
left
and
bilinear
basis
function
at
the
in
tersection
of
four
square
elemen
ts
righ
t
square
elemen
ts
is
sho
wn
in
Figure

Since
eac
h
shap
e
function
is
a
linear
p
olynomial
along
elemen
t
edges
the
basis
will
b
e
con
tin
uous
on
a
grid
of
square
or
rectangular
ele
men
ts
The
restriction
to
a
square
or
rectangular
grid
is
critical
and
the
appro
ximation
w
ould
not
b
e
con
tin
uous
on
an
arbitrary
mesh
of
quadrilateral
elemen
ts
T
o
construct
biquadratic
shap
e
functions
on
the
canonical
square
w
e
in
tro
duce
	
no
des



and

at
the
v
ertices



and

at
mid
sides
and

at
the
cen
ter
Figure

The
restriction
of
the
in
terp
olan
t
U
to
this
elemen
t
has
the
form
U




	

X
i

X
j

c
ij
N
ij




a
where
the
shap
e
functions
N
ij

i
j
	



are
pro
ducts
of
the
onedimensional
quadratic
p
olynomial
Lagrange
shap
e
functions
N
ij




	

N
i



N
j


i
j
	



b
with
cf
Section


N



	





c

N



	





d

N



	










e
Shap
e
functions
for
a
v
ertex
an
edge
and
the
cen
troid
are
sho
wn
in
Figure

Using
be
w
e
see
that
shap
e
functions
are
biquadratic
p
olynomials
of
the
form
N
ij




	
a


a



a



a




a




a




a





a





a
	








Lagrange
Shap
e
F
unctions
on
Rectangles

−1
−0.5
0
0.5
1
−1
−0.5
0
0.5
1
−0.2
0
0.2
0.4
0.6
0.8
1
1.2
−1
−0.5
0
0.5
1
−1
−0.5
0
0.5
1
−0.2
0
0.2
0.4
0.6
0.8
1
1.2
−1
−0.5
0
0.5
1
−1
−0.5
0
0.5
1
0
0.2
0.4
0.6
0.8
1
Figure

Biquadratic
shap
e
functions
asso
ciated
with
a
v
ertex
left
an
edge
righ
t
and
the
cen
troid
b
ottom
Although

con
tains
some
cubic
and
quartic
monomial
terms
in
terp
olation
accuracy
is
determined
b
y
the
highestdegree
c
omplete
p
olynomial
that
can
b
e
represen
ted
exactly

whic
h
in
this
case
is
a
quadratic
p
olynomial
Higherorder
shap
e
functions
are
constructed
in
similar
fashion

Bilinear
Co
ordinate
T
ransformations
Shap
e
functions
on
the
canonical
square
elemen
ts
ma
y
b
e
mapp
ed
to
arbitrary
quadri
laterals
b
y
a
v
ariet
y
of
transformations
cf
Chapter

The
simplest
of
these
is
a
picewisebilinear
function
that
uses
the
same
shap
e
functions
de
as
the
nite
el
emen
t
solution
a
Th
us
consider
a
mapping
of
the
canonical



square
S
to
a
quadrilateral
Q
ha
ving
v
ertices
at
x
ij

y
ij

i
j
	


in
the
ph
ysical
x
y
plane
Figure

using
a
bilinear
transformation
written
in
terms
of
de
as


Finite
Elemen
t
Appro
ximation










































1,1 (x   ,y   )
(x   ,y   )
2,2 (x   ,y   )
1,2
(x   ,y   )
x
y
11
21
22
12
11
21
22
12
η
2,1
2,2
1,2
1,1
2,1
1
1
ξ
1
1
Figure

Bilinear
mapping
of
the
canonical
square
to
a
quadrilateral

x



y





	

X
i

X
j


x
ij
y
ij

N
ij





where
N
ij




is
giv
en
b
y
b
The
transformation
is
linear
on
eac
h
edge
of
the
elemen
t
In
particular
transforming
the
edge

	

to
the
ph
ysical
edge
x


y


x


y


yields

x
y

	

x

y








x

y












As

v
aries
from

to

x
and
y
v
ary
linearly
from
x


y


to
x


y


The
lo
cations
of
the
v
ertices

and

ha
v
e
no
eect
on
the
transformation
This
ensures
that
a
con
tin
uous
appro
ximation
in
the



plane
will
remain
con
tin
uous
when
mapp
ed
to
the
x
y
plane
W
e
ha
v
e
to
ensure
that
the
mapping
is
in
v
ertible
and
w
ell
sho
w
in
Chapter

that
this
is
the
case
when
Q
is
con
v
ex
Problems

As
noted
in
terp
olation
errors
of
the
biquadratic
appro
ximation

are
the
same
order
as
for
a
quadratic
appro
ximation
on
a
triangle
Th
us
for
example
the
L

error
in
in
terp
olating
a
smo
oth
function
ux
y

b
y
a
piecewise
biquadratic
function
U
x
y

is
O
h


where
h
is
the
length
of
the
longest
edge
of
an
elemen
t
The
extra
degrees
of
freedom
asso
ciated
with
the
cubic
and
quartic
terms
do
not
gen
erally
impro
v
e
the
order
of
accuracy

Hence
w
e
migh
t
try
to
eliminate
some
shap
e
functions
and
reduce
the
complexit
y
of
the
appro
ximation
Unkno
wns
asso
ciated
with
in
terior
shap
e
functions
are
only
coupled
to
unkno
wns
on
the
elemen
t
and
can
easily
b
e
eliminated
b
y
a
v
ariet
y
of
tec
hniques
Considering
the
biquadratic
p
oly
nomial
in
the
form
a
w
e
migh
t
determine
c

so
that
the
co
ecien
t
of
the


Hierarc
hical
Shap
e
F
unctions

quartic
term
x

y

v
anishes
Sho
w
ho
w
this
ma
y
b
e
done
for
a



square
canon
ical
elemen
t
P
olynomials
of
this
t
yp
e
ha
v
e
b
een
called
ser
endipity
b
y
Zienkiewicz

In
the
next
section
w
e
shall
see
that
they
are
also
a
part
of
the
hierarc
hical
family
of
appro
ximations
The
parameter
c

is
said
to
b
e
constrained
since
it
is
prescrib
ed
in
adv
ance
and
not
determined
as
part
of
the
Galerkin
pro
cedure
Plot
or
sk
etc
h
shap
e
functions
asso
ciated
with
a
v
ertex
and
a
midside

Hierarc
hical
Shap
e
F
unctions
W
e
ha
v
e
discussed
the
adv
an
tages
of
hierarc
hical
bases
relativ
e
to
Lagrangian
bases
for
onedimensional
problems
in
Section

Similar
adv
an
tages
apply
in
t
w
o
and
three
di
mensions
W
ell
again
use
the
basis
of
Szab
o
and
Babu
 
sk
a

but
follo
w
the
construction
pro
cedure
of
Shephard
et
al

and
Dey
et
al

Hierarc
hical
bases
of
degree
p
ma
y
b
e
constructed
for
triangles
and
squares
Squares
are
the
simpler
of
the
t
w
o
so
let
us
handle
them
rst

Hierarc
hical
Shap
e
F
unctions
on
Squares
W
ell
construct
the
basis
on
the
canonical
elemen
t
f


j







g
indexing
the
v
ertices
edges
and
in
teriors
as
describ
ed
for
the
biquadratic
appro
ximation
sho
wn
in
Figure

The
hierarc
hical
p
olynomial
of
order
p
has
a
basis
consisting
of
the
follo
wing
shap
e
functions
V
ertex
shap
e
functions
The
four
v
ertex
shap
e
functions
are
the
bilinear
functions
ce
N

ij
	

N
i



N
j


i
j
	


a
where

N



	






N



	





b
The
shap
e
function
N


is
sho
wn
in
the
upp
er
left
p
ortion
of
Figure

Edge
shap
e
functions
F
or
p
	

there
are
p


shap
e
functions
asso
ciated
with
the
midside
no
des






and


N
k





	

N




N
k


a
N
k





	

N




N
k


b
N
k





	

N




N
k


c
N
k





	

N




N
k


k
	






p
d


Finite
Elemen
t
Appro
ximation
where

N
k


k
	






p
are
the
onedimensional
hierarc
hical
shap
e
functions
giv
en
b
y
a
as

N
k


	
r
k



Z


P
k


d

e
Edge
shap
e
functions
N
k

are
sho
wn
for
k
	



in
Figure

The
edge
shap
e
functions
are
the
pro
duct
of
a
linear
function
of
the
v
ariable
normal
to
the
edge
to
whic
h
they
are
asso
ciated
and
a
hierarc
hical
p
olynomial
of
degree
k
in
a
v
ariable
on
this
edge
The
linear
function


N
j



N
j


j
	


blends
the
edge
function


N
k



N
k


on
to
the
elemen
t
so
as
to
ensure
con
tin
uit
y
of
the
basis
Interior
shap
e
functions
F
or
p
	

there
are
p

p


in
ternal
shap
e
functions
asso
ciated
with
the
cen
troid
No
de


The
rst
in
ternal
shap
e
function
is
the
bubble
function
N


	









a
The
remaining
shap
e
functions
are
pro
ducts
of
N


and
the
Legendre
p
olynomials
as
N


	
N


P



b
N


	
N


P



c
N


	
N


P



d
N


	
N


P


P



e
N


	
N


P







f
The
sup
erscripts
k


and

resectiv
ely

giv
e
the
p
olynomial
degree
the
degree
of
P



and
the
degree
of
P



The
rst
six
in
terior
bubble
shap
e
functions
N
k






	
k


k
	



are
sho
wn
in
Figure

These
functions
v
anish
on
the
elemen
t
b
oundary
to
main
tain
con
tin
uit
y

On
the
canonical
elemen
t
the
in
terp
olan
t
U




is
written
as
the
usual
linear
com
bination
of
shap
e
functions
U




	

X
i

X
j

c

ij
N

ij

p
X
k



X
j

c
k
j
N
k
j


X
i
c
k
i
N
k
i


p
X
k

X
k

c
k


N
k




The
notation
is
somewhat
cum
b
ersome
but
it
is
explicit
The
rst
summation
iden
ties
unkno
wns
and
shap
e
functions
asso
ciated
with
v
ertices
The
t
w
o
cen
ter
summations
iden
tify
edge
unkno
wns
and
shap
e
functions
for
p
olynomial
orders

to
p
And
the
third
summation
iden
ties
the
in
terior
unkno
wns
and
shap
e
functions
of
orders

to
p


Hierarc
hical
Shap
e
F
unctions

−1
−0.5
0
0.5
1
−1
−0.5
0
0.5
1
0
0.2
0.4
0.6
0.8
1
−1
−0.5
0
0.5
1
−1
−0.5
0
0.5
1
−0.7
−0.6
−0.5
−0.4
−0.3
−0.2
−0.1
0
−1
−0.5
0
0.5
1
−1
−0.5
0
0.5
1
−0.4
−0.3
−0.2
−0.1
0
0.1
0.2
0.3
0.4
−1
−0.5
0
0.5
1
−1
−0.5
0
0.5
1
−0.2
−0.15
−0.1
−0.05
0
0.05
0.1
0.15
0.2
0.25
Figure

Hierarc
hical
v
ertex
and
edge
shap
e
functions
for
k
	

upp
er
left
k
	

upp
er
righ
t
k
	

lo
w
er
left
and
k
	

lo
w
er
righ
t
Summations
are
understo
o
d
to
b
e
zero
when
their
initial
index
exceeds
the
nal
index
A
degree
p
appro
ximation
has


p




p



p




unkno
wns
and
shap
e
functions
where
q

	
maxq


This
function
is
listed
in
T
able

for
p
ranging
from

to

F
or
large
v
alues
of
p
there
are
O
p


in
ternal
shap
e
functions
and
O
p
edge
functions

Hierarc
hical
Shap
e
F
unctions
on
T
riangles
W
ell
express
the
hierarc
hical
shap
e
functions
for
triangular
elemen
ts
in
terms
of
trian
gular
co
ordinates
indexing
the
v
ertices
as


and

the
edges
as


and

and
the
cen
troid
as

Figure

The
basis
consists
of
the
follo
wing
shap
e
functions
V
ertex
Shap
e
functions
The
three
v
ertex
shap
e
functions
are
the
linear
barycen
tric
co
ordinates

N

i
	


	


	


	
	
i

i
	






Finite
Elemen
t
Appro
ximation
−1
−0.5
0
0.5
1
−1
−0.5
0
0.5
1
0
0.2
0.4
0.6
0.8
1
−1
−0.5
0
0.5
1
−1
−0.5
0
0.5
1
−0.4
−0.3
−0.2
−0.1
0
0.1
0.2
0.3
0.4
−1
−0.5
0
0.5
1
−1
−0.5
0
0.5
1
−0.4
−0.3
−0.2
−0.1
0
0.1
0.2
0.3
0.4
−1
−0.5
0
0.5
1
−1
−0.5
0
0.5
1
−0.5
−0.4
−0.3
−0.2
−0.1
0
0.1
0.2
−1
−0.5
0
0.5
1
−1
−0.5
0
0.5
1
−0.2
−0.15
−0.1
−0.05
0
0.05
0.1
0.15
−1
−0.5
0
0.5
1
−1
−0.5
0
0.5
1
−0.5
−0.4
−0.3
−0.2
−0.1
0
0.1
0.2
Figure

Hierarc
hical
in
terior
shap
e
functions
N



N


top
N



N


mid
dle
and
N



N


b
ottom


Hierarc
hical
Shap
e
F
unctions
	
p
Square
T
riangle
Dimension
Dimension
























T
able

Dimension
of
the
hierarc
hical
basis
of
order
p
on
square
and
triangular
elemen
ts
































































4
5
7
6
ζ
ζ
1
2
ξ
1 (1,0,0)
3 (0,0,1)
2 (0,1,0)
Figure

No
de
placemen
t
and
co
ordinates
for
hierarc
hical
appro
ximations
on
a
tri
angle
Edge
shap
e
functions
F
or
p
	

there
are
p


edge
shap
e
functions
whic
h
are
eac
h
nonzero
on
one
edge
to
whic
h
they
are
asso
ciated
and
v
anish
on
the
other
t
w
o
Eac
h
shap
e
function
is
selected
to
matc
h
the
corresp
onding
edge
shap
e
function
on
a
square
elemen
t
so
that
a
con
tin
uous
appro
ximation
ma
y
b
e
obtained
on
meshes
with
b
oth
triangular
and
quadrilateral
elemen
ts
Let
us
construct
of
the
shap
e
functions
N
k


k
	






p
asso
ciated
with
Edge

They
are
required
to
v
anish
on
Edges

and

and
m
ust
ha
v
e
the
form
N
k

	


	


	


	
	

	



k


k
	






p
a
where


k


is
a
shap
e
function
to
b
e
determined
and

is
a
co
ordinate
on
Edge

that
has
v
alue

at
No
de


at
No
de

and

at
No
de

Since
Edge

is
	

	

w
e
ha
v
e
N
k

	


	



	
	

	



k


	


	

	



Finite
Elemen
t
Appro
ximation
The
latter
condition
follo
ws
from

with
	

	

Along
Edge

	

ranges
from

to

and
	

ranges
from

to

as

ranges
from

to

th
us
w
e
ma
y
select
	

	




	

	




	

	

b
While

ma
y
b
e
dened
in
other
w
a
ys
this
linear
mapping
ensures
that
	


	

	

on
Edge

Compatibilit
y
with
the
edge
shap
e
function

requires
N
k

	


	



	

N
k


	










k


where

N
k


is
the
onedimensional
hierarc
hical
shap
e
function
e
Th
us


k


	


N
k







c
The
result
can
b
e
written
in
terms
of
triangular
co
ordinates
b
y
using
b
to
obtain

	
	


	


hence
N
k

	


	


	


	
	

	



k
	


	


k
	






p
a
Shap
e
functions
along
other
edges
follo
w
b
y
p
erm
uting
indices
ie
N
k

	


	


	


	
	

	



k
	


	


b
N
k

	


	


	


	
	

	



k
	


	


k
	






p
c
It
migh
t
app
ear
that
the
shap
e
functions


k


has
singularities
at

	


ho
w
ev
er
the
onedimensional
hierarc
hical
shap
e
functions
ha
v
e





as
a
factor
Th
us


k


is
a
p
olynomial
of
degree
k


Using

the
rst
four
of
them
are





	

p






	

p








	

r











	

r
	







Interior
shap
e
functions
The
p

p


in
ternal
shap
e
functions
for
p
	

are
pro
ducts
of
the
bubble
function
N


	
	

	

	

	a
and
Legendre
p
olynomials
The
Legendre
p
olynomials
are
functions
of
t
w
o
of
the
three
triangular
co
ordinates
F
ollo
wing
Szab
o
and
Babu
 
sk
a

w
e
presen
t
them
in
terms
of
	


	

and
	


Th
us
N


	
N


P

	


	


	b
N


	
N


P

	



	c
N


	
N


P

	


	


	d
N


	
N


P

	


	

P

	



	e
N


	
N


P

	







	f


ThreeDimensional
Shap
e
F
unctions

The
shift
in
	

ensures
that
the
range
of
the
Legendre
p
olynomials
is


Lik
e
the
edge
shap
e
functions
for
a
square

the
edge
shap
e
functions
for
a
triangle

are
pro
ducts
of
a
function
on
the
edge



k
	
i

	
j

and
a
function
	
i
	
j

i
	
j

that
blends
the
edge
function
on
to
the
elemen
t
Ho
w
ev
er
the
edge
functions
for
the
triangle
are
not
the
same
as
those
for
the
square
The
t
w
o
are
related
b
y
c
Ha
ving
the
same
edge
functions
for
all
elemen
t
shap
es
simplies
construction
of
the
elemen
t
stiness
matrices


W
e
can
of
course
mak
e
the
edge
functions
the
same
b
y
redening
the
blending
functions
Th
us
using
ac
the
edge
function
for
Edge

can
b
e

N
k


if
the
blending
function
is
	

	






In
a
similar
manner
using
a
and
c
the
edge
function
for
the
shap
e
function
N
k

can
b
e


k


if
the
blending
function
is

N









Shephard
et
al

sho
w
that
represen
tations
in
terms
of


k
in
v
olv
e
few
er
algebraic
op
erations
and
hence
are
preferred
The
rst
three
edge
and
in
terior
shap
e
functions
are
sho
wn
in
Figure

A
degree
p
hierarc
hical
appro
ximation
on
a
triangle
has


p




p



p




unkno
wns
and
shap
e
functions
This
function
is
listed
in
T
able

W
e
see
that
for
p


there
are
t
w
o
few
er
shap
e
functions
with
triangular
elemen
ts
than
with
squares
The
triangular
elemen
t
is
optimal
in
the
sense
of
using
the
minimal
n
um
b
er
of
shap
e
functions
for
a
complete
p
olynomial
of
a
giv
en
degree
This
ho
w
ev
er
do
es
not
mean
that
the
complexit
y
of
solving
a
giv
en
problem
is
less
with
triangular
elemen
ts
than
with
quadrilaterals
This
issue
dep
ends
on
the
partial
dieren
tial
equations
the
geometry

the
mesh
structure
and
other
factors
Carnev
ali
et
al

in
tro
duced
shap
e
functions
that
pro
duce
b
etter
conditioned
ele
men
t
stiness
matrices
at
higher
v
alues
of
p
than
the
bases
presen
ted
here

Adjerid
et
al

construct
an
alternate
basis
that
app
ears
to
further
reduce
ill
conditioning
at
high
p

ThreeDimensional
Shap
e
F
unctions
Threedimensional
nite
elemen
t
shap
e
functions
are
constructed
in
the
same
manner
as
in
t
w
o
dimensions
Common
elemen
t
shap
es
are
tetrahedra
and
hexahedra
and
w
e
will
examine
some
Lagrange
and
hierarc
hical
appro
ximations
on
these
elemen
ts


Finite
Elemen
t
Appro
ximation
0
0.2
0.4
0.6
0.8
1
0
0.2
0.4
0.6
0.8
1
−0.7
−0.6
−0.5
−0.4
−0.3
−0.2
−0.1
0
0
0.2
0.4
0.6
0.8
1
0
0.2
0.4
0.6
0.8
1
−0.4
−0.3
−0.2
−0.1
0
0.1
0.2
0.3
0.4
0
0.2
0.4
0.6
0.8
1
0
0.2
0.4
0.6
0.8
1
−0.2
−0.15
−0.1
−0.05
0
0.05
0.1
0.15
0.2
0.25
0
0.2
0.4
0.6
0.8
1
0
0.2
0.4
0.6
0.8
1
0
0.005
0.01
0.015
0.02
0.025
0.03
0.035
0.04
0
0.2
0.4
0.6
0.8
1
0
0.2
0.4
0.6
0.8
1
−0.015
−0.01
−0.005
0
0.005
0.01
0.015
0
0.2
0.4
0.6
0.8
1
0
0.2
0.4
0.6
0.8
1
−0.02
−0.015
−0.01
−0.005
0
0.005
0.01
Figure

Hierarc
hical
edge
and
in
terior
shap
e
functions
N


top
left
N


top
righ
t
N


middle
left
N


middle
righ
t
N


b
ottom
left
N


b
ottom
righ
t

Lagrangian
Shap
e
F
unctions
on
T
etrahedra
Let
us
b
egin
with
a
linear
shap
e
function
on
a
tetrahedron
W
e
in
tro
duce
four
no
des
n
um
b
ered
for
con
v
enience
as

to

at
the
v
ertices
of
the
elemen
t
Figure

Im
p
osing
the
usual
Lagrangian
conditions
that
N
j
x
k

y
k

z
k

	

j
k

j
k
	




giv
es


ThreeDimensional
Shap
e
F
unctions

the
shap
e
functions
as
















1 (1,0,0,0)
2 (0,1,0,0)
3 (0,0,1,0)
4 (0,0,0,1)
P
(ζ ,ζ ,ζ ,ζ )
1 2
4
3
Figure

No
de
placemen
t
for
linear
shap
e
functions
on
a
tetrahedron
and
denition
of
tetrahedral
co
ordinates
N
j
x
y

z

	
D
k
l
m
x
y

z

C
jk
l
m

j
k

l

m
a
p
erm
utation
of




a
where
D
k
l
m
x
y

z

	
det





x
y
z

x
k
y
k
z
k

x
l
y
l
z
l

x
m
y
m
z
m





b
C
jk
l
m
	
det





x
j
y
j
z
j

x
k
y
k
z
k

x
l
y
l
z
l

x
m
y
m
z
m





c
Placing
no
des
at
the
v
ertices
pro
duces
a
linear
shap
e
function
on
eac
h
face
that
is
uniquely
determined
b
y
its
v
alues
at
the
three
v
ertices
on
the
face
This
guaran
tees
con
tin
uit
y
of
bases
constructed
from
the
shap
e
functions
The
restriction
of
U
to
elemen
t
e
is
U
x
y

z

	

X
j

c
j
N
j
x
y

z


As
in
t
w
o
dimensions
w
e
ma
y
construct
higherorder
p
olynomial
in
terp
olan
ts
b
y
either
mapping
to
a
canonical
elemen
t
or
b
y
in
tro
ducing
tetrahedral
co
ordinates
F
o
cusing
on
the
latter
approac
h
let
	
j
	
N
j
x
y

z

j
	




a


Finite
Elemen
t
Appro
ximation




















































x
y
z
2
3
4
1
4 (0,0,1)
1 (0,0,0)
3 (0,1,0)
2 (1,0,0)
ζ
η
ξ
Figure

T
ransformation
of
an
arbitrary
tetrahedron
to
a
righ
t
unit
canonical
tetra
hedron
and
regard
	
j

j
	




as
forming
a
redundan
t
co
ordinate
system
on
a
tetrahedron
The
co
ordinates
of
a
p
oin
t
P
lo
cated
at
	


	


	


	


are
Figure

	

	
V
P

V


	

	
V
P

V


	

	
V
P

V


	

	
V
P

V


b
where
V
ij
k
l
is
the
v
olume
of
the
tetrahedron
with
v
ertices
at
i
j

k

and
l

Hence
the
co
ordinates
of
V
ertex

are




those
of
V
ertex

are




etc
The
plane
	
	

is
the
plane
A

opp
osite
to
v
ertex

etc
The
transformation
from
ph
ysical
to
tetrahedral
co
ordinates
is




x
y
z





	




x

x

x

x

y

y

y

y

z

z

z

z













	

	

	

	







The
co
ordinate
system
is
redundan
t
as
expressed
b
y
the
last
equation
The
transformation
of
an
arbitrary
tetrahedron
to
a
righ
t
unit
canonical
tetrahedron
Figure

follo
ws
the
same
lines
and
w
e
ma
y
dene
it
as

	
N

x
y

z


	
N

x
y

z

	
	
N

x
y

z


The
face
A

Figure

is
mapp
ed
to
the
plane

	

the
face
A

is
mapp
ed
to

	

and
A

is
mapp
ed
to
	
	

In
analogy
with
the
t
w
odimensional
situation
this
transformation
is
really
the
same
as
the
mapping

to
tetrahedral
co
ordinates
A
complete
p
olynomial
of
degree
p
in
three
dimensions
has
n
p
	
p

p

p






ThreeDimensional
Shap
e
F
unctions

monomial
terms
cf
eg
Brenner
and
Scott

Section

With
p
	

w
e
ha
v
e
n

	

monomial
terms
and
w
e
can
determine
Lagrangian
shap
e
functions
b
y
placing
no
des
at
the
four
v
ertices
and
at
the
midp
oin
ts
of
the
six
edges
Figure

With
p
	

w
e
ha
v
e
n

	

and
w
e
can
sp
ecify
shap
e
functions
b
y
placing
a
no
de
at
eac
h
of
the
four
v
ertices
t
w
o
no
des
on
eac
h
of
the
six
edges
and
one
no
de
on
eac
h
of
the
four
faces
Figure

Higher
degree
p
olynomials
also
ha
v
e
no
des
in
the
elemen
ts
in
terior
In
general
there
is

no
de
at
eac
h
v
ertex
p


no
des
on
eac
h
edge
p

p


no
des
on
eac
h
face
and
p

p

p


no
des
in
the
in
terior



























































































 











































1
2
3
4
5
6
8
9
10
Figure

No
de
placemen
t
for
quadratic
left
and
cubic
righ
t
in
terp
olan
ts
on
tetra
hedra
Example

The
quadratic
shap
e
function
N


asso
ciated
with
v
ertex
No
de

of
a
tetrahedron
Figure

left
is
required
to
v
anish
at
all
no
des
but
No
de

The
plane
	

	

passes
through
face
A

and
hence
No
des




	

Lik
ewise
the
plane
	

	

passes
through
No
des


not
sho
wn
and

Th
us
N


m
ust
ha
v
e
the
form
N


	


	


	


	


	

	

	



Since
N


	

at
No
de

	

	

w
e
nd

	

and
N


	


	


	


	


	
	

	



Similarly

the
shap
e
function
N


asso
ciated
with
edge
No
de

Figure

left
is
required
to
v
anish
on
the
planes
	

	

No
des




	

and
	

	

No
des






and
ha
v
e
unit
v
alue
at
No
de

	

	
	

	

Th
us
it
m
ust
b
e
N


	


	


	


	


	
	

	




Finite
Elemen
t
Appro
ximation
































































































































































































































2,2,2
1,2,1
2,1,1
2,2,1
2,1,2
1,2,2
η
1,1,1
1,1,2
ζ
ξ
Figure

No
de
placemen
t
for
a
trilinear
left
and
triquadratic
righ
t
p
olynomial
in
terp
olan
ts
on
a
cub
e

Lagrangian
Shap
e
F
unctions
on
Cub
es
In
order
to
construct
a
trilinear
appro
ximation
on
the
canonical
cub
e
f



	
j







	

g
w
e
place
eigh
t
no
des
n
um
b
ered
i
j
k

i
j
k
	


at
its
v
ertices
Figure

The
shap
e
function
asso
ciated
with
No
de
i
j
k

is
tak
en
as
N
ijk




	

	

N
i



N
j



N
k
	

a
where

N
i


i
	


are
the
hat
function
de
The
restriction
of
U
to
this
elemen
t
has
the
form
U




	

	

X
i

X
j


X
k

c
ijk
N
ijk




	

b
Once
again
c
ijk
	
U
ijk
	
U

i


j

	
k

The
placemen
t
of
no
des
at
the
v
ertices
pro
duces
bilinear
shap
e
functions
on
eac
h
face
of
the
cub
e
that
are
uniquely
determined
b
y
v
alues
at
their
four
v
ertices
on
that
face
Once
again
this
ensures
that
shap
e
functions
and
U
are
C

functions
on
a
uniform
grid
of
cub
es
or
rectangular
parallelepip
eds
Since
eac
h
shap
e
function
is
the
pro
duct
of
onedimensional
linear
p
olynomials
the
in
terp
olan
t
is
a
trilinear
function
of
the
form
U




	

	
a


a



a



a

	

a




a


	

a

	


a



	

Other
appro
ximations
and
transformations
follo
w
their
t
w
odimensional
coun
terparts
F
or
example
triquadratic
shap
e
functions
on
the
canonical
cub
e
are
constructed
b
y
placing

no
des
at
the
v
ertices
midsides
midfaces
and
cen
troid
of
the
elemen
t
Figure

The
shap
e
function
asso
ciated
with
No
de
i
j
k

is
giv
en
b
y
a
with

N
i


giv
en
b
y
bd


ThreeDimensional
Shap
e
F
unctions


Hierarc
hical
Appro
ximations
As
with
the
t
w
odimensional
hierarc
hical
appro
ximations
describ
ed
in
Section

w
e
use
Szab
o
and
Babu
 
sk
as


shap
e
function
with
the
represen
tation
of
Shephard
et
al

The
basis
for
a
tetrahedral
or
a
canonical
cub
e
b
egins
with
the
v
ertex
functions

or

resp
ectiv
ely

As
noted
in
Section

higherorder
shap
e
functions
are
written
as
pro
ducts
N
k
i
x
y

z

	


k




	

i




	


of
an
en
tit
y
function


k
and
a
blending
function

i


The
entity
function
is
dened
on
a
mesh
en
tit
y
v
ertex
edge
face
or
elemen
t
and
v
aries
with
the
degree
k
of
the
appro
ximation
It
do
es
not
dep
end
on
the
shap
es
of
higherdimensional
en
tities

The
blending
function
distributes
the
en
tit
y
function
o
v
er
higherdimensional
en
ti
ties
It
dep
ends
on
the
shap
es
of
the
higherdimensional
en
tities
but
not
on
k

The
en
tit
y
functions
that
are
used
to
construct
shap
e
functions
for
cubic
and
tetra
hedral
elemen
ts
follo
w
Edge
functions
for
b
oth
cub
es
and
tetr
ahe
dr
a
are
giv
en
b
y
c
and
e
as


k


	
p
k






Z


P
k


d

k
	

	a
where




is
a
co
ordinate
on
the
edge
The
rst
four
edge
functions
are
presen
ted
in

F
ac
e
functions
for
squar
es
are
giv
en
b
y

divided
b
y
the
square
face
blending
function
a


k





	
P


P






	
k


k
	

	b
Here




are
canonical
co
ordinates
on
the
face
The
rst
six
square
face
functions
are



	




	





	





	









	






	






F
ac
e
functions
for
triangles
are
giv
en
b
y
	
divided
the
triangular
face
blending
function
	a


k

	


	


	


	
P

	


	

P

	






	
k


k
	

	c


Finite
Elemen
t
Appro
ximation
As
with
square
faces
	


	


	


form
a
canonical
co
ordinate
system
on
the
face
The
rst
six
triangular
face
functions
are



	




	
	


	





	
	






	
	


	










	
	


	

	






	
	








No
w
lets
turn
to
the
blending
functions
The
tetr
ahe
dr
al
element
blending
function
for
an
edge
is

ij
	


	


	


	


	
	
i
	
j
a
when
the
edge
is
directed
from
V
ertex
i
to
V
ertex
j

Using
either
Figure

or
Figure

as
references
w
e
see
that
the
blending
function
ensures
that
the
shap
e
function
v
anishes
on
the
t
w
o
faces
not
con
taining
the
edge
to
main
tain
con
tin
uit
y

Th
us
if
i
	

and
j
	

the
blending
function
for
Edge


whic
h
is
mark
ed
with
a

on
the
left
of
Figure

v
anishes
on
the
faces
	

	

F
ace
A


and
	

	

F
ace
A


The
blending
function
for
a
face
is

ij
k
	


	


	


	


	
	
i
	
j
	
k
b
when
the
v
ertices
on
the
face
are
i
j

and
k

Again
the
blending
function
ensures
that
the
shap
e
function
v
anishes
on
all
faces
but
A
ij
k

Again
referring
to
Figures

or

the
blending
function


v
anishes
when
	

	

F
ace
A


	

	

F
ace
A


and
	

	

F
ace
A


The
cubic
element
blending
function
for
an
edge
is
more
dicult
to
write
with
our
notation
Instead
of
writing
the
general
result
lets
consider
an
edge
parallel
to
the

axis
Then

jk




	

	






N
j



N
k
	

a
The
factor





adjusts
the
edge
function
to
	
as
describ
ed
in
the
paragraph
follo
wing
	
The
onedimensional
shap
e
functions

N
j


and

N
k
	

ensure
that
the
shap
e
function
v
anishes
on
all
faces
not
con
taining
the
edge
Blending
functions
for
other
edges
are
obtained
b
y
cyclic
p
erm
utation
of




and
	
and
the
index
Th
us
referring
to
Figure

the
edge
function
for
the
edge
connecting
v
ertices



and



is






	

	






N




N

	

Since

N


	

cf
b
the
shap
e
function
v
anishes
on
the
rear
face
of
the
cub
e
sho
wn
in
Figure

Since

N


	

the
shap
e
function
v
anishes
on
the
top
face
of


ThreeDimensional
Shap
e
F
unctions
	
the
cub
e
of
Figure

Finally

the
shap
e
function
v
anishes
at

	


and
hence
on
the
left
and
righ
t
faces
of
the
cub
e
of
Figure

Th
us
the
blending
function
a
has
ensured
that
the
shap
e
function
v
anishes
on
all
but
the
b
ottom
and
fron
t
faces
of
the
cub
e
of
Figure

The
cubic
face
blending
function
for
a
face
p
erp
endicular
to
the

axis
is

ijk




	

	

N
i







	


b
Referring
to
Figure

the
quadratic
terms
in

and
	
ensure
that
the
shap
e
func
tion
v
anishes
on
the
righ
t
left

	


top
and
b
ottom
	
	


faces
The
one
dimensional
shap
e
function

N
i


v
anishes
on
the
rear

	

face
when
i
	

and
on
the
fron
t

	

face
when
i
	

th
us
the
shap
e
function
v
anishes
on
all
faces
but
the
one
to
whic
h
it
is
asso
ciated
Finally

there
are
elemental
shap
e
functions
F
or
tetrahedra
there
are
p

p

p


elemen
tal
functions
for
p
	

that
are
giv
en
b
y
N
k


	


	


	


	


	
	

	

	

	

P

	


	

P

	


P

	









	
k


k
	






p
a
The
subscript

is
used
to
iden
tify
the
elemen
ts
cen
troid
The
shap
e
functions
v
anish
on
all
elemen
t
faces
as
indicated
b
y
the
presence
of
the
m
ultiplier
	

	

	

	


W
e
could
also
split
this
function
in
to
the
pro
duct
of
an
elemen
tal
function
in
v
olving
the
Legendre
p
olynomials
and
the
blend
in
v
olving
the
pro
duct
of
the
tetrahedral
co
ordinates
Ho
w
ev
er
this
is
not
necessary

F
or
p
	

there
are
the
follo
wing
elemen
tal
shap
e
functions
for
a
cub
e
N
k






	

	










	

P


P


P

	







	
k


b
Again
the
shap
e
function
v
anishes
on
all
faces
of
the
elemen
t
to
main
tain
con
tin
uit
y

Adding
w
e
see
that
there
are
p



p



p




elemen
t
mo
des
for
a
p
olynomial
of
order
p
Shephard
et
al

also
construct
blending
functions
for
p
yramids
w
edges
and
prisms
They
displa
y
sev
eral
shap
e
functions
and
also
presen
t
en
tit
y
functions
using
the
basis
of
Carnev
ali
et
al

Problems

Construct
the
shap
e
functions
asso
ciated
with
a
v
ertex
an
edge
and
a
face
no
de
for
a
cubic
Lagrangian
in
terp
olan
t
on
the
tetrahedron
sho
wn
on
the
righ
t
of
Figure

Express
y
our
answ
er
in
the
tetrahedral
co
ordinates



Finite
Elemen
t
Appro
ximation






































































1 (x  ,y  )
y
x
1
1
1 (0,0)
2 (1,0)
3 (0,1)
ξ
η
2 (x  ,y  )
2
2
3 (x  ,y  )
3
3
h
h
h
α
α
α
1
1
2
3
2
3
Figure

Nomenclature
for
a
nite
elemen
t
in
the
ph
ysical
x
y
plane
and
for
its
mapping
to
a
canonical
elemen
t
in
the
computational



plane

In
terp
olation
Error
Analysis
W
e
conclude
this
c
hapter
with
a
brief
discussion
of
the
errors
in
in
terp
olating
a
function
u
b
y
a
piecewise
p
olynomial
function
U

This
w
ork
extends
our
earlier
study
in
Section

to
m
ultidimensional
situations
Tw
o
and
threedimensional
in
terp
olation
is
naturally

more
complex
In
one
dimension
it
w
as
sucien
t
to
study
limiting
pro
cesses
where
mesh
spacings
tend
to
zero
In
t
w
o
and
three
dimensions
w
e
m
ust
also
ensure
that
elemen
t
shap
es
cannot
b
e
to
o
distorted
This
usually
means
that
elemen
ts
cannot
b
ecome
to
o
thin
as
the
mesh
is
rened
W
e
ha
v
e
b
een
using
co
ordinate
mappings
to
construct
bases
Concen
trating
on
t
w
odimensional
problems
the
co
ordinate
transformation
from
a
canonical
elemen
t
in
sa
y

the



plane
to
an
actual
elemen
t
in
the
x
y
plane
m
ust
b
e
suc
h
that
no
distorted
elemen
ts
are
pro
duced
Lets
fo
cus
on
triangular
elemen
ts
and
consider
a
linear
mapping
of
a
canonical
unit
righ
t


triangle
in
the



plane
to
an
elemen
t
e
in
the
x
y
plane
Figure

More
complex
mappings
will
b
e
discussed
in
Chapter

Using
the
transformation

to
triangular
co
ordinates
in
com
bination
with
the
denitions

and

of
the
canonical
v
ariables
w
e
ha
v
e


x
y



	


x

x

x

y

y

y








	

	

	



	


x

x

x

y

y

y



















The
Jacobian
of
this
transformation
is
J
e
	

x

x

y

y



a


ThreeDimensional
Shap
e
F
unctions

Dieren
tiating

w
e
nd
the
determinan
t
of
this
Jacobian
as
detJ
e

	
x


x

y


y



x


x

y


y


b
Lemma

L
et
h
e
b
e
the
longest
e
dge
and

e
b
e
the
smal
lest
angle
of
Element
e
then
h

e

sin

e

det
J
e


h

e
sin

e


Pr
o
of
Lab
el
the
v
ertices
of
Elemen
t
e
as


and

their
angles
as









and
the
lengths
of
the
edges
opp
osite
these
angles
as
h


h


and
h

Figure

With


	

e
b
eing
the
smallest
angle
of
Elemen
t
e
write
the
determinan
t
of
the
Jacobian
as
det
J
e

	
h

h

sin

e

Using
the
la
w
of
sines
w
e
ha
v
e
h


h


h

	
h
e

Replacing
h

b
y
h

in
the
ab
o
v
e
expression
yields
the
righ
thand
inequalit
y
of

The
triangular
inequalit
y
giv
es
h


h


h


Th
us
at
least
one
edge
sa
y

h


h


This
yields
the
lefthand
inequalit
y
of

Theorem

L
et

x
y


H
s

e

and
!






H
s



b
e
such
that

x
y

	
!





wher
e

e
is
the
domain
of
element
e
and


is
the
domain
of
the
c
anonic
al
element
Under
the
line
ar
tr
ansformation
	
ther
e
exist
c
onstants
c
s
and
C
s

indep
endent
of


!


h
e

and

e
such
that
c
s
sin
s

e
h
s
e
j
j
s
e

j
!

j
s


C
s
sin


e
h
s
e
j
j
s
e
a
wher
e
the
Sob
olev
seminorm
is
j
j

s
e
	
X
j
js
Z
Z

e
D




dxdy
b
with
D

u
b
eing
a
p
artial
derivative
of
or
der
j
j
	
s
cf
Se
ction
	
Pr
o
of
Let
us
b
egin
with
s
	

where
Z
Z

e


dxdy
	
detJ
e

Z
Z


!


d
d
or
j
j


e
	
det
J
e
j
!

j




Dividing
b
y
det
J
e

and
using

j
j


e
sin

e
h

e

j
!

j




j
j


e
sin

e
h

e



Finite
Elemen
t
Appro
ximation
T
aking
a
square
ro
ot
w
e
see
that
a
is
satised
with
c

	

and
C

	
p


With
s
	

w
e
use
the
c
hain
rule
to
get

x
	
!



x

!



x


y
	
!



y

!



y

Then
j
j


e
	
Z
Z

e


x



y
dxdy
	
det
J
e

Z
Z


g
e
!




g
e
!


!



g
e
!



d
d
where
g
e
	


x



y

g
e
	

x

x


y

y

g
e
	


x



y

Applying
the
inequalit
y
ab

a


b


to
the
cen
ter
term
on
the
righ
t
yields
j
j

e

detJ
e

Z
Z


g
e
!




g
e

!




!





g
e
!



d
d

Letting

	
maxjg
e

g
e
j
jg
e

g
e
j
and
using
b
w
e
ha
v
e
j
j


e

detJ
e

j
!

j




a
Either
b
y
using
the
c
hain
rule
ab
o
v
e
with

	
x
and
y
or
b
y
in
v
erting
the
mapping

w
e
ma
y
sho
w
that

x
	
y

det
J
e



y
	

x

det
J
e



x
	

y

det
J
e



y
	

x

det
J
e


F
rom

jx

j
jx

j
jy

j
jy

j

h
e

th
us
using

w
e
ha
v
e
j
x
j
j
y
j
j
x
j
j
y
j

h
e
sin

e

Hence



h
e
sin

e



Using
this
result
and

with
a
w
e
nd
j
j


e


sin

e
j
!

j




b
Hence
the
lefthand
inequalit
y
of
a
is
established
with
c

	

T
o
establish
the
righ
t
inequalit
y

w
e
in
v
ert
the
transformation
and
pro
ceed
from


to

e
to
obtain
j
!

j




!

j
j


e
det
J
e

a


ThreeDimensional
Shap
e
F
unctions

with
!

	
maxj
!
g
e

!
g
e
j
j
!
g
e

!
g
e
j
!
g
e
	
x



x



!
g
e
	
x

y


x

y


!
g
e
	
y



y



W
ev
e
indicated
that
jx

j
jx

j
jy

j
jy

j

h
e

Th
us
!


h

e
and
using

w
e
nd
j
!

j





sin

e
j
j


e

b
Th
us
the
righ
t
inequalit
y
of
b
is
established
with
C

	

p

The
remainder
of
the
pro
of
follo
ws
the
same
lines
and
is
describ
ed
in
Axelsson
and
Bark
er

With
Theorem

established
w
e
can
concen
trate
on
estimating
in
terp
olation
errors
on
the
canonical
triangle
F
or
simplicit
y

w
ell
use
the
Lagrange
in
terp
olating
p
olynomial
!
U




	
n
X
j

!
u

j


j
N
j





with
n
b
eing
the
n
um
b
er
of
no
des
on
the
standard
triangle
Ho
w
ev
er
with
minor
alter
ations
the
results
apply
to
other
bases
and
indeed
other
elemen
t
shap
es
W
e
pro
ceed
with
one
preliminary
theorem
and
then
presen
t
the
main
result
Theorem

L
et
p
b
e
the
lar
gest
inte
ger
for
which
the
interp
olant
	
is
exact
when
!
u



is
a
p
olynomial
of
de
gr
e
e
p
Then
ther
e
exists
a
c
onstant
C


such
that
j
!
u

!
U
j
s


C
j
!
u
j
p


u

H
p



s
	






p



Pr
o
of
The
pro
of
utilizes
the
Bram
bleHilb
ert
Lemma
and
is
presen
ted
in
Axelsson
and
Bark
er

Theorem

L
et

b
e
a
p
olygonal
domain
that
has
b
e
en
discr
etize
d
into
a
net
of
triangular
elements

e

e
	






N


L
et
h
and

denote
the
lar
gest
element
e
dge
and
smal
lest
angle
in
the
mesh
r
esp
e
ctively
L
et
p
b
e
the
lar
gest
inte
ger
for
which
	
is
exact
when
!
u



is
a
c
omplete
p
olynomial
of
de
gr
e
e
p
Then
ther
e
exists
a
c
onstant
C


indep
endent
of
u

H
p
and
the
mesh
such
that
ju

U
j
s

C
h
ps
sin


s
juj
p

u

H
p

s
	


	
R
emark

The
results
are
restricted
s
	


b
ecause
t
ypically

U

H


H
p



Finite
Elemen
t
Appro
ximation
Pr
o
of
Consider
an
elemen
t
e
and
use
the
left
inequalit
y
of
a
with

replaced
b
y
u

U
to
obtain
ju

U
j

s
e

c

s
sin
s

e
h
s
e
j
!
u

!
U
j

s


Next
use

ju

U
j

s
e

c

s
sin
s

e
h
s
e
C
j
!
u
j

p


Finally

use
the
righ
t
inequalit
y
of
a
to
obtain
ju

U
j

s
e

c

s
sin
s

e
h
s
e
C
C

p
sin


e
h
p
e
juj

p
e

Com
bining
the
constan
ts
ju

U
j

s
e

C
sin
s

e
h
ps
e
juj

p
e

Summing
o
v
er
the
elemen
ts
and
taking
a
square
ro
ot
giv
es
	
A
similar
result
for
rectangles
follo
ws
Theorem

L
et
the
r
e
ctangular
domain

b
e
discr
etize
d
into
a
mesh
of
r
e
ctangular
elements

e

e
	






N


L
et
h
and

denote
the
lar
gest
element
e
dge
and
smal
lest
e
dge
r
atio
in
the
mesh
r
esp
e
ctively
L
et
p
b
e
the
lar
gest
inte
ger
for
which
	
is
exact
when
!
u




is
a
c
omplete
p
olynomial
of
de
gr
e
e
p
Then
ther
e
exists
a
c
onstant
C


indep
endent
of
u

H
p
and
the
mesh
such
that
ju

U
j
s

C
h
ps

s
juj
p

u

H
p

s
	



Pr
o
of
The
pro
of
follo
ws
the
lines
of
Theorem


Th
us
small
and
large
near


angles
in
triangular
meshes
and
small
asp
ect
ratios
the
minim
um
to
maxim
um
edge
ratio
of
an
elemen
t

in
a
rectangular
mesh
m
ust
b
e
a
v
oided
If
these
quan
tities
remain
b
ounded
then
the
mesh
is
uniform
as
expressed
b
y
the
follo
wing
denition
Denition

A
family
of
nite
elemen
t
meshes
"
h
is
uniform
if
all
angles
of
all
elemen
ts
are
b
ounded
a
w
a
y
from

and

and
all
asp
ect
ratios
are
b
ounded
a
w
a
y
from
zero
as
the
elemen
t
size
h


With
suc
h
uniform
meshes
w
e
can
com
bine
Theorems


and

to
obtain
a
result
that
app
ears
more
widely
in
the
literature
Theorem

L
et
a
family
of
meshes
"
h
b
e
uniform
and
let
the
p
olynomial
inter
p
olant
U
of
u

H
p
b
e
exact
whenever
u
is
a
c
omplete
p
olynomial
of
de
gr
e
e
p
Then
ther
e
exists
a
c
onstant
C


such
that
ju

U
j
s

C
h
ps
juj
p

s
	





ThreeDimensional
Shap
e
F
unctions

Pr
o
of
Use
the
b
ounds
on

and

with
	
and

to
redene
the
constan
t
C
and
obtain

Theorems



only
apply
when
u

H
p

If
u
has
a
singularit
y
and
b
elongs
to
H
q


q

p
then
the
con
v
ergence
rate
is
reduced
to
ju

U
j
s

C
h
q
s
juj
q


s
	



Th
us
there
app
ears
to
b
e
little
b
enet
to
using
p
thdegree
piecewisep
olynomial
in
ter
p
olan
ts
in
this
case
Ho
w
ev
er
in
some
cases
highly
graded
non
uniform
meshes
can
b
e
created
to
restore
a
higher
con
v
ergence
rate


Finite
Elemen
t
Appro
ximation

Bibliograph
y

S
Adjerid
M
Aia
and
JE
Flahert
y

Hierarc
hical
nite
elemen
t
bases
for
triangular
and
tetrahedral
elemen
ts
Computer
Metho
ds
in
Applie
d
Me
chanics
and
Engine
ering

to
app
ear

O
Axelsson
and
VA
Bark
er
Finite
Element
Solution
of
Boundary
V
alue
Pr
oblems
Academic
Press
Orlando
	

SC
Brenner
and
LR
Scott
The
Mathematic
al
The
ory
of
Finite
Element
Metho
ds
SpringerV
erlag
New
Y
ork
		

P

Carnev
ali
RV
Morric
YTsuji
and
B
T
a
ylor
New
basis
functions
and
com
putational
pro
cedures
for
pv
ersion
nite
elemen
t
analysis
International
Journal
of
Numeric
al
Metho
ds
in
Enginne
ering
	#	
		

S
Dey

MS
Shephard
and
JE
Flahert
y

Geometrybased
issues
asso
ciated
with
pv
ersion
nite
elemen
t
computations
Computer
Metho
ds
in
Applie
d
Me
chanics
and
Engine
ering
	
#

		

MS
Shephard
S
Dey

and
JE
Flahert
y

A
straigh
tforw
ard
structure
to
construct
shap
e
functions
for
v
ariable
porder
meshes
Computer
Metho
ds
in
Applie
d
Me
chanics
and
Engine
ering
	#
		

B
Szab
o
and
I
Babu
 
sk
a
Finite
Element
A
nalysis
John
Wiley
and
Sons
New
Y
ork
		

OC
Zienkiewicz
The
Finite
Element
Metho
d
McGra
wHill
New
Y
ork
third
edition
	


Chapter

Mesh
Generation
and
Assem
bly

In
tro
duction
There
are
sev
eral
reasons
for
the
p
opularit
y
of
nite
elemen
t
metho
ds
Large
co
de
seg
men
ts
can
b
e
implemen
ted
for
a
wide
class
of
problems
The
soft
w
are
can
handle
complex
geometry

Little
or
no
soft
w
are
c
hanges
are
needed
when
b
oundary
conditions
c
hange
domain
shap
es
c
hange
or
co
ecien
ts
v
ary

A
t
ypical
nite
elemen
t
soft
w
are
framew
ork
con
tains
a
pr
epr
o
c
essing
mo
dule
to
dene
the
problem
geometry
and
data
a
pr
o
c
essing
mo
dule
to
assem
ble
and
solv
e
the
nite
elemen
t
system
and
a
p
ostpr
o
c
essing
mo
dule
to
output
the
solution
and
calculate
additional
quan
tities
of
in
terest
The
prepro
cessing
mo
dule

creates
a
computer
mo
del
of
the
problem
domain

p
erhaps
using
a
computer
aided
design
CAD	
system

discretizes

in
to
a
nite
elemen
t
mesh

creates
geometric
and
mesh
databases
describing
the
mesh
en
tities
v
ertices
edges
faces
and
elemen
ts	
and
their
relationships
to
eac
h
other
and
to
the
problem
ge
ometry
and

denes
problemdep
enden
t
data
suc
h
as
co
ecien
t
functions
loading
initial
data
and
b
oundary
data
The
pro
cessing
mo
dule

generates
elemen
t
sti
ness
and
mass
matrices
and
load
v
ectors

assem
bles
the
global
sti
ness
and
mass
matrices
and
load
v
ector

enforces
an
y
essen
tial
b
oundary
conditions
and



Mesh
Generation
and
Assem
bly

solv
es
the
linear
or
nonlinear	
algebraic
system
for
the
nite
elemen
t
solution
The
p
ostpro
cessing
mo
dules

calculates
additional
quan
tities
of
in
terest
suc
h
as
stresses
total
energy

and
a
p
osteriori
error
estimates
and

stores
and
displa
ying
solution
information
In
this
c
hapter
w
e
study
the
prepro
cessing
and
pro
cessing
steps
with
the
exception
of
the
geometrical
description
and
solution
pro
cedures
The
former
topic
is
not
addressed
while
the
latter
sub
ject
will
b
e
co
v
ered
in
Chapter


Mesh
Generation
Discretizing
t
w
odimensional
domains
in
to
triangular
or
quadrilateral
nite
elemen
t
meshes
can
either
b
e
a
simple
or
dicult
task
dep
ending
on
geometric
or
solution
complexi
ties
Discretizing
threedimensional
domains
is
curren
tly
not
simple
Uniform
meshes
ma
y
b
e
appropriate
for
some
problems
ha
ving
simple
geometric
shap
es
but
ev
en
there
non
uniform
meshes
migh
t
pro
vide
b
etter
p
erformance
when
solutions
v
ary
rapidly

eg
in
b
oundary
la
y
ers
Finite
elemen
t
tec
hniques
and
soft
w
are
ha
v
e
alw
a
ys
b
een
asso
ciated
with
unstructured
and
non
uniform
meshes
Early
soft
w
are
left
it
to
users
to
generate
meshes
man
ually

This
required
the
en
try
of
the
co
ordinates
of
all
elemen
t
v
ertices
No
de
and
elemen
t
indexing
t
ypically

w
as
also
done
man
ually

This
is
a
tedious
and
error
prone
pro
cess
that
has
largely
b
een
automated
at
least
in
t
w
o
dimensions
Adap
tiv
e
solutionbased
mesh
renemen
t
pro
cedures
concen
trate
meshes
in
regions
of
rapid
solution
v
ariation
and
attempt
to
automate
the
task
of
mo
difying
reningcoarsening	
an
existing
mesh



	


While
w
e
will
not
attempt
a
thorough
treatmen
t
of
all
approac
hes
w
e
will
discuss
the
essen
tial
ideas
of
mesh
generation
b
y
i	
mapping
tec
hniques
where
a
complex
domain
is
transformed
in
to
a
simpler
one
where
a
mesh
ma
y
b
e
easily
generated
and
ii	
direct
tec
hniques
where
a
mesh
is
generated
on
the
original
domain

Mesh
Generation
b
y
Co
ordinate
Mapping
Scien
tists
and
engineers
ha
v
e
used
co
ordinate
mappings
for
some
time
to
simplify
ge
ometric
diculties
The
mappings
can
either
emplo
y
analytical
functions
or
piecewise
p
olynomials
as
presen
ted
in
Chapter

The
pro
cedure
b
egins
with
mappings
x

f




	
y

f




	


Mesh
Generation

that
relate
the
problem
domain
in
ph
ysical
x
y
	
space
to
its
image
in
the
simpler



	
space
A
simply
connected
region
and
its
computational
coun
terpart
app
ear
in
Figure

It
will
b
e
con
v
enien
t
to
in
tro
duce
the
v
ectors
x
T

x
y

f



	
T

f




	
f




	
a	
and
write
the
co
ordinate
transformation
as
x

f



	
b	


f
(
(
0,η )
1,2




















































x
y
1,1
2,1
2,2
f
f
f
(
(ξ
ξ
,0)
,1)
1,η )
ξ
η
2,1
1,1
2,2
1,2
Figure

Mapping
of
a
simply
connected
region
left	
on
to
a
rectangular
computa
tional
domain
righ
t	
In
Figure

w
e
sho
w
a
region
with
four
segmen
ts
f


	
f


	
f


	
and
f


	
that
are
related
to
the
computational
lines









and



resp
ectiv
ely

The
four
curv
ed
segmen
ts
ma
y
in
v
olv
e
di
eren
t
functions
but
w
e
ha
v
e
written
them
all
as
f
for
simplicit
y
	
Also
consider
the
pro
jection
op
erators
x

P

f
	


N


	f


	


N


	f


	
a	
x

P

f
	


N


	f


	


N


	f


	
b	
where

N


	





c	
and

N


	


d	


Mesh
Generation
and
Assem
bly
are
the
familiar
hat
functions
scaled
to
the
in
terv
al





As
sho
wn
in
Figure

the
mapping
x

P

f
	
transforms
the
left
and
righ
t
edges
of
the
domain
correctly

but
ignores
the
top
and
b
ottom
while
the
mapping
x

P

f
	
transforms
the
top
and
b
ottom
b
oundaries
correctly
but
not
the
sides
Co
ordinate
lines
of
constan
t

and

are
mapp
ed
as
either
curv
es
or
straigh
t
lines
on
the
ph
ysical
domain
x
y
y
x
y
1,1
1,2
2,2
2,2
1,1
1,2
2,1
2,1
Figure

The
transformations
x

P

f
	
left	
and
x

P

f
	
righ
t	
as
applied
to
the
simplyconnected
domain
sho
wn
in
Figure

x
y
1,1
2,1
2,2
1,2
x
y
1,1
2,1
1,2
2,2
Figure

Illustrations
of
the
transformations
x

P

P

f
	
left	
and
x

P


P

f
	
righ
t	
as
applied
to
the
simplyconnected
domain
sho
wn
in
Figure

With
a
goal
of
constructing
an
e
ectiv
e
mapping
let
us
in
tro
duce
the
tensor
pro
duct
and
Bo
olean
sums
of
the
pro
jections
	
as
x

P

P

f
	


X
i

X
j


N
i

	

N
j

	f
i


j

	
a	


Mesh
Generation

x

P


P

f
	

P

f
	

P

f
	

P

P

f
	
b	
An
application
of
these
transformations
to
a
simplyconnected
domain
is
sho
wn
in
Figure

The
transformation
a	
is
a
bilinear
function
of

and

while
b	
is
clearly
the
one
needed
to
map
the
simply
connected
domain
on
to
the
computational
plane
Lines
of
constan
t

and

b
ecome
curv
es
in
the
ph
ysical
domain
Figure
	
Although
these
transformations
are
simple
they
ha
v
e
b
een
used
to
map
relativ
ely
complex
t
w
o
and
threedimensional
regions
Tw
o
examples
in
v
olving
the
o
w
ab
out
an
airfoil
are
sho
wn
in
Figure

With
the
transformation
sho
wn
at
the
top
of
the
gure
the
en
tire
surface
of
the
airfoil
is
mapp
ed
to



	
A
cut
is
made
from
the
trailing
edge
of
the
airfoil
and
the
curv
e
so
dened
is
mapp
ed
to
the
left



	
and
righ
t



	
edges
of
the
computational
domain
The
en
tire
far
eld
is
mapp
ed
to
the
top



	
of
the
computational
domain
Lines
of
constan
t

are
ra
ys
from
the
airfoil
surface
to
the
far
eld
b
oundary
in
the
ph
ysical
plane
Lines
of
constan
t

are
closed
curv
es
encircling
the
airfoil
Meshes
constructed
in
this
manner
are
called
Ogrids
In
the
b
ottom
of
Figure

the
surface
of
the
airfoil
is
mapp
ed
to
a
p
ortion
	
of
the

axis
The
cut
from
the
trailing
edge
is
mapp
ed
to
the
rest

and
	
of
the
axis
The
righ
t	
outo
w
b
oundary
is
mapp
ed
to
the
left
	
and
righ
t
	
edges
of
the
computational
domain
and
the
top
left
and
b
ottom
far
eld
b
oundaries
are
mapp
ed
to
the
top



	
of
the
computational
domain
Lines
of
constan
t

b
ecome
curv
es
b
eginning
and
ending
at
the
outo
w
b
oundary
and
surrounding
the
airfoil
Lines
of
constan
t

are
ra
ys
from
the
airfoil
surface
or
the
cut
to
the
outer
b
oundary

This
mesh
is
called
a
Cgrid

Unstructured
Mesh
Generation
There
are
sev
eral
approac
hes
to
unstructured
mesh
generation
Early
attempts
used
man
ual
tec
hniques
where
p
oin
tco
ordinates
w
ere
explicitly
dened
Semiautomatic
mesh
generation
required
man
ual
input
of
a
coarse
mesh
whic
h
could
b
e
uniformly
rened
b
y
dividing
eac
h
elemen
t
edge
in
to
K
segmen
ts
and
connecting
segmen
ts
on
opp
osite
sides
of
an
elemen
t
to
create
K

triangular	
elemen
ts
More
automatic
pro
cedures
use
adv
ancing
fron
ts
p
oin
t
insertion
and
recursiv
e
bisection
W
ell
discuss
the
latter
pro
cedure
and
briey
men
tion
the
former
With
recursiv
e
bisection

a
t
w
odimensional
region

is
em
b
edded
in
a
square
uni
v
erse
that
is
recursiv
ely
quartered
to
create
a
set
of
disjoin
t
squares
called
quadr
ants
Quadran
ts
are
related
through
a
hierarc
hical
quadtr
e
e
structure
The
original
square
univ
erse
is
regarded
as
the
ro
ot
of
the
tree
and
smaller
quadran
ts
created
b
y
sub
divi
sion
are
regarded
as
o
spring
of
larger
ones
Quadran
ts
in
tersecting


are
recursiv
ely


Mesh
Generation
and
Assem
bly


































ξ
η
1
4
2
3
1
4
airfoil
2
3
































ξ
η
1
4
airfoil
2
3
2
3
1
4
6
5
5
6
Figure

Ogrid
top	
and
Cgrid
b
ottom	
mappings
of
the
o
w
ab
out
an
airfoil
quartered
un
til
a
prescrib
ed
spatial
resolution
of

is
obtained
A
t
this
stage
quadran
ts
that
are
leaf
no
des
of
the
tree
and
in
tersect




are
further
divided
in
to
small
sets
of
triangular
or
quadrilateral
elemen
ts
Sev
ere
mesh
gradation
is
a
v
oided
b
y
imp
osing
a
maximal
onelev
el
di
erence
b
et
w
een
quadran
ts
sharing
a
common
edge
This
implies
a
maximal
t
w
olev
el
di
erence
b
et
w
een
quadran
ts
sharing
a
common
v
ertex
A
simple
example
in
v
olving
a
domain
consisting
of
a
rectangle
and
a
region
within
a
curv
ed
arc
as
sho
wn
in
Figure

will
illustrate
the
quadtree
pro
cess
In
the
upp
er
p
ortion
of
the
gure
the
square
univ
erse
con
taining
the
problem
domain
is
quartered
creating
the
onelev
el
tree
structure
sho
wn
at
the
upp
er
righ
t
The
quadran
t
con
taining
the
curv
ed
arc
is
quartered
and
the
resulting
quadran
t
that
in
tersects
the
arc
is
quartered
again
to
create
the
threelev
el
tree
sho
wn
in
the
lo
w
er
righ
t
p
ortion
of
the
gure
A
triangular
mesh
generated
for
this
tree
structure
is
also
sho
wn
The
triangular
elemen
ts
are
asso
ciated
with
quadran
ts
of
the
tree
structure
Quadran
ts
and
a
mixed
triangular
and
quadrilateralelemen
t
mesh
for
a
more
complex
example
are
sho
wn
in
Figure

Elemen
ts
pro
duced
b
y
the
quadtree
and
o
ctree
tec
hniques
ma
y
ha
v
e
p
o
or
geometric
shap
es
near
b
oundaries
A
nal
smo
othing
of
the
mesh
impro
v
es
elemen
t
shap
es
and


Mesh
Generation























































































































Boundary quadrant
Interior quadrant
Exterior quadrant
Finite element
Figure

Finite
quadtree
mesh
generation
for
a
domain
consisting
of
a
rectangle
and
a
region
within
a
curv
ed
arc
Onelev
el
top	
and
threelev
el
b
ottom	
tree
structures
are
sho
wn
The
mesh
of
triangular
elemen
ts
asso
ciated
with
the
threelev
el
quadtree
is
sho
wn
sup
erimp
osed
further
reduces
mesh
gradation
near


Elemen
t
v
ertices
on


are
mo
v
ed
along
the
b
oundary
to
pro
vide
a
b
etter
appro
ximation
to
it
P
airs
of
b
oundary
v
ertices
that
are
to
o
close
to
eac
h
other
ma
y
b
e
c
ol
lapse
d
to
a
single
v
ertex
In
terior
v
ertices
are
smo
othed
b
y
a
L
aplacian
op
eration
that
places
eac
h
v
ertex
at
the
cen
troid
of
its
neigh
b
oring
v
ertices
T
o
b
e
sp
ecic
let
i
b
e
the
index
of
a
no
de
to
b
e
rep
ositioned
x
i
b
e
its
co
ordinates
P
i
b
e
the
set
of
indices
of
all
v
ertices
that
are
connected
to
No
de
i
b
y
an
elemen
t
edge
and
Q
i
con
tain
the
indices
of
v
ertices
that
are
in
the
same
quadran
t
as
No
de
i
but
are
not


Mesh
Generation
and
Assem
bly
Figure

Quadtree
structure
and
mixed
triangular
and
quadrilateralelemen
t
mesh
generated
from
it
connected
to
it
b
y
an
edge
Then
x
i


P
j
P
i
x
j

P
j
Q
i
x
j

dim
P
i
	

dim
Q
i
	
	
where
dim
S
	
is
the
n
um
b
er
of
elemen
t
v
ertices
in
set
S

Additional
details
app
ear
in


Data
Structures
	
Baehmann
et
al


Arbitrarily
complex
t
w
o
and
threedimensional
domains
ma
y
b
e
discretized
b
y
quadtree
and
o
ctree
decomp
osition
to
pro
duce
unstructured
grids
F
urther
solutionbased
mesh
renemen
t
ma
y
b
e
done
b
y
sub
dividing
appropriate
terminal
quadran
ts
or
o
ctan
ts
and
generating
a
new
mesh
lo
cally

This
unites
mesh
generation
and
adaptiv
e
mesh
rene
men
t
b
y
a
common
tree
data
structure

The
underlying
tree
structure
is
also
suitable
for
load
balancing
on
a
parallel
computer



The
adv
ancing
fron
t
tec
hnique
constructs
a
mesh
b
y
notc
hing
elemen
ts
from


and
propagating
this
pro
cess
in
to
the
in
terior
of
the
domain
An
example
is
sho
wn
in
Figure

This
pro
cedure
pro
vides
b
etter
shap
e
con
trol
than
quadtree
or
o
ctree
but
problems
arise
as
the
adv
ancing
fron
ts
in
tersect
L 
ohner

has
a
description
of
this
and
other
mesh
generation
tec
hniques
Carey

presen
ts
a
more
recen
t
treatmen
t
of
mesh
generation
Figure

Mesh
generation
b
y
the
adv
ancing
fron
t
tec
hnique

Data
Structures
Unstructured
mesh
computation
requires
a
data
structure
to
store
the
geometric
infor
mation
There
is
some
am
biguit
y
concerning
the
information
that
should
b
e
computed
at
the
prepro
cessing
stage
but
at
the
v
ery
least
the
pro
cessing
mo
dule
w
ould
ha
v
e
to
kno
w

the
v
ertices
b
elonging
to
eac
h
elemen
t

the
spatial
co
ordinates
of
eac
h
v
ertex
and

the
elemen
t
edges
faces
or
v
ertices
that
are
on


The
pro
cessing
mo
dule
w
ould
need
more
information
when
adaptivit
y
is
p
erformed
It
for
example
w
ould
need
a
link
to
the
geometric
information
in
order
to
rene
elemen
ts


Mesh
Generation
and
Assem
bly
along
a
curv
ed
b
oundary

Ev
en
without
adaptivit
y

the
pro
cessing
soft
w
are
ma
y
w
an
t
access
to
geometric
information
when
using
elemen
ts
with
curv
ed
edges
or
faces
cf
Section
	
If
the
nite
elemen
t
basis
w
ere
kno
wn
at
the
prepro
cessing
stage
space
could
b
e
reserv
ed
for
edge
and
in
terior
no
des
or
for
a
sym
b
olic
factorization
of
the
resulting
algebraic
system
cf
Chapter
	
Beall
and
Shephard

in
tro
duced
a
database
and
data
structure
that
ha
v
e
great
exibilit
y

It
is
suitable
for
use
with
highorder
and
hierarc
hical
bases
adaptiv
e
mesh
renemen
t
andor
order
v
ariation
and
arbitrarily
complex
domains
It
has
a
hierarc
hical
structure
with
threedimensional
elemen
ts
regions	
ha
ving
p
oin
ters
to
their
b
ounding
faces
faces
ha
ving
p
oin
ters
to
their
b
ounding
edges
and
edges
ha
ving
p
oin
ters
to
their
b
ounding
v
ertices
Those
mesh
en
tities
elemen
ts
faces
edges
and
v
ertices	
on
domain
b
oundaries
ha
v
e
p
oin
ters
to
relev
an
t
geometric
structures
dening
the
problem
domain
This
structure
called
the
SCOREC
mesh
datab
ase
is
sho
wn
in
Figure

No
des
ma
y
b
e
in
tro
duced
as
xed
p
oin
ts
in
space
to
b
e
asso
ciated
with
shap
e
functions
When
done
these
ma
y
b
e
lo
cated
b
y
p
oin
ters
from
an
y
mesh
en
tit
y

Element
Face
Edge
Vertex
Geometric
 Model
Entities
Figure

SCOREC
hierarc
hical
mesh
database
Let
us
illustrate
the
data
structure
for
the
t
w
odimensional
domain
sho
wn
in
Figure

As
sho
wn
in
Figure

this
mesh
has

faces
t
w
odimensional
elemen
ts	

edges
and

v
ertices
The
face
and
edgep
oin
ter
information
is
sho
wn
in
T
able

Eac
h
edge
has
t
w
o
p
oin
ters
bac
k
to
the
faces
that
con
tain
it
These
are
sho
wn
within
brac
k
ets
in
the
table
The
use
of
tables
and
in
teger
indices
for
p
oin
ters
is
done
for
con
v
enience
and
do
es
not
imply
an
arra
y
implemen
tation
of
p
oin
ter
data
The
edge
and


Data
Structures

v
ertexp
oin
ter
information
and
the
v
ertexp
oin
t
co
ordinate
data
are
sho
wn
in
T
able

Bac
kw
ard
p
oin
ters
from
v
ertices
to
edges
and
p
oin
ters
from
v
ertices
and
edges
on
the
b
oundary
to
the
geometric
database
ha
v
e
not
b
een
sho
wn
to
simplify
the
presen
tation
W
e
ha
v
e
sho
wn
a
small
p
ortion
of
the
p
oin
ter
structure
near
Edge

in
Figure

Links
b
et
w
een
common
en
tities
allo
w
the
mesh
to
b
e
tra
v
ersed
b
y
faces
edges
or
v
ertices
in
t
w
o
dimensions
Problem
and
solution
data
is
stored
with
the
appropriate
en
tities
20
19
18
17
16
8
13
12
14
15
9
10
11
6
7
1
2
5
25
35
34
33
27
28
31
29
30
32
36
3
5
16
21
20
23
24
26
18
15
1
6
22
17
19
7
4
2
3
11
12
8
14
13
10
9
4
14
4
15
1
2
3
6
5
7
8
9
10
11
12
13
16
17
Figure

Example
illustrating
the
SCOREC
mesh
database
F
aces
are
indexed
as
sho
wn
at
the
upp
er
left
edge
n
um
b
ering
is
sho
wn
at
the
upp
er
righ
t
and
v
ertex
n
um
b
ering
is
sho
wn
at
the
b
ottom


Mesh
Generation
and
Assem
bly
F
ace
Edge
Edge
Edge












	


















	
















	























































	


	



	



	




	
	












	












































	
























	



	

	


	


	










	
T
able

F
ace
and
edgep
oin
ter
data
for
the
mesh
sho
wn
in
Figure

Bac
kw
ard
p
oin
ters
from
edges
to
their
b
ounding
faces
are
sho
wn
in
brac
k
ets
Face 14
Edge 18
Face 10
...
...
To Edges 24 and 23
To Edges 17 and 19
To vertices 10 and 11
...
Figure

P
oin
ter
structure
in
the
vicinit
y
of
Edge

The
SCOREC
mesh
database
con
tains
more
information
than
necessary
for
a
t
ypi
cal
nite
elemen
t
solution
F
or
example
the
edge
information
ma
y
b
e
eliminated
and
faces
ma
y
p
oin
t
directly
to
v
ertices
This
w
ould
b
e
a
more
traditional
nite
elemen
t
data
structure
Although
it
sa
v
es
storage
and
simplies
the
data
structure
it
ma
y
b
e
wise
to
k
eep
the
edge
information
Adaptiv
e
mesh
renemen
t
pro
cedures
often
w
ork
b
y
edge
splitting
and
these
are
simplied
when
edge
data
is
a
v
ailable
Edge
information
also
simplies
the
application
of
b
oundary
conditions
esp
ecially
when
the
b
oundary
is


Data
Structures

Edge
V
ertices
Edge
V
ertices



	






	





	































	













	
	










	





	





	




	
















V
ertex
Co
ordinates




	









	









	


























T
able

Edge
and
v
ertexp
oin
ter
data
left	
and
v
ertex
and
co
ordinate
data
righ
t	
for
the
mesh
sho
wn
in
Figure

curv
ed
Only
p
oin
ters
are
required
for
the
edge
information
and
in
man
y
implemen
ta
tions
p
oin
ters
require
less
storage
than
in
tegers
Nev
ertheless
let
us
illustrate
face
and
v
ertex
information
for
the
simple
mesh
sho
wn
in
Figure

whic
h
con
tains
a
mixture
of
triangular
and
quadrilateral
elemen
ts
The
facev
ertex
information
is
sho
wn
in
T
able

and
the
v
ertexco
ordinate
data
is
sho
wn
in
T
able

Assuming
quadratic
shap
e
functions
on
the
triangles
and
biquadratic
shap
e
functions
on
the
rectangles
a
traditional
data
structure
w
ould
t
ypically
add
no
des
at
the
cen
ters
of
all
edges
and
the
cen
ters
of
the
rectangular
faces
In
this
example
the
midside
and
face
no
des
are
asso
ciated
with
faces
ho
w
ev
er
they
could
also
ha
v
e
b
een
asso
ciated
with
v
ertices
Without
edge
data
the
database
generally
requires
additional
a
priori
assumptions
F
or
example
w
e
could
agree
to
list
v
ertices
in
coun
terclo
c
kwise
order
Edge
no
des
could
follo
w
in
coun
terclo
c
kwise
order
b
eginning
with
the
no
de
that
is
closest
in
the
coun
terclo
c
kwise
direction
to
the
rst
v
ertex
Finally

in
terior
no
des
ma
y
b
e
listed
in
an
y
order
The
c
hoice
of
the
rst
v
ertex
is
arbitrary

This
strategy
is
generally
a
compromise
b
et
w
een
storing
a
great
deal
of
data
with
fast
access
and
ha
ving
lo
w
storage
costs
but
ha
ving
to
recompute
information
W
e
could
further
reduce
storage
for
example
b
y
not
sa
ving
the
co
ordinates
of
the
edge
no
des


Mesh
Generation
and
Assem
bly




































































































































1
2
3
4
6
7
9
10
11
13
14
16
19
20
21
22
5
(1)
(2)
(3)
(4)
15
17
(5)
18
12
8
Figure

Sample
nite
elemen
t
mesh
in
v
olving
a
mixture
of
quadratic
appro
ximations
on
triangles
and
biquadratic
appro
ximations
on
rectangles
F
ace
indices
are
sho
wn
in
paren
theses
F
ace
V
ertices
No
des





	

































	

T
able

Simplied
facev
ertex
data
for
the
mesh
of
Figure

The
t
yp
e
of
nite
elemen
t
basis
m
ust
also
b
e
stored
In
the
presen
t
example
w
e
could
attac
h
it
to
the
facev
ertex
table
With
the
larger
database
describ
ed
earlier
w
e
could
attac
h
it
to
the
appropriate
en
tit
y

In
the
spirit
of
the
shap
e
function
decomp
osition
describ
ed
in
Sections

and

w
e
could
store
information
ab
out
a
face
shap
e
function
with
the
face
and
information
ab
out
an
edge
shap
e
function
with
the
edge
This
w
ould
allo
w
us
to
use
v
ariableorder
appro
ximations
prenemen
t	
Without
edge
data
w
e
need
a
w
a
y
of
determining
those
edges
that
are
on


This
can
b
e
done
b
y
adopting
a
con
v
en
tion
that
the
edge
b
et
w
een
the
rst
and
second
v
ertices
of
eac
h
face
is
Edge

Remaining
edges
are
n
um
b
ered
in
coun
terclo
c
kwise
order
A
sample
b
oundary
data
table
for
the
mesh
of
Figure

is
sho
wn
on
the
righ
t
of
T
able

The
rst
ro
w
of
the
table
iden
ties
Edge

of
F
ace

as
b
eing
on
a
b
oundary
of
the
domain
Similarly

the
second
ro
w
of
the
table
iden
ties
Edge

of
F
ace

as
b
eing
a
b
oundary
edge
etc
Regions
with
curv
ed
edges
w
ould
need
p
oin
ters
bac
k
to
the
geometric
database


Co
ordinate
T
ransformations

V
ertex
Co
ordinates
























	





























	








F
ace
Edge














T
able

V
ertex
and
co
ordinate
data
left	
and
b
oundary
data
righ
t	
for
the
nite
elemen
t
mesh
sho
wn
in
Figure


Co
ordinate
T
ransformations
Co
ordinate
transformations
enable
us
to
dev
elop
elemen
t
sti
ness
and
mass
matrices
and
load
v
ectors
on
canonical
triangular
square
tetrahedral
and
cubic
elemen
ts
in
a
computational
domain
and
map
these
to
actual
elemen
ts
in
the
ph
ysical
domain
Useful
transformations
m
ust
i	
b
e
simple
to
ev
aluate
ii	
preserv
e
con
tin
uit
y
of
the
nite
elemen
t
solution
and
geometry

and
iii	
b
e
in
v
ertible
The
latter
requiremen
t
ensures
that
eac
h
p
oin
t
within
the
actual
elemen
t
corresp
onds
to
one
and
only
one
p
oin
t
in
the
canonical
elemen
t
F
o
cusing
on
t
w
o
dimensions
this
requires
the
Jacobian
J
e


x

x

y

y


	
of
the
transformation
of
Elemen
t
e
in
the
ph
ysical
x
y
	plane
to
the
canonical
elemen
t
in
the
computational



	plane
to
b
e
nonsingular
The
most
p
opular
co
ordinate
transformations
are
naturally

piecewisep
olynomial


Mesh
Generation
and
Assem
bly
functions
These
mappings
are
called
subp
ar
ametric
isop
ar
ametric
and
sup
erp
ar
ametric
when
their
p
olynomial
degree
is
resp
ectiv
ely

lo
w
er
than
equal
to
and
greater
than
that
used
for
the
trial
function
As
w
e
ha
v
e
seen
in
Chapter

the
transformations
use
the
same
shap
e
functions
as
the
nite
elemen
t
solutions
W
e
illustrated
linear
Section
	
and
bilinear
Section
	
transformations
for
resp
ectiv
ely

mapping
triangles
and
quadrilaterals
to
canonical
elemen
ts
W
e
ha
v
e
t
w
o
tasks
in
fron
t
of
us
i	
determining
whether
higherdegree
piecewise
p
olynomial
mappings
can
b
e
used
to
adv
an
tage
and
ii	
ensuring
that
these
transformations
will
b
e
nonsingular
Example

Recall
the
bilinear
transformation
of
a



canonical
square
to
a
quadrilateral
that
w
as
in
tro
duced
in
Section

Figure
	












































1,1 (x   ,y   )
(x   ,y   )
2,2 (x   ,y   )
1,2
(x   ,y   )
x
y
11
21
22
12
11
21
22
12
h
h1
2
α
η
12
2,1
2,2
1,2
1,1
2,1
1
1
ξ
1
1
Figure

Bilinear
mapping
of
a
quadrilateral
to
a



square

x


	
y



	



X
i

X
j


x
ij
y
ij

N
ij



	
a	
where
N
ij



	


N
i

	

N
j

	
i
j



b	
and

N
i

	





	
if
i





	
if
i



c	
The
v
ertices
of
the
square

	

	

	

	
are
mapp
ed
to
the
v
ertices
of
the
quadrilateral
x


y

	
x


y

	
x


y

	
x


y

	
The
bilinear
transforma
tion
is
linear
along
eac
h
edge
so
the
quadrilateral
elemen
t
has
straigh
t
sides


Co
ordinate
T
ransformations

Di
eren
tiating
a	
while
using
bc	
x


x


x



N


	

x


x



N


	
y


y


y



N


	

y


y



N


	
x


x


x



N


	

x


x



N


	
y


y


y



N


	

y


y



N


	
Substituting
these
form
ulas
in
to
	
and
ev
aluating
the
determinan
t
rev
eals
that
the
quadratic
terms
cancel
hence
the
determinan
t
of
J
e
is
a
linear
function
of

and

rather
than
a
bilinear
function
Therefore
it
suces
to
c
hec
k
that
detJ
e
	
has
the
same
sign
at
eac
h
of
the
four
v
ertices
F
or
example
det
J
e

		

x


	y


	

x


	y


	
or
detJ
e

		

x


x

	y


y

	

x


x

	y


y

	
The
cross
pro
duct
form
ula
for
t
w
ocomp
onen
t
v
ectors
indicates
that
det
J
e

		

h

h

sin



where
h


h


and


are
the
lengths
of
t
w
o
adjacen
t
sides
and
the
angle
b
et
w
een
them
Figure
	
Similar
form
ulas
apply
at
the
other
v
ertices
Therefore
detJ
e
	
will
not
v
anish
if
and
only
if

ij

	
at
eac
h
v
ertex
ie
if
and
only
if
the
quadrilateral
is
con
v
ex
P
olynomial
shap
e
functions
and
bases
are
constructed
on
the
canonical
elemen
t
as
describ
ed
in
Chapter

F
or
example
the
restriction
of
a
bilinear
isoparametric	
trial
function
to
the
canonical
elemen
t
w
ould
ha
v
e
the
form
U



	


X
i

X
j

c
ij
N
ij



	
A
subparametric
appro
ximation
migh
t
for
example
use
a
piecewisebilinear
co
ordinate
transformation
	
with
a
piecewisebiquadratic
trial
function
Let
us
illustrate
this
using
the
elemen
t
no
de
n
um
b
ering
of
Section

as
sho
wn
in
Figure

Using
	
the
restriction
of
the
piecewisebiquadratic
p
olynomial
trial
function
to
the
canonical
elemen
t
is
U



	


X
i

X
j

c
ij
N

ij



	
a	


Mesh
Generation
and
Assem
bly












































































































1,2
x
y
2,1
2,2
1,2
1,1
2,1
1,1
2,2
3,2
1,3
3,1
2,3
3,3
1,3
2,3
3,3
3,1
3,2
ξ
η
Figure

Bilinear
mapping
to
a
unit
square
with
a
biquadratic
trial
function










































































x
y
2,1
2,2
1,2
1,1
2,1
1,1
2,2
1,3
2,3
3,3
3,1
3,2
ξ
η
1,3
3,2
3,1
2,3
3,3
1,2
Figure

Biquadratic
mapping
of
the
unit
square
to
a
curvilinear
elemen
t
where
the
sup
erscript

is
used
to
iden
tify
biquadratic
shap
e
functions
N

ij



	


N

i

	

N

j

	
i
j




b	
with

N

i

	








	
if
i






	
if
i







if
i



c	
Example

A
biquadratic
transformation
of
the
canonical
square
has
the
form

x


	
y



	



X
i

X
j


x
ij
y
ij

N

ij



	
	
where
N

ij



	
i
j




is
giv
en
b
y
	
This
transformation
pro
duces
an
elemen
t
in
the
x
y
	plane
ha
ving
curv
ed
quadratic	
edges
as
sho
wn
in
Figure

An
isoparametric
appro
ximation
w
ould
b
e
biquadratic


Co
ordinate
T
ransformations
	
















































x
y
1
3
4
5
6
1
3
5
6
2
4
2
ξ
η
Figure

Quadratic
mapping
of
a
triangle
ha
ving
one
curv
ed
side
and
ha
v
e
the
form
of
	
The
in
terior
no
de
	
is
a
wkw
ard
and
can
b
e
eliminated
b
y
using
a
secondorder
serendipit
y
cf
Problems
	
or
hierarc
hical
transformation
cf
Section
	
Example

The
biquadratic
transformation
describ
ed
in
Example

is
useful
for
discretizing
domains
ha
ving
curv
ed
b
oundaries
With
a
similar
goal
w
e
describ
e
a
transformation
for
creating
triangular
elemen
ts
ha
ving
one
curv
ed
and
t
w
o
straigh
t
sides
Figure
	
Let
us
appro
ximate
the
curv
ed
b
oundary
b
y
a
quadratic
p
olynomial
and
map
the
elemen
t
on
to
a
canonical
righ
t
triangle
b
y
the
quadratic
transformation

x


	
y



	



X
i

x
i
y
i

N

i



	
a	
where
the
quadratic
Lagrange
shap
e
functions
are
cf
Problem
	
N

j


j

j

	
j




b	
N








N








N








c	
and



















	
Equations
	
and
	
describ
e
a
general
quadratic
transformation
W
e
ha
v
e
a
more
restricted
situation
with
x


x


x

	
y


y


y

	
x


x


x

	
y


y


y

	


Mesh
Generation
and
Assem
bly
This
simplies
the
transformation
a	
to

x


	
y



	



x

y


!
N




x

y


!
N




x

y


!
N




x

y


!
N



a	
where
up
on
use
of
	
and
	
!
N



N



N



N


	










b	
!
N



N



N








	
c	
!
N



N



N








	
d	
!
N



N






e	
F
rom
these
results
w
e
see
that
the
mappings
on
edges



	
and



	
are
linear
and
are
resp
ectiv
ely

giv
en
b
y

x
y



x

y





	


x

y





x
y



x

y





	


x

y




The
Jacobian
determinan
t
of
the
transformation
can
v
anish
dep
ending
on
the
lo
cation
of
No
de

The
analysis
ma
y
b
e
simplied
b
y
constructing
the
transformation
in
t
w
o
steps
In
the
rst
step
w
e
use
a
linear
transformation
to
map
an
arbitrary
elemen
t
on
to
a
canonical
elemen
t
ha
ving
v
ertices
at

	

	
and

	
but
with
one
curv
ed
side
In
the
second
step
w
e
remo
v
e
the
curv
ed
side
using
the
quadratic
transformation
	
The
linear
mapping
of
the
rst
step
has
a
constan
t
Jacobian
determinan
t
and
therefore
cannot
a
ect
the
in
v
ertibilit
y
of
the
system
Th
us
it
suces
to
consider
the
second
step
of
the
transformation
as
sho
wn
in
Figure

Setting
x


y

	


	
x


y

	


	
and
x


y

	


	
in
a	
yields

x


	
y



	






!
N







!
N




x

y


!
N



Using
ce	

x


	
y



	







	




	





x

y



Calculating
the
Jacobian
J
e



	


x

x

y

y








x




x




y






y






Co
ordinate
T
ransformations

































































y
1
3
5
6
4
2
ξ
η
4
1
6
3
x
2
5
Figure

Quadratic
mapping
of
a
righ
t
triangle
ha
ving
one
curv
ed
side
The
shaded
region
indicates
where
No
de

can
b
e
placed
without
in
tro
ducing
a
singularit
y
in
the
mapping
w
e
nd
the
determinan
t
as
det
J
e



	



x


	

y


	

The
Jacobian
determinan
t
is
a
linear
function
of

and


th
us
as
with
Example

w
e
need
only
ensure
that
it
has
the
same
sign
at
eac
h
of
its
three
v
ertices
W
e
ha
v
e
det
J
e

		


det
J
e

		

x



detJ
e

		

y



Hence
the
Jacobian
determinan
t
will
not
v
anish
and
the
mapping
will
b
e
in
v
ertible
when
x



and
y



cf
Problem

at
the
end
of
this
section	
This
region
is
sho
wn
shaded
on
the
triangle
of
Figure

Problems

Consider
the
secondorder
serendipit
y
shap
e
functions
of
Problem

or
the
secondorder
hierarc
hical
shap
e
functions
of
Section

Let
the
four
v
ertex
no
des
b
e
n
um
b
ered

	

	

	
and

	
and
the
four
midside
no
des
b
e
n
um
b
ered

	

	

	
and

	
Use
the
serendipit
y
shap
e
functions
of
Problem

to
map
the
canonical



square
elemen
t
on
to
an
eigh
tno
ded
quadrilateral
ele
men
t
with
curv
ed
sides
in
the
x
y
	plane
Assume
that
the
v
ertex
and
midside
no
des
of
the
ph
ysical
elemen
t
ha
v
e
the
same
n
um
b
ering
as
the
canonical
elemen
t
but
ha
v
e
co
ordinates
at
x
ij

y
ij
	
i
j




i

j


Can
the
Jacobian
of
the
transformation
v
anish
for
some
particular
c
hoices
of
x
y
	"
This
is
not
a
simple
question
It
suces
to
giv
e
some
qualitativ
e
reasoning
as
to
ho
w
and
wh
y
the
Jacobian
ma
y
or
ma
y
not
v
anish	


Mesh
Generation
and
Assem
bly

Consider
the
transformation
	
of
Example

with
x


y



and
sk
etc
h
the
elemen
t
in
the
x
y
	plane
Sk
etc
h
the
elemen
t
for
some
c
hoice
of
x


y




Generation
of
Elemen
t
Matrices
and
V
ectors
and
Their
Assem
bly
Ha
ving
discretized
the
domain
the
next
step
is
to
select
a
nite
elemen
t
basis
and
generate
and
assem
ble
the
elemen
t
sti
ness
and
mass
matrices
and
load
v
ectors
As
a
review
w
e
summarize
some
of
the
t
w
odimensional
shap
e
functions
that
w
ere
dev
elop
ed
in
Chapter

in
T
ables

and

No
des
are
sho
wn
on
the
mesh
en
tities
for
the
Lagrangian
and
hierarc
hical
shap
e
functions
As
noted
in
Section

ho
w
ev
er
the
shap
e
functions
ma
y
b
e
asso
ciated
with
the
en
tities
without
in
tro
ducing
mo
dal
p
oin
ts
The
n
um
b
er
of
parameters
n
p
for
an
elemen
t
ha
ving
order
p
shap
e
functions
is
presen
ted
for
p





W
e
also
list
an
estimate
of
the
n
um
b
er
of
unkno
wns
degrees
of
freedom	
N
for
scalar
problems
solv
ed
on
unit
square
domains
using
uniform
meshes
of
n

triangular
or
n

square
elemen
ts
Both
the
Lagrange
and
hierarc
hical
bases
of
order
p
ha
v
e
the
same
n
um
b
er
of
param
eters
and
degrees
of
freedom
on
the
uniform
triangular
meshes
Without
constrain
ts
for
Diric
hlet
data
the
n
um
b
er
of
degrees
of
freedom
is
N

pn

	

cf
Problem

at
the
end
of
this
section	
Diric
hlet
data
on
the
en
tire
b
oundary
w
ould
reduce
N
b
y
O
pn	
and
hence
b
e
a
higherorder
e
ect
when
n
is
large
The
asymptotic
appro
ximation
N

pn	

is
recorded
in
T
able

Similarly

bip
olynomial
appro
ximations
of
order
p
on
squares
with
n

uniform
elemen
ts
ha
v
e
N

pn

	

degrees
of
freedom
again
cf
Problem
	
The
asymptotic
appro
ximation
pn	

is
rep
orted
in
T
able

Under
the
same
conditions
hierarc
hical
bases
on
squares
ha
v
e
N


p

	n


pn


if
p


p


p

	n



pn


if
p
	


degrees
of
freedom
The
asymptotic
v
alues
N

p

	N


p


and
N

p


p

	n


p
	

are
rep
orted
in
T
able

The
Lagrange
and
hierarc
hical
bases
on
triangles
and
the
Lagrange
bip
olynomial
bases
on
squares
ha
v
e
appro
ximately
the
same
n
um
b
er
of
degrees
of
freedom
for
a
giv
en
order
p
The
hierarc
hical
bases
on
squares
ha
v
e
ab
out
half
the
degrees
of
freedom
of
the
others
The
bip
olynomial
Lagrange
shap
e
functions
on
a
square
ha
v
e
the
largest
n
um
b
er
of
parameters
p
er
elemen
t
for
a
giv
en
p
The
n
um
b
er
of
parameters
p
er
elemen
t
a
ects
the
elemen
t
matrix
and
v
ector
computations
while
the
n
um
b
er
of
degrees
of
freedom
a
ects
the
solution
time
W
e
cannot
ho
w
ev
er
dra
w
rm
conclusions
ab
out
the
sup
eriorit
y
of
one
basis
relativ
e
to
another
The
selection
of
an
optimal
basis
for
an
in
tended
lev
el


Elemen
t
Matrices
and
Their
Assem
bly

p
Lagrange
Hierarc
hical
n
p
N

p

n

Stencil
Stencil






































n











































































n









































































































	n







































































































































n

T
able

Shap
e
function
placemen
t
for
Lagrange
and
hierarc
hical
nite
elemen
t
ap
pro
ximations
of
degrees
p





on
triangular
elemen
ts
with
their
n
um
b
er
of
param
eters
p
er
elemen
t
n
p
and
degrees
of
freedom
N
on
a
square
with
n

elemen
ts
Circles
indicate
additional
shap
e
functions
lo
cated
on
a
mesh
en
tit
y

of
accuracy
is
a
complex
issue
that
dep
ends
on
solution
smo
othness
geometry

and
the
partial
di
eren
tial
system
W
ell
examine
this
topic
in
a
later
c
hapter
A
t
least
it
seems
clear
that
bip
olynomial
bases
are
not
comp
etitiv
e
with
hierarc
hical
ones
on
square
elemen
ts

Generation
of
Elemen
t
Matrices
and
V
ectors
The
generation
of
the
elemen
t
sti
ness
and
mass
matrices
and
load
v
ectors
is
largely
indep
enden
t
of
the
partial
di
eren
tial
system
b
eing
solv
ed
ho
w
ev
er
let
us
fo
cus
on
the
mo
del
problem
of
Section

in
order
to
illustrate
the
pro
cedures
less
abstractly

Th
us
consider
the
t
w
odimensional
Galerkin
problem
determine
u

H

E
satisfying
Av

u	

v

f
	
v

H



a	


Mesh
Generation
and
Assem
bly
p
Lagrange
Hierarc
hical
Stencil
n
p
N

M
n

Stencil
n
p
N

M
n























n






















n












































	
n








































n



















































































	n








































n



















































































 


 
















 














n












































n

T
able

Shap
e
function
placemen
t
for
bip
olynomial
Lagrange
and
hierarc
hical
ap
pro
ximations
of
degrees
p





on
square
elemen
ts
with
their
n
um
b
er
of
parameters
p
er
elemen
t
n
p
and
degrees
of
freedom
N
on
a
square
with
n

elemen
ts
Circles
indicate
additional
shap
e
functions
lo
cated
on
a
mesh
en
tit
y

where
v

f
	

Z
Z
	
v
f
dxdy
b	
Av

u	

Z
Z
	
pv
x
u
x

v
y
u
y
	

q
v
udxdy
c	
As
usual

is
a
t
w
odimensional
domain
with
b
oundary





E



N

Recall
that
smo
oth
solutions
of
	
satisfy
pu
x
	
x

pu
y
	
y

q
u

f

x
y
	


a	


Elemen
t
Matrices
and
Their
Assem
bly

u



x
y
	



E

b	
u
n


x
y
	



N

c	
where
n
is
the
unit
out
w
ard
normal
v
ector
to


T
rivial
natural
b
oundary
conditions
are
considered
for
simplicit
y

More
complicated
situations
will
b
e
examined
later
in
this
section
F
ollo
wing
the
onedimensional
examples
of
Chapters

and

w
e
select
nitedimensional
subspaces
S
N
E
and
S
N

of
H

E
and
H


and
write
bc	
as
the
sum
of
con
tributions
o
v
er
elemen
ts
V

f
	

N

X
e
V

f
	
e

a	
AV

U
	

N

X
e
A
e
V

U
	
b	
Here
N

is
the
n
um
b
er
of
elemen
ts
in
the
mesh
V

f
	
e

Z
Z
	
e
V
f
dxdy
c	
is
the
lo
cal
L

inner
pro
duct
A
e
V

U
	

Z
Z
	
e
pV
x
U
x

V
y
U
y
	

q
V
U
dxdy
d	
is
the
lo
cal
strain
energy

and

e
is
the
p
ortion
of

o
ccupied
b
y
elemen
t
e
The
ev
aluation
of
cd	
can
b
e
simple
or
complex
dep
ending
on
the
functions
p
q

and
f
and
the
mesh
used
to
discretize

If
p
and
q
w
ere
constan
t
for
example
the
lo
cal
strain
energy
d	
could
b
e
in
tegrated
exactly
as
illustrated
in
Chapters

and

for
onedimensional
problems
Lets
pursue
a
more
general
approac
h
and
discuss
pro
cedures
based
on
transforming
in
tegrals
cd	
on
elemen
t
e
to
a
canonical
elemen
t

and
ev
aluating
them
n
umerically

Th
us
let
U




	

U
x


	
y



		
and
V




	

V
x


	
y



		
and
transform
the
in
tegrals
cd		
to
elemen
t

to
get
V

f
	
e

Z
Z
	

V




	f
x


	
y



		
det
J
e
	d
d

a	
A
e
V

U
	

Z
Z
	

pV



x

V



x
	U



x

U



x
	


Mesh
Generation
and
Assem
bly
pV



y

V



y
	U



y

U



y
	

q
V

U


det
J
e
	d
d
where
J
e
is
the
Jacobian
of
the
transformation
cf
		
Expanding
the
terms
in
the
strain
energy
A
e
V

U
	

Z
Z
	

g
e
V


U



g
e
V


U



V


U


	

g
e
V


U



q
V

U


detJ
e
	d
d
b	
where
g
e

px


	
y



		

x



y

c	
g
e

px


	
y



		
x

x


y

y

d	
g
e

px


	
y



		

x



y

e	
The
in
tegrand
of
b	
migh
t
app
ear
to
b
e
p
olynomial
for
constan
t
p
and
a
p
oly
nomial
mapping
ho
w
ev
er
this
is
not
the
case
In
Section

w
e
sho
w
ed
that
the
in
v
erse
co
ordinate
mapping
satises

x

y

detJ
e
	


y


x

det
J
e
	


x


y

det
J
e
	


y

x

det
J
e
	

	
The
functions
g
ie

i




are
prop
ortional
to

detJ
e
	


th
us
the
in
tegrand
of
b	
is
a
rational
function
unless
of
course
detJ
e
	
is
a
constan
t
Let
us
write
U

and
V

in
the
form
U




	

c
T
e
N


	

N


	
T
c
e

V




	

d
T
e
N


	

N


	
T
d
e
	
where
the
v
ectors
c
e
and
d
e
con
tain
the
elemen
tal
parameters
and
N


	
is
a
v
ector
con
taining
the
elemen
tal
shap
e
functions
Example

F
or
a
linear
p
olynomial
on
the
canonical
righ
t


triangular
elemen
t
ha
ving
v
ertices
n
um
b
ered

to

as
sho
wn
in
Figure

c
e



c
e
c
e
c
e



N


	













The
actual
v
ertex
indices
sho
wn
as
i
j

ab
d
k

are
mapp
ed
to
the
canonical
indices


and

Example

The
treatmen
t
of
hierarc
hical
p
olynomials
is
more
in
v
olv
ed
b
ecause
there
can
b
e
more
than
one
parameter
p
er
no
de
Consider
the
case
of
a
cubic
hierarc
hical


Elemen
t
Matrices
and
Their
Assem
bly





































i
j
k
i, 1
j, 2
k, 3
e
0
ξ
η
Figure

Linear
transformation
of
a
triangular
elemen
t
e
to
a
canonical
righ
t


triangle
function
on
a
triangle
T
ranslating
the
basis
construction
of
Section

to
the
canonical
elemen
t
w
e
obtain
an
appro
ximation
of
the
form
	
with
c
T
e

c
e

c
e


c
e

N
T

N




	
N




	

N




	
The
basis
has
ten
shap
e
functions
p
er
elemen
t
cf
			
whic
h
are
ordered
as
N




	










N




	






N




	






N




	


p





N




	


p





N




	


p






N




	


p







	
N




	


p







	
N
	



	


p







	
N




	








With
this
ordering
the
rst
three
shap
e
functions
are
asso
ciated
with
the
v
ertices
the
next
three
are
quadratic
corrections
at
the
midsides
the
next
three
are
cubic
corrections
at
the
midsides
and
the
last
is
a
cubic
bubble
function
asso
ciated
with
the
cen
troid
Figure
	
An
arra
y
implemen
tation
as
describ
ed
b
y
	
and
Examples


and

ma
y
b
e
the
simplest
data
structure
ho
w
ev
er
implemen
tations
with
structures
link
ed
to
geometric
en
tities
Section
	
are
also
p
ossible
Substituting
the
p
olynomial
represen
tation
	
in
to
the
transformed
strain
energy
expression
b	
and
external
load
a	
yields
A
e
V

U
	

d
T
e
K
e

M
e
	c
e

a	


Mesh
Generation
and
Assem
bly




























ξ
η
3
4, 7
1
2
6, 9
5, 8
10
Figure

Shap
e
function
placemen
t
and
n
um
b
ering
for
a
hierarc
hical
cubic
appro
xi
mation
on
a
canonical
righ
t


triangle
V

f
	
e

d
T
e
f
e

b	
where
K
e

Z
Z
	

g
e
N

N
T


g
e
N

N
T


N

N
T

	

g
e
N

N
T


detJ
e
	d
d

a	
M
e

Z
Z
	

q
NN
T
det
J
e
	d
d

b	
f
e

Z
Z
	

Nf
det
J
e
	d
d

c	
Here
K
e
and
M
e
are
the
elemen
t
sti
ness
and
mass
matrices
and
f
e
is
the
elemen
t
load
v
ector
Numerical
in
tegration
will
generally
b
e
necessary
to
ev
aluate
these
arra
ys
when
the
co
ordinate
transformation
is
not
linear
and
w
e
will
study
pro
cedures
to
do
this
in
Chapter

Elemen
t
mass
and
sti
ness
matrices
and
load
v
ectors
are
generated
for
all
elemen
ts
in
the
mesh
and
assemble
d
in
to
their
prop
er
lo
cations
in
the
global
sti
ness
and
mass
matrix
and
load
v
ector
The
p
ositions
of
the
elemen
tal
matrices
and
v
ectors
in
their
global
coun
terparts
are
determined
b
y
their
indexing
In
order
to
illustrate
this
p
oin
t
consider
a
linear
shap
e
function
on
an
elemen
t
with
V
ertices


and

as
sho
wn
in
Figure

These
v
ertex
indices
are
mapp
ed
on
to
lo
cal
indices
eg



of
the
canonical
elemen
t
and
the
corresp
ondence
is
recorded
as
sho
wn
in
Figure

After
generating
the
elemen
t
matrices
and
v
ectors
the
global
indexing
determines
where
to
add


Elemen
t
Matrices
and
Their
Assem
bly
	
these
en
tries
in
to
the
global
sti
nes
and
mass
matrix
and
load
v
ector
In
the
example
sho
wn
in
Figure

the
en
try
k
e

is
added
to
Ro
w

and
Column

of
the
global
sti
ness
matrix
K
The
en
try
k
e

is
added
to
Ro
w

and
Column

of
K
etc
The
assem
bly
pro
cess
a
v
oids
the
explicit
summations
implied
b
y
	
and
yields
AV

U
	

d
T
K

M	c
	a	
V

f
	

d
T
f

	b	
where
c
T

c


c



c
N

	c	
d
T

d


d



d
N

	d	
where
K
is
the
global
sti
ness
matrix
M
is
the
global
mass
matrix
f
is
the
global
load
v
ector
and
N
is
the
dimension
of
the
trial
space
or
the
n
um
b
er
of
degrees
of
freedom	
Imp
osing
the
Galerkin
condition
a	
AV

U
	

V

f
	

d
T
K

M	c

f



d


N

a	
yields
K

M	c

f

b	

Essen
tial
and
Neumann
Boundary
Conditions
Its
customary
to
ignore
an
y
essen
tial
b
oundary
conditions
during
the
assem
bly
phase
W
ere
b
oundary
conditions
not
imp
osed
the
matrix
K

M
w
ould
b
e
singular
Essen
tial
b
oundary
conditions
constrain
some
of
the
c
i

i




N

and
they
m
ust
b
e
imp
osed
b
efore
the
algebraic
system
b	
can
b
e
solv
ed
In
order
to
simplify
the
discussion
let
us
supp
ose
that
either
M


or
that
M
has
b
een
added
to
K
so
that
	
ma
y
b
e
written
as
d
T
Kc

f



d


N

a	
Kc

f

b	


Mesh
Generation
and
Assem
bly












4
7
8
Global
Lo
cal


















1
2
3
K
e



k
e

k
e

k
e

k
e

k
e

k
e

k
e

k
e

k
e



f
e



f
e

f
e

f
e











	
K















k
e

k
e

k
e

k
e

k
e

k
e

k
e

k
e

k
e























	
f













f
e

f
e

f
e













Figure

Assem
bly
of
an
elemen
t
sti
ness
matrix
and
load
v
ector
in
to
their
global
coun
terparts
for
a
piecewiselinear
p
olynomial
appro
ximation
The
actual
v
ertex
indices
are
recorded
and
stored
top	
the
elemen
t
sti
ness
matrix
and
load
v
ector
are
calculated
cen
ter	
and
the
indices
are
used
to
determine
where
to
add
the
en
tries
of
the
elemen
tal
matrix
and
v
ector
in
to
the
global
sti
ness
and
mass
matrix


Elemen
t
Matrices
and
Their
Assem
bly

Essen
tial
b
oundary
conditions
ma
y
either
constrain
a
single
c
i
or
imp
ose
constrain
ts
b
et
w
een
sev
eral
no
dal
v
ariables
In
the
former
case
w
e
partition
a	
as
d

d



K

K

K

K



c

c




f

f




a	
where
the
essen
tial
b
oundary
conditions
are
c





b	
Recall
Chapters

and
	
that
the
test
function
V
should
v
anish
on


E

th
us
corre
sp
onding
to
b	
d



c	
The
second
blo
c
k
of
equations
in
a	
should
nev
er
ha
v
e
b
een
generated
and
actually

w
e
should
ha
v
e
b
een
solving
d
T

K

c


K

c


f



d
T

K

c


K




f




a	
Imp
osing
the
Galerkin
condition
that
a	
v
anish
for
al
l
d


K

c


f


K




b	
P
artitioning
	
need
not
b
e
done
explicitly
as
in
	
It
can
b
e
done
im
plicitly
without
rearranging
equations
Consider
the
original
system
b	







k

k
j
k
N









k
j




k
j
j



k
j
N









k
N

k
N
j
k
N
N














c




c
j



c
N















f




f
j



f
N








	
Supp
ose
that
one
b
oundary
condition
sp
ecies
c
j


j

then
the
j
th
equation
ro
w	
of
the
system
is
deleted
c
j
is
replaced
b
y
the
b
oundary
condition
and
the
co
ecien
ts
of
c
j
are
mo
v
ed
to
the
righ
thand
side
to
obtain









k

k
j

k
j

k
N












k
j




k
j
j

k
j
j




k
j
N
k
j




k
j
j

k
j
j




k
j
N












k
N

k
N
j

k
N
j

k
N
N


















c




c
j

c
j




c
N



















f


k
j

j



f
j


k
j
j

j
f
j


k
j
j

j



f
N

k
N
j

j












Mesh
Generation
and
Assem
bly
When
the
algebraic
system
is
large
the
cost
of
mo
ving
data
when
ro
ws
and
columns
are
remo
v
ed
from
the
system
ma
y
out
w
eigh
the
cost
of
solving
a
larger
algebraic
system
In
this
case
the
b
oundary
condition
c
j


j
can
b
e
inserted
as
the
j
th
equation
of
	
Although
not
necessary

the
j
th
column
is
usually
mo
v
ed
to
the
righ
thand
side
to
preserv
e
symmetry

The
resulting
larger
problem
is







k


k
N



























k
N


k
N
N














c




c
j



c
N















f


k
j

j




j



f
N

k
N
j

j








The
treatmen
t
of
essen
tial
b
oundary
conditions
that
imp
ose
constrain
ts
among
sev
eral
no
dal
v
ariables
is
m
uc
h
more
dicult
Supp
ose
for
example
there
are
l
b
oundary
conditions
of
the
form
Tc


	
where
T
is
an
l

N
matrix
and

is
an
l
v
ector
In
v
ector
systems
of
partial
di
eren
tial
equations
suc
h
b
oundary
conditions
arise
when
constrain
ts
are
sp
ecied
b
et
w
een
di
eren
t
comp
onen
ts
of
the
solution
v
ector
In
scalar
problems
conditions
ha
ving
the
form
	
arise
when
a
global
b
oundary
condition
lik
e
Z

	
uds


is
sp
ecied
They
could
also
arise
with
p
erio
dic
b
oundary
conditions
whic
h
migh
t
for
example
sp
ecify
u
y
	

u
y
	
if
u
w
ere
p
erio
dic
in
x
on
a
rectangle
of
unit
length
One
could
p
ossibly
solv
e
	
for
l
v
alues
of
c
i

i




N

in
terms
of
the
others
Sometimes
there
is
an
ob
vious
c
hoice
ho
w
ev
er
often
there
is
no
clear
w
a
y
to
c
ho
ose
the
unkno
wns
to
eliminate
A
p
o
or
c
hoice
can
lead
to
illconditioning
of
the
algebraic
system
An
alternate
w
a
y
of
treating
problems
with
b
oundary
conditions
suc
h
as
	
is
to
em
b
ed
Problem
	
in
a
constrained
minimization
problem
whic
h
ma
y
b
e
solv
ed
using
Lagrange
m
ultipliers
Assuming
K
to
b
e
symmetric
and
p
ositiv
e
semidenite
	
can
b
e
regarded
as
the
minim
um
of
I
c

c
T
Kc

c
T
f

Using
Lagrange
m
ultipliers
w
e
minimize
the
mo
died
functional
#
I
c



c
T
Kc

c
T
f


T
Tc

	


Elemen
t
Matrices
and
Their
Assem
bly

where

is
an
l
v
ector
of
Lagrange
m
ultipliers
Minimizing
#
I
with
resp
ect
to
c
and

yields

K
T
T
T



c




f



	
The
system
	
ma
y
or
ma
y
not
b
e
simple
to
solv
e
If
K
is
nonsingular
then
the
algorithm
describ
ed
in
Problem

at
the
end
of
this
section
is
e
ectiv
e
Ho
w
ev
er
since
b
oundary
conditions
are
prescrib
ed
b
y
	
K
ma
y
not
b
e
in
v
ertible
Non
trivial
Neumann
b
oundary
conditions
on


N
require
the
ev
aluation
of
an
extra
line
in
tegral
for
those
elemen
ts
ha
ving
edges
on


N

Supp
ose
for
example
that
the
v
ariational
principle
	
is
replaced
b
y
determine
u

H

E
satisfying
Av

u	

v

f
	

v



v

H



a	
where

v



Z

	
N
v

x
y
	ds
b	
s
b
eing
a
co
ordinate
on


N

As
discussed
in
Chapter

smo
oth
solutions
of
	
satisfy
a	
the
essen
tial
b
oundary
conditions
b	
and
the
natural
b
oundary
condition
pu
n



x
y
	



N

	
The
line
in
tegral
b	
is
ev
aluated
in
the
same
manner
as
the
area
in
tegrals
and
it
will
alter
the
load
v
ector
f
cf
Problem

at
the
end
of
this
section	
Problems

Determine
the
n
um
b
er
of
degrees
of
freedom
when
a
scalar
nite
elemen
t
Galerkin
problem
is
solv
ed
using
either
Lagrange
or
hierarc
hical
bases
on
a
square
region
ha
ving
a
uniform
mesh
of
either
n

triangular
or
n

square
elemen
ts
Express
y
our
answ
er
in
terms
of
p
and
n
and
compare
it
with
the
results
of
T
ables

and


Assume
that
K
is
in
v
ertible
and
sho
w
that
the
follo
wing
algorithm
pro
vides
a
solution
of
	
Solv
e
KW

T
T
for
W
Let
Y

TW
Solv
e
Ky

f
for
y
Solv
e
Y


T
y


for

Solv
e
Kc

f

T
T

for
c


Mesh
Generation
and
Assem
bly

Calculate
the
e
ect
on
the
elemen
t
load
v
ector
f
e
of
a
non
trivial
Neumann
condition
ha
ving
the
form
	

Consider
the
solution
of
Laplaces
equation
u
xx

u
y
y


x
y
	


on
the
unit
square


fx
y
	j

x
y

g
with
Diric
hlet
b
oundary
conditions
u



x
y
	



As
describ
ed
in
the
b
eginning
of
this
section
create
a
mesh
b
y
dividing
the
unit
square
in
to
n

uniform
square
elemen
ts
and
then
in
to
n

triangles
b
y
cutting
eac
h
square
elemen
t
in
half
along
its
p
ositiv
e
sloping
diagonal

Using
a
Galerkin
form
ulation
with
a
piecewiselinear
basis
dev
elop
the
elemen
t
sti
ness
matrices
for
eac
h
of
the
t
w
o
t
yp
es
of
elemen
ts
in
the
mesh

Assem
ble
the
elemen
t
sti
ness
matrices
to
form
the
global
sti
ness
matrix

Apply
the
Diric
hlet
b
oundary
conditions
and
exhibit
the
nal
linear
algebraic
system
for
the
no
dal
unkno
wns

The
task
is
is
to
solv
e
a
Diric
hlet
problem
on
a
square
using
a
v
ailable
nite
elemen
t
soft
w
are
The
problem
is
u
xx

u
y
y

f
x
y
	


x
y
	


with
u


on
the
b
oundary
of
the
unit
square


fx
y
	j

x
y

g
Select
f
x
y
	
so
that
the
exact
solution
of
the
problem
is
ux
y
	

e
x
y
sin
	
x
sin
	
y

The
Galerkin
form
of
this
problem
is
to
nd
u

H


satisfying
Z
Z
	
v
x
u
x

v
y
u
y

v
f
dxdy


v

H



Solv
e
this
problem
on
a
sequence
of
ner
and
ner
grids
using
piecewise
linear
quadratic
and
cubic
nite
elemen
t
bases
Select
a
basic
grid
with
either
t
w
o
or
four
elemen
ts
in
it
and
obtain
ner
grids
b
y
uniform
renemen
t
of
eac
h
elemen
t
in
to
four
elemen
ts
Presen
t
plots
of
the
energy
error
as
functions
of
the
n
um
b
er
of
degrees
of
freedom
DOF	
the
mesh
spacing
h
and
the
CPU
time
for
the
three
p
olynomial
bases
Dene
h
as
the
square
ro
ot
of
the
area
of
an
a
v
erage
elemen
t


Elemen
t
Matrices
and
Their
Assem
bly

Y
ou
ma
y
com
bine
the
con
v
ergence
histories
for
the
three
p
olynomial
solutions
on
one
graph
Th
us
y
oull
ha
v
e
three
graphs
error
vs
h
error
vs
DOF
and
error
vs
CPU
time
eac
h
ha
ving
results
for
the
three
p
olynomial
solutions
Estimate
the
con
v
ergence
rates
of
the
solutions
Commen
t
on
the
results
Are
they
con
v
erging
at
the
theoretical
rates"
Are
there
an
y
unexp
ected
anomalies"
If
so
try
to
explain
them
Y
ou
ma
y
include
plots
of
solutions
andor
meshes
to
help
answ
er
these
questions

Consider
the
Diric
hlet
problem
for
Laplaces
equation
$u

u
xx

u
y
y


x
y
	


ux
y
	


x
y
	
x
y
	



where

is
the
Lshap
ed
region
with
lines
connecting
the
Cartesian
v
ertices
	
	
	
	
	
	
	
Select

x
y
	
so
that
the
exact
solution
expressed
in
p
olar
co
ordinates
is
ur


	

r

sin



with
x

r
cos


y

r
sin


This
solution
has
a
singularit
y
in
its
rst
deriv
ativ
e
at
r


The
singularit
y
is
t
ypical
of
those
asso
ciated
with
the
solution
of
elliptic
problems
at
reen
tran
t
corners
suc
h
as
the
one
found
at
the
origin
Because
of
symmetries
the
problem
need
only
b
e
solv
ed
on
half
of
the
Lshap
ed
domain
ie
the
trap
ezoidal
region
#

with
lines
connecting
the
Cartesian
v
ertices
	
	
	
	
	
The
Galerkin
form
of
this
problem
consists
of
determining
u

H

E
Z
Z

	
v
x
u
x

v
y
u
y
dxdy


v

H



F
unctions
u

H

E
satisfy
the
essen
tial
b
oundary
conditions
ux
y
	


y




x


ur


	

r

sin



x




y


y




x


These
b
oundary
conditions
ma
y
b
e
expressed
in
Cartesian
co
ordinates
b
y
using
r


x


y


tan


y
x



Mesh
Generation
and
Assem
bly
The
solution
of
the
Galerkin
problem
will
also
satisfy
the
natural
b
oundary
condi
tion
u
n

u



along
the
diagonal
y

x
Solv
e
this
problem
using
a
v
ailable
nite
elemen
t
soft
w
are
T
o
b
egin
create
a
threeelemen
t
initial
mesh
b
y
placing
lines
b
et
w
een
the
v
ertices
	
and
	
and
b
et
w
een
	
and
	
Generate
ner
meshes
b
y
uniform
renemen
t
and
use
piecewisep
olynomial
bases
of
degrees
one
through
three
As
in
Problem

presen
t
plots
of
the
energy
error
as
functions
of
the
n
um
b
er
of
degrees
of
freedom
the
mesh
spacing
h
and
the
CPU
time
for
the
three
p
olyno
mial
bases
Y
ou
ma
y
com
bine
the
con
v
ergence
histories
for
the
three
p
olynomial
solutions
on
one
graph
Dene
h
as
the
square
ro
ot
of
the
area
of
an
a
v
erage
ele
men
t
Estimate
the
con
v
ergence
rates
of
the
solutions
Is
accuracy
higher
with
a
highorder
metho
d
on
a
coarse
mesh
or
with
a
lo
worder
metho
d
on
a
ne
mesh"
If
adaptivit
y
is
a
v
ailable
use
a
piecewiselinear
basis
to
calculate
a
solution
using
adaptiv
e
hrenemen
t
Plot
the
energy
error
of
this
solution
with
those
of
the
uniformmesh
solutions
Is
the
adaptiv
e
solution
more
ecien
t"
Eciency
ma
y
b
e
dened
as
less
CPU
time
or
few
er
degrees
of
freedom
for
the
same
accuracy

Con
trast
the
uniform
and
adaptiv
e
meshes

Assem
bly
of
V
ector
Systems
V
ector
systems
of
partial
di
eren
tial
equations
ma
y
b
e
treated
in
the
same
manner
as
the
scalar
problems
describ
ed
in
the
previous
section
As
an
example
consider
the
v
ector
v
ersion
of
the
mo
del
problem
	
determine
u

H

E
satisfying
Av

u	

v

f
	
v

H



a	
where
v

f
	

Z
Z
	
v
T
f
dxdy

b	
Av

u	

Z
Z
	
v
T
x
Pu
x

v
T
y
Pu
y

v
T
Qudxdy

c	
The
functions
ux
y
	
v
x
y
	
and
f
x
y
	
are
mv
ectors
and
P
and
Q
are
m

m
matrices
Smo
oth
solutions
of
	
satisfy
Pu
x
	
x

Pu
y
	
y

Qu

f

x
y
	


a	


Assem
bly
of
V
ector
Systems

u


x
y
	



D

u
n


x
y
	



N

b	
Example

Consider
the
biharmonic
equation
$

w

f
x
y
	
x
y
	


where
$
	


	
xx


	
y
y
is
the
Laplacian
and

is
a
b
ounded
t
w
odimensional
region
Problems
in
v
olving
bihar
monic
op
erators
arise
in
elastic
plate
deformation
slo
w
viscous
o
w
com
bustion
etc
Dep
ending
on
the
b
oundary
conditions
this
problem
ma
y
b
e
transformed
to
a
system
of
t
w
o
secondorder
equations
ha
ving
the
form
	
F
or
example
it
seems
natural
to
let
u


$w
then
$u


f

Let
w

u

to
obtain
the
v
ector
system
$u


f

$u


u



x
y
	


This
system
has
the
form
	
with
u


u

u



P

I
Q








f


f



The
simplest
b
oundary
conditions
to
prescrib
e
are
w

u





$w

u





x
y
	



With
these
Diric
hlet	
b
oundary
conditions
the
v
ariational
form
of
this
problem
is
a	
with
v

f
	

Z
Z
	
v

f
dxdy
and
Av

u	

Z
Z
	
v

	
x
u

	
x

v

	
y
u

	
y

v

	
x
u

	
x

v

	
y
u

	
y

v

u

dxdy

The
requiremen
t
that
a	
b
e
satised
for
all
v
ector
functions
v

H


giv
es
the
t
w
o
scalar
v
ariational
problems
Z
Z
	
v

	
x
u

	
x

v

	
y
u

	
y

v

f
dxdy


v


H





Mesh
Generation
and
Assem
bly
Z
Z
	
v

	
x
u

	
x

v

	
y
u

	
y

v

u

dxdy


v


H



W
e
ma
y
c
hec
k
that
smo
oth
solutions
of
these
v
ariational
problems
satisfy
the
pair
of
secondorder
di
eren
tial
equations
listed
ab
o
v
e
W
e
note
in
passing
that
the
b
oundary
conditions
presen
ted
with
this
example
are
not
the
only
ones
of
in
terest
Other
b
oundary
conditions
do
not
separate
the
system
as
neatly

F
ollo
wing
the
pro
cedures
describ
ed
in
Section

w
e
ev
aluate
	
in
an
elemen
t
b
yelemen
t
manner
and
transform
the
elemen
tal
strain
energy
and
load
v
ector
to
the
canonical
elemen
t
to
obtain
A
e
V

U	

Z
Z
	

V
T


G
e
U



V
T


G
e
U



V
T


G
e
U



V
T


G
e
U



V
T

QU


detJ
e
	d
d

a	
where
G
e

P

x



y

G
e

P
x

x


y

y

G
e

P

x



y

b	
and
V

f
	
e

Z
Z
	

V
T

f
detJ
e
	d
d

c	
The
restriction
of
the
piecewisep
olynomial
appro
ximation
U

to
elemen
t
e
is
written
in
terms
of
shap
e
functions
as
U




	

n
p
X
j

c
ej
N
j



	
a	
where
n
p
is
the
n
um
b
er
of
shap
e
functions
on
elemen
t
e
W
e
ha
v
e
divided
the
v
ector
c
e
of
parameters
in
to
its
con
tributions
c
ej

j




n
from
the
shap
e
functions
of
elemen
t
e
Th
us
w
e
ma
y
write
c
T
e

c
T
e

c
T
e


c
T
en
p

b	
In
this
form
w
e
ma
y
write
U

as
U


N
T
c
e

c
T
e
N
c	


Assem
bly
of
V
ector
Systems
	
where
N
is
the
n
p
m

m
matrix
N
T

N

I
N

I

N
n
p
I
d	
and
the
iden
tit
y
matrices
ha
v
e
the
dimension
m
of
the
partial
di
eren
tial
system
The
simple
linear
shap
e
functions
will
illustrate
the
form
ulation
Example

Consider
the
solution
of
a
system
of
m


equations
using
a
piecewiselinear
nite
elemen
t
basis
on
triangles
Supp
ose
for
con
v
enience
that
the
no
de
n
um
b
ers
of
elemen
t
e
are


and

In
order
to
simplify
the
notation
w
e
suppress
the
subscript

on
U

and
V

and
the
subscript
e
on
c
e

The
linear
appro
ximation
on
elemen
t
e
then
tak
es
the
form

U

U




c

c


N




	


c

c


N




	


c

c


N




	
where
N




	







N




	



N




	



The
rst
subscript
on
c
ij
denotes
its
index
in
c
and
the
second
subscript
iden
ties
the
v
ertex
of
elemen
t
e
The
expression
c	
tak
es
the
form

U

U




N


N


N



N


N


N










c

c

c

c

c

c










Substituting
c	
and
a
similar
expression
for
V

in
to
ae	
yields
A
e
V

U	

d
T
e
K
e

M
e
	c
e

V

f
	
e

d
T
e
f
e

	
where
K
e

Z
Z
	

N

G
e
N
T


N

G
e
N
T


N

G
e
N
T


N

G

eN
T


det
J
e
	
d

d

a	
M
e

Z
Z
	

NQN
T
det
J
e
	d
d

f
e

Z
Z
	

Nf
det
J
e
	d
d

b	
Problems


Mesh
Generation
and
Assem
bly

It
is
of
course
p
ossible
to
use
di
eren
t
shap
e
functions
for
di
eren
t
solution
com
p
onen
ts
This
is
often
done
with
incompressible
o
ws
where
the
pressure
is
appro
x
imated
b
y
a
basis
ha
ving
one
degree
less
than
that
used
for
v
elo
cit
y

V
ariational
form
ulations
with
di
eren
t
elds
are
called
mixe
d
variational
principles
The
result
ing
nite
elemen
t
form
ulations
are
called
mixe
d
metho
ds
As
an
example
consider
a
v
ector
problem
ha
ving
t
w
o
comp
onen
ts
Supp
ose
that
a
piecewiselinear
basis
is
used
for
the
rst
v
ariable
and
piecewise
quadratics
are
used
for
the
second
Using
hierarc
hical
bases
select
an
ordering
of
unkno
wns
and
write
the
form
of
the
nite
el
emen
t
solution
on
a
canonical
t
w
odimensional
elemen
t
What
are
the
comp
onen
ts
of
the
matrix
N"
F
or
this
appro
ximation
dev
elop
a
form
ula
for
the
elemen
t
sti

ness
matrix
a	
Express
y
our
answ
er
in
terms
of
the
matrices
G
ie

i




and
in
tegrals
of
the
shap
e
functions

Bibliograph
y

I
Babu
%
sk
a
JE
Flahert
y

WD
Hensha
w
JE
Hop
croft
JE
Oliger
and
T
T
ez
duy
ar
editors
Mo
deling
Mesh
Gener
ation
and
A
daptive
Numeric
al
Metho
ds
for
Partial
Di	er
ential
Equations
v
olume

of
The
IMA
V
olumes
in
Mathematics
and
its
Applic
ations
New
Y
ork
		
SpringerV
erlag

P
L
Baehmann
MS
Shephard
and
JE
Flahert
y

Adaptiv
e
analysis
for
automated
nite
elemen
t
mo
deling
In
JR
Whiteman
editor
The
Mathematics
of
Finite
Elements
and
Applic
ations
VI
MAFELAP
	
pages
&
London
	
Academic
Press

P
L
Baehmann
SL
Witc
hen
MS
Shephard
KR
Grice
and
MA
Y
erry

Ro
bust
geometricallybased
automatic
t
w
odimensional
mesh
generation
Interna
tional
Journal
of
Numeric
al
Metho
ds
in
Engine
ering
&
	

MW
Beall
and
MS
Shephard
A
general
top
ologybased
mesh
data
structure
International
Journal
of
Numeric
al
Metho
ds
in
Engine
ering
&	
		

MW
Bern
JE
Flahert
y

and
M
Luskin
editors
Grid
Gener
ation
and
A
daptive
A
lgorithms
v
olume

of
The
IMA
V
olumes
in
Mathematics
and
its
Applic
ations
New
Y
ork
			
Springer

GF
Carey

Computational
Grids
Gener
ation
A
daptation
and
Solution
Str
ate
gies
Series
in
Computational
and
Ph
ysical
Pro
cesses
in
Mec
hanics
and
Thermal
science
T
a
ylor
and
F
rancis
New
Y
ork
		

JE
Flahert
y

R
Lo
y

MS
Shephard
BK
Szymanski
J
T
eresco
and
L
Zian
tz
Adaptiv
e
lo
cal
renemen
t
with
o
ctree
loadbalancing
for
the
parallel
solution
of
threedimensional
conserv
ation
la
ws
Par
al
lel
and
Distribute
d
Computing
		
to
app
ear

JE
Flahert
y

RM
Lo
y

C
 
Ozturan
MS
Shephard
BK
Szymanski
JD
T
eresco
and
LH
Zian
tz
P
arallel
structures
and
dynamic
load
balancing
for
adaptiv
e
nite
elemen
t
computation
Applie
d
Numeric
al
Mathematics
&
		



Mesh
Generation
and
Assem
bly
	
JE
Flahert
y

P
J
P
aslo
w
MS
Shephard
and
JD
V
asilakis
editors
A
daptive
metho
ds
for
Partial
Di	er
ential
Equations
Philadelphia
		
SIAM

R
L 
ohner
Finite
elemen
t
metho
ds
in
CFD
Grid
generation
adaptivit
y
and
par
allelization
In
H
Deconinc
k
and
T
Barth
editors
Unstructur
e
d
Grid
Metho
ds
for
A
dve
ction
Dominate
d
Flows
n
um
b
er
A
GARD
Rep
ort
A
GARDR
Neuilly
sur
Seine
		
Chapter


R
V
erf
 
urth
A
R
eview
of
Posteriori
Err
or
Estimation
and
A
daptive
Mesh
R
enement
T
e
chniques
T
eubnerWiley

Stuttgart
		

Chapter

Numerical
In
tegration

In
tro
duction
After
transformation
to
a
canonical
elemen
t



t
ypical
in
tegrals
in
the
elemen
t
stiness
or
mass
matrices
cf

ha
v
e
the
forms
Q
	
Z
Z






N
s
N
T
t
det
J
e
d
d

a
where





dep
ends
on
the
co
ecien
ts
of
the
partial
dieren
tial
equation
and
the
transformation
to


cf
Section

The
subscripts
s
and
t
are
either
nil


or

implying
no
dieren
tiation
dieren
tiation
with
resp
ect
to


or
dieren
tiation
with
resp
ect
to


resp
ectiv
ely

Assuming
that
N
has
the
form
N
T
	
N


N






N
n
p

b
then
a
ma
y
b
e
written
in
the
more
explicit
form
Q
	
Z
Z












N


s
N


t
N


s
N


t
N


s
N
n
p

t
N


s
N


t
N


s
N


t
N


s
N
n
p

t



N
n
p

s
N


t
N
n
p

s
N


t
N
n
p

s
N
n
p

t





det
J
e
d
d

c
In
tegrals
of
the
form
b
ma
y
b
e
ev
aluated
exactly
when
the
co
ordinate
trans
formation
is
linear
J
e
is
constan
t
and
the
co
ecien
ts
of
the
dieren
tial
equation
are
constan
t
cf
Problem

at
the
end
of
this
section
With
certain
co
ecien
t
functions
and
transformations
it
ma
y
b
e
p
ossible
to
ev
aluate
b
exactly
b
y
sym
b
olic
in
tegration
ho
w
ev
er
w
ell
concen
trate
on
n
umerical
in
tegration
b
ecause

it
can
pro
vide
exact
results
in
simple
situations
eg
when

and
J
e
are
constan
ts
and



Numerical
In
tegration

exact
in
tegration
is
not
needed
to
ac
hiev
e
the
optimal
con
v
ergence
rate
of
nite
elemen
t
solutions

	


and
Chapter

In
tegration
is
often
called
quadr
atur
e
in
one
dimension
and
cub
atur
e
in
higher
dimen
sions
ho
w
ev
er
w
ell
refer
to
all
n
umerical
appro
ximations
as
quadr
atur
e
rules
W
ell
consider
in
tegrals
and
quadrature
rules
of
the
form
I
	
Z
Z


f



d
d

n
X
i
W
i
f

i


i

a
where
W
i

are
the
quadrature
rules
weights
and

i


i

are
the
evaluation
p
oints
i
	






n
Of
course
w
ell
w
an
t
to
appraise
the
accuracy
of
the
appro
ximate
in
tegration
and
this
is
t
ypically
done
b
y
indicating
those
p
olynomials
that
are
in
tegrated
exactly

Denition

The
in
tegration
rule
a
is
exact
to
or
der
q
if
it
is
exact
when
f




is
an
y
p
olynomial
of
degree
q
or
less
When
the
in
tegration
rule
is
exact
to
order
q
and
f





H
q




the
error
E
	
I

n
X
i
W
i
f

i


i

b
satises
an
estimate
of
the
form
E

C
jjf

jj
q


c
Example

Applying

to
a
yields
Q

n
X
i
W
i


i


i
N
i


i
N
T

i


i

detJ
e

i


i

Th
us
the
in
tegrand
at
the
ev
aluation
p
oin
ts
is
summed
relativ
e
to
the
w
eigh
ts
to
ap
pro
ximate
the
giv
en
in
tegral
Problems

A
t
ypical
term
of
an
elemen
t
stiness
or
mass
matrix
has
the
form
Z
Z



i

j
d
d

i
j


Ev
aluate
this
in
tegral
when


is
the
canonical
square





and
the
canonical
righ
t


unit
triangle


OneDimensional
Quadrature


OneDimensional
Gaussian
Quadrature
Although
w
e
are
primarily
in
terested
in
t
w
o
and
threedimensional
quadrature
rules
w
ell
set
the
stage
b
y
studying
onedimensional
in
tegration
Th
us
consider
the
one
dimensional
equiv
alen
t
of

on
the
canonical


elemen
t
I
	
Z


f

d
	
n
X
i
W
i
f

i


E


Most
classical
quadrature
rules
ha
v
e
this
form
F
or
examplethe
trap
ezoidal
rule
I

f


f

has
the
form

with
n
	

W

	
W

	



	


	

and
E
	

f









Similarly

Simpsons
rule
I



f


f


f

has
the
form

with
n
	

W

	
W


	
W

	



	


	



	

and
E
	

f
iv
	


	





Gaussian
quadrature
is
preferred
to
these
NewtonCotes
form
ulas
for
nite
elemen
t
applications
b
ecause
they
ha
v
e
few
er
function
ev
aluations
for
a
giv
en
order
With
Gaus
sian
quadrature
the
w
eigh
ts
and
ev
aluation
p
oin
ts
are
determined
so
that
the
in
tegration
rule
is
exact
E
	

to
as
high
an
order
as
p
ossible
Since
there
are
n
unkno
wn
w
eigh
ts
and
ev
aluation
p
oin
ts
w
e
exp
ect
to
b
e
able
to
mak
e

exact
to
order
n


This
problem
has
b
een
solv
ed



and
the
ev
aluation
p
oin
ts

i

i
	






n
are
the
ro
ots
of
the
Legendre
p
olynomial
of
degree
n
cf
Section

The
w
eigh
ts
W
i

i
	






n
called
Christoel
weights
are
also
kno
wn
and
are
tabulated
with
the
ev
aluation
p
oin
ts
in
T
able

for
n
ranging
from

to

A
more
complete
set
of
v
alues
app
ear
in
Abromo
witz
and
Stegun


Example

The
deriv
ation
of
the
t
w
op
oin
t
n
	

Gauss
quadrature
rule
is
giv
en
as
Problem

at
the
end
of
this
section
F
rom
T
able

w
e
see
that
W

	
W

	

and


	


	

p

Th
us
the
quadrature
rule
is
Z


f

d

f

p


f

p

This
form
ula
is
exact
to
order
three
th
us
the
error
is
prop
ortional
to
the
fourth
deriv
ativ
e
of
f
cf
Theorem

Example

and
Problem

at
the
end
of
this
section


Numerical
In
tegration
n
	
i
W
i









	
	









	
	
	





		







	









	

	



		
	
		

	

	


	
	
	
	
	

	



	
	
	


	
	
T
able

Christoel
w
eigh
ts
W
i
and
ro
ots

i

i
	






n
for
Legendre
p
olynomials
of
degrees

to


Example

Consider
ev
aluating
the
in
tegral
I
	
Z


e
x

dx
	
p


erf

	


b
y
Gauss
quadrature
Let
us
transform
the
in
tegral
to


using
the
mapping

	
x


to
get
I
	


Z


e



	

d

The
t
w
op
oin
t
Gaussian
appro
ximation
is
I


I
	


e


p


	


e


p


	


Other
appro
ximations
follo
w
in
similar
order
Errors
I


I
when
I
is
appro
ximated
b
y
Gaussian
quadrature
to
obtain

I
app
ear
in
T
able

for
n
ranging
from

to

Results
using
the
trap
ezoidal
and
Simpsons
rules
are
also
presen
ted
The
t
w
o
and
threep
oin
t
Gaussian
rules
ha
v
e
higher
orders
than
the
corresp
onding
NewtonCotes
form
ulas
and
this
leads
to
smaller
errors
for
this
example


OneDimensional
Quadrature

n
Gauss
Rules
Newton
Rules
Error
Error

	


	




		








	


T
able

Errors
in
appro
ximating
the
in
tegral
of
Example

b
y
Gauss
quadrature
the
trap
ezoidal
rule
n
	

righ
t
and
Simpsons
rule
n
	

righ
t
Num
b
ers
in
paren
theses
indicate
a
p
o
w
er
of
ten
Example

Comp
osite
in
tegration
form
ulas
where
the
domain
of
in
tegration
a
b
is
divided
in
to
N
subin
terv
als
of
width
x
j
	
x
j

x
j


j
	






N

are
not
needed
in
nite
elemen
t
applications
except
p
erhaps
for
p
ostpro
cessing
Ho
w
ev
er
let
us
do
an
example
to
illustrate
the
con
v
ergence
of
a
Gaussian
quadrature
form
ula
Th
us
consider
I
	
Z
b
a
f
xdx
	
n
X
j

I
j
where
I
j
	
Z
x
j
x
j

f
xdx
The
linear
mapping
x
	
x
j






x
j




transforms
x
j


x
j

to


and
I
j
	
x
j

Z


f
x
j






x
j




d

Appro
ximating
I
j
b
y
Gauss
quadrature
giv
es
I
j

x
j

n
X
i
W
i
f
x
j




i


x
j



i


W
ell
appro
ximate

using
comp
osite
t
w
op
oin
t
Gauss
quadrature
th
us
I
j
	
x
j

e
x
j


x
j

p

		


e
x
j


x
j

p
		




Numerical
In
tegration
where
x
j

	
x
j

x
j


Assuming
a
uniform
partition
with
x
j
	

N

j
	






N

the
comp
osite
t
w
op
oin
t
Gauss
rule
b
ecomes
I


N
n
X
j

e
x
j

N
p
		


e
x
j

N
p
		


The
comp
osite
Simpsons
rule
I


N



N

X
i
e
x
j


N

X
i
e
x
j

e


on
N

subin
terv
als
of
width
x
has
an
adv
an
tage
relativ
e
to
the
comp
osite
Gauss
rule
since
the
function
ev
aluations
at
the
ev
enindexed
p
oin
ts
com
bine
The
n
um
b
er
of
function
ev
aluations
and
errors
when

is
solv
ed
b
y
the
comp
os
ite
t
w
op
oin
t
Gauss
and
Simpsons
rules
are
recorded
in
T
able

W
e
can
see
that
b
oth
quadrature
rules
are
con
v
erging
as
O

N




Chapter

The
computations
w
ere
done
in
single
precision
arithmetic
as
opp
osed
to
those
app
earing
in
T
able

whic
h
w
ere
done
in
double
precision
With
single
precision
roundo
error
dominates
the
computation
as
N
increases
b
ey
ond

and
further
reductions
of
the
error
are
imp
ossible
With
function
ev
aluations
dened
as
the
n
um
b
er
of
times
that
the
exp
onen
tial
is
ev
alu
ated
errors
for
the
same
n
um
b
er
of
function
ev
aluations
are
comparable
for
Gauss
and
Simpsons
rule
quadrature
As
noted
earlier
this
is
due
to
the
com
bination
of
function
ev
aluations
at
the
ends
of
ev
en
subin
terv
als
Discon
tin
uous
solution
deriv
ativ
es
at
in
ter
elemen
t
b
oundaries
w
ould
prev
en
t
suc
h
a
com
bination
with
nite
elemen
t
applications
N
Gauss
Rules
Simpsons
Rule
Fn
Ev
al
Abs
Error
Fn
Ev
al
Abs
Error












	





	









T
able

Comparison
of
comp
osite
t
w
op
oin
t
Gauss
and
Simpsons
rule
appro
xima
tions
for
Example

The
absolute
error
is
the
magnitude
of
the
dierence
b
et
w
een
the
exact
and
computational
result
The
n
um
b
er
of
times
that
the
exp
onen
tial
function
is
ev
aluated
is
used
as
a
measure
of
computational
eort
As
w
e
ma
y
guess
estimates
of
errors
for
Gauss
quadrature
use
the
prop
erties
of
Legendre
p
olynomials
cf
Section

Here
is
a
t
ypical
result


OneDimensional
Quadrature

Theorem

L
et
f



C
n


then
the
quadr
atur
e
rule
	
is
exact
to
or
der
n


if

i

i
	






n
ar
e
the
r
o
ots
of
P
n


the
nth
de
gr
e
e
L
e
gendr
e
p
olynomial
and
the
c
orr
esp
onding
Christoel
weights
satisfy
W
i
	

P

n

i

Z


P
n





i
d

i
	






n
a
A
dditional
ly
ther
e
exists
a
p
oint
	



such
that
E
	
f
n	
	

n
Z


n
Y
i



i


d

b
Pr
o
of
cf

Sections


Example

Using
the
en
tries
in
T
able

and
b
the
discretization
error
of
the
t
w
op
oin
t
n
	

Gauss
quadrature
rule
is
E
	
f
iv
	


Z





p






p



d
	
f
iv
	



	



Problems

Calculate
the
w
eigh
ts
W

and
W

and
the
ev
aluation
p
oin
ts


and


so
that
the
t
w
op
oin
t
Gauss
quadrature
rule
Z


f
x

W

f




W

f



is
exact
to
as
high
an
order
as
p
ossible
This
should
b
e
done
b
y
a
direct
calculation
without
using
the
prop
erties
of
Legendre
p
olynomials

Lac
king
the
precise
information
of
Theorem

w
e
ma
y
infer
that
the
error
in
the
t
w
op
oin
t
Gauss
quadrature
rule
is
prop
ortional
to
the
fourth
deriv
ativ
e
of
f


since
cubic
p
olynomials
are
in
tegrated
exactly

Th
us
E
	
C
f
iv
	

	



W
e
can
determine
the
error
co
ecien
t
C
b
y
ev
aluating
the
form
ula
for
an
y
function
f
x
whose
fourth
deriv
ativ
e
do
es
not
dep
end
on
the
lo
cation
of
the
unkno
wn
p
oin
t
	

In
particular
an
y
quartic
p
olynomial
has
a
constan
t
fourth
deriv
ativ
e
hence
the
v
alue
of
	
is
irrelev
an
t
Select
an
appropriate
quartic
p
olynomial
and
sho
w
that
C
	

as
in
Example



Numerical
In
tegration

MultiDimensional
Quadrature
In
tegration
on
square
elemen
ts
usually
relies
on
tensor
pro
ducts
of
the
onedimensional
form
ulas
illustrated
in
Section

Th
us
the
application
of

to
a
t
w
odimensional
in
tegral
on
a
canonical





square
elemen
t
yields
the
appro
ximation
I
	
Z


Z


f



d
d

Z


n
X
i
W
i
f

i


d
	
n
X
i
W
i
Z


f

i


d
and
I
	
Z


Z


f



d
d

n
X
i
n
X
j

W
i
W
j
f

i


j


Error
estimates
follo
w
the
onedimensional
analysis
T
ensorpro
duct
form
ulas
are
not
optimal
in
the
sense
of
using
the
few
est
function
ev
aluations
for
a
giv
en
order
Exact
in
tegration
of
a
quin
tic
p
olynomial
b
y

w
ould
require
n
	

or
a
total
of
	
p
oin
ts
A
complete
quin
tic
p
olynomial
in
t
w
o
dimensions
has

monomial
terms
th
us
a
direct
nontensorpro
duct
form
ula
of
the
form
I
	
Z


Z


f



d
d

n
X
i
W
i
f

i


i

could
b
e
made
exact
with
only

p
oin
ts
The

co
ecien
ts
W
i


i


i

i
	







could
p
oten
tially
b
e
determined
to
exactly
in
tegrate
all
of
the
monomial
terms
Nontensorpro
duct
form
ulas
are
complicated
to
deriv
e
and
are
not
kno
wn
to
v
ery
high
orders
Orthogonal
p
olynomials
as
describ
ed
in
Section

are
unkno
wn
in
t
w
o
and
three
dimensions
Quadrature
rules
are
generally
deriv
ed
b
y
a
metho
d
of
undetermined
co
ecien
ts
W
ell
illustrate
this
approac
h
b
y
considering
an
in
tegral
on
a
canonical
righ
t


triangle
I
	
Z
Z


f



d
d
	
n
X
i
W
i
f

i


i


E


Example

Consider
the
onep
oin
t
quadrature
rule
Z
Z


f



d
d
	
W

f







E


Since
there
are
three
unkno
wns
W





and



w
e
exp
ect

to
b
e
exact
for
an
y
linear
p
olynomial
In
tegration
is
a
linear
op
erator
hence
it
suces
to
ensure
that

is
exact
for
the
monomials



and


Th
us


MultiDimensional
Quadrature
	

If
f




	

Z


Z


d
d
	


	
W



If
f




	


Z


Z



d
d
	


	
W





If
f




	


Z


Z



d
d
	


	
W




The
solution
of
this
system
is
W

	

and


	


	

th
us
the
onep
oin
t
quadrature
rule
is
Z
Z


f



d
d
	


f








E


As
exp
ected
the
optimal
ev
aluation
p
oin
t
is
the
cen
troid
of
the
triangle
A
b
ound
on
the
error
E
ma
y
b
e
obtained
b
y
expanding
f




in
a
T
a
ylors
series
ab
out
some
con
v
enien
t
p
oin
t









to
obtain
f




	
p






R





a
where
p





	
f
























f






b
and
R





	





















f












c
In
tegrating
a
using

E
	
Z
Z


p






R




d
d



p









R








Since

is
exact
for
linear
p
olynomials
E
	
Z
Z


R




d
d



R








Not
b
eing
to
o
precise
w
e
tak
e
an
absolute
v
alue
of
the
ab
o
v
e
expression
to
obtain
jE
j

Z
Z


jR




jd
d



jR







j


Numerical
In
tegration
F
or
the
canonical
elemen
t
j



j


and
j



j


hence
jR




j


max
j
j
jjD

f
jj

where
jjf
jj

	
max


	

jf



j
Since
the
area
of


is

jE
j


max
j
j
jjD

f
jj



Errors
for
other
quadrature
form
ulas
follo
w
the
same
deriv
ation


Section

Tw
odimensional
in
tegrals
on
triangles
are
con
v
enien
tly
expressed
in
terms
of
trian
gular
co
ordinates
as
Z
Z

e
f
x
y
dxdy
	
A
e
n
X
i
W
i
f
	
i


	
i


	
i



E

where
	
i


	
i


	
i


are
the
triangular
co
ordinates
of
ev
aluation
p
oin
t
i
and
A
e
is
the
area
of
triangle
e
Symmetric
quadrature
form
ulas
for
triangles
ha
v
e
app
eared
in
sev
eral
places
Hammer
et
al

dev
elop
ed
form
ulas
on
triangles
tetrahedra
and
cones
Duna
v
an
t

presen
ts
form
ulas
on
triangles
whic
h
are
exact
to
order

ho
w
ev
er
some
form
ulas
ha
v
e
ev
aluation
p
oin
ts
that
are
outside
of
the
triangle
Sylv
ester

dev
elop
ed
tensorpro
duct
form
ulas
for
triangles
W
e
ha
v
e
listed
some
quadrature
rules
in
T
able

that
also
app
ear
in
Duna
v
an
t

Strang
and
Fix
	
and
Zienkiewicz

A
m
ultiplication
factor
M
indicates
the
n
um
b
er
of
p
erm
utations
asso
ciated
with
an
ev
aluation
p
oin
t
ha
ving
a
w
eigh
t
W
i

The
factor
M
	

is
asso
ciated
with
an
ev
aluation
p
oin
t
at
the
triangles
cen
troid



M
	

indicates
a
p
oin
t
on
a
median
line
and
M
	

indicates
an
arbitrary
p
oin
t
in
the
in
terior
The
factor
p
indicates
the
order
of
the
quadrature
rule
th
us
E
	
O
h
p

where
h
is
the
maxim
um
edge
length
of
the
triangle
Example

Using
the
data
in
T
able

with

the
threep
oin
t
quadrature
rule
on
the
canonical
triangle
is
Z
Z


f



d
d
	


f




f




f




E

The
m
ultiplicativ
e
factor
of

arises
b
ecause
the
area
of
the
canonical
elemen
t
is

and
all
of
the
w
eigh
ts
are

The
quadrature
rule
can
b
e
written
in
terms
of
the
canonical
v
ariables
b
y
setting
	

	

and
	

	

cf

and

The
discretization
error
asso
ciated
with
this
quadrature
rule
is
O
h




MultiDimensional
Quadrature

n
W
i
	
i

	
i


	
i

M
p



























		
		
		

		

	

				
				








		
		



	
		




	
			
		

		

	
		
		
		


				

	


	






		
		
		

	
				
	
	

	
		
	
	

T
able

W
eigh
ts
and
ev
aluation
p
oin
ts
for
in
tegration
on
triangles




Numerical
In
tegration
Quadrature
rules
on
tetrahedra
ha
v
e
the
form
Z
Z
Z

e
f
x
y

z
dxdy
dz
	
V
e
n
X
i
W
i
f
	
i


	
i


	
i


	
i



E

where
V
e
is
the
v
olume
of
Elemen
t
e
and
	
i


	
i


	
i


	
i


are
the
tetrahedral
co
ordinates
of
ev
aluation
p
oin
t
i
Quadrature
rules
are
presen
ted
b
y
Jin
yun

for
metho
ds
to
order
six
and
b
y
Keast

for
metho
ds
to
order
eigh
t
Multiplicativ
e
factors
are
suc
h
that
M
	

for
an
ev
aluation
p
oin
t
at
the
cen
troid




M
	

for
p
oin
ts
on
the
median
line
through
the
cen
troid
and
one
v
ertex
M
	

for
p
oin
ts
on
a
line
b
et
w
een
opp
osite
midsides
M
	

for
p
oin
ts
in
the
plane
con
taining
an
edge
an
and
opp
osite
midside
and
M
	

for
p
oin
ts
in
the
in
terior
Figure

n
W
i
	
i


	

	


	

M
p










			
	

	
	





























	
				
				
	
	


		












		

							
							
							

		


	
	

T
able

W
eigh
ts
and
ev
aluation
p
oin
ts
for
in
tegration
on
tetrahedra




MultiDimensional
Quadrature













































1
2
3
4
P
C
124
12
34
Q
Q
Figure

Some
symmetries
asso
ciated
with
the
tetrahedral
quadrature
rules
of
T
able

An
ev
aluation
p
oin
t
with
M
	

is
at
the
cen
troid
C
one
with
M
	

is
on
a
line
through
a
v
ertex
and
the
cen
troid
eg
line


P


one
with
M
	

is
on
a
line
b
et
w
een
t
w
o
midsides
eg
line
Q


Q


and
one
with
M
	

is
in
a
plane
through
t
w
o
v
ertices
and
an
opp
osite
midside
eg
plane




Q


Problems

Deriv
e
a
threep
oin
t
Gauss
quadrature
rule
on
the
canonical
righ
t


triangle
that
is
accurate
to
order
t
w
o
In
order
to
simplify
the
deriv
ation
use
symmetry
argumen
ts
to
conclude
that
the
three
p
oin
ts
ha
v
e
the
same
w
eigh
t
and
that
they
are
symmetrically
disp
osed
on
the
medians
of
the
triangle
Sho
w
that
there
are
t
w
o
p
ossible
form
ulas
the
one
giv
en
in
T
able

and
another
one
Find
b
oth
form
ulas

Sho
w
that
the
mapping

	


u



	


u

v


transforms
the
in
tegral

from
the
triangle


to
one
on
the
square


u
v


Find
the
resulting
in
tegral
and
sho
w
ho
w
to
appro
ximate
it
using
a
tensorpro
duct
form
ula


Numerical
In
tegration

Bibliograph
y

M
Abromo
witz
and
IA
Stegun
Handb
o
ok
of
Mathematic
al
F
unctions
v
olume

of
Applie
d
Mathematics
Series
National
Bureau
of
Standards
Gathersburg
	

SC
Brenner
and
LR
Scott
The
Mathematic
al
The
ory
of
Finite
Element
Metho
ds
SpringerV
erlag
New
Y
ork
		

RL
Burden
and
JD
F
aires
Numeric
al
A
nalysis
PWSKen
t
Boston
fth
edition
		

DA
Duna
v
an
t
High
degree
ecien
t
symmetrical
Gaussian
quadrature
rules
for
the
triangle
International
Journal
of
Numeric
al
Metho
ds
in
Engine
ering
	
	

P
C
Hammer
OP

Marlo
w
e
and
AH
Stroud
Numerical
in
tegration
o
v
er
simplexes
and
cones
Mathematic
al
T
ables
and
other
A
ids
to
Computation

	

E
Isaacson
and
HB
Keller
A
nalysis
of
Numeric
al
Metho
ds
John
Wiley
and
Sons
New
Y
ork
	

Y
Jin
yun
Symmetric
Gaussian
quadrature
form
ulae
for
tetrahedronal
regions
Computer
Metho
ds
in
Applie
d
Me
chanics
and
Engine
ering
	
	

P

Keast
Mo
deratedegree
tetrahedral
quadrature
form
ulas
Computer
Metho
ds
in
Applie
d
Me
chanics
and
Engine
ering
	
	
	
G
Strang
and
G
Fix
A
nalysis
of
the
Finite
Element
Metho
d
Pren
ticeHall
En
glew
o
o
d
Clis
	

P

Sylv
ester
Symmetric
quadrature
form
ulae
for
simplexes
Mathematics
of
Com
putation
	
	

R
W
ait
and
AR
Mitc
hell
The
Finite
Element
A
nalysis
and
Applic
ations
John
Wiley
and
Sons
Chic
hester
	



Numerical
In
tegration

OC
Zienkiewicz
The
Finite
Element
Metho
d
McGra
wHill
New
Y
ork
third
edition
	

Chapter

Analysis
of
the
Finite
Elemen
t
Metho
d

In
tro
duction
Finite
elemen
t
theory
is
em
b
edded
in
a
v
ery
elegan
t
framew
ork
that
enables
accurate
a
priori
and
a
p
osteriori
estimates
of
discretization
errors
and
con
v
ergence
rates
Unfortu
nately

a
large
p
ortion
of
the
theory
relies
on
a
kno
wledge
of
functional
analysis
whic
h
has
not
b
een
assumed
in
this
material
Instead
w
e
presen
t
the
relev
an
t
concepts
and
k
ey
results
without
pro
of
and
cite
sources
of
a
more
complete
treatmen
t
Once
again
w
e
fo
cus
on
the
mo
del
Galerkin
problem
nd
u

H


satisfying
Av

u

v

f

v

H



a
where
v

f


Z
Z

v
f
dxdy

b
Av

u

Z
Z

pv
x
u
x

v
y
u
y


q
v
udxdy

c
where
the
t
w
odimensional
domain

has
b
oundary





E



N

F
or
simplicit
y

w
e
ha
v
e
assumed
trivial
essen
tial
and
natural
b
oundary
data
on


E
and


N

resp
ectiv
ely

Finite
elemen
t
solutions
U

S
N

of

satisfy
AV

U


V

f

V

S
N



where
S
N

is
a
nitedimensional
subspace
of
H



As
describ
ed
in
Chapter

error
analysis
t
ypically
pro
ceeds
in
t
w
o
steps



Analysis
of
the
Finite
Elemen
t
Metho
d

sho
wing
that
U
is
optimal
in
the
sense
that
the
error
u

U
satises
ku

U
k

min
W
S
N
E
ku

W
k

in
an
appropriate
norm
and

nding
an
upp
er
b
ound
for
the
righ
thand
side
of

The
appropriate
norm
to
use
with

for
the
mo
del
problem

is
the
strain
energy
norm
kv
k
A

p
Av

v


The
nite
elemen
t
solution
migh
t
not
satisfy

with
other
norms
andor
problems
F
or
example
nite
elemen
t
solutions
are
not
optimal
in
an
y
norm
for
nonselfadjoin
t
problems
In
these
cases

is
replaced
b
y
the
w
eak
er
statemen
t
ku

U
k

C
min
W
S
N

ku

W
k

C


Th
us
the
solution
is
nearly
b
est
in
the
sense
that
it
only
diers
b
y
a
constan
t
from
the
b
est
p
ossible
solution
in
the
space
Upp
er
b
ounds
of
the
righ
thand
sides
of

or

are
obtained
b
y
considering
the
error
of
an
in
terp
olan
t
W
of
u
Using
Theorems

and

for
example
w
e
could
conclude
that
ku

W
k
s

C
h
ps
kuk
p

s




if
S
N
consists
of
complete
piecewise
p
olynomials
of
degree
p
with
resp
ect
to
a
sequence
of
uniform
meshes
cf
Denition

and
u

H
p

The
b
ound

can
b
e
com
bined
with
either

or

to
pro
vide
an
estimate
of
the
error
and
con
v
ergence
rate
of
a
nite
elemen
t
solution
The
Sob
olev
norm
on
H

and
the
strain
energy
norm

are
equiv
alen
t
for
the
mo
del
problem

and
w
e
shall
use
this
with

and

to
construct
error
estimates
Prior
to
con
tin
uing
y
ou
ma
y
w
an
t
to
review
Sections


and

A
priori
nite
elemen
t
discretization
errors
obtained
as
describ
ed
do
not
accoun
t
for
suc
h
p
erturbations
as

using
n
umerical
in
tegration

in
terp
olating
Diric
hlet
b
oundary
conditions
b
y
functions
in
S
N

and

appro
ximating


b
y
piecewisep
olynomial
functions


Con
v
ergence
and
Optimalit
y

These
eects
will
ha
v
e
to
b
e
appraised
Additionally

the
a
priori
error
estimates
supply
information
on
con
v
ergence
rates
but
are
dicult
to
use
for
quan
titativ
e
error
infor
mation
A
p
osteriori
error
estimates
whic
h
use
the
computed
solution
pro
vide
more
practical
accuracy
appraisals

Con
v
ergence
and
Optimalit
y
While
k
eeping
the
mo
del
problem

in
mind
w
e
will
pro
ceed
in
a
sligh
tly
more
general
manner
b
y
considering
a
Galerkin
problem
of
the
form
a
with
a
strain
energy
Av

u
that
is
a
symmetric
bilinear
form
cf
Denitions


and
is
also
con
tin
uous
and
co
erciv
e
Denition

A
bilinear
form
Av

u
is
c
ontinuous
in
H
s
if
there
exists
a
constan
t



suc
h
that
jAv

uj


kuk
s
kv
k
s

u
v

H
s


Denition

A
bilinear
form
Au
v

is
c
o
er
cive
H
s

el
l
iptic
or
p
ositive
denite
in
H
s
if
there
exists
a
constan
t



suc
h
that
Au
u


kuk

s

u

H
s


Con
tin
uit
y
and
co
ercivit
y
of
Av

u
can
b
e
used
to
establish
the
existence
and
unique
ness
of
solutions
to
the
Galerkin
problem
a
These
results
follo
w
from
the
Lax
Milgram
Theorem
W
ell
subsequen
tly
pro
v
e
a
p
ortion
of
this
result
but
more
complete
treatmen
ts
app
ear
elsewhere







W
ell
use
examples
to
pro
vide
insigh
t
in
to
the
meanings
of
con
tin
uit
y
and
co
ercivit
y

Example

Consider
the
v
ariational
eigen
v
alue
problem
determine
non
trivial
u

H


and




satisfying
Au
v


u
v

v

H



When
Av

u
is
the
strain
energy
for
the
mo
del
problem

smo
oth
solutions
of
this
v
ariational
problem
also
satisfy
the
dieren
tial
eigen
v
alue
problem
pu
x

x

pu
y

y

q
u

u
x
y



u


x
y




E

u
n


x
y




N

where
n
is
the
unit
out
w
ard
normal
to




Analysis
of
the
Finite
Elemen
t
Metho
d
Letting

r
and
u
r

r


b
e
an
eigen
v
alueeigenfunction
pair
and
using
the
v
ariational
statemen
t
with
v

u

u
r

w
e
obtain
the
R
ayleigh
quotient

r

Au
r

u
r

u
r

u
r


r


Since
this
result
holds
for
all
r

w
e
ha
v
e



min
r

Au
r

u
r

u
r

u
r

where


is
the
minim
um
eigen
v
alue
As
indicated
in
Problem

this
result
can
b
e
extended
Using
the
Ra
yleigh
quotien
t
with

w
e
ha
v
e

r


ku
r
k

s
ku
r
k



r


Since
ku
r
k
s

ku
r
k


w
e
ha
v
e

r




r


Th
us



r

r


and
in
particular





Using

in
conjunction
with
the
Ra
yleigh
quotien
t
implies

r


ku
r
k

s
ku
r
k



r


Com
bining
the
t
w
o
results

ku
r
k

s
ku
r
k




r


ku
r
k

s
ku
r
k



r


Th
us

pro
vides
a
lo
w
er
b
ound
for
the
minim
um
eigen
v
alue
and

pro
vides
a
b
ound
for
the
maxim
um
gro
wth
rate
of
the
eigen
v
alues
in
H
s

Example

Solutions
of
the
Diric
hlet
problem
u
xx

u
y
y

f
x
y

x
y



u


x
y




satisfy
the
Galerkin
problem

with
Av

u

Z
Z

rv

rudxdy

ru

u
x

u
y

T

An
application
of
Cauc
h
ys
inequalit
y
rev
eals
jAv

uj

j
Z
Z

rv

rudxdy
j

krv
k

kruk




Con
v
ergence
and
Optimalit
y

where
kruk



Z
Z

u

x

u

y
dxdy

Since
kruk


kuk


w
e
ha
v
e
jAv

uj

kv
k

kuk


Th
us

is
satised
with
s


and



and
the
strain
energy
is
con
tin
uous
in
H


Establishing
that
Av

u
is
co
erciv
e
in
H

is
t
ypically
done
b
y
using
F
riedric
hss
rst
inequalit
y
whic
h
states
that
there
is
a
constan
t



suc
h
that
kruk




kuk




No
w
consider
the
iden
tit
y
Au
u

kruk



	kruk



	kruk


and
use

to
obtain
Au
u

	kruk



	
kuk




kuk


where


	
max



Th
us

is
satised
with
s


and
Au
v

is
co
erciv
e
H

elliptic
Con
tin
uit
y
and
co
ercivit
y
of
the
strain
energy
rev
eal
the
nite
elemen
t
solution
U
to
b
e
nearly
the
b
est
appro
ximation
in
S
N
Theorem

L
et
Av

u
b
e
symmetric
c
ontinuous
and
c
o
er
cive
L
et
u

H


satisfy
a
and
U

S
N

	
H


satisfy

Then
ku

U
k




ku

V
k


V

S
N


a
with

and

satisfying

and

R
emark

Equation
a
ma
y
also
b
e
expressed
as
ku

U
k


C
inf
V
S
N

ku

V
k


b
Th
us
con
tin
uit
y
and
H

ellipticit
y
giv
e
us
a
b
ound
of
the
form

Pr
o
of
cf
Problem

at
the
end
of
this
section
The
b
ound

can
b
e
impro
v
ed
when
Av

u
has
the
form
c


Analysis
of
the
Finite
Elemen
t
Metho
d
Theorem

let
Av

u
b
e
a
symmetric
c
ontinuous
and
c
o
er
cive
biline
ar
form	
u

H


minimize
I
w


Aw

w


w

f

w

H




and
S
N

b
e
a
nite
dimensional
subsp
ac
e
of
H



Then

The
minimum
of
I
W

and
Au

W

u

W

W

S
N


ar
e
achieve
d
by
the
same
function
U


The
function
U
is
the
ortho
gonal
pr
oje
ction
of
u
onto
S
N

with
r
esp
e
ct
to
str
ain
ener
gy
ie
AV

u

U



V

S
N




The
minimizing
function
U

S
N

satises
the
Galerkin
pr
oblem
AV

U


V

f

V

S
N



In
p
articular
if
S
N

is
the
whole
of
H


Av

u

v

f

v

H




Pr
o
of
Our
pro
of
will
omit
sev
eral
tec
hnical
details
whic
h
app
ear
in
eg
W
ait
and
Mitc
hell

Chapter

Let
us
b
egin
with

If
U
minimizes
I
W

o
v
er
S
N

then
for
an
y

and
an
y
V

S
N

I
U


I
U


V

Using

I
U


AU


V

U


V


U


V

f

or
I
U


I
U



AV

U


V

f




AV

V

or



AV

U


V

f




AV

V

This
inequalit
y
m
ust
hold
for
all
p
ossible

of
either
sign
th
us

m
ust
b
e
satised
Equation

follo
ws
b
y
rep
eating
these
argumen
ts
with
S
N

replaced
b
y
H



Next
replace
v
in

b
y
V

S
N

	
H


and
subtract

to
obtain

In
order
to
pro
v
e
Conclusion

consider
the
iden
tit
y
Au

U

V

u

U

V


Au

U
u

U


Au

U
V


AV

V



Con
v
ergence
and
Optimalit
y

Using

Au

U
u

U


Au

U

V

u

U

V


AV

V

Since
AV

V



Au

U
u

U


Au

U

V

u

U

V

V

S
N


Equalit
y
only
o
ccurs
when
V


therefore
U
is
the
unique
minimizing
function
R
emark

W
e
pro
v
ed
a
similar
result
for
onedimensional
problems
in
Theorems


R
emark

Con
tin
uit
y
and
co
ercivit
y
did
not
app
ear
in
the
pro
of
ho
w
ev
er
they
are
needed
to
establish
existence
uniqueness
and
completeness
Th
us
w
e
nev
er
pro
v
ed
that
lim
N

U

u
A
complete
analysis
app
ears
in
W
ait
and
Mitc
hell

Chapter

R
emark

The
strain
energy
Av

u
not
need
b
e
symmetric
A
pro
of
without
this
restriction
app
ears
in
Ciarlet


Corollary

With
the
assumptions
of
The
or
em

Au

U
u

U


Au
u

AU
U

	
Pr
o
of
cf
Problem

at
the
end
of
this
section
In
Section

w
e
obtained
a
priori
estimates
of
in
terp
olation
errors
under
some
mesh
uniformit
y
assumptions
Recall
cf
Denition

that
w
e
considered
a
family
of
nite
elemen
t
meshes

h
whic
h
b
ecame
ner
as
h


The
uniformit
y
condition
implied
that
all
v
ertex
angles
w
ere
b
ounded
a
w
a
y
from

and

and
that
all
asp
ect
ratios
w
ere
b
ounded
a
w
a
y
from

as
h


Uniformit
y
ensured
that
transformations
from
the
ph
ysical
to
the
computational
space
w
ere
w
ell
b
eha
v
ed
Th
us
with
uniform
meshes
w
e
w
ere
able
to
sho
w
cf
Theorem

that
the
error
in
in
terp
olating
a
function
u

H
p
b
y
a
complete
p
olynomial
W
of
degree
p
satises
ku

W
k
s

C
h
ps
kuk
p

s



a
The
norm
on
the
righ
t
can
b
e
replaced
b
y
the
seminorm
juj

p

X
j
jp
kD

uk


b
to
pro
duce
a
more
precise
estimate
but
this
will
not
b
e
necessary
for
our
presen
t
appli
cation
If
singularities
are
presen
t
so
that
u

H
q

with
q

p
then
instead
of
a
w
e
nd
ku

W
k


C
h
q
kuk
q


c


Analysis
of
the
Finite
Elemen
t
Metho
d
With
optimalit
y
or
near
optimalit
y
established
and
in
terp
olation
error
estimates
a
v
ailable
w
e
can
establish
con
v
ergence
of
the
nite
elemen
t
metho
d
Theorem

Supp
ose

u

H


and
U

S
N

	
H


satisfy

and

r
esp
e
ctively

Av

u
is
a
symmetric
c
ontinuous
and
H


el
liptic
biline
ar
form	

S
N

c
onsists
of
c
omplete
pie
c
ewise
p
olynomial
functions
of
de
gr
e
e
p
with
r
esp
e
ct
to
a
uniform
family
of
meshes

h
	
and

u

H



H
p

Then
ku

U
k


C
h
p
kuk
p
a
and
Au

U
u

U


C
h
p
kuk

p

b
Pr
o
of
F
rom
Theorem

Au

U
u

U


inf
V
S
N

Au

V

u

V


Au

W

u

W

where
W
is
an
in
terp
olan
t
of
u
Using

with
s


and
v
and
u
replaced
b
y
u

W
yields
Au

W

u

W



ku

W
k



Using
the
in
terp
olation
estimate
a
with
s


yields
b
In
order
to
pro
v
e
a
use

with
s


to
obtain

ku

U
k



Au

U
u

U

The
use
of
b
and
a
division
b
y

yields
a
Since
the
H

norm
dominates
the
L

norm
a
trivially
giv
es
us
an
error
esti
mate
in
L

as
ku

U
k


C
h
p
kuk
p

This
estimate
do
es
not
ha
v
e
an
optimal
rate
since
the
in
terp
olation
error
a
is
con
v
erging
as
O
h
p

Getting
the
correct
rate
for
an
L

error
estimate
is
more
complicated
than
it
is
in
H


The
pro
of
is
divided
in
to
t
w
o
parts


Con
v
ergence
and
Optimalit
y
	
Lemma

A
ubin
Nitsche
Under
the
assumptions
of
The
or
em

let

x
y


H


b
e
the
solution
of
the
dual
pr
oblem
Av




v

e
v

H



a
wher
e
e

u

U
ku

U
k


b
L
et


S
N

b
e
an
interp
olant
of


then
ku

U
k



ku

U
k

k

k


c
Pr
o
of
Set
V


in

to
obtain
A
u

U




T
ak
e
the
L

inner
pro
duct
of
b
with
u

U
to
obtain
ku

U
k


e
u

U

Setting
v

u

U
in
a
and
using
the
ab
o
v
e
relation
yields
ku

U
k


Au

U


Using

ku

U
k


Au

U



No
w
use
the
con
tin
uit
y
of
Av

u
in
H


with
s


to
obtain
c
Since
w
e
ha
v
e
an
estimate
for
ku

U
k


estimating
ku

U
k

b
y
c
requires
an
estimate
of
k

k


This
of
course
will
b
e
done
b
y
in
terp
olation
ho
w
ev
er
use
of
a
requires
kno
wledge
of
the
smo
othness
of


The
follo
wing
lemma
pro
vides
the
necessary
a
priori
b
ound
Lemma

L
et
Au
v

b
e
a
symmetric
H


el
liptic
biline
ar
form
and
u
b
e
the
solu
tion
of

on
a
smo
oth
r
e
gion

Then
kuk


C
kf
k



R
emark

This
result
seems
plausible
since
the
underlying
dieren
tial
equation
is
of
second
order
so
the
second
deriv
ativ
es
should
ha
v
e
the
same
smo
othness
as
the
righ
t
hand
side
f

The
estimate
migh
t
in
v
olv
e
b
oundary
data
ho
w
ev
er
w
e
ha
v
e
assumed
trivial
conditions
Lets
further
assume
that


E
is
not
nil
to
a
v
oid
nonuniqueness
issues


Analysis
of
the
Finite
Elemen
t
Metho
d
Pr
o
of
Strang
and
Fix


Chapter

establish

in
one
dimension
Johnson

Chapter

obtain
a
similar
result
With
preliminaries
complete
here
is
the
main
result
Theorem

Given
the
assumptions
of
The
or
em

then
ku

U
k


C
h
p
kuk
p


Pr
o
of
Applying

to
the
dual
problem
a
yields
k
k


C
kek


C

since
kek



according
to
b
With


H


w
e
ma
y
use
c
with
q

s


to
obtain
k

k


C
hk
k


C
h
Com
bining
this
estimate
with
a
and
c
yields

Problems

Sho
w
that
the
function
u
that
minimizes


min
w
H



kw
k


Aw

w

w

w

is
u


the
eigenfunction
corresp
onding
to
the
minim
um
eigen
v
alue


of
Av

u

v

u

Assume
that
Av

u
is
a
symmetric
con
tin
uous
and
H

elliptic
bilinear
form
and
for
simplicit
y

that
u
v

H




Sho
w
that
the
strain
energy
and
H

norms
are
equiv
alen
t
in
the
sense
that

kuk



Au
u


kuk



u

H



where

and

satisfy

and


Pro
v
e
Theorem


Pro
v
e
Corollary

to
Theorem


P
erturbations
In
this
section
w
e
examine
the
eects
of
p
erturbations
due
to
n
umerical
in
tegration
in
terp
olated
b
oundary
conditions
and
curv
ed
b
oundaries


P
erturbations


Quadrature
P
erturbations
With
n
umerical
in
tegration
w
e
determine
U

as
the
solution
of
A

V

U



V

f



V

S
N


a
instead
of
determining
U
b
y
solving

The
appro
ximate
strain
energy
A

V

U

or
L

inner
pro
duct
V

f


re ect
the
n
umerical
in
tegration
that
has
b
een
used
F
or
example
consider
the
loading
V

f


N

X
e
V

f

e

V

f

e

Z
Z

e
V
x
y
f
x
y
dxdy
where

e
is
the
domain
o
ccupied
b
y
elemen
t
e
in
a
mesh
of
N

elemen
ts
Using
an
np
oin
t
quadrature
rule
cf
a
on
elemen
t
e
w
e
w
ould
appro
ximate
V

f

b
y
V

f



N

X
e
V

f

e
b
where
V

f

e

n
X
k

W
k
V
x
k

y
k
f
x
k

y
k

c
The
eects
of
transformations
to
a
canonical
elemen
t
ha
v
e
not
b
een
sho
wn
for
simplicit
y
and
a
similar
form
ula
applies
for
A

V

U

Deriving
an
estimate
for
the
p
erturbation
in
tro
duced
b
y
a
is
relativ
ely
simple
if
AV

U

and
A

V

U

are
con
tin
uous
and
co
erciv
e
Theorem

Supp
ose
that
Av

u
and
A

V

U

ar
e
biline
ar
forms
with
A
b
eing
c
ontinuous
and
A

b
eing
c
o
er
cive
in
H

	
thus
ther
e
exists
c
onstants

and

such
that
jAu
v
j


kuk

kv
k


u
v

H



a
and
A

U
U



kU
k



U

S
N


b
Then
ku

U

k


C
fku

V
k


sup
W
S
N

jAV

W


A

V

W
j
kW
k


sup
W
S
N

jW

f


W

f


j
kW
k

g
V

S
N





Analysis
of
the
Finite
Elemen
t
Metho
d
Pr
o
of
Using
the
triangular
inequalit
y
ku

U

k


ku

V

V

U

k


ku

V
k


kW
k

a
where
W

U


V

b
Using
b
and
b

kW
k



A

U


V

W


A

U


W


A

V

W

Using
a
with
V
replaced
b
y
W
to
eliminate
A

U


W

w
e
get

kW
k



f

W



A

V

W

Adding
the
exact
Galerkin
equation

with
v
replaced
b
y
W

kW
k



f

W



f

W


Au
W


A

V

W

Adding
and
subtracting
AV

W

and
taking
an
absolute
v
alue

kW
k



jf

W



f

W
j

jAu

V

W
j

jAV

W


A

V

W
j
No
w
using
the
con
tin
uit
y
condition
a
with
u
replaced
b
y
u

V
and
v
replaced
b
y
W

w
e
obtain

kW
k



jf

W



f

W
j


ku

V
k

kW
k


jAV

W


A

V

W
j
Dividing
b
y

kW
k

kW
k




f
ku

V
k


jf

W



f

W
j
kW
k


jAV

W


A

V

W
j
kW
k

g
Com
bining
the
ab
o
v
e
inequalit
y
with
a
maximizing
the
inner
pro
duct
ratios
o
v
er
W

and
c
ho
osing
C
as
the
larger
of



	
or
	
yields

R
emark

Since
the
error
estimate

is
v
alid
for
all
V

S
N

it
can
b
e
written
in
the
form
ku

U

k


C
inf
V
S
N

fku

V
k


sup
W
S
N

jAV

W


A

V

W
j
kW
k


sup
W
S
N

jW

f


W

f


j
kW
k

g

T
o
b
ound

or

in
terms
of
a
mesh
parameter
h
w
e
use
standard
in
terp
ola
tion
error
estimates
cf
Sections

and

for
the
rst
term
and
n
umerical
in
tegration
error
estimates
cf
Chapter

for
the
latter
t
w
o
terms
Estimating
quadrature
errors
is
relativ
ely
easy
and
the
follo
wing
t
ypical
result
includes
the
eects
of
transforming
to
a
canonical
elemen
t


P
erturbations

Theorem

L
et
J



b
e
the
Jac
obian
of
a
tr
ansformation
fr
om
a
c
omputational




plane
to
a
physic
al
x
y

plane
and
let
W

S
N


R
elative
to
a
uniform
family
of
meshes

h

supp
ose
that
det
J


W
x




and
detJ


W
y




ar
e
pie
c
ewise
p
olynomials
of
de
gr
e
e
at
most
r

and
det
J


W




is
a
pie
c
ewise
p
olynomial
of
de
gr
e
e
at
most
r


Then

If
a
quadr
atur
e
rule
is
exact
in
the
c
omputational
plane
for
al
l
p
olynomials
of
de
gr
e
e
at
most
r


r

jAV

W


A

V

W
j
kW
k


C
h
r

kV
k
r


V

W

S
N


a

If
a
quadr
atur
e
rule
is
exact
for
al
l
p
olynomials
of
de
gr
e
e
at
most
r


r


jf

W


f

W


j
kW
k


C
h
r

kf
k
r


W

S
N


b
Pr
o
of
cf
W
ait
and
Mitc
hell


Chapter

or
Strang
and
Fix

Chapter

Example

Supp
ose
that
the
co
ordinate
transformation
is
linear
so
that
detJ



is
constan
t
and
that
S
N

consists
of
piecewise
p
olynomials
of
degree
at
most
p
In
this
case
r


p


and
r


p
The
in
terp
olation
error
in
H

is
ku

V
k


O
h
p

Supp
ose
that
the
quadrature
rule
is
exact
for
p
olynomials
of
degree

or
less
Th
us


r


r
or
r



p


and
a
implies
that
jAV

W


A

V

W
j
kW
k


C
h
p
kV
k
p

V

W

S
N


With


r


r


and
r


p
w
e
again
nd
r



p


and
using
b
jf

W


f

W


j
kW
k


C
h
p
kf
k
p

W

S
N



If


p


so
that
r

p


then
the
ab
o
v
e
p
erturbation
errors
are
O
h
p

Hence
all
terms
in

or

ha
v
e
the
same
order
of
accuracy
and
w
e
conclude
that
ku

U

k


O
h
p

This
situation
is
regarded
as
optimal
If
the
co
ecien
ts
of
the
dieren
tial
equation
are
constan
t
and
as
is
the
case
here
the
Jacobian
is
constan
t
this
result
is
equiv
alen
t
to
in
tegrating
the
dieren
tiated
terms
in
the
strain
energy
exactly
cf
eg
c


Analysis
of
the
Finite
Elemen
t
Metho
d

If


p


so
that
r

p


then
the
error
in
in
tegration
is
higher
order
than
the
O
h
p

in
terp
olation
error
ho
w
ev
er
the
in
terp
olation
error
dominates
and
ku

U

k


O
h
p

The
extra
eort
in
p
erforming
the
n
umerical
in
tegration
more
accurately
is
not
justied

If


p


so
that
r

p


then
the
in
tegration
error
dominates
the
in
terp
o
lation
error
and
determines
the
order
of
accuracy
as
ku

U

k


O
h
p

In
particular
con
v
ergence
do
es
not
o
ccur
if


p


Let
us
conclude
this
example
b
y
examining
con
v
ergence
rates
for
piecewiselinear
or
bilinear
appro
ximations
p


In
this
case
r



r



and
r


In
terp
olation
errors
con
v
erge
as
O
h
The
optimal
order
of
accuracy
of
the
quadrature
rule
is



ie
only
constan
t
functions
need
b
e
in
tegrated
exactly

P
erforming
the
in
tegration
more
accurately
yields
no
impro
v
emen
t
in
the
con
v
ergence
rate
Example

Problems
with
v
ariable
Jacobians
are
more
complicated
Consider
the
term
det
J


W
x





J
W


x

W


x

where
J

det
J



The
metrics

x
and

x
are
obtained
from
the
in
v
erse
Jacobian
J




x

y

x

y



J

y

x

y

x



In
particular

x

y

	J
and

x

y

	J
and
detJW
x

W

y


W

y


Consider
an
isoparametric
transformation
of
degree
p
Suc
h
triangles
or
quadrilaterals
in
the
computational
plane
ha
v
e
curv
ed
sides
of
piecewise
p
olynomials
of
degree
p
in
the
ph
ysical
plane
If
W
is
a
p
olynomial
of
degree
p
then
W
x
has
degree
p


Lik
ewise
x
and
y
are
p
olynomials
of
degree
p
in

and


Th
us
y

and
y

also
ha
v
e
degrees
p


Therefore
J
W
x
and
similarly

J
W
y
ha
v
e
degrees
r


p


With
J
b
eing
a
p
olynomial
of
degree
p


w
e
nd
J
W
to
b
e
of
degree
r


p


F
or
the
quadrature
errors

to
ha
v
e
the
same
O
h
p

rate
as
the
in
terp
olation
error
w
e
m
ust
ha
v
e
r

p


in
ab
Th
us
according
to
Theorem

the
order

of
the
quadrature
rules
in
the



plane
should
b
e


r


r

p



p



p




P
erturbations

for
a
and


r


r



p



p





p


for
b
These
results
are
to
b
e
compared
with
the
order
of
p


that
w
as
needed
with
the
piecewise
p
olynomials
of
degree
p
and
linear
transformations
considered
in
Example

F
or
quadratic
transformations
and
appro
ximations
p


w
e
need
third
and
fourthorder
quadrature
rules
for
O
h


accuracy


In
terp
olated
Boundary
Conditions
Assume
that
in
tegration
is
exact
and
the
b
oundary


is
mo
deled
exactly

but
Diric
hlet
b
oundary
data
is
appro
ximated
b
y
a
piecewise
p
olynomial
in
S
N

ie
b
y
a
p
olynomial
ha
ving
the
same
degree
p
as
the
trial
and
test
functions
Under
these
conditions
W
ait
and
Mitc
hell

Chapter

sho
w
that
the
error
in
the
solution
U
of
a
Galerkin
problem
with
in
terp
olated
b
oundary
conditions
satises
ku

U
k


C
fh
p
kuk
p

h
p
kuk
p
g

The
rst
term
on
the
righ
t
is
the
standard
in
terp
olation
error
estimate
The
second
term
corresp
onds
to
the
p
erturbation
due
to
appro
ximating
the
b
oundary
condition
As
usual
computation
is
done
on
a
uniform
family
of
meshes

h
and
u
is
smo
oth
enough
to
b
e
in
H
p

Brenner
and
Scott

Chapter

obtain
similar
results
under
similar
conditions
when
in
terp
olation
is
p
erformed
at
the
Lobatto
p
oin
ts
on
the
b
oundary
of
an
elemen
t
The
Lobatto
p
olynomial
of
degree
p
is
dened
on


as
L
p



d
p
d
p





p





p


These
results
are
encouraging
since
the
p
erturbation
in
the
b
oundary
data
is
of
sligh
tly
higher
order
than
the
in
terp
olation
error
Unfortunately

if
the
domain

is
not
smo
oth
and
eg
con
tains
corners
solutions
will
not
b
e
elemen
ts
of
H
p

Less
is
kno
wn
in
these
cases

P
erturb
ed
Boundaries
Supp
ose
that
the
domain

is
replaced
b
y
a
p
olygonal
domain
!

as
sho
wn
in
Figure

Strang
and
Fix


analyze
secondorder
problems
with
homogeneous
Diric
hlet
data
of
the
form
determine
u

H


satisfying
Av

u

v

f

v

H



a


Analysis
of
the
Finite
Elemen
t
Metho
d
where
functions
in
H


satisfy
ux
y



x
y




The
nite
elemen
t
solution
U

!
S
N

satises
AV

U


V

f

V

!
S
N


b
where
functions
in
!
S
N

v
anish
on

!


Th
us
!
S
N

is
not
a
subspace
of
H



Figure

Appro
ximation
of
a
curv
ed
b
oundary
b
y
a
p
olygon
F
or
piecewise
linear
p
olynomial
appro
ximations
on
triangles
they
sho
w
that
ku

U
k


O
h
and
for
piecewise
quadratic
appro
ximations
ku

U
k


O
h

	
The
p
o
or
accuracy
with
quadratic
p
olynomials
is
due
to
large
errors
in
a
narro
w
b
oundary
la
y
er
near


Large
errors
are
conned
to
the
b
oundary
la
y
er
and
results
are
acceptable
elsewhere
W
ait
and
Mitc
hell


Chapter

quote
other
results
whic
h
pro
v
e
that
ku

U
k


O
h
p

for
pth
degree
piecewise
p
olynomial
appro
ximations
when
the
distance
b
et
w
een


and

!

is
O
h
p

Suc
h
is
the
case
when


is
appro
ximated
b
y
p
th
degree
piecewisep
olynomial
in
terp
olation

A
P
osteriori
Error
Estimation
In
previous
sections
of
this
c
hapter
w
e
considered
a
priori
err
or
estimates
Th
us
w
e
can
without
computation
infer
that
nite
elemen
t
solutions
con
v
erge
at
a
certain
rate
dep
ending
on
the
exact
solutions
smo
othness
Error
b
ounds
are
expressed
in
terms
of
unkno
wn
constan
ts
whic
h
are
dicult
if
not
imp
ossible
to
estimate
Ha
ving
computed
a
nite
elemen
t
solution
it
is
p
ossible
to
obtain
a
p
osteriori
err
or
estimates
whic
h
giv
e
more
quan
titativ
e
information
ab
out
the
accuracy
of
the
solution
Man
y
error
estimation
tec
hniques
are
a
v
ailable
and
b
efore
discussing
an
y

lets
list
some
prop
erties
that
a
go
o
d
a
p
osteriori
error
estimation
pro
cedure
should
p
ossess

The
error
estimate
should
giv
e
an
accurate
measure
of
the
discretization
error
for
a
wide
range
of
mesh
spacings
and
p
olynomial
degrees


A
P
osteriori
Error
Estimation


The
pro
cedure
should
b
e
inexp
ensiv
e
relativ
e
to
the
cost
of
obtaining
the
nite
elemen
t
solution
This
usually
means
that
error
estimates
should
b
e
calculated
using
only
lo
cal
computations
whic
h
t
ypically
require
an
eort
comparable
to
the
cost
of
generating
the
stiness
matrix

A
tec
hnique
that
pro
vides
estimates
of
p
oin
t
wise
errors
whic
h
can
subsequen
tly
b
e
used
to
calculate
error
measures
in
sev
eral
norms
is
preferable
to
one
that
only
w
orks
in
a
sp
ecic
norm
P
oin
t
wise
error
estimates
and
error
estimates
in
lo
cal
elemen
tal
norms
ma
y
also
pro
vide
an
indications
as
to
where
solution
accuracy
is
insucien
t
and
where
renemen
t
is
needed
A
p
osteriori
error
estimates
can
roughly
b
e
divided
in
to
four
categories

R
esidual
err
or
estimates
Lo
cal
nite
elemen
t
problems
are
created
on
either
an
elemen
t
or
a
sub
domain
and
solv
ed
for
the
error
estimate
The
data
dep
ends
on
the
residual
of
the
nite
elemen
t
solution

Flux
pr
oje
ction
err
or
estimates
A
new
 ux
is
calculated
b
y
p
ost
pro
cessing
the
nite
elemen
t
solution
This
 ux
is
smo
other
than
the
original
nite
elemen
t
 ux
and
an
error
estimate
is
obtained
from
the
dierence
of
the
t
w
o
 uxes

Extr
ap
olation
err
or
estimates
Tw
o
nite
elemen
t
solutions
ha
ving
dieren
t
orders
or
dieren
t
meshes
are
compared
and
their
dierences
used
to
pro
vide
an
error
estimate

Interp
olation
err
or
estimates
In
terp
olation
error
b
ounds
are
used
with
estimates
of
the
unkno
wn
constan
ts
The
four
tec
hniques
are
not
indep
enden
t
but
ha
v
e
man
y
similarities
Surv
eys
of
error
es
timation
pro
cedures



describ
e
man
y
of
their
prop
erties
similarities
and
dierences
Let
us
set
the
stage
b
y
brie y
describing
t
w
o
simple
extrap
olation
tec
hniques
Consider
a
onedimensional
problem
for
simplicit
y
and
supp
ose
that
an
appro
ximate
solution
U
p
h
x
has
b
een
computed
using
a
p
olynomial
appro
ximation
of
degree
p
on
a
mesh
of
spacing
h
Figure

Supp
ose
that
w
e
ha
v
e
an
a
priori
in
terp
olation
error
estimate
of
the
form
ux

U
p
h
x

C
p
h
p

O
h
p

W
e
ha
v
e
assumed
that
the
exact
solution
ux
is
smo
oth
enough
for
the
error
to
b
e
expanded
in
h
to
O
h
p

The
leading
error
constan
t
C
p
generally
dep
ends
on
un
kno
wn
deriv
ativ
es
of
u
No
w
compute
a
second
solution
with
spacing
h	
Figure

to
obtain
ux

U
p
h
x

C
p

h


p

O
h
p



Analysis
of
the
Finite
Elemen
t
Metho
d
x
Uh
1
h
Uh/2
1
Uh
2
Figure

Solutions
U

h
and
U

h
computed
on
meshes
ha
ving
spacing
h
and
h	
with
piecewise
linear
p
olynomials
p


and
a
third
solution
U

h
computed
on
a
mesh
of
spacing
h
with
a
piecewise
quadratic
p
olynomial
p


Subtracting
the
t
w
o
solutions
w
e
eliminate
the
unkno
wn
exact
solution
and
obtain
U
p
h
x

U
p
h
x

C
p
h
p




p




O
h
p

Neglecting
the
higherorder
terms
w
e
obtain
an
appro
ximation
of
the
discretization
error
as
C
p
h
p

U
p
h
x

U
p
h
x


	
p

Th
us
w
e
ha
v
e
an
estimate
of
the
discretization
error
of
the
coarsemesh
solution
as
ux

U
p
h
x

U
p
h
x

U
p
h
x


	
p

The
tec
hnique
is
called
R
ichar
dson
s
extr
ap
olation
or
h
extr
ap
olation
It
can
also
b
e
used
to
obtain
error
estimates
of
the
nemesh
solution
The
cost
of
obtaining
the
error
estimate
is
appro
ximately
t
wice
the
cost
of
obtaining
the
solution
In
t
w
o
and
three
dimensions
the
cost
factors
rise
to
resp
ectiv
ely

four
and
eigh
t
times
the
solution
cost
Most
w
ould
consider
this
to
b
e
excessiv
e
The
only
w
a
y
of
justifying
the
pro
cedure
is
to
consider
the
nemesh
solution
as
b
eing
the
result
and
the
coarsemesh
solution
as
furnishing
the
error
estimate
This
strategy
only
furnishes
an
error
estimate
on
the
coarse
mesh
Another
strategy
for
obtaining
an
error
estimate
b
y
extrap
olation
is
to
compute
a
second
solution
using
a
higherorder
metho
d
Figure

eg
ux

U
p
h

C
p
h
p

O
h
p

No
w
use
the
iden
tit
y
ux

U
p
h
x

ux

U
p
h
x

U
p
h
x

U
p
h



A
P
osteriori
Error
Estimation
	
The
rst
term
on
the
righ
t
is
the
O
h
p

error
of
the
higherorder
solution
and
hence
can
b
e
neglected
relativ
e
to
the
second
term
Th
us
w
e
obtain
the
appro
ximation
ux

U
p
h
x

U
p
h
x

U
p
h
x
The
dierence
b
et
w
een
the
lo
w
er
and
higherorder
solutions
furnish
an
estimate
of
the
er
ror
of
the
lo
w
erorder
solution
The
tec
hnique
is
called
or
der
emb
e
dding
or
p
extr
ap
olation
There
is
no
error
estimate
for
the
higherorder
solution
but
some
use
it
without
an
error
estimate
This
strategy

called
lo
c
al
extr
ap
olation
can
b
e
dangerous
near
singularities
Unless
there
are
sp
ecial
prop
erties
of
the
sc
heme
that
can
b
e
exploited
the
w
ork
in
v
olv
ed
in
obtaining
the
error
estimate
is
comparable
to
the
w
ork
of
obtaining
the
solu
tion
With
a
hierarc
hical
em
b
edding
computations
needed
for
the
lo
w
erorder
metho
d
are
also
needed
for
the
higherorder
metho
d
and
hence
need
not
b
e
rep
eated
The
extrap
olation
tec
hniques
just
describ
ed
are
t
ypically
to
o
exp
ensiv
e
for
use
as
error
estimates
W
ell
dev
elop
a
residualbased
error
estimation
pro
cedure
that
follo
ws
Bank
cf

Chapter

and
uses
man
y
of
the
ideas
found
in
order
em
b
edding
W
ell
follo
w
our
usual
course
of
presen
ting
results
for
the
mo
del
problem
r

pru

q
u

pu
x

x

pu
y

y

q
u

f
x
y

x
y



a
ux
y




x
y




E

pu
n
x
y




x
y




N

b
ho
w
ev
er
results
apply
more
generally

Of
course
the
Galerkin
form
of

is
deter
mine
u

H

E
suc
h
that
Av

u

v

f


v



v

H



a
where
v

f


Z
Z

v
f
dxdy

b
Av

u

Z
Z

prv

ru

q
v
udxdy

c
and

v

u

Z


N
v
uds
d
Similarly

the
nite
elemen
t
solution
U

S
N
E
	
H

E
satises
AV

U


V

f


V



V

S
N





Analysis
of
the
Finite
Elemen
t
Metho
d
W
e
seek
an
error
estimation
tec
hnique
that
only
requires
lo
cal
elemen
t
lev
el
mesh
computations
so
lets
construct
a
lo
cal
Galerkin
problem
on
elemen
t
e
b
y
in
tegrating
a
o
v
er

e
and
applying
the
div
ergence
theorem
to
obtain
determine
u

H


e

suc
h
that
A
e
v

u

v

f

e


v

pu
n

e

v

H


e

a
where
v

f

e

Z
Z

e
v
f
dxdy

b
A
e
v

u

Z
Z

e
prv

ru

q
v
udxdy

c
and

v

u

e

Z


e
v
uds
d
As
usual

e
is
the
domain
of
elemen
t
e
s
is
a
co
ordinate
along


e

and
n
is
a
unit
out
w
ard
normal
to


e

Let
u

U

e

where
ex
y

is
the
discretization
error
of
the
nite
elemen
t
solution
and
substitute

in
to
a
to
obtain
A
e
v

e

v

f

e

A
e
v

U


v

pu
n

e

v

H


e


Equation

of
course
cannot
b
e
solv
ed
b
ecause
i
v

u
and
e
are
elemen
ts
of
an
innitedimensional
space
and
ii
the
 ux
pu
n
is
unkno
wn
on


e

W
e
could
obtain
a
nite
elemen
t
solution
of

b
y
appro
ximating
e
and
v
b
y
E
and
V
in
a
nite
dimensional
subspace
!
S
N

e

of
H


e

Th
us
A
e
V

E


V

f

e

A
e
V

U


V

pu
n

e

V

!
S
N

e


W
e
will
discuss
selection
of
!
S
N
momen
tarily

Let
us
rst
prescrib
e
the
 ux
pu
n
app
earing
in
the
last
term
of

The
simplest
p
ossibilit
y
is
to
use
an
a
v
erage
 ux
obtained
from
pU
n
across
the
elemen
t
b
oundary

ie
A
e
V

E


V

f

e

A
e
V

U


V

pU
n



pU
n




e

V

!
S
N

e




A
P
osteriori
Error
Estimation

where
sup
erscripts

and

resp
ectiv
ely

denote
v
alues
of
pU
n
on
the
exterior
and
in
terior
of


e

Equation

is
a
lo
cal
Neumann
problem
for
determining
the
error
appro
ximation
E
on
eac
h
elemen
t
No
assem
bly
and
global
solution
is
in
v
olv
ed
Some
in
v
estigators
prefer
to
apply
the
div
ergence
theorem
to
the
second
term
on
the
righ
t
to
obtain
A
e
V

E


V

r

e


V

pU
n



e


V

pU
n



pU
n




e
or
A
e
V

E


V

r

e


V

pU
n



pU
n




e
	a
where
r
x
y


f

r

prU

q
U
	b
is
the
residual
This
form
in
v
olv
es
jumps
in
the
 ux
across
elemen
t
b
oundaries
No
w
let
us
select
the
error
appro
ximation
space
!
S
N

Cho
osing
!
S
N

S
N
do
es
not
w
ork
since
there
are
no
errors
in
the
solution
subspace
Bank

c
hose
!
S
N
as
a
space
of
discon
tin
uous
p
olynomials
of
the
same
degree
p
used
for
the
solution
space
S
N
E

ho
w
ev
er
the
algebraic
system
for
E
resulting
from

or
	
could
b
e
illconditioned
when
the
basis
is
nearly
con
tin
uous
A
b
etter
alternativ
e
is
to
select
!
S
N
as
a
space
of
piecewise
p


stdegree
p
olynomials
when
S
N
E
is
a
space
of
p
th
degree
p
olynomials
Hierarc
hical
bases
cf
Sections

and

are
the
most
ecien
t
to
use
in
this
regard
Let
us
illustrate
the
pro
cedure
b
y
constructing
error
estimates
for
a
piecewise
bilinear
solution
on
a
mesh
of
quadrilateral
elemen
ts
The
bilinear
shap
e
functions
for
a
canonical



square
elemen
t
are
N

ij





"
N
i


"
N
j


i
j



a
where
"
N









"
N









b
The
four
secondorder
hierarc
hical
shap
e
functions
are
N

j





"
N
j


"
N




j



a
N

i





"
N
i


"
N




i



b
where
"
N










p


c


Analysis
of
the
Finite
Elemen
t
Metho
d
































(3,1)
(2,1)
(1,3)
(2,3)
(3,2)
(2,2)
(1,2)
(1,1)
η
ξ
Figure

No
dal
placemen
t
for
bilinear
and
hierarc
hical
biquadratic
shap
e
functions
on
a
canonical



square
elemen
t
No
de
indexing
is
giv
en
in
Figure

The
restriction
of
a
piecewise
bilinear
nite
elemen
t
solution
U
to
the
square
canonical
elemen
t
is
U






X
i

X
j

c

ij
N

ij





Using
either

or
	
the
restriction
of
the
error
appro
ximation
E
to
the
canon
ical
elemen
t
is
the
secondorder
hierarc
hical
function
E






X
i

X
j

c

ij
N

ij






X
i
d

i
N

i






X
j

d

j
N

j





The
lo
cal
problems

or
	
are
transformed
to
the
canonical
elemen
t
and
solv
ed
for
the
eigh
t
unkno
wns
c

ij

i
j



d

i

i



d

j

j



using
the
test
functions
V

N
k
ij

i
j




k



Sev
eral
simplications
and
v
ariations
are
p
ossible
One
of
these
ma
y
b
e
called
ver
tex
sup
er
c
onver
genc
e
whic
h
implies
that
the
solution
at
v
ertices
con
v
erges
more
rapidly
than
it
do
es
globally

V
ertex
sup
ercon
v
ergence
has
b
een
rigorously
established
in
certain
circumstances
eg
for
uniform
meshes
of
square
elemen
ts
but
it
seems
to
hold
more
widely
than
curren
t
theory
w
ould
suggest
In
the
presen
t
con
text
v
ertex
sup
ercon
v
er
gence
implies
that
the
bilinear
v
ertex
solution
c

ij

i
j



con
v
erges
at
a
higher
rate
than
the
solution
elsewhere
on
Elemen
t
e
Th
us
the
error
at
the
v
ertices
c

ij

i
j



ma
y
b
e
neglected
relativ
e
to
d

i

i



and
d

j

j



With
this
simplication


A
P
osteriori
Error
Estimation


b
ecomes
E






X
i
d

i
N

i






X
j

d

j
N

j





Th
us
there
are
four
unkno
wns
d



d



d



and
d


p
er
elemen
t
This
tec
hnique
ma
y
b
e
carried
to
higher
orders
Th
us
if
S
N
E
con
tains
complete
p
olynomials
of
degree
p
!
S
N
only
con
tains
the
hierarc
hical
correction
of
order
p


All
lo
w
erorder
terms
are
neglected
in
the
error
estimation
space
The
p
erformance
of
an
error
estimate
is
t
ypically
appraised
in
a
giv
en
norm
b
y
com
puting
an
ee
ctivity
index
as
#

kE
x
y
k
kex
y
k


Ideally

the
eectivit
y
index
should
not
dier
greatly
from
unit
y
for
a
wide
range
of
mesh
spacings
and
p
olynomial
degrees
Bank
and
W
eiser


and
Oden
et
al

studied
the
error
estimation
pro
cedure

with
the
simplifying
assumption

and
w
ere
able
to
establish
upp
er
b
ounds
of
the
form
#

C
in
the
strain
energy
norm
kek
A


p
Ae
e
They
could
not
ho
w
ev
er
sho
w
that
the
estimation
pro
cedure
w
as
asymptotic
al
ly
c
orr
e
ct
in
the
sense
that
#


under
mesh
renemen
t
or
order
enric
hmen
t
Example

Stroub
oulis
and
Haque
	
study
the
prop
erties
of
sev
eral
dieren
t
error
estimation
pro
cedures
W
e
rep
ort
results
for
the
residual
error
estimation
pro
cedure


on
the
Gaussian
Hill
problem
This
problem
in
v
olv
es
a
Diric
hlet
problem
for
P
oissons
equation
on
an
equilateral
triangle
ha
ving
the
exact
solution
ux
y


e

x

y




Errors
are
sho
wn
in
Figure

for
unifom
prenemen
t
on
a
mesh
of
uniform
trian
gular
elemen
ts
ha
ving
an
edge
length
of

and
for
uniform
hrenemen
t
with
p


Extrap
olation
refers
to
the
prenemen
t
pro
cedure
describ
ed
earlier
in
this
section
This
order
em
b
edding
tec
hnique
app
ears
to
pro
duce
accurate
error
estimates
for
all
p
oly
nomial
degrees
and
mesh
spacings
The
residual
error
estimation
pro
cedure
is

with
errors
at
v
ertices
neglected
and
the
hierarc
hical
corrections
of
order
p


forming
!
S
N

The
pro
cedure
do
es
w
ell
for
ev
endegree
appro
ximations
but
less
w
ell
for
o
dddegree
appro
ximations
F
rom

w
e
see
that
the
error
estimate
E
is
obtained
b
y
solving
a
Neumann
problem
Suc
h
problems
are
only
solv
able
when
the
edge
loading
the
 ux
a
v
erage
across


Analysis
of
the
Finite
Elemen
t
Metho
d
Figure

Eectivit
y
indices
for
sev
eral
error
estimation
pro
cedures
using
uniform
h
renemen
t
left
and
prenemen
t
righ
t
for
the
Gaussian
Hill
Problem
	

of
Example

elemen
t
edges
is
equilibrated
The
 ux
a
v
eraging
used
in

is
apparen
tly

not
sucien
t
to
ensure
this
when
p
is
o
dd
W
ell
pursue
some
remedies
to
this
problem
later
in
this
section
but
rst
let
us
lo
ok
at
another
application
Example

Aia

considers
the
nonlinear
parab
olic
problem
u
t

q
u

u



u
xx

u
y
y


x
y







t


with
the
inital
and
Diric
hlet
b
oundary
conditions
sp
ecied
so
that
the
exact
solution
is
ux
y

t




e
p
q

xy
t
p
q



He
estimates
the
spatial
discretization
error
using
the
residual
estimate

neglecting
the
error
at
v
ertices
The
error
estimation
space
!
S
N
consists
of
the
hierarc
hical
corrections
of
degree
p


ho
w
ev
er
some
lo
w
erdegree
hierarc
hical
terms
are
used
in
some
cases
This
is
to
pro
vide
a
b
etter
equilibration
of
b
oundary
terms
and
impro
v
e
results
although
this
is
a
timedep
enden
t
problem
whic
h
w
e
ha
v
ent
studied
y
et
Aia

k
eeps
the
temp
oral
errors
small
to
concen
trate
on
spatial
error
estimation
With
q


Aias

eectivit
y
indices
in
H

at
t


are
presen
ted
in
T
able

for
computations
p
erformed
on
uniform
meshes
of
N

triangles
with
p
olynomial
degrees
p
ranging
from

to

The
results
with
!
S
N
consisting
only
of
hierarc
hical
corrections
of
degree
p


are
reasonable
Eectivit
y
indices
are
in
excess
of
	
for
the
lo
w
erdegree
p
olynomials
p



A
P
osteriori
Error
Estimation

p
!
S
N
N









	



	
		
		
			


	
	
	
	





	









	
	
	
T
able

Eectivit
y
indices
in
H

at
t


for
Example

The
degrees
of
the
hierarc
hical
mo
des
used
for
!
S
N
are
indicated
in
that
column




but
degrade
with
increasing
p
olynomial
degree
The
addition
of
a
lo
w
er
third
degree
p
olynomial
correction
has
impro
v
ed
the
error
estimates
with
p


ho
w
ev
er
a
similar
tactic
pro
vided
little
impro
v
emen
t
with
p


These
results
and
those
of
Stroub
oulis
and
Haque
	

sho
w
that
the
p
erformance
of
a
p
osteriori
error
estimates
is
still
dep
enden
t
on
the
problem
b
eing
solv
ed
and
on
the
mesh
used
to
solv
e
it
Another
w
a
y
of
simplifying
the
error
estimation
pro
cedure

and
of
understand
ing
the
dierences
b
et
w
een
error
estimates
for
o
dd
and
ev
enorder
nite
elemen
t
solu
tions
in
v
olv
es
a
profound
but
little
kno
wn
result
of
Babu
$
sk
a
cf



	


Concen
trating
on
linear
secondorder
elliptic
problems
on
rectangular
meshes
Babu
$
sk
a
indicates
that
asymptotically
as
mesh
spacing
tends
to
zero
errors
of
o
dddegree
nite
elemen
t
solutions
o
ccur
near
elemen
t
edges
while
errors
of
ev
endegree
solutions
o
ccur
in
elemen
t
in
teriors
These
ndings
suggest
that
error
estimates
ma
y
b
e
obtained
b
y
neglecting
errors
in
elemen
t
in
teriors
for
o
dddegree
p
olynomials
and
neglecting
errors
on
elemen
t
b
oundaries
for
ev
endegree
p
olynomials
Th
us
for
piecewise
o
dddegree
appro
ximations
w
e
could
neglect
the
area
in
tegrals
on
the
righ
thand
sides
of

or
	a
and
calculate
an
error
estimate
b
y
solving
A
e
V

E


V

pU
n



pU
n




e

V

!
S
N

a
or
A
e
V

E


V

pU
n



pU
n




e

V

!
S
N

b
F
or
piecewise
ev
endegree
appro
ximations
the
b
oundary
terms
in

or
	a
can
b
e
neglected
to
yield
A
e
V

E


V

f

e

A
e
V

U

V

!
S
N

a


Analysis
of
the
Finite
Elemen
t
Metho
d
or
A
e
V

E


V

r

e

V

!
S
N

b
Y
u



used
these
argumen
ts
to
pro
v
e
asymptotic
con
v
ergence
of
error
estimates
to
true
errors
for
elliptic
problems
Adjerid
et
al


obtained
similar
results
for
transien
t
parab
olic
systems
Pro
ofs
in
b
oth
cases
apply
to
a
square
region
with
square
elemen
ts
of
spacing
h

	
p
N


A
t
ypical
result
follo
ws
Theorem

L
et
u

H

E

H
p
and
U

S
N
E
b
e
solutions
of

using
c
omplete
pie
c
ewise
bi
p
olynomial
functions
of
or
der
p

If
p
is
an
o
dd
p
ositive
inte
ger
then
ke
k



kE

k



O
h
p

a
wher
e
kE
k



h

p


N

X
e

X
i

X
k

U
x
i
P
k
e


i

b
P
k
e

k





ar
e
the
c
o
or
dinates
of
the
vertic
es
of

e

and
f
P
i
denotes
the
jump
in
f
x
in
the
dir
e
ction
x
i

i



at
the
p
oint
P

If
p
is
a
p
ositive
even
inte
ger
then
a
is
satise
d
with
A
e
V
i

E


V

f

e

A
e
V
i

U

c
wher
e
E
x


x



b
e
%
p
e
x



b
e
%
p
e
x


d
V
i
x


x



x
i
%
p
e
x


x

%
p
e
x


x


i



e
and
%
m
e
x
is
the
mapping
of
the
hier
ar
chic
al
b
asis
function
"
N
m




r
m



Z


P
m

d
f
fr
om


to
the
appr
opriate
e
dge
of

e

Pr
o
of
cf
Adjerid
et
al


and
Y
u


Co
ordinates
are
written
as
x

x


x


T
instead
of
x
y

to
simplify
notation
within
summations
The
hierarc
hical
basis
elemen
t
f
is
consisten
t
with
prior
usage
Th
us
the
subscript

refers
to
a
midside
no
de
as
indicated
in
Figure



A
P
osteriori
Error
Estimation

R
emark

The
error
estimate
for
ev
endegree
appro
ximations
has
dieren
t
trial
and
test
spaces
The
functions
V
i
x


x


v
anish
on


e

Eac
h
function
is
the
pro
duct
of
a
bubble
function
%
p
e
x

%
p
e
x


biased
b
y
a
v
ariation
in
either
the
x

or
the
x

direction
As
an
example
consider
the
test
functions
on
the
canonical
elemen
t
with
p


Restricting
e
to
the
canonical
elemen
t









w
e
ha
v
e
V
i








i
"
N







"
N








i



Using
f
with
m


or

"
N







p






Th
us
V
i








i










i



R
emark

Theorem

applies
to
tensorpro
duct
bip
olynomial
bases
Adjerid
et
al

sho
w
ho
w
this
theorem
can
b
e
mo
died
for
use
with
hierarc
hical
bases
Example

Adjerid
et
al

solv
e
the
nonlinear
parab
olic
problem
of
Example

with
q


on
uniform
square
meshes
with
p
ranging
from

to

using
the
error
estimates
ab
and
acf

T
emp
oral
errors
w
ere
con
trolled
to
b
e
negligible
relativ
e
to
spatial
errors
th
us
w
e
need
not
b
e
concerned
that
this
is
a
parab
olic
and
not
an
elliptic
problem
The
exact
H

errors
and
eectivit
y
indices
at
t


are
presen
ted
in
T
able

Appro
ximate
errors
are
within
ten
p
ercen
t
of
actual
for
all
but
one
mesh
and
app
ear
to
b
e
con
v
erging
at
the
same
rate
as
the
actual
errors
under
mesh
renemen
t
p
N




	

kek

	kuk

#
kek

	kuk

#
kek

	kuk

#
kek

	kuk

#


		
	
	

	

		


		

			
	
			




	

	

		

		


			






T
able

Errors
and
eectivit
y
indices
in
H

for
Example

on
N

elemen
t
uniform
meshes
with
piecewise
bip
p
olynomial
bases
Num
b
ers
in
paren
theses
indicate
a
p
o
w
er
of
ten
The
error
estimation
pro
cedures

and
	
use
a
v
erage
 ux
v
alues
on


e

As
noted
data
for
suc
h
lo
cal
Neumann
problems
cannot
b
e
prescrib
ed
arbitrarily

Let
us
examine
this
further
b
y
concen
trating
on
	
whic
h
w
e
write
as
A
e
V

E


V

r

e


V

R

e
	a


Analysis
of
the
Finite
Elemen
t
Metho
d
where
the
elemen
tal
residual
r
w
as
dened
b
y
	b
and
the
b
oundary
residual
is
R

pU
n



pU
n



	b
The
function

on


e
w
as
tak
en
as
	
to
obtain
	a
ho
w
ev
er
this
ma
y
not
ha
v
e
b
een
a
go
o
d
idea
for
reasons
suggested
in
Example

Recall
cf
Section

that
smo
oth
solutions
of
the
w
eak
problem
	
satisfy
the
Neumann
problem
r

prE

q
E

r

x
y



e

a
pE
n

R

x
y




e

b
Solutions
of

only
exist
when
the
data
R
and
r
satisfy
the
e
quilibrium
c
ondition
Z
Z

e
r
x
y
dxdy

Z


e
R
sds


c
This
condition
will
most
lik
ely
not
b
e
satised
b
y
the
c
hoice
of


	
Ainsw
orth
and
Oden

describ
e
a
relativ
ely
simple
pro
cedure
that
requires
the
solution
of
the
P
oisson
problem

e

r

x
y



e

a


e

n

R

x
y




e



E

b

e


x
y




E

c
The
error
estimate
is
kE
k

A

N

X
e
A
e

e


e

d
The
function

is
appro
ximated
b
y
a
piecewiselinear
p
olynomial
in
a
co
ordinate
s
on


e
and
ma
y
b
e
determined
explicitly
prior
to
solving

Let
us
illustrate
the
eect
of
this
equilibrated
error
estimate
Example

Oden


considers
a
crac
k
ed
panel
as
sho
wn
in
Figure

and
determines
u
as
the
solution
of
Av

u

Z
Z

v
x
u
x

v
y
u
y
dxdy




A
P
osteriori
Error
Estimation
	
y
x
r
u = 0
y
u   = 0
u = r1/2 cos θ/2
θ
ΩL
ΩR
Figure

Crac
k
ed
panel
used
for
Example

p
	h
#
L

#
R

#
With
Without
With
Without
With
Without
Balancing
Balancing
Balancing
Balancing
Balancing
Balancing




	
	

	



	











	
T
able

Lo
cal
and
global
eectivit
y
indices
for
Example

using

with
and
without
equilibration
The
essen
tial
b
oundary
condition
ur




r

cos

	
is
prescrib
ed
on
all
b
oundaries
except
x


y


Th
us
the
solution
of
the
Galerkin
problem
will
satisfy
the
natural
b
oundary
condition
u
y


there
These
conditions
ha
v
e
b
een
c
hosen
so
that
the
exact
solution
is
the
sp
ecied
essen
tial
b
oundary
condition
This
solution
is
singular
since
u
r

r

near
the
origin
r


Results
for
the
eectivit
y
indices
in
strain
energy
for
the
en
tire
region
and
for
the
t
w
o
elemen
ts

L
and

R

adjacen
t
to
the
singularit
y
are
sho
wn
in
T
able

Computations
w
ere
p
erformed
on
a
square
grid
with
uniform
spacing
h
in
eac
h
co
ordinate
direction
Figure

Piecewise
linear
and
quadratic
p
olynomials
w
ere
used
as
nite
elemen
t
bases
Lo
cal
eectivit
y
indices
on

L
and

R
are
not
close
to
unit
y
and
dont
app
ear
to
b
e
con
v
erging
as
either
the
mesh
spacing
is
rened
or
p
is
increased
Global
eectivit
y
indices
are
near
unit
y

Con
v
ergence
to
unit
y
is
dicult
to
appraise
with
the
limited
data


Analysis
of
the
Finite
Elemen
t
Metho
d
A
t
this
time
the
eld
of
a
p
osteriori
error
estimation
is
still
emerging
Error
estimates
for
problems
with
singularities
are
not
generally
a
v
ailable
The
p
erformance
of
error
estimates
is
dep
enden
t
on
b
oth
the
problem
the
mesh
and
the
basis
Error
estimates
for
realistic
nonlinear
and
transien
t
problems
are
just
emerging
V
erf
&
urth

pro
vides
an
exceelen
t
surv
ey
of
metho
ds
and
results

Bibliograph
y

S
Adjerid
B
Belguendouz
and
JE
Flahert
y

A
p
osteriori
nite
elemen
t
error
estimation
for
diusion
problems
T
ec
hnical
Rep
ort
			
Scien
tic
Computation
Researc
h
Cen
ter
Rensselaer
P
olytec
hnic
Institute
T
ro
y

		
SIAM
Journal
on
Scien
tic
Computation
to
app
ear

S
Adjerid
JE
Flahert
y

and
I
Babu
$
sk
a
A
p
osteriori
error
estimation
for
the
nite
elemen
t
metho
doflines
solution
of
parab
olic
problems
Mathematic
al
Mo
dels
and
Metho
ds
in
Applie
d
Scienc
e
	'
			

S
Adjerid
JE
Flahert
y

and
YJ
W
ang
A
p
osteriori
error
estimation
with

nite
elemen
t
metho
ds
of
lines
for
onedimensional
parab
olic
systems
Numer
erishe
Mathematik
'
		

M
Aia
Adaptive
hp
Renement
Metho
ds
for
Singularly
Perturb
e
d
El
liptic
and
Par
ab
olic
Systems
PhD
thesis
Rensselaer
P
olytec
hnic
Institute
T
ro
y

		

M
Ainsw
orth
and
JT
Oden
A
unied
approac
h
to
a
p
osteriori
error
estimation
using
elemen
t
residual
metho
ds
Numeriche
Mathematik
'
		

O
Axelsson
and
VA
Bark
er
Finite
Element
Solution
of
Boundary
V
alue
Pr
oblems
Academic
Press
Orlando
	

I
Babu
$
sk
a
T
Stroub
oulis
and
CS
Upadh
y
a
y

A
mo
del
study
of
the
qualit
y
of
ap
osteriori
estimators
for
linear
elliptic
problems
Part
Ia
Error
estimation
in
the
in
terior
of
patc
h
wise
uniform
grids
of
triangles
T
ec
hnical
Rep
ort
BN
Institute
for
Ph
ysical
Science
and
T
ec
hnology

Univ
ersit
y
of
Maryland
College
P
ark
		

I
Babu
$
sk
a
OC
Zienkiewicz
J
Gago
and
ER
de
A
Oliv
eira
editors
Ac
cur
acy
Estimates
and
Adaptive
Renements
in
Finite
Element
Computations
John
Wiley
and
Sons
Chic
hester
	
	
I
Babu
$
sk
a
and
D
Y
u
Asymptotically
exact
ap
osteriori
error
estimator
for
bi
quadratic
elemen
ts
T
ec
hnical
Rep
ort
BN
Institute
for
Ph
ysical
Science
and
T
ec
hnology

Univ
ersit
y
of
Maryland
College
P
ark
	



Analysis
of
the
Finite
Elemen
t
Metho
d

RE
Bank
PL
TMG
A
Softwar
e
Package
for
Solving
El
liptic
Partial
Dier
ential
Equations
Users
Guide

SIAM
Philadelphia
	

RE
Bank
and
A
W
eiser
Some
a
p
osteriori
error
estimators
for
elliptic
partial
dieren
tial
equations
Mathematics
of
Computation
'
	

SC
Brenner
and
LR
Scott
The
Mathematic
al
The
ory
of
Finite
Element
Metho
ds
SpringerV
erlag
New
Y
ork
		

P
G
Ciarlet
The
Finite
Element
Metho
d
for
El
liptic
Pr
oblems
NorthHolland
Amsterdam
	

C
Johnson
Numeric
al
Solution
of
Partial
Dier
ential
Equations
by
the
Finite
Ele
ment
metho
d
Cam
bridge
Cam
bridge
	

J
Necas
L
es
M

etho
ds
Dir
e
ctes
en
Th

eorie
des
Equations
El
liptiques
Masson
P
aris
	

JT
Oden
T
opics
in
error
estimation
T
ec
hnical
rep
ort
Rensselaer
P
olytec
hnic
Institute
T
ro
y

		
T
utorial
at
the
W
orkshop
on
Adaptiv
e
Metho
ds
for
P
artial
Dieren
tial
Equations

JT
Oden
L
Demk
o
wicz
W
Rac
ho
wicz
and
TA
W
estermann
T
o
w
ard
a
univ
ersal
hp
adaptiv
e
nite
elemen
t
strategy

part

A
p
osteriori
error
estimation
Computer
Metho
ds
in
Applie
d
Me
chanics
and
Engine
ering
'
		

G
Strang
and
G
Fix
A
nalysis
of
the
Finite
Element
Metho
d
Pren
ticeHall
En
glew
o
o
d
Clis
	
	
T
Stroub
oulis
and
KA
Haque
Recen
t
exp
eriences
with
error
estimation
and
adap
tivit
y

Part
I
Review
of
error
estimators
for
scalar
elliptic
problems
Computer
Metho
ds
in
Applie
d
Me
chanics
and
Engine
ering
			'
		

R
V
erf
&
urth
A
R
eview
of
Posteriori
Err
or
Estimation
and
A
daptive
Mesh
R
enement
T
e
chniques
T
eubnerWiley

Stuttgart
		

R
W
ait
and
AR
Mitc
hell
The
Finite
Element
A
nalysis
and
Applic
ations
John
Wiley
and
Sons
Chic
hester
	

DH
Y
u
Asymptotically
exact
ap
osteriori
error
estimator
for
elemen
ts
of
biev
en
degree
Mathematic
a
Numeric
a
Sinic
a
	'
		

DH
Y
u
Asymptotically
exact
ap
osteriori
error
estimator
for
elemen
ts
of
bio
dd
degree
Mathematic
a
Numeric
a
Sinic
a
'
		

Chapter

Adaptiv
e
Finite
Elemen
t
T
ec
hniques

In
tro
duction
The
usual
nite
elemen
t
analysis
w
ould
pro
ceed
from
the
selection
of
a
mesh
and
basis
to
the
generation
of
a
solution
to
an
accuracy
appraisal
and
analysis
Exp
erience
is
the
traditional
metho
d
of
determining
whether
or
not
the
mesh
and
basis
will
b
e
optimal
or
ev
en
adequate
for
the
analysis
at
hand
Accuracy
appraisals
t
ypically
require
the
generation
of
a
second
solution
on
a
ner
mesh
or
with
a
dieren
t
metho
d
and
an
ad
ho
c
comparison
of
the
t
w
o
solutions
A
t
least
with
a
p
osteriori
error
estimation
cf
Section

accuracy
appraisals
can
accompan
y
solution
generation
at
a
lo
w
er
cost
than
the
generation
of
a
second
solution
Adaptiv
e
pro
cedures
try
to
automatically
rene
coarsen
or
relo
cate
a
mesh
and	or
adjust
the
basis
to
ac
hiev
e
a
solution
ha
ving
a
sp
ecied
accuracy
in
an
optimal
fashion
The
computation
t
ypically
b
egins
with
a
trial
solution
generated
on
a
coarse
mesh
with
a
lo
w
order
basis
The
error
of
this
solution
is
appraised
If
it
fails
to
satisfy
the
prescrib
ed
accuracy

adjustmen
ts
are
made
with
the
goal
of
obtaining
the
desired
solution
with
minimal
eort
F
or
example
w
e
migh
t
try
to
reduce
the
discretization
error
to
its
desired
lev
el
using
the
few
est
degrees
of
freedom
While
adaptiv
e
nite
elemen
t
metho
ds
ha
v
e
b
een
studied
for
nearly
t
w
en
t
y
y
ears











surprising
little
is
kno
wn
ab
out
optimal
strategies
Common
pro
cedures
studied
to
date
include

lo
cal
renemen
t
and	or
coarsening
of
a
mesh
hr
enement

relo
cating
or
mo
ving
a
mesh
rr
enement
and

lo
cally
v
arying
the
p
olynomial
degree
of
the
basis
pr
enement
These
strategies
ma
y
b
e
used
singly
or
in
com
bination
W
e
ma
y
guess
that
r

renemen
t
alone
is
generally
not
capable
of
nding
a
solution
with
a
sp
ecied
accuracy

If
the
mesh
is
to
o
coarse
it
migh
t
b
e
imp
ossible
to
ac
hiev
e
a
high
degree
of
precision
without
adding



Adaptiv
e
Finite
Elemen
t
T
ec
hniques
more
elemen
ts
or
altering
the
basis
R
renemen
t
is
more
useful
with
transien
t
problems
where
elemen
ts
mo
v
e
to
follo
w
an
ev
olving
phenomena
By
far
h
renemen
t
is
the
most
p
opular








It
can
increase
the
con
v
ergence
rate
particularly
when
singularities
are
presen
t
cf


or
Example

In
some
sense
p
renemen
t
is
the
most
p
o
w
erful
Exp
onen
tial
con
v
ergence
rates
are
p
ossible
when
solutions
are
smo
oth



When
com
bined
with
h
renemen
t
these
high
rates
are
also
p
ossible
when
singularities
are
presen
t





The
use
of
p
renemen
t
is
most
natural
with
a
hierarc
hical
basis
since
p
ortions
of
the
stiness
and
mass
matrices
and
load
v
ector
will
remain
unc
hanged
when
increasing
the
p
olynomial
degree
of
the
basis
A
p
osteriori
error
estimates
pro
vide
accuracy
appraisals
that
are
necessary
to
termi
nate
an
adaptiv
e
pro
cedure
Ho
w
ev
er
optimal
strategies
for
deciding
where
and
ho
w
to
rene
or
mo
v
e
a
mesh
or
to
c
hange
the
basis
are
rare
In
Section

w
e
sa
w
that
a
p
os
teriori
error
estimates
in
a
particular
norm
w
ere
computed
b
y
summing
their
elemen
tal
con
tributions
as
kE
k


N

X
e
kE
k

e

where
N

is
the
n
um
b
er
of
elemen
ts
in
the
mesh
and
kE
k

e
is
the
restriction
of
the
error
estimate
kE
k

to
Elemen
t
e
The
most
p
opular
metho
d
of
determining
where
adaptivit
y
is
needed
is
to
use
kE
k
e
as
an
enrichment
indic
ator
Th
us
w
e
assume
that
large
errors
come
from
regions
where
the
lo
cal
error
estimate
kE
k
e
is
large
and
this
is
where
w
e
should
rene
or
concen
trate
the
mesh
and	or
increase
the
metho
d
order
Corresp
ondingly

the
mesh
w
ould
b
e
coarsened
or
the
p
olynomial
degree
of
the
basis
lo
w
ered
in
regions
where
kE
k
e
is
small
This
is
the
strategy
that
w
ell
follo
w
cf
Section

ho
w
ev
er
w
e
reiterate
that
there
is
no
pro
of
of
the
optimalit
y
of
enric
hmen
t
in
the
vicinit
y
of
the
largest
lo
cal
error
estimate
Enric
hmen
t
indicators
other
than
lo
cal
error
estimates
ha
v
e
b
een
tried
The
use
of
solution
gradien
ts
is
p
opular
This
is
particularly
true
of
uid
dynamics
problems
where
error
estimates
are
not
readily
a
v
ailable




	

In
this
c
hapter
w
ell
examine
h

p

and
hp
renemen
t
Strategies
using
r

renemen
t
will
b
e
addressed
in
Chapter
	

h
Renemen
t
Mesh
renemen
t
strategies
for
elliptic
steady
problems
need
not
consider
coarsening
W
e
can
rene
an
initially
coarse
mesh
un
til
the
requested
accuracy
is
obtained
This
strategy
migh
t
not
b
e
optimal
and
w
ont
b
e
for
example
if
the
coarse
mesh
is
to
o
ne
in
some
regions
Nev
ertheless
w
ell
concen
trate
on
renemen
t
at
the
exp
ense
of


hRenemen
t

coarsening
W
ell
also
fo
cus
on
t
w
o
dimensional
problems
to
a
v
oid
the
complexities
of
three
dimensional
geometry


Structured
Meshes
Let
us
rst
consider
adaptivit
y
on
structured
meshes
and
then
examine
unstructured
mesh
renemen
t
Renemen
t
of
an
elemen
t
of
a
structured
quadrilateral
elemen
t
mesh
b
y
bisection
requires
mesh
lines
running
to
the
b
oundaries
to
retain
the
four
neigh
b
or
structure
cf
the
left
of
Figure

This
strategy
is
simple
to
implemen
t
and
has
b
een
used
with
nite
dierence
computation

ho
w
ev
er
it
clearly
renes
man
y
more
elemen
ts
than
necessary

The
customary
w
a
y
of
a
v
oiding
the
excess
renemen
t
is
to
in
tro
duce
irr
e
gular
no
des
where
the
edges
of
a
rened
elemen
t
meet
at
the
midsides
of
a
coarser
one
cf
the
righ
t
of
Figure

The
mesh
is
no
longer
structured
and
our
standard
metho
d
of
basis
construction
w
ould
create
discon
tin
uities
at
the
irregular
no
des
Figure

Bisection
of
an
elemen
t
of
a
structured
rectangular
elemen
t
mesh
creating
mesh
lines
running
b
et
w
een
the
b
oundaries
left
The
mesh
lines
are
remo
v
ed
b
y
creating
irregular
no
des
righ
t
The
usual
strategy
of
handling
con
tin
uit
y
at
irregular
no
des
is
to
c
onstr
ain
the
b
asis
Let
us
illustrate
the
tec
hnique
for
a
piecewise
bilinear
basis
The
pro
cedure
for
higher
order
piecewise
p
olynomials
is
similar
Th
us
consider
an
edge
b
et
w
een
V
ertices

and

con
taining
an
irregular
no
de

as
sho
wn
in
Figure

F
or
simplicit
y

assume
that
the
elemen
ts
are
h

h
squares
and
that
those
adjacen
t
to
Edge


are
indexed


and

as
sho
wn
in
the
gure
F
or
con
v
enience
lets
also
place
a
Cartesian
co
ordinate
system
at
V
ertex

W
e
pro
ceed
as
usual
constructing
shap
e
functions
on
eac
h
elemen
t
Although
not
really
needed
for
our
presen
t
dev
elopmen
t
those
bilinear
shap
e
functions
that
are
nonzero
on
Edge


follo
w


Adaptiv
e
Finite
Elemen
t
T
ec
hniques


















3
2
1
1
3
2
x
y
Figure

Irregular
no
de
at
the
in
tersection
of
a
rened
elemen
t

On
Elemen
t

N



h

x
h

y
h

N



h

x
h

h

y
h


On
Elemen
t

N



h

x
h

y

h
h

N



h

x
h

h

y
h


On
Elemen
t

N



h

x
h

h

y
h

N



h

x
h

y
h

As
in
Chapter

the
second
subscript
on
N
j
e
denotes
the
elemen
t
index
The
restriction
of
U
on
Elemen
t

to
Edge


is
U
x
y


c

N

x
y


c

N

x
y

Ev
aluating
this
at
No
de

yields
U
x


y



c


c



x


The
restriction
of
U
on
Elemen
ts

and

to
Edge


is
U
x
y



c

N

x
y


c

N

x
y

if
y

h
c

N

x
y


c

N

x
y

if
y

h

In
either
case
w
e
ha
v
e
U
x


y



c


x


Equating
the
t
w
o
expressions
for
U
x


y


yields
the
c
onstr
aint
c
ondition
c


c


c






hRenemen
t

Figure

The
one
irregular
rule
the
in
tended
renemen
t
of
an
elemen
t
to
create
t
w
o
irregular
no
des
on
an
edge
left
necessitates
renemen
t
of
a
neigh
b
oring
elemen
t
to
ha
v
e
no
more
than
one
irregular
no
de
p
er
elemen
t
edge
righ
t
Th
us
instead
of
determining
c

b
y
Galerkins
metho
d
w
e
constrain
it
to
b
e
determined
as
the
a
v
erage
of
the
solutions
at
the
t
w
o
v
ertices
at
the
ends
of
the
edge
With
the
piecewise
bilinear
basis
used
for
this
illustration
the
solution
along
an
edge
con
taining
an
irregular
no
de
is
a
linear
function
rather
than
a
piecewise
linear
function
Soft
w
are
based
on
this
form
of
adaptiv
e
renemen
t
has
b
een
implemen
ted
for
elliptic

and
parab
olic

systems
One
could
guess
that
diculties
arise
when
there
are
to
o
man
y
irregular
no
des
on
an
edge
T
o
o
v
ercome
this
soft
w
are
dev
elop
ers
t
ypically
use
Banks
	


one
irregular
and
three
neigh
b
or
rules
The
one
irregular
rule
limits
the
n
um
b
er
of
irregular
no
des
on
an
elemen
t
edge
to
one
The
imp
ending
in
tro
duction
of
a
second
irregular
no
de
on
an
edge
requires
renemen
t
of
a
neigh
b
oring
elemen
t
as
sho
wn
in
Figure

The
three
neigh
b
or
rule
states
that
an
y
elemen
t
ha
ving
irregular
no
des
on
three
of
its
four
edges
m
ust
b
e
rened
A
mo
died
quadtree
Section

can
b
e
used
to
store
the
mesh
and
solution
data
Th
us
let
the
ro
ot
of
a
tree
structure
denote
the
original
domain

With
a
structured
grid
w
ell
assume
that

is
square
although
it
could
b
e
obtained
b
y
a
mapping
of
a
distorted
region
to
a
square
Section

The
elemen
ts
of
the
original
mesh
are
regarded
as
ospring
of
the
ro
ot
Figure

Elemen
ts
in
tro
duced
b
y
adaptiv
e
renemen
t
are
obtained
b
y
bisection
and
are
regarded
as
ospring
of
the
elemen
ts
of
the
original
mesh
This
structure
is
depicted
in
Figure

Coarsening
can
b
e
done
b
y
pruning
rened
quadran
ts
Its
customary

but
not
essen
tial
to
assume
that
elemen
ts
cannot
b
e
remo
v
ed
b
y
coarsening
from
the
original
mesh

Irregular
no
des
can
b
e
a
v
oided
b
y
using
tr
ansition
elements
as
sho
wn
in
Figure

The
strategy
on
the
righ
t
uses
triangular
elemen
ts
as
a
transition
b
et
w
een
the
coarse
and
ne
elemen
ts
If
triangular
elemen
ts
are
not
desirable
the
transition
elemen
t
on
the
left
uses
rectangles
but
only
adds
a
mid
edge
shap
e
functions
at
No
de

There
is
no
no
de
at
the
midp
oin
t
of
Edge


The
shap
e
functions
on
the
transition
elemen
t
are
N



h

x
h

y

h
h

N



h

x
h

h

y
h



Adaptiv
e
Finite
Elemen
t
T
ec
hniques











































































 







Figure

Original
structured
mesh
and
the
bisection
of
t
w
o
elemen
ts
left
The
tree
structure
used
to
represen
t
this
mesh
righ
t






























































2
1
3
2
x
y
3
4
5
1
Figure

T
ransition
elemen
ts
b
et
w
een
coarse
and
ne
elemen
ts
using
rectangles
left
and
triangles
righ
t
N



h

x
h



y
h

if


y

h

hy
h

if
h

y

h

N



x
h

y
h

N



x
h

h

y
h

Again
the
origin
of
the
co
ordinate
system
is
at
No
de

Those
shap
e
functions
asso
ciated
with
no
des
on
the
righ
t
edge
are
piecewise
bilinear
on
Elemen
t

whereas
those
asso
ciated
with
no
des
on
the
left
edge
are
linear
Berger
and
Oliger

considered
structured
meshes
with
structured
mesh
renemen
t
but
allo
w
ed
elemen
ts
of
ner
meshes
to
o
v
erlap
those
of
coarser
ones
Figure

This
metho
d
has
principally
used
with
adaptiv
e
nite
dierence
computation
but
it
has
had
some
use
with
nite
elemen
t
metho
ds
	

Unstructured
Meshes
Computation
with
triangular
elemen
t
meshes
has
b
een
done
since
the
b
eginning
of
adap
tiv
e
metho
ds
Bank
	


dev
elop
ed
the
rst
soft
w
are
system
PL
TMG
whic
h
solv
es


hRenemen
t

Figure

Comp
osite
grid
construction
where
ner
grids
o
v
erlap
elemen
ts
of
coarser
ones
our
mo
del
problem
with
a
piecewise
linear
p
olynomial
basis
It
uses
a
m
ultigrid
itera
tiv
e
pro
cedure
to
solv
e
the
resulting
linear
algebraic
system
on
the
sequence
of
adaptiv
e
meshes
Bank
uses
uniform
bisection
of
a
triangular
elemen
t
in
to
four
smaller
elemen
ts
Irregular
no
des
are
eliminated
b
y
dividing
adjacen
t
triangles
sharing
a
bisected
edge
in
t
w
o
Figure

T
riangles
divided
to
eliminate
irregular
no
des
are
called
green
triangles


Bank
imp
oses
one
irregular
and
three
neigh
b
or
rules
relativ
e
to
green
triangles
Th
us
eg
an
in
tended
second
bisection
of
a
v
ertex
angle
of
a
green
triangle
w
ould
not
b
e
done
Instead
the
green
triangle
w
ould
b
e
uniformly
rened
Figure

to
k
eep
angles
b
ounded
a
w
a
y
from
zero
as
the
mesh
is
rened
Figure

Uniform
bisection
of
a
triangular
elemen
t
in
to
four
and
the
division
of
neigh
b
oring
elemen
ts
in
t
w
o
sho
wn
dashed
Riv
ara


dev
elop
ed
a
mesh
renemen
t
algorithm
based
on
bisecting
the
longest
edge
of
an
elemen
t
Riv
aras
pro
cedure
a
v
oids
irregular
no
des
b
y
additional
renemen
t
as
describ
ed
in
the
algorithm
of
Figure
	
In
this
pro
cedure
w
e
supp
ose
that
elemen
ts


Adaptiv
e
Finite
Elemen
t
T
ec
hniques
Figure

Uniform
renemen
t
of
green
triangles
of
the
mesh
sho
wn
in
Figure

to
a
v
oid
the
second
bisection
of
v
ertex
angles
New
renemen
ts
are
sho
wn
as
dashed
lines
of
a
sub
mesh

of
mesh

h
are
sc
heduled
for
renemen
t
All
elemen
ts
of

are
bisected
b
y
their
longest
edges
to
create
a
mesh


h

whic
h
ma
y
con
tain
irregular
no
des
Those
elemen
ts
e
of


h
that
con
tain
irregular
no
des
are
placed
in
the
set



Elemen
ts
of


are
bisected
b
y
their
longest
edge
to
create
t
w
o
triangles
This
bisection
ma
y
create
another
no
de
Q
that
is
dieren
t
from
the
original
irregular
no
de
P
of
elemen
t
e
If
so
P
and
Q
are
joined
to
pro
duce
another
elemen
t
Figure

The
pro
cess
is
con
tin
ued
un
til
all
irregular
no
des
are
remo
v
ed
pro
cedure
riv
ara
h



Obtain


h
b
y
bisecting
all
triangles
of

b
y
their
longest
edges
Let


con
tain
those
elemen
ts
of


h
ha
ving
irregular
no
des
i


while

i
is
not

do
Let
e


i
ha
v
e
an
irregular
no
de
P
and
bisect
e
b
y
its
longest
edge
Let
Q
b
e
the
in
tersection
p
oin
t
of
this
bisection
if
P

Q
then
Join
P
and
Q
end
if
Let

i
h
b
e
the
mesh
created
b
y
this
pro
cess
Let

i
b
e
the
set
of
elemen
ts
in

i
h
with
irregular
no
des
i

i


end
while
return

i
h
Figure
	
Riv
aras
mesh
bisection
algorithm
Riv
aras

algorithm
has
b
een
pro
v
en
to
terminate
with
a
regular
mesh
in
a
nite
n
um
b
er
of
steps
It
also
k
eep
angles
b
ounded
a
w
a
y
from

and


In
fact
if
	
is
the


hRenemen
t
	
P
P
Q
e
Figure

Elimination
of
an
irregular
no
de
P
left
as
part
of
Riv
aras
algorithm
sho
wn
in
Figure
	
b
y
dividing
the
longest
edge
of
Elemen
t
e
and
connecting
v
ertices
as
indicated
smallest
angle
of
an
y
triangle
in
the
original
mesh
the
smallest
angle
in
the
mesh
obtained
after
an
arbitrary
n
um
b
er
of
applications
of
the
algorithm
of
Figure

is
no
smaller
than
	



Similar
pro
cedures
w
ere
dev
elop
ed
b
y
Sew
ell

and
used
b
y
Mitc
hell

b
y
dividing
the
new
est
v
ertex
of
a
triangle
T
ree
structures
can
b
e
used
to
represen
t
the
data
asso
ciated
with
Banks


and
Riv
aras

pro
cedures
As
with
structured
mesh
computation
elemen
ts
in
tro
duced
b
y
renemen
t
are
regarded
as
ospring
of
coarser
paren
t
elemen
ts
The
actual
data
represen
tations
v
ary
somewhat
from
the
tree
describ
ed
earlier
Figure

and
readers
seeking
more
detail
should
consult
Bank


or
Riv
ara



With
tree
structures
an
y
coarsening
ma
y
b
e
done
b
y
pruning
leaf

elemen
ts
from
the
tree
Th
us
those
elemen
ts
nested
within
a
coarser
paren
t
are
remo
v
ed
and
the
paren
t
is
restored
as
the
elemen
t
As
men
tioned
earlier
coarsening
b
ey
ond
the
original
mesh
is
not
allo
w
ed
The
pro
cess
is
complex
It
m
ust
b
e
done
without
in
tro
ducing
irregular
no
des
Supp
ose
for
example
that
the
quartet
of
small
elemen
ts
sho
wn
with
dashed
lines
in
the
cen
ter
of
the
mesh
of
Figure

w
ere
sc
heduled
for
remo
v
al
Their
direct
remo
v
al
w
ould
create
three
irregular
no
des
on
the
edges
of
the
paren
t
triangle
Th
us
w
e
w
ould
ha
v
e
to
determine
if
remo
v
al
of
the
elemen
ts
con
taining
these
irregular
no
des
is
justied
based
on
error
indication
information
If
so
the
mesh
w
ould
b
e
coarsened
to
the
one
sho
wn
in
Figure

Notice
that
the
coarsened
mesh
of
Figure

diers
from
mesh
of
Figure

that
w
as
rened
to
create
the
mesh
of
Figure

Hence
renemen
t
and
coarsening
ma
y
not
b
e
rev
ersible
op
erations
b
ecause
of
their
indep
enden
t
treatmen
t
of
irregular
no
des
Coarsening
ma
y
b
e
done
without
a
tree
structure
Shephard
et
al

describ
e
an
edge
collapsing
pro
cedure
where
the
v
ertex
at
one
end
of
an
elemen
t
edge
is
collapsed
on
to
the
one
at
the
other
end
Aia

describ
es
a
t
w
o
dimensional
v
arian
t
of
this
pro
cedure
whic
h
w
e
repro
duce
here
Let
P
b
e
the
p
olygonal
region
comp
osed
of
the
union
of
elemen
ts
sharing
V
ertex
V
	
Figure

Let
V


V






V
k
denote
the
v
ertices
on
the
k
triangles
con
taining
V
	
and
supp
ose
that
error
indicators
rev
eal
that
these
elemen
ts
ma
y


Adaptiv
e
Finite
Elemen
t
T
ec
hniques
Figure

Coarsening
of
a
quartet
of
elemen
ts
sho
wn
with
dashed
lines
in
Figure

and
the
remo
v
al
of
surrounding
elemen
ts
to
a
v
oid
irregular
no
des
V
V
V
V
V
5
2
4
3
1
V
V
V
V
5
1
2
V4
V3
0
Figure

Coarsening
of
a
p
olygonal
region
left
b
y
collapsing
V
ertex
V
	
on
to
V

righ
t
b
e
coarsened
The
strategy
of
collapsing
V
	
on
to
one
of
the
v
ertices
V
j

j







k

is
done
b
y
deleting
all
edges
connected
to
V
	
and
then
re
triangulating
P
b
y
connecting
V
j
to
the
other
v
ertices
of
P
cf
the
righ
t
of
Figure

V
ertex
V
	
is
called
the
c
ol
lapse
d
vertex
and
V
j
is
called
the
tar
get
vertex
Collapsing
has
to
b
e
ev
aluated
for
top
ological
compatibilit
y
and
geometric
v
alidit
y
b
efore
it
is
p
erformed
Chec
king
for
geometric
v
alidit
y
prev
en
ts
situations
lik
e
the
one
sho
wn
in
Figure

from
happ
ening
A
collapse
is
top
ologically
incompatible
when
eg
V
	
is
on


and
the
target
v
ertex
V
j
is
within

Assuming
that
V
	
can
b
e
collapsed
the
target
v
ertex
is
c
hosen
to
b
e
the
one
that
maximizes
the
minim
um
angle
of
the
resulting
re
triangulation
of
P

Aia

do
es
no
collapsing
when
the
smallest
angle
that
w
ould
b
e
pro
duced
b
y
collapsing
is
smaller
than
a
prescrib
ed
minim
um
angle
This
migh
t
result
in
a
mesh
that
is
ner
than
needed
for
the
sp
ecied
accuracy

In
this
case
the
minim
um
angle
restriction
could
b
e
w
aiv
ed
when
V
	
has
b
een
sc
heduled
for
coarsening
more
than
a
prescrib
ed
n
um
b
er
of
times
Supp
ose
that
the
edges
h
e

h
e

h
e
of
an


hRenemen
t

elemen
t
e
are
indexed
suc
h
that
h
e

h
e

h
e

then
the
smallest
angle
	
e
of
Elemen
t
e
ma
y
b
e
calculated
as
sin
	
e

A
e
h
e
h
e
where
A
e
is
the
area
of
Elemen
t
e
V
V
V
V1
V
V
V
V
0
V
V
3
4
5
6
7
V2
V1
V
V7
6
V5
4
3
V2
Figure

A
situation
where
the
collapse
of
V
ertex
V
	
left
creates
an
in
v
alid
mesh
righ
t
Ω1
Ω2
E
Ω
Ω
E
2
1
Figure

Sw
apping
an
edge
of
a
pair
of
elemen
ts
left
to
impro
v
e
elemen
t
shap
e
righ
t
The
shap
e
of
elemen
ts
con
taining
small
or
large
angles
that
w
ere
created
during
renemen
t
or
coarsening
ma
y
b
e
impro
v
ed
b
y
e
dge
swapping
This
pro
cedure
op
erates
on
pairs
of
triangles


and


that
share
a
common
edge
E

If
Q



	



edge
sw
apping
o
ccurs
deleting
Edge
E
and
re
triangulating
Q
b
y
connecting
the
v
ertices
opp
osite
to
Edge
E
Figure

Sw
apping
can
b
e
regarded
as
a
renemen
t
of
Edge
E
follo
w
ed
b
y
a
collapsing
of
this
new
v
ertex
on
to
a
v
ertex
not
on
Edge
E

As
suc
h
w
e
recognize
that
sw
apping
will
ha
v
e
to
b
e
c
hec
k
ed
for
mesh
v
alidit
y
and
top
ological
compatibilit
y

Of
course
it
will
also
ha
v
e
to
pro
vide
an
impro
v
ed
mesh
qualit
y


Renemen
t
Criteria
F
ollo
wing
the
in
tro
ductory
discussion
of
error
estimates
in
Section

w
e
assume
the
existence
of
a
set
of
renemen
t
indicators

e

e







N


whic
h
are
large
where
renemen
t
is
desired
and
small
where
coarsening
is
appropriate
As
noted
these
migh
t


Adaptiv
e
Finite
Elemen
t
T
ec
hniques
b
e
the
restriction
of
a
global
error
estimate
to
Elemen
t
e


e

kE
k

e

or
an
ad
ho
c
renemen
t
indicator
suc
h
as
the
magnitude
of
the
solution
gradien
t
on
the
elemen
t
In
either
case
ho
w
do
w
e
use
this
error
information
to
rene
the
mesh
P
erhaps
the
simplest
approac
h
is
to
rene
a
xed
p
ercen
tage
of
elemen
ts
ha
ving
the
largest
error
indicators
ie
rene
all
elemen
ts
e
satisfying

e


max
j
N


j


A
t
ypical
c
hoice
of
the
parameter




is

W
e
can
b
e
more
precise
when
an
error
estimate
of
the
form

with
indicators
giv
en
b
y

is
a
v
ailable
Supp
ose
that
w
e
ha
v
e
an
a
priori
error
estimate
of
the
form
kek

C
h
p

a
After
obtaining
an
a
p
osteriori
error
estimate
kE
k
on
a
mesh
with
spacing
h
w
e
could
compute
an
estimate
of
the
error
constan
t
C
as
C

kE
k
h
p

b
The
mesh
spacing
parameter
h
ma
y
b
e
tak
en
as
eg
the
a
v
erage
elemen
t
size
h

r
A
N

c
where
A
is
the
area
of

Supp
ose
that
adaptivit
y
is
to
b
e
terminated
when
kE
k


where

is
a
prescrib
ed
tolerance
Using
a
w
e
w
ould
lik
e
to
construct
an
enric
hed
mesh
with
a
spacing
parameter
 
h
suc
h
that
C
 
h
p



Using
the
estimate
of
C
computed
b
y
b
w
e
ha
v
e
 
h
h



kE
k

p

a
Th
us
using
c
an
enric
hed
mesh
of
 
N


 
h

A

h

A


kE
k

p
b


hRenemen
t

elemen
ts
will
reduce
kE
k
to
appro
ximately


Ha
ving
selected
an
estimate
of
the
n
um
b
er
of
elemen
ts
 
N

to
b
e
in
the
enric
hed
mesh
w
e
ha
v
e
to
decide
ho
w
to
rene
the
curren
t
mesh
in
order
to
attain
the
prescrib
ed
tolerence
W
e
ma
y
do
this
b
y
e
quidistributing
the
error
o
v
er
the
mesh
Th
us
w
e
w
ould
lik
e
eac
h
elemen
t
of
the
enric
hed
mesh
to
ha
v
e
appro
ximately
the
same
error
Using

this
implies
that
k
 
E
k

e



 
N

where
k
 
E
k
e
is
the
error
indicator
of
Elemen
t
e
of
the
enric
hed
mesh
Using
this
notion
w
e
divide
the
error
estimate
kE
k

e
b
y
a
factor
n
so
that
kE
k

e
n



 
N


Th
us
eac
h
elemen
t
of
the
curren
t
mesh
is
divided
in
to
n
segmen
ts
suc
h
that
n
 
N



kE
k
e





In
practice
n
and
N

ma
y
b
e
rounded
up
or
increased
sligh
tly
to
pro
vide
a
measure
of
assurance
that
the
error
criterion
will
b
e
satised
after
the
next
adaptiv
e
solution
The
mesh
division
pro
cess
ma
y
b
e
implemen
ted
b
y
rep
eated
applications
of
a
mesh
renemen
t
algorithm
without
solving
the
partial
dieren
tial
equation
in
b
et
w
een
Th
us
with
bisection



the
elemen
tal
error
estimate
w
ould
b
e
halv
ed
on
eac
h
bisected
elemen
t
Renemen
t
w
ould
then
b
e
rep
eated
un
til

is
satised
The
error
estimation
pro
cess

w
orks
with
coarsening
when
n


ho
w
ev
er
neigh
b
oring
elemen
ts
w
ould
ha
v
e
to
suggest
coarsening
as
w
ell
Example

Riv
ara

solv
es
Laplaces
equation
u
xx

u
y
y


x
y



where

is
a
regular
hexagon
inscrib
ed
in
a
unit
circle
The
hexagon
is
orien
ted
with
one
v
ertex
along
the
p
ositiv
e
x
axis
with
a
crac
k
through
this
v
ertex
for


x


y


Boundary
conditions
are
established
to
b
e
homogeneous
Neumann
conditions
on
the
x
axis
b
elo
w
the
crac
k
and
ur




r

sin


ev
erywhere
else
This
function
is
also
the
exact
solution
of
the
problem
expressed
in
a
p
olar
frame
eminating
from
the
cen
ter
of
the
hexagon
The
solution
has
a
singularit
y
at
the
origin
due
to
the
re
en
tran
t
angle
of

at
the
crac
k
tip
and
the
c
hange
in


Adaptiv
e
Finite
Elemen
t
T
ec
hniques
b
oundary
conditions
from
Diric
hlet
to
Neumann
The
solution
w
as
computed
with
a
piecewise
linear
nite
elemen
t
basis
using
quasi
uniform
and
adaptiv
e
h
renemen
t
A
residual
error
estimation
pro
cedure
similar
to
those
describ
ed
in
Section

w
as
used
to
appraise
solution
accuracy

Renemen
t
follo
w
ed

The
results
sho
wn
in
Figure

indicate
that
the
uniform
mesh
is
con
v
erging
as
O
N


where
N
is
the
n
um
b
er
of
degrees
of
freedom
W
e
ha
v
e
seen
Section

that
uniform
h
renemen
t
con
v
erges
as
kek


C

h
min
pq


C

N

min
pq


where
q


dep
ends
on
the
solution
smo
othness
and
in
t
w
o
dimensions
N

h


F
or
linear
elliptic
problems
with
geometric
singularities
q



where

is
the
maxim
um
in
terior
angle
on


F
or
the
hexagon
with
a
crac
k
the
in
terior
angles
w
ould
b
e




and


The
latter
is
the
largest
angle
hence
q


Th
us
with
p


con
v
ergence
should
o
ccur
at
an
O
N


rate
ho
w
ev
er
the
actual
rate
is
lo
w
er
Figure

The
adaptiv
e
pro
cedure
has
restored
the
O
N


con
v
ergence
rate
that
one
w
ould
exp
ect
of
a
problem
without
singularities
In
general
optimal
adaptiv
e
h
renemen
t
will
con
v
erge
as



kek


C

h
p

C

N
p



p
and
hpRenemen
t
With
p
renemen
t
the
mesh
is
not
c
hanged
but
the
order
of
the
nite
elemen
t
basis
is
v
aried
lo
cally
o
v
er
the
domain
As
with
h
renemen
t
w
e
m
ust
ensure
that
the
basis
remains
con
tin
uous
at
elemen
t
b
oundaries
A
situation
where
second
and
fourth
degree
hierarc
hical
bases
in
tersect
along
an
edge
b
et
w
een
t
w
o
square
elemen
ts
is
sho
wn
on
the
left
of
Figure

The
second
degree
appro
ximation
sho
wn
at
the
top
left
consists
of
a
bilinear
shap
e
function
at
eac
h
v
ertex
and
a
second
degree
correction
on
eac
h
edge
The
fourth
degree
appro
ximation
b
ottom
left
consists
of
bilinear
shap
e
functions
at
eac
h
v
ertex
second
third
and
fourth
degree
corrections
on
eac
h
edge
and
a
fourth
degree
bubble
function
asso
ciated
with
the
cen
troid
cf
Section

The
maxim
um
degree
of
the
p
olynomial
asso
ciated
with
a
mesh
en
tit
y
is
iden
tied
on
the
gure
The
second
and
fourth
degree
shap
e
functions
w
ould
b
e
incompatible
discon
tin
uous
across
the
common
edge
b
et
w
een
the
t
w
o
elemen
ts
This
situation
can
b
e
corrected
b
y
constraining
the
edge
functions
to
the
lo
w
er
degree
t
w
o
basis
of
the
top
elemen
t
as
sho
wn
in
the
cen
ter


p
and
hpRenemen
t

Figure

Solution
of
Example

b
y
uniform

and
adaptiv
e

h
renemen
t

p
ortion
of
the
gure
or
b
y
adding
third
and
fourth
order
edge
functions
to
the
upp
er
elemen
t
as
sho
wn
on
the
righ
t
of
the
gure
Of
the
t
w
o
p
ossibilities
the
addition
of
the
higher
degree
functions
is
the
most
p
opular
Constraining
the
space
to
the
lo
w
er
degree
p
olynomial
could
result
in
a
situation
where
error
criteria
satised
on
the
elemen
t
on
the
lo
w
er
left
of
Figure

w
ould
no
longer
b
e
satised
on
the
elemen
t
in
the
lo
w
er
cen
ter
p
ortion
of
the
gure
R
emark

The
incompatibilit
y
problem
just
describ
ed
w
ould
not
arise
with
the
hierarc
hical
data
structures
dened
in
Section

since
edge
functions
are
blended
on
to
all
elemen
ts
con
taining
the
edge
and
hence
w
ould
alw
a
ys
b
e
con
tin
uous
Szab!
o
	
dev
elop
ed
a
strategy
for
the
adaptiv
e
v
ariation
of
p
b
y
constructing
error
estimates
of
solutions
with
lo
cal
degrees
p
p


and
p


on
Elemen
t
e
and
extrap
olating
to
get
an
error
estimates
for
solutions
of
higher
degrees
With
a
hierarc
hical
basis
this
is
straigh
tforw
ard
when
p


One
could
just
use
the
dierences
b
et
w
een
higher
and
lo
w
er
order
solutions
or
an
error
estimation
pro
cedure
as
describ
ed
in
Section

When
p


on
Elemen
t
e
lo
cal
error
estimates
of
solutions
ha
ving
degrees

and

are
linearly
extrap
olated
Szab
o
	
b
egan
b
y
generating
piecewise
linear
p


and
piecewise
quadratic
p


solutions
ev
erywhere
and
extrap
olating
the
error
estimates
Flahert
y
and
Mo
ore


suggest
an
alternativ
e
when
p


They
obtain
a
lo
w
er
order
piecewise


Adaptiv
e
Finite
Elemen
t
T
ec
hniques




























































































































































































































































2
2
4
4
4
2
2
2
2
4
4
4
4
2
2
2
2
4
4
4
4
4
4
4
2
4
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
2
1
1
4
Figure

Second
and
fourth
degree
hierarc
hical
shap
e
functions
on
t
w
o
square
el
emen
ts
are
incompatible
across
the
common
edge
b
et
w
een
elemen
ts
left
This
can
b
e
corrected
b
y
remo
ving
the
third
and
fourth
degree
edge
functions
from
the
lo
w
er
ele
men
t
cen
ter
or
b
y
adding
third
and
fourth
degree
edge
functions
to
the
upp
er
elemen
t
righ
t
The
maxim
um
degree
of
the
shap
e
function
asso
ciated
with
a
mesh
en
tit
y
is
sho
wn
in
eac
h
case
constan
t
p


solution
b
y
using
the
v
alue
of
the
piecewise
linear
solution
at
the
cen
ter
of
Elemen
t
e
The
dierence
b
et
w
een
these
t
w
o
solutions
furnishes
an
error
estimate
whic
h
when
used
with
the
error
estimate
for
the
piecewise
linear
solution
is
linearly
extrap
olated
to
higher
v
alues
of
p
Ha
ving
estimates
of
discretization
errors
as
a
function
of
p
on
eac
h
elemen
t
w
e
can
use
a
strategy
similar
to

to
select
a
v
alue
of
p
to
reduce
the
error
on
an
elemen
t
to
its
desired
lev
el
Often
ho
w
ev
er
a
simpler
strategy
is
used
As
indicated
earlier
the
error
estimate
kE
k
e
should
b
e
of
size


N

on
eac
h
elemen
t
of
the
mesh
When
enric
hmen
t
is
indicated
eg
when
kE
k



w
e
can
increase
the
degree
of
the
p
olynomial
represen
tation
b
y
one
on
an
y
elemen
t
e
where

e


R

N


a
The
parameter

e
is
an
enric
hmen
t
indicator
on
Elemen
t
e
whic
h
ma
y
b
e
kE
k
e

and

R


If
coarsening
is
done
the
degree
of
the
appro
ximation
on
Elemen
t
e
can
b
e
reduced
b
y
one
when

e


C
h
e

N

b
where
h
e
is
the
longest
edge
of
Elemen
t
e
and

C


The
con
v
ergence
rate
of
the
p
v
ersion
of
the
nite
elemen
t
metho
d
is
exp
onen
tial
when
the
solution
has
no
singularities
F
or
problems
with
singularities
p
renemen
t
con
v
erges


p
and
hpRenemen
t

as
kek

C
N
q

where
q


dep
ends
on
the
solution
smo
othness







The
parameter
q
is
in
tended
to
b
e
generic
and
is
not
necessarily
the
same
as
the
one
app
earing
in

With
singularities
the
p
erformance
of
the
p
v
ersion
of
the
nite
elemen
t
metho
d
dep
ends
on
the
mesh
P
erformance
will
b
e
b
etter
when
the
mesh
has
b
een
graded
near
the
singularit
y

This
suggests
com
bining
h
and
p
renemen
t
Indeed
when
prop
er
mesh
renemen
t
is
com
bined
with
an
increase
of
the
p
olynomial
degree
p
the
con
v
ergence
rate
is
exp
onen
tial
kek

C
e
q

N
q


where
q

and
q

are
p
ositiv
e
constan
ts
that
dep
end
on
the
smo
othness
of
the
exact
solution
and
the
nite
elemen
t
mesh
Generating
the
correct
mesh
is
crucial
and
its
construction
is
only
kno
wn
for
mo
del
problems








Oden
et
al

dev
elop
ed
a
strategy
for
hp
renemen
t
that
in
v
olv
ed
taking
three
solution
steps
follo
w
ed
b
y
an
extrap
olation
Some
tec
hniques
do
not
attempt
to
adjust
the
mesh
and
the
order
at
the
same
time
but
rather
adjust
either
the
mesh
or
the
order
W
ell
illustrate
one
of
these
but
rst
cite
the
more
explicit
v
ersion
of
the
error
estimate

giv
en
b
y
Babu
"
sk
a
and
Suri

kek


C
h
min
pq

p
q
kuk
min
pq



The
mesh
m
ust
satisfy
the
uniformit
y
condition
the
p
olynomial
degree
is
uniform
and
u

H
q


In
this
form
the
constan
t
C
is
indep
enden
t
of
h
and
p
This
result
and
the
previous
estimates
indicate
that
it
is
b
etter
to
increase
the
p
olynomial
degree
when
the
solution
u
is
smo
oth
q
is
large
and
to
reduce
h
near
singularities
Th
us
a
p
ossible
strategy
w
ould
b
e
to
increase
p
in
smo
oth
high
error
regions
and
rene
the
mesh
near
singularities
W
e
therefore
need
a
metho
d
of
estimating
solution
smo
othness
and
Aia

do
es
this
b
y
computing
the
ratio

e



e
p
e
p


if

e
p





otherwise

where
p
is
the
p
olynomial
degree
on
Elemen
t
e
An
argumen
t
has
b
een
added
to
the
error
indicator
on
Elemen
t
e
to
emphasize
its
dep
endence
on
the
lo
cal
p
olynomial
degree
As
describ
ed
in
Section

p


can
b
e
estimated
from
the
part
of
U
in
v
olving
the
hierarc
hal
corrections
of
degree
p
No
w

If

e


the
error
estimate
is
decreasing
with
increasing
p
olynomial
degree
If
enric
hmen
t
w
ere
indicated
on
Elemen
t
e
p
renemen
t
w
ould
b
e
the
preferred
strat
egy



Adaptiv
e
Finite
Elemen
t
T
ec
hniques

If

e


the
recommended
strategy
w
ould
b
e
h
renemen
t
Aia


selects
p
renemen
t
if

e


and
h
renemen
t
if

e



with



Adjust
men
ts
ha
v
e
to
made
when
p



Coarsening
is
done
b
y
v
ertex
collapsing
when
all
elemen
ts
surrounding
a
v
ertex
ha
v
e
lo
w
errors

Example

Aia

solv
es
the
nonlinear
parab
olic
partial
dieren
tial
equation
u
t


u



u

u
xx

u
y
y


x
y



t


with
the
initial
and
Diric
hlet
b
oundary
data
dened
so
that
the
exact
solution
on
the
square


fx
y
j

x
y

g
is
ux
y

t




e
p


xy
t
p



Although
this
problem
is
parab
olic
Aia

k
ept
the
temp
oral
error
small
so
that
spatial
errors
dominate
Aia

solv
ed
this
problem
with



b
y
adaptiv
e
h

p

and
hp
renemen
t
for
a
v
ariet
y
of
spatial
error
tolerances
The
initial
mesh
for
h
renemen
t
con
tained

triangular
elemen
ts
and
used
piecewise
quadratic
p


shap
e
functions
F
or
p
renemen
t
the
mesh
con
tained

triangles
with
p
v
arying
from

to

The
solution
with
adaptiv
e
hp
renemen
t
w
as
initiated
with

elemen
ts
and
p


The
con
v
ergence
history
of
the
three
adaptiv
e
strategies
is
rep
orted
in
Figure

The
solution
with
h
renemen
t
app
ears
to
b
e
con
v
erging
at
an
algebraic
rate
of
ap
pro
ximately
N
		

whic
h
is
close
to
the
theoretical
rate
cf

There
are
no
singularities
in
this
problem
and
the
adaptiv
e
p
and
hp
renemen
t
metho
ds
app
ear
to
b
e
con
v
erging
at
exp
onen
tial
rates
This
example
and
the
material
in
this
c
hapter
giv
e
an
in
tro
duction
to
the
essen
tial
ideas
of
adaptivit
y
and
adaptiv
e
nite
elemen
t
analysis
A
t
this
time
adaptiv
e
soft
w
are
is
emerging
Robust
and
reliable
error
estimation
pro
cedures
are
only
kno
wn
for
mo
del
problems
Optimal
enric
hmen
t
strategies
are
just
b
eing
disco
v
ered
for
realistic
problems


p
and
hpRenemen
t
	
10
1
10
2
10
3
10
4
10
−3
10
−2
10
−1
10
0
Number Of Degrees Of Freedom
Relative Error In H1 Norm
Figure

Errors
vs
the
n
um
b
er
of
degrees
of
freedom
N
for
Example

at
t


using
adaptiv
e
h

p
and
hp
renemen
t


and

resp
ectiv
ely


Adaptiv
e
Finite
Elemen
t
T
ec
hniques

Bibliograph
y

S
Adjerid
and
JE
Flahert
y

A
lo
cal
renemen
t
nite
elemen
t
metho
d
for
t
w
o
dimensional
parab
olic
systems
SIAM
Journal
on
Scientic
and
Statistic
al
Comput
ing
		#
	

M
Aia
Adaptive
hpRenement
Metho
ds
for
SingularlyPerturb
e
d
El
liptic
and
Par
ab
olic
Systems
PhD
thesis
Rensselaer
P
olytec
hnic
Institute
T
ro
y

		

DC
Arney
and
JE
Flahert
y

An
adaptiv
e
mesh
mo
ving
and
lo
cal
renemen
t
metho
d
for
time
dep
enden
t
partial
dieren
tial
equations
A
CM
T
r
ansactions
on
Mathematic
al
Softwar
e
#
		

I
Babu
"
sk
a
J
Chandra
and
JE
Flahert
y

editors
Adaptive
Computational
Metho
ds
for
Partial
Dier
ential
Equations
Philadelphia
	
SIAM

I
Babu
"
sk
a
JE
Flahert
y

WD
Hensha
w
JE
Hop
croft
JE
Oliger
and
T
T
ez
duy
ar
editors
Mo
deling	
Mesh
Gener
ation	
and
A
daptive
Numeric
al
Metho
ds
for
Partial
Dier
ential
Equations
v
olume

of
The
IMA
V
olumes
in
Mathematics
and
its
Applic
ations
New
Y
ork
		
Springer
V
erlag

I
Babu
"
sk
a
A
Miller
and
M
V
ogelius
Adaptiv
e
metho
ds
and
error
estimation
for
elliptic
problems
of
structural
mec
hanics
In
I
Babu
"
sk
a
J
Chandra
and
JE
Fla
hert
y

editors
A
daptive
Computational
Metho
ds
for
Partial
Dier
ential
Equations
pages
#
Philadelphia
	
SIAM

I
Babu
"
sk
a
and
Suri
The
optimal
con
v
ergence
rate
of
the
p
v
ersion
of
the
nite
elemen
t
metho
d
SIAM
Journal
on
Numeric
al
A
nalysis
#
	

I
Babu
"
sk
a
OC
Zienkiewicz
J
Gago
and
ER
de
A
Oliv
eira
editors
Ac
cur
acy
Estimates
and
Adaptive
Renements
in
Finite
Element
Computations
John
Wiley
and
Sons
Chic
hester
	
	
RE
Bank
The
ecien
t
implemen
tation
of
lo
cal
mesh
renemen
t
algorithms
In
I
Babu
"
sk
a
J
Chandra
and
JE
Flahert
y

editors
Adaptive
Computational
Metho
ds
for
Partial
Dier
ential
Equations
pages
#
Philadelphia
	
SIAM



Adaptiv
e
Finite
Elemen
t
T
ec
hniques

RE
Bank
PL
TMG
A
Softwar
e
Package
for
Solving
El
liptic
Partial
Dier
ential
Equations
Users
Guide

v
olume

of
F
r
ontiers
in
Applie
d
Mathematics
SIAM
Philadelphia
		

RE
Bank
AH
Sherman
and
A
W
eiser
Renemen
t
algorithms
and
data
struc
tures
for
regular
lo
cal
mesh
renemen
t
In
Scientic
Computing
pages
#
Brus
sels
	
IMA
CS	North
Holland

MJ
Berger
and
J
Oliger
Adaptiv
e
mesh
renemen
t
for
h
yp
erb
olic
partial
dier
en
tial
equations
Journal
of
Computational
Physics
#
	

MW
Bern
JE
Flahert
y

and
M
Luskin
editors
Grid
Gener
ation
and
A
daptive
A
lgorithms
v
olume

of
The
IMA
V
olumes
in
Mathematics
and
its
Applic
ations
New
Y
ork
			
Springer

R
Bisw
as
KD
Devine
and
JE
Flahert
y

P
arallel
adaptiv
e
nite
elemen
t
metho
ds
for
conserv
ation
la
ws
Applie
d
Numeric
al
Mathematics
#
		

K
Clark
JE
Flahert
y

and
MS
Shephard
editors
Applie
d
Numeric
al
Mathemat
ics
v
olume

		
Sp
ecial
Issue
on
Adaptiv
e
Metho
ds
for
P
artial
Dieren
tial
Equations

K
Devine
and
JE
Flahert
y

P
arallel
adaptiv
e
hp
renemen
t
tec
hniques
for
conser
v
ation
la
ws
Applie
d
Numeric
al
Mathematics
#
		

M
Dindar
MS
Shephard
JE
Flahert
y

and
K
Jansen
Adaptiv
e
cfd
analysis
for
rotorcraft
aero
dynamics
Computer
Metho
ds
in
Applied
Mec
hanics
Engineering
submitted
			

DB
Duncan
editor
Applie
d
Numeric
al
Mathematics
v
olume

		
Sp
ecial
Issue
on
Grid
Adaptation
in
Computational
PDEs
Theory
and
Applications
	
JE
Flahert
y

R
Lo
y

MS
Shephard
BK
Szymanski
J
T
eresco
and
L
Zian
tz
Adaptiv
e
lo
cal
renemen
t
with
o
ctree
load
balancing
for
the
parallel
solution
of
three
dimensional
conserv
ation
la
ws
Par
al
lel
and
Distribute
d
Computing
		
to
app
ear

JE
Flahert
y
and
P
K
Mo
ore
In
tegrated
space
time
adaptiv
e
hp
renemen
t
meth
o
ds
for
parab
olic
systems
Applie
d
Numeric
al
Mathematics
#
		

JE
Flahert
y

P
J
P
aslo
w
MS
Shephard
and
JD
V
asilakis
editors
A
daptive
metho
ds
for
Partial
Dier
ential
Equations
Philadelphia
		
SIAM


p
and
hpRenemen
t


W
Gui
and
I
Babu
"
sk
a
The
h
p
and
h
p
v
ersion
of
the
nite
elemen
t
metho
d
in

dimension
Part

The
error
analysis
of
the
p
v
ersion
Numerische
Mathematik
#
	

W
Gui
and
I
Babu
"
sk
a
The
h
p
and
h
p
v
ersion
of
the
nite
elemen
t
metho
d
in

dimension
Part

The
error
analysis
of
the
h
and
h
p
v
ersion
Numerische
Mathematik
#
	

W
Gui
and
I
Babu
"
sk
a
The
h
p
and
h
p
v
ersion
of
the
nite
elemen
t
metho
d
in

dimension
Part

The
adaptiv
e
h
p
v
ersion
Numerische
Mathematik
#
	

W
Guo
and
I
Babu
"
sk
a
The
h
p
v
ersion
of
the
nite
elemen
t
metho
d
Part

The
basic
appro
ximation
results
Computational
Me
chanics
#
	

W
Guo
and
I
Babu
"
sk
a
The
h
p
v
ersion
of
the
nite
elemen
t
metho
d
Part

General
results
and
applications
Computational
Me
chanics
#
	

C
Meszten
yi
and
W
Szymczak
FEARS
users
man
ual
for
UNIV
A
C

T
ec
hnical
Rep
ort
Note
BN
		
Institute
for
Ph
ysical
Science
and
T
ec
hnology

Univ
ersit
y
of
Maryland
College
P
ark
	

WR
Mitc
hell
Unie
d
Multilevel
A
daptive
Finite
Element
Metho
ds
for
El
liptic
Pr
oblems
PhD
thesis
Univ
ersit
y
of
Illinois
at
Urbana
Champagne
Urbana
	
	
P
K
Mo
ore
and
JE
Flahert
y

Adaptiv
e
lo
cal
o
v
erlapping
grid
metho
ds
for
parab
olic
systems
in
t
w
o
space
dimensions
Journal
of
Computational
Physics
	#
		

JT
Oden
W
W
u
and
M
Ainsw
orth
Three
step
h
p
adaptiv
e
strategy
for
the
in
compressible
Na
vier
Stok
es
equations
In
I
Babu
"
sk
a
JE
Flahert
y

WD
Hensha
w
JE
Hop
croft
JE
Oliger
and
T
T
ezduy
ar
editors
Mo
deling	
Mesh
Gener
ation	
and
A
daptive
Numeric
al
Metho
ds
for
Partial
Dier
ential
Equations
v
olume

of
The
IMA
V
olumes
in
Mathematics
and
its
Applic
ations
pages
#
New
Y
ork
		
Springer
V
erlag

W
Rac
ho
wicz
JT
Oden
and
L
Demk
o
wicz
T
o
w
ard
a
univ
ersal
h
p
adaptiv
e
nite
elemen
t
strategy

Part

design
of
h
p
meshes
Computer
Metho
ds
in
Applie
d
Me
chanics
and
Engine
ering
#
		

E
Rank
and
I
Babu
"
sk
a
An
exp
ert
system
for
the
optimal
mesh
design
in
the
hp
v
ersion
of
the
nite
elemen
t
metho
d
International
Journal
of
Numeric
al
metho
ds
in
Engine
ering
#
	


Adaptiv
e
Finite
Elemen
t
T
ec
hniques

MC
Riv
ara
Design
and
data
structures
of
a
fully
adaptiv
e
m
ultigrid
nite
elemen
t
soft
w
are
A
CM
T
r
ansactions
on
Mathematic
al
Softwar
e
#
	

MC
Riv
ara
Mesh
renemen
t
pro
cesses
based
on
the
generalized
bisection
of
sim
plices
SIAM
Journal
on
Numeric
al
A
nalysis
#
	

IG
Rosen
b
erg
and
F
Stenger
A
lo
w
er
b
ound
on
the
angles
of
triangles
constructed
b
y
bisecting
the
longest
side
Mathematics
of
Computation
		#	
	

C
Sc
h
w
ab
P
A
nd
Hp
Finite
Element
Metho
ds
The
ory
and
Applic
ations
in
Solid
and
Fluid
Me
chanics
Numerical
Mathematics
and
Scien
tic
Computation
Claren
don
London
			

EG
Sew
ell
A
utomatic
Gener
ation
of
T
riangulations
for
Pie
c
ewise
Polynomial
Ap
pr
oximation
PhD
thesis
Purdue
Univ
ersit
y

W
est
Lafa
y
ette
	

MS
Shephard
JE
Flahert
y

CL
Bottasso
HL
de
Cougn
y

and
C
$
Ozturan
P
ar
allel
automatic
mesh
generation
and
adaptiv
e
mesh
con
trol
In
M
P
apadrak
akis
editor
Solving
L
ar
ge
Sc
ale
Pr
oblems
in
Me
chanics
Par
al
lel
and
Distribute
d
Com
puter
Applic
ations
pages
	#	
Chic
hester
		
John
Wiley
and
Sons
	
B
Szab!
o
Mesh
design
for
the
p
v
ersion
of
the
nite
elemen
t
metho
d
Computer
Metho
ds
in
Applie
d
Me
chanics
and
Engine
ering
#	
	

B
Szab!
o
and
I
Babu
"
sk
a
Finite
Element
A
nalysis
John
Wiley
and
Sons
New
Y
ork
		

R
V
erf
$
urth
A
R
eview
of
Posteriori
Err
or
Estimation
and
A
daptive
Mesh
R
enement
T
e
chniques
T
eubner
Wiley

Stuttgart
		

H
Zhang
MK
Moallemi
and
V
Prasad
A
n
umerical
algorithm
using
m
ultizone
grid
generation
for
m
ultiphase
transp
ort
pro
cesses
with
mo
ving
and
free
b
oundaries
Numeric
al
He
at
T
r
ansfer
B			#
		

OC
Zienkiewicz
and
JZ
Zh
u
Adaptiv
e
tec
hniques
in
the
nite
elemen
t
metho
d
Communic
ations
in
Applie
d
Numeric
al
Metho
ds
	#
	

Chapter
	
P
arab
olic
Problems
	
In
tro
duction
The
nite
elemen
t
metho
d
ma
y
b
e
used
to
solv
e
timedep
enden
t
problems
as
w
ell
as
steady
ones
This
eort
in
v
olv
es
b
oth
parab
olic
and
h
yp
erb
olic
partial
dieren
tial
sys
tems
Problems
of
parab
olic
t
yp
e
in
v
olv
e
diusion
and
dissipation
while
h
yp
erb
olic
problems
are
c
haracterized
b
y
conserv
ation
of
energy
and
w
a
v
e
propagation
Simple
onedimensional
heat
conduction
and
w
a
v
e
propagation
equations
will
serv
e
as
mo
del
problems
of
eac
h
t
yp
e
Example
	
The
onedimensional
heat
conduction
equation
u
t

pu
xx

a

x

b
t


	a
where
p
is
a
p
ositiv
e
constan
t
called
the
diusivit
y

is
of
parab
olic
t
yp
e
Initialb
oundary
v
alue
problems
consist
of
determining
ux
t
satisfying
	a
giv
en
the
initial
data
ux


u

x

a

x

b
	b
and
appropriate
b
oundary
data
eg
pu
x
a
t



ua
t



t

pu
x
b
t



ub
t



t

	c
As
with
elliptic
problems
b
oundary
conditions
without
the
pu
x
term
are
called
Diric
hlet
conditions
those
with

i


i



are
Neumann
conditions
and
those
with
b
oth
terms
presen
t
are
called
Robin
conditions
The
problem
domain
is
op
en
in
the
time
direction
t
th
us
unlik
e
elliptic
systems
this
problem
is
ev
olutionary
and
computation
con
tin
ues
in
t
for
as
long
as
there
is
in
terest
in
the
solution
Example
	
The
onedimensional
w
a
v
e
equation
u
tt

c

u
xx

a

x

b
t


	a



P
arab
olic
Problems
where
c
is
a
constan
t
called
the
w
a
v
e
sp
eed
is
a
h
yp
erb
olic
partial
dieren
tial
equation
Initialb
oundary
v
alue
problems
consist
of
determining
ux
t
satisfying
	a
giv
en
the
initial
data
ux


u

x

u
t
x



u

x

a

x

b
	b
and
b
oundary
data
of
the
form
	c

Small
transv
erse
vibrations
of
a
taut
string
satisfy
the
w
a
v
e
equation
In
this
case
ux
t
is
the
transv
erse
displacemen
t
of
the
string
and
c


T

T
b
eing
the
applied
tension
and

b
eing
the
densit
y
of
the
string
W
ell
study
parab
olic
problems
in
this
c
hapter
and
h
yp
erb
olic
problems
in
the
next
W
e
shall
see
that
there
are
t
w
o
basic
nite
elemen
t
approac
hes
to
solving
timedep
enden
t
problems
The
rst
called
the
metho
d
of
lines
uses
nite
elemen
ts
in
space
and
ordinary
dieren
tial
equations
soft
w
are
in
time
The
second
uses
nite
elemen
t
metho
ds
in
b
oth
space
and
time
W
ell
examine
the
metho
d
of
lines
approac
h
rst
and
then
tac
kle
space
time
nite
elemen
t
metho
ds
	
SemiDiscrete
Galerkin
Problems
The
Metho
d
of
Lines
Let
us
consider
a
parab
olic
problem
of
the
form
u
t

Lu

f
x
y


x
y



t


	a
where
L
is
a
secondorder
elliptic
op
erator
In
t
w
o
dimensions
u
w
ould
b
e
a
function
of
x
y

and
t
and
Lu
could
b
e
the
v
ery
familiar
Lu

pu
x

x

pu
y

y

q
u
	b
Appropriate
initial
and
b
oundary
conditions
w
ould
also
b
e
needed
eg
ux
y



u

x
y


x
y




	

	c
ux
y

t


x
y

t

x
y


	

E

	d
pu
n


u



x
y


	

N

	e
W
e
construct
a
Galerkin
form
ulation
of
	
in
space
in
the
usual
manner
th
us
w
e
m
ultiply
	a
b
y
a
suitable
test
function
v
and
in
tegrate
the
result
o
v
er

to
obtain
v

u
t


v

Lu

v

f



	
SemiDiscrete
Galerkin
Problems

As
usual
w
e
apply
the
div
ergence
theorem
to
the
secondderiv
ativ
e
terms
in
L
to
reduce
the
con
tin
uit
y
requiremen
ts
on
u
When
L
has
the
form
of
	b

the
Galerkin
problem
consists
of
determining
u

H

E

t


suc
h
that
v

u
t


Av

u

v

f



v




u

v

H



t


	a
The
L

inner
pro
duct
strain
energy

and
b
oundary
inner
pro
duct
are
as
with
elliptic
problems
v

f


Z
Z

v
f
dxdy

	b
Av

u

Z
Z

pv
x
u
x

v
y
u
y


v
q
udxdy

	c
and

v

pu
n

Z


N
v
pu
n
ds
	d
The
natural
b
oundary
condition
	e
has
b
een
used
to
replace
pu
n
in
the
b
oundary
inner
pro
duct
Except
for
the
presence
of
the
v

u
t

term
the
form
ulation
app
ears
to
the
same
as
for
an
elliptic
problem
Initial
conditions
for
	a
are
usually
determined
b
y
pro
jection
of
the
initial
data
	c
either
in
L

v

u

v

u



v

H



t


	a
or
in
strain
energy
Av

u

Av

u



v

H



t


	b
Example
	
W
e
analyze
the
onedimensional
heat
conduction
problem
u
t

pu
x

x

f
x
t



x


t


ux


u

x



x


u
t

u
t


t


thoroughly
in
the
spirit
that
w
e
did
in
Chapter

for
a
t
w
op
oin
t
b
oundary
v
alue
problem
A
Galerkin
form
of
this
heatconduction
problem
consists
of
determining
u

H


satisfying
v

u
t


Av

u

v

f


v

H



t




P
arab
olic
Problems
x
0 = x
x
x
x
U(x,t)
0
N-1
N
1
j
x   = 1
c
c
c
j
1
N-1
Figure
	
Mesh
for
the
nite
elemen
t
solution
of
Example
	
v

u

v

u



v

H



t


where
Av

u

Z


v
x
pu
x
dx
Boundary
terms
of
the
form
	d
disapp
ear
b
ecause
v


at
x



with
Diric
hlet
data
W
e
in
tro
duce
a
mesh
on


x


as
sho
wn
in
Figure
	
and
c
ho
ose
an
appro
xi
mation
U
of
u
in
a
nitedimensional
subspace
S
N

of
H


ha
ving
the
form
U
x
t

N

X
j

c
j
t

j
x

Unlik
e
steady
problems
the
co
ecien
ts
c
j

j







N


dep
end
on
t
The
Galerkin
nite
elemen
t
problem
is
to
determine
U

S
N

suc
h
that

j

U
t


A
j

U



j

f


t



j

U



j

u



t


j







N


Let
us
c
hose
a
piecewiselinear
p
olynomial
basis

k
x






xx
k

x
k
x
k


if
x
k


x

x
k
x
k

x
x
k

x
k

if
x
k

x

x
k


otherwise

This
problem
is
v
ery
similar
to
the
onedimensional
elliptic
problem
considered
in
Section

so
w
ell
skip
sev
eral
steps
and
also
construct
the
discrete
equations
b
y
v
ertices
rather
than
b
y
elemen
ts

	
SemiDiscrete
Galerkin
Problems

Since

j
has
supp
ort
on
the
t
w
o
elemen
ts
con
taining
no
de
j
w
e
ha
v
e
A
j

U


Z
x
j
x
j



j
pU
x
dx

Z
x
j

x
j


j
pU
x
dx
where




d

dx
Substituting
for

j
and
U
x
A
j

U


Z
x
j
x
j


h
j
px

c
j

c
j

h
j

dx

Z
x
j

x
j


h
j

px

c
j


c
j
h
j


dx
where
h
j

x
j

x
j


Using
the
midp
oin
t
rule
to
ev
aluate
the
in
tegrals
w
e
ha
v
e
A
j

U


p
j

h
j
c
j

c
j



p
j

h
j

c
j


c
j

where
p
j


px
j



Similarly


j

U
t


Z
x
j
x
j


j
U
t
dx

Z
x
j

x
j

j
U
t
dx
or

j

U
t


Z
x
j
x
j


j


c
j


j



c
j

j

dx

Z
x
j

x
j

j


c
j

j


c
j


j


dx
where




d

dt
Since
the
in
tegrands
are
quadratic
functions
of
x
they
ma
y
b
e
in
tegrated
exactly
using
Simpsons
rule
to
yield

j

U
t


h
j



c
j




c
j


h
j




c
j


c
j



Finally


j

f


Z
x
j
x
j


j
f
x
dx

Z
x
j

x
j

j
f
x
dx
Although
in
tegration
of
order
one
w
ould
do
w
ell
once
again
use
Simpsons
rule
to
obtain

j

f


h
j

f
j


f
j


h
j


f
j

f
j



W
e
could
replace
f
j

b
y
the
a
v
erage
of
f
j

and
f
j
to
obtain
a
similar
form
ula
to
the
one
obtained
for

j

U
t


th
us

j

f


h
j

f
j


f
j


h
j


f
j

f
j



Com
bining
these
results
yields
the
discrete
nite
elemen
t
system
h
j



c
j




c
j


h
j




c
j


c
j



p
j

h
j
c
j

c
j



p
j

h
j


c
j


c
j



P
arab
olic
Problems

h
j

f
j


f
j


h
j


f
j

f
j



j







N


W
e
ha
v
e
dropp
ed
the

and
written
the
equation
as
an
equalit
y

If
p
is
constan
t
and
the
mesh
spacing
h
is
uniform
w
e
obtain
h



c
j




c
j


c
j



p
h
c
j


c
j

c
j



h

f
j


f
j

f
j



j







N


The
discrete
systems
ma
y
b
e
written
in
matrix
form
and
for
simplicit
y

w
ell
do
so
for
the
constan
t
co
ecien
t
uniform
mesh
case
to
obtain
M

c

Kc

l
	a
where
M

h



































	b
K

p
h


































	c
l

h






f


f


f

f


f


f




f
N


f
N


f
N






	d
c

c


c






c
N


T

	e
The
matrices
M
K
and
l
are
the
global
mass
matrix
the
global
stiness
matrix
and
the
global
load
v
ector
Actually

M
has
little
to
do
with
mass
and
should
more
correctly
b
e
called
a
global
dissipation
matrix
ho
w
ev
er
w
ell
sta
y
with
our
prior
terminology

In
practical
problems
elemen
tb
yelemen
t
assem
bly
should
b
e
used
to
construct
global
matrices
and
v
ectors
and
not
the
no
dal
approac
h
used
here
The
discrete
nite
elemen
t
system
	
is
an
implicit
system
of
ordinary
dieren
tial
equations
for

c
The
mass
matrix
M
can
b
e
lump
ed
b
y
a
v
ariet
y
of
tric
ks
to
yield
an

	
SemiDiscrete
Galerkin
Problems

explicit
ordinary
dieren
tial
system
One
suc
h
tric
k
is
to
appro
ximate

j

U
t

b
y
using
the
righ
trectangular
rule
on
eac
h
elemen
t
to
obtain

j

U
t


Z
x
j
x
j


j


c
j


j



c
j

j

dx

Z
x
j

x
j

j


c
j

j


c
j


j


dx

hc
j

The
resulting
nite
elemen
t
system
w
ould
b
e
hI

c

Kc

l
Recall
cf
Section


that
a
onep
oin
t
quadrature
rule
is
satisfactory
for
the
con
v
er
gence
of
a
piecewiselinear
p
olynomial
nite
elemen
t
solution
With
the
initial
data
determined
b
y
L

pro
jection
on
to
S
N
E

w
e
ha
v
e

j

U





j

u



j







N


Numerical
in
tegration
will
t
ypically
b
e
needed
to
ev
aluate

j

u


and
w
ell
appro
ximate
it
in
the
manner
used
for
the
loading
term

j

f


Th
us
with
uniform
spacing
w
e
ha
v
e
Mc

u


h






u



u



u


u



u



u





u

N


u

N


u

N






	f
If
the
initial
data
is
consisten
t
with
the
trivial
Diric
hlet
b
oundary
data
ie
if
u


H


then
the
ab
o
v
e
system
reduces
to
c
j


u

x
j


j








N


Had
w
e
solv
ed
the
w
a
v
e
equation
	
instead
of
the
heat
equation
	
using
a
piecewiselinear
nite
elemen
t
basis
w
e
w
ould
ha
v
e
found
the
discrete
system
M

c

Kc


	
with
p
in
	c
replaced
b
y
c


The
resulting
initial
v
alue
problems
IVPs
for
the
ordinary
dieren
tial
equations
ODEs
	a
or
	
t
ypically
ha
v
e
to
b
e
in
tegrated
n
umerically

There
are
sev
eral
excellen
t
soft
w
are
pac
k
ages
for
solving
IVPs
for
ODEs
When
suc
h
ODE
soft
w
are
is
used
with
a
nite
elemen
t
or
nite
dierence
spatial
discretization
the
resulting
pro
cedure
is
called
the
metho
d
of
lines
Th
us
the
no
des
of
the
nite
elemen
ts
app
ear
to
b
e
lines
in
the
time
direction
and
as
sho
wn
in
Figure
	
for
a
onedimensional
problem
the
temp
oral
in
tegration
pro
ceeds
along
these
lines


P
arab
olic
Problems
x
0 = x
x
x
x
0
N-1
N
1
j
x   = 1
t
Figure
	
Lines
for
a
metho
d
of
lines
in
tegration
of
a
onedimensional
problem
Using
the
ODE
soft
w
are
solutions
are
calculated
in
a
series
of
time
steps

t


t


t






Metho
ds
fall
in
to
t
w
o
t
yp
es
Those
that
only
require
kno
wledge
of
the
so
lution
at
time
t
n
in
order
to
obtain
a
solution
at
time
t
n
are
called
onestep
metho
ds
Corresp
ondingly

metho
ds
that
require
information
ab
out
the
solution
at
t
n
and
sev
eral
times
prior
to
t
n
are
called
multistep
metho
ds
Excellen
t
texts
on
the
sub
ject
are
a
v
ailable






Onestep
metho
ds
are
RungeKutta
metho
ds
while
the
common
m
ultistep
metho
ds
are
Adams
or
bac
kw
ard
dierence
metho
ds
Soft
w
are
based
on
these
metho
ds
automatically
adjusts
the
time
steps
and
ma
y
also
automatically
v
ary
the
order
of
accu
racy
of
a
class
of
metho
ds
in
order
to
satisfy
a
prescrib
ed
lo
cal
error
tolerance
minimize
computational
cost
and
main
tain
n
umerical
eciency

The
c
hoice
of
a
onestep
or
m
ultistep
metho
d
will
dep
end
on
sev
eral
factors
Gener
ally

RungeKutta
metho
ds
are
preferred
when
time
in
tegration
is
simple
relativ
e
to
the
spatial
solution
Multistep
metho
ds
b
ecome
more
ecien
t
for
complex
nonlinear
prob
lems
Implicit
RungeKutta
metho
ds
ma
y
b
e
ecien
t
for
problems
with
highfrequency
oscillations
The
ODEs
that
arise
from
the
nite
elemen
t
discretization
of
parab
olic
problems
are
sti



so
bac
kw
ard
dierence
metho
ds
are
the
preferred
m
ultistep
metho
ds
Most
ODE
soft
w
are



addresses
rstorder
IVPs
of
the
explicit
form

y
t

f
t
y
t


y


y


	
Secondorder
systems
suc
h
as
	
w
ould
ha
v
e
to
b
e
written
as
a
rstorder
system
b
y

eg
letting
d


c

	
SemiDiscrete
Galerkin
Problems
	
and
hence
obtaining


c
M

d



d
Kc


Unfortunately

systems
ha
ving
the
form
of
	a
or
the
one
ab
o
v
e
are
implicit
and
w
ould
require
in
v
erting
or
lumping
M
in
order
to
put
them
in
to
the
standard
explicit
form
	

In
v
erting
M
is
not
terribly
dicult
when
M
is
constan
t
or
indep
enden
t
of
t
ho
w
ev
er
it
w
ould
b
e
inecien
t
for
nonlinear
problems
and
imp
ossible
when
M
is
singular
The
latter
case
can
o
ccur
when
eg
a
heat
conduction
and
a
p
oten
tial
problem
are
solv
ed
sim
ultaneously

Co
des
for
dieren
tialalgebraic
equations
D
AEs
directly
address
the
solution
of
im
plicit
systems
of
the
form
f
t
y
t


y
t



y


y


	
One
of
the
b
est
of
these
is
the
co
de
D
ASSL
written
b
y
P
etzold

D
ASSL
uses
v
ariable
step
v
ariableorder
bac
kw
ard
dierence
metho
ds
to
solv
e
problems
without
needing
M

to
exist
Let
us
illustrate
these
concepts
b
y
applying
some
simple
onestep
sc
hemes
to
problems
ha
ving
the
forms
	
or
	

Ho
w
ev
er
implemen
tation
of
these
simple
metho
ds
is
only
justied
in
certain
sp
ecial
circumstances
In
most
cases
it
is
far
b
etter
to
use
existing
ODE
soft
w
are
in
a
metho
d
of
lines
framew
ork
F
or
simplicit
y

w
ell
assume
that
all
b
oundary
data
is
homogeneous
so
that
the
b
ound
ary
inner
pro
duct
in
	a
v
anishes
Selecting
a
nitedimensional
space
S
N

	
H



w
e
then
determine
U
as
the
solution
of
V

U
t


AV

U


V

f


v

S
N


	
Ev
aluation
leads
to
ODEs
ha
ving
the
form
of
	a
regardless
of
whether
or
not
the
system
is
onedimensional
or
the
co
ecien
ts
are
constan
t
The
actual
matrices
M
and
K
and
load
v
ector
l
will
of
course
dier
from
those
of
Example
	
in
these
cases
The
systems
	a
or
	
are
called
semidiscr
ete
Galerkin
e
quations
b
ecause
time
has
not
y
et
b
een
discretized
W
e
discretize
time
in
to
a
sequence
of
time
slices
t
n

t
n

of
duration
t
with
t
n

nt
n







F
or
this
discussion
no
generalit
y
is
lost
b
y
considering
uniform
time
steps
Let

ux
t
n

b
e
the
exact
solution
of
the
Galerkin
problem
	a
at
t

t
n


U
x
t
n

b
e
the
exact
solution
of
the
semidiscrete
Galerkin
problem
	
at
t

t
n


U
n
x
b
e
the
appro
ximation
of
U
x
t
n

obtained
b
y
ODE
soft
w
are


P
arab
olic
Problems

c
j
t
n

b
e
the
Galerkin
co
ecien
t
at
t

t
n

th
us
for
a
onedimensional
problem
U
x
t
n


N

X
j

c
j
t
n


j
x

F
or
a
Lagrangian
basis
c
j
t
n


U
x
j

t
n



c
n
j
b
e
the
appro
ximation
of
c
j
t
n

obtained
b
y
ODE
soft
w
are
F
or
a
onedimensional
problem
U
n
x

N

X
j

c
n
j

j
x

W
e
supp
ose
that
all
solutions
are
kno
wn
at
time
t
n
and
that
w
e
seek
to
determine
them
at
time
t
n

The
simplest
n
umerical
sc
heme
for
doing
this
is
the
forw
ard
Euler
metho
d
where
	
is
ev
aluated
at
time
t
n
and
U
t
x
t
n


U
n
x

U
n
x
t

		
A
simple
T
a
ylors
series
argumen
t
rev
eals
that
the
lo
cal
discretization
error
of
suc
h
an
appro
ximation
is
O
t

Substituting
		
in
to
	
yields
V

U
n

U
n
t


AV

U
n


V

f
n


v

S
N


	a
Ev
aluation
of
the
inner
pro
ducts
leads
to
M
c
n

c
n
t

K
n
c
n

l
n

	b
W
e
ha
v
e
allo
w
ed
the
stiness
matrix
and
load
v
ector
to
b
e
functions
of
time
The
mass
matrix
w
ould
alw
a
ys
b
e
indep
enden
t
of
time
for
dieren
tial
equations
ha
ving
the
explicit
form
of
	a
as
long
as
the
spatial
nite
elemen
t
mesh
do
es
not
v
ary
with
time
The
ODEs
	ab
are
implicit
unless
M
is
lump
ed
If
lumping
w
ere
used
and
eg
M

hI
then
c
n
w
ould
b
e
determined
as
c
n

c
n

t
h
l
n

K
n
c
n

Assuming
that
c
n
is
kno
wn
w
e
can
determine
c
n
b
y
in
v
erting
M
Using
the
bac
kw
ard
Euler
metho
d
w
e
ev
aluate
	
at
t
n
and
use
the
appro
xi
mation
		
to
obtain
V

U
n

U
n
t


AV

U
n


V

f
n


v

S
N


	a

	
SemiDiscrete
Galerkin
Problems

and
M
c
n

c
n
t

K
n
c
n

l
n

	b
The
bac
kw
ard
Euler
metho
d
is
implicit
regardless
of
whether
or
not
lumping
is
used
Computation
of
c
n
requires
in
v
ersion
of

t
M

K
n

The
most
p
opular
of
these
simple
sc
hemes
uses
a
w
eigh
ted
a
v
erage
of
the
forw
ard
and
bac
kw
ard
Euler
metho
ds
with
w
eigh
ts
of



and


resp
ectiv
ely

Th
us
V

U
n

U
n
t






AV

U
n



AV

U
n






V

f
n



V

f
n


V

S
N


	a
and
M
c
n

c
n
t





K
n
c
n


K
n
c
n





l
n


l
n

	b
The
forw
ard
and
bac
kw
ard
Euler
metho
ds
are
reco
v
ered
b
y
setting



and

resp
ec
tiv
ely

Let
us
regroup
terms
in
v
olving
c
n
and
c
n
in
	b
to
obtain
M


tK
n
c
n

M





tK
n
c
n

t



l
n


l
n

	c
Th
us
determination
of
c
n
requires
in
v
ersion
of
M


tK
n

In
one
dimension
this
system
w
ould
t
ypically
b
e
tridiagonal
as
with
Example
	
In
higher
dimensions
it
w
ould
b
e
sparse
Th
us
explicit
in
v
ersion
w
ould
nev
er
b
e
p
erformed
W
e
w
ould
just
solv
e
the
sparse
system
	c
for
c
n

T
a
ylors
series
calculations
rev
eal
that
the
global
discretization
error
is
kct
n


c
n
k

O
t
for
almost
all
c
hoices
of





The
sp
ecial
c
hoice



yields
the
CrankNicolson
metho
d
whic
h
has
a
discretization
error
kct
n


c
n
k

O
t



The
foregoing
discussion
in
v
olv
ed
onestep
metho
ds
Multistep
metho
ds
are
also
used
to
solv
e
timedep
enden
t
nite
elemen
t
problems
and
w
ell
describ
e
them
for
an
ODE
in


P
arab
olic
Problems
the
implicit
form
	

The
p
opular
bac
kw
ard
dierence
form
ulas
BDFs
appro
ximate
y
t
in
	
b
y
a
k
th
degree
p
olynomial
Y
t
that
in
terp
olates
y
at
the
k


times
t
ni

i







k

The
deriv
ativ
e

y
is
appro
ximated
b
y

Y

The
Newton
bac
kw
ard
dierence
form
of
the
in
terp
olating
is
most
frequen
tly
used
to
represen
t
Y


but
since
w
ere
more
familiar
with
Lagrangian
in
terp
olation
w
ell
write
y
t

Y
t

k
X
i
y
ni
N
i
t

t

t
nk

t
n

	a
where
N
i
t

k
Y
j
j
i
t

t
nj
t
ni

t
nj

	b
The
basis
	b
is
represen
ted
b
y
the
usual
Lagrangian
shap
e
functions
cf
Section


so
N
i
t
nj



ij

Assuming
y
ni

i







k

to
b
e
kno
wn
the
unkno
wn
y
n
is
determined
b
y
collo
cation
at
t
n

Th
us
using
	
f
t
n

Y
t
n



Y
t
n




	
Example
	
The
simplest
BDF
form
ula
is
obtained
b
y
setting
k


in
	
to
obtain
Y
t

y
n
N

t

y
n
N

t

N

t

t

t
n
t
n

t
n

N

t

t

t
n
t
n

t
n

Dieren
tiating
Y
t

Y
t

y
n

y
n
t
n

t
n

th
us
the
n
umerical
metho
d
	
is
the
bac
kw
ard
Euler
metho
d
f
t
n

y
n

y
n

y
n
t
n

t
n



Example
	
The
secondorder
BDF
follo
ws
b
y
setting
k


in
	
to
get
Y
t

y
n
N

t

y
n
N

t

y
n
N

t
N

t

t

t
n

t

t
n

t


N

t

t

t
n

t

t
n

t


N

t

t

t
n

t

t
n

t


where
time
steps
are
of
duration
t

	
Finite
Elemen
t
Metho
ds
in
Time

Dieren
tiating
and
setting
t

t
n

N

t
n



t


N

t
n




t


N

t
n



t

Th
us

Y
t
n


y
n

y
n

y
n
t
and
the
secondorder
BDF
is
f
t
n

y
n

y
n

y
n

y
n
t



Applying
this
metho
d
to
	a
yields
M
c
n

c
n

c
n
t

K
n
c
n

l
n

Th
us
computation
of
c
n
requires
in
v
ersion
of
M
t

K
Bac
kw
ard
dierence
form
ulas
through
order
six
are
a
v
ailable






	
Finite
Elemen
t
Metho
ds
in
Time
It
is
of
course
p
ossible
to
use
the
nite
elemen
t
metho
d
in
time
This
can
b
e
done
on
spacetime
triangular
or
quadrilateral
elemen
ts
for
problems
in
one
space
dimension
on
hexahedra
tetrahedra
and
prisms
in
t
w
o
space
dimensions
and
on
fourdimensional
parallelepip
eds
and
prisms
in
three
space
dimensions
Ho
w
ev
er
for
simplicit
y

w
ell
fo
cus
on
the
time
asp
ects
of
the
spacetime
nite
elemen
t
metho
d
b
y
assuming
that
the
spatial
discretization
has
already
b
een
p
erformed
Th
us
w
ell
consider
an
ODE
system
in
the
form
	a
and
construct
a
Galerkin
problem
in
time
b
y
m
ultiplying
it
b
y
a
test
function
w

L

and
in
tegrating
on
t
n

t
n

to
obtain
w

M

c

n

w

Kc

n

w

l
n

w

L

t
n

t
n

	a
where
the
L

inner
pro
duct
in
time
is
w

c
n

Z
t
n
t
n
w
T
cdt
	b
Only
rst
deriv
ativ
es
are
in
v
olv
ed
in
	a

th
us
neither
the
trial
space
for
c
nor
the
test
space
for
w
ha
v
e
to
b
e
con
tin
uous
F
or
our
initial
metho
d
let
us
assume
that
ct
is
con
tin
uous
at
t
n

By
assumption
ct
n

is
kno
wn
in
this
case
and
hence
w
t
n





P
arab
olic
Problems
Example
	
Let
us
examine
the
metho
d
that
results
when
ct
and
w
t
are
linear
on
t
n

t
n

W
e
represen
t
ct
in
the
manner
used
for
a
spatial
basis
as
c


c
n
N
n



c
n
N
n


	a
where
N
n








N
n







	b
are
hat
functions
in
time
and


t

t
n

t
n
t
	c
denes
the
canonical
elemen
t
in
time
The
test
function
w

N
n









T
	d
v
anishes
at
t
n



and
is
linear
on
t
n

t
n


T
ransforming
the
in
tegrals
in
	a
to


using
	c
and
using
	abd
yields
w

M

c

n

t

Z






M
c
n

c
n
t
d

w

Kc

n

t

Z






Kc
n





c
n




d

Again
w
e
ha
v
e
written
equalit
y
instead
of

for
simplicit
y

Assuming
that
M
and
K
are
indep
enden
t
of
time
w
e
ha
v
e
w

M

c
n

M
c
n

c
n


w

Kc

n

t

Kc
n

c
n


Substituting
these
in
to
	a
M
c
n

c
n


t

Kc
n

c
n


t

Z






l

d
	a
or
if
l
is
appro
ximated
lik
e
c
M
c
n

c
n


t

Kc
n

c
n


t

l
n

l
n


	b
Regrouping
terms
M



tKc
n

M



tKc
n



tl
n

l
n

	c

	
Finite
Elemen
t
Metho
ds
in
Time

w
e
see
that
the
piecewiselinear
Galerkin
metho
d
in
time
is
a
w
eigh
ted
a
v
erage
sc
heme
	c
with



Th
us
at
least
to
this
lo
w
order
there
is
not
m
uc
h
dierence
b
e
t
w
een
nite
dierence
and
nite
elemen
t
metho
ds
Other
similarities
app
ear
in
Problem

at
the
end
of
this
section
Lo
worder
sc
hemes
suc
h
as
	
are
p
opular
in
nite
elemen
t
pac
k
ages
Our
pref
erence
is
for
BDF
or
implicit
RungeKutta
soft
w
are
that
con
trol
accuracy
through
au
tomatic
time
step
and
order
v
ariation
Implicit
RungeKutta
metho
ds
ma
y
b
e
deriv
ed
as
nite
elemen
t
metho
ds
b
y
using
the
Galerkin
metho
d
	
with
higherorder
trial
and
test
functions
Of
the
man
y
p
ossibilities
w
ell
examine
a
class
of
metho
ds
where
the
trial
function
ct
is
discon
tin
uous
Example
	
Supp
ose
that
ct
is
a
p
olynomial
on
t
n

t
n

with
jump
discon
ti
n
uities
at
t
n

n


When
w
e
need
to
distinguish
left
and
righ
t
limits
w
ell
use
the
notation
c
n

lim

ct
n



c
n

lim

ct
n



	a
With
jumps
at
t
n

w
ell
ha
v
e
to
b
e
more
precise
ab
out
the
temp
oral
inner
pro
duct
	b
and
w
ell
dene
u
v

n

lim

Z
t
n

t
n

uv
dt
u
v

n

lim

Z
t
n

t
n

uv
dt
	b
The
inner
pro
duct
u
v

n
ma
y
b
e
aected
b
y
discon
tin
uities
in
functions
at
t
n

but
u
v

n
only
in
v
olv
es
in
tegrals
of
smo
oth
functions
In
particular

u
v

n

u
v

n
when
ut
and
v
t
are
either
con
tin
uous
or
ha
v
e
jump
discon
tin
uities
at
t
n


u
v

n
exists
and
u
v

n


when
either
u
or
v
are
prop
ortional
to
the
delta
function

t

t
n


and

u
v

n
do
esnt
exist
while
v

u
n


when
b
oth
u
and
v
are
prop
ortional
to

t

t
n


Supp
ose
for
example
that
v
t
is
con
tin
uous
at
t
n
and
ut


t

t
n


Then
u
v

n

lim

Z
t
n

t
n


t

t
n

v
t
dt

v
t
n


The
delta
function
can
b
e
appro
ximated
b
y
a
smo
oth
function
that
dep
ends
on

as
w
as
done
in
Section

to
help
explain
this
result
Let
us
assume
that
w
t
is
con
tin
uous
and
write
ct
in
the
form
ct

c
n


 
ct

c
n
H
t

t
n

	a


P
arab
olic
Problems
where
H
t



if
t



otherwise
	b
is
the
He
aviside
function
and
 
c
is
a
p
olynomial
in
t
Dieren
tiating

ct


 
ct

c
n

t

t
n



 
c
t
H
t

t
n


	c
With
the
in
terpretation
that
inner
pro
ducts
in
	
are
of
t
yp
e
	

assume
that
w
t
is
con
tin
uous
and
use
	
in
	a
to
obtain
w
T
t
n

Mt
n

c
n

c
n


w

M

 
c

n

w

K
 
c

n

w

l
n

w

H


	
The
simplest
discon
tin
uous
Galerkin
metho
d
uses
a
piecewise
constan
t
p


basis
in
time
Suc
h
appro
ximations
are
obtained
from
	a
b
y
selecting
 
c
t

c
n

c
n	

T
esting
against
the
constan
t
function
w
t








T
and
assuming
that
M
and
K
are
indep
enden
t
of
t
	
b
ecomes
Mc
n	

c
n


Kc
n	
t

Z
t
n
t
n
lt
dt
The
result
is
almost
the
same
as
the
bac
kw
ard
Euler
form
ula
	b
except
that
the
load
v
ector
l
is
a
v
eraged
o
v
er
the
time
step
instead
of
b
eing
ev
aluated
at
t
n

With
a
linear
p


appro
ximation
for
 
ct

w
e
ha
v
e
 
ct

c
n
N
n
t

c
n	
N
n
t
where
N
ni

i



are
giv
en
b
y
	b

Selecting
the
basis
for
the
test
space
as
w
i
t

N
ni
t







T

i



assuming
that
M
and
K
are
indep
enden
t
of
t
and
substituting
the
ab
o
v
e
appro
ximations
in
to
	

w
e
obtain
Mc
n

c
n




Mc
n	

c
n


t

Kc
n

c
n	


Z
t
n
t
n
N
n
lt
dt

	
Finite
Elemen
t
Metho
ds
in
Time

and


Mc
n	

c
n


t

Kc
n

c
n	


Z
t
n
t
n
N
n
lt
dt
Simplifying
the
expressions
and
assuming
that
lt
can
b
e
appro
ximated
b
y
a
linear
function
on
t
n

t
n

yields
the
system
M
c
n

c
n	


c
n


t

Kc
n

c
n	


t

l
n

l
n	


M
c
n	

c
n


t

Kc
n

c
n	


t

l
n

l
n	


This
pair
of
equations
m
ust
b
e
solv
ed
sim
ultaneously
for
the
t
w
o
unkno
wn
solution
v
ectors
c
n
and
c
n	

This
is
an
implicit
RungeKutta
metho
d
Problems

Consider
the
Galerkin
metho
d
in
time
with
a
con
tin
uous
basis
as
represen
ted
b
y
	

Assume
that
the
solution
ct
is
appro
ximated
b
y
the
linear
function
	ac
on
t
n

t
n

as
in
Example
	
but
do
not
assume
that
the
test
space
w
t
is
linear
in
time

Sp
ecifying
w













T
and
assuming
that
M
and
K
are
indep
enden
t
ot
t
sho
w
that
	a
is
the
w
eigh
ted
a
v
erage
sc
heme
M


tKc
n

M





tKc
n

t



l
n


l
n

with


R





N

n


d
R





d

When
dieren
t
trial
and
test
spaces
are
used
the
Galerkin
metho
d
is
called
a
Petr
ovGalerkin
metho
d

The
en
tire
eect
of
the
test
function

t
is
isolated
in
the
w
eigh
ting
factor


F
urthermore
no
in
tegration
b
y
parts
w
as
p
erformed
so
that

t
need
not
b
e
con
tin
uous
Sho
w
that
the
c
hoices
of

t
listed
in
T
able
	
corresp
ond
to
the
cited
metho
ds

The
discon
tin
uous
Galerkin
metho
d
ma
y
b
e
deriv
ed
b
y
sim
ultaneously
discretizing
a
partial
dieren
tial
system
in
space
and
time
on


t

n
t
n	


This
form
ma
y
ha
v
e
adv
an
tages
when
solving
problems
with
rapid
dynamics
since
the
mesh
ma
y
b
e
either
mo
v
ed
or
regenerated
without
concern
for
main
taining
con
tin
uit
y


P
arab
olic
Problems
Sc
heme


F
orw
ard
Euler
	b






CrankNicolson
	b



!
CrankNicolson
	b

!
Bac
kw
ard
Euler
	b






Galerkin
	
N

n


!
T
able
	
T
est
functions

and
corresp
onding
metho
ds
for
the
nite
elemen
t
solution
of
	a
with
a
linear
trial
function
b
et
w
een
time
steps
Using
	a
as
a
mo
del
spatial
nite
elemen
t
form
ulation
assume
that
test
functions
v
x
y

t
are
con
tin
uous
but
that
trial
functions
ux
y

t
ha
v
e
jump
discon
tin
uities
at
t
n

Assume
Diric
hlet
b
oundary
data
and
sho
w
that
the
spacetime
discon
tin
uous
Galerkin
form
of
the
problem
is
v

u
t

S
T

v

t
n


u
t
n


u
t
n



A
S
T
v

u

v

f

S
T

v

H




t
n

t
n	



where
v

u
S
T

Z
t
n
t
n
Z
Z

v
udxdy
dt
and
A
S
T
v

u

v
x

pu
x

S
T

v
y

pu
y

S
T

v

q
u
S
T

In
this
form
the
nite
elemen
t
problem
is
solv
ed
on
the
threedimensional
strips


t
n

t
n	


n







	
Con
v
ergence
and
Stabilit
y
In
this
section
w
e
will
study
some
theoretical
prop
erties
of
the
discrete
metho
ds
that
w
ere
in
tro
duced
in
Sections
	
and
	
Ev
ery
nite
dierence
or
nite
elemen
t
sc
heme
for
time
in
tegration
should
ha
v
e
three
prop
erties

Consistency
the
discrete
system
should
b
e
a
go
o
d
appro
ximation
of
the
dieren
tial
equation

Conver
genc
e
the
solution
of
the
discrete
system
should
b
e
a
go
o
d
appro
ximation
of
the
solution
of
the
dieren
tial
equation

Stability
the
solution
of
the
discrete
system
should
not
b
e
sensitiv
e
to
small
p
er
turbations
in
the
data

	
Con
v
ergence
and
Stabilit
y
	
Somewhat
b
ecause
they
are
op
en
ended
nite
dierence
or
nite
elemen
t
appro
xi
mations
in
time
can
b
e
sensitiv
e
to
small
errors
eg
in
tro
duced
b
y
round
o
Let
us
illustrate
the
phenomena
for
the
w
eigh
ted
a
v
erage
sc
heme
	c
M


tKc
n

M





tKc
n

t



l
n


l
n

	
W
e
ha
v
e
assumed
for
simplicit
y

that
K
and
M
are
indep
enden
t
of
time
Sensitivit
y
to
small
p
erturbations
implies
a
lac
k
of
stabilit
y
as
expressed
b
y
the
fol
lo
wing
denition
Denition
	
A
nite
dierence
sc
heme
is
stable
if
a
p
erturbation
of
size
k
k
in
tro
duced
at
time
t
n
remains
b
ounded
for
subsequen
t
times
t

T
and
all
time
steps
t

t


W
e
ma
y
assume
without
loss
of
generalit
y

that
the
p
erturbation
is
in
tro
duced
at
time
t


Indeed
it
is
common
to
neglect
p
erturbations
in
the
co
ecien
ts
and
conne
the
analysis
to
p
erturbations
in
the
initial
data
Th
us
in
using
Denition
	
w
e
consider
the
solution
of
the
related
problem
M


tK
"
c
n

M





tK
"
c
n

t



l
n


l
n

"
c


c




Subtracting
	
from
the
p
erturb
ed
system
M


tK
n

M





tK
n






	a
where

n

"
c
n

c
n

	b
Th
us
for
linear
problems
it
suces
to
apply
Denition
	
to
a
homogeneous
v
ersion
of
the
dierence
sc
heme
ha
ving
the
p
erturbation
as
its
initial
condition
With
these
restrictions
w
e
ma
y
dene
stabilit
y
in
a
more
explicit
form
Denition
	
A
linear
dierence
sc
heme
is
stable
if
there
exists
a
constan
t
C


whic
h
is
indep
enden
t
of
t
and
suc
h
that
k
n
k

C
k

k
	
as
n


t


t

T



P
arab
olic
Problems
Both
Denitions
	
and
	
p
ermit
the
initial
p
erturbation
to
gro
w
but
only
b
y
a
b
ounded
amoun
t
Restricting
the
gro
wth
to
nite
times
t

T
ensures
that
the
denitions
apply
when
the
solution
of
the
dierence
sc
heme
c
n


as
n


When
applying
Denition
	
w
e
ma
y
visualize
a
series
of
computations
p
erformed
to
time
T
with
an
increasing
n
um
b
er
of
time
steps
M
of
shorterandshorter
duration
t
suc
h
that
T

M
t
As
t
is
decreased
the
p
erturbations

n

n







M

should
settle
do
wn
and
ev
en
tually
not
gro
w
to
more
than
C
times
the
initial
p
erturbation
Solutions
of
con
tin
uous
systems
are
often
stable
in
the
sense
that
ct
is
b
ounded
for
all
t


In
this
case
w
e
need
a
stronger
denition
of
stabilit
y
for
the
discrete
system
Denition
	
The
linear
dierence
sc
heme
	
is
absolutely
stable
if
k
n
k

k

k
	
Th
us
p
erturbations
are
not
p
ermitted
to
gro
w
at
all
Stabilit
y
analyses
of
linear
constan
t
co
ecien
t
dierence
equations
suc
h
as
	
in
v
olv
e
assuming
a
p
erturbation
of
the
form

n


n
r
	
Substituting
in
to
	a
yields
M


tK
n
r

M





tK
n
r
Assuming
that



and
M


tK
is
not
singular
w
e
see
that

is
an
eigen
v
alue
and
r
is
an
eigen
v
ector
of
M


tK

M





tKr
k


k
r
k

k







N

	
Th
us

n
will
ha
v
e
the
form
	
with



k
and
r

r
k
when
the
initial
p
erturbation



r
k

More
generally

the
solution
of
	a
is
the
linear
com
bination

n

N
X
k



k

k

n
r
k
	a
when
the
initial
p
erturbation
has
the
form



N
X
k



k
r
k

	b
Using
	a

w
e
see
that
	
will
b
e
absolutely
stable
when
j
k
j


k







N

	

	
Con
v
ergence
and
Stabilit
y

The
eigen
v
alues
and
eigen
v
ectors
of
man
y
tridiagonal
matrices
are
kno
wn
Th
us
the
analysis
is
often
straigh
t
forw
ard
for
onedimensional
problems
Analyses
of
t
w
o
and
threedimensional
problems
are
more
dicult
ho
w
ev
er
eigen
v
alueeigen
v
ector
pairs
are
kno
wn
for
simple
problems
on
simple
regions
Example
	
Consider
the
eigen
v
alue
problem
	
and
rearrange
terms
to
get
M


tK
k
r
k

M





tKr
k
or

k


Mr
k


k






tKr
k
or
Kr
k


k
Mr
k
where

k


k



k






t
Th
us

k
is
an
eigen
v
alue
and
r
k
is
an
eigen
v
ector
of
M

K
Let
us
supp
ose
that
M
and
K
corresp
ond
to
the
mass
and
stiness
matrices
of
the
onedimensional
heat
conduction
problem
of
Example
	
Then
using
	bc

w
e
ha
v
e

p
h

























r
k

r
k




r
k
N








k
h


























r
k

r
k




r
k
N







The
diusivit
y
p
and
mesh
spacing
h
ha
v
e
b
een
assumed
constan
t
Also
with
Diric
hlet
b
oundary
conditions
the
dimension
of
this
system
is
N


rather
than
N

It
is
dicult
to
see
in
the
ab
o
v
e
form
but
writing
this
eigen
v
alueeigen
v
ector
problem
in
comp
onen
t
form
p
h
r
j


r
j

r
j




k
h

r
j


r
j

r
j



j







N


w
e
ma
y
infer
that
the
comp
onen
ts
of
the
eigen
v
ector
are
r
k
j

sin
k

j
N

j







N


This
guess
of
r
k
ma
y
b
e
justied
b
y
the
similarit
y
of
the
discrete
eigen
v
alue
problem
to
a
con
tin
uous
one
ho
w
ev
er
w
e
will
not
attempt
to
do
this
Assuming
it
to
b
e
correct
w
e
substitute
r
k
j
in
to
the
eigen
v
alue
problem
to
nd
p
h
sin
k

j


N


sin
k

j
N

sin
k

j


N



P
arab
olic
Problems


k
h

sin
k

j


N


sin
k

j
N

sin
k

j


N


j







N


But
sin
k

j


N

sin
k

j


N


sin
k

j
N
cos
k

N
and
p
h
cos
k

N


sin
k

j
N


k
h

cos
k

N


sin
k

j
N

Hence

k


p
h



cos
k


N


cos
k


N




With
cos
k


N
ranging
on


w
e
see
that
ph



k


Determining

k
in
terms
of

k

k




k




t



k

t




k
t



k

t

W
e
w
ould
lik
e
j
k
j


for
absolute
stabilit
y

With

k


w
e
see
that
the
requiremen
t
that

k


is
automatically
satised
Demanding
the

k


yields
j
k
jt





If



then





and
the
ab
o
v
e
inequalit
y
is
satised
for
all
c
hoices
of

k
and
t
Metho
ds
of
this
class
are
unc
onditional
ly
absolutely
stable
When



w
e
ha
v
e
to
satisfy
the
condition
pt
h








If
w
e
view
this
last
relation
as
a
restriction
of
the
time
step
t
w
e
see
that
the
forw
ard
Euler
metho
d



has
the
smallest
time
step
Since
all
other
metho
ds
listed
in
T
able
	
are
unconditionally
stable
there
w
ould
b
e
little
v
alue
in
using
the
forw
ard
Euler
metho
d
without
lumping
the
mass
matrix
With
lumping
the
stabilit
y
restriction
of
the
forw
ard
Euler
metho
d
actually
impro
v
es
sligh
tly
to
pth



Let
us
no
w
turn
to
a
more
general
examination
of
stabilit
y
and
con
v
ergence
Lets
again
fo
cus
on
our
mo
del
problem
determine
u

H


satisfying
v

u
t


Av

u

v

f


v

H



t


		a
v

u

v

u



v

H



t


		b
The
semidiscrete
appro
ximation
consists
of
determining
U

S
N

	
H


suc
h
that
V

U
t


AV

U


V

f


V

S
N


t


	a

	
Con
v
ergence
and
Stabilit
y

V

U


V

u



V

S
N


t


	b
T
rivial
Diric
hlet
b
oundary
data
again
simplies
the
analysis
Our
rst
result
establishes
the
absolute
stabilit
y
of
the
nite
elemen
t
solution
of
the
semidiscrete
problem
	
in
the
L

norm
Theorem
	
L
et


S
N

satisfy
V


t


AV





V

S
N


t


	a
V




V





V

S
N


t


	b
Then
k


t
k


k

k


t


	c
R
emark

With

x
t
b
eing
the
dierence
b
et
w
een
t
w
o
solutions
of
	a
satis
fying
initial
conditions
that
dier
b
y


x

the
loading
V

f

v
anishes
up
on
subtraction
as
with
	


Pr
o
of
Replace
V
in
	a
b
y

to
obtain



t


A





or


d
dt
k
k



A





In
tegrating
k


t
k



k



k




Z
t

A



d

The
result
	c
follo
ws
b
y
using
the
initial
data
	b
and
the
nonnegativit
y
of
A




W
ev
e
discussed
stabilit
y
at
some
length
so
no
w
let
us
turn
to
the
concept
of
con
v
er
gence
Con
v
ergence
analyses
for
semidiscrete
Galerkin
appro
ximations
parallels
the
lines
of
those
for
elliptic
systems
Let
us
as
an
example
establish
con
v
ergence
for
piecewise
linear
solutions
of
	
to
solutions
of
		

Theorem
	
L
et
S
N

c
onsist
of
c
ontinuous
pie
c
ewiseline
ar
p
olynomials
on
a
family
of
uniform
meshes

h
char
acterize
d
by
their
maximum
element
size
h
Then
ther
e
exists
a
c
onstant
C


such
that
max
tT

ku

U
k


C


j
log
T
h

j
h

max
tT

kuk


	


P
arab
olic
Problems
Pr
o
of
Create
the
auxiliary
problem
determine
W

S
N

suc
h
that
V

W







AV

W







V

S
N





t

	a
W
x
y

t

E
x
y

t

U
x
y

t

"
U
x
y

t

	b
where
"
U

S
N

satises
AV

u




"
U







V

S
N





T

	c
W
e
see
that
W
satises
a
terminal
v
alue
problem
on




t
an
t
that
"
U
satises
an
elliptic
problem
with

as
a
parameter
Consider
the
iden
tit
y
d
d
W

E


W


E


W

E



In
tegrate
and
use
	b
kE


t
k



W

E





Z
t

W


E


W

E


d

Use
	a
with
V
replaced
b
y
E
kE


t
k



W

E





Z
t

AW

E


W

E


d

	
Setting
v
in
		
and
V
in
	
to
W
and
subtracting
yields
W

u


U



AW

u

U






W

u

U







Add
these
results
to
	
and
use
	b
to
obtain
kE


t
k



W







Z
t

AW




W




d

where


u

"
U

The
rst
term
in
the
in
tegrand
v
anishes
b
y
virtue
of
	c

The
second
term
is
in
tegrated
b
y
parts
to
obtain
kE


t
k



W




t


Z
t

W




d

	a

	
Con
v
ergence
and
Stabilit
y

This
result
can
b
e
simplied
sligh
tly
b
y
use
of
Cauc
h
ys
inequalit
y
jW

V

j

kW
k

kV
k


to
obtain
kE


t
k



kW


t
k

k


t
k


Z
t

kW

k

k
k

d

	b
In
tro
duce
a
basis
on
S
N

and
write
W
in
the
standard
form
W
x
y




N
X
j

c
j



j
x
y


	
Substituting
	
in
to
	a
and
follo
wing
the
steps
in
tro
duced
in
Section
	
w
e
are
led
to
M

c

Kc


	a
where
M
ij


i


j


	b
K
ij

A
i


j


i
j







N

	c
Assuming
that
the
stiness
matrix
K
is
indep
enden
t
of


	a
ma
y
b
e
solv
ed
exactly
to
sho
w
that
cf
Lemmas
	
and
	
whic
h
follo
w
kW




k


kE


t
k






t
	a
Z
t

kW

k

d

C


j
log
t
h

j
kE


t
k


	b
Equation
	a
is
used
in
conjunction
with
	b
to
obtain
kE


t
k



kE


t
k


Z
t

kW

k

d

max

t
k




k


No
w
using
	b
kE


t
k


C


j
log
t
h

j
max

t
k




k


		
W
riting
u

U

u

"
U

"
U

U



E
and
taking
an
L

norm
ku

U
k


k
k


kE
k




P
arab
olic
Problems
Using
		
ku

U
k


C


j
log
t
h

j
max

t
k




k


	a
Finally

since

satises
the
elliptic
problem
	c

w
e
can
use
Theorem

to
write
k




k


C
h

ku



k


	b
Com
bining
	a
and
	b
yields
the
desired
result
	

The
t
w
o
results
that
w
ere
used
without
pro
of
within
Theorem
	
are
stated
as
Lemmas
Lemma
	
Under
the
c
onditions
of
The
or
em
	
ther
e
exists
a
c
onstant
C


such
that
AV

V


C
h

kV
k



V

S
N


	
Pr
o
of
The
result
can
b
e
inferred
from
Example
	
ho
w
ev
er
a
more
formal
pro
of
is
giv
en
b
y
Johnson
	
Chapter

Instead
of
establishing
	b

w
ell
examine
a
sligh
tly
more
general
situation
Let
c
b
e
the
solution
of
M

c

Kc


t


c

c


	
The
mass
and
stiness
matrices
M
and
K
are
p
ositiv
e
denite
so
w
e
can
diagonalize
	

In
particular
let

b
e
a
diagonal
matrix
con
taining
the
eigen
v
alues
of
M

K
and
R
b
e
a
matrix
whose
columns
are
the
eigen
v
ectors
of
the
same
matrix
ie
M

KR

R

	a
F
urther
let
dt

R

ct

	b
Then
	
can
b
e
written
in
the
diagonal
form

d


d


	a
b
y
m
ultiplying
it
b
y
MR

and
using
	ab

The
initial
conditions
generally
remain
coupled
through
	ab

ie
d

d


R

c


	b
With
these
preliminaries
w
e
state
the
desired
result

	
Con
v
ectionDiusion
Systems

Lemma
	
If
dt
is
the
solution
of
		
then
j

dj

j
dj

C
jd

j
t

t


	a
wher
e
jdj

p
d
T
d

If
in
addition
max


j

j
j
j

C
h

	b
then
Z
T

j

dj

j
dj
dt

C


j
log
T
h

j
jd

j
	c
Pr
o
of
cf
Problem

Problems

Pro
v
e
Lemma
	
	
Con
v
ectionDi
usion
Systems
Problems
in
v
olving
con
v
ection
and
diusion
arise
in
#uid
#o
w
and
heat
transfer
Let
us
consider
the
mo
del
problem
u
t



ru

r

pru
	a
where








T
is
a
v
elo
cit
y
v
ector
W
ritten
is
scalar
form
	a
is
u
t



u
x



u
y

pu
x

x

pu
y

y

	b
The
v
orticit
y
transp
ort
equation
of
#uid
mec
hanics
has
the
form
of
	

In
this
case
u
w
ould
represen
t
the
v
orticit
y
of
a
t
w
odimensional
#o
w
If
the
magnitude
of

is
small
relativ
e
to
the
magnitude
of
the
diusivit
y
px
y


then
the
standard
metho
ds
that
w
e
ha
v
e
b
een
studying
w
ork
ne
This
ho
w
ev
er
is
not
the
case
in
man
y
applications
and
as
indicated
b
y
the
follo
wing
example
standard
nite
elemen
t
metho
ds
can
pro
duce
spurious
results
Example
	

Consider
the
steady

onedimensional
con
v
ectiondiusion
equa
tion
u



u





x


	a
with
Diric
hlet
b
oundary
conditions
u


u


	b


P
arab
olic
Problems
The
exact
solution
of
this
problem
is
ux



e
x	

e



e


	c
If





then
as
sho
wn
b
y
the
solid
line
in
Figure
	
the
solution
features
a
b
oundary
la
y
er
near
x


A
t
p
oin
ts
remo
v
ed
from
an
O

neigh
b
orho
o
d
of
x


the
solution
is
smo
oth
with
u


Within
the
b
oundary
la
y
er
the
solution
rises
sharply
from
its
unit
v
alue
to
u


at
x


0
0.2
0.4
0.6
0.8
1
−4
−3
−2
−1
0
1
2
N odd
N even
Figure
	
Solutions
of
	
with





The
exact
solution
is
sho
wn
as
a
solid
line
Piecewiselinear
Galerkin
solutions
with

and
elemen
t
meshes
are
sho
wn
as
dashed
and
dasheddotted
lines
resp
ectiv
ely

The
term
u

is
diusiv
e
while
the
term
u

is
con
v
ectiv
e
With
a
small
diusivit
y

con
v
ection
dominates
diusion
outside
of
the
narro
w
O

b
oundary
la
y
er
Within
this
la
y
er
diusion
cannot
b
e
neglected
and
is
on
an
equal
fo
oting
with
con
v
ection
This
simple
problem
will
illustrate
man
y
of
the
diculties
that
arise
when
nite
elemen
t
metho
ds
are
applied
to
con
v
ectiondiusion
problems
while
a
v
oiding
the
algebraic
and
geometric
complexities
of
more
realistic
problems
Let
us
divide


in
to
N
elemen
ts
of
width
h


N

Since
the
solution
is
slo
wly
v
arying
o
v
er
most
of
the
domain
w
e
w
ould
lik
e
to
c
ho
ose
h
to
b
e
signican
tly
larger
than

	
Con
v
ectionDiusion
Systems
	
the
b
oundary
la
y
er
thic
kness
This
could
in
tro
duce
large
errors
within
the
b
oundary
la
y
er
whic
h
w
e
assume
can
b
e
reduced
b
y
lo
cal
mesh
renemen
t
This
strategy
is
preferable
to
the
alternativ
e
of
using
a
ne
mesh
ev
erywhere
when
the
solution
is
only
v
arying
rapidly
within
the
b
oundary
la
y
er
Using
a
piecewiselinear
basis
w
e
write
the
nite
elemen
t
solution
as
U
x

N
X
j

c
j

j
x

c



c
N


	a
where

k
x






xx
k

x
k
x
k


if
x
k


x

x
k
x
k

x
x
k

x
k

if
x
k

x

x
k


otherwise

	b
The
co
ecien
ts
c

and
c
N
are
constrained
so
that
U
x
satises
the
essen
tial
b
oundary
conditions
	b

The
Galerkin
problem
for
	
consists
of
determining
U
x

S
N

suc
h
that


i

U




i

U




i







N


	a
Since
this
problem
is
similar
to
Example
	
w
ell
omit
the
dev
elopmen
t
and
just
write
the
inner
pro
ducts


i

U




h
c
i

c
i

c
i


	b

i

U



c
i

c
i


	c
Th
us
the
discrete
nite
elemen
t
system
is


h


c
i

c
i



h


c
i


i







N


	d
The
solution
of
this
secondorder
constan
tco
ecien
t
dierence
equation
is
c
i






i



N

i







N

	e




h


h

	f
The
quan
tit
y
h
is
called
the
c
el
l
Pe
clet
or
c
el
l
R
eynolds
numb
er
If
h


then




h


O

h





e
h

O

h







P
arab
olic
Problems
whic
h
is
the
correct
solution
Ho
w
ev
er
if
h


then



and
c
i



if
i
is
ev
en

if
i
is
o
dd
when
N
is
o
dd
and
c
i


N

i

N

if
i
is
ev
en
O


if
i
is
o
dd
when
N
is
ev
en
These
t
w
o
ob
viously
incorrect
solutions
are
sho
wn
with
the
correct
results
in
Figure
	
Let
us
try
to
remedy
the
situation
F
or
simplicit
y

w
ell
stic
k
with
an
ordinary
dier
en
tial
equation
and
consider
a
t
w
op
oin
t
b
oundary
v
alue
problem
of
the
form
Lu

u




u


q
u

f



x


	a
u

u


	b
Let
us
assume
that
u
v

H


with
u

and
v

b
eing
con
tin
uous
except
p
ossibly

at
x






Multiplying
	a
b
y
v
and
in
tegrating
the
second
deriv
ativ
e
terms
b
y
parts
yields
v

Lu

Av

u

u

v

x
	a
where
Av

u

v


u



v


u



v

q
u

	b
Q
x

lim


Q




Q




	c
W
e
m
ust
b
e
careful
b
ecause
the
strain
energy
Av

u
is
not
an
inner
pro
duct
since
Au
u
need
not
b
e
p
ositiv
e
denite
W
ell
use
the
inner
pro
duct
notation
here
for
con
v
enience
In
tegrating
the
rst
t
w
o
terms
of
	b
b
y
parts
v

Lu

L

v

u

v

u

u

v



v
u
x
or
since
u
and
v
are
con
tin
uous
v

Lu

L

v

u

v

u

u

v


x
	a
The
dieren
tial
equation
L

v


v



v



q
v

	b
with
the
b
oundary
conditions
v


v



is
called
the
adjoint
pr
oblem
and
the
op
erator
L



is
called
the
adjoint
op
er
ator

	
Con
v
ectionDiusion
Systems

Denition
	
A
Gr
e
en
s
function
G

x
for
the
op
erator
L

is
the
con
tin
uous
function
that
satises
L

G

x


G
xx


G
x

q
G


x









	a
G



G




	b
G
x


x

x





	c
Ev
aluating
	a
with
v
x

G

x
while
using
	a
	
and
assuming
that
u

x

H



giv
es
the
familiar
relationship
u


Lu
G




Z


G

x
f
x
dx
		a
A
more
useful
expression
for
our
presen
t
purp
oses
is
obtained
b
y
com
bining
	a
and
	a
with
v
x

G

x
to
obtain
u


Au
G




		b
As
usual
Galerkin
and
nite
elemen
t
Galerkin
problems
for
	a
w
ould
consist
of
determining
u

H


or
U

S
N

	
H


suc
h
that
Av

u

v

f


v

H



	a
and
AV

U


V

f


v

S
N


	b
Selecting
v

V
in
	a
and
subtracting
	b
yields
AV

e


v

S
N


	c
where
ex

ux

U
x

	d
Equation
		b
did
not
rely
on
the
con
tin
uit
y
of
u

x

hence
it
also
holds
when
u
is
replaced
b
y
either
U
or
e
Replacing
u
b
y
e
in
		b
yields
e


Ae
G




	a


P
arab
olic
Problems
Subtacting
	c
e


Ae
G



V


	b
Assuming
that
Av

u
is
con
tin
uous
in
H


w
e
ha
v
e
je

j

C
kek

kG



V
k


	c
Expressions
	bc
relate
the
lo
cal
error
at
a
p
oin
t

to
the
global
error
Equation
	c
also
explains
sup
ercon
v
ergence
F
rom
Theorem

w
e
kno
w
that
kek


O
h
p

when
S
N
consists
of
piecewise
p
olynomials
of
degree
p
and
u

H
p

The
test
function
V
is
also
an
elemen
t
of
S
N

ho
w
ev
er
G

x
cannot
b
e
appro
ximated
to
the
same
precision
as
u
b
ecause
it
ma
y
b
e
less
smo
oth
T
o
elab
orate
further
consider
kG



V
k



N
X
j

kG



V
k

j
where
kuk

j

Z
x
j
x
j

u




u

dx
If


x
k


x
k


k







N

then
the
discon
tin
uit
y
in
G
x


x
o
ccurs
on
some
in
terv
al
and
G

x
cannot
b
e
appro
ximated
to
high
order
b
y
V

If
on
the
other
hand


x
k

k







N

then
the
discon
tin
uit
y
in
G
x


x
is
conned
to
the
mesh
and
G

x
is
smo
oth
on
ev
ery
subin
terv
al
Th
us
in
this
case
the
Greens
function
can
b
e
appro
ximated
to
O
h
p

b
y
the
test
function
V
and
using
	c

w
e
ha
v
e
ux
k


C
h
p

k







N

	
The
solution
at
the
v
ertices
is
con
v
erging
to
a
m
uc
h
higher
order
than
it
is
globally

Equation
	c
suggests
that
there
are
t
w
o
w
a
ys
of
minimizing
the
p
oin
t
wise
error
The
rst
is
to
ha
v
e
U
b
e
a
go
o
d
appro
ximation
of
u
and
the
second
is
to
ha
v
e
V
b
e
a
go
o
d
appro
ximation
of
G

x

If
the
problem
is
not
singularly
p
erturb
ed
then
the
t
w
o
conditions
are
the
same
Ho
w
ev
er
when



the
b
eha
vior
of
the
Greens
function
is
hardly
p
olynomial
Let
us
consider
t
w
o
simple
examples
Example
	

Consider
	
in
the
case
when

x


x



Balancing
the
rst
t
w
o
terms
in
	a
implies
that
there
is
a
b
oundary
la
y
er
near
x


th
us
at
p
oin
ts
other
than
the
righ
t
endp
oin
t
the
small
second
deriv
ativ
e
terms
in
	
ma
y
b
e
neglected
and
the
solution
is
appro
ximately

u

R

q
u
R

f



x


u
R




	
Con
v
ectionDiusion
Systems

where
u
R
is
called
the
r
e
duc
e
d
solution
Near
x


the
reduced
solution
m
ust
b
e
corrected
b
y
a
b
oundary
layer
that
brings
it
from
its
limiting
v
alue
of
u
R

to
zero
Th
us
for





the
solution
of
	
is
appro
ximately
ux

u
R
x

u
R

e
x	
	

Similarly

the
Greens
function
	
has
b
oundary
la
y
ers
at
x


and
x




A
t
p
oin
ts
other
than
these
the
second
deriv
ativ
e
terms
in
	a
ma
y
b
e
neglected
and
the
Greens
function
satises
the
reduced
problem

G
R



q
G
R


x









G
R


x

C



G
R





Boundary
la
y
er
jumps
correct
the
reduced
solution
at
x


and
x


and
determine
an
asymptotic
appro
ximation
of
G

x
as
G

x

c


G
R


x

G
R



e

	x

if
x


e
x
	

	

if
x



The
function
c

is
giv
en
in
Flahert
y
and
Mathon

Kno
wing
the
Greens
function
w
e
can
construct
test
functions
that
appro
ximate
it
accurately

T
o
b
e
sp
ecic
let
us
write
it
as
G

x

N
X
j

G

x
j


j
x
	
where

j
x

j







N

is
a
basis
Let
us
consider
	
and
	
with



x



Appro
ximating
the
Greens
function
for
arbitrary

is
dicult
so
w
ell
restrict

to
x
k

k







N

and
establish
the
goal
of
minimizing
the
p
oin
t
wise
error
of
the
solution
Mapping
eac
h
subin
terv
al
to
a
canonical
elemen
t
the
basis

j
x

x

x
j


x
j


is

j
x

$


x

x
j
h

	a
where
$

s




e
s
e


if



s


e
s
e

e


if


s



otherwise
	b
where


h
 


	c


P
arab
olic
Problems
−1
−0.8
−0.6
−0.4
−0.2
0
0.2
0.4
0.6
0.8
1
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Figure
	
Canonical
basis
elemen
t
$

s
for




and

increasing
steepness

is
the
cell
Pe
clet
numb
er
The
v
alue
of
 

will
remain
undened
for
the
momen
t
The
canonical
basis
elemen
t
$

s
is
illustrated
in
Figure
	
As



the
basis
	b
b
ecomes
the
usual
piecewiselinear
hat
function
$

s








s
if



s




s
if


s



otherwise
As



	b
b
ecomes
the
piecewiseconstan
t
function
$

s



if



s



otherwise

The
limits
of
this
function
are
non
uniform
at
s



W
ere
no
w
in
a
p
osition
to
apply
the
P
etro
vGalerkin
metho
d
with
U

S
N

and
V

$
S
N

to
	

The
trial
space
S
N
will
consist
of
piecewise
linear
functions
and
for
the
momen
t
the
test
space
will
remain
arbitrary
except
for
the
assumptions

j
x

H




j
x
k



j
k

Z


$

s
ds


j
k







N


	

	
Con
v
ectionDiusion
Systems

The
P
etro
vGalerkin
system
for
	
is


i

U




i


U




i

q
U



i

f


i







N


	
Let
us
use
no
deb
yno
de
ev
aluation
of
the
inner
pro
ducts
in
	

F
or
simplicit
y

w
ell
assume
that
the
mesh
is
uniform
with
spacing
h
and
that

and
q
are
constan
t
Then


i

U




h
Z


$


s
$
U

s
ds
where
$
U
s
is
the
mapping
of
U
x
on
to
the
canonical
elemen
t


s


With
a
piecewise
linear
basis
for
$
U
and
the
prop
erties
noted
in
	
for

j

w
e
nd


i

U





h


c
i

	a
W
ev
e
in
tro
duced
the
cen
tral
dierence
op
erator

c
i

c
i

c
i
	b
for
con
v
enience
Th
us


c
i



c
i


c
i

c
i

c
i

	c
Considering
the
con
v
ectiv
e
term


i

U




Z


$

s
$
U

s
ds








c
i
	a
where

is
the
a
v
eraging
op
erator
c
i

c
i

c
i


	b
Th
us

c
i


c
i


c
i

c
i


	c
Additionally




Z



$

s

$

s
ds
	d
Similarly
q

i

U


q
h
Z


$

s
$
U
s
ds

q
h








c
i
		a


P
arab
olic
Problems
where


Z


jsj
$

s
ds
		b



Z


s
$

s
ds
		c
Finally

if
f
x
is
appro
ximated
b
y
a
piecewiselinear
p
olynomial
w
e
ha
v
e

i

f


h








f
i
	
where
f
i

f
x
i


Substituting
	a

	a

		a

and
	
in
to
	
giv
es
a
dierence
equation
for
c
k

k







N


Rather
than
facing
the
algebraic
complexit
y

let
us
con
tin
ue
with
the
simpler
problem
of
Example
	
Example
	
Consider
the
b
oundary
v
alue
problem
	

Th
us
q

f
x


in
		
and
w
e
ha
v
e


i

U





i

U





h


c
i








c
i

i







N


	a
or
using
	c

	c

and
	c








c
i

c
i

c
i


c
i

c
i



i







N


	b
This
is
to
b
e
solv
ed
with
the
b
oundary
conditions
c



c
N


	c
The
exact
solution
of
this
secondorder
constan
tco
ecien
t
dierence
equation
is
c
i






i



N

i







N

	a
where













	b
In
order
to
a
v
oid
the
spurious
oscillations
found
in
Example
	
w
ell
insist
that



Using
	b

w
e
see
that
this
requires


sgn





	c
Some
sp
ecic
c
hoices
of

follo
w

	
Con
v
ectionDiusion
Systems


Galerkin
s
metho
d



In
this
case
$

s

$
s



jsj


Using
	

this
metho
d
is
oscillation
free
when

jj


F
rom
	c

this
requires
h

j
j
F
or
small
v
alues
of
j
j
this
w
ould
b
e
to
o
restrictiv
e

Ilin
s
scheme
In
this
case
$

s
is
giv
en
b
y
	b
and


coth






This
sc
heme
giv
es
the
exact
solution
at
elemen
t
v
ertices
for
all
v
alues
of

Either
this
result
or
the
use
of
	c
indicates
that
the
solution
will
b
e
oscillation
free
for
all
v
alues
of

This
c
hoice
of

is
sho
wn
with
the
function



in
Figure
	

Upwind
dier
encing


sgn

When



the
shap
e
function
$

s
is
the
piecewise
constan
t
function
$

s



if



s



otherwise

This
function
is
discon
tin
uous
ho
w
ev
er
nite
elemen
t
solutions
still
con
v
erge
With



	b
b
ecomes







In
the
limit
as



w
e
ha
v
e



th
us
using
	a
c
i




N
i	

i







N




This
result
is
a
go
o
d
asymptotic
appro
ximation
of
the
true
solution
Examining
	
as
a
nite
dierence
equation
w
e
see
that
p
ositiv
e
v
alues
of

can
b
e
regarded
as
adding
dissipation
to
the
system
This
approac
h
can
also
b
e
used
for
v
ariableco
ecien
t
problems
and
for
non
uniform
mesh
spacing
The
cell
P
eclet
n
um
b
er
w
ould
dep
end
on
the
lo
cal
v
alue
of

and
the
mesh
spacing
in
this
case
and
could
b
e
selected
as

j

h
j
 

j

	


P
arab
olic
Problems
0
1
2
3
4
5
6
7
8
9
10
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
Figure
	
The
up
winding
parameter


coth



for
Ilins
sc
heme
upp
er
curv
e
and
the
function



lo
w
er
curv
e
vs

where
h
j

x
j

x
j

and
 

j
is
a
c
haracteristic
v
alue
of

x
when
x

x
j


x
j


eg
 

j


j


Up
wind
dierencing
is
to
o
diusiv
e
for
man
y
applications
Ilins
sc
heme
oers
adv
an
tages
but
it
is
dicult
to
extend
to
problems
other
than
	

The
P
etro
vGalerkin
tec
hnique
has
also
b
een
applied
to
transien
t
problems
of
ther
form
	

ho
w
ev
er
the
results
of
applying
Ilins
sc
heme
to
transien
t
problems
ha
v
e
more
diusion
than
when
it
is
applied
to
steady
problems
Example
	

Consider
Burgerss
equation
u
xx

uu
x




x


with
the
Diric
hlet
b
oundary
conditions
selected
so
that
the
exact
solution
is
ux

tanh


x


Burgerss
equation
is
often
used
as
a
test
problem
b
ecause
it
is
a
nonlinear
problem
with
a
kno
wn
exact
solution
that
has
a
b
eha
vior
found
in
more
complex
problems
Flahert
y

solv
ed
problems
with
h



and
N


using
up
wind
dierencing
and
Ilins
sc
heme
the
P
etro
vGalerkin
metho
d
with
the
exp
onen
tial
w
eigh
ting
giv
en
b
y
	b



	
Con
v
ectionDiusion
Systems
	
h
Maxim
um
Error
Up
wind
Exp
onen
tial






T
able
	
Maxim
um
p
oin
t
wise
errors
for
the
solution
of
Example
	
using
up
wind
dierencing


sgn

and
exp
onen
tial
w
eigh
ting


coth




The
cell
P
eclet
n
um
b
er
	
used
 

j




U
x
j


if
U
j



U
x
j



if
U
j



U
x
j



if
U
j




The
nonlinear
solution
is
obtained
b
y
iteration
with
the
v
alues
of
U
x
ev
aluated
at
the
b
eginning
of
an
iterativ
e
step
The
results
for
the
p
oin
t
wise
error
jej


max
j
N
jux
j


U
x
j

j
are
sho
wn
in
T
able
	
The
v
alue
of
h


is
appro
ximately
where
the
great
est
dierence
b
et
w
een
up
wind
dierencing


sgn
and
exp
onen
tial
w
eigh
ting


coth



exists
Dierences
b
et
w
een
the
t
w
o
metho
ds
decrease
for
larger
and
smaller
v
alues
of
h
The
solution
of
con
v
ectiondiusion
problems
is
still
an
activ
e
researc
h
area
and
m
uc
h
more
w
ork
is
needed
This
is
esp
ecially
the
case
in
t
w
o
and
three
dimensions
Those
in
terested
in
additional
material
ma
y
consult
Ro
os
et
al

Problems

Consider
	
when

x

q
x


x





Sho
w
that
the
solution
of
	
is
asymptotically
giv
en
b
y
ux

f
x
q
x

u
R

e
x
p
q
	

u
R

e
x	
p
q
	

Th
us
the
solution
has
O

p

b
oundary
la
y
ers
at
b
oth
x


and
x



In
a
similar
manner
sho
w
that
the
Greens
function
is
asymptotically
giv
en
b
y
G

x




q
x
q





e

x	
p
q

	

if
x


e
x
	
p
q

	

if
x



The
Greens
function
is
exp
onen
tially
small
a
w
a
y
from
x



where
it
has
t
w
o
b
oundary
la
y
ers
The
Greens
function
is
also
un
b
ounded
as
O



at
x


as





P
arab
olic
Problems

Bibliograph
y

S
Adjerid
M
Aia
and
JE
Flahert
y

Computational
metho
ds
for
singularly
p
er
turb
ed
systems
In
JD
Cronin
and
Jr
RE
OMalley

editors
A
nalyzing
Multisc
ale
Phenomena
Using
Singular
Perturb
ation
Metho
ds
v
olume

of
Pr
o
c
e
e
dings
of
Sym
p
osia
in
Applie
d
Mathematics
pages
%
Pro
vidence
			
AMS

UM
Asc
her
and
LR
P
etzold
Computer
Metho
ds
for
Or
dinary
Dier
ential
Equa
tions
and
Dier
entialA
lgebr
aic
Equations
SIAM
Philadelphia
		

KE
Brenan
SL
Campb
ell
and
LR
P
etzold
Numeric
al
Solution
of
InitialV
alue
Pr
oblems
in
Dier
entialA
lgebr
aic
Equations
North
Holland
New
Y
ork
		

JE
Flahert
y

A
rational
function
appro
ximation
for
the
in
tegration
p
oin
t
in
ex
p
onen
tially
w
eigh
ted
nite
elemen
t
metho
ds
International
Journal
of
Numeric
al
Metho
ds
in
Engine
ering
%	
	

JE
Flahert
y
and
W
Mathon
Collo
cation
with
p
olynomial
and
tension
splines
for
singularlyp
erturb
ed
b
oundary
v
alue
problems
SIAM
Journal
on
Scientic
and
Statistic
al
Computation
%	
		

CW
Gear
Numeric
al
Initial
V
alue
Pr
oblems
in
Or
dinary
Dier
ential
Equations
Pren
tice
Hall
Englew
o
o
d
Clis
	

E
Hairer
SP

Norsett
and
G
W
anner
Solving
Or
dinary
Dier
ential
Equations
I
Nonsti
Pr
oblems
SpringerV
erlag
Berlin
second
edition
		

E
Hairer
and
G
W
anner
Solving
Or
dinary
Dier
ential
Equations
II
Sti
and
Dier
ential
A
lgebr
aic
Pr
oblems
SpringerV
erlag
Berlin
		
	
C
Johnson
Numeric
al
Solution
of
Partial
Dier
ential
Equations
by
the
Finite
Ele
ment
metho
d
Cam
bridge
Cam
bridge
	

HG
Ro
os
M
St
ynes
and
L
T
obisk
a
Numeric
al
Metho
ds
for
Singularly
Perturb
e
d
Dier
ential
Equations
SpringerV
erlag
Berlin
		


Chapter

Hyp
erb
olic
Problems

Conserv
ation
La
ws
W
e
ha
v
e
successfully
applied
nite
elemen
t
metho
ds
to
elliptic
and
parab
olic
problems
ho
w
ev
er
h
yp
erb
olic
problems
will
pro
v
e
to
b
e
more
dicult
W
e
got
an
inkling
of
this
while
studying
con
v
ectiondiusion
problems
in
Section
	
Con
v
en
tional
Galerkin
meth
o
ds
required
the
mesh
spacing
h
to
b
e
on
the
order
of
the
diusivit
y

to
a
v
oid
spurious
oscillations
The
con
v
ectiondiusion
equation

	
c
hanges
t
yp
e
from
parab
olic
to
h
y
p
erb
olic
in
the
limit
as



The
b
oundary
la
y
er
also
leads
to
a
jump
discon
tin
uit
y
in
this
limit
Th
us
a
v
anishingly
small
mesh
spacing
will
b
e
required
to
a
v
oid
oscillations
at
least
when
discon
tin
uities
are
presen
t
W
ell
need
to
o
v
ercome
this
limitation
for
nite
elemen
t
metho
ds
to
b
e
successful
with
h
yp
erb
olic
problems
Instead
of
the
customary
secondorder
scalar
dieren
tial
equation
let
us
consider
h
yp
erb
olic
problems
as
rstorder
v
ector
systems
Let
us
conne
our
atten
tion
to
con
serv
ation
la
ws
in
one
space
dimension
whic
h
t
ypically
ha
v
e
the
form
u
t

f

u
x

b
x
t
u

a
where
u
x
t






u


x
t
u


x
t



u
m

x
t






f

u






f


u
f


u



f
m

u






b
x
t
u






b


x
t
u
b


x
t
u



b
m

x
t
u






b
are
mdimensional
densit
y

ux
and
load
v
ectors
resp
ectiv
ely

Its
also
con
v
enien
t
to
write

a
as
u
t

A
uu
x

b
x
t
u

a



Hyp
erb
olic
Problems
where
the
system
Jacobian
is
the
m

m
matrix
A
u

f

u
u


b
Equation

a
is
called
the
c
onservative
form
and

a
is
called
the
c
onve
ctive
form
of
the
partial
dieren
tial
system
Conditions
under
whic
h


and


are
of
h
yp
erb
olic
t
yp
e
follo
w
Denition

If
A
has
m
real
and
distinct
eigen
v
alues











m
and
hence
m
linearly
indep
enden
t
eigen
v
ectors
p


p






p
m

then

a
is
said
to
b
e
hyp
erb
olic
Ph
ysical
problems
where
dissipativ
e
eects
can
b
e
neglected
often
lead
to
h
yp
erb
olic
systems
Areas
where
these
arise
include
acoustics
dynamic
elasticit
y

electromagnetics
and
gas
dynamics
Here
are
some
examples
Example

The
Euler
equations
for
onedimensional
compressible
in
viscid
o
ws
satisfy

t

m
x



a
m
t


m



p
x



b
e
t


e

p
m


x



c
Here

m
e
and
p
are
resp
ectiv
ely

the
uids
densit
y

momen
tum
in
ternal
energy

and
pressure
The
uid
v
elo
cit
y
u

m
and
the
pressure
is
determined
b
y
an
equation
of
state
whic
h
for
an
ideal
uid
is
p




e

m




d
where

is
a
constan
t
Equations

a

b
and

c
express
the
facts
that
the
mass
momen
tum
and
energy
of
the
uid
are
neither
created
nor
destro
y
ed
and
are
hence
c
onserve
d
W
e
readily
see
that
the
system


has
the
form
of


with
u




m
e



f

u



m
m



p

e

pm



b
x
t
u











Example

The
deection
of
a
taut
string
has
the
form
u
tt

a

u
xx

q

x

a


Conserv
ation
La
ws

x = 0
x = L
T
T
u(x,t)
Figure

Geometry
of
the
taut
string
of
Example

where
a


T

with
T
b
eing
the
tension
and

b
eing
the
linear
densit
y
of
the
string

Fig
ure

The
lateral
loading
q

x
applied
in
the
transv
erse
direction
could
represen
t
the
w
eigh
t
of
the
string
This
secondorder
partial
dieren
tial
equation
can
b
e
written
as
a
rstorder
system
of
t
w
o
equations
in
a
v
ariet
y
of
w
a
ys
P
erhaps
the
most
common
approac
h
is
to
let
u


u
t

u


au
x


b
Ph
ysically

u


x
t
is
the
v
elo
cit
y
and
u


x
t
is
the
stress
at
p
oin
t
x
and
time
t
in
the
string
Dieren
tiating
with
resp
ect
to
t
while
using

a
and

b
yields

u


t

u
tt

a

u
xx

q

x

a
u


x

q

x

u


t

au
xt

au
tx

a
u


x

Th
us
the
onedimensional
w
a
v
e
equation
has
the
form
of


with
u


u

u



f

u


cu

cu



b
x
t
u


q

x




c
In
the
con
v
ectiv
e
form


w
e
ha
v
e
A



a
a




d

Characteristics
The
b
eha
vior
of
the
system


can
b
e
determined
b
y
diagonalizing
the
Jacobian

b
This
can
b
e
done
for
h
yp
erb
olic
systems
since
A
u
has
m
distinct
eigen
v
alues

Denition

Th
us
let
P

p


p






p
m


a
and
recall
the
eigen
v
alueeigen
v
ector
relation
AP

P

b


Hyp
erb
olic
Problems
where















m






c
Multiplying

a
b
y
P

and
using

b
giv
es
P

u
t

P

Au
x

P

u
t

P

u
x

P

b
Let
w

P

u


so
that
w
t


w
x

P

u
t


P


t
u

P

u
x


P


x
u
Using


w
t

w
x

Qw

g


a
where
Q


P


t



P


x
P
g

P

b

b
In
comp
onen
t
form

a
is

w
i

t


i

w
i

x

m
X
j

q
ij
w
j

g
i

i







m

c
Th
us
the
transformation


has
uncoupled
the
dieren
tiated
terms
of
the
original
system

a
Consider
the
directional
deriv
ativ
e
of
eac
h
comp
onen
t
w
i

i







m
of
w

dw
i
dt


w
i

t


w
i

x
dx
dt

i







m
in
the
directions
dx
dt


i

i







m

	a
and
use

c
to
obtain
dw
i
dt

m
X
j

q
ij
w
j

g
i

i







m

	b


Conserv
ation
La
ws

The
curv
es

	a
are
called
the
char
acteristics
of
the
system



The
partial
dieren
tial
equations


ma
y
b
e
solv
ed
b
y
in
tegrating
the
m
ordinary
dif
feren
tial
equations

	a
	b
This
system
is
uncoupled
through
its
dieren
tiated
terms
but
coupled
through
Q
and
g

This
metho
d
of
solution
is
quite
naturally

called
the
metho
d
of
c
haracteristics
While
w
e
could
dev
elop
n
umerical
metho
ds
based
on
the
metho
d
of
c
haracteristics
they
are
generally
not
ecien
t
when
m
	

Denition

The
set
of
all
p
oin
ts
that
determine
the
solution
at
a
p
oin
t
P

x


t


is
called
the
domain
of
dep
endenc
e
of
P

Consider
the
arbitrary
p
oin
t
P

x


t


and
the
c
haracteristics
passing
through
it
as
sho
wn
in
Figure

The
solution
u
x


t


dep
ends
on
the
initial
data
on
the
in
terv
al
A
B

and
on
the
v
alues
of
b
in
the
region
AP
B

b
ounded
b
y
A
B

and
the
c
haracteristic
curv
es

x



and

x


m

Th
us
the
region
AP
B
is
the
domain
of
dep
endence
of
P

dx/dt = 
x
1
dx/dt = 
P(x  ,t   )
A
B
t


























m
λ
0
0
λ
Figure

Domain
of
dep
endence
of
a
p
oin
t
P

x


t


The
solution
at
P
dep
ends
on
the
initial
data
on
the
line
A
B

and
the
v
alues
of
b
within
the
region
AP
B
b
ounded
b
y
the
c
haracteristic
curv
es
dxdt





m

Example

Consider
an
initial
v
alue
problem
for
the
forced
w
a
v
e
equation

a
with
the
initial
data
u
x


u


x
u
t

x



u


x


x


T
ransforming

a
using

b
yields
the
rstorder
system


with
A
and
b
giv
en
b
y


Using

b
The
initial
conditions
b
ecome
u


x



u


x
u


x


au

x

x


x




Hyp
erb
olic
Problems
With
A
giv
en
b
y


w
e
nd
its
eigen
v
alues
as



a
Th
us
the
c
haracter
istics
are

x

a
and
the
eigen
v
ectors
are
P


p








Since
P


P
w
e
ma
y
use


to
determine
the
canonical
v
ariables
as
w


u


u

p


w


u


u

p


F
rom


the
canonical
form
of
the
problem
is

w


t

a
w


x

q
p



w


t

a
w


x

q
p


The
c
haracteristics
in
tegrate
to
x

x


at
x

x


at
and
along
the
c
haracteristics
w
e
ha
v
e
dw
k
dt

q
p


k



In
tegrating
w
e
nd
w


x
t

w



x




p

Z
t

q

x


a
d
or
w


x
t

w



x




a
p

Z
x

at
x

q


d

Its
usual
to
eliminate
x

b
y
using
the
c
haracteristic
equation
to
obtain
w


x
t

w



x

at


a
p

Z
x
xat
q


d

Lik
ewise
w


x
t

w



x

at


a
p

Z
x
xat
q


d

The
domain
of
dep
endence
of
a
p
oin
t
P

x


t


is
sho
wn
in
Figure

Using
the
b
ounding
c
haracteristics
it
is
the
triangle
connecting
the
p
oin
ts

x


t



x


at



and

x


at




Actually

with
q
b
eing
a
function
of
x
only

the
domain
of
dep
endence
only
in
v
olv
es
v
alues
of
q

x
on
the
subin
terv
al

x


at



to

x


at





Conserv
ation
La
ws

0
0
t
dx/dt = -a
dx/dt = a
0
P(x   ,t   )
x
x   - at
x   + at
0


























0
0
Figure

The
domain
of
dep
endence
of
a
p
oin
t
P

x


t


for
Example

is
the
triangle
connecting
the
p
oin
ts
P


x


at



and

x


at



T
ransforming
bac
k
to
the
ph
ysical
v
ariables
u


x
t


p


w


w




p

w



x

at

w



x

at


a
Z
xat
xat
q


d

u


x
t


p


w


w




p

w



x

at

w



x

at


a

Z
x
xat
q


d

Z
x
xat
q


d

Supp
ose
for
simplicit
y

that

u


x


then
u


x





p

w



x

w



x
u


x


au

x

x


p

w



x

w



x
Th
us
w



x

w



x

au

x

x
p


and
u


x
t

a

u

x

x

at

u

x

x

at


a
Z
xat
xat
q


d

u


x
t

a

u

x

x

at

u

x

x

at


a

Z
x
xat
q


d

Z
x
xat
q


d

Since
u


au
x

w
e
can
in
tegrate
to
nd
the
solution
in
the
original
v
ariables
In
order
to
simplify
the
manipulations
lets
do
this
with
q

x


In
this
case
w
e
ha
v
e
u


x
t

a

u

x

x

at

u

x

x

at


Hyp
erb
olic
Problems
hence
u
x
t



u


x

at

u


x

at
The
solution
for
an
initial
v
alue
problem
when
u


x




x


if



x




x
if


x



otherwise
is
sho
wn
in
Figure

The
initial
data
splits
in
to
t
w
o
w
a
v
es
ha
ving
half
the
initial
amplitude
and
tra
v
eling
in
the
p
ositiv
e
and
negativ
e
x
directions
with
sp
eeds
a
and
a
resp
ectiv
ely

u(x,0)
x
-1
1
-1
1
x
-1
1
-1
1
x
x
u(x,1/2a)
u(x,1/a)
u(x,3/2a)
Figure

Solution
of
Example

at
t



upp
er
left
a

upp
er
righ
t
a

lo
w
er
left
and
a

lo
w
er
righ
t

RankineHugoniot
Conditions
F
or
simplicit
y

let
us
neglect
b
x
t
u
in

a
and
consider
the
in
tegral
form
of
the
conserv
ation
la
w
d
dt
Z


udx

f

uj



f

u


t

f

u


t


whic
h
states
that
the
rate
of
c
hange
of
u
within
the
in
terv
al


x


is
equal
to
the
c
hange
in
its
ux
through
the
b
oundaries
x





If
f
and
u
are
smo
oth
functions
then


can
b
e
written
as
Z


u
t

f

u
x
dx




Conserv
ation
La
ws
	
If
this
result
is
to
hold
for
all
con
trol
v
olumes





the
in
tegrand
m
ust
v
anish
and
hence

a
and


are
equiv
alen
t
T
o
further
simplify
matters
let
conne
our
atten
tion
to
the
scalar
conserv
ation
la
w
u
t

f

u
x



a
with
a
u

d
f

u
du


b
and
u
t

a
uu
x



c
The
c
haracteristic
equation
is
dx
dt



a
u

a
The
scalar
equation

c
is
already
in
the
canonical
form

a
W
e
calculate
the
directional
deriv
ativ
e
on
the
c
haracteristic
as
du
dt

u
t
dt

u
x
dx
dt

u
t

a
uu
x



b
Th
us
in
this
homogeneous
scalar
case
u
x
t
is
constan
t
along
the
c
haracteristic
curv
e

	a
F
or
an
initial
v
alue
problem
for

a
on


x


t
	

the
solution
w
ould
ha
v
e
to
satisfy
the
initial
condition
u
x


u


x


x




Since
u
is
constan
t
along
c
haracteristic
curv
es
it
m
ust
ha
v
e
the
same
v
alue
that
it
had
initially

Th
us
u

u


x



u


along
the
c
haracteristic
that
passes
through

x



F
rom

a
w
e
see
that
this
c
haracteristic
satises
the
ordinary
initial
v
alue
problem
dx
dt

a
u



t
	

x


x




In
tegrating
w
e
determine
that
the
c
haracteristic
is
the
straigh
t
line
x

x


a
u


t


This
pro
cedure
can
b
e
rep
eated
to
trace
other
c
haracteristics
and
thereb
y
construct
the
solution


Hyp
erb
olic
Problems
0
0
x = x   + at
φ
at
u(x,0) =   (x)
φ
u(x,t) =    (x-at)
at
x
x
u(x,t)
t
a
x
1
Figure

Characteristic
curv
es
and
solution
of
the
initial
v
alue
problem

a

when
a
is
a
constan
t
Example

The
simplest
case
o
ccurs
when
a
is
a
constan
t
and
f

u

au
All
of
the
c
haracteristics
are
parallel
straigh
t
lines
with
slop
e
a
The
solution
of
the
initial
v
alue
problem

a

is
u
x
t

u


x

at
and
is
as
sho
wn
in
Figure

a
w
a
v
e
that
main
tains
its
shap
e
and
tra
v
els
with
sp
eed
a
Example

Setting
a
u

u
and
f

u

u


in

a
b
yields
the
in
viscid
Burgers
equation
u
t




u


x




Again
consider
an
initial
v
alue
problem
ha
ving
the
initial
condition


so
the
c
haracteristic
is
giv
en
b
y


with
a


u
x




u


x


ie
x

x


u


x

t


The
c
haracteristics
are
straigh
t
lines
with
a
slop
e
that
dep
ends
on
the
v
alue
of
the
initial
data
th
us
the
c
haracteristic
passing
through
the
p
oin
t

x



has
slop
e
u


x




Conserv
ation
La
ws

The
fact
that
the
c
haracteristics
are
not
parallel
in
tro
duces
a
dicult
y
that
w
as
not
presen
t
in
the
linear
problem
of
Example

Consider
c
haracteristics
passing
through

x



and

x



and
supp
ose
that
u


x


	
u


x


for
x

	
x


Since
the
slop
e
of
the
c
haracteristic
passing
through

x



is
less
than
the
slop
e
of
the
one
passing
through

x



the
t
w
o
c
haracteristics
will
in
tersect
at
a
p
oin
t
sa
y

P
as
sho
wn
in
Figure

The
solution
w
ould
app
ear
to
b
e
m
ultiv
alued
at
p
oin
ts
suc
h
as
P

1
φ
x
P
x
x
0
1
1
0
1
φ
x = x   +    (x  )t
x = x   +    (x  )t
0
φ
φ 1
0
1
t
Figure

Characteristic
curv
es
for
t
w
o
initial
p
oin
ts
x

and
x

for
Burgers
equation


The
c
haracteristics
in
tersect
at
a
p
oin
t
P

In
order
to
clarify
matters
lets
examine
the
sp
ecic
c
hoice
of
u

giv
en
b
y
Lax


u


x





if
x




x
if


x



if


x



Using


w
e
see
that
the
c
haracteristic
passing
through
the
p
oin
t

x



satises
x




x


t
if
x



x





x

t
if


x


x


if


x


	
Sev
eral
c
haracteristics
are
sho
wn
in
Figure

The
c
haracteristics
rst
in
tersect
at
t


After
that
the
solution
w
ould
presumably
b
e
m
ultiv
alued
as
sho
wn
in
Figure

Its
of
course
quite
p
ossible
for
m
ultiv
alued
solutions
to
exist
ho
w
ev
er

i
they
are
not
observ
ed
in
ph
ysical
situations
and

ii
they
do
not
satisfy

a
in
an
y
classical
sense
Discon
tin
uous
solutions
are
often
observ
ed
in
nature
once
c
haracteristics
of
the
corresp
onding
conserv
ation
la
w
mo
del
ha
v
e
in
tersected
They
also
do
not
satisfy


Hyp
erb
olic
Problems
t
x
1
1
Figure

Characteristics
for
Burgers
equation


with
initial
data
giv
en
b
y


u(x,3/2)
u(x,1/2)
u(x,1)
u(x,0)
x
2
1
0
0
1
x
x
2
1
0
2
2
x
1
0
Figure

Multiv
alued
solution
of
Burgers
equation


with
initial
data
giv
en
b
y


The
solution
u
x
t
is
sho
wn
as
a
function
of
x
for
t




and


a
but
they
migh
t
satisfy
the
in
tegral
form
of
the
conserv
ation
la
w


W
e
examine
the
simplest
case
when
t
w
o
classical
solutions
satisfying

a
are
separated
b
y
a
single
smo
oth
curv
e
x



t
across
whic
h
u
x
t
is
discon
tin
uous
F
or
eac
h
t
	

w
e
assume
that




t


and
let
sup
erscripts

and

denote
conditions
immediately


Conserv
ation
La
ws

to
the
left
and
righ
t
resp
ectiv
ely

of
x



t
Then
using


w
e
ha
v
e
d
dt
Z


udx

d
dt

Z



udx

Z



udx

f

uj


or
dieren
tiating
the
in
tegrals
Z



u
t
dx

u





Z



u
t
dx

u





f

uj



The
solution
on
either
side
of
the
discon
tin
uit
y
w
as
assumed
to
b
e
smo
oth
so

a
holds
in






and






and
can
b
e
used
to
replace
the
in
tegrals
Additionally

since

is
smo
oth











Th
us
w
e
ha
v
e
f

uj




u




f

uj




u




f

uj



or



u


u



f

u



f

u




Let
q


q


q


a
denote
the
jump
in
a
quan
tit
y
q
and
write


as
u



f

u

b
Equation

b
is
called
the
R
ankineHugoniot
jump
c
ondition
and
the
discon
tin
uit
y
is
called
a
sho
ck
wave
W
e
can
use
the
RankineHugoniot
condition
to
nd
a
discon
tin
uous
solution
of
Example

Example

F
or
t


the
discon
tin
uous
solution
of



is
as
giv
en
in
Example

F
or
t


w
e
h
yp
othesize
the
existence
of
a
single
sho
c
k
w
a
v
e
passing
through



in
the

x
tplane
As
sho
wn
in
Figure
	
the
solution
of
Example

can
b
e
used
to
infer
that
u



and
u



Th
us
f

u




u






and
f

u




u






Using

b
the
v
elo
cit
y
of
the
sho
c
k
w
a
v
e
is






In
tegrating
w
e
nd
the
sho
c
k
lo
cation
as




t

c


Hyp
erb
olic
Problems
= (t + 1)/2
ξ
1
0
t
x
1
Figure
	
Characteristics
and
sho
c
k
discon
tin
uit
y
for
Example

u(x,0)
u(x,3/2)
u(x,1)
x
2
1
0
x
2
2
1
0
x
x
1
0
0
1
2
u(x,1/2)
Figure

Solution
u
x
t
of
Example

as
a
function
of
x
at
t




and

The
solution
is
discon
tin
uous
for
t
	

Since
the
sho
c
k
passes
through



the
constan
t
of
in
tegration
c


and





t






Conserv
ation
La
ws

The
c
haracteristics
and
sho
c
k
w
a
v
e
are
sho
wn
in
Figure
	
and
the
solution
u
x
t
is
sho
wn
as
a
function
of
x
for
sev
eral
times
in
Figure

Let
us
consider
another
problem
for
Burgers
equation
with
dieren
t
initial
conditions
that
will
illustrate
another
structure
that
arises
in
the
solution
of
nonlinear
h
yp
erb
olic
systems
Example

Consider
Burgers
equation


sub
ject
to
the
initial
conditions
u


x





if
x


x
if


x



if


x



Using


and


w
e
see
that
the
c
haracteristic
passing
through

x



sat
ises
x




x


if
x


x




t
if


x


x


t
if


x



These
c
haracteristics
sho
wn
in
Figure

ma
y
b
e
used
to
v
erify
that
the
solution
sho
wn
in
Figure

is
con
tin
uous
Additional
considerations
and
diculties
with
nonlinear
h
yp
erb
olic
systems
are
discussed
in
Lax


Example

A
Riemann
problem
is
an
initial
v
alue

Cauc
h
y
problem
for


with
piecewiseconstan
t
initial
data
Riemann
problems
pla
y
an
imp
ortan
t
role
in
the
n
umerical
solution
of
conserv
ation
la
ws
using
b
oth
nite
dierence
and
nite
elemen
t
tec
hniques
In
this
in
tro
ductory
section
let
us
illustrate
a
Riemann
problem
for
the
in
viscid
Burgers
equation


Th
us
w
e
apply
the
initial
data
u
x



u
L

if
x


u
R

if
x





As
in
the
previous
t
w
o
examples
w
e
ha
v
e
to
distinguish
b
et
w
een
t
w
o
cases
when
u
L
	
u
R
and
u
L

u
R

The
solution
ma
y
b
e
obtained
b
y
considering
piecewiselinear
con
tin
uous
initial
conditions
as
in
Examples

and

but
with
the
ramp
extending
from

to

instead
of
from

to

W
e
could
then
tak
e
a
limit
as



The
details
are
left
to
an
exercise

Problem

at
the
end
of
this
section
When
u
L
	
u
R

the
c
haracteristics
emanating
from
p
oin
ts
x



are
the
straigh
t
lines
x

x


u
L
t

cf


Those
emanating
from
p
oin
ts
x

	

are
x

x


u
R
t
The
c
haracteristics
cross
immediately
and
a
sho
c
k
forms
Using


w
e
see
that
the
sho
c
k
mo
v
es
with
sp
eed




u
L

u
R

The
solution
is
constan
t
along
the
c
haracteristics
and
hence
is
giv
en
b
y
u
x
t


u
L

if
xt


u
L

u
R

u
R

if
xt


u
L

u
R


u
L
	
u
R


a


Hyp
erb
olic
Problems
t
x
0
1
1
Figure

Characteristics
for
Example

u(x,1/2)
u(x,0)
x
2
1
0
2
x
x
2
1
0
0
1
1
1
2
1
1
1
u(x,1)
0
x
u(x,3/2)
Figure

Solution
u
x
t
of
Example

as
a
function
of
x
at
t




and



Conserv
ation
La
ws

Sev
eral
c
haracteristics
and
the
lo
cation
of
the
sho
c
k
are
sho
wn
in
Figure

When
u
L

u
R

the
c
haracteristics
do
not
in
tersect
There
is
a
region
b
et
w
een
the
c
haracteristic
x

u
L
t
emanating
from
x




and
x

u
R
t
emanating
from
x




where
the
initial
conditions
fail
to
determine
the
solution
As
determined
b
y
either
the
limiting
pro
cess
suggested
in
Problem

or
thermo
dynamic
argumen
ts
using
en
trop
y
considerations

no
sho
c
k
forms
and
the
solution
in
this
region
is
an
expansion
fan
Sev
eral
c
haracteristics
are
sho
wn
in
Figure

and
the
expansion
solution
is
giv
en
b
y
u
x
t




u
L

if
xt

u
L
xt
if
u
L

xt

u
R
u
R

if
xt

u
R

u
L

u
R


b
t
1/u
1/u
R
L
ξ
x
t
1/u
1/uR
L
x
Figure

Sho
c
k

left
and
expansion

righ
t
w
a
v
e
c
haracteristics
of
the
Riemann
problem
of
Example

W
e
conclude
this
example
b
y
examining
the
solution
of
the
Riemann
problem
along
the
line
x


Characteristics
for
sev
eral
c
hoices
of
initial
data
are
sho
wn
in
Figure

and
b
y
examining
these
and


w
e
see
that
u

t












u
L

if
u
L

u
R
	

u
R

if
u
L

u
R



if
u
L


u
R
	

u
L

if
u
L
	

u
R



u
L

u
R

	

u
R

if
u
L
	

u
R



u
L

u
R




This
data
will
b
e
useful
when
constructing
n
umerical
sc
hemes
based
on
the
solution
of
Riemann
problems
Problems


Hyp
erb
olic
Problems
t
x
t
t
x
x
x
x
t
t
t
x
Figure

Characteristics
of
Riemann
problems
for
Burgers
equation
when
u
L

u
R
	


top
u
L

u
R



cen
ter
u
L
	

u
R



u
L

u
R

	


b
ottom
left
and
u
L


u
R
	


b
ottom
righ
t

Sho
w
that
the
solution
of
the
Riemann
problem



is
giv
en
b
y


Y
ou
ma
y
b
egin
b
y
solving
a
problem
with
con
tin
uous
initial
data
eg
u
x





u
L

if
x


u
L




x

u
R




x
if



x


u
R

if


x

and
tak
e
the
limit
as





Discon
tin
uous
Galerkin
Metho
ds
	

Discon
tin
uous
Galerkin
Metho
ds
In
Section
	
w
e
examined
the
use
of
the
discon
tin
uous
Galerkin
metho
d
for
time
in
tegration
W
ell
no
w
examine
it
as
a
w
a
y
of
p
erforming
spatial
discretization
of
con
serv
ation
la
ws


The
metho
d
migh
t
ha
v
e
some
adv
an
tages
when
solving
problems
with
discon
tin
uous
solutions
The
discon
tin
uous
Galerkin
metho
d
w
as
rst
used
for
to
solv
e
an
ordinary
dieren
tial
equation
for
neutron
transp
ort

A
t
the
momen
t
it
is
v
ery
p
opular
and
is
b
eing
used
to
solv
e
ordinary
dieren
tial
equations

	
and
h
yp
erb
olic








parab
olic




and
elliptic



partial
dieren
tial
equations
A
recen
t
pro
ceedings
con
tains
a
complete
and
curren
t
surv
ey
of
the
metho
d
and
its
applications

The
discon
tin
uous
Galerkin
metho
d
has
a
n
um
b
er
of
adv
an
tages
relativ
e
to
traditional
nite
elemen
t
metho
ds
when
used
to
discretize
h
yp
erb
olic
problems
W
e
ha
v
e
already
noted
that
it
has
the
p
oten
tial
of
sharply
represen
ting
discon
tin
uities
The
piecewise
con
tin
uous
trial
and
test
spaces
mak
e
it
unnecessary
to
imp
ose
in
terelemen
t
con
tin
uit
y

There
is
also
a
simple
comm
unication
pattern
b
et
w
een
elemen
ts
that
mak
es
it
useful
for
parallel
computation
W
ell
b
egin
b
y
describing
the
metho
d
for
conserv
ation
la
ws


in
one
spatial
dimension
In
doing
this
w
e
presen
t
a
simple
construction
due
to
Co
c
kburn
and
Sh
u

rather
than
the

more
standard
approac
h
	

used
in
Section
	
for
time
in
tegra
tion
Using
a
metho
d
of
lines
form
ulation
let
us
divide
the
spatial
region
in
to
elemen
ts

x
j


x
j

j







N

and
construct
a
lo
cal
Galerkin
problem
on
Elemen
t

x
j


x
j

in
the
usual
manner
b
y
m
ultiplying

a
b
y
a
test
function
v
and
in
tegrating
to
obtain
Z
x
j
x
j

v
T
u
t

f

u
x
dx



a
The
loading
term
b
x
t
u
in

a
causes
no
conceptual
or
practical
diculties
and
w
e
ha
v
e
neglected
it
to
simplify
the
presen
tation
F
ollo
wing
the
usual
pro
cedure
let
us
map

x
j


x
j

to
the
canonical
elemen
t



using
the
linear
transformation
x





x
j






x
j


b
Then
after
in
tegrating
the
ux
term
in

a
b
y
parts
w
e
obtain
h
j

Z


v
T
u
t
d

v
T
f

uj



Z


v
T

f

ud

c
where
h
j

x
j

x
j



d


Hyp
erb
olic
Problems
Without
a
need
to
main
tain
in
terelemen
t
con
tin
uit
y

there
are
sev
eral
options
a
v
ailable
for
selecting
a
nite
elemen
t
basis
Let
us
c
ho
ose
one
based
on
Legendre
p
olynomials
As
w
e
shall
see
this
will
pro
duce
a
diagonal
mass
matrix
without
a
need
to
use
lumping
Th
us
w
e
select
the
appro
ximation
U
j

x
t
of
u
x
t
on
the
mapping
of

x
j


x
j

to
the
canonical
elemen
t
as
U
j



t

p
X
k

c
k
j

tP
k




a
where
c
k
j

t
is
an
mv
ector
and
P
k



is
the
Legendre
p
olynomial
of
degree
k
in


Recall

cf
Section

that
the
Legendre
p
olynomials
satisfy
the
orthogonalit
y
relation
Z


P
i


P
j


d


ij
i



i
j



b
are
normalized
as
P
i




i



c
and
satisfy
the
symmetry
relation
P
i






i
P
i



i



d
The
rst
six
Legendre
p
olynomials
are
P






P







P











P











P














P
















These
p
olynomials
are
illustrated
in
Figure

Additional
information
app
ears
in
Section

and
Abromo
witz
and
Stegen

Substituting

a
in
to

c
testing
against
P
i



and
using

bd
yields
h
j

c
ij
i



f

U
x
j

t



i
f

U
x
j


t

Z


dP
i



d
f

U
j



td

i







p

a
where




d
dt
Neigh
b
oring
elemen
ts
m
ust
comm
unicate
information
to
eac
h
other
and
in
this
form
of
the
discon
tin
uous
Galerkin
elemen
t
metho
d
this
is
done
through
the
b
oundary
ux


Discon
tin
uous
Galerkin
Metho
ds

−1
−0.8
−0.6
−0.4
−0.2
0
0.2
0.4
0.6
0.8
1
−1
−0.8
−0.6
−0.4
−0.2
0
0.2
0.4
0.6
0.8
1
Figure

Legendre
p
olynomials
of
degrees
p








terms
The
usual
practice
is
to
replace
the
b
oundary
ux
terms
f

U
x
k

t
k

j


j

b
y
a
numeric
al
ux
function
f

U
x
k

t
	
F
U
k

x
k

t
U
k


x
k

t

b
that
dep
ends
on
the
appro
ximate
solutions
U
k
and
U
k

on
the
t
w
o
elemen
ts
sharing
the
v
ertex
at
x
k

Co
c
kburn
and
Sh
u


presen
t
sev
eral
p
ossible
n
umerical
ux
functions
P
erhaps
the
simplest
is
the
a
v
erage
F
U
k

x
k

t
U
k


x
k

t

f

U
k

x
k

t

f

U
k


x
k

t



a
Based
on
our
w
ork
with
con
v
ectiondiusion
problems
in
Section
	
w
e
migh
t
exp
ect
that
some
up
wind
considerations
migh
t
b
e
w
orth
while
This
happ
ens
to
b
e
somewhat
in
v
olv
ed
for
nonlinear
v
ector
systems
W
ell
p
ostp
one
it
and
instead
note
that
an
up
wind
ux
for
a
scalar
problem
is
F

U
k

x
k

t
U
k


x
k

t


f

U
k

x
k

t
if
a
U
k

x
k

t

a
U
k


x
k

t
	

f

U
k


x
k

t
if
a
U
k

x
k

t

a
U
k


x
k

t



b
where
a
u

f
u

u

c


Hyp
erb
olic
Problems
A
simple
n
umerical
ux
that
is
relativ
ely
easy
to
apply
to
v
ector
systems
and
emplo
ys
up
wind
information
is
the
L
axF
rie
drichs
function

F
U
k

x
k

t
U
k


x
k

t



f

U
k

x
k

t

f

U
k


x
k

t

max

U
k


x
k

t

U
k

x
k

t

d
where

max
is
the
maxim
um
absolute
eigen
v
alue
of
the
Jacobian
matrix
f
u

u
u

U
k

x
k

t
U
k


x
k

t
Example

The
simplest
discon
tin
uous
Galerkin
sc
heme
uses
piecewiseconstan
t

p


solutions
U
j



t

c
j

tP





c
j

In
this
case

a
b
ecomes
h
j

c
j

f

U
x
j

t

f

U
x
j


t


In
this
initial
example
lets
c
ho
ose
a
scalar
problem
and
ev
aluate
the
ux
using
the
a
v
erage

a
F

U
k

x
k

t
U
k


x
k

t

f

U
k

x
k

t

f

U
k


x
k

t


f

c
k


f

c
k



and
up
wind

b
F

U
k

x
k

t
U
k


x
k

t


f

c
k

if
a
c
k


a
c
k


	

f

c
k


if
a
c
k


a
c
k




n
umerical
uxes
With
these
ux
c
hoices
w
e
ha
v
e
the
ordinary
dieren
tial
systems

c
j

f

c
j



f

c
j


h
j


and

c
j





j
f

c
j







j
f

c
j






j

f

c
j






j

f

c
j


h
j


where

j

sgn
a
c
j


a
c
j


In
the

simplest
case
when
f

u

au
with
a
a
p
ositiv
e
constan
t
w
e
ha
v
e
the
t
w
o
sc
hemes

c
j

a
c
j


c
j


h
j


j







J

and

c
j

a
c
j

c
j


h
j


j







J



Discon
tin
uous
Galerkin
Metho
ds

Initial
conditions
for
c
j


ma
y
b
e
sp
ecied
b
y
in
terp
olating
the
initial
data
at
the
cen
ter
of
eac
h
in
terv
al
ie
c
j



u


x
j

h
j

j







J

W
e
use
these
t
w
o
tec
hniques
to
solv
e
an
initial
v
alue
problem
with
a


and
u


x
t

sin

x
Th
us
the
exact
solution
is
u
x
t

sin


x

t
Piecewiseconstan
t
discon
tin
uous
Galerkin
solutions
with
up
wind
and
cen
tered
uxes
are
sho
wn
at
t


in
Figure

A
elemen
t
uniform
mesh
w
as
used
and
time
in
te
gration
w
as
p
erformed
using
the
MA
TLAB
RungeKutta
pro
cedure
ode
The
solution
with
the
up
wind
ux
has
greatly
dissipated
the
solution
after
one
p
erio
d
in
time
The
maxim
um
error
at
cell
cen
ters
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
−1
−0.8
−0.6
−0.4
−0.2
0
0.2
0.4
0.6
0.8
1
x
U
Figure

Exact
and
piecewiseconstan
t
discon
tin
uous
solutions
of
a
linear
kinematic
w
a
v
e
equation
with
sin
usoidal
initial
data
at
t


Solutions
with
up
wind
and
cen
tered
uxes
are
sho
wn
The
solution
using
the
up
wind
ux
exhibits
the
most
dissipation
je

tj


max
j
J
ju
x
j

h
j

t

U

x
j

h
j

tj
at
t


is
sho
wn
in
T
able

on
meshes
with
J



and

elemen
ts
Since
the
errors
are
decreasing
b
y
a
factor
of
t
w
o
for
eac
h
mesh
doubling
it
app
ears
that
the


Hyp
erb
olic
Problems
up
windux
solution
is
con
v
erging
at
a
linear
rate
Using
similar
reasoning
the
cen
tered
solution
app
ears
to
con
v
erge
at
a
quadratic
rate
The
errors
app
ear
to
b
e
smallest
at
the
do
wn
wind

righ
t
end
of
eac
h
elemen
t
This
sup
ercon
v
ergence
result
has
b
een
kno
wn
for
some
time
	

but
other
more
general
results
w
ere
recen
tly
disco
v
ered

J
Up
wind
Cen
tered
jej

jej



	

	




T
able

Maxim
um
errors
for
solutions
of
a
linear
kinematic
w
a
v
e
equation
with
sin
usoidal
initial
data
at
t


using
meshes
with
J



and

uniform
elemen
ts
Solutions
w
ere
obtained
using
up
wind
and
cen
tered
uxes
As
a
second
calculation
lets
consider
discon
tin
uous
initial
data
u


x
t



if


x



if


x



This
data
is
extended
p
erio
dically
to
the
whole
real
line
Piecewiseconstan
t
discon
tin
uous
Galerkin
solutions
with
up
wind
and
cen
tered
uxes
are
sho
wn
at
t


in
Fig
ure

The
up
wind
solution
has
once
again
dissipated
the
initial
square
pulse
This
time
ho
w
ev
er
the
cen
tered
solution
is
exhibiting
spurious
oscillations
As
with
con
v
ectiondominated
con
v
ectiondiusion
equations
some
up
winding
will
b
e
necessary
to
eliminate
spurious
oscillations
near
discon
tin
uities

HighOrder
Discon
tin
uous
Galerkin
Metho
ds
The
results
of
Example

are
extremely
discouraging
It
w
ould
app
ear
that
w
e
ha
v
e
to
con
tend
with
either
excessiv
e
diusion
or
spurious
oscillations
T
o
o
v
ercome
these
c
hoices
w
e
in
v
estigate
the
use
of
the
higherorder
tec
hniques
oered
b
y


With
c
ij
b
eing
an
mv
ector
and
i
ranging
from

to
p
w
e
ha
v
e
p


v
ector
and
m
p


scalar
unkno
wns
on
eac
h
elemen
t
W
e
will
fo
cus
on
the
four
ma
jor
tasks

i
ev
aluating
the
in
tegral
on
the
righ
t
side
of

a

ii
p
erforming
the
time
in
tegration

iii
dening
the
initial
conditions
and

iv

ev
aluating
the
uxes
The
in
tegral
in

a
will
t
ypically
require
n
umerical
in
tegration
and
the
ob
vious
c
hoice
is
Gaussian
quadrature
as
describ
ed
in
Chapter

This
w
orks
ne
and
there
is
no
need
to
discuss
it
further
Time
in
tegration
can
b
e
p
erformed
b
y
either
explicit
or
implicit
tec
hniques
The
c
hoice
usually
dep
ends
on
the
spread
of
the
eigen
v
alues

i

i







m
of
the
Jaco
bian
A
u
If
the
eigen
v
alues
are
close
to
eac
h
other
explicit
in
tegration
is
ne
Stabilit
y


Discon
tin
uous
Galerkin
Metho
ds

0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
−2
−1.5
−1
−0.5
0
0.5
1
1.5
2
x
U
Figure

Exact
and
piecewiseconstan
t
discon
tin
uous
solutions
of
a
linear
kinematic
w
a
v
e
equation
with
discon
tin
uous
initial
data
at
t


Solutions
with
up
wind
and
cen
tered
uxes
are
sho
wn
The
solution
using
the
up
wind
ux
is
dissipativ
e
The
solution
using
the
cen
tered
ux
exhibits
spurious
oscillations
is
usually
not
a
problem
An
implicit
sc
heme
migh
t
b
e
necessary
when
the
eigen
v
alues
are
widely
separated
or
when
in
tegrating


to
a
steady
state
F
or
explicit
in
tegration
Co
c
kburn
and
Sh
u

recommend
a
total
v
ariation
diminishing

TVD
RungeKutta
sc
heme
Ho
w
ev
er
Bisw
as
et
al

found
that
classical
RungeKutta
form
ulas
ga
v
e
sim
ilar
results
Second
and
thirdorder
and
fourth
and
fthorder
classical
RungeKutta
soft
w
are
w
as
used
for
time
in
tegration
of
Example

If
forw
ard
Euler
in
tegration
of

a
w
ere
used
w
e
w
ould
ha
v
e
to
solv
e
the
explicit
system
h
j
i


c
n
ij

c
n
ij
t

f

U
n

x
j




i
f

U
n

x
j



Z


dP
i



d
f

U
n
j


d

i







p
The
notation
is
iden
tical
to
that
used
in
Chapter
	
th
us
U
n

x
and
c
n
ij
are
the
appro
x
imations
of
U
x
t
n

and
c
ij

t
n

resp
ectiv
ely

pro
duced
b
y
the
time
in
tegration
soft
w
are
and
t
is
the
time
step
The
forw
ard
Euler
metho
d
is
used
for
illustration
b
ecause
of
its
simplicit
y

The
order
of
the
temp
oral
in
tegration
metho
d
should
b
e
comparable
to
p


Hyp
erb
olic
Problems
Initial
conditions
ma
y
b
e
determined
b
y
L

pro
jection
as
Z


P
i


U
j





u



d


i







p
j







J



One
more
dicult
y
emerges
Higherorder
sc
hemes
for
h
yp
erb
olic
problems
oscillate
near
discon
tin
uities
This
is
a
fundamen
tal
result
that
ma
y
b
e
established
b
y
theoretical
means

cf
eg
So
d

One
tec
hnique
for
reduced
these
oscillations
in
v
olv
es
limiting
the
computed
solution
Man
y
limiting
algorithms
ha
v
e
b
een
suggested
but
none
are
totally
successful
W
e
describ
e
a
pro
cedure
for
limiting
the
slop
e

U
j

x
t
x
of
the
solution
that
is
widely
used
With
this
approac
h

U
j

x
t
x
is
mo
died
so
that

the
solution

a
do
es
not
tak
e
on
v
alues
outside
of
the
adjacen
t
grid
a
v
erages

Figure

upp
er
left

lo
cal
extrema
are
set
to
zero

Figure

upp
er
righ
t
and

the
gradien
t
is
replaced
b
y
zero
if
its
sign
is
not
consisten
t
with
its
neigh
b
ors

Figure

lo
w
er
cen
ter
Figure

illustrates
these
situations
when
the
solution
is
a
piecewiselinear

p


function
relativ
e
to
the
mesh
A
form
ula
for
accomplishing
this
limiting
can
b
e
summarized
concisely
using
the
minim
um
mo
dulus
function
as

U
jmod

x
j

t

x

minmo
d


U
j

x
j

t

x

rU
j

x
j


t
U
j

x
j


t

a

U
jmod

x
j


t

x

minmo
d


U
j

x
j


t

x

rU
j

x
j


t
U
j

x
j


t

b
where
minmo
d

a
b
c


sgn
a
min

jaj
jbj
jcj
if
sgn
a

sgn

b

sgn

c

otherwise

c
and
r
and

are
the
bac
kw
ard
and
forw
ard
dierence
op
erators
rU
j

x
j


t

U
j

x
j


t

U
j

x
j


t

d
and
U
j

x
j


t

U
j

x
j


t

U
j

x
j


t

e
With

U
jmod

x
j


t
x
and

U
jmod

x
j

t
x
determined

ab
are
used
to
re
computed
the
co
ecien
ts
in

a
to
reduce
the
oscillations
Ho
w
ev
er

ab


Discon
tin
uous
Galerkin
Metho
ds

























































































































































































































































































































































































































j
j
j
Figure

Solution
limiting
reduce
slop
es
to
b
e
within
neigh
b
oring
a
v
erages

upp
er
left
set
lo
cal
extrema
to
zero

upp
er
righ
t
and
set
slop
es
to
zero
if
they
disagree
with
neigh
b
oring
trends
only
pro
vide
t
w
o
v
ector
equations
for
mo
difying
the
p
v
ector
co
ecien
ts
c
ijmod

t
i







p
in

U
j

x
t
x
When
p



ab
are
iden
tical
and
c
jmod

t
is
uniquely
determined
Lik
ewise
when
p


the
t
w
o
conditions

ab
suce
to
uniquely
determine
the
mo
died
co
ecien
ts
c
jmod

t
and
c
jmod

t
Equations

ab
are
insucien
t
to
determine
the
mo
died
co
ecien
ts
when
p
	

and
Co
c
kburn
and
Sh
u

suggested
setting
the
higherorder
co
ecien
ts
c
ijmod

t
i







p
to
zero
This
has
the
disturbing
c
haracteristic
of
attening
the
solution
near
smo
oth
extrema
and
reducing
the
order
of
accuracy

Bisw
as
et
al

dev
elop
ed
an
adaptiv
e
limiter
whic
h


Hyp
erb
olic
Problems
applied
the
minim
um
mo
dulus
function

c
to
higher
deriv
ativ
es
of
U
j

They
b
egan
b
y
limiting
the
p
th
deriv
ativ
e
of
U
j
and
w
ork
ed
do
wn
w
ards
un
til
either
a
deriv
ativ
e
w
as
not
c
hanged
b
y
the
limiting
or
they
mo
died
all
of
the
co
ecien
ts
Their
pro
cedure
called
momen
t
limiting
is
describ
ed
further
in
their
pap
er


Example

Bisw
as
et
al

solv
e
the
in
viscid
Burgers
equation


with
the
initial
data
u
x




sin
x


This
initial
data
steep
ens
to
form
a
sho
c
k
whic
h
propagates
in
the
p
ositiv
e
x
direction
Bisw
as
et
al

use
an
up
wind
n
umerical
ux

b
and
solv
e
problems
on
uniform
meshes
with
h


with
p




Time
in
tegration
w
as
done
using
classical
Runge
Kutta
metho
ds
of
orders

resp
ectiv
ely

for
p




Exact
and
computed
solutions
are
sho
wn
in
Figure

The
piecewise
p
olynomial
functions
used
to
represen
t
the
solution
are
plotted
at
elev
en
p
oin
ts
on
eac
h
subin
terv
al
The
rstorder
solution

p


sho
wn
at
the
upp
er
left
of
Figure

is
c
haracter
istically
diusiv
e
The
secondorder
solution

p


sho
wn
at
the
upp
er
righ
t
of
Figure

has
greatly
reduced
the
diusion
while
not
in
tro
ducing
an
y
spurious
oscillations
The
minim
um
mo
dulus
limiter


has
attened
the
solution
near
the
sho
c
k
as
seen
with
the
thirdorder
solution

p


sho
wn
at
the
lo
w
er
left
of
Figure

There
is
a
loss
of

lo
cal
monotonicit
y
near
the
sho
c
ks

Av
erage
solution
v
alues
are
monotone
and
this
is
all
that
the
limiter


w
as
designed
to
pro
duce
The
adaptiv
e
momen
t
limiter
of
Bisw
as
et
al

reduces
the
attening
and
do
es
a
b
etter
job
of
preserving
lo
cal
monotonicit
y
near
discon
tin
uities
The
solution
with
p


using
this
limiter
is
sho
wn
in
the
lo
w
er
p
ortion
of
Figure

Example

Adjerid
et
al

solv
e
the
nonlinear
w
a
v
e
equation
u
tt

u
xx

u
u




a
whic
h
can
b
e
written
in
the
form

a
as

u


t


u


x

u



u


t


u


x

u


u





b
with
u


u
The
initial
and
b
oundary
conditions
are
suc
h
that
the
exact
solution
of

a
is
the
solitary
w
a
v
e
u
x
t

sec
h

x
cosh



t
sinh




c

cf
Figure

Adjerid
et
al

solv
ed
problems
on



x





t


b
y
the
discon
tin
uous
Galerkin
metho
d
using
p
olynomials
of
degrees
p


to

The
solution
at
t




Discon
tin
uous
Galerkin
Metho
ds
	
Figure

Exact

line
and
discon
tin
uous
Galerkin
solutions
of
Example

for
p




and
h


Solutions
with
the
minmo
d
limiter


and
an
adaptiv
e
momen
t
limiter
of
Bisw
as
et
al

are
sho
wn
for
p


p
erformed
with
p


and
J


is
sho
wn
in
Figure

The
en
tire
solitary
w
a
v
e
is
sho
wn
ho
w
ev
er
the
computation
w
as
p
erformed
on
the
cen
ter
region



x





Hyp
erb
olic
Problems
Discretization
errors
in
the
L

norm
ke

tk

J
X
j

Z
x
j
x
j

jU

x
t

U
j

x
tjdx
are
presen
ted
for
the
solution
u
for
v
arious
com
binations
of
h
and
p
in
T
able

Solutions
of
this
nonlinear
w
a
v
e
propagation
problem
app
ear
to
b
e
con
v
erging
as
O

h
p

in
the
L

norm
This
can
b
e
pro
v
en
correct
for
smo
oth
solutions
of
discon
tin
uous
Galerkin
metho
ds




0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
-10
-8
-6
-4
-2
0
2
4
6
8
10
Figure

Solution
of
Example

at
t


obtained
b
y
the
discon
tin
uous
Galerkin
metho
d
with
p


and
N


J
p


p


p


p


p



e
e
e
e
e

	e
	e
e
e
e

	e
e
	e
e
e

e
e
e
e	
e

	e
e
e
e
	e

e
e
e	
T
able

Discretization
errors
at
t


as
functions
J
and
p
for
Example

Ev
aluating
n
umerical
uxes
and
using
limiting
for
v
ector
systems
is
more
complicated
than
indicated
b
y
the
previous
scalar
example
Co
c
kburn
and
Sh
u


rep
orted
problems
when
applying
limiting
comp
onen
twise
A
t
the
price
of
additional
computation
they
applied
limiting
to
the
c
haracteristic
elds
obtained
b
y
diagonalizing
the
Jacobian
f
u

Bisw
as
et
al

pro
ceeded
in
a
similar
manner
Fluxv
ector
splitting
ma
y
pro
vide
a
compromise
b
et
w
een
the
t
w
o
extremes
As
an
example
consider
the
solution
and
ux
v
ectors
for
the
onedimensional
Euler
equations
of
compressible
o
w


F
or
this


Discon
tin
uous
Galerkin
Metho
ds

and
related
dieren
tial
systems
the
ux
v
ector
is
a
homogeneous
function
that
ma
y
b
e
expressed
as
f

u

Au

f
u

uu

	a
Since
the
system
is
h
yp
erb
olic
the
Jacobian
A
ma
y
b
e
diagonalized
as
describ
ed
in
Section

to
yield
f

u

P

Pu

	b
where
the
diagonal
matrix

con
tains
the
eigen
v
alues
of
A















m








u

c
u
u

c




	c
The
v
ariable
c

p

p

is
the
sp
eed
of
sound
in
the
uid
The
matrix

can
b
e
decomp
osed
in
to
comp
onen
ts








a
where


and


are
resp
ectiv
ely

comp
osed
of
the
nonnegativ
e
and
nonp
ositiv
e
com
p
onen
ts
of



i


i

j
i
j


i







m

b
W
riting
the
ux
v
ector
in
similar
fashion
using

	
f

u

P







Pu

f

u


f

u



c
Split
uxes
for
the
Euler
equations
w
ere
presen
ted
b
y
Steger
and
W
arming

V
an
Leer

found
an
impro
v
emen
t
that
pro
vided
b
etter
p
erformance
near
sonic
and
stag
nation
p
oin
ts
of
the
o
w
The
split
uxes
are
ev
aluated
b
y
up
wind
tec
hniques
Th
us
at
an
in
terface
x

x
j

f

is
ev
aluated
using
U
j

x
j

t
and
f

is
ev
aluated
using
U
j


x
j

t
Calculating
uxes
based
on
the
solution
of
Riemann
problems
is
another
p
opular
w
a
y
of
sp
ecifying
n
umerical
uxes
for
v
ector
systems
T
o
this
end
let
w

xt
u
L

u
R

b
e
the
solution
of
a
Riemann
problem
for

a
with
the
p
eicewiseconstan
t
initial
data


The
solution
of
a
Riemann
problem
breaking
at

x
j

t
n

w
ould
b
e
w


x

x
j

t

t
n

U
j

x
j

t
n

U
j

x
j


t
n

Using
this
w
e
w
ould
calculate
the
n
umerical
ux
at

x
j

t
t
	
t
n

as
F
U
j

x
j

t
n

U
j


x
j

t
n


f

w


U
j

x
j

t
n

U
j


x
j

t
n





Hyp
erb
olic
Problems
Example

Let
us
calculate
the
n
umerical
ux
based
on
the
solution
of
a
Rie
mann
problem
for
Burgers
equation


Using
the
results
of
Example

w
e
kno
w
that
the
solution
of
the
appropriate
Riemann
problem
is
w


U
j

U
j














U
j

if
U
j

U
j

	

U
j


if
U
j

U
j




if
U
j


U
j

	

U
j

if
U
j
	

U
j




U
j

U
j


	

U
j


if
U
j
	

U
j




U
j

U
j






The
argumen
ts
of
U
j
and
U
j

are
all

x
j

t
n

These
ha
v
e
b
een
omitted
for
clarit
y

With
f

u

u


for
Burgers
equation
w
e
nd
the
n
umerical
ux
F

U
j

U
j














U

j

if
U
j

U
j

	

U

j


if
U
j

U
j




if
U
j


U
j

	

U

j

if
U
j
	

U
j




U
j

U
j


	

U

j


if
U
j
	

U
j




U
j

U
j





Letting
u


max
u

u


min

u

w
e
can
write
the
n
umerical
ux
more
concisely
as
F

U
j

U
j



max
U

j




U

j




When
used
with
a
piecewiseconstan
t
basis
and
forw
ard
Euler
time
in
tegration
the
result
ing
discon
tin
uous
Galerkin
sc
heme
is
iden
tical
to
Go
duno
vs
nite
dierence
sc
heme

This
w
as
the
rst
dierence
sc
heme
to
b
e
based
on
the
solution
of
a
Riemann
problem
This
early
w
ork
and
a
subsequen
t
w
ork
of
Glimm


and
Chorin
	

stim
ulated
a
great
deal
of
in
terest
in
using
Riemann
problems
to
construct
n
umerical
ux
functions
A
summary
of
a
large
n
um
b
er
of
c
hoices
app
ears
in
Co
c
kburn
and
Sh
u



Multidimensional
Discon
tin
uous
Galerkin
Meth
o
ds
Let
us
extend
the
discon
tin
uous
Galerkin
metho
d
to
m
ultidimensional
conserv
ation
la
ws
of
the
form
u
t

r

f

u
x

b
x
y

z

t
u

x
y

z


 
t
	


a
where
f

u

f

u
g

u
h
u

b


Multidimensional
Discon
tin
uous
Galerkin
Metho
ds

and
r

f

u

f

u
x

g

u
y

h
u
z


c
The
solution
u
x
y

z

t
comp
onenets
of
the
ux
v
ector
f

u
g

u
and
h
u
and
the
loading
b
x
y

z

t
u
are
mv
ectors
and
 
is
a
b
ounde
region
of



Boundary
conditions
m
ust
b
e
prescrib
ed
on

 
along
c
haracteristics
that
en
ter
the
region
W
ell
see
what
this
means
b
y
example
Initial
condtions
prescrib
e
u
x
y

z





x
y

z


 


 

d
F
ollo
wing
our
analysis
of
Section

w
e
partition
 
in
to
a
set
of
nite
elemen
ts
 
j

j







N


and
construct
a
w
eak
form
of
the
problem
on
an
elemen
t
This
is
done
as
usual
b
y
m
ultiplying

a
b
y
a
test
function
v

L


 
j

in
tegrating
o
v
er
 
j

and
applying
the
div
ergence
theorem
to
the
ux
to
obtain

v

u
t

j


v

f

n
	
j

rv

f

j


v

b
j

v

L


 
j


a
where

v

u
j

Z

j
v
T
udxdy
dz


b

rv

f

j

Z

j
v
T
x
f

u

v
T
y
g

u

v
T
z
h
udxdy
dz


c
f

n

f
n

f

un


g

un


h
un



d
and

v

f

n
	
j

Z


j
v
T
f
n
dS

e
The
v
ector
n

n


n


n


T
is
the
unit
out
w
ard
normal
v
ector
to

 
and
dS
is
a
surface
innitessimal
on

 
j

Only
the
normal
comp
onen
t
of
the
ux
is
in
v
olv
ed
in


hence
its
appro
xi
mation
on

 
j
is
the
same
as
the
onedimensional
problems
of
Section

Th
us
the
n
umerical
normal
ux
function
can
b
e
tak
en
as
a
onedimensional
n
umerical
ux
using
solution
v
alues
on
eac
h
side
of

 
j

In
order
to
sp
ecify
this
more
precisely

let
nb
jk

k







N
E

denote
the
indices
of
the
N
E
elemen
ts
sharing
the
b
ounding
faces
of
 
j
and
let

 
jk

k







N
E

b
e
the
faces
of
 
j

Figure

Then
w
e
write

a
in
the
more
explicit
form

v

u
t

j

N
E
X
k


v

F
n

U
j

U
nb
jk

	
jk

rv

f

j


v

b
j

v

L


 
j





Hyp
erb
olic
Problems
Ω
Ω
Ω
Ω
j
nb
nbj,1
nb
j,3
j,2
Figure

Elemen
t
j
and
its
neigh
b
oring
elemen
ts
indicating
that
the
segmen
ts

 
jk

k







N
E


Without
the
need
to
main
tain
in
terelemen
t
con
tin
uit
y

virtually
an
y
p
olynomial
basis
can
b
e
used
for
the
appro
ximate
solution
U
j

x
y

z

t
on
 
j

T
ensor
pro
ducts
of
Legendre
p
olynomials
can
pro
vide
a
basis
on
square
or
cubic
canonical
elemen
ts
but
these
are
una
v
ailable
for
triangles
and
tetrahedra
Appro
ximations
on
triangles
and
tetrahedra
can
use
a
basis
of
monomial
terms
F
o
cusing
on
t
w
odimensional
problems
on
the
canonical

righ
t



triangle
w
e
write
the
nite
elemen
t
solution
in
the
usual
form
U
j

x
y

t

n
p
X
k

c
k
j
N
k







where
n
p


p


p


is
the
n
um
b
er
of
monomial
terms
in
a
complete
p
olynomial
of
degree
p
A
basis
of
monomial
terms
w
ould
set
N



N




N








N
n
p


p





Multidimensional
Discon
tin
uous
Galerkin
Metho
ds

All
terms
in
the
mass
matrix
can
b
e
ev
aluated
b
y
exact
in
tegration
on
the
canonical
triangle

cf
Problem

at
the
end
of
this
section
as
long
as
it
has
straigh
t
sides
ho
w
ev
er
without
orthogonalit
y

the
mass
matrix
will
not
b
e
diagonal
This
is
not
a
sev
ere
restriction
since
the
mass
matrix
is
indep
enden
t
of
time
and
th
us
need
only
b
e
in
v
erted

factored
once
The
illconditioning
of
the
mass
matrix
at
high
p
is
a
more
imp
ortan
t
concern
with
the
monomial
basis


Illconditioning
can
b
e
reduced
and
the
mass
matrix
diagonalized
b
y
extracting
an
orthogonal
basis
from
the
monomial
basis


This
can
b
e
done
b
y
the
Gram
Sc
hmidt
orthogonalization
pro
cess
sho
wn
in
Figure

The
inner
pro
duct
and
norm
are
dened
in
L

on
the
canonical
elemen
t
as
pro
cedure
gram
N
!
N


N

kN

k

for
k


to
n
p
do
t

N
k

P
k

i

N
k

!
N
i


!
N
i
!
N
k

tktk

bf
end
for
return
!
N
Figure

GramSc
hmidt
pro
cess
to
construct
an
orthogonal
basis
!
N
k
k







n
p
from
a
basis
of
monomials
N
k

k







n
p


u
v



Z


Z


uv
d
d

kuk



u
u




a
The
result
of
the
GramSc
hmidt
pro
cess
is
a
basis
!
N
k

k







n
p
that
satises
the
orthogonalit
y
condition

!
N
i

!
N
k



ik

i
k







n
p


b
The
actual
pro
cess
can
b
e
done
using
sym
b
olic
computation
using
a
computer
algebra
system
suc
h
as
M
AP
LE
or
M
AT
H
E
M
AT
I
C
A

cf
Remacle
et
al

and
Problem

at
the
end
of
this
section
Example

W
e
will
illustrate
some
results
using
the
discon
tin
uous
Galerkin
metho
d
to
solv
e
t
w
o
and
threedimensional
compressible
o
w
problems
in
v
olving
the


Hyp
erb
olic
Problems
Euler
equations
This
complex
nonlinear
system
has
the
form
of

a
with
u








m
n
l
e







f

u

f

u
g

u
h
u







m
n
l
m



p
nm
l
m
mn
n



p
l
n
ml

nl

l



p

e

pm

e

pn

e

pb







b
x
t
u




















a
Here

is
the
uid
densit
y
m
n
and
l
are
the
Cartesian
comp
onen
ts
of
the
momen
tum
v
ector
p
er
unit
v
olume
e
is
the
total
energy
p
er
unit
v
olume
and
p
is
the
pressure
whic
h
m
ust
satisfy
an
equation
of
state
of
the
form
p




e


m


n


l



b
This
equation
of
state
assumes
an
ideal
uid
with
gas
constan
t


Let
us
consider
a
classical
Ra
yleighT
a
ylor
instabilit
y
whic
h
has
a
hea
vy




uid
ab
o
v
e
a
ligh
t




uid

Figure

This
h
ydrostatic
conguration
is
unstable
and
an
y
sligh
t
p
erturbation
will
cause
the
hea
vier
uid
to
fall
and
the
ligh
ter
one
to
rise
The
uid
motion
is
quite
complex
and
Remacle
et
al


sim
ulated
it
using
discon
tin
uous
Galerkin
metho
ds
They
considered
t
w
odimensional
motion

l




z


in


with
the
initial
p
erturbation




if


y



if


y



p




y

if


y





y

if


y


u


x
sin

x
cos

y
sin



y

v


y
cos

sin


y

Here
u
v

and
w
are
the
Cartesian
v
elo
cit
y
comp
onen
ts
and






and

x
and

y
w
ere
c
hosen
to
b
e
small
The
b
oundary
conditions
sp
ecify
that
u


on
the
sides
and
top
and
v


on
the
b
ottom
Solutions
for
the
densit
y

at
t


are
sho
wn
in
Figure

for
computations
with
p


to

The
mesh
used
for
all
v
alues
of
p
is
sho
wn
in
Figure

The
total
n
um
b
er
of
v
ector
degrees
of
freedom
for
t
w
odimensional
discon
tin
uous
Galerkin
metho
ds
is
N

n
p

Since
there
are
four
unkno
wns
p
er
elemen
t


m
n
and
e
for
t
w
odimensional
o
ws
there
are


	
and

unkno
wns
for
degrees
p




and

resp
ectiv
ely

Fluxes
w
ere
ev
aluated
using
Ro
es
linearized
ux
appro
ximation

No
limiting
w
as
used
for
this
computation
A
highfrequency
ltering

w
as
used
to
suppress
oscillations
in
the
vicinit
y
of
the
in
terface
separating
the
t
w
o
uids


Multidimensional
Discon
tin
uous
Galerkin
Metho
ds

1/4
1/2
1/2
ρ = 1
ρ = 2
Figure

Conguration
for
the
Ra
yleighT
a
ylor
instabilit
y
of
Example

There
are
solid
w
alls
on
the
b
ottom
and
sides
and
op
en
o
w
at
the
top
The
results
with
p


sho
w
v
ery
little
structure
of
the
solution
Those
with
p


sho
w
moreandmore
detail
of
the
o
w
There
is
no
exact
solution
of
this
problem
so
it
is
not
p
ossible
to
appraise
the
eects
of
using
higher
degree
p
olynomials
ho
w
ev
er
solutions
with
more
detail
are
assumed
to
b
e
more
correct
Remacle
et
al


also
did
computations
using
adaptiv
e
prenemen
t
There
is
no
error
estimate
a
v
ailable
for
the
Euler
equations
so
they
used
an
error
indicator
E
j
on
elemen
t
j
consisting
of
E
j

Z

j
r

rdV


X
k






Z


j


j


nb
jk
dS






This
can
b
e
sho
wn

to
b
e
the
length
of
the
in
terface
that
separates
the
t
w
o
uids
on
 
j

Remacle
et
al

increased
the
degree
on
elemen
ts
where
E
j
w
as
ab
o
v
e
the
median
of
all
error
indicators
Results
using
this
adaptiv
e
prenemen
t
strategy
with
p
ranging
from

to

are
sho
wn
in
Figure

The
mesh
used
for
these
computations
w
as


Hyp
erb
olic
Problems
Figure

Densities
for
the
Ra
yleighT
a
ylor
instabilit
y
of
Example

at
t


and
p


to

The
mesh
used
for
all
computations
is
sho
wn
at
the
left
a
uniform
bisection
of
eac
h
elemen
t
of
the
mesh
sho
wn
in
Figure

in
to
four
elemen
ts
Successiv
e
frames
in
Figure

sho
w
the
selected
v
alues
of
p
and
the
densit
y

at
t



and

The
computations
sho
w
the
complex
series
of
bifurcations
that
o
ccur
at
the
in
terface
b
et
w
een
the
t
w
o
uids
Example

Flahert
y
et
al

solv
e
a
o
w
problem
for
the
threedimensional
Eu
ler
equations


in
a
tub
e
con
taining
a
v
en
t

Figure

using
a
piecewiseconstan
t
discon
tin
uous
Galerkin
metho
d
A
v
an
Leer
ux
v
ector
splitting

	



w
as
used
to
ev
aluate
uxes
No
limiting
is
necessary
with
a
rstorder
metho
d
The
main
tub
e
initially
had
a
sup
ersonic
o
w
at
a
Mac
h
n
um
b
er

ratio
of
the
sp
eed
of
the
uid
to
the
sp
eed
of
sound
of

There
w
as
no
o
w
in
the
v
en
t
A
t
time
t


a
h
yp
othetical
diaphragm
b
et
w
een
the
main
and
v
en
t
cylinders
is
ruptured
and
the
o
w
expands
in
to
the
v
en
t
Flahert
y
et
al
citeFLS	
solv
e
this
problem
using
an
adaptiv
e
hrenemen
t
pro
cedure
They
used
the
magnitude
of
densit
y
jumps
across
elemen
t
b
oundaries
as
a
renemen
t
indicator
Solutions
for
the
Mac
h
n
um
b
er
at
t


and

are
sho
wn
on
the
left
of
Figure

for
a
p
ortion
of
the
problem
domain
The
mesh
used
in
eac
h
eac
h
case


Multidimensional
Discon
tin
uous
Galerkin
Metho
ds
	
Figure

Densit
y
for
the
Ra
yleighT
a
ylor
instabilit
y
of
Example

at
t



and


left
to
righ
t
obtained
b
y
adaptiv
e
prenemen
t
The
v
alues
of
p
used
on
eac
h
elemen
t
are
sho
wn
in
the
rst
third
and
fth
frames
with
blue
denoting
p


and
red
denoting
p


is
sho
wn
on
the
righ
t
of
the
gure
A
sho
c
k
forms
on
the
do
wn
wind
end
of
the
v
en
t
tub
e
and
expansion
forms
on
the
up
wind
end
The
mesh
is
largely
concen
trated
in
these
regions
where
the
rapid
solution
c
hanges
o
ccur
The
initial
mesh
consisted
of

elemen
ts
This
rose
to
more
than

elemen
ts
during
the
adaptiv
e
enric
hmen
t
This
computation
w
as
done
on

pro
cessors
of
a
parallel
computer
The
coloring
of
the
images
on
the
righ
t
of
Figure

indicates
pro
cessor
assignmen
ts
The
discon
tin
uous
Galerkin
metho
d
is
still
ev
olving
and
man
y
questions
regarding
ux
ev
aluation
limiting
a
p
osteriori
error
estimation
the
treatmen
t
of
diusiv
e
problems
and
its
eciency
relativ
e
to
standard
nite
elemen
t
metho
ds
remain
unansw
ered
Problems

Construct
a
t
ypical
term
in
the
mass
matrix
on
the
canonical
elemen
t
b
y
in
tegrating
Z


Z


N
m




N
n




d
d
using
the
basis
of
monomials



Use
the
monomial
basis


and
the
GramSc
hmidt
pro
cess
of
Figure

to
construct
an
orthogonal
basis
on
the
canonical
righ
t
triangle
for
p
olynomials
of


Hyp
erb
olic
Problems
Figure

Mac
h
con
tours

left
and
adaptiv
e
meshes

righ
t
used
to
solv
e
the
com
pressible
o
w
problem
of
Example

at
t



top
and
t



b
ottom
degree
p


or
less

Bibliograph
y

M
Abromo
witz
and
IA
Stegun
Handb
o
ok
of
Mathematic
al
F
unctions
v
olume

of
Applie
d
Mathematics
Series
National
Bureau
of
Standards
Gathersburg
	

S
Adjerid
KD
Devine
JE
Flahert
y

and
L
Kriv
o
dono
v
a
A
p
osteriori
error
esti
mation
for
discon
tin
uous
Galerkin
solutions
of
h
yp
erb
olic
problems
In
preparation


F
Bassi
and
S
Reba
y

A
highorder
accurate
discon
tin
uous
nite
elemen
t
metho
d
for
the
n
umerical
solution
of
the
compressible
na
vierstok
es
equations
Journal
of
Computational
Physics
"	
		

CE
Baumann
and
JT
Oden
A
discon
tin
uous
hp
nite
elemen
t
metho
d
for
con
v
ectiondiusion
problems
to
app
ear
			

KS
Bey
and
JT
Oden
hpv
ersion
discon
tin
uous
galerkin
metho
d
for
h
yp
er
b
olic
conserv
ation
la
ws
Computer
Metho
ds
in
Applie
d
Me
chanics
and
Engine
ering
	"
		

KS
Bey

JT
Oden
and
A
P
atra
hpv
ersion
discon
tin
uous
galerkin
metho
d
for
h
y
p
erb
olic
conserv
ation
la
ws
A
parallel
strategy

International
Journal
of
Numeric
al
Metho
ds
in
Engine
ering
	"	
		

KS
Bey

JT
Oden
and
A
P
atra
A
parallel
hpadaptiv
e
discon
tin
uous
galerkin
metho
d
for
h
yp
erb
olic
conserv
ation
la
ws
Applie
d
Numeric
al
Mathematics
"

		

R
Bisw
as
KD
Devine
and
JE
Flahert
y

P
arallel
adaptiv
e
nite
elemen
t
metho
ds
for
conserv
ation
la
ws
Applie
d
Numeric
al
Mathematics
"
		
	
AJ
Chorin
Random
c
hoice
solution
of
h
yp
erb
olic
systems
Journal
of
Computa
tional
Physics
"
	



Hyp
erb
olic
Problems

B
Co
c
kburn
G
Karniadakis
and
CW
Sh
u
editors
Disc
ontinous
Galerkin
Meth
o
ds
The
ory
Computation
and
Applic
ations
v
olume

of
L
e
ctur
e
Notes
in
Compu
tational
Scienc
e
and
Engine
ering
Berlin

Springer

B
Co
c
kburn
SY
Lin
and
CW
Sh
u
TVB
RungeKutta
lo
cal
pro
jection
discon
tin
uous
nite
elemen
t
metho
d
for
conserv
ation
la
ws
I
I
I
Onedimensional
systems
Journal
of
Computational
Physics
	"
		

B
Co
c
kburn
and
CW
Sh
u
TVB
RungeKutta
lo
cal
pro
jection
discon
tin
uous
nite
elemen
t
metho
d
for
conserv
ation
la
ws
I
I
General
framew
ork
Mathematics
of
Computation
"
		

K
Devine
and
JE
Flahert
y

P
arallel
adaptiv
e
hprenemen
t
tec
hniques
for
conser
v
ation
la
ws
Applie
d
Numeric
al
Mathematics
"
		

K
Eric
ksson
and
C
Johnson
Adaptiv
e
nite
elemen
t
metho
ds
for
parab
olic
prob
lems
I
A
linear
mo
del
problem
SIAM
Journal
on
Numeric
al
A
nalysis
"
		

K
Eric
ksson
and
C
Johnson
Adaptiv
e
nite
elemen
t
metho
ds
for
parab
olic
prob
lems
I
I
Optimal
error
estimates
in
l

l

and
l

l


SIAM
Journal
on
Numeric
al
A
nalysis
"
		

JE
Flahert
y

R
Lo
y

MS
Shephard
BK
Szymanski
J
T
eresco
and
L
Zian
tz
Adaptiv
e
lo
cal
renemen
t
with
o
ctree
loadbalancing
for
the
parallel
solution
of
threedimensional
conserv
ation
la
ws
Journal
of
Par
al
lel
and
Distribute
d
Computing
	"
		

J
Glimm
Solutions
in
the
large
for
nonlinear
h
yp
erb
olic
systems
of
equations
Communic
ations
on
Pur
e
and
Applie
d
Mathematics
	"
	

SK
Go
duno
v
A
nite
dierence
metho
d
for
the
n
umerical
computation
of
dis
con
tin
uous
solutions
of
the
equations
of
uid
dynamics
Mat
Sb
ornik
"
		
	
C
Johnson
Error
estimates
and
adaptiv
e
time
step
con
trol
for
a
class
of
one
step
metho
ds
for
sti
ordinary
dieren
tial
equations
SIAM
Journal
on
Numeric
al
A
nal
ysis
	"	
	

P
D
Lax
Hyp
erb
olic
Systems
of
Conservation
L
aws
and
the
Mathematic
al
The
ory
of
Sho
ck
Waves
Regional
Conference
Series
in
Applied
Mathematics
No

SIAM
Philadelphia
	


Multidimensional
Discon
tin
uous
Galerkin
Metho
ds


WH
Reed
and
TR
Hill
T
riangular
mesh
metho
ds
for
the
neutron
transp
ort
equation
T
ec
hnical
Rep
ort
LAUR	
Los
Alamos
Scien
tic
Lab
oratory

Los
Alamos
	

JF
Remacle
JE
Flahert
y

and
MS
Shephard
Adaptiv
e
order
discon
tin
uous
galerkin
metho
ds
In
preparation


P
L
Ro
e
Appro
ximate
Riemann
solv
ers
parameter
v
ectors
and
dierence
sc
hemes
Journal
of
Computational
Physics
"
	

P

Le
Sain
t
and
P

Ra
viart
On
a
nite
elemen
t
metho
d
for
solving
the
newtron
transp
ort
equations
In
C
de
Bo
or
editor
Mathematic
al
Asp
e
cts
of
Finite
Elements
in
Partial
Dier
ential
Equations
pages
	"
New
Y
ork
	
Academic
Press

GA
So
d
Numeric
al
Metho
ds
in
Fluid
Dynamic
Cam
bridge
Univ
ersit
y
Press
Cam
bridge
	

JL
Steger
and
RF
W
arming
Flux
v
ector
splitting
of
the
in
viscid
gasdynamic
equations
with
applications
to
nite
dierence
metho
ds
Journal
of
Computational
Physics
"	
	

B
v
an
Leer
Fluxv
ector
splitting
gor
the
Euler
equations
L
e
ctur
e
Notes
in
Physics
"
	

MF
Wheeler
An
elliptic
collo
cationnite
elemen
t
metho
d
with
in
terior
p
enalties
SIAM
Journal
on
Numeric
al
A
nalysis
"
	

