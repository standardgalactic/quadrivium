123
SPRINGER BRIEFS IN 
ELECTRICAL AND COMPUTER ENGINEERING
Awais Khawar
Ahmed Abdelhadi
T. Charles Clancy
Spectrum Sharing 
Between Radars 
and Communication 
Systems
 A MATLAB Based 
Approach 

SpringerBriefs in Electrical and Computer
Engineering

More information about this series at http://www.springer.com/series/10059

Awais Khawar
• Ahmed Abdelhadi
T. Charles Clancy
Spectrum Sharing Between
Radars and Communication
Systems
A MATLAB Based Approach
123

Awais Khawar
Federated Wireless
Arlington, VA
USA
Ahmed Abdelhadi
Virginia Tech
Arlington, VA
USA
T. Charles Clancy
Virginia Tech
Arlington, VA
USA
ISSN 2191-8112
ISSN 2191-8120
(electronic)
SpringerBriefs in Electrical and Computer Engineering
ISBN 978-3-319-56683-2
ISBN 978-3-319-56684-9
(eBook)
DOI 10.1007/978-3-319-56684-9
Library of Congress Control Number: 2017936651
© The Author(s) 2018
This work is subject to copyright. All rights are reserved by the Publisher, whether the whole or part
of the material is concerned, speciﬁcally the rights of translation, reprinting, reuse of illustrations,
recitation, broadcasting, reproduction on microﬁlms or in any other physical way, and transmission
or information storage and retrieval, electronic adaptation, computer software, or by similar or
dissimilar methodology now known or hereafter developed.
The use of general descriptive names, registered names, trademarks, service marks, etc. in this
publication does not imply, even in the absence of a speciﬁc statement, that such names are exempt
from the relevant protective laws and regulations and therefore free for general use.
The publisher, the authors and the editors are safe to assume that the advice and information in this
book are believed to be true and accurate at the date of publication. Neither the publisher nor the
authors or the editors give a warranty, express or implied, with respect to the material contained herein or
for any errors or omissions that may have been made. The publisher remains neutral with regard to
jurisdictional claims in published maps and institutional afﬁliations.
Printed on acid-free paper
This Springer imprint is published by Springer Nature
The registered company is Springer International Publishing AG
The registered company address is: Gewerbestrasse 11, 6330 Cham, Switzerland

Preface
Radio frequency spectrum is a scarce and critical natural resource that is utilized for
many services including surveillance, navigation, communication, and broadcast-
ing. Recent years have seen tremendous growth in the use of spectrum especially by
commercial cellular operators. Ubiquitous use of smartphones and tablets is one
of the reasons behind an all-time high utilization of spectrum. As a result, cellular
operators are experiencing a shortage of radio spectrum to meet bandwidth
demands of users. On the other hand, spectrum measurements have shown that
much spectrum not held by cellular operators is underutilized even in dense urban
areas. This has motivated shared access to spectrum by secondary systems with no
or minimal impact on incumbent systems. Spectrum sharing is a promising
approach to solve the problem of spectrum congestion as it allows cellular operators
access to more spectrum in order to satisfy the ever-growing bandwidth demands of
commercial users.
The US spectrum regulatory bodies, the Federal Communications Commission
(FCC) and the National Telecommunications and Information Administration
(NTIA), are working on an initiative to share 150 MHz of spectrum, held by federal
agencies, in the band 3550–3700 MHz with commercial wireless operators. This
band is primarily used by the Department of Defense for air-, ground-, and ship-
borne radar systems that are critical to national defense. Field tests have shown that
spectrum sharing between radars and communication systems require large sepa-
ration distance in order to protect them from harmful interference. This excludes
large population of the US from reaping the beneﬁts of spectrum sharing and has
little to no business value for commercial operators. Thus, novel methods are
required to ensure spectrum sharing between the two systems without the need of
large protect distances.
In order to efﬁciently share spectrum between radars and communication sys-
tems at the same time and in the same geographical area, this book proposes novel
methods that transform radar signal in such a way that it does not interfere with
communication systems. This is accomplished by projecting the radar signal onto
null space of the wireless channel between radar and communication system.
Basically, nulls are formed in radar beampattern in the direction of communication
v

systems. The proposed signal shaping/design approach not only meets radar
objectives but also meets spectrum sharing objectives. However, there is a trade-off
as signal shaping or designing new radar signal, with spectrum sharing constraint,
results in some performance degradation for radars. Therefore, it is of interest to
study the impact of projection on radar performance. Performance metrics such
as probability of target detection, Cramer–Rao bound and maximum likelihood
estimate of target's angle of arrival, and beampattern of radar are studied for per-
formance degradation. The results show minimal degradation in radar performance
and signiﬁcant reduction in exclusion zones, thus, showing the efﬁcacy of the
proposed approach.
Spectrum sharing between radars and communication systems is an important
cross-disciplinary research area of federal and commercial interest. The methods
proposed for spectrum sharing in this book allow radars and communication sys-
tems to operate in a geographical area without the need for exclusion zones,
required to protect both systems from each other interference, and promise highly
sought-after capacity gains for communication systems.
Arlington, VA, USA
Awais Khawar
September 2016
Ahmed Abdelhadi
T. Charles Clancy
vi
Preface

Acknowledgements
The work reported in this book was supported by DARPA under the SSPARC
program. Contract Award Number: HR0011-14-C-0027. We are grateful to our
sponsors for funding spectrum sharing research between radar and communication
systems.
vii

Contents
1
Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1
Awais Khawar, Jasmin Mahal and Chowdhury Shahriar
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
4
2
A Projection-Based Approach to Spectrum Sharing . . . . . . . . . . . . . .
7
Awais Khawar, Ahmed Abdelhadi and T. Charles Clancy
2.1
System Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
8
2.1.1
Radar Model. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
8
2.1.2
Target Model/Channel . . . . . . . . . . . . . . . . . . . . . . . . . . .
8
2.1.3
Signal Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
9
2.1.4
Modeling Assumptions . . . . . . . . . . . . . . . . . . . . . . . . . . .
9
2.1.5
Statistical Assumptions . . . . . . . . . . . . . . . . . . . . . . . . . . .
10
2.1.6
Orthogonal Waveforms. . . . . . . . . . . . . . . . . . . . . . . . . . .
10
2.1.7
Communication System . . . . . . . . . . . . . . . . . . . . . . . . . .
10
2.1.8
Interference Channel. . . . . . . . . . . . . . . . . . . . . . . . . . . . .
11
2.1.9
Cooperative RF Environment . . . . . . . . . . . . . . . . . . . . . .
11
2.2
Radar-Cellular System Spectrum Sharing. . . . . . . . . . . . . . . . . . . .
12
2.2.1
Architecture . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
12
2.3
Spectrum Sharing Algorithms for Small MIMO Radar . . . . . . . . .
13
2.3.1
Performance Metrics. . . . . . . . . . . . . . . . . . . . . . . . . . . . .
13
2.3.2
Interference-Channel-Selection Algorithm. . . . . . . . . . . . .
14
2.3.3
Modiﬁed-Null-Space Projection (NSP) Algorithm . . . . . .
15
2.3.4
Simulation Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
18
2.4
Spectrum Sharing Algorithms for Large MIMO Radar . . . . . . . . .
20
2.4.1
Projection Matrix . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
21
2.4.2
Spectrum Sharing and Projection Algorithms . . . . . . . . . .
24
2.4.3
Statistical Decision Test for Target Detection . . . . . . . . . .
25
2.4.4
Numerical Results. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
30
2.5
Conclusion. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
35
ix

2.6
MATLAB Code. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
35
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
37
3
Coloacted MIMO Radar and CoMP Cellular System . . . . . . . . . . . . .
39
Jasmin Mahal, Awais Khawar, Ahmed Abdelhadi
and T. Charles Clancy
3.1
Radar/CoMP System Spectral-Coexistence Models . . . . . . . . . . . .
41
3.1.1
Coordinated Multi-point (CoMP) System . . . . . . . . . . . . .
41
3.1.2
Clustering Algorithms. . . . . . . . . . . . . . . . . . . . . . . . . . . .
43
3.1.3
Colocated MIMO Radar . . . . . . . . . . . . . . . . . . . . . . . . . .
44
3.1.4
Spectral-Coexistence Scenario . . . . . . . . . . . . . . . . . . . . .
46
3.2
Signal Design for Spectral Coexistence . . . . . . . . . . . . . . . . . . . . .
46
3.2.1
Radar Precoder Design for Interference Mitigation. . . . . .
47
3.2.2
Radar Precoder Design for Cooperation . . . . . . . . . . . . . .
50
3.2.3
CoMP Signal Design for Interference Mitigation . . . . . . .
50
3.2.4
CoMP Signal Design for Cooperation . . . . . . . . . . . . . . .
52
3.2.5
The Impact of Ship’s Motion on Radar Precoder
Design . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
53
3.2.6
The Two Modes of Operation and the PRI of Radar . . . .
53
3.3
Spectrum Sharing Algorithms . . . . . . . . . . . . . . . . . . . . . . . . . . . .
53
3.3.1
Optimal Cluster Selection Algorithm . . . . . . . . . . . . . . . .
54
3.3.2
Small Singular Value Space Projection (SSVSP)
Algorithm . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
54
3.4
Theoretical Performance Analysis of the Radar Precoder. . . . . . . .
55
3.5
Simulation Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
58
3.5.1
Performance Analysis of Interference Mitigating
Precoder . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
58
3.5.2
Performance Analysis of Information Exchange
Precoder . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
61
3.6
Conclusion. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
61
3.7
MATLAB Code. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
62
3.7.1
Interference Mitigation Mode . . . . . . . . . . . . . . . . . . . . . .
62
3.7.2
Cooperation Mode . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
71
3.7.3
Several Functions for both Modes . . . . . . . . . . . . . . . . . .
72
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
73
4
Overlapped-MIMO Radar and MIMO Cellular System . . . . . . . . . . .
75
Chowdhury Shahriar, Ahmed Abdelhadi and T. Charles Clancy
4.1
System Model for Coexistence . . . . . . . . . . . . . . . . . . . . . . . . . . .
76
4.1.1
Radar Model. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
76
4.1.2
Communications System Model . . . . . . . . . . . . . . . . . . . .
77
4.1.3
Coexistence Channel Model . . . . . . . . . . . . . . . . . . . . . . .
77
4.1.4
Key Assumptions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
77
x
Contents

4.2
Colocated MIMO Radar. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
79
4.3
Overlapped-MIMO Radar . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
81
4.4
Performance Metrics for Overlapped-MIMO Radar . . . . . . . . . . . .
84
4.4.1
Beampattern Improvement . . . . . . . . . . . . . . . . . . . . . . . .
84
4.4.2
SNR Gain Improvement . . . . . . . . . . . . . . . . . . . . . . . . . .
85
4.5
Optimum Subarray Size for Overlapped-MIMO Radar . . . . . . . . .
86
4.6
Radar-Centric Spectrum Sharing Algorithm. . . . . . . . . . . . . . . . . .
87
4.6.1
Null Space Projection (NSP) . . . . . . . . . . . . . . . . . . . . . .
87
4.6.2
Projection Matrix . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
87
4.7
Assumptions and Limiting Factors of NSP . . . . . . . . . . . . . . . . . .
89
4.8
Simulation and Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
90
4.9
Conclusion. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
92
4.10
MATLAB Code. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
94
4.10.1
Overlapped-MIMO Main Module. . . . . . . . . . . . . . . . . . .
94
4.10.2
Uplink Beamforming Matrix. . . . . . . . . . . . . . . . . . . . . . .
95
4.10.3
Virtual Steering Vector. . . . . . . . . . . . . . . . . . . . . . . . . . .
96
4.10.4
Number of Subarray . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
97
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
97
Index . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
99
Contents
xi

About the Authors
Dr. Awais Khawar is a Senior Engineer at Federated Wireless. He received his
B.S. in telecommunication engineering from the National University of Computer
and Emerging Sciences, Peshawar, Pakistan (2007), M.S. in electrical engineering
from the University of Maryland at College Park (2010), and Ph.D. in electrical
engineering from Virginia Tech (2015). At the University of Maryland his research
focused on the security aspect of spectrum sensing in cognitive radio networks. His
work on spectrum sensing security has featured in the IEEE COMSOC Best
Readings in Cognitive Radio. At Virginia Tech his research focused on spectrum
sharing, security, optimization, and resource allocation for coexisting wireless
communication and radar systems. Dr. Khawar has co-authored more than 20
peer-reviewed technical publications. He is also co-author of the book MIMO
Radar Waveform Design for Spectrum Sharing with Cellular Systems (Springer,
2016).
Dr. Ahmed Abdelhadi is a Research Assistant Professor at Virginia Tech. He
received his Ph.D. in Electrical and Computer Engineering from the University of
Texas at Austin in December 2011. He was a member of Wireless Networking and
Communications Group (WNCG) during his Ph.D. In 2012, he joined Bradley
Department of Electrical and Computer Engineering and Hume Center for National
Security and Technology at Virginia Tech. His research interests are in the areas
of resource allocation optimization, radar and wireless systems, and security.
Dr. Abdelhadi has coauthored more than 50 journal and conference papers and
5 books in these research topics.
Dr. Charles Clancy is an Associate Professor of Electrical and Computer
Engineering at Virginia Tech and directs of the Hume Center for National Security
and Technology. Prior to joining Virginia Tech in 2010, he served as a senior
researcher at the Laboratory for Telecommunications Sciences, a defense research lab
at the University of Maryland, where he led research programs in software-deﬁned
xiii

and cognitive radio. Dr. Clancy received his B.S. in Computer Engineering from the
Rose-Hulman Institute of Technology, M.S. in Electrical Engineering from the
University of Illinois, and his Ph.D. in Computer Science from the University of
Maryland. He is a Senior Member of the IEEE and has over 150 peer-reviewed
technical publications. His current research interests include cognitive communica-
tions and spectrum security.
xiv
About the Authors

List of Figures
Figure 1.1
Idle spectrum . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
3
Figure 2.1
Spectrum Sharing Scenario. . . . . . . . . . . . . . . . . . . . . . . . . . . .
12
Figure 2.2
CRB on target direction estimation. . . . . . . . . . . . . . . . . . . . . .
18
Figure 2.3
ML on target direction estimation. . . . . . . . . . . . . . . . . . . . . . .
19
Figure 2.4
Beampattern of MIMO radar . . . . . . . . . . . . . . . . . . . . . . . . . .
19
Figure 2.5
Performance of spectrum sharing algorithms . . . . . . . . . . . . . .
31
Figure 2.6
PD as a function of SNR for Hi with dimensions 2  4 . . . . . .
32
Figure 2.7
PD as a function of SNR for Hi with dimensions 2  8 . . . . . .
33
Figure 2.8
PD as a function of SNR for all BSs in the network . . . . . . . .
34
Figure 3.1
Spectral coexistence: MIMO radar with CoMP system. . . . . . .
42
Figure 3.2
Conﬁguration of radar antenna array . . . . . . . . . . . . . . . . . . . .
45
Figure 3.3
Coupling scenario between littoral radar
and LTE systems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
46
Figure 3.4
Modes of operation and the PRI of radar . . . . . . . . . . . . . . . . .
54
Figure 3.5
Variation in null space . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
56
Figure 3.6
CRB on direction estimation of the target as a function
of antennas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
56
Figure 3.7
Analysis of the number of radar antennas for CRB . . . . . . . . .
57
Figure 3.8
Variation of radar interference on BS clusters . . . . . . . . . . . . .
58
Figure 3.9
CRB on direction estimation of the target . . . . . . . . . . . . . . . .
59
Figure 3.10
BER performance during cooperation mode . . . . . . . . . . . . . . .
60
Figure 4.1
Spectrum Sharing Scenario. . . . . . . . . . . . . . . . . . . . . . . . . . . .
78
Figure 4.2
Overlapped-MIMO radar . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
82
Figure 4.3
Conventional radar beamformer . . . . . . . . . . . . . . . . . . . . . . . .
91
Figure 4.4
NSP-based radar beamformer . . . . . . . . . . . . . . . . . . . . . . . . . .
92
Figure 4.5
Analysis of subarrays of a Overlapped-MIMO radar . . . . . . . .
93
xv

Chapter 1
Introduction
Awais Khawar, Jasmin Mahal and Chowdhury Shahriar
Cellular network operators are predicting a 1000× increase in capacity to keep pace
with the tremendous growth of aggregate and per-subscriber data trafﬁc [1]. Increased
investments in infrastructure, e.g., larger number of small cells, and more spectrally
efﬁcient technologies, e.g., LTE-Advanced, can help meet this challenge partially.
The Federal Communications Commission (FCC) is considering a number of options
including incentive auctioning and sharing of federal spectrum to meet the commer-
cial spectrum requirements. Of these two, spectrum sharing is a quite promising
technology due to the large number of underutilized federal spectrum bands that
can be shared with commercial cellular operators to satisfy their growing demands.
But spectrum sharing is associated with its inherent set of challenges because the
incumbents need to be protected from the harmful interference that can arise due to
the operation of other systems in the shared bands.
Spectrum sharing between wireless communication systems and radars is an
emerging area of research. In the past, spectrum has been shared primarily between
wireless communication systems using opportunistic approaches by users equipped
with cognitive radios [2]. This type of spectrum sharing has been made possible with
the use of spectrum sensing [3], or geolocation databases [4], or a combination of
both in the form of radio environment maps (REM) [5]. Some recent efforts have
explored co-channel sharing approaches among secondary network entities, please
see [6] and reference therein. However, in contrast, co-channel spectrum sharing
between wireless systems and radars has received little attention thus far because of
regulatory concerns.
Spectrum policy regulators, in the past, have not allowed commercial wireless
services in radar bands, except in few cases, due to the fear of harmful interfer-
ence from these services to radar systems [7]. Recently, in the United States (U.S.),
the Federal Communications Commission (FCC), has proposed to use the 3550–
3650MHz band for commercial broadband use [8]. The incumbents in this band are
radar and satellite systems [9]. The Commission has proposed that incumbents share
© The Author(s) 2018
A. Khawar et al., Spectrum Sharing Between Radars and Communication Systems,
SpringerBriefs in Electrical and Computer Engineering,
DOI 10.1007/978-3-319-56684-9_1
1

2
1 Introduction
this band with commercial communication systems. The Commission’s spectrum
sharing initiative is motivated by many factors including the President’s National
Broadband plan, which called to free up to 500MHz of federal-held spectrum by
2020 [10]; surge in consumers’ demand for access to mobile broadband, which oper-
ators cannot meet with current spectrum allocations; the report on efﬁcient spectrum
utilization by President’s Council of Advisers on Science and Technology (PCAST),
which emphasized to share 1000MHz of government-held spectrum [11], and the
low utilization of the 3550–3650MHz band by federal incumbents [12].
In future, when radio frequency (RF) spectrum will be shared among many differ-
ent systems, e.g., radars and cellular systems, it is important to access the interference
scenario. Of course, radars will cause interference to communication systems and
vice versa if proper interference-mitigation methods and novel sharing algorithms
are not employed. In a study conducted by the National Telecommunications and
Information Administration (NTIA), it was observed that in order to protect commer-
cial cellular communication systems, from high-power radar signal, large exclusion
zones are required [12]. These exclusion zones cover a large portion of the U.S.
where majority of the population lives and, thus, does not make a business case for
commercial deployment in radar bands. In order to share radar bands for commercial
operation we have to address interference-mitigation techniques at both the systems.
In this work, we focus on interference caused by radar systems to communication
system and propose methods to mitigate this interference.
Protecting the primary user (PU) or the incumbent Federal user from the harmful
interferences from the secondary user (SU) or the commercial user and modifying
the SU signal accordingly is the approach adopted by the ﬁrst two generations of
spectrum sharing between a Federal radar and a commercial communication system.
In this approach, government users are entirely passive as they were not designed
for sharing in mind which places the entire burden on commercial system to main-
tain an extremely high conﬁdence level of interference protection for Federal users.
However, the potential for such sharing with very conservative criteria is naturally
so limited that this approach has made only modest progress in the U.S. to date
[13]. The basic issue is addressed by Michael J. Marcus as presented in Fig.1.1 [13].
The plot shows the percentage of idle spectrum that can be used as a function of
the required conﬁdence of no or negligible interference to the PU. If the PU is not
designed with any sharing in mind as is the case with current incumbents then inter-
ference protections have to consider all possible worst case scenarios. This results in
the very conservative sharing criteria. However, if the PU is originally designed with
the anticipation of sharing and can cooperate with the new user, then a signiﬁcantly
higher fraction of idle spectrum can be utilized. Consequently, as Marcus suggested a
third generation of sharing could be based upon the innovative design of the Federal
systems with the intention of sharing.
The federal-commercial spectrum sharing is not a new practice. In fact, in the past,
commercial wireless systems have shared government bands on a low-transmit power
basis, in order to protect incumbents from interference. An example of such a scenario
is wireless local area network (WLAN) in the 5250–5350 and 5470–5725MHz radar
bands [14]. So, the Commission’s latest initiative to share the 3.5GHz radar band

1
Introduction
3
100%
0%
Fraction of Idle 
Spectrum That 
Can be Used
Intersystem
Cooperation 
Case
Worst Case or
Passive Sensing
Cases
99.9%
99%
95%
90%
Confidence of No Interference
Fig. 1.1 Fraction of idle spectrum that can be used under different cases [13]
with small cells, i.e., wireless base stations operating on a low power, is in harmony
with previous practices [8].
On going research efforts have shown that there are numerous ways to share
spectrum between radars and communication systems. Cooperative sensing based
spectrum sharing approaches can be utilized where radar’s allocated bandwidth is
shared with communication systems [15–17]. A joint communication-radar plat-
form can be envisioned in which spectrally agile radar performs an additional task
of spectrum sensing and upon ﬁnding of unused frequencies it can change its oper-
ating frequency. In addition of spectrum sharing such a setting can enable colocated
radar and communication system platforms for integrated communications and radar
applications [18–21]. Radar waveforms can be shaped in a way that they do not cause
interference to communication systems [22–26]. Moreover, database-aided sensing
at communication systems [27] and beamforming approaches at MIMO radars can
also be realized for spectrum sharing [28].
In this book, we address various aspects of spectrum sharing between different
types of radars and communication systems. We speciﬁcally look at the performance
of spectrum sharing radar systems when they are subject to spectrum sharing con-
straints. In Chap.2, the authors discuss spectrum sharing between a multiple-input
multiple-output (MIMO) ship-borne radar system and a commercial MIMO cellular
network. They design spectrum sharing algorithms and then analyze performance of
radar system. They address the problem of target parameter estimation, detection,
and tracking which lies at the heart of radar signal processing. This problem becomes
critically important when we talk about sharing radar spectrum with other systems,
say cellular systems. In Chap.3, the authors address the speciﬁc problem of spectrum
sharing between a MIMO radar system and a commercial MIMO cellular network
consisting of clusters of cooperative base stations, commonly known as Coordi-
nated Multi-Point (CoMP) system. The authors design the radar precoder for two
modes of operation: cooperation/cognition mode and interference-mitigation mode.
During the cooperation/cognition mode, the radar not only broadcast information

4
1 Introduction
to the communication system using the designed precoder but also, utilizing its
sensing capability, the radar collects information about the BS clusters, estimates
the channel either by using training symbols sent by the communication system
or by blind null-space learning. By processing these information, the radar decides
on the best base station cluster for spectrum sharing during interference-mitigation
mode. In Chap.4, the authors share cellular spectrum with a collocated overlapped
multiple-input multiple-output (Overlapped-MIMO) radar system. The proposed
antenna design origins lesser interference to communication systems along with
retaining high degree performance of MIMO radar (such as retaining improved side-
lobe suppression in the beampattern and achieving higher SNR gain). On the other
hand, the radar-centric projection algorithm to share spectrum avoids interference
to communications system by projecting the radar signal onto the null space of the
communications channel.
References
1. W. Lehr, Toward more efﬁcient spectrum management, in MIT Communications Futures Pro-
gram (2014), pp. 1–31, http://cfp.mit.edu/groups/spectrum-policy.shtml
2. S. Haykin, Cognitive radio: brain-empowered wireless communications. IEEE J. Sel. Areas
Commun. 23, 201–220 (2005)
3. T. Yucek, H. Arslan, A survey of spectrum sensing algorithms for cognitive radio applications.
IEEE Commun. Surv. Tutor. 11, 116–130 (2009)
4. R. Murty, R. Chandra, T. Moscibroda, P.V. Bahl, Senseless: a database-driven white spaces
network. IEEE Trans. Mob. Comput. 11, 189–203 (2012)
5. Y. Zhao, L. Morales, J. Gaeddert, K. Bae, J.-S. Um, J. Reed, Applying radio environment maps
to cognitive wireless regional area networks, in 2nd IEEE International Symposium on New
Frontiers in Dynamic Spectrum Access Networks (DySPAN) (2007), pp. 115–118
6. B. Gao, J. Park, Y. Yang, Uplink soft frequency reuse for self-coexistence of cognitive radio
networks. IEEE Trans. Mobile Comput. 13, 1366–1378 (2014)
7. A. Khawar, A. Abdel-Hadi, T.C. Clancy, A mathematical analysis of LTE interference on the
performance of S-band military radar systems, in 13th Annual Wireless Telecommunications
Symposium (WTS) (Washington, DC, USA, 2014)
8. Federal Communications Commission (FCC), FCC proposes innovative small cell use in 3.5
GHz band, 12 Dec 2012, http://www.fcc.gov/document/fcc-proposes-innovative-small-cell-
use-35-ghz-band
9. A. Khawar, I. Ahmad, A.I. Sulyman, Spectrum sharing between small cells and satellites:
opportunities and challenges, in IEEE ICC 2015 - Workshop on Cognitive Radios and Net-
works for Spectrum Coexistence of Satellite and Terrestrial Systems (CogRaN-Sat) (ICC’15 -
Workshops 02) (London, UK, 2015)
10. Federal Communications Commission (FCC), Connecting America: The national broadband
plan (2010) (Online)
11. The Presidents Council of Advisors on Science and Technology (PCAST), Realizing the full
potential of government-held spectrum to spur economic growth (2012)
12. National Telecommunications and Information Administration (NTIA), An assessment of the
near-term viability of accommodating wireless broadband systems in the 1675–1710 MHz,
1755–1780 MHz, 3500–3650 MHz, 4200–4220 MHz, and 4380–4400 MHz bands (Fast Track
Report) (2010) (Online)
13. M.J. Marcus, New approaches to private sector sharing of federal government spectrum. New
Am. Found. 26, 1–8 (2009)

References
5
14. Federal Communications Commission (FCC), In the matter of revision of parts 2 and 15 of the
commissions rules to permit unlicensed national information infrastructure (U-NII) devices in
the 5 GHz band. MO&O, ET Docket No. 03-122 (2006)
15. L.S. Wang, J.P. McGeehan, C. Williams, A. Doufexi, Application of cooperative sensing in
radar-communications coexistence. IET Commun. 2, 856–868 (2008)
16. S.S. Bhat, R.M. Narayanan, M. Rangaswamy, Bandwidth sharing and scheduling for multi-
modal radar with communications and tracking, in IEEE Sensor Array and Multichannel Signal
Processing Workshop (2012), pp. 233–236
17. R. Saruthirathanaworakun, J. Peha, L. Correia, Performance of data services in cellular net-
works sharing spectrum with a single rotating radar, in IEEE International Symposium on a
World of Wireless, Mobile and Multimedia Networks (WoWMoM) (2012), pp. 1–6
18. C. Rossler, E. Ertin, R. Moses, A software deﬁned radar system for joint communication and
sensing, in IEEE Radar Conference (RADAR) (2011), pp. 1050–1055
19. R.Y.X. Li, Z. Zhang, W. Cheng, Research of constructing method of complete complementary
sequence in integrated radar and communication, in IEEE Conference on Signal Processing,
vol. 3 (2012), pp. 1729–1732
20. C. Sturm, W. Wiesbeck, Waveform design and signal processing aspects for fusion of wireless
communications and radar sensing. Proc. IEEE 99, 1236–1259 (2011)
21. M.P. Fitz, T.R. Halford, I. Hossain, S.W. Enserink, Towards simultaneous radar and spectral
sensing, in IEEE International Symposium on Dynamic Spectrum Access Networks (DYSPAN)
(2014), pp. 15–19
22. S. Sodagari, A. Khawar, T.C. Clancy, R. McGwier, A projection based approach for radar
and telecommunication systems coexistence, in IEEE Global Communications Conference
(GLOBECOM) (2012)
23. X. Chen, X. Wang, S. Xu, J. Zhang, A novel radar waveform compatible with communication,”
in International Conference on Computational Problem-Solving (ICCP) (2011), pp. 177–181
24. A. Khawar, A. Abdel-Hadi, T.C. Clancy, Spectrum sharing between S-band radar and LTE cel-
lular system: a spatial approach, in 2014 IEEE International Symposium on Dynamic Spectrum
Access Networks: SSPARC Workshop (IEEE DySPAN 2014 - SSPARC Workshop) (McLean,
USA, 2014)
25. A. Khawar, A. Abdel-Hadi, T.C. Clancy, MIMO radar waveform design for coexistence with
cellular systems, in 2014 IEEE International Symposium on Dynamic Spectrum Access Net-
works: SSPARC Workshop (IEEE DySPAN 2014 - SSPARC Workshop) (McLean, USA, 2014)
26. A.Khawar,A.Abdelhadi,T.C.Clancy,QPSKwaveformforMIMOradarwithspectrumsharing
constraints, in Physical Communication (2014)
27. F. Paisana, J.P. Miranda, N. Marchetti, L.A. DaSilva, Database-aided sensing for radar bands,
in IEEE International Symposium on Dynamic Spectrum Access Networks (DYSPAN) (2014),
pp. 1–6
28. H. Deng, B. Himed, Interference mitigation processing for spectrum-sharing between radar
and wireless communications systems. IEEE Trans. Aerosp. Electron. Syst. 49(3), 1911–1919
(2013)

Chapter 2
A Projection-Based Approach
to Spectrum Sharing
Awais Khawar, Ahmed Abdelhadi and T. Charles Clancy
Spectrum sharing is a new way forward to solve spectrum scarcity problem. In this
chapter, we ﬁrst propose a spatial approach for spectrum sharing between a MIMO
radar and an LTE cellular system with multiple base stations (BS). The MIMO
radar and LTE share multiple interference channels. We propose projecting the radar
signal onto the null space of interference channel between the MIMO radar and
LTE using our proposed interference-channel-selection algorithm, in order to have
zero-interference from the MIMO radar. We select interference channel with the
maximum null space and project the radar signal onto the null space of this channel.
Our proposed spatial spectrum sharing algorithm is radar-centric such that it causes
minimum loss in radar performance by carefully selecting the interference channel
and at the same time protects the ith LTE BS from the radar interference. Through
our analytical and simulation results we show that the loss in the radar performance
is less when the proposed interference-channel-selection algorithm is used to select
the channel onto which radar signals are projected. Second, we address the problem
of target detection by radars that project waveform onto the null space of interference
channel in order to mitigate interference to cellular systems. We consider a multiple-
input multiple-output (MIMO) radar and a MIMO cellular communication system
with multiple base stations (BS). We consider two spectrum sharing scenarios. In
the ﬁrst scenario the degrees of freedom (DoF) available at the radar are not sufﬁ-
cient enough to simultaneously detect target and mitigate interference to multiple
BSs. For this case, we select one BS among many BSs for waveform projection
The content in this chapter is reproduced with permission after some modiﬁcations (License
number 3926160879020 and 3926160775881). For the original article please refer to: A.
Khawar, A. Abdelhadi, C. Clancy, “Target detection performance of spectrum sharing MIMO
radars”, IEEE Sens. J. 15, 4928-4940 (2015) and A. Khawar, A. Abdelhadi, C. Clancy, “Spec-
trum sharing between S-band radar and LTE cellular system: A spatial approach”, IEEE Inter-
national Symposium on Dynamic Spectrum Access Networks (2014).
© The Author(s) 2018
A. Khawar et al., Spectrum Sharing Between Radars and Communication Systems,
SpringerBriefs in Electrical and Computer Engineering,
DOI 10.1007/978-3-319-56684-9_2
7

8
2 A Projection-Based Approach to Spectrum Sharing
on the basis of guaranteeing minimum waveform degradation. For the second case,
the radar has sufﬁcient DoF to simultaneously detect target and mitigate interfer-
ence to all BSs. We study target detection capabilities of null-space projected (NSP)
waveform and compare it with the orthogonal waveform. We derive the generalized
likelihood ratio test (GLRT) for target detection and derive detector statistic for NSP
and orthogonal waveform. The target detection performance for both waveforms is
studied theoretically and via Monte Carlo simulations.
This chapter is organized as follows. Section2.1 discuss MIMO radar, target chan-
nel, orthogonal waveforms, interference channel, and our cellular system model.
Moreover, it also discusses modeling and statistical assumptions. Section2.2 dis-
cusses spectrum sharing between MIMO radar and cellular system and introduces
sharing architecture and projection algorithms. Section2.3 discusses target parameter
estimation performance for spectrum sharing radars followed by numerical results.
Section2.4.3 presents the generalized likelihood ratio test (GLRT) for target detec-
tion and derives detector statistic for NSP and orthogonal waveform followed by
numerical results. Section2.5 concludes the chapter.
2.1
System Model
In this section, we introduce preliminaries of MIMO radar, point target in far-ﬁeld,
orthogonal waveforms, interference channel, and cellular system model. Moreover,
we also discuss modeling and statistical assumptions along with RF environment
assumptions used throughout the chapter.
2.1.1
Radar Model
The radar we consider in this chapter is a colocated MIMO radar with M transmit and
receive antennas and is mounted on a ship. The colocated MIMO radar has antennas
that have spacing on the order of half the wavelength. Another class of MIMO radar
is widely spaced MIMO radar where elements are widely spaced which results in
enhanced spatial diversity [1]. The colocated radar gives better spatial resolution and
target parameter identiﬁcation as compared to the widely-spaced radar [2].
2.1.2
Target Model/Channel
In this chapter, we consider a point target model which is deﬁned for targets having
a scatterer with inﬁnitesimal spatial extent. This model is a good assumption and
is widely used in radar theory for the case when radar elements are colocated and
there exists a large distance between the radar array and the target as compared to

2.1 System Model
9
inter-element distance [3]. The signal reﬂected from a point target with unit radar
cross-section (RCS) is mathematically represented by the Dirac delta function.
2.1.3
Signal Model
Let x(t) be the signal transmitted from the M-element MIMO radar array, deﬁned as
x(t) =
x1(t)e jωct x2(t)e jωct · · · xM(t)e jωctT
(2.1)
where xk(t)e jωct is the baseband signal from the kth transmit element, ωc is the
carrier angular frequency, t ∈[0, To], with To being the observation time. We deﬁne
the transmit steering vector as
aT (θ) ≜

e−jωcτT1(θ) e−jωcτT2(θ) · · · e−jωcτTM (θ)T .
(2.2)
Then, the transmit-receive steering matrix can be written as
A(θ) ≜aR(θ)aT
T (θ).
(2.3)
Since, we are considering M transmit and receive elements, we deﬁne a(θ) ≜
aT (θ) ≜aR(θ). The signal received from a single point target, in far-ﬁeld with con-
stant radial velocity vr, at an angle θ can be written as
y(t) = α e−jωDtA(θ) x(t −τ(t)) + n(t)
(2.4)
where τ(t) = τTk(t) + τRl(t), denoting the sum of propagation delays between the
target and the kth transmit element and the lth receive element, respectively; ωD
is the Doppler frequency shift, α represents the complex path loss including the
propagation loss and the coefﬁcient of reﬂection, and n(t) is the zero-mean complex
Gaussian noise.
2.1.4
Modeling Assumptions
In order to keep the analysis tractable we have made the following assumptions about
our signal model:
• The path loss α is assumed to be identical for all transmit and receive elements,
due to the far-ﬁeld assumption [4].
• The angle θ is the azimuth angle of the target.
• After compensating the range-Doppler parameters, we can simplify Eq.(2.4) as

10
2 A Projection-Based Approach to Spectrum Sharing
y(t) = α A(θ) x(t) + n(t).
(2.5)
2.1.5
Statistical Assumptions
We make the following assumptions for our received signal model in Eq.(2.5):
• θ and α are deterministic unknown parameters representing the target’s direction
of arrival and the complex amplitude of the target, respectively.
• The noise vector n(t) is independent, zero-mean complex Gaussian with known
covariance matrix Rn = σ2
nIM, i.e., n(t) ∼Nc(0M, σ2
nIM), where Nc denotes the
complex Gaussian distribution.
• With the above assumptions, the received signal model in Eq.(2.5) has independent
complex Gaussian distribution, i.e.,
y(t) ∼Nc(αA(θ) x(t), σ2
nIM)·
(2.6)
2.1.6
Orthogonal Waveforms
In this chapter, we consider orthogonal waveforms transmitted by MIMO radars, i.e.,
Rx =

To
x(t)xH(t)dt = IM.
(2.7)
The transmission of orthogonal signals gives MIMO radar advantages in terms of
digital beamforming at the transmitter in addition to receiver, improved angular
resolution, extended array aperture in the form of virtual arrays, increased number of
resolvable targets, lower sidelobes [5], and lower probability of intercept as compared
to coherent waveforms [4].
2.1.7
Communication System
In this chapter, we consider a MIMO cellular system, with K base stations, each
equipped with N BS transmit and receive antennas, with ith BS supporting LUE
i
user
equipment (UE). The UEs are also multi-antenna systems with N UE transmit and
receive antennas. If sUE
j (t) is the signals transmitted by the jth UE in the ith cell, then
the received signal at the ith BS receiver can be written as
ri(t) =

j
HN BS×N UE
j
sUE
j (t) + w(t)
1 ⩽j ⩽LUE
i
(2.8)
where w(t) is the additive white Gaussian noise.

2.1 System Model
11
2.1.8
Interference Channel
In this section, we characterize the interference channel that exists between MIMO
cellular base station and MIMO radar. In our chapter, we are considering K cellular
BSs that is why our model has Hi, i = 1, 2, . . . , K, interference channels, where the
entries of Hi are denoted by
Hi =
⎡
⎢⎣
h(1,1)
i
· · · h(1,M)
i
...
...
...
h(N BS,1)
i
· · · h(N BS,M)
i
⎤
⎥⎦
(N BS × M)
(2.9)
where h(l,k)
i
denotes the channel coefﬁcient from the kth antenna element at the
MIMO radar to the lth antenna element at the ith BS. We assume that elements of
Hi are independent, identically distributed (i.i.d.) and circularly symmetric complex
Gaussian random variables with zero-mean and unit-variance, thus, having a i.i.d.
Rayleigh distribution. A more thorough treatment of interference channel modeling
between radar and cellular system, including two- and three-dimensional channel
models, can be found in [6–9].
2.1.9
Cooperative RF Environment
In the wireless communications literature, it is usually assumed that the transmitter
(mostly BS) has channel state information (CSI) either by feedback from the receiver
(mostly UE), in FDD systems [10], or transmitters can reciprocate the channel, in
TDD systems [10]. The feedback and reciprocity are valid and practical as long as
the feedback has a reasonable overhead and coherence time of the RF channel is
larger than the two-way communication time, respectively.
In the case of radars sharing their spectrum with communications systems one
way to get CSI is that radar estimates Hi based on the training symbols sent by
communication receivers (or BSs in this case) [11]. Another approach is that radar
aids communication systems in channel estimation, with the help of a low-power
reference signal, and they feed back the estimated channel to radar [12]. Since, radar
signal is treated as interference at communication system, we can characterize the
channel as interference channel and refer to information about it as interference-
channel state information (ICSI).
Spectrum sharing between radars and communications systems can be envisioned
in two domains: military radars sharing spectrum with military communication
systems, we call it Mil2Mil sharing; another possibility is military radars sharing
spectrum with commercial communication systems, we call it Mil2Com sharing. In
Mil2Mil sharing, ICSI can be acquired by radars fairly easily as both systems belong
to military. In Mil2Com sharing, ICSI can be acquired by giving incentives to com-

12
2 A Projection-Based Approach to Spectrum Sharing
mercial communication system. The biggest incentive in this scenario is null-steering
and protection from radar interference. Thus, regardless of the sharing scenario,
Mil2Mil or Mil2Com, we have ICSI for the sake of mitigating radar interference at
communication systems.
2.2
Radar-Cellular System Spectrum Sharing
After introducing our radar and cellular system models we can now discuss the spec-
trum sharing scenario between radar and cellular system. In our sharing architecture,
MIMO radar and cellular systems are the co-primary users of the 3550–3650MHz
band under consideration. In the following sections, we will discuss the architecture
of spectrum sharing problem which is followed by our spectrum sharing algorithm.
2.2.1
Architecture
We illustrate our coexistence scenario in Fig.2.1 where the maritime MIMO radar is
sharing K interference channels with the cellular system. Considering this scenario,
the received signal at the ith BS receiver can be written as
ri(t) = HN BS×M
i
x(t) +

j
HN BS×N UE
j
sUE
j (t) + w(t).
(2.10)
Fig. 2.1 Spectrum sharing scenario: A seaborne MIMO radar detecting a point target while simulta-
neously sharing spectrum with a MIMO cellular system without causing interference to the cellular
system

2.2 Radar-Cellular System Spectrum Sharing
13
The goal of the MIMO radar is to map x(t) onto the null-space of Hi in order to
avoid interference to the ith BS, i.e., Hix(t) = 0, so that ri(t) has Eq.(2.8) instead
of Eq.(2.10).
2.3
Spectrum Sharing Algorithms for Small MIMO Radar
In this section, we discuss performance metrics of spectrum sharing MIMO radars
when a MIMO radar has a smaller antenna array as compared to a cellular base
station (BS), i.e., MT ⩽NR. We consider the spectrum sharing between a MIMO
radar and an LTE cellular system with K BSs. The MIMO radar and LTE share
K interference channels, i.e., Hi, i = 1, 2, . . . , K. We propose projecting the radar
signal onto the null space of interference channel between the MIMO radar and LTE
using our proposed interference-channel-selection algorithm, in order to have zero-
interference from the MIMO radar. We select interference channel with the maximum
null space, i.e., argmax1⩽i⩽K dim [N(Hi)] and project the radar signal onto the null
space of this channel. Our proposed spatial spectrum sharing algorithm is radar-
centric such that it causes minimum loss in radar performance by carefully selecting
the interference channel and at the same time protects the ith LTE BS from the radar
interference. Through our analytical and simulation results we show that the loss
in the radar performance is less when the proposed interference-channel-selection
algorithm is used to select the channel onto which radar signals are projected.
2.3.1
Performance Metrics
We choose the Crame`r Rao bound (CRB) and maximum likelihood (ML) estimate of
the target’s angle of arrival as our performance metric for the MIMO radar system.
We are interested in studying the degradation in the estimate of the target’s angle
of arrival due to null-space projection of the radar waveform. The CRB for a single
target, no-interference case, is given as in [4],
CRB(θ) =
1
2 SNR

MR ˙aH
T (θ)RT
x ˙aT (θ) + aH
T (θ)RT
x
aT (θ)∥˙aR(θ)∥2 −MR
aH
T (θ)RT
x ˙aT (θ)
2
aH
T (θ)RTx aT (θ)
−1
(2.11)
and the ML for the case of no interference and a single target can be written as in
[4],
( ˆθ, ˆτr, ˆωD)ML = arg max
θ,τr,ωD
aH
R (θ)E(τr, ωD)a∗
T (θ)
2
MRaH
T (θ)RTx aT (θ)
(2.12)

14
2 A Projection-Based Approach to Spectrum Sharing
where
˙aR(θ) = daR(θ)
dθ
˙aT (θ) = daT (θ)
dθ
Rx =

T0
x(t) xH(t) dt
E(τr, ωD) =

T0
y(t) xH(t −τr) e jωDt dt
τr is the propagation delay, two-way, between the target and the reference point, and
ωD is the Doppler frequency shift.
In addition to performance metrics like CRB and ML, we are also interested in
the changes in beampatterns of the MIMO radar due to null-space projection of the
radar waveform. Beampattern is a measure of beamformer’s response to a target at
direction θ given by, as in [4],
G(θ, θD) = Γ |aH
T (θ)RT
x aT (θD)|2
aH
T (θD)RTx aT (θD)
|aH
R (θ)aR(θD)|2
MR
(2.13)
where Γ is the normalization constant and θD represents the digital steering direction
of the main beam.
2.3.2
Interference-Channel-Selection Algorithm
In this section, we propose our interference-channel-selection algorithm, shown in
Algorithm 1, which selects interference channel onto which radar signals are pro-
jected using NSP method, i.e., Algorithm 2. We assume there exist K interference
channels, i.e., Hi, i = 1, 2, . . . , K, between the MIMO radar and the LTE system
and we seek to select the best interference channel, deﬁned as
imax ≜argmax
1⩽i⩽K
dim[N(Hi)]
HBest ≜Himax
and we seek to avoid the worst channel, deﬁned as
imin ≜argmin
1⩽i⩽K
dim[N(Hi)]
HWorst ≜Himin

2.3 Spectrum Sharing Algorithms for Small MIMO Radar
15
where null space of HNR×MT
i
is deﬁned as
N(Hi) ≜

x ∈CMT : Hix = 0

and then null of HNR×MT
i
is deﬁned as
null Hi ≜dim[N(Hi)]
where ‘dim’ is the number of linearly independent columns in null space of HNR×MT
i
.
At the MIMO radar, we ﬁrst estimate the channel state information (CSI) of
the K interference channels using a blind null-space learning algorithm [13]. This
is followed by the calculation of null space of these K interference channels via
Algorithm 2. Once Algorithm 1 receives null space of interference channels, it selects
channel with the maximum null space as the candidate channel, i.e., ˘H and sends it to
Algorithm 2 for NSP of radar signals. Our interference-channel-selection algorithm,
i.e., Algorithm 1 guarantees minimum degradation in radar performance and at the
same time assures zero-interference to the candidate BS.
Algorithm 1 Interference-Channel-Selection Algorithm
loop
for i = 1 : K do
Estimate CSI of Hi.
Send Hi to Algorithm 2 for null space computation.
Receive dim[N(Hi)] from Algorithm 2.
end for
Find imax = argmax
1⩽i⩽K
dim[N(Hi)].
Set ˘H = Himax as the candidate interference channel.
Send ˘H to Algorithm 2 to get NSP radar waveform.
end loop
2.3.3
Modiﬁed-Null-Space Projection (NSP) Algorithm
In this section, we explain the projection of radar signals onto null space of inter-
ference channel selected using Algorithm 1. As mentioned earlier, the CSI of K
interference channels is estimated using a blind null-space learning algorithm [13].
After getting CSI estimates of K interference channels, from Algorithm 1, the next
step is to ﬁnd null space of each HNR×MT
i
using Algorithm 2. This step is performed
using the singular value decomposition (SVD) theorem according to our modiﬁed-
NSP projection algorithm, as shown in Algorithm 2. For the complex ith interference
channel matrix the SVD is given as

16
2 A Projection-Based Approach to Spectrum Sharing
HNR×MT
i
= UiNR×MT
i
VH
i
= Ui
⎛
⎜⎜⎜⎜⎜⎜⎜⎝
σ1
σ2
0
...
0
σ j∈min(NR,MT )
⎞
⎟⎟⎟⎟⎟⎟⎟⎠
VH
i
where Ui is the complex unitary matrix, Σi is the diagonal matrix of singular values,
and VH
i
is the complex unitary matrix. If the SVD analysis do not yield any zero
singular values we resort to a numerical approach to calculate null space. In order
to do that, in Algorithm 2, we set a threshold δ and select singular values below the
threshold value. Then the number of singular values below the threshold serves as
the dimension of null space.
Algorithm 2 Modiﬁed-Null-Space Projection (NSP)
if Hi received from Algorithm 1 then
Perform SVD on Hi (i.e., Hi = UiΣiVH
i )
if σ j ̸= 0 (i.e., jth singular value of Σi) then
dim [N(Hi)] = 0
Use pre-speciﬁed threshold δ
for j = 1 : min(NR, MT ) do
if σ j < δ then
dim [N(Hi)] = dim [N(Hi)] + 1
else
dim [N(Hi)] = 0
end if
end for
else
dim [N(Hi)] = The number of zero singular values
end if
Send dim [N(Hi)] to Algorithm 1.
end if
if ˘H received from Algorithm 1 then
Perform SVD on ˘H = UΣV
if σ j ̸= 0 then
Use pre-speciﬁed threshold δ
σNull = {} {An empty set to collect σs below threshold δ}
for j = 1 : min(NR, MT ) do
if σ j < δ then
Add σ j to σNull
end if
end for
˘V = σNull corresponding columns in V.
end if
Setup projection matrix P ˘V = ˘V ˘VH.
Get NSP radar signal via ˘x = P ˘Vx.
end if

2.3 Spectrum Sharing Algorithms for Small MIMO Radar
17
Once the null space of all interference channels is determined we seek to ﬁnd
the best channel ˘H, the one with the maximum null space, which according to our
Algorithm 1 is given as
imax = argmax
1⩽i⩽K
dim N(Hi)
˘H = Himax
Algorithm 1 sends ˘H to Algorithm 2 for null-space computation, where after SVD
the right singular vectors corresponding to vanishing singular are collected in ˘V for
the formation of projection matrix. Once this is done, we project the radar signal
onto the null space of HBest via a modiﬁed version of our projection algorithm [5,
14]. The proposed NSP algorithm removes redundancy from previous algorithm and
is computationally efﬁcient. The modiﬁed-NSP algorithm is given as
P ˘V = ˘V ˘VH.
The radar waveform projected onto null space of ˘H can be written as
˘x = P ˘Vx.
(2.14)
By inserting the projected signal, as in Eq.(2.14), into the Cramer–Rao bound (CRB)
for the single target no interference case, Eq.(2.11), we get the CRB for the NSP
projected radar waveform as
CRBNSP(θ) =
1
2 SNR

MR ˙aH
T (θ)RT
˘x ˙aT (θ) + aH
T (θ)
RT
˘x aT (θ)∥˙aR(θ)∥2 −MR
aH
T (θ)RT
˘x ˙aT (θ)
2
aH
T (θ)RT
˘x aT (θ)
−1
·
(2.15)
Similarly, Eq.(2.14) can be substituted in (2.12) to get the ML estimate of angle
arrival for the NSP projected radar waveform as
( ˆθ, ˆτr, ˆωD)MLNSP = arg max
θ,τr,ωD
aH
R (θ)E(τr, ωD)a∗
T (θ)
2
MRaH
T (θ)RT
˘x aT (θ)
·
(2.16)
In order to analyze the beampattern of the NSP projected waveform we can substitute
Eq.(2.14) in Eq.(2.13) to get
GNSP(θ, θD) = Γ |aH
T (θ)RT
˘x aT (θD)|2
aH
T (θD)RT
˘x aT (θD)
|aH
R (θ)aR(θD)|2
MR
·
(2.17)

18
2 A Projection-Based Approach to Spectrum Sharing
0
5
10
15
20
10
−7
10
−6
10
−5
10
−4
SNR
RMSE (degree)
Original Waveform
NSP Waveform onto HBest
NSP Waveform onto HWorst
Fig. 2.2 CRB on target direction estimation RMSE as a function of the SNR. HBest and HWorst
channels are selected using Algorithms 1 and 2
2.3.4
Simulation Results
In this section, we simulate our MIMO radar-LTE sharing scenario and study its
impact on the performance of radar.
The CRB for the target’s angle of arrival is given by Eqs.(2.11) and (2.15) for the
original radar waveform and the NSP radar waveform, respectively. We are interested
in understanding the effects of NSP on the radar waveform. In Fig.2.2, we compare
the root-mean-square-error (RMSE) of different radar waveforms. We compare the
performance of original radar waveform with the NSP waveform projected onto
HBest and HWorst. Note that by using Algorithms 1 and 2 we are able to minimize
degradation in the radar performance as the NSP waveform onto HBest is closer to
the original radar waveform in RMSE sense than the NSP waveform onto HWorst.
Thus, by an appropriate selection of the interference-channel degradation in the radar
performance, due to the NSP of its waveform, can be minimized.
Similar to the CRB, the ML estimate of the target’s angle of arrival is given by
Eqs.(2.12) and (2.16) for the original radar waveform and the NSP radar waveform,
respectively. We are interested in the estimation error of the angle due to the NSP
of radar waveform. In Fig.2.3, we compare original angles and estimated angles
using ML estimation for different radar waveforms. Using Algorithms 1 and 2 we
can achieve almost similar ML results for original waveform and the NSP waveform

2.3 Spectrum Sharing Algorithms for Small MIMO Radar
19
−20
−15
−10
−5
0
5
10
15
20
−25
−20
−15
−10
−5
0
5
10
15
20
25
theta (deg)
theta estimate(deg)
Original Waveform
NSP Waveform onto HBest
NSP Waveform onto HWorst
Fig.2.3 MLontargetdirectionestimation. HBest andHWorst channelsareselectedusingAlgorithms
1 and 2
−40
−30
−20
−10
0
10
20
30
40
−100
−80
−60
−40
−20
0
20
40
θ (deg)
Power (dB)
Original Waveform
NSP Waveform onto small null space
NSP Waveform onto large null space
Fig. 2.4 Beampattern of MIMO radar when different values of threshold are used to calculate the
null space of interference channels in Algorithm 2

20
2 A Projection-Based Approach to Spectrum Sharing
which shows that by choosing HBest to project we can cause minimum degradation
in radar performance. Note that the ML estimate for the NSP waveform onto HWorst
is much degraded from the original waveform and the NSP waveform onto HBest.
In Algorithm 2, we describe an approach to numerically calculate null space of
interference channels. This is an important approach in the presence of rounding
errors and fuzzy data. We select singular values below a certain threshold and take
the corresponding columns of VH
i for our NSP equation. Thus, the value of threshold
can be a limitation parameter in the projection algorithm, since, the bigger the value
of threshold the bigger the null space and the better the performance of the NSP
radar waveform. This can be easily noticed from Fig.2.4, where we compare the
beampattern of original radar waveform with the NSP waveform when we choose a
larger and a smaller value of threshold. The larger value of threshold corresponds to
the best channel and the smaller value corresponds to the worst channel, according
to our deﬁnitions in Sect.2.3.2. Note that by increasing or decreasing the value of
threshold we can manipulate the magnitude of sidelobes. Thus, for the best radar
performance, it is desirable to select interference channel with the maximum null
space, i.e., according to Algorithms 1 and 2.
2.4
Spectrum Sharing Algorithms for Large MIMO Radar
In this section, we address the problem of target detection by radars that project
waveform onto the null space of interference channel in order to mitigate interference
to cellular systems. We consider a multiple-input multiple-output (MIMO) radar and
a MIMO cellular communication system with K base stations (BS). We consider
two spectrum sharing scenarios. In the ﬁrst scenario, the degrees of freedom (DoF)
available at the radar are not sufﬁcient enough to simultaneously detect target and
mitigate interference to K BSs. For this case, we select one BS among K BSs for
waveform projection on the basis of guaranteeing minimum waveform degradation.
For the second case, the radar has sufﬁcient DoF to simultaneously detect target and
mitigate interference to all K BSs. We study target detection capabilities of null-space
projected (NSP) waveform and compare it with the orthogonal waveform. We derive
the generalized likelihood ratio test (GLRT) for target detection and derive detector
statistic for NSP and orthogonal waveform. The target detection performance for
both waveforms is studied theoretically and via Monte Carlo simulations.
We consider two spectrum sharing scenarios which are discussed as follows.
Case 1 (M ≪KN BS but M > N BS): Consider a scenario in which a MIMO radar
has a very small antenna array as compared to the combined antenna array of K BSs,
i.e., M ≪KN BS, but is larger than individual BS antenna array, i.e., M > N BS. In
such a scenario, it is not possible for the MIMO radar to simultaneously mitigate
interference to all the K BSs present in the network because of insufﬁcient degrees
of freedom (DoF) available. However, the available DoF allow simultaneous target
detection and interference mitigation to one of the BS among K BSs. The choice of
BS selection depends upon the performance metric which radar wants to optimize.

2.4 Spectrum Sharing Algorithms for Large MIMO Radar
21
In this chapter, our performance metric is minimum degradation of radar waveform
in a minimum norm sense.
A drawback of this approach is that interference is not mitigated to K −1 BSs
present in the network and the radar has to utilize higher transmit power to achieve
the same performance level which can increase the level of interference at BSs not
part of the mitigation scheme. This drawback is addressed in the literature by moving
K −1 BSs to non-radar frequency bands by using resource allocation and carrier
aggregation techniques [15, 16].
It is worth mentioning that when M ≪KN BS traditional colocated MIMO radar
architecture is not suitable for mitigation of interference by using NSP approaches
because sufﬁcient DoF are not available and doing so will result in performance
degradation of radar systems. However, the MIMO radar architecture can be modiﬁed
into an overlapped-MIMO radar architecture, where the transmit array of colocated
MIMO radar is partitioned into a number of subarrays that are allowed to overlap. The
overlapped-MIMO radar architecture increases the DoF and enjoys the advantages
of the MIMO radar while mitigating interference to communication systems without
sacriﬁcing the main desirable characteristics for its own transmission.
Case 2 (M ≫KN BS): Consider a scenario in which a MIMO radar has a very
large antenna array as compared to the combined antenna array of K BSs, i.e.,
M ≫KN BS. In such a scenario, it is feasible for the MIMO radar to simultaneously
mitigate interference to all the K BSs present in the network while reliably detecting
targets. This is because sufﬁcient degrees of freedom are available for both the tasks.
In such a scenario, the combined interference channel that the MIMO radar shares
with K BSs in the networks is given as
H =
H1 H2 · · · HK

·
(2.18)
2.4.1
Projection Matrix
In this section, we introduce formation of projection matrices for Case 1 and Case 2.
Projection for Case 1 (M ≪KN BS but M > N BS): In this section, we deﬁne the
projection algorithm for ‘Case 1’ which projects radar signal onto the null space of
interference channel Hi. Assuming, the MIMO radar has channel state information
of all Hi interference channels, through feedback, in Mil2Mil or Mil2Com scenario,
we can perform singular value decomposition (SVD) to ﬁnd the null space and then
construct a projector matrix. We proceed by ﬁrst ﬁnding SVD of Hi, i.e.,
Hi = UiΣiVH
i .
(2.19)
Now, let us deﬁne

Σi ≜diag(σi,1,σi,2, . . . ,σi,p)
(2.20)

22
2 A Projection-Based Approach to Spectrum Sharing
where p ≜min(N BS, M) and σi,1 > σi,2 > · · · > σi,q > σi,q+1 = σi,q+2 = · · · =
σi,p = 0 are the singular values of Hi. Next, we deﬁne

Σ
′
i ≜diag(σ′
i,1,σ′
i,2, . . . ,σ′
i,M)
(2.21)
where
σ′
i,u ≜

0,
for u ⩽q,
1,
for u > q.
(2.22)
Using above deﬁnitions we can now deﬁne our projection matrix, i.e.,
Pi ≜Vi 
Σ
′
iVH
i .
(2.23)
In order to show that Pi is a valid projection matrix we prove two results on projection
matrices below.
Property 2.1 Pi ∈CM×M is a projection matrix if and only if Pi = PH
i = P2
i .
Proof Let’s start by showing the ‘only if’ part. First, we show Pi = PH
i . Taking
Hermitian of Eq.(2.23) we have
PH
i = (Vi 
Σ
′
iVH
i )H = Pi.
(2.24)
Now, squaring Eq.(2.23) we have
P2
i = Vi 
ΣiVH
i × Vi 
ΣiVH
i = Pi
(2.25)
where above equation follows from VH
i Vi = I (since they are orthonormal matri-
ces) and (
Σ
′
i)2 = 
Σ
′
i (by construction). From Eqs.(2.24) and (2.25) it follows that
Pi = PH
i = P2
i . Next, we show Pi is a projector by showing that if v ∈range (Pi),
then Piv = v, i.e., for some w, v = Piw, then
Piv = Pi(Piw) = P2
i w = Piw = v.
(2.26)
Moreover, Piv −v ∈null(Pi), i.e.,
Pi(Piv −v) = P2
i v −Piv = Piv −Piv = 0.
(2.27)
This concludes our proof.
Property 2.2 Pi ∈CM×M is an orthogonal projection matrix onto the null space of
Hi ∈CN BS×M.

2.4 Spectrum Sharing Algorithms for Large MIMO Radar
23
Proof Since Pi = PH
i , we can write
HiPH
i = Ui 
ΣiVH
i × Vi 
Σ
′
iVH
i = 0.
(2.28)
The above results follows from noting that 
Σi 
Σ
′
i = 0 by construction.
For ‘Case 1’ we are dealing with K interference channels. Therefore, we need to
select the interference channel which results in least degradation of radar waveform
in a minimum norm sense, i.e.,
imin ≜argmin
1⩽i⩽K

Pix(t) −x(t)


2
(2.29)
˘P ≜Pimin.
(2.30)
Once we have selected our projection matrix it is straight forward to project radar
signal onto the null space of interference channel via
˘x(t) = ˘P x(t).
(2.31)
The correlation matrix of our NSP waveform is given as
R˘x =

To
˘x(t)˘xH(t)dt
(2.32)
which is no longer identity, because the projection does not preserve the orthogonal-
ity, and its rank depends upon the rank of the projection matrix.
Projection for Case 2 (M ≫KN BS): In this section, we deﬁne the projection algo-
rithm for ‘Case 2’ which projects radar signal onto the null space of combined
interference channel H. The SVD of H is given as
H = UΣVH.
(2.33)
Now, let us deﬁne

Σ ≜diag(σ1,σ2, . . . ,σp)
(2.34)
where p ≜min(N BS, M) andσ1 > σ2 > · · · > σq > σq+1 = σq+2 = · · · = σp = 0
are the singular values of H. Next, we deﬁne

Σ
′
i ≜diag(σ′
1,σ′
2, . . . ,σ′
M)
(2.35)
where
σ′
u ≜

0,
for u ⩽q,
1,
for u > q.
(2.36)

24
2 A Projection-Based Approach to Spectrum Sharing
Using above deﬁnitions we can now deﬁne our projection matrix, i.e.,
P ≜V
Σ
′VH.
(2.37)
It is straightforward to see that P is a valid projection matrix by using Properties 1
and 2.
2.4.2
Spectrum Sharing and Projection Algorithms
In this section, we explain spectrum sharing and projection algorithms for ‘Case 1’
and ‘Case 2’.
Algorithms for Case 1 (M ≪KN BS but M > N BS): For this case, the process of
spectrum sharing by forming projection matrices and selecting interference channels
is executed with the help of Algorithms 3 and 4. First, at each pulse repetition interval
(PRI), the radar obtains ICSI of all K interference channels. This information is sent
to Algorithm 4 for the calculation of null spaces and formation of projection matrices.
Algorithm 3 process K projection matrices, received from Algorithm 4, to ﬁnd the
projection matrix which results in least degradation of radar waveform in a minimum
norm sense. This step is followed by the projection of radar waveform onto the null
space of the selected BS, i.e., the BS to the corresponding selected projection matrix,
and waveform transmission.
Algorithm 3 Spectrum Sharing Algorithm for Case 1
loop
for i = 1 : K do
Get CSI of Hi through feedback from the ith BS.
Send Hi to Algorithm 4 for the formation of projection matrix Pi.
Receive the ith projection matrix Pi from Algorithm 4.
end for
Find imin = argmin
1⩽i⩽K

Pix(t) −x(t)


2.
Set ˘P = Pimin as the desired projector.
Perform null space projection, i.e., ˘x(t) = ˘Px(t).
end loop
Projection for Case 2 (M ≫KN BS): For this case, the process of spectrum sharing
is executed with the help of Algorithms 5 and 6. First, at each pulse repetition interval
(PRI), the radar obtains ICSI of all K interference channels. This information is sent
to Algorithm 6 for the calculation of null space of H and the formation of projection
matrix P. The projection of radar waveform onto the null space of H is performed
by Algorithm 5.

2.4 Spectrum Sharing Algorithms for Large MIMO Radar
25
Algorithm 4 Projection Algorithm for Case 1
if Hi received from Algorithm 3 then
Perform SVD on Hi (i.e., Hi = UiΣiVH
i )
Construct 
Σi = diag(σi,1,σi,2, . . . ,σi,p)
Construct 
Σ′
i = diag(σ′
i,1,σ′
i,2, . . . ,σ′
i,M)
Setup projection matrix Pi = Vi 
Σ′
iVH
i .
Send Pi to Algorithm 3.
end if
Algorithm 5 Spectrum Sharing Algorithm for Case 2
loop
Get CSI of H through feedback from K BSs.
Send H to Algorithm 6 for the formation of projection matrix P.
Receive the projection matrix P from Algorithm 6.
Perform null space projection, i.e., ˘x(t) = Px(t).
end loop
Algorithm 6 Projection Algorithm for Case 2
if H received from Algorithm 5 then
Perform SVD on H (i.e., H = UΣVH)
Construct 
Σ = diag(σ1,σ2, . . . ,σp)
Construct 
Σ′
i = diag(σ′
1,σ′
2, . . . ,σ′
M)
Setup projection matrix P = V
Σ′VH.
Send P to Algorithm 5.
end if
2.4.3
Statistical Decision Test for Target Detection
In this section, we develop a statistical decision test for target illuminated with the
orthogonal radar waveforms and the NSP projected radar waveforms. The goal is
to compare performance of the two waveforms by looking at the test decision on
whether the target is present or not in the range-Doppler cell of interest.
For target detection and estimation, we proceed by constructing a hypothesis test
where we seek to choose between two hypothesis: the null hypothesis H0 which
represents the case when the target is absent or the alternate hypothesis H1 which
represents the case when the target is present. The hypothesis for a single target
model in Eq.(2.5) can be written as
y(t) =

H1 : α A(θ) x(t) + n(t), 0 ⩽t ⩽To,
H0 : n(t),
0 ⩽t ⩽To.
(2.38)
Since, θ and α are unknown, but deterministic, we use the generalize likelihood ratio
test (GLRT). The advantage of using GLRT is that we can replace the unknown
parameters with their maximum likelihood (ML) estimates. The ML estimates of α

26
2 A Projection-Based Approach to Spectrum Sharing
and θ are found for various signal models, targets, and interference sources in [4, 17]
when using orthogonal signals. In this chapter, we consider a simpler model with
one target and no interference sources in order to study the impact of NSP on target
detection in a tractable manner. Therefore, we present a simpler derivation of the ML
estimation and GLRT.
The received signal model in Eq.(2.5) can be written as
y(t) = Q(t, θ)α + n(t)
(2.39)
where
Q(t, θ) = A(θ)x(t).
(2.40)
We use Karhunen–Loève expansion for derivation of the log-likelihood function
for estimating θ and α. Let Ω denote the space of the elements of {y(t)}, {Q(t, θ)},
and {n(t)}. Moreover, let ψz, z = 1, 2, . . . , be an orthonormal basis function of Ω
satisfying
< ψz(t), ψz′(t) >=

T0
ψz(t), ψ∗
z′(t) = δzz′
(2.41)
where δzz′ is the Krönecker delta function. Then, the following series can be used to
expand the processes, {y(t)}, {Q(t, θ)}, and {n(t)}, as
y(t) =
∞

z=1
yzψz(t)
(2.42)
Q(t, θ) =
∞

z=1
Qz(θ)ψz(t)
(2.43)
n(t) =
∞

z=1
nzψz(t)
(2.44)
where yz, Qz, and nz are coefﬁcients in the Karhunen–Loève expansion of the con-
sidered processes obtained by taking the corresponding inner product with basis
function ψz(t). Thus, an equivalent discrete model of Eq.(2.39) can be obtained as
yz = Qz(θ)α + nz,
z = 1, 2, . . .
(2.45)
For white circular complex Gaussian processes, i.e., E[n(t)n(t −τ(t))] = σ2
nIMδ
(τ(t)), the sequence {nz} is i.i.d. and nz ∼Nc(0M, σ2
nIM). Thus, we can express the
log-likelihood function as
Ly(θ, α) =
∞

z=1

−M log(πσ2
n) −1
σ2n
yz −Qz(θ)α
2

.
(2.46)

2.4 Spectrum Sharing Algorithms for Large MIMO Radar
27
Maximizing Eq.(2.46) with respect to α yields
Ly(θ, ˆα) = Γ −1
σ2n

Eyy −eH
QyE−1
QQeQy

(2.47)
where
Γ ≜−M log(πσ2
n)
(2.48)
Eyy ≜
∞

z=1
yz
2
(2.49)
eQy ≜
∞

z=1
QH
z yz
(2.50)
E−1
QQ ≜
∞

z=1
QH
z Qz.
(2.51)
Note that, in Eq.(2.47), apart from the constant Γ , the remaining summation goes to
inﬁnity. However, due to the noncontribution of higher order terms in the estimation
of θ and α the summation can be ﬁnite. Using the identity

To
v1(t)vH
2 (t)dt =
∞

z=1
v1zvH
2z
(2.52)
for vi(t) = ∞
z=1 v1zψz(t), i = 1, 2, Eqs.(2.49)–(2.51) can be written as
Eyy ≜

To
y(t)
2dt
(2.53)
eQy ≜

To
QH(t, θ)y(t)dt
(2.54)
EQQ ≜

To
QH(t, θ)Q(t, θ)dt.
(2.55)
Using the deﬁnition of Q(t, θ) in Eq.(2.40), we can write the f th element of eQy as
[eQy] f = aH(θ f )ET a(θ f )
(2.56)
where
E =

To
y(t)xH(t)dt.
(2.57)
Similarly, we can write the f gth element of EQQ as

28
2 A Projection-Based Approach to Spectrum Sharing
[EQQ] f g = aH(θ f )a(θg)aH(θ f )RT
x a(θg).
(2.58)
Since, eQy and EQQ are independent of the received signal, the sufﬁcient statistic
to calculate θ and α is given by E. Using Eqs.(2.56)–(2.58) we can write the ML
estimate in matrix-vector form as
Ly( ˆθML) = argmax
θ
aH( ˆθML)Ea∗( ˆθML)

2
MaH( ˆθML)RTx a( ˆθML)
·
(2.59)
Then, the GLRT for our hypothesis testing model in Eq.(2.38) is given as
Ly = max
θ,α {log fy(y, θ, α; H1)} −log f (y; H0)
H1
≷
H0
δ
(2.60)
where fy(y, θ, α; H1) and f (y; H0) are the probability density functions of the
received signal under hypothesis H1 and H0, respectively. Hence, the GLRT can be
expressed as
Ly( ˆθML) = argmax
θ
aH( ˆθML)Ea∗( ˆθML)

2
MaH( ˆθML)RTx a( ˆθML)
H1
≷
H0
δ.
(2.61)
The asymptotic statistic of L( ˆθML) for both the hypothesis is given by [18]
L( ˆθML) ∼

H1 : χ2
2(ρ),
H0 : χ2
2,
(2.62)
where
• χ2
2(ρ) is the noncentral chi-squared distributions with two degrees of freedom,
• χ2
2 is the central chi-squared distributions with two degrees of freedom,
• and ρ is the noncentrality parameter, which is given by
ρ = |α|2
σ2n
|aH(θ)RT
x a(θ)|2.
(2.63)
For the general signal model, we set δ according to a desired probability of false
alarm PFA, i.e.,
PFA = P(L(y) > δ|H0)
(2.64)
δ = F−1
χ2
2 (1 −PFA)
(2.65)
where F−1
χ2
2 is the inverse central chi-squared distribution function with two degrees
of freedom. The probability of detection is given by

2.4 Spectrum Sharing Algorithms for Large MIMO Radar
29
PD = P(L(y) > δ|H1)
(2.66)
PD = 1 −Fχ2
2(ρ)

F−1
χ2
2 (1 −PFA)

(2.67)
where Fχ2
2(ρ) is the noncentral chi-squared distribution function with two degrees of
freedom and noncentrality parameter ρ.
2.4.3.1
PD for Orthogonal Waveforms
For orthogonal waveforms RT
x = IM, therefore, the GLRT can be expressed as
LOrthog( ˆθML) =
aH( ˆθML)Ea∗( ˆθML)

2
MaH( ˆθML)a( ˆθML)
H1
≷
H0
δOrthog
(2.68)
and the statistic of L( ˆθML) for this case is
LOrthog( ˆθML) ∼

H1 : χ2
2(ρOrthog),
H0 : χ2
2,
(2.69)
where
ρOrthog = M2|α|2
σ2n
·
(2.70)
We set δOrthog according to a desired probability of false alarm PPF-Orthog, i.e.,
δOrthog = F−1
χ2
2 (1 −PPF-Orthog)
(2.71)
and then the probability of detection for orthogonal waveforms is given by
PD-Orthog = 1 −Fχ2
2(ρOrthog)

F−1
χ2
2 (1 −PPF-Orthog)

.
(2.72)
2.4.3.2
PD for NSP Waveforms
For spectrum sharing waveforms RT
x = RT
˘x , therefore, the GLRT can be expressed as
LNSP( ˆθML) =
aH( ˆθML)Ea∗( ˆθML)

2
MaH( ˆθML)RT
˘x a( ˆθML)
H1
≷
H0
δNSP
(2.73)
and the statistic of L( ˆθML) for this case is

30
2 A Projection-Based Approach to Spectrum Sharing
LNSP( ˆθML) ∼

H1 : χ2
2(ρNSP),
H0 : χ2
2,
(2.74)
where
ρNSP = |α|2
σ2n
|aH(θ)RT
˘x a(θ)|2.
(2.75)
We set δNSP according to a desired probability of false alarm PPF-NSP, i.e.,
δNSP = F−1
χ2
2 (1 −PPF-NSP)
(2.76)
and then the probability of detection for orthogonal waveforms is given by
PD-NSP = 1 −Fχ2
2(ρNSP)

F−1
χ2
2 (1 −PPF-NSP)

.
(2.77)
2.4.4
Numerical Results
In order to study the detection performance of spectrum sharing MIMO radars, we
carry out Monte Carlo simulation using the radar parameters mentioned in [19].
2.4.4.1
Analysis of Case 1
For this case, at each run of Monte Carlo simulation we generate K Rayleigh inter-
ference channels each with dimensions N BS × M, calculate their null spaces and
construct corresponding projection matrices using Algorithm 4, determine the best
channel to perform projection of radar signal using Algorithm 3, transmit NSP signal,
estimate parameters θ and α from the received signal, and calculate the probability
of detection for orthogonal and NSP waveforms.
Performance of Algorithms 3 and 4: In Fig.2.5, we demonstrate the use of Algo-
rithms 3 and 4 in improving target detection performance when multiple BSs are
present in detection space of radar and the radar has to reliably detect target while
not interfering with communication system of interest. As an example, we consider
a scenario with ﬁve BSs and the radar has to select a projection channel which min-
imizes degradation in its waveform, thus, maximizing its probability of detection of
the target.
In Fig.2.5a, we consider the case when dim N(Hi) = 2. We show detection results
for ﬁve different NSP signals, i.e., radar waveform projected onto ﬁve different BSs.
Note that, in order to achieve a detection probability of 90%, we need 6 to 13dB
more gain in SNR as compared to the orthogonal waveform, depending upon which
channel we select. Using Algorithms 3 and 4 we can select interference channel
that results in minimum degradation of radar waveform and results in enhanced

2.4 Spectrum Sharing Algorithms for Large MIMO Radar
31
−10
−5
0
5
10
15
20
25
30
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
SNR
PD
PD for PFA = 10−1
Pd for NSP Waveforms to BS 1
Pd for NSP Waveforms to BS 2
Pd for NSP Waveforms to BS 3
Pd for NSP Waveforms to BS 4
Pd for NSP Waveforms to BS 5
Pd for Orthogonal Waveforms
6dB
13dB
(a) Probability of detection when dim
(Hi) = 2. Note that 6 dB to 13 dB of additional
gain in SNR is required to detect target with 90% probability, depending upon the NSP
waveform transmitted.
−8
−6
−4
−2
0
2
4
6
8
10
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
SNR
PD
PD for PFA = 10−5
PD for NSP Waveforms to BS 1
PD for NSP Waveforms to BS 2
PD for NSP Waveforms to BS 3
PD for NSP Waveforms to BS 4
PD for NSP Waveforms to BS 5
PD for Orthogonal Waveforms
3dB
5dB
(b) Probability of detection when dim
(Hi) = 6. Note that 3 dB to 5 dB of additional
gain in SNR is required to detect target with 90% probability, depending upon the NSP
waveform transmitted.
Fig. 2.5 Case 1 – Performance of Algorithms 3 and 4: Using our spectrum sharing and projection
algorithms, we can select interference channel for radar signal projection to maximize detection
probability and minimize gain in SNR required as a result of NSP of radar waveforms. For example,
Algorithms 3 and 4 select BS#5 and BS#2 for dim N(Hi) = 2 and dim N(Hi) = 6 cases, respec-
tively, as they require minimum additional gain in SNR

32
2 A Projection-Based Approach to Spectrum Sharing
−10
−5
0
5
10
15
20
25
30
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
SNR
PD
PD for PFA=10−1
PD for Orthogonal Waveforms
PD for NSP Waveforms
−10
−5
0
5
10
15
20
25
30
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
SNR
PD
PD for PFA=10−3
PD for Orthogonal Waveforms
PD for NSP Waveforms
−10
−5
0
5
10
15
20
25
30
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
SNR
PD
PD for PFA=10−5
PD for Orthogonal Waveforms
PD for NSP Waveforms
−10
−5
0
5
10
15
20
25
30
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
SNR
PD
PD for PFA=10−7
PD for Orthogonal Waveforms
PD for NSP Waveforms
6dB
6dB
6dB
6dB
Fig. 2.6 ‘Case 1(a): dim N(Hi) = 2’: PD as a function of SNR for various values of probabil-
ity of false alarm PFA, i.e., PFA = 10−1, 10−3, 10−5 and 10−7. The interference channel Hi has
dimensions 2 × 4, i.e., the radar has M = 4 antennas and the communication system has N BS = 2
antennas, thus, we have a null-space dimension of ‘dim N(Hi) = 2’. Note that we need 6 dB more
gain in SNR for the NSP waveform to get the same result produced by the orthogonal waveform
target detection performance with the minimum additional gain in SNR required. For
example, Algorithms 3 and 4 would select BS#5 because in this case NSP waveform
requires least gain in SNR to achieve a detection probability of 90% as compared to
other BSs.
In Fig.2.5b, we consider the case when dim N(Hi) = 6. Similar to Fig.2.5a we
show detection results for ﬁve different NSP signals but now MIMO radar has a larger
array of antennas as compared to the previous case. In this case, in order to achieve
a detection probability of 90%, we need 3 to 5dB more gain in SNR as compared to
the orthogonal waveform. As in the previous case, using Algorithms 3 and 4 we can
select interference channel that results in minimum degradation of radar waveform
and results in enhanced target detection performance with the minimum additional
gain in SNR required. For example, Algorithms 3 and 4 would select BS#2 because in
this case NSP waveform requires least gain in SNR to achieve a detection probability
of 90% as compared to the other BSs.
The above two examples demonstrate the importance of Algorithms 3 and 4
in selecting interference channel for radar signal projection to maximize detection
probability and minimize gain in SNR required as a result of NSP of radar waveforms
for spectrum sharing.
Case 1(a): dim N(Hi) = 2: In Fig.2.6, we plot the variations of probability of detec-
tion PD as a function of signal-to-noise ratio (SNR) for various values of probability
of false alarm PFA. Each subplot represents the PD for a ﬁxed PFA. We choose to
evaluate PD against PFA values of 10−1, 10−3, 10−5 and 10−7 when the interference

2.4 Spectrum Sharing Algorithms for Large MIMO Radar
33
−10
−5
0
5
10
15
0.4
0.5
0.6
0.7
0.8
0.9
1
SNR
PD
PD for PFA = 10−1
PD for Orthogonal Waveforms
PD for NSP Waveforms
−10
−5
0
5
10
15
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
SNR
PD
PD for PFA = 10−3
PD for Orthogonal Waveforms
PD for NSP Waveforms
−10
−5
0
5
10
15
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
SNR
PD
PD for PFA = 10−5
PD for Orthogonal Waveforms
PD for NSP Waveforms
−10
−5
0
5
10
15
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
SNR
PD
PD for PFA = 10−7
PD for Orthogonal Waveforms
PD for NSP Waveforms
3.5dB
4dB
4.5dB
4.5dB
Fig. 2.7 ‘Case 1(b): dim N(Hi) = 6’: PD as a function of SNR for various values of probabil-
ity of false alarm PFA, i.e., PFA = 10−1, 10−3, 10−5 and 10−7. The interference channel Hi has
dimensions 2 × 8, i.e., the radar has M = 8 antennas and the communication system has N BS = 2
antennas, thus, we have a nullspace dimension of ‘dim N(Hi) = 6’. Note that we need 3.5 to 4.5dB
more gain in SNR for the NSP waveform to get the same result produced by the orthogonal waveform
channel Hi has dimensions 2 × 4, i.e., the radar has M = 4 antennas and the com-
munication system has N BS = 2 antennas, thus, we have a null-space dimension of
‘dim N(Hi) = 2’. When we compare the detection performance of two waveforms
we note that in order to get a desired PD for a ﬁxed PFA we need more SNR for NSP
than orthogonal waveforms. For example, say we desire PD = 0.9, then according
to Fig.2.6 we need 6dB more gain in SNR for NSP waveform to get the same result
produced by the orthogonal waveform.
Case 1(b): dim N(Hi) = 6: In Fig.2.7, similar to Fig.2.6, we do an analysis of PD
against the same values of PFA but for interference channel Hi having dimensions
2 × 8, i.e., now the radar has M = 8 antennas and the communication system has
N BS = 2antennas,thus,wehaveanull-spacedimensionof‘dim N(Hi) = 6’.Similar
to Case 1, when we compare the detection performance of two waveforms we note
that in order to get a desired PD for a ﬁxed PFA we need more SNR for NSP than
the orthogonal waveforms. For example, say we desire PD = 0.9, then according to
Fig.2.7 we need 3.5 to 4.5dB more gain in SNR for the NSP waveform to get the
same result produced by the orthogonal waveform.
Comparison of Case 1(a) and Case 1(b): As expected, when SNR increases detec-
tion performance increases for both waveforms. However, when we compare the two
waveforms at a ﬁxed value of SNR, the orthogonal waveforms perform much better
than the NSP waveform in detecting target. This is because our transmitted wave-
forms are no longer orthogonal and we lose the advantages promised by orthogonal
waveforms when used in MIMO radars as discussed in Sect.2.1.6, but, we ensure

34
2 A Projection-Based Approach to Spectrum Sharing
zero-interference to the BS of interest, thus, sharing radar spectrum at an increased
cost of target detection in terms of SNR.
In Case 1(a), in order to achieve a desired PD for a ﬁxed PFA we need more
SNR for NSP as compared to Case 1(b). This is because we are using more radar
antennas, while the antennas at the BS remain ﬁxed in Case 1(b) which increases the
dimension of the null space of the interference channel. This yields better detection
performance even for NSP waveform. So, in order to mitigate the effect of NSP on
radar performance one way is to employ a larger array at the radar transmitter.
2.4.4.2
Analysis of Case 2
For this case, at each run of Monte Carlo simulation we generate K Rayleigh inter-
ference channels, combine them into one interference channel with dimensions
KN BS × M, calculate its null space and construct corresponding projection matrix
using Algorithm 6, perform projection of radar signal using Algorithm 5, transmit
NSP signal, estimate parameters θ and α from the received signal, and calculate the
probability of detection for orthogonal and NSP waveforms.
In Fig.2.8, we consider the case when the radar has a very large antenna array
as compared to the combined antenna array of K BSs. In such a scenario, we have
enough degrees of freedom at the radar for reliable target detection and simultane-
ously nulling out interference to all the BSs present in the network. As an example, in
−40
−35
−30
−25
−20
−15
−10
−5
0
5
10
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
SNR
PD
PD for PFA = 10−5
PD for NSP Waveforms when NBS = 2
PD for NSP Waveforms when NBS = 4
PD for NSP Waveforms when NBS = 6
PD for NSP Waveforms when NBS = 8
PD for Orthogonal Waveforms
Fig. 2.8 Case 2: PD as a function of SNR for PFA = 10−5. The MIMO radar mitigates interference
to all the BSs in the network. As an example, we consider M = 100, K = 5, and N BS = {2, 4, 6, 8}

2.4 Spectrum Sharing Algorithms for Large MIMO Radar
35
Fig.2.8, we consider M = 100, K = 5, and N BS = {2, 4, 6, 8}. We do an analysis of
PD against PFA = 10−5 for the combined interference channel H having dimensions
KN BS × M. When we compare the detection performance of original waveform and
NSP waveform onto the combined channel we note that in order to get a desired PD
for a ﬁxed PFA we need more SNR for NSP than the orthogonal waveforms. For
example, say we desire PD = 0.95, then according to Fig.2.8 we need 1, 2, 3.5,
and 4.5dB more gain in SNR for the NSP waveform when N BS is 2, 4, 6, and 8,
respectively, to get the same result produced by the orthogonal waveforms.
2.5
Conclusion
In future, radar RF spectrum will be shared with wireless communication systems to
meetthegrowingbandwidthdemandsandmitigatetheeffectsofspectrumcongestion
for commercial wireless services. In this chapter, we analyzed a similar spectrum
sharing scenario between radars and cellular systems. We proposed a spatial approach
for interference mitigation of radar signals at an LTE cellular system. We focused on
a radar-centric interference-mitigation approach where our goal was to manipulate
radar signals such that they were not a source of interference to a chosen LTE BS.
We extended the idea to project radar signals onto the null space of interference
channel for a single system to a cellular system with many base stations. We evaluated
target parameter estimation and detection performance of spectrum sharing MIMO
radars. We formulated the statistical detection problem for target detection and used
generalized likelihood ratio test to decide about the presence of target when using
orthogonal waveforms and null-space projected (NSP) waveforms. We proposed
novel spectrum sharing algorithms for various cases in which MIMO radar is sharing
spectrum with cellular system with minimal degradation in its performance metrics.
2.6
MATLAB Code
This section presents MATLAB code for target detection for spectrum sharing MIMO
radars.
%
Compares
Pd
for
Multi
BS
side -to - side
with
orthogonal
waveforms
%
Select
Mt
number
%
Select
BS
number
%%
Define
Parameters
%
Speed
of
light
c
=
3*10^8;
%
Nr
Comm
Receivers
Nr =2;
%
Mt
Radar
Transmiters
Mt =8;
%
Mr
Radar
Receivers

36
2 A Projection-Based Approach to Spectrum Sharing
Mr=Mt;
%
Radial
velocity
of
2000
m/s
v_r
=
2000;
%
Radar
reference
point
r_0
=
500*10^3;
%
Carrier
frequency
3 .5GHz
f_c
=
3.5 *10^9;
%
Angular
carrier
frequency
omega_c =2* pi* f_c;
lambda
=
(2* pi*c)/ omega_c ;
theta =0;
%%
Steering
vector
and
Transmit
Signal
Correlation
Matrix
%
Transmit / Receive
Steering
vector
(Mt
x
1)
a
=
[1
exp (1i
*
pi
*(1: Mt -1)*
sin( theta ))] ';
%
Transmit
Correlation
Matrix
(Mt
x
Mt)
for
Orthonormal
Waveforms
Rs
=
eye (Mt );
%%
Define
SNR
for
ROC
( Reciever
Operating
Characteristics )
SNR_db = -8:1:10;
SNR_mag =10.^( SNR_db. /10);
% Probability
of
false
alarm
values
P_FA
=
[10^ -5];
%%
Monte - Carlo
iterations
MC_iter =10;
Pd_orthog_cell = cell (1, MC_iter );
Pd_NSP_cell = cell (1, MC_iter );
for
i=1: MC_iter
%%
Interference
channel
matrix
H
generation
and
null
space
computation
%
Generate
Cellular
Channels
and
Find
NS
of
them
and
select
%
Channel
with
Min
NS
BS
=5;
%
Make
a
cell
to
store
matrices
BS_channels
=
cell (1, BS );
%
Make
a
cell
to
store
Projectors
for
every
BS
Proj_matrix
=
cell (1, BS );
for
b
=1: BS
BS_channels {b}
=
( randn (Nr ,Mt )+1 i* randn (Nr ,Mt ));
Proj_matrix {b}
=
null ( BS_channels {b})
*
...
ctranspose ( null ( BS_channels {b }));
Rs_null {b}
=
Proj_matrix {b}
*
Rs
*
Proj_matrix {b}';
%
Non - centrality
parameter
of
chi - square
for
z
=
1: length ( SNR_mag )
rho_orthog (b)
=
SNR_mag (z )*( abs (a '* Rs. '*a ))^2;
rho_NSP (b)
=
SNR_mag (z)*( abs(a '* Rs_null {b}. '*a ))^2;
%
Creates
threshold
values
for
a
desired
Pfa
for
%
an
inverse
central -chi - square
w/
2
%
degrees
of
freedom
delta
=
chi2inv ( ones (1, length ( P_FA ))
-
P_FA , repmat (2,1, length ( P_FA )));
%
rows
=
SNR ,
cols
=
P_FA
%
%
ncx2cdf
=
Noncentral
chi - square
cumulative
distribution
function
Pd_orthog (z ,:)
=
ones (1, length ( P_FA ))-
...
ncx2cdf (delta , repmat (2,1, length ( P_FA )),
...
repmat ( rho_orthog (b),1, length ( P_FA )));
Pd_NSP (z ,:)
=
ones (1, length ( P_FA ))-
...
ncx2cdf (delta , repmat (2,1, length ( P_FA )), ...
repmat ( rho_NSP (b),1, length ( P_FA )));
end
Pd_orthog_cell {b}= Pd_orthog ;

2.6 MATLAB Code
37
Pd_NSP_cell {b}= Pd_NSP ;
end
Pd_orthog_cell_multiBS {i}= Pd_orthog_cell ;
Pd_NSP_cell_multiBS {i}= Pd_NSP_cell ;
Pd_orthog_cat (:,:,i)
=
cell2mat ( Pd_orthog_cell_multiBS {i});
Pd_NSP_cat (:,:,i)
=
cell2mat ( Pd_NSP_cell_multiBS {i});
end
Pd_orthog_cat_mean
=
mean ( Pd_orthog_cat ,3);
Pd_NSP_cat_mean
=
mean ( Pd_NSP_cat ,3);
%%
Plots
Probability
of
detection
curves
for
given
%
Probability
of
false
alarm
figure
plot (SNR_db ', Pd_NSP_cat_mean (: ,1) , 'g','LineWidth ' ,2.5)
hold
on
plot (SNR_db ', Pd_NSP_cat_mean (: ,2) , 'b','LineWidth ' ,2.5)
plot (SNR_db ', Pd_NSP_cat_mean (: ,3) , 'r','LineWidth ' ,2.5)
plot (SNR_db ', Pd_NSP_cat_mean (: ,4) , 'm','LineWidth ' ,2.5)
plot (SNR_db ', Pd_NSP_cat_mean (: ,5) , 'y','LineWidth ' ,2.5)
plot (SNR_db ', Pd_orthog_cat_mean (: ,1) , 'k','LineWidth ' ,2.5)
xlabel ('SNR ','fontsize ' ,14)
ylabel ('P_D ','fontsize ' ,14)
title ('P_D
for
P_{FA}
=
10^{ -5} ','fontsize ' ,14)
legend ('P_D
for
NSP
Waveforms
to
BS
1',
'P_D
for
NSP
Waveforms
to
BS
2',
...
'P_D
for
NSP
Waveforms
to
BS
3',
'P_D
for
NSP
Waveforms
to
BS
4',
...
'P_D
for
NSP
Waveforms
to
BS
5','P_D
for
Orthogonal
Waveforms ' ,14)
References
1. A.M. Haimovich, R.S. Blum, L.J. Cimini, MIMO radar with widely separated antennas. IEEE
Signal Process. Mag. 25(1), 116–129 (2008)
2. J. Li, P. Stoica, MIMO radar with colocated antennas. IEEE Signal Process. Mag. 24(5), 106–
114 (2007)
3. M. Skolnik, Radar Handbook, 3rd edn. (McGraw-Hill Professional, Maidenheach, 2008)
4. J. Li, P. Stoica, MIMO Radar Signal Processing (Wiley-IEEE Press, New York, 2008)
5. A. Khawar, A. Abdel-Hadi, T.C. Clancy, R. McGwier, Beampattern analysis for MIMO radar
and telecommunication system coexistence, in IEEE International Conference on Comput-
ing, Networking and Communications, Signal Processing for Communications Symposium
(ICNC’14 - SPC) (2014)
6. A. Khawar, A. Abdelhadi, T.C. Clancy, Channel Modeling Between MIMO Seaborne Radar
and MIMO Cellular System. (Under submission)
7. A. Khawar, A. Abdelhadi, T.C. Clancy, Performance Analysis of Coexisting Radar and Cellular
System in LoS Channel. (Under submission)
8. A. Khawar, A. Abdelhadi, T.C. Clancy, 3D Channel Modeling Between Seaborne Radar and
Cellular System. (Under submission)
9. A. Khawar, A. Abdel-Hadi, T.C. Clancy, On the impact of time-varying interference-channel
on the spatial approach of spectrum sharing between S-band radar and communication system,
in IEEE Military Communications Conference (MILCOM) (2014)
10. D. Tse, P. Viswanath, Fundamentals of Wireless Communication (Cambridge University Press,
Cambridge, 2005)

38
2 A Projection-Based Approach to Spectrum Sharing
11. A. Babaei, W.H. Tranter, T. Bose, A nullspace-based precoder with subspace expansion for
radar/communications coexistence, in IEEE Global Communications Conference (GLOBE-
COM) (2013)
12. J.A. Mahal, A. Khawar, A. Abdelhadi, T.C. Clancy, Radar precoder design for spectral coex-
istence with coordinated multi-point (CoMP) system, CoRR, vol. abs/1503.04256, (2015)
13. Y. Noam, A. Goldsmith, Blind null-space learning for MIMO underlay cognitive radio net-
works,” in Proceedings of the IEEE International Communication on Conference (2012)
14. S. Sodagari, A. Khawar, T.C. Clancy, R. McGwier, A projection based approach for radar
and telecommunication systems coexistence, in IEEE Global Communications Conference
(GLOBECOM) (2012)
15. H. Shajaiah, A. Khawar, A. Abdel-Hadi, T.C. Clancy, Resource allocation with carrier aggre-
gation in LTE Advanced cellular system sharing spectrum with S-band radar, in IEEE Interna-
tional Symposium on Dynamic Spectrum Access Networks: SSPARC Workshop (IEEE DySPAN
2014 - SSPARC Workshop) (McLean, USA, 2014)
16. M. Ghorbanzadeh, A. Abdelhadi, C. Clancy, A Utility Proportional Fairness Resource Alloca-
tion in Spectrally Radar-Coexistent Cellular Networks (Submitted to Milcom 2014)
17. I. Bekkerman, J. Tabrikian, Target detection and localization using mimo radars and sonars.
IEEE Trans. Signal Process. 54, 3873–3883 (2006)
18. S. Kay, Fundamentals of Statistical Signal Processing: Detection Theory (Prentice Hall, 1998)
19. A. Khawar, A. Abdelhadi, C. Clancy, Target detection performance of spectrum sharing MIMO
radars. IEEE Sens. J. 15, 4928–4940 (2015)

Chapter 3
Coloacted MIMO Radar
and CoMP Cellular System
Jasmin Mahal, Awais Khawar, Ahmed Abdelhadi and T. Charles Clancy
Inthischapter,theauthorsaddressthespeciﬁcproblemofspectrumsharingbetweena
multiple-input multiple-output (MIMO) ship-borne defense radar system and a com-
mercial MIMO cellular network consisting of clusters of cooperative base stations
(BS), commonly known as Coordinated Multi-Point (CoMP) system. The CoMP
system coordinates simultaneous transmissions from multiple BSs to User Equip-
ment (UE) in the downlink and perform joint decoding of UE signals at multiple BSs
in the uplink. Thus, the CoMP system utilizes coordination among BSs to effectively
turn otherwise harmful inter-cell interference (ICI) into useful signals. This results in
improved coverage, throughput, and efﬁciency for overall cellular system as well as
for the cell-edge users. Due to these advantages of the CoMP system over traditional
cellular system, 3GPP LTE-Advanced Release 11 and beyond consider CoMP as an
enabling technology for 4G mobile systems [1].
We design the radar precoder for two modes of operation: cooperation/cognition
mode and interference mitigation mode. During the cooperation/cognition mode,
the radar not only broadcasts information to the communication system using the
designed precoder but also, utilizing its sensing capability, the radar collects infor-
mation about the BS-clusters, estimates the channel either by using training symbols
sent by the communication system or by blind null-space learning. By processing
these information, the radar decides on the best BS- cluster for NSP/SSVSP during
interference mitigation mode.
Building upon the works in [2, 3], the authors of this chapter have extended the
solution approach to address a MIMO ship-borne radar and a MIMO commercial
CoMP communication system coexistence scenario, which is applicable for the LTE-
Advanced system. Our contributions are summarized as follows:
The content in this chapter is reproduced with permission after some modiﬁcations (License
number 4033171373678). For the original article please refer to: Jasmin A. Mahal, A. Khawar,
A. Abdelhadi, C. Clancy, “Spectral coexistence of MIMO radar and MIMO cellular system”,
IEEE Transactions on Aerospace and Electronic Systems, Vol. 53, Issue: 2, April 2017.
© The Author(s) 2018
A. Khawar et al., Spectrum Sharing Between Radars and Communication Systems,
SpringerBriefs in Electrical and Computer Engineering,
DOI 10.1007/978-3-319-56684-9_3
39

40
3 Coloacted MIMO Radar and CoMP Cellular System
• Precoder Design for Interference Mitigation: In order to mitigate interference to
CoMP system we derive two radar precoders using subspace projection methods
in this paper. In the ﬁrst scheme, the radar projects its signals onto the CoMP
BS-clusters and selects the cluster with the maximum null space. This scheme is
known as Switched Null-Space Projection (SNSP) as radar looks for the optimal
cluster at each pulse repetition interval (PRI), and thus switches among clusters at
each PRI depending upon its mission requirements. In the newly proposed second
scheme, called Switched Small Singular Value Space Projection (SSSVSP), the
projection space has been expanded to include the subspace corresponding to
the small nonzero singular values under a speciﬁed threshold in addition to the
null space. The precoder is designed based on the knowledge of a composite
interference channel matrix between the radar and a particular BS-cluster.
• PrecoderDesignforCooperation/Cognition:Wederiveradarprecodersforcom-
municating with the CoMP system based on zero forcing (ZF) and minimum mean
square error (MMSE) criteria. The purpose of this mode is information exchange
between the radar and the CoMP system. This mode is further divided into two
phases. In the ﬁrst phase, the radar is in cognition mode to sense the training
symbols sent by the communication system to perform channel estimation. The
CoMP system also informs the radar of its clustering information through a con-
trol channel. Consequently, this ﬁrst phase is associated with signal design on the
CoMP side rather than the radar side. In the second phase, the radar in broadcast
mode informs the CoMP system about which cluster it has selected for interference
mitigation. Obviously, the second phase is associated with radar precoder design
for effective radar signal detection at the communication system. The coopera-
tion mode is vital for the success of interference mitigation mode coming right
after it. Without this sort of information exchange, spectrum sharing would not be
successful.
• Precoder Performance Analysis: In order to evaluate the performance of radar
precoders, we perform detailed theoretical analysis. Although theories are devel-
oped based on the assumption of perfect channel knowledge, simulations are car-
ried out considering channel estimation errors [4]. We look at the target localization
and interference mitigation capabilities of the radar precoders. The results indicate
that while the precoder nulliﬁes the radar interference to the clusters, it degrades the
radar performance by introducing correlation in the probing signals. We show that
this performance loss can be compensated for by two means either by increasing
the number of radar antennas or by utilizing small singular value space projection
rather than using null-space projection. Our results show that between the two
compensation schemes, the former is more effective.
This chapter is structured as follows. Section3.1 details the radar/communication
system spectral-coexistence model. Design of radar precoder for different operat-
ing modes is described in Sect.3.2. The newly proposed SSSVSP algorithms are
presented in Sect.3.3. Section3.4 analyzes the performance of the designed radar
precoders theoretically. Simulation results are explained in Sect.3.5. Section3.6 con-
cludes the chapter with ﬁnal remarks.

3.1 Radar/CoMP System Spectral-Coexistence Models
41
3.1
Radar/CoMP System Spectral-Coexistence Models
In this section, we introduce CoMP communication system model, MIMO radar
signal model, and our radar-communication system spectrum sharing scenario.
In this chapter, the vectors and matrices are denoted by lowercase and uppercase
boldface letters, respectively (e.g., j and J). The rank, null space, transpose, and
Hermitian transpose of J are represented by rank{J}, N {J}, JT and J∗, respectively.
The subspace spanned by a set of vectors S is denoted by Span {S}. The N by N
identity matrix is presented by IN. ∥·∥2 and ∥·∥F denote L-2 norm and Frobenius
norm respectively. Moreover, (X)+ = max(X, 0).
3.1.1
Coordinated Multi-point (CoMP) System
The CoMP reception can be mainly characterized into two classes. One is coordi-
nated scheduling and/or beamforming (CoMP-CS) and the other is joint process-
ing/reception (CoMP-JP). We consider the later for this paper. In this class of joint
processing/reception, data from a single UE is detected by multiple BSs to improve
the detected signal quality and/or cancel actively interference from other UEs. On
the other hand, these BSs can serve a single UE as in the CoMP Single-user MIMO
(CoMP-SU-MIMO) mode, or serve multiple UEs simultaneously as in the CoMP
Multi-user MIMO (CoMP-MU-MIMO) mode using the same frequency at the same
time, as shown in Fig.3.1.
We consider a CoMP system with a total of M base stations forming CT nonover-
lapping sets of BSs with ith BS-cluster denoted by Mi = {1, 2, · · · , mi, · · · , Mi},
serving a total of K users forming CT disjointed sets of UEs with ith UE-cluster
denoted by Ki = {1, 2, · · · , ki, · · · , Ki}, where i = {1, 2, · · · , CT }. As ith BS-
cluster is paired with ith UE-cluster, the kth
i UE in ith UE-cluster receives its message
from a cluster of Mi base stations Mi ⊆M, where M = {1, 2, · · · , M} or the mth
i
BS in ith BS-cluster is provided with the messages of its assigned users set Ki ⊆K,
where K = {1, 2, · · · , K}. Each BS is equipped with NBS antennas and each UE
is equipped with NUE antennas. Consequently, the ith CoMP group consists of Mi
cooperative BSs to serve Ki UEs which are paired and jointly scheduled in the same
frequency at the same time. In the uplink/downlink, the ith CoMP cluster can form
a (Mi NBS) × (Ki NUE) virtual MIMO system.
Let dki ∈CNUE×1 be the vector of transmit symbols intended for the kth
i UE. All
the BSs in the cluster Mi are informed about the data streams dki. This can be realized
by utilizing the backhaul links among the BSs and the central switching unit. For
user ki, a linear transmit precoding matrix, Fki ∈CMi NBS×NUE, which transforms the
data vector dki to the (Mi NBS × 1) transmitted vector Fkidki, is employed by the
BSs. The received signal vector yki ∈CNUE×1 at the kth
i UE on the downlink is given
by

42
3 Coloacted MIMO Radar and CoMP Cellular System
,
,
,
Fig. 3.1 Spectral coexistence of a littoral MIMO radar (for example, an AN/SPN-43C air trafﬁc
control (ATC) radar used by navy in the 3.5GHz band) with a stationary coordinated multi-point
(CoMP) system on the shore. An uplink–downlink model of the CoMP system while sharing radar
bands is illustrated
yki = GkiFkidki + nki
(3.1)
where Gki ∈CNUE×Mi NBS is the channel matrix between the ith BS-cluster and kth
i user
and nki ∈CNUE×1 accounts for noise and non-radar interference terms. The network
channel for the ith CoMP cluster is deﬁned as Gi =

GT
1 , GT
2 , · · · , GT
Ki
T , and the
corresponding set of signals received by all Ki users yi ∈CKi NUE×1 is expressed by
yi = GiFidi + ni.
(3.2)
Details of the variables and matrices are as follows: yi =

yT
1 , yT
2 , · · · , yT
Ki
T ,
Fi =

F1, F2, · · · , FKi

, di =

dT
1 , dT
2 , · · · , dT
Ki
T , ni =

nT
1 , nT
2 , · · · , nT
Ki
T . The
precoding matrix Fi is designed based on channel information in order to improve
performance of the Cooperative-MIMO system.
Similarly, the signal received by the mth
i BS in the ith CoMP cluster bmi ∈CNBS×1
and the received signal vector at the whole cluster bi ∈CMi NBS×1 on the uplink are
respectively given by

3.1 Radar/CoMP System Spectral-Coexistence Models
43
bmi = ˜Gmi ˜Fmiami + ˜nmi
(3.3)
bi = ˜Gi ˜Fiai + ˜ni
(3.4)
where ami ∈CNBS×1 is the signal vector intended for the mth
i BS and ˜nmi ∈CNBS×1
accounts for the corresponding noise and non-radar interference terms. Moreover
˜Gmi ∈CNBS×Ki NUE is the channel matrix between the ith UE-cluster and mth
i BS,
and ˜Fmi ∈CKi NUE×NBS is the precoding matrix. Also ˜Gi =

˜GT
1 , ˜GT
2 , · · · , ˜GT
Mi
T
,
bi =

bT
1 , bT
2 , · · · , bT
Mi
T ,
˜Fi =

˜F1, ˜F2, · · · , ˜FMi

,
ai =

aT
1 , aT
2 , · · · , aT
Mi
T ,
˜ni =

˜nT
1 , ˜nT
2 , · · · , ˜nT
Mi
T . Assuming reciprocity of the channel,
˜Gi = G∗
i .
(3.5)
3.1.2
Clustering Algorithms
Joint transmission/reception in the CoMP system requires additional signaling over-
head and robust backhaul channels. Due to this reason, only a limited number of BSs
cooperate to form a cluster [5]. Cluster formation is an important aspect of the CoMP
system in order to exploit beneﬁts promised by the CoMP system. In general, static
and dynamic clustering algorithms are proposed. Each scheme has its own merits
which are discussed as follows [6]:
• Static Clustering: Static clusters do not change over time and are designed based
on the time-invariant network parameters such as the geography of BSs and sur-
roundings. As the neighboring BSs interfere the most with each other on average,
the clusters are formed by the adjacent BSs only [5].
• Dynamic Clustering: Dynamic clusters continuously adapt to changing parame-
ters in the network such as UE locations and RF conditions. Dynamic cluster-
ing schemes exploit the effect of changing channel conditions, which leads to
much higher performance gains without a signiﬁcant overhead increase [7]. So
the dynamic clustering algorithms cluster the BSs not based on their geographical
proximity, but rather based on their level of interference in the absence of any
cooperation [8].
As the narrow radar beam will illuminate a speciﬁc geographical area, we use static
nonoverlapping clustering algorithms with the clusters formed by adjacent cells. We
assume that mobile network operators are performing the task of BS clustering and
the clustering information is communicated to the radar during the ﬁrst phase of the
cooperation mode.

44
3 Coloacted MIMO Radar and CoMP Cellular System
3.1.3
Colocated MIMO Radar
MIMO radar is an emerging area of research and a possible upgrade option of legacy
radar systems. Unlike the standard phased-array radar which transmits scaled ver-
sions of a single waveform, MIMO radars transmit multiple probing signals that can
be chosen freely. This gives MIMO radars signiﬁcant additional degrees of freedom
compared to phased-array radars, allowing them to track more targets with better
performance, while simultaneously better eliminating clutter and interference. For
collocated transmit and receive antennas, the MIMO radar paradigm is shown to offer
better target parameter identiﬁability, and higher spatial resolution [9–11] which is
very critical for radar operation. For orthogonal signals, MIMO conﬁguration extends
the array aperture by virtual sensors. This phenomenon of virtual aperture extension
enables MIMO radar to obtain higher DOA estimation accuracy, narrower beams
and therefore higher angular resolution, and better detection performance.
In this chapter, we consider a collocated MIMO radar with equal number of
transmit and receive antenna elements, MR. If we denote the samples of baseband
equivalent of MR-dimensional transmitted radar signals as {xR(n)}L
n=1, the signal
coherence matrix can be written as [12]
Rx = 1
L
L

n=1
xR (n) x∗
R (n) =
⎡
⎢⎢⎢⎣
1
β12 . . . β1MR
β21
1
. . . β2MR
...
...
...
...
βMR1 βMR2 . . .
1
⎤
⎥⎥⎥⎦
(3.6)
where n is the time index, L is the total number of time samples, and βoc denotes
the correlation coefﬁcient between oth and cth signals (1 ⩽o, c ⩽MR). The phases
of the set of correlation coefﬁcients, {βoc}, direct the beam to the angle of interest.
If βoc = 0 for o ̸= c, then Rx = IMR, i.e., orthogonal waveforms. This corresponds
to omnidirectional transmission.
The signal received from a single point target at an angle θ as shown in array
conﬁguration in Fig.3.2 can be written as [13]
yR(n) = α A(θ) xR(n) + w(n)
(3.7)
where α represents the complex path loss including the propagation loss and the
coefﬁcient of reﬂection and A(θ) is the transmit–receive steering matrix deﬁned as
A(θ) ≜at(θ)aT
r (θ).
(3.8)
Denoting the propagation delay between the target and the pth transmit element by
τt,p(θ) and the delay between the target and the lth receive element by τr,l(θ), the

3.1 Radar/CoMP System Spectral-Coexistence Models
45
Fig. 3.2 Conﬁguration of radar antenna array
total propagation delay between the pth transmit element and the lth receive element
is given by
τpl(θ) = τt,p(θ) + τr,l(θ).
(3.9)
Based on these notations of propagation delays, the transmit steering vector, at(θ) is
deﬁned as
at(θ) ≜

e−jωcτt,1(θ) · · · e−jωcτt,p(θ) · · · e−jωcτt,MR (θ)T ,
(3.10)
and the receive steering vector, ar(θ) is deﬁned as
ar(θ) ≜

e−jωcτr,1(θ) · · · e−jωcτr,l(θ) · · · e−jωcτr,MR (θ)T .
(3.11)
Using this model, the Cramér–Rao bound (CRB) for target direction estimation is
given in Eq.(3.12) [11]. In Eq.(3.12), ˙at (θ) =
dat
dθ and ˙ar (θ) =
dar
dθ . Assuming
all other parameters ﬁxed, the performance of target direction estimation in terms
of maximum likelihood or Cramér–Rao bound is optimal for orthogonal probing
signals [11, 14, 15].
CRB(θ) =
1
2 SNR

MR ˙a∗
t (θ)RT
x ˙at(θ) + at(θ)∗RT
x at(θ)∥˙ar(θ)∥2
−MR
a∗
t (θ)RT
x ˙at(θ)
2
a∗
t (θ)RTx at(θ)
−1
.
(3.12)

46
3 Coloacted MIMO Radar and CoMP Cellular System
Fig. 3.3 Schematic diagram showing coupling scenario between littoral radar transmitters and
possible future 3.5GHz LTE systems. By geometry, coupling from radar transmitters should occur
more into LTE base station receivers than into UE [16]
3.1.4
Spectral-Coexistence Scenario
The communication system shares the spectrum with a monostatic ship-borne MIMO
radar system as shown in Fig.3.1. The composite interference channel between radar
transmitter and the ith BS-cluster Mi is denoted by ˜Hi,R ∈CMi NBS×MR. Channels are
assumed to be block faded and quasi-static. The signal received by the ith BS-cluster
Mi on the uplink, in the presence of radar, is given simply by
bi = ˜Gi ˜Fiai + ˜ni + ˜Hi,RxR
(3.13)
where ˜Hi,RxR is the composite interfering signal from the MIMO radar to the ith BS-
cluster which we want to mitigate by designing radar precoders in the next section.
We consider the composite interference channel matrix between the radar and the
BS-clusters rather than between the radar and the UEs. The handheld UEs are usually
at or near ground level that are expected to communicate with BSs typically located
at greater heights than the UEs. The BSs are mounted on the sides of buildings
or on building rooftops. As antenna beams for the ship-borne radar systems are
tilted somewhat above local horizons, typically about 0.5–1 angular degrees, they
will couple more strongly into BS receivers than into the UE receivers as shown
schematically in Fig.3.3 [16].
3.2
Signal Design for Spectral Coexistence
For amicable spectral coexistence between the radar and the communication system,
we design the radar signal so that the interference term, the last terms in (3.13) is
forced to zero. The goal is to construct the precoded radar signal xR such that its
interference at all of the BSs of the optimally chosen cluster of the CoMP system is
either zero-forced or minimized during interference-free mode and the radar keeps
switching the beam across the optimal clusters with time. For cooperation mode

3.2 Signal Design for Spectral Coexistence
47
when radar is communicating information to the BSs in the second phase, the radar
is precoded to ensure that the bit error rate (BER) of the received signal at the BSs is
low enough for effective detection. During the ﬁrst phase of the cooperation mode,
all of the BSs in the cluster coordinate in their choices of training symbols and
power transmission so that the radar can estimate the composite interference channel
between itself and the BS-cluster optimally.
3.2.1
Radar Precoder Design for Interference Mitigation
Radar interference to the ith BS-cluster Mi can be mitigated by designing the radar
precoding matrix PR,i ∈CMR×MR as
Hmi,RPR,ixR = 0,
∀mi ∈Mi,
(3.14)
Hmi,RxR = 0,
∀mi ∈Mi,
(3.15)
where the precoded radar signal, xR = PR,ixR and Hmi,R is the channel matrix
betweentheradarandthemth
i BSinMi.Theabovecriteriaissatisﬁedbythefollowing
condition:
PR,ixR ∈N

Hmi,R

,
∀mi ∈Mi.
(3.16)
Therefore, the transmitted radar signal must lie in the null space of Hmi,R for all mi.
We can rewrite Eq.(3.16) as
PR,ixR ∈N

H1,R

∩N

H2,R

· · · ∩N

HMi,R

.
(3.17)
Using the equality N (A) ∩N (B) = N (C) where C = [A∗B∗]∗, the precoder must
satisfy that
PR,ixR ∈N

˜Hi,R

(3.18)
where,
˜Hi,R =

H1,R
∗
H2,R
∗· · ·

HMi,R
∗∗.
(3.19)
To ﬁnd the null space, we ﬁrst obtain the Singular Value Decomposition (SVD)
of direct communication link [17] which diagonalizes the composite channel matrix
˜Hi,R ∈CMi NBS×MR. The regular form of the SVD of ˜Hi,R is, ˜Hi,R = ˜Ui ˜Si ˜V∗
i , where
˜Ui ∈CMi NBS×Mi NBS is a unitary matrix, ˜Si ∈CMi NBS×MR is a rectangular diagonal
matrix with nonnegative real numbers on the diagonal, and ˜V∗
i ∈CMR×MR is another
unitary matrix. The diagonal entries of ˜Si are known as the singular values of ˜Hi,R.
The Mi NBS columns of ˜Ui and the MR columns of ˜Vi are called the left-singular
vectors (u ∈CMi NBS×1) and right-singular vectors (v ∈CMR×1) of ˜Hi,R respectively.

48
3 Coloacted MIMO Radar and CoMP Cellular System
Using SVD, null space of ˜Hi,R is Span
 ¯Vi

where ¯Vi comprises of the columns of
˜Vi corresponding to zero singular values of ˜Hi,R. The precoder PR,i is the projection
matrix into Span
 ¯Vi

, PR,i = ¯Vi
 ¯V∗
i ¯Vi
−1 ¯V∗
i .
Assuming that the matrix ˜Hi,R is full row rank, the nullity, i.e., the dimension of
null space of ˜Hi,R is greater than the difference metric, (MR −Mi NBS). In mathe-
matical terms,
null

˜Hi,R

= dim

N

˜Hi,R

= (MR −Mi NBS)+ .
(3.20)
The necessary condition for a nontrivial precoder

PR,i ̸= 0

to exist is that the
number of radar transmit antennas is greater than sum of the requested degree of
freedom (DoF) of all the base stations in a cluster. In that case, we must have,
MR > Mi NBS to have a nonzero nullity for ˜HR,i and hence a nonzero precoder.
In SVD, the singular values are always arranged in decreasing order: σMi NBS <
σMi NBS−1 < · · · < σ1. These singular values are in fact measures of the transmitted
power in the directions of their corresponding right singular vectors. Consequently,
projecting the radar transmitted signal onto a space spanned by the right singular
vectors corresponding to singular values smaller than a speciﬁc threshold, σth, will
minimize radar interference to the cluster rather than eliminating them completely.
Thiscompromiseisexpectedtomitigatetheperformancelossinradartargetdetection
capability to some extent. The value of σth is dependent on the power constraints
of the communication system. With, σ < σth, i.e., when the projection space is
formed by the right singular vectors corresponding to the nonzero small singular
values under a threshold in addition to the zero singular values, the interference
would be reduced to a great extent for the current channel condition. This kind
of projection could be called Small Singular Value Space Projection (SSVSP). For
SSVSP, using SVD of ˜Hi,R, the projection space is Span
 ¯Vs,i

where ¯Vs,i comprises
of the columns of ˜Vi corresponding to the small nonzero singular values under σth
in addition to the zero singular values. As a result, the precoder PRs,i is given by,
PRs,i = ¯Vs,i
 ¯V∗
s,i ¯Vs,i
−1 ¯V∗
s,i.
Under switched beam condition, the radar keeps scanning for the best composite
interference channel between itself and the clusters, and projects its beam towards
that cluster. With Switched Null-Space Projection (SNSP), the best and the worst
composite interference channels are selected in the following way [2]
˜Hbest = ( ˜Hi,R)imax
(3.21)
where, imax = arg max
1⩽i⩽CT
dim

N

˜Hi,R

(3.22)
and, ˜Hworst = ( ˜Hi,R)imin
(3.23)
where, imin = arg min
1⩽i⩽CT
dim

N

˜Hi,R

.
(3.24)

3.2 Signal Design for Spectral Coexistence
49
For newly proposed Switched Small Singular Value Space Projection (SSSVSP),
the best and the worst composite interference channels are chosen as follows:
˜Hbest = ( ˜Hi,R)imin
(3.25)
where, imin = arg min
1⩽i⩽CT
PRs,ixR −xR

2
(3.26)
and, ˜Hworst = ( ˜Hi,R)imax
(3.27)
where, imax = arg max
1⩽i⩽CT
PRs,ixR −xR

2 .
(3.28)
3.2.1.1
Singular Value Threshold σth
The singular value threshold σth is determined based on the Prad, which is the allowed
radar power level to the communication system so that it does not drive the commu-
nication receiver ampliﬁer into saturation. Assuming max {Pcom} to be the maximum
power allowed at the BS, the corresponding power constraint is given by
E
PRs,ixR
2
=T 
PRs,iP∗
Rs,i

⩽σ2
th Prad
= max {Pcom}
(3.29)
therefore, σth =

max {Pcom}
Prad
.
(3.30)
As σth becomes larger, ¯Vs,i approaches ˜Vi and consequently, PRs,i approaches
IMR. Finally, with σth ≥σ1 we have ¯Vs,i = ˜Vi and PRs,i = IMR, which essentially
means no precoding at radar with consequent interferences at the communication
system but best target detection and localization capability of radar.
3.2.1.2
Composite Channel Matrix ˜Hi,R and Singular Values
To make the composite channel matrix full row rank, we assume that the elements
of ˜Hi,R are independent, identically distributed (i.i.d.) and drawn from a continuous
Gaussian distribution. According to random matrix theory, this makes the rows of
˜Hi,R linearly independent [18]. Moreover, this also represents the Rayleigh-faded
multipath environment of typical cellular system. Now as the condition number of
composite channel matrix, Z

˜Hi,R

= σmax/σmin increases, i.e., the more spread
out the singular values are, SSSVSP results in less leakage of radar power to the
communication system with improved CRB.

50
3 Coloacted MIMO Radar and CoMP Cellular System
3.2.2
Radar Precoder Design for Cooperation
In the second phase of this mode, the radar communicates with the CoMP system.
The radar informs the communication system of the channel matrices corresponding
to base station locations that will be affected by its transmission and the locations that
will have a suppressed interference due to the null space or small singular value space
projection. In this phase, radar operates in broadcast (BC) mode on downlink, i.e.,
from radar to the BSs. Linear precoding (LP) techniques such as zero forcing (ZF) and
minimum mean square error (MMSE) precoders are considered for this MIMO BC
mode. By inverting the channel matrix at the transmitter, the zero-forcing precoder
can completely eliminate the interference among the BSs. However, a price of high
transmission energy has to be paid especially for near singular matrix channels. This
problem can be partially mitigated by using the MMSE linear precoder. This kind
of precoder balances the transmission energy and interference level to achieve the
minimum detection error. In this mode, radar signal is given by
xR = [xR,1 . . . xR,DR]T ∈CDR
where DR is the number of independent information streams intended for the BSs
and DR ⩽min(M NBS, MR). Using ZF criterion, the precoding matrix is given by
[19]
PR = ˜H∗
R

˜HR ˜H∗
R
−1
(3.31)
where, ˜HR is the composite channel between the radar and all the BSs in the com-
munication system and is given by
˜HR =

(H1R)∗(H2R)∗· · · (HM R)∗∗.
(3.32)
The inverse in Eq.(3.31) can be performed only when the condition, MR ≥DR, is
satisﬁed. Similarly, using MMSE criterion, the precoder is as follows [20]
PR = ˜H∗
R

˜HR ˜H∗
R + DRσ2I
−1
.
(3.33)
3.2.3
CoMP Signal Design for Interference Mitigation
Due to the assumption of MIMO structure on both sides, the communication signal
can also be precoded so that they are in the null space of the radar. If we had done the
precoding on the communication side, it would have been performed in the following
way. The signal received by the radar while the CoMP system is transmitting on the
downlink, is given by

3.2 Signal Design for Spectral Coexistence
51
yR(n) = α A(θ) xR(n) + w(n) +
CT

i=1
˜H∗
i,RFidi
(3.34)
where ˜H∗
i,RFidi is the composite interfering signal from the ith BS-cluster to the radar
which we want to mitigate by designing communication system precoders. As each
BS-cluster has its own signal, the goal is to precode the signal of each BS-cluster so
that its corresponding interference to the radar is zero. Consequently, each of the CT
interference terms in (3.34) is forced to zero during interference mitigation mode.
Thiscanberealizedbydesigningtheassociatedprecodingmatrix Fi ∈CMi NBS×Ki NU E
as
˜H∗
i,RFidi = 0.
(3.35)
The above criteria is satisﬁed by the following condition
Fidi ∈N

˜H∗
i,R

.
(3.36)
Therefore, the transmitted communication signal must lie in the left null space of
˜Hi,R for 1 ⩽i ⩽CT .
3.2.3.1
Feasibility of Null-Space Projection Precoding on both Radar
and Communication Side
As MIMO structure is available on both sides, it naturally calls for a possibility of
exploiting null-space projection precoding on both sides so that there is zero mutual
interference. The following proposition explains the feasibility of this option.
Proposition 1 In a spectral-coexistence scenario of a MIMO radar and a MIMO
communication system, null-space projection precoding to avoid interference is pos-
sible on either side but not the both.
Proof It is shown in Sect.3.2.1 that a radar precoder which eliminates its interference
to the ith CoMP-cluster reduces to the projection matrix into null space of an effec-
tive interference channel ( ˜Hi,R). The necessary condition for a nontrivial precoder

PR,i ̸= 0

to exist is that the number of radar transmit antennas is greater than sum
of the requested DoF of all the base stations in the cluster, i.e., we must have
MR > Mi NBS.
On the other hand, it is shown in Sect.3.2.3 that the ith CoMP precoder which
eliminates its interference to the radar is the projection matrix into the left null space
of the effective interference channel ( ˜Hi,R). The necessary condition for a nontrivial
precoder (Fi ̸= 0) to exist is that the number of radar transmit antennas is less than
sum of the requested DoF of all the base stations in the cluster, i.e., we must have

52
3 Coloacted MIMO Radar and CoMP Cellular System
MR < Mi NBS.
As we end up in contradictory requirements to have null-space projection precoding
accomplished on both sides, that option is not viable.
3.2.4
CoMP Signal Design for Cooperation
In the ﬁrst phase of this mode the CoMP system basically helps radar in the estimation
of ˜Hi,R for all the CT BS-clusters. We adopt the channel estimation technique as
described in [21]. The estimation is carried out by having all the BSs in the ith cluster
Mi send training symbols to the radar and the radar utilizes the received signal to
estimate ˜Hi,R and ﬁnd PR,i/PRs,i. As this is a CoMP system, BSs in the ith cluster Mi
can cooperate in their choices of training symbols and transmission power. Further
assuming channel reciprocity, the channel from mth
i BS to the radar transmitter is

Hmi,R
∗. The composite channel from all of the BSs in the cluster to the radar
transmitter is given by
¯Hi,R =

H1,R
∗
H2,R
∗· · ·

HMi,R
∗
.
(3.37)
We can see that, ˜Hi,R =
 ¯Hi,R
∗. The coordination among BSs reduces ¯Hi,R to a
standard MIMO channel. So, by using standard MIMO channel estimation algorithm,
the equations for estimation of composite interference channel is as shown below
[21]
ye =

ρ
Mi NBS
¯Hi,Rse + we,
1 ⩽e ⩽Lt.
(3.38)
Here, Lt is the ﬁxed period at the beginning of each block of L channel uses where
the estimation is performed; ye and we are respectively the MR-dimensional received
signal vector and the noise vector at time e; se is a (Mi NBS)-dimensional vector
containing the concatenation of training symbols sent by all of the communication
BSs in the ith cluster at time e and ρ is the average SNR at each receiving antenna.
The maximum likelihood (ML) estimation of the ¯Hi,R is given by [21]
ˆ¯Hi,R (ML) =

Mi NBS
ρ
YS∗
SS∗−1
(3.39)
where the matrices are: Y =

y1 y2 · · · yLt

, W =

w1 w2 · · · wLt

, and
S =

s1 s2 · · · sLt

. The optimal training symbols that minimizes the mean square
error is chosen so that SS∗= LtIMi NBS. Cooperation among the BSs is required to
choose the optimal training sequence. So, the estimation of ˜Hi,R is given by

3.2 Signal Design for Spectral Coexistence
53
ˆ˜Hi,R =
 ˆ¯Hi,R (ML)
∗
.
(3.40)
3.2.5
The Impact of Ship’s Motion on Radar Precoder Design
In [22], the authors investigate this issue and derive coherence time of channel
between ship-borne radar and stationary communication system. In addition to ship’s
horizontal motion (speed), they consider ship’s vertical motion (bob) induced by sea
and derive the expression for channel coherence time. Considering an AN/SPN-
43C air trafﬁc control (ATC) radar, used by navy in the 3.5GHz band, with PRI of
1 millisecond (ms) and mounted on ships that typically move with a top speed of
32 knots, and also assuming the radar transmits ﬁxed-frequency carrier wave pulse
modulated waveform and swept-frequency carrier wave pulse modulated waveform
(referred to as P0N and Q3N, respectively, in NTIA reports), it is observed that the
PRI of radar is much smaller than the coherence time. The coherence time is more
than 2.5 ms while the PRIs are 1 ms or less. Therefore, the designed precoder and
NSP/SSVSP will be working perfectly even with a moving shipborne radar without
any concerns for CSI being outdated.
3.2.6
The Two Modes of Operation and the PRI of Radar
The radar will keep switching among two modes of operation and its target detection
interval during its Pulse Repetition Interval (P RI = 1/f p) where f p repetition.
During the ﬁrst part of its PRI, it will operate in cooperation/cognition mode for
a short period. But this short period is very critical for the proper operation of the
radar for the rest of the PRI. In the ﬁrst phase of the cooperation/cognition mode,
it will be basically in cognition mode collecting all the information about the BS
clustering of the CoMP and estimating the composite interference channels between
itself and the cellular network. The second phase of this mode is associated with the
radar informing the communication system of the channel matrices. Based on the
vital information it has gathered in the cooperation/cognition mode, it will enter next
into the interference mitigation mode. After this mode, it will remain in its target
detection mode for the rest of the PRI. Then the same cycle will repeat as shown in
Fig.3.4.
3.3
Spectrum Sharing Algorithms
Based on the background theories presented in the last section about the interference
mitigation mode, we propose two new algorithms to implement Switched Small

54
3 Coloacted MIMO Radar and CoMP Cellular System
Fig. 3.4 Schematic diagram presenting the different modes of operation and the PRI of the radar.
The cooperation is for brief period to take care of the operational security concerns of the defense
radar. The two phases of the cooperation mode are not shown
Singular Value Space Projection. As algorithmic implementation of Switched Null-
Space Projection is already available in literature [2, 23], that part is omitted here.
3.3.1
Optimal Cluster Selection Algorithm
Our optimal cluster selection algorithm, shown in Algorithm 7, selects the best
composite interference channel based on the optimality criteria as mentioned in
Eqs.(3.25) and (3.26). Channel State Information (CSI)s are obtained using the
channel estimation technique as described in the last section. The SSVSP projec-
tion matrices of all the clusters, available at that time interval are then found using
Algorithm 8. Algorithm 8 also calculates the difference between the precoded and
the original radar signal and returns it to Algorithm 7. Once Algorithm 7 receives
the difference metrics of all the composite interference channels, it selects the best
composite interference channel associated with the optimal cluster and sends it to
Algorithm 8 for SSVSP radar signal. This is the cognitive algorithm component of
the overall system.
3.3.2
Small Singular Value Space Projection (SSVSP)
Algorithm
In this section, we present our proposed Small Singular Value Space Projection
algorithm. On the ﬁrst cycle, Algorithm 8 gets the CSI estimates of the composite
interference channels from Algorithm 7 and ﬁnds the corresponding small singu-
lar value space projection matrices using the singular value decomposition (SVD)
theorem. It also calculates the associated difference metrics and return them to
Algorithm 7. On the second cycle, after receiving the best composite interference

3.3 Spectrum Sharing Algorithms
55
Algorithm 7 Optimal Cluster Selection Algorithm
loop
for i = 1 : CT do
Estimate CSI of ˜Hi,R.
Send ˜Hi,R to Algorithm 8 for small singular value space computation.
Receive
PRs,ixR −xR

2 from Algorithm 8.
end for
Find imin = arg min
1⩽i⩽CT
PRs,ixR −xR

2.
Set ˘H = ( ˜Hi,R)imin as the best composite interference channel associated with the optimal
cluster.
Send ˘H to Algorithm 8 to get SSVSP radar waveform.
end loop
channel matrix associated with the optimal cluster from Algorithm 7, it ﬁnally cal-
culates the precoded SSVSP radar signal by performing another SVD.
Algorithm 8 Small Singular Value Space Projection (SSVSP) Algorithm
if ˜Hi,R received from Algorithm 7 then
Perform SVD on ˜Hi,R (i.e. ˜Hi,R = ˜Ui ˜Si ˜V∗
i ).
Find small singular value space projection matrix PRs,i = ¯Vs,i ¯V∗
s,i.
Calculate
PRs,ixR −xR

2.
Send
PRs,ixR −xR

2 to Algorithm 7.
end if
if ˘H received from Algorithm 7 then
Perform SVD on ˘H (i.e. ˘H = ˘U˘S ˘V∗).
Find small singular value space projection matrix ˘PRs = ˘¯Vs ˘¯V∗
s .
Calculate SSVSP radar signal ˘xRs = ˘PRs xR.
end if
3.4
Theoretical Performance Analysis of the Radar
Precoder
This section lays the theoretical foundation of the designed radar precoder perfor-
mance. As is shown in Sect.3.2.1, null space of ˜Hi,R is Span
 ¯Vi

where ¯Vi com-
prises of the MR −Mi NBS right-most columns of ˜Vi corresponding to zero singu-
lar values of ˜Hi,R. As ˜Vi is a unitary matrix, columns of it form an orthonormal
set and rows of it also form an orthonormal set. This results in ¯Vi consisting of a
set of orthonormal columns but a set of non-orthonormal rows because the rows
of the ¯Vi are actually part of the orthonormal rows of the corresponding unitary
matrix as shown in Fig.3.5. Consequently, the precoding matrix PR,i reduces from

56
3 Coloacted MIMO Radar and CoMP Cellular System
Fig. 3.5 Schematic diagram presenting how the matrix ¯Vi changes with the variations in MR, Mi,
and NBS. This results in variation in Null space with consequent changes in CRB
1
2
3
4
5
6
7
8
10
−10.6
10
−10.5
10
−10.4
10
−10.3
Number of antennas per BS (NBS)
RMSE (degree)
orthogonal signals
NSP (estimated CSI, SNR=15 dB)
SSVSP (estimated CSI, SNR=15 dB)
Fig. 3.6 CRB on direction estimation of the target as a function of antennas employed by the BS
when using NSP and SSVSP in a spectrum sharing scenario between MIMO radar and cellular
system. A cluster size of Mi = 3 is used while having MR = 100 radar antenna elements

¯Vi
 ¯V∗
i ¯Vi
−1 ¯V∗
i

to
 ¯Vi ¯V∗
i

because being the correlation matrix of the orthonor-
mal columns,
 ¯V∗
i ¯Vi

= IMR−Mi NBS.

3.4 Theoretical Performance Analysis of the Radar Precoder
57
40
60
80
100
120
140
160
180
200
10
−12
10
−11
10
−10
10
−9
10
−8
10
−7
10
−6
10
−5
Number of Radar Antennas(MR)
RMSE (degree)
CRB with orthogonal signals
CRB with precoder (perfect CSI)
CRB with precoder (estimated CSI, SNR=15 dB)
Fig. 3.7 Effect of number of radar antennas (MR) on the CRB(θ) performance of radar. A cluster
size of Mi = 3 is used and NBS = 8
On the other hand, being the correlation matrix of the non-orthonormal rows of ¯Vi,
the precoding matrix comprises of real diagonal elements but nonzero off-diagonal
elements. This turns the orthogonal original radar signal xR into non-orthogonal
precoded radar signal xR. Although this precoder eliminates the radar interference
to all the BSs in the ith cluster Mi, it affects the spatial correlation of radar probing
signals and change their coherence matrix from an identity matrix into one with
nonzero off-diagonal elements. For precoded radar signal, the coherence matrix,
Rx,i = E

xRx∗
R

= PR,i E

xRx∗
R

P∗
R,i = PR,iP∗
R,i as E

xRx∗
R

= IMR.
Figure3.5 also reﬂects the fact that as MR −Mi NBS increases with decreasing
Mi NBS keeping MR constant, the rows of ¯Vi approach closer to the orthonormality as
it covers more elements of the rows of the corresponding unitary matrix. As a result,
the wider null space with more orthonormal row vectors results in less correlated
precoded radar signal with consequent improvement in CRB. Same series of events
occurs as MR −Mi NBS increases with increasing MR keeping Mi NBS constant. With
SSVSP, the ¯Vi gets expanded into ¯Vs,i in a similar way. ¯Vs,i has more columns and
greater part of the rows of the ˜Vi as compared to ¯Vi, which results in improved CRB
as compared to NSP.

58
3 Coloacted MIMO Radar and CoMP Cellular System
1
2
3
4
5
6
7
8
9
10
0
2
4
6
8
10
12
14
16
Number of BSs per cluster (Mi)
Σm
i=1
M
i
||Hm
i,R PR,i||F
NSP (perfect CSI)
NSP (estimated CSI, Lt=64,SNR=20dB)
NSP (estimated CSI, Lt=256,SNR=20dB)
SSVSP (perfect CSI)
SSVSP (estimated CSI, Lt=64,SNR=20dB)
SSVSP (estimated CSI, Lt=256,SNR=20dB)
Fig. 3.8 Variation of radar interference on BS-clusters with cluster size (Mi). NBS = 6 BS antenna
elements are used while having MR = 100 radar antenna elements
3.5
Simulation Results
In this section, the performance of MIMO radar is compared in terms of CRB for
target direction estimation with and without radar precoder and as a function of
number of antennas per BS, number of BSs per cluster, and number of radar antennas
witheitherSNSPorSSVSP.Wehavealsoexploredtheeffectofnull-spaceestimation
error on target direction estimation and radar interference to clusters. The distance of
target to radar array and the radar inter-element spacing are assumed to be r0 = 5 km
and 3λ/4, respectively. The frequency of operation is 3.5GHz. The signal-to-noise
ratio between the radar and its target is denoted by SNR while the same parameter
between the radar and the cluster of BSs of CoMP system is represented by ρ. The
target direction is assumed to be at θ = 0◦.
3.5.1
Performance Analysis of Interference Mitigating
Precoder
Figure3.6 shows the radar CRB performance for orthogonal radar signals as well as
precoded radar signals for NSP and SSVSP with estimated Channel State Information

3.5 Simulation Results
59
20
22
24
26
28
30
10
−9
10
−8
10
−7
Number of radar antennas (MR)
RMSE (degree)
orthogonal signals
NSP best
NSP worst
SSVSP best
SSVSP worst
Fig. 3.9 CRB on direction estimation of the target as a function of number of antenna elements
employed by the radar (MR) with switched NSP and SSVSP while in a spectrum sharing scenario
between MIMO radar and cellular system. A cluster size of Mi = 3 is used while having estimated
CSI. Radar beam is swept across 4 clusters (CT = 4) and the nullity of the clusters is varied by
varying the number of antenna elements per BS, [NBS = {6, 5, 4, 3}]
(CSI). The ﬁgure reﬂects the fact that SSVSP performs better than NSP from the
perspective of radar target detection capability as predicted. This plot also shows
that as NBS increases, the target localization performance of radar degrades. Because
with the increase in NBS, (MR −Mi NBS) decreases for constant MR and Mi. So,
null space of ˜Hi,R shrinks with consequent impact on the precoder which in turn
degrades CRB(θ).
InFig.3.7,wehaveinvestigatedtheeffectofnumberofradarantennas(MR)onthe
CRB performance of radar. As obvious from Eq.(3.12) that CRB explicitly depends
on MR and improves when MR increases. For precoded radar signals, increase in MR
leads to increase in the nullity of ˜Hi,R which impacts the choice of PR,i and results in
improved CRB performance. Results in this plot indicate that increasing the number
of radar antennas can compensate for the performance degradation in target direction
estimation due to correlation in the precoded radar signals. Consequently, for a given
target RMSE, number of radar antennas must increase when radar employs a precoder
to zero-force or minimize its interference at the clusters.
In Fig.3.8, the effect of interference at the clusters is measured using the Frobenius
metric, Mi
mi=1
Hmi,RPR,i

F. Interference becomes less signiﬁcant as the duration

60
3 Coloacted MIMO Radar and CoMP Cellular System
0
5
10
15
10
−3
10
−2
10
−1
10
0
SNR between radar and comm system, ρ(dB)
BER
ZF precoder (estimated CSI, MR=30)
MMSE precoder (estimated CSI, MR=30)
ZF precoder (estimated CSI, MR=100)
MMSE precoder (estimated CSI, MR=100)
Fig. 3.10 BER performance during cooperation mode using QPSK waveform. A total of 4 BSs
(M = 4) is used
of training phase, Lt increases while it will be completely eliminated with perfect
knowledge of ˜Hi,R. So, estimated CSI approaches perfect CSI as Lt increases. This
plot also reﬂects the fact that from the perspective of interference at the clusters, NSP
outperforms SSVSP to a great extent. With NSP, as Mi increases, (MR −Mi NBS)
decreases for constant MR and NBS. So, null space of ˜Hi,R shrinks monotonically
with consequent monotonic increase in interference at the communication system.
With SSVSP, to keep the interference minimum at the communication system, we
performed the simulation by always expanding the null space by incorporating sub-
space corresponding to the smallest singular value. Consequently, as Mi increases
keeping MR and NBS constant, we ended up having gradually decreasing smallest
singular value which in turn led to monotonically decreasing interference leakage to
the communication system. The concave curve reﬂect the fact that as Mi increases,
uptocertainpointgradualshrinkingofnullspacedominatesovermonotonicdecrease
in smallest singular value with consequent increase in interference. After that with
further increase in Mi, the decrease in smallest singular value dominates over gradual
shrinking of null space with consequent decrease in interference.
Figure3.9 plots radar target estimation capability with switched NSP and SSVSP.
It is obvious that both of the beam sweeping methods improve radar performance
when the beam is projected on to the optimal cluster associated either with the
maximum null space or minimum deviation of the precoded radar signal from the
original one. For the worst-case scenarios, SSVSP outperforms SNSP.

3.5 Simulation Results
61
3.5.2
Performance Analysis of Information Exchange
Precoder
Figure3.10 shows the spectrum sharing scenario during the second phase of the
cooperation mode. The plot represents the performance of the BS-cluster in terms of
BER. During simulations, we make sure that MR ≥DR which results in nonsingular
channel matrices. Consequently, ZF outperforms MMSE precoding. The increase in
the number of radar antenna is the obvious solution to close the gap between the
performance of these two precoding methods.
3.6
Conclusion
In this chapter, the authors design precoders of a ship-borne radar in a scenario where
a MIMO radar coexists spectrally with a CoMP commercial communication system.
We investigate the design of precoder for two modes of radar operation: interference
mitigation mode, when the radar attempts to avoid interference with the communi-
cation system and cooperation/cognition mode, when it exchanges information with
the CoMP system. For the interference mitigation mode, the radar steers its beam
towards the optimal clusters of base stations and keeps switching the beam from one
optimal cluster to another. In case of traditional SNSP, the optimality is decided upon
the maximum nullity of the cluster. A new space projection and switching method
has been proposed where the beam is steered to the small singular value space of the
optimal cluster whose optimality is chosen based on the minimum difference between
the precoded and original radar signal. SSSVSP proves to perform better in terms
of sacriﬁcing the radar’s target localization ability by intentionally allowing some
leakage of radar power in the direction of communication system within the power
constraints of preventing the communication system from burnout or saturation.
For cooperation mode, the radar precoder is designed based on the zero-forcing
and MMSE criteria to reduce BER at the BSs for effective detection. Channel estima-
tion error is taken into account for both modes of operation. Although the introduction
of precoding at the radar tries to mitigate the radar interference at the BS-clusters
during interference-free mode, in doing so it causes the radar probing signals loose
their orthogonality with consequent performance loss in radar’s target parameter
estimation capability. SSSVSP mitigates that effect to some extent but increase in
the number of radar antenna elements has stronger impact.
Moreover, by modifying the incumbent’s signal rather than the secondary user,
we attempted to push out the boundaries of the traditions of the ﬁrst two generations
of spectrum sharing. We tried to tread our own path by designing the future fed-
eral systems to enable and actively facilitate more efﬁcient spectrum sharing. This
increased sharing could in turn stimulate new economic growth.

62
3 Coloacted MIMO Radar and CoMP Cellular System
3.7
MATLAB Code
In this section, we provide MATLAB code to generate Fig.3.6 through Fig.3.10 that
present the performance of designed radar precoder in this chapter.
3.7.1
Interference Mitigation Mode
The following scripts produce Fig.3.6 through Fig.3.9 that analyze performance of
interference mitigation radar precoder.
3.7.1.1
Figure3.6
1
%
CRB
versus
Number
of
antennas
per
BS
2
K=3;
%
No
of
BS
in
the
cluster
3
M_k=8* ones (1,K);
%
No
of
antenna
elements
at
kth
transmitter
4
N_k=8* ones (1,K);
%
No
of
antenna
elements
at
kth
receiver
5
M_R =100;
%
No
of
transmit
antenna
elements
on
RADAR
6
N_R =100;
%
No
of
receive
antenna
elements
on
RADAR
7
r_o =5000;
%
distance
of
target
to
radar
array
in
meter
8
fc =3.5 e9;
%
frequency
of
operation
in
Hz
9
c=3e8;
%
speed
of
light
in
m/s
10
lamda =c/fc;
11
d=3* lamda /4;
%
inter - element
spacing
on
radar
12
theta =0;
%
target
direction
in
degrees
13
L_b =1024; %
block
length
14
L_t =512; %
part
of
block
used
for
channel
estimation ,
has
to
be
15
%
power
of
2
for
using
'hadamard '
16
SNR =15;
%
SNR
of
received
radar
signal
from
target
in
dB
17
snr =10^( SNR /10) ;
18
DoF =[1:8];
19
rho_dB =[20]
;%
average
SNR
at
the
radar
from
comm
system
20
rho_ ratio =10.^( rho _dB /10) ;
21
noise _v= sqrt (1./ rho_ ratio );
22
%%
steering
vectors
and
their
differentiations
23
a_t= steering _ULA(theta ,M_R,fc ,d);
24
a_r= steering _ULA(theta ,N_R,fc ,d);
25
a_ tdiff = diff _ steering _ ULA(theta ,M_R,fc ,d);
26
a_ rdiff = diff _ steering _ ULA(theta ,N_R,fc ,d);
27
28
% *****************************************************
29
%
GENERATE
DATA
FROM
RADAR
FOR
TARGET
DETECTION
30
% *****************************************************
31
%
Generation
of
pulses :
Orthogonal
waveforms
S
(M_ RxL)
32
%
such
that
(1/L)*S*S'
is
identity
matrix
33
s =(1/ sqrt (2))*( hadamard (L_b)+1i* hadamard (L_b));
34
s=s(1:M_R ,:);
35
Rs =(1/ L_b)*s*s ';
36
37
% ************************************************************

3.7 MATLAB Code
63
38
%
ESTIMATION
OF
COMPOSITE
CHANNEL
FROM
COMMUNICATION
RECEIVER
39
%
TO
RADAR
TRANSMITTER
40
% ************************************************************
41
for
n =1:8
42
for
x =1:100
43
d_k=n* ones (1,K);
% DoF
44
d_ ksum =sum(d_k);
45
46
%
training
symbol
generation
47
S =(1/ sqrt (2))*( hadamard (L_t)+1i* hadamard (L_t));
%
L_t>d_ ksum
48
S=S(1:d_ksum ,:);
49
50
%
composite
channel
generation
51
H_bar= zeros (M_R,d_ ksum );
52
for
a=1:K
53
H_kR= randn (d_k(a),M_R)+1i* randn (d_k(a),M_R);
54
if
(a ==1)
55
dim =1:d_k(a);
56
else
57
dim =( sum(d_k(1:a -1))+1) :( sum(d_k(1:a)));
58
end
59
H_bar (:, dim)=H_kR ';
60
end
61
H_ real =H_bar ';
62
63
%%
Null - space
computation
for
perfect
CSI
64
[U_per ,B_per ,V_per]
=
svd(H_ real );
%
SVD
of
H
65
66
%
Select
eigenvectors
corresponding
to
SVs
below
threshold
sigma
67
if
n==1
68
B1
=
B_per(n,n);
69
else
70
B1= diag (B_per) ';
71
end
72
[row1,col 1]
=
find (B 1==0) ;
%
Find
cols
with
SV
<
threshold
73
co 1=[ col1
d_ ksum +1:M_R];
74
V_ tilda 1
=
V_per (:, co 1);
%
Pick
corresponding
cols
of
V
75
P_R1
=
V_ tilda 1*V_ tilda 1';
76
Rs_ null _per
=
P_R1*P_R1';
77
cb(x)
=
CRB(Rs ,
a_t,a_tdiff ,
a_rdiff ,
N_R,
snr);
78
cb_per(x)
=
CRB(Rs_ null _per ,
a_t,a_tdiff ,
a_rdiff ,
N_R,
snr);
79
80
%% SSVSP
81
ss 1= length (B1);
82
co1ms =[ ss1
d_ ksum +1:M_R];
83
V_ tilda 1ms
=
V_per (:, co1ms);
%
Pick
corresponding
cols
of
V
84
P_R1ms
=
V_ tilda 1ms*V_ tilda 1ms ';
85
Rs_ null _ perms
=
P_R1ms*P_R1ms ';
86
cb_ perms (x)
=
CRB(Rs_ null _perms ,
a_t,a_tdiff ,
a_rdiff ,
N_R,
snr);
87
for
r=1: length ( noise _v)
88
%
AWGN
generation
89
W= sqrt ( noise _v(r))*( randn (M_R,L_t)+1i* randn (M_R,L_t));
90
91
%
signal
received
at
radar
for
the
whole
training
period
92
Y= zeros (M_R,L_t);
93
for
b=1:L_t
94
Y(:,b)= sqrt (rho_ ratio (r)/d_ ksum )*H_bar*S(:,b)+W(:,b);
95
end
96

64
3 Coloacted MIMO Radar and CoMP Cellular System
97
%
ML
estimation
of
composite
channel
98
H_ barest = sqrt (d_ ksum / rho_ ratio (r))*Y*S '* inv(S*S ');
99
H_est=H_barest ';
100
101
%%
Null - space
computation
for
estimated
CSI
102
[U_es ,A_es ,V_es]
=
svd(H_est);
%
SVD
of
H
103
%
Select
eigenvectors
corresponding
to
SVs
below
threshold
sigma
104
if
n==1
105
A1
=
A_es(n,n);
106
else
107
A1= diag (A_es) ';
108
end
109
[row2,col 2]
=
find (A 1==0) ;
%
Find
cols
with
SV
<
threshold
110
co 2=[ col2
d_ ksum +1:M_R];
111
V_ tilda 2
=
V_es (:, co 2);
%
Pick
corresponding
cols
of
V
112
P_R2
=
V_ tilda 2*V_ tilda 2';
113
Rs_ null _ wchest
=
P_R2*P_R2';
114
cb_ wchest (r,x)
=
CRB(Rs_ null _ wchest ,
a_t,a_tdiff ,
a_rdiff ,...
115
N_R,
snr);
116
117
%% SSVSP
118
ss 2= length (A1);
119
co2ms =[ ss2
d_ ksum +1:M_R];
120
V_ tilda 2ms
=
V_es (:, co2ms);
%
Pick
corresponding
cols
of
V
121
P_R2ms
=
V_ tilda 2ms*V_ tilda 2ms ';
122
Rs_ null _ wchestms
=
P_R2ms*P_R2ms ';
123
cb_ wchestms (r,x)
=
CRB(Rs_ null _ wchestms ,
a_t,a_tdiff ,...
124
a_rdiff ,
N_R,
snr);
125
end
126
end
127
crb(n)= mean (cb);
128
crb_ null _ wchest 1(n)
=
mean (cb_ wchest (1 ,:));
129
crb_ms_ wchest 1s(n)
=
mean (cb_ wchestms (1 ,:));
130
crb_ null _per(n)
=
mean (cb_per);
131
crb_ms_per(n)
=
mean (cb_ perms );
132
end
133
134
%%
This
produces
CRB
135
figure
(1)
136
semilogy (DoF ,crb ,'-bs ',' LineWidth ' ,2)
137
axis ([1
8
10^( -10.6)
10^( -10.30) ])
138
hold
on
139
semilogy (DoF ,abs(crb_ null _ wchest 1) ,'-ro ',' LineWidth ' ,2)
140
hold
on
141
semilogy (DoF ,abs(crb_ms_ wchest 1s) ,'-kd ',' LineWidth ' ,2)
142
xlabel (' Number
of
antennas
per
BS
(N_{ BS }) ','fontsize ' ,14)
143
ylabel (' RMSE
( degree ) ','fontsize ' ,14)
144
legend (' Location ','Best ',' orthogonal
signals ' ,...
145
'NSP
( estimated
CSI ,
SNR =15
dB) ','SSVSP
( estimated
CSI ,
SNR =15
dB)
')
146
hold
off
3.7.1.2
Figure3.8
1
%
Radar
Interference
versus
number
of
BSs/ cluster
2
3
K =(1:10) ;
%
No
of
BSs
per
cluster

3.7 MATLAB Code
65
4
M_k=6* ones (1, length (K));
5
N_k=6* ones (1, length (K));
6
M_R =100;
%
No
of
transmit
antenna
elements
on
RADAR
7
N_R =100;
%
No
of
receive
antenna
elements
on
RADAR
8
L_b =512; %
block
length
9
L_t =[64
256]; %
part
of
block
used
for
channel
estimation ,
has
to
be
10
%
power
of
2
for
using
'hadamard '
11
SNR =20;
%
SNR
of
received
radar
signal
from
target
in
dB
12
snr =10^( SNR /10) ;
13
rho_dB =20;
14
rho_ ratio =10^( rho_dB /10) ;
15
noise _v= sqrt (1/ rho_ ratio );
16
17
% ************************************************************
18
%
ESTIMATION
OF
COMPOSITE
CHANNEL
FROM
COMMUNICATION
RECEIVER
19
%
TO
RADAR
TRANSMITTER
20
% ************************************************************
21
for
n=1: length (K)
22
d_k=6* ones (1,n);
% DoF
for
kth
user
23
d_ ksum = sum(d_k);
24
for
x =1:100
25
26
% *****************************
27
%
composite
channel
generation
28
% *****************************
29
H_kR= zeros (N_k(1) ,n*M_R);
30
H_bar= zeros (M_R,d_ ksum );
31
for
a=1:n
32
H_kR (: ,(a -1)*M_R+1:a*M_R)= randn (N_k(a),M_R)+1i* randn (N_k(a),M_R
);
33
if
(a ==1)
34
dim =1:d_k(a);
35
else
36
dim =( sum(d_k(1:a -1))+1) :( sum(d_k(1:a)));
37
end
38
H_bar (:, dim)=(H_kR (: ,(a -1)*M_R +1:a*M_R)) ';
39
end
40
H_ real =H_bar ';
41
42
% *****************************************
43
%%
Null - space
computation
for
perfect
CSI
44
% *****************************************
45
[U_per ,B_per ,V_per]
=
svd(H_ real );
%
SVD
of
H
46
47
%
Select
eigenvectors
corresponding
to
SVs
below
threshold
sigma
48
if
d_ ksum ==1
49
B
=
B_per(d_ksum ,d_ ksum );
50
else
51
B= diag (B_per) ';
52
end
53
[row1,col 1]
=
find (0
==
B);
%
Find
cols
with
SV
<
threshold
54
co 1=[ col1
d_ ksum +1:M_R];
55
V_ tilda 1
=
V_per (:, co 1);
%
Pick
corresponding
cols
of
V
56
P_ Real
=
V_ tilda 1*V_ tilda 1';
57
frob _per(x) =0;
58
for
z=1:n
59
interf _per =(H_kR (: ,(z -1)*M_R+1:z*M_R))*P_ Real ;
60
frob _per(x)
=
frob _per(x)+ norm ( interf _per ,'fro ');

66
3 Coloacted MIMO Radar and CoMP Cellular System
61
end
62
63
%% SSVSP
64
ss 1= length (B);
65
co1ms =[ ss1
d_ ksum +1:M_R];
66
V_ tilda 1ms
=
V_per (:, co1ms);
%
Pick
corresponding
cols
of
V
67
P_R1ms
=
V_ tilda 1ms*V_ tilda 1ms ';
68
frob _ perss (x)=0;
69
for
zs =1:n
70
interf _ perss =(H_kR (: ,(zs -1) *M_R+1: zs*M_R))*P_R1ms
;
71
frob _ perss (x)
=
frob _ perss (x)+ norm ( interf _perss ,'fro ');
72
end
73
74
for
r=1: length (L_t)
75
76
% ****************************
77
%
training
symbol
generation
78
% ****************************
79
S =(1/ sqrt (2))*( hadamard (L_t(r))+1i* hadamard (L_t(r)));
%
L_t>d_ ksum
80
S=S(1:d_ksum ,:);
81
82
%
AWGN
generation
83
W= sqrt ( noise _v)*( randn (M_R,L_t(r))+1i* randn (M_R,L_t(r)));
84
85
%
signal
received
at
radar
for
the
whole
training
period
86
Y= zeros (M_R,L_t(r));
87
for
b=1:L_t(r)
88
Y(:,b)= sqrt (rho_ ratio /d_ ksum )*H_ bar*S(:,b)+W(:,b);
89
end
90
91
%
ML
estimation
of
composite
channel
92
H_ barest = sqrt (d_ ksum / rho_ ratio )*Y*S '* inv(S*S ');
93
H_est=H_barest ';
94
95
% ******************************************
96
%%
Null - space
computation
for
estimated
CSI
97
% ******************************************
98
[U_es ,A_es ,V_es]
=
svd(H_est);
%
SVD
of
H
99
100
%
Select
eigenvectors
corresponding
to
SVs
below
threshold
sigma
101
if
d_ ksum ==1
102
A
=
A_es(d_ksum ,d_ ksum );
103
else
104
A= diag (A_es) ';
105
end
106
[row2,col 2]
=
find (0
==
A);
%
Find
cols
with
SV
<
threshold
107
co 2=[ col2
d_ ksum +1:M_R];
108
V_ tilda 2
=
V_es (:, co 2);
%
Pick
corresponding
cols
of
V
109
P_ Rest
=
V_ tilda 2*V_ tilda 2';
110
frob _ wchest (r,x)=0;
111
for
z=1:n
112
interf _ wchest =(H_kR (: ,(z -1)*M_R+1:z*M_R))*P_ Rest ;
113
frob _ wchest (r,x)
= frob _ wchest (r,x)+ norm ( interf _ wchest ,'fro ');
114
end
115
116
%% SSVSP
117
ss 2= length (A);
118
co2ms =[ ss2
d_ ksum +1:M_R];
119
V_ tilda 2ms
=
V_es (:, co2ms);
%
Pick
corresponding
cols
of
V

3.7 MATLAB Code
67
120
P_R2ms
=
V_ tilda 2ms*V_ tilda 2ms ';
121
frob _ wchestss (r,x)=0;
122
for
zs =1:n
123
interf _ wchestss =(H_kR (: ,(zs -1)*M_R +1: zs*M_R))*P_R2ms
;
124
frob _ wchestss (r,x)
=
frob _ wchestss (r,x)+ norm ( interf _ wchestss ,'fro
');
125
end
126
end
127
end
128
129
frob _ null _ wchest 1(n)
=
mean ( frob _ wchest (1 ,:));
130
frob _ null _ wchest 2(n)
=
mean ( frob _ wchest (2 ,:));
131
frob _ null _ per(n)
=
mean ( frob _per);
132
frob _ ssvsp _ wchest 1(n)
=
mean ( frob _ wchestss (1 ,:));
133
frob _ ssvsp _ wchest 2(n)
=
mean ( frob _ wchestss (2 ,:));
134
frob _ ssvsp _ per(n)
=
mean ( frob _ perss );
135
end
136
137
%%
This
produces
CRB
138
figure
(1)
139
plot (K, frob _ null _per ,'-mp ',' LineWidth ' ,2)
140
axis ([1
10
-1
16])
141
hold
on
142
plot (K, frob _ null _ wchest 1,'-c+',' LineWidth ' ,2)
143
hold
on
144
plot (K, frob _ null _ wchest 2,'-gd ',' LineWidth ' ,2)
145
hold
on
146
plot (K, frob _ ssvsp _per ,'-r.',' LineWidth ' ,2)
147
hold
on
148
plot (K, frob _ ssvsp _ wchest 1,'-ko ',' LineWidth ' ,2)
149
hold
on
150
plot (K, frob _ ssvsp _ wchest 2,'-bs ',' LineWidth ' ,2)
151
xlabel (' Number
of
BSs
per
cluster
(M_i) ','fontsize ' ,14)
152
ylabel ('\ Sigma _{m_i =1}^{ M_i}||H_{m_i,R}
P_{R,i }||_F',' fontsize
' ,14)
153
legend (' Location ','Best ','NSP
( perfect
CSI) ',...
154
'NSP
( estimated
CSI ,
Lt =64 , SNR =20 dB) ',...
155
'NSP
( estimated
CSI ,
Lt =256 , SNR =20 dB) ',...
156
'SSVSP
( perfect
CSI) ','SSVSP
( estimated
CSI ,
Lt =64 , SNR =20 dB) ',...
157
'SSVSP
( estimated
CSI ,
Lt =256 , SNR =20 dB) ')
158
hold
off
3.7.1.3
Figure3.9
1
%
NSP
SSVSP
best
worst
versus
number
of
radar
antennas
(M_R)
2
C=4;
%
No
of
clusters
3
K=3;
%
No
of
BS
in
the
cluster
4
M_k=[6
5
4
3];
5
N_k=[6
5
4
3];
6
M_R =(20:30) ;
%
No
of
transmit
antenna
elements
on
RADAR
7
N_R =(20:30) ;
%
No
of
receive
antenna
elements
on
RADAR
8
L_b =512; %
block
length
9
L_t =256;
10
SNR =[20];
%
SNR
of
received
radar
signal
from
target
in
dB
11
snr =10.^( SNR /10) ;
12
DoF =[1: M_k];
13
rho_dB =[15]
;

68
3 Coloacted MIMO Radar and CoMP Cellular System
14
rho_ ratio =10.^( rho _dB /10) ;
15
noise _v= sqrt (1./ rho_ ratio );
16
17
% ************************************************************
18
%
ESTIMATION
OF
COMPOSITE
CHANNEL
FROM
COMMUNICATION
RECEIVER
19
%
TO
RADAR
TRANSMITTER
20
% ************************************************************
21
for
n=1: length (M_R)
22
%
steering
vectors
and
their
differentiations
23
a_t= steering _ULA(theta ,M_R(n),fc ,d);
24
a_r= steering _ULA(theta ,N_R(n),fc ,d);
25
a_ tdiff = diff _ steering _ ULA(theta ,M_R(n),fc ,d);
26
a_ rdiff = diff _ steering _ ULA(theta ,N_R(n),fc ,d);
27
s =(1/ sqrt (2))*( hadamard (L_b)+1i* hadamard (L_b));
28
s1=s(1:M_R(n) ,:);
29
Rs =(1/ L_b)*s1*s1';
30
for
x =1:100
31
H_ mem= zeros (K* max(M_k),C*M_R(n));
32
for
p=1:C
33
d_k=M_k(p)* ones (1,K);
% DoF
34
d_ ksum =sum(d_k);
35
36
%
composite
channel
generation
37
H_bar= zeros (M_R(n),d_ ksum );
38
for
a=1:K
39
H_kR =( randn (d_k(a),M_R(n))+1i* randn (d_k(a),M_R(n)));
40
if
(a ==1)
41
dim =1:d_k(a);
42
else
43
dim =( sum(d_k(1:a -1))+1) :( sum(d_k(1:a)));
44
end
45
H_bar (:, dim)=H_kR ';
46
end
47
H_ real =H_bar ';
48
H_mem (1:K*M_k(p) ,(p -1)*M_R(n)+1:p*M_R(n))=H_bar ';
49
50
%%
Null - space
computation
for
perfect
CSI
51
[U_per ,B_per ,V_per]
=
svd(H_ real );
%
SVD
of
H
52
%
Select
eigenvectors
corresponding
to
SVs
below
threshold
sigma
53
if
d_ ksum ==1
54
B1
=
B_per(d_ksum ,d_ ksum );
55
else
56
B1= diag (B_per) ';
57
end
58
[row1,col 1]
=
find (B 1==0) ;
%
Find
cols
with
SV
<
threshold
59
co 1=[ col1
d_ ksum +1:M_R(n)];
60
nlty (p)= length (co 1);
61
62
%% SSVSP
63
ss 1= length (B1);
64
co1ms =[ ss1
d_ ksum +1:M_R(n)];
65
V_ tilda 1ms
=
V_per (:, co1ms);
%
Pick
corresponding
cols
of
V
66
P_R1ms
=
V_ tilda 1ms*V_ tilda 1ms ';
67
sig_rad=s(1:M_R(n) ,1);
68
diff =P_R1ms*sig_rad -sig_rad;
69
metric (p)= norm ( diff );
70
end
71
72
%%% nsp

3.7 MATLAB Code
69
73
[ best _nsp ,I_ best _nsp ]= max( nlty );
74
H_ best =H_mem (1:M_k(I_ best _nsp) ,...
75
(I_ best _nsp -1)*M_R(n) +1:I_ best _nsp*M_R(n));
76
[ worst _nsp ,I_ worst _nsp ]= min( nlty );
77
H_ worst =H_ mem (1:M_k(I_ worst _nsp) ,...
78
(I_ worst _nsp -1)*M_R(n) +1:I_ worst _ nsp*M_R(n));
79
80
%%
Null - space
computation
for
perfect
CSI
81
[U_bn ,B_bn ,V_bn]
=
svd(H_ best );
%
SVD
of
H
82
%%
83
%
Select
eigenvectors
corresponding
to
SVs
below
threshold
sigma
84
d_k=M_k(I_ best _nsp)* ones (1,K);
% DoF
85
d_ ksum =sum(d_k);
86
if
d_ ksum ==1
87
B1_ bn
=
B_bn(d_ksum ,d_ ksum );
88
else
89
B1_ bn= diag (B_bn) ';
90
end
91
92
[rowbn , colbn ]
=
find (B1_ bn ==0) ;
%
Find
cols
with
SV
<
threshold
93
cobn =[ colbn
d_ ksum +1:M_R(n)];
94
V_ tildabn
=
V_bn (:, cobn );
%
Pick
corresponding
cols
of
V
95
P_Rbn
=
V_ tildabn *V_ tildabn ';
96
Rs_bn
=
P_ Rbn*P_Rbn ';
97
cb(x)
=
CRB(Rs ,
a_t,a_tdiff ,
a_rdiff ,
M_R(n),
snr);%
orthogonal
signals
98
cb_ best _nsp(x)
=
CRB(Rs_bn ,
a_t,a_tdiff ,
a_rdiff ,
M_R(n),
snr);
99
100
%%
Null - space
computation
for
perfect
CSI
101
[U_wn ,B_wn ,V_wn]
=
svd(H_ worst );
%
SVD
of
H
102
%%
103
%
Select
eigenvectors
corresponding
to
SVs
below
threshold
sigma
104
d_k=M_k(I_ worst _nsp)* ones (1,K);
% DoF
105
d_ ksum =sum(d_k);
106
if
d_ ksum ==1
107
B1_ wn
=
B_wn(d_ksum ,d_ ksum );
108
else
109
B1_ wn= diag (B_wn) ';
110
end
111
[rowwn , colwn ]
=
find (B1_ wn ==0) ;
%
Find
cols
with
SV
<
threshold
112
cown =[ colwn
d_ ksum +1:M_R(n)];
113
V_ tildawn
=
V_wn (:, cown );
%
Pick
corresponding
cols
of
V
114
P_Rwn
=
V_ tildawn *V_ tildawn ';
115
Rs_wn
=
P_ Rwn*P_Rwn ';
116
cb_ worst _nsp(x)
=
CRB(Rs_wn ,
a_t,a_tdiff ,
a_rdiff ,
M_R(n),
snr);
117
118
%%% ssvsp
119
[ best _vsp ,I_ best _vsp ]= min( metric );
120
H_ best _v=H_ mem (1:M_k(I_ best _vsp) ,...
121
(I_ best _vsp -1)*M_R(n) +1:I_ best _vsp*M_R(n));
122
[ worst _vsp ,I_ worst _vsp ]= max( metric );
123
H_ worst _v=H_mem (1:M_k(I_ worst _vsp) ,...
124
(I_ worst _vsp -1)*M_R(n) +1:I_ worst _ vsp*M_R(n));
125
%%
ssv
space
computation
for
perfect
CSI
126
[U_bv ,B_bv ,V_bv]
=
svd(H_ best _v);
%
SVD
of
H
127
%%
128
%
Select
eigenvectors
corresponding
to
SVs
below
threshold
sigma
129
d_k=M_k(I_ best _vsp)* ones (1,K);
% DoF
130
d_ ksum =sum(d_k);

70
3 Coloacted MIMO Radar and CoMP Cellular System
131
if
d_ ksum ==1
132
B1_ bv
=
B_bv(d_ksum ,d_ ksum );
133
else
134
B1_ bv= diag (B_bv) ';
135
end
136
137
[rowbv , colbv ]
=
find (B1_ bv ==0) ;
%
Find
cols
with
SV
<
threshold
138
ss 1_ bv= length (B1_ bv);
139
cobv =[ ss 1_ bv
d_ ksum +1:M_R(n)];
140
V_ tildabv
=
V_bv (:, cobv );
%
Pick
corresponding
cols
of
V
141
P_Rbv
=
V_ tildabv *V_ tildabv ';
142
Rs_bv
=
P_ Rbv*P_Rbv ';
143
cb_ best _vsp(x)
=
CRB(Rs_bv ,
a_t,a_tdiff ,
a_rdiff ,
M_R(n),
snr);
144
145
%%
Null - space
computation
for
perfect
CSI
146
[U_wv ,B_wv ,V_wv]
=
svd(H_ worst _v);
%
SVD
of
H
147
%%
148
%
Select
eigenvectors
corresponding
to
SVs
below
threshold
sigma
149
d_k=M_k(I_ worst _vsp)* ones (1,K);
% DoF
150
d_ ksum =sum(d_k);
151
if
n==1
152
B1_ wv
=
B_wv(n,n);
153
else
154
B1_ wv= diag (B_wv) ';
155
end
156
[rowwv , colwv ]
=
find (B1_ wv ==0) ;
%
Find
cols
with
SV
<
threshold
157
ss 1_ wv= length (B1_ wv);
158
cowv =[ ss 1_ wv
d_ ksum +1:M_R(n)];
159
V_ tildawv
=
V_wv (:, cowv );
%
Pick
corresponding
cols
of
V
160
P_Rwv
=
V_ tildawv *V_ tildawv ';
161
Rs_wv
=
P_ Rwv*P_Rwv ';
162
cb_ worst _vsp(x)
=
CRB(Rs_wv ,
a_t,a_tdiff ,
a_rdiff ,
M_R(n),
snr);
163
end
164
165
crb(n)= mean (cb);
166
crb_ null _ best (n)
=
mean (cb_ best _nsp);
167
crb_ null _ worst (n)
=
mean (cb_ worst _ nsp);
168
crb_ ssvsp _ best (n)
=
mean (cb_ best _ vsp);
169
crb_ ssvsp _ worst (n)
=
mean (cb_ worst _vsp);
170
end
171
172
%%
This
produces
CRB
173
figure
(1)
174
semilogy (M_R,crb ,'-kh ',' LineWidth ' ,2)
175
hold
on
176
semilogy (M_R,abs(crb_ null _ best ) ,'-rs ',' LineWidth ' ,2)
177
hold
on
178
semilogy (M_R,abs(crb_ null _ worst ) ,'-go ',' LineWidth ' ,2)
179
hold
on
180
semilogy (M_R,abs(crb_ ssvsp _ best ) ,'-bx ',' LineWidth ' ,2)
181
hold
on
182
semilogy (M_R,abs( crb_ ssvsp _ worst ) ,'-cd ',' LineWidth ' ,2)
183
xlabel (' Number
of
radar
antennas
(M_R) ','fontsize ' ,14)
184
ylabel (' RMSE
( degree ) ','fontsize ' ,14)
185
legend (' Location ','Best ',' orthogonal
signals ','NSP
best ' ,...
186
'NSP
worst ',' SSVSP
best ',' SSVSP
worst ')
187
hold
off

3.7 MATLAB Code
71
3.7.2
Cooperation Mode
The following script produces Fig.3.10 that analyzes performance of radar precoder
in cooperation mode.
3.7.2.1
Figure3.10
1
%
BER
versus
SNR
in
cooperation
mode
with
channel
estimation
2
K=4;
%
No
of
transmitter - receiver
pair
in
the
comm
system
3
ind =1;
4
if
ind ==1
5
M_k=6* ones (1,K);
6
N_k=6* ones (1,K);
7
M_R =30;
%
No
of
transmit
antenna
elements
on
RADAR
8
N_R =30;
%
No
of
receive
antenna
elements
on
RADAR
9
else
10
M_k=8* ones (1,K);
11
N_k=8* ones (1,K);
12
M_R =100;
%
No
of
transmit
antenna
elements
on
RADAR
13
N_R =100;
%
No
of
receive
antenna
elements
on
RADAR
14
end
15
L_b =256; %
block
length
16
L_t =128;
17
SNR =20;
%
SNR
of
received
radar
signal
from
target
in
dB
18
snr =10^( SNR /10) ;
19
rho_dB =(0:15)
;
20
rho_ ratio =10.^( rho _dB /10) ;
21
noise _v= sqrt (1./ rho_ ratio );
22
noit =10^4;
23
24
for
n=1: length (rho_ ratio )
25
errCount _ BERZF =0;
26
errCount _ BERMM =0;
27
for
x=1: noit
28
d_k=M_k;
% DoF
29
d_ ksum =sum(M_k);
30
31
% Generate
random
data
block
using
QPSK
modulation .
32
tmp= round ( rand (2,d_ ksum ));
33
tmp=tmp *2 -1;
34
input =( tmp (1 ,:) +1i*tmp (2 ,:))/ sqrt (2);
35
u= input .';
36
37
%
composite
channel
generation
38
H_bar= zeros (M_R,d_ ksum );
39
for
a=1:K
40
H_kR= randn (d_k(a),M_R)+1i* randn (d_k(a),M_R);
41
if
(a ==1)
42
dim =1:d_k(a);
43
else
44
dim =( sum(d_k(1:a -1))+1) :( sum(d_k(1:a)));
45
end
46
H_bar (:, dim)=H_kR ';

72
3 Coloacted MIMO Radar and CoMP Cellular System
47
end
48
H_r=H_bar ';
49
50
%
training
symbol
generation
51
S =(1/ sqrt (2))*( hadamard (L_t)+1i* hadamard (L_t));
52
S=S(1:d_ksum ,:);
53
54
%
AWGN
generation
55
W= sqrt ( noise _v(n))*( randn (M_R,L_t)+1i* randn (M_R,L_t));
56
57
%
signal
received
at
radar
for
the
whole
training
period
58
Y= zeros (M_R,L_t);
59
for
b=1:L_t
60
Y(:,b)= sqrt (rho_ ratio (n)/d_ ksum )*H_bar*S(:,b)+W(:,b);
61
end
62
63
%
ML
estimation
of
composite
channel
64
H_ barest = sqrt (d_ ksum / rho_ ratio (n))*Y*S '* inv(S*S ');
65
H_ real =H_barest ';
66
67
%%
ZF
precoder
for
perfect
CSI
68
P_R1
=
H_real '* inv(H_ real *H_real ');
69
70
%% MMSE
precoder
for
perfect
CSI
71
P_R1s
=
H_real '* inv(H_ real *H_real '+d_ ksum *(1/ rho_ ratio (n))...
72
*eye(d_ ksum ));
73
74
%
AWGN
generation
75
W= sqrt ( noise _v(n)/2) *( randn (d_ksum ,1) +1i* randn (d_ksum ,1));
76
Y_ZF=H_ real *P_R1*u+W;
77
EstSymbols _ZF= sign ( real (Y_ZF))+1i* sign ( imag (Y_ZF));
78
EstSymbols _ZF= EstSymbols _ZF/ sqrt (2);
79
I_br_ZF= find (( real (u)-real ( EstSymbols _ZF)) ==0) ;
80
errCount _ BERZF = errCount _ BERZF +(d_ksum - length (I_br_ZF));
81
I_bi_ZF= find (( imag (u)-imag ( EstSymbols _ZF)) ==0) ;
82
errCount _ BERZF = errCount _ BERZF +(d_ksum - length (I_bi_ZF));
83
84
Y_ MMSE =H_ real *P_R1s*u+W;
85
EstSymbols _MM= sign ( real (Y_ MMSE ))+1i* sign ( imag (Y_ MMSE ));
86
EstSymbols _MM= EstSymbols _MM/ sqrt (2);
87
I_br= find (( real (u)-real ( EstSymbols _MM)) ==0) ;
88
errCount _ BERMM = errCount _ BERMM +(d_ksum - length (I_br));
89
I_bi= find (( imag (u)-imag ( EstSymbols _MM)) ==0) ;
90
errCount _ BERMM = errCount _ BERMM +(d_ksum - length (I_bi));
91
end
92
93
%
Calculate
the
bit
error
rate
( BER)
94
BER_ZF (1,n)= errCount _ BERZF /(2* d_ ksum * noit );
95
BER_MM (1,n)= errCount _ BERMM /(2* d_ ksum * noit );
96
end
3.7.3
Several Functions for both Modes
In this section, we provide MATLAB code for several functions used for interference
mitigation as well as cooperation mode.
1

3.7 MATLAB Code
73
2
function
[
crb
]
=
CRB(
Rs ,
a_t,a_tdiff ,
a_rdiff ,
N_R,
snr)
3
% This
function
calculates
Cramer
Rao
Bound
4
T1=N_R*a_tdiff '* Rs .'*a_ tdiff ;
5
T2=a_t '* Rs .'*a_t*(( norm (a_rdiff ,2))^2);
6
T3=N_R*abs(a_t '* Rs .'*a_ tdiff ) .^2;
7
T4=a_t '* Rs .'*a_t;
8
T=T1+T2-(T 3./T4);
9
crb =1/(2* snr*T);
10
end
11
12
function
a
=
steering _ ULA(theta ,M,fc ,d)
13
%
generates
a
steering
vector
for
Uniform
Linear
Array
( ULA)
14
%
theta :
angle
of
arrival
with
the
vertical
(in
degrees )
15
%
M:
number
of
antennas
16
%
fc:
carrier
frequency
(in
Hz)
17
%
d:
inter - element
spacing
(in
meter )
18
19
c=3e8;
%
speed
of
light
in
meter / sec
20
Lambda =c/fc;
%
wavelength
in
meter
21
m=0:M -1;
22
a=exp (-1i*2* pi*m*d* sind (theta -45) / Lambda );
23
a=a.';
24
end
25
26
function
a
=
diff _ steering _ULA(theta ,M,fc ,d)
27
b=exp (-1i*2* pi*m*d* sind (theta -45) / Lambda );
28
a=( -1i*2* pi*d*m.*b* cosd (theta -45) )/ Lambda ;
29
a=a.';
30
end
References
1. 4G Americas, 4G Mobile Broadband Evolution: 3GPP Release 11 and Release 12 and Beyond
(2014)
2. A. Khawar, A. Abdel-Hadi, T.C. Clancy, spectrum sharing between S-band radar and LTE
cellular systems: a spatial approach, in IEEE International Symposium on Dynamic Spectrum
Access Networks (DYSPAN) (2014), pp. 7–14
3. A. Babaei, W.H. Tranter, T. Bose, A Nullspace-based precoder with subspace expansion for
radar/communications coexistence, in Globecom 2013 - Signal Processing for Communications
Symposium (2013)
4. A. Khawar, A. Abdel-Hadi, T.C. Clancy, On the impact of time-varying interference-channel
on the spatial approach of spectrum sharing between S-band radar and communication system,
in IEEE Military Communications Conference (MILCOM) (2014)
5. F. Boccardi, H. Huang, Limited downlink network coordination in cellular networks, in
IEEE 18th International Symposium on Personal, Indoor and Mobile Radio Communications
(PIMRC 2007), (2007), pp. 1–5
6. P. Marsch, G.P. Fettweis, (ed.) Coordinated Multi-Point in Mobile Communications: From
Theory to Practice (Cambridge University Press, Cambridge, 2011)
7. A. Papadogiannis, D. Gesbert, E. Hardouin, A dynamic clustering approach in wireless net-
works with multi-cell cooperative processing, in IEEE International Conference on Commu-
nications (2008), pp. 4033–4037
8. A. Papadogiannis, G.C. Alexandropoulos, The value of dynamic clustering of base stations for
future wireless networks, in IEEE International Conference on Fuzzy Systems (2010), pp. 1–6

74
3 Coloacted MIMO Radar and CoMP Cellular System
9. I. Bekkerman, J. Tabrikian, Spatially coded signal model for active arrays, in Proceedings of
the 2004 IEEE International Conference on Acoustics, Speech, and Signal Processing, vol. 2,
(2004), pp. ii/209–212
10. D.W. Bliss, K.W. Forsythe, multiple-input and multiple-ouput Radar and imagng: degrees of
freedom and resolution, in Proceedings of the 37th Asilomer Conference on Signals, Systems,
and Computers, vol. 1, (2003), pp. 54–59
11. J. Li, P. Stoica, MIMO Radar Signal Processing (Wiley, New York, 2009)
12. A. Khawar, A. Abdel-Hadi, T. C. Clancy, R. McGwier, Beampattern analysis for MIMO radar
and telecommunication system coexistence, in IEEE International Conference on Comput-
ing, Networking and Communications, Signal Processing for Communications Symposium
(ICNC’14 - SPC) (2014)
13. A. Khawar, A. Abdelhadi, C. Clancy, Target detection performance of spectrum sharing MIMO
radars. IEEE Sens. J. 15, 4928–4940 (2015)
14. A. Khawar, A. Abdel-Hadi, T.C. Clancy, MIMO radar waveform design for coexistence with
cellular systems, in 2014 IEEE International Symposium on Dynamic Spectrum Access Net-
works: SSPARC Workshop (IEEE DySPAN 2014 - SSPARC Workshop) (McLean, USA, 2014)
15. A. Khawar, A. Abdelhadi, T. C. Clancy, QPSK waveform for MIMO Radar with spectrum
sharing constraints, in Physical Communication (2014)
16. F.H. Sanders, J.E. Carroll, G.A. Sanders, R.L. Sole, Effects of Radar interference on LTE base
station receiver performance, in NTIA Report 14-499, U.S. Department of Commerce (2014)
17. V.R. Cadambe, S.A. Jafar, Interference alignment and degrees of freedom of the K-user inter-
ference channel. IEEE Trans. Inf. Theory 54(8), 3425–3441 (2008)
18. S.A. Jafar, Interference alignment: a new look at signal dimensions in a communication net-
work, in Foundations and Trends in Communications and Information Theory, vol. 7(1) (2011)
19. C. Peel, B. Hochwald, A. Swindlehurst, A vector-perturbation technique for near-capacity mul-
tiantenna multiuser communication-part i: channel inversion and regularization. IEEE Trans.
Comm. 53, 195–202 (2005)
20. X. Shao, J. Yuan, Y. Shao, Error performance analysis of linear zero forcing and MMSE
precoders for MIMO broadcast channels. IET Commun. 1(5), 1067–1074 (2007)
21. A. Babaei, W.H. Tranter, T. Bose, A practical precoding approach for radar/communications
spectrum sharing, in Cognitive Radio Oriented Wireless Networks (CROWNCOM), July 2013,
pp. 13–18
22. A. Khawar, A. Abdelhadi, T. Clancy, Coexistence analysis between radar and cellular system
in LoS channel, in IEEE Communication Letters (2015)
23. H. Shajaiah, A. Khawar, A. Abdel-Hadi, T.C. Clancy, Resource allocation with carrier aggrega-
tion in LTE advanced cellular system sharing spectrum with S-band radar, in IEEE International
Symposium on Dynamic Spectrum Access Networks: SSPARC Workshop (IEEE DySPAN 2014
- SSPARC Workshop) (McLean, USA, 2014)

Chapter 4
Overlapped-MIMO Radar and MIMO
Cellular System
Chowdhury Shahriar, Ahmed Abdelhadi and T. Charles Clancy
In this chapter, we explore a collocated overlapped multiple-input multiple-output
(Overlapped-MIMO) radar waveform design, which is combined with an algorithm
to share spectrum through null space projection (NSP) for the coexistence of radar
and communications system. In this chapter, we extend the previous works [1–3],
which consider a coexistence scenario where collocated MIMO radar operates in
the same band as MIMO communications system, to a spectrum sharing topology
of Overlapped-MIMO radar and MIMO communications system. The antenna ar-
ray of collocated Overlapped-MIMO radar is separated into multiple subarrays for
transmitting signals in this antenna orientation. The antenna elements are overlapped
among the subarrays, where the elements of transmitting subarrays comprise coher-
ent signals and inter-subarray signals are orthogonal to each other.
The proposed antenna design origins lesser interference to communication sys-
tems along with retaining high degree performance of MIMO radar (such as retaining
improved sidelobe suppression in the beampattern and achieving higher SNR gain).
On the other hand, the radar-centric projection algorithm to share spectrum avoids
interference to communications system by projecting the radar signal onto the null
space of the communications channel. Numerical analysis offered here demonstrates
the outcome of the proposed orientation in terms of overall beampattern, sidelobe
levels of the radar waveform, and SNR gain.
The concepts of MIMO radar are receiving attention nowadays as they can have
better performance than legacy radar systems to identify targets with higher angular
resolution [4]. In MIMO radar, multiple waveforms are transmitted via multiple
The content in this chapter is reproduced with permission after some modiﬁcations (License
number 3935121236172). For the original article please refer to: C. Shahriar, A. Khawar, A.
Abdelhadi, C. Clancy, “Overlapped MIMO radar waveform design for coexistence with com-
munication systems”, IEEE Wireless Communications and Networking Conference (WCNC),
2015.
© The Author(s) 2018
A. Khawar et al., Spectrum Sharing Between Radars and Communication Systems,
SpringerBriefs in Electrical and Computer Engineering,
DOI 10.1007/978-3-319-56684-9_4
75

76
4 Overlapped-MIMO Radar and MIMO Cellular System
transmit antenna elements and reﬂected signals from the targets are received by
multiple receive antennas. In [5], authors have proposed a different kind of MIMO
radar that they called ‘Phased-MIMO’ radar. In Phased-MIMO radar, waveforms are
transmitted from a MIMO radar where antenna elements are partitioned into multiple
subarrays, and the elements are allowed to overlap among subarrays. The proﬁt of
this construction over conventional MIMO radar is its higher coherent processing
gain and overall suppressed sidelobes.
The notion of projecting signals onto the null space of an interference channel,
in order to elude interference, is a well-studied theme in the cognitive radio research
community [6, 7]. An interference channel’s null space is calculated at the transmitter
either by exploiting channel reciprocity using its second order statistics [6] or by
blindly estimating the null space, if no cooperation exists between resource sharing
nodes [7]. However, for MIMO radar systems this idea of null space projection
(NSP) was ﬁrst proposed in [1], which was followed by an array of papers [2, 3, 8]
where authors studied the NSP-based spectrum sharing approach for various radar-
communications scenarios to avoid interference.
The remainder of this chapter is organized as follows. Section4.1 builds the foun-
dation of spectrum sharing architecture between MIMO radar and MIMO commu-
nications system by providing the channel model. Section4.2 discusses the prelimi-
naries of collocated MIMO radar. Section4.3 introduces the proposed Overlapped-
MIMO radar architecture. In Sect.4.4, we discuss the performance of the proposed
radar architecture in terms of beampattern and SNR gain. Section4.5 derives the
optimum subarray size for collocated Overlapped-MIMO radar. Section4.6 presents
the radar-centric spectrum sharing algorithm that is called the null space projection
(NSP) algorithm. In Sect.4.7, a general discussion on the assumptions and limiting
factors of NSP algorithm is presented. Section4.8 discusses the simulation setup
and provides quantitative results along with discussion. Section4.9 concludes the
chapter.
4.1
System Model for Coexistence
In this section, we build the foundation for coexistence of radar and communications
system. We start that by describing the model of both radar and communications
system. We deﬁne the channel model for spectrum sharing too. On top of that, we
also state the assumptions made on the interference channel.
4.1.1
Radar Model
The radars assumed to be employed here are the variants of collocated MIMO radar
that comprises MT transmit and MR receive antenna elements. The antennas of the
collocated MIMO radars are uniform linear array (ULA) and elements are spaced at

4.1 System Model for Coexistence
77
least a half wavelength apart (or at the order of half wavelength). The use of collocated
radar is beneﬁcial as this provides superior spatial resolution and target parameter
identiﬁcation than other antenna architecture such as widely spaced radar [9].
4.1.2
Communications System Model
We assume that the communications system is either wireless broadband or cellular
system with MIMO antennas. The MIMO communications system have NT transmit
and NR receive antennas. The communication nodes can be either base stations or
user equipments.
4.1.3
Coexistence Channel Model
Let us now look into the channel model for this spectrum sharing scenario. If we
look from the communication systems perspective, then the received signal at the
receiver terminal of the communications system can be written as
yC(t) = HI
NR×MT xRadar(t) + HNR×NT xC(t) + n(t)
(4.1)
where xRadar(t) is transmitted radar signal, xC(t) is transmitted communications sig-
nal, HI is NR × MT interference channel between radar and communications system,
H is NR × NT channel between transmitter and receiver of the communications sys-
tem, n(t) is AWGN.
The interference channel HI can be denoted as
HI =
⎡
⎢⎣
h(1,1) · · · h(1,MT )
...
...
...
h(NR,1) · · · h(NR,MT )
⎤
⎥⎦
(NR × MT )
(4.2)
where h(n,m)
i
is the coefﬁcient of the channel between mth antenna element of the
MIMO radar to the nth antenna element of the MIMO communications system. The
elements of the HI are assumed to be independent, identically distributed (i.i.d.)
and circularly symmetric complex Gaussian random variables with zero-mean and
unit-variance (also known as Rayleigh fading).
4.1.4
Key Assumptions
We assume that both the radar and communications system are working in an ap-
proachable and cooperative RF environment, cooperating with each other and sharing

78
4 Overlapped-MIMO Radar and MIMO Cellular System
Fig. 4.1 A possible spectrum sharing scenario between a radar mounted on a ship and an on shore
communications system
various information. Information is shared under an arrangement that each system
will seek to avoid causing interference to the other. In this chapter, we investigate a
radar-centric design approach. In our radar-centric design, we assume that the inter-
ference channel state information (CSI) of the communications system is available at
the radar terminal and the goal of the radar is then to develop its own radar waveform
that will avoid interference to the communications system. A typical coexistence
scenario is shown in Fig.4.1.
On top of that, the following assumptions are used throughout this chapter to
make the analysis tractable and intuitive:
• A point target/source is considered, which is deﬁned for targets/sources having a
scatterer with inﬁnitesimal spatial extent.
• Both θ and α are deterministic unknown parameters representing the target’s di-
rection of arrival and the complex amplitude of the target, respectively.
• The path loss α is assumed to be identical for all transmit and receive elements,
due to the far-ﬁeld assumption.
• The angle θ is the azimuth angle of the target.

4.2 Collocated MIMO Radar
79
4.2
Colocated MIMO Radar
In this section, we develop the preliminary mathematical foundations of collocated
MIMO radar. This derivation will enable us to further understand the proposed over-
lapped radar architecture in the later sections. The MIMO radar considered in this
work is assumed to be collocated. The term ‘collocated’ refers a radar system where
the transmit and the receive antennas are geographically located closely in space
(often they are the same array) [4]. In this case, let us assume the number of antenna
elements in the transmit arrays and the receive arrays are MT and MR, respectively.
Let θ be the location parameter of generic target.
Let φ(t) be the waveform emitted from collocated MIMO radar, which can be
deﬁned as
φ(t) =
φ1(t) φ2(t) · · · φMT (t)	T
(4.3)
where t is the time dimension of a radar pulse, and (·)T is the transpose of a vec-
tor/matrix. The signal φm(t), the mth element of the vector φ(t), is the waveform
emitted by the mth transmit antenna of the MIMO radar. In this MIMO radar case,
signal transmitted by each elements are assumed to be orthogonal to each other. As
a result, the overall waveform satisﬁes the orthogonality principle, which infers
Rx =

T0
φ(t)φH(t)dt = IMT
(4.4)
where T0 stands for the radar pulse width, (·)H denotes the Hermitian transpose
and IMT is the MT × MT identity matrix. The orthogonal signal transmission has
many advantages. For example, beamforming is possible at transmitter in addition
to receiver, improved angular resolution can be achieved, extended array aperture is
available in the form of virtual arrays, sidelobes are lower than usual, and the number
of resolvable targets are increased.
In the transmitter, the waveform is steered toward the direction of a particular
target (or source) during transmission. If the target (or source) direction is assumed
to be θ and MT × 1 transmit steering vector is assumed to be a(θ), then for a uniform
linear array (ULA), the transmit steering vector a(θ) can be expressed as
a(θ) =
a1(θ) a2(θ) · · · aMT (θ)	T
(4.5)
=
1 e−j2πdT sin θ · · · e−j2πdT (MT −1) sin θ	T
where the ﬁrst element of vector a(θ) is considered as the reference element, which is
set as a1(θ) = 1, the mth element is set as am(θ) = e−j2πdT (MT −1) sin θ, and the inter-
element space for array is denoted as dT , which is measured in terms of wavelength.
Hence, the initial waveform is multiplied (or steered) with the steering vector and
ﬁnal output of the radar transmitter can be expressed in compact vector form as

80
4 Overlapped-MIMO Radar and MIMO Cellular System
xRadar(t) = a(θ) ⊙φ(t)
(4.6)
=
a1(θ)φ1(t) a2(θ)φ2(t) · · · aMT (θ)φMT (t)	
=
x1(t) x2(t) · · · xMT (t)	
where ⊙denotes the Hadamard (elementwise) product.
The snapshot vector of size MR × 1 received by the collocated MIMO radar
receive antenna array can be expressed as
yRadar(t) = ys(t) + yi(t) + n(t)
(4.7)
where ys(t) is the signal from the target/source, yi(t) is the jamming/interference
signal, and n(t) is the AWGN.
If single point target/source is assumed, then the received signal at the radar
becomes
ys(t) = βs(aT (θs)φ(t))b(θs)
(4.8)
where θs is the direction of the target/source, βs is the complex-valued reﬂection
coefﬁcient of the focal point θs (that takes account of channel effect and propagation
loss), and b(θ) is the receive steering vector of size MR × 1 for the direction θ, which
can be expressed as
b(θ) =
b1(θ) b2(θ) · · · bMR(θ)	T
(4.9)
=
1 e−j2πdT sin θ · · · e−j2πdT (MR−1) sin θ	T
The signal returned from mth transmitted waveform can be recovered by im-
plementing a matched-ﬁlter at the receiver of the radar. The matched-ﬁlter would
contain each of the waveforms {φm(t)}MT
m=1 and will be matched with received signal
as following
ym(t) =

T0
yRadar(t)φ∗
m(t)dt
m = 1, · · · , MT .
(4.10)
One of the key differences of collocated MIMO radar is having more degrees of
freedom (DoF) by the emergence of virtual array. Notice that, the transmitting signals
from the single transmitter of the radar are different. As a result, the echo signals can
be reassigned to the source. This in return gives an enlarged virtual receive aperture.
Then, the size of the virtual data vector will be MT MR × 1 and it can be expressed
as
yv =

yT
1 yT
2 · · · yT
MT
	T
(4.11)
= βsa(θs) ⊗b(θs) + yi+n

4.2 Collocated MIMO Radar
81
where ⊗denotes the Kronker product operator and yi+n denotes the combined com-
ponent of interference and noise. Hence, the target/source signal component can be
written as
ys = βsv(θs)
(4.12)
where v = a(θs) ⊗b(θs) is the virtual steering vector of size MT MR × 1, which is
associated with a virtual array of MT MR elements.
ForULA,the(mt MR + mr)thentryofvirtualarraysteeringvectorv(θ)isgivenby
v[mt MR+mr](θ) = e−j2π(mtdT sin θ+mrdR sin θ)
(4.13)
where mt = 0, · · · , MT −1 and mr = 0, · · · , MR −1. For dT = MRdR, the virtual
array steering vector simpliﬁes to [10]
v[ς](θ) = e−j2πςdR sin θ
(4.14)
where ς = mt MR + mr = 0, 1, · · · , MT MR −1, which infers that an MT MR effec-
tive aperture array can be achieved by employing MT + MR antennas [5]. Here, the
resulting virtual array is a ULA of MT MR elements spaced and dR wavelength apart.
For collocated MIMO radar, aperture size increases due to virtual array, which is re-
sulted from the use of orthogonal signals in the antenna elements. This size extension
is referred as waveform diversity.
4.3
Overlapped-MIMO Radar
In this section, we present a novel formulation of antenna arrays in the MIMO radar
that we named ‘Overlapped-MIMO’ radar. In this formulation, the antenna elements
of the array are partitioned into multiple overlapped subarrays. Among many, one of
the key advantage of this formulation is that it allows to beamform in both transmit
and receive arrays. The key idea behind this formulation is to partition the transmit
arrays into K subarrays where 1 ⩽K ⩽MT , which are allowed to overlap [5]. The
Overlapped-MIMO radar formulation is shown in Fig.4.2.
The complex envelope of the signals at the output of the kth subarray can be
expressed as
sk(t) =

MT
K φk(t) ˜wk
k = 1, · · · , K
(4.15)
where ˜wk is a MT × 1 unit-norm complex vector with Mk beamforming weights
corresponding to the active antenna elements in kth subarray and MT −Mk zero
weights corresponding to the inactive antennas.
As transmitted signal, the frequency spaced signals can be adopted [11], which is
orthogonal if the frequency increment Δf = fk+1 −fk between the waveform φk+1
to φk satisﬁes Δf ≫1/T0. The orthogonal waveform φ(t)k can be modeled as

82
4 Overlapped-MIMO Radar and MIMO Cellular System
Fig. 4.2 A block diagram of the overlapped-MIMO radar formulation
φk(t) = Q(t)e j2πk(Δf )t
(4.16)
where Q(t) is the pulse shape of duration T0, where 0 < t < T0, and k = 1, · · · , K
[12].
The energy of sk(t) within one radar pulse can be written as
Ek =

T0
s H
k (t)sk(t)dt = MT
K
(4.17)
which infers that the total transmitted power is equal to MT .
The reﬂected signal from the target/source at the direction θ in the far-ﬁeld can
be expressed as
r(t, θ) ≜

MT
K β(θ)
K

k=1
˜wH
k ˜ak(θ)φk(t)
(4.18)
=

MT
K β(θ)
K

k=1
wH
k ak(θ)e−jτk(θ)φk(t)

4.4 Performance Metrics for Overlapped-MIMO Radar
83
where β(θ) is the reﬂection coefﬁcient, wk and ak(θ) are the Mk × 1 beamforming
vectors and steering vector, respectively. The ˜ak is a MT × 1 vector with Mk steering
vector corresponding to the active antenna elements in kth subarray and MT −Mk
zero corresponding to the inactive antennas. Finally, τk(θ) is the time of propagation
required for the wave to travel from the ﬁrst element to the next element.
The Eq.(4.18) can be rewritten as
r(t, θ) =

MT
K β(θ) (c(θ) ⊙d(θ))T φK(t)
(4.19)
where the waveform vector is
φK(t) ≜[φ1(t), · · · , φk(t)],
with dimension K × 1, the transmit coherent processing vector is c(θ) ≜[wH
1 a1(θ),
· · · , wH
K aK(θ)] with dimension K × 1, and the waveform diversity vector is d(θ) ≜
[e−jτ1(θ), · · · , e−jτK (θ)] with dimension K × 1.
The received complex vector of the array observation can be written as
yRadar(t) = r(t, θs)b(θs) +
D

i
r(t, θi)b(θi) + n(t),
(4.20)
where D is the number of interfering signals (or scatterers), b(θ) is the receive
steering vector of size MR × 1 associated with direction θ, and n(t) is AWGN.
Following Eqs.(4.10) and (4.11), by match-ﬁltering yRadar(t) to each of the wave-
forms {φk}K
k=1 we can obtain K MR × 1 virtual data vectors as
yv = [yT
Radar,1(t), · · · yT
Radar,K(t)]T
(4.21)
=

MT
K βsu(θs) +
D

i

MT
K βiu(θi) + n,
where u(θ) ≜[(c(θ) ⊙d(θ)) ⊗b(θ)] is the K MR × 1 virtual steering vector,
βs = β(θs) and βi = β(θi) are the reﬂection coefﬁcients of the target/source and in-
terference, respectively. This overlapped subarray formulation collapses to a phased-
array when K = 1 is chosen. In this case, only one waveform is emitted. This results
lower angular resolution but higher coherent processing gain, like phased-array radar.
On the other hand, when K = MT is chosen, the formulation becomes a conventional
MIMO without array partition. This completely diminishes coherent processing gain,
but results higher angular resolution.

84
4 Overlapped-MIMO Radar and MIMO Cellular System
4.4
Performance Metrics for Overlapped-MIMO Radar
In this section, we develop performance metrics of the proposed null space projected
Overlapped-MIMO radar waveform. We evaluate the performance of the proposed
architecture based on beampattern and SNR gain calculation.
We start with calculating the corresponding beamformer weight vector. In the
case of nonadaptive beamforming, the corresponding beamformer weight vectors
are given for the kth transmitting subarray as
wk =
ak(θs)
∥ak(θs)∥=
ak(θs)
√MT −K + 1
(4.22)
where k = 1, 2, · · · , K. The beamforming weight vector of size K N × 1 for the
receiving subarrays can be written as
wd ≜u(θs) = [c(θs) ⊙d(θs)] ⊗b(θs).
(4.23)
4.4.1
Beampattern Improvement
Let G(θ) be the normalized overall beampattern for Overlapped-MIMO
G(θ) = |wH
d u(θ)|2
|wH
d u(θs)|2 = |uH(θs)u(θ)|2
∥u(θs)∥4
(4.24)
For the special case of a ULA, we have aH
1 (θ)a1(θs) = · · · = aH
K (θ)aK(θs). Using
Eq.(4.24), the beampattern of the Overlapped-MIMO radar for a ULA with over-
lapped partitioning of K transmit subarrays can be expressed as
G O(θ) =
aH
K (θs)aK(θ)

(d(θs) ⊗b(θs))H (d(θ) ⊗b(θ))
	2
aH
K (θs)
4 ∥d(θs) ⊗b(θs)∥4 ,
(4.25)
As we know that ∥aK(θs)∥2 = MT −K + 1, ∥d(θs)∥2 = K, and ∥b(θs)∥2 = MR,
the overall beampattern can be expressed as
G O(θ) =
aH
K (θs)aK(θ)
2
(MT −K + 1)2 ·
dH(θs)d(θ)
2
K 2
·
bH(θs)b(θ)
2
M2
R
,
(4.26)
= TO(θ) · DO(θ) · R(θ)

4.4 Performance Metrics for Overlapped-MIMO Radar
85
where the waveform diversity beampattern is DO(θ) ≜|dH(θs)d(θ)|
2
K 2
, the transmit
beampatten is TO(θ) ≜|aH
K (θs)aK (θ)|
2
(MT −K+1)2
and the receive beampatten is R(θ) ≜
|bH(θs)b(θ)|
2
M2
R
. So, we can see that the overall beampattern of the Overlapped-MIMO
radar can be expressed in terms of three distinct and independent beampattern.
ForMIMOradar,thesubarraynumberis K = MT andthetransmitterbeampattern
TM(θ) = 1. Hence, the overall beampattern for MIMO radar can be expressed as
G M I MO(θ) = DM(θ) · R(θ)
(4.27)
where the waveform diversity beampattern is DM(θ) = |aH (θs)a(θ)|
2
M2
T
. Notice that the
overall beampattern of the MIMO radar has only the waveform diversity and receive
beampattern.
For phased-array radar, the subarray number is K = 1 and the waveform diversity
beampattern DP(θ) = 1. Hence, the overall beampattern for phased-array radar can
be expressed as
G P H(θ) = TP(θ) · R(θ)
(4.28)
where the transmit beampattern is TP(θ) = |aH (θs)a(θ)|
2
M2
T
. Notice that the overall beam-
pattern of the phased-array radar has only transmit and receive beampattern.
4.4.2
SNR Gain Improvement
According to [5], the output SNR of the Overlapped-MIMO radar with nonadaptive
transmit/receive beamforming can be expressed as
SN ROM I MO = MRMT (MT −K + 1) σ2
s
σ2n
(4.29)
where σ2
s is the variance of the target/source reﬂection coefﬁcient, thus σ2
s = E{|β|2}
and σ2
n is the noise variance.
For MIMO radar, the output SNR can be found by substituting K = MT at (4.29)
SN RM I MO = MRMT
σ2
s
σ2n
(4.30)
For phased-array radar, the output SNR can be found by substituting K = 1
at (4.29)
SN RP H = MRM2
T
σ2
s
σ2n
= MT · SN RM I MO
(4.31)

86
4 Overlapped-MIMO Radar and MIMO Cellular System
Finally, from (4.29)–(4.31), we can express the output SNR of Overlapped-MIMO
radar as
SN ROM I MO = η · SN RP H = η · MT · SN RM I MO
(4.32)
where
1
MT ⩽η ≜(MT −K+1)
MT
⩽1 is the ratio between the overlapped-MIMO radar
SNR gain and that of the phased-array radar.
We can see that the SNR gain of the MIMO radar is equal to MRMT and the SNR
gain of the phased-array radar is equal to MR M2
T and the SNR gain of the Overlapped-
MIMO radar is equal to MR MT (MT K + 1). The SNR gain of the phased-array radar
is MT times greater than that of the MIMO radar. The SNR gain of the Overlapped-
MIMO radar is (MT K + 1) times greater than that of the MIMO radar and (MT K+1)
MT
times greater than that of the phased-array radar. Hence, we can see an overall SNR
gain improvement for the Overlapped-MIMO architecture.
4.5
Optimum Subarray Size for Overlapped-MIMO Radar
In order to maximize the impact of the overlapping subarray architecture presented,
we have to select a value for the number of subarrays K that maximizes the virtual
array size, Mϵ. Hence,
K = arg max
K
(Mϵ)
(4.33)
where Mϵ = (MT −K + 1) K.
The number of subarrays K in the overlapped array can be optimized by
∂
∂K (Mϵ) = 0
(4.34)
∂
∂K

(MT −K + 1) K

= 0
MT −2K + 1 = 0
K =
 MT + 1
2

where ⌊·⌋stands for the ﬂoor operation as K should be an integer. Note that the radar
has most signiﬁcant impact when the number of virtual arrays, Mϵ, on transmitter
side is maximized (see Eq.(4.34)).

4.6 Radar-Centric Spectrum Sharing Algorithm
87
4.6
Radar-Centric Spectrum Sharing Algorithm
In this section, we describe the details of a radar-centric projection algorithm, which
projectstheOverlapped-MIMOradarsignalontothenullspaceofthecommunication
interference channel via null space projection (NSP) technique proposed in [3]. We
start with a generic description of the spectrum sharing algorithm and move on to
present the mathematical details of the projection matrix.
4.6.1
Null Space Projection (NSP)
This section describes the null space projection (NSP) algorithm, which projects
radar signal onto the null space of the interference channel HI. The NSP algorithm
requires the radar to have the interference channel’s CSI available in advance, which
can be obtained in a number of ways and conveyed to the radar via mutual cooperation
between the radar and the communication systems [1–3].
The proposed algorithm works as follows. At the beginning, the radar receives
HI, which is the CSI between radar and communication node’s interference channel.
It then calculates the number of null spaces available to project the radar signal by
performing singular value decomposition (SVD) on HI. The dimension of the null
space is MT −NR. It then calculates the projection channel matrix P and constructs a
new radar waveform ˆxRadar. If HI is the channel matrix and P is the projection matrix
onto the null space of HI, then the overlapped-MIMO radar waveform projected onto
the null space of HI to avoid interference from radar can be written as
ˆxRadar(t) = PxRadar(t).
(4.35)
Notice that the spectrum sharing algorithm via null space projection (NSP) de-
scribed above is shown in Algorithm 9.
4.6.2
Projection Matrix
In this section, we introduce the formation of the projection matrix P and analyze the
properties of this projection matrix. Let HI be the interference channel between the
radar and communications node. We assume that HI ∈FNR×MT for F = R or F = C.
We want a projection matrix P ∈FMT ×MT of a maximum rank such that it satisﬁes
fowling properties:
• HIP = 0
• P2 = P

88
4 Overlapped-MIMO Radar and MIMO Cellular System
Algorithm 9 Spectrum Sharing Algorithm via Null Space Projection (NSP)
loop
Get CSI of HI through feedback from ‘Communications Node’.
Send HI to inner loop (i.e., NSP Algorithm) for projection matrix P formation.
if HI received from the outer loop, then
Perform SVD on HI (i.e., HI = UΣVH).
Construct 
Σ = diag(σ1,σ2, . . . ,σk).
Construct 
Σ′ = diag(σ′
1,σ′
2, . . . ,σ′
MT ).
Setup projection matrix P = V
Σ′VH.
Send P to the outer loop.
end if
Receive the projection matrix P from inner loop.
Perform null space projection, i.e., ˆxRadar(t) = PxRadar(t).
end loop
The projection matrix P, which satisﬁes above properties and projects onto the
null space of interference channel HI, can be found by taking the SVD of HI. The
SVD of HI is
HI = UΣVH
(4.36)
where U and V are unitary or orthogonal, depending on F, of order NR and MT ,
respectively, and Σ ∈RNR×MT is an NR × MT rectangular diagonal matrix with
nonnegative real numbers on the diagonal. Let us deﬁne

Σ = diag (˜σ1, ˜σ2, · · · , ˜σk)
(4.37)
where k = min (NR, MT ) and ˜σ1 ⩾˜σ2 ⩾· · · ⩾˜σp ⩾˜σp+1 = ˜σp+2 = · · · = ˜σk =
0 are the singular values of HI. Let us deﬁne

Σ
′
= diag

˜σ
′
1, ˜σ
′
2, · · · , ˜σ
′
MT

(4.38)
where 
Σ
′
∈RMT ×MT and
˜σ
′
i =

0, if i ⩽p,
1, if i > p.
Note that 
Σ 
Σ
′
= 0 and


Σ
′2
= 
Σ
′
. Now, one can deﬁne the projection matrix
as
P = V
Σ
′
VH.
(4.39)
We can verify that this matrix P is valid projection matrix by computing the
properties mentioned above. The details of this proofs are given below.

4.6 Radar-Centric Spectrum Sharing Algorithm
89
Property 4.1 P ∈RMT ×MT is an orthogonal projection matrix onto the null space
of HI ∈RNR×MT , if and only if HIP = HIPH = 0.
Proof Since P = PH (see property 2), it can be written
HIP = HIPH = U
ΣVH × V
Σ
′
VH = 0.
(4.40)
The result mentioned above follow from the fact that 
Σ 
Σ
′
= 0 by construction.
Property 4.2 P ∈RMT ×MT is a projection matrix, if and only if P = PH = P2.
Proof At ﬁrst, let us prove the ‘only if’ part, where we will have to show P = PH.
By taking the Hermitian of Eq.(4.39), we will get
PH =

V
Σ
′
VHH
= P.
(4.41)
Then, by squaring the Eq.(4.39) we will get
P2 = V
ΣVH × V
ΣVH = P
(4.42)
where the Eq.(4.42) follows from VHV = I (both of them are orthonormal matrices)
and


Σ
′2
= 
Σ
′
(by construction). If we follow the Eqs.(4.41) and (4.42), we will
ﬁnd that P = PH = P2.
Next, we will show that P is a projector matrix by proving that if v ∈range (P),
then Pv = v, i.e., for some w, v = Pw, then
Pv = P(Pw) = P2w = Pw = v.
(4.43)
On top of that, Pv −v ∈null(P), i.e.,
P(Pv −v) = P2v −Pv = Pv −Pv = 0.
(4.44)
This concludes the proof.
4.7
Assumptions and Limiting Factors of NSP
In this section, we discuss the assumptions and limiting factors of the NSP algorithm
implementation. We consider two spectrum sharing scenario depending upon the
number of antenna elements in the radar and communications system.
The key assumption of NSP algorithm implementation is ‘cooperation’. There
must be some kind of cooperation between the radar and the communication node
to effectively project radar signal onto the null space. They must be exchanging

90
4 Overlapped-MIMO Radar and MIMO Cellular System
the CSI of the inference channel though feedback/feedforward or any other kind of
mechanism. It will work only when the channel is static or quasi-static, meaning the
CSI will not be changed before the projection takes place. A number mechanisms to
exchange CSI between radar and communications system is presented in [13].
Notice that we run into two possible scenarios: (1) the number of antenna elements
in radar transmit array is less than equal to that of communications system, MT ⩽NR
and (2) the number of antenna elements in the radar transmit array is greater than that
of communications system, MT > NR. For ﬁrst scenario where we have MT ⩽NR,
we cannot use the NSP method. However, a possible solution to this problem is
using Overlapped-MIMO as it increases the effective number of transmit arrays, thus
making NSP possible. In this case, the effective transmit array aperture, Mϵ is equal
to (MT −K + 1)K, which is greater than NR. Note that Mϵ is essentially the number
of the virtual arrays in the transmitter of the radar. Hence, the Overlapped-MIMO
radar results in a total virtual array of size ((MT −K + 1)K) MR. On the other
hand, if MT > NR, then we will have sufﬁcient degrees of freedom (DoF) to make
NSP possible for MT −NR dimensions. However, even in this case the performance
can be increased using Overlapped-MIMO since it increases the effective number of
transmit arrays.
4.8
Simulation and Results
In this section, we simulate an Overlapped-MIMO radar. We assume a ULA with
MT = 20 antenna elements at the transmitter. At the receiver, we also assume
MR = 20 antennas. In both cases the space between elements is dT = 0.5, meaning
adjacent antenna elements are half a wavelength apart. The signal passes through
a Rayleigh distributed channel and is subject to AWGN. Each antenna element is
omnidirectional. We assume the target of interest is at θs = 15o and For the sake of
simplicity, we ignored the presence of any interfering signals here. Output SNRs are
computed using 10, 000 independent simulations.
Figure4.3 shows the overall beampattern for four different MIMO radar formula-
tions: (1) Overlapped-MIMO radar with K = 1 (single subarray or phased-array), (2)
Overlapped-MIMO radar with K = 5, (3) Overlapped-MIMO radar with K = 10,
and (4) MIMO radar with K = 20 (MIMO). Here the Overlapped-MIMO radars
have two different orientations of 5 and 10 overlapped subarrays and each subarray
has 11 and 16 antenna elements, respectively. We can observe that the Overlapped-
MIMO with K = 1 (phased-array) and MIMO radars have exactly the same overall
transmit/receive beampatterns. However, the Overlapped-MIMO radar (for K = 5
and K = 10) has signiﬁcantly improved sidelobe suppression compared to the beam-
pattern of the MIMO and the phased-array radar.
Figure4.4 shows the overall beampattern for same radar formulations with NSP
algorithm: (1) Overlapped-MIMO radar with K = 1 plus NSP (single subarray or
phased-array), (2) Overlapped-MIMO radar with K = 5 plus NSP, (3) Overlapped-
MIMO radar with K = 10 plus NSP, and (4) MIMO radar with K = 20 plus NSP

4.8 Simulation and Results
91
−80
−60
−40
−20
0
20
40
60
80
−120
−100
−80
−60
−40
−20
0
20
Angle (deg)
Overall Gain (dB)
Overlapped−MIMO Radar (K=1)
Overlapped−MIMO Radar (K=5)
Overlapped−MIMO Radar (K=10)
MIMO Radar (K=20)
Fig. 4.3 Overall beampattern using conventional transmit-receive beamformer where the total
number of elements is MT = 20, the number of overlapped subarrays is K = 5 and K = 10,
respectively; the number of elements in each subarray is (MT −K + 1) = 16 and (MT −K + 1) =
11, respectively, and dT = 0.5 wavelength
(MIMO). We observe that the projection algorithm has reduced sidelobe suppression
as expected. Note that it is still providing encouraging suppression in compared to
pure MIMO radar. However, the primary beneﬁts are at the communications side
since this NSP algorithm minimizes interference form the radar to the communica-
tions system and thus, enables the two to coexist.
The ﬁnal experiment considers the number of subarrays, K, in the transmitter of
the Overlapped-MIMO radar that maximizes the beneﬁt for the radar in terms of
sidelobe suppression. Note that the radar has most signiﬁcant impact when the num-
ber of virtual arrays, Mϵ, on transmitter side is maximized (see Eq.4.34). Figure4.5
shows the impact of varying the number of subarrays K from 1 to MT on Mϵ. For
MT = 20, K = 11, or K = 12 results in the highest impact. This knowledge enables
determining the structure of overlapping subarrays. The plot of K for MT = 10 and
MT = 15 is shown in the same ﬁgure to provide a comparative view. This graph
enables picking a value for K (the number of subarrays in the Overlapped-MIMO
structure) that maximizes the virtual antenna array size, thus enhancing the amount
of sidelobe suppression in radar beampattern, while retaining the dimension needed
for NSP.

92
4 Overlapped-MIMO Radar and MIMO Cellular System
−80
−60
−40
−20
0
20
40
60
80
−120
−100
−80
−60
−40
−20
0
20
Angle (deg)
Overall Gain (dB)
Overlapped−MIMO Radar w/ NSP (K=1)
Overlapped−MIMO Radar w/ NSP (K=5)
Overlapped−MIMO Radar w/ NSP (K=10)
MIMO Radar w/ NSP (K=20)
Fig. 4.4 Overall beampattern using conventional transmit-receive beamformer and NSP where the
total number of elements is MT = 20, the number of overlapped subarrays is K = 5 and K = 10,
respectively; the number of elements in each subarray is (MT −K + 1) = 16 and (MT −K + 1) =
11, respectively, and dT = 0.5 wavelength
4.9
Conclusion
In this chapter, we presented a MIMO radar architecture that we named ‘Overlapped-
MIMO’ radar and combined a spectrum sharing algorithm called ‘null space projec-
tion’ (NSP) for radar-communications coexistence. In the Overlapped-MIMO radar
architecture, the transmit array of the radar is partitioned into a number of subar-
rays that are permitted to overlap. Each antenna subarray transmit waveforms that
are orthogonal to other subarrays, but coherent among all the antenna elements of
each individual subarrays. The beneﬁt of this architecture is to have a larger ef-
fective transmit array with augmented diversity gain. On top of that, we achieved
coherent processing gain by designing a weight vector for each subarray to form a
beam toward certain direction in space [5]. This formulation also expands the overall
sidelobe suppression compared to conventional MIMO radar, making it suitable for
coexisting with communication systems.
Further, we hosted a radar-centric spectrum sharing algorithm that projects the
radar signal onto the null space of the communications system’s interference channel,
which reliefs to evade interference from radar. Note that such conventional null space
projection is only possible when the physical/virtual number of transmit antennas

4.10 MATLAB Code
93
0
5
10
15
20
0
20
40
60
80
100
120
K
Mε
MT = 10
MT = 15
MT = 20
Fig. 4.5 The number of subarrays, K, in a Overlapped-MIMO radar is varied from 1 to MT and
the resulting effective virtual transmitter array number, Mϵ is observed for three different transmit
antenna sizes, i.e., MT = 10, MT = 15 and MT = 20. This graph enables picking a value for K
(the number of subarrays in the overlapped-MIMO structure) that maximizes the virtual antenna
array size, thus enhancing the amount of sidelobe suppression in radar beampattern, while retaining
the dimension needed for NSP
of the radar is greater than the number of receive antennas of the communications
system.
Analytical models for the waveform of the Overlapped-MIMO radar and the NSP
algorithm are derived in this chapter. Simulations of the coexistence scenario are pre-
sented too. Through analytical derivation and as well, simulation results, we showed
that the proposed overlapped-MIMO and NSP algorithms outperform conventional
schemes and enable radar-communications system coexistence in the same band. We
found that the Overlapped-MIMO architecture achieves more than 20dB sidelobe
suppression above conventional MIMO radar when there are 20 physical antenna
elements in the radar system. We also observed that, in a similar setup, even though
NSP degrades suppression, it still retains more than 10dB additional sidelobe sup-
pression compared to conventional MIMO radar while reducing interference to the
communication systems.

94
4 Overlapped-MIMO Radar and MIMO Cellular System
4.10
MATLAB Code
In this section, we provide MATLAB code to generate Overlapped-MIMO radar
waveforms subject to spectrum sharing constraints.
4.10.1
Overlapped-MIMO Main Module
This MATLAB script is the main module for Overlapped-MIMO.
1
%
Total
number
of
transmitting
antennas
2
M
=
20;
3
%
Total
number
of
receiving
antennas
4
M_r
=
20;
5
%
transmitter
spacings
in
wavelength
6
d_t
=
0.5;
7
%
Direction
of
target
8
theta _ tar
=
15* pi /180;
9
%
Uplink
steering
vector
10
a_ tar
=
exp(-j*d_t*2* pi *(0:M -1) '* sin( theta _tar ));
11
%
Downlink
steering
vector
12
b_ tar
=
exp(-j*pi *(0: M_r -1) '* sin( theta _tar ));
13
%
K
is
the
number
of
subarrays
in
the
MIMO
14
no_ subarrays
=
[1
5
10
20];
15
%
Overall
beampattern
16
Rx_ pattern _ conv
=
[];
17
%
Overall
beampattern
w/
projection
18
Rx_ pattern _ conv _ proj
=
[];
19
for
ksub
=
1: length (no_ subarrays );
20
%
Number
of
antennas
in
each
subarray
21
K_ sub
=
no_ subarrays ( ksub );
22
M_ sub
=
M
-
K_sub
+
1
;
23
W_u_ conv
=
uplinkbeamform (a_tar ,
K_sub ,
M_ sub);
24
%
Computing
Transmit
and
diversity
beampatterns
25
Theta _ grid
=
[ linspace (-pi /2, pi /2 ,1801) ];
26
%
Compute
virtual
steering
vectors
of
target
27
[v_ tar]
=
virtual _sv( theta _tar ,
M,
d_t,
...
28
M_r,
M_sub ,
K_sub ,
W_u_ conv );
29
[v_ tar_ proj ]
=
virtual _sv_ proj ( theta _tar ,
M,
...
30
d_t,
M_r,
M_sub ,
K_sub ,
W_u_ conv );
31
%
conventional
downlink
beamformer
32
w_d_ conv
=
v_tar /( norm (v_ tar));
33
%
conventional
downlink
beamformer
34
w_d_ conv _ proj
=
v_tar _ proj /( norm (v_tar _ proj ));
35
%
Compute
and
plot
overall
Tx/Rx
beampattern
36
%
Use
this
to
plot
overall
beampattern
37
w_d
=
w_d_ conv ;
38
%
Use
this
to
plot
overall
beampattern
39
w_d_ proj
=
w_d_ conv _ proj ;
40
size _w_d
=
size (w_d)
41
[V_ grid ]
=
virtual _sv( Theta _grid ,
M,
d_t,
...
42
M_r,
M_sub ,
K_sub ,
W_u_ conv );

4.10 MATLAB Code
95
43
[V_ grid _ proj ]
=
virtual _sv_ proj ( Theta _grid ,
...
44
M,
d_t,
M_r,
M_sub ,
K_sub ,
W_u_ conv );
45
Rx_ pattern
=
[10* log 10( abs(w_d '*V_ grid ) .^2) ];
46
Rx_ pattern _ proj
=
[10* log 10( abs(w_d '*V_ grid _ proj ) .^2) ];
47
Rx_ pattern
=
Rx_ pattern
-
max (Rx_ pattern );
48
Rx_ pattern _ conv
=
[Rx_ pattern _ conv ;
Rx_ pattern ];
49
Rx_ pattern _ proj
=
Rx_ pattern _ proj
-
max(Rx_ pattern _ proj );
50
Rx_ pattern _ conv _ proj
=
[Rx_ pattern _ conv _ proj ;
51
Rx_ pattern _ proj ];
52
end
53
54
%
---
Plots
---
%
55
Theta
=
Theta _ grid ;
56
plot ( Theta *180/ pi ,1.02* Rx_ pattern _ conv (1 ,:) ,'g',
57
Theta *180/ pi ,
1.0* Rx_ pattern _ conv (2 ,:) ,'r',
58
Theta *180/ pi ,Rx_ pattern _ conv (3 ,:) ,'b', Theta *180/ pi ,
59
Rx_ pattern _ conv (4 ,:) ,'k--',' linewidth ' ,2)
60
grid
61
axis ([ -90
90
-120
30])
62
xlabel (' Angle
( deg) ')
63
ylabel (' Overall
Gain
(dB) ')
64
legend (' Overlapped - MIMO
Radar
(K =1) ',
65
'Overlapped - MIMO
Radar
(K =5) ',
66
'Overlapped - MIMO
Radar
(K =10) ','MIMO
Radar
(K =20) ')
67
figure ;
68
Theta
=
Theta _ grid ;
69
plot ( Theta *180/ pi ,1.02* Rx_ pattern _ conv _ proj (1 ,:) ,'g',
70
Theta *180/ pi ,
1.0* Rx_ pattern _ conv _ proj (2 ,:) ,'r',
71
Theta *180 pi ,
Rx_ pattern _ conv _ proj (3 ,:) ,'b', Theta *180 pi ,
72
Rx_ pattern _ conv _ proj (4 ,:) ,'k--',' linewidth ' ,2) ,grid
73
axis ([ -90
90
-120
30])
74
xlabel (' Angle
( deg) ')
75
ylabel (' Overall
Gain
(dB) ')
76
legend (' Overlapped - MIMO
Radar
w/
NSP
(K=1) ',
...
77
'Overlapped - MIMO
Radar
w/
NSP
(K =5) ',' Overlapped - MIMO
Radar
...
78
w/
NSP
(K =10) ','MIMO
Radar
w/
NSP
(K =20) ')
4.10.2
Uplink Beamforming Matrix
This MATLAB function computes the uplink beamforming matrix. The kth column
represents the beamforming weight vector of the kth subarray.
1
% ----------------------------------------------------------
2
%
This
function
computes
the
the
uplink
beamforming
matrix .
3
%
The
kth
column
respresents
the
beamforming
weight
vector
4
%
of
the
kth
subarray
5
% ----------------------------------------------------------
6
function
[W_u]
=
uplinkbeamform (a_tar ,
K_sub ,
M_ sub);
7
%
Uplind
weight
vector
( equal
for
all
subarrays )
8
w_u
=
a_ tar (1:M_ sub);

96
4 Overlapped-MIMO Radar and MIMO Cellular System
9
size _w_u
=
size (w_u)
10
%
Uplind
weight
vector
normalized
11
w_u
=
w_u/( norm (w_u));
12
%
Weights
that
are
equal
for
all
subarrays
13
W_u
=
kron ( ones (1,
K_sub ),
w_u);
4.10.3
Virtual Steering Vector
This MATLAB function computes the virtual steering vectors with projection.
1
% ----------------------------------------------------
2
%
This
function
computes
the
virtual
steering
vectors
3
%
with
projection
4
% ----------------------------------------------------
5
function
[v_sv]
=
virtual _sv_ proj (Theta ,
Mt ,
d_t,
Mr ,
M_sub ,
...
6
no_ subarrays ,
W_u);
7
%
No
of
receive
Antennas
8
N_R
=
15;
9
10
% ---TX
and
RX
Array
---%
11
Tx_sv
=
exp(-j*d_t*2* pi
*
(0: Mt -1) '* sin( Theta ));
12
%
Receiving
steering
vectors
13
Rx_sv
=
exp(-j*pi
*
(0:Mr -1) '*sin ( Theta ));
14
15
% ---
VIRTUAL
ARRAY
W/O
A_R
---%
16
P
=
[];
17
H
=
randn (N_R,
no_ subarrays
*
M_ sub)
+
j
*
randn (N_R,
...
18
no_ subarrays
*
M_sub );
19
P
=
null (H)
*
ctranspose ( null (H));
20
v_sv2
=
[];
21
for
kk
=
1: no_ subarrays
22
for
mm
=
1:M_sub
23
v_ temp 2
=
[];
24
w_u
=
W_u(mm ,kk);
25
for
jj
=
1: length ( Theta )
26
v_ temp 2
=
[v_ temp 2,
(w_u'
*
Tx_sv(kk
+
mm
-1,
jj)
)];
27
end
28
v_sv2
=
[v_sv 2;
v_ temp 2];
29
end
30
end
31
v_sv 2_P
=
P
*
v_sv 2;
32
33
v_sv3
=
[];
34
for
vv
=
1: no_ subarrays
*
M_ sub
35
v_ temp 3
=
[];
36
for
jj
=
1: length ( Theta )
37
v_ temp 3
=
[v_ temp 3,
(v_sv 2_P(vv ,
jj))
*
Rx_sv (:,
jj)];
38
end
39
v_sv3
=
[v_sv 3;
v_ temp 3];

4.10 MATLAB Code
97
40
end
41
42
v_sv
=
v_sv 3;
4.10.4
Number of Subarray
This MATLAB script enable us to determine the number of subarray.
1
%
Determine
the
number
of
subarray
2
3
K1
=
1:1:10;
4
K2
=
1:1:15;
5
K3
=
1:1:20;
6
M1
=
10;
7
M2
=
15;
8
M3
=
20;
9
10
for
ii
=
1:1:10
11
ME 1( ii)
=
(M1-ii +1)*ii;
12
end
13
14
for
jj
=
1:1:15
15
ME 2( jj)
=
(M2-jj +1)*jj;
16
end
17
18
for
kk
=
1:1:20
19
ME 3( kk)
=
(M3-kk +1)*kk;
20
end
21
22
figure ;
23
plot (K1,ME1,'g-d',' linewidth ' ,2) ,
grid
24
hold
on
25
plot (K2,ME2,'b-s',' linewidth ' ,2)
26
plot (K3,ME3,'r-o',' linewidth ' ,2)
27
xlabel ('K ')
28
ylabel ('M_{\ epsilon }')
29
legend ('M_T
=
10','M_T
=
15',
'M_T
=
20 ')
30
axis ([0
21
0
120])
References
1. S. Sodagari, A. Khawar, T.C. Clancy, R. McGwier, A projection based approach for radar and
telecommunication systems coexistence, in Global Communication Conference on (GLOBE-
COM), IEEE (2012)
2. A. Khawar, A. Abdel-Hadi, T. Clancy, R. McGwier, Beampattern analysis for MIMO radar
and telecommunication system coexistence, in International Conference on Computing, Net-
working and Communications (ICNC) (2014), pp. 534–539

98
4 Overlapped-MIMO Radar and MIMO Cellular System
3. A. Khawar, A. Abdel-Hadi, C. Clancy, Spectrum sharing between S-band radar and LTE cellular
system: a spatial approach,” in IEEE DySPAN (2014)
4. J. Li, P. Stoica, MIMO Radar Signal Processing (Wiley, New York, 2009)
5. A. Hassanien, S. Vorobyov, Phased-MIMO radar: a tradeoff between phased-array and MIMO
radars. IEEE Trans. Signal Process. 58, 3137–3151 (2010). June
6. H. Yi, Nullspace-based secondary joint transceiver scheme for cognitive radio MIMO networks
using second-order statistics, in IEEE International Conference on Communications (ICC)
(2010), pp. 1–5
7. Y. Noam, A. Goldsmith, Blind null-space learning for spatial coexistence in MIMO cognitive
radios, in IEEE International Conference on Communications (ICC) (2012), pp. 1726–1731
8. A. Khawar, A. Abdel-Hadi, T.C. Clancy, A mathematical analysis of LTE interference on the
performance of S-band military radar systems, in 13th Annual Wireless Telecommunications
Symposium (WTS) (DC, USA, Washington, 2014)
9. J. Li, P. Stoica, Mimo radar with colocated antennas. IEEE Signal Processing Magazine 24,
106–114 (2007). Sept
10. C.-Y. Chen, P. Vaidyanathan, MIMO radar space-time adaptive processing using prolate spher-
oidal wave functions. IEEE Trans. Signal Process. 56(2), 623–635 (2008)
11. Q. He, R. Blum, H. Godrich, A. Haimovich, Target velocity estimation and antenna placement
for MIMO radar with widely separated antennas. IEEE J. Sel. Topics Signal Process. 4, 79–100
(2010). Feb
12. Q. He, R. Blum, H. Godrich, A. Haimovich, Target velocity estimation and antenna placement
for MIMO radar with widely separated antennas. IEEE J. Sel. Topics Signal Process. 4(1),
79–100 (2010)
13. A. Khawar, Spectrum Sharing between Radar and Communication Systems. Ph.D thesis, Vir-
ginia Tech (2015)

Index
Note: Page numbers followed by f indicate ﬁgures respectively.
A
Assumptions
key assumptions, 77–78
and limiting factors of NSP, 89–90
modelling assumptions, 9
statistical assumptions, 10
B
Beampattern, 14
improvement, 84–85
of MIMO radar, 18, 19f
Bit error rate (BER), 47, 61
performance during cooperation mode,
60f
C
Channel state information (CSI), 15, 54,
58–59, 77, 87, 90
Chi-squared distribution function, 29
Coherent processing gain, 92
Collocated MIMO radar, 44–46, 78–81
Commercial MIMO cellular network, 3, 7,
39
Composite channel matrix, 49
Coordinated Multi-Point (CoMP) system,
3, 39, 40, 41
for cooperation, 52–53
coordinated scheduling and/or
beamforming (CoMP-CS), 41
feasibility of null-space projection
precoding, 51–52
for interference mitigation, 50–51
joint processing/reception (CoMP-JP),
41
Correlation matrix, 23, 56
Cramer Rao bound (CRB) estimate, 13, 17,
45
D
Dirac delta function, 8
Diversity gain, 92
Dynamic clustering, 43
E
Effective transmit array, 90, 62
F
Federal Communications Commission
(FCC), 1
Federal-commercial spectrum sharing, 2
G
Gaussian distribution, 10, 49
Gaussian processes, 26
Generalized likelihood ratio test (GLRT), 7,
20, 25, 28
Geolocation databases, 1
© The Author(s) 2018
A. Khawar et al., Spectrum Sharing Between Radars and Communication Systems,
SpringerBriefs in Electrical and Computer Engineering,
DOI 10.1007/978-3-319-56684-9
99

100
Index
H
Hadamard (elementwise) product, 79
Hermitian transpose, 41, 79
I
Independent, identically distributed (i.i.d.),
11, 26, 49, 77
Interference-channel-selection algorithm, 7,
14–15
Interference channel state information
(ICSI), 11, 12, 24
Interference mitigation
CoMP signal design for, 50–51
radar precoder design for, 47–49
Interference protection, 2, 3f
J
Jamming/interference signal, 80
K
Karhunen–Loève expansion, 26
Krönecker delta function, 26
Kronker product operator, 80
L
Linear precoding (LP) techniques, 50
Log-likelihood function, 26
M
MATLAB code, 62, 94
cooperation mode, 71–72
functions of both modes, 72–73
interference mitigation mode, 62–70
number of subarrays, 97
Overlapped-MIMO main module,
94–95
for target detection, 35–37
uplink beamforming matrix, 95–96
virtual steering vector, 96–97
Maximum likelihood (ML) estimate, 13, 45
on target direction estimation, 18, 19f
Military radars sharing spectrum with
commercial communication systems
(Mil2Com sharing), 11, 12, 21
Military radars sharing spectrum with
military communication systems
(Mil2Mil sharing), 11, 12, 21
Minimum mean square error (MMSE)
criteria, 40, 50, 61
precoders, 50, 61
Modiﬁed-null-space projection algorithm,
15–16
Monte Carlo simulation, 30
Multiple-input multiple-output (MIMO)
ship-borne defense radar system, 3,
7, 39
precoder design (see Precoder design)
spectral coexistence of littoral MIMO
radar, 42f
N
National Telecommunications and Infor-
mation Administration (NTIA), 2,
53
Nonzero precoder, 48
Nonzero singular values, 40, 48
Null space projection (NSP) technique, 7,
76, 87
assumptions and limiting factors of,
89–90
waveforms, 7, 20
Nullity, 48
Null-space computation, 17
O
Optimal Cluster Selection algorithm, 54, 55
Orthogonal projection matrix, 22, 89
Orthogonal waveform, 10, 81
PD for, 29
Overlapped multiple-input multiple-output
(Overlapped-MIMO) radar system,
4, 81–83
block diagram of, 82f
number of subarrays, 93f
optimum subarray size for, 86
performance metrics for, 84–86
radar architecture, 21
waveform design, 75
P
Phased-MIMO radar, 75
Precoder design
for cooperation/cognition, 40
for interference mitigation, 39–40
Precoder performance analysis, 40
President’s Council of Advisers on Science
and Technology (PCAST), 2
Probability of detection (PD), 31f
for NSP waveforms, 29–30
for orthogonal waveforms, 29

Index
101
signal-to-noise ratio, 32, 34
Projection matrix, 87–89
Pulse repetition interval (PRI), 39, 40
of radar and modes of operation, 53
R
Radar antenna array, 44, 45f
Radar-cellular system spectrum sharing, 12
architecture, 12–13
spectrum sharing scenario, 12f
Radar-centric projection algorithm, 4, 75
Radar-centric spectrum sharing algorithm,
87, 92
null space projection, 87
projection matrix, 87–89
Radar/CoMP system spectral-coexistence
models, 41
clustering algorithms, 43
collocated MIMO radar, 44–46. (See
also Collocated MIMO radar)
CoMP system, 41–43
spectral-coexistence scenario, 46–47
Radar cross-section (RCS), 8
Radar precoder design
impact of ship’s motion on, 53
for interference mitigation, 47–49
radar precoder design for cooperation,
50–52
theoretical performance analysis of,
55–58
Radar target estimation capability, 59f, 60
Radio environment maps (REM), 1
Radio frequency (RF) spectrum, 2
Random matrix theory, 49
Rayleigh distribution, 11
Rayleigh fading. See Zero-mean and
unit-variance
Rayleigh interference channels, 34
Root-mean-square-error (RMSE) of
different radar waveforms, 18, 19f
S
Signal-to-noise ratio (SNR), 32, 34, 35, 58
gain, 32, 33, 75, 76
gain improvement, 85–86
Simulation results, Overlapped MIMO
radar, 90–92
overall beampattern, 90, 91f, 92f
Simulation results, performance analysis,
58
of information exchange precoder, 61
of interference mitigating precoder,
58–60
Singular value decomposition (SVD), 15,
16, 17, 21, 47, 87
Singular value threshold, 49
Small Singular Value Space Projection
(SSVSP), 48
Spectral coexistence, signal design for,
46–47
CoMP signal design (see CoMP signal
design)
modes of operation and PRI of radar, 53
radar precoder design (see Radar
precoder design)
Spectrum sensing, 1
Spectrum sharing, 1
cooperative sensing based, 3
Spectrum sharing algorithms, 53–54
Optimal Cluster Selection algorithm,
54, 55
SSVSP algorithm, 54–55
Spectrum sharing algorithms, for large
MIMO radar, 20–21
numerical results, 30–35
projection matrix, 21–24
spectrum sharing and projection
algorithms, 24–25
statistical decision test for target
detection, 25–30
Spectrum sharing algorithms, for small
MIMO radar, 13
interference-channel-selection
algorithm, 14–15
modiﬁed-null-space projection
algorithm, 15–18
performance metrics, 13–14
simulation results, 18–20
Spectrum sharing scenario, 7, 12f, 20, 41,
59f, 61, 78, 78f, 89
Static clustering, 43
Switched Null-Space Projection (SNSP),
39, 48, 58, 60, 61
Switched Small Singular Value Space
Projection (SSSVSP), 40, 49, 54–55,
61
System model, 8
communication system model, 10
cooperative RF environment, 11–12
interference channel, 11
modeling assumptions, 9
orthogonal waveforms, 10
radar model, 8
signal model, 9

102
Index
statistical assumptions, 10
target model/channel, 8
System model for coexistence, 76
coexistence channel model, 77
communications system model, 77
radar model, 76
T
Target detection, 25–29
MATLAB code, 35–37
PD for NSP waveforms, 29–30
PD for orthogonal waveforms, 29
Transmit–receive steering matrix, 44
U
Uniform linear array (ULA), 76, 79
Unitary matrix, 47
W
Waveform diversity, 81
Wireless local area network (WLAN), 2
Z
Zero forcing (ZF)
criteria, 40, 61
precoders, 50
Zero-interference, 7, 15, 34
Zero-mean and unit-variance, 11, 77
Zero singular values, 48, 55

