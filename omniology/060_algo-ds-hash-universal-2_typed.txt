Data	 Â Structures	 Â 
Universal	 Â Hash	 Â 
Func3ons:	 Â Deï¬ni3on	 Â 
and	 Â Example	 Â 
Design	 Â and	 Â Analysis	 Â 
of	 Â Algorithms	 Â I	 Â 

Tim	 Â Roughgarden	 Â 
Overview	 Â of	 Â Universal	 Â Hashing	 Â 
Next	 Â :	 Â details	 Â on	 Â randomized	 Â solu3on	 Â (in	 Â 3	 Â parts).	 Â 
	 Â 
Part	 Â 1	 Â :	 Â proposed	 Â deï¬ni3on	 Â of	 Â a	 Â â€œgood	 Â random	 Â hash	 Â func3onâ€.	 Â 
	 Â (â€œuniversal	 Â family	 Â of	 Â hash	 Â func3onsâ€)	 Â 
	 Â 
Part	 Â 3	 Â :	 Â concrete	 Â example	 Â of	 Â simple	 Â +	 Â prac3cal	 Â such	 Â func3ons	 Â 
	 Â 
Part	 Â 4	 Â :	 Â jus3ï¬ca3ons	 Â of	 Â deï¬ni3on	 Â :	 Â â€œgood	 Â func3onsâ€	 Â lead	 Â to	 Â â€œgood
	 Â performanceâ€	 Â 

Tim	 Â Roughgarden	 Â 
Universal	 Â Hash	 Â Func3ons	 Â 
Deï¬ni3on	 Â :	 Â Let	 Â H	 Â be	 Â a	 Â set	 Â of	 Â hash	 Â func3ons	 Â from	 Â U	 Â to	 Â {0,1,2,â€¦,n-Â­â€1}	 Â 
	 Â 
H	 Â is	 Â universal	 Â if	 Â and	 Â only	 Â if	 Â :	 Â 
	 Â for	 Â all	 Â x,y	 Â in	 Â U	 Â (with	 Â  	 Â 	 Â 	 Â 	 Â 	 Â 	 Â 	 Â 	 Â 	 Â 	 Â )	 Â 
ie.,	 Â h(x)	 Â =	 Â h(y)	 Â 
(n	 Â =	 Â #	 Â of	 Â 
buckets	 Â )	 Â 
When	 Â h	 Â is	 Â chosen	 Â uniformly	 Â at	 Â random	 Â from	 Â H.	 Â 
(i.e.,	 Â collision	 Â probability	 Â as	 Â small	 Â as	 Â with	 Â â€œgold	 Â standardâ€	 Â of	 Â 
perfectly	 Â random	 Â hashing	 Â 

Consider	 Â a	 Â hash	 Â func3on	 Â family	 Â H,	 Â where	 Â each	 Â hash	 Â func3on	 Â of	 Â H	 Â 
maps	 Â elements	 Â from	 Â a	 Â universe	 Â U	 Â to	 Â one	 Â of	 Â n	 Â buckets.	 Â Suppose	 Â H	 Â 
has	 Â the	 Â following	 Â property:	 Â for	 Â 	 Â every	 Â bucket	 Â I	 Â and	 Â key	 Â k,	 Â a	 Â 1/n	 Â 
frac3on	 Â of	 Â the	 Â hash	 Â func3ons	 Â in	 Â H	 Â map	 Â k	 Â to	 Â i.	 Â Is	 Â H	 Â universal	 Â ?	 Â 
Yes,	 Â always.	 Â 
No,	 Â never.	 Â 
Maybe	 Â yes,	 Â maybe	 Â no	 Â (depends	 Â on	 Â the	 Â ğ»).	 Â 
Only	 Â if	 Â the	 Â hash	 Â table	 Â is	 Â implemented	 Â using	 Â chaining.	 Â 
Yes	 Â :	 Â Take	 Â H	 Â =	 Â all	 Â func3ons	 Â from	 Â U	 Â to	 Â 
{0,1,2,..,n-Â­â€1}	 Â 
	 Â 
	 Â No	 Â :	 Â Take	 Â H	 Â =	 Â the	 Â set	 Â of	 Â n	 Â diï¬€erent	 Â 	 Â 
	 Â 	 Â 	 Â 	 Â 	 Â 	 Â 	 Â 	 Â 	 Â 	 Â constant	 Â func3ons	 Â 

Tim	 Â Roughgarden	 Â 
Example:	 Â Hashing	 Â IP	 Â Addresses	 Â 
Let	 Â U	 Â =	 Â IP	 Â addresses	 Â (	 Â of	 Â the	 Â form	 Â (x1,x2,x3,x4),	 Â 	 Â 
with	 Â each	 Â 	 Â 
Let	 Â n	 Â =	 Â a	 Â prime	 Â (e.g.,	 Â small	 Â mul3ple	 Â of	 Â #	 Â of	 Â objects	 Â in	 Â HT)	 Â 
Construc3on	 Â :	 Â Deï¬ne	 Â one	 Â hash	 Â func3on	 Â ha	 Â per	 Â 4-Â­â€tuple	 Â a	 Â 
=	 Â (a1,a2,a3,a4)	 Â with	 Â each	 Â 	 Â 
Deï¬ne	 Â :	 Â ha	 Â :	 Â IP	 Â addrs	 Â -Â­â€>	 Â buckets	 Â by	 Â 
n4	 Â such	 Â func3ons	 Â 

Tim	 Â Roughgarden	 Â 
A	 Â Universal	 Â Hash	 Â Func3on	 Â 
Deï¬ne	 Â :	 Â 
	 Â 
	 Â 
	 Â 
Theorem:	 Â This	 Â family	 Â is	 Â universal	 Â 

Tim	 Â Roughgarden	 Â 
Consider	 Â dis3nct	 Â IP	 Â addresses	 Â (x1,x2,x3,x4),	 Â (y1,y2,y3,y4).	 Â 
Assume	 Â :	 Â x4	 Â â‰ 	 Â y4
	 Â 	 Â 	 Â 	 Â 	 Â Ques3on	 Â :	 Â collision	 Â probability	 Â ?	 Â 
	 Â 
Note	 Â :	 Â collision	 Â <==>	 Â 
	 Â 
	 Â 
	 Â 
Next	 Â :	 Â condi3on	 Â on	 Â random	 Â choice	 Â of	 Â a1,a2,a3.	 Â (a4	 Â s3ll	 Â random	 Â )	 Â 
Proof	 Â (Part	 Â I)	 Â 

Tim	 Â Roughgarden	 Â 
The	 Â Story	 Â So	 Â Far	 Â :	 Â with	 Â a1,a2,a3	 Â ï¬xed	 Â arbitrarily,	 Â how	 Â many	 Â choices	 Â of	 Â 
a4	 Â 	 Â sa3sfy	 Â 	 Â 
	 Â 
	 Â 
	 Â 
Key	 Â Claim	 Â :	 Â le_-Â­â€hand	 Â side	 Â equally	 Â likely	 Â to	 Â be	 Â 
any	 Â of	 Â {0,1,2,â€¦,n-Â­â€1}	 Â 
	 Â 
Reason	 Â :	 Â x4	 Â â‰ 	 Â y4	 Â 	 Â 	 Â 	 Â (x4-Â­â€y4	 Â â‰ 	 Â 0	 Â 	 Â mod	 Â n)	 Â 
n	 Â is	 Â prime,	 Â 	 Â a4	 Â uniform	 Â at	 Â random	 Â 
â€œProofâ€	 Â by	 Â example	 Â :	 Â n	 Â =	 Â 7,	 Â x4-Â­â€y4	 Â =	 Â 2	 Â or	 Â 3	 Â mod	 Â n	 Â 
Proof	 Â (Part	 Â II)	 Â 
Some	 Â ï¬xed	 Â 
number	 Â in	 Â 
{0,1,2,..,n-Â­â€1}	 Â 
Implies	 Â Prob[ha(x)	 Â =	 Â ha(y)]	 Â =	 Â 1/n	 Â 
[addendum	 Â :	 Â make	 Â sure	 Â n	 Â bigger	 Â than	 Â 
the	 Â maximum	 Â value	 Â of	 Â an	 Â ai]	 Â 
<==>	 Â x,y	 Â collide	 Â under	 Â ha	 Â 
S3ll	 Â random	 Â 

