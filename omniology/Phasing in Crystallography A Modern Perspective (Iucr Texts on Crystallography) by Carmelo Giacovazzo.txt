
INTERNATIONAL UNION OF CRYSTALLOGRAPHY
BOOK SERIES
IUCr BOOK SERIES COMMITTEE
J. Bernstein, Israel
P. Colman, Australia
J. R. Helliwell, UK
K. A. Kantardjieff, USA
T. Mak, China
P. Müller, USA
Y. Ohashi, Japan
P. Pauﬂer, Germany
H. Schenk, The Netherlands
D. Viterbo (Chairman), Italy
IUCr Monographs on Crystallography
1
Accurate molecular structures
A. Domenicano, I. Hargittai, editors
2
P.P. Ewald and his dynamical theory of X-ray diffraction
D.W.J. Cruickshank, H.J. Juretschke, N. Kato, editors
3
Electron diffraction techniques, Vol. 1
J.M. Cowley, editor
4
Electron diffraction techniques, Vol. 2
J.M. Cowley, editor
5
The Rietveld method
R.A. Young, editor
6
Introduction to crystallographic statistics
U. Shmueli, G.H. Weiss
7
Crystallographic instrumentation
L.A. Aslanov, G.V. Fetisov, J.A.K. Howard
8
Direct phasing in crystallography
C. Giacovazzo
9
The weak hydrogen bond
G.R. Desiraju, T. Steiner
10
Defect and microstructure analysis by diffraction
R.L. Snyder, J. Fiala, H.J. Bunge
11
Dynamical theory of X-ray diffraction
A. Authier
12
The chemical bond in inorganic chemistry
I.D. Brown
13
Structure determination from powder diffraction data
W.I.F. David, K. Shankland, L.B. McCusker, Ch. Baerlocher, editors
14
Polymorphism in molecular crystals
J. Bernstein
15
Crystallography of modular materials
G. Ferraris, E. Makovicky, S. Merlino
16
Diffuse X-ray scattering and models of disorder
T.R. Welberry
17
Crystallography of the polymethylene chain: an inquiry into the structure of waxes
D.L. Dorset

18
Crystalline molecular complexes and compounds: structure and principles
F.H. Herbstein
19
Molecular aggregation: structure analysis and molecular simulation of crystals
and liquids
A. Gavezzotti
20
Aperiodic crystals: from modulated phases to quasicrystals
T. Janssen, G. Chapuis, M. de Boissieu
21
Incommensurate crystallography
S. van Smaalen
22
Structural crystallography of inorganic oxysalts
S.V. Krivovichev
23
The nature of the hydrogen bond: outline of a comprehensive hydrogen bond theory
G. Gilli, P. Gilli
24
Macromolecular crystallization and crystal perfection
N.E. Chayen, J.R. Helliwell, E.H. Snell
25
Neutron protein crystallography: hydrogen, protons, and hydration in
bio-macromolecules
N. Niimura, A. Podjarny
IUCr Texts on Crystallography
1
The solid state
A. Guinier, R. Julien
4
X-ray charge densities and chemical bonding
P. Coppens
8
Crystal structure reﬁnement: a crystallographer’s guide to SHELXL
P. Müller, editor
9
Theories and techniques of crystal structure determination
U. Shmueli
10
Advanced structural inorganic chemistry
Wai-Kee Li, Gong-Du Zhou, Thomas Mak
11
Diffuse scattering and defect structure simulations: a cook book using the program
DISCUS
R.B. Neder, T. Proffen
12
The basics of crystallography and diffraction, third edition
C. Hammond
13
Crystal structure analysis: principles and practice, second edition
W. Clegg, editor
14
Crystal structure analysis: a primer, third edition
J.P. Glusker, K.N. Trueblood
15
Fundamentals of crystallography, third edition
C. Giacovazzo, editor
16
Electron crystallography: electron microscopy and electron diffraction
X. Zou, S. Hovmöller, P. Oleynikov
17
Symmetry in crystallography: understanding the International Tables
P.G. Radaelli
18
Symmetry relationships between crystal structures: applications
of crystallographic group theory in crystal chemistry
U. Müller
19
Small angle X-ray and neutron scattering from biomacromolecular solutions
D.I. Svergun, M.H.J. Koch, P.A. Timmins, R.P. May
20
Phasing in crystallography: a modern perspective
C. Giacovazzo

Phasing in
Crystallography
A Modern Perspective
CARMELO GIACOVAZZO
Professor of Crystallography,
University of Bari, Italy
Institute of Crystallography, CNR, Bari, Italy
3

3
Great Clarendon Street, Oxford, OX2 6DP,
United Kingdom
Oxford University Press is a department of the University of Oxford.
It furthers the University’s objective of excellence in research, scholarship,
and education by publishing worldwide. Oxford is a registered trade mark of
Oxford University Press in the UK and in certain other countries
c⃝Carmelo Giacovazzo 2014
The moral rights of the author have been asserted
First Edition published in 2014
Impression: 1
All rights reserved. No part of this publication may be reproduced, stored in
a retrieval system, or transmitted, in any form or by any means, without the
prior permission in writing of Oxford University Press, or as expressly permitted
by law, by licence or under terms agreed with the appropriate reprographics
rights organization. Enquiries concerning reproduction outside the scope of the
above should be sent to the Rights Department, Oxford University Press, at the
address above
You must not circulate this work in any other form
and you must impose this same condition on any acquirer
Published in the United States of America by Oxford University Press
198 Madison Avenue, New York, NY 10016, United States of America
British Library Cataloguing in Publication Data
Data available
Library of Congress Control Number: 2013943731
ISBN 978–0–19–968699–5
Printed in Great Britain by
Clays Ltd, St Ives plc
Links to third party websites are provided by Oxford in good faith and for information
only. Oxford disclaims any responsibility for the materials contained in any third party
website referenced in this work.

Dedication
To my mother,
to my wife Angela,
my sons Giuseppe and Stefania,
to my grandchildren Agostino, Stefano and Andrea Morris

Acknowledgements
I acknowledge the following colleagues and friends for their generous help:
Caterina Chiarella, for general secretarial management of the book and for her
assistance with the drawings;
Angela Altomare, Benedetta Carrozzini, Corrado Cuocci, Giovanni Luca
Cascarano, Annamaria Mazzone, Anna Grazia Moliterni, and Rosanna
Rizzi for their kind support, helpful discussions, and critical reading of the
manuscript. Corrado Cuocci also took care of the cover ﬁgure.
Facilities provided by the Istituto di Cristallograﬁa, CNR, Bari, are gratefully
acknowledged.

Preface
A short analysis of the historical evolution of phasing methods may be a useful
introduction to this book because it will allow us to better understand efforts
and results, the birth and death of scientiﬁc paradigms, and it will also explain
the general organization of this volume. This analysis is very personal, and
arises through the author’s direct interactions with colleagues active in the
ﬁeld; readers interested in such aspects may ﬁnd a more extensive exposition
in Rend. Fis. Acc. Lincei (2013), 24(1), pp. 71–76.
In a historical sense, crystallographic phasing methods may be subdivided
into two main streams: the small and medium-sized molecule stream, and the
macro-molecule stream; these were substantially independent from each other
up until the 1990s. Let us brieﬂy consider their achievements and the results of
their subsequent conﬂuence.
Small and medium-sized molecule stream
The Patterson (1934) function was the ﬁrst general phasing tool, particularly
effective for heavy-atom structures (e.g. this property met the requirements
of the earth sciences, the ﬁrst users of early crystallography). Even though
subsequently computerized, it was soon relegated to a niche by direct methods,
since these were also able to solve light-atom structures (a relevant property
towards the development of organic chemistry).
Direct methods were introduced, in their modern probabilistic guise, by
Hauptman and Karle (1953) and Cochran (1955); corresponding phasing pro-
cedures were automated by Woolfson and co-workers, making the crystal
structure solution of small molecules more straightforward. Efforts were car-
ried out exclusively in reciprocal space (ﬁrst paradigm of direct methods);
the paradigm was systematized by the neighbourhood (Hauptman, 1975) and
representation theories (Giacovazzo, 1977, 1980). Structures up to 150 non-
hydrogen (non-H) atoms in the asymmetric unit were routinely able to be
solved.
The complete success of this stream may be deduced from the huge num-
bers of structures deposited in appropriate data banks. Consequently, western
national research agencies no longer supported any further research in the
small to medium-sized molecule area (the work was done!); research groups
working on methods moved instead to powder crystallography, electron crys-
tallography, or to proteins, all areas of technological interest for which phasing
was still a challenge. Direct space approaches were soon developed, which
enhanced our capacity to solve structures, even from low quality diffraction
data.

viii
Preface
The macromolecule stream
Since the 1950s, efforts were conﬁned to isomorphous replacement (SIR, MIR;
Green et al., 1954), molecular replacement (MR; Rossmann and Blow, 1962),
and anomalous dispersion techniques (SAD-MAD; Okaya and Pepinsky,
1956; Hoppe and Jakubowski, 1975). Ab initio approaches, the main tech-
niques of interest for the small and medium-sized molecule streams, were
neglected as being unrealistic; indeed, they are less demanding in terms of
prior information but are very demanding in terms of data resolution.
The popularity of protein phasing techniques changed dramatically over the
years. At the very beginning, SIR-MIR was the most popular method, but soon
MR started to play a more major role as good structural models became pro-
gressively more readily available. About 75% of structures today are solved
using MR. The simultaneous technological progress in synchrotron radiation
and its wide availability have increased the appeal of SAD-MAD techniques.
The achievements obtained within the macromolecular stream have been
impressive. A huge number of protein structures has been deposited in the
Protein Data Bank, and the solution of protein structures is no longer conﬁned
to just an elite group of scientists, it is performed in many laboratories spread
over four continents, often by young scientists. Crucial to this has been the role
of the CCP4 project, for the coordination of new methods and new computer
programs.
The synergy of the two streams
It is the opinion of the author that synergy between the two streams ori-
ginated due to a common interest in EDM (electron density modiﬁcation)
techniques. This approach, ﬁrst proposed by Hoppe and Gassman (1968) for
small molecules, was later extensively modiﬁed to be useful for both streams.
Conﬂuence of the two streams began in the 1990s (even if contacts were begun
in the 1980s), when EDM techniques were used to improve the efﬁciency of
direct methods. That was the beautiful innovation of shake and bake (Weeks
et al., 1994); both direct and reciprocal space were explored to increase phas-
ing efﬁciency (this was the second paradigm of direct methods). It was soon
possible to solve ab initio structures with up to 2000 non-hydrogen atoms in the
asymmetric unit, provided data at atomic or quasi-atomic resolution are avail-
able. As a consequence, the ab initio approach for proteins started to attract
greater attention. A secondary effect of the EDM procedures was the recent
discovery of new ab initio techniques, such as charge ﬂipping and VLD (vive
la difference), and the newly formulated Patterson techniques.
The real revolution in the macromolecular area occurred when probabilistic
methods, already widely used in small and medium-sized molecules, erupted
into the protein ﬁeld. Joint probability distributions and maximum likelihood
approaches were tailored to deal with large structures, imperfect isomorphism,
and errors in experimental data; and they were applied to SAD-MAD, MR, and
SIR-MIR cases. For example, protein substructures with around 200 atoms in
the asymmetric unit, an impossible challenge for traditional techniques, could
easily be solved by the new approaches.

Preface
ix
High-throughput crystallography is now a reality: protein structures,
50 years ago solvable only over months or years, can now be solved in hours
or days; also due to technological advances in computer sciences.
The above considerations have been the basic reason for reconsidering the
material and the general guidelines given in my textbook Direct Phasing in
Crystallography, originally published in 1998. This was essentially a descrip-
tion of the mathematical bases of direct methods and of their historical
evolution, with some references to applicative aspects and ancillary techniques.
The above described explosion in new phasing techniques and the improved
efﬁciency of the revisited old methods made impellent the need for a new text-
book, mainly addressing the phasing approaches which are alive today, that
is those which are applicable to today’s routine work. On the other hand,
the wide variety of new methods and their intricate relationship with the old
methods requires a new rational classiﬁcation: methods similar regarding the
type of prior information exploited, mathematical technique, or simply their
mission, are didactically correlated, in such a way as to offer an organized
overview of the current and of the old approaches. This is the main aim of
this volume, which should not therefore simply be considered as the second
edition of Direct Phasing in Crystallography, but as a new book with different
guidelines, different treated material, and a different purpose.
Attention will be focused on both the theoretical and the applicative aspects,
in order to provide a friendly companion for our daily work. To emphasize
the new design the title has been changed to Phasing in Crystallography, with
the subtitle, A Modern Perspective. In order to make the volume more useful,
historical developments of phasing approaches that are not in use today, are
simply skipped, and readers interested in these are referred to Direct Phasing
in Crystallography.
This volume also aims at being a tool to inspire new approaches. On the
one hand, we have tried to give, in the main text, descriptions of the various
methods that are as simple as possible, so that undergraduate and graduate
students may understand their general purpose and their applicative aspects.
On the other hand, we did not shrink from providing the interested reader with
mathematical details and/or demonstrations (these are necessary for any book
dealing speciﬁcally with methods). These are conﬁned in suitable appendices
to the various chapters, and aimed at the trained crystallographer. At the end
of the book, we have collected together mathematical appendices of a general
character, appendices denoted by the letter M for mathematics and devoted to
the bases of the methods (e.g. probability theory, basic crystallography, con-
cepts of analysis and linear algebra, speciﬁc mathematical techniques, etc.),
thus offering material of interest for professional crystallographers.
A necessary condition for an understanding of the content of the book is a
knowledge of the fundamentals of crystallography. Thus, in Chapter 1 we have
synthesized the essential elements of the general crystallography and we have
also formulated the basic postulate of structural crystallography; the entire
book is based on its validity.
In Chapter 2, the statistics of structure factors is described simply: it will be
the elementary basis of most of the methods described throughout the volume.

x
Preface
Chapter 3 is a simpliﬁed description of the concepts of structure invariant
and seminvariant, and of the related origin problem.
In Chapter 4, we have synthesized the methods of joint probability dis-
tributions and neighbourhoods–representation theories. The application of
these methods to three-phase and four-phase structure invariants are described
in Chapter 5. The probabilistic estimation of structure seminvariants has
been skipped owing to their marginal role in modern phasing techniques.
In Chapter 6, we discuss direct methods and the most traditional phasing
approaches.
Chapter 7 is dedicated to joint probability distribution functions when a
model is available, with speciﬁc attention to two- and to three-phase invariants.
The most popular Fourier syntheses are described in the same chapter and their
potential discussed in relation with the above probability distributions.
Chapter 8 is dedicated to phase improvement and extension via electron
density modiﬁcation techniques, Chapter 9 to two new phasing approaches,
charge ﬂipping and VLD (vive la difference), and Chapter 10, to Patterson
techniques. Their recent revision has made them one of the most powerful
techniques for ab initio phasing and particularly useful for proteins.
X-rays are not always the most suitable radiation for performing a dif-
fraction experiment. Indeed, neutron diffraction may provide information
complementary to that provided by X-ray data, electron diffraction becom-
ing necessary when only nanocrystals are available. In Chapter 11 phasing
procedures useful for this new scenario are described.
Often single crystals of sufﬁcient size and quality are not available, but
microcrystals can be grown. In this case powder data are collected; diffraction
techniques imply a loss of experimental information, and therefore phasing via
such data requires signiﬁcant modiﬁcations to the standard methods. These are
described in Chapter 12.
Chapters 13 to 15 are dedicated to the most effective and popular methods
used in macromolecular crystallography: the non-ab initio methods, Molecular
Replacement (MR), Isomorphous Replacement (SIR-MIR), and Anomalous
Dispersion (SAD-MAD) techniques.
The reader should not think that the book has been partitioned into two
parts, the ﬁrst devoted to small and medium-sized molecules, the second to
macromolecules. Indeed in the ﬁrst twelve chapters, most of the mathematical
tools necessary to face the challenges of macromolecular crystallography are
described, together with the main algorithms used in this area and the funda-
mentals of the probabilistic approaches employed in macromolecular phasing.
This design allows us to provide, in the last three chapters, simpler descriptions
of MR, SIR-MIR, and SAD-MAD approaches.

Contents
Symbols and notation
xvii
1
Fundamentals of crystallography
1
1.1
Introduction
1
1.2
Crystals and crystallographic symmetry in direct space
1
1.3
The reciprocal space
5
1.4
The structure factor
11
1.5
Symmetry in reciprocal space
12
1.5.1 Friedel law
12
1.5.2 Effects of symmetry operators in reciprocal space
12
1.5.3 Determination of reﬂections with restricted phase values
13
1.5.4 Systematic absences
15
1.6
The basic postulate of structural crystallography
17
1.7
The legacy of crystallography
24
2
Wilson statistics
27
2.1
Introduction
27
2.2
Statistics of the structure factor: general considerations
28
2.3
Structure factor statistics in P1 and P¯1
29
2.4
The P(z) distributions
35
2.5
Cumulative distributions
35
2.6
Space group identiﬁcation
36
2.7
The centric or acentric nature of crystals: Wilson statistical analysis
42
2.8
Absolute scaling of intensities: the Wilson plot
43
2.9
Shape of the Wilson plot
47
2.10 Unit cell content
49
Appendix 2.A Statistical calculations in P1 and P¯1
50
2.A.1 Structure factor statistics in P1
50
2.A.2 Structure factor statistics in P¯1
52
Appendix 2.B Statistical calculations in any space group
53
2.B.1 The algebraic form of the structure factor
53
2.B.2 Structure factor statistics for centric and acentric space groups
55
Appendix 2.C The Debye formula
58
3
The origin problem, invariants, and seminvariants
60
3.1
Introduction
60
3.2
Origin, phases, and symmetry operators
61

xii
Contents
3.3 The concept of structure invariant
63
3.4 Allowed or permissible origins in primitive space groups
65
3.5 The concept of structure seminvariant
69
3.6 Allowed or permissible origins in centred cells
76
3.7 Origin deﬁnition by phase assignment
81
4
The method of joint probability distribution
functions, neighbourhoods, and representations
83
4.1 Introduction
83
4.2 Neighbourhoods and representations
87
4.3 Representations of structure seminvariants
89
4.4 Representation theory for structure invariants extended to
isomorphous data
91
Appendix 4.A The method of structure factor joint probability
distribution functions
93
4.A.1 Introduction
93
4.A.2 Multivariate distributions in centrosymmetric structures:
the case of independent random variables
94
4.A.3 Multivariate distributions in non-centrosymmetric
structures: the case of independent random variables
97
4.A.4 Simpliﬁed joint probability density functions in the
absence of prior information
99
4.A.5 The joint probability density function when some prior
information is available
102
4.A.6 The calculation of P(E) in the absence of prior
information
103
5
The probabilistic estimation of triplet
and quartet invariants
104
5.1 Introduction
104
5.2 Estimation of the triplet structure invariant via its ﬁrst
representation: the P1 and the P¯1 case
104
5.3 About triplet invariant reliability
108
5.4 The estimation of triplet phases via their second representation
110
5.5 Introduction to quartets
112
5.6 The estimation of quartet invariants in P1 and P¯1 via their
ﬁrst representation: Hauptman approach
112
5.7 The estimation of quartet invariants in P1 and P¯1 via their
ﬁrst representation: Giacovazzo approach
115
5.8 About quartet reliability
116
Appendix 5.A The probabilistic estimation of the triplet
invariants in P1
117
Appendix 5.B Symmetry inconsistent triplets
120
Appendix 5.C The P10 formula
121
Appendix 5.D The use of symmetry in quartet estimation
123

Contents
xiii
6
Traditional direct phasing procedures
125
6.1 Introduction
125
6.2 The tangent formula
128
6.3 Procedure for phase determination via traditional direct
methods
130
6.3.1 Set-up of phase relationships
131
6.3.2 Assignment of starting phases
134
6.3.3 Phase determination
136
6.3.4 Finding the correct solution
137
6.3.5 E-map interpretation
138
6.3.6 Phase extension and reﬁnement: reciprocal space techniques
140
6.3.7 The limits of the tangent formula
141
6.4 Third generation direct methods programs
144
6.4.1 The shake and bake approach
144
6.4.2 The half-bake approach
147
6.4.3 The SIR2000-N approach
148
Appendix 6.A Finding quartets
149
7
Joint probability distribution functions when
a model is available: Fourier syntheses
151
7.1 Introduction
151
7.2 Estimation of the two-phase structure invariant (φh −φph)
152
7.3 Electron density maps
155
7.3.1 The ideal Fourier synthesis and its properties
156
7.3.2 The observed Fourier synthesis
162
7.3.3 The difference Fourier synthesis
164
7.3.4 Hybrid Fourier syntheses
166
7.4 Variance and covariance for electron density maps
168
7.5 Triplet phase estimate when a model is available
170
Appendix 7.A Estimation of σA
173
Appendix 7.B Variance and covariance expressions for electron
density maps
174
Appendix 7.C Some marginal and conditional
probabilities of P(R, Rp, φ, φp)
176
8
Phase improvement and extension
177
8.1 Introduction
177
8.2 Phase extension and reﬁnement via direct space procedures:
EDM techniques
177
8.3 Automatic model building
184
8.4 Applications
188
Appendix 8.A Solvent content, envelope deﬁnition, and solvent modelling
190
8.A.1 Solvent content according to Matthews
190
8.A.2 Envelope deﬁnition
191
8.A.3 Models for the bulk solvent
192
Appendix 8.B Histogram matching
193
Appendix 8.C A brief outline of the ARP/wARP procedure
196

xiv
Contents
9
Charge flipping and VLD (vive la difference)
198
9.1 Introduction
198
9.2 The charge ﬂipping algorithm
199
9.3 The VLD phasing method
201
9.3.1 The algorithm
201
9.3.2 VLD and hybrid Fourier syntheses
205
9.3.3 VLD applications to ab initio phasing
205
Appendix 9.A About VLD joint probability distributions
206
9.A.1 The VLD algorithm based on difference Fourier synthesis
206
9.A.2 The VLD algorithm based on hybrid Fourier syntheses
211
Appendix 9.B The RELAX algorithm
212
10 Patterson methods and direct space properties
214
10.1 Introduction
214
10.2 The Patterson function
215
10.2.1 Mathematical background
215
10.2.2 About interatomic vectors
216
10.2.3 About Patterson symmetry
217
10.3 Deconvolution of Patterson functions
218
10.3.1 The traditional heavy-atom method
219
10.3.2 Heavy-atom search by translation functions
220
10.3.3 The method of implication transformations
221
10.3.4 Patterson superposition methods
223
10.3.5 The C-map and superposition methods
225
10.4 Applications of Patterson techniques
227
Appendix 10.A Electron density and phase relationships
230
Appendix 10.B Patterson features and phase relationships
232
11 Phasing via electron and neutron diffraction data
234
11.1 Introduction
234
11.2 Electron scattering
235
11.3 Electron diffraction amplitudes
236
11.4 Non-kinematical character of electron diffraction amplitudes
237
11.5 A traditional experimental procedure for electron
diffraction studies
239
11.6 Electron microscopy, image processing, and phasing methods
241
11.7 New experimental approaches: precession and rotation cameras
244
11.8 Neutron scattering
245
11.9 Violation of the positivity postulate
247
Appendix 11.A About the elastic scattering of electrons: the
kinematical approximation
249
12 Phasing methods for powder data
252
12.1
Introduction
252
12.2
About the diffraction pattern: peak overlapping
253

Contents
xv
12.3
Modelling the diffraction pattern
258
12.4
Recovering |Fhkl|2 from powder patterns
260
12.5
The amount of information in a powder diagram
263
12.6
Indexing of diffraction patterns
264
12.7
Space group identiﬁcation
266
12.8
Ab initio phasing methods
267
12.9
Non-ab initio phasing methods
270
Appendix 12.A Minimizing texture effects
272
13 Molecular replacement
275
13.1 Introduction
275
13.2 About the search model
277
13.3 About the six-dimensional search
279
13.4 The algebraic bases of vector search techniques
280
13.5 Rotation functions
282
13.6 Practical aspects of the rotation function
284
13.7 The translation functions
286
13.8 About stochastic approaches to MR
289
13.9 Combining MR with ‘trivial’ prior information: the
ARCIMBOLDO approach
289
13.10Applications
291
Appendix 13.A Calculation of the rotation function in
orthogonalized crystal axes
294
13.A.1 The orthogonalization matrix
294
13.A.2 Rotation in Cartesian space
295
13.A.3 Conversion to fractional coordinates
297
13.A.4 Symmetry and the rotation function
299
Appendix 13.B Non-crystallographic symmetry
304
13.B.1 NCS symmetry operators
304
13.B.2 Finding NCS operators
305
13.B.3 The translational NCS
308
Appendix 13.C Algebraic forms for the rotation and translation functions
311
14 Isomorphous replacement techniques
314
14.1 Introduction
314
14.2 Protein soaking and co-crystallization
315
14.3 The algebraic bases of SIR techniques
317
14.4 The algebraic bases of MIR techniques
320
14.5 Scaling of experimental data
322
14.6 The probabilistic approach for the SIR case
323
14.7 The probabilistic approach for the MIR case
327
14.8 Applications
329
Appendix 14.A The SIR case for centric reﬂections
330
Appendix 14.B The SIR case: the one-step procedure
331
Appendix 14.C About methods for estimating the scattering
power of the heavy-atom substructure
333

xvi
Contents
15 Anomalous dispersion techniques
335
15.1
Introduction
335
15.2
Violation of the Friedel law as basis of the phasing method
337
15.3
Selection of dispersive atoms and wavelengths
340
15.4
Phasing via SAD techniques: the algebraic approach
344
15.5
The SIRAS algebraic bases
347
15.6
The MAD algebraic bases
352
15.7
The probabilistic approach for the SAD-MAD case
354
15.8
The probabilistic approach for the SIRAS-MIRAS case
360
15.9
Anomalous dispersion and powder crystallography
363
15.10 Applications
364
Appendix 15.A A probabilistic formula for the SAD case
365
Appendix 15.B Structure reﬁnement for MAD data
366
Appendix 15.C About protein phase estimation in the SIRAS case
368
Appendices
370
Appendix M.A Some basic results in probability theory
370
M.A.1
Probability distribution functions
370
M.A.2
Moments of a distribution
371
M.A.3
The characteristic function
371
M.A.4
Cumulants of a distribution
373
M.A.5
The normal or Gaussian distribution
374
M.A.6
The central limit theorem
375
M.A.7
Multivariate distributions
375
M.A.8
Evaluation of the moments in structure factor distributions
377
M.A.9
Joint probability distributions of the signs of the
structure factors
379
M.A.10 Some measures of location and dispersion in the
statistics of directional data
380
Appendix M.B Moments of the P(Z) distributions
382
Appendix M.C The gamma function
382
Appendix M.D The Hermite and Laguerre polynomials
383
Appendix M.E Some results in the theory of Bessel functions
385
M.E.1
Bessel functions
385
M.E.2
Generalized hypergeometric functions
389
Appendix M.F Some deﬁnite integrals and formulas of frequent application 390
References
394
Index
412

Symbols and notation
The following symbols and conventions will be used throughout the full text.
The bold character is used for denoting vectors and matrices.
h·r
the dot indicates the scalar product of the two vectors h and r
a ∧b
cross-product of the two vectors a and b
¯A
the bar indicates the transpose of the matrix A
s.f.
structure factor
n.s.f.
normalized structure factor
s.i.
structure invariant
s.s.
structure seminvariant
cs.
centrosymmetric
n.cs.
non-centrosymmetric
RES
experimental data resolution (in Å)
CORR
correlation between the electron density map of the target
structure (the one we want to solve) and that of a model map
Rcryst =

h ||Fobs|−|Fcalc||

h |Fobs|
crystallographic residual
SIR-MIR
single–multiple isomorphous replacement
SAD-MAD
single–multiple anomalous dispersion
MR
molecular replacement


Fundamentals
of crystallography
1
1.1
Introduction
In this chapter we summarize the basic concepts, formulas and tables which
constitute the essence of general crystallography. In Sections 1.2 to 1.5 we
recall, without examples, deﬁnitions for unit cells, lattices, crystals, space
groups, diffraction conditions, etc. and their main properties: reading these
may constitute a useful reminder and support for daily work. In Section 1.6
we establish and discuss the basic postulate of structural crystallography: this
was never formulated, but during any practical phasing process it is simply
assumed to be true by default. We will also consider the consequences of such
a postulate and the caution necessary in its use.
1.2
Crystals and crystallographic symmetry
in direct space
We recall the main concepts and deﬁnitions concerning crystals and crystallo-
graphic symmetry.
Crystal. This is the periodic repetition of a motif (e.g. a collection of molecules,
see Fig. 1.1). An equivalent mathematical deﬁnition is: the crystal is the con-
volution between a lattice and the unit cell content (for this deﬁnition see
(1.4) below in this section).
Unit cell. This is the parallelepiped containing the motif periodically repeated
in the crystal. It is deﬁned by the unit vectors a, b, c, or, by the six scalar
parameters a, b, c, α, β, γ (see Fig. 1.1). The generic point into the unit cell is
deﬁned by the vector
r = x a + y b + z c,
where x, y, z are fractional coordinates (dimensionless and lying between
0 and 1). The volume of the unit cell is given by (see Fig. 1.2)
V = a ∧b · c = b ∧c · a = c ∧a · b.
(1.1)

2
Fundamentals of crystallography
molecule
unit cell
crystal
B
C
a
b
c
β
α
γ
A
Fig. 1.1
The motif, the unit cell, the crystal.
Dirac delta function. In a three-dimensional space the Dirac delta function
δ(r −r0) is deﬁned by the following properties:
δ = 0
for
(r ̸= r0),
δ = ∞
for
(r = r0),

S
δ(r −r0)dr = 1,
where S is the full r space. The function δ is highly discontinuous and is
qualitatively represented in Fig. 1.3 as a straight line.
Crystal lattice. This describes the repetition geometry of the unit cell (see
Fig. 1.4). An equivalent mathematical deﬁnition is the following: a crystal
lattice is represented by the lattice function L(r), where
L(r) =
+∞
u,v,w=−∞∂(r −ru,v,w);
(1.2)
where ∂(r −ru,v,w) is the Dirac delta function centred on ru,v,w = ua + vb + wc
and u,v,w are integer numbers.
h
c
a Ù b
b
a
γ
Fig. 1.2
The vector a ∧b is perpendicular to the
plane (a, b): its modulus |ab sin γ | is
equal to the shaded area on the base. The
volume of the unit cell is the product of
the base area and h, the projection of
c over the direction perpendicular to the
plane (a, b). Accordingly, V =(a ∧b) · c.
Convolution. The convolution of two functions ρ(r) and g(r) (this will be
denoted as ρ(r) ⊗g(r)) is the integral
C(u) = ρ(r) ⊗g(r) =

S
ρ(r)g(u −r)dr.
(1.3)
The reader will notice that the function g is translated by the vector u and
inverted before being integrated.
x
xo
δ
Fig. 1.3
Schematic representation of the Dirac
function δ(x −xo).
The convolution of the function ρ(r), describing the unit cell content, with
a lattice function centred in r0, is equivalent to shifting ρ(r) by the vector r0.
Indeed
δ(r −r0) ⊗ρ(r) = ρ(r −r0).
Accordingly, the convolution of ρ(r) with the lattice function L(r) describes the
periodic repetition of the unit cell content, and therefore describes the crystal
(see Fig. 1.5):
L(r) ⊗ρ(r) =
+∞
u,v,w=−∞∂(r −ru,v,w) ⊗ρ(r) =
+∞
u,v,w=−∞ρ(r −ru,v,w).
(1.4)

Crystals and crystallographic symmetry in direct space
3
Primitive and centred cells. A cell is primitive if it contains only one lat-
tice point and centered if it contains more lattice points. The cells useful in
crystallography are listed in Table 1.1: for each cell the multiplicity, that is
the number of lattice points belonging to the unit cell, and their positions are
emphasized.
Fig. 1.4
The unit cell (bold lines) and the corres-
ponding lattice.
Symmetry operators. These relate symmetry equivalent positions. Two posi-
tions r and r′ are symmetry equivalent if they are related by the symmetry
operator C = (R, T), where R is the rotational component and T the transla-
tional component. More explicitly,

x′
y′
z′

=

R11
R12
R13
R21
R22
R23
R31
R32
R33


x
y
z

+

T1
T2
T3

,
(1.5)
g(x)
f(x)
f(x,y)
f(x)Äg(x)
x
a
O a
O a
x
a
x
Fig. 1.5
The convolution of the motif f with a
delta function is represented in the ﬁrst
line. In the second line f is still the motif,
g is a one-dimensional lattice, f(x) ⊗g(x)
is a one-dimensional crystal. In the third
line, a two-dimensional motif and lattice
are used.
Table 1.1 The conventional types of unit cell and corresponding lattice multiplicity
Symbol
Type
Positions of additional
lattice points
Number of lattice
points per cell
P
Primitive
—
1
I
body-centred
(1/2, 1/2, 1,2)
2
A
A-face centred
(0, 1/2, 1/2)
2
B
B-face centred
(1/2, 0, 1/2)
2
C
C-face centred
(1/2, 1/2, 0)
2
F
All faces centred
(1/2, 1/2, 0), (1/2, 0, 1/2)
(0, 1/2, 1/2)
4
R
Rhombohedrally centred
(description with
‘hexagonal axes’)
(1/3, 2/3, 2/3),
(2/3, 1/3, 1/3)
3

4
Fundamentals of crystallography
where (x′,y′,z′) and (x,y,z) are the coordinates of r′ and r respectively. In a
vectorial form,
r′ = Rr + T.
If the determinant |R| = 1 the symmetry operator is proper and refers to objects
directly congruent; if |R| = −1 the symmetry operator is improper and refers
to enantiomorph objects. The type of symmetry operator may be identiﬁed
according to Table 1.2:
Table 1.2 Trace and determinant of the rotation matrix for crystallographic symmetry
operators
Element
1
2
3
4
6
¯1
¯2
¯3
¯4
¯6
trace
3
¯1
0
1
2
¯3
1
0
¯1
¯2
determinant
1
1
1
1
1
¯1
¯1
¯1
¯1
¯1
Point group symmetry. This is a compatible combination of symmetry operat-
ors, proper or improper, without translational components, and intersecting at
one point. The number of crystallographic point groups is 32 and their sym-
bols are shown in Table 1.3. Most of the physical properties depend on the
point group symmetry of the crystal (they show a symmetry equal to or larger
than the point group symmetry: Neumann principle).
Crystal systems. Crystals belonging to point groups with common features
can be described by unit cells of the same type. For example, crystals with
only three twofold axes, no matter if proper or improper, can be described
by an orthogonal cell. These crystals then belong to the same crystal system,
the orthorhombic system. The relations between crystal system-point groups
are shown in Table 1.4. For each system the allowed Bravais lattices, the
characterizing symmetry, and the type of unit cell parameters are reported.
Table 1.3 List of the 32 crystal point groups, Laue groups, and lattice point groups
Crystal
systems
Point groups
Laue classes
Lattice point groups
Non-centrosymmetric
Centrosymmetric
Triclinic
1
¯1
¯1
¯1
Monoclinic
2
m
2/m
2/m
2/m
Orthorhombic
222
mm2
mmm
mmm
mmm
Tetragonal

4
422
¯4
4mm, ¯42m
4/m
4/mmm
4/m
4/mmm

4/mmm
Trigonal
 3
32
3m
¯3
¯3m
¯3
¯3m

¯3m
Hexagonal

6
622
¯6
6mm, ¯62m
6/m
6/mmm
6/m
6/mmm

6/mmm
Cubic
 23
432
¯43m
m¯3
m¯3m
m¯3
m¯3m

m¯3m

The reciprocal space
5
Table 1.4 Crystal systems, characterizing symmetry and unit cell parameters
Crystal system
Bravais
type(s)
Characterizing symmetry
Unit cell properties
Triclinic
P
None
a, b, c, α, β, γ
Monoclinic
P, C
Only one 2-fold axis
a, b, c, 90◦, β, 90◦
Orthorhombic
P, I, F
Only three perpendicular 2-fold axes
a, b, c, 90◦, 90◦, 90◦
Tetragonal
P, I
Only one 4-fold axis
a, a, c, 90◦, 90◦, 90◦
Trigonal
P, R
Only one 3-fold axis
a, a, c, 90◦, 90◦, 120◦
Hexagonal
P
Only one 6-fold axis
a, a, c, 90◦, 90◦, 120◦
Cubic
P, F, I
Four 3-fold axes
a, a, a, 90◦, 90◦, 90◦
Space groups. Three-dimensional crystals show a symmetry belonging to one
of the 230 space groups reported in Table 1.5. The space group is a set of
symmetry operators which take a three- dimensional periodic object (say a
crystal) into itself. In other words, the crystal is invariant under the symmetry
operators of the space group.
The space group symmetry deﬁnes the asymmetric unit: this is the smallest
part of the unit cell applying to which the symmetry operators, the full con-
tent of the unit cell, and then the full crystal, are obtained. This last statement
implies that the space group also contains the information on the repetition
geometry (this is the ﬁrst letter in the space group symbol, and describes the
type of unit cell).
1.3
The reciprocal space
We recall the main concepts and deﬁnitions concerning crystal reciprocal
space.
Reciprocal space. In a scattering experiment, the amplitude of the wave (say
F(r∗), in Thomson units) scattered by an object represented by the function
ρ(r), is the Fourier transform of ρ(r):
F(r∗) = T[ρ(r)] =

S
ρ(r) exp(2πir∗· r)dr,
(1.6)
where T is the symbol of the Fourier transform, S is the full space where the
scattering object is immersed, r∗= s −s0 is the difference between the unit
vector s, oriented along the direction in which we observe the radiation, and the
unit vector s0 along which the incident radiation comes (see Fig. 1.6). We recall
that |r∗| = 2 sin θ/λ, where 2θ is the angle between the direction of incident
radiation and the direction along which the scattered radiation is observed, and
λ is the wavelength. We will refer to r∗as to the generic point of the reciprocal
space S∗, the space of the Fourier transform.
F(r∗) is a complex function, say F(r∗) = A(r∗) + iB(r∗). It may be shown
that, for two enantiomorphous objects, the corresponding F(r∗) are the com-
plex conjugates of each other: they therefore have the same modulus |F(r∗)|.
As a consequence, for a centrosymmetrical object, F(r∗) is real.

6
Fundamentals of crystallography
Table 1.5 The 230 three-dimensional space groups arranged by crystal systems and point
groups. Point groups not containing improper symmetry operators are in a square box (the cor-
responding space groups are the only ones in which proteins may crystallize). Space groups
(and enantiomorphous pairs) that are uniquely determinable from the symmetry of the diffraction
pattern and from systematic absences (see Section 1.5) are shown in bold type
Crystal system
Point group
Space groups
Triclinic
1
P1
¯1
P¯1
Monoclinic
2
P2, P21, C2
m
Pm, Pc, Cm, Cc
2/m
P2/m, P21/m, C2/m, P2/c, P21/c, C2/c
Orthorhombic
222
P222, P2221, P21212, P212121, C2221, C222, F222,
I222, I212121
mm2
Pmm2, Pmc21, Pcc2, Pma21, Pca21, Pnc21, Pmn21,
Pba2, Pna21, Pnn2, Cmm2, Cmc21, Ccc2, Amm2,
Abm2, Ama2, Aba2, Fmm2, Fdd2, Imm2, Iba2, Ima2
mmm
Pmmm, Pnnn, Pccm, Pban, Pmma, Pnna, Pmna, Pcca,
Pbam, Pccn, Pbcm, Pnnm, Pmmn, Pbcn, Pbca, Pnma,
Cmcm, Cmca, Cmmm, Cccm, Cmma, Ccca, Fmmm,
Fddd, Immm, Ibam, Ibca, Imma
Tetragonal
4
P4, P41, P42, P43, I4, I41
¯4
P¯4, I¯4
4/m
P4/m, P42/m, P4/n, P42/n, I4/m, I41/a
422
P422, P4212, P4122, P41212, P4222, P42212, P4322,
P43212, I422, I4122
4mm
P4mm, P4bm, P42cm, P42nm, P4cc, P4nc, P42mc,
P42bc, I4mm, I4cm, I41md, I41cd
¯4m
P¯42m, P¯42c, P¯421m, P ¯421c, P¯4m2, P¯4c2, P¯4b2, P¯4n2,
I¯4m2, I¯4c2, I¯42m, I¯42d
4/mmm
P4/mmm, P4/mcc, P4/nbm, P4/nnc, P4/mbm, P4/mnc,
P4/nmm, P4/ncc, P42/mmc, P42/mcm, P42/nbc,
P42/nnm, P42/mbc, P42mnm, P42/nmc, P42/ncm,
I4/mmm, I4/mcm, I41/amd, I41/acd
Trigonal–hexagonal
3
P3, P31, P32, R3
¯3
P¯3, R¯3
32
P312, P321, P3112, P3121, P3212, P3221, R32
3m
P3m1, P31m, P3c1, P31c, R3m, R3c
¯3m
P¯31m, P¯31c, P¯3m1, P¯3c1, R¯3m, R¯3c
6
P6, P61, P65, P63, P62, P64
¯6
P¯6
6/m
P6/m, P63/m
622
P622, P6122, P6522, P6222, P6422, P6322
6mm
P6mm, P6cc, P63cm, P63mc
¯6m
P¯6m2, P¯6c2, P¯62m, P¯62c
6/mmm
P6/mmm, P6/mcc, P63/mcm, P63/mmc
Cubic
23
P23, F23, I23, P213, I213
m¯3
Pm¯3, Pn¯3, Fm¯3, Fd¯3, Im¯3, Pa¯3, Ia¯3
432
P432, P4232, F432, F4132, I432, P4332, P4132, I4132
¯43m
P¯43m, F43m, I¯43m, P43n, F¯43c, I ¯43d
m¯3m
Pm¯3m, Pn¯3n, Pm¯3n, Pn¯3m, Fm¯3m, Fm¯3c, Fd¯3m, Fd¯3c,
Im¯3m, Ia¯3d

The reciprocal space
7
B
r*
C
A
sO/λ
s/λ
2J
O
s
sO
Fig. 1.6
The scatterer is at O, so and s are unit
vectors, the ﬁrst along the incident X-ray
radiation, the second along the direc-
tion in which the scattered intensity is
observed. To calculate |r∗| it is sufﬁcient
to notice that the triangle AOB is iso-
sceles and that point C divides AB into
two equal parts.
ρ(r) may be recovered via the inverse Fourier transform of F(r∗):
ρ(r) = T−1[F(r∗)] =

S∗F(r∗) exp(−2πir∗· r)dr∗.
(1.7)
The reciprocal lattice. It is usual in crystallography to take, as a reference sys-
tem for the reciprocal space, the reciprocal vectors a∗, b∗, c∗, deﬁned below.
Given a direct lattice, with unit vectors a, b, c, its reciprocal lattice is identiﬁed
by the vectors a∗, b∗, c∗satisfying the following two conditions:
1. a∗∧b = a∗∧c = b∗∧a = b∗∧c = c∗∧a = c∗∧b = 0
2. a∗· a = b∗· b = c∗· c = 1
Condition 1 deﬁnes the orientation of the reciprocal basis vectors (e.g. a∗is
perpendicular to b and c, etc.), whereas condition 2 ﬁxes their modulus. From
the above conditions the following relations arise:
(i)
a∗= 1
V b ∧c, b∗= 1
V c ∧a, c∗= 1
V a ∧b, V∗= V−1,
(1.8)
(ii) the scalar product of the two vectors r = xa + yb + zc and r∗= x∗a∗+
y∗b∗+ z∗c∗, one deﬁned in direct and the other in reciprocal space,
reduces to the sum of the products of the corresponding coordinates:
r · r∗= x∗x + y∗y + z∗z = ¯X
∗X =
x∗y∗z∗|

x
y
z

;
(1.9)
(iii) the generic reciprocal lattice point is deﬁned by the vector r∗
hkl = ha∗+
kb∗+ lc∗, with integer values of h, k, l. We will also denote it by r∗
H or r∗
h,
where H or h represent the triple h,k,l.
(iv) r∗
hkl represents the family (in direct space) of lattice planes with Miller
indices (hkl). Indeed r∗
hkl is perpendicular to the planes of the family (hkl)
and its modulus is equal to the spacing of the planes (hkl): i.e.
r∗
hkl⊥(hkl),
and
|r∗
hkl| = 1/dhkl.
(1.10)
(v) the reciprocal lattice may be represented by the reciprocal lattice function
L(r∗) = 1
V
+∞
h,k,l=−∞∂

r∗−r∗
H

;
(1.11)

8
Fundamentals of crystallography
L(r∗) is the Fourier transform of the direct lattice:
L(r∗) = T[L(r)] = T
	+∞
u,v,w=−∞∂(r −ru,v,w)

= 1
V

H ∂(r∗−r∗
H).
(1.12)
Atomic scattering factor f(r∗). This is the amplitude, in Thomson units, of the
wave scattered by the atom and observed at the reciprocal space point r∗. f(r∗)
is the Fourier transform of the atomic electron density ρa:
f (r∗) = T[ρa(r)] =

S
ρa(r) exp(2πir∗· r)dr.
(1.13)
Usually ρa(r) includes thermal displacement: accordingly, under the isotropic
scattering assumption,
f(r∗) = f0(r∗) exp

−Br∗2/4) = f0(r∗) exp(−B sin2 θ/λ2
,
(1.14)
where f0(r∗) is the scattering factor of the atom at rest, and B is the isotropic
temperature factor. At r∗= 0, f(r∗) is maximum (then f(r∗) = Z, where Z
is the atomic number). The decay with r∗is sharper for high B values (see
Fig. 1.7).
Molecular scattering factor FM(r∗). This is the amplitude, in Thomson units,
of the wave scattered by a molecule, observed at the reciprocal space point r∗.
It is the Fourier transform of the electron density of the molecule:
FM(r∗) = T[ρM(r)] =

S
N
j=1 ρaj(r −rj) exp(2πir∗· r)dr
=
N
j=1 fj exp(2πir∗· rj),
(1.15)
where ρM(r) is the electron density of the molecule and N is the corresponding
number of atoms. FM(r∗) is a continuous function of r∗.
Structure factor FM(r∗) of a unit cell. This is the amplitude, in Thomson
units, of the wave scattered by all the molecules contained in the unit cell and
observed at the reciprocal space point r∗. FM(r∗) is the Fourier transform of
the electron density of the unit cell:
FM(r∗) = T[ρM(r)] =

S
N
j=1 ρaj(r −rj) exp

2πir∗· r

dr
=
N
j=1 fj exp

2πir∗· rj

.
(1.16)
16
fs
14
12
10
8
6
4
2
0
0
0.1
0.2
0.3
0.4
0.5
0.6
B = 0
B = 2
B = 5
sin θ/λ
Fig. 1.7
Scattering factor of sulphur for different
values of the temperature factor.

The reciprocal space
9
ρM(r) is now the electron density in the unit cell, N is the corresponding
number of atoms, and FM(r∗) is a continuous function of r∗. The reader will
certainly have noted that we have used for the unit cell the same notation
employed for describing the scattering from a molecule: indeed, from a phys-
ical point of view, the unit cell content may be considered to be a collection of
molecules.
Structure factor F(r∗) for a crystal. This is the amplitude, in Thomson units, of
the wave scattered by the crystal as observed at the reciprocal space point r∗.
It is the Fourier transform of the electron density of the crystal. In accordance
with equation 1.4
F(r∗) = T[ρcr(r)] = T[ρM(r) ⊗L(r)]
and, owing to the convolution theorem,
F(r∗) = T[ρM(r)] · T[L(r)] = FM(r∗) · 1
V

H ∂(r∗−r∗
H).
(1.17)
F(r∗) is now a highly discontinuous function which is different from zero only
at the reciprocal lattice points deﬁned by the vectors r∗
H. From now on, FM(r∗
H)
will be written as FH and will simply be called the structure factor. The study
of FH and of its statistical properties is basic for phasing methods.
Limits of a diffraction experiment. Diffraction occurs when r∗
H meet the Ewald
sphere (see Fig. 1.8). A diffraction experiment only allows measurement of
reﬂections with r∗
H contained within the limiting sphere (again, see Fig. 1.8).
Data resolution is usually described in terms of the maximum measurable
value of |r∗
H| (say |r∗
H|max): in this case the resolution is expressed in Å−1.
More frequently, because of equation (1.10), in terms of the minimum meas-
urable value of dH (say (dH)min): in this case data resolution is expressed in
Å. Accordingly, stating that data resolution is 2 Å is equivalent to saying that
only reﬂections with dH > 2 Å were measured. Severe resolution limits are
frequent for proteins: often reﬂections inside and close to the limiting sphere
cannot be measured because of the poor quality of the crystal. Usually, better
Ewald sphere
Limiting sphere
(2/λ)
1/λ
O
r*-
14
Fig. 1.8
Ewald and limiting spheres.

10
Fundamentals of crystallography
data can be collected, not by diminishing λ, but by performing the experi-
ment in cryo-conditions, to ﬁght decay of the scattering factor due to thermal
displacement.
Electron density calculations. According to equation (1.17), the electron dens-
ity in a point r having fractional coordinates (x,y,z) may be estimated via the
Fourier series
ρ(r) = 1
V
∞
h=−∞
∞
k=−∞
∞
l=−∞Fhkl exp[−2πi(hx + ky + lz)]
= 2
V
∞
h=0
∞
k=−∞
∞
l=−∞|Fhkl| cos[φhkl −2π(hx + ky + lz)].
(1.18)
The last term is obtained by applying the Friedel law, and shows that the elec-
tron density is a real function. As previously recalled, there are limitations
to the number of measurable reﬂections: accordingly, series (1.18) will show
truncation effects which are more and more severe as soon as the resolution
becomes worse (see Fig. 1.9 and Section 7.3.1).
500
a)
300
ρ(x)
100
–100
0
0.2
0.4
0.6
C
Mg
Mg
C
x
0.8
1
ρ(x)
–20
0
20
40
60
80
c)
0
0.2
0.4
0.6
x
0.8
1
ρ(x)
30
20
10
0
d)
0
0.2
0.4
0.6
x
0.8
1
b) 160
120
80
40
0
ρ(x)
–40
0
0.2
0.4
0.6
x
0.8
1
Fig. 1.9
Electron density maps of a (non-realistic) four-atom one-dimensional structure. Data up to: (a) 0.9 Å; (b) 1.5 Å; (c) 2 Å; (d) 3 Å. In all cases true
phases have been used: the differences between the maps are only due to truncation effects. Changes in peak intensity and positions are clearly
visible.

The structure factor
11
1.4
The structure factor
The structure factor Fh plays a central role in phasing methods: its simple geo-
metrical interpretation is therefore mandatory. Let N be the number of atoms
in the unit cell, fj the scattering factor of the jth atom, and xj, yj, zj its fractional
coordinates: then
Fh =
N
j=1 fj exp

2πi h · rj

=
N
j=1 fj exp

2πi(hxj + kyj + lzj)

.
(1.19)
fj includes the thermal displacement and must be calculated at the sin θ/λ cor-
responding to the reﬂection h: to do that, ﬁrstly, the modulus of the vector
r∗
hkl = ha∗+ kb∗+ lc∗should be calculated and then, by using the equation
|r∗| = 2 sin θ/λ, the searched f value may be obtained.
Let us rewrite (1.19) in the form
Fh =
N
j=1 fj exp(iαj) = |Fh| exp(iφh) = Ah + iBh,
(1.20)
where
αj = 2πh · rj,
Ah =
N
j=1 fj cos(2πh · rj),
Bh =
N
j=1 fj sin(2πh · rj).
On representing Fh in an Argand diagram (Fig. 1.10), we obtain a vectorial
diagram with N vectors each characterized by a modulus fj and an angle αj
with the real axis: the value
φh = tan−1(Bh/Ah)
(1.21)
depends on the moduli and on the mutual orientation of the vectors fj and is
said to be the phase of Fh.
In a space group with symmetry higher than P1, with point group symmetry
of order m, for each atomic position rj, located in the asymmetric unit, there
are m symmetry equivalent positions
rjs = Rsrj + Ts.
f5
f6
f7
f4
f3
f2
f1
α5
α6
α7
α4
α1
α2
φh
Fh
α3
imag. axis
real axis
Fig. 1.10
The structure factor Fh is represented
in the Argand plane as the sum of
N = 7 fj vectors, with modulus fj and
phase angle αj.

12
Fundamentals of crystallography
Then the structure factor takes the form
Fh =
t
j=1 fj
m
s=1 exp 2πih(Rsrj + Ts)
where t is the number of atoms in the asymmetric unit.
1.5
Symmetry in reciprocal space
A diffraction experiment allows us to see the reciprocal space: it is then very
important to understand which symmetry relations can be discovered there as
a consequence of the symmetry present in direct space. Here we summarize
the main effects.
1.5.1 Friedel law
In accordance with equation (1.20) we write Fh = Ah + iBh. Then it will follow
that F–h = Ah −iBh, and consequently
φ−h = −φh.
(1.22)
The value of φ–h is the opposite of the value of φh, see Fig. 1.11. Since
Ih = (Ah −iBh)(Ah + iBh) = A2
h + B2
h,
I−h = (Ah + iBh)(Ah −iBh) = A2
h + B2
h,
we deduce the Friedel law, according to which the diffraction intensities asso-
ciated with the vectors h and –h of reciprocal space are equal. Since these
intensities appear to be related by a centre of symmetry, usually, although
imperfectly, it is said that the diffraction by itself introduces a centre of
symmetry.
real axis
Fh
F–h
φh
–φh
imag. axis
Fig. 1.11
The Friedel law.
1.5.2 Effects of symmetry operators in reciprocal space
Let us suppose that the symmetry operator C = (R, T) exists in direct space.
We wonder what kind of relationships the presence of the operator C brings in
reciprocal space.
Since
F¯hR exp

2πi¯hT

=
N
j=1
fj exp

2πi¯hRXj

· exp

2πi¯hT

=
N
j=1
fj exp

2πi¯h(RXj + T)

= Fh,
we can write
F¯hR = Fh exp(−2πi¯hT).
(1.23)
Sometimes it is convenient to split equation (1.23) into two relations, the ﬁrst
involving moduli and the second the phases
|F¯hR| = |Fh|,
(1.24)
φ¯hR = φh −2π ¯hT.
(1.25)

Symmetry in reciprocal space
13
From (1.23) it is concluded that intensities Ih and I¯hR are equal, while their
phases are related by equation (1.25).
Reﬂections related by (1.24) and by the Friedel law are said to be sym-
metry equivalent reﬂections. For example, in P2 the set of symmetry equivalent
reﬂections is
|Fhkl| = |F¯hk¯l| = |F¯h¯k¯l| = |Fh¯kl|.
(1.26)
The reader will easily verify that space groups P4, P¯4, and P4/m show the
following set of symmetry equivalent reﬂections:
|Fhkl| = |F¯h¯kl| = |F¯khl| = |Fk¯hl| = |F¯h¯k ¯l| = |Fhk¯l|, = |Fk¯h¯l| = |F¯kh¯l|.
1.5.3 Determination of reﬂections with restricted phase values
Let us suppose that for a given set of reﬂections the relationship ¯hR = −¯h
is satisﬁed. If we apply (1.25) to this set we will obtain 2φh = 2π ¯hT + 2nπ,
from which
φh = π ¯hT + nπ.
(1.27)
Equation (1.27) restricts the phase φh to two values, π ¯hT or π(¯hT + 1). These
reﬂections are called reﬂections with restricted phase values, or less correctly,
‘centrosymmetric’.
If the space group is centrosymmetric (cs.) the inversion operator
R =

¯1 0 0
0 ¯1 0
0 0 ¯1

,
T =

T1
T2
T3

will exist. In this case every reﬂection is a restricted phase reﬂection and will
assume the values π ¯hT or π(¯hT + 1). If the origin is assumed to be the centre
of symmetry then T = 0 and the permitted phase values are 0 and π. Then Fh
will be a real positive number when φh is equal to 0, and a negative one when
φh is equal to π. For this reason we usually talk in cs. space groups about the
sign of the structure factor rather than about the phase.
In Fig. 1.12, Fh is represented as an Argand diagram for a centrosymmetric
structure of six atoms. Since for each atom at rj another symmetry equivalent
atom exists at –rj, the contribution of every couple to Fh. will have to be real.
imag. axis
real axis
f3
f3
f1
f1
f2
f2
Fh
α3
α1
α2
–α2
–α1
–α3
Fig. 1.12
Fh is represented in the Argand plane for
a cs. crystal structure with N = 6. It is
αj = 2π ¯HXj.

14
Fundamentals of crystallography
Table 1.6 Restricted phase reﬂections for the 32 point groups
Point group
Sets of restricted phase reﬂections
1
None
¯1
All
m
(0, k, 0)
2
(h, 0, l)
2/m
All
mm2
[(h, k, 0) masks (h, 0, 0), (0, k, 0)]
222
Three principal zones only
mmm
All
4
(h, k, 0)
¯4
(h, k, 0); (0, 0, l)
4/m
All
422
(h, k, 0); {h, 0, l}; {h, h, l}
¯42m
[(h, k, 0), {h, h, 0}]; [{h, 0, l}, (0, 0, l)]
4mm
[(h, k, 0), {h, 0, 0}, {h, h, 0}]
4/mmm
All
3
None
¯3
All
3m
{h, 0, ¯h, 0}
32
{h, 0, ¯h, l}
¯3m
All
6
(h, k, 0)
¯6
(0, 0, l)
6/m
All
¯6m2
[{h, h, l}, {h, h, 0}, (0, 0, l)]
6mm
[(h, k, 0), {h, h, 0}, {h, 0, 0}]
62
(h, k, 0); (h, 0, l); (h, h, l)
6/mmm
All
23
{h, k, 0}
m¯3
All
¯43m
[{h, k, 0}, {h, h, 0}]
432
{h, k, 0}; {h, h, l}
m¯3m
All
As an example of a non-centrosymmetric (n.cs.) space group let us examine
P212121,

(x, y, z),
 1
2 −x, ¯y, 1
2 + z

,
 1
2 + x, 1
2 −y, ¯z

,

¯x, 1
2 + y, 1
2 −z

, where
the reﬂections (hk0), (0kl), (h0l) satisfy the relation ¯hR = −h for R =
R2, R3, R4 respectively. By introducing T = T2 in equation (1.27) we obtain
φhk0 = (πh/2) + nπ. Thus φhk0 will have phase 0 or π if h is even and phase
±π/2 if h is odd. By introducing T = T3 in equation (1.27) we obtain
φ0kl = (πk/2) + nπ: i.e. φ0kl will have phase 0 or π if k is even and ±π/2
if k is odd. In the same way, by introducing T = T4 in equation (1.27) we
obtain φh0l = (πl/2) + nπ: i.e. φh0l will have phase 0 or π if l is even and
±π/2 if l is odd. In Table 1.6 the sets of restricted phase reﬂections are given
for the 32 point groups.
Table 1.7 If hR = −h the allowed
phase values φa of Fh are πhT and
πhT + π. Allowed phases are multiples
of 15◦and are associated, in direct
methods programs, with a symmetry
code (SCODE). For general reﬂections
SCODE = 1
φ(0)
a
SCODE
Any
1
(30,210)
3
(45,225)
4
(60,240)
5
(90,270)
7
(120,300)
9
(135,315)
10
(150,330)
11
(180,360)
13
The allowed values of restricted phases depend on the translational
component of the symmetry element and on its location with respect
to the cell origin. For conventional three-dimensional space groups the
allowed phase values are multiples of 15◦. In Table 1.7 the different types
of phase restriction are shown: in the second column the characteristic

Symmetry in reciprocal space
15
codes associated in direct methods programs with the various restrictions
are quoted. It should not be forgotten that symmetry equivalent reﬂections
can have different allowed phase values. For example, in the space group
P41212

(x, y, z) ;

¯x, ¯y, z + 1
2

;

¯y + 1
2, x + 1
2, z + 1
4

;

y + 1
2, ¯x + 1
2, z + 3
4

;

¯x + 1
2, y + 1
2, ¯z + 1
4

;

x + 1
2, ¯y + 1
2, ¯z + 3
4

; ( y, x, ¯z);

¯y, ¯x, ¯z + 1
2

, the reﬂec-
tion (061) has phase values restricted to (–(π/4), 3π/4). Its equivalent
reﬂections are also symmetry restricted, but the allowed phase values may
be different from (–(π/4), 3π/4). On the assumption that φ061 = 3π/4, the
reader will ﬁnd for the equivalent reﬂections the phase restrictions shown in
Fig. 1.13.
φ061, φ601
-
- -
φ601, φ061
-
--
φ061, φ601-
φ601, φ061-
Fig. 1.13
Phase
restrictions
for
the
reﬂection
(061) and its symmetry equivalents.
1.5.4 Systematic absences
Let us look for the class of reﬂections for which ¯hR = ¯h and apply equation
(1.23) to them. This relation would be violated for those reﬂections for which
¯hT is not an integer number unless |Fh| = 0. From this fact the rule follows:
reﬂections for which ¯hR = ¯h and ¯hT is not an integer will have diffraction
intensity zero or, as is usually stated, will be systematically absent or extinct.
Let us give a few examples.
In the space group P21

(x, y, z) ,

¯x, y + 1
2, ¯z

, the reﬂections (0k0) satisfy
the condition ¯hR2 = ¯h. If k is odd, ¯hT2 is semi-integer. Thus, the reﬂections
(0k0) with k ̸= 2n are systematically absent.
In the space group P41

(x, y, z) ,

¯x, ¯y, 1
2 + z

,

¯y, x, 1
4 + z

,

y, ¯x, 3
4 + z

,
only the reﬂections (00l) satisfy the condition hRj = h for j = 2,3,4. Since
¯hT2 = l/2, ¯hT3 = l/4, ¯hT4 = 3l/4, the only condition for systematic absence
is l ̸= 4n, with n integer.
In the space group Pc

(x, y, z),

x, ¯y, z + 1
2

, the reﬂections (h0l) satisfy the
condition ¯hR2 = ¯h. Since ¯hR2 = l/2, the reﬂections (h0l) with l ̸= 2n will be
systematically absent.
Note that the presence of a slide plane imposes conditions for systematic
absences to bidimensional reﬂections. In particular, slide planes opposite to
a, b, and c impose conditions to classes (0kl), (h0l), and (hk0) respectively.
The condition will be h = 2n, k = 2n, l = 2n for the slide planes of type a, b,
or c respectively.
Let us now apply the same considerations to the symmetry operators cent-
ring the cell. If the cell is of type A, B, C, I, symmetry operators will exist
whose rotational matrix is always the identity, while the translational matrices
are
TA =
⎡
⎢⎢⎢⎢⎣
0
1
2
1
2
⎤
⎥⎥⎥⎥⎦
TB =
⎡
⎢⎢⎢⎢⎣
1
2
0
1
2
⎤
⎥⎥⎥⎥⎦
TC =
⎡
⎢⎢⎢⎢⎣
1
2
1
2
0
⎤
⎥⎥⎥⎥⎦
TI =
⎡
⎢⎢⎢⎢⎢⎢⎣
1
2
1
2
1
2
⎤
⎥⎥⎥⎥⎥⎥⎦
respectively. If we use these operators in equation (1.24), we ﬁnd that (1) the
relation ¯hR = ¯h is satisﬁed for any reﬂection and (2) the systematic absences,

16
Fundamentals of crystallography
of three-dimensional type, are k + l = 2n, h + l = 2n, h + k = 2n, h + k + l = 2n,
respectively.
A cell of type F is simultaneously A-, B-, and C-centred, so the
respective conditions for systematic absences must be simultaneously valid.
Consequently, only the reﬂections for which h, k, and l are all even or all odd
will be present.
The same criteria lead us to establish the conditions for systematic absences
for rhombohedral lattices (−h + k + l ̸= 3n for obverse setting and
h −k + l ̸= 3n for reverse setting). The list of systematic absences for any
symmetry element is given in Table 1.8.
Table 1.8 Systematic absences
Symmetry elements
Set of reﬂections
Conditions
Lattice
P
hkl
None
I
h + k + l = 2n
C
h + k = 2n
A
k + l = 2n
B
h + l = 2n
F
⎧
⎨
⎩
h + k = 2n
k + l = 2n
h + l = 2n
Robv
–h + k + l = 3n
Rrev
h – k + l = 3n
Glide plane || (001)
a
hk0
h = 2n
b
k = 2n
n
h + k = 2n
d
h + k = 4n
Glide plane || (100)
b
0kl
k = 2n
c
l = 2n
n
k + l = 2n
d
k + l = 4n
Glide plane || (010)
a
h0l
h = 2n
c
l = 2n
n
h + l = 2n
d
h + l = 4n
Glide plane || (110)
c
hhl
l = 2n
b
h = 2n
n
h + l = 2n
d
2h + l = 4n
Screw axis || c
21, 42, 63
00l
l = 2n
31, 32, 62, 64
l = 3n
41, 43
l = 4n
61, 65
l = 6n
Screw axis || a
21, 42
h00
h = 2n
41, 43
h = 4n
Screw axis || b
21, 42
0k0
k = 2n
41, 43
k = 4n
Screw axis || [110]
21
hh0
h = 2n

The basic postulate of structural crystallography
17
1.6
The basic postulate of structural
crystallography
In the preceding paragraphs we have summarized the basic relations of general
crystallography: these can be found in more extended forms in any standard
textbook. The reader is now ready to learn about the topic of phasing, one of
the most intriguing problems in the history of crystallography. We will start by
illustrating its logical aspects (rather than its mathematics) via a short list of
questions.
Given a model structure, can we calculate the corresponding set (say {|Fh|} )
of structure factor moduli? The answer is trivial; indeed we have only to intro-
duce the atomic positions and the corresponding scattering factors (including
temperature displacements) into equation 1.19. As a result of these calcu-
lations, moduli and phases of the structure factors can be obtained. It may
therefore be concluded that there is no logical or mathematical obstacle to the
symbolic operation
ρ(r) ⇒{|Fh|} .
A second question is: given only the structure factor moduli, can we entertain
the hope of recovering the crystal structure, or, on the contrary, is there some
logical impediment to this (for example, an irrecoverable loss of information)?
In symbols, this question deals with the operation
{|Fh|} ⇒ρ(r).
(1.28)
As an example, let us suppose that the diffraction experiment has provided
30 000 structure factor moduli and lost 30 000 phases. Can we recover the
30 000 phases given the moduli, and consequently determine the structure, or
are the phases irretrievably lost?
A ﬁrst superﬁcial answer may be provided by our daily experience. To give
a simple example, if we are looking for a friend in New York but we have lost
his address, it would be very difﬁcult to ﬁnd him. This allegorical example is
appropriate as in New York there are millions of addresses, similarly, millions
of structural models may be conceived that are compatible with the exper-
imental unit cell. The search for our friend would be much easier if some
valuable information were still in our hands: e.g. he lives in a ﬂat on the
130th ﬂoor. In this case we could discard most of the houses in New York.
But where, in the diffraction experiment, is the information hidden which
can allow us to discard millions of structural models and recover the full
structure?
A considered answer to the problem of phase recovery should follow refer-
ence to modern structural databases (see Section 1.7). In Fig. 1.14 statistics are
shown from the Cambridge Structural Database, where the growth in numbers
of deposited structures per year is shown. Hundreds of thousands of crystal
structures have been deposited, the large majority of these having been solved
starting from the diffraction moduli only. In Fig. 1.15, similar statistics are
shown for the Protein Data Bank (PDB).

18
Fundamentals of crystallography
600000
500000
400000
300000
200000
100000
0
1972
1976
1980 1984
1988
1992
1996
2000
2004
2008
Fig. 1.14
Cumulative
growth
per
year
of
the
structures deposited in the Cambridge
Structural Database (CSD).
70000
60000
60000
40000
30000
20000
10000
0
1979
1981
1983
1985
1987
1989
1991
1993
1995
1997
1999
2001
2003
2005
2007
2009
2011
Fig. 1.15
Growth per year of the structures depos-
ited in the Protein Data Bank (PDB).
Such huge numbers of structures could not have been solved without valu-
able information provided by experiment and since X-ray experiments only
provide diffraction amplitudes we have to conclude that the phase information
is hidden in the amplitudes. But at the moment we do not know how this is
codiﬁed.
Before dealing with the code problem, we should answer a preliminary
question: how can we decide (and accept) that such huge numbers of crys-
tal structures are really (and correctly) solved? Each deposited structure is
usually accompanied by a cif ﬁle, where the main experimental conditions,
the list of the collected experimental data, their treatment by crystallographic
programs, and the structural model are all described. Usually residuals such as
(Booth, 1945)
Rcryst =

h ||Fobs −|Fcalc||

h |Fobs|
(1.29)

The basic postulate of structural crystallography
19
are mentioned as mathematical proof of the correctness of a model: if Rcryst
is smaller than a given threshold and no crystal chemical rule is violated by
the proposed model, then the model is assumed to be correct. This assumption
is universally accepted, and is the basic guideline for any structural crystal-
lographer, even though it is not explicitly formulated and not demonstrated
mathematically. But, how can we exclude two or more crystal structures which
may exist, which do not violate well-established chemical rules, and ﬁt the
same experimental data? A postulate should therefore be evoked and legitim-
ized, in order to allow us to accept that a crystal structure is deﬁnitively solved:
this is what we call the basic postulate of structural crystallography.
The basic postulate of structural crystallography: only one chemically
sound crystal structure exists that is compatible with the experimental diffrac-
tion data.
Before legitimizing such a postulate mathematically a premise is neces-
sary: the postulate is valid for crystal structures, that is, for structures for
which chemical (i.e. the basic chemical rules) and physical constraints hold.
Among physical constraints we will mention atomicity (the electrons are not
dispersed in the unit cell, but lie around the nucleus) and positivity (i.e. the
electron density is non-negative everywhere). The latter two conditions are
satisﬁed if X-ray data and, by extension, electron data (electrons are sensible
to the potential ﬁeld) are collected: the positivity condition does not hold for
neutron diffraction, but we will see that the postulate may also be applied to
neutron data.
Let us now check the postulate by using the non-realistic four-atom one-
dimensional structure shown in Fig. 1.9a: we will suppose that the chosen
interatomic distances comply with the chemistry (it is then a feasible model).
In Fig. 1.16a–c three electron densities are shown at 0.9 Å resolution, obtained
by using, as coefﬁcients of the Fourier series (1.18), the amplitudes of the true
structure combined with random phases. All three models, by construction,
have the same diffraction amplitudes (Rcryst = 0 for such models), but only
one, that shown in Fig. 1.9a, satisﬁes chemistry and positivity–atomicity pos-
tulates. All of the random models show positive peaks (say potential atoms)
in random positions, there are always a number of negative peaks present, and
the number of positive peaks may not coincide with the original structure. Any
attempt to obtain other feasible models by changing the phases in a random
way will not succeed: this agrees well with the postulate.
A more realistic example is the following (structure code Teoh, space group
I-4, C42 H40 O6 Sn2). Let us suppose that the crystallographer has reques-
ted his phasing program to stop when a model structure is found for which
Rcryst< 0.18 and that the program stops, providing the model depicted in
Fig. 1.17a, for which Rcryst = 0.16. This model, even if it is further reﬁn-
able up to smaller values of Rcryst, has to be rejected because it is chemically
invalid, even if the crystallographic residual is sufﬁciently small. If the crys-
tallographer asks the phasing program to stop only when a model is found for
which Rcryst< 0.10, then the model shown in Fig. 1.17b is obtained, for which
Rcryst = 0.09. This new model satisﬁes basic crystal chemical rules and may be
further reﬁned.

20
Fundamentals of crystallography
40
a)
30
20
10
0
0
ρ(x)
ρ(x)
0.2
x
0.6
1
–10
–20
–30
–20
0
20
40
c)
b)
30
50
10
0
ρ(x)
0.2
x
0.6
0.8
1
0
0.2
0.4
x
1
–10
–30
–50
0.4
0.8
0.4
0.6
0.8
Fig. 1.16
For the four-atom one-dimensional structure shown in Fig. 1.9a, three models, obtained using random phases, are shown. Data resolution: 0.9 Å.
The above results lead to a practical consequence: even if experimental data
are of high quality, and even if there is very good agreement between exper-
iment and model (i.e. a small value of Rcryst), structure validation (i.e. the
control that the basic crystal chemical rules are satisﬁed by the model) is the
necessary ﬁnal check of the structure determination process. Indeed it is an
obligatory step in modern crystallography, a tool for a posteriori conﬁrmation
of the basic postulate of crystallography.
The basic postulate may be extended to neutron data, but now the positivity
condition does not hold: it has to be replaced by the chemical control and
validation of the model, but again, there should not exist two chemically sound
crystal structures which both ﬁt high quality experimental data.
In order to legitimize the basic postulate of structural crystallography math-
ematically, we now describe how the phase information is codiﬁed in the
diffraction amplitudes. We observe that the modulus square of the structure
factor, say
|Fh|2 = Fh · F−h =
N
j=1 fj exp

2πi h · rj

·
N
j=1 fj exp

−2πi h · rj

=
N
j 1, j 2=1 fj1fj 2 exp

2πi h · (rj1 −rj 2)

(1.30)

The basic postulate of structural crystallography
21
depends on the interatomic distances: inversely, the set of interatomic distances
deﬁnes the diffraction moduli. If one assumes that only a crystal structure
exists with the given set of interatomic distances, the obvious conclusion
should be that only one structure exists (except for the enantiomorph structure)
which is compatible with the set of experimental data, and vice versa, only one
set of diffraction data is compatible with a given structure. In symbols
crystal structure ⇔

ri −rj

⇔{|Fh|} .
(1.31)
This coincides exactly with the previously deﬁned basic postulate.
The conclusion (1.31), however, must be combined with structure valida-
tion, as stated in the basic postulate. Indeed Pauling and Shapell (1930) made
the observation that for the mineral bixbyite there are two different solutions,
not chemically equivalent, with the same set of interatomic vectors. Chemistry
(i.e. structure validation) was invoked to deﬁne the correct structure. Patterson
(1939, 1944) deﬁned these kinds of structure as homometric and investig-
ated the likelihood of their occurrence. Hosemann and Bagchi (1954) gave
formal deﬁnitions of different types of homometric structures. Further con-
tributions were made by Buerger (1959, pp. 41–50), Bullough (1961, 1964),
and Hoppe (1962a,b). In spite of the above considerations it is common prac-
tice for crystallographers to postulate, for structures of normal complexity, a
biunique correspondence between the set of interatomic vectors and atomic
arrangement. Indeed for almost the entire range of the published structures,
two different feasible (this property being essential) structures with the same
set of observed moduli has never been found.
b)
a)
Fig. 1.17
Teoh: (a) false structural model with
Rcryst = 0.16; (b) correct structural model
with Rcryst = 0.08.
Some care, however, is necessary when the diffraction data are not of high
quality and/or some pseudosymmetry is present. Typical examples of structural
ambiguity are:
(a) The low quality of the crystal (e.g. high mosaicity), or the disordered
nature of the structure. In this case the quality of the diffraction data is
depleted, and therefore the precision of the proposed model may be lower.
(b) The structure shows a symmetry higher than the real one. For example,
the structure is very close to being centric but it is really acentric, or it
shows a strong pseudo tetragonal symmetry but it is really orthorhombic.
Deciding between the two alternatives may not be easy, particularly when
the pseudosymmetry is very close to crystal symmetry and data quality is
poor.
(c) Strong pseudotranslational symmetry is present. This occurs when a high
percentage of electron density satisﬁes a translational vector u smaller than
that allowed by the crystal periodicity: for example, if u = a/3 and 90% of
the electron density is invariant under the pseudotranslation. In this case
reﬂections with h = 3n are very strong, the others are very weak. If only
substructure reﬂections are measured, the substructure only is deﬁned
(probably with a quite good Rcryst value), but the ﬁne detail of the structure
is lost.
In all of the cases a–c the ﬁnal decision depends on the chemistry and on the ﬁt
between model and observations. To give a general view of what the ﬁt means

22
Fundamentals of crystallography
numerically today, we report in Table 1.9 statistics on the crystallographic
residual Rcryst performed over the structures deposited in the Cambridge
Structural Database up to January 2012. We see that the precision of the struc-
tural determination may vary over a wide range: indeed Rcryst values are found
between 0.01 and more than 0.1, and this wide range is often due to the differ-
ent quality of the crystals. For the large majority of structures, even those with a
relatively high value of Rcryst, the structure is uniquely ﬁxed in all details, even-
tually with limited precision in unit cell regions where structural disorder is
present. These details, however, do not destroy the general validity of the basic
postulate.
Table 1.9 Statistics
on
Rcryst
for
structures deposited in the Cambridge
Structural Database up to 1 January
2012. For each range Rcryst in which
Rcryst lies, Nstr and % are the correspond-
ing number of structures and percentage,
respectively
Rcryst
Nstr
%
0.01–0.03
62 774
10.5
0.03–0.04
122 706
20.6
0.04–0.05
135 525
22.7
0.05–0.07
163 269
27.4
0.07–0.09
60 651
10.2
0.09–0.10
13 370
2.2
0.10–0.15
18 353
3.1
0.15–. . . .
3835
0.6
The basic postulate of structural crystallography should be considered by
any rational crystallographer before initiating their daily structural work. This
may be further summarized as follows: in a diffraction experiment the phase
information is not lost, it is only hidden within the diffraction amplitudes.
Accordingly, any phasing approach is nothing else but a method for recovering
the hidden phases from the set of diffraction amplitudes.
Let us now suppose that the basic postulate is consciously considered by
our young crystallographer. A further problem then arises: is the amount of
information stored in the diffraction amplitudes sufﬁcient to deﬁne the struc-
ture? For example, in the case of a low resolution diffraction experiment the
crystallographic data may not be sufﬁcient to deﬁne the short interatomic dis-
tances, making it impossible, therefore, to uniquely deﬁne the structure. This
is a crucial problem for structural crystallography, since the crystal structure
solution may depend on the amount of information provided by the diffrac-
tion experiment. What then are the resolution limits for a useful diffraction
experiment?
Suppose we have a crystal with P1 symmetry: let N be the number of
non-hydrogen atoms in the unit cell, and Nsp = 4N the number of structural
parameters necessary for deﬁning the structure (four parameters per atom, say
x, y, z and the corresponding isotropic thermal factor). For a small- or medium-
sized molecule, V = k N, where k is usually between 15.5 and 18.5; for a
protein, owing to the presence of the solvent, k may be signiﬁcantly larger, up
to or even exceeding 40. According to equation (1.8), V∗= V−1 = (kN)−1.
Let us suppose that a diffraction experiment provides data up to r∗
max, or,
equivalently, up to dmin. The number of measurable reﬂections (say Nref )
may be calculated as follows. The reciprocal space measured volume may be
parameterized as
∗
meas = 4
3π

r∗
max
3 =
4π
3d3
min
,
and
Nref = ∗
meas
V∗
=
4π
3d3
min
kN.
Let us now estimate the index,
Rinf = ratio between the experimental information and the
structural complexity.
(1.32)

The basic postulate of structural crystallography
23
When no prior supplemental information is available besides experimental
data, Rinf may be qualitatively approximated as follows:
Rinf = number of measured symmetry independent reﬂections/number
of structural parameters
(1.33)
To compute Rinf, the Friedel law should be taken into account: thus we divide
Nref by 2 and then write the resulting expression for Rinf :
Rinf ≈
π
6d3
min
k.
The numerical values of Rinf for speciﬁc values of k and dmin are shown in
Table 1.10: larger values of Rinf correspond with cases in which the structure is
overdetermined by the observations, while small values of Rinf do not uniquely
ﬁx the structure. Let us suppose, just as a rule of thumb, that a structure may
be solved, from diffraction data only, if Rinf ≥3: Table 1.10 suggests that
dmin ≈1.4 Å is the resolution threshold below which a small molecule structure
cannot be solved ab initio. The threshold moves to ≈1.6 Å for a protein with a
small percentage of solvent, and to ≈1.8 Å for a protein with a larger solvent
percentage.
Table 1.10 Rinf in P1 is shown for
some values of dmin and k. k = 17 is rep-
resentative of the small- to medium-sized
structures, k = 25, 35, of the proteins
dmin
k = 17
k = 25
k = 35
0.4
139
204
286
0.6
41
60.6
84.7
0.8
17.4
25.6
35.7
1.0
8.9
13.1
18.3
1.4
3.2
4.8
13.7
1.8
1.5
2.2
3.1
2.2
0.8
1.2
1.7
2.5
0.6
0.8
1.2
3.0
0.3
0.5
0.7
3.5
0.2
0.3
0.4
4.0
0.1
0.2
0.3
The conclusion is that the solvent is a valuable source of information: the
larger the solvent, the higher the threshold for the ab initio crystal structure
solution (modern solvent ﬂattening techniques are able to efﬁciently exploit
this information). A special case occurs when one is interested in solving a
substructure, for example the heavy-atom substructure in SIR-MIR cases and
the anomalous scatterer substructure in SAD-MAD cases. If it is supposed
that the structure factor amplitudes of such substructures are estimated with
reasonable approximation, then the atoms belonging to the substructure are
dispersed in a big empty space (i.e. the unit cell of the structure). In this case
the estimated structure factor amplitudes of the substructure overdetermine
it, and the substructure could be solved even at very low resolution (worse
than 3.5 Å).
The above conclusions do not change signiﬁcantly if the space group has
symmetry higher than triclinic. Indeed in this case Rinf is the ratio between
the number of unique reﬂections and the number of structural parameters
corresponding to the symmetry independent atoms.
Additional difﬁculties with the phasing process arise when experimental
data quality is poor. If there are errors in the diffraction amplitudes, since
information on the phases is hidden within the amplitudes, such errors will
inevitably cause a deterioration in the efﬁciency of any phasing procedure. This
is particularly important in the case of powder data (see Chapter 12) and also
electron data (see Chapter 11), but it is also important for proteins, because the
presence of the solvent implies disordered regions in the unit cell and therefore
limited data resolution.
So far we have answered the question: under what conditions is a struc-
ture univocally ﬁxed from its diffraction data? We have skipped cases where
some previous additional information is available; here, the number of meas-
ured symmetry independent reﬂections in the numerator of Rinf is only part
of the total information available and therefore the conclusions drawn from

24
Fundamentals of crystallography
Table 1.10 must be corrected. In this book we will consider four cases in which
additional information is present:
1. Non-crystallographic symmetry. This is an important source of informa-
tion which permits a reduction in the number of structural parameters in
equation 1.33. It occurs when there are more identical molecules in the
asymmetric unit: in this case they may be deﬁned in terms of one molecule
by applying the local symmetry operators. Non-crystallographic sym-
metry allows the structural solution of large biological assemblies such as
viruses.
2. Molecular replacement. A model molecule, similar geometrically to that
under investigation, is available.
3. Isomorphous derivatives. Diffraction data for the target and one or more
isomorphous structures are measured.
4. Anomalous dispersion data. Diffraction data with anomalous dispersion
effects are collected (we will see that this case is similar to case 3).
Because of the additional experimental information available, the value of Rinf
increases substantially which allows structure solution even at data resolutions
larger than 4 Å.
1.7
The legacy of crystallography
Human beings periodically visit museums to enjoy the artistic masterpieces
exhibited in witness of human sensitivity to beauty. Historical and technical
museums are often consulted in relation to their acquaintance with the evol-
ution of human civilization andwith man′s capacity for improving human
life through technical innovations. But, where can the products of crystallo-
graphy be consulted, in witness of its immense legacy to chemistry, physics,
mineralogy, and biology?
Over a period of about one century crystallographic phasing methods have
solved a huge number of crystal structures, so enriching our understanding of
the mineral world, of organic, metallorganic, and inorganic chemistry, and of
the bio-molecules. This enormous mine of information is stored in dedicated
databases, among which are the following.
1. The Cambridge Structural Database (CSD), <http://www.ccdc.cam.ac.
uk/products/csd/>, where chemical and crystallographic information for
organic molecules and metal–organic compounds determined by X-ray or
neutron diffraction: powder diffraction studies are deposited.
2. Inorganic Crystal Structure Database (ICSD), <http://www.ﬁz-karlsruhe.
de/icsd_content.html>, where structural data of pure elements, metals,
minerals and intermetallic compounds are deposited. By January 2012 it
contained more than 150 000 entries, 75.6% of them with a structure having
been assigned.
3. CRYSTMET, <http://www.tothcanada.com/>, where structural informa-
tion on metals and alloys are stored.

The legacy of crystallography
25
Table 1.11 CSD entries on 1 January 2012: Nr is the number of entries,
% the corresponding percentage over the total
Nr
%
Total number of structures
596 810
100
Number of compounds
544 565
Organic compounds
254 475
42.6
Transition metal present
319 188
53.5
Neutron studies
1534
0.3
Powder diffraction studies
2354
0.4
4. Protein Data Bank (PDB), <http://www.rcsb.org/pdb/>, with about
75 056 entries up to January 2012.
5. Nucleic Acid Database (NDB), <http://ndbserver.rutgers.edu/>, oligonuc-
leotide structures deposited up to April 2012.
Table 1.12 CSD: crystallographic sy-
stem statistics
System
%
Triclinic
24.7
Monoclinic
52.5
Orthorhombic
18.0
Tetragonal
2.2
Trigonal
1.7
Hexagonal
0.5
Cubic
0.5
Table 1.13 CSD: the 10 most fre-
quent space groups
Space group
%
P21/c
34.9
P-1
23.8
C2/c
8.2
P212121
7.6
P21
5.3
Pbca
3.5
Pna21
1.6
Pnma
1.2
Cc
1.1
P1
1.0
For each structure deposited, an archive typically contains details of the
structure solution, citation information, the list of atoms and their coordin-
ates; the structure can be visualized and displayed on the user’s com-
puter. In this section we report some statistics on the entries in two of
these databases, the CSD for small molecules and the PDB for macro-
molecules, in order to provide the reader with some essential information
on some of the parameters to which phasing methods are sensitive. For
example, which type of radiation is more useful in standard conditions,
which are the most frequent space groups or crystal systems, how data
resolution is distributed among the deposited structures, etc. This type of
information is shown in Tables 1.11 to 1.16. It should be noted that:
Table 1.15 PDB: distribution of data
resolution for the deposited structures,
in Å
Å
Nr
%
0.5–1
485
0.68
1.0–1.5
6134
8.63
1.5–2.0
27 385
38.53
2.0–2.5
22 144
31.16
2.5–3.0
11 210
15.77
3.0–3.5
2930
4.12
3.5–4.0
602
0.85
(a) Tables 1.11 and 1.14 provide the numbers of deposited structures for small
molecules and macromolecules, respectively. Also given is information on
the type of radiation used for their solution. The tables justify the special
attention we are giving to X-ray diffraction.
(b) Tables 1.13 to 1.16 suggest which are the most frequent space groups, for
both small and large molecules. The reader should remember that these are
expected to be very different for the two categories: indeed centric space
groups and, in general, groups with inversion axes, are not allowed for
proteins.
Table 1.14 PDB: entries for proteins, nucleic acids, and protein/NA complexes, according to
experimental technique
Proteins
Nucleic acids
Protein/NA complexes
Total
75056
2360
3609
X-ray
66381
1352
3298
NMR
8206
979
186
Electron microscopy
285
22
118

26
Fundamentals of crystallography
(c) Table 1.15 does not have a counterpart for small molecules, where resolu-
tion is frequently atomic. The reason for this is very simple. Proteins have
a large number of atoms in the unit cell: in only a few cases is the asymmet-
ric unit composed of fewer than 500 non-H atoms, more often in excess
of 8000. Thus the number of atoms in the unit cell, for high-symmetry
space groups, is often more than 100 000. Protein molecules are irregular
in shape and they pack together to form a crystal, but with gaps between
them. The gaps are ﬁlled by another liquid (also called a solvent): such
a disordered region ranges from 30–75% of the volume of the unit cell.
Thus, while a classical molecular crystal may be described in terms of a
regular lattice, in a protein, the crystalline array coexists with an extended
disordered region. This will contribute to low-resolution diffraction, say up
to 8–10 Å resolution as a rule of thumb. The disorder in the protein crystal
and the high thermal motion within the protein do not permit diffraction
intensities to be collected up to the resolution usually attainable for small
molecules. According to Table 1.15, about 85% of the proteins show res-
olution between 1.5 and 3 Å and for about 8.6% of them, the resolution is
better than 1.5 Å: in exceptional cases the resolution is higher than 1 Å.
Table 1.16 PDB: the 10 most fre-
quent space groups
Space group
Nr
%
P212121
16 421
22.94
P21
10 948
15.30
C2
6777
9.47
P21212
3924
5.48
C2221
3511
4.91
P1
2975
4.16
P43212
2702
3.78
P3221
2547
3.56
P3121
2373
3.32
P41212
2365
3.13
The consequence is that data resolution is one of the most severe parameters
in protein structural solvability.

Wilson statistics
2
2.1
Introduction
In a very traditional village game, popular over the period of Lent (usually on
the pigñata day, the ﬁrst Sunday of Lent), a young player, suitably blindfolded
and armed with a long cudgel, tries to hit a pot (the pigñata) located some
distance away, in order to win the sweetmeats contained inside. To break the
pot they take random steps, and at each step they try to hit the pot with the
cudgel. Is it possible to guess the distance of the player from their starting pos-
ition after n random steps? Is it possible to guess the direction of the vectorial
resultant of the n steps?
A very simple analysis of the problem suggests that the distance after n
steps may be estimated but the direction of the resultant step cannot, because a
preferred privileged orientation does not exist.
The situation is very similar to structure factor statistics. Each of the N atoms
in the unit cell provides the vectorial contribution
fj = fj exp

2πih · rj

= fj exp

i θj

to the structure factor; this is equivalent to a vectorial step of the pigñata player.
The modulus of the atomic contribution, like the amplitude of the step in the
pigñata game, is known (because the chemical composition of the molecules
in the unit cell is supposed to be known), but the phase θj (corresponding to the
direction of the step) remains unknown; indeed we do not know the position rj
of the j th atom.
The analogy with the pigñata game suggests that some information on
the moduli of the structure factors can be obtained via a suitable statistical
approach, while no phase information can be obtained using this approach.
This chapter deals just with this statistical approach and owing to the relevant
contributions of A. J. C. Wilson, we call this chapter Wilson statistics. To allow
greater ﬂuency of reading, we have moved some of the mathematical proofs
and formula derivations to the appendices at the end of the chapter, and we
have completely omitted more specialized topics such as:

28
Wilson statistics
(i) non-ideal distributions correlated to special atomic positions (Howells
et al., 1950; Hargreaves, 1955; Pradhan et al., 1985);
(ii) effects of measurement errors or data omission on the Wilson plot
(Howells et al., 1950; Vickovi´c and Viterbo, 1979; French and Wilson,
1978; Subramanian and Hall, 1982; Cascarano et al., 1991);
(iii) effects of pseudo- or hyper-symmetry on the structure factor distribu-
tions (Parthasarathy and Parthasarathi, 1976; Lipson and Woolfson, 1952;
Rogers and Wilson, 1953; Cascarano et al., 1985a,b, 1987b, 1988a,b;
Gramlich, 1984);
(iv) the Fourier series representation of the structure factor distributions as
described by Shmueli et al. (1984) and Shmueli and Weiss (1995).
Readers interested in these topics are referred to Phasing, Chapter 1, or to the
original papers.
2.2
Statistics of the structure factor:
general considerations
The structure factors, when known in modulus and phase, contain all of the
information about the crystal structure; therefore knowing about their stat-
istical behaviour may be an aid towards success with the phasing problem.
A statistical study may only be performed after deﬁning which are the vari-
ables in the mathematical model and which are the parameters under study.
The structure factor Fh is a function of the reciprocal vector h as well as of the
atomic positional parameters rj: both may be assumed to be variables or para-
meters. We will consider three different ways of performing statistical analysis
on Fh:
(1) h ﬁxed, variable positions. The distribution function of Fh is derived by
taking the vectorial index h as ﬁxed, and by assuming the atomic positions rj
as random variables. In the absence of any prior information, the rjs may be
assumed to be uniformly distributed in the unit cell (in other words, any site of
the unit cell has the same probability of accomodating an atomic position).
In this case 2πh · rj is uniformly distributed over the trigonometric circle,
or, equivalently, the fractional part of h · rj is uniformly distributed between
0 and 1. This type of statistics may answer the following question: for ﬁxed
h what are the expected values of |Fh| and φh when the structure varies in all
possible ways?
Such statistics will only be useful in practice if crystals satisfy or nearly
satisfy the above stated conditions. If the number of atoms per unit cell is
very small (tentatively less than 8) the positions of the atoms are mainly con-
trolled by physicochemical factors such as electrostatic interaction, packing,
bond angles, etc. Under these conditions we have an ordered conﬁguration
for the crystal structure in the sense that, for a high percentage of atoms, the
coordinates are not random and comply with relationships of the type
m1xj + m2yj + m3zj = m4,
(2.1)
where mi, i = 1, . . . , 4 are integers and not all zero (in a typical case,
most of the atoms are in special positions). This is the case mentioned in

Structure factor statistics in P1 and P ¯1
29
Section 2.1 and referred to as non-ideal distributions correlated to special
atomic positions.
When N is sufﬁciently large, even though the above mentioned physi-
cochemical interactions are still present, the atomic coordinates may be
considered approximately as random variables. If the atoms are distributed at
random in the unit cell, then any vector
fj = fj exp

2πi h · rj

may be considered as a random step of a random walk. Thus the problem
of evaluating the probability that the structure factor with index h takes on a
value Fh appears similar to the random walk problem (Pearson, 1905; Kluyver,
1906), brieﬂy schematized in Section 2.1; or to the problem of evaluating the
probability, for a particle affected by Brownian motion, of occupying a position
r, if at time t = 0 it was at the origin of the reference system.
(2) Fixed positions, h variable. Let us assume that the structure is ﬁxed (even
if unknown) and that h varies within a sufﬁciently large subset of structure
factors (for example the subset of reﬂections contained in a resolution shell or
the full set of reﬂections up to RES). This type of statistics may answer the
following question: for the actual ﬁxed (even if unknown) structure, how are
the Fh moduli and phases distributed when h varies freely within the chosen
subset? From a mathematical point of view the conditions for the basis of the
two statistics (1) and (2) look different, even though h and rj are symmetrical
factors of the product h · rj. In fact, with the former approach the rj variables
may take on rational values, while in the latter the h variables may take on only
integer values. Nevertheless, Weyl (1915–16) showed that when an rj vector
has rationally independent xj, yj, zj components (in the sense that there are
no four non-zero integer numbers mi, i = 1, . . . , 4 satisfying (2.1)), then the
fractional part of h · rj is uniformly distributed within the interval (0,1) when
h varies in the domain of the integer numbers.
Weyl’s theorem proves that the two statistical approaches, the ﬁrst with h
ﬁxed and rj as random variables, and the second with ﬁxed rj and h varying
over reciprocal space, although ideally distinct, are exactly alike. This is of
fundamental importance in the subsequent steps of intensity statistics and also
in the theory of assigning phases by algebraic or probabilistic methods.
(3) h is kept ﬁxed, while atomic positions vary under suitable constraints.
This situation may occur frequently during the phasing process. As an
example, let us suppose that only part of the structure has been determined
while the rest remains unknown. In this case the atomic positions of the
ﬁxed molecular fragment should be considered as ﬁxed parameters, while the
undetermined atomic positions are free variables. In various chapters of this
book we will consider different cases in which this procedure may be applied.
2.3
Structure factor statistics in P1 and P ¯1
Wilson (1942, 1949) was the ﬁrst to derive the structure factor probability
distributions. Their expressions are identical to those derived by Rayleigh
(1919a,b) for the distribution of the resultant obtained from the composition
of N vibrations of equal amplitude but random phase. In this section we will

30
Wilson statistics
deal with the distribution in P1 and P¯1, under the assumption that h is ﬁxed
and that the rj are uniformly varying in the unit cell, each atomic position inde-
pendently of the others ((1) in Section 2.2). The same results, however, may be
obtained using (2), where the structure is ﬁxed and h variable.
Case P1: The statistical calculations described in Appendix 2.A.1 lead to
the ﬁnal distribution
1P(|F|, φ) = |F|
π exp

−|F|2


,
(2.2)
where the preﬁxed subscript 1 indicates that the space group is P1,

=
N
j=1 f 2
j
(2.3)
and N is the number of atoms in the unit cell. fj includes the thermal factor, and
is calculated at the sin θ/λ corresponding to ﬁxed h.
The reader should notice that (2.2) does not provide any information on the
phase, even if |F| is known. To explicitly check this feature we calculate the
conditional distribution of φ when the amplitude |F| is assumed to be known:
1P(φ||F|) =
1P(|F|, φ)
 2π
0
1P(|F|, φ)dφ
= 1
2π .
The result is that φ is uniformly distributed between 0 and 2π: i.e. the phase
value of a reﬂection cannot be determined by its diffraction modulus (see also
Chapter 3, where the origin problem is discussed).
Therefore, in this chapter, we can forget the phase problem and concentrate
our efforts on the amplitude distribution. The marginal distribution of the amp-
litudes (i.e. whatever the phase) is obtained by integrating φ in (2.2) over the
interval (0, 2π):
1P(|F|) = 2|F|
 exp

−|F|2


(2.4)
Equation 2.4 is known as the acentric distribution of the structure factors.
Case P¯1: The statistical calculations described in Appendix 2.A.2 lead to
the distribution
¯1P(|F|) =

2
π
1/2
exp

−|F|2
2 

.
(2.5)
Equation 2.5 is known as the centric distribution of the structure factors.
Let us now discuss equations (2.4) and (2.5). Both distributions are structure
and data resolution dependent: that is immediately evident if we calculate the
expected value of <|F|2 >, say
<|F|2 > =
	 ∞
0
|F|2 P(|F|)d|F|.
For both distributions, <|F|2 > =  and  depends on the number of atoms,
on the atomic species present in the unit cell, and on the sin θ/λ value at which
the average is calculated.
Distributions (2.4) and (2.5) should be of more general usefulness if they
could be transformed into universal (i.e. structure and data resolution inde-
pendent) distributions. To obtain such a result we only need to normalize the

Structure factor statistics in P1 and P ¯1
31
variable F, by remembering that a variable y is normalized by dividing it
by <y2>1/2. In our case we should replace F by the normalized structure
factor,
E = F

 1/2
.
(2.6)
The corresponding distributions are (from now on R = |E|)
1P(R) = 2R exp

−R2
(2.7)
and
¯1P(R) =
 2
π
1/2
exp

−R2
2

.
(2.8)
Distributions (2.7) and (2.8) are known as acentric and centric distributions of
the normalized structure factors, respectively and do not vary with structure
complexity and data resolution: in some way they have a universal character,
and they are represented in Fig. 2.1.
We now take a few lines to better describe the meaning of E and of the two
curves in Fig. 2.1. In a more explicit form, deﬁnition (2.6) may be rewritten as
E =
F
N
j=1 f 2
j
1/2 =
N
j=1 νj exp

2πi h · rj

,
(2.9)
where νj = fj/( )1/2. Equation (2.9) suggests that the normalized scattering
factor νj:
(i) does not change practically with sin θ/λ. Since atomic scattering factors
decay in a similar way (provided they have a similar temperature factor;
see Fig. 1.7), νj may be approximated as
νj = fj

  1/2
≈Zj

 N
j=1 Z2
j
1/2
;
(ii) is perfectly constant if all the atoms in the unit cell are of one species and
with the same thermal factor: then νj = 1/
√
N.
1
0.8
0.6
0.4
P(½E½)
1P(½E½)
-
½E½
0.2
1
2
3
4
5
1P(½E½)
Fig. 2.1
1P(|E|) (dashed line) and ¯1P(|E|) (solid
line).

32
Wilson statistics
The normalization is therefore equivalent to assuming the atoms to be point
scatterers, the scattering amplitude of which no longer varies with sin θ/λ.
The plots in Fig. 2.1 may easily be interpreted by recalling that each distri-
bution provides the expected percentage of reﬂections with R lying in a given
interval (generally speaking, for good distributions such a percentage should
correspond well with the experimental frequency). In Fig. 2.1 we emphas-
ize the area below the distribution (2.8) in the R-interval (2.0–2.3): this area
provides in P¯1 the percentage of reﬂections which are expected to have R in
the interval (2.0–2.3). We will see later in this section that this property also
holds for all centric space groups. In the same ﬁgure we emphasize the area
below the distribution (2.7) in the R-interval (1.0–1.3). Again the area repres-
ents in P1 the percentage of structure factors which are expected to have R
in that interval. We will see later in this section that this property also holds
for all acentric space groups. By generalizing the above statement, we say that
P(R)dR represents the percentage of normalized structure factors with modu-
lus lying in a quite small interval around the chosen R value. Consequently, the
full area below each distribution is equal to unity, by deﬁnition.
Distributions (2.7) and (2.8) show remarkable differences. Indeed: (i) at
R = 0, (2.7) attains a minimum and (2.8) a maximum; (ii) the maximum of
(2.7) is at R = 1/
√
2 = 0.707; (iii) for both distributions values of R larger
than 3 are not very probable, but the expected percentage of structure factors
with R >3 is signiﬁcantly larger for centric distributions.
Why are (2.7) and (2.8) so different? The main reason is as follows:
(2.7) derives from (2.2), which is a two-dimensional distribution (indeed F
is a complex variable, with real and imaginary components), while for cent-
ric groups F is a one-dimensional real variable. If this explanation is correct,
we should expect that the distributions for acentric space groups should be
more similar to (2.7) than to (2.8): the reverse should be true for centric space
groups. This is what we derive mathematically in Appendix 2.B. In particu-
lar, the calculations indicate that the most general distribution for any acentric
crystal is
1P(|F|) = 2|F|
p  exp

−|F|2
p 

(2.10)
and the most general distribution for any centric crystal is
¯1P(|F|) =

2
πp 
1/2
exp

−|F|2
2p 

,
(2.11)
where
p(h) = τε(h)
(2.12)
is the classical h dependent Wilson weight.
p is the product of two parameters: τ, which is the multiplicity of the lattice
(or number of lattice points per unit cell; see Table 1.1) and ε(h), which is the
order of the point group which leaves h unchanged. That is to say, if m is the
number of symmetry operators of the space group, m/ε(h) is the number of
distinct symmetry equivalent reﬂections; see Appendix 2.B). Table 2.1 shows
the ε values for all of the point groups.

Structure factor statistics in P1 and P ¯1
33
Table 2.1 Values of ε for all point groups (for non-primitive unit cells, all ﬁgures must be
multiplied by τ, the multiplicity of the lattice, to obtain the Wilson weight p)
(i) Triclinic, monoclinic, orthorhombic
Point group
hkl
0kl
h0l
hk0
h00
0k0
00l
1
1
1
1
1
1
1
1
¯1
1
1
1
1
1
1
1
2†
1
1
1
1
1
2
1
m†
1
1
2
1
2
1
2
2/m†
1
1
2
1
2
2
2
222
1
1
1
1
2
2
2
mm2‡
1
2
2
1
2
2
4
mmm
1
2
2
2
4
4
4
(ii) Tetragonal
Point group
hkl
h0l,0kl
hhl, h¯hl
hk0
hh0, h¯h0
h00, 0k0
00l
4
1
1
1
1
1
1
4
¯4
1
1
1
1
1
1
2
4/m
1
1
1
2
2
2
4
422
1
1
1
1
2
2
4
4mm
1
2
2
1
2
2
8
¯42m
1
1
2
1
2
2
4
¯4m2
1
2
1
1
2
2
4
4/mmm
1
2
2
2
4
4
8
(iii) Trigonal and hexagonal
(a) Hexagonal cell
Point group
hkl
hk0
hhl, h, 2¯h, l hh0, h, 2¯h, 0 h0l, 0kl
h00, 0k0
2h, ¯h, l
2h, ¯h, 0
h¯hl
h¯h0
00l
3
1
1
1
1
1
1
3
¯3
1
1
1
1
1
1
3
312
1
1
1
1
1
2
3
321
1
1
1
2
1
1
3
31m
1
1
2
2
1
1
6
3m1
1
1
1
1
2
2
6
¯31m
1
1
2
2
1
2
6
¯3m1
1
1
1
2
2
2
6
6
1
1
1
1
1
1
6
¯6
1
2
1
2
1
2
3
6/m
1
2
1
2
1
2
6
622
1
1
1
2
1
2
6
6mm
1
1
2
2
2
2
12
¯6m2
1
2
1
2
2
4
6
¯62m
1
2
2
4
1
2
6
6/mmm
1
2
2
4
2
4
12

34
Wilson statistics
Table 2.1 (Continued)
(b) Primitive rhombohedral cell
Point group
hkl
0kl, h0l, hk0
h¯hl, hk¯h, h¯ll
hhl, hkh, hll
hh0, h0h, 0ll
¯hhh, h¯hh, hh¯h
h00, 0k0, 00l
h¯h0, h0¯h, 0¯ll
hhh
3
1
1
1
3
¯3
1
1
1
3
32
1
1
2
3
3m
1
2
1
6
¯3m
1
2
2
6
(iv) Cubic
Point group
hkl
hhl, h¯hl,
hkh, hk¯h,
hll, h¯ll
hhh
¯hhh, h¯hh, hh¯h
0kl
h0l
hk0
hh0, h¯h0
h0h, h0¯h
0ll, 0¯ll
h00, 0k0, 00l
23
1
1
3
1
1
2
m3
1
1
3
2
2
4
432
1
1
3
1
2
4
¯43m
1
2
6
1
2
4
m3m
1
2
6
2
4
8
† b-axis unique.
† c-axis unique.
If <|F|2 > is calculated for distributions (2.10) and (2.11) we obtain the
following relation:
<|Fh|2 > = ph

.
(2.13)
If we normalize the variable |F|2 according to (2.13), the normalized structure
factor may be deﬁned in the most general way as
Eh = Fh

 
ph
 1/2
.
(2.14)
The deﬁnition (2.6), valid for triclinic symmetry, is a special case of (2.14).
Accordingly, if F-distributions are transformed into E-distributions accord-
ing to (2.14), equations (2.10) and (2.11) reduce to the acentric distribution
(2.7) and to the centric distribution (2.8), respectively. It may be concluded
that the distributions (2.7) and (2.8) are valid for any space group provided
that the normalization is made according to (2.14).
It is important to advise the reader that normalizing according to (2.14) can-
not be performed in practice without having ﬁrst solved two problems: how to
estimate the scale of the experimental intensities (these are usually on an arbit-
rary scale) and temperature displacements of the atoms (indeed  includes
the scattering factors modiﬁed by thermal movements). Both of these problems
will be solved in Section 2.8.

Cumulative distributions
35
2.4
The P(z) distributions
When y is a function of x, x being a random variable, the equality
P(y) dy = P(x) d [y(x)]
holds. The above relation may help us to derive the so-called P(z) distributions
where z = R2. We have
1P(z) = exp(−z)
(2.15)
and
¯1P(z) = (2πz)−1/2 exp

−z
2

,
(2.16)
which are illustrated in Fig. 2.2.
2.5
Cumulative distributions
Let us calculate the expected percentage of reﬂections with R smaller than a
given threshold (cumulative distribution). This is deﬁned as
N(R) =
	 R
0
P(t)dt
and is easily calculated for acentric and centric distributions (2.7) and (2.8):
1N(R) =
	 R
0
2t exp(−t2)dt = 1 −exp(−R2)
(2.17)
¯1N(R) =

2
π
	 R
0
exp

−t2
2

dt = erf
 R
√
2

,
(2.18)
1.2
1.0
0.8
0.6
P(z)
0.4
0.2
1.0
2.0
z
3.0
4.0
5.0
1P(z)
1P(z)
-
Fig. 2.2
The P(z) distribution for cs. and n.cs.
crystals.

36
Wilson statistics
1.0
0.5
1.0
2.0
3.0
½E½
N (½E½)
-
1N (½E½)
1N (½E½)
Fig. 2.3
The N(|E|) distribution for cs. and n.cs.
crystals.
where erf(x) is the error function, deﬁned by
2
√π
	 x
0
exp(−t2)dt.
(2.19)
erf is extensively tabulated in the literature (see for example, Abramowitz and
Stegun 1972, pp. 310–311). 1N(R) and ¯1N(R) are illustrated in Fig. 2.3.
The corresponding cumulative distributions for z = R2 are (see equations
(2.15) and (2.16)):
1N(z) =
	 z
0
exp(−t)dt = 1 −exp(−z)
(2.20)
¯1N(z) =
1
√
2π
	 z
0
t−1/2 exp

−t
2

dt
=
2
√
2π
	 √z
0
exp

−u2
2

du
= erf
 z
2.
(2.21)
The respective plots are illustrated in Fig. 2.4.
Cumulative distributions are less sensitive to sampling problems, and may
be used to discriminate centric from acentric structures; they are also used in
histogram matching procedures (see Section 8.2 and Appendix 8.B).
2.6
Space group identiﬁcation
Space group identiﬁcation is one of the ﬁrst problems encountered during phas-
ing procedures. It is based on the relations which allow the discovery of the
symmetry from the diffraction data analysis, and in a more general sense, on
the distribution of the normalized structure factors.
Let us suppose that the unit cell has been determined from the diffraction
experiment (in practice, from the positions of the reciprocal lattice points).
Then the crystal system may tentatively be assigned as the one with the largest

Space group identiﬁcation
37
1N (z)
-
1N (z)
-
1.0
0.8
0.6
0.4
0.2
1.0
2.0
3.0
4.0
5.0
6.0
z
N (z)
Figure. 2.4
The N(z) distribution for cs. and n.cs.
crystals.
symmetry that is compatible with the metric relations between the unit cell
parameters. For example, if the following parameters:
a = 11.10(2) ,
b = 11.11(3) ,
c = 9.72(2)
α = 90.25(37) ,
β = 89.48(30) ,
γ = 90.32(35)
(2.22)
have been measured, then the conclusion may be: the unit cell is probably tet-
ragonal. The unit cell geometry, however, may simulate a lattice symmetry
higher than the structure symmetry: e.g. the crystal may be orthorhombic with,
occasionally, a close to b, or monoclinic with, occasionally, a close to b and
the β angle occasionally close to 90◦. At this stage, therefore, it is not pos-
sible to make a deﬁnitive decision about the crystal system: none of the crystal
systems with unit cells compatible with that experimentally estimated (we
will call them feasible systems) can be excluded. In the case above, besides
the orthogonal pseudo-tetragonal cell, all monoclinic settings, 112/m, 12/m1,
2/m11, compatible with the proposed unit cell, should also be considered to be
feasible. A triclinic pseudo-tetragonal cell is also feasible!
To conﬁrm the identity of the crystal system it is necessary to identify
the Laue group (see Section 1.5): this requires that all the reﬂections con-
tained in the allowed reciprocal lattice sphere (eventually, Friedel opposites
excluded) should be measured. For each feasible crystal system the list of com-
patible Laue groups (we will denote them as admitted Laue groups) should be
checked. For example, in the case of (2.22) above, the tetragonal Laue groups
4/m and 4/mmm, the orthorhombic group mmm, and the monoclinic settings
112 /m, 12 /m1, 2 /m11 should be checked. Only if the Laue groups 4/m or
4/mmm are conﬁrmed by the analysis of data may the tetragonal crystal system
be accepted.
How is the Laue group identiﬁed? For each ith admitted Laue group, the
internal residual factor
Rint(i), given by
Rint(i) =
 ||Fobsh| −⟨|Fobsh|⟩|
 |Fobsh|
,
(2.23)

38
Wilson statistics
is calculated, where
⟨|Fobs|⟩=

h wh |Fobsh|
 wh
is the average diffraction modulus. The summation in equation 2.23 goes over
all of the measured reﬂections, and provides an overall estimate of the discrep-
ancy among symmetry equivalent reﬂections; the second is over the subset of
symmetry equivalent reﬂections (as deﬁned by the current ith Laue group) to
the unique reﬂection h. w is a weight dependent upon measurement accuracy.
The most probable Laue group is expected to be that with the smallest value
of Rint.
For example, for the unit cell (2.22), the symmetry equivalent reﬂections for
the Laue class 4/m are
(hkl), (¯h¯kl), (¯khl), (k¯hl), (¯h¯k¯l), (hk¯l), (k¯h¯l), (¯kh¯l)
They are expected to have the same diffraction intensity, and therefore
Rint(4/m) is expected to be quite small. If we obtain, experimentally, a small
value of Rint (e.g. Rint(4/m) = 0.04), then we can accept the Laue group and,
simultaneously, the tetragonal crystal system.
But, if the 16 reﬂections
(hkl), (¯h¯kl), (¯khl), (k¯hl), (¯h¯k¯l), (hk¯l), (k¯h¯l), (¯kh¯l),
(¯hk¯l), (h¯k¯l), (kh¯l), (¯k¯h¯l), (h¯kl), (¯hkl), (¯k¯hl), (khl)
symmetry equivalent in 4/mmm, have nearly the same intensity (and we there-
fore obtain for them Rint(4/mmm) = 0.05), then the Laue group 4/mmm may
be preferred and the tetragonal system is accepted.
The above analysis may be performed automatically and the procedure may
end with a probability PL(i), based on the corresponding Rint value, for each
ith admitted Laue group.
A further step is needed for identiﬁcation of the space group. Indeed, if the
phases could be observed in the diffraction experiment, the space group sym-
metry information should be totally transferred in the reciprocal space. But,
since the phases cannot be observed (at least for X-ray and neutron diffrac-
tion), the symmetry of the diffraction moduli does not completely deﬁne the
space group symmetry of the crystal. Diffraction symbols were introduced by
Buerger (1942) in order to specify which symmetries were able to be revealed
from a diffraction pattern. These were subsequently thoroughly discussed by
numerous authors, among whom are West (1954), Nowacki (1955), Donnay
and Kennard (1964), and Buerger himself (Buerger, 1969). In the International
Tables for Crystallography, vol. A (2005), a total of 122 extinction symbols
are reported (see Table 2.2 for some examples), each formed by a short string
indicating, successively, the lattice type, and, in the same order of the sym-
metry elements deﬁning the Laue group, the symmetry elements. Symmetry
directions without reﬂection conditions are represented by a dash; a symmetry
direction with reﬂection condition is represented by the symbol of the glide
plane or of the screw axis. Only 58 space groups and 11 enantiomorph pairs
may be determined uniquely by examination of the diffraction pattern and of
systematic absences.

Space group identiﬁcation
39
Table 2.2 Some examples of extinction symbols and corresponding space groups. It may be
observed that the same extinction symbol may be used for different crystal systems
In the orthorhombic system
P - - -
P222,
Pmmm,
Pm2m,
P2mm, Pmm2
P - - a
Pm2a,
P21ma,
Pmma
In the tetragonal system
P - - -
P4,
P-4, P4/m,
P422,
P4mm,
P-42m,
P-4m2, P4/mmm
In the hexagonal system
P61- -
P61,
P65,
P6122, P6522
To identify the extinction symbol a probabilistic approach may be followed:
for single crystal data the corresponding algorithms are usually implemented
within the diffractometer software. We will refer here to the algorithm pro-
posed by Altomare et al. (2004, 2005, 2007) and by Camalli et al. (2012): for
each ith admitted Laue group, the z statistics (z = R2) may be used to deﬁne
the probability PEX(i, j) for each associated jth extinction symbol (PEX(i, j)
emphasizes the connection with the Laue group probability). Then,
PEX( i, j ) = PL( i )PEX( j )
(2.24)
The most probable extinction symbol is expected to be associated with the
largest value of PEX(i, j).
A simple example illustrates how PEX(j) may be obtained. Let us consider
the orthorhombic system, where any space group may be represented by the
general string
M r1/s1 r2/s2 r3/s3.
(2.25)
M denotes the unit cell type (primitive or centred), rj, j = 1, . . . , 3 are the sym-
metry elements along the three axes and sj, j = 1, . . . , 3 are the symmetry
elements perpendicular to the axes. To identify the correct extinction sym-
bol the z-distributions along reciprocal axes and in reciprocal lattice planes
perpendicular to direct axes should be checked. Such distributions provide
the occurrence probability for screw axes and glide planes, and, equivalently,
complementary probabilities for rotation axes and mirror planes.
Let us consider the extinction symbol Bb-b. Its probability PEX (Bb-b)
is deﬁned as (see International Tables for Crystallography, 2005, p. 49,
Table 3.1.4.1)
PEX (Bb-b) = p(B) p(21[100]) p(b,c⊥a) p(21[010]) p(n⊥b) p(21[001]) p(a,b⊥c).
p(B), the probability of the B-cell, is obtained by ﬁrst calculating
p′(A) = 1 −<zhkl >k + l = 2n + 1
<zhkl >k + l = 2n
,
p′(B) = 1 −<zhkl >h + l = 2n + 1
<zhkl >h + l = 2n
,
p′(C) = 1 −<zhkl >h + k = 2n + 1
<zhkl >h + k = 2n
,
from which the probability
p(B) = p′(B)

1 −p′(A)
 
1 −p′(C)

(2.26)

40
Wilson statistics
Table 2.3 PMRU52. Statistical analysis for deriving the elementary probabilities for symmetry operators with translational component,
according to the program SIR2011 (Burla et al., 2012a). For each class of reﬂections containing potential systematic absent reﬂections (Class),
the table shows: the number of measured reﬂections (NRcl), the corresponding <z>cl value, and, for each subclass deﬁned by condition, the
corresponding number of reﬂections (NRscl) and the average value <z>scl are calculated. In the last column the resulting symmetry operator is
given
Class
NRcl
<z>cl
condition
NRscl
<z>scl
Sym.op.
h 0 0
18
0.366
h̸=2n
7
0.01
21 _ _
h=2n
11
0.60
h̸=4n
11
0.42
______
h=4n
7
0.28
0 k 0
33
0.506
k̸=2n
16
0.01
_ 21 _
k=2n
17
0.98
k̸=4n
23
0.16
______
k=4n
10
1.30
0 0 l
26
0.364
l̸=2n
13
0.01
_ _ 21
l=2n
13
0.72
l̸=4n
19
0.39
______
l=4n
7
0.28
0 k l
869
0.494
k̸=2n
385
0.01
b _ _
k=2n
484
0.88
l̸=2n
433
0.51
c _ _
l=2n
436
0.47
k̸=2n,l̸=2n
630
0.36
______
k=2n,l=2n
239
0.86
k+l̸=2n
442
0.50
n _ _
k+l=2n
427
0.48
k̸=2n,l̸=2n,k+l̸=4n
750
0.45
d _ _
k=2n,l=2n,k+l=4n
119
0.80
h 0 l
494
0.530
h̸=2n
239
0.56
_ a _
h=2n
255
0.50
l̸=2n
218
0.01
_ c _
l=2n
276
0.94
h̸=2n,l̸=2n
349
0.39
______
h=2n,l=2n
145
0.87
h+l̸=2n
241
0.56
_ n _
h+l=2n
253
0.50
h̸=2n,l̸=2n,h+l̸=4n
418
0.47
_ d _
h=2n,l=2n,h+l=4n
76
0.88
h k 0
625
0.526
h̸=2n
273
0.01
_ _ a
h=2n
352
0.93
k̸=2n
313
0.51
_ _ b
k=2n
312
0.54
h̸=2n,k̸=2n
447
0.36
______
h=2n,k=2n
178
0.94
h+k̸=2n
308
0.52
_ _ n
h+k=2n
317
0.53
h̸=2n,k̸=2n,h+k̸=4n
533
0.49
_ _ d
h=2n,k=2n,h+k=4n
92
0.71

Space group identiﬁcation
41
Table 2.3 (Continued)
Class
NRcl
<z>cl
condition
NRscl
<z>scl
Sym.op.
h k l
15395
0.969
h+k̸=2n
7627
1.00
C lattice
h+k=2n
7768
0.94
k+l̸=2n
7710
0.98
A lattice
k+l=2n
7685
0.96
h+l̸=2n
7639
0.95
B lattice
h+l=2n
7756
0.98
h+k+l̸=2n
7692
0.99
I lattice
h+k+l=2n
7703
0.95
(h+k,k+l,h+l)̸=2n
11 488
0.98
F lattice
(h+k,k+l,h+l)=2n
3907
0.95
is obtained. The multiplication on the right-hand side of equation (2.26) arises
from the fact that in the orthorhombic system an F-cell is also allowed.
Furthermore,
p

21[100]

= 1 −<zh00 >h = 2n + 1
<zh00 >h = 2n
,
p

21[010]

= 1 −<z0k0 >k = 2n + 1
<z0k0 >k = 2n
,
p

21[001]

= 1 −<z00l >l = 2n + 1
<z00l >l = 2n
and equivalently,
p

2[100]

= 1 −p

21[100]

, p

2[010]

= 1 −p

21[010]

, p

2[001]

= 1 −p

21[001]

,
p(n⊥b) = 1 −<zh0l >h + l = 2n + 1
<zh0l >h + l = 2n
, etc.
The composition of the above elementary probabilities provides the value of
PEX, and therefore, according to (2.24), of PEX( i, j ).
To provide experimental evidence of the algorithm described above, we
apply it to the diffraction data for PMRU52, C26 H48 Cl4 N8 O5 Ru2 S8, space
group Pbca. In Table 2.3 we show the statistical results obtained for each
class of reﬂections with potential systematic absent reﬂections. The element-
ary probabilities described above may easily be calculated from the entries in
the table.
For example, the elementary probabilities
p(21[001]) = 1 −<z00l >l=2n+1
<z00l >l=2n
,
p

21[100]

= 1 −<zh00 >h = 2n + 1
<zh00 >h = 2n
,
p

21[010]

= 1 −<z0k0 >k = 2n + 1
<z0k0 >k = 2n
,
p

21[001]

= 1 −<z00l >l = 2n + 1
<z00l >l = 2n
are very close to 1 for the three screw axes: indeed the <z>scl are very close
to zero for the reﬂections conditioned by the presence of the screw axes.
As a result, SIR2011 provides a list of the most probable extinction
symbols: the ﬁrst ten in the list, together with their probabilities, are shown in
Table 2.4.
Table 2.4 PMRU52. PEX(i, j) for the
10 most probable extinction symbols, as
estimated by SIR2011
Extinction symbol
PEX(i, j)
P b c a
0.639
P b n a
0.065
P n c a
0.064
P b c n
0.064
P b _ a
0.007
P b a a
0.007
P _ c a
0.007
P c c a
0.007
P b c b
0.007
P b c _
0.007

42
Wilson statistics
2.7
The centric or acentric nature of crystals:
Wilson statistical analysis
As stated in Section 2.6, a limited number of space groups may be uniquely
determined by examination of the diffraction pattern and of systematic
absences; it is not possible (on the basis of the above theory) to select a
space group among those belonging to the same extinction symbol. In earlier
times, when crystal structure solution for small molecules was time consum-
ing, knowledge about which was the correct space group was a great help
towards avoiding long phasing attempts in the wrong space groups. Thus,
physical experiments were frequently used to reveal the acentric nature of
the crystals, such as piro- and piezoelectric effects, optical activity, second
harmonic effects, etc.
Nowadays, phasing is much more straightforward, particularly for small
molecules and a few attempts in the wrong space groups that are compatible
with the diffraction symbol are not generally considered to be a great waste
of time and ancillary physical experiments are unusual. All permitted space
groups are attempted in some preferred sequence. Still frequently used today,
Wilson statistics (originally proposed by Foster and Hargreaves (1963a,b) and
by Srinivasan and Subramanian (1964)) deﬁne the centric or acentric nature
of the crystal. For example, the test allows us to distinguish between P1 and
P-1, or between the centric P2/m and the pair of acentric space groups P2 and
Pm. The simplest procedure involves calculation of the ﬁrst moments of the
experimental distribution of the normalized data, followed by comparison with
theoretical moments calculated for the ideal centric and acentric distributions.
In Table 2.5 the most useful moments of P(R) are quoted. The reader may
either derive these from appropriate integrations or by following the techniques
deﬁned in Appendix M.B.
Table 2.5
Statistical criteria (in terms of |E|) based on low-order
moments to discriminate cs. from n.cs. distributions.: R(|E|) = 1 −N(|E|)
is the percentage of normalized structure factors with amplitude greater than
the threshold |E|
Criterion
cs. distribution
n.cs. distribution
⟨|E|⟩
0.798 = (2/π)1/2
0.886 = π1/2/2

|E|2
1.000
1.000

|E|3
1.596 = 23/2/π1/2
1.329 = 3π1/2/4

|E|4
3.000
2.000

|E|5
6.383
3.323

|E|6
15.000
6.000

|E2 −1|

0.968
0.736

(E2 −1)2
2.000
1.000

(E2 −1)3
8.000
2.000

|E2 −1|3
8.691
2.415
R(1)
0.320
0.368
R(2)
0.050
0.018
R(3)
0.003
0.0001

Absolute scaling of intensities: the Wilson plot
43
It is apparent from Table 2.5 that for higher-order moments, differences
between the corresponding values of the two distributions show a very marked
increase. At ﬁrst sight one might infer that, in order to identify the type of
experimental distribution, the indications from the low-order moments are
of little or no use. In practice, the effects of errors in experimental meas-
urements, presence of pseudosymmetry, errors in the Wilson analysis, etc.,
become more critical with increasing order of moments, and therefore it is
not safe to consider moments of order greater than four or ﬁve.
It is worth mentioning that all of the reﬂections should be used in the above
statistical calculations; indeed systematic errors arise if (in order to spare data
collection time) the weakest reﬂections remain unmeasured, and therefore out
of the calculations (Rogers et al., 1955; Vickovi´c and Viterbo, 1979; Cascarano
et al., 1991).
Another practical problem concerns negative intensity measurements: what
to do with them? They cannot be ignored or omitted from the dataset: usually
they are set to zero (Hirshfeld and Rabinovich, 1973; Wilson, 1978). French
and Wilson (1978) provided, by means of Bayesian statistics, a technique for
obtaining an a posteriori positive estimation of the intensity from the negative
intensity and its associated standard deviation.
2.8
Absolute scaling of intensities:
the Wilson plot
It is well known that experimental intensities are on a relative scale. Their val-
ues depend on several factors: the direct beam intensity, radiation wavelength,
ﬁlm or counter efﬁciency, exposure time, etc. In this section we show how it
is possible, from the experimental intensities Ih (already corrected for Lorentz
polarization, absorption effect, etc.), to obtain |Fh|2 on an absolute scale:
Ih = K|Fh|2,
(2.27)
where K is the required scale factor.
Fig. 2.5
Partition of a two-dimensional lattice into
resolution shells, to approximately satisfy
the following conditions: (a) the variation
of f in each shell is negligible; (b) the
number of lattice points in each shell is
approximately constant.
Following Wilson (1942) we will show that it is also possible to infer an
approximate value for the average thermal factor. In this context it is necessary
to assume that the thermal parameter is isotropic and constant for each atom,
i.e. with obvious notation,
fj = 0fj exp

−B sin2 θ
λ2

.
(2.28)
In reality, this is not strictly true, since atoms belonging to the same atomic
species may have quite different thermal displacements. Furthermore there are
usually different atomic species present in the unit cell, chemical bonds are dir-
ectional, ellipsoids rather than spheres would be more representative of thermal
displacements.
Let us divide the reciprocal space into shells (spherical shells for three-
dimensional data; see Fig. 2.5 for a two-dimensional lattice), each shell being
sufﬁciently thin such that the variation of fj in each is negligible, and let us
take the average of Ih over the vth shell. If we assume, for the moment, that all

44
Wilson statistics
of the reﬂections to be averaged are statistically homogeneous, with statistical
weight p = 1, we obtain
<I > = K

ν .
The subscript v denotes that the summation
N
j=1 f 2
j
is calculated by assigning to each fj the value corresponding to the particular

sin2 θ/λ2
ν representative of the vth shell. According to (2.13) we can write
<I >ν = K
N
j=1
 0f 2
j

ν exp

−2B

sin2 θ
λ2

ν

,
which may be rewritten in logarithmic form as
ln
<I >ν
0 
ν

= ln K −2B

sin2 θ
λ2

ν
,
where
0 
ν =
N
j=1
 0f 2
j

ν .
If we plot the values ln

<I >ν / 0
ν

versus the values

sin2 θ/λ2
ν we
should obtain a straight line with equation
ln
<I >ν
0 
ν

= ln K −2B

sin2 θ
λ2

.
(2.29)
The intercept of (2.29) on the vertical axis yields the value of the scale factor K:
K =
lim
sin2 θ/λ2→0
<I >ν
0 
ν

;
2B is the angular coefﬁcient of the straight line (2.29).
In practice, for various reasons (some of which will be examined in the next
section), the experimental values are not rigorously aligned: the best evaluation
of K and B is therefore obtained by deriving the least squares line.
Derivation of (2.29) is not so simple when, as is usually the case, we
have coexistence of groups of reﬂections which are not statistically homo-
geneous, that is, groups of reﬂections having different statistical weights.
It is possible to overcome this difﬁculty by introducing the reduced intensity
Irh = Ih/ph; in this way we may obtain the same mean value for each group.
Equation 2.29 may then be rewritten as:
ln
<Ir >ν
0 
ν

= ln K −2B

sin2 θ
λ2

.
(2.30)

Absolute scaling of intensities: the Wilson plot
45
We will now consider in more detail the practical procedure usually employed
by the Wilson method. This may be described schematically as follows.
Firstly, the reciprocal space is divided into n shells of approximately equal
volume and including, on average, equal numbers of reﬂections. The number of
reﬂections must be sufﬁcient to be statistically representative but, at the same
time, the variation of scattering factor with sin θ/λ must be negligible. The lim-
iting radii of the spherical shells usually satisfy the formula (m/n)(sin θl/λ)3,
where θl is the largest θ angle for the measured reﬂections, n is the num-
ber of intervals into which the observed reciprocal space is subdivided, and
m = 1, . . . , n.
Secondly, the {sin θ/ λ}ν value, representative of the νth shell, may be
approximated in different ways (Rogers, 1965; Parthasarathi, 1975): i.e.
1
2(s1 + s2),
1
2

s2
1 + s2
2
1/2
,
where s1 and s2 are the extreme values of sin θ/λ for the reﬂections within the
shell.
Thirdly, within each spherical shell (particularly those characterized by high
sin θ/λ values), the number of observed reﬂections cannot be too small com-
pared to the number expected for that shell. Shells with too few observed
reﬂections must be left out of the statistical calculations, therefore θl has to be
redeﬁned. Control of the number of observed reﬂections is particularly import-
ant for organic compounds, which show a rapid decrease in intensities with
sin θ/λ, owing to the decrease in atomic scattering factors and to the relatively
high thermal vibration.
Fourthly, for each shell the average of the reduced intensities is calculated
and the values of
ln
<Ir >ν
0 
ν

versus sin2θ/λ2 should be displayed graphically. The least-squares line will
then give the best K and B values. Deviation of the experimental points from
the straight line (those due to sampling effects) may be reduced by combining
the quantities
ln
<Ir >ν
0 
ν

and sin2θ/λ2
for contiguous shells.
Finally, reﬂections with very low values of sin2θ/λ2 must be left out of
the statistics because the of the anomalous distribution of the variable ψ =
fcos(2πh·r). In fact, when the modulus of h is small, the cosine will take up
essentially positive values, so that <ψ> is no longer equal to zero even if
<η> = 0.
As a numerical example, in Table 2.6, we describe the calculations necessary
to obtain the Wilson plot of LOGANIN [P 212121, C17 H26 O10, Z = 4], shown
in Fig. 2.6. We observe the following:
1. Sixteen ranges of sin θ/λ are deﬁned: each range overlaps with its neigh-
bours (columns 1 and 2 of the table) to make the plot less sensitive to
sampling effects.

46
Wilson statistics
Table 2.6 LOGANIN: numerical values on which Fig. 2.6 is based. See the text for explanation of the symbols
Range
(sin θ/λ)2
v −(sin θ/λ)2
v+1
(NREFL)v
{(sin θ/λ)2}v
⟨Ir⟩v
0 
v
ln

⟨Ir⟩v
0 
v

1
0.0000–0.0563
397
0.0342
2027.0
2595.4
–0.2472
2
0.0281–0.0844
605
0.0589
1109.1
1652.8
–0.3989
3
0.0563–0.1125
742
0.0858
634.0
1228.1
–0.6612
4
0.0844–0.1406
865
0.1140
336.2
896.2
–0.9805
5
0.1125–0.1688
977
0.1414
286.2
703.2
–0.8990
6
0.1406–0.1969
1068
0.1698
276.2
588.8
–0.7569
7
0.1688–0.2250
1150
0.1978
232.7
514.4
–0.7932
8
0.1969–0.2532
1224
0.2260
159.9
458.5
–1.0534
9
0.2250–0.2813
1301
0.2540
99.0
411.6
–1.4250
10
0.2532–0.3094
1368
0.2821
68.3
377.2
–1.7089
11
0.2813–0.3375
1395
0.3098
53.6
350.3
–1.8771
12
0.3094–0.3657
1443
0.3382
43.6
328.7
–2.0201
13
0.3375–0.3938
1499
0.3663
37.6
309.1
–2.1066
14
0.3657–0.4219
1434
0.3940
34.3
294.8
–2.1511
15
0.3938–0.4500
1085
0.4176
31.8
282.6
–2.1847
16
0.4219–0.4500
402
0.4334
33.0
276.1
–2.1243
0.0
–2.4
–2.0
–1.6
–1.2
–0.8
–0.4
0.0
0.1
0.2
0.3
sin(θ/λ)2
0.4
0.5
In(ál /∑)
á
Fig. 2.6
Wilson plot for LOGANIN.
2. The number of reﬂections NREFL (symmetry dependent included) and
the (sin θ/λ)2 value representative of each ν shell are shown in columns
3 and 4.
3. Both the mean intensity <Ir >ν (column 5) and 0
ν (column 6) decrease
with sin θ/λ. <Ir >ν decreases because of the combined effect of the
intrinsic atomic scattering decay and the thermal motion, 0 
ν decreases
solely as an effect of the atomic scattering decay. The difference between
columns 5 and 6 provides information necessary to establish the average
thermal motion.
4. The set of points

ln(<Ir >ν /0
ν), (sin2 θ/λ2)ν

are plotted in Fig. 2.6,
together with the leastsquares straight line (2.30).

Shape of the Wilson plot
47
2.9
Shape of the Wilson plot
The Wilson approach is based on the assumption that the atomic positions
are uniformly distributed over the unit cell: in this case, and in the absence
of other sources of error, the Wilson plot should be close to a straight line.
In real cases, Wilson plots are observed to deviate from a straight line. When
some interatomic distances are very frequent because of structural regularities,
or when a few heavy atoms dominate the diffraction pattern, the deviations
will be stronger. In Figs. 2.7 and 2.8 we show the Wilson plots of two small
molecules, in code POCRO [B112/m, K2 Se16 Cr10, Z = 1] and HOV1 [C2/m,
Pr14 Ni6 Si11, Z = 4], which contain heavy atoms and/or suffer through pseudo-
translational symmetry: their plots show large deviations from linearity, much
larger than with LOGANIN.
0.0
–3.2
–2.8
–2.4
–2.0
–1.6
–1.2
–0.8
0.1
0.2
0.3
sin(θ/λ)2
0.4
0.5
In(ál /∑)
á
Fig. 2.7
Wilson plot for POCRO.
0.0
–1.0
–0.6
–0.2
0.2
0.6
1.0
1.4
0.1
0.2
0.3
sin(θ/λ)2
0.4
0.5
In(ál /∑)
á
Fig. 2.8
Wilson plot of HOV1.

48
Wilson statistics
Cascarano et al. (1992b) observed that the mathematical basis for explain-
ing deviations of the Wilson plot from a straight line, is the Debye formula,
a tool widely used in the diffraction theory of amorphous solids and liquids
(James, 1962; Guinier, 1963; Klug and Alexander, 1974; Magini et al., 1988).
According to Debye the following relation holds (see Appendix 2.C):
<|Fh|2 > =
N
j=1 f 2
j +
N
j1̸=j2=1 fj1fj2
sin(2πq|rj1 −rj2|)
2πq|rj1 −rj2|
,
(2.31)
where q = |h|. The average is calculated by assuming h to be ﬁxed, while the
positional vectors are random variables under the condition that the moduli
|rj1 −rj2| are ﬁxed (see (3) in Section 2.2). Equation (2.31) clearly shows that
<|Fh|2 > is an oscillating function whose maxima are in correspondence with
the strongest interatomic distances. Conversely, the most frequent interatomic
distances may be calculated by inverse Fourier transform of the Wilson plot.
A special study of protein Wilson plots has been made by Morris et al.
(2004). They examined plots of 700 high-resolution proteins by taking data
from the Protein Data Bank, using the PDB isotropic displacement factors,
and by taking occupancy into account. Wilson plots are very similar to each
other, in spite of the wide spread of secondary-structure characteristics: a typ-
ical curve is shown in Fig. 2.9 (solid line). All proteins show a local maximum
at ∼1.1 Å, a minimum at ∼1.67 Å, a small local maximum at ∼2.1 Å, a strong
local maximum at ∼4.5 Å, and a local minimum at 6.25 Å. The same authors
performed a similar analysis of 200 DNA/RNA-only structures sampled from
PDB. The curves are again similar to each other and a typical curve is shown
in Fig. 2.9 (dashed line).
Hall and Subramanian (1982a,b) showed that the Wilson procedure is rather
inefﬁcient when data are truncated at values of sin θ/λ where the Debye effects
are large; in this case an error in the estimated overall temperature factor, and
consequently in the scaling factor K, is obtained. In Fig. 2.10, two Wilson
plots are shown for the small protein APP: the ﬁrst (plot a) relates to data up
to derivative resolution (∼2 Å) and the second (plot b) is calculated by using
1.8
1.6
1.4
1.2
<R2>
1.0
5.0
3.3
2.5
1.43
1.1
1.25
1.0
2.0
1.67
d (Å)
0.8
0.6
0.4
Fig. 2.9
Typical <R2> curve versus d(Å) for pro-
teins (solid line). Typical <R2> curve
versus d(Å) for nucleic acid structures
(dashed line).

Unit cell content
49
0.000
0.40
0.80
1.20
1.60
2.00
2.40
0.012
0.024
sin(θ/λ)2
0.036
0.048
a)
b)
0.060
In(ál /∑)
á
Fig. 2.10
APP: (a) Wilson plot for native diffraction
data up to derivative resolution (∼2 Å);
(b) Wilson plot for native diffraction data
truncated at 4 Å resolution.
the same data, but truncated at 4 Å resolution. The quite different slopes of the
least squares straight lines indicate strong differences between the estimated
overall temperature factors B, and consequently, between the corresponding
scale factors K. The reason for the misﬁt must be found in the Debye effects: as
previously stated, the radial distribution of the diffracted intensities of proteins
always shows a strong local maximum at 4.5 Å and a local minimum at 6.25 Å.
These Debye effects are responsible for the wrong slope of the least squares
straight line calculated at 4 Å resolution.
If we generalize the above example, it may be concluded that shortage
of data (a frequent occurrence in macromolecular and occasionally in small
molecule crystallography) may strongly inﬂuence the accuracy of a Wilson
procedure. Since probabilistic prediction of structure factor moduli beyond
the measurement limit is still an inaccurate process in the absence of a high-
quality model, the most effective way to overcome the resolution problem is
to optimize experimental conditions (e.g. by using low temperature apparatus,
synchrotron radiation, etc.).
2.10
Unit cell content
The reader will certainly have noticed that it is necessary to know the chem-
ical content of the unit cell in order to calculate the Wilson plot; indeed such
content deﬁnes the parameters 0 
ν and 
ν at each Bragg angle. This chem-
ical content is also useful in the next steps of the phasing process. Indeed it
allows: (a) better estimation of the reliability of the structure invariants when
direct methods are used for crystal structure determination; (b) labelling (in a
chemical sense) of the electron density peaks and therefore easier interpreta-
tion of electron density maps; (c) convenience in performing crystallographic
least squares, where a structural model is reﬁned against the experimental
diffraction data.
The chemical composition of a molecule is usually known before the cor-
responding crystal is submitted to a diffraction experiment. For LOGANIN,

50
Wilson statistics
the example given in Section 2.8, the molecular chemical formula, C17 H26
O10, was probably known before structure solution was undertaken: but the
value of Z (i.e. the number of molecules in the unit cell) cannot be known
before the unit cell is determined using a diffraction experiment. The Z value
depends on how many molecules are in the asymmetric unit, and how many
symmetry equivalent copies are in the unit cell, governed by the space group
symmetry. Since we have learnt how to determine the space group symmetry,
we now have to learn how to deﬁne how many molecules are to be expec-
ted in the asymmetric unit (sometimes there may be more than ten molecules
present).
There is a simple algebraic tool for deﬁning how many molecules are in the
unit cell. It has been shown that, for small- to medium-sized molecules, the
volume per non-hydrogen atom Vat should lie in the range 15–19 Å3; for very
compact structures, a value of 14 Å3 may be reached. Let us apply this criterion
to LOGANIN, space group P212121. Its unit cell is deﬁned by
a = 8.187 Å, b = 14.277 Å, c = 15.693 Å, and volume V = 1834.29 Å3.
There are 27 non-hydrogen atoms in the molecular formula. If we choose
Z = 4 (i.e. one molecule in the asymmetric unit), then Vat = 1834.29/
(27 × 4) = 16.98 Å3, in full agreement with expectations. Obviously, if we
had chosen Z = 8 (two molecules in the asymmetric unit) then, Vat = 1834.29
/(27 x 8) = 8.49 Å3, in strong disagreement with expectations.
Let us consider the AZET structure, with molecular chemical formula
C21 H16 N1 O1 Cl1, space group Pca21, a = 36.042 Å, b = 8.730 Å, c =
11.084 Å, V = 3487.54 Å3. There are 24 non-hydrogen atoms in the molecular
formula: if we choose Z = 4 (that is one molecule per asymmetric unit), then
Vat = 36.3 Å3, far from expectations. If we choose Z = 8 (two molecules in the
asymmetric unit), then Vat = 18.16 Å3, in full agreement with expectations.
A different method should be applied to proteins, because their unit cell
contains a large solvent volume: the reader is referred to Appendix 8.A.
APPENDIX 2.A
STATISTICAL CALCUL ATIONS IN
P1 AND P¯1
2.A.1
Structure factor statistics in P1
According to equation (1.19), the structure factor in P1 may be partitioned into
a real and an imaginary component. Let us deﬁne
F =
N
j=1 fj exp(2πi h · rj) = A + iB,
and
fj exp(2πih · rj) = ψj + iηj,
with
ψj = fj cos

2πh · rj

,
ηj = fj sin

2πh · rj

.

Statistical calculations in P1 and P¯1
51
Let us evaluate the means

ψj

and

ηj

when h is ﬁxed and rj uniformly varies
in the unit cell. Since 2πh · rj is uniformly distributed over the trigonometric
circle, ψj and ηj have equal chances of assuming negative or positive values,
and therefore

ψj

= 0,

ηj

= 0.
The variances of ψj and ηj are, respectively,
α2
j =

ψj −

ψj
2
=

ψ2
j

= f 2
j

cos2 
2πh · rj

= 1
2f 2
j ,
β2
j =

ηj −

ηj
2
= 1
2f 2
j .
Provided that N is large enough, from the central limit theorem (see Appendix
M.A.6) the sum variables,
A =
N

j=1
ψj,
B =
N

j=1
ηj,
turn out have a normal distribution around the mean values,
N

j=1

ψj

= 0,
N

j=1

ηj

= 0,
and the α2 and β2 variances are
α2 =
N

j=1
α2
j = 1
2
N

j=1
f 2
j ,
β2 =
N

j=1
β2
j = 1
2
N

j=1
f 2
j .
Introducing the symbol

=
N

j=1
f 2
j ,
we may write
α2 = β2 = 1
2

.
Therefore (see equation (M.A.9)), the probability of the real part of a structure
factor ranging between A and A + dA is
1P(A)dA =
1

π  exp

−A2


dA,
where the preﬁxed subscript 1 indicates that the space group is P1. The
probability that the imaginary part of Fh lies between B and B + dB is
1P(B)dB =
1

π  exp

−B2


dB,

52
Wilson statistics
To a ﬁrst approximation, A and B may be assumed to be independent random
variables; the joint probability that the real part of Fh is restricted between A
and A + dA and the complex part between B and B + dB is then
1P(A, B)dAdB = 1P(A)1P(B)dAdB =
1
π  exp

−A2 + B2


dAdB.
(2.A.1)
If the structure factor is expressed in polar coordinates according to
A = |F| cos φ,
B = |F| sin φ,
then the relation (M.A.22) should be applied. Since the Jacobian of the
transformation is J = |F|, (2.A.1) becomes
1P(|F|, φ)d|F|dφ = |F|
π  exp

−|F|2


d|F|dφ.
(2.A.2)
which coincides with equation (2.2).
2.A.2
Structure factor statistics in P ¯1
In P¯1, for each atom in rj there is a symmetry equivalent atom in −rj. Therefore
Fh may be considered as the sum of N/2 random variables,
Fh =
N/2
j=1 2fj cos

2πh · rj

.
By analogy with the previously adopted notations, we deﬁne
ψj = 2fj cos

2πh · rj

.
It is easily seen that
<ψj > = 0,
α2
j = <(ψj−< ψj >)2 > = 2f 2
j
and hence,
α2 =
N/2
j=1 α2
j =
N
j=1 f 2
j =

.
On applying the central limit theorem once again, we deduce the relationship
¯1P(F) =

2π
 −1/2
exp

−|F|2
2 

(2.A.3)
where the preﬁxed subscript –1 indicates that we are referring to the space
group P−1. F has the same probability of being either positive or negative,
therefore the probability for its modulus is
¯1P(|F|) = 2 · ¯1P(F) =

2
π 
1/2
exp

−|F|2
2 

.
(2.A.4)
Equation (2.A.4) is known as the centric distribution of the structure factors,
and coincides with distribution (2.5).

Statistical calculations in any space group
53
APPENDIX 2.B
STATISTICAL CALCUL ATIONS IN
ANY SPACE GROUP
2.B.1
The algebraic form of the structure factor
In this section, the algebraic form of the structure factor will be described in
order to obtain, in Section 2.B.2, statistical formulas valid in all space groups.
Let us see how the space group symmetry speciﬁes the algebraic form of Fh.
The symmetry elements in a space group can be represented (Zachariasen,
1945; MacGillavry, 1950) by means of suitable operators Cs. These operators
will in general contain a (proper or improper) rotational component Rs and a
translational component Ts. It is possible to represent all positions rjs symmet-
rically equivalent to any initial position rj by means of the operators Cs. Let m
be the number of these operators; then
rjs = Rsrj + Ts,
s = 1, 2, . . . , m.
(2.B.1)
More explicitly,
rjs =
⎡
⎢⎢⎣
xjs
yjs
zjs
⎤
⎥⎥⎦=
⎡
⎢⎢⎣
Rs
11 Rs
12 Rs
13
Rs
21 Rs
22 Rs
23
Rs
31 Rs
32 Rs
33
⎤
⎥⎥⎦
⎡
⎢⎢⎣
xj
yj
zj
⎤
⎥⎥⎦+
⎡
⎢⎢⎣
Ts
x
Ts
y
Ts
z
⎤
⎥⎥⎦,
s = 1, 2, . . . , m,
or, in a shortened form emphasizing coordinates,
Xjs = RsXj + Ts.
m can assume values from 1 to 192. From now on the symbol R1 will indicate
the identity matrix I.
Fig. 2.B.1
P31 diagram.
Thus, in space group P31, shown in Fig. 2.B.1, when the origin is chosen to
lie on a threefold axis, the equivalent positions are given by
(x, y, z),

−y, x −y, 1
3 + z

,

−x + y, −x, 2
3 + z

and the corresponding symmetry operators are
R1 =
⎡
⎢⎢⎣
1
0
0
0
1
0
0
0
1
⎤
⎥⎥⎦,
T1 =
⎡
⎢⎢⎣
0
0
0
⎤
⎥⎥⎦,
R2 =
⎡
⎢⎢⎣
0
¯1
0
1
¯1
0
0
0
1
⎤
⎥⎥⎦, T2 =
⎡
⎢⎢⎣
0
0
1
3
⎤
⎥⎥⎦,
R3 =
⎡
⎢⎢⎣
¯1
1
0
¯1
0
0
0
0
1
⎤
⎥⎥⎦, T3 =
⎡
⎢⎢⎣
0
0
2
3
⎤
⎥⎥⎦,

54
Wilson statistics
From (1.19), the contribution to the structure factor of the jth atom and all its
equivalents can be expressed as ξj(h), where
ξj(h) = fj
mj

s=1
exp

2πi¯hCsrj

= fj
mj

s=1
cos

2π ¯hCsrj

+ ifj
mj

s=1
sin

2π ¯hCsrj

= ψj(h) + iηj(h).
(2.B.2)
The concise expression ¯hCr stands for
(h k l)
⎡
⎢⎢⎣
R11
R12
R13
R21
R22
R23
R31
R32
R33
⎤
⎥⎥⎦
⎡
⎢⎢⎣
x
y
z
⎤
⎥⎥⎦+ (h k l )
⎡
⎢⎢⎣
Tx
Ty
Tz
⎤
⎥⎥⎦= ¯HRX + ¯HT.
The equivalent notation ¯HRX + ¯HT emphasizes the components of the vector
h and the coordinates of r.
The bar on top of a matrix symbol indicates the transpose, and mj is the
number of distinct equivalent positions of the jth atom. In a form more suitable
for automatic computing (2.B.2) can be rewritten as
ξj(h) = fj
mj
m
m

s=1
exp

2πi¯hCsrj

,
(2.B.3)
where mj/m is the crystallographic occupancy factor of the jth atom. Thus,
with equation 2.B.3, it is possible to let s range from 1 to m, even when the
j th atom is in a special position. When mj < m the jth atom is said to be in a
special position.
ξj(h) is the Fourier transform of the set of symmetry equivalent atoms loc-
ated at Csrj, s = 1, . . . , m, and we shall refer to it as the trigonometric structure
factor.
When all the atoms are in a general position then t = N/m is the number of
symmetry independent atoms, and (1.19) becomes
Fh =
t
j=1
ξj(h) =
t
j=1
fj(h)
m

s=1
exp

2πi¯h(Rsrj + Ts)

.
(2.B.4)
In the case of a centrosymmetric (cs.) space group, ξj(h) can be expressed in
the simpliﬁed form,
ξj(h) = 2fj
m/2

s=1
cos

2π ¯hCsrj

and the algebraic form of Fh will be
Fh = 2
t

j=1
fj(h)
m/2

s=1
cos

2π ¯hCsrj

.
(2.B.5)

Statistical calculations in any space group
55
Let us consider a space group of order m with a primitive unit cell. If a reﬂec-
tion h has general indices (h, k, l), m distinct equivalent reﬂections ¯hR can be
found. For special values of (h, k, l) the number of distinct equivalent reﬂec-
tions may be m/εh, where εh is the order of the point group which leaves h
unchanged. In this case,
ξj(h) = εh fj
m/εh

s=1
exp

2πi¯hCsrj

.
(2.B.6)
For example, for all the space groups with point symmetry 222, ε = 2 for the
reﬂections (h00), (0k0), and (00l); for all the space groups with point sym-
metry mmm, ε = 2 for the reﬂections (hk0), (h0l), and (0kl), and ε = 4 for the
reﬂections (h00), (0k0), and (00l) (see Table 2.1).
For space groups with a centred unit cell we denote by τ the centring order
of the cell (τ= 2 for a face-centred or body-centred cell; τ = 4 for all-face-
centred cells; τ = 3 for a rhombohedral cell in hexagonal reference). Then,
the m rotation matrices will coincide in groups of τ and therefore only m/τ
matrices will be distinct. Accordingly,
Fh =
t

j=1
ξj(h) =
t

j=1
ψj(h) + i
t
j=1
ηj(h),
(2.B.7)
where
ξj(h) = fjph
m/ph

s=1
exp

2πi¯hCsrj

ψj(h) = fjph
m/ph

s=1
cos

2π ¯hCsrj

ηj(h) = fjph
m/ph

s=1
sin

2π ¯hCsrj

.
ph = τεh has an algebraic origin; however, since it plays an important role in
the statistics of the structure factor, it will be called the statistical weight of
the reﬂection h or the Wilson coefﬁcient. Equation 2.B.7 is the most general
expression we will use for the trigonometric structure factor.
2.B.2
Structure factor statistics for centric
and acentric space groups
In the presence of symmetry elements, the N atomic positions can no longer
be considered as randomly distributed within the unit cell; indeed an m-fold
symmetry element relates the coordinates of m atoms in the unit cell through
precise operations. However, if expression (2.B.7) is used, we may consider as
random variables only the positions of the t atoms in the asymmetric unit. If t
is large enough to warrant a uniform distribution of the arguments of ξ over the
trigonometric circle, the basic assumptions valid for space group P1 are also
valid for all of the other space groups.

56
Wilson statistics
We ﬁrst apply the central limit theorem to the acentric space groups with
primitive unit cell.
(a) Structure factor statistics for space groups with a primitive unit cell.
We will show that different distributions P(|F|) exist depending on the type of
reﬂection. Let us ﬁrst consider a reﬂection of the general type. According to
equation (2.B.7),
ψj = fj
m

s=1
cos

2π ¯hCsrj

,
ηj = fj
m

s=1
sin

2π ¯hCsrj

.
If the rjs are uniformly distributed in the unit cell,

ψj

=

ηj

= 0
α2
j ≡

ψ2
j

= f 2
j
m
s1,s2=1

cos

2π ¯hCs1rj

cos

2π ¯hCs2rj

= 1
2f 2
j
m
s1,s2=1

cos

2π ¯h(Cs1 −Cs2)rj

+

cos

2π ¯h(Cs1 −Cs2)rj

.
The terms for which s1 ̸= s2 do not contribute to the average, while for each of
the m terms for which s1 = s2, cos

2π ¯h(Cs1 −Cs2)rj

is always equal to unity,
no matter what is the value of rj. Thus,
α2
j = mf 2
j /2.
Similarly,
β2
j =

η2
j

= f 2
j
m

s1,s2=1

sin

2π ¯hCs1rj

sin

2π ¯hCs2rj

= mf 2
j /2.
Accordingly,
α2 =
t
j=1
α2
j = 1
2Nf 2
j = 1
2

β2 = 1
2
,
as in P1. In conclusion, for a reﬂection of the general type, the joint probability
densities P(A, B) and P(|F|) are identical to (2.A.1) and (2.4) respectively.
If Fh is a systematically absent reﬂection, then ξj(h) = 0 and therefore
P(Fh) = δ(Fh),
where δ is the Dirac delta function.

Statistical calculations in any space group
57
Let us now consider a systematically non-absent reﬂection with statistical
weight equal to ε (i.e. m/ε is the number of distinct symmetry equivalent
reﬂections). Then, according to (2.B.6),
ξj(h) = εfj
m/ε

s=1
exp

2πi¯hCsrj

.
(2.B.8)
By applying the central limit theorem, as in the preceding cases, we obtain
ψj = fjε
m/ε

s=1
cos

2π ¯hCsrj

,
ηj = fjε
m/ε

s=1
sin

2π ¯hCsrj

,

ψj

=

ηj

= 0,
α2
j =

ψ2
j

= εmf 2
j /2,
β2
j =

η2
j

= εmf 2
j /2,
α2 = ε

/2,
wβ2 = ε

/2,
1P(A)dA =
1

πε  exp −
 A2
ε 

dA,
1P(B)dB =
1

πε  exp −
 B2
ε 

dB,
1P(|F|) ≃2|F|
ε  exp

−|F|2
ε 

.
(2.B.9)
For reﬂections with ε > 1, (2.B.9) is seen to be different from (2.5). In partic-
ular (2.5) may be considered to be a special case of (2.B.9), obtainable when
ε = 1.
The above approach can be also applied to cs, space groups, for reﬂections
with ε > 1. One obtains
¯1P(|F|) =

2
πε 
1/2
exp

−|F|2
2ε 

.
(2.B.10)
(b) Structure factor statistics for space groups with a centred unit cell
According to (2.B.6) in an n.cs. space group with a centred cell,
ξj(h) = pfj
m/p

s=1
exp

2πi¯hCsrj

,

58
Wilson statistics
where p = τε is the statistical weight or Wilson coefﬁcient. If we denote
ψj = fjp
m/p

s=1
cos

2π ¯hCsrj

,
ηj = fjp
m/p

s=1
sin

2π ¯hCsrj

,
then

ψj

=

ηj

= 0,
α2 = β2 = p/2,
1P(A)dA =
1
√πp exp −
 A2
p

,
1P(B)dB =
1
√πp exp −
 B2
p

,
1P(|F|) ≃
	 2π
0
P(|F|, φ)dφ = 2|F|
p exp

−|F|2
p

.
(2.B.11)
Equation (2.B.11) is the most general distribution for an n.cs. space group. For
τ = 1, it reduces to (2.B.9) and for t = 1 and ε = 1, it reduces to (2.4).
Similar considerations for a cs. space group will lead to the distribution
¯1P(|F|) =

2
πp
1/2
exp

−|F|2
2p

.
(2.B.12)
This reduces to (2.5) for τ = 1 and to (1.25) for t = 1 and ε = 1.
y
r
φ
ϑ
z
x
Fig. 2.C.1
Polar and Cartesian coordinates.
APPENDIX 2.C
THE DEBYE FORMUL A
We want to calculate the expected value
<|Fh|2 > = < N
j1,j2=1 fj1fj2 exp

2πih · (rj1 −rj2)

>
= N
j = 1 f 2
j + < N
j1̸=j2 = 1 fj1fj2 exp

2πih · (rj1 −rj2)

>,
when h is ﬁxed and the atomic positions are random variables under the con-
dition that the moduli rj1j2 = |rj1 −rj2| are ﬁxed. To this purpose we introduce
the polar coordinates (see Fig. 2.C.1) deﬁned by
xj1j2 = rj1j2 sin φ cos θ
yj1j2 = rj1j2 sin φ sin θ
zj1j2 = rj1j2 cos θ
If we choose the z-axis along the h direction, then h · (rj1 −rj2) is equal to
qrj1j2 cos φ, where q = |h| and
<exp[2πi h · (rj1 −rj2)] > = 1
A
	 π
0
	 2π
0
exp

2πiqrj1j2 cos φ

r2
j1j2 sin φ dφ dθ.

The Debye formula
59
r2
j1j2 sin φ is the Jacobian of the transformation from Cartesian to polar axes,
and A = 4πr2
j1j2 is the area of the sphere of radius rj1j2. Simple calculations
bring us to
<exp

2πih · (rj1 −rj2)

> = 1
2
	 π
0
exp

2πiqrj1j2 cos φ

sin φ dφ
=
1
4πqirj1j2
exp

2πiqrj1j2 cos φ
0
π = sin

2πqrj1j2

2πqrj1j2
,
from which,
<|Fh|2 > =
N
j = 1 f 2
j +
N
j1̸=j2 = 1 fj1fj2
sin

2πqrj1j2

2πqrj1j2
(2.C.1)
The second term in (2.C.1) modulates the average value of |Fh|2and is
responsible for the ﬂuctuations (called Debye effects) in the Wilson plot.

The origin problem,
invariants, and
seminvariants
3
3.1
Introduction
In Section 1.6, the basic postulate of structural crystallography was formu-
lated, according to which there is a biunique correspondence between the
crystal structure and the set of experimental diffraction data:
crystal structure ⇔{|Fh|} .
Can this property be extended to phases? In more simple terms, is the following
logical relation valid?
crystal structure ⇔{φh} ?
(3.1)
If relation (3.1) is valid, only one set of phases should be compatible with
a given crystal structure. We will show in Section 3.2 that relation (3.1) is
false; there are more sets of phases that are compatible with the same crystal
structure. It will also be shown that such behaviour arises due to the origin
problem. The above conclusion suggests that there is no sense in declaring: the
phase of the reﬂection h is 35◦, without ﬁrst specifying the origin with respect
to which the phase is estimated.
This conclusion presents a new basic question: since the origin is arbit-
rarily chosen by the crystallographer, how can we hope to directly derive
phases from experimental amplitudes? This seems to be a contradiction in
logic; indeed, the experimental amplitudes, which are invariant with respect
to origin translations, cannot deﬁne the phases, since their values depend on
the arbitrary origin chosen by the crystallographer. This contradiction may be
overcome since combinations of phases exist whose values do not depend on
the origin, but only on the structure. They may therefore be estimated from the
diffraction amplitudes and are called structure invariants (shortened to s.i.; see
Section 3.3).
The reader should not be surprised that invariants are more than just neces-
sary to our treatment of the phase problem. Indeed they will guide our
approach, providing a general and simpliﬁed description of the properties of
phase space. This situation is similar to that met in the study of mathematics,
where we learn that the geometrical properties of curves may be more easily

Origin, phases, and symmetry operators
61
studied via invariant properties. The only difference here is that we are dealing
with phases and with the invariant properties of phase space.
The presence of symmetry in the crystal space allows us to describe another
concept related to invariance, the seminvariance concept. The algebraic form
of the symmetry operators depends on the class of origin chosen to describe
the structure (e.g. in P¯1, the translational components of the symmetry operat-
ors vanish if an inversion centre is chosen as origin). Usually one accepts the
class of origin suggested by the International Tables for Crystallography, thus,
simultaneously ﬁxing the form of the symmetry operators; however, different
choices can be made. Once the symmetry operators have been ﬁxed, a class of
allowed origins (see Section 3.4) is simultaneously selected. For example, if in
P¯1 we choose for operator ¯1 the relation (x, y, z) →(¯x, ¯y, ¯z), then the ﬁxed class
of origins coincides with the eight inversion centres. Analogously, if in P2 we
choose the symmetry relation (x, y, z) →(¯x, y, ¯z), then the origin is chosen on
the binary axes. We will see that phases or combinations of phases exist, the
values of which do not depend on the speciﬁc origin selected inside the per-
missible class (in the above examples, phases do not change if the origin is
moved from one inversion centre to another or from one binary axis to the
other); they are called structure seminvariants (shortened to s.s.; they are char-
acterized in Sections 3.5 and 3.6) and may be estimated from the diffraction
moduli provided the algebraic form of the symmetry operators has been ﬁxed.
A third question will also be answered in this chapter: is it possible to ﬁx
the origin by ﬁxing some subset of phases? Assigning coordinates to atoms
is only possible if the origin has been speciﬁed. Conversely, the phases of the
structure factors deﬁne, through the Fourier transform, the atomic positions
with respect to a given origin. Thus a mechanism must exist by which phasing
the reﬂections simultaneously ﬁxes the origin in direct space. This intriguing
correspondence will be elucidated in Section 3.7 by making use of the concepts
of s.i. and s.s.
3.2
Origin, phases, and symmetry operators
Let O be the origin of our reference system, and rj the atomic positional vector
of the jth atom; in Fig. 3.1, Pj marks its location. Then,
Fh =
N
j=1 fj exp

2πi h · rj

O¢
r′j
ri
xo
Pj
O
Fig. 3.1
rj transforms into r′j after a change of
origin from O to O′.
is the structure factor. Let us now translate the origin by the vector x0 (the
new reference axes remain parallel to the original ones). Then the new origin
moves to O′, the atomic positional vector of the jth atom is r′j = rj −x0, and
the structure factor becomes
F′h =
N
j=1 fj exp

2πi h · r′j

=
N
j=1 fj exp

2πi h · (rj −x0)

= Fh exp(−2πi h · x0).
(3.2)
From (3.2) we deduce that: the modulus of any structure factor does not change
with a shift in origin, while the phase value changes according to
φ′h = φh −2πh · x0.
(3.3)

62
The origin problem, invariants, and seminvariants
Relation (3.3) suggests that the origin shift produces a phase shift that is pro-
portional (modulo2π) to the scalar product h · x0. The phase shift vanishes if
h · x0 = n,
(3.4)
with n an integer value. Since (3.4) is the classical equation deﬁning the set of
lattice planes with Miller indices h ≡(h, k, l), the conclusion is: if the origin is
moved from O to any point O′ lying on the lattice planes h, then Fh does not
change its phase value. In a concise way, we say that the lattice planes h are
an equiphasic surface for the reﬂection h (see Fig. 3.2).
O
a
b
c
Fig. 3.2
Planes (232) constitute an equiphase sur-
face for F232.
Figure 3.3 shows the equiphasic surface for the reciprocal vector h = (530).
This also illustrates that the phase variation (for shifts x0 normal to the lat-
tice planes) must be faster for higher reﬂection indices; this result can also be
derived from relation (3.3). If the origin is moved along any vector S not lying
on the lattice planes (h, k, l), from one equiphasic plane to those adjacent, then
the phase of Fh will assume all possible values in the range (−π, π).
a
b
S
Fig. 3.3
Equiphase surface for F530.
Let us now investigate how a change in origin modiﬁes the matrix repres-
entation of the symmetry operators for a space group with point group order
equal to m. In their daily work, crystallographers use the origins tabulated in
the International Tables for Crystallography; e.g. in P¯1 the origin coincides
with an inversion centre, in P2 with a binary axis, etc. If, for some reason, they
are obliged to move the origin, they should know how the symmetry operators
change due to the origin shift. For a primitive unit cell with origin at O, the
symmetry operators Cs are deﬁned by the relationship
rjs = Csrj = Rsrj + Ts, s = 1, . . . , m.
(3.5)
If x0 is the origin translation vector, in the new reference system, symmetry
equivalent points will be related by the relationship
r′js = C′sr′j = R′sr′j + T′s, s = 1, . . . , m.
(3.6)
In order to derive the relationship between each Cs and its corresponding C′s
we simply substitute into (3.6) the values
r′js = rjs −x0
and
r′j = rj −x0,
obtaining
rjs −x0 = R′srj −R′sx0 + T′s,
O¢
O
r ¢
r
–r
P ¢
P
xo
Fig. 3.4
Change of origin in P¯1.
or
rjs = R′srj −(R′s −I)x0 + T′s, s = 1, . . . , m.
(3.7)
Since (3.7) and (3.5) must be identical whatever the value of rj, it follows that
R′s = Rs. Thus, a change of origin does not affect the rotation matrices but only
the translational components of the symmetry operators, and the translation
matrix changes according to
T′s = Ts + (Rs −I)x0, s = 1, . . . , m.
(3.8)
For instance, in the space group P¯1, if we choose a new origin at a dis-
tance x0 from a centre of symmetry (see Fig. 3.4) then a point P, deﬁned

The concept of structure invariant
63
by the positional vector r′ = r −x0, will correspond to an equivalent point
P’ at −r −x0 ≡−(r′ + 2x0). Since R′s = Rs, from (3.8) the new symmetry
operators arise:
R′1 =
⎡
⎢⎣
1 0 0
0 1 0
0 0 1
⎤
⎥⎦,
T′1 =
⎡
⎢⎣
0
0
0
⎤
⎥⎦
R′2 =
⎡
⎢⎣
¯1 0 0
0 ¯1 0
0 0 ¯1
⎤
⎥⎦,
T′2 =
⎡
⎢⎣
−2x0
−2y0
−2z0
⎤
⎥⎦,
provided that x0 ≡(xo, yo, zo).
3.3
The concept of structure invariant
In Section 3.2 we showed that the phase of the reﬂection h changes if the origin
is shifted; consequently, φh cannot be directly determined from the experi-
mental data. The opposite statement (i.e. φh may be determined from the data)
should be illogical; indeed the amplitudes are ﬁxed by the structure, the phases
by our arbitrary choice of the origin.
How can we determine phases from experimental data? The only way
is to check if some products of structure factors can be identiﬁed which
remain invariant whatever the origin translation. In this case the values of
such combination are origin independent and therefore depend on the struc-
ture. Obviously we have to consider products of structure factors which contain
phase information. Let us consider the product
Fh1Fh2 · . . . · Fhn = |Fh1Fh2 · . . . · Fhn| exp

i(φh1 + φh2 + · · · · · +φhn)

.
(3.9)
According to (3.2) an origin translation will modify (3.9) into
F′h1F′h2 · . . . · F′hn = Fh1Fh2 · . . . · Fhn exp[−2πi(h1 + h2 + · · · + hn) · x0].
(3.10)
Relation (3.10) suggests that the product of structure factors (3.9) is invariant
under origin translation if
h1 + h2 + · · · + hn = 0.
(3.11)
Products of structure factors which satisfy (3.11) are called structure invariants
(s.i.), since their values do not depend on the origin, and therefore depend only
on the structure (Hauptman and Karle, 1953).
The simplest examples of s.i. are:
1. For n = 1, relation (3.11) conﬁrms F000 as the simplest structure invariant
(it is equal to the number of electrons in the unit cell).
2. For n = 2, relation (3.11) reduces to h1 + h2 = 0 or, in other notation,
h2 = −h1. Accordingly, the product FhF−h = |Fh|2 is a structure invariant
(which agrees well with the obvious expectation that an observation does
not depend on the origin we choose).

64
The origin problem, invariants, and seminvariants
3. For n = 3, relation (3.11) reduces to h1 + h2 + h3 = 0. Accordingly,
Fh1Fh2F−(h1+h2) = |Fh1Fh2F−(h1+h2)| exp

i(φh1 + φh2 −φh1+h2)

(3.12)
is a s.i., speciﬁcally called triplet invariant.
4. For n = 4, relation (3.11) deﬁnes the quartet invariant,
Fh1Fh2Fh3F−(h1+h2+h3) = |Fh1Fh2Fh3F−(h1+h2+h3)|
× exp

i(φh1 + φh2 + φh3 −φh1+h2+h3)

.
Quintet, sextet, etc. s.i.s are deﬁned by analogy.
Frequently the terms triplet, quartet, quintet invariant are referred to as:
(a) a
product
of
normalized
structure
factors
like
Eh1Eh2E−(h1+h2),
Eh1Eh2Eh3E−(h1+h2+h3), etc.;
(b) the sum of phases rather than to the product of structure factors. For
example, we will refer to(φh1 + φh2 −φh1+h2) as a triplet invariant, to
(φh1 + φh2 + φh3 −φh1+h2+h3) as a quartet invariant, and so on. In equi-
valent notation, we can also write triplet invariants as (φh + φk −φh+k)
or (φh −φk −φh−k), and quartet invariants as (φh + φk + φl −φh+k+l) or
(φh −φk −φl −φh−k−l).
Let us now suppose that, at a certain step of the phasing process, a model
structure is available and that Fp is the corresponding structure factor. Then
a new type of s.i. may be devised which simultaneously contains F and Fp
structure factors (see Sections 7.2 and 7.5); we will see that such invariants are
very useful for facilitating the passage from the model to the target structure.
Examples of this second type of invariant (the reader will easily see below that
origin translations do not modify the value of the invariants) are:
n = 2: FhF−ph, or in terms of phase cosine cos(φh −φph);
n = 3: FhFkF−h−k
or
(φh + φk + φ−h−k),
FhFkFp−h−k
or
(φh + φk + φp−h−k),
FphFkF−h−k
or
(φph + φk + φ−h−k),
FhFpkF−h−k
or
(φh + φpk + φ−h−k),
FhFpkFp−h−k
or
(φh + φpk + φp−h−k),
FphFkFp−h−k
or
(φph + φk + φp−h−k),
FphFpkF−h−k,
or
(φph + φpk + φ−h−k),
FphFpkFp−h−k
or
(φph + φpk + φp−h−k).

Allowed or permissible origins in primitive space groups
65
Any of the above invariants may be estimated from the amplitudes of the
corresponding observed and calculated structure factors.
Similar expressions may be obtained for quartets, quintets, etc.
3.4
Allowed or permissible origins in primitive
space groups
In Section 3.2 it has been shown that ﬁxing the symmetry operators Cs
(and through this the algebraic form of the structure factor) is equivalent to
selecting the class of allowed origin. In order to simplify the calculations
during structural analysis and in order to handle the symmetry more eas-
ily it is convenient, in practice, to choose the origin on one or more of the
symmetry elements. Thus, it is usual to choose the origin on high-order sym-
metry elements when they are present: in cs. (centrosymmetric) space groups
it may be convenient to locate the origin on an inversion centre. This fre-
quently corresponds with the choices given in the International Tables for
Crystallography.
Moving the origin from one site to another usually modiﬁes the algebraic
representation of the symmetry operators. We deﬁne an allowed or permiss-
ible origin as all those points in direct space which, when taken as the origin,
maintain the same symmetry operators Cs. The allowed origins will therefore
correspond to points having the same ‘symmetry environment’, in the sense
that they are related to the symmetry elements in the same way. For instance,
if the origin is located on an inversion centre, all the inversion centres in P-1
that are compatible with symmetry operators Cs, given by
R1 =
⎡
⎢⎢⎣
1 0 0
0 1 0
0 0 1
⎤
⎥⎥⎦,
T1 =
⎡
⎢⎢⎣
0
0
0
⎤
⎥⎥⎦,
R2 =
⎡
⎢⎢⎣
¯1 0 0
0 ¯1 0
0 0 ¯1
⎤
⎥⎥⎦,
T2 =
⎡
⎢⎢⎣
0
0
0
⎤
⎥⎥⎦,
will be permissible origins. To each functional form of the structure factor
there will be a class of permissible origins which, since they are all related to
the symmetry elements in the same way, will be said to be equivalent. These
constitute a class of equivalent origins or equivalence class.
Recognizing permissible origins is in general quite simple, through visual
inspection of the space group diagram in the International Tables for
Crystallography. We shall now see how to deﬁne permissible origins using
an algebraic procedure.
Let O be an origin compatible with a ﬁxed algebraic form of the structure
factor; all other origins belonging to the same equivalence class can be deﬁned
in a very simple way using relation (3.7). Since a shift of origin must leave
R′s = Rs, it will be sufﬁcient, in order to keep the symmetry operators
Cs and thus the algebraic form of the structure factor unchanged, to have
T′s = Ts for all values of s. More generally, because of the periodicity of crystal
lattices, it will be sufﬁcient to have T′s −Ts = V, where V is a vector with zero

66
The origin problem, invariants, and seminvariants
or integer components. All origins allowed by a ﬁxed functional form of the
structure factor will be connected by translational vectors x0 such that
(Rs −I) x0 = V,
s = 1, 2, . . . , m.
(3.13)
A translation between permissible origins will be called a permissible or
allowed translation. Trivial allowed translations correspond to the lattice
periods or to their multiples.
Fig. 3.5
Space group P2/m.
Let us now consider some examples of the above concepts. In the space
group P2/m (compare Fig. 3.5) the origin is chosen on an inversion centre with
b as a twofold axis; the general equivalent positions in the unit cell are
(x, y, z),
(¯x, ¯y, ¯z),
(¯x, y, ¯z),
(x, ¯y, z).
The symmetry operators are then
R1 = I =
⎡
⎢⎢⎣
1 0 0
0 1 0
0 0 1
⎤
⎥⎥⎦,
R2 =
⎡
⎢⎢⎣
¯1 0 0
0 ¯1 0
0 0 ¯1
⎤
⎥⎥⎦,
R3 =
⎡
⎢⎢⎣
¯1 0 0
0 1 0
0 0 ¯1
⎤
⎥⎥⎦,
R4 =
⎡
⎢⎢⎣
1 0 0
0 ¯1 0
0 0 1
⎤
⎥⎥⎦,
T1 = T2 = T3 = T4 = 0.
The Rs −I matrices are
R1 −I =
⎡
⎢⎢⎣
0 0 0
0 0 0
0 0 0
⎤
⎥⎥⎦,
R2 −I =
⎡
⎢⎢⎣
¯2 0 0
0 ¯2 0
0 0 ¯2
⎤
⎥⎥⎦,
R3 −I =
⎡
⎢⎢⎣
¯2 0 0
0 0 0
0 0 ¯2
⎤
⎥⎥⎦,
R4 −I =
⎡
⎢⎢⎣
0 0 0
0 ¯2 0
0 0 0
⎤
⎥⎥⎦.
It is easy to verify that the translations
⎡
⎢⎣
n1/2
0
0
⎤
⎥⎦
⎡
⎢⎣
0
n2/2
0
⎤
⎥⎦
⎡
⎢⎣
0
0
n3/2
⎤
⎥⎦,
with n1, n2, n3 integer numbers, satisfy (3.13) and therefore connect origins
belonging to the same equivalence class. Any combination of the above three

Allowed or permissible origins in primitive space groups
67
translations will also connect origins allowed by the given functional form of
the structure factor. From the three basic translations
⎡
⎢⎢⎣
1
2
0
0
⎤
⎥⎥⎦,
⎡
⎢⎢⎣
0
1
2
0
⎤
⎥⎥⎦,
⎡
⎢⎢⎣
0
0
1
2
⎤
⎥⎥⎦,
we can derive a sort of lattice of permissible translations. Within a single unit
cell the permissible origins will be deﬁned by the translation vectors
⎡
⎢⎢⎣
0
0
0
⎤
⎥⎥⎦,
⎡
⎢⎢⎣
1
2
0
0
⎤
⎥⎥⎦,
⎡
⎢⎢⎣
0
1
2
0
⎤
⎥⎥⎦,
⎡
⎢⎢⎣
0
0
1
2
⎤
⎥⎥⎦,
⎡
⎢⎢⎣
0
1
2
1
2
⎤
⎥⎥⎦,
⎡
⎢⎢⎣
1
2
0
1
2
⎤
⎥⎥⎦,
⎡
⎢⎢⎣
1
2
1
2
0
⎤
⎥⎥⎦,
⎡
⎢⎢⎣
1
2
1
2
1
2
⎤
⎥⎥⎦.
(3.14)
In the space group P4/n, when the origin is chosen on ¯4 (compare Fig. 3.6)
at
 ¯1
4, 1
4, 0

from an inversion centre, the general equivalent positions are
(x, y, z),
1
2 −x, 1
2 −y, ¯z

,
(¯x, ¯y, z),
1
2 + x, 1
2 + y, ¯z

,
(¯y, x, ¯z),
(y, ¯x, ¯z),
1
2 −y, 1
2 + x, z

,
1
2 + y, 1
2 −x, z

,
Fig. 3.6
Space group P4/n.
The Rs −I matrices are
R1 −I =
⎡
⎢⎢⎣
0 0 0
0 0 0
0 0 0
⎤
⎥⎥⎦,
R2 −I =
⎡
⎢⎢⎣
¯2 0 0
0 ¯2 0
0 0 ¯2
⎤
⎥⎥⎦,
R3 −I =
⎡
⎢⎢⎣
¯2 0 0
0 ¯2 0
0 0 0
⎤
⎥⎥⎦,
R4 −I =
⎡
⎢⎢⎣
0 0 0
0 0 0
0 0 ¯2
⎤
⎥⎥⎦.
R5 −I =
⎡
⎢⎢⎣
¯1 ¯1 0
1 ¯1 0
0 0 ¯2
⎤
⎥⎥⎦,
R6 −I =
⎡
⎢⎢⎣
¯1 1 0
¯1 ¯1 0
0 0 ¯2
⎤
⎥⎥⎦,
R7 −I =
⎡
⎢⎢⎣
¯1 ¯1 0
1 ¯1 0
0 0 0
⎤
⎥⎥⎦,
R8 −I =
⎡
⎢⎢⎣
¯1 1 0
¯1 ¯1 0
0 0 0
⎤
⎥⎥⎦.

68
The origin problem, invariants, and seminvariants
A lattice of permissible origins with basic translations,
⎡
⎢⎢⎣
1
2
0
0
⎤
⎥⎥⎦,
⎡
⎢⎢⎣
0
1
2
0
⎤
⎥⎥⎦,
⎡
⎢⎢⎣
0
0
1
2
⎤
⎥⎥⎦,
satisﬁes relations (3.13) for s = 1, 2, 3, 4; but in order to also satisfy (3.13) for
s ≥5, the sum and the difference of the components of the translation vector x0
in the (a, b) plane must be integer numbers. The allowed translations deﬁning
the permissible origins will be
⎡
⎢⎢⎣
0
0
0
⎤
⎥⎥⎦,
⎡
⎢⎢⎣
0
0
1
2
⎤
⎥⎥⎦,
⎡
⎢⎢⎣
1
2
1
2
0
⎤
⎥⎥⎦,
⎡
⎢⎢⎣
1
2
1
2
1
2
⎤
⎥⎥⎦.
(3.15)
Fig. 3.7
Space group P3.
Let us now apply equation (3.13) to some n.cs. (non-centrosymmetric) space
groups. In the space group P3, with the origin on a threefold axis (compare Fig.
3.7), the general equivalent positions are
(x, y, z),
(¯y, x −y, z),
(y −x, ¯x, z).
The Rs −I matrices are
R1 −I =
⎡
⎢⎢⎣
0 0 0
0 0 0
0 0 0
⎤
⎥⎥⎦,
R2 −I =
⎡
⎢⎢⎣
¯1 ¯1 0
1 ¯2 0
0 0 0
⎤
⎥⎥⎦,
R3 −I =
⎡
⎢⎢⎣
¯2 1 0
¯1 ¯1 0
0 0 0
⎤
⎥⎥⎦.
We can easily verify that origin translations with components
 1
2, 1
3

in the
(a, b) plane satisfy (3.13) for all values of s. Note, however, that relations
(3.13) do not imply any restriction to shifts in the z direction. The allowed
translations in the unit cell are then given by
⎡
⎢⎢⎣
0
0
z
⎤
⎥⎥⎦,
⎡
⎢⎢⎣
2
3
1
3
z
⎤
⎥⎥⎦,
⎡
⎢⎢⎣
1
3
2
3
z
⎤
⎥⎥⎦.
(3.16)
Let us now consider, as a further example, space group R3 (compare
Fig. 3.8). With rhombohedral axes and the origin on a threefold axis, the
general equivalent positions are
(x, y, z),
(z, x, y),
(y, z, x).
Fig. 3.8
Space group R3.
The Rs −I matrices are
R1 −I =
⎡
⎢⎢⎣
0 0 0
0 0 0
0 0 0
⎤
⎥⎥⎦,
R2 −I =
⎡
⎢⎢⎣
¯1 0 1
1 ¯1 0
0 1 ¯1
⎤
⎥⎥⎦,
R3 −I =
⎡
⎢⎢⎣
¯1 1 0
0 ¯1 1
1 0 ¯1
⎤
⎥⎥⎦.

The concept of structure seminvariant
69
In order to satisfy relationships (3.13), one has to choose translation vectors
with equal components, i.e.
x0 =
⎡
⎣
x
x
x
⎤
⎦.
(3.17)
The reader will easily be able to ﬁnd the permissible translations for any other
primitive space group using the algebraic procedure described in this section.
There are two important points that should also be noted. The ﬁrst is related
to the absence in equation 3.13 of the translational components of the sym-
metry operators. The distribution in direct space of the allowed origins is only
dependent on the rotation matrices; for a given space group the allowed trans-
lations are therefore independent of the chosen form of the structure factor.
More explicitly, let us consider the space group P4/n, mentioned above. When
the origin is chosen at ¯1 at
 1
4, 1
4, 0

from ¯4, the general equivalent positions
become
(x, y, z),
(¯x, ¯y, ¯z),
1
2 −x, 1
2 −y, z

,
1
2 + x, 1
2 + y, ¯z

,

¯y, 1
2 + x, ¯z

,
1
2 + y, ¯x, ¯z

,
1
2 −y, x, z

,

y, 1
2 −x, z

;
The reader can immediately verify that the rotation matrices are unchanged
in the new reference system, even if the algebraic form of the structure factor
is modiﬁed; (3.15) are therefore the only allowed translations in this case, as
well. Note that the four inversion centres in Fig. 3.6 do not all belong to the
same equivalence class, because of the presence of the n glide.
The second point to stress is that the permissible translations, depending
on the rotation matrices only, will remain the same in those space groups in
which simple axes or planes are substituted by screw axes or glide planes (for
instance, P2/m, P21/m, P2/c, and P21/c).
We will call any set of cs. or n.cs. space groups having the same allowed ori-
gin translation a Hauptman–Karle (H–K) family. The 94 n.cs. primitive space
groups can be collected in 13 H–K families and the 62 primitive cs. groups
in 4 H–K families. The second and the third rows of Tables 3.1 and 3.2 show
these results explicitly.
It is worth emphasizing, for the beneﬁt of the reader who wishes to refer
to the literature for further details, that this concept of permissible origins is
formally different from that given in the classical papers of Hauptman and
Karle (1953b, 1956). We have followed the treatment described by Giacovazzo
(1974a) because this provides a more general treatment.
3.5
The concept of structure seminvariant
In Section 3.3 we showed that products of structure factors (or the sum of
phases) exist, the values of which do not depend on the origin, but only on the
structure; we called them structure invariant (s.i.). Their importance is related
to the following speciﬁc property: their phase values may be estimated from
measured amplitudes.

70
The origin problem, invariants, and seminvariants
Table 3.1 Allowed origin translations, seminvariant moduli, and phases for centrosymmetric primitive space groups
H–K family
(h, k, l)P(2, 2, 2)
(h + k, l)P(2, 2)
(l)P(2)
(h + k + l)P(2)
Space group
P¯1
Pmna
P 4
m
P 4
n mm
P¯3
R¯3
P 2
m
Pcca
P 42
m
P 4
n cc
P¯31m
R¯3m
P 21
m
Pbam
P 4
n
P 42
m mc
P¯31c
R¯3c
P 2
c
Pccn
P 42
n
P 42
m cm
P¯3m1
Pm¯3
P 21
c
Pbcm
P 4
mmm
P 42
n bc
P¯3c1
Pn¯3
Pmmm
Pnnm
P 4
mcc
P 42
n nm
P 6
m
Pa¯3
Pnnn
Pmmn
P 4
n bm
P 42
m bc
P 63
m
Pm¯3m
Pccm
Pbcn
P 4
n nc
P 42
m nm
P 6
mmm
Pn¯3n
Pban
Pbca
P 4
mbm
P 42
n mc
P 6
mcc
Pm¯3n
Pmma
Pnma
P 4
mnc
P 42
n cm
P 63
m cm
Pn¯3m
Pnna
P 63
m mc
Allowed origin translations
(0, 0, 0);

0, 1
2 , 1
2

(0, 0, 0)
(0, 0, 0)
(0, 0, 0)
 1
2 , 0, 0

;
 1
2 , 0, 1
2


0, 0, 1
2


0, 0, 1
2

 1
2 , 1
2 , 1
2


0, 1
2 , 0

;
 1
2 , 1
2 , 0

 1
2 , 1
2 , 0


0, 0, 1
2

;
 1
2 , 1
2 , 1
2

 1
2 , 1
2 , 1
2

Vector hs seminvariantly
associated with h = (h, k, l)
(h, k, l)
(h + k, l)
(l)
(h + k + l)
Seminvariant modulus ωs
(2, 2, 2)
(2, 2)
(2)
(2)
Seminvariant
φeee
φeee; φooe
φeee; φeoe
φoee; φooe
φeee; φooe
φoeo; φeoo
Number of semi-independent
phases to be speciﬁed
3
2
1
1
We now introduce a related concept, structure seminvariant (s.s.). Let us
suppose that, for a given space group, the symmetry operators Cs, and therefore
the allowed origins, have been ﬁxed. If x0 is a generic translation, equa-
tion (3.3) suggests that the phase of a structure factor will change, after an
origin shift, by a ﬁnite quantity. The central question for this section is: do
particular phases or combinations of phases exist, the values of which do not
change when the origin is moved within the set of allowed origins? If yes, we
will say that the phases or the combination of phases are s.s. (Hauptman and
Karle, 1956).
The s.s. are important because they can be estimated from measurements,
provided that the symmetry operators have been ﬁxed (and they usually remain
ﬁxed during the full phasing process). Indeed, the ﬁxed nature of the symmetry
operators restricts the allowed origins to a speciﬁc subset of points, within

Table 3.2 Allowed origin translations, seminvariant moduli, and phases for non-centrosymmetric primitive space groups
H–K family
(h, k, l)
(h, k, l)
(h, k, l)
(h, k, l)
(h, k, l)
(h + k, l)
(h + k, l)
(h – k, l)
(2h + 4k + 3l)
(h + k + l)
(h + k + l)
P(0, 0, 0)
P(2, 0, 2)
P(0, 2, 0)
P(2, 2, 2)
P(2, 2, 0)
P(2, 0)
P(2, 2)
P(3, 0)
P(6)
(l)P(0)
(l)P(2)
P(0)
P(2)
Space group
P1
P2
Pm
P222
Pmm2
P4
P¯4
P3
P312
P31m
P321
R3
R32
P21
Pc
P2221
Pmc21
P41
P422
P31
P3112
P31c
P3121
R3m
P23
P21212
Pcc2
P42
P4212
P32
P3212
P6
P3221
R3c
P213
P212121
Pma2
P43
P4122
P3m1
P6
P61
P622
P432
Pca21
P4mm
P41212
P3c1
P¯6m2
P65
P6122
P4232
Pnc2
P4bm
P4222
P¯6c2
P64
P6522
P4332
Pmn21
P42cm
P42212
P63
P6222
P4132
Pba2
P42nm
P4322
P62
P6422
P¯43m
Pna21
P4cc
P43212
P6mm
P6322
P¯43n
Pnn2
P4nc
P¯42m
P6cc
P¯62m
P42mc
P¯42c
P63cm
P¯62c
P42bc
P¯421m
P63mc
P¯421c
P¯4m2
P¯4c2
P¯4b2
P¯4n2
Allowed origin
(x, y, z)
(0, y, 0)
(x, 0, z)
(0, 0, 0)
(0, 0, z)
(0, 0, z)
(0, 0, 0)
(0, 0, z)
(0, 0, 0)
(0, 0, z)
(0, 0, 0)
(x, x, x)
(0, 0, 0)
translations

0, y, 1
2


x, 1
2 , z

 1
2 , 0, 0


0, 1
2, z

 1
2 , 1
2 , z


0, 0, 1
2

 1
3 , 2
3 , z


0, 0, 1
2


0, 0, 1
2

 1
2, 1
2 , 1
2

 1
2 , y, 0


0, 1
2 , 0

 1
2, 0, z

 1
2 , 1
2 , 0

 2
3 , 1
3 , z

 1
3 , 2
3 , 0

 1
2 , y, 1
2


0, 0, 1
2

 1
2, 1
2, z

 1
2 , 1
2 , 1
2

 1
3 , 2
3 , 1
2


0, 1
2 , 1
2

 2
3 , 1
3 , 0

 1
2 , 0, 1
2

 2
3 , 1
3 , 1
2

 1
2 , 1
2 , 0

 1
2 , 1
2 , 1
2


Table 3.2 (Continued)
H–K family
(h, k, l)
(h, k, l)
(h, k, l)
(h, k, l)
(h, k, l)
(h + k, l)
(h + k, l)
(h – k, l)
(2h + 4k + 3l)
(h + k + l)
(h + k + l)
P(0, 0, 0) P(2, 0, 2) P(0, 2, 0) P(2, 2, 2) P(2, 2, 0) P(2, 0)
P(2, 2)
P(3, 0)
P(6)
(l)P(0)
(l)P(2)
P(0)
P(2)
Vector hs
seminvariantly
associated with
h = (h, k, l)
(h, k, l)
(h, k, l)
(h, k, l)
(h, k, l)
(h, k, l)
(h + k, l)
(h + k, l)
(h – k, l)
(2h + 4k + 3l)
(l)
(l)
(h + k + l)
(h + k + l)
Seminvariant
modulus ωs
(0, 0, 0)
(2, 0, 2)
(0, 2, 0)
(2, 2, 2)
(2, 2, 0)
(2, 0)
(2, 2)
(3, 0)
(6)
(0)
(2)
(0)
(2)
Seminvariant
phases
φ000
φe0e
φ0e0
φeee
φee0
φee0
φoo0
φeee
φooe
φhk0 if
h – k ≡0
(mod 3)
φhkl if
2h + 4k + 3l ≡0
(mod 6)
φhk0
φhke
φh,k,¯h+¯k
φeee; φooe
φoeo; φooe
Allowed
variations for
the semi-
independent
phases
∥∞∥
∥∞∥,
∥2∥if
k = 0
∥∞∥,
∥2∥if
h = l = 0
∥2∥
∥∞∥,
∥2∥if
l = 0
∥∞∥,
∥2∥if
l = 0
∥2∥
∥∞∥,
∥3∥if
l = 0
∥2∥if
h ≡k
(mod 3) ∥3∥if
l ≡0 (mod 2)
∥∞∥
∥2∥
∥∞∥
∥2∥
Number of semi-
independent
phases to be
speciﬁed
3
3
3
3
3
2
2
2
1
l
1
1
1

The concept of structure seminvariant
73
which the seminvariants do not change. We can then state that the s.s. values
only depend on the structure, provided that the class of allowed origins has
been ﬁxed.
We now show how to recognize s.s.s via Tables 3.1–3.4 (we will see in
Chapter 4 that other appropriate deﬁnitions also exist).
Because of (3.3), the condition for φh to be a s.s. is that, for all permissible
translations xp (Hall, 1970a),
h · xp = r,
p = 1, 2, . . . ,
(3.18)
where r is a positive, null, or negative integer. Equation (3.18) shows that the
s.s.s are determined by the permissible translations only. Therefore, if a phase
is an s.s. for a given space group, it will also be an s.s. for all other space groups
belonging to the same H–K family.
Let us now apply the above considerations to some H–K families. For the
families indicated in Table 3.1 by the symbol (h, k, l)P(2, 2, 2), equation
(3.18) suggests immediately that a phase φh with h = (h, k, l) is an s.s. when
h = 2n1,
k = 2n2,
l = 2n3,
with n1, n2, n3 integers. Introducing the symbolism of modular algebra, these
conditions can be expressed in the form,
h ≡0 (mod (2, 2, 2)).
(3.19)
In fact, the congruence of h to zero modulo (2, 2, 2) is equivalent to all
components of h being even.
For the H–K family indicated in Table 3.1 by the symbol (h + k, l)P(2, 2),
we derive from equation (3.18) that to a seminvariant phase φh indices h, k, l
must correspond such that
h + k = 2n1,
l = 2n2.
(3.20)
In this family, the seminvariance conditions do not apply to the individual com-
ponents h, k, l of the reciprocal vector h, but to the two-dimensional vector
(h + k, l). Using the relations of modular congruence we can express condition
(3.20) in the form,
hs ≡0
(mod (2, 2)),
where hs = (h + k, l). The vector hs, so deﬁned, is said to be seminvariantly
associated with h and the vector ωs = (2, 2) will be the seminvariant modulus
of the family (h + k, l)P(2, 2). Condition (3.19) can also be rewritten in terms
of hs and ωs as,
hs ≡0
(mod ωs),
with hs = (h, k, l) and ωs = (2, 2, 2).
We can therefore associate with each H–K family, the corresponding vectors
ωs and hs. In general, a phase φh is an s.s. for a given H–K family when the
seminvariantly associated vector hs is congruent to zero modulo ωs, where ωs
is the seminvariant modulus of the group. We write
hs ≡0
(mod ωs).
(3.21)

74
The origin problem, invariants, and seminvariants
Thus, in the group (h + k + l)P2, the seminvariance condition for φh is
h + k + l = 2n, and we will say that φh is an s.s. if (3.21) holds, where
hs and ωs are the one-dimensional vectors with components (h + k + l) and
(2) respectively.
So far we have only used cs. groups as examples, but the results obtained
are entirely general. In fact the reader can easily verify that, for the family
(h + k, l)P(2, 0), the seminvariance conditions for the phase φh are
h + k = 2n and l = 0.
(3.22)
Conditions (3.22) can be expressed in a more concise form by equation (3.21),
assuming
hs = (h + k, l),
ωs = (2, 0).
In Tables 3.1 and 3.2, for each H–K family, the seminvariant modulus ωs
and the vector hs seminvariantly associated with the vector h are given; it
is then very simple to select, for each primitive space group, those phases
which are s.s.s. The notation used to indicate H–K families is that proposed
by Giacovazzo (1974a), giving, in turn, the vector seminvariant associated
with each phase φh, the lattice type, and the seminvariant modulus. We shall
underline the lattice symbol to indicate an H–K family that includes cs. space
groups.
Recalling the idea of an equiphase surface, mentioned in Section 3.2, we can
derive an immediate geometrical interpretation of the seminvariance condition
for a given phase φh. The necessary and sufﬁcient condition for a phase φh
to be unchanged for any possible origin translation is that the lattice planes
(h, k, l) shall contain all the origins allowed by the functional form of the s.f.
Thus, for instance, in the H–K family (h, k, l)P(2, 2, 2), lattice planes (h, k, l),
having
h = 2n1,
k = 2n2,
l = 2n3,
contain all permissible origins; lattice planes (h, k, l) with
h −k = 3n,
l = 0
contain all permissible origins of the group (h−k, l)P(3, 0), and similarly for
all other groups.
It is now clear that when a phase is not an s.s. its value will change, passing
from one origin to another within the equivalence class. We will deﬁne as
allowed or permissible phase changes for linearly semi-independent phases,
the phase shifts corresponding to allowed origin translations. Following Karle
(1970a,b), in Table 3.2 (in Table 3.1 it would be trivial), we indicate by the
symbol ∥∞∥the permissible phase changes assuming any value between −π
and π, and by the symbols ||2||, ||3||, ||4|| the permissible phase changes of
2nπ/2, 2nπ/3, 2nπ/4 respectively. Thus in the group (h−k, l)P(3, 0), if Fh is
not an s.s. the phase φh can take any value between −π and π for any allowed
origin translation; but, when l = 0, φh can only have three discrete values,
φ,
φ + 2π
3 ,
φ + 4π
3 .
To show this we will, for simplicity, assume the origin on a threefold axis.
In this case, phase φh, k,0 (not an s.s.) has the same value for all permissible

The concept of structure seminvariant
75
translations along the c-axis; in other words, all points on a threefold axis,
when chosen as origins, will attribute the same value to φh, k,0. As the origin
translates from one threefold axis to another (there are three such axes in the
cell), this implies a phase shift of 2nπ/3.
We shall now see how we can extend this idea for the deﬁnition of two-
phase, three-phase, and n-phase seminvariants.
Let us consider the product of s.f.s,
Fh1Fh2 · · · Fhn =
Fh1Fh2 · · · Fhn
 exp

i(φh1 + φh2 + · · · + φhn)

.
(3.23)
The general product of s.f.s (3.23), or, more speciﬁcally, its phase
 = φh2 + φh2 + · · · + φhn,
is an s.s. for a given space group (or for a given H–K family) if its value
does not change when the origin is moved within the same equivalence class.
By analogy with (3.18), the necessary and sufﬁcient condition for  to be an
s.s. is that, for all allowed translations, the following condition is satisﬁed:
⎛
⎝
n

j=1
hj
⎞
⎠xp = r,
p = 1, 2, . . . ,
(3.24)
where r is a positive, null, or negative integer. By analogy with (3.21),
deﬁnition (3.24) is equivalent to the following: the sum of phases
n

j=1
φhj
is an s.s. if condition
n

j=1
hjs ≡0
(mol ωs)
(3.25)
is satisﬁed. Depending on the value of n, we speak of one-phase seminvariant,
two-phase seminvariant, etc. . . . We will now give a few examples.
1. In P¯1 (as for all space groups belonging to the H–K family (h, k, l)P(2, 2,
2)), φh, k, l is a structure seminvariant if h, k, l are all even numbers. Two-
phase seminvariants will be the phases
φh1,k1,l1 + φh2,k2,l2 provided
h1 + h2 ≡0 (mod 2),
k1 + k2 ≡0 (mod 2),
l1 + l2 ≡0 (mod 2).
2. In P2 (and also in P21), φe0e is an s.s. (e stands for even). Also,
φh1,k1,l1 + φh2,¯k1,l2 is an s.s if h1 + h2 ≡0 (mod 2) and l1 + l2 ≡0 (mod 2).
Similarly,
φh1k1l1 + φh2k2l2 + φh3k1+k2l3 is a three-phase s.s. if
h1 + h2 + h3 ≡0 (mod 2) and l1 + l2 + l3 ≡0 (mod 2).
We may now note an interesting observation. We have seen that the seminvari-
ance condition does not change when we choose a different functional form of

76
The origin problem, invariants, and seminvariants
the s.f. (that is, when we ﬁx another equivalence class for the origins). Thus a
phase or a linear combination of phases which is a seminvariant with respect
to a given equivalent class of origins will remain a semi-invariant for any other
equivalence class.
3.6
Allowed or permissible origins
in centred cells
The theory developed over the preceding paragraphs may be adapted, with
minor changes, to space groups with a non-primitive unit cell. In fact it is well
known that it is always possible to reduce a centred cell to a primitive one using
a suitable transformation. Once the transformation has been performed, there is
no further difﬁculty in applying the above theory to determine the conditions
for origin deﬁnition. The results obtained in this way must be transformed
again in terms valid for a centred cell if one wishes to operate in this reference
system (Hauptman and Karle (1956, 1959); Karle and Hauptman (1961); see
also Lessinger and Wondratschek (1975)).
An alternative and simpler way was suggested by Giacovazzo (1974a),
which uses directly algebraic relations speciﬁc for non-primitive cells. We will
follow this approach.
Let us suppose that, for a given non-primitive cell with centring order τ, we
have chosen the algebraic form of the structure factor; the equivalent positions
not related by the centring of the cell can be expressed by means of
rjs = Csrj = Rsrj + Ts, s = 1, 2, . . . , m
τ .
The complete set of general equivalent positions can be obtained by applying
the centring vectors Bv, since for each atom rjs there will be τ—1 equivalent
atoms at rjs+Bv with v = 2, 3, . . . , τ.
1/4
1/4
1/4
1/4
1/4
Fig. 3.9
Space group C2/c and the corresponding
standard primitive cell.
Since an origin translation corresponding to a centring vector Bv does not
change the functional form of the s.f., all vectors Bv represent permissible
translations. Therefore, xp will be an allowed translation, not only when, as
stated in Section 3.4, the difference T′s −Ts is equal to one or more lattice
units, but also when, for any s, the condition
T′s −Ts = V + αBv,
s = 1, 2, . . . ,
α = 0, 1
or
(Rs −I)Xp = V + αBv,
s = 1, 2, . . . ,
α = 0, 1
(3.26)
is satisﬁed.
Let us consider the example of the space group C2/c. From Fig. 3.9, we
easily see that the only allowed origin translations are
(0, 0, 0),

0, 1
2, 0

1
2, 1
2, 0

1
2, 0, 0

,

0, 0, 1
2

,

0, 1
2, 1
2

,
1
2, 1
2, 1
2

,
1
2, 0, 1
2

.

Allowed or permissible origins in centred cells
77
In the case of primitive cells we neglect all allowed translations corresponding
to lattice translations; similarly, here we will neglect the trivial translations
coinciding with the centring vectors Bv. The only permissible origins are
therefore assumed to be
(0, 0, 0),
1
2, 0, 0

,

0, 0, 1
2

,
1
2, 0, 1
2

.
We can thus derive the results reported in Table 3.3.
Note that the centring of the cell in space group C2/c does not add any
new allowed translation with respect to those found for the group P2/c. This
is not always the case; the presence of the translation vectors B with non-
integer components (or, in the reciprocal lattice, the absence of certain classes
of reﬂections) can sometimes generate new allowed translations which can-
not be foreseen by the use of rotation matrices alone. We can, in general,
state that in centred cells the point group symmetry no longer deﬁnes all
permissible origins. To show this, let us consider the space group F222, illus-
trated in Fig. 3.10. When the origin is chosen at 222, the general equivalent
positions are
{(x, y, z), (¯x, ¯y, z), (x, ¯y, ¯z), (¯x, y, ¯z)} , +

(0, 0, 0),

0, 1
2, 1
2

,
1
2, 0, 1
2

,
1
2, 1
2, 0

.
Table 3.3 Allowed origin translations seminvariant moduli, and phases for centrosymmetric non-primitive space groups
H–K family
(h, l)C(2, 2)
(k, l)I(2, 2)
(h + k + l)F(2)
(l)I(2)
I
Space groups
C 2
m
Immm
Fmmm
I 4
m
I m¯3
C 2
c
Ibam
Fddd
I 41
a
Ia¯3
Cmcm
Ibca
Fm¯3
I 4
m mm
Im¯3m
Cmca
Imma
Fd¯3
I 4
m cm
Ia¯3d
Cmmm
Fm¯3m
I 41
a md
Cccm
Fm¯3c
I 41
a cd
Cmma
Fd¯3m
Ccca
Fd¯3c
Allowed origin translations
(0, 0, 0)
(0, 0, 0)
(0, 0, 0)
(0, 0, 0)
(0, 0, 0)

0, 0, 1
2


0, 0, 1
2

 1
2 , 1
2 , 1
2


0, 0, 1
2

 1
2 , 0, 0


0, 1
2 , 0

 1
2 , 0, 1
2

 1
2, 0, 0

Vector hs seminvariantly
associated with h = (h, k, l)
(h, l)
(k, l)
(h + k + l)
(l)
(h, k, l)
Seminvariant modulus ωs
(2, 2)
(2, 2)
(2)
(2)
(1, 1, 1)
Seminvariant phases
φeee
φeee
φeee
φeoe; φeee
φooe; φoee
All
Number of semi-independent
phases to be speciﬁed
2
2-
1
1
0

78
The origin problem, invariants, and seminvariants
1/4
1/4
1/4
1/4
1/4
1/4
1/4
1/4
1/4
1/4
1/4
1/4
1/4
1/4
1/4
1/4
1/4
1/4
1/4
1/4
Fig. 3.10
Space group F222.
The Rs−I matrices are therefore
R1 −I =
⎡
⎢⎢⎣
0 0 0
0 0 0
0 0 0
⎤
⎥⎥⎦,
R2 −I =
⎡
⎢⎢⎣
¯2 0 0
0 ¯2 0
0 0 0
⎤
⎥⎥⎦,
R3 −I =
⎡
⎢⎢⎣
0 0 0
0 ¯2 0
0 0 ¯2
⎤
⎥⎥⎦,
R4 −I =
⎡
⎢⎢⎣
¯2 0 0
0 0 0
0 0 ¯2
⎤
⎥⎥⎦,
Substitution in (3.25) gives the following allowed translations:
(0, 0, 0),
1
2, 1
2, 0

,

0, 1
2, 1
2

,
1
2, 0, 1
2

,
1
4, 1
4, 1
4

,
3
4, 3
4, 1
4

,
1
4, 3
4, 3
4

,
3
4, 1
4, 3
4

,
3
4, 3
4, 3
4

,
1
4, 1
4, 3
4

,
3
4, 1
4, 1
4

,
1
4, 3
4, 1
4

,
1
2, 0, 0

,
1
2, 1
2, 1
2

,

0, 1
2, 0

,

0, 0, 1
2

.
We can see that the centring condition of the cell adds, in this case, further
allowed origins with respect to P222. Neglecting those corresponding to the
vectors Bv, the permissible translations become
(0, 0, 0),
1
4, 1
4, 1
4

,
1
2, 1
2, 1
2

,
3
4, 3
4, 3
4

,
in accordance with Table 3.4.
In non-primitive space groups, the systematic absences due to the centring
of the cell can conveniently be associated with the conditions deﬁning the
seminvariant moduli and vectors. For instance, in the space group I222 equa-
tions (3.18) or (3.21) alone would deﬁne a seminvariant vector h′s = (h, k, l)
and a modulus ω′s = (2, 2, 2). Considering also that the reﬂections with

Table 3.4 Allowed origin translations, seminvariant moduli, and phases for non-centrosymmetric, non-primitive space groups
H–K family
(k, l)
C(0, 2)
(h, l)
C(0, 0)
(h, l)
C(2, 0)
(h, l)
C(2, 2)
(h, l)
A(2, 0)
(h, l)
I(2, 0)
(h, l)
I(2, 2)
(h + k + l)
F(2)
(h + k + l)
F(4)
(l)I(0)
(l)I(2)
(2k – l)
I(4)
(l)F(0)
I
Space group
C2
Cm
Cmm2
C222
Amm2
Imm2
I222
F432
F222
I4
I422
I¯4
Fmm2
I23
Cc
Cmc21
C2221
Abm2
Iba2
I212121
F4132
F23
I41
I4122
I¯4m2
Fdd2
I213
Ccc2
Ama2
Ima2
F¯43m
I4mm
I¯42m
I¯4c2
I432
Aba2
F¯43c
I4cm
I¯42d
I4132
I41md
I¯43m
I41cd
I¯43d
Allowed origin
translations
(0, y, 0)
(0, y, 1
2 )
(x, 0, z)
(0, 0, z)
 1
2 , 0, z
 (0, 0, 0)

0, 0, 1
2

 1
2 , 0, 0

 1
2 , 0, 1
2

(0, 0, z)
 1
2, 0, z
 (0, 0, z)
 1
2, 0, z
 (0, 0, 0)

0, 0, 1
2


0, 1
2 , 0

( 1
2 , 0, 0)
(0, 0, 0)
 1
2 , 1
2 , 1
2

(0, 0, 0)
 1
4, 1
4, 1
4

 1
2, 1
2, 1
2

( 3
4 , 3
4 , 3
4 )
(0, 0, z)
(0, 0, 0)

0, 0, 1
2
 (0, 0, 0)

0, 0, 1
2

 1
2 , 0, 1
4

( 1
2 , 0, 1
4 )
(0, 0, z)
(0, 0, 0)
Vector hs,
seminvariantly
associated with
h = (h, k, l)
(k, l)
(h, l)
(h, l)
(h, l)
(h, l)
(h, l)
(h, l)
(h + k + l)
(h + k + l)
(l)
(l)
(2k – 1)
(l)
(h, k, l)
Seminvariant
modulus ωs
(0, 2)
(0, 0)
(2, 0)
(2, 2)
(2, 0)
(2, 0)
(2, 2)
(2)
(4)
(0)
(2)
(4)
(0)
(1, 1, 1)

Table 3.4 (Continued)
H–K family
(k, l)
C(0, 2)
(h, l)
C(0, 0)
(h, l)
C(2, 0)
(h, l)
C(2, 2)
(h, l)
A(2, 0)
(h, l)
I(2, 0)
(h, l)
I(2, 2)
(h + k + l)
F(2)
(h + k + l)
F(4)
(l)I(0)
(l)I(2)
(2k – l)
I(4)
(l)F(0)
I
Seminvariant
phases
φe0e
φ0e0
φee0
φeee
φee0
φee0
eee
φeee
φhkl with
h + k + l ≡0
(mod 4)
φhk0
φhke
φhkl with
(2k −l) ≡0
(mod 4)
φhk0
All
Allowed
variations for
the semi-
independent
phases
∥∞∥,
∥2∥
if k = 0
∥∞∥
∥∞∥,
∥2∥
if l = 0
∥2∥
∥∞∥,
∥2∥
if l = 0
∥∞∥,
∥2∥
if l = 0
∥2∥
∥2∥
∥2∥if
h + k + l ≡0
(mod 2)
∥4∥if
h + k + l ≡1
(mod 2)
∥∞∥
∥2∥
∥2∥if
h + k + l ≡0
(mod 2)
∥4∥if
2k −l ≡1
(mod 2)
∥∞∥
All
Number of
seminvariant
phases to be
speciﬁed as
family
2
2
2
2
2
2
2
1
1
1
1
1
1
0

Origin deﬁnition by phase assignment
81
h + k + l ı 0 (mod 2) are systematic absences, it will be sufﬁcient to choose
hs = (h, k) and ωs = (2, 2). In this way we ﬁnd that the dimensions of vectors
hs and ωs correspond with the number of phases to be speciﬁed in order to ﬁx
the origin.
3.7
Origin deﬁnition by phase assignment
Direct methods (see later in this book) are a typical phasing approach working
in reciprocal space; they associate phase values with structure factors, and a
subsequent Fourier synthesis may reveal the crystal structure. Since no struc-
ture is geometrically deﬁned without having ﬁxed in advance the origin of
the reference system, one must deduce that phase assignment in some way
implicitly includes the origin deﬁnition. When and how is this done during
the phasing process? In order to clarify this point, we ﬁrst discuss the follow-
ing question: is it possible to assign arbitrary phases to one or more structure
factors (Zachariasen (1952); Hauptman and Karle (1953))?
We should specify what we mean by arbitrarily assigning one or more
phases. Suppose that we have chosen a class of origins; at the same time, the
symmetry operators and the functional form of the structure factors are ﬁxed.
As we have seen in the preceding sections, the choice of symmetry operators
leads to some restrictions on the phase values of certain classes of reﬂections.
To give some trivial examples, we recall that in space group P¯1, when the ori-
gin is chosen on an inversion centre, the phases can only assume values 0 or
π; similarly, in space group P2, if the origin is chosen on a twofold axis (coin-
ciding with b) the (h0l) reﬂections will have phases 0 or π. Therefore, when
we talk of arbitrary assignment of the phase to one or more reﬂections, we will
always refer to the phase values allowed by the chosen functional form of the
structure factor.
From the theory so far developed, it is obvious that a phase value can be
arbitrarily assigned to one or more structure factors if there is at least one
allowed origin which, ﬁxed as the origin of the unit cell, will give those phase
values to the chosen reﬂections. Let us suppose that, for a given H–K family,
φh1 is not a s.s. Its value can be ﬁxed arbitrarily (within the limitations given
above), because there exists at least one origin compatible with the given value.
Once φh1 is assigned, a second phase φh2 cannot be ﬁxed arbitrarily if φh2 is a
s.s., or if φh1 + φh2 is a s.s.
Suppose now that neither φh1, nor φh2, nor φh1 + φh2 are s.s.s. The necessary
condition to be able to arbitrarily assign a third phase φh3 is that none of φh1,
φh2, φh3, φh1 + φh2, φh1 + φh3, or φh2 + φh3, φh1 + φh2 + φh3 is a s.s. As a rule
for ﬁxing the origin, three phases can be assigned in those H–K families for
which ωs is of type (l1, l2, l3), two phases when ωs = (l1, l2), one phase when
ωs = (l), and no phase when all φ are s.s.s.
As an example, in P¯1 the origin may be deﬁned by assigning three phases,
provided that none of the following indices,
h1, h2, h3, h1 + h2, h1 + h3, h2 + h3, h1 + h2 + h3
is of type (even, even, even).

82
The origin problem, invariants, and seminvariants
But, how can we arbitrarily ﬁx the enantiomorph? We observe that, if a s.s.
(single phase or a combination of phases) has a value  for a given structure, it
will have the value − for the enantiomorph structure. However, if  is equal
to zero, the s.s. has the same value for both enantiomorphs. Therefore, once
the origin has been deﬁned, the sign of a s.s., different from zero or π, can be
arbitrarily assigned.
So far, we have seen that up to three phases may be freely assigned for deﬁn-
ing the origin, and one phase should be ﬁxed for deﬁning the enantiomorph.
After that, the phasing process may progressively determine the other phases,
which, if the phasing procedure succeeds, will be consistent with a unique ori-
gin. It is, however, useful to stress that the procedure quite often starts with
an origin deﬁnition and stops with phases consistent with another origin. It is
nowadays impossible to foresee which origin the phasing process will choose.
The problem of ﬁxing the origin in direct space by assigning phases in recip-
rocal space impassioned many scientists in the second half of the past century;
indeed, the most popular phasing procedures started with a small set of phases,
including those for origin deﬁnition, which, suitably extended, could lead to
the crystal structure solution. Today, this logical but primitive approach is no
longer followed; thus the origin deﬁnition problem is a curiosity rather than an
essential for phasers. The reader will ﬁnd a thorough treatment of this subject
in Direct Phasing in Crystallography, Chapter 2.

The method of joint
probability distribution
functions,
neighbourhoods,
and representations
4
4.1
Introduction
Wilson statistics, described in Chapter 2, aims at calculating the distribution of
the structure factor P(F) ≡P(|F|, φ) when nothing is known about the struc-
ture; the positivity and atomicity of the electron density (both promoted by
the positive nature of the atomic scattering factors fj) are the only necessary
assumptions. Wilson results may be synthesized as follows:
the modulus R = |E| is distributed according to equations (2.7) or (2.8),
while no prevision is possible about φ, which is distributed with constant
probability 1/(2π).
In other words, knowledge of the R moduli does not provide information about
a phase; this agrees well with Section 3.3, according to which experimental
data only allow an estimate of s.i. (and also s.s. if the algebraic form of the
symmetry operators has been ﬁxed).
Let us now consider P(Fh1, Fh2) ≡P(|Fh1|, |Fh2|, φh1, φh2), the joint probab-
ility distribution function of two structure factors. If the two structure factors
are uncorrelated (i.e. no relation is expected between their moduli and between
their phases), P will coincide with the product of two Wilson distributions (2.7)
or (2.8), say,
P(Fh1, Fh2) ≡P(|Fh1|, φh1) · P(|Fh2|, φh2) =
1
4π2 P(|Fh1|)P(|Fh2|),
which is useless (because the two Wilson distributions are useless) for solv-
ing the phase problem; indeed, the relation does not provide any phase
information.
The question is now: if two structure factors are correlated, may their joint
probability distribution function be used for solving the phase problem? Let
us ﬁrst use a simple example to show how much additional information (i.e.
that is not present in the two elementary distributions) may be stored in a joint
probability distribution function; then we will answer the question.
Let us suppose that the human population of a village has been submitted to
statistical analysis to deﬁne how weight and height are distributed. From the

84
Joint probability distribution functions, neighbourhoods, and representations
study of the frequencies, two distributions have been obtained, called Pw and
Ph, the ﬁrst for weight and the second for height. Let us also suppose that the
following numerical values have been found:
Pw(30) dw = Pw(70) dw = 0.15
and that
Ph(100) dh = Ph(170) dh = 0.15.
Pw(X) dw is the probability of ﬁnding a person with weight X (in kilos), in the
interval dw around X, and Ph(Y) dh is the probability of ﬁnding a person with
height Y (in cm) in the interval dh around Y.
If height and weight were statistically independent, their joint probability
should be
P (X, Y) dX dY = Pw(X) Ph(Y) dw dh,
and therefore the following equalities should arise:
P (30, 100) dh dw = P (30, 170) dh dw = P (70, 100) dh dw = P (70, 170) dh dw = 0.0225.
We know, however, that for humans, height and weight are correlated and
therefore the above equalities cannot be true. Indeed, it may be expected that
the probability values
P (30, 100) dh dw and P (70, 170) dh dw
should be larger than the values
P (30, 170) dh dw and P (70, 100) dh dw.
Accordingly, the correct joint probability function cannot be the product of the
two elementary distributions, but should take into account the covariance of
the variables weight and height in order to be a realistic statistical description
of the population.
Let us now transfer the above example to the joint distribution of structure
factors. A correlation among structure factors implies that some combination
of phases should have a non-vanishing probability of assuming a given value;
this is just the basis for the solution of the phase problem. For example, let us
suppose that the following relations hold:
(a) < FhFk >≡< |FhFk| expi(φh + φk) >≈sFl ≡s|Fl| exp(iφl)
(b) < FhFkFl >≡<|FhFkFl| expi(φh + φk + φl)>≈tFm ≡t|Fm| exp(iφm),
where s and t are suitable scaling factors. In the ﬁrst case we may conclude
that Fh and Fk are not statistically independent and that the phase relationship
(φh + φk) ≈φl
may be expected. In case (b) it may be concluded that Fh, Fk, and Fl are not
statistically independent, and that the phase relationship
(φh + φk + φl) >≈φm
may be expected. The above results would suggest using the joint probability
distributions of structure factors to discover the correlations between structure
factors.

Introduction
85
The introduction into crystallography of the joint probability distribution
of a set of n normalized structure factors was the great goal of Hauptman and
Karle (1953); they showed that moduli and phases belonging to different struc-
ture factors are correlated when their indices are chosen in such a way as to
constitute s.i.s or s.s.s. After this, other important contributions in the area of
joint probability distributions followed, e.g. Bertaut (1955a,b, 1960a,b), Klug
(1958), Naya et al. (1964, 1965), and by Giacovazzo and co-workers in a wide
series of papers that will be referred to in various chapters of this book.
So, how do we choose structure factors for the study of the statistical prop-
erties of s.i.s (and s.s.s)? The simplest approach is as follows: if one wants to
study the s.i.,
 =
n
i=1 φhi, with h1 + h2 + · · · · · · + hn = 0
(4.1)
the set of normalized structure factors {E} =

Eh1, Eh2, . . . , Ehn

should be
considered. In terms of joint probability distribution functions, the probability
P(Eh1, Eh2, . . . , Ehn) ≡P(Rh1, Rh2, . . . , Rhn, φh1, φh2, . . . , φhn)
(4.2)
should be studied. If we apply equation (4.2) to the triplet invariant
 = (φh + φk + φ−h−k),
the joint probability
P(Eh, Ek, Eh+k) ≡P(Rh, Rk, Rh+k, φh, φk, φh+k)
(4.3)
should be considered (see Chapter 5).
This simple approach can be generalized as follows. It may be supposed
that the n-phase s.i. (4.1) can be better estimated by exploiting more exper-
imental information, e.g. via a number of diffraction amplitudes p>n. The
general mathematical machinery could be:
1. The set of reﬂections
{E} =

Eh1, Eh2, . . . , Ehn, . . . , Ehp

,
which is considered to be useful for the estimation of the s.i. or s.s. (4.1) is
deﬁned. Appropriate sets can be chosen according to the methods described
in Section 4.2.
2. The joint probability
P(Eh1, Eh2, . . . , Ehn, . . . , Ehp)
≡P(Rh1, Rh2, . . . , Rhn, . . . , Rhp, φh1, φh2, . . . , φhn, . . . , φhp)
(4.4)
is calculated.
3. The conditional distribution (i.e. probability of the phases, given the
moduli)
P(φh1, φh2, . . . , φhn, . . . , φhp|Rh1, Rh2, . . . , Rhn, . . . , Rhp)
(4.5)
is derived (indeed, we are interested to guess about the phases while
Rh1, Rh2, . . . , Rhn, . . . , Rhp are known from experiments, therefore constitut-
ing the primary information to exploit).

86
Joint probability distribution functions, neighbourhoods, and representations
4. Since we want to estimate  = n
i=1 φhi and we have no interest in the
unknown phases φhn+1, . . . , φhp, we can integrate the conditional distribu-
tion (4.5) over the phases φhn+1, . . . , φhp to obtain the marginal distribution,
P(φh1, φh2, . . . , φhn|Rh1, Rh2, . . . , Rhn, . . . , Rhp).
(4.6)
Expression (4.6) provides the distribution of the n phases φh1, φh2, . . . , φhn
no matter what are the values of φhn+1, . . . , φhp. From (4.6), integration over
φh1, φh2, . . . , φhn under the condition that φh1 + φh2 + · · · + φhn =  provides
the required s.i. phase distribution
P(|Rh1, Rh2, . . . , Rhn, . . . , Rhp)
(4.7)
given the chosen set of moduli. In a more general way we can represent (4.7) by
P(| {R}),
(4.8)
where {R} represents the appropriate set of diffraction amplitudes.
In order to illustrate how to move from (4.6) to (4.7) we consider a two-
dimensional example. Let us suppose that we have derived the distribution
P(φh1, φh2|Rh1, Rh2) and that we want to derive P(|Rh1, Rh2), where  =
φh1 + φh2. We then set φh2 =  −φh1 and we integrate P(φh1, φh2|Rh1, Rh2)
over φh1, according to
P(|Rh1, Rh2) =
 2π
0
P(φh1,  −φh1|Rh1, Rh2)dφh1.
The result is the probability distribution of the phase  = φh1 + φh2, given
the two magnitudes Rh1, Rh2. To provide further insight into its meaning in
practice, let us suppose that, according to P(|Rh1, Rh2), the most probable
value of  is zero, and that the reliability of the relation  ≈0 is proportional
to the product Rh1Rh2. In this case, if we want to select the cases in which
relation  ≈0 is more reliable, we need only consider those in which both Rh1
and Rh2 are sufﬁciently large.
The mathematical approach described so far is very ﬂexible. For example,
if we suppose that of the n phases, φh1, φh2, . . . , φhn, n–1 are known (i.e.
φh2, . . . , φhn), then, from (4.6) the conditional distribution
P(φh1|φh2, . . . , φhn, Rh1, Rh2, . . . , Rhn, . . . , Rhp)
(4.9)
may be derived. Prior information now consists of n–1 phases and p mag-
nitudes, all used to estimate the single phase φh1. We will see in the next part
of the book that distributions (4.7) and (4.9) are equally useful.
Which mathematical techniques should be used in deriving the joint probab-
ility distributions of structure factors? The method should not be a surprise to
crystallographers; they well know that, if the electron density ρ(r) is inaccess-
ible, while access is allowed to its Fourier transform F(r∗), then the necessary
operation for recovery ρ(r) is to calculate the inverse Fourier transform of
F(r∗). By analogy, for each joint distribution (4.4), its Fourier transform C is
ﬁrst calculated (called the characteristic function in statistics), then (4.4) is
obtained via an inverse Fourier transform of C. The mathematical techniques
used to calculate the two Fourier transforms are described in Appendix 4.A.
A further point to deﬁne is how to choose the primitive variables in such
probabilistic approaches. In accordance with Section 2.2, the crystallographic

Neighbourhoods and representations
87
problem is quite clear: the joint distribution P(Eh1, Eh2, . . . , Ehn) involves a
number of normalized structure factors each of which is a linear sum of ran-
dom variables; i.e. the atomic contributions to the structure factors. So, for
a statistical interpretation of the phase problem, the atomic positions may be
considered as primitive random variables.
An alternative basis (see Section 2.2) is that the crystal structure is assumed
to be ﬁxed while the reciprocal vectors are assumed to be the random variables.
Although the two types of distribution are distinct, we can expect almost equi-
valent results in many cases, because of the symmetrical role played by h and
r in the algebraic form of the structure factor. Thus, for derivation of the phase
probability for various s.i.s often only one kind of distribution is needed. As
a general rule, in this book the atomic position vectors will be assumed to
be primitive random variables. This is due to the fact that when prior struc-
tural information is available (e.g. a group of atoms has been well oriented and
positioned), it is more easily treated if the atomic positional vectors are the
primitive random variables.
The reader should not think that this method only concerns the structure
factors of one crystal structure. Indeed, if a model structure and/or a derivative
structure are correlated with the structure under study, then the corresponding
structure factors are expected to be correlated, thus suggesting the study of
joint probability distributions involving the Es of the structure under study and
the Es of the model and/or the derivative structure. This type of distribution
is very useful in macromolecular crystallography, and in general, for modern
phasing methods, and is dealt with in some detail in this book.
In this chapter, for simplicity, we will not describe the saddle point method
(Riemann, 1892; Debye, 1909; de Bruijn, 1970; Kyrala, 1972; Bricogne,
1984), an alternative way to calculate joint probability distribution func-
tions. The interested reader is referred to Appendix 5A of Direct Phasing in
Crystallography or to the original papers.
4.2
Neighbourhoods and representations
As anticipated in Section 4.1, for any s.i. or s.s.,  we have to solve the problem
of ﬁxing the set of magnitudes which provides the most reliable estimates of .
In principle, the set may not be unique; several sets could be found, each giving
rise to a different dependence of  on the selected magnitudes. Formulation
of the nested neighbourhood principle (Hauptman, 1975b) ﬁrst ﬁxed the idea
of deﬁning a sequence of sets of reﬂections (a sequence of nested neighbour-
hoods) each contained within the succeeding one and with the property that
any s.i. or s.s. may be estimated via the magnitudes constituting any neigh-
bourhood. A practical application of the idea had already been performed,
independently, by Giacovazzo (1975b), who calculated in P¯1 the one-phase
s.s.s via the magnitudes of the second neighbourhood. Subsequently, a more
general theory was formulated (the representation theory: Giacovazzo, 1977a,
1980), which is able, for any , to arrange the set of magnitudes, provided by
the diffraction experiment, into a sequence of subsets, called phasing shells, in

88
Joint probability distribution functions, neighbourhoods, and representations
order of their expected effectiveness (in the statistical sense) for the estimation
of .
Here, we will provide a simpliﬁed description of the representation theory
in the space group P1 and P¯1. The reader interested in more details is referred
to the original papers or to Chapter 6 of Direct Phasing in Crystallography.
First representation of a structure invariant. Let
 = φh1 + φh2 + . . . + φhn
(h1 + h2 + . . . . . . + hn = 0)
(4.10)
be an s.i. Its ﬁrst representation coincides with  itself, and its ﬁrst phasing
shell is given by the collection of magnitudes {B1}, which are basis magnitudes
(i.e.

Rh1, Rh2, . . . , Rhn

) or cross-magnitudes of the s.i. The cross-magnitudes
satisfy the relation
m1h1 + m2h2 + . . . . . . + mnhn = 0,
with
mp = 0, 1
All the cross-vectors are linear combinations of the basis vectors. We give
below three examples:
1.  = φh1 + φh2 + φh3 + φh4 with h1 + h2 + h3 + h4 = 0 is a quartet invari-
ant. Its basis magnitudes are

Rh1, Rh2, Rh3, Rh4

, the cross-magnitudes
are

Rh1+h2, Rh1+h3, Rh2+h3

. Then the ﬁrst phasing shell consists of seven
magnitudes:
{B1} =

Rh1, Rh2, Rh3, Rh4, Rh1+h2, Rh1+h3, Rh2+h3

(4.11)
2.  = φh1 + φh2 + φh3 is a triplet invariant. The basis magnitudes of the ﬁrst
representation of  are

Rh1, Rh2, Rh3

, the cross terms coincide with them.
3.  = φh1 + φh2 + φh3 + φh4 + φh5 is a quintet invariant. Its basis mag-
nitudes are

Rh1, Rh2, Rh3, Rh4, Rh5

, the cross-magnitudes are {Rh1+h2,
Rh1+h3, Rh1+h4, Rh1+h5, Rh2+h3, Rh2+h4, Rh2+h5, Rh3+h4, Rh3+h5, Rh4+h5}.
The ﬁrst phasing shell{B1} then consists of 15 magnitudes:
{B1} = {Rh1, Rh2, Rh3, Rh4, Rh5, Rh1+h2, Rh1+h3, Rh1+h4, Rh1+h5,
Rh2+h3, Rh2+h4, Rh2+h5, Rh3+h4, Rh3+h5, Rh4+h5}
(4.12)
{B}3
{B}2
{B}1
Φ
Fig. 4.1
A general scheme of the phasing shell for
any s.i., .
As in music, n-tet invariants may also be considered; each can be estimated
from its ﬁrst phasing shell.
Second representation of a structure invariant. If , as deﬁned by (4.1), is
our structure invariant, its second representation is the collection of (n + 2)–tet
invariants
 =

φh1 + φh2 + . . . + φhn + φk −φk

,
(4.13)
obtained when k freely varies over reciprocal space. The second phasing shell
is the set of magnitudes constiting of the basis and cross-magnitudes of the
s.i.s (4.13). We give two examples:
1. The second phasing shell of the triplet invariant  = φh1 + φh2 + φh3 is
{B2} =

Rh1, Rh2, Rh3, Rk, Rh1+k, Rh1−k, Rh2+k, Rh2−k, Rh3+k, Rh3−k

,
where k is a free vector.

Representations of structure seminvariants
89
|Eh2 ± k ± 1|
|Eh3 ± k ± 1|
|Eh1 ± k ± 1|
|E1|
|Ek|
|Eh1|
|Eh2|
|Eh3|
|Ek ± 1|
|Eh1 ± 1|
|Eh2 ± k|
|Eh3 ± 1|
|Eh3 ± k|
|Eh2 ± 1|
|Eh1 ± k|
Φ
Fig. 4.2
The sequence of the ﬁrst three phasing
shells in P1 and P¯1 for the s.i.,  = φh1 +
φh2 + φh3.
2. The second phasing shell of the quartet invariant  = φh1 + φh2 + φh3 +
φh4 is
{B2} = {Rh1, Rh2, Rh3, Rh4, Rh1+h2, Rh1+h3, Rh2+h3, Rk, Rh1±k, Rh2±k, Rh3±k,
Rh4±k, Rh1+h2±k, Rh1+h3±k, Rh2+h3±k}.
Third representation of a structure invariant. If , as deﬁned by (4.1), is our
structure invariant, its third representation is the collection of (n + 4) –tet
invariants,
 =

φh1 + φh2 + · · · + φhn + φk −φk + φl −φl

,
(4.14)
where k and l are free vectors in the reciprocal space. The third phasing shell
may be deﬁned similarly to above.
These deﬁnitions suggest that an s.i. of order n is represented in its second
representation by special invariants of order n + 2, in its third representation
by special invariants of order n + 4, etc., and that the reciprocal space may
be arranged into subsets of measured reﬂections, the phasing shells, each con-
tained within the succeeding one and having the property that any s.i. or s.s.
may be estimated via the magnitudes of the shell.
|Ek|
|Eh1|
|Eh2|
|Eh3|
|Eh4|
|Eh1+ h3±  k|
|Eh1+ h2±  k|
|Eh2 + h3±  k|
|Eh2+ h3|
|Eh4±  k|
|Eh2±  k|
|Eh1+ h3|
|Eh1+ h2|
|Eh3±  k|
|Eh1 ± k|
Φ
Fig. 4.3
The sequence of the ﬁrst two phasing
shells in P1 and P¯1 for the s.i.,  = φh1 +
φh2 + φh3 + φh4.
A symbolic way of representing such an arrangement of the reciprocal space
in phasing shells is shown in Figs. 4.1–4.3. Figure 4.1 is a symbolic way
of partitioning the reciprocal space according to the subsets

Bj

; Figs. 4.2
and 4.3 show the ﬁrst phasing shells for a triplet and for a quartet invariant
respectively.
Extension of the concept of s.i. representation is more complicated when
symmetry is taken into account (but also more rewarding, because symmetry
allows us to exploit a larger number of cross-magnitudes). We refer the inter-
ested reader to Chapter 6 of Direct Phasing in Crystallography, or to the
original papers.
4.3
Representations of structure seminvariants
It was shown in Section 3.5 that  = φu1 + φu2 + · · · · +φun, where uj is the
generic reciprocal vector, is an s.s. if its value does not change when the origin

90
Joint probability distribution functions, neighbourhoods, and representations
moves from one to another allowed or permissible origin. In other words,  is
an s.s. if,
n
j=1 uj

xp = r,
p = 1, 2, . . . ,
where r is a positive, null, or negative integer, and

xp, p = 1, 2, . . .

are the
allowed translations between permissible origins.
The theory of representations provides more useful (for phasing purposes)
deﬁnitions of the s.s.s. In particular, the theory identiﬁes two types of s.s.: ﬁrst
and second rank seminvariants. To deﬁne the s.s.s of the ﬁrst rank:
 = φu1 + φu2 + · · · + φun is an s.s. of the ﬁrst rank if at least one phase,
φh1, and a symmetry operator, Cp ≡(Rp, Tp), exist such that
1 = φu1 + φu2 + · · · + φun + φh1 −φh1Rp
(4.15)
is an s.i. Once 1 is estimated from the observed amplitudes,  is estimated
simultaneously. Indeed, because of equation (1.25), we may rewrite (4.15) in
the form,
1 =  + p,
where p = 2πh1Tp is the phase shift arising because of translational sym-
metry. For the same , further h1 reﬂections and therefore more invariants 1
may be found. The set {1} is called the ﬁrst representation of .
Let us give some examples.
1.  = φu1 = φ406 is an s.s. of ﬁrst rank in P2; in fact (4.15) is veriﬁed by
Rs = I, h1 = (2k3), Rp = R2. Accordingly, the ﬁrst representation of  is
the collection of the special triplet invariants
1 = φ406 −φ2k3 + φ¯2k¯3,
with k a free index
2. The ﬁrst representation in P¯1 of  = φ2h coincides with one special triplet
only:
1 = φ2h −φh −φh.
The estimate of φ2h will depend on R2h and Rh only.
3.  = φ123 + φ¯7¯2¯5 is an s.s. of the ﬁrst rank in P222; in fact (4.15) is veriﬁed
when
Rs = Rt = I
Rp =
						
¯1 0 0
0 1 0
0 0 ¯1
						
,
h1 = (3, k, 1),
or
Rs = I
Rt = Rp =
						
¯1 0 0
0 1 0
0 0 ¯1
						
,
h1 = (¯4, k, ¯4).
Accordingly, the ﬁrst representation of F is the collection of special
quartets,
1 = φ123 + φ¯7¯2¯5 + φ3k1 −φ¯3k¯1
(4.16a)

Representation theory for structure invariants extended to isomorphous
91
and
′
1 = φ123 + φ7¯25 + φ¯4k¯4 −φ4k4.
(4.16b)
Again, k is a free index.
4. The ﬁrst representation in P¯1 of the two-phase s.s. of ﬁrst rank,  = φu1 +
φu2 = φh+k + φh−k, is the collection of two special quartets:
′
1 = φh+k + φh−k −φh −φh,
′′
1 = φh+k −φh−k −φk −φk.
(4.17)
Suppose now that F is an s.s. for which (4.15) cannot be satisﬁed, but
two phases, φh1 and φh2, and four symmetry operators Cp, Cq, Ci, Cj can
be found such that
1 = φu1Rs + φu2Rt + · · · + φunRv + φh1Rp −φh1Rq + φh2R1 −φh2Rj
(4.18)
is an s.i. Then F is an s.s. of second rank. In this case, the ﬁrst representation
of F is the collection of s.i.s, {}1, deﬁned by (4.18).
As an example, for space groups with point group 222, the s.s.s  = φu1
for which
u1 ≡0 mod (0, 2, 2) or (2, 0, 2) or (2, 2, 0)
are of ﬁrst rank, whereas the s.s.s for which this condition is not fulﬁlled,
but the condition
u1 ≡0 mod (2, 2, 2)
is satisﬁed, are of the second rank. Thus,  = φ246 and  = φ146 + φ3¯62
are both s.s.s of the second rank.
The reader can easily verify the following rule: an n-phase s.s. of the ﬁrst
rank is represented in its ﬁrst representation by a collection of n + 2-phase
invariants if it is of ﬁrst rank, by a collection of n + 4-phase invariants if it is
of second rank.
For both ﬁrst and second rank s.s.s the ﬁrst phasing shell {B}1 is the collec-
tion of the R magnitudes which are basis or cross-magnitudes of at least one
1 ∈{}1. For example:
1. The ﬁrst phasing shell {B}1 of  = φ123 + φ¯7¯2¯5 in P222 is (see the relations
(4.16))
{B}1 = {R123, R725, R3k1, R4k4, R¯60¯2, R808},
with k the free index.
2. The ﬁrst phasing shell corresponding to the ﬁrst representation (4.17) of
 = φh+k + φh−k is
{B}1 = {Rh+k, Rh−k, Rh, Rk, R2h, R2k}.
4.4
Representation theory for structure
invariants extended to isomorphous data
It will be shown in various chapters of this book that isomorphous data (say
data corresponding to crystal structures with correlated electron density) play

92
Joint probability distribution functions, neighbourhoods, and representations
a central role both in small molecules and in macromolecular crystallography.
A typical pair of isomorphous structures consists of the target structure (the
structure of which we want to know the electron density) and a model struc-
ture, eventually available at a given step of the phasing process. Other types of
isomorphous data are those available in anomalous dispersion or in isomorph-
ous derivative techniques, as well as in molecular replacement applications
(see Chapters 13 to 15).
In general, for a given index, h, a collection of moduli Rj,h, say
Rj,h j = 1, . . . . , b
might be available. For example:
1. If a model structure is available, both the measured modulus Rh (of the tar-
get structure) and the calculated (from the model) Rph values are disposable.
Then b = 2 and
R1,h = Rh,
R2,h = Rph.
2. If diffraction data from two heavy atom derivatives are available (besides
native protein data), then b = 3; R1,h may correspond to the native protein
while R2,h and R3,h refer to isomorphous derivatives.
3. If measurements are made at a speciﬁc wavelength generating anomalous
dispersion effects, then b = 2. The isomorphous pairs are then the Friedel
related reﬂections
R1,h = Rh,
R2,h = R−h.
If two wavelengths λ1 and λ2 are used, then b = 4 and
R1,h = Rλ1,h,
R2,h = Rλ1,−h,
R3,h = Rλ2,h,
R4,h = Rλ2,−h.
We now state here, for P1 and P¯1, the necessary deﬁnitions for s.i.s and s.s.s
and their main properties (for simplicity, we do not use the symmetry, even if
useful).
First representation of a structure invariant. For a given s.i.,
 = φi,h1 + φi,h2 + . . . + φi,hn,
the collection of distinct s.i.s
 =

φi,h1 + φj,h2 + . . . + φr,hn

,
obtained when i, j, . . . , r vary over the different isomorphous data set is called
the ﬁrst representation of .
We will now give some practical examples.
1. The phase
 = φi,h + φj,−h = φi,h −φj,h
is an s.i. i and j correspond with the pair (model structure, target structure),
(protein, isomorphous derivative), or (ﬁrst isomorphous derivative, second
isomorphous derivative), etc.

The method of structure factor joint probability distribution functions
93
2.
 = φi,h + φi,−h
corresponds with data collected at the same wavelength (anomalous disper-
sion exciting) for two Friedel related reﬂections.
3.
 = φi,h + φj,−h
or
 = φi,h −φj,h
corresponds to data collected at two different wavelengths, both exciting
anomalous dispersion.
4. In the case of a native protein and one heavy atom derivative, the ﬁrst
representation of the triplet invariant
 = (φ1,h1 + φ1,h2 + φ1,h3)
is the collection of eight triplets,
(φ1,h1 + φ1,h2 + φ1,h3), (φ1,h1 + φ1,h2 + φ2,h3)
(φ1,h1 + φ2,h2 + φ1,h3), (φ2,h1 + φ1,h2 + φ1,h3)
(φ1,h1 + φ2,h2 + φ2,h3), (φ2,h1 + φ1,h2 + φ2,h3)
(φ2,h1 + φ2,h2 + φ1,h3), (φ2,h1 + φ2,h2 + φ2,h3),
The same eight triplets are the ﬁrst representation of the target triplet invariant,
 = (φh1 + φh2 + φ−h1−h2),
when a model structure exists (the subscript 1 then corresponds to the target
and the subscript 2 to the model structure).
For simplicity, we do not involve examples of quartet invariants, we will not
introduce the concept of upper representation (which may easily be deduced
from the deﬁnitions given in Section 4.2), and we also avoid introducing the
symmetry. Interested readers are referred to Chaper 6 of Direct Phasing in
Crystallography.
APPENDIX 4.A
THE METHOD OF STRUCTURE
FACTOR JOINT PROBABILIT Y
DISTRIBUTION FUNCTIONS
4.A.1
Introduction
The method of joint probability distributions plays a special role in phasing
approaches. As stated in the main text, it was introduced into crystallography
by Hauptman and Karle (1953) and has since been successfully applied to an
extraordinary variety of cases. Even if most of the phase relationships we will
treat in this book may be obtained via algebraic considerations, the probab-
ilistic techniques are the only methods capable of also associating reliability
criteria. The general reader, if only involved in practical phasing applications,
may not be interested in going deeper into this topic. However, a brief descrip-
tion of its bases is mandatory, in order to inform other readers more interested
in aspects of theoretical phasing.

94
Joint probability distribution functions, neighbourhoods, and representations
4.A.2
Multivariate distributions in
centrosymmetric structures: the case
of independent random variables
Let us consider a cs. space group of order m. We wish to develop an expression
for the joint probability distribution,
P(Eh1, Eh2, . . . , Ehn),
(4.A.1)
which does not depend on the choice of primitive random variables. Then, it
could be applied to the wide variety of situations frequently encountered in the
course of direct phasing procedures. We will use the notation
Fh =
t
j=1
ξj(h),
where
ξj(h) = fj(h)
m

s=1
exp(2πi¯hCsrj),
and t is the number of atoms in the asymmetric unit. For the sake of simplicity,
we will assume that no atom is in a special position. Then, according to (2.6),
Eh =
Fh

|Fh|21/2 =
t
j=1
ξ ′
j (h),
where
ξ ′
j (h) =
ξj(h)

|Fh|21/2 .
⟨|Fh|2⟩is calculated according to available speciﬁc prior information. We make
the explicit assumption, valid for Sections 4.A.2 to 4.A.4, that the primitive
random variables are statistically independent of each other.
The distribution (4.A.1) may be found (refer to Appendix M.A) by taking
the Fourier transform of the characteristic function
C(u1, u2, . . . , un),
where ur is the carrying variable associated with Ehr. In accordance with Klug
(1958) and Karle and Hauptman (1958), this is given by
C(u1, . . . , un) =

exp[i(u1Eh1 + u2Eh2 + · · · + unEhn)]

=

exp

i

u1
t
j=1
ξ ′
j(h1) + u2
t
j=1
ξ ′
j (h2) + · · · + un
t
j=1
ξ ′
j(hn)

.
(4.A.2)

The method of structure factor joint probability distribution functions
95
Since each random variable is supposed to be statistically independent,
equation (4.A.2) may be written as
C(u1, . . . , un) = ⟨exp{i[u1ξ ′
1(h1) + u2ξ ′
1(h2) + · · · + unξ ′
1(hn)]}⟩
·⟨exp{i[u1ξ ′
2(h1) + u2ξ ′
2(h2) + · · · + unξ ′
2(hn)]}⟩
...
...
...
...
...
...
...
...
·⟨exp{i[u1ξ ′
t (h1) + u2ξ ′
t (h2) + · · · + unξ ′
t(hn)]}⟩
=
t
j=1
jC(u1, u2, . . . , un).
(4.A.3)
In (4.A.3), jC is the characteristic function of the joint probability distribu-
tion of the contributions of the jth atom to Eh1, . . . , Ehn. Equation (4.A.3) is
the required expression of the characteristic function. The averages in
(4.A.3) should be taken over h or over r, depending on whether h or r is the
primitive random variable. In this last case, each average in (4.A.3) may be
accomplished by integrating over the space spanned by r, provided the prior
probability qj(r) is introduced (qj(r) is the probability that the jth atom is in r):
jC(u1, u2, . . . , un) =

qj(r) exp

i

u1ξ ′
j (h1) + · · · + unξ ′
j (hn)

dr.
(4.A.4)
In this last case, ξ ′
j should be expressed as a function of r. In general (but not
always) we will assume that qj(r) is a uniform distribution, that qi(r) = qj(r) ≡
q(r) for any pair i, j, and that each atom is statistically independent of all others.
For each jC, the multivariate cumulant generating function (see Sections
M.A.4 and M.A.7),
jK(iu1, iu2, . . . , iun) = logj C(u1, u2, . . . , un),
may be introduced, which, when expanded in the series of cumulants, gives
C(u1, u2, . . . , un) = exp

t
j=1
jK(iu1, iu2, . . . , iun)

= exp

∞

r+s+···+w=2
t
j=1
jkrs···w
r!s! · · · w!(iu1)r(iu2)s · · · (iun)w

.
(4.A.5)
The cumulants jkrs···w can be expressed in terms of joint moments mpq···t via the
relations quoted in Sections M.A.4 and M.A.7. In their turn the joint moments
may be evaluated according to the technique described in Section M.A.7.
If we emphasize the standardized cumulants of second order in the right-
hand side of (4.A.5) and we denote by Sv the contributions of all the terms
with r + s + · · · + w = v, we obtain
C(u1, u2, . . . , un) = exp

−1
2

t
j=1
jk200···

u2
1
+

t
j=1
jk020···

u2
2 + · · · +

t
j=1
jk110···

u1u2
+

t
j=1
jk1010···

u1u3 + · · ·

· exp
 ∞

v=3
Sv

,
(4.A.6)

96
Joint probability distribution functions, neighbourhoods, and representations
where
Sv =

r+s+···+w=v
⎛
⎝
t
j=1
jkrs···w
r!s! · · · w!(iu1)r(iu2)s · · · (iun)w
⎞
⎠.
(4.A.7)
The joint probability density (4.A.1) is given by the Fourier transform of
(4.A.6). If E and u are the n-dimensional column vectors, that is,
¯E = (Eh1, Eh2, . . . , Ehn),
¯u = (u1, u2, . . . , un),
we have
P(E) =
1
(2π)n

C(u) exp(−i¯uE) du
≃
1
(2π)n
 +∞
−∞
· · ·
 +∞
−∞
exp

−i¯uE −1
2 ¯uλu

exp
 ∞

v=3
Sv

d¯u,
(4.A.8)
where
λ =
⎡
⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎣

t
j=1
jk200···
 
t
j=1
jk110···
 
t
j=1
jk1010···

· · ·

t
j=1
jk10···1


t
j=1
jk110···
 
t
j=1
jk020···
 
t
j=1
jk0110···

· · ·

t
j=1
jk01···1

...
...
...
...

t
j=1
jk10···1
 
t
j=1
jk010···1
 
t
j=1
jk0010···1

· · ·

t
j=1
jk0···2

⎤
⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎦
.
(4.A.9)
If the values of Sv are estimated, (4.A.1) may, in principle, be calculated by
means of (4.A.8).
We should note explicitly that, in most practical applications (e.g. when no
prior information is available about the positional atomic vectors), (4.A.9) may
be considered to be the covariance matrix of the distribution expressed in terms
of second-order standardized cumulants. In fact, its diagonal elements equal
⟨EhpEhp⟩=

t
i, j=1
ξ ′i(hp)ξ ′j(hp)

=

t
j=1
ξ ′2
j (hp)

= 1
and its off-diagonal elements equal
⟨EhpEhq⟩=

t
i, j=1
ξ ′i(hp)ξ ′j(hq)

=

t
j=1
ξ ′j(hp)ξ ′j(hq)

=
t

j=1
jk0···10···10·

The method of structure factor joint probability distribution functions
97
4.A.3
Multivariate distributions
in non-centrosymmetric structures:
the case of independent random variables
In accordance with Section 4.A.2,
Fh =
t
j=1
ξj(h) =
t
j=1
ψj(h) + i
t
j=1
ηj(h),
where
ψj(h) = fj(h)
m
s=1
cos
#
2π ¯hCsrj
$
ηj(h) = fj(h)
m
s=1
sin
#
2π ¯hCsrj
$
.
Eh = Ah + iBh is the normalized structure factor whose algebraic expression
may be written as
Eh =
t
j=1
ξ ′
j (h) =
t
j=1
ψ′
j(h) + iη′
j(h),
where
ξ ′
j (h) =
ξj(h)

|Fh|21/2 .
Accordingly,
Ah =
t
j=1
ψ′
j(h)
Bh =
t
j=1
η′
j(h),
are the real and imaginary parts, respectively, of Eh.
We wish to develop, for a n.cs. space group of order m, an expression for the
joint probability distribution
P(Eh1, Eh2, . . . , Ehn) = P(Ah1, . . . , Ahn, Bh1, . . . , Bhn)
(4.A.10)
which does not formally depend on the choice of the primitive random
variables.
On the assumption that Aj and Bj are independent variables, let us ﬁrst
calculate the characteristic function
C(u1, u2, . . . , un, υ1, . . . , υn),

98
Joint probability distribution functions, neighbourhoods, and representations
where ur and υr are carrying variables associated with Ahr and Bhr respectively.
In accordance with Appendix M.A and Section 4.A.2 we ﬁnd that
C(u1, u2, . . . , un, υ1, . . . , υn)
= ⟨exp[i(u1A1 + u2A2 + · · · + υnBn)]⟩
=

exp

i

u1
t
j=1
ψ′
j(h1) + u2
t
j=1
ψ′
j(h2) + · · · + υn
t
j=1
η′
j(hn)

= ⟨exp{i[u1ψ′
1(h1) + u2ψ′
1(h2) + · · · + υnη′
1(hn)]}⟩
×⟨exp{i[u1ψ′
2(h1) + u2ψ′
2(h2) + · · · + υnη′
2(hn)]}⟩
· · · · · · · · · · · · · · · · · · · · · · · · · · · · · · · · · · · · · · · · · · · · ·
×⟨exp{i[u1ψ′
t(h1) + u2ψ′
t(h2) + · · · + υnη′
t(hn)]}⟩
=
t
j=1
jC(u1, u2, . . . , υn).
(4.A.11)
As in (4.A.3), jC is the characteristic function of the joint probability distri-
bution of the contributions of the jth atom to Eh1, Eh2, . . . , Ehn. Again, h or
r may be the primitive random variables. In this last case each average in
(4.A.11) may be accomplished by integrating over the space spanned by r
provided the prior probability qj(r) is introduced (qj(r) is the probability that
the jth atom is in r):
jC(u1, . . . , υn) =

qj(r) exp{i[u1ψ′
j(h1) + · · · + υnη′
j(hn)]} dr.
(4.A.12)
In this last case, ψ′
j and η′
j should be expressed as functions of r. In their turn
the moments of the distribution should be calculated via the formula
jm′
rs···w =

[ψ′
j(h1)]r[ψ′
j(h2)]s · · · [η′
j(hn)]w
=

qj(r)[ψ′
j(h1)]r[ψ′
j(h2)]s · · · [η′
j(hn)]w dr.
(4.A.13)
Details about the use of the symmetry in (4.A.13) are given in Section M.A.8.
In general (but not always), we will assume that qj(r) is a uniform distribu-
tion, that qi(r) ≡qj(r) = q(r) for any pair i,j, and that each atom is statistically
independent of the others. As in Section 4.A.2, for each jC the multivariate
cumulant generating function is introduced, which, when expanded in a series
of cumulants, leads to
C(u1, u2, . . . , un, υ1, . . . , υn) = exp
 ∞

v=2
Sv

,
(4.A.14)
where
Sv =

r+s+···+w=v
⎛
⎝
t
j=1
jkrs···w
r!s! · · · w!(iu1)r(iu2)s · · · (iυn)w
⎞
⎠.
(4.A.15)

The method of structure factor joint probability distribution functions
99
To assist the reader we will express the lower-order cumulants in terms of
moments (see Sections M.A.4 and M.A.7):
jk20···0 =

[ψ′
j(h1)]2
,j k020···0 =

[ψ′
j(h2)]2
, . . . ,
jk110···0 =

ψ′
j(h1)ψ′
j(h2)

, . . . ,j k0···02 =

[η′
j(hn)]2
,
jk1110···0 =

ψ′
j(h1)ψ′
j(h2)ψ′
j(h3)

, etc.
The distribution (4.A.10) is given by the Fourier transform of (4.A.14). If E
and u are n-dimensional vectors, that is,
¯E = (Ah1, . . . , Ahn, Bh1, . . . , Bhn),
¯u = (uh1, . . . , uhn, υh1, . . . , υhn),
we have,
P(E) =
1
(2π)2n

C(u) exp(−i¯uE) d¯u
≃
1
(2π)2n
 +∞
−∞
· · ·
 +∞
−∞
exp(−i¯uE −1
2 ¯uλu) exp
 ∞

v=3
Sv

d¯u.
(4.A.16)
4.A.4
Simpliﬁed joint probability density
functions in the absence of prior
information
Let the positional atomic vectors be the primitive random variables. If noth-
ing is known about the distribution of atoms in the asymmetric unit of the
cell, we can assume that all the non-symmetry related atoms are independently
distributed through the asymmetric unit.
Let us ﬁrst consider the cs. case. Then (see Section M.A.8),
t
j=1
jk200··· =
t
j=1
|ξ ′
j (h1)|2 = 1 =
t
j=1
jk020··· =
t
j=1
jk00···2,
while all the mixed cumulants of order two vanish:
t
j=1
jk110··· =
t

j=1
jk0110··· = · · · = 0.
Then in (4.A.8), λ reduces to a diagonal matrix with diagonal elements equal
to unity, so that (4.A.8) may be written as
P(E) ≃
1
(2π)n
 +∞
−∞
· · ·
 +∞
−∞
× exp
%
−i(u1Eh1 + · · · + unEhn) −1
2(u2
1 + · · · u2
n)
&
× exp
 ∞

v=3
Sv

du1 · · · dun.
(4.A.17)

100
Joint probability distribution functions, neighbourhoods, and representations
Under the same conditions, in a n.cs. case,
t
j=1
jk200··· =
t
j=1
jk020··· = 1
2,
while the mixed moments of order two all vanish. Then (4.A.16) becomes
P(Eh1, . . . , Ehn) ≃
1
(2π)2n
 +∞
−∞
· · ·
 +∞
−∞
×exp
%
−i(u1A1 + u2A2 + · · · + υnBn) −1
4(u2
1 + · · · + υ2
n)
&
×exp
 ∞

v=3
Sv

du1 · · · dυn.
(4.A.18)
If, in (4.A.18), we make the variable changes
'
uj =
√
2ρj cos θj,
υj =
√
2ρj sin θj,
j = 1, . . . , n
Ahj = Rhj cos φhj,
Bhj = Rhj sin φhj
j = 1, . . . , n,
(4.A.19)
we can express (see equation (M.A.22)) the joint probability density function
in terms of the magnitude R and the phase φ of the normalized s.f.s:
P(Rh1, . . . , Rhn, φh1, . . . , φhn)
≃
1
(2π)2n 2nRh1 · · · Rhn
 ∞
0
· · ·
 ∞
0
 2π
0
· · ·
 2π
0
ρ1ρ2 · · · ρn
× exp
(
−i
)√
2ρ1Rh1 cos(φh1 −θ1)
+ · · · +
√
2ρnRhn cos(φhn −θn)
*
−1
2(ρ2
1 + · · · + ρ2
n)
+
× exp
 ∞

v=3
Sv

dp1 · · · dpndθ1 · · · dθn,
(4.A.20)
where
Sv =

r+s+···+w=v
2v/2
⎛
⎝
t
j=1
jkrs···w
r!s! · · · w!iv · (ρ1 cos θ1)r(ρ2 cos θ2)s · · · (ρn sin θn)w
⎞
⎠.
(4.A.21)
The distributions (4.A.17) and (4.A.20) are basic for the following chapters.
In practice, their calculation may often be arduous, particularly when the con-
tributions of terms in Sv with v ≥5 have to be estimated. In this case it seems
likely that, even if it were possible to perform the integrations exactly in the
right-hand sides of (4.A.17) and (4.A.20), the results would be too intractable
for actual use. To simplify the calculations, the following approximation tech-
nique may be used. The second exponential functions in the right-hand sides
of (4.A.17) or (4.A.20) are expanded in power series.
The problem now is, how should the terms of the expansion be arranged? Let
us consider for the cs. case the generic term Sv, and inside it, the contribution
from the typical joint moment
jm′
rs···w =


ξ ′
j (h1)
r 
ξ ′
j (h2)
s · · ·

ξ ′
j(hn)
w
.
The contribution to Sv from this moment is
t
j=1
jm′
rs···w
r!s! · · · w! (iu1)r(iu2)s · · · (iun)w,

The method of structure factor joint probability distribution functions
101
which may be written as
1
r!s! · · · w!
t
j=1
jmrs···w

t
j=1
jξ 2
j (h1)
r/2 
t
j=1
jξ 2
j (h2)
s/2
· · ·

t
j=1
jξ 2
j (hn)
w/2 (iu1)r(iu2)s · · · (iun)w,
(4.A.22)
where jmrs···w is the joint moment for the ξ function.
If jmrs···w ̸= 0 for any j, then there are t contributions at the numerator of
(4.A.22), while at the denominator there are t(r+s+···w)/2 = tv/2 terms. In con-
clusion (4.A.22), as well as Sv, is a term of order t1−v/2. This suggests that
the terms of the expansion (Cramér, 1951; Klug, 1958) should be regrouped
against the order of t (Edgeworth series). We then write,
exp
 ∞

v=3
Sv

≃1 + S3 +

S4 + 1
2S2
3

+

S5 + S3S4 + 1
6S3
3

+

S6 + 1
2S2
4 + S3S5 + 1
2S2
3S4 + 1
24S4
3

+

S7 + S3S6 + S4S5 + 1
2S2
3S5 + 1
2S3S2
4 + 1
6S3
3S4 +
1
120S5
3

+

S8 + 1
2S2
5 + S3S7 + S4S6 + 1
6S3
4 + 1
2S2
3S6 + S3S4S5
+ 1
6S3
3S5 + 1
4S2
3S2
4 + 1
24S4
3S4 +
1
720S6
3

+ · · · .
(4.A.23)
Relation (4.A.23) is an expansion in terms of increasing t order; for example,
S3 is of order t−1/2,
#
S4 + 1
2S2
3
$
is of order t−1,
#
S5 + S3S4 + 1
6S3
3
$
is of order
t−3/2, etc. If t is large enough, each term is negligible compared with the pre-
ceding ones, but if large normalized s.f.s are involved, this may not always be
true. Therefore, only a limited number of terms in the series can be taken in
such a way that the estimate of only a small number of moments is necessary.
The above considerations suggest the following machinery.
1. The characteristic function is calculated in the exponential form or as
an Edgeworth series expansion (4.A.23). The function is truncated at a
convenient power of t, say at order t−β.
2. Only the terms Sv must be calculated which contribute to the truncated
series. For example, if the Edgeworth series is chosen and β = 2, then we
only need to calculate S2, S3, S4, S5, S6.
3. Each term Si is estimated from (4.A.7) or (4.A.15), according to whether
the space group is cs. or n.cs. respectively.
4. In their turn, the cumulants jkrs···w, on which each S depends, can be
calculated from the moments through the relation described in Sections
M.A.4 and M.A.7.
5. The integrations in the right-hand side of (4.A.17) or (4.A.18) are made.
If the space group is n.cs., (4.A.18) should be transformed into (4.A.20).
An important limitation of the method has to be outlined. Since the cumulant
generating function is expanded in a Taylor series in the vicinity of

102
Joint probability distribution functions, neighbourhoods, and representations
u1 = u2 = · · · = un = 0,
the corresponding probability distribution will be accurate only in the vicin-
ity of
E1 = E2 = · · · = En = 0.
4.A.5
The joint probability density function
when some prior information is available
We are interested in the calculation of
P(E1, E2, . . . , En)
when some prior information is available, including that involving correla-
tion among the primitive random variables. If such a correlation is present,
(4.A.3) will not hold and a more general procedure for the calculation of P
will be necessary.
We ﬁrst deal with the cs. case. The characteristic function can again be
deﬁned as
C(u1, u2, . . . , un) = ⟨exp[i(u1E1 + u2E2 + · · · + unEn)]⟩,
which in its turn, may be expanded in series:
C(u1, u2, . . . , un) = 1 + i⟨X⟩−⟨X2⟩
2!
−i⟨X3⟩
3!
+ ⟨X4⟩
4!
+ · · · ,
(4.A.24)
where
X = u1E2 + u2E2 + · · · + unEn.
As in (4.A.23), the terms in the series expansion of C(u1, . . . , un) can be
arranged in groups, so as to improve the convergence of the series. Then,
P(E1, E2, . . . , En) ≃(2π)−n
 +∞
−∞
· · ·
 +∞
−∞
exp[−i(u1E1 + · · · + unEn)]
·C(u1, u2, . . . , un) du1du2 · · · dun.
In order to emphasize the difference between this procedure and that described
in Sections 4.A.2–4.A.4, we will explain the terms ⟨X⟩and ⟨X2⟩. We have,
1. ⟨X⟩= u1⟨E1⟩+ u2⟨E2⟩+ · · · + un⟨En⟩. While ⟨X⟩= 0 in the absence of
prior information on the phase values, ⟨Ei⟩̸= 0 if this information is
available.
2. ⟨X2⟩= u2
1⟨E2
1⟩+ u2
2⟨E2
2⟩+ · · · + u2
2⟨E2
n⟩+ 2u1u2⟨E1E2⟩+ · · · + 2un−1un
⟨En−1En⟩. Since Ei = Fi/⟨|Fi|2⟩1/2, by deﬁnition ⟨E2
i ⟩= 1, but ⟨ErEs⟩
may be different from zero when supported by the prior information.
Accordingly,
⟨X2⟩= u2
1 + u2
2 + · · · + u2
n + 2u1u2⟨E1E2⟩+ · · · + 2un−1un⟨En−1En⟩.
The calculation of P(E1, E2, . . . , En) in an n.cs. space group involves similar
steps. First,
C(u1, u2, . . . , υn) = ⟨exp{i[(u1A1 + u2A2 + · · · + υnBn)]}⟩

The method of structure factor joint probability distribution functions
103
is derived through the series expansion
C(u1, u2, . . . , υn) = 1 + i⟨X⟩−⟨X2⟩
2!
−i⟨X3⟩
3!
+ ⟨X4⟩
4!
+ · · ·,
(4.A.25)
where
X = u1A1 + u2A2 + · · · + υnBn.
The variable changes (4.A.19) are then made, and the terms in the series
expression are arranged in groups so as to improve the convergence of the
series. Then,
P(Rh1, . . . , Rhn, φh1, . . . , φhn)
≃
1
(2π)2n 2nRh1 · · · Rhn
 ∞
0
· · ·
 ∞
0
 2π
0
· · ·
 2π
0
·ρ1ρ2 · · · ρn exp
(
−i
)√
2 ρ1Rh1 cos(φh1 −θ1)
+ · · · +
√
2ρnRhn cos(φhn −θn)
*,
·C(ρ1, . . . , ρn, θ1, . . . , θn) dρ1 · · · dρndθ1 · · · dθn.
(4.A.26)
4.A.6
The calculation of P(E) in the absence
of prior information
Even if the method of joint probability distribution function displays its full
power when more structure factors are considered, it may also be applied for
the calculation of P(E) (i.e. the Wilson type distribution). For the centric case,
the following distribution is obtained:
¯1P(R) =
-
2
π exp

−R2
2
 %
1 −
1
8Neff
H4(R)
&
,
(4.A.27)
where
H4(R) = R4 −6R2 + 3
is the Hermite polynomial of order four (see Appendix M.D). Compared with
(2.8) equation (4.A.27) contains a correction term of order 1/N. Supplementary
terms of higher order could be obtained if the Edgeworth series (4.A.23) were
truncated at higher powers of t.
For the acentric case, the following distribution is obtained:
1P(R) = 2R exp(−R2)
%
1 −
1
4Neff
L4(R)
&
,
(4.A.28)
where
L4(R) = R4 −4R2 + 2
is the Laguerre polynomial of order 4 (see Appendix M.D). Compared
with (2.7), equation (4.A.28) contains a correction term of order 1/N.
Supplementary terms could be obtained if the Edgeworth expansion
(4.A.23) were truncated at higher powers of t.

The probabilistic
estimation of triplet
and quartet invariants
5
5.1
Introduction
This chapter describes how to estimate, by probabilistic approaches, triplet and
quartet invariants from diffraction magnitudes. We will skip quintet (Fortier
and Hauptman, 1977a,b,c; Hauptman and Fortier, 1977a,b; Van der Putten and
Schenk, 1977; Giacovazzo, 1977b, 1980; Burla et al., 1977) and higher-order
s.i.s, because their usefulness in modern phasing procedures is entirely mar-
ginal. For simplicity, we will also skip the mathematics necessary to obtain
conclusive formulas (the general approach is described in Appendix 4.A),
except for the triplet invariants, ﬁrst representation, because of their prominent
role. Triplet and quartet estimates will be discussed, particularly in relation to
their impact on phasing procedures.
For simplicity, some other specialized topics will also be skipped, even if
theoretically relevant. For example: results obtained by Shmueli and Weiss
(1986, 1992), who used Fourier series representations of joint probability
density functions to estimate triplets; the effect of pseudotranslational sym-
metry on the triplet phase estimates, as described by Cascarano et al. (1985a,b,
1987b, 1988a,b); algebraic formulas obtained by Karle and Hauptman (1957),
Vaughan (1958), Hauptman et al. (1969), Hauptman (1970), Fischer et al.
(1970a,b), all related to (and encompassed by) the estimation of triplet phases
via their second representation. Interested readers are referred to the original
papers.
5.2
Estimation of the triplet structure invariant
via its ﬁrst representation: the P1
and the P ¯1 case
Let us ﬁrst consider the space group P1. According to Chapter 4, the simplest
way to estimate the triplet s.i.
 = φh1 + φh2 + φh3 with h1 + h2 + h3 = 0
(5.1)

Estimation of the triplet structure invariant via its ﬁrst representation
105
is to study the joint probability distribution
P(Eh1, Eh2, Eh3) ≡P(Rh1, Rh2, Rh3, φh1, φh2, φh3).
(5.2)
According to Section 4.1 we must ﬁrst calculate the characteristic function
C and then, by Fourier inversion, recover the distribution (5.2). Because of
the importance of the triplet invariant, we report the necessary calculations in
Appendix 5.A. The resulting distribution is
P(R1, R2, R3, φ1, φ2, φ3) = R1R2R3
π3
exp

−R2
1 −R2
2 −R2
3 + C cos(φ1 + φ2 + φ3)

,
(5.3)
where R1, R2, R3, φ1, φ2, φ3 stand for Rh1, Rh2, Rh3, φh1, φh2, φh3, respectively,
C = 2R1R2R3
Neq
(5.4)

Neq = σ 3/2
2
/σ3,
(5.5)
and
σn =
N
j=1 Zn
j .
N is the number of atoms in the unit cell and Zj is the atomic number of the
jth atom. If all of the atoms are of the same species (and have similar thermal
displacement), then Neq ≡N and
C = 2R1R2R3
√
N
.
The simultaneous presence of heavy and light atoms in the unit cell makes
Neq < N (see Section 5.3).
From (5.3) the conditional distribution, P(|Rh1, Rh2, Rh3), may be obtained
(abbreviated to P(); Cochran, 1955):
P() = [2πI0(C)]−1 exp(C cos ),
(5.6)
which may also be written as
P() = M(; 0, C),
where
M(; θ, C) = [2πI0(C)]−1 exp[C cos( −θ)]
is the von Mises distribution for the variable , centred at θ, with concentra-
tion parameter equal to C.
Equation (5.6) is plotted in Fig. 5.1, from which we observe:
(i) I0 is the modiﬁed Bessel function of order 0 (see Appendix M.E). We have
to think of [2πI0(C)]−1 as a scaling factor, allowing
 2π
0
P()d = 1.
(ii) Equation (5.6) has its maximum at  = 0 (where cos  = 1). It may be
concluded that the expected value of  is always zero.
(iii) The sharpest curves are obtained in correspondence with the largest val-
ues of C. Thus the statistical indication  ≈0 is reliable only if C is
sufﬁciently large. This condition is satisﬁed if all three Rs are sufﬁciently
large and N is sufﬁciently small.

106
The probabilistic estimation of triplet and quartet invariants
C = 2
C = 0
0
0
0.2
0.4
0.6
0.8
1
45
–45
90
–90
135
P(F)
–135
180
Φ
–180
C = 1
C = 4
C = 6
Fig. 5.1
The Cochran distribution P() for a
triplet phase invariant, for different values
of parameter C.
(iv) If at least one of the Rs is zero, then P() = (2π)−1: no phase indication
is obtained.
The statement  ≈0 is a statistical expectation; it does not mean that 
must be zero. To better understand this point, let us calculate the following
mean values:
< cos()> =
 2π
0
cos()P()d = D1(C)
(5.7)
< sin()> =
 2π
0
sin()P()d = 0,
(5.8)
where D1(C) = I1(C)/I0(C) is the ratio of the two modiﬁed Bessel functions
of order 1 and zero, respectively (see Fig. 5.2). According to (5.7), the average
value of < cos() > is smaller than 1, and is sufﬁciently close to 1 if C is large.
However, as for any statistical indication, it may also be that cos() is actually
negative, even if C is positive and large.
0.0
0.0
0.2
2.0
0.4
4.0
x
D1(x)
D2(x)
0.6
6.0
8.0
10.0
0.8
1.0
Fig. 5.2
The functions D1(x) and D2(x).

Estimation of the triplet structure invariant via its ﬁrst representation
107
According to (5.8), the Cochran relationship is unable to ﬁx the enantio-
morph. Thus, if < cos()> = cos q, equation (5.8) says that +q and –q have
equal probability, and coherently gives <> = 0 and < sin > = 0.
A last remark may be useful for readers not familiar with the von Mises
distribution. For circular variables, it plays a role similar to that played by the
Gaussian function for linear variables. In particular, the von Mises distribution
is marked by maximum likelihood and by maximum entropy characterization
(Mardia, 1972). While the normal distribution along a line has useful mathem-
atical and statistical properties, this is not true for a normal distribution along
a circle (i.e. in the case of directional data). Indeed, in the theory of circular
variables, a normal distribution (as well as the most signiﬁcant distributions
on a line, e.g. Cauchy, Poisson, etc.) is wrapped around the circumference of a
circle of unit radius, thus producing the so-called wrapped distribution.
Let us now consider the P¯1 case (Cochran and Woolfson, 1955): E1, E2, E3
are now real numbers, and according to Appendix 5.A the following joint
probability distribution is obtained:
P(E1, E2, E3) =
1
(2π)3/2 exp

−1
2(E2
1 + E2
2 + E2
3) + E1E2E3
Neq
	
.
In this case the phase problem reduces to a sign problem. The probability that
the sign of E1E2E3 is plus, is given (but for a scaling term) by
P+ ≈exp

+R1R2R3
Neq

,
and the probability that it is minus is given (but for a scaling term) by
P−≈exp

−R1R2R3
Neq

.
Since it must be that P+ + P−= 1, the rescaled value of the positive sign
probability is
P+ = (1 + P−/P+)−1 =

1 + exp

−2R1R2R3
Neq
−1
.
(5.9)
Since
(1 + e−2x)−1 = ex/(ex + e−x) = 1
2 + 1
2 tanh x,
from (5.9),
P+ = 1
2 + 1
2 tanh R1R2R3
Neq
(5.10)
is obtained (see Fig. 5.3). As for the acentric case we notice:
(i) P+ is always larger than 1/2, unless some of R1, R2, R3 are vanishing.
(ii) The reliability of sign indication is large only for large values of R1R2R3
√
Neq .
(iii) The efﬁciency of (5.10) decays with the size of the structure.
Triplet estimation in space groups with symmetry higher than triclinic is
described brieﬂy in Appendix 5.B.

108
The probabilistic estimation of triplet and quartet invariants
0.2
0
1
2
3
4
X
5
6
7
8
0.4
0.6
P+
0.8
1
Fig. 5.3
Centrosymmetric space groups. P+(X) is
the probability that the triplet sign is pos-
itive, according to equation (5.10), and
X = R1R2R3
√
Neq . P+ is always equal to or
larger than 1/2.
5.3
About triplet invariant reliability
The relationships (5.6) and (5.10) have been obtained by making use of two
basic assumptions: the structure is composed of discrete atoms (atomicity pos-
tulate) and the electron density is everywhere real and positive (positivity
postulate). For X-rays, positivity and atomicity are implicit in the positivity
of the atomic scattering factor f. It is, however, worthwhile noticing that when
triplets are to be estimated for neutron diffraction data (see Chapter 11), the
positivity postulate may be violated and relations (5.6) and (5.10) are no longer
valid. In an analogous way dispersion effects could introduce complex scatter-
ing factors, ( fj = f ′
j + if ′′
j ): in this case also, the probabilistic theory for triplet
estimation should be reformulated (Hauptman, 1982a,b; Giacovazzo, 1983b;
see Chapter 15).
In this section we focus our attention only on X-ray data: we wish to enquire
about the range of structural complexity inside which equations (5.6) and
(5.10) may be usefully applied. Since <R2 > = 1 by deﬁnition, the R values
do not change their order of magnitude, no matter how complex is the struc-
ture. Therefore, the only parameter in C which changes size with structural
complexity is 2/Neq: this parameter inﬂuences the average efﬁciency of the
triplet relationships. In more detail:
1. For crystal structures where non-hydrogen atoms are nearly equal, Neq is
almost equal to the number of non-hydrogen atoms in the unit cell (this
is only valid for X-ray data). Therefore, hydrogen atoms could even be
omitted from the calculation of Neq.
2. N > Neq when heavy and light atoms coexist in the unit cell. The difference
becomes large with increasing values of the ratio
atomic number of heavy atom:atomic number of light atoms.
For example, JAMILAS [K4C64H68N8O20S4, space group P1] is a small
structure with N = 100 non-hydrogen atoms in the unit cell; the corres-
ponding value of Neq is 55. The above result indicates that crystal structures
with a large number of light atoms and a few heavy atoms are more easily

About triplet invariant reliability
109
Table 5.1 Schwarz [C46H70O27, P1]: statistical results on triplet estimates
(Cochran formula). nr is the number of triplets with Cochran parameter C > THR,
<||> is the corresponding average value of ||, and % is the percentage of triplets
with positive value of cos 
THR
nr
<||>o
%
0.4
5117
41
90
1.2
4572
40
91
2.0
1552
30
96
2.6
570
27
98
3.8
81
19
100
solvable by direct methods than structures of the same size but without
heavy atoms.
3. For unit cells with a large number of atoms, C is small for most of the
triplets; correspondingly, extremely broad probability distributions (5.6) are
expected. The consequence is that few triplet phases  are really close to
zero, the majority are dispersed in the interval (0, 2π). If the structure size
is small, a high percentage of triplet phases will be close to zero.
Table 5.1 shows some statistical calculations for the Schwarz [C46 H70 O27,
space group P1] structure, showing how  is distributed versus C. The table
entries may be interpreted as follows:
(i) There are 81 triplets for which C > 3.8; for these, the average value of
|| is 19◦(in this case the condition C > 3.8 selects triplets with phase
 really close to zero), and cos  is always positive.
(ii) There are 570 triplets with C > 2.6; for these, the average value of ||
is 27◦.
Data in Table 5.1 may be usefully compared with data in Table 5.2, where we
show similar statistics for a small protein (1e8a; space group R3, 182 residues,
corresponding to 1472 non-hydrogen atoms in the asymmetric unit. Data resol-
ution: 1.95 Å). Only 92 triplets reach a C value larger than 0.5, the percentage
of triplets which deviate from the Cochran expectation  ≈0 is very high.
Table 5.2 1e8a. Statistical results on triplet estimates (Cochran formula). nr is the num-
ber of triplets with Cochran parameter C > THR, <||> is the corresponding average
value of ||, and % is the percentage of triplets with positive value of cos 
THR
nr
<||>o
%
0.1
300000
86
54
0.2
79494
84
55
0.3
7355
83
56
0.4
759
78
59
0.5
92
78
59

110
The probabilistic estimation of triplet and quartet invariants
Apparently, the structural complexity does not allow selection of reliable triplet
invariants, with obvious consequences in the phasing steps.
5.4
The estimation of triplet phases via their
second representation
The Cochran formula (5.6) estimates triplet phases (5.1) by exploiting only the
information contained in three diffraction moduli; any  is expected to be close
to 2π, and there is no chance of recognizing bad triplets (i.e. triplet phases
close to ±π/2 or with negative cosine values). This is of paramount importance
to the efﬁciency of the phasing process. We will see in the Chapter 6 that the
occurrence of a relatively large number of bad triplets in the phasing process
can lead to its failure. Alternatively, the probability of ﬁnding the correct set
of phases is enhanced if bad triplets are recognized; they should be excluded
from the structure solving process or actively used in a correct manner.
The representation theory, described in Chapter 4, indicates how information
contained in all of the reciprocal space may be used to improve the Cochran
estimates. In accordance with Section 4.2, the second representation of  is a
collection of special quintets,
{}2 = { + φk −φk} ,
(5.11)
where k is a free vector in reciprocal space. The basis magnitudes of any 2
are
Rh1, Rh2, Rh3, Rk
and the cross-magnitudes are
Rh1±k, Rh2±k, Rh3±k.
The collection of the basis and cross-magnitudes of the various quintets 2 is
{B}2, and is called the second phasing shell of :
{B}2 =

Rh1, Rh2, Rh3, Rk, Rh1±k, Rh2±k, Rh3±k

.
These results suggest, for P1 and P¯1, a study of the ten-variate probability
distribution
P(Eh1, Eh2, Eh3, Ek, Eh1+k, Eh2+k, Eh3+k, Eh1−k, Eh2−k, Eh3−k),
(5.12)
from which the conclusive conditional distribution,
P(|10 moduli),
(5.13)
is obtained. Equations (5.12) and (5.13) may be calculated by means of the
techniques described in Chapter 4. Since k is a free vector, a formula can be
found which provides the conditional probability distribution of  given the
basis and cross-moduli of any quintet 2. We will denote such a probability
P10(), in order to emphasize the fact that the formula explores the reciprocal
space by means of a ten-node ﬁgure. Three nodes (i.e. h1, h2, h3) are ﬁxed
while k varies; the remaining seven nodes sweep out reciprocal space.

The estimation of triplet phases via their second representation
111
0.1
0
0
60
120
180
–60
–120
G = –2
G = 3
–180
0.2
0.3
0.4
0.5
0.6
0.7
P (F)
F
Fig. 5.4
P10() according to equation (5.14).
We choose G = 3 (continuous line) and
G = −2 (dashed line).
The ﬁnal probabilistic formula (Cascarano et al., 1984; Burla et al., 1989a)
is of a von Mises type, and may be written as
P10() = [2πI0(G)]−1 exp(G cos ),
(5.14)
where G is a concentration parameter which depends on hundreds or thousands
of magnitudes, and may be positive or negative. If G > 0, the expected value
of  is zero, if negative, the expected value of  is π; unlike the Cochran rela-
tionship, P10() is able to identify negative triplet cosines. Two distributions
(5.14), one corresponding to a positive and the other to a negative value of G
are shown in Fig. 5.4: it is evident that, when G < 0, the value of  is probably
closer to π than to 0.
For cs. space groups the triplet sign may be estimated by equation (5.15),
P+ = 1
2 + 1
2 tanh
G
2

(5.15)
as a substitute for equation (5.10). Since G may also be negative, positive
and negative triplets may be identiﬁed. Correspondingly, Fig. 5.3 may be
generalized into Fig. 5.5, allowing values of P+ smaller than 1/2.
For the interested reader, a formal expression of G, including symmetry
effects, is given in Appendix 5.C, where we also compare the efﬁciencies of
the Cochran and the P10 formulas. Because of its superiority, the P10 formula
0.2
0
0
X
2
4
6
–2
–4
–6
0.4
0.6
P+
0.8
1
Fig. 5.5
P+ in accordance with equation (5.15).
P+ is larger or smaller than 1/2, according
to whether G is positive or negative.

112
The probabilistic estimation of triplet and quartet invariants
has been fully integrated in the SIR suite of phasing programs starting from
SIR88 (Burla et al., 1989a).
5.5
Introduction to quartets
Four phases are said to form the quartet invariant,
 = φh1 + φh2 + φh3 + φh4,
if
h1 + h2 + h3 + h4 = 0.
Hauptman and Karle (1953) and Simerska (1956), independently, sugges-
ted that  would be approximately zero for large values of Rh1Rh2Rh3Rh4.
The use of quartets in direct procedures for phase solution was ﬁrst intro-
duced by Schenk (1973a,b, 1974), who, from semi-empirical observations
on the moduli Rh1+h2, Rh1+h3, Rh2+h3, derived useful conditions for improving
estimation of the relation  ≈0. Probabilistic theories for quartet estima-
tion from the ﬁrst phasing shell were, independently, described for P1 by
Hauptman (1975a,b) and by Giacovazzo (1976b,c). Theories for P¯1 were given
by Giacovazzo (1975a, 1976a), Green and Hauptman (1976), and Hauptman
and Green (1976). A general probabilistic theory of quartets valid in all space
groups was given by Giacovazzo (1976d).
Both Hauptman’s and Giacovazzo’s approaches use the ﬁrst phasing shell,

Rh1, Rh2, Rh3, Rh4, Rh1+h2, Rh1+h3, Rh2+h3

, to estimate quartets; mainly, they
differ because the second author has used the Gram–Charlier expansion of
the characteristic function (see Appendix 4.A). For brevity we will use the
following notation:
Ri = Rhi, φi = φhi for i = 1, . . . , 4,
R5 = Rh1+h2, R6 = Rh1+h3, R7 = Rh2+h3,
φ5 = φh1+h2, φ6 = φh1+h3, φ7 = φh2+h3.
5.6
The estimation of quartet invariants
in P1 and P ¯1 via their ﬁrst representation:
Hauptman approach
Hauptman derived in P1 the following conditional distribution:
P(|R1, . . . , R7) ≃1
L exp(−4C cos )I0(R5Z5·)I0(R6Z6)I0(R7Z7),
(5.16)
where I0(x) is the modiﬁed Bessel function of order zero,
C = R1R2R3R4/N,
(5.17)
Z5 =
2
√
N
(R2
1R2
2 + R2
3R2
4 + 2NC cos )1/2,
(5.18a)

The estimation of quartet invariants in P1 and P¯1
113
Z6 =
2
√
N
(R2
1R2
3 + R2
2R2
4 + 2NC cos )1/2,
(5.18b)
Z7 =
2
√
N
(R2
2R2
3 + R2
1R2
4 + 2NC cos )1/2.
(5.18c)
As for the triplet invariants, distribution (5.16) depends on cos ; therefore
only cos  may be estimated, it being impossible to distinguish between +
an − (or, in other words, to distinguish between the two enantiomorphs).
Since L, the scaling factor, has a rather complicated expression, one might
use numerical methods for calculating:
1. the scaling factor L, via the condition
 π
0
P()d = 1;
2. the mode m of P();
3. the mean value, given by
⟨⟩=
 π
0
P()d;
4. the variance, V, as given by
V =
 π
0
( −⟨⟩)2P()d.
5. σ =
√
V.
Estimation of ||, via (5.16), depends on an intricate interrelationship among
all the seven magnitudes. However, some working rules can be stated:
1. P() is unimodal between 0 and π, and m can, in principle, lie anywhere
between 0 and π;
2. if the cross-magnitudes are large,  is expected to be close to zero;
3. if the cross-magnitudes are small,  is expected to be close to π;
4. if the cross-magnitudes are of medium size and N is sufﬁciently small, then
 is expected to be close to ±π/2;
5. the larger N, the larger the overall variance associated with quartet phase
estimation.
R1 = 2.27
R2 = 3.01
R3 = 2.49
R4 = 2.16
R5 = 1.85
R6 = 2.84
R7 = 1.90
P(F)
p
p/2
Fig. 5.6
Distribution (5.16) (broken curve) and
(5.22) (continuous curve) for the indic-
ated
|E|
values
in
a
structure
with
N = 47 atoms in the unit cell.
Figures 5.6 and 5.7 show (broken curves) the distribution (5.16) for some
values of the seven magnitudes when N = 47. In Fig. 5.6, where all the
cross-magnitudes are large, m = 0.0, ⟨⟩≃29◦, σ = V1/2 = 21.9◦. In Fig.
5.7 where all the cross-magnitudes are small, m = 180◦, ⟨⟩≃142◦, σ =
32.7◦.
R1 = 2.31
R2 = 2.82
R3 = 1.88
R4 = 2.10
R5 = 0.36
R6 = 0.24
R7 = 0.10
P(F)
p
p/2
Fig. 5.7
Distribution (5.16) (broken curve) and
(5.22) (continuous curve) for the indic-
ated
|E|
values
in
a
structure
with
N = 47 atoms in the unit cell.
It is clear from the ﬁgures that cosines estimated near π will (on average)
be in poorer agreement with the true values than the cosines estimated near
0, because of the relatively larger value of the variance. Even poorer will
be the estimates of the cosines located in the middle range (usually called
enantiomorph sensitive quarters); no useful application has been found for
them.
The three cross-magnitudes are not always in the set of measured reﬂections.
Then, some marginal joint probability distributions must be considered in order

114
The probabilistic estimation of triplet and quartet invariants
to derive useful information in these less favourable cases. In accordance with
equation (M.A.16), marginal distributions may be obtained by performing the
integration of (5.16) with respect to R5, R6, R7, depending on which cross-
magnitudes are not measured. The resulting general formula is
P(| . . . .) ≈1
L exp[−2C(n −1) cos ]I0(w5R5Z5)I0(w6R6Z6)I0(w7R7Z7),
(5.19)
where n is the number of known cross-magnitudes and I0(x) is the modi-
ﬁed Bessel function of order zero. wi is equal to zero if the cross term Ri is
unknown, otherwise wi = 1.
A last observation concerns the generalization of (5.19) to unequal atom
structures. This can be made by replacing: in equation (5.17), N by σ 2
2 /σ4; in
equations (5.18), N by Neq, as given by equation (5.5). It has been veriﬁed that,
in practice, one can deal with unequal atom structures by replacing N by Neq
in the full expression (5.19).
For centric space groups, Hauptman and Green (1976) obtained the sign
probability
P± ≈1
L exp(∓2C) cosh(R5Z±
5 ) cosh(R6Z±
6 ) cosh(R7Z±
7 ),
(5.20)
where
L = exp(−2C) cosh(R5Z+
5 ) cosh(R6Z+
6 ) cosh(R7Z+
7 )
exp(+2C) cosh(R5Z−
5 ) cosh(R6Z−
6 ) cosh(R7Z−
7 )
and
Z±
5 =
1
√
N
(R1R2 ± R3R4),
Z±
6 =
1
√
N
(R1R3 ± R2R4)
Z±
7 =
1
√
N
(R1R4 ± R2R3).
P+ and P−are the probabilities that E1E2E3E4 is positive or negative; they
may lie anywhere between 0 and 1. P−is close to 1 or close to 0 if R5, R6, and
R7 are either all relatively small or all relatively large, respectively. In order to
derive useful information, even in the less favourable cases in which some of
the cross-magnitudes are not among the measurements, conditional probability
values may be derived, leading to the general formula,
P± ≈1
L exp[∓C(n −1)] cosh(w5R5Z±
5 ) cosh(w6R6Z±
6 ) cosh(w7R7Z±
7 ),
(5.21)
where n is the number of known cross-magnitudes, wi = 0 if the cross term Ri is
unknown, otherwise wi = 1. As in the acentric case, we can generalize (5.21) to
unequal atom structures by replacing N by Neq, as given by equation (5.5).

The estimation of quartet invariants in P1 and P¯1
115
5.7
The estimation of quartet invariants
in P1 and P ¯1 via their ﬁrst representation:
Giacovazzo approach
Giacovazzo expressions for estimating quartet invariants via their ﬁrst phas-
ing shell are simpler than Hauptman formulas, but equally efﬁcient. His ﬁnal
expression for an acentric space group is a von Mises formula,
P(|R1, R2, . . . , R7) = (2πI0(G))−1 exp(G cos ),
(5.22)
where
G = 2C(1 + ε5 + ε6 + ε7)
1 + Q
,
(5.23)
Q = [(ε1ε2 + ε3ε4)ε5 + (ε1ε3 + ε2ε4)ε6 + (ε1ε4 + ε2ε3)ε7]/2N,
and εi = R2
i −1.
It should be noted that:
1. It is convenient to set Q = 0 when Q ≤0.
2. G is positive if ε5 + ε6 + ε7 > 1, and negative in the opposite case. If G
is negative, the most probable value of  is π, and the quartet cosine is
estimated to be negative.
3. Large values of the cross-magnitudes (no matter whether the basis mag-
nitudes are large or small) will correspond to positive estimated quartets;
small values of the cross-magnitudes will mark negative estimated quartets.
4. The marginal distributions of , corresponding to cases in which some of
the cross-magnitudes are unknown, can be obtained by setting the corres-
ponding terms εi to zero (this corresponds to making E2 equal to 1, its
expected value). In mathematical notation, a general expression may be
used for G, covering all cases,
G = 2C(1 + w5ε5 + w6ε6 + w7ε7)
1 + Q
,
(5.24)
where
Q = [w5(ε1ε2 + ε3ε4)ε5 + w6(ε1ε3 + ε2ε4)ε6 + w7(ε1ε4 + ε2ε3)ε7]/2N.
wi is equal to one, but for the case in which the ith cross-reﬂection is not
measured. In this last case, wi = 0.
5. The generalization of (5.23) to unequal atom structures can be done by
replacing N with Neq (as given by (5.5)).
Distribution (5.22) is drawn (full curve) in Figs. 5.6 and 5.7, for the same
values for which distribution (5.16) is calculated.
If an analogous approach is applied in P1, we have
P+ ≃0.5 + 0.5 tanh(G/2),
(5.25)
where G is given by (5.23) (or (5.24)) and P+ is the probability that the sign of
Eh1Eh2Eh3Eh4 is positive. If G > 0, then P+ >1/2.

116
The probabilistic estimation of triplet and quartet invariants
The accuracy of the Hauptman and Giacovazzo formulations is discussed in
Section 5.8.
Quartet estimates may improve if full use is made of the symmetry. Readers
interested in this topic will ﬁnd preliminary information in Appendix 5.D and
a more general description in Giacovazzo (1976d).
5.8
About quartet reliability
There are three basic questions concerning the use of quartet invariants in
phasing procedures. Let us consider these in the following order:
(i) How many quartets can be found among a selected (and sufﬁciently large)
number of reﬂections? Is this number larger than the number of triplet
invariants? The answer is yes; the number of quartets is usually much
larger than the number of reﬂections. The practical aspects concerning
triplet and quartet identiﬁcation are discussed in Appendix 6.A, but, even
intuitively, the reader can easily understand why the quartet number is
much larger than the triplet number (i.e. quartets have a one degree of
freedom more).
(ii) In its ﬁrst representation a triplet invariant depends on three diffraction
amplitudes only, while a quartet invariant depends on (at least) seven
magnitudes. Does this mean that quartets should be preferable to triplets
in the phasing process? The answer is no; indeed, quartets are phase rela-
tionships of order N, while triplets are phase relationships of order √N.
Thus, for medium-sized or large crystal structures it may be expected
that the number of reliable quartets may be a small percentage of the
large total number of estimated quartets. The number of reliable quartets
decreases with structural complexity much more rapidly than the num-
ber of reliable triplets. Thus, in spite of the large number of quartets, the
number of reliable ones is usually smaller than the corresponding number
of triplet invariants.
(iii) Can quartets and triplets be used together in phasing procedures? To
answer this question, some preliminary considerations should be made.
As soon as a phasing procedure progresses, the number of estimated
phases increases and at a certain step, the seven phases of the reﬂections
belonging to the ﬁrst phasing shell of the quartet  are estimated. The
following tripoles may then be established:
⎧
⎨
⎩
1 = 
t1 = −φh1 −φh2 + φh1+h2
t2 = −φh3 + φh1+h2+h3 −φh1+h2
⎧
⎨
⎩
1 = 
t3 = −φh1 −φh3 + φh1+h3
t4 = −φh2 + φh1+h2+h3 −φh1+h3
⎧
⎨
⎩
1 = 
t5 = −φh2 −φh3 + φh2+h3
t2 = −φh1 + φh1+h2+h3 −φh2+h3.

The probabilistic estimation of the triplet invariants in P1
117
Then,
− = t1 + t2 = t3 + t4 = t5 + t6.
Thus, the expected value of a quartet estimates three sums of two triplets. Let
us now describe two typical cases:
(a) Strong positive quartets. We suppose that all the reﬂections involved in the
tripoles have magnitudes larger than Et, where Et is the minimum value of
|E| chosen when carrying out phase determination by means of triplets.
If Et is large enough, then
 ≃t1 ≃t2 ≃· · · ≃0.
In this case, the correlation between triplet and quartet information is very
high. Therefore, a phase reﬁnement which uses triplet and quartet relation-
ships as though they were independent could emphasize the inadequacies
of the standard tangent formula, instead of improving it. From the point
of view of direct space, a ‘cubing effect’ should be added to the ‘squar-
ing effect’ of the triplet relationships, so that the procedure should tend to
strengthen the dominant features of the structure.
(b) Negative quartets. If all the basis magnitudes of the quartet are larger than
Et, but the cross-magnitudes are smaller, no triplet appearing in the tri-
poles is estimated in the direct procedure. In this case,  = π is a phase
indication uncorrelated with triplet phase assignment.
The above considerations suggest that the combined use of triplets and of
negative quartet relationships is more useful than the combined use of posit-
ive triplets and quartets. Several phasing procedures have beneﬁted from the
supplementary information provided by quartets (see Chapter 6); in particu-
lar, we refer to the computer programs SAYTAN (Debaerdemaeker et al., 1985,
1988), SHELX (Sheldrick, 1990), SIR92 (Giacovazzo et al., 1992a; Burla et al.,
(1992)) and its heirs.
APPENDIX 5.A
THE PROBABILISTIC ESTIMATION
OF THE TRIPLET INVARIANTS IN P1
We will use the notation previously employed in Appendix 4.A, and we will
assume that no prior information is available, but for the chemical content of
the unit cell and for the space group. Then, equation (4.A.18), limited up to
terms of order N−1/2, may be rewritten in the form,
P (A1, A2, A3, B1, B2, B3) ≃
1
(2π)6 ×
 +∞
−∞
· · ·
 +∞
−∞
exp

−i(u1A1+u2A2
+ · · · + υ3B3) −1
4(u2
1 + · · · + υ2
3) + S3 + · · ·

du1 du2 . . . dυ3,
(5.A.1)

118
The probabilistic estimation of triplet and quartet invariants
where A1, A2, A3, B1, B2, and B3 stand for Ah1, Ah2, Ah3, Bh1, Bh2, and Bh3,
respectively, and
S3 = −i

N
j=1
jk111000 u1u2u3 +
N
j=1
jk001110 u3υ1υ2
+
N
j=1
jk010101 u2υ1υ3 +
N
j=1
jk100011 u1υ2υ3

.
The explicit expression for the ﬁrst cumulants is
N
j=1
jk111000 =
N
j=1

ψ′j (h1) ψ′j (h2) ψ′j (h3)

=
N
j=1
vj (h1) vj (h2) vj (h3)
×

cos

2πh1 · rj

cos

2πh2 · rj

cos

2πh3 · rj

= 1
4
N
j=1
1
√
Neq ,
where (see equation (2.9)),
vj (h) = fj (h)
⎡
⎣
N

j=1
f 2
j (h)
⎤
⎦
−1/2
,
and (see equation (5.5)), Neq = σ 3
2 /σ 2
3 .
Similar expressions hold for the other cumulants. In particular,
jk001110 = jk010101 = jk100011 = 1
4
1
Neq
.
Then,
S3 =
−i
4Neq
(u1u2u3 −u3υ1υ2 −u2υ1υ3 −u1υ2υ3) .
If we neglect in our calculations terms of order higher than N−1/2, and we
apply the variable change (4.A.18), then (5.A.1) reduces to
P ≡P(φ1, φ2, φ3, R1, R2, R3)
≃
1
(2π)6 23R1 R2 R3
 ∞
0
 ∞
0
 ∞
0
 2π
0
 2π
0
 2π
0
ρ1 ρ2 ρ3
× exp

−i
√
2
3
j=1
ρj Rj cos(φj −θj) −1
2
3
j=1
ρ2
j −i ρ1 ρ2 ρ3
2Neq
× cos(θ1 + θ2 + θ3)

dρ1 dρ2 dρ3 dθ1 dθ2 dθ3,
(5.A.2)
where φ1, φ2, and φ3 stand for φh1, φh2, and φh3 respectively. The terms in the
exponent involving ρ1 and θ1 are ﬁrst combined by means of equation (M.F.8):
−1
2ρ2
1 −iρ1

√
2R1 cos(θ1 −φ1) + ρ3ρ3
2Neq
cos(θ1 + θ2 + θ3)

= −1
2ρ2
1 −iXρ1 cos(θ1 + y),
where,
X2 ≃2R2
1 +
2
Neq
R1 ρ2 ρ3 cos(φ1 + θ2 + θ3).

The probabilistic estimation of the triplet invariants in P1
119
X and y do not depend on θ1. Then, using (M.E.16),
P ≃
1
(2π)5 23 R1 R2 R3 exp(−R2
1)
 ∞
0
. . .
 2π
0
× exp
⎧
⎨
⎩−i
√
2
3

j=2
ρj Rj cos(φj −θj)
−1
2
3
j=2
ρ2
j −R1 ρ2 ρ3
Neq
cos (φ1 + θ2 + θ3)
	
ρ2 ρ3 dρ2 dρ3 dθ2 dθ3.
The same procedure is followed for ρ2, θ2 and ρ3, θ3, with the ﬁnal result,
P ≡P(φ1, φ2, φ3, R1, R2, R3)
≃R1 R2 R3
π3
exp

−R2
1 −R2
2 −R2
3 + 2R1 R2 R3
Neq
cos(φ1 + φ2 + φ3)

.
(5.A.3)
Since  = φ1 + φ2 + φ3, elementary statistics gives,
P(, R1, R2, R3) ≃
 2π
0
 2π
0
P(φ1, φ2,  −φ1 −φ2, R1, R2, R3) dφ1 dφ2
≃4
π R1 R2 R3 exp(−R2
1 −R2
2 −R2
3 + G cos ),
where,
G = 2R1R2R3/

Neq.
The conditional distribution (Cochran, 1955)
P(|R1, R2, R3)
is obtained from (M.A.17) with the use of (M.E.25),
P(|R1, R2, R3) ≃(2πI0(G))−1 exp(G cos ).
(5.A.4)
The conditional expectations and the conditional variance of , sin(n) and
cos(n), where n is an arbitrary integral parameter, may readily be derived by
applying (M.E.26) and (M.E.27):
⟨|G⟩= [2πI0(G)]−1
 π
−π
 exp(G cos )d = 0
⟨sin(n)|G⟩= 0;
⟨cos(n)|G⟩= Dn(G)
var[sin(n)|G] = ⟨sin2(n)|G⟩−⟨sin(n)|G⟩2 = 1
2 −1
2D2n(G)
var[cos(n)|G] = 1
2 + 1
2D2n(G) −D2
n(G),
(5.A.5)
where, Di(x) = Ii(x)/I0(x). When n = 1 we have, from (M.E.22),
var[sin |G] = D1(G)
G
,
var[cos |G] = 1 −D1(G)
G
−D2
1(G).
The conditional distribution, P(φ1| φ2, φ3, R1, R2, R3) may readily be obtained
by application of (M.A.17) to (5.A.3).

120
The probabilistic estimation of triplet and quartet invariants
APPENDIX 5.B
SYMMETRY INCONSISTENT
TRIPLETS
Let us consider the triplet invariant
 = φh1 + φh2 + φh3
with
h1 + h2 + h3 = 0
and let us suppose that one or more additional triplet invariants can be found
of type
 = φh1 + φh2Rs + φh3Rr,
with
h1 + h2Rs + h3Rr = 0, h2Rs ̸= h2, and h3Rr ̸= h3.
(5.B.1)
We deﬁne the ﬁrst representation of  as the collection of triplet invariants
(5.B.1). Because of relationship (1.25),
 =  −s,r,
where,
s,r = 2π(h2Ts + h3Tr).
 and  are symmetry consistent triplets if s,r = 2nπ, otherwise, they are
said to be symmetry inconsistent.
The existence of inconsistent triplets in P212121 was pointed out by
Hauptman and Karle (1956). A probabilistic approach for the estimation of
triplet invariants, which takes into account the space group symmetry, was
described by Giacovazzo (1974a,b). His results were conﬁrmed and extended
by Pontenagel and Krabbendam (1983); they found that in the eleven pairs of
enantiomorphically related space groups there are triplet phases which are not
expected to be close to 2π. Han and Langs (1988) examined the 230 space
groups in order to identify conditions which permit symmetry inconsistent
triplets. A table describing such conditions for the various space groups was
presented. The matter was re-examined by Giacovazzo (1989) in order to:
1. complete the results by Han and Langs, who missed conditions for cubic
space groups and neglected triplets with symmetry restricted phase values;
2. provide an algorithm for the discovery of symmetry inconsistent triplets in
any space group, in order to avoid the use of the large Han and Langs table.
The estimation of triplet invariants by making full use of the symmetry poses
the following questions:
(i) is the distribution of  a von Mises distribution?
(ii) is the standard Cochran parameter C, as deﬁned by (5.3), the correct one
or should it be modiﬁed? Indeed, if we apply the Cochran distribution ﬁrst
to  and then to any , both are expected to be close to zero, but this is
contradictory when s,r ̸= 2nπ.
The theory of representations is able to show that  is still distributed accord-
ing to a von Mises function, but proper weights (smaller or larger than unity)
should be associated with the parameter C: in particular, weights equal to zero
should be introduced when s,r = π.

The P10 formula
121
We show below some examples:
1. In P31,
 = φ303 + φ331 + φ032
and the symmetry equivalent triplet,
 = φ303 + φ031 + φ332 = φ303 + φ(331)R3 + φ(032)R2 =  −2π/3
can be found. The most probable value of  is π

3 and G′ = G.
2. In P41

(x, y, z) ,

¯x, ¯y, z + 1
2

,

¯y, x, z + 1
4
 
y, ¯x, z −1
4

,
the equivalent pairs of triplets may be found:
 = φ221 + φ401 + φ222,
 = φ221 + φ041 + φ222 = φ221 + φ(401)R4 + φ(222)R2 =  + π/2.
The most probable value of  is −π/4 and G′ = G
√
2.
3. Let us consider in space group P41212, the triplet
 = φ1,1,19 + φ1,1,12 + φ207.
If the Cochran distribution is taken into account,  is expected to be
close to 2π. However, the values of φ1,1,19, φ1,1,12, and φ207 are symmetry
restricted to (0, π), (0, π), (−π/4, 3π/4), respectively, so that the triplet 
is itself restricted to (−π/4, 3π/4). We see that the Cochran distribution is
inadequate to describe this situation.
If representation theory is adopted, a triplet symmetry equivalent to 
may be taken into consideration:
 = φ1,1,19 + φ1,1,12 + φ207 = φ1,1,19 + φ(1,1,12)R2 + φ(207)R8 =  + π/2.
The most probable value of  is −π/4 and G′ = G
√
2.
4. Let us consider in P212121 all the triplets constituted by reﬂections with
restricted phase values, which sum to ±π/2. For example, let h1 =
(0, e, 0), h2 = (e, e, 0), and h3 = (e, 0, 0). The crystallographic symmetry
restricts φh1 and φh2 to nπ, and φh3 to ±π/2, so that  = ±π/2. We cannot
know from the moduli alone if  is +π/2 or −π/2 (one of them deﬁnes
the enantiomorph, and this choice is arbitrary). Accordingly, G′ = 0.
Inconsistent triplets are routinely searched in some direct methods programs
(e.g. SIR2011) and eliminated from the set of triplets actively used in the
phasing process.
APPENDIX 5.C
THE P10 FORMUL A
In accordance with Section 5.4, the distribution (5.12), with k a free vector,
may be used to calculate the conditional distribution (5.14). If the space group

122
The probabilistic estimation of triplet and quartet invariants
symmetry is taken into account, deﬁnition (5.11) may be generalized as fol-
lows: the ﬁrst representation of the triplet invariant is the collection of the
special quintets,
2 =  + φkRi −φkRi, i = 1, 2, . . . m,
where m is the number of symmetry operators, Cj ≡(Rj, Tj), not related by a
centre of symmetry (Rj is the rotational part and Tj the translational part of the
symmetry operator). In conclusion, any quintet 2 depends on, in addition to
the basis magnitudes Rh1, Rh2, Rh3, Rk, the 6m cross-magnitudes:
Rh1+kR1, Rh1−kR1, Rh2+kR2, Rh2−kR1, Rh3+kR1, Rh3−kR1
Rh1+kR2, Rh1−kR2, Rh2+kR2, Rh2−kR2, Rh3+kR2, Rh3−kR2
...
...
Rh1+kRm, Rh1−kRm, Rh2+kRm, Rh2−kRm, Rh3+kRm, Rh3−kRm.
(5.C.1)
In this case we write,
{B}2 = {Rh1, Rh2, Rh3, Rk, Rh1±kRi, Rh2±kRi, Rh3±kRi i = 1, 2, . . . m}.
The conditional probability, P(|{B}2), now provides an estimate for  in any
space group. Since its exact expression is not easy to obtain, we prefer to intro-
duce a simple approximation of P(|{B}2), which may be derived as a proper
combination of the various ten-variate distributions,
P(|Rh1, Rh2, Rh3, Rk, Rh1±kRi, Rh2±kRi, Rh3±kRi).
(5.C.2)
The P10 distribution was derived by Cascarano et al. (1984). For n.cs. space
groups, P10 has a von Mises expression:
P10() ≃(2πI0(G))−1 exp(G cos ),
(5.C.3)
where
G = C(1 + Q)
C = 2Rh1Rh2Rh3/

Neq,
(5.C.4)
C is the Cochran reliability parameter,
Q =

k

′m
i=1Ak,i/N
1 + (εh1εh2εh3 + ′m
i=1Bk,i)/2N

,
(5.C.5)
Ak,i = εk[εh1+ kRi(εh2−kRi + εh3−kRi)
+ εh2+kRi(εh1−kRi + εh3−kRi) + εh3+kRi(εh1−kRi + εh2−kRi)],
Bk,i = εh1[εk(εh1+ kRi + εh1−kRi) + εh2+kRiεh3−kRi + εh2−kRiεh3+kRi]
+ εh2[εk(εh2+ kRi + εh2−kRi) + εh1+kRiεh3−kRi + εh1−kRiεh3+ kRi]
+ εh3[εk(εh3+ kRi + εh3−kRi) + εh1+kRiεh2−kRi + εh1−kRiεh2+ kRi];
ε = |E|2 −1.
(εh1εh2εh3 + ′m
i=1Bk,i) is assumed to be zero, if it is experimentally negative.
The prime on the summation warns the reader that precautions have to be taken
in order to avoid duplications in the contributions when k sweeps out reciprocal
space.
Distribution (5.C.3) is unimodal and takes its maximum at  = 0 if G > 0,
and at  = π if G < 0. Therefore, it is able in principle to estimate with high

The use of symmetry in quartet estimation
123
reliability only triplets with phase values around 0 or π. In accordance with
the theory, enantiomorph-sensitive triplets should present a rather ﬂat distribu-
tion (G ≃0), so that they cannot be reliably ﬁxed. This is the most important
limitation of the theory; however, triplets with G ≃0 can be used in phasing
procedures for recognizing the correct solution in multisolution approaches
(Cascarano et al., 1987a).
The accuracy with which the value of  is estimated by (5.C.5) depends
strongly on εk. Thus, in practice only a subset of reciprocal space (the reﬂection
k with large values of ε) may be used for estimating .
To provide some insight into the relative efﬁciency of the Cochran and
the P10 formulas, we show some simple statistical tests in Tables 5.C.1 and
5.C.2.
Table 5.C.1 Quinol [C18 H18 O6, R-3]:
cs. case. Statistical results on triplet
estimates
according
to
the
Cochran
parameter C and the P10 parameter G.
nr is the number of triplets with C or G
larger than THR, nrw is the number of
negative triplets (i.e. triplets for which
 = π). In the last column, only triplets
estimated positive by P10 are quoted
THR
C
nr (nrw)
G
nr (nrw)
0.4
5974 (972)
4174 (145)
0.8
3150 (322)
2940 (37)
1.4
905 (30)
1460 (4)
2.0
329 (0)
642 (0)
2.8
96 (1)
198 (0)
Table 5.C.2 Quinol
[C18
H18
O6,
R-3]: cs. case. Statistical results on the
triplets estimated negative by the P10 for-
mula (i.e. with a negative value of G). nr
is the number of triplets with |G| larger
than THR, nrw is the number of wrongly
estimated triplets (i.e. triplets for which
 = 0)
THR
nr (nrw)
0.0
500 (121)
0.2
412 (81)
0.4
201 (23)
0.8
43 (2)
Line four of Table 5.C.1 may be interpreted as follows: there are 905 triplet
invariants with C > 1.4 (and therefore estimated positive by the Cochran for-
mula), among which there are 30 negative triplets (which are therefore wrongly
estimated). There are 1460 triplets with G > 1.4 (and therefore estimated
positive by P10), among which there are only four negative triplets.
Line four of Table 5.C.2 may be interpreted as follows: there are 201 triplets
with |G| > 0.4, estimated negative by P10 (and therefore with a negative value
of G), among which there are only 23 wrongly estimated triplets (triplets which
are really positive).
Similar advantages are obtained when P10 is applied to n.cs. space groups.
The ability of the P10 formula to identify negative triplets (and to better rank the
positive ones) is a great advantage in direct phasing procedures (see Chapter 6).
APPENDIX 5.D
THE USE OF SYMMETRY
IN QUARTET ESTIMATION
The probabilistic theories described in Sections 5.5–5.8 do not fully exploit
the space group symmetry. Since this strongly inﬂuences quartet estimates, we
will make some introductory remarks in this section (Giacovazzo, 1976d).
According to Section 4.2, the ﬁrst representation of
 = φh1 + φh2 + φh3 + φ h1+h2+h3
is the collection of the quartets,
φh1 + φh2Ri + φh3Rj + φ h1+h2Ri+h3Rj,
(5.D.1)
obtained when Ri and Rj vary over the set of rotation matrices of the space
group under the condition that h1 + h2Ri + h3Rj is symmetry equivalent to
h1 + h2 + h3. The ﬁrst representation will consist of more than one quartet
if at least one of the cross terms has a statistical weight different from unity.
In this case, the number of cross-magnitudes will exceed three. For example,
let us consider in space group P2/m, the quartet
 = φ234 + φ112 + φ213 −φ539,
(5.D.2)
which depends on the cross-magnitudes
R346, R427, R305.
(5.D.3)

124
The probabilistic estimation of triplet and quartet invariants
Besides (5.D.2), the ﬁrst representation includes the quartet
′ = φ234 + φ112 + φ213 −φ539 ≡,
(5.D.4)
which depends on the cross-magnitudes
R326, R447, R305.
(5.D.5)
If the magnitudes (5.D.3) are all large,  is expected to be close to zero; also,
′ is expected to be close to zero if the magnitudes (5.D.5) are large. The two
phase indications are mostly independent of each other (only R305 is shared
by both sets (5.D.3) and (5.D.5)). Since ′ ≡, the case in which all ﬁve
cross-magnitudes in {B}1 are large is quite favourable for the reliable phase
assignment  ≃0. Conversely, if all ﬁve cross-magnitudes are small we can
conﬁdently assign  = π. The worst situation occurs when R346 and R427 are
large while R326 and R447 are small, or vice versa, because the indication for 
from (5.D.2) contradicts the indication for  coming from (5.D.4).
Let us now suppose that the space group is P21/c : then, F305 is system-
atically absent and ′ =  + π. If the non-absent reﬂections in (5.D.3) and
(5.D.5) are large, both  and ′ are expected to be close to zero, but this
is contradictory because ′ =  + π. An analogous situation occurs when
the non-absent reﬂections in (5.D.3) and (5.D.5) are small; both  and ′
are expected to be close to π, which is a contradictory expectation. The most
favourable case for a reliable estimate of  occurs when the non-absent reﬂec-
tions in (5.D.3) are large and those in (5.D.5) are small, or vice versa, then the
two phase indications comply. The most correct way of dealing with such a
problem is to calculate the distribution
P(E234, E112, E213, E539, E346, E427, E326, E447, E305),
which is the joint probability distribution of all the reﬂections in the ﬁrst phas-
ing shell. The resulting formula for estimating the sign of the cosine of  in the
Giacovazzo formulation may be expressed, qualitatively, as follows: (5.25) is
still valid but G is now approximately given by
G =
2C
1 + Q(ε346 + ε427 + ε326 + ε447 + ε305)
for
P2/m
G =
2C
1 + Q[ε346 + ε427 −(ε326 + ε447)]
for
P21/c.
Q is a suitable scaling factor which, for simplicity, is not given.
The above examples show that it is statistically more convenient to estimate
 from its ﬁrst representation than from a single quartet of the set. A more
formal mathematical treatment of the problem may be found in Giacovazzo
(1976d).

Traditional direct
phasing procedures
6
6.1
Introduction
Which phasing methods can be included in the category direct methods, and
which require a different appellation?
Originally, direct phasing was associated with those approaches which
were able to derive phases directly from the diffraction moduli, without
passing through deconvolution of the Patterson function. Since a Patterson map
provides interatomic distances, and therefore lies in ‘direct space’, direct meth-
ods were also referred to as reciprocal space methods, and Patterson techniques
as real-space methods. Historically, direct methods use 3-,4-, . . . , n-phase
invariants and 1-2-, . . . phase seminvariants via the tangent formula or its mod-
iﬁed algorithms. Since the 1950s, about a half a century of scientiﬁc effort
has fallen under the above deﬁnition. Such approaches are classiﬁed here as
traditional direct methods.
Today, the situation is more ambiguous, because:
(i) modern direct methods programs involve steps operating both in recip-
rocal space and in direct space, the latter mainly devoted to phase
extension and reﬁnement (see Chapter 8);
(ii) in the past decade, new phasing methods for crystal structure solution (see
Chapter 9) have been developed, based on the properties of Fourier trans-
forms, which again work both in direct and in reciprocal space. Should
they therefore be considered to be outside the direct methods category or
not?
Our choice is as follows. Direct methods are all of the approaches which
allow us to derive phases from diffraction amplitudes, without passing through
a Patterson function deconvolution. Thus, we also include in this category,
charge ﬂipping and VLD (vive la difference), here classiﬁed as non-traditional
direct methods; their description is postponed to Chapter 9.
In accordance with the above assumptions, in this chapter we will shortly
illustrate traditional direct phasing procedures, with particular reference to
those which are current and in regular use today: mainly the tangent procedures
(see Section 6.2) and the cosine least squares technique, which is the basic tool

126
Traditional direct phasing procedures
of the shake and Bake method (see Section 6.4). For brevity, we will skip the
methods listed below, even if they have fundamentally important properties:
(a) symbolic addition techniques (Zachariasen, 1952; Karle and Karle, 1966);
(b) variants of the tangent formula, such as the primary–secondary method
(Declercq et al., 1975; Hull et al., 1981; Zhang and Woolfson, 1982), the
linear equation method (Debaerdemaeker and Woolfson, 1975; Woolfson,
1977, 1978; Baggio et al., 1978), and the X–Y method (Debaerdemaeker
and Woolfson, 1983, 1989).
(c) probabilistic determinantal approaches (Lajzerowicz and Lajzerowicz,
1966; de Rango et al., 1969; Tsoucaris, 1970; de Rango et al., 1974; Taylor
et al., 1979; de Gelder et al., 1990; de Gelder, 1992).
We now return to the core of traditional direct methods. In Chapter 5,
we described how s.i. phases may be estimated via the prior information on
diffraction moduli. In particular, formulas like P()| {R}) were obtained, where
 = (φh + φk + φ−h−k)
or
 = (φh + φk + φl + φ−h−k−l),
and {R} may coincide with the ﬁrst or the second phasing shell, etc.
The goal of any phasing procedure is to associate phases with reﬂections,
that is, to pass from invariant estimates to single-phase estimates. The math-
ematical technique is very simple; in order to show how it works we consider
the triplet
 = (φh + φk + φ−h−k).
According to the Cochran relationship (5.6),  is expected to be close to zero,
say
φh + φk + φ−h−k ≈0,
(6.1)
with probability ﬁxed by the concentration parameter
C = 2RhRkRh+k/

Neq.
Relationship (6.1) is perfectly equivalent to the following proposition:
φh is expected to be close to −(φk + φ−h−k), with reliability ﬁxed by C.
To simplify the notation, we observe that, owing to the Friedel relation-
ship,  may also be written as  = (φh + φk −φh+k), or also, by replacing k
by –k, as
 = (φh −φk −φh−k).
(6.2)
The notation (6.2) is more useful for our purposes. Indeed, for the s.i. (6.2), the
Cochran relationship states that
φh ≈(φk + φh−k) ,
(6.3)
with probability ﬁxed by
C = 2RhRkRh−k/

Neq.

Introduction
127
Therefore, the corresponding conditional distribution is
P (φh|φk, φh−k, Rh, Rk, Rh−k) = [2πI0(C)]−1 exp[C cos(φh −θh)] ,
(6.4)
where
θh = (φk + φh−k)
(6.5)
is the most probable value of φh. In other words, from (6.4) and (6.5), the phase
relationship
φh ≈θh ≡φk + φh−k
(6.6a)
is obtained.
A graphical representation of the distribution (6.4) is shown in Fig. 6.1. All
of the curves have their maximum at θh and show the same features noticed
in the discussion on Fig. 5.1 (e.g. the larger that C becomes, the larger is the
probability of relation (6.6a)).
Distribution (6.4) may be generalized by admitting, in accordance with the
second representation estimate of the triplet invariant, that the concentration
parameter G replaces C, where G may be positive or negative; in the ﬁrst case
(6.3) is still valid, in the second, (6.3) is replaced by
φh ≈(φk + φh−k) + π.
(6.6b)
Accordingly, (6.4) is replaced by the more general distribution,
P(φh) = [2πI0(G)]−1 exp[G cos(φh −θh)]
(6.6c)
where the short notation P(φh) implies that the diffraction amplitudes belong-
ing to the second phasing shell have been exploited to obtain G, and that
(φk + φh−k) is known. If G is positive, φh ≈θh, if G is negative, φh ≈θh + π
(see Fig. 6.2).
So far we have described the mathematical machinery for passing from
phase invariants to single phases. However, relations (6.6) can deﬁne the value
of φh only if φk and φh−k are known; but how do we obtain this information?
In the following sections we will see how this may be achieved.
1.0
P(φh)
0.8
0.6
0.4
G = 6
G = 4
G = 2
G = 0
G = 1
0.2
θh
φh
Fig. 6.1
The conditional distribution P(φh|Rh, Ek,
Eh−k).

128
Traditional direct phasing procedures
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
–180
–120
–60
0
60
120
180
P(φ)
φ
G = 3
G = –2
Fig. 6.2
P(φh) in accordance with distribution
(6.6c). We choose for the continuous line,
G = 3 and θh = 38◦; the maximum of
the curve is at θh. The dashed line rep-
resents the case where G = −2 and θh =
38◦. In this case, the curve attains its
maximum at φh ≈θh + π.
6.2
The tangent formula
The main limitation of the Cochran relationship (and therefore of relation
(6.4)) is that the C parameter may be small for most triplet relationships, par-
ticularly when the number of atoms in the unit cell is large. This may also
be the case for concentration parameter G of the P10 formula (see equation
(5.14)). To make this problem less critical, let us consider the relations (6.6):
for a given h, more k may exist, and, as a consequence, more phase indica-
tions for the given φh may arise, each providing an independent estimate for
φh. How to combine these has been the goal of the tangent formula (Hauptman
and Karle, 1956; Karle and Karle, 1966).
In more detail, let us suppose that moduli and phases are known for r dif-
ferent products EkjEh−kj; in particular, we will assume that θj = (φkj + φh−kj),
with j = 1, . . . , r, are known. Then, to a ﬁrst approximation, the probability
density,
Pj(φh) ≈

2πI0

Gh,kj
−1 exp

Gh,kj cos

φh −θj

(6.7)
is deﬁned for any jth pair of phases, (φkj + φh−kj), where Gh,kj represents the
concentration parameter of the distribution (6.7). This may coincide with the
parameter of the Cochran distribution (say C in equation (5.4)), or the para-
meter of the P10 formula (say G in equation (5.14) and in Appendix 5.C).
We will use the same letter G as representative of both.
Thus, the total probability, P(φh), that the phase of Eh is φh is expressed by
the product, suitably normalized, or r speciﬁc probabilities:
P(φh) ≃
r
j=1
Pj(φh) ≃L exp
⎡
⎣
r

j=1
Gh, kj cos(φh −θj)
⎤
⎦,
(6.8)
where L is a suitable normalizing factor. Applying (M.F.8) to the right-hand
side of (6.8) we get
P(φh) ≃L exp[αh cos(φh −θh)],
(6.9)

The tangent formula
129
where
tan θh =
r
j=1Gh, kj sin

φkj + φh−kj

r
j=1Gh, kj cos

φkj + φh−kj
 = T
B,
(6.10)
α2
h = T2 + B2 =
⎡
⎣
r

j=1
Gh,kj cos

φkj + φh−kj

⎤
⎦
2
+
⎡
⎣
r

j=1
Gh,kj sin

φkj + φh−kj

⎤
⎦
2
.
(6.11)
The value of L may be found by requiring that
 2π
0
P(φh) d φh
be equal to unity. From (M.E.25), we obtain
P(φh) ≃[2πI0(αh)]−1 exp [αh cos(φh −θh)] .
(6.12)
Equation (6.12) represents the probability density function to be found. It is
again a von Mises distribution; thus the curves of Fig. 6.1 formally describe
(6.12), provided that Gh,k is replaced by αh.
Equation (6.10) is the well-known tangent formula; θh is the most probable
value of φh, and αh is the reliability parameter of the phase indication. The role
of αh may be better understood if its r components are plotted on an Argand
diagram as vectors of modulus Gj and phase φkj + φh−kj. Then, αh appears
to be the resultant of r complex vectors Gj exp(iθj), and θh is its phase angle.
In Fig. 6.3, a case is illustrated with r = 5. The ﬁgure suggests that, if r is
sufﬁciently large, αh may be large even if the various Gh,kj are relatively small.
For example, let us consider the following numerical case:
G1 = 1.6,
θ1 = 30◦;
G2 = 1.1,
θ2 = 54◦;
G3 = 1.8,
θ3 = −30◦;
G4 = 0.7,
θ4 = 99◦;
G5 = 2.0,
θ5 = 70◦.
θ3
θ1
G3
G4
G2
G1
real axis
imag. axis
G5
θ5
θ4
θ2
θh
αh
Fig. 6.3
Eh is represented in the Argand plane
as the sum of ﬁve complex vectors
Gj exp(iθj).

130
Traditional direct phasing procedures
Then, θh = 39◦and αh = 5.35. While single-phase relationships are of modest
reliability, αh is large and therefore θh is a reliable estimate of φh.
A similar mathematical procedure for cs. crystals leads to the overall sign
probability for the structure factor Eh, when the signs of more products
(EkjEh−kj) are known:
P(Eh)+ = 1
2 + 1
2 tanh
|Eh| 
j EkjEh−kj
Neq
.
(6.13)
According to (6.13), the sign of Eh will probably be positive if 
j EkjEh−kj is
positive, otherwise it will probably be negative.
The main appeal of the tangent formula (or of its equivalent relationship
(6.13) for the cs. case) is as follows. The reliability of the phase indication
φh ≈θh may be large, even if the single contributors in the tangent formula
are small, provided that the number of triplets involved in the formula is large
enough. There is, however, a basic assumption which for the moment has not
been justiﬁed: how do we know the values of φkj + φh−kj? We will postpone
the answer until Section 6.3, where a typical direct methods procedure will be
described.
Here, we consider a problem connected with the potential of the tangent
formula and with its efﬁciency: what is the expected distribution of αh when
the phases φkj and φh−kj, for j = 1, . . . ,r are still unknown? What one actu-
ally knows about αh is as follows. The parameters Gj ≡Gh,kj are given by the
experiment, the phases φkj + φh−kj are distributed about φh according to the
von Mises distribution, M(φkj + φh−kj; φh, Gj). Then, the expected value of αh
(see Cascarano et al., 1984) is
< αh > =

r
j=1 GjD1(Gj),
(6.14)
with variance given by
σ 2
α = 1
2

r
j=1 G2
j [1 + D2(Gj) −2D2
1(Gj)] .
(6.15)
Di(x) = Ii(x)/I0(x) is the ratio of the modiﬁed Bessel function of order i and 0
respectively. If the phases φkj + φh−kj, determined by the tangent formula,
are distributed about φh in accordance with the Gj parameters, then it may
be expected that, for each h, the experimental value of αh (as obtained from
equation (6.11)) will be close to the expected (say the value < αh > provided
by equation (6.14)). Strong deviations between αh and < αh > usually indicate
bad phasing.
6.3
Procedure for phase determination via
traditional direct methods
A robust single-solution direct methods procedure which works efﬁciently
in all cases does not exist. The most effective approaches are essentially
multisolution techniques whereby several different attempts at phase assign-
ment are performed, among which the correct solution must be found.

Procedure for phase determination via traditional direct methods
131
A computer is, therefore, a basic requirement for application of the methods.
Before describing a typical direct phasing procedure, we must acknowledge
Michael Woolfson and his group (among whom we recall Peter Main and
Gabriel Germain) for their extraordinary contribution: they led the way from
old to modern phasing procedures.
A typical direct procedure for phase assignment may be presented, schem-
atically, as follows:
Step 1: normalization of the structure factors
Step 2: set-up of phase relationships
Step 3: assignment of starting phases
Step 4: phase determination
Step 5: ﬁnding out the correct solution
Step 6: E-map interpretation
Step 7: phase extension and reﬁnement.
For Step 1, the reader is referred to Chapter 2. The other steps are treated over
the following sections.
6.3.1 Set-up of phase relationships
Here we will mainly focus our attention on triplet invariants; the set-up of
quartet invariants is described in Appendix 6.A. The reader should, however,
bear in mind that other phase relationships can also be set up: one- and two-
phase s.s.s, quintet invariants, etc. For triplet invariants, the basic steps are as
follows:
1. First, the unique list of reﬂections is deﬁned (i.e. the list of symmetry-
independent reﬂections). These are ordered according to the normalized
amplitude; e.g. the code 1 is associated with the reﬂection with the largest
normalized amplitude, etc. The subset of reﬂections (say the number of
NLAR) that one wants to phase is deﬁned; i.e. only reﬂections with |E|
larger than a given threshold Es, where Es may vary, according to circum-
stances, between 1.2 and 1.5. In this way, only those reﬂections which
may be expected to form triplet relationships with a sufﬁciently high value
of G (the concentration parameter associated with the P10 formula) or of
C (the concentration parameter associated with the Cochran relationship),
are selected. It is likely that most of the NLAR reﬂections will be char-
acterized by high values of < α >, and therefore they may be carefully
phased.
2. The indices of the reﬂections symmetry equivalent to the NLARs are
calculated, so obtaining the expanded list.
3. For a given h, all pairs of (k, h – k) with |E| ≥Es are found; the set of phase
relationships so obtained is called the 2 list. The search is made by letting
h vary over the set of ‘standard’ reﬂections, while k (and therefore h −k)
can span over the expanded list. In practice, all combinations of h ± kRi
are checked, where Ri varies over all rotation matrices of the space group
not related by an inversion centre.

132
Traditional direct phasing procedures
4. If |Eh ± kRi| > Es, the triplet is retained. Any triplet is stored in terms of
standard reﬂections. For example, let us focus our attention on the space
group P212121, where we have to store the following information:
 = φ123 + φ468 + φ385 ≃0,
(6.16)
with reliability parameter
C = 2|E123E468E385|/

Neq.
Because of (1.25),
φ468 = φ468 −2π(468)
⎛
⎝
0
1/2
1/2
⎞
⎠= φ468,
φ385 = φ385 = −
⎡
⎣φ385 −2π(385)
⎛
⎝
0
1/2
1/2
⎞
⎠
⎤
⎦= −φ385 + π.
Therefore, (6.16) may be written as
 = φ123 + φ468 −φ385 + π ≃0.
(6.17)
Equation (3.48) involves the phases of the standard reﬂections which may
be referred to via their code numbers. Thus, (6.16) may be transformed into
the symbolic expression
n1 + n2 −n3 + 	 ≃0,
(6.18)
where n1, n2, n3 are the code numbers of the standard reﬂections and
	 is the phase shift due to translational symmetry. In conclusion, com-
plete information on a triplet estimate may be stored by recording, besides
n1, n2, n3, 	, also s2 and s3 (the signs of n2 and n3), and the value of C.
In order to show how a typical 2 list in organized, we show in Table 6.1
the ﬁrst items of the 2 list of LOGANIN.
5. NWEAK reﬂections, those with the smallest |E| values, are selected for con-
struction of triplets (called psi-zero triplets) with two reﬂections belonging
to the NLAR subset. Usually NWEAK ∼NLAR/3. The psi-zero triplets
are stored using a technique quite similar to that used for the 
2 list
and are used as a ﬁgure of merit for recognizing the correct solution (see
Section 6.3.4).
Some considerations now about the NLAR value. A good value should secure
a number of triplets per reﬂection sufﬁcient to generate large αh parameters
for most of the NLAR reﬂections. If NLAR is small, are the NLAR reﬂec-
tions alone, once phased, able to display a sufﬁciently accurate electron density
(Burgi and Dunitz, 1971; Mö et al., 1973)? To answer this question, let us
consider the electron density expression
ρ(r) = 1
V

h Fh exp(−2πih · r).

Procedure for phase determination via traditional direct methods
133
Table 6.1 For each reﬂection h, the code number n2, n3, the signs s2, s3, the C value, and the 	 shift are given
Reﬂection (0 11 17)
Reﬂection (0 13 2)
Reﬂection (1 14 0)
s2n2
s3n3
C
	
s2n2
s3n3
C
	
s2n2
s3n3
C
	
3
127
4.61
0
3
242
3.81
180
5
−98
3.73
0
7
−70
4.20
180
−7
−205
3.22
0
11
−56
3.77
180
14
227
3.00
180
−12
248
2.88
180
26
72
3.25
0
−23
93
3.46
0
16
74
3.56
180
−29
−206
2.59
180
33
−93
3.46
180
−18
186
2.90
0
34
−242
2.45
0
−5
84
4.19
180
4
132
3.75
0
6
−130
3.42
180
10
−135
3.54
0
10
−211
3.03
0
−18
−216
2.66
180
−14
158
3.28
180
14
−243
2.84
0
27
66
3.28
0
30
181
2.91
180
17
20
4.28
0
−30
91
3.08
180
39
−87
3.29
180
21
49
3.70
180
35
201
2.53
0
−6
168
3.55
0
7
50
4.20
0
10
106
3.39
180
11
243
3.06
0
−11
57
3.94
0
23
−246
2.54
180
17
−255
2.80
180
−14
15
4.61
180
28
127
2.90
0
31
−36
3.94
0
17
−150
3.08
0
−31
244
2.48
180
40
−174
2.88
180
−21
−210
2.79
180
−39
−50
3.26
180
In principle, the summation contains an inﬁnite number of terms, but in prac-
tice the number is ﬁnite. The completeness theorem of a Fourier series states
that
1
V

V
ρ2(r)dr =

h |Fh|2.
If we construct a Fourier series via the NLAR reﬂections only, we obtain
ρ′(r) = 1
V

h ∈NLAR
Fh exp(−2πih · r) = 1
V

h
F′
h exp(−2π ih · r),
where F′
h = Fh if h is one of the NLAR reﬂections, F′
h = 0 otherwise. The
variance of ρ′(r) with respect to ρ(r) is
D2 = 1
V

[ρ(r) −ρ′(r)]2 dr =

h
|Fh −F′
h|2 =

h /∈NLAR
|Fh|2.
The variance is minimized just because the last summation involves only
weaker reﬂections (Vainshtein and Kayushina, 1967). This is why we are able
to ﬁnd a sufﬁciently good model of the electron density from a limited set of
high-intensity phased reﬂections.
In order to obtain interpretable maps, at least six |E| values per atom in the
asymmetric unit may be advised. However, a good choice for NLAR should
also take into account the space group symmetry (for a ﬁxed value of NLAR
the number of triplets which can be constructed among the NLAR reﬂections
is higher for high-symmetry space groups). An empirical formula that works
well is
NLAR = [(4t + 100) + x]1.1,

134
Traditional direct phasing procedures
where t is the number of atoms in the asymmetric unit, x = 100 if the system
is triclinic, x = 50 if the system is monoclinic.
6.3.2 Assignment of starting phases
The tangent formula is able to ﬁx one phase given the values of other
phases, but how can such phases be known? That was the question that was
not answered at the end of Section 6.2. There are two alternative ways of
proceeding, both belonging to the so-called multisolution approach.
The most traditional way is to ﬁx some reﬂections to deﬁne the origin and
the emantiomorph (see Section 3.7), and to then derive the other phases from
these. To better understand the process we will give a practical example.
Let us suppose that for a crystal structure in the space group Pnma, the
phase values of the reﬂections with code number n1 = 18, n2 = 73, n3 = 96
have been arbitrarily ﬁxed at 2π to deﬁne the origin. The phasing process will
aim at determining all other phases, one after the other in a chain process, by
cyclic application of the tangent formula. In the example shown in Fig. 6.4,
the phase of reﬂection 24 is estimated because it makes a triplet with 18 and
73. Similarly, 37 is determined since it makes a triplet with 73 and 96. In the
second cycle of the tangent process, the phases 65 and 106 are determined, and
so on.
A starting set of only three reﬂections is usually inadequate to establish a
good chain; not all of the phase may be accessible through the chain, and weak
links in the chain are frequent (i.e. some phases are poorly determined through
low-reliability relationships). The reliability of the phases determined in the
ﬁrst steps of the phasing process is critical. Indeed, errors introduced at this
point would reﬂect on the phases determined in the subsequent steps. In the
example in Fig. 6.4, all of the phases ﬁxed in the ﬁrst two cycles are determined
by means of single triplets, and therefore phase errors are highly probable.
It is therefore usual to introduce within the starting set some unknown
extra phases, necessary to provide a more straightforward phasing process.
Following the example above, let us suppose that, besides the origin-ﬁxing
reﬂections 18, 73, 96, the extra reﬂections 27, 38, 63, are included in the start-
ing set and that a procedure is available which is able to provide values for
such extra phases. Let us assume that, in this situation, the triplet relationships
involving the starting set and the early determined phases are those shown
in Fig. 6.5. By comparing Fig. 6.4 with Fig. 6.5 we observe that: (1) in the
ﬁrst cycle of the tangent process 37 is deﬁned from the two pairs (73,96) and
(73,27), and 99 is deﬁned from the two pairs (27,63) and (96,38) (on the other
hand, in Fig. 6.5, all the phases were determined via single triplets); (2) the
96
37
73
24
18
65
106
starting set
1st cycle
2nd cycle
Fig. 6.4
The starting set consists of three reﬂec-
tions: 18, 73, and 96. In the ﬁrst cycle
of the tangent procedure, the phases of
reﬂections 24 and 37 are estimated. These
are used in the second cycle to ﬁx phases
65 and 106.

Procedure for phase determination via traditional direct methods
135
25
69
88
99
107
37
24
18
73
96
106
65
77
27
38
63
1st cycle
2nd cycle
Fig. 6.5
The starting set consist of the origin ﬁxing
reﬂections 18, 73, and 96, plus three extra
reﬂections 27, 38, and 63.
number of phases determined in the ﬁrst two cycles in Fig. 6.5 is, remarkably,
larger than in Fig. 6.4.
By generalizing the above observations, one can conclude that a large start-
ing set favours the use of a large number of triplets right from the beginning.
Thus the reliability of the phases determined in the ﬁrst steps is higher.
Occasionally some reﬂections in the starting set with high |E| value may
enter into very few phase relationships and they are therefore poorly determ-
ined in terms of other phases and are of limited usefulness as components of the
starting set. A good starting set, however, should guarantee an extended net-
work of triplet relationships; phases should possibly be determined by multiple
indications through strong relationships.
An optimal method for securing a good starting set is the convergence pro-
cedure, proposed by Germain et al. (1970); for further details, the interested
reader is referred to the original paper.
An observation is now appropriate. While the three (or less, depending on
the space group symmetry) phases deﬁning the origin can be arbitrarily ﬁxed,
the three extra phases used in Fig. 6.5, traditionally called symbols, cannot.
In the case of centric structures, in order to have at least one starting set
with correct phases, eight different permutations of the signs of the symbols
should be made, and for each permutation, phasing should be attempted (see
Table 6.2).
Table 6.2 The starting set for a cent-
ric structure for the example depicted in
Fig. 6.5. The ﬁrst three reﬂections are
used to ﬁx the origin, the last three reﬂec-
tions are symbols and their signs are var-
ied. For each of the eight combinations, a
solution is attempted
18
73
96
27
38
63
+
+
+
+
+
+
+
+
−
+
−
+
−
+
+
+
−
−
−
+
−
−
−
+
−
−
−
We will obtain eight trial solutions, among which will be the correct one.
If one includes n symbols into the starting set, 2n trials would be performed,
among which the correct solution should be found. Obviously it is not advis-
able to use too large values of n, otherwise the computing time would be too
long and the identiﬁcation of the correct solution difﬁcult.
Let us now move to the acentric case, where phases may continuously vary
from 0 to 2π. A simple approach would be the quadrant permutation tech-
nique, whereby, to unknown symbolic phases four values could be assigned
in turn. For example, π/4, 3π/4, 5π/4, 7π/4, could be the assigned values,
each symbolic phase having unit probability of being, at least for one trial,
within 45◦of its true value. If p symbols are used in the phasing process
4p trials should be performed, among which the correct solution should be
found.
In the technique of quadrant permutation, the introduction of every new
extra phase represents a fourfold increase in computing time, which soon
leads to a computing time limitation, even for fast computers. An optimal
strategy for reducing the number of trials is the magic integer method (White

136
Traditional direct phasing procedures
and Woolfson, 1975; Declercq et al., 1975, 1979; Taylor and Woolfson, 1975;
Main, 1977). This technique strongly increased the efﬁciency of direct methods
procedures, but has been replaced these days by the random phase approach
(see below). For brevity, the magic integer method is not described, but the
interested reader is referred to the original papers or to Chapter 3 of Direct
Phasing in Crystallography.
The most popular approach today is the random phase approach. Random
phase values are allocated for all of the NLAR reﬂections, which then consti-
tute at the same time the starting set and the set of reﬂections to phase (Baggio
et al., 1978; Furàsaki, 1979; Yao, 1981). As single triplet phase relationships,
the tangent formula also exploits the positivity and the atomicity properties of
the electron density, essentially through the positivity of the atomic scattering
factors. However, the passage from random phases to the correct ones by cyc-
lic application of the tangent formula is not guaranteed; again, various phasing
attempts are necessary, each starting from one set of random phases, among
which the correct solution has to be found.
6.3.3 Phase determination
The fundamental tool for phase assignment is the weighted tangent formula.
Germain and Main (1971) proposed that every time a phase is determined,
a weighting factor wh is simultaneously calculated, which should be propor-
tional to the reliability of the φh estimate. For example, if φkj and φh−kj have
been determined with weights wkj and wh−kj, then equation (6.10) should be
replaced by the weighted tangent formula,
tan φh =

j wkjwh−kj|EkjEh−kj| sin(φkj + φh−kj)

j wkjwh−kj|EkjEh−kj| cos(φkj + φh−kj) = Th
Bh
,
(6.19)
with a reliability parameter given by
αh = 2N−1/2
eff
|Eh|(T2
h + B2
h)1/2.
(6.20)
The use of weighting factors yields a process of phase assignment which
develops rapidly at a good level of reliability, since no triplet EhE−kj E−(h−kj)
is left out. In addition, phases φkj and φh−kj, determined at a low level of
reliability do not affect the value of φh very much, provided that a good
weighting scheme is adopted. Today, various weighting schemes are adop-
ted in programs that use the tangent formula (Schenk, 1972a,b; Giacovazzo,
1979).
Table 6.3 Schematic of the classical
tangent procedure. The number of reﬂec-
tions to phase has been ﬁxed to NLAR =
482
{φ}

φ′

φ′′
– –
{φc}
φ1
φ′1
φ′′1
– –
φc
1
φ2
φ′2
φ′′2
– –
φc
2
φ3
φ2
φ2
– –
φc
3
–
–
–
– –
–
φ482
φ482
φ482
– –
φc
482
We schematize, in Table 6.3, how the tangent formula drives a set of ran-
dom phases to the correct values. We suppose that NLAR has been ﬁxed at
482; then, in column 1, the corresponding starting set of random phases is rep-
resented (by say {φ}). The tangent formula is ﬁrst applied to estimate a new
value for the phase of reﬂection 1, by using for the phases φkj and φh−kj making
a triplet with reﬂection 1, the randomly assigned values. The new phase, φ′
1, is
obtained. The same operations are then repeated for reﬂection 2 and continued
up to reﬂection 482. The resulting phases are in column 2 in the table (say,

Procedure for phase determination via traditional direct methods
137
the set {φ′}). The tangent formula is again applied to column 2, exactly as for
column 1; the result is column 3 (say, the set {φ′′}). These cycles are repeated
up to when the phases no longer change (from one column to the next); then
we say that convergence has been attained. The last column represents the con-
vergence phases (say, the set {φc}) and since the ﬁrst phasing attempt is now
accomplished, the convergence phases are called ﬁrst trial phases.
Since we cannot be sure that the tangent formula has driven the random
phases to the correct values, we can attempt a second trial by assigning to
the NLAR reﬂections a new set of random phases. These are submitted to the
tangent process and will end in a convergent set of phases; the second trial has
then been accomplished. A number of trials, usually between 30 and 500, are
attempted, according to the size of the structure.
6.3.4 Finding the correct solution
As stated in the previous section, multisolution procedures provide several trial
solutions; it would be too time consuming to only recognize the correct solu-
tion after having calculated and interpreted all of the various electron density
maps. It is more efﬁcient to compute, as soon as a trial solution is avail-
able, some appropriate functions, called ﬁgures of merit (FOMs), which are
expected to be extreme for the correct solution. Since the FOMs increase the
efﬁciency of direct methods, much effort has been dedicated to them: among
others, we would mention Karle and Karle (1966), Schenk (1971, 1972a,b),
Riche (1973), Germain et al. (1974), Hašek (1974), Kennard et al. (1971),
Roberts et al. (1973), Cascarano et al. (1987a, 1992a). These are the most
popular (and simplest) examples.
In accordance with the αh deﬁnition (see equation (6.11)), a trial solution is
expected to be reliable if, for all the NLAR phased reﬂections, the sum
Z =

h αh
is very large (or extreme with respect to the other trial solutions). Equivalent
FOMs are
th =

h αh

j Gh,kj
,
with 0 ≤th ≤1,
or
MABS =

h αh

h <αh >,
where <αh > = r
j=1 GjD1(Gj) is the expected value of αh (see equation
(6.14)), r is the number of triplets contributing to αh, Gj is the concentration
parameter for the jth triplet, D1(x) = I1(x)/I0(x) is the ratio of the modiﬁed
Bessel functions I1 and I0. Schenk (1972a) observed that in the 73 symmorphic
space groups (i.e. those which do not contain any glide or screw axis), a sym-
metry effect occurs which disturbs the FOM efﬁciency; the solutions with the
highest FOM values may correspond to the so-called uranium solutions, that
is, a solution for which the phases are maximally consistent but are meaning-
less from a structural point of view. Two FOMs are very useful for ﬁghting

138
Traditional direct phasing procedures
against this undesired tendency: the ﬁrst, the psi-0 FOM, was ﬁrst proposed
by Cochran and Douglas (1957) and further elaborated on by Giacovazzo
(1993) and by Cascarano and Giacovazzo (1995); the second, NQ, based on
the negative quartet relationships. These are brieﬂy commented on below.
(i) The psi-0 FOM
Let us consider a psi-0 triplet, that is a triplet for which |Eh| ≈0 while
|Ek|, |Eh−k| are large. Since |Eh| ≈0, such triplets are not actively used
within the phasing process, even if Ek and Eh−k have been phased via other
triplets. It may be expected that the phases of the complex vectors
Aj = 2|EkjEh−kj|
Neff
exp i(φkj + φh−kj) , j = 1, . . . , r
are randomly distributed between 0 and 2π. The problem is clearly
connected with the classical problem of random walk (Pearson, 1905);
according to the theory developed in Chapter 2, the resultant of the r
vectors is expected to have minimal magnitude for the correct solution.
(ii) NQ, a FOM based on negative quartet invariants
Schenk (1974) suggested the use of negative quartets (not usually involved
in the phasing process) as a ﬁgure of merit for identifying the correct solu-
tion. The simplest criterion is (Giacovazzo, 1976b; see also de Titta et al.,
1975)
NQ =

negative
quartets
Gj cos(j) = max,
where j is the jth negative estimated quartet invariant and Gj is its concen-
tration parameter as given by equation (5.23). A large positive value of NQ
implies that quartet cosines, estimated to be negative (because they have a
negative value of G) really are negative.
If negative triplet cosine estimates are available (e.g. by application of the
P10 formula, see Section 5.5) then NQ may be combined with a negative triplet
FOM:
NT + NQ =

negative
quartets
Gj cos(j) +

negative
quartets
Gj cos(j) = max
NT + NQ is expected to be a maximum for the correct solution.
Once the various FOMs have been calculated, it is possible to combine them
in a single ﬁgure, usually called CFOM, combined ﬁgure of merit, which is
used to rank the trial solutions.
6.3.5 E-map interpretation
We have seen that direct methods procedures usually end with several sets of
approximated phases (trials) by which E-maps should be computed. The FOMs
in the preceding section are a guide for arranging the solutions according to
their probability of being correct, and therefore for setting a priority list for
the examination of the Fourier syntheses. However, the solution with the best
ﬁgure of merit does not always correspond to the true structure. Sometimes,

Procedure for phase determination via traditional direct methods
139
for particularly difﬁcult structures, the correct solution can be found only after
some other more plausible solutions have been examined and rejected. In these
circumstances, supplementary work is needed and solution of the structure is
delayed.
At this stage of the procedure much assistance can be provided to the
crystallographer by a program with provision for performing several Fourier
syntheses and, for each synthesis, selecting Fourier peaks higher than a spe-
ciﬁc threshold, examining distance and angles, and performing a graphical
representation of consistent groups of Fourier peaks which could be chemic-
ally bonded (Declercq et al., 1973; Koch, 1974; Bart and Busetti, 1976; Main
and Hull, 1978). A typical procedure for interpretation of the electron density
map should involve ﬁve steps:
1. Peak search.
2. Separation of peaks into clusters (each peak in a cluster is within chemical
bonding distance of at least one other peak in the same cluster). The max-
imum bond distance depends on the chemical composition of the crystal
structure and is ﬁxed as the sum of the largest covalent radii plus a tolerance
value (say ≃0.34 Å) to allow for some distortion in molecular geometry,
which is unavoidable in E-maps and in early stages of reﬁnement.
3. Application of stereochemical criteria to produce molecular fragments.
These should comply with the chemical composition of the unit cell. For
example, if all the atoms in the unit cell are C, N, or O then limit distances
between 1.95 Å and 1.19 Å and bond angles between 85˚ and 145˚ should
be ﬁxed. If heavy atoms are present, then stereochemical criteria should be
coherently modiﬁed.
4. Labelling of atomic peaks in terms of atomic species. This may be done on
the basis of peak intensity, or, even better, of integrated peak intensity, bond
distance, and bond angles.
5. (Eventual) comparison of the fragments with the expected molecular
structure.
Unfortunately it is not always possible to extract a satisfactory structural
model from the analysis of an E-map. Indeed the quality of a map depends on
several factors, among which the following three play a prominent role:
(a) Phase errors. In most cases these are unavoidable; considerable random
errors can be tolerated without too great a loss in structural information in
the E-map, but systematic errors have greater destructive effects (Silva and
Viterbo, 1980).
(b) Amplitude truncation effects in the series representation of electron
density. Traditional direct methods do not phase reﬂections under the min-
imum threshold value ETr ≃1.2. In most practical applications, ETr lies
in the range 1.30–1.50. If phases are determined with sufﬁcient accuracy,
amplitude truncation effects are not harmful (this is a necessary condi-
tion for the general success of direct methods). However, if this effect
is associated with severe phase errors, the ﬁnal result is often destruct-
ive. A classically difﬁcult example is presented by structures suffering
pseudotranslation symmetry; if no special action is taken, the reﬂections

140
Traditional direct phasing procedures
actively used in the phasing process coincide with substructure reﬂec-
tions. Even when these reﬂections are accurately phased, and this is not
generally the rule, the information on superstructure is completely lost in
the E-map.
(c) Fourier coefﬁcients used for calculating the map. It is traditional practice
to use E coefﬁcients at the conclusion of a phasing process; they produce
a peaked effect in the map which makes its interpretation easier in terms
of atoms. On the other hand, false details, ripples of heavy atoms, etc.,
are also produced which in some cases make the correct interpretation
difﬁcult. Such a behaviour is generated by the intrinsic nature of the |E|
coefﬁcients (i.e. real atoms are replaced by unreal point atoms; <|E|2> is
never vanishing for any sin θ/λ value), and by their imperfect estimation
from experimental |F| values.
N2
N1
Cl1
Cl2
Fig. 6.6
AZET: molecular fragment provided by
an E-map obtained from NLAR = 342
reﬂections.
P1
P2
Fig. 6.7
APAPA: molecular fragment provided by
an E-map obtained from NLAR reﬂec-
tions; crossed circles correspond with
ghosts.
If the trial solution with the highest value of CFOM is unsuccessful, sub-
sequent trials are explored. We show two applications of the procedure in
Figs. 6.6 and 6.7:
(a) for AZET [Pca21; C21 H16 Cl N O, Z = 8] NLAR = 342, reﬂections are
phased with an average phase error of 28◦: the best E-map is depicted in
Fig. 6.6.
(b) for APAPA [P41212; C30 H37 N15 O16 P2.6H2O, Z = 8] NLAR = 426; the
best E-map is shown in Fig. 6.7.
In both cases, distorted molecular geometry, false peaks, and missed atoms can
be seen, due to the combination of Fourier series truncation and phase errors.
We will see in Section 6.3.6 how such effects may be reduced.
O1
N1
O2
Cl1
Cl2
N2
Fig. 6.8
AZET: molecular fragment provided by
an E-map obtained from NLAR+NEXP
reﬂections. Full circles denote atoms not
located after application of the procedure.
6.3.6 Phase extension and reﬁnement: reciprocal space
techniques
A simple way to improve the information contained in a traditional E-map
is to reﬁne and extend phases to an |E| smaller than the threshold value nor-
mally used in standard direct procedures. Phase extension may imply that there
will be some penalty to pay in terms of phase accuracy, but this is largely
compensated by smaller amplitude truncation effects; it is really a necessary
ingredient for any modern phasing program, because it can change a not inter-
pretable into a perfectly interpretable electron density map. Phase extension
may be performed in two different ways, however, the most efﬁcient way is
via direct space techniques (so-called EDM (electron density modiﬁcation)
procedures); these are described in Section 8.2.
Phase extension may also be performed in reciprocal space. A simple and
efﬁcient approach is as follows (Sheldrick, 1982; Altomare et al., 1991).
A number (say NEXP) of reﬂections immediately following the NLAR reﬂec-
tions in a list sorted in decreasing order of |E|, is selected and triplets relating
them with the phased NLAR reﬂections are calculated. Then phase extension
is performed via the tangent formula.
The effects of such a procedure may be deduced from Figs. 6.8 and 6.9,
which are the molecular models obtained after phase extension for AZET and

Procedure for phase determination via traditional direct methods
141
APAPA respectively. These models are now less distorted and more complete
than those shown in Figs. 6.6 and 6.7.
P2
P1
Fig. 6.9
APAPA: molecular fragment provided by
an E-map obtained from NLAR+NEXP
reﬂections. Full circles denote atoms not
located after application of the procedure.
The historical development of phase extension procedures in reciprocal
space deserves a short mention, because it is responsible for many phasing
advances. Let Fp be the structure factor calculated on the basis of the frag-
ment provided by the ﬁrst E-map and let F be the structure factor of the target
structure. According to Karle (1970b, 1976), a phase is regarded as known if
|Fp| > η|F| and |E| > |ET1|, where |ET1| is a suitable threshold value (usually
∼1.5), and η is the fraction of the total scattering power relative to the frag-
ment. These known phases are used as input to the tangent formula and new
phases are determined up to a threshold value |ET2| < |ET1|. A Fourier synthesis
calculated with these phases can yield a more complete model of the structure.
The process is iterative.
Beurskens and Noordik (1971), Gould et al. (1975), Beurskens et al. (1976),
and van der Hark et al. (1976) all proposed the use of difference structure
factors,
	F = (|F| −|Fp|) exp

iφp

.
After suitable normalization, the 	F values are submitted to a weighted tan-
gent formula reﬁnement procedure, which usually leads to a signiﬁcantly
improved set of difference structure factors. The procedure is iterative and is
the basis of the DIRDIF (Beurskens et al., 2008) program.
Similar reciprocal space techniques have been applied to macromolec-
ules (Weinzierl et al. (1969), Coulter and Dewar (1971), Destro (1972),
Hendrickson et al. (1973), Hendrickson (1975)). The results are all very sim-
ilar to each other; the tangent formula (or its variants) performs useful phase
extension and reﬁnement when the starting phase error is small and RES is
sufﬁciently high.
The application of the Sayre equation via a least squares procedure (Sayre,
1972, 1973, 1974a,b) shows a similar trend; Cutﬁeld et al. (1975) ﬁrst exten-
ded phases from 1.9 Å to 1.5 Å, and then combined the Sayre equation with
the least squares method. Phases were well reﬁned, but the method is not
competitive with modern direct space techniques, particularly for the larger
proteins.
These last results pose questions about the limits of the tangent formula (see
Section 6.3.7).
6.3.7 The limits of the tangent formula
It has been suggested by Sheldrick (1990) that direct methods are not expected
to succeed in the solution of small molecule structures if fewer than half of the
reﬂections in the range 1.1–1.2 Å are observed with F > 4σ(|F|). This empir-
ical rule is realistic, and, for example, indicates that phasing may also be very
difﬁcult for very small molecules when RES >1.2 Å (see also Section 1.6 for
a theoretical discussion of this problem).
The state of the art has been described in a paper by Caliandro et al. (2009),
where, for a large set of small test structures, data were cut at different resolu-
tion limits to check the efﬁciency of tangent approaches. The overall result was

142
Traditional direct phasing procedures
as follows: the success obtained with ab initio protein phasing at non-atomic
resolution (see Section 10.4) cannot be extended to small and medium-sized
molecules. Unexpectedly, RES is a parameter more critical for such molecules
than for proteins. The rationale is that the high percentage of solvent (i.e. from
30 to about 80%) in a protein unit cell is a big source of information. The higher
the percentage, the more effective are solvent-ﬂattening techniques, so basic to
phase extension and reﬁnement. In small and medium-sized molecules, this
source of information is absent and solvent-ﬂattening techniques cannot be
used. Thus, solving ab initio these structures at RES ∼1.8 Å is outside the lim-
its of the present state of the art. Similar difﬁculties were described by Palatinus
and Chapuis (2007), where a charge-ﬂipping method was used.
A theoretical criterion for guessing whether a structure may be solvable by
direct methods has been suggested by Giacovazzo et al. (1994a). They showed
that the distribution of the parameter α, as deﬁned by equation (6.11), is the
normal distribution,
P(αh) ≈N

αh, < αh >, σαh

,
where <αh > is given by equation (6.14) and σ 2
αh by equation (6.15). Both
parameters are deﬁned in terms of the experimental data; e.g. as a function of
the structural complexity (since G depends on Neq) and as a function of RES
(since r increases when RES improves). The ratio
zh = <αh > /σαh
is very useful for guessing if a given structure is or is not solvable via tangent
procedures. z may be considered as a ‘signal-to-noise’ ratio; large values of zh
correspond to large values of <αh > in front of a small value of σαh. Diffraction
data for which high values of z may be calculated for most of the strong reﬂec-
tions constitute a set suitable for the successful application of direct methods.
Indeed, owing to the large values of α (implicit in large z values), correspond-
ing phases can be accurately deﬁned. If small values of z are calculated for
most of the strong reﬂections, then the tangent formula will hardly work at all.
LOGANIN
MGHEX
Fr(<α>)
WINTER
APAPA
0
0
0.05
0.10
20
40
60
<α>
Fig. 6.10
Fr(<α >) is the frequency distribution
of <α >, calculated for some small-
molecule data.

Procedure for phase determination via traditional direct methods
143
Accordingly, when the size of the structure increases and/or the data resolution
becomes poorer, the z values are expected to be small (on average).
In Figs. 6.10 and 6.11, we show the experimental frequency distribution
of < αh > ([say Fr(< α >)) for some small molecule structures and for some
small proteins; in Figs. 6.12 and 6.13 are shown the corresponding Fr(z)
distributions. The percentage of reﬂections with large values of < αh > is sufﬁ-
ciently high for all the small structures in Fig. 6.10 and for most of the proteins
in Fig. 6.11. All of the small structures in Fig. 6.12 show a favourable value
of z for most of the reﬂections (they are therefore expected to be easily solved
by application of the tangent formula), while the same behaviour cannot be
seen in Fig. 6.13 for most of the proteins. APP and probably BPTI are the
only two proteins which seem to be solvable by application of the sole tangent
formula. Proteins are therefore outside the potential of the tangent formula,
unless some supplementary information is introduced into the phasing process
(see Section 6.4 for the combination of tangent techniques with direct space
approaches).
LYSO
MYO
Fr(<α>)
0.40
0.30
0.20
0.10
0
0
10
20
30
40
50 <α>
INSULIN
M–FABP
BPTI
APP
Fig. 6.11
Fr(<α >) is the frequency distribution of
<α >, calculated for some protein data.
LOGANIN
WINTER
MGHEX
Fr(z)
APAPA
0
0
2
4
6
8
10
12
Z
0.05
0.10
Fig. 6.12
The P(z) distribution for some small-
molecule data.
LYSO
Fr(z)
MYO
0.30
0
0
2
4
8
10
6
Z
INSULIN
M–FABP
BPTI
APP
0.20
0.10
Fig. 6.13
The P(z) distribution for some protein
data.

144
Traditional direct phasing procedures
6.4
Third generation direct methods programs
Phase relationships work in reciprocal space; indeed, they establish a prob-
abilistic relation between one phase and another known set of phases. Their
validity depends on the positivity and atomicity of the electron density; why
then do we not exploit such properties in direct space? This approach has been
adopted by the so-called third generation direct methods programs, all com-
bining direct and reciprocal space techniques. We will make reference to shake
and bake, to half-bake, and to the SIR suite programs as being representative
of the new paradigm.
6.4.1 The shake and bake approach
The ﬁrst attempt to theorize the combined use of direct and reciprocal space
approaches was Shake and Bake (de Titta et al., 1994; Weeks et al., 1994;
Hauptman, 1995; Miller et al., 1994). This was the ﬁrst program capable of
solving small protein structures ab initio. It is based on the cosine least squares
method, mentioned in Section 6.1 and on repeated cycles of electron dens-
ity modiﬁcation (EDM). The reader is referred to Section 8.2 for preliminary
information on this technique.
The triplet invariants
tijl = φi + φj + φl
and the negative quartet invariants
qijlm = φi + φj + φl + φm
are generated from a speciﬁed basis set of reﬂections which have the largest
R values. The Cochran concentration parameters C (as given by (5.4)) and the
Giacovazzo parameter G (as deﬁned by (5.23)) are here renamed Tijl and Qijlm,
respectively; they are associated with triplets and quartets respectively. The
phases are required to minimize the function
R(φ) = i, j, lTijl

cos ijl −D1(Tijl)
2+i, j, l, m|Qijlm|

cos ijlm −D1(Qijlm)
2
i, j, lTijl + i, j, l, m|Qijlm|
,
where
D1(x) = I1(x)/I0(x)
is the ratio of the modiﬁed Bessel functions of order 1 and 0 respectively.
Since triplets and quartets are functions of the individual phases, R(φ) is also
implicitly deﬁned as a function of them.
R(φ) is expected to have a global minimum, provided that the number of
phases involved is sufﬁciently large, when all the phases are equal to their true
values for some choice of origin and enantiomorph. Thus, the phasing problem
reduces to that of ﬁnding the global minimum of R(φ) (the minimum principle).
Let us consider now the value of R(φ), say RT(φ), when the phase invariants

Third generation direct methods programs
145
assume values equal to their expected values. The triplet contribution to RT(φ)
will then be
(RT(φ))triplets ≃i, j, lTijl

cos2 ijl

+ D2
1(Tijl) −2 cos ijlD1(Tijl)

i, j, lTijl
.
Since cos2  = (1 + cos 2)/2, in accordance with (5.A.5), the above expres-
sion reduces to
(RT(φ))triplets = i, j, lTijl

0.5 + 0.5D2(Tijl) −D2
1(Tijl)

i, j, lTijl
.
= 0.5 + i, j, lTijl

0.5D2(Tijl) −D2
1(Tijl)

i, j, lTijl
.
Since 0.5D2 (x) < D2
1 (x), the following inequality will hold:
(RT (φ))triplets < 1

2.
A similar expression will be obtained if we consider just the quartet
contribution. On considering both triplets and quartets we have,
RT(φ) = 0.5 + i, j, lTijl

0.5D2(Tijl) −D2
1(Tijl)

+ i, j, l,m|Qijlm|

0.5D2(Qijlm) −D2
1(Qijlm)

i, j, lTijl + |Qijlm|
< 1/2.
This may be considered as a guideline for recognizing the correct solution
among numerous trials. A trial for which RT(φ) is much larger than 0.5 may
be considered to be an unreliable solution.
The six-step shake and bake procedure may be described as follows.
1. The number of reﬂections to phase is chosen to be close to 10t, and the
total number of invariants is chosen to be close to 100t (t being the number
of atoms in the asymmetric unit). Triplet and negative quartet invariants
are generated. Often, only triplets are used. If both triplets and quartets are
employed, the number of quartets is chosen so as to satisfy the relation
i, j, lTijl ≃i, j, l, m Qijlm. This usually means that the number of negative
quartets is somewhat larger than the number of triplets.
2. A trial structure of randomly positioned atoms (no two atoms to be closer
than a minimum distance, say 1.2 Å) is generated.
3. Normalized structure factors are calculated from the trial coordinates.
4. The phase values are perturbed by the parameter-shift method, in which
R(φ) is minimized as follows. The phase set is ordered in decreasing value
of |E| and evaluated in the same order. When considering a given phase
φi, the value of R(φ) is initially evaluated three times: once at φi, once at
φi + 90◦, and once at φ −90◦. If φi yields the minimum of the three val-
ues of R(φ), then the phase is accepted and the procedure then examines
phase φi+1. Suppose instead (see Fig. 6.14) that φi −90◦yields the min-
imum value of R(φ). Then the phase value is updated at φi −90◦, but a
further shift is checked (phase value at φi = 180◦), for which R(φ) is again
evaluated. The ﬁnal phase value chosen for φi will be that yielding the min-
imum of R(φ). For cs. space groups or for symmetry-restricted phases in
n.cs. space groups, only a 180◦shift has to be tested for each phase.
R(φ) = 0.42
φi
φi + π/2
R(φ) = 0.48
φi – π/2
R(φ) = 0.40
φi ± π
R(φ) = 0.39
Fig. 6.14
An
example
of
the
parameter
shift
method used in shake and bake.

146
Traditional direct phasing procedures
5. As soon as all of the phases have been evaluated, an E-map is calculated.
6. The electron density map is ﬁltered, that is, the largest peaks in the Fourier
map are selected (their number corresponds to about 0.8 of the number of
expected atoms).
The procedure then returns to step 3 for cyclic improvement of the model.
If the procedure converges to a false solution, a new trial model is generated
(step 2) and the process is repeated.
Shake and bake (see Fig. 6.15) consists of a shake step (phase reﬁnement)
and a bake step (electron density modiﬁcation), this second step aiming at
imposing phase constraints implicit in real space. Accordingly the program
requires two Fourier transforms per cycle, and numerous cycles. Thus, it can
be time consuming and is not competitive with other direct methods for crys-
tal solution of small molecules. However, it has introduced into the ﬁeld
extremely useful intensive computations for the direct solution of complex
crystal structures. Indeed, shake and bake has succeeded in solving quite com-
plex structures which only a few years ago were considered to be outside the
range of applicability for direct methods. We note here the small protein struc-
tures solved so far by shake and bake. t is the number of non-hydrogen atoms
in the asymmetric unit, d is the data resolution:
Structure
Space group
t
d (Å)
Vancomycin
P43212
255
0.9
Gramicidin A
P212121
317
0.86
Er-1 pheromone
C2
325
1.0
Crambin
P21
400
0.83
Alpha-1peptide
P1
450
0.92
Rubredoxin
P21
500
1.0
Tox II
P212121
624
0.96
14 peptide
I4
289
1.1
It seems that data resolution has to be equal to or better than 1.1 Å. This condi-
tion is currently essential for success; further efforts will be necessary in order
to make such a condition less severe. It may be instructive to check the predict-
ive power of the z-test by applying it to the above list of structures. The Fr(z)
distribution for representatives of such a list is shown in Fig. 6.16. The ﬁgure
Shake
trial
structures
FT–1
FT–1
FT
Phase
reﬁn.
Bake
Density
mod.
Final
structures
Fig. 6.15
The shake and bake scheme.

Third generation direct methods programs
147
0.30
Fr(z)
0.20
RUBR
CRAMB
APP
VMN2
0.10
0.00
0
2
4
6
8
10
12
Z
Fig. 6.16
P(z) test for some of the structures solved
by shake and bake.
indicates that each diffraction set contains enough information to allow crystal
structure solution via the tangent formula or a related approach.
6.4.2 The half-bake approach
Due to Sheldrick (1997), half-bake does most of its work in direct space.
Random phases are generated, to which the tangent formula is applied. E-maps
are calculated, in which 1.3t peaks (t is the expected number of non-hydrogen
atoms in the asymmetric unit) are searched.
Let Eo and Ec be the observed and the calculated (from the current model)
normalized structure factors.
A number of peaks are eliminated subject to the condition that
|Ec|(|E0|2 −1) remains as large as possible (only reﬂections with |E0| >
|Emin| are involved, where |Emin| ≃1.4). The phases of a suitable subset of
reﬂections are then used as input for a tangent expansion. Then, an E-map
is calculated from which peaks are selected; these are submitted to the
elimination procedure.
Typically, from 5 to 20 cycles of this internal loop are performed. Then, the
correlation coefﬁcient (CC) between |E0| and |Ec| is calculated for all the data.
If CC is good (i.e. larger than a given threshold), then a new loop is performed;
a new E-map is obtained, from which a list of peaks is selected which are all
submitted to the elimination procedure. The criterion now is the value of CC,
which is calculated for all the reﬂections. Typically from two to ﬁve cycles of
this external loop are performed.
The program works indeﬁnitely, restarting from random atoms until inter-
rupted. It may work either applying the true spaces group symmetry or after
having expanded the data to P1.
Half-bake has proved to be more efﬁcient than shake and bake: it has led
to 2000 non-hydrogen atoms in the asymmetric unit as the size limit for a

148
Traditional direct phasing procedures
structure solvable by direct methods. The procedure is now part of SHELX-D
(Sheldrick, 1998).
6.4.3 The SIR2000-N approach
Unlike shake and bake and half-bake, in SIR2000-N (Burla et al., 2001) and
in most of the subsequent programs of the SIR suite, the tangent reﬁnement
section is followed by a real-space phasing process without alternation. The
tangent formula is ﬁrst applied, within a multisolution random phase approach;
the ﬁnal phases are then submitted, in the order ﬁxed by a ﬁgure of merit, to
the real-space procedure, the moduli of which may be described as follows:
(a) Electron density modiﬁcation (EDM). In repeated EDM cycles, only a
fraction of the electron density map (say 2.5%) is used in the map inver-
sion, the rest is set to zero (see Shiono and Woolfson, 1992, for a related
method).
(b) Periodically, after some EDM cycles, the heaviest atomic species is associ-
ated with the selected peaks, with an occupancy factor taking into account
peak height, site occupancy, and chemical connectivity. If heavy atoms are
present, the displacement parameters are submitted to least squares.
(c) Peaks are labelled in terms of atomic species. The atomic positions are sub-
mitted to automatic diagonal-matrix least-squares cycles; combined with
2Fo-Fc syntheses, the procedure allows us to cyclically reﬁne the structural
model.
To avoid a waste of computing time, the crystal structures are divided into
four classes: small (up to 80 atoms per asymmetric unit), medium (up to 200),
large (e.g. proteins), and resistant. The number of cycles of each modulus is
reduced according to the structure size.
The applications of SIR2000-N to a wide set of test structures has shown
some interesting general trends which suggest how and when the synergy
between real-space and reciprocal space procedures is essential for success:
(i) Tangent procedures alone are able to solve the phase problem for small
molecules, by driving random phase sets to the correct result, with quite
small average phase error (say 10–25◦).
(ii) The efﬁciency of the tangent formula decreases with structural com-
plexity. For medium-sized structures, the ﬁnal phase error may be
non-negligible (e.g. in the interval 20–50◦or more).
(iii) The ﬁnal average phase error may be larger than 50◦for larger structures
and the best solution may not be distinguishable from the others.
(iv) In a multisolution approach, the phase problem for small molecules may
also be solved by real-space procedures alone, without the help of the
tangent step. On the conversely, the tangent formula is still useful for
medium and large-sized molecules, since it provides sets of phases which
are more favourable (for subsequent real-space reﬁnement) than trial
random sets.
(v) When applied to proteins, SIR2000-N, as well as its more efﬁcient heir
SIR2011 (Burla et al., 2012a) and all the third generation programs, all

Finding quartets
149
require diffraction data at atomic or nearly atomic resolution. Mooers and
Matthews (2006) extended to about 2300 non-H atoms in the asymmetric
unit as the size limit for structures solvable by direct methods, by phasing
via SIR2002 (Burla et al., 2003a) the previously unknown bacteriophage
P22 lysozyme.
A last remark may be useful. All of the above described methods are less
efﬁcient than Patterson techniques when the unit cell contains heavy atoms.
In such cases, Patterson deconvolution methods (implemented in SIR2011; see
Caliandro et al., 2008a) bring the size limit to about 8000 non-H atoms in the
asymmetric unit and the resolution limit to about 2 Å (see Section 10.4).
APPENDIX 6.A
FINDING QUARTETS
In order to select quartets with large values of C (as given by equation (5.17)),
the quartet invariants are usually searched among the subsets {S} of reﬂections
with R > RTh, where RTh is a suitable threshold. Two algorithms are commonly
used.
Algorithm 1
1. The indices of the reﬂections symmetry equivalent to the unique reﬂections
in {S} are calculated, so obtaining the expanded list.
2. For a given h1 all the triplets h2, h3, h1 + h2 + h3 with R > RTh are found.
The search is made by letting h1 vary over the subset of standard reﬂections
while h2, h3, and h1 + h2 + h3 can span over the expanded list. In practice,
all the sets of four vectors
h1, h2Ri, h3Rj h1 ± h2Ri ± h3Rj
are found, where Ri and Rj vary over all the rotation matrices of the space
group.
3. The cross-vectors are calculated and each quarter is estimated. This
algorithm simultaneously ﬁnds positive and negative quartets, according
to the speciﬁc values of the cross-magnitudes. Statistically speaking, the
percentage of positive estimated quartets is, remarkably, larger than that of
the negative ones. Indeed, 1 + ε5 + ε6 + ε7 is more probably positive than
negative.
Algorithm 2
1. Triplets are calculated, and quartets are obtained as the sum of two triplets.
For example, from the two triplets
φh1 + φh2 −φh5 (h1 + h2 −h5 = 0)
(6.A.1a)
φh3 + φh4 + φh5 (h3 + h4 + h5 = 0).
(6.A.1b)

150
Traditional direct phasing procedures
Table 6.A.1 Number of triplets (NTRIP) and quartets
(NQUAR) found among n reﬂections for CEPHAL [C2, C18
H21 N O4, Z = 8] and MUNICH [C2, C20 H16, Z = 8]
n
NTRIP
NQUAR
CEPHAL
50
6
298
100
113
4631
200
836
76 092
334
3751
645 213
MUNICH
50
34
317
150
535
27 964
310
3704
509 781
the quartet
φh1 + φh2 + φh3 + φh4 (h1 + h2 + h3 + h4 = 0)
is obtained. The method simultaneously provides one cross-magnitude of
the quartet, i.e. Rh5.
2. The other cross-vectors are calculated and each quartet is estimated.
If one is interested in negative quartets only, algorithm 2 is preferable. In this
case, the two triplets (6.A.1) should be psi-zero triplets (see Section 6.3.4), and
h5 is the vectorial index of the weak reﬂection. Algorithm 2 in this case directly
selects quartets having at least one small cross-magnitude, thus providing large
percentages of negative estimated quartets.
Algorithm 2 is also preferable if one is only interested in positive quartets.
In this case, the two triplets (6.A.1) should belong to the 2 list and h5 is the
vectorial index of a strong reﬂection.
The number of quartets which can be found among a given subset {S}
is much larger than the corresponding number of triplets. In order to give a
practical insight, in Table 6.A.1 we show the number of triplets (NTRIP) and
quartets (NQUAR) found via algorithm 1 among a subset of n reﬂections. It is
seen that NQUAR quickly increases with n; it is not infrequent that several
millions of quartets can be found in high-symmetry space groups among only
400–500 standard reﬂections.
However, most of these quartets will have small reliability parameters (we
should not forget that quartets are phase relationships of order N−1).

Joint probability
distribution functions
when a model
is available: Fourier
syntheses
7
7.1
Introduction
The title of this chapter may seem a little strange; it relates Fourier syn-
theses, an algebraic method for calculating electron densities, to the joint
probability distribution functions of structure factors, which are devoted to
the probabilistic estimate of s.i.s and s.s.s. We will see that the two topics are
strictly related, and that optimization of the Fourier syntheses requires previous
knowledge and the use of joint probability distributions.
The distributions used in Chapters 4 to 6 are able to estimate s.i. or s.s. by
exploiting the information contained in the experimental diffraction moduli of
the target structure (the structure one wants to phase). An important tool for
such distributions are the theories of neighbourhoods and of representations,
which allow us to arrange, for each invariant or seminvariant , the set of
amplitudes in a sequence of shells, each contained within the subsequent shell,
with the property that any s.i. or s.s. may be estimated via the magnitudes
constituting any shell. The resulting conditional distributions were of the type,
P(| {R}),
(7.1)
where {R} represents the chosen phasing shell for the observed magnitudes.
The more information contained within the set of observed moduli {R}, the
better will be the  estimate.
By deﬁnition, conditional distributions (7.1) cannot change during the phas-
ing process because prior information (i.e. the observed moduli) does not
change; equation (7.1) maintains the same identical algebraic form. However,
during any phasing process, various model structures progressively become
available, with different degrees of correlation with the target structure. Such
models are a source of supplementary information (e.g. the current model
phases) which, in principle, can be exploited during the phasing procedure.
If this observation is accepted, the method of joint probability distribution, as
described so far, should be suitably modiﬁed. In a symbolic way, we should
look for deriving conditional distributions
P

| {R},

Rp

,
(7.2)

152
Joint probability distribution functions when a model is available
rather than (7.1), where

Rp

represents a suitable subset of the amplitudes of
the model structure factors. Such an approach modiﬁes the traditional phasing
strategy described in the preceding chapters; indeed, the set

Rp

will change
during the phasing process in conjunction with the model changes, which will
continuously modify the probabilities (7.2). We will study in this chapter two
invariants,  = (φh −φph) and  = (φh + φk −φh+k), given suitable subsets
of observed and calculated diffraction amplitudes.
The conditional distributions (7.2) are also able to optimize the Fourier
syntheses, a fundamental tool in modern crystallography, devoted to the cal-
culation of various types of electron density maps. Such syntheses may be
computed only if a model structure is available: to obtain optimized syntheses,
their coefﬁcients should reﬂect the reliability of the model, by including a
weight depending on model quality. This is the main reason why Fourier
syntheses and joint probability distribution functions of structure factors are
treated together in this chapter.
In Section 7.2, we will describe the probability distribution of the s.i.,
 = (φh −φph). In Section 7.3, we will analyse the different types of electron
densities, i.e. the so-called observed, difference, and hybrid Fourier syntheses,
their main properties, and the most useful weighting schemes, strictly connec-
ted with the distributions detailed in Section 7.2. In Section 7.4, the parameters
affecting the quality of the electron density maps are discussed. In Section 7.5,
a formula estimating triplet phase invariants from observed and calculated
amplitudes is described.
7.2
Estimation of the two-phase structure
invariant (φh −φph)
Model and target structures are often denoted as isomorphous. The usual con-
dition is that they have the same unit cell, the same space group, and their
crystal structures are sufﬁciently correlated. We will suppose, as a work-
ing hypothesis, that the model structure arose during the phasing approach
and that it is correlated with the target structure. Thus, model and target are
isomorphous.
According to Section 3.3, h = (φh −φph) is a two-phase s.i., where φh is
the phase of the target, and φph is the phase of the model structure. h may
be estimated via the method of joint probability distributions, but now two
isomorphous structures are involved. This implies a strong modiﬁcation of the
mathematical approach established in Chapters 4 to 6, where only one structure
was considered. In that approach, the atomic position rj of the target structure
was assumed to be the primitive random variables, spanning uniformly over
the unit cell. In this new approach, the atomic positions of the model struc-
ture also span the unit cell and therefore they should also be involved in the
mathematical modelling. However, the target and the model structures are sup-
posed to be isomorphous, and therefore their atomic positions can no longer
be considered to be statistically independent.
In the following, we will assume that N is the number of atoms in the
target and Np the number of atoms in the model structure: rj, j = 1, . . . , N

Estimation of the two-phase structure invariant (φh −φph)
153
and rpj, j = 1, . . . , Np, with (usually) Np < N, are the atomic positions of
the target and of the model structure, respectively. The simplest mathematical
approach was suggested by Sim (1959a,b). He made the following hypotheses:
(a) The vectors rj, j = 1, . . . , N are the primitive random variables, assumed
to be uniformly distributed in the unit cell.
(b) rpj = rj, for j = 1, . . . , Np, with Np < N.
The situation is as depicted in Fig. 7.1, for a non-realistic one-dimensional
structure: two ‘triangular’ atoms of the model perfectly coincide with two
atoms of the target.
ρ
ρp
ρq
Fig. 7.1
Non-realistic one-dimensional four-atom
target structure (ρ) and a two-atom model
structure (say ρp), the atomic positions of
which perfectly coincide with two atoms
of the target structure (parameter D = 1).
In accordance with the above scheme, the normalized structure factors are
modelled as follows:
Eh = Rh exp(iφh) =
N
j=1 fj exp(2πih · rj)
	
(εhN)1/2,
Eph = Rph exp(iφph) =
Np
j=1 fj exp 2πih · rpj
	
εhNp
1/2,
where εh is the correction factor for expected intensities arising from Wilson
statistics, and
N =
N

j=1
f 2
j ,
Np =
Np

j=1
f 2
j .
The Sim model is often not realistic; it is very rare that the atoms of a
model structure occupy the same positions as in target structures. Srinivasan
and Ramachandran (1965a,b) suggested less strict hypotheses:
(a) rpj, j = 1, . . . , Np, are ﬁxed known parameters;
(b) rj = rpj + rj, j = 1, . . . , p. The variables rj are riding variables, which are
variables correlated with the corresponding rpjs through local positional
errors rjs. A schematic example of target and model structures is shown
in Fig. 7.2, where N = 4 and Np = 2; the rj moduli have been chosen
sufﬁciently small so as to secure, at least at low resolution, isomorphism
between the model and target structures. In the absence of any information
on their distribution or on their mutual correlation, it was assumed that the
rjs are independent of each other and uniformly distributed around zero.
In many practical situations, this condition is violated, e.g. when molecular
fragments of the model are translated with respect to the correct position or
are rotated with respect to the correct orientation; then, the rjs are equal
to each other in the ﬁrst case, or are referred to each other by a rotation
in the second case. In the absence of any supplementary information, the
independence of the rjs is a less demanding hypothesis one can apply.
ρ
ρp
Δr1
ρq
Δr2
Fig. 7.2
Schematic target and model structures for
N = 4, Np = 2. Model and target struc-
tures partially overlap; parameter D is in
the interval (0,1).
(c) rj, j = p +1, . . . , N are primitive random variables, assumed to be
uniformly distributed within the unit cell.
According to the preceding hypotheses, we can model the normalized structure
factors as follows:
Eh = Rh exp(iφh) =

Np
j=1 fj exp[2πih · (rpj + rj)] +
N
j=Np+1 fj exp(2πih · rj)

(εhN)1/2

154
Joint probability distribution functions when a model is available
Eph = Rph exp(iφph) =
p
j=1 fj exp(2πih · rpj)
	
εhNp
1/2.
A further generalization was suggested by Caliandro et al. (2005c), who
included the measurement error into the mathematical formalism. As for
Srinivasan and Ramachandran, the rpj, j = 1, . . . , Np, are ﬁxed known
parameters, the rj = rpj + rj, j = 1, . . . , p, are riding variables, and
rj, j = p + 1, . . . , N are primitive random variables. The measurement error
is parameterized through the following structure factor model:
Eh =

Np
j=1 fj exp[2πih(rpj + rj)] +
N
j=Np+1 fj exp(2πihrj) + |μ| exp(iϑ)

(εN)1/2,
Eph =
p
j=1 fj exp 2πihrpj
	
εNp
1/2,
where |μ| exp(iϑ) is the (complex) measurement error. |μ| and θ are two
supplementary primitive random variables arising from the experimental
uncertainty on the observed structure factor (<|μ|> is related to the stand-
ard deviation of the measured diffraction amplitude). The conclusive joint
probability distribution function is
P(R, Rp, φ, φp) = RRp π−2
e −σ 2
A
−1
exp

−
1
(e −σ 2
A)

R2 + eR2
p −2σARRp cos(φ −φp)

,
(7.3)
where
σA = D

Np/N
(7.4)
D = < cos(2πh · r) >
(7.5)
e = (1 + σ 2
R),
and
σ 2
R = <|μ|2>

N.
From (7.3), the conditional distribution
P(|R, Rp) = [2πI0(X)]−1 exp(X cos )
(7.6)
is obtained, where  = φ −φp and
X = 2σARRp
(e −σ 2
A).
(7.7)
As for all von Mises distributions,
m = < cos(φ −φp) > = I1(X)/I0(X).
(7.8)
Equation (7.6) suggests that if X is large enough, then φ ≈φp m and is the
weight to associate with such relation. The reliability parameter X depends not
only on the product RRp, but also on Np/N (a factor which estimates the
incompleteness of the model structure), and on the parameter D (a factor which
estimates the similarity between the Np-atom model and the corresponding
Np-atom substructure in the target structure). D (standing for Dh), for the ﬁxed

Electron density maps
155
h reﬂection, is obtained through an average performed over the different rj,
j = 1, . . . , Np. Values will be D = 1 when the Np atomic positions of the model
coincide with Np atomic positions in the target structure, D = 0 when the model
atomic positions are completely uncorrelated with the target atoms. Obviously,
D is not a measurable quantity; it may only be estimated statistically during the
phasing process, but it allows us to deﬁne a very important parameter, σA, quite
central to distribution (7.6).
The mean value of σA (say <σA>; the average is calculated over all reﬂec-
tions) is a good estimate of the correlation between model and target structures.
Indeed, if σA = 1, then Np = N and D = 1; if σA = 0, the two structures
are uncorrelated. We will see in Appendix 7. A how σA may be estimated
statistically.
For the centric case, the following distribution is obtained:
P

E, Ep

=
1
(2π)

(e −σ 2
A)
exp

−
1
2(e −σ 2
A)

eE2
p + E2 −2σAEEp

.
It can easily be seen that the Sim model is a particular case of the Srinivasan
and Ramachandran model, obtained by ﬁxing rj = 0, j = 1, . . . , Np.
Furthermore, the classical Srinivasan and Ramachandran distribution is
obtained from (7.3) by assuming that e = 1.
If equation (7.3) is integrated over φ and φp, the marginal distribution
P(R, Rp) is obtained, from which the conditional distributions, P(R|Rp) and
P(Rp|R) may be obtained. The distribution P(R|Rp) is important for maximum
likelihood approaches (the reader is referred to McCoy (2004) for a recap, to
Murshudov et al. (1997) and de la Fortelle and Bricogne (1997) for reﬁnement,
and to Read (2001, 2003a,b) for molecular replacement) and for Free lunch
techniques (see Caliandro et al. (2005a,b) and Section 8.2). The conditional
distributions are quoted in Appendix 7.C.
7.3
Electron density maps
As the reader may know, Fourier syntheses are a fundamental tool in the daily
work of a crystallographer; if X-ray data have been collected and a model is
available, such syntheses allow us to guess about the distribution of the elec-
trons in the unit cell. The study of the properties of electron density maps
started with W. H. Bragg in 1915 and continued with Bragg and West (1930),
Booth (1946, 1947), Cruickshank (1949), Cochran (1951), and Cruickshank
and Rollett (1953).
The properties of Fourier syntheses are also an important tool for solution
of the phase problem, particularly when only an imperfect model structure
is available and one wants to recover the target structure. Ramachandran and
Raman (1959), Srinivasan (1961), and Main (1979), analysed the various types
of Fourier synthesis and studied their convergence properties. In more recent
years, syntheses and their possible applications were reconsidered by Read
(1986), Ursby and Bourgeois (1997), Cowtan (1999), Lunin et al. (2002),

156
Joint probability distribution functions when a model is available
Giacovazzo and Mazzone (2011, 2012), Giacovazzo, Mazzone, and Comunale
(2011), and Altomare et al. (2008a,b; 2009c, 2010).
In Section 7.3.1 we will discuss the main features of an ideal Fourier syn-
thesis, calculated via equation (1.18) when correct phases and amplitudes are
available. In Sections 7.3.2 to 7.3.4, we will describe the most popular Fourier
syntheses and their main properties.
7.3.1 The ideal Fourier synthesis and its properties
Let us recall equation (1.18):
ρ(r) = 1
V

h
|Fh| exp(iφh) exp(−2πih · r),
(7.9)
where r is a generic point of the unit cell. ρ(r) is a non-negative function whose
maxima are expected to coincide with the atomic positions. We will describe
the properties of synthesis (7.9), as a function of various parameters, when
diffraction amplitudes and phases are known without error.
1. Temperature factor. Thermal displacement modiﬁes the electron density
of the atoms, by enlarging the volume frequented by the atomic elec-
trons; consequently the atomic scattering factor decreases more rapidly
with sin θ/λ. The larger the temperature factor, B, the smaller the corres-
ponding peak intensity in the electron density map, and the larger its full
width at half maximum. This behaviour may be veriﬁed in Fig. 7.3, where
we show, in a one-dimensional example, the electron density for C atoms
at different temperature factors. An important effect of the thermal dis-
placement is the modiﬁcation of RES; proteins are usually characterized
by high values of B and consequently the experimental data resolution is
often non-atomic (see point 4 in this section).
2. Chemical occupancy. If an atom is located at r and we reduce the chemical
occupancy in that position, the corresponding peak in the electron density
130
B = 0
B = 5
B = 10
ρ(x)
110
90
70
50
30
10
–10
–0.1
–0.2
–0.3
0
0.1
0.2
0.3
x
Fig. 7.3
One-dimensional
space:
the
electron
density of C atoms at different temperat-
ure factors (for the ripples, see point 4 of
this section).

Electron density maps
157
130
OCC = 1.0 B = 10
OCC = 0.5 B = 10
ρ(x)
110
90
70
50
30
10
–10
–0.1
–0.2
–0.3
0
0.1
0.2
0.3
x
Fig. 7.4
One-dimensional example: reduction of
the chemical occupancy from 1.0 to
0.5 implies a modiﬁcation of the electron
density proﬁle.
will, similarly, be smaller (see Fig. 7.4). The reader may wonder whether
an increase in the thermal factor may be distinguished from a reduction
in the chemical occupancy. In Fig. 7.5, we show two C atoms, the ﬁrst
with full occupancy and B = 30 and the second with chemical occupancy
0.5 and B = 2.2. The intensities of the two peaks are equal, but the full
width at half maximum of the second peak is sharper. The two proﬁles are
indeed different, but in real cases it may be difﬁcult to distinguish between
occupancy and temperature displacement effects.
3. Disorder. The overall effect of disorder is a modiﬁcation of RES. For
example, fewer diffraction amplitudes can be measurable experimentally
if the disorder involves a large fraction of the unit cell; electron density
maps are then less informative. In some cases, disorder involves only spe-
ciﬁc regions of the electron density map (not unusual for both small and
ρ(x)
–0.1
–0.2
–0.3
0
0.1
0.2
0.3
x
0
60
OCC = 1.0 B = 30
OCC = 0.5 B = 2.2
40
20
Fig. 7.5
Two electron density proﬁles of a C
atom are superimposed, the ﬁrst with full
chemical occupancy and B = 30 and the
second with chemical occupancy 0.5 and
B = 2.2. The intensities of the two peaks
are equal but the full width at half max-
imum of the second peak is sharper.

158
Joint probability distribution functions when a model is available
macro-molecules; e.g. peripheral groups of atoms which may rotate about
one bond). In this case the electron density, in that region, will show a
mean structure, resulting from an average over all of the different possible
conﬁgurations. Correct interpretation of an electron density map therefore
requires a good disorder model.
4. Resolution bias. The summation on the right-hand side of equation
(7.9) goes over an inﬁnite number of reﬂections. Because of the diffrac-
tion limits, only a limited number of measurable reﬂections are available;
thermal displacement effects may make RES even worse. If vanishing dif-
fraction data only are omitted from the right-hand side of (7.9), then all
of the information contained in the structure factors is transferred to the
electron density. If a signiﬁcant signal is still present from the reﬂections
used in the Fourier summation, then the Fourier transform has not been
performed correctly. Owing to reﬂection truncation, the following effects
will arise in the electron density map: the geometrical form of the peak
proﬁle is modiﬁed; peaks are broader; oscillating ripples are present close
to each atomic peak, which interfere with the ripples of the closest peaks;
the peaks positions themselves are modiﬁed. All of these effects fall under
the heading resolution bias.
To provide a short mathematical treatment of truncation effects, let us assume
that
ρ(r) =
N
j=1 ρj(r −rj)
is the electron density, expressed as sum of atomic electron densities ρj(r)
centred on atomic positions rj. ρ(r) is a non-negative deﬁnite function (i.e.
ρ(r) ≥0, at any point in the unit cell). In a practical diffraction experiment,
the summation is limited to the measured domain of the reciprocal space, rep-
resented by the shape function Φ(r∗) (Φ(r∗) = 1 inside the measured domain;
Φ(r∗) = 0 outside). Correspondingly, the electron density map available in
practice, say ρ′(r), is based on the structure factors,
F′
h = Fh(r∗),
rather than on the Fh’s. Therefore,
ρ′(r) = ρ(r) ⊗T[(r∗)] = ρ(r) ⊗ζ(r) =
N
j=1 ρj(r −rj) ⊗ζ(r),
(7.10)
where, ⊗represents the convolution operation. ζ(r) is the Fourier transform
of Φ(r∗) (which may be deduced from the experiment), and primarily depends
on RES; if Φ is a sphere, ζ(r) will have a spherical symmetry. In this case we
have,
ζ(r) = 4
3πr∗3
max y,
where
y = 3 sin(2πr∗
maxr) −(2πr∗
maxr) cos(2πr∗
maxr)
(2πr∗maxr)3
and r∗
max = RES−1.

Electron density maps
159
ζ(r) is an oscillating function, non-positive deﬁnite (see Fig. 7.6) and, con-
sequently, ρ′(r) is negative in more or less extended regions of the unit cell
(while, by deﬁnition, the density should be non-negative at all points of the
unit cell), the atomic peaks are broadened, and they are surrounded by a series
of negative and positive ripples of gradually decreasing amplitude. Since the
ripples may overlap with other ripples and with atomic peaks, the density
maxima may be misplaced with respect to the correct positions.
5
4
RES = 1 Å
RES = 2 Å
RES = 3 Å
3
2
1
0
1
2
3
4
5
r
r
–1
0.6
a)
b)
ζ(r)
ζ(r)
0.5
0.4
0.3
0.2
0.1
0
1
2
3
4
5
–0.1
0
0
Fig. 7.6
The Fourier transform ζ(r) of the spher-
ical reciprocal domain (r∗) as access-
ible for the experiment. Its form depends
primarily on the experimental resolution,
RES = 1/r∗
max = dmin. a) ζ(r) for RES =
1 Å; b) ζ(r) for RES = 2 Å and 3 Å. The
reader should notice how the amplitude
and the width of the main peak and of the
oscillations vary with RES.
In a one-dimensional case, (x∗) corresponds to a Heaviside unit step func-
tion, and ζ(x) =
sin(2hmax+1)πx
sin πx
, where hmax is the maximum index used in
the electron density calculation. The maximum value of ζ(x) is (2hmax + 1),
attained at the origin.
In Figs. 7.7 to 7.11, we depict what should be observed in one-dimensional
electron density maps (say ρ′(x)) for the corresponding different schematic
ρ(x) structures, as the effect of resolution bias. In particular we show that:
(i) the ripple intensities are proportional to the intensity of the main peak
(see Fig. 7.7);
(ii) the temperature factor modiﬁes both the main peak and the ripple proﬁles
(see Fig. 7.8);
(iii) for a one-point atom structure, when RES improves, the main peak
becomes sharper and its intensity increases; the ripple frequency increases
also (see Fig. 7.9);
(iv) for a one-dimensional two-point atom structure, the ripples corresponding
with the two main peaks interact with each other and also interact with
the main peaks, which may then move from their correct positions (see
Fig. 7.10);
(v) ripples can signiﬁcantly distort the main peak proﬁle (see Fig. 7.11).
It is a common belief that resolution bias is unavoidable; it is generally con-
sidered to be an intrinsic characteristic of electron density maps, generated by
the physics of the diffraction experiment. However, returning from ρ′(r) to ρ(r)
via deconvolution procedures offers several advantages: peaks should move
800
Br
C
ρ¢(x)
600
400
200
0
–200
–0.25
0
0.25
x
0.5
–0.5
Fig. 7.7
ρ′(x) of Br and C, at rest, when located at
the origin of the unit cell, at RES = 1.8 Å
(continuous line for Br, dashed line for
C). The ﬁgure shows that ripple intensit-
ies are proportional to the intensity of the
main peak.

160
Joint probability distribution functions when a model is available
120
100
80
60
40
20
0
B = 0
B = 15
ρ¢(x)
–20
–0.5
–0.25
0
0.25
0.5
Fig. 7.8
ρ′(x) at RES = 1.8 Å for a C atom loc-
ated at the origin of the unit cell, with
two different values of the temperature
factor B (continuous line, B = 0; dashed
line, B = 15). The ﬁgure shows how main
peak and ripple proﬁles are modiﬁed by
the temperature factor.
into more correct positions, false peaks due to limited experimental data res-
olution may be eliminated, peak broadening may be reduced. Some examples
will be useful:
(a) In traditional Patterson search methods (see Chapter 8), the ripples gener-
ated by the origin peak are often suppressed, just by calculating (|E|2 −1)
Patterson maps.
(b) Altomare et al. (2008a,b, 2010) described a general algorithm for cor-
recting resolution bias in E-maps, obtained by applying direct methods
to powder data (see Chapter 12 for details).
(c) Burla et al. (2006a) described an algorithm allowing elimination of bias
in a region around the heavy-atom peak in a protein electron density
map. The algorithm allowed an extension from 2268 (a value attained by
Mooers and Matthews, 2006) to around 6300 non-hydrogen atoms in the
asymmetric unit, as the complexity limit for proteins solvable ab initio
(provided that data resolution is better than 1.2 Å).
(d) An additional method to reduce the resolution bias (called free lunch) is
described in Section 8.2.
RES = 1.2 Å
RES = 2.2 Å
250
150
50
–50
–0.5
–0.25
0
0.25
0.5
ρ¢(x)
x
Fig. 7.9
A Dirac delta function, ρ(x) = 6δ(x) has
been located at the origin of the unit
cell (represented by a vertical bar). ρ′(x),
calculated by constant structure factors
(these are the Fourier transform of a point
atom) is shown at RES = 1.2 Å (continu-
ous line) and RES = 2.2 Å (dashed line).
In both cases we should observe, ρ′(x) =
6ζ(x), which is no longer a δ function.
When RES diminishes, the sharpness of
the main peak increases and the ripple
frequency increases.

Electron density maps
161
–0.5
–0.25
0
6ζ (x – x1)
6ζ (x – x2)
x
0.5
150
50
a)
–50
ρ¢(x)
0.25
6ζ (x – x1) + 6ζ (x – x2)
b)
–0.5
0
x
0.5
150
50
–50
ρ¢(x)
0.25
–0.25
Fig. 7.10
Two Dirac δ functions [6δ(x −x1) and 6δ(x −x2)] were located at x1 = 0.0, and x2 = 0.15, respectively; they are represented by two vertical
bars. a) 6ζ(x −x1) (continuous line) and 6ζ(x −x2) (dashed line) are reported at RES = 1.8 Å. b) ρ′(x) = c1ζ(x −x1) + c2ζ(x −x2) (black line)
at RES = 1.8 Å. As an effect of the ripple interaction, the two main maxima are now centred at x′
1 = 0.006 and x′
2 = 0.145.
–0.5
–0.25
0
0.25
12ζ (x – x1)
3ζ (x – x2)
x
0.5
300
200
100
0
a)
–100
ρ¢(x)
12ζ (x – x1) + 3ζ (x – x2)
b)
–0.5
0
x
0.5
300
200
100
0
–100
ρ¢(x)
0.25
–0.25
Fig. 7.11
Two-point atom structure: two δ functions, 12δ(x −x1) and 3δ(x −x2), were located at x1 = 0.0 and at x2 = 0.15. They are represented by vertical
bars in Fig. 7.11a. a) functions 12ζ(x −x1) (continuous line) and 3ζ(x −x2) (dashed line) at RES = 1.8 Å. b) ρ′(x) = 12ζ(x −x1) + 3ζ(x −x2)
(black line). The two main maxima of ρ′(x) are now centred at x′
1 = 0.0 and x′
2 = 0.125; a strong distortion of the second peak is clearly visible.
(5) The grid. Nowadays, Fourier syntheses are calculated by FFT (a Fast
Fourier Transform algorithm, ﬁrst described by Cooley and Tukey, 1965).
A very popular example has been the program written by Ten Eyck (1973);
only recently surpassed in performance by the code written by Frigo and
Johnson (2005).

162
Joint probability distribution functions when a model is available
In order to reveal the atomic positions, the unit cell is sampled upon a
three-dimensional grid. Peak search routines are then used to locate elec-
tron density maxima and to print these as a list in order of peak intensity
(this last operation is very frequent for small to medium-sized molecules,
less frequent for proteins due to lack of resolution). The location of the
maxima is achieved using interpolation techniques (usually 19 grid points
are used to centre each maximum). The spacing,  (in Å), of the grid
should be about the same for each of the unit cell axes; e.g. a unit cell with
a, b, c equal to 100, 50, 100, respectively, should be divided into 2n, n, 2n
grid points. If the grid is too coarse, atoms lying between the grid points
may show little effect on the surrounding grid points; then, the interpol-
ation necessary to ﬁnd the maximum electron density may be inaccurate.
If the grid is too ﬁne, computing time is wasted.
According to the Nyquist theorem, the optimal grid spacing should be
chosen as a function of RES; it should be at least equal to RES/2 to pre-
serve the information in the Fourier transform. In practice, spacings in the
range RES/2–RES/3 are frequently used. The reader should notice that, for
large structures, the number of grid points on which the electron density
map is calculated may be extremely large; e.g. for a protein with cubic unit
cell with a = 50 Å and  = 0.33 Å, the number of points on which the
Fourier map is sampled is about 3.37 x 106.
(6) Contour levels. To avoid the drawing of non-useful background features, a
threshold is frequently applied when graphical programs illustrate electron
density. A popular threshold is the standard deviation of the map,
σd = 1
n
n
j=1 [ρ(rj) −<ρ>]21/2
,
where n is the number of grid points on which the density is calculated and
<ρ> is the average value of the density. If we choose a k-sigma map we ask
the program to represent only the map features for which ρ(r) > kσd. For small
values of k (e.g. k < 1), background details are also illustrated; for large values
of k, only the strongest features of the map are revealed. As an example, we
show in Fig. 7.12a), b), and c), the electron densities in a region of the unit
cell of the protein 1kf3. The density was obtained by molecular replacement,
with an average phase error of 35◦; RES is equal to 1.05 Å. Figure 7.12a),
b), and c) correspond to k = 2, 4, and 5; they show that the continuity of the
electron density map progressively breaks down as k increases. At k = 5, only
a very small fraction of the molecule is included into the density. Conversely,
the reader can imagine that if k = 1 were chosen, densities without structural
meaning might also be present in the ﬁgure, which could lead to confusion.
a)
b)
c)
Fig. 7.12
1kf3: electron density corresponding to an
average phase error of 35◦(RES = 1.05
Å). a) by using the condition ρ(r) > 2σd;
b) by using the condition ρ(r) > 4σd; c)
by using the condition ρ(r) > 5σd,
The reader should not, however, forget that σd is only the standard deviation
of the function ‘map’; we will see in Section 7.4 that σd is not related to the
variance of the map, which has to be calculated using other mathematical tools.
7.3.2 The observed Fourier synthesis
The ideal Fourier synthesis (7.9) may be calculated only at the end of a suc-
cessful structure reﬁnement process, which usually follows the phasing step.

Electron density maps
163
During the phasing procedure, only a model structure is available, say ρp(r) ,
of which we know the calculated structure factor moduli (say |Fph|) and the
corresponding phases (say φph). So, how do we get information on ρ(r), given
the model density ρp(r)?
The classical recipe is to calculate the synthesis,
ρobs(r) = 1
V

h
|Fh| exp(iφph) exp(−2πih · r),
(7.11)
where (7.11) is called the observed Fourier synthesis; its coefﬁcients are the
observed structure factors of the target structure |Fh| (which depend on all the
atomic positions in the target, and therefore can provide information on these),
and its phases are the model phases (the best phases we have at that stage of the
phasing process). Because of the above properties, it may be expected that ρobs
may provide some additional information on the target atoms, not included into
the model structure (i.e. missed atoms). The maxima of ρobs should indicate the
positions of the atoms, including the missed atoms; heavy atoms should corres-
pond to the largest positive peaks and atoms affected by large thermal motion
are expected to show broad but less intense peaks. Luzzati (1953) showed that
peaks at the sites of missed atoms are at (about) only half the weight of the
known peaks.
Since model phases do not coincide with target phases, when the equival-
ence φ = φp is accepted, a systematic bias (model bias) is introduced in the
map. In general, the density (7.11) tends to conﬁrm the model from which
phases were calculated, even if the model is only partially correct. It is usual
to say that observed electron density maps are biased towards the model.
The theory developed in Section 7.2 allows us to design a better synthesis
by replacing exp(iφh) with its expected value. According to (7.6) and (7.8),
< exp(iφh)> = m exp(iφph);
then (7.11) may be replaced by the weighted observed Fourier synthesis,
ρobs(r) = 1
V

h
mh|Fh| exp(iφph) exp(−2πih · r).
(7.12)
A weighted synthesis (7.12) allows a better treatment of the model bias.
However, phase errors that are too large do not allow additional information on
the target structure to be recovered (e.g. the cyclic application of (7.12) does
not lead from random to correct phases), while a moderate average phase error,
suitably weighted, allows us to recover unknown atomic positions of the tar-
get. For a more practical insight into the use of (7.12), we show in Fig. 7.13a),
b), for the small structure GRA4, two observed electron densities, the ﬁrst cal-
culated using unweighted coefﬁcients (see equation (7.11)) and the second by
using weighted coefﬁcients (see equation (7.12)). GRA4 crystallizes in P¯1 with
two molecules in the asymmetric unit, equivalent by non-crystallographic sym-
metry. In Fig. 7.13 we show the electron density on the second molecule, given
prior knowledge on the atomic positions of the ﬁrst. The quality of the map
(7.12) is clearly higher than that of map (7.11).
a)
b)
Fig. 7.13
GRA4: electron density on molecule B
when the model consists of molecule A
(equivalent to B by non-crystallographic
symmetry and not shown in ﬁgure). a)
unweighted coefﬁcients are used (see
equation (7.11)); b) weighted coefﬁcients
are used (see equation (7.12)).
If the model is poor, it may be difﬁcult to recover the complete tar-
get structure via a single observed electron density map. Cyclic procedures

164
Joint probability distribution functions when a model is available
would be necessary; these are called EDM (electron density modiﬁcation), and
are described in Chapter 8. Reciprocal space approaches are also used (see
Section 6.3.6), but are today less popular.
7.3.3 The difference Fourier synthesis
Let us now consider the ideal difference map,
ρq(r) = ρ(r) −ρp(r).
(7.13)
By deﬁnition, ρq(r) is the density, which summed to ρp(r) gives ρ(r), no matter
the quality of ρp(r) . ρq(r) may show positive and negative peaks, according
to circumstances. In Fig. 7.1, we showed, schematically, a case in which the
atomic positions of the model coincide with the corresponding positions of the
target structure; no negative peak can be found in the ρq(r) map. In Fig. 7.2,
we showed a case in which the atomic positions of the model nearly coincide
with the corresponding positions of the target structure; ρq(r) shows positive
and negative peaks. In Fig. 7.14, we show the case in which model and tar-
get structures are uncorrelated; again, positive and negative peaks are present
in ρq(r).
ρ
ρp
ρq
Fig. 7.14
A schematic representation of ρ, ρp, and
ρq when the model is uncorrelated with
the target structure (then, D = 0).
a)
b)
(|F |–|Fp|)
|Fq|eiφq
(|F|–|Fp|)expiφp
Fq
Fp
F
φ
φq
φp
Fig. 7.15
a) A didactical case: F, Fp and Fq, with
|F| >|Fp| and φ remarkably different from
φp. Fq is the coefﬁcient to use for comput-
ing the ideal difference Fourier synthesis
(7.14); it is unknown in practice, because
φ is unknown. b) (|F| −|Fp|) exp(iφp)
is the coefﬁcient to use for computing
the synthesis (7.16). The two coefﬁcients
||Fq| exp(iφq)| and (|F| −|Fp|) exp(iφp)
do not ﬁt each other.
The ideal difference map may be calculated via the synthesis (7.14):
ρq(r) = 1
V

h
|Fqh| exp(iφqh) exp(−2πih · r),
(7.14)
where (see Fig. 7.15),
|Fqh| exp(iφqh) = {|Fh| exp(iφh)−|Fph| exp(iφph)

(7.15)
In vectorial notation, equation (7.15) is equivalent to
Fqh = Fh −Fph.
However, if the phases of the target structure are unknown, as is usual during
the phasing process, synthesis (7.15) cannot be calculated. If only a model
structure is available, as is usual during the phasing process, how do we
approximate ρq(r)? The canonical recipe is to replace φh by its best estimate
φph, and then calculate the difference synthesis,
ρ(r) = 1
V

h

[|Fh| −|Fph|] exp(iφph)

exp(−2πih · r).
(7.16)
One can deduce from Fig. 7.15 how bad this approximation may be when φh
and φph are far from each other. The approximation is much better if φh and φph
are close (see Fig. 7.16). If this condition is satisﬁed for most of the reﬂections,
then ρ(r) will be a good approximation to ρq(r); this occurs when model and
target structure are well correlated. The ﬁrst conclusion is:
the difference synthesis (7.16) is a good approximation of the ideal differ-
ence synthesis if the quality of the model is sufﬁciently high.

Electron density maps
165
Let us now study synthesis (7.16) in more detail. ρ(r) coefﬁcients may be
positive or negative, according to whether |Fh| is larger or smaller than |Fph|.
It may be noticed that equation (7.16) is equivalent to (7.17):
ρ(r) = 1
V

h

||F h| −|Fph|| exp i(φph + sπ)

exp(−2πih · r),
(7.17)
where we set s = 0 if |Fh| > |Fph|, s = 1 if |Fh| < |Fph|. In equation (7.17),
the Fourier coefﬁcients are always positive, but their phases are φph or φph + π,
according to whether |Fh| is larger or smaller than |Fph|.
As with the observed Fourier synthesis, the difference synthesis (7.16) is
also affected by model bias; indeed, the phases used on the right-hand side of
(7.17) are φp or φp + π, according to circumstances. However, the occurrence
of phases φp + π, in opposition with the model phases φp, weakens the model
bias.
The theory developed in Section 7.2 suggests a more efﬁcient difference
synthesis (Read, 1986):
ρ(r) = 1
V

h

|mFh| −D|Fph|

exp i(φph)

exp(−2πih · r).
(7.18)
With respect to (7.17), two modiﬁcations have been introduced: exp(iφh) has
been replaced by its expected value,
< exp(iφh)> = m exp(iφph),
and the parameter D has been associated with |Fph|, in order to take into
account the misﬁt between the atomic positions of the current model and the
corresponding positions in the target structure (D = 1 if the atomic positions of
the model perfectly coincide with corresponding atomic positions of the target
structure). In terms of normalized structure factors, (7.18) becomes
ρ(r) = 1
V

h

|mEh| −σA|Eph|

exp i(φph)

exp(−2πih · r).
(7.19)
So, which type of information provides a difference Fourier synthesis? Positive
peaks should correspond to target atoms not included into the model, negative
peaks to model atoms wrongly positioned. The quality of the map, however,
depends, critically, on the quality of the model; a good map ρ(r) may be
obtained only if the model is sufﬁciently good. In Fig. 7.17a), b), we show
for BCDIMP [C55 H76 N4 O37, space group P21, RES = 0.82 Å] two differ-
ence syntheses, obtained for average phase errors <|φ|>, equal to 65◦and
22◦, respectively. The relative inefﬁciency of the ﬁrst map is evident: several
positive peaks are present where there is no missed atom present.
a)
b)
(|F |–|Fp|)
|Fq |exp( iφq )
(|F |–|Fp|)expiφp
Fq
Fp
F
φ
φq
φp
Fig. 7.16
a) A didactical case: F, Fp, and Fq
with |F|>|Fp| and φ close to φp. Fq is
the coefﬁcient to use for computing the
ideal difference Fourier synthesis (7.14):
it is unknown in practice, because φ
is unknown. b) (|F| −|Fp|) exp(iφp) is
the coefﬁcient to use for computing the
synthesis (7.16). The two coefﬁcients,
|Fq| exp(iφq) and (|F| −|Fp|) exp(iφp), ﬁt
each other sufﬁciently well.
Nowadays, there is a new type of difference electron density available,
which requires a probabilistic background different from that described in
Section 7.2. This synthesis is the basis of the phasing algorithm VLD (vive
la difference) and will be described in the Section 9.3.

166
Joint probability distribution functions when a model is available
7.3.4 Hybrid Fourier syntheses
Let us consider, for any pair of rational numbers τ and ω, the following
combination of Fourier syntheses:
ρQ(r) = τρ(r) −ωρp(r)
= 1
V

h
[τ|Fh| exp(iφh) −ω|Fph| exp(iφph)] exp(−2πih · r).
(7.20)
ρQ is the ideal hybrid synthesis, i.e. the density which, by deﬁnition, summed
to ωρp, gives τρ, no matter the quality of ρp. It may be decomposed in different
ways in a pair of components maps. For example, as schematized in equation
(7.20), the ﬁrst component may be τρ and the second component may be ωρp,
but the decomposition may also be made according to the following rule:
ρQ = (τ −ω)ρ + ω(ρ −ρp) = ωρq + (τ −ω)ρ,
if τ > ω,
(7.21a)
ρQ = (τ −ω)ρp + τ(ρ −ρp) = τρq −(ω −τ)ρp,
if τ < ω.
(7.21b)
The equations (7.21) suggest that ρQ is a linear combination of the three com-
ponents ρ, ρp, and ρq; in particular, ρq may have a pre-eminent role when
ω > τ. A schematic example is shown in Fig. 7.18; while the ideal 2ρ −ρp
has strong positive peaks at the target atomic positions not belonging to the
model, the ideal ρ −2ρp has strong negative peaks at wrongly positioned
model atomic positions.
ρQ cannot be computed if the phases of the target structure are unknown, but
if a model structure is available, it may be approximated by the hybrid Fourier
synthesis,
ρτω(r) = 1
V

h
[τ|Fh| −ω|Fph|] exp(iφph) exp(−2πih · r).
(7.22)
Equation (7.22) is equivalent to
ρ(r) = 1
V

h

||τFh|−ω|Fph|| exp i(φph + sπ)

exp(−2πih · r)
(7.23)
where we set s = 0 if τ|Fh| > ω|Fph|, s = 1 if τ|Fh| < ω|Fph|. In equa-
tion (7.23), the Fourier coefﬁcients are always positive, but their phases are
φph or φph + π, according to whether τ|Fh| is larger or smaller than ω|Fph|.
As for the other Fourier syntheses, hybrid syntheses also suffer through model
bias because the phases may only assume values φph or φph + π. This bias is
however different from that present in the observed syntheses, because of the
occurrence of phase values φph + π in opposition to the model phases φph.
a)
b)
Fig. 7.17
BCDIMP. The model structure is rep-
resented by sticks and balls, the missed
atoms in simple plotting style. The differ-
ence electron density, shown for ρ(r) >
3σd,
is
calculated
when
<|φ|> =
65◦1; The difference electron density,
shown for ρ(r) > 3σd, is calculated when
<|φ|> = 22◦.
ρ
ρp
ρq
2ρ  – ρp
ρ   – 2ρp
Fig. 7.18
A schematic example showing ρ, ρp, ρq
(ﬁrst three lines), ρQ when τ = 2 and
ω = 1 (line 4), and ρQ when τ = 1 and
ω = 2 (line 5).
We observe that:
1. for τ = 1 and ω = 0, ρQ = ρ, as given by (7.9), and ρ10 = ρobs, as given
by (7.11);
2. for τ = 1 and ω = 1, ρQ = ρq, as given by (7.14), and ρ11 = ρ, as given
by (7.18);
3. for τ = 2 and ω = 1, ρQ = ρ + (ρ −ρp), and ρ21 = ρobs + ρ. Thus, ρ21
should show combined features of an observed and of a difference electron
density. This interesting property is widely used in EDM approaches (see
Chapter 8);

Electron density maps
167
4. for τ = 1 and ω = 2, ρQ = −ρp + (ρ −ρp), and ρ12 = −ρp + ρ. This
hybrid synthesis shows features belonging to a difference map plus density
in opposition to the model.
We will see in Chapter 9 that hybrid syntheses may be conveniently used in the
phasing process when the VLD algorithm is applied.
As for observed and difference syntheses, probabilistic criteria may be used
to optimize the efﬁciency of hybrid syntheses. The coefﬁcient suggested by
Read (2001) in terms of normalized structure factors is
(τmR −ωσARp) exp(iφp),
according to which,
ρτω(r) = 1
V

h
[(τm|F| −ωD|Fp|] exp(iφph) exp(−2πih · r)
(7.24)
Finally, it may be useful to notice that:
(i) ρkτ,kω(r) ≡ρτ,ω(r). Accordingly, the properties of hybrid syntheses are
ﬁxed by the ratio τ/ω, rather than by the values of τ and ω; therefore, the
most interesting hybrid syntheses are those of low order (i.e. deﬁned by
small values of τ and ω).
(ii) While in an observed Fourier synthesis always φh ≈φph, in a hybrid
Fourier synthesis there is always a subset of reﬂections for which it has
been assumed that φQ = φp + π (see Table 7.1). Therefore, hybrid and
observed Fourier syntheses should never be confused.
(iii) With increasing values of the ratio τ/ω, hybrid Fourier syntheses become
more and more similar to the observed synthesis; indeed, the percentage
of reﬂections for which φh ≈φph + π diminishes with the ratio τ/ω (see
Table 7.1). If the model is badly correlated with the target, ρτω will also
be badly correlated with ρQ.
(iv) For a hybrid Fourier synthesis with τ < ω, the number of reﬂections for
which φh ≈φph + π is larger than for a hybrid Fourier synthesis with
τ > ω (indeed, the number of reﬂections for which |F| <
ω
τmD|Fp| or
|F| < ω
τ D|Fp| is larger, see Table 7.1). As a consequence, a hybrid density
map calculated with τ < ω will differ from an observed synthesis more
than a map with τ > ω.
Table 7.1
The assigned phase value (say φ) for each type of hybrid Fourier synthesis
Type
φ
m|F| exp(iφp)
φ = φp always
(m|F| −D|Fp|) exp(iφp)
φ = φp + π if |F| < D|Fp|/m,
otherwise φ = φp
(2m|F| −D|Fp|) exp(iφp)
φ = φp + π if |F| < D|Fp|/(2m),
otherwise φ = φp
(τm|F| −ωD|Fp|) exp(iφp)
φ = φp + π if |F| <
ω
τmD|Fp|,
otherwise φ = φp

168
Joint probability distribution functions when a model is available
There is a new type of hybrid Fourier synthesis available today, which
requires a probabilistic background different from that described in Section
7.2. We will consider this new synthesis and its applications in Section 9.3.
7.4
Variance and covariance for electron
density maps
The density values at the grid points of an electron density map do not conﬁrm
conﬁdence in the quality of the map; in other words, simple inspection of the
map does not indicate whether the peak distribution ﬁts the target structure.
Indeed, a trivial change in scale or weight of the structure factors may increase
or decrease the density values, without improving the map. As speciﬁed in
point 6 of Section 7.3.1, it is usual, particularly in protein crystallography, to
calculate the standard deviation σd of the pixel intensity distribution; it is tacitly
assumed that pixels with ρ(r) > nσd, and n sufﬁciently large, provide the most
reliable information on atomic positions in the unit cell. The σd criterion, how-
ever, is unable to provide absolute conﬁdence in the map; i.e. choosing peaks
with ρ(r) > 5σd does not necessarily imply that such peaks coincide with the
target atomic positions, if the model map is uncorrelated or poorly correlated
with the target map. Therefore, the search for an absolute indicator has to be
made among other tools.
The expected variance of an electron density map was ﬁrst estimated by
Cruickshank (1949) as
σ 2(ρ) = 1
V2

h σ 2(|Fh|),
(7.25)
where σ 2(|Fh|) is the variance of the observed amplitude. Equation (7.25)
provides a global error, constant for any point on the map, depending only on
the measurement error, and completely disregarding phase error. More inter-
esting results were obtained by Coppens and Hamilton (1968), who obtained a
variance expression, variable according to the point on the map:
σ 2 {ρ(r)} = 4
V2

h>0 σ 2(|Fh|) cos2(2πh · r −φh).
(7.26)
Both equations (7.25) and (7.26) uniquely depend on measurement error. The
reason for this is as follows. The authors were mainly interested in maps
obtained in the ﬁnal stages of crystal structure reﬁnement (when the phases
are considered to be perfectly determined, and therefore ﬁxed), in order to
assess the reliability of the conclusive structural parameters. During the phas-
ing process, it is much more interesting to calculate the variance at a point
in the map when the phases are uncertain; in other words, when a model,
well or badly correlated with the target function, is available. Giacovazzo and
Mazzone (2011) and Giacovazzo et al. (2011) calculated, for any space group,
the variance of any point in an electron density map (observed, difference, or
hybrid) by assuming that each phase φh is distributed around φph according to
the von Mises distribution (7.6). This assumption may be applied over quite a

Variance and covariance for electron density maps
169
wide range, from the case in which the model is uncorrelated with the structure
(which is equivalent to assuming X ≈0 for most reﬂections), to the limit case
in which the model coincides with the structure (X quite large for almost all of
the reﬂections).
Because of the orthogonality between phase uncertainty (depending on the
model) and measurement error (depending on the experiment), unique expres-
sions of the variance, taking into account both phase and measurement errors,
have been derived for any space group. The ﬁnal expressions of the variance
are shown in Appendix 7.C.
Giacovazzo and Mazzone (2012) showed how the FFT algorithm may be
used for calculation of the variance and demonstrated that the ratio
ρ(r)/σρ(r),
(7.27)
where σρ(r) = [varρ(r)]1/2, is an absolute ﬁgure for estimating the conﬁdence
one should have in the density at a given point r on the map. This may be
considered to be a ‘signal to noise’ ratio; when it is large at a point, the cor-
responding density may be considered a real feature of the target structure.
In Fig. 7.19, for BCDIMP, the distribution of the ratio (7.27) is shown for
two different model structures: for the ﬁrst model, <|φ|> = 75◦, for the
second, <|φ|> = 22◦. The curves suggest that, when the better model is
used, (7.27) attains large values for larger percentages of map pixels (indeed,
the corresponding map is more reliable).
Let us now deal with the covariance between two points on an electron dens-
ity map. The crystal structure solution process usually ends with a set of atomic
parameters, published together with the corresponding standard deviations,
which ﬁx the accuracy of the structural results. Least squares are considered
to be a fundamental tool in crystallography, just because they provide optimal
values of the structural parameters, of their variances, and of their covariances;
least squares are usually inefﬁcient if covariance between parameters is high.
Covariance between two points on an electron density map is a signal to
investigate whether the electron density at one point of the map is ampliﬁed or
depressed as an effect of the electron density at another point on the map. For
example, pseudotranslational symmetry is a frequent source of covariance; if
the pseudotranslational vector is equal to u = (a + b)/2, we should observe a
100
BCDIMPK
10
1
0.1
0.01
PERC
0.001
0.0001
–3
–1
1
3
5
ρ(r)/σp(r)
7
9
11
75˚
23˚
Fig. 7.19
BCDIMP: pixel percentage (PERC) with
a given ρ(r)/σρ(r) value for two different
average phase errors, <|φ|>.

170
Joint probability distribution functions when a model is available
particularly strong correlation between any point r on the electron density map
and the position r + u, if only (or most) reﬂections with h + l = even are used
to compute the map.
An unavoidable covariance effect concerns peaks and their associated
ripples (see point 4 of Section 7.3.1); indeed, the larger the peak, the larger
will be the ripples. Mathematical formulas for calculating covariances between
peak densities at any step of the phasing process have recently been described
by Altomare et al. (2012) and are detailed in Appendix 7.B. In some way, cov-
ariances in the map are the counterpart in real space of least squares covariance
calculations; large covariances should indicate undesired features in the map.
A ﬁgure normalized to the interval (0, 1) is the correlation coefﬁcient
between the densities in two points on the map:
C(rA, rB) =
cov(rA, rB)
var1/2[ρ(rA)]var1/2[ρ(rB)].
7.5
Triplet phase estimate when a model
is available
In Section 7.2 we derived the distribution P(E, Ep) for when a model structure
is available. Here, we will derive a more complicated distribution, say
P(Eh, Ek, Eh+k, Eph, Epk, Ep,−h−k),
in order to estimate the triplet invariant reliability when a model is available.
In accordance with Burla et al. (2012b), we will suppose that a model
structure is available, and that:
(i) rpj, j = 1, . . . , Np are the model atomic positions. They are considered to
be primitive random variables;
(ii) rj = rpj + rj, j = 1, . . . , Np are the corresponding atomic positions in
the target structure. They are considered to be random variables riding
over the corresponding rpj;
(iii) The rest of the target atomic positions, say rj, j = Np + 1, . . . , N, are
primitive random variables.
Then,
E =
Np
j=1 fj exp[2πh · (rpj + rj)] +
N
j=Np+1 fj exp(2πh · rj)
+ |μ| cos ϑ)
 
(εN)1/2,
Ep =
Np
j=1 fj exp(2πh · rpj)
	
εp
1/2,
where |μ| exp(iϑ) takes into account measurement errors.
To simplify the resulting formulas, we will use the following notation:
Ei = Eh, Ek, E−h−k, respectively, for i = 1, . . . , 3,
Epi = Eph, Epk, Ep,−h−k, respectively, for i = 1, . . . , 3;
Ri = |Ei|, Rpi = |Epi|, i = 1, . . . 3.

Triplet phase estimate when a model is available
171
The required joint probability distribution is
P(Ri, Rpi, φi, φpi, i = 1, . . . , 3) =
3

i=1

RiRpi
(ei −σ 2
Ai)

exp

−
3
i=1\
1
(ei −σ 2
Ai)

R2
i + eiR2
pi −2σAiRiRpi cos(φi −φpi)

exp

2
Np,eq
Rp1Rp2Rp3 cos(φp1 + φp2 + φp3)
+ 2β[R1R2R3 cos(φ1 + φ2 + φ3) −σA3R1R2Rp3 cos(φ1 + φ2 + φp3)
−σA2R1Rp2R3 cos(φ1 + φp2 + φ3) −σA1Rp1R2R3 cos(φp1 + φ2 + φ3)
+ σA2σA3R1Rp2Rp3 cos(φ1 + φp2 + φp3)
+ σA1σA3Rp1R2Rp3 cos(φp1 + φ2 + φp3)
+ σA1σA2Rp1Rp2R3 cos(φp1 + φp2 + φ3)
−σA1σA2σA3Rp1Rp2Rp3 cos(φp1 + φp2 + φp3)]

,
(7.28)
where
β =
1
(e1 −σ 2
A1)(e2 −σ 2
A2)(e3 −σ 2
A3)
1
Nq,eq
and
1
Nq,eq
=

1
Neq
−
1
Np,eq
σA1σA2σA3

.
Nq,eq may be considered to be the equivalent number of atoms in the difference
structure.
Equation (7.28) may be usefully compared with equation (5.3); while this
only exploits the triplet  = (φ1 + φ2 + φ3), equation (7.28) is able to obtain
information from the eight triplets belonging to the ﬁrst representation of the
invariant (see Section 4.4).
From equation (7.28), standard mathematical techniques lead to the condi-
tional distribution,
P(|R1, R2, R3, Rp1, Rp2, Rp3) ≈[2πI0(G)]−1 exp[G cos ]
(7.29)
where
G =
2
Np,eq
m1m2m3Rp1Rp2Rp3
+ 2β

(R1 −σA1m1Rp1)(R2 −σA2m2Rp2)(R3 −σA3m3Rp3)

.
(7.30)
Equations (7.29) and (7.30) suggest the following conclusion: if a model is
available which is (weakly or strongly) correlated with the target structure, the
triplet phase  is no longer expected to always be distributed around zero, as
suggested by the Cochran formula. The percentage of triplet phases close to π
depends on the correlation between target and model structure.
To better understand equations (7.29) and (7.30), we simplify them by
assuming ei = 1 for i = 1, . . . , 3; this is a reasonable assumption when the
diffraction amplitudes are sufﬁciently large. We will consider two extreme
cases.

172
Joint probability distribution functions when a model is available
1. Target and model structures are completely uncorrelated. In this case,
Di = 0 for i = 1,2,3,
σAi ≈mi ≈0, for i = 1, . . . ,3, β =
1
√
Neq , and G =
2
√
Neq R1R2R3.
In simple terms, and in accordance with expectations, an uncorrelated
model does not provide any supplementary information to that contained
in the Cochran formula.
2. Target and model structures are well correlated; i.e. the Np atomic pos-
itions of the model perfectly coincide with the corresponding atomic
positions in the target structure and the scattering power of the model
structure is non negligible with respect to that of the target. Then, for most
of the reﬂections (i.e. those with largest intensity), Di = mi ∼1 for i =
1,2,3. In this case, the number of atoms in the difference structure is prop-
erly deﬁned by Nq = N – Np. Furthermore, the scattering power, 
q,
of the difference structure reduces to 
qi = 
Ni −
pi, for i = 1, . . . ,3.
Under these conditions, we obtain
σAi =

pi /

Ni
1/2
,
β =
1
Nq,eq

N1

N2

N3

q1

q2

q3
1/2
and
G =
2
Np,eq
Rp1Rp2Rp3 +
2
Nq,eq

(|F1| −|Fp1|)(|F2| −|Fp2|)(|F3| −|Fp3|)
(
q1

q2

q3 )1/2

.
(7.31)
Equation (7.31) suggests that the second terms on the right-hand side may be
dominant with respect to the ﬁrst term. Thus, triplet phase estimates should
not be based on the Cochran formula, but may beneﬁt from the supplementary
information provided by the current model, even if it is weakly correlated with
the target. Expression (7.30) is therefore the general relation to use; it requires
prior knowledge of the σAi parameters, which in turn may be estimated by
standard statistical methods (see Appendix 7.A).
From distribution (7.28), the conditional distribution
P

φ1|R1, R2, R3, Rp1, Rp2, Rp3, φ2, φ3, φp1, φp2, φp3

may be obtained by standard techniques. We obtain,
P(φ1| . . . . . .) = [2πI0(G1)]−1 exp(G1 cos φ1 −ξ1)
(7.32)
where G2
1 = a2
1 + a2
2,
a1 = 2R1

σA1
e1 −σ 2
A1
Rp1 cos φp1 + β[R2R3 cos(φ2 + φ3)
−σA3R2Rp3 cos(φ2 + φp3) −σA2Rp2R3 cos(φp2 + φ3)
+ σA2σA3Rp2Rp3 cos(φp2 + φp3)]


Estimation of σA
173
a2 = 2R1

σA1
e1 −σ 2
A1
Rp1 sin φp1 + β[−R2R3 sin(φ2 + φ3)
+ σA3R2Rp3 sin(φ2 + φp3) + σA2Rp2R3 sin(φp2 + φ3)
−σA2σA3Rp2Rp3 sin(φp2 + φp3)]

,
tan ξ1 = a2/a1.
If
model
and
target
structures
are
strongly
correlated,
distribution
(7.32) reduces to that found by Giacovazzo (1983a) and applied by Burla et al.
(1989b). If model and target structure are uncorrelated (i.e. σAi ≈mi ≈0, for
i = 1, . . . ,3), then
β =
1
Neq
,
a1 =
2
Neq
R1R2R3 cos(φ2 + φ3),
a2 = −
2
Neq
R1R2R3 sin(φ2 + φ3),
in agreement with the Cochran formula. The expressions for a1 and a2 are
much more useful if correlation between target and model structures is not
vanishing.
APPENDIX 7.A
ESTIMATION OF σA
The parameter D as given by equation (7.5) is resolution dependent; con-
sequently, σA is also resolution dependent. Luzzati (1952), Lunin and
Urzhumtsev (1984), and Read (1986) contributed to clariﬁcation of the role
of this parameter in the phasing process and to the design of an algorithm for
its estimation. Caliandro et al. (2005c) showed that σA, in an acentric space
group, may be estimated from the average
<R2R2
p> =
 ∞
0
 ∞
0
R2R2
pP(R, Rp)dRdRp =

e + σ 2
A

,
from which,
σ 2
A = <R2R2
p> −e
(7.A.1)
Giacovazzo et al. (2011) stated that any moment, <RsRt
p>, may be used for
estimating σA, with s and t being any pair of integer numbers; for example, in
acentric space groups, by choosing s = t = 1,
<RRp> = π
4
√e

1 +
 4
π −1
 σ 2
A
e

is derived. Different formulas are obtained if the space group is centric, where,
for example,
<R2R2
p> = e + 2σ 2
A,
from which,
σ 2
A = 1
2

<R2R2
p> −e

.
(7.A.2)

174
Joint probability distribution functions when a model is available
The parameter σA has quite interesting statistical properties. Let us consider
equation (7.A.1) under the assumption (valid in most cases of interest) that e is
very close to unity and that the observed and calculated diffraction amplitudes
satisfy Wilson distributions. Then,
(i) if σA = 1, model and target structures coincide, and <R2R2
p> =
<R4> = 2, the value expected by Wilson statistics for acentric crystals;
(ii) if σA = 0, then P (E) and P

Ep

are uncorrelated, and <R2R2
p> =
<R2><R2
p> = 1.
The same properties hold when the structure is centric and equation (7.A.2) is
taken into consideration. Then, one has only to remember that, when σA = 1,
<R2R2
p> = <R4> = 3.
The following conclusion arises: σA is a useful statistical indicator for estim-
ating how much the current model is correlated with the target structure. Its
values may be estimated statistically in a very simple way (routines are in the
most popular packages, such as CCP4, PHENIX, SIR2011); measured reﬂec-
tions are partitioned in resolution shells, and for each shell, the joint moments,
<RsRt
p>, are calculated. Very frequently the locally normalized quantities
<|FFp|2>
<|F|2><|Fp|2> or
<R2R2
p>
<R2><R2
p>
(7.A.3)
are taken into account, instead of the simple moments, <|FFp|2> or <R2R2
p>.
Very recently (Carrozzini et al., 2013b), a more satisfactory statistical inter-
pretation of σ 2
A has been suggested. σ 2
A is nothing else but the correlation factor
C between the R2 and the R2
p sets:
σ 2
A = C(R2, R2
p) =
<R2R2
p> −<R2><R2
p>

<R4> −<R2>21/2 
<R4p> −<R2p>21/2
(7.A.4)
Indeed:
(a) in accordance with its original deﬁnition in direct space, σ 2
A always lies in
the interval (0,1).
(b) equation (7.A.4) does not change with the centric or acentric nature of
the crystal, and reduces to the equations (7.A.1) or (7.A.2) if the structure
factor amplitudes satisfy the Wilson distribution.
(c) rescaling of the observed and/or the calculated amplitudes shell by shell,
as described by equation (7.A.3), is no longer necessary because the
correlation coefﬁcient is scale independent.
APPENDIX 7.B
VARIANCE AND COVARIANCE
EXPRESSIONS FOR ELECTRON
DENSIT Y MAPS
The variance expression obtained by Giacovazzo et al. (2011) may be divided
into three components:

Variance and covariance expressions for electron density maps
175
(i) a term (say TH1) which does not vary from point to point, but depends on
the global misﬁt between model and target structures. It ﬁxes the average
variance of the map.
(ii) a second component (say TH2), varying from point to point, strictly
connected with the implication transformations (a quite basic tool for
Patterson deconvolution: see Chapter 10). In some way, TH2 ‘knows’ the
theory of the implication transformation.
(iii) A third term (say TD), varying from point to point, depending on the
model phases and on the observed amplitudes. Its main task is to ﬁx, via
weights depending on the misﬁt between model and target structures, the
variance at points related to the model structure.
The ﬁnal expression is
var ρ(r) = TH1 + TH2(r) + TD(r),
where
TH1 = 2
V2

h>0(1 −m2
h)[|Fh|2 + σ 2(|Fh|)]
TH2(r) = 2
V2

h,ind[|Fh|2(1 −m2
h) + σ 2(|Fh|)]
n
s̸=q=1 cos { 2πh[(Cs −Cq)r] }
TD(r) = −2
V2

h,ind

[|Fh|2[m2
h −D2(Xh)] −σ 2(|Fh|)]
n
s,q=1 cos[2φp(h) −2πh(Cs + Cq)r]

.
Cs, s = 1, . . . , n are the symmetry operators of the space group; the sub-
script ind in the symbol of summation indicates that h varies over the set of
symmetry-independent reﬂections.
For centric space groups, the corresponding expression is
varρ(r) = 1
V2

h,ind[|Fh|2(1−m2
ch) + σ 2(|Fh|)]
n
s,q=1 cos[2πh(Cs−Cq)r].
Giacovazzo and Mazzone (2012) described an algorithm for calculation of the
variance via FFT.
We list here, the covariance expression between the two points rA and rB :
<ρ(rA)ρ(rB)> = Tobs + T1a + T2a,
where
Tobs(rA, rB) = ρobs(rA)ρobs(rB),
T1a(rA, rB) = 2V−2 
h,ind |Fh|2(1 −m2
h)
n
s,q=1 cos[2πh(CsrA −CqrB)],
T2a(rA, rB) = −2V−2 
h,ind |Fh|2[m2
h −D2(Xh)]
n
s,q=1 cos[2φp(h) −2πh(CsrA + CqrB)].

176
Joint probability distribution functions when a model is available
APPENDIX 7.C
SOME MARGINAL AND
CONDITIONAL PROBABILITIES
OF P(R, Rp, φ, φp)
By integrating (7.3) over φ and φp, the following marginal distribution is
derived:
P(R, Rp) =
4RRp

e −σ 2
A
exp

−
1

e −σ 2
A
 
R2 + eR2
p

 
I0 [X] ,
(7.C.1)
where I0 is the modiﬁed Bessel function of order zero and X is deﬁned by
equation (7.7). From (7.C.1), the conditional distributions,
P(R|Rp) =
2R

e −σ 2
A
 exp

−

R2 + σ 2
AR2
p


e −σ 2
A

 
I0 [X] ,
(7.C.2)
and
P(Rp|R) =
2eRp

e −σ 2
A
exp

−

e2R2
p + σ 2
AR2
e

e −σ 2
A

 
I0 [X]
(7.C.3)
may be derived. Distribution (7.C.2) is useful when one wants to estimate R
given Rp and distribution (7.C.3) may help when one wants to estimate Rp
given R.

Phase improvement
and extension
8
8.1
Introduction
The descriptions of the various types of Fourier synthesis (observed, differ-
ence, hybrid) and of their properties, given in Chapter 7, suggest that electron
density maps are not only a tool for depicting the distribution of the elec-
trons in the target structure, but also a source of information which may be
continuously exploited during the phasing process, no matter whether ab ini-
tio or non-ab initio methods were used for deriving the initial model. Here,
we will describe two important techniques based on the properties of electron
density maps.
(i) The recursive approach for phase extension and reﬁnement called
EDM (electron density modiﬁcation). Such techniques have dramatically
improved the efﬁciency of phasing procedures, which usually end with a
limited percentage of phased reﬂections and non-negligible phase errors.
EDM techniques allow us to extend phase assignment and to improve
phase quality. The author is ﬁrmly convinced that practical solution of the
phase problem for structures with Nasym up to 200 atoms in the asymmetric
unit may be jointly ascribed to direct methods and to EDM techniques.
(ii) The AMB (automated model building) procedures; these may be con-
sidered to be partly EDM techniques and they are used for automatic
building of molecular models from electron density maps. Essentially,
we will refer to proteins; the procedures used for small to medium-sized
molecules have already been described in Section 6.3.5.
Two new ab initio phasing approaches, charge ﬂipping and VLD, essentially
based on the properties of the Fourier transform, belong to the EDM cat-
egory, and since they require a special treatment, they will be described later
in Chapter 9.
8.2
Phase extension and reﬁnement via direct
space procedures: EDM techniques
Phase extension and reﬁnement may be performed in reciprocal and in direct
space. We described the former in Section 6.3.6; here, we are just interested

178
Phase improvement and extension
in direct space procedures, the so-called EDM (electron density modiﬁcation)
techniques. Such procedures are based on the following hypothesis: a poor
electron density map, ρ, may be modiﬁed by a suitable function, f, to obtain a
new map, say ρmod, which better approximates the true map:
ρmod (r) = f [ρ(r)].
(8.1)
If function f is chosen properly, more accurate phases can be obtained by
Fourier inversion of ρmod, which may in turn be used to calculate a new elec-
tron density map. This map may be submitted to the function f , and so on,
cyclically. Such a procedure should allow a model map to converge to the
target structure, provided that f is chosen in a suitable way.
The reader should have noticed the ﬁrst important EDM feature: modiﬁed
electron density maps are Fourier inverted, a molecular model is not needed.
Accordingly, the method may also work even if RES is far from the atomic
resolution.
This approach was ﬁrst proposed by Hoppe and Gassmann (1968) (see also
Hoppe et al., 1970; Gassmann and Zechmeister, 1972; Gassmann, 1975, 1976,
1977; Simonov, 1976) who suggested the function,
ρmod (r) = f[ρ(r)] = aρ(r) + bρ2(r) + cρ3(r),
(8.2)
where the parameters a, b, and c are chosen to sharpen strong peaks and
weaken the smallest ones. The modiﬁcation (8.2) is no longer in use today;
more complicated, and often non-analytical, functions are necessary to face
modern challenges.
In order to identify a better approach, we should answer the following ques-
tion: what do we really want to obtain when we apply (8.1)? The practical
answer should be: we want to introduce a virtuous distortion of the current
electron density which, after Fourier inversion, should lead to improved phase
values. To obtain such a result we should introduce into ρ some features
which we know are present in high quality electron density maps; when bet-
ter features are introduced, more information may be exploited. Below in this
section, we will list and discuss the ‘good features’ exploited by modern EDM
techniques.
Here, we address the reader’s attention to another important capability of
EDM procedures: phase extension. Let us suppose that only a subset of struc-
ture factors has been phased by some phasing procedure (e.g. if direct methods
are used, only the reﬂections with the largest R values are phased; if molecular
replacement has been employed, only structure factors up to a given resolution
limit are usually phased; etc.) and that ρobs is the corresponding observed elec-
tron density map (e.g. calculated via equation (7.12)). If ρobs is Fourier inverted
(without any modiﬁcation), the structure factors Finv are obtained, where
|Fh|inv = |Fh|, φhinv = φh if h was used for the calculation of ρobs;
(8.3a)
|Fh|inv ≡0, if h was not used for the calculation of ρobs.
(8.3b)
In relation (8.3a), |Fh| is the observed amplitude of the target structure and
φh is the phase value used for computing the observed Fourier synthesis. The
results (8.3) arise from intrinsic properties of Fourier transforms.

Phase extension and reﬁnement via direct space procedures
179
However, if ρobs is modiﬁed before being Fourier inverted, (8.3a) and (8.3b)
are no longer valid. In this case, phases may be assigned to higher resolution
observed reﬂections, in the molecular replacement case, or associated with
small Rs in the case of direct methods. The additional phases gained via the
phase extension process provide supplementary information used to improve
subsequent electron density maps.
A typical ﬂow diagram for a modern EDM procedure is shown in Fig. 8.1.
{|F|} are the observed amplitudes of the target structure and {φ} the best phase
values available at a given step of the phasing process; ρ(r) is the correspond-
ing electron density map. ρmod is the modiﬁed (according to 8.1) density map,
whose Fourier inversion provides the set {|Fmod |, φmod} . In turn, set {φmod} is
combined with set {φ} to yield set {φcomb} , which is combined with set {|F|} for
the calculation of a new electron density ρ(r). The procedure may be repeated
cyclically.
To clarify the rationale behind the various steps in Fig. 8.1, we observe:
(i) ρ(r) is usually an observed Fourier synthesis, calculated using weighted
coefﬁcients, but may also be a hybrid synthesis. As described in
Section 7.3, weights are essential for computing optimized electron dens-
ity maps; they are calculated according to the probabilistic estimates of
the cosine invariant (φ −φp), described in Section 7.2.
(ii) Let us suppose that ρ(r) was obtained by some non-ab initio tech-
nique [e.g. by molecular replacement (MR, see Chapter 13), isomorphous
replacement (SIR-MIR, see Chapter 14), or anomalous dispersion tech-
nique (SAD-MAD, see Chapter 15)], and that {φ} are the corresponding
phases. Such phases were obtained by exploiting prior information on the
model molecule (in the case of MR), or via the diffraction experiment
(in SIR-MIR or SAD-MAD cases). This information is statistically inde-
pendent from the information used for modiﬁcation of the electron density
maps; therefore set {φmod} is usually combined with set {φ} to secure a
smooth approach to the correct phases. The weights with which φ and
φmod are associated may vary during the EDM process, in accordance
with the conﬁdence that the user has in the progressive improvement of
the φ values.
FT
MOD
FT–1
COMB
FT
{|F|, φ}
ρ(r)
ρmod(r)
{|F |, φcomb}
{Fmod, φmod}
Fig. 8.1
Schematic EDM cycle. {|F|} is the set
of observed reﬂections, {φ} is the set
of phases available at a certain step of
the phasing process. FT and FT−1 indic-
ate the direct and the inverse Fourier
transform, respectively, MOD is the func-
tion used to modify the electron density
ρ(r). |F|mod and φmod are the structure
factor amplitudes and phases obtained by
Fourier inversion of ρmod . φcomb arises
from the combination of φmod with φ.

180
Phase improvement and extension
It may be useful to recall that, not only observed electron densities, but also
difference and hybrid syntheses can be used in EDM procedures. For example,
Read (1986) showed that, when strong coordinate errors affect the model, then
ρ21 (see the symbols adopted in Section 7.3.4) may show a good correlation
with the target map without presenting too high a correlation with the model.
Since a high correlation with the model can hinder reduction of the model
bias, Read suggested the use of ρ21 rather than ρobs in EDM procedures. The
reason for this is easy to understand: the ρ21 map is the sum of an observed and
a difference Fourier synthesis, and therefore it combines the features of both
maps. ρ21 converges to the target map if a virtuous EDM technique is applied
(then, Fp, the structure factor of the model structure, tends to F, and both m
and D tend to unity; see again Section 7.3.4).
Let us now describe the expected positive features of electron density maps
that are exploited by modern EDM programs.
1. Flatness of the solvent region (only in macromolecular crystallography).
The electron density map of a highly reﬁned protein structure is rather ﬂat
in the solvent region, because of the liquid nature of the solvent (the reader
should not forget, however, that more static solvent molecules are found in
the protein molecules, or as a monolayer or as double layer at their surface).
If the map is calculated by using a model map poorly correlated with the
target, then noise peaks will be present in the solvent region. Removing
these would lead to better electron density maps, and therefore, by Fourier
inversion, to better phases.
The method is effective if the molecular boundary is known to a good
approximation. The ﬁrst techniques were manual (Hendrickson et al.
(1975), Schevitz et al. (1981)), but were soon replaced by automated tech-
niques (Bhat and Blow (1982), Wang (1985), Leslie (1987), Veilleux et al.
(1995), Abrahams and Leslie (1996), Cowtan (1994, 1999), Abrahams
(1997), Giacovazzo and Siliqi (1997)). In Appendix 8.A, the most popular
methods for determining the solvent content and for ﬂattening the corres-
ponding region in the unit cell are described; some information on bulk
solvent modelling is also given. An alternative approach is the sphere of
inﬂuence algorithm, proposed by Sheldrick (2002).
Once the molecular envelope has been determined, the electron density in
the solvent region is set to a constant value and a positivity constraint is applied
to the electron density in the protein region. The structure factors are calcu-
lated by back Fourier transform and the resulting phases are combined with
the corresponding φ values. The procedure is cyclically repeated.
In Fig. 8.2a we show, as an example, some details of the electron density of
the protein 2sar, as obtained by molecular replacement techniques: the pub-
lished model in the same region is superimposed. In Fig. 8.2b, the same region
of the map is shown as obtained after application of a solvent ﬂattening proced-
ure. The quality of the map (continuity of the electron density, interpretability,
etc.) is highly increased.
a)
b)
Fig. 8.2
2sar. a) Details of the electron density
of the protein as obtained by molecu-
lar replacement; the published model in
the same region is superimposed. b) The
same region of the map after application
of a solvent ﬂattening procedure. In both
ﬁgures, stars indicate the positions of the
waters, as located in the published model.
2. Distribution of density in a map. The actual histogram of an electron
density map is the frequency distribution of the electron density values;

Phase extension and reﬁnement via direct space procedures
181
z
x
y
Fig. 8.3
1ycn. Two monomers in the asymmetric
unit, referenced by non-crystallographic
symmetry. Only the backbones are repor-
ted.
the standard histogram for an electron density map is the expected distri-
bution of the density values. For light atom structures like proteins it is
almost independent of the structure itself. Therefore, the histogram of a
well-reﬁned known structure may be used to predict the standard histogram
of an unknown structure. Equivalently, the density values of a given trial
map may be modiﬁed to ﬁt the distribution expected for the ideal map.
The ﬁtting implies a modiﬁcation of the current electron density map and
therefore a constraint on the phases obtained by back inversion of the mod-
iﬁed map. The technique used for ﬁtting the current density histogram to
the standard one is called histogram matching; the larger the difference
between the two histograms, the larger the chance of an improvement by
the process. Several approaches for the application of electron density his-
tograms to the phase problem have been proposed [Luzzati et al. (1988);
Lunin (1988); Harrison (1989); Zhang and Main (1990a); Lunin (1993);
Gu et al. (1996); Refaat et al. (1996a)]. The technique is described in
Appendix 8.B.
3. Non-crystallographic symmetry. Crystallographic symmetry is valid for
the full crystal, non-crystallographic symmetry (NCS) has local validity;
therefore, ﬁve-, seven-, and higher-fold axes are permitted. NCS occurs
if the asymmetric unit contains more chemically identical molecules (see
Fig. 8.3), or if the unique molecule has its own symmetry axis (see
Fig. 8.4).
Fig. 8.4
Molecule with a local twofold symmetry
axis perpendicular to the drawing plane.
In this section, we will only describe how NCS may be exploited in EDM
procedures; the problem of how to discover and characterize NCS in molecular
replacement procedures is described in Appendix 13.B.
The electron density is expected to be similar in corresponding regions,
related by NCS (however, different contacts with neighbours may cause
deviations from exact equality). The technique imposing equal density on
sites equivalent by NCS is called molecular averaging. Equal densities of

182
Phase improvement and extension
the molecules generate constraints on the protein structure factors, and con-
sequently on the phase values. Rossmann and Blow (1963), Main (1967),
and Crowther (1969) proposed reciprocal space methods for deriving the con-
sequent phase relationships. Techniques working in reciprocal space were not
successful; the real-space method by Bricogne (1974, 1976) soon became
popular. It consists of the following steps.
(a) The envelope of the molecules in the asymmetric unit is found (it coin-
cides with the molecular model, if the map has been obtained by molecular
replacement). If only an initial electron density map is available, without
any other information, the mask can be determined by using the local dens-
ity correlation function (Veilleux et al., 1995) to distinguish volumes of the
crystal which map onto similar density under transformation by the NCS
operator.
(b) Equivalent (by NCS) densities are superimposed and the average is calcu-
lated; the noise will tend to be averaged out, and the protein density will
improve.
(c) The solvent region is ﬂattened.
(d) The thus modiﬁed electron density is back-transformed to obtain new
phase values.
(e) The new phase values are combined with previous phase information.
Steps (a) to (e) are cyclically repeated and eventually used for phase
extension.
For virus structures, molecular averaging is dramatically effective; because of
the large number of equivalent molecules related by non-crystallographic sym-
metry, molecular averaging produces phases practically without error. As a
consequence, even diffraction data at 4 Å resolution gives a map that is easily
interpretable. Rossmann and co-workers (Rossmann, 1990; McKenna et al.,
1992) solved several spherical viruses using this method.
Fig. 8.5
1kf3. Wire model of the protein molecule.
For common proteins, the situation is less favourable; however, even in
the most difﬁcult cases (e.g. via twofold averaging), remarkable reduction in
noise and improvement in electron density are achieved, provided that good
molecular envelopes are deﬁned and the geometrical relationship between
molecules is carefully identiﬁed. This last condition is not always easy to
fulﬁll. A good way to determine intermolecular transformation is to look
at the heavy atom sites; equivalent molecules have equivalent heavy atom
positions.
4. Continuity of the electron density. Continuous chains of density are to be
expected in a good macromolecular electron density. Locally, the density
should reﬂect the shapes and the interatomic spacings common to macro-
molecules. A complete and economical depiction of density connectivity in
large volumes is provided by the skeletonization techniques (Greer (1974),
Johnson (1978), Williams (1982), Swanson (1979, 1994), Jones and Thirup
(1986)), which use the fact that proteins consist of connected linear chains
of atoms and provide corresponding one-dimensional paths passing through
high-density regions of the electron density (see Figs. 8.5 and 8.6). The

Phase extension and reﬁnement via direct space procedures
183
continuity of the electron density in the current map is then a good qual-
ity indicator, and may therefore be used as a tool for improving phases
(we will see that main chain identiﬁcation is one of the tasks of automatic
model-building programs, see Section 8.3). The strategy (Wilson and Agard
(1993), Bystroff et al. (1993), Baker et al. (1993)) is based on the following
observation: the information that proteins are linearly connected strings of
atoms can be applied even in absence of an atomic model. Its application
does not require any use of detailed stereochemistry rules, but only con-
nectivity criteria. Therefore, a trial skeleton of the electron density may be
forced to adopt ‘protein-like’ characteristics without possessing an implicit
atomic model. This is equivalent to introducing additional strong con-
straints on the electron density map. The procedure may be schematized as
follows:
Fig. 8.6
1kf3.
Ribbon
model
of
the
protein
molecule.
(a) A trial skeleton is constructed from an original electron density map.
(b) A new map is created with density falling off smoothly with distance
from the skeleton.
(c) The new map is Fourier transformed to obtain new structure factors,
which are combined with starting phase information and experimental
factor amplitudes.
(d) Steps (a), (b), and (c) are iterated.
The complementarity between solvent ﬂattening and skeletonization
techniques is easily understood. Skeletonization enforces density con-
straints, but it is susceptible to large errors due to the unavoidable inef-
ﬁciency of the algorithm and to ignorance of the solvent. Integration of
solvent ﬂattening with skeletonization may beneﬁt from both types of
information.
5. Minimization of the resolution bias. As stated at the beginning of this
section, new structure factor estimates may be obtained by Fourier inver-
sion of modiﬁed electron density maps. The aim is to estimate the phases
of those measured reﬂections not involved in the preceding steps of the
phasing process (we called this procedure phase extension); e.g. high
resolution reﬂections unphased by MR, SIR-MIR or SAD-MAD proced-
ures, or weak reﬂections unphased by direct methods or other phasing
approaches. Often, very low resolution measured reﬂections are excluded
from the phasing process because their amplitudes are affected by the
solvent; phase extension may be applied to these reﬂections too. In all of
the above cases, even if phase extension is limited to experimentally meas-
ured reﬂections, it substantially improves the quality of the electron density
maps.
The question is now, can phase extension be applied to non-observed
structure factors, that is, to structure factors with resolution better than the
experimental one? The interest in such a question arises from the follow-
ing observation: the quality of an electron density map could improve if
non-observed structure factors are additionally used as coefﬁcients for the syn-
thesis, provided that their modulus and phase are extrapolated with sufﬁcient
accuracy.

184
Phase improvement and extension
A high quality map is usually a map with high correlation with the reﬁned
model of the corresponding structure. Low resolution structure factors provide
the main contribution to such a correlation, but do not secure full interpretab-
ility of the map, for which the contribution of higher resolution terms is
necessary. In this context, the unobserved higher resolution structure factors,
suitably extrapolated, may signiﬁcantly improve both the correlation of the
current electron density map with the reﬁned model map, and its inter-
pretability. Obviously, the extrapolation process may be usefully extended
to non-measured reﬂections with resolution worse than RES (various exper-
imental reasons can make the dataset incomplete, even at very low resolution).
Such reﬂections can contribute strongly to improving correlation of the current
map with the ‘true’ case.
Caliandro et al. (2005a,b) ﬁrst extrapolated unobserved reﬂections in mod-
ulus and phase, and applied them in a recursive way to obtain better structural
models (see also Yao et al., 2006). They proposed two types of application:
(i) In EDM procedures, the additional use of extrapolated reﬂections pro-
duces a general improvement in the electron density maps. Indeed, RES is
artiﬁcially improved, with beneﬁcial effects on the sharpness of the peaks
and on their location. Usually, the average phase error of the extrapol-
ated reﬂections is not much larger than the current average phase error for
those observed. On the other hand, amplitude extrapolation is very difﬁ-
cult; a posteriori analyses show that the correlation between extrapolated
and calculated (from reﬁned molecular models) amplitudes is very low.
This technique was named free lunch, owing to the fact that it contributes
to improvement in models without the need for additional spending on the
experiment.
(ii) In ab initio phasing procedures the active use of extrapolated reﬂections
allows a dramatic improvement in efﬁciency by leading to solution protein
structures resistant to any other procedure. This success may be explained
by the fact that phase and amplitude extrapolation progressively improves
during the phasing procedure, and in the last stages, the extrapolated
values are sufﬁciently close to the correct ones.
Two further observations may be useful. Firstly, extrapolated amplitudes
and phases are largely dependent on the model. The risk is that their use may
reinforce the model, even if it is very poor. Secondly, extrapolation may be
performed up to very high resolution, thus involving a number of supplement-
ary reﬂections in the phasing process, often much larger than the number of
observed ones. This may occur, for example, if RES is 2.2 Å or worse, and
extrapolation is performed up to 1.2 Å. To prevent extrapolated reﬂections
from taking a dominant role, suitably reduced weights should be associated
with them.
8.3
Automatic model building
A protein may be represented by long, highly ﬂexible chains (the backbone),
produced through repetition of identical units (i.e. the peptide units) to which

Automatic model building
185
small well-deﬁned units (i.e. the 20 natural amino acids, the side chains)
are attached. Building a molecular model in an electron density means to:
(a) reconstruct the backbone; (b) locate the side chains.
In the early days this task, the last step of the phasing process, was per-
formed manually and was time consuming; sufﬁcient data resolution, good
quality of the phases, and extensive experience of the crystallographer were
necessary ingredients for the success of the building process. In recent years,
semi-automated model-building (S-AMB) and fully automated model-building
(AMB) procedures have been devised to speed up map interpretation and mac-
romolecular structure determination; the historical trend has been analogous to
that occurring in the small molecule ﬁeld (see Section 6.3.5). However, accom-
plishing the task for macromolecules has been proved more difﬁcult, because
of the larger size of the problem and the poorer quality of available electron
density maps. Among the earlier contributions to automation, we recall the
work by Greer (1985), who suggested a fast method for tracing the polypeptide
chain inside the region of high electron density, followed by Jones and Thirup
(1986), Swanson (1994), and many others. More recently, Oldﬁeld (2002) pro-
posed starting the automated model-building process by identifying helices
and strands. Cowtan (1998, 2001) and Terwilliger (2001) (see also Pavelcik
et al., 2002) described a technique for identifying helices, strands, and other
characteristic structures by template matching.
Today, the model-building process is fully automatized; computer graphic
programs, pattern recognition techniques, real-space methods for ﬁtting the
model into the electron density, automated reciprocal space reﬁnement of
positional parameters, have all been combined into efﬁcient automated model-
building packages, capable of producing molecular models from scratch. The
basic principle for most model-building algorithms uses the connectivity of
the polypeptide chain and the presence of well-deﬁned structures (e.g. helices,
β-strands, etc.) in the chain. Model-building programs usually start by tracing
the backbone of the protein via a careful analysis of the electron density map.
Once the Cα backbone is traced, the next step is sequence docking: i.e., assign
the protein sequence (usually known) to the main-chain fragments, previously
located. This is usually done by checking the electron density at the coordinates
of the atoms of the main chain.
Although model building may be accomplished in many different ways,
some important features are common in any building program, that is the
use of databases of protein fragments. A database example is associated with
Buccaneer (Cowtan, 2012); it uses 500 well-reﬁned protein structures (Lovell
et al., 2003), which provide 106,295 amino acids in 1327 continuous frag-
ments. For each amino acid, the residue type is speciﬁed and the coordinates
of the N, Cα, and C atoms are stored. The full database is recorded as a single
list of amino acids.
Such databases may be used for various purposes; they are frequently used
to ﬁnd all fragments whose Cα overlap, at least approximately, with a given
(even discontinuous) set of Cα . The length of a search fragment may, in prin-
ciple, vary, but libraries of fragments including 12 or more residues seem to be
doubtful (Cowtan, 2012). Among the possible database applications, we recall
the following:

186
Phase improvement and extension
(i) Jones and Thirup (1986) used pentapeptides for reconstructing a main-
chain trace from Cα positions.
(ii) Kleywegt and Jones (1996) suggested the use of pentapeptide fragments
for the validation of a protein backbone trace.
(iii) Terwilliger (2003) used a library of tripeptide fragments to extend frag-
ments of protein chains, whereas Sheldrick (2010) used that to ﬁnd initial
protein fragments.
(iv) Cowtan (2012) used an eight-residue search fragment to ﬁnd a missing
loop of four residues (two residues before the missing loop, four null
residues corresponding to the missing loop, and two residues after the
missing loop).
Among the S-AMB programs, Coot deserves a special mention (Emsley
and Cowtan, 2004; Emsley et al., 2010), an interactive molecular-graphics
application for model building and validation. It may be used for:
(a) displaying electron density map and related atomic models;
(b) completing models generated by automatic model-building programs or
for starting model building when no model is available. In this frame-
work, Coot may generate rest of the main-chain atoms when other atoms
were previously located, may ﬁnd secondary structure elements such as
α-helices and β-strands, may ﬁt an α-helix or a β-strand in a given
region of the unit cell, or may rebuild, regularize, and reﬁne by real-space
reﬁnement an atomic model against an electron density map;
(c) improving the ﬁt of the model with the density and simultaneously
obtaining a high-quality Ramachandran plot (Ramachandran et al.,
1963);
(d) validating the current or the ﬁnal model against the electron density. Also,
geometrical checks are used, such as the identiﬁcation of incorrect chiral
volumes, a peptide analysis, a rotamer analysis, the Ramachandran plot,
the Kleywegt plot (useful for highlighting differences between chains
referred by non-crystallographic symmetry) (Kleywegt and Jones,1996),
etc.;
(e) providing interfaces to external validation tools such as MolProbity (Davis
et al., 2007) and REFMAC (Murshudov et al., 1997, 2011) reﬁnement
software.
AMB may be accomplished in many different ways, as is testiﬁed by the variety
of computer programs available. Among these, we quote ARP/wARP (Lamzin
and Wilson, 1993; Perrakis, et al., 1999; Morris et al., 2002), RESOLVE
(Terwilliger, 2004), TEXTAL (Gopal et al., 2007), MAID (Levitt, 2001),
BUCCANEER (Cowtan, 2006). The most popular program is ARP/wARP. Its
approach is described in Appendix 8.C.
AMB frequently starts after the application of EDM techniques, implies a
further modiﬁcation of the electron density map and ends with a substantial
improvement in the crystallographic phases; which is the reason why model
building may be considered to be included in the EDM methods.

Automatic model building
187
Initial electron density
map 
EDM, ……..
Model building
Refinement
EDM
(including information from built model)
Final model
Fig. 8.7
Typical outline of an AMB program.
The general outline of a typical AMB procedure is shown in Fig. 8.7, which
may be clariﬁed by a short description of the main steps.
(i) An observed electron density map (regardless of technique used to obtain-
ing it) is submitted to EDM, to improve phases and increase the map
interpretability. If an ab initio approach is used, the starting observed
density corresponds to the best available map. If molecular replace-
ment techniques (MR) are used, the starting density may be obtained
as follows: ﬁrst submit to restrained least-squares reﬁnement the model
structure as oriented and positioned by MR techniques, and then use the
resulting phases and the observes amplitudes to calculate the observed
map to submit to EDM procedures.
(ii) Cycles of model building are performed, aimed to ﬁnd Cα atoms and
deﬁne protein fragments. Fragments are grown by adding ﬂanking
residues at either end, using the electron density and the Ramachandran
plot as guide.
(iii) Fragments may be joined in longer fragments when they overlap.
(iv) Fragments may be linked by inserting one or more residues. As anticip-
ated at the beginning of this section, pentapeptides (Jones et al., 1991;
Kleywegt, 1997; Esnouf, 1997; Joosten et al., 2008) may be used to add
an additional Cα (see Fig. 8.8); indeed, if a tetrapeptide belongs to the
terminal part of the main-chain fragment, correctly positioned, they may
predict the position of the ﬁfth Cα and so extend the fragment. In case of
a gap involving more Cα, the above process may be iterated until the gap
is ﬁlled.
Cα
Cα
Cα
Cα
Cα
Fig. 8.8
Pentapeptide.
The
black
tetrapeptide
belongs to a main-chain fragment, cor-
rectly positioned; the position of the ﬁfth
may be predicted from it.

188
Phase improvement and extension
(v) The sequence is assigned. Residues non-docked into the sequence or lying
in a poor density region are eliminated or pruned. As anticipated at the
beginning of this section, rotamers may be used for locating and improv-
ing side chains; for this purpose, a rotamer library (Ponder and Richards,
1987; Dunbrack and Cohen, 1997; Lovell et al., 2000) is usually con-
tained in S-AMB and AMB programs. It may be worthwhile recalling
that a rotamer is deﬁned by speciﬁc torsion angles (not all the angles are
permitted, in the sense that there exists a rotational energy barrier that
needs to be overcome to convert one rotamer to another). For each amino
acid side chain, up to 50 rotamers may be found; the list includes side
chain torsion (chi) and probability values for each rotamer. For a par-
ticular side chain, a set of the most likely rotamers is used. Each test
rotamer is rigid body reﬁned for best ﬁt with the electron density; a score
is assigned according to the ﬁt of the map. The best ﬁt rotamer is chosen,
and the old coordinates of the side chain atoms are replaced by the new
ones.
(vi) Various protein fragments are submitted to restrained reﬁnement cycles
(e.g. via REFMAC), which are interspersed among the building cycles.
The model reﬁnement improves the built model and the corresponding
phases.
A successful application of AMB programs frequently ends with a large per-
centage of built residues (Pbuilt), a large percentage of residues assigned to the
sequence (Pdocked) and a small number of chains. Small values of Pdocked cor-
respond to failures. If the number of chains is too high, the chain connectivity
is broken in many places.
8.4
Applications
EDM procedures are usually applied after any phasing approach: tradi-
tional and non-traditional direct methods, Patterson deconvolution techniques,
MR, SIR-MIR, SAD-MAD, etc. In a way they are an obligatory route
to phase extension and reﬁnement. Probably the reader is interested in
veriﬁcation of how automatic application of a chain of programs, consist-
ing of a phasing approach followed by some phase reﬁnement procedures,
may improve the starting set of phases and lead to an electron density
map automatically interpretable by an AMB program. We will give two
examples.
1. Protein 1pm2: two chains, 750 residues, data resolution equal to 1.80 Å. The
target symmetry-independent molecules are depicted in Fig. 8.9a. There are
14 Hg and 4 Yb in the asymmetric unit; thus, ab initio Patterson methods
(see Chapter 10) were applied to obtain a preliminary electron density map,
which, submitted to ARP/wARP, provided the structural model reported in
Fig. 8.9b. EDM procedures, via SOLOMON, were applied to the electron
density map provided by Patterson techniques; phases improved signiﬁc-
antly, so that a next application of ARP/wARP led to the more complete

Applications
189
a)
b)
c)
d)
Fig. 8.9
1pm2. Structural models available by
means of the chain Patterson decon-
volution + Solomon + Free Lunch +
ARP/wARP. (a) Published model; (b)
model available after the application
of ARP/wARP to the electron density,
provided by a Patterson deconvolution
program (in symbols, by PATTERSON
+
ARP/wARP);
(c)
model
available
by
PATTERSON
+
SOLOMON
+
ARP/wARP;
(d)
model
available
by
PATTERSON + SOLOMON + FREE
LUNCH + ARP/wARP.
a)
b)
c)
d)
Fig. 8.10
1e3u. Structural models available by
means of the chain Patterson decon-
volution + Solomon + Free Lunch +
ARP/wARP. (a) Published model; (b)
model available after the application
of ARP/wARP to the electron density,
provided by a Patterson deconvolution
program (in symbols, by PATTERSON
+
ARP/wARP);
(c)
model
available
by
PATTERSON
+
SOLOMON
+
ARP/wARP;
(d)
model
available
by
PATTERSON + SOLOMON + FREE
LUNCH + ARP/wARP.
model depicted in Fig. 8.9c. The last electron density map provided by
SOLOMON was submitted to cycles of FREE LUNCH. The ﬁnal model is
shown in Fig. 8.9d.
2. 1e3u, four chains, 984 residues, data resolution equal to 1.65 Å. The
asymmetric unit is shown in Fig. 8.10a; it contains 8 Au, and therefore
the structure is ideal for the application of ab initio Patterson deconvolu-
tion techniques. The electron density map so obtained was submitted to
ARP/wARP : the resulting structural model is shown in Fig. 8.10b. EDM
procedures, via SOLOMON, were applied to the electron density map
provided by the Patterson deconvolution techniques; phase improvement is
not evident, so application of ARP/wARP does not lead to a more complete
model (see Fig. 8.10c). The last electron density map provided by Solomon
was submitted to cycles of FREE LUNCH. The ﬁnal, more complete model,
is shown in Fig. 8.10d.

190
Phase improvement and extension
APPENDIX 8.A
SOLVENT CONTENT, ENVELOPE
DEFINITION, AND SOLVENT
MODELLING
A solvent ﬂattening procedure may be described, schematically, by the follow-
ing steps.
1. Estimate
V ′p = (volume of the solvent)/(volume of the unit cell).
2. Find which region of the unit cell is occupied by the solvent and ﬂatten the
solvent space to obtain better phases.
Points 1 and 2 are described in Sections 8.A.1 and 8.A.2, respectively.
In Section 8.A.3, we describe possible model solvents, useful at various stages
of the crystal structure solution process.
8.A.1
Solvent content according to Matthews
Matthews (1968) surveyed 116 different crystalline proteins with known
molecular weights and found that for many protein crystals the ratio
VM = V/(ZM) = unit cell volume/(total molecular weight)
is between 1.7 and 3.5 Å3/Da, with most values being around 2.15 Å3/Da. Z
is the number of molecules in the unit cell, M the weight of a molecule in Da.
VM is also called Matthews number; it may be used for estimating Z.
For example, suppose that the space group is C2, V = 320 000 Å3 and M =
32 000. Given Z = 2, 4, 8, we obtain VM = 5, 2.5, 1.25 Å3/Da, the ﬁrst and the
third exceeding the allowed range. Thus the correct Z value is 4, equivalent to
assuming that there is one molecule per asymmetric unit.
This result may usefully be compared with the practical rule suggested in
Section 2.9 for small molecules, according to which V/N (the volume per atom)
should be approximately equal to 18 Å3. If we assume that the small structure
is mainly composed of C atoms, the rule is equivalent to the following: ratio
V/(ZM) is expected to be about 1.5 Å3/Da. The larger volume per protein atom
mainly arises from the solvent.
Matthews found that the fraction of a crystal usually occupied by protein
(say V ′p =) is about 57% of the unit cell volume and may vary between 30%
and 75% (values correlated with the size of the molecule); similarly, the solvent
volume ranges from 70% to 25%. Since
V′
p = Vprot/V,
where Vprot is the volume occupied by the protein per unit cell, we have.
V′
p =

Vprot/Mprot
 
Mprot/V

=

Vprot/Mprot

/VM,
(8.A.1)
where Mprot = MZ. Since M, and therefore Mprot, are expressed in Daltons and
Vprot is in Å3, (8.A.1) reduces to
V′
p = 1.6604/

dprotVM

,

Envelope deﬁnition
191
where dprot is the protein density (g cm−3). If this is assumed equal to 1.35,
then
V′
p = 1. 23/VM, V′
solv = 1 −V′
p.
(8.A.2)
8.A.2
Envelope deﬁnition
Wang (1985) proposed an automatic cyclic procedure for deﬁning a mask,
which should separate the map into solvent and molecule space, in accord-
ance with the ratio ﬁxed by the Matthews criterion. The Wang procedure may
be described as follows:
(a) The current electron density map (no matter if it has been obtained by
ab initio or non-ab initio techniques) is truncated according to:
ρtrunc(r) = ρ(r) if ρ(r) > ρsolv,
ρtrunc(r) = 0 if ρ(r) ≤ρsolv,
where the threshold, ρsolv, is chosen to meet the expected solvent content.
(b) ρtrunc is smoothed (into ρsm(r)) by associating, at each point r of ρtrunc,
the weighted average density over the points included in an encompassing
sphere of radius R (between 8 and 4 Å, according to the resolution or, also,
to the quality of the structure):
ρsm(r) =

r w(r −r′)ρtrunc(r′),
(8.A.3)
where
w(r −r′) = 1 −d(r′)/R for d < R,
w(r −r′) = 0 for d > R.
d = |r −r′| is the distance between points r and r′.
(c) A cut-off value, ρcut, is calculated, which divides the unit cell into two
regions, solvent and protein; solvent pixels are marked by the condition
ρsm(r) ≤ρcut, voids internal to the molecular envelope are polished.
(d) A solvent corrected map is obtained by setting all the values outside the
protein envelope to a low constant value; the electron density values inside
the molecular envelope are set to the current values (say, to the values
deﬁned at point a).
(e) New phases are obtained by Fourier inversion of the solvent correc-
ted map. Often such phases are combined with the experimental phases
(those obtained via SAD-MAD, SIR-MIR, or MR techniques). The cor-
responding electron density map is the new basis for the application of
point a.
Two years later, Leslie (1987) observed that (8.A.3) is a convolution, and that
ﬂattening may be more easily performed via its Fourier transform:
T[ρsm(r)] = Fsm(h) = T[w]T[ρtrunc] = g(s) · Ftrunc,
where Ftrunc is readily calculated by Fourier inversion of the truncated map.
g(s) is the Fourier transform of the weight function, sum of two components,
the ﬁrst of which is the Fourier transform of a sphere. According to James
(1962),
g(s) = Y(uR) −Z(uR),

192
Phase improvement and extension
where s = 2 sin θ/λ, u = 2πs,
Y(x) = 3(sin x −x cos x)/x3,
and
Z(x) = 3[2x sin x −(x2 −2) cos x −2]/x4.
Leslie’s procedure improved the efﬁciency of the ﬂattening technique and
dramatically reduced the computing time.
It may be useful to mention that several attempts have been made to estim-
ate the protein envelope at very low resolution (say, about 8 Å or worse).
The necessary prior information consists of unit cell parameters, space group,
high quality diffraction data, complete up to a ﬁxed resolution, and a rough
estimate of the solvent fraction. Attempts began with Kraut (1958). Somewhat
later, different algorithms were proposed, summarized as follows: the histo-
gram method (Luzzati et al., 1988; Mariani et al., 1988; Lunin et al., 1990),
the condensing protocol (Subbiah, 1991, 1993; David and Subbiah, 1994), the
one sphere method (Harris, 1995), FAM (Lunin et al., 1995; Moras et al., 1983;
Urzhumtsev et al., 1996). The general idea at the basis of all these algorithms
was to deﬁne at very low resolution a rough envelope, which may be easier
than at high resolution. Once a model envelope is obtained, phase extension
at higher resolution should be performed, mainly via solvent ﬂattening, his-
togram matching, etc. to progressively improve identiﬁcation of the solvent
region, and then allow solution of the protein structure.
The above methods were able to ﬁnd good (even if rough) envelope models,
but their weak point was the phase extension, quite difﬁcult from very low
resolution. In recent years these methods have been shelved, however it may
be that in the future their appeal will again increase.
8.A.3
Models for the bulk solvent
The narrow boundary region (within a 7 Å boundary layer) between the pro-
tein and the solvent exhibits an ordered structure of strongly bonded water
molecules. As a rule of thumb, about one water molecule per residue belongs
to such an ordered substructure (Kleywegt and Jones, 1997a). The solvent is
disordered beyond this shell, and solvent ﬂattening techniques use this char-
acteristic property to improve the protein phases. Since the bulk solvent may
signiﬁcantly contribute to the structure factors, taking into account its con-
tribution may improve agreement between calculated and observed structure
factors; this may be useful both in the reﬁnement step, and in the phasing step
itself (e.g. in the translation step of molecular replacement).
The effect of the solvent on structure factors may be understood as follows:
cancelling the solvent contribution from the calculated structure factor is equi-
valent to setting the electron density of the bulk solvent to zero. This implies
an inﬁnitely sharp contrast between protein surface and solvent, with an over-
estimate of the low resolution structure factor amplitudes. We will quote two
models for the solvent:

Histogram matching
193
1. Exponential bulk solvent. This is based on the Babinet principle, accord-
ing to which, if the unit cell is divided in two parts, one relative to the
disordered solvent and the other to the protein molecule, then Fsolv = −FP,
where the ﬁrst structure factor refers to the solvent volume and the second to
the protein volume. To understand the above relationship, we notice that, by
a property of the Fourier transform, a unit cell with constant electron dens-
ity will show vanishing structure factor amplitudes, except for F000. The
contribution of the solvent bulk is therefore opposite to that of the protein
volume, and will tend to weaken the amplitudes of the latter. An approxima-
tion to solvent scattering may be achieved by placing atoms with very high
temperature factor (e.g. 200 Å2) in the solvent region. The effects of the
above model may be represented by calculating the total structure factor,
Ft, as (Glikos and Kokkinidis, 2000b)
Ft(h) = FP(h)[1 −ksol exp(−Bsol s2/4)],
where s = 2 sin θ/λ and ksol is the ratio between the mean electron densities
of the solvent and of the protein. Since:
(i) the electron density of water is about 0.334 e−/Å3, and that for a salt
solution may be estimated at around 0.40 e−/Å3;
(ii) the protein density may be estimated as close to 0.439 e−/Å3,
then ksol may be approximated to 0.76. If we choose Bsol ≈200 Å2, the
effects of the solvent will disappear rapidly at higher resolution.
2. Flat bulk solvent. A ﬂat mask is used as the solvent model; it is located
into the solvent region, at a distance of about 1.4 Å from the van der Waals
surface of the protein. The bulk solvent region is then uniformly ﬁlled by a
continuous electron density, which contributes to the total structure factor,
in accordance with (Jiang and Brunger, 1994),
Ft(h) = FP(h) + ksolFsol(h) exp(−Bsol s2/4)]
(8.A.4)
The residual between the observed and the solvent corrected structure factors,
Ft, provides optimal values for the parameters ksol and Bsol (typical values are,
ksol ≈0.4 and Bsol ≈45 Å2). This kind of bulk solvent correction is implemen-
ted in several reﬁnement programs and is also used to improve the efﬁciency
of the translation step in MR programs.
APPENDIX 8.B
HISTOGRAM MATCHING
This technique is widely used in image processing; it aims to improve the
image quality by ﬁtting the density distribution of an image with the ideal
distribution. From this point of view, the electron density is an image of the
crystal structure, the quality of which should be improved by ﬁtting the density
frequency with standard distributions.
The actual form of a histogram depends on several parameters, among which
are:
1. the fraction of the unit cell volume occupied by the solvent;
2. the resolution at which the diagram is calculated;

194
Phase improvement and extension
3. the mean phase error associated with the structure factors;
4. the overall temperature factor.
To circumvent the effects of the temperature parameter, histogram matching
procedures remove the overall temperature factor from all the |F|s. This allows
simpliﬁcation of the method, since it is not necessary to use different standard
histograms for different temperature factors. Accordingly, the standard his-
togram, which is relative to the frequency distribution of the density in the
protein region, may be treated as a function of the resolution only. It may be
obtained from the electron density map of a similar known structure or from a
formula. Main (1990a,b) (see also Lunin and Skovoroda, 1991) has developed
a six-parameter formula which produces useful histograms over a range of
resolutions from 4.5 to 0.9 Å. Histograms are calculated by considering the
densities only within the molecular envelope. We note that:
1. The ﬂatness of the histogram increases with the average phase error. In
Fig. 8.B.1 we overlap the histogram corresponding to the reﬁned structure
with one obtained from approximate phase values.
P(ρ)
ρ
Fig. 8.B.1
Electron
density
histograms
obtained
from reﬁned phases ( —— ) and from
approximated phases ( - - - ).
2. Histograms are asymmetric; the asymmetry is a consequence of the pos-
itivity of the electron density (negative density values are less frequent
than positive ones) and may be used as a criterion for phase correction
(Podjarny and Yonath, 1977). On the other hand, the negative regions must
be present in the histograms because they are generated by unavoidable
series termination errors. Skewness, say,
γ = <
ρ−<ρ >
σd
3
>
with
σd = <(ρ−<ρ >)2 >1/2
,
is usually calculated to evaluate the asymmetry; it can be positive or neg-
ative, or undeﬁned. Negative skewness values indicate that the tail on the
left-hand side of the probability density function is longer than on the right-
hand side; a positive skewness indicates that the tail on the right-hand side
is longer than on the left-hand side; a zero value indicates that the values
are relatively evenly distributed on both sides of the mean. In our case,
skewness is expected to be positive.
P(ρ)
ρ
Fig. 8.B.2
Electron density proﬁle variation with
resolution.
3. The histogram changes with the data resolution (see Fig. 8.B.2). The his-
togram for high resolution maps has its maximum close to ρ = 0; for low
resolution maps, the maximum shifts to higher values of ρ, and the peak
is broader. The peak of the histogram lowers to a minimum at about 3 Å
resolution; as the resolution decreases, the peak rises again, moves towards
higher density, and becomes broader. Long tails towards high density are
present in high resolution maps.
4. The histogram matching technique may be applied as follows (Zhang and
Main, 1990a,b):
(i) From a given set of B-parameter corrected structure factors, the Fourier
synthesis and the corresponding histogram are calculated. The latter is
compared with the standard histogram.
(ii) The electron density histogram of the actual map is divided into smaller
areas with boundaries, ρi, i = 1, . . . , n (n ∼100) (see Fig. 8.B.3a). The

Histogram matching
195
standard histogram is also divided into smaller areas, with boundaries,
ρ′i, i = 1, . . . , n (see Fig. 8.B.3b).
(iii) Scale factors ai and shifts bi are calculated to map ρ into ρ′ for the ith
interval:
ρ′ = aiρ + bi
(8.B.1)
where
ai = ρ′i + 1 + ρ′i
ρi + 1 −ρi
,
bi = ρ′iρi + 1 −ρ′i + 1ρi
ρi + 1 −ρi
.
For example, if only a scale factor k relates the two maps (e.g. ρ′ = kρ),
then
ai = k and bi = 0 for any i.
If only a shift relates the two maps (e.g. ρ′ = ρ + b), then
ai = 1 and bi = k for any i.
(iv) The operation (8.B.1) is applied to the actual map for each interval; the
new map will show the same density distribution as that expected.
(v) A new set of structure factors is calculated from the modiﬁed electron
density, whose phases are employed for a next cycle.
A more intuitive approach is to let P(ρ) and Ps(ρ) be the current and the
standard reference density histograms, respectively (both sum to unity), and
N(ρ) and Ns(ρ) the corresponding cumulative distributions. The transforma-
tion of P(ρ) into Ps(ρ) is made as follows. For any density value P(ρ), the
corresponding point in N(ρ) is calculated; this is mapped in Ns(ρ), and the
desired modiﬁed value in the standard distribution is obtained by inverting the
cumulative standard distribution:
ρ = N−1
s [Ns(ρ)].
Histogram matching is usefully combined with solvent ﬂattening techniques
as follows:
a)
b)
ρi
ρi+1
ρ′i
ρ′i+1
Fig. 8.B.3
(a) Electron density histogram for the
actual electron density model; (b) stand-
ard electron density histogram.
(a) The molecular envelope is obtained.
(b) The solvent region is ﬂattened, while the density within the molecular
envelope is matched with the expected histogram. Obviously, histogram
matching efﬁciency is high when the solvent region is a small percent-
age of the unit cell. When the reverse condition occurs, solvent ﬂattening
effects are dominant.
(c) Structure factors are calculated from the above modiﬁed map and their
phases are (eventually) combined with experimental phases. If a phase
extension process is started, the extended phases are accepted at the
calculated values.
(d) A new map is calculated using data obtained at step (c), and the procedure
is repeated from step (a) until convergence is obtained.
It is obvious that histogram matching and solvent ﬂattening procedures are
not able to suppress all false peaks from an experimental electron density map
and/or generate all the supplementary peaks to complete the structure. Indeed,

196
Phase improvement and extension
false density inside the envelope tends to remain, while molecular density out-
side the envelope may remain strongly depressed. However, these procedures
are able to produce remarkable improvements in the maps.
APPENDIX 8.C
A BRIEF OUTLINE OF THE
ARP /wARP PROCEDURE
The automatic reﬁnement procedure (ARP) is based on a free atom approach.
A set of dummy atoms is created, new atoms are added and old ones are
deleted to create new models which, cyclically re-evaluated, should end in a
ﬁnal model describing electron density and target protein. The procedure may
be described schematically as follows.
Dummy atoms (of the same atomic species, say O) are located in the high
density regions of the best available electron density map; a ﬁne grid of about
0.25 Å is used. The initial model is gradually expanded; the density threshold is
gradually lowered and additional atoms are located at bonding distances from
existing atoms. The model is completed when the number of dummy atoms is
about 3 x NAT, where NAT is the expected number of atoms. At the end of the
updating process (see below) the number of atoms is reduced to about 1.2 x
NAT.
The model is updated as follows.
(i) Atom rejection. Hybrid electron densities of type 3Fo–2Fc are calculated;
an atom is removed on the basis of the density at the atomic centre,
on shape criteria (e.g. sphericity), and distance criteria (e.g. too close to
accepted atoms).
(ii) Atom addition. The Fo–Fc synthesis is calculated; the grid point with the
highest density value is selected as a new atomic position, provided that
this satisﬁes deﬁned distance constraints in relation to other positioned
atoms. Grid points at small distance from this added atom are rejected
and the next higher grid point is selected.
(iii) Model reﬁnement. This may be performed by a cyclic procedure based
on unrestrained least squares or maximum likelihood reﬁnement (in both
the cases the procedure aims at matching calculated to observed structure
factors), and/or by real-space reﬁnement (an atom may be moved from the
peak position on the basis of a density shape analysis around it). Usually,
the reciprocal space reﬁnement is performed by REFMAC (Murshudov
et al., 1996); it needs a number of observations, greater than the number
of model parameters, which then sets the resolution limit of ARP/wARP
to about 2.5 Å.
So far no attempt has been made to establish a chemical sense to the atoms,
in terms of atomic species, bond distances, bond angles, protein secondary
structures, etc.; typically, free atoms lie within 0.5–0.6 Å of the corresponding
positions in the correct structure.
Following this, model reconstruction starts; its task is to discard atoms in
false positions, assign atomic species to the well-located atoms, and to estab-
lish their connectivity. Only when atomic species, bonds, and angles for a

A brief outline of the ARP/wARP procedure
197
group of atoms have been deﬁned (see below), will stereochemical restraints
be applied in restrained reﬁnements; this will improve the ratio of observations
to parameters, and will increase the efﬁciency of the least squares reﬁnement
(which will then become hybrid, because free and restrained atomic positions
will coexist).
Model reconstruction starts with identiﬁcation of the main-chain atoms.
Every Cα atom should stay at 3.8 Å from at least one other candidate Cα atom,
which may be connected to the ﬁrst one by a forward (outgoing) directionality
(– C(= O) –N −Cα) or by a incoming (backward) directionality [N—C(= O)
−Cα]. If two atoms i and j are Cα candidates (see Fig. 8.C.1), then a pep-
tide unit plane is placed among the candidates and rotated about the i–j axis.
If, for a given rotation angle, the interpolated electron density at the peptide
atomic positions is larger than a given threshold, atoms i and j are ﬂagged as Cα
atoms.
Cα (n+1)
a)
b)
Cα (n+1)
Cα (n)
Cα (n)
N
N
C
C
O
O
Fig. 8.C.1
Connection between two candidate Cα
atoms. The peptide plane is located
between these atoms and rotates about
the axis Cα(n) −Cα(n + 1). The two can-
didates are ﬂagged as Cα atoms if, for a
given orientation of the plane, the inter-
polated density values at the atomic pos-
itions are larger than a given threshold.
(a) Forward directionality; (b) backward
directionality.
The electron density maps to which AMB algorithms are applied usually
show non-negligible phase errors; therefore, the condition according to which
two consecutive Cα atoms should lie at 3.8 Å apart must be replaced by a more
permissive condition, say, the distance should lie in a range (e.g. 3.8 ± 1 Å).
The result is that many candidates may be connected by more than one
incoming and one outgoing connection, with the consequent combinatorial
explosion of the possible chains. ARP/wARP solves the problem by divid-
ing each candidate chain into small structural subunits and by evaluating,
by stereochemical arguments, the probability of each subunit being the cor-
rect one. Subunits consisting of four consecutive Cα atoms are used, say
Cα(n) −Cα(n + 1) −Cα(n + 2) −Cα(n + 3), and the two-dimensional fre-
quency distributions of the angle Cα(n) −Cα(n + 1) −Cα(n + 2) and of the
dihedral angle Cα(n) −Cα(n + 1) −Cα(n + 2) −Cα(n + 3) are tested against
the distribution derived from database analysis (Oldﬁeld and Hubbard, 1994;
Kleywegt, 1997). This information is of a three-dimensional nature, and may
be used to obtain a score for the subunit (of length four) parameters. The main
chain is built by overlapping the last three atoms of one subunit with the ﬁrst
three of the following. The chain scores are then obtained by summation of the
subunit scores.
Limited data resolution and quality of the phases, combined with the nat-
ural conformational ﬂexibility of the chain, may not allow recovery of a full
continuous chain; several main-chain fragments may be obtained, separated
by gaps, and some chain fragments may be wrongly identiﬁed. The lower the
quality of the starting electron density map and data resolution, the larger the
probability of having a large number of gaps.
Once one or more main-chain fragments have been correctly identiﬁed, side
chains may be built by taking into account the Cα positions, the density distri-
bution in the map, and connectivity criteria; the aim is to dock the polypeptide
fragments into the sequence (assumed to be known). A score is associated with
each possible docking position, so that the chain would have the most probable
side chain conformation.

Charge flipping and VLD
(vive la difference)
9
9.1
Introduction
Direct methods procedures (see Chapter 6) or Patterson techniques (see
Chapter 10), primarily the former, have been methods of choice for crystal
structure solution of small- to medium-sized molecules from diffraction data.
Over the last 30 years, several new phasing algorithms have been proposed,
not requiring the use of triplet and quartet invariants, but based only on the
properties of Fourier transforms. These were not competitive with direct meth-
ods and have never became popular, but they contain a nucleus for further
advances. Among these we mention:
(i) Bhat (1990) proposed a Metropolis technique (Metropolis et al., 1953;
Kirkpatrick et al., 1983; Press et al., 1992), also known as simulated
annealing (the reader is referred to Section 12.9 for details on the
algorithm). From a random set of phases, an electron density map is
calculated, modiﬁed, and inverted. The corresponding phases are altered
according to the simulated annealing algorithm, and then used to calculate
a new electron density map. The procedure is cyclic.
(ii) A strictly related simulated annealing procedure has been proposed by Su
(1995). The objective function to minimize was
R =

h (S|Fh|calc −|Fh|obs)2,
where S is the scale factor. The scheme is as follows: random atomic pos-
itions are generated and in succession shifted; the simulated annealing
algorithm is applied to accept or reject atomic shifts. At the end, a new
atomic structure is generated, whose positions are shifted in succession,
and so on in a cyclic way.
(iii) The forced coalescence method (FCP) was proposed by Drendel et al.
(1995). Hybrid electron density maps (see Section 7.3.4) were actively
used with different values of τ and ω.
Even if never popular, the above algorithms opened the way to two other
methods which are much more efﬁcient, charge ﬂipping and VLD (vive la dif-
ference), to which this chapter is dedicated. Both are based on the properties of

The charge ﬂipping algorithm
199
the Fourier transform; they do not require the explicit use of structure invariants
and seminvariants, or a deep knowledge of their properties. The reader should
not, however, conclude that the invariance and seminvariance concepts are not
necessary in the handling of these approaches, on the contrary, understanding
these basic concepts is essential to the appreciation of these new methods.
To be more clear, when an electron density is modiﬁed, a model map is
simultaneously identiﬁed; and when the model map is Fourier inverted, model
structure factors with modulus |Fp| and phase φp are obtained. The reliabil-
ity of the new phases is usually calculated via the distribution P(R, Rp, φ, φp),
described in Section 7.2, which involves estimation of the two-phase structure
invariants, (φh −φph).
9.2
The charge ﬂipping algorithm
Charge ﬂipping was developed by Oszlányi and Suto (2004, 2005, 2008) and
has been successfully applied to small molecules (Wu et al., 2004; Palatinus
and Chapuis, 2007), modulated structures (Palatinus et al., 2006), powder data
(Baerlocher et al., 2007a,b), high resolution protein data (Dumas and van der
Lee, 2008). We describe the algorithm step by step (see Fig. 9.1):
1. The list of unique reﬂections, as ﬁxed by the space group symmetry, is
expanded in P1 to produce a complete list of reﬂections; Friedel pairs, if
present, are merged.
2. Random starting phases are assigned to the expanded list of reﬂections.
3. An electron density map is calculated over a grid with spacing adjusted
to RES/2. It may be seen from Fig. 9.2a that, at least at high resolution,
large density values are restricted to a small percentage of pixels, which
therefore carry almost all of the structural information. Figure 9.2a is a
different way of representing the density distributions shown previously in
Figs. 8.B.1 and 8.B.2.
4. The electron density is modiﬁed so that all the pixels with density smaller
than a given positive threshold δ (see Fig. 9.2b) are submitted to ﬂipping
(i.e. their density is multiplied by −1). In Fig. 9.1, the modiﬁed map is
called ρmod .
5. The inverse Fourier transform of ρmod is treated as follows: for large amp-
litudes (about 80% of the total number), calculated phases are associated
with observed amplitudes, for weak reﬂections, the calculated modulus
{|F |, φmod}
FT
MOD
FT –1
{|F|, φ}
ρ(r)
ρmod(r)
{|Fmod |, φmod}
Fig. 9.1
Charge ﬂipping algorithm. {|F|} is the
set of observed reﬂections, {φ} is the set
of random phases. FT and FT−1 indicate
the direct and the inverse Fourier trans-
forms, respectively, MOD is the function
used to modify the electron density, ρ(r).
{|F| mod} and {φ mod} are the structure
factor amplitudes and phases obtained by
Fourier inversion of ρ mod .

200
Charge flipping and VLD (vive la difference)
is retained and the phase shifted by π/2. A new electron density map is
calculated and the cycle starts again.
Let us ﬁrst explain the source of the algorithm name. The total charge in a map
is assumed to be
ctot =

i ρi,
where i varies over all grid points and the ﬂipped charge is deﬁned as
cﬂip =

ρi<δ |ρi|,
where the summation goes over all points satisfying the condition ρi < δ.
The various applications showed that, for proper values of δ, the ratio cﬂip/ctot
should lie at around 0.9. As a rule of thumb, it should roughly correspond to
inverting the low density pixels shown in Fig. 9.2b. Flipping the density in
this region modiﬁes the electron density distribution and allows us to explore
the phase space efﬁciently. Giacovazzo and Mazzone (2011) observed that the
ﬂipped region corresponds to that with the largest values of electron dens-
ity variance. As in other EDM techniques, the algorithm modiﬁes a model
without destroying it; in this way the region to reverse is not part of the solu-
tion, otherwise the convergence would never be reached. When a good model
is obtained, reversing the sign of the density for high variance pixels provides
negligible perturbation of the model, which cannot be destroyed.
density
(a)
(b)
0.75
0.50
0.25
–0.25
density
0.75
0.50
0.25
d
–0.25
Fig. 9.2
Typical high-resolution electron density
distribution, sorted in descending order.
The number of pixels is in the abscissa.
δ is the most critical parameter; it usually changes during the phasing
process and sometimes has to be tuned to lead the algorithm to succeed.
During each charge ﬂipping cycle, the crystallographic residual and the
skewness coefﬁcient of the density map (see Appendix 8.B) are calculated.
The convergence is assumed to be reached when a sharp increase in relative
skewness occurs, accompanied by a drop in the crystallographic residual. The
phasing process may usually be subdivided into an initial transient step, a long
stagnation period where the phase space is extensively explored, a stable state
where a sharp increase in the relative skewness occurs, accompanied by a drop
in the crystallographic residual. Such a sharp improvement in the ﬁgure of
merit denotes that convergence has been reached.
Charge ﬂipping solves the structures in P1. This trick was ﬁrst applied by
Sheldrick and Gould (1995), when solution in the correct space group was not
being successful; it was later adopted by other authors. The main advantage
of solving a structure in P1 is that the restraints imposed by symmetry on the
phase values are relaxed and the phases may sometimes converge smoothly
to the correct values. However, the use of P1 remained infrequent for direct
methods; indeed, symmetry is important prior information which should not
generally be suppressed. Charge ﬂipping, however, renounces this information;
it is not clear why, but its efﬁciency decreases dramatically when phasing is
attempted using the correct space group symmetry.
In accordance with the above observations, the charge ﬂipping crystal struc-
ture solution step is followed by a second step, restating the correct space group
symmetry; i.e. it locates the space group symmetry elements in the P1 density
map. A technique is therefore necessary to automatically ﬁnd the shift between
the origin of the P1 map and the conventional origin of the space group. This

The VLD phasing method
201
process has to be accompanied by density averaging over the symmetry equi-
valent (in the correct space group) grid points. The algorithm used for returning
to the correct space group is similar to the RELAX procedure developed by
Burla et al. (2000), and later improved by Caliandro et al. (2007a). Since
RELAX also plays an important role in the VLD approach, we describe it in
Appendix 9.B.
9.3
The VLD phasing method
In Section 7.2, we assumed that a model structure is available; to deal in an
optimal way with the phasing problem, we calculated the joint probability
distribution P

R, Rp, φ, φp

(see equation (7.3)). In Section 7.3, we showed
its extraordinary usefulness for optimization of some widely used crystallo-
graphic tools and phasing procedures; we refer in particular to the observed
Fourier synthesis via the use of the weight m, and to the difference Fourier
synthesis via the use of the Read coefﬁcients, mE −σAEp.
Let us now consider ρ, ρp, ρq; these are the target, the model, and their
ideal difference structure; ρq = ρ −ρp has the property that, summed to ρp,
it provides ρ, no matter what is the quality of ρp. Let R, Rp, Rq, φ, φp, φq be
the corresponding normalized diffraction amplitudes and phases. Would the
distribution,
P

R, Rp, Rq, φ, φp, φq

,
(9.1)
be more useful than (7.3)? The hope is that including into the probabilistic
approach the additional variate Eq could lead to more accurate conditional
distributions, estimating phases given three rather than two magnitudes.
Distribution (9.1) (studied by Burla et al., 2010a) is the theoretical basis
of the VLD (vive la difference) algorithm; for the interested reader, some
details are quoted in Appendix 9.A.1, together with the conditional distribu-
tions which support VLD. The VLD algorithm (Burla et al., 2010b, 2011a,b) as
an ab initio phasing technique is described in Sections 9.3.1 to 9.3.2; its applic-
ations to ab initio phasing are summarized in Section 9.3.3. We delay until
Section 10.4 some VLD applications in combination with Patterson deconvo-
lution techniques: VLD combination with molecular replacement is described
in Section 13.10.
9.3.1 The algorithm
Distribution (9.1) is practicable only if:
(i) measurement errors are included in the mathematical model;
(ii) the parameter σA (calculated between the model and the target structure)
is not unity.
Indeed, according to the deﬁnition of ρq, if condition (i) is violated, then
Fq = F −Fp is determined perfectly by the other two variates, and cannot
be introduced as a third variable in equation (9.1). If condition (ii) is violated
(i.e., σA = 1), then ρp ≡ρ and ρq ≡0; then it is not necessary to calculate a
six-variate distribution (indeed, Fq will be identically equal to zero).

202
Charge flipping and VLD (vive la difference)
These circumstances oblige us to adopt the following mathematical model
for the normalized structure factors:
Eh =
Np
j=1 fj exp

2πih(rpj + 	rj)

+ N
j=Np+1 fj exp

2πihrj

+ |μ| exp(iϑ)
	 
(εN)1/2
(9.2a)
Eph =
p
j=1 fj exp 2πihrpj


εNp
1/2
(9.2b)
Eqh =
Np
j=1 fj exp[2πih(rpj + 	rj)]
+ N
j=Np+1 fj exp

2πihrj

−Np
j=1 fj exp

2πihrpj
	 
 
εq
1/2 ,
(9.2c)
where (compare with the corresponding assumptions in Section 7.2):
(a) rpj, j = 1, . . . , Np, are known ﬁxed parameters;
(b) rj = rpj + 	rj, j = 1, . . . , p. The variables rj are riding variables, correlated
with the corresponding rpjs through local positional errors, 	rjs;
(c) rj, j = p + 1, . . , N are primitive random variables, assumed to be
uniformly distributed within the unit cell;
(d) |μ| exp (iϑ) is the (complex) measurement error, considered as a two-
dimensional primitive random variable;
(e) All of the primitive random variables are assumed to be statistically
independent of each other.
The distribution P

R, Rp, Rq, φ, φp, φq

obtained under the above assumptions
and the conditional distributions P

φq|R, Rp, Rq, φp

and P(φ|R, Rp, Rq, φp, φq)
are given in Appendix 9.A. The ﬁrst conditional distribution is used to calculate
the best estimates of ρq(r) given ρ(r) and ρp(r), the second is used to calculate
a new ρ(r) map, given ρp(r) and the estimate of ρq(r).
The VLD algorithm may be brieﬂy schematized as follows (Burla et al.,
2011b):
Let ρi(r) and ρpi(r) be the current target and model map estimates
at step i; then, ρqi(r) is calculated via Fourier coefﬁcients suggested by
P

φqi|R, Rpi, Rqi, φpi

and it is suitably modiﬁed. The new target map is
obtained via the equation,
ρi+1(r) = ρpi(r) + ρq mod i(r).
The procedure is cyclic.
In greater detail, the VLD algorithm, theoretically justiﬁed in Appendix 9.A,
is described below, step by step (see Fig. 9.3 for a ﬂow chart of the algorithm):
1. Random phases, φ, are assigned to the observed structure factors; then the
electron density, ρobs(r), (using Robs exp(iφ) as coefﬁcients) is calculated.
2. The electron density, ρp(r), is obtained by a simple modiﬁcation of ρobs(r);
i.e. 2.5% of the pixels (those with the largest positive intensity) are accepted
unchanged, the rest are set to zero. γ (about ten) EDM cycles, not shown in
the ﬁgure for brevity, are applied to improve the electron density map; for
each cycle, the σA parameter is calculated. At the end of the EDM cycles, a
new pair [ρobs(r), ρp(r)] is obtained (see Appendix 9.A).

The VLD phasing method
203
MOD
MOD
FFT
TANG
FT
FT–1
FT–1
ρqmod (r)
ρobs (r)
ρqest (r)
ρp (r)
{Eqinv}
{Ep}
{φrand
{φcalc}
Fig. 9.3
Typical
cycle
of
the
standard
VLD
algorithm.
3. The difference electron density, ρqest(r), an estimate of the ideal difference
synthesis, ρq(r), is calculated via coefﬁcients, (mR −Rp) exp(iφp), sugges-
ted by distribution (9.1) (see Appendix 9.A.1). It is suitably modiﬁed in
ρqmod(r), as follows: 4% of the pixels with positive density and 4% of the
pixels with negative density (those with the largest absolute value of the
density) are accepted unchanged, the rest are set to zero.
4. Eqinv are obtained by Fourier inversion of ρqmod(r) and by subsequent his-
togram matching with a Wilson distribution; they are then summed to Ep
(say, Ecalc ∼Ep + wEqinv via the tangent formula (9.A.8)) to obtain new φ
estimates (say, φcalc).
5. An updated electron density, ρobs(r), is calculated and the cycle starts again.
Three remarks will be useful here:
(i) According to the Read formulation, if the model is uncorrelated with
the target (e.g. in the case of a random model), then the best difference
electron density is calculated via the coefﬁcients
Eqest = mR −σARp ≡0.
(9.3a)
Since all the Eq’s are expected to vanish (indeed, m and σA are expected to
be zero), the best difference electron density should vanish everywhere,
because no information is available on the rest of the structure from a
random model; consequently, the best difference electron density is
ρqest(r) ≡0.
(9.3b)
In these conditions, the best target electron density map is
ρ(r) ≈ρp(r) + ρqest(r) = ρp(r);
(9.3c)
In other words, according to the Read formulation, the best target elec-
tron density coincides with the model, evidently in contradiction with the
assumption that the model is casual.
Distribution (9.1) suggests a different logic: under the condition
(p ≈N), the best coefﬁcient for calculating the difference Fourier
synthesis is
Eqest = mR −Rp ≡−Rp,
(9.4a)
according to which the best difference electron density is
ρqest(r) = −ρp(r) ̸= 0,
(9.4b)
and the best target electron density is
ρ(r) = ρp(r) + ρqest(r) = 0
(9.4c)

204
Charge flipping and VLD (vive la difference)
The logical result suggested by the above relations is that if the model
is random, the best target electron density is that which identically van-
ishes at all points in the map. In this case, the best ρ(r) is no longer
biased towards the model, which was deﬁned as casual. This result agrees
well with the expectation that the electron density should not show any
structural features, because the model is casual and does not provide any
information on ρ(r).
The fact that ρqest(r) is not vanishing everywhere allows it to be modiﬁed;
if this is sensible, ρq mod (r) may better ﬁt the ideal difference electron
density ρq(r), and, when summed to ρp(r), may provide a new, better
electron density ρ(r).
(ii) At step 2 of the algorithm, we speciﬁed that the σA parameter is calculated
at each EDM cycle. Since σA tends to increase during the EDM cycles
even if the phases do not improve, the restraint
sA = (< σA > −< σAinit >) / (1 −< σAinit >)
is calculated, where < σA > is the average (over the resolution shells) σA
value for the current VLD cycle, < σAinit > is the corresponding experi-
mental value for the initial VLD random model. sA is an estimate of the
path fraction covered by < σA> during the phasing process towards the
correct solution (it is assumed that the correct solution is attained when
σA ≈1). It is suggested that sA should not be larger than
r =

Rcrystinit −Rcryst

/

Rcrystinit −0.20

,
which is an estimate of the path fraction covered by Rcryst towards the
correct solution (it is assumed that the correct solution is found when
Rcryst = 0.20).
(iii) As stated in Section 9.2, Sheldrick and Gould (1995) discovered that,
when the crystal structure solution is attempted via direct or Patterson
methods, the phasing process may occasionally succeed in P1 and fail in
the correct space group. It was then clear that symmetry elements can trap
phases in false minima, while the absence of symmetry elements allows
a softer phasing moving towards their correct values.
The drawbacks of the P1 procedure were essentially twofold. Firstly, lower-
ing the symmetry corresponds to deleting some prior information. Secondly,
supplementary work is necessary after crystal structure solution, to ﬁnd the
translation locating the origin in the correct space group.
A different way of overcoming the occasional perverse effects of sym-
metry operators was suggested by Burla et al. (2000) and made more efﬁcient
by Caliandro et al. (2007a). This is the so-called RELAX procedure (see
Appendix 9.B), which has recently been integrated into the VLD algorithm
(Burla et al., 2011b). VLD phasing is always attempted in the correct space
group; a jump in P1 is only made during the cycles in which the ﬁgures of
merit attain local maxima. In P1 phases are relaxed, but soon the procedure
automatically returns to the correct space group, where the phasing process
is continued. The procedure is based on the observation that often direct and

The VLD phasing method
205
Patterson methods provide molecular fragments, correctly oriented but incor-
rectly located. RELAX is the algorithm encharged with the origin shift; its use
has allowed a dramatic improvement in VLD efﬁciency.
9.3.2 VLD and hybrid Fourier syntheses
The main properties of hybrid Fourier syntheses were discussed in
Section 7.3.4. In the literature, many papers have been dedicated to the sub-
ject (Ramachandran and Srinivasan, 1970; Dodson and Vijayan, 1971; Main,
1979; Vijayan, 1980). According to Read (1986), they may be estimated via
the coefﬁcients
(τm|F| −ωD|Fp|) exp(iφp),
(9.5)
where τ and ω are any pair of real numbers. For brevity, in the following
we will denote the hybrid synthesis obtained via τ and ω parameters as the
(τ −ω) – synthesis; e.g. the usual difference and observed Fourier syn-
theses coincide with the (1–1)- and (1–0)-syntheses, respectively. Among
applications, we quote:
(i) (2–1)-syntheses are employed both in powder (Altomare et al., 2009c) and
in macromolecular crystallography (Read, 1986) for improvement of the
model structure. Indeed (2–1)-syntheses suffer from model bias much less
than (1–0)-syntheses, and may thus allow the model to evolve towards the
target structure more easily;
(ii) (4–3)- and (2–1)-syntheses were used by Drendel et al. (1995) in the
forced coalescence algorithm for ab initio phasing. Even if theoretically
interesting, the limited efﬁciency of the algorithm did not make the method
a popular choice.
(τ −ω)-syntheses with τ < ω are less used in crystallographic methods, prob-
ably because they are the difference between an ω difference Fourier synthesis
and an ω −τ observed Fourier synthesis, with a pre-eminent role for the
difference component (see Section 7.3.4).
Quite recently (Burla et al., 2011c), study of the joint probability distribution
P

E, Ep, EQ

suggested that, under the condition p ≈N, the best coefﬁcient
for a hybrid Fourier synthesis is
	E = (τmR −ωRp)exp(iϕp).
(9.6)
The above scenario opened up new perspectives for the VLD algorithm, as it
may be combined with a (τ −ω)-synthesis instead of only the (1–1)-synthesis.
This combination is then analogous to the use of different types of struc-
ture invariants and seminvariants in direct methods phasing procedures. More
explicitly, while direct methods may use invariants of different order (i.e. triplet
and quartet invariants and/or structure seminvariants), VLD can use phase
relationships arising from different hybrid electron densities; from the (1–1)-
synthesis to any (τ −ω)-hybrid density.
9.3.3 VLD applications to ab initio phasing
In Section 9.2, we speciﬁed the numerous applications for the charge ﬂipping
algorithm. VLD is a very new approach, and has, so far, only been applied to

206
Charge flipping and VLD (vive la difference)
two ﬁelds: to ab initio phasing and combined with Patterson and molecular
replacement techniques. Here, we will only deal with the ab initio approach;
we postpone to Section 10.4 description of some VLD applications in com-
bination with Patterson deconvolution techniques, and to Section 13.10, VLD
combination with molecular replacement.
To provide the reader with an idea of the efﬁciency of VLD, we remember
that Burla et al. (2011c) used 100 small (up to 80 non-hydrogen atoms in the
asymmetric unit) structures to check how effective the VLD algorithm is when
combined with (1–1), (1–2), (1–3), and (2–1) syntheses (four protocols). The
set of test structures contained minerals as well as organic and metal-organic
compounds; some structures showed strong pseudo-translational symmetry
and 42 of them were centrosymmetric.
The results were as follows: all structures were solved in default, no matter
which protocol was used; the average number of random models necessary to
solve the structures (say <nseed>) always lay between 1.1 and 1.3 (if <nseed>
equal to 1, the correct solution would be obtained from any random model),
< |	φ| > was between 8◦and 12◦, <t> sec between 26 and 33 (data for cur-
rent desk computers). Thus, at least for small molecules, the VLD user does
not need to choose among the various protocols.
Burla et al. (2011c) checked the various protocols against 86 medium-sized
(up to about 350 non-H atoms in the asymmetric unit) test structures: 19 were
centric, 12 had more than 200 non-H atoms in the asymmetric unit, and for
40 of them, F was the heaviest chemical species. The results were as fol-
lows: (i) the VLD combinations with (1–1) and (1–2) syntheses were the most
effective; (ii) in default conditions, neither syntheses could solve two of the
structures; (iii) for the solved ones <nseed> = 1.95, <t> = 10.7 min for the
(1–1) protocol, <nseed> = 2.13 and <t> = 6.3 min for the (1–2) protocol.
It should be stressed that the above result does not imply that VLD is unable
to solve the missed structures, which may be achieved by increasing the num-
ber of random models (by default set to a maximum of 20), or by using
non-default parameters.
Protocols (1–1) and (1–2) were also applied to a set of 35 protein test struc-
tures at atomic resolution. Results were as follows: (i) in default conditions,
protocol (1–1) was unable to solve 13 of the 35 structures. For the solved ones
<nseed> = 2.18; (ii) protocol (1–2) in default did not solve 11 proteins, with
<nseed> = 5.04.
APPENDIX 9.A
ABOUT VLD JOINT PROBABILIT Y
DISTRIBUTIONS
9.A.1
The VLD algorithm based on difference
Fourier synthesis
Under the assumptions stated in Section 9.3, the following joint probability
distribution has been found (Burla et al., 2010a):
P(R, Rp, Rq, φ, φp, φq) ∼= π−3e−1L−1RRpRq exp{−[λ11R2 + λ22R2
p + λ33R2
q
+ 2λ12RRp cos(φ −φp) + 2λ13RRq cos(φ −φq)
+ 2λ23RpRq cos(φp −φq)]},
(9.A.1)

About VLD joint probability distributions
207
where, in accordance with deﬁnitions given in Section 7.2, model and target
structures consist of Np and N atoms, respectively,
σA = D

Np

 
N
D = <cos(2πh · 	r)>
e =

1 + σ 2
R

,
and
σ 2
R = < |μ|2 >

N.
Furthermore,
L = (e −1)

1 −σ 2
A
 
N
e 
q
,
λ11 =
1
(e −1),
λ22 =

q

N
1
1 −σ 2
A
+

p

N
1
e −1,
λ33 =

q

N

1
e −1 +
1
1 −σ 2
A

,
λ12 = −
 
p

N
1/2
1
e −1,
λ13 = −
 
q

N
1/2
1
e −1,
λ23 =

p

q
1/2

N

e −σ 2
A
(e −1)

1 −σ 2
A


−
 
q

N
1/2
σA
1 −σ 2
A
.
q is a D-dependent parameter, as the following relationship suggests:
q = < |Fq|2 > = p(1 −2D) + N.
ρ
ρp
−ρp
ρq
Fig. 9.A.1
Non-realistic one-dimensional four-atom
target structure (ρ) and a two-atom model
(say, ρp), the atomic positions of which
perfectly coincide with two atoms of the
target structure (parameter D = 1). In this
case, ρq is everywhere positive and has a
reduced scattering power (compared with
that in Figs. 9.A.2 and 9.A.3).
ρ
ρp
−ρp
ρq
Fig. 9.A.2
Schematic target and model structures for
N = 4, Np = 2. Model and target struc-
tures partially overlap; parameter D in the
interval (0,1).
ρ
ρp
−ρp
ρq
Fig. 9.A.3
Schematic representation of ρ, ρp, and ρq
when the model is uncorrelated with the
target structure (then, D = 0). ρq is not
everywhere positive and has very large
scattering power.
Accordingly, q depends on the quality of the model; it tends to N −p
when D = 1 and it tends to N + p when ρp progressively loses (up to
D = 0) its isomorphism with ρ. This behaviour is conﬁrmed in Figs. 9.A.1 to
9.A.3.
From equation (9.A.1), the conditional distribution
P

φq|R, Rp, Rq, φp
 ∼= [2πI0(Gq)]−1 exp

Gq cos

φq −φp
 	
(9.A.2)
is obtained, where
Gq = 2R′q
e −1

(mR −σARp) −R′p(1 −D)
e −σ 2
A
1 −σ 2
A

(9.A.3)
where R′p = Rp(p/N)1/2
and
R′q = Rq(q/N)1/2.
In terms of structure factors, equation (9.A.3) becomes,
Gq =
2|Fq|
(e −1) 
N

(m|F| −D|Fp|) −|Fp|(1 −D)
e −σ 2
A
1 −σ 2
A

(9.A.4)

208
Charge flipping and VLD (vive la difference)
Equations (9.A.3) and (9.A.4) suggest the following considerations:
1. The phase relationship used for the difference Fourier synthesis (7.18),
which is
φq ≈φp if m|F| > D|Fp|, φq ≈φp + π if m|F| < D|Fp|,
is no longer supported. Indeed, according to equation (9.A.4), φq is expec-
ted to be close to φp, or close to φp + π, according to whether Gq is positive
or negative.
2. The sign of Gq does not always coincide with the sign of (m|F| −D|Fp|).
Indeed, the right-hand side of equation (9.A.4) is the sum of two con-
tributions, the ﬁrst depending on the value of (m|F| −D|Fp|), called the
difference term; the second (say, |Fp|(1 −D)

e−σ 2
A
1−σ 2
A

), is called the ﬂip-
ping term, and is always negative and proportional (via a positive factor) to
−|Fp|. Its contribution depends on the quality of the model structure, and
increases with the poorness of the model. It is dominant when the model
is very poor (then (m|F| −D|Fp|) = 0) and tends to vanish for high quality
structural models.
3. A new difference Fourier coefﬁcient may be conjectured, equal to
	E =

(mR −σARp) −R′p(1 −D)
 e −σ 2
A
1 −σ 2
A

exp(iφp).
(9.A.5)
The corresponding difference Fourier map will show three different types of
peaks, the properties of which are determined by the quality of the model. For
a very poor model, the map will show the following peaks:
(i) very strong negative peaks where model atoms do not overlap with target
atoms. In this case, both the difference and ﬂipping terms will generate
negative electron density;
(ii) medium intensity negative peaks, where model and target atoms overlap.
In this case, the difference term does not provide any contribution to the
electron density, while the ﬂipping term will generate negative electron
density;
(iii) medium intensity positive peaks, where target atoms do not overlap with
model atoms. In this case, the difference term provides a positive electron
density, while the ﬂipping term does not provide any contribution to the
electron density. The intensity ratio between peaks (i) and peaks (ii) and
(iii) will decrease when the model becomes a better approximation of the
target structure;
(iv) estimates of φq are available no matter what is the quality of the model
structure. For example, even in the limit case in which σA and D are zero
(model and target structures completely uncorrelated, as in Fig. 9.A.3),
the parameter Gq may be large and therefore the φq estimate may be
reliable. That is equivalent to the following statement:
it is possible to obtain a meaningful estimate of ρq, even when ρp and ρ are
completely uncorrelated (e.g. when ρp is randomly ﬁxed).
(9.A.6)
This property is not shared by the classical synthesis (7.18): when
CORR ∼0, then <|Fq|> = |m|F|−D|Fp|| is vanishing, and consequently

About VLD joint probability distributions
209
the intensity of any pixel of the difference Fourier synthesis, calculated via
those coefﬁcients, is expected to vanish. In practice, no information in, no
information out.
Statement (9.A.6) seems to be without foundation, however, the correctness
of the approach becomes clear if one considers Fig. 9.A.3, where simpliﬁed
models for ρ, ρp, and ρq are schematized, when σA = 0. On assuming that ρ
is unknown and that ρp is uncorrelated with ρ (they have no peak in com-
mon), then ρq consists of N positive and Np negative peaks. It can easily be
seen that ρq and −ρp are positively correlated, because they have p negat-
ive peaks in common (corresponding to the wrongly located atoms in the ρp
structure). Equivalently, ρp and ρq are anticorrelated, and it is just the ﬂipping
term in equations (9.A.5) and (9.A.6) which guarantees the anticorrelation.
Accordingly, an estimate of ρq is always possible, even when the atoms of the
model structure are randomly located.
Similar observations also hold for Fig. 9.A.2, where σA and D do not coin-
cide neither with 0 nor with 1. In this case, ρq consists of N −Np positive peaks
and by Np electron density residuals, consisting of pairs of positive and negat-
ive peaks. Now, ρq and ρp are weakly anticorrelated; such a relation is taken
fully into account when both the difference and the ﬂipping term are used.
If we consider Fig. 9.A.1, where the case D = 1 is schematized, it can be
seen that ρq and ρp are uncorrelated. Accordingly, the ﬂipping term vanishes
and structure completion may only occur through the difference term.
To check the extraordinary property of coefﬁcients (9.A.5), we selected (see
Table 9.A.1) a number of protein test structures for which models are available,
with different degrees of correlation with the target structure (CORR in the
table). We calculated the difference electron density by using both Read coef-
ﬁcients and (9.A.5) coefﬁcients. Correlations of the corresponding maps with
the ideal difference density are denoted by CORRqREAD and CORRqVLD.The
table shows that, even when CORR is close to zero, the difference map cal-
culated with VLD coefﬁcients is well correlated with the ideal difference
density.
A second conditional probability may be derived from equation (9.A.1), say,
P

φ|R, Rp, Rq, φp, φq

, which assumes that the moduli R, Rp, Rq and the phases
φp, φq are known:
P

φ|R, Rp, Rq, φp, φq

= [2πI0(Q)]−1 exp [Q cos(φ −ϑ)] ,
(9.A.7)
where ϑ is the most probable value of φ, given by
tan ϑ = R′p sin φp + R′q sin φq
R′p cos φp + R′q cos φq
= QT
QB
,
(9.A.8)
and
Q = 2R(e −1)−1(Q2
T + Q2
B)1/2
= 2R(e −1)−1 
R′2
p + R′2
q + 2R′p R′q cos(φp −φq)
1/2
(9.A.9)
is its reliability factor.
Equation (9.A.7) suggests that, when an estimate for φq is obtained (even
from a model uncorrelated with the model structure) via distribution (9.A.2),

210
Charge flipping and VLD (vive la difference)
Table 9.A.1
For some protein test structures (PDB is the protein data bank code) we show:
(1) The correlation (CORR) of the protein electron density with the model structure (not repor-
ted): values of CORR close to unity indicate good models, values close to 0 indicate uncorrelated
models. (2) CORRqRead is the correlation between the difference electron density calculated
by Read coefﬁcients and the ideal difference structure. <	φq>Read is the corresponding aver-
age phase error. When the model is uncorrelated with the target, CORRqRead is close to zero.
(3) CORRVLD is the correlation between the difference electron density calculated by coefﬁcients
(9.A.5) and the ideal difference structure. <	φq>VLD is the corresponding average phase error.
When the model is uncorrelated, CORRVLD is particularly high
PDB
CORR
CORRqRead
< 	φq >READ
CORRVLD
< 	φq >VLD
1kf3
0.93
0.51
57
0.62
53
6rhn
0.89
0.40
63
0.62
54
1zs0
0.82
0.38
64
0.61
54
2p0g
0.72
0.30
66
0.60
59
2sar
0.70
0.36
62
0.59
55
1cgn
0.39
0.19
65
0.62
53
2iff
0.36
0.18
71
0.51
67
9pti
0.02
0.01
73
0.62
54
6ebx′
0.01
0.00
70
0.66
46
9pti′
0.01
−0.02
74
0.66
50
it may be combined with φp to provide a new phase estimate for the target
structure. This result is the basis of the VLD algorithm.
The parameters involved in distribution (9.A.1), and therefore in the condi-
tional distributions (9.A.2) and (9.A.7), seem to be complicated to use. We will
now see how their expressions may be simpliﬁed. The VLD algorithm works
on maps, therefore it does not need a molecular model, a model map being
sufﬁcient. Accordingly, model structure factors may be calculated by inver-
sion of some percentage of the electron density map. In the present version of
the VLD algorithm, it has been assumed that the percentage is large enough
to contain the quasi-totality of the electrons; in this case, 
Np ≈
N . This
approximation simpliﬁes the parameters as follows:
(i) Since R′p = Rp(p/N)1/2, R′p reduces to Rp.
(ii) Since R′q = Rq(q/N)1/2, D =

N
p σA and q = p(1 −2D) + N,
we have,
q/N = 2(1 −σA)
and
R′q = Rq

2(1 −σA).
(iii) If, in addition, it is assumed that e is very close to unity then,
	E ≈(mR −Rp) exp(iφp)
(9.A.10)
is the coefﬁcient to use for calculation of the difference Fourier synthesis, and
the tangent formula (9.A.8) may be rewritten as
tan ϑ = Rp sin φp + wqRq sin φq
Rp cos φp + wqRq cos φq
,
(9.A.11)
where
wq =

2(1 −σA).

About VLD joint probability distributions
211
Equation (9.A.11) makes clear the important role of Eq in the ﬁrst steps of
the phasing process, when σA is close to zero and wq ≈
√
2, and its marginal
contribution in the last steps, when σA is frequently close to unity and wq ≈0.
In the ﬁrst case, Eq contributes strongly to completion or modiﬁcation of the
crystal structure model, in the second, the crystal structure reﬁnement may
only rely on the efﬁciency of the EDM procedures.
9.A.2
The VLD algorithm based on hybrid
Fourier syntheses
Quite recently (see Burla et al., 2011c), the joint probability distribution
P

E, Ep, EQ

(9.A.12)
was studied, where EQ is the normalized structure factor of the hybrid map,
ρQ = τρ −ωρp.
The Fourier coefﬁcient suggested by (9A.12) for the (τ −ω)−synthesis is

(τmR −ωσARp) −R′p

ω(1 −D) + (ω −τD)(e −1)
1 −σ 2
A

exp(iφp),
(9.A.13)
or, in terms of structure factors,

(τm|F| −ωD|Fp|) −|Fp|

ω(1 −D) + (ω −τD)(e −1)
1 −σ 2
A

exp(iφp).
(9.A.14)
Again, Read and ﬂipping coefﬁcients are simultaneously present in expressions
(9A.13) and (9.A.14). If ω = τ = 1, equations (9.A.13) and (9.A.14) reduce to
the difference Fourier coefﬁcients given in Section 9.A.1.
Under the condition 
p ≈
N , the best coefﬁcient for a hybrid Fourier
synthesis is
	E = (τmR −ωRp)exp(iφp),
(9.A.15)
and the VLD algorithm may be schematized as follows:
(a) The chosen hybrid synthesis is calculated via the coefﬁcient 	E, given by
(9A.15); it is conveniently modiﬁed and inverted, no matter what is the
quality of the model. Let φQ be the phase obtained by Fourier inversion,
and RQ, the corresponding normalized amplitudes (obtained by submitting
the moduli obtained by Fourier inversion to histogram matching with the
Wilson distribution).
(b) The corresponding Fourier coefﬁcients, EQ, are combined with the nor-
malized structure factors of the model structure, through the tangent
formula,
tan φ = ωRp sin φp + wQRQ sin φQ
ωRp cos φp + wQRQ cos φQ
,
(9A.16)
where
wQ = [τ 2 + ω2 −2ωτσA]1/2,

212
Charge flipping and VLD (vive la difference)
and
ξQ = 2Rτ −1 
ω2R2
p + w2
QR2
Q + 2ωwQRpRQ cos(φp −φQ)
1/2
(9A.17)
is the reliability parameter of the phase indication.
(c) The observed Fourier synthesis (using the phases φ, deﬁned by equation
(9.A.16)) is calculated and submitted to cycles of EDM. At the end, a new
model structure is obtained and the procedure returns to (a).
APPENDIX 9.B
THE REL AX ALGORITHM
The algorithm may be described as follows:
1. Structure solution is attempted in the correct space group; the phases φ are
assigned.
2. The reﬂections are expanded in P1. So far the space group symmetry is
still fulﬁlled; indeed, reﬂections that are symmetry equivalent in the correct
space group have, in P1, the same amplitudes and symmetry related phases.
3. Some EDM cycles are performed to relax the phases. After this EDM stage,
the space group symmetry is not fully obeyed; while the reﬂections that are
symmetry equivalent in the correct space group maintain in P1 the same
observed amplitudes, the phases of the corresponding calculated structure
factors usually do not reﬂect the space group symmetry, because they were
reﬁned in the EDM step without any constraint.
4. A permissible origin for the correct space group is searched. To do that, the
Cheshire cell (Hirshfeld, 1968) is explored according to a grid of 0.3 Å.
Each node of the grid is deﬁned by the generic vector Xj and for each node
the following ﬁgure of merit is calculated:
S2 =  whwhR cos(φ′h −φ′hR + 2πhT)/  whwhR
− whwhR| sin(φ′h −φ′hR + 2πhT)|/  whwhR,
where R and T are the rotational and the translational matrices of the
generic symmetry operator, respectively. The summation covers all phased
reﬂections. Furthermore,
φ′h = φh −2πhXj and φ′hR = φhR −2πhRXj,
are the phase values to assign to Fh and to FhR, respectively, when the origin
has been translated by the vector Xj. wh = |Fh|calc is the weight assigned to
the reﬂection h.
Since, in the correct space group,
φhR = φh −2πhT,
a good translation should show (φ′h −φ′hR −2πhT) values close to
zero. Accordingly, the maximum of S2 should identify the suitable origin
translation.
5. The grid point for which S2 is a maximum ﬁxes the most probable origin
translation. Let X0 be such a grid point; then the P1 phases φh are modiﬁed
according to the relation
φ′h = φh −2πhX0.

The RELAX algorithm
213
6. Since the various φhR (obtained by varying the R matrix) were reﬁned in
P1 without constraints, at this stage they are not expected to strictly satisfy
the space group symmetry. To re-establish this, for each set of equivalent
reﬂections, a unique reﬂection has to be selected, to which a suitable phase
value should be assigned. Then symmetry related phase values should be
assigned to the symmetry equivalent reﬂections.
7. Let ha be the unique reﬂection, and haRj be the vectorial index of its jth
symmetry equivalent reﬂection. The reﬂection Fha is assigned the phase
φha deﬁned by
tan φ′ha =

j wj sin(φ′ha)j

 
j wj cos(φ′ha)j = T/B.
The summation is over the m symmetry equivalent reﬂections, and
(φ′ha)j = φ′haRj + 2πhaTj
is the phase value which one should associate with the reﬂection ha if φ′haRj
was determined correctly.
8. Eventually, other phase reﬁnement cycles are performed to improve the
structure model.
Unfortunately, RELAX, as deﬁned by the above algorithm, is very time con-
suming; indeed its application requires the calculation of S2 for all of the grid
points in the Cheshire cell. As a consequence, RELAX, in the above version,
was only ever used in difﬁcult cases and for a very small number of selected
trial solutions.
In order to simplify the ab initio crystal structure solution of proteins,
Caliandro et al. (2007a) combined RELAX with Patterson deconvolution meth-
ods; this time RELAX was calculated via FFT, and led to a reduction in cpu
time of more than one order of magnitude.
FFT calculations allowed more extended applications of RELAX. Thus dir-
ect methods and the VLD approach may also beneﬁt; indeed the use of RELAX
allows us to obtain the correct solution from a misplaced electron density,
which is not possible with traditional approaches.
However, with the VLD procedure, the use of RELAX must be judicious;
indeed, thousands of trial models may be generated, and the trivial combina-
tion VLD-RELAX may dramatically slacken the phasing process. Luckily, only
some of the models are appropriate to be treated using RELAX, and these may
be preliminarily identiﬁed via suitable ﬁgures of merit.

Patterson methods
and direct space
properties
10
10.1
Introduction
According to the basic principles of structural crystallography, stated in
Section 1.6:
(i) it is logically possible to recover the structure from experimental diffrac-
tion moduli;
(ii) the necessary information lies in the diffraction amplitudes themselves,
because they depend on interatomic vectors.
The ﬁrst systematic approach to structure determination based on the above
principle was developed by Patterson (1934a,b). In the small molecule
ﬁeld related techniques, even if computerized (Mighell and Jacobson, 1963;
Nordman and Nakatsu, 1963), were relegated to niche by the advent of direct
methods. Conversely, in macromolecular crystallography, they survived and
are still widely used today. Nowadays, Patterson techniques have been reborn
as a general phasing approach, valid for small-, medium-, and large-sized
molecules.
The bases of Patterson methods are described in Section 10.2; in
Section 10.3 some methods for Patterson deconvolution (i.e. for passing from
the Patterson map to the correct electron density map) are described, and in
Section 10.4 some applications to ab initio phasing are summarized. The use
of Patterson methods in non-ab initio approaches like MR, SAD-MAD, or
SIR-MIR are deferred to Chapters 13 to 15.
We do not want to leave this chapter without mentioning some fundamental
relations between direct space properties and reciprocal space phase rela-
tionships. Patterson, unlike direct methods, seek their phasing way in direct
space; conversely, DM are the counterpart, in reciprocal space, of some direct
space properties (positivity, atomicity, etc.). One may wonder if, by Fourier
transform, it is possible to immediately derive phase information from such
properties, without the heavy probabilistic machinery. In Appendix 10.A, we
show some of many relations between electron density properties and phase

The Patterson function
215
relationships, and in Appendix 10.B, we summarize some relations between
Patterson space and phase relationships.
Patterson (1949) deﬁned a second synthesis, known as the Patterson syn-
thesis of the second kind. Even if theoretically interesting, it is of limited use
in practice. We provide information on this in Appendix 10.C.
10.2
The Patterson function
10.2.1 Mathematical background
Let ρ(r) be the electron density of our target structure, and
Fh =
N

j=1
fj exp

2πi h · rj

= T [ρ(r)] =

V
ρ(r) exp(2πi h · r) dr
its generic structure factor. We express Fh in different ways to emphasize both
its practical and its basic deﬁnitions. T indicates the Fourier transform, and V
is the volume of the unit cell. Conversely, the electron density may be obtained
via Fourier transform of Fh (assumed to be known in modulus and phase):
T−1[Fh] = ρ(r) = 1
V

h Fh exp(−2πi h · r).
(10.1)
Let us now consider the squared amplitude |Fh|2; we wonder which informa-
tion the inverse Fourier transform of |Fh|2 should provide us, say,
T−1 
|Fh|2
= 1
V

h |Fh|2 exp(−2πi h · r) .
(10.2)
This question is very important because equation (10.2) may be directly cal-
culated from the diffraction amplitudes, without any phase information. Since
|Fh|2 = Fh · F−h, we have, because of the convolution theorem,
T−1 
|Fh|2
= T−1[Fh · F−h] = ρ(r) ⊗ρ(−r) =

V
ρ(r) ρ(r + u)dr.
(10.3)
The integral on the right-hand side of (10.3) is the autoconvolution of the func-
tion ρ(r), called a Patterson function in crystallography, and indicated by P(u).
We can rewrite (10.3) as
P(u) = 1
V

h |Fh|2 exp(−2πi h · u) = 2
V

h>0 |Fh|2 cos (2πh · u),
(10.4)
where the symbol h > 0 means that the summation goes over half the recip-
rocal space (the Friedel opposites are included within the summation). The
result is that the integral on the right-hand side of (10.3) may be calculated via
the Fourier synthesis on the right-hand side of (10.4),
P(u) =

V
ρ(r) ρ(r + u)dr = 2
V

h>0 |Fh|2 cos (2πh · u)
(10.5)
We now have to discover what information is provided by P(u).

216
Patterson methods and direct space properties
10.2.2 About interatomic vectors
According to (10.5):
1. The periodicity of P(u) is the same as that of ρ(r); both functions are
characterized by the same unit (primitive or centred) cell.
2. P(u) = 0 in u, unless at least two atoms with interatomic vector u exist
(see the medium term in equation (10.5)). Indeed, if only two atoms exist,
one in ri with density ρ(ri) and one in ri + u with density ρ(ri + u), then
P(u) ≈ρ(ri) · ρ(ri + u). If more pairs exist in the unit cell, all with the
same interatomic vector u, each jth pair contributes to P(u) with a quantity
proportional to ρ

rj

ρ

rj + u

. In this case, P(u) ≈
pairs ρ

rj

ρ

rj + u

.
3. If N atoms are in the unit cell, there are N-1 vectors from any given atom
to the others, and one (null) vector from itself. Accordingly, we will have
N2 interatomic vectors, say, ri −rj, i, j = 1, . . . , N. When i = j the vectors
correspond to N zero-distances of each atom with itself; they superimpose
at the origin of the Patterson map, which is by far the most intense peak on
the map. The remaining N · (N −1) vectors are distributed within the unit
cell.
4. P(u) is always cs., even if ρ is n.cs. (indeed, if ri −rj exists, rj −ri also
exists). As an example, in Fig. 10.1a, a one-dimensional very simple elec-
tron density is shown, consisting of three atoms with different atomic
weights, denoted 1, 2, and 3. In Fig. 10.1b, the corresponding Patterson
map is shown; each peak is labelled with two numbers, corresponding to
the atom labels in the electron density. The largest peak is in u = 0, where
the zero-distances of each atom with itself overlap. The intensities of the
other peaks are proportional to the products of the corresponding atomic
numbers, say, Z3Z2, Z3Z1, Z2Z1.
5. Since the number of interatomic vectors is much larger than the number
of atomic positions, the Patterson function shows a strong peak overlap-
ping (e.g. for 1000 atoms in the unit cell there are 106 interatomic vectors).
In particular, in the origin, N zero-distance vectors overlap; the overall
intensity is proportional to N
j=1 Z2
j .
1
1
0
P(u)
ρ(x)
u
x
1–1
1–2
1–3
2–2
3–3
1–1
2–2
2–1
3–3
3–1
3–2
2–3
2
3
(a)
(b)
Fig. 10.1
a) A simple one-dimensional structure composed of three atoms with different atomic number Z. Z is assumed to be proportional to the peak
label; b) the corresponding Patterson map.

The Patterson function
217
6. A Patterson peak in u has a width approximately equal to the sum of the
widths of the corresponding electron density peaks in ri and in ri + u.
This is a consequence of the fact that P(u) is the autoconvolution of the
electron density. Indeed, if we approximate the electron density of two
atoms by two Gaussians functions, with standard deviations σA and σB,
the convolution will still be Gaussian, and will have standard deviation
equal to (σ 2
A + σ 2
B)1/2. This behaviour is an additional reason for the peak
overlapping; as a consequence, the resulting Patterson map may be almost
featureless, unless some heavy atoms are present.
7. To reduce the overlapping problem, it is convenient to sharpen the map,
by using |E|2 or (|E|3|F|)1/2 as Fourier coefﬁcients; we should not forget,
however, that any sharpening increases the series truncation errors and the
consequent ripples (see Section 7.3.1).
Figure 10.1 suggests that a three-dimensional Patterson map, in ideal con-
ditions (that is in the absence of peak overlapping and devoid of resolution
effects), provides the information contained in the following matrix:
											
Z1Z1, r1 −r1
Z1Z2, r1 −r2 . . . . .
Z1ZN, r1 −rN
Z2Z1, r2 −r1
Z2Z2, r2 −r2 . . . . .
Z2ZN, r2 −rN
. . . . .
. . . . .
. . . . .
. . . . .
ZNZ1, rN −r1
ZNZ2, rN −r2 . . . . .
ZNZN, rN −rN
											
.
Each element of the matrix contains information on the peak intensity and
on its location; the diagonal entries correspond with zero-distance peaks, all
overlapping in the origin. It may also be noted that each jth line (or column)
provides an image of the structure as seen from the jth atom. Accordingly, a
Patterson map may be thought of as a sum of images (Wrinch, 1939; Buerger,
1946, 1959; Clastre and Gray, 1950; Garrido, 1950). In Fig. 10.2a, a schematic
four-atom structure is shown, and in Fig. 10.2b, the corresponding vector set is
marked; the vector set as the sum of structure images is clearly recognizable.
This property will be exploited in the Sections 10.3.3 and 10.3.4 to solve the
structural problem.
A
(a)
(b)
(c)
B
C
D
A
A
A
A
B
B
B
B
O
C
C
C
D
D
D
Fig. 10.2
a) Schematic four-atom molecule. b)
Corresponding vector set. c) Two images
of the molecule obtained by superimpos-
ing on the map in b) the same map shifted
by the vector OC.
Properties (1) to (7), listed above, can be easily recognized in Figs. 10.3a
and b; in (a) we show a schematic two-dimensional unit cell, space group pg
(equivalent positions (x,y), (−x, y + 0.5)) with three symmetry independent
atoms (one S and two O); in (b) the corresponding Patterson map is shown.
Because of the periodic nature of the Patterson map, the peaks lying on the
edges of the unit cell are repeated after a period.
10.2.3 About Patterson symmetry
The electron density,
ρ(r) = 1
V

h Fh exp(−2πi h · r),
(10.6)
shows space group symmetry because the summation on the right-hand side
of (10.6) embraces all reﬂections, symmetry equivalents included; each ¯hR

218
Patterson methods and direct space properties
reﬂection, symmetry equivalent to h, enters into equation (10.6) as a complex
number deﬁned by
F¯hR = Fh exp(−2πi¯hT).
The Fourier coefﬁcient of the Patterson function (10.5) is |F¯hR|2; this satisﬁes
the rotational symmetry of the electron density space group, but is not sensit-
ive to the symmetry translational components. Accordingly, the Patterson map
symmetry must be symmorphic; since the Patterson function is always cs., its
symmetry group will coincide with the Laue group of the ρ(r) space group.
y
x
100
80
60
40
20
0
0
20
40
60
80
100
y
x
100
80
60
40
20
0
0
20
40
60
80
100
v
u
100
80
60
40
20
0
0
20
40
60
80
100
(a)
(b)
(c)
Fig. 10.3
a) Schematic two-dimensional structure,
plane group pg, consisting of three
symmetry-independent atomic positions
(one S and two O). b) Patterson map of
the structure in a). c) The Is (r) function,
for s = 2, as deﬁned by equation (10.8).
By courtesy of Rocco Caliandro.
We stressed in Section 10.2.2 that the unit cell parameters and type (prim-
itive or centred) do not change, passing from ρ(r) to P(u). Accordingly, the
Patterson maps will show one of 24 symmetry groups; e.g.
P2, P21, . . . , P21/c all reduce to P2/m;
C2, Cc, . . . . , C2/c all reduce to C2/m;
P212121, Pca21, . . . . , Pbca all reduce to Pmmm.
The reader will easily verify that, for the two-dimensional electron density map
shown in Fig. 10.3a (plane group pg), the Patterson symmetry is p2mm.
An important consequence of the symmetry is the existence of interatomic
vectors between the atom in ri and its symmetry equivalents, say, the vec-
tors rj −Csrj = (I −Cs)rj = (I −Rs)rj −Ts. These are called Harker vectors
(Harker, 1936), which lie in special sections of the unit cell called Harker sec-
tions, and may therefore be easily recognized. In Table 10.1, we show, for some
space groups, the relations between positional vectors and Harker vectors.
By generalizing the data in the last column of Table 10.1, the reader can eas-
ily verify that, if the rotational component of C represents symmetry operators
¯1, ¯3, ¯4, ¯6, then the three coordinates of r may be derived from u without ambi-
guity; if it represents symmetry operators 2, 3, 4, 6 (or corresponding screw
axes), one component of r remains undeﬁned; if C represents the operator ¯2
(or corresponding glide planes), two coordinates remain undeﬁned. In space
groups like P21/c or P212121, where more Harker sections coexist and inter-
sect with each other, the (rj)est can be combined, so providing an unambiguous
deﬁnition of rj.
Harker sections and Harker peaks are therefore an important key to passing
from the Patterson map to the electron density map. They also have another
important property worthy of mention: the Fourier transform of a Harker
section provides a direct estimate of one-phase s.s.s (Ardito et al., 1985;
Cascarano et al., 1987c; see Appendix 10.B).
10.3
Deconvolution of Patterson functions
Shortly, we will describe some methods for Patterson deconvolution: the
heavy-atom method, the method of implication transformations, and superpos-
ition techniques.

Deconvolution of Patterson functions
219
Table 10.1 In a given space group (Sp.Gr), rj and Crj are the positional vectors of the jth atom and of its symmetry equivalent in the
unit cell, (uj, vj, wj) are the coordinates of the corresponding Harker vector, uj = (rj −Crj) = (I −C)rj = (I −R)rj −T) in P(u), HS is the
corresponding Harker section. In the last column, (rj)est is the rj estimate which may be obtained from uj; the bar indicates that no information
on the corresponding coordinate is obtained
Sp. Gr.
rj
Crj
uj
HS
(rj)est
P¯1
xj, yj, zj
¯xj, ¯yj, ¯zj
2xj, 2yj, 2zj
u, v, w
uj/2, vj/2, wj/2
P2
xj, yj, zj
¯xj, yj, ¯zj
2xj, 0, 2zj
u, 0, w
uj/2, −, wj/2
P21
xj, yj, zj
¯xj, yj + 1/2, ¯zj
2xj, 1/2, 2zj
u, 1/2, w
uj/2, −, wj/2
Pc
xj, yj, zj
xj, ¯yj, zj + 1/2
0, 2yj, 1/2
0, v, 1/2
−, vj/2, −
P21/c
xj, yj, zj
¯xj, yj + 1/2, ¯zj + 1/2
2xj, 1/2, 2zj + 1/2
u, 1/2, w
uj/2, −,
 wj
2 −1
4

¯xj, ¯yj, ¯zj
2xj, 2yj, 2zj
u, v, w
uj/2, vj/2, wj/2
xj, ¯yj + 1/2, zj + 1/2
0, 2yj + 1/2, 1/2
0, v, 1/2
−,

 vj
2 −1
4

, −
P212121
xj, yj, zj
¯xj + 1/2, ¯yj, zj + 1/2
2xj + 1/2, 2yj, 1/2
u, v, 1/2
 uj
2 −1
4

, vj
2 , −
¯xj, yj + 1/2, ¯zj + 1/2
2xj, 1/2, 2zj + 1/2
u, 1/2, w
uj
2 , −,
 wj
2 −1
4

xj + 1/2, ¯yj + 1/2, ¯zj
1/2, 2yj + 1/2, 2zj
1/2, v, w
−,

 vj
2 −1
4

, wj
2
10.3.1 The traditional heavy-atom method
In Table 10.1, we showed how to construct the Harker vector uj = (I −C)rj ≡
(uj, vj, wj) given the atomic position (xj, yj, zj). The question we answer in this
section is: given the Harker vector uj corresponding to the distance between
two symmetry equivalent atoms, can we then return to (xj, yj, zj)? In the last
column of Table 10.1, we showed that, from uj, only (rj)est can be derived, for
which, often, one or two coordinates are not ﬁxed. We will show how such an
ambiguity may be overcome by giving some examples.
In Section 10.2.2, we stated that the height of the Patterson peak in u is
proportional to the product of the atomic numbers of the two atoms i and j
with interatomic vector u:
P(u) ∝ZiZj.
If both i and j correspond to heavy atoms, then P(u) may be much larger than
other Patterson peaks. The same conclusion holds if i and j are heavy atoms
and are symmetry equivalent. Suppose now that in the unit cell, space group
P¯1, there are two bromine atoms (Z = 35), referred by an inversion centre,
and many O and C atoms. The Harker peak Br–Br will be proportional to
1225, while peaks Br–O, Br–C, O–O, and O–C will be proportional to 280,
210, 64, and 36, respectively. In this case the Harker peak Br–Br would be
easily recognized; from its coordinates (u, v, w), the Br position is completely
deﬁned. Indeed, according to the last column of Table 10.1, the Br coordinates
in the electron density map will be (u/2, v/2, w/2).

220
Patterson methods and direct space properties
In P21, the Harker peak Br–Br will have coordinates of type (u, 1/2, w),
from which the x and z Br coordinates may be derived (see the last column of
Table 10.1): y, however, can lie everywhere between 0 and 1. Since the origin
of the unit cell may ﬂoat freely along y, we can arbitrarily ﬁx y = 0, thereby
simultaneously ﬁxing the Br position without ambiguity. The same should
occur in Pc, where we cannot derive, from the Harker peak at (0, v, 1/2), the
Br x and z coordinates. Luckily, in Pc, the origin can ﬂoat freely in the plane x,z
and may be arbitrarily ﬁxed; accordingly, the Br position may be ﬁxed without
ambiguity.
In P1, the coordinates (x, y, z) can ﬂoat freely along the three directions;
therefore the ﬁrst atomic position can be arbitrarily ﬁxed (for example, in
(0, 0, 0)).
In the above cases, ﬁxing the free Br coordinates simultaneously ﬁxes the
origin; therefore, if a second heavy atom is present in the structure, the choice
to arbitrarily ﬁx its ﬂoating coordinates is not allowed. They should be referred
to the origin ﬁxed by the ﬁrst Br through the use of interatomic vectors.
The procedure so far described works in the following way: look for the
outstanding Harker peaks and derive the heavy-atom coordinates. Some auto-
matic Patterson search programs work in a reverse way. They consider each
grid point in the asymmetric unit of the crystal to be a possible heavy-atom
site, and compute a score, based on the corresponding Harker peak densities
(the Harker peaks may lie on different Harker sections if the symmetry is suf-
ﬁciently rich). The value of the calculated score is associated with the grid
point: at the end of the process a map similar to an electron density map is
obtained; this can then be used to locate the heavy atoms. When more than one
heavy atom needs to be located, Patterson interatomic vectors should be used
to deﬁne the heavy-atom substructure.
In both procedures, once the heavy-atom substructure model has been ﬁxed,
EDM procedures (like those described in Chapter 8) are started, to recover the
full structure.
10.3.2 Heavy-atom search by translation functions
The basic technique is part of a molecular replacement approach and is
described in Section 13.7. In a naive way, a single heavy atom is translated
throughout the asymmetric unit; for each point, the structure factor of the heavy
atom is calculated (say Fp) and the correlation coefﬁcient between |F|2 and
|Fp|2 is computed (we denote this as C(|F|2,|Fp|2), but also, C(|E|2,|Ep|2) may
be used if normalized structure factors are preferred). It may be expected that
the target function C(|F|2,|Fp|2) is a maximum for the correct position of the
heavy atom.
In practice, such calculations will be very time consuming for macromolec-
ules. Luckily, C(|F|2,|Fp|2) and C(|E|2,|Ep|2) may be calculated using fast
Fourier transform (Fujinaga and Read, 1987; Navaza and Vernoslova, 1995) in
a few seconds, even in the case of large proteins and large numbers of heavy-
atom sites (Grosse-Kunstleve and Brunger, 1999; Vagin and Tepliakov, 1998).
If more than one heavy atom is to be located, the technique does not change

Deconvolution of Patterson functions
221
signiﬁcantly; the only difference being that the calculated structure factor
includes a contribution from the previously accepted sites.
If the space group is P1, in accordance with the observations made in
Section 10.3.1, the ﬁrst heavy atom may be arbitrarily located, and the
heavy-atom search starts from the second.
10.3.3 The method of implication transformations
The naive heavy-atom approach described in Section 10.3.1 is not normally
sufﬁcient for solution of complex structures. The implication transformation
approach (Buerger, 1946; Beevers and Robertson, 1950; Clastre and Gray,
1950; Garrido, 1950), strictly in relation to heavy-atom techniques, is more
efﬁcient and allows complete automation of the Patterson deconvolution
procedure.
In Section 10.2.3, we showed that any generic point r of the unit cell may
be transformed into a Harker vector u, by applying the transformation
u = (r −Cr) = (I −C)r = (I −R)r −T.
(10.7)
For example, in P21, where
I −R =
							
2
0
0
0
0
0
0
0
2
							
,
T =
							
0
1/2
0
							
,
the vector r = (0.12, 0.28, 0.15) is transformed by (10.7) into u = (0.24, 0.5,
0.30). The transformation is from many to one; indeed, all of the points r =
(0.12, y, 0.15) are transformed into the same Harker point, u = (0.24,
0.5, 0.30). Conversely, from u it is possible to return to points r (see the last
column in Table 10.1), even if with ambiguity about the y position; this is
what in crystallography is called an implication transformation. More spe-
ciﬁcally, an implication transformation, Is (r), is a function which transforms
the Patterson density in u = r −Csr, belonging to the Harker section deﬁned
by the symmetry operator Cs, into electron densities for appropriate points r,
deﬁned by (10.8):
Is(r) = P(r −Csr)

ns,
(10.8)
where ns is the multiplicity of the Harker vector, i.e. the number of symmetry
operators that generate the given Harker vector.
In practice, an implication transformation tries to reconstruct the electron
density in the unit cell, starting from the densities in the Harker sections.
To give a practical example, if the target structure space group is P21, and
if a Harker peak lies in u = (0.24, 0.5, 0.30), the implication transformation
associates the same Harker intensity with the set of points r = (0.12, y, 0.15),
a column parallel to the y- axis.
In order to fully exploit the symmetry, the concept of symmetry min-
imum function (SMF) is introduced. Suppose that in P222, three Harker peaks
(belonging to three different Harker sections) lie at
u1 = (0.0, 0.44, 0.30),
u2 = (0.24, 0.0, 0.30),
u3 = (0.24, 0.44, 0.0).

222
Patterson methods and direct space properties
The corresponding intensities are transferred to the three columnar sets,
r1 = (x, 0.22, 0.15),
r2 = (0.12, y, 0.15),
r3 = (0.12, 0.22, 0.0)
(10.9)
respectively. Let us now apply the symmetry minimum function,
SMF(r) =
m
Min
s=1 [Is (r)],
(10.10)
where the minimum operator, Min, indicates that the lowest value among the
m functions Is(r) has been chosen, and m is the number of independent Harker
domains in the Patterson map.
The reader will notice that, in the case where no symmetry is present (i.e.
space group P1), the SMF map coincides with the Patterson map itself.
If we apply equation (10.10) to the above P222 example, SMF is different
from zero only in r = (0.12, 0.22, 0.15); all of the other points belonging to
sets (10.9) have vanishing intensity.
It seems, from the previous results, that the implication transformation
approach can deﬁnitively solve the phase problem, at least in those favour-
able cases in which Patterson peaks do not overlap and more Harker sections
exist. Unfortunately, there are several supplementary sources of ambiguity. The
ﬁrst is trivial: in the above P222 example, the peak r = (0.12, 0.22, 0.15) will
be correctly identiﬁed only if the Harker vectors are not affected by resolu-
tion bias (see Section 7.3.1) or by peak overlapping effects; both may shift the
Harker peaks from the ideal positions. The second source of ambiguity con-
cerns the cs. nature of the Patterson. When the space group is acentric, how
can the enantiomorph be automatically deﬁned from the (centric) Patterson
map? Evidently, in a SMF map, there are residual cs. features which should be
cancelled by suitable ﬁltering approaches.
The third source of ambiguity arises from the following question: a structure
is deﬁned with respect to a given origin. How may the diffraction amplitudes
used to calculate the Patterson map, which are structure invariants, automat-
ically determine the origin? Evidently, the SMF must present an ambiguity
on the origin (see Chapter 3). The reader can immediately verify that in
P21, if a Harker vector lies at u = (0.24, 0.5, 0.30), not only is the column,
r = (0.12, y, 0.15), but also the columns,
r = (0.12 + 1/2, y, 0.15 + 1/2),
r = (0.12, y, 0.15 + 1/2),
r = (0.12 + 1/2, y, 0.15),
are compatible with the Harker vector u. This ambiguity arises from the set
of permissible origins deﬁned in Section 3.4. In short, the electron density
map created by the function Is(r) in P21 is of a columnar type, and shows
a pseudotranslational symmetry in the plane perpendicular to y, ﬁxed by the
allowed origin translations.
The origin ambiguity may be arbitrarily resolved by the crystallographer
through choosing one of the allowed origins; but this only holds for the position
of the ﬁrst atom.
To represent the above mentioned problems graphically, we reconsider
the schematic two-dimensional structure shown in Fig. 10.3a, with unit cell

Deconvolution of Patterson functions
223
parameters a = 20 Å, b = 20 Å, plane group pg (equivalent positions (x,y),
(−x, y + 0.5)). There are three independent atomic positions: the sulphur S at
(0.1, 0.1), the oxygen O1 at (0.16, 0.30), and the oxygen O2 at (0.30, 0.18).
For the Patterson map shown in Fig. 10.3b, the Harker vectors are of type
u = (2x, 0.5), and therefore the Harker section is the line v = 0.5. The
heaviest maximum in the Harker section corresponds to the S–S interatomic
vector, uS−S = (0.2, 0.5) (and to its cs. Harker vector with coordinates (0.8,
0.5); the Harker peaks corresponding to uO1−O1 = (0.32, 0.50) and to uO2−O2 =
(0.6, 0.5) (and to their cs. vectors) show lower density.
According to Table 10.1, (rS)est = (0.1, y); this corresponds to a strong two-
dimensional column marked by an arrow in Fig. 10.3c. Of the other three high
intensity columns, one is cs. to the column (0.1, y), the other two are due to
origin ambiguity. It is also easy to identify in Fig. 10.3c the columns corres-
ponding to (rO1)est and to (rO2)est, and the supplementary columns related to
them. The columnar nature of the I(r) map, as deﬁned by equation (10.8), is
now clearly understandable.
The position of the S atom may be arbitrarily chosen at any point in the four
strong columns; this choice simultaneously deﬁnes the origin of the model
electron density map. The O positions remain conﬁned to suitable columns of
the I(r) map, but they cannot be arbitrarily assigned; non-Harker peaks relating
the oxygens to the sulphur should be considered.
In conclusion, the SMF map contains an image of the target structure, but it
is frequently immersed in huge noise, created by:
(i) the intrinsic nature of the implication transformation (from one Harker
vector u to many points r);
(ii) the residual Patterson symmetry;
(iii) Harker peak intensities (frequently affected by peak overlapping) trans-
ferred without ﬁltering to the SMF peaks;
(iv) resolution bias and peak overlapping effects.
To reduce the noise and recover the target structure, supplementary tools may
be necessary, one of which may be identiﬁed in the superposition techniques.
10.3.4 Patterson superposition methods
We will now describe the overlapping of shifted Patterson maps with the SMF
function. To simplify our treatment, let us assume that the target structure con-
tains N atoms, NH of which are heavy atoms, deﬁned by the positional vectors,
rHi, i = 1, . . . , NH; rlν, for ν = NH + 1, . . . , N are the positional vectors of
the light atoms. For ideal diffraction data, Patterson peak positions will be the
union of the following three sets:

rHi −rHj, i, j = 1, . . . , NH

(10.11a)
{±(rHi −rlν) i = 1, . . . , NH, ν = NH + 1, . . . , N}
(10.11b)

rlν −rlμ, ν, μ = NH + 1, . . . , N

.
(10.11c)
In turn, these correspond with heavy–heavy, heavy–light, and light–light atom
distances.

224
Patterson methods and direct space properties
Suppose now that the position, rHq of the qth heavy atom has been found
by application of the SMF function. Let us now shift the Patterson map by a
vector, rHq; we will denote this shifted map as P(u −rHq). Such a shift should
generate a noised image of the structure. Indeed the following peak sets arise:

rHi −rHj + rHq, i, j = 1, . . . , NH

(10.12a)

±(rHi −rlν) + rHq, i = 1, . . . , NH, ν = NH + 1, . . . , N

(10.12b)

rlν −rlμ + rHq, ν, μ = NH + 1, . . . , N

.
(10.12c)
Emphasizing the case j = q for subset (10.12a) and the case i = q for subset
(10.12b), allows us to rewrite the peaks (10.12) as,

rHi, i = 1, . . . , NH, rHi −rHj + rHq, i, j = 1, . . . , NH, j ̸= q

(10.13a)

rlν, ν = NH + 1, . . . , N, ±(rHi −rlν) + rHq, i = 1, . . . , NH, ν = NH + 1, . . . , N

,
(10.13b)

rlν −rlμ + rHq, ν, μ = NH + 1, . . . , N

(10.13c)
Let us now overlap the peaks (10.13) with the SMF map (which, as we know,
contains an image of the target structure) and take the minimum; this corres-
ponds with the minimum superposition function (Buerger, 1951, 1953; Taylor,
1953),
MS(r) = Min

P(u −rq), SMF(r)

.
(10.14)
MS(r) would provide: the heavy atom substructure, {rHi, i = 1, . . . , NH} plus
noise from peaks (10.13a), the light atom positions, {rlν, ν = NH + 1, . . . , N}
plus noise from the set (10.13b), and only noise from the set (10.13c). As a
result, the superposition approach leads to an image of the structure, say,
{rHi, i = 1, . . . , NH}

{rlν, ν = NH + 1, . . . , N},
plus noise; the noise has to be minimized via suitable ﬁltering procedures
followed by EDM cycles.
Simple control of the above vectorial algebra is achieved, using the example
illustrated in Fig. 10.3. Let us suppose that the S position has been ﬁxed via
SMF; without loss of generality we have located it at the correct position,
say (0.1, 0.1). In Fig. 10.4a, we show the Patterson map shifted by the vec-
tor rHq = (0.1, 0.1), and in Fig. 10.4b, the minimum superposition function
MS, as given by equation (10.14). The result may be summarized as follows:
the target structure is located correctly, but some noise (e.g. spurious peaks)
is present. Proper ﬁltering algorithms and EDM techniques should be used to
eliminate the noise.
y
x
100
80
60
40
20
0
0
20
40
60
80
100
y
x
100
80
60
40
20
0
0
20
40
60
80
100
(a)
(b)
Fig. 10.4
For the example depicted in Fig. 10.3:
a) Patterson map shifted by the vec-
tor rHq = (0.1, 0.1); b) superposition map
according to equation (10.14) (in prac-
tice, obtained by overlapping Fig. 10.4a
with Fig. 10.3c). By courtesy of Rocco
Caliandro.
Superposition techniques may be generalized in several ways (Raman and
Lipscomb, 1961):
(i) By calculating the more general minimum superposition function,
MS(r) = Min

P(u −rq), P(u −rp), . . . , SMF(r)

,
(10.15)

Deconvolution of Patterson functions
225
where rq, rp, . . . , etc. are atomic positions, previously deﬁned. The use
of (10.15) may reduce the residual noise still present in (10.14), but
presents an additional risk; the ﬁnal expected signal (that is, the image of
the structure) may be very imperfect, because Patterson peaks are often
displaced from their correct positions, and perfect overlapping of the dis-
placed Patterson peaks on the atomic sites is impossible. In short, MS(r),
as given by (10.15), may be too discriminating; it will vanish in r if one of
the overlapping maps has, by chance, a very low peak density value in r.
(ii) By calculating the sum function,
SS(r) = SMF(r) +

i P(u −ri),
(10.16)
where the sum goes over the located atomic positions.
SS(r) may easily be calculated by using the relation,

i P(u −ri) = 1
V

h |Fh|2 exp [−2πi h · (u −ri)]
= 1
V

h |Fh|2 exp −(2πi h · u)

i exp(2πi h · ri)

.
If we rewrite

i exp(2πi h · ri) = m exp(iψh),
then,

i P(u −ri) = 1
V

h mh|Fh|2 exp −(2πi h · u + ψh).
SS(r) tends to have a low discriminatory power; if one of the maps has
a high density value in r, but the others are vanishing in r, then the map
may show a peak where there is none.
(iii) By calculating the product function,
PS(r) = SMF(r) ·

i P(u −ri)

.
(10.17)
PS(r) is the most vigorous; the density at a point r is zero if one of the maps
vanishes at that point, but it may show exceptional values if two maps are
strong in r.
MS(r) is the most popular technique and is frequently used in modern
Patterson deconvolution programs. The harmonic mean (reciprocal of the mean
of the reciprocals of the density values) seems to be the medium choice
amongst the three.
10.3.5 The C-map and superposition methods
Let us suppose that a model structure, ρp(r), is known; one could be interested
in the convolution,
C(u) = ρ(r) ⊗ρp(r) =

S
ρ(r)ρp(r + u)dr,
(10.18)
which, by the properties of the Fourier transform, may be written as,
C(u) = 1
V

h |FhFph| exp i(φh −φph) exp(−2πi h · u),
(10.19)

226
Patterson methods and direct space properties
where Fh = |Fh| exp(iφh) and Fph = |Fph| exp(iφph) are the structure factors of
ρ(r) and ρp(r), respectively. |FhFph| exp i(φh −φph) is the Fourier coefﬁcient
of C(u) and is a complex number; therefore C(u) is acentric, it is centric only
if both ρ(r) and ρp(r) are centric. It was shown by Carrozzini et al. (2010) that
the space group of the C-function is the symmorphic variant of the space group
of the target structure (e.g. P222, if the target space group is P212121).
The map, C(u), cannot be computed during the phasing process, essentially
because the φhs are unknown. Fortunately, the approximating function C′(u),
given by
C′(u) = 1
V

h mh|FhFph| exp(−2πi h · u),
(10.20)
is easily computable, where,
m = < cos(φ −φp) > = I1(X)/I0(X)
and (see Section 7.2)
X = 2σA|EEp|/

1 −σ 2
A

.
C′(u) is a useful approximation to C(u) if the mh values are sufﬁciently large.
The approximation has a principal consequence in that the Fourier coefﬁcients
of C′(u) are real numbers, consequently, the space group of C′(u) is centric,
so coinciding with the Patterson space group (e.g. Pmmm if the space group of
the target is P212121).
Carrozzini et al. (2010) observed that both ρ(r) and ρp(r) are non-negative
deﬁnite functions, therefore, C(u) and C′(u) are both non-negative deﬁnite.
The map, C′(u), may therefore be suitably modiﬁed and Fourier inverted, as
in the usual EDM procedures (see Chapter 8), so leading to better estimates of
the invariants (φh −φph). Also (Caliandro et al., 2013), C′(u) may be combined
with vector superposition techniques, as follows.
Let us suppose that a model is available, consisting of one heavy atom loc-
ated at rHq (e.g. obtained via the study of the SMF function). If m is a good
approximation of cos(φ −φp) for a sufﬁciently large set of reﬂections (for the
moment we will assume that this condition is satisﬁed), then the C′ peaks will
be located at (with the notation used in the Section 10.3.3)

rHi −rHj, i, j = 1, . . . , NH

∪{± (rlν −rHi), j = 1, . . . , NH, ν = NH + 1, . . . , N}
(10.21)
By adding the heavy atom position, rHq, to the interatomic vectors in (10.21),
we obtain

rHi, i = 1, . . . , NH, rHi −rHj + rHq, i, j = 1, . . . , NH, j ̸= q

,
(10.22a)

rlν, ν = NH + 1, . . . , N; ±(rlν −rHi) + rHq, i = 1, . . . , NH, i ̸= q, ν = NH + 1, . . . , N

.
(10.22b)
Let us compare the sets (10.22), obtained by use of the C′ map, with the sets
(10.13), obtained using the P map:
(i) (10.22a) and (10.22b) coincide with (10.13a) and (10.13b). Therefore,
both set (10.22a) and set (10.13a) provide the atomic positions of the full
target structure, with the same amount of noise.

Applications of Patterson techniques
227
(ii) The noise (10.13c) has no correspondent if the C′-map is used. This prop-
erty may be very important when the target structure contains a large
number of light atoms, as frequently occurs in medium-sized structures
and proteins.
This superior characteristic of the C′ map requires that one condition should
be satisﬁed: i.e. that C′ is a good approximation of C, and this occurs only if
the model is sufﬁciently good. In practice, m is only a statistical estimate of
cos(φ −φp); therefore, the light atoms–light atoms peaks may be present in
the C′ map, but their intensity is expected to be smaller compared with the
corresponding peaks in the Patterson map. A further property makes use of the
C′ map more interesting. While the Patterson map is invariant during the phas-
ing process, the C′ map changes with the current model. This characteristic is
crucial for successful crystal structure determination.
10.4
Applications of Patterson techniques
Any description of a phasing approach should always be followed by some
detail about its practical efﬁciency, in order to orient the potential user towards
the most appropriate choice of phasing method. The short report below
excludes examples of protein substructure solution in SIR-MIR and SAD-MAD
cases, which are delayed until Chapters 14 and 15.
There has recently been a strong renewal of interest in Patterson decon-
volution techniques, as described in Section10.3; new approaches have been
applied to a wide set of experimental data under different situations. For
example, to powder diffraction data (Burla et al., 2007a), to ab initio crystal
structure solution of proteins (Burla et al., 2006a; Caliandro et al., 2007a,b,
2008a,b), to protein substructure solution in SAD-MAD cases (Burla et al.,
2007b). The reader is referred to the original papers for details of the
algorithms and experimental results. Here, we will merely summarize some
of the above applications, to emphasize the versatility of these methods.
1. Ab initio applications of Patterson superposition techniques to proteins.
To collect the results in a few lines, we divide the test structures into suit-
able subsets, in order to study the potential of the techniques versus the size,
resolution, and type of heavy atom included within the structure. For each
subset we give the average cpu time (<cpu>) necessary to obtain the solu-
tion (naturally, the time refers to solved structures) using a common desk
computer.
(a) 23 test structures with RES <1.2 Å, number of non-H atoms in the
asymmetric unit (Nasym) up to about 2000, an atomic species heavier
than Ca. All structures solved, <cpu> = 6.8 min.
(b) 31 test structures with RES <1.2 Å, Nasym up to about 2000, no atomic
species heavier than Ca. All structures solved, <cpu> = 16.6 min.
(c) 20 test structures with 1.2 Å < RES <1.7 Å, Nasym up to about 2000,
heavy atoms from S to Br. Four structures, with RES between 1.3 and
1.7 remain unsolved.

228
Patterson methods and direct space properties
(d) 20 test structures with RES <1.2 Å, 2000 <Nasym < 6300, and atomic
species from Ca up. Three structures remained unsolved, all with Ca as
heaviest atom.
(e) 32 test structures, with 1.5 Å < RES <1.7 Å, Nasym < 8000, and atomic
species from Fe up. All 19 structures up to 1.7 Å resolution (including
1e3u, a large protein with about 8000 atoms in the asymmetric unit and
RES = 1.65 Å, and seven proteins with RES between 1.7 and 1.9 Å)
could be solved.
2. Patterson superposition techniques and superposition techniques combined
with the C′ map. Such a technique has recently been applied (Caliandro
et al., 2013) to a total of 186 test structures, with up to about 350 atoms
in the asymmetric unit. In Table 10.2, the test structures are divided into
subsets, according to the number of non-hydrogen atoms in the asymmet-
ric unit (Nasym) and to the heaviest atomic species (L stands for ‘all light
atoms’, H for if some heavy atoms are present): for practicality, an atom is
considered heavy if its atomic number is larger than that of Ca.
In Table 10.2, we also show the average phasing efﬁciencies of two deconvo-
lution methods, the ﬁrst C′-based (as described in Section 10.3.4), the second
Patterson-based (as described in Section 10.3.3). For each structure subset,
EffC′ and EffP are the ratio
(number of structures solved in default conditions)/(number of structures)
when the C′-based and the Patterson-based algorithms are used, respectively.
The deconvolution algorithm based on the C′ map is more efﬁcient than
that based on the Patterson map for structures having only light atoms, and
in particular for difﬁcult cases (i.e. for structures with Nasym >150). If heavy
atoms are present, both algorithms work to full efﬁciency.
In Fig. 10.5, we show, for the C′-based algorithm and for H and L subsets,
the cpu time necessary to reach a solution (t in minutes), versus the aver-
age values of Nasym (<Nasym>). The averages have been calculated over the
test structures contained in each of the four subsets considered in Table 10.2.
We observe that, for structures containing heavy atoms, the solution is very
soon attained, indicating that the true heavy atom position is always found in
Table 10.2 The test structures are grouped according to the number of
non-H atoms in the asymmetric unit (Nasym) and the presence or absence of
atoms heavier than calcium (H/L). Entries correspond to: number of struc-
tures in each class (Num), phasing efﬁciencies of the C′-based (EffC′), and
of the Patterson-based deconvolution (EffP) algorithms
H
L
Num
EffC′
EffP
Num
EffC′
EffP
Nasym ≤20
23
100
100
14
100
100
20 < Nasym ≤80
21
100
100
45
100
96
80 < Nasym ≤150
14
100
100
46
100
93
Nasym > 150
4
100
100
21
90
81

Applications of Patterson techniques
229
14
L
H
12
10
t
8
6
4
2
0
0
50
100
150
<Nasym>
200
250
300
Fig. 10.5
For H- and L-structures we show, versus
<Nasym>, the cpu time (t, in minutes)
needed to reach the solution (see text for
details).
the very early stages of the phasing procedure. In this case the efﬁciency of the
deconvolution algorithm does not depend on the size of the structure.
For structures containing only light atoms, the cpu time increases strongly
with structure complexity, much more rapidly than for heavy atoms, indicating
that locating light atoms in their true positions by superposition techniques
becomes more challenging as the size of the structure increases.
The subset of structures with Nasym >150 contains various structures for
which O is the heaviest atom. The success of superposition methods dramatic-
ally changes common judgement on the versatility of Patterson techniques.
In the International Tables for Crystallography, volume B, Rossmann and
Arnold (1993), write:
The feasibility of structure solution by the heavy-atom method depends on a
number of factors which include the relative size of the heavy atom and the
extent and quality of the data. A useful rule of thumb is that the ratio
r =

heavy
Z2

light
Z2
should be near unity if the heavy atom is to provide useful starting phase
information (Z is the atomic number of an atom). The condition that r >1
normally guarantees interpretability of the Patterson function in terms of the
heavy atom positions.
The authors also state that the rule is rather conservative and quote as an
outstanding example, vitamin B12 with formula C62 H88 Co O14 P (Hodgkin
et al., 1957) which gave r = 0.14 for the cobalt atom alone.
The above results indicate that there has been great progress in Patterson
deconvolution techniques over the last few years; heavy atoms are no longer
strictly necessary to the success of Patterson or C′ based procedures, which
may also be successfully applied to structures with atoms not heavier than
oxygen. Accordingly, Patterson and C′-map techniques are probably the

230
Patterson methods and direct space properties
most versatile ab initio phasing methods, given the ability to solve small
and medium-sized structures and proteins, with relaxed limits on size and
resolution.
APPENDIX 10.A
ELECTRON DENSIT Y AND PHASE
REL ATIONSHIPS
This subject will be treated in a very short digest, since most of the mentioned
phase relationships are not particularly in use today; the interested reader will
ﬁnd a more substantial account in Phasing in Crystallography. We will discuss
techniques as follows:
1. Sayre–Hughes equation. Let the electron density, ρ(r), be composed of
identical atoms which are fully resolved from one another. Then, ρ2(r) may
be expanded in the Fourier series
ρ2(r) = 1
V
+∞
h = −∞2Fh exp(−2πi h.r),
(10.A.1)
where 2Fh represents the Fourier coefﬁcient of the expansion (10.A.1).
If ρ(r) is non-negative everywhere, ρ(r) and ρ2(r) are very similar, but not
equal (see Fig. 10.A.1); indeed, they show maxima at the same positions,
but different peak shapes. If s = 2 sin θ/λ, the following relationships hold:
Fh = fs
N
j=1 exp

2πih · rj

,
2Fh = 2fs
N
j=1 exp

2πih · rj

,
x
ρ 3
0
x
ρ 2
0
x
ρ
0
Fig. 10.A.1
A one-dimensional electron density dis-
tribution and its ﬁrst powers.
where 2 fs is the scattering factor of the squared atom. When the two
equations are divided term by term,
2Fh = 2 fs
fs
Fh = βhFh
(10.A.2)
is obtained, and βh appears as a function only of the parameter s.
On the othe side, ρ2(r) = ρ(r) · ρ(r), and its Fourier transform, because
of the convolution theorem, will be
2Fh = 1
V
+∞
k=−∞FkFh−k.
(10.A.3)
Combining (10.A.2) and (10.A.3) gives
Fh =
1
Vβh
+∞
k=−∞FkFh−k.
(10.A.4)
Equation (10.A.4) is the Sayre–Hughes equation (Sayre, 1952; Hughes,
1949), from which a tangent expression may be derived relating φh to
the phases φk + φh−k. However, both (10.A.4) and the related tangent for-
mula are asymptotical relationships, i.e. they may only be applied under
the condition that the summations are carried out over an inﬁnite number of
reﬂections; no reliability parameter is provided. This requirement restricts
the use of (10.A.4) in practical procedures, where φh is usually evaluated
from a limited number of known phases.

Electron density and phase relationships
231
2. Von
Eller
polynomial
method.
(von
Eller,
1973)
Let
ρ(r) =
< Eh exp (−2πi h.r)> be the electron density, Z the atomic number of
the unique atomic species present in the crystal and σ2 = N
j=1 Z2
j = NZ2.
Then the relation
ρ

ρ −Z/σ 1/2
2

= ρ

ρ −1/
√
N

= 0
(10.A.5)
is identically satisﬁed for all values of r; in fact, at any point in the unit cell
at least one of the two factors on the left-hand side of (10.A.5) is zero. The
Fourier transform of (10.A.5) gives
Eh =
√
N <EkEh−k >,
strictly related to the Sayre–Hughes equation.
Equation (10.A.5) may easily be extended to the case in which there are
n different atomic species via the polynomial,
ρ

ρ −Z1/σ 1/2
2

ρ

ρ −Z2/σ 1/2
2

, . . . . . . . . . . , ρ

ρ −Zn/σ 1/2
2

= 0
(10.A.6)
The Fourier transform of (10.A.6) involves triplets, quartets, etc.
3. Cochran integral criterion. Cochran (1952) argued that the integral

V
ρ3(r)dr = 2
V

h1,h2 |Fh1Fh2Fh1−h2| cos(φh1 −φh2 −φh1−h2)
(10.A.7)
should be a maximum for the correct structure; this occurs when, for large
values of |Fh1Fh2Fh1−h2|, the triplet phase φh1 −φh2 −φh1−h2 is close to
zero. Clearly, (10.A.7) also leads to a tangent formula expression.
4. Allegra
and
Colombo
integral
criterion.
Allegra
and
Colombo
(1974) observed that the difference between the real and the squared
structure must approach zero for the correct phase set obtained in a
multisolution procedure. In formula,

V
ρ2(r)
I2
−ρ(r)
I1
2
dr ≈min,
(10.A.8)
where
In =

V
ρn(r)dr.
Equation (10.A.8) leads to a tangent formula in which φh1 is determined by
means of triplet and quartet relationships.
5. Rius and Miravittles criterion. Rius and Miravittles (1989) (see also
Giacovazzo, 1991) modiﬁed the Cochran criterion by maximizing the
difference

V
ρ3(r)dr −

V
ρ(r + u0)ρ2(r)dr,
(10.A.9)
where u0 represents a shift approximately equal to the average radius of the
atomic peak (∼0.4–0.5 Å). The second integral on the right-hand side of
(10.A.9) is expected to be small.

232
Patterson methods and direct space properties
6. Karle and Hauptman determinants. Karle and Hauptman (1950) stated that,
as a consequence of the non-negativity property of the electron density,
determinants exist satisfying the relation,
Dn =
											
1
U12
U13
. . .
U1n
U21
1
U23
. . .
U2n
. . .
. . .
. . .
. . .
. . .
Un1
Un2
Un3
. . .
1
											
≥0,
(10.A.10)
where Upq = Uhp−hq are the so-called unitary structure factors, deﬁned by
U = F/(N
j=1 fj).
Dn = 0 when n > N. Since, on varying n from 1 to N, the positiveness of
the Hermitian form (10.A.10) holds, it follows that all the principal minors of
Dn must be positive; conversely, the positiveness of all the principal minors
assures that Dn is positive. In conclusion, if the positiveness of the electron
density function ensures the validity of (10.A.10), the discreteness of the points
with ρ(r) ̸= 0 determines the maximum order of the positive determinants.
Karle Hauptman determinants have been the basis for a probabil-
istic approach proposed by Tsoucaris (1970) (see also Lajzerowicz and
Lajzerowicz, 1966; de Rango et al., 1969, 1974) under the name the maximum
determinant rule. Further advances were achieved by Vermin and de Graaff
(1978), Taylor et al. (1979), de Gelder et al. (1990), and de Gelder (1992), who
successfully applied such methods to the crystal structure solution of small
molecules.
The reader will ﬁnd in Phasing in Crystallography, Chapter 4, more details
on all of the methods mentioned in this appendix.
APPENDIX 10.B
PATTERSON FEATURES
AND PHASE REL ATIONSHIPS
Two methods will be sketched which relate Patterson features to phase
relationships.
(a) High-order Patterson syntheses. An important contribution relating direct-
space properties and reciprocal space relationships has been given by
Vaughan (1958), who introduced the function,
Pn(u1, u1, . . . , un) =

V
ρ(r)ρ(r + u1) . . . . . ρ(r + un)dV,
(10.B.1)
where V is the unit cell volume. When n = 1, function (10.B.1) coincides
with the usual Patterson function and when n = 2 it coincides with the
so-called double Patterson introduced by Sayre (1953) (see also Main,
1993). It may be shown that some sections of the double Patterson deal
with modiﬁed Patterson functions, like

V
ρ2(r)ρ(r + u)dV,
(10.B.2)

Patterson features and phase relationships
233
which, submitted to a Fourier transform, is related to the triplet invari-
ants. The criterion (10.B.2) is exploited directly by a criterion proposed
by Collins et al. (1996).
(b) Estimate of one-phase structure seminvariants from Harker sections.
(Ardito et al., 1985; Cascarano et al., 1987c). In accordance with
Section 4.3, the reﬂection with vectorial index H = ¯h(I −Rs) is a s.s.;
then,
FH =
N

j=1
fj exp

2πi¯h(I −Rs)rj

= exp

2πi¯hTs

N

j=1
fj exp

2πi¯h(I −Cs)rj

.
(10.B.3)
According to equation (10.6), the vectors (I −Cs)rj are Harker vectors and
lie on the sth Harker section, or, in other words, deﬁne the density on the sth
Harker section. In a more general expression we can rewrite (10.B.3) as
FH = 1
L exp(2πi h · Ts)

HS
P(u) exp(2πi h · u)du,
(10.B.4)
where u varies over the complete sth Harker section, and L is a constant which
takes into account the dimensionality of HS. Relation (10.B.4) provides a phase
estimate for the s.s., FH.
The reader will ﬁnd more details on all the methods mentioned in this
appendix in Phasing in Crystallography, Chapter 4.
(a) Patterson synthesis of the second kind. Patterson (1949) deﬁned a second
type of Patterson synthesis, say,
P±(u) =

V
ρ(u + r)ρ(u −r)dr = 2
V

h>0 |Fh|2 cos(4πh · r −2φh).
P±(u) will show a large peak when the product of the densities at u + r and
u −r, integrated over all r values, is large. In this case, u is a pseudo-centre
of symmetry for part (or all) of the electron density; the larger is P±(u), the
larger is the percentage of electron density related by the inversion centre in u.
Since each atom is centrosymmetric in itself, small peaks will be present at the
atomic positions. Small peaks will also be present at midpoints between atoms,
with intensity proportional to the product of the centrosymmetrically shared
part of the two atoms. P±(u) may be trivially used when a centric structure has
been solved in P1 and one wants to recognize the positions of the inversion
centres. It may also be used during a Patterson deconvolution process to check
if the centrosymmetric features of the Patterson function have been eliminated
from the model (Burla et al., 2006b). A large value of P±(u) is some u would
suggest that the enantiomorph has not been well deﬁned.

Phasing via electron
and neutron diffraction
data
11
11.1
Introduction
Among the statistics freely available on the webpage of the Cambridge
Structural Database, there is a detail of interest for this chapter: of the
596 910 crystal structures deposited up to 1 January 2012, only 1534 were
solved by neutron data (see Table 1.11). No information is provided on the
number of structures solved by electron data because it is negligible (organic
samples are soon damaged by the electron beams).
A statistical search of the Inorganic Crystal Structure Database (ICSD,
Ver. 2012–1, about 150 000 entries; by courtesy of Thomas Weirich) on struc-
tures that have been solved by means of electron diffraction, eventually in
combination with other techniques, indicates a total of about 0.7%.
In spite of limited impact on the databases, electron and neutron diffraction
play a fundamental role in materials science and in crystallography. The main
reason is that they provide alternative techniques to X-rays. Let us ﬁrst consider
electron diffraction (ED) techniques.
The study of crystalline samples at the nanometer scale is mandatory for
many industrial applications; indeed, physical properties depend on the crys-
tal structure. Unfortunately it is not unusual for compounds to only exist
in the nanocrystalline state; then, traditional X-ray diffraction techniques for
atomic structure determination cannot be applied, because of the weak inter-
actions between X-rays and matter. As a consequence, such structures remain
unknown, in spite of their technological importance. This limits the contribu-
tion of X-ray crystallography to nanoscience, a growing scientiﬁc area, crucial
to many ﬁelds, from semiconductors to pharmaceuticals and proteins. The res-
ult is a lack of knowledge on the underlying structure–property relationships,
which often retards further research and development.
Structure analysis by electron diffraction began as early as the 1930s (in
particular, by Rigamonti, in 1936), but the interest of the crystallographic
community in such a technique soon faded, mostly because electron diffrac-
tion intensities are not routinely transferable into kinematical |F|2. In spite
of this limitation, the technique has been used for investigating the structure
of many inorganic, organic, and metallo-organic crystals, biological struc-
tures, and various minerals, especially layer silicates. We will therefore, in this

Electron scattering
235
chapter, describe brieﬂy (see Sections 11.2 to 11.7 and Appendix 11.A) the
speciﬁc features of electron scattering, in order to allow the reader to under-
stand the special problems one has to face when direct phasing by electrons
data is attempted. For further reading, the reader is addressed to the IUCr
monograph, Electron Diffraction Techniques, volumes I and II (Cowley, 1992),
with special emphasis on Chapter 6 by Vainshtein, Zuyagin, and Avilov,
also, to a monograph by Dorset (1995) and to the International Tables for
Crystallography, Vol. B (1993) and Vol. C (1992). Probably the most updated
and complete presentation of electron crystallography is the monograph by
Zou, Hovmöller, and Oleynikov (2011).
Let us now consider neutron diffraction. This is advised for when crys-
tal structure solution is attempted in order to obtain details which are not
available via X-ray crystallography (e.g. the accurate positions of H atoms
in organic, inorganic, and biological molecules). Phasing via neutron data is
today common practice, mostly when powder diffraction techniques are used
(see Chapter 12); here, only the aspects concerning single crystals will be
described. Since the application of appropriate phasing techniques requires
a prior knowledge of the neutron scattering mechanism, we brieﬂy recall this
topic in Section 11.8. In Section 11.9, possible violation of the positivity
postulate, which may occur when neutron radiation is used, will be discussed.
11.2
Electron scattering
Electrons are produced in an electron gun by a ﬁlament a few micrometers in
size and they are accelerated through a potential difference of E volts. Their
divergence is restricted to 10–4 rad or less (smaller than for conventional X-ray
sources) by electromagnetic lenses and the spread of wavelengths is small
(10–5 or less) . The wavelength may be calculated as
λ =
12.3
(E + 10−6E2)1/2 .
If high energy electron diffraction (HEED) is used, E ≥100kV (the range may
be extended to 1 MeV) and λ ≤0.05 Å. Since electrons are charged particles,
they are strongly absorbed by matter; therefore, electron diffraction in trans-
mission is applicable only to very thin layers of matter (10–7 to 10–5 cm). While
the electron density distribution is responsible for X-ray scattering, for electron
scattering it is the potential distribution which plays that role. Such a distribu-
tion is the sum of the ﬁeld caused by the nucleus and the ﬁeld caused by the
electron cloud. Two processes contribute to electron scattering:
1. Elastic scattering: the electrons are scattered by the Coulombic potential
due to the nucleus. Since the proton is much heavier than the electron, no
energy transfer occurs.
2. Inelastic scattering: electrons of the primary beam interact with the atomic
electrons and are scattered after having suffered a loss in energy. In a micro-
scope, such electrons are focused at different positions and produce the
so-called chromatic aberration, which causes a blurring of the image.

236
Phasing via electron and neutron diffraction data
The strong scattering of electrons by matter implies some advantages but
also serious hindrances to structure analysis work. If we look to the atomic
scattering amplitudes, f e, f x, f n (for electron, X-ray, and neutron scattering,
respectively), on average f e ∼10–8 cm, f x ∼10–11 cm, and f n ∼10–12 cm.
In terms of intensity, I, the ratios will approximately satisfy the relation,
Ix : Ie : In = 1 : 106 : 10−2.
Minimum specimen thickness for each diffraction technique may be roughly
summarized as follows:
about 0.1 mm for neutron radiation (at SNS, Oak Ridge, USA);
about 0.1 mm for common laboratory X-ray diffractometers, about a few
microns at the Grenoble synchrotron;
about 30 nm for electron diffraction.
The above data suggest that electron diffraction may reduce the most severe
limitations of today’s crystallographic research: crystal sample size and the
necessity for a single chemical phase. For example, the chemical synthesis of
thin ﬁlms and coatings, superconductors, or improved materials for long-life
batteries typically do not yield large single crystals, but rather produce small
grain size multiphase powders. From a report based on data extracted from the
JCPDS-ICDD database, 1997, for a small subset of technologically relevant
substances (by courtesy of Thomas Weirich), it may be estimated that the frac-
tion of unknown crystal structures is about 81% for pharmaceuticals, 65% for
pigments, 67% for general organic compounds, and 33% for zeolites. It can be
envisioned that these large fractions of materials with unknown crystal struc-
ture will decrease considerably if the phasing capacity of electron diffraction
techniques improves.
11.3
Electron diffraction amplitudes
For electron diffraction, the structure factor may be written as
FB
h =
N
j=1 f B
j exp(2πih · rj),
where
f B(s) = 4πK
 ∞
0
ρ(r)r2 sin sr
sr
dr,
(11.1)
s = 4π sin θ/λ,
K = 2πme
h2
,
h is the Planck constant
and ρ(r) is the atomic potential distribution. f B(s) is related to the atomic
scattering factor for X-rays, fx(s), by the Mott–Bethe formula,
f B(s) = Kλ2
ε0
(Z −fx (s)) / sin2 θ,
(11.2)

Non-kinematical character of electron diffraction amplitudes
237
where ε0 is the permittivity of the vacuum. If λ is in Å, f B(s) in Å, and fx in
electron units, (11.2) reduces to
f B(s) = 0.023934λ2 (Z −fx (s)) / sin2 θ.
At low values of s, the Mott–Bethe formula is less accurate; indeed, (Z −fx(s))
vanishes for neutral atoms. In this case, the formula given by Ibers (1958),
f B(0) = 4πme2
3h2
Z

r2
,
(11.3)
may be used, where

r2
is the mean square atomic radius.
The f B(s) values (in Å) are listed in the International Tables for
Crystallography (1992), Vol. C, Table 4.3.11 for all neutral atoms and
most chemically signiﬁcant ions. Most of the values were derived by Doyle
and Turner (1968) using the relativistic Hartree–Fock atomic potential; for
some atoms and ions, f B(s) has been derived using the Mott–Bethe formula
(11.2) integrated with (11.3). Relativistic effects can be taken into account by
multiplying the tabulated f B(s) by m/m0 = (1 −β2)−1/2, where β = υ/c and
υ is the velocity of the electron. In order to obtain the Fourier coefﬁcients of the
potential distribution in volts, f B(s) values (and therefore FB
h values) are usually
multiplied by the ratio 47.87/V, where V is the volume of the unit cell in Å3.
The difference between fx(s) and f B(s) can be schematized as:
1. With increasing s value, f B(s) decreases more rapidly than fx(s).
2. While fx(0) = Z coincides with the electron shell charge, f B(0) is the ‘full
potential’ of the atom. On average, f B(0) ≃Z1/3, but for small atomic
numbers, f B(0) decreases with increasing Z.
3. The scattering factor of ions may be markedly different from a neutral atom;
for small sinθ/λ ranges, f B may also be negative (see Fig. 11.1).
f  B
Br
Br–1
9
8
7
6
5
4
3
2
1
0.1
0.2
0.3
0.4
0.5
–0.1
–230
sin ϑ/λ
Fig. 11.1
Kinematic electron scattering factor f B
for Br and Br–1.
The above features of f B reﬂect the peculiarity of the potential distribution
(Vainshtein, 1964):
(a) The peaks of the atomic potential (being related by Fourier transform to
f B) are more blurred than electron density peaks.
(b) The peak height (that is, the potential in the maximum) is not strongly
dependent on the atomic number. Therefore, light atoms (hydrogen
included) can be revealed in an easier way than via X-ray data. Typical
peak height ratios are
H : C : O : Al : Cu = 35 : 165 : 215 : 330 : 750.
11.4
Non-kinematical character of electron
diffraction amplitudes
Crystal structure analysis via electron diffraction was initiated during the years
1937–8 by a group of crystallographers in the Soviet Union, led by Pinsker
and Vainshtein. Ten years later, Vainshtein and Pinsker (1949) published the
Fourier map of Ba Cl2· · H2O. The same kinematic approach was used by

238
Phasing via electron and neutron diffraction data
Cowley (1953a,b,c; 1955) for solving a small number of structures. Some
years later, Cowley and Moodie (1957, 1959) described the n-beam dynam-
ical diffraction theory which, through multislice calculations, more closely
describes the physical phenomena involved in electron diffraction. Such mod-
els are highly successful in explaining the details of scattering but are, in part,
structure and crystal shape dependent (the observed diffraction pattern does
not contain direct information on the crystal shape); therefore, corrections
eliminating the dynamical effects from the intensities are still not trivial.
The signiﬁcance of dynamical effects, often predominant with respect to
kinematical scattering, has reduced the interest in structure analysis via elec-
tron data. In the following, we summarize qualitatively the components of
electron diffraction amplitudes.
Dynamic scattering. The transition from kinematic to dynamic scattering
occurs when the thickness t of the crystal reaches a critical value for which
λ

<FB
h>
V
 t ≥1.
(11.4)
FB
h
is the structure factor amplitude (ﬁrst Born approximation, see
Appendix 12.A) and V is the volume of the unit cell. Since <|FB
h|> is propor-
tional to Z0.8, condition (11.4) is soon violated for heavy atoms. Even a 50 Å
thickness may be enough to produce dynamic diffraction effects for heavy
atom materials. Condition (11.4) may be easily understood from Fig. 11.2,
where the type of scattering is monitored as a function of thickness t. The num-
ber of unscattered electrons rapidly decreases with t; with increasing values of
t, singly scattered electrons are scattered again.
doubly scattered
t
singly scattered
inelastic
unscattered
total number of electrons
Fig. 11.2
Proportion of electrons which remain
unscattered, singly scattered, and doubly
scattered as a function of the thickness t.
The proportion of inelastically scattered
electrons is also shown.
The effects of dynamic scattering on the success of direct methods was eval-
uated by Dorset et al. (1979) (see also Tivol et al., 1993) by calculating n-beam
diffraction data from crystals with increasing thickness and using different
wavelengths. The tangent formula was then applied to the dynamic structure
factors. Failures occurred for accelerating voltages too low with respect to
crystal thickness. However, even if higher voltages are used, dynamic effects
are always present in electron diffraction data. Formula (11.4) suggests that
one should use very thin crystals, and also higher voltages since they generate
smaller wavelengths.
Secondary scattering. A perturbation of the diffracted intensities occurs
in thick layered crystals when strongly diffracted beams from upper layers,
uncoupled from the lower crystalline regions owing to defects, act as the
primary beam for the lower layers. The intensities can then deviate remarkably
from the kinematic value. It is worthwhile stressing that the secondary scatter-
ing only involves superposition of the intensities of diffracted beams without
any interference between coincident beams (such interference is present in
dynamic scattering). Accordingly, one measures
I′
h = Ih + m1Ih ⊗Ih + m2Ih ⊗Ih ⊗Ih + · · · ,
(11.5)
where ‘⊗’ denotes the convolution operation.
Among other consequences, owing to (11.5), space group forbidden reﬂec-
tions (because of screw or glide planes) could not remain extinct under the

A traditional experimental procedure for electron diffraction studies
239
convolution operation. Dorset (1995) applied a secondary scattering model to
correct data for copper perchlorophthalocyanine, obtaining a good ﬁt with the
kinematic intensities.
Diffraction incoherence. An additional source of incoherent scattering is
crystal bending. Even if its occurrence is easily recognizable, the inﬂuence on
electron diffraction is often not taken into account. Cowley (1961) and Cowley
and Goswami (1961) noted that bending is a non-negligible source of inco-
herent scattering; however, it is not easy to model its effects on diffraction
intensities (Turner and Cowley, 1969; Moss and Dorset, 1983).
Radiation damage. Inelastic scattering often damages the crystal specimen
and, generally, the resulting damage is of a chemical nature and it is differ-
ent for different types of materials. The damage may inﬂuence the various
diffraction intensities by different amounts.
The above considerations suggest that, in spite of great experimental and
theoretical advances, the problem of deriving kinematic intensities from
observed data is still not completely solved. Thus, one should be prepared
to apply phasing methods to scrambled diffracted intensities, and to suffer an
unavoidable loss of efﬁciency. In the case of success, phasing methods should
provide phases which, coupled with the diffraction magnitudes, should provide
approximated potential maps.
This situation has a counterpart in the ﬁnal stages of crystal structure ana-
lysis, which usually end with a value of the crystallographic residual, Rcryst,
larger than for X-ray single crystal data. Rcryst values close to 0.25–0.35 may be
obtained, which reduces to 0.15–0.20 for data with larger kinematical nature.
11.5
A traditional experimental procedure
for electron diffraction studies
The traditional experimental diffraction procedure may be summarized as
follows:
1. The crystals are transferred to electron microscope grids; a relatively large
but thin (see below) defect-free region of the sample is selected for which
almost no bend contour is observed.
2. Based on the diffraction pattern of the initial zone, appropriate axes are
chosen for tilting, to provide different zonal projections. Tilting is per-
formed using the tilt holder in the goniometric stage of the electron
microscope. Since the sample is extremely thin, the Fourier transform of
the lattice function in the beam direction is not a delta function. In such
conditions, tilt angles are not well deﬁned and a tilt series is used to better
approximate the tilt angle.
Electron diffraction patterns usually provide a subset of the reﬂections
within reciprocal space. This weakens the efﬁciency of direct methods,
since a large percentage of strong reﬂections, and consequently of strong
phase relationships, would be lost. A good example is the structure, CBNA
(Voigt-Martin et al., 1995; see also Chapter 18), space group P21/c, for
which the b∗axis was chosen as the tilt axis (see Fig. 11.3). Firstly,

240
Phasing via electron and neutron diffraction data
Tilt
angle
a*
c*
β*
Zone
(201)
(301)
(401)
(501)
(100)
0º
27º
–10º
–16º
–19º
–31º
(101)
Fig. 11.3
CNBA: reciprocal space view down the
tilt axis b*. Diffraction data have been
collected for the emphasized zones (cour-
tesy of I. G. Voigt-Martin and U. Kolb).
zone (201) was recorded (0◦tilt angle; (hk2h) reﬂections recorded). Then
measurements were made for the following zones:
Zone
Tilt angle
Reﬂection type
(101)
27◦
(hkh)
(301)
–10◦
(hk3h)
(401)
–16◦
(hk4h)
(501)
–19◦
(hk5h)
(100)
–31◦
(0kl)
Tilting can be performed only over a range of 31◦; therefore, the data so
collected represent only part of the information within the reciprocal space.
It may be worthwhile mentioning two additional reasons for the lack of
popularity of traditional ED techniques.
(i) Organic crystals are often subject to severe electron beam damage, and
recording diffraction data from different zones of the same crystal is
nearly impossible. The problem is made more acute by the low speed of
the manual tilting and alignment of the crystal. As a consequence, data
acquisition may be an extremely time-consuming task, inappropriate
for routine investigations.
(ii) Geometrical restrictions on the specimen holder do not allow the
use of high tilt angles with conventional transmission microscopes.
This causes further severe limitations in data collection (missing cone
problem) and therefore additional difﬁculties in the phasing step.
3. High accuracy in estimated cell constants is difﬁcult to achieve for ED tech-
niques, because data are conﬁned to very small angles. Consequently, the
accuracy of the unit cell parameters is usually low, and cells with higher

Electron microscopy, image processing, and phasing methods
241
symmetry may frequently be simulated. A synergy with powder diffraction
data is often practised; indeed, unit cell constants obtained by ED data are
used as a starting point for indexing powder patterns with strong peak over-
lapping. Conversely, powder diffraction is used to improve the accuracy of
unit cell parameters obtained via ED.
4. Electron diffraction intensities are quantiﬁed by application of speciﬁcally
designed programs (Zou et al., 1993).
5. The space group is identiﬁed. This may be performed in three basic ways:
(a) by exploiting the dynamical effects present in the convergent beam pat-
terns (CBED). The resulting diffraction pattern consists of disks (rather
than sharp spots) of diameter proportional to the chosen convergence
angle. Interplanar spacing and angular information are obtained from
the centres of the disks. The point group symmetry and often the space
group symmetry may be derived from the ﬁne structure of intensity
variations within the disks. Not necessarily high quality CBED pat-
terns may be obtained, and in any case, this technique requires further
supplementary experimental work.
(b) from a few zone axis microdiffraction patterns, i.e. at least the zero and
ﬁrst-order Laue zones should be recorded and analysed (Morniroli and
Steeds, 1992; Morniroli et al., 2007). This approach implies a four-step
procedure: identiﬁcation of the crystal system, of the Bravais lattice, of
the glide planes, and of the screw axes.
(c) using a fully automatic approach (Camalli et al., 2012) based on ana-
lysis of the diffraction intensities; similarly to that used for X-ray data
(see Section 2.6). This task is not trivial. Indeed, dynamical effects
introduce discrepancies among expected symmetry equivalent reﬂec-
tions, and Laue groups belonging to the same crystal system can
frequently not be clearly distinguished by checking equivalent intens-
ities. Furthermore, symmetry forbidden reﬂections (i.e. reﬂections
expected to be systematically absent) show non-vanishing intensity, so
making it difﬁcult to identify the diffraction symbol.
(d) by direct inspection of the projected potential maps, obtained straight
from the experiment (see Section 11.5). Indeed, each recorded planar
image would show a speciﬁc planar symmetry compatible with the
three-dimensional space group. For example, if the space group is
P63/mcm, then [001], [100], and [1¯10] images should show projected
p6mm, pmm, and pgg symmetry, respectively.
11.6
Electron microscopy, image processing,
and phasing methods
There is an important supplementary advantage which may be exploited
by electron crystallography. Electron diffracted beams can be focused by
electromagnetic lenses (equivalent to inverse Fourier transform).
These images, however, are sensitive to focus, crystal thickness, orientation,
and astigmatism. Indeed, only very thin and well-aligned crystals can provide

242
Phasing via electron and neutron diffraction data
images interpretable in terms of crystal structure projection, provided that the
effects of other parameters have been corrected. Point-to-point resolution is
between 1.5 and 2 Å for a conventional TEM operating at about 200–400kV.
In complex structures, atoms overlap (nearly or exactly) in any projection, and
therefore cannot be resolved in a single projection image. The way to over-
come this problem is to collect several images from different directions and
to then combine the images to provide a model structure. This was the basic
contribution of de Rosier and Klug (1968), who described a method for the
reconstruction of three-dimensional structures from a set of two-dimensional
microscope images. Their work allowed the solution of hundreds of molecular
structures, including membrane proteins and viruses. Later on, it was found
that the contrast of a high-resolution electron microscopy (HREM) image
changes with optical conditions and crystal thickness. The so-called contrast
transfer function (CTF) plays a fundamental role in contrast changes. The
interpretation of contrast became simpler when simulation computer programs
(O’Keefe, 1973) using multislice methods, became available. It was then the
custom to interpret experimental images via image simulation. This method
was essentially a trial and error technique; a structural model is assumed, vari-
ous optical parameters (thickness, defocus, etc.) are varied, and calculated
images are compared with the experimental image. The structural model is
modiﬁed, then simulation is started again.
The method is time consuming. Klug and his group revived the technique
by application of the crystallographic image processing method, which proved
capable of recovering the correct structure projection from each individual
image. The method has been further improved by Hovmöller and his group in
Stockolm (Hovmöller et al., 1984; Wang et al., 1988; Li and Hovmöller, 1988).
What is the accuracy and resolution with which the projection of a struc-
ture can be deduced from an image obtained via the back Fourier transform
performed by electromagnetic lenses? There are two main factors limiting the
immediate use of the electron micrograph:
1. The image does not represent the projection of the crystal potential, but
instead, its convolution with the Fourier transform of the contrast transfer
function. Therefore, a deconvolution operation is necessary to restore the
desired image.
2. Widely scattered electrons are focused at positions other than those to
which electrons travelling close to the lens axis (spherical aberration) are
focused. As a consequence a point object is spread over length 	r in the
image plane, so that the real resolution of an electron microscope is no
less than about 100 times the electron wavelength. In practice, 1 Å resolu-
tion images can seldom be obtained by high-resolution microscopes; more
often the image resolution for organic crystals is 2−3 Å or lower, and from
4 to 15 Å for a two-dimensional protein crystal.
Images with a resolution of 1 Å are only obtained for special inorganic
structures. Then, atoms are resolved; since images are projections of the three-
dimensional structure, peak overlapping could, even in this case, hinder correct
three-dimensional location of the atoms. Several projections are therefore
needed for a three-dimensional reconstruction of the structure (Wenk et al.,

Electron microscopy, image processing, and phasing methods
243
1992). However, if the projection axis is short, packing considerations can lead
to solution, even from a single projection.
The effectiveness of high-resolution images for crystal structure solution
of macromolecules is limited by radiation sensitivity and poor crystal order-
ing. Membrane proteins are particularly suited to electron microscopy, because
they often form two-dimensional crystals. A ﬁrst signiﬁcant result was the res-
olution (at 7 Å resolution) of the purple membrane (Hendersson and Unwin,
1975; Unwin and Hendersson, 1975); the model was further reﬁned at 3.5 Å
resolution by combining electron microscope images and electron diffraction
intensities.
In spite of the above limitations, Fourier transformation of electron micro-
graphy is quite an important branch of electron crystallography devoted to
crystal structure. However, the image intensities constitute a non-linear rep-
resentation of the projected potential and depend on crystal specimen (e.g.
thickness and orientation) and on instrumental parameters (e.g. aberration,
alignment, defocusing, etc.). Interpretation of the image in terms of charge
density distribution is meaningful only when all of the experimental parameters
have been correctly adjusted, and/or when it is supported by the image calcu-
lated via many-beam dynamic diffraction theory. If this process turns out to be
successful, the image may be quite useful for determination of crystallographic
phases; it may also be employed as prior information towards extending the
phasing process to higher resolution or to a different set of reﬂections.
Direct methods can play an essential role in this ﬁeld. Among the various
recent achievements we quote the following:
1. Image processing methods have been combined with direct methods (Fan
et al., 1985; Hu et al., 1992) and maximum entropy methods (Bricogne
1984, 1988a,b, 1991; Dong et al., 1992; Gilmore et al., 1993; Voigt-Martin
et al., 1995).
2. Structure factor statistics has been used to estimate crystal thickness under
near-kinematic conditions (Tang et al., 1995).
3. Phases derived from a 10 Å resolution image of a two-dimensional E. coli
Omp F outer membrane porin (space group P31m) have been expanded
to 6 Å resolution by the tangent formula. The mean phase error for the
25 determined reﬂections was about 43◦(Dorset, 1996).
4. Phases derived from 15 Å resolution images from bacteriorhodopsin have
been extended by maximum entropy and likelihood procedures to the
diffraction limit (Gilmore et al., 1993).
5. Useful results were obtained by Dorset (1996) for phasing ab initio, via
tangent methods, the centrosymmetric projection of halorhodopsin to 6 Å
resolution.
6. Maximum entropy and likelihood methods have been used for an ab ini-
tio phase determination (at about 6−10 Å resolution) for two membrane
proteins, the Omp F porin from the outer membrane of E. coli and for hal-
orhodopsin (Gilmore et al., 1996). Potential maps revealed the essential
structural details of the macromolecules.
7. Three-dimensional reconstruction of ordered materials from diffraction
images. Particularly interesting was the combination of 13 zone axes for

244
Phasing via electron and neutron diffraction data
the structure of a very complex intermetallic compound, ν-AlCrFe, with
129 atoms in the asymmetric unit (Zou et al., 2003).
11.7
New experimental approaches: precession
and rotation cameras
In the preceding sections we have emphasized the limitations of the traditional
experimental ED techniques:
(i) data resolution is limited (only low-index zones are recorded);
(ii) experimental procedures are very time consuming (crystal orientation
is in itself time consuming and contributes to a deterioration of beam
sensitive samples);
(iii) since conventional manual techniques allow collection of reﬂections from
a few well-oriented zone axes, a diffraction experiment usually provides
less than 30% of the full three-dimensional reciprocal space. Owing to the
scarcity of observations phasing is difﬁcult, the electron density maps are
poor, and least squares reﬁnement is not effective.
(iv) the diffraction intensities (which carry information about the crystal
structure) are of poor quality due to multiple/dynamic scattering of the
electrons.
The precession electron diffraction technique, recently developed by Vincent
and Midgley (1994), allows us to signiﬁcantly reduce the dynamic effects and
improve data resolution. The technical bases of the precession camera are the
following: the electron beam is tilted by a small angle, typically 1–3 degrees,
and then rotated around the TEM optical axis. The precession movement of
the reciprocal plane in diffraction allows only a small number of reﬂections
to be excited at any time (which reduces the multiple/dynamic scattering).
Furthermore, the movement integrates over the excitation error because a
volume of reciprocal space is explored, not just a surface.
Although the precession technique curtails the problem of dynamic diffrac-
tion, another important problem remains: how to collect full 3D reﬂection data,
or, in other words, how to collect data as in automated X-ray diffractometry?
If such a technique should become available, ED would show an important
advantage over X-ray diffraction and it may be extendable to nanocrystals.
A sequential electron diffraction data collection (automated diffraction
tomography, ADT) and related data processing routines have been developed
by Kolb et al. (2007a,b). The technique uses tilts around an arbitrary axis; the
reciprocal space is sequentially sampled in ﬁne steps, so that most of the reﬂec-
tions lying in the covered reciprocal space may be collected. The technique
combines well with precession techniques; as stated above, better integration
of the diffraction intensities may be performed because several cuts through the
reﬂection body can be collected and, in this way, the true reﬂection intensities
are more accurately reconstructed.
One of the most complex systems solved so far, via ADT + precession, is
the mineral charoite (Rozhdestvenskaya et al., 2010; V = 4500 Å3, 90 non-H

Neutron scattering
245
atoms in the asymmetric unit), a silicate structurally close to a zeolite. The
structure was solved by direct methods, as implemented in the program,
SIR2008. Around 9000 reﬂections with 97% coverage up to 1.1 Å resolution
were measured and used and the ﬁnal crystallographic residual was 17%.
Electron rotation uses a technique rather similar to that employed by elec-
tron precession (Zhang et al., 2010), but the main difference is that, in the
rotation technique the electron beam is tilted along a straight line, like a pen-
dulum, whereas it is tilted around a circle in precession. Rotations up to 5◦may
be used and the line can be along the x or the y direction, or along any diag-
onal in between. Data are collected in small angular steps, in order to handle
partially recorded reﬂections. Measurements can start from any orientation of
the crystal, because there is no need to align it.
11.8
Neutron scattering
A neutron is a heavy particle with spin 1/2 and magnetic moment of
1.9132 nuclear magnetrons. The most common sources of neutrons suitable
for scattering experiments are nuclear reactors and spallation sources. Nuclear
reactors are based on a continuous ﬁssion reaction; fast neutrons are produced
whose energy is reduced by collisions in a moderator of heavy water and graph-
ite (thermalization process). The neutrons, thus retarded, obey the Maxwell
distribution and the wavelength for the scattering experiment is selected by a
monochromator, usually a single crystal of Ge, Cu, Zn, or Pb.
Neutrons are also produced by striking target nuclei (usually tungsten or
uranium) with charged particles (protons, α-particles). These are accelerated in
short pulses (<1 µs) to 500–1000 MeV and cause, by impact with the target,
the ‘evaporation’ of high-energy neutrons. Hydrogenous moderators (typic-
ally polyethylene) thermalize the fast neutrons, making them suitable for the
scattering experiment.
There are two basic differences between the neutrons produced by a reactor
and those from a spallation source: the neutron ﬂux is pulsed when obtained
from a spallation source, consequently the experiments must be performed by
time-of-ﬂight techniques; high intensities at short wavelength (λ < 1 Å) is a
very signiﬁcant characteristic of spallation sources.
The scattering of neutrons by atoms comprises interaction with the nucleus
and interaction with the magnetic moment of the neutron-magnetic moment of
the atom. This last effect mainly occurs in atoms with incompletely occupied
outer electron shells; since the usefulness of phasing methods to diffraction
effects caused by magnetic interaction is marginal, this topic will not be
covered in this book.
Since the nuclear radius is of the order of 10−15 cm (several orders of mag-
nitude less than the wavelength associated with the incident neutrons), the
nucleus behaves like a point scatterer and its scattering factor, b0, will be iso-
tropic and not dependent on θ/λ. In a gas, the nucleus is free to recoil under the
impact of the neutrons; then the free-scattering length should be calculated by
bfree =
M
mn + M b0,

246
Phasing via electron and neutron diffraction data
where mn is the mass of the neutron and M is the nuclear mass. If the nucleus
does not behave like an impenetrable sphere, a metastable nucleus + neutron
system is created, which decays by re-emitting the neutron. For appropriate
energies, a reasonable effect may occur; then,
b = b0 + b′ + ib′′,
where b′ and b′′ are the real and imaginary parts of the resonance scattering.
This occurs for relatively few nuclei; for the majority of them the imaginary
component is small, so we will ignore it in direct methods applications.
The angular momentum of the nucleus, I, will inﬂuence the neutron–nucleus
interaction. Indeed, I combines with the neutron spin in both a parallel and an
antiparallel fashion, yielding two possible values,
J = I + 1/2
or
J = I −1/2,
corresponding to scattering factors b+ and b−, respectively.
According to quantum mechanics, there are 2J + 1 orientations in the space
compatible with one spin of value J. The number of possible states is therefore

2 (I + 1/2) + 1

+

2 (I −1/2) + 1

= 2 (2I + 1) ,
the fraction
w+ = 2 (I + 1/2) + 1
2 (2I + 1)
= I + 1
2I + 1
of which corresponds to states with parallel spins; while the fraction
w−= 2 (I −1/2) + 1
2 (2I + 1)
=
I
2I + 1
corresponds to states with antiparallel spins.
For a single element containing several isotopes, each isotope has its own
characteristic scattering length. Accordingly, the mean value of the scattering
length of the atom is obtained by averaging ﬁrst over the two spin states of the
isotope,
⟨b⟩isotope = w+b+ + w−b−,
and then over all isotopes, taking into account their relative abundance. The
ﬁnal quantity gives the coherent scattering length of the atom which, for the
sake of simplicity, is called b throughout the text.
However, incoherent scattering will also occur, with square amplitude
given by
	
w+b2
+ + w−b2
−

−(w+b+ + w−b−)2 ,
which contributes to the background and does not provide diffraction effects.
The incoherent scattering is particularly important for hydrogen, for which
I = 1/2, b+ = −1.04 × 10−12 cm,
b−= −4.7 × 10−12cm, w+ = 0.75, w−= 0.25.

Violation of the positivity postulate
247
Then, b = −0.39 and most of the scattering is incoherent.
From the above considerations, a number of important scattering features
are obtained:
1. The interaction of neutrons with matter is weaker than for X-rays and elec-
trons (see Section 11.2). Therefore, higher neutron ﬂuxes or larger single
crystals are needed in order to measure appreciable scattered intensities.
2. The b values do not vary monotonically with atomic number Z. This spe-
ciﬁc property allows us to distinguish between atoms having quite close
values of Z and different values of b. Speciﬁcally, neutron diffraction data
are particularly useful for localizing H atoms.
3. Isotopes of the same element have different values of b. Thus, in order to
reduce incoherent scattering, H is often replaced by deuterium.
4. For some elements, b < 0. A property basic to direct methods may there-
fore be violated when neutron radiation is used. This topic is discussed in
the next section.
5. Coherent scattering, giving rise to Bragg scattering, deﬁnes the structure
factor,
Fh =
N

j=1
bj exp
	
2πh · rj

exp
	
−Bj sin2 θ/λ2
,
where bj is a positive or negative value (b does not vary with sin(θ/λ)), and Bj
is the temperature factor.
11.9
Violation of the positivity postulate
In Chapters 5 and 6, we underlined that positivity and atomicity of the elec-
tron density are basic conditions for the validity of the traditional direct
methods. We want to show here that positivity is not an essential ingredient
(Hauptman, 1976). There are several examples of crystal structures solved by
direct methods (via data collected via neutron scattering) which involve atoms
with negative scattering factors. Our treatment will follow closely the paper by
Altomare et al. (1994b).
In order to understand the effect that the violation of the positivity condition
has on triplet and quartet relationships we will consider three cases:
Case A: all the scattering factors are real non-negative functions of sin θ/λ (as
for standard X-ray or electron scattering).
Case B: all the scattering factors are real negative functions. Accordingly, ρ is
supposed non-positive everywhere. This situation seldom occurs in neutron
scattering.
Case C: some scattering factors are real positive functions, some others are real
negative functions. Cases A and B are limiting situations of case C.
Case A. If the electron density, ρ, satisﬁes the relationship
ρ ≃ρ2,
(11.6a)

248
Phasing via electron and neutron diffraction data
then the Sayre (1952) equation (10.A.4), the Cochran relationship (5.6), and
the tangent formula (6.10) arise.
Then the relation
ρ ≃ρ3
(11.6b)
also holds, and Hauptman and Giacovazzo formulas for quartet invariants
follow (see Chapter 5).
Case B. Let us replace fj by −fj. In this case, the structure factor is given by
N

j=1
	
−fj

exp
	
2πih · rj

= −Fh = Fh exp (iπ) .
(11.7)
Relation (11.6a) is now replaced by
ρ ≃−ρ2
(11.8)
and
Fh = −θh

k
FkFh−k.
(11.9)
Comparison of (11.8) and (11.9) with (11.6a) and (10.A.4) shows that the
Sayre equation does not hold when ρ is non-positive deﬁnite. However, since
(11.8) and (11.6a) differ only by their sign, we will refer to (11.9) as a modiﬁed
Sayre equation.
By application of the joint probability distribution method, the triplet phase
distribution
P
	
h,k

≃
	
2πI0
	
−Gh,k


−1 exp
	
−Gh,k cos h,k

(11.10)
is obtained. More generally,
tan φh =

k −Gh,k sin (φk + φh−k)
	
k −Gh,k cos (φk + φh−k)

=

k Gh,k sin (φk + φh−k + π)
	
k Gh,k cos (φk + φh−k + π)

,
= −T3,h/ −B3,h
(11.11)
with reliability parameter (unmodiﬁed with respect to case A),
α3,h ≃
	
T2
3,h + B2
3,h

1/2 .
(11.12)
A tangent routine which uses negative values of G (or equivalently, assumes
positive values of G and adds π to the triplet phase) is expected to be as efﬁ-
cient in ﬁnding the correct positions of the negative ‘atoms’ as the usual tangent
routine for the location of positive atoms. Since FOMs based on the distribu-
tion of the α moduli (psi-zero FOM included) are not sensitive to the sign of ρ,
a structure with positive atomic scattering factors will be marked by the same
FOMs as its negative image.
When we move from case A to case B, relation (11.6a) is replaced by (11.8),
but relation (11.6b) still holds. Accordingly, the quartet formulas of Hauptman
and Giacovazzo still hold. In short, the result is as follows: while triplet phase

About the elastic scattering of electrons
249
relationships depend on the ‘sign’ of the scattering matter, quartet relationships
and relative FOMs are insensitive to it. Therefore, the set of phases one obtains
at the end of a direct procedure based only on quartet relationships can lead to
the correct solution, either via a collection of positive peaks, or equivalently,
via a collection of negative peaks.
Case C. Now, neither the Sayre equation (10.A.4) nor the modiﬁed Sayre
equation (11.9) hold. However, application of the joint probability distribution
method brings us to useful formulas. In particular, the Cochran relationship is
still valid, but Gh,k must be calculated from the general expression (Hauptman,
1976; Altomare et al., 1994b).
Gh,k = 2Ch,k|EhEkEh−k|,
(11.13)
where
Ch,k =
N

j=1
vj (h) vj (k) vj (h −k) ≃σ3σ −3/2
2
.
If all the fj are positive (case A), then Ch,k = 1/Neq, as in the standard for-
mula. If all the fj are negative (case B), then Ch,k ≃−
	
1/Neq

, in agreement
with eqation (11.10). If some fj are positive and others are negative, then Ch,k
contains contributions of opposite sign. If their balance is close to zero, then
Ch,k is close to zero too. On preserving the analogy with case A, one could
then say that the apparent value of Neq (i.e. Neq = 1/C2
h,k) becomes inﬁnitely
large (accordingly, N is no longer the number of scatterers in the unit cell,
as in case A). In this situation the structure could hardly be solved via triplet
invariants.
The equation ρ ≃ρ3 also holds in case C, and therefore the Hauptman and
Giacovazzo formulas still hold. However, estimation of a quartet phase via the
joint probability distribution method requires some caution.
With the assumption that σ4/σ 2
2 ≃(σ3/σ 3/2
2
)2, the classical quartet estimate
is obtained, as described for cases A and B. If some fj are positive and some
are negative, σ4/σ 2
2 may be quite different from σ 2
3 /σ 3
2 . In particular, if σ3 ≃0,
the cross-magnitudes do not inﬂuence the quartet estimate. Then this depends
only on the term,
2
	
σ4/σ 2
2

|EhEkElEh−k−l|
(11.14)
and the quartet is always expected to be positive. In particular, for situations
in which σ3 ≈0 while σ4 is still large, the structure solution may be obtained
more easily via the active use of quartet invariants rather than triplets.
APPENDIX 11.A
ABOUT THE EL ASTIC SCATTERING
OF ELECTRONS: THE
KINEMATICAL APPROXIMATION
We remember some of the properties of elastic scattering of electrons, useful
in phasing approaches.

250
Phasing via electron and neutron diffraction data
1. Elastic scattering may be described by the Schrödinger equation,
∇2(r) + 8π2me
h2
(E + ρ(r))(r) = 0,
(11.A.1)
where e = |e| is the magnitude of the electronic charge, m is the mass of the
electron, E is the accelerating voltage (then eE is the kinetic energy of the
electron), and ρ(r) is the (positive) crystal potential, assumed to be periodic
as in a perfect crystal. We explicitly stress that the potential distribution,
ρ(r), does not coincide with the electron density distribution, even if we
use the same symbol, ρ, for both. The kinematical approximation assumes
that the electron experiences only a single (weak) scattering through the
material, usually from a spherically symmetrical atom. In the Fraunhofer
conditions (i.e. measurements of scattered radiation are made at a large dis-
tance from the crystal), the total scattered wave is made up of the incident
plane wave plus a scattered spherical wave. After some simple approxima-
tions, the amplitude of the scattered spherical wave is FB(r∗), as deﬁned in
Section 11.3.
2. The concept of the Ewald sphere may also be used to describe electron
diffraction, but two important differences should be emphasized.
(a) The short wavelengths imply that the scattering angles are much smal-
ler than for X-ray or neutron radiation experiments. Most of the
reﬂections have 2θ values between 0◦and 4◦, so that in this region,
sin θ may be approximated by θ. Since the radius of the Ewald sphere
(= 1/λ) is very large, the sphere is in practice reduced to a plane; thus,
several points of the reciprocal lattice plane can be simultaneously in
Bragg position (see Fig. 11.A.1). Thousands of diffracted beams can
be simultaneously observed on a screen, or collected on a photographic
plate for measurement of intensities. Thist is the physical reason for the
popularity of a traditional experimental technique collecting diffracted
intensities from reciprocal lattice zones (see Section 11.5).
s0
1/λ
first-order
Laue zone
first-order
Laue zone
X-ray
Ewald sphere
Electron
Ewald sphere
zero-order
Laue zone
O
a*
Fig. 11.A.1
Ewald sphere and Laue zones for electron
diffraction.
1.0
0.8
0.6
0.4
0.2
0.0
0.5
1.0
1.5
2.0 x
y
Fig. 11.A.2
y = [sin(πx)/(πx)]2 is plotted against x.
(b) Since electron radiation interacts strongly with the crystal, the speci-
men must be very thin (less than 100 Å). In this case, transformation
of the shape of the specimen will affect the form and the dimensions
of the reciprocal lattice points; each node of such a lattice (a point-
like function only for an inﬁnite crystal) is replaced by a distribution
function which is non-zero over an extended domain. Accordingly, the
wave intensity scattered by a crystal for a reﬂection h is given by,
Ih(x∗, y∗, z∗) = I0|FB
h|2|D(x∗, y∗, z∗)|2,
where I0 is the primary beam intensity, D is the Fourier transform of
the crystal shape, and x∗, y∗, z∗are the coordinates in reciprocal space
around the h node.
In order to give a simple example, let us consider a parallel-sided crys-
tal plate of thickness t, belonging to the orthorhombic crystal system, with
a ≃b ≃10Å, c ≃6Å. Let us suppose that the incident electron beam has
direction s0, parallel to c, and wavelength λ ≃0.03Å. Then the radius of the
Ewald sphere (see Fig. 11.A.1) is several orders of magnitude larger than the

About the elastic scattering of electrons
251
reciprocal lattice vectors. Let N1, N2, N3 be the number of unit cells along a, b,
and c, respectively. If N1 and N2 are very large and N3 is small (say t ≃6c), the
reciprocal lattice spots (modelled by the crystal shape transform) are extended
in the c direction, and can intersect the Ewald sphere even if the reciprocal
lattice points are not on it. Then, the intensities of the (h, k, 0) reﬂections are
given by the expression,
Ihk0 ≃C
r2 |FB
hk0|2
sin (πtζhk0)
πtζhk0
2
,
(11.A.2)
where C is a constant and ζ is the excitation error, which measures the distance
of the Ewald sphere from the reciprocal lattice point. For the reﬂection (hk0),
ζhk0 =
	
h2a∗2 + k2b∗2
λ/2.
The function y =

sin(πx)/πx
2, with x = tζhk0, is shown in Fig. 11.A.2. Its
ﬁrst zero value occurs at x = 1 or, in terms of ζ, at ζhk0 = t−1. In practice,
the decay of I with ζ, as suggested by (11.A.2), is rarely observed for several
practical reasons (variation of thickness, bent crystals, etc.).
The overall result obtained from Fig. 11.A.1 is that several hundred
(hk0) spots will, simultaneously, intersect the Ewald sphere and so produce
diffracted intensities (all of them belonging to the so-called zero-order Laue
zone). From the same ﬁgure, it may be seen that a ring of spots belonging to
the (hk1) layer (ﬁrst-order Laue zone) intersect the Ewald sphere and can there-
fore be collected on the same plate as used for the (hk0) layer. Further rings,
corresponding to (hk2), (hk3), etc. layers can also be measured (in favourable
situations), which constitute the higher-order Laue zones.

Phasing methods
for powder data
12
12.1
Introduction
Powder diffractometry plays (and will probably continue to play in the near
future) a central role in research and technology, because it allows us to invest-
igate materials which are not available as a single crystal of adequate size and
quality. Therefore, recently, much effort has been devoted to the development
of powder diffraction. Improvements include the design of better instruments
(e.g. optimized synchrotron radiation lines, time-of-ﬂight technology at pulsed
neutron sources, optics, generators, detectors), as well as more sophisticated
methods for data analysis. As a result, in favourable cases, high quality powder
patterns of proteins may be collected which contain sufﬁcient information to
allow identiﬁcation of the unit cell and of the space group, a result unthinkable
30 years ago. This has opened the way for qualitative analysis and study of
the polymorphism of macromolecules (Margiolaki et al., 2005; Collings et al.,
2010).
Advances in the experimental and the theoretical aspects of powder crystal-
lography have been able to reduce losses of information from a powder pattern
with respect to single crystal data, and have made ab initio crystal structure
solution from powder experiments possible.
The reader may deduce the increasing popularity of powder techniques
from:
(i) Table 1.11, where, among the CSD (Cambridge Structural Database),
entries on 1 January 2012, 2354 powder diffraction studies were counted;
(ii) Figure 12.1, where the cumulative statistics (up to the year 2006) on the
number of structures solved via powder diffraction data is shown (SDPD
database);
(iii) Figure 12.2, where the statistics on the number of studies in the ICDD
(Inorganic Crystal Structure Database) (to the year 2005) for differ-
ent types of data is given. For the powder case, 21 472 cases are
counted for which powder data have been used, mostly for reﬁnement
purposes.
In this chapter, we will neglect experimental aspects, unless unrelated to the
phasing problem. We will describe in Sections 12.2 to 12.5, the basic features

About the diffraction pattern: peak overlapping
253
1400
1200
1000
800
600
400
200
0
28 41
59 75 108135178236277325385
443
520
623
748
866
1038
1191
1328
51
1948–87
1988
1989
1990
1991
1992
1993
1994
1995
1996
1997
1998
1999
2000
2001
2002
2003
2004
2005
2006
Fig. 12.1
From
Structure
Determination
from
Powder Diffraction – Database < http://
sdpd.univ-lemans.fr/iniref.html>.
By
courtesy of Armel Le Bail.
X-ray diffraction (single crystal)
47809
X-ray diffr. synchrotron (single crystal)
1811
X-ray diffraction (powder)
21472
X-ray diffr. synchrotron (powder)
1115
Neutron diffraction (powder)
12391
Neutron diffraction (single crystal)
1404
Electron diffraction/microscopy
506
Structure derived from NMR
69
Fig. 12.2
Inorganic Crystal Structure Database
(ICDD; Nist and Fachinformationszen-
trum Karlsruhe). Number of deposited
crystal structures, solved or reﬁned, per
experimental technique. Data extracted
from the 2005 release of ICDD; by cour-
tesy of Thomas Weirich.
of powder pattern diagrams, and in Sections 12.6 and 12.7, the procedures for
full pattern indexing and space group determination. Ab initio phasing will be
treated in Section 12.8 and non-ab initio methods in Section 12.9. The combin-
ation of anomalous dispersion techniques with powder methods is postponed
to Section 15.9.
For brevity, we will not mention numerous computer programs performing
a wide range of powder data collection and analysis. Only a few will be repor-
ted, those strictly related to the phasing problem. The reader is referred to an
extensive paper by Cranswick (2008) for a complete review.
12.2
About the diffraction pattern: peak
overlapping
An ideal powder is an ensemble of a very large number of randomly ori-
ented crystallites, usually of the order of a few microns. A reciprocal lattice
may be associated with each crystallite; as a result, the various reciprocal

254
Phasing methods for powder data
lattices, all with the same origin, are themselves randomly oriented. The cor-
responding ideal powder pattern may be explained by means of the Ewald
sphere (see Fig. 12.3). For ideal powders, and for a given h, the vector
r∗
h = ha∗+ kb∗+ lc∗is found in all possible orientations with respect to the
incident X-ray (or neutron) beam; then we can say that the reciprocal lattice
point deﬁned by r∗
h degenerates in a sphere of radius |r∗
h| with its centre at the
origin of the reciprocal space. In accordance with Chapter 1, diffraction will
occur for such a reﬂection h when the sphere of radius |r∗
h| intersects the Ewald
sphere (see Fig. 12.4). The locus of the intersection points of the two spheres is
a circle which, together with point A (the centre of the Ewald sphere), deﬁnes a
diffraction cone specifying all the possible directions in which diffraction may
be observed.
X-rays
A
o
r*
1/λ
Fig. 12.3
Bragg conditions for ideal powders. The
sphere with radius 1/λ and centre at A is
the Ewald sphere. When the specimen is
an aggregate of randomly oriented crys-
tallites, the vector r∗
h, corresponding to a
ﬁxed reciprocal vector h, is found in all
possible orientations.
X-rays
A
o
r*
Fig. 12.4
The intersection of a sphere of radius
r∗
h = ha∗+ kb∗+ lc∗
with the Ewald
sphere is a circle which deﬁnes a dif-
fraction cone (from A), ﬁxing all of the
possible directions in which diffraction
may be observed.
Measurements may be made using a ﬂat detector which intercepts all the
diffraction cones (we will see a set of rings, as shown in Fig. 12.5), or in Bragg–
Brentano or Debye–Scherrer geometry, which projects peaks on the 2θ axis (as
shown in Fig. 12.6).
Fig. 12.5
Silicium powder pattern collected in
the laboratory: Mo Kα radiation, CCD
detector perpendicular to the diffraction
cones.
Figures 12.3 and 12.4 suggest that two reciprocal lattice points with the
same modulus, |r∗
h|, will give rise to the same diffraction cone and their diffrac-
tion intensities will completely overlap (see Fig. 12.7a); if the|r∗
h|s are slightly
different, the overlap will be partial (see Fig. 12.7b). In the ﬁrst case we are
not able to decompose the overall peak intensities in the reﬂection diffraction
intensities; in the second, some information is still present, but additional work
taking into account peak proﬁles is necessary in order to be able to extract the
desired information. This is the well-known overlapping problem in powder
crystallography.
The above considerations suggest the main differences between single crys-
tal data and powder diffraction patterns. In a single crystal diffraction exper-
iment all the measured reﬂection intensities are accessible at their respective
points in the three-dimensional lattice, while in a polycrystalline sample exper-
iment, the three-dimensional reciprocal lattice degrades into a one-dimensional
projection, the observed pattern of powder peaks, each characterized by a
Bragg angle and by non-vanishing width. If more Bragg reﬂections overlap,
a more severe loss of information occurs.
We will distinguish three different types of peak overlapping, two of
systematic type, one of occasional type:
(i) Symmetry-equivalent reﬂections share the same |r∗| and therefore fully
overlap (systematic overlapping). This case is however not a problem
for phasing approaches. Since the reﬂection multiplicity m is known
(provided that the Laue group has been previously deﬁned, m is the
number of symmetry-equivalent reﬂections), the intensity corresponding
to the single reﬂection h may be found simply by dividing the overall
intensity by m.
(ii) Two symmetry-independent reﬂections with occasionally equal or sim-
ilar |r∗| will fully or partially overlap, respectively. The overlap may be
total or partial according to the misﬁt of the corresponding 2θ angles
(occasional overlapping). Let us consider an example in which a special
metric relationship generates occasional overlapping. In the orthorhombic

About the diffraction pattern: peak overlapping
255
2θ
Fig. 12.6
Silicium powder pattern collected in the
laboratory:
Debye–Scherrer
geometry,
Cu Kα radiation.
unit cell deﬁned by a = 10.00 Å, b = 5.77 Å, c = 14.32 Å, we have,
b ≈a/
√
3. Accordingly, the reﬂections (200) and (110) overlap, as well
as (400) and (220), etc.
5
3
1
11.5
11.9
12.3
2θ
12.7
a)
5
3
1
11.5
11.9
12.3
2θ
12.7
b)
Fig. 12.7
(a) Two diffraction peaks completely
overlap; (b) two diffraction peaks par-
tially overlap.
(iii) In high symmetry crystal systems (i.e. in trigonal, tetragonal, hexagonal,
and cubic systems), where the lattice symmetry may be higher than the
Laue symmetry (check Table 1.3), systematic overlapping may occur
between reﬂections which are not symmetry equivalent. As an example,
let 4/m be the Laue group of our crystal; the symmetry equivalent
reﬂections are
(hkl), (¯h¯kl), (¯khl), (k¯hl), (¯h¯k¯l), (hk¯l), (k¯h¯l), (¯kh¯l).
Since overlapping is ruled by the lattice symmetry, in our case 4/mmm, the
following reﬂections systematically overlap:
(hkl), (¯h¯kl), (¯khl), (k¯hl), (¯h¯k¯l), (hk¯l), (k¯h¯l), (¯kh¯l),
(¯hk¯l), (h¯k¯l), (kh¯l), (¯k¯h¯l), (h¯kl), (¯hkl), (¯k¯hl), (khl).
In the Laue group 4/m, the ﬁrst eight are symmetry equivalent to (hkl), and
the second eight to (khl). Since |Fhkl|2 and |Fkhl|2 are uncorrelated, the meas-
ured overall intensity (summing the contributions of 16 reﬂections) cannot be
reliably partitioned into |Fhkl|2 and |Fkhl|2.
The quality of the diffraction pattern can determine the success or the fail-
ure of the phasing process: the larger the overlapping, the larger the loss
of experimental information. Owing to several experimental factors, the typ-
ical diffraction pattern provided by a laboratory diffractometer shows peaks
with large FWHM ( full width at half maximum). In particular, unless a spe-
cial monochromator is used, the peak shape is rather complicated because of
the simultaneous presence of three wavelengths (see Fig. 12.8). Therefore,
synchrotron radiation powder patterns are often used for crystal structure
solution.
Kα3
Kα1 Kα2
Fig. 12.8
Peak shape model using X-rays from
tubes.
Synchrotrons are circular accelerators where charged particles (usually elec-
trons) are accelerated to speeds very close to that of light. Through magnetic
ﬁelds produced by the so-called bending magnets the electrons are maintained
in a circular orbit, tangentially to which synchrotron radiation is emitted. Third
generation synchrotrons also implement multiple magnets placed in ad hoc
straight sections inside the ring. Inside these multiple magnets, the electrons
perform multiple oscillations and emit synchrotron radiation after each oscilla-
tion. The result is enhanced radiation emission intensity. Multiple magnets can

256
Phasing methods for powder data
be undulators or wigglers, depending on whether coherent or incoherent super-
position of these single emissions after each oscillation occurs. Synchrotron
radiation is extremely intense, highly collimated (vertically, in the case of
bending magnets and both vertically and horizontally in the case of undulators
and to a lesser extent, wigglers), linearly polarized in the plane of the electron
orbit, and has a continuous spectral distribution over a quite wide spectral range
(See Scientiﬁc Discussions on <www.excels.us>).
X-ray powder diffraction measurements can be performed by using either
point detectors or 1D- or 2D-display detectors. Point detectors record full dif-
fraction patterns by spanning the detector in the 2-theta range step by step or
continuously, whereas 1D and 2D detectors simultaneously record the full dif-
fraction pattern, a single cut of the Debye–Scherrer rings or the entire rings,
respectively.
A point detector with crystal analyser allows the highest angular resol-
ution and therefore the smallest FWHM; their efﬁciency depends strongly
on the photon beam monochromaticity and on its degree of collimation
(which requires a considerable amount of photon intensity and explains
why the highest FWHM resolutions are achieved at synchrotron facilities).
Figure 12.9 shows the full diffraction pattern of NAC (chemical composition
Na2Ca3Al2F14; Courbion and Ferey (1988)) recorded at the Swiss Light Source
Materials Science (SLS-MS) beamline using a multicrystal analyser detector
(Gozzo et al., 2006). Figure 12.10 shows the diffraction pattern of the same
material recorded at the same beamline by the 1D solid state MYTHEN II
detector (Bergamaschi et al., 2010). The difference in FWHM may be clearly
appreciated from the magniﬁed plots.
Neutron radiation patterns have a FWHM which is larger than for syn-
chrotron data, but have other advantages with respect to X-ray radiation. The
scattering power is still high at high |r∗| values (indeed, the nuclei can be con-
sidered as point scatterers), and structure reﬁnement is more straightforward
when the crystal structure contains atoms of quite different atomic number
9.40
9.56
(220)
FWHM~0.003 deg
9.72
9.88
10.04
10.20
b)
2q (degrees)
Intensity (arb. units)
3
8
13
18
23
2q (degrees)
a)
Intensity (arb. units)
28
33
38
43
48
53
Fig. 12.9
NAC. (a) Diffraction pattern collected at SLS-MS (Villigen, Switzerland) at 20.1 keV by a multicrystal analyser detector: six hour acquisition
time; (b) a zoom on the reﬂection (220). By courtesy of Fabia Gozzo.

About the diffraction pattern: peak overlapping
257
10.85
11.03
(220)
FWHM~0.0237 deg
11.21
11.39
11.57
11.75
2q (degrees)
Intensity (arb. units)
4
12
a)
b)
20
28
36
2q (degrees)
Intensity (arb. units)
44
52
60
68
76
84
Fig. 12.10
NAC. (a) Diffraction pattern collected at SLS-MS (Villigen, Switzerland) at 17.5 keV by the 1D solid state detector MYTHEN II: 10 second
acquisition time; (b) a zoom on the reﬂection (220). By courtesy of Fabia Gozzo.
(see Sections 11.8 and 11.9). The situation is complementary to that occurring
with X-ray data, where location of some dominant atoms may be easy, but
subsequent accurate location of light atoms may be much more difﬁcult. It is
therefore not infrequent that a partial solution is obtained via synchrotron data
and then structure reﬁnement is performed by exploiting both synchrotron and
neutron data (Larson and von Dreele, 1987).
In Fig. 12.11a, typical neutron, synchrotron, and laboratory diffractometer
patterns are shown for the same structure; in Fig. 12.11b, a high 2θ angle inter-
val is selected to show the different proﬁles of the three patterns (high contrast
peak–background for neutron data, still good contrast and small FWHM for
synchrotron data, very noised for the conventional diffractometer).
0
20
40
60
2θ (deg.)
0
1
2
3
counts (a.u.)
4
5
6
(a)
7 x104
a)
80
100
120
XC
S
N
80
0
1
(b)
2
3
counts (a.u.)
4
5
6
7
b)
85
90
95
100
105
110
115
120
2θ (deg.)
XC
S
N
Fig. 12.11
RUCO [Ru(CO)4]. (a) Simulated full pattern for neutrons (N), synchrotron (S), and conventional X-ray (XC). (b) High sinθ/λ regions of the
patterns.

258
Phasing methods for powder data
12.3
Modelling the diffraction pattern
Modelling a diffraction pattern requires the analysis of all of its proﬁle com-
ponents. Schematically, this may be reduced to two main activities: analysis of
the peak proﬁle and background deﬁnition.
The background function is rather complicated because it is the result of
numerous phenomena (Suortti and Jennings, 1977; Riello et al., 1995), e.g. air
scattering, incoherent and diffuse scattering, amorphous contribution, etc.
Line proﬁle analysis depends (and therefore may provide information) on
several factors: size of crystalline domains, line and plane defects (e.g. dis-
locations and stacking faults, respectively), antiphase domains for materials
undergoing disorder/order transformations, compositional ﬂuctuations, etc.
Such analysis is basic for the study of microstructure and lattice defects, and
is not object of our attention here. The reader is referred to Scardi (2008) for
general and advanced information and for a more complete bibliography.
We will deal here with a simpliﬁed use of proﬁle analysis, which is, however,
extended to the full diffraction pattern. We refer to full pattern decomposition,
which involves the following steps: recognize peaks and ﬁnd their locations,
deﬁne their shape, and model the background. We brieﬂy describe them below.
Peak search. This is the preliminary operation, not at all trivial, as small
perturbations in the peak or in the background may simulate false peaks.These
artifacts should be eliminated using procedures that are insensitive to noise.
Among the most popular methods are peak proﬁle ﬁt (Huang and Parrish,
1975), the derivative method (Sonneveld and Visser, 1975; Huang, 1988), and
their combination (Altomare et al., 2000a).
In Fig. 12.12 we show an example of an artifact. Let us suppose that a peak
has been located at the maximum experimental count value, but the proﬁle of
the model peak is sharper than the experimental one. If the difference pattern
is analysed to ﬁnd supplementary peaks, two small peaks arise which are the
cause of the proﬁle misﬁt.
2θ
Fig. 12.12
Experimental proﬁle (continuous line)
and model proﬁle (dashed line), both
centred at the maximum count value.
The dotted line is the difference proﬁle
between the experimental and the model
peak proﬁle: two false peaks (indicated by
arrows) will be simulated (artifact) if the
difference proﬁle is explored.
In Fig. 12.13, a two-peak proﬁle is shown with its ﬁrst and second derivat-
ives. Overlapping of the two peaks does not allow automatic location of both
peaks, the second derivative reveals their positions.
Fig. 12.13
Experimental peak proﬁle, its ﬁrst and
second derivatives are shown in order
(from top to bottom). Vertical bars indic-
ate the locations of the two peaks.
No matter which speciﬁc approach is used for the pattern decomposition,
a typical computer program generally ends the automatic peak search step by
marking the determined peak positions with bars (see Fig. 12.14: this ﬁgure is
extracted from the EXPO2009 (Altomare et al., 2009a) graphical output); the
user can delete or add additional bars after visual review of the powder pattern.
Pattern modelling. This aims at deﬁning the background and decomposing
the diffraction pattern into individual proﬁles for single reﬂections. A simple
case of proﬁle modelling is that shown in Fig. 12.15, where the proﬁles of
three reﬂections, weakly overlapping, are determined. Pattern modelling may
be performed using two basic algorithms: one (Rietveld modelling), is based
on the a posteriori use of analytical functions, the second (the convolution
approach) is based on physical principles.
The Rietveld (1969) approach. The calculated diffraction intensity at step i
may be written as
yi = S

k mkLk|Fk|2G(i, k)A(i, k)Ok + yib,
(12.1)

Modelling the diffraction pattern
259
2θ
Fig. 12.14
Clomipramine hydrochloride (Florence,
A. J. et al. (2005)). Data from laboratory
diffractometer. Powder pattern after an
automatic peak search step performed by
EXPO2009. The estimated peak positions
are marked by vertical bars.
where S is a scale factor, mk is the multiplicity of the reﬂection k, L is the
Lorentz polarization factor, Fk is the structure factor, A(i, k) is the proﬁle
asymmetry function for the reﬂection k, calculated in i, Ok is the preferred
orientation correction factor, G(i, k) is the proﬁle shape function associated
with the reﬂection k and calculated at step i, and yib is the background value
at step i. This is mainly due to insufﬁcient shielding, diffuse scattering, inco-
herent scattering (often high for neutrons), and electron noise of the detector
system. The background and its variation with 2θ is usually modelled through
a polynomial of a given order (Young, 1993):
yib =
m

j=1
bj(2θi/2θ0 −1)j−1,
2θ (deg.)
3.0
0
1
2
3
l(a.u.)
6.0
9.0
12.0
Fig. 12.15
A simple case: the overall proﬁle cor-
responding to three weakly overlapping
peaks (continuous line) is decomposed
into component peaks (broken lines).
where 2θ0 is a constant (it corresponds to the 2θ position associated with the
minimum observed count in the pattern).
The proﬁle shape function, G(i, k), is determined by several factors, such
as the ﬁnite crystallite size, imperfections and inhomogeneities of the crys-
talline material, radiation-speciﬁc distributions of intensities and wavelengths,
and geometrical and instrumental aberrations. There are many choices for the
analytical peak-shape functions G. These include:
C1/2
0
√πHk
exp(−C0X2
ik) (Gaussian)
C1/2
1
πHk
(1 + C1X2
ik)−1 (Lorentzian)
2C1/2
2
πHk
(1 + C2X2
ik)−2 (modif. 1 Lorentzian)
C1/2
3
2Hk
(1 + C3X2
ik)−1.5 (modif. 2 Lorentzian)
ηC1/2
1
πHk
(1 + C1X2
ik)−1 + (1 −η) C1/2
0
π1/2Hk
exp(−C0X2
ik),

260
Phasing methods for powder data
with 0 ≤η ≤1
(pseudo-Voigt)
(β)
(β −0.5)
C4
π
1/2 2
Hk
(1 + 4C4X2
ik)−β.
(Pearson VII)
where C0 = 4 ln 2, C1 = 4, C2 = 4 (
√
2 −1), C3 = 4(22/3 −1), C4 = 21/β −1,
Xik = 	θik/Hk. Hk is the FWHM of the kth Bragg reﬂection, and  is the
gamma function.
It is easy to see that the pseudo-Voigt function presents the mixing para-
meter η, which gives the percentage Lorentzian character of the proﬁle (1 −η
is the percentage of the Gaussian component). When β = 1, 2, ∞, Pearson VII
becomes the Lorentzian, modiﬁed Lorentzian, and Gaussian function, respect-
ively. Also of use is the pure Voigt function which is the convolution of the
Gaussian and Lorentzian forms.
The FWHM is usually considered to vary with scattering angle according to,
(FWHM)G = (U tan2 θ + V tan θ + W)1/2
for the Gaussian component, and according to
(FWHM)L = X tan θ + Y/ cos θ
for the Lorentzian component. U, V, W, and/or X, Y are variable parameters in
the proﬁle reﬁnement.
Final profile
g1
g2
g6
g5
g3
g4
Fig. 12.16
Functions deﬁning the instrument func-
tion g.
The convolution approach (Wilson, 1963; Klug and Alexander, 1974;
Prince, 1993; Cheary and Coelho, 1992; Ida and Toraya, 2002; Gozzo et al.,
2006; Zuev, 2006). The calculated diffraction intensity at the angle 2θ is
assumed to be the convolution of speciﬁc experimental functions (instrumental
and sample dependent, taking into account the ﬁniteness of the source, of the
sample, of the slits, etc.), to which a background function may be added:
y(2θ) = [w(2θ) ⊗g(2θ)] ⊗f(2θ) + yb(2θ).
(12.2)
f(2θ) is a specimen-related function, g(2θ) represents the diffractometer optics,
w(2θ) depends on the wavelength distribution of the incident radiation, and yb
is the background function. The convolution w(2θ) ⊗g(2θ) is usually called
instrument function and it is the result of six speciﬁc functions (see Fig. 12.16),
g = g1 ⊗g2 ⊗..... ⊗g6,
where g1 depends on the projected spot proﬁle, g2 on the displacement of the
ﬂat specimen surface from the focusing circle, g3 on the axial divergence of
the beam, g4 on the specimen transparency, g5 on the receiving slits, and g6 on
the possible misalignment of the experimental set-up.
12.4
Recovering |Fhkl|2 from powder patterns
Let us suppose that pattern indexing has been suitably performed. As soon as
pattern modelling starts (i.e. in the case of Rietveld modelling, suitable func-
tions for A(i, k), Ok, G(i, k) and yib become ﬁxed), estimates of the |Fhkl|2s from
the pattern proﬁle become available (for each (hkl), |Fhkl|2 is the integral of

Recovering |Fhkl|2 from powder patterns
261
the proﬁle function associated with that reﬂection). Recovering the |Fhkl|2s is
usually achieved by one of the two following procedures:
1. The Pawley (1981) method. This is essentially an iterative process which
minimizes the sum of squares of the differences between the observed and
the calculated proﬁles. In a standard Pawley reﬁnement the set of paramet-
ers which are varied includes, besides cell parameters and those modelling
background and peak shape, the integrated intensities themselves. The
method suffers from severe problems of ill-conditioning, caused by the
assumption that all reﬂections have independent variable intensities which
often reﬁne to negative values. Pawley himself was aware of this prob-
lem and introduced slack constraints in the least squares process to force
the intensities to assume allowed values. The problem, however, was not
solved. Some notable papers have tried to obviate this:
(a) Since a strong ambiguity in intensities mostly occurs when two or
more reﬂections strongly (or completely) overlap, peaks which fulﬁl
this condition are treated as a single peak and the overall intensity
is equipartitioned amongst separate reﬂections (Toraya, 1986; Jansen
et al., 1992).
(b) The Bayesian approach is used as a natural probabilistic method to
impose a positivity constraint (Sivia and David, 1994). The method is
consistent with that of French and Wilson (1978), but is generalized
so as to include peak overlapping. The method provides meaningful
results even when high overlapping occurs.
2. The method of Le Bail (Le Bail et al., 1988). In accordance with the original
proposal of Rietveld (1969), single intensities are obtained by partitioning
the total observed intensity according to the calculated values for the over-
lapping reﬂections. The method does not require inversion of least squares
matrices, provides positive values for the intensities if the background is
correctly estimated, is computationally efﬁcient, but does not provide stand-
ard deviations for the intensity estimates (luckily this is not a real problem
for direct methods applications).
The Le Bail algorithm is quite simple and may be described as follows:
(a) For each reﬂection, h, an arbitrary value for the intensity is chosen, say
I0h (usually the same for all reﬂections).
(b) The contribution to the pattern proﬁle corresponding to each reﬂection
h at the ith step, is modelled according to (12.1):
yi,h = LhI0hG(i, h)A(i, h).
(c) New intensities I1h are calculated by using the formula
I1h =

i
(yi −yib) Yi,h

kyi,k
,
where the summation over k goes over all the peaks overlapping with h,
and the summation over i covers the 2θ interval in which the reﬂection
h contributes to the pattern.

262
Phasing methods for powder data
(d) The values I1h so obtained replace I0h at step (b) to generate a new
model.
The Le Bail algorithm converges rapidly to better intensities. Some least
squares cycles are usually associated with the Le Bail algorithm to reduce
the residual between the calculated and the experimental proﬁles. The para-
meters to reﬁne are scale factor, background coefﬁcients, 2θ zero shift, peak
asymmetry, half-width at half-maximum, the parameters ﬁxing the chosen
proﬁle function (i.e. Gaussian, Lorentzian, etc.), and unit cell parameters.
Each point of the proﬁle has a weight which is inversely proportional to
the experimental intensity value associated with it. The above least squares
cycles are followed by application of the Le Bail algorithm, and so on,
cyclically.
Sometimes the quality of the powder diagram is not sufﬁcient to allow good
estimates of the structure factor amplitudes. Three physical properties may
be used to improve the estimates: the positivity of the Patterson function, the
anisotropic thermal expansion, and texture effects.
Positivity of the Patterson function. This property may be useful when peak
overlapping is not severe (David, 1987; Estermann et al., 1992; Estermann and
Gramlich, 1993; Altomare et al., 1998). It is a cyclic procedure which sets
to zero the negative values of the Patterson function and back-transforms the
resulting map. For completely overlapping reﬂections the diffraction intensities
are shifted away from the original equipartitioned data and become closer to
the correct values.
Anisotropic thermal expansion. This may signiﬁcantly change peak over-
lapping (e.g. two peaks in strong overlapping at a given temperature may be
separated at another temperature); this effect may be used to improve the qual-
ity of the extracted reﬂection intensities (Shankland et al., 1997a,b). As an
example, the technique has been applied to an organic structure whose data
were collected at ESRF, Grenoble, by using a 1.5 mm capillary and a mul-
tianalyser detector, by Brunelli et al. (2003). All attempts to solve the structure
failed, despite the high quality of the data (FWHM ∼0.016˚ in 2θ). Data were
recollected at ﬁve different temperatures and, suitably combined, led to the
crystal structure solution.
Texture effects. If the powder is not ideal, the experimental data will be
affected by texture effects (i.e. systematic distortion of the intensity ratios due
to non-random orientation of the crystallites; Hedel et al., 1994; Matthies et al.,
1997). Such a distortion may be eliminated by correcting the effects of the
preferred orientation, so as to simulate ideal powder data; these techniques are
described in Appendix 12.A. The preferred orientation may, however, be expli-
citly used as a source of information, for improving the pattern decomposition
(Wessels et al., 1999; Baerlocher et al., 2004).
Let us specify equation (12.1) for the case in which the orientation dis-
tribution function has been experimentally determined as a function of the
sample tilt angle, χ, and rotation angle, φ. By emphasizing in (12.1) the
peak shape function and the preferred orientation correction we can rewrite
it as,
y(2θ, χ, φ) =

h,k,l IhklOhkl(χ, φ)G(2θ −2θhkl).
(12.3)

The amount of information in a powder diagram
263
If we now suppose that y(2θ, χ, φ) has been measured for several (χ,φ) settings
and that G(2θ–2θhkl) has been determined by standard Rietveld procedures,
then equation (12.3) may be solved for single-crystal reﬂection intensities Ihkl.
12.5
The amount of information in a powder
diagram
In single crystal diffraction experiments, the NREFL measured intensities may
be considered to be statistically independent of each other (strictly speaking,
this is not really so, as triplet relationships suggest): the information provided
by the experiment may then be considered to be proportional to NREFL. Let us
now consider a powder diagram and let us suppose that NREFL reﬂections fall
within the measured 2θ range. If two or more peaks overlap, their intensities
should be correlated (Pawley, 1981; Young, 1993; Sivia and David, 1994). For
example, if two or more peaks completely overlap, the sum of intensities must
be equal to the clump overall intensity. As a consequence, individual intensit-
ies, given prior information on the value of the clump overall intensity, cannot
be considered to be statistically independent of the other intensities belong-
ing to the clump. The question now is: is it possible to transform NREFL (the
number of correlated intensities) into Nind, an equivalent number of statistically
independent intensities?
This problem has several implications:
(a) phasing methods work well when the ratio,
number of independent intensities/number of atoms to ﬁnd is sufﬁciently
high;
(b) usual crystallographic least squares consider reﬂections which are not
symmetry equivalent as statistically independent observations; their efﬁ-
ciency is determined by the ratio
number of independent intensities/number of atoms to reﬁne;
(c) at high 2θ ranges, where the contrast peak/background intensity is
extremely low, it may happen that peak overlapping is extremely high.
In such a case, the 2θ interval is usually omitted from the calculations.
An algorithm has been proposed by Altomare et al. (1995), which, via a sys-
tematic study of peak overlapping, is able to provide an estimate of Nind.
Depending on data quality and structural complexity, the ratio Nind/NREFL
is often between 1/2 (this is the case for very high data quality, usually
obtained by synchrotron radiation) and 1/6 (for laboratory data, relatively
large structure). In the second case, crystal structure solution and reﬁnement
may be very difﬁcult. Then, supplementary information is needed to solve
the phase problem (see for example Section 12.4) and to reﬁne the structure
(e.g. via the introduction of restraints on some geometric or energy paramet-
ers (Immirzi, 1980; Pawley, 1981; Baerlocher, 1982; Elsenhans, 1990; Izumi,
1989), or by combining X-ray with neutron data (Larson and von Dreele,
1987)).

264
Phasing methods for powder data
12.6
Indexing of diffraction patterns
When a single crystal diffraction experiment is performed the usual outcome
is as follows:
1. to each diffraction spot a vectorial index h is routinely assigned;
2. the diffracted intensities are measured with reasonable accuracy;
3. unit cell and space group are unambiguously found (within the obvious
limits of the diffraction laws).
From a powder diffraction experiment unit cell, reﬂection intensities, and
space group are not directly available; some supplementary work is therefore
necessary to recover these.
Indexing is the ﬁrst step in the phasing process; its success is essential to the
other steps. Accurate measurements of the peak positions are basic conditions
for correct indexing; different types of error, random or systematic, may affect
peak positions and shapes (Klug and Alexander, 1974; Wilson, 1963; Parrish,
1965) thus making indexing a difﬁcult task. Among the systematic sources
of error we quote: a wrong zero position in the 2θ circle, axial divergence of
the incident beam (important at low angles), specimen surface displacement,
specimen transparency, and receiving slit amplitude. Most of the errors may be
corrected by ensuring perfect alignment of the diffraction instrument and by
calibrating it by using standard reference materials.
Indexing is in general easier when synchrotron data are available (because of
smallest peak overlapping) and is in general difﬁcult for laboratory diffracto-
meter data (because of the generally large width of the peaks). Shirley (1980)
underlined that ‘powder indexing works beautifully on good data, but with
poor data it will usually not work at all’.
Let us recall the basic quadratic form relating indices and reciprocal cell
parameters in the form most suitable for applications:
Qhkl = h2A11 + k2A22 + l2A33 + hkA12 + hlA13 + klA23
(12.4)
where
Qhkl = 104
d2
hkl
,
dhkl =
λ
2 sin θhkl
,
A11 = 104 · a∗2, A22 =104 · b∗2, A33 = 104 · c∗2, A12 = 104 · 2 a∗b∗cosγ ∗,
A13 = 104 · 2 a∗c∗cosβ∗, A23 = 104 · 2 b∗c∗cos α∗,
Since (12.4) is linear with respect to the unknown parameters Aij, the right
unit cell may be identiﬁed by associating correct indices to n interplanar
distances dhkl, where n depends on the lattice symmetry. As a minimum, n
equals the number of independent unit cell parameters, therefore n = 1 for the
cubic system, n = 2 for the tetragonal and hexagonal crystals, n = 3,4,6 for
orthorhombic, monoclinic, and triclinic systems, respectively.
Indexing has historically been addressed using three programs, ITO (Visser,
1969), TREOR90 (Werner et al., 1985), and DICVOL91 (Boultif and Louër,
1991), with the following approaches:

Indexing of diffraction patterns
265
ITO. Reciprocal lattice planes, deﬁned via the origin itself and any two lattice
points (zones), are searched. Pairs with a common row are identiﬁed, and
the angles between each pair are used to describe the lattice.
TREOR90. This is a classical trial and error method. Starting from cubic sym-
metry, the unit cell search is extended step by step to lower symmetry crystal
systems. For each investigated system ‘basis diffraction lines’ are selected
to which tentative indices are associated; the linear equations above are then
solved. Testing several different combinations of the basis lines enables us
to ﬁnd a correct solution, even in the case of error in one or more basis lines.
The efﬁciency of TREOR90 has been greatly improved by two modiﬁed
versions of the original approach: N-TREOR (Altomare et al., 2000a) and
NTREOR-09 (Altomare et al., 2009b), both implemented in the EXPO2009
code (Altomare et al., 2009a).
DICVOL91. Its systematic indexing approach is based on the dichotomy
method. It is applied in direct space and relies on the variation, by ﬁnite
increments, in length of cell edges and of the interaxial angles; the search
is m-dimensional, where m is the number of unknown unit cell paramet-
ers. The search is performed from high to low symmetry crystal systems by
using partitioning of the volume space.
Often, more than one feasible solution is provided, so that proper ﬁgures of
merit (FOM) must be used to distinguish between bad and good solutions. The
most popular has been M20 (de Wolff, 1961), deﬁned as follows:
M20 =
Q20
2 <ε> N20
,
where Q20 is the Q value in the case of the 20th observed and indexed peak,
<ε> is the average discrepancy between the observed and calculated Q values
for the twenty indexed peaks, and N20 is the number of calculated reﬂections
up to the d value corresponding to Q20.
The progress in power and speed of modern computers suggests that new
generation indexing programs will rely on the full pattern rather than just
on the line positions. Solution may be described as follows: the best lattice
[a, b, c, α, β, γ ] is that providing the best agreement between the observed and
calculated diffraction patterns. At the same time, the concept of effective ﬁgure
of merit has evolved. For example, it should:
(a) be deﬁnable for any interval of the experimental pattern;
(b) take into account the peak intensities (e.g. correct indexing should not miss
the strongest lines of the pattern);
(c) not be very sensible to the presence of impurity lines;
(d) take into account the number of generated peaks and their overlap (e.g.
quite large wrong unit cells may easily index a pattern);
(f) be comprised in the interval (0,1), to be interpreted as the probability of
the correct indexing.
An example of such an evolved FOM is WRIP20, introduced into the program
NTREOR-09.

266
Phasing methods for powder data
12.7
Space group identiﬁcation
Unequivocal deﬁnition of the extinction symbol (and therefore of the space
group) is often difﬁcult from powder data, even when the unit cell paramet-
ers have been correctly deﬁned. This is because: (a) the Laue group may be
identiﬁed with difﬁculty when overlapping is severe. Indeed, the intensities of
symmetry-independent reﬂections may be estimated with low accuracy when
they overlap; (b) systematic absences, if present, can be obscured by other non-
zero intensity reﬂections with which they overlap (see Fig. 12.17). Thus, the
chosen space group must be carefully reconsidered if any attempt at solving
the crystal structure turns out to be unsuccessful.
Two alternative automatic methods have been proposed, the ﬁrst one, imple-
mented into the package DASH (Markvardsen et al., 2001), and the second
(Altomare et al., 2004, 2005, 2007), implemented into EXPO2009. Both are
based on statistical analysis of the reﬂection integrated intensities and provide
a quantitative estimate of the probabilities of the different extinction symbols
that are compatible with the crystal system (that determined by the index-
ing process). The following preliminary step is necessary: the experimental
powder diffraction diagram is decomposed via Le Bail or Pawley algorithms
into single diffraction intensities in the space group with the largest Laue sym-
metry and no extinction conditions (e.g. P2/m for monoclinic, P2/m2/m2/m
for orthorhombic, P4/mmm for tetragonal, P6/mmm for trigonal–hexagonal
systems, and Pm3m for the cubic system).
The EXPO2009 approach is essentially that described in Section 2.6 for
single crystal data. The normalized intensities, zh = |Eh|2, are calculated
and submitted to statistical analysis for the determination of the space group
symmetry. The analysis is based on the expectation that the mean value
<zh> calculated for the systematically absent reﬂections should be close
to zero, while it should be close to unity when calculated for non-absent
reﬂections.
At the end of the calculations, the probability value for each extinction
symbol, compatible with the lattice symmetry established by the indexing
procedure, is provided. The extinction symbol with the largest probability is
preferred; the space groups compatible with it are the best candidates.
19.04
19.06
19.08
19.10
19.12
2θ
(0 0 3)
(2 1 –2)
(3 0 1)
19.14
19.16
19.18
19.20
Fig. 12.17
Clomipramine
hydrochloride,
space
group P21/c. The experimental peak
proﬁle arises from the overlapping of
three peaks (the corresponding reﬂection
indices are quoted in the ﬁgure), one of
which [say (3 0 1)] belonging to the set
of systematically absent reﬂections.

Ab initio phasing methods
267
12.8
Ab initio phasing methods
Let us suppose that there is no information on the molecular geometry avail-
able. If the unit cell has been found, if the full pattern decomposition program
has been successfully applied to obtain the |Fh|2 values for each reﬂection, and
if the space group has been identiﬁed, then we have all we need to start ab ini-
tio phasing methods for single crystal data. Then, traditional direct Methods,
Patterson techniques, charge ﬂipping, or VLD may be applied: indeed, the
phase information is hidden in the diffraction moduli (see Chapter 1) and these
methods just aim to recover it. However, if moduli are estimated approxim-
ately, as usually occurs in powder crystallography, the phasing process will be
less efﬁcient. This is exactly what happens in practice: crystal structure solu-
tion is more difﬁcult because the amount of information collected by a powder
is smaller than for a single crystal experiment. This has been the reason for the
vigorous development activity and for the success of non-ab initio methods,
described in Section 12.9.
For ab initio phasing techniques it is useful to note the following:
(a) Application of the Wilson method (see Chapter 2) does not provide useful
information on the centric or acentric nature of the compound (Cascarano
et al., 1992c; Estermann and Gramlich, 1993). Different indications may
be obtained according to which pattern decomposition algorithm is used.
The Pawley technique, if not suitably modiﬁed, may provide negat-
ive intensities for some of the overlapping reﬂections; as compensation,
single individual intensities larger than the clump overall intensity could
be provided. This effect enlarges the variance of the intensity distribu-
tion and suggests centric groups, even when the structure is acentric.
Conversely, the Le Bail algorithm intrinsically tends to equipartition the
overall intensity among severely overlapping reﬂections. The general stat-
istical consequence is that the dispersion of the structure factor amplitudes
appears smaller than it really is, and acentric groups are suggested even
when the real space group is centric.
(b) The Wilson scaling process sometimes ends with a negative overall tem-
perature factor (Cascarano et al., 1992c). This result may be caused by
truncation of experimental data to where the Debye effects are important
(see Section 2.9) or by imperfect modelling of the background and the
peak shape (Lutterotti and Scardi, 1990). Indeed at high-angle regions of
the pattern the decay of the X-ray atomic scattering factors can make back-
ground deﬁnition critical; even small errors in the background modelling
can produce non-negligible changes in amplitude estimation.
(c) The experimental data resolution RES may be non-atomic; indeed, owing
to the strong overlapping, the pattern at high 2θ angles may be very noisy
and therefore may be omitted from the phasing process. The overall effect
is a shortage of reliable triplets in the case of direct methods, and, in
the electron density maps, a strong resolution bias. An effective method
for minimizing the resolution bias (see Section 8.2) has recently been
described and successfully applied to powder data (Altomare et al., 2008a,
2008b, 2009c, 2010). The algorithm is based on a generalization of the
concept of a Gaussian-like peak, which is replaced by a two-component

268
Phasing methods for powder data
function, extending over the full unit cell, and consisting of the main peak
and by the corresponding ripples. The theory models main peaks and cor-
responding ripples both in direct and in reciprocal space, and provides
mathematical tools for minimizing the resolution bias of a given electron
density map calculated at the experimental data resolution. Application
of the algorithm is cyclic and, combined with EDM techniques, is able
to move atoms into more correct positions, thus contributing to a full
recovery of the structure.
(d) The least squares normally used to reﬁne a given structural model are not
very effective for powder data because of:
(i) the usually low ratio between number of reﬂections in the measured
range and the number of parameters to reﬁne;
(ii) the correlation between reﬂection intensities caused by peak overlap-
ping;
(iii) low accuracy in the observed diffraction moduli (i.e. the estimated
intensities provided by the pattern decomposition programs).
To overcome point (i), supplementary information is needed. This usu-
ally comes from restraints on some geometric (angles, distances, planarity,
etc.) or energy parameters (Immirzi, 1980; Pawley, 1981; Baerlocher, 1982;
Elsenhans, 1990; Izumi, 1989).
To reduce the effects of correlation among overlapping reﬂections, a spe-
cial weight, w, may be used within the S function that least squares tries to
minimize (Altomare et al., 2006):
S =

h
wh(Ioh −Ich)2;
wh is also designed to take into account the reﬂection overlapping and Ioh
and Ich are the estimated observed and calculated intensities for the reﬂec-
tion h. A different approach is based on a non-diagonal weighted least squares
procedure (Will, 1979). The function that is minimized is
¯DWD,
where D is the vector of the residuals between observed and calculated
intensities and W is a weight matrix which is proportional to the inver-
ted variance–covariance matrix relative to the observed integrated intensities
(Kockelmann et al., 1985).
In spite of the above difﬁculties, the ab initio phasing techniques so far
summarized may often succeed, provided that the peak overlapping is not too
severe. To compensate for the low (with respect to single crystal data) quality
of powder diffraction data, some low-level prior information may be used in
the phasing process. If such information is not speciﬁc for the molecule under
study, but nevertheless is valid for a wide range of materials, such methods may
be considered ab initio. The two techniques summarized below, say POLPO
(Altomare et al., 2000b; Giacovazzo et al., 2002) and COVMAP (Altomare
et al., 2012a; 2012b), may be better considered as subsidiary to the ab initio
methods, designed to improve their convergence.

Ab initio phasing methods
269
POLPO is based on the fact that direct methods applied to powder diffrac-
tion data often provide well-located heavy atoms and unreliable light-atom
positions; completion of the crystal structure is then not always straightfor-
ward. Prior knowledge of the heavy-atom polyhedral coordination is used in a
Monte Carlo procedure aimed at locating the light atoms under the restraints of
the experimental heavy-atom connectivity model. The correctness of the ﬁnal
model is assessed by criteria based on the agreement between the whole exper-
imental diffraction pattern and the calculated one. The procedure requires little
cpu computing time and has been implemented as a routine in EXPO2009 (see,
for example, Altomare et al. (2009a) and literature quoted therein). The method
is sufﬁciently robust against the distortion of the coordination polyhedra and
has been successfully applied to some test structures.
POLPO may also succeed if only some of the cations are correctly located;
it is also able to locate missing cations and surrounding anions when the cation
coordination is tetrahedral or octahedral.
As
an
example,
in
Fig.
12.18,
the
case
of
chromium-chromate-
tetrachromate, Cr8O21,is given. Three chromium positions (Fig. 12.18a)
are well located by direct methods, and are used in POLPO as the starting
model for recovering the missing cation and all of the anions. The distance
Cr1–Cr2 was compatible only with a fourth Cr (the missed one) with octahed-
ral coordination. Therefore, some directives were given to POLPO to ﬁnd the
anions of the three located Crs in tetrahedral coordination, with cation–anion
distances equal to 1.75 Å, and the missed Cr (and corresponding anions)
with octahedral coordination, with distances cation–anion equal to 1.90 Å
(see Fig. 12.18a). POLPO provided the complete and correct structure model
depicted in Fig. 12.18b.
COVMAP is based on the concept of covariance between two points of an
electron density map (see Section 7.4); i.e. the density at one point depends on
the density at another point of the map if their covariance is not vanishing. Let
us suppose that the available structural model is not interpretable, because it
contains a large percentage of misplaced peaks. Around each correctly posi-
tioned peak (i.e. the pivot peak), one or more atoms should be present at
bond distance, unless the pivot atom is isolated. Since the current model is so
poor that the corresponding electron density does not achieve sufﬁciently high
values at the pixels located at bond distance from the pivot peak, COVMAP
modiﬁes the corresponding current density. In practice the largest peaks of the
a)
Cr3
Cr2
Cr1
Cr3
Cr2
Cr1
O10
O12
O9
O8
O2
O5
O4
O7
O3
O1
O11
b)
Build octahedron between cations Cr1 and Cr2
    in Chromium with distance = 1.90 Å
Build tetrahedron around Cr1 with distance = 1.75 Å
Build tetrahedron around Cr2 with distance = 1.75 Å
Build tetrahedron around Cr3 with distance = 1.75 Å
Fig. 12.18
Chromium-chromate-tetrachromate,
Cr8O21 (Norby, P. et al. (1991)). (a) the
three chromium positions located by
direct methods and the directives given to
POLPO for completing the structure; (b)
correct solution provided by POLPO.

270
Phasing methods for powder data
a)
b)
C14
N2
N2
N1
C16
C8
C13
C17
C7
Cl1
C12
C10
C11
C6
C18
C9
C3
O1
C5
C15
C4
C1
Fig. 12.19
S-Bupivacaine hydrocloride, C18H28N2O·
HCl (Niederwanger, V. et al. (2009)).
(a) the structure model obtained at the
end of the ab initio solution process of
EXPO2009 standard version; (b) correct
model obtained at the end of the RBM–
COVMAP–wLSQ procedure.
map are, in turn, considered pivots, and for each pair of these, the reason-
able expectation that some other peak would be present at bond distance from
them is transformed into electron density modiﬁcations. In this way, new cor-
rect atomic positions can be generated which, submitted to two other important
reﬁning tools such as RBM (resolution bias minimization algorithm, mentioned
in point (c) above) and wLSQ (weighted least squares, mentioned in point (d)),
often lead to the correct structure, even if the starting model is very poor. The
RBM–COVMAP–wLSQ procedure has been introduced into EXPO2009. In
Fig. 12.19, the case of S-bupivacaine hydrocloride, C18H28N2O·HCl (22 non-H
atoms in the asymmetric unit) is considered. In (a) the structure model,
obtained at the end of the ab initio solution process of EXPO2009, standard
version, appears chemically non-interpretable. Figure 12.19b shows the correct
model derived through application of the RBM–COVMAP–wLSQ approach.
It is very close to the true one; only amendable errors in the chemical labels
are present.
The current version of COVMAP may be considered to be a tool for complet-
ing an incomplete and disturbed model provided by direct methods. However,
a new version of COVMAP has been set up (Altomare et al., 2013) which is
applied to random starting models; the method may then be considered to be a
self-consistent ab initio approach.
12.9
Non-ab initio phasing methods
Let us suppose that:
(a) for an organic compound, substantial prior information on the molecu-
lar geometry is available (the same hypothesis also holds for inorganic
structures with well-deﬁned building units);
(b) a chemically feasible model, ﬁxing the connectivity of the various atoms in
the molecule, has been constructed by some model-building program (such
as Cerius2, Chem3Dultra, or Sybyl, with the support of the Cambridge
Structural Database (CSD));
(c) the model is described in terms of internal coordinates; i.e. bond lengths,
bond angles, and torsion angles. Bond lengths and angles may be con-
sidered to be approximately ﬁxed, while torsion angles are allowed to vary
freely. An example is shown in Fig. 12.20, where the torsion angles of an
organic molecule are emphasized.
Fig. 12.20
The very simple molecule of ibuprofen
(Shankland, K. et al. (1998)). The arrows
show the torsion angles.

Non-ab initio phasing methods
271
To solve the structure, one needs to determine the torsion angles (internal
degrees of freedom, or internal DOFs) and the global parameters deﬁning posi-
tion and orientation of the molecular fragment(s) (external DOFs). This may be
accomplished by using direct-space techniques (DST), which employ global
optimization algorithms to ﬁnd the best DOF values. These algorithms are
able, starting from any random point, to escape from local minima up to when
the global minimum is found. An appropriate ﬁgure of merit, called cost func-
tion (CF), measures the ﬁtting agreement between experimental and calculated
(from the current model) powder diffraction patterns; pattern decomposition
is therefore not needed. Grid search, Monte Carlo, simulated annealing, and
genetic algorithm are the search methods most commonly used for solving the
structure.
Grid search methods. Systematic translations and rotations are performed by a
suitably ﬁne grid in the asymmetric region (Chernishev and Schenk, 1998).
The method is intuitive, but rather time consuming; indeed it is often applied
to rigid models.
Monte Carlo methods. Let us describe these methods in steps:
1. The parameter space is randomly sampled, that is, random values are
associated with the various parameters deﬁning the starting conﬁgura-
tion. This is the initial model.
2. Any new trial conﬁguration is generated from the preceding one
(Markov chain) through small random displacements in the parameter
space (Harris et al., 1994; Andreev et al., 1997; Tremaine et al., 1997).
For example, the generic parameter pi is changed into
(pi)new = (pi)old + risi	pi,
where ri is a random number in the interval (0,1), si may be + 1 or –1, it
is chosen in a random way, and deﬁnes the sense of the displacement,
	pi is the pre-deﬁnite maximum step allowed for the ith parameter.
3. The cost function is calculated; the new trial model is accepted
(Metropolis et al., 1953) if CF < CFold. It is also accepted with
probability
exp

−(CF −CFold)/T

(12.5)
if exp[–(CF–CFold)/T] > r, where r is a random number between 0 and
1. T is an appropriate scaling factor.
4. When the new model is accepted, it is considered to be a new conﬁg-
uration in the Markov chain, and the algorithm returns to step 2. If the
new model is rejected, the algorithm returns to step 2, but the search
then starts from the old model.
The efﬁciency of Monte Carlo methods is increased if the potential
energy of the structural models is calculated; this avoids the acceptance
of unrealistic structures.
Simulated annealing techniques. Sampling Monte Carlo techniques are used
but the scaling factor T is varied in accordance with an annealing sched-
ule. According to Kirkpatrick et al. (1983), the cost function should be
interpreted as the energy of the physical system, the global minimum

272
Phasing methods for powder data
conﬁguration assumed as the ground state, and the Metropolis criterion con-
sidered as the Boltzmann factor exp(−E/kBT), for the energy level E: kB
is then the Boltzmann constant and T is the temperature. The ground state
may be reached by slowly lowering its temperature, and avoiding the system
being trapped in local minima (David et al., 2001; Putz et al., 1999; Engel
et al., 1999; Coelho, 2003; Le Bail, 2001). A powerful implementation of
the simulated annealing approach has been proposed by Favre-Nicolin and
ˇCerny (2002), who used parallel tempering techniques in performing a small
number of parallel optimizations.
Genetic algorithm techniques. The evolution from a random to the correct
model is interpreted on the basis of the Darwinian theory of evolution;
selection rules push the population to evolve to the state of best ﬁtness (see
Goldberg, 1989). The crystallographic problem may be expressed in terms
of biological evolution terminology if the following equivalences are used:
a DOF corresponds to a gene (both vary under selection rules), the sequence
of DOFs characterizing the current model corresponds to a chromosome (the
properties of the current model and of living beings are fully characterized
by the DOF sequence and by the chromosome), the CF corresponds with the
ﬁtness associated with each model (a favourable CF value corresponds with
a good ﬁtness). If we consider a single evolution step (and, equivalently,
a step in the model modiﬁcation), three different operations may be per-
formed: selection (drives the population towards the best ﬁt by the selection
rules), mating (mixes the genetic information of the two parents), mutation
(this may occur and prevent stagnation of the characters).
An important feature of the genetic algorithm is parallelism, which allows
us to treat different members of the population simultaneously (Kariuki
et al., 1997; Shankland et al., 1997a,b)
Hybrid approaches. These global optimization methods have the merit of com-
bining the best features of two different algorithms. Of particular interest is
the combination direct methods–simulated annealing. In the case of organic
compounds (Altomare et al., 2003), direct methods may be unable to provide
a fully interpretable electron density map; it is, however, probable that some
atomic positions are correct. Such positions may be used as a pivot for
model searching via simulated annealing; then, the three DOF global trans-
lation parameters are no longer necessary, and the total number of DOFs is
correspondingly reduced.
APPENDIX 12.A
MINIMIZING TEXTURE EFFECTS
In Fig. 12.A.1, we show the different diffraction patterns of AGPZ, obtained
by Masciocchi et al. (1994) by varying the sample preparation technique.
In the ﬁrst of the three patterns, owing to a strong preferred orientation, only
(0k0) lines are present; a nearly perfect powder, devoid of texture effects, is
obtained only after the third sample preparation. Sometimes, in spite of great
efforts, texture effects cannot be avoided; then one has to derive, from the
observed intensities, those corresponding to a randomly oriented specimen.

Minimizing texture effects
273
1000
(020)
(040)
(060)
(080)
(0,10,0)
a
b
c
800
600
400
200
0
5
10
15
20
25
2θ (deg)
30
35
40
45
50
Fig. 12.A.1
AGPZ: [Ag(C3H3N2)]n (Masciocchi et al.,
1994). Different diffraction patterns ob-
tained by varying the sample preparation
technique. (a) Impressive texture effects.
This may be done by measuring pole density distributions for a number of
reﬂections, followed by inversion of data to produce pole density for all of
the other reﬂections (see Bunge et al., 1989 and references therein). Such
a procedure requires a multi-axis goniometer and additional experimental
work. A variant to this approach is the symmetrized harmonic method (see
Järvinen, 1993 and references therein), which represents pole ﬁgures by spher-
ical harmonic functions and may be applied to specimens with cylindrical
symmetry.
pole [hkl]
Fig. 12.A.2
The reciprocal space is divided into cones
around a direction [hkl].
An alternative method for texture correction (Altomare et al., 1994a, 1996;
Peschar et al., 1995) may be applied to usual powder diffractometer data,
provided that the sample has cylindrical symmetry (frequently ﬂat powder
samples or capillary tube samples composed of effectively rod- or disc-
shaped crystallites tend naturally towards axial symmetry). The method may
be described as follows:
(a) The diffraction pattern is decomposed into single intensities. In the
absence of any information on the texture, computer programs will provide
biased values, |F′
k|2, which are related to the true |Fk|2 by the relation
|F′
k|2 = |Fk|2Ok.
(12.A.1)
where Ok is the preferred orientation correction factor.
(b) A normalization program derives the normalized structure factor moduli,
|E′|, from the |F′|s.
(c) n reciprocal lattice rows [hkl] are selected, whose directions are expected
to be uniformly distributed. In practice, the n reﬂections (n between 10 and
30) with the smallest sin θ/λ are considered as a sufﬁciently exhaustive
set of planes candidate for being preferred orientation planes. For each
reﬂection h in the set, steps (d) and (e) are executed in sequence.
(d) Reciprocal space is divided into cones around the direction [h] = [hkl]
(see Fig. 12.A.2), each cone contained in the successive one. Each shell
(i.e. the region of reciprocal space between two neighbouring cones) will
have approximately the same volume so as to include, on average, an equal

274
Phasing methods for powder data
number of reﬂections. For all reﬂections k in the shell, the angle α between
the ks and h will be approximately constant.
(e) For each shell,

|E′
k|2
is calculated; the various

|E′
k|2
values are then
plotted against α.
(f) The von Mises distribution,
O = exp(G cos 2α)
best ﬁtting the experimental data is calculated by a least squares procedure.
O is the preferred orientation correction factor.
(g) The plane h (among the candidates) with the ﬁnal highest value of G is
selected as the preferred orientation plane.
(h) The normalized intensities, |E′
k|2, are renormalized to |Ek|2 according to
|Ek|2 = |E′
k|2O−1
k .
The |Ek|2 so obtained will constitute the new ‘observed’ normalized mod-
uli for the direct phasing process. |Ek| are expected to be closer to the true
values than the |E′
k|s; as a consequence, the phasing process should be more
straightforward giving more accurate atomic parameters.

Molecular replacement
13
13.1
Introduction
Modern phasing methods may be subdivided into:
(a) ab initio approaches, which include direct methods, Patterson techniques,
charge ﬂipping, and VLD (vive la difference). These approaches do not
use (but, suitably modiﬁed, some of them can) any prior information on
the molecular geometry.
(b) non-ab initio methods. In this category, we include molecular replace-
ment (MR), isomorphous derivatives (SIR-MIR) and anomalous dispersion
(SAD-MAD) approaches. MR exploits information on the molecular geo-
metry (i.e. the target molecule is known to be similar to that present
in another previously solved structure), SIR-MIR uses the supplement-
ary information contained in the experimental data from one or more
isomorphous structures, and SAD-MAD exploits anomalous dispersion
effects (we will see that such effects simulate isomorphism).
It is immediately clear that classiﬁcation into ab initio and non-ab initio cat-
egories may be questionable, because it hides substantial diversities in the
prior information. For example, SAD-MAD, unlike SIR-MIR, may use the
native protein data only, and no prior information on the molecular geometry
is necessary; apparently, this may be considered to belong to the ab initio cat-
egory. MR does not use supplementary experimental data, and therefore seems
not to be similar to SAD-MAD and SIR-MIR. The latter two techniques are
often referred to as experimental phasing approaches, but also this appella-
tion is questionable; indeed, the experiment does not provide phases, these are
derived by treating the experimental data, as in any other phasing approach.
The above considerations suggest that a more precise, even if conventional,
deﬁnition for ab initio methods is necessary; in this book, they are identiﬁed as
those techniques which do not use the molecular geometry as prior information
and exploit only native data, without anomalous dispersion effects. We have
seen in Section 12.8 that some approaches use low-level prior information, not
speciﬁc to the current structure, but valid for a large range of compounds (e.g.
the coordination of some heavy atoms and corresponding bond angles and dis-
tances). Also such procedures may be considered as ab initio approaches; to

276
Molecular replacement
this category we add ARCIMBOLDO, which combines the ‘trivial’ informa-
tion that a protein consists of smaller molecular fragments of known geometry
(among which are α-helices) with MR. ARCIMBOLDO is summarized in
Section 13.9.
This chapter is devoted to MR (SIR-MIR and SAD-MAD techniques will be
described in Chapters 14 and 15, respectively). Basically, MR may be deﬁned
as a method for phasing a target structure when a model molecule, structurally
similar to the target, is available. It implies the use of mathematical techniques
for correctly orienting and locating the model molecule in the unit cell of the
target structure, and may be applied to small, medium, and macro molecules
(see Section 12.9 for its application to powders).
A basic difference exists between the MR approaches used for small
molecules (e.g. see Section 12.9 for non-ab initio methods in powder diffrac-
tion crystallography) and the typical MR used in protein phasing. When small
molecules are treated, the model is usually non-rigid; indeed the solution is
found when the correct values of the internal (e.g. torsion angles) and external
(e.g. orientation and location of the full model molecule) free parameters are
determined. In this case, the small size of the structural problem allows the use
of internal degrees of freedom. Conversely, when proteins are treated, the large
size of the problem requires the use of rigid models.
MR is particularly important for proteins to which ab initio methods cannot
be applied; indeed MR is by far the most popular phasing technique in mac-
romolecular crystallography and we will essentially focus our attention on its
applications to proteins. The reasons for its success are twofold:
(a) The cost and effort necessary for preparation of one or more isomorphous
derivatives, or, in the case of anomalous scattering, for setting up Se-Met
labelled proteins or for collecting data based on S anomalous scattering,
are not needed.
(b) Models similar to the target protein molecule (the concept of similarity is
essentially based on sequence identity) are becoming increasingly avail-
able. Recent statistics on the Protein Data Bank (PDB) is depicted in Fig.
13.1; the new fold topologies are becoming increasingly rare. It is not
surprising, therefore, that more than 75% of protein structures are today
solved by MR.
MR may also be applied to deﬁning non-crystallographic symmetry (NCS); if
more than one protein molecule is packed in the same asymmetric unit, dif-
ferent molecules will be related by local symmetry axes. The orientation and
position of the NCS axes may be found using MR techniques; this information
may be used to improve the efﬁciency of phase reﬁnement procedures (see
Section 8.2).
MR for proteins is essentially a six-dimensional problem; at least three rota-
tion angles and three components of the translation vector must be found.
Performing a six-dimensional search directly is too demanding in terms of
computer resources and is still not popular. In Section 13.3, a short description
of six-dimensional searching is given.
Far fewer computational resources are required if the search is broken
into a three-dimensional rotation search, followed by a three-dimensional

About the search model
277
1300
Growth of unique fold topologies per year
as defined by CATH (version 3.4.0)
number of folds
1200
1100
1000
900
800
Cumulative growth
Differential growth
700
600
500
400
300
200
100
0
1976
1978
1980
1982
1984
1986
1988
1990
1992
Year
1994
1996
1998
2000
2002
2004
2006
2008
2010
Fig. 13.1
Growth of unique fold topologies per year as deﬁned by CATH (version 3.4.0). The two curves represent the cumulative and the differential
growths. CATH categorizes structures according to type of structure and assumed evolutionary relations.
translation search (Rossmann and Blow, 1962). Various efﬁcient programs
have been written using this strategy [MERLOT (Fitzgerald, 1988), GLRF-
REPLACE (Tong and Rossmann, 1990; Tong, 1993), X-PLOR/CNS (Brünger
et al., 1998; Grosse-Kunstleve and Adams, 2001), AMoRE (Navaza, 1994),
MOLREP (Vagin and Teplyakov, 1997); Beast (Read, 2001), ACORN_MR
(Yao, 2002), REMO (Caliandro et al., 2006), Phaser (McCoy et al., 2007),
REMO09 (Caliandro et al., 2009)].
Our description will substantially follow the basic Rossmann and Blow
approach because this provides the simple mathematical basis of the method.
This point of view will be integrated through illustration of more modern
algorithms.
13.2
About the search model
MR is very efﬁcient when the search model is sufﬁciently similar to the target
structure. Its application is, therefore, straightforward for mutants or ligand-
bound proteins where the conformational changes are local. The sequence
identity (say ID) may be used as a criterion for estimating such a similarity;
in particular, one can estimate the root mean square deviation (in short, RMS)
between pairwise Cα backbone positions according to the Chothia and Lesk
(1986) relation,
RMS = 0.4 · exp[1.87(1 −ID)].
(13.1)
Some programs also use
RMS = max {0.8, 0.4 · exp[1.87(1 −ID)]}

278
Molecular replacement
to avoid the underestimation of RMS. The following two lines may be used as
a practical guide for the estimation of RMS:
ID (%)
100
64
63
50
40
30
20
→0
RMS

Å

0.80
0.80
0.80
1.02
1.23
1.48
1.78
2.60
High values of ID, and therefore small values of RMS, will make MR straight-
forward; indeed, proteins with similar sequences very often fold in similar
structures. For example, as frequently occurs when the same protein, under
different crystallization conditions (e.g. change of pH, change of solvent, etc.),
crystallizes in different space groups. In this case, the model molecule found
in a given space group may be used for phasing in the other space groups.
However, the extraordinary ﬂexibility of some molecules can make the use of
(13.1) critical; indeed, two molecules may have a high sequence identity but an
unusually high value of RMS. Conversely, two molecules with low sequence
identity may show a small value of RMS; this usually occurs when they have a
large functional identity.
As a rule of thumb, if ID ≤0.30 (or RMS ≥1.5 Å) MR techniques rarely
produce correct solutions; quite crucial, therefore, is the correct identiﬁcation
of a good search model, a context in which the alignment of the protein and
of the model sequences (the set of residue-by-residue equivalences between
the two sequences) may play a central role. Various software packages may
be applied for this purpose, among which we quote the dynamic alignment
algorithm by Needleman and Wunsch (1970). When there is a low identity
between the target structure sequence and those of possible homologues, iden-
tiﬁcation of the best search model is time consuming. To increase the MR
productivity some automated pipelines have been proposed such as NORMA
(Delarue, 2008), MrBUMP (Keegan and Winn, 2008), BALBES (Long et al.,
2008), part of the JSCS software (Scwarzenbacher et al., 2008), or automated
servers like OCA (Boutselakis et al., 2003) and PSI-BLAST (Altschul et al.,
1997); they automate identiﬁcation of the best model by using the amino acid
sequence and a customized version of the PDB database.
To reduce the risk of failure, large ﬂexible parts of the model may be
pruned, as well as those parts for which there is a lack of sequence alignment;
indeed, it is not unusual for polyalanine models to be submitted to MR with
more chances of solving the structure than the models including side chains.
Various pruning procedures may be adopted. For example, in CHAINSAW
(Schwarzenbacher et al., 2004), one of the programs in CCP4 (see Winn et al.,
2011), given a sequence alignment between template and target, the template
structure is modiﬁed on a residue by residue basis by pruning non-conserved
residues, while conserved residues are left unchanged. It is usually assumed
that gaps and insertions are impossible within sequence segments correspond-
ing to helices and strands. Sheet structures have higher percentages of ﬂexible
loop residues and therefore they are more sensitive to low sequence identities
than largely helical structures.
In MOLREP, the search model is modiﬁed as follows: (i) residues that
align with gaps in the target sequence are deleted; (ii) in case of a pair aligned
residues, atoms in the search model without correspondence in the target are
deleted.

About the six-dimensional search
279
NMR-based search models are rarely useful for MR (Chen et al., 2000),
while search models based on ab initio modelling start to play an important
role. Prediction of protein structures from their amino acid sequences is still
a challenge in computational structural biology: the main obstacles are the
large number of degrees of freedom in a protein chain and the complicated
energy landscape deﬁned by the strong atomic repulsion at short distances.
Here, we mainly refer to ROSETTA (Qian et al., 2007), a very popular program
for ab initio prediction, which is able to produce a large number of models by
combining fragments of known structures having sequences locally compatible
with that of the target. The fragments are clustered, and the ﬁnal conformations
are submitted to a process, minimizing a physically realistic energy function.
A seminal attempt for exploiting ROSETTA models for MR has been made by
Ridgen et al. (2008); they selected 16 test cases for which a maximum of 30%
sequence identity to previously determined structures was allowed. For ten of
them, sufﬁcient reliable trial models were produced, to which MR was applied.
In two cases, a complete crystal structure was obtained, via Phaser, from the ab
initio models. The number increased to three when a special EDM procedure
was applied to the electron density provided by the MR step (Caliandro et al.,
2009). The conclusion is that while ab initio modelling is, today, unable to
solve structures on its own, it may be useful when it is coupled with another
source of independent information like the crystallographic experimental data.
A last parameter, say n, the number of monomers in the asymmetric unit,
deserves to be discussed. Indeed, less straightforward is the application of MR
when more molecules are in the asymmetric unit of the target structure; if
there are n monomers, but the model consists of one monomer, then n suitable
orientation and translation movements are necessary to ﬁnd the target structure.
Since the scattering power of the model structure is 1/n (at best) of the target
scattering power, recognition of the correct rotations and translations will be
difﬁcult, and the difﬁculty will increase with n. If the n monomers have strong
intermolecular contacts, and a complete model constituted by n monomers is
available, then a structure solution may be more easily attempted (provided that
the monomers maintain the same conﬁguration in both the target and model
structures). For example, tetramers often exhibit a 222 point symmetry because
they are dimers of dimers. If the dimer also maintains the same conﬁguration
in the model, it may be used as a search molecule.
13.3
About the six-dimensional search
Suppose that we have found a good model protein molecule and that we have
collected the target experimental data. How do we exploit such information
to solve the target crystal structure directly via a six-dimensional search? The
most naive idea is to divide the asymmetric unit into grid points. After hav-
ing located the molecule in a grid point, orient the molecule in all possible
orientations and calculate the corresponding structure factor. If the crystallo-
graphic residual is never sufﬁciently small, move the molecule to another grid
point and repeat the calculations. The correct structure will be found when the
crystallographic residual is sufﬁciently small. In practice, the algorithm may
be too time consuming even for modern computers because:

280
Molecular replacement
(i) the grid must be sufﬁciently ﬁne otherwise possible solutions will be lost.
Thus, if we subdivide the asymmetric unit into 100 × 100 × 100 grid
points, the total number of grid points to explore would be 106;
(ii) for each grid point we should calculate 3603 structure factor calcula-
tions (one structure factor calculation for each molecule orientation, if we
rotate in independent 1◦intervals), for a total of 106 × 3603 = 4.7 × 1013
structure factor calculations, a huge number of calculations. The reader
should consider that each structure factor calculation involves thousands
of reﬂections and for each reﬂection, thousands of atoms.
There are, however, algorithms for making the six-dimensional search practical
(among the various computing programs we quote: Chang and Lewis, 1997;
Sheriff et al., 1999; the program ULTIMA by Rabinovich and Shakked, 1984;
Queen of Spades, by Glykos and Kokkinidis, 2000a,b; SOMoRe, by Jamrog
et al., 2003; EPMR by Kissinger et al., 1999). Two problems must be solved:
(a) ﬁnd a very fast structure factor computation algorithm and replace the
naive search approach by an efﬁcient search algorithm. A ﬁrst attempt
to speed up structure factor calculation may be made by using the FFT
(fast Fourier transform) algorithm; ﬁrst, the shape of the electron density
is approximated by a Gaussian function, and then the Fourier back trans-
form provides the required structure factors. The method is much faster
than calculation from an atomic model, and the difference increases with
the size of the structure. This algorithm is, however, not able to substan-
tially reduce the computing time involved in a six-dimensional search.
A superfast algorithm may be used, based on a Fourier transform inter-
polation algorithm (Lattman and Love, 1970; Huber and Schneider, 1985;
Kissinger et al., 1999). Since the search molecule is rigid, and the rel-
ative coordinates do not change, if the electron density is sampled in a
sufﬁciently ﬁne grid, then the structure factors at any orientation may
be obtained by interpolation, while the translation is quantiﬁed by the
corresponding phase shifts.
(b) replace the exhaustive search algorithms by superfast search approaches,
which may be selected from among those used in stochastic optimization
methods (see Section 12.9 for their applications to powders), like genetic
and evolutionary algorithms (e.g. in EPMR, by Kissinger et al., 1999).
However, in spite of the great work done in making six-dimensional searching
viable, most of the MR applications are performed via programs in which a
six-dimensional search is broken up into a three-dimensional rotation search,
followed by a three-dimensional translation search. This is the method we will
describe in the following sections.
13.4
The algebraic bases of vector search
techniques
Let us consider a P1 structure with two similar or identical molecules in arbit-
rary orientations: X and X′ are the coordinates of a pair of corresponding

The algebraic bases of vector search techniques
281
atoms in the crystallographic reference system. According to Fig. 13.2, a linear
transformation of type
X′ = MX + N,
(13.2)
1
x1
x1¢
y1
y1¢
2
Fig. 13.2
A linear non-crystallographic symmetry
operator transforms the set of coordinates
X ′i =(x′i, y′i) of molecule 1 into the set of
coordinates Xi = (xi, yi) of molecule 2.
will (approximately, if the molecules are not perfectly identical) relate the cor-
responding atomic coordinates of the two molecules. M and N represent a
rotation and a translation operator respectively.
u
x
x
x
x
x
x
U
v
Fig. 13.3
Patterson peaks corresponding to the
example in Fig. 13.2. •, self-Patterson end
vectors for molecule 1; X, self-Patterson
end vectors for molecule 2. □, cross-
Patterson end vectors between molecules
1 and 2.
The Patterson map of such a structure may be subdivided into three different
parts (see Fig. 13.3):
1. the self-Patterson vectors of molecule 1, corresponding to the interatomic
vectors within molecule 1;
2. the self-Patterson vectors of molecule 2;
3. the cross-Patterson vectors corresponding to interatomic vectors relating
atoms in molecule 1 with atoms in molecule 2.
Self-Patterson vectors depend on the orientation of the molecule, not on its
location; cross-Patterson are quite sensitive to the relative location of the two
molecules.
The self-Patterson vectors would lie in a volume U, centred at the origin,
whose dimensions are deﬁned by the dimension of the molecule. Some or
most of the cross-vectors should lie outside U (indeed, intermolecular vec-
tors are expected to be longer than intramolecular ones). For example, a good
choice of the domain U is shown in Fig. 13.3: the circle U contains all the
intramolecular vectors while the intermolecular vectors are outside. Of course
the choice of U is not always straightforward, mostly when the molecule is
rod-like.
Let us now superimpose a rotated version of the Patterson map on the
Patterson map itself; there will be no special agreement except when the set
of intramolecular vectors of one molecule superimpose with the set of the
other molecule. This suggests that one could use the overlapping criterion for
assessing the relative orientation of the two molecules.
We will consider two practical cases in which the overlapping criterion may
be applied successfully:
(a) Find the reciprocal orientation of two or more molecules lying in the
asymmetric unit of the target structure and referred by NCS.
(b) Find the relative orientation of a model molecule, similar or identical to
the target molecule, with respect to that of the target molecule.
Once the correct orientation has been found, the set of intermolecular vec-
tors, which depend on the relative location of the two molecules, could be
used to locate the molecule. The correct shift would occur when the inter-
molecular vectors of the model structure superimpose with those of the target
structure.
In accordance with the above observations, we have to analyse in the follow-
ing the so-called rotation functions (Sections 13.5 to 13.6) and the translation
functions (Section 13.7); the ﬁrst used to orient the search molecules, the
second to locate them.

282
Molecular replacement
13.5
Rotation functions
Let us consider the following very simple case: in the asymmetric unit of
the protein to solve (the target) there is a molecule very similar to another
molecule with known geometry (the model molecule). How do we solve the
target structure by exploiting such prior information?
One might calculate the self-convolution of the isolated model molecule,
set in a random orientation (say, Pmol(u′)), which provides the intramolecular
vectors for the chosen random orientation), and try to superimpose Pmol(u′),
through continuous rotations, to the Patterson map of the target structure (say
Ptarg(u)). The rotation function may be written as
RF =

U
Pmol(u′)Ptarg(u)du′,
(13. 3a)
where U is the integration domain deﬁned in Section 13.4. Any point u′ in
Pmol(u′) is related to a corresponding point u in Ptarg(u) through a rotation
matrix, say
u′ = Mu.
Equation (13.3a) becomes
RF =

U
Pmol(Mu)Ptarg(u)du.
(13.3b)
RF is expected to be a maximum when the peaks of the two Patterson functions
overlap, that is when the orientation of the model molecule coincides with the
orientation of the target molecule. We will use the following notation:
Pmol(u′) = 1
V

p |F2
pmol| exp(−2πip · u′)
and
Ptarg(u) = 1
V

h |F2
htarg| exp(−2πih · u).
In accordance with (13.3b), Pmol(u′) may be rewritten as
Pmol(u) = 1
V

p |F2
pmol| exp(−2πipM · u),
where pM is in general a non-integral reciprocal vector. Then
RF = 1
V2

U

p |F2
pmol| exp(−2πipM · u) ·

h |F2
htarg| exp(−2πih · u)du
= 1
V2

p |F2
pmol|

h |F2
htarg|Ghp

,
(13.4)
where
Ghp =

U
exp[−2πi(h + pM) · u] du.
(13.5)
Expression (13.5) is an interference factor which depends on the integration
volume U around the Patterson origin.

Rotation functions
283
Equation (13.4) involves a double summation, over integral indices h and
non-integral indices pM: therefore its calculation may be time-consuming.
However, if U is a sphere with radius d0, Ghp reduces to
Ghp = 3 sin(2πKd0) −(2πKd0) cos(2πKd0)
(2πKd0)3
,
where
K = |h + pM|.
The slope of the interference function is shown in Fig. 13.4, against Kd0. Its
maximum value is 1 and it is never larger than 0.086 for |Kd0| > 0.72. This
feature allows (Tollin and Rossmann, 1966) the computing time of the rota-
tion function to be reduced if one eliminates the contribution of the reﬂections
h having too small Ghp values. For example, let us suppose that the protein
diameter is 50 Å and the cell is 100 Å in each direction; then d0 = 0.5. If we
want to neglect, for a given pM reﬂection, the contribution of the reﬂections
for which Ghp < 0.086, we should neglect the reﬂections h for which
|Kd0| = |h + pM| 0.5 ≤0.72,
or equivalently,
|h + pM| < 1.5.
In this way, the inner summation in (13.4) may be performed over a limited set
of points h, which are sufﬁciently close to the non-integral point −pM.
Two ways have been found to make calculation of the rotation function faster
(by more than 100 times):
(i) The so-called fast rotation function (Crowther, 1972). Each Patterson
function may be expanded in terms of spherical harmonics and spherical
Bessel functions. Navaza (1987, 1993) suggested that the above expan-
sions are slowly convergent and may cause non-negligible errors. It was
shown that errors can be drastically reduced if the expansion in radial
functions is replaced by suitable numerical integration rules. Such modi-
ﬁcations and greater automation have made the Navaza package AMoRe
one of the most popular phasing tools.
(ii) The MFT method (Rabinovitch et al., 1998). So far we have assumed
that the model structure is rotated in small steps and that, at each step,
Ghp
Kd0
–2.0
2.0
–1.0
1.0
1.0
0.4
0.8
Fig. 13.4
Shape of Ghp against Kd0.

284
Molecular replacement
the corresponding structure factor is calculated. According to the MFT
approach, the structure factor of the molecular model is calculated only
once, and ﬁtting is achieved by rotating the observed reciprocal lattice
with respect to the model lattice. As speciﬁed in point 3 of Section 13.6,
the model is accommodated in an enlarged cubic cell. The indices h of
the protein structure, once transformed from the original protein unit cell
to the enlarged cubic cell deﬁned for the model structure, are systematic-
ally rotated via the matrix M, corresponding to each sampling point of the
orientation space. Since the algorithm involves only the indices, it is very
fast; it has been adopted in the programs REMO and REMO09.
Equation (13.4) represents the classical rotation function calculated in recip-
rocal space. But the Patterson map superposition may also be performed in
direct space (Hoppe, 1957; Nordman and Nakatsu, 1963; Huber, 1965, 1969;
Braun et al., 1969); the ﬁt criterion in this case is the product of the map and
of its rotated version at corresponding grid points, as suggested by equation
(13.3b). Since the grid points of the search map may not coincide with the grid
points of the target map during rotation, it is necessary to interpolate the val-
ues; this limits the accuracy of the method. To keep computing time low, only
the strongest Patterson peaks of the model map (generally a few thousand) are
used in the search. During rotation the origin peaks in the two Patterson maps
are always overlapping, which reduces ﬂuctuations in the ﬁgure of merit. This
effect can be removed by removing the origin peaks from both of the Patterson
maps. Sharpening of the Patterson may also be useful.
13.6
Practical aspects of the rotation function
The rotation of a solid object is more easily governed by using a Cartesian
frame, rather than a crystallographic reference system. The mathematics
necessary to rotate a molecule in a crystallographic ambient is described in
Appendix 13.A; here, we illustrate some practical recipes for the use of rotation
functions.
When using a MR program the crystallographer has to take (or the program
automatically takes) several decisions to make the rotation search effective.
Among others we quote:
1. The choice of an optimal model to rotate. These aspects have been
summarized in Section 13.2.
2. Limits of data resolution. Two resolution cut-offs are applied in MR applic-
ations. The ﬁrst concerns the low-resolution reﬂections; these are omitted
from MR procedures because their intensity depends strongly on the solvent
(see Section 8.A.3). The high resolution cut-off depends on the similar-
ity between model and target molecules; the smaller the similarity, the
more severe the cut-off should be. Appropriate limits can be found by
trial (the common range is between 2.5 and 5 Å resolution). Once a good
MR solution has been found, EDM techniques (see Section 8.2) are gener-
ally applied for phase extension and reﬁnement, eventually followed by the
application of automatic model building procedures (see Section 8.3).

Practical aspects of the rotation function
285
3. The choice of the volume U. This may have an arbitrary shape, but it is
mostly chosen as a spherical domain in order to take advantage of the
properties of the rotation group. Its radius should exclude intermolecular
vectors; in practice, it has to be chosen so as to maximize the ratio number
of intramolecular/number of intermolecular vectors in U. An appropriate
choice for most of the problems should be using a value of 75–80% of the
molecular diameter (Blow, 1985). When several intermolecular vectors lie
in U, the efﬁciency of the method decreases.
In most modern MR computing programs no use is made of U. In order
to reduce interpolation problems, the rotation is performed in a very dense
orthogonal reciprocal lattice. Its direct dimensions are chosen to be four
times the maximum molecular dimension.
4. The use of the symmetry. A rotation function possesses a symmetry which
is a direct consequence of the symmetries of the Patterson functions.
Calculations are greatly reduced if such symmetry is taken into account
(see Appendix 13.A.2), because the search may be limited to the asym-
metric unit of the rotation space. The computing time is also considerably
reduced, particularly in the case of high symmetries (Tollin et al., 1966;
Burdina, 1973; Rao et al., 1980; Moss, 1985).
5. The signiﬁcance of the possible solution. The correct rotation is usually
found via the correlation coefﬁcient,
FOMR =

h

Xtarg −<Xtarg >

· (Xmol −<Xmol >)
	
h

Xtarg −<Xtarg >
2
1/2 
h (Xmol −<Xmol >)21/2 ,
(13.6)
where |Xtarg| = |Ftarg|2 is the squared structure factor modulus of the tar-
get structure, and Xmol is a quantity varying with the orientation of the
intramolecular vectors. Xmol is deﬁned, and its use justiﬁed, in Appendix 13.C.
The solution landscape in MR is rather ﬂat and the FOM average value var-
ies from case to case. Quite often, rather than the absolute FOM value, it is the
high contrast between a FOM and the others which indicates a good solution.
Thus, the orientations corresponding to the highest values of FOMR may be
selected according to the normalized variable,
ρR =
FOMR −FOMR min
FOMR max −FOMR min
.
(13.7)
6. A selection threshold is applied in order to take into account the expected
difﬁculty of the rotation case; e.g. if the sequence identity is low and/or
if NCS is present. Then, usually, a larger number of possible solutions are
selected. The orientations corresponding to the highest values of ρR are
reﬁned by performing a ﬁner rotational search to constitute a better start-
ing point for application of the translational search. The translation search
itself would provide, through suitable ﬁgures of merit, quite effective score
functions able to identify the correct orientations.
7. Let us now consider the case in which the angular relations between the
copies are known, e.g. the orientations of the NCS axes of a proper point
group have been predetermined via a study of the Patterson self-rotation
function (see Appendix 13.B). Then, a strong constraint on the rotations

286
Molecular replacement
arises, which may be exploited by the use of a locked rotation function,
RFL (Tong and Rossmann, 1990; Tong, 2001).
Let Sn be one of the τ NCS operators, including the identity. If M is
a correct orientation of the cross-rotation function, then SnM also corres-
ponds to a correct orientation (if the rotational NCS does not form a proper
group, either SnM or S−1
n M, but not both, correspond to a correct orienta-
tion). Then the average of the cross-rotation values at orientations related
by NCS may be used in equation (13.3b), leading to the locked rotation
function,
RFL =

U
Pmol(Mu)
τ
n=1 [Ptarg(Snu)]du.
RFL is expected to increase the signal-to-noise ratio.
13.7
The translation functions
We will consider the case in which the model molecule has been correctly ori-
ented, but its absolute position is unknown. The problem of ﬁnding its position
does not exist in the space group P1, at least for the ﬁrst monomer, because
the origin may be arbitrarily ﬁxed; for the other oriented monomers the correct
location with respect to the ﬁrst has to be found.
In space groups with symmetry higher than P1 the problem may be solved by
observing that, when a molecule is translated in the unit cell, symmetry-related
molecules move accordingly. As a consequence, all intermolecular vectors
change, while intramolecular vectors remain unmodiﬁed. Thus the absolute
position of the molecule would correspond to a maximum of the overlapping
between the cross-vectors calculated for the molecule and the cross-vectors
of the target Patterson. The problem of locating the molecule is not simple,
because the function monitoring the overlapping can show many maxima.
Sources of noise are the imperfect orientation of the molecule, the presence of
intramolecular vectors mixed with intermolecular ones, and a limited similarity
between model and target.
In analogy with the rotation function (13.3), the translation function may be
expressed as the convolution of the target Patterson with the Patterson map of
the shifted model:
TF =

V
Ptarg(r)Pmol(r −Nmol)dV,
(13.8)
where Nmol is the shift vector between the model molecule and the target
molecule, and Pmol(r −Nmol) is the shifted Patterson map of the model struc-
ture. Application of the convolution theorem allows us to rewrite (13.8) in the
form of a discrete summation:
TF(Nmol) =

h |Ftarg|2|Fmol(h, Nmol)|2.
(13.9)
In equation (13.9) we emphasize the fact that TF is a function of the shift vector
Nmol. The explicit form of the TF(Nmol) map is given in Appendix 13.C.
More translation functions have been suggested (a review has been made by
Beurskens et al., 1987). Function (13.9) has a basic advantage in that it may

The translation functions
287
be calculated rapidly via FFT. The largest peaks in the TF map are expected to
correspond to possible translation vectors.
Once a reasonable number of peaks in the TF map have been selected, they
may be submitted to a score function, say FOMTF, to select the most probable
translation vector Nmol. Typical FOMTF are the crystallographic residue or the
correlation between |Ftarg| and |Fmol(h, Nmol)| (the latter is the structure factor
modulus calculated at the current position of the model molecule). In practice,
the feasible translation vectors are ranked by the normalized criterion,
ρTF =
FOMTF −(FOMTF)min
(FOMTF)max −(FOMTF)min
.
The correct solution is expected to be among the trials with the largest values
of ρTF.
The probabilistic approach in REMO09 suggests the criterion,
FOMTF =

h MuhXhm1(Xh) = max,
(13.10)
where X and m are deﬁned by equations (7.7) and (7.8) (Rtarg and Rmol replace R
and Rp, respectively), and Muh is the multiplicity of the reﬂection h. The prob-
abilistic nature of the criterion (13.10) suggests to consider only reﬂections for
which X > 1 (these give the largest contribution to the sum). A relevant point
to stress is that using 
h Xhm1(Xh) is not equivalent to using < Xm1(X) >.
Indeed, for the correct translation it is expected that the number of reﬂections
for which |Fmod| and |Fobs| are both large or small is bigger than for a trial trans-
lation. Dividing 
h Xhm1(Xh) by the number of terms in the summation would
deplete the score of the correct translation.
To better explain the relation between the rotation and the translation step in
MR procedures we notice the following:
(a) As speciﬁed above, the orientations corresponding to the highest val-
ues of ρR (see equation (13.7)) are submitted to translational search
(multisolution approach). The top translation solutions usually undergo
a ﬁnal reﬁnement process. For example, they may be submitted to rigid
body reﬁnement in which the overall orientation and translation paramet-
ers are reconsidered. Rigid reﬁnement may also be applied to segments of
the model molecule which are thought to be independent, or to different
units of a multimeric assembly related by NCS. Alternatively, optimization
of the overall orientation and translation parameters may be more ﬁnely
assigned using a subspace-searching simplex method for unconstrained
optimization (Rowan, 1990), which is a generalization of the downhill
simplex method (Nelder and Mead, 1965). This has been the choice for
REMO and REMO09.
(b) The bulk solvent contribution to the structure factors (see Section 8.A.3)
may be taken into consideration to increase the efﬁciency of the MR
translation search. Indeed, such a correction improves the correlation
between observed and calculated structure factors and therefore increases
the efﬁciency of the search.
(c) For the ﬁrst oriented molecule, not all of the unit cell needs to be explored
in the translation search. For example, in P21 the origin may be freely

288
Molecular replacement
chosen along the dyad axis. Therefore, the vector Nmol may be restricted
to the family of vectors [x0z]. In Pm, the origin is free along the direction
x and z, therefore Nmol may be restricted to the family of vectors [0y0].
If the symmetry of the space group is taken fully into account, it may
be seen that only the Cheshire cell (Hirshfeld, 1968), a limited region of
the unit cell, must be covered to obtain the solution; it depends on the
spatial arrangement of the positions of the allowed origins described in
Sections 3.4 and 3.6. In the space group P1, the Cheshire cell is a point;
the molecule may be arbitrarily located anywhere.
(d) A steric clash between symmetry-related molecules may occur after the
translation step; when a search for multiple molecules in the asymmetric
unit of the target structure is performed, a clash may also be found between
molecules related by NCS. The clash may be numerically estimated by
calculating the molecular envelopes (Hendrickson and Ward, 1976) or via
an analytical function (Harada et al., 1981), or by calculating the num-
ber of contacts closer than 3 Å between Cα atoms in the two clashing
molecules. Severe clashes cannot be admitted; translations corresponding
to less severe clashes (e.g. due to some inadequacy of the model) are usu-
ally downloaded, so contributing to an increase in the signal for the correct
solution.
(e) If the target structure contains n > 1 monomers in the asymmetric unit,
a cyclic procedure is started. The ﬁrst monomer is located as illustrated
in point (a) above. Such a candidate, locally optimized, is combined with
those selected in the rotational search to form candidate pairs. The ﬁrst
(that is the located) monomer of the pair is kept ﬁxed and the transla-
tion TF function for two independent models is applied to provide the
position of the second monomer. To save computing time, for each pair
only the peaks in the TF map with the highest ﬁgure of merit are con-
sidered. Once the second monomer has been located, the procedure may be
iterated.
A different approach has been proposed by Vagin and Teplyakov (2000)
for simultaneously locating two properly oriented monomers. If the nrf
largest peaks of the rotation function have been stored, each pair com-
bination may ﬁt the orientations of a monomer dyad (in all, we have
nrf 2/2 pair combinations). How do we determine, for every putative dyad,
the intermolecular vector relating the two monomers? The ﬁrst step aims
at locating the intermolecular vectors between the two monomers by
exploiting the relation,
|Fh|2 = FhF−h = F1hF∗
1h + F2hF∗
2h + F1hF∗
2h exp[−2πih(s1 −s2)] + F∗
1hF2h exp[−2πih(s2 −s1)],
where s1 and s2 deﬁne the centres of mass of the two monomers, and F1h
and F2h are the structure factors of the two monomers centred at the origin.
For each putative dyad, a translation function is applied in the space group
P1 to ﬁnd the intermolecular vectors that relate the monomers in the dyad.
When that has been done, a positional search for each dyad is made by
means of a conventional translation function.
(f) If an electron density map has been obtained by another phasing method,
the phased translation function may be applied (Bentley and Houdusse,

Combining MR with ‘trivial’ prior information
289
1992; Read and Schierbeek, 1988; Tong, 1993). Such a function may
be very useful when there are several molecules in the asymmetric unit
and the last few must be located. In this case, the phase information
from the located molecules can be applied to the observed structure factor
amplitudes, so improving the contrast signal to noise.
13.8
About stochastic approaches to MR
So far we have emphasized the algebraic aspects of MR. The incomplete-
ness of the model, the (unknown) differences between search model and target
molecule, and the errors in the experimental data suggest that the stochastic
treatment of MR can make the algorithm more robust. The task may be accom-
plished via a study of the joint probability distribution function, P(Etarg, Emol).
Study should reﬂect the speciﬁc conditions under which the particular MR
problem has to be solved. A general condition to be considered in the formula-
tion of a joint probability distribution is the degree of similarity between search
and target molecules. In orientation problems this condition is represented by
the similarity of the corresponding interatomic distances, in the translation
problem, the positional vectors rjmol of the jth atom of the model molecule
may not exactly coincide with the corresponding positional vector in the target
molecule, after application of the correct translation Nmol (say, rjmol may be
close but not identical with rjtarg + Nmol).
Furthermore, the study should take into account information that is avail-
able at each step of the MR procedure. In particular, the study should be
adapted for:
(i) Orienting a monomer when one or more other monomers have already
been oriented;
(ii) Orienting a monomer when one or more other monomers have already
been oriented and located;
(iii) Translating a well-oriented monomer when one or more monomers have
been correctly oriented and located.
Such an approach has been followed in PHASER (McCoy et al., 2007) and
in REMO09 (Caliandro et al., 2009). The ﬁrst package uses the maximum
likelihood approach, the second, the method of joint probability distribution
functions.
13.9
Combining MR with ‘trivial’ prior
information: the ARCIMBOLDO approach
We have often stressed in this book the important role of the positivity and
atomicity of the electron density in ab initio phasing. Actually, these prop-
erties may guarantee success when data resolution is sufﬁciently high and/or
when structural complexity is sufﬁciently small. The presence of heavy atoms
makes phasing less difﬁcult; even complex proteins at 2 Å resolution can be
solved by exploiting atomicity and positivity (see Chapter 10). When data res-
olution is poor and the structure does not include heavy atoms, positivity and

290
Molecular replacement
atomicity are no longer sufﬁcient for successful phasing; some additional prior
information is necessary, like that exploited by MR, SIR-MIR and SAD-MAD
techniques.
There is, however, some low-level prior information which is widely avail-
able, not speciﬁc to the current structure, but valid for a wide range of
compounds. For example (see Section 12.8), in the small molecule ﬁeld,
POLPO (Altomare et al., 2000b) exploits the known coordination of some
heavy atoms and COVMAP (Altomare et al., 2012) proﬁts from the known
average bond distance and angles of carbon. Both require an electron density
map, usually disturbed and not interpretable, to guide the location of the atoms.
In the macromolecular ﬁeld a number of approaches have been developed to
automatically accommodate molecular fragments, even of small size, in noisy
electron density maps. Optimization techniques are used to make less compu-
tationally demanding the six-dimensional search necessary for orienting and
translating the fragments (Kleywegt and Jones, 1997a; Jones, 2004; Cowtan,
1998, 2008).
If no phase information is available, ab initio approaches may be attemp-
ted by exploiting some low-level prior information based on well-conserved
domains (like, for example, α-helix polyalanine fragments) the overall geo-
metry of which is nearly the same, no matter which protein. Apparently, the
trivial application of MR techniques to fragments which are a very small por-
tion of the full structure is unlikely to succeed. The result should be a very long
list of possible solutions among which it is very difﬁcult to ﬁnd the correct
solution by suitable ﬁgures of merit.
A general approach to protein ab initio crystal structure solution which
exploits the ‘trivial’ information that a protein consists of smaller molecu-
lar fragments of known geometry (among which are α-helices) is that of
ARCIMBOLDO (Rodriguez et al., 2009, 2012). ARCIMBOLDO exploits in a
more efﬁcient way an important previous result obtained using ACORN (Yao,
2002); orienting and locating a perfect fragment representing 13% of the struc-
ture can be enough for a successful protein phasing (followed by application
of EDM techniques). ARCIMBOLDO made the approach much more efﬁcient;
indeed, it can use different types of prior information to locate the small frag-
ments and has extended data resolution limits up to 2 Å. Its procedure may be
described as follows:
1. The orientation and positions of α-helical polyalanine fragments of about
14 residues are searched via the program PHASER, after having truncated
the experimental diffraction data at 2.5 Å resolution. They represent a very
low fraction of the scattering mass and their positions cannot be ﬁxed
without ambiguity when the target helices are fragments with more than
14 residues (e.g. an α-helix of 20 amino acids may accommodate a helix
of 14 amino acids in seven displaced positions). The larger the number
of fragments to correctly locate, the larger will be the number of allowed
positions.
2. The application of PHASER may return a huge number of partial solutions
(i.e. hundreds or thousands) with very similar ﬁgures of merit. At this level,
good partial solutions cannot be discriminated from the false ones.

Applications
291
3. PHASER is restarted and all the solutions are used for searching addi-
tional new fragments. Then the EDM procedures start again; each cycle
of density modiﬁcation includes structure factor extrapolation beyond the
experimental resolution (Caliandro et al., 2007b) to improve the phases
of the observed reﬂections and to make the electron density map more
interpretable. At this stage, ﬁgures of merit may discriminate the cor-
rect solutions. Main chain autotracing may allow us to interpret the map,
assemble the fragments, and control the solutions; better ﬁgures can then
be applied which take into account the number of residues the program
has been able to trace and the correlation coefﬁcient of the partial structure
against the experimental data.
The present version of ARCIMBOLDO is very demanding in terms of com-
putational power. The calculations (such as rotation search, translation search
reﬁnement, density modiﬁcation, etc.) are distributed on a computer grid and
executed in a parallel way.
13.10
Applications
The continuous improvements in MR methods allowed that 2/3 of the struc-
tures deposited in the PDB (> 84000 entries) are solved by MR. As anticipated
in the § 13.2 several pipelines are today available to automatize the entire struc-
ture solution process, that is, from the identiﬁcation of the best search model
up to the automated model building. In some of these pipelines efforts are also
dedicated to distort the template in such a way that it becomes, locally, more
similar to the target: this operation may be made before submitting the tem-
plate to the MR step (as described in the §13.2), and later on, during the phase
reﬁnement step, to improve the electron density map (Terwilliger et al., 2012).
An example may be the following: residues in a β-sheet and in an adjacent
α-helix have a similar relation in the model and in the target structure, but
the orientation and the location of the sheet with respect to the helix could be
different in the two structures. Model and target structures may be made loc-
ally closer by searching for a translation leading in overlapping corresponding
fragments of the target and of the model. This is made by selecting a group
of atoms in a 12 Å diameter sphere and applying the criterion according to
which the shift should maximize the correlation between the electron density
map and the density calculated from the shifted atoms. The deformed model
is then reﬁned to improve the geometry, and then the process is iterated until
convergence.
Of particular interest for future MR developments is the sequence of pro-
grams connected to ROSETTA and to Phaser, as described by DiMaio et al.
(2011), where algorithms for protein structure modeling are combined with
those developed for the crystal structure solution. In other words, let us sup-
pose that a search model has been identiﬁed and possibly modiﬁed as described
in the §13.2, but:
(i) the resulting template is sufﬁciently similar to the target (e.g., with 0.20
< SI < 0.30) to allow a successful MR run, but the correct MR solution

292
Molecular replacement
(i.e., that with the template correctly positioned in the target unit cell) is
not recognizable among the other trials.
(ii) the correctly positioned model is different enough to hinder the generation
of an electron density map of enough quality to rebuild successfully.
The a posteriori analysis of these cases show that difﬁculties are mainly due to
the fact that large fragments of the target main chain differ by 2-3 Å from the
corresponding fragments in the template. For such cases ROSETTA is able to
distinguish the correct MR solution from a large set of candidates (see point i))
and also to improve the selected model so that it may generate an automatically
interpretable electron density map (see point ii)).
It should be too long to describe the applications of the various methods
and to compare their results. It is probably more useful for the reader to
be informed, by a few examples, on some practical details of a typical MR
approach. In the following we describe them by using the automatic pipeline
available in SIR2011, as settled by Carrozzini et al. (2013). The pipeline runs
in sequence:
(a) the program REMO09, the main characteristic of which have been
described in previous paragraphs of this chapter.
(b) REFMAC (Murshudov et al., 2011), available from CCP4 (Collaborative
Computational Project, Number 4, 1994). The program automatically
reads the output of REMO09 and submits positions and temperature factors
of the model atoms to ﬁve cycles of a maximum likelihood reﬁnement
procedure. The ﬁnal phases are submitted to the modulus VLD.
(c) the VLD-EDM approach, for extending and reﬁning the phases provided
by REMO09. This modulus is a combination of the VLD method described
in Section 9.3 and of the EDM techniques. After the EDM cycles the
phases are submitted to VLD and then resubmitted to EDM. A few cycles
usually allows a good phase extension and a reduction in the phase error.
(d) the FREE LUNCH procedure, described in Section 8.2, for ﬁnal phase
reﬁnement of the observed reﬂections via structure factor extrapolation.
(e) ARP/wARP,
for
automatic
model
building
(see
Section
8.3
and
Appendix 8.C).
Some numerical data concerning four examples are listed below. ID is the
sequence identity, RMS is the root mean square deviation between pairwise
Cα backbone positions (see Section 13.2). Average phase errors follow the
strings MR, REFMAC, VLD-EDM and FREE-LUNCH, as obtained after their
applications. The percentage of docked residues follow the string ARP/wARP
(in the case of more numerical values, more automatic cycles of ARP/wARP
have been run).
Ex. n.1. Target structure: 1bxo, 1 chain with 323 residues. RES = 0.9 Å
Model structure: 1er8, 2 chains, the ﬁrst with 330 residues, the second with
8 residues; ID = 0.55, RMS = 1.15 Å.
MR = 74◦; VLD-EDM = 21◦; FREE LUNCH not run because of high
experimental data resolution; ARP/wARP = 0.99.
Ex. n.2 Target structure: 2hyu, 1 monomer in the a.u. with 308 residues.
RES = 1.86 Å.

Applications
293
Model structure 1xjl: one monomer with 319 residues; ID = 0.99, RMS =
0.50 Å.
MR = 50◦; VLD-EDM = 40◦; FREE LUNCH = 37◦; ARP/wARP = 0.99.
Ex. n.3 Target structure: 2b5o, 2 monomers in the a.u., each with 292 residues.
RES = 2.5 Å.
Model structure: 1b2r, one monomer with 295 residues; ID = 0.63, RMS =
1.16 Å.
MR = 50◦; VLD-EDM = 44◦; FREE LUNCH = 43◦; ARP/wARP = 0.72, 0.78,
0.88.
Ex. n.4 Target structure: 2qu5, 1 monomer with 292 residues. RES = 2.86 Å.
Model structure: 2p2i, one monomer with 289 residues; ID = 1, RMS =
0.81 Å.
MR = 44◦; VLD-EDM = 34◦; FREE LUNCH = 35◦; ARP/wARP = 0.
The above examples show that:
(a) if ID is large and/or RMS is small the phase error at the end of the MR
step is usually small. The application of VLD and FREE LUNCH is not
essential for the success of ARP/wARP, they only make it more easy.
(b) If ID is small and/or RMS is large the MR step ends with a large phase
error. If the data resolution is good, the error may be easily minimized by
VLD-EDM, which makes successful the application of ARP/wARP.
(c) If ID is small and/or RMS is large, and if the data resolution is bad, then
reduction of the large MR phase error is more difﬁcult via VLD-EDM
and FREE LUNCH. Then, the automatic model building by ARP-wARP
may succeed or may fail, according to circumstances. In example n.3,
ARP/wARP succeeds (in three cycles, automatically run by SIR2011).
In example n.4, ARP/wARP fails in spite of the small average phase error,
probably because of the very low data resolution. If, in example n.4, the
REMO model is submitted to restrained least squares cycles of REFMAC,
and then the phases are submitted to VLD-EDM and FREE LUNCH, then
the ﬁnal average phase error is only 25◦, but still ARP/wARP is unable to
obtain the structure coverage. The reason should be identiﬁed in the low
data resolution, close to the ARP/wARP limit.
The above scheme is just one of many possible EDM schemes; any program
has its own preferred recipe for driving the model towards the target structure.
It may be worthwhile mentioning that some efforts are today being directed
towards EDM procedures which locally deform the model located by MR, in
order to make the model closer to the target atoms (Terwilliger et al., 2012).
As stated before, a typical example may be the following: residues in a β-sheet
and in an adjacent α-helix have similar relations in the model and in the target
structure, but the orientation and location of the sheet with respect to the helix
could be different in the two structures. One can correctly orient and locate the
sheet but not, simultaneously, the helix; the inverse may also be true. In order
to make model and target structures closer, a shift in the coordinates of each
residue is calculated, smoothed, and applied, so leading to local deformations
of the model which may improve the match between model and map. The
deformed model is then reﬁned to improve the geometry, and the process is
then iterated until convergence.

294
Molecular replacement
APPENDIX 13.A
CALCUL ATION OF THE
ROTATION FUNCTION
IN ORTHOGONALIZED
CRYSTAL AXES
Let us suppose that, in a given crystallographic system, we want to rotate a
molecule in such a way that, after rotation, it overlaps with another identical
molecule. According to equation (13.2), a linear transformation will relate the
point with coordinate X with the point with coordinate X′, corresponding to X
after the rotation:
X′ = MX
(13.A.1)
The calculation of M may be performed in three steps: orthogonalization of the
crystallographic reference system, rotation in Cartesian space, and return to the
crystallographic reference system. In the case where we explore the rotation
space in steps, the crystallographic symmetry has to be taken into account to
reduce the computing time.
In the following we will describe the various steps by using the following
notation: a, b, c are the crystallographic axes, α, β, γ their interaxial angles,
a∗, b∗, c∗the reciprocal axes, α∗, β∗, γ ∗the reciprocal angles, and e1, e2, e3
the Cartesian axes, respectively.
13.A.1
The orthogonalization matrix
Transformation from fractional crystallographic coordinates X (dimension-
less) to orthogonal Cartesian coordinates Xort (in Å), may be performed via
the orthogonalization matrix β under different conventions (see Fundamentals
of Crytallography, Chapter 2). For example, if we assume (see Fig. 13.A.1)
e1 ∥a, e2 ∥(a ∧b) ∧e1, e3 ∥(a ∧b) (or equivalently, e3 ∥c∗)
(13.A.2)
90º
a
c
e1
e2
e3
b
Fig. 13.A.1
For a hexagonal unit cell, the convention
e1 ∥a, e2 ∥(a ∧b) ∧e1, e3 ∥(a ∧b) is
used.
then
β =

a
b cos γ
c cos β
0
b sin γ
c(cos α −cos β cos γ )
sin γ
0
0
V
ab sin γ

,
where
V = det(β) = abc(1 −cos2 α −cos2 β −cos2 γ + 2 cos α cos β cos γ )1/2.
If the convention (see Fig. 13.A.2)
e1 ∥a∗, e2 ∥b, e3 ∥(b, c) plane
(13.A.3)
e1
e2
e3
c
a
b
Fig. 13.A.2
Orthonormal axes, e1, e2, e3 and crystal-
lographic axes, a, b, c, according to the
convention (13.A.3).
is used, then
β =

a sin γ sin β∗
0
0
a cos γ
b
c cos α
a sin γ cos β∗
0
c sin α

is obtained.

Calculation of the rotation function in orthogonalized crystal axes
295
13.A.2
Rotation in Cartesian space
Any rotation in three-dimensional space is deﬁned by three parameters. Two
methods are usually employed to perform a rotation.
(i) The method of spherical polar angles. Deﬁne ﬁrst the direction of the
rotation axis E (called the principal Euler axis) relative to the reference
system and then ﬁx the rotation, χ (called the principal Euler angle), about
this axis. Often χ is called k.
(ii) The method of Eulerian angles. Rotate the object three times in succession
about any three non-planar directions.
In both cases the rotation is performed via the so called direction cosine matrix
ρ, from which it is possible to deﬁne the direction of E via its three direction
cosines l, m, and n (these are the cosines of the angles that E makes with the
positive axes of the orthogonal system) and the value of χ.
In terms of Eulerian angles, the rotation matrix ρEu may be represented as
a product of three successive rotation matrices around three independent axes,
which are applied to the generic point Xort to obtain X′ort, according to:
X′
ort = ρEu Xort = R3 (R2 (R1Xort)) .
R3, R2, and R1 may be rotations around the Cartesian axes. Different conven-
tions may be used, among which we quote:
ZYZ convention : ρEu = R(θ1, θ2, θ3) = Rz(θ3)Ry(θ2)Rz(θ1)
ZXZ convention : ρEu = R(θ1, θ2, θ3) = Rz(θ3)Rx(θ2)Rz(θ1).
e2
e3
e1
e′1
e′2
e′3
ϑ2
ϑ1
ϑ3
k
o
Fig. 13.A.3
Eulerian axes. Two orthonormal frame-
works, A = [0, e1, e2, e3] and A′ =
[0, e′1, e′2, e′3], are shown. The axis ok,
called the line of nodes, is the intersec-
tion of the (e1, e2) and (e′1, e′2) planes,
and is perpendicular both to e3 and to e′3.
A and A′ may be superimposed by three
anticlockwise rotations in the following
order: (1) rotate about e3 by an angle θ1
(ok and e1 are now identical); (2) rotate
through θ2 about ok, which will bring e3
into coincidence with e′3; (3) rotate about
e′3 by θ3, which brings e1 to e′1 and e2
to e′2.
In the following, we will describe the mathematics connected to the ZXZ con-
vention (see Fig. 13.A.3). The point deﬁned by the Cartesian coordinates Xort
is rotated to the point X′ort by the rotation matrix ρEu, deﬁned by:
ρEu = Rz(θ3)Rx(θ2)Rz(θ1)
=

cθ3
sθ3
0
−sθ3
cθ3
0
0
0
1


1
0
0
0
cθ2
sθ2
0
−sθ2
cθ2


cθ1
sθ1
0
−sθ1
cθ1
0
0
0
1

=

cθ1cθ3 −sθ1cθ2sθ3
sθ1cθ3 + cθ1cθ2sθ3
sθ2sθ3
−sθ1cθ2cθ3 −cθ1sθ3
−sθ1sθ3 + cθ1cθ2cθ3
sθ2cθ3
sθ1sθ2
−cθ1sθ2
cθ2

(13.A.4)
where cθi and sθi stand for cos θi and sin θi.
Let us now deﬁne a rotation in terms of spherical polar coordinates. Any
rotation may be described in terms of the azimuthal angle φ (horizontal rota-
tion), the lateral angle ψ (up/down rotation), and the rotation angle χ around
the new axis deﬁned by the φ and ψ rotations. Several conventions may be
used; two of these are shown in Figs. 13.A.4a and 13.A.4b. In the ﬁrst case,
the Cartesian coordinates (x, y, z) are referred to polar coordinates by
x = r sin ψ cos φ,
y = r cos ψ,
z = −r sin ψ sin φ,

296
Molecular replacement
the direction cosines are deﬁned by

l
m
n

=

sin ψ cos φ
cos ψ
−sin ψ sin φ

,
and the direction cosine matrix becomes
ρsp =

cχ + (1 −cχ)s2ψc2φ
−sψsφsχ + (1 −cχ)cψsψcφ
−cψsχ −(1 −cχ)s2ψcφsφ
sψsφsχ + (1 −cχ)cψsψcφ
cχ + (1 −cχ)c2ψ
sψcφsχ −(1 −cχ)cψsψsφ
cψsχ −(1 −cχ)s2ψcφsφ
−sψcφsχ −(1 −cχ)cψsψsφ
cχ + (1 −cχ)s2ψs2φ

(13.A.5a)
ρsp may be expressed in terms of direction cosines l, m, n:
ρsp =

cχ + l2(1 −cχ)
nsχ + lm(1 −cχ)
−msχ + ln(1 −cχ)
−nsχ + lm(1 −cχ)
cχ + m2(1 −cχ)
lsχ + mn(1 −cχ)
msχ + ln(1 −cχ)
−lsχ + mn(1 −cχ)
cχ + n2(1 −cχ)

(13.A.5b)
If the convention depicted in Fig. 13.A.4b is adopted, then
x = r sin ψ cos φ,
y = r sin ψ sin φ,
z = r cos ψ,

l
m
n

=

sin ψ cos φ
sin ψ sin φ
cos ψ

,
and
ρsp =

s2ψc2φ + (s2ψs2φ + c2ψ)cχ
s2ψsφcφ(1 −cχ) −cψsχ
sψcψcφ(1 −cχ) + sψsϕsχ
s2ψsφcφ(1 −cχ) + cψsχ
s2ψs2φ + (s2ψc2φ + c2ψ)cχ
sψcψsφ(1 −cχ) −sψcϕsχ
sψcψcφ(1 −cχ) −sψsφsχ
sψcψsφ(1 −cχ) + sψcφsχ
c2ψ + s2ψcχ

(13.A.5c)
In terms of direction cosines, ρsp becomes
ρsp =

l2 + (m2 + n2) cos χ
lm(1 −cos χ) −n sin χ
nl(1 −cos χ) + m sin χ
lm(1 −cos χ) + n sin χ
m2 + (n2 + l2) cos χ
mn(1 −cos χ) −l sin χ
nl(1 −cos χ) −m sin χ
mn(1 −cos χ) + l sin χ
n2 + (m2 + l2) cos χ

(13.A.5d)
The matrices ρEu and ρsp have a number of interesting properties:
(i) they are real square matrices for which ¯ρ = ρ−1 and det(ρ) = 1;
(ii) for a 180◦rotation the matrix is symmetric; indeed, for such a rotation,
ρ = ρ−1 and therefore ρ = ¯ρ. Furthermore, trace(ρ) = −1, a very useful
indication for recognizing twofold axes directly from ρ;
(iii) ρ has three eigenvalues, say {1, exp(iχ), exp(−iχ)}: the eigenvector
(l, m, n) corresponding with the real eigenvalue 1 is the Euler axis
E = (l, m, n), where

l
m
n

=
1
2 sin χ

ρ32−ρ23
ρ13−ρ31
ρ21−ρ12

.
(13.A.6)

Calculation of the rotation function in orthogonalized crystal axes
297
ρij are elements of the matrix ρ. According to point (ii), the elements of
the matrix on the right-hand side of (13.A.6) vanish when ρ represents a
twofold axis.
z
y
x
χ
b)
φ
ψ
ψ
z
y
x
r
χ
a)
ψ
ψ
Fig. 13.A.4
Spherical polar coordinates: the variables
ψ and φ specify a direction about which
the coordinate system may be rotated
by an angle χ. The axes are ﬁrst rotated
about the lateral angle φ, then rotated up/
down by ψ, and ﬁnally the χ rotation
is
performed.
(a)
x = r sin ψ cos φ,
y = r cos ψ, z = −r sin ψ sin φ. (b) x =
r sin ψ cos φ, y = r sin ψ sin φ, z =
r cos ψ.
(iv) χ, the principal Euler angle, may be derived from
trace(ρ) = 1 + 2 cos χ.
(13.A.7)
The reader may immediately verify the above properties in the case of spherical
polar angles; then the axis E is deﬁned by the rotations about φ and ψ, and χ is
just the principal Euler angle. To verify (13.A.7), one has to calculate the trace
of the matrices (13.A.5b) and (13.A.5d) by using the well-known property
l2 + m2 + n2 = 1; to verify the property (13.A.6), one must introduce the
elements of the same matrices.
13.A.3
Conversion to fractional coordinates
If the convention (13.A.2) is used, the rotated coordinates X′ort are converted
to fractional coordinates X′ by
X′ = αX′
ort,
where
α =

1
a
−cos γ
a sin γ
bc cos γ (cos α −cos β cos γ )
sin γ
−bc cos β sin γ
 1
V
0
1
b sin γ
−ac(cos α −cos β cos γ )
V sin γ
0
0
ab sin γ
V

,
and by
α =

1
asγ sβ∗
0
0
1
btαtβ∗−
1
btγ sβ∗
1
b
−1
btα
−1
csαtβ∗
0
1
csα

if the convention (13.A.3) is used.
tα, tβ∗, . . . , stands for tan α, tan β∗, . . .
At the end of the three-step procedure (orthogonalization, rotation, deortho-
gonalization), the rotation M in the crystallographic reference system may be
represented by
X′ = MX = αρβX,
where M is given by
M = αρβ.
(13.A.8)

298
Molecular replacement
If the deorthogonalization procedure implies a return to the original crystallo-
graphic frame then, α = β−1 and
M = β−1ρβ.
(13.A.9)
If Eulerian angles are used the following identity holds:
R(θ1, θ2, θ3) = R(θ1 + 2n1π, θ2 + 2n2π, θ3 + 2n3π).
(13.A.10)
Furthermore, redundancy in deﬁnitions leads to
R(θ1, θ2, θ3) = R(θ1 + π, −θ2, θ3 + π),
(13.A.11)
which is an n glide perpendicular to θ2. Therefore, the full range of rotation
operations is
0 ≤θ1 < π,
0 ≤θ2 < 2π,
0 ≤θ3 < 2π.
If polar coordinates are used (in the convention deﬁned by Fig. 13.A.4a),
R(χ, ψ, φ) = R(χ + 2n1π, ψ + 2n2π, φ + 2n3π)
(13.A.12)
and
R(χ, ψ, φ) = R(χ, 2π −ψ, φ + π)
(13.A.13)
which is a φ glide perpendicular to ψ in polar space. (13.A.13) relies on the
fact that, if ψ is greater than π, the rotation is the same as that in which φ is
increased by π, and ψ becomes 2π −ψ. Since a rotation by ψ about any axis
is equivalent to a rotation −χ about an opposite directed axis,
R(χ, ψ, φ) = R(−χ, π −ψ, φ + π).
(13.A.14)
All rotation operations are therefore included in
0 ≤χ < 2π,
0 ≤ψ < π,
0 ≤φ < π.
If the convention deﬁned in Fig. 13.A.4b is used, the angular ranges that must
be covered are
0 ≤χ < π,
0 ≤ψ < π,
0 ≤φ < 2π.
How do we use the above mathematical formalism in a MR procedure? Once
an orthogonal frame has been deﬁned (e.g. in accordance with convention
(13.A.2) or (13.A.3)), the corresponding orthogonal lattice has to be construc-
ted. At each rotation step, deﬁned by equation (13.A.9), the model structure
factors may be computed and associated with each grid point of the lattice.
If the MFT method is used (see Section 13.5), the observed structure factor is
associated with each grid point; the grid points are solidly moved during the
rotation without being recalculated. In modern MR programs, to avoid calcu-
lation of the factor G, deﬁned by equation (13.5), an orthogonal lattice grid is
generated, the direct-space dimensions of which are chosen to be four times
the maximum molecular dimension. The high-resolution limit of the lattice
may be chosen by the user or automatically determined by the program. The
same resolution limit is applied to select the observed reﬂections to be used for
the MR search.

Calculation of the rotation function in orthogonalized crystal axes
299
13.A.4
Symmetry and the rotation function
In Section 13.5, we deﬁned the rotation function via the integral (13.3b), which
estimates the degree of coincidence between target and model Patterson maps.
In Section 13.A.3, we obtained the general expression for the rotation matrix
valid for any crystallographic reference system, and we deﬁned the limits of
the rotation search. In all of the above mathematical formalism, the Laue sym-
metries of the two Patterson functions have not been taken into account. This
point is of paramount importance (Rossmann and Blow, 1962; Tollin et al.,
1966; Burdina, 1973; Rao et al., 1980); indeed, point group symmetry in the
reciprocal lattice will cause the same value of the rotation function to be found
for distinct rotations. This reduces the range of angles to be explored before all
independent rotation operations have been considered. It may be shown that the
symmetry of the two Patterson functions, Pmol and Ptarg in (13.3b), allows iden-
tiﬁcation of a minimum range of rotations which is a multiple of the product of
the orders n1 and n2 of the groups of rotation of the original Patterson functions.
The reader is addressed to International Tables for Crystallography (1993),
vol. B (ed. U. Shmueli), Tables 2.3.6.3 and 2.3.6.4, for deﬁnitions of ranges
for the asymmetric unit in rotation space (cubic groups excluded). The entries
in such tables are justiﬁed below via some algebraic calculations and speciﬁc
examples; rotations by Eulerian angles will be considered.
Let us consider the equation (13.3b) in orthogonal coordinates; it may be
written as
R =

Uort
P2(ρuort)P1(uort)duort,
(13.A.15)
where, for simplicity, we have replaced Pmol by P2 and Ptarg by P1.
Let R1 and R2 be symmetry point transformations of the distributions P1
and P2 for orthogonal coordinates. Then, (13.A.15) may be rewritten as
R(ρ) =

Uort
P2(R2ρuort)P1(R1uort)duort,
(13.A.16)
which will have the same value for any R2 and R1. By replacing u′
ort = R1uort,
equation (13.A.16) becomes,
R(ρ) =

U′
ort
P2(R2ρR−1
1 u′
ort)P′(u′
ort)du′
ort = R(R2ρR−1
1 ).
(13.A.17)
Relationship (13.A.17) suggests that rotations ρ and ρ′ = R2ρR−1
1
are equival-
ent positions of the rotation function R. It may also be noted that ρ′ is a pure
rotation (i.e. without inversion or reﬂection), only in the case in which R2 and
R1 are simultaneously proper or simultaneously improper rotations. In the lat-
ter case, we could multiply ρ′ on the left and on the right side by the inversion
operation 1, without changing the rotation; indeed,
ρ′ = 1ρ′1 = 1R2ρR−1
1 1 = R′
2ρR′−1
1 ,
where R′
2 = 1R2 and R′−1
1
= R−1
1 1 are now pure rotations. Such a result allows
us to restrict the analysis to the subgroups of the Patterson symmetry groups,
which consist of pure rotation symmetry elements (see Table 13.A.1).
Let us denote by R2 × R1, the symmetry operation transforming ρ into
ρ′. If R4 × R3 is a further symmetry operator, the successive application of

300
Molecular replacement
Table 13.A.1
The 11 Laue groups, the corresponding subgroups of pure rotation, distin-
guished by the arrangement of the principal axes
Laue group
Proper rotation group
Laue group
Proper rotation group
1
1
3
3
2/m (b-axis unique)
2[010]
3m
321
2/m (c-axis unique)
2[010]
6/m
6
mmm
222
6/mmm
622
4/m
4
m3
23
4/mmm
422
m3m
432
(R2 × R1) and (R4 × R3) is equivalent to the operator (R2R4) × (R1R3),
which may be considered to be the product of the ﬁrst two operators; indeed,
ρ′ = R2ρR−1
1 , ρ′′ = R4ρ′R−1
3
= R4R2ρR−1
1 R−1
3 .
This suggests that the symmetry operators form a group according to the rule,
(R4 × R3) · (R2 × R1) = (R4R2) × (R3R1);
(13.A.18)
such a group is a direct product of the groups {P2} and {P1}. Since Patterson
groups show 11 groups of pure rotation (see Table 13.A.1) 11 · 11 = 121
groups of symmetry operators for the rotation function may be constructed.
It may be noted from Table 13.A.1 that only six different elements of sym-
metry are necessary to describe the rotation groups, i.e.
Table 13.A.2
Symmetry operators
and corresponding rotation matrices for
orthogonal coordinates
Symmetry
element
Rotation matrix
2[010]

1
0
0
0
1
0
0
0
1

2[001]

1
0
0
0
1
0
0
0
1

4[001]

0
1
0
1
0
0
0
0
1

3[001]

−1/2
−
√
3/2
0
√
3/2
−1/2
0
0
0
1

6[001]

1/2
−
√
3/2
0
√
3/2
1/2
0
0
0
1

3[111]

0
1
0
0
0
1
1
0
0

2[010], 2[001], 4[001], 3[001], 6[001], 3[111].
In Table 13.A.2, we give the corresponding elementary rotation matrices.
The order in which the Patterson functions are arranged in (13.A.15) must
be taken into account; different angular relationships are generated if such
an order is reversed (Eulerian relation matrices are not Hermitian). Let us
denote by
R1 =

Uort
P2(u2ort)P1(u1ort)du1ort,
the rotation function for which u2ort = ρu1ort, and by
R2 =

Uort
P2(u2ort)P1(u1ort)du2ort,
the rotation function for which u1ort = ρ′u2ort. Since
u2ort = ρ′−1u1ort,
it follows that ℜ1 = ℜ2 when
ρ′−1 = ρ.
(13.A.19)
Thus, reversal of the Patterson functions generates different angular relation-
ships. Relation (13.A.19) may be written in a more explicit form,
R1(θ1, θ2, θ3) = R2(−θ3, −θ2, −θ1).
(13.A.20)
In conclusion, reversal of the Pattersons in (13.A.17) will give rise to different,
though related, rotation groups. Accordingly, of the 121 rotation groups, 11 are

Calculation of the rotation function in orthogonalized crystal axes
301
Table 13.A.3
Symmetry operators Si and jS for all proper rotation groups except the cubic
one. Each group includes the operation π + θ1, −θ2, π + θ3, which is an identity operation (see
text) in Eulerian systems
Laue group
Proper rotation group
Symmetry elements Si
Symmetry elements jS
1
1
π + θ1, −θ2, π + θ3
π + θ1, −θ2, π + θ3
2/m
2
π + θ1, −θ2, π + θ3
π + θ1, −θ2, π + θ3
(b-axis unique)
π −θ1, π + θ2, θ3
θ1, π + θ2, π −θ3
2/m
2
π + θ1, −θ2, π + θ3
π + θ1, −θ2, π + θ3
(c-axis unique)
π + θ1, θ2, θ3
θ1, θ2, π + θ3
mmm
222
π + θ1, −θ2, π + θ3
π + θ1, −θ2, π + θ3
π −θ1, π + θ2, θ3
θ1, π + θ2, π −θ3
π + θ1, θ2, θ3
θ1, θ2, π + θ3
4/m
4
π + θ1, −θ2, π + θ3
π + θ1, −θ2, π + θ3
−π/2 + θ1, θ2, θ3
θ1, π + θ2, π/2 + θ3
4/mmm
422
π + θ1, −θ2, π + θ3
π + θ1, −θ2, π + θ3
π −θ1, π + θ2, θ3
θ1, π + θ2, π −θ3
−π/2 + θ1, θ2, θ3
θ1, θ2, π/2 + θ3
3
3
π + θ1, −θ2, π + θ3
π + θ1, −θ2, π + θ3
−2π/3 + θ1, θ2, θ3
θ1, θ2, 2π/3 + θ3
3m
321
π + θ1, −θ2, π + θ3
π + θ1, −θ2, π + θ3
π −θ1, π + θ2, θ3
θ1, π + θ2, π −θ3
−2π/3 + θ1, θ2, θ3
θ1, θ2, 2π/3 + θ3
6/m
6
π + θ1, −θ2, π + θ3
π + θ1, −θ2, π + θ3
−π/3 + θ1, θ2, θ3
θ1, θ2, π/3 + θ3
6/mmm
622
π + θ1, −θ2, π + θ3
π + θ1, −θ2, π + θ3
π −θ1, π + θ2, θ3
θ1, π + θ2, π −θ3
−π/3 + θ1, θ2, θ3
θ1, θ2, π/3 + θ3
squares of rotation groups of the Laue groups, 55 groups are related to the
other 55 through isomorphic groups differing in the arrangement of the terms
of the direct product. In Table 13.A.3 we show equivalent points in the rotation
Eulerian space generated by the various symmetry elements (non-cubic space
groups only). According to Tollin et al. (1966), Si and jS are symmetry operat-
ors of the rotation groups operating in P1 (the map which is rotated) and in P2,
respectively, jSi is the ‘product’ of Si and jS (the symmetry operations which
satisfy (13.A.17) coincide with the set jSi).
Owing to the fact that symmetry operations constitute a group and angles
show a 2π translational symmetry along each axis (see relation (13.A.12)), the
symmetry of the rotation function can be described by a rotation space group.
Some examples will be given to clarify this statement (cubic space groups lead
to different types of phase relationships, which are not linear).
Example 1. The Laue group of P1 (the map which is rotated) is 1, the Laue
group of P2 is 2/m. Then (see Table 13.A.3)
S1 : π + θ1, −θ2, π + θ3
1S ≡S1 : π + θ1, −θ2, π + θ3
2S:θ1, π + θ2, π −θ3
1S2 = 1S· 2S:π + θ1, π −θ2, −θ3.

302
Molecular replacement
We observe that S1 is an n glide plane perpendicular to b, 2S is a b glide
plane perpendicular to c, and 1S·2S is a screw axis parallel to a. The resulting
space group is P21nb (the reader may usefully compare the angular relations
with the equivalent positions in P2lnb, say [(x, y, z), (x + π, −y, z + π), (x, y +
π, π −z), (x + π, π −y, −z)]). The range of the asymmetric unit for P21nb,
corresponding to the minimum range of θ2, is
0 ≤θ1 < 2π
0 ≤θ2 ≤π/2
0 ≤θ3 < 2π.
Example 2. The Laue group of P1 in 2/m, the Laue group of P2 is 1. Then (see
Table 13.A.3),
S1 : π + θ1, −θ2, π + θ3
S2 : π −θ1, π + θ2, θ3
1S = S1 : π + θ1, −θ2, π + θ3
1S2 = S2·1 S: −θ1, π −θ2, π + θ3.
We note that S1 is an n glide plane perpendicular to b, S2 is a b glide
plane perpendicular to a, and 1S2 is a screw axis parallel to c. Therefore,
the space group is Pbn21 (the equivalent positions in this space group are
[(x, y, z), (x + π, −y, z + π), (π −x, y + π, z), (−x, π −y, π + z)]). The range
of the asymmetric unit for Pbn21, corresponding to the minimum range of
θ2, is
0 ≤θ1 < 2π
0 ≤θ2 ≤π/2
0 ≤θ3 < 2π.
Example 3. Let us consider the case in which the proper rotation group of P1
(the map which is rotated) is 2, and 2 is also the proper rotation group of P2.
Then, from Table 13.A.3, we will have,
S1 : π + θ1, −θ2, π + θ3
1S : π + θ1, −θ2, π + θ3
S2 : π −θ2, π + θ2, θ3
2S : θ1, π + θ2, π −θ3
2S1 : π + θ1, π −θ2, −θ3
2S2 : π −θ1, θ2, π −θ3
1S2 : = −θ1, π −θ2, π + θ3
S1·2 S · S2 : −θ1, −θ2, −θ3.
It may be observed that S2 is a b glide plane perpendicular to a, S1 is an n glide
plane perpendicular to b, and 2S is a b glide plane perpendicular to c. Thus, the
rotation space group Pbnb arises, which is plotted in Fig. 13.A.5. The size of
the asymmetric unit, corresponding to the minimum range of θ2, is
0 ≤θ1 ≤π/2
0 ≤θ2 < π
0 ≤θ3 < 2π.

Calculation of the rotation function in orthogonalized crystal axes
303
1
4–
1
4–
1
4–
1
4–
1
4–
+
+
+
–
–
–
–
–
+
ϑ1
ϑ3
ϑ2
+
1
2 +
–
1
2 +
–
1
2 +
–
1
2 –
–
1
2 –
–
1
2 –
–
1
2 –
–
1
2 +
–
Fig. 13.A.5
Diagram of the rotation group Pbnb
(retains the order θ1, θ2, θ3). Equivalent
values of the Eulerian angles are also
shown.
Example 4. Let mmm be the Laue symmetry of P1 and 2/m that of P2. Then,
from Table 13.A.3, we have
S1 : π + θ1, −θ2, π + θ3
S2 : π −θ1, π + θ2, θ3
S3 : π + θ1, θ2, θ3
1S = S1
2S : θ1, π + θ2, π −θ3
2S1 = S1·2 S: π + θ1, π −θ2, −θ3
2S2 = S2·2 S: π −θ1, θ2, π −θ3
2S3 = S3·2 S: π + θ1, π + θ2, π −θ3
S1· S2 = −θ1, π −θ2, π + θ3
S1· S3 = θ1, −θ2, π + θ3
S2· S3 = −θ1, π + θ2, θ3
When all the products are exhaustively made, we will obtain 16 equivalent
angular positions in which it is easy to recognize a glide plane of type b, per-
pendicular to a (say S2), a c glide plane perpendicular to b (say S1 · S3), and a
b glide plane perpendicular to c (say 2S). The space group is therefore Pbcb.
Since S3 repeats the equivalent positions after a π translation along θ1, the
space group diagram will be that shown in Fig. 13.A.6, containing 16 instead
of the standard 8 equivalent positions. The size of the asymmetric unit will
then be
0 ≤θ1 ≤π/2
0 ≤θ2 ≤π/2
0 ≤θ3 < 2π.
Example 5. Let 6/m be the Laue symmetry of P1 and 2/m that of P2. From
Table 13.A.3, we derive,
S1 : π + θ1, −θ2, π + θ3
S2 : −π/3 + θ1, θ2, θ3
1S ≡S1
2S:θ1, π + θ2, π −θ3.

304
Molecular replacement
Fig. 13.A.6
Rotation space group diagram for the
rotation function of a Patterson function
P1 with Pmmm symmetry, against a P2
Patterson function with P2/m symmetry.
Multiple application of the sixfold axis S2 and an exhaustive combination of
the operators Si and jS will give rise to 24 equivalent angular positions. The
rotation space group is P2cb, but there are consecutive translations by π/3
along the θ1 axis; this brings the number of equivalent positions from the stand-
ard (for P2cb) number of 4 to 24. For example, the reader will ﬁnd that, besides
θ1, θ2, θ3, the additional positions
(π/3 + θ1, θ2, θ3);
(2π/3 + θ1, θ2, θ3);
(π + θ1, θ2, θ3);
(4π/3 + θ1, θ2, θ3);
(5π/3 + θ1, θ2, θ3)
exist. The asymmetric unit to explore is then
0 ≤θ1 ≤π/3
0 ≤θ2 ≤π/2
0 ≤θ3 < 2π.
APPENDIX 13.B
NON-CRYSTALLOGRAPHIC
SYMMETRY
13.B.1
NCS symmetry operators
Crystallographic symmetry operators, when considered in the crystallographic
reference system, hold for the full crystal; the corresponding rotation matrices
R only contain −1,0,1 elements, and the translation components are simply
related to the unit cell axes. When reconsidered in a Cartesian reference
system, two situations may occur:
(i) If the original crystallographic frame is orthogonal, the elements of the
rotation matrix ρ (calculated in Cartesian space) are still −1, 0, + 1;
indeed, orthogonalization and de orthogonalization matrices are both
diagonal, with diagonal elements one the reciprocal of the other.
(ii) If the original crystallographic frame is oblique, the elements of the matrix
ρ do not maintain −1 ,0, 1 entries.

Non-crystallographic symmetry
305
In general, the above rules are no more valid when NCS operators are
considered (they do not bring lattice points in overlapping).
So, why is there such a high interest in NCS? We observe that:
(a) it is present both in small molecule and in macromolecule areas;
(b) half of all structures in the PDB are dimeric or in a higher oligomerization
state;
(c) the diffraction pattern contains redundant information, since the atomic
coordinates of one molecule deﬁne the atomic coordinates of the
molecules referred by NCS. This feature implies strong restraints on the
structure factors;
(d) if NCS symmetry operators are well located, the electron density map
may be improved by averaging the density over equivalent points; indeed,
the noise may be averaged out and consistent structural features may be
enhanced. The signal-to-noise improvement (at maximum) is proportional
to n1/2, where n is the number of molecular copies in the asymmetric unit.
NCS operators may be divided into two categories, marked by proper or
improper rotations. When proper NCS is present, equivalent regions may be
related by a local point group symmetry which is not limited to 2-, 3-,4-, and
6-fold rotations. In this case, the symmetry is independent of the sense of rota-
tion. When improper rotations are present, both the rotational and translational
components may contribute to the NCS; the rotation angle and the translation
shift can be arbitrary. Figure 13.B.1 represents the asymmetric unit of 1mi1;
the two molecules in the asymmetric unit are related by an improper NCS, with
an angle of rotation of 163◦. In this case, the NCS operator brings the molecule
one in overlappling with the molecule two by a 163◦but not by a –163◦rota-
tion. In Fig. 13.B.2, ﬁve subunits are related by a proper local ﬁvefold axis.
Such axes are present in icosahedral viruses; no matter which sense of rota-
tion, one ﬁfth of a revolution moves one region onto a symmetry-equivalent
region. Near-perfect rotations relating dimers, trimers, and higher assemblies
are frequent in protein crystallography. If more proper axes meet at the origin
of the unit cell, as in viruses, no translation component is found.
Fig. 13.B.1
Asymmetric unit of 1mi1: two molecules
in the asymmetric unit are related by
improper NCS, with an angle of rotation
of 163◦.
Fig. 13.B.2
1c48: a ﬁvefold NCS axis relates ﬁve
subunits.
NCS usually shows translational components associated with the rotation.
In accordance with Euclidean geometry, two equivalent objects may be related
by different combinations of rotation and translation; the orientation of the
rotation axis is ﬁxed, but not its location. It is always convenient to leave the
translation perpendicular to the axis at zero after rotation (see Fig. 13.B.3).
A special type of NCS is the so-called (in the small molecule ﬁeld)
pseudotranslational symmetry, or translational NCS symmetry (in the mac-
romolecular area). This will be described in Section 13.B.3.
13.B.2
Finding NCS operators
In Section 13.5 we deﬁned the rotation function using equation (13.3b),
repeated here for convenience:
RF =

U
Pmol(Mu)Ptarg(u)du,
(13.B.1)

306
Molecular replacement
where Pmol and Ptarg are the Patterson maps of the model molecule and of the
target structure respectively, M is a matrix performing the rotation of the model
map with respect to the target map. The self-rotation function, RFS, is obtained
from (13.B.1) by replacing Pmol by Ptarg:
RFS =

U
Ptarg[Mφ,ψ,χu]Ptarg(u)du,
(13.B.2)
where Mφ,ψ,χ emphasizes that the rotation is performed via the spherical polar
angles described in the Section 13.A.2.
We will see that RFS provides information about the content and organiza-
tion of the asymmetric unit and suggests which oligomer model may be used as
a search model in MR. It is worthwhile noticing that (i) a Patterson self-rotation
function is intrinsically more reliable than a cross-rotation function, because it
only depends on the observed target diffraction amplitudes; (ii) most of the
considerations discussed in Section 13.6 hold for the self-Patterson.
Let us now suppose that RFS is plotted as a function of the rotation angle.
It will always show a huge value (the so-called origin peak) for zero rotation;
indeed, the two Patterson maps will perfectly overlap if no rotation has been
applied. This peak does not say anything about NCS and may therefore be
ignored.
RFS will also show huge peaks for any rotation that represents a crystallo-
graphic symmetry operation. For example, if a crystal has threefold rotational
symmetry, a rotation corresponding to this symmetry axis will create a copy of
the Patterson, completely identical to the original. Also, these peaks do not say
anything about NCS and may therefore be ignored.
Information on NCS is contained in smaller peaks that are substantially
larger than any other peak and several standard deviations larger than the noise.
Computer programs devoted to identiﬁcation of the NCS usually store RFS
in stereographic projections, the basic geometry of which is illustrated in
Fig. 13.B.4, where the convention

l
m
n

=

sin ψ cos φ
sin ψ sin φ
cos ψ

has been chosen (see Section 13.A.2). As Fig. 13.B.4b suggests, to reveal
proper NCS operators, RFS is plotted in separate projections, each correspond-
ing to a ﬁxed value of χ (i.e. for χ = 360◦/n, say for 180◦,120◦, 90◦, 72◦, 60◦,
etc.); indeed, the order of a NCS operator is not limited to crystallographic
values. The projections corresponding to χ = 360◦/n will show peaks cor-
responding to n-fold local axes. Thus ﬁvefold local axes will show peaks at
χ = 72◦and twofold axes, at χ = 180◦(crystallographic axes of order two, if
present, will produce the largest peaks in this projection).
a)
A2
A1
t
A1¢
A1¢
b)
A2
A1
t
q
Fig. 13.B.3
Two objects A1 and A2 are related by a
two-old rotation axis followed by a trans-
lation. (a) The intermediate object A′1 is
obtained by applying only the rotation
operator to A1: the translation t, parallel
to the twofold rotation axis, brings A′1 on
A2. (b) The two objects A1 and A2 are in
the same positions occupied in case (a),
but the rotation axis has been moved to
a new position. The intermediate object
A′1 is obtained by applying only the rota-
tion operator to A1, but this time, to bring
A′1 on A2, we need to apply the transla-
tion t, plus a supplementary translation
q perpendicular to the rotation axis. It is
concluded that the orientation of the rota-
tion axis is ﬁxed, but its location may be
freely varied.
As an example, we show in Fig. 13.B.5, the two monomers related by a
twofold NCS axis in the protein structure identiﬁed by the PDB code 3hpe
(Sisinni et al., 2010), space group P21. In Fig. 13.B.6, the stereographic pro-
jections obtained by MOLREP at χ = 180◦, 120◦, 90◦, and 60◦are shown; the
only one with appreciable peaks corresponds to χ = 180◦. The results indicate
that only NCS binary axes are allowed (the projection at χ = 72◦, not shown

Non-crystallographic symmetry
307
for brevity, is devoid of meaningful peaks). In the projection corresponding to
χ = 180◦we notice:
(a) The two strongest peaks are located at
φ = 90◦, ψ = 90◦, χ = 180◦,
φ = −90◦, ψ = −90◦, χ = 180◦,
both corresponding to the crystallographic binary axis along b.
(b) Two strong peaks are located at
φ = 0◦, ψ = 68◦, χ = 180◦,
φ = 180◦, ψ = 202◦, χ = 180◦,
suggesting the presence of a non-crystallographic binary axis with direc-
tion close (i.e. tilted by 22◦) to that of a.
We have already seen in Section 13.A.3 that the angular asymmetric unit to
cover is
0 ≤χ < π,
0 ≤ψ < π,
0 ≤φ < 2π.
However, as for the cross-Patterson function (see Section 13.A.4), additional
symmetry in the stereographic projections would arise (and therefore a smaller
asymmetric unit should be considered) as the effect of the native Patterson
symmetry. For example, if the space group of the target is P21 and there is
a dimer in the asymmetric unit with a NCS axis perpendicular to b, the self-
Patterson will create a third twofold, orthogonal to the other two.
NCS symmetry operators must be accurately deﬁned; indeed, the error
increases with increasing distance from the symmetry element.
z
y
y
φ
φ
ψ
χ
ψ
x
x
a)
b)
Fig. 13.B.4
Spherical
polar
angles
according
to
the
convention,
x = r sin ψ cos φ, y =
r sin ψ sin φ, z = r cos ψ. (a) geometry of
the stereographic projection; (b) spherical
polar coordinates on the two-dimensional
map.
Fig. 13.B.5
3hpe. The two monomer backbones in the
asymmetric unit.
Let us now suppose that proper NCS axes are parallel to crystallographic
symmetry axes of the same or of high order; then, self-rotation peaks due to
NCS operators will be obscured by the corresponding crystallographic peaks.
The ambiguity may be solved by checking the target Patterson map at the
Harker sections. As an example, let us suppose that in P21 a twofold NCS
axis is parallel to the 21 crystallographic axis. If (x0, y, z0), with y a free value,
represents the generic point of the twofold axis, then (x, y, z) and (−x + 2x0, y,
−z + 2z0) are equivalent positions. The full set of equivalent positions
(including crystallographic and NCS symmetry) is
(x, y, z), (−x + 2x0, y, −z + 2z0), (−x, y + 0.5, −z),
(x −2x0, y + 0.5, z −2z0),
and the corresponding Patterson vectors are
(2x + 2x0, 0, 2z + 2z0), (2x, 0.5, 2z), (2x0, 0.5, 2z0),
(+ 2x0, 0.5, + 2z0), (−2x + 4x0, 0.5, −2z + 4z0),
(−2x + 2x0, 0, −2z + 2z0) + cs. positions.
The vector (2x0, 0.5, 2z0) lies in the crystallographic Harker section, and
does not depend on the positions (x,y,z); thus all of the atoms of an oli-
gomer contribute to it. Accordingly, the position of the NCS twofold axis is
immediately derivable by inspection of the Harker section. The reader should,

308
Molecular replacement
χ = 180
χ = 90
χ = 120
χ = 60
x
x
x
x
y
y
y
y
Fig. 13.B.6
3hpe. Self-rotation function: stereogra-
phic projections obtained by MOLREP at
various χ angles. The convention is the
following: φ is the angle in the plane (x,y)
between x and the projected rotation axis;
ψ is the angle between z and the rota-
tion axis; χ is the rotation angle around
the rotation axis (by courtesy of Giuseppe
Zanotti).
however, remember that if the NCS axis deviates by a few degrees from the
proper alignment with the crystallographic axis, the peak in the Harker section
disappears.
13.B.3
The translational NCS
Let us suppose that a non-negligible amount of electron density ρ(r) satisﬁes
the condition
ρ(r) ≈ρ(r + q),
where q is a rational fraction of the lattice periods,
q = ν1
μ1
a + ν2
μ2
b + ν3
μ3
c,
with
0 ≤νi ≤μi, i = 1, 2, 3.
Then, a pseudotranslational symmetry occurs and q is its pseudotransla-
tional vector.
The index n of the pseudotranslation is the smallest integer for which nq is
a lattice vector; it coincides with the least common multiple of μ1,μ2,μ3. For
example, q = 1
2a + 1
2b and q = 1
2a + 1
3b are of order two and six, respectively.
If the fraction of electron density ρ(r) satisfying the pseudotranslational
symmetry is not negligible, a strong Patterson peak will be visible in positions
nq; the intensity of the peak will be proportional to the fraction in pseudosym-
metry. Here, we prefer to characterize the pseudotranslational symmetry by
reciprocal space calculations.

Non-crystallographic symmetry
309
It is usual to say (Buerger, 1956, 1959) that in these conditions the crystal
structure is divided into two parts: the substructure, comprising that part of
the electron density which conforms to the periodicity of the subcell, and the
complement structure or superstructure, comprising the rest of the electron
density. Accordingly, the reciprocal lattice {H} is divided into two subsets:
subset {HA} referred to substructure reﬂections and set {HB}, associated with
superstructure reﬂections.
The Fourier transform of the electron density distribution of the substruc-
ture is zero everywhere, except at set {HA}, while the Fourier transform of the
complement structure contributes to the entire set {H}.
A simple example is shown in Fig. 13.B.7. For a one-dimensional cell with
period a and density ρ, the substructure ρsub with u = a/3 and the complement
structure ρsup = ρ −ρsub are emphasized. For this example, subset {HA} con-
tains reﬂections for which h ≡0 mod(3), while set {HB} is consists of those
for which h ̸= 0 mod(3).
ρsub
ρsuper
ρ
a/3
Fig. 13.B.7
A
one-dimensional
density
ρ
with
pseudotranslational vector, u = a/3.
More pseudotranslational vectors may coexist simultaneously; for example,
q1 = a/3 and q2 = c/4. In this case, because of the pseudosymmetry, a
pseudocell ρsub with 1/12 of the volume of the original cell may be identi-
ﬁed (the simultaneous presence of q1 and q2 is equivalent to the presence of
the pseudotranslational vector q = a/3 + c/4).
Sometimes pseudotranslational symmetry combines with crystallographic
symmetry with multiplicative effects. For example, if q1 = a/2 in the P4 space
group, q2 = b/2 also exists.
Real structures do not comply exactly with the mathematical models shown
in Fig. 13.B.7. Indeed, atoms related by pseudotranslational symmetry may not
be exactly referred (because of displacive deviations from ideal pseudosym-
metry), or are of a different chemical nature (replacive deviations from ideal
pseudosymmetry). Such situations produce special effects in the reciprocal
space which deserve to be mentioned. A simple example of replacive deviation
is shown in Fig. 13.B.8, where only three atoms satisfy the pseudotransla-
tional vector u = a/4, the fourth being missed. If substructure reﬂections only
are used, the average or Takeuchi substructure ˆρsub (Takeuchi, 1972) is seen
instead of ρsub, so dividing ρ into two components, ˆρsub and ρ −ˆρsub (the latter
is negative in a region of the unit cell), instead of into ρsub and ρ −ρsub.
ρsub
ρsuper = ρ–ρsub
δρsub = ρsub–ρsub
ρsub
Ù
Ù
ρ–ρsub
Ù
ρ
Fig. 13.B.8
Gaussian ‘atoms’ are located in a one-
dimensional unit cell. Three heavy atoms
satisfy the pseudotranslation vector, u =
a/4, the fourth being missed. Four light
atoms belong to ρsuper, but if substructure
reﬂections only are used, ˆρsub is seen.

310
Molecular replacement
ρsub
ρsuper = ρ – ρsub
δρsub = ρsub – ρsub
ρsub
Ù
Ù
ρ – ρsub
Ù
ρ
Fig. 13.B.9
Gaussian ‘atoms’ are located in a one-
dimensional unit cell with pseudotransla-
tional vector, u = a/4. Atoms related by u
are of the same type, but slightly shifted
from ideal positions.
An example of displacive deviation from ideal pseudosymmetry is shown
in Fig. 13.B.9, where a pseudotranslation vector, q = a/4, is shown, refer-
ring atoms of the same type but slightly shifted from ideal positions. Again,
the Takeuchi substructure will be seen by X-ray diffraction, and ρ will be
interpreted as having the two components ˆρsub and ρ −ˆρsub.
It may be shown (Mackay, 1953; Cascarano et al., 1988a,b) that suitable
statistical analysis of diffraction data can reveal the presence of displacive
deviation from ideal pseudosymmetry (while replacive deviations cannot be
revealed at all). We will not describe the mathematical modelling of pseudo-
translational symmetry settled by Cascarano et al. (1985a,b; 1987b) (see also
Böhme, 1982, 1983 and Gramlich, 1984). We will only mention that it allows
us, via a statistical analysis of the diffraction amplitudes, to:
(i) detect the pseudotranslational symmetry;
(ii) deﬁne the pseudotranslational vectors, q;
Table 13.B.1 FREIES. SIR2011 statistical analysis for revealing the presence and the nature
of pseudotranslational symmetry. The program searched for pseudotranslational symmetry
classes of reﬂections affected by pseudotranslational effects. Classes of reﬂections probably
affected by pseudotranslational effects:
Condition
NREF
< |E|2 >
FOM

p / 
N
h = 2n & k = 3n
349
3.30
6.92
0.52
3h+2k = 6n
349
3.30
6.92
0.52
h = 2n
1028
1.55
4.85
0.67
3h+4k =12n
173
3.38
4.45
0.24
h+2k+2l = 4n
516
2.23
4.14
0.46
k = 3n
577
2.05
3.83
0.46
3h+2k+3l = 6n
273
2.27
2.90
0.21
2k+3l = 6n
301
2.08
2.62
0.20
h = 2n & l = 2n
514
1.65
2.18
0.24
Remarkable deviations (of displacive type) from ideal pseudotranslational symmetry:
at (sin θ/λ)2 = 0,

p
 
N = 0.78, at (sin θ/λ)2 = max,

p
 
N = 0.32

Algebraic forms for the rotation and translation functions
311
Table 13.B.2 2hyw. SIR2011 statistical analysis for revealing the presence and the nature of
pseudotranslational symmetry. The program searched for pseudotranslational symmetry classes
of reﬂections affected by pseudotranslational effects. 5130 reﬂections selected using resolution
range (4.40–22.02) Å. Classes of reﬂections affected by pseudotranslational effects:
Condition
NREF
<|E|2>
FOM

p / 
N
k + l = 2n
4903
1.90
18.67
0.89
k + l = 4n
3671
1.93
4.36
0.55
2h + k + l = 4n
3672
1.92
4.24
0.54
h = 2n & k + l = 2n
2444
1.92
2.78
0.30
h + k = 2n & h + l = 2n
2434
1.87
2.63
0.28
k = 2n & l = 2n
2449
1.84
2.56
0.28
Modest deviations (of displacive type) from ideal pseudotranslational symmetry:
at (sin θ/λ)2 = 0,

p
 
N = 0.97, at (sin θ/λ)2 = max,

p
 
N = 0.84.
(iii) estimate the percentage of the electron density satisfying the pseudosym-
metry;
(iv) reveal the possible displacive nature of the pseudotranslational symmetry.
Two examples are shown in Tables 13.B.1 and 13.B.2, the ﬁrst refers to a small
molecule (FREIES), the second to a protein (2hyw). The program SIR2011
explores a large number of classes of reﬂections; for each class the aver-
age value of < |E|2 > is calculated, and this calculation is also performed
for each resolution shell. The percentage of the electron density satisfying
the pseudosymmetry is computed (
p / 
N in the tables), a ﬁgure of merit
(FOM) identiﬁes the most important pseudotranslational symmetry (the ﬁgure
takes into account the order of the pseudosymmetry and the percentage above
deﬁned). By comparing the < |E|2 > values at high and low values of sin θ/λ,
the displacive nature of the pseudosymmetry is estimated. In 2hyw, the pseudo-
translational symmetry is nearly perfect; in FREIES it has a strong displacive
character.
APPENDIX 13.C
ALGEBRAIC FORMS FOR THE
ROTATION AND TRANSL ATION
FUNCTIONS
The canonical structure factor expression for the target structure is
Fhtarg =
t
j=1 fj
m
s=1 exp[2πih(Rsrj + Ts)],
(13.C.1)
where t is the number of atoms in the asymmetric unit and m is the number of
symmetry operators, Cs ≡(Rs, Ts).
Let us now suppose that a model molecule is randomly oriented and wrongly
positioned: its jth atomic position, r′
j, is referred to the corresponding target
atomic position rj by the relation, r′
j = Mrj + N. The corresponding structure
factor is,

312
Molecular replacement
Fhmol =
t
j=1 fj
m
s=1 exp

2πih(Rsr′
j + Ts)

=
m
s=1 asγ (hRs),
(13.C.2)
where
as = exp[2πihTs]
γ (hRs) =
t
j=1 fj exp(2πihRsr′
j).
From (13.C.2), the following relation arises:
|Fhmol|2 =
m
s=1 |γ (hRs)|2 +
m
s1̸=s2=1 γ (hRs1)γ ∗(hRs2)as1a∗
s2.
The explicit form of m
s=1 |γ (hRs)|2 is
m
s=1 |γ (hRs)|2 =
t
j1,j2=1 fj1fj2 exp

2πihRsM

rj1 −rj2

.
The corresponding interatomic vectors are of self-Patterson type (see
Section 13.4), do not depend on the translation vector N, but only on the
rotation matrix M. Therefore, m
s=1 |γ (hRs)|2 may provide information on
the orientation of the model molecule, and is the frequent expression of the
parameter Xmol in equation (13.6).
Let us now suppose that the model molecule has been well oriented but is
still wrongly positioned. We can write the corresponding structure factor as,
Fmol(h, N) =
t
j=1 fj
m
s=1 exp

2πih

Rs

rj + N

+ Ts
 
,
(13.C.3)
where rj + N is the trial position of the jth atom in the model, shifted with
respect to the correct location by the vector N. We can rewrite (13.C.3) as,
Fmol(h, N) =
m
s=1 asγ (hRs),
with
as = exp [2πih (RsN + Ts)]
γ (hRs) =
t
j=1 fj exp

2πihRsrj

.
The translation function (13.9) may then be rewritten as,
TF(N) =

h |Fhtarg|2 m
s1,s2=1 γ

hRs1

γ ∗
hRs2

as1a∗
s2,
(13.C.4)
which may be represented as a Fourier series, as reported by Vagin and
Teplyakov (1997):
TF(N) = V−1 
H AH exp[−2πiHN],
(13.C.5)
with coefﬁcients,
AH =

h |Fhtarg|2 m
s1,s2=1 γ (hRs1)γ ∗(hRs2) exp

2πiH

Ts1 −Ts2

,
(13.C.6)
where summation is over those h for which H = h

Rs2 −Rs1

. The maxima
of the TF map should correspond to the most probable translation vectors.

Algebraic forms for the rotation and translation functions
313
The TF expression, (13.C.6), may be modiﬁed by replacing the term |Fhtarg|2
by |Fhtarg|2 = |Fhtarg|2−< |Fhtarg|2 >, as suggested by Navaza (1994); then
the term corresponding to the condition s1 = s2 is excluded from summation
(13.C.6). The effect of this is that the origin peak is removed and the contrast
between the correct and the false solutions increases.

Isomorphous
replacement techniques
14
14.1
Introduction
The isomorphous replacement method is a very old technique, used incident-
ally by Bragg to solve NaCl and KCl structures: it was later formulated in a
more general way by Robertson (1935, 1936) and by Robertson and Woodward
(1937). Its modern formulation is essentially due to Green et al. (1954) and to
Bragg and Perutz (1954), who applied the method to haemoglobin. The tech-
nique has made possible the determination of the ﬁrst three macromolecular
structures, myoglobin, haemoglobin, and lysozyme.
The approach may be summarized as follows. Suppose that the target struc-
ture is difﬁcult to solve (e.g. it is a medium-sized structure, resistant to any
phasing attempt, or it is a protein with bad data resolution) and we want
to adopt isomorphous replacement techniques. Then we should perform the
following steps:
(a) Collect the diffraction data of the target structure; in the following we will
suppose that it is the native protein.
(b) Crystallize a new compound in which one or more heavy atoms are
incorporated into the target structure. This new compound is called
derivative.
(c) Check if the operations in (b) heavily disturb the target structure. If not,
the derivative is called isomorphous; then, only local (in the near vicinity
of the binding site) structural modiﬁcations are induced by the heavy atom
addition. Non-isomorphous derivative data are useless.
(d) Use the two sets of diffraction data, say set {|FP|} of the target structure
and set {|Fd|} of the isomorphous derivative, to solve the target structure.
The above case is referred to as SIR (single isomorphous replacement). The
reader should notice that redundant experimental information is available;
indeed, two experimental sets of diffraction data relative to two isomorph-
ous structures may be simultaneously used for solving the native protein. The
redundancy of the experimental information allows crystal structure solution
even if data resolution is far from being atomic (e.g. also when RES is about
3 or 4 Å, and even more in lucky cases).

Protein soaking and co-crystallization
315
Imperfect isomorphism may hinder crystal structure solution. Then, more
derivatives may be prepared; their diffraction data may be used in a combined
way and may more easily lead the phasing process to success. This case is
referred as MIR (multiple isomorphous replacement), characterized by the fact
that more sets of diffraction data are available:
{|FP|}, {|Fd1|}, {|Fd2|}, . . . . . . .
Roughly speaking, the more redundant information that is available, the easier
structure solution will be.
In Section 14.2, we brieﬂy recall the laboratory techniques for prepar-
ing derivatives, with special regard to proteins; in Sections 14.3 and 14.4,
the algebraic SIR-MIR bases are stated. In Section 14.5, the most popu-
lar approaches for putting on absolute scale native and derivative data are
described. Sections 14.6 and 14.7 illustrate the classical two-step procedure
(i.e. ﬁrst solve the heavy atom substructure, and then the native structure), as
seen from a modern probabilistic point of view. Some schematic applications
are described in Section 14.8. A one-step procedure (i.e. the intermediate step
of solving the heavy atom substructure is no longer necessary) is also pos-
sible and is summarized in Appendix 14.B; even if appealing and interesting
theoretically, it never became popular.
In this chapter, the capital subscript P and the lower-case subscript d will
indicate the native protein and the derivative, respectively.
14.2
Protein soaking and co-crystallization
Ligands or heavy atoms can be soaked into, or co-crystallized with, the native
protein (the target structure). Co-crystallization is used when ligands induce
strong conformational changes into the protein.
Soaking is not allowed for small molecules, because the solvent channels do
not permit diffusion of large molecules (their diameter varies between 20 and
100 Å). Usually, crystals are soaked with various heavy-atom salt solutions;
the mechanism requires the existence of pores in the crystal through which the
reagent can diffuse to reach the protein surface. The soaking time ranges from
several minutes to months, and depends on the protein under study, on the pH,
on the temperature, and on the precipitating agents.
Commonly used heavy-atom derivatives are Pt, Hg, and Au compounds,
uranyl salts, and rare earth elements. Very recently, quick soak derivatization
by heavy halide atoms (iodine and bromine anions), or heavy alkali (cesium
and rubidium cations) have been proposed (Dauter et al., 2001; Nagem et al.,
2003); these ions are used in strong concentrations and bind to the surface of
the protein, frequently with partial occupancy. Xenon–protein complexes are
obtained by pressurizing native proteins with xenon gas.
We notice:
1. The site of attachment of heavy atoms is not due to chance; for example,
histidine residues frequently act as ligands, sulphur atoms in methionine
often bind platinum compound, etc.

316
Isomorphous replacement techniques
2. The number of binding sites per protein molecule is small, generally from
1 to 10.
3. Their chemical occupancy may be inferior to unity. The most useful
derivatives are those for which heavy-atom binding is not disordered; unfor-
tunately, it usually occurs that, at a given position, the heavy atoms are not
present in all of the unit cells, and this fact simulates chemical occupancies
smaller than unity. Full occupancy has usually good effects on the success
of SIR-MIR techniques.
4. The isomorphism is never perfect, because of the chemical reaction
between reagent and protein. When heavy atoms are incorporated into the
native protein, two effects may arise. A change in the cell constants, which
may be easily recognized by the diffraction experiment, and a change in
the orientation of molecular fragments (which does not necessarily pro-
duce cell changes). A preliminary control of isomorphism may be made
according to the following criteria: the unit cell of the target and of the
derivative structure are expected to be different for less than 1.5%, the
corresponding diffraction intensities are not signiﬁcantly different. For the
latter parameter, the crystallographic residue Rcryst may be used as a cri-
terion; if it lies between 0.15 and 0.25, the isomorphism condition may
be accepted. A smaller value of Rcryst indicates little incorporation of the
heavy atoms. Crick and Magdoff (1956) ﬁrst showed that incorporation of
heavy atoms produces detectable differences in the diffraction intensities
(see Appendix 14.C).
5. The derivatization of large biological molecules (or of aggregates of them,
like ribosomes) requires special care. Indeed, numerous atoms would be
necessary in this case to produce measurable signals; the location of such
multiple derivatives would then be extremely difﬁcult, and therefore, this
approach is not suitable. Alternatively, one can take advantage of compact
and dense compounds containing, in a small volume, a large number of
heavy atoms directly linked to each other (see, e.g. Thygesen et al., 1996;
Schlünzen et al., 1995). The large size of these clusters has some prac-
tical consequences: multiple-site binding is not frequent, but diffusion of
the clusters into a crystal may be difﬁcult. The cluster may bind in several
modes (e.g. more than one atom is capable of coordination with the mac-
romolecule). The cluster may be treated as a unique scatterer, and heavy
atoms cannot be resolved; isomorphism is then maintained up to 6–8 Å res-
olution. If the cluster has perfect symmetry, the individual positions of the
cluster atoms can be resolved and the phasing power of the derivative is
higher.
From the above statements, the following conclusion arises: the purpose of
soaking is not to obtain derivatives, but to obtain isomorphous derivatives. The
method is a trial and error technique, and often requires patience and determ-
ination. For the designing of derivatization experiments it may be useful to
consult the heavy-atom protein data bank (available at <http: //www.bmm.
icnet.uk/had/index.html>), which contains information on heavy-atom deriv-
atives for more than 1000 protein crystals.

The algebraic bases of SIR techniques
317
14.3
The algebraic bases of SIR techniques
Let us suppose that diffraction data of the native protein and of one isomorph-
ous derivative have been collected. FP and Fd are the corresponding structure
factors and φP and φd are the related phases. If FH and φH are the structure
factor and the phase of the heavy atom substructure, and if we assume a perfect,
ideal isomorphism between native protein and derivative, then the relation
Fd = FP + FH
(14.1)
holds. At this initial step of the phasing process, |Fd| and |FP| are known from
the diffraction experiment; φd and φP as well as |FH| and φH are unknown. The
number of heavy-atom sites and their chemical occupancy are also unknown
at this stage.
Equation (14.1) is represented in Fig. (14.1); no estimate can be made at this
stage on the value of φP without some additional information.
Imag. axis
Real axis
Fd
φd
φP
φH
FP
FH
Fig. 14.1
Vector
triangle
showing
the
relation
between Fp, Fd, and FH.
Let us now suppose that |FH| and φH are known; we will show that estimating
φP is now possible. In Fig. 14.2, we draw, in the Argand plane, the Harker
diagram, consisting of two circles, the ﬁrst centred at the origin O with radius
|FP|, the second centred at the tip of the vector −FH with radius |Fd|. The
two circles meet at two points, the only ones compatible with equation (14.1);
accordingly, φP may only assume two values. We are here explicitly excluding
the case in which |FH| = 0, where the circles are essentially concentric and do
not have well-deﬁned points of intersection.
The Harker diagram may easily be transferred into simple trigonometric
calculations. Indeed, equation (14.1) may be rewritten as,
|Fd|2 = |FP|2 + |FH|2 + 2 |FPFH| cos(φP −φH).
(14.2)
Then,
cos(φP −φH) =
|Fd|2 — |FP|2 −|FH|2
/ (2|FPFH|)
and
φP = φH + cos−1 |Fd|2 — |FP|2 −|FH|2
/ (2|FPFH|)

= φH ± α.
(14.3)
Imag. axis
Imag. axis
Real axis
Real axis
(a)
(b)
Fd
Fd
Fd
Fd
FP
FP
FP
FP
O
–FH
–FH
Fig. 14.2
Harker construction illustrating the SIR
method for the cases: (a) |Fd| > |Fp|;
the two allowed solutions assign to φP
a value close to φH. (b) |Fd| < |Fp|; the
two allowed solutions assign to φP a value
close to φH + π.

318
Isomorphous replacement techniques
Because of the two possible values of the cosine term, two φP solutions arise,
which are symmetric with respect to φH. If |Fd| > |Fp|, the two allowed solu-
tions for φP are close to φH. If |Fd| < |Fp|, the two allowed solutions for φP are
closer to φH + π (see Fig. 14.2).
The above conclusion suggests the following two-step phasing procedure:
Step 1: Solve the heavy atom substructure, in order to estimate |FH| and φH;
Step 2: Use this information to phase the protein, by solving the phase
ambiguity ﬁxed by equation (14.3).
Fd
φH – φd
FP
⏐Δiso⏐
FH
φP
φd
Fig. 14.3
The relation between iso, FH, and
cos(φd −φH).
But how do we solve the heavy-atom substructure? This is a very small struc-
ture, and, on the basis of experience accumulated in the small molecule ﬁeld, a
fairly good estimate of |FH| is needed. If this information is available, to accom-
plish Step 1, two approaches may be used: calculate a |FH|2 Patterson synthesis
(to be deconvoluted in accordance with the techniques described in Chapter
10), or, to submit the estimated |FH| to traditional direct methods, charge ﬂip-
ping, or VLD techniques, according to personal preference (see Chapters 6, 9,
and 10). Figure 14.3 suggests the following approximation:
iso ≈|FH| cos(φd −φH),
(14.4)
where
iso = |Fd| −|FP| is the so-called isomorphous difference. From (14.4),
|FH| ≈iso/ cos(φd −φH)
arises. Unfortunately, at this step φd and φH are unknown, and (14.4) cannot
be applied.
Perutz (1956) suggested use of the relation |FH|2 ≈||Fd|2 −|FP|2 and
the corresponding Patterson is called a difference Patterson, but is not very
convenient. Indeed, if we expand |Fd|2 in its components we have,
|Fd|2 −|FP|2 = (FP + FH)(F∗
P + F∗
H) −FPF∗
P = |FH|2 + FHF∗
P + FPF∗
H.
The result is that |Fd|2 −|FP|2 contains not only the correct squared heavy-
atom structure factor, but also substantial noise arising from native–heavy
atomic distances. Blow (1958), Blow and Crick (1959), and Rossmann
(1960) showed that a better approximation is:
|FH|2 ≈(|Fd| −|FP|)2 ≡2
iso.
(14.5)
Since (see Fig. 14.1),
|FH|2 = |FP|2 + |Fd|2 −2|FdFP| cos(φP −φd),
(14.6)
if |Fd| and |FP| are large with respect to |FH| (which is frequent in practice), then
Fd and FP will have similar phase values and (14.6) may be approximated by
|FH|2 = |FP|2 + |Fd|2 −2 |FdFP| ≡|iso|2.
The resulting isomorphous difference Patterson is therefore closer to the
heavy-atom Patterson synthesis than the difference Patterson synthesis
(Terwilliger and Eisenberg, 1987). However, considerable noise is present in
the |iso|2 synthesis also; the reader can easily verify from Fig. 14.1, that if FH
is perpendicular to Fd, iso ≈0, irrespective of the value of |FH|.

The algebraic bases of SIR techniques
319
Deeper algebraic analyses were performed by Phillips (1966), Dodson
and Vijayan (1971), Blessing and Smith (1999), and Grosse-Kunstleve and
Brunger (1999), who suggested useful weighting schemes.
Once the heavy-atom substructure is solved, Step 2 may be started. But,
how do we solve the phase ambiguity ﬁxed by equation (14.3)? Indeed, this
equation does not seem to be very useful, because the two allowed φP values
may be far away from each other and it is not known which of the two values
should be preferred. The solution may be obtained by looking at Fig. 14.3; if
|iso| is sufﬁciently large (then |FH| must be sufﬁciently large, because |FH| >
|iso|), then cos(φd −φP) must be close to unity, at least for ideal isomorphism
and perfect experimental data; otherwise, |FH| is obliged to take values too
large for the small scattering power of the heavy-atom substructure. In this
case (that is, when |iso| is sufﬁciently large), the two allowed values of φP
are close to each other, and the following assumptions would not (at least in
favourable cases) imply a large error:
φP ≈φH
if
iso > 0,
(see Fig. 14.2a)
and
φP ≈φH + π
if
iso <0.
(see Fig. 14.2b)
The centrosymmetric case is treated in Appendix 14.A.
Some practical details should be discussed, to better explain the main
obstacles to a straightforward phasing:
(i) The |iso| represent always lower bound estimates of |FH|, and are there-
fore affected by systematic errors which, inevitably, make the phasing
process more difﬁcult, no matter whether direct methods or Patterson
deconvolution techniques are used. In the ﬁrst case, the errors affect the
reliability of phase relationships, in the second, they lower the quality of
the isomorphous difference Patterson. The situation is not different if a
third approach is used: considering the task of locating heavy atoms as
a special case of molecular replacement, for which the trial model con-
sists of only one atom (Vagin and Teplyakov, 1998; Grosse-Kunstleve
and Brunger, 1999). The rotation function is not necessary because of the
spherical symmetry of the model, only the translation function (similar to
that deﬁned in Section 13.7) has to be applied.
(ii) As stated above, SIR phasing is based on amplitude differences; therefore,
small errors on the values of the amplitudes may also generate large errors
in their differences and in the related phases. For a numerical insight
into the problem, let |Fd| /σd and |FP|/σP be the ratio amplitude/standard
deviation for the derivative and for the protein, respectively. Frequently,
both may be larger than ﬁve; conversely, (|Fd| −|FP|)/σ, where
σ = (σ 2
d + σ 2
P)1/2 is the standard deviation which may be associated
with the difference in amplitudes, and is not frequently larger than ﬁve.
The errors on |FH| estimates will increase even more if scaling of |Fd|
on |FP| is imperfect; thus, special procedures are needed to put derivative
data onto their absolute scales (see Section 14.5).
(iii) Usually the experimental data resolution of the derivative is worse than
that of the native protein. Therefore, the above approach can only be

320
Isomorphous replacement techniques
applied to reﬂections which are in common with both native and derivat-
ive data; as a consequence, phase expansion and reﬁnement via EDM
techniques is a necessary supplemental step for improving the model
obtained via isomorphous data.
(iv) The heavy-atom substructure determined at the end of Step 1 does not
necessarily have the correct handedness; there is only a 50% chance of
having determined the correct enantiomorph.
(v) There is a second source of ambiguity: two values are allowed for the
protein phases when the heavy-atom substructure is known. Taking their
average probably leads to an electron density map where two structural
images are present. This ambiguity may be overcome by improving and
extending the phases via EDM techniques. Let us now suppose that the
procedure converges to a ﬁnal map where one of the two images has been
cancelled. We will still have a 50% chance of obtaining the correct enan-
tiomorph. A decision may be taken by looking at the helices; all of their
densities should appear left-handed in the correct map. If the handedness
of the substructure is recognized to be wrong, the correct structure may be
obtained by changing the fractional coordinates from r to –r. If the space
group is one of the enantiomorphic pairs (e.g. P31 or P32, P3121 or P32
21), then the space group also has to be inverted (e.g. from P31 to P32,
or vice versa; from P3121 to P32 21, or vice versa). In the chiral space
groups I41, I4122, and I4132, the crystallographic symmetry, applied to
the 41 axis, generates a 43 operator (and vice versa). Thus, the chiral part-
ners of these space groups (say I43, I4322, and I4332) are not distinct from
the originals, and the International Tables for Crysallography do not need
to report them. In these space groups, the origin is not located on an enan-
tiomorph axis, and the centre of inversion cannot coincide with the origin.
The handedness inversion therefore requires inversion operators like
(–x, –y + 1/2, –z), (–x, –y + 1/2, –z + 1/4), and (–x + 1/4, –y + 1/4,
–z + 1/4) (Sheldrick, 2007).
14.4
The algebraic bases of MIR techniques
Using more derivatives (MIR) is the traditional way for reducing the noise and
emphasizing the signal. To better understand the MIR advantages, let us return
to Fig. 14.2a and modify it in order to include a new derivative (see Fig. 14.4).
Besides the heavy atom and the derivative structure factors considered in
Fig. 14.2a (say FH1 and Fd1), the heavy atom and the second derivative struc-
ture factors (say FH2 and Fd2) have also been included into the ﬁgure. Since
the heavy-atom binding sites in the second derivative usually do not coincide
with those of the ﬁrst, FH1̸=FH2, Fd1̸=Fd2. In the ideal case (i.e. no error in the
data and no lack of isomorphism), only one of the two points on the |FP| circle,
compatible with FH1 and Fd1, is also compatible with FH2 and Fd2. The SIR
ambiguity is now overcome. Figure 14.4 is equivalent to solving the system of
equations
φP = φH1 + cos−1 
|Fd1|2 −|FP|2 −|FH1|2
/2|FPFH1|

φP = φH2 + cos−1 |Fd2|2 −|FP|2 −|FH2|2 /2|FPFH2| .

The algebraic bases of MIR techniques
321
Imag. axis
Real axis
Fd2
Fd1
FP
–FH1
FH2
Fig. 14.4
Harker diagram for two heavy-atom
derivatives.
However, the two equations may only be used if the heavy-atom positions
are referred to the same origin. An easy and widely used method of ﬁnding
a common origin is to calculate a difference Fourier synthesis with coefﬁcients
(|Fd2| −|FP|) exp(iφP),
where the phase angles φP come from the ﬁrst derivative. This synthesis dir-
ectly provides the heavy-atom positions of the second derivative, referred to
the same origin as the ﬁrst.
A generalization of the above techniques to three or more derivatives is
straightforward.
In early times, when experimental errors were larger (on average) and algeb-
raic methods were used, frequently, more than two derivatives were used.
Today, thanks to the advent of probabilistic approaches, one derivative is
usually sufﬁcient to phase the protein, provided that it is sufﬁciently isomorph.
Let us now check the phase ambiguities in the MIR case. When the ﬁrst
heavy-atom substructure has been determined, its handedness has a 50%
chance of being correct. The other substructures, determined via the above
described difference Fourier syntheses, are congruent with the ﬁrst; there-
fore, if the ﬁrst has a wrong handedness, all the others will show the same
handedness.
The SIR phase ambiguity is not present in MIR and only one phase value
is suggested for the protein. Accordingly, the application of EDM techniques
to MIR data will more easily converge to a good ﬁnal structure, which again,
however, has a 50% chance of being the correct enantiomorph. The choice of
enantiomorph may be undertaken by looking at the helices (all their densities
should appear left-handed in the correct map), and inverting the coordinates
if the ﬁnal structure has wrong handedness; exactly as described for the SIR
case.

322
Isomorphous replacement techniques
14.5
Scaling of experimental data
Data scaling is a preliminary step for any probabilistic or algebraic approach
to SIR-MIR. It is critical to the success of the phasing procedure, because
differences between isomorphous data are small, and therefore very sensitive
to scaling; even small errors in scaling may lead phasing to fail.
The aim of a scaling process is to set native and derivative diffraction amp-
litudes on their absolute scales before any further numerical treatment. For the
probabilistic approach to SIR, a second preliminary step is necessary: structure
factor normalization, which implies the supplementary estimate of the overall
temperature factors for both native and derivative. Wilson scaling procedures,
described in Chapter 2, may be used for both scaling and normalization, but
their success is hampered by the strong Debye effects on the Wilson plot, and
by the fact that derivative data resolution may be signiﬁcantly smaller than
that of native. We showed in Section 2.9 (see Fig. 2.10), that if scaling and
temperature factors are calculated for the same experimental data but at differ-
ent resolutions (e.g. one time using all the data up to RES and one time, cutting
them at a poorer resolution), the resulting two least squares lines may be quite
different in slope and intercept. It may therefore be expected that Debye effects
can heavily disturb the scaling of two isomorphous structures, if the data res-
olution of one is signiﬁcantly smaller than the other. To reduce Debye effects,
the procedure suggested by Blundell and Johnson (1976) may be followed:
(a) Firstly, KP and BP (scale and overall thermal factor of the protein at deriv-
ative resolution) are calculated by the standard Wilson method, and then
Kd/KP and Bd – BP are estimated through the equation,
ln

d < |FP|2 >
 
P < |FP|2 >
	
= ln(KP/Kd) + 2(Bd −BP) sin2 θ/λ2
(14.7)
In accordance with Chapter 2, the following deﬁnitions hold:

d =
Nd
j=1 f 2
j ,

P =
NP
j=1 f 2
j ,

H =
NH
j=1 f 2
j ,
where Nd, NP, NH are the number of non-hydrogen atoms in the unit cell for
the derivative, the native, and the heavy-atom structure, respectively.
Equation (14.7) is easily obtained by dividing each by the following two
equations (these are the basis of the Wilson plot):
<|FP|2 > = KP

0P exp

−2BP sin2 θ/λ2
,
<|Fd|2 > = Kd

0d exp

−2Bd sin2 θ/λ2
.
The Debye effects are minimized if (14.7) is used.
(b) While 
0P is usually known, the number and the occupancy factors
of the heavy-atom sites are unknown at this stage; thus, the approxima-
tion 
0d ≈
0P is necessarily introduced into (14.7), which implies that
derivative structure factors are put on the same scale as that of the native
structure factors.

The probabilistic approach for the SIR case
323
(c) Two probabilistic procedures, outlined in Appendix 14.C, may be used to
estimate the scattering power of the substructure. Once this information is
obtained, the estimated 
d = 
P + 
H values may be used in equation
(14.7) to put the derivative amplitudes on their absolute scale.
(d) In the MIR case, each derivative may be submitted to the above described
procedure to set the corresponding amplitude on the absolute scale.
It is worthwhile mentioning some practical aspects related to the scaling
problem:
(i) Sometimes, local scaling is used (Matthews and Czerwinski, 1975) to
reduce the effects of signiﬁcant non-random errors in the observed
amplitudes. The technique was reconsidered by Blessing (1997), who
introduced a local variable scale factor, q = q(h). The variable,
|F| = |FP| −q|Fd|
was introduced, where q is estimated by a least squares ﬁt minimizing
χ2 =
h+h

h−h
w[|FP|/|Fd| −q]2.
(14.8)
In relation (14.8), the summation over the indices runs in a local block
of reciprocal lattice points surrounding, but not including, the point h, for
which we want to estimate |F|. A typical block consist of (3 × 3 × 3) –1
points, but criteria may be used to optimize their size.
(ii) If the crystal diffracts anisotropically, an anisotropic scaling is attempted.
(iii) Most scaling programs try to detect outliers, marked by an extremely
high |iso|: these may dominate direct methods or Patterson phasing,
hindering heavy-atom substructure solution (Read, 1999). For example,
differences which exceed four times the root mean square deviation in the
corresponding resolution shell are rescaled or eliminated.
(iv) High-resolution data usually contain larger noise, and are removed from
the calculations; truncation of data usually increases the chance of solving
the structure.
14.6
The probabilistic approach for the SIR case
The number of symmetry-independent heavy-atom sites in the isomorphous
derivative structure exceeds 10 in exceptional cases. Structural problems of this
size are trivial for Patterson or direct phasing techniques if |iso| is an accurate
estimate of the true modulus RH. Unfortunately, in protein crystallography this
is not the case, as the crystallographic residue Rcryst between |iso| and RH may
also exceed 0.50.
Luckily, substructure solution is facilitated by the fact that the few heavy
atoms are dispersed in a large volume (the native protein unit cell); thus, their
peaks are far from each other and do not overlap, no matter what is the data
resolution.

324
Isomorphous replacement techniques
The algebraic techniques described in Section 14.3 are not the best way to
face the challenges connected with errors in experimental data or to minimize
the effects of the lack of isomorphism. Indeed,
(a) They do not take into account experimental errors in the observed (of
native and of derivative) amplitudes.
(b) The heavy-atom substructure model is often incomplete (e.g. when sites
with minor occupancy should still be discovered). Then errors in the
modulus and in the phase of FH arise.
(c) The hypothesis of perfect isomorphism does not hold in practice, e.g.
equation (14.1) should be replaced by the more realistic relation,
Fd = FP + FH + |μd| exp(iθ) ,
(14.9)
where μd is a complex vector arising from the imperfect isomorphism. It is
generated by displacement of protein atoms and of solvent molecules close
to the heavy atom-binding sites, and remains unknown up to when the native
protein has been completely solved; it varies with the reﬂection index h.
As a consequence of the points (a) to (c), Fig. 14.1 is no longer realistic;
the triangle deﬁned by the vectors FH,FP, and Fd presents a lack of closure,
indicated by ε in Fig. 14.5.
Clearly, the probabilistic approaches are more suitable than algebraic tech-
niques to face such challenges; they were pioneered by Blow and Crick
(1959), whose work strongly inﬂuenced subsequent scientiﬁc contributions.
Any modern approach should today consider suitable joint probability dis-
tribution functions, in which careful treatment is made of various sources of
error and of the correlations among them. We will below describe the logical
steps involved in such approaches with a minimum of mathematical treat-
ment. References to maximum likelihood procedures may be found in two
contributions by Pannu et al. (2003) and Read (2003a).
In order to consider the correlations between Fd, FP, and FH, the joint
probability distribution,
P(Rd, RP, RH, φd, φP, φH)
(14.10)
should be studied. We notice that this distribution is very similar to that
described in Section 9.A.1, where the structure factors of a target structure,
of a model, and of a difference structure were studied; such a distribution turns
into equation (9.A.1) if the role of the target structure is played by the derivat-
ive, the model by the heavy-atom substructure, and the difference structure by
the native protein.
Imag. axis
Real axis
A
O
Fd
φP
ε
FP
FH
φH – φP
Fig. 14.5
Vector triangle emphasizing the lack
of closure when lack of isomorphism
occurs.

The probabilistic approach for the SIR case
325
From the distribution (14.10), all the parameters necessary for phasing the
native protein may be derived. We will analyse separately the logical oper-
ations necessary for treating Step 1 and Step 2, as deﬁned in Section 14.3,
without providing the mathematical detail.
Step 1 We are interested in estimating RH, given the observations; say, given
RP and Rd (phases are unknown at this stage). Thus:
(i) We integrate equation (14.10) over the phases φd, φP, φH, so as to obtain
the marginal distribution,
P(Rd, RP, RH).
(14.11)
(ii) From (14.11), the conditional distribution,
P(RH|Rd, RP)
(14.12)
is obtained by standard techniques.
(iii) From (14.12), the conditional average value
<RH|Rd, RP >
(14.13)
is derived (from now on denoted <RH > for simplicity).
<RH > is the value to submit to direct phasing procedures (traditional dir-
ect methods, charge ﬂipping, VLD) for solving the heavy-atom substructure,
and <R2
H > is the best coefﬁcient for calculating the heavy-atom substructure
Patterson map.
According to Giacovazzo et al. (2004),
< |RH|> =
1
(1 + <|σd|2 >)1/2
π
4 <|σd|2 > +
2
iso

H + <|μd|2 >
1/2
(14.14)
and
<|RH|2 > =
1
(1 + <|σd|2 >)

<|σd|2 > +
2
iso

H + <|μd|2 >

,
(14.15)
with
σRH =

1 −π
4
	
<|σd|2 >
(1 + <|σd|2 >)
1/2
.
Thus, <|RH|2 > is estimated by equation (14.15) and σRH is the standard devi-
ation of the estimate. σRH depends on <|σd|2 > = <|μd|2 > / 
H which is
the pseudonormalized standard deviation connected to the global error on the
derivative, including the lack of isomorphism.
Equation (14.15) suggests that if <|μd|2 > = 0, the probabilistic approach
conﬁrms the Blow and Rossmann approximation; if <|μd|2 > ̸= 0, the Blow
and Rossmann approximation should be affected by a systematic error,
increasing with <|μd|2 >.

326
Isomorphous replacement techniques
Step 2 We assume in this step that RH and φH are known (in other words, that
Step 1 has been successfully accomplished). Then:
(i) From (14.10), the conditional distribution,
P(Rd, RP, φP, φd|RH, φH)
(14.16)
is calculated.
(ii) The assumption φP ≈φd may be made; indeed, in the most interesting
cases, |FH| is much smaller than |Fd| and |FP|, and therefore cannot cause
a big difference between φd and φP. The distribution,
P(Rd, RP, φP|RH, φH)
(14.17)
is then obtained.
(iii) The conditional distribution,
P(φP|Rd, RP, RH, φH)
(14.18)
is derived.
(iv) From (14.18), the best φP value may be deduced.
According to Giacovazzo and Siliqi (2002),
P(φP|Rd, RP, RH, φH) = [2πI0(G)]−1 exp[G cos(φP −φH)]
(14.19)
is obtained, where G is the phase reliability factor given by,
G = 2(|Fd| −|FP|)|FH|
<|μd|2 >
= 2iso|FH|
<|μd|2 >
(14.20a)
In accordance with (14.19) and (14.20), the expected value of φP is φH if iso >
0, and is φP + π if iso <0; the larger the product |isoFH|
<|μd|2> , the more accurate
the phase estimate will be. It may be useful to rewrite equation (14.20a) in
terms of normalized structure factors (with respect to the protein scattering
power),
G = 2(Rd −RP)RH
σ 2
,
(14.20b)
where
σ 2 = <|μd|2 >
 
P .
Let us now suppose that the phases have been assigned. An electron dens-
ity map with observed RP coefﬁcients and best φP values cannot provide an
accurate model of the native protein, unless some phase reﬁnement is made.
Rossmann (1960) suggested reﬁnement of the substructure parameters by
minimizing
S =

w[|FHobs| −|FHcalc|]2.
While |FHcalc| may be computed from the substructure parameters, |FHobs|
is only available experimentally for centric reﬂections; this detail makes the
procedure inefﬁcient. A better method (Dickerson et al., 1961; Muirhead
et al., 1967; Dickerson et al., 1968; Terwilliger and Eisenberg, 1983) involves
minimization of the function,
S =

wε2,
(14.21)

The probabilistic approach for the MIR case
327
where
w is a weight associated with each reﬂection;
ε = (|Fd|obs −|Fd|calc), this is called the lack of closure error;
|Fd|obs is the measured amplitude of the derivative structure factor;
|Fd|calc| = |FP + FH| is the calculated derivative structure factor, a function
of the moduli and of the phases of the native and the derivative structures.
Once a set of approximated protein phases are estimated via the distribu-
tion (14.19), the moduli |Fdcalc| may be calculated and then (14.21) may be
minimized, so reﬁning positions, occupancies, and temperature factors of the
heavy atoms. The reﬁned parameters are then used to calculate a new set of
protein phases through equation (14.19). The process goes on via alternate
cycles of parameter reﬁnement and native phase calculation, until convergence
is reached.
The progress of phase reﬁnement is usually monitored using three factors:
RCullis =

||Fdobs ± FPobs| −|FHcalc||
 
|Fdcalc ± |FPobs||,
which was originally deﬁned for centric reﬂections, but it is also a useful
statistical ﬁgure for acentric reﬂections.
RKraut =

||Fdobs| −|Fdcalc||
 
|Fdobs|,
which is equal to the sum of closure residuals divided by the sum of derivative
amplitudes.
PhP =

|FH|
 
||Fdobs| −|Fdcalc||,
deﬁned as the sum of heavy-atom contributions divided by the sum of closure
residuals.
Acceptable values of RCullis are between 0.4 and 0.6, while PhP, also called
the phasing power, is expected to be larger than unity.
The same considerations on handedness hold for the probabilistic approach
to SIR as are described in Section 14.3 for the algebraic approach.
14.7
The probabilistic approach for the MIR case
In Section 14.6 we have described the two steps necessary for phasing the nat-
ive protein in the SIR case via a probabilistic approach. The procedure must
certainly be modiﬁed if more derivatives are available, but there are some steps
in common with the SIR case. For example, the diffraction amplitudes of the
native and of each derivative are settled on their absolute scales, the corres-
ponding structure factors are normalized, and the heavy-atom substructures
are found and reﬁned. These steps were described in the preceding sections,
and we will assume that the corresponding procedures are applied to each
derivative.
At this stage, application of equations (14.19) and (14.20) to each of the n
derivatives provides the set {φP}i , i = 1, . . . , n, each of which is an estimate
of the native protein phases. The ith and jth estimates may be quite unlike
each other, because the two derivatives may have different isomorphism, data

328
Isomorphous replacement techniques
resolution, and measurement errors. The most general way for handling the
MIR case when the substructures are known is to calculate the joint probability
distribution function (Giacovazzo and Siliqi, 2002),
P(EP, Ed1, . . . . . , Edn|EH1, . . . . , EHn),
(14.22)
from which the marginal distribution,
P(φP| . . .) = P(φP|RP, Rd1, . . . . . , Rdn, EH1, . . . . , EHn)
(14.23)
may be obtained. Distribution (14.23) is of a von Mises type:
P(φP| . . . ) = [2πI0(αP)]−1 exp[αP cos(φP −θP)],
(14.24)
where
tan θP =

n
j=1 Gj sin φHj

n
j=1 Gj cos φHj
= T
B,
(14.25)
Gj = 2(Rdj −RPj)RHj
σ 2
j
,
(14.26)
αP = (T2 + B2)1/2
(14.27)
θP is the most probable value of φP and αP is its reliability parameter.
In the distributions (14.22) and (14.23) the substructures are assumed to
be known; in practice, the substructure models available at the end of Step
1 may be poor, and consequently sets {φP}i obtained by application of equa-
tion (14.25) may also be a poor approximation of the true native phases. It is
then rewarding to spend some additional computing time to improve the sub-
structure models and then, as a consequence, the native phase estimates. This
task may be performed according to the following procedure:
(a) The ‘best’ derivative is selected, which is the one for which the SIR phas-
ing process is expected to provide the minimum phase error. Appropriate
ﬁgures of merit should be used for its recognition; Giacovazzo et al. (2004)
proposed the ﬁgure,
PON = (PhP/RCullis) · Nr,
where Nr = NREFL/NREFLmax is the ratio between the number of
observed amplitudes for the current derivative and the maximum number
of observed amplitudes among the various derivatives.
(b) The set of phases {φPbest}, obtained from the best derivative at the end of
the reﬁnement step, is employed to calculate, for each derivative, the differ-
ential Fourier synthesis with coefﬁcient (|Fdi| −|FP|) exp(iφPbest), where
subscript i refers to the current derivative. The rationale is that, even if the
n substructures are uncorrelated, the sets {φP}i , i = 1, . . . , n are expected
to be correlated with each other, because each {φP}i is an estimate of the
same set of phases, the native protein phases. Thus, if we associate {φPbest}
with the ith iso set, we should obtain the map which better approxim-
ates the ith true substructure. As observed in Section 14.4 for the algebraic
approach to the MIR case, the various substructures so obtained refer to
the same origin.

Applications
329
The new model substructure may be reﬁned by minimizing (14.21).
(c) The new sets of phases {φH}i , i = 1, . . . , n are combined via relationships
(14.24)–(14.27).
(d) Steps (a) to (c) may be cyclically repeated.
(e) EDM procedures are applied to improve and to extend the phase informa-
tion up to native resolution.
The same considerations on the handedness hold for the probabilistic approach
to MIR as are described in Section 14.4 for the algebraic approach.
14.8
Applications
Many fully automated programs exist for protein crystal structure solution via
SIR-MIR techniques. We quote SHELXD (Schneider and Sheldrick, 2002),
SOLVE (Terwilliger and Berendzen, 1999), CNS (Brünger et al., 1998).
Programs explicitly based on a probabilistic background include IL MILIONE
(Burla et al., 2007c) and PHENIX (Adams et al., 2002). The heavy-atom
substructures may be found by Patterson techniques or by direct methods,
according to personal preference. Maximum likelihood approaches for the
reﬁnement of substructures (and more generally for structure reﬁnement) are
very popular. The reader is referred to the above mentioned papers by Pannu
et al. (2003) and Read (2003b) for theoretical aspects, and to the programs
SHARP (Bricogne et al., 2003), MLPHARE (Otwinowski, 1991a), SOLVE
(Terwilliger and Berendsen, 2001), and PHENIX (Adams et al., 2002).
We will now schematize some simple SIR-MIR examples for an easier
understanding of the machinery. In Table 14.1, some relevant data for one SIR
and three MIR cases are reported. The reader should notice that at this initial
stage, the nature of the heavy atoms is known while their number per unit cell
Table 14.1 Essential data for one SIR case (APP) and three MIR cases (BPO, M-FABP,
NOX). For the native protein, the table provides information on the space group (S.G.), the num-
ber of non-hydrogen atoms in the asymmetric unit (NASYM), the protein data resolution (RESP),
and the number of measured reﬂections. For each derivative, the information concerns the nature
of the heavy atoms (H.A.), the data resolution (RESd), and the number of measured reﬂections
(NREFL d)
CODE
S.G.
native protein
derivatives
NASYM
RESP (Å)
NREFLP
H. A.
RESd (Å)
NREFLd
APP
C2
302
0.99
17058
Hg
2.00
2108
BPO
P213
4529
2.35
23956
Au
2.80
15741
Pt
2.76
17433
M-FABP
P212121
1101
2.14
7595
Hg
2.18
7125
Pt
2.15
6586
NOX
P41212
1689
2.26
9400
Pt1
2.26
9068
Hg
2.59
5425
Au
2.38
7299
Pt2
2.37
6752

330
Isomorphous replacement techniques
Table 14.2 For each SIR-MIR case quoted in Table 14.1, this table gives the initially estim-
ated scattering power of the heavy-atom substructure (
H / 
P ), the ﬁgure of merit (PON) for
estimating which is the best derivative, the ﬁnal correlation between the electron density map
obtained at the end of the SIR-MIR procedure, and the published map
PDB code
H. A.

H / 
P
PON
CORR
BPO
Au
0.11
1.22
0.78
Pt
0.06
0.61
MFABP
Hg
0.06
1.54
0.74
Pt
0.03
1.35
NOX
Pt1
0.03
1.34
0.74
Hg
0.22
0.94
Au
0.18
1.19
Pt2
0.03
0.90
and the corresponding site occupancies are unknown. The derivative resolution
is often worse than that of the native protein.
In Table 14.2, we report for each case:
(a) The ﬁrst estimate of the scattering power of the heavy-atom substructure
via the probabilistic procedure described in Appendix 14.C. This suggests
the capacity of the heavy atoms to bind protein residues, but still does not
state their occupancy (which may be established only at the reﬁnement
stage).
(b) The PON value (see Section 14.7) for each derivative. It may be assumed
that the largest PON characterizes the best derivative, that is, the one with
the minimum lack of isomorphism. As described in Section 14.7, the best
derivative is used for deriving the substructures of the other derivatives via
the difference Fourier syntheses, (|Fdi| −|FP|) exp(iφPbest).
(c) CORR is the correlation factor between the electron density of the reﬁned
protein model (that obtained at the end of the cyclic procedure described
in Section 14.7) and the published structure. In spite of full automation of
the process, the ﬁnal protein model is suitable for easy interpretation.
APPENDIX 14.A
THE SIR CASE FOR CENTRIC
REFLECTIONS
Let us consider equation (14.1), say
Fd = FP + FH.
We want to guess the modulus and phase of FH for centric reﬂections, given
|Fd| and |FP|. Let us suppose:
(a) |FH| > 0;
(b) |FH| << |FP| and |FH| << |Fd|.
Condition (b) is justiﬁed by the small scattering power of the heavy-atom sub-
structure with respect to scattering power of the native or of the derivative.

The SIR case: the one-step procedure
331
For centric reﬂections, φP, φd, φH must be collinear because all three phases
are submitted to the same symmetry restrictions. This result, together with
conditions (a) and (b), imply that
φP = φd and |FH| = || Fd |−| FP || ;
the extraordinary case, φP = φd + π, is excluded if condition (b) holds.
In Fig. 14.A.1a,b, two cases are shown, |Fd| > |FP| and |Fd| < |FP|. In the
ﬁrst case, φH = φP, in the second, φH = φP + π.
FP
FP
FP
FH
FH
Fd
Fd
Fd
FH
(a)
(b)
(c)
Fig. 14.A.1
Centric reﬂections: (a) if |Fp| < |Fd|,
then φp = φH; (b) if |Fp| > |Fd|, then
φp = φH + π; (c) ‘cross-over case’. This
occurs when |FH| is larger than |Fd| and
|FP|.
The extraordinary case in which φP = φd + π is shown in Fig. 14.A.1c; in
this case, called overcross, |FH| = | |Fd| + |FP| | and φH = φP + π. There are
very few cases in which the overcross occurs; necessarily, |Fd| and |FP| should
be very small, and this condition subtracts interest in the case.
APPENDIX 14.B
THE SIR CASE: THE ONE-STEP
PROCEDURE
In Chapters 6 and 9 we showed that traditional direct methods, as well as
charge ﬂipping and VLD, are unable to solve ab initio protein structures unless
of limited size and with atomic or quasi-atomic resolution. Size limits may be
extended to some thousands of non-hydrogen atoms in the asymmetric unit,
and resolution limits may be expanded to about 2 Å, if the structure contains
heavy atoms and Patterson techniques are used (see Section 10.4).
If one isomorphous derivative is available, its diffraction data constitute
a source of supplementary information which may extend the limits of tra-
ditional direct methods. The integration of DM with SIR techniques was
introduced by Hauptman (1982a) and revisited by Giacovazzo (1988). Both
authors studied the joint probability distribution,
P(EP1, Ed1, EP2, Ed2, EP3, Ed3),
(14.B.1)
where the subscripts 1, 2, and 3 replace h, k, and -h-k, respectively. From
(14.B.1), the conditional distribution,
P(P|RP1, Rd1, RP2, Rd2, RP3, Rd3)
(14.B.2)
was derived, where P = φp1 + φp2 + φp3. According to Giacovazzo,
P(P| . . .) ≈[2πI0(G)]−1 exp(G cos P),
(14.B.3)
where
G = 2RP1RP2RP3
N−1/2
Peq
+ 2123
N−1/2
Heq
(14.B.4)
 = iso
 1/2
H .
NPeq and NHeq are deﬁned by equation (5.5) for the native and derivative struc-
tures, respectively. According to (14.B.4), the concentration parameter G is the
sum of two contributions: the Cochran term, calculated for the native, plus an
additional term which depends on the pseudonormalized difference . Since

332
Isomorphous replacement techniques
the number of heavy atoms in the unit cell is much smaller than the number
of protein atoms, NPeq >> NHeq. The consequence is that for usual proteins,
the Cochran contribution to G is negligible with respect to the second. This is
quite a relevant result; it is shown that supplementary prior knowledge of the
derivative diffraction data reduces the complexity of the phasing problem from
order NPeq to order NHeq.
The expected sign of the triplet cosine mainly depends on the sign of the
product 123; a positive value of this product indicates positive cosine
values. Negative values of 123 are also frequent and suggest P values
close to π.
According to equation (14.B.3), the native structure phases may be found as
in traditional DM (see Chapter 6); i.e. the reﬂections with the largest values
of || are selected, triplet invariants are found among them, random phases
are generated and submitted to the tangent formula, and the most promising
solutions are selected via suitable ﬁgures of merit.
The above approach allows us to solve the native protein structure in one
step; preliminary solution of the heavy-atom substructure is no longer neces-
sary. Even if the one-step approach is highly appealing, the two-step approach
seems more effective, because it confronts the phasing difﬁculties gradually.
An interesting exercise is to establish a relation between the two-step SIR
approach and the above one-step procedure. Let us suppose that 1 > 0,
2 > 0 and 3 > 0; in this case, the distribution (14.B.3) suggests the relation,
P ≈0.
(14.B.5)
Classical two-step SIR techniques suggest the following relationships:
φP1 ≈φH1, φP2 ≈φH2, φP3 ≈φH3,
which, summed, give
P ≈H,
(14.B.6)
where H = φH1 + φH2 + φH3.
Expressions (14.B.6), provided by the two-step SIR relations, and (14.B.5),
provided by traditional direct methods, coincide if H ≈0. This will occur if
|1|, |2|,|3| are sufﬁciently large and if the number of heavy atoms in the
unit cell is small (as is usual in SIR cases).
Suppose now that 1 > 0, 2 > 0 and 3 <0. Then, distribution
(14.B.3) suggests
P ≈π.
(14.B.7)
Two-step SIR relations provide the following indications:
φP1 ≈φH1, φP2 ≈φH2, φP3 ≈φH3 + π
which, summed, give
P ≈H + π.
(14.B.8)
Since H ≈0, again (14.B.7) and (14.B.8) provide similar phase indications.

About methods for estimating the scattering power of the heavy-atom
333
APPENDIX 14.C
ABOUT METHODS FOR
ESTIMATING THE SCATTERING
POWER OF THE HEAVY-ATOM
SUBSTRUCTURE
We will describe two simple procedures for estimating the scattering power
of a heavy-atom substructure. The ﬁrst has an algebraic basis and is due to
Crick and Magdoff (1956); the second has a probabilistic background and was
suggested by Giacovazzo et al. (2002).
The algebraic relation. Let us suppose that one or more heavy atoms have
been added to the native protein, so giving rise to a perfect isomorph derivative.
Let <IP > be the average intensity for the protein at a given sin θ/λ, <IH >the
corresponding average intensity for the heavy atom structure, and <Id > the
value for the derivative. An estimate of the average relative change in intensity
is given by the ratio,
<> = [<(Id −IP)2 >]1/2
<IP >
.
(14.C.1)
Firstly, let us consider the acentric reﬂections. In accordance with equation
(14.C.1),
Id = |FP + FH|2 = |FP|2 + |FH|2 −2|FPFH| cos(φP −φH),
from which
Id −IP = |FH|2 −2|FPFH| cos(φP −φH).
(14.C.2)
Introducing (14.C.2) into (14.C.1) gives,
<> = { <|FH|4 > + <4|FPFH|2 cos2(φP −φH)> −<4|FP||FH|3 cos(φP −φH)> }1/2
<IP >
Since FP and FH may be considered to be uncorrelated, <cos(φP −φH)> is
expected to be close to zero and <cos2(φP −φH)> close to 1/2. Then,
<> ≈(<|FH|4 > + 2 <|FP|2 ><|FH|2 >)1/2
<|FP|4 >
.
(14.C.3)
Since <|FH|4 > is very much smaller than 2 <|FP|2 ><|FH|2 >, we can
approximate (14.C.3) by,
<> ≈
√
2

<IH >
<IP > ,
(14.C.4)
which is the Crick and Magdoff relation. Let us apply (14.C.4) to two pro-
teins of quite different size: the ﬁrst with 1000 atoms per molecule, the second
20 000 atoms per molecule. On assuming Zj = 7 for the average protein atom,
one mercury atom per molecule, we have at sin θ/λ = 0:
1. For the ﬁrst protein,
<IP > = 1000 × 49 = 49000
<IH > = 1 × 6400 = 6400
<> = 0.51.

334
Isomorphous replacement techniques
2. For the second protein,
<IP > = 20000 × 49 = 980000
<IH > = 1 × 6400 = 6400
<> = 0.11.
We see that the average change in intensity is quite detectable, even for large
proteins. It is also clear that a partial occupancy for the mercury atom gives
less favourable values of <>.
It is easy to show that for centric reﬂections,
<> = 2

<IH >
<IP >
(14.C.5)
If we compare (14.C.4) with (14.C.5), we see that <> is larger for restricted
phases than for general reﬂections.
Since <IH > / <IP > ≈
H / 
P, Equation (14.C.4) (and obviously equa-
tion (14.C.5)), may also be applied to estimate the scattering power of the
heavy-atom substructure: i.e.

H
 
P ≈<>2 .
4
The probabilistic relation. In Section 7.2, we illustrated the joint probability
distribution P(E, Ep), where E was the normalized structure factor of the tar-
get structure, and Ep was the normalized structure factor of a model structure.
The same distribution (say equation (7.3)) is valid if E and Ep are replaced
by structure factors EP and Ed of the native protein and of the derivative,
respectively.
From P(EP,Ed), the conditional distribution
P(||) = c−1 exp(−||/c)
(14.C.6)
may be derived, where
 = R′2
d −R2
P,
c =

H
 
d ,
R′
d = |Fd|
 
P
	1/2
.
Distribution (14.C.6) only depends on the scattering power of the unknown
heavy-atom substructure (
d is a known parameter). Therefore, the best c
value is that for which the theoretical distribution (14.C.6) ﬁts the experimental
|| distribution. Finding c is equivalent to estimating the scattering power of
the heavy-atom substructure.

Anomalous dispersion
techniques
15
15.1
Introduction
The term anomalous scattering originates from the ﬁrst research on light dis-
persion in transparent materials. It was found that, in general, the index of
refraction increases when the wavelength decreases (this was considered to be
normal). It was also found that, close to the absorption edges, the refractive
index shows a negative slope, and this effect was called anomalous.
Today, it is clear that anomalous dispersion is a resonance effect. Indeed,
atomic electrons may be considered to be oscillators with natural frequen-
cies; they are bound to the nucleus by forces which depend on the atomic
ﬁeld strength and on the quantum state of the electron. If the frequency of the
primary beam is near to some of these natural frequencies, resonance will take
place (the concept of dispersion involves a change of property with frequency).
The scattering is then called anomalous, it occurs in correspondence with the
so-called absorption edges of a chemical element, and is expressed analytically
via the complex quantity,
f = f0 + f ′ + if ′′,
(15.1)
where f0 is the scattering factor of the atom in the absence of anomalous scat-
tering. f ′ and f ′′ (with f ′′> 0) are called the real and imaginary dispersion
corrections.
f ′′ is proportional to the absorption coefﬁcient of the atom, μλ, at the given
X-ray energy Eλ:
f ′′λ =

mc/4πe2ℏ

Eλμλ,
where m and e are the electronic mass and charge respectively, λ is the
wavelength, c is the speed of light, and h = 2πℏ, the Planck constant.
f ′ may be obtained from an absorption scan via the Kramers–Kronig
transform relating the real to the imaginary component:
f ′(λ) = 2
π
 ∞
0
E′ f ′′(E′)
E2 −E′2 dE′.
An important question is whether f ′ and f ′′ vary with diffraction angle. Some
theoretical treatments suggest changes of a few percent with sin θ/λ, but no

336
Anomalous dispersion techniques
rigorous experimental check has been described; therefore, in most of the
applications (and also in this book), f ′ and f ′′ are considered to be constant.
As a consequence, the relative modiﬁcation of the scattering process due to
anomalous dispersion is stronger at high sin θ/λ values, where f0 is smaller,
while f ′ and f ′′ remain constant.
For most substances, at most X-ray wavelengths from conventional sources,
dispersion corrections are rather small. Calculated values for CrKα(λ =
2.229 Å), CuKα(λ = 1.542 Å), and MoKα(λ = 0.7107 Å) are listed in the
International Tables for Crytallography. Only in some special cases can
ordinary X-ray sources generate relevant dispersion effects. For example, the
following dispersion corrections are calculated for holmium, which has the L3
absorption edge, (∼1.5368 Å) close to CuKα radiation:
Cu Kα1(λ = 1.5406 Å);
f ′ = −15.41,
f ′′ = 3.70
Cu Kα2(λ = 1.5444 Å);
f ′ = −14.09,
f ′′ = 3.72.
Larger anomalous effects are obtained by using synchrotron radiation; from its
intense continuous spectrum, speciﬁc wavelengths may be selected with high
precision, in order to provoke, in several cases, exceptionally large anomalous
scattering.
Why do anomalous dispersion effects help to solve protein structures
(Peederman and Bijvoet, 1956)? We will see in the following that they simulate
isomorphism and more derivatives are simulated when multiwave techniques
are used. A pioneering study by Hoppe and Jakubowski (1975) on eryth-
rocruorin, an iron-containing protein, showed the feasibility of this method.
These authors used NiKα (1.66 Å) and CoKα (1.79 Å) radiation to vary f ′
and f ′′ sizes of Fe around its K edge (1.74 Å) and obtained phase values with
a mean phase error of 50◦.
What are the limits and the advantages of anomalous dispersion with respect
to isomorphous derivative techniques? We notice two disadvantages, in (a) and
(b) in the following, and a big advantage in (c):
(a) The signal provoked by anomalous scattering is inferior to that usu-
ally obtained by isomorphous replacement. The case of praseodynium
(Templeton et al., 1980), for which f ′ = −26, 2f ′′ = 55 and of gad-
olinium (Templeton et al., 1982), for which f ′ = 31.9, 2f ′′ = 62.4, are
exceptional. Therefore, the use of anomalous effects requires high meas-
urement accuracy.
(b) Since the modulus of f ′′ is proportional to the absorption coefﬁcient,
the corresponding correction for absorption should be carefully calcu-
lated. Luckily, heavy atoms usually have absorption edges in the short
wavelength range (say 0.6 Å < λ < 1.1 Å), for which absorption is greatly
reduced.
(c) The isomorphism of the derivatives with respect to the protein is never
ideal. We saw in Chapter 14 how challenging bad derivatives may be for
the success of the phasing process. If anomalous dispersion techniques
are used, the scattering structure coincides with the target structure, and
therefore no lack of isomorphism occurs.

Violation of the Friedel law as basis of the phasing method
337
Furthermore, in case of MAD, the anomalous scattering substructure does
not change with the wavelength (in the MIR approach, the heavy-atom
substructure changes by changing the heavy atom). As a result, the substructure
is overdetermined by MAD data.
The above considerations suggest that we should deal with different cases:
1. The SAD (single wavelength anomalous scattering) case;
2. The SIRAS (single isomorphous replacement combined with anomalous
scattering) case. Typically, protein and heavy-atom derivative data are
simultaneously available, with heavy atoms as anomalous scatterers;
3. The MAD (multiple wavelengths technique) case;
4. The MIRAS (multiple isomorphous replacement combined with anomalous
scattering) case.
15.2
Violation of the Friedel law as basis
of the phasing method
Suppose that an n.cs. crystal contains NP non-H atoms in the unit cell and that
all of them are anomalous scatterers. Usually, the number of efﬁcient anom-
alous scatterers is a very small fraction of the scatterers in the unit cell; to
include this hypothesis in our mathematical treatment, the reader may set to
zero the anomalous scattering of the atoms the contribution of which they want
to neglect. In the following, for shortness, we will indicate Fh and F−h by
F+ = |F+| exp(iφ+) and F−= |F−| exp(iφ−), respectively. Then,
F+ =
NP
j=1

f0j + f ′j + ifj′′
exp

2πi h · rj

= F+
0 + F′+ + F′′+ = F′+ + F′′+,
(15.2)
where
F+
0 = NP
j=1 f0j exp

2πi h · rj

= |F+
0 | exp

iφ+
0

,
F′+ = NP
j=1 f ′j exp

2πi h · rj

,
F′′+ = NP
j=1 ifj′′ exp

2πi h · rj

= NP
j=1 f ′′j exp

i(2πh · rj + π/2)

= |F′′+| exp

iφ′′+
,
F′+ = F+
0 + F′+ = NP
j=1 ( f0j + f ′j) exp

2πih · rj

= |F′+| exp

iφ′+
.
Analogously:
F−=
NP
j=1

f0j + f ′j + if ′′j

exp

−2πih · rj

= F−
0 + F′−+ F′′−= F′−+ F′′−,
(15.3)
where
F−
0 = NP
j=1 f0j exp

−2πih · rj

= |F−
0 | exp

iφ−
0

,
F′−= NP
j=1 f ′j exp

−2πih · rj

,
F′′−= NP
j=1 if ′′j exp

−2πih · rj

= NP
j=1 f ′′j exp

i(−2πh · rj + π/2)

= |F′′−| exp

iφ′′−
,
F′−= F−
0 + F′−= NP
j=1

f0j + f ′j

exp

−2πih · rj

= |F′−| exp

iφ′−
.

338
Anomalous dispersion techniques
F+ and its component vectors F+
0 , F′+, F′+, F′′+, as well as F−and its
component vectors F−
0 , F′−, F′−and F′′−, are shown in Fig. 15.1a.
The reader will notice that F+
0 and F−
0 components also contain the normal
scattering contribution of the anomalous scatterers and that they are related
by the Friedel law. The Friedel law also holds for the pairs (F′+, F′−),
( F′+, F′−). In detail,
|F+
0 | = |F−
0 |,
φ−
0 = −φ+
0 ,
|F′+| = |F′−|,
φ′−= −φ′.
The Friedel law does not hold for the pair F′′+, F′′−; from deﬁnitions, the
relations
|F′′+| = |F′′−|,
φ′′−= π −φ′′+
are easily obtained (see Fig. 15.2). Therefore, while φ′+ and φ′−are symmet-
rical with respect to the zero angle, φ′′+ and φ′′−are symmetrical with respect
to π/2.
real axis
b)
a)
imag. axis
F¢+
Fo
–
 F¢–
F²–
F+
Fo
+
φ″+
ϕ
real axis
imag. axis
F+
Fo
+
φ+−φ–*
ΔF¢+
F²–*
F¢+ = F¢–*
F–*
F–
ΔF¢–
ΔF¢+
F²+
Fig. 15.1
(a) Relation between F+ and F−when
anomalous dispersion is present. (b) Re-
lation between F+ and F−∗when anom-
alous dispersion is present.
It may be useful to remember another vectorial relationship. In general con-
ditions, F′+ and F′′+ are not perpendicular. They are perpendicular only if
the anomalous scattering arises from the same atomic species. Then,
F′+ = f ′ NP
j=1 exp(2πih · rj),
F′′+ = if ′′ NP
j=1 exp(2πih · rj) = f ′′ NP
j=1 exp

i

2πh · rj + π/2

⊥F′+.
The relation between F+ and F−is more clearly understood if we compare
F+ with F−∗(the star indicates the complex conjugate), as in Fig. 15.1b. From
deﬁnitions, the following phase relations hold:
φ′−∗= φ′+,
φ′′−∗= −φ′′−= φ′′+ + π.
(15.4)
Equivalently, in vectorial form,
F′′−∗= −F′′+ and F′′+∗= −F′′−.
(15.5)
Because of (15.5), from now on we will denote the moduli |F′+|, |F′−| by |F′|
and the moduli |F′′+|, |F′′−| by |F′′|.
From Fig. 15.1a, it is very easy to derive the following relations:
|F+|2 = |F′|2 + |F′′|2 + 2|F′F′′| cos(φ′′+ −φ′+)
(15.6a)
and
|F−|2 = |F′|2 + |F′′|2 + 2|F′F′′| cos(φ′′−−φ′−).
In accordance with equation (15.4) and Fig. 15.2b, the above equation may be
modiﬁed to,
|F−|2 = |F′|2 + |F′′|2 −2|F′F′′| cos(φ′′+ −φ′+).
(15.6b)
From (15.6a) and (15.6b),
I = |F+|2 −|F−|2 = 4|F′F′′| cos(φ′′+ −φ′+).
(15.7)

Violation of the Friedel law as basis of the phasing method
339
and
|F+|2 + |F−|2
2
= |F′|2 + |F′′|2
(15.8)
are easily obtained.
Relation (15.7) suggests that |Fh| = |F−h| is no longer valid; in other words,
in n.cs. space groups the Friedel law is not satisﬁed in the presence of
anomalous dispersion.
Figure 15.3 suggests that, if F′+ is perpendicular to F′′+, the Friedel law
concerning the moduli |Fh| and |F−h| is satisﬁed, even if the structure is n.cs.;
but this happens only by chance. On the contrary, the Friedel law:
(i) is satisﬁed in an n.cs. crystal if it is composed entirely of the same
anomalous scatterer;
(ii) is systematically satisﬁed in cs. structures. Indeed, if the structure is cs.
(see Fig. 15.4), then F′+ = F′−= F′−∗is a real value, while F′′+ ≡F′′−
is an imaginary value; indeed, φ′′+ = φ′′−= ±π/2.
Accordingly, F+ ≡F−, and the following statement arises:
in cs. space groups the Friedel law is satisﬁed even in the presence of
anomalous scattering.
The Friedel law is also satisﬁed for phase restricted reﬂections in n.cs. space
groups.
(a)
(b)
φ′ + ≡ φ′–* 
φ′– ≡ φ′+* 
φ′′–
φ′′+
φ′′+*
φ′′ –*
Fig. 15.2
Phase relationships between: (a) φ′+ and
φ′−; (b) φ′′+ and φ′′−. φ′+ and φ′−are
the phases of the reﬂections F′+ and F′−;
φ′+∗and φ′−∗are the phases of the reﬂec-
tions F′+∗and F′−∗, complex conjugates
of F′+ and F′−, respectively. Since F′+
and F′−obey the Friedel relationship,
then φ′+ = φ′−∗and φ′−= φ′+∗. F′′+
and F′′−do not obey the Friedel rela-
tionship: we have φ′′+ = φ′′−∗+ π and
φ′′−= φ′′+∗+ π.
real axis
imag. axis
F–*
F″F–*
F′+ = F′–*
F+
F″+
Fig. 15.3
I = 0 if F′+ is perpendicular to F′′+.
Let us now consider how anomalous dispersion modiﬁes the reciprocal
space symmetry. In the absence of anomalous dispersion, the number of reﬂec-
tions with equal (because of the symmetry) amplitude is ﬁxed by the Laue
group. If an anomalous signal is present in an n.cs. space group of order m, the
following relations hold:
|Fh| = |FhR2| = . . . . . = |FhRm|
and
|F−h| = |F−hR2| = . . . . . = |F−hRm|
with
|F−h| ̸= |F−h|.
For example, for C2,
|Fhkl| = |F¯hk¯l| ̸= |Fh¯kl| = |F¯h¯k¯l|.
It may be concluded that:
for normal scattering, the equivalence of reﬂections is ﬁxed by the Laue
group symmetry, while, when anomalous scattering occurs, the equivalence
agrees with the point group symmetry (Ramaseshan, 1963).
real axis
imag. axis
F′+ = F′ –
F ′′ + ≡ F′′ –
F+ ≡ F–
Fig. 15.4
The cs. case: F+ and F−when anomalous
dispersion is present.

340
Anomalous dispersion techniques
The reader will certainly have understood that a violation of the Friedel law
is just the source of information necessary to solve a structure. Indeed, the
anomalous difference,
ano = |F+| −|F−|,
depends on the nature of the anomalous scatterers and on their positions; con-
versely, the anomalous substructure may, in principle, be derived from the
anomalous differences.
If the anomalous scattering from light atoms like C, O, N, H, (these are
nearly all the atoms in proteins) may be neglected (see Section 15.3), the
anomalous substructure mainly consists of some (relatively) few anomalous
scatterers. Thus, as for the isomorphous derivative technique, the phasing
approach may be subdivided into two steps: deﬁning the anomalous sub-
structure ﬁrst, and then phasing the protein. If we compare this just outlined
approach with the isomorphous derivative method, we see that the role of the
isomorphous difference, iso, is now played by ano. This is the reason why
it is usual to state the following (Pepinsky and Okaya, 1956; Ramaseshan and
Venkatesan, 1957; Mitchell, 1957):
anomalous dispersion effects simulate isomorphism.
15.3
Selection of dispersive atoms
and wavelengths
Anomalous dispersion may be used in small- as well as in macro-molecule
crystallography. Since the phase problem is practically solved for small-sized
structures, in this area anomalous effects are mostly used for other purposes
(see Helliwell, 2000). For example:
(i) by tuning the wavelength close to the absorption edge of speciﬁc ele-
ments, it is possible to distinguish atoms which have close atomic
numbers, even when they occupy the same site.
(ii) in microporous materials, for determining the concentrations of transition
metals incorporated into the frameworks.
(iii) in powder crystallography, as an additional tool for phasing (see
Section 15.9).
In this chapter, we are mainly interested in macromolecular crystallography.
For such structures we will give some practical recipes for designing good
SAD or MAD experiments.
MAD experiments are very demanding in terms of beamline properties. The
question is: which strategy should be chosen in order to collect the minimum
amount of data allowing a straightforward crystal structure solution (Gonzalez,
2003a,b)? To decide which strategy, the characteristics of the crystal sample
(e.g. resistance to radiation damage, diffracting power, chemical composi-
tion) and the properties of the X-ray source (e.g. intensity of the beamline
at the wavelengths of interest, ease of tunability, stability, and reproducibility)

Selection of dispersive atoms and wavelengths
341
should be considered. If the beamline does not fulﬁl one or more of the above
requirements, a SAD experiment is advisable.
In the case of a weak anomalous signal (e.g. on the S anomalous disper-
sion), some additional parameters like exposure time and data redundancy may
become more critical. According to Cianci et al. (2008) <|ano|/σ(ano)>
greater than 1.5 for all resolution shells is a necessary requirement for a
successful phasing attempt.
The above considerations suggest that the phasing process would become
more straightforward if the anomalous signal is maximized; that may be done
by introducing (if necessary) stronger anomalous scatterers into the crystal,
and/or by proper selection of the wavelengths. Let us examine the various
aspects.
The usable energy range for most synchrotrons is in the range 5–15 keV;
to have good anomalous differences, the absorption edges (K, or L, or M) to
exploit should lie in this range. Luckily, most of the elements of the periodic
table show edges in this interval (see Fig. 15.5). In particular, many metal-
loenzymes, oxidase, reductase, etc. naturally contain transition metals like Fe,
Zn, Cu, etc. with absorption edges in the range 5–15 keV, and also very heavy
atoms (like Hg, Pt, Au, Br) show a strong L-edge in that range. Only ele-
ments belonging to the 5th period between Rb and Te lie outside the range; we
will see below, however, that anomalous data collection may also be made at
wavelengths above the absorption edge, even if this choice does not maximize
the anomalous difference (Leonard et al., 2005).
The S absorption edge falls outside the K-range, which is the reason why
special selenoproteins are grown, i.e. proteins where the S atom in methionines
is replaced by Se. There are two main reasons for preferring seleno-methionine
to methionine. The ﬁrst is that Se is a more efﬁcient anomalous scatterer;
the second is that, at a given wavelength λ, the best achievable resolution is
RES = λ/2. Since the K-edge for sulphur falls at 5.018 Å, the best resolution
experimentally attainable is about 2 Å; the K-edge for Se falls at 0.98 Å, so
allowing more complete experimental datasets.
5
10
X-ray energy (keV)
10
20
30
40
50
60
70
80
90
atomic number
GAP
L
L1
L3
K
K
15
20
Fig. 15.5
Absorption edges as a function of the
atomic number. The interval 5–15 keV
approximately corresponds to the interval
2.48–0.83 Å.

342
Anomalous dispersion techniques
–10
–5
0
Electrons
5
10
15
–15
12600
(0.9840Å)
12650
(0.9801Å)
12700
(0.9763Å)
Energy (eV)
Δf ′
ƒ ″
minΔf ′
12750
(0.9724Å)
high f ″ remote
low f  ″ remote
f ″ maximized
12800
(0.9686Å)
Fig. 15.6
Se dispersion pattern close to the K
absorption edge.
Let us now consider how the wavelengths may be chosen in a typical MAD
experiment. We will see in the following paragraphs that, besides ano, also the
dispersive differences, disp (say |F+
λi| −|F+
λj| or |F−
λi| −|F−
λj|) and the mixed
differences, |F+
λi| −|F−
λj| may contribute to the phase problem solution.
The ﬁrst data are usually measured by using a wavelength which maximizes
the f ′′ (peak dataset; see Fig. 15.6).
Accordingly, the second wavelength is usually chosen at the negative peak
of the f ′ curve, to maximize the dispersive differences between wavelengths.
This wavelength coincides with the inﬂection point of the f ′′ scan, and the
corresponding data are called the inﬂection point dataset. It may be useful to
notice that at such an inﬂection point, the f ′′ value is about half the value at
the peak, while the dispersive difference with any other wavelength is very
high. If the radiation damage is low, a third wavelength may be chosen; the
corresponding data are denoted as a high energy remote dataset. This shows a
non-negligible f ′′ signal and a good dispersive contrast against the inﬂection
dataset.
If radiation decay is slowly progressing, a fourth low energy wavelength
may be chosen (then, low energy remote data are collected). Even if there is a
high f ′′ contrast with the peak and a still good f ′ contrast with the inﬂection
point, this wavelength is the last choice because of the large absorption of light
atoms, which may rapidly destroy the crystal.
X-ray absorption edges are very sharp in many cases; thus the energies of
the peak and of the inﬂection points are seperated by a few eV. In addition,
the exact position of the edge depends on the chemical environment of the
anomalous scatterers. It is therefore mandatory to record the absorption edge
at the time of a MAD experiment.
Sometimes, the anisotropy of anomalous scattering should be taken into
account. Templeton and Templeton (1988) showed that a remarkable aniso-
tropy can be found for the Se K-edge in selenomethionine proteins, caused by

Selection of dispersive atoms and wavelengths
343
the non-spherical symmetry of the antibonding valence orbitals. In such cases,
the anomalous dispersion effects depend on the orientation of the incident and
diffracted beams relative to those molecular orbitals. Templeton and Templeton
developed a tensorial formalism for the anomalous dispersion, which can be
successfully applied in practical cases (see Hendrickson et al., 1989). Schiltz
and Bricogne (2008) observed that, as an effect of the anisotropy of anom-
alous scattering, intensity differences between symmetry-related reﬂections
rise. They considered this effect as a supplementary source of extra exper-
imental information and described a new formalism for the solution of the
phase problem.
Anomalous dispersion effects may, in magnitude, be of the same size as the
measurement errors. To minimize the noise, particularly that caused by crystal
decay, for each unique reﬂection all measurements at different wavelengths are
taken from the same asymmetric region of the reciprocal space. Furthermore,
the anomalous differences of Friedel related pairs are collected in short tem-
poral intervals. To reduce the speed of crystal decay, modern cryopreservation
techniques are used. Thus, with the synchrotron, exposure of the crystals to
X-ray doses up to 1000 times larger than with laboratory sources is pos-
sible. By the laws of statistics, this makes it possible to measure signals up
to 30 times smaller, with, in general, a corresponding increase in the preci-
sion of all measurements. However, long irradiation of protein crystals must
be avoided; this may lead to disruption of disulﬁde bridges, decarboxyla-
tion of acidic groups, and changes in the unit cell parameters (Ravelli et al.,
2002).
Not all of the collected reﬂections are equally useful for phasing (see
Section 15.7). For example, if one calculates, for a given wavelength,
the internal residual factor, Rint, over symmetry-related reﬂections (see
Section 2.6), where
Rint =
 ||Fobsh| −⟨|Fobsh|⟩|
 |Fobsh|
,
and
⟨|Fobs|⟩=

h wh |Fobsh|
 wh
,
Rint usually increases with the diffraction angle because of the rapid f0 fall-off,
even if the anomalous signal is constant with it. This is the reason why MAD
data, at the resolution limit of the crystal, are rarely useful.
It is now apparent that SAD techniques are gaining wider applicability, in
particular sulphur single wavelength anomalous dispersion (S-SAD). Its appeal
derives from the following observation: the average frequency of sulphur-
containing amino acids is about 3.3, for 100 amino acids, and a technique
exploiting this natural source of phasing information may reduce experimental
effort. The method has been pioneered by Hendrickson and Teeter (1981),
who demonstrated that even the small anomalous S signal could lead to
solution of a small protein (crambin), with 46 residues and six sulphurs in
disulﬁde bridges. Some later papers (e.g. by Wang, 1985; Weiss et al., 2001;
Dauter et al., 2002; Ramagopal et al., 2003) demonstrated that SAD may also

344
Anomalous dispersion techniques
Table 15.1 Anomalous scattering of P, S, and Cl at different wavelengths (W)
W (Å)
P
S
Cl
|f ′|; f ′′
|f ′|; f ′′
|f ′|; f ′′
2.29 (Cr Kα)
0.377; 0.899
0.375; 1.141
0.333; 1.423
1.74
0.318; 0.544
0.349; 0.697
0.368; 0.876
1.54 (Cu Kα)
0.282; 0.433
0.317; 0.556
0.345; 0.701
1.28 (Au Lα)
0.228; 0.304
0.261; 0.393
0.294; 0.498
0.71 (Mo Kα)
0.082; 0.094
0.102; 0.124
0.122; 0.159
succeed for P and Cl (naturally present in several macromolecular families),
by choosing wavelengths far above their K-edge energies.
To understand limits and advantages of the technique, we show in
Table 15.1, the values of |f ′| and f ′′ for P, S, and Cl at speciﬁc wavelengths far
away from their absorption edges. The anomalous signal is less than 1 electron
unit at wavelengths shorter than 2 Å, with ratio < |ano|> / < |F|> of a few
per cent; therefore, the errors in estimation of intensities should not exceed 2%.
This implies very accurate diffraction data, not available until recent decades,
and only obtainable via well-conducted experiments and large data redundancy
(i.e. multiple measurements of the same reﬂection intensity, averaged to reduce
the error). Therefore a compromise has to be made between data redundancy,
resolution limit, and crystal exposure.
The reader should not believe that successful anomalous effects are only
possible when synchrotron data are used. Indeed, SAD data with S atoms as
anomalous scatterers, collected in-house using current data collection meth-
ods, may also succeed; highly redundant data are often necessary, as well as the
use of techniques to minimize the effects of radiation damage and absorption.
The anomalous signal may be collected at the Cu Kα wavelength (Yang and
Pﬂugrath, 2001; Nagem et al., 2005), or also at a chromium radiation source
(λ = 2.29 Å; Yang et al., 2003; Nan et al., 2009). This last choice is sug-
gested by the fact that f ′′ = 1.14 e−when Cr Kα radiation is used, about
double as compared with that for Cu Kα radiation. It may also be mentioned
that an increased f ′′ value is obtained for many other elements intrinsic to
macromolecules, such as calcium, zinc, and phosphorus.
15.4
Phasing via SAD techniques: the algebraic
approach
Let us suppose that the diffraction data of a protein have been collected, and
that some efﬁcient anomalous scatterers are present naturally; their number is
usually a small fraction of NP. At the initial step of the phasing process, |F +|
and |F−| are known from the diffraction experiment, while |F′| and |F′′| are
unknown; no estimate can be made on the values of φ+ and φ−without some
additional information.
F+
–F²+
F²+
F–
J
I
O
real axis
imag. axis
Fig. 15.7
Harker diagram illustrating phase determ-
ination via SAD techniques. Circles of
radii |F+| and |F−| are drawn, with
centres at F′′+ and F′′−. The two points
of intersection, I and J, indicate two pos-
sible vectors for F ′, say OI and OJ.
We will show that if the anomalous scatterer substructure has been solved
(then |F′′| and φ′′+ are known), estimating φ+ and φ−is possible. In Fig. 15.7,
two circles are drawn in the Argand plane, one centred at the tip of the

Phasing via SAD techniques: the algebraic approach
345
vector −F′′+ with radius |F+|, and the second centred on the tip of F′′+, with
radius |F−∗| ≡|F−| (in the ﬁgure the amplitudes of |F′′+| and |F′′−| have been
magniﬁed to make the drawing more clear). Because of equation (15.2),
F+ −F′′+ = F′+
and, because of equation (15.5),
F−∗+ F′′+ = ( F−∗
0
+ F′−∗+ F′′−∗) + F′′+ = ( F−∗
0
+ F′−∗) = F′−∗= F′+,
Consequently, the two circles meet at two points, I and J in the ﬁgure, symmet-
rically disposed about F′, which are the only ones compatible with the modulus
|F′|: accordingly, φ′+ may only take two values. Since we have assumed that
the number of anomalous scatterers is usually a small fraction of NP, F′ may be
considered to be a good approximation, in modulus and phase, of the protein
structure factor. Therefore, we can also state that the protein phase φ+
0 may
only assume two values.
The above result suggests the following two-step phasing procedure:
Step 1 Solve the anomalous scatterer substructure;
Step 2 Use the information gained at Step 1 to solve the phase ambiguity
present in Fig. 15.7 and obtain the target phases.
But how do we solve the anomalous scatterer substructure? What is needed is a
sufﬁciently good estimate of |F′′|. Having achieved that, one of two approaches
may then be used to accomplish Step 1: calculate a Patterson synthesis (to be
deconvoluted in accordance with the techniques described in Chapter 10), or
submit the estimated |F′′| values to traditional direct methods, charge ﬂipping,
or VLD techniques, according to personal preference (see Chapters 6, 9, and
10).
Blow (1957) and Rossmann (1961) suggested the so-called anomalous-
difference Patterson synthesis,
Pano(u) = 1
V

|ano|2 exp(−2πi h · u),
(15.9)
where
|ano| = ||F+| −|F−||,
(15.10)
is the required estimate of |F ′′|. To check the conditions under which the
approximation |ano| ≈|F′′| holds, we return to Fig. 15.1b, which suggests
the relation,
4|F′′|2 = |F+|2 + |F−|2 −2|F+F−| cos(φ+ −φ−∗).
(15.11)
(φ+ −φ−∗) represents the angle between F+ and F−∗. Since (φ+ −φ−∗) is
expected to be small, equation (15.11) reduces to
4|F′′|2 ≈(|F+| −|F−|)2 = |ano|2,
(15.12)
from which |ano| ≈2|F′′| .
Equation (15.9) is therefore a Patterson synthesis, approximately equi-
valent to that having coefﬁcients |F′′|2 and would reveal the positions of

346
Anomalous dispersion techniques
anomalous scatterers via peak height, proportional to f ′′ (Strahs and Kraut,
1968; Hendrickson and Teeter, 1981). Mukherjee et al. (1989) proved that the
anomalous scatter positions could really be found by submitting |ano| to tra-
ditional direct methods, in spite of the lack of anomalous differences in the
centric data.
Once the anomalous scattering substructure is solved, Step 2 may be started.
Since the anomalous contribution to the structure factor of a protein is small
compared with the non-anomalous part, the following approximation holds
(see Fig. 15.1b):
|F+| + |F−| ≈2|F′|.
(15.13)
Introducing (15.13) into (15.7) provides,
cos(φ′′+ −φ′+) = (|F+| + |F−|)(|F+| −|F−|)
4|F′F′′|
≈ano
2|F′′|,
(15.14)
from which,
φ′+ ≈φ′′+ ± cos−1
	 ano
2|F′′|

.
(15.15)
Since the anomalous scattering is usually much smaller than normal scattering,
relationship (15.15) reduces to,
φ0 ≈φ′′ ± cos−1
	 ano
2|F′′|

.
(15.16)
Let us rewrite (15.16) in a different form. Since F′+ and F′′ are approx-
imately perpendicular (they are rigorously perpendicular if the anomalous
scatterers are all of the same atomic species), then,
φ′′+ = φ′+
 + π/2,
where φ′+
 is the phase of F′+. Accordingly, (15.16) may be rewritten as
φ0 = φ′ + π/2 ± cos−1
	 ano
2|F′′|

,
(15.17)
which allows φ0 to be estimated from the normal scattering part of the
anomalous scattering atoms.
Neither (15.16) nor (15.17) ﬁx φ0 unambiguously; two values are allowed
which, according to (15.16), are symmetrically disposed around φ′′, and often
far away from each other. So far it is unclear which of the two values should
be preferred. However, if |ano| is sufﬁciently large (see Fig. 15.8), then it is
expected to be close to 2|F′′|, and the allowed φ′+ values deﬁned by equation
(15.15) are expected to be very close to each other; taking the average of the
two values may not incur a huge error. The reason for the above expectation is
quite simple: the scattering power of the substructure is very small with respect
to that of the full structure. Thus, if |ano| is large, cos(φ′′ −φ′+) must be close
to unity (see equation (15.14)). Accordingly,
F²–*
F²*
Dano
F–*
F+
imaginary axis
real axis
Fig. 15.8
Relation between ano and F′′. If |ano|
is sufﬁciently large, it is expected to be
close to 2|F′′|.
φ ≈φ′′ if ano > 0 and sufﬁciently large.
φ ≈φ′′ + π if ano < 0 and sufﬁciently large in modulus.
Some observations now about phase ambiguities in the SAD case.

The SIRAS algebraic bases
347
A source of ambiguity arises from the fact that two values are allowed for the
protein phases when the anomalous scatterer substructure has been determined.
Taking their average certainly introduces noise into the corresponding electron
density map.
A next source of ambiguity is that the anomalous scatterer substruc-
ture determined at the end of Step 1 does not necessarily have the correct
handedness: there is only a 50% chance of having determined the correct
enantiomorph.
Let us now imagine that the anomalous scatterer substructure has the wrong
handedness. Assigning the protein phases produces an electron density map
with poor contrast and low connectivity. No interpretation of the map is pos-
sible, and any improvement of the map via EDM techniques is without hope.
Conversely, the map obtained by using the correct handedness of the substruc-
ture is much better: solvent channels are distinguishable, connectivity is larger,
and contrast between solvent and protein is high. EDM techniques may lead
easily to a ﬁnal interpretable electron density map.
In conclusion, if it is not possible to deﬁne the correct handedness of the
anomalous scatterer substructure by some ﬁgure of merit, the two hands should
be used one after the other; which is the correct hand should be decided on the
basis of the quality of the resulting ﬁnal map.
A speciﬁc phasing difﬁculty is met when the anomalous scatterer distri-
bution is centrosymmetric (in P1, two identical anomalous scatterers always
simulate a centrosymmetric substructure). In this case, the EDM procedure will
succeed only if the centrosymmetric nature of the phases is broken. This pro-
cess may be monitored by a special Fourier synthesis (called the FF synthesis)
described by Burla et al. (2006b).
real axis
real axis
a)
imag. axis
F d
+
F ²+
ϕd
Fd ¢–
F p
–
FH¢–
FH²–
F d
–
Fp +
F d¢+
FH¢+
π/2
b)
imag. axis
FH¢+ = FH¢– *
F p
+ = Fp – *
Fd +
FH²–*
FH²+
Fd –*
Fd¢+ = Fd¢– *
Fig. 15.9
SIRAS case: (a) Relations among the
vectors, F+
d , F−
d , F+
p , F−
p , F′+
H , F′−
H , F′′+
H ,
F′′−
H , F+
H , F−
H ; (b) Relations between F+
d ,
F−∗
d
, F+
p , F−∗
p
, F′+
H , F′−∗
H
, F′′∗
H , F′′−∗
H
,
F+
H , F−∗
H .
15.5
The SIRAS algebraic bases
Let us suppose that the native protein does not contain sufﬁciently good
anomalous scatterers: a SAD experiment would then be discouraged. Since
the anomalous scattering phenomenon is relevant for most of the heavy
atoms, a heavy-atom derivative may be used to produce detectable anomalous
effects (SIRAS case). Two sets of data are then available: the native protein
data and the derivative data, the latter with detectable anomalous diffraction
effects.
We will subdivide this section into two parts: the ﬁrst dedicated to estab-
lish the SIRAS algebraic bases, and the second to describe a typical algebraic
phasing procedure.
The SIRAS algebraic bases. Derivative and native protein data are related by
the following equations (see Fig. 15.9a):
F+
d = F+
P + F+
H , F−
d = F−
P + F−
H ,
(15.18)
where F+
d and F−
d are the derivative structure factors for h and –h, respectively,
FP =
NP
j=1 f0j exp(2πih · rj) = |FP| exp(iφP),

348
Anomalous dispersion techniques
and
F+
H = F′+
H + F′′+
H
= |F+
H | exp

iφ+
H

,
F−
H = F′−
H + F′′−
H
= |F−
H | exp

iφ−
H

,
are the structure factors of the heavy-atom substructure. Let NP be the num-
ber of non-H atoms in the native protein unit cell; Nd = NP + NH will be the
number of non-H atoms in the derivative unit cell, and NH the correspond-
ing number of heavy atoms. F′+
H and F′′+
H
are the heavy-atom structure factor
components, deﬁned by
F′+
H =
NH
j=1 f ′j exp

2πih · rj

= |F′+
H | exp

iφ′+
H

,
F′−
H =
NH
j=1 f ′j exp

−2πih · rj

= |F′−
H | exp

iφ′−
H

F′′+
H = i
NH
j=1 f ′′j exp

2πih · rj

=
NH
j=1 f ′′j exp

i

2πh · rj + π/2

= |F′′+
H | exp

iφ′′+
H

,
F′′−
H = i
NH
j=1 f ′′j exp

−2πih · rj

=
NH
j=1 f ′′j exp

i

−2πh · rj + π/2

= |F′′−
H | exp

iφ′′−
H

.
We may factorize equations (15.18) in a different way,
F+
d = F′+
d
+ F′′+
H , F−
d = F′−
d
+ F′′−
H ,
where
F
′+
d
= F+
P + F′+
H , F′−
d = F−
P + F′−
H
(15.19)
F′+
d
and F′−
d
are not affected by anomalous dispersion effects, and therefore
are related by the Friedel law (see Fig. 15.10a and Fig .15.9b); say,
|F′+
d | = |F′−
d |, φ′−
d
= −φ′+
d .
b)
a)
φd¢ + = φd¢ –* = –φd¢–
φd¢ – = φd¢ +* = –φd¢+
φH¢+ = φH¢ –*
φH¢ – = φH¢+*
c)
φH²–
φH²+
φH²+*= –φH²+
φH²–*= –φH²–
Fig. 15.10
SIRAS case: (a) Phase relationships
among φ′+
d , φ′−
d , φ′+∗
d
, φ′−∗
d
; (b) phase
relationships
between
φ′+
H , φ′−
H , φ′+∗
H ,
φ′−∗
H ; (c) phase relationships among
φ′′+
H , φ′′−
H , φ′′+∗
H
, φ′′−∗
H
.
In Fig. 15.10, the stars indicate the phases of the complex conjugate structure
factors.
The Friedel law also holds for F′+
H and F′−
H ; indeed, |F′+
H | = |F′−
H | and (see
Fig. 15.9b and Fig. 15.10b):
φ′−
H = −φ′+
H , φ′−∗
H
= φ′+
H .
The Friedel law is violated for the pair F′′+
H
and F′′−
H . Indeed, |F′′+
H | = |F′′−
H |,
but (see Fig. 15.9b and Fig.15.10c),
φ′′−
H
= π −φ′′−
H
= −φ′′−∗
H
φ′′+∗
H
= −φ′′+
H , φ′′−∗
H
= −φ′′−
H .
The reader may notice that, while φ′+
d
and φ′−
d , as well as φ′+
H and φ′−
H , are
symmetrical with respect to the zero angle, φ′′+
H and φ′′−
H are symmetrical with
respect to π/2.

The SIRAS algebraic bases
349
From (15.19), the following relations hold:
|F+
d |2 = |F′+
d |2 + |F′′+
H |2 + 2|F′+
d F′′+
H | cos

φ′+
d −φ′′+
H

.
(15.20a)
|F−
d |2 = |F′−
d |2 + |F′′−
H |2 + 2|F′−
d F′′−
H | cos

φ′−
d −φ′′−
H

.
(15.20b)
Equations (15.20) may be rewritten as
|F+
d |2 = |F′+
d |2 + |F′′+
H |2 + 2|F′+
d F′′+
H | cos

φ′+
d
−φ′′+
H

.
(15.21a)
|F−
d |2 = |F′−
d |2 + |F′′−
H |2 −2|F′−
d F′′−
H | cos

φ′+
d
−φ′′+
H

.
(15.21b)
For simplicity, from now on, we will denote the moduli |F′+
d | and |F′−
d | by |F′d|
and the moduli |F′′+
H | and |F′′−
H | by |F′′H|. From equations (15.21), the relations
I = |F+
d |2 −|F−
d |2 = (|F+
d | + |F−
d |)ano = 4|F′dF′′H| cos(φ′′+
H −φ′+
d ).
(15.22)
and
|F+
d |2 + |F−
d |2
2
= |F′d|2 + |F′′H|2.
(15.23)
arise. Equations (15.22) and (15.23) may be usefully compared with equations
(15.7) and (15.8), obtained for the SAD case.
The reader will certainly have understood that violation of the Friedel law
is just the source of information necessary to solve a structure. Indeed, the
anomalous difference, |F+
d |2 −|F−
d |2 depends on the heavy-atom substructure
and conversely, the anomalous substructure may, in principle, be derived from
the anomalous differences.
The typical algebraic SIRAS phasing procedure. At the initial phasing step,
|F+
P |, |F+
d |, |F−
d | are known from the diffraction experiment, while F+
H and F−
H
are unknown; no estimate can be made on the values of φP. We will show that,
if the heavy-atom substructure has been identiﬁed (then F+
H and its components
F′+
H and F′′+
H
are known), estimating φP is possible. In Fig. 15.11, two circles
are drawn in the Argand plane, one centred at the tip of the vector, −F
′+
H −
FH′′+ and the second centred at the tip of the vector, −F′+
H −F′′+
H ; the ﬁrst
circle has radius |F+
d | and the second, |F−∗
d | = |F−
d |.
The generic point of the ﬁrst circle is the tip of the vector,
−F′+
H −F′′+
H
+ F+
d = −F+
H + F+
d = F+
P .
The generic point of the second circle is the tip of the vector,
−F′+
H + F′′+
H + F−∗
d
= −F′−∗
H
−F′′−∗
H
+ F−∗
d
= ( F−
d −F−
H )∗= F−∗
P .
Consequently, the two circles meet at two points, R and S in the ﬁgure, which
are the only ones compatible with the modulus |FP|; accordingly, φ+
P may only
take two values.
In the SIRAS case, however, the protein amplitude |Fp| is also available
experimentally. Thus, a third circle, centred at O with radius |FP|, may be
added to the two drawn in Fig. 15.11. As a result (see Fig. 15.12), only one
point is compatible with the experimental data, in our case, point R; the phase
ambiguity noticed for the SAD case is cancelled if SIRAS data are available.

350
Anomalous dispersion techniques
R
S
O
Q
real axis
imag. axis
–FH¢+
–FH²+
FH²+
Fd
–
Fd
+
Fig. 15.11
Harker diagram illustrating phase determ-
ination in the SIRAS case. Circles of
radii |F+
d | and |F−
d | are drawn, with their
centres at the tips of the vectors −F′+
H −
F′′+
H
and −F′+
H + F′′+
H , respectively. The
two intersection points, R and S, indicate
two possible vectors for |Fp|, say OR and
OS.
O
R
Fp
S
Q
real axis
imag. axis
–FH¢+
–FH²+
FH²+
Fd
–
Fd
+
Fig. 15.12
Harker diagram illustrating phase determ-
ination in the SIRAS case. To the circles
shown in Fig. 15.11, a third circle may be
added, centred on O and radius |Fp|. R is
the unique solution.
The ﬁrst important conclusion of this section may now be stated: know-
ing the anomalous scatterer substructure, and therefore knowing F′′H, allows
us to deﬁne the protein phases. This suggests the following two-step phasing
procedure:
Step 1 Solve the anomalous scatterer substructure;
Step 2 Use the information gained at Step 1 to estimate the protein phases.
But how do we solve the anomalous scatterer substructure? The ab initio
methods described in Chapters 6, 9, and10 indicate that the only necessary
prior information is knowledge of the modulus |F′′|. Unfortunately, |F′′| is
not available experimentally, but can only be estimated statistically. A relevant
difference between SIR (or SAD) and SIRAS is that, in the case of SIRAS, sim-
ultaneous knowledge of anomalous differences and isomorphous differences is

The SIRAS algebraic bases
351
available experimentally. Let us see how these may be combined to provide a
better estimate of |F′′H|.
Since (see Fig. 15.9b),
|F+
d | + |F−
d | ≈2|F′d|, φ′′+
H
≈φ′+
H + π/2,
(15.24)
replacing (15.24) into (15.22) gives,
+
ano ≈2|F′H| sin(φ′+
d −φ′+
H ).
(15.25)
Let us now ﬁnd a useful expression for iso in the SIRAS case, where two
different values of iso exist, say +
iso = |F+
d | −|FP| and −
iso = |F−
d | −|FP|.
In the SIR case (in the absence of anomalous dispersion), the following relation
was found (see equation (14.4)):
iso ≈|FH| cos(φd −φH).
The above equation may be transformed, so as to be valid for the SIRAS case,
into
+
iso ≈|F′H| cos(φ′+
d −φ′+
H ).
(15.26)
Taken in isolation, equations (15.25) and (15.26) are of no use for Step 1
(because φ′+
d
and φ′+
H , are still unknown) but, if combined, they provide a
useful estimate of |F′
H|. Indeed,
|+
iso|2 + 1
4|ano|2 ≈|F′
H|2 
cos2 
φ′+
d −φ
′+
H

+ sin2 
φ′+
d −φ′+
H

= |F′
H|2.
(15.27)
It is then clear that, within the framework of the approximations made, the
coefﬁcients (15.27), no matter whether used for calculating a Patterson map or
being processed by direct methods, will provide heavy-atom positions with less
noise than maps obtained from separated coefﬁcients |+
iso| or |ano| (Kartha
and Parthasarathy, 1965).
It is worthwhile stressing that |+
iso| will in general be larger than ano,
and that +
iso is usually affected by lack of isomorphism. A suitable weighting
function should then be introduced into (15.27).
Once the anomalous scattering substructure is solved, Step 2 may be star-
ted. In the SIRAS case, we can combine the phase indication suggested by
isomorphous difference with that provided by the anomalous difference. For
example, we can rewrite equation (15.22) as
cos

φ′′+
H
−φ′+
d

≈ano
2|F′′|.
(15.28)
or also as
φ′+
d ≈φ′′+
H ± cos−1
	 ano
2|F′′|

≈φ′+
H + π/2 ± cos−1
	 ano
2|F′′|

.
(15.29)
Equation (15.29) exploits the information contained in the anomalous differ-
ences. From the isomorphous derivative method, the following indication may
be obtained (see equation (14.3)):
φd ≈φH ± cos−1
	|Fd|2 −|FP|2 + |FH|2
2|FdFH|

.
(15.30)

352
Anomalous dispersion techniques
Since φd and φ′d may be considered to be very close, equations (15.29) and
(15.30) may provide a unique value of φd.
Once φd has been estimated, the protein phase may be obtained by subtract-
ing FH from Fd. Then,
tan φP = |Fd| sin φd−|FH| sin φH
|Fd| cos φd−|FH| cos φH
.
(15.31)
The above mathematical approach does not take into account the lack of iso-
morphism, errors in measurement of |F+
d |, |F−
d |, and |FP|, and errors arising
from the model heavy-atom substructure. In practice, (15.31) is not strictly
valid. To understand, graphically, the effects of the above factors, it may eas-
ily be argued that, in practical applications, the radii and the centres of the
three circles in Fig. 15.11 do not usually coincide with the correct values and
the three circles do not necessarily intersect at one point. Suitable weighting
schemes are usually applied to reduce the effect of errors.
15.6
The MAD algebraic bases
Let us suppose that a n-wavelength experiment has been carried out provid-
ing the measured amplitudes of n pairs |F+
j |, |F−
j | for j = 1, . . . . , n. Once
the anomalous scatterer substructure has been identiﬁed, algebraic MAD tech-
niques may be applied to solve the phase problem. A successful approach was
suggested by Ramakrishnan and Biou (1997) and by Terwilliger (1997): the
MAD case is treated as a MIR case.
We will see in this section that, by using a mathematical formalism which
separates the normal from the anomalous scattering, the phase problem may be
reduced to the solution of a linear system of equations. The idea was ﬁrst intro-
duced by Mitchell (1957), and then used by Corby and Black (1973) and by
Black and Corby (1975) to solve two small structures. Karle (1980; 1983a,b;
1984a,b; 1989a,b; see also Chapuis et al., 1985) gave a more general mathem-
atical treatment, valid even for the case in which different types of anomalous
scatterers are present. Let us follow the Karle approach for the simplest case
in which there is only one kind of anomalous scatterer in the unit cell.
For a generic wavelength, in accordance with equation (15.2),
F+ = F+
0 + F′+ + F′′+ = F+
0 + F+
a , F−= F−
0 + F−
a ,
(15.32)
where, F+
a = F′+ + F′′+ and F−
a = F′−+ F′′−are the structure factors
of the anomalous scatterer substructure, calculated from anomalous scatter-
ing only. The reader should notice that, in accordance with equation (15.2),
F+
0 and F−
0 also contain the normal scattering contribution (say F+
0a and F−
0a,
respectively) of the anomalous scatterers, where
F+
0a = f0
Na

j=1
exp

2πih · rj

= |F+
0a| exp

iφ+
0a

,
F−
0a = f0
Na

j=1
exp

−2πih · rj

= |F−
0a| exp

iφ−
0a

.

The MAD algebraic bases
353
Then,
F+
a =

f ′ + if ′′ Na

j=1
exp

2πih · rj

= f ′ + if ′′
f0a
F+
0a = γ (exp iδ)F+
0a = γ |F+
0a| exp

i(φ+
0a + δ)

,
(15.33a)
where
γ =

f ′2 + f ′′21/2
f0a
, δ = tan−1 
f ′′/f ′
.
Analogously, the following equation may be derived:
F−
a = γ |F−
0a| exp

i

φ−
0a + δ

,
(15.33b)
Let us now introduce (15.33a) into the ﬁrst of the equations (15.32), and
(15.33b) into the second equation (15.32), and then multiply the resulting
formulas by their complex conjugates. Two equations are obtained,
|F+|2 = |F+
0 |2 + γ 2|F+
0a|2 + 2γ |F+
0 F+
0a| cos

φ+
0 −φ+
0a −δ

(15.34a)
and
|F−|2 = |F−
0 |2 + γ 2|F−
0a|2 + 2γ |F−
0 F−
0a| cos

φ−
0 −φ−
0a −δ

.
(15.34b)
Since
f ′
f0a
= γ cosδ,
f ′′
f0a
= γ sin δ,
equations (15.34) may be rewritten as
|F+|2 = |F+
0 |2 + γ 2|F+
0a|2 + 2|F+
0 F+
0a|
f ′
f0a
cos

φ+
0 −φ+
0a

+ f ′′
f0a
sin

φ+
0 −φ+
0a

(15.35a)
and
|F−|2 = |F−
0 |2 + γ 2|F−
0a|2 + 2|F−
0 F−
0a|
f ′
f0a
cos

φ−
0 −φ−
0a

+ f ′′
f0a
sin

φ−
0 −φ−
0a

(15.35b)
In accordance with the deﬁnitions,
|F+
0 | = |F−
0 |, |F+
0a| = |F−
0a|,

φ−
0 = −φ+
0 , φ−
0a = −φ+
0a

.
If we denote the ﬁrst two moduli by |F0|, the second two by |F0a|, and the
phases φ+
0 and φ+
0a by φ0 and φ0a, respectively, the two equations (15.35) may
be rewritten in a more useful and simple form:
|F+|2 = |F0|2 + γ 2|F0a|2 + 2|F0F0a|
f ′
f0a
cos

φ0 −φ0a

+ f ′′
f0a
sin

φ0 −φ0a

(15.36a)

354
Anomalous dispersion techniques
|F−|2 = |F0|2 + γ 2|F0a|2 + 2|F0F0a|
f ′
f0a
cos

φ0 −φ0a

−f ′′
f0a
sin

φ0 −φ0a

(15.36b)
Let us examine the main feature of the above equation for each wavelength:
(i) |F+|2 and |F−|2 are known from the diffraction experiment for each
wavelength;
(ii)
f′
f0a and f ′′
f0a are functions of λ, but may be derived experimentally through
a study of the absorption coefﬁcient.
(iii) The unknown quantities are |F0|, |F0a| and (φ0 −φ0a); all of them are
independent of λ.
It may be concluded that a SAD experiment provides two equations of type
(15.36), with three unknowns; a two-wavelength experiment provides four
equations with three unknowns, and is therefore sufﬁcient for estimating the
values of |F0|, |F0a|, and (φ0 −φ0a). The three unknowns are overdetermined
for a three or more wavelength experiment. The above approach has been used
in the MADSYS package (Wu and Hendrickson, 1996).
The SAD phase ambiguity (see Section 15.4) is not present in MAD, but
the handedness ambiguity of the anomalous scatter substructure remains. Both
of the substructure enantiomorphs should be submitted to phase assignment
and reﬁnement via EDM techniques if, via suitable ﬁgures of merit, the cor-
rect handedness of the anomalous scatterer substructure has not been clearly
determined.
15.7
The probabilistic approach
for the SAD-MAD case
The probabilistic approach is more suitable than algebraic techniques to face
the challenges connected with errors in experimental data and in the model.
For simplicity, we will not enter into mathematical details, but we will only
describe the logical steps necessary to ﬁnd conclusive formulas, and we will
discuss their main characteristics. As in the preceding paragraphs, the two-step
phasing procedure (i.e. ﬁrst ﬁnd the anomalous substructure (Step 1), and then
phase the protein given the substructure (Step 2)) will be described.
A one-step procedure is also possible for the SAD case. This was ﬁrst sug-
gested by Kroon et al. (1977), Heinerman et al. (1978), and Karle (1984a,b).
The most general approach has been described by Hauptman (1982b) and
independently by Giacovazzo (1983b), via the study of the joint probability
distribution function,
P(Eh, Ek, Eh+k, E−h, E−k, E−h−k),
but is not competitive with the two-step approach (Giacovazzo et al., 2003),
and will not be reported.
Before describing the two-step approach, some preliminary considerations
are necessary in order to answer a basic question: are the experimental data

The probabilistic approach for the SAD-MAD case
355
collected at the various wavelengths equally useful for solving the phase prob-
lem, or the data quality changes with the wavelength and with the diffraction
angle?
About the experimental data selection. In a MAD experiment, each
wavelength is characterized by speciﬁc values of f ′ and f ′′, by speciﬁc
absorption values, and by proper measurement errors; therefore, the various
wavelengths are not expected to be equally informative. The phasing efﬁ-
ciency should improve if each wavelength is suitably weighted or if the worst
ones are eliminated from the calculations. A criterion is therefore necessary
to predict the most informative wavelength combinations, otherwise all of the
combinations should be explored in order to identify the correct solution. Thus,
if n = 4, one should explore four one-wavelength, six two-wavelength, four
three-wavelength, and one four-wavelength combination, and, at the end of the
calculations, rely on a suitable ﬁgure of merit in order to identify the correct
solution.
Schneider and Sheldrick (2002) made a basic assumption: good experi-
mental multi-wavelength data should show high correlation values between
the various ano values. Thus, if the data collected at a given wavelength are
badly correlated with the other experimental data, that wavelength should be
eliminated or underweighted.
The quality of the information provided by a multi-wavelength experiment
varies with the resolution; usually, high resolution diffraction data should be
eliminated from the calculation (this is also true for a SAD experiment). Thus,
a good algorithm should not only be able to identify the best wavelength
combination, but also to ﬁx a threshold for data resolution, in order to elim-
inate the experimental data with weakly correlated ano. A very efﬁcient
automatic algorithm for limiting the data resolution and for predicting the
most informative wavelength combination has been proposed by Burla et al.
(2004).
Step 1 In any probabilistic approach, the ﬁrst item is to deﬁne the primit-
ive random variables; we choose the atomic positions as the primitive random
variables, while the indices are kept ﬁxed. The structure factors are deﬁned
according to
F+
j = F+
aj + F+
naj + |μ+
j | exp

iθ+
j

F−
j = F−
aj + F−
naj + |μ−
j | exp

iθ−
j

,
where F+
j and F−
j are the values of Fh and F−h for the j th wavelength, F+
aj and
F−
aj, the corresponding structure factors for the anomalous scatterer substruc-
ture, F+
naj and F−
naj, the corresponding structure factors for the non-anomalous
scatterer substructure. μ+
j
and μ−
j
are parameters which take into account
measurement and model errors; they are unknown and are treated as additional
primitive random variables.
To accomplish Step 1, we need to previously estimate |F0a|, say the amp-
litude for normal scattering of the anomalous scatterer substructure, given
the amplitudes measured in the n-wavelength MAD experiment. If the joint
probability distribution approach (see Chapter 4) is used, the steps are the
following:

356
Anomalous dispersion techniques
1. Calculate the 4n + 2 -dimensional joint probability distribution,
Pn = P

E0a, E+
1 , E+
2 , . . . , E+
n , E−
1 , E−
2 , . . . , E−
n

= P

A0a, A+
1 , A+
2 , . . . , A+
n , A−
1 , A−
2 , . . . , A−
n , B0a, B+
1 , B+
2 , . . . , B+
n , B−
1 , B−
2 , . . . , B−
n

,
(15.37)
where E = A + iB is the generic normalized structure factor, normalized
with respect to the scattering power of the non-anomalous substructure (i.e.
E = F
 Nna
i=1 f 2
i
1/2
, where Nna is the number of non-H atoms in the non-
anomalous scatterer substructure).
2. Express (15.37) in terms of polar coordinates:
Pn = P

R0a, R+
1 , R+
2 , . . . , R+
n , R−
1 , R−
2 , . . . , R−
n , φ0a, φ+
1 , φ+
2 , . . . , φ+
n , φ−
1 , φ−
2 , . . . , φ−
n

(15.38)
via the change of variables,
A0a = R0a cos φ0a,
B0a = R0a sin φ0a
A+
j = R+
j cos φ+
j ,
B+
j = R+
j sin φ+
j
A−
j = R−
j cos φ−
j ,
B−
j = R−
j sin φ−
j .
3. Integrate (15.38) over the phase variables to obtain the marginal
distribution,
P

R0a, R+
1 , R+
2 , . . . , R+
n , R−
1 , R−
2 , . . . , R−
n

.
4. Calculate the conditional distribution,
P

R0a|R+
1 , R+
2 , . . . , R+
n , R−
1 , R−
2 , . . . , R−
n

.
(15.39)
5. Calculate the expected conditional value,
< R0a|R+
1 , R+
2 , . . . , R+
n , R−
1 , R−
2 , . . . , R−
n > .
(15.40)
The results are as follows (Burla et al., 2002, 2003): P(R0a| . . . . . .) is a
Gaussian probability distribution which may be written in the form,
P(R0a| . . . . . .) = π−(2n+1)(det K)1/2 exp
	
−1
2
¯TK
−1T

,
where K =

kij } is a symmetric square matrix of order (4n + 2) taking into
account the variances of and the covariances among the (4n + 2) variables,
K−1 =

λij } is its inverse, and T is a suitable vector with components deﬁned
in terms of the (4n + 2) variables.
< R0a|R+
1 , . . . , R−
n > = 1
2 (π/λ11)1/2 
1 + 4X2/(πλ11)
1/2 ,
(15.41)
where
X2 = Q2
1 + Q2
2
Q1 = λ12R+
1 + λ13R+
2 + · · · · +λ1,n+1R+
n + λ1,n+2R−
1 + · · · + λ1,2n+1R−
n
Q2 = λ1,2n+3R+
1 + λ1,2n+4R+
2 + · · · · · + λ1,3n+2R+
n + · · · −λ1,3n+3R−
1 −· · · −λ1,4n+2R−
n .

The probabilistic approach for the SAD-MAD case
357
The standard deviation of the estimate is
σR0a =

< R2
0a| . . .> −< R0a| . . .>21/2 =

1 −π
4

λ−1
11
1/2
,
(15.42)
from which,
< R0a| . . .>
σR0a
=
[(π/4) + (X2)/λ11]
1 −(π/4)
1/2
.
(15.43)
We will not provide mathematical expressions for all of the various para-
meters in equation (15.41), but the reader is referred to the original papers.
We are more interested to describe why the probabilistic approach makes the
procedure more robust.
The success of Step 1 depends on how accurately the < R0a| . . .> estimates
approximate the true values; the advantage of probabilistic methods is that they
provide the standard deviation of the estimate and therefore they may suggest
which estimates are more reliable. To clarify these aspects we will formulate
some questions and then answer them by applying the theory to experimental
data from three test proteins: AEPT (PDB code, 1m32), CYANASE (PDB code,
1dw9), and TGEV (PDB code, 1lvo), with three-wavelength data for all of the
three structures. Given below are the questions and the possible answers:
(a) Is the standard deviation (15.42) strictly correlated or anti-correlated with
the < R0a| . . .> value? To answer this question we show, in Fig. 15.13,
distribution (15.39) for selected pairs (X, λ11). The different location
of the maxima and the different sharpness of the curves suggest that
highest values of < R0a| . . .> are not necessarily correlated with the
sharpest distributions. In other words, the largest < R0a| . . .> values do
not necessarily correspond to the best estimates.
(b) Is the reliability of the estimate provided by (15.40) dependent on the value
< R0a| . . .>? We have calculated the parameter,
Rcryst =
 |(R0a)t −S < R0a| . . .>|
 (R0a)t
,
where (R0a)t is the true value of R0a, < R0a| . . .> is its estimate (15.41),
and S is a suitable scale factor. In Fig. 15.14, we show, for the three test
structures, the trend of Rcryst as a function of < R0a| . . .>. Quite wrong
estimates are frequent for small values of < R0a| . . .>; the best estimates
0
1
(a)
(b)
(c)
(d)
(e)
( f )
2
3
R0a
4
5
6
20
Fig. 15.13
The probability distribution P(R0a|R+
1 ,
R+
2 , . . . , R+
n , R−
1 , R−
2 , . . . , R−
n ), deﬁned by
equation (15.39) is plotted for some
selected pairs of (X, λ11). (a) (X, λ11) =
(7.5, 49.8); (b) (X, λ11) = (2043, 1136);
(c) (X, λ11) = (318.8, 101.4); (d) (X, λ11)
= (2488.9, 724.5) (e) (X, λ11) = (505.7,
110.3); (f) (X, λ11) = (63, 13.3).

358
Anomalous dispersion techniques
0
0.05
0.4
1.2
R0a
RA(%)
2
4
40
80
120
160
200
AEP
TGEV
cyanase
Fig. 15.14
The Rcryst value versus < R0a| . . .> for
the three test structures when, for each
structure, the experimental data from
three wavelengths are used simultan-
eously.
0
1.75
2.75
4
R0a/σ
RA(%)
8
30
20
40
60
80
100
AEP
TGEV
cyanase
Fig. 15.15
The Rcryst value versus < R0a| . . .> /
σR0a for the three test structures when,
for each structure, the experimental data
from three wavelengths are used simul-
taneously.
are attained for medium values of < R0a| . . .>, while a loss of accuracy
may be noted for the largest < R0a| . . .> values. This last behaviour, even
if it concerns a limited number of estimates, is not ideal for the applica-
tion of Patterson or direct methods, the success of which is based on the
accuracy of the largest structure factor moduli.
(c) May the ratio (15.43) be considered as a ratio signal to noise? In this case
smaller values of Rcryst should be obtained for subsets of reﬂections charac-
terized by large values of <R0a| . . .> /σR0a. This expectation is conﬁrmed
by Fig. 15.15, where Rcryst is plotted against < R0a| . . .> /σR0a. The reader
may usefully compare the relatively small values of Rcryst for the reﬂec-
tions with the largest values of < R0a| . . .> /σR0a in Fig. 15.14, with the
relatively high values of Rcryst for the reﬂections with the largest values of
< R0a| . . .> in Fig. 15.13.
In conclusion, the probabilistic approach allows us to estimate the accuracy of
each conditional average < R0a| . . .>. The reﬂections with the highest values
of < R0a| . . .> /σR0a are those which should be submitted to direct meth-
ods or to Patterson deconvolution procedures to ﬁnd the anomalous scatterer
substructure .
Step 2 Let us now suppose that the anomalous scatterer substructure has
been found. We want to phase the protein structure by using the substructure
as prior information. Any approach based on the theory of the joint probability

The probabilistic approach for the SAD-MAD case
359
distribution (e.g. McCoy et al., 2004; Pannu and Read, 2004; Giacovazzo and
Siliqi, 2004) should perform the following steps in sequence:
1. Calculate the conditional probability,
Pn = P

E+
1 , E+
2 , . . . , E+
n , E−
1 , E−
2 , . . . , E−
n |E+
a1, E+
a2, . . . , E+
an, E−
a1, E−
a2, . . . , E−
an

,
where Eaj is the generic structure factor of the anomalous scatterer substruc-
ture, normalized with respect to the scattering power of the non-anomalous
substructure. In formulas, Eaj = Faj/(
na )1/2, where 
na = Nna
i=1 f 2
i ,
and Nna is the number of non-H atoms in the non-anomalous scatterer
substructure. In Step 2 the Eajs are known in modulus and phase.
2. Calculate the marginal conditional distribution,
P

φ+
1 , . . . ., φ−
n |R+
1 , . . . , R+
n , R−
1 , . . . , R−
n , E+
a1, . . . , E+
an, E−
a1, . . . , E−
an

.
(15.44)
3. Simplify the calculations by introducing the following approximations (jus-
tiﬁed by the fact that the scattering power of the anomalous scatterer
substructure is small compared with the total protein scattering power):
φ+
1 ≈φ+
2 ≈φ+
n ≈−φ−
1 ≈−φ−
2 ≈. . . . ≈−φ−
n ,
Then, (15.44) reduces to
P

φ+
1 | . . . . . . . .

≈[2πI0(L)]−1 exp

L cos

φ+
1 −θ+
1

.
(15.45)
The most probable φ+
1 value is the phase of the vector (Giacovazzo and
Siliqi, 2004),
V =
n

j=1

w+
j E+
aj + w−
j E−∗
aj

+
n

j,p=1,p>j
wjp

E+
aj −E+
ap

+ wn+j,n+p

E−∗
aj −E−∗
ap

+
n

j,p=1
wj,n+p

E+
aj −E−∗
ap

(15.46)
and the reliability parameter L of the phase estimate is nothing else but its
modulus.
We do not provide the mathematical details deﬁning the various parameters
involved in distribution (15.45). We want to characterize the main features of
the distribution to make its advantages clear. The following may be noticed:
(a) The larger the number of wavelengths, the larger the number of terms in
the summations (15.46), and therefore the better (on average) will be the
reliability of the phase estimate. In conclusion, MAD is better than SAD
(provided that the data are sufﬁciently good for each wavelength!).
(b) The ﬁrst of the three terms on the right-hand side of equation (15.46)
relates the protein phase to the model phases for each wavelength. This
Sim (1959a,b) type term should always be present when a model is
available (in our case, the model is the anomalous scatterer substructure).

360
Anomalous dispersion techniques
(c) The other two terms on the right-hand side of (15.46) depend on the anom-
alous differences and the dispersive differences in all of the possible com-
binations. While SAD exploits only one anomalous difference, in MAD
techniques dispersive differences provide a non-negligible contribution.
(d) w are suitable weights which are not deﬁned here for brevity; the reader is
referred to the original paper.
To clarify the main features of the vector V, we describe its expression for the
SAD case in Appendix 15.A.
Let us now suppose that the protein phases have been assigned to each
reﬂection; then a least squares procedure usually starts to improve the phase
estimates. It is described in Appendix 15.B.
The same considerations made for the algebraic approaches described in
Sections 15.4 and 15.6 hold for phase ambiguity related to the probabilistic
SAD-MAD approach.
15.8
The probabilistic approach
for the SIRAS-MIRAS case
Let us suppose that the diffraction data for the native protein and the n deriv-
atives, obtained by addition of anomalously scattering heavy atoms, have been
collected; we are dealing with the SIRAS or the MIRAS case, according to
whether n = 1 or n > 1. The following experimental amplitudes are then
available:
|FP|, |F+
d1|, . . . , |F+
dn|, |F−
d1|, . . . , |F−
dn|.
which will be settled on their absolute scales via statistical methods (as
described for other phasing techniques).
While in the MAD case there is a unique anomalous scatterer substructure,
in the MIRAS case there is one substructure for each derivative. The two-
step approach, described in preceding sections for SIR-MIR and SAD-MAD
cases, will also be the method of choice for the SIRAS-MIRAS case. Again,
we have ﬁrst to determine the anomalous scatterer substructures, and then use
this information to phase the protein.
Step 1 Each derivative is characterized by a proper heavy-atom substructure;
it may be supposed that, for the jth derivative, the following relation holds:
F+
dj = F+
P + F+
Hj + |μ+
dj| exp

iθ+
j

,
F−
dj = F−
P + F−
Hj + |μ−
dj| exp

iθ−
j

,
where μ±
dj are complex vectors arising from experimental measurements and
imperfect isomorphism. The jth substructure will be determined if sufﬁ-
ciently good estimates of the corresponding |FHj| s are obtained. Such result
may be obtained by studying, for each jth derivative, the joint probability
distribution,
P(RHj, RP, R+
dj, R−
dj, φHj, φP, φ+
dj , φ−
dj ),
(15.47)

The probabilistic approach for the SIRAS-MIRAS case
361
from which the conditional,
P(RHj, RP, R+
dj, R−
dj)
(15.48)
is obtained, by integrating (15.47) over φHj, φP, φ+
dj , φ−
dj .
From (15.48), the conditional distribution
P(RHj|RP, R+
dj, R−
dj)
is obtained by standard techniques, from which,
< RHj|RP, R+
dj, R−
dj >
may be derived.
A simple satisfactory approximation to RHj is obtained by the relation,
<R2
Hj| . . .> ≈w1|isoj|2 + w2|anoj|2,
(15.49)
suggested by the algebraic approach described in Section 15.5 (see equation
(15.27)).
The set of amplitudes (15.46) are then submitted to direct or Patterson
methods to ﬁnd the heavy-atom substructure of the jth derivative.
Step 2 At the end of Step 1, n substructure models become available. From
each model, the protein phases may be obtained via the following probabilistic
approach. The joint probability distribution function,
P

AP, A+
dj, A−
dj, BP, B+
dj, B−
dj|A+
Hj, B+
Hj, A−
Hj, B−
Hj

is calculated and transformed into polar variables,
P

RP, R+
dj, R−
dj, φP, φ+
dj , φ−
dj1|R+
Hj, φ+
Hj, R−
Hj, φ−
Hj

.
(15.50)
The following approximation is introduced:
φ+
dj ≈φP, φ−
dj ≈−φP,
which modiﬁes (15.50) to,
P

RP, R+
dj, R−
dj, φP|R+
Hj, φ+
Hj, φ−
Hj

,
from which the conditional phase distribution,
P

φP| . . . . . . . .

≈[2πI0(X)]−1 exp [X cos (φP −θP)]
(15.51)
is derived, where
tan θP =
(G+
j sin φ+
Hj −G−
j sin φ−
Hj)
G+
j cos φ+
Hj −G−
j cos φ−
Hj
= T
B,
(15.52)
G+
j = 2|F+
Hj|+
isoj/|μ+
j |2, G−
j = 2|F−
Hj|−
isoj/|μ−
j |2
X =

T2 + B21/2 .
.
θP is the most probable value of φP, given the prior information on
RP, R+
dj, R−
dj, R+
Hj, φ+
Hj.
Equation (15.52) is very simple in practical use, but some details are
necessary to disclose its internal mechanism. We provide this information in
Appendix 15.C.

362
Anomalous dispersion techniques
If we apply equation (15.52) to each substructure, n protein models are
obtained. The quality of such models depends on the quality of the diffrac-
tion data collected at the various wavelengths (indeed, the derivatives may have
different degrees of isomorphism, different data resolution, and different meas-
urement errors). Combining the various protein models in these conditions
is also not rewarding, because they are probably referred to different origins
and have different handedness (according to the occasional handedness of the
substructure models).
To avoid such difﬁculties, a procedure similar to that used for the MIR case
may be undertaken:
(a) The ‘best’ derivative is selected: this is the one for which the SIRAS phas-
ing process is expected to provide the minimum phase error; appropriate
ﬁgures of merit should be used towards recognizing it.
(b) The set of phases {φPbest}, obtained from the best derivative at the end
of the reﬁnement step, is employed to calculate, for each jth derivative,
the differential Fourier synthesis with coefﬁcient (| ¯Fdj| −|Fp|) exp(iφPbest),
where | ¯Fdj| = (|F+
dj| + |F−
dj|)/2. The rationale is as follows: even if the n
substructures are uncorrelated, the protein models provided by the dif-
ferent derivatives are expected to be correlated with each other. Thus, if
we associate {φPbest} to the jth (| ¯Fdj| −|Fp|) coefﬁcient, we should obtain
a substructure map which better approximates the jth true substructure.
As explained for the MIR case, the procedure provides an additional
advantage: the same handedness and the same origin are secured for all
of the substructures.
(c) The new model substructures may be reﬁned by special least squares pro-
cedures, similar to that used for the MIR case. Then, from the improved
substructures, new phase estimates φP are obtained via equation (15.51).
The new sets of phases {φP}i , i = 1, . . . , n are combined according to
point (d).
(d) The most general way for handling the MIRAS case when the n sub-
structures are known is to calculate the joint probability distribution
function,
P

AP, A+
d1, . . . , A+
dn, BP, A−
d1, . . . , B−
dn| A+
H1, . . . . A−
Hn, B+
H1, . . . , B−
Hn

,
transform it into polar variables,
P

RP, R+
d1, . . . , R−
dn, φP, φ+
d1, . . . , φ−
dn | R+
H1, . . . . R−
Hn, φ+
H1, . . . , φ−
Hn

,
(15.53)
and, for each derivative, introduce the following approximation:
φ+
dj ≈φP, φ−
dj ≈−φP,
for j = 1, . . . , n.
Then, the conditional probability (15.53) reduces to
P

RP, R+
d1, . . . , R−
dn, φP| R+
H1, . . . . R−
Hn, φ+
H1, . . . , φ−
Hn

,
from which the conditional probability,
P

φP| . . . . . . . .

≈[2πI0(X)]−1 exp [X cos(φP −θP)]

Anomalous dispersion and powder crystallography
363
may be derived, where
tan θP =
n
j=1

G+
j sin φ+
Hj −G−
j sin φ−
Hj

n
j=1

G+
j cos φ+
Hj −G−
j cos φ−
Hj
 = T
B,
(15.54)
G+
j = 2|F+
Hj|+
isoj/|μ+
j |2, G−
j = 2|F−
Hj|−
isoj/|μ−
j |2
X =

T2 + B21/2 .
The summation varies over the n different derivatives, θP is the most
probable value of φP and X is its reliability parameter.
(e) Steps (a) to (c) may be cyclically repeated.
(f) EDM procedures are applied to improve and to extend the phase informa-
tion up to native resolution.
15.9
Anomalous dispersion and powder
crystallography
MAD techniques are not very beneﬁcial for powder crystallography, owing to
an unavoidable loss of experimental information. In general:
(a) The reﬂections F+ and F−systematically overlap in the diffraction
pattern; consequently, anomalous differences |F+|2 −|F−|2 cannot be
measured, only the intensities Ih = |F+|2 + |F−|2 are available experi-
mentally. This excludes the usefulness of a SAD experiment and it also
excludes the possibility of identifying the absolute structure from powder
data affected by anomalous dispersion effects.
(b) Dispersive differences between (|F+
i |2 + |F−
i |2) and (|F+
j |2 + |F−
j |2) (sub-
scripts denote the wavelengths) may be estimated from the experiment,
but their accuracy is questionable in most cases, because of the systematic
and casual overlapping present in the two diffraction patterns.
The apparently minor experimental information provided by powder diffrac-
tion experiments discouraged the use of MAD and its applications; pioneering
contributions were made by Prandl (1990, 1994), Gu et al. (2000), and
Helliwell et al. (2005). In a more recent paper (Altomare et al., 2009d,e),
the probabilistic bases of the method were established. Since Bijvoet pairs
cannot be estimated separately, the distribution P

Eoa, E+
1 , E−
1 , . . . . , E+
n , E−
n

,
so basic for applications to single crystal data, cannot be used for powder
data. The joint probability distribution function, P

Eoa, ¯E1, ¯E2

, was then con-
sidered, where ¯Ep = 1
2

E+
p + E−∗
p

, from which the conditional distribution,
P

Roa|¯R1, ¯R2

, and therefore the value of <Roa|¯R1, ¯R2 > could be obtained.
This value may then be used as input for Patterson and direct methods, to ﬁnd
the anomalous scatterer substructure.
In accordance with the two-step procedure, a probabilistic approach may
then used for ﬁnding the full structure given the anomalous substructure.
Details on the theory and applications may be found in the original papers.

364
Anomalous dispersion techniques
15.10
Applications
Several computing packages are available for phasing proteins via anomalous
dispersion effects.
Anomalous scatterer substructures (Step 1) may be identiﬁed by applying
any of the third generation direct methods programs (SHELXD (Schneider
and Sheldrick, 2002), ACORN ( Foadi et al., 2000), IL MILIONE (Burla et al.,
2007c), SHAKE & BAKE (Weeks and Miller, 1999), SUPERFLIP (Dumas and
van der Lee, 2008)) to Bijvoet differences or to the more accurate |FH| estim-
ates described in Sections 15.7 and 15.8. IL MILIONE (as well as PHENIX
(Terwilliger et al., 2009)), may also use Patterson techniques, which have
proved to be particularly efﬁcient; see Burla et al. (2007b).
The success of the above phasing procedures for data at non-atomic res-
olution may appear to be unexpected; it mainly comes about because the
anomalous scatterer substructures consist of a relatively small number of
atoms, which are therefore dispersed in an enormous (with respect to the num-
ber of anomalous scatterers) empty unit cell. As a result, peak overlapping in
the Patterson map is strongly reduced, which makes the deconvolution pro-
cess easier. If we consider the quality of the electron density maps, it may be
seen that the electron density peaks of the substructure do not overlap even
for low resolution data, so they may be clearly distinguished from one other.
In these conditions, the diffraction data overdetermines the anomalous scat-
terer substructure (see the discussion in Section 1.6 on the ratio number of
observations/number of structural parameters to deﬁne).
The protein structure (Step 2) may be found via programs like SHELXE
(Sheldrick, 2002), MLPHARE (Otwinowski, 1991a,b), SHARP (La Fortelle
and Bricogne, 1997), OASIS (Hao et al., 2000), IL MILIONE, and PHENIX.
Each program uses its own phasing recipe, but each recipe may be re-
conducted to the theoretical considerations described in the preceding para-
graphs. To give a small account of the potential of the methods we describe
some applications of the program, IL MILIONE.
In Tables 15.2 and 15.3, we show lists of MAD and SAD test structures,
respectively, with the necessary information on crystal chemical data and on
the diffraction experiment. In order to provide an a posteriori estimate of the
efﬁciency of the phasing technique, in the last columns of each table are given
the average phase errors (ERRP and ERRF, in degrees) corresponding to some
phasing steps of the procedure.
The probabilistic approach described in the Section 15.7 (see equation
(15.40)) was applied to ﬁnd the estimates of R0a, say
< R0a|R+
1 , R+
2 , . . . , R+
n , R−
1 , R−
2 , . . . , R−
n > .
The reﬂections with the largest values of < R0a|R+
1 , R+
2 , . . . , R+
n , R−
1 , R−
2 , . . . ,
R−
n > /σR0a (see equation (15.43)) were used for calculating the Patterson
map, which was then submitted to Patterson deconvolution techniques (see
Chapter 10) to ﬁnd the positions of the anomalous scatterers. In both Tables
15.2 and 15.3, Found is the number of symmetry-independent anomalous scat-
terers found by the default run, to be compared with the number of scatterers
really present in the asymmetric unit (An. Scatt.). In most of the cases, all
anomalous scatterer positions were found, in some cases a high percentage of

A probabilistic formula for the SAD case
365
Table 15.2 Set of test structures for MAD experiments. PDB is the Protein Data Bank code, SG the space group, NRES is the number of
residues, nw is the number of wavelengths used in the experiment, An. Scatt. is the atomic species of the anomalous scatterers (in parentheses
the number of anomalous scatterers per asymmetric unit), Res is the limiting resolution to which the data are measured. When native data are
available, the resolution is quoted in parentheses. For the meanings of the other headings, see text
PDB
SG
NRES
nW
RES(Å)
An. Scatt.
Found
RANK
ERRP(CC)
ERRF(CC)
1srv
C2221
145
4
2.27 (1.7)
Se(3)
3
1
62(0.62)
57(0.73)
1c8u
C2221
570
4
1.90
Se(8)
8
1
57(0.54)
40(0.88)
1ga1
P62
372
3
1.40
Br(13)
12
1
69(0.45)
44(0.83)
1m3u
P21
2640
3
3.0 (1.8)
Se(160)
158
5
60(0.61)
54(0.78)
1lvo
P21
1812
4
2.70 (1.95)
Se(60)
60
1
57(0.58)
67(0.72)
1ks9
P42212
291
3
1.70
Se(8)
8
1
57(0.62)
60(0.75)
1m32
P21
2196
3
2.60 (2.2)
Se(66)
66
1
56(0.56)
50(0.73)
1j6n
P21
1212
3
2.60 (1.8)
Se(45)
45
1
47(0.74)
44(0.82)
1ﬁ4
P22212
832
3
2.28
Se(9)
9
1
64(0.53)
60(0.69)
1i94
P41212
364
2
2.40
Se(8)
8
4
63(0.55)
50(0.82)
Table 15.3 Set of test structures for SAD experiments. PDB is the Protein Data Bank code, SG the space group, NRES is the number of
residues, An. Scatt. is the atomic species of the anomalous scatterers (in parentheses the number of anomalous scatterers per asymmetric unit),
Res is the limiting resolution to which the data are measured
STRUCT.
SG
NRES
RES(Å)
An. Scatt.
Found
Rank
ERRP(CC)
ERRF(CC)
2fdn
P43212
55
0.94
Fe(8)
8
2
42(0.60)
36(0.86)
8xia
I222
388
1.50
Mn(1);Mg(1)
1
1
65(0.35)
32(0.90)
1fj2
P21
464
1.80
Br(22)
22
1
65(0.49)
54(0.68)
1svn
P212121
269
1.74
Ca(4);S(3);Cl(2)
8
1
62(0.42)
51(0.68)
1l78
P43212
258
1.53
S(10)Cl(8);
18
18
56(0.57)
46(0.78)
1ick
P212121
12
0.95
P(10)
10
1
48(0.53)
44(0.82)
1w92
R32
148
1.90
Fe(2)
2
1
57(0.51)
39(0.88)
P4
C2
6432
2.5
Se(144)
120
9
—-
—-
them were located. RANK is the order of the correct substructure, among the
trial solutions provided by the Patterson deconvolution techniques, as ﬁxed by
a suitable ﬁgure of merit. In most cases RANK is one, however, in very difﬁcult
cases RANK may be in a lower position.
Protein phasing was undertaken according to equations (15.45) and (15.46),
in agreement with the procedure described in Section 15.7. The average phase
error, calculated just after location of the anomalous scattererers, is reported
in the two tables as ERRP, and the ﬁnal average error after the application of
EDM procedures over all the protein measured reﬂections is reported as ERRF.
CC is the correlation between the ﬁnal electron density map and the published
map. In all cases, the densities are immediately interpretable.
APPENDIX 15.A
A PROBABILISTIC FORMUL A
FOR THE SAD CASE
The distribution (15.45) and equation (15.46) were obtained under the follow-
ing assumptions: an n-wavelength experiment has been carried out and the

366
Anomalous dispersion techniques
anomalous scatterer substructure has been identiﬁed. Here, we provide some
details on the speciﬁc form of V for the SAD case. If n = 1, V reduces to
V = w+E+
a + w−E−∗
a
+ w

E+
a −E−∗
a

,
where
w+ =
2
1 + S
R+
(σ +)2 ,
w−=
2
1 + S
R−
(σ −)2 ,
w =
2
1 + S

R+ −R−
(σ +σ −)2
S =

σ +2 +

σ −2 .
σ + and σ −are the normalized (with respect to the non-anomalous scatterer
substructure) values of μ+ and μ−, and S1/2 may be considered to be the
standard deviation associated with |E+
a | −|E−
a |. Accordingly,
V =
2
1 + S

R+E+
a
(σ +)2 + R−E−∗
a
(σ −)2 +

R+ −R−
(σ +σ −)2

E+
a −E−∗
a


(15.A.1)
Taking into account the E deﬁnitions , the expression (15.A.1) may be rewritten
in terms of structure factors as,
V ≈2
	|F+|F+
a
(μ+)2 + |F−|F−∗
a
(μ−)2

+ 2 
na
ano
(μ+μ−)2

F+
a −F−∗
a

≈2
	|F+|F+
a
(μ+)2 + |F−|F−∗
a
(μ−)2

+ 4 
na
ano
(μ+μ−)2 F′′+
a
(15.A.2)
We notice:
(i) The ﬁrst term on the right-hand side of (15.A.2) is the Sim-like contribu-
tion for the h and –h Miller indices. The smaller the error in the model
and in the measurements, the larger its contribution will be. Since F+
a
and F−∗
a
are vectors in the Argand plane, the direction of the ﬁrst term in
(15.A.2) is approximately the direction of F′+
a (see Fig. 15.A.1).
Fa² –*
Fa²+
Fa¢+
Fa
–*
Fa
+
real axis
imag. axis
Fig. 15.A.1
SAD case. Vectorial representation of the
V components in equation (15.A.2).
(ii) The second term is the product of two differences, say ano and
( F+
a −F−∗
a ). The amplitude of the product is generally very small, but
its contribution to V is magniﬁed by the factor 
na. Thus, it is the most
important term in (15.A.2). The resulting vector in the Argand plane (see
again Fig. 15.A.1) has the direction of F′′+
a
if ano is positive; the opposite
direction if ano is negative.
(iii) The ﬁrst term is important only when the scattering power of the
anomalous scatterer substructure is not very small.
APPENDIX 15.B
STRUCTURE REFINEMENT
FOR MAD DATA
We have seen in Section 15.7 that the most probable value of the protein
phase in a n-wavelength MAD experiment depends on the anomalous differ-
ences and the dispersive differences (E+
aj −E+
ap), (E−∗
aj −E−∗
ap ), (E+
aj −E−∗
ap ), for
j,p = 1, . . . , n. The reﬁnement process (Otwinowski, 1991a,b) may be

Structure reﬁnement for MAD data
367
performed by reﬁning not only the parameters of the anomalous scatterer sub-
structure but also the anomalous scattering components f ′ and f ′′ of the
anomalously scattering atoms; indeed they are not perfectly known at the
time of the experiment. We will shortly describe the procedure followed by
Giacovazzo and Siliqi (2004).
The quantities,

h

j

anoj| −Kj

|F+
aj −F−∗
aj |
2
(15.B.1)
and

h

j,p

| ¯dispj,p| −Kj,p

| ¯Faj −¯Fap|
2 ,
(15.B.2)
are minimized, where j and p denote the wavelengths, Kj and Kj,p are suitable
scale factors, and
¯dispj,p = ¯Fj −¯Fp, ¯Fj =
|F+
j | + |F−
j |
2
, ¯Faj =
F+
aj + F−∗
aj
2
.
Minimization of (15.B.1) involves the anomalous differences, the dispers-
ive differences are taken into account in the minimization of (15.B.2). The
procedure may be described as follows:
(i) The experimental values of |F+
j |, σ(|F+
j |), |F−
j |, σ(|F−
j |) are read together
with the expected f ′
j , f ′′
j values for each jth wavelength. If the reﬂection
is centric, we set
|F+
j | = |F−
j | =
|F+
j | + |F−
j |
2
,
σ(|F+
j |) = σ(|F−
j |) = 1
2

σ 2 
|F+
j |

+ σ 2 
|F−
j |
1/2 .
(ii) All of the diffraction intensities are normalized with respect to the
scattering power of the non-anomalous scatterers.
(iii) The least squares procedure is applied; the reﬁnement is controlled by
suitable weights. The atomic positional parameters of the anomalous scat-
terers, their occupancy, and thermal factors are considered to be global
parameters (a unique structural model is reﬁned via all of the measured
intensities); the f ′′ and f ′ values are treated as local parameters (they
are reﬁned via the intensities collected at speciﬁc wavelengths).
(iv) The global parameters and the f ′′ values are reﬁned by minimizing the
quantity (15.B.1). The summation over h includes 70% of the measured
reﬂections (those with the largest values of <|ano|>, where the average
is taken over all the wavelengths).
(v) The model obtained at step (iv), the occupancies excluded, is kept
ﬁxed when the quantity (15.B.2) is minimized for deﬁning the differ-
ences f ′
j −f ′
p. In this case, the summation over h uses only centric
reﬂections, if their number is sufﬁciently large.
(vi) After least squares convergence, formula (15.46) is calculated.

368
Anomalous dispersion techniques
APPENDIX 15.C
ABOUT PROTEIN PHASE
ESTIMATION IN THE SIRAS CASE
For convenience, we rewrite equation (15.52), providing the best value θP for
the protein phase given RP, R+
dj, R−
dj, R+
Hj, φ+
Hj:
tan θP =

G+
j sin φ+
Hj −G−
j sin φ−
Hj

G+
j cos φ+
Hj −G−
j cos φ−
Hj
= T
B,
(15.C.1)
where
G+
j = 2|F+
Hj|+
isoj/|μ+
j |2 , G−
j = 2|F−
Hj|−
isoj/|μ−
j |2
X =

T2 + B21/2 .
We will give some examples in order to clarify how the phase indications
obtained from equation (15.C.1) may be interpreted in terms of vectors in the
Argand plane.
If |F+
Hj| is not very different from |F−
Hj|, we can approximate equation
(15.C.1) by
tan θP ≈

+
isoj sin φ+
Hj + −
isoj sin φ−∗
Hj


+
isoj cos φ+
Hj + −
isoj cos φ−∗
Hj
 = T
B,
(15.C.2)
where φ−∗
Hj = −φ−
Hj.
The tangent formula (15.C.2) will be useful to illustrate some SIRAS
didactical cases:
1. If f ′′
H is very small compared with f ′
H, then
|F′
H|>> |F′′
H|, +
iso ≈−
iso, φ+
H ≈φ−∗
H
≈φ′+
H ,
and (15.C.2) reduces to
tan θP = +
iso sin φ′+
H
+
iso cos φ′+
H
.
Accordingly,
θP ≈φ′+
H if +
iso ≈−
iso > 0,
θP ≈φ′+
H + π if +
iso ≈−
iso < 0.
This is the classical SIR case, discussed in Section 14.6; indeed, if f ′′
H is
very small, the anomalous scattering does not add any valuable information
to the phase indication provided by the SIR method (see Fig. 15.C.1a).
2. If f ′′
H is non-negligible with respect to f ′
H (then |F′′
H| is also comparable with
|F′
H|), and if
+
iso > 0, −
iso > 0 with , |−
iso| < |+
iso|,
then (15.C.2) may be written as
tan θP =

|+
iso| sin φ+
H + |−
iso| sin φ−∗
H


|+
iso| cos φ+
H + |−
iso| cos φ−∗
H
,

About protein phase estimation in the SIRAS case
369
Fd
+
a)
Fd
–*
FH¢
FH²+
FH²–*
Fp
real axis
imag. axis
b)
direction φH
+
direction φH
–*
Fd
–*
Fd
+
FH²–*
FH²+
FH¢
Fp
real axis
imag. axis
Fd
–*
Fd
+
FH²–*
FH²+
FH
¢
Fp
c)
real axis
imag. axis
direction (φH
–*+ p)
direction (φH
++ p)
Fd
+
Fd
–*
FH²–*
FH¢
FH²+
Fp
d)
real axis
imag. axis
direction (φH
++ p)
direction φH
–*
Fig. 15.C.1
SIRAS case. Geometrical details for
clarifying the internal mechanism of
equation (15.52), which estimates the
protein phase, φP, given the experi-
mental data and the heavy-atom substruc-
ture. Four typical cases are illustrated:
(a) |F′
H|>> |F′′
H|, +
iso ≈−
iso. Then φ+
H ≈
φ−∗
H
≈φ′+
H
and the phase indication
is θP ≈φ′+
H , if +
iso ≈−
iso > 0, θP ≈
φ′+
H + π if +
iso ≈−
iso < 0. (b) +
iso >
0, −
iso > 0 with |−
iso| < |+
iso|. θP is
estimated between φ+
H and φ−∗
H , closer to
φ−∗
H . (c) +
iso < 0, −
iso < 0 with |−
iso| <
|+
iso|. Then φP is expected between
(φ+
H + π) and (φ−∗
H
+ π), closer to (φ+
H +
π). (d) +
iso < 0, −
iso > 0 with |−
iso|>
|+
iso|. Then φP is expected between
(φ+
H + π) and φ−∗
H , closer to φ−∗
H .
according to which, φP is estimated to be between φ+
H and φ−∗
H , closer to
φ+
H . This situation is illustrated in Fig.15.C.1b. If |−
iso| > |+
iso|, then the
expected value of φP will be closer to φ−∗
H .
3. f ′′
H is comparable with f ′
H, +
iso < 0, −
iso < 0 with |−
iso| < |+
iso|. Then,
(15.C.2) reduces to
tan θP = [|+
iso| sin(φ+
H + π) + |−
iso| sin(φ−∗
H
+ π)]
[|+
iso| cos(φ+
H + π) + |−
iso| cos(φ−∗
H
+ π)],
which estimates φP between (φ+
H + π) and (φ−∗
H
+ π), closer to (φ+
H + π).
This situation is illustrated in Fig. 15.C.1c. If |−
iso|> |+
iso|, then the
expected value of φP will be closer to φ−∗
H
+ π.
4. f ′′
H is comparable with f ′
H, +
iso < 0, −
iso > 0 with |−
iso|> |+
iso|. In this
case, (15.C.2) reduces to
tan θP = [|+
iso| sin(φ+
H + π) + |−
iso| sin φ−∗
H ]
[|+
iso| cos(φ+
H + π) + |−
iso| cos φ−∗
H ],
which estimates φP between (φ+
H + π) and φ−∗
H , closer to φ−∗
H
(see
Fig. 15.C.1d). If |−
iso| < |+
iso|, then the expected value of φP will be closer
to (φ+
H + π).

Appendices
Some readers of this book may be interested in crystallographic phasing meth-
ods, not only for their practical use in crystal structure solution procedures, but
also for a deeper insight into their theoretical background, and possibly, for
their improvement. To simplify their learning, some mathematical appendices,
of a quite general type and frequent application in Chapters 1 to 15, are col-
lected together here. The ﬁrst appendix is devoted to the basics of probability
theory and to the concepts of moments and cumulants of a multivariate dis-
tribution. The other appendices are dedicated to some basic results in gamma
function theory, to Hermite and Laguerre polynomials, and to Bessel functions.
The most frequent integration formulas are also reported.
APPENDIX M.A
SOME BASIC RESULTS IN PROBABILIT Y THEORY
M.A.1
Probability distribution functions
In textbooks on probability theory, the term probability distribution function
of the random variable ξ is used to denote the probability that ξ is less than or
equal to x:
F(x) = P(ξ ≤x) .
To be consistent with the crystallographic literature, we shall use the term
cumulative distribution function (or simply cumulative function) for F(x). The
following properties hold:
1. F(−∞) = 0 ; F(+∞) = 1.
2. F(x) shall not decrease at any point:
F(x1) ≤F(x2) ,
x1 < x2.
3. F(x2) −F(x1) = P(x1 < x ≤x2) .
Let F(x) be deﬁned at every point in a continuous range and be continu-
ous, except perhaps at speciﬁc points. If it possesses a derivative, we have
dF = f(x) dx. f(x) is called the probability density function. The following
properties hold:
1. f(x) ≥0.
2.
 +∞
−∞f(x)dx = F(∞) −F(−∞) = 1.
3. F(x) =
 x
−∞f(ξ) d ξ, from which
F(x2) −F(x1) =
 x2
x1
f (x) dx,

Some basic results in probability theory
371
or
P(x1 ≤x ≤x2) =
 x2
x1
f (x) dx.
M.A.2
Moments of a distribution
The mathematical expectation of any function g(x) (x is supposed to range from
−∞to +∞) is given by,
⟨g(x)⟩=
 +∞
−∞
g(x)f(x) d x.
(M.A.1)
provided that this integral exists. The mathematical expectation (or expectation
value) of the power xv with positive integer exponent is called the moment of
order v or the vth moment. We shall denote it by mv so that
mv =
 +∞
−∞
xvf(x) d x = ⟨ξ v⟩.
The vth moment of the variable x about the point c is then

(x −c)v
=
 +∞
−∞
(x −c)vf (x) dx.
If m1 is the mean value deﬁned by
m1 = ⟨x⟩=
 +∞
−∞
xf(x) dx,
we can now deﬁne the central moments (they will be denoted by μv):
μv =
 +∞
−∞
(x −m1)vf(x) dx =

(x −m1)v
.
(M.A.2)
The reader can easily verify that
μ0 = 1,
μ1 = 0,
μ2 = m2 −m2
1,
μ3 = m3 −3m1m2 + 2m3
1,
μ4 = m4 −4m1m3 + 6m2
1m2 −3m4
1,
etc.
M.A.3
The characteristic function
The characteristic function C(u) of a random variable x is deﬁned to be the
expectation value of the complex function exp(ixt), where t is a real variable:
C(u) =
 +∞
−∞
exp(iux)f(x) dx =

exp (iux)

.
(M.A.3)

372
Appendices
C(u) is nothing but the Fourier transform of the probability density function
f(x) and has the following properties:
C(0) = 1,
|C(u)| ≤
 +∞
−∞
f (x)dx = 1.
If the moments up to the tth order for the random variable x exist, (M.A.3) may
be differentiated v times (0 < v ≤t), giving rise to
C(v)(u) = iv
 +∞
−∞
xv exp(iux)f (x)dx.
(M.A.4)
When u = 0, (M.A.4) becomes
C(v)(0) = iv
 +∞
−∞
xvf (x)dx = ivmv.
By expanding C(u) in a Taylor series, we obtain
C(u) = 1 +
t
v=1
mv
v! (iu)v + Rt,
(M.A.5)
Rt is the truncation error (limt→∞Rt = 0). Thus the characteristic function is
also a moment generating function.
The probability density function of ξ is given by the inverse Fourier
transform of C(u):
P(ξ) = 1
2π
 +∞
−∞
C(u) exp(−iuξ)du.
Knowledge of C(u) is therefore sufﬁcient for calculating P(ξ).
By replacing C(u) by (M.A.5), we obtain a further basic result: the probab-
ility density of ξ may be calculated if the moments mv are known.
One of the qualities of the characteristic function is that it aids derivation of
the probability density function of a sum of random variables. For example,
if we have two independent random variables, ξ and η, the characteristic
distribution C(u) of their sum, ξ + η, is given by
C(u) =

exp [iu(ξ + η)]

=

exp(iuξ) exp(iuη)

=

exp(iuξ)

exp(iuη)

= C1(u)C2(u).
The result is easily generalized to the case of the sum of n independent random
variables. The characteristic function, C(u), of ξ = ξ1 + ξ2 + · · · + ξn, is then
C(u) = C1(u)C2(u) · · · Cn(u).
(M.A.6)
The probability density function of ξ is given by the inverse Fourier transform
of (M.A.6):
P(ξ1 + ξ2 + · · · + ξn) = 1
2π
 +∞
−∞
C(u) exp[−iu(ξ1 + ξ2 + · · · + ξn)]du.
Again, the probability density of ξ may be calculated by means of the charac-
teristic functions Cj or, because of (M.A.5), by means of the moments in which
C(u) may expressed. In this last case, the concept of cumulant will be useful.

Some basic results in probability theory
373
M.A.4
Cumulants of a distribution
It is often convenient to use the logarithm of the characteristic function, which
is called the cumulant generating function: K(iu) = log C(u). Expanding them
in a Taylor series, we obtain
log C(u) =

v
kv(iu)v
v!
,
where kv is the cumulant of the vth order of the distribution. An important
property of the cumulants is that they are additive when a random variable
is a sum of a set of independent random variables; i.e. if ξ = ξ1 + ξ2, then
C(u) = C1(u)C2(u); therefore
K(iu) = log C(u) = log C1(u) + log C2(u)
= K1(iu) + K2(iu).
When ξ = ξ1 + ξ2 + · · · + ξn, we can also write
C(u) = exp
 n

s=1
Ks(iu)

.
Then, according to Section M.A.3, we can write
P(ξ) = 1
2π
 +∞
−∞
exp
 n

s=1
Ks(iu)

exp(−iuξ) du
= 1
2π
 +∞
−∞
exp

−iuξ +
n

s=1
Ks(iu)

du.
Knowledge of cumulants is therefore a condition for the calculation of P(ξ).
The cumulants are related to the moments of the distribution and vice versa.
The relations may be found by observing that
log(1 + z) = z −z2
2 + · · · + (−1)r−1 zr
r + · · · .
We obtain
k1 = m1,
k2 = m2 −m2
1,
k3 = m3 −3m1m2 + 2m3
1,
k4 = m4 −3m2
2 −4m1m3 + 12m2
1m2 −6m4
1,
etc.
(M.A.7)
If m1 = 0, equations (M.A.7) become,
kl = 0,
k2 = m2,
k3 = m3,
k4 = m4 −3m2
2,
k5 = m5 −10m2m3,
k6 = m6 −10m2
3 −15m2m4 + 30m3
2,
k7 = m7 −21m2m5 −35m3m4 + 210m2
2m3,
etc.
(M.A.8)

374
Appendices
M.A.5
The normal or Gaussian distribution
Let us apply the above consideration to a normal distribution.
A random variable x is normally distributed with parameters (m, σ) with
σ > 0, if its probability density function is given by
f(x) =
1
σ
√
2π
exp
	
−(x −m)2
2σ 2

.
(M.A.9)
The graph of (M.A.9) is symmetrical with respect to x = m, with maximum
ordinate 1/σ
√
2π at x = m. The graph has inﬂection points at x = m ± σ. It is
thus apparent that
⟨x⟩= m,

(x −⟨x⟩)2
= σ 2.
The characteristic function is
C(u) = ⟨exp(iux)⟩= exp
	
miu −1
2σ 2u2

.
The most convenient form of the normal distribution for tabulation is that cor-
responding to a standardized random variable, x′ = (x −m)/σ. Its probability
density function is
φ(x) =
1
√
2π
exp
	
−x2
2

;
(M.A.10)
its cumulative distribution function is
(x) =
1
√
2π
 x
−∞
exp
	
−t2
2

dt;
(M.A.11)
its characteristic function is
C(u) = exp (−u2/2).
It is easy to verify that

x′
=
x −m
σ

= 0,

x′ −

x′2
= 1.
If x is distributed according to (M.A.9), then

xn
=

= 1 × 3 × · · · × (n −1)σ n
for even n,
= 0
for odd n;
(M.A.12)

|x|n
=
⎧
⎨
⎩
= 1 × 3 × · · · × (n −1)σ n
for even n,
=

2
π 2nn!σ 2n + 1
for odd n.
(M.A.13)
In fact, since
 +∞
−∞
exp

−αx2
dx =
π
α ,
(M.A.14)
derivatizing (M.A.14) k times with respect to αgives,
 +∞
−∞
x2k exp

−αx2
dx = 1 × 3 × · · · × (2k −1)
2k

π
α2k+1 .
(M.A.15)

Some basic results in probability theory
375
If a = 1/2σ 2 is substituted in (M.A.15), we obtain (M.A.12) and the ﬁrst
of eqations (M.A.13). The second of equations (M.A.13) is proved if one
considers that
|x|2k+1
=
 +∞
−∞
|x|2k+1 f(x)dx = 2
 ∞
0
x2k+1f(x)dx
=
2
σ
√
2π
 ∞
0
x2k+1 exp
	−x2
2σ 2

dx.
If y = x2/2σ 2, we obtain
|x|2k+1
=
2
√π
(2σ 2)k+1
2σ
 ∞
0
yk exp(−y) dy.
A property of the 	function (see Appendix M.C) gives the second of equations
(M.A.13).
M.A.6
The central limit theorem
Let ξ1, ξ2, . . . , ξn be a sequence of independent random variables: mj and σ 2
j
are the mean and the variance value of ξj. No matter what the distribution of
the independent variables ξj, subject to certain very general conditions, the
sum ξ = ξ1 + ξ2 + · · · + ξn tends to the normal distribution as n →∞and
has parameters (m, σ), given by
m = m1 + m2 + · · · + mn,
σ 2 = σ 2
1 + σ 2
2 + · · · + σ 2
n .
When all the random variables have the same distribution, we will say that
Lindeberg–Lévy conditions are satisﬁed.
The central limit theorem does not hold with sufﬁcient accuracy if n is
not sufﬁciently large, or when the distributions are not the same and one or
a few dominate the sums. Then, some supplementary terms should be taken
into account giving the so-called Gram–Charlier and Edgeworth series (see
Chapter 5).
The central limit theorem remains valid under certain conditions, even when
the n variables are not independent. Bernstein (1927) showed that the central
limit theorem would apply if the variables are not too closely related. A par-
ticular example occurs when ξi is correlated to a subset of the n variables; in
crystallography, such an example reﬂects the correlation of one atom with its
neighbours, while little correlation exists with atoms far apart. If Bernstein’s
conditions are satisﬁed one has to take care of the correlation between the
random variables when m and σ 2 are calculated.
M.A.7
Multivariate distributions
The cumulative distribution function of n random variables, ξ1, ξ2, . . . , ξn, is
deﬁned by
F(x1, x2, . . . , xn) = P{ξ1 ≤x1, ξ2 ≤x2, . . . , ξn ≤xn}.

376
Appendices
F is clearly a single-valued, real and non-negative function of the xj values.
In the case of continuous random variables, the following properties hold:
1. The probability density function is given by
f (x1, . . . , xn) = δnf(x1, . . . , xn)
δx1δx2 · · · δxn
.
2. The marginal probability density of ξ1, ξ2, . . . , ξk is given by
f (x1, x2, . . . , xk) =
 +∞
−∞
· · ·
 +∞
−∞
f(x1, x2, . . . , xn) dxk+1 · · · dxn,
(M.A.16)
and the conditional probability density of ξ1, ξ2, . . . , ξk when ξk+1 =
ak+1, . . . , ξn = an is given by
f(x1, . . . , xk|xk+1, . . . , xn) =
f(x1, x2, . . . , xn)
 +∞
−∞· · ·
 +∞
−∞f(x1, . . . , xk, ak+1, . . . , an)dx1 · · · dxk
.
(M.A.17)
3. The expected value of the function g (ξ1, . . . , ξn) is
⟨g(ξ1, . . . , ξn)⟩=
 +∞
−∞
· · ·
 +∞
−∞
g(x1, . . . , xn)f(x1, . . . , xn)dx1 · · · dxn.
(M.A.18)
4. The moment of order v1 + v2 + · · · vn is deﬁned as
mv1−vn =
 +∞
−∞
· · ·
 +∞
−∞
xv1
1 xv2
2 · · · xvn
n f(x1, . . . , xn)dx1 · · · dxn.
(M.A.19)
5. The characteristic function is
C(u1, u2, . . . , un) = ⟨exp(i(u1x1 + u2x2 + · · · + unxn))⟩
=
 +∞
−∞
· · ·
 +∞
−∞
exp(i(u1x1 + · · · unxn))
× f(x1, . . . , xn)dx1 · · · dxn,
(M.A.20)
from which the joint probability density function is derived:
f(x1, x2, . . . , xn) =
1
(2π)n
 +∞
−∞
· · ·
 +∞
−∞
exp [−i (u1x1 + · · · + unxn)]
× C (u1, . . . , un) du1 · · · dun.
(M.A.21)
6. If every xi is a single-valued function of the random variables y1, . . . , yn
according to xi = hi(y1, . . . , yn), then
f(x1, x2 . . . , xn) dx1 dx2 · · · dxn = f

h1(y1, . . . , yn) , . . . , hn (y1, . . . , yn)

× |J|dy1 · · · dyn,
(M.A.22)
where j is the Jacobian of the transformation given by
J = δ(x1, . . . , xn)
δ(y1, . . . , yn).

Some basic results in probability theory
377
7. The cumulant generating function K (u1, u2, . . . , un) is deﬁned to be
K (u1, u2, . . . , un) = log C (u1, u2 . . . , un) .
We can now give, for bivariate, trivariate, and tetravariate distributions,
the relation between cumulants and moments of lower order in the case
in which m100 = m010−= 0. For bivariate distribution:
k10 = k01 = 0,
k20 = m20,
k11 = m11,
k30 = m30,
k21 = m21,
k40 = m40 −3m2
20,
k31 = m31 −3m20m11,
k22 = m22 −m20m02 −2m2
11,
k50 = m50 −10m30m20,
k41 = m41 −4m30m11 −6m21m20,
k32 = m32 −m30m02 −6m21m11 −3m12m20.
(M.A.23)
For trivariate distribution:
k111 = m111,
k211 = m211 −m200m011 −2m110m101,
k311 = m311 −3m210m101 −m300m011 −3m111m200 −3m201m110,
k221 = m221 −m200m021 −4m111m110 −2m120m101 −2m210m011 −m020m201.
(M.A.24)
For tetravariate distribution:
k1111 = m1111 −m1100m0011 −m1010m0101 −m1001m0110,
(M.A.25)
etc.
In a number of distributions used in the text, the following relationships are
true:
m10··· = m010··· = m30··· = m50··· = m110··· = m0110··· = 0.
(M.A.26)
M.A.8
Evaluation of the moments in structure
factor distributions
It is normal procedure to expand the characteristic function of a joint probab-
ility distribution of s.f.s. (see Sections 4.A.2–4.A.5) in terms of cumulants and
then, by means of formulas such as (M.A.23)–(M.A.26), to expand them in
terms of joint moments of trigonometric structure factors. We will show here
how such moments may be evaluated:
mpq−r =

γ p
1 γ q
2 · · · γ r
n

=
1

0
1

0
1

0
γ p
1 γ q
2 · · · γ r
n pdxdydz.
(M.A.27)

378
Appendices
In (M.A.27), γi represents the trigonometric form ξi of the jth s.f. or its real or
imaginary part: P is the probability density function of the independent ran-
dom variables (e.g. x, y, and z). When no prior information is available, x,
y, and z may be assumed to be independent random variables uniformly dis-
tributed over the range 0–1 so that P ≡1. The moment mpq−r can then be
evaluated from (M.A.27) for any space group by substituting the appropriate
trigonometric expression for the γj values.
In any space group it is the symmetry operators which deﬁne the trigo-
nometric expression of the s.f. Thus, there is no need to know the explicit
trigonometric expression of the s.f. if one is able to handle symmetry operators.
Let us ﬁrst consider monovariate distributions in an n.cs. space group of
order m. then (see deﬁnitions in Section 4.A.3)
m1 =

ξ(h)

=

p
m/p

s=1
exp

2πihCsr

= 0
m2 =

ξ(h)ξ(−h)

=

p2
m/p

s1,s2=1
exp

2πih

Cs1 −Cs2

r

= p2

m/p

s1̸=,s2=1
exp

2πih

Cs1 −Cs2

r

+ p2

m/p

s1̸=s2=1
exp

2πih

Cs1 −Cs2

r

.
Only the ﬁrst of the two terms on the right-hand side provides non-vanishing
contributions. Then
m2 = p2 m
p = pm.
Accordingly (see again the deﬁnition in Section 4.A.3)

|ξ ′(h)|2
=

ξ ′(h)ξ ′(−h)

= m.
(M.A.28)
For a cs. space group of order m,
ξ(h) = p
m/p

s=1
cos

2π ¯hCsr

.
Simple calculations show that (M.A.28) is also valid in cs. space groups.
Let us now estimate, for a three-variate structure factor distribution, the
mixed moment m111 when all three reﬂections are general (p ≡1). Then,
m111 =

ξ(h1)ξ(h2)ξ(−h1 −h2)

=

m
s1,s2,s3=1
exp
 
2π

h1

Cs1 −Cs3

+ h2(Cs2 −Cs3)

· r
!
.
Which gives a non-vanishing contribution only when s1 = s2 = s3. This con-
dition is satisﬁed m times, and at each time contribution to m111 is unitary.
Therefore (if reﬂections are of general type)
m111 = m
(M.A.29)

Some basic results in probability theory
379
in any space group. It is worthwhile noting that (M.A.29) is not valid when
reﬂections are of special type.
A further useful mixed moment is
m1111 =

ξ ′(h1)ξ ′(h2)ξ ′(h3)ξ ′(−hi −h2 −h3)

.
Again, we calculate m1111 for general reﬂections for which p ≡1. Then,
m1111 =

m
s1,s2,s3,s4=1
exp
 
2π

h1(Cs1 −Cs4)
+ h2(Cs2 −Cs4) + h3(Cs3 −Cs4)

· r
!
.
(M.A.30)
The right-hand side of (M.A.30) provides non-vanishing contributions only
when s1 = s2 = s3 = s4; therefore
m1111 = m
(M.A.31)
for all the space groups. Again we notice that (M.A.31) is not valid when
reﬂections are not of general type.
The reader will easily verify in P1 the following moment values:
m20 =

ξ 2(h)

= 2
m111 =

ξ (h1) ξ (h2) ξ (h1 + h2)

= 2
m40 = 6
m113 =

ξ (h1) ξ (h2) ξ 3 (h1 + h2)

= 6.
(M.A.32)
M.A.9
Joint probability distributions of the signs
of the structure factors
In probabilistic theories for the determination of signs of s.f.s, the ﬁrst aim is
to ﬁnd multivariate distributions of s.f.s with their magnitudes and signs. Since
the magnitudes are obtained from measurements, it may be useful to ﬁnd the
joint probability distribution of signs under the conditions that the correspond-
ing magnitudes of s.f.s are known. If we denote the jth s.f., its modulus, and
its sign by Ej, Rj, and sj, respectively, and the joint probability distribution
function by P, then (Naya et al., 1964; Allegra, 1965),
P(R1, . . . , Rn) =

s1=±1
. . .

sn=±1
P(R1s1, . . . , Rnsn),
(M.A.33)
P(s1, . . . , sn) = P(s1, . . . , sn|R1, . . . , Rn)
=
P(R1s1, . . . , Rnsn)

s1=±1 . . . 
sn=±1 P(R1s1, . . . , Rnsn).
(M.A.34)
(M.A.33), (M.A.34), and following formulas may be considered as particular
applications of (M.A.16) and (M.A.17). If P(s1) is the marginal probability that
the sign of E1 is s1 irrespective of the other signs s2, . . . , sn, we have,
P(s1) =

s2=±1
. . .

sn=±1
P(s1, . . . , sn).
(M.A.35)
In general,
P(s1, . . . , sr) =

sr+1=±1
. . .

sn=±1
P(s1, . . . , sn).
(M.A.36)

380
Appendices
When a sign product is considered, i.e. s1s2, the probability of s1s2 being
+ 1 is
P+ (s1s2) = P+,+(s1, s2) + P−,−(s1, s2).
(M.A.37)
For a triple product s1s2s3, then
P+(s1s2s3) = P+,+,+ + P+,−,−+ P−,+,−+ P−,−,+.
(M.A.38)
In general,
P+(s1s2 . . . sr) =

Ps1,...,sr,
(M.A.39)
where the summation goes over all the sets of signs for which s1s2 . . . sr = +.
The normalizing constants of the sign probabilities are readily found by
means of
P+ = P+/(P+ + P+).
(M.A.40)
In the end, the conditional probability for some signs given some others is (see
equation (M.A.17))
P(s1, s2, . . . , sr|sr+1, . . . , sn) =
P(s1, s2, . . . , sn)

s1,...,sr=±1 P(s1, s2, . . . , sn).
(M.A.41)
We are now able to calculate, from the distribution P(s), the values ⟨s⟩and the
associated variance V:
⟨s⟩= sP(s) + (−s)P(−s) = s(2P(s) −1),
(M.A.40′)
V =

s2
−⟨s⟩2 = s −[2P(s) −1]2 = 4P(s)(1 −P(s)).
(M.A.40′′)
M.A.10
Some measures of location
and dispersion in the statistics
of directional data
The usual linear measures of location and dispersion can be inappropriate
for circular distributions; e.g. the arithmetic mean gives absurd results if the
observed angles in a sample of size 2 are 5◦and 355◦. The arithmetic mean,
in fact, is 180◦, whereas geometrical intuition indicates 0◦. Suitable measures
of location and dispersion have been developed in order to analyse directional
data (see Mardia, 1972). We mention only two of them.
1. Mean direction
Let Pj, j = 1, . . . , n, be the points on the circumference of the unit circle
corresponding to the angle j. If O is the centre of the circle, the
mean direction ⟨⟩c is the direction of the resultant of the unit vectors
OP1, . . . , OPn.
If
C = 1
n
n

j=1
cos j = R cos ⟨⟩c,
(M.A.42)
S = 1
n
n

j=1
sin j = R sin ⟨⟩c,
(M.A.43)

Some basic results in probability theory
381
then nR is the length of the resultant and
⟨⟩c = tan−1(S/C).
(M.A.44)
It may easily be shown that ⟨⟩c has the following property:
n

j=1
sin

j −⟨⟩c

= 0,
(M.A.45)
which corresponds in the linear case to
n

j=1

yj −⟨y⟩
= 0.
If  is a continuous variable with probability distribution P(), then
(M.A.42) and (M.A.43) are substituted by
C =

cos P()d,
S =

sin P()d.
2. Circular variance
A measure of angular dispersion of the values j about the angle θ is
D = 1
n
n

j=1

1 −cos

j −θ

.
The dispersion is smallest about ⟨⟩c. In fact, on equating the derivative with
respect to θ to zero, (M.A.44) is obtained.
The circular variance is deﬁned as
Vc = 1 −1
n
n

j=1
cos

j −⟨⟩c

= 1 −R.
We see immediately that 0 ≤Vc ≤1 : in fact, if the angles j are very close to
⟨⟩c then R ≃1 and Vc ≃0. On the other hand, if the j are highly dispersed,
then R ≃0 and Vc ≃1. It may easily be seen that Vc is invariant under a change
of the zero direction.
An appropriate transformation of the variance is
Sc = [−2ln (1 −Vc)]1/2 ,
which gives a measure somewhat analogous to the ordinary standard deviation
on the line.
Let lj exp

ij

, j = 1, . . . , n, be n vectors in the complex plane, and
C = 1
n
n
j=1
lj cos j = R cos ⟨⟩c,
S = 1
n
n
j=1
lj sin j = R sin ⟨⟩c,
R =

C2 + S21/2.
Then nR is the length of the resultant vector and ⟨⟩c = tan−1(S/C) can be
assumed to be the mean direction. ⟨⟩c has the following property:
n

j=1
lj sin

j −⟨⟩c

= 0.
The quantity 1 −R can again represent the variance.

382
Appendices
APPENDIX M.B
MOMENTS OF THE P(Z) DISTRIBUTIONS
In Section 2.4, the probability P(z) was obtained, where z = R2 is the square
of the normalized structure factor modulus. The variable z can be considered,
in every respect, to be a gamma variable (Srinivasan and Subramanian, 1964);
it satisﬁes a probability density function of type
γl(z) = exp(−z)zl−1
	(l)
, 0 ≤z ≤∞
where 	 is the well-known gamma function deﬁned by equation (M.C.1).
In fact, if we consider the case l = 1 we obtain the acentric z-distribution
(2.15) (z is then a γ1 variable); if we choose l = 1/2 (then z is a γ1/2 variable),
we obtain (see (M.C.4)) the distribution
P(u)du =
1
√πu exp(−u)du,
which reduces to (2.16) when the new variable z = u/2 is introduced. The above
properties may be used to easily calculate the higher moments for the centric
and for the acentric distributions (see Section M.A.5):
<R2n >¯1 =

2
π
 ∞
0
R2n exp
	
−R2
2

dR = (2n)!
2nn!
<R2n+1 >¯1 =

2
π
 ∞
0
R2n+1 exp
	
−R2
2

dR =
	 2
π

1/2
2nn!
<R2n >1 =
2
 ∞
0
R2n+1 exp

−R2
dR = n!
<R2n+1 >1 = 2
 ∞
0
R2n+2 exp

−R2
dR = 	(n + 3/2).
APPENDIX M.C
THE GAMMA FUNCTION
For real positive values of x, the gamma function 	(x) is deﬁned by the deﬁnite
integral
	(x) =
 ∞
0
tx−1 exp (−t) dt.
(M.C.1)
If we integrate by parts, it follows that
	 (x + 1) = x	 (x) ,
(M.C.2)
from which it is evident that, if x is a positive integer,
	 (m + 1) = m!.
(M.C.3)

The Hermite and Laguerre polynomials
383
Table M.C.1
X
	 (x)
(x)
	 (x)
1.00
1.000
1.52
0.887
1.02
0.989
1.54
0.888
1.04
0.978
1.56
0.890
1.06
0.969
1.58
0.891
1.08
0.960
1.60
0.894
1.10
0.951
1.62
0.896
1.12
0.944
1.64
0.899
1.14
0.936
1.66
0.902
1.16
0.930
1.68
0.905
1.18
0.924
1.70
0.909
1.20
0.918
1.72
0.913
1.22
0.913
1.74
0.917
1.24
0.909
1.76
0.921
1.26
0.904
1.78
0.926
1.28
0.901
1.80
0.931
1.30
0.897
1.82
0.937
1.32
0.895
1.84
0.943
1.34
0.892
1.86
0.949
1.36
0.890
1.88
0.955
1.38
0.889
1.90
0.962
1.40
0.887
1.92
0.969
1.42
0.886
1.94
0.976
1.44
0.886
1.96
0.984
1.46
0.886
1.98
0.992
1.48
0.886
2.00
1.000
1.50
0.886
Special values of the gamma function are
	
	1
2

= √π,
	
	
m + 1
2

= 1 × 3 × 5 × · · · × (2m −1)
2m
√π.
(M.C.4)
The only minimum occurs at about x0 = 1.4616. In Table M.C.1 the values of
	 (x) for 1 < x < 2 are shown.
APPENDIX M.D
THE HERMITE AND L AGUERRE POLYNOMIALS
The Hermite polynomials Hv(x) are deﬁned by the equation
Hv (x) = (−1)v exp
	1
2x2

 dv
dxv
"
exp
	
−1
2x2

#
.
(M.D.1)

384
Appendices
The lowest-order polynomials are
H0 (x) = 1,
H4 (x) = x4 −6x2 + 3,
H1 (x) = x,
H5 (x) = x5 −10x3 + 15x,
H2 (x) = x2 −1,
H6 (x) = x6 −15x4 + 45x2 −15,
H3 (x) = x3 −3x,
H7 (x) = x7 −21x5 + 105x3 −105x.
(M.D.2)
The orthogonality of the Hermite polynomials is easily seen by means of the
two relations
 +∞
−∞
exp
	
−x2
2

Hm (x) Hn (x) dx = 0,
m ̸= n,
 +∞
−∞
exp
	
−x2
2

[Hn (x)]2 dx =
√
2πn!.
Thus a function f(x) may be expanded in the orthogonal series
f(x) A0H0 (x) + A1H1 (x) + A2H2 (x) + · · · ,
where
Av =
1
√
2πv!
 +∞
−∞
exp
	
−x2
2

f(x) Hv (x) dx.
Useful relations are
Hv (−x) = (−1)v Hv (x) ,
H2v−1 (0) = 0,
d
dxHv (x) = vHv−1 (x) ,
∞

v=0
Hv (x) Hv (y)
v!
tv =
2
√
1 −t2 exp

−
1
2

1 −t2 
t2x2 + t2y2 −2txy


(|t| < 1) .
(M.D.3)
If
φ (x) =
1
√
2π
exp
	
−x2
2

,
(M.D.1) may be rewritten as
φ(v) (x) = (−1)v Hv (x) φ (x) .
Table (M.A.1) then proves useful in deriving the values of the Hermite poly-
nomials up to sixth order. Polynomials of higher order may be derived by the
recurrence relation
Hv+1 (x) = xHv (x) −vHv−1 (x) .
(M.D.4)
The following formulas may be useful:
 +∞
−∞
exp

−x2
xmHn (x) dx =
⎧
⎪⎨
⎪⎩
0
if n > m
or
n −m = odd
m!√π
4pp! ,
if m ≥n,
p = m −n
2
⎫
⎪⎬
⎪⎭
(M.D.5)

Some results in the theory of Bessel functions
385
 +x
0
exp

−t2
Hn(t) dt = (Hn−1(0) −Hn−1(x)) exp

−x2
.
(M.D.6)
Laguerre polynomials Lv(x) are deﬁned by the equation (Rodrigues’ formula)
Lv(x) = 1
v! exp (x) dv
dxv

exp (−x) xv
.
The lowest-order polynomials are
L0 (x) = 1
L1 (x) = 1 −x
L2 (x) = 1 −2x + x2
2
L3 (x) =

6 −18x + 9x2 −x3
/6
L4 (x) =

24 −96x + 72x2 −16x3 + x4
/24
L5 (x) =

120 −600x + 600x2 −200x3 + 25x4 −x5
/120
L6 (x) =

720 −4320x + 5400x2 −2400x3 + 450x4 −36x5 + x6
/720.
The orthogonality of the Laguerre polynomials is easily seen by means of the
two relations
 ∞
0
exp(−x)Ln(x)Lm(x) = 0
 ∞
0
exp(−x)(Ln(x))2d(x) = 1.
Useful relations are
d
dx (Ln(x) −Ln+1(x)) = Ln(x)
(n + 1)Ln+1(x) = (2n + 1 −x)Ln(x) −nLn−1(x).
From Rodrigues’ formula, may be derived:
 ∞
0
exp(−x)xmLn(x)dx =
⎧
⎪⎨
⎪⎩
0
n > m
(−1)n(m!)2
n!(m −n)!
m ≥n
⎫
⎪⎬
⎪⎭
(M.D.7)
 x
0
exp(−t)Ln(t)dt = (Ln−1(x) −Ln(x)) exp(−x).
(M.D.8)
APPENDIX M.E
SOME RESULTS IN THE THEORY OF BESSEL
FUNCTIONS
M.E.1
Bessel functions
Bessel functions of the ﬁrst kind may be deﬁned via the Laurent expansion of
the generating function
exp
"1
2z
	
t −1
t

#
.

386
Appendices
The coefﬁcient of tn in the expansion is the Bessel coefﬁcient of argument z
and order n and it is denoted by Jn(z):
exp
" z
2
	
t −1
t

#
=
+∞

n=−∞
tnJn(z),
(M.E.1)
where
Jn(z) =
∞

m=0
(z/2)n+m
(n + m)!
(−z/2)m
m!
=
∞

m=0
(−1)m(z/2)n+2m
m!(n + m)!
.
(M.E.2)
In particular,
J0(z) = 1 −z2
22 +
z4
22 × 42 −
z6
22 × 42 × 62 + · · · ,
(M.E.3)
J1(z) = z
2 −
z3
22 × 4 +
z5
22 × 42 × 6 −
z7
22 × 42 × 62 × 8 + · · · .
(M.E.4)
Jn(z) is an even function of z when n is even, and is an odd function when n is
odd. Furthermore, J−n(z) = (−1)nJn(z).
In Fig. M.E.1, the function Jn(z) is shown for n = 0, 1, 2, 3.
0
2
Z
J3
J2
J1
J0
Jn(Z)
0.5
1
13
Fig. M.E.1
The functions Jn(z) for n = 0,1,2,3.
Equation (M.E.1) may be written in the form
exp
" z
2
	
t −1
t

#
= J0(z) +
∞

n=1
(
tn + (−1)nt−n)
Jn(z).
If t = ± exp(iθ), then the Jacobi expansion is obtained:
exp(±i z sinθ) = J0(z) + 2
∞

n=1
J2n(z) cos 2nθ
±2i
∞

n=0
J2n+1(z) sin (2n + 1)θ,
(M.E.5)
or
exp(iz cosθ) =
+∞

n=−∞
inJn(z) cos nθ.
(M.E.6)
Furthermore, if t = exp(−iθ) and the right- and left-hand sides of (M.E.1) are
multiplied by exp(inθ), we obtain
exp[i(nθ −z sin θ)] =
+∞

m=−∞
exp[i(n −m)θ]Jm(z).
When this relation is integrated from α to 2π + α, the only term in the right-
hand side which gives a non-zero contribution is that for which m = n. Then,
Jn(z) = 1
2π
 2π+α
α
exp[i(nθ −z sin θ)]dθ.
(M.E.7)

Some results in the theory of Bessel functions
387
When n = 0, (M.E.7) becomes
J0(z) = 1
2π
 2π+α
α
exp(−iz sin θ)dθ
= 1
2π
 2π+α
α
exp(−iz cos θ)dθ.
(M.E.8)
Further formulas which occur frequently in the main text are
in
π
 π
0
exp(−iz cos φ) cos n φ d φ = Jn(z)
(M.E.9)
 π
0
exp(−iz cos φ) sin n φ dφ = 0,
(M.E.10)
J0(Z2 + z2 −2Zz cos φ) 1/2 =
∞

m=0
εm Jm(Z)Jm(z) cos m φ ,
(M.E.11)
where εm is the Newmann factor which is deﬁned to be equal to 2 when n is
not zero and to be equal to 1 when n is zero;
 ∞
0
Jv(at) exp

−p2t2
tμ−1dt = 	((v + μ)/2)(a/2p)v
2pμ	(v + 1)
× exp
	−a2
4p2

1F1
	v −μ
2
+ 1; v + 1; a2
4p2

,
where Re(ν + μ) > 0. Equation (M.E.12) is the Weber–Sonine integral for-
mula, and 1F1 is the conﬂuent hypergeometric function deﬁned in Section
M.E.2. The integral is an expression in ﬁnite terms whenever μ −v is an even
positive integer.
Particular cases of (M.E.12) are
 ∞
0
Jn(at) exp

−p2t2
tn+1 dt =
a2

2p2n+1 exp
	−a2
4p2

,
(M.E.13)
 ∞
0
J0(at) exp
	
−1
2t2

tn−1 dt = 	(n/2)
21−n/2 exp
	
−a2
2

1F1
	
1 −n
2; 1; a2
2

,
(M.E.14)
 ∞
0
J1(at) exp
	
−1
2t2

tn−1d t = a2(n−3)/2	
	1 + n
2

exp
	
−a2
2

×1F1
	3 −n
2
; 2; a2
2

(M.E.15)
(expression of 1F1 for particular values of the parameters are given in Section
M.E.2)
1
2π
 ∞
0
 2π
0
exp

−p2t2 −iat cos φ

t dt dφ =
1
2p2 exp
	
−a2
4p2

.
(M.E.16)

388
Appendices
Equation (M.E.16) is readily delivered by combining (M.E.9) and (M.E.13).
Let us now consider the generating function
exp
"
i z
2
	
t −1
t

#
,
where z is a real number. If we expand exp(izt/2) and exp(−iz/2t) in a power
series, we obtain
exp
"
i z
2
	
t −1
t

#
=
+∞

n=−∞
intnIn(z),
where
In(z) =
∞

m=0
(z/2)n+2m
m!(n + m)!
(M.E.17)
are the modiﬁed Bessel functions of ﬁrst kind. In particular, for n = 1, 2,
I0(z) = 1 + z2
22 +
z4
22 × 42 +
z6
22 × 42 × 62 + · · · ,
(M.E.18)
I1(z) = z
2 +
z3
22 × 4 +
z5
22 × 42 × 6 +
z7
22 × 42 × 62 × 8 + · · · .
(M.E.19)
From (M.E.2) and (M.E.17) the following formulas arise:
I−n(z) = In(z),
d
dzI0(z) = I1(z),
In(−z) = (−1)nIn(z),
(M.E.20)
In(z) = i−nJn(iz),
I−n(z) = inJ−n(iz),
(M.E.21)
In+1(z) = In−1(z) −2n
z In(z).
(M.E.22)
I0, I1, and I2 are shown in Fig. M.E.2.
1
0
5
10
15
20
2
3
Z
In(Z)
I0
I1
I2
4
5
Fig. M.E.2
The functions In(z) for n = 0,1,2.
If we write z = ia and θ = π/2 −φ in (M.E.5), we obtain, because of
equations (M.E.21)
exp(α cos φ) = I0(α) + 2
∞

n=1
I2n(α) cos 2nφ + 2
∞

n=0
I2n+1(α) cos (2n + 1)φ,
(M.E.23)
In(z) = 1
2π (i)−n
 2π+α
α
exp[inθ + z sin θ] dθ = 1
2π
 2π+α
α
exp[inθ + z cos θ] dθ.
(M.E.24)
In particular, when n = 0,
I0(z) = 1
2π
 2π+α
α
exp(z sin θ) dθ
= 1
2π
 2π+α
α
exp(z cos θ) dθ.
(M.E.25)

Some results in the theory of Bessel functions
389
Further formulas of frequent occurrence in the main text are
1
π
 π
0
exp(z cos φ) cos n φ d φ = In(z),
(M.E.26)
 π
0
exp(−z cos φ) sin n φ d φ = 0,
(M.E.27)
I0

Z2 + z2 + 2Zz cos φ
1/2 =
+∞

m=−∞
Im(Z)Im(z) exp (imφ)
= I0(Z)I0(z) + 2
∞

m=1
Im(Z)Im(z) cos mφ,
(M.E.28)
 ∞
0
In(at) exp

−p2t2
tn+1dt =
an

2p2n+1 exp

a2/4p2
.
(M.E.29)
Successive differentiations of both sides of (M.E.29) with respect to p2 yield
expressions for
 ∞
0
In(at) exp

−p2t2
t2m+n+1dt,
m = 1, 2, . . . .
A further useful formula is
 ∞
0
Im(at) Im (bt) exp

−p2t2
t dt =
1
2p2 Im
	ab
2p2

exp
	a2 + b2
4p2

.
(M.E.30)
Successive differentiations of both sides of (M.E.30) with respect to p2 yield
formulae for  ∞
0
Im(at)Im(bt) exp

−p2t2
t2n+1dt, n = 1, 2, . . . .
Furthermore,
 ∞
0
Jm(at)Jm(bt) exp

−p2t2
tdt =
1
2p2 Im
	 ab
2p 2

exp
	
−a2 + b2
4p2

.
(M.E.31)
M.E.2
Generalized hypergeometric functions
The generalized hypergeometric function with p numerator and q denominator
parameters is deﬁned as
pFq(a1, a2, . . . , ap; b1, b2, . . . bq; z) =
∞

n=0
(a1)n(a2)n · · · (ap)n
(b1)n(b2)n · · · (bq)n
	zn
n!

,
where
(e)n = e(e + 1)(e + 2) · · · (e + n −1), (e)0 = 1.
In particular, the conﬂuent hypergeometric function
1F1(a; b; z) =
∞

n=0
(a)n
(b)n
	zn
n!


390
Appendices
is frequently used in the main text. If any one of the numerator parameters in
pFq is a negative integer then pFq is a polynomial of ﬁnite order. Special cases
of 1F1 are
1F1
	
0; 2; a2
2

= 1,
1F1
	
−1; 2; a2
2

= 1 −a2
4 ,
1F1
	
−2; 2; a2
2

= 1 −a2
2 + a4
24,
1F1
	
−3; 2; a2
2

= 1 −3
4a2 + a4
8 + a6
192,
1F1
	
0; 1; a2
2

= 1,
1F1
	
−1; 1; a2
2

= 1 −a2
2 ,
1F1
	
−2; 1; a2
2

= 1 −a2 + a4
8 ,
1F1
	
−3; 1; a2
2

= 1 −3
2a2 + 3
8a4 −1
24a6.
APPENDIX M.F
SOME DEFINITE INTEGRALS AND FORMUL AS
OF FREQUENT APPLICATION
1. It is well known that
 +∞
−∞
exp(−u2)du = √π.
If u = x√h/2, then
 +∞
−∞
exp
	
−1
2hu2

du =
*
2π/h.
(M.F.1)
2. If the derivative of (M.F.1) is taken with respect to h, then
 +∞
−∞
u2v exp
	1
2hu2

du = 1 × 3 × 5 × · · · × (2v −1)
hv+1/2
√
2π
= (2v)!
2vv!
√
2π
hv+1/2 .
(M.F.2)
3. The identity can then be stated by means of a suitable expansion in a power
series:

Some deﬁnite integrals and formulas of frequent application
391
 +∞
−∞
exp
	
itu −1
2hu2

du =
 +∞
−∞
∞

v=0
(itu)v
v!
exp
	
−1
2hu2

du.
The contributions of the terms with odd values of v vanish; thus
 ∞
−∞
exp
	
itu −1
2hu2

du =
∞

v=0
(it)v
v!
 +∞
−∞
uv exp
	
−1
2hu2

du
=
∞

v=0
(it)2v
2v!
(2v)!
2vv!
√
2π
hv+1/2
=

2π
h exp(−t2/2h).
(M.F.3)
By analogy,
 +∞
−∞
exp
	
±tu −1
2hu2

du =

2π
h exp
	 t2
2h

.
(M.F.3′)
4. Let us consider the integral
1
2π
 +∞
−∞
(iu)v exp
	
−1
2u2

exp(−iut)du.
(M.F.4)
Since
(iu)v exp(−iut) = (−1)v dv
dtv exp(−iut),
(M.F.4) may be estimated:
(−1)v
2π
dv
dtv
 +∞
−∞
exp
	
−1
2u2

exp(−itu)du = (−1)v
2π
dv
dtv
√
2π exp

−t2/2

= (−1)v
√
2π
dv
dtv exp

−t2/2

.
Because of (M.D.1) we have
1
2
 +∞
−∞
(iu)v exp
	
−1
2u2

exp(−iut)du = Hv(t)
1
√
2π
exp
	
−1
2t2

.
(M.F.5)
We will prove that
 +∞
−∞
. . .
 +∞
−∞
exp(i ˜TU) exp
	
−1
2
˜UλU

dU = (2π)n/2
√
λ
exp
	
−1
2
˜Tλ−1T

,
(M.F.6)
where ˜U = (u1, u2, . . . , un) and ˜T = (t1, t2, . . . , tn) are real vectors in n
dimensions, λis the determinant of the symmetric matrix λ, and λ−1is the
matrix’s inverse. The tilde (∼) indicates the transpose of a matrix.

392
Appendices
In a more explicit form, (M.F.6) may be written as
 +∞
−∞
. . .
 +∞
−∞
exp
⎛
⎝i
n

j=1
tjuj
⎞
⎠exp
"
−1
2Q (u1, u2, . . . un)
#
du1du2 . . . dun
= (2π)n/2
√
λ
exp
"
−1
2Q−1(t1, t2, . . . , tn)
#
,
(M.F.6′)
where Q is the quadratic positive form corresponding to λ and Q−1 =
˜Tλ−1T is its reciprocal form. When n = 1, (M.F.6) and (M.F.6’) coincide
with (M.F.3).
Since λ is a symmetric matrix, it is always possible to ﬁnd an orthogonal
matrix C such that ˜CλC = K is a diagonal matrix with principal elements
that are the eigenvalues λj of λ. Let us now introduce in (M.F.6) the two
new variables
˜x = (x1, x2, . . . , xn)
and
˜y = (y1, y2, . . . , yn),
deﬁned by T = Cx and y = ˜CU. Then ˜TU = ˜xy. Since C = ±1, the left-
hand side of (M.F.6) becomes
 +∞
−∞
. . .
 +∞
−∞
exp(i˜xy) exp
	
−1
2 ˜yKy

dy =
n
/
j=1
 +∞
−∞
exp

ixjyj

exp
	
−1
2λjy2
j

dyj.
(M.F.7)
Applying (M.F.3) to every term of the product and remembering that the
diagonal matrix with principal elements 1/λj coincides with K−1, we have
 +∞
−∞
. . .
 +∞
−∞
exp(i ˜TU) exp
	
−1
2
˜UλU

dU =
(2π)n/2
√λ1λ2 · · · λn
exp
⎡
⎣−1
2
n

j=1

x2
j
λj
⎤
⎦
= (2π)n/2
√
λ
exp
	
−1
2 ˜xK−1x

.
and, since
˜xK−1x = ˜xC−1λ−1 ˜C
−1x = ˜x ˜Cλ−1Cx = ˜Tλ−1T.
(M.F.6) is proved.
6. In the main text, the evaluation of integrals such as
1
2π
 2π
0
exp

i

k
Ck cos(φ + αk)

dφ
is frequently performed. For real Ck application of elementary trigonomet-
ric rules leads to

k
Ck cos(φ + αk) = Z cos(φ + ξ),
(M.F.8)
where
Z2 =

k
Ck cos αk
2
+

k
Ck sin αk
2
=

k,l
CkCl cos(αk −αi),
Z cos ξ =

k
Ck cos αk,
Z sin ξ =

k
Ck sin αk.

Some deﬁnite integrals and formulas of frequent application
393
Z and ξare independent of φ, so that, according to (M.F.8)
1
2π
 2π
0
exp
4
i

k
Ck cos(φ + αk)
5
dφ = J0(Z).
(M.F.9)
7.
 2π
0
cos(τ −s) exp{−it[a cos(q −τ) −b cos(r −τ)]}dτ
= ( −2πi)J1(tQ)
Q

a cos(q −s) −b cos(r −s)

,
(M.F.10)
where
Q2 = a2 + b2 −2ab cos(q −r).
8.
 ∞
0
t2J1(Qt) exp
	
−p2t2
2

dt = Q
p4 exp
	
−Q2
2p2

.
(M.F.11)
9.
 ∞
0
t exp
	
−1
2p2t2

dt
 2π
0
exp{−it[a cos(q −τ)
−b cos(r −τ)]}dτ = 2π
p2 exp
	
−Q2
2p2

(M.F.12)
10.
 ∞
0
t2 exp
	
−1
2p2t2

dt
 2π
0
cos(s −τ)
× exp{−it[a cos(q −τ) −b cos(r −τ)]}dτ =
	
−2πi
p4

[a cos(q −s)
−b cos(r −s)] exp
	
−Q2
2p2

.
(M.F.13)
11.
 ∞
0
t3 exp
	
−1
2p2t2

dt
 2π
0
exp{−it[a cos(q −τ) −b cos(r −τ)]}dτ
=
	4π
p4

exp
	
−Q2
2p2

 	
1 −Q2
2p2

.
(M.F.14)
12.
 ∞
0
xμ exp(−ax2)I0(qx)dx = 	[(μ + 1)/2]/(2a(μ+1)/2)
×1F1[(−μ + 1)/2; 1; −q2/4a] exp(q2/4a)
(M.F.15)
Where 	 is the gamma function and 1F1 is the conﬂuent hypergeometric
function.

References
Abrahams, J. P. (1997). Acta Crystallogr., D53, p. 371.
Abrahams, J. P. and Leslie, A. G. W. (1996). Acta Crystallogr., D52, p. 30.
Abramowitz, M. and Stegun, I. A. (1972). Handbook of Mathematical Functions.
Dover.
Adams, P. D., Grosse-Kunstleve, R. W., Hung, L. W. et al. (2002). Acta Crystallogr.
D58, p. 1948.
Allegra, G. (1965). Acta Crystallogr., 19, p. 949.
Allegra, G. and Colombo, A. (1974). Acta Crystallogr., A30, p. 727.
Altomare, A., Belviso, B. D., Burla, M. C., Campi, G., Cuocci, C., Giacovazzo, C.,
Gozzo, F., Moliterni, A., Polidori, G., and Rizzi, R. (2009e). J. Appl. Crystallogr.,
42, p. 30.
Altomare, A., Burla, M. C., Cascarano, G., Giacovazzo, C., Guagliardi, A., Moliterni,
A. G. G., and Polidori, G. (1996). J. Appl. Crystallogr., 29, p. 341.
Altomare, A., Burla, M. C., Cuocci, C., Giacovazzo, C., Gozzo, F., Moliterni, A.,
Polidori, G., and Rizzi, R. (2009d). Acta Crystallogr., A65, p. 291.
Altomare, A., Caliandro, R., Camalli, M., Cuocci, C., da Silva, I., Giacovazzo, C.,
Moliterni, A. G. G., and Spagna, R. (2004). J. Appl. Crystallogr., 37, p. 957.
Altomare, A., Caliandro, R., Giacovazzo, C., Moliterni, A. G. G., and Rizzi, R. (2003).
J. Appl. Crystallogr., 36, p. 230.
Altomare, A., Camalli, M., Cuocci, C., da Silva, I., Giacovazzo, C., Moliterni, A. G.
G., and Rizzi, R. (2005). J. Appl. Crystallogr., 38, p. 760.
Altomare, A., Camalli, C., Cuocci, C., Giacovazzo, C., Moliterni, A., and Rizzi, R.
(2009a). J. Appl. Crystallogr., 42, p. 1197.
Altomare, A., Camalli, M., Cuocci, C., Giacovazzo, C., Moliterni, A. G. G., and Rizzi,
R. (2007). J. Appl. Crystallogr., 40, p. 743.
Altomare, A., Campi, G., Cuocci, C., Eriksson, L., Giacovazzo, C., Maggi, S.,
Moliterni, A., Rizzi, R., and Werner, P.-E. (2009b). J. Appl. Crystallogr., 42,
p. 768.
Altomare, A., Cascarano, G., Giacovazzo, C., and Guagliardi, A. (1994a). J. Appl.
Crystallogr., 27, p. 1045.
Altomare, A., Cascarano, G., Giacovazzo, C., Guagliardi, A., Moliterni, A. G. G.,
Burla, M. C., and Polidori, G. (1995). J. Appl. Crystallogr., 28, p. 738.
Altomare, A., Cascarano, G., Giacovazzo, C., and Viterbo, D. (1991). Acta Crystallogr.,
A47, p. 744.
Altomare, A., Cuocci, C., Giacovazzo, C., Moliterni, A., and Rizzi, R. (20121). J. Appl.
Crystallogr. 45, p. 789.
Altomare, A., Cuocci, C., Giacovazzo, C., Kamel, G. S., Moliterni, A., and Rizzi, R.
(2008a). Acta Crystallogr., A64, p. 326.
Altomare, A., Cuocci, C., Giacovazzo, C., Moliterni, A., and Rizzi, R. (2008b). J. Appl.
Crystallogr., 41, p. 592.
Altomare, A., Cuocci, C., Giacovazzo, C., Moliterni, A., and Rizzi, R. (2009c). Acta
Crystallogr., A65, p. 183.
Altomare, A., Cuocci, C., Giacovazzo, C., Moliterni, A., and Rizzi, R. (2010). J. Appl.
Crystallogr., 43, p. 798.
Altomare, A., Cuocci, C., Giacovazzo, C., Moliterni, A. G. G., and Rizzi, R. (2006). J.
Appl. Crystallogr., 39, p. 558.
Altomare, A., Cuocci, C., Giacovazzo, C., Moliterni, A., and Rizzi, R. (2012a). Acta
Crystallogr., A68, p. 244.

References
395
Altomare, A., Cuocci, C., Moliterni, A., and Rizzi, R. (2013). J. Appl. Crystallogr., 46,
p. 476.
Altomare, A., Foadi, J., Giacovazzo, C., Moliterni, A. G. G., Burla, M. C., and Polidori,
G. (1998). J. Appl. Crystallogr., 31, p. 74.
Altomare, A., Giacovazzo, C., Guagliardi, A., and Siliqi, D. (1994b). Acta Crystallogr.,
A50, p. 311.
Altomare, A., Giacovazzo, C., Guagliardi, A., Moliterni, A. G. G., and Rizzi, R.
(2000b). J. Appl. Crystallogr., 33, p. 1305.
Altomare, A., Giacovazzo, C., Guagliardi, A., Moliterni, A. G. G., Rizzi, R., and
Werner, P.-E. (2000a). J. Appl. Crystallogr., 33, p. 1180.
Altschul, S. F., Madden, T. L., Schaffer, A. A., Zhang, J., Zhang, Z., Miller, W., and
Lipman, D. J. (1997). Nucleic Acids Res., 25, p. 3389.
Andreev, Y. G., Lightfoot, P., and Bruce, P. G. (1997). J. Appl. Crystallogr., 30, p. 294.
Ardito, G., Cascarano, G., Giacovazzo, C., and Luic, M. (1985). Z. Kristallogr., 172,
p. 25.
Baerlocher, C. (1982). The X-Ray Rietveld System. Institut für Kristallographie und
Petrographie, Zürich.
Baerlocher, Ch., Gramm, F., Massüger, L., McCusker, L. B., He, Z., Hovmöller, S., and
Zou, X. (2007a). Science, 315, p. 1113,
Baerlocher, Ch., McCusker, L. B., and Palatinus, L. (2007b). Z. Kristallogr., 222, p. 47.
Baerlocher, Ch., McCusker, L. B., Prokic, S., and Wessels, T. (2004). Z. Kristallog.,
219, p. 802.
Baggio, R., Woolfson, M. M., Declercq, J. P., and Germain, G. (1978). Acta
Crystallogr., A34, p. 883.
Baker, D., Bystroff, C., Fletterick, R. J., and Agard, D. A. (1993). Acta Crystallogr.,
D49, p. 429.
Bart, J. C. J. and Busetti, A. (1976). Acta Crystallogr., A32, p. 927.
Beevers, C. A. and Robertson, J. H. (1950). Acta Crystallogr., 4, p. 531.
Bentley, G. A. and Houdusse, A. (1992). Acta Crystallogr., A48, p. 312.
Bergamaschi, A., Cervellino, A., Dinapoli, R., Gozzo, F., Henrich, B., Johnson, I.,
Kraft, P., Mozzanica, A., Schmitt, B., and Shi, X. (2010). J. Synchrotron Rad., 17,
p. 653.
Bernstein, S. (1927). Math. Ann., 97, p. 1.
Bertaut, E. F. (1955a). Acta Crystallogr., 8, p. 537.
Bertaut, E. F. (1955b). Acta Crystallogr., 8, p. 544.
Bertaut, E. F. (1960a). Acta Crystallogr., 13, p. 546.
Bertaut, E. F. (1960b). Acta Crystallogr., 13, p. 643.
Beurskens, P. T., Gould, R. O., Bruins Slot, H. J., and Bosman, W. P. (1987).
Z. Kristallogr., 179, p. 127.
Beurskens, P. T., Beurskens, G., Gelder, R., de Garcia-Granda, S., Gould, R. O.,
and Smits, J. M. M. (2008). The DIRDIF2008 program system, Crystallography
Laboratory, University of Nijmegen, The Netherlands.
Beurskens, P. T. and Noordik, J. H. (1971). Acta Crystallogr., A27, p. 187.
Beurskens, P. T., van der Hark, Th. E.M., and Beurskens, G. (1976). Acta Crystallogr.,
A32, p. 821.
Bhat, T. N. (1990). Acta Crystallogr., A46, p. 735.
Bhat, T. N. and Blow, D. M. (1982). Acta Crystallogr., A38, p. 21.
Black, P. J. and Corby, R. N. (1975). In Anomalous Scattering (ed. S. Ramaseshan and
S. C. Abrahams). Munksgaard, Copenhagen.
Blessing, R. H. (1997). J. Appl. Crystallogr., 30, p. 176.
Blessing, R. H. and Smith, G. D. (1999). J. Appl. Cryst., 32, p. 664.
Blow, D. M. (1957). X-ray analysis of haemoglobin: determination of phase angles by
isomorphous substitution. PhD Thesis, Univ. of Cambridge.
Blow, D. M. (1958). Proc. R. Soc., A247, p. 302.
Blow, D. M. (1985). In Molecular Replacement (ed. P. A. Machin). Proceedings of the
Daresbury Study Weekend.
Blow, D. M. and Crick, F. H. C. (1959). Acta Crystallogr., 12, p. 794.

396
References
Blundell, T. L. and Johnson, L. N. (1976). Protein Crystallography. Academic, London.
Böhme, R. (1982). Acta Crystallogr., A38, p. 316.
Böhme, R. (1983). Z. Naturf., 38, p. 304.
Booth, A. D. (1945). Philos. Mag., 36, p. 609.
Booth, A. D. (1946). Proc. Roy. Soc., A188, p. 77.
Booth, A. D. (1947). Proc. Roy. Soc., A190, p. 482.
Boultif, A. and Louër, D. (1991). J. Appl. Crystallogr., 24, p. 987.
Boutselakis, H. et al. (2003). Nucleic Acids Res., 31, p. 458.
Bragg, W. L. and Perutz, M. F. (1954). Proc. R. Soc., 225, p. 315.
Bragg, W. L. and West, J. (1930). Phil Mag., 10, p. 823.
Braun, P. B., Hornstra, J., and Leenhouts, J. I. (1969). Philips Res. Rep., 24, p. 85.
Bricogne, G. (1974). Acta Crystallogr., A30, p. 395.
Bricogne, G. (1976). Acta Crystallogr., A32, p. 832.
Bricogne, G. (1984). Acta Crystallogr., A40, p. 410.
Bricogne, G. (1988a). Acta Crystallogr., A44, p. 517.
Bricogne, G. (1988b). In Crystallographic Computing 4: Techniques and New
Technologies (ed. N. W. Isaacs and M. R. Taylor). Oxford University Press,
New York.
Bricogne, G. (1991). Acta Crystallogr., A47, p. 803.
Bricogne, G., Vonrhein, C., Flensburg, C., Schiltz, M., and Paciorek, W. (2003). Acta
Crystallogr., D59, p. 2023.
Brunelli, M., Wright, J. P., Vaughan, G. R. M., Mora, A. J., and Fitch, A. (2003). Angew.
Chem. Int. Ed., 42, p. 2029.
Brünger, A. T., Adams, P. D., Clore, G. M., DeLano, W. L., Gros, P., Grosse-Kunstleve,
R. W., Jiang, J.-S., Kuszewski, J., Nilges, M., Pannu, N. S., Read, R. J., Rice, L. M.,
Simonson, T., and Warren, G. L. (1998). Acta Crystallogr., D54, p. 905.
Buerger, M. J. (1942). X-Ray Crystallography. Wiley, New York.
Buerger, M. J. (1946). J. Appl. Phys., 17, p. 579.
Buerger, M. J. (1951). Acta Crystallogr., 4, p. 531.
Buerger, M. J. (1953). Proc. Natl. Acad. Sci. USA, 39, p. 674.
Buerger, M. J. (1956). Proc. Natl. Acad. Sci. USA, 42, p. 776.
Buerger, M. J. (1959). Vector Space and its Application in Crystal Structure
Investigation. Wiley, New York.
Buerger, M. J. (1969). In Physics of the Solid State. Academic, London.
Bullough, R. K. (1961). Acta Crystallogr., 14, p. 257.
Bullough, R. K. (1964). Acta Crystallogr., 17, p. 295.
Bunge, H. J., Dahms, M., and Brokmeier, H. G. (1989). Crystallogr. Rev., 2, p. 67.
Burdina, R. A. (1973). Kristallograﬁya, 18, p. 694.
Burgi, H. B. and Dunitz, J. D. (1971). Acta Crystallogr., A27, p. 117.
Burla, M. C., Caliandro, R., Camalli, M., Carrozzini, B., Cascarano, G. L., De Caro,
L., Giacovazzo, C., Polidori, G., Siliqi, D., and Spagna, R. (2007c). J. Appl.
Crystallogr., 40, p. 609.
Burla, M. C., Caliandro, R., Carrozzini, B., Cascarano, G. L., De Caro, L., Giacovazzo,
C., Polidori, G., and Siliqi, D. (2007b). J. Appl. Crystallogr., 40, p. 211.
Burla, M. C., Caliandro, R., Carrozzini, B., Cascarano, G. L., De Caro, L., Giacovazzo,
C., Polidori, G., and Siliqi, D. (2006a). J. Appl. Crystallogr., 39, p. 728.
Burla, M. C., Caliandro, R., Carrozzini, B., Cascarano, G. L., De Caro, L., Giacovazzo,
C., Polidori, G., and Siliqi, D. (2006b). J. Appl. Crystallogr., 39, p. 527.
Burla, M. C., Caliandro, R., Carrozzini, B., Cascarano, G. L., De Caro, L., Giacovazzo,
C., Polidori, G., and Siliqi, D. (2007a). J. Appl. Crystallogr., 40, p. 834.
Burla, M. C., Caliandro, R., Giacovazzo, C., and Polidori, G. (2010a). Acta
Crystallogr., A66, p. 347.
Burla, M. C., Caliandro, R., Camalli, M., Carrozzini, B., Cascarano, G. L., Giacovazzo,
C., Mallamo, M., Mazzone, A., Polidori, G., and Spagna, R. (2012a). J. Appl.
Crystallogr., 45, p. 357.
Burla, M. C., Camalli, M., Cascarano, G., Giacovazzo, C., Polidori, G., Spagna, R., and
Viterbo, D. (1989a). J. Appl. Crystallogr., 22, p. 389.

References
397
Burla, M. C., Camalli, M., Carrozzini, B., Cascarano, G. L., Giacovazzo, C., Polidori,
G., and Spagna, R. (2001). J. Appl. Crystallogr., 34, p. 523.
Burla, M. C., Carrozzini, B., Caliandro, R., Cascarano, G. L., De Caro, L., Giacovazzo,
C., and Polidori, G. (2003a). Acta Crystallogr., A59, p. 245.
Burla, M. C., Carrozzini, B., Cascarano, G. L., Giacovazzo, C., and Polidori, G. (2000).
J. Appl. Crystallogr., 33, p. 307.
Burla, M. C., Carrozzini, B., Cascarano, G. L., Giacovazzo, C., and Polidori, G.
(2011b). Acta Crystallogr., A44, p. 1143.
Burla, M. C., Carrozzini, B., Cascarano, G. L., Giacovazzo, C., and Polidori, G.
(2011c). J. Appl. Crystallogr., A67, p. 447.
Burla, M. C., Carrozzini, B., Cascarano, G. L., Comunale, G., Giacovazzo, C.,
Mazzone, A., and Polidori, G. (2012b). Acta Crystallogr., A68, p. 513.
Burla, M. C., Carrozzini, B., Cascarano, G. L., Giacovazzo, C., and Polidori, G.
(2003b). Acta Crystallogr., D59, p. 662.
Burla, M. C., Carrozzini, B., Cascarano, G. L., Giacovazzo, C., Moustiakimov, M.,
Polidori, G., and Siliqi, D. (2004). Acta Crystallogr., D60, p. 1683.
Burla, M. C., Carrozzini, B., Cascarano, G. L., Giacovazzo, C., Polidori, G., and Siliqi,
D. (2002). Acta Crystallogr., D58, p. 928.
Burla, M. C., Cascarano, G., Fares, V., Giacovazzo, C., Polidori, G., and Spagna, R.
(1989b). Acta Crystallogr., A45, p. 781.
Burla, M. C., Cascarano, G., Giacovazzo, C., and Guagliardi, A. (1992). Acta
Crystallogr., A48, p. 906.
Burla, M. C., Giacovazzo, C., and Polidori, G. (2011a). J. Appl. Crystallogr., 44, p. 193.
Burla, M. C., Giacovazzo, C., and Polidori, G. (2010b). J. Appl. Crystallogr., 43, p. 825.
Burla, M. C., Polidori, G., Nunzi, A, Cascarano, G., and Giacovazzo, C. (1977). Acta
Crystallogr., A33, p. 949.
Bystroff, C., Baker, D., Fletterick, R. J., and Argard, D. A. (1993). Acta Crystallogr.,
D49, p. 440.
Caliandro, R., Carrozzini, B., Cascarano, G. L., Comunale, G., and Giacovazzo, C.
(2013). Acta Crystallogr., A69, p. 98.
Caliandro, R., Carrozzini, B., Cascarano, G. L., De Caro, L., Giacovazzo, C., and Siliqi,
D. (2008b). Acta Crystallogr., A64, p. 519.
Caliandro, R., Carrozzini, B., Cascarano, G. L., De Caro, L., Giacovazzo, C., Mazzone,
A. M., and Siliqi, D. (2006). J. Appl. Crystallogr., 39, p. 185.
Caliandro, R., Carrozzini, B., Cascarano, G. L., De Caro, L., Giacovazzo, C.,
Moustiakimov, M., and Siliqi, D. (2005c). Acta Crystallogr., A61, p. 343.
Caliandro, R., Carrozzini, B., Cascarano, G. L., De Caro, L., Giacovazzo, C., Mazzone,
A., and Siliqi, D. (2008a). J. Appl. Crystallogr., 41, p. 548.
Caliandro, R., Carrozzini, B., Cascarano, G. L., De Caro, L., Giacovazzo, C., and Siliqi,
D. (2007a). J. Appl. Crystallogr., 40, p. 883.
Caliandro, R., Carrozzini, B., Cascarano, G. L., De Caro, L., Giacovazzo, C., and Siliqi,
D. (2005a). Acta Crystallogr., D61, p. 556.
Caliandro, R., Carrozzini, B., Cascarano, G. L., De Caro, L., Giacovazzo, C., and Siliqi,
D. (2005b). Acta Crystallogr., D61, p. 1080.
Caliandro, R., Carrozzini, B., Cascarano, G. L., De Caro, L., Giacovazzo, C., and Siliqi,
D. (2007b). J. Appl. Crystallogr., 40, p. 931.
Caliandro, R., Carrozzini, B., Cascarano, G. L., Giacovazzo, C., Mazzone, A., and
Siliqi, D. (2009). Acta Crystallogr., A65, p. 512.
Camalli, M., Carrozzini, B., Cascarano, G. L. and Giacovazzo, C. (2012). J. Appl.
Crystallogr., 45, p. 351.
Carrozzini, B., Cascarano, G. L., and Giacovazzo, C. (2010). J. Appl. Crystallogr., 43,
p. 221.
Carrozzini, B., Cascarano, G. L., Comunale, G., Giacovazzo, C., and Mazzone, A.
(2013a). Acta Crystallogr., D69, p. 1038.
Carrozzini, B., Cascarano, G. L., Giacovazzo, C., and Mazzone, A. (2013b). Acta
Crystallogr., A69, p. 408.
Cascarano, G., Favia, L., and Giacovazzo, C. (1992c). J. Appl. Crystallogr., 25, p. 310.

398
References
Cascarano, G. and Giacovazzo, C. (1995). Acta Crystallogr., A51, p. 820.
Cascarano, G., Giacovazzo, C., Camalli, M., Spagna, R., Burla, M. C., Nunzi, A., and
Polidori, G. (1984). Acta Crystallogr., A40, p. 278.
Cascarano, G., Giacovazzo, C., and Guagliardi, A. (1991). Acta Crystallogr., A47,
p. 698.
Cascarano, G., Giacovazzo, C., and Guagliardi, A. (1992a). Acta Crystallogr., A48,
p. 859.
Cascarano, G., Giacovazzo, C., and Guagliardi, A. (1992b). Z. Kristallogr., 200, p. 63.
Cascarano, G., Giacovazzo, C., and Lui´c, M. (1985a). In Structure and Statistics in
Crystallography, (ed. A. J. C. Wilson). Adenine Press, New York.
Cascarano, G., Giacovazzo, C., and Lui´c, M. (1985b). Acta Crystallogr., A41, p. 544.
Cascarano, G., Giacovazzo, C., and Lui´c, M. (1987b). Acta Crystallogr., A43, p. 14.
Cascarano, G., Giacovazzo, C., and Lui´c, M. (1988a). Acta Crystallogr., A44, p. 176.
Cascarano, G., Giacovazzo, C., and Lui´c, M. (1988b). Acta Crystallogr., A44, p. 183.
Cascarano, G., Giacovazzo, C., Lui´c, M., Pifferi, G., and Spagna, R. (1987c).
Z. Kristallogr., 179, p. 113.
Cascarano, G., Giacovazzo, C., and Viterbo, D. (1987a). Acta Crystallogr., A43, p. 22.
Chang. G. and Lewis. M. (1997). Acta Crystallogr., D53, p. 279.
Chapuis, G., Templeton, D. H., and Templeton, L. K. (1985). Acta Crystallogr., A41,
p. 274.
Cheary, R. W. and Coelho, A. (1992). J. Appl. Crystallogr., 25, p. 109.
Chen, Y. W., Dodson, E. J. and Kleiywegt, G. J. (2000). Structure, 8, R213.
Chernishev, V. V. and Schenk, H. (1998). Z. Kristallogr., 213, p. 1.
Chothia, C. and Lesk, A. (1986). EMBO J., 5(4), p. 823.
Cianci, M., Helliwell, J. R., and Suzuki, A. (2008). Acta Crystallogr., D64, p. 1196.
Clastre, J. and Gray, R. (1950). Compt. Rend., 230, p. 1876.
Cochran, W. (1951). Acta Crystallogr., 4, p. 408.
Cochran, W. (1952). Acta Crystallogr., 5, p. 65.
Cochran, W. (1955). Acta Crystallogr., 8, p. 473.
Cochran, W. and Douglas, A. S. (1957). Proc. R. Soc., A243, p. 281.
Cochran, W. and Woolfson, M. M. (1955). Acta Crystallogr., 8, p. 1.
Coelho, A. A. (2003). TOPAS version 3.1. Bruker AXS GmbH, Karlsruhe, Germany.
Collings, I., Watier, Y., Giffard, M., Dagogo, S., Kahn, R., Bonneté, F., Wright, J. P.,
Fitch, A. N., and Margiolaki, I. (2010). Acta Crystallogr., D66, p. 539.
Collins, D. M., Konnert, J. H., and Stewart, J. M. (1996). Proc. Macromolecular
Crystallography Computing School, Western Washington University (ed. P. Bourne
and K. Watenpaugh).
Cooley, J. W. and Tukey, J. W. (1965). Math. Comput., 19, p. 297.
Coppens, P. and Hamilton, W. C. (1968). Acta Crystallogr., B24, p. 925.
Corby, R. N. and Black, P. J. (1973). Acta Crystallogr., B29, p. 2669.
Coulter, C. L. and Dewar, R. B. K. (1971). Acta Crystallogr., B27, p. 1730.
Courbion, G. and Ferey, G. (1988). J. Solid State Chem., 76, p. 426.
Cowley, J. M. (1992). Electron Diffraction Techniques, Vols 1 and 2. Oxford University
Press.
Cowley, J. M. (1953a). Acta Crystallogr., 6, p. 516.
Cowley, J. M. (1953b). Acta Crystallogr., 6, p. 522.
Cowley, J. M. (1953c). Acta Crystallogr., 6, p. 846.
Cowley, J. M. (1955). Acta Crystallogr., 9, p. 391.
Cowley, J. M. (1961). Acta Crystallogr., 14, p. 920.
Cowley, J. M. and Goswami, A. (1961). Acta Crystallogr., 14, p. 1071.
Cowley, J. M. and Moodie, A. F. (1957). Acta Crystallogr., 10, p. 609.
Cowtan, K. D. (1994). Joint CCP4 and ESF-EACBM Newsletter on Protein
Crystallography, 31, p. 34.
Cowtan, K. (1998). Acta Crystallogr., D54, p. 750.
Cowtan, K. D. (1999). Acta Crystallogr., D55, p. 1555.
Cowtan, K. D. (2001). Acta Crystallogr., D57, p. 1435.
Cowtan, K. D. (2006). Acta Crystallogr., D62, p. 1002.

References
399
Cowtan, K. (2008). Acta Crystallogr., D64, p. 83.
Cowtan, K. (2012). Acta Crystallogr., D68, p. 328.
Cramér, H. (1951). Mathematical Methods of Statistics. Princeton University Press.
Cranswick, M. D. (2008). Computer software for powder diffraction. In Powder
Diffraction: Theory and Practice. Eds: R. E. Dinnebier and S. J. L. Billinge, RSC
Publishing.
Crick, F. H. C. and Magdoff, B. S. (1956). Acta Crystallogr., 9, p. 901.
Crowther, R. A. (1969). Acta Crystallogr., B25, p. 2571.
Crowther, R. A. (1972). In The Molecular Replacement Method (ed. M. G. Rossmann).
Gordon & Breach, New York.
Cruickshank, D. W. J. (1949). Acta Crystallogr., 2, p. 65.
Cruickshank, D. W. J. and Rollett, J. S. (1953). Acta Crystallogr., 6, p. 705.
Cutﬁeld, J. F., Dodson, E. J., Dodson, G. G., Hodgkin, D. C., Isaacs, N. W., Sakabe, K.,
and Sakabe, N. (1975). Acta Crystallogr., A31, S21.
Dauter, Z., Dauter, M., and Dodson, E. D. (2002). Acta Crystallogr., D58, p. 496.
Dauter, Z., Li, M., and Wlodawer, A. (2001). Acta Crystallogr., D57, p. 239.
David, P. R. and Subbiah, S. (1994). Acta Crystallogr., D50, p. 132.
David, W. I. F. (1987). J. Appl. Crystallogr., 20, p. 316.
David, W. I. F., Shankland, K., Cole, J., Maginn, S., Motherwell, W. D. S., and
Taylor, R. (2001). DASH User Manual, Cambridge Crystallographic Data Centre,
Cambridge, UK.
Davis, I. W., Leaver-Fay, A., Chen, V. B., Block, J. N., Kapral, G. J., Wang, X., Murray,
L. W., Arendall, W. B. III, Snoeyink, J., Richardson, J. S., and Richardson, D. C.
(2007), Nucleic Acids Res., 35, p. W375.
de la Fortelle, E. and Bricogne, G. (1997). Methods Enzymol., 276, p. 472.
Debaerdemaeker, T., Tate, C., and Woolfson, M. M. (1985). Acta Crystallogr., A41,
p. 286.
Debaerdemaeker, T., Tate, C., and Woolfson, M. M. (1988). Acta Crystallogr., A44,
p. 353.
Debaerdemaeker, T. and Woolfson, M. M. (1975). Acta Crystallogr., A31, p. 401.
Debaerdemaeker, T. and Woolfson, M. M. (1983). Acta Crystallogr., A39, p. 193.
Debaerdemaeker, T. and Woolfson, M. M. (1989). Acta Crystallogr., A45, p. 349.
de Bruijn, N. G. (1970). Asymptotic Methods in Analysis. North-Holland, Amsterdam.
Debye, P. (1909). Math. Ann., 67, p. 535.
Declercq, J. P., Germain, G., Main, P., and Woolfson, M. M. (1973). Acta Crystallogr.,
A29, p. 231.
Declercq, J. P., Germain, G., and Woolfson, M. M. (1975). Acta Crystallogr., A31,
p. 367.
Declercq, J. P., Germain, G., and Woolfson, M. M. (1979). Acta Crystallogr., A35,
p. 622.
de Gelder, R. (1992). Thesis. University of Leiden.
de Gelder, R., de Graaf, A. G., and Schenk, K. H. (1990). Acta Crystallogr., A46,
p. 688.
Delarue, M. (2008). Acta Crystallogr., D64, p. 40.
de Rango, C., Tsoucaris, G., and Zelwar, C. (1969). C.R. Acad. Sci., Paris, 268, p. 1090.
de Rango, C., Tsoucaris, G., and Zelwar, C. (1974). Acta Crystallogr., A30, p. 342.
de Rosier, D. and Klug, A. (1968). Nature, London, 217, p. 130.
de Titta, G. T., Edmonds, J. W., Langs, D. A., and Hauptman, H. A. (1975). Acta
Crystallogr., A31, p. 472.
de Titta, G. T., Weeks, C. M., Thuman, P., Miller, R., and Hauptman, H. A. (1994). Acta
Crystallogr., A50, p. 203.
de Wolff, P. M. (1961). Acta Crystallogr., 14, p. 579.
Destro, R. (1972). CECAM Workshop Reports.
Dickerson, R. F., Kendrew, J. C., and Standberg, B. E. (1961). Acta Crystallogr., 14,
p. 1188.
Dickerson, R. E., Weinzierl, J. E., and Palmer, R. A. (1968). Acta Crystallogr., B24,
p. 997.

400
References
DiMaio, F., Terwilliger, T. C., Read, R. J., Wlodawer, A., Oberdorfer, G., Wagner, U.,
Valkov, E., Alon, A., Fass, D., Axelrod, H. L., Das, D., Vorobiev, S. M., Iwai, H.,
Pokkuluri, P. R. & Becker, D. (2011). Nature, 473, 540.
Dodson, E. J. and Vijayan, M. (1971). Acta Crystallogr., B27, 2402.
Dong, W., Baird, T., Fryer, J. R., Gilmore, C., McNicol, D. D., Bricogne, G., Smith,
D. J., O’Keefe, M. A., and Hovmöller, S. (1992). Nature, 355, p. 605.
Donnay, J. D. H. and Kennard, O. (1964). Acta Crystallogr., 17, p. 1337.
Dorset, D. L., Jap, B. K., Ho, M. S., and Glaeser, R. M. (1979). Acta Crystallogr., A35,
p. 1001.
Dorset, D. L. (1995). Structural Electron Crystallography. Plenum, New York.
Dorset, D. L. (1996). Acta Crystallogr., A52, p. 480.
Doyle, P. A. and Turner, P. S. (1968). Acta Crystallogr., A24, p. 390.
Drendel, W. B., Dave, R. D., and Jain, S. (1995). Proc. Natl. Acad. Sci., USA, 92, p. 547.
Dumas, C. and van der Lee, A. (2008). Acta Crystallogr. D64, p. 864.
Dunbrack, R. L. and Cohen, F. E. (1997). Protein Sci., 6, p. 1661.
Elsenhans, O. (1990). J. Appl. Crystallogr., 23, p. 73.
Emsley, P. and Cowtan, K. (2004). Acta Crystallogr., D60, p. 2126.
Emsley, P., Lohkamp, B., Scott, W. G., and Cowtan, K. (2010). Acta Crystallogr., D66,
p. 486.
Engel, G. E., Wilke, S., Konig, O., Harris, K. D. M., and Leusen, F. J. J. (1999). J. Appl.
Crystallogr., 32, p. 1169.
Esnouf, R. M. (1997). Acta Crystallogr., D53, p. 665.
Estermann, M. A. and Gramlich, V. (1993). J. Appl. Crystallogr., 26, p. 396.
Estermann, M. A., McCusker, L. B., and Baerlocher, C. (1992). J. Appl. Crystallogr.,
25, p. 539.
Fan, H. F., Zhong, Z. Y., Zheng, C. D., and Li, F. H. (1985). Acta Crystallogr., A41,
p. 163.
Favre-Nicolin, V. and ˇCerny, R. (2002). J. Appl. Crystallogr., 35, p. 734.
Fisher, J. E., Hancock, J. H., and Hauptman, H. A. (1970b). NRL Report, p. 7157.
Fisher, J. E., Hancock, J. H., and Hauptman, H. A. (l970a). NRL Report, p. 7132.
Fitzgerald, P. M. D. (1988). J. Appl. Crystallogr., 21, p. 273.
Florence, A. J., Shankland, N., Shankland, K., David, W. I. F., Pidcock, E., Xu, X.,
Johnston, A., Kennedy, A. R., Cox, P. J., Evans, J. S. O., Steele, G., Cosgrove, S. D.,
and Frampton, C. S. (2005). J. Appl. Crystallogr., 38, 249.
Foadi, J., Woolfson, M. M., Dodson, E., Wilson, K. S., Jia-xing, Y., and Chao-de, Z.
(2000). Acta Crystallogr., D56, p. 1137.
Fortier, S. and Hauptman, H. A. (l977a). Acta Crystallogr., A33, p. 572.
Fortier, S. and Hauptman, H. A. (1977b). Acta Crystallogr., A33, p. 829.
Fortier, S. and Hauptman, H. A. (1977c). Acta Crystallogr., A33, p. 694.
Foster, F. and Hargreaves, A. (1963a). Acta Crystallogr., 16, p. 1124.
Foster, F. and Hargreaves, A. (1963b). Acta Crystallogr., 16, p. 1133.
French, S. and Wilson, K. (1978). Acta Crystallogr., A34, p. 517.
Frigo, M. and Johnson, S. G. (2005) Proceedings of the IEEE, 93(2), p. 216.
Fujinaga, M. and Read, R. J. (1987). J. Appl. Crystallogr., 20, p. 517.
Furàsaki, A. (1979). Acta Crystallogr., A35, p. 220.
Garrido, J. (1950). Compt. Rend., 230, p. 1878.
Gassmann, J. (1975). Acta Crystallogr., A31, p. 825.
Gassmann, J. (1976). Acta Crystallogr., A32, p. 274.
Gassmann, J. (1977). Acta Crystallogr., A33, p. 474.
Gassmann, J. and Zechmeister, K. (1972). Acta Crystallogr., A28, p. 270.
Germain, G. and Main, P. (1971). Acta Crystallogr., B27, p. 368.
Germain, G., Main, P., and Woolfson, M. M. (1970). Acta Crystallogr., B26, p. 274.
Germain, G., Main, P., and Woolfson, M. M. (1974). In NATO Advanced Study Institute
on Direct Methods in Crystallography. NATO Advanced Study Institute, Erice, Italy.
Giacovazzo, C. (1974a). Acta Crystallogr., A30, p. 626.
Giacovazzo, C. (1974b). Acta Crystallogr., A30, p. 631.
Giacovazzo, C. (1975a). Acta Crystallogr., A31, p. 252.

References
401
Giacovazzo, C. (1975b). Acta Crystallogr., A31, p. 602.
Giacovazzo, C. (1976a). Acta Crystallogr., A32, p. 74.
Giacovazzo, C. (1976b). Acta Crystallogr., A32, p. 91.
Giacovazzo, C. (1976c). Acta Crystallogr., A32, p. 100.
Giacovazzo, C. (l976d). Acta Crystallogr., A32, p. 958.
Giacovazzo, C. (1977a). Acta Crystallogr., A33, p. 933.
Giacovazzo, C. (1977b). Acta Crystallogr., A33, p. 944.
Giacovazzo, C. (1979). Acta Crystallogr., A35, p. 757.
Giacovazzo, C. (1980). Direct Methods in Crystallography. Academic, London.
Giacovazzo, C. (1983a). Acta Crystallogr., A39, p. 685.
Giacovazzo, C. (1983b). Acta Crystallogr., A39, p. 585.
Giacovazzo, C. (1988). Acta Crystallogr., A44, p. 294.
Giacovazzo, C. (1989). Acta Crystallogr., A45, p. 534.
Giacovazzo, C. (1991). Acta Crystallogr., A47, p. 256.
Giacovazzo, C. (1993). Z. Kristallogr., 206, p. 161.
Giacovazzo, C., Altomare, A., Cuocci, C., Moliterni, A. G. G., and Rizzi, R. (2002).
J. Appl. Crystallogr., 35, p. 422.
Giacovazzo, C., Burla, M. C., and Cascarano, G. (1992a). Acta Crystallogr., A48,
p. 901.
Giacovazzo, C., Guagliardi, A., Ravelli, R., and Siliqi, D. (1994a). Z. Kristallogr., 209,
p. 136.
Giacovazzo, C., Ladisa, M., and Siliqi, D. (2002) Acta Crystallogr., A58, p. 598.
Giacovazzo, C., Ladisa, M. and Siliqi, D. (2003). Acta Crystallogr., A59, p. 569.
Giacovazzo, C. and Mazzone, A. (2011). Acta Crystallogr., A67, p. 210.
Giacovazzo, C. and Mazzone, A. (2012). Acta Crystallogr., A68, p. 464.
Giacovazzo, C. Mazzone, A., and Comunale, G. (2011). Acta Crystallogr., A67,
p. 368.
Giacovazzo, C., Moustiakimov, M., Siliqi, D., and Pifferi, A. (2004). Acta Crystallogr.,
A60, p. 233.
Giacovazzo, C. and Siliqi, D. (1997). Acta Crystallogr., A53, p. 789.
Giacovazzo, C. and Siliqi, D. (2002). Acta Crystallogr., A58, p. 590.
Giacovazzo, C. and Siliqi, D. (2004). Acta Crystallogr., D60, p. 73.
Gilmore, C. J., Nicholson, W. V., and Dorset, D. L. (1996). Acta Crystallogr., A52,
p. 937.
Gilmore, C. J., Shankland, K., and Fryer, J. R. (1993). Ultramicroscopy, 48, p. 132.
Glykos, N. M. and Kokkinidis, M. (2000a). Acta Crystallogr., D56, p. 1070.
Glykos, N. M. and Kokkinidis, M. (2000b). Acta Crystallogr., D56, p. 169.
Goldberg, D. E. (1989). In Genetic Algorithms in Search, Optimization and Machine
Learning, Addison-Wesley, New York.
González, A. (2003a). Acta Crystallogr., D59, p. 3.
González, A. (2003b). Acta Crystallogr., D59, p. 1935.
Gopal, K., McKee, E., Romo, T. D., Pai, R., Smith, J. N., Sacchettini, J. C., and Ioerger,
T. R. (2007). Bioinformatics, 23(3), p. 375.
Gould, R. O., van der Hark, T. E. M., and Beurskens, P. T. (1975). Acta Crystallogr.,
A31, p. 813.
Gozzo, F., De Caro, L., Giannini, C., Guagliardi, A., Schmitt, B., and Prodi, A. (2006).
J. Appl. Crystallogr., 39, p. 347.
Gramlich, V. (1984). Acta Crystallogr., A40, p. 610.
Green, D. W., Ingram, V. M., and Perutz, M. F. (1954). Proc. R. Soc., A225, p. 287.
Green, E. A. and Hauptman, H. A. (1976). Acta Crystallogr., A32, p. 43.
Greer, J. (1974). J. Mol. Biol., 82, p. 279.
Greer, J. (1985). Methods Enzymol., 115, p. 206.
Grosse-Kunstleve, R. W. and Adams, P. D. (2001). Acta Crystallogr., D57, p. 1390.
Grosse-Kunstleve, R. W. and Brunger, A. T. (1999). Acta Crystallogr., D55, p. 1568.
Gu, Y. X., Liu, Y. D., Hao, Q., and Fan, H. F. (2000). Acta Crystallogr., A56, p. 592.
Gu, Y. X., Woolfson, M. M., and Yao, J. X. (1996). Acta Crystallogr., D52, p. 1114.
Guinier, A. (1963). X-Ray Diffraction. Freeman, San Francisco.

402
References
Hall, S. R. (1970a). In NATO Advanced Study Institute on Direct and Patterson
Methods. NATO Advanced Study Institute, Parma, Italy.
Hall, S. R. and Subramanian, W. (1982a). Acta Crystallogr., A38, p. 590.
Hall, S. R. and Subramanian, W. (1982b). Acta Crystallogr., A38, p. 598.
Han, F. and Langs, D. A. (1988). Acta Crystallogr., A44, p. 563.
Hao, Q., Gu, Y. X., Zheng, C. D., and Fan, H. F. (2000). J. Appl. Crystallogr., 33, p. 980.
Harada, Y., Lifschitz, A., Berthou, J., and Jolles, P. (1981). Acta Crystallogr., A37,
p. 398.
Hargreaves, A. (1955). Acta Crystallogr., 8, p. 12.
Harker, D. (1936). Chem. Phys., 4, p. 381.
Harris, G. W. (1995). Acta Crystallogr., D51, p. 695.
Harris, K. D. M., Tremaine, M., Lighfoot, P., and Bruce, P. G. (1994). J. Am. Chem.
Soc., 116, p. 3543.
Harrison, R. W. (1989). Acta Crystallogr., A45, p. 4.
Hašek, J. (1974). Acta Crystallogr., A30, p. 576.
Hauptman, H. A (1970). New Orleans Meeting of the American Crystallographic
Association.
Hauptman, H. A (1975a). Acta Crystallogr., A31, p. 671.
Hauptman, H. A (1975b). Acta Crystallogr., A31, p. 680.
Hauptman, H. A. (1976). Acta Crystallogr., A32, p. 877.
Hauptman, H. A. (1982a). Acta Crystallogr., A38, p. 289.
Hauptman, H. A. (1982b). Acta Crystallogr., A38, p. 632.
Hauptman, H. A. (1995). Acta Crystallogr., B51, p. 416.
Hauptman, H. A., Fisher, J., Hancock, H., and Norton, D. A (1969). Acta Crystallogr.,
B25, p. 811.
Hauptman, H. A. and Fortier, S. (1977a). Acta Crystallogr., A33, p. 575.
Hauptman, H. A. and Fortier, S. (1977b). Acta Crystallogr., A33, p. 697.
Hauptman, H. A. and Green, E. A. (1976). Acta Crystallogr., A32, p. 45.
Hauptman, H. A. and Karle, J. (1953). The Solution of the Phase Problem I. The
Centrosymmetric Crystal, ACA Monograph No. 3. Polycrystal Book Service,
New York.
Hauptman, H. A. and Karle, J. (1956). Acta Crystallogr., 9, p. 45.
Hauptman, H. A and Karle, J. (1959). Acta Crystallogr., 12, p. 93.
Hedel, R., Bunge, H. J., and Reck, G. (1994). In Proc. 10th Int. Conf. Textures of
Matter., H. J. Bunge (ed), Trans Tech Publ., Switzerland, pp. 2067–74.
Heinerman, J. J. L., Krabbendam, H., Kroon, J., and Spek, A. L. (1978). Acta
Crystallogr., A34, p. 447.
Helliwell, J. R., Helliwell, M., and Jones, H. R. (2005). Acta Crystallogr., A61, p. 568.
Helliwell, M. (2000). J. Synchrotron Rad., 7, p. 139.
Hendersson, R. and Unwin, P. N. T. (1975). Nature, 257, p. 28.
Hendrickson, W. A. (1975). J. Mol. Biol., 91, p. 226.
Hendrickson, W. A., Klippenstein, G. L., and Ward, K. B. (1975). Proc. Natl. Acad.
Sci., USA, 72, p. 2160.
Hendrickson, W. A., Love, W. E., and Karle, J. (1973). J. Mol. Biol., 74, p. 331.
Hendrickson, W. A., Pähler, A., Smith, J. L., Satow, Y., Merritt, E. A., and Phizackerley,
R. P. (1989). Proc. Natl. Acad. Sci., USA, 86, p. 2190.
Hendrickson, W. A. and Teeter, M. M. (1981). Nature, 290, p. 107.
Hendrickson, W. A. and Ward, K. B. (1976). Acta Crystallogr., A32, p. 778.
Hirshfeld, F. L. (1968). Acta Crystallogr., A24, p. 301.
Hirshfeld, F. L. and Rabinovich, D. (1973). Acta Crystallogr., A29, p. 510.
Hodgkin, D. C., Kamper, J., Lindsey, J., MacKay, M., Pickworth, J., Robertson, J. H.,
Shoemaker, C. B., White, J. G., Prosen, R. J., and Trueblood, K. N. (1957). Proc. R.
Soc. London Ser., A242, p. 228.
Hoppe, W. (1957). Acta Crystallogr., 10, p. 750.
Hoppe, W. (1962a). Naturwissenschaften, 49, p. 536.
Hoppe, W. (1962b). Acta Crystallogr., 15, p. 13.
Hoppe, W. and Gassmann, J. (1968). Acta Crystallogr., B24, p. 97.

References
403
Hoppe, W., Gassmann, J., and Zechmeister, K. (1970). In Crystallographic Computing.
Munksgaard, Copenhagen.
Hoppe, W. and Jakubowski, U. (1975). In Anomalous Scattering (ed. S. Ramaseshan
and S. C. Abrahams), p. 437. Munksgaard, Copenhagen.
Hosemann, R. and Bagchi, S. N. (1954). Acta Crystallogr., 7, p. 237.
Hovmöller, S., Sjögren, A., Farrants, G., Sundberg, M., and Marinder, B. O. (1984).
Nature, 311, p. 238.
Howells, E. R., Phillips, D. C., and Rogers, D. (1950). Acta Crystallogr., 3, p. 210.
Hu, J. J., Li, F. H., and Fan, H. F. (1992). Ultramicroscopy, 41, p. 387.
Huang, T. C. (1988). Australian Journal of Physics, 41, p. 201.
Huang, T. C. and Parrish, W. (1975). Appl. Phys. Letters, 27, p. 123.
Huber, R. (1965). Acta Crystallogr., 19, p. 353.
Huber, R. and Schneider, M. (1985). J. Appl. Crystallogr., 18(3), p. 165.
Huber, R. (1969). In Crystallographic Computing Proceedings (ed. F. R. Ahmed).
Munksgaard, Copenhagen.
Hughes, E. W. (1949). Acta Crystallogr., 2, p. 34.
Hull, S. E., Viterbo, D., Woolfson, M. M., and Zhang, S.-H. (1981). Acta Crystallogr.,
A37, p. 566.
Ibers, J. A. (1958). Acta Crystallogr., 11, p. 178.
Ida, T. and Toraya, H. (2002). J. Appl. Crystallogr., 35, p. 38.
Immirzi, A. (1980). Acta Crystallogr., B36, p. 2378.
International Tables for Crystallography (1992). Vol. C., Ed.A. J. C.Wilson, Kluwer
Academic Publishers, Dordrecht.
International Tables for Crystallography (1993). Vol. B., Ed. U. Shmueli, Kluwer
Academic Publishers, Dordrecht.
International Tables for Crystallography (2005). Vol. A., Ed. T. Hahn, Springer,
Dordrecht.
Izumi, F. (1989). Rigaku J., 1, p. 10.
James, R. W. (1962). The Optical Principles of the Diffraction of X-Rays. Bell and
Sons, London.
Jamrog, D. C., Zhang, Y., and Phillips Jr., G. N. (2003). Acta Crystallogr., D59,
p. 304.
Jansen, I., Peschar, R., and Schenk, H. (1992). J. Appl. Crystallogr., 25, p. 231.
Järvinen, M. (1993). J. Appl. Crystallogr., 26, p. 525.
Jiang, J.-S. and Brunger, A. T. (1994). J. Mol. Biol., 243, p. 100.
Johnson, C. K. (1978). Acta Crystallogr. A34, S–353.
Jones, T. A and Thirup, S. (1986). EMBO J., 5, p. 819.
Jones, T. A. (2004). Acta Crystallogr., D60, p. 2115.
Jones, T. A., Zou, J.-Y., Cowan, S. W., and Kjeldgaard, M. (1991). Acta Crystallogr.,
A47, p. 110.
Joosten, K., Cohen, S. X., Emsley, P., Mooij, W., Lamzin, V. S., and Perrakis, A. (2008).
Acta Crystallogr., D64, p. 416.
Kariuki, B. M., Serrano-Gonzàlez, H., Johnston, R. L., and Harris, K. D. M. (1997).
Chem. Phys. Lett., 280, p. 189.
Karle, J. (1970a). Acta Crystallogr., B26, p. 1614.
Karle, J. (1970b). In Crystallographic Computing, (ed. F. R. Ahmed, S. R. Hall, and
C. P. Huber). Munksgaard, Copenhagen.
Karle,
J.
(1976).
In
Crystallographic
Computing
Techniques.
Munksgaard,
Copenhagen.
Karle, J. (1980). Int. J. Quantum Chem.: Quantum Biol. Symp., 7, p. 356.
Karle, J. (1983a). Proceedings of the School on Direct Methods and Macromolecular
Crystallography. Medical Foundations of Buffalo, Buffalo.
Karle, J. (1983b). In Methods and Applications in Crystallographic Computing (ed.
S. R. Hall and T. Ashida). Clarendon, Oxford.
Karle, J. (1984a). Acta Crystallogr., A40, p. 1.
Karle, J. (1984b). Acta Crystallogr., A40, p. 4.
Karle, J. (1989a). Acta Crystallogr., A45, p. 303.

404
References
Karle, J. (1989b). Phys. Today, June, 22.
Karle, J. and Hauptman, H. A. (1950). Acta Crystallogr., 3, p. 181.
Karle, J. and Hauptman, H. A. (1957). Acta Crystallogr., 10, p. 515.
Karle, J. and Hauptman, H. A. (1958). Acta Crystallogr., 11, p. 264.
Karle, J. and Hauptman, H. A. (1961). Acta Crystallogr., 14, p. 217.
Karle, J. and Karle, I. L. (1966). Acta Crystallogr., 21, p. 849.
Kartha, G. and Parthasarathy, R. (1965). Acta Crystallogr., 18, p. 745.
Keegan, R. M. and Winn, M. D. (2008). Acta Crystallogr., D64, p. 119.
Kennard, O., Wampler, D. L., Coppola, J. C., Motherwell, W. D. S., Watson, D. G., and
Larson, A. C. (1971). Acta Crystallogr., B27, p. 1116.
Kirkpatrick, S., Gelatt, C. D., and Vecchi, M. P. (1983). Science, 220, p. 671.
Kissinger, C. R., Gelhaar, D. K., and Fogel, D. B. (1999). Acta Crystallogr., D55,
p. 484.
Kleywegt, G. J. (1997). J. Mol. Biol., 273, p. 371.
Kleywegt, G. J. and Jones, T. A. (1996). Structure, 4, p. 1395.
Kleywegt, G. J. and Jones, T. A. (1997a). Methods Enzymol., 277, p. 208.
Kleywegt, G. J. and Jones, T. A. (1997b). Acta Crystallogr., D53, p. 179.
Klug, A. (1958). Acta Crystallogr., 11, p. 515.
Klug, H. P. and Alexander, L. E. (1974). X-Ray Diffraction Procedures from
Polycrystalline and Amorphous Materials. Wiley Interscience, New York.
Kluyver, J. C. (1906). Proc. Sect. Sci. K. Ned. Akad. Wet., 8, p. 341.
Koch, M. H. J. (1974). Acta Crystallogr., A30, p. 67.
Kockelmann, W., Jansen, E., Schafer, W., and Will, G. (1985). Report Forts-
chungszentrum Julich.
Kolb, U., Gorelik, T., Keble, C., Otten, M. T., and Hubert, D. (2007a). Ultramicroscopy,
107, p. 507.
Kolb, U., Gorelik, T., and Otten, M. T. (2007b). Ultramicroscopy, 108, p. 763.
Kraut, J. (1958). Biochim. Biophys. Acta., 30, p. 265.
Kroon, J., Spek, A. L., and Krabbendam, H. (1977). Acta Crystallogr., A33, p. 382.
Kyrala, A. (1972). Applied Functions of a Complex Variable. Wiley, New York.
Lajzerowicz, J. and Lajzerowicz, J. (1966). Acta Crystallogr., 21, p. 8.
Lamzin, V. S. and Wilson, K. S. (1993). Acta Crystallogr., D49, p. 129.
Larson, A. C. and von Dreele, R. B. (1987). Los Alamos National Laboratory Report
LA-UR–86–748.
Lattman, E. E. and Love, W. E. (1970). Acta Crystallogr., B26, p. 1854.
Le Bail, A. (2001). Mater. Sci. Forum, 378–381, p. 65.
Le Bail, A., Duroy, H., and Fourquet, J. L. (1988). Math. Res. Bull., 23, p. 447.
Leonard, G. A., Sainz, G., de Backer, M. M. E., and McSweeney, S. (2005). Acta
Crystallogr., D61, p. 388.
Leslie, A. G. W. (1987). Acta Crystallogr., A43, p. 134.
Lessinger, L. and Wondratschek, H. (1975). Acta Crystallogr., A31, p. 521.
Levitt, D. G. (2001). Acta Crystallogr., D57, p. 1013.
Li, D. X. and Hovmöller, S. (1988). J. Solid State Chem., 73, p. 5.
Lipson, H. and Woolfson, M. M. (1952). Acta Crystallogr., 5, p. 680.
Long, F., Vagin, A. A., Young, P., and Murshudov, G. N. (2008). Acta Crystallogr. D64,
p. 125.
Lovell, S. C., Davis, I. W., Arendall, W. B., de Bakker, P. I., Word, J. M., Prisant, M.
G., Richardson, J. S., and Richardson, D. C. (2003). Proteins, 50, p. 437.
Lovell S. C., Word, J. M., Richardson, J. S., and Richardson, D. C. (2000). Proteins:
Struct. Funct. Genet., 40, p. 389.
Lunin, V. Y. (1988). Acta Crystallogr., A44, p. 144.
Lunin, V. Y. (1993). Acta Crystallogr., D49, p. 90.
Lunin, V. Y., Afonine, P. V., and Urzhumtsev, A. G. (2002). Acta Crystallogr., A58,
p. 270.
Lunin, V. Y., Lunina, N. L., Petrova, T. E., Vernoslova, E. A., Urzhumtsev, A. G., and
Podjarny, A. D. (1995). Acta Crystallogr., D51, p. 896.
Lunin, V. Y. and Skovoroda, T. P. (1991). Acta Crystallogr., A47, p. 45.

References
405
Lunin, V. Y. and Urzhumtsev, A. G. (1984). Acta Crystallogr., A40, p. 269.
Lunin, V. Y., Urzhumtsev, A. G., and Skovoroda, T. P. (1990). Acta Crystallogr., A46,
p. 540.
Lutterotti, L. and Scardi, P. (1990). J. Appl. Crystallogr., 23, p. 246.
Luzzati, V. (1952). Acta Crystallogr., 5, p. 802.
Luzzati, V. (1953). Acta Crystallogr., 6, p. 142.
Luzzati, V., Mariani, P., and Delacroix, H. (1988). Macromol. Chem. Macromol. Symp.,
15, p. 1.
MacGillavry, C. H. (1950). Acta Crystallogr., 3, p. 214.
Mackay, A. L. (1953). Acta Crystallogr., A30, p. 607.
Magini, M., Licheri, G., Pischina, G., Piccaluga, G., and Pinna, G. (1988). X-Ray
Diffraction of Ions in Aqueous Solutions: Hydration and Complex Formation (ed.
M. Magini). CRC Press, Boca Raton, FL.
Main, P. (1967). Acta Crystallogr., 23, p. 50.
Main, P. (1977). Acta Crystallogr., A33, p. 750.
Main, P. (1979). Acta Crystallogr., A35, p. 779.
Main, P. (1990a). Acta Crystallogr., A46, p. 372.
Main, P. (1990b). Acta Crystallogr., A46, p. 507.
Main, P. (1993). Z. Kristallogr., 206, p. 201.
Main, P. and Hull, S. E. (1978). Acta Crystallogr., A34, p. 353.
Mardia, K. V. (1972). Statistics of Directional Data. Academic, London.
Margiolaki, I., Wright, J. P., Fitch, A. N., Fox, G. C., and Von Dreele, R. B. (2005).
Acta Crystallogr., D61, p. 423.
Mariani, P., Luzzati, V., and Delacroix, H. (1988). J. Mol. Biol., 204, p. 165.
Markvardsen, A. J., David, W. I. F., Johnson, J. C., and Shankland, K. (2001). Acta
Crystallogr., A57, p. 47.
Masciocchi, N., Moret, M., Cairati, P., Sironi, A., Ardino, G. A., and La Monica, G.
(1994). J. Am. Chem. Soc., 116, p. 7668.
Matthews, B. W. (1968). J. Mol. Biol., 33, p. 491.
Matthews, B. W. and Czerwinski, E. W. (1975). Acta Crystallogr., A31, p. 480.
Matthies, S., Lutterotti, L., and Wenk, H. R. (1997). J. Appl. Crystallogr., 30, p. 31.
McCoy, A. J. (2004). Acta Crystallogr., D60, p. 2169.
McCoy, A. J., Grosse-Kunstleve, R. W., Adams, P. D., Winn, M. D., Storoni, L. C., and
Read, R. J. (2007). J. Appl. Crystallogr., 40, p. 658.
McCoy, A. J., Storoni, L. C., and Read, R. J. (2004). Acta Crystallogr., D60, p. 1220.
McKenna, R., Xia, D., Willingmann, P., Ilag, L. L., Krishnaswamy, S., Rossmann,
M. G., Olson, N. H., Baker, T. S., and Incardona, N. L. (1992). Nature, 355, p. 137.
Metropolis, N., Rosenbluth, A. W., Rosenbluth, M. N., Teller, A. H., and Teller, E.
(1953). J. Chem. Phys., 21, p. 1087.
Mighell, A. D. and Jacobson, R. A. (1963). Acta Crystallogr., 16, p. 443.
Miller, R., Gallo, S. M., Kholak, H. G., and Weeks, C. M. (1994). J. Appl. Crystallogr.,
27, p. 613.
Mitchell, C. M. (1957). Acta Crystallogr., 10, p. 475.
Mö, F., Hjortas, J., and Svinning, T. (1973). Acta Crystallogr., A29, p. 358.
Mooers, B. H. M. and Matthews, B. W. (2006). Acta Crystallogr., D62, p. 165.
Moras, D., Lorber, B., Romby, P., Ebel, J.-P., Giegè, R., Lewit-Beutley, A., and Roth,
M. (1983). J. Biomol. Struct. Dynamics, 1, p. 209.
Morniroli, J. P., Redjaïmia, A., and Nicolopoulos, S. (2007). Ultramicroscopy, 107,
p. 514.
Morniroli, J. P. and Steeds, J. W. (1992). Ultramicroscopy, 45, p. 219.
Morris, R. J., Blanc, E., and Bricogne, G. (2004). Acta Crystallogr., D60, p. 227.
Morris, R. M., Perrakis, A., and Lamzin, V. S. (2002). Acta Crystallogr., D58, p. 968.
Moss, D. S. (1985). Acta Crystallogr., A41, p. 470.
Moss, B. and Dorset, D. L. (1983). Acta Crystallogr., A39, p. 609.
Muirhead, H., Cox, J. M., Mazzarella, L., and Perutz, M. F. (1967). J. Mol. Biol., 28,
p. 117.
Mukherjee, A. K., Helliwell, J. R., and Main, P. (1989). Acta Crystallogr., A45, p. 715.

406
References
Murshudov, G. N., Dodson, E. S., and Vagin, A. A. (1996). In Macromolecular
Reﬁnement. Proceedings of the CCP4 Study Weekend, pp. 93–104. CLRC Daresbury
Laboratory, Warrington, UK.
Murshudov, G. N., Skubák, P., Lebedev, A. A., Pannu, N. S., Steiner, R. A., Nicholls,
R. A., Winn, M. D., Long, F., and Vagin, A. A. (2011). Acta Crystallogr., D67,
p. 355.
Murshudov, G. N., Vagin, A. A., and Dodson, E. J. (1997). Acta Crystallogr., D53,
p. 240.
Nagem, R. A. P., Ambrosio, A. L. B., Rojas, A. L., Navarro, M. V. A. S., Golubev,
A. M., Garratt, R. C., and Polikarpov, I. (2005). J. Synchrotron Rad., 12, p. 420.
Nagem, R. A., Polikarpov, I., and Dauter, Z. (2003). Methods Enzymol., 374, p. 120.
Nan, J., Zhou, Y., Yang, C., Brostromer, E., Kristensen, O., and Su, X.-D. (2009). Acta
Crystallogr., D65, p. 440.
Navaza, J. (1987). Acta Crystallogr., A43, p. 645.
Navaza, J. (1993). Acta Crystallogr., D49, p. 588.
Navaza, J. (1994). Acta Crystallogr., A50, p. 157.
Navaza, J. and Vernoslova, E. (1995). Acta Crystallogr., A51, p. 445.
Naya, S., Nitta, I., and Oda, T. (1964). Acta Crystallogr., 17, p. 421.
Naya, S., Nitta, I., and Oda, T. (1965). Acta Crystallogr., 19, p. 734.
Needleman, S. B. and Wunsch, C. D. (1970). J. Mol. Biol., 48, p. 443.
Nelder, J. A. and Mead, R. (1965). Comput. J., 7, p. 308.
Niederwanger, V., Gozzo, F., and Griesser, U. J. (2009). J. Pharm. Sci., 98, p. 1064.
Norby, P., Christensen, A. N., Fjellvag, H., Lehmann, M. S., and Nielsen, M. J. (1991).
Solid State Chem., 94, 281.
Nordman, C. E. and Nakatsu, K. (1963). J. Am. Chem. Soc., 85, p. 353.
Nowacki, W. (1955). J. Chem. Phys., 23, p. 1172.
O’Keefe, M. A. (1973). Acta Crystallogr., A29, p. 389.
Oldﬁeld, T. (2002). Acta Crystallogr., D58, p. 487.
Oldﬁeld, T. J. and Hubbard, R. E. (1994). Proteins: Struct. Funct. Genet., 18, p. 324.
Oszlányi, G. and Suto, A. (2004). Acta Crystallogr., A60, p. 134.
Oszlányi, G. and Suto, A. (2005). Acta Crystallogr., A61, p. 147.
Oszlányi, G. and Suto, A. (2008). Acta Crystallogr., A64, p. 123.
Otwinowski, Z. (1991a). In Isomorphous Replacement and Anomalous Scattering,
CCP4. Daresbury, SERC.
Otwinowski, Z. (1991b). In Proceedings of the 1991 CCP4 Study Weekend. CLRC
Daresbury Laboratory, Warrington, UK.
Palatinus, L. and Chapuis, G. (2007). J. Appl. Crystallogr., 40, p. 786.
Palatinus, L., Dus˘ek, M., Glaum, R., and El Bali, B. (2006). Acta Crystallogr., B62,
p. 556.
Pannu, N. S. and Read, R. J. (2004). Acta Crystallogr., D60, p. 22.
Pannu, N. S., McCoy, A. J., and Read, R. J. (2003). Acta Crystallogr., D59, p. 1801.
Parrish, W. (1965). In X-ray Analysis Papers. Centrex Publishing, Eindhoven.
Parthasarathi, V. (1975). Ph.D. Thesis. University of Madras.
Parthasarathy, S. and Parthasarathi, V. (1976). Acta Crystallogr., A32, p. 57.
Patterson, A. L. (1934a). Phys. Rev., 45, p. 763.
Patterson, A. L. (1934b). Phys. Rev., 46, p. 372.
Patterson, A. L. (1939). Nature, 143, p. 939.
Patterson, A. L. (1944). Phys. Review, 65, p. 195.
Patterson, A. L. (1949). Acta Crystallogr., 2, p. 339.
Pauling, L. and Shapell, M. D. (1930). Z. Kristallogr., 75, p. 128.
Pavelcik, F. (2006). J. Appl. Crystallogr., 39, p. 483.
Pavelcik, F., Zelinka, J., and Otwinowski, Z. (2002). Acta Crystallogr., D58, p. 275.
Pawley, G. S. (1981). J. Appl. Crystallogr., 14, p. 357.
Pearson, K. (1905). Nature, 72, p. 294.
Peederman, A. F. and Bijvoet, J. M. (1956). Proc. K. Ned. Akad. Wet., B39, p. 312.
Pepinsky, R. and Okaya, Y. (1956). Proc. Nat. Acad. Sci., USA, 42, p. 286.
Perrakis, A., Morris, R. M., and Lamzin, V. S. (1999). Nature Struct. Biol., 6, p. 458.

References
407
Perutz, M. F. (1956). Acta Crystallogr., 9, p. 867.
Peschar, R., Schenk, H., and Capkova, P. (1995). J. Appl. Crystallogr., 28, p. 127.
Phillips, D. C. (1966). In Advances in Structure Research by Diffraction Methods (ed.
R. Brill and R. Mason). Interscience, New York.
Podjarny, A. D. and Yonath, A. (1977). Acta Crystallogr., A33, p. 655.
Ponder, J. V. and Richards, F. M. (1987). J. Mol. Biol., 193, p. 775.
Pontenagel, W. M. G. F. and Krabbendam, H. (1983). Acta Crystallogr., A39, p. 333.
Pradhan, D., Ghosh, S., and Nigam, G. D. (1985). In Structure and Statistics in
Crystallography (ed. A. J. C. Wilson). Adenine Press, New York.
Prandl, W. (1990). Acta Crystallogr., A46, p. 988.
Prandl, W. (1994). Acta Crystallogr., A50, p. 52.
Press, W. H., Tenkolsky, S. A., Vetterling, W. T., and Flannery, B. P. (1992). In
‘Numerical Recipes’: The Art of Scientiﬁc Computing, pp. 436–48. Cambridge
University Press.
Prince, E. (1993). Acta Crystallogr., D49, p. 61.
Putz, H., Schon, J. C., and Jansen, M. (1999). J. Appl. Crystallogr., 32, p. 864.
Qian, B., Raman, S., Das, R., Bradley, P., McCoy, A. J., Read, R. J., and Baker, D.
(2007). Nature, 450, p. 259.
Rabinovich, D. and Shakked, Z. (1984). Acta Crystallogr., A40, p. 195.
Rabinovich, D., Rozenberg, H., and Shakked, Z. (1998). Acta Crystallogr., D54,
p. 1336.
Ramachandran, G. N., Ramakrishnan, C., and Sasisekharan, V. (1963). J. Mol. Biol., 7,
p. 95.
Ramachandran, G. N. and Raman, S. (1959). Acta Crystallogr., 12, p. 957.
Ramachandran, G. N. and Srinivasan, R. (1970). Fourier Methods in Crystallography.
Wiley/Interscience, London.
Ramagopal, U. A., Dauter, M., and Dauter, Z. (2003). Acta Crystallogr., D59, p. 1020.
Ramakrishnan, V. and Biou, V. (1997). Methods Enzymol., 276, p. 538.
Raman, S. and Lipscomb, W. N. (1961). Z. Kristallogr., 116, p. 314.
Ramaseshan, S. (1963). In Advanced Methods of Crystallography (ed. G. N.
Ramachandran). Academic, London.
Ramaseshan, S. and Venkatesan, K. (1957). Current Sci. India, 26, p. 352.
Rao, S. N., Jih, J. H., and Hartsuck, J. A. (1980). Acta Crystallogr., A36, p. 878.
Ravelli, R. B., Theveneau, P., McSweeney, S., and Caffrey, M. (2002). J. Synchrotron
Rad., 9, p. 355.
Rayleigh, Lord (1919a). Phil. Mag., 37, p. 321.
Rayleigh, Lord (1919b). Phil. Mag., 37, p. 498.
Read, R. J. (1986). Acta Crystallogr., A42, p. 140.
Read, R. J. (1999). Acta Crystallogr., D55, p. 1759.
Read, R. J. (2001). Acta Crystallogr., D57, p. 1373.
Read, R. J. (2003a). Acta Crystallogr., D59, p. 1891.
Read, R. J. (2003b). Crystallogr. Rev., 9, p. 33.
Read, R. J. and Schierbeek, A. J. (1988). J. Appl. Crystallogr., 21, p. 490.
Refaat, L. S., Tate, C., and Woolfson, M. M. (1996a). Acta Crystallogr., D52, p. 252.
Riche, C. (1973). Acta Crystallogr., A29, p. 133.
Ridgen, D. J., Keegan, R. M., and Winn, M. D. (2008). Acta Crystallogr. D64,
p. 1288.
Riello, P., Fagherazzi, G., Clemente, D., and Canton, P. (1995). J. Appl. Crystallogr.,
28, p. 115.
Riemann, B. (1892). Gesammelte Mathematische Werke, 2nd edn., p. 424. Leipzig.
Rietveld, H. M. (1969). J. Appl. Crystallogr., 2, p. 65.
Rius, J. and Miravittles, C. (1989). Acta Crystallogr., A45, p. 490.
Roberts, P. J., Petterson, R. C., Sheldrick, G. M., Isaacs, N. W., and Kennard, O. (1973).
J. Chem. Soc. Perkin Trans., 2, p. 1978.
Robertson, J. M. (1935). J. Chem. Soc., p. 615.
Robertson, J. M. (1936). J. Chem. Soc., p. 1195.
Robertson, J. M. and Woodward, I. (1937). J. Chem. Soc., pp. 219–230.

408
References
Rodríguez, D. D., Grosse, C., Himmel, S., González, C., de Ilarduya, I. M., Becker, S.,
Sheldrick G. M., and Usón, I. (2009). Nature Methods, 6, p. 651.
Rodríguez, D. D., Sammito, M., Meindl, K., de Ilarduya, I. M., Potratz, M., Sheldrick,
G. M., and Usón, I. (2012). Acta Crystallogr., D68, p. 336.
Rogers, D. (1965). In Computing Methods in Crystallography. Pergamon, London.
Rogers, D., Stanley, E., and Wilson, A. J. C. (1955). Acta Crystallogr., 8, p. 383.
Rogers, D. and Wilson, A. J. C. (1953). Acta Crystallogr., 6, p. 439.
Rossmann, M. G. (1960). Acta Crystallogr., 13, p. 221.
Rossmann, M. G. (1961). Acta Crystallogr., 14, p. 383.
Rossmann, M. G. (1990). Acta Crystallogr., A46, p. 73.
Rossmann, M. G. and Blow, D. M. (1962). Acta Crystallogr., 15, p. 24.
Rossmann, M. G. and Blow, D. M. (1963). Acta Crystallogr., 16, p. 39.
Rowan, T. (1990). Functional Stability Analysis of Numerical Algorithms, Ph.D. thesis,
Department of Computer Sciences, University of Texas at Austin, 1990.
Rozhdestvenskaya, I., Mugnaioli, E., Czank, M., Depmeier, W., Kolb, U., Reinholdt,
A., and Weirich, T. (2010). Mineral. Mag., 74, p. 159–177.
Sayre, D. (1952). Acta Crystallogr., 5, p. 60.
Sayre, D. (1953). Acta Crystallogr., 6, p. 430.
Sayre, D. (1972). Acta Crystallogr., A28, p. 210.
Sayre, D. (1973). IBM Research Report RC 4602.
Sayre, D. (1974a). Acta Crystallogr., A30, p. 180.
Sayre, D. (1974b). In NATO Advanced Study Institute on Direct Methods in
Crystallography. NATO Advanced Study Institute, Erice, Italy.
Scardi, P. (2008). Microstructural properties: lattice defects and domain size effects. In
Powder Diffraction: Theory and Practice (eds R. E. Dinnebier and S. J. L. Billinge).
RSC Publishing.
Schenk, H. (1971). Acta Crystallogr., B27, p. 2037.
Schenk, H. (1972a). Acta Crystallogr., A28, p. 412.
Schenk, H. (1972b). Acta Crystallogr., A28, p. 661.
Schenk, H. (1973a). Acta Crystallogr., A29, p. 480.
Schenk, H. (1973b). Acta Crystallogr., A29, p. 77.
Schenk, H. (1974). Acta Crystallogr., A30, p. 472.
Schevitz, R. W., Podjarny, A. D., Zwick, M., Hughes, J. J., and Sigler, P. B. (1981).
Acta Crystallogr., A37, p. 669.
Schiltz, M. and Bricogne, G. (2008). Acta Crystallogr., D64, p. 711.
Schlünzen, F., Hansen, H. A. S., Thygesen, J., Bennett, W. S., Volkmann, N., Levin,
I., Harms, J., Bartels, H., Zaytzev-Bashan, A., Berkovitch-Yellin, Z., Sagi, I.,
Franceschi, F., Krumbholz, S., Geva, M., Weinstein, S., Agmon, I., Boddeker, N.,
Morlang, S., Sharon, R., Dribin, A., Maltz, E., Peretz, M., Weinrich, V., and Yonath,
A. (1995). Biochem. Cell. Biol., 73, p. 739.
Schneider, T. R. and Sheldrick, G. M. (2002). Acta Crystallogr., D58, p. 1772.
Schwarzenbacher, R., Godzik, A., Grzechnig, S. K., and Jaroszewski, L. (2004). Acta
Crystallogr., D60, p. 1229.
Schwarzenbacher, R., Godzik, A., and Jaroszewski, L. (2008). Acta Crystallogr. D64,
p. 133.
Shankland, K., David, W. I. F., Csoka, T., and McBride, L. (1998). Int. J. Pharm., 165,
p. 117.
Shankland, K., David, W. I. F., and Sivia, D. S. (1997a). J. Mater. Chem., 7, p. 569.
Shankland, K., David, W. I. F., and Csoka, T. (1997b). Z. Kristallogr., 212, p. 550.
Sheldrick, G. M. (1982). In Computational Crystallography (ed. D. Sayre), pp. 506–14.
Clarendon, Oxford.
Sheldrick, G. M. (1990). Acta Crystallogr., A46, p. 467.
Sheldrick, G. M. (1997). In Direct Methods for Solving Macromolecular Structures.
NATO Advanced Study Institute, Erice, Italy.
Sheldrick, G. M. (1998). In Direct Methods for Solving Macromolecular Structures (ed.
S. Fortier). Dordrecht: Kluwer.
Sheldrick, G. M. (2002). Z. Kristallogr., D58, p. 1958.

References
409
Sheldrick, G. M. (2007). In Evolving Methods for Macromolecular Crystallography
(ed. R. J. Read and J. L. Sussman). Springer, The Netherlands.
Sheldrick, G. M. (2010). Acta Crystallogr., D66, p. 479.
Sheldrick, G. M. and Gould, R. O. (1995). Acta Crystallogr., B51, p. 423.
Sheriff, S., Klei, H. E., and Davis, M. E. (1999). J. Appl. Crystallogr., 32, p. 98.
Shiono, M. and Woolfson, M. M. (1992). Acta Crystallogr., A48, p. 451.
Shirley, R. (1980). NBS Spec. Publ., 567, p. 362.
Shmueli, U. and Weiss, G. H. (1986). Acta Crystallogr., A42, p. 240.
Shmueli, U. and Weiss, G. H. (1992). Acta Crystallogr., A48, p. 418.
Shmueli, U. and Weiss, G. H. (1995). In Introduction to Crystallographic Statistics.
IUCr Oxford University Press.
Shmueli, U., Weiss, G. H., Kiefer, J. E., and Wilson, A. J. C. (1984). Acta Crystallogr.,
A40, p. 651.
Silva, A, M. and Viterbo, D. (1980). Acta Crystallogr., A36, p. 1065.
Sim, G. A. (1959a). Acta Crystallogr., 12, p. 813.
Sim, G. A. (1959b). Acta Crystallogr., 12, p. 511.
Simerska, M. (1956). Czech. J. Phys., 6, p. 1.
Simonov, V. I. (1976). In Crystallographic Computing Techniques, pp. 138–43.
Munksgaard, Copenhagen.
Sisinni, L., Cendron, L., Favaro, G., and Zanotti, G. (2010). FEBS J., 277, p. 1896.
Sivia, D. S. and David, W. I. F. (1994). Acta Crystallogr., A50, p. 703.
Sonneveld, E. J. and Visser, J. W. (1975). J. Appl. Crystallogr., 8, p. 1.
Srinivasan, R. (1961). Acta Crystallogr., 14, p. 607.
Srinivasan, R. and Subramanian, E. (1964). Acta Crystallogr., 17, p. 67.
Srinivasan, R. and Ramachandran, G. N. (1965a). Acta Crystallogr., 19, p. 1003.
Srinivasan, R. and Ramachandran, G. N. (1965b). Acta Crystallogr., 19, p. 1008.
Strahs, G. and Kraut, J. (1968). J. Mol. Biol., 35, p. 503.
Su, W.-P. (1995). Acta Crystallogr., A51, p. 845.
Subbiah, S. (1991). Science, 252, p. 128.
Subbiah, S. (1993). Acta Crystallogr., D59, p. 108.
Subramanian, W. and Hall, S. R. (1982). Acta Crystallogr., A38, p. 577.
Suortti, P. and Jennings, L. D. (1977). Acta Crystallogr., A33, p. 1012.
Swanson, S. M. (1979). J. Mol. Biol., 129, p. 637.
Swanson, S. M. (1994). Acta Crystallogr., D50, p. 695.
Takeuchi, Y. (1972). Z. Kristallogr., 135, p. 120.
Tang, D., Jansen, J., Zandbergen, H. W., and Shenk, H. (1995). Acta Crystallogr., A51,
p. 188.
Taylor, W. J. (1953). J. Appl. Phys., 24, p. 662.
Taylor, D. J. and Woolfson, M. M. (1975). In Tenth International Congress of
Crystallography, Amsterdam, Contribution 02. p. 2–12.
Taylor, D. J., Woolfson, M. M., and Main, P. (1979). Acta Crystallogr., A35, p. 870.
Templeton, D. H. and Templeton, L. K. (1988). Acta Crystallogr., A44, p. 1045.
Templeton, D. H., Templeton, L. K., Philips, J. C., and Hodgson, K. O. (1980). Acta
Crystallogr., A36, p. 436.
Templeton, L. K., Templeton, D. M., Phizackerley, R. P., and Hodgson, K. O. (1982).
Acta Crystallogr., A38, p. 74.
Ten Eyck, L. F. (1973). Acta Crystallogr., A29, p. 183.
Terwilliger, T. C. (1997). Methods Enzymol., 276, p. 530.
Terwilliger, T. C. (2001). Acta Crystallogr., D57, p. 1755.
Terwilliger, T. C. (2003). Acta Crystallogr., D59, p. 38.
Terwilliger, T. C. (2004). J. Synchrotron Radiation, 11(1), p. 121.
Terwilliger, T. C., Adams, P. D., Read, R. J., McCoy, A. J., Moriarty, N. W., Grosse-
Kunstleve, R. W., Afonine, P. V., Zwart, P. H., and Hung, L.-W. (2009). Acta
Crystallogr., D65, p. 582.
Terwilliger, T. C. and Berendzen, J. (1999). Acta Crystallogr., D55, p. 849.
Terwilliger, T. C. and Berendsen, J. (2001). International Tables for Crystallography
F., pp. 303–309.

410
References
Terwilliger, T. C. and Eisenberg, D. (1983). Acta Crystallogr., A39, p. 813.
Terwilliger, T. C. and Eisenberg, D. (1987). Acta Crystallogr., A43, p. 6.
Terwilliger, T. C., Read, R. J., Adams, P. D., Brunger, A. T., Afonine, P. V., Grosse-
Kunstleve, R. W., and Hung, L-W. (2012). Acta Crystallogr., D68, p. 861.
Thygesen, J., Weinstein, S., Franceschi, F., and Yonath, A. (1996). Structure, 4, p. 513.
Tivol, W. F., Dorset, D. L., McCourt, M. P., and Turner, J. N. (1993). Microsc. Soc. Am.
Bull., 23(1), p. 91.
Tollin, P., Main, P., and Rossmann, M. G. (1966). Acta Crystallogr., 20, p. 404.
Tollin, P. and Rossmann, M. G. (1966). Acta Crystallogr., 21, p. 872.
Tong, L. (1993). J. Appl. Crystallogr., 26, p. 748.
Tong, L. (2001). Acta Crystallogr., D57, p. 1383.
Tong, L. and Rossmann, M. G. (1990). Acta Crystallogr., A46, p. 783.
Toraya, H. (1986). J. Appl. Crystallogr., 19, p. 440.
Tremaine, M., Kariuki, B. M., and Harris, K. D. M. (1997). Angew. Chem. Int. Ed.
Engl., 36, p. 770.
Tsoucaris, G. (1970). Acta Crystallogr., A26, p. 492.
Turner, P. S. and Cowley, J. M. (1969). Acta Crystallogr., A25, p. 475.
Unwin, P. N. T. and Hendersson, R. (1975). J. Mol. Biol., 94, p. 425.
Ursby, T. and Bourgeois, D. (1997). Acta Crystallogr., A53, p. 564.
Urzhumtsev, A. G., Vernoslova, E. A., and Podjarny, A. D. (1996). Acta Crystallogr.,
D52, p. 1092.
Vagin, A. and Teplyakov, A. (1997). J. Appl. Crystallogr., 30, p. 1022.
Vagin, A. and Teplyakov, A. (1998). Acta Crystallogr., D54, p. 400.
Vagin, A. and Teplyakov, A. (2000). Acta Crystallogr., D56, p. 1622.
Vainshtein, B. K. (1964). Structure Analysis By Electron Diffraction. Pergamon Press,
Oxford.
Vainshtein, B. K. and Kayushina, R. L. (1967). Sov. Phys. Crystallogr., 11, p. 468.
Vainshtein, B. K. and Pinsker, Z. G. (1949). J. Phys. Chem. SSSR, 23, p. 1058.
van der Hark, T. E. M., Prick, P., and Beurskens, P. T. (1976). Acta Crystallogr., A32,
p. 816.
van der Putten, N. and Schenk, H. (1977). Acta Crystallogr., A33, p. 856.
Vaughan, P. A. (1958). Acta Crystallogr., 11, p. 111.
Veilleux, F. M. D. A. P., Hunt, J. F., Roy, S., and Read, R. J. (1995). J. Appl.
Crystallogr., 28, p. 347.
Vermin, W. J. and de Graaf, R. A. G. (1978). Acta Crystallogr., A34, p. 892.
Vickovi´c, I. and Viterbo, D. (1979). Acta Crystallogr., A35, p. 500.
Vijayan, M. (1980). Acta Crystallogr., A36, p. 295.
Vincent, R. and Midgley, P. A. (1994). Ultramicroscopy, 53, p. 271.
Visser, J. W. (1969). J. Appl. Crystallogr., 2, p. 89.
Voigt-Martin, I. G., Yan, D. H., Yakimansky, A., Schollmeyer, D., Gilmore, C. J., and
Bricogne, G. (1995). Acta Crystallogr., A51, p. 849.
von Eller, G. (1973). Acta Crystallogr., A29, p. 63.
Wang, B. C. (1985). Methods Enzymol., 115, p. 90.
Wang, D. N., Hovmöller, S., Kihlborg, L., and Sundberg, M. (1988). Ultramicroscopy,
25, p. 303.
Weeks, C. M., de Titta, G. T., Hauptman, H. A., Thuman, P., and Miller, R. (1994). Acta
Crystallogr., A50, p. 210.
Weeks, C. M. and Miller, R. (1999). Acta Crystallogr., D55, p. 492.
Weinzierl, J. E., Eisenberg, D., and Dickerson, R. E. (1969). Acta Crystallogr., A25,
p. 380.
Weiss, M. S., Sicker, T., and Hilgenfeld, R. (2001). Structure, 9, p. 771.
Wenk, H. R., Downing, K. H., Hu, Meisheng, and O’Keefe, M. A. (1992). Acta
Crystallogr., A48, p. 700.
Werner, P.-E., Eriksson, L., and Westdahl, M. (1985). J. Appl. Crystallogr., 18, p. 367.
Wessels, T., Baerlocher, Ch., and McCusker, L. B. (1999). Science, 284, p. 477.
West, C. D. (1954). J. Chem. Phys., 22, p. 150.
Weyl, H. (1915–16). Math. Ann., 77, p. 313.

References
411
White, P. and Woolfson, M. M. (1975). Acta Crystallogr., A31, p. 53.
Will, G. (1979). J. Appl. Crystallogr., 12, p. 483.
Williams, T. V. (1982). Ph.D. Thesis. University of North Carolina, Chapel Hill.
Wilson, A. J. C. (1942). Nature, 150, p. 152.
Wilson, A. J. C. (1949). Acta Crystallogr., 2, p. 318.
Wilson, A. J. C. (1963). Mathematical Theory of X-ray Powder Diffraction. Philips
Technical Library.
Wilson, A. J. C. (1978). Acta Crystallogr., A34, p. 474.
Wilson, C. and Agard, D. A. (1993). Acta Crystallogr., A49, p. 97.
Winn, M. D. et al. (2011). Acta Crystallogr., D67, p. 235.
Woolfson, M. M. (1977). Acta Crystallogr., A33, p. 219.
Woolfson, M. M. (1978). In Direct Methods of Solving Crystal Structures, International
School of Crystallography, Erice, Lectures 4 and 13.
Wrinch, D. (1939). Phil. Mag., 27(7), p. 98.
Wu, H. and Hendrickson, W. A. (1996). Acta Crystallogr., S52, C–55.
Wu, J. S., Spence, J. C. H., O’Keeffe, M., and Groy, T. L. (2004). Acta Crystallogr.
A60, p. 326.
Yang, C. and Pﬂugrath, J. W. (2001). Acta Crystallogr., D57, p. 1480.
Yang, C., Pﬂugrath, J. W., Courville, D. A., Stence, C. N., and Ferrara, J. D. (2003).
Acta Crystallogr., D59, p. 1943.
Yao, J. X. (1981). Acta Crystallogr., A37, p. 642.
Yao, J.-X. (2002). Acta Crystallogr., D58, p. 1941.
Yao, J. X., Dodson, E. J., Wilson, K. S., and Woolfson, M. M. (2006). Acta Crystallogr.,
D62, p. 901.
Young, R. A. (1993). The Rietveld Method. Oxford University Press.
Zachariasen, W. H. (1945). Theory of X-Ray Diffraction in Crystals. Wiley, New York.
Zachariasen, W. H. (1952). Acta Crystallogr., 5, p. 68.
Zhang, K. Y. J. and Main, P. (1990a). Acta Crystallogr., A46, p. 41.
Zhang, K. Y. J. and Main, P. (1990b). Acta Crystallogr., A46, p. 377.
Zhang, D., Oleynikov, P., Hovmöller, S., and Zou, X. (2010). Z. Kristallogr., 225, p. 94.
Zhang, X. J. and Woolfson, M. M. (1982). Acta Crystallogr., A38, p. 683.
Zou, X. D., Hovmöller, S., and Oleynikov, P. (2011). Electron Crystallography. Oxford
University Press.
Zou, X. D., Mo, Z. M., Hovmöller, S., Li, X. Z., and Kuo, K. H. (2003). Acta
Crystallogr., A59, p. 526.
Zou, X., Sukharev, Y., and Hovmöller, S. (1993). Ultramicroscopy, 52, p. 436.
Zuev, A. D. (2006). J. Appl. Cryst., 39, p. 304.

Index
A
Absolute scaling of the intensities 43
Allowed origin
deﬁnition of 65, 66, 76, 81
tabulation of 70–72, 77, 79
Anomalous
difference 340, 349
scattering 336
scattering applied to powder data 363
scattering substructure 345, 350
ARCIMBOLDO 289
Arp/warp 196
Atomic scattering factor 8
Atomicity postulate 108
Automatic model building 184
B
Banks (Crystallographic) 24–26
Basic postulate of structural crystallography
17–24
Bessel functions 385
C
Central limit theorem
in Wilson distributions 28, 50, 52
statement of 375
Characteristic function 94, 98, 371
Charge ﬂipping 199–201
C-map 225
Cochran formula 105
Cochran integral criterion 231
Co-crystallization 315
Convergence procedure 135
Convolution, deﬁnition of 2
Crystal lattice 2
Crystal system 4
Cumulant generating function 95, 98, 373
Cumulants of a distribution 95, 98, 373
Cumulative distribution 35
D
Debye formula 59
Decomposition of powder patterns 259
Difference Fourier synthesis 164, 201–203,
206–211
Difference Patterson synthesis 318
Directional data 380
Double Patterson 232
Dynamic scattering 237
E
EDM procedures 178
Electron density
covariance in 168, 174
difference 164, 201–203, 206–211
hybrid 166, 205, 211–212
interpretation 138, 184
map calculation 10
modiﬁcation (EDM) procedures 178
observed 162
properties 156
resolution bias in 158–162
variance of 168, 174
Electron diffraction
precession and rotation cameras 244
traditional techniques 239, 241
Electron scattering
non-kinematical 237
properties of 235
Envelopes 190–191
Equiphasic surface 62
Ewald sphere 9
Excitation error 251
F
Figures of merit 132, 137, 138
Fourier syntheses, see Electron density
Free lunch 184
Friedel law
deﬁnition 10
violation 337
G
Gamma function 382
Gaussian distribution, see Normal
distribution
Generalized hypergeometric function 389

Index
413
H
Half-bake approach 147
Harker sections 218
Hauptman–Karle family
deﬁnition of 69
tabulation of 70, 71, 77, 79
Heavy atom
derivative 314
method 219
substructure 219, 318, 325, 333
Hermite polynomials 383
Histogram matching 180, 193
Hybrid Fourier syntheses 166, 205, 211–212
I
Implication transformation method 221
Isomorphous
data scaling 322
derivative 314
difference 318
difference Patterson synthesis 318
Isomorphous replacement techniques 315
and direct methods 331
J
Joint probability distributions, see Probability
distribution functions
L
Lack of closure error 327
Laguerre polynomials 383
Le Bail method 261
M
MAD
algebraic bases of 352
data reﬁnement 365
probabilistic approach to 354
wavelength deﬁnition 340
Magic integers approach 135
MIR
algebraic bases of 320
method 315
probabilistic approach to 327
MIRAS techniques 360
Molecular averaging 181
Molecular replacement
six-dimensional search 279
stochastic approaches 289
techniques 275
Molecular scattering factor 8
Moments of a distribution 373, 378
Multisolution procedures 134
N
Neighbourhoods 87
Neutron scattering 245
Non-crystallographic symmetry
deﬁnition of 181
of translational type 308
operators 304, 305
Normal distribution 374
Normalized structure factor
deﬁnition of 31
distribution of, in Wilson statistics 31
O
Observed Fourier synthesis 162
One-phase structure seminvariant 75, 233
Origin deﬁnition 61
Origin translation 62
P
P10 formula for triplet invariants 111, 121
Patterson
deconvolution of 218
function 215–217
function of second kind 233
superposition methods 223
symmetry 217
Pawley method 261
Peak shape modelling 259
Permissible origin, see Allowed origin
Phase extension
in direct space 177
in reciprocal space 140
Phasing magnitudes 88
Phasing shells 87
Point group symmetry 4
Positivity postulate
deﬁnition of 108
violation of 247
Powder data
ab initio phasing methods for 267
full pattern decomposition 258
indexing of 264
non-ab initio phasing methods for 270
peak overlapping in 254
peak resolution 255
Probability distribution functions
conditional 85–87
cumulants of 95, 373
joint 83, 93–103, 375
mathematical bases of 370
method of 93–103
moments of 371
of signs 379
when a model is available 152

414
Index
Proﬁle shape function 259
Psi-zero triplets 138
Q
Quadrant permutation technique 135
Quartet invariant
algebra of 116
ﬁnding 149
probabilistic estimation in any space group
123–124
probabilistic estimation in Pl and P¯1
112–116
R
Random phase approach 136
Reciprocal space 5
Reciprocal lattice 7
Relax algorithm 212–213
Representations
for isomorphous structures 91
of a structure invariant 88
of a structure seminvariant 89
Resolution bias 158, 183
Rietveld approach 258
Rotation function
deﬁnition 280, 282, 284
in Cartesian space 294
symmetry of 299
S
SAD
algebraic approach 344
case ambiguities 346
method 340
probabilistic approach to 354, 360
Sayre–Hughes equation 230
Selenoproteins 341
Sequence
docking 185
identity 277
Shake & Bake 144
Sigma-A 154, 173
SIR method
algebraic bases 317
and Direct Methods 331
for centric reﬂections 330
probabilistic approach to 360, 368
SIRAS
algebraic bases of 347
probabilistic approach to 360, 368
techniques 347
Skeletonization techniques 182
Soaking 315
Solvent
content 190
ﬂattening 180
model of 192
Space group
deﬁnition of 5
identiﬁcation of 42, 36–41, 266
Starting set of phases 134
Statistical weight
in Wilson distributions 32
tabulation of 33–34
Structure factor
algebra 53
deﬁnition of 8–9, 11
statistics of 56–58
Structure invariant
deﬁnition of 63
two-phase 152
Structure seminvariant
deﬁnition of 69
representations of 89
Symmetry operators 3, 12–13
Systematic absences 15–16
T
Tangent formula
derivation 128–130
limits 141
weighted 136
Texture effects 272
Translation functions 286
Triplet invariant
estimation in any space group 120
estimation in Pl 104, 108, 110, 117,
120–121
estimation in P¯1 107
for isomorphous structures 170
via P10 formula 111, 121
U
Unit cell
chemical content 49
deﬁnition of 1, 2
V
VLD (vive la difference)
difference Fourier synthesis 201–203,
206–211
hybrid Fourier syntheses 205, 211–212
phasing approach 201
W
Wilson
plot 43–49
statistics 28

