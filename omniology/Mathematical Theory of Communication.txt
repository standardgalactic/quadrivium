A Mathematical 
Theory 
of Communication 
By C. E. SHANNON 
INTRODUCTION 
T 
HE recent development of various methods of modulation such as PCM 
and PPM which exchange bandwidth 
for signal-to-noise ratio has in- 
tensified the interest in a general theory of communication. 
A basis for 
such a theory is contained in the important papers of Nyquist’ and Hartley* 
on this subject. 
In the present paper we will extend the theory to include a 
number of new factors, in particular 
the effect of noise in the channel, and 
the savings possible due to the statistical structure of the original message 
and due to the nature of the final destination of the information. 
The fundamental 
problem of communication 
is that of reproducing 
at 
one point either exactly or approximately 
a message selected at another 
point. 
Frequently 
the messages have mea&g; 
that is they refer to or are 
correlated according to some system with certain physical or conceptual 
entities. 
These semantic aspects of communication 
are irrelevant 
to the 
engineering problem. 
The significant aspect is that the actual message is 
one selected from a set of possible messages. The system must be designed 
to operate for each possible selection, not just the one which will actually 
be chosen since this is unknown at the time of design. 
If the number of messages in the set is finite then this number or any 
monotonic function of this number can be regarded as a measure of the in- 
formation produced when one message is chosen from the set, all choices 
being equally likely. 
As was pointed out by Hartley 
the most natural 
choice is the logarithmic 
function. 
Although 
this definition must be gen- 
eralized considerably when we consider the influence of the statistics of the 
message and when we have a continuous range of messages, we will in all 
cases use an essentially logarithmic 
measure. 
The logarithmic 
measure is more convenient for various reasons: 
1. It is practically 
more useful. 
Parameters of engineering importance 
* Nyquist, H., “Certain Factors Affecting Telegraph Speed,” BellSysletn 
Technical 
Jwr- 
nol, April 1924, p. 324; “Certain Topics in Telegraph Transmission Theory,” A. I. E. E. 
Ttans., v. 47, April 1928, p. 617. 
1 Hartley, R. V. L., “Transmission of Information,” Bell System 
Teclanid Journal, 
July 
1928, 
p. 535. 
Vol. 27, PP. 379.423, 623.656, 
July, 
October, 
1948 
Copyright 
1948 
by 
AMERICAN 
TBLEPIIONE 
AND TELEGRAPII 
Co. 
Printed 
in 
U. S. A. 
Reissued 
December. 
1957 
5 

6 
C. E. Shannon 
such as time, bandwidth, number of relays, etc., tend to vary linearly with 
the logarithm of the number of possibilities. 
For example, adding one relay 
to a group doubles the number of possible states of the relays. 
It adds 1 
to the base 2 logarithm of this number. 
Doubling the time roughly squares 
the number of possible messages, or doubles the logarithm, etc. 
2. It is nearer to our intuitive feeling as to the proper measure. 
This is 
closely related to (1) since we intuitively 
measure entities by linear com- 
parison with common standards. 
One feels, for example, that two punched 
cards should have twice the capacity of one for information storage, and two 
identical channels twice the capacity of one for transmitting 
information. 
3. It is mathematically 
more suitable. 
Many of the limiting operations 
are simple in terms of the logarithm but would require clumsy restatement in 
terms of the number of possibilities. 
The choice of a logarithmic base corresponds to the choice of a unit for 
measuring information. 
If the base 2 is used the resulting units may be 
called binary digits, or more briefly bils, a word suggested by J. W. Tukey. 
A device with two stable positions, such as a relay or a flip-flop circuit, can 
store one bit of information. 
iV such devices can store N bits, since the 
total number of possible states is 2N and log,2N = N. 
If the base 10 is 
used the units may be called decimal digits. 
Since 
log2 M = log10 M/log102 
= 3.32 log,, M, 
a decimal digit is about 3f bits. 
A digit wheel on a desk computing machine 
has ten stable positions and therefore has a storage capacity of one decimal 
digit. 
In analytical work where integration and differentiation are involved 
the base e is sometimes useful. 
The resulting units of information will be 
called natural units. 
Change from the base a to base b merely requires 
multiplication 
by logb 
a. 
By a communication system we will mean a system of the type indicated 
schematically in Fig. 1. It consists of essentially five parts: 
1. An iitforntalion source which produces a message or sequence of mes- 
sages to be communicated to the receiving terminal. 
The message may be 
of various types: e.g. (a) A sequence of letters as in a telegraph or teletype 
system; (b) A single function of time f(l) as in radio or telephony; (c) A 
function of time and other variables as in black and white television-here 
the message may be thought of as a function f(x, y, 1) of two space coordi- 
nates and time, the light intensity at point (x, y) and time t on a pickup tube 
plate; (d) Two or more functions of time, say f(l), 
g(l), h(l)-this 
is the 
case in “three dimensional” sound transmission or if the system is intended 
to service several individual channels in multiplex; 
(e) Several functions of 

A Mathematical Theory of Communication.. 
several variables-in 
color television the message consists of three functions 
f(x, y, I), g(r, y, I>, It&, y, 1) defined in a three-dimensional continuum- 
we may also think of these three functions as components of a vector field 
defined in the region-similarly, 
several black and white television sources 
would produce “messages” consisting of a number of functions of three 
variables; (f) Various combinations also occur, for example in television 
with an associated audio channel. 
2. A lransmitter which operates on the message in some way to produce a 
signal suitable for transmission over the channel. 
In telephony this opera- 
tion consists merely of changing sound pressure into a proportional electrical 
current. 
In telegraphy we have an encoding operation which produces a 
sequence of dots, dashes and spaces on the channel corresponding to the 
message. In a multiplex PCM system the different speech functions must 
be sampled, compressed, quantized and encoded, and finally interleaved 
IN~OoRu~k4~10N 
TRANSMITTER 
RECEIVERS 
DESTINATION 
t 
- 
SIGNAL 
RECEIVED 
SIGNAL 
c 
MESSAGE 
Ib 
MESSAGE 
El 
NOISE 
SOURCE 
Fig. l-Schematic 
diagram of a general communication system. 
properly 
to construct the signal. 
Vocoder systems, television, and fre- 
quency modulation are oiher examples of complex operations applied to the 
message to obtain the signal. 
3. The channel is merely the medium used to transmit the signal from 
transmitter to receiver. 
It may be a pair of wires, a coaxial cable, a band of 
radio frequencies, a beam of light, etc. 
4. The receiver ordinarily performs the inverse operation of that done by 
the transmitter, reconstructing the’ message from the signal. 
5. The de&nation is the person (or thing) for whom the message is in- 
tended. 
We wish to consider certain general problems involving communication 
systems. 
To do this it is first necessary to represent the various elements 
involved as mathematical 
entities, suitably idealized from their physical 
counterparts. 
We may roughly classify communication systems into three 
main categories: discrete, continuous and mixed. 
By a discrete system we 
will mean one in which both the message and the signal are a sequence of 

C. E. Shannon 
discrete symbols. 
A typical 
case is telegraphy where the message is a 
sequence of letters and the signal a sequence of dots, dashes and spaces. 
A continuous system is one in which the message and signal are both treated 
as continuous functions, e.g. radio or television. 
A mixed system is one in 
which both discrete and continuous variables appear, e.g., PCM transmis- 
sion of speech. 
We first consider the discrete case. This case has applications not only 
in communication 
theory, but also in the theory of computing machines, 
the design of telephone exchanges and other fields. 
In addition the discrete 
case forms a foundation for the continuous and mixed cases which will be 
treated in the second half of the paper. 
PART 
I: DISCRETE 
NOISELESS 
SYSTEMS 
1. THE DISCRETE 
NOISELESS 
CHANNEL 
Teletype and telegraphy are two simple examples of a discrete channel 
for transmitting 
information. 
Generally, a discrete channel will mean a 
system whereby a sequence of choices from a finite set of elementary sym- 
bols Sr . . . S, can be transmitted from one point to another. 
Each of the 
symbols Si is assumed to have a certain duration in time li seconds (not 
necessarily the same for different Si , for example the dots and dashes in 
telegraphy). 
It is not required that all possible sequences of the Si be cap- 
able of transmission on the system; certain sequences only may be allowed. 
These will be possible signals for the channel. 
Thus in telegraphy suppose 
the symbols are: (1) A dot, consisting of line closure for a unit of time and 
then line open for a unit of time; (2) A dash, consisting of three time units 
of closure and one unit open; (3) A letter space consisting of, say, three units 
of line open; (4) A word space of six units of line open. 
We might place 
the restriction on allowable sequences that no spaces follow each other (for 
if two letter spaces are adjacent, it is identical with a word space). 
The 
question we now consider is how one can measure the capacity of such a 
channel to transmit information. 
In the teletype case where all symbols are of the same duration, and any 
sequence of the 32 symbols is allowed the answer is easy. Each symbol 
represents five bits of information. 
If the system transmits 
n symbols 
per second it is natural to say that the channel has a capacity of 5n bits per 
second. This does not mean that the teletype channel will always be trans- 
mitting 
information 
at this rate-this 
is the maximum 
possible rate and 
whether or not the actual rate reaches this maximum depends on the source 
of information which feeds the channel, as will appear later. 

A Mathematical Theory of Communication 
In the more general case with different lengths of symbols and constraints 
on the allowed sequences, we make the following delinition: 
Definition: The capacity C of a discrete channel is given by 
where N(T) is the number of allowed signals of duration 7’. 
It is easily seen that in the teletype case this reduces to the previous 
result. 
It can be shown that the limit in question will exist as a finite num- 
ber in most cases of interest. 
Suppose all sequences of the symbols Sr , - . . , 
S, are allowed and these symbols have durations 11, . . . , t, . What is the 
channel capacity? 
If N(1) represents the number of sequences of d’uration 
1 we have 
N(t) = N(1 - 11) + N(1 - 12) + + . . + N(1 - 1,) 
The total number is equal to the sum of the numbers of sequences ending in 
Sl,SZ, 
*-* 
, S, and these are N(1 - 1r), N(1 - is), . . . , N(1 - I~), respec- 
tively. 
According to a well known result in finite differences, N(1) is then 
asymptotic for large I to Xi where X0 is the largest real solution of the 
characteristic 
equation: 
XL’ 
+ xf2 
+ . . . + X’” 
= 1 
and therefore 
c = log x0 
In case there are restrictions on allowed sequences we may still’often ob- 
tain a difference equation of this type and find C from the characteristic 
equation. 
In the telegraphy case mentioned above 
N(1) = N(1 - 2) + NO - 4) + N(1 - 5) + N(1 - 7) + N(1 - 8) 
+ N(1 - 
10) 
as we see by counting sequences of symbols according to the last or next to 
the last symbol occurring. 
Hence C is - 
log ~0 where ~0 is the positive 
root of 1 = c;” -I- l.f4 -I- PK 4 P7 + PUB 
+ P’O* Solving this we find C = 0.539. 
A very general type of restriction which may be placed on allowed se- 
quences is the following: We imagine a number of possible states al , a2 , * * . , 
a,. 
For each state only certain symbols from the set & , * * * , S, can be 
transmitted (different subsets for the different states). 
When one of these 
has been transmitted the state changes to a new state depending both on 
the old state and the particular symbol transmitted. 
The telegraph case is 
a simple example of this. 
There are two states depending on whether or not 

10 
C. E. Shannon 
a space was the last symbol transmitted. 
If so then only a dot or a dash 
can be sent next and the stale always changes. If not, any symbol can be 
transmitted 
and the state changes if a space is sent, otherwise it remains 
the same. The conditions can bc indicated in a linear graph as shown in 
Fig. 2. The junction points correspond to the states and the lines indicate 
the symbols possible in a state and the resulting state. 
In Appendix I it is 
shown that if the conditions on allowed scqucnccs can bc described in this 
form C will exist and can bc calculated in accordance with the following 
result: 
Theorem 1: Let 6:;’ be the duration of the sul symbol which is allowable in 
state i and leads to state j. 
Then the channel capacity C is equal to log 
W where W is the largest real root of the determinant equation: 
where 6ij = 1 if i = J’ and is zero otherwise. 
DASH 
DOT 
DASH 
WORD 
SPACE 
Fig. 2-Graphical 
representation of the constraints on telegraph symbols. 
For example, in the telegraph case (Fig. 2) the determinant is: 
-1 
(1Y-2 + w-“> 
(P 
4-i Iv-“) 
(w-” 
+ 1r4 - 
1) 
= O 
On expansion this leads to the equation given above for this case. 
2. TIIE DISCRETE 
SOURCE OF INFORMATION 
We have seen that under very general conditions the logarithm 
of the 
number of possible signals in a discrctc channel increases linearly with time. 
The capacity to transmit information can be specified by giving this rate of 
increase, the number of bits per second required to specify the particular 
signal used. 
We now consider the information source. 
How is an information 
source 
to be described mathematically, 
and how much information 
in bits per sec- 
ond is produced in a given source? The main point at issue is the effect of 
statistical 
knowledge about the source in reducing the required capacity 

A Mathematical Theory of Communication 
11 
of the channel, by the use of proper encoding of the information. 
In tcleg- 
raphy, for example, the messages to be transmitted consist of sequences 
of letters. 
These sequences, however, are not completely random. 
In 
general, they form sentences and have the statistical structure of, say, Eng- 
lish. 
The letter E occurs more frequently than Q, the sequence TIS more 
frequently 
than XI’, 
etc. 
The existence of this structure allows one to 
make a saving in time (or channel capacity) by properly encoding the mes- 
sage sequences into signal sequences. This is already done to a limited ex- 
tent in telegraphy by using the shortest channel symbol, a dot, for the most 
common English letter E; while the infrequent letters, Q, X, 2, arc rcpre- 
sented by longer sequences of dots and dashes. This idea is carried still 
further in certain commercial codes where common words and phrases arc 
represented by four- or five-letter code groups with a considerable saving in 
average time. 
The standardized greeting and anniversary telegrams now 
in use extend this to the point of encoding a sentence or two into a relatively 
short sequence of numbers. 
We can think of a discrete source as generating the message, symbol by 
symbol. 
It will choose successive symbols according to certain probabilities 
depending, in general, on preceding choices as well as the particular symbols 
in question. 
A physical system, or a mathematical model of a system which 
produces such a sequence of symbols governed by a set of probabilities is 
known as a stochastic process.3 We may consider a discrete source, there- 
fore, to bc represented by a stochastic process. Conversely, any stochastic 
process which produces a discrete sequence of symbols chosen from a finite 
set may be considered a discrete source. 
This will include such cases as: 
1. Natural written languages such as English, German, Chinese. 
2. Continuous information sources that have been rendered discrete by some 
quantizing 
process. For example, the quantized speech from a PCM 
transmitter, 
or a quantized television signal. 
3. Mathematical 
cases where we merely define abstractly 
a stochastic 
process which generates a sequence of symbols. 
The following are ex- 
amples of this last type of source. 
(A) Suppose we have five letters A, B, C, D, E which are chosen each 
with probability 
.2, successive choices being independent. 
This 
would lead to a sequence of which the following is a typical example. 
BDCBCECCCADCBDDAAECEEA 
ABBDAEECACEEBAEECBCEAD 
This was constructed with the use of a table of random numbers.4 
a See, for example, S. Chandrasekhar, “Stachastic Problems in Physics and Astronomy,” 
Rcuicws 
o Modern 
Plrysics, v. 15, No. 1, January 1943, p. 1. 
4 Ken d all and Smith, “Tables of Random Sampling Numbers,” Cambridge, 1939. 

12 
C. E. Shannon 
(B) Using the same five letters let the probabilities be .4, .l, .2, .2, .l 
respectively, 
with 
successive choices independent. 
A 
typical 
message from this source is then: 
AAACDCBDCEAADADACEDA 
EADCABEDADDCECAAAAAD 
(C) A more complicated structure is obtained if successive symbols are 
not chosen independently but their probabilities depend on preced- 
ing letters. 
In the simplest case of this type a choice depends only 
on the preceding letter and not on ones before {hat. 
The statistical 
structure can then be described by a set of transition probabilities 
pi(j), 
the probability 
that letter i is followed by letter j. 
The in- 
dices i and j range over all the possible symbols. 
A second cquiv- 
alent way of specifying the structure is to give the “digram” 
prob- 
abilities p(i, j), i.e., the relative frequency of the digram i j. 
The 
letter frequencies p(i), (the probability 
of letter i), the transition 
probabilities pi(j) and the digram probabilities p(i, j) are related by 
the following formulas. 
PC4 = 7 
PCi, j) = 7 
P(j) 4 = T P(j>Pi(4 
P(i9.d = PCi)PiW 
7 
Pi(i) 
= 
7 
PC4 
= 
z 
P(i,j) 
= 
1. 
As a specific example suppose there arc three letters A, B, C with the prob- 
ability tables: 
;B$+O 
B++ 
i 
B 2~ 
27 
0 
c+ 
Z.&j 
c 
x27 
C air 
T&s 
da 
A typical message from this source is the following: 
ABBABABABABABABBBABBBBBAB 
ABABABABBBACACABBABBBBABB 
ABACBBBABA 
The next increase in complexity would involve trigram frequencies 
but no more. 
The choice of a letter would depend on the preceding 
two letters but not on the message before that point. 
A set of tri- 
gram frequencies p(i, j, k) or equivalently a set of transition prob- 

A Mathematical Theory of Communication 
13 
abilities pii 
would be required. 
Continuing in this way one ob- 
tains successively more complicated stochastic processes. In the 
general n-gram case a set of n-gram probabilities p(ir, il , . s. , &) 
or of transition 
probabilities 
pi, , ix ,... , i,-,(iJ 
is required to 
specify the statistical 
structure. 
(D) Stochastic processes can also be defined which produce a text con- 
sisting of a sequence of “words.” 
Suppose there are five letters 
A, B, C, D, E and 16 “words” 
in the language with associated 
probabilities: 
.lO A 
.16 BEBE 
.ll CABED 
.04 DEB 
.04 ADEB 
.04 BED 
.05 CEED 
.15 DEED 
.05 ADEE 
.02 BEED 
.Og DAB 
.Ol EAB 
.Ol BADD 
.05 CA 
.04 DAD 
.0.5 EE 
Suppose successive “words” 
are chosen independently 
and are 
separated by a space. A typical message might be: 
DAB EE A BEBE DEED 
DEB ADEE ADEE EE DEB BEBE 
BEBEBEBEADEEBEDDEEDDEEDCEEDADEEADEED 
DEED 
BEBE CABED 
BEBE BED DAB DEED 
ADEB 
If all the words are of finite length this process is equivalent to one 
of the preceding type, but the description may be simpler in terms 
of the word structure and probabilities. 
We may also generalize 
here and introduce transition probabilities between words, etc. 
These artificial languages are useful in constructing simple problems and 
examples to illustrate various possibilities. 
We can also approximate to a 
natural language by means of a series of simple artificial languages. The 
zero-order approximation 
is obtained by choosing all letters with the same 
probability 
and independently. 
The first-order approximation is obtained 
by choosing successive letters independently but each letter having the 
same probability 
that it does in the natural language.6 Thus, in the first- 
order approximation 
to English, E is chosen with probability 
.12 (its fre- 
quency in normal English) and W with probability 
.02, but there is no in- 
fluence between adjacent letters and no tendency to form the preferred 
digrams such as TIT, ED, etc. 
In the second-order approximation, 
digram 
structure is introduced. 
After a letter is chosen, the next one is chosen in 
accordance with the frequencies with which the various letters follow the 
first one. This requires a table of digram frequencies pi(j). 
In the third- 
order approximation, 
trigram structure is introduced. 
Each letter is chosen 
with probabilities which depend on the preceding two letters. 
6 Letter, digram and trigram frequencies are given in “Secret and Urgent” by Fletcher 
Pratt, Blue Ribbon Books 1939. Word frequencies are tabulated in ‘LRelative Frequency 
of English Speech Sounds,” G. Dewey, Harvard University Press, 1923. 

C. E. Shannon 
3. T~IE SERIES OF APPROXIMATIONS 
TO ENGLISH 
To give a visual idea of how this series of processes approaches a language, 
typical sequences in the approximations to English have been constructed 
and are given below. 
In all cases we have assumed a 27-symbol “alphabet,” 
the 26 letters and a space. 
1. Zero-order approximation 
(symbols independent and equi-probable). 
XFOML 
RXKHR JFF JU J ZLPWCFWKCY 
J 
FFJEYVKCQSGXYD 
QI’AAMKBZAACIBZLHJQD 
2. First-order approximation 
(symbols independent but with frequencies 
of English text). 
OCR0 HLI RGWR NMIELWIS 
EU LL NBNESEBYA 
TH EEI 
ALHENH’ITPA 
OOBTTVA 
NAH BRL 
3. Second-order approximation 
(digram structure as in English). 
ON IE ANTSOUTINYS 
ARE T INCTORE 
ST BE S DEAMY 
ACHIN 
D ILONASIVE 
TUCOOWE 
AT TEASONARE 
FUSO 
TIZIN 
ANDY 
TOBE 
SEACE CTISBE 
4. Third-order 
approximation 
(trigram 
structure as in English), 
IN NO IST LAT WHEY 
CRATICT 
FROURE 
BIRS 
GROCID 
PONDENOME 
OF DEMONSTURES 
OF THE 
REPTAGIN 
IS 
REGOACTIONA 
OF CRE 
5. First-Order Word Approximation. 
Rather than continue with tetra- 
gram, *.* , It-gram structure it is easier and better to jump at this 
point to word units. 
Here words are chosen independently but with 
their appropriate frequencies. 
REPRESENTING 
AND 
SPEEDILY 
IS AN GOOD APT 
OR 
COME CAN DIFFERENT 
NATURAL 
HERE 
HE THE 
A IN 
CAME 
THE 
TO OF TO EXPERT 
GRAY 
COME 
TO FUR- 
NISHES THE LINE MESSAGE HAD BE THESE. 
6. Second-Order Word Approximation. 
The word transition 
probabil- 
ities are correct but no further structure is included. 
THE HEAD AND IN FRONTAL 
ATTACK 
ON AN ENGLISH 
WRITER 
THAT 
THE 
CHARACTER 
OF THIS 
POINT 
IS 
THEREFORE 
ANOTHER 
METHOD 
FOR THE 
LETTERS 
THAT 
THE 
TIME 
OF WHO EVER 
TOLD 
THE 
PROBLEM 
FOR AN UNEXPECTED 
The resemblance to ordinary English text increases quite noticeably at 
each of the above steps. 
Note that these samples have reasonably good 
structure out to about twice the range that is taken into account in their 
construction. 
Thus in (3) the statistical process insures reasonable text 
for two-letter 
sequence, but four-letter 
sequences from the sample can 
usually be fitted into good sentences. In (6) sequences of four or more 

A Mathematical Theory of Communication 
15 
words can easily be placed in sentences without unusual or strained con- 
structions. 
The particular 
sequence of ten words “attack 
on an English 
writer that the character of this” is not at all unreasonable. 
It appears 
then that a sufficiently complex stochastic process will give a satisfactory 
representation of a discrete source. 
The first two samples were constructed by the use of a book of random 
numbers in conjunction with (for example 2) a table of letter frequencies. 
This method might have been continued for (3), (4), and (S), since digram, 
trigram, and word frequency tables arc available, but a simpler equivalent 
method was used. To construct (3) for example, one opens a book at ran- 
dom and selects a letter at random on the page. This letter is recorded. 
The book is then opened to another page and one reads until this letter is 
encountered. 
The succeeding letter is then recorded. 
Turning to another 
page this second letter is searched for and the succeeding letter recorded, 
etc. 
A similar process was used for (4), (S), and (6). 
It would be intercst- 
ing if further approximations could be constructed, but the labor involved 
becomes enormous at the next stage. 
4. GRAIWCAL 
REPRESENTATION OF A MARKOFP PROCESS 
Stochastic’ processes of the type described above arc known mathe- 
matically as discrete Markoff processes and have been extensively studied in 
the literature.6 
The general case can be described as follows: There exist a 
finite number of possible “states” of a system; 5’1 , SC , . . . , S, . In addi- 
tion there is a set of transition probabilities; PiG) the probability 
that if the 
system is in state Si it will next go to state Sj . To make this Markoff 
process into an information source we need only. assume that a letter is pro- 
duced for each transition from one state to another. 
The states will corre- 
spond to the “residue of influence” from preceding letters. 
The situation can be represented graphically as shown in Pigs. 3, 4 and 5. 
The “states” are the junction points in the graph and the probabilities and 
letters produced for a transition arc given beside the corresponding line. 
Figure 3 is for the example B in Section 2, while Fig. 4 corresponds to the 
example C. 
In Fig. 3 there is only one state since successive letters are 
independent. 
In Fig. 4 them are as many states as letters. 
If a trigram 
example were constructed there would bc at most lz2 states corresponding 
to the possible pairs of letters preceding the one being chosen. Figure 5 
is a graph for the case of word structure in example D. 
Here S corresponds 
to the “space” symbol. 
6 For a detailed treatment see M. Frechet, “Methods des lonctions arbitraires. 
Theo& 
des Cn6nements en chaine dans Ic cas d’un nombre fini d’C?ats possibles.” 
Paris, Gauthier- 
Villars, 1938. 

16 
C. E. Shannon 
5. ERGODIC 
AND MIXED 
SOURCES 
As we have indicated above a discrete source for our purposes can be con- 
sidered to be represented by a Markoff process. Among the possible discrete 
Markoff processes there is a group with special properties of significance in 
E 
.I 
Fig. 3-A 
graph corresponding to the source in example I). 
C 
B 
AA 
.a 
2 & 
5 
.5 
B 
C 
B 
.4 
5 
.I 
Fig. 4-A 
graph corresponding to the source in example C. 
Fig. S-A graph corresponding to the source in example D. 
communication 
theory. 
This special class consists of the “ergodic” 
proc- 
esses and we shall call the corresponding sources ergodic sources. Although 
a. rigorous definition of an ergodic process is somewhat involved, the general 
idea is simple. 
In an ergodic process every sequence produced by the proc- 

A Mathematical Theory of Communication 
17 
ess is the same in statistical 
properties, 
Thus the letter frequencies, 
digram frequencies, etc., obtained from particular 
sequences will, as the 
lengths of the sequences increase, approach definite limits independent of 
the particular sequence. Actually this is not true of every sequence but the 
set for which it is false has probability 
zero. 
Roughly the ergodic property 
means statistical 
homogeneity. 
All the examples of artificial languages given above are ergodic. 
This 
property is related to the structure of the corresponding graph. 
If the graph, 
has the following two properties’ the corresponding process will be ergodic: 
1. The graph does not consist of two isolated parts A and B such that it is 
impossible to go from junction points in part A to junction points in 
part B along lines of the graph in the direction of arrows and also im- 
possible to go from junctions in part B. to junctions in part A. 
2. A closed series of lines in the graph with all arrows on the lines pointing 
in the same orientation will be called a “circuit.” 
The “length” 
of a 
circuit is the number of lines in it. 
Thus in Fig. 5 the series BEBES 
is a circuit of length 5. The second property required is that the 
greatest common divisor of the lengths of all circuits in the graph be 
one. 
If the first condition is satisfied but the second one violated by having the 
greatest common divisor equal to d > 1, the sequences have a certain type 
of periodic structure. 
The various sequences fall into d different classes 
which are statistically 
the same apart from a shift of the origin (i.e., which 
letter in the sequence is called letter 1). By a shift of from 0 up to d - 
1 
any sequence can be made statistically 
equivalent to any other. 
A simple 
example with d = 2 is the following: There are three possible letters a, b, c. 
Letter a is followed with either b or c with probabilities $ and $ respec- 
tively. 
Either b or c is always followed by letter a. Thus a typical sequence 
is 
abacacacabacababacac 
This type of situation is not of much importance for our work. 
If the first condition is violated the graph may be separated into a set of 
subgraphs each of which satisfies the first condition. 
We will assume that 
the second condition is also satisfied for each subgraph. 
We have in this 
case what may be called a “mixed” 
source made up of a number of pure 
components. 
The components 
correspond to the various 
subgraphs. 
If Ll , Lz , La , .+. are the component sources we may write 
L 
= 
PlLl 
-I- 
PJ2 
f 
p& 
-I- 
’ - ’ 
where pi is the probability 
of the component source LC . 
7 These are restatements in terms of the graph of conditions given in &whet. 

18 
C. E. Shannon 
Physically 
the situation represented is this: There are several d&rent 
sources LI,Lz,L~, 
-se which are each of homogeneous statistical structure 
(i.e., they are ergodic). 
WC do not know a priori which is to be used, but 
once the sequence starts in a given pure component Li it continues indcf- 
nitely according to the statistical structure of that component. 
As an example one may take two of the processes delined above and 
assume pl = .2 and pz = .8. A sequence from the mixed source 
L = .2 Ll+ .8 Lz 
would be obtained by choosing first L1 or Lz with probabilities 
.2 and .8 
and after this choice generating a sequence from whichcvcr was chosen. 
Except when the contrary is stated we shall assume a source to bc crgodic. 
This assumption enables one to identify averages along a sequence with 
averages over the ensemble of possible sequences (the probability 
of a dis- 
crepancy being zero). 
For example the relative frequency of the letter A 
in a particular 
infinite sequence will bc, with probability 
one, equal to its 
relative frequency in the ensemble of sequences. 
If Pi is the probability 
of state i and pi(j) the transition probability 
to 
state j, then for the process to bc stationary it is clear that the Pi must 
satisfy equilibrium 
conditions: 
In the ergodic case it can bc shown that with any starting conditions the 
probabilities Z’#V) of being in state j after N symbols, approach the equi- 
librium values as N + 
00. 
6. CHOICE, 
UNCERTAINTY 
AND ENTROPY 
We have represented a discrete information source as a Markoff process. 
Can WC dehne a quantity which will measure, in some sense, how much in- 
formation is “produced” by such a process, or better, at what rate informa- 
tion is produced? 
Suppose we have a set of possible events whose probabilities of occurrence 
are pl , p2 , * * * , p, . These probabilities 
are known but that is all we know 
concerning which event will occur. 
Can we find a measure of how much 
“choice” is involved in the selection of the event or of how uncertain we are 
of the outcome? 
If there is such a measure, say ZZ(pr , 122 , * . * , p,), it is reasonable to re- 
quire of it the following properties: 
1. ZZ should .be continuous in the pi. 
2. If all the pi are equal, pi = k, then ZZ should be a monotonic increasing 

A Mathematical Theory of Communication 
19 
function of 12. With equally likely events there is more choice, or un- 
certainty, when there are more possible events. 
3. If a choice be broken down into two successive choices, the origina 
H should be the weighted sum of the individual 
values of H. The 
meaning of this is illustrated 
in Fig. 6. At the left we have three 
possibilities pl = 3, PZ = g, $3 = f. 
On the right we first choose be- 
tween two possibilitiesleach with probability 4, and if the second occurs 
make another choice with probabilities $, 5. The final results have 
the same probabilities 
as before. 
We require, in this special case, 
that 
H(& 4, 3) = a($, 3) + $ZZ($, f) 
The coefficient $ is because this second choice only occurs half the time. 
Fig. 6-Decomposition 
of a choice from three possibilities. 
In Appendix II, the following result is established: 
TJzeorem 2: The only H satisfying the three above assumptions is of the 
form: 
where K is a positive constant. 
This theorem, and the assumptions required for its proof, are in no way 
necessary for the present theory. 
It is given chiefly to lend a certain plausi- 
bility to some of our later definitions. 
The real justification 
of thcsc defi- 
nitions, however, will reside in their implications. 
Quantities of the form H = --Z pi log pi (the constant K mekely amounts 
to a choice of a unit of measure) play a central role in information theory as 
measures of information, 
choice and uncertainty. 
The form of II will be 
recognized as that of entropy as defined in certain formulations of statistical 
mechanics8 where pi is the probability 
of a system being in cell i of its phase 
space. U is then, for example, the U in Boltzmann’s famous ZZ theorem. 
We shall call H = - 
I: pi log pi the entropy of the set of probabilities 
*See, for example, R. C. Tolman, “Principles of Statistical Mechanics,” Oxford. 
Clarendon, 1938. 

20 
C. E. Shannon 
Pl, 
- * * , P* * If x is a chance variable we will write U(X) for its entropy; 
thus x is not an argument of a function but a label for a number, to differen- 
tiate it from ZZ(y) say, the entropy of the chance variable y. 
The entropy in the case of two possibilities with probabilities p and q = 
1 - 
p, namely 
H= -(PhzPf~~yQ?) 
is plotted in Fig. 7 as a function of p. 
The quantity ZZ has a number of interesting properti& which further sub- 
stantiate it as a reasonable measure of choice or information. 
Fig. t--Entropy 
in the case of two possibilities with probabilities p and (1 - p). 
1. ZZ = 0 if and only if all the pi but one are zero, this one having the 
value unity. 
Thus only when we are certain of the outcome does II vanish. 
Otherwise ZZ is positive. 
2. For a given n, ZZ is a maximum and equal to log n when all the pi are 
equal 
1 
( 
> 
i.e., - 
. This is also intuitively 
the most uncertain situation. 
IL 
3. Suppose there are two events, x and y, in question with m possibilities 
for the first and n for the second. Let p(i, j) be the probability 
of the joint 
occurrence of i for the first and j for the second. The entropy of the joint 
event is 
H(x, y) = - 

A Mathematical Theory of Communication 
while 
21 
H(x) = - 
B(y) = - lg PG, 3 1% ly PG, 3. 
It is easily shown that 
with equality only if the events are independent (i.e., p(i, J) = p(i) PO’)). 
The uncertainty 
of a joint event is less than or equal to the sum of the 
individual 
uncertainties. 
4. Any change toward equalization of the probabilities pr , pz , - - . , p, 
increases ZZ. Thus if pr < PZ and we increase pr , decreasing pz an equal 
amount so that pr and pz are more nearly equal, then H increases. More 
generally, if we perform any “averaging” 
operation on the pi of the form 
p: = C aij pj 
i 
where c 
aij = c 
aij = 1, and all aij 2 0, then H increases (except in the 
i 
i 
special case where this transformation amounts to no more than a permuta- 
tion of the pj with ZZ of course remaining the same). 
5. Suppose there are two chance events x and y as in 3, not necessarily 
independent. 
For any particular value i that x can assume there is a con- 
ditional probability 
pi(j) that y has the value j. 
This is given by 
PC4 .i) 
Pd.9 = c p(i, j> * 
i 
We define the conditional entropy of y, Zi=(y) as the average of the entropy 
of y for eacli value of x, weighted according to the probability 
of getting 
that particular 
x. 
That is 
my> 
= -c 
PG, j> 1% Pi(j). 
i,i 
This quantity measures how uncertain we are of y on the average when we 
know x. 
Substituting the value of PiG) we obtain 
Hz(y) = -C 
PG, j> log PC, j> + C PC;, j> log C PG, j) 
ii 
ij 
i 
= H(x, y) - ZZ(x) 
or 
wx, y> = H(x) + fIz(y) 

C. E. Shannon 
The uncertainty (or entropy) of the joint event 2, y is the uncertainty of x 
plus the uncertainty of y when x is known. 
6. From 3 and 5 we have 
Hence 
H(x) + H(y) 2 ah, 
y) = H(x) + Hz(y) 
H(Y) 2 ZJzb) 
The uncertainty of y is never increased by knowleclge of x. 
It will bc de- 
creased unless x and y are independent events, in which case it is not changed. 
7. Trr~ ENTKOPY OF AN INFORMATION SOURCE 
Consider a discrete source of the finite state type considered above. 
For each possible state i there will be a set of probabilities pi(j) 
of pro- 
ducing the various possible symbols j. 
Thus there is an entropy ZZi for 
each state. 
The entropy of the source will be clelincd as the average of 
these Zli weighted in accordance with the probability 
of occurrcncc of the 
states in question: 
II = C Pi ZZi 
= 1% PiPi 
log Pi(j) 
This is the entropy of the source per symbol of text. 
If the Markoff proc- 
ess is proceeding at a definite time rate there is also an entropy per second 
ZZ’ = 7 jilii 
wherefi is the average frequency (occurrences per second) of state i. Clearly 
II’ = ntIZ 
where IU is the average number of symbols produced per second. ZZ or II’ 
measures the amount of information 
generated by the source per symbol 
or per second. If the logarithmic base is 2, they will represent bits per 
symbol or per second. 
If successive symbols are independent then ZZ is simply -z 
pi log pi 
where pi is the probability 
of symbol i. 
Suppose in this case we consider a 
long message of N symbols. 
It will contain with high probability 
about 
plN occurrences of the first symbol, PzN occurrences of the second, etc. 
Hence the probability 
of this particular message will be roughly 
p = pf~NP;=N.. 
.pbnN 
or 

A Mathematical Theory of Communication 
23 
log p G N c 
p; log pi 
i 
ZZ is thus approximately 
the logarithm of the reciprocal probability 
of a 
typical long sequence divided by the number of symbols in the sequence. 
The same result holds for any source. Stated more precisely we have (see 
Appendix III) : 
Theorem 3: Given any e > 0 and 6 > 0, we can find an No such that Lhe se- 
quences of any length N 2 No fall into two classes: 
1. A set whose total probability 
is less than e. 
2. The remainder, all of whose members have probabilities satisfying the 
inequality 
log p--’ 
---II 
<Is 
N 
log p-i 
In other words we are almost certain to have N 
very close to II when N 
is large. 
A closely related result deals with the number of sequences of various 
probabilities. 
Consider again the sequences of length N and let them be 
arranged in order of decreasing probability. 
We dehne s(q) to be the 
number we must take from this set starting with the most probable one in 
order to accumulate a total probability q for those taken. 
Theorem 4: 
Lim log n(rl) = ZZ 
N-tm 
N 
when q does not equal 0 or 1. 
We may interpret log IZ(~) as the number of bits required to specify the 
sequence when we consider only the most probable sequences with a total 
probability 
q. Then l?!.!?!@ 
* 
N 
1s the number of bits per symbol for the 
specification. 
The theorem says that for large N this will be independent of 
Q and equal to ZZ. The rate of growth of the logarithm of the number of 
reasonably probable sequences is given by ZZ, regardless of our intcrpreta- 
tion of “reasonably probable.” 
Due to these results, which are proved in 
appendix III, it is possible for most purposes to treat the long sequences as 
though there were just 21fN of them, each with a probability 2-“N. 

24 
C. E. Shannon 
The next two theorems show that ZZ and II’ can be determined by limit- 
ing operations directly from the statistics of the message sequences, without 
reference to the states and transition probabilities between states. 
Theorem 5: Let p(Bi) be the probability 
of a sequence i3i of symbols from 
the source. Let 
GN = -; 
F Pm> log p(l&) 
where the sum is over all sequences B; containing N symbols. 
Then GN 
is a monotonic decreasing function of N and 
Lim GN = ZZ. 
N--a, 
Theorem 6: Let p(O< , Sj) be the probability 
of sequence Ui followed by 
symbol Sj and psi(Sj) = p(8i, 
Sj)/p(ZJJ be the conditional probability 
of 
Sj after Bi. 
Let 
FN = -C 
P(Bc, sj> log foi(Sj) 
i.i 
where the sum is over all blocks Bi of N - 
1 symbols and over all symbols 
Sj . Then FN is a monotonic decreasing function of N, 
ZJN = NGN -(N 
- 1) CN-~ , 
and Lim FN = ZZ. 
Thzse*results are derived in appendix III. 
They show that a series of 
approximations to ZZ can be obtained by considering only the statistical 
structure of the sequences extending over 1, 2, .-a N symbols. 
PN is the 
better approximation. 
In fact PN is the entropy of the Nlh order approxi- 
mation to the source of the type discussed above. 
If there arc no statistical 
influences extending over more than N symbols, that is if the conditional 
probability 
of the next symbol knowing the preceding (N - 
1) is not 
changed by a knowledge of any before that, then ZJN = ZZ. PN of course is 
the conditional entropy of the next symbol when the (N - 
1) preceding 
ones are known, while GN is the entropy per symbol of blocks of N symbols. 
The ratio of the entropy of a source to the maximum value it could have 
while still restricted to the same symbols will be called its relaiive enlropy. 
This is the maximum compression possible when we encode into the same 
alphabet. 
One minus the relative entropy is the redwdancy. The redun- 

A Mathematical Theory of Communication 
25 
dancy of ordinary English, not considering statistical structure over greater 
distances than about eight letters is roughly 50%. 
This means that when 
we write English half of what we write is determined by the structure of the 
language and half is chosen freely. 
The figure 50% was found by several 
independent methods which all gave results in this neighborhood. 
One is 
by calculation of the entropy of the approximations to English. 
A second 
method is to delete a certain fraction of the letters from a sample of English 
text and then let someone attempt to restore them. 
If they can be re- 
stored when 50% are deleted the redundancy must be grcatcr than 500/,. 
A third method depends on certain known results in cryptography. 
Two extremes of redundancy in English prose are represented by Basic 
English and by James Joyces’ book “Finigans Wake.” 
The Basic English 
vocabulary is limited to 850 words and the redundancy is very high. 
This 
is reflected in the expansion that occurs when a passage is translated into 
Basic English. 
Joyce on the other hand enlarges the vocabulary and is 
alleged to achieve a compression of semantic content. 
The redundancy of a language is related to the existence of crossword 
puzzles. 
If the redundancy is zero any sequence of letters is a reasonable 
text in the language and any two dimensional array of letters forms a cross- 
word puzzle. 
If the redundancy is too high the language imposes too 
many constraints for large crossword puzzles to be possible. 
A more de- 
tailed analysis shows that if we assume the constraints imposed by the 
language are of a rather chaotic and random nature, large crossword puzzles 
are just possible when the redundancy is 50%. 
If the redundancy is 33%, 
three dimensional crossword puzzles should be possible, etc. 
8. REPRESENTATION OF THE ENCODING AND DECODING OPERATIONS 
We have yet to represent mathematically 
the operations performed by 
the transmitter 
and receiver in encoding and decoding the information. 
Either of these will be called a discrete transducer. 
The input to the 
transducer is a sequence of input symbols and its output a sequence of out- 
put symbols. 
The transducer may have an internal memory so that its 
output depends not only on the present input symbol but also on the past 
history. 
We assume that the internal memory is finite, i.e. there exists 
a finite number m of possible states of the transducer and that its output is 
a function of the present state and the present input symbol. 
The next 
state will be a second function of these two quantities. 
Thus a transducer 
can be described by two functions: 

26 
C. E. Shannon 
where: x,, is the jt.lh input symbol, 
(Y,, is the state of the transducer when the ftfh input symbol is introduced, 
y” is the output symbol (or sequence of output symbols) produced when 
x,, is introduced if the state is (Y,,. 
If the output symbols of one transducer can bc identified with Lhc input 
symbols of a second, they can be connected in tandem and the result is also 
a transducer. 
If there exists a second transducer which operates on the out- 
put of the first and recovers the original input, the first transducer will be 
called non-singular and the second will be called its inverse. 
Theorem 7: The output of a finite state transducer driven by a finite state 
statistical source is a finite state statistical source, with entropy (per unit 
time) less than or equal to that of the input. 
If the transducer is non- 
singular they arc equal. 
Let (Y reprcscnt the state of the source, which produces a sequence of 
symbols xi ; and let /3 be the state of the transducer, which produces, in its 
output, blocks of symbols yj . The combined system can be represented 
by the “product 
state space” of pairs (a, p). 
Two points in the space, 
(at, PI) ad 
((112 
Pz), are connected by a line if CQ can produce an x which 
changes /31 to /3z , and this line is given the probability 
of that x in this case. 
The line is labeled with the block of yi symbols produced by the transducer. 
The entropy of the output can be calculated as the weighted sum over the 
states. 
If we sum first on 0 each resulting term is less than or equal to the 
corresponding term for 01, hence the entropy is not increased. 
If the trans- 
ducer is non-singular let its output bc connected to the inverse transducer. 
If ZZ: , ZZ: and ZZ; arc the output entropies of 1-he source, the first and 
second transducers respectively, then ZZ: 2 ZZ: 2 ZZ; = ZZ: and therefore 
n: 
= zi: . 
Suppose we have a system of constraints on possible sequences of the type 
which can be represented by a linear graph as in Fig. 2. If probabilities 
p$’ were assigned to the various lines connecting state i Lo statej this would 
become a source. There is one particular assignment which maximizes the 
resulting entropy (see Appendix IV). 
Theorem 8: Let the system of constraints considered as a channel have a 
capacity C. 
If we assign 
where Eiy is the duration of the sfh symbol leading from state i to state ,j 
and the Bi satisfy 
then ZZ is maximized and equal to C. 

A Mathematical Theory of Communication 
27 
By proper assignment of the transition probabilities the entropy of sym- 
bols on a channel can be maximized at the channel capacity. 
9. TIIE 
FUNDAIVIENTAL THEOREM FOR A NOISELESS CIIAWEL. 
We will now justify our interpretation 
of ZZ as the rate of gcncrating 
information by proving that ZZ determines the channel capacity required 
with most efficient coding. 
Theorent 9: Let a source have entropy ZZ (bits per symbol) and a channel 
have a capacity C (bits per second). 
Then it is possible to encode the output 
of the source in such a way as to transmit at the average rate i - E symbols 
per second over the channel where c is arbitrarily 
sinall. 
II is not possible 
to transmit at an average rate greater than 2 II * 
The converse part of the theorem, that g cannot bc exceeded, may be 
proved by noting that the entropy of the channel input per second is equal 
to that of the source, since the transmitter must be noksingular, 
and also 
this entropy cannot exceed the channel capacity. 
Hence ZZ’ < C and the 
number of symbols per second = ZZ’/ZZ < C/N. 
The first part of the theorem will be proved in two different ways. 
The 
first method is to consider the set of all sequencds of N symbols produced by 
the source. 
For N large we can divide these into two groups, one containing 
less than 2(“+“jN members and the second containing less than 2RN members 
(where R is the logarithm of the number of different symbols) and having a 
total probability 
less than p. 
As N increases 11 and /J approach zero. 
The 
number of signals of duration T in the channel is greater than 2’C-B’T with 
o small when T is large. 
If we choose 
then there will be a suflkicnt number of sequences of channel symbols for 
the high probability 
group when N and T are sufficiently large (however 
small X) and also some additional ones. The high probability 
group is 
coded in an arbitrary one to one way into this set. The remaining sequences 
are represented by larger sequences, starting and ending with one of the 
sequences not used for the high probability 
group. 
This special sequence 
acts as a start and stop signal for a different code. In between a sufkient 
time is allowed to give enough different sequences for all Lhc low probability 
messages. This will require 

C. E. Shannon 
where Q is small. 
The mean rate of transmission in message symbols per 
second will then be greater than 
[ (1 - fj) ; + 6 ;I-’ = [ (1 - a> g + 1) + 6 (g + PJJ-’ 
As N increases 6, X and p approach zero and the rate approaches g , 
Another method of performing this coding and proving the theorem can 
be described as follows: Arrange the messages of length N in order of dccreas- 
ing probability 
and suppose their probabilities are. pI 2 pz 2. pa . . . 2 pn . 
n-1 
Let P, = F 
pi ; h 
t at is P. is the cumulative probability 
up to, but not 
m&ding, 
p, . We first encode into a binary system. 
The binary code for 
message s is obtained by expanding P, as a binary number. 
The expansion 
is carried out to ns. places, where wz. is the integer satisfying: 
Thus the messages of high probability 
are represented by short codes and 
those of low probability 
by long codes. From these inequalities we have 
The code for P. will differ from al\ succeeding ones in one or more of its 
?n8 places, since all the remaining Pi are at least & 
larger and their binary 
expansions therefore differ in the first fti2, places. 
Consequently all the codes 
are different and it is possible to recover the message from it-s code. If the 
channel sequences are not already sequences of binary digits, they can be 
ascribed binary numbers in an arbitrary 
fashion and the binary code thus 
translated into signals suitable for the channel. 
The average number II’ of binary digits used per symbol of original mes- 
sage is easily estimated. 
WC have 
II’ = f z??t,p. 
But, 
;z 
log2 f 
P8 5 
( 
) 
8 
$%p* 
< ;.(1 
+ log23. 
and therefore, 

A Mathematical Theory of Communication 
29 
~~ < II’ < 
GN 
-I- 
$ 
As N increases GN approaches 11, the entropy of the source and a’ ap- 
proaches 11. 
We see from this that the incfliciency in coding, when only a finite delay of 
N symbols is used, need not be greater than $ plus the difference between 
the true entropy Ii and the entropy GN calculated for sequences of length N. 
The per cent excess time needed over the ideal is therefore less than 
This method of encoding is substantially 
the same as one found inde- 
penclcntly by R. M. Fano? 
His method is to arrange the messages of length 
N in order of decreasing probability. 
Divide this series into two groups of 
as nearly equal probability as possible. 
If the message is in the first group 
its first binary digit will be 0, otherwise 1. The groups are similarly divided 
into subsets of nearly equal probability 
and the particular subset determines 
the second binary digit. 
This process is continued until each subset contains 
only one message. It is easily seen that apart from minor differences (gen- 
erally in the last digit) this amounts to the same thing as the arithmetic 
process described above. 
10. DISCUSSION AND EXAMPLES 
In order to obtain the maximum power transfer from a generator to a load 
a transformer must in general be introduced so that the generator as seen 
from the load has the load resistance. 
The situation here is roughly anal- 
ogous. The transducer which does the encoding should match the source 
to the channel in a statistical sense. The source as seen from the channel 
through the transducer should have the same statistical structure as the 
source which maximizes the entropy in the channel. 
The content of 
Theorem 9 is that, although an exact match is not in general possible, WC can 
approximate it as closely as desired. 
The ratio of the actual rate of trans- 
mission to the capacity C may be called the eflicicncy of the coding system. 
This is of course equal to the ratio of the actual entropy of the channel 
symbols to the maximum possible entropy. 
In general, ideal or nearly ideal encoding requires a long delay in the 
transmitter 
and receiver. 
In the noiseless case which we have been 
considering, the main function of this delay is to allow reasonably good 
0 Technical Report No. 65, The Research Laboratory of Electrofiics, M. I. T. 

30 
C. E. Shannon 
matching of probabilities 
to corresponding lengths of sequences. With a 
good code the logarithm 
of the reciprocal probability 
of a long message 
must be proportional 
to the duration of the corresponding signal, in fact 
1% 
P-’ 
_ 
c 
-- T 
must be small br all but a small fraction of the long messages. 
If a source can produce only one particular message its entropy is zero, 
and no channel is required. 
For example, a computing machine set up to 
calculate the successive digits of a produces a dctinite sequcncc with no 
chance element. 
No channel is required to “transmit” 
this to another 
point. 
One could construct a second machine to compute the same sequcncc 
at the point. 
However, this may be impractical. 
In such a case WC can 
cl~oose to ignore some or all of the statistical knowledge WC have of the 
source. We might consider the digits of R to be a random sequence in that 
we construct a system capable of sending any sequence of digits. 
In a 
similar way we may choose to use some of our statistical knowledge of Eng- 
lish in constructing a code, but not all of it. 
In such a case we consider the 
source with the maximum entropy subject to the statistical conditions we 
wish to retain. 
The entropy of this source determines the channel capacity 
which is necessary and sufficient. 
In the R example the only information 
retained is that all the digits arc chosen from the set 0, 1, 
, 9. In the 
case of English one might wish to use the statistical saving possible due to 
letter frequencies, but nothing else. The maximum entropy source is then 
the first approximation 
to English and its entropy determines the required 
channel capacity. 
As a simple example of some of these results consider a source which 
produces a sequence of letters chosen from among A, 11, C, D with prob- 
abilities 4, 4, $, i, successive symbols being chosen indcpcndently. 
We 
have 
II = - ($ log $ -+ ; log 4 + 8 log +> 
= 2 bits per symbol. 
Thus we can approximate a coding system to encode messages from this 
source into binary digits with an average of z binary digit per symbol. 
In this case we can actually achieve the limiting value by the following code 
(obtained by the method of the second proof of Theorem 9) : 

A Mathematical Theory of Communication 
31 
A 
0 
l3 
10 
c 
110 
D 
111 
The average number of binary digits used in encoding a sequence of N sym- 
bols will be 
N($ X 1 + $ X 2 + $ X 3) = -$N 
It is easily seen that the binary digits 0, 1 have probabilities 3, i:; so the II for 
the coded sequences is one bit per symbol. 
Since, on the average, WC have p 
binary symbols per original letter, the entropies on a time basis are the 
same. The maximum possible entropy for the original set is log 4 = 2, 
occurring when li, 13, C, D have probabilities f, 4, 3, 1. 
Hcncc the relative 
entropy is g. 
We can translate the binary sequences into the original set of 
symbols on a two-to-one basis by the following table: 
00 
Al 
01 
U’ 
10 
C’ 
11 
D’ 
This double process then encodes the original message into the same symbols 
but with an average compression ratio s . 
As a second example consider a source which produces a sequence of A’s 
and U’s with probability p for A and Q for U. 
If p < < q we have 
I-I = -log p”(1 - p>‘-” 
= -p log p (1 - py-p)‘p 
In such a case one can construct a fairly good coding of the message on a 
0, 1 channel by sending a special sequence, say 0000, for the infrequent 
symbol n and then a sequence indicating the nu&er 
of B’s following it. 
This could be indicated by the binary representation with all numbers con- 
taining the special sequence deleted. 
All numbers up to 16 are represented 
as usual; 16 is represented by the next binary number after 16 which does 
not contain four zeros, namely 17 = 10001, etc. 
It can be shown that as p -+ 0 the coding approaches ideal provided the 
length of the special sequence is properly adjusted. 

32 
C. E. Shannon 
PART II: THE DISCRETE 
CHANNEL 
WITH 
NOISE 
11. REPRESENTATION OF A NOISY DISCRIXTIZ CHANNEL 
We now consider the case where the signal is perturbed by noise during 
transmission or at one or the other of the terminals. 
This means that the 
received signal is not necessarily the same as that sent out by the trans- 
mitter. 
Two cases may be distinguished. 
If a particular transmitted signal 
always produces the same received signal, i.e. the received signal is a definite 
function of the transmitted signal, then the effect may be called distortion. 
If this function has an inverse--no two transmitted signals producing the 
same received signal-distortion 
may be corrected, at least in principle, by 
merely performing the inverse functional operation on the received signal. 
The case of interest here is that in which the signal does not always undergo 
the same change in transmission. 
In this case we may assume the received 
signal E to be a function of the transmitted signal 5’ and a second variable, 
the noise N. 
E = f(S, N) 
The noise is considered to be a chance variable just as the message was 
above. 
In general it may be represented by a suitable stochastic process. 
The most general type of noisy discrete channel we shall consider is a general- 
ization of the finite state noise free channel described previously. 
We 
assume a finite number of states and a set of probabilities 
Pa.dA 3. 
This is the probability, 
if the channel is in state a! and symbol i is trans- 
mitted, that symbol j will be received and the channel left in state p. 
Thus 
(Y and /3 range over the possible states, i over the possible transmitted signals 
and j over the possible received signals. 
In the case where successive sym- 
bols are independently perturbed by the noise there is only one state, and 
the channel is described by the set of transition probabilities pi(j), the prob- 
ability of transmitted symbol i being received as j. 
If a noisy channel is fed by a source there are two statistical processes at 
work: the source and the noise. Thus there are a number of entropies that 
can be calculated. 
First there is the entropy 11(x) of the source or of the 
input to the channel (these will be equal if the transmitter is non-singular), 
The entropy of the output of the channel, i.e. the received signal, will be 
denoted by U(y). 
In the noiseless case I!(y) = N(x). 
The joint entropy of 
input and output will be 116~~). Finally there are two conditional entro- 
pies Ii,(y) and II&x), 
the entropy of the output when the input is known 
and conversely. 
Among these quantities we have the relations 
H(x, y) = U(x) + II,(y) 
= H(y) + I$(4 

A Mathematical Theory of Communication 
33 
All of these entropies can be measured on a per-second or a per-symbol 
basis. 
12. EQUIVOCATION AND CHANNEL CAPACITY 
If the channel is noisy it is not in general possible to reconstruct the orig- 
inal message or the transmitted signal with cerfainiy by any operation on the 
received signal E. 
There are, however, ways of transmitting the information 
which are optimal in combating noise. This is the problem which we now 
consider. 
Suppose there are two possible symbols 0 and 1, and we are transmitting 
at a rate of 1000 symbols per second with probabilities p0 = p, = 3 . Thus 
our source is producing information at the rate of 1000 bits per second. Dur- 
ing transmission the noise introduces errors so that, on the average, 1 in 100 
is received incorrectly (a 0 as 1, or 1 as 0). 
What is the rate of transmission 
of information? 
Certainly less than 1000 bits per second since about 1% 
of the received symbols are incorrect. 
Our first impulse might be to say the 
rate is 990 bits per second, merely subtracting the expected number of errors. 
This is not satisfactory since it fails to take into account the recipient’s 
lack of knowledge of where the errors occur. 
We may carry it to an extreme 
case and suppose the noise so great that the received symbols are entirely 
independent of the transmitted symbols. 
The probability 
of receiving 1 is 
3 whatever was transmitted and similarly for 0. Then about half of the 
received symbols are correct due to chance alone, and we would be giving 
the system credit for transmitting 
500 bits per second while actually no 
information 
is being transmitted 
at all. 
Equally 
“good” 
transmission 
would be obtained by dispensing with the channel entirely and flipping a 
coin at the receiving point. 
Evidently 
the proper correction to apply to the amount of information 
transmitted is the amount of this information which is missing in the re- 
ceived signal, or alternatively 
the uncertainty 
when we have received a 
signal of what was actually sent. 
From our previous discussion of entropy 
as a measure of uncertainty 
it seems reasonable to use the conditional 
entropy of the message, knowing the received signal, as a measure of this 
missing information. 
This is indeed the proper definition, as we shall see 
later. 
Following this idea the rate of actual transmission, R, would be ob- 
tained by subtracting from the rate of production (i.e., the entropy of the 
source) the average rate of conditional entropy. 
The conditional entropy H&r) will, for convenience, be called the equi- 
vocation. 
It measures the average ambiguity of the received signal. 

C. E. Shannon 
In the example considered above, if a 0 is received the a posleriori prob- 
ability that a 0 was transmitted 
is .99, and that a 1 was transmitted 
is 
.Ol. 
These figures are reversed if a 1 is received. 
Hence 
H,(x) = - 1.99 log .99 + 0.01 log 0.011 
= .081 bits/symbol 
or 81 bits per second. We may say that the system is transmitting at a rate 
1000 - 81 = 919 bits per second. In the extreme case where a 0 is equally 
likely to be received as a 0 or 1 and similarly for 1, the a postcriori proba- 
bilities are 3, 3 and 
N,(x) = - I+ log + + 3 log 41 
= 1 bit per symbol 
or 1000 bits per second. The rate of transmission is then 0 as it should 
be. 
The following 
theorem gives a direct intuitive 
interpretation 
of the 
equivocation and also serves to justify it as the unique appropriate mcasurc. 
We consider a communication system and an observer (or auxiliary device) 
who can see both what is sent and what is recovered (with errors 
due to noise). 
This observer notes the errors in the recovered message and 
transmits data to the receiving point over a “correction channel” to enable 
the receiver to correct the errors. 
The situation is indicated schematically 
in Fig. 8. 
Tlzeorenz 10: If the correction channel has a capacity equal to H,(x) it is 
possible to so encode the correction data as to send it over this channel 
and correct all but an arbitrarily 
small fraction E of the errors. 
This is not 
possible if the channel capacity is less than L?,(X). 
Roughly then, IIU(z) is the amount of additional information that must bc 
supplied per second at the receiving point to correct the received message. 
To prove the first part, consider long sequences of received message M’ 
and corresponding original message M. 
There will bc logarithmically 
Tll,(x) of the M’s which could reasonably have produced each M’. 
Thus 
we have T&,(x) binary digits to send each T seconds. This can be done 
with e frequency of errors on a channel of capacity Ii,(r). 
The second part can be proved by noting, first, that for any discrete chance 
variables x, y, z 
II&, 
2) 2 II,kl9 
The left-hand side can be expanded to give 
I&(z) 
+ 
I&/a(X) 
2 
112/h) 
K/44 
2 
m4 
- 
II,(z) 
2 
II,(x) 
- 
H(z) 

A Mathematical Theory of Communication 
35 
If we identify z as the output of the source, y as the received signal and z 
as the signal sent over the correction channel, then the right-hancl side is the 
equivocation less the rate of transmission over the correction channel. 
If 
the capacity of this channel is less than the equivocation the right-hand side 
will be greater than zero and IZ,,2(~) > 0. But this is the uncertainty 
of 
what was sent, knowing both the received signal and the correction signal. 
If this is greater than zero the frequency of errors cannot be arbitrarily 
small. 
Example : 
Suppose the errors occur at random in a sequence of binary digits: proba- 
bility p that a digit is wrong and r] = 1 - p that it is right. 
These errors 
can bc corrected if their position is known. 
Thus the correction channel 
need only send information as to these positions. 
This amounts to trans- 
CORRECTION 
DATA 
TRANSMITTER 
RECEIVER 
CORRECTING 
DEVICE 
Pig. S-Schematic diagram of a corrcclion system. 
mitting from a source which produces binary digits with probability 
p for 
1 (correct) and q for 0 (incorrect). 
This rcquircs a channel of capacity 
- [P 1% p + p log ql 
which is the equivocation of the original system. 
The rate of transmission R cm be written in two other forms due to the 
identities noted above. 
We have 
R = U(x) 
- 
II,(x) 
= 11(y) - 
IL(y) 
= IzI(n-) + II(y) 
- 
I-l(x, y). 
The first defining expression has already been interpreted as the amount of 
information sent less the uncertainty of what was sent. 
The second meas- 

36 
C. E. Shannon 
ures the amount received less the part of this which is due to noise. The 
third is the sum of the two amounts less the joint entropy and therefore in a 
sense is the number of bits per second common to the two. 
Thus all three 
expressions have a certain intuitive significance. 
The capacity C of a noisy channel should be the maximum possible rate 
of transmission, i.e., the rate when the source is properly matched to the 
channel. 
We therefore define the channel capacity by 
C = Max (H(X) - H,(X)) 
where the maximum is with respect to all possible information sources used 
as input to the channel. 
If the channel is noiseless, II,(X) = 0. 
The defini- 
tion is then equivalent to that already given for a noiseless channel since the 
maximum entropy for the channel is its capacity. 
13. Tnn FUNDAMENTAL THEOREM FOR A DISCRETE CIIANNEL 
WITH 
NOISE 
It may seem surprising that we should definc a definite capacity C for 
a noisy channel since we can never send certain information in such a case. 
It is clear, however, that by sending the information in a redundant form the 
probability 
of errors can be reduced. 
For example, by repeating the 
message many times and by a statistical study of the different received 
versions of the message the probability 
of errors could be made very small. 
One would expect, however, that to make this probability of errors approach 
zero, the redundancy of the encoding must increase indefinitely, and the rate 
of transmission therefore approach zero. This is by no means true. 
If it 
were, there would not be a very well delined capacity, but only a capacity 
for a given frequency of errors, or a given equivocation; the capacity going 
down as the error requirements are made more stringent. 
Actually 
the 
capacity C defined above has a very definite signihcance. 
It is possible 
to send information at the rate C through the channel wilh as small a jre- 
quency of errors OY equivocalion 
as desired by proper encoding. 
This state- 
ment is not true for any rate greater than C. 
If an attempt is made to 
transmit at a higher rate than C, say C f RI , then there will necessarily 
be an equivocation equal to a greater than the excess RI . Nature takes 
payment by requiring just that much uncertainty, 
so that we are not 
actually getting any more than C through correctly. 
The situation is indicated in Fig. 9. The rate of information 
into the 
channel is plotted horizontally and the equivocation vertically. 
Any point 
above the heavy line in the shaded region can be attained and those below 
cannot. 
The points 011 the line cannot in general be attained, but there will 
usually be two points on the line that can. 

A Mathematical Theory of Communication 
31 
These results are the main justification 
for the definition of C and will 
now be proved. 
Theorem 11. Let a discrete channel have the capacity C and a discrete 
source the entropy per second N. 
If II < C there exists a coding system 
such that the output of the source can be transmitted over the channel with 
an arbitrarily small frequency of errors (or an arbitrarily small equivocation). 
If Ii > C it is possible to encode the source so that the equivocation is less 
than $1 - C + B where c is arbitrarily 
small. 
There is no method of encod- 
ing which gives an equivocation less than H - C. 
The method of proving the first part of this theorem is not by exhibiting 
a coding method having the desired properties, but by showing that such a 
code must exist in a certain group of codes. In fact we will average the 
frequency of errors over this group and show that this average can be made 
less than 6. If the average of a set of numbers is less than e there must 
exist at least one in the set which is less than e. This will establish the 
desired result. 
Fig. g-The 
equivocation possible for a given input entropy to a channel. 
The capacity C of a noisy channel has been defined as 
C = Max (H(X) - I-l,(x)) 
where x is the input and y the output. 
The maximization is over all sources 
which might be used as input to the channel. 
Let SO be a source which achieves the maximum capacity C. 
If this 
maximum is not actually achieved by any source let SO be a source which 
approximates to giving the maximum rate. 
Suppose So is used as input to 
the channel. 
We consider the possible transmitted and received sequences 
of a long duration T. The following will be true: 
1. The transmitted sequences fall into two classes, a high probability 
group 
with about 2*“(Z) members and the remaining sequences of small total 
probability. 
2. Similarly the received sequences have a high probability 
set of about 
2 TH(u) members and a low probability 
set of remaining sequences. 
3. Each high probability output could be produced by about 2”“‘@) inputs. 
The probability 
of all other cases has a small total probability. 

38 
C. E. Shannon 
All the e’s and 6’s implied by the words “small” 
and “about” 
in these 
statements approach zero as we allow T to increase and So to approach the 
maximizing source. 
The situation is summarized in Fig. 10 where the input sequences are 
points on the left and output sequences points on the right. 
The fan of 
cross lines represents the range of possible causes for a typical output. 
Now suppose we have another source producing information 
at rate R 
with R < C. 
In the period T this source will have 2TR high probability 
outputs. 
We wish to associate these with a selection of the possible channel 
2Hk)T 
HIGH 
PROBABILITY 
MESSAGES 
2li(y)T 
HIGH 
PROBABILITY 
RECEIVED 
SIGNALS 
. 
REASOibABLE 
EFFECTS 
. 
FROM 
EACH 
M 
. 
Fig. lo-Schematic 
representation of the relations between inputs and outputs in a 
channel. 
inputs in such a way as to get a small frequency of errors. 
We will set up 
this association in all possible ways (using, however, only the high proba- 
bility group of inputs as determined by the source 30) and average the frc- 
quency of errors for this large class of possible coding systems. 
This is the 
same as calculating the frequency of errors for a random association of the 
messages and channel inputs of duration T. Suppose a particular output 
yl is observed. 
What is the probability of more than one message in the set 
of possible causes of yr? There are 2TR messages distributed 
at random in 
2 TM(Z) points. 
The probability 
of a particular 
point being a message is 
thus 
2 
T(R--H(d) 

A Mathematical Theory of Communication 
39 
The probability 
that none of the points in the fan is a message (apart from 
the actual originating message) is 
P=[l-2 
T(R--H(r)) 
2T”&) 
1 
NOW R < H(Z) - 
H,(X) SO R - 
11(x) = -I&&) 
- 
9 with 7 positive. 
Consequently 
P=[l- 
2- 
THy(d--T~ 
2TN& 
1 
approaches (as T --+ a) 
1 - 2-T”. 
Hence the probability 
of an error approaches zero and the first part of the 
theorem is proved. 
The second part of the theorem is easily shown by noting that we could 
merely send C bits per second from the source, completely neglecting the 
remainder of the information generated. 
At the receiver the neglected part 
gives an equivocation U(z) - C and the part transmitted need only add f. 
This limit can also be attained in many other ways, as will be shown when we 
consider the continuous case. 
The last statement of the theorem is a simple consequence of our definition 
of C. 
Suppose we can encode a source with R = C + a in such a way as to 
obtain an equivocation H,(x) = a - t with e positive. 
Then R = H(x) = 
C + a and 
IW 
- I&(x) = c + e 
with t positive 
This contradicts the definition of C as the maximum of 
H(x) - H”(X). 
Actually more has been proved than was stated in the theorem. 
If the 
average of a set of numbers is within t of their maximum, a fraction of at 
most &can 
be more than &below 
the maximum. 
Since e is arbitrarily 
small we can say that almost all the systems are arbitrarily close to the ideal. 
14. DISCUSSION 
The demonstration of theorem 11, while not a pure existence proof, has 
some of the deficiencies of such proofs. 
An attempt 
to obtain a good 
approximation to ideal coding by following the method of the proof is gen- 
erally impractical. 
In fact, apart from some rather trivial 
cases and 
certain limiting situations, no explicit description of a series of approxima- 
tion to the ideal has been found. 
Probably this is no accident but is related 
to the difficulty of giving an explicit construction for a good approximation 
to a random sequence. 

40 
C. E. Shannon 
An approximation to the ideal would have the property that if the signal 
is altered in a reasonable way by the noise, the original can still be recovered. 
In other words the alteration will not in general bring it closer to another 
reasonable signal than the original. 
This is accomplished at the cost of a 
certain amount of redundancy in the coding. 
The redundancy must be 
introduced in the proper way to combat the particular 
noise structure 
involved. 
However, any redundancy in the source will usually help if it is 
utilized at the receiving point. 
Ih particular, if the source already has a 
certain redundancy and no attempt is made to eliminate it in matching to the 
channel, this redundancy will help combat noise. For example, in a noiseless 
telegraph channel one could save about 50% in time by proper encoding of 
the messages. This is not done and most of the redundancy of English 
remains in the channel symbols. 
This has the advantage, however, of 
allowing considerable noise in the channel. 
A sizable fraction of the letters 
can be received incorrectly 
and still reconstructed by the context. 
In 
fact this is probably not a bad approximation to the ideal in many cases, 
since the statistical structure of English is rather involved and the reasonable 
English sequences are not too far (in the sense required for theorem) from a 
random selection. 
As in the noiseless case a delay is generally required to approach the ideal 
encoding. 
It now has the additional function of allowing a large sample of 
noise to affect the signal before any judgment is made at the receiving point 
as to the original message. Increasing the sample size always sharpens the 
possible statistical assertions. 
The content of theorem 11 and its proof can be formulated in a somewhat 
different way which exhibits the connection with the noiseless case more 
clearly. 
Consider the possible signals of duration T and suppose a subset 
of them is selected to be used. Let those in the subset all be used with equal 
probability, and suppose the receiver is constructed to select, as the original 
signal, the most probable cause from the subset, when a perturbed signal 
is received. 
We define N(T, q) to be the maximum number of signals we 
can choose for the subset such that the probability 
of an incorrect inter- 
pretation is less than or equal to q. 
Theorem 12: Lim STu 
= C, where C is the channel capacity, pro- 
T-r00 
vided that q does not equal 0 or 1. 
In other words, no matter how we set our limits of reliability, 
we can 
distinguish reliably in time T enough messages to correspond to about CT 
bits, when T is sufficiently large. 
Theorem 12 can be compared with the 
definition of the capacity of a noiseless channel given in section 1. 

A Mathematical Theory of Communication 
41 
1.5. EXAMPLE OF A DISCRETE CHANNEL 
AND ITS CAPACITY 
A simple example of a discrete channel is indicated in Fig. 11. There 
are three possible symbols. 
The first is never affected by noise. The second 
and third each have probability 
p of coming through undisturbed, and q 
of being changed into the other of the pair. 
WC have (letting LY = - [p log 
P 
TRANSMITTED 
9 
SYMBOLS x 
RECEIVED 
SYMBOLS 
Q 
P 
Fig. 11-Example of a discrete channel 
p + 
q log q] and P and Q be the probabilities of using the first or second 
symbols) 
II(x) = -I’ 
log P - 2Q log Q 
H,(x) = 2Qa 
We wish to choose P and Q in such a way as to maximize II(x) 
- 
H,(x), 
subject to the constraint P -I- 2Q = 1. Hence we consider 
U = -P log P - 2Q log Q - ~QCY + X(P + 2Q) 
flu 
-1 
-= 
all 
-logP+x=o 
au 
-= 
aQ 
-2 -2 1ogQ -2a+2x=o. 
Eliminating 
X 
log P = log Q + a! 
P = Qe" = Q/3 
p=P 
P-i-2 
Q-L. 
P-l-2 
The channel capacity is then 

C. E. Shannon 
Note how this checks the obvious values in the cases p = 1 and p = ij . 
In the first, /3 = 1 and C = log 3, which is correct since the channel isthen 
noiseless with three possible symbols. 
If p = a, p = 2 and C = log 2. 
Here the second and third symbols cannot be distinguished at all and act 
together like one symbol. 
The first symbol is used with probability 
P = 
$ and the second and third together with probability 
3 . This may be 
distributed in any desired way and still achieve the maximum capacity. 
For intermediate values of p the channel capacity will lie between log 
2 and log 3. The distinction between the second and third symbols conveys 
some information but not as much as in the noiseless case. The first symbol 
is used somewhat more frequently than the other two because of its freedom 
from noise. 
16. Tnz 
CIIANNJXL 
CAPACITY 
IN 
CERTAIN 
SPECIAL CASES 
If the noise affects successive channel symbols independently it can be 
described by a set of transition probabilities pij . This is the probability, 
if symbol i is sent, that j will be received. 
The maximum channel rate is 
then given by the maximum of 
, 
E 
PiPii 
log Z$ Pi Pij 
- 5 
Pi 
pij 
10s pij 
where WC vary the Pi subject to BPi = 1. This leads by the method of 
Lagrange to the equations, 
s = 1,2, *** . 
Multiplying 
by P, and summing on s shows that p = -C. 
Let the inverse 
of p, (if it exists) be h,l SO that c 
lt,,p,j = 6lj . Then: 
II 
Hence: 
5 h8f 
P*j 
log 
P8j 
- 
log 
J$ 
Pi 
pit 
= 
-C 
F 
lzaf . 
F 
pi Pit 
= exp tc T 
kc + 
5 
h,f p*j log p,j] 
or, 
Pi 
= 
F 
kf 
exp 
[C 
C 
l&f 
+ 
C 
lb 
p,j 
log p.j]. 
I 
8.j 
This is the system of equations for determining the maximizing values of 
Pi , with C to be determined so that B Pi = 1. When this is done C will be 
the channel capacity, and the Pi the proper probabilities for the channel 
symbols to achieve this capacity. 

A Mathematical Theory of Communication 
43 
If each input symbol has the same set of probabilities on the lines emerging 
from it, and the same is true of each output symbol, the capacity can be 
easily calculated. 
Examples are shown in Fig. 12. In such a case H&) 
is independent of the distribution of probabilities on the input symbols, and 
is given by --Z pi log pi where the pi are the values of the transition proba- 
bilities from any input symbol. 
The channel capacity is 
Max [J-W - 
rrlb>l 
=MaxIZ(~~)+ZpilogPi. 
The maximum of 11(y) is clearly log m where m is the number of output 
a 
b 
C 
Fig. 12--Examples of discrete channels with the same transition probabilities for each 
nput and for each output. 
i 
symbols, since it is possible to make them all equally probable by making 
the input symbols equally probable. 
The channel capacity is therefore 
C = log m + Z pi log pi. 
In Fig. 12a it would be 
c = log 4 - log2 = log2. 
This could be achieved by using only the 1st and 3d symbols. 
In Fig. 12b 
C = log 4 - $ log 3 - # log 6 
= log 4 - log 3 - f log 2 
= log& 29. 
h Fig. 12c we have 
C = log 3 - 4 log 2 - f log 3 - Q log G 

44 
C. E. Shannon 
Suppose the symbols fall into several groups such that the noise never 
causes a symbol in one group to be mistaken for a symbol in another group. 
Let the capacity for the lath group be C, when we use only the symbols 
in this group. 
Then it is easily shown that, for best use of the entire set, 
the total probability I’, of all symbols in the nib group should be 
P, = &. 
Within a group the probability 
is distributed just as it would be if these 
were the only symbols being used. The channel capacity is 
c = log Z2c”. 
17. AN EXAMPLE OF EFFICIENT 
CODING 
The following example, although somewhat unrealistic, is a case in which 
exact matching to a noisy channel is possible. 
There are two channel 
symbols, 0 and 1, and the noise affects them in blocks of seven symbols. 
A 
block of seven is either transmitted without error, or exactly one symbol of 
the seven is incorrect. 
These eight possibilities are equally likely. 
We have 
C = Max [II(y) - UJy)] 
= ‘+ 17 + $ log *I 
= $ bits/symbol. 
An efficient code, allowing complete correction of errors and transmitting 
at 
the rate C, is the following (found by a method due to R. Hamming) : 
Let a block of seven symbols be XI, XZ, . . . XT. Of these X3, XS, X6 and 
XT are message symbols and chosen arbitrarily 
by the source. 
The other 
three are redundant and calculated as follows: 
X4 is chosen to make a! = X4 + X6 + X6 + Xv even 
xa ‘( 
“ 
“ 
‘( 
p = x,+xa+xg 
+ x, 
‘( 
Xl “ 
(‘ 
‘I 
(( 
y = Xl + x, + xrj + x, 
‘( 
When a block of seven is received (Y, /3 and y are calculated and if even called 
zero, if odd called one. The binary number a /3 y then gives the subscript 
of the Xi that is incorrect (if 0 there was no error). 
APPENDIX 
1 
THE GROWTH OF TIIE NUMBER OF BLOCKS OF SYMBOLS WITH A 
FINITE 
STATE CONDITION 
Let N&5) be the number of blocks of symbols of length L ending in state 
i. 
Then we have 

A Mathematical 
Theory of Communication 
45 
where a’,, , bij , . . . byj are the length of the symbols which may be chosen 
in state i and lead to state j. 
These are linear difference equations and the 
behavior as L -+ 00 must be of the type 
iVj 
= 
AjW" 
Substituting 
in the difference equation 
Ajw‘ 
= c 
AiW=-b::) 
i.s 
or 
Aj = c 
Ai W-b!;’ 
F 
(T 
WwbC’ - 
6ij)Ai 
= 0. 
For this to be possible the determinant 
D(W) 
= 1 Uijl 
= 17 
Wmb$:’ - 
Sijl 
must vanish and this determines W, which is, of course, the largest real root 
ofD 
= 0. 
The quantity C is then given by 
c = Lirn log ZAj W‘ 
L 
= log w 
L-m 
and we also note that the same growth properties result if we require that all 
blocks start in the same (arbitrarily 
chosen) state. 
APPENDIX 
2 
DERIVATION 
OF 11 = --Z pi log pi 
Let H 
1 
l 
. . . , i) 
= 
n’ lz’ 
A(n). 
From condition (3) we can decompose 
a choice from s”’ equally likely possibilities into a series of 7n choices each 
from s equally likely possibilities and obtain 
A(?‘) 
= nz A(S) 
Similarly 
A(1”) 
= 1z A(t) 
We can choose n arbitrarily 
large and find an m to satisfy 
Srn < r < P+l) 

46 
C. E. Shannon 
Thus, taking logarithms and dividing by ?E log S, 
where e is arbitrarily 
small. 
Now from the monotonic property of A(n)* 
A(s’“) 
_< A(f) 
i 
A(?+‘> 
nz A (s) 5 tzA(1) 5 (VE -I- 1) A (s) 
Hence, dividing by nA (s), 
A (1) 
~<----<~+~ 
or 
A(4 
A (1) 
log 
< 2e 
n(s) - log S - 
A(I) 
= -K 
log 1 
where K must be positive to satisfy (2). 
Now suppose we have a choice from n possibilities with cornmeasurable prob- 
abilities pi = 3 
where the ?Zi are intcgcrs. 
We can break down a choice 
Zlti 
from Bt; possibilities into a choice from it possibilities with probabilities 
pi. e e p, and then, if the ith was chosen, a choice from Izi with equal prob- 
abilities. 
Using condition 3 again, we equate the total choice from Zjti 
as computed by two methods 
Hence 
K log Btii = ZZ(pr 9 . . ., 9 pn) 3- KZ pi log Iti 
H = K [LX pi log Z tti - 
I: pi log Hi] 
= -KZpilogz~.= 
-KKpiIogpi. 
, 
If the pi are incommeasurable, they may be approximated by rationals and 
the same expression must hold by our continuity 
assumption. 
Thus the 
expression holds in general. 
The choice of coetlicient K is a matter nf con- 
veniencc and amounts to the choice of a unit of measure. 
APPENDIX 
3 
THEOREMS ON ERGODIC SOURCES 
If it is possible to go from any stale with P > 0 to any other along a path 
of probability 
p > 0, the system is ergodic and the strong law of large num- 
bers can be applied. 
Thus the number of times a given path pij in the net- 

A Mathematical 
Theory of Communication 
41 
work is traversed in a long sequence of length N is about proportional to the 
probability 
of being at i and then choosing this path, Z’ipijN. 
If N is large 
enough the probability 
of percentage error f 
6 in this is less than e so that 
for all but a set of small probability 
the actual numbers lie within the limits 
(Pipij 
rt 6)N 
Hence nearly all sequences have a probability 
p given by 
p 
= 
npiTiPij*a)N 
1% P * 
and -fi- 
1s limited by 
or 
1% P 
__ 
= 
Z(Pipij 
f 
S) log pij 
N 
1% P 
-- 
N 
- 
ZPipij 
log pij 
< ve 
This proves theorem 3. 
Theorem 4 follows immediately 
from this on calculating upper and lower 
bounds for n(q) based on the possible range of values of p in Theorem 3. 
In the mixed (not ergodic) case if 
L= 
ZpiLi 
and the entropies of the components are ZZr 2 ZZz > . . . 2 ZZ,, we have the 
T!zeoretn: Lim ‘9 
= p(q) is a decreasing step function, 
N-W.3 
r-1 
p(q) = H, 
in the interval 
c 
ai < q < f= ai. 
I 
1 
To prove theorems 5 and 6 first note that FN is monotonic decreasing be- 
cause increasing N adds a subscript to a conditional 
entropy. 
A simple 
substitution for pei (Sj) in the definition of FN shows that 
PN= 
NGN- 
(N- 
~)CN-I 
and summing this for all N gives GN = f Z PN . Hence GN >_ 17~ and GN 
monotonic decreasing. 
Also they must approach the same limit. 
By using 
theorem 3 we see that Lim GN = II. 
N--m 
* 
APPENDIX 
4 
MAXIMIZING 
THE RATE FOR A SYSTEM OF CONSTRAINTS 
Suppose we have a set of constraints on sequences of symbols that is of 
the finite state type and can be represented therefore by a linear graph. 

48 
C. E. Shannon 
Let C$r be the lengths of the various symbols that can occur in passing from 
state i to state j. 
What distribution 
of probabilities 
Pi for the different 
states and fi(l? for choosing symbol s in state i and going to statej maximizes 
the rate of generating information under these constraints? 
The constraints 
define a discrete channel and the maximum rate must be less than or equal 
to the capacity C of this channel, since if all blocks of large length were 
equally likely, this rate would result, and if possible this would be best. 
We 
will show that this rate can bc achieved by proper choice of the Pi and pi:. 
The rate in question is 
-zPip::J 
log p!‘? = _N 
(a) (1) 
zP(i)Pij 
eij 
M’ 
Let 
Cij 
= C tfy . Evidently 
for a maximum pi? = k exp 419. The con- 
straints on ‘maximization 
are ZPi 
= 1, C 
p<j = 
1, 2 Pi(pij 
- 
6ij) 
= 0. 
i 
Hence we maximize 
--ZPi 
pij log 
pij 
u=- 
ZPi 
pij lij 
+ A F 
Pi + 
XPi Pij + Ztlj Pi&ii - 6ij) 
au 
-=- 
apij 
Wi(l 
+ log Pij) + NPi Cj + h + cli + ttipi = 
lw 
0 . 
Solving for pij 
p, = /ii&L+ja 
Since 
F 
fij 
= 1, 
AT’ 
= ~ 
BjD-li’ 
BjZFdij 
Pii = C B, D-li8 . 
8 
The correct value of D is the capacity C and the Bj are solutions of 
for then 
Bi = 2 Bj-+j 
p, = 2 (J--b. 
t 
xpi 3 Cvcii 
Bi 
= P, 
or 

A Mathematical 
Theory of Communication 
49 
SO that if Xi satisfy 
Z;yic-Gii 
= 
yj 
Pi= 
Biyi 
Both of the sets of equations for I3 6 and 7; can be satisfied since C is such that 
1 cpdii - aij 1 = 0 
In this case the rate is 
ZPi pij 
log 
; I 
P C- 
BPi pij Cij 
but 
Z;Pipij(log 
Bj - 
log Bi) 
= C 
Pj log Bj - 
ZPi log Bi = 0 
i 
Hence the rate is C and as this could never be exceeded this is the maximum’ 
justifying 
the assumed solution. 

50 
C. E. Shannon 
PART 
III: 
MATHEMATICAL 
PRELIMINARIES 
In this fmal installment 
of the paper we consider the case where the 
signals or the messages or both are continuously variable, in contrast with 
the discrete nature assumed until now. 
To a considerable extent the con- 
tinuous case can be obtained through a limiting 
process from the discrete 
case by dividing the continuum of messages and signals into a large but finite 
number of small regions and calculating the various parameters involved on 
a discrete basis. 
As the size of the regions is decreased these parameters in 
general approach as limits the proper values for the continuous case. There 
are, however, a few new effects that appear and also a general change of 
emphasis in the direction of specialization of the general results to particu- 
lar cases. 
We will not attempt, in the continuous case, to obtain our results with 
the greatest generality, or with the extreme rigor of pure mathematics, since 
this would involve a great deal of abstract measure theory and would ob- 
scure the main thread of the analysis. 
A preliminary study, however, indi- 
cates that the theory can be formulated 
in a completely axiomatic 
and 
rigorous manner which includes both the continuous and discrete cases and 
many others. 
The occasional liberties taken with limiting 
processes in the 
present analysis can be justified in all cases of practical interest. 
18. SETS AND ENSEMBLES 
OF FUNCTIONS 
We shall have to deal in the continuous case with sets of functions and 
ensembles of functions. 
A set of functions, as the name implies, is merely a 
class or collection of functions, generally of one variable, time. 
It can be 
specified by giving an explicit representation of the various functions in the 
set, or implicitly 
by giving a property which functions in the set possess and 
others do not. 
Some examples are: 
1. The set of functions: je(O 
= 
sin (1 + 0). 
Each particular 
value of 0 determines a particular 
function in the set. 

A Mathematical 
Theory of Communication 
51 
2. The set of all functions of time containing no frequencies over W cycles 
per second. 
3. The set of all functions limited in band to W and in amplitude to A. 
4. The set of all English speech signals as functions of time. 
An ensemble of functions is a set of functions together with a probability 
measure whereby we may determine the probability 
of a function in the 
set having certain properties.’ 
For example with the set, 
h(l) 
= sin@+@, 
we may give a probability 
distribution 
for 0, P(0). 
The set then becomes 
an ensemble. 
Some further examples of ensembles of functions are: 
1. A finite set of functionsf&) 
(K = 1, 2, * * * , n) with the probability 
of 
jk being pk 
. 
2. 
3. 
A finite dimensional family of functions 
f&l 
) QZ , * * * , %I 
, * 1) 
with a probability 
distribution 
for the parameters ai : 
pb1 
, * * * , WI) 
For example we could consider the ensemble defmed by 
with the amplitudes ai distributed normally and independently, and the 
phrases Bi distributed uniformly 
(from 0 to 27r) and independently. 
The ensemble 
j(ai , 1) = fun 
sin 7~(2W1 - 4 
n--co 7r(2W1 - 
n) 
with the ai normal and independent all with the same standard deviation 
Z/g. 
This is a representation of “white” noise, band-limited to the band 
from 0 to W cycles per second and with average power N. 
1 In math!matical 
terminology 
the functions belong to a measure space whose total 
measure is umty. 
1 This representation 
can be used as a definition 
of band limited white noise. 
It has 
certain advantages in that it involves fewer I!mlting op,erations than d? definitions 
that 
have been used in the past. 
The name “white 
noise, 
already lirmly mtrenched m the 
literature, 
is perhaps somewhat unfortunate. 
In optics white light 
means either any 
continuous spectrum as contrasted with a point spectrum, or a spectrum which is flat with 
wauelmglh (which is not the same as a spectrum flat with frequency). 

52 
C. E. Shannon 
4. Let points be distributed on the t axis according to a Poisson distribu- 
tion. 
At each selected point the functionf(f) 
is placed and the different 
functions added, giving the ensemble 
where the lk are the points of the Poisson distribution. 
This ensemble 
can be considered as a type of impulse or shot noise where all the impulses 
are identical. 
5. The set of English speech functions with the probability 
measure given 
by the frequency of occurrence in ordinary use. 
An ensemble of functionsf&) 
is slalio~tary if the same ensemble results 
when all functions are shifted any fixed amount in time. 
The ensemble 
f&) 
= sin (b + e) 
is stationary if 0 distributed uniformly from 0 to 2~. 
If we shift each func- 
tion by 11 we obtain 
f0(t + 11) = sin (1 + II + 0) 
= sin (1 + V) 
with cp distributed 
uniformly 
from 0 to 25~. Each function has changed 
but the ensemble as a whole is invariant under the translation, 
The other 
examples given above are also stationary. 
An ensemble is ergo&c if it is stationary, and there is no subset of the func- 
tions in the set with a probability different from 0 and 1 which is stationary. 
The ensemble 
sin (1 + e) 
is ergodic. 
No subset of these functions of probability 
#O, 1 is transformed 
into itself under all time translations. 
On the other hand the ensemble 
a sin (1 + 0) 
with a distributed 
normally and 8 uniform is stationary 
but not ergodic. 
The subset of these functions with a between 0 and 1 for example is 
stationary. 
Of the examples given, 3 and 4 are ergodic, and 5 may perhaps be con- 
sidered so. If an ensemble is ergodic we may say roughly that each func- 
tion in the set is typical of the ensemble. 
More precisely it is known that 
with an ergodic ensemble an average of any statistic over the ensemble is 
equal (with probability 
1) to an average over all the time translations of a 

A Mathematical Theory of Communication 
53 
particular function in the set.3 Roughly speaking, each function can bc cx- 
petted, as time progresses, to go through, with the proper frequency, all the 
convolutions of any of the functions in the set. 
Just as we may perform various operations on numbers or functions to 
obtain new numbers or functions, we can perform operations on cnscmbles 
to obtain new ensembles. 
Suppose, for example, we have an ensemble of 
functionsf,(i) 
and an operator T which gives for each functionf,(/) 
a result 
&40 : 
Probability 
measure is defined for the set gn(l) by means of that for the set 
f&). 
Tlx 
probab 1 1 
i i y of a certain subset of the g,(l) functions is equal 
to that of the subset of the ja(l) functions which produce mcmbcrs of the 
given subset of g tunctions under the operation I’. 
Physically 
this corrc- 
sponds to passing the cnscmble through some dcvicc, for exan~plc, a filter, 
a rectifier or a modulator. 
The output functions of the device form the 
ensemble ge(l). 
A device or operator T will bc called invariant if shifting the input merely 
shifts the output, i.e., if 
implies 
g&> = TJ,!O 
g&l -I- fd = Tf,(f + 4) 
for allf&l) 
and all II . It is easily shown (see appendix 1) that if T is in- 
variant and the input enscn~blc is stationary then the output cnscmblc is 
stationary. 
Likewise if the input is ergodic the output will also bc crgodic. 
A filter or a rectifier is invariant under all time translations. 
The opera- 
tion of modulation is not since the carrier phase gives a certain time struc- 
ture. 
However, modulation 
is invariant 
under all translations which arc 
multiples 
of the period of the carrier. 
Wiener has pointed out tlic intiinatc 
relation bctwcen the invariance of 
physical devices under time translations 
a.nd Fourier tllcory.4 
1-1~ has 
3 This is the famous crgo:lic Lhcorcm or ralhcr one aspect of Lhis theorem which was 
t~roved is son~cwhat differen 
formulations 
by JSir$off, 
van Neumann, and Koopman, and 
subsequently gcncralizetl by Wicncr, I-Iopf! JIurcwcz and olhcrs. 
The lilcralure 
on crgo:!ic 
theory is quite exlcnsive and the reader 1s referred lo the papers of these writers for pre- 
cise and general Iormulalions; 
e.g., 11. HopI “JSrgo~!cntheoric” 
Ergcbnissc tier Malhcmatic 
und ihrer Grcnzgebiet~, 
Vol. 5, “On Causality 
SLaLisLics and Probability” 
Journal of 
Mathematics 
and Physics, Vol. XIII, 
No. 1, 1934; N. Weiner “The Ergodic Theorem” 
Duke Mathematical 
Journal., Vol. 5, 1939. 
4 CommunicaLion 
theory IS heavily indcbtcd Lo Wiener for much of ils basic philosophy 
and theory. 
His classic NDRC report “The Intcrt~olalion, 
15xLral~olaLion, and Smoolhing 
of Stationary 
Time Series,” 
Lo appear soon in book form, contains the lirst clear-cul 
formulaLion 
of communication 
theory as a statistical 
problem, 
the study of opcralions 

54 
C. E. Shannon 
shown, in fact, that if a device is linear as well as invariant Fourier analysis 
is then the appropriate mathematical 
tool for dealing with the problem, 
An ensemble of functions is the appropriate m.athematical representation 
of the messages produced by a continuous source (for example speech), of 
the signals produced by a transmitter, and of the perturbing noise. 
Com- 
munication theory is properly concerned, as has been emphasized by Wiener, 
not with operations on particular 
functions, but with operations on en- 
sembles of functions. 
A communication system is designed not for a par- 
ticular speech function and still less for a sine wave, but for-the ensemble of 
speech functions. 
19. BAND LIMITED ENSEMDLES OF FUNCTIONS 
If a function of timej(1) 
is limited to the band from 0 to W cycles per 
second it is completely determined by giving its ordinates at a series of dis- 
crete points spaced &w seconds apart in the manner indicated by the follow- 
ing result.6 
Tkeorm 
13: Let j(1) contain no frequencies over 11’. 
, 
Then 
f(1) 
= -g x, 
Sk 742TY1 - 
1zj 
--m 
742Wl 
- 
n) 
where 
In this expansion j(l) 
is reprcsentcd as a sum of orthogonal functions. 
The coefficients X, of the various terms can be considered as coordinates in 
an infinite dimensional “function space.” 
In this space each function cor- 
responds to precisely one point and each point to one function. 
A function can be considered to be substantially limited to a time T if all 
the ordinates X, outside this interval of time arc zero. 
In this case all but 
27747 of the coordinates will be zero. 
Thus functions limited to a band W 
and duration T correspond to points in a space of 2TW dimensions. 
A subset of the functions of band W and duration T corresponds to a re- 
gion in this space. For example, the functions whose total energy is less 
on time series. 
This work, although 
chiefly concerned with the linear prediction 
and 
filtering problem, is an important 
collateral reference in connection with the present paper. 
We may also refer here to Wiener’s forthcoming 
book “Cybcrnctics” 
dealing with 
the 
general problems of communication 
and control. 
6 For a proor of this theorem and further discussion see the author’s paper “Communi- 
cation in the Presence of Noise” to be published in the Proceedirzgs o/ llre Z~slil~la of Radio 
Ettgitteers. 

A Mathematical Theory of Communication 
55 
than or equal to 23 correspond to points in a 2TW dimensional sphere with 
radius I = 
42WE. 
An ensemble of functions of limited duration and band will be represented 
by a probability distribution &xl . . . x,) in the corresponding 12 dimensional 
space. If the ensemble is not limited in time we can consider the 2TW co- 
ordinates in a given interval 
T to represent substantially 
the part of the 
function in the interval 
T and the probability 
distribution 
p(xr , . . . , x,) 
to give the statistical structure of the ensemble for intervals of that duration. 
20. ENTROPY OF A CONTINUOUS DISTRIBUTION 
The entropy of a discrete set of probabilities pr , * . . p,, has been defined as: 
II 
= 
-CpilOgpi. 
In an analogous manner we deline the entropy of a continuous distribution 
with the density distribution 
function p(x) by: 
zz = - J -1 P(x) 1% P(x) dx 
With an 11 dimensional distribution 
p(xr , . * * , x,) we have 
If we have two arguments x and y (which may themselves bc multi-dimen- 
sional) the joint and conditional entropies of p(x, y) are given by 
I& 
Y> = -j-/ 
z’b, Y> log Pb, y> dx dy 
and 
II,(y) 
= -/-I 
p(x, y) log ‘3 
dx dy 
II,(x) 
= -I/ 
p(x, y) log ‘g 
dx dy 
where 
P(x) = /- P(G Y) dy 
P(Y) = /- P(X, Y> dx. 
The entropies of continuous distributions have most (but not all) of the 
properties of the discrete case. In particular we have the following: 

C. E. Shannon 
1. If x is limited to a certain volume v in its space, then ZZ(r) is a maximum 
and equal to log v when p(x) is constant 
1 
0 
- 
in the volume. 
V 
2. With any two variables x, y we have 
ax, 
y> 5 Wx) + WY) 
with equality if (and only if) x and y are independent, i.e., p(x, y) = p(s) 
p(y) (apart possibly from a set of points of probability zero). 
3. Consider a generalized averaging operation of the following type: 
P’(Y) = /- ah, Y>P(X> dx 
with 
s a(x, y) dx = s &, 
Y> dy = 1, 
4% Y> 2 0. 
Then the entropy of the averaged distribution 
p’(y) is equal to or greater 
than that of the original distribution 
p(x). 
4. We have 
and 
zax, y> = fG> 
+ NAY) = NY) 
+ Z&!(x) 
K(Y) 
I NY). 
5. Let p(x) be a one-dimensional distribution. 
The form of p(x) giving a 
maximum entropy subject to the condition that the standard deviation 
of x be fixed at u is gaussian. 
To show this we must maximize 
N(x) = -1 
p(x) log P(x) dx 
with 
a2 = 
p(x)%” dx 
and 
1 = 
s 
s p(x) dx 
as constraints. 
This requires, by the calculus of variations, maximizing 
s 
[--P(x) log P(x) + XP(x>; + /&>I dx. 
The condition for this is 
-l-logp(x)+X~2+_t=o 
and consequently (adjusting 
the constants to satisfy the constraints) 
p(x) = & 
~ e-(~2/2u*). 

A Mathematical Theory of Communication 
57 
6. 
7. 
Similarly 
in 18 dimensions, suppose the second order moments of 
p(s , * * - , x,) arc fixed at Aij : 
nij= 
J 
J 
. . . 
xixjp(xl, 
**a pXn)dxl 
.*a dx,. 
Then the maximum 
entropy occurs (by a similar calculation) 
when 
P(Xl , - * * , x,) is the IZ dimensional gaussian distribution 
with the second 
order moments A ii . 
The entropy of a one-dimensional gaussian distribution 
whose standard 
deviation is u is given by 
ZI(X) = log 42aecr. 
This is calculated as follows: 
p(x) = Au 
e-(r*12sP) 
-log p(x) = log 60 
+ g2 
H(x) = -1 
P(x) log P(x) dx 
= J p(x) log 42;; cr dx + J p(x) $,* dx 
=log&r+&2 
= log 4% 
+ log 6 
= log &G 
u. 
Similarly 
the IZ dimensional 
gaussian distribution 
with 
associated 
quadratic form aii is given by 
1 aij It 
p(x1 , . . * , x,) = ~ 
(2?r)“‘2 exp (- 
$2&j Xi Xj) 
and the entropy can be calculated as 
II 
= 
log (2*C)“” ( Uij (’ 
where 1 aij 1 is the determinant whose elements are aij . 
If x is limited to a half line (p(x) = 0 for z 5 0) and the first moment of 
x is fixed at a: 

58 
then the maximum entropy occurs when 
C. E. Shannon 
p(x) 
= ; e-(z’o) 
and is equal to log ea. 
8. There is one important 
difference between the continuous and discrete 
entropies. 
In the discrete case the entropy measures in an absolzcle 
way the randomness of the chance variable. 
In the continuous case the 
measurement is rela&e lo he coordirtdfe system. 
If we change coordinates 
the entropy will in gcncral change. 
In fact if we change to coordinates 
y1 * * - y,, the new entropy is given by 
where J 
E 
0 
is the Jacobian of the coordinate transformation. 
011 
cx- 
Y 
panding the logarithm and changing variables to ~1 . * . x,, , we obtain: 
N(y) 
= II(x) 
- 
1 * * * /- p(q) 
* * - , XJ log J 
; 
dx1. *. dx,. 
0 
Thus the new entropy is the old entropy less the expected logarithm of 
the Jacobian. 
In the continuous 
&SC 
the entropy can bc considered a 
measure of randomness relalive LO au assumed slathdard, namely the co- 
ordinate system chosen with each small volume element dxl . . . dx, given 
equal weight, 
When we change the coordinate system the entropy in 
the new system mcasurcs the randomness when equal volume clemcnts 
dyl - . - dy” in the new system are given equal weight. 
In spite of this dependence on the coordinate system the entropy 
concept is as important in the continuous case as the discrete case. This 
is due to the fact that the derived concepts of information 
rate and 
chamiel capacity depend on the difference of two entropics and this 
difference does ltol depend on the coordinate frame, each of the two terms 
being changed by the same amount. 
The entropy of a continuous distribution 
can be negative. 
The scale 
of measurements sets an arbitrary zero corresponding to a uniform dis- 
tribution over a unit volume. 
A distribution which is more confined than 
this has less entropy and will be negative. 
The rates and capacities will, 
however, always be non-negat.ive. 
9. A particular case of changing coordinates is the linear transformation 
‘yj 
= C 
UijXi 
. 
, 

A Mathematical Theory of Communication 
59 
In this case the Jacobian is simply the determinant 1 a;j 1-l and 
ZZ(y) = 
H(X). 
+ 
log 
1 Uij 
1 s 
In the case of a rotation of coordinates (or any measure preserving trans- 
formation) J = 1 and I-l(y) = B(x). 
21. ENTROPY OF AN ENSEMBLE OF FUNCTIONS 
Consider an ergodic ensemble of functions limited to a certain band of 
width 
W cycles per second. Let 
p(a * - - X”> 
be the density distribution 
function for amplitudes zr - . - x,, at 12 successive 
sample points. 
We define the entropy of the ensemble per degree of free- 
dom by 
We may also define an entropy H per second by dividing, not by 15, but by 
the time Tin seconds for 12 samples. 
Since n = 2TW, H’ = 2WH. 
With white thermal noise p is gaussian and we have 
ZZ’ = log d2*eN, 
H = W log 2neN. 
For a given average power N, white noise has the maximum possible 
entropy. 
This follows from the maximizing 
properties of the Gaussian 
distribution 
noted above. 
The entropy for a continuous stochastic process has many properties 
analogous to that for discrete processes. In the discrete case the entropy 
was related to the logarithm of the probability 
of long sequences, and to the 
number of reasonably probable sequences of long length. 
In the continuous 
case it is related in a similar fashion to the logarithm 
of the probabililj 
dettsily for a long series of samples, and the volunte of reasonably high prob- 
ability 
in the function space. 
More precisely, if we assume p(s * . * x,) continuous in all the Xi for all 12, 
then for sufficiently large 92 
for all choices of (x1 , . . * , r,) apart from a set whose total probability 
is 
less than 6, with 6 and e arbitrarily 
small. 
This follows from the ergodic 
property if WC divide the space into a large number of small cells. 

60 
C. E. Shannon 
The relation of H to volume can be stated as follows: Under the same as- 
sumptions consider the it dimensional space corresponding to p(zr , . . - , x,). 
Let V,,(q) be the smallest volume in this space which includes in its interior 
a total probability 
q. 
Then 
Lim log Im(q) = N’ 
“-%W 
n 
provided 9 does not equal 0 or 1. 
These results show that for large n there is a rather well-defined volume (at 
least in the logarithmic 
sense) of high probability, 
and that within this 
volume the probability density is relatively uniform (again in the logarithmic 
sense). 
In the white noise case the distribution function is given by 
Since this depends only on Xx: the surfaces of equal probability 
density 
are spheres and the entire distribution has spherical symmetry. 
The region 
- 
of high probability 
is a sphere of radius d,zN. 
As I&--+ Q, the probability 
of being outside a sphere of radius dm 
approaches zero and k times 
the logarithm of the volume of the sphere approaches log m. 
In the continuous case it is convenient to work not with the entropy ZZ of 
an ensemble but with a derived quantity 
which we will call the entropy 
power. 
This is defined as the power in a white noise limited to the same 
band as the original ensemble and having the same entropy. 
In other words 
if H’ is the entropy of an ensemble its entropy power is 
N1 = 2be exp 211’. 
In the geometrical picture this amounts to measuring the high probability 
volume by the squared radius of a sphere having the same volume. 
Since 
white noise has the maximum entropy for a given power, the entropy power 
of any noise is less than or equal to its actual power. 
22. ENTROPY Loss IN LINEAR 
FILTERS 
Theorem 14: If an ensemble having an entropy ZZr per degree of freedom 
in band W is passed through a filter with characteristic 
l’(J) 
the output 
ensemble has an entropy 
zz, = ZZI + tfi s, log / I’(I) 1” dj. 

A Mathematical Theory of Communication 
61 
The operation of the filter is essentially a linear transformation 
of co- 
ordinates. 
If we think of the different frequency components as the original 
coordinate system, the new frequency components are merely the old ones 
multiplied 
by factors. 
The coordinate transformation 
matrix is thus es- 
TABLE 
I 
GAIN 
I 
ENTROPY 
ENTROPY 
POWER 
POWER 
GAIN 
FACTOR 
IN DECIBELS 
, - “3 
----) 
11 
0.384 
0 
GJ 
I 
-2.66 
-6.66 
a 
IMPULSE 
RESPONSE 
SIN’? %‘t 
(ntF 
cost-1 
co5 
t 
SIN t’ 
---+- 
t4 
2t.2 
t3 
q 
J, W 
P---- t 
-!- 
at* [ 
cos 
(I-cqt-cos 
t 1 
sentially diagonalized in terms of these coordinates. 
The Jacobian of the 
transformaCon is (for 18 sine and IZ cosine components) 
J = Q I Y(fi) I2 

C.E.Shannon 
where the ji are equally spaced through the band W. 
This becomes in 
the limit 
exp f jw log I Y(j) I2 df. 
Since J is constant its average value is this same quantity and applying the 
theorem on the change of entropy with a change of coordinates, the result 
follows. 
We may also phrase it in terms of the entropy power. 
Thus if 
the entropy power of the first ensemble is N1 that of the second is 
NI exp 1: J w log I y(j) 
I2 dfr 
The final entropy power is the initial entropy power multiplied by the geo- 
metric mean gain of the filter. 
If the gain is measured in db, then the 
output entropy power will be increased by the arithmetic 
mean db gain 
over W. 
In Table I the entropy power loss has been calculated (and also expressed 
in db) for a number of ideal gain characteristics. 
The impulsive responses 
of these filters are also given for W = 27r, with phase assumed to be 0. 
The entropy loss for many other cases can be obtained from these results. 
For example the entropy power factor f for the first case also applies to any 
gain characteristic obtained from 1 - w by a measure preserving transforma- 
tion of the o axis. 
In particular a linearly increasing gain G(o) = 0, or a 
“saw tooth” characteristic between 0 and 1 have the same entropy loss. 
The reciprocal gain has the reciprocal factor. 
Thus i has the factor e2. 
Raising the gain to any power raises the factor to this power. 
23. ENTROPY OF THE SUM OF Two ENSEMBLES 
If we have two ensembles of functionsf,(l) 
and ga(l) we can form a new 
ensemble by “addition.” 
Suppose the first ensemble has the probability 
density function p(xr , * * - , x,) and the second q(x1 , - . - , 2,). 
Then the 
density function for the sum is given by the convolution: 
- q(xl - yi, ... , x,, - y,,) dyi, dyz, . .- , dy,. 
Physically this corresponds to adding the noises or signals represented by 
the original ensembles of functions. 

A Mathematical Theory of Communication 
63 
The following result is derived in Appendix 6. 
Theorem 15: Let the average power of two ensembles be Nr and N2 and 
let their entropy powers be Nr and fi2. 
sum, f13 , is bounded by 
Then the entropy power of the 
White Gaussian noise has the peculiar property that it can absorb any 
other noise or signal ensemble which may be added to it with a resultant 
entropy power approximately equal to the sum of the white noise power and 
the signal power (measured from the average signal value, which is normally 
zero), provided the signal power is small, in a certain sense, compared to 
the noise. 
Consider the function space associated with thcsc enscmblcs having ?E 
dimensions. 
The white noise corresponds to a spherical Gaussian distribu- 
tion in this space. The signal ensemble corresponds to another probability 
distribution, not necessarily Gaussian or spherical. 
Let the second moments 
of this distribution 
about its center of gravity 
be aij. 
That 
is, if 
Pbl, 
**- 9 x,) is the density distribution 
function 
Uij = s 
s 
* * * 
p(:ri - ai)(xj - aj) dxl, * * * , dx, 
where the ai are the coordinates of the center of gravity. 
Now aij is a posi- 
tive definite quadratic form, and we can rotate our coordinate system to 
align it with the principal directions of this form. 
aij is then reduced to 
diagonal form bii . 
We require \hat each bii be small compared to N, the 
squared radius of the spherical distribution. 
In this case the convolution of the noise and signal produce a Gaussian 
distribution 
whose corresponding quadratic form is 
N + bii , 
The entropy power of this distribution 
is 
[II(N + bii)I”” 
or approximately 
= [(N)” 
+ Zbii(N)“-‘]l’” 
The last term is the signal power, while the first is the noise power. 

C. E. Shannon 
PART 
IV: THE 
CONTINUOUS 
CHANNEL 
24. TIIE 
CAPACITY OF A CONTINUOUS CHANNEL 
In a continuous channel the input or transmitted 
signals will be con- 
tinuous functions of time/(L) belonging to a certain set,,and the output or 
received signals wili be perturbed versions of these. We will consider only 
the case where both transmitted and received signals are limited to a certain 
band W. 
They can then be specified, for a time T, by 2TW numbers, and 
their statistical 
structure 
by finite dimensional 
distribution 
functions. 
Thus the statistics of the transmitted signal will be determined by 
P(x1, * - ’ ,%I) = P(x) 
and those of the noise by the conditional probability distributidh 
P q ,..., X.(Yl , * * * , y*) = P,(y). 
The rate of transmission of information for a continuous channel is defined 
in a way analogous to that for a discrete channel, namely 
R = H(x) 
- 
Ii,(x) 
where H(X) is the entropy of the input and 11&) the equivocation. 
Tbc 
channel capacity C is defined as the maximum of R when we vary the input 
over all possible ensembles. 
This means that in a finite dimensional ap- 
proximation we must vary P(x) = P(xl , * * * , 2,) and maximize 
- 
1 P(x) 
log P(x) dx + 11 
P(x, y) log ‘# 
dx dy. 
This can be written 
ss 
&, y) 
ax, Y) log 
-- 
P(x)P(y) 
dx dy 
using the fact that 
P(x, y) log P(x) dx dy = s P(x) 
log P(x) d.r. 
The 
channel capacity is thus expressed 
C = Lim Max 1 
r--ra, 
p(z) 
T 
p(x, Y> 1% ‘(‘7 
Y) dx dy 
PbmY) 
* 
It is obvious in this form that R and C are independent of the coordinate 
system since the numerator and denominator in log 
Y> 
P(x, 
PWYY) 
will be multi- 
plied by the same factors when x and y are transformed in any one to one 
way. 
This integral expression for C is more general than N(x) - 
ri,(x). 
Properly interpreted (see Appendix 7) it will always exist while H(x) - H*(x) 

A Mathematical Theory of Communication 
65 
may assume an indeterminate form m - ~0 in some cases. This occurs, for 
example, if x is limited to a surface of fewer dimensions than 18 in its IZ dimen- 
sional approximation. 
If the logarithmic base used in computing II(X) and I-l,(x) is two then C 
is the maximum number of binary digits that can be sent per second over the 
channel with arbitrarily 
small equivocation, just as in the discrete case. 
This can be seen physically by dividing the space of signals into a large num- 
ber of small cells, sufficiently small so that the probability 
density P,(y) 
of signal x being perturbed to point y is substantially constant over a cell 
(either of N or y). 
If the cells are considered as distinct points the situation 
is essentially the same as a discrete channel and the proofs used there will 
apply. 
But it is clear physically that this quantizing of the volume into 
individual 
points cannot in any practical situation alter the final answer 
significantly, provided the regions are sutliciently small. 
Thus the capacity 
will be the limit of the capacities for the discrete subdivisions and this is 
just the continuous capacity defined above. 
On the mathematical side it can be shown first (see Appendix 7) that if u 
is the message, x is the signal, y is the received signal (perturbed by noise) 
and v the recovered message then 
Zi(x) - ZZJX) 2 ZZ(u) - H,(u) 
regardless of what operations are performed on u to obtain x or on y to obtain 
u. Thus no matter how we encode the binary digits to obtain the signal, or 
how we decode the received signal to recover the message, the discrete rate 
for the binary digits does not exceed the channel capacity WC have defined. 
On the other hand, it is possible under very general conditions to find a 
coding system for transmitting 
binary digits at the rate C with as small an 
equivocation or frequency of errors as desired. 
This is true, for example, if, 
when we take a finite dimensional approximating space for the signal func- 
tions, P(r, y) is continuous in both x and y except at a set of points of prob- 
ability zero. 
An important 
special case occurs when the noise is added to the signal 
and is independent of it (in the probability sense). 
Then P,(y) is a function 
only of the difference n = (y - x), 
Pz(Y) = Q(Y - 
4 
and we can assign a definite entropy to the noise (independent of the sta- 
tistics of the signal), namely the entropy of the distribution 
Q(lt). 
This 
entropy will be denoted by ZZ(n). 
Theorem Id: If the signal and noise are independent and the received 
signal is the sum of the transmitted 
signal and the noise then the rate of 

66 
C. E. Shannon 
transmission is 
R * 
ZZ(y) - 
U(H) 
i.e., the entropy of the received signal less the entropy of the noise. 
The 
channel capacity is 
c = ~~zx N(y) - II(N). 
We have, since y = x + 12: 
ZZ(x, y) = zz(x, u). 
Expanding the left side and using the fact that x and IZ are independent 
my) 
+ B”(X) = Jw 
+ H(4. 
Hence 
R = ZZ(x) - 
Ziv(x) = U(y) 
- 
a(n). 
Since ZZ(w) is independent of P(x), 
maximizing R requires maximizing 
a(y), the entropy of the received signal. 
If there are certain constraints on 
the ensemble of transmitted signals, the entropy’of the received signal must 
be maximized subject to these constraints. 
25. CHANNEL CAPACITY WITH AN AVIZRAGE POWER LIMITATION 
A simple application of Theorem 16 is the case where the noise is a white 
thermal noise and the transmitted signals arc limited to a certain average 
power P. 
Then the received signals have an average power P + N where 
N is the average noise power. 
The maximum entropy for the received sig- 
nals occurs when they also form a white noise ensemble since this is the 
greatest possible entropy for a power P + N and can be obtained by a 
suitable choice of the ensemble of transmitted signals, namely if they form a 
white noise ensemble of power P. 
The entropy (per second) of the re- 
ceived ensemble is then 
NY) = w log 27re(P + iv), 
and the noise entropy is 
ZZ(n) = w log 27reN. 
The channel capacity is 
c = ZZ(y) - 
P+N 
M(n) = w log N 
. 
Summarizing we have the following: 
Theorem 17: The capacity of a channel of band W perturbed by white 

A Mathematical 
Theory of Communication 
67 
thermal noise of power iV when the average transmitter power is P is given by 
C 
P+N 
= w log 7 
. 
This means of course that by sufficiently involved encoding systems we 
can transmit binary digits at the rate W log2 P+N 
N 
bits per second, with 
arbitrarily 
small frequency of errors. 
It is not possible to transmit at a 
higher rate by any encoding system without a definite positive frequency of 
errors. 
To approximate this limiting 
rate of transmission the transmitted signals 
must approximate, in statistical properties, a white noise.6 A system which 
approaches the ideal rate may be described as follows: Let M = 2” samples 
of white noise be constructed 
each of duration 
T. 
These are assigned 
binary numbers from 0 to (U - 
1). 
At the transmitter 
the message se- 
quences are broken up into groups of s and for each group the corresponding 
noise sample is transmitted as the signal. 
At the receiver the M samples are 
known and the actual received signal (perturbed by noise) is compared with 
each of them. 
The sample which has the least R.M .S. discrepancy from the 
received signal is chosen as the transmitted 
signal and the corresponding 
binary number reconstructed. 
This process amounts to choosing the most 
probable (a posleriori) signal. 
The number M of noise samples used will 
depend on the tolerable frequency t of errors, but for almost all selections of 
samples we have 
Lim Lim 
log M(e, 
T) = w log P f 
N 
-, 
e-so T-boa 
T 
N 
so that no matter .how small e is chosen, we can, by taking T sufficiently 
P+N 
large, transmit as near as we wish to TW log N 
binary digits in the 
time T. 
Formulas similar to C = IV log c;J 
for the white noise case have 
been developed independently by several other writers, although with some- 
what different interpretations. 
We may mention the work of N. Wiener,’ 
W. G. Tuller,’ and II. Sullivan in this connection. 
In the case of an arbitrary perturbing noise. (not necessarily white thermal 
noise) it does not appear that the maximizing 
problem involved in deter- 
eThis and other properties of the white noise case are discussed from the geometrical 
point of view in “Communication 
in the Presence of Noise,” 
lot. cit. 
“‘Cybernetics,” 
lot. cit. 
OSc. D. thesis, Dcpartmcnt 
of Electrical 
Engineering, M.I.T., 
1948 

68 
C. E. Shannon 
mining the channel capacity C can be solved explicitly. 
Hawcver, upper 
and lower bounds can be set for C in terms of the average noise power N 
and the noise entropy power Nl . These bounds are sufficiently close to: 
gether in most practical 
cases to furnish a satisfactory 
solution 
to the 
problem. 
Theorem 18: The capacity of a channel of band IV perturbed by an arbi- 
trary noise is bounded by the inequalities 
P + NI 
w log - 
P-I-N 
Nl 
5 c < w log 7 
1 
where 
P 
= average transmitter power 
N = average noise power 
Nl = entropy power of the noise. 
Here again the average power of the perturbed signals will be P + N. 
The maximum 
entropy for this power would occur if the received signal 
were white noise and would be W log 2ne(P + N). 
It may not be possible 
to achieve this; i.e. there may not be any ensemble of transmitted 
signals 
which, added to the perturbing noise, produce a white thermal noise at the 
receiver, but at least this sets an upper bound to El(y). 
We have, therefore 
C = max U(y) - ZZ(n) 
5 W log 2ne(P i- N) - 
W log 2reNr. 
This is the upper limit given in the theorem. 
The lower limit can be ob- 
tained by considering the rate if we make the transmitted 
signal a white 
noise, of power P. 
In this case the entropy power of the received signal 
must be at least as great as that of a white noise of power P + ATI since we 
have shown in a previous theorem that the entropy power of the sum of two 
ensembles is greater than or equal to the sum of the individual 
entropy 
powers. 
Hence 
and 
max H(y) >_ W log 2?re(P + N1) 
C 2 W log 2re(P 
-I- NI) 
- 
W log 2rreNr 
P + NI 
= w log ~ 
. 
Nl 
As P increases, the upper and lower bounds approach each other, so we 
have as an asymptotic rate 
PfN 
w log - Nl 

A Mathematical 
Theory of Communication 
69 
If the noise is itself white, N = iVr and the result reduces to the formula 
proved previously: 
C=Wlog 
1+;, 
( 
> 
If the noise is Gaussian but with a spectrum which is not necessarily flat, 
Nr is the geometric mean of the noise power over the various frequencies in 
the band W. 
Thus 
Nl = exp $ s log 
NJ) dJ 
W 
where N(J) 
is the noise power at frequencyf. 
Theorem 19: If we set the capacity for a given trausmitter 
power P 
equal to 
C = w log P+N-t, N 
1 
then v is monotonic decreasing as P increases and approaches 0 as a limit. 
Suppose that for a given power PI the channel capacity is 
w 1% PI + N - tl~ 
N 1 
This means that the best signal distribution, 
say P(X), when added .to the 
noise distribution 
q(x), gives a received distribution 
r(y) 
whose entropy 
power is (PI + N - 
VI). 
Let us increase the power to PI + AP by adding 
a white noise of power AP to the signal. 
The entropy of the received signal 
is now at least 
H(yj = W log 2re(Pl+ 
N - 
r]l + AP) 
by application of the theorem on the minimum 
entropy power of a sum. 
Hence, since we can attain the I. indicated, the entropy of the maximizing 
distribution 
must be at least as great and 7 must be monotonic decreasing. 
To show that q -+ 0 as P + 00 consider a signal which is a white noise with 
a large P. 
Whatever 
the perturbing 
noise, the received signal will be 
approximately 
a white noise, if P is sufficiently large, in the sense of having 
an entropy power approaching P + N. 
26. THE 
CHANNEL 
CAPACITY WITH A PEAK POWER LIMITATION 
In some applications the transmitter 
is limited not by the average power 
output but by the peak instantaneous power. 
The problem of calculating 
the channel capacity is then that of maximizing (by variation of the ensemble 
of transmitted 
symbols) 
Jw 
- a4 

C. E. Shannon 
subject to the constraint that all the functions j(l) in the ensemble be less 
than or equal to 6, 
say, for all 1. A constraint of this type does not work 
out as well mathematically 
as the average power limitation. 
The most we 
have obtained for this case is a lower bound valid for all $ an “asymptotic” 
upper band 
( 
valid for large $ 
> 
and an asymptotic value of C for $ small. 
Theorem 20: The channel capacity C for a band IV perturbed by white 
thermal noise of power N is bounded by 
where 5’ is the peak allowed transmitter power. 
For sufficiently large 
c < w logre 
N 
(1 + 4 
where B is arbitrarily 
small. 
As $ + 0 (and provided the band W starts 
at 0) 
C+Wlog 
1+$ 
. 
( 
> 
We wish to maximize the entropy of the received signal. 
If i 
is large 
this will occur very nearly when we maximize the entropy of the trans- 
mitted ensemble. 
The asymptotic upper bound is obtained by relaxing the conditions on 
the ensemble. 
Let us suppose that the power is limited to S not at every 
instant of time, but only at the sample points. 
The maximum entropy of 
the transmitted 
ensemble under these weakened conditions is certainly 
greater than or equal to that under the original conditions. 
This altered 
problem can be solved easily. 
The maximum entropy occurs if the different 
samples are independent and have a distribution 
function which is constant 
from - z/J; to + a. 
The entropy can be calculated as 
w log 4s. 
The received signal will then have an entropy less than 
W log (4s + 2*eN)(l 
+ e) 

A Mathematical 
Theory of Communication 
71 
with c -+ 0 as i + 00 and the channel capacity is obtained by subtracting 
the entropy of the white noise, W log 2neN 
-?S+N 
W log (4s + 2?reN)(l -I- e) - 117 log (27reN) = W log ?re N 
(1 + 4. 
This is the desired upper bound to the channel capacity. 
To obtain a’lower bound consider the same ensemble of functions. 
Let 
these functions be passed through an ideal filter with a triangular transfer 
characteristic. 
The gain is to be unity at frequency 0 and decline linearly 
down to gain 0 at frequeney W. 
We first show that the output functions 
of the filter have a peak power limitation 
5’ at all times (not just the sample 
points). 
sin 2ifWt 
First we note that a pulse 2 
going into the filter produces 
7r 
1 sin” ?rWt 
-- 
2 (?TWt)2 
in the output. 
This function is never negative. 
The input function (in 
the general case) can be thought of as the sum of a series of shifted functions 
sin 27rlV1 
a 
27rwt 
where a, the amplitude of the sample, is not greater than 6. 
Hence the 
output is the sum of shifted functions of the non-negative foim above with 
the same coeflicients. 
These functions being non-negative, the greatest 
positive value for any t is obtained when all the coefficients a have their 
maximum positive values, i.e. l/s. 
In this case the input function was a 
constant of amplitude 4 
and since the filter has unit gain for D.C., the 
output is the same. 
Hence the output ensemble has a peak power 5’. 
The entropy of the output ensemble can be calculated from that of the 
input ensemble by using the theorem dealing with such a situation. 
The 
output entropy is equal to the input entropy plus the geometrical mean 
gain of the filter; 
~wlogG2dJ 
= ~wlog(~)2dJ 
= -2W 
Hence the output entropy is 
w log 4s - 
2w 
= w1og4; 

72 
C. E. Shannon 
and the channel capacity is greater than 
w log $-* 5. 
We now wish to show that, for small 5 (peak signal power over average 
white noise power), the channel capacity is approximately 
C=Wlog 
1+; 
. 
( 
> 
More precisely C/W log 
+ 1 as G -+ 0. 
Since the average signal 
power P is less than or equal to the peak S, it follows that for all S 
N 
c 5 kVlog(l 
+;) 
5 lVlog(l 
-I-s>. 
Therefore, if we can find an ensemble of functions such that they correspond 
to a rate nearly W log 
( 
> 
1 + g 
and are limited to band IV and peak S the 
result will be proved. 
Consider the ensemble of functions of the following 
type. 
A series of t samples have the same value, either +z/s 
or - <S, 
then the next 1 samples have the same value, etc. 
The value for a scrics 
is chosen at random, probability 
3 for +a 
and $ for - & 
If this 
ensemble be passed through a filter with triangular gain characteristic (unit 
gain at D.C.), the output is peak limited to fS. 
Furthermore the average 
power is nearly S and can be made to approach this by taking I sufficiently 
large. 
The entropy of the sum of this and the thermal noise can be found 
by applying the theorem on the sum of a noise and a small signal. 
This 
theorem will apply if 
is sufficiently small. 
This can be insured by taking i small enough (after 
1 is chosen). 
The entropy power will be S + N to as close an approximation 
as desired, and hence the rate of transmission as near as we wish to 

A Mathematical 
Theory of Communication 
73 
PART 
V: THE 
RATE 
I;OR A COKTINUOUS 
SOURCE 
27. FIDELITY 
EVALUATION 
FUNCTIONS 
In the case of a discrete source of information we were able to determine a 
definite rate of generating information, 
namely the entropy of the under- 
lying stochastic process. With a continuous source the situation is con- 
siderably more involved. 
In the first place a continuously variable quantity 
can assume an infinite number of values and requires, therefore, an infinite 
number of binary digits for exact specification. 
This means that to transmit 
the output of a continuous source with exac.4 recovery at the receiving point 
requires, in general, a channel of infinite capacity (in bits per second). 
Since, ordinarily, 
channels have a certain amount of noise, and therefore a 
finite capacity, exact transmission is impossible. 
This, however, evades the real issue. Practically, 
we are not interested 
in exact transmission when we have a continuous source, but only in trans- 
mission to within a certain tolerance. 
The question is, can we assign a 
definite rate to a continuous source when we require only a certain fidelity 
of recovery, measured in a suitable way. 
Of course, as the fidelity require- 
ments are increased the rate will increase. 
It will be shown that we can, in 
very general cases, define such a rate, having the property that it is possible, 
by properly encoding the information, 
to transmit it over a channel whose 
capacity is equal to the rate in question, and satisfy the fidelity requirements. 
A channel of smaller capacity is insufficient. 
It is first necessary to give a general mathematical formulation of the idea 
of fidelity of transmission. 
Consider the set of messages of a long duration, 
jay T seconds. The source is described by giving the probability 
density, 
in the associated space, that the source will select the message in question 
P(X). 
A given communication 
system is described (from the external point 
of view) by giving the conditional probability 
P*(y) 
that if message x is 
produced by the source the recovered message at the receiving point will 
be y. 
The system as a whole (including source and transmission system) 
is described by the probability 
function P(r, 
y) of having message I\: and 
final output y. 
If this function is known, the complete characteristics of 
the system from the point of view of fidelity are known. 
Any evaluation 
of fidelity 
must correspond mathematically 
to an operation applied to 
I-‘@, y). 
This operation must at least have the properties of a simple order- 
ing of.systems; i.e. it must be possible to say of two systems represented by 
Pl(x, y) and P2(x, y) that, according to our fidelity criterion, either (1) the 
first has higher fidelity, (2) the second has higher fidelity, or (3) they have 

74 
C. E. Shannon 
equal fidelity. 
This means that a criterion of fidelity can be represented by 
a numerically valued function: 
vu% 
Y)> 
whose argument ranges over possible probability 
functions P(x, y). 
We will now show that under very general and reasonable assumptions 
the function v(P(x, y)) can be written in a seemingly much more specialized 
form, namely as an average of a function p(x, y) over the set of possible values 
of x and y: 
v(P(x, 
Y)> = //- 
P(x, Y> P(X, Y) dx dr 
To obtain this we need only assume (1) that the source and system are 
ergodic so that a very long sample will be, with probability 
nearly 1, typical 
of the ensemble, and (2) that the evaluation is “reasonable” in the sense 
that it is possible, by observing a typical input and output x1 and yr , to 
form a tentative 
evaluation on the basis of these samples; and if these 
samples are increased in duration the tentative evaluation will, with proba- 
bility 1, approach the exact evaluation based on a full knowledge of P(x, y). 
Let the tentative 
evaluation be p(x, y). 
Then the function p(x, y) ap- 
proaches (as T 4 
a) a constant for almost all (x, y) which are in the high 
probability 
region corresponding to the system: 
Pb, 
Y) --+ wx, 
Y>> 
and we may also write 
Pb, Y) + 
SJ 
Pb, 
YMX, 
Y> dx, dr 
since 
SJ 
P(x, y) dx dy = 1 
This establishes the desired result. 
The function p(x, y) has the general nature of a “distance” 
between x 
and y.’ 
It measures how bad it is (according to our fidelity 
criterion) 
to 
receive y when x is transmitted. 
The general result given above can be 
restated as follows: Any reasonable evaluation can be represented as an 
average of a distance function over the set of messages and recovered mes- 
sages x and y weighted according to the probability 
P(x, y) of getting the 
pair in question, provided the duration 
T of the messages bc taken sufh- 
ciently large. 
9It is not a “metric” 
in the strict sense, however, since in general it does not satisfy 
tither 
P(X, Y) = P(Y, 2) or P@, y) -t dr, 
2) 2 ~6% 2). 

A Mathematical 
Theory of Communication 
75 
The following are simple examples of evaluation functions: 
1. R.M.S. Criterion. 
v = (x(0 - Ym2 
In this very commonly used criterion of fidelity 
the distance function 
p(x, y) is (apart from a constant factor) the square of the ordinary 
euclidean distance between the points x and y in the associated function 
spa05 
Pb, Y> = f 
s = [x(t) 
- 
y(t)l” 
dt 
0 
2. Frequency weighted R.M.S. criterion. 
More generally one can apply 
different weights to the different frequency components before using an 
R.M.S. measure of fidelity. 
This is equivalent to passing the difference 
x(r) - 
y(l) through a shaping filter and then determining 
the average 
power in the output. 
Thus let 
4 
= 4) 
- y(t) 
and 
‘(‘I 
= I”, 
e(T)h(t - ,-) & 
then 
PC% 
Y> = f 
s oT J(t)2 dt. 
3. Absolute error criterion. 
PC% 
Y> = f 
! o T 1 x(t) 
- 
r(t) 
I dt 
4. The structure of the ear and brain determine implicitly 
an evaluation, or 
rather a number of evaluations, appropriate in the case of speech or music 
transmission. 
There is, for example, an “intelligibility” 
criterion 
in 
which p(x, y) is equal to the relative frequency of incorrectly interpreted 
words when message x(t) is received as y(t). 
Although we cannot give 
an explicit representation of p(x, y) in these cases it could, in principle, 
be determined by sufficient experimentation. 
Some of its properties 
follow from well-known experimental results in hearing, e.g., the ear is 
relatively 
insensitive to phase and the sensitivity 
to amplitude and fre- 
quency is roughly logarithmic. 
5. The discrete case can be considered as a specialization in which we have 

C. E. Shannon 
tacitly assumed an evaluation based on the frequency of errors. 
The 
function p(x, y) is then defined as the number of symbols in the sequence 
y differing from the corresponding symbols in x divided by the total num- 
ber of symbols in x. 
28. TIIE RATE POR A SOURCE RELATIVE 
TO A FIDELITY 
EVALUATION 
We are now in a position to define a rate of generating information 
for a 
continuous source. 
We are given P(X) for the source and an evaluation v 
determined by a distance function p(x, y) which will be assumed continuous 
in both x and y. 
With a particular system P(x, y) the quality is measured by 
v= 
dx, 
y) P(x, y) dx dy 
Furthermore the rate of flow of binary digits corresponding to P(x, y) is 
R= 
p(x, 
Y) 
pb, 
Y> 1% p(z>p(r) 
dx dY* 
We define the rate RI of generating information 
for a given quality vr of 
reproduction to be the minimum of R when we keep v fied at vr and vary 
P,(y). 
That is: 
RI = Min 
P(x, y) log ‘(‘3 
Y) dx ,jy 
P,(U) 
~‘CWY) 
subject to the constraint: 
Pb, Y)P(X, y> dx dy. 
This means that we consider, in effect, all the communication systems that 
might be used and that transmit with the required fidelity. 
The rate of 
transmission in bits per second is calculated for each one and we cl~oose that 
having the least rate. 
This latter rate is the rate we assign the source for 
the fidelity in question. 
The justification of this definition lies in the following result: 
Tlgeorenz 21: If a source has a rate RI for a valuation v1 it is possible to 
encode the output of the source and transmit it over a channel of capacity C 
with fidelity as near vr as desired provided RI < C. 
This is not possible 
if RI > C. 
The last statement in the theorem follows immediately from the definition 
of RI and previous results. 
If it were not true we could transmit more than 
C bits per second over a channel of capacity C. 
The first part of the theorem 
is proved by a method analogous to that used for Theorem 11. We may, in 
the first place, divide the (x, y) space into a large number of small cells and 

A Mathematical Theory of Communication 
77 
represent Lhc situation as a discrete case. This will not change the cvalua- 
tion function by more than an arbitrarily 
small amount (when the cells are 
very small) because of the continuity 
assumed for p(.z., y). 
Suppose that 
Pr(x, y) is the particular system which minimizes the rate and gives RI . 
We 
choose from the high probability y’s a set at random containing 
p, + 4 P 
members where e --+ 0 as T + 
Q). 
With large T each chosen point will be 
connected by a high probability 
line (as in Fig. 10) to a set of 2s. 
A calcu- 
lation similar to that used in proving Theorem 11 shows that with large T 
almost all x’s are covered by the fans from the chosen y points for almost 
all choices of the y’s. 
The communication 
system to bc used operates as 
follows: The selected points are assigned binary numbers. 
When a message 
x is originated it will (with probability 
approaching 1 as T + m) lie within 
one at least of the fans. 
The corresponding binary number is transmitted 
(or one of them chosen arbitrarily 
if there are several) over the channel by 
suitable coding means to give a small probability 
of error. 
Since RI < C 
this is possible. 
At the receiving point the corresponding y is reconstructed 
and used as the recovered message. 
The evaluation V: for this system can be made arbitrarily 
close to ~1, by 
taking T sufliciently large. 
This is due to the fact that for each long sample 
of message ~(1) and recovered message y(f) the evaluation approaches vl 
(with probability 
1). 
It is interesting to note that, in this system, the noise in the recovered 
message is actually produced by a kind of general quantizing at the trans- 
mitter and is not produced by the noise in the channel. 
It is more or less 
analogous to the quantizing noise in P.C.M. 
29. TIE 
CALCULATION OF RATES 
The definition of the rate is similar in many respects to the dctinition of 
channel capacity. 
In the former 
R = Min 
P,(Y) 
with P(X) and r~r = 
P(x, y)&, 
y) dx dy fixed. 
In the latter 
C = Max 
P(x y) log !%L~- 
dx dy 
, 
P(Z) 
I-’ 
with P,(y) fixed and possibly one or more other constraints (e.g., an average 
power limitation) 
of the form A = JJ I’(-\., y) X(X, y) dx dy. 

78 
C. E. Shannon 
A partial solution of the general maximizing problem for determining the 
rate of a source can be given. 
Using Lagrange’s method we consider 
ss [ 
z’(xy r) 
Z’(x, y) log -- 
fwP(Y) 
+ /.I P(x, y)p(x, y) + Y(X)Z’(X, y)] dx dy 
The variational 
equation (when we take the tirst variation 
on Y(x, y)) 
leads to 
Py(x) = n(x) e--xp(=*y) 
where X is determined to give the required fidelity and U(X) is chosen to 
satisfy 
s 
,Ij(x)e-XP(=‘U) dx = 1 
This shows that, with best encoding, the conditional probability 
of a cer- 
tain cause for various received y, Z’,,(X) will decline exponentially with the 
distance function p(x, y) between the x and y is question. 
In the special case where the distance function p(x, y) depends only on the 
(vector) difference between x and y, 
P(% Y> = Pb - Y> 
we have 
s 
B(x)e+‘(+-“) 
dr = 1. 
Hence B(z) is constant, say 01, and 
p&) 
= a~-~p(‘--y) 
Unfortunately 
these formal solutions arc diflicult 
to cvaluatc in particular 
cases and seem to bc of little value. 
In fact, the actual calculation of rates 
has been carried out in only a few very simple cases. 
If the distance function p(x, y) is the mean square discrepancy between 
x and y and the message ensemble is white noise, the rate can bc determined. 
In that case we have 
R = Min Ill(x) 
- ZZ,(z)] = ZZ(r) - Max ZZ,(r) 
with N = (X - y)‘. 
But the Max ZZV(x) occurs when y - z is a white noise, 
and is equal to IV1 log 2*e N where 1Vr is the bandwidth of the message en- 
semble. 
Therefore 
R = WI log 2reQ - 
11’1 log 2reh’ 
where Q is the avcragc message power. 
This proves the following: 

A Mathematical Theory of Communication 
19 
Theorem 22: The rate for a white noise source of power Q and band WI 
r&live 
to an R.M.S. measure of fidelity is 
R = WI log $ 
where N is t:.e allowed mean square error between original and recovered 
messages. 
More generally with any message source we can obtain inequalities bound- 
ing the rate relative to a mean square error criterion. 
Theorem 23: The rate for any source of band WI is bounded by 
wllog$ 
2 RI 
W&g; 
where Q is the average power of the source, Q1 its entropy power and N the 
allowed mean square error. 
The lower bound follows from the fact that the max III(~) for a given 
(x - r)” = N occurs in the white noise case. The upper bound results if we 
place the points (used in the proof of Theorem 21) not in the best way but 
at random in a sphere of radius 4Q 
- N. 
ACKNOWLEDGMENTS 
The writer is indebted to his colleagues at the Laboratories, particularly 
to Dr. H. W. Bode, Dr. J. R. Pierce, Dr. B. McMillan, 
and Dr. 13. M. Oliver 
for many helpful suggestions and criticisms during the course of this work. 
Credit should also be given to Professor N. Wiener, whose elegant solution 
of the problems of filtering and prediction of stationary ensembles has con- 
siderably influenced the writer’s thinking in this field. 
APPENDIX 
5 
Let St be any measurable subset of the g ensemble, and SZ the subset of 
thef ensemble which gives S1 under the operation T. 
Then 
& = T&s 
Let 11’ be the operator which shifts all functions in a set by the time X. 
Then 
I?& 
= i?TSz 
= TII’S, 
since T is invariant and therefore commutes with 11”. Hence if m[S] is the 
probability 
measure of the set S 
m[II”&] 
= m[TIIXS2] 
= m[d&] 
= m[Sd = m[S11 

80 
C. E. Shannon 
where the second equality is by definition of measure in the g space the 
third since thef ensemble is stationary, and the last by definition of 6 meas- 
ure again. 
To prove that the ergodic property is preserved under invariant operations, 
let Sr be a subset of the g ensemble which is invariant under NX, and let 5’~ 
be the set of all functionsf 
which transform into Si. 
Then 
HxSl = HAT& 
= TIIA& 
= S, 
so that 11’Sr is included in Si for all X. Now, since 
m[IIAS21 = m[&l 
this implies 
II”& 
= sz 
for all X with nt[&] # 0, 1. This contradiction shows that St does not exist. 
APPENDIX 
6 
The upper bound, fi, 2 Nr + Nz , is due to the fact that the maximum 
possible entropy for a power Ni + Nz occurs when we have a white noise of 
this power. 
In this case the entropy power is Nr + Nz. 
To obtain the lower bound, suppose we have two distributions in 12 dimen- 
sions p(xJ and q(xi) with entropy powers Nr and fl,. 
What form should 
p and q have to minimize the entropy power ma of their convolution Y(xi): 
Y(G) 
= 
s 
fi(ri)q(% 
- 
ri> 
dyi 
* 
The entropy HB of Y is given by 
IIs 
= 
- 
J 
Y(Xi) 
log 
Y(X<) 
dXi* 
We wish to minimize this subject to the constraints 
HI = - J 
P(G) 
1% 
p(G) 
dxi 
Hz 
= - s q(xi) 
log 
q(xi) 
dxi 
- 
We consider then 
II = - j- 144 1% 44 
+ Mx> 1% PM + WI(x) 1% &>I 
dx 
611 = - s [I1 + log Y(x)lsY(4 + Ml + log p(x>lsp(x) 
+ P11 + log qbdM4ll ok 

A Mathematical Theory of Communication 
If P(X) is varied at a particular argument xi = si, the variation in Y(X) is 
6Y(X) = Q(Xi - S,) 
and 
6U = - s q(xi - Si) log Y(r\.i) dxi - X log $(.yi) = 0 
and similarly when q is varied. 
Hence the conditions for a minimum are 
J 
rlCxi 
- 
Si) log 
Y(Xi) 
= 
-A 
log 
p(S,) 
s 
PCxi 
- 
Si) log 
Y(Xi) 
= 
-p 
log 
q(Si). 
If WC multiply 
the first by p(Si) and the second by q(si) and integrate with 
respect to s we obtain 
II3 = -A 
III 
IIS = -p 
zzz 
or solving for X and ~1 and replacing in the equalions 
III J 
Q(Xi 
- 
Si) log 
Y(Xi) 
dXi 
= 
-II, 
log 
p(Si) 
112 
s 
p(Xi 
- 
Si) log 
Y(Xi) 
dXi 
= 
-113 
log 
j?(Si). 
NOW suppose #(Xi) and q(Xi) are normal 
P(Xi) = !A!& 
exp - 
fZA;jX;Xj 
q(xi) = I$“; 
exp - 
~ZBijXiXj. 
Then T(Xi) will also be normal with quadratic form Cij. 
If the inverses of 
these forms are aij, bij, cij then 
cij = a;j + bij. 
We wish to show that these functions satisfy the minimizing conditions if 
and only if aij = Kbij and thus give the minimum 113 under Ihe constraints. 
First we have 
log 
Y(~‘i) 
= 
f 
log 
~ 
1 Cij 
1 - 
~ZCijXiXj 
s 
q(xi - si) log I(%;) = T log $ 1 Cij I - +2;CijSiSj - $Xijbij. 

82 
C. E. Shannon 
This should equai 
2 
T log 
& 
I flij 
I - 
~zAijS;Sj 
1 [ 
1 
which requires /1 ii = s 
Cij s 
3 
In this case A ii = IS Bij and both equations reduce to identities. 
2 
APPENDIX 
7 
The following will indicate a more general and more rigorous approach to 
the central definitions of communication 
theory. 
Consider a probability 
measure space whose elements are ordered pairs (x, r). 
The variables x, y 
are to be identified as the possible transmitted and received signals of some 
long duration T. 
Let us call the set of all points whose x belongs to a subset 
Sr of x points the strip over SI , and similarly the set whose y belongs to .I& 
the strip over SZ . We divide x and y into a collection of non-overlapping 
measurable subsets Xi and I’; approximate to the rate of transmission R by 
where 
.P(Xi) is the probability 
measure of the strip over Xi 
P( Vi) is the probability 
measure of the strip over 1’; 
P(X;, Ui) is the probability 
measure of the intersection of the strips. 
A further subdivision can never decrease RI. 
For let Xr be divided into 
X1 = Xi + Xi’ and let 
P(I’1) = a 
P(X,) 
= b + c 
Ii 
= b 
zyx:, 
Y,) = d 
P(X:‘) 
= c 
P(X:‘, 
Yl) = e 
P(Xl, 
Yl) = d + e 
Then, in the sum we have replaced (for the Xi, 1’1 intersection) 
by 
a! log $ + e log 5. 
ac 
It is easily shown that with the limitation 
we have on b, c, d, e, 
d f e 
L-1 d-ts 
< 82” 
bfc 
-. 
bd C. 

A Mathematical Theory of Communication 
83 
and consequently the sum is increased. 
Thus the various possible subdivi- 
sions form a directed set, with R monotonic increasing with refinement of 
the subdivision. 
We may define R unambiguously as the least upper bound 
for the RI and write it 
R=# 
P(x, Y> 
P(x, Y) 1% p(x)p(y) 
dx dY* 
This integral, understood in the above sense, includes both the continuous 
and discrete cases and of course many others which cannot be represented 
in either form. 
It is trivial in this formulation that if x and u are in one-to- 
one correspondence, the rate from u to y is equal to that from x to y. 
If v 
is any function of y (not necessarily with an inverse) then the rate from x to 
y is greater than or equal to that from x to v since, in the calculation of the 
approximations, the subdivisions of y are essentially a finer subdivision of 
those for v. More generally if y and v are related not functionally 
but 
statistically, 
i.e., we have a probability measure space (y, v), then R(x, v) < 
R(x, y). 
This means that any operation applied to the received signal, even 
though it involves statistical elements, does not increase R. 
Another notion which should be defined precisely in an abstract formu- 
lation of the theory is that of “dimension rate,” that is the average number 
of dimensions required per second to specify a member of an ensemble. 
In 
the band limited case 2W numbers per second are sufficient. 
A general 
definition can be framed as follows. 
Letf,(l) 
be an ensemble of functions 
and let ~~If&),fddl 
b e a metric measuring the “distance” 
from fa to Ifa 
over the time T (for example the R.M.S. discrepancy over this interval.) 
Let N(e, 6, T) be the least number of elementsf which can be chosen such 
that all elements of the ensemble apart from a set of measure d are within 
the distance E of at least one of those chosen. 
Thus we are covering the 
space to within t apart from a set of small measure 6. 
We define the di- 
mension rate X for the ensemble by the triple limit 
log N(e, 6, T) 
X = Lim Lim Lim -___. 
6-0 
a-10 
T-.-a 
T log E 
This is a generalization of the measure type delinitions of dimension in 
topology, and agrees with the intuitive dimension rate for simple ensembles 
where the desired result is obvious. 

