ANALYTIC COMBINATORICS
—
(Chapters I, II, III, IV, V, VI, VII, VIII, IX⋆)
PHILIPPE FLAJOLET
&
ROBERT SEDGEWICK
Algorithms Project
Department of Computer Science
INRIA Rocquencourt
Princeton University
78153 Le Chesnay
Princeton, NJ 08540
France
USA
Web Edition. Ninth Printing (Valentine’s): February 14, 2007
last corrected May 3, 2007.
(This temporary version will expire on July 1st, 2007)
♥♥♥♥♥♥

2
In this edition of May 3, 2007:
— Chapters 0, 1, 2, 3, 4, 5, 6, 7, 8 are in quasi-semi-ﬁnal form.
— Chapter 9 is still in a very preliminary form
— Chapter 10, in preparation is not included.
— Appendices are under constant revision.
Also, both long and short forms of construction names are currently used, with one destined to become the
standard eventually. For unlabelled classes, the dictionary is
S ≡SEQ,
M ≡MSET,
P ≡PSET,
C ≡CYC,
while for labelled classes,
S ≡SEQ,
P ≡SET,
C ≡CYC .
c⃝Philippe Flajolet and Robert Sedgewick; May 3, 2007.

i
PREFACE
ANALYTIC COMBINATORICS aims at predicting precisely the properties of large
structured combinatorial conﬁgurations, through an approach based extensively on
analytic methods. Generating functions are the central objects of the theory.
Analytic combinatorics starts from an exact enumerative description of combina-
torial structures by means of generating functions, which make their ﬁrst appearance
as purely formal algebraic objects. Next, generating functions are interpreted as an-
alytic objects, that is, as mappings of the complex plane into itself. Singularities
determine a function’s coefﬁcients in asymptotic form and lead to precise estimates
for counting sequences. This chain applies to a large number of problems of discrete
mathematics relative to words, trees, permutations, graphs, and so on. A suitable adap-
tation of the methods also opens the way to the quantitative analysis of characteristic
parameters of large random structures, via a perturbational approach.
Analytic combinatorics can accordingly be organized based on three components:
Symbolic Methods develops systematic relations between some of the major
constructions of discrete mathematics and operations on generating func-
tions which exactly encode counting sequences.
Complex Asymptotics elaborates a collection of methods by which one can
extract asymptotic counting information from generating functions, once
these are viewed as analytic transformations of the complex domain. Singu-
larities then appear to be a key determinant of asymptotic behaviour.
Random Structures concerns itself with probabilistic properties of large ran-
dom structures. Which properties hold with high probability? Which laws
govern randomness in large objects? In the context of analytic combina-
torics, these questions are treated by a deformation (adding auxiliary vari-
ables) and a perturbation (examining the effect of small variations of such
auxiliary variables) of the standard enumerative theory.
THE APPROACH to quantitative problems of discrete mathematics provided by
analytic combinatorics can be viewed as an operational calculus for combinatorics.
The present book exposes this view by means of a very large number of examples
concerning classical combinatorial structures—most notably, words, trees, composi-
tions, partitions, permutations, mapings, allocations, planar maps, and graphs. The
eventual goal is an effective way of quantifying metric properties of large random
structures.
Given its capacity of quantifying properties of large discrete structures, Analytic
Combinatorics is susceptible to many applications, within combinatorics itself, but,
perhaps more importantly, within other areas of science where discrete probabilistic
models recurrently surface, like statistical physics, computational biology, electrical

ii
engineering, and information theory. Last but not least, the analysis of algorithms
and data structures in computer science has served and still serves as an important
motivation in the development of the theory.
⋆⋆⋆⋆⋆⋆
Part A: Symbolic Methods. This part speciﬁcally exposes Symbolic Methods,
which is a uniﬁed algebraic theory dedicated to setting up functional relations be-
tween counting generating functions. As it turns out, a collection of general (and
simple) theorems provide a systematic translation mechanism between combinato-
rial constructions and operations on generating functions. This translation process is
a purely formal one. Precisely, as regards basic counting, two parallel frameworks
coexist—one for unlabelled structures and ordinary generating functions, the other
for labelled structures and exponential generating functions. Furthermore, within the
theory, parameters of combinatorial conﬁgurations can be easily taken into account
by adding supplementary variables. Three chapters then compose this part: Chapter I
deals with unlabelled objects; Chapter II develops in a parallel way labelled objects;
Chapter III treats multivariate aspects of the theory suitable for the analysis of param-
eters of combinatorial structures.
⋆⋆⋆⋆⋆⋆
Part B: Complex asymptotics. This part speciﬁcally exposes Complex Asymp-
totics, which is a uniﬁed analytic theory dedicated to the process of extracting as-
ymptotic information from counting generating functions. A collection of general
(and simple) theorems provide a systematic translation mechanism between gener-
ating functions and asymptotic forms of coefﬁcients. Four chapters compose this
part. Chapter IV serves as an introduction to complex-analytic methods and proceeds
with the treatment of meromorphic functions, that is, functions whose singularities are
poles, rational functions being the simplest case. Chapter V develops applications of
rational and meromorphic asymptotics of generating functions, with numerous appli-
cations related to words and languages, walks and graphs, as well as permutations.
Chapter VI develops a general theory of singularity analysis that applies to a wide
variety of singularity types, such as square-root or logarithmic, and has applications
to trees as well as to other recursively deﬁned combinatorial classes. Chapter VII
presents applications of singularity analysis to 2-regular graphs and polynomials,
trees of various sorts, mappings, context-free languages, walks, and maps. It contains
in particular a discussion of the analysis of coefﬁcients of algebraic functions. Chap-
ter VIII explores saddle point methods, which are instrumental in analysing functions
with a violent growth at a singularity, as well as many functions with only a singularity
at inﬁnity (i.e., entire functions).
⋆⋆⋆⋆⋆⋆
Part C: Random Structures. This part includes Chapter IX dedicated to the
analysis of multivariate generating functions viewed as deformation and perturbation
of simple (univariate) functions. As a consequence, many important characteristics
of classical combinatorial structures can be precisely quantiﬁed in distribution. Chap-
ter ?? is an epilogue, which offers a brief recapitulation of the major asymptotic prop-
erties of discrete structures developed in earlier chapters.

iii
⋆⋆⋆⋆⋆⋆
Part D: Appendices. Appendix A summarizes some key elementary concepts of
combinatorics and asymptotics, with entries relative to asymptotic expansions, lan-
guages, and trees, amongst others. Appendix B recapitulates the necessary back-
ground in complex analysis. It may be viewed as a self-contained minicourse on
the subject, with entries relative to analytic functions, the Gamma function, the im-
plicit function theorem, and Mellin transforms. Appendix C recalls some of the basic
notions of probability theory that are useful in analytic combinatorics.
⋆⋆⋆⋆⋆⋆
THIS BOOK is meant to be reader-friendly. Each major method is abundantly il-
lustrated by means of concrete examples1 treated in detail—there are scores of them,
spanning from a fraction of a page to several pages—offering a complete treatment of a
speciﬁc problem. These are borrowed not only from combinatorics itself but also from
neighbouring areas of science. With a view of addressing not only mathematicians of
varied proﬁles but also scientists of other disciplines, Analytic Combinatorics is self-
contained, including ample appendices that recapitulate the necessary background in
combinatorics and complex function theory. A rich set of short Notes—there are more
than 250 of them—are inserted in the text2 and can provide exercises meant for self-
study or for students’ practice, as well as introductions to the vast body of literature
that is available. We have also made every effort to focus on core ideas rather than
technical details, supposing a certain amount of mathematical maturity but only basic
prerequisites on the part of our gentle readers. The book is also meant to be strongly
problem-oriented,and indeed it can be regarded as a manual, or even a huge algorithm,
guiding the reader to the solution of a very large variety of problems regarding dis-
crete mathematical models of varied origins. In this spirit, many of our developments
connect nicely with computer algebra and symbolic manipulation systems.
COURSES can be (and indeed have been) based on the book in various ways.
Chapters I–III on Symbolic Methods serve as a systematic yet accessible introduction
to the formal side of combinatorial enumeration. As such it organizes transparently
some of the rich material found in treatises3 like those of Bergeron-Labelle-Leroux,
Comtet, Goulden-Jackson, and Stanley. Chapters IV–VIII relative to Complex Asymp-
totics provide a large set of concrete examples illustrating the power of classical com-
plex analysis and of asymptotic analysis outside of their traditional range of applica-
tions. This material can thus be used in courses of either pure or applied mathematics,
providing a wealth of nonclassical examples. In addition, the quiet but ubiquitous
presence of symbolic manipulation systems provides a number of illustrations of the
power of these systems while making it possible to test and concretely experiment
with a great many combinatorial models. Symbolic systems allow for instance for
fast random generation, close examination of non-asymptotic regimes, efﬁcient ex-
perimentation with analytic expansions and singularities, and so on.
1Examples are marked by “EXAMPLE · · · □”.
2Notes are indicated by  · · · .
3References are to be found in the bibliography section at the end of the book.

iv
Our initial motivation when starting this project was to build a coherent set of
methods useful in the analysis of algorithms, a domain of computer science now well-
developed and presented in books by Knuth, Hofri, Mahmoud, and Szpankowski, in
the survey by Vitter–Flajolet, as well as in our earlier Introduction to the Analysis of
Algorithms published in 1996. This book can then be used as a systematic presenta-
tion of methods that have proved immensely useful in this area; see in particular the
Art of Computer Programming by Knuth for background. Studies in statistical physics
(van Rensburg, and others), statistics (e.g., David and Barton) and probability theory
(e.g., Billingsley, Feller), mathematical logic (Burris’ book), analytic number theory
(e.g., Tenenbaum), computational biology (Waterman’s textbook), as well as informa-
tion theory (e.g., the books by Cover–Thomas, MacKay, and Szpankowski) point to
many startling connections with yet other areas of science. The book may thus be
useful as a supplementary reference on methods and applications in courses on statis-
tics, probability theory, statistical physics, ﬁnite model theory, analytic number theory,
information theory, computer algebra, complex analysis, or analysis of algorithms.
Acknowledgements. This book would be substantially different and much less in-
formative without Neil Sloane’s Encyclopedia of Integer Sequences, Steve Finch’s
Mathematical Constants, Eric Weisstein’s MathWorld, and the MacTutor History of
Mathematics site hosted at St Andrews. All are (or at least have been at some stage)
freely available on the Internet. Bruno Salvy and Paul Zimmermann have devel-
oped algorithms and libraries for combinatorial structures and generating functions
that are based on the MAPLE system for symbolic computations and have proven
to be extremely useful. We are deeply grateful to the authors of the free software
Unix, Linux, Emacs, X11, TEX and LATEX as well as to the designers of the symbolic
manipulation system MAPLE for creating an environment that has proved invaluable
to us. We also thank students in courses at Barcelona, Berkeley (MSRI), Bordeaux,
Caen, Paris (´Ecole Polytechnique, ´Ecole Normale, University), Princeton, Santiago de
Chile, Udine, and Vienna whose feedback has greatly helped us prepare a better book.
Thanks ﬁnally to numerous colleagues for their feedback. In particular, we wish to
acknowledge the support, help, and interaction provided at an incredibly high level
by members of the Analysis of Algorithms (AofA) community, with a special mention
for Hsien-Kuei Hwang, Svante Janson, Don Knuth, Guy Louchard, Andrew Odlyzko,
Daniel Panario, Helmut Prodinger, Bruno Salvy, Mich`ele Soria, Wojtek Szpankowski,
Brigitte Vall´ee, Mark Ward, and Mark Wilson. Stan Burris, Svante Janson, Lo¨ıc Tur-
ban, and Brigitte Vall´ee especially have provided insightful suggestions and generous
feedbacks that have led us to revise the presentation of several sections of this book
and correct many errors. Finally, support of our home institutions (INRIA and Prince-
ton University) as well as various grants (French government, European Union and
the ALCOM Project, NSF) have contributed to making our collaboration possible.
PHILIPPE FLAJOLET & ROBERT SEDGEWICK
May 3, 2007

Contents
An invitation to Analytic Combinatorics
1
Part A. SYMBOLIC METHODS
13
I.
Combinatorial Structures and Ordinary Generating Functions
15
I. 1.
Symbolic enumeration methods
16
I. 2.
Admissible constructions and speciﬁcations
23
I. 3.
Integer compositions and partitions
37
I. 4.
Words and regular languages
47
I. 5.
Tree structures
61
I. 6.
Additional constructions
77
I. 7.
Perspective
84
II.
Labelled Structures and Exponential Generating Functions
87
II. 1.
Labelled classes
88
II. 2.
Admissible labelled constructions
91
II. 3.
Surjections, set partitions, and words
98
II. 4.
Alignments, permutations, and related structures
110
II. 5.
Labelled trees, mappings, and graphs
116
II. 6.
Additional constructions
126
II. 7.
Perspective
136
III.
Combinatorial Parameters and Multivariate Generating Functions
139
III. 1.
An introduction to bivariate generating functions (BGFs)
141
III. 2.
Bivariate generating functions and probability distributions
144
III. 3.
Inherited parameters and ordinary MGFs
151
III. 4.
Inherited parameters and exponential MGFs
163
III. 5.
Recursive parameters
170
III. 6.
Complete generating functions and discrete models
174
III. 7.
Additional constructions
187
III. 8.
Extremal parameters
203
III. 9.
Perspective
207
Part B. COMPLEX ASYMPTOTICS
209
IV.
Complex Analysis, Rational and Meromorphic Asymptotics
211
IV. 1.
Generating functions as analytic objects
212
IV. 2.
Analytic functions and meromorphic functions
216
IV. 3.
Singularities and exponential growth of coefﬁcients
226
v

vi
CONTENTS
IV. 4.
Closure properties and computable bounds
236
IV. 5.
Rational and meromorphic functions
242
IV. 6.
Localization of singularities
250
IV. 7.
Singularities and functional equations
261
IV. 8.
Perspective
272
V.
Applications of Rational and Meromorphic Asymptotics
275
V. 1.
A roadmap to rational and meromorphic asymptotics
276
V. 2.
Regular speciﬁcation and languages
278
V. 3.
Nested sequences, lattice paths, and continued fractions.
295
V. 4.
The supercritical sequence and its applications
313
V. 5.
Paths in graphs and automata
320
V. 6.
Transfer matrix models
340
V. 7.
Perspective
356
VI.
Singularity Analysis of Generating Functions
359
VI. 1.
A glimpse of basic singularity analysis theory
360
VI. 2.
Coefﬁcient asymptotics for the basic scale
364
VI. 3.
Transfers
372
VI. 4.
The process of singularity analysis
376
VI. 5.
Multiple singularities
381
VI. 6.
Intermezzo: functions of singularity analysis class
383
VI. 7.
Inverse functions
385
VI. 8.
Polylogarithms
390
VI. 9.
Functional composition
393
VI. 10.
Closure properties
399
VI. 11.
Tauberian theory and Darboux’s method
414
VI. 12.
Perspective
418
VII.
Applications of Singularity Analysis
421
VII. 1.
A roadmap to singularity analysis asymptotics
423
VII. 2.
Sets and the exp–log schema
427
VII. 3.
Simple varieties of trees and inverse functions
434
VII. 4.
Tree-like structures and implicit functions
445
VII. 5.
Nonplane unlabelled trees and P´olya operators
453
VII. 6.
Irreducible context-free structures
460
VII. 7.
The general analysis of algebraic functions
469
VII. 8.
Combinatorial applications of algebraic functions
482
VII. 9.
Ordinary differential equations and systems
492
VII. 10.
Perspective
503
VIII.
Saddle Point Asymptotics
507
VIII. 1.
Landscapes of analytic functions and saddle points
508
VIII. 2.
Saddle point bounds
512
VIII. 3.
Overview of the saddle point method
516
VIII. 4.
Three combinatorial examples
522
VIII. 5.
Admissibility
528
VIII. 6.
Integer partitions
540
VIII. 7.
Large powers
547
VIII. 8.
Saddle points and probability distributions
556

CONTENTS
vii
VIII. 9.
Multiple saddle points
558
VIII. 10.
Perspective
564
Part C. RANDOM STRUCTURES
567
IX.
Multivariate Asymptotics and Limit Distributions
569
IX. 1.
Limit laws and combinatorial structures
571
IX. 2.
Discrete limit laws
577
IX. 3.
Combinatorial instances of discrete laws
584
IX. 4.
Continuous limit laws
595
IX. 5.
Quasi-powers and Gaussian limits
600
IX. 6.
Perturbation of meromorphic asymptotics
605
IX. 7.
Perturbation of singularity analysis asymptotics
618
IX. 8.
Perturbation of saddle point asymptotics
638
IX. 9.
Local limit laws
642
IX. 10.
Large deviations
647
IX. 11.
Non-Gaussian continuous limits
650
IX. 12.
Multivariate limit laws
661
IX. 13.
Notes
662
Part D. APPENDICES
665
Appendix A.
Auxiliary Elementary Notions
667
Appendix B.
Basic Complex Analysis
685
Appendix C.
Complements of Probability Theory
715
Bibliography
725
Index
743


An invitation to Analytic
Combinatorics
diä
d
summei
gnÔmena
aÎt

te
prä 
aÍt

kaÈ
prä 
llhla
tn
poikilÐan
âstÈ
n
peira;
© 
d
deØ
jewroÌ 
gÐ
gnesjai
t
oÌ 
mèllo
nt
a 
perÈ
fÔsew 
eÊkì
ti
lì
gú
— PLATO, The Timaeus1
ANALYTIC COMBINATORICS is primarily a book about Combinatorics, that is,
the study of ﬁnite structures built according to a ﬁnite set of rules. Analytic in the title
means that we concern ourselves with methods from mathematical analysis, in partic-
ular complex and asymptotic analysis. The two ﬁelds, combinatorial enumeration and
complex asymptotics, are organized into a coherent set of methods for the ﬁrst time
in this book. Our broad objective is to discover how the continuous may help us to
understand the discrete and to quantify its properties.
COMBINATORICS is as told by its name the science of combinations. Given ba-
sic rules for assembling simple components, what are the properties of the resulting
objects? Here, our goal is to develop methods dedicated to quantitative properties of
combinatorial structures. In other words, we want to measure things. Say that we
have n different items like cards or balls of different colours. In how many ways
can we lay them on a table, all in one row? You certainly recognize this counting
problem—ﬁnding the number of permutations of n elements. The answer is of course
the factorial number, n ! = 1·2 · · ·n. This is a good start, and, equipped with patience
or a calculator, we soon determine that if n = 31, say, then the number is the rather
large2
31 ! = 8222838654177922817725562880000000 .= 0.8222838654 · 1034.
The factorials solve an enumerative problem, one that took mankind some time to sort
out, because the sense of the ‘· · · ’ in the formula is not that easily grasped. In his book
1“So their combinations with themselves and with each other give rise to endless complexities, which
anyone who is to give a likely account of reality must survey.” Plato speaks of Platonic solids viewed as
idealized primary constituents of the physical universe.
2 We use ‘α .= d to represent a numerical estimation of the real α by the decimal d, with the last digit
being at most ±1 from its actual value.
1

2
AN INVITATION TO ANALYTIC COMBINATORICS
The Art of Computer Programming (vol III, p. 23), Donald Knuth traces the discovery
to the Hebrew Book of Creation (c. A.D. 400) and the Indian classic Anuyogadv¯ara-
sutra (c. A.D. 500).
Here is another more subtle problem. Assume that you are interested in permuta-
tions such that the ﬁrst element is smaller than the second, the second is larger than the
third, itself smaller than the fourth, and so on. The permutations go up and down and
they are diversely known as up-and-down or zigzag permutations, the more digniﬁed
name being alternating permutations. Say that n = 2m + 1 is odd. An example is for
n = 9:
8
7
9
3
ր
ց
ր
ց
ր
ց
ր
ց
4
6
5
1
2
The number of alternating permutations for n = 1, 3, 5, . . . turns out to be
1, 2, 16, 272, 7936, 353792, 22368256, . . ..
What are these numbers and how do they relate to the total number of permutations of
corresponding size? A glance at the corresponding ﬁgures, that is, 1!, 3!, 5!, . . . or
1, 6, 120, 5040, 362880, 39916800, 6227020800, . . .
suggests that the factorials grow somewhat faster—just compare the lengths of the last
two displayed lines. But how and by how much? This is the prototypical question we
are addressing in this book.
Let us now examine the counting of alternating permutations. In 1881, the French
mathematician D´esir´e Andr´e made a startling discovery. Look at the ﬁrst terms of the
Taylor expansion of the trigonometric function tan(z):
tan z = 1 z
1! + 2z3
3! + 16z5
5! + 272z7
7! + 7936z9
9! + 353792z11
11! + · · · .
The counting sequence for alternating permutations curiously surfaces. We say that
the function on the left is a generating function for the numerical sequence (precisely,
a generating function of the exponential type due to the presence of factorials in the
denominators).
Andr´e’s derivation may nowadays be viewed very simply as reﬂecting the con-
struction of permutations by means of certain binary trees: Given a permutation σ a
tree can be obtained once σ has been decomposed as a triple ⟨σL, max, σR⟩, by tak-
ing the maximum element as the root, and appending, as left and right subtrees, the
trees recursively constructed from σL and σR. Part A of this book develops at length
symbolic methods by which the construction of the class T of all such trees,
T
=
1
+
(T , max , T )
translates into an equation relating generating functions,
T (z)
=
z
+
Z z
0
T (w)2 dw.
In this equation, T (z) := P
n Tnzn/n! is the exponential generating function of the
sequence (Tn), where Tn is the number of alternating permutations of (odd) length n.
There is a compelling formal analogy between the combinatorial speciﬁcation and the

AN INVITATION TO ANALYTIC COMBINATORICS
3
world of generating functions: Unions (∪) give rise to sums (+), max-placement gives
an integral (
R
), forming a pair of trees means taking a square ([·]2).
At this stage, we know that T (z) must solve the differential equation
d
dz T (z) = 1 + T (z)2,
T (0) = 0,
which, by classical manipulations, yields T (z) ≡tan z. The generating function then
provides a simple algorithm to compute recurrently the coefﬁcients, since the formula,
tan z = sin z
cos z = z −z3
3! + z5
5! −· · ·
1 −z2
2! + z4
4! −· · ·
,
implies (n odd)
Tn −
n
2

Tn−2 +
n
4

Tn−4 −· · · = (−1)(n−1)/2,
where
a
b

=
a!
b!(a −b)!
is the conventional notation for binomial coefﬁcients. At this stage, the exact enumer-
ative problem may be regarded as solved since a very simple recurrent algorithm is
available for determining the counting sequence, while the generating function admits
an explicit expression in terms of a well known function.
ANALYSIS, by which we mean mathematical analysis, is often described as the
art and science of approximation. How fast do the factorial and the tangent number
sequences grow? What about comparing their growths? These are typical problems
of analysis.
First, consider the number of permutations, n!. Quantifying the growth of these
numbers as n gets large takes us to the realm of asymptotic analysis. The way to
express factorial numbers in terms of elementary functions is known as Stirling’s for-
mula,
n! ∼nne−n√
2πn,
where the ∼sign means “approximately equal” (in fact, in the precise sense that the
ratio of both terms tends to 1 as n gets large). This beautiful formula, associated with
the name of the eighteenth century Scottish mathematician James Stirling, curiously
involves both the basis e of natural logarithms and the perimeter 2π of the circle.
Certainly, you cannot get such a thing without analysis. As a ﬁrst step, there is an
estimate for
log n! =
n
X
j=1
log j ∼
Z n
1
log x dx ∼n log
n
e

,
explaining at least the nne−n term, but already requiring some amount of elementary
calculus. (Stirling’s formula precisely came a few decades after the fundamental bases
of calculus had been laid by Newton and Leibniz.) Note the usefulness of Stirling’s
formula: it tells us almost instantly that 100! has 158 digits, while 1000! borders the
astronomical 102568.
We are now left with estimating the growth of the sequence of tangent numbers,
Tn. The analysis leading to the derivation of the generating function tan(z) has been
so far essentially algebraic or “formal”. Well, we can plot the graph of the tangent
function, for real values of its argument and see that the function becomes inﬁnite

4
AN INVITATION TO ANALYTIC COMBINATORICS
x
6
4
2
0
-2
-4
-6
4
2
0
-2
-4
2
1
0
y
-1
-2
0.5
-1
0
1
1
-2
2
x
1.5
2
2.5
FIGURE .1.
Two views of the function z 7→tan z: (left) a plot for real values
of z ∈[−5..5]; (right) the modulus | tan z| when z is assigned complex values in
the square ±2.25 ± 2.25√−1.
at the points ± π
2 , ±3 π
2 , and so on (Figure 1). Such points where a function ceases
to be smooth are called singularities. By methods amply developed in this book, it
is the local nature of a generating function at its “dominant” singularities (i.e., the
ones closest to the origin) that determines the asymptotic growth of the sequence of
coefﬁcients. In this perspective, the basic fact that tan z has dominant singularities at
± π
2 enables us to reason as follows: ﬁrst approximate the generating function tan z
near its two dominant singularities, namely,
tan(z)
∼
z→±π/2
8z
π2 −4z2 ;
then extract coefﬁcients of this approximation; ﬁnally, get in this way a valid approx-
imation of coefﬁcients:
Tn
n!
∼
n→∞2 ·
 2
π
n+1
(n odd).
With present day technology, we also have available symbolic manipulation sys-
tems (also called “computer algebra” systems) and it is not difﬁcult to verify the ac-
curacy of our estimates. Here is a small pyramid for n = 3, 5, . . . , 21,
2
1
16
1 5
272
27 1
7936
793 5
353792
35379 1
22368256
2236825 1
1903757312
1903757 267
209865342976
20986534 2434
29088885112832
290888851 04489
4951498053124096
495149805 2966307
(Tn)
(T ⋆
n)

AN INVITATION TO ANALYTIC COMBINATORICS
5
FIGURE .2.
The collection of all binary trees for sizes n = 2, 3, 4, 5 with re-
spective cardinalities 2, 5, 14, 42.
comparing the exact values of Tn against the approximations T ⋆
n, where (n odd)
T ⋆
n :=
$
2 · n!
 2
π
n+1%
,
and discrepant digits of the approximation are displayed in bold. For n = 21, the error
is only of the order of one in a billion. Asymptotic analysis is in this case wonderfully
accurate.
In the foregoing discussion, we have played down a fact, and an important one.
When investigating generating functions from an analytic standpoint, one should gen-
erally assign complex values to arguments not just real ones. It is singularities in
the complex plane that matter and complex analysis is needed in drawing conclu-
sions regarding the asymptotic form of coefﬁcients of a generating function. Thus,
a large portion of this book relies on a complex analysis technology, which starts to
be developed in Part B of the book titled Complex Asymptotics. This approach to
combinatorial enumeration parallels what happened in the nineteenth century, when
Riemann ﬁrst recognized the deep relation between complex-analytic properties of the
zeta function, ζ(s) := P 1/ns, and the distribution of primes, eventually leading to
the long-sought proof of the Prime Number Theorem by Hadamard and de la Vall´ee-
Poussin in 1896. Fortunately, relatively elementary complex analysis sufﬁces for our
purposes, and we can include in this book a complete treatment of the fragment of the
theory needed to develop the bases of analytic combinatorics.
Here is yet another example illustrating the close interplay between combina-
torics and analysis. When discussing alternating permutations, we have enumerated
binary trees bearing distinct integer labels that satisfy a constraint—to increase along
branches. What about the simpler problem of determining the number of possible
shapes of binary trees? Let Cn be the number of binary trees that have n binary
branching nodes, hence n + 1 “external nodes”. It is not hard to come up with an
exhaustive listing for small values of n; see Figure 2, from which we determine that
C0 = 1, C1 = 1, C2 = 2, C3 = 5, C4 = 14, C5 = 42.
These numbers are probably the most famous ones of elementary combinatorics. They
have come to be known as the Catalan numbers as a tribute to the Belgian French
mathematician Eug`ene Charles Catalan (1814-1894),but they already appear in works
of Euler and Segner in the second half of the eighteenth century. In his reference

6
AN INVITATION TO ANALYTIC COMBINATORICS
treatise on Enumerative Combinatorics, Stanley lists over twenty pages a collection of
some 66 different types of combinatorial structures that are enumerated by the Catalan
numbers.
First, one can write a combinatorial equation, very much in the style of what has
been done earlier, but without labels:
C
=
2
+
(C, • , C).
With symbolic methods, it is easy to see that the ordinary generating function of the
Catalan numbers deﬁned as
C(z) :=
X
n≥0
Cnzn,
satisﬁes an equation that is a direct reﬂection of the combinatorial deﬁnition, namely,
C(z)
=
1
+
z C(z)2.
This is a quadratic equation whose solution is
C(z) = 1 −√1 −4z
2z
.
Then, by means of Newton’s theorem relative to the expansion of (1 + x)α, one ﬁnds
easily (x = −4z, α = 1
2) the closed form expression
Cn =
1
n + 1
2n
n

.
Regarding asymptotic approximation, Stirling’s formula comes to the rescue: it
implies
Cn ∼C⋆
n
where
C⋆
n :=
4n
√
πn3 .
This approximation is quite usable: it predicts C⋆
1
.= 2.25 (whereas C1 = 1), which
is off by a factor of 2, but the error drops to 10% already for n = 10, and it appears to
be less than 1% for any n ≥100.
A plot of the generating function C(z) in Figure 3 illustrates the fact that C(z) has
a singularity at z = 1
4 as it ceases to be differentiable (its derivative becomes inﬁnite).
That singularity is quite different from a pole and for natural reasons it is known as
a square-root singularity. As we shall see repeatedly, under suitable conditions in
the complex plane, a square root singularity for a function at a point ρ invariably
entails an asymptotic form ρ−nn−3/2 for its coefﬁcients. More generally, it sufﬁces
to estimate a generating function near a singularity in order to deduce an asymptotic
approximation of its coefﬁcients. This correspondence is a major theme of the book,
one that motivates the four central chapters.
A consequence of the complex-analytic vision of combinatorics is the detection of
universality phenomena in large random structures. (The term is originally borrowed
from statistical physics and is nowadays ﬁnding increasing use in areas of mathe-
matics like probability theory.) By universality is meant here that many quantitative
properties of combinatorial structures only depend on a few global features of their
deﬁnitions, not on details. For instance a growth in the counting sequence of the form
C · Ann−3/2,

AN INVITATION TO ANALYTIC COMBINATORICS
7
-0.3
z
0.2
0
3
-0.2
-0.1
2
1
1.5
0.1
2.5
40
30
50
20
0.55
10
0.45
0.4
0.35
0.25
0.5
0.3
x
FIGURE .3.
Left: the real values of the Catalan generating function, which has a
square-root singularity at z = 1
4. Right: the ratio Cn/(4nn−3/2) plotted together
with its asymptote at 1/√π .= 0.56418.
arising from a square-root singularity, will be shown to be universal across all vari-
eties of trees determined by a ﬁnite set of allowed node degrees—this includes unary-
binary trees, ternary trees, 0–11–13 trees, as well as many variations like nonplane
trees and labelled trees. Even though generating functions may become arbitrarily
complicated—like an algebraic function of a very high degree or even the solution to
an inﬁnite functional equation—it is still possible to extract with relative ease global
asymptotic laws governing counting sequences.
RANDOMNESS is another ingredient in our story. How useful is it to determine,
exactly or approximately, counts that may be so large as to require hundreds if not
thousands of digits in order to be written down? Take again the example of alternating
permutations. When estimating their number, we have indeed quantiﬁed the propor-
tion of these amongst all permutations. In other words, we have been predicting the
probability that a random permutation of some size n is alternating. Results of this sort
are of interest in all branches of science. For instance, biologists routinely deal with
genomic sequences of length 105, and the interpretation of data requires developing
enumerative or probabilistic models where the number of possibilities is of the order
of 4105. The language of probability theory then proves a great convenience when
discussing characteristic parameters of discrete structures, as we can interpret exact
or asymptotic enumeration results as saying something concrete about the likeliness
of values that such parameters assume. Equally important of course are results from
several areas of probability theory: as demonstrated in the later sections of this book,
such results merge extremely well with the analytic-combinatorial framework.
Say we are now interested in runs in permutations. These are the longest frag-
ments of a permutation that already appear in (increasing) sorted order. Here is a

8
AN INVITATION TO ANALYTIC COMBINATORICS
permutation where runs have been separated by vertical bars:
2 5 8 | 3 9 | 1 4 7 | 6 | .
Runs naturally present in a permutation are for instance exploited by a sorting algo-
rithm called “natural list mergesort”, which builds longer and longer runs, starting
from the original ones and merging them until the permutation is eventually sorted.
For our understanding of this algorithm, it is then of obvious interest to quantify how
many runs a permutation is likely to have.
Let An,k be the number of permutations of size n having k runs. Then, the prob-
lem is once more best approached by generating functions and one ﬁnds that the coef-
ﬁcient of ukzn inside the bivariate generating function,
1 −u
1 −uez(1−u) = 1 + zu + z2
2! (u + 1) + z3
3! (u2 + 4u + 1) + · · · ,
gives the sought numbers An,k/n!. (A simple way of establishing this formula bases
itself on the tree decomposition of permutations and on the symbolic method.) From
there, we can easily determine effectively the mean, variance, and even the higher
moments of the number of runs that a random permutation has: it sufﬁces to expand
blindly, or even better with the help of a computer, the bivariate generating function
above as u →1:
1
1 −z + 1
2
z (2 −z)
(1 −z)2 (u −1) + 1
2
z2  6 −4 z + z2
(1 −z)3
(u −1)2 + · · · .
When u = 1, we just enumerate all permutations: this is the constant term 1/(1 −z)
equal to the exponential generating function of all permutations. The coefﬁcient of
u −1 gives the generating function of the mean number of runs, the next one gives
access to the second moment, and so on. In this way, we discover that the expectation
and standard deviation of the number of runs in a permutation of size n evaluate to
µn = n + 1
2
,
σn =
r
n + 1
12 .
Then by easy analytic-probabilistic inequalities (Chebyshev inequalities) that other-
wise form the basis of what is known as the second moment method, we learn that the
distribution of the number of runs is concentrated around its mean: in all likelihood,
if one takes a random permutation, the number of its runs is going to be very close to
its mean. The effects of such quantitative laws are quite tangible. It sufﬁces to draw a
sample of one element for n = 30 to get something like
13, 22, 29|12, 15, 23|8, 28|18|6, 26|4, 10, 16|1, 27|3, 14, 17, 20|2, 21, 30|25|11, 19|9|7, 24.
For n = 30, the mean is 15 1
2, and this sample comes rather close as it has 13 runs.
We shall furthermore see in Chapter IX that even for moderately large permutations
of size 10,000 and beyond, the probability for the number of observed runs to deviate
by more than 10% from the mean is less than 10−65. As witnessed by this example,
much regularity accompanies properties of large combinatorial structures.
More reﬁned methods combine the observation of singularities with analytic re-
sults from probability theory (e.g., continuity theorems for characteristic functions).
In the case of runs in permutations, the quantity F(z, u) viewed as a function of z

AN INVITATION TO ANALYTIC COMBINATORICS
9
z
1.4
0
1
0.8
0.8
0.2
1.2
0.4
0.4
0.6
-0.4
0
0.4
0.2
0.3
0.1
0
1
0.6
0.4
0.8
0
0.2
FIGURE .4.
Left: A partial plot of the real values of the inverse 1/F(z, u)
for u = 0.1 . . 2, with F the bivariate generating function of Eulerian numbers,
illustrates the presence of a movable pole for F. Right: A diagram showing the
distribution of the number of runs in permutations for n = 6 . . 60.
when u is ﬁxed appears to have a pole: this fact is apparent on Figure 4 [left] since
1/F has a zero at some z = ρ(u) where ρ(1) = 1. Then we are confronted with
a fairly regular deformation of the generating function of all permutations. A pa-
rameterized version (with parameter u) of singularity analysis then gives access to a
description of the asymptotic behaviour of the Eulerian numbers An,k. This enables
us to describe very precisely what goes on: In a random permutation of large size n,
once centred by its mean and scaled by its standard deviation, the distribution of the
number of runs is asymptotically gaussian; see Figure 4 [right].
A somewhat similar type of situation prevails for binary trees, despite the fact
that the counting sequences and the counting generating functions look rather differ-
ent from their permutation counterparts. Say we are interested in leaves (also some-
times known as “cherries”) in trees: these are binary nodes that are attached to two
external nodes (2). Let Cn,k be the number of trees of size n having k leaves. The
bivariate generating function C(z, u) := P
n,k Cn,kznuk encodes all the information
relative to leaf statistics in random binary trees. A modiﬁcation of previously seen
symbolic arguments shows that C(z, u) still satisﬁes a quadratic equation resulting in
the explicit form,
C(z, u) = 1 −
p
1 −4z + 4z2(1 −u)
2z
.
This reduces to C(z) for u = 1, as it should, and the bivariate generating func-
tion C(z, u) is a deformation of C(z) as u varies. In fact, the network of curves
of Figure 5 for several ﬁxed values of u shows that there is a smoothly varying square-
root singularity. It is possible to analyse the perturbation induced by varying values

10
AN INVITATION TO ANALYTIC COMBINATORICS
0.15
y
0.1
0.05
0
0.5
z
0.3
0.25
0.2
2
1.5
0
1
FIGURE .5.
Left: The bivariate generating function C(z, u) enumerating binary
trees by size and number of leaves exhibits consistently a square-root singularity
as a function of z for several values of u. Right: a binary tree of size 300 drawn
uniformly at random has 69 leaves or “cherries”.
of u, to the effect that C(z, u) is of the global analytic type
λ(u) ·
r
1 −
z
ρ(u),
for some analytic λ(u) and ρ(u). The already evoked process of singularity analysis
then shows that the probability generating function of the number of leaves in a tree
of size n satisﬁes an approximation of the form
λ(u)
λ(1)

·
 ρ(1)
ρ(u)
n
(1 + o(1)) .
This “quasi-powers” approximation thus resembles very much the probability
generating function of a sum of n independent random variables, a situation that re-
sorts to the classical Central Limit Theorem of probability theory. Accordingly, the
limit distribution of the number of leaves in a large tree is Gaussian. In abstract terms,
the deformation induced by the secondary parameter (here, the number of leaves, pre-
viously, the number of runs) is susceptible to a perturbation analysis, to the effect that
a singularity gets smoothly displaced without changing its nature (here, a square root
singularity, earlier a pole) and a limit law systematically results. Again some of the
conclusions can be veriﬁed even by very small samples: the single tree of size 300
drawn at random and displayed in Figure 5 has 69 cherries while the expected value
of this number is .= 75.375 and the standard deviation is a little over 4. In a large
number of cases of which this one is typical, we ﬁnd metric laws of combinatorial
structures that govern large structures with high probability and eventually make them
highly predictable.
Such randomness properties form the subject of Part C of this book dedicated to
random structures. As our earlier description implies, there is an extreme degree of

AN INVITATION TO ANALYTIC COMBINATORICS
11
Generating Functions, OGF, EGF
          Chapters I, II
Multivariate Generating Functions, MGF
Singularity Analysis
Chapters IV, V, VI, VII
Saddle Point
          Chapter VIII
COMPLEX ASYMPTOTICS (Part B)
RANDOM STRUCTURES (Part C)
     Chapter IX
Multvariate Asymptotics and Limit Laws
SYMBOLIC METHODS (Part A)
Chapter III
Combinatorial Structures
Exact counting
Limit laws, large deviations
Classical Structures
     Chapter X
Asymptotic counting, moments of parameters
FIGURE .6.
The logical structure of Analytic Combinatorics.
generality in this analytic approach to combinatorial parameters, and after reading this
book, the reader will be able to recognize by herself dozens of such cases at sight, and
effortlessly establish the corresponding theorems.
A RATHER ABSTRACT VIEW of combinatorics emerges from the previous discus-
sion; see Figure 6. A combinatorial class, as regards its enumerative properties, can
be viewed as a surface in four-dimensional real space: this is the graph of its gener-
ating function, considered as a function from the set C ∼= R2 of complex numbers to
itself, and is otherwise known as a Riemann surface. This surface has “cracks”, that
is, singularities, which determine the asymptotic behaviour of the counting sequence.
A combinatorial construction (like forming freely sequences, sets, and so on) can then
be examined based on the effect it has on singularities. In this way, seemingly differ-
ent types of combinatorial structures appear to be subject to common laws governing
not only counting but also ﬁner characteristics of combinatorial structures. For the
already discussed case of universality in tree enumerations, additional universal laws
valid across many tree varieties constrain for instance height (which, with high prob-
ability, is proportional to the square-root of size) and the number of leaves (which is
invariably normal in the asymptotic limit).
Next, the probabilistic behaviour of a parameter of a combinatorial class is fully
determined by a bivariate generating function, which is a deformation of the basic
counting generating function of the class. (In the sense that setting the secondary
variable u to 1 erases the information relative to the parameter and leads back to
the univariate counting generating function.) Then, the asymptotic distribution of a
parameter of interest is characterized by a collection of surfaces, each having its own
singularities. The way the singularities’ locations move or their nature changes under
deformation encodes all the necessary information regarding the distribution of the

12
AN INVITATION TO ANALYTIC COMBINATORICS
parameter under consideration. Limit laws for combinatorial parameters can then be
obtained and the corresponding phenomena can be organized into broad categories,
called schemas. It would not be conceivable to attain such a far-reaching classiﬁcation
of metric properties of combinatorial structures by elementary real analysis alone.
OBJECTS to which we are going to inﬂict the treatments just described include
many of the most important ones of discrete mathematics, also the ones that surface
recurrently in several branches of the applied sciences. We shall thus encounter words
and sequences, trees and lattice paths, graphs of various sorts, mappings, allocations,
permutations, integer partitions and compositions, and planar maps, to name a few.
In most cases, their principal characteristics will be ﬁnely quantiﬁed by the methods
of analytic combinatorics; see our concluding Chapter ?? for a summary. This book
indeed develops a coherent theory of random combinatorial structures based on a pow-
erful analytic methodology. Literally dozens of quite diverse combinatorial types can
then be treated by a logically transparent chain. You will not ﬁnd ready-made answers
to all questions in this book, but, hopefully, methods that can be successfully used to
address a great many of them.

Part A
SYMBOLIC METHODS


I
Combinatorial Structures and
Ordinary Generating Functions
Laplace discovered the remarkable correspondence between
set theoretic operations and operations on formal power series
and put it to great use to solve a variety of combinatorial problems.
— GIAN–CARLO ROTA [414]
Contents
I. 1.
Symbolic enumeration methods
16
I. 2.
Admissible constructions and speciﬁcations
23
I. 3.
Integer compositions and partitions
37
I. 4.
Words and regular languages
47
I. 5.
Tree structures
61
I. 6.
Additional constructions
77
I. 7.
Perspective
84
This chapter and the next are devoted to enumeration, where the problem is to deter-
mine the number of combinatorial conﬁgurations described by ﬁnite rules, and do so
for all possible sizes. For instance, how many different words are there of length 17?
of length n, for general n? These questions are easy, but what if some constraints
are imposed, e.g., no four identical elements in a row? The counting sequences are
exactly encoded by generating functions, and, as we shall see, generating functions
are the central mathematical object of combinatorial analysis. We examine here a
framework that, contrary to traditional treatments based on recurrences, explains the
surprising efﬁciency of generating functions in the solution of combinatorial enumer-
ation problems.
This chapter serves to introduce the symbolic approach to combinatorial enumer-
ations. The principle is that many general set-theoretic constructions admit a direct
translation as operations over generating functions. This principle is made concrete
by means of a dictionary that includes a collection of core constructions, namely the
operations of union, cartesian product, sequence, set, multiset, and cycle. Supple-
mentary operations like pointing and substitution can be also be similarly translated.
In this way, a language describing elementary combinatorial classes is deﬁned. The
problem of enumerating a class of combinatorial structures then simply reduces to
ﬁnding a proper speciﬁcation, a sort of program for the class expressed in terms of the
basic constructions. The translation into generating functions then becomes a purely
mechanical symbolic process.
We show here how to describe integer partitions and compositions in such a con-
text, as well as several basic string and tree enumeration problems. A parallel ap-
proach, developed in Chapter II, applies to labelled objects and exponential generating
15

16
I. UNLABELLED STRUCTURES AND ORDINARY GENERATING FUNCTIONS
functions—in contrast the plain structures considered in this chapter are called unla-
belled. The methodology is susceptible to multivariate extensions with which many
characteristic parameters of combinatorial objects can also be analysed in a uniﬁed
manner: this is to be examined in Chapter III. The symbolic method also has the great
merit of connecting nicely with complex asymptotic methods that exploit analyticity
properties and singularities, to the effect that precise asymptotic estimates are usually
available whenever the symbolic method applies—a systematic treatment of these as-
pects forms the basis of Part B of this book Complex Asymptotics (Chapters IV–VIII).
I. 1. Symbolic enumeration methods
First and foremost, combinatorics deals with discrete objects, that is, objects that
can be ﬁnitely described by construction rules. Examples are words, trees, graphs,
permutations, allocations, functions from a ﬁnite set into itself, topological conﬁgu-
rations, and so on. A major question is to enumerate such objects according to some
characteristic parameter(s).
Deﬁnition I.1. A combinatorial class, or simply a class, is a ﬁnite or denumerable set
on which a size function is deﬁned, satisfying the following conditions:
(i) the size of an element is a nonnegative integer;
(ii) the number of elements of any given size is ﬁnite.
If A is a class, the size of an element α ∈A is denoted by |α|, or |α|A in the
few cases where the underlying class needs to be made explicit. Given a class A,
we consistently let An be the set of objects in A that have size n and use the same
group of letters for the counts An = card(An) (alternatively, also an = card(An)).
An axiomatic presentation is then as follows: a combinatorial class is a pair (A, | · |)
where A is at most denumerable and the mapping | · | ∈(A 7→N) is such that the
inverse image of any integer is ﬁnite.
Deﬁnition I.2. The counting sequence of a combinatorial class is the sequence of
integers (An)n≥0 where An = card(An) is the number of objects in class A that
have size n.
EXAMPLE I.1. Binary words. Consider ﬁrst the set W of binary words, which are words over
the binary alphabet A = {0,1},
W := {ε, 0, 1, 00, 01, 10, 11, 000, 001, 010, . . . , 1001101, . . . },
with ε the empty word. Deﬁne size to be the number of letters a word comprises. There are
two possibilities for each letter and possibilities multiply, so that the counting sequence (Wn)
satisﬁes
Wn = 2n.
(This sequence has a well-known legend associated with the invention of the game of chess: the
inventor was promised by his king one grain of rice for the ﬁrst square of the chessboard, two
for the second, four for the third, and so on. The king naturally could not deliver the promised
263 grains!) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE I.1. □

I. 1. SYMBOLIC ENUMERATION METHODS
17
EXAMPLE I.2. Permutations. The set P of permutations is
P = {. . . 12, 21, 123, 132, 213, 231, 312, 321, 1234, . . . , 532614, . . . },
since a permutation of In := [1 . . n] is a bijective mapping that is representable by an array,
“
1
2
n
σ1
σ2
· · ·
σn
”
,
or equivalently by the sequence σ1σ2 · · · σn of distinct elements from In. Let us deﬁne the
size of a permutation to be its length, n. For a permutation written as a sequence of n distinct
numbers, there are n places where one can accommodate n, then n −1 remaining places for
n −1, and so on. Therefore, the number Pn of permutations of size n satisﬁes
Pn = n! = 1 · 2 · · · n .
As indicated in our Invitation chapter, this formula has been known for a long time: Knuth [307,
p. 23] refers to the Hebrew Book of Creation (c. A.D.. 400), and to the Anuyogadv¯arasutra
(India, c. A.D. 500) for its discovery. . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE I.2. □
EXAMPLE I.3.
Triangulations. The class T of triangulations comprises triangulations of
convex polygonal domains which are decompositions into non-overlapping triangles (taken up
to continuous deformations of the plane). Let us deﬁne the size of a triangulation to be the
number of triangles it is composed of. For the purpose of the present discussion, the reader may
content herself with what is suggested by Figure 1; the formal speciﬁcation of triangulations
appears on p. 33. It is a nontrivial combinatorial result due to Euler and Segner around 1750
that the number Tn of triangulations is
(1)
Tn =
1
n + 1
 
2n
n
!
=
(2n)!
(n + 1)! n!.
Following Euler [156], the counting of triangulations (Tn) is best approached by generat-
ing functions: the modiﬁed binomial coefﬁcients so obtained are known as Catalan num-
bers (see the discussion p. 33) and are central in combinatorial analysis (Section I. 5.3).
END OF EXAMPLE I.3. □
Although the previous three examples are simple enough, it is generally a good
idea, when confronted with a combinatorial enumeration problem, to determine the
initial values of counting sequences, either by hand or better with the help of a com-
puter, somehow. Here, we ﬁnd:
(2)
n
0
1
2
3
4
5
6
7
8
9
10
Wn
1
2
4
8
16
32
64
128
256
512
1024
Pn
1
1
2
6
24
120
720
5040
40320
362880
3628800
Tn
1
1
2
5
14
42
132
429
1430
4862
16796
Such an experimental approach may greatly help identify sequences. For instance, had
we not known the formula (1) for triangulations, observing an unusual factorization
like
T40 = 22 · 5 · 72 · 11 · 23 · 43 · 47 · 53 · 59 · 61 · 67 · 71 · 73 · 79,
which contains all prime numbers from 43 to 79, would quickly put us on the tracks
of the right formula. There even exists nowadays a huge Encyclopedia of Integer
Sequences due to Sloane that is available in electronic form [439] (see also an earlier

18
I. UNLABELLED STRUCTURES AND ORDINARY GENERATING FUNCTIONS
book by Sloane and Plouffe [440]). Indeed, the three sequences (Wn), (Pn), and (Tn)
are respectively identiﬁed1 as EIS A000079, EIS A000142, and EIS A000108.
 I.1. Necklaces. How many different types of necklace designs can you form with n beads,
each having one of two colours, ◦and •? Here are the possibilities for n = 1, 2, 3,
and it is postulated that orientation matters. This is equivalent to enumerating circular arrange-
ments of two letters and an exhaustive listing program can be based on the smallest lexicograph-
ical representation of each word, as suggested by (17) below. The counting sequence starts as
2, 3, 4, 6, 8, 14, 20, 36, 60, 108, 188, 352 and constitutes EIS A000031. [An explicit formula
appears later in this chapter (p. 60).] What if two necklace designs that are mirror images of
one another are identiﬁed?

 I.2. Unimodal permutations. Such a permutation has exactly one local maximum. In other
words it is of the form σ1 · · · σn with σ1 < σ2 < · · · < σk = n and σk = n > σk+1 > · · · >
σn, for some k ≥1. How many such permutations are there of size n? For n = 5, the number
is 16: the permutations are 12345, 12354, 12453, 12543, 13452, 13542, 14532 and 15432 and
their reversals. [Due to Jon Perry, see EIS A000079.]

It is also of interest to note that words and permutations could be enumerated
using the most elementary counting principles, namely, for ﬁnite sets B and C
(3)



card(B ∪C)
=
card(B) + card(C)
(provided B ∩C = ∅)
card(B × C)
=
card(B) · card(C),
We shall see soon that these principles, which lie at the basis of our very concept of
number, admit a powerful generalization (Equation (16) below).
Next, for combinatorial enumeration purposes, it proves convenient to identify
combinatorial classes that are merely variant of one another.
Deﬁnition I.3. Two combinatorial classes A and B are said to be (combinatorially)
isomorphic, which is written A ∼= B, iff their counting sequences are identical. This
condition is equivalent to the existence of a bijection from A to B that preserves size,
and one also says that A and B are bijectively equivalent.
We normally identify isomorphic classes and accordingly employ a plain equality
sign (A = B). We then conﬁne the notation A ∼= B to stress cases where combinato-
rial isomorphism results some nontrivial transformation.
Deﬁnition I.4. The ordinary generating function (OGF) of a sequence (An) is the
formal power series
(4)
A(z) =
∞
X
n=0
Anzn.
The ordinary generating function (OGF) of a combinatorial class A is the generating
function of the numbers An = card(An). Equivalently, the OGF of class A admits
1Throughout this book, a reference like EIS Axxx points to Sloane’s Encyclopedia of Integer Se-
quences [439]. The data base contains more than 100,000 entries.

I. 1. SYMBOLIC ENUMERATION METHODS
19
FIGURE I.1. The class T of all triangulations of regular polygons (with size deﬁned as
the number of triangles) is a combinatorial class. The counting sequence starts as
T0 = 1, T1 = 1, T2 = 2, T3 = 5, T4 = 14, T5 = 42.
Euler determined the OGF T(z) = P
n Tnzn as T(z) = 1 −√1 −4z
2z
, from which there
results that Tn =
1
n+1
`2n
n
´
. These numbers are known as the Catalan numbers (p. 33).
the combinatorial form
(5)
A(z) =
X
α∈A
z|α|.
It is also said that the variable z marks size in the generating function.
The combinatorial form of an OGF in (5) results straightforwardly from observing
that the term zn occurs as many times as there are objects in A having size n.
Naming convention. We adhere to a systematic naming convention: classes, their
counting sequences, and their generating functions are systematically denoted by the
same groups of letters: for instance, A for a class, {An} (or {an}) for the counting
sequence, and A(z) (or a(z)) for its OGF.
Coefﬁcient extraction. We let generally [zn]f(z) denote the operation of extract-
ing the coefﬁcient of zn in the formal power series f(z) = P fnzn, so that
(6)
[zn]

X
n≥0
fnzn

= fn.
(The coefﬁcient extractor [zn]f(z) reads as “coefﬁcient of zn in f(z)”.)

20
I. UNLABELLED STRUCTURES AND ORDINARY GENERATING FUNCTIONS
H  C
2
CH 2
CH 2
N
CH
N
C
HC
HC
3
HC
CH
CH
=⇒
C10H14N2
;
z26
FIGURE I.2.
A molecule, methylpyrrolidinyl-pyridine (nicotine), is a complex assem-
bly whose description can be reduced to a single formula corresponding here to a total of
26 atoms.
The OGFs corresponding to our three examples W, P, T are then
(7)



















W(z)
=
∞
X
n=0
2nzn
=
1
1 −2z
P(z)
=
∞
X
n=0
n! zn
T (z)
=
∞
X
n=0
1
n + 1
2n
n

zn
=
1 −√1 −4z
2z
.
The ﬁrst expression relative to W(z) is immediate as it is the sum of a geometric pro-
gression; The second generating function P(z) is not related to simple functions of
analysis. (Note that the expression makes sense within the strict framewok of formal
power series; see APPENDIX A: Formal power series, p. 676.) The third expression
relative to T (z) is equivalent to the explicit form of Tn via Netwon’s expansion of
(1 + x)1/2 (p. 33). The OGFs W(z) and T (z) can then also be interpreted as stan-
dard analytic objects, upon assigning to the formal variable z values in the complex
domain C. In effect, the series W(z) and T (z) converge in a neighbourhood of 0
and represent complex functions that are well deﬁned near the origin, namely when
|z| < 1
2 for W(z) and |z| < 1
4 for T (z). The OGF P(z) is a purely formal power
series (its radius of convergence is 0) that can nonetheless be subjected to the usual
algebraic operations of power series. As a matter of fact, with very few exceptions,
permutation enumeration is most conveniently approached by exponential generating
functions developed in Chapter II.
Combinatorial form of GFs. The combinatorial form (5) shows that generating
functions are nothing but a reduced representation of the combinatorial class, where
internal structures are destroyed and elements contributing to size (atoms) are replaced
by the variable z. In a sense, this is analogous to what chemists do by writing linear
reduced formulae for complex molecules (Figure 2). Great use of this observation was
made by Sch¨utzenberger as early as the 1950’s and 1960’s. It explains in many ways
why so many formal similarities are to be found between combinatorial structures and
generating functions.

I. 1. SYMBOLIC ENUMERATION METHODS
21
H =
zzzz
zz
zzz
zzzz
z
zzzz
zzz
+ z4
+ z2
+ z3
+ z4
+ z
+ z4
+ z3
H(z) =
z + z2 + 2z3 + 3z4
FIGURE I.3. A ﬁnite family of graphs and its eventual reduction to a generating function.
Figure 3 provides a combinatorial illustration: start with a (ﬁnite) family of graphs
H, with size taken as the number of vertices. Each vertex in each graph is replaced
by the variable z and the graph structure is “forgotten”; then the monomials corre-
sponding to each graph are formed and the generating function is ﬁnally obtained
by gathering all the monomials. For instance, there are 3 graphs of size 4 in H,
in agreement with the fact that [z4]H(z) = 3. If size had been instead deﬁned by
number of edges, another generating function would have resulted, namely, with y
marking the new size: 1 + y + y2 + 2y3 + y4 + y6. If both number of vertices
and number of edges are of interest, then a bivariate generating function, H(z, y) =
z + z2y + z3y2 + z3y3 + z4y3 + z4y4 + z4y6; such multivariate generating functions
are developed systematically in Chapter III.
A path often taken in the literature is to decompose the structures to be enu-
merated into smaller structures either of the same type or of simpler types, and then
extract from such a decomposition recurrence relations satisﬁed by the {An}. In this
context, the recurrence relations are either solved directly—whenever they are simple
enough—or by means of ad hoc generating functions, introduced as a mere technical
artiﬁce.
By contrast, in the framework to be described, classes of combinatorial structures
are built directly in terms of simpler classes by means of a collection of elementary
combinatorial constructions. (This closely resembles the description of formal lan-
guages by means of grammars, as well as the construction of structured data types in
programming languages.) The approach developed here has been termed symbolic, as
it relies on a formal speciﬁcation language for combinatorial structures. Speciﬁcally,
it is based on so–called admissible constructions that admit direct translations into
generating functions.
Deﬁnition I.5. Assume that Φ is a construction that associates to a ﬁnite collection
of classes B, C, · · · a new class
A := Φ[B, C, . . .],
in a ﬁnitary way: each An depends on ﬁnitely many of the {Bj}, {Cj}, . . .. Then
Φ is admissible iff the counting sequence {An} of A only depends on the counting
sequences {Bj}, {Cj}, . . . of B, C, . . ., and for some operator Ξ on sequences:
{An} = Ξ[{Bj}, {Cj}, . . .].

22
I. UNLABELLED STRUCTURES AND ORDINARY GENERATING FUNCTIONS
In that case, since generating functions are determined by their coefﬁcient se-
quences, there exists a well deﬁned operator Ψ translating Ξ on the associated ordinary
generating functions
A(z) = Ψ[B(z), C(z), . . .].
As an introductory example, take the construction of cartesian product.
Deﬁnition I.6. The cartesian product construction of two classes B and C forms or-
dered pairs,
(8)
A = B × C
iff
A = { α = (β, γ) | β ∈B, γ ∈C },
with the size of a pair α = (β, γ) being deﬁned by
(9)
|α|A = |β|B + |γ|C.
By considering all possibilities, it is immediately seen that the counting sequences
corresponding to A, B, C are related by the convolution relation
(10)
An =
n
X
k=0
BkCn−k.
We recognize here the formula for a product of two power series. Therefore,
(11)
A(z) = B(z) · C(z).
Thus, the cartesian product is admissible: A cartesian product translates as a product
of OGFs.
Similarly, let A, B, C be combinatorial classes satisfying
(12)
A = B ∪C,
with
B ∩C = ∅,
with size deﬁned in a consistent manner: for ω ∈A,
(13)
|ω|A =



|ω|B
if ω ∈B
|ω|C
if ω ∈C.
One has
(14)
An = Bn + Cn,
which, at generating function level, means
(15)
A(z) = B(z) + C(z).
Thus, a union of sets translates as a sum of generating functions provided the sets are
disjoint.
The correspondences provided by (8)–(11) and (12)–(15) are summarized by the
dictionary
(16)



A = B ∪C
=⇒
A(z) = B(z) + C(z)
(provided B ∩C = ∅)
A = B × C
=⇒
A(z) = B(z) · C(z)
(Compare with the plain arithmetic case of (3).) Their merit is that they can be stated
as general-purpose translation rules that only need to be established once and for all.

I. 2. ADMISSIBLE CONSTRUCTIONS AND SPECIFICATIONS
23
As soon as the problem of counting elements of a union of disjoint sets or a cartesian
product is recognized, it becomes possible to dispense altogether with the intermediate
stages of writing explicitly coefﬁcient relations or recurrences like in (10) or (14). This
is the spirit of the symbolic method for combinatorial enumerations. Its interest lies
in the fact that several powerful set-theoretic constructions are amenable to such a
treatment.
I. 2. Admissible constructions and speciﬁcations
The main goal of this section is to introduce formally the basic constructions that
constitute the core of a speciﬁcation language for combinatorial structures. This core
is based on disjoint unions, also known as combinatorial sums, and on Cartesian prod-
ucts that we have just discussed. We shall augment it by the constructions of sequence,
cycle, multiset, and powerset. A class is constructible or speciﬁable if it can be de-
ﬁned from primal elements by means of these constructions. The generating function
of any such class satisﬁes functional equations that can be transcribed systematically
from a speciﬁcation; see Theorems I.1 and I.2, as well as Figure 14 at the end of this
chapter for a summary.
I. 2.1. Basic constructions. First, we assume given a class E called the neutral
class that consists of a single object of size 0; any such object of size 0 is called a
neutral object and is usually denoted by symbols like ǫ or 1. The reason for this
terminology becomes clear if one considers the combinatorial isomorphism
A ∼= E × A ∼= A × E.
We also assume as given an atomic class Z comprising a single element of size 1;
any such element is called an atom; an atom may be used to describe a generic node
in a tree or graph, in which case it may be represented by a circle (• or ◦), but also a
generic letter in a word, in which case it may be instantiated as a, b, c, . . . . Distinct
copies of the neutral or atomic class may also be subscripted by indices in various
ways. Thus, for instance we use the classes Za = {a}, Zb = {b} (with a, b of size 1)
to build up binary words over the alphabet {a, b}, or Z• = {•}, Z◦= {◦} (with •, ◦
taken to be of size 1) to build trees with nodes of two colours. Similarly, we introduce
E2, E1, E2 to denote a class comprising the neutral objects 2, ǫ1, ǫ2 respectively.
Clearly, the generating functions of a neutral class E and an atomic class Z are
E(z) = 1,
Z(z) = z,
corresponding to the unit 1, and the variable z, of generating functions.
Combinatorial sum (disjoint union). First consider combinatorial sum also known
as disjoint union. The intent is to capture the union of disjoint sets, but without the
constraint of any extraneous condition of disjointness. We formalize the (combina-
torial) sum of two classes B and C as the union (in the standard set–theoretic sense)
of two disjoint copies, say B2 and C3, of B and C. A picturesque way to view the
construction is as follows: ﬁrst choose two distinct colours and repaint the elements of
B with the 2-colour and the elements of C with the 3-colour. This is made precise by

24
I. UNLABELLED STRUCTURES AND ORDINARY GENERATING FUNCTIONS
introducing two distinct “markers” 2 and 3, each a neutral object (i.e., of size zero);
the disjoint union B + C of B, C is then deﬁned as the standard set-theoretic union,
B + C := ({2} × B) ∪({3} × C) .
The size of an object in a disjoint union A = B + C is by deﬁnition inherited from its
size in its class of origin, like in Equation (13). One good reason behind the deﬁni-
tion adopted here is that the combinatorial sum of two classes is always well-deﬁned.
Furthermore, disjoint union is equivalent to a standard union whenever it is applied to
disjoint sets.
Because of disjointness, one has the implication
A = B + C
=⇒
An = Bn + Cn
=⇒
A(z) = B(z) + C(z),
so that disjoint union is admissible. Note that, in contrast, standard set-theoretic union
is not an admissible construction since
card(Bn ∪Cn) = card(Bn) + card(Cn) −card(Bn ∩Cn),
and information on the internal structure of B and C (i.e., the nature of this intersec-
tion) is needed in order to be able to enumerate the elements of their union.
Cartesian product. This construction A = B×C forms all possible ordered pairs
in accordance with Deﬁnition I.6. The size of a pair is obtained additively from the
size of components in accordance with (9).
Next, we introduce a few fundamental constructions that build upon set-theoretic
union and product, and form sequences, sets, and cycles. These powerful construc-
tions sufﬁce to deﬁne a broad variety of combinatorial structures.
Sequence construction. If C is a class then the sequence class SEQ(C) is deﬁned
as the inﬁnite sum
SEQ(C) = {ǫ} + C + (C × C) + (C × C × C) + · · ·
with ǫ being a neutral structure (of size 0). (The neutral structure in this context
plays a rˆole similar to that of the “empty” word in formal language theory, while
the sequence construction is somewhat analogous to the Kleene star operation (‘⋆’);
see APPENDIX A: Regular languages, p. 678.) It is then readily checked that the
construction A = SEQ(C) deﬁnes a proper class satisfying the ﬁniteness condition for
sizes if and only if C contains no object of size 0. From the deﬁnition of size for sums
and products, there results that the size of a sequence is to be taken as the sum of the
sizes of its components:
γ = (α1, . . . , αℓ)
=⇒
|γ| = |α1| + · · · + |αℓ|.
Cycle construction. Sequences taken up to a circular shift of their components
deﬁne cycles, the notation being CYC(B). Precisely, one has
CYC(B) := SEQ(B)/S,
where S is the equivalence relation between sequences deﬁned by
(α1, . . . , αr) S (β1, . . . , βr)
iff there exists some circular shift τ of [1 . . r] such that for all j, βj = ατ(j); in other
words, for some d, one has βj = α1+(j+d) mod r. Here is for instance a depiction of

I. 2. ADMISSIBLE CONSTRUCTIONS AND SPECIFICATIONS
25
the cycles formed from the 8 and 16 sequences of lengths 3 and 4 over two types of
objects (a, b): the number of cycles is 4 (for n = 3) and 6 (for n = 4). Sequences are
grouped into equivalence classes according to the relation S.
(17)
aaa
aab aba baa
abb bba bab
bbb
aaaa
aaab aaba abaa baaa
aabb abba bbaa baab
abab baba
abbb bbba bbab babb
bbbb
According to the deﬁnition, this construction corresponds to the formation of directed
cycles. We make only a limited use of it for unlabelled objects; however, its counter-
part plays a rather important rˆole in the context of labelled structures and exponential
generating functions.
Multiset construction. Following common mathematical terminology, multisets
are like ﬁnite sets (that is the order between element does not count), but arbitrary
repetitions of elements are allowed. The notation is A = MSET(B) when A is ob-
tained by forming all ﬁnite multisets of elements from B. The precise way of deﬁning
MSET(B) is as a quotient:
MSET(B) := SEQ(B)/R
with
R,
the equivalence relation of sequences being deﬁned by (α1, . . . , αr) R (β1, . . . , βr)
iff there exists some arbitrary permutation σ of [1 . . r] such that for all j, βj = ασ(j).
Powerset construction. The powerset class (or set class) A = PSET(B) is de-
ﬁned as the class consisting of all ﬁnite subsets of class B, or equivalently, as the class
PSET(B) ⊂MSET(B) formed of multisets that involve no repetitions.
We again need to make explicit the way the size function is deﬁned when such
constructions are performed: like for products and sequences, the size of a composite
object—set, multiset, or cycle—is deﬁned as the sum of the sizes of its components.
 I.3. The semi-ring of combinatorial classes. Under the convention of identifying isomor-
phic classes, sum and product acquire pleasant algebraic properties: combinatorial sums and
cartesian products become commutative and associative operations, e.g.,
(A + B) + C = A + (B + C),
A × (B × C) = (A × B) × C,
while distributivity holds, (A+B)×C = (A×C)+(B×C). The proofs are simple veriﬁcations
from the deﬁnitions.

 I.4. Natural numbers. Let Z := {•} with • an atom (of size 1). Then I = SEQ(Z) \
{ǫ} is a way of describing natural integers in unary notation: I = {•, • •, •••, . . .}. The
corresponding OGF is I(z) = z/(1 −z) = z + z2 + z3 + · · · .

 I.5. Interval coverings.
Let Z := {•} be as before. Then A = Z + (Z × Z) is a set of
two elements, • and (•, •), which we choose to draw as {•, •–•}. Then C = SEQ(A) contains
elements like
•, • •, •–•, • •–•, •–• •, •–• •–•, • • • • .
With the notion of size adopted, the objects of size n in C = SEQ(Z + (Z × Z)) are (isomor-
phic to) the coverings of the interval [0, n] by intervals (matches) of length either 1 or 2. The
generating function,
C(z) = 1 + z + 2 z2 + 3 z3 + 5 z4 + 8 z5 + 13 z6 + 21 z7 + 34 z8 + 55 z9 + · · · ,
is, as we shall see shortly (p. 40), the OGF of Fibonacci numbers.


26
I. UNLABELLED STRUCTURES AND ORDINARY GENERATING FUNCTIONS
I. 2.2. The admissibility theorem for ordinary generating functions. This sec-
tion is a formal treatment of admissibility proofs for the constructions we have consid-
ered. The ﬁnal implication is that any speciﬁcation of a constructible class translates
directly into generating function equations. The cycle construction involves the Eu-
ler totient function ϕ(k) deﬁned as the number of integers in [1, k] that are relatively
prime to k (APPENDIX A: Arithmetical functions, p. 667).
Theorem I.1 (Admissible unlabelled constructions). The constructions of union, carte-
sian product, sequence, multiset, powerset, and cycle are all admissible. The associ-
ated operators are
Sum:
A = B + C
=⇒
A(z) = B(z) + C(z)
Product:
A = B × C
=⇒
A(z) = B(z) · C(z)
Sequence:
A = SEQ(B)
=⇒
A(z) =
1
1 −B(z)
Cycle:
A = CYC(B)
=⇒
A(z) =
∞
X
k=1
ϕ(k)
k
log
1
1 −B(zk).
Multiset:
A = MSET(B)
=⇒
A(z) =









Y
n≥1
(1 −zn)−Bn
exp
 ∞
X
k=1
1
k B(zk)

Powerset:
A = PSET(B)
=⇒
A(z) =









Y
n≥1
(1 + zn)Bn
exp
 ∞
X
k=1
(−1)k−1
k
B(zk)

The sequence, cycle, and set translations necessitate that B0 = ∅.
The class E = {ǫ} consisting of the neutral object only, and the class Z consisting of
a single “atomic” object (node, letter) of size 1 have OGFs
E(z) = 1
and
Z(z) = z.
PROOF. The proof proceeds by cases, building upon what we have just seen regarding
unions and products.
Combinatorial sum (disjoint union). Let A = B+C. Since the union is disjoint,
and the size of an A–element coincides with its size in B or C, one has An = Bn +Cn
and A(z) = B(z) + C(z), as discussed earlier. The rule also follows directly from
the combinatorial form of generating functions as expressed by (5):
A(z) =
X
α∈A
z|α| =
X
α∈B
z|α| +
X
α∈C
z|α| = B(z) + C(z).
Cartesian Product. The admissibility result for A = B × C was considered as
an example for Deﬁnition I.6, the convolution equation (10) leading to the relation
A(z) = B(z)·C(z). We can offer a direct derivation based on the combinatorial form

I. 2. ADMISSIBLE CONSTRUCTIONS AND SPECIFICATIONS
27
of generating functions (5),
A(z) =
X
α∈A
z|α| =
X
(β,γ)∈(B×C)
z|β|+|γ| =

X
β∈B
z|β|

×

X
γ∈C
z|γ|

= B(z)·C(z),
as follows from distributing products over sums. This derivation readily extends to an
arbitrary number of factors.
Sequence construction. Admissibility for A = SEQ(B) (with B0 = ∅) follows
from the union and product relations. One has
A = {ǫ} + B + (B × B) + (B × B × B) + · · · ,
so that
A(z) = 1 + B(z) + B(z)2 + B(z)3 + · · · =
1
1 −B(z),
where the geometric sum converges in the sense of formal power series since [z0]B(z) =
0, by assumption.
Powerset construction. Let A = PSET(B) and ﬁrst take B to be ﬁnite. Then, the
class A of all the ﬁnite subsets of B is isomorphic to a product,
PSET(B) ∼=
Y
β∈B
({ǫ} + {β})
with ǫ a neutral structure of size 0. Indeed, distributing the products in all possible
ways forms all the possible combinations, i.e., sets, of elements of B with no repetition
allowed, by reasoning similar to what leads to such an identity as
(1 + a)(1 + b)(1 + c) = 1 + [a + b + c] + [ab + bc + ac] + abc,
where all combinations of variables appear. Then, directly from the combinatorial
form of generating functions and the sum and product rules, we ﬁnd
A(z) =
Y
β∈B
(1 + z|β|) =
Y
n
(1 + zn)Bn.
The exp-log transformation A(z) = exp(log A(z)) then yields
(18)
A(z)
=
exp
 ∞
X
n=1
Bn log(1 + zn)

=
exp
 ∞
X
n=1
Bn ·
∞
X
k=1
(−1)k−1 znk
k

=
exp
B(z)
1
−B(z2)
2
+ B(z3)
3
−· · ·

,
where the second line results from expanding the logarithm,
log(1 + u) = u
1 −u2
2 + u3
3 −· · · ,
and the third line results from exchanging the order of summation.
The proof ﬁnally extends to the case of B being inﬁnite by noting that each An
depends only on those Bj for which j ≤n, to which the relations given above for

28
I. UNLABELLED STRUCTURES AND ORDINARY GENERATING FUNCTIONS
the ﬁnite case apply. Precisely, let B(≤m) = Pm
k=1 Bj and A(≤m) = PSET(B(≤m)).
Then, with O(zm+1) denoting any series that has no term of degree ≤m, one has
A(z) = A(≤m)(z) + O(zm+1)
and
B(z) = B(≤m)(z) + O(zm+1).
On the other hand, A(≤m)(z) and B(≤m)(z) are connected by the fundamental expo-
nential relation (18) , since B(≤m) is ﬁnite. Letting m tend to inﬁnity, there follows in
the limit
A(z) = exp
B(z)
1
−B(z2)
2
+ B(z3)
3
−· · ·

.
(See APPENDIX A: Formal power series, p. 676 for the deﬁnition of formal conver-
gence.)
Multiset construction. First for ﬁnite B (with B0 = ∅), the multiset class A =
MSET(B) is deﬁnable by
MSET(B) ∼=
Y
β∈B
SEQ({β}).
In words, any multiset can be sorted, in which case it can be viewed as formed of a
sequence of repeated elements β1, followed by a sequence of repeated elements β2,
where β1, β2, . . . is a canonical listing of the elements of B. The relation translates
into generating functions by the product and sequence rules,
A(z)
=
Y
β∈B
(1 −z|β|)−1 =
∞
Y
n=1
(1 −zn)−Bn
=
exp
 ∞
X
n=1
Bn log(1 −zn)−1

=
exp
B(z)
1
+ B(z2)
2
+ B(z3)
3
+ · · ·

,
where the exponential form results from the exp-log transformation. The case of an
inﬁnite class B follows by a continuity argument analogous the one used for powersets.
Cycle construction. The translation of the cycle relation A = CYC(B) turns out
to be
A(z) =
∞
X
k=1
ϕ(k)
k
log
1
1 −B(zk),
where ϕ(k) is the Euler totient function. The ﬁrst terms, with Lk(z) := log(1 −
B(zk))−1 are
A(z) = 1
1L1(z) + 1
2L2(z) + 2
3L3(z) + 2
4L4(z) + 4
5L5(z) + 2
6L6(z) + · · · .
We defer the proof to APPENDIX A: Cycle construction, p. 674, since it relies in part
on multivariate generating functions to be ofﬁcially introduced in Chapter III.
□
The results for sets, multisets, and cycles are particular cases of the well known
P´olya theory that deals more generally with the enumeration of objects under group
symmetry actions [395, 397]. This theory is exposed in many textbooks, see for in-
stance [98, 259]. The approach adopted here consists in considering simultaneously
all possible values of the number of components by means of bivariate generating

I. 2. ADMISSIBLE CONSTRUCTIONS AND SPECIFICATIONS
29
functions. Powerful generalizations within the theory of species are presented in the
book by Bergeron, Labelle, and Leroux [39].
 I.6. Vall´ee’s identity. Let M = MSET(C), P = PSET(C). Separating elements of C
according to the parity of the number of times they appear in a multiset gives rise to the identity
M(z) = P(z)M(z2).
(Hint: a multiset contains elements of either odd or even multiplicity.) Accordingly, one can
deduce the translation of powersets from the formula for multisets. Iterating the relation above
yields M(z) = P(z)P(z2)P(z4)P(z8) · · · , that is closely related to the binary representation
of numbers and to Euler’s identity (p. 46). It is used for instance in Note 56 p. 83.

Restricted constructions. In order to increase the descriptive power of the frame-
work of constructions, we also want to allow restrictions on the number of components
in sequences, sets, multisets, and cycles. Let K be a metasymbol representing any of
SEQ, CYC, MSET, PSET and let Ωbe a predicate over the integers, then KΩ(A) will
represent the class of objects constructed by K but with a number of components con-
strained to satisfy Ω. Then, the notations
SEQ=k (or simply SEQk), SEQ>k, SEQ1 . . k
refer to sequences whose number of components are exactly k, larger than k, or in the
interval 1 . . k respectively and the same holds for other constructions. In particular,
SEQk(B) :=
k times
z
}|
{
B × · · · × B ≡Bk,
SEQ≥k(B) =
X
j≥k
Bj ∼= Bk × SEQ(B),
MSETk(B) := SEQk(B)/R.
Similarly, SEQodd, SEQeven will denote sequences with an odd or even number of
components, and so on.
Translations for such restricted constructions are available, as shown generally in
Subsection I. 6.1. Sufﬁce it to note for the moment that the construction A = SEQk(B)
is really an abbreviation for a k-fold product, hence it admits the translation into OGFs
(19)
A = SEQk(B)
=⇒
A(z) = B(z)k.
I. 2.3. Constructibility and combinatorial speciﬁcations. By composing basic
constructions, we can build compact descriptions (speciﬁcations) of a broad variety of
combinatorial classes. Since we restrict attention to admissible constructions, we can
immediately derive OGFs for these classes. Put differently, the task of enumerating a
combinatorial class is reduced to programming a speciﬁcation for it in the language of
admissible constructions. In this subsection, we ﬁrst discuss the expressive power of
the language of constructions, then summarize the symbolic method (for unlabelled
classes and OGFs) by Theorem I.2.
First, in the framework just introduced, the class of all binary words is described
by
W = SEQ(A)
where
A = {a, b} ∼= Z + Z,
the ground alphabet, comprises two elements (letters) of size 1. The size of a binary
word then coincides with its length (the number of letters it contains). In other words,
we start from basic atomic elements and build up words by forming freely all the

30
I. UNLABELLED STRUCTURES AND ORDINARY GENERATING FUNCTIONS
objects determined by the sequence construction. Such a combinatorial description of
a class that only involves a composition of basic constructions applied to initial classes
E, Z is said to be an iterative (or nonrecursive) speciﬁcation. Other examples already
encountered include binary necklaces (Note 1, p. 18) and the natural integers (Note 4,
p. 25) respectively deﬁned by
N = CYC(Z + Z)
and
I = SEQ≥1(Z).
From there, one can construct ever more complicated objects. For instance,
P = MSET(I) ≡MSET(SEQ≥1(Z))
means the class of multisets of natural integers, which is isomorphic to the class of
integer partitions (see Section I. 3 below for a detailed discussion). As such examples
demonstrate, a speciﬁcation that is iterative can be represented as a single term built on
E, Z and the constructions +, ×, SEQ, CYC, MSET, PSET. An iterative speciﬁcation
can be equivalently listed by naming some of the subterms (for instance partitions in
terms of natural integers themselves deﬁned as sequences of atoms).
Semantics of recursion. We next turn our attention to recursive speciﬁcations,
starting with trees (cf also APPENDIX A: Tree concepts, p. 681 for basic deﬁnitions).
In graph theory, a tree is classically deﬁned as an undirected graph that is connected
and acyclic. Additionally, a tree is rooted if a particular vertex is distinguished to be
the root. Computer scientists commonly make use of trees called plane that are rooted
but also embedded in the plane, so that the ordering of subtrees attached to any node
matters. Here, we will give the name of general plane trees to such rooted plane trees
and call G their class, where size is the number of vertices; see, e.g., [434]. (The term
“general” refers to the fact that all nodes degrees are allowed.) For instance, a general
tree of size 16, drawn with the root on top, is:
τ =
As a consequence of the deﬁnition, if one interchanges, say, the second and third
root subtrees, then a different tree results—the original tree and its variant are not
equivalent under a smooth dformation of the plane. (General trees are thus comparable
to graphical renderings of genealogies where children are ordered by age.). Although
we have introduced plane trees as 2-dimensional diagrams, it is obvious that any tree
also admits a linear representation: a tree τ with root ζ and root subtrees τ1, . . . , τr
(in that order) can be seen as the object ζ τ1, . . . , τr , where the box encloses similar
representations of subtrees. Typographically, a box · may be reduced to a matching
pair of parentheses, ‘(·)’, and one gets in this way a linear description that illustrates
the correspondence between trees viewed as plane diagrams and functional terms of
mathematical logic and computer science.
Trees are best described recursively. A tree is a root to which is attached a (possi-
bly empty) sequence of trees. In other words, the class G of general trees is deﬁnable

I. 2. ADMISSIBLE CONSTRUCTIONS AND SPECIFICATIONS
31
by the recursive equation
(20)
G = Z × SEQ(G),
where Z comprises a single atom written “•” and denoting a generic node.
Although such recursive deﬁnitions are familiar to computer scientists, the speci-
ﬁcation (20) may look dangerously circular to some. One way of making good sense
of it is via an adaptation of the numerical technique of iteration. Start with G[0] = ∅,
the empty set, and deﬁne successively the classes
G[j+1] = Z × SEQ(G[j]).
For instance, G[1] = Z × SEQ(∅) = {(•, ǫ)} ∼= {•} describes the tree of size 1, and
G[2]
=

• , • • , • • • , • • • • , . . .
	
G[3]
=

• , • • , • • • , • • • • , . . . ,
• • •
, • • • •
, • • • • , • • • •
• •
, . . .

.
First, each G[j] is well-deﬁned since it corresponds to a purely iterative speciﬁcation.
Next, we have the inclusion G[j] ⊂G[j+1], (G[j] admits of a simple interpretation as
the class of all trees of height < j). We can therefore regard the complete class G as
deﬁned by the limit of the G[j], that is, G := S
j G[j].
 I.7. Limes superior of classes. Let {A[j]} be any increasing sequence of combinatorial
classes, in the sense that A[j] ⊂A[j+1], and the notions of size are compatible. If A[∞] =
S
j A[j] is a combinatorial class (i.e., there are ﬁnitely many elements of size n, for each n),
then the corresponding OGFs satisfy A[∞](z) = limj→∞A[j](z) in the formal topology (AP-
PENDIX A: Formal power series, p. 676).

Deﬁnition I.7. A speciﬁcation for an r–tuple ⃗A = (A(1), . . . , A(r)) of classes is a
collection of r equations,
(21)





A(1)
=
Ξ1(A(1), . . . , A(r))
A(2)
=
Ξ2(A(1), . . . , A(r))
· · ·
A(r)
=
Ξr(A(1), . . . , A(r))
where each Ξi denotes a term built from the A’s using the constructions of disjoint
union, cartesian product, sequence, set, multiset, and cycle, as well as the initial
classes E (neutral) and Z (atomic).
We also say that the system is a speciﬁcation of A(1). A speciﬁcation for a class of
combinatorial structures is thus a sort of formal grammar deﬁning that class. Formally,
the system (21) is an iterative speciﬁcation if it is strictly upper-triangular, that is,
A(r) is deﬁned solely in terms of initial classes Z, E; the deﬁnition of A(r−1) only
involves A(r), and so on; in that case, by back substitutions, it is apparent that for an
iterative speciﬁcation, A(1) can be equivalently described by a single term involving
only the initial classes and the basic constructors. Otherwise, the system is said to
be recursive. In the latter case, the semantics of recursion is identical to the one

32
I. UNLABELLED STRUCTURES AND ORDINARY GENERATING FUNCTIONS
introduced in the case of trees: start with the “empty” vector of classes, ⃗A[0] :=
(∅, . . . , ∅), iterate ⃗A[j+1] = ⃗Ξ
 ⃗A[j]
, and ﬁnally take the limit.
Deﬁnition I.8. A class of combinatorial structures is said to be constructible or speci-
ﬁable iff it admits a (possibly recursive) speciﬁcation in terms of sum, product, se-
quence, set, multiset, and cycle constructions.
At this stage, we have therefore deﬁned a speciﬁcation language for combina-
torial structures which is some fragment of set theory with recursion added. Each
constructible class has by virtue of Theorem I.1 an ordinary generating function for
which deﬁning equations can be produced systematically. In fact, it is even possible
to use computer algebra systems in order to compute it automatically! See the article
of Flajolet, Salvy, and Zimmermann [206] for the description of such a system.
Theorem I.2 (Symbolic method, unlabelled case). The generating function of a con-
structible class is a component of a system of generating function equations whose
terms are built from
1, z, + , × , Q , Exp , Exp , Log,
where











Q[f]
=
1
1 −f ,
Log[f]
=
∞
X
k=1
ϕ(k)
k
log
1
1 −f(zk),
Exp
=
exp
 ∞
X
k=1
f(zk)
k
!
,
Exp[f]
=
exp
 ∞
X
k=1
(−1)k−1 f(zk)
k
!
.
P´olya operators. The operator Q translating sequences (SEQ) is classically known
as the quasi-inverse. The operator Exp (multisets, MSET) is called the P´olya exponen-
tial2 and Exp (powersets, PSET) is the modiﬁed P´olya exponential. The operator Log
is the P´olya logarithm. They are named after P´olya who ﬁrst developed the general
enumerative theory of objects under permutation groups [39, 395, 397].
The statement of Theorem I.2 signiﬁes that iterative classes have explicit generat-
ing functions involving compositions of the basic operators only, while recursive struc-
tures have OGFs that are accessible indirectly via systems of functional equations. As
we see at various places in this chapter, the following classes are constructible: binary
words, binary trees, general trees, integer partitions, integer compositions, nonplane
trees, polynomials over ﬁnite ﬁelds, necklaces, and wheels. We conclude this section
with a few examples.
Binary words. The OGF of binary words, as seen already, can be obtained di-
rectly from the iterative speciﬁcation,
W = SEQ(Z + Z)
=⇒
W(z) =
1
1 −2z ,
whence the expected result, Wn = 2n.
2It is a notable fact that, though the P´olya operators look algebraically “difﬁcult” to compute with,
their treatment by complex asymptotic methods, as regards coefﬁcient asymptotics, is comparatively “easy”.
We shall see many examples in Chapters IV–VII (e.g., pp. 239, 453).

I. 2. ADMISSIBLE CONSTRUCTIONS AND SPECIFICATIONS
33
General trees. The recursive speciﬁcation of general trees leads to an implicit
deﬁnition of their OGF,
G = Z × SEQ(G)
=⇒
G(z) =
z
1 −G(z).
From this point on, basic algebra does the rest. First the original equation is equivalent
(in the ring of formal power series) to G −G2 −z = 0. Next, the quadratic equation
is solvable by radicals, and one ﬁnds
G(z)
=
1
2
 1 −√1 −4z

=
z + z2 + 2 z3 + 5 z4 + 14 z5 + 42 z6 + 132 z7 + 429 z8 + · · ·
=
X
n≥1
1
n
2n −2
n −1

zn.
(The conjugate root is to be discarded since it involves a term z−1 as well as negative
coefﬁcients.) The expansion then results from Newton’s binomial expansion,
(1 + x)α = 1 + α
1 x + α(α −1)
2!
x2 + · · · ,
applied with α = 1
2 and x = −4z.
The numbers
(22)
Cn =
1
n + 1
2n
n

=
(2n)!
(n + 1)! n!
with OGF
C(z) = 1 −√1 −4z
2z
are known as the Catalan numbers (EIS A000108) in the honour of Eug`ene Catalan
(1814-1894), a French and Belgian mathematician who developed many of their prop-
erties. These numbers are so common in combinatorics that we have decided to use
a roman font for denoting them (like “log”, “sin”, and so on). In summary, general
trees are enumerated by Catalan numbers:
Gn = Cn−1 ≡1
n
2n −2
n −1

.
For this reason the term Catalan tree is often employed as synonymous to “general
(rooted unlabelled plane) tree”.
Triangulations. Fix n + 2 points arranged in anticlockwise order on a circle and
conventionally numbered from 0 to n + 1 (for instance the n + 2nd roots of unity). A
triangulation is deﬁned as a maximal decomposition of the convex n + 2-gon deﬁned
by the points into n triangles. Triangulations are taken here as abstract topological
conﬁgurations deﬁned up to continuous deformations of the plane. The size of the
triangulation is the number of triangles, that is, n. Given a triangulation, we deﬁne
its “root” as a triangle chosen in some conventional and unambiguous manner (e.g., at
the start, the triangle that contains the two smallest labels). Then, a triangulation de-
composes into its root triangle and two subtriangulations (that may well be “empty”)

34
I. UNLABELLED STRUCTURES AND ORDINARY GENERATING FUNCTIONS
appearing on the left and right sides of the root triangle; the decomposition is illus-
trated by the following diagram:
= 
+
The class T of all triangulations can be speciﬁed recursively as
T
=
{ǫ}
+
(T × ∇× T ) ,
provided that we consider a 2-gon (a diameter) as giving rise to an empty triangulation.
Consequently, the OGF satisﬁes the equation T = 1 + zT 2 and
T (z) = 1
2z
 1 −
√
1 −4z

.
As a result, triangulations are enumerated by Catalan numbers:
Tn = Cn ≡
1
n + 1
2n
n

.
This particular result goes back to Euler and Segner (1753), a century before Catalan;
see Figure 1 for ﬁrst values and p. 69 for related bijections.
 I.8. A bijection. Since both general trees and triangulations are enumerated by Catalan
numbers, there must exist a size-preserving bijection between the two classes. Find one such
bijection. [Hint: the construction of triangulations is evocative of binary trees, and binary trees
are themselves in bijective correspondence with general trees; see APPENDIX A: Tree concepts,
p. 681.]

 I.9. A variant speciﬁcation of triangulations. Consider the class U of “nonempty” triangula-
tions of the n-gon, that is, we exclude the 2-gon and the corresponding “empty” triangulation
of size 0. Then, U = T \ {ǫ} admits the speciﬁcation
U = ∇+ (∇× U) + (U × ∇) + (U × ∇× U)
which also leads to the Catalan numbers via U = z(1 + U)2 and U(z) = (1 −2z −
√1 −4z)/(2z), so that U(z) = T(z) −1.

I. 2.4. Exploiting generating functions and counting sequences. In this book
we are going to see altogether more than a hundred applications of the symbolic
method. Before engaging in technical developments, it is worth inserting a few com-
ments on the way generating functions and counting sequences can be put to good use
in order to solve combinatorial problems.

I. 2. ADMISSIBLE CONSTRUCTIONS AND SPECIFICATIONS
35
Explicit enumeration formulae. In a number of situations, generating functions
are explicit and can be expanded in such a way that explicit formulae result for their
coefﬁcients. A prime example is the counting of general trees and of triangulations
above, where the quadratic equation satisﬁed by an OGF is amenable to an explicit
solution—the resulting OGF could then be expanded by means of Newton’s binomial
theorem. Similarly, we derive later in this Chapter an explicit form for the number of
integer compositions by means of the symbolic method and OGFs (the answer turns
out to be simply 2n−1) and derive many explicit specializations. In this book, we
assume as known the elementary techniques from basic calculus by which the Taylor
expansion of an explicitly given function can be obtained. (Good references on such
elementary aspects are Wilf’s Generatingfunctionology [496], Graham, Knuth, and
Patashnik’s Concrete Mathematics [248], and our book [434].)
Implicit enumeration formulae. In a number of cases, the generating functions
obtained by the symbolic method are still in a sense explicit, but their form is such that
their coefﬁcients are not clearly reducible to a closed form. It is then still possible to
obtain initial values of the corresponding counting sequence by means of a symbolic
manipulation system. Also, from generating functions, it is possible to derive system-
atically recurrences3 that lead to a procedure for computing an arbitrary number of
terms of the counting sequence in a reasonably efﬁcient manner. A typical example of
this situation is the OGF of integer partitions,
P(z) =
∞
Y
m=1
1
1 −zm ,
for which recurrences obtained from the OGF and associated to fast algorithms are
given in Note 12 (p. 40) and Note 17 (p. 46).
Asymptotic formulae. Such forms are our eventual goal as they allow for an easy
interpretation and comparison of counting sequences. From a quick glance at the
table of initial values of Wn, Pn, Tn given in Eq. (2), it is apparent that Wn grows
more slowly than Tn, which itself grows more slowly than Pn. The classiﬁcation
of growth rates of counting sequences belongs properly to the asymptotic theory of
combinatorial structures which neatly relates to the symbolic method via complex
analysis. A thorough treatment of this part of the theory is presented in Chapters IV–
VIII. Given the methods exposed there, it becomes possible to estimate asymptotically
the coefﬁcients of virtually any generating function, however complicated4, that is
provided by the symbolic method.
Here, we content ourselves with a few remarks based on elementary real analysis.
(The basic notations are described in APPENDIX A: Asymptotic Notation, p. 668.)
The sequence Wn = 2n grows exponentially and, in such an extreme simple case, the
exact form coincides with the asymptotic form. The sequence Pn = n! must grow at a
faster asymptotic regime. But how fast? The answer is provided by Stirling’s formula,
3See [206, 216, 373] for such systematic approaches.
4In a number of cases, asymptotic analysis even applies to situations where the generating function
itself is not even explicit, but only accessible through a functional equation of sorts.

36
I. UNLABELLED STRUCTURES AND ORDINARY GENERATING FUNCTIONS
30
 
50
10
20
40
10
0
50
40
30
20
60
0
FIGURE
I.4. The
growth
regimes
of
three
sequences
f(n) = 2n, Tn, n! (from bottom
to top) rendered by a plot of
log10 f(n) versus n.
an approximation to the factorial numbers due to the Scottish mathematician James
Stirling (1692–1770):
(23)
n! =
n
e
n √
2πn

1 + O( 1
n)

(n →+∞).
The ratios of the exact values to Stirling’s approximations
n:
1
2
5
10
100
1,000
n!
nne−n√
2πn
:
1.084437
1.042207
1.016783
1.008365
1.000833
1.000083
show an excellent quality of the asymptotic estimate: the error is only 8% for n = 1,
less than 1% for n = 10, and less than 1 per thousand for any n greater than 100.
Stirling’s formula in turn gives access to the asymptotic form of the Catalan num-
bers, by means of a simple calculation:
Cn =
1
n + 1
(2n)!
(n!)2 ∼1
n
(2n)2ne−2n√
4πn
n2ne−2n2πn
,
which simpliﬁes to
(24)
Cn ∼
4n
√
πn3 .
Thus, the growth of Catalan numbers is roughly comparable to an exponential, 4n,
modulated by a subexponential factor, here 1/
√
πn3. A surprising consequence of this
asymptotic estimate to the area of boolean function complexity appears in Example 16
below.
Altogether, the asymptotic number of general trees and triangulations is well sum-
marized by a simple formula. Approximations become more and more accurate as n
becomes large. Figure 4 illustrates the different growth regimes of our three reference
sequences while Figure 5 exempliﬁes the quality of the approximation with subtler
phenomena also apparent on the ﬁgures and well explained by asymptotic theory.
Such asymptotic formulae then make comparison between the growth rates of se-
quences easy.

I. 3. INTEGER COMPOSITIONS AND PARTITIONS
37
n
Cn
C⋆
n
C⋆
n/Cn
1
1
2.25
2.25675 83341 91025 14779 23178
10
16796
18707.89
1.11383 05127 52445˙89437 89064
100
0.89651 · 1057
0.90661 · 1057
1.01126 32841 24540 52257 13957
1000
0.20461 · 10598
0.20484 · 10598
1.00112 51328 1542 41647 01282
10000
0.22453 · 106015
0.22456 · 106015
1.00011 25013 28127 92913 51406
100000
0.17805 · 1060199
0.17805 · 1060199
1.00001 12500 13281 25292 96322
1000000
0.55303 · 10602051
0.55303 · 10602051
1.00000 11250 00132 81250 29296
FIGURE I.5. The Catalan numbers Cn, their Stirling approximation C⋆
n = 4n/
√
πn3,
and the ratio C⋆
n / Cn.
 I.10. The complexity of coding. A company specialized in computer aided design has sold
to you a scheme that (they claim) can encode any triangulation of size n ≥100 using at most
1.5n bits of storage. After reading these pages, what do you do? [Hint: sue them!] See also
Note 22 for related coding arguments.

 I.11. Experimental asymptotics. From the data of Figure 5, guess the value of C⋆
107 / C107
and of C⋆
5·106 / C5·106 to 25D. (See, e.g., [313] for related asymptotic expansions and [64] for
similar properties.)

The interplay between combinatorial structure and asymptotic structure is indeed
the principal theme of this book. We shall see that a vast majority of the generating
functions provided by the symbolic method, however complicated, eventually lead to
similarly simple asymptotic estimates.
I. 3. Integer compositions and partitions
This section and the next ones provide examples of counting via speciﬁcations in
classical combinatorial domains. They illustrate the beneﬁts of the symbolic method:
generating functions are obtained with hardly any computation, and at the same time,
many counting reﬁnements follow from a basic combinatorial construction. The most
direct applications described here relate to the additive decomposition of integers
into summands with the classical combinatorial-arithmetic structures of partitions and
compositions. The speciﬁcations are iterative and simply combine two levels of con-
structions of type SEQ, MSET, CYC, PSET.
I. 3.1. Compositions and partitions. Our ﬁrst examples have to do with decom-
posing integers into sums.
Deﬁnition I.9. A composition of an integer n is a sequence (x1, x2, . . . , xk) of inte-
gers (for some k) such that
n = x1 + x2 + · · · + xk,
xj ≥1.
A partition of an integer n is a sequence (x1, x2, . . . , xk) of integers (for some k) such
that
n = x1 + x2 + · · · + xk
and
x1 ≥x2 ≥· · · ≥xk.

38
I. UNLABELLED STRUCTURES AND ORDINARY GENERATING FUNCTIONS
FIGURE I.6. Graphical representations of compositions and partitions: (left) the com-
position 1 + 3 + 1 + 4 + 2 + 3 = 14 with its “ragged-landscape” and “balls-and-bars”
models; (right) the partition 8 + 8 + 6 + 5 + 4 + 4 + 4 + 2 + 1 + 1 = 43 with its staircase
(Ferrers diagram) model.
In both cases, the xi’s are called the summands or the parts and the quantity n is
called the size of the composition or the partition.
By representing summands in unary using small discs (“•”), we can render graph-
ically a composition by drawing bars between some of the balls; if we arrange sum-
mands vertically, compositions appear as ragged-landscapes. In contrast, partitions
appear as staircases, also known as Ferrers diagrams [98, p. 100]; see Figure 6. We
let C and P denote the class of pacement all compositions and all partitions. Since a
set can always be presented in sorted order, the difference between compositions and
partitions lies in the fact that the order of summands does or does not matter. This is
reﬂected by the use of a sequence construction (for C) against a multiset construction
(for P). In this perspective, it proves convenient to regard 0 as obtained by the empty
sequence of summands (k = 0), and we shall do so from now on.
First, let I = {1, 2, . . .} denote the combinatorial class of all integers at least 1
(the summands), and let the size of each integer be its value. Then, the OGF of I is,
as we know,
(25)
I(z) =
X
n≥1
zn =
z
1 −z ,
since In = 1 for n ≥1, corresponding to the fact that there is exactly one object in I
for each size n ≥1. If integers are represented in unary, say by small balls, one has,
(26)
I = {1, 2, 3, . . .} = {•, • •, • • •, . . .} ∼= SEQ≥1{•},
which is another way to view the equality I(z) = z/(1 −z).
Compositions. First, the speciﬁcation of compositions as sequences admits, by
Theorem I.1, a direct translation into OGF:
(27)
C = SEQ(I)
=⇒
C(z) =
1
1 −I(z).
The collection of equations (25), (27) thus fully determines C(z):
C(z)
=
1
1 −
z
1−z
= 1 −z
1 −2z
=
1 + z + 2z2 + 4z3 + 8z4 + 16z5 + 32z6 + · · · .

I. 3. INTEGER COMPOSITIONS AND PARTITIONS
39
0
1
1
10
512
42
20
524288
627
30
536870912
5604
40
549755813888
37338
50
562949953421312
204226
60
576460752303423488
966467
70
590295810358705651712
4087968
80
604462909807314587353088
15796476
90
618970019642690137449562112
56634173
100
633825300114114700748351602688
190569292
110
649037107316853453566312041152512
607163746
120
664613997892457936451903530140172288
1844349560
130
680564733841876926926749214863536422912
5371315400
140
696898287454081973172991196020261297061888
15065878135
150
713623846352979940529142984724747568191373312
40853235313
160
730750818665451459101842416358141509827966271488
107438159466
170
748288838313422294120286634350736906063837462003712
274768617130
180
766247770432944429179173513575154591809369561091801088
684957390936
190
784637716923335095479473677900958302012794430558004314112
1667727404093
200
803469022129495137770981046170581301261101496891396417650688
3972999029388
210
822752278660603021077484591278675252491367932816789931674304512
9275102575355
220
842498333348457493583344221469363458551160763204392890034487820288
21248279009367
230
862718293348820473429344482784628181556388621521298319395315527974912
47826239745920
240
883423532389192164791648750371459257913741948437809479060803100646309888
105882246722733
250
904625697166532776746648320380374280103671755200316906558262375061821325312
230793554364681
FIGURE I.7. For n = 0, 10, 20, . . . , 250 (left), the number of compositions Cn (middle)
and the number of partitions (right). The ﬁgure illustrates the difference in growth between
Cn = 2n−1 and Pn = eO(√n).
From there, the counting problem for compositions is solved by a straightforward
expansion of the OGF: one has
C(z) =

X
n≥0
2nzn

−

X
n≥0
2nzn+1

,
implying
Cn = 2n−1, n ≥1;
C0 = 1.
This agrees with basic combinatorics since a composition of n can be viewed as the
placement of separation bars at a subset of the n −1 existing places inbetween n
aligned balls (the “balls and bars” model of Figure 6), of which there are clearly 2n−1
possibilities.
Partitions. For partitions speciﬁed as multisets, the general translation mecha-
nism provides
(28)
P = MSET(I)
=⇒
P(z) = exp

I(z) + 1
2I(z2) + 1
3I(z3) + · · ·

,
with product form
(29)
P(z) =
∞
Y
m=1
1
1 −zm
=
 1 + z + z2 + · · ·
  1 + z2 + z4 + · · ·
  1 + z3 + z6 + · · ·

· · ·
= 1 + z + 2z2 + 3z3 + 5z4 + 7z5 + 11z6 + 15z7 + 22z8 + · · · .
where the counting sequence is EIS A000041. Contrary to compositions that are
counted by the explicit formula 2n−1, no simple form exists for Pn. Asymptotic
analysis of the OGF (28) based on the saddle point method (Chapter VIII) shows that
Pn = eO(√n). In fact a very famous theorem of Hardy and Ramanujan later improved

40
I. UNLABELLED STRUCTURES AND ORDINARY GENERATING FUNCTIONS
by Rademacher (see Andrew’s book [10] and Chapter VIII) provides a full expansion
of which the asymptotically dominant term is
Pn ∼
1
4n
√
3
exp
 
π
r
2n
3
!
.
There are consequently appreciably fewer partitions than compositions (Figure 7).
 I.12. A recurrence for the partition numbers. Logarithmic differentiation gives
z P ′(z)
P(z) =
∞
X
n=1
nzn
1 −zn
implying
nPn =
n
X
j=1
σ(j)Pn−j,
where σ(n) is the sum of the divisors of n (e.g., σ(6) = 1 + 2 + 3 + 6 = 12). Consequently,
P1, . . . , PN can be computed in O(N 2) integer-arithmetic operations. (The technique is gener-
ally applicable to powersets and multisets; see Note 40 for another application. Note 17 further
lowers the bound in the case of partitions to O(N
√
N).)

By varying (27) and (28), we can use the symbolic method to derive a number of
counting results in a straightforward manner. First, we state:
Proposition I.1. Let T ⊆I be a subset of the positive integers. The OGF of the
classes CT := SEQ(SEQT (Z)) and PT := MSET(SEQT (Z)) of compositions and
partitions having summands restricted to T is given by
CT (z) =
1
1 −P
n∈T zn =
1
1 −T (z),
P T (z) =
Y
n∈T
1
1 −zn .
PROOF. The statement results directly from Theorem I.1.
□
This proposition permits us to enumerate compositions and partitions with re-
stricted summands, as well as with a ﬁxed number of parts.
EXAMPLE I.4. Compositions with restricted summands. In order to enumerate the class C{1,2}
of compositions of n whose parts are only allowed to be taken from the set {1, 2}, simply write
C{1,2} = SEQ(I{1,2})
with I{1,2} = {1, 2}.
Thus, in terms of generating functions, one has
C{1,2}(z) =
1
1 −I{1,2}(z)
with
I{1,2}(z) = z + z2.
This formula implies
C{1,2}(z) =
1
1 −z −z2 = 1 + z + 2z2 + 3z3 + 5z4 + 8z5 + 13z6 + · · · ,
and the number of compositions of n in this class is expressed by a Fibonacci number,
C{1,2}
n
= Fn+1 where Fn =
1
√
5
»„1 +
√
5
2
«n
−
„1 −
√
5
2
«n–
.
In particular, the rate of growth is of the exponential type ϕn, where ϕ := 1 +
√
5
2
is the golden
ratio.
Similarly, compositions such that all their summands lie in the set {1, 2, . . . , r} have gen-
erating function
C{1,...,r}(z) =
1
1 −z −z2 −· · · zr =
1
1 −z 1−zr
1−z
=
1 −z
1 −2z + zr+1 ,

I. 3. INTEGER COMPOSITIONS AND PARTITIONS
41
and the corresponding counts are given by generalized Fibonacci numbers. A double combina-
torial sum expresses these counts
(30)
C{1,...,r}
n
= [zn]
X
j
„z(1 −zr)
(1 −z)
«j
=
X
j,k
(−1)k
 
j
k
! 
n −rk −1
j −1
!
.
This result is perhaps not too useful for grasping the rate of growth of the sequence when n gets
large, so that asymptotic analysis is called for. Asymptotically, for any ﬁxed r ≥2, there is a
unique root ρr of the denominator 1 −2z + zr+1 in ( 1
2, 1), this root dominates all the other
roots and is simple. Methods amply developed in Chapter IV, imply that, for some constant
cr > 0,
(31)
C{1,...,r}
n
∼crρ−n
r
for ﬁxed r as n →∞.
The quantity ρr plays a rˆole similar to that of the golden ratio when r = 2. END OF EXAMPLE I.4. □
 I.13. Compositions into primes. The additive decomposition of integers into primes is still
surrounded with mystery. For instance, it is not known whether every even number is the sum
of two primes (Goldbach’s conjecture). However, the number of compositions of n into prime
summands (any number of summands is permitted) is Bn = [zn]B(z) where
B(z)
=
0
@1 −
X
p prime
zp
1
A
−1
=
`
1 −z2 −z3 −z5 −z7 −z11 −· · ·
´−1
=
1 + z2 + z3 + z4 + 3 z5 + 2 z6 + 6 z7 + 6 z8 + 10 z9 + 16 z10 + · · ·
(EIS A023360) and complex asymptotic methods make it easy from there to determine the
asymptotic form Bn ∼0.30365 · 1.47622n; see Chapter IV.

EXAMPLE I.5. Partitions with restricted summands (denumerants). Whenever summands are
restricted to a ﬁnite set, the special partitions that result are called denumerants. A popular
denumerant problem consists in ﬁnding the number of ways of giving change of 99 cents using
coins that are pennies (1 ¢), nickels (5 ¢), dimes (10 ¢) and quarters (25 ¢). (The order in which
the coins are taken does not matter and repetitions are allowed.) For the case of a ﬁnite T , we
predict from Proposition I.1 that P T (z) is always a rational function with poles that are at roots
of unity; also the P T
n satisfy a linear recurrence related to the structure of T . The solution to
the original coin change problem is found to be
[z99]
1
(1 −z)(1 −z5)(1 −z10)(1 −z25) = 213.
In the same vein, one proves that
P {1,2}
n
= ⌈2n + 3
4
⌋
P {1,2,3}
n
= ⌈(n + 3)2
12
⌋.
There ⌈x⌋≡⌊x + 1
2⌋denotes the integer closest to the real number x. Such results are
typically obtained by the two step process: (i) decompose the rational generating function into
simple fractions; (ii) compute the coefﬁcients of each simple fraction and combine them to get
the ﬁnal result [98, p. 108].
The general argument also gives the generating function of partitions whose summands lie
in the set {1, 2, . . . , r} as
(32)
P {1,...,r}(z) =
r
Y
m=1
1
1 −zm .

42
I. UNLABELLED STRUCTURES AND ORDINARY GENERATING FUNCTIONS
In other words, we are enumerating partitions according to the value of the largest summand.
One then ﬁnds by looking at the poles (Chapter IV):
(33)
P {1,...,r}
n
∼crnr−1
with
cr =
1
r!(r −1)!.
A similar argument provides the asymptotic form of P T
n when T is an arbitrary ﬁnite set:
P T
n ∼1
τ
nr−1
(r −1)!
with τ :=
Y
n∈T
n,
r := card(T ).
This result originally due to Schur is discussed in Chapter IV. . . . . END OF EXAMPLE I.5. □
We next examine compositions and partitions with a ﬁxed number of summands.
EXAMPLE I.6.
Compositions with a ﬁxed number of parts.
Let C(k) denote the class of
compositions made of k summands, k a ﬁxed integer ≥1. One has
C(k)(z) = SEQk(I) ≡I × I × · · · × I,
where the number of terms in the cartesian product is k. From there, the corresponding gener-
ating function is found to be
C(k) =
`
I(z)
´k
with
I(z) =
z
1 −z .
The number of compositions of n having k parts is thus
C(k)
n
= [zn]
zk
(1 −z)k =
 
n −1
k −1
!
,
a result which constitutes a combinatorial reﬁnement of Cn = 2n−1. (Note that the formula
C(k)
n
=
`n−1
k−1
´
also results easily from the balls-and-bars model of compositions (Figure 6)).
In such a case, the asymptotic estimate C(k)
n
∼nk−1/(k −1)! results immediately from the
polynomial form of the binomial coefﬁcient
`n−1
k−1
´
. . . . . . . . . . . . . . . END OF EXAMPLE I.6. □
EXAMPLE I.7.
Partitions with a ﬁxed number of parts.
Let P(≤k) be the class of integer
partitions with at most k summands. With our notation for restricted constructions (p. 29), this
class is speciﬁed as
P(≤k) = MSET≤k(I).
It would be possible to appeal to the admissibility of such restricted compositions as developed
in Section I. 6.1, but the following direct argument sufﬁces.
Geometrically, partitions, are represented as collections of points: this is the staircase
model of Figure 6). A symmetry around the main diagonal (also known in the specialized
literature as conjugation) exchanges number of summands and value of largest summand: one
has (with previous notations)
P(≤k) ∼= P{1, . . k}
=⇒
P (≤k)(z) = P {1, . . k}(z),
so that, by (32),
(34)
P (≤k)(z) ≡P {1,...,k} =
k
Y
m=1
1
1 −zm .

I. 3. INTEGER COMPOSITIONS AND PARTITIONS
43
As a consequence, the OGF of partitions with exactly k summands, P (k)(z) = P (≤k)(z) −
P (≤k−1)(z), evaluates to
P (k)(z) =
zk
(1 −z)(1 −z2) · · · (1 −zk).
Given the equivalence between number of parts and largest part in partitions, the asymptotic
estimate (33) applies verbatim here. . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE I.7. □
 I.14. Compositions with summands bounded in number and size. The number of composi-
tions of size n with k summands each at most r is
[zn]
„
z 1 −zr
1 −z
«k
,
and is expressible as a simple binomial convolution.

 I.15. Partitions with summands bounded in number and size. The number of partitions of
size n with at most k summands each at most ℓis
[zn]
(1 −z)(1 −z2) · · · (1 −zk+ℓ)
((1 −z)(1 −z2) · · · (1 −zk)) · ((1 −z)(1 −z2) · · · (1 −zℓ)).
(The veriﬁcation by recurrence is easy.) The GF reduces to the binomial coefﬁcient
`k+ℓ
k
´
as
z →1; it is known as a Gaussian binomial coefﬁcient, denoted
`k+ℓ
k
´
z, or a “q–analogue” of
the binomial coefﬁcient [10, 98].

The last example of this section illustrates the close interplay between combi-
natorial decompositions and special function identities, which constitutes a recurrent
theme of classical combinatorial analysis.
EXAMPLE I.8.
The Durfee square of partitions and stack polyominoes. The diagram of any
partition contains a uniquely determined square (known as the Durfee square) that is maximal,
as exempliﬁed by the following diagram:
=
This decomposition is expressed in terms of partition GFs as
P ∼=
[
k≥0
“
Zk2 × P(≤k) × P{1,...,k}”
,
It gives, via (32) and (34), the non-trivial identity
∞
Y
n=1
1
1 −zn =
X
k≥0
zk2
((1 −z) · · · (1 −zk))2
(k is the size of the Durfee square), which is nothing but a formal rewriting of the geometric
decomposition.
Here is a similar case illustrating the direct correspondence between geometric diagrams
and generating functions, as afforded by the symbolic method.

44
I. UNLABELLED STRUCTURES AND ORDINARY GENERATING FUNCTIONS
Spec.
OGF
coeff.
asympt.
Composition
SEQ(SEQ≥1(Z))
1 −z
1 −2z
2n−1
1
22n
—, sum. ≤r
SEQ(SEQ1 . . r(Z))
1 −z
1 −2z + zr+2
Eq. (30)
crρ−n
r
—, k sum.
SEQk(SEQ≥1(Z))
zk
(1 −z)k
 
n −1
k −1
!
nk−1
(k −1)!
Partitions
MSET(SEQ≥1(Z))
∞
Y
m=1
(1 −zm)−1
—
1
4n
√
3
eπ√2n
3
—, sum. ≤r
MSET(SEQ1 . . r(Z))
r
Y
m=1
(1 −zm)−1
—
nr−1
r!(r −1)!
—, ≤k sum.
∼= MSET(SEQ1 . . k(Z))
k
Y
m=1
(1 −zm)−1
—
nk−1
k!(k −1)!
Cyclic comp.
CYC(SEQ≥1(Z))
Eq. (35)
Eq. (36)
2n
n
Part., distinct sum. PSET(SEQ≥1(Z))
∞
Y
m=1
(1 + zm)
—
33/4
12n3/4 eπ√n
3
FIGURE I.8. Partitions and compositions: speciﬁcations, generating functions, counting
sequences, and asymptotic approximation.
Stack polyominoes are diagrams of compositions such that for some j, ℓ, one has 1 ≤x1 ≤
x2 ≤· · · ≤xj ≥xj+1 ≥· · · ≥xℓ≥1 (see [447, §2.5] for further properties). The diagram
representation of stack polyominoes,
k
←→
P{1,...,k−1} × Zk × P {1,...,k}
translates immediately into the OGF
S(z) =
X
k≥1
zk
1 −zk
1
((1 −z)(1 −z2) · · · (1 −zk−1))2 ,
once use is made of the partition GFs P {1,...,k}(z) of (32). This last relation provides a bona ﬁde
algorithm for computing the initial values of the number of stack polyominoes (EIS A001523):
S(z) = z + 2 z2 + 4 z3 + 8 z4 + 15 z5 + 27 z6 + 47 z7 + 79 z8 + · · · .
The book of van Rensburg [482] describes many such constructions and their relation to certain
models of statistical physics. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE I.8. □
Figure 8 summarizes what has been learnt regarding compositions and parti-
tions. The way several combinatorial problems are solved effortlessly by the symbolic
method is worth noting.

I. 3. INTEGER COMPOSITIONS AND PARTITIONS
45
I. 3.2. Related constructions. It is also natural to consider the two constructions
of cycle and powerset that we have not yet applied to I.
Cyclic compositions (wheels). The class D = CYC(I) comprises compositions
deﬁned up to circular shift of the summands; so, for instance 2 + 3 + 1 + 2 + 5,
3 + 1 + 2 + 5 + 2, etc, are identiﬁed.
Alternatively, we may view elements of D
as “wheels” composed of circular arrangements of rows of balls (taken up to circular
symmetry).
A “wheel” (cyclic composition):
By the cycle construction, the OGF is
(35)
D(z)
=
∞
X
k=1
ϕ(k)
k
log

1 −
zk
1 −zk
−1
=
z + 2 z2 + 3 z3 + 5 z4 + 7 z5 + 13 z6 + 19 z7 + 35 z8 + · · · .
The coefﬁcients are thus (EIS A008965)
(36)
Dn = 1
n
X
k | n
ϕ(k)(2n/k −1) ≡−1 + 1
n
X
k | n
ϕ(k)2n/k ∼2n
n .
Notice that Dn is of the same asymptotic order as 1
nCn, which is suggested by circular
symmetry of wheels, but Dn ∼2Cn/n.
Partitions into distinct summands. The class Q = PSET(I) is the subclass
of P = MSET(I) corresponding to partitions determined like in Deﬁnition I.9, but
with the strict inequalities xk > · · · > x1, so that the OGF is
Q(z) =
Y
n≥1
(1 + zn) = 1 + z + z2 + 2z3 + 2z4 + 3z5 + 4z6 + 5z7 + 6z8 + · · · .
The coefﬁcients (EIS A000009) are not amenable to closed from. However the saddle
point method (Chapter VIII) yields the approximation:
(37)
Qn ∼
33/4
12n3/4 exp

π
rn
3

,
which has a shape similar to that of Pn.
 I.16. Odd versus distinct summands. The partitions of n into odd summands (On) and into
distinct summands (Qn) are equinumerous. Indeed, one has
Q(z) =
∞
Y
m=1
(1 + zm),
O(z) =
∞
Y
j=0
(1 −z2j+1)−1.
Equality results from substituting (1 + a) = (1 −a2)/(1 −a) with a = zm,
Q(z) = 1 −z2
1 −z
1 −z4
1 −z2
1 −z6
1 −z3
1 −z8
1 −z4
1 −z10
1 −z5
· · · =
1
1 −z
1
1 −z3
1
1 −z5 · · · ,

46
I. UNLABELLED STRUCTURES AND ORDINARY GENERATING FUNCTIONS
and simpliﬁcation of the numerators with half of the denominators (in boldface).

Partitions into powers. Let Ipow = {1, 2, 4, 8, . . .} be the set of powers of 2.
The corresponding P and Q partitions have OGFs
P pow(z)
=
∞
Y
j=0
1
1 −z2j
=
1 + z + 2z2 + 2z3 + 4z4 + 4z5 + 6z6 + 6z7 + 10z8 + + · · ·
Qpow(z)
=
∞
Y
j=0
(1 + z2j)
=
1 + z + z2 + z3 + z4 + z5 + · · · .
The ﬁrst sequence 1, 1, 2, 2, . . . is the “binary partition sequence” (EIS A018819);
the difﬁcult asymptotic analysis was performed by de Bruijn [110] who obtained an
estimate that involves subtle ﬂuctuations and is of the global form eO(log2 n). The
function Qpow(z) reduces to (1 −z)−1 since every number has a unique additive
decomposition into powers of 2. Accordingly, the identity
1
1 −z =
∞
Y
j=0
(1 + z2j)
ﬁrst observed by Euler is sometimes nicknamed the “computer scientist’s identity” as
it expresses the fact that every number admits a unique binary representation.
There exists a rich set of identities satisﬁed by partition generating functions—
this fact owes to deep connections with elliptic functions, modular forms, and q–
analogues of special functions on the one hand, basic combinatorics and number the-
ory on the other hand. See [10, 98] for an introduction to this fascinating subject.
 I.17. Euler’s pentagonal number theorem. This famous identity expresses 1/P(z) as
Y
n≥1
(1 −zn) =
X
k∈Z
(−1)kzk(3k+1)/2.
It is proved formally and combinatorially in [98, p. 105]. As a consequence, the numbers
{Pj}N
j=0 can be determined in O(N
√
N) arithmetic operations.

 I.18. A digital surprise. Deﬁne the constant
ϕ := 9
10
99
100
999
1000
9999
10000 · · · .
Is it a surprise that it evaluates numerically to
ϕ .= 0.8900100999989990000001000099999999899999000000000010 · · · ,
that is, its decimal representation involves only the digits 0, 1, 8, 9? [This is suggested by a note
of S. Ramanujan, “Some deﬁnite integrals”, Messenger of Math. XLIV, 1915, pp. 10–18.] 
 I.19. Lattice points. The number of lattice points with integer coordinates that belong to the
closed ball of radius n in d–dimensional Euclidean space is
[zn2]
1
1 −z (Θ(z))d
where
Θ(z) = 1 + 2
∞
X
n=1
zn2.
Such OGFs are useful in cryptography [321]. Estimates may be obtained from the saddle point
method; see Chapter VIII.


I. 4. WORDS AND REGULAR LANGUAGES
47
I. 4. Words and regular languages
Fix a ﬁnite alphabet A whose elements are called letters. Each letter is taken
to have size 1, i.e., it is an atom. A word is then any ﬁnite sequence of letters,
usually written without separators. So, for us, with the choice of the latin alphabet
(A = {a,...,z}), sequences written as ygololihp, philology, zgrmblglps
are words. We denote the set of all words (often written as A⋆in formal linguistics)
by W. Following a well-established tradition in theoretical computer science and for-
mal linguistics, any subset of W is called a language (or formal language, when the
distinction with natural languages has to be made).
From the deﬁnition of the set of words W, one has
(38)
W ∼= SEQ(A)
=⇒
W(z) =
1
1 −mz ,
where m is the cardinality of the alphabet, i.e., the number of letters. The generating
function gives us the counting result
Wn = mn.
This result is elementary, but, as is usual with symbolic methods, many enumerative
consequences result from a given construction. It is precisely the purpose of this
section to examine some of them.
We shall introduce separately two frameworks that each have great expressive
power to describe languages. The ﬁrst one is iterative (i.e., nonrecursive) and it bases
itself on “regular speciﬁcations” that only involve sums, products, and sequences; the
other one that is recursive (but of a very simple form) is best conceived of in terms
of ﬁnite automata and is equivalent to linear systems of equations. Both frameworks
turn out to be logically equivalent in the sense that they determine the same family
of languages, the regular languages, though the equivalence5 is nontrivial and each
particular problem usually admits a preferred representation. The resulting OGFs are
invariably rational functions, a fact to be systematically exploited from an asymptotic
standpoint in Chapters IV and V.
I. 4.1. Regular speciﬁcations. Consider words (or strings) over the binary al-
phabet A = {a, b}. There is an alternative way to construct binary strings. It is
based on the observation that (with a minor adjustment at the beginning) a string de-
composes into a succession of “blocks” each formed with a single b followed by an
arbitrary (possibly empty) sequence of a’s. For instance aaabaababaabbabbaaa de-
composes as
aaa || baa | ba | baa | b | ba | b | baaa.
Omitting redundant6 symbols, we have the alternative decomposition:
(39)
W ∼= SEQ(a) × SEQ(b SEQ(a))
=⇒
W(z) =
1
1 −z
1
1 −z
1
1−z
.
5APPENDIX A: Regular languages, p. 678 provides a basis for this equivalence.
6As usual, when dealing with words, we freely omit redundant braces ‘{, }’ and cartesian products
‘×’. For instance, SEQ(a + b) and a b are shorthand notations for SEQ({a} + {b}) and {{a} × {b}}.

48
I. UNLABELLED STRUCTURES AND ORDINARY GENERATING FUNCTIONS
This last expression reduces to (1 −2z)−1 as it should.
Longest runs. The interest of the construction just seen is to take into account
various meaningful properties, for example longest runs. Denote by a<k := SEQ<k(a)
the collection of all words formed with the letter a only and whose length is between
0 and k −1; the corresponding OGF is 1 + z + · · · + zk−1 = (1 −zk)/(1 −z).
The collection W⟨k⟩of words which do not have k consecutive a’s is described by an
amended form of (39), and
W⟨k⟩= a<k SEQ(ba<k) =⇒W ⟨k⟩(z) = 1 −zk
1 −z ·
1
1 −z 1−zk
1−z
=
1 −zk
1 −2z + zk+1 .
The OGF is in principle amenable to expansion, but the resulting coefﬁcients expres-
sions are complicated and, in such a case, asymptotic estimates tend to be more usable.
From an analysis developed in Chapter V, it can indeed be deduced that the longest
run of a’s in a random binary string of length n is asymptotic to log2 n.
 I.20. Runs in arbitrary alphabets. For an alphabet of cardinality m, the quantity
1 −zk
1 −mz + (m −1)zk+1
is the OGF of words without k consecutive occurrences of a designated letter.

The case of longest runs exempliﬁes the usefulness of nested constructions in-
volving sequences. We set:
Deﬁnition I.10. An iterative speciﬁcation that only involves atoms (e.g., letters of a
ﬁnite alphabet A) together with combinatorial sums, cartesian products, and sequence
constructions is said to be a regular speciﬁcation.
A language L is said to be S-regular (speciﬁcation-regular) if there exists a class
M described by a regular speciﬁcation R such that L and M are combinatorially
isomorphic: L ∼= M.
An equivalent way of expressing the deﬁnition is as follows: a language is S-
regular if it can be described unambiguously by a regular expression (APPENDIX A:
Regular languages, p. 678). The deﬁnition of a regular speciﬁcation and the basic
admissibility theorem imply immediately:
Proposition I.2. Any S-regular language has an OGF that is a rational function. This
OGF is obtained from a regular speciﬁcation of the language by translating each letter
into the variable z, disjoint unions into sums, cartesian products into products, and
sequences into quasi-inverses, (1 −·)−1.
This result is technically shallow but its importance derives from the fact that
regular languages have great expressive power devolving from their rich closure prop-
erties (APPENDIX A: Regular languages, p. 678) as well as their relation to ﬁnite
automata discussed in the next subsection. Examples 9 and 10 make use of Proposi-
tion I.2 and treat two problems closely related to longest runs.
EXAMPLE I.9.
Combinations and spacings.
A regular speciﬁcation describes the set L of
words that contain exactly k occurrences of the letter b, from which the OGF automatically
derives:
(40)
L = SEQ(a) (b SEQ(a))k
=⇒
L(z) = zk/(1 −z)k+1.

I. 4. WORDS AND REGULAR LANGUAGES
49
Hence the number of words in the language satisﬁes Ln =
`n
k
´
. This is otherwise combinato-
rially evident, since each word of length n is characterized by the positions of its letters b, that
is, the choice of k positions amongst n possible ones. Symbolic methods thus give us back the
well-known count of combinations by binomial coefﬁcients.
Let
`n
k
´
<d be the number of combinations of k elements amongst [1, n] with constrained
spacings: no element can be at distance d or more from its successor. The reﬁnement of (40)
L[d] = SEQ(a) (b SEQ<d(a))k−1 (b SEQ(a))
=⇒
X
n≥0
 
n
k
!
<d
zn = zk(1 −zd)k−1
(1 −z)k+1
,
leads to a binomial convolution expression,
 
n
k
!
<d
=
X
j
(−1)j
 
k −1
j
! 
n −dj
k
!
.
(This problem is analogous to compositions with bounded summands.) What we have just
analysed in the largest spacing (constrained to be < d) in subsets; a parallel analysis yields
information regarding the smallest spacing. . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE I.9. □
EXAMPLE I.10. Double run statistics. By forming maximal groups of equal letters in words,
one ﬁnds easily that, for a binary alphabet,
W = SEQ(b) SEQ(a SEQ(a) b SEQ(b)) SEQ(a).
Let W⟨α,β⟩be the class of all words that have at most α consecutive a’s and at most β
consecutive b’s. The speciﬁcation of W produces a speciﬁcation of W⟨α,β⟩, upon replacing
SEQ(a), SEQ(b) by SEQ<α(a), SEQ<β(b) internally, and by SEQ≤α(a), SEQ≤β(b) externally.
In particular, the OGF of binary words that never have more than r consecutive equal letters is
found to be (set α = β = r)
(41)
W ⟨r,r⟩=
1 −zr+1
1 −2z + zr+1 = 1 + z + · · · + zr
1 −z −· · · −zr ,
after simpliﬁcation.
R´ev´esz in [410] tells the following amusing story attributed to T. Varga: “A class of high
school children is divided into two sections. In one of the sections, each child is given a coin
which he throws two hundred times, recording the resulting head and tail sequence on a piece
of paper. In the other section, the children do not receive coins, but are told instead that they
should try to write down a ‘random’ head and tail sequence of length two hundred. Collecting
these slips of paper, [a statistician] then tries to subdivide them into their original groups. Most
of the time, he succeeds quite well.”
The statistician’s secret is to determine the probability distribution of the maximum length
of runs of consecutive letters in a random binary word of length n (here n = 200). The
probability of this parameter to equal k is
1
2n
“
W ⟨k,k⟩
n
−W ⟨k−1,k−1⟩
n
”
and is fully determined by (41). The probabilities are then easily computed using any symbolic
package: For n = 200, the values found are
k
3
4
5
6
7
8
9
10
11
12
P: 6.54 10−8 7.07 10−4 0.0339 0.1660 0.2574 0.2235 0.1459 0.0829 0.0440 0.0226

50
I. UNLABELLED STRUCTURES AND ORDINARY GENERATING FUNCTIONS
Thus, in a randomly produced sequence of length 200, there are usually runs of length 7 or
more: the probability of the event turns out to be close to 80% (and there is still a probability
of about 8% to have a run of length 11 or more). On the other hand most children (and adults)
are usually afraid of writing down runs longer than 4 or 5 as this is felt as strongly “non-
random”. The statistician simply selects the slips that contain runs of length 6 or more. Et
voil`a! . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE I.10. □
 I.21. Alice and Bob. Alice wants to communicate n bits of information to Bob over a channel
(a wire, an optic ﬁber) that transmits 0,1–bits but is such that any occurrence of 11 terminates
the transmission. Thus, she can only send on the channel an encoded version of her message
(where the code is of some length ℓ≥n) that does not contain the pattern 11.
Here is a ﬁrst coding scheme: given the message m = m1m2 · · · mn, where mj ∈{0, 1},
apply the substitution: 0 7→00 and 1 7→10; terminate the transmission by sending 11. This
scheme has ℓ= 2n + O(1), and we say its rate is 2. Can one design codes with rate arbitrarily
close to 1, asymptotically?
Let C be the class of allowed code words. A code of length at most L is achievable only
if there is a one-to-one mapping from {0, 1}n into SL
j=0 Cj, i.e., 2n ≤PL
j=0 Cj. Working out
the OGF of C, one ﬁnds that necessarily
L ≥λn + O(1),
λ =
1
log2 ϕ
.= 1.440420,
ϕ = 1 +
√
5
2
.
Thus no code can achieve a rate better than 1.44; i.e., a loss of at least 44% is unavoidable. (For
this and the next note, see, e.g., MacKay [349, Ch. 17].)

 I.22. Coding without long runs. Because of hysteresis in magnetic heads, certain storage
devices cannot store binary sequences that have more than 4 consecutive 0’s or more than
4 consecutive 1’s. A coding scheme that transforms an arbitrary binary string into a string
obeying this constraint is sought.
From the OGF, one ﬁnds [z11]W ⟨4,4⟩(z) = 1546 > 210 = 1024. Consequently, a
substitution can be built that translates an original 10 bit block into an 11 bit block without
ﬁve consecutive equal letters. When substituted blocks are concatenated, this may give rise to
unwanted sequences of consecutive letters that are longer than acceptable. It then sufﬁces to use
“separators” and replace a substituted block of the form α · · · β by the longer block αα · · · ββ,
where 0 = 1 and 1 = 0. The resulting code has rate 13
10.
Extensions of this method show that the rate 1.057 is achievable (theoretically). On the
other hand, by the previous note, any acceptable code must use asymptotically at least 1.056n
bits to encode strings of n bits. (Hint: let α be the root near 1
2 of 1 −2α + α5 = 0, which is a
pole of W ⟨4,4⟩. One has 1/ log2(1/α) = 1.05621.)

Patterns. There are many situations in the sciences where it is of interest to de-
termine whether the appearance of a certain pattern in long sequences of observations
is signiﬁcant. In a genomic sequence of length 100,000 (the alphabet is A,G,C,T),
is it or not meaningful to detect three occurrences of the pattern TAGATAA, where
the letters appear consecutively and in the prescribed order? In computer network
security, certain attacks can be detected by some well deﬁned alarming sequences of
events, though these events may be separated by perfectly legitimate actions. On an-
other register, data mining aims at broadly categorizing electronic documents in an
automatic way, and in this context the observation of well chosen patterns can provide
highly discriminating criteria. These various applications require determining which
patterns are, with high probability, bound to occur (these are not signiﬁcant) and which
are very unlikely to arise, so that actually observing them carries useful information.

I. 4. WORDS AND REGULAR LANGUAGES
51
Quantifying the corresponding probabilistic phenomena reduces to an enumerative
problem—the case of double runs in Example 10 is in this respect typical.
The notion of pattern can be formalized in several ways. In this book, we shall
consider two of them:
(a) Subsequence pattern: such a pattern is deﬁned by the fact that its letter must
appear in the right order, but not necessarily contiguously [215]. Subse-
quence patterns are also known as “hidden patterns”.
(b) Factor pattern: such a pattern is deﬁned by the fact that its letter must appear
in the right order and contiguously [254, 458]. Factor patterns are also called
“block patterns” or simply “patterns” when the context is clear.
For a given notion of pattern, there are then two related categories of problems. First,
one may aim at determining the probability that a random word contains (or dually,
excludes) a pattern; this problem is equivalently formulated as an existence problem—
enumerate all words in which the pattern exists (i.e., occurs) independently of the
number of occurrences. Second, one may aim at determining the expectation (or even
the distribution) of the number of occurrences of a pattern in a random text; this prob-
lem involves enumerating enriched words, each with one occurrence of the pattern
distinguished.
Such questions are amenable to methods of analytic combinatorics and in partic-
ular to the theory of regular speciﬁcations and automata: see Example 11 below for a
ﬁrst analysis of hidden patterns (to be continued in Chapter V) and Example 12 for an
analysis of factor patterns (to be further extended in Chapters III, IV, and IX).
EXAMPLE I.11.
Subsequence (hidden) patterns in a text.
A sequence of letters that occurs
in the right order, but not necessarily contiguously in a text is said to be a “hidden pattern”.
For instance the pattern “combinatorics” is to be found hidden in Shakespeare’s Hamlet (Act I,
Scene 1)
Dared to the comb at; in which our v a lian t Hamlet–
F or so th i s side of our known world esteem’d him–
Did slay this Fortinbras; who by a seal’d compact,
Well ratiﬁed by law and heraldry,
Did forfeit, with his life, all those his lands
Whi c h he s tood seized of, to the conqueror. . .
Take a ﬁxed ﬁnite alphabet A comprising m letters (m = 26 for English). First, let
us examine the language L of all words, also called “texts”, that contain a given word p =
p1p2 · · · pk of length k as a subsequence. These words can be described unambigously as
starting with a sequence of letters not containing p1 followed by the letter p1 followed by a
sequence not containing p2, and so on:
L = SEQ(A \ p1)p1 SEQ(A \ p2)p2 · · · SEQ(A \ pk)pk SEQ(A).
This is in a sense equivalent to parsing words unambiguously according to the leftmost occur-
rence of p as a subsequence. The OGF is accordingly
L(z) =
zk
(1 −(m −1)z)k
1
1 −mz .

52
I. UNLABELLED STRUCTURES AND ORDINARY GENERATING FUNCTIONS
An easy analysis of the dominant simple pole at z = 1/m shows that
L(z)
∼
z→1/m
1
1 −mz ,
so that
Ln
∼
n→∞mn.
Thus, a proportion tending to 1 of all the words of length n do contain p as a subsequecne.
 I.23. A reﬁned analysis. Further consideration of the subdominant pole at z = 1/(m −1)
yields, by the methods of Chapter IV, the reﬁned estimate:
1 −Ln
mn = O
„
nk−1
„
1 −1
m
«n«
.
Thus, the probability of not containing a given subsequence pattern is exponentialy small. 
A census (Note 24) shows that there are in fact 1.63 1039 occurrences of “combinatorics”
as a subsequence hidden somewhere in the text of Hamlet, whose length is 120,057 (this is the
number of letters that constitute the text). Is this the sign of a secret encouragement passed to
us by the author of Hamlet?
Here is an analysis of the expected number of hidden patterns based on enumerating en-
riched words, where an enriched word is a word together with a distinguished occurrence of the
pattern as a subsequence. Consider the regular speciﬁcation
O = SEQ(A) p1 SEQ(A) p2 SEQ(A) · · · SEQ(A) pk−1 SEQ(A) pk SEQ(A).
An element of O is a (2k + 1)-tuple whose ﬁrst component is an arbitrary word, whose second
component is the letter p1, and so on, with letters of the pattern and free blocks alternating . In
other terms, any ω ∈O represents precisely one possible occurrence of the hidden pattern p in
a text built over the alphabet A. The associated OGF is simply
O(z) =
zk
(1 −mz)k+1 .
The ratio between the number of occurrences and the number of words of length n then equals
(42)
Ωn = [zn]O(z)
mn
= m−k
 
n
k
!
,
and this quantity represents the expected number of occurrences of the hidden pattern in a
random word of length n, assuming all such words to be equally likely. For the parameters
corresponding to the text of Hamlet (n = 120, 057) and the pattern “combinatorics” (k = 13),
the quantity Ωn evaluates to 6.96 1037. The number of hidden occurrences observed is thus 23
times higher than what the uniform model predicts! However, similar methods make it possible
to take into account nonuniform letter probabilities (Chapter III): based on the frequencies of
letters in the English text itself, the expected number of occurrences is found to be 1.71 1039—
this is now only within 5% of what is observed. Thus, Shakespeare did not (probably) conceal
in his text any message relative to combinatorics. . . . . . . . . . . . . . . END OF EXAMPLE I.11. □
 I.24. Dynamic programming. The number of occurrences of a subsequence pattern in a text
can be determined efﬁciently by scanning the text from left to right and maintaining a running
count of the number of occurrences of the pattern as well as all its preﬁxes.

I. 4.2. Finite automata. We begin with a simple device, the ﬁnite automaton,
that is widely used in models of computation [149] and has wide descriptive power as
regards structural properties of words7.
7A far reaching treatment of automata and paths in graphs, involving both algebraic and asymptotic
aspects, is given in Part B, Section V. 5, p. 320.

I. 4. WORDS AND REGULAR LANGUAGES
53
a
b
b
a, b
b
a
a
0
1
2
3
FIGURE I.9. Words that contain the pattern abb are recognized by a 4–state automaton
with initial state q0 and ﬁnal state q3.
Deﬁnition I.11. A ﬁnite automaton is a directed multigraph whg31ose edges are la-
belled by letters of the alphabet A. It is customary to refer to vertices as states and to
denote by Q the set of states. An initial state q0 ∈Q and a set of ﬁnal states Qf ⊆Q
are designated.
The automaton is said to be deterministic if for each pair (q, α) with q ∈Q and
α ∈A there exists at most one edge (one also says a transition) starting from q that is
labelled by the letter α.
A ﬁnite automaton is able to process words, as we now explain. A word w =
w1 . . . wn is accepted by the automaton if there exists a path in the multigraph con-
necting the initial state q0 to one of the ﬁnal states of Qf and whose sequence of edge
labels is precisely w1, . . . , wn. For a deterministic ﬁnite automaton, it sufﬁces to start
from the initial state q0, scan the letters of the word from left to right, and follow at
each stage the only transition permitted; the word is accepted if the state reached in
this way after scanning the last letter of w is a ﬁnal state. Schematically:
a
b
a
b
b
a
Q
A ﬁnite automaton thus keeps only a ﬁnite memory of the past (hence its name) and
is in a sense a combinatorial counterpart of the notion of Markov chain in probability
theory. In this book, we shall only consider deterministic automata.
As an illustration, consider the class L of all words w that contain the pattern
abb as a factor (the letters of the pattern should appear contiguously). Such words
are recognized by a ﬁnite automaton with 4 states, q0, q1, q2, q3. The construction is
classical: state qj is interpreted as meaning “the ﬁrst j characters of the pattern have
just been scanned”, and the corresponding automaton appears in Figure 9. The initial
state is q0, and there is a unique ﬁnal state q3.

54
I. UNLABELLED STRUCTURES AND ORDINARY GENERATING FUNCTIONS
Deﬁnition I.12. A language is said to be A–regular (automaton regular) if it coincides
with the set of words accepted by a deterministic ﬁnite automaton. A class M is A–
regular if for some regular language L, one has M ∼= L.
 I.25. Congruence languages. The language of binary representations of numbers that are
congruent to 2 to modulo 7 is A-regular. A similar property holds for any numeration base and
any boolean combination of basic congruence conditions.

 I.26. Binary representation of primes. The language of binary representations of prime
numbers is neither A-regular nor S-regular. [Hint: this requires the Prime Number Theorem
and asymptotic methods of Chapter IV.]

The following equivalence theorem is brieﬂy discussed in the Appendix (see AP-
PENDIX A: Regular languages, p. 678).
Equivalence theorem (Kleene–Rabin–Scott). A language is S–regular
(speciﬁcation regular) if and only if it is A–regular (automaton regular).
These two equivalent notions also coincide with the notion of regularity in formal
language theory (deﬁned there by means of regular expressions and nondeterministic
ﬁnite automata [3, 149]). As already pointed out, the equivalence is non-trivial: it
is given by an algorithm that transforms one formalism into the other, but does not
transparently preserve combinatorial structure (e.g., in some cases, an exponential
blow up in the size of descriptions is involved). For this reason, we have opted to
develop both notions of S-regularity and A-regularity in an independent way.
We next examine the way generating functions can be obtained from a determin-
istic automaton. The process was ﬁrst discovered in the late 1950’s by Chomsky and
Sch¨utzenberger [89].
Proposition I.3. Let G be a deterministic ﬁnite automaton with state set Q = {q0, . . . , qs},
initial state q0, and set of ﬁnal states Q = {qi1, . . . , qif }. The generating function of
the language L of all words accepted by the automaton is a rational function that is
determined under matrix form as
L(z) = u(I −zT )−1v.
There the transition matrix T is deﬁned by
Ti,j = card {α ∈A such that an edge (qi, qj) is labelled by α} ;
the row vector u is the vector (1, 0, 0, . . ., 0) and the column vector v = (v0, . . . , vs)t
is such that8 vj = [[qj ∈Q]].
In particular, by Cramer’s rule, the OGF of a regular language is the quotient of two
sparse determinants whose structure directly reﬂects the automaton transitions.
PROOF. For j ∈{0, . . . , s}, introduce the class (language) Lj of all words w such
that the automaton, when started in state qj, terminates in one of the ﬁnal states after
having read w. The following relation holds for any j:
(43)
Lj ∼= ∆j +
 X
α∈A
{α}L(qj◦α)
!
;
8It proves convenient at this stage to introduce Iverson’s bracket notation: for a predicate P , the
variable [[P ]] has value 1 if P is true and 0 otherwise.

I. 4. WORDS AND REGULAR LANGUAGES
55
there ∆j is the class {ǫ} formed of the word of length 0 if qj is ﬁnal and the empty
set (∅) otherwise; the notation (qj ◦α) designates the state reached in one step from
state qj upon reading letter α. The justiﬁcation is simple: a language Lj contains the
word of length 0 only if the corresponding state qj is ﬁnal; a word of length ≥1 that
is accepted starting from state qj has a ﬁrst letter α followed by a word that must lead
to an accepting state when starting from state qj ◦α.
The translation of (43) is then immediate:
(44)
Lj(z) = [[qj ∈Q]] + z
X
α∈A
L(qj◦α)(z).
The collection of all the equations as j varies forms a linear system: with L(z) the
column vector (L0(z), . . . , Ls(z)), one has
L(z) = v + zT L(z),
where v and T are as described in the statement. The result follows by matrix inversion
upon observing that L(z) ≡L0(z).
□
The pattern abb. Consider the automaton recognizing the pattern abb as given in
Figure 9. The languages Lj (where Lj is the set of accepted words when starting from
state qj) are connected by the system of equations
L0
=
aL1
+ bL0
L1
=
aL1
+ bL2
L2
=
aL1
+ bL3
L3
=
aL3
+ bL3
+ ǫ,
which directly reﬂects the graph structure of the automaton. This gives rise to a set of
equations for the associated OGFs
L0
=
zL1
+ zL0
L1
=
zL1
+ zL2
L2
=
zL1
+ zL3
L3
=
zL3
+ zL3
+ 1.
Solving the system, we ﬁnd the OGF of all words containing the pattern abb: it is
L0(z) since the initial state of the automaton is q0, and
(45)
L0(z) =
z3
(1 −z)(1 −2z)(1 −z −z2).
The partial fraction decomposition
L0(z) =
1
1 −2z −
2 + z
1 −z −z2 +
1
1 −z ,
then yields
L0,n = 2n −Fn+3 +1,
with Fn a Fibonacci number. In particular the number of words of length n that do
not contain abb is Fn+3 −1, a quantity that grows at an exponential rate of ϕn, with
ϕ = (1 +
√
5)/2 the golden ratio. Thus, all but an exponentially vanishing proportion
of the strings of length n contain the given pattern abb, a fact that was otherwise to
be expected on probabilistic grounds. (For instance, from Note 29, a random word
contains a large number, about ∼n/8, of occurrences of the pattern abb.)

56
I. UNLABELLED STRUCTURES AND ORDINARY GENERATING FUNCTIONS
 I.27. Regular speciﬁcation for pattern abb. The pattern abb is simple enough that one can
come up with an equivalent regular expression describing L0, whose existence is otherwise
predicted by the Kleene-Rabin-Scott Theorem. An accepting path in the automaton of Figure 9
loops around state 0 with a sequence of b, then reads an a, loops around state 1 with a sequence
of a’s and moves to state 2 upon reading a b; then there should be letters making the automaton
passs through states 1-2-1-2-· · · -1-2 and ﬁnally a b followed by an arbitrary sequence of a’s
and b’s at state 3. This corresponds to the speciﬁcation
L0 = SEQ(b) a SEQ(a)b SEQ(a SEQ(a)b)b SEQ(a + b)
=⇒
L0(z) =
z3
(1−z)2(1−z2
1−z )(1−2z),
which gives back a form equivalent to (45).

EXAMPLE I.12.
Words containing or excluding a pattern. Fix an arbitrary pattern p =
p1p2 · · · pk and let L be the language of words containing at least one occurrence of p as a
factor. Automata theory implies that the set of words containing a pattern as a factor is A–
regular, hence admits a rational generating function. Indeed, the construction given for p = abb
generalizes in an easy manner: there exists a deterministic ﬁnite automaton with k + 1 states
that recognizes L, the states memorizing at each stage the largest preﬁx of the pattern p just
seen. As a consequence: The OGF of the language of words containing a given factor pattern
of length k is a rational function of degree at most k + 1. (The corresponding automaton is in
fact known as a Knuth–Morris–Pratt automaton [310].) The automaton construction however
provides the OGF L(z) in determinantal form, so that the relation between this rational form
and the structure of the pattern is not transparent.
Autocorrelations. An explicit construction due to Guibas and Odlyzko [253] nicely cir-
cumvents this problem. It is based on an “equational” speciﬁcation that yields an alternative
linear system. The fundamental notion is that of an autocorrelation vector. For a given p, this
vector of bits c = (c0, . . . , ck−1) is most conveniently deﬁned in terms of Iverson’s bracket as
ci = [[pi+1pi+2 · · · pk = p1p2 · · · pk−i]].
In other words, the bit ci is determined by shifting p right by i positions and putting a 1 if
the remaining letters match the original p. Graphically, ci = 1 if the two framed factors of p
coincide in
p ≡
p1 · · · pi
pi+1 · · · pk
p1 · · · pk−i
pk−i+1 · · · pk
≡p.
For instance, with p = aabbaa, one has
a a b b a a
_______________________
a a b b a a
1
a a b b a a
0
a a b b a a
0
a a b b a a
0
a a b b a a
1
a a b b a a
1
The autocorrelation is then c = (1, 0, 0, 0, 1, 1). The autocorrelation polynomial is deﬁned as
c(z) :=
k−1
X
j=0
cjzj.
For the example pattern, this gives c(z) = 1 + z4 + z5.
Let S be the language of words with no occurrence of p and T the language of words that
end with p but have no other occurrence of p. First, by appending a letter to a word of S, one

I. 4. WORDS AND REGULAR LANGUAGES
57
ﬁnds a nonempty word either in S or T , so that
(46)
S + T = {ǫ} + S × A.
Next, appending a copy of the word p to a word in S may only give words that contain p at or
“near” the end. Precisely, the decomposition based on the leftmost occurrence of p in Sp is
(47)
S × {p} = T ×
X
ci̸=0
{pk−i+1pk−i+2 · · · pk},
corresponding to the conﬁgurations
S
///////p//////
=
//////p//////
|
{z
}
T
pk−i+1 · · · pk
The translation of the system (46), (47) into OGFs then gives a system of two equations in the
two unknown S, T,
S + T = 1 + mzS,
S · zk = Tc(z),
which is then readily solved.
Proposition I.4. The OGF of words not containing the pattern p as a factor is
(48)
S(z) =
c(z)
zk + (1 −mz)c(z),
where m is the alphabet cardinality, k = |p| the pattern length, and c(z) the autocorrelation
polynomial of p.
A bivariate generating function based on the autocorrelation polynomial is derived in
Chapter III, from which is deduced the existence of a limiting Gaussian law for the number
of occurrences of any pattern in Chapter IX. . . . . . . . . . . . . . . . . . . . END OF EXAMPLE I.12. □
 I.28. At least once. The GFs of words containing at least once the pattern (anywhere) and
containing it only once at the end are
L(z) =
zk
(1 −mz)(zk + (1 −mz)c(z)),
T(z) =
zk
zk + (1 −mz)c(z),
respectively.

 I.29. Expected number of occurrences of a pattern. For the mean number of occurrences
of a factor pattern, calculations similar to those employed for the number of occurrences of
a subsequence (even simpler) can be based on regular speciﬁcations.
All the occurrences
p = p1p2 · · · pk as a factor are described by
b
O = SEQ(A) (p1p2 · · · pk) SEQ(A),
=⇒
bO(z) =
zk
(1 −mz)2 .
Consequently, the expected number of such contiguous occurrences satisﬁes
(49)
bΩn = m−k(n −k + 1) ∼
n
mk .
Thus, the mean number of occurrences is proportional to n.

 I.30. Waiting times in strings. Let L ⊂SEQ{a, b} be a language and S = {a, b}∞be the set
of inﬁnite strings with the product probability induced by P(a) = P(b) = 1
2. The probability
that a random string ω ∈S starts with a word of L is bL(1/2), where bL(z) is the OGF of the
“preﬁx language” of L, that is, the set of words w ∈L that have no strict preﬁx belonging to L.

58
I. UNLABELLED STRUCTURES AND ORDINARY GENERATING FUNCTIONS
The GF bL(z) serves to express the expected time at which a word in L is ﬁrst encountered: this
is 1
2 bL′( 1
2). For a regular language, this quantity must be a rational number.

 I.31. A probabilistic paradox on strings. In a random inﬁnite sequence, a pattern p of length k
ﬁrst occurs on average at time 2kc(1/2), where c(z) is the autocorrelation polynomial. For
instance, the pattern p = abb tends to occur “sooner” (at average position 8) than p′ = aaa (at
average position 14). See [253] for a thorough discussion. Here are for instance the epochs at
which p and p′ are ﬁrst found in a sample of 20 runs
p :
3, 4, 5, 5, 6, 6, 7, 8, 8, 8, 8, 9, 9, 10, 11, 14, 15, 15, 16, 21
p′ :
3, 4, 8, 8, 9, 10, 11, 11, 11, 12, 17, 22, 23, 27, 27, 27, 44, 47, 52, 52.
On the other hand, patterns of the same length have the same expected number of occurrences,
which is puzzling. The catch is that, due to overlaps of p′ with itself, occurrences of p′ tend to
occur in clusters, but, then, clusters tend to be separated by wider gaps than for p; eventually,
there is no contradiction.

 I.32. Borges’s Theorem. Take any ﬁxed set Π of ﬁnite patterns. A random text of length n
contains all the patterns of the set Π (as factors) with probability tending to 1 exponentially
fast as n →∞. (Reason: the rational functions S(z/2) with S(z) as in (48) have no pole
in |z| ≤1; see also Chapters IV, V.)
Note: similar properties hold for many random combinatorial structures. They are some-
times called “Borges’s Theorem” as a tribute to the famous Argentinian writer Jorge Luis Borges
(1899–1986) who, in his essay “The Library of Babel”, describes a library so huge as to contain:
“Everything: the minutely detailed history of the future, the archangels’ autobiographies, the
faithful catalogues of the Library, thousands and thousands of false catalogues, the demonstra-
tion of the fallacy of those catalogues, the demonstration of the fallacy of the true catalogue, the
Gnostic gospel of Basilides, the commentary on that gospel, the commentary on the commen-
tary on that gospel, the true story of your death, the translation of every book in all languages,
the interpolations of every book in all books.”

In general, automata are useful in establishing a priori the rational character of
generating functions. They are also surrounded by interesting analytic properties
(e.g., Perron-Frobenius theory, Chapter IV, that characterizes the dominant poles)
and by asymptotic probability distributions of associated parameters that are normally
Gaussian. They are most conveniently used for proving existence theorems, then sup-
plemented when possible by regular speciﬁcations, which are likely to lead to more
tractable expressions.
 I.33. Variable length codes.
A ﬁnite set F ⊂W, where W = SEQ(A) is called a code if
any word of W decomposes in at most one manner into factors that belong to F (with repeti-
tions allowed). For instance F = {a, ab, bb} is a code and aaabbb = a|a|ab|bb has a unique
decomposition; F′ = {a, aa, b} is not a code since aaa = a|aa = aa|a = a|a|a. The OGF of
the set SF of all words that admit a decomposition into factors all in F is a computable rational
function, irrespective of whether F is a code. (Hint: use an “Aho–Corasick” automaton [4].) A
ﬁnite set F is a code iff SF(z) = (1 −F(z))−1. Consequently, the property of being a code
can be decided in polynomial time using linear algebra. The book by Berstel and Perrin [46]
develops systematically the theory of such variable-length codes.

I. 4.3. Related constructions. Words can, at least in principle, encode any com-
binatorial structure. We detail here one example that demonstrates the usefulness of
such encodings: it is relative to set partitions and Stirling numbers. The point to be
made is that some amount of “combinatorial preprocessing” is sometimes necessary
in order to bring combinatorial structures into the framework of symbolic methods.

I. 4. WORDS AND REGULAR LANGUAGES
59
α β γ δ
α β | γ δ
α γ | β δ
α δ | β γ
α | β γ δ
β | α γ δ
γ | α β δ
δ | α β γ
α | β | γ δ
α | γ | β δ
α |δ | β γ
β | γ | α δ
β | δ | α γ
γ | δ | α β
α | β | γ | δ
FIGURE I.10. The 15 ways of partitioning a four-element domain into blocks corre-
spond to S(1)
4
= 1,
S(2)
4
= 7,
S(3)
4
= 6,
S(4)
4
= 1.
Set partitions and Stirling partition numbers. A set partition is a partition of a
ﬁnite domain into a certain number of nonempty sets, also called blocks. For instance,
if the domain is D = {α, β, γ, δ}, there are 15 ways to partition it (Figure 10). Let
S(r)
n
denote the collection of all partitions of the set [1 . . n] into r non–empty blocks
and S(r)
n
= card(S(r)
n ) the corresponding cardinality. The basic object under consid-
eration here is a set partition (not to be confused with integer partitions considered
earlier).
It is possible to ﬁnd an encoding of partitions in S(r)
n
of an n–set into r blocks by
words over a r letter alphabet, B = {b1, b2, . . . , br} as follows. Consider a set partition
̟ that is formed of r blocks. Identify each block by its smallest element called the
block leader; then sort the block leaders into increasing order. Deﬁne the index of
a block as the rank of its leader amongst all the r leaders, with ranks conventionally
starting at 1. Scan the elements 1 to n in order and produce sequentially n letters from
the alphabet B: for an element belonging to the block of index j, produce the letter bj.
For instance to n = 6, r = 3, the set partition ̟ = {{6, 4}, {5, 1, 2}, {3, 7, 8}},
is reorganized by putting leaders in ﬁrst position of the blocks and sorting them,
̟ = {
b1
z
}|
{
{1, 2, 5},
b2
z
}|
{
{3, 7, 8},
b3
z }| {
{4, 6}},
so that the encoding is
 1 2 3 4 5 6 7 8
b1 b1 b2 b3 b1 b3 b2 b2

.
In this way, a partition is encoded as a word of length n over B with the additional
properties that: (i) all r letters occur; (ii) the ﬁrst occurrence of b1 precedes the ﬁrst
occurrence of b2 which itself precedes the ﬁrst occurrence of b3, etc. Thus S(r)
n
is
mapped into words of length n in the language
b1 SEQ(b1) · b2 SEQ(b1 + b2) · b3 SEQ(b1 + b2 + b3) · · · br SEQ(b1 + b2 + · · · + br).

60
I. UNLABELLED STRUCTURES AND ORDINARY GENERATING FUNCTIONS
Graphically, this correspondence can be rendered by an “irregular staircase” represen-
tation, like
4
−
6
−
−
3
−
−
−
7
8
1
2
−
−
5
−
−
−
where the staircase has length n and height r, each column contains exactly one ele-
ment, each row corresponds to a class in the partition.
The language speciﬁcation immediately gives the OGF
S(r)(z) =
zr
(1 −z)(1 −2z)(1 −3z) · · · (1 −rz).
The partial fraction expansion of S(r)(z) is readily computed,
S(r)(z) = 1
r!
r
X
j=0
r
j
(−1)r−j
1 −jz ,
so that
S(r)
n
= 1
r!
r
X
j=1
(−1)r−j
r
j

jn.
In particular, one has
S(1)
n
= 1; S(2)
n
= 1
2!(2n −2); S(3)
n
= 1
3!(3n −3 · 2n + 3).
These numbers are known as the Stirling numbers of the second kind, or better, as
the Stirling partition numbers, and the S(r)
n
are nowadays usually denoted by
n
r
	
;
see APPENDIX A: Stirling numbers, p. 680.
The counting of set partitions could eventually be done successfully thanks to an
encoding into words, and the corresponding language forms a constructible class of
combinatorial structures (actually a regular language). In the next chapter, we shall
examine another approach to the counting of set partitions that is based on labelled
structures and exponential generating functions.
Circular words (necklaces). Let A be a binary alphabet, viewed as comprised
of beads of two distinct colours. The class of circular words or necklaces (p. 18 and
Equation (17)) is deﬁned by a CYC composition:
N = CYC(A)
=⇒
N(z) =
∞
X
k=1
ϕ(k)
k
log
1
1 −2zk .
The series starts as (EIS A000031)
N(z) = 2z + 3z2 + 4z3 + 6z4 + 8z5 + 14z6 + 20z7 + 36z8 + 60z9 + · · · ,
and the OGF can be expanded:
(50)
Nn = 1
n
X
k | n
ϕ(k)2n/k.
It turns out that Nn = Dn + 1 where Dn is the wheel count, p. 45. [The connection is
easily explained combinatorially: start from a wheel and repaint in white all the nodes
that are not on the basic circle; then fold them onto the circle.] The same argument
proves that the number of necklaces over an m-ary alphabet is obtained by replacing 2
by m in (50).

I. 5. TREE STRUCTURES
61
 I.34. Finite languages. Viewed as a combinatorial object, a ﬁnite language λ is a set of
distinct words, with size being the total number of letters of all words in λ. For a binary
alphabet, the class of all ﬁnite languages is thus
FL = PSET(SEQ≥1(A))
=⇒
FL(z) = exp
0
@X
k≥1
(−1)k−1
k
2zk
1 −2zk
1
A .
The series is (EIS A102866) 1 + 2z + 5z2 + 16z3 + 42z4 + 116z5 + 310z6 + · · · .

I. 5. Tree structures
This section is concerned with basic tree enumerations. Trees are, as we saw
already, the prototypical recursive structure. The corresponding speciﬁcations nor-
mally lead to nonlinear equations (and systems of such equations) over generating
functions. The Lagrange inversion theorem is useful in solving the simplest category
of problems. The functional equations furnished by the symbolic method are then
conveniently exploited by the asymptotic theory of Chapters VI and VII. A certain
type of analytic behaviour appears to be universal in trees, namely a √–singularity;
accordingly, as we shall see, most trees families occurring in the combinatorial world
have counting sequences obeying an asymptotic form C Ann−3/2 that widely extends
what we know already for Catalan numbers (p. 36).
I. 5.1. Plane trees. Trees are commonly deﬁned as undirected acyclic connected
graphs. In additions, the trees considered in this book are, unless speciﬁed otherwise,
rooted. In this subsection, we focus attention on plane trees, also sometimes called
ordered trees, where subtrees dangling from a node are ordered between themselves.
Alternatively, these trees may be viewed as abstract graph structures accompanied by
an embedding into the plane (see APPENDIX A: Tree concepts, p. 681 and[306, §2.3]).
They are precisely described in terms of a sequence construction.
First, consider the class G of general plane trees where all node degrees are al-
lowed (this repeats p. 33): we have
(51)
G = Z × SEQ(G)
=⇒
G(z) =
z
1 −G(z),
and, accordingly, G(z) = 1 −√1 −4z
2
, so that the number of general trees of size n
is a Catalan number:
Gn = Cn−1 = 1
n
2n −2
n −1

= (2n −2)!
n! (n −1)!.
Many classes of trees deﬁned by all sorts of constraints on properties of nodes
appear to be of interest in combinatorics and in related areas like logic and computer
science. Let Ωbe a subset of the integers that contains 0. Deﬁne the class T Ωof
Ω-restricted trees as formed of trees such that the outdegrees of nodes are constrained
to lie in Ω. In what follows, an essential rˆole is played by a characteristic function that
encapsulates Ω,
φ(u) :=
X
ω∈Ω
uω.

62
I. UNLABELLED STRUCTURES AND ORDINARY GENERATING FUNCTIONS
Thus, Ω= {0, 2} determines binary trees, where each node has either 0 or 2 de-
scendants, and φ(u) = 1 + u2; the choices Ω= {0, 1, 2} and Ω= {0, 3} determine
respectively unary-binary trees (φ(u) = 1+u+u2) and ternary trees (φ(u) = 1+u3);
the case of general trees corresponds to Ω= Z≥0 and φ(u) = (1 −u)−1.
Proposition I.5. The ordinary generating function T Ω(z) of the class T Ωof Ω-
restricted trees is determined implicitly by the equation
T Ω(z) = z φ(T Ω(z)),
where φ is the characteristic of Ω, namely φ(u) := P
ω∈Ωuω. The tree counts are
given by
(52)
T Ω
n ≡[zn]T Ω(z) = 1
n [un−1]φ(u)n.
PROOF. Clearly, for Ω-restricted sequences, we have
A = SEQΩ(B)
A(z) = φ(B(z)),
so
T Ω= Z × SEQΩ(T Ω)
=⇒
T Ω(z) = zφ(T Ω(z)).
This shows that T ≡T Ωis related to z by functional inversion:
z =
T
φ(T ).
The Lagrange Inversion Theorem precisely provides expressions for such a case (see AP-
PENDIX A: Lagrange Inversion, p. 677):
Lagrange Inversion Theorem. The coefﬁcients of an inverse function and
of all its powers are determined by coefﬁcients of powers of the direct func-
tion: if z = T/φ(T ), then
[zn]T (z) = 1
n[wn−1]φ(w)n,
[zn]T (z)k = k
n[wn−k]φ(w)n.
The theorem immediately implies (52).
□
The statement extends trivially to the case where Ωis a multiset of integers, that
is, a set of integers with repetitions allowed. For instance, Ω= {0, 1, 1, 3} corre-
sponds to unary-ternary trees with two types of unary nodes, say, having one of two
colours; in this case, the characteristic is φ(u) = u0 + 2u1 + u3. The theorem gives
back the enumeration of general trees, where φ(u) = (1 −u)−1, by way of the bino-
mial theorem applied to (1−u)−n. In general, it implies that, whenever Ωcomprises r
elements, Ω= {ω1, . . . , ωr}, the tree counts are expressed as an (r −1)-fold summa-
tion of binomial coefﬁcients (use the multinomial expansion). An important special
case detailed below is when Ωhas only two elements.
 I.35. Forests. Consider ordered k-forests of trees deﬁned by F = SEQk{T }. The B¨urmann
form of Lagrange inversion implies
[zn]F(z) ≡[zn]T(z)k = k
n[un−k] φ(u)n.

I. 5. TREE STRUCTURES
63
In particular, one has for forests of general trees (φ(u) = (1 −u)−1):
[zn]
„1 −√1 −4z
2
«k
= k
n
 
2n −k −1
n −1
!
;
the coefﬁcients are also known as “ballot numbers”.

EXAMPLE I.13. “Regular” (t-ary) trees. A tree is said to be t-regular or t-ary if Ωconsists
only of the elements {0, t}. In other words, all internal nodes have degree t exactly, hence the
name (Figure 11). Let A := T {0,t}. In an element of A, a node is either terminal or it has
exactly t children. In this case, the characteristic is φ(u) = 1 + ut and the binomial theorem
combined with the Lagrange inversion formula gives
An
=
1
n [un−1] (1 + ut)n
=
1
n
 
n
n−1
t
!
provided n ≡1 mod t.
As the formula shows, only trees of total size of the form n = tν + 1 exist (a well-known fact
otherwise easily checked by induction), and
(53)
Atν+1 =
1
tν + 1
 
tν + 1
ν
!
=
1
(t −1)ν + 1
 
tν
ν
!
.
A particular rˆole is played by 2-regular trees known as binary trees. Then a form equivalent
to (53) reads:
The number of plane binary trees having a total of 2ν +1 nodes (i.e., ν binary nodes
and ν + 1 external nodes) is the Catalan number Cν =
1
ν+1
`2ν
ν
´
.
In this book, we shall use B to denote the class of binary trees. Size will be freely measured,
depending on context and convenience, by recording internal, external, or all nodes.
There is a variant of the determination of (53) that avoids congruence restrictions. Let A
be the class of t-ary trees and deﬁne the class b
A of “pruned” trees as trees of A deprived of
all their external nodes. The trees in b
A now have nodes that are of degree at most t. In order
to make b
A bijectively equivalent to A , it sufﬁces to regard trees of b
A as having
`t
j
´
possible
types of nodes of degree j for any j ∈[0, t]: each node type in b
A plainly encodes which of the
original t −j subtrees have been pruned. The equations above immediately generalize to the
case of an Ωwith multiplicities. One ﬁnds bφ(u) = (1 + u)t and b
A(z) = z bφ( b
A(z)), so that, by
Lagrange inversion,
b
Aν = 1
ν
 
tν
ν −1
!
,
yet another equivalent form of (53), since, by basic combinatorics, b
Aν = Atν+1. END OF EXAMPLE I.13. □
 I.36. Motzkin numbers. Let M(z) be the generating function for unary-binary trees (Ω=
{0, 1, 2}):
M(z) = z(1 + M(z) + M(z)2)
=⇒
M(z) = 1 −z −
√
1 −2z −3z2
2z
.
One has M(z) = z + z2 + 2 z3 + 4 z4 + 9 z5 + 21 z6 + 51 z7 + · · · . The coefﬁcients
Mn = [zn]M(z) are given in Lagrange form as
Mn = 1
n
X
k
 
n
k
! 
n −k
k −1
!
,

64
I. UNLABELLED STRUCTURES AND ORDINARY GENERATING FUNCTIONS
FIGURE I.11.
A general tree of G51 (left) and a binary tree of T {0,2}
51
(right) drawn
uniformly at random amongst the C50 and C25 possible trees respectively, with Cn =
1
n+1
`2n
n
´
the nth Catalan number.
and called Motzkin numbers (EIS A001006).

 I.37. Yet another variant of t-ary trees. Let e
A be the class of t-ary trees, but with size now
deﬁned as the number of external nodes (leaves). Then, one has
e
A = Z + SEQt( e
A).
The binomial form of e
An follows from Lagrange inversion, since e
A = z/(1 −e
At−1).

EXAMPLE I.14.
Hipparchus of Rhodes and Schr¨oder.
In 1870, the German mathematician
Ernst Schr¨oder (1841–1902) published a paper entitled Vier combinatorische Probleme. The
paper had to do with the number of terms that can be built out of n variables using nonasso-
ciative operations. In particular, the second of his four problems asks for the number of ways
a string of n identical letters, say x, can be “bracketted”. The rule is best stated recursively:
x itself is a bracketting and if σ1, σ2, . . . , σk with k ≥2 are bracketted expressions, then the
k-ary product (σ1)(σ2) · · · (σk) is a bracketting.
Let S denote the class of all brackettings, where size is the number of variables. Then, the
recursive deﬁnition is readily translated into the formal speciﬁcation
(54)
S = Z + SEQ≥2(S),
Z = {x}.
To each bracketting of size n is associated a tree whose external nodes contain the variable x
(and determine size), with internal nodes corresponding to brackettings and having degree at
least 2 (while not contributing to size). The functional equation satisﬁed by the OGF is then
(55)
S(z) = z +
S(z)2
1 −S(z).
This is not a priori of the type corresponding to Proposition I.5 because not all nodes contribute
to size in this particular application. However, the quadratic equation induced by (55) can be
solved, giving
S(z)
=
1
4
“
1 + z −
p
1 −6z + z2
”
=
z + z2 + 3z3 + 11z4 + 45z5 + 197z6 + 903z7 + 4279z8 + 20793z9
+ 103049z10 + 518859z11 + · · · ,
where the coefﬁcients are EIS A001003. (These numbers also count series-parallel networks of
a speciﬁed type (e.g., serial in Figure 12, bottom), where placement in the plane matters.)
In an instructive paper, Stanley [448] discusses a page of Plutarch’s Moralia where there
appears the following statement:

I. 5. TREE STRUCTURES
65
(x1) ∧(x2 ∨(x3 ∧x4 ∧x5) ∨x6) ∧((x7 ∧x8) ∨(x9 ∧x10))
∧
x1
∨
∨
x2
∧
x6
x3
x4
x5
∧
∧
x7
x8
x9
x10
-
x1
x3
x4
x5
x2
x6
x7
x8
x9
x10
-
FIGURE I.12. An and–or positive proposition of the conjunctive type (top), its associ-
ated tree (middle), and an equivalent planar series-parallel network of the serial type (bot-
tom).
“Chrysippus says that the number of compound propositions that can be made from
only ten simple propositions exceeds a million. (Hipparchus, to be sure, refuted this
by showing that on the afﬁrmative side there are 103,049 compound statements, and
on the negative side 310,952.)”
It is notable that the tenth number of Hipparchus of Rhodes9 (c. 190–120B.C.) is precisely
S10 = 103, 049. This is, for instance, the number of logical formulae that can be formed from
ten boolean variables x1, . . . , x10 (used once each and in this order) using and–or connectives
in alternation (no “negation”), upon starting from the top in some conventional fashion (e.g,
with an and-clause); see Figure 1210. Hipparchus was naturally not cognizant of generating
functions, but with the technology of the time (and a rather remarkable mind!), he would still
be able to discover a recurrence equivalent to (55),
(56)
Sn = [[n ≥2]]
0
@
X
n1+···+nk=n
Sn1Sn2 · · · Snk
1
A + [[n = 1]],
where the sum has only 42 essentially different terms for n = 10 (see [448] for a discussion),
and ﬁnally determine S10. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE I.14. □
 I.38. The Lagrangean form of Schr¨oder’s GF. The generating function S(z) admits the form
S(z) = zφ(S(z))
where
φ(y) = 1 −y
1 −2y
9This was ﬁrst observed by David Hough in 1994; see [448]. In [256], Habsieger et al. further note
that 1
2 (S10 + S11) = 310, 954, and suggest a related interpretation (based on negated variables) for the
other count given by Hipparchus.
10Any functional term admits a unique tree representation. Here, as soon as the root type has been
ﬁxed (e.g., an ∧connective), the others are determined by level parity. The constraint of node degrees ≥2
in the tree means that no superﬂuous connectives are used. Finally, any monotone boolean expression can
be represented by a series-parallel network: the xj are viewed as switches with the true and false values
being associated with closed and open circuits, respectively.

66
I. UNLABELLED STRUCTURES AND ORDINARY GENERATING FUNCTIONS
Tree variety
1 2 3 4
5
6
7
8
n
+∞
Plane gen.
G = Z × SEQ(G)
1 1 2 5 14 42 132 429
1
n
`2n−2
n−1
´
∼4n−1/
√
πn3
Plane bin.
T = Z + SEQ2(T )
1 1 2 5 14 42 132 429
1
n
`2n−2
n−1
´
∼4n−1/
√
πn3
Unord. gen. H = Z × MSET(H)
1 1 2 4
9
20
48
115
−
∼λ · βn/n3/2
Unord. bin.
U = Z + MSET2(U) 1 1 1 2
3
6
11
23
−
λ2 · βn
2 /n3/2
FIGURE I.13. The number of rooted trees of type plane/unordered and general/binary
for n = 1 . . 8 and the corresponding asymptotic forms. There, λ
.= 0.43992, β
.=
2.95576 for unordered general (EIS A000081); λ2 .= 0.31877, β2 .= 2.48325 for un-
ordered binary. For binary trees (EIS A001190), size is, by convention here, the number of
external nodes.
is the OGF of compositions. Consequently, one has
Sn
=
1
n[un−1]
„ 1 −u
1 −2u
«n
=
(−1)n−1
n
X
k
(−2)k
 
n
k + 1
! 
n + k −1
k
!
=
1
n
n−2
X
k=0
 
2n −k −2
n −1
! 
n −2
k
!
.
Is there a direct combinatorial relation to compositions?

 I.39. Faster determination of Schr¨oder numbers. By forming a differential equation satisﬁed
by S(z) and extracting coefﬁcients, one obtains a recurrence
(n + 2)Sn+2 −3(2n + 1)Sn+1 + (n −1)Sn = 0,
n ≥1,
that entails a fast determination (in linear time) of the Sn. In contrast, Hipparchus’s recurrence
implies an algorithm of complexity eO(√n) in the number of arithmetic operations involved. 
I. 5.2. Nonplane trees. An unordered tree, also called nonplane tree, is a tree
in the general graph–theoretic sense, so that there is no order distinction between
subtrees emanating from a common node. The unordered trees considered here are
furthermore rooted, meaning that one of the nodes is distinguished as the root. Ac-
cordingly, in the language of constructible structures, a rooted unordered tree is a root
node linked to a multiset of trees. Thus, the class H of all unordered trees, admits the
recursive speciﬁcation:
H = Z × MSET(H)
=⇒







H(z) = z
∞
Y
m=1
(1 −zm)−Hm
= z exp
 H(z) + 1
2H(z2) + 1
3H(z3) + · · ·

.
The ﬁrst form of the OGF was given by Cayley in 1857 [54, p. 43]; it does not ad-
mit a closed form solution, though the equation permits one to determine all the Hn
recursively (EIS A000081)
H(z) = z + z2 + 2z3 + 4z4 + 9z5 + 20z6 + 48z7 + 115z8 + 286z9 + · · · .

I. 5. TREE STRUCTURES
67
In addition, the local analysis of the singularities of H(z) yields a bona ﬁde asymptotic
expansion for Hn, a fact ﬁrst discovered by P´olya [397] who proved that
(57)
Hn ∼λ · βn
n3/2 ,
for some positive constants λ .= 0.43992 and β .= 2.95576. The “universality” in tree
enumerations of such estimates, of the form Ann−3/2 is a major theme of Chapter VII.
 I.40. Fast determination of the Cayley–P´olya numbers. Logarithmic differentiation of the
equation satisﬁed by H(z) provides for the Hn a recurrence that permits one to compute Hn
in time polynomial in n. (Note: a similar technique applies to the partition numbers Pn; see
p. 40.)

The enumeration of the class of trees deﬁned by an arbitrary set Ωof node degrees
immediately results from the translation of sets of ﬁxed cardinality.
Proposition I.6. Let Ω⊂N be a ﬁnite set of integers containing 0. The OGF U(z) of
nonplane trees with degrees constrained to lie in Ωsatisﬁes a functional equation of
the form
(58)
U(z) = zΦ(U(z), U(z2), U(z3), . . .),
for some computable polynomial Φ.
PROOF. The class of trees satisﬁes the combinatorial equation,
U = Z × MSETΩ(U)
 
MSETΩ(U) ≡
X
ω∈Ω
MSETω(U)
!
,
where the multiset construction reﬂects non-planarity, since subtrees stemming from
a node can be freely rearranged between themselves and may appear repeated. Theo-
rem I.3 (p. 78) provides the translation of MSETk(U):
Φ(U(z), U(z2), U(z3), . . .) =
X
ω∈Ω
[uω] exp
u
1 U(z) + u2
2 U(z2) + · · ·

.
The result follows.
□
Once more, there are no explicit formulae but only functional equations implicitly
determining the generating functions. However, as we shall see in Chapter VII, the
equations may be used to analyse the dominant singularity of U(z). It is found that a
“universal” law governs the singularities of simple tree generating functions that are
of the type
p
1 −z/ρ, corresponding to a general asymptotic scheme (see Figure 13),
(59)
U Ω
n ∼λΩ
(βΩ)n
√
n3 .
Many of these questions have their origin in combinatorial chemistry, starting with
Cayley in the 19th century [54, Ch. 4]. P´olya reexamined these questions, and in
his important paper published in 1937 [395] he developed at the same time a general
theory of combinatorial enumerations under group actions and of asymptotics methods
giving rise to estimates like (59). See the book by Harary and Palmer [259] for more
on this topic or Read’s edition of P´olya’s paper [397].

68
I. UNLABELLED STRUCTURES AND ORDINARY GENERATING FUNCTIONS
 I.41. Binary nonplane trees. Unordered binary trees with size measured by the number of
external nodes are described by the equation U = Z + MSET2(U). The functional equation
determining U(z) is
(60)
U(z) = z + 1
2U(z)2 + 1
2U(z2);
U(z) = z + z2 + z3 + 2z4 + 3z5 + · · · .
The asymptotic analysis of the coefﬁcients (EIS A001190) was carried out by Otter [382] who
established an estimate of type (59). (The values of the constants are summarized in Figure 13.)
The quantity Un is also the number of structurally distinct products of n elements under a
commutative nonassociative binary operation.

 I.42. Hierarchies. Deﬁne the class K of hierarchies to be trees without nodes of outdegree 1
and size determined by the number of external nodes. The corresponding OGF satisﬁes (Cayley
1857, see [54, p.43])
K(z) = 1
2z + 1
2
»
exp
„
K(z) + 1
2K(z2) + · · ·
«
−1
–
,
from which the ﬁrst values are found (EIS A000669)
K(z) = z + z2 + 2z3 + 5z4 + 12z5 + 33z6 + 90z7 + 261z8 + 766z9 + 2312z10 + · · · .
These numbers also enumerate hierarchies in statistical classiﬁcation theory [475]. They are the
non-planar analogues of the Hipparchus–Schr¨oder’s numbers on p. 64.

 I.43. Nonplane series-parallel networks. Consider the class SP of series-parallel networks
as previously considered in relation to Hipparchus of Rhodes’ example, p. 65, but ignoring
planar embeddings. Thus, all parallel arrangements of the (serial) networks s1, . . . , sk are con-
sidered equivalent, while the linear arrangement in each serial network matters. For instance,
for n = 2, 3:
-o--o- |-o-|
-o--o--o-
|-o-| |-o-o-| -o--|-o-|- -|-o-|--o-
|-o-|
|-o-| |--o--|
|-o-|
|-o-|
|-o-|
Thus, SP2 = 2 and SP3 = 5. This is modelled by the grammar:
S = Z + SEQ≥2(P),
P = Z + MSET≥2(S),
and, to avoid counting networks of one element twice,
SP(z) = S(z)+P(z)−z = z +2z2 +5z3 +15z4 +48z5 +167z6 +602z7 +2256z8 +· · · .
This is EIS A003430. The objects are usually described as networks of electric resistors.

I. 5.3. Related constructions. Trees underlie recursive structures of all sorts. A
ﬁrst illustration is provided by the fact that the Catalan numbers, Cn =
1
n+1
 2n
n

count general trees (G) of size n + 1, binary trees (B) of size n (if size is deﬁned as
the number of internal nodes), as well as triangulations (T ) comprised of n triangles.
The combinatorialist John Riordan even coined the name Catalan domain for the area
within combinatorics that deals with objects enumerated by Catalan numbers, and
Stanley’s book contains an exercise [449, Ex. 6.19] whose statement alone spans ten
full pages, with a list of 66 types of objects(!) belonging to the Catalan domain. We
shall illustrate the importance of Catalan numbers by describing a few fundamental
correspondences that explain the occurrence of Catalan numbers in several areas of
combinatorics.

I. 5. TREE STRUCTURES
69
Rotation of trees. The combinatorial isomorphism relating G and B (albeit with
a shift in size) coincides with a classical technique of computer science [306, §2.3.2].
To wit, a general tree can be represented in such a way that every node has two types
of links, one pointing to the leftmost child, the other to the next sibling in left-to-right
order. Under this representation, if the root of the general tree is left aside, then every
node is linked to two other (possibly empty) subtrees. In other words, general trees
with n nodes are equinumerous with pruned binary trees with n −1 nodes:
Gn ∼= Bn−1.
Graphically, this is illustrated as follows:
The rightmost tree is a binary tree drawn in a conventional manner, following a 45◦
tilt. This justiﬁes the name of “rotation correspondence” often given to this transfor-
mation.
Tree decomposition of triangulations. The relation betwen binary trees B and
triangulations T is equally simple: draw a triangulation; deﬁne the root triangle as
the one that contains the edge connecting two designated vertices (for instance, the
vertices numbered 0 and 1); associate to the root triangle the root of a binary tree;
next, associate recursively to the subtriangulation on the left of the root triangle a left
subtree; do similarly for the right subtriangulation giving rise to a right subtree.
Under this correspondence, tree nodes correspond to triangle faces, while edges con-
nect adjacent triangles. What this correspondence proves is the combinatorial isomor-
phism
Tn ∼= Bn.

70
I. UNLABELLED STRUCTURES AND ORDINARY GENERATING FUNCTIONS
We turn next to another type of objects that are in correspondence with trees.
These can be interpreted as words encoding tree traversals and, geometrically, as paths
in the discrete plane Z × Z.
Tree codes and Łukasiewicz words. . Any tree can be traversed starting from
the root, proceeding depth-ﬁrst (and left-to-right), and backtracking upwards once a
subtree has been completely traversed. For instance, in the tree
(61)
τ =
a
b
c
d
e
f
g
h
i
j
the ﬁrst visits to nodes take place in the following order
a,
b,
d,
h,
e,
f,
c,
g,
i,
j .
(Note: the tags a, b, . . . added for convenience in order to distinguish nodes have no
special meaning; only the abstract tree shape matters here.) This order is known as
preorder or preﬁx order since a node is preferentially visited before its children.
Given a tree, the listing of the outdegrees of nodes in preﬁx order will be called
the preorder degree sequence. For the tree of (61), this is
σ = (2, 3, 1, 0, 0, 0, 1, 2, 0, 0).
It is a fact that the degree sequence determines the tree unambiguously. Indeed, given
the degree sequence, the tree is reconstructed step by step, adding nodes one after the
other at the leftmost available place. For σ, the ﬁrst steps are then
+2
+3
+1
+0
+0
Next, if one represents degree j by a “symbol” fj, then the degree sequence becomes
a word over the inﬁnite alphabet F = {f0, f1, . . .}, for instance,
σ ; f2f3f1f0f0f0f1f2f0f0.
This can be interpreted in logical language as a denotation for a functional term built
out symbols from F, where fj represents a function of degree (or “arity”) j. The

I. 5. TREE STRUCTURES
71
correspondence even becomes obvious if superﬂuous parentheses are added at appro-
priate place to delimitate scope:
σ ; f2(f3(f1(f0), f0, f0), f1(f2(f0, f0))).
Such codes are known as Łukasiewicz codes11, in recognition of the work of the
Polish logician with that name. Jan Łukasiewicz (1878–1956) introduced them in
order to completely specify the syntax of terms in various logical calculi; they prove
nowadays basic in the development of parsers and compilers in computer science.
Finally, a tree code can be rendered as a walk over the discrete lattice Z × Z.
Associate to any fj (i.e., any node of outdegree j) the displacement (1, j−1) ∈Z×Z,
and plot the sequence of moves starting from the origin. On the example one ﬁnds:
f2
f3
f1
f0
f0
f0
f1
f2
f0
f0
1
2
0
−1 −1 −1
0
1
−1 −1
There, the last line represents the vertical displacements. The resulting paths are
known as Łukasiewicz paths. Such a walk is then characterized by two conditions:
the vertical displacements are in the set {−1, 0, 1, 2, . . .}; all its points, except for the
very last step, lie in the upper half-plane.
By this correspondence, the number of Łukasiewicz paths with n steps is the
shifted Catalan number, 1
n
 2n−2
n−1

.
 I.44. Conjugacy principle and cycle lemma.
Let L be the class of all Łukasiewicz paths.
Deﬁne a “relaxed” path as one that starts at level 0, ends at level −1 but is otherwise allowed
arbitrary negative steps; let M be the corresponding class. Then, each relaxed path can be
cut-and-pasted uniquely after its leftmost minimum as described here:
This associates to every relaxed path of length ν a unique standard path. A bit of combinatorial
reasoning shows that correspondence is 1-to-ν (each element of L has exactly ν preimages.)
One thus has Mν = νLν. This correspondence preserves the number of steps of each type
(f0, f1, . . .), so that the number of Łukasiewicz paths with νj steps of type fj is
1
ν [x−1uν0
0 uν1
1 · · · ]
`
x−1u0 + u1 + xu2 + x2u3 + · · ·
´ν = 1
ν
 
ν
ν0, ν1, . . .
!
,
11A less digniﬁed name is “Polish preﬁx notation”. The “reverse Polish notation” is a variant based
on postorder that has been used in some calculators since the 1970’s.

72
I. UNLABELLED STRUCTURES AND ORDINARY GENERATING FUNCTIONS
under the necessary condition (−1)ν0 + 0ν1 + 1ν2 + 2ν3 + · · · = −1. This combinatorial way
of obtaining reﬁned Catalan statistics is known as the conjugacy principle [407] or the cycle
lemma [98, 121, 145]. Raney has derived from it a purely combinatorial proof of the Lagrange
inversion formula [407] while Dvoretzky & Motzkin [145] have employed this technique to
solve a number of counting problems related to circular arrangements.

EXAMPLE I.15.
Binary tree codes and Dyck paths. Walks associated with binary trees have
a very special form since the vertical displacements can only be +1 or −1. The resulting
paths of Łukasiewicz type are then equivalently characterized as sequences of numbers x =
(x0, x1, . . . , x2n, x2n+1) satisfying the conditions
(62)
x0 = 0;
xj ≥0
for 1 ≤j ≤2n;
|xj+1 −xj| = 1;
x2n+1 = −1.
These coincide with “gambler ruin sequences”, a familiar object from probability theory: a
player plays head and tails. He starts with no capital (x0 = 0) at time 0; his total gain is xj at
time j; he is allowed no credit (xj ≥0) and loses at the very end of the game x2n+1 = −1; his
gains are ±1 depending on the outcome of the coin tosses (|xj+1 −xj| = 1).
It is customary to drop the ﬁnal step and consider “excursions’ that take place in the upper
half-plane. The resulting objects deﬁned as sequences (x0 = 0, x1, . . . , x2n = 0) satisfying
the ﬁrst three conditions of (62) are known in combinatorics as Dyck paths12. By construc-
tion, Dyck paths of length 2n correspond bijectively to binary trees with n internal nodes and
are consequently enumerated by Catalan numbers. Let D be the combinatorial class of Dyck
paths, with size deﬁned as length. This property can also be checked directly: the quadratic
decomposition
(63)
=
+
(ε)
D
D
D
D
=
{ǫ} + (ր D ց) × D
=⇒
D(z)
=
1 + (zD(z)z) D(z).
From this OGF, the Catalan numbers are found (as expected): D2n =
1
n+1
`2n
n
´
. The decom-
position (63) is known as the “ﬁrst passage” decomposition as it is based on the ﬁrst time the
cumulated gains in the coin-tossing game pass through the value zero.
Dyck paths also arise in connection will well-parenthetized expressions. These are rec-
ognized by keeping a counter that records at each stage the excess of the number of opening
brackets ‘(’ over closing brackets ‘)’. Finally, one of the origins of Dyck path is the famous
ballot problem, which goes back to the nineteenth century [346]: there are two candidates A
and B that stand for election, 2n voters, and the election eventually results in a tie; what is the
probability that A is always ahead of or tied with B when the ballots are counted? The answer
is
D2n
`2n
n
´ =
1
n + 1,
since there are
`2n
n
´
possibilities in total, of which the number of favorable cases is D2n, a
Catalan number. The central rˆole of Dyck paths and Catalan numbers in problems coming from
such diverse areas is quite remarkable. Section V. 3, p. 295 presents reﬁned counting results
regarding lattice paths (e.g., the analysis of height) and Subsection VII. 8.1, p. 482 introduces
12Dyck paths are closely associated with free groups on one generator and are named after the German
mathematician Walther (von) Dyck (1856–1934) who introduced free groups around 1880.

I. 5. TREE STRUCTURES
73
exact and asymptotic results in the harder case of an arbitrary ﬁnite collection of step types (not
just ±1).
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE I.15. □
 I.45. Dyck paths, parenthesis systems, and general trees. The class of Dyck paths admits an
alternative sequence decomposition
(64)
=
D
D
D
D
D
=
SEQ(Z × D × Z),
which again leads to the Catalan GF. The decomposition (64) is known as the “arch decom-
position” (see Subsection V. 3.1, p. 296, for more). It can also be directly related to traversal
sequences of general trees, but with the directions of edge traversals being recorded (instead of
traversals based on node degrees): fo a general tree τ, deﬁne its encoding κ(τ) over the binary
alphabet {ր, ց} recursively by the rules:
κ(τ) = ǫ,
κ(•(τ1, . . . , τr)) =ր κ(τ1) · · · κ(τr) ց .
This is the classical representation of trees by a parenthesis system (interpret ‘ր’ and ‘ց’ as
‘(’ and ‘)’, respectively), which associates to a tree of n nodes a path of length 2n −2.

 I.46. Random generation of Dyck paths. Dyck paths of length 2n can be generated uniformly
at random in time linear in n. (Hint: By Note 44, it sufﬁces to generate uniformly a sequence
of n a’s and n + 1 b’s, then reorganize it according to the conjugacy principle.)

 I.47. Excursions, bridges, and meanders. Adapting a terminology from probability theory,
one sets the following deﬁnitions: (i) a meander (M) is a word over {−1, +1}, such that the
sum of the values of any of its preﬁxes is always a nonnegative integer; (ii) a bridge (B) is a
word whose values of letters sum to 0. Thus a meander represents a walk that wanders in the
ﬁrst quadrant; a bridge, regarded as a walk, may wander above and below the horizontal line,
but its ﬁnal altitude is constrained to be 0; an excursion is both a meander and a bridge. Simple
decompositions provide
M(z) =
D(z)
1 −zD(z),
B(z) =
1
1 −2z2D(z),
implying Mn =
`
n
⌊n/2⌋
´
[EIS A001405] and B2n =
`2n
n
´
[EIS A000984].

 I.48. Motzkin paths and unary-binary trees.
Motzkin paths are deﬁned by changing the
third condition of (62) deﬁning Dyck paths into |xj+1 −xj| ≤1. They appear as codes for
unary-binary trees and are enumerated by the Motzkin numbers of Note 36.

EXAMPLE I.16.
The complexity of boolean functions.
Complexity theory provides many
surprising applications of enumerative combinatorics and asymptotic estimates. In general, one
starts with a ﬁnite set of mathematical objects Ωand a combinatorial class D of descriptions.
By assumption, to every object of δ ∈D is associated an element µ(δ) ∈Ω, its “meaning”;
conversely any object of Ωadmits at least one description in D, that is, the function µ is surjec-
tive. It is then of interest to quantify properties of the shortest description function deﬁned for
ω ∈Ωas
σ(ω) := min
˘
|δ|D
˛˛ µ(δ) = ω
¯
,
and called the complexity of element of Ω(with respect to D).
We take here Ωto be the class of all boolean functions on m variables. Their number is
||Ω|| = 22m. As descriptions, we adopt the class of logical expressions involving the logical
connectives ∨, ∧and pure or negated variables. Equivalently, D is the class of binary trees,

74
I. UNLABELLED STRUCTURES AND ORDINARY GENERATING FUNCTIONS
where internal nodes are tagged by a logical disjunction (‘∨’) or a conjunction (‘∧’), and each
external node is tagged by either a boolean variable of {x1, . . . , xm} or a negated variable of
{¬x1, . . . , ¬xm}. Deﬁne the size of a tree description as the number of internal nodes, that is,
the number of logical operators. Then, one has
(65)
Dn =
 
1
n + 1
 
2n
n
!!
· 2n · (2m)n+1,
as seen by counting tree shapes and possibilities for internal as well as external node tags.
The crux of the matter is that if the inequality
(66)
ν
X
j=0
Dj < ||Ω||,
holds, then there are not enough descriptions of size ≤ν to exhaust Ω. In other terms, there
must exist at least one object in Ωwhose complexity exceeds ν. If the left side of (66) is
much smaller than the right side, then, it must even be the case that “most” Ω-objects have a
complexity that exceeds ν.
In the case of boolean functions and tree descriptions, the asymptotic form (24) is available.
There results from (65) that, for n, ν getting large, one has
Dn = O(16nmnn−3/2),
ν
X
j=0
Dj = O(16νmνν−3/2).
Choose ν such that the second expression is o(||Ω||). This is ensured for instance by taking for
ν the value
ν(m) :=
2m
4 + log2 m,
as veriﬁed by a simple asymptotic calculation. With this choice, one has the following sugges-
tive statement:
A fraction tending to 1 (as m →∞) of boolean functions in m variables have tree
complexity at least 2m/ log2 m.
Regarding upper bounds on boolean function complexity, a function always has a tree
complexity that is at most 2m+1 −3. To see it, note that for m = 1, the 4 functions are
0 ≡(x1 ∧¬x1),
1 ≡(x1 ∨¬x1),
x1,
¬x1.
Next, a function of m variables is representable by a technique known as the binary decision
tree (BDT),
f(x1, . . . , xm−1, xm) = (¬xm ∧f(x1, . . . , xm−1, 0)) ∨(xm ∧f(x1, . . . , xm−1, 1)) ,
which provides the basis of the induction as it reduces the representation of an m-ary func-
tion to the representation of two (m −1)-ary functions, consuming on the way three logical
connectives.
Altogether, basic counting arguments have shown that “most” boolean functions have
a tree-complexity that is “close” to the maximum possible, namely, O(2m). A similar re-
sult has been established by Shannon for the measure called circuit complexity: circuits are
more powerful than trees, but Shannon’s result states that almost all boolean functions of m
variables have circuit complexity O(2m/m).
See [481], especially the chapter by Li and
Vit´anyi, for a discussion of such counting techniques within the framework of complexity the-
ory. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE I.16. □

I. 5. TREE STRUCTURES
75
I. 5.4. Context-free speciﬁcations and languages. Many of the combinatorial
examples encountered so far in this section can be organized into a common frame-
work, which is fundamental in formal linguistics and theoretical computer science.
Deﬁnition I.13. A class C is said to be context-free if it coincides with the ﬁrst com-
ponent (T = S1) of a system of equations
(67)









S1
=
Φ1(Z, S1, . . . , Sr)
...
...
...
Sr
=
Φr(Z, S1, . . . , Sr),
where each Φj is a constructor that only involves the operations of combinatorial sum
(+) and cartesian product (×), as well as the neutral class, E = {ǫ}.
A language L is said to be an unambiguous context-free language if it is combi-
natorially isomorphic to a context-free variety of trees: C ∼= T .
The classes of general trees (G) and binary trees (B) are context-free, since they
are speciﬁable as



G
=
Z × F
F
=
{ǫ} + (G × F)
,
B = Z + (B × B).
(F designates ordered forests of general trees.) Context-free speciﬁcations may be
used to describe all sorts of combinatorial objects. For instance, the class T of trian-
gulations of convex polygons is speciﬁed symbolically by
(68)
T = ∇+ (∇× T ) + (T × ∇) + (T × ∇× T ),
where ∇represents a generic triangle. The Łukasiewicz language and the set of Dyck
paths are context-free classes since they are bijectively equivalent to G and T .
The term “context-free” comes from linguistics: it stresses the fact that objects
can be “freely” generated by the rules of (67), this without any constraints imposed
by an outside context13. There, one clasically deﬁnes a context-free language as the
language formed with words that are obtained as sequences of leaf tags (read in left-
to-right order) of a context-free variety of trees. In formal linguistics, the one-to-one
mapping between trees and words is not generally imposed; when it is satisﬁed, the
context-free language is said to be unambiguous; then, words and trees determine each
other uniquely, cf Note 50 below.
An immediate consequence of admissibility theorems is the following proposition
ﬁrst encountered by Chomsky and Sch¨utzenberger [89] in the course of their research
relating formal languages and formal power series:
13Formal language theory also deﬁnes context-sensitive grammars where each rule (called a produc-
tion) is applied only if it is enabled by some external context. Context-sensitive grammars have greater
expressive power than context-free ones, but they depart signiﬁcantly from decomposability and are sur-
rounded by strong undecidability properties. Accordingly context-sensitive grammars cannot be associated
to any global generating function formalism.

76
I. UNLABELLED STRUCTURES AND ORDINARY GENERATING FUNCTIONS
Proposition I.7. A combinatorial class C that is context-free admits an OGF that is
an algebraic function. In other words, there exists a (non-null) bivariate polynomial
P(z, y) ∈C[z, y] such that
P(z, C(z)) = 0.
PROOF. By the basic sum and product rules, the context-free system (67) translates
into a system of OGF equations,









S1(z)
=
Ψ1(z, S1(z), . . . , Sr(z))
...
...
...
Sr(z)
=
Ψr(z, S1(z), . . . , Sr(z)),
where the Ψj are the polynomials translating the constructions Φj.
It is then well-known that algebraic elimination is possible in polynomials sys-
tems. Here, it is possible to eliminate the auxiliary variables S2, . . . , Sr, one by one,
preserving the polynomial character of the system at each stage. The end result is
then a single polynomial equation satisﬁed by C(z) ≡S1(z). (Methods for effec-
tively performing polynomial elimination include a repeated use of resultants as well
as Groebner basis algorithms; see APPENDIX B: Algebraic elimination, p. 685 for a
brief discussion and references.)
□
Proposition I.7 is a counterpart of Proposition I.3 (54) according to which rational
generating functions arise from ﬁnite state devices, and it explains the importance of
algebraic functions in enumerative theory. We shall develop a general asymptotic the-
ory of coefﬁcients of algebraic functions in Chapter VII, based on singularity theory.
 I.49.“Tree-like” structures. A context-free speciﬁcation can always be regarded as deﬁning a
class of trees. Indeed, if the jth term in the construction Φi is “coloured” with the pair (i, j), it is
seen that a context-free system yields a class of trees whose nodes are tagged by pairs (i, j) in a
way consistent with the system’s rules (I.13). However, despite this correspondence, it is often
convenient to preserve the possibility of operating directly with objects when the tree aspect
is unnatural. (Some authors have developed a parallel notion of “object grammars”; see for
instance [144] itself inspired by techniques of polyomino surgery in [116].) By a terminology
borrowed from the theory of syntax analysis in computer science, such trees are referred to as
“parse trees” or “syntax trees”.

 I.50. Context-free languages.
Let A be a ﬁxed ﬁnite alphabet whose elements are called
letters. A grammar G is a collection of equations
(69)
G
:
8
>
>
<
>
>
:
L1
=
Ψ1(⃗a, L1, . . . , Lm)
...
...
Lm
=
Ψm(⃗a, L1, . . . , Lm),
where each Ψj involves only the operations of union (∪) and catenation product ( · ) with ⃗a the
vector of letters in A. For instance,
Ψ1(⃗a, L1, L2, L3) = a2 · L2 · L3 ∪a3 ∪L3 · a2 · L1.
A solution to (69) is an m-tuple of languages over the alphabet A that satisﬁes the system. By
convention, one declares that the grammar G deﬁnes the ﬁrst component, L1.
To each grammar (69), one can associate a context-free speciﬁcation (51) by transforming
unions into disjoint union, ‘∪’ 7→‘+’, and catenation into cartesian products, ‘·’ 7→‘×’. Let
bG be the speciﬁcation associated in this way to the grammar G. The objects described by bG

I. 6. ADDITIONAL CONSTRUCTIONS
77
appear in this perspective to be trees (see the discussion above regarding parse trees). Let h
be the transformation from trees of bG to languages of G that lists letters in inﬁx (i.e., left-to-
right) order: we call such an h the erasing transformation since it “forgets” all the structural
information contained in the parse tree and only preserves the succession of letters. Clearly,
application of h to the combinatorial speciﬁcations determined by bG yields languages that obey
the grammar G. For a grammar G and a word w ∈A⋆, the number of parse trees t ∈bG
such that h(t) = w is called the ambiguity coefﬁcient of w with respect to the grammar G; this
quantity is denoted by κG(w).
A grammar G is unambiguous if all the corresponding ambiguity coefﬁcients are either 0
or 1. This means that there is a bijection between parse trees of bG and words of the language
described by G: each word generated is uniquely “parsable” according to the grammar. In such
a case, the OGFs of languages satisfy a polynomial system of the form (52).

 I.51. Extended context-free speciﬁcations. If A, B are context-free speciﬁcations then: (i) the
sequence class C = SEQ(A) is context-free; (ii) the substitution class D = A[b 7→B] is also
context-free.

I. 6. Additional constructions
This section is devoted to the constructions of sequences, sets, and cycles in the
presence of restrictions on the number of components as well as to mechanisms that
enrich the framework of core constructions, namely, pointing, substitution, and the
use of implicit combinatorial deﬁnitions.
I. 6.1. Restricted constructions. An immediate formula for OGFs is that of the
diagonal ∆of a cartesian product B × B deﬁned as
A ≡∆(B × B) := {(β, β) | β ∈B}.
Then, clearly A2n = Bn so that
A(z) = B(z2).
The diagonal construction permits us to access the class of all unordered pairs of
(distinct) elements of B, which is A = PSET2(B). A direct argument then runs as
follows: the unordered pair {α, β} is associated to the two ordered pairs (α, β) and
(β, α) except when α = β, where an element of the diagonal is obtained. In other
words, one has the combinatorial isomorphism,
PSET2(B) + PSET2(B) + ∆(B × B) ∼= B × B,
meaning that
2A(z) + B(z2) = B(z)2.
The resulting translation into OGFs is thus
A = PSET2(B)
=⇒
A(z) = 1
2B(z)2 −1
2B(z2).
Similarly, for multisets, we ﬁnd
A = MSET2(B)
=⇒
A(z) = 1
2B(z)2 + 1
2B(z2),

78
I. UNLABELLED STRUCTURES AND ORDINARY GENERATING FUNCTIONS
while for cycles one has CYC2 ∼= MSET2, and
A = CYC2(B)
=⇒
A(z) = 1
2B(z)2 + 1
2B(z2).
This type of direct reasoning could be extended to treat triples, and so on, but the
computations (if not the reasoning) tend to grow out of control. An approach based
on multivariate generating functions generates simultaneously all cardinality restricted
constructions.
Theorem I.3 (Component-restricted constructions). The OGF of sequences with k
components A = SEQk(B) satisﬁes
A(z) = B(z)k.
The OGF of sets, A = PSETk(B), is a polynomial in the quantities B(z), . . . , B(zk),
A(z) = [uk] exp
u
1 B(z) −u2
2 B(z2) + u3
3 B(z3) −· · ·

.
The OGF of multisets, A = MSETk(B), is
A(z) = [uk] exp
u
1 B(z) + u2
2 B(z2) + u3
3 B(z3) + · · ·

.
The OGF of cycles, A = CYCk(B), is
A(z) = [uk]
∞
X
ℓ=1
ϕ(ℓ)
ℓ
log
1
1 −uℓB(zℓ).
The explicit forms for small values of k are summarized in Figure 14.
PROOF. The result for sequences is obvious since SEQk(B) means B × · · · × B (k
times). For the other constructions, the proof makes use of the techniques of Theo-
rem I.1, but it is best based on bivariate generating functions that are otherwise devel-
oped fully in Chapter III to which we refer for details. The idea consists in describing
all composite objects and introducing a supplementary marking variable to keep track
of the number of components.
Take K to be a construction amongst SEQ, CYC, MSET, PSET, set A = K(B),
and let χ(α) for α ∈A be the parameter “number of B–components”. Deﬁne the
multivariate quantities
An,k
:=
card

α ∈A
 |α| = n, χ(α) = k
	
A(z, u)
:=
X
n,k
An,kukzn =
X
α∈A
z|α|uχ(α).
For instance, a direct calculation shows that, for sequences, there holds
A(z, u)
=
X
k≥0
ukB(z)k
=
1
1 −uB(z).

I. 6. ADDITIONAL CONSTRUCTIONS
79
For multisets and powersets, a simple adaptation of the already seen argument gives
A(z, u) as
A(z, u) =
Y
n
(1 −uzn)−Bn,
A(z, u) =
Y
n
(1 + uzn)Bn,
respectively. The result follows from there by the exp-log transformation upon ex-
tracting [uk]A(z, u). The case of cycles results from the bivariate generating function
for cycles derived in APPENDIX A: Cycle construction, p. 674.
□
 I.52. Sets with distinct component sizes. Let A be the class of the ﬁnite sets of elements from
B, with the additional constraint that no two elements in a set have the same size. One has
A(z) =
∞
Y
n=1
(1 + Bnzn).
Similar identities serve in the analysis of polynomial factorization algorithms [186].

 I.53. Sequences without repeated components. The generating function is formally:
Z ∞
0
exp
0
@X
j≥1
(−1)j−1 uj
j A(zj)
1
A e−u du.
(This form is based on the Eulerian integral: k! =
R ∞
0
e−uuk du.)

I. 6.2. Pointing and substitution. Two more constructions, namely pointing and
substitution, translate agreeably into generating functions. Combinatorial structures
are viewed here as formed of “atoms” (words are composed of letters, graphs of nodes,
etc) which determine their sizes. In this context, pointing means “pointing at a distin-
guished atom”; substitution, written B ◦C or B[C], means “substitute elements of C
for atoms of B”.
Deﬁnition I.14. Let {ǫ1, ǫ2, . . .} be a ﬁxed collection of distinct neutral objects of
size 0. The pointing of a class B, noted A = ΘB, is formally deﬁned by
ΘB :=
X
n≥0
Bn × {ǫ1, . . . , ǫn}.
The substitution of C into B (also known as composition of B and C), noted B ◦C
or B[C], is formally deﬁned as
B ◦C ≡B[C] :=
X
k≥0
Bk × SEQk(C).
If Bn is the number of B structures of size n, then nBn can be interpreted as
counting pointed structures where one of the n atoms composing a B-structure has
been distinguished (here by a special “pointer” of size 0 attached to it). Elements of
B ◦C may also be viewed as obtained by selecting in all possible ways an element
β ∈B and replacing each of its atoms by an arbitrary element of C.

80
I. UNLABELLED STRUCTURES AND ORDINARY GENERATING FUNCTIONS
The interpretations above rely (silently) on the fact that atoms in an object can
be eventually distinguished from each other. This can be obtained by “canonicaliz-
ing”14 the representations of objects: ﬁrst deﬁne inductively the lexicographic order-
ing for products and sequences; next represent powersets and multisets as increasing
sequences with the induced lexicographic ordering (more complicated rules can also
canonicalize cycles). In this way, any constructible object admits a unique “rigid”
representation in which each particular atom is determined by its place. Such a canon-
icalization thus reconciles the abstract deﬁnition, Deﬁnition I.14, and the intuitive
interpretation of pointing and substitution.
Theorem I.4 (Pointing and substitution). The constructions of pointing and substitu-
tion are admissible15:
A = ΘB
=⇒
A(z) = z∂zB(z)
∂z := d
dz
A = B ◦C
=⇒
A(z) = B(C(z))
PROOF. By the deﬁnition of pointing, one has
An = n · Bn
and
A(z) = z d
dzB(z).
From the deﬁnition of substitution, A = B[C] implies, by the sum and product rules,
A(z) =
X
k≥0
Bk · (C(z))k = B(C(z)),
and the proof is completed.
□
Permutations as pointed objects. As an example of pointing, consider the class P
of all permutations written as words over integers starting from 1. One can go from a
permutation of size n−1 to a permutation of size n by selecting a “gap” and inserting
the value n. When this is done in all possible ways, it gives rise to the combinatorial
relation
P = E + Θ(Z × P),
E = {ǫ},
=⇒
P(z) = 1 + z d
dz(zP(z)).
This means that the OGF satisﬁes an ordinary differential equation whose formal so-
lution is P(z) = P
n≥0 n!zn.
Unary-binary trees as substituted objects. As an example of substitution, con-
sider the class B of (plane rooted) binary trees, where all nodes contribute to size. If
at each node there is substituted a linear chain of nodes (linked by edges placed on top
of the node), one forms an element of the class M of unary-binary trees; in symbols:
M = B ◦SEQ≥1(Z)
=⇒
M(z) = B

z
1 −z

.
14Such canonicalization techniques also serve to develop fast algorithms for the exhaustive listing
of objects of a given size as well as for the range of problems known as “ranking” and “unranking”, with
implications in fast random generation. See, e.g., [352, 373, 495] for the general theory as well as [405, 510]
for particular cases like necklaces and trees.
15In this book, we borrow from differential algebra the convenient notation ∂z :=
d
dz to represent
derivatives.

I. 6. ADDITIONAL CONSTRUCTIONS
81
Thus from the known OGF, B(z) = (1 −
√
1 −4z2)/(2z), one derives
M(z) = 1 −
p
1 −4z2(1 −z)−2
2z(1 −z)−1
= 1 −z −
√
1 −2z −3z2
2z
,
which matches the direct derivation on p. 63 (Motzkin numbers).
 I.54. Combinatorics of derivatives. The combinatorial operation D of “eraser–pointing”
points to an atom in an object and replaces it by a neutral object, otherwise preserving the
overall structure of the object. The translation of D on OGFs is then simply ∂≡∂z. Classical
identities of analysis then receive simple combinatorial interpretations, for instance,
∂(A × B) = (A × ∂B) + (∂A) × B) ;
Leibniz’s identity, ∂m(f·g) = P
j
`m
j
´
(∂jf)·(∂m−jg), also follows from basic combinatorics.
Similarly, for the “chain rule” ∂(f ◦g) = ((∂f) ◦g) · ∂g.

I. 6.3. Implicit structures. There are many cases where a combinatorial class X
is determined by a relation A = B + X, where A and B are known. In terms of
generating functions, one has A(z) = B(z) + X(z), so that
A = B + X
=⇒
X(z) = A(z) −B(z).
For instance, the autocorrelation technique of Section I. 4.2 makes it possible to de-
scribe the class S of all words in W that do not contain a given pattern p, whereas
the language of words containing the pattern is determined as the solution in X of the
equation W = S + X; see p. 56. Similarly, for products, basic algebra gives
A = B × X
=⇒
X(z) = A(z)
B(z).
Here are the corresponding solutions for two of the composite constructions.
Theorem I.5 (Implicit speciﬁcations). The generating functions associated to the im-
plicit equations in X
A = SEQ(X),
A = MSET(X)
are respectively
X(z) = 1 −
1
A(z),
X(z) =
X
k≥1
µ(k)
k
log A(zk),
where µ(k) is the M¨obius function.
PROOF. For sequences, the relation A(z) = (1 −X(z))−1 is readily inverted. For
multisets, start from the fundamental relation of Theorem I.1 and take logarithms:
log(A(z)) =
∞
X
k=1
1
k X(zk).
Let L = log A and Ln = [zn]L(z). One has
nLn =
X
d | n
(dXd),
to which it sufﬁces to apply M¨obius inversion; see APPENDIX A: Arithmetical func-
tions, p. 667.
□

82
I. UNLABELLED STRUCTURES AND ORDINARY GENERATING FUNCTIONS
EXAMPLE I.17.
Indecomposable permutations.
A permutation σ = σ1 · · · σn (written
here as a word of distinct letters) is said to be decomposable if, for some k < n, σ1 · · · σk is
a permutation of {σ1, . . . , σk}, i.e., a strict preﬁx of the permutation is itself a permutation.
Any permutation decomposes uniquely as a catenation of indecomposable permutations; for
instance, here is the decomposition of σ = 2 5 4 1 3 6 8 7 10 9:
1 2 3 4 5 6 7 8 9 10
1
2
3
4
5
6
7
8
9
10
σ = 2 5 4 1 3
6
8 10 7 9
Thus the class P of all permutations and the class I of indecomposable ones are related by
P = SEQ(I).
This determines I(z) implicitly, and Theorem I.5 gives:
I(z) = 1 −
1
P(z)
where
P(z) =
X
n≥0
n! zn .
This example illustrates the implicit structure theorem, but also the possibility of bona ﬁde
algebraic calculations with power series even in cases where they are divergent (APPENDIX A:
Formal power series, p. 676). One ﬁnds
I(z) = z + z2 + 3 z3 + 13 z4 + 71 z5 + 461 z6 + 3447 z7 + · · · ,
where the coefﬁcients are EIS A003319 and
In = n! −
X
n1+n2=n
n1,n2≥1
(n1!n2!) +
X
n1+n2+n3=n
n1,n2,n3≥1
(n1!n2!n3!) −· · · .
From there, simple majorizations of the terms imply that In ∼n!, so that almost all permuta-
tions are indecomposable; see [98, p. 262]. . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE I.17. □
 I.55. 2-dimensional wanderings. A drunkard starts from the origin in the Z × Z plane and,
at each second, he makes a step in either one of the four directions, NW, NE, SW, SE. The steps
are thus տ, ր, ւ, ց. Consider the class L of “primitive loops” deﬁned as walks that start and
end at the origin, but do not otherwise touch the origin. The GF of L is (EIS A002894)
L(z) = 1 −
1
P∞
n=0
`2n
n
´2z2n = 4 z2 + 20 z4 + 176 z6 + 1876 z8 + · · · .
(Hint: a walk is determined by its projections on the horizontal and vertical axes; 1-dimensional
walks that return to the origin in 2n steps are enumerated by
`2n
n
´
.) In particular [zn]L(z/4) is
the probability that the random walk ﬁrst returns to the origin in n steps.
Such problems largely originate with P´olya and the implicit structure technique above
was most likely known to him [396]. See [69] for similar multidimensional extensions. The
ﬁrst return problem is analysed asymptotically in Chapter VI, based on singularity theory and
Hadamard closure properties.


I. 6. ADDITIONAL CONSTRUCTIONS
83
EXAMPLE I.18.
Irreducible polynomials over ﬁnite ﬁelds.
Objects not obviously of a
combinatorial nature can sometimes be enumerated by symbolic methods. Here is an indirect
construction relative to polynomials over ﬁnite ﬁelds. We ﬁx a prime number p and consider the
base ﬁeld Fp of integers taken modulo p. The polynomial ring Fp[X] is the ring of polynomials
in X with coefﬁcients taken in Fp. For all practical purposes, one may restrict attention to
polynomials that are monic, that is, whose leading coefﬁcient is 1.
First, let P be the class of all monic polynomials, with the size of a polynomial being its
degree. Since a monic polynomial of degree n is described by a choice of n coefﬁcients, one
has
P ∼= SEQ(Fp)
=⇒
P(z) =
1
1 −pz
and
Pn = pn.
A polynomial is said to be irreducible if it does not decompose as a product of two polynomials
of smaller degrees. By unique factorization, each monic polynomial decomposes uniquely into
a product (with repetitions being possible) of monic irreducible polynomials. For instance, over
F3, one has
X10 + X8 + 1 = (X + 1)2(X + 2)2(X6 + 2X2 + 1).
Let I be the set of monic irreducible polynomials. The combinatorial isomorphism
P ∼= MSET(I)
expresses precisely the unique factorization property. Thus, the irreducibles are determined
implicitly from the class of all polynomials whose OGF is known. Theorem I.5 implies the
identity
I(z) =
X
k≥1
µ(k)
k
log
1
1 −pzk ,
and, upon extracting coefﬁcients,
In = 1
n
X
k | n
µ(k)pn/k.
In particular, In is asymptotic to pn/n. This estimate constitutes the density theorem for irre-
ducible polynomials:
The fraction of irreducible polynomials amongst all polynomials of degree n over
the ﬁnite ﬁeld Fp is asymptotic to 1
n.
This property is analogous to the Prime Number Theorem of number theory (which is tech-
nically much harder [107]), according to which the proportion of prime numbers in the inter-
val [1, n] is asymptotic to
1
log n. (The result was known to due to Gauß. See Knopfmacher’s
book [297] for an abstract discussion of statistical properties of arithmetical semigroups.)
END OF EXAMPLE I.18. □
 I.56. Square-free polynomials.
Let Q be the class of monic square-free polynomials (i.e.,
polynomials not divisible by the square of a polynomial). One has by “Vall´ee’s identity” (p. 29)
Q(z) = P(z)/P(z2), hence
Q(z) = 1 −pz2
1 −pz
and
Qn = pn −pn−1
(n ≥2).
Berlekamp’s book [41] discusses such facts together with relations to error correcting codes. 
 I.57. Balanced trees. The class E of balanced 2-3 trees contains all the (rooted planar) trees
whose internal nodes have degree 2 or 3 and such that all leaves are at the same distance from
the root. Only leaves contribute to size. Such trees, which are particular cases of B-trees, are a

84
I. UNLABELLED STRUCTURES AND ORDINARY GENERATING FUNCTIONS
useful data structure for implementing dynamic dictionaries [307, 433]. Balanced trees satisfy
an implicit equation based on combinatorial substitution:
E = Z + E[(Z × Z) + (Z × Z × Z)]
=⇒
E(z) = z + E(z2 + z3).
The expansion starts as (EIS A014535) E(z) = z + z2 + z3 + z4 + 2 z5 + 2 z6 + 3 z7 + 4 z8 +
5 z9 +8 z10 +· · · . Odlyzko [375] has determined the growth of En to be roughly ϕn/n, where
ϕ = (1 +
√
5)/2 is the golden ratio. Cf Section IV. 7.2, p. 267 for a partial analysis.

I. 7. Perspective
This chapter and the next amount to a survey of elementary combinatorial enu-
merations, organized in a coherent manner and summarized in Figure 14. We refer to
the process of specifying combinatorial classes using these constructions and then au-
tomatically having access to the corresponding generating functions as the symbolic
method. The symbolic method is the “combinatorics” in analytic combinatorics: it
allows us to organize classical results in combinatorics with a unifying overall ap-
proach, to derive new results that generalize and extend classical problems, and to
address new classes of problems that are arising in computer science, computational
biology, statistical physics, and other scientiﬁc disciplines.
More important, the symbolic method leaves us with generating functions that we
can handle with the “analytic” part of analytic combinatorics. A full treatment of this
feature of the approach is premature, but a brief discussion may help place the rest of
the book in context.
For a given class of problems, the symbolic method typically leads to a uniﬁed
treatment that reveals a natural class of functions in which generating functions lie.
Even though the symbolic method is completely formal, we can often successfully
proceed by using classical techniques from complex and asymptotic analysis. For
example, denumerants with a ﬁnite set of coin denominations always lead to ratio-
nal generating functions with poles on the unit circle. Such an observation is useful
since then a common strategy for coefﬁcient extraction can be applied (partial fraction
expansion, in the case of denumerants with ﬁxed coin denominations). In the same
vein, the run statistics constitute a particular case of the general theorem of Chomsky
and Sch¨utzenberger to the effect that the generating function of a regular language
is necessarily a rational function. Theorems of this sort establish a bridge between
combinatorial analysis and special functions.
Not all applications of the symbolic method are automatic (though that is certainly
a goal underlying the approach). The example of counting set partitions shows that
application of the symbolic method may require ﬁnding an adequate presentation of
the combinatorial structures to be counted. In this way, bijective combinatorics enters
the game in a nontrivial fashion.
Our introductory examples of compositions and partitions correspond to classes
of combinatorial structures with explicit “iterative” deﬁnitions, a fact leading in turn to
explicit generating function expressions. The tree examples then introduce recursively
deﬁned structures. In that case, the recursive deﬁnition translates into a functional
equation that only determines the generating function implicitly. In simpler situations
(like binary or general trees), the equation can be solved and explicit counting results

I. 7. PERSPECTIVE
85
1. The main constructions of disjoint union (combinatorial sum), product, sequence,
set, multiset, and cycle and their translation into generating functions (Theorem I.1).
Construction
OGF
Union
A = B + C
A(z) = B(z) + C(z)
Product
A = B × C
A(z) = B(z) · C(z)
Sequence
A = SEQ(B)
A(z) =
1
1 −B(z)
Powerset
A = SET(B)
A(z) = exp

B(z) −1
2B(z2) + · · ·

Multiset
A = MSET(B)
A(z) = exp

B(z) + 1
2B(z2) + · · ·

Cycle
A = CYC(B)
A(z) = log
1
1 −B(z) + 1
2 log
1
1 −B(z2) + · · ·
2. The translation for sets, multisets, and cycles constrained by the number of compo-
nents (Theorem I.3, p. 78).
SEQk(B) :
B(z)k
PSET2(B) :
B(z)2
2
−B(z2)
2
MSET2(B) :
B(z)2
2
+ B(z2)
2
CYC2(B) :
B(z)2
2
+ B(z2)
2
PSET3(B) :
B(z)3
6
−B(z) B(z2)
2
+ B(z3)
3
MSET3(B) :
B(z)3
6
+ B(z) B(z2)
2
+ B(z3)
3
CYC3(B) :
B(z)3
3
+ 2B(z3)
3
PSET4(B) :
B(z)4
24
−B(z)2B(z2)
4
+ B(z)B(z3)
3
+ B(z2)2
8
−B(z4)
4
MSET4(B) :
B(z)4
24
+ B(z)2B(z2)
4
+ B(z)B(z3)
3
+ B(z2)2
8
+ B(z4)
4
CYC4(B) :
B(z)4
4
+ B(z2)2
4
+ B(z4)
2
.
3. The additional constructions of pointing and substitution (Section I. 6).
Construction
OGF
Pointing
A = ΘB
A(z) = z d
dzB(z)
Substitution
A = B ◦C
A(z) = B(C(z))
FIGURE I.14. A dictionary of constructions applicable to unlabelled structures, together
with their translation into ordinary generating functions (OGFs). (The labelled counterpart
of this table appears in Figure 16 of Chapter II, p. 137.)

86
I. UNLABELLED STRUCTURES AND ORDINARY GENERATING FUNCTIONS
still follow. In other cases (like non-planar trees) one can usually proceed with com-
plex asymptotic analysis directly from the functional equation and obtain very precise
asymptotic estimates; see Chapters IV–VII.
Analytic combinatorics is characterized by the focus on constructions that leave
us with generating functions that yield to classical techniques in complex analysis and
asymptotic analysis. For some combinatorial classes, as we shall see, we have the-
orems that carry us all the way from purely combinatorial constructions through to
asymptotic estimates for counting sequences, under general assumptions. For others,
the general theorems are yet to be proved, but the symbolic method lays the ground-
work for analysis that leads to the results that we seek.
Modern presentations of combinatorial analysis appear in the books of Comtet [98] (a
beautiful book largely example-driven), Stanley [447, 449] (a rich set with an algebraic orienta-
tion), Wilf [496] (generating functions oriented), and Lando [326] (a neat modern introduction).
An elementary but insightful presentation of the basic techniques appears in Graham, Knuth,
and Patashnik’s classic [248], a popular book with a highly original design. An encyclope-
dic reference is the book of Goulden & Jackson [244] whose descriptive approach very much
parallels ours.
The sources of the modern approaches to combinatorial analysis are hard to trace since they
are usually based on earlier traditions and informally stated mechanisms that were well mastered
by practicing combinatorial analysts. (See for instance MacMahon’s book [350] Combinatory
Analysis ﬁrst published in 1917, the introduction of denumerant generating functions by P´olya
as exposed in [398], or the “domino theory” in [248, Sec. 7.1].) One source in recent times is
the Chomsky–Sch¨utzenberger theory of formal languages and enumerations [89]. Rota [414]
and Stanley [445, 449] developed an approach which is largely based on partially ordered sets.
Bender and Goldman developed a theory of “prefabs” [34] whose purposes are similar to the
theory developed here. Joyal [286] proposed an especially elegant framework, the “theory of
species”, that addresses foundational issues in combinatorial theory and constitutes the starting
point of the superb exposition by Bergeron, Labelle, and Leroux [39]. Parallel (but independent)
developments by the “Russian School” are nicely synthetized in the books by Sachkov [420,
421].
One of the reasons for the revival of interest in combinatorial enumerations and proper-
ties of random structures is the analysis of algorithms (a subject founded in modern times by
Knuth [309]), where the goal is to predict the performance characteristics of computer pro-
grams. The symbolic ideas exposed here have been applied to the analysis of algorithms in
surveys [175, 486] and are further exposed in our book [434]. Flajolet, Salvy, and Zimmer-
mann [206] have shown how to use them in order to automate the analysis of some well charac-
terized classes of combinatorial structures. Even more recently, several researches in statistical
physics, computational biology, and other scientiﬁc disciplines have been drawn towards the
study of the sorts of discrete models that can be speciﬁed by the sorts of combinatorial construc-
tions that we have described, and therefore are candidates for study via analytic combinatorics.
Research in these ﬁelds are the driving force in the study of new kinds of constructions on the
combinatorics side that lead to new methods on the analytic side.

II
Labelled Structures and Exponential
Generating Functions
Cette approche ´evacue pratiquement tous les calculs1.
— DOMINIQUE FOATA &
MARCEL P. SCH ¨UTZENBERGER [219]
Contents
II. 1.
Labelled classes
88
II. 2.
Admissible labelled constructions
91
II. 3.
Surjections, set partitions, and words
98
II. 4.
Alignments, permutations, and related structures
110
II. 5.
Labelled trees, mappings, and graphs
116
II. 6.
Additional constructions
126
II. 7.
Perspective
136
Many objects of classical combinatorics present themselves naturally as labelled struc-
tures where atoms of an object (typically nodes in a graph or a tree) are distinguishable
from one another by the fact that they bear distinct labels. Without loss of generality,
we may take the set from which labels are drawn to be the set of positive integers.
For instance, a permutation can be viewed as a linear arrangement of distinct labels;
its cycle decomposition represents it as an unordered collection of circular directed
graphs whose nodes are labelled by integers.
Operations on labelled structures are based on a special product: the labelled
product that distributes labels between components. This operation is a natural ana-
logue of the cartesian product for plain unlabelled objects. The labelled product in
turn leads to labelled analogues of the sequence, set, and cycle constructions.
Labelled constructions translate over exponential generating functions. The trans-
lation schemes turn out to be analytically even simpler than in the unlabelled case
considered in the previous chapter. At the same time, labelled constructions enable
us to take into account structures that are in many ways combinatorially richer than
their unlabelled counterparts, in particular as regards order properties. They constitute
another facet, with powerful descriptive powers, of the symbolic method for combi-
natorial enumeration.
In this chapter, we examine some of the most important classes of labelled objects,
including surjections, set partitions, permutations, labelled graphs and labelled trees,
as well as graphs and mappings from a ﬁnite set into itself. Certain aspects of words
1“This approach eliminates virtually all calculations.”
87

88
II. LABELLED STRUCTURES AND EGFS
can also be treated by this theory, a fact which has numerous consequences not only
in combinatorics itself but also in probability and statistics. In particular, labelled
constructions of words can be put to use in order to elegantly solve two classical
problems, the birthday problem and the coupon collector problem, as well as several
of their variants that have numerous applications in other ﬁelds, including the analysis
of hashing algorithms in computer science.
II. 1. Labelled classes
Throughout this chapter, we consider combinatorial classes in the sense of Chap-
ter I: we deal exclusively with ﬁnite objects; a combinatorial class A is a set of objects,
with a notion of size attached, so that the number of objects of each size in A is ﬁnite.
To these basic concepts, we now add the idea that the objects are labelled, by which
we mean that each atom carries with it a distinctive colour, or equivalently an integer
label, in such a way that all the labels occurring in an object are distinct. Precisely:
Deﬁnition II.1. A weakly labelled object of size n is a graph whose set of vertices
is a subset of the integers. Equivalently, we say that the vertices bear labels, with
the implied condition that labels are distinct integers from Z. An object of size n is
said to be well-labelled, or simply labelled, if it is weakly labelled and, in addition,
its collection of labels is the complete integer interval [1 . . n]. A labelled class is a
combinatorial class comprised of well-labelled objects.
The graphs considered may be directed or undirected. In fact, when the need
arises, we shall take “object” to mean any kind of discrete structure enriched by in-
teger labels. Virtually all labelled classes considered in this book can eventually be
encoded as graphs of sorts, so that this extended use of the notion of a labelled class
is a harmless convenience. (See Section II. 7 for a brief discussion of alternative but
logically equivalent frameworks for the notion of a labelled class.)
EXAMPLE II.1.
Labelled graphs. A labelled graph is by deﬁnition an undirected graph
such that distinct integer labels forming an interval of the form {1, 2, . . . , n} are supported by
vertices. A particular labelled graph of size 4 is then
g =
4
2
3
1
,
which represents a graph whose vertices bear the labels {1, 2, 3, 4} and whose set of edges is
{ {1, 3}, {2, 3}, {2, 4}, {1, 4} } .
Only the graph structure (as deﬁned by its set of edges) counts, so that this is the same abstract
graph as in the alternative visual representations
g =
3
2
4
1
,
1
4
2
3
.
However, this graph is different from either of
h =
3
2
1
4
,
j =
4
2
1
3
,

II. 1. LABELLED CLASSES
89
2 
3 
1 
4 
3 
2 
1 
4 
4 
2 
1 
3 
1 
3 
2 
4 
1 
2 
3 
4 
1 
2 
4 
3 
1 
4 
2 
3 
1 
4 
2 
3 
2 
4 
1 
3 
3 
4 
1 
2 
4 
3 
1 
2 
1 
4 
2 
3 
1 
4 
3 
2 
1 
3 
4 
2 
1 
3 
2 
4 
1 
4 
3 
2 
1 
4 
2 
3 
2 
4 
1 
3 
3 
4 
1 
2 
2 
4 
1 
3 
2 
3 
1 
4 
3 
4 
2 
1 
1 
4 
2 
3 
1 
3 
2 
4 
3 
4 
1 
2 
4 
3 
1 
2 
2 
4 
3 
1 
1 
4 
3 
2 
1 
2 
3 
4 
3 
2 
4 
1 
1 
3 
4 
2 
1 
2 
4 
3 
2 
4 
3 
1 
3 
4 
2 
1 
4 
3 
2 
1 
1 
4 
3 
2 
3 
4 
1 
2 
4 
3 
2 
2 
2
4 
1
3 
1 
4 
2 
3 
1 
4 
2 
3 
2 
4 
1 
3 
4 
1 
2 
3 
1 
3 
2 
4 
2 
1 
3 
4 
3 
1 
2 
4 
1 
2
4
3 
1 
4 
3
2
1 
2 
3 
4 
1 
3 
2 
4 
1 
2 
3 
4 
1 
3 
2 
4 
1 
4 
2 
3 
2 
3 
1 
4 
2 
4 
1 
3 
3 
4 
1 
2 
1 
4 
2 
3 
1 
4 
2 
3 
1 
4 
3 
2 
1 
4 
2 
3 
1 
3 
2 
4 
2 
4 
1 
3 
2 
3 
1 
4 
3 
2 
1 
4 
There are altogether G4 = 64 = 26 labelled graphs of size 4, i.e., comprising 4 nodes, in
agreement with the general formula (see p. 97 for details): Gn = 2n(n−1)/2. The labelled
graphs can be grouped into equivalence classes up to arbitrary permutation of the labels, which
determines the bG4 = 11 unlabelled graphs of size 4. Each unlabelled graph corresponds to a
variable number of labelled graphs: for instance, the totally disconnected graph (bottom, left)
and the complete graph (top, right) correspond to 1 labelling only, while the line graph admits
1
2 4! = 12 possible labellings.
FIGURE II.1. Labelled versus unlabelled graphs for size n = 4.
since, for instance, 1 and 2 are adjacent in h and j, but not in g. Altogether, there are 3 different
labelled graphs (namely, g, h, j), that have the same “shape”, corresponding to the unlabelled
quadrangle graph
Q =
•
•
•
•
.
Figure 1 lists all the 64 labelled graphs of size 4 as well as their 11 unlabelled counterparts
viewed as equivalence classes of labelled graphs when labels are ignored. END OF EXAMPLE II.1. □
In order to count labelled objects, we appeal to exponential generating functions.
Deﬁnition II.2. The exponential generating function (EGF) of a sequence {An} is
the formal power series
(1)
A(z) =
X
n≥0
An
zn
n !.
The exponential generating function (EGF) of a class A is the exponential generating
function of the numbers An = card(An). Equivalently, the EGF of class A is
A(z) =
X
n≥0
An
zn
n ! =
X
α∈A
z|α|
|α| !.

90
II. LABELLED STRUCTURES AND EGFS
It is also said that the variable z marks size in the generating function.
With the standard notation for coefﬁcients of series, the coefﬁcient An in an exponen-
tial generating function is then recovered by2
An = n ! · [zn] A(z),
since [zn]A(z) = An/n! by the deﬁnition of EGFs and in accordance with the coefﬁ-
cient extractor notation, Eq. (6) of Chapter I.
Note that, like in the previous chapter, we adhere to a systematic naming con-
vention for generating functions of combinatorial structures. A labelled class A, its
counting sequence (An) (or (an)) and its exponential generating function A(z) (or
a(z)) are all denoted by the same group of letters.
Neutral and atomic classes. Like in the unlabelled universe, it proves useful to
introduce a neutral (empty, null) object ǫ that has size 0 and bears no label at all, and
consider it as a special labelled object; a neutral class E is then by deﬁnition E = {ǫ}.
The (labelled) atomic class Z = { 1} is formed of a unique object of size 1 that, being
well-labelled, bears the integer label 1. The EGFs of the neutral class and the atomic
class are respectively
E(z) = 1,
Z(z) = z.
EXAMPLE II.2. Permutations. The class P of all permutations is prototypical of labelled
classes. Under the linear representation of permutations, where
σ =
0
@
1
2
· · ·
n
σ1
σ2
· · ·
σn
1
A
is represented as the sequence (σ1, σ2, . . . , σn), the class P is schematically
P =
8
>
>
>
>
>
<
>
>
>
>
>
:
ǫ , 1 ,
1 −2
2 −1 ,
1 −2 −3
2 −3 −1
3 −1 −2
2 −1 −3
1 −3 −2
3 −2 −1
, . . .
9
>
>
>
>
>
=
>
>
>
>
>
;
,
so that P0 = 1, P1 = 1, P2 = 2, P3 = 6, etc. There, by deﬁnition, all the possible orderings
of the distinct labels are taken into account, so that the class P can be equivalently viewed as
the class of all labelled linear digraphs (with an implicit direction, from left to right, say, in the
representation). Accordingly, the class P of permutations has the counting sequence Pn = n!
(argument: there are n positions where to place the element 1, then (n −1) possible positions
for 2, and so on). Thus the EGF of P is
P(z) =
X
n≥0
n! zn
n! =
X
n≥0
zn =
1
1 −z .
Permutations, as they contain information relative to the order of their elements are essential in
many applications related to order statistics. . . . . . . . . . . . . . . . . . . . END OF EXAMPLE II.2. □
2Some authors prefer the notation [ zn
n! ]A(z) to n![zn]A(z), which we avoid in this book. Indeed,
Knuth [305] argues convincingly that the variant notation is not consistent with many desirable properties
of a “good” coefﬁcient operator (e.g., bilinearity).

II. 2. ADMISSIBLE LABELLED CONSTRUCTIONS
91
EXAMPLE II.3. Urns. The class U of totally disconnected graphs starts as
U =
8
>
<
>
:
ǫ , 1 ,
1
2
,
1
2
3
,
1
2
3
4
,
1
2
5
3
4
, . . .
9
>
=
>
;
.
Order between the labelled atoms does not count, so that for each n, there is only one possible
arrangement and Un = 1. The class U can be regarded as the class of “urns”, where an
urn of size n contains n distinguishable balls in an unspeciﬁed (and irrelevant) order. The
corresponding EGF is
U(z) =
X
n≥0
1 zn
n! = exp(z) = ez.
(The fact that the EGF of the constant sequence (1)n≥0 is the exponential function explains the
term “exponential generating function”.) It also proves convenient, in several applications, to
represent elements of an urn in a sorted sequence, which leads to an equivalent representation
of urns as increasing linear graphs; for instance,
1 −2 −3 −4 −5
may be equivalently used to represent the urn of size 5. Though urns look trivial at ﬁrst glance,
they are of particular importance as building blocks of complex labelled structures (e.g., alloca-
tions of various sorts), as we shall see shortly. . . . . . . . . . . . . . . . . . . END OF EXAMPLE II.3. □
EXAMPLE II.4.
Circular graphs.
Finally, the class of circular graphs, where cycles are
oriented in some conventional manner (say, positively here) is
C =
(
1 ,
6
1
2
,
6
1
2
3
,
6
1
3
2
, . . .
)
.
Cyclic graphs correspond bijectively to cyclic permutations . One has Cn = (n −1)! (argu-
ment: a directed cycle is determined by the succession of elements that “follow” 1, hence by a
permutation of n −1 elements). Thus, one has
C(z) =
X
n≥1
(n −1)!zn
n! =
X
n≥1
zn
n = log
1
1 −z .
As we shall see in the next section, the logarithm is characteristic of circular arrangements of
labelled objects. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE II.4. □
 II.1. Labelled trees. Let Un be now the number of labelled graphs with n vertices that are
connected and acyclic; equivalently, Un is the number of labelled unrooted nonplane trees. Let
Tn be the number of labelled rooted nonplane trees. The identity Tn = nUn is elementary,
since all vertices in a labelled tree are distinguishable (by their labels) and a root can be chosen
in n possible ways. In Section II. 5, we shall prove that Un = nn−2 and Tn = nn−1.

II. 2. Admissible labelled constructions
We now describe a toolkit of constructions that make it possible to build complex
labelled classes from simpler ones. Combinatorial sum or disjoint union is deﬁned
exactly as in Chapter I: it is the union of disjoint copies. To deﬁne a product that is
adapted to labelled structures, we cannot use the cartesian product, since an ordered
pair of two labelled objects is not well-labelled (for instance the label 1 would invari-
ably appear repeated twice). Instead, we deﬁne a new operation, the labelled product,

92
II. LABELLED STRUCTURES AND EGFS
which translates naturally into exponential generating functions. From there, simple
translation rules follow for labelled sequences, sets, and cycles.
Binomial convolutions. As a preparation to the translation of labelled construc-
tions, we ﬁrst brieﬂy review the effect of products over EGFs. Let a(z), b(z), c(z) be
EGFs, with a(z) = P
n anzn/n!, and so on. The binomial convolution formula is:
(2)
if a(z) = b(z) · c(z), then an =
n
X
k=0
n
k

bkcn−k.
This formula results from the usual product of formal power series,
an
n! =
n
X
k=0
bk
k! ·
cn−k
(n −k)!
and
n
k

=
n!
k! (n −k)!.
In the same vein, if a(z) = a(1)(z) a(2)(z) · · · a(r)(z), then
(3)
an =
X
n1+n2+···+nr=n

n
n1, n2, . . . , nr

a(1)
n1 a(2)
n2 · · · a(r)
nr .
In Equation (3) there occurs the multinomial coefﬁcient

n
n1, n2, . . . , nr

=
n!
n1!n2! · · · nr!,
which counts the number of ways of splitting n elements into r distinguished classes
of cardinalities n1, . . . , nr. This property lies at the very heart of enumerative appli-
cations of binomial convolutions and EGFs.
II. 2.1. Labelled constructions. A labelled object may be relabelled. We only
consider consistent relabellings deﬁned by the fact that they preserve the order rela-
tions among labels. Then two dual modes of relabellings prove important:
— Reduction: For a weakly labelled structure of size n, this operation reduces
its labels to the standard interval [1 . . n] while preserving the relative order
of labels. For instance, the sequence ⟨7, 3, 9, 2⟩reduces to ⟨3, 2, 4, 1⟩. We
use ρ(α) to denote the canonical reduction of the structure α.
— Expansion: This operation is deﬁned relative to a relabelling function e ∈
[1 . . n] 7→Z that is assumed to be strictly increasing. For instance, ⟨3, 2, 4, 1⟩
may expand as ⟨33, 22, 44, 11⟩, ⟨7, 3, 9, 2⟩, and so on. We use e(α) to denote
the result of relabelling α by e.
These notions enable us to devise a product suited to labelled objects.
The labelled product, (or simply product), of objects and classes was originally
formalized under the name of “partitional product” by Foata [217]. Given two labelled
structures β ∈B and γ ∈C, this product noted as β ⋆γ is a set comprised of the
collection of well-labelled ordered pairs (β′, γ′) that reduce to (β, γ):
(4)
β ⋆γ := { (β′, γ′)
 (β′, γ′) is well–labelled, ρ(β′) = β, ρ(γ′) = γ }.
An equivalent form is via expansion of labels:
(5) β⋆γ = { (e(β), f(γ)
 Im(e)∩Im(f) = ∅, Im(e)∪Im(f) = [ 1 . . |β| + |γ| ] },

II. 2. ADMISSIBLE LABELLED CONSTRUCTIONS
93
1
2
1
2
3
4
5
1
2
3
3
5
1
2
4
3
4
1
2
5
2
5
1
3
4
2
4
1
3
5
2
3
1
4
5
1
5
2
3
4
1
4
2
3
5
1
3
2
4
5
1
2
3
4
5
FIGURE II.2.
The 10 ≡
`5
2
´
elements in the labelled product of a triangle and a segment.
where e, f are relabelling functions with ranges Im(e), Im(f), respectively. Note that
elements of a labelled product are, by construction, well-labelled. Figure 2 displays
the labelled product of a particular object of size 3 with another object of size 2.
The labelled product β ⋆γ of two elements β, γ of respective sizes n1, n2 is a set
whose cardinality is, with n = n1 + n2, expressed as
n1 + n2
n1, n2

≡
 n
n1

,
since this quantity is the number of legal relabellings by expansion of the pair (β, γ).
(The example of Figure 2 veriﬁes that the number of relabellings is indeed
 5
2

= 10.)
If B and C are two labelled classes of combinatorial structures, the labelled prod-
uct A = B ⋆C is deﬁned by the usual extension of operations to sets:
(6)
B ⋆C =
[
β∈B, γ∈C
(β ⋆γ).
In summary:
Deﬁnition II.3. The labelled product of B and C, denoted B⋆C, is obtained by forming
ordered pairs from B × C and performing all possible order-consistent relabellings,
ensuring that the resulting pairs are well labelled, as described by (4) or (5), and (6).
Equipped with this notion, we can build sequences, sets, and cycles, in a way
much similar to the unlabelled case. We proceed to do so and, at the same time,
establish admissibility3 of the constructions.
Labelled product. When A = B ⋆C, the corresponding counting sequences sat-
isfy the relation,
(7)
An =
X
|β|+|γ|=n
|β| + |γ|
|β|, |γ|

X
n1+n2=n

n
n1, n2

Bn1Cn2.
The product Bn1Cn2 keeps track of all the possibilities for the B and C components
and the binomial coefﬁcient accounts for the number of possible relabellings, in accor-
dance with our earlier discussion. The binomial convolution property (7) then implies
3We recall that a construction is admissible (Chapter I) if the counting sequence of the result only
depends on the counting sequences of the operands. An admissible construction therefore induces a well-
deﬁned transformation over exponential generating functions.

94
II. LABELLED STRUCTURES AND EGFS
admissibility,
A = B ⋆C
=⇒
A(z) = B(z) · C(z),
with the labelled product simply translating into the product operation on EGFs.
 II.2. Multiple labelled products. The (binary) labelled product satisﬁes the associativity
property,
B ⋆(C ⋆D) ∼= (B ⋆C) ⋆D,
which may serve to deﬁne B ⋆C ⋆D. The corresponding EGF is the product A(z)·B(z)·C(z).
This product rule generalizes to r factors with coefﬁcients given by a multinomial convolu-
tion (3).

k-sequences and sequences. The kth (labelled) power of B is deﬁned as (B ⋆
B · · · B), with k factors equal to B. It is denoted SEQk{B} as it corresponds to forming
k–sequences and performing all consistent relabellings. The (labelled) sequence class
of B is denoted by SEQ{B} and is deﬁned by
SEQ{B} := {ǫ} + B + (B ⋆B) + (B ⋆B ⋆B) + · · · =
[
k≥0
SEQk{B}.
The product relation for EGFs extends to arbitrary products (Note 2), so that
A = SEQk(B)
=⇒
A(z) = B(z)k
A = SEQ(B)
=⇒
A(z) =
∞
X
k=0
B(z)k =
1
1 −B(z),
where the last equation requires B0 = ∅.
k–sets and sets. We denote by SETk{B} the class of k–sets formed from B. The
set class is deﬁned formally, like in the case of the unlabelled multiset: it is the quotient
SETk{B} := SEQk{B}/R where the equivalence relation R identiﬁes two sequences
when the components of one are a permutation of the components of the other (p. 25).
A “set” is like a sequence, but the order between components is immaterial. The
(labelled) set construction applied to B, denoted SET{B}, is then deﬁned by
SET{B}
def
= {ǫ} + B + SET2{B} + · · · =
[
k≥0
SETk{B}.
A labelled k–set is associated with exactly k! different sequences. (In the unlabelled
case, formulæ are more complex.) Thus in terms of EGFs, one has (assuming B0 = ∅)
A = SETk(B)
=⇒
A(z) = 1
k!B(z)k
A = SET(B)
=⇒
A(z) =
∞
X
k=0
1
k!B(z)k = exp(B(z)).
Note that the distinction between multisets and powersets that is meaningful for unla-
belled structures is here immaterial: by deﬁnition components of a labelled set all have
distinct labels so that, relative to the labelled universe, we have the correspondence:
MSET, PSET ; SET.

II. 2. ADMISSIBLE LABELLED CONSTRUCTIONS
95
k–cycles and cycles. We also introduce the class of k–cycles, CYCk{B} and the
cycle class. The cycle class is deﬁned formally, like in the unlabelled case, as the
quotient CYCk{B} := SEQk{B}/S where the equivalence relation S identiﬁes two
sequences when the components of one are a cyclic permutation of the components
of the other (p. 24). A cycle is like a sequence whose components can be circularly
shifted. In terms of EGFs, we have (assuming B0 = ∅)
A = CYCk(B)
=⇒
A(z) = 1
k B(z)k
A = CYC(B)
=⇒
A(z) =
∞
X
k=1
1
kB(z)k = log
1
1 −B(z),
since each cycle admits exactly k representations as a sequence.
In summary:
Theorem II.1. The constructions of combinatorial sum (disjoint union), labelled
product, sequence, cycle and set are all admissible. The associated operators on
EGFs are:
Sum:
A = B + C
=⇒
A(z) = B(z) + C(z)
Product:
A = B ⋆C
=⇒
A(z) = B(z) · C(z)
Sequence:
A = SEQ(B)
=⇒
A(z) =
1
1 −B(z)
— k comp.:
A = SEQk(B) ≡(B)⋆k
=⇒
A(z) = B(z)k
Set:
A = SET(B)
=⇒
A(z) = exp(B(z))
— k comp.:
A = SETk(B)
=⇒
A(z) = 1
k!B(z)k
Cycle:
A = CYC(B)
=⇒
A(z) = log
1
1 −B(z)
— k comp.:
A = CYCk(B)
=⇒
A(z) = 1
k B(z)k
Constructible classes. As in the previous chapter, we say that a class of labelled
objects is constructible if it admits a speciﬁcation in terms of sums (disjoint unions),
the labelled constructions of product, sequence, set, cycle, and the initial classes de-
ﬁned by the neutral structure of size 0 and the atomic class Z = { 1 }. Regarding the
elementary classes discussed in Section II. 1, it is immediately recognized that
P = SEQ{Z},
U = SET{Z},
C = CYC{Z},
specify permutations, urns, and circular graphs respectively. These constructions are
basic building blocks out of which more complex objects can be constructed. In partic-
ular, as we shall explain shortly (Section II. 3 and Section II. 4), set partitions (S), sur-
jections (R), permutations under their cycle decomposition (P), and alignments (O)

96
II. LABELLED STRUCTURES AND EGFS
are constructible classes corresponding to
Surjections:
R ≃SEQ{SET≥1{Z}}
(sequences-of-sets),
Set partititions:
S ≃SET{SET≥1{Z}}
(sets-of-sets),
Alignments:
O ≃SEQ{CYC{Z}}
(sequences-of-cycles).
Permutations:
P ≃SET{CYC{Z}},
(sets-of-cycles),
An immediate consequence of Theorem II.1 is the fact that the EGF of a con-
structible labelled class can be computed automatically.
Theorem II.2. The exponential generating function of a constructible class of la-
belled objects is a component of a system of generating function equations whose
terms are built from 1 and z using the operators
+ , × , Q(f) =
1
1 −f , E(f) = ef , L(f) = log
1
1 −f .
If we further allow cardinality restrictions in composite constructions, the operators
f k (for SEQk), f k/k! (for SETk), and f k/k (for CYCk) are to be added to the list.
II. 2.2. Labelled versus unlabelled enumeration. Any labelled class A has an
unlabelled counterpart b
A: objects in b
A are obtained from objects of A by ignoring
the labels. This idea is formalized by identifying two labelled objects if there is an
arbitrary relabelling (not just an order-consistent one, as has been used so far) that
transforms one into the other. For an object of size n, each equivalence class contains
a priori between 1 and n! elements. Thus:
Proposition II.1. The counts of a labelled class A and its unlabelled counterpart b
A
are related by
(8)
bAn ≤An ≤n! bAn
or equivalently
1 ≤An
bAn
≤n!.
EXAMPLE II.5.
Labelled and Unlabelled graphs.
This phenomenon has been already
encountered in our discussion of graphs (Figure 1). Let generally Gn and bGn be the number of
graphs of size n in the labelled and unlabelled case respectively. One ﬁnds for n = 1 . . 15
b
Gn (unlabelled)
Gn (labelled)
1
1
2
2
4
8
11
64
34
1024
156
32768
1044
2097152
12346
268435456
274668
68719476736
12005168
35184372088832
1018997864
36028797018963968
165091172592
73786976294838206464
50502031367952
302231454903657293676544
29054155657235488
2475880078570760549798248448
31426485969804308768
40564819207303340847894502572032

II. 2. ADMISSIBLE LABELLED CONSTRUCTIONS
97
The sequence { bGn} constitutes EIS A000088, which can be obtained by an extension of meth-
ods of Chapter I; see [259, Ch. 4]. The sequence {Gn} is determined directly by the fact that a
graph of n vertices can have each of the
`n
2
´
possible edges either present or not, so that
Gn = 2(n
2) = 2n(n−1)/2.
The sequence of labelled counts obviously grows much faster than its unlabelled counterpart.
We may then verify the inequality (8) in this particular case. The normalized ratios,
ρn := Gn/ bGn,
σn := Gn/(n! bGn),
are observed to be
n
ρn = Gn/ bGn
σn = Gn/(n! bGn)
1
1.000000000
1.0000000000
2
1.000000000
0.5000000000
3
2.000000000
0.3333333333
4
5.818181818
0.2424242424
5
30.11764706
0.2509803922
6
210.0512821
0.2917378918
8
21742.70663
0.5392536367
10
2930768.823
0.8076413203
12
446946830.2
0.9330800361
14
0.8521603960 · 1011
0.9774915111
16
0.2076885783 · 1014
0.9926428522
From these data, it is natural to conjecture that σn tends (fast) to 1 as n tends to inﬁnity. This is
indeed a nontrivial fact originally established by P´olya (see Chapter 9 of Harary and Palmer’s
book [259] dedicated to asymptotics of graph enumerations):
bGn ∼1
n! 2(n
2) = Gn
n! .
In other words, “almost all” graphs of size n should admit a number of labellings close to n!.
(Combinatorially, this corresponds to the fact that in a random unlabelled graph, with high
probability, all of the nodes can be distinguished based on the adjacency structure of the graph;
in such a case, the graph has no nontrivial automorphism and the number of distinct labellings
is n! exactly.)
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE II.5. □
The case of urns and totally disconnected graphs resorts to the other extreme
situation where
bUn = Un = 1.
The examples of graphs and urns illustrate the fact that, beyond the general bounds of
Proposition II.1, there is no automatic way to translate between labelled and unlabelled
enumerations. At least, if the class A is constructible, its unlabelled counterpart b
A can
be obtained by interpreting all the intervening constructions as unlabelled ones in the
sense of Chapter I (with SET 7→MSET), both generating functions are computable,
and their coefﬁcients can be compared.
 II.3. Permutations and their unlabelled counterparts. The labelled class of permutations can
be speciﬁed by P = SEQ(Z); the unlabelled counterpart is the set bP of integers in unary nota-
tion, and bPn ≡1, so that Pn = n!· bPn exactly. The speciﬁcation P′ = SET(CYC(Z)) describes
sets of cycles and, in the labelled universe, one has P′ ∼= P; however the unlabelled counter-
part of P′ is the class c
P′ ̸= bP of integer partitions examined in Chapter I. [In the unlabelled

98
II. LABELLED STRUCTURES AND EGFS
universe, there are special combinatorial isomorphisms like: SEQ≥1(Z) ∼= MSET≥1(Z) ∼=
CYC(Z). In the labelled universe, the identity SET ◦CYC ≡SEQ holds.]

II. 3. Surjections, set partitions, and words
This section and the next are devoted to what could be termed level-two nonrecur-
sive structures deﬁned by the fact that they combine two constructions. In this section,
we discuss surjections and set partitions (Section II. 3.1), which constitute labelled
analogues of integer compositions and integer partitions in the unlabelled universe.
The symbolic method then extends naturally to words over a ﬁnite alphabet, where
it opens access to an analysis of the frequencies of letters composing words. This
in turn has useful consequences for the study of some classical random allocation
problems, of which the birthday paradox and the coupon collector problem stand out
(Section II. 3.2).
II. 3.1. Surjections and set partitions. We examine classes
R = SEQ{SET≥1{Z}}
and
S = SET{SET≥1{Z}},
correspondingto sequences-of-sets (R) and sets-of-sets (S), or equivalently, sequences
of urns and sets of urns, respectively. Such abstract speciﬁcations model very classical
objects of discrete mathematics, namely surjections (R) and set partitions (S)
Surjections with r images. In elementary mathematics, a surjection from a set A
to a set B is a function from A to B that assumes each value at least once (an onto
mapping). Fix some integer r ≥1 and let R(r)
n
denote the class of all surjections from
the set [1 . . n] onto [1 . . r] whose elements are also called r–surjections. Here is a
particular object φ ∈R(5)
9 :
(9)
φ :
1
2
3
4
5
6
7
8
9
1
2
3
4
5
(Note that, if φ(9) were 3, then φ would not be a surjection.) We set R(r) = S
n R(r)
n
and proceed to compute the corresponding EGF, R(r)(z). First, let us observe that an
r–surjection φ ∈R(r)
n is determined by the ordered r–tuple formed with the collection
of all preimage sets,
 φ−1(1), φ−1(2), . . . , φ−1(r)

, themselves disjoint nonempty
sets of integers that cover the interval [1 . . n]. In the case of the surjection φ of (9),
this alternative representation is
φ :
( {2}, {1, 3}, {4, 6, 8}, {9}, {5, 7} ).
One has the combinatorial speciﬁcation and EGF relation:
(10)
R(r) = SEQr{V}, V = SET≥1{Z}
=⇒
R(r)(z) = (ez −1)r.
There V ≡U \ {ǫ} designates the class of urns (U) that are nonempty, with EGF
V (z) = ez −1, in view of our earlier discussion of urns. In words: “a surjection is a
sequence of nonempty sets”. See Figure II. 3.1 for an illustration.

II. 3. SURJECTIONS, SET PARTITIONS, AND WORDS
99
6
8
4
5
7
9
3
1
2
4
1
5
3
2
9
2
7
5
3
1
8
6
4
1
2
2
1
3
2
4
3
5
5
6
3
7
5
8
3
9
4
1
2
3
1
4
2
5
3
6
4
7
5
8
9
[    {2},          {1,  3},          {4,  6,  8},           {9},          {5, 7}    ]
FIGURE II.3. The decomposition of surjections as sequences-of-sets: a surjection given
by its graph (top), its table (second line), and its sequence of preimages (bottom lines).
Equation (10) does solve the counting problem for surjections. For small r, one
ﬁnds
R(2)(z) = e2z −2ez + 1,
R(3)(z) = e3z −3e2z + 3ez −1,
whence, by expanding,
R(2)
n
= 2n −2,
R(3)
n
= 3n −3 · 2n + 3 .
The general formula follows similarly from expanding the rth power in (10) by the
binomial theorem, and then extracting coefﬁcients:
(11)
R(r)
n
= n! [zn]
r
X
j=0
r
j

(−1)je(r−j)z =
r
X
j=0
r
j

(−1)j(r −j)n.
 II.4. A direct derivation of the surjection EGF. One can verify the result provided by the
symbolic method by returning to ﬁrst principles. The preimage of value j by a surjection is a
nonempty set of some cardinality nj ≥1, so that
(12)
R(r)
n
=
X
(n1,n2,...,nr)
 
n
n1, n2, . . . , nr
!
,
the sum being taken over nj ≥1, n1 + n2 + · · · + nr = n. Introduce the numbers Vn :=
[[n ≥1]]. The formula (12) then assumes the simpler form
(13)
R(r)
n
≡
X
n1,n2,...,nr
 
n
n1, n2, . . . , nr
!
Vn1Vn2 · · · Vnr,
where the summation now extends to all tuples (n1, n2, . . . , nr). The EGF of the Vn is V (z) =
P Vnzn/n! = ez −1. Thus the convolution relation (13) leads again to (10).


100
II. LABELLED STRUCTURES AND EGFS
Set partitions into r blocks. Let S(r)
n
denote the number of ways of partitioning
the set [1 . . n] into r disjoint and nonempty equivalence classes also known as blocks.
We set S(r) = S
n S(r)
n ; the corresponding objects are called set partitions (the latter
not to be confused with integer partitions examined in Section I. 3). The enumeration
problem for set partitions is closely related to that of surjections. Symbolically, a
partition is determined as a labelled set of classes (blocks), each of which is a non-
empty urn. Thus, one has
(14)
S(r) = SETr{V}, V = SET≥1{Z}
=⇒
S(r)(z) = 1
r! (ez −1)r .
The basic formula connecting the two counting sequences is, in accordance with (10)
and (14),
S(r)
n
= 1
r!R(r)
n
This can be interpreted directly along the lines of the proof of Theorem II.1: an r–
partition is associated with a group of exactly r! distinct r–surjections, two surjections
belonging to the same group iff one obtains from the other by permuting the range
values, [1 . . r].
The numbers S(r)
n
= n![zn]S(r)(z) are known as the Stirling numbers of the sec-
ond kind, or better, the Stirling “partition” numbers. They were brieﬂy encountered
in the previous chapter and discussed in connection with encodings by words (Chap-
ter I, p. 59). Knuth, following Karamata, advocated for the S(r)
n
the notation
n
r
	
.
From (11), an explicit form also exists:
(15)
S(r)
n
≡
n
r

= 1
r!
r
X
j=0
r
j

(−1)j(r −j)n.
The books by Graham, Knuth, and Patashnik [248] and Comtet [98] contain a thor-
ough discussion of these numbers; see also APPENDIX A: Stirling numbers, p. 680.
All surjections and set partitions. Deﬁne now the collection of all surjections
and all set partitions by
R =
[
r
R(r),
S =
[
r
S(r).
Thus Rn is the class of all surjections of [1 . . n] onto any initial segment of the inte-
gers, and Sn is the class of all partitions of the set [1 . . n] into any number of blocks
(Figure 4). Symbolically, one has
(16)
R = SEQ(SET≥1{Z})
=⇒
R(z) =
1
2 −ez
S = SET(SET≥1{Z})
=⇒
S(z) = eez−1.
The numbers Rn = n! [zn]R(z) and Sn = n![zn]S(z) are called surjection num-
bers (also, “preferential arrangements” numbers, EIS A000670) and Bell numbers
(EIS A000110) respectively. These numbers are well determined by expanding the

II. 3. SURJECTIONS, SET PARTITIONS, AND WORDS
101
4
3
2
1
3
2
1
2
1
2
1
1
3
2
1
2
3
1
1
3
2
3
2
1
4
3
2
1
3
4
2
1
2
4
3
1
1
4
3
2
4
3
2
1
4
2
3
1
3
2
4
1
4
3
2
1
4
2
3
1
3
2
4
1
4
1
3
2
3
1
4
2
2
1
4
3
4
3
2
1
FIGURE II.4.
A complete listing of all set partitions for sizes n = 1, 2, 3, 4. The
corresponding sequence 1, 1, 2, 5, 15, . . . is formed of Bell numbers, EIS A000110.
EGFs:
R(z)
=
1 + z + 3 z2
2! + 13 z3
3! + 75 z4
4! + 541 z5
5! + 4683 z6
6! + 47293 z7
7! + · · ·
S(z)
=
1 + z + 2 z2
2! + 5 z3
3! + 15 z4
4! + 52 z5
5! + 203 z6
6! + 877 z7
7! + · · · .
Explicit expressions as ﬁnite double sums result from summing Stirling numbers,
Rn =
X
r≥0
r!
n
r

,
and
Sn =
X
r≥0
n
r

,
where each Stirling number is itself a sum given by (15). Alternatively, single (though
inﬁnite) sums result from the expansions









R(z)
=
1
2
1
1 −1
2ez
=
∞
X
ℓ=0
1
2ℓ+1 eℓz
and







S(z)
=
eez−1 = 1
eeez
=
1
e
∞
X
ℓ=0
1
ℓ!eℓz,
from which coefﬁcient extraction yields
Rn
=
1
2
∞
X
ℓ=0
ℓn
2ℓ
and
Sn
=
1
e
∞
X
ℓ=0
ℓn
ℓ! .
The formula for Bell numbers was found by Dobinski in 1877.
The asymptotic analysis of the surjection numbers (Rn) will be performed in
Chapter IV as one of the very ﬁrst illustrations of complex asymptotic methods (the
meromorphic case); that of Bell’s partition numbers is best done by means of the
saddle point method exposed in Chapter IX. The asymptotic forms found are
(17)
Rn ∼n!
2
1
(log 2)n+1
and
Sn ∼n!
eer(n)−1
r(n)n+1p
2π exp(r(n))
,

102
II. LABELLED STRUCTURES AND EGFS
where r(n) is the positive root of the equation rer = n. One has r(n) ∼log n −
log log n, so that
log Sn = n (log n −log log n −1 + o(1)) .
Elementary derivations (i.e., based solely on real analysis) of these asymptotic forms
are also possible as discussed brieﬂy in APPENDIX B: Laplace’s method, p. 700.
The line of reasoning adopted for the enumeration of surjections viewed as sequences-
of-sets and partitions viewed as sets-of-sets yields a general result that is applicable to
a wide variety of constrained objects.
Proposition II.2. Let R(A,B) be the class of surjections where the cardinalities of
the preimages lie in A ⊆Z≥1 and the cardinality of the range belongs to B. The
corresponding EGF is
R(A,B)(z) = β(α(z))
where
α(z) =
X
a∈A
za
a! ,
β(z) =
X
b∈B
zb.
Let S(A,B) be the class of set partitions with part sizes in A ⊆Z≥1 and with a
number of blocks that belongs to B. The corresponding EGF is
S(A,B)(z) = β(α(z))
where
α(z) =
X
a∈A
za
a! ,
β(z) =
X
b∈B
zb
b! .
PROOF. One has
R(A,B) = SEQB{SETA{Z}}
and
S(A,B) = SETB{SETA{Z}},
where, as usual, the subscript X speciﬁes a construction with a number of components
restricted to the integer set X.
□
EXAMPLE II.6.
Smallest and largest blocks in set partitions. Let eb(z) denote the truncated
exponential function,
eb(z) := 1 + z
1! + z2
2! + · · · + zb
b! .
The EGFs S⟨≤b⟩(z) = exp(eb(z) −1) and S⟨>b⟩(z) = exp(ez −eb(z)), correspond to parti-
tions with all blocks of size ≤b and all blocks of size > b, respectively. END OF EXAMPLE II.6. □
 II.5. No singletons. The EGF of partitions without singleton parts is eez−1−z. The EGF of
“double surjections” (each preimage contains at least two elements) is (2 + z −ez)−1.

EXAMPLE II.7.
Comtet’s square. An exercise in Comtet’s book [98, Ex. 13, p. 225] serves
beautifully to illustrate the power of the symbolic method. The question is to enumerate set
partitions such that a parity constraint is satisﬁed by the number of blocks and/or the number of
elements in each block. Then, the EGFs are tabulated as follows:
Set partitions
Any # of blocks
Odd # of blocks
Even # of blocks
Any block sizes
eez−1
sinh(ez −1)
cosh(ez −1)
Odd block sizes
esinh z
sinh(sinh z)
cosh(sinh z)
Even block sizes
ecosh z−1
sinh(cosh z −1)
cosh(cosh z −1)

II. 3. SURJECTIONS, SET PARTITIONS, AND WORDS
103
The proof is a direct application of Proposition II.2, upon noting that
ez,
sinh z,
cosh z
are the characteristic EGFs of Z≥0, 2Z≥0 + 1, and 2Z≥0 respectively. The sought EGFs are
then obtained by forming the compositions
( exp
sinh
cosh
)
◦
( −1 + exp
sinh
−1 + cosh
)
,
in accordance with general principles. . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE II.7. □
II. 3.2. Applications to words and random allocations. Numerous enumera-
tive problems present themselves when analysing statistics on letters in words. They
ﬁnd applications in the study of random allocations and the design of hashing algo-
rithms of computer science [434]. Fix an alphabet
X = {a1, a2, . . . , ar}
of cardinality r, and let W be the class of all words over the alphabet X, the size
of a word being its length. A word of length n, w ∈Wn, is an unconstrained
function from [1 . . n] to [1 . . r], the function associating to each position the value
of the corresponding letter in the word (canonically numbered from 1 to r). For
instance, let X = {a, b, c, d, r} and take the letters of X canonically numbered as
a1 = a, . . . , a5 = r; for the word w = ‘abracadabra’, the table giving the position-
to-letter mapping is
 a
b
r
a
c
a
d
a
b
r
a
1
2
3
4
5
6
7
8
9
10
11
1
2
5
1
3
1
4
1
2
5
1
!
,
which is itself determined by its sequence of preimages:
a=a1
z
}|
{
{1, 4, 6, 8, 11},
b=a2
z }| {
{2, 9},
c=a3
z}|{
{5},
d=a4
z}|{
{7} ,
r=a5
z }| {
{3, 10}.
(In this particular case, all preimages are nonempty, but this need not always the case.)
The decomposition based on preimages then gives, with U the class of all urns
(18)
W ≃Ur ≡SEQr{U}
=⇒
W(z) = (ez)r = erz,
which yields back Wn = rn, as was to be expected. In summary: words over an r-ary
alphabet are equivalent to functions into a set of cardinality r and are described by an
r-fold labelled product.
For the situation where restrictions are imposed on the number of occurrences of
letters, the decomposition (18) generalizes as follows.
Proposition II.3. Let W(A) denote the family of words such that the number of oc-
currences of each letter lies in a set A. Then
(19)
W (A)(z) = α(z)r
where
α(z) =
X
a∈A
za
a! .

104
II. LABELLED STRUCTURES AND EGFS
The proof is a one-liner: W(A) ∼= SEQr(SETA(Z)). Though this result is tech-
nically a shallow consequence of the symbolic method, it has several important appli-
cations in discrete probability; see [434, Ch. 8] for a discussion along the lines of the
symbolic method.
EXAMPLE II.8.
Restricted words. The EGF of words containing at most b times each letter,
and that of words containing more than b times each letter are
(20)
W⟨≤b⟩(z) = (eb(z))r ,
W⟨>b⟩(z) = (ez −eb(z))r ,
respectively. (Observe the analogy with Example 6.) Taking b = 1 in the ﬁrst formula gives the
number of n–arrangements of r elements (i.e., of ordered combinations of n elements amongst r
possibilities),
(21)
n! [zn](1 + z)r = n!
 
r
n
!
= r(r −1) · · · (r −n + 1),
as anticipated; taking b = 0, but now in the second formula, gives back the number of r-
surjections. For general b, the generating functions of (20) contain valuable information on the
least frequent and most frequent letter in random words. . . . . . . . . END OF EXAMPLE II.8. □
EXAMPLE II.9. Random allocations (balls-in-bins model). Throw at random n distinguishable
balls into m distinguishable bins. A particular realization is described by a word of length n
(balls are distinguishable, say, as numbers from 1 to n) over an alphabet of cardinality m (rep-
resenting the bins chosen). Let Min and Max represent the size of the least ﬁlled and most ﬁlled
bins, respectively. Then4,
(22)
P{Max ≤b}
=
n! [zn]eb
“ z
m
”m
P{Max > b}
=
n! [zn]
“
ez/m −eb
“ z
m
””m
.
The justiﬁcation of this formula relies on the easy identity
(23)
1
mn [zn]f(z) ≡[zn]f( z
m ),
and on the fact that a probability is determined as the ratio between the number of favourable
cases (given by (20)) and the total number of cases (mn). The formulæ of (22) lend themselves
to evaluation using symbolic manipulations systems; for instance, with m = 100 and n = 200,
one ﬁnds for P(Max = k), where k = 2, 4, 5, . . ., the values:
2
4
5
6
7
8
9
12
15
20
10−55 1.4 · 10−3 0.17 0.46 0.26 0.07 0.01 9.2 · 10−5 2.3 · 10−7 4.7 · 10−10
The values k = 5, 6, 7, 8 concentrate about 99% of the probability mass.
An especially interesting case is when m and n are asymptotically proportional, that is,
n/m = α and α lies in a compact subinterval of (0, +∞). In that case, with probability
tending to 1 as n tends to inﬁnity, one has
Min = 0,
Max ∼
log n
log log n.
In other words, there are almost surely empty urns (in fact many of them, see Example 9 in
Chapter III) and the most ﬁlled urn grows logarithmically in size. Such probabilistic prop-
erties are best established by complex analytic methods (especially the saddle point method
4We let P(E) represent the probability of an event E and E(X) the expectation of the random vari-
able X; cf APPENDIX C: Random variables, p. 717.

II. 3. SURJECTIONS, SET PARTITIONS, AND WORDS
105
detailed in Chapter VIII) based on exact generating representations like (20) and (22). They
form the core of the reference book [316] by Kolchin, Sevastyanov, and Chistyakov. The re-
sulting estimates are in turn invaluable in the analysis of hashing algorithms [242, 307, 434]
to which the balls-in-bins model has been recognized to apply with great accuracy [347].
END OF EXAMPLE II.9. □
 II.6. Number of different letters in words. The probability that a random word of length n
over an alphabet of cardinality r contains k different letters is
p(r)
n,k := 1
rn
 
r
k
!(
n
k
)
k!
(Choose k letters amongst r, then split the n positions into k distinguished nonempty classes.)
The quantity p(r)
n,k is also the probability that a random mapping from [1 . . n] to [1 . . r] has an
image of cardinality k.

 II.7. Arrangements. An arrangement of size n is an ordered combination of (some) elements
of [1 . . n]. Let A be the class of all arrangements. Grouping together all the possible elements
not present in the arrangement into an urn shows that a speciﬁcation and its companion EGF
are
A ≃U ⋆P, U = SET{Z}, P = SEQ{Z}
=⇒
A(z) =
ez
1 −z .
The counting sequence An = Pn
k=0
n!
k! starts as 1, 2, 5, 16, 65, 326, 1957 (EIS A000522); see
also Comtet [98, p. 75].

Birthday paradox and coupon collector problem. The next two examples illus-
trate applications of EGFs to two classical problems of probability theory, the birthday
paradox and the coupon collector problem. Assume that there is a very long line of
persons ready to enter a very large room one by one. Each person is let in and de-
clares her birthday upon entering the room. How many people must enter in order
to ﬁnd two that have the same birthday? The birthday paradox is the counterintuitive
fact that on average a birthday collision takes place as early as n .= 24. Dually, the
coupon collector problem asks for the average number of persons that must enter in
order to exhaust all the possible days in the year as birthdates. In this case, the an-
swer is the rather large number n′ .= 2364. The term “coupon collection” alludes
to the situation where images or coupons of various sorts are inserted in sales items
and some premium is given to those who succeed in gathering a complete collection.
The birthday problem and the coupon collector problem are relative to a potentially
inﬁnite sequence of events; however, the fact that the ﬁrst birthday collision or the
ﬁrst complete collection occurs at any ﬁxed time n only involves ﬁnite events. The
following diagram illustrates the events of interest:
-
INJECTIVE
SURJECTIVE
B (1st collision)
C (complete collection)
n = 0
n →+∞
/////////////////////////////////
In other words, we seek the time at which injectivity ceases to hold (the ﬁrst birthday
collision, B) and the time at which surjectivity begins to be satisﬁed (a complete

106
II. LABELLED STRUCTURES AND EGFS
collection, C). In what follows, we consider a year with r days (readers from earth
may take r = 365) and let X represent an alphabet with r letters (the days in the year).
EXAMPLE II.10. Birthday paradox. Let B be the time of the ﬁrst collision, which is a random
variable ranging between 2 and r + 1 (where the upperbound derives from the pigeonhole prin-
ciple). A collision has not yet occurred at time n, if the sequence of birthdates β1, . . . , βn has
no repetition. In other words, the function β from [1 . . n] to X must be injective; equivalently,
β1, . . . , βn is an n-arrangement of r objects. Thus, we have the fundamental relation
(24)
P {B > n}
=
r(r −1) · · · (r −n + 1)
rn
=
n!
rn [zn](1 + z)r
=
n! [zn]
“
1 + z
r
”r
,
where the second line repeats (21) and the third results from the series transformation (23).
The expectation of the random variable B is elementarily
(25)
E(B) =
∞
X
n=0
P {B > n} ,
this by virtue of a general formula valid for all discrete random variables (APPENDIX C: Ran-
dom variables, p. 717). From (24), line 1, this gives us a sum expressing the expectation,
namely,
E(B) = 1 +
r
X
n=1
r(r −1) · · · (r −n + 1)
rn
.
For instance, with r = 365, one ﬁnds that the expectation is the rational number,
E(B) = 12681 · · · 06674
51517 · · · 40625
.= 24.61658,
where the denominator comprises as much as 864 digits.
An alternative form of the expectation derives from the generating function involved in (24),
line 3. Let f(z) = P
n fnzn be an entire function with nonnegative coefﬁcients. Then the for-
mula
(26)
∞
X
n=0
fnn! =
Z ∞
0
e−tf(t) dt,
is valid provided either the sum or the integral on the right converges. The reason is the usual
Eulerian representation of factorials,
n! =
Z ∞
0
e−ttn dt.
Applying this principle to (25) with the probabilities given by (24) (third line), one ﬁnds
(27)
E(B) =
Z ∞
0
e−t
„
1 + t
r
«r
dt.
This last form is easily amenable to asymptotic analysis and the Laplace method5 (see APPEN-
DIX B: Laplace’s method, p. 700) provides the estimation
(28)
E(B) =
r
πr
2 + 2
3 + O(r−1/2),
5Knuth [306, Sec. 1.2.11.3] uses this calculation as a pilot example for (real) asymptotic analysis; the
quantity E(B) is related to Ramanujan’s Q-function (see also Eq. (45) below) by E(B) = 1 + Q(r).

II. 3. SURJECTIONS, SET PARTITIONS, AND WORDS
107
0
5
10
15
20
20
40
60
80
(letter chosen)
(time of arrival)
FIGURE II.5.
A sample realization of the “birthday paradox” and “coupon collection”
with an alphabet of r = 20 letters. The ﬁrst collision occurs at time B = 6 while the
collection becomes complete at time C = 87.
as r tends to inﬁnity. For instance, the asymptotic approximation given by the ﬁrst two terms
of (28) is 24.61119, which represents a relative error of only 2 · 10−4.
The interest of such integral representations based on generating function is that they are
robust: they adjust naturally to many kinds of combinatorial conditions. For instance, the ex-
pected time necessary for the ﬁrst occurrence of the event “b persons have the same birthday”
is found to have expectation given by the integral
(29)
I(r, b) :=
Z ∞
0
e−teb−1
„ t
r
«r
dt.
(The basic birthday paradox corresponds to b = 2.) The formula (29) was ﬁrst derived by
Klamkin and Newman in 1967; their paper [293] shows in addition that
I(r, b) ∼
r→∞
b√
b! Γ
„
1 + 1
b
«
r1−1/b,
where the asymptotic form evaluates to 82.87 for r = 365 and b = 3, while the exact
value of the expectation is 88.73891.
Thus three-way collisions also tend to occur much
sooner than one might think, with about 89 persons on average.
Globally, such develop-
ments illustrate the versatility of the symbolic approach to many basic probabilistic problems.
END OF EXAMPLE II.10. □
 II.8. The probability distribution of time till a birthday collision. Elementary approximations
show that, for large r, and in the “central” regime n = t√r, one has
P(B > t√r) ∼e−t2/2,
P(B = t√r) ∼
1
√r te−t2/2.
The continuous probability distribution with density te−t2/2 is called a Rayleigh distribution.
Saddle point methods (Chapter VIII) may be used to show that for the ﬁrst occurrence of a
b-fold birthday collision: P(B > tr1−1/b) ∼e−tb/b!.


108
II. LABELLED STRUCTURES AND EGFS
EXAMPLE II.11.
Coupon collector problem. This problem is dual to the birthday paradox.
We ask for the ﬁrst time C when β1, . . . , βC contains all the elements of X , that is, all the
possible birthdates have been “collected”. In other words, the event {C ≤n} means the
equality between sets, {β1, . . . , βn} = X . Thus, the probabilities satisfy
(30)
P {C ≤n}
=
R(r)
n
rn
= r!
˘n
r
¯
rn
=
n!
rn [zn] (ez −1)r
=
n![zn]
“
ez/r −1
”r
,
by our earlier enumeration of surjections. The complementary probabilities are then
P {C > n} = 1 −P {C ≤n} = n![zn]
“
ez −
“
ez/r −1
”r”
.
An application of the Eulerian integral trick of (27) then provides a representation of the expec-
tation of the time needed for a full collection as
(31)
E(C) =
Z ∞
0
“
1 −(1 −e−t/r)r”
dt.
A simple calculation (expand by the binomial theorem and integrate termwise) shows that
E(C) = r
r
X
j=1
 
r
j
!
(−1)j−1
j
,
which constitutes a ﬁrst answer to the coupon collector problem in the form of an alternating
sum. Alternatively, in (31), perform the change of variables v = 1 −e−t/r, then expand and
integrate termwise; this process provides the more tractable form
(32)
E(C) = r Hr,
where Hr is the harmonic number:
Hr = 1 + 1
2 + 1
3 + · · · + 1
r .
Formula (32) is by the way easy to interpret directly6: one needs on average 1 = r/r trials to
get the ﬁrst day, then r/(r −1) to get a different day, etc.
Regarding (32), one has available the well-known formula (by comparing sums with inte-
grals or by Euler-Maclaurin summation),
Hr = log r + γ + 1
2r + O(r−2),
γ .= 0.57721 56649,
where γ is known as Euler’s constant. Thus, the expected time for a full collection satisﬁes
(33)
E(C) = r log r + γr + 1
2 + O(r−1).
Here the “surprise” lies in the nonlinear growth of the expected time for a full collection. For
a year on earth, r = 365, the exact expected value is .= 2364.64602 while the approximation
provided by the ﬁrst three terms of (33) yields 2364.64625, representing a relative error of only
one in ten millions.
6Such elementary derivations are very much problem speciﬁc: contrary to the symbolic method, they
do not usually generalize to more complex situations.

II. 3. SURJECTIONS, SET PARTITIONS, AND WORDS
109
As usual, the symbolic treatment adapts to a variety of situations, for instance, to multiple
collections. The expected time till each item (birthday or coupon) is obtained b times (the
standard case corresponds to b = 1) equals the quantity
J(r, b) =
Z ∞
0
“
1 −
“
1 −eb−1(t/r)e−t/r”r”
dt,
an expression that vastly generalizes (31). From there, one ﬁnds [372]
J(r, b) = r (log r + (b −1) log log r + γ −log(b −1)! + o(1)) ,
so that only a few more trials are needed in order to obtain additional collections. END OF EXAMPLE II.11. □
 II.9. The little sister. The coupon collector has a little sister to whom he gives his duplicates.
Foata, Lass, and Han [218] show that the little sister misses on average Hr coupons when her
big brother ﬁrst obtains a complete collection.

 II.10. The probability distribution of time till a complete collection. The saddle point method
(Chapter VIII) may be used to prove that, in the regime n = r log r + tr:
lim
t→∞P(C ≤r log r + tr) = e−e−t.
This continuous probability distribution is known a double exponential distribution. For the
time C(b) till a collection of multiplicity b, one has
lim
t→∞P(C(b) < r log r + (b −1)r log log r + tr) = exp(−e−t/(b −1)!),
a property known as the Erd˝os-R´enyi law, which ﬁnds applications in the study of random
graphs [154].

Words as both labelled and unlabelled objects. What distinguishes a labelled
structure from an unlabelled one? There is nothing intrinsic there, and everything is in
the eye of the beholder—or rather in the type of construction adopted when modelling
a speciﬁc problem. Take the class of words W over an alphabet of cardinality r. The
two generating functions (an OGF and an EGF respectively),
c
W(z) ≡
X
n
Wnzn =
1
1 −rz
and
W(z) ≡
X
n
Wn
zn
n! = erz,
leading in both cases to Wn = rn, correspond to two different ways of constructing
words: the ﬁrst one directly as an unlabelled sequence, the other one as a labelled
power of letter positions. A similar situation arises for r–partitions, for which we
found as OGF and EGF,
bS(r)(z) =
zr
(1 −z)(1 −2z) · · · (1 −rz)
and
S(r)(z) = (ez −1)r
r!
,
by viewing these either as unlabelled structures (an encoding via words of a regular
language, see Section I.4.3) or directly as labelled structures.
 II.11. Balls switching chambers: the Ehrenfest2 model. Consider a system of two chambers
A and B (also classically called “urns”). There are N distinguishable balls, and, initially,
chamber A contains them all. At any instant 1
2, 3
2, . . ., one ball is allowed to change from one
chamber to the other. Let E[ℓ]
n be the number of possible evolutions that lead to chamber A
containing ℓballs at instant n and E[ℓ](z) the corresponding EGF. Then
E[ℓ](z) =
 
N
ℓ
!
(cosh z)ℓ(sinh z)N−ℓ,
E[N](z) = (cosh z)N ≡2−N(ez + e−z)N.

110
II. LABELLED STRUCTURES AND EGFS
[Hint: the EGF E[N] enumerates mappings where each preimage has an even cardinality.] In
particular the probability that urn A is again full at time 2n is
1
2NN 2n
N
X
k=0
 
N
k
!
(N −2k)2n.
This famous model was introduced by Paul and Tatiana Ehrenfest [148] in 1907, as a simpliﬁed
model of heat transfer. It helped resolve the apparent contradiction between irreversibility in
thermodynamics (the case N →∞) and recurrence of systems undergoing ergodic transforma-
tions (the case N < ∞). See especially Mark Kac’s discussion [288]. The analysis can also
be carried out by combinatorial methods akin to those of weighted lattice paths: see Note V.22,
p. 313 and [245].

II. 4. Alignments, permutations, and related structures
In this section, we start by considering speciﬁcations built by piling up two con-
structions, sequences-of-cycles and sets-of-cycles respectively. They deﬁne a new
class of objects, alignments, while serving to specify permutations in a novel way
as detailed below. (These speciﬁcations otherwise parallel surjections and set parti-
tions.) Permutations are in this context examined under their cycle decomposition,
the corresponding enumerative results being the most important ones combinatorially
(Subsection II. 4.1). In Subsection II. 4.2, we recapitulate the meaning of classes that
can be deﬁned iteratively by a combination of any two nested labelled constructions.
II. 4.1. Alignments and Permutations. The two speciﬁcations under consider-
ation here are
(34)
O = SEQ{CYC{Z}},
and
P = SET{CYC{Z}},
deﬁning new objects called alignments (O) and an important decomposition of per-
mutations (P).
Alignments. An alignment is a well-labelled sequence of cycles. Let O be the
class of all alignments. Schematically, one can visualize an alignment as a collection
of directed cycles arranged in a linear order, somewhat like slices of a sausage fastened
on a skewer:
The symbolic method provides,
O = SEQ{CYC{Z}}
=⇒
O(z) =
1
1 −log(1 −z)−1 ,
and the expansion starts as
O(z) = 1 + z + 3z2
2! + 14z3
3! + 88z4
4! + 694z5
5! + · · · ,

II. 4. ALIGNMENTS, PERMUTATIONS, AND RELATED STRUCTURES
111
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
A permutation may be viewed as a set of cycles that are labelled circular digraphs. The diagram
shows the decomposition of the permutation
σ =
„
1
2
3
4
5
6
7
8 9 10 11 12 13 14 15 16 17
11 12 13 17 10 15 14 9 3
4
6
2
7
8
1
5
16
«
.
(Cycles read here clockwise and i is connected to σi by an edge in the graph.)
FIGURE II.6. The cycle decomposition of permutations.
but the coefﬁcients (EIS A007840: “ordered factorizations of permutations into cy-
cles”) appear to admit of no simple form.
Permutations and cycles. From elementary mathematics, it is known that a per-
mutation admits a unique decomposition into cycles. Let σ = σ1 . . . σn be a permu-
tation. Start with any element, say 1, and draw a directed edge from 1 to σ(1), then
continue connecting to σ2(1), σ3(1), and so on; a cycle containing 1 is obtained after
at most n steps. If one repeats the construction, taking at each stage an element not yet
connected to earlier ones, the cycle decomposition of the permutation σ is obtained.
This argument shows that the class of sets-of-cycles (corresponding to P in (34)) is
isomorphic to the class of permutations as deﬁned in Section II. 1:
P = SET{CYC{Z}} ∼= SEQ{Z}.
This combinatorial isomorphism is reﬂected by the obvious series identity
P(z) = exp

log
1
1 −z

=
1
1 −z .
The property that exp and log are inverse of one another is an analytic reﬂex of the
combinatorial fact that permutations uniquely decompose into cycles!
As regards combinatorial applications, what is especially fruitful is the variety of
specializations of the construction of permutations from cycles. We state:
Proposition II.4. Let P(A,B) be the class of permutations with cycle lengths in A ⊆
Z>0 and with a number of cycles that belongs to B ⊆Z≥0. The corresponding EGF
is
P (A,B)(z) = β(α(z))
where
α(z) =
X
a∈A
za
a , β(z) =
X
b∈B
zb
b! .
EXAMPLE II.12.
Stirling cycle numbers.
The number of permutations of size n comprised
of r cycles is determined by the explicit generating function, to the effect that
(35)
P (r)
n
= n!
r! [zn]
„
log
1
1 −z
«r
.

112
II. LABELLED STRUCTURES AND EGFS
These numbers are fundamental quantities of combinatorial analysis. They are known as the
Stirling numbers of the ﬁrst kind, or better, according to a proposal of Knuth, the Stirling cycle
numbers. Together with the Stirling partition numbers, the properties of the Stirling cycle num-
bers are explored in the book by Graham, Knuth, and Patashnik [248] where they are denoted
by
ˆn
r
˜
. See APPENDIX A: Stirling numbers, p. 680. (Note that the number of alignments
formed with r cycles is r!
ˆn
r
˜
.) As we shall see shortly (p. 130) Stirling numbers also surface in
the enumeration of permutations by their number of records.
It is also of interest to determine what happens regarding cycles in a random permutation of
size n. Clearly, when the uniform distribution is placed over all elements of Pn, each particular
permutation has probability exactly 1/n!. Since the probability of an event is the quotient of
the number of favourable cases over the total number of cases, the quantity
pn,k := 1
n!
"
n
k
#
is the probability that a random element of Pn has k cycles. This probabilities can be effectively
determined for moderate values of n from (35) by means of a computer algebra system. Here
are for instance selected values for n = 100:
k :
1
2
3
4
5
6
7
8
9
10
pn,k :
0.01
0.05
0.12
0.19
0.21
0.17
0.11
0.06
0.03
0.01 .
For this value n = 100, we expect in a vast majority of cases the number of cycles to be in the
interval [1, 10]. (The residual probability is only about 0.005.) Under this probabilistic model,
the mean is found to be about 5.18. Thus: A random permutation of size 100 has on average a
little more than 5 cycles; it rarely has more than 10 cycles.
Such procedures demonstrate a direct exploitation of symbolic methods. They do not
however tell us how the number of cycles could depend on n as n varies. Such questions are to
be examined systematically in Chapter III. Here, we shall content ourselves with a brief sketch.
First, form the bivariate generating function,
P(z, u) :=
∞
X
r=0
P (r)(z)ur,
and observe that
P(z, u)
=
∞
X
r=0
ur
r!
„
log
1
1 −z
«r
= exp
„
u log
1
1 −z
«
=
(1 −z)−u.
Newton’s binomial theorem then provides
[zn](1 −z)−u = (−1)n
 
−u
n
!
.
In other words, a simple formula
(36)
n
X
k=0
"
n
k
#
uk = u(u + 1)(u + 2) · · · (u + n −1)
encodes precisely all the Stirling cycle numbers corresponding to a ﬁxed value of n. From there,
the expected number of cycles, µn := P
k kpn,k is easily found (use logarithmic differentiation
of (36)),
µn = Hn = 1 + 1
2 + · · · + 1
n.

II. 4. ALIGNMENTS, PERMUTATIONS, AND RELATED STRUCTURES
113
In particular, one has µ100 ≡H100 .= 5.18738. In general: The mean number of cycles in a ran-
dom permutation of size n grows logarithmically with n, µn ∼log n. END OF EXAMPLE II.12. □
EXAMPLE II.13.
Involutions and permutations without long cycles. A permutation σ is an
involution if σ2 = Id with Id the identity permutation. Clearly, an involution can have only
cycles of sizes 1 and 2. The class I of all involutions thus satisﬁes
(37)
I = SET{CYC1,2{Z}}
=⇒
I(z) = exp
„
z + z2
2
«
.
The explicit form of the EGF lends itself to expansion,
In =
⌊n/2⌋
X
k=0
n!
(n −2k)!2kk!,
which solves the counting problem explicitly. A pairing is an involution without ﬁxed point.
In other words, only cycles of length 2 are allowed, so that
J = SET(CYC2(Z))
=⇒
J(z) = ez2/2,
J2n = 1 · 3 · 5 · · · (2n −1).
(The formula for Jn, hence that of In, can be checked by a direct reasoning.)
Generally, the EGF of permutations, all of whose cycles (in particular the largest one) have
length at most equal to r satisﬁes
B(r)(z) = exp
 
r
X
j=1
zj
j
!
.
The numbers b(r)
n
= [zn]B(r)(z) satisfy the recurrence
(n + 1)b(r)
n+1 = (n + 1)b(r)
n
−b(r)
n−r,
by which they can be computed fast. This gives access to the statistics of the longest cycle in a
permutation. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE II.13. □
EXAMPLE II.14. Derangements and permutations without short cycles.
Classically, a de-
rangement is deﬁned as a permutation without ﬁxed points, i.e., σi ̸= i for all i. Given an
integer r, an r–derangement is a permutation all of whose cycles (in particular the shortest one)
have length larger than r. Let D(r) be the class of all r–derangements. A speciﬁcation is
(38)
D(r) = SET{CYC>r{Z}},
the corresponding EGF being then
(39)
D(r)(z) = exp
 X
j>r
zj
j
!
=
exp(−Pr
j=1
zj
j )
1 −z
.
For instance, when r = 1, a direct expansion yields
D(1)
n
n!
= 1 −1
1! + 1
2! −· · · + (−1)n
n!
,
a truncation of the series expansion of exp(−1) that converges fast to e−1. Phrased differently,
the enumeration of derangements is a famous combinatorial problem with a pleasantly quaint
nineteenth century formulation [98]: “A number n of people go to opera, leave their hats on
hooks in the cloakroom and grab them at random when leaving; the probability that nobody gets
back his own hat is asymptotic to 1/e, which is nearly 37%”. (The usual proof uses an inclusion-
exclusion argument. Also, it is a sign of changing times that Motwani and Raghavan [370, p. 11]

114
II. LABELLED STRUCTURES AND EGFS
All perms
Derangements
1
1 −z
e−z
1 −z
Involutions
Pairings
ez+z2/2
ez2/2
Shortest cycle > r
exp
“
−z
1 −z2
2 −· · · −zr
r
”
1 −z
Longest cycle ≤r
exp
“
z
1 + z2
2 + · · · + zr
r
”
FIGURE II.7.
A summary of major EGFs related to permutations.
describe the problem as one of sailors that return in a state of inebriation and choose random
cabins to sleep in.) For the generalized derangement problem, there holds, for any ﬁxed r,
(40)
D(r)
n
n!
∼e−Hr,
as is proved easily by complex asymptotic methods (Chapter IV). END OF EXAMPLE II.14. □
Like several other structures that we have been considering previously, permu-
tation allow for transparent connections between structural constraints and the forms
of generating functions. The major counting results encountered in this section are
summarized in Figure 7.
 II.12. Permutations such that σf = Id. Such permutations are “roots of unity” in the
symmetric group. Their EGF is
exp
0
@X
d | f
zd
d
1
A ,
where the sum extends to all divisors d of f.

 II.13. Parity constraints in permutations. The EGFs of permutations having only even size
cycles (E(z)) or odd size cycles (O(z)) are
E(z) = exp
„1
2 log
1
1 −z2
«
=
1
√
1 −z2 ,
O(z) = exp
„1
2 log 1 + z
1 −z
«
=
r
1 + z
1 −z .
From the EGFs, one ﬁnds E2n = (1 · 3 · 5 · · · (2n −1))2, O2n = E2n, O2n+1 = (2n +
1)E2n.
The EGFs of permutations having an even number of cycles (E∗(z)) and an odd number
of cycles (O∗(z)) are
E∗(z) = cosh(log
1
1 −z ) = 1
2
1
1 −z +1
2−z
2, O∗(z) = sinh(log
1
1 −z ) = 1
2
1
1 −z −1
2+z
2,
so that parity of the number of cycles is evenly distributed amongst permutations of size n
as soon as n ≥2. The generating functions obtained in this way are analogous to the ones
appearing in the discussion of “Comtet’s square” in the previous section.

 II.14. A hundred prisoners I. This puzzle originates with a paper of G´al and Miltersen [224,
499]. A hundred prisoners, each uniquely identiﬁed by a number between 1 and 100, have
been sentenced to death. The director of the prison gives them a last chance. He has a cabinet
with 100 drawers (numbered 1 to 100). In each, he’ll place at random a card with a prisoner’s
number (all numbers different). Prisoners will be allowed to enter the room one after the other
and open, then close again, 50 drawers of their own choosing, but will not in any way be allowed
to communicate with one another. The goal of each prisoner is to locate the drawer that contains

II. 4. ALIGNMENTS, PERMUTATIONS, AND RELATED STRUCTURES
115
his own number. If all prisoners succeed, then they will all be spared; if at least one fails, they
will all be executed.
There are two mathematicans amongst the prisoners. The ﬁrst one, a pessimist, declares
that their overall chances of success are only of the order of 1/2100 .= 8 · 10−31. The second
one, a combinatorialist, claims he has a strategy for the prisoners, which has more than 30%
chances of success. Who is right? [Note III.9, p. 165 provides a solution, but our gentle reader
is advised to reﬂect on the problem for a few moments, before she jumps there.]

II. 4.2. Second level structures. Consider the three basic constructors of la-
belled sequence (SEQ), set (SET), and cycle (CYC). We can play the formal game
of examining what the various combinations produce as combinatorial objects. Re-
stricting attention to superpositions of two constructors (an external one applied to an
internal one) gives nine possibilities summarized by the following table:
ext.\int.
SEQ≥1
SET≥1
CYC
SEQ
Labelled compositions (L)
SEQ ◦SEQ
1 −z
1 −2z
Surjections (R)
SEQ ◦SET
1
2 −ez
Alignments (O)
SEQ ◦CYC
1
1 −log(1 −z)−1
SET
Fragmented permutations (F)
SET ◦SEQ
ez/(1−z)
Set partitions (S)
SET ◦SET
eez−1
Permutations (P)
SET ◦CYC
1
1 −z
CYC
Supernecklaces (SI)
CYC ◦SEQ
log 1 −z
1 −2z
Supernecklaces (SII)
CYC ◦SET
log(2 −ez)−1
Supernecklaces (SIII)
CYC ◦CYC
log
1
1 −log(1 −z)−1
The classes of surjections, alignments, set partitions, and permutations appear
naturally as SEQ ◦SET, SEQ ◦CYC, SET ◦SET, and SET ◦CYC (top right corner).
The other ones represent essentially nonclassical objects. The case of L corresponding
to SEQ ◦SEQ describes objects that are (ordered) sequences of linear graphs; this can
be interpreted as permutations with separators inserted, e.g, 53|264|1, or alternatively
as integer compositions with a labelling superimposed, so that Ln = n! 2n−1. The
class F = SET{SEQ≥1{Z}} corresponds to unordered collections of permutations;
in other words, “fragments” are obtained by breaking a permutation into pieces (pieces
must be nonempty for deﬁniteness). The interesting EGF is
F(z) = ez/(1−z) = 1 + z + 3z2
2! + 13z3
3! + 73z4
4! + · · · ,
(EIS A000262: “sets of lists”). The corresponding asymptotic analysis serves to illus-
trate an important aspect of the saddle point method in Chapter VIII. What we termed
“supernecklaces” in the last row represents cyclic arrangements of composite objects
existing in three brands.

116
II. LABELLED STRUCTURES AND EGFS
All sorts of reﬁnements, of which Figure 7 may give an idea, are clearly possible.
We leave to the reader’s imagination the task of determining which amongst the level 3
structures may be of combinatorial interest. . .
 II.15. A meta-exercise: Counting speciﬁcations of level n. The algebra of constructions
satisﬁes the combinatorial isomorphism SET{CYC{X }} ∼= SEQ{X} for all X . How many
different terms involving n constructions can be built from three symbols CYC, SET, SEQ sat-
isfying a semi-group law (‘◦’) together with the relation SET ◦CYC = SEQ? This determines
the number of speciﬁcations of level n. [Hint: the OGF is rational as normal forms correspond
to words with an excluded pattern.]

II. 5. Labelled trees, mappings, and graphs
In this section, we consider labelled trees as well as other important structures that
are naturally associated with them, namely mappings and functional graphs on one
side, graphs of small excess on the other side. Like in the unlabelled case considered
in Section I. 6, the corresponding combinatorial classes are inherently recursive, the
case of trees being typical since a tree is obtained by appending a root to a collection
(set, sequence) of subtrees. From there, it is possible to build the graphs associated
to mappings from a ﬁnite set to itself, as these decompose as sets of connected com-
ponents that are cycles of trees. Variations of these construction ﬁnally open access
to the enumeration of graphs having a ﬁxed excess of the number of edges over the
number of vertices.
II. 5.1. Trees. The trees to be studied here are invariably labelled, so that nodes
bear distinct integer labels. Unless otherwise speciﬁed, they are rooted, meaning as
usual that one node is distinguished as the root. Labelled trees, like their unlabelled
counterparts, exist in two varieties: (i) plane trees where an embedding in the plane
is understood (or, equivalently, subtrees dangling from a node are ordered, say, from
left to right); (ii) nonplane trees where no such embedding is imposed (such trees are
then nothing but connected undirected acyclic graphs with a distinguished root). Trees
may be further restricted by the additional constraint that the node outdegrees should
belong to a ﬁxed set Ω⊆Z≥0 where Ω∋0.
&
1
2
3
4
5
6
7
( 3, 2, 5, 1, 7, 4, 6)
FIGURE II.8.
A labelled plane tree is determined by an unlabelled tree (the “shape”)
and a permutation of the labels 1, . . . , n.

II. 5. LABELLED TREES, MAPPINGS, AND GRAPHS
117
1
2
3
1
2
3
2
1
1
2
2
1
1
3
2
3
2
2
1
2
3
1
3
1
3
1
2
3
2
3
1
1
FIGURE II.9.
There are T1 = 1, T2 = 2, T3 = 9, and in general Tn = nn−1 Cayley
trees of size n.
Plane labelled trees. We ﬁrst dispose of the plane variety of labelled trees. Let
A be the set of (rooted labelled) plane trees constrained by Ω. This family is speciﬁed
by
A = Z ⋆SEQΩ{A},
where Z represents the atomic class consisting of a single labelled node: Z = {1}.
The sequence construction appearing here reﬂects the planar embedding of trees, as
subtrees stemming from a common root are ordered between themselves. Accord-
ingly, the EGF A(z) satisﬁes
A(z) = zφ(A(z))
where
φ(u) =
X
ω∈Ω
uω.
This is exactly the same equation as the one satisﬁed by the ordinary GF of Ω-
restricted unlabelled plane trees (see Proposition I.5). Thus,
1
n!An is the number
of unlabelled trees. In other words: in the plane rooted case, the number of labelled
trees equals n! times the corresponding number of unlabelled trees. As illustrated by
Figure 8, this is easily understood combinatorially: each labelled tree can be deﬁned
by its “shape” that is an unlabelled tree and by the sequence of node labels where
nodes are traversed in some ﬁxed order (preorder, say). Finally, one has, by Lagrange
inversion,
An = n![zn]A(z) = (n −1)![un−1]φ(u)n.
This simple analytic–combinatorial relation enables us to transpose all of the enumer-
ative results of Section I.5.1 to plane labelled trees (upon multiplying the evaluations
by n!, of course). In particular, the total number of “general” plane labelled trees (with
no degree restriction imposed, i.e., Ω= Z≥0) is
n! × 1
n
2n −2
n −1

= (2n −2)!
(n −1)! = 2n−1 (1 · 3 · · · (2n −3)) .
The corresponding sequence starts as 1, 2, 12, 120, 1680 and is EIS A001813.
Nonplane labelled trees. We next turn to labelled nonplane trees (Figure 9) to
which the rest of this section will be devoted. The class T of all such trees is deﬁnable
by a symbolic equation, which provides an implicit equation satisﬁes by the EGF:
(41)
T = Z ⋆SET{T }
=⇒
T (z) = zeT (z).
There the set construction translates the fact that subtrees stemming from the root are
not ordered between themselves. From the speciﬁcation (41), the EGF T (z) is deﬁned

118
II. LABELLED STRUCTURES AND EGFS
implicitly by the “functional equation”
(42)
T (z) = zeT (z).
The ﬁrst few values are easily found, for instance by the method of indeterminate
coefﬁcients,
T (z) = z + 2z2
2! + 9z3
3! + 64z4
4! + 625z5
5! + · · · .
As suggested by the ﬁrst few coefﬁcients(9 = 32, 64 = 43, 625 = 54), the general
formula is
(43)
Tn = nn−1
which is established (like in the case of plane unlabelled trees, Chapter I) by the La-
grange Inversion Theorem (see APPENDIX A: Lagrange Inversion, p. 677).
The enumerative result Tn = nn−1 is a famous one, attributed to the proliﬁc
British mathematician Arthur Cayley (1821–1895) who had keen interest in combina-
torial mathematics and published altogether over 900 papers and notes. Consequently,
formula (43) given by Cayley in 1889 is often referred to as “Cayley’s formula” and
unrestricted nonplane labelled trees are often called “Cayley trees”. See [54, p. 51] for
a historical discussion. The function T (z) is also known as the (Cayley) “tree func-
tion”; it is a close relative of the W–function [100] deﬁned implicitly by WeW = z,
which was introduced by the Swiss mathematician Johann Lambert (1728–1777) oth-
erwise famous for ﬁrst proving the irrationality of the number π.
A similar process gives the number of (nonplane rooted) trees where all (out)degrees
of nodes are restricted to lie in a set Ω. This corresponds to the speciﬁcation:
T (Ω) = Z ⋆SETΩ{T (Ω)}
=⇒
T (Ω)(z) = zφ(T (Ω)(z)) where φ(u) =
X
ω∈Ω
uω
ω! .
What the last formula involves is the “exponential characteristic” of the degree se-
quence (as opposed to the ordinary characteristic, in the planar case). It is once more
amenable to Lagrange inversion. In summary:
Proposition II.5. The number of rooted nonplane trees, where all nodes have their
outdegree in Ω, is
T (Ω)
n
= (n −1)![un−1](φ(u))n
where
φ(u) =
X
ω∈Ω
uω
ω! .
In particular, when all node degrees are allowed (Ω≡Z≥0), the number of trees is
Tn = nn−1 and its EGF is the Cayley tree function satisfying T (z) = zeT (z).
 II.16. Pr¨ufer’s bijective proofs of Cayley’s formula. The simplicity of Cayley’s formula calls
for a combinatorial explanation. The most famous one is due to Pr¨ufer (in 1918). It establishes
as follows a bijective correspondence between unrooted Cayley trees whose number is nn−2 for
size n and sequences (a1, . . . , an−2) with 1 ≤aj ≤n for each j. Given an unrooted tree τ,
remove the endnode (and its incident edge) with the smallest label; let a1 denote the label of
the node that was joined to the removed node. Continue with the pruned tree τ ′ to get a2 in a

II. 5. LABELLED TREES, MAPPINGS, AND GRAPHS
119
similar way. Repeat the construction of the sequence until the tree obtained only consists of a
single edge. For instance:
1
3
7
4
8
2
5
6
−→
(4, 8, 4, 8, 8, 4).
It can be checked that the correspondence is bijective; see [54, p. 53] or [364, p. 5].

 II.17. Forests. The number of unordered k–forests (i.e., k–sets of trees) is
F (k)
n
= n![zn]T(z)k
k!
= (n −1)!
(k −1)! [un−k](eu)n =
 
n −1
k −1
!
nn−k,
as follows from B¨urmann’s form of Lagrange inversion.

 II.18. Labelled hierarchies.
The class L of labelled hierarchies is formed of trees whose
internal nodes are unlabelled and are constrained to have outdegree larger than 1, while leaves
have labels attached to them. Like for other labelled structures, size is the number of labels (so
that internal nodes do not contribute). Hierarchies satisfy the speciﬁcation
L = Z + SET≥2{L},
=⇒
L = z + eL −1 −L.
This happens to be solvable in terms of the Cayley function: L(z) = T( 1
2ez/2−1/2) + z
2 −1
2.
The ﬁrst few values are 0, 1, 4, 26, 236 (EIS A000311): these numbers count phylogenetic trees
(used to describe the evolution of a genetically related group of organisms) and correspond to
Schr¨oder’s “fourth problem”; see [98, p. 224] and Note I.42, p. 68, for unlabelled analogues.
The class of binary (labelled) hierarchies deﬁned by the additional fact that internal nodes
can have degree 2 only is expressed by
M = Z + SET2{M}
=⇒
M(z) = 1 −
√
1 −2z
and
Mn = 1 · 3 · · · (2n −3),
where the counting numbers are now the odd factorials.

II. 5.2. Mappings and functional graphs. Let F be the class of mappings (or
“functions”) from [1 . . n] to itself. A mapping f ∈[1 . . n] 7→[1 . . n] can be repre-
sented by a directed graph over the set of vertices [1 . . n] with an edge connecting x
to f(x), for all x ∈[1 . . n]. The graphs so obtained are called functional graphs and
they have the characteristic property that the outdegree of each vertex is exactly equal
to 1.
Mappings and associated graphs. Given a mapping (or function) f, upon start-
ing from any point x0, the succession of (directed) edges in the graph traverses the
vertices corresponding to iterated values of the mapping,
x0,
f(x0),
f(f(x0)), . . . .
Since the domain is ﬁnite, each such sequence must eventually loop on itself. When
the operation is repeated starting each time from an element not previously hit, the
vertices group themselves into components. This leads to another characterization
of functional graphs (Figure 10): A functional graph is a set of connected functional
graphs. A connected functional graph is a collection of rooted trees arranged in a
cycle.

120
II. LABELLED STRUCTURES AND EGFS
Thus, with T being as before the class of all Cayley trees, and with K the class of
all connected functional graphs, we have the speciﬁcation:
(44)









F
=
SET{K}
K
=
CYC{T }
T
=
Z ⋆SET{T }
=⇒









F(z)
=
eK(z)
K(z)
=
log
1
1 −T (z)
T (z)
=
zeT (z).
What is especially interesting here is a speciﬁcation binding three types of related
structures. From Equation (44), the EGF F(z) is found to satisfy F = (1 −T )−1. It
can be checked from there, by Lagrange inversion once again, that we have
Fn = nn,
as was to be expected (!) from the origin of the problem. More interestingly, Lagrange
inversion also provides for the number of connected functional graphs (expand log(1−
T )−1 and recover coefﬁcients by B¨urmann’s form):
(45)
Kn = nn−1Q(n)
where
Q(n) := 1 + n −1
n
+ (n −1)(n −2)
n2
+ . . . .
The quantity Q(n) that appears in (45) is a famous one that surfaces in many prob-
lems of discrete mathematics (including the birthday paradox, Equation (27)). Knuth
has proposed to call it “Ramanujan’s Q–function” as it already appears in the ﬁrst let-
ter of Ramanujan to Hardy in 1913. The asymptotic analysis can be done elementarily
by developing a continuous approximation of the general term and approximating the
resulting Riemann sum by an integral: this is an instance of the Laplace method for
sums brieﬂy explained in APPENDIX B: Laplace’s method, p. 700. (See also [306,
Sec. 1.2.11.3] and [434, Sec. 4.7].) In fact, very precise estimates come out naturally
from an analysis of the singularities of the EGF K(z), as we shall see in Chapters VI
and VII. The net result is
Kn ∼nn
r π
2n,
26
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
FIGURE II.10.
A functional graph of size n = 26 associated to the mapping ϕ such
that ϕ(1) = 16, ϕ(2) = ϕ(3) = 11, ϕ(4) = 23, and so on.

II. 5. LABELLED TREES, MAPPINGS, AND GRAPHS
121
so that a fraction about 1/√n of all the graphs consist of a single component.
Constrained mappings. As is customary with the symbolic method, the construc-
tions (44) also lead to a large number of related counting results. First, the mappings
without ﬁxed points, ((∀x) f(x) ̸= x) and those without 1, 2–cycles, (additionally,
(∀x) f(f(x)) ̸= x), have EGFs
e−T (z)
1 −T (z),
e−T (z)−T 2(z)/2
1 −T (z)
.
The ﬁrst equation is consistent with what a direct count yields, namely (n −1)n,
which is asymptotic to e−1nn, so that the fraction of mappings without ﬁxed point is
asymptotic to e−1. The second one lends itself easily to complex-asymptotic methods
that give
n![zn]e−T −T 2/2
1 −T
∼e−3/2nn,
and the proportion is asymptotic to e−3/2. These two particular estimates are of the
same form as what has been found for permutations (the generalized derangements,
Eq. (40)). Such facts that are not quite obvious by elementary probabilistic arguments
are in fact neatly explained by the singular theory of combinatorial schemas developed
in Part B of this book.
Next, idempotent mappings satisfying f(f(x)) = f(x) for all x correspond to
I ∼= SET{Z ⋆SET{Z}}, so that
I(z) = ezez
and
In =
n
X
k=0
n
k

kn−k.
(The speciﬁcation translates the fact that idempotent mappings can have only cycles
of length 1 on which are grafted sets of direct antecedents.) The latter sequence
is EIS A000248, which starts as 1,1,3,10,41,196,1057. An asymptotic estimate can
be derived either from the Laplace method or, better, from the saddle point method
exposed in Chapter VIII.
Several analyses of this type are of relevance to cryptography and the study of
random number generators. For instance, the fact that a random mapping over [1 . . n]
tends to reach a cycle in O(√n) steps led Pollard to design a Monte Carlo integer
factorization algorithm, see [307, p. 371] and [434, Sec 8.8]. The algorithm once
suitably optimized ﬁrst led to the factorization of the Fermat number F8 = 228 + 1
obtained by Brent in 1980.
 II.19. Binary mappings. The class BF of binary mappings, where each point has either 0
or 2 preimages, is speciﬁed by
BF = SET{K}, K = CYC{P}, P = Z ⋆B, B = Z ⋆SET0,2{B}
(planted trees P and binary trees B are needed), so that
BF(z) =
1
√
1 −2z2 ,
BF2n = ((2n)!)2
2n(n!)2 .
The class BF is an approximate model of the behaviour of (modular) quadratic functions under
iteration. See [14, 198] for a general enumerative theory of random mappings including degree-
restricted ones.


122
II. LABELLED STRUCTURES AND EGFS
All mappings
1
1 −T
Partial
eT
1 −T
Injective partial
1
1 −z ez/(1−z)
Surjection
1
2 −ez
Bijection
1
1 −z
Connected (K)
log
1
1 −T
No ﬁxed point
e−T
1 −T
Involution
ez+z2/2
Idempotent
ezez
Binary
1
√
1 −2z2
FIGURE II.11.
A summary of various counting EGFs relative to mappings.
 II.20. Partial mappings. A partial mapping may be undeﬁned at some points, where it can
be considered as taking a special value, ⊥. The iterated preimages of ⊥form a forest, while
the remaining values organize themselves into a standard mapping. The class PF of partial
mappings is thus speciﬁed by PF = SET{T } ⋆F, so that
PF(z) =
eT (z)
1 −T(z)
and
PFn = (n + 1)n.
This construction lends itself to all sorts of variations. For instance, the class PFI of injective
partial maps is described as sets of chains of linear and circular graphs, PFI = SET{CYC{Z}+
SEQ≥1{Z}}, so that
PFI(z) =
1
1 −z ez/(1−z),
PFIn =
n
X
i=0
i!
 
n
i
!2
(This is a symbolic rewriting of part of the paper [62].)

The symbolic method thus gives access to a wide variety of counting results rela-
tive to maps satisfying diverse constraints. A summary is offered in Figure 11.
II. 5.3. Labelled graphs. Random graphs form a major chapter of the theory of
random discrete structures [60, 283]. We examine here enumerative results concerning
graphs of low “complexity”, that is, graphs which are very nearly trees. (Such graphs
for instance play an essential rˆole in the analysis of early stages of the evolution of a
random graph, when edges are successively added, as shown in [193, 282].)
Unrooted trees and acyclic graphs. The simplest of all connected graphs are
certainly the ones that are acyclic. These are trees, but contrary to the case of Cayley
trees, no root is speciﬁed. Let U be the class of all unrooted trees. Since a rooted tree
(rooted trees are, as we know, counted by Tn = nn−1) is an unrooted tree combined
with a choice of a distinguished node (there are n possible such choices for trees of
size n), one has
Tn = nUn
implying
Un = nn−2.
At generating function level, this combinatorial equality translates into
U(z) =
Z z
0
T (w) dw
w ,
which integrates to give (take T as the independent variable)
U(z) = T (z) −1
2T (z)2.

II. 5. LABELLED TREES, MAPPINGS, AND GRAPHS
123
Since U(z) is the EGF of acyclic connected graphs, the quantity
A(z) = eU(z) = eT (z)−T (z)2/2,
is the EGF of all acyclic graphs. (Equivalently, these are unordered forests of un-
rooted trees.) Methods developed in Chapters VI and VII imply the estimate An ∼
e1/2 nn−2. Surprisingly, perhaps, there are barely more acyclic graphs than unrooted
trees—such phenomena are easily explained by singularity analysis.
Unicyclic graphs. The excess of a graph is deﬁned as the difference between the
number of edges and the number of vertices. For a connected graph, this quantity
must be at least −1, the minimal value −1 being precisely attained by unrooted trees.
The class Wk is the class of connected graphs of excess equal to k; in particular
U = W−1. The successive classes W−1, W0, W1, . . ., may be viewed as describing
connected graphs of increasing complexity.
The class W0 comprises all connected graphs with the number of edges equal
to the number of vertices. Equivalently, a graph in W0 is a connected graph with
exactly one cycle (a sort of “eye”), and for that reason, elements of W0 are sometimes
referred to as “unicyclic components” or “unicycles”. In a way, such a graph looks
very much like an undirected version of a connected functional graph. Precisely, a
graph of W0 consists of a cycle of length at least 3 (by deﬁnition, graphs have neither
loops nor multiple edges) that is undirected (the orientation present in the usual cycle
construction is killed by identifying cycles isomorphic up to reﬂection) and on which
are grafted trees (these are implicitly rooted by the point at which they are attached
to the cycle). With UCYC representing the (new) undirected cycle construction, one
thus has
W0 ∼= UCYC≥3{T }.
We claim that this construction is reﬂected by the EGF equation
(46)
W0(z) = 1
2 log
1
1 −T (z) −1
2T (z) −1
4T (z)2.
Indeed one has the isomorphism
W0 + W0 ∼= CYC≥3{T },
since we may regard the two disjoint copies on the left as instantiating two possible
orientations of the undirected cycle. The result of (46) then follows from the usual
translation of the cycle construction. It is originally due to the Hungarian probabilist
R´enyi in 1959. Asymptotically, one ﬁnds (by methods of Chapter VI):
(47)
n![zn]W0 ∼1
4
√
2πnn−1/2 −5
3nn−1 + 1
48
√
2πnn−3/2 + · · · .
Finally, the number of graphs made only of trees and unicyclic components is
eW−1(z)+W0(z) = eT/2−3T 2/4
√
1 −T
,
and asymptotically: n![zn]eW−1+W0 ∼Γ(3/4)2−1/4e−1/2π−1/2nn−1/4. Such graphs
stand just next to acyclic graphs in order of structural complexity. They are the undi-
rected counterparts of functional graphs encountered in the previous section.

124
II. LABELLED STRUCTURES AND EGFS
Unrooted trees
U ≡W−1 = T −T 2/2
Un = nn−2
Acyclic gr. (forests) A = eT −T 2/2
An ∼e1/2nn−2
Unicycles
W0 = 1
2 log
1
1−T −T
2 −T 2
4
W0,n ∼1
4
√
2πnn−1/2
Trees + unicycles
B = eT/2−3T 2/4
√1 −T
Bn ∼Γ(3
4)2−1/4
√πe nn−1/4
Conn. excess k
Wk =
Pk(T)
(1 −T)3k
Wk,n ∼Pk(1)
√
2π
23k/2Γ( 3
4k)nn+(3k−1)/2
FIGURE II.12.
A summary of major enumeration results relative to labelled graphs of
small excess.
 II.21. 2-Regular graphs. This is based on Comtet’s account [98, Sec. 7.3]. A 2–regular graph
is an undirected graph in which each vertex has degree exactly 2. Connected 2–regular graphs
are thus undirected cycles of length n ≥3, so that the EGF of all 2–regular graphs is
R(z) = e−z/2−z2/4
√1 −z
.
Given n straight lines in general position, a cloud is deﬁned to be a set of n intersection points
no three being collinear. Clouds and 2–regular graphs are equinumerous. [Hint: Use duality.]
The asymptotic analysis will serve as a leading example of the singularity analysis process in
Chapter VI (Examples VI.1, p. 363 and VI.2, p. 378).
The general enumeration of r–regular graphs becomes somewhat more difﬁcult as soon
as r > 2. Algebraic aspects are discussed in [234, 244] while Bender and Canﬁeld [31] have
determined the asymptotic formula (for rn even),
R(r)
n
∼
√
2e(r2−1)/4 rr/2
er/2r!nrn/2,
for the number of r–regular graphs of size n.

Graphs of ﬁxed excess. The previous discussion suggests considering more gen-
erally the enumeration of connected graphs according to excess. E. M. Wright made
important contributions in this area [507, 508, 509] that are revisited in the famous
“giant paper on the giant component” by Janson, Knuth, Łuczak, and Pittel [282].
Wright’s result are summarized by the following proposition.
Proposition II.6. The EGF Wk(z) of connected graphs with excess (of edges over
vertices) equal to k is, for k ≥1, of the form
(48)
Wk(z) =
Pk(T )
(1 −T )3k ,
T ≡T (z),
where Pk is a polynomial of degree 3k + 2. For any ﬁxed k, as n →∞, one has
(49)
Wk,n = n![zn]Wk(z) = Pk(1)
√
2π
23k/2Γ
  3
2k
nn+(3k−1)/2 
1 + O(n−1/2)

.
The combinatorial part of the proof (see Note 22 below) is an interesting exercise
in graph surgery and symbolic methods. The analytic part of the statement follows
straightforwardly from singularity analysis. The polynomials P(T ) and the constants

II. 5. LABELLED TREES, MAPPINGS, AND GRAPHS
125
Pk(1) are determined by an explicit nonlinear recurrence; one ﬁnds for instance:
W1 = 1
24
T 4(6 −T )
(1 −T )3 ,
W2 = 1
48
T 4(2 + 28T −23T 2 + 9T 3 −T 4)
(1 −T )6
.
 II.22. Wright’s surgery. The full proof of Proposition II.6 by symbolic methods requires
the notion of pointing in conjunction with multivariate generating function techniques of Chap-
ter III. It is convenient to deﬁne wk(z, y) := ykWk(zy), which is a bivariate generating
function with y marking the number of edges. Pick up an edge in a connected graph of excess
k + 1, then remove it. This results either in a connected graph of excess k with two pointed
vertices (and no edge in between) or in two connected components of respective excess h and
k −h, each with a pointed vertex. Graphically:
=
+
This translates into the differential recurrence on the wk (∂x :=
∂
∂x),
2∂ywk+1 =
`
z2∂2
zwk −2y∂ywk
´
+
k+1
X
h=−1
(z∂zwh) · (z∂zwk−h) ,
and similarly for Wk(z) = wk(z, 1). From there, it can be veriﬁed by induction that each Wk
is a rational function of T ≡W−1. (See Wright’s original papers [507, 508, 509] or [282] for
details.)

As explained in the giant paper [282], such results combined with complex ana-
lytic techniques provide with great detail information on the aspect of a random graph
Γ(n, m) with n nodes and m edges. In the sparse case where m is of the order of n,
one ﬁnds the following properties to hold “with high probability” (w.h.p.)7, that is,
with probability tending to 1 as n →∞.
• For m = µn, with µ < 1
2, the random graph Γ(m, n) has w.h.p. only tree
and unicycle components; the largest component is w.h.p. of size O(log n).
• For m =
1
2n + O(n2/3), w.h.p. there appear one or several semi-giant
components that have size O(n2/3).
• For m = µn, with µ > 1
2, there is w.h.p. a unique giant component of size
proportional to n.
In each case, reﬁned estimates follow from a detailed analysis of corresponding gen-
erating functions, which is a main theme of [193] and especially [282]. Raw forms
of these results were ﬁrst obtained by Erd˝os and R´enyi who launched the subject in a
famous series of papers dating from 1959–60; see the books [60, 283] for a probabilis-
tic context and the paper [32] for the ﬁnest counting estimates available. In contrast,
the enumeration of all connected graphs (irrespective of the number of edges, that is,
without excess being taken into account) is a relatively easy problem treated in the
next section. Many other classical aspects of the enumerative theory of graphs are
covered in the book Graphical Enumeration by Harary and Palmer [259].
7Synonymous expressions are “asymptotically almost surely” (a.a.s) and “in probability”. The term
“almost surely” is sometimes used, though it lends itself to confusion with properties of continuous
measures.

126
II. LABELLED STRUCTURES AND EGFS
II. 6. Additional constructions
Like in the unlabelled case, pointing and substitution are available in the world
of labelled structures (Section II. 6.1), and implicit deﬁnitions enlarge the scope of
the symbolic method (Section II. 6.2). The inversion process needed to enumerate
implicit structures is even simpler, since in the labelled universe sets and cycles have
more concise translations as operators over EGF. Finally, and this departs signiﬁcantly
from Chapter I, the fact that integer labels are naturally ordered makes it possible to
take into account certain order properties of combinatorial structures (Section ??).
II. 6.1. Pointing and substitution. The pointing operation is entirely similar to
its unlabelled counterpart since it consists in distinguishing one atom amongst all the
ones that compose an object of size n. The deﬁnition of composition for labelled
structures is however a bit more subtle as it requires singling out “leaders” in sub-
stituends.
Pointing. The pointing of a class B is deﬁned by
A = ΘB
iff
An = [1 . . n] × Bn.
In other words, in order to generate an element of A, select one of the n labels and
point at it. Clearly
An = n · Bn =⇒A(z) = z d
dz B(z).
Substitution (composition). The composition or substitution can be deﬁned so
that it corresponds a priori to composition of generating functions. It is formally
deﬁned as
B ◦C =
∞
X
k=0
Bk × SETk{C},
so that its EGF is
∞
X
k=0
Bk
(C(z))k
k!
= B(C(z)).
A combinatorial way of realizing this deﬁnition and form an arbitrary object of B ◦C,
is as follows. First select an element of β ∈B called the “base” and let k = |β| be
its size; then pick up a k–set of Ck; the elements of the k–set are naturally ordered
by value of their “leader” (the leader of an object being by convention the value of
its smallest label); the element with leader of rank r is then substituted to the node
labelled by value r of β.
Theorem II.3. The combinatorial constructions of pointing and substitution are ad-
missible.
A = ΘB
=⇒
A(z) = z∂zB(z),
∂z ≡d
dz
A = B ◦C
=⇒
A(z) = B(C(z)).
For instance, the EGF of (relabelled) pairings of elements drawn from C is
eC(z)+C(z)2/2,
since the EGF of involutions is ez+z2/2.

II. 6. ADDITIONAL CONSTRUCTIONS
127
 II.23. Standard constructions based on substitutions. The sequence class of A may be de-
ﬁned by composition as P ◦A where P is the set of all permutations. The set class of A may be
deﬁned as U ◦A where U is the class of all urns. Similarly, cycles are obtained by substitution
into circular graphs. Thus,
SEQ(A) ∼= P ◦A,
SET(A) ∼= U ◦A,
CYC(A) ∼= C ◦A.
In this way, permutation, urns and circle graphs appear as archetypal classes in a development
of combinatorial analysis based on composition. (Joyal’s “theory of species” [286] and the
book by Bergeron, Labelle, and Leroux [39] make a great use of such ideas and show that an
extensive theory of combinatorial enumeration can be based on the concept of substitution.) 
 II.24. Distinct component sizes. The EGFs of permutations with cycles of distinct lengths
and of set partitions with parts of distinct sizes are
∞
Y
n=1
(1 + zn
n ),
∞
Y
n=1
(1 + zn
n! ).
The probability that a permutation of Pn has distinct cycle sizes tends to e−γ; see [249,
Sec. 4.1.6] for a Tauberian argument and [400] for precise asymptotics. The corresponding
analysis for set partitions is treated in the seven author paper [295].

II. 6.2. Implicit structures. Let X be a labelled class implicitly deﬁned by ei-
ther of the equations
A = B + X,
A = B ⋆X.
Then, solving the corresponding EGF equations leads to
X(z) = A(z) −B(z),
X(z) = A(z)
B(z),
respectively. For the composite labelled constructions SEQ, SET, CYC, the algebra is
equally easy.
Theorem II.4 (Implicit speciﬁcations). The generating functions associated to the
implicit equations in X
A = SEQ(X),
A = SET(X),
A = CYC(X),
are respectively
X(z) = 1 −
1
A(z),
X(z) = log A(z),
X(z) = 1 −e−A(z).
EXAMPLE II.15.
Connected graphs. In the context of graphical enumerations, the labelled
set construction takes the form of an enumerative formula relating a class of graphs G and the
subclass of its connected graphs K ⊂G:
G = SET(K) =⇒G(z) = eK(z).
This basic formula is known in graph theory [259] as the exponential formula.
Consider the class G of all (undirected) labelled graphs, the size of a graph being the
number of its nodes. Since a graph is determined by the choice of its set of edges, there are
`n
2
´

128
II. LABELLED STRUCTURES AND EGFS
potential edges each of which may be taken in or out, so that Gn = 2(n
2). Let K ⊂G be the
subclass of all connected graphs. The exponential formula determines K(z) implicitly,
K(z)
=
log
„
1 +
X
n≥1
2(n
2) zn
n!
«
=
z + z2
2! + 4z3
3! + 38z4
4! + 728z5
5! + · · · ,
where the sequence is EIS A001187. The series is divergent, that is, it has radius of conver-
gence 0.
It can nonetheless be manipulated as a formal series (APPENDIX A: Formal power
series, p. 676). Expanding by means of log(1 + u) = u −u2/2 + · · · , yields a complicated
convolution expression for Kn:
Kn = 2(n
2) −1
2
X  
n
n1, n2
!
2(n1
2 )+(n2
2 ) + 1
3
X  
n
n1, n2, n3
!
2(n1
2 )+(n2
2 )+(n3
2 ) −· · · .
(The kth term is a sum over n1 +· · ·+nk = n, with 0 < nj < n.) Given the very fast increase
of Gn with n, for instance
2(n+1
2 ) = 2n 2(n
2),
a detailed analysis of the various terms of the expression of Kn shows predominance of the ﬁrst
sum, and, in that sum itself, predominance of the extreme terms corresponding to n1 = n −1
or n2 = n −1, so that
(50)
Kn = 2(n
2) `
1 −2n2−n + o(2−n)
´
.
Thus, almost all labelled graphs of size n are connected. In addition, the error term decreases
very fast: for instance, for n = 18, an exact computation based on the generating function for-
mula reveals that a proportion only 0.0001373291074 of all the graphs are not connected—this
is extremely close to the value 0.0001373291016 predicted by the main terms in the asymptotic
formula (50). Notice that here good use could be made of a purely divergent generating function
for asymptotic enumeration purposes. . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE II.15. □
 II.25. Bipartite graphs. A plane bipartite graph is a pair (G, ω) where G is a labelled graph,
ω = (ωW , ωE) is a bipartition of the nodes (into West and East categories), and the edges are
such that they only connect nodes from ωW to nodes of ωE. A direct count shows that the EGF
of plane bipartite graphs is
Γ(z) =
X
n
γn zn
n! with γn =
X
k
 
n
k
!
2k(n−k).
The EGF of plane bipartite graphs that are connected is log Γ(z).
A bipartite graph is a labelled graph whose nodes can be partitioned into two groups so
that edges only connect nodes of different groups. The EGF of bipartite graphs is
exp
„1
2 log Γ(z)
«
=
p
Γ(z).
[Hint. The EGF of a connected bipartite graph is 1
2 log Γ(z) as a factor of 1
2 kills the East–
West orientation present in a connected plane bipartite graph. See Wilf’s book [496, p. 78] for
details.]

 II.26. Do two permutations generate the symmetric group? To two permutations σ, τ of the
same size, associate a graph Γσ,τ whose set vertices is V = [1 . . n], if n = |σ| = |τ|, and

II. 6. ADDITIONAL CONSTRUCTIONS
129
set of edges is formed of all the pairs (x, σ(x)), (x, τ(x)), for x ∈V . The probability that a
random Γσ,τ is connected is
πn = 1
n![zn] log
0
@X
n≥0
n!zn
1
A .
This represents the probability that two permutations generate a transitive group (that is for all
x, y ∈[0 . . n], there exists a composition of σ, σ−1, τ, τ −1 that maps x to y). One has
(51)
πn ∼1 −1
n −1
n2 −4
n3 −23
n4 −171
n5 −1542
n6
−· · · ,
Surprisingly, the coefﬁcients 1, 1, 4, 23, . . . [EIS A084357] in (51) enumerate a “third-level”
structure (cf Subsection II. 4.2): SET(SET≥1(SEQ≥1(Z))). Also, one has n!2πn = (n−1)!In,
where In+1 is the number of indecomposable permutations (Example I.17, p. 82).
Let π⋆
n be the probability that two random permutations generate the whole symmetric
group. Then, by a result of Babai based on the classiﬁcation of groups, the quantity πn −π⋆
n is
exponentially small, so that (51) also applies to π⋆
n. [Based on Dixon [130].]

 II.27. Graphs are not speciﬁable. The class of all graphs does not admit a speciﬁcation start-
ing from single atoms and involving only sums, products, sets and cycles. Indeed, the growth
of Gn is such that the EGF G(z) has radius of convergence 0, whereas EGFs of constructible
classes must have a nonzero radius of convergence, as proved in Chapter IV.

II. 6.3. Order constraints. A construction well suited to taking into account
many order properties of combinatorial structures is the modiﬁed labelled product,
A = (B2 ⋆C).
This denotes the subset of the product B ⋆C formed with elements such that the small-
est label is constrained to lie in the B component. (To make this deﬁnition consistent,
it must be assumed that B0 = 0.) We call this binary operation on structures the boxed
product.
Theorem II.5. The boxed product is admissible.
(52)
A = (B2 ⋆C)
=⇒
A(z) =
Z z
0
(∂tB(t)) · C(t) dt,
∂t ≡d
dt.
PROOF. The deﬁnition of boxed products implies the coefﬁcient relation
An =
n
X
k=1
n −1
k −1

BkCn−k.
The binomial coefﬁcient that appears in the standard labelled product is now modiﬁed
since only n −1 labels need to be distributed between the two components, k −1
going to the B component (that is constrained to contain the label 1 already) and n−k
to the C component. From the equivalent form
An = 1
n
n
X
k=0
n
k

(kBk) Cn−k,
the result follows by taking EGFs.
□
A useful special case is the min–rooting operation,
A = {1}2 ⋆C,

130
II. LABELLED STRUCTURES AND EGFS
0.5
1
1.5
2
2.5
0
20
40
60
80
100
FIGURE II.13.
A numerical sequence of size 100 with records marked by circles: there
are 7 records that occur at times 1, 3, 5, 11, 60, 86, 88.
for which a variant deﬁnition goes as follows. Take in all possible ways elements
γ ∈C, prepend an atom with a label smaller than the labels of γ, for instance 0, and
relabel in the canonical way over [1 . . (n+1)] by shifting all label values by 1. Clearly
An+1 = Cn which yields
A(z) =
Z z
0
C(t) dt,
a result also consistent with the general formula of boxed products.
For some applications, it is easier to impose constraints on the maximal label
rather than the minimum. The max-boxed product written
A = (B■⋆C),
is then deﬁned by the fact the maximum is constrained to lie in the B-component of
the labelled product. Naturally, the translation by an integral in (52) remains valid for
this trivially modiﬁed boxed product.
 II.28. Combinatorics of integration. In the perspective of this book, integration by parts has
an immediate interpretation. Indeed, the equality,
Z z
0
A′(t) · B(t) dt = A(z) · B(z) −
Z z
0
A(t) · B′(t) dt,
reads off as: “The smallest label in an ordered pair, if it appears on the left, cannot appear on
the right.”

EXAMPLE II.16.
Records in permutations.
Given a sequence of numerical data, x =
(x1, . . . , xn) assumed all distinct, a record in that sequence is deﬁned to be an element xj
such that xk < xj for all k < j. (A record is an element “better” than its predecessors!) Fig-
ure 13 displays a numerical sequence of length n = 100 that has 7 records. Confronted to such
data, a statistician will typically want to determine whether the data obey purely random ﬂuctu-
ations or there could be some indications of a “trend” or of a “bias” [108, Ch. 10]. (Think of the
data as reﬂecting share prices or athletic records, say.) In particular, if the xj are independently
drawn from a continuous distribution, then the number of records obeys the same laws as in a
random permutation of [1 . . n]. This statistical preamble then invites the question: How many
permutations of n have k records?

II. 6. ADDITIONAL CONSTRUCTIONS
131
First, we start with a special brand of permutations, the ones that have their maximum at
the beginning. Such permutations are deﬁned as (‘■’ indicates the boxed product based on the
maximum label)
Q = (Z■⋆P),
where P is the class of all permutations. Observe that this gives the EGF
Q(z) =
Z z
0
„ d
dtt
«
·
1
1 −t dt = log
1
1 −z ,
implying the obvious result Qn = (n −1)! for all n ≥1. These are exactly the permutations
with one record. Next, consider the class
P(k) = SETk(Q).
The elements of P(k) are unordered sets of cardinality k with elements of type Q. Deﬁne
the (max) leader of any component of P(k) as the value of its maximal element. Then, if we
place the components in sequence, ordered by increasing values of their leaders, then read off
the whole sequence, we obtain a permutation with k records exactly. The correspondence8 is
clearly revertible. Here is an illustration, with leaders underlined:
{(7, 2, 6, 1), (4, 3), (9, 8, 5)}
∼=
[(4, 3), (7, 2, 6, 1), (9, 8, 5))]
∼=
4, 3, 7, 2, 6, 1, 9, 8, 5.
Thus, the number of permutations with k records is determined by
P (k)(z) = 1
k!
„
log
1
1 −z
«k
,
P (k)
n
=
"
n
k
#
,
where we recognize Stirling cycle numbers from Example 12. In other words:
The number of permutations of size n having k records is counted by the
Stirling “cycle” number
ˆn
k
˜
.
Returning to our statistical problem, the treatment of Example 12 p. 112 (to be revisited
in Chapter III) shows that the expected number of records in a random permutation of size n
equals Hn, the harmonic number. One has H100 .= 5.18, so that for 100 data items, a little
more than 5 records are expected on average. The probability of observing 7 records or more
is still about 23%, an altogether not especially rare event. In contrast, observing twice as many
records, that is, 14, would be a fairly strong indication of a bias since, on random data, the
event has probability very close to 10−4. Altogether, the present discussion is consistent with
the hypothesis for the data of Figure 13 to have been generated independently at random (and
indeed they were). . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE II.16. □
It is possible to base a fair part of the theory of labelled constructions on sums and
products in conjunction with the boxed product. In effect, consider the three relations
F = SEQ{G}
=⇒
f(z) =
1
1 −g(z),
f = 1 + gf
F = SET{G}
=⇒
f(z) = eg(z),
f = 1 +
Z
g′f
F = CYC{G}
=⇒
f(z) = log
1
1 −g(z),
f =
Z
g′
1
1 −g
8This correspondence can also be viewed as a transformation on permutations that maps the number
of records to the number of cycles—it is known as Foata’s fundamental correspondence [337, Sec. 10.2].

132
II. LABELLED STRUCTURES AND EGFS
The last column is easily checked to provide an alternative form of the standard op-
erator corresponding to sequences, sets, and cycles. Each case is then itself deduced
directly from Theorem II.5 and the labelled product rule:
Sequences: they obey the recursive deﬁnition
F = SEQ{G}
=⇒
F ∼= {ǫ} + (G ⋆F).
Sets: we have
F = SET{G}
=⇒
F ∼= {ǫ} + (G■⋆F),
which means that, in a set, one can always single out the component with
the largest label, the rest of the components forming a set. In other words,
when this construction is repeated, the elements of a set can be canonically
arranged according to increasing values of their largest labels, the “leaders”.
(We recognize here a generalization of the construction used for records in
permutations.)
Cycles: The element of a cycle that contains the largest label can be taken
canonically as the cycle “starter”, which is then followed by an arbitrary
sequence of elements upon traversing the cycle in circular order. Thus
F = CYC{G}
=⇒
F ∼= (G■⋆SEQ{G}).
Greene [251] has developed a complete framework of labelled grammars based
on standard and boxed labelled products. In its basic form, its expressive power is
essentially equivalent to ours, because of the above relations. More complicated order
constraints, dealing simultaneously with a collection of larger and smaller elements,
can be furthermore taken into account within this framework.
 II.29. Higher order constraints, after Greene. Let the symbols □, ⊡, ■represent smallest,
second smallest, and largest labels respectively. One has the correspondences (with ∂z =
d
dz )
A =
“
B2 ⋆C■”
∂2
zA(z) = (∂zB(z)) · (∂zC(z))
A =
“
B2 ■⋆C
”
∂2
zA(z) =
`
∂2
zB(z)
´
· C(z)
A =
“
B2 ⋆C⊡⋆D■”
∂3
zA(z) = (∂zB(z)) · (∂zC(z)) · (∂zD(z)) ,
and so on. These can be transformed into (iterated) integral representations. [See [251] for
more.]

The next two examples demonstrate the usefulness of min-rooting used in con-
junction with recursion. In this way, trees satisfying some order conditions can be
constructed and enumerated easily. This is in turn gives access to new characteristics
of permutations.
EXAMPLE II.17. Increasing binary trees and alternating permutations.
To each permutation,
one can associate bijectively a binary tree of a special type called an increasing binary tree and
sometimes a heap–ordered tree or a tournament tree. This is a plane rooted binary tree in which
internal nodes bear labels in the usual way, but with the additional constraint that node labels
increase along any branch stemming from the root. Such trees are closely related to classical
data structures of computer science, like heaps and binomial queues.
The correspondence (Figure 14) is as follows: Given a permutation of a set written as a
word, σ = σ1σ2 . . . σn, factor it in the form σ = σL · min(σ) · σR, with min(σ) the smallest

II. 6. ADDITIONAL CONSTRUCTIONS
133
7
4
2
6
1
3
5
5
7
3
4
1
6
2
FIGURE II.14.
A permutation of size 7 and its increasing binary tree lifting.
label value in the permutation, and σL, σR the factors left and right of min(σ). Then the binary
tree β(σ) is deﬁned recursively in the format ⟨root, left,right⟩by
β(σ) = ⟨min(σ), β(σL), β(σR)⟩,
β(ǫ) = ǫ.
The empty tree (consisting of a unique external node of size 0) goes with the empty permutation
ǫ. Conversely, reading the labels of the tree in symmetric (inﬁx) order gives back the original
permutation. (The correspondence is described for instance in Stanley’s book [447, p. 23–25]
who says that “it has been primarily developed by the French”, pointing at [219].)
Thus, the family I of binary increasing trees satisﬁes the recursive deﬁnition
I = {ǫ} +
`
Z2 ⋆I ⋆I
´
,
which implies the nonlinear integral equation for the EGF
I(z) = 1 +
Z z
0
I(t)2 dt.
This equation reduces to I′(z) = I(z)2 and, under the initial condition I(0) = 1, it admits the
solution I(z) = (1 −z)−1. Thus In = n!, which is consistent with the fact that there are as
many increasing binary trees as there are permutations.
The construction of increasing trees associated with permutations is instrumental in deriv-
ing EGFs relative to various local order patterns in permutations. We illustrate its use here by
counting the number of up-and-down (or zig-zag) permutations, also known as alternating per-
mutations. The result, already mentioned in our Invitation chapter, was ﬁrst derived by D´esir´e
Andr´e in 1881 by means of a direct recurrence argument.
A permutation σ = σ1σ2 . . . σn is an alternating permutation if
(53)
σ1 > σ2 < σ3 > σ4 < · · · ,

134
II. LABELLED STRUCTURES AND EGFS
so that pairs of consecutive elements form a succession of ups and downs; for instance,
6
2
3
4
1
7
5
6
2
3
1
7
4
5
Consider ﬁrst the case of an alternating permutation of odd size. It can be checked that the
corresponding increasing trees have no one–way branching nodes, so that they consist solely of
binary nodes and leaves. Thus, the corresponding speciﬁcation is
J = Z +
`
Z2 ⋆J ⋆J
´
,
so that
J(z) = z +
Z z
0
J(t)2 dt
and
d
dz J(z) = 1 + J(z)2.
The equation admits separation of variables, which implies (with J(0) = 0)
J(z) = tan(z) = z + 2z3
3! + 16z5
5! + 272z7
7! + · · · .
The coefﬁcients J2n+1 are known as the tangent numbers or the Euler numbers of odd index
(EIS A000182).
Alternating permutations of even size deﬁned by the constraint (53) and denoted by J can
be determined from
J = {ǫ} +
`
Z2 ⋆J ⋆J
´
,
since now all internal nodes of the tree representation are binary, except for the rightmost one
that only branches on the left. Thus, J
′(z) = tan(z)J(z), and the EGF is
J(z) =
1
cos(z) = 1 + 1z2
2! + 5z4
4! + 61z6
6! + 1385z8
8! + · · · ,
where the coefﬁcients J 2n are the secant numbers also known as Euler numbers of even index
(EIS A000364). . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE II.17. □
Use will be made later in this book (Chapter III, p. 22) of this important tree
representation of permutations as it opens access to parameters like the number of
descents, runs, and (once more!) records in permutations. Analyses of increasing trees
also inform us of crucial performance issues regarding binary search trees, quicksort,
and heap–like priority queue structures [351, 434, 486, 488].
 II.30. Combinatorics of trigonometrics. Interpret tan
z
1−z , tan tan z, tan(ez −1) as EGFs
of combinatorial classes.

EXAMPLE II.18. Increasing Cayley trees and regressive mappings. An increasing Cayley tree
is a Cayley tree (i.e., it is nonplane and rooted) whose labels along any branch stemming from
the root form an increasing sequence. In particular, the minimum must occur at the root, and
no plane embedding is implied. Let K be the class of such trees. The recursive speciﬁcation is
now
K =
`
Z2 ⋆SET{K}
´
.

II. 6. ADDITIONAL CONSTRUCTIONS
135
x
3
4
6
7
9
1
2
5
8
x
x
x
x
x
x
x
x
1
2
3
4
5
6
7
8
9
8
7
6
5
4
3
2
1
−
FIGURE II.15.
An increasing Cayley tree (left) and its associated regressive mapping
(right).
The generating function thus satisﬁes the functional relations
K(z) =
Z z
0
eK(t) dt,
K′(z) = eK(z),
with K(0) = 0. Integration of K′e−K = 1 shows that
K(z) = log
1
1 −z
and
Kn = (n −1)!.
Thus the number of increasing Cayley trees is (n−1)!, which is also the number of permutations
of size n −1. These trees have been studied by Meir and Moon [356] under the name of
“recursive trees”, a terminology that we do not however retain here.
The simplicity of the formula Kn = (n−1)! certainly calls for a combinatorial interpreta-
tion. In fact, an increasing Cayley tree is fully determined by its child parent relationship (Fig-
ure 15). Otherwise said, to each increasing Cayley tree τ, we associate a partial map φ = φτ
such that φ(i) = j iff the label of the parent of i is j. Since the root of tree is an orphan,
the value of φ(1) is undeﬁned, φ(1) =⊥; since the tree is increasing, one has φ(i) < i for
all i ≥2. A function satisfying these last two conditions is called a regressive mapping. The
correspondence between trees and regressive mappings is then easily seen to be a bijective one.
Thus regressive mappings on the domain [1 . . n] and increasing Cayley trees are equinu-
merous, so that we may as well use K to denote the class of regressive mappings. Now, a regres-
sive mapping of size n is evidently determined by a single choice for φ(2) (since φ(2) = 1),
two possible choices for φ(3) (either of 1, 2), and so on. Hence the formula
Kn = 1 · 2 · 3 · · · (n −1)
receives a natural interpretation. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE II.18. □
 II.31. Regressive mappings and permutations. Regressive mappings can be related directly
to permutations. The construction that associates a regressive mapping to a permutation is
called the “inversion table” construction; see [307, 434]. Given a permutation σ = σ1, . . . , σn,
associate to it a function ψ = ψσ from [1 . . n] to [0 . . n −1] by the rule
ψ(j) = card
˘
k < j
˛˛ σk > σj
¯
.
The function ψ is a trivial variant of a regressive mapping.


136
II. LABELLED STRUCTURES AND EGFS
 II.32. Rotations and increasing trees. An increasing Cayley tree can be canonically drawn
by ordering descendants of each node from left to right according to their label values. The
rotation correspondence (p. 69) then gives rise to a binary increasing tree. Hence, increasing
Cayley trees and increasing binary trees are also directly related. Summarizing this note and
the previous one, we have a quadruple combinatorial connection,
Increasing Cayley tree ∼= Regressive mappings ∼= Permutations ∼= Increasing binary trees,
that opens the way to yet more permutation enumerations.

II. 7. Perspective
Together with the previous chapter and Figure I.14, this chapter and Figure 16
provide the basis for the symbolic method that is at the core of analytic combinatorics.
The translations of the basic constructions for labelled classes to EFGs could hardly
be simpler, but, as we have seen, they are sufﬁciently powerful to embrace numerous
classical results in combinatorics, ranging from the birthday and coupon collector
problems to graph enumeration.
The examples that we have considered for second-level structures, trees, map-
pings, and graphs lead to EGFs that are simple to express and natural to generalize.
(Often, the simple form is misleading—direct derivations of many of these EGFs that
do not appeal to the symbolic method can be rather intricate.) Indeed, the symbolic
method provides a framework that allows us to understand the nature of many of these
combinatorial classes. From there, numerous seemingly scattered counting problems
can be organized into broad structural categories and solved in an almost mechanical
manner.
Again, the symbolic method is only half of the story (the “combinatorics” in
analytic combinatorics), leading to EGFs for the counting sequences of numerous
interesting combinatorial classes. While some of these EGFs lead immediately to ex-
plicit counting results, others require the classical techniques in complex analysis and
asymptotic analysis that are covered in Part B (the “analytic” part of analytic combi-
natorics) to deliver asymptotic estimates. Together with these techniques, the basic
constructions, translations, and applications that we have discussed in this chapter re-
inforce the overall message that the symbolic method is a systematic approach that
is successful for addressing classical and new problems in combinatorics, generaliza-
tions, and applications.
We have been focussing on enumeration problems—counting the number of ob-
jects of a given size in a combinatorial class. In the next chapter, we consider how to
extend the symbolic method to help analyse other properties of combinatorial classes.
The labelled set construction and the exponential formula were recognized early by re-
searchers working in the area of graphical enumerations [259]. Foata [217] proposed a detailed
formalization in 1974 of labelled constructions, especially sequences and sets, under the names
of partitional complex; a brief account is also given by Stanley in his survey [445]. This is par-
allel to the concept of “prefab” due to Bender and Goldman [34]. The books by Comtet [98],
Wilf [496], Stanley [447], or Goulden and Jackson [244] have many examples of the use of
labelled constructions in combinatorial analysis.
Greene [251] has introduced a general framework of “labelled grammars” largely based
on the boxed product with implications for the random generation of combinatorial structures
in his 1983 dissertation. Joyal’s theory of species dating from 1981 (see [286] for the original

II. 7. PERSPECTIVE
137
1. The main constructions of union, and product, sequence, set, and cycle for labelled
structures together with their translation into exponential generating functions.
Construction
EGF
Union
A = B + C
A(z) = B(z) + C(z)
Product
A = B ⋆C
A(z) = B(z) · C(z)
Sequence
A = SEQ{B}
A(z) =
1
1 −B(z)
Set
A = SET{B}
A(z) = exp(B(z))
Cycle
A = CYC{B}
A(z) = log
1
1 −B(z)
2. The translation for sets, multisets, and cycles of ﬁxed cardinality.
Construction
EGF
Sequence
A = SEQk{B}
A(z) = B(z)k
Set
A = SETk{B}
A(z) = 1
k!B(z)k
Cycle
A = CYCk{B}
A(z) = 1
kB(z)k
3. The additional constructions of pointing and substitution.
Construction
EGF
Pointing
A = ΘB
A(z) = z d
dzB(z)
Substitution
A = B ◦C
A(z) = B(C(z))
4. The “boxed” product.
A = (B2 ⋆C) =⇒A(z) =
Z z
0
 d
dtB(t)

· C(t) dt.
FIGURE II.16.
A “dictionary” of labelled constructions together with their translation
into exponential generating functions (EGFs). The ﬁrst constructions are counterparts of
the unlabelled constructions of the previous chapter (the multiset construction is not mean-
ingful here). The translation for composite constructions of bounded cardinality appears
to be simple. Finally, the boxed product is speciﬁc to labelled structures. (Compare with
the unlabelled counterpart, Figure 14 of Chapter I, p. 14.)
article and the book by Bergeron, Labelle, and Leroux [39] for a rich exposition), is based on
category theory; it presents the advantage of uniting in a common theory the unlabelled and the
labelled worlds.

138
II. LABELLED STRUCTURES AND EGFS
Flajolet, Salvy, and Zimmermann have developed a speciﬁcation language closely related
to the system exposed here. They show in [206] how to compile automatically speciﬁcations
into generating functions; this is complemented by a calculus that produces fast random gener-
ation algorithms [216].

III
Combinatorial Parameters and
Multivariate Generating Functions
Generating functions ﬁnd averages, etc.
— HERBERT WILF [496]
Je n’ai jamais ´et´e assez loin pour bien sentir l’application de l’alg`ebre `a la g´eom´etrie. Je
n’aimais point cette mani`ere d’op´erer sans voir ce qu’on fait, et il me sembloit que r´esoudre un
probl`eme de g´eom´etrie par les ´equations, c’´etoit jouer un air en tournant une manivelle1.
— JEAN-JACQUES ROUSSEAU, Les Confessions, Livre VI
Contents
III. 1.
An introduction to bivariate generating functions (BGFs)
141
III. 2.
Bivariate generating functions and probability distributions
144
III. 3.
Inherited parameters and ordinary MGFs
151
III. 4.
Inherited parameters and exponential MGFs
163
III. 5.
Recursive parameters
170
III. 6.
Complete generating functions and discrete models
174
III. 7.
Additional constructions
187
III. 8.
Extremal parameters
203
III. 9.
Perspective
207
Many scientiﬁc endeavours demand precise quantitative information on probabilis-
tic properties of parameters of combinatorial objects. For instance, when designing,
analysing, and optimizing a sorting algorithm, it is of interest to determine what the
typical disorder of data obeying a given model of randomness is, and do so in the
mean, or even in distribution, either exactly or asymptotically. Similar situations arise
in a broad variety of ﬁelds, including probability theory and statistics, computer sci-
ence, information theory, statistical physics, and computational biology. The exact
problem is then a reﬁned counting problem with two parameters, namely, size and
additional characteristic: this is the subject addressed in this chapter and treated by a
natural extension of the generating function framework. (The asymptotic problem can
be viewed as one of characterizing in the limit a family of probability laws indexed
by the values of the possible sizes: this is a topic to be discussed in Chapter IX.)
As demonstrated here, the symbolic methods initially developed for counting com-
binatorial objects adapt gracefully to the analysis of various sorts of parameters of
constructible classes, unlabelled and labelled alike.
1“I never went far enough to get a good feel for the application of algebra to geometry. I was not
pleased with this method of operating according to the rules without seeing what one does; solving geomet-
rical problems by means of equations seemed like playing a tune by turning a crank.”
139

140
III. PARAMETERS AND MULTIVARIATE GFS
Multivariate generating functions (MGFs)—ordinary or exponential—can keep
track of a collection of parameters deﬁned over combinatorial objects. From the
knowledge of such generating functions, there result either explicit probability dis-
tributions or, at least, mean and variance evaluations. For inherited parameters, all
the combinatorial classes discussed so far are amenable to such a treatment and tech-
nically, the translation schemes that relate combinatorial constructions and multivari-
ate generating functions present no major difﬁculty—they appear to be natural (no-
tational, even) reﬁnements of the paradigm developed in Chapters I and II for the
univariate case. Typical applications from classical combinatorics are the number of
summands in a composition, the number of blocks in a set partition, the number of
cycles in a permutation, the root degree or path length of a tree, the number of ﬁxed
points in a permutation, the number of singleton blocks in a set partition, the number
of leaves in trees of various sorts, and so on.
Beyond its technical aspects anchored in symbolic methods, this chapter also
serves as a ﬁrst encounter with the general area of random combinatorial structures.
The general question is: What does a random object of large size look like? Multi-
variate generating functions ﬁrst provide an easy access to moments of combinatorial
parameters—typically the mean and variance. In addition, when combined with basic
probabilistic inequalities, moment estimates often lead to precise characterizations of
properties of large random structures that hold with high probability. For instance, a
large integer partition conforms with high probability to a deterministic proﬁle, a large
random permutation almost surely has at least one long cycle and a few short ones, and
so on. Such a highly constrained behaviour of large objects may in turn serve to design
dedicated algorithms and optimize data structures; or it may serve to build statistical
tests—when does one depart from randomness and detect a “signal” in large sets of
observed data? Randomness aspects form a recurrent theme of the book: they will be
developed much further in Chapter IX, where complex-asymptotic methods of Part B
are grafted on the exact modelling by multivariate generating functions presented in
this chapter.
This chapter is organized as follows. First a few pragmatic developments re-
lated to bivariate generating functions, the multivariate paradigm specialized to two
variables, are presented in Section III.1. Section III. 2 then presents the notion of
bivariate enumeration and its relation to discrete probabilistic models, including the
determination of moments, as the language of elementary probability theory does pro-
vide an intuitively appealing way to conceive of bivariate counting data. The sym-
bolic method per se declined in its general multivariate version is centrally developed
in Sections III. 3 and III.4: with suitable multi-index notations, the extension of the
symbolic method to the multivariate case is almost immediate. Recursive parame-
ters that often arise in particular from tree statistics form the subject of Section III. 5,
while complete generating functions and associated combinatorial models are dis-
cussed in Section III. 6. Additional constructions like pointing, substitution, and or-
der constraints lead to interesting developments, in particular, an original treatment
of the inclusion-exclusion principle in Section III. 7. The chapter concludes with Sec-
tion III. 8, which presents a brief abstract discussion of extremal parameters like height

III. 1. AN INTRODUCTION TO BIVARIATE GENERATING FUNCTIONS (BGFS)
141
in trees or smallest and largest components in composite structures— such parameters
are best treated via families of univariate generating functions.
III. 1. An introduction to bivariate generating functions (BGFs)
We have seen in Chapters I and II that a number sequence (fn) can be encoded
by means of a generating function in one variable, either ordinary or exponential:
(fn)
;
f(z) =







X
n
fnzn
ordinary GF
X
n
fn
zn
n!
exponential GF.
This encoding is powerful, since many combinatorial constructions admit of a trans-
lation as operations over such generating functions. In this way, one gains access to
many useful counting formulæ.
Similarly, consider a sequence of numbers (fn,k) depending on two integer valued
indices, n and k. Usually, in this book, (fn,k) will be an array of number (often
a triangular array), where fn,k is the number of objects ϕ in some class F, such
that |ϕ| = n and some parameter χ(ϕ) is equal to k. We can encode this sequence
by means of a bivariate generating function (BGF), which involves two variables, z
attached to n and u attached to k.
Deﬁnition III.1. The bivariate generating functions (BGFs), either of the ordinary
or exponential type, of an array (fn,k) are the formal power series f(z, u) in two
variables deﬁned by
(fn,k)
;
f(z, u) =









X
n,k
fn,kznuk
ordinary BGF
X
n,k
fn,k
zn
n! uk
exponential BGF.
(The case of a “double exponential” GF corresponding to zn
n!
uk
k! is not used in the
book.)
As we shall see shortly, many parameters of constructible classes become acces-
sible through such BGFs. According to the point of view adopted momentarily here,
one starts with an array of numbers and forms a BGF by a double summation pro-
cess. We present here two examples related to binomial coefﬁcients and Stirling cycle
numbers illustrating how such BGFs can be determined, then manipulated. In what
follows it is convenient to refer to the horizontal and vertical generating functions that
are each a one-parameter family of GFs in a single variable deﬁned by
horizontal GF:
fn(u) :=
X
k
fn,kuk;
vertical GF:
f ⟨k⟩(z) :=
X
n
fn,kzn
(ordinary case)
f ⟨k⟩(z) :=
X
n
fn,k
zn
n!
(exponential case).

142
III. PARAMETERS AND MULTIVARIATE GFS
f00
−→
f0(u)
f10
f11
−→
f1(u)
f20
f21
f22
−→
f2(u)
...
...
...
↓
↓
↓
f ⟨0⟩(z)
f ⟨1⟩(z)
f ⟨2⟩(z)
FIGURE III.1. An array of numbers and its associated horizontal and vertical GFs.
The terminology is transparently explained if the elements (fn,k) are arranged as an
inﬁnite matrix, with fn,k placed in row n and column k, since the horizontal and verti-
cal GFs appear as the GFs of the rows and columns respectively (Figure 1). Naturally,
one has
f(z, u) =
X
k
ukf ⟨k⟩(z) =







X
n
fn(u)zn
ordinary BGF
X
n
fn(u)zn
n!
exponential BGF.
EXAMPLE III.1.
The BGF of binomial coefﬁcients. The binomial coefﬁcient
`n
k
´
, counts the
binary words of length n having k occurrences of a designated letter; see Figure 2. In order to
compose the bivariate GF, start from the simplest case of Newton’s binomial theorem and form
directly the horizontal GFs corresponding to a ﬁxed n:
(1)
Wn(u) :=
n
X
k=0
 
n
k
!
uk = (1 + u)n,
Then a summation over all values of n gives the ordinary BGF
(2)
W (z, u) =
X
k,n≥0
 
n
k
!
ukzn =
X
n≥0
(1 + u)nzn =
1
1 −z(1 + u).
Such calculations are typical of BGF manipulations. What we have done amounts to starting
from a sequence of numbers, determining the horizontal GFs Wn(u) in (1), then the bivariate
GF W (z, u) in (2), according to the scheme:
Wn,k
;
Wn(u)
;
W (z, u).
Observe that (2) reduces to the OGF (1 −2z)−1 of binary words, as it should, upon setting
u = 1.
In addition, one can deduce from (2) the vertical GFs of the binomial coefﬁcients corre-
sponding to a ﬁxed value of k,
W ⟨k⟩(z) =
X
n≥0
 
n
k
!
zn =
zk
(1 −z)k+1 ,

III. 1. AN INTRODUCTION TO BIVARIATE GENERATING FUNCTIONS (BGFS)
143
■■□□□
□□■■■
■□■□□
□■□■■
□■■□□
■□□■■
■□□■□
□■■□■
□■□■□
■□■□■
■□□□□
□□■■□
■■□□■
□■■■■
□■□□□
■□□□■
□■■■□
■□■■■
□□■□□
□■□□■
■□■■□
■■□■■
□□□■□
□□■□■
■■□■□
■■■□■
□□□□□
□□□□■
□□□■■
■■■□□
■■■■□
■■■■■
(0)
(1)
(2)
(3)
(4)
(5)
FIGURE III.2.
The set W5 of the 32 binary words over the alphabet {□, ■} enumerated
according to the number of occurrences of the letter ‘■’ gives rise to the bivariate counting
sequence {W5,j} = 1, 5, 10, 10, 5, 1.
from an expansion of the BGF with respect to u,
(3)
W (z, u) =
1
1 −z
1
1 −u
z
1−z
=
X
k≥0
uk
zk
(1 −z)k+1 ,
and the result naturally matches what a direct calculation would give. END OF EXAMPLE III.1. □
 III.1. The exponential BGF of binomial coefﬁcients. It is
(4)
f
W(z, u) =
X
k,n
 
n
k
!
uk zn
n! =
X
(1 + u)n zn
n! = ez(1+u).
The vertical GFs are ezzk/k!. The horizontal GFs are (1 + u)n, like in the ordinary case. 
EXAMPLE III.2.
The BGF of Stirling cycle numbers. As seen in Chapter II Example 12,
the number of permutations of size n having k cycles is the Stirling cycle number
ˆn
k
˜
with a
vertical EGF being
P ⟨k⟩(z) :=
X
n
"
n
k
#
zn
n! = L(z)k
k!
,
L(z) := log
1
1 −z .
From there, the exponential BGF is formed as follows (this revisits some of the calculations on
p. 112):
(5)
P(z, u)
:=
X
k
P ⟨k⟩(z)uk
=
X
k
uk
k! L(z)k
=
euL(z)
=
(1 −z)−u.
The simpliﬁcation is quite remarkable but altogether quite typical, as we shall see shortly, in the
context of a labelled set construction. The starting point is thus a collection of vertical EGFs
and the scheme is now
P ⟨k⟩
n
;
P ⟨k⟩(z)
;
P(z, u).
Observe that (5) reduces to the EGF of permutations at u = 1.

144
III. PARAMETERS AND MULTIVARIATE GFS
Numbers
Horizontal GFs
 
n
k
!
(1 + u)n
Vertical OGFs
Ordinary BGF
zk
(1 −z)k+1
1
1 −z(1 + u)
Numbers
Horizontal GFs
"
n
k
#
u(u + 1) · · · (u + n −1)
Vertical EGFs
Exponential BGF
1
k!
„
log
1
1 −z
«k
(1 −z)−u
FIGURE III.3.
The various GFs associated to binomial coefﬁcients (left) and Stirling
cycle numbers (right).
In addition, an expansion of the BGF according to the variable z provides a useful infor-
mation, namely, the horizontal GFs by virtue of Newton’s binomial theorem:
(6)
P(z, u)
=
X
n≥0
 
n + u −1
n
!
zn
=
X
n≥0
Pn(u)zn
n!
where
Pn(u)
=
u(u + 1) · · · (u + n −1).
This last polynomial is called the Stirling cycle polynomial of index n and it describes com-
pletely the distribution of the number of cycles in all permutations of size n. In addition, note
that the relation
Pn(u) = Pn−1(u)(u + (n −1)),
is equivalent to a recurrence
"
n
k
#
= (n −1)
"
n −1
k
#
+
"
n −1
k −1
#
,
by which Stirling numbers are often deﬁned and easily evaluated numerically; see also AP-
PENDIX A: Stirling numbers, p. 680. (The recurrence is susceptible to a direct combinatorial
interpretation—add n either to an existing cycle or as a “new” singleton.) END OF EXAMPLE III.2. □
Concise expressions for BGFs like (2), (3), (5), or (17) summarized in Figure 3
are precious for deriving moments, variance, and even ﬁner characteristics of distri-
butions, as we see next. The determination of such BGFs can be covered by a simple
extension of the symbolic method along the lines of what was done in Chapters I
and II, as detailed in Sections III. 3 and III. 4.
III. 2. Bivariate generating functions and probability distributions
Our purpose in this book is to analyse characteristics of combinatorial structures
of very diverse types. We shall be principally interested in enumeration according to
size and an auxiliary parameter, the corresponding problems being naturally treated
by means of BGFs. In order to avoid redundant deﬁnitions, it proves convenient to
introduce the sequence of fundamental factors (ωn)n≥0, deﬁned by
(7)
ωn = 1
for ordinary GFs,
ωn = n!
for exponential GFs.

III. 2. BIVARIATE GENERATING FUNCTIONS AND PROBABILITY DISTRIBUTIONS
145
Then, the OGF and EGF of a sequence (fn) are jointly represented as
f(z) =
X
fn
zn
ωn
and
fn = ωn [zn]f(z).
Deﬁnition III.2. Given a combinatorial class A, a (scalar) parameter is a function
from A to Z≥0 that associates to any object α ∈A an integer value χ(α). The
sequence
An,k = card
 {α ∈A
 |α| = n, χ(α) = k}

,
is called the counting sequence of the pair A, χ. The bivariate generating function
(BGF) of A, χ is deﬁned as
A(z, u) :=
X
n,k≥0
An,k
zn
ωn
uk,
and is of ordinary type if ωn ≡1 and of exponential type if ωn ≡n!. One says that
the variable z marks size and the variable u marks the parameter χ.
Naturally A(z, 1) reduces to the usual counting generating function A(z) associ-
ated to A, and the cardinality of An is expressible as
An = ωn[zn]A(z, 1).
III. 2.1. Distributions and moments. As indicated in the introduction to this
chapter, the eventual goal of multivariate enumeration is the quantiﬁcation of prop-
erties present with high regularity in large random structures. Within this section,
we discuss the relationship between probabilistic models needed to interpret bivari-
ate counting sequences and bivariate generating functions. The elementary notions
needed are recalled in APPENDIX A: Combinatorial probability, p. 671.
Consider a combinatorial class A. The uniform probability distribution over An
assigns to any α ∈An a probability equal to 1/An. We shall use the symbol P to
denote probability and occasionally subscript it with an indication of the probabilistic
model used, whenever this model needs to be stressed: we shall then write PAn (or
simply Pn if A is understood) to indicate probability relative to the uniform distribu-
tion over An.
Probability generating functions. Consider a parameter χ. It determines over
each An a discrete random variable deﬁned over the discrete probability space An:
(8)
PAn{χ = k} = An,k
An
=
An,k
P
k An,k
.
Given a discrete random variable X, we recall that its probability generating function
(PGF) is the quantity
(9)
p(u) =
X
k
P(X = k)uk,
a generating function whose coefﬁcients are probabilities. From (8) and (9), one has
immediately:

146
III. PARAMETERS AND MULTIVARIATE GFS
0
0.02
0.04
0.06
0.08
0.1
10
20
30
40
50
0
0.05
0.1
0.15
0.2
10
20
30
40
50
FIGURE III.4.
Histograms of two combinatorial distributions. Left: the number of
occurrences of a designated letter in a random binary word of length 50 (binomial distri-
bution). Right: the number of cycles in a random permutation of size 50 (Stirling cycle
distribution).
Proposition III.1 (PGFs from BGFs). Let A(z, u) be the bivariate generating func-
tion of a parameter χ deﬁned over a combinatorial class A. The probability generat-
ing function of χ over An is given by
X
k
PAn(χ = k)uk = [zn]A(z, u)
[zn]A(z, 1),
and is thus a normalized version of a horizontal generating function.
The translation into the language of probability enables us to make use of which-
ever intuition might be available in any particular case, while allowing for a nat-
ural interpretation of data (Figure 4).
Indeed, instead of noting that the quantity
381922055502195 represents the number of permutations of size 20 that have 10
cycles, it is perhaps more informative to state the probability of the event, which is
0.00015, i.e., about 1.5 per ten thousand. Discrete distributions are conveniently rep-
resented by histograms or “bar charts”, where the height of the bar at abscissa k indi-
cates the value of P{X = k}. Figure 4 displays in this way two classical combinatorial
distributions. Given the uniform probabilistic model that we have been adopting, such
histograms are eventually nothing but a condensed form of the “stacks” corresponding
to exhaustive listings, like the one displayed in Figure 2.
Moments. Important information is conveyed by moments. Given a discrete ran-
dom variable X, the expectation of f(X) is by deﬁnition the linear functional
E(f(X)) :=
X
k
P{X = k} · f(k).
The (power) moments are
E(Xr) :=
X
k
P{X = k} · kr.
Then the expectation (or average, mean) of X, its variance, and its standard deviation
are expressed as
E(X),
V(X) = E(X2) −E(X)2,
σ(X) =
p
V(X).

III. 2. BIVARIATE GENERATING FUNCTIONS AND PROBABILITY DISTRIBUTIONS
147
The expectation corresponds to what is typically seen when forming the arithmetic
mean value of a large number of observations: this property is the weak law of large
numbers [161, Ch X]. The standard deviation then measures the dispersion of values
observed from the expectation and it does so in a mean-quadratic sense.
The factorial moment deﬁned for order r as
E (X(X −1) · · · (X −r + 1))
is also of interest for computational purposes, since it is obtained plainly by differen-
tiation of PGFs (APPENDIX A: Combinatorial probability, p. 671). Power moments
are then easily recovered as linear combinations of factorial moments, see Note 7 of
Appendix A. In summary:
Proposition III.2 (Moments from BGFs). The factorial moment of order r of a pa-
rameter χ is determined from the BGF A(z, u) by r-fold differentiation followed by
specialization at 1:
EAn (χ(χ −1) · · · (χ −r + 1)) = [zn]∂r
uA(z, u)|u=1
[zn]A(z, 1)
.
In particular, the ﬁrst two moments satisfy
EAn(χ) = [zn]∂uA(z, u)|u=1
[zn]A(z, 1)
,
EAn(χ2) = [zn]∂2
uA(z, u)

u=1
[zn]A(z, 1)
+ [zn]∂uA(z, u)|u=1
[zn]A(z, 1)
,
the variance and standard deviation being the determined by
V(χ) = σ(χ)2 = E(χ2) −E(χ)2.
PROOF. The PGF pn(u) of χ over An is given by Proposition III.1. On the other hand,
factorial moments are on general grounds obtained from a PGF by differentiation and
specialization at u = 1 (APPENDIX A: Combinatorial probability, p. 671). The result
follows.
□
In other words, the quantities
Ω(k)
n
:= ωn ·
 [zn] ∂k
uA(z, u)

u=1

give, after a simple normalization (by ωn · [zn]A(z, 1)), the factorial moments:
E (χ(χ −1) · · · (χ −k + 1)) = 1
An
Ω(k)
n .
Most notably, Ω(1)
n
is the cumulated value of χ over all objects of An:
Ω(1)
n
≡ωn · [zn] ∂uA(z, u)|u=1 =
X
α∈An
χ(α) ≡An · EAn(χ).
Accordingly, the GF (ordinary or exponential) of the Ω(1)
n
is sometimes named the cu-
mulative generating function. It can be viewed as an unnormalized generating function
of the sequence of expected values. These considerations explain Wilf’s suggestive
motto quoted on p. 139:
“Generating functions ﬁnd averages, etc.”
The “etc” is to be interpreted as a token for higher moments.

148
III. PARAMETERS AND MULTIVARIATE GFS
 III.2. A combinatorial form of cumulative GFs. One has
Ω(1)(z) ≡
X
n
EAn(χ)An zn
ωn =
X
α∈A
χ(α) z|α|
ω|α|
,
where ωn = 1 (ordinary case) or ωn = n! (exponential case).

EXAMPLE III.3. Moments of the binomial distribution. The binomial distribution of index n
can be deﬁned as the distribution of the number of a’s in a random word of length n over the
binary alphabet {a, b}. The determination of moments results easily from the ordinary BGF,
W (z, u) =
1
1 −z −zu.
By differentiation, one ﬁnds
∂r
∂ur W (z, u)
˛˛˛˛
u=1
=
r!zr
(1 −2z)r+1 .
Coefﬁcient extraction then gives the form of the factorial moments of orders 1, 2, 3, . . . , r as
n
2 ,
n(n −1)
4
,
n(n −1)(n −2)
8
, . . . ,
r!
2r
 
n
r
!
.
In particular, the mean and the variance are 1
2n and 1
4n. The standard deviation is thus 1
2
√n
which is of an order much smaller than the mean: this indicates that the distribution is some-
how concentrated around its mean value, as suggested by Figure 4; see the next subsection for
quantitative estimates. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE III.3. □
 III.3. De Moivre’s approximation of the Gaussian coefﬁcients. The fact that the mean and
the standard deviation of the binomial distribution are respectively 1
2n and 1
2
√n suggests an
examination of what goes on at a distance of x standard deviations from the mean. Consider for
simplicity the case of n = 2ν even. From the ratio
r(ν, ℓ) :=
` 2ν
ν+ℓ
´
`2ν
ν
´ = (1 −1
ν )(1 −2
ν ) · · · (1 −k−1
ν )
(1 + 1
ν )(1 + 2
ν ) · · · (1 + k
ν )
an estimate of the logarithm shows that for any ﬁxed x ∈R,
lim
n→∞, ℓ=ν+x√
ν/2
` 2ν
ν+ℓ
´
`2ν
ν
´ = e−x2/2.
(Alternatively, Stirling’s formula can be employed.) This Gaussian approximation for the bi-
nomial distribution was ﬁrst discovered in 1733 by Abraham de Moivre (1667–1754), a close
friend of Newton. Much more general methods for establishing such approximations form the
subject of Chapter IX.

EXAMPLE III.4.
Moments of the Stirling cycle distribution. Let us return to the example of
cycles in permutations which is of interest in connection with certain sorting algorithms like
bubble sort or insertion sort, maximum ﬁnding, and in situ rearrangement [301].
We are dealing with labelled objects, hence exponential generating functions. As seen
earlier on p. 143, the BGF of permutations counted according to cycles is
P(z, u) = (1 −z)−u.
We have Pn = n!, while ωn = n! since the BGF is exponential. (The number of permutations
of size n being n!, the combinatorial normalization happens to coincide with the factor of 1/n!
present in all exponential generating functions.)

III. 2. BIVARIATE GENERATING FUNCTIONS AND PROBABILITY DISTRIBUTIONS
149
By differentiation of the BGF with respect to u, then setting u = 1, we next get the
expected number of cycles in a random permutation of size n as a Taylor coefﬁcient
(10)
En(χ) = [zn]
1
1 −z log
1
1 −z = 1 + 1
2 + · · · + 1
n,
which is the harmonic number Hn. Thus, on average, a random permutation of size n has about
log n + γ cycles, a well known fact of discrete probability theory, derived on p. 112 by means
of horizontal generating functions.
For the variance, a further differentiation of the bivariate EGF gives
(11)
X
n≥0
En(χ(χ −1))zn =
1
1 −z
„
log
1
1 −z
«2
.
From this expression and Note 4 (or directly from the Stirling polynomials), a calculation shows
that
(12)
σ2
n =
 n
X
k=1
1
k
!
−
 n
X
k=1
1
k2
!
= log n + γ −π2
6 + O
„ 1
n
«
.
Thus, asymptotically,
σn ∼
p
log n.
The standard deviation is of an order smaller than the mean, and therefore deviations from the
mean have an asymptotically negligible probability of occurrence (see below the discussion of
moment inequalities). Furthermore, the distribution was proved to be asymptotically Gaussian
by V. Gonˇcarov, around 1942, see [240] and Chapter IX. . . . . . . . END OF EXAMPLE III.4. □
 III.4. Stirling cycle numbers and harmonic numbers. By the “exp-log trick” of Chapter I,
the PGF of the Stirling cycle distribution satisﬁes
1
n!u(u + 1) · · · (u + n −1) = exp
„
v Hn −v2
2 H(2)
n +v3
3 H(3)
n + · · ·
«
,
u = 1 + v
where H(r)
n
is the generalized harmonic number Pn
j=1 j−r. Consequently, any moment of
the distribution is a polynomial in generalized harmonic numbers, cf (10) and (12). Also, the
kth moment satisﬁes EPn(χk) ∼(log n)k. (The same technique expresses the Stirling cycle
number
ˆn
k
˜
as a polynomial in generalized harmonic numbers H(r)
n−1.)
Alternatively, start from the expansion of (1 −z)−α and differentiate repeatedly with
respect to α; for instance, one has
(1 −z)−α log
1
1 −z =
X
n≥0
„ 1
α +
1
α + 1 + · · · +
1
n −1 + α
«  
n + α −1
n
!
zn,
which provides (10) upon setting α = 1, while the next differentiation gives access to (12). 
The situation encountered with cycles in permutations is typical of iterative (non–
recursive) structures. In many other cases, especially when dealing with recursive
structures, the bivariate GF may satisfy complicated functional equations in two vari-
ables (see the example of path length in trees, Section III. 5 below) that do not make
them available under an explicit form. Thus, exact expressions for the distributions
are not always available, but asymptotic laws can be determined in a large number of
cases (Chapter IX). In all cases, the BGFs are the central tool in obtaining mean and
variance estimates, since their derivatives instantiated at u = 1 become univariate GFs
that usually satisfy much simpler relations than the BGFs themselves.

150
III. PARAMETERS AND MULTIVARIATE GFS
III. 2.2. Moment inequalities and concentration of distributions. Qualitative-
ly speaking, families of distributions can be classiﬁed into two categories: (i) distri-
butions that are spread, i.e., the standard deviation is of order at least as large as the
mean (e.g.the uniform distributions over [0 . . n], which have totally ﬂat histograms,
are spread); (ii) distributions such that the standard deviation is of an order smaller
than the mean. Figure 4 illustrates the phenomena at stake and suggests that both
the Stirling cycle distributions and the binomial distributions belong to the second
category and are somehow concentrated around their mean value. Such informal ob-
servations are indeed supported by the Markov-Chebyshev inequalities, which take
advantage of information provided by the ﬁrst two moments. (A proof is found in
APPENDIX A: Combinatorial probability, p. 671.)
Markov-Chebyshev inequalities. Let X be a nonnegative random variable
and Y an arbitrary real variable. One has for any t > 0:
P {X ≥tE(X)}
≤
1
t
(Markov inequality)
P {|Y −E(Y )| ≥tσ(Y )}
≤
1
t2
(Chebyshev inequality).
This result informs us that the probability of being much larger than the mean must
decay (Markov) and that an upperbound on the decay is measured in units given by
the standard deviation (Chebyshev).
The next proposition formalizes a concentration property of distributions. It ap-
plies to a family of distributions indexed by the integers.
Proposition III.3 (Concentration of distribution). Consider a family of random vari-
ables Xn, typically, a scalar parameter χ on the subclass An. Assume that the means
µn = E(Xn) and the standard deviations σn = σ(Xn) satisfy the condition
lim
n→+∞
σn
µn
= 0.
Then the distribution of Xn is concentrated in the sense that, for any ǫ > 0, there
holds
(13)
lim
n→+∞P

1 −ǫ ≤Xn
µn
≤1 + ǫ

= 1.
PROOF. It is a direct consequence of Chebyshev’s inequality.
□
The concentration property (13) expresses the fact that values of Xn tend to be-
come closer and closer (in relative terms) to the mean µn as n increases. Another ﬁgu-
rative way to describe concentration, much used in random combinatorics, is by saying
that “Xn/µn tends to 1 in probability”. When this property is satisﬁed, the expected
value is in a strong sense a typical value. This fact is an extension of the weak law of
large numbers of probability theory. In that ﬁeld, the concentration property (13) is
also known as convergence in probability and is then written more concisely:
Xn
µn
P
−→1.

III. 3. INHERITED PARAMETERS AND ORDINARY MGFS
151
0
0.05
0.1
0.15
0.2
0.25
0.3
0.2
0.4
0.6
0.8
1
FIGURE III.5. Plots of the binomial distributions for n = 5, . . . , 50. The horizon-
tal axis is normalized (by a factor of 1/n) and rescaled to 1, so that the curves display
˘
P( Xn
n = x)
¯
, for x = 0, 1
n, 2
n, . . . .
Concentration properties of the binomial and Stirling cycle distributions. The
binomial distribution is concentrated, since the mean of the distribution is n/2 and
the standard deviation is
p
n/4, a much smaller quantity. Figure 5 illustrates con-
centration by displaying the graphs (as polygonal lines) associated to the binomial
distributions for n = 5, . . . , 50. Concentration is also quite perceptible on simula-
tions as n gets large: the table below describes the results of batches of ten (sorted)
simulations from the binomial distribution
 1
2n
 n
k
	n
k=0:
n = 100
39, 42, 43, 49, 50, 52, 54, 55, 55, 57
n = 1000
487, 492, 494, 494, 506, 508, 512, 516, 527, 545
n = 10, 000
4972, 4988, 5000, 5004, 5012, 5017, 5023, 5025, 5034, 5065
n = 100, 000
49798, 49873, 49968, 49980, 49999, 50017, 50029, 50080, 50101, 50284;
the maximal deviations from the mean observed on such samples are 22% (n = 102),
9% (n = 103), 1.3% (n = 104), and 0.6% (n = 105).
Similarly, the mean and variance computations of (10) and (12) imply that the
number of cycles in a random permutation of large size is concentrated.
Finer estimates on distributions form the subject of our Chapter IX dedicated
to limit laws.
The reader may get a feeling of some of the phenomena at stake
when re-examining Figure 5: the visible emergence of a continuous curve (the bell
shaped curve) corresponds to a common asymptotic shape for the whole family of
distributions—the Gaussian law.
III. 3. Inherited parameters and ordinary MGFs
We have seen so far basic manipulations of BGFs (Section III.1) as well as their
use in order to determine moments of combinatorial distributions (Section III.2). In
this section and its labelled counterpart, Section III. 4, we address the question of de-
termining directly BGFs from combinatorial speciﬁcations. The answer is provided
by a simple extension of the symbolic method, which is formulated in terms of multi-
variate generating functions (MGFs). Such generating functions have the capability of

152
III. PARAMETERS AND MULTIVARIATE GFS
taking into account a ﬁnite collection (equivalently, a vector) of combinatorial parame-
ters. On the one hand, the theory specializes immediately to BGFs, which correspond
to the particular case of a single (scalar) parameter. On the other hand, it provides
“complete” (multivariate) generating functions discussed in Section III.6.
III. 3.1. Multivariate generating functions (MGFs). The theory is best devel-
oped in full generality for the joint analysis of a ﬁxed ﬁnite collection of parameters.
Deﬁnition III.3. Consider a combinatorial class A. A (multidimensional) parameter
χ = (χ1, . . . , χd) on the class is a function from A to the set Zd
≥0 of d-tuples of natural
numbers. The counting sequence of A with respect to size and the parameter χ is then
deﬁned by
An,k1,...,kd = card

α
 |α| = n, χ1(α) = k1, . . . , χd(α) = kd
	
.
We sometimes refer to such a parameter as a “multiparameter” when d > 1, and
a “simple” or “scalar” parameter otherwise. For instance, one may take the class P
of all permutations σ, and for χj (j = 1, 2, 3) the number of cycles of length j in σ.
Alternatively, we may consider the class W of all words w over an alphabet with four
letters, {α1, . . . , α4} and take for χj (j = 1, . . . , 4) the number of occurrences of the
letter αj in w, and so on.
The multi-index convention employed in various branches of mathematics greatly
simpliﬁes notations: let u = (u1, . . . , ud) be a vector of d formal variables and k =
(k1, . . . , kd) be a vector of integers of the same dimension; then, the multi-power uk
is deﬁned as the monomial
(14)
uk := uk1
1 uk2
2 · · · ukd
d .
With this notation, we have:
Deﬁnition III.4. Let An,k be a multi-index sequence of numbers, where k ∈Nd.
The multivariate generating function (MGF) of the sequence of either ordinary or
exponential type is deﬁned as the formal power series
(15)
A(z, u)
=
X
n,k
An,kukzn
(ordinary MGF)
A(z, u)
=
X
n,k
An,kuk zn
n!
(exponential MGF).
Given a class A and a parameter χ, the multivariate generating function (MGF)
of the pair ⟨A, χ⟩is the MGF of the corresponding counting sequence. In particular,
one has the combinatorial forms
(16)
A(z, u)
=
X
α∈A
uχ(α)z|α|
(ordinary MGF; unlabelled case)
A(z, u)
=
X
α∈A
uχ(α) z|α|
|α|!
(exponential MGF; labelled case).
One also says that A(z, u) is the MGF of the combinatorial class with the formal
variable uj marking the parameter χj and z marking size.

III. 3. INHERITED PARAMETERS AND ORDINARY MGFS
153
From the very deﬁnition, A(z, 1) (with 1 a vector of all 1’s) coincides with the
counting generating function of A, either ordinary or exponential as the case may be.
One can then view an MGF as a deformation of a univariate GF by way of a (vector)
parameter u, with the property for the multivariate GF to reduce to the univariate
counting GF at u = 1. If all but one of the uj are set to 1, then a BGF results.
Thus, the symbolic calculus that we are going to develop opens full access to BGFs
and hence moments. In fact, it has the capacity of determining the joint probability
distribution of a ﬁnite collection of parameters.
 III.5. Specializations of MGFs. The exponential MGF of permutations with u1, u2 marking
the number of 1-cycles and 2-cycles respectively turns out to be
(17)
P(z, u1, u2) =
exp
“
(u1 −1)z + (u2 −1) z2
2
”
1 −z
.
(This is to be proved later in this chapter, p. 175.) The formula is checked to be consistent with
three already known specializations derived in Chapter II: (i) setting u1 = u2 = 1 gives back
the counting of all permutations, P(z, 1, 1) = (1 −z)−1, as it should; (ii) setting u1 = 0 and
u2 = 1 gives back the EGF of derangements, namely e−z/(1 −z); (iii) setting u1 = u2 = 0
gives back the EGF of permutations with cycles all of length greater than 2, P(z, 0, 0) =
e−z−z2/2/(1 −z), a generalized derangement GF. In addition, the specialized BGF
P(z, u, 1) = e(u−1)z
1 −z ,
enumerates permutations according to singleton cycles. This last BGF interpolates between the
EGF of derangements (u = 0) and the EGF of all permutations (u = 1).

III. 3.2. Inheritance and MGFs. Parameters that are inherited from substruc-
tures can be taken into account by a direct extension of the symbolic method. With
a suitable use of the multi-index conventions, it is even the case that the translation
rules previously established in Chapters I and II can be copied verbatim. This ap-
proach opens the way to a large quantity of multivariate enumeration results that then
follow automatically by the symbolic method.
Let us consider a pair ⟨A, χ⟩, where A is a combinatorial class endowed with its
usual size function | · | and χ = (χ1, . . . , χd) is a d-dimensional (multi)parameter.
Write χ0 for size and z0 for the variable marking size (previously denoted by z).
The key point for theoretical developments is to deﬁne an extended multiparameter
χ = (χ0, χ1, . . . , χd), that is, we treat size and parameters on an equal basis. Then
the ordinary MGF in (15) assumes an extremely simple and symmetrical form:
(18)
A(z)
=
X
k
Akzk
=
X
α∈A
zχ(α).
There, the indeterminates are the vector z = (z0, z1, . . . , zd), the indices are k =
(k0, k1, . . . , kd) (where k0 indexes size, previously denoted by n), and the usual multi-
index convention introduced in (14) is in force,
(19)
zk := zk0
0 zk1
1 · · · zdkd,

154
III. PARAMETERS AND MULTIVARIATE GFS
but it is now applied to (d + 1)-dimensional vectors.
Next, we deﬁne inherited parameters.
Deﬁnition III.5. Let ⟨A, χ⟩, ⟨B, ξ⟩, ⟨C, ζ⟩be three combinatorial classes endowed
with parameters of the same dimension d. The parameter χ is said to be inherited in
the following cases:
• Disjoint union: when A = B + C, the parameter χ is inherited from ξ, ζ iff
its value is determined by cases from ξ, ζ:
χ(ω) =



ξ(ω)
if ω ∈B
ζ(ω)
if ω ∈C.
• Cartesian product: when A = B × C, the parameter χ is inherited from ξ, ζ
iff its value is obtained additively from the values of ξ, ζ:
χ(⟨β, γ⟩) = ξ(β) + ζ(γ).
• Composite constructions: when A = K{B}, where K is a metasymbol
representing any of SEQ, MSET, PSET, CYC, the parameter χ is inherited
from ξ iff its value is obtained additively from the values of ξ on components;
for instance, for sequences:
χ([β1, . . . , βr]) = ξ(β1) + · · · + ξ(βr).
With a natural extension of the notation used for constructions, one shall write
⟨A, χ⟩= ⟨B, ξ⟩+ ⟨C, ζ⟩,
⟨A, χ⟩= ⟨B, ξ⟩× ⟨C, ζ⟩,
⟨A, χ⟩= K {⟨B, ξ⟩} .
This deﬁnition of inheritance is seen to be a natural extension of the axioms that
size itself has to satisfy (Chapter I): size of a disjoint union is deﬁned by cases, while
size of a pair, and similarly of a composite construction, is obtained by addition.
Theorem III.1 (Inherited parameters and ordinary MGFs). Let A be a combinatorial
class constructed from B, C, and let χ be a parameter inherited from ξ deﬁned on
B and (as the case may be) from ζ on C. Then the translation rules of admissible
constructions stated in Theorem I.1 apply provided the multi-index convention (18) is
used. The associated operators on ordinary MGFs are then:
Union:
A = B + C
=⇒
A(z) = B(z) + C(z)
Product:
A = B × C
=⇒
A(z) = B(z) · C(z)
Sequence:
A = SEQ(B)
=⇒
A(z) =
1
1 −B(z)
Cycle:
A = CYC(B)
=⇒
A(z) =
∞
X
ℓ=1
ϕ(ℓ)
ℓ
log
1
1 −B(zℓ).
Multiset:
A = MSET(B)
=⇒
A(z) = exp
 ∞
X
ℓ=1
1
ℓB(zℓ)

Powerset:
A = PSET(B)
=⇒
A(z) = exp
 ∞
X
ℓ=1
(−1)ℓ−1
ℓ
B(zℓ)


III. 3. INHERITED PARAMETERS AND ORDINARY MGFS
155
PROOF. The veriﬁcation for sums and products is immediate, given the combinatorial
forms of OGFs. For disjoint unions, one has
A(z) =
X
α∈A
zχ(α) =
X
β∈B
zξ(β) +
X
γ∈C
zζ(γ),
as results from the fact that inheritance is deﬁned by cases on unions. For cartesian
products, one has
A(z) =
X
α∈A
zχ(α) =
X
β∈B
zξ(β) ×
X
γ∈C
zζ(γ),
as results from the fact that inheritance is deﬁned additively on products.
The translation of composite constructions in the case of sequences, powersets,
and multisets are then built up from the union and product schemes, in exactly the
same manner as in the proof of Theorem I.1. Cycles are dealt with by the methods of
APPENDIX A: Cycle construction, p. 674.
□
This theorem is a straightforward extension of the symbolic method, but it is im-
portant because it can be applied in a wide range of combinatorial applications. The
reader is especially encouraged to study carefully the treatment of integer composi-
tions below, as it illustrates in its bare bones version the power of the symbolic method
for taking into account combinatorial parameters.
The multi-index notation is a crucial ingredient for developing the general theory
of multivariate enumerations. However, in most cases, we work with only a small
number of parameters, typically one or two. In such cases, we often use vectors of
variables like (z, u) or (z, u, v), the corresponding monomials being then written as
znuk or znukvℓ. This has the advantage of avoiding unnecessary subscripts.
Integer compositions and marks. The class C of all integer compositions (Chap-
ter I) is speciﬁed by
C = SEQ(I),
I = SEQ≥1(Z),
where I is the set of all positive numbers. The corresponding OGFS are
C(z) =
1
1 −I(z),
I(z) =
z
1 −z ,
so that Cn = 2n−1 (n ≥1). Say we want to enumerate compositions according
to the number χ of summands. One way to proceed, in accordance with the formal
deﬁnition of inheritance, is as follows. Let ξ be the parameter that takes the constant
value 1 on all elements of I. The parameter χ on compositions is inherited from the
(almost trivial) parameter ξ ≡1 deﬁned on summands. The ordinary MGF of ⟨I, ξ⟩
is obviously
I(z, u) = zu + z2u + z3u + · · · =
zu
1 −z .
Let C(z, u) be the BGF of ⟨C, χ⟩. By Theorem III.1, the schemes translating admis-
sible constructions in the univariate case carry over to the multivariate case, so that
(20)
C(z, u) =
1
1 −I(z, u) =
1
1 −u
z
1−z
=
1 −z
1 −z(u + 1).
Et voila!

156
III. PARAMETERS AND MULTIVARIATE GFS
Here is an alternative way of arriving at (20), which is important and is of much
use in the sequel. One may regard the enumeration of compositions with respect to
the number of summands as the enumeration of compositions with respect to both
size (i.e., number of atoms) and number of marks, where each summand carries a
mark, say ‘µ’, which is an object of size 0. The number of marks is clearly inherited
from summands to compositions. Then, one has an enriched speciﬁcation, and its
translation into MGFs,
(21)
C = SEQ
 µ SEQ≥1(Z)

=⇒
C(z, u) =
1
1 −uI(z).
as granted by Theorem III.1 and based on the correspondence: Z 7→z, µ 7→u.
This notion of mark when used in conjunction with Theorem III.1 provides access to
many joint parameters, as shown in Example 5 below.
EXAMPLE III.5.
Summands in integer compositions.
Consider the double parameter χ =
(χ1, χ2) where χ1 is the number of parts equal to 1 and χ2 the number of parts equal to 2. One
can write down an extended speciﬁcation, with µ1 a combinatorial mark for summands equal
to 1 and µ2 for summands equal to 2,
(22)
C = SEQ
„
µ1Z + µ2Z2 + SEQ≥3(Z)
«
=⇒
C(z, u1, u2) =
1
1 −(u1z + u2z2 + z3(1 −z)−1),
where uj (j = 1, 2) records the number of marks of type µj.
Similarly, let µ mark each summand and µ1 mark summands equal to 1. Then, one has,
(23) C = SEQ
„
µµ1Z +µ SEQ≥2(Z)
«
=⇒C(z, u1, u) =
1
1 −(uu1z + uz2(1 −z)−1),
where u keeps track of the total number of summands and u1 records the number of summands
equal to 1.
MGFs obtained in this way via the multivariate extension of the symbolic method can then
provide explicit counts, after suitable series expansions. For instance, the number of composi-
tions of n with k parts is, by (20),
[znuk]
1 −z
1 −(1 + u)z =
 
n
k
!
−
 
n −1
k
!
=
 
n −1
k −1
!
,
a result otherwise obtained in Chapter I by direct combinatorial reasoning (the balls-and-bars
model). The number of compositions of n containing k parts equal to 1 is obtained from the
special case u2 = 1 in (22),
[znuk]
1
1 −uz −
z2
(1−z)
= [zn−k]
(1 −z)k+1
(1 −z −z2)k+1 ,
where the last OGF closely resembles a power of the OGF of Fibonacci numbers.
Following the discussion of Section III. 2, such MGFs also carry complete information on
moments. In particular, the cumulated value of the number of parts in all compositions of n has
OGF
∂uC(z, u)|u=1 = z(1 −z)
(1 −2z)2 ,

III. 3. INHERITED PARAMETERS AND ORDINARY MGFS
157
0
2
4
6
8
10
10
20
30
40
0
2
4
6
8
10
10
20
30
40
FIGURE III.6. A random composition of n = 100 represented as a ragged landscape
(top); its associated proﬁle 120212310415171101, deﬁned as the partition obtained by sort-
ing the summands (bottom).
as seen from Section III. 2.1, since cumulated values are obtained via differentiation of a BGF.
Therefore, the expected number of parts in a random composition of n is exactly (n ≥1)
1
2n−1 [zn] z(1 −z)
(1 −2z)2 = 1
2(n + 1).
A further differentiation will give access to the variance. The standard deviation is found to
be 1
2
√n −1, which is of an order (much) smaller than the mean. Thus, the distribution of the
number of summands in a random composition satisﬁes the concentration property as n →∞.
In the same vein, the number of parts equal to a ﬁxed number r in compositions is deter-
mined by
C = SEQ
„
µZr + SEQ̸=r(Z)
«
=⇒
C(z, u) =
„
1 −
„
z
1 −z + (u −1)zr
««−1
.
It is then easy to pull out the expected number of r-summands in a random composition of
size n. The differentiated form
∂uC(z, u)|u=1 = zr(1 −z)2
(1 −2z)2
gives by partial fraction expansion
∂uC(z, u)|u=1 =
2−r−2
(1 −2z)2 + 2−r−1 −r2−r−2
1 −2z
+ q(z),
for a polynomial q(z) that we do not need to make explicit. Extracting the nth coefﬁcient of the
cumulative GF C′
u(z, 1) and dividing by 2n−1 yields the mean number of r-parts in a random
composition. Another differentiation gives access to the second moment. One ﬁnds:
Proposition III.4 (Summands in integer compositions). The total number of summands in a
random composition of size n has mean 1
2(n+1) and a distribution that is concentrated around
the mean. The number of r summands in a composition of size n has mean
n
2r+1 + O(1);
and a standard deviation of order √n, which also ensures concentration of distribution.

158
III. PARAMETERS AND MULTIVARIATE GFS
Clearly, suitable MGFs can keep track of any ﬁnite collection of summand types in compo-
sitions, and the method is extremely general. Much use of this way of envisioning multivariate
enumeration will be made throughout this book. . . . . . . . . . . . . . . . END OF EXAMPLE III.5. □
From the point of view of random structures, the example of summands shows
that random compositions of large size tend to conform to a global “proﬁle”. With
high probability, a composition of size n should have about n/4 parts equal to 1, n/8
parts equal to 2, and so on. Naturally, there are statistically unavoidable ﬂuctuations,
and for any ﬁnite n, the regularity of this law cannot be perfect: it tends to fade
away especially as regards to largest summands that are log2(n) + O(1) with high
probability. (In this region mean and standard deviation both become of the same order
and are O(1), so that concentration no longer holds.) However, such observations do
tell us a great deal about what a typical random composition must (probably) look
like—it should conform to a “logarithmic proﬁle”,
1n/4 2n/8 3n/16 4n/32 · · · .
Here are for instance the proﬁles of two compositions of size n = 1024 drawn uni-
formly at random:
1250 2138 370 429 515 610 74 80, 91,
1253 2136 368 431 513 68 73 81 91 102
to be compared to the “ideal” proﬁle
1256 2128 364 432 516 68 74 82 91.
It is a striking fact that samples of a very few elements or even just one element (this
would be ridiculous by the usual standards of statistics) are often sufﬁcient to illus-
trate asymptotic properties of large random structures. The reason is once more to be
attributed to concentration of distributions whose effect is manifest here. Proﬁles of a
similar nature present themselves amongst objects deﬁned by the sequence construc-
tion, as we shall see throughout this book. (Establishing such general laws is often
not difﬁcult but it requires the full power of complex-analytic methods developed in
Chapters IV–VIII.)
 III.6. Largest summands in compositions. For any ǫ > 0, with probability tending to 1 as
n →∞, the largest summand in a random integer composition of size n is of size in the interval
[(1 −ǫ) log2 n, (1 + ǫ) log2 n]. (Hint: use the ﬁrst and second moment methods. More precise
estimates are given in Chapter V.)

In the sequel, it proves convenient to adopt a simplifying notation, much in the
spirit of our basic convention, where the atom Z is systematically reﬂected by the
name z of the variable in GFs.
Simpliﬁed notation for marks. The same symbol (usually u, v, u1, u2 . . .)
is freely employed to designate a combinatorial mark (of size 0) and the
corresponding marking variable in MGFs.
For instance, we allow ourselves to write directly, for compositions,
C = SEQ(u SEQ≥1 Z)),
C = SEQ(uu1Z + u SEQ≥2 Z)),

III. 3. INHERITED PARAMETERS AND ORDINARY MGFS
159
where u marks all summands and u1 marks summands equal to 1, giving rise to (21)
and (23). Note that the symbolic scheme of Theorem III.1 invariably applies to enu-
meration according to the number of zero-size marks inserted into speciﬁcations.
III. 3.3. Number of components in abstract unlabelled schemas. Consider a
construction A = K(B), where the metasymbol K designates any standard unlabelled
constructor amongst SEQ, MSET, PSET, CYC. What is sought is the BGF A(z, u) of
class A, with u marking each component. The speciﬁcation is then of the form
A = K(uB),
K = SEQ, MSET, PSET, CYC .
Theorem III.1 applies and yields immediately the BGF A(z, u). In addition, differ-
entiating with respect to u then setting u = 1 provides the GF of cumulated values
(hence, in a non-normalized form, the OGF of the sequence of mean values of the
number of components):
Ω(z) =
∂
∂uA(z, u)

u=1
.
In summary:
Proposition III.5 (Components in unlabelled schemas). Given a construction, A =
K(B), the BGF A(z, u) and the cumulated GF Ω(z) associated to the number of com-
ponents are given by the following table:
K
BGF (A(z, u))
Cumulative OGF (Ω(z))
SEQ :
1
1 −uB(z)
A(z)2 · B(z) =
B(z)
(1 −B(z))2
PSET :
8
>
>
>
<
>
>
>
:
exp
 ∞
X
k=1
(−1)k−1 uk
k B(zk)
!
∞
Y
n=1
(1 + uzn)Bn
A(z) ·
∞
X
k=1
(−1)k−1B(zk)
MSET :
8
>
>
>
<
>
>
>
:
exp
 ∞
X
k=1
uk
k B(zk)
!
∞
Y
n=1
(1 −uzn)−Bn
A(z) ·
∞
X
k=1
B(zk)
CYC :
∞
X
k=1
ϕ(k)
k
log
1
1 −ukB(zk)
∞
X
k=1
ϕ(k)
B(zk)
1 −B(zk).
Mean values are then recovered with the usual formula,
EAn(# components) = [zn]Ω(z)
[zn]A(z).
A similar process applies to the number of components of a ﬁxed size r in an A-object.
 III.7. r-Components in abstract unlabelled schemas. Consider unlabelled structures. The
BGF of the number of r-components in A = K{B} is given by
A(z, u) = (1 −B(z) −(u −1)Brzr)−1 ,
A(z, u) = A(z) ·
„ 1 −zr
1 −uzr
«Br
,
in the case of sequences (K = SEQ) and multisets (K = MSET), respectively. Similar formulæ
hold for the other basic constructions and the cumulative GFs.


160
III. PARAMETERS AND MULTIVARIATE GFS
0
5
10
15
20
2
4
6
8 10
FIGURE III.7. A random partition of size n = 100 has an aspect rather different from
the proﬁle of a random composition of the same size (Figure 6).
 III.8. Number of distinct components in a multiset. The speciﬁcation and the BGF are
Y
β∈B
`
1 + u SEQ≥1(β)
´
=⇒
Y
n≥1
„
1 +
uzn
1 −zn
«Bn
,
as follows from ﬁrst principles.

As an illustration, we discuss the proﬁle of random partitions (Figure 7).
EXAMPLE III.6.
The proﬁle of partitions. Let P = MSET(I) be the class of all integer
partitions, where I = SEQ≥1(Z) represents integers in unary notation. The BGF of P with u
marking the number χ of parts (or summands) is obtained from the speciﬁcation
P = MSET(uI)
=⇒
P(z, u) = exp
 ∞
X
k=1
uk
k
zk
1 −zk
!
.
Equivalently, from ﬁrst principles,
P ∼=
∞
Y
n=1
SEQ (uIn)
=⇒
∞
Y
n=1
1
1 −uzn .
The OGF of cumulated values then results from the second form of the BGF by logarithmic
differentiation:
(24)
Ω(z) = P(z) ·
∞
X
k=1
zk
1 −zk .
Now, the factor on the right in (24) can be expanded as
∞
X
k=1
zk
1 −zk =
∞
X
n=1
d(n)zn,
with d(n) the number of divisors of n. Thus, the mean value of χ is
(25)
En(χ) = 1
Pn
n
X
j=1
d(j)Pn−j.

III. 3. INHERITED PARAMETERS AND ORDINARY MGFS
161
0
20
40
60
80
100
100
200
300
400
500
FIGURE III.8. The number of parts in random partitions of size 1, . . . , 500: exact values
of the mean and simulations (circles, one for each value of n).
The same technique applies to the number of parts equal to r. The form of the BGF is
eP ∼= SEQ(uIr) ×
Y
n̸=r
SEQ(In)
=⇒
eP(z, u) = 1 −zr
1 −uzr · P(z),
which implies that the mean value of the number eχ of r-parts satisﬁes
En(eχ) = 1
Pn [zn]
„
P(z) ·
zr
1 −zr
«
= 1
Pn (Pn−r + Pn−2r + Pn−3r + · · · ) .
From these formulæ and a decent symbolic manipulation package, the means are calculated
easily till values of n well in the range of several thousand. . . . . . END OF EXAMPLE III.6. □
The comparison between Figures 6 and 7 together with the supporting analysis
shows that different combinatorial models may well lead to rather different types of
probabilistic behaviours. Figure 8 displays the exact value of the mean number of parts
in random partitions of size n = 1, . . . , 500, (as calculated from (25)) accompanied
0
10
20
30
40
50
60
70
10
20
30
40
50
60
 
0
10
20
30
40
50
60
20
40
60
80
 
FIGURE III.9. Two partitions of P1000 drawn at random, compared to the limiting shape
Ψ(x) deﬁned by (26).

162
III. PARAMETERS AND MULTIVARIATE GFS
with the observed values of one random sample for each value of n in the range. The
mean number of parts is known to be asymptotic to
√n log n
π
p
2/3
,
and the distribution, though it admits a comparatively large standard deviation (O(√n)),
is still concentrated in the technical sense. We shall prove some of these assertions in
Chapter IX, p. 547 (see also [155]).
In recent years, Vershik and his collaborators [118, 484] have shown that most in-
teger partitions tend to conform to a deﬁnite proﬁle given (after normalization by √n)
by the continuous plane curve y = Ψ(x) deﬁned implicitly by
(26)
y = Ψ(x)
iff
e−αx + e−αy = 1,
α = π
√
6.
This is illustrated in Figure 9 by two randomly drawn elements of P1000 represented
together with the “most likely” limit shape. The theoretical result explains the huge
differences that are manifest on simulations between integer compositions and integer
partitions.
The last example demonstrates the application of BGFs to estimates regarding
the root degree of a tree drawn uniformly at random amongst the class Gn of general
Catalan trees of size n. Tree parameters such as number of leaves and path length
that are more global in nature and need a recursive deﬁnition will be discussed in
Section III. 5 below.
EXAMPLE III.7.
Root degree in general Catalan trees.
Consider the parameter χ equal to
the degree of the root in a tree, and take the class G of all plane unlabelled trees, i.e., general
Catalan trees. The speciﬁcation is obtained by ﬁrst deﬁning trees (G), then deﬁning trees with a
mark for subtrees(G◦) dangling from the root:
8
<
:
G = Z × SEQ(G)
G◦= Z × SEQ(uG)
=⇒
8
>
<
>
:
G(z) =
z
1 −G(z)
G(z, u) =
z
1 −uG(z).
This set of equations reveals that the probability that the root degree equals r is
Pn{χ = r} =
1
Gn [zn−1]G(z)r =
r
n −1
 
2n −3 −r
n −2
!
∼
r
2r+1 ,
this by Lagrange inversion and elementary asymptotics. Also, the cumulative GF is found to be
Ω(z) =
zG(z)
(1 −G(z))2 .
The relation satisﬁed by G entails a further simpliﬁcation,
Ω(z) = 1
z G(z)3 =
„1
z −1
«
G(z) −1,
so that the mean root degree admits a closed form,
En(χ) =
1
Gn (Gn+1 −Gn) = 3n −1
n + 1,
a quantity clearly asymptotic to 3.

III. 4. INHERITED PARAMETERS AND EXPONENTIAL MGFS
163
A random plane tree is thus usually composed of a small number of root subtrees, at least
one of which should accordingly be fairly large. . . . . . . . . . . . . . . . END OF EXAMPLE III.7. □
III. 4. Inherited parameters and exponential MGFs
The theory of inheritance developed in the last section applies almost verbatim to
labelled objects. The only difference is that the variable marking size must carry a fac-
torial coefﬁcient dictated by the needs of relabellings. Once more, with a suitable use
of multi-index conventions, the translation mechanisms developed in the univariate
case (Chapter II) remain in vigour, this in a way that parallels the unlabelled case.
Let us consider a pair ⟨A, χ⟩, where A is a labelled combinatorial class endowed
with its size function | · | and χ = (χ1, . . . , χd) is a d-dimensional parameter. Like
before, the parameter χ is extended into χ by inserting size as zeroth coordinate and
a vector z = (z0, . . . , zd) of d + 1 indeterminates is introduced, with z0 marking size
and zj marking χj. Once the multi-index convention of (19) deﬁning zk has been
brought into the game, the exponential MGF of ⟨A, χ⟩(see Deﬁnition III.4) can be
rephrased as
(27)
A(z)
=
X
k
Ak
zk
k0!
=
X
α∈A
zχ(α)
|α|! .
In a sense, this MGF is exponential in z (alias z0) but ordinary in the other variables;
only the factorial k0! is needed to take into account relabelling induced by labelled
products.
We a priori restrict attention to parameters that do not depend on the absolute
values of labels (but may well depend on the relative order of labels): a parameter is
said to be compatible if, for any α, it assumes the same value on any labelled object α
and all the order-consistent relabellings of α. A parameter is said to be inherited if it is
compatible and it is deﬁned by cases on disjoint unions and determined additively on
labelled products—this is Deﬁnition III.5 with labelled products replacing cartesian
products. In particular, for a compatible parameter, inheritance signiﬁes additivity on
components of labelled sequences, sets, and cycles. We can then cut-and-paste (with
minor adjustments) the statement of Theorem III.1:
Theorem III.2 (Inherited parameters and exponential MGFs). Let A be a labelled
combinatorial class constructed from B, C, and let χ be a parameter inherited from
ξ deﬁned on B and (as the case may be) from ζ on C. Then the translation rules
of admissible constructions stated in Theorem II.1 apply. is used. The associated
operators on exponential MGFs are:

164
III. PARAMETERS AND MULTIVARIATE GFS
Union:
A = B + C
=⇒
A(z) = B(z) + C(z)
Product:
A = B ⋆C
=⇒
A(z) = B(z) · C(z)
Sequence:
A = SEQ(B)
=⇒
A(z) =
1
1 −B(z)
Cycle:
A = CYC(B)
=⇒
A(z) = log
1
1 −B(z).
Set:
A = SET(B)
=⇒
A(z) = exp
 B(z)

.
PROOF. Disjoint unions are treated like in the unlabelled multivariate case. Labelled
products result from
A(z) =
X
α∈A
zχ(α)
|α|! =
X
β∈B,γ∈C
|β| + |γ|
|β|, |γ|
 zξ(β) zζ(γ)
(|β| + |γ|)!,
and the usual translation of binomial convolutions that reﬂect labellings by means of
products of exponential generating functions (like in the univariate case detailed in
Chapter II). The translation for composite constructions is then immediate.
□
This theorem can be exploited to determine moments, in a way that entirely par-
allels its unlabelled counterpart.
EXAMPLE III.8.
The proﬁle of permutations. Let P be the class of all permutations and χ
the number of components. Using the concept of marking, the speciﬁcation and the exponential
BGF are
P = SET (u CYC(Z))
=⇒
P(z, u) = exp
„
u log
1
1 −z
«
= (1 −z)−u,
as was already obtained by an ad hoc calculation in (5). We also know (page 149) that the mean
number of cycles is the harmonic number Hn and that the distribution is concentrated since the
standard deviation is much smaller than the mean.
Regarding the number χ of cycles of length r, the speciﬁcation and the exponential BGF
are now
(28)
P = SET (CYC̸=r(Z) + u CYC=r(Z))
=⇒
P(z, u) = exp
„
log
1
1 −z + (u −1)zr
r
«
= e(u−1)zr/r
1 −z
.
The EGF of cumulated values is then
(29)
Ω(z) = zr
r
1
1 −z .
The result is a remarkably simple one: In a random permutation of size n, the mean number
of r-cycles is equal to 1
r for any r ≤n.
Thus, the proﬁle of a random permutation, where proﬁle is deﬁned as the ordered sequence
of cycle lengths, departs signiﬁcantly from what has been encountered for integer compositions
and partitions. Formula (29) also sheds a new light on the harmonic number formula for the
mean number of cycles—each term 1
r in the harmonic number expresses the mean number of r
cycles.
Since formulæ are so simple, one can get more information. By (28) one has, as seen
above,
P{χ = k} =
1
k! rk [zn−kr]e−zr/r
1 −z ,

III. 4. INHERITED PARAMETERS AND EXPONENTIAL MGFS
165
FIGURE III.10. The proﬁle of permutations: a rendering of the cycle structure of six
random permutations of size 500, where circle areas are drawn in proportion to cycle
lengths. Permutations tend to have a few small cycles (of size O(1)), a few large ones (of
size Θ(n)), and altogether have Hn ∼log n cycles on average.
where the last factor counts permutations without cycles of length r. From this (and the asymp-
totics of generalized derangement numbers in Chapter IV), one proves easily that the asymptotic
law of the number of r-cycles is Poisson2 of rate 1
r; in particular it is not concentrated. (This in-
teresting property to be established in later chapters constitutes the starting point of an important
study by Shepp and Lloyd [436].)
Also, the mean number of cycles whose size is between n/2 and n is Hn −H⌊n/2⌋a
quantity that equals the probability of existence of such a long cycle and is approximately
log 2 .= 0.69314. In other words, we expect a random permutation of size n to have one
or a few large cycles. (See the paper [436] for the original discussion of largest and smallest
cycles.) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE III.8. □
 III.9. A hundred prisoners II. This is the solution to the prisoners’ problem of Note II.14,
p. 114 The better strategy goes as follows. Each prisoner will ﬁrst open the drawer which
corresponds to his number. If his number is not there, he’ll use the number he just found to
access another drawer, then ﬁnd a number there that points him to a third drawer, and so on,
hoping to return to his original drawer in at most 50 trials. (The last opened drawer will then
contain his number.) This strategy succeeds provided the initial permutation σ deﬁned by σi
being the number contained in drawer i has all its cycles of length at most 50. The probability
of the event is
p = [z100] exp
„z
1 + z2
2 + · · · + z50
50
«
= 1 −
100
X
j=51
1
j
.= 0.31182 78206.
Do the prisoners stand a chance against a malicious director who would not place the numbers
in drawers at random? For instance, the director might organize the numbers in a cyclic per-
mutation. [Hint: randomize the problem by renumbering the drawers according to a randomly
chosen permutation.]

EXAMPLE III.9. Allocations, balls-in-bins models, and the Poisson law. Random allocations
and the balls-in-bins model have been introduced in Chapter II in connection with the birthday
paradox and the coupon collector problem. Under this model, there are n balls thrown into
2 The Poisson distribution of rate λ > 0 is supported by the nonnegative integers and determined by
P{k} = e−λ λk
k! .

166
III. PARAMETERS AND MULTIVARIATE GFS
FIGURE III.11. Two random allocations with m = 12, n = 48. The rightmost dia-
grams display the bins sorted by decreasing order of occupancy.
m bins in all possible ways, the total number of allocations being thus mn. By the labelled
construction of words, the bivariate EGF with z marking the number of balls and u marking the
number χ(s) of bins that contain s balls (s a ﬁxed parameter) is given by
A = SEQm (SET̸=s(Z) + u SET=s(Z))
=⇒
A(s)(z, u) =
„
ez + (u −1)zs
s!
«m
.
In particular, the distribution of the number of empty bins (χ(0)) is expressible in terms of
Stirling partition numbers:
Pm,n(χ(0) = k) ≡n!
mn [ukzn]A(0)(z, u) = (m −k)!
mn
 
m
k
!(
n
m −k
)
.
By differentiation of the BGF, there results an exact expression for the mean (any s ≥0):
(30)
1
mEm,n(χ(s)) = 1
s!
„
1 −1
m
«n−s n(n −1) · · · (n −s + 1)
ms
.
Let m and n tend to inﬁnity in such a way that n
m = λ is a ﬁxed constant. This regime is ex-
tremely important in many applications, some of which are listed below. The average proportion
of bins containing s elements is
1
mEm,n(χ(s)), and from (30), one obtains by straightforward
calculations the asymptotic limit estimate,
(31)
lim
n/m=λ, n→∞
1
mEm,n(χ(s)) = e−λ λs
s! .
In other words, a Poisson formula describes the average proportion of bins of a given size in a
large random allocation. (Equivalently, the occupancy of a random bin in a random allocation
satisﬁes a Poisson law in the limit.)
The variance of each χ(s) (with ﬁxed s) is estimated similarly via a second derivative and
one ﬁnds:
Vm,n(χ(s)) ∼me−2λ λs
s! E(λ),
E(λ) :=
„
eλ −sλs−1
(s −1)! −(1 −2s)λs
s! −λs+1
s!
«
.
As a consequence, one has the convergence in probability,
1
mχ(s)
P
−→e−λ λs
s! ,
valid for any ﬁxed s ≥0. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE III.9. □

III. 4. INHERITED PARAMETERS AND EXPONENTIAL MGFS
167
 III.10. Hashing and random allocations. Random allocations of balls into bins are cen-
tral in the understanding of a class of important algorithms of computer science known as
hashing [208, 307, 433, 434, 486]: given a universe U of data, set up a function (called a hash-
ing function) h : U −→[1 . . m] and arrange for an array of m bins; an element x ∈U is
placed in bin number h(x). If the hash function scrambles the data in a way that is suitably
(pseudo)uniform, then the process of hashing a ﬁle of n records (keys, data items) into m bins
is adequately modelled by a random allocation scheme. If λ =
n
m, representing the “load”, is
kept reasonably bounded (say, λ ≤10), the previous analysis implies that hashing allows for
an almost direct access to data.

Number of components in abstract labelled schemas. Like in the unlabelled uni-
verse, a general formula gives the distribution of the number of components for the
basic constructions.
Proposition III.6. Consider labelled structures and the parameter χ equal to the
number of components in a construction A = K{B}, where K is one of SEQ, SET CYC.
The exponential BGF A(z, u) and the exponential GF Ω(z) of cumulated values are
given by the following table:
(32)
K
exp. MGF (A(z, u))
Cumul. EGF (Ω(z))
SEQ :
1
1 −uB(z)
A(z)2 · B(z) =
B(z)
(1 −B(z))2
SET :
exp (uB(z))
A(z) · B(z) = B(z)eB(z)
CYC :
log
1
1 −uB(z)
B(z)
1 −B(z).
Mean values are then easily recovered, and one ﬁnds
En(χ) = Ωn
An
= [zn]Ω(z)
[zn]A(z),
by the same formula as in the unlabelled case.
 III.11. r-Components in abstract labelled schemas. The BGF A(z, u) and the cumulative
EGF Ω(z) are given by the following table,
SEQ :
1
1 −
`
B(z) + (u −1) Brzr
r!
´
1
(1 −B(z))2 · Brzr
r!
SET :
exp
„
B(z) + (u −1)Brzr
r!
«
eB(z) · Brzr
r!
CYC :
log
1
1 −
`
B(z) + (u −1) Brzr
r!
´
1
(1 −B(z)) · Brzr
r!
,
in the labelled case.

EXAMPLE III.10. Set partitions. Set partitions S are sets of blocks, themselves nonempty sets
of elements. The enumeration of set partitions according to the number of blocks is then given
by
S = SET(u SET≥1(Z))
=⇒
S(z, u) = eu(ez−1).
Since set partitions are otherwise known to be enumerated by the Stirling partition numbers,
one has the BGF and the vertical EGFs as a corollary,
X
n,k
(
n
k
)
uk zn
n! = eu(ez−1),
X
n
(
n
k
)
zn
n! = 1
k!(ez −1)k,

168
III. PARAMETERS AND MULTIVARIATE GFS
which is consistent with earlier calculations of Chapter II.
The EGF of cumulated values, Ω(z) is then
Ω(z) = (ez −1)eez−1,
which is almost a derivative of S(z):
Ω(z) = d
dz S(z) −S(z).
Thus, the mean number of blocks in a random partition of size n is
Ωn
Sn = Sn+1
Sn
−1,
a quantity directly expressible in terms of Bell numbers. A delicate computation based on
the asymptotic expansion of the Bell numbers reveals that the expected value and the standard
deviation are asymptotic to (Chapter VIII)
n
log n,
√n
log n,
respectively. Similarly the exponential BGF of the number of blocks of size k is
S = SET(u SET=k(Z) + SET̸=0,k(Z))
=⇒
S(z, u) = eez−1+(u−1)zk/k!,
out of which mean and variance can be derived. . . . . . . . . . . . . . . END OF EXAMPLE III.10. □
EXAMPLE III.11. Root degree in Cayley trees. Consider the class T of Cayley trees (nonplane
labelled trees) and the parameter “root-degree”. The basic speciﬁcations are
8
<
:
T
=
Z ⋆SET(T )
T ◦
=
Z ⋆SET(uT )
=⇒
8
<
:
T(z)
=
zeT (z)
T(z, u)
=
zeuT (z).
The set construction reﬂects the non-planar character of Cayley trees and the speciﬁcation T ◦is
enriched by a mark associated to subtrees dangling from the root. Lagrange inversion provides
the fraction of trees with root degree k,
1
(k −1)!
n!
(n −1 −k)!
(n −1)n−2−k
nn−1
∼
e−1
(k −1)!,
k ≥1.
Similarly, the cumulative GF is found to be Ω(z) = T(z)2, so that the mean root degree satisﬁes
ETn(root degree) = 2
„
1 −1
n
«
∼2.
Thus the law of root degree is asymptotically a Poisson law of rate 1 (shifted by 1). Probabilistic
phenomena qualitatively similar to those encountered in plane trees are observed here as the
mean root degree is asymptotic to a constant. However a Poisson law eventually reﬂecting the
nonplanarity condition replaces the modiﬁed geometric law (known as a negative binomial law)
present in plane trees. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE III.11. □
 III.12. Numbers of components in alignments. Alignments (O) are sequences of cycles
(Chapter II). The expected number of components in a random alignment of On is
[zn] log(1 −z)−1(1 −log(1 −z)−1)−2
[zn](1 −log(1 −z)−1)−1
.
Methods of Chapter V imply that the number of components in a random alignment has expec-
tation ∼n/(e −1) and standard deviation Θ(√n).


III. 4. INHERITED PARAMETERS AND EXPONENTIAL MGFS
169
Unlabelled structures
Integer partitions, MSET ◦SEQ
exp
„
u
z
1 −z + u2
2
z2
1 −z2 + · · ·
«
∼
√n log n
π
p
2/3
,
Θ(√n)
Integer compositions, SEQ ◦SEQ
„
1 −u
z
1 −z
«−1
∼n
2 ,
Θ(√n)
Labelled structures
Set partitions, SET ◦SET
exp (u (ez −1))
∼
n
log n
∼
√n
log n
Surjections, SEQ ◦SET
(1 −u (ez −1))−1
∼
n
2 log 2,
Θ(√n)
Permutations, SET ◦CYC
exp
`
u log(1 −z)−1´
∼log n,
∼√log n
Alignments, SEQ ◦CYC
`
1 −u log(1 −z)−1´−1
∼
n
e −1,
Θ(√n)
FIGURE III.12. Major properties of the number of components in six level-two struc-
tures. For each class, from top to bottom: (i) speciﬁcation type; (ii) BGF; (iii) mean and
variance of the number of components.
 III.13. Image cardinality of a random surjection. The expected cardinality of the image of a
random surjection in Rn (see Chapter II) is
[zn]ez(2 −ez)−2
[zn](2 −ez)−1 .
The number of values whose preimages have cardinality k is obtained by replacing the single
exponential factor ez by zk/k!. Methods of Chapters IV and V imply that the image cardinality
of a random surjection has expectation n/(2 log 2) and standard deviation Θ(√n).

 III.14. Distinct component sizes in set partitions. Take the number of distinct block sizes
and cycle sizes in set partitions and permutations. The bivariate EGFs are
∞
Y
n=1
“
1 −u + uezn/n!”
,
∞
Y
n=1
“
1 −u + uezn/n”
,
as follows from ﬁrst principles.

Postscript: Towards a theory of schemas. Let us look back and recapitulate
some of the information gathered in pages 156—169 regarding the number of compo-
nents in composite structures. The classes considered in the table below are composi-
tions of two constructions, either in the unlabelled or the labelled universe. Each entry
contains the BGF for the number of components (e.g., cycles in permutations, parts
in integer partitions, and so on), and the asymptotic orders of the mean and standard
deviation of the number of components for objects of size n.
Some obvious facts stand out from the data and call for explanation. First the
outer construction appears to play the essential rˆole: outer sequence constructs (cf

170
III. PARAMETERS AND MULTIVARIATE GFS
integer compositions, surjections and alignments) tend to dictate a number of compo-
nents that is Θ(n) on average, while outer set constructs (cf integer partitions, set par-
titions, and permutations) are associated with a greater variety of asymptotic regimes.
Eventually, such facts can be organized into broad analytic schemas, as will be seen
in Chapters IV–IX.
 III.15. Singularity and probability. The differences in behaviour are to be assigned to the
rather different types of singularity involved: on the one hand sets corresponding algebraically
to an exp(·) operator induce an exponential blow up of singularities; on the other hand se-
quences expressed algebraically by quasi-inverses (1 −·)−1 are likely to induce polar singu-
larities. Recursive structures like trees lead to yet other types of phenomena with a number of
components, i.e., the root degree, that is bounded in probability.

III. 5. Recursive parameters
In this section, we adapt the general methodology of previous sections in order to
treat parameters that are deﬁned by recursive rules over structures that are themselves
recursively speciﬁed. Typical applications concern trees and tree-like structures.
Regarding the number of leaves, or more generally, the number of nodes of some
ﬁxed degree, in a tree, the method of placing marks applies like in the non-recursive
case. It sufﬁces to distinguish elements of interest and mark them by an auxiliary
variable. For instance, in order to mark composite objects made of r components,
where r is an integer and K designates any of SEQ, SET (or MSET, PSET), CYC, one
should split a construction K(C) according to the identity
K(C) = K=r(C) + K̸=r(C),
then introduce a mark (u) in front of the ﬁrst term of the sum. This technique gives
rise to speciﬁcations decorated by marks to which Theorems III.1 and III.2 apply. For
a recursively deﬁned structure, the outcome is a functional equation deﬁning the BGF
recursively. This technique is illustrated by Examples 12 and 13 below in the case of
Catalan trees and the parameter number of leaves.
EXAMPLE III.12.
Leaves in general Catalan trees.
How many leaves does a random
tree of some variety have? Can different varieties of trees be somehow distinguished by the
proportion of their leaves? Beyond the botany of combinatorics, such considerations are for
instance relevant to the analysis of algorithms since tree leaves, having no descendants, can be
stored more economically; see [306, Sec. 2.3] for an algorithmic motivation for such questions.
Consider once more the class G of plane unlabelled trees, G = Z × SEQ(G), enumerated
by the Catalan numbers: Gn = 1
n
`2n−2
n−1
´
. The class G◦where each leaf is marked is
G◦= Zu + Z × SEQ≥1(G◦)
=⇒
G(z, u) = zu +
zG(z, u)
1 −G(z, u).
The induced quadratic equation can be solved explicitly
G(z, u) = 1
2
“
1 + (u −1)z −
p
1 −2(u + 1)z + (u −1)2z2
”
.

III. 5. RECURSIVE PARAMETERS
171
It is however simpler to expand using the Lagrange inversion theorem which provides
Gn,k
=
[uk] ([zn]G(z, u)) = [uk]
„ 1
n[yn−1]
„
u +
y
1 −y
«n«
=
1
n
 
n
k
!
[yn−1]
yn−k
(1 −y)n−k = 1
n
 
n
k
! 
n −2
k −1
!
.
These numbers are known as Narayana numbers, see EIS A001263, and they surface repeatedly
in connexion with ballot problems. The mean number of leaves derives from the cumulative
GF, which is
Ω(z) = ∂uG(z, u)|u=1 = 1
2 z + 1
2
z
√1 −4z ,
so that the mean is n/2 exactly for n ≥2. The distribution is concentrated since the standard
deviation is easily calculated to be O(√n). . . . . . . . . . . . . . . . . . . END OF EXAMPLE III.12. □
EXAMPLE III.13.
Leaves and node types in binary trees. The class B of binary plane trees,
also enumerated by Catalan numbers (Bn =
1
n+1
`2n
n
´
) can be speciﬁed as
(33)
B = Z + (B × Z) + (Z × B) + (B × Z × B),
which stresses the distinction between four types of nodes: leaves, left branching, right branch-
ing, and binary. Let u0, u1, u2 be variables that mark nodes of degree 0,1,2, respectively. Then
the root decomposition (33) provides for the MGF B = B(z, u0, u1, u2) the functional equa-
tion
B = zu0 + 2zu1B + zu2B2,
which, by Lagrange inversion, gives
Bn,k0,k1,k2 = 2k1
n
 
n
k0, k1, k2
!
,
subject to the natural conditions: k0 + k1 + k2 = n and k0 = k2 + 1. Specializations and
moments can be easily calculated from such an approach [404]. In particular, the mean number
of nodes of each type is asymptotically:
leaves: ∼n
4 ,
1-nodes : ∼n
2 ,
2-nodes : ∼n
4 .
There is an equal asymptotic proportion of leaves, double nodes, left branching, and right
branching nodes. Also, the standard deviation is in each case O(√n), so that each of the
corresponding distributions is concentrated. . . . . . . . . . . . . . . . . . . END OF EXAMPLE III.13. □
 III.16. Leaves and node-degree proﬁle in Cayley trees. For Cayley trees, the bivariate EGF
with u marking the number of leaves is the solution to
T(z, u) = uz + z(eT (z,u) −1).
The distribution is expressed in terms of Stirling partition numbers. The mean number of leaves
in a random Cayley tree is asymptotic to ne−1.
More generally, the mean number of nodes of outdegree k in a random Cayley tree of
size n is asymptotic to
n · e−1 1
k!.
Degrees of nodes are thus approximately given by a Poisson law of rate 1.


172
III. PARAMETERS AND MULTIVARIATE GFS
 III.17. Node-degree proﬁle in simple varieties of trees. For a family of trees generated
by T(z) = zφ(T(z)) with φ a power series, the BGF of the number of nodes of degree k
satisﬁes
T(z, u) = z
“
φ(T(z, u)) + φk(u −1)T(z, u)k”
,
where φk = [uk]φ(u). The cumulative GF is
Ω(z) = z
φkT(z)k
1 −zφ′(T(z)) = φkz2T(z)k−1T ′(z),
from which expectations can be determined.

 III.18. Marking in functional graphs. Consider the class F of ﬁnite mappings discussed in
Chapter II:
F = SET(K),
K = CYC(T ),
T = Z ⋆SET(T ).
The translation into EGFs is
F(z) = eK(z),
K(z) = log
1
1 −T(z),
T(z) = zeT (z).
Here are bivariate EGFs for (i) the number of components, (ii) the number of maximal trees,
(iii) the number of leaves:
(i) euK(z),
(ii)
1
1 −uT(z),
(iii)
1
1 −T(z, u)
with
T(z, u) = (u −1)z + zeT (z,u).
The trivariate EGF F(u1, u2, z) of functional graphs with u1 marking components and u2
marking trees is
F(z, u1, u2) = exp(u1 log(1 −u2T(z))−1) =
1
(1 −u2T(z))u1 .
An explicit expression for the coefﬁcients involves the Stirling cycle numbers.

We shall stop here these examples that could be multiplied ad libitum since such
calculations greatly simplify when interpreted in the light of asymptotic analysis. The
phenomena observed asymptotically are, for good reasons, especially close to what
the classical theory of branching processes provides (see the book by Harris [262]).
Linear transformations on parameters and path length in trees. We have so far
been dealing with a parameter deﬁned directly by recursion. Next, we turn to other pa-
rameters such as path length. As a preamble, one needs a simple linear transformation
on combinatorial parameters. Let A be a class equipped with two scalar parameters,
χ and ξ, related by
χ(α) = |α| + ξ(α).
Then, the combinatorial form of BGFs yields
X
α∈A
z|α|uχ(α) =
X
α∈A
z|α|u|α|+ξ(α) =
X
α∈A
(zu)|α|uξ(α),
that is,
(34)
Aχ(z, u) = Aξ(zu, u).
This is clearly a general mechanism:

III. 5. RECURSIVE PARAMETERS
173
Linear transformations and MGFs: A linear transformation on param-
eters induces a monomial substitution on the corresponding marking vari-
ables in MGFs.
We now put this mechanism to use in the recursive analysis of path length in trees.
EXAMPLE III.14. Path length in trees. The path length of a tree is deﬁned as the sum of
distances of all nodes to the root of the tree, where distances are measured by the number
of edges on the minimal connecting path of a node to the root. Path length is an important
characteristic of trees. For instance, when a tree is used as a data structure with nodes containing
additional information, path length represents the total cost of accessing all data items when a
search is started from the root. For this reason, path length surfaces, under various models, in
the analysis of algorithms like algorithms and data structures for searching and sorting (e.g.,
tree-sort, quicksort, radix-sort); see [306, 434].
The deﬁnition of path length as
λ(τ) :=
X
ν∈τ
dist(ν, root(τ)),
transforms into an inductive deﬁnition:
(35)
λ(τ) =
X
υ root subtree of τ
(λ(υ) + |υ|) .
To establish this identity, distribute nodes in their corresponding subtrees; correct distances to
the subtree roots by 1, and regroup terms.
From this point on, we specialize the discussion to general Catalan trees (see Note 19 for
other cases): G = Z × SEQ(G). Introduce momentarily the parameter µ(τ) = |τ| + λ(τ).
Then, one has from the inductive deﬁnition (35) and the general transformation rule (34):
(36)
Gλ(z, u) =
z
1 −Gµ(z, u)
and
Gµ(z, u) = Gλ(zu, u).
In other words, G(z, u) ≡Gλ(z, u) satisﬁes a nonlinear functional equation of the difference
type:
G(z, u) =
z
1 −G(uz, u).
(This functional equation will be encountered again in connection with area under Dyck paths:
see Chapter V, p. 307.) The generating function Ω(z) of cumulated values of λ then obtains
by differentiation with respect to u upon setting u = 1. We ﬁnd in this way that Ω(z) :=
∂uG(z, u)|u=1 satisﬁes
Ω(z) =
z
(1 −G(z))2
`
zG′(z) + Ω(z)
´
,
which is a linear equation that solves to
Ω(z) = z2
G′(z)
(1 −G(z))2 −z =
z
2(1 −4z) −
z
2√1 −4z .
Consequently, one has (n ≥1)
Ωn = 22n−3 −1
2
 
2n −2
n −1
!
,
where the sequence starting 1, 5, 22, 93, 386 for n ≥2 constitutes EIS A000346. By an
elementary asymptotic analysis, we get:

174
III. PARAMETERS AND MULTIVARIATE GFS
FIGURE III.13. A random pruned binary tree of size 256 and its associated level proﬁle:
the histogram on the left displays the number of nodes at each level in the tree.
The mean path length of a random Catalan tree of size n is asymptotic to
1
2
√
πn3; in short: a branch from the root to a random node in a random
Catalan tree of size n has expected length of the order of √n.
Random Catalan trees thus tend to be somewhat imbalanced—by comparison, a fully balanced
binary tree has all paths of length at most log2 n + O(1). . . . . . END OF EXAMPLE III.14. □
The imbalance in random Catalan trees is a general phenomenon—it holds for
binary Catalan and more generally for all simple varieties of trees. Note 19 below and
Example VII.9 (p. 442) imply that path length is invariably of order n√n on average
in such cases. Height is of typical order √n as shown by R´enyi and Szekeres [409], de
Bruijn, Knuth and Rice [113], Kolchin [314], as well as Flajolet and Odlyzko [197].
Figure 13 borrowed from [434] illustrates this on a simulation. (The contour of the
histogram of nodes by levels, once normalized, has been proved to converge to the
process known as Brownian excursion.)
 III.19. Path length in simple varieties of trees. The BGF of path length in a variety of trees
generated by T(z) = zφ(T(z)) satisﬁes
T(z, u) = zφ(T(zu, u)).
In particular, the cumulative GF is
Ω(z) ≡∂u (T(z, u))u=1 = φ′(T(z))
φ(T(z)) (zT ′(z))2,
from which coefﬁcients can be extracted.

III. 6. Complete generating functions and discrete models
By a complete generating function, we mean, loosely speaking, a generating func-
tion in a (possibly large, and even inﬁnite in the limit) number of variables that mark a

III. 6. COMPLETE GENERATING FUNCTIONS AND DISCRETE MODELS
175
homogeneous collection of characteristics of a combinatorial class3. For instance one
may be interested in the joint distribution of all the different letters composing words,
the number of cycles of all lengths in permutations, and so on. A complete MGF
naturally entails very detailed knowledge on the enumerative properties of structures
to which it is relative. Complete generating functions, given their expressive power,
also make weighted models accessible to calculation, a situation that covers in partic-
ular Bernoulli trials (p. 179) and branching processes from classical probability theory
(p. 185).
Complete GFs for words. As a basic example, consider the class of all words
W = SEQ{A} over some ﬁnite alphabet A = {a1, . . . , ar}. Let χ = (χ1, . . . , χr),
where χj(w) is the number of occurrences of the letter aj in word w. The MGF of A
with respect to χ is
A = u1a1 + u2a2 + · · · urar
=⇒
A(z, u) = zu1 + zu2 + · · · + zur,
and χ on W is clearly inherited from χ on A. Thus, by the sequence rule, one has
(37)
W = SEQ(A)
=⇒
W(z, u) =
1
1 −z(u1 + u2 + · · · + ur),
which describes all words according to their compositions into letters. In particular,
the number of words with nj occurrences of letter aj and n = P nj is in this frame-
work obtained as
[un1
1 un2
2 · · · unr
r ] (u1 + u2 + · · · + ur)n =

n
n1, n2, . . . , nr

=
n!
n1!n2! · · · nr
.
We are back to the usual multinomial coefﬁcients.
 III.20. After Bhaskara Acharya (circa 1150AD). Consider all the numbers formed in decimal
with digit 1 used once, with digit 2 used twice,. . . , with digit 9 used nine times. Such numbers
all have 45 digits. Compute their sum S and discover, much to your amazement that S equals
45875559600006153219084769286399999999999999954124440399993846780915230713600000.
This number has a long run of nines (and further nines are hidden!). Is there a simple explana-
tion? This exercise is inspired by the Indian mathematician Bhaskara Acharya who discovered
multinomial coefﬁcients near 1150AD; see [306, p. 23–24] for a brief historical note.

Complete GFs for permutations and set partitions. Consider permutations and
the various lengths of their cycles. The MGF where uk marks cycles of length k for
k = 1, 2, . . . can be written as an MGF in inﬁnitely many variables:
(38)
P(z, u) = exp

u1
z
1 + u2
z2
2 + u3
z3
3 + · · ·

.
This MGF expression has the neat feature that, upon specializing all but a ﬁnite num-
ber of uj to 1, we derive all the particular cases of interest with respect to any ﬁnite
collection of cycles lengths. Observe also that one can calculate in the usual way any
coefﬁcient [zn]P as it only involves the variables u1, . . . , un.
3Complete GFs are not new objects. They are simply an avatar of multivariate GFs. Thus the term is
only meant to be suggestive of a particular usage of MGFs, and essentially no new theory is needed in order
to cope with them.

176
III. PARAMETERS AND MULTIVARIATE GFS
 III.21. The theory of formal power series in inﬁnitely many variables. (This note is for
formalists.) Mathematically, an object like P in (38) is perfectly well deﬁned. Let U =
{u1, u2, . . .} be an inﬁnite collection of indeterminates. First, the ring of polynomials R =
C[U] is well deﬁned and a given element of R involves only ﬁnitely many indeterminates.
Then, from R, one can deﬁne the ring of formal power series in z, namely R[[z]]. (Note that,
if f ∈R[[z]], then each [zn]f involves only ﬁnitely many of the variables uj.) The basic op-
erations and the notion of convergence, as described in APPENDIX A: Formal power series,
p. 676, apply in a standard way.
For instance, in the case of (38), the complete GF P(z, u) is obtainable as the formal limit
P(z, u) = lim
k→∞exp
„
u1 z
1 + · · · + uk zk
k + zk+1
k + 1 + · · ·
«
in R[[z]] equipped with the formal topology. (In contrast, the quantity evocative of a generating
function of words over an inﬁnite alphabet
W
!=
 
1 −z
∞
X
j=1
uj
!−1
cannot receive a sound deﬁnition as a element of the formal domain R[[z]].)

Henceforth, we shall keep in mind that veriﬁcations of formal correctness regard-
ing power series in inﬁnitely many indeterminates are always possible by returning to
basic deﬁnitions.
Complete generating functions are often surprisingly simple to expand. For in-
stance, the equivalent form of (38)
P(z, u) = eu1z/1 · eu2z2/2 · eu3z3/3 · · ·
implies immediately that the number of permutations with k1 cycles of size 1, k2 of
size 2, and so on, is
(39)
n!
k1! k2! · · · kn! 1k1 2k2 · · · nkn ,
provided P jkj = n. This is a result originally due to Cauchy. Similarly, the EGF of
set partitions with uj marking the number of blocks of size j is
S(z, u) = exp

u1
z
1! + u2
z2
2! + u3
z3
3! + · · ·

.
A formula analogous to (39) follows: the number of partitions with k1 blocks of size
1, k2 of size 2, and so on, is
n!
k1! k2! · · · kn! 1!k1 2!k2 · · · n!kn .
Several examples of such complete generating functions are presented in Comtet’s
book; see [98], pages 225 and 233.
 III.22. Complete GFs for compositions and surjections.
The complete GFs of integer
compositions and surjections with uj marking the number of components of size j are
1
1 −P∞
j=1 ujzj ,
1
1 −P∞
j=1 uj zj
j!
.

III. 6. COMPLETE GENERATING FUNCTIONS AND DISCRETE MODELS
177
The associated counts with n = P
j jkj are given by
 
k1 + k2 + · · ·
k1, k2, . . .
!
,
n!
1!k12!k2 · · ·
 
k1 + k2 + · · ·
k1, k2, . . .
!
.
These factored forms derive directly from the multinomial expansion. The symbolic form of
the multinomial expansion of powers of a generating function is sometimes expressed in terms
of Bell polynomials, themselves nothing but a rephrasing of the multinomial expansion; see
Comtet’s book [98, Sec. 3.3] for a fair treatment of such polynomials.

 III.23. Fa`a di Bruno’s formula. The formulæ for the successive derivatives of a functional
composition h(z) = f(g(z))
∂zh(z) = f ′(g(z))g′(z),
∂2
zh(z) = f ′′(g(z))g′(z)2 + f ′(z)g′′(z), . . . ,
are clearly equivalent to the expansion of a formal power series composition. Indeed, assume
without loss of generality that z = 0 and g(0) = 0; set fn := ∂n
z f(0), and similarly for g, h.
Then:
h(z) ≡
X
n
hn zn
n! =
X
k
fk
k!
“
g1z + g2
2! z2 + · · ·
”k
.
Thus in one direct application of the multinomial expansion, one ﬁnds
hn
n! =
X
k
fk
k!
X
C
 
k
ℓ1, ℓ2, . . . , ℓk
! “g1
1!
”ℓ1 “g2
2!
”ℓ2 · · ·
“gk
k!
”ℓk
where the summation condition C is: 1ℓ1 + 2ℓ2 + · · · + kℓk = n, ℓ1 + ℓ2 + · · · + ℓk = k.
This shallow identity is known as Fa`a di Bruno’s formula [98, p. 137]. (Fa`a di Bruno (1825–
1888) was canonized by the Catholic Church in 1988, presumably for reasons not related to his
formula.)

 III.24. Relations between symmetric functions. Symmetric functions may be manipulated
by mechanisms that are often reminiscent of the set and multiset construction. They appear
in many areas of combinatorial enumeration. Let X = {xi}r
i=1 be a collection of formal
variables. Deﬁne the symmetric functions
Y
i
(1 + xiz) =
X
n
anzn,
Y
i
1
1 −xiz =
X
n
bnzn,
X
i
xiz
1 −xiz =
X
n
cnzn.
The an, bn, cn, called resp. elementary, monomial, and power symmetric functions are express-
ible as
an =
X
i1<i2<···<ir
xi1xi2 · · · xir,
bn =
X
i1≤i2≤···≤ir
xi1xi2 · · · xir,
cn =
r
X
i=1
xr
i .
The following relations hold for the OGFs A(z), B(z), C(z) of an, bn, cn::
B(z)
=
1
A(−z),
A(z)
=
1
B(−z),
C(z)
=
z d
dz log B(z),
B(z)
=
exp
Z z
0
C(t) dt
t .
Consequently, each of an, bn, cn is polynomially expressible in terms of any of the other quan-
tities. (The connection coefﬁcients, like in Note 23, involve multinomials.)

 III.25. Regular graphs. A graph is r–regular iff each node has degree exactly equal to r.
The number of r–regular graphs of size n is
[xr
1xr
2 · · · xr
n]
Y
1≤i<j≤n
(1 + xixj).
[Gessel [234] has shown how to extract explicit expressions from such huge symmetric func-
tions.]


178
III. PARAMETERS AND MULTIVARIATE GFS
III. 6.1. Word models. The enumeration of words constitutes a rich chapter of
combinatorial analysis, and complete GFs serve to generalize many results to the case
of nonuniform letter probabilities, like the coupon collector problem and the birthday
paradox considered in Chapter II. Applications are to be found in classical probability
theory and statistics [108] (the so-called Bernoulli trial models), as well as in computer
science [458] and mathematical models of biology [491].
EXAMPLE III.15.
Words and records. Fix an alphabet A = {a1, . . . , ar} and let W =
SEQ{A} be the class of all words over A, where A is naturally ordered by a1 < a2 < · · · < ar.
Given a word w = w1 · · · wn, a (strict) record is an element wj that is larger than all preceding
elements: wj > wi for all i < j. (Refer to Figure 13 of Chapter II for a graphical rendering of
records in the case of permutations.)
Consider ﬁrst the subset of W comprising all words that have the letters ai1, . . . , aik as
successive records, where i1 < · · · < ik. The symbolic description of this set is in the form of
a product of k terms
(40)
„
ai1 SEQ(a1 + · · · + ai1)
«
· · ·
„
aik SEQ(a1 + · · · + aik)
«
.
Consider now MGFs of words where z marks length, v marks the number of records, and each
uj marks the number of occurrences of letter aj. The MGF associated to the subset described
in (40) is then
„
zvui1(1 −z(u1 + · · · + ui1))−1
«
· · ·
„
zvuik(1 −z(u1 + · · · + uik))−1
«
.
Summing over all values of k and of i1 < · · · < ik gives
(41)
W (z, v, u) =
r
Y
s=1
`
1 + zvus (1 −z(u1 + · · · + us))−1´
,
the rationale being that, for arbitrary quantities ys, one has by distributivity:
r
X
k=0
X
1≤i1<···<ik≤r
yi1yi2 · · · yik =
r
Y
s=1
(1 + ys).
We shall encounter more applications of (41) below. For the time being let us simply
examine the mean number of records in a word of length n over the alphabet A, when all such
words are taken equally likely. One should set uj 7→1 (the composition into speciﬁc letters is
forgotten), so that W assumes the simpler form
W (z, v) =
r
Y
j=1
„
1 +
vz
1 −jz
«
.
Logarithmic differentiation then gives access to the generating function of cumulated values,
Ω(z) ≡
∂
∂v W (z, v)
˛˛˛˛
v=1
=
z
1 −rz
r
X
j=1
1
1 −(j −1)z .
Thus, by partial fraction expansion, the mean number of records in Wn (whose cardinality
is rn) has the exact value
(42)
EWn(# records) = Hr −
r−1
X
j=1
(j/r)n
r −j .

III. 6. COMPLETE GENERATING FUNCTIONS AND DISCRETE MODELS
179
There appears the harmonic number Hr, like in the permutation case, but now with a negative
correction term which, for ﬁxed r, vanishes exponentially fast with n (this betrays the fact that
some letters from the alphabet might be missing). . . . . . . . . . . . . END OF EXAMPLE III.15. □
EXAMPLE III.16.
Weighted word models and Bernoulli trials. Let A = {a1, . . . , ar} be an
alphabet of cardinality r, and let Λ = {λ1, . . . , λr} be a system of numbers called weights,
where weight λj is viewed as attached to letter aj. Weights may be extended from letters to
words multiplicatively by deﬁning the weight π(w) of word w as
π(w)
=
λi1λi2 · · · λin
if
w = ai1ai2 · · · ain
=
r
Y
j=1
λ
χj(w)
j
,
where χj(w) is the number of occurrences of letter aj in w. Finally, the weight of a set is by
deﬁnition the sum of the weights of its elements.
Combinatorially, weights of sets are immediately obtained once the corresponding gener-
ating function is known. Indeed, let S ⊆W = SEQ{A} have complete GF
S(z, u1, . . . , ur) =
X
w∈S
z|w|uχ1(w)
1
· · · uχr(w)
r
,
where χj(w) is the number of occurrences of letter aj in w. Then one has
S(z, λ1, . . . , λr) =
X
w∈S
z|w|π(w),
so that extracting the coefﬁcient of zn gives the total weight of Sn = S ∩Wn under the weight
system Λ. In other words, the GF of a weighted set is obtained by substitution of the numerical
values of the weights inside the associated complete MGF.
In probability theory, Bernoulli trials refer to sequences of independent draws from a ﬁxed
distribution with ﬁnitely many possible values. One may think of the succession of ﬂippings of
a coin or castings of a die. If any trial has r possible outcomes, then the various possibilities
can be described by letters of the r-ary alphabet A. If the probability of the jth outcome is
taken to be λj, then the Λ-weighted models on words becomes the usual probabilistic model
of independent trials. (In this situation, the λj’s are often written as pj’s.) Observe that, in the
probabilistic situation, one must have λ1 + · · · + λr = 1 with each λj satisfying 0 ≤λj ≤1.
The equiprobable case, where each outcome has probability 1/r can be obtained by setting
λj = 1/r and it then becomes equivalent to the usual enumerative model. In terms of GFs,
the coefﬁcient [zn]S(z, λ1, . . . , λr) then represents the probability that a random word of Wn
belongs to S. Multivariate generating functions and cumulative generating functions then obey
properties similar to their usual (ordinary, exponential) counterparts.
As an illustration, assume one has a biased coin with probability p for heads (H) and q =
1−p for tails (T). Consider the event: “in n tosses of the coin, there never appear ℓcontiguous
heads”. The alphabet is A = {H, T }. The construction describing the events of interest is, as
seen in Chapter I,
S = SEQ<ℓ{H} SEQ{T SEQ<ℓ{H}}.
Its GF with u marking heads and v marking tails is then
W (z, u, v) = 1 −zℓuℓ
1 −zu
„
1 −zv 1 −zℓuℓ
1 −zu
«−1
.

180
III. PARAMETERS AND MULTIVARIATE GFS
Thus, the probability of the absence of ℓ-runs amongst a sequence of n random coin tosses is
obtained after the substitution u →p, v →q in the MGF,
[zn]
1 −pℓzℓ
1 −z + qpℓzℓ+1 ,
leading to an expression which is amenable to numerical or asymptotic analysis.
Feller’s
book [162, p. 322–326] offers for instance a classical discussion of the problem. END OF EXAMPLE III.16. □
EXAMPLE III.17.
Records in Bernoulli trials. To conclude the discussion of probabilistic
models on words, we come back to the analysis of records. Assume now that the alphabet
A = {a1, . . . , ar} has in all generality the probability pj associated with the letter aj. The
mean number of records is analysed by a process entirely parallel to the derivation of (42): one
ﬁnds by logarithmic differentiation of (41)
(43)
EWn(# records) = [zn]Ω(z)
where
Ω(z) =
z
1 −z
r
X
j=1
pj
1 −z(p1 + · · · + pj−1).
The cumulative GF Ω(z) in (43) has simple poles at the points 1, 1/Pr−1, 1/Pr−2, and so on,
where Ps = p1 + · · · + ps. For asymptotic purposes, only the dominant poles at z = 1 counts
(see Chapter IV for a systematic discussion), near which
Ω(z) ∼
z→1
1
1 −z
r
X
j=1
pj
1 −Pj−1 .
Consequently, one has an elegant asymptotic formula generalizing the case of permutations that
has a harmonic mean (10):
The mean number of records in a random word of length n with nonuni-
form letter probabilities pj satisﬁes asymptotically (n →+∞)
EWn(# records) ∼
r
X
j=1
pj
pj + pj+1 + · · · + pr .
This relation and similar ones were obtained by Burge [74]; analogous ideas may serve to ana-
lyse the sorting algorithm Quicksort under equal keys [432] as well as the hybrid data structures
of Bentley and Sedgewick; see [38, 93]. . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE III.17. □
Coupon collector problem and birthday paradox. Similar considerations apply
to weighted EGFs of words, as considered in Chapter II. For instance, the probability
of having attained a complete coupon collection at time n in case a company issues
coupon j with probability pj, for 1 ≤j ≤r, is (coupon collector problem, Chapter II)
P(C ≤n) = n![zn]
r
Y
j=1
(epjz −1) .
The probability that all coupons are different at time n is (birthday paradox, Chap-
ter II)
P(B > n) = n![zn]
r
Y
j=1
(1 + pjz) ,

III. 6. COMPLETE GENERATING FUNCTIONS AND DISCRETE MODELS
181
which corresponds to the birthday problem in the case of nonuniform mating periods.
Integral representations comparable to the ones of Chapter II are also available:
E(C) =
Z ∞
0

1 −
r
Y
j=1
(1 −e−pit)

dt,
E(B) =
Z ∞
0
r
Y
j=1
(1 + pjt) e−t dt.
See the study by Flajolet, Gardy, and Thimonier [181] for several variations on this
theme.
 III.26. Birthday paradox with leap years. Assume that the 29th of February exists precisely
once every fourth year. Estimate the effect on the expectation of the ﬁrst birthday collision. 
EXAMPLE III.18.
Rises in Bernoulli trials: Simon Newcomb’s problem. Simon Newcomb
(1835–1909), otherwise famous for his astronomical work, was reportedly fond of playing the
following patience game: one draws from a deck of 52 playing cards, stacking them in piles in
such a way that one new pile is started each time a card appears whose number is smaller than
its predecessor. What is the probability of obtaining t piles? A solution to this famous problem
is found in MacMahon’s book [350] and a concise account by Andrews appears in [10, §4.4].
Simon Newcomb’s problem can be rephrased in terms of rises.
Given a word w =
w1 · · · wn over the alphabet A ordered by a1 < a2 < · · · , a weak rise is a position j < n
such that wj ≤wj+1. (The numbers of piles in Newcomb’s problem is the number of cards
minus 1 minus the number of rises.) Let W (z, v, u) be the MGF of all words where z marks
length, v marks the number of weak rises, and uj marks the number of occurrences of letter j.
Set zj = zuj and let Wj(z, v, u) be the MGF relative to those nonempty words that start with
letter aj, so that
W = 1 + (W1 + · · · + Wr).
The Wj satisfy the set of equations (j = 1, . . . , r),
(44)
Wj = zj + zj (W1 + · · · + Wj−1) + vzj (Wj + · · · + Wr) ,
as seen by considering the ﬁrst letter of each word. The linear system (44) is easily solved upon
setting Wj = zjXj. Indeed, by differencing, one ﬁnds that
(45)
Xj+1 −Xj = zjXj(1 −v),
Xj+1 = Xj(1 + zj(1 −v)),
In this way, each Xj can be determined in terms of X1. Then transporting the resulting expres-
sions into the relation (44) instantiated at j = 1, and solving for X1 leads to an expression for
X1, hence for all the Xj and ﬁnally for W itself:
(46)
W =
v −1
v −P −1 ,
P :=
r
Y
j=1
(1 + (1 −v)zj).
Goulden and Jackson provide a similar looking expressions in [244] (pp. 72 and 236).
The result of (46) gives access to moments (e.g., mean and variance) of the number of
rises in a Bernoulli sequence as well as to counting results, once coefﬁcients of the MGF are
extracted. (See also [234, 244] for some of the possible tools from the theory of symmetric
functions.) The OGF (46) can alternatively be derived by an inclusion-exclusion argument:
refer to the particular case of rises in permutations and Eulerian numbers which is discussed
below. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE III.18. □

182
III. PARAMETERS AND MULTIVARIATE GFS
 III.27. The ﬁnal solution to Simon Newcomb’s problem. Consider a deck of cards with a
suits and r distinct card values. Set N = ra. (The original problem has r = 13, a = 4,
N = 52.) One has from (46): W = (v −1)P/(1 −vP). The expansion of (1 −y)−1 and the
collection of coefﬁcients yields
[za
1 · · · za
r ]W = (1 −v)
X
k≥1
vk−1[za
1 · · · za
r]P k = (1 −v)N+1 X
k≥1
 
k
a
!r
vk−1,
so that [za
1 · · · za
rvt]W =
t+1
X
k=0
(−1)t+1−k
 
N + 1
t + 1 −k
! 
k
a
!r
.

III. 6.2. Tree models. We examine here two important GFs associated with tree
models; these provide valuable information concerning the degree proﬁle and the level
proﬁle of trees, while being tightly coupled with an important class of stochastic pro-
cesses, namely the branching processes.
The major classes of trees that we have encountered so far are the unlabelled
plane trees and the labelled nonplane trees, prototypes being the general Catalan trees
(Chapter I) and the Cayley trees (Chapter II). In both cases, the counting generating
functions satisfy a relation of the form
(47)
Y (z) = zφ(Y (z)),
where the GF is either ordinary (plane unlabelled trees) or exponential (nonplane la-
belled trees). Corresponding respectively to the two cases, the function φ is deter-
mined by
(48)
φ(w) =
X
ω∈Ω
wω,
φ(w) =
X
ω∈Ω
wω
ω! ,
where Ω⊆N is the set of allowed node degrees. Meir and Moon in an important pa-
per [356] have described some common properties of tree families that are determined
by the Axiom (47). (For instance mean path length is invariably of order n√n, see
Chapter VII, and height is O(√n).) Following these authors, we call simple variety of
trees any class whose counting GF is deﬁned by an equation of type (47).
For each
of the two cases of (48), we write
(49)
φ(w) =
∞
X
j=0
φjwj.
Degree proﬁle of trees. First we examine the degree proﬁle of trees. Such a
proﬁle is determined by the collection of parameters χj, where χj(τ) is the number
of nodes of outdegree j in τ. The variable uj will be used to mark χj, that is, nodes of
outdegree j. The discussion already conducted regarding recursive parameters shows
that the GF Y (z, u) satisﬁes the equation
Y (z, u) = zΦ(Y (z, u))
where
Φ(w) = u0φ0 + u1φ1w + u2φ2w2 + · · · .
Formal Lagrange inversion can then be applied to Y (z, u), to the effect that its coefﬁ-
cients are given by the coefﬁcients of the powers of Φ.

III. 6. COMPLETE GENERATING FUNCTIONS AND DISCRETE MODELS
183
Proposition III.7 (Degree proﬁle of trees). The number of trees of size n and degree
proﬁle (n0, n1, n2, . . .) in a simple variety of trees deﬁned by the “generator” (49) is
(50)
Yn;n0,n1,n2,... = ωn · 1
n

n
n0, n1, n2, . . .

φn0
0 φn1
1 φn2
2 · · · .
There, ωn = 1 in the unlabelled case, whereas ωn = n! in the labelled case. The
values of the nj are assumed to satisfy the two consistency conditions: P
j nj = n
and P
j jnj = n −1.
PROOF. The consistency conditions translate the fact that the total number of nodes
should be n while the total number of edges should equal n−1 (each node of degree j
is the originator of j edges). The result follows from Lagrange inversion
Yn;n0,n1,n2,... = ωn · [un0
0 un1
1 un2
2 · · · ]
 1
n[wn−1]Φ(w)n

,
to which a standard multinomial expansion applies, yielding (50).
For instance, for general Catalan trees (φj = 1) and for Cayley trees (φj = 1/j!)
these formulæ become
1
n

n
n0, n1, n2, . . .

and
(n −1)!
0!n01!n12!n2 · · ·

n
n0, n1, n2, . . .

.
□
The proof above also reveals the logical equivalence between the general tree
counting result of Proposition III.7 and the most general case of Lagrange inversion.
(This results from the fact that Φ can be specialized to any particular series.) Put
otherwise, any direct proof of (50) provides a combinatorial proof of the Lagrange
inversion theorem. Such direct derivations have been proposed by Raney [407] and
are based on simple but cunning surgery performed on lattice path representations of
trees (the “conjugation principle” of which a particular case is the “cycle lemma” of
Dvoretzky–Motzkin [145]).
Level proﬁle of trees. The next example demonstrates the utility of complete
generating functions for investigating the level proﬁle of trees.
EXAMPLE III.19. Trees and level proﬁle. Given a rooted tree τ, its level proﬁle is deﬁned as
the vector (n0, n1, n2, . . .) where nj is the number of nodes present at level j (i.e., at distance j
from the root) in tree τ. Continuing within the framework of a simple variety of trees, we now
deﬁne the quantity Yn;n0,n1,n2 to be the number of trees with size n and level proﬁle given by
the nj. The corresponding complete GF Y (z, u) with z marking size and uj marking nodes at
level j is expressible in terms of the fundamental “generator” φ:
(51)
Y (z, u) = zu0φ (zu1φ (zu2φ (zu3φ(· · · )))) .

184
III. PARAMETERS AND MULTIVARIATE GFS
We may call this a “continued φ-form”. For instance general Catalan trees have generator
φ(w) = (1 −w)−1, so that in this case the complete GF is the continued fraction:
(52)
Y (z, u) =
u0z
1 −
u1z
1 −
u2z
1 −u3z
...
.
(See Section V. 3 for complementary aspects.)
In contrast, Cayley trees are generated by
φ(w) = ew, so that
Y (z, u) = zu0ezu1ezu2ezu3e...
,
which is a “continued exponential”, that is, a tower of exponentials. Expanding such generating
functions with respect to u0, u1, . . ., in order gives straightforwardly:
Proposition III.8 (Level proﬁle of trees). The number of trees of size n and level proﬁle (n0, n1, n2, . . .)
in a simple variety of trees deﬁned by the “generator” φ(w) of (49) is
Yn;n0,n1,n2,... = ωn−1 · φ(n0)
n1 φ(n1)
n2 φ(n2)
n3
· · ·
where
φ(µ)
ν
:= [wν]φ(w)µ.
There, the consistency conditions are n0 = 1 and P
j nj = n. In particular, the counts for
general Catalan trees and for Cayley trees are respectively
 
n0 + n1 −1
n1
! 
n1 + n2 −1
n2
! 
n2 + n3 −1
n3
!
· · · ,
(n −1)!
n0!n1!n2! · · ·nn1
0 nn2
1 nn3
2 · · · .
(Note that one must always have n0 = 1 for a single tree; the general formula with n0 ̸= 1 and
ωn−1 replaced by ωn−n0 gives the level proﬁle of forests.) The ﬁrst of these enumerative results
is due to Flajolet [168] and it places itself within a general combinatorial theory of continued
fractions (Chapter V); the second one is due to R´enyi and Szekeres [409] who developed such
a formula in the course of a deep study relative to the distribution of height in random Cayley
trees. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE III.19. □
 III.28. Continued forms for path length. The BGF of path length are obtained from the level
proﬁle MGF by means of the substitution uj 7→qj. For general Catalan trees and Cayley trees,
this gives
(53)
G(z, q) =
z
1 −
zq
1 −zq2
...
,
T(z, q) = zezqezq2e...
,
where q marks path length. The MGFs are ordinary and exponential respectively. (Combined
with differentiation, such MGFs represent an attractive option for mean value analysis.)


III. 6. COMPLETE GENERATING FUNCTIONS AND DISCRETE MODELS
185
Trees and processes. The next example is an especially important application of
complete GFs, as these GFs provide a bridge between combinatorial models and a
major class of stochastic processes, the branching processes of probability theory.
EXAMPLE III.20.
Weighted tree models and branching processes. Consider the family G of
all general plane trees. Let Λ = (λ0, λ1, . . .) be a system of numeric weights. The weight of
a node of outdegree j is taken to be λj and the weight of a tree is the product of the individual
weights of its nodes:
(54)
π(τ) =
∞
Y
j=0
λ
χj(τ)
j
,
with χj(τ) the number of nodes of degree j in τ. One can view the weighted model of trees as
a model in which a tree receives a probability proportional to π(w). Precisely, the probability
of selecting a particular tree τ under this model is, for a ﬁxed size n
(55)
PGn,Λ(τ) =
π(τ)
P
|T |=n π(T).
This deﬁnes a probability measure over the set Gn and one can consider events and random
variables under this weighted model.
The weighted model deﬁned by (54) and (55) covers any simple variety of trees: just
replace each λj by the quantity φj given by the “generator’ (49) of the model. For instance,
plane unlabelled unary-binary trees are obtained by Λ = (1, 1, 1, 0, 0, . . .), while Cayley trees
correspond to λj = 1/j!. Two equivalence-preserving transformations are then especially
important in this context:
(i) Let Λ∗be deﬁned by λ∗
j = cλj for some nonzero constant c. Then the weight cor-
responding to Λ∗satisﬁes π∗(τ) = c|τ|π(w). Consequently, the models associated
to Λ and Λ∗are equivalent as regards (55).
(ii) Let Λ◦be deﬁned by λ◦
j = θjλj for some nonzero constant θ. Then the weight
corresponding to Λ◦satisﬁes π◦(τ) = c|τ|−1π(w), since P
j jχj(τ) = |τ| −1 for
any tree τ. Thus the models Λ◦and Λ are again equivalent.
Each transformation has a simple effect on the generator φ, namely:
(56)
φ(w) 7→φ∗(w) = cφ(w)
and
φ(w) 7→φ◦(w) = φ(θw).
Once equipped with such equivalence transformations, it becomes possible to describe
probabilistically the process that generates trees according to a weighted model. Assume that
λj ≥0 and that the λj are summable. Then the normalized quantities
pj =
λj
P
j λj
form a probability distribution over N. By the ﬁrst equivalence-preserving transformation the
model induced by the weights pj is the same as the original model induced by the λj. (By
the second equivalence transformation, one can furthermore assume that the generator φ is the
probability generating function of the pj.)
Such a model deﬁned by nonnegative weights {pj} summing to 1 is nothing but the classi-
cal model of branching processes (also known as Galton-Watson processes) ; see [17]. In effect,
a realization T of the branching process is classically deﬁned by the two rules: (i) produce a
root node of degree j with probability pj; (ii) if j ≥1, attach to the root node a collection
T1, . . . , Tj of independent realizations of the process. This may be viewed as the development
of a “family” stemming from a common ancestor where any individual has probability pj of

186
III. PARAMETERS AND MULTIVARIATE GFS
giving birth to j children. Clearly, the probability of obtaining a particular ﬁnite tree τ has
probability π(τ), where π is given by (54) and the weights are λj = pj. The generator
φ(w) =
∞
X
j=0
pjwj
is then nothing but the probability generating function of (one-generation) offspring, with the
quantity µ = φ′(1) being its mean size.
For the record, we recall that branching processes can be classiﬁed into three categories
depending on the values of µ:
Subcriticality: when µ < 1, the random tree produced is ﬁnite with probability 1
and its expected size is also ﬁnite.
Criticality: when µ = 1, the random tree produced is ﬁnite with probability 1 but its
expected size is inﬁnite.
Supercriticality: when µ > 1, the random tree produced is ﬁnite with probability
strictly less than 1.
From the discussion of equivalence transformations (56), there furthermore results that, regard-
ing trees of a ﬁxed size n, there is complete equivalence between all branching processes with
generators of the form
φθ(w) = φ(θw)
φ(θ) .
Such families of related functions are known as “exponential families” in probability theory. In
this way, one may always regard at will the random tree produced by a weighted model of some
ﬁxed size n as originating from a branching process of subcritical, critical, or supercritical type
conditioned upon the size of the total progeny.
Finally, take a set S ⊆G for which the complete generating function of S with respect to
the degree proﬁle is available,
S(z, u0, u1, . . .) =
X
τ∈S
z|τ| “
uχ0(τ)
0
uχ1(τ)
1
· · ·
”
.
Then, for a system of weights Λ, one has
S(z, λ0, λ1, . . .) =
X
τ∈S
π(τ)z|τ|.
Thus, the probability that a weighted tree of size n belongs to S becomes accessible by extract-
ing the coefﬁcient of zn. This applies a fortiori to branching processes as well. In summary,
the analysis of parameters of trees of size n under either weighted models or branching pro-
cess models derives from substituting weights or probability values inside the corresponding
combinatorial generating functions. . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE III.20. □
The reduction of combinatorial tree models to branching processes has been pur-
sued early, most notably by the “Russian School”: see especially the books by Kolchin
[314, 315] and references therein. (For asymptotic purposes, the equivalence between
combinatorial models and critical branching processes often turns out to be most fruit-
ful.) Conversely, symbolic-combinatorial methods may be viewed as a systematic way
of obtaining equations relative to characteristics of branching processes. We do not
elaborate further along these lines as this would take us outside of the scope of the
present book.

III. 7. ADDITIONAL CONSTRUCTIONS
187
 III.29. Catalan trees, Cayley trees, and branching processes. Catalan trees of size n are
deﬁned by the weighted model in which λj ≡1, but also equivalently by bλj = cθj, for
any c > 0 and θ ≤1. In particular they coincide with the random tree produced by the critical
branching process whose offspring probabilities are geometric: pj = 1/2j+1.
Cayley trees are a priori deﬁned by λj = 1/j!. They can be generated by the critical
branching process with Poisson probabilities, pj = e−1/j!, and more generally with an arbi-
trary Poisson distribution pj = e−λλj/j!.

III. 7. Additional constructions
We discuss here additional constructions already examined in earlier chapters,
namely pointing and substitution (Section III. 7.1) as well as order constraints (Sec-
tion III.7.2) on the one hand, implicit structures (Section III. 7.3) on the other hand.
Given that basic translation mechanisms can be directly adapted to the multivariate
realm, such extensions involve basically no new concept, and the methods of Chap-
ters I and II can be recycled. In Section III. 7.4, we revisit the classical principle of
inclusion-exclusion under a generating function perspective. In this light, the principle
appears as a typically multivariate device well-suited to enumerating objects accord-
ing the number of occurrences of sub-conﬁgurations.
III. 7.1. Pointing and substitution. Let ⟨F, χ⟩be a class–parameter pair, where
χ is multivariate of dimension r ≥1 and let F(z) be the MGF associated to it in
the notations of (18) and (27). In particular z0 = z marks size, and zk marks the
component k of the multiparameter χ. If z marks size, then, like in the univariate case,
θz translates the fact of distinguishing one atom. Generally, pick up a variable x ≡zj
for some j with 0 ≤j ≤r. Then since
x∂x(satbxf) = f · (satbxf),
the interpretation of the operator θx ≡x∂x is immediate; it means “pick up in all
possible ways in objects of F a conﬁguration marked by x and point to it”. For
instance, if F(z, u) is the BGF of trees where z marks size and u marks leaves,
then θuF(z, u) = u∂uF(z, u) enumerates trees with one distinguished leaf.
Similarly, the substitution x 7→S(z) in a GF F, where S(z) is the MGF of a
class S, means attaching an object of type S to conﬁgurations marked by the variable x
in F. We refrain from giving detailed deﬁnitions (that would be somewhat clumsy
and uninformative) as the process is better understood by practice than by long formal
developments. Justiﬁcation in each particular case is easily obtained by returning to
the combinatorial representation of generating functions as images of combinatorial
classes.
EXAMPLE III.21. Constrained integer compositions and “slicing”. This example illustrates
variations around the substitution scheme. Consider compositions of integers where successive
summands have sizes that are constrained to belong to a ﬁxed set R ⊆N2. For instance, the
relations
R1 = {(x, y) | 1 ≤x ≤y},
R2 = {(x, y) | 1 ≤y ≤2x},

188
III. PARAMETERS AND MULTIVARIATE GFS
correspond to weakly increasing summands in the case of R1 and to summands that can at most
double at each stage in the case of R2. In the “ragged landscape” representation of composi-
tions, this means considering diagrams of unit cells aligned in columns along the horizontal
axis, with successive columns obeying the constraint imposed by R.
Let F(z, u) be the BGF of such R–restricted compositions, where z marks total sum and u
marks the value of the last summand, that is, the height of the last column. The function F(z, u)
satisﬁes a functional equation of the form
(57)
F(z, u) = f(zu) + (L [F(z, u)])u7→zu ,
where f(z) is the generating function of the one-column objects and L is a linear operator over
formal series in u given by
(58)
L[uj] :=
X
(j,k)∈R
uk.
In effect, Equation (57) describes inductively objects as comprising either one column (f(zu))
or else being formed by adding a new column to an existing one. In the latter case, the last
column added has a size k that must be such that (j, k) ∈R, if it was added after a column of
size j, and it will contribute ukzk to the BGF F(z, u); this is precisely what (58) expresses. In
particular, F(z, 1) gives back the enumeration of F–objects irrespective of the size of the last
column.
For a rule R that is “simple enough”, the basic equation (57) will often involve a substi-
tution. Let us ﬁrst rederive in this way the enumeration of partitions. We take R = R1 and
assume that the ﬁrst column can have any positive size. Compositions into increasing summands
are clearly the same as partitions. Since
L[uj] = uj + uj+1 + uj+2 + · · · =
uj
1 −u,
the function F(z, u) satisﬁes a functional equation involving a substitution,
(59)
F(z, u) =
zu
1 −zu +
1
1 −zuF(z, zu).
This relation iterates: any linear functional equation of the substitution type
φ(u) = α(u) + β(u)φ(σ(u))
is solved formally by
(60)
φ(u) = α(u) + β(u)α(σ(u)) + β(u)β(σ(u))α(σ⟨2⟩(u)) + · · · ,
where σ⟨j⟩(u) designates the jth iterate of u.
                                       












k
                                  
















uj
u
FIGURE III.14. The technique of “adding a slice” for enumerating constrained compositions.

III. 7. ADDITIONAL CONSTRUCTIONS
189
Returning to compositions into increasing summands, that is, partitions, the turnkey so-
lution (60) gives, upon iterating on the second argument with the ﬁrst argument treated as a
parameter:
(61)
F(z, u) =
zu
1 −zu +
z2u
(1 −zu)(1 −z2u) +
z3u
(1 −zu)(1 −z2u)(1 −z3u) + · · · .
Equivalence with the alternative form
(62)
F(z, u) =
zu
1 −z +
z2u2
(1 −z)(1 −z2) +
z3u3
(1 −z)(1 −z2)(1 −z3) + · · ·
is then easily veriﬁed from (59) upon expanding F(z, u) as a series in u and applying the
method of indeterminate coefﬁcients to the form (1 −zu)F(z, u) = zu + F(z, zu). The pre-
sentation (62) is furthermore consistent with the treatment of partitions given in Chapter I since
the quantity [uk]F(z, u) clearly represents the OGF of (nonempty) partitions whose largest
summand is k. (In passing, the equality between (61) and (62) is a shallow but curious identity
that is quite typical of the area of q-analogues.)
This same method has been applied in [201] to compositions satisfying condition R2
above. In this case, successive summands are allowed to double at most at each stage. The
associated linear operator is
L[uj] = u + · · · + u2j = u1 −u2j
1 −u .
For simplicity, it is assumed that the ﬁrst column has size 1. Thus, F satisﬁes a functional
equation of the substitution type:
F(z, u) = zu +
zu
1 −zu
`
F(z, 1) −F(z, z2u2)
´
.
This can be solved by means of the general iteration mechanism (60), treating momentarily
F(z, 1) as a known quantity: with a(u) := zu + F(z, 1)/(1 −zu), one has
F(z, u) = a(u) −
zu
1 −zua(z2u2) +
zu
1 −zu
z2u2
1 −z2u2 a(z6u4) −· · · .
Then, the substitution u = 1 in the solution becomes permissible. Upon solving for F(z, 1),
one eventually gets the somewhat curious GF for compositions satisfying R2:
F(z, 1)
=
P
j≥1(−1)j−1z2j+1−j−2/Qj−1(z)
P
j≥0(−1)jz2j+1−j−2/Qj(z)
where
Qj(z) = (1 −z)(1 −z3)(1 −z7) · · · (1 −z2j−1).
The sequence of coefﬁcients starts as 1, 1, 2, 3, 5, 9, 16, 28, 50 and is EIS A002572: it repre-
sents for instance the number of possible level proﬁles of binary trees, or equivalently the num-
ber of partitions of 1 into summands of the form 1, 1
2, 1
4, 1
8, . . . (this is related to the number
of solutions to Kraft’s inequality). See [201] for details including very precise asymptotic esti-
mates and Tangora’s paper [464] for relations to algebraic topology.
END OF EXAMPLE III.21. □
The reason for presenting the slicing method in some detail is that it is very gen-
eral. It has been in particular employed to derive a number of original enumerations of
polyominoes by area, a topic of interest in some branches of statistical mechanics: for
instance, the book by Janse van Rensburg [482] discusses many applications of such
lattice models to polymers and vesicles. See Bousquet-M´elou’s review paper [66] for

190
III. PARAMETERS AND MULTIVARIATE GFS
a methodological perspective. Some of the origins of the method point to P´olya in the
1930’s, see [396], and independently to Temperley [466, pp. 65–67].
 III.30. Pointing-erasing and the combinatorics of Taylor’s formula. The derivative opera-
tor ∂x corresponds combinatorially to a “pointing-erasing” operation: select in all possible ways
an atom marked by x and make it transparent to x-marking (e.g., by replacing it by a neutral
object). The operator
1
k!∂k
xf(x), then corresponds to picking up in all possible way a subset
(order does not count) of k conﬁgurations marked by x. The identity (Taylor’s formula)
f(x + y) =
X
k≥0
„ 1
k!∂k
xf(x)
«
yk
can then receive a simple combinatorial interpretation: Given a population of individuals (F
enumerated by f), form the bicoloured population of individuals enumerated by f(x + y),
where each atom of each object can be repainted either in x-colour or y-colour; the process is
equivalent to deciding a priori for each individual to repaint k of its atoms from x to y, this
for all possible values of k ≥0. Senn from combinatorics, Taylor’s formula thus expresses the
equivalence between two ways of counting.

 III.31. Carlitz compositions I. Let K be the class of compositions such that all pairs of
adjacent summands are formed of distinct values. These can be generated by the operator
L[uj] =
uz
1−uz −ujzj, so that L[f(u)] =
uz
1−uz f(1) −f(uz). The BGF K(z, u), with u
marking the value of the last summand, then satisﬁes a functional equation,
K(z, u) =
uz
1 −uz +
uz
1 −uz K(z, 1) −K(z, zu),
giving eventually K(z) ≡K(z, 1) under the form
(63)
K(z)
=
0
@1 +
X
j≥1
(−z)j
1 −zj
1
A
−1
=
1 + z + z2 + 3z3 + 4z4 + 7z5 + 14z6 + 23z7 + 39z8 + · · · .
The sequence of coefﬁcients constitutes EIS A003242. Such compositions have been introduced
by Carlitz in 1976; the derivation above is from a paper by Knopfmacher and Prodinger [296]
who provide early references and asymptotic properties. (We resume this thread in Note 34
below and in Chapter IV, p. 249.)

III. 7.2. Order constraints. We refer in this subsection to the discussion of or-
der constraints in labelled products that has been given in Chapter II. We recall that
the modiﬁed labelled product
A = (B2 ⋆C)
only includes the elements of (B ⋆C) such that the minimal label lies in the A com-
ponent. Once more the univariate rules generalize verbatim for parameters that are
inherited and the corresponding exponential MGFs are related by
A(z, u) =
Z z
0
(∂tB(t, u)) · C(t, u) dt.
To illustrate this multivariate extension, we shall consider a quadrivariate statistic on
permutations.

III. 7. ADDITIONAL CONSTRUCTIONS
191
valley:
σi−1 > σi < σi+1
leaf node (u0)
double rise:
σi−1 < σi < σi+1
unary right-branching (u1)
double fall:
σi−1 > σi > σi+1
unary left-branching (u′
1)
peak:
σi−1 < σi > σi+1
binary node (u2)
FIGURE III.15. Local order patters in a permutation and the four types of nodes in the
corresponding increasing binary tree.
EXAMPLE III.22.
Local order patterns in permutations.
An element σi of a permutation
written σ = σ1, . . . , σn when compared to its immediate neighbours can be categorized into
one of four types4 summarized in the ﬁrst two columns of Figure 15. The correspondence with
binary increasing trees described in Example 17 of Chapter II then shows the following: peaks
and valleys correspond to binary nodes and leaves, respectively, while double rises and double
falls are associated with right-branching and left-branching unary nodes. Let u0, u1, u′
1, u2 be
markers for the number of nodes of each type, as summarized in Figure 15. Then the exponential
MGF of increasing trees under this statistic satisﬁes
∂
∂z I(z, u) = u0 + (u1 + u′
1)I(z, u) + u2I(z, u)2.
This is solved by separation of variables as
(64)
I(z, u) = δ
u2
v1 + δ tan(zδ)
δ −v1 tan(zδ) −v1
u2 ,
where the following abbreviations are used:
v1 = 1
2(u1 + u′
1),
δ =
q
u0u2 −v2
1.
One has
I = u0z + u0(u1 + u′
1)z2
2! + u0((u1 + u′
1)2 + 2u0u2)z3
3! ,
which agrees with the small cases. This calculation is consistent with what has been found in
Chapter II regarding the EGF of all nonempty permutations and of alternating permutations,
z
1 −z ,
tan(z),
that derive from the substitutions {u0 = u1 = u′
1 = u2 = 1} and {u0 = u2 = 1, u1 =
u′
1 = 0}, respectively. The substitution {u0 = u1 = u, u′
1 = u2 = 1} gives a simple variant
(without the empty permutation) of the BGF of Eulerian numbers (73) derived below by other
means (p. 197).
By specialization of the quadrivariate GF, there results that, in a tree of size n the mean
number of nodes of nullary, unary, or binary type is asymptotic to n/3, with a variance that is
O(n), thereby ensuring concentration of distribution.
. . . . . . . . END OF EXAMPLE III.22. □
A similar analysis yields path length. It is found that a random increasing binary
tree of size n has mean path length
2n log n + O(n).
4Here, for |σ| = n, we regard σ as bordered by (−∞, −∞), i.e., we set σ0 = σn+1 = −∞and let
the index i in Figure 15 vary in [1 . . n]. Alternative bordering conventions prove occasionally useful.

192
III. PARAMETERS AND MULTIVARIATE GFS
FIGURE III.16. The level proﬁle of a random increasing binary tree of size 256. (Com-
pare with Figure 13 for binary trees under the uniform Catalan statistic.)
Contrary to what the uniform combinatorial model gives, such trees tend to be rather
well balanced, and a typical branch is only about 38.6% longer than in a perfect binary
tree (since 2/ log 2 .= 1.386). This fact applies to binary search trees (Note 32) and
it justiﬁes that the performance of such trees is quite good when they are applied to
random data [307, 351, 434] or subjected to randomization [416, 370].
 III.32. Binary search trees (BSTs).
Given a permutation τ, one deﬁnes inductively a tree
BST(τ) by
BST(ǫ) = ∅;
BST(τ) = ⟨τ1, BST(τ|<τ1), BST(τ|>τ1)⟩.
(There, τ|P represents the subword of τ consisting of those elements that satisfy predicate P.)
Let IBT(σ) be the increasing binary tree canonically associated to σ. Then one has the funda-
mental Equivalence Principle,
IBT(σ)
shape
≡
BST(σ−1),
where A
shape
≡B means that A and B have identical tree shapes.

III. 7.3. Implicit structures. Here again, we note that equations involving sums
and products, either labelled or not, are easily solved just like in the univariate case.
The same applies for the sequence construction and for the set construction, especially
in the labelled case—refer to the corresponding sections of Chapters I and II. Again,
the process is best understood by examples.
Suppose for instance one wants to enumerate connected labelled graphs by the
number of nodes (marked by z) and the number of edges (marked by u). The class K
of connected graphs and the class G of all graphs are related by the set construction,
G = SET{K},
meaning that every graph decomposes uniquely into connected components. The cor-
responding exponential BGFs then satisfy
G(z, u) = eK(z,u)
implying
K(z, u) = log G(z, u),
since the number of edges in a graph is inherited (additively) from the corresponding
numbers in connected components. Now, the number of graphs of size n having k
edges is
 n(n−1)/2
k

, so that
(65)
K(z, u) = log
 
1 +
∞
X
n=1
(1 + u)n(n−1)/2 zn
n!
!
.
This formula, which appears as a reﬁnement of the univariate formula of Chapter II,
then simply reads: connected graphs are obtained as components (the log operator) of

III. 7. ADDITIONAL CONSTRUCTIONS
193
general graphs, where a general graph is determined by the presence or absence of an
edge (corresponding to (1+u)) between any pair of nodes (the exponent n(n−1)/2).
Pulling out information out of the formula (65) is however not obvious due to the
alternation of signs in the expansion of log(1 + w) and due to the strongly divergent
character of the involved series. As an aside, we note here that the quantity
bK(z, u) = K
z
u, u

enumerates connected graphs according to size (marked by z) and excess (marked
by u) of the number of edges over the number of nodes. This means that the results of
Section 5.3 of Chapter II obtained by Wright’s decomposition can be rephrased as the
expansion (within C(u)[[z]]):
(66)
log
 
1 +
∞
X
n=1
(1 + u)n(n−1)/2 znu−n
n!
!
=
1
uW−1(z) + W0(z) + · · ·
=
1
u

T −1
2T 2

+
1
2 log
1
1 −T −1
2T −1
4T 2

+ · · · ,
with T ≡T (z). See Temperley’s early works [465, 466] as well as the “giant paper on
the giant component” [282] and the paper [205] for direct derivations that eventually
constitute analytic alternatives to Wright’s combinatorial approach.
EXAMPLE III.23. Smirnov words.
Following the treatment of Goulden and Jackson [244],
we deﬁne a Smirnov word to be any word that has no consecutive equal letters. Let W =
SEQ{A} be the set of words over the alphabet A = {a1, . . . , ar} of cardinality r, and S be the
set of Smirnov words. Let also vj mark the number of occurrences of the jth letter in a word.
One has5
W (v1, . . . , vr) =
1
1 −(v1 + · · · + vr)
Start from a Smirnov word and substitute to any letter aj that appears in it an arbitrary nonempty
sequence of letters aj. When this operation is done at all places of a Smirnov word, it gives
rise to an unconstrained word. Conversely, any word is associated to a unique Smirnov word
by collapsing into single letters maximal groups of contiguous equal letters. In other terms,
arbitrary words derive from Smirnov words by a simultaneous substitution:
W = S
ˆ
a1 7→SEQ≥1{a1}, . . . , ar 7→SEQ≥1{ar}
˜
.
There results the relation
(67)
W (v1, . . . , vr) = S
„
v1
1 −v1 , . . . ,
vr
1 −vr
«
.
This relation determines the MGF S(v1, . . . , vr) implicitly. Now, since the inverse function of
v/(1 −v) is v/(1 + v), one ﬁnds the solution:
(68)
S(v1, . . . , vr) = W
„
v1
1 + v1 , . . . ,
vr
1 + vr
«
=
 
1 −
r
X
j=1
vj
1 + vj
!−1
.
5The variable z marking length being here unnecessary, it is omitted—it would otherwise somewhat
obscure the simplicity of the calculations.

194
III. PARAMETERS AND MULTIVARIATE GFS
For instance, if we set vj = z, that is, we “forget” the composition of the words into letters,
we obtain the OGF of Smirnov words counted according to length as
1
1 −r
z
1+z
=
1 + z
1 −(r −1)z = 1 +
X
n≥1
r(r −1)n−1zn.
This is consistent with elementary combinatorics since a Smirnov word of length n is deter-
mined by the choice of its ﬁrst letter (r possibilities) followed by a sequence of n −1 choices
constrained to avoid one letter amongst r (and corresponding to r −1 possibilities for each
position). The interest of (68) is to apply equally well to the Bernoulli model where letters may
receive unequal probabilities and where a direct combinatorial argument does not appear to be
easy: it sufﬁces to perform the substitution vj 7→pjz in this case: see Example IV.9, p. 249
and Note V.7, p. 289
From these developments, one can next build the GF of words that never contain more
than m consecutive equal letters. It sufﬁces to effect in (68) the substitution vj 7→vj +· · ·+vm
j .
In particular for the univariate problem (or, equivalently, the case where letters are equiproba-
ble), one ﬁnds the OGF
1
1 −r
z 1−zm
1−z
1 + z 1−zm
1−z
=
1 −zm+1
1 −rz + (r −1)zm+1 .
This extends to an arbitrary alphabet the analysis of single runs and double runs in binary words
that was performed in Section 4 of Chapter I. Naturally, this approach applies equally well to
nonuniform letter probabilities and to a collection of run-length upperbounds and lowerbounds
dependent on each particular letter. This topic is in particular pursued by different methods in
several works of Karlin and coauthors (see, e.g., [365]), themselves motivated by applications
to life sciences. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE III.23. □
 III.33. Enumeration in free groups.
Consider the composite alphabet B = A ∪A, where
A = {a1, . . . , ar} and A = {a1, . . . , ar}. A word over alphabet B is said to be reduced if it
arises from a word over B by a maximal application of the reductions ajaj 7→ǫ and ajaj 7→ǫ
(with ǫ the empty word). A reduced word thus has no factor of the form ajaj or ajaj. Such a
reduced word serves as a canonical representation of an element in the free group Fr generated
by A, upon identifying aj = a−1
j . The GF of reduced words with uj and uj marking the
number of occurrences of letter aj and aj, respectively, is
R(u1, . . . , ur, u1, . . . , ur) = S
„
u1
1 −u1 +
u1
1 −u1 , . . . ,
ur
1 −ur +
ur
1 −ur
«
,
with S the GF of Smirnov words, as in (68). In particular this specializes to give the OGF of
reduced words with z marking length, R(z) = (1 + z)/(1 −(2r −1)z): implying Rn =
2r(2r −1)n, which checks with what elementary combinatorics gives.
The Abelian image λ(w) of an element w of the free group Fk is obtained by letting
all letters commute and applying the reductions aj · a−1
j
= 1. It can then be put under the
form am1
1
· · · amr
r
, with each mj in Z, so that it can be identiﬁed with an element of Zr.
Let x = (x1, . . . , xr) be a vector of indeterminates and deﬁne xλ(w) to be the monomial
xm1
1
· · · xmr
r
. Of interest in certain group-theoretic investigations is the MGF
Q(z; x) :=
X
w∈R
z|w|xλ(w) = S
„
zx1
1 −zx1 +
zx−1
1
1 −zx−1
1
, . . . ,
zxr
1 −zxr +
zx−1
r
1 −zx−1
r
«
,

III. 7. ADDITIONAL CONSTRUCTIONS
195
which is found to simplify to
Q(z; x) =
1 −z2
1 −z Pr
j=1(xj + x−1
j ) + (2r −1)z2 .
This last form appears in a paper of Rivin [412], where it is obtained by matrix techniques.
Methods developed in Chapter IX can then be used to establish central and local limit laws for
the asymptotic distribution of λ(w) over Rn, providing an alternative to the methods of [412,
435]. (This note is based on an unpublished memo of Flajolet, Noy, and Ventura, 2006.)

 III.34. Carlitz compositions II. Here is an alternative derivation of the OGF of Carlitz
compositions (Note 31, p. 190). Carlitz compositions with largest summand ≤r are obtained
from the OGF of Smirnov words by the substitution vj 7→zj:
(69)
K[r](z) =
 
1 −
r
X
j=1
zj
1 + zj
!−1
,
The OGF of all Carlitz compositions then results from letting r →∞:
(70)
K(z) =
 
1 −
∞
X
j=1
zj
1 + zj
!−1
.
The asymptotic form of the coefﬁcients is derived in Chapter IV, p. 249.

III. 7.4. Inclusion-Exclusion. Inclusion-exclusion is a familiar type of reason-
ing rooted in elementary mathematics. Its principle, in order to count exactly, consists
in grossly overcounting, then performing a simple correction of the overcounting, then
correcting the correction, and so on. Characteristically, enumerative results provided
by inclusion exclusion involve an alternating sum. We revisit this process here in the
perspective of multivariate generating functions, where it essentially reduces to a com-
bined use of substitution and implicit deﬁnitions. Our approach follows Goulden and
Jackson’s encyclopedic treatise [244].
Let E be a set endowed with a real or complex valued measure | · | in such a way
that, for A, B ⊂E, there holds
|A ∪B| = |A| + |B|
whenever
A ∩B = ∅.
Thus, | · | is an additive measure, typically taken as set cardinality (i.e., |e| = 1 for
e ∈E) or a discrete probability measure on E (i.e., |e| = pe for e ∈E). The general
formula
|A ∪B| = |A| + |B| −|AB|
where
AB := A ∩B,
follows immediately from basic set-theoretic principles:
X
c∈A∪B
|c| =
X
a∈A
|a| +
X
b∈B
|b| −
X
i∈A∩B
|i|.
What is called the inclusion-exclusion principle or sieve formula is the following mul-
tivariate generalization, for an arbitrary family A1, . . . , Ar ⊂E:
(71)
|A1 ∪· · · ∪Ar|
≡
E \ (A1A2 · · · Ar)

where
A := E \ A
=
X
1≤i≤r
|Ai| −
X
1≤i1<i2≤r
|Ai1Ai2| + · · · + (−1)r−1|A1A2 · · · Ar|.

196
III. PARAMETERS AND MULTIVARIATE GFS
(The easy proof by induction results from elementary properties of the boolean algebra
formed by the subsets of E; see, e.g., [98, Ch. IV].) An alternative formulation results
from setting Bj = Aj, Bj = Aj:
(72)
|B1B2 · · · Br| = |E| −
X
1≤i≤r
|Bi|
+
X
1≤i1<i2≤r
|Bi1Bi2| −· · · + (−1)r|B1B2 · · · Br|.
In terms of measure, this equality quantiﬁes the set of objects satisfying exactly a
collection of simultaneous conditions (all the Bj) in terms of those that violate at
least some of the conditions (the Bj).
Derangements. Here is a textbook example of an inclusion–exclusion argument,
namely, the enumeration of derangements. Recall that a derangement is a permuta-
tion σ such that σi ̸= i, for all i. Fix E as the set of all permutations of [1, n], take
the measure | · | to be set cardinality, and let Bi be the subset of permutations in E
associated to the property σi ̸= i. (There are consequently r = n conditions.) Thus,
Bi means having no ﬁxed point at i, while Bi means having a ﬁxed point at the dis-
tinguished value i. Then, the left hand side of (72) is the number of permutations that
are derangements, that is, Dn. As regards the right hand side, the kth sum comprises
itself
 n
k

terms counting possibilities attached to the choices of indices i1 < · · · < ik;
each such choice is associated to a factor Bi1 · · · Bik that describes all permutations
with ﬁxed points at the distinguished points i1, . . . , ik (i.e., σ(i1) = i1, . . . , σik = ik).
Clearly, |Bi1 · · · Bik| = (n −k)!. Therefore one has
Dn = n! −
n
1

(n −1)! +
n
2

(n −2)! −· · · + (−1)n
n
n

0!,
which rewrites into the more familiar form
Dn
n! = 1 −1
1! + 1
2! −· · · + (−1)n
n!
.
This gives an elementary derivation of the derangement numbers already encountered
in Chapter II and obtained there by means of the labelled set and cycle constructions.
The derivation above is perfectly ﬁne but carrying it out on complex examples
may represent somewhat of a challenge. In contrast, as we now explain, there exists
a parallel approach based on multivariate generating functions, which is technically
easy to deal with and has great versatility.
Let us now reexamine derangements in a generating function perspective. Con-
sider the set P of all permutations and build a superset Q as follows. The set Q
is comprised of permutations in which an arbitrary number of ﬁxed points—some,
maybe none, not necessarily all—have been distinguished. (This corresponds to ar-
bitrary products of the Bj in the argument above.) For instance Q contains elements
like
1, 3, 2,
1, 3, 2,
1, 2, 3,
1, 2, 3,
1, 2, 3,
1, 2, 3,
where distinguished ﬁxed points are underlined. Clearly, if one removes the distin-
guished elements of a γ ∈Q, what is left constitutes an arbitrary permutation of the

III. 7. ADDITIONAL CONSTRUCTIONS
197
remaining elements. One has
Q ∼= U ⋆P,
where U denotes the class of urns that are sets of atoms. In particular, the EGF of Q is
Q(z) = ez/(1 −z). What we’ve just done is to enumerate the quantities that appear
in (72), but with the signs “wrong”, i.e., all pluses.
Introduce now the variable v to mark the distinguished ﬁxed points in objects
of Q. The exponential BGF is then by general principles of this chapter:
Q(z, v) = evz
1
1 −z .
Let now P(z, u) be the BGF of permutations where u marks the number of ﬁxed
points. (Let us ignore momentarily the fact that P(z, u) is otherwise known.) Per-
mutations with some ﬁxed points distinguished are generated by the substitution u 7→
1 + v inside P(z, u). In other words one has the fundamental inclusion-exclusion
relation
Q(z, v) = P(z, 1 + v).
This is then easily solved as
P(z, u) = Q(z, u −1),
so that knowledge of (the easy) Q gives (the harder) P. For the case at hand, this
yields
P(z, u) = e(u−1)z
1 −z ,
P(z, 0) = D(z) = e−z
1 −z ,
and, in particular, the EGF of derangements has been retrieved. Note that the sought
P(z, 0) comes out as Q(z, −1), so that signs corresponding to the sieve formula (72)
have now been put “right”, i.e., alternating.
The process employed for derangements is clearly very general. It is a generating
function analogue of the inclusion-exclusion principle: counting objects that satisfy a
number of simultaneous constraints is reduced to counting objects that violate some of
the constraints at distinguished “places”—the latter is usually a simpler problem. The
generating function analogue of inclusion-exclusion is then simply the substitution
v 7→u −1, if a bivariate GF is sought, or v 7→−1 in the univariate case.
Rises in permutations and patterns in words. The book by Goulden and Jack-
son [244, pp. 45–48] describes a useful formalization of the inclusion process operat-
ing on MGFs. Conceptually, it combines substitution and implicit deﬁnitions. Once
again, the modus operandi is best grasped through examples, two of which are detailed
below.
EXAMPLE III.24.
Rises and ascending runs in permutations.
A rise (also called an ascent)
in a permutation σ = σ1 · · · σn is a pair of consecutive elements σiσi+1 satisfying σi < σi+1
(with 1 ≤i < n). The problem is to determine the number An,k of permutations of size having
exactly k rises, together with the BGF A(z, u). By symmetry, we are also enumerating descents
(deﬁned by σi > σi+1) as well as ascending runs that are each terminated by a descent.
Guided by the inclusion-exclusion principle, we tackle the easier problem of enumerating
permutations with distinguished rises, of which the set is denoted by B. For instance, B contains

198
III. PARAMETERS AND MULTIVARIATE GFS
elements like
2 6 1 3ր4ր8ր9ր11 15 12 5ր10 13 7 14,
where those rises that are distinguished are represented by arrows. (Note that some rises may
not be distinguished.) Maximal sequences of adjacent distinguished rises (boxed in the repre-
sentation) will be called clusters. Then, B can be speciﬁed by the sequence construction applied
to atoms (Z) and clusters (C) as
B = SEQ(Z + C),
where
C = (Z ր Z) + (Z ր Z ր Z) + · · · = SET≥2(Z).
since a cluster is an ordered sequence, or equivalently a set, furthermore having at least two
elements. This gives the EGF of B as
B(z) =
1
1 −(z + (ez −1 −z)) =
1
2 −ez ,
which happens to coincide with the EGF of surjections.
For inclusion-exclusion purposes, we need the BGF of B with v marking the number of
distinguished rises. A cluster of size k contains k −1 rises, so that
B(z, v) =
1
1 −(z + (ezv −1 −zv)/v) =
v
v + 1 −ezv .
Now, the usual argument applies: the BGF A(z, u) satisﬁes B(z, v) = A(z, 1 + v), so that
A(z, u) = B(z, u −1), which yields the particularly simple form
(73)
A(z, u) =
u −1
u −ez(u−1) .
In particular, this GF expands as
A(z, u) = 1 + z + (u + 1)z2
2! + (u2 + 4u + 1)z3
3! + (u3 + 11u2 + 11u + 1)z4
4! + · · · .
The coefﬁcients An,k are known as the Eulerian numbers. In combinatorial analysis, these
numbers are almost as classic as the Stirling numbers. A detailed discussion of their properties
is to be found in classical treatises like [98] or [248]. (From Eq. (73), permutations without
rises are enumerated by B(z, −1) = ez, an altogether obvious result.)
Moments derive easily from an expansion of (73) at u = 1, which gives
A(z, u) =
1
1 −z + 1
2
z2
(1 −z)2 (u −1) + 1
12
z3(2 + z)
(1 −z)3 (u −1)2 + · · · .
In particular: the mean of the number of rises in a random permutation of size n is 1
2(n −1)
and the variance is ∼
1
12n, ensuring concentration of distribution.
The same method applies to the enumeration of ascending runs: for a ﬁxed parameter ℓ,
an ascending run of length ℓis a sequence of consecutive elements σiσi+1 · · · σi+ℓsuch that
σi < σi+1 < · · · < σi+ℓ. (Thus, a rise is an ascending run of length 1.) We deﬁne a cluster as a
sequence of distinguished runs which overlap in the sense that they share some of the elements
of the permutation. The exponential BGF of permutations with distinguished ascending runs is
then
B(z, v) =
1
1 −z −bI(z, v)
,
where
bI(z, v) =
X
n,k
In,kvk zn
n! ,
and In,k is the number of ways of covering the segment [1, n] with k distinct intervals of length ℓ
that are contained in [1, n] and have integral end points. The numbers In,k themselves result

III. 7. ADDITIONAL CONSTRUCTIONS
199
from elementary combinatorics (see also the case of patterns in words below) and one has for
the OGF corresponding to bI:
I(z, v) ≡
X
n,k
In,kvkzn =
zℓ+1v
1 −v(z + z2 + · · · + zℓ).
(Proof: The ﬁrst segment in the covering must be placed on the left, the other ones appear in
succession, each shifted right by 1 to ℓpositions from the previous one.) The last two equations
ﬁnally determine the exponential BGF of permutations with size marked by z and ascending
runs of length ℓ+ 1 marked by u,
(74)
A(z, u) = B(z, u −1),
given the inclusion-exclusion principle.
The resulting formulæ are checked to generalize the case of rises (ℓ= 1). They can
be made explicit by ﬁrst expanding the OGF I(z, v) into partial fractions, then applying the
transformation (1 −ωz)−1 7→eωz in order to translate I(z, v) into bI(z, v). The net result is
A(z, u) =
1
1 −z −bI(z, u −1)
,
where
bI(z, v) = (1 −z)(v + 1) +
ℓ
X
j=1
cj(v)eωj(v)z
involves a sum of exponentials. In this last equation, the ωj(v) are the roots of the characteristic
equation ωℓ= v(1 + · · · + ωℓ−1) and the cj(v) are the corresponding coefﬁcients in the
partial fraction decomposition of I(z, v). These expressions were ﬁrst published by Elizalde
and Noy [150] who obtained them by means of tree decompositions.
The BGF (74) can be exploited in order to determine quantitative information on long runs
in permutations. First, an expansion at u = 1 (also, a direct reasoning: see the discussion of
hidden words in Chapter I) shows that the mean number of ascending runs of length ℓ−1 is
(n −ℓ+ 1)/ℓ! exactly, as soon as n ≥ℓ. This entails that, if n = o(ℓ!), the probability of
ﬁnding an ascending run of length ℓ−1 tends to 0 as n →∞. What is used in passing in this
argument is the general fact that for a discrete variable X with values in 0, 1, 2, . . ., one has
(with Iverson’s notation)
P(X ≥1) = E([[X ≥1]]) = E(min(X, 1)) ≤E(X).
An inequality in the converse direction can be obtained from the second moment method. In
effect, the variance of the number of ascending runs of length ℓ−1 is found to be of the exact
form αℓn + βℓwhere αℓis essentially 1/ℓ! and βℓis of comparable order (details omitted).
Then, by Chebyshev’s inequalities, concentration of distribution holds as long as ℓis such that
(ℓ+ 1)! = o(n). In this case, with high probability (i.e., with probability tending to 1 as n
tends to ∞), there are many ascending runs of length ℓ−1. In particular:
Let Ln be the length of the longest ascending run in a random permutation of n
elements. Let ℓ0(n) be the smallest integer such that ℓ! ≥n. Then the distribution
of Ln is concentrated in the sense that Ln/ℓ0(n) converges in probability to 1: for
any ǫ > 0, one has
lim
n→∞P
„
1 −ǫ <
Ln
ℓ0(n) < 1 + ǫ
«
= 1.
What has been found here is a fairly sharp threshold phenomenon. END OF EXAMPLE III.24. □

200
III. PARAMETERS AND MULTIVARIATE GFS
 III.35. Permutations without ℓ–ascending runs. The EGF of permutations without 1–, 2–
and 3–ascending runs are respectively
0
@X
i≥0
x2i
(2i)! −
x2i+1
(2i + 1)!
1
A
−1
,
0
@X
i≥0
x3i
(3i)! −
x3i+1
(3i + 1)!
1
A
−1
,
0
@X
i≥0
x4i
(4i)! −
x4i+1
(4i + 1)!
1
A
−1
,
and so on. (See Carlitz’s review [78] as well as Elizalde and Noy’s article [150] for interesting
results involving several types of order patterns in permutations.)

Many variations on the theme of rises and ascending runs are clearly possible. Lo-
cal order patterns in permutations have been intensely researched, notably by Carlitz
in the 1970’s. Goulden and Jackson [244, Sec. 4.3] offer a general theory of patterns
in sequences and permutations. Special permutations patterns associated with binary
increasing trees are also studied by Flajolet, Gourdon, and Mart´ınez [185] (by combi-
natorial methods) and Devroye [125] (by probabilistic arguments). On another regis-
ter, the longest ascending run has been found above to be of order (log n)/ log log n
in probability. The superﬁcially resembling problem of analysing the length of the
longest increasing sequence in random permutations (elements must be in ascending
order but need not be adjacent) has attracted a lot of attention, but is considerably
harder. This quantity is ∼2√n on average and in probability, as shown by a pene-
trating analysis of the shape of random Young tableaus due to Logan, Shepp, Vershik,
and Kerov [336, 485]. Solving a problem open for over 20 years, Baik, Deift, and Jo-
hansson [19] have eventually determined its limiting distribution. The undemanding
survey by Aldous and Diaconis [7] discusses some of the background of this prob-
lem, while Chapter VIII shows how to derive bounds that are of the right order of
magnitude but rather crude, using saddle-point methods.
EXAMPLE III.25.
Patterns in words.
Take the set of all words W = SEQ{A} over a
ﬁnite alphabet A = {a1, . . . , ar}. A pattern p = p1p2 · · · pk, which is particular word of
length k has been ﬁxed. What is sought is the BGF W (z, u) of W, where u marks the number
of occurrences of pattern p inside a word of W. Results of Chapter I already give access to
W (z, 0), which is the OGF of words not containing the pattern.
In accordance with the inclusion-exclusion principle, one should introduce the class X of
words augmented by distinguishing an arbitrary number of occurrences of p. Deﬁne a cluster
as a maximal collection of distinguished occurrences that have an overlap. For instance, if
p = aaaaa, a particular word may give rise to the particular cluster:
a b a a a a a a a a a a a a a b a a a a a a a a b b
---------------------------------------------------
a a a a a
a a a a a
a a a a a
Then objects of X decompose as sequences of either arbitrary letters from A or clusters:
X = SEQ (A + C) ,
with C the class of all clusters.
Clusters are themselves obtained by repeatedly sliding the pattern, but with the constraint
that it should constantly overlap partly with itself. Let c(z) be the autocorrelation polynomial
of p as deﬁned in Chapter I, and set bc(z) = c(z) −1. A moment’s reﬂection should convince
the reader that zkbc(z)s−1 when expanded describes all the possibilities for forming clusters

III. 7. ADDITIONAL CONSTRUCTIONS
201
of s overlapping occurrences. On the example above, one has bc(z) = z + z2 + z3 + z4, and
a particular cluster of 3 overlapping occurrences corresponds to one of the terms in zkbc(z)2 as
follows:
z5
z
}|
{
a a a a a
z5
a a a
z2
z}|{
a a
× (z + z2 + z3 + z4)
a
z4
z }| {
a a a a
× (z + z2 + z3 + z4).
The OGF of clusters is consequently C(z) = zk/(1 −bc(z)) since this quantity describes all the
ways to write the pattern (zk) and then slide it so that it should overlap with itself (this is given
by (1 −bc(z))−1). A slightly different way of obtaining this expression of C(z) is described in
Note 38 below.
By a similar reasoning, the BGF of clusters is vzk/(1 −vbc(z)), and the BGF of X with
the supplementary variable v marking the number of distinguished occurrences is
X(z, v) =
1
1 −rz −vzk/(1 −vbc(z)).
Finally, the usual inclusion-exclusion argument (change v to u −1) yields W (z, u) =
X(z, u −1). As a result:
For a pattern p with correlation polynomial c(z) and length k, the BGF
of words over an alphabet of cardinality r, where u marks the number of
occurrences of p, is
W (z, u) =
(u −1)c(z) −u
(1 −rz)((u −1)c(z) −u) + (u −1)zk .
The specialization u = 0 gives back the formula already found in Chapter I.
The same
principles clearly apply to weighted models corresponding to unequal letter probabilities, pro-
vided a suitably weighted version of the correlation polynomial is introduced (Note 38 below).
END OF EXAMPLE III.25. □
There are a very large number of formulæ related to patterns in strings. For
instance, BGFs are known for occurrences of one or several patterns under either
Bernoulli or Markov models; see Note 38 below. We refer to Szpankowski’s book [458]
and Lothaire’s chapter [280], where such questions are treated systematically in great
detail. Bourdon and Vall´ee [65] have even succeeded in extending this approach to
dynamical sources of information, thereby extending a large number of previously
known results. Their approach even makes it possible to analyse the occurrence of
patterns in continued fraction representations of real numbers.
 III.36. Moments of number of occurrences. The derivatives of X(z, v) at v = 0 give access
to the factorial moments of the number of occurrences of a pattern. In this way or directly, one
determines
W (z, u) =
1
1 −rz +
zk
(1 −rz)2 (u −1) + 2zk((1 −rz)(c(z) −1) + zk)
(1 −rz)3
(u −1)2
2!
+ · · · .
The mean number of occurrences is r−n times the coefﬁcient of zn in the coefﬁcient of (u−1)
and is (n −k + 1)r−k, as anticipated. The coefﬁcient of (u −1)2/2! is of the form
2r−2k
(1 −rz)3 + 2r−k(1 + 2kr−k −c(1/r))
(1 −rz)2
+ P(z)
1 −rz ,

202
III. PARAMETERS AND MULTIVARIATE GFS
with P a polynomial. There results that the variance of the number of occurrences is of the
form
αn + β,
α = r−k(2c(1/r) −1 + r−k(1 −2k)).
Consequently, the distribution is concentrated around its mean. (See also the discussion of
“Borges’ Theorem” in Chapter I, p. 58.)

 III.37. Words with ﬁxed repetitions. Let W ⟨s⟩(z) = [us]W (z, u) be the OGF of words
containing a pattern exactly s times. One has, for s > 0 and s = 0 respectively,
W ⟨s⟩(z) = zkN(z)s−1
D(z)s+1 ,
W ⟨0⟩(z) = c(z)
D(z),
with N(z) and D(z) given by
N(z) = (1 −rz)(c(z) −1) + zk,
D(z) = (1 −rz)c(z) + zk.
The expression of W ⟨0⟩is in agreement with Chapter I, Equation (48).

 III.38. Patterns in Bernoulli sequences. Let A be an alphabet where letter α has probabil-
ity πα and consider the Bernoulli model where letters in words are chosen independently. Fix a
pattern p = p1 · · · pk and deﬁne the ﬁnite language of protrusions as
Γ =
[
i : ci̸=0
{pi+1pi+2 · · · pk},
where the union is over all correlation positions of the pattern. Deﬁne now the correlation
polynomial γ(z) (relative to p and the πα) as the generating polynomial of the ﬁnite language
of protrusions weighted by πα. For instance, p = ababa gives rise to Γ = {ǫ, ba, baba} and
γ(z) = 1 + πaπbz2 + π2
aπ2
bz4.
Then, the BGF of words with z marking length and u marking the number of occurrences of p
is
W (z, u) =
(u −1)γ(z) −u
(1 −z)((u −1)γ(z) −u) + (u −1)π[p]zk ,
where π[p] is the product of the probabilities of letters of p.

 III.39. Patterns in binary trees. Consider the class B of pruned binary trees. An occurrence
of pattern t in a tree τ is deﬁned by a node whose “dangling subtree” is isomorphic to t. Let p
be the size of t. The BGF B(z, u) of class B where u marks the number of occurrences of t is
sought.
The OGF of B is B(z) = (1 −√1 −4z)/(2z). The quantity vB(zv) is the BGF of B
with v marking external nodes. By virtue of the pointing operation, the quantity
Uk :=
„ 1
k!∂k
v (vB(zv))
«
v=1
,
describes trees with k distinct external nodes distinguished (pointed). The quantity
V :=
X
Ukuk(zp)k
satisﬁes
V = (vB(zv))v=1+uzp ,
by virtue of Taylor’s formula. It is also the BGF of trees with distinguished occurrences of t.
Setting v 7→u −1 in V then gives back B(z, u) as
B(z, u) = 1
2z
“
1 −
p
1 −4z −4(u −1)zp+1
”
.
In particular
B(z, 0) = 1
2z
“
1 −
p
1 −4z + 4zp+1
”
gives the OGF of trees not containing pattern t. The method generalizes to any simple variety
of trees and it can be used to prove that the factored representation (as a directed acyclic graph)
of a random tree of size n has expected size O(n/√log n); see [209].


III. 8. EXTREMAL PARAMETERS
203
III. 8. Extremal parameters
Apart from additively inherited parameters already examined at length in this
chapter, another important category is that of parameters deﬁned by a maximum rule.
Two major cases are the largest component in a combinatorial structure (for instance,
the largest cycle of a permutation) and the maximum degree of nesting of construc-
tions in a recursive structure (typically, the height of a tree). In this case, bivariate
generating functions are of little help. The standard technique consists in introducing
a collection of univariate generating functions deﬁned by imposing a bound on the
parameter of interest. Such GFs can then be constructed by the symbolic method in
its univariate version.
III. 8.1. Largest components. Consider a construction B = Φ{A}, where Φ
may involve an arbitrary combination of basic constructions, and assume here for
simplicity that the construction for B is a non–recursive one. This corresponds to a
relation between generating functions
B(z) = Ψ[A(z)],
where Ψ is the functional that is the “image” of the combinatorial construction Φ.
Elements of A thus appear as components in an object β ∈B. Let B⟨b⟩denote the
subclass of B formed with objects whose A–components all have a size at most b. The
GF of B⟨b⟩is obtained by the same process as that of B itself, save that A(z) should
be replaced by the GF of elements of size at most b. Thus,
B⟨b⟩(z) = Ψ[TbA(z)],
where the truncation operator is deﬁned on series by
Tbf(z) =
b
X
n=0
fnzn
(f(z) =
∞
X
n=0
fnzn).
Several cases of this situation have already been encountered in earlier chapters.
For instance, the cycle decomposition of permutations translated by
P(z) = exp

log
1
1 −z

gives more generally the EGF of permutations with longest cycle ≤b,
P ⟨b⟩(z) = exp
z
1 + z2
2 + · · · + zb
b

,
which involves the truncated logarithm. Similarly, the EGF of words over an m–ary
alphabet
W(z) = (ez)m
leads to the EGF of words such that each letter occurs at most b times:
W ⟨b⟩(z) =

1 + z
1! + z2
2! + · · · + zb
b!
m
,

204
III. PARAMETERS AND MULTIVARIATE GFS
which now involves the truncated exponential. One ﬁnds similarly the EGF of set
partitions with largest block of size at most b,
S⟨b⟩(z) = exp
 z
1! + z2
2! + · · · + zb
b!

.
A slightly less direct example is that of the longest run in a sequence of binary
draws. The collection W of binary strings over the alphabet {a, b} admits the decom-
position
W = SEQ(a) · SEQ(b SEQ(a)),
corresponding to a “scansion” dictated by the occurrences of the letter b. The corre-
sponding OGF then appears under the form
W(z) = Y (z) ·
1
1 −zY (z)
where Y (z) =
1
1 −z
corresponds to Y = SEQ(a). Thus, the OGF of strings with at most k −1 consecutive
occurrences of the letter a obtains upon replacing Y (z) by its truncation:
W ⟨k⟩(z) = Y ⟨k⟩(z)
1
1 −zY ⟨k⟩(z) where Y ⟨k⟩(z) = 1 + z + z2 + · · · + zk−1,
so that
W ⟨k⟩(z) =
1 −zk
1 −2z + zk+1 .
Such generating functions are thus easy to derive. The asymptotic analysis of
their coefﬁcients is however often hard when compared to additive parameters, owing
to the need to rely on complex analytic properties of the truncation operator. The bases
of a general asymptotic theory have been laid by Gourdon [246].
 III.40. Smallest components. The EGF of permutations with smallest cycle of size > b is
exp(−z
1 −z2
2 −· · · −zb
b )
1 −z
.
A symbolic theory of smallest components in combinatorial structures is easily developed as
regards GFs. Elements of the corresponding asymptotic theory are provided by Panario and
Richmond in [385].

III. 8.2. Height. The degree of nesting of a recursive construction is a general-
ization of the notion of height in the simpler case of trees. Consider for instance a
recursively deﬁned class
B = Φ{B},
where Φ is a construction. Let B[h] denote the subclass of B composed solely of ele-
ments whose construction involves at most h applications of Φ. We have by deﬁnition
B[h+1] = Φ{B[h]}.
Thus, with Ψ the image functional of construction Φ, the corresponding GFs are de-
ﬁned by a recurrence,
B[h+1] = Ψ[B[h]].
It is usually convenient to start the recurrence with the initial condition B[−1](z) = 0.
(This discussion is related to semantics of recursion, p. 31.)

III. 8. EXTREMAL PARAMETERS
205
Consider for instance general plane trees deﬁned by
G = N × SEQ(G)
so that
G(z) =
z
1 −G(z).
Deﬁne the height of a tree as the number of edges on its longest branch. Then the set
of trees of height ≤h satisﬁes the recurrence
G[0] = N, G[h+1] = N × SEQ(G[h]).
Accordingly, the OGF of trees of bounded height satisﬁes
G[−1](z) = 0, G[0](z) = z, G[h+1](z) =
z
1 −G[h](z).
The recurrence unwinds and one ﬁnds
(75)
G[h](z) =
z
1 −
z
1 −
z
...
1 −z
,
where the number of stages in the fraction equals b. This is the ﬁnite form (tech-
nically known as a “convergent”) of a continued fraction expansion. From implied
linear recurrences and an analysis based on Mellin transforms, de Bruijn, Knuth, and
Rice [113] have determined the average height of a general plane tree to be ∼√πn.
We provide a proof of this fact in Chapter V dedicated to applications of rational and
meromorphic asymptotics.
For plane binary trees deﬁned by
B = Z + B × B
so that
B(z) = z + (B(z))2,
(size is the number of external nodes), the recurrence is
B[0](z) = z, B[h+1](z) = z + (B[h](z))2.
In this case, the B[h] are the approximants to a “continuous quadratic form”, namely
B[h](z) = z + (z + (z + (· · · )2)2)2.
These are polynomials of degree 2h for which no closed form expression is known,
nor even likely to exist6. However, using complex asymptotic methods and singularity
analysis, Flajolet and Odlyzko [197] have shown that the average height of a binary
plane tree is ∼2√πn.
For Cayley trees, ﬁnally, the deﬁning equation is
T = Z ⋆SET(T )
so that
T (z) = zeT (z).
The EGF of trees of bounded height satisfy the recurrence
T [0](z) = z, T [h+1](z) = zeT [h](z).
6These polynomials are exactly the much studied Mandelbrot polynomials whose behaviour in the
complex plane gives rise to extraordinary graphics.

206
III. PARAMETERS AND MULTIVARIATE GFS
We are now confronted with a “continuous exponential”,
T [h](z) = zezeze... zez
.
The average height was found by R´enyi and Szekeres who appealed again to complex
asymptotics and found it to be ∼
√
2πn.
These examples show that height statistics are closely related to iteration theory.
Except in a few cases like general plane trees, normally no algebra is available and
one has to resort to complex analytic methods as exposed in forthcoming chapters.
III. 8.3. Averages and moments. For extremal parameters, the GF of mean val-
ues obey a general pattern. Let F be some combinatorial class with GF f(z). Consider
for instance an extremal parameter χ such that f [h](z) is the GF of objects with χ-
parameter at most h. The GF of objects for which χ = h exactly is equal to
f [h](z) −f [h−1](z).
Thus differencing gives access to the probability distribution of height over F. The
generating function of cumulated values (providing mean values after normalization)
is then
Ξ(z)
=
∞
X
h=0
h
h
f [h](z) −f [h−1](z)
i
=
∞
X
h=0
h
f(z) −f [h](z)
i
,
as is readily checked by rearranging the second sum, or equivalently using summation
by parts.
For maximum component size, the formulæ involve truncated Taylor series. For
height, analysis involves in all generality the differences between the ﬁxed point of a
functional Φ (the GF f(z)) and the approximations to the ﬁxed point (f [h](z)) pro-
vided by iteration. This is a common scheme in extremal statistics.
 III.41. Hierarchical partitions. Let ε(z) = ez −1. The generating function
ε(ε(· · · (ε(z))))
(h times).
can be interpreted as the EGF of certain hierarchical partitions. (Such structures show up in
statistical classiﬁcation theory [475, 476].)

 III.42. Balanced trees. Balanced structures lead to counting GFs close to the ones obtained
for height statistics. The OGF of balanced 2-3 trees of height h counted by the number of leaves
satisﬁes the recurrence
Z[h+1](z) = Z[h](z2 + z3) = (Z[h](z))2 + (Z[h](z))3,
which can be expressed in terms of the iterates of σ(z) = z2 + z3. It is also possible to express
the OGF of cumulated values of the number of internal nodes in such trees.

 III.43. Extremal statistics in random mappings. One can express the EGFs relative to the
largest cycle, longest branch, and diameter of functional graphs. Similarly for the largest tree,
largest component. [Hint: see [198] for details.]

 III.44. Deep nodes in trees. The BGF giving the number of nodes at maximal depth in
a general plane tree or a Cayley tree can be expressed in terms of a continued fraction or a
continuous exponential.


III. 9. PERSPECTIVE
207
III. 9. Perspective
The message of this chapter is that we can use the symbolic method not just to
count combinatorial objects but also to quantify their properties. The relative ease
with which we are able to do so is testimony to the power of the method as major
organizing principle of analytic combinatorics.
The global framework of the symbolic method leads us to a natural structural cat-
egorization of parameters of combinatorial objects. First, the concept of inherited pa-
rameters permits a direct extension of the already seen formal translation mechanisms
from combinatorial structures to GFs, for both labelled and unlabelled objects—this
leads to MGFs useful for solving a broad variety of classical combinatorial problems.
Second, the adaptation of the theory to recursive parameters provides information
about trees and similar structures, this even in the absence of explicit representations
of the associated MGFs. Third, extremal parameters which are deﬁned by a maximum
rule (rather than an additive rule) can be studied by analysing families of univariate
GFs. Yet another illustration of the power of the symbolic method is found in the
notion of complete GFs, which in particular enable us to study Bernoulli trials and
branching processes.
As we shall see starting with Chapter IV, these approaches become especially
powerful since they serve as the basis for the asymptotic analysis of properties of
structures. Not only does the symbolic method provide precise information about
particular parameters, but also it paves the way for the discovery of general theorems
that tell us what to expect about a broad variety of combinatorial types.
Multivariate generating functions are a common tool from classical combinatorial analy-
sis. Comtet’s book [98] is once more an excellent source of examples. A systematization of
multivariate generating functions for inherited parameters is given in the book by Goulden and
Jackson [244].
In contrast generating functions for cumulated values of parameters (related to averages)
seemed to have received relatively little attention until the advent of digital computers and
the analysis of algorithms. Many important techniques are implicit in Knuth’s treatises, es-
pecially [306, 307].
Wilf discusses related issues in his book [496] and the paper [494].
Early systems specialized to tree algorithms have been proposed by Flajolet and Steyaert in
the 1980s [169, 213, 214, 455]; see also Berstel and Reutenauer’s work [44]. Some of the
ideas developed there initially drew their inspiration from the well established treatment of
formal power series in noncommutative indeterminates; see the books by Eilenberg [149] and
Salomaa–Soittola [423] as well as the proceedings edited by Berstel [45]. Several computations
in this area can nowadays even be automated with the help of computer algebra systems, as
shown by Flajolet, Salvy, and Zimmermann [206, 424, 515].


Part B
COMPLEX ASYMPTOTICS


IV
Complex Analysis, Rational and
Meromorphic Asymptotics
The shortest path between two truths in the real domain
passes through the complex domain.
— JACQUES HADAMARD1
Contents
IV. 1.
Generating functions as analytic objects
212
IV. 2.
Analytic functions and meromorphic functions
216
IV. 3.
Singularities and exponential growth of coefﬁcients
226
IV. 4.
Closure properties and computable bounds
236
IV. 5.
Rational and meromorphic functions
242
IV. 6.
Localization of singularities
250
IV. 7.
Singularities and functional equations
261
IV. 8.
Perspective
272
Generating functions are a central concept of combinatorial theory. In Part A,
we have treated them as formal objects, that is, as formal power series. Indeed, the
major theme of Chapters I–III has been to demonstrate how the algebraic structure
of generating functions directly reﬂects the structure of combinatorial classes. From
now on, we examine generating functions in the light of analysis. This point of view
involves assigning values to the variables that appear in generating functions.
Comparatively little beneﬁt results from assigning only real values to the vari-
able z that ﬁgures in a univariate generating function. In contrast, assigning complex
values turns out to have serendipitous consequences. When we do so, a generating
function becomes a geometric transformation of the complex plane. This transforma-
tion is very regular near the origin—one says that it is analytic (or holomorphic). In
other words, near 0, it only effects a smooth distortion of the complex plane. Farther
away from the origin, some cracks start appearing in the picture. These cracks—the
digniﬁed name is singularities—correspond to the disappearance of smoothness. It
turns out that a function’s singularities provide a wealth of information regarding the
function’s coefﬁcients, and especially their asymptotic rate of growth. Adopting a
geometric point of view for generating functions has a large pay-off.
By focussing on singularities, analytic combinatorics treads in the steps of many
respectable older areas of mathematics. For instance, Euler recognized that the fact
for the Riemann zeta function ζ(s) to become inﬁnite at 1 implies the existence of
inﬁnitely many prime numbers, while Riemann, Hadamard, and de la Vall´ee-Poussin
uncovered deeper connections between quantitative properties of prime numbers and
singularities of 1/ζ(s).
1Quoted in The Mathematical Intelligencer, v. 13, no. 1, Winter 1991.
211

212
IV. COMPLEX ANALYSIS, RATIONAL AND MEROMORPHIC ASYMPTOTICS
The purpose of this chapter is largely to serve as an accessible introduction or a
refresher of basic notions regarding analytic functions. We start by recalling the el-
ementary theory of functions and their singularities in a style tuned to the needs of
analytic combinatorics. Cauchy’s integral formula expresses coefﬁcients of analytic
functions as contour integrals. Suitable uses of Cauchy’s integral formula then make
it possible to estimate such coefﬁcients by suitably selecting an appropriate contour
of integration. For the common case of functions that have singularities at a ﬁnite
distance, the exponential growth formula relates the location of the singularities clos-
est to the origin—these are also known as dominant singularities—to the exponential
order of growth of coefﬁcients. The nature of these singularities then dictates the ﬁne
structure of the asymptotics of the function’s coefﬁcients, especially the subexponen-
tial factors involved.
As regards generating functions, combinatorial enumeration problems can be
broadly categorized according to a hierarchy of increasing structural complexity. At
the most basic level, we encounter scattered classes, which are simple enough, so that
the associated generating function and coefﬁcients can be made explicit. (Examples of
Part A include binary and general plane trees, Cayley trees, derangements, mappings,
and set partitions). In that case, elementary real-analysis techniques usually sufﬁce
to estimate asymptotically counting sequences. At the next, intermediate, level, the
generating function is still explicit, but its form is such that no simple expression is
available for coefﬁcients. This is where the theory developed in this and the next chap-
ters comes into play. It usually sufﬁces to have an expression for a generating function,
but not necessarily its coefﬁcients, so as to be able to deduce precise asymptotic es-
timates of its coefﬁcients. (Surjections, generalized derangements, unary-binary trees
are easily subjected to this method. A striking example, that of trains, is detailed in
Section IV. 4.) Properties of analytic functions then make this analysis depend only on
local properties of the generating function at a few points, its dominant singularities.
The third, highest, level, within the perspective of analytic combinatorics, comprises
generating functions that can no longer be made explicit, but are only determined by a
functional equation. This covers structures deﬁned recursively or implicitly by means
of the basic constructors of Part A. The analytic approach even applies to a large
number of such cases. (Examples include simple families of trees, balanced trees,
and the enumeration of certain molecules treated at the end of this chapter. Another
characteristic example is that of nonplane unlabelled trees treated in Chapter VII.)
As we are going to see in this chapter and the next four ones, the analytic method-
ology applies to almost all the combinatorial classes studied in Part A, which are pro-
vided by the symbolic method. In the present chapter we carry out this programme
for rational functions and meromorphic functions, where the latter are deﬁned by the
fact their singularities are simply poles.
IV. 1. Generating functions as analytic objects
Generating functions, considered in Part A as purely formal objects subject to
algebraic operations, are now going to be interpreted as analytic objects. In so doing

IV. 1. GENERATING FUNCTIONS AS ANALYTIC OBJECTS
213
–0.2
–0.1
0
0.1
0.2
0.3
0.4
0.5
–0.2
–0.1
0.1
0.2
z
0
1
2
3
–1
1
z
FIGURE IV.1. Left: the graph of the Catalan OGF, f(z), for z ∈(−1
4, + 1
4); right: the
graph of the derangement EGF, g(z), for z ∈(−1, +1).
one gains an easy access to the asymptotic form of their coefﬁcients. This informal
section offers a glimpse of themes that form the basis of Chapters IV–VII.
In order to introduce the subject softly, let us start with two simple generating
functions, one, f(z), being the OGF of the Catalan numbers (cf G(z), p. 33), the
other, g(z), being the EGF of derangements (cf D(1)(z), p. 113):
(1)
f(z) = 1
2
 1 −
√
1 −4z

,
g(z) = exp(−z)
1 −z
.
At this stage, the forms above are merely compact descriptions of formal power series
built from the elementary series
(1 −y)−1
=
1 + y + y2 + · · · ,
(1 −y)1/2
=
1 −1
2y −1
8y2 −· · · ,
exp(y)
=
1 + 1
1!y + 1
2!y2 + · · · ,
by standard composition rules. Accordingly, the coefﬁcients of both GFs are known
in explicit form
fn := [zn]f(z) = 1
n
2n −2
n −1

,
gn := [zn]g(z) =
 1
0! −1
1! + 1
2! −· · · + (−1)n
n!

.
Stirling’s formula and comparison with the alternating series giving exp(−1) provide
respectively
(2)
fn
∼
n→∞
4n
√
πn3 ,
gn =
∼
n→∞e−1 .= 0.36787.
Our purpose now is to provide intuition on how such approximations could be
derived without a recourse to explicit forms. We thus examine, heuristically for the
moment, the direct relationship between the asymptotic forms (2) and the structure of
the corresponding generating functions in (1).
Granted the growth estimates available for fn and gn, it is legitimate to substitute
in the power series expansions of the GFs f(z) and g(z) any real or complex value
of a small enough modulus, the upper bounds on modulus being ρf = 1
4 (for f) and

214
IV. COMPLEX ANALYSIS, RATIONAL AND MEROMORPHIC ASYMPTOTICS
–0.3
–0.2
–0.1
0
0.1
0.2
0.3
0.1
0.2
–0.3
–0.2
–0.1
0
0.1
0.2
0.3
0.1 0.2
0.3
0.4
0.5
0.6
0.7
–0.4
–0.2
0
0.2
0.4
0.1
0.2
0.3
0.4
0.5
–0.6
–0.4
–0.2
0
0.2
0.4
0.6
1
1.2
1.4
1.6
1.8
FIGURE IV.2. The images of regular grids by f(z) (left) and g(z) (right).
ρg = 1 (for g). Figure 1 represents the graph of the resulting functions when such
real values are assigned to z. The graphs are smooth, representing functions that are
differentiable any number of times for z interior to the interval (−ρ, +ρ). However, at
the right boundary point, smoothness stops: g(z) become inﬁnite at z = 1, and so it
even ceases to be ﬁnitely deﬁned; f(z) does tend to the limit 1
2 as z →( 1
4)−, but its
derivative becomes inﬁnite there. Such special points at which smoothness stops are
called singularities, a term that will acquire a precise meaning in the next sections.
Observe also that, in spite of the series expressions being divergent outside the
speciﬁed intervals, the functions f(z) and g(z) can be continued in certain regions: it
sufﬁces to make use of the global expressions of Equation (1), with exp and √being
assigned their usual real-analytic interpretation. For instance:
f(−1) = 1
2

1 −
√
5

,
g(−2) = e2
3 .
Such continuation properties, most notably to the complex realm, will prove essential
in developing efﬁcient methods for coefﬁcient asymptotics.
One may proceed similarly with complex numbers, starting with numbers whose
modulus is less than the radius of convergence of the series deﬁning the GF. Figure 2
displays the images of regular grids by f and g, as given by (1). This illustrates the fact
that a regular grid transforms into an orthogonal network of curves and more precisely
that f and g preserve angles—this property corresponds to complex differentiability
and is equivalent to analyticity to be introduced shortly. The singularity of f is clearly
perceptible on the right of its diagram, since, at z = 1
4 (corresponding to f(z) = 1
2),
the function f folds lines and divides angles by a factor of 2.
Let us now turn to coefﬁcient asymptotics. As is expressed by (2), the coefﬁcients
fn and gn each belong to a general asymptotic type for coefﬁcients of a function F,

IV. 1. GENERATING FUNCTIONS AS ANALYTIC OBJECTS
215
namely,
[zn]F(z) = Anθ(n),
corresponding to an exponential growth factor An modulated by a tame factor θ(n),
which is subexponential. Here, one has A = 4 for fn and A = 1 for gn; also,
θ(n) ∼1
4(
√
πn3)−1 for fn and θ(n) ∼e−1 for gn. Clearly, A should be related to the
radius of convergenceof the series. We shall see that invariably, for combinatorial gen-
erating functions, the exponential rate of growth is given by A = 1/ρ, where ρ is the
ﬁrst singularity encountered along the positive real axis (Theorem IV.6). In addition,
under general complex-analytic conditions, it will be established that θ(n) = O(1) is
systematically associated to a simple pole of the generating function (Theorem IV.10,
p. 245), while θ(n) = O(n−3/2) systematically arises from a singularity that is of the
square-root type (Chapters VI and VII). In summary, as this chapter and the next ones
will copiously illustrate, the coefﬁcient formula
(3)
[zn]F(z) = Anθ(n),
with its exponentially dominating term and its subexponential factor, is central. We
have:
First Principle of Coefﬁcient Asymptotics. The location of a function’s
singularities dictates the exponential growth (An) of its coefﬁcients.
Second Principle of Coefﬁcient Asymptotics. The nature of the function’s
singularities determines the associate subexponential factor (θ(n)).
Observe that the rescaling rule,
[zn]F(z) = ρ−n[zn]F(ρz),
enables one to normalize functions so that they are singular at 1. Then various the-
orems, starting with Theorems IV.9 and IV.10, provide sufﬁcient conditions under
which the following central implication is valid,
(4)
h(z) ∼σ(z)
=⇒
[zn]h(z) ∼[zn]σ(z).
There h(z), whose coefﬁcients are to be estimated, is a function singular at 1 and σ(z)
is a local approximation near the singularity; usually σ is a much simpler function,
typically like (1 −z)α logβ(1 −z) whose coefﬁcients are comparatively easy to esti-
mate (Chapter VI). The relation (4) expresses a mapping between asymptotic scales
of functions near singularities and asymptotics scales of coefﬁcients. Under suitable
conditions, it then sufﬁces to estimate a function locally at a few distinguished points
(singularities), in order to estimate its coefﬁcients asymptotically.
 IV.1. Euler, the discrete, and the continuous.
Eulers’s proof of the existence of inﬁnitely
many prime numbers illustrates in a striking manner the way analysis of generating functions
can inform us on the discrete realm. Deﬁne, for real s > 1 the function
ζ(s) :=
∞
X
n=1
1
ns ,

216
IV. COMPLEX ANALYSIS, RATIONAL AND MEROMORPHIC ASYMPTOTICS
known as the Riemann zeta function. The decomposition (p ranges over the prime numbers
2, 3, 5, . . .)
(5)
ζ(s) =
„
1 + 1
2s + 1
22s + · · ·
« „
1 + 1
3s + 1
32s + · · ·
« „
1 + 1
5s + 1
52s + · · ·
«
· · ·
=
Y
p
„
1 −1
ps
«−1
expresses precisely the fact that each integer has a unique decomposition as a product of primes.
Analytically, the identity (5) is easily checked to be valid for all s > 1. Now suppose that there
were only ﬁnitely many primes. Let s tend to 1+ in (5). Then, the left hand side becomes
inﬁnite, while the right hand side tends to the ﬁnite limit Q
p(1 −1/p)−1: a contradiction has
been reached.

 IV.2. Elementary transfers. Elementary series manipulation yield the following general re-
sult: Let h(z) be a power series with radius of convergence > 1 and assume that h(1) ̸= 0;
then one has
[zn] h(z)
1 −z ∼h(1),
[zn]h(z)
√
1 −z ∼−h(1)
2
√
πn3 ,
[zn]h(z) log
1
1 −z ∼h(1)
n .
See Bender’s survey [29] for many similar statements.

 IV.3. Asymptotics of generalized derangements. The EGF of permutations without cycles of
length 1 and 2 satisﬁes (p. 113)
j(z) = e−z−z2/2
1 −z
with
j(z) ∼
z→1
e−3/2
1 −z .
Analogy with derangements suggests that [zn]j(z)
∼
n→∞e−3/2. [For a proof, use Note 2 or
refer to Example 8.] Here is a table of exact values of [zn]j(z) (with relative error of the
approximation by e−3/2 in parentheses):
n = 5
n = 10
n = 20
n = 50
jn :
0.2
0.22317
0.2231301600
0.2231301601484298289332804707640122
error :
(10−1)
(2 · 10−4)
(3 · 10−10)
(10−33)
The quality of the asymptotic approximation is extremely good, such a property being invariably
attached to polar singularities.

IV. 2. Analytic functions and meromorphic functions
Analytic functions are a primary mathematical concept of asymptotic theory. They
can be characterized in two essentially equivalent ways (see IV. 2.1): by means of
convergent series expansions (`a la Cauchy and Weierstraß) and by differentiability
properties (`a la Riemann). The ﬁrst aspect is directly related to the use of generating
functions for enumeration; the second one allows for a powerful abstract discussion
of closure properties that usually requires little computation.
Integral calculus with analytic functions (see IV. 2.2) assumes a shape radically
different from what it is in the real domain: integrals become quintessentially inde-
pendent of details of the integration contour—certainly the prime example of this fact
is Cauchy’s famous residue theorem. Conceptually, this independence makes it pos-
sible to relate properties of a function at a point (e.g., the coefﬁcients of its expansion
at 0) to its properties at another far-away point (e.g., its residue at a pole).

IV. 2. ANALYTIC AND MEROMORPHIC FUNCTIONS
217
The presentation in this section and the next one constitutes an informal review2
of basic properties of analytic functions tuned to the needs of asymptotic analysis of
counting sequences. The entry in APPENDIX B: Equivalent deﬁnitions of analyticity,
p. 687 provides further information, in particular a proof of the Basic Equivalence
Theorem, Theorem IV.1 below. For a detailed treatment, we refer the reader to one
of the many excellent treatises on the subject, like the books by Dieudonn´e [129],
Henrici [265], Hille [269], Knopp [299], Titchmarsh [469], or Whittaker and Wat-
son [492].
IV. 2.1. Basics. We shall consider functions deﬁned in certain regions of the
complex domain C. By a region is meant an open subset Ωof the complex plane
that is connected. Here are some examples:
simply connected domain
slit complex plane
indented disc
annulus
Classical treatises teach us how to extend to the complex domain the standard
functions of real analysis: polynomials are immediately extended as soon as complex
addition and multiplication have been deﬁned, while the exponential is deﬁnable by
means of Euler’s formula. One has for instance
z2 = (x2 −y2) + 2ixy,
ez = ex cos y + iex sin y,
if z = x + iy, that is, x = ℜ(z) and y = ℑ(z) are the real and imaginary parts of z.
Both functions are consequently deﬁned over the whole complex plane C.
The square-root and the logarithm are conveniently described in polar coordinates
by
(6)
√z = √ρeiθ/2,
log z = log ρ + iθ,
if z = ρeiθ. One can take the domain of validity of (6) to be the complex plane slit
along the axis from 0 to −∞, that is, restrict θ to the open interval (−π, +π), in which
case the deﬁnitions above specify what is known as the principal determination. There
is no way for instance to extend by continuity the deﬁnition of √z in any domain
containing 0 in its interior since, for a > 0 and z →−a, one has √z →i√a as
z →−a from above, while √z →−i√a as z →−a from below. This situation is
depicted here:
2The reader previously unfamilar with the theory of analytic functions should essentially be able to
adopt Theorems IV.1 and IV.2 as “axioms” and start from there using basic deﬁnitions and a fair knowledge
of elementary calculus. Figure 18 at the end of this chapter (p. 273) recapitulates the main results of
relevance to Analytic Combinatorics.

218
IV. COMPLEX ANALYSIS, RATIONAL AND MEROMORPHIC ASYMPTOTICS
+i√a
−i√a
0
√a
The values of √z
as z varies along |z| = a.
The point z = 0 where several determinations “meet” is accordingly known as a
branch point.
Analytic functions. First comes the main notion of an analytic function that
arises from convergent series expansions and is closely related to the notion of gener-
ating function encountered in previous chapters.
Deﬁnition IV.1. A function f(z) deﬁned over a region Ωis analytic at a point z0 ∈Ω
if, for z in some open disc centred at z0 and contained in Ω, it is representable by a
convergent power series expansion
(7)
f(z) =
X
n≥0
cn(z −z0)n.
A function is analytic in a region Ωiff it is analytic at every point of Ω.
As derived from an elementary property of power series, given a function f that is
analytic at a point z0, there exists a disc (of possibly inﬁnite radius) with the property
that the series representing f(z) is convergent for z inside the disc and divergent for z
outside the disc. The disc is called the disc of convergence and its radius is the radius
of convergence of f(z) at z = z0, which will be denoted by Rconv(f; z0). Quite ele-
mentarily, the radius of convergence of a power series conveys information regarding
the rate at which its coefﬁcients grow; see Subsection IV. 3.2 below for developments.
It is also easy to prove by simple series rearrangement (see APPENDIX B: Equivalent
deﬁnitions of analyticity, p. 687) that if a function is analytic at z0, it is then analytic
at all points interior to its disc of convergence.
Consider for instance the function f(z) = 1/(1 −z) deﬁned over C \ {1} in the
usual way via complex division. It is analytic at 0 by virtue of the geometric series
sum,
1
1 −z =
X
n≥0
1 · zn,
which converges in the disc |z| < 1. At a point z0 ̸= 1, we may write
(8)
1
1 −z
=
1
1 −z0 −(z −z0) =
1
1 −z0
1
1 −z−z0
1−z0
=
X
n≥0

1
1 −z0
n+1
(z −z0)n.
The last equation shows that f(z) is analytic in the disc centred at z0 with radius
|1 −z0|, that is, the interior of the circle centred at z0 and passing through the point 1.
In particular Rconv(f, z0) = |1 −z0| and f(z) is globally analytic in the punctured
plane C \ {1}.

IV. 2. ANALYTIC AND MEROMORPHIC FUNCTIONS
219
The last example illustrates the deﬁnition of analyticity. However, the series re-
arrangement approach that it uses might be difﬁcult to carry out for more complicated
functions. In other words, a more manageable approach to analyticity is called for.
The differentiability properties developed next provide such an approach.
Differentiable (holomorphic) functions. The next important notion is a geomet-
ric one based on differentiability.
Deﬁnition IV.2. A function f(z) deﬁned over a region Ωis called complex-differen-
tiable (also holomorphic) at z0 if the limit, for complex δ,
lim
δ→0
f(z0 + δ) −f(z0)
δ
exists. (In particular, the limit is independent of the way δ tends to 0 in C.) This limit
is denoted as usual by f ′(z0) or
d
dzf(z)

z0. A function is complex-differentiable in Ω
iff it is complex-differentiable at every z0 ∈Ω.
Clearly, if f(z) is complex-differentiable at z0 and f ′(z0) ̸= 0, it acts locally as a
linear transformation:
f(z) −f(z0) ∼f ′(z0)(z −z0)
(z →z0).
Then f(z) behaves in small regions almost like a similarity transformation (composed
of a translation, a rotation, and a scaling). In particular, it preserves angles3 and inﬁn-
itesimal squares get transformed into inﬁnitesimal squares; see Figure 3 for a render-
ing.
For instance the function √z, deﬁned by (6) in the complex plane slit along the
ray (−∞, 0), is complex-differentiable at any z of the slit plane since
(9)
lim
δ→0
√
z + δ −√z
δ
= lim
δ→0
√z
p
1 + δ/z −1
δ
=
1
2√z ,
which extends the customary proof of real analysis. Similarly, √1 −z is analytic in
the complex plane slit along the ray (1, +∞). More generally, the usual proofs from
real analysis carry over almost verbatim to the complex realm, to the effect that
(f + g)′ = f ′ + g′,
(fg)′ = f ′g + fg′,
 1
f
′
= −f ′
f 2 ,
(f ◦g)′ = (f ′ ◦g)g′.
The notion of complex differentiability is thus much more manageable than the notion
of analyticity.
It follows from a well known theorem of Riemann (see for instance [265, vol. 1,
p 143] and APPENDIX B: Equivalent deﬁnitions of analyticity, p. 687) that analyticity
and complex differentiability are equivalent notions.
Theorem IV.1 (Basic Equivalence Theorem). A function is analytic in a region Ωif
and only if it is complex-differentiable in Ω.
The following are known facts (see again Appendix B): if a function is analytic
(equivalently complex-differentiable) in Ω, it admits (complex) derivatives of any or-
der there. This property markedly differs from real analysis: complex differentiable
3A mapping of the plane that locally preserves angles is also called a conformal map.

220
IV. COMPLEX ANALYSIS, RATIONAL AND MEROMORPHIC ASYMPTOTICS
–8
–6
–4
–2
0
2
4
6
8
2
4
6
8
10
–2
–1
0
1
2
x
–2
–1
0
1
2
y
0
2
4
6
8
10
–2
–1
0
1
2
x
–2
–1
0
1
2
y
–1.5
–1
–0.5
0
0.5
1
1.5
–2
–1
0
1
2
x
–2
–1
0
1
2
y
–8
–6
–4
–2
0
2
4
6
8
–2
–1
0
1
2
x
–2
–1
0
1
2
y
0
2
4
6
8
10
FIGURE IV.3. Multiple views of an analytic function. The image of the domain Ω=
{z
˛˛ |ℜ(z)| < 2, |ℑ(z)| < 2} by f(z) = exp(z) + z + 2: [top] transformation of a
square grid in Ωby f; [middle] the modulus and argument of f(z); [bottom] the real and
imaginary parts of f(z).
(equivalently, analytic) functions are all smooth. Also derivatives of a function are
obtained through term-by-term differentiation of the series representation of the func-
tion.
Meromorphic functions. We ﬁnally introduce meromorphic4 functions that are
mild extensions of the concept of analyticity (or holomorphy) and are essential to the
theory.
The quotient of two analytic functions f(z)/g(z) ceases to be analytic at a point
a where g(a) = 0. However, a simple structure for quotients of analytic functions
prevails.
Deﬁnition IV.3. A function h(z) is meromorphic at z0 iff, for z in a neighbourhood of
z0 with z ̸= z0, it can be represented as f(z)/g(z), with f(z) and g(z) being analytic
4“Holomorphic” and “meromorphic” are words coming from Greek, meaning respectively “of com-
plete form” and “of partial form”.

IV. 2. ANALYTIC AND MEROMORPHIC FUNCTIONS
221
at z0. In that case, it admits near z0 an expansion of the form
(10)
h(z) =
X
n≥−M
hn(z −z0)n.
If h−M ̸= 0 and M ≥1, then h(z) is said to have a pole of order M at z = z0. The
coefﬁcient h−1 is called the residue of h(z) at z = z0 and is written as
Res[h(z); z = z0].
A function is meromorphic in a region iff it is meromorphic at any point of the region.
IV. 2.2. Integrals and residues. A path in a region Ωis described by its param-
eterization, which is a continuous function γ mapping [0, 1] into Ω. Two paths γ, γ′
in Ωhaving the same end points are said to be homotopic (in Ω) if one can be contin-
uously deformed into the other while staying within Ωas in the following examples:
homotopic paths:
A closed path5 is deﬁned by the fact that its end points coincide: γ(0) = γ(1), and
a path is simple if the mapping γ is one-to-one. A closed path is said to be a loop of
Ωif it can be continuously deformed within Ωto a single point; in this case one also
says that the path is homotopic to 0. In what follows we implicitly restrict attention to
paths that are assumed to be rectiﬁable. Unless otherwise stated, all integration paths
will be assumed to be oriented positively.
Integrals along curves in the complex plane are deﬁned in the usual way as curvi-
linear integrals of complex-valued functions. Explicitly: let f(x + iy) be a function
and γ be a path; then,
Z
γ
f(z) dz
:=
Z 1
0
f(γ(t))γ′(t) dt
=
Z 1
0
[AC −BD] dt + i
Z 1
0
[AD + BC] dt,
where f = A+iB and γ′ = C +iD. However integral calculus in the complex plane
is of a radically different nature from what it is on the real line—in a way it is much
simpler and much more powerful. One has:
Theorem IV.2 (Null Integral Property). Let f be analytic in Ωand let λ be a simple
loop of Ω. Then
R
λ f = 0.
5By default, paths used in this book are assumed to be positively oriented piecewise continuously
differentiable (hence rectiﬁable); in addition, closed paths are assumed to be positively oriented.

222
IV. COMPLEX ANALYSIS, RATIONAL AND MEROMORPHIC ASYMPTOTICS
Equivalently, integrals are largely independent of details of contours: for f analytic
in Ω, one has
(11)
Z
γ
f =
Z
γ′ f,
provided γ and γ′ are homotopic (not necessarily closed) paths in Ω. A proof of The-
orem IV.2 is sketched in APPENDIX B: Equivalent deﬁnitions of analyticity, p. 687.
Residues. The important Residue Theorem due to Cauchy relates global prop-
erties of a meromorphic function (its integral along closed curves) to purely local
characteristics at designated points (the residues at poles).
Theorem IV.3 (Cauchy’s residue theorem). Let h(z) be meromorphic in the region Ω
and let λ be a simple loop in Ωalong which the function is analytic. Then
1
2iπ
Z
λ
h(z) dz =
X
s
Res[h(z); z = s],
where the sum is extended to all poles s of h(z) enclosed by λ.
PROOF. (Sketch) To see it in the representative case where h(z) has only a pole at
z = 0, observe by appealing to primitive functions that
Z
λ
h(z) dz =
X
n≥−M
n̸=−1
hn
 zn+1
n + 1

λ
+ h−1
Z
λ
dz
z ,
where the bracket notation

u(z)

λ designates the variation of the function u(z) along
the contour λ. This expression reduces to its last term, itself equal to 2iπh−1, as is
checked by using integration along a circle (set z = reiθ). The computation extends
by translation to the case of a unique pole at z = a.
In the case of multiple poles, we observe that the simple loop can only enclose
ﬁnitely many poles (by compactness). The proof then follows from a simple decom-
position of the interior domain of λ into cells each containing only one pole. Here is
an illustration in the case of three poles.
(Contributions from internal edges cancel.)
□
Global (integral) to local (residues) connections. Here is a textbook example of
a reduction from global to local properties of analytic functions. Deﬁne the integrals
Im :=
Z ∞
−∞
dx
1 + x2m ,

IV. 2. ANALYTIC AND MEROMORPHIC FUNCTIONS
223
and consider speciﬁcally I1. Elementary calculus teaches us that I1 = π since the
antiderivative of the integrand is an arc tangent:
I1 =
Z ∞
−∞
dx
1 + x2 = [arctan x]+∞
−∞= π.
Here is an alternative, and in many ways more fruitful, derivation. In the light
of the residue theorem, we consider the integral over the whole line as the limit of
integrals over large intervals of the form [−R, +R], then complete the contour of
integration by means of a large semi-circle in the upper half-plane, as shown below:
0
i
−R
+R
Let γ be the contour comprised of the interval and the semi-circle. Inside γ, the
integrand has a pole at x = i, where
1
1 + x2 ≡
1
(x + i)(x −i) = −i
2
1
x −i + · · · ,
so that its residue there is −i/2. By the residue theorem, the integral taken over γ is
equal to 2iπ times the residue of the integrand at i. As R →∞, the integral along
the semi-circle vanishes (it is less than πR/(1 + R2) in modulus), while the integral
along the real segment gives I1 in the limit. There results the relation giving I1:
I1 = 2iπ Res

1
1 + x2 ; x = i

= (2iπ)

−i
2

= π.
The evaluation of the integral in the framework of complex analysis rests solely
upon the local expansion of the integrand at special points (here, the point i). This is a
remarkable feature of the theory, one that confers it much simplicity, when compared
to real analysis.
 IV.4. The general integral Im. Let α = exp( iπ
2m) so that α2m = −1. Contour integration
of the type used for I1 yields
Im = 2iπ
m
X
j=1
Res
„
1
1 + x2m ; x = α2j−1
«
,
while, for any β = α2j−1 with 1 ≤j ≤m, one has
1
1 + x2m
∼
x→β
1
2mβ2m−1
1
x −β ≡−β
2m
1
x −β .
As a consequence,
I2m = −iπ
m
`
α + α3 + · · · + α2m−1´
=
π
m sin
π
2m
.
In particular, I2 = π/
√
2, I3 = 2π/3, I4 = π
4
√
2
p
2 +
√
2, and 1
π I5, 1
π I6 are expressible by
radicals, but 1
π I7, 1
π I9 are not. The special cases 1
π I17, 1
π I257 are expressible by radicals.


224
IV. COMPLEX ANALYSIS, RATIONAL AND MEROMORPHIC ASYMPTOTICS
 IV.5. Integrals of rational fractions. Generally, all integrals of rational functions taken over
the whole real line are computable by residues. In particular,
Jm =
Z +∞
−∞
dx
(1 + x2)m ,
Km =
Z +∞
−∞
dx
(12 + x2)(22 + x2) · · · (m2 + x2)
can be explicitly evaluated.

Cauchy’s coefﬁcient formula. Many function-theoreticconsequences derive from
the residue theorem. For instance, if f is analytic in Ω, z0 ∈Ωand λ is a simple loop
of Ωencircling z0, one has
(12)
f(z0) =
1
2iπ
Z
λ
f(ζ)
dζ
ζ −z0
.
This follows directly since
Res [f(ζ)/(ζ −z0); ζ = z0] = f(z0).
Then, by differentiation with respect to z0 under the integral sign, one gets similarly
(13)
1
k!f (k)(z0) =
1
2iπ
Z
λ
f(ζ)
dζ
(ζ −z0)k+1 .
The values of a function and its derivatives at a point can thus be obtained as values of
integrals of the function away from that point. The world of analytic functions is a very
gentle one in which to live: contrary to real analysis, a function is differentiable any
number of times as soon as it is differentiable once. Also, Taylor’s formula invariably
holds: as soon as f(z) is analytic at z0, one has
(14)
f(z) = f(z0) + f ′(z0)(z −z0) + 1
2!f ′′(z0)(z −z0)2 + · · · ,
with the representation being convergent in a small disc centred at z0. [Proof: a veri-
ﬁcation from (12) and (13), or a series rearrangement as in (B.7), p. 688.]
A very important application of the residue theorem concerns coefﬁcients of ana-
lytic functions.
Theorem IV.4 (Cauchy’s Coefﬁcient Formula). Let f(z) be analytic in a region con-
taining 0 and let λ be a simple loop around 0 that is positively oriented. Then the
coefﬁcient [zn]f(z) admits the integral representation
fn ≡[zn]f(z) =
1
2iπ
Z
λ
f(z) dz
zn+1 .
PROOF. This formula follows directly from the equalities
1
2iπ
Z
λ
f(z) dz
zn+1 = Res

f(z)z−n−1; z = 0

= [zn]f(z),
of which the ﬁrst follows from the residue theorem, and the second from the identiﬁ-
cation of the residue at 0 as a coefﬁcient.
□
Analytically, the coefﬁcient formula allows one to deduce information about the
coefﬁcients from the values of the function itself, using adequately chosen contours of
integration. It thus opens the possibility of estimating the coefﬁcients [zn]f(z) in the
expansion of f(z) near 0 by using information on f(z) away from 0. The rest of this
chapter will precisely illustrate this process in the case of rational and meromorphic

IV. 2. ANALYTIC AND MEROMORPHIC FUNCTIONS
225
functions. Observe also that the residue theorem provides the simplest known proof
of the Lagrange inversion theorem (see APPENDIX A: Lagrange Inversion, p. 677)
whose rˆole is central to tree enumerations, as we saw in Chapters I and II. The notes
below explore some independent consequences of the residue theorem and the coefﬁ-
cient formula.
 IV.6. Liouville’s Theorem. If a function f(z) is analytic in the whole of C and is of modulus
bounded by an absolute constant, |f(z)| ≤B, then it must be a constant. [By trivial bounds,
upon integrating on a large circle, it is found that the Taylor coefﬁcients at the origin of index
≥1 are all equal to 0.] Similarly, if f(z) is of at most polynomial growth, |f(z)| ≤B (|z|+1)r
over the whole of C, then it must be a polynomial.

 IV.7. Lindel¨of integrals.
Let a(s) be analytic in ℜ(s) > 1
4 where it is assumed to satisfy
a(s) = O(exp((π −δ)|s|)) for some δ with 0 < δ < π. Then, one has for | arg(z)| < δ,
∞
X
k=1
a(k)(−z)k = −1
2iπ
Z 1/2+i∞
1/2−i∞
a(s)zs
π
sin πs ds,
in the sense that the integral exists and provides the analytic continuation of the sum in | arg(z)| <
δ. [Close the integration contour by a large semi-circle on the right and evaluate by residues.]
Such integrals, sometimes called Lindel¨of integrals, provide representations for many functions
whose Taylor coefﬁcients are given by an explicit rule [220, 333].

 IV.8. Continuation of polylogarithms. As a consequence of Lindel¨of’s representation, the
generalized polylogarithm functions,
Liα,k(z) =
X
n≥1
n−α(log n)kzn
(α ∈R,
k ∈Z≥0),
are analytic in the complex plane C slit along (1+, ∞). (More properties are presented in
Section VI. 8; see also [176, 220].) For instance, one obtains in this way
“
∞
X
n=1
(−1)n log n ” = −1
4
Z +∞
−∞
log( 1
4 + t2)
cosh(πt)
dt = 0.22579 · · · = log
r
π
2 ,
when the divergent series on the left is interpreted as Li0,1(−1) = limz→−1+ Li0,1(z).

 IV.9. Magic duality. Let φ be a function initially deﬁned over the nonnegative integers but
admitting a meromorphic extension over the whole of C. Under growth conditions in the style
of Note 7, the function
F(z) :=
X
n≥1
φ(n)(−z)n,
which is analytic at the origin, is such that, near positive inﬁnity,
F(z)
∼
z→+∞E(z) −
X
n≥1
φ(−n)(−z)−n,
for some elementary function E(z). [Starting from the representation of Note 7, close the
contour of integration by a large semicircle to the left.] In such cases, the function is said to
satisfy the principle of magic duality—its expansion at 0 and ∞are given by one and the same
rule. Functions
1
1 + z ,
log(1 + z),
exp(−z),
Li2(−z),
Li3(−z),
satisfy a form of magic duality. Ramanujan [42] made a great use of this principle, which
applies to a wide class of functions including hypergeometric ones; see Hardy’s insightful dis-
cussion [260, Ch XI].


226
IV. COMPLEX ANALYSIS, RATIONAL AND MEROMORPHIC ASYMPTOTICS
 IV.10. Euler–Maclaurin and Abel–Plana summations. Under simple conditions on the an-
alytic function f, one has Plana’s (also known as Abel’s) complex variables version of the
Euler–Maclaurin summation formula:
∞
X
n=0
f(n) = 1
2f(0) +
Z ∞
0
f(x) dx +
Z ∞
0
f(iy) −f(−iy)
e2iπy −1
dy.
(See [266, p. 274] for a proof and validity conditions.)

 IV.11. N¨orlund-Rice integrals. Let a(z) be analytic for ℜ(z) > k0 −1
2 and of at most
polynomial growth in this right half plane. Then, with γ a simple loop around the interval
[k0, n], one has
n
X
k=k0
 
n
k
!
(−1)n−ka(k) =
1
2iπ
Z
γ
a(s)
n! ds
s(s −1)(s −2) · · · (s −n).
If a(z) is meromorphic in a larger region, then the integral can be estimated by residues. For
instance, with
Sn =
n
X
k=1
 
n
k
!
(−1)k
k
,
Tn =
n
X
k=1
 
n
k
!
(−1)k
k2 + 1,
it is found that Sn = −Hn (a harmonic number), while Tn oscillates boundedly as n →
+∞. [This technique is a classical one in the calculus of ﬁnite differences, going back to
N¨orlund [374]. In computer science it is known as the method of Rice’s integrals [207] and
is used in the analysis of many algorithms and data structures including digital trees and radix
sort [307, 458].]

IV. 3. Singularities and exponential growth of coefﬁcients
For a given function, a singularity can be informally deﬁned as a point where the
function ceases to be analytic. (Poles are the very simplest type of singularity.) Singu-
larities are, as we have stressed repeatedly, essential to coefﬁcient asymptotics. This
section presents the bases of a discussion within the framework of analytic function
theory.
IV. 3.1. Singularities. Let f(z) be an analytic function deﬁned over the interior
region determined by a simple closed curve γ, and let z0 be a point of the bounding
curve γ. If there exists an analytic function f ⋆(z) deﬁned over some open set Ω⋆
containing z0 and such that f ⋆(z) = f(z) in Ω⋆∩Ω, one says that f is analytically
continuable at z0 and that f ⋆is an immediate analytic continuation of f.
Analytic continuation:
( f )
Ω
( f* )
z0
Ω
γ
*
f ⋆(z) = f(z) on Ω⋆∩Ω.
Consider for instance the quasi-inverse function, f(z) = 1/(1 −z). Its power se-
ries representation f(z) = P
n≥0 zn initially converges in |z| < 1. However, the
calculation of (8) shows that it is representable locally by a convergent series near
any point z0 ̸= 1. In particular, it is continuable at any point of the unit disc ex-
cept 1. (Alternatively, one may appeal to complex-differentiability to verify directly

IV. 3. SINGULARITIES AND EXPONENTIAL GROWTH OF COEFFICIENTS
227
that f(z), which is given by a “global” expression, is holomorphic, hence analytic, in
the punctured plane C \ {1}.)
In sharp contrast to real analysis where a function admits of many smooth ex-
tensions, analytic continuation is essentially unique: if f ⋆(in Ω⋆) and f ⋆⋆(in Ω⋆⋆)
continue f at z0, then one must have f ⋆(z) = f ⋆⋆(z) in the intersection Ω⋆∩Ω⋆⋆,
which in particular includes a small disc around z0. Thus, the notion of immediate
analytic continuation at a boundary point is intrinsic. The process can be iterated and
we say that g is an analytic continuation6 of f along a path γ, even if the domains of
deﬁnition of f and g do not overlap, provided a ﬁnite chain of intermediate functions
connects f and g. This notion is once more intrinsic—this is known as the principle of
unicity of analytic continuation (Rudin [419, Ch. 16] provides a thorough discussion).
An analytic function is then much like a hologram: as soon as it is speciﬁed in any
tiny region, it is rigidly determined in any wider region where it can be continued.
Deﬁnition IV.4. Given a function f deﬁned in the region interior to the simple closed
curve γ, a point z0 on the boundary (γ) of the region is a singular point or a singular-
ity7 if f is not analytically continuable at z0.
Granted the intrinsic character of analytic continuation, we can usually dispense with
a detailed description of the original domain Ωand the curve γ. In simple terms, a
function is singular at z0 if it cannot be continued as an analytic function beyond z0.
A point at which a function is analytic is also called by contrast a regular point.
The two functions f(z) = 1/(1−z) and g(z) = √1 −z may be taken as initially
deﬁned over the open unit disk by their power series representation. Then, as we
already know, they can be analytically continued to larger regions, the punctured plane
Ω= C \ {1} for f [e.g., by the calculation of (8)] and the complex plane slit along
(1, +∞) for g [e.g., by virtue of differentiability as in (9)]. But both are singular at 1:
for f, this results from the fact that (say) f(z) →∞as z →1; for g this is due to the
branching character of the square-root. Figure 4 displays a few types of singularities
that are traceable by the way they deform a regular grid near a boundary point.
It is easy to check from the deﬁnitions that a converging power series is analytic
inside its disc of convergence. In other words, it can have no singularity inside this
disc. However, it must have at least one singularity on the boundary of the disc, as
asserted by the theorem below. In addition, a classical theorem, called Pringsheim’s
theorem, provides a reﬁnement of this property in the case of functions with nonneg-
ative coefﬁcients, which includes all combinatorial generating functions.
Theorem IV.5 (Boundary singularities). A function f(z) analytic at the origin, whose
expansion at the origin has a ﬁnite radius of convergence R, necessarily has a singu-
larity on the boundary of its disc of convergence, |z| = R.
PROOF. Consider the expansion
(15)
f(z) =
X
n≥0
fnzn,
6The collection of all function elements continuing a given function gives rise to the notion of Riemann
surface, for which many good books exist, e.g., [157, 444]. We shall normally avoid appealing to this theory.
7For a detailed discussion, see [129, p. 229], [299, vol. 1, p. 82], or [469].

228
IV. COMPLEX ANALYSIS, RATIONAL AND MEROMORPHIC ASYMPTOTICS
3
2.5
2
1.5
1
0.5
0
1.5
1
0.5
0
-0.5
-1
-1.5
f0(z) =
1
1 −z
0
10
8
6
4
2
0
0
4
2
0
-2
-4
f1(z) = ez/(1−z)
0
-0.2
-0.4
-0.6
-0.8
-1
-1.2
-1.4
0
0.6
0.4
0.2
0
-0.2
-0.4
-0.6
f2(z) = −√1 −z
0
0.5
0
-0.5
-1
-1.5
-2
-2.5
0
2
1
0
-1
-2
f3(z) = −(1 −z)3/2
0
4
3
2
1
0
0
1.5
1
0.5
0
-0.5
-1
-1.5
f4(z) = log
1
1 −z
FIGURE IV.4. The images of a grid on the unit square (with corners ±1 ± i) by various
functions singular at z = 1 reﬂect the nature of the singularities involved. Singularities are
apparent near the right of each diagram where small grid squares get folded or unfolded in
various ways. (In the case of functions f0, f1, f4 that become inﬁnite at z = 1, the grid
has been slightly truncated to the right.)

IV. 3. SINGULARITIES AND EXPONENTIAL GROWTH OF COEFFICIENTS
229
assumed to have radius of convergence exactly R. We already know that there can
be no singularity of f within the disc |z| < R. To prove that there is a singularity
on |z| = R, suppose a contrario that f(z) is analytic in the disc |z| < ρ for some ρ
satisfying ρ > R. By Cauchy’s coefﬁcient formula (Theorem IV.4), upon integrating
along the circle of radius r = (R + ρ)/2, and by trivial bounds, it is seen that the
coefﬁcient [zn]f(z) is O(r−n). But then, the series expansion of f would have to
converge in the disc of radius r > R, a contradiction.
□
Pringsheim’s Theorem stated and proved now is a reﬁnement of Theorem IV.5 that
applies to all series having nonnegative coefﬁcients, in particular, generating func-
tions. It is central to asymptotic enumeration as the remainder of this section will
amply demonstrate.
Theorem IV.6 (Pringsheim’s Theorem). If f(z) is representable at the origin by a
series expansion that has nonnegative coefﬁcients and radius of convergence R, then
the point z = R is a singularity of f(z).
 IV.12. Proof of Pringsheim’s Theorem. (See also [469, Sec. 7.21].) In a nutshell, the idea
of the proof is that if f has positive coefﬁcients and is analytic at R, then its expansion slightly
to the left of R has positive coefﬁcients. Then the power series of f would converge in a disc
larger than the postulated disc of convergence—a clear contradiction.
Suppose a contrario that f(z) is analytic at R, implying that it is analytic in a disc of
radius r centred at R. We choose a number h such that 0 < h < 1
3r and consider the expansion
of f(z) around z0 = R −h:
(16)
f(z) =
X
m≥0
gm(z −z0)m.
By Taylor’s formula and the representability of f(z) together with its derivatives at z0 by means
of (15), we have
gm =
X
n≥0
 
n
m
!
fnzn−m
0
,
and in particular, gm ≥0.
Given the way h was chosen, the series (16) converges at z = R+ h (so that z −z0 = 2h)
as illustrated by the following diagram:
z0 = R −h
R
R + h
R
2h
r
Consequently, one has
f(R + h) =
X
m≥0
0
@X
n≥0
 
n
m
!
fnzm−n
0
1
A (2h)m.

230
IV. COMPLEX ANALYSIS, RATIONAL AND MEROMORPHIC ASYMPTOTICS
This is a converging double sum of positive terms, so that the sum can be reorganized in any
way we like. In particular, one has convergence of all the series involved in
f(R + h)
=
X
m,n≥0
 
n
m
!
fn(R −h)m−n(2h)m
=
X
n≥0
fn [(R −h) + (2h)]n
=
X
n≥0
fn(R + h)n.
This establishes the fact that fn = o((R + h)n), thereby reaching a contradiction with the
assumption that the serie representation of f has radius of convergence exactly R. Pringsheim’s
theorem is proved.

Singularities of a function analytic at 0 which lie on the boundary of the disc of
convergence are called dominant singularities.
Pringsheim’s theorem appreciably
simpliﬁes the search for dominant singularities of combinatorial generating functions
since these have nonnegative coefﬁcients—it is then sufﬁcient to investigate analytic-
ity along the positive real line and detect the ﬁrst place at which it ceases to hold.
For instance, the derangement EGF and the surjection EGF,
D(z) = e−z
1 −z ,
R(z) = (2 −ez)−1
are analytic except for a simple pole at z = 1 in the case of D(z), and except for
points χk = log 2+2ikπ that are simple poles in the case of R(z). Thus the dominant
singularities for derangements and surjections are at 1 and log 2 respectively.
It is known that
√
Z cannot be unambiguously deﬁned as an analytic function in
a neighbourhood of Z = 0. As a consequence, the function
C(z) = (1 −
√
1 −4z)/2,
which is the generating function of the Catalan numbers, is an analytic function in
regions that must exclude 1/4; for instance, one may opt to take the complex plane
slit along the ray (1/4, +∞). Similarly, the function
L(z) = log
1
1 −z
which is the EGF of cyclic permutations is analytic in the complex plane slit along
(1, +∞).
A function having no singularity at a ﬁnite distance is called entire; its Taylor
series then converges everywhere in the complex plane. The EGFs,
ez+z2/2
and
eez−1,
associated respectively with involutions and set partitions, are entire.
IV. 3.2. The Exponential Growth Formula. We say that a number sequence
{an} is of exponential order Kn which we abbreviate as (the symbol ⊲⊳is a “bowtie”)
an ⊲⊳Kn
iff
lim sup |an|1/n = K.
The relation X ⊲⊳Y reads as “X is of exponential order Y ”.
It expresses both an
upper bound and a lower bound, and one has, for any ǫ > 0:

IV. 3. SINGULARITIES AND EXPONENTIAL GROWTH OF COEFFICIENTS
231
(i) |an| >i.o (K −ǫ)n, that is to say, |an| exceeds (K −ǫ)n inﬁnitely often (for
inﬁnitely many values of n);
(ii) |an| <a.e. (K + ǫ)n, that is to say, |an| is dominated by (K + ǫ)n almost
everywhere (except for possibly ﬁnitely many values of n).
This relation can be rephrased as an = Knθ(n), where θ is a subexponential factor
satisfying
lim sup |θ(n)|1/n = 1;
such a factor is thus bounded from above almost everywhere by any increasing expo-
nential (of the form (1+ǫ)n) and bounded from below inﬁnitely often by any decaying
exponential (of the form (1 −ǫ)n). Typical subexponential factors are
1, n3, (log n)2, √n,
1
3√log n, n−3/2, log log n.
(Functions like e
√n and exp(log2 n) are to be treated as subexponential factors for the
purpose of this discussion.) The lim sup deﬁnition also allows in principle for factors
that are inﬁnitely often very small or 0, like n2 sin n π
2 , log n cos√n π
2 , and so on. In
this and the next chapters, we shall develop systematic methods that enable one to
extract such subexponential factors from generating functions.
It is an elementary observation that the radius of convergence of the series rep-
resentation of f(z) at 0 is related to the exponential growth rate of the coefﬁcients
fn = [zn]f(z). To wit, if Rconv(f; 0) = R, then we claim that
(17)
fn ⊲⊳
 1
R
n
,
i.e.,
fn = R−nθ(n)
with lim sup |θ(n)|1/n = 1.
 IV.13. Radius of convergence and exponential growth. This only requires the basic deﬁnition
of a power series. (i) By deﬁnition of the radius of convergence, we have for any small ǫ > 0,
fn(R −ǫ)n →0. In particular, |fn|(R −ǫ)n < 1 for all sufﬁciently large n, so that |fn|1/n <
(R−ǫ)−1 “almost everywhere”. (ii) In the other direction, for any ǫ > 0, |fn|(R+ǫ)n cannot
be a bounded sequence, since otherwise, P
n |fn|(R + ǫ/2)n would be a convergent series.
Thus, |fn|1/n > (R + ǫ)−1 “inﬁnitely often”.

A global approach to the determination of growth rates is desirable. This is made
possible by Theorem IV.5.
Theorem IV.7 (Exponential Growth Formula). If f(z) is analytic at 0 and R is the
modulus of a singularity nearest to the origin in the sense that8
R := sup

r ≥0
 f is analytic in |z| < r
	
,
then the coefﬁcient fn = [zn]f(z) satisﬁes
fn ⊲⊳
 1
R
n
.
8One should think of the process deﬁning R as follows: take discs of increasing radii r and stop as
soon as a singularity is encountered on the boundary. (The dual process that would start from a large disc
and restrict its radius is in general ill-deﬁned—think of √1 −z.)

232
IV. COMPLEX ANALYSIS, RATIONAL AND MEROMORPHIC ASYMPTOTICS
For functions with nonnegative coefﬁcients, including all combinatorial generating
functions, one can also adopt
R := sup

r ≥0
 f is analytic at all points of 0 ≤z < r
	
.
PROOF. Let R be as stated. We cannot have R < Rconv(f; 0) since a function is
analytic everywhere in the interior of the disc of convergence of its series representa-
tion. We cannot have R > Rconv(f; 0) by the Boundary Singularity Theorem. Thus
R = Rconv(f; 0). The statement then follows from (17). The adaptation to nonnega-
tive coefﬁcients results from Pringsheim’s theorem.
□
The exponential growth formula thus directly relates the exponential order of
growth of coefﬁcients of a function to the location of its singularities nearest to the
origin. This is precisely expressed by the First Principle of Coefﬁcient Asymptotics
(p. 215), which, given its importance, we repeat here:
First Principle of Coefﬁcient Asymptotics. The location of a function’s
singularities dictates the exponential growth (An) of its coefﬁcient.
Several direct applications to combinatorial enumeration are given below.
EXAMPLE IV.1.
Exponential growth and combinatorial enumeration. Here are a few imme-
diate applications of exponential bounds.
Surjections. The function
R(z) = (2 −ez)−1
is the EGF of surjections. The denominator is an entire function, so that singularities may only
arise from its zeros, to be found at the points
χk = log 2 + 2ikπ,
k ∈Z.
The dominant singularity of R is then at ρ = χ0 = log 2. Thus, with rn = [zn]R(z),
rn ⊲⊳(
1
log 2)n.
Similarly, if “double” surjections are considered (each value in the range of the surjection
is taken at least twice), the corresponding EGF is
R∗(z) =
1
2 + z −ez ,
with the counts starting as 1,0,1,1,7,21,141 (EIS A032032). The dominant singularity is at
ρ∗deﬁned as the positive root of equation eρ∗−ρ∗= 2, and the coefﬁcient r∗
n satisﬁes:
r∗
n ⊲⊳( 1
ρ∗)n Numerically, this gives
rn ⊲⊳1.44269n
and
r∗
n ⊲⊳0.87245n,
with the actual ﬁgures for the corresponding logarithms being
n
1
n log rn
1
n log r∗
n
10
0.33385
−0.22508
20
0.35018
−0.18144
50
0.35998
−0.154449
100
0.36325
−0.145447
∞
0.36651
−0.13644
(log 1/ρ)
(log(1/ρ∗)

IV. 3. SINGULARITIES AND EXPONENTIAL GROWTH OF COEFFICIENTS
233
These estimates constitute a weak form of a more precise result to be established later
in this chapter: If random surjections of size n are taken equally likely, the probability of a
surjection being a double surjection is exponentially small.
Derangements. There, for d1,n = [zn]e−z(1 −z)−1 and d2,n = [zn]e−z−z2/2(1 −z)−1 we
have, from the poles at z = 1,
d1,n ⊲⊳1n
and
d2,n ⊲⊳1n.
The upper bound is combinatorially trivial. The lower bound expresses that the probability for a
random permutation to be a derangement is not exponentially small. For d1,n, we have already
proved by an elementary argument the stronger result d1,n →e−1; in the case of d2,n, we shall
establish later the precise asymptotic equivalent d2,n →e−3/2, in accordance with what was
announced in the introduction.
Unary-Binary trees. The expression
U(z) = 1 −z −
√
1 −2z −3z2
2z
= z + z2 + 2 z3 + 4 z4 + 9 z5 + · · · ,
represents the OGF of (plane unlabelled) unary-binary trees. From the equivalent form,
U(z) = 1 −z −
p
(1 −3z)(1 + z)
2z
,
it follows that U(z) is analytic in the complex plane slit along ( 1
3, +∞) and (−∞, −1) and
is singular at z = −1 and z = 1/3 where it has branch points. The closest singularity to the
origin being at 1
3, one has
Un ⊲⊳3n.
In this case, the stronger upper bound Un ≤3n results directly from the possibility of encoding
such trees by words over a ternary alphabet using Łukasiewicz codes (Chapter I). A complete
asymptotic expansion will be obtained in Chapter VI. . . . . . . . . . . END OF EXAMPLE IV.1. □
 IV.14. Coding theory bounds. Let C be a combinatorial class. We say that it can be encoded
with f(n) bits if, for all sufﬁciently large values of n, elements of Cn can be encoded as words
of f(n) bits. Assume that C has OGF C(z) with radius of singularity R satisfying 0 < R < 1.
Then, for any ǫ, C can be encoded with (1 + ǫ)κn bits where κ = −log2 R, but C cannot be
encoded with (1 −ǫ)κn bits.
Similarly, if C has EGF bC(z) with radius of convergence R satisfying 0 < R < ∞, C can
be encoded with n log(n/e) + (1 + ǫ)κn bits where κ = −log2 R, but C cannot be encoded
with n log(n/e) + (1 −ǫ)κn bits. Singularities convey information on optimal codes!

Saddle-point bounds. The exponential growth formula (Theorem IV.7) can be
supplemented by effective upper bounds which are very easy to derive and often turn
out to be surprisingly accurate. We state:
Proposition IV.1 (Saddle-Point bounds). Let f(z) be analytic in the disc |z| < R
with 0 < R ≤∞. Deﬁne M(f; r) for r ∈(0, R) by M(f; r) := sup|z|=r |f(z)|.
Then, one has, for any r in (0, R), the family of saddle point upper bounds
(18)
[zn]f(z)
≤
M(f; r)
rn
implying
[zn]f(z)
≤
inf
r∈(0,R)
M(f; r)
rn
.
If in addition f(z) has nonnegative coefﬁcients at 0, then
(19)
[zn]f(z)
≤
f(r)
rn
implying
[zn]f(z)
≤
inf
r∈(0,R)
f(r)
rn .

234
IV. COMPLEX ANALYSIS, RATIONAL AND MEROMORPHIC ASYMPTOTICS
PROOF. In the general case of (18), the ﬁrst inequality results from trivial bounds ap-
plied to the Cauchy coefﬁcient formula, when integration is performed along a circle:
[zn]f(z) =
1
2iπ
Z
|z|=r
f(z) dz
zn+1 .
It is consequently valid for any r smaller than the radius of convergence of f at 0. The
second inequality in (18) plainly represents the best possible bound of this type.
In the positive case of (19), the bounds can be viewed as a direct specialization
of (18). (Alternatively, they can be obtained elementarily since, in the case of positive
coefﬁcients,
fn ≤f0
rn + · · · + fn−1
r
+ fn + fn+1
rn+1 + · · · ,
whenever the fk are nonnegative.)
□
Note that the value s that provides the best bound in (19) can be determined by
cancelling a derivative,
(20)
sf ′(s)
f(s) = n.
Thanks to the universal character of the ﬁrst bound, any approximate solution of this
last equation will in fact provide a valid upper bound.
For reasons well explained by the saddle point method (Chapter VIII), these
bounds usually capture the actual asymptotic behaviour up to a polynomial factor
only. A typical instance is the weak form of Stirling’s formula,
1
n! ≡[zn]ez ≤en
nn ,
which only overestimates the true asymptotic value by a factor of
√
2πn.
 IV.15. A suboptimal but easy saddle-point bound. Let f(z) be analytic in |z| < 1 with
nonnegative coefﬁcients. Assume that f(x) ≤(1 −x)−β for some β ≥0 and all x ∈(0, 1).
Then
[zn]f(z) = O(nβ).
(Better bounds of the form O(nβ−1) are usually obtained by the method of singularity analysis
exposed in Chapter VI.)

EXAMPLE IV.2.
Combinatorial examples of saddle point bounds. Here are applications to
fragmented permutations, set partitions (Bell numbers), involutions, and integer partitions.
Fragmented permutations. Consider ﬁrst fragmented permutations deﬁned by F = SET(SEQ≥1(Z))
in the labelled universe (Chapter II, p. 115). The EGF is ez/(1−z), and we claim that
(21)
1
n!Fn ≡[zn]ez/(1−z) ≤e2√n−1
2 +O(n−1/2).
Indeed, the minimizing radius of the saddle point bound (19) is s such that
0 = d
ds
„
s
1 −s −n log s
«
=
1
(1 −s)2 −n
s .
The equation is solved by s = (2n + 1 −√4n + 1)/(2n). One can either use this exact value
and compute an asymptotic approximation of f(s)/sn, or adopt right away the approximate
value s1 = 1 −1/√n, which leads to simpler calculations. The estimate (21) results. It is off
from the actual asymptotic value only by a factor of order n−3/4 (cf Example VIII.6, p. 527).

IV. 3. SINGULARITIES AND EXPONENTIAL GROWTH OF COEFFICIENTS
235
n
eIn
In
100
0.106579 · 1085
0.240533 · 1083
200
0.231809 · 10195
0.367247 · 10193
300
0.383502 · 10316
0.494575 · 10314
400
0.869362 · 10444
0.968454 · 10442
500
0.425391 · 10578
0.423108 · 10576
–2
–1
0
1
2
3
FIGURE IV.5. A comparison of the exact number of involutions In to its approximation
eIn = n!e
√n+n/2n−n/2: [left] a table; [right] a plot of log10(In/eIn) against log10 n
suggesting that the ratio satisﬁes In/eIn ∼K · n−1/2, the slope of the line being ≈1
2.
Bell numbers and set partitions. Another immediate applications is an upper bound on Bell
numbers enumerating set partitions, S = SET(SET≥1(Z)), with EGF eez−1.
According
to (20), the best saddle point bound is obtained for s such that ses = n. Thus,
(22)
1
n!Sn ≤ees−1−n log s,
s : ses = n,
where, additionally, s = log n −log log n + o(log log n). See Chapter VIII, p. 525 for the
complete saddle point analysis.
Involutions. Involutions are speciﬁed by I = SET(CYC1,2(Z)) and have EGF I(z) = exp(z+
1
2z2). One determines, by choosing s = √n as an approximate solution to (20):
(23)
1
n!In ≤e
√n+n/2
nn/2
.
(See Figure 5 for numerical data and Example VIII.4, p. 524 for a full analysis.) Similar bounds
hold for permutations with all cycle lengths ≤k and permutations σ such that σk = Id.
Integer partitions. The function
(24)
P(z) =
∞
Y
k=1
1
1 −zk = exp
 ∞
X
ℓ=1
1
ℓ
zℓ
1 −zℓ
!
is the OGF of integer partitions, an unlabelled analogue of set partitions. Its radius of con-
vergence is a priori bounded from above by 1, since the set P is inﬁnite and the second form
of P(z) shows that it is exactly equal to 1. Therefore Pn ⊲⊳1n. A ﬁner upper bound results
from the estimate
(25)
Λ(t) := log P(e−t) ∼π2
6t + log
r
t
2π −1
24t + O(t2),
which obtains from Euler–Maclaurin summation or, better, from a Mellin analysis follow-
ing APPENDIX B: Mellin transform, p. 707. Indeed, the Mellin transform of Λ is, by the
harmonic sum rule,
Λ⋆(s) = ζ(s)ζ(s + 1)Γ(s),
s ∈⟨1, +∞⟩,
and the successive leftmost poles at s = 1 (simple pole), s = 0 (double pole), and s = −1
(simple pole) translate into the asymptotic expansion (25). When z →1−, we have
(26)
P(z) ∼e−π2/12
√
2π
√
1 −z exp
„
π2
6(1 −z)
«
,
from which we derive (choose s = D√n as an approximate solution to (20))
Pn ≤Cn−1/4eπ√
2n/3,

236
IV. COMPLEX ANALYSIS, RATIONAL AND MEROMORPHIC ASYMPTOTICS
for some C > 0. This last bound is once more only off by a polynomial factor, as we shall prove
when studying the saddle point method (Proposition VIII.8, p. 544). END OF EXAMPLE IV.2. □
 IV.16. A natural boundary. One has P(reiθ) →∞as r →1−, for any angle θ that is a
rational multiple of 2π. Points e2iπp/q being dense on the unit circle, the function P(z) admits
the unit circle as a natural boundary, i.e., it cannot be analytically continued beyond this circle.

IV. 4. Closure properties and computable bounds
Analytic functions are robust: they satisfy a rich set of closure properties. This
fact makes possible the determination of exponential growth constants for coefﬁcients
of a wide range of classes of functions. Theorem IV.8 below expresses computability
of growth rate for all speciﬁcations associated with iterative speciﬁcations. It is the
ﬁrst result of this sort that relates symbolic methods of Part A with analytic methods
developed here.
Closure properties of analytic functions. The functions analytic at a point z = a
are closed under sum and product, and hence form a ring. If f(z) and g(z) are ana-
lytic at z = a, then so is their quotient f(z)/g(z) provided g(a) ̸= 0. Meromorphic
functions are furthermore closed under quotient and hence form a ﬁeld. Such prop-
erties are proved most easily using complex-differentiability and extending the usual
relations from real analysis, for instance, (f + g)′ = f ′ + g′, (fg)′ = fg′ + f ′g.
Analytic functions are also closed under composition: if f(z) is analytic at z = a
and g(w) is analytic at b = f(a), then g ◦f(z) is analytic at z = a. Graphically:
a
f
g
b=f(a)
c=g(b)
The proof based on complex-differentiability closely mimicks the real case. Inverse
functions exist conditionally: if f ′(a) ̸= 0, then f(z) is locally linear near a, hence
invertible, so that there exists a g satisfying f ◦g = g◦f = Id, where Id is the identity
function, Id(z) ≡z. The inverse function is itself locally linear, hence complex
differentiable, hence analytic. In short, the inverse of an analytic function f at a place
where the derivative does not vanish is an analytic function.
 IV.17. The analytic inversion lemma. Let f be analytic on Ω∋z0 and satisfy f ′(z0) ̸= 0.
Then there esists a small region Ω1 ⊆Ωcontaining z0 and a C > 0 such that |f(z) −f(z′)| >
C|z −z′|, for all z, z′ ∈Ω1. Consequently, f maps bijectively Ω1 on f(Ω1).

One way to establish closure properties, as suggested above, is to deduce analyt-
icity criteria from complex differentiability by way of the Basic Equivalence Theorem
(Theorem IV.1). An alternative approach, closer to the original notion of analyticity,
can be based on a two-step process: (i) closure properties are shown to hold true for
formal power series; (ii) the resulting formal power series are proved to be locally
convergent by means of suitable majorizations on their coefﬁcients. This is the basis
of the classical method of majorant series originating with Cauchy.
 IV.18. The majorant series technique. Given two power series, deﬁne f(z) ⪯g(z) if
|[zn]f(z)| ≤[zn]g(z) for all n ≥0. The following two conditions are equivalent: (i) f(z) is

IV. 4. CLOSURE PROPERTIES AND COMPUTABLE BOUNDS
237
analytic in the disc |z| < ρ; (ii) for any r > ρ−1 there exists a c such that
f(z) ⪯
c
1 −rz .
If f, g are majorized by c/(1−rz), d/(1−rz) respectively, then f +g and f ·g are majorized,
f(z) + g(z) ⪯c + d
1 −rz ,
f(z) · g(z) ⪯
e
1 −sz ,
for any s > r and for some e dependent on s. Similarly, the composition f ◦g is majorized:
f ◦g(z) ⪯
c
1 −r(1 + d)z .
Constructions for 1/f and for the functional inverse of f can be similarly developed. See
Cartan’s book [79] and van der Hoeven’s study [477] for a systematic treatment.

For functions deﬁned by analytic expressions, singularities can be determined
inductively in an intuitively transparent manner. If Sing(f) and Zero(f) are respec-
tively the set of singularities and zeros of function f, then, due to closure properties
of analytic functions, the following informally stated guidelines apply.
8
>
>
>
>
>
>
>
>
<
>
>
>
>
>
>
>
>
:
Sing(f ± g)
⊆
Sing(f) ∪Sing(g)
Sing(f × g)
⊆
Sing(f) ∪Sing(g)
Sing(f/g)
⊆
Sing(f) ∪Sing(g) ∪Zero(g)
Sing(f ◦g)
⊆
Sing(g) ∪g(−1)(Sing(f))
Sing(√f)
⊆
Sing(f) ∪Zero(f)
Sing(log(f))
⊆
Sing(f) ∪Zero(f)
Sing(f (−1))
⊆
f(Sing(f)) ∪f(Zero(f ′)).
A mathematically rigorous treatment would require considering multivalued func-
tions and Riemann surfaces, so that we do not state detailed validity conditions and,
at this stage, keep for these formulæ the status of useful heuristics. In fact, because
of Pringsheim’s theorem, the search of dominant singularities of combinatorial gener-
ating function can normally avoid considering the complete multivalued structure of
functions, since only some initial segment of the positive real half–line needs to be
considered. This in turn implies a powerful and easy way of determining the expo-
nential order of coefﬁcients of a wide variety of generating functions, as we explain
next.
Computability of exponential growth constants. As deﬁned in Chapters I and II,
a combinatorial class is constructible or speciﬁable if it can be speciﬁed by a ﬁnite
set of equations involving only the basic constructors. A speciﬁcation is iterative or
non-recursive if in addition the dependency graph of the speciﬁcation is acyclic, that
is, no recursion is involved and a single functional term (written with sums, products,
as well as sequence, set, and cycle constructions) describes the speciﬁcation.
Our interest here is in effective computability issues. We recall that a real number
α is computable iff there exists a program Πα which on input m outputs a rational
number αm guaranteed to be within ±10−m of α. We state:
Theorem IV.8 (Computability of growth). Let C be a constructible unlabelled class
that admits of an iterative speciﬁcation in terms of (SEQ, PSET, MSET, CYC; +, ×)
starting with (1, Z). Then the radius of convergence ρC of the OGF C(z) of C is
either +∞or a (strictly) positive computable real number.

238
IV. COMPLEX ANALYSIS, RATIONAL AND MEROMORPHIC ASYMPTOTICS
Let D be a constructible labelled class that admits of an iterative speciﬁcation in
terms of (SEQ, SET, CYC; +, ⋆) starting with (1, Z). Then the radius of convergence
ρD of the EGF D(z) of D is either +∞or a (strictly) positive computable real number.
Accordingly, if ﬁnite, the constants ρC, ρD in the exponential growth estimates,
[zn]C(z) ≡Cn ⊲⊳
 1
ρC
n
,
[zn]D(z) ≡1
n!Dn ⊲⊳
 1
ρD
n
,
are computable numbers.
PROOF. In both cases, the proof proceeds by induction on the structural speciﬁcation
of the class. For each class F, with generating function F(z), we associate a signature,
which is an ordered pair ⟨ρF , τF ⟩, where ρF is the radius of convergence of F and τF
is the value of F at ρF , precisely,
τF := lim
x→ρ−
F
F(x).
(The value τF is well deﬁned as an element of R ∪{+∞} since F, being a counting
generating function, is necessarily increasing on (0, ρF).)
Unlabelled case. An unlabelled class G is either ﬁnite, in which case its OGF G(z)
is a polynomial, or inﬁnite, in which case it diverges at z = 1, so that ρG ≤1. It
is clearly decidable, given the speciﬁcation, whether a class is ﬁnite or not: a neces-
sary and sufﬁcient condition is that one of the unary constructors (SEQ, MSET, CYC)
intervenes in the speciﬁcation. We prove (by induction) the assertion of the theorem
together with the stronger property that τF = ∞as soon as the class is inﬁnite.
First, the signatures of the neutral class 1 and the atomic class Z, with OGF 1 and
z, are ⟨+∞, 1⟩and ⟨+∞, +∞⟩. Any nonconstant polynomial which is the OGF of a
ﬁnite set has the signature ⟨+∞, +∞⟩. The assertion is thus easily veriﬁed in these
cases.
Next, let F = SEQ(G). The OGF G(z) must be nonconstant and in fact satisfy
G(0) = 0 in order for the sequence construction to be properly deﬁned. Thus, by the
induction hypothesis, one has 0 < ρG ≤+∞and τG = +∞. Now, the function G
being increasing and continuous along the positive axis, there must exist a value β
such that 0 < β < ρG with G(β) = 1. For z ∈(0, β), the quasi-inverse F(z) =
(1 −G(z))−1 is well deﬁned and analytic; as z approaches β from the left, F(z)
increases unboundedly. Thus, the smallest singularity of F along the positive axis is
at β, and by Pringsheim’s theorem, one has ρF = β. The argument simultaneously
shows that τF = +∞. There only remains to check that β is computable. The
coefﬁcients of G form a computable sequence of integers, so that G(x), which can be
well approximated via truncated Taylor series, is an effectively computable number9
if x is itself a positive computable number less than ρG. Then binary search provides
an effective procedure for determining β.
9The present argument only establishes non-constructively the existence of a program, based on the
fact that truncated Taylor series converge geometrically fast at an interior point of their disc of convergence.
Making explict this program and the involved parameters from the speciﬁcation itself however represents a
much harder problem (that of “uniformity” with respect to speciﬁcations) that is not addressed here.

IV. 4. CLOSURE PROPERTIES AND COMPUTABLE BOUNDS
239
Next, we consider the multiset construction, F = MSET(G), whose translation
into OGFs necessitates the P´olya exponential of Chapter I (p. 32):
F(z) = Exp(G(z))
where Exp(h(z)) := exp

h(z) + 1
2h(z2) + 1
3h(z3) + · · ·

.
Once more, the induction hypothesis is assumed for G. If G is a polynomial, then F
is a rational function with poles at roots of unity only. Thus, ρF = 1 and τF = ∞
in that particular case. In the general case of F = MSET(G) with G inﬁnite, we start
by ﬁxing arbitrarily a number r such that 0 < r < ρG ≤1 and examine F(z) for
z ∈(0, r). The expression for F rewrites as
Exp(G(z)) = eG(z) · exp
1
2G(z2) + 1
3G(z3) + · · ·

.
The ﬁrst factor is analytic for z on (0, ρG) since, the exponential function being entire,
eG has the singularities of G. As to the second factor, one has G(0) = 0 (in order
for the set construction to be well-deﬁned), while G(x) is convex for x ∈[0, r] (since
its second derivative is positive). Thus, there exists a positive constant K such that
G(x) ≤Kx when x ∈[0, r]. Then, the series 1
2G(z2) + 1
3G(z3) + · · · has its terms
dominated by those of the convergent series
K
2 r2 + K
3 r3 + · · · = K log(1 −r)−1 −Kr.
By a well-known theorem of analytic function theory, a uniformly convergent sum of
analytic functions is itself analytic; consequently, 1
2G(z2) + 1
3G(z3) + · · · is analytic
at all z of (0, r). Analyticity is then preserved by the exponential, so that F(z), being
analytic at z ∈(0, r) for any r < ρG has a radius of convergence that satisﬁes ρF ≥
ρG. On the other hand, since F(z) dominates termwise G(z), one has ρF ≤ρG. Thus
ﬁnally one has ρF = ρG. Also, τG = +∞implies τF = +∞.
A parallel discussion covers the case of the powerset construction (PSET) whose
associated functional Exp is a minor modiﬁcation of the P´olya exponential Exp.
The cycle construction can be treated by similar arguments based on consideration
of “P´olya’s logarithm” as F = CYC(G) corresponds to
F(z) = Log
1
1 −G(z),
where
Log h(z) = log h(z) + 1
2 log h(z2) + · · · .
In order to conclude with the unlabelled case, there only remains to discuss the
binary constructors +, ×, which give rise to F = G + H, F = G · H. It is easily
veriﬁed that ρF = min(ρG, ρH). Computability is granted since the minimum of two
computable numbers is computable. That τF = +∞in each case is immediate.
Labelled case. The labelled case is covered by the same type of argument as above,
the discussion being even simpler, since the ordinary exponential and logarithm re-
place the P´olya operators Exp and Log. It is still a fact that all the EGFs of inﬁnite
nonrecursive classes are inﬁnite at their dominant positive singularity, though the radii
of convergence can now be of any magnitude (compared to 1).
□

240
IV. COMPLEX ANALYSIS, RATIONAL AND MEROMORPHIC ASYMPTOTICS
 IV.19. Relativized constructions. This is an exercise in induction. Theorem IV.8 is stated for
speciﬁcations involving the basic constructors. Show that the conclusion still holds if the corre-
sponding relativized constructions (K=r, K<r, K>r with K being any of the basic constructors)
are also allowed.

 IV.20. Syntactically decidable properties. For unlabelled classes F, the property ρF = 1 is
decidable. For labelled and unlabelled classes, the property ρF = +∞is decidable.

 IV.21. P´olya–Carlson and a curious property of OGFs. Here is a statement ﬁrst conjectured
by P´olya, then proved by Carlson in 1921 (see [128, p. 323]): If a function is represented by
a power series with integer coefﬁcients that converges inside the unit disc, then either it is a
rational function or it admits the unit circle as a natural boundary. This theorem applies in
particular to the OGF of any combinatorial class.

 IV.22. Trees are recursive structures only! General and binary trees cannot receive an iter-
ative speciﬁcation since their OGFs assume a ﬁnite value at their Pringsheim singularity. [The
same is true of most simple families of treee; cf Proposition IV.5 p. 264].

 IV.23. Nonconstructibility of permutations and graphs. The class P of all permutations
cannot be speciﬁed as a constructible unlabelled class since the OGF P(z) = P
n n!zn has
radius of convergence 0. (It is of course constructible as a labelled class.) Graphs, whether
labelled or unlabelled, are too numerous to form a constructible class.

Theorem IV.8 establishes a link between analytic combinatorics, computability
theory, and symbolic manipulation systems. It is based on an article of Flajolet, Salvy,
and Zimmermann [206] devoted to such computability issues in exact and asymptotic
enumeration. (Recursive speciﬁcations are not discussed now since they tend to give
rise to branch points, themselves amenable to singularity analysis techniques to be
developed in Chapters VI and VII.) The inductive process, implied by the proof of
Theorem IV.8, that decorates a speciﬁcation with the radius of convergence of each of
its subexpressions provides a practical basis for determining the exponential growth
rate of counts associated to a nonrecursive speciﬁcation. The example of trains de-
tailed below is typical.
EXAMPLE IV.3.
Combinatorial trains. This somewhat artiﬁcial example from [173] (see
Figure 6) serves to illustrate the scope of Theorem IV.8 and demonstrate its inner mechanisms
at work. Deﬁne the class of all labelled trains by the following speciﬁcation,
(27)
8
>
>
<
>
>
:
T r
=
Wa ⋆SEQ(Wa ⋆SET(Pa)),
Wa
=
SEQ≥1(Pℓ),
Pℓ
=
Z ⋆Z ⋆(1 + CYC(Z)),
Pa
=
CYC(Z) ⋆CYC(Z).
In ﬁgurative terms, a train (T ) is composed of a ﬁrst wagon (Wa) to which is appended a
sequence of passenger wagons, each of the latter capable of containing a set of passengers
(Pa). A wagon is itself composed of “planks” (Pℓ) determined by their end points (Z ⋆Z) and
to which a circular wheel (CYC(Z)) may be attached. A passenger is composed of a head and

IV. 4. CLOSURE PROPERTIES AND COMPUTABLE BOUNDS
241
T r
⋆
Wa
Seq≥1
⋆
Z
Z
+
1
Cyc
Z
Seq
⋆
(Wa)
Set
⋆
Cyc
Z
Cyc
Z
×
Wa
S1
×
z
z
+
1
L
z
S
×
(Wa)
exp
×
L
z
L
z
0.48512
0.68245
1
∞
∞
1
∞
1
∞
0.48512
0.68245
0.68245
1
1
1
∞
1
∞
FIGURE IV.6. The inductive determination of the radius of convergence of the EGF of
trains: (top) a hierarchical view of the speciﬁcation of T r; (bottom left) the corresponding
expression tree of the EGF Tr(z); (bottom right) the value of the radii for each subexpres-
sion of Tr(z) (with L(y) = log(1 −y)−1, S(y) = (1 −y)−1, S1(y) = yS(y)).
a belly that are each circular arrangements of atoms. Here is a depiction of a random train:
The translation into a set of EGF equations is immediate and a symbolic manipulation system
readily provides the form of the EGF of trains as
Tr(z) =
z2 “
1 + log((1 −z)−1)
”
“
1 −z2
“
1 + log((1 −z)−1)
””
0
B
@1 −
z2 “
1 + log((1 −z)−1)
”
e(log((1−z)−1))2
1 −z2
“
1 + log((1 −z)−1)
”
1
C
A
−1
,
together with the expansion
Tr(z) = 2 z2
2! + 6 z3
3! + 60 z4
4! + 520 z5
5! + 6660 z6
6! + 93408 z7
7! + · · · .
The speciﬁcation (27) has a hierarchical structure, as suggested by the top representation of
Figure 6, and this structure is itself directly reﬂected by the form of the expression tree of the GF
Tr(z). Then each node in the expression tree of Tr(z) can be tagged with the corresponding

242
IV. COMPLEX ANALYSIS, RATIONAL AND MEROMORPHIC ASYMPTOTICS
value of the radius of convergence. This is done according to the principles of Theorem IV.8;
see the bottom-right part of Figure 6. For instance, the quantity 0.68245 associated to W a(z)
is given by the sequence rule and is determined as smallest positive solution to the equation
z2 `
1 −log(1 −z)−1´
= 1.
The tagging process works upwards till the root of the tree is reached; here the radius of con-
vergence of Tr is determined to be ρ .= 0.48512 · · · , a quantity that happens to coincide with
the ratio [z49]Tr(z)/[z50]Tr(z) to more than 15 decimal places. END OF EXAMPLE IV.3. □
IV. 5. Rational and meromorphic functions
The last section has fully justiﬁed the First Principle of coefﬁcient asymptotics
leading to the exponential growth formula fn ⊲⊳An for the coefﬁcients of an analytic
function f(z). Indeed, as we saw, one has A = 1/ρ, where ρ equals both the radius of
convergenceof the series representing f and the distance of the origin to the dominant,
i.e., closest, singularities. We are going to start examining here the Second Principle,
already quoted on p. 215 and relative to the form,
fn = Anθ(n),
with θ(n) the subexponential factor:
Second Principle of Coefﬁcient Asymptotics. The nature of the function’s
singularities determines the associate subexponential factor (θ(n)).
In this section, we develop a complete theory in the case of rational functions (that is,
quotients of polynomials) and, more generally, meromorphic functions. The net result
is that, for such functions, the subexponential factors are essentially polynomials:
Polar singularities
;
Subexponential factors θ(n) are of polynomial growth.
A distinguishing feature is the extremely good quality of the asymptotic approxima-
tions obtained; for naturally occuring combinatorial problems, 15 digits of accuracy is
not uncommon in coefﬁcients of index as low as 50 (see Figure 7 below for a striking
example).
IV. 5.1. Rational functions. A function f(z) is a rational function iff it is of the
form f(z) = N(z)/D(z), with N(z) and D(z) being polynomials, which we may
without loss of generality assume to be relatively prime. For rational functions that
are analytic at the origin (e.g., generating functions), we have D(0) ̸= 0.
Sequences {fn}n≥0 that are coefﬁcients of rational functions satisfy linear re-
currence relations with constant coefﬁcients. This fact is easy to establish: com-
pute [zn]f(z) · D(z); then, with D(z) = d0 + d1z + · · · + dmzm, one has, for
all n > deg(N(z)),
m
X
j=0
djfn−j = 0.
The main theorem we prove here provides an exact ﬁnite expression for coefﬁ-
cients of f(z) in terms of the poles of f(z). Individual terms in these expressions are
sometimes called exponential polynomials.

IV.5. RATIONAL AND MEROMORPHIC FUNCTIONS
243
Theorem IV.9 (Expansion of rational functions). If f(z) is a rational function that is
analytic at zero and has poles at points α1, α2, . . . , αm, then its coefﬁcients are a sum
of exponential polynomials: there exist m polynomials {Πj(x)}m
j=1 such that, for n
larger than some ﬁxed n0,
(28)
fn ≡[zn]f(z) =
m
X
j=1
Πj(n)α−n
j
.
Furthermore the degree of Πj is equal to the order of the pole of f at αj minus one.
PROOF. Since f(z) is rational it admits a partial fraction expansion. To wit:
f(z) = Q(z) +
X
(α,r)
cα,r
(z −α)r ,
where Q(z) is a polynomial of degree n0 := deg(N)−deg(D) if f = N/D. There α
ranges over the poles of f(z) and r is bounded from above by the multiplicity of α as
a pole of f. Coefﬁcient extraction in this expression results from Newton’s expansion,
[zn]
1
(z −α)r = (−1)r
αr
[zn]
1
(1 −z
α)r = (−1)r
αr
n + r −1
r −1

α−n.
The binomial coefﬁcient is a polynomial of degree r −1 in n, and collecting terms
associated with a given α yields the statement of the theorem.
□
Notice that the expansion (28) is also an asymptotic expansion in disguise: when
grouping terms according to the α’s of increasing modulus, each group appears to be
exponentially smaller than the previous one. In particular, if there is a unique dominant
pole, |α1| < |α2| ≤|α3| ≤· · · , then
fn ∼α−n
1 Π1(n),
and the error term is exponentially small as it is O(α−n
2 nr) for some r. A classical
instance is the OGF of Fibonacci numbers,
f(z) =
z
1 −z −z2 ,
with poles at −1 +
√
5
2
.= 0.61803 and −1 −
√
5
2
.= −1.61803, so that
Fn =
1
√
5ϕn −1
√
5 ¯ϕn = ϕn
√
5 + O( 1
ϕn ),
with ϕ = (1 +
√
5)/2 the golden ratio, and ¯ϕ its conjugate.
 IV.24. A simple exercise. Let f(z) be as in Theorem IV.9, assuming additionally a unique
dominant pole α1 of multiplicity r. Then, by inspection of the proof of Theorem IV.9:
fn =
C
(r −1)!α−n+r
1
nr−1
„
1 + O
„ 1
n
««
with
C = lim
z→α1(z −α1)rf(z).
This is certainly the most direct illustration of the Second Principle: under the assumptions, a
one-term asymptotic expansion of the functon at its dominant singularity sufﬁces to determine
the asymptotic form of the coefﬁcients.


244
IV. COMPLEX ANALYSIS, RATIONAL AND MEROMORPHIC ASYMPTOTICS
EXAMPLE IV.4.
Qualitative analysis of a rational function. This is an artiﬁcial example
designed to demonstrate that all the details of the full decomposition are usually not required.
The rational function
f(z) =
1
(1 −z3)2(1 −z2)3(1 −z2
2 )
has a pole of order 5 at z = 1, poles of order 2 at z = ω, ω2 (ω = e2iπ/3 a cubic root of unity),
a pole of order 3 at z = −1, and simple poles at z = ±
√
2. Therefore,
fn = P1(n) + P2(n)ω−n + P3(n)ω−2n + P4(n)(−1)n+
+P5(n)2−n/2 + P6(n)(−1)n2−n/2
where the degrees of P1, . . . , P6 are respectively 4, 1, 1, 2, 0, 0. For an asymptotic equivalent
of fn, only the poles at roots of unity need to be considered since they corresponds to the fastest
exponential growth; in addition, only z = 1 needs to be considered for ﬁrst order asymptotics;
ﬁnally, at z = 1, only the term of fastest growth needs to be taken into account. In this way, we
ﬁnd the correspondence
f(z) ∼
1
32 · 23 · ( 1
2)
1
(1 −z)5 =⇒fn ∼
1
32 · 23 · ( 1
2)
 
n + 4
4
!
∼n4
864.
The way the analysis can be developed without computing details of partial fraction expansion
is typical. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE IV.4. □
Theorem IV.9 applies to any speciﬁcation leading to a GF that is a rational func-
tion10. Combined with the qualitative approach to rational coefﬁcient asymptotics,
it gives access to a large number of effective asymptotic estimates for combinatorial
counting sequences.
EXAMPLE IV.5. Asymptotics of denumerants.
Denumerants are integer partitions with sum-
mands restricted to be from a ﬁxed ﬁnite set (Chapter I, p. 41). We let PT be the class relative
to set T ⊂Z>0, with the known OGF,
P T (z) =
Y
ω∈T
1
1 −zω .
A particular case is the one of integer partitions whose summands are in {1, 2, . . . , r},
P {1,...,r}(z) =
r
Y
m=1
1
1 −zm .
The GF has all its poles that are roots of unity. At z = 1, the order of the pole is r, and one has
P {1,...,r}(z) ∼1
r!
1
(1 −z)r ,
as z →1. Other poles have smaller multiplicity: for instance the multiplicity of z = −1 is
equal to the number of factors (1−z2j)−1 in P {1,...,r}, that is ⌊r/2⌋; in general a primitive qth
root of unity is found to have multiplicity ⌊r/q⌋. There results that z = 1 contributes a term of
the form nr−1 to the coefﬁcient of order n, while each of the other poles contributes a term of
order at most n⌊r/2⌋. We thus ﬁnd
P {1,...,r}
n
∼crnr−1
with
cr =
1
r!(r −1)!.
10In Part A, we have been occasionally led to discuss coefﬁcients of rational functions, thereby antic-
ipating the statement of the theorem: see for instance the discussion of parts in compositions (p. 157) and
of records in sequences (p. 178).

IV.5. RATIONAL AND MEROMORPHIC FUNCTIONS
245
The same argument provides the asymptotic form of P T
n , since, to ﬁrst order asymptotics,
only the pole at z = 1 counts. One then has:
Proposition IV.2. Let T be a ﬁnite set of integers without a common divisor (gcd(T ) = 1).
The number of partitions with summands restricted to T satisﬁes
P T
n ∼1
τ
nr−1
(r −1)!,
with
τ :=
Y
ω∈T
ω,
r := card(T ).
For instance, in a strange country that would have pennies (1 cent), nickels (5 cents), dimes
(10 cents), and quarters (25 cents), the number of ways to make change for a total of n cents is
[zn]
1
(1 −z)(1 −z5)(1 −z10)(1 −z25) ∼
1
1 · 5 · 10 · 25
n3
3! ≡
n3
7500,
asymptotically.
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE IV.5. □
IV. 5.2. Meromorphic Functions. An expansion similar to that of Theorem IV.9
holds true for coefﬁcients of a larger class—meromorphic functions.
Theorem IV.10 (Expansion of meromorphic functions). Let f(z) be a function mero-
morphic for |z| ≤R with poles at points α1, α2, . . . , αm, and analytic at all points of
|z| = R and at z = 0. Then there exist m polynomials {Πj(x)}m
j=1 such that:
(29)
fn ≡[zn]f(z) =
m
X
j=1
Πj(n)α−n
j
+ O(R−n).
Furthermore the degree of Πj is equal to the order of the pole of f at αj minus one.
PROOF. We offer two different proofs, one based on subtracted singularities, the other
one based on contour integration.
(i) Subtracted singularities. Around any pole α, f(z) can be expanded locally:
f(z)
=
X
k≥−M
cα,k(z −α)k
(30)
=
Sα(z) + Hα(z)
(31)
where the “singular part” Sα(z) is obtained by collecting all the terms with index in
[−M . . −1] (that is, forming Sα(z) = Nα(z)/(z −α)M with Nα(z) a polynomial
of degree less than M) and Hα(z) is analytic at α. Thus setting S(z) := P
j Sαj(z),
we observe that f(z) −S(z) is analytic for |z| ≤R. In other words, by collecting
the singular parts of the expansions and subtracting them, we have “removed” the sin-
gularities of f(z), whence the name of method of subtracted singularities sometimes
given to the method [265, vol. 2, p. 448].
Taking coefﬁcients, we get:
[zn]f(z) = [zn]S(z) + [zn](f(z) −S(z)).
The coefﬁcient of [zn] in the rational function S(z) is obtained from Theorem IV.9. It
sufﬁces to prove that the coefﬁcient of zn in f(z)−S(z), a function analytic for |z| ≤
R, is O(R−n). This fact follows from trivial bounds applied to Cauchy’s integral

246
IV. COMPLEX ANALYSIS, RATIONAL AND MEROMORPHIC ASYMPTOTICS
formula with the contour of integration being λ = {z / |z| = R}, as in the proof of
Theorem IV.7:
[zn](f(z) −S(z))
 = 1
2π

Z
|z|=R
(f(z) −S(z)) dz
zn+1
 ≤
1
2π
O(1)
Rn+1 2πR.
(ii) Contour integration. There is another line of proof for Theorem IV.10 which
we brieﬂy sketch as it provides an insight which is useful for applications to other
types of singularities treated in Chapter VI. It consists in using directly Cauchy’s
coefﬁcient formula and “pushing” the contour of integration past singularities. In
other words, one computes directly the integral
In =
1
2iπ
Z
|z|=R
f(z) dz
zn+1
by residues. There is a pole at z = 0 with residue fn and poles at the αj with residues
corresponding to the terms in the expansion stated in Theorem IV.10; for instance, if
f(z) ∼c/(z −a) as z →a, then
Res(f(z)z−n−1; z = a) = Res(
c
(z −a)z−n−1; z = a) =
c
an+1 .
Finally, by the same trivial bounds as before, In is O(R−n).
□
 IV.25. Effective error bounds. The error term O(R−n) in (29), call it εn, satisﬁes
|εn| ≤sup
|z|=R
|f(z)|.
This results immediately from the second proof. This bound may be useful, even in the case of
rational functions.

EXAMPLE IV.6. Surjections. These are deﬁned as sequences of sets (R = SEQ(SET≥1(Z)))
with EGF R(z) = (2 −ez)−1 (see p. 98). We have already determined the poles, the one
of smallest modulus being at log 2 .= 0.69314. At this dominant pole, one ﬁnds R(z) ∼
−1
2(z −log 2)−1. This implies an approximation for the number of surjections:
Rn ≡n![zn]R(z) ∼ξ(n),
with
ξ(n) := n!
2 ·
`
1
log 2
´n+1.
Here is, for n = 2, 4, . . . , 32, a table of the values of the surjection numbers (left) compared
with the asymptotic approximation rounded11 to the nearest integer, ⌈ξ(n)⌋: It is piquant to
see that ⌈ξ(n)⌋provides the exact value of Rn for all values of n = 1, . . . , 15, and it starts
losing one digit for n = 17, after which point a few “wrong” digits gradually appear, but in
very limited number; see Figure 7. (A similar situation holds for tangent numbers discussed
in our Invitation, p. 4.) The explanation of such a faithful asymptotic representation owes to
the fact that the error terms provided by meromorphic asymptotics are exponentially small. In
effect, there is no other pole in |z| ≤6, the next ones being at log 2 ± 2iπ with modulus of
about 6.32. Thus, for rn = [zn]R(z), there holds
(32)
Rn
n! ∼1
2 ·
`
1
log 2
´n+1 + O(6−n).
For the double surjection problem, R∗(z) = (2 + z −ez), we get similarly
[zn]R∗(z) ∼
1
eρ∗−1 (ρ∗)−n−1,
11The notation ⌈x⌋represents x rounded to the nearest integer: ⌈x⌋:= ⌊x + 1
2 ⌋.

IV.5. RATIONAL AND MEROMORPHIC FUNCTIONS
247
3 3
75 75
4683 4683
545835 545835
102247563 102247563
28091567595 28091567595
10641342970443 10641342970443
5315654681981355 5315654681981355
3385534663256845323 338553466325684532 6
2677687796244384203115 2677687796244384203 088
2574844419803190384544203 2574844419803190384544 450
2958279121074145472650648875 295827912107414547265064 6597
4002225759844168492486127539083 40022257598441684924861275 55859
6297562064950066033518373935334635 6297562064950066033518373935 416161
11403568794011880483742464196184901963 1140356879401188048374246419617 4527074
23545154085734896649184490637144855476395 2354515408573489664918449063714 5314147690
FIGURE IV.7. The surjection numbers pyramid: for n = 2, 4, . . . , 32, the exact values
of the numbers Rn (left) compared to the approximation ⌈ξ(n)⌋with discrepant digits in
boldface (right).
with ρ∗= 1.14619 the smallest positive root of eρ∗−ρ∗= 2. . . END OF EXAMPLE IV.6. □
It is worth reﬂecting on this example as it is representative of a production chain
based on the two successive implications reﬂecting the spirit of Part A and Part B of
the book:





R = SEQ(SET≥1(Z))
=⇒
R(z) =
1
2 −ez
R(z)
∼
z→log 2 −1
2
1
(z −log 2)
;
1
n!Rn ∼1
2(log 2)−n−1.
There the ﬁrst implication (written ‘=⇒’ as usual) is provided automatically by the
symbolic method. The second one (written here ‘;’) is a formal translation from the
expansion of the GF at its dominant singularity to the asymptotic form of coefﬁcients,
validity being granted by complex-analytic conditions.
EXAMPLE IV.7.
Alignments. These are sequences of cycles (O = SEQ(CYC(Z)), p. 110)
with EGF
O(z) =
1
1 −log(1 −z)−1 .
There is a singularity when log(1 −z)−1 = 1, which is at ρ = 1 −e−1 and arises before
z = 1 where the logarithm becomes singular. Then, the computation of the asymptotic form of
[zn]O(z) only requires a local expansion near ρ,
O(z) ∼
−e−1
z −1 + e−1
=⇒
[zn]O(z) ∼
e−1
(1 −e−1)n+1 ,
and the coefﬁcient estimates result from Theorem IV.10. . . . . . . . . END OF EXAMPLE IV.7. □
 IV.26. Some “supernecklaces”. One estimates
[zn] log
 
1
1 −log
1
1−z
!
∼1
n(1 −e−1)−n,

248
IV. COMPLEX ANALYSIS, RATIONAL AND MEROMORPHIC ASYMPTOTICS
where the EGF enumerates labelled cycles of cycles (supernecklaces, p. 115). [Hint: Take
derivatives.]

EXAMPLE IV.8.
Generalized derangements.
The probability that the shortest cycle in a
random permutation of size n has length larger than k is
[zn]D(k)(z),
where
D(k)(z) = e−z
1 −z2
2 −···−zk
k
1 −z
,
as results from the speciﬁcation D(k) = SET(CYC>k(Z)). For any ﬁxed k, one has (easily)
D(k)(z) ∼e−Hk/(1 −z) as z →1, with 1 being a simple pole. Accordingly the coefﬁcients
[zn]D(k)(z) tend to e−Hk as n →∞. Thus, due to meromorphy, we have the characteristic
implication
D(k)(z) ∼e−Hk
1 −z
=⇒
[zn]D(k)(z) ∼e−Hk.
Since there is no other singularity at a ﬁnite distance, the error in the approximation is (at least)
exponentially small,
(33)
[zn]e−z
1 −z2
2 −···−zk
k
1 −z
= e−Hk + O(R−n),
for any R > 1. The cases k = 1, 2 in particular justify the estimates mentioned at the beginning
of this chapter, on p. 216. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE IV.8. □
This example is also worth reﬂecting upon. In prohibiting cycles of length < k,
we modify the EGF of all permutations, (1 −z)−1 by a factor e−z/1−···−zk/k. The
resulting EGF is meromorphic at 1; thus only the value of the modifying factor at
z = 1 matters, so that this value, namely eHk, provides the asymptotic proportion
of k-derangements. We shall encounter more and more shortcuts of this sort as we
progress into the book.
 IV.27. Shortest cycles of permutations are not too long. Let Sn be the random variable
denoting the length of the shortest cycle in a random permutation of size n. Using the circle
|z| = 2 to estimate the error in the approximation e−Hk above, one ﬁnds that, for k ≤log n,
˛˛˛P(Sn > k) −e−Hk
˛˛˛ ≤1
2n e2k+1,
which is exponentially small in this range of k-values. Thus, the approximation e−Hk remains
good when k is allowed to tend sufﬁciently slowly to ∞with n. One can also explore the
possibility of better bounds and larger regions of validity of the main approximation. (See
Panario and Richmond’s study [385] for a general theory of smallest components in sets.)

 IV.28. Expected length of the shortest cycle. The classical approximation of the harmonic
numbers, Hk ≈log k + γ suggests e−γ/k as a possible approximation to (33) for both large n
and large k in suitable regions. In agreement with this heuristic argument, the expected length
of the shortest cycle in a random permutation of size n is effectively asymptotic to
n
X
k=1
e−γ
k
∼e−γ log n,
a property ﬁrst discovered by Shepp and Lloyd [436].

The next example illustrates the analysis of a collection of rational generating
functions (Smirnov words) paralleling nicely the enumeration of a special type of
integer composition (Carlitz compositions) that resorts to meromorphic asymptotics.

IV.5. RATIONAL AND MEROMORPHIC FUNCTIONS
249
EXAMPLE IV.9.
Smirnov words and Carlitz compositions.
Bernoulli trials have been dis-
cussed in Chapter III, in relation to weighted word models. Take the class W of all words over
an r-ary alphabet, where letter j is assigned probability pj and letters of words are drawn inde-
pendently. With this weighting, the GF of all words is W (z) = 1/(1 −P pjz) = (1 −z)−1.
Consider the problem of determining the probability that a random word of length n is of
Smirnov type, that is, all blocks of length 2 are formed with distinct letters. In order to avoid
degeneracies, we impose r ≥3 (since for r = 2, the only Smirnov words are ababa. . . and
babab. . . ).
By our discussion of Section III. 7 (p. 193), the GF of Smirnov words (again with the
probabilistic weighting) is
S(z) =
1
1 −P
pjz
1+pjz
.
By monotonicity of the denominator, this rational function has a unique dominant singularity
at ρ such that
(34)
r
X
j=1
pjρ
1 + pjρ = 1,
and z = ρ is a simple pole. Consequently, ρ is a well-characterized algebraic number deﬁned
implicitly by an equation of degree r. There results that the probability for a word to be Smirnov
is (not too surprisingly) exponentially small, with the precise formula being
[zn]S(z) ∼C · ρ−n,
C =
 
r
X
j=1
pjρ
(1 + pjρ)2
!−1
.
A similar analysis, using bivariate generating functions, shows that in a random word of length n
conditioned to be Smirnov, the letter j appears with asymptotic frequency
(35)
qj = 1
Q
pj
(1 + pjρ)2 ,
Q :=
r
X
j=1
pj
(1 + pjρ)2 ,
in the sense that the mean number of occurrences of letter j is asymptotic to qjn. All these
results are seen to be consistent with the equiprobable letter case pj = 1/r, for which ρ =
r/(r −1).
Carlitz compositions illustrate a limit situation, in which the alphabet is inﬁnite, while
letters have different sizes. Recall that a Carlitz composition of the integer n is a composition
of n such that no two adjacent summands have equal value. By Note III.31, p. 190, such
compositions can be obtained by substitution from Smirnov words, to the effect that
(36)
K(z) =
 
1 −
∞
X
j=1
zj
1 + zj
!−1
.
The asymptotic form of the coefﬁcients then results from an analysis of dominant poles. The
OGF has a simple pole at ρ, which is the smallest positive root of the equation
(37)
∞
X
j=1
ρj
1 + ρj = 1.
(Note the analogy with (34) due to commonality of the combinatorial argument.) Thus:
Kn ∼C · βn,
C .= 0.45636 34740,
β .= 1.75024 12917.

250
IV. COMPLEX ANALYSIS, RATIONAL AND MEROMORPHIC ASYMPTOTICS
0
400
300
200
100
0
0
300000
200000
100000
0
-100000
-200000
-300000
FIGURE
IV.8. The
coefﬁcients
[zn]f(z),
where
f(z)
=
`
1 + 1.02z4´−3 `
1 −1.05z5´−1 illustrate a periodic superposition of smooth behaviours
that depend on the residue class of n modulo 20.
There, β = 1/ρ with ρ as in (37). In a way analogous to Smirnov words, the asymptotic
frequency of summand k appears to be proportional to kρk/(1 + ρk)2; see [296, 344] for
further properties. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE IV.9. □
IV. 6. Localization of singularities
There are situations where a function possesses several dominant singularities,
that is, several singularities are present on the boundary of the disc of convergence.
We examine here the induced effect on coefﬁcients and discuss ways to localize such
dominant singularities.
IV. 6.1. Multiple singularities. In the case when there exists more than one
dominant singularity, several geometric terms of the form βn sharing the same mod-
ulus (and each carrying its own subexponential factor) must be combined. In simpler
situations, such terms globally induce a pure periodic behaviour for coefﬁcients that is
easy to describe. In the general case, irregular ﬂuctuations of a somewhat arithmetic
nature may prevail.
Pure periodicities. When several dominant singularities of f(z) have the same
modulus and are regularly spaced on the boundary of the disc of convergence, they
may induce complete cancellations of the main exponential terms in the asymptotic
expansion of the coefﬁcient fn. In that case, different regimes will be present in the
coefﬁcients fn based on congruence properties of n. For instance, the functions
1
1 + z2 = 1 −z2 + z4 −z6 + z8 −· · · ,
1
1 −z3 = 1 + z3 + z6 + z9 + · · · ,
exhibit patterns of periods 4 and 3 respectively, this corresponding to poles that are
roots of unity or order 4 (±i), and 3 (ω : ω3 = 1). Accordingly, the function
φ(z) =
1
1 + z2 +
1
1 −z3 = 2 −z2 + z3 + z4 + z8 + z9 −z10
1 −z12

IV.6. LOCALIZATION OF SINGULARITIES
251
0
200
150
100
50
0
0
1
0.5
0
-0.5
-1
n
0
20
15
10
5
0
y
0
1
0.5
0
-0.5
-1
FIGURE IV.9. The coefﬁcients of f = 1/(1 −6
5z + z2) exhibit an apparently chaotic
behaviour (left) which in fact corresponds to a discrete sampling of a sine function (right),
reﬂecting the presence of two conjugate complex poles.
has coefﬁcients that obey a pattern of period 12 (for example, the coefﬁcients φn such
that n ≡1, 5, 6, 7, 11 modulo 12 are zero). Accordingly, the coefﬁcients of
[zn]ψ(z)
where
ψ(z) = φ(z) +
1
1 −z/2,
manifest a different exponential growth when n is congruent to 1, 5, 6, 7, 11 mod 12.
See Figure 8 for such a superposition of pure periodicities. In many combinatorial
applications, generating functions involving periodicities can be decomposed at sight,
and the corresponding asymptotic subproblems generated are then solved separately.
 IV.29. Decidability of polynomial properties. Given a polynomial p(z) ∈Q[z], the following
properties are decidable: (i) whether one of the zeros of p is a root of unity; (ii) whether one
of the zeros of p has an argument that is commensurate with π. [One can use resultants. An
algorithmic discussion of this and related issues is given in [247].]

Nonperiodic ﬂuctuations. As a representative example, consider the polynomial
D(z) = 1 −6
5z + z2, whose roots are
α = 3
5 + i4
5,
¯α = 3
5 −i4
5,
both of modulus 1 (the numbers 3, 4, 5 form a Pythagorean triple), with argument ±θ0
where θ0 = arctan( 4
3) .= 0.92729. The expansion of the function f(z) = 1/D(z)
starts as
1
1 −6
5z + z2 = 1 + 6
5z + 11
25z2 −84
125z3 −779
625z4 −2574
3125z5 + · · · ,
the sign sequence being
+ + + −−−+ + + + −−−+ + + −−−−+ + + −−−−+ + + −−−,
which indicates a somewhat irregular oscillating behaviour, where blocks of 3 or 4
pluses follow blocks of 3 or 4 minuses.

252
IV. COMPLEX ANALYSIS, RATIONAL AND MEROMORPHIC ASYMPTOTICS
The exact form of the coefﬁcients of f results from a partial fraction expansion:
f(z) =
a
1 −z/α +
b
1 −z/¯α
with
a = 1
2 + 3
8i,
b = 1
2 −3
8i,
where α = eiθ0, α = e−iθ0 Accordingly,
(38)
fn = ae−inθ0 + beinθ0 = sin((n + 1)θ0)
sin(θ0)
.
This explains the sign changes observed. Since the angle θ0 is not commensurate with
π, the coefﬁcients ﬂuctuate but, unlike in our earlier examples, no exact periodicity is
present in the sign patterns. See Figure 9 for a rendering and Figure 13 of Chapter V
(p. 319) for a meromorphic case linked to compositions into prime summands.
Complicated problems of an arithmetical nature may occur if several such sin-
gularities with non–commensurate arguments combine, and some open problem even
remain in the analysis of linear recurring sequences. (For instance no decision proce-
dure is known to determine whether such a sequence ever vanishes.) Fortunately, such
problems occur infrequently in combinatorial applications, where dominant poles of
rational functions (as well as many other functions) tend to have a simple geometry as
we explain next.
 IV.30. Irregular ﬂuctuations and Pythagorean triples. The quantity
1
π θ0 is an irrational
number, so that the sign ﬂuctuations of (38) are “irregular” (i.e., non purely periodic). [Proof:
a contrario. Indeed, otherwise, α = (3 + 4i)/5 would be a root of unity. But then the minimal
polynomial of α would be a cyclotomic polynomial with nonintegral coefﬁcients, a contradic-
tion; see [327, VIII.3] for the latter property.]

 IV.31. Skolem-Mahler-Lech Theorem. Let fn be the sequence of coefﬁcients of a rational
function, f(z) = A(z)/B(z), where A, B ∈Q[z]. The set of all n such that fn = 0 is
the union of a ﬁnite (possibly empty) set and a ﬁnite number (possibly zero) of inﬁnite arith-
metic progressions. (The proof is based on p-adic analysis, but the argument is intrinsically
nonconstructive; see [371] for an attractive introduction to the subject and references.)

Periodicity conditions for positive generating functions. By the previous dis-
cussion, it is of interest to locate dominant singularities of combinatorial generating
functions, and, in particular, determine whether their arguments (the “dominant direc-
tions”) are commensurate to 2π. In the latter case, different asymptotic regimes of the
coefﬁcients manifest themselves, depending on congruence properties of n.
First a few deﬁnitions. For a sequence (fn) with GF f(z), the support of f,
denoted Supp(f), is the set of all n such that fn ̸= 0. The sequence (also its GF) is
said to admit span, or period, d if for some r, there holds
Supp(f) ⊆r + dZ≥0 ≡{r, r + d, r + 2d, . . .}.
In that case, if f is analytic at 0, then there exists a function g analytic at 0 such that
f(z) = zrg(zd). The largest span, p, is often plainly referred to as the period, all
other spans being divisors of p. With E := Supp(f), this maximal span is attainable
as p = gcd(E −E) (pairwise differences) as well as p = gcd(E −{r}) where
r := min(E). For instance sin(z) has period 2, cos(z) + cosh(z) has period 4, z3ez5
has period 5, and so on.

IV.6. LOCALIZATION OF SINGULARITIES
253
0.5
0.5
-0.5
-1
-1.5
-1
0
1.5
1
1
0
1.5
-0.5
-1.5
FIGURE IV.10. Illustration of the “Daffodil Lemma”: the images of circles z = Reiθ
(R = 0.4 . . 0.8) rendered by a polar plot of |f(z)| in the case of f(z) = z7ez25 +z2/(1−
z10)), which has span 5.
In the context of periodicities, a basic property is expressed by what we have
chosen to name ﬁguratively the “Daffodil Lemma”. By virtue of this lemma, the span
of a function f with nonnegative coefﬁcients is related to the behaviour of |f(z)| as z
varies along circles centred at the origin (Figure 10).
Lemma IV.1 (“Daffodil Lemma”). Let f(z) be analytic in |z| < ρ and have nonneg-
ative coefﬁcients at 0. Assume that f does not reduce to a monomial and that for some
nonzero nonpositive z satisfying |z| < ρ, one has
|f(z)| = f(|z|).
Then, the following hold: (i) the argument of z must be commensurate to 2π, i.e.,
z = Reiθ with θ/(2π) = r
p ∈Q (an irreducible fraction) and 0 < r < p; (ii) f
admits p as a span.
PROOF. This classical lemma is a simple consequence of the strong triangle inequality.
Indeed, with z = Reiθ, the equality |f(z)| = f(|z|) implies that the complex numbers
fnRneinθ for n ∈Supp(f) all lie on the same ray (a half-line emanating from 0).
This is impossible if θ is irrational, as soon as the expansion of f contains at least two
monomials.
□
Berstel [43] ﬁrst realized that rational generating functions arising from regular
languages can only have dominant singularities of the form ρωj, where ω is a certain
root of unity. This property in fact extends to many nonrecursive speciﬁcations, as
shown by Flajolet, Salvy, and Zimmermann in [206].
Proposition IV.3 (Commensurability of dominant directions). Let S be a constructible
labelled class that is nonrecursive, in the sense of Theorem IV.8. Assume that the
EGF S(z) has a ﬁnite radius of convergence ρ. Then there exists a computable inte-
ger d ≥1 such that the set of dominant singularities of S(z) is contained in the set
{ρωj}, where ωd = 1.

254
IV. COMPLEX ANALYSIS, RATIONAL AND MEROMORPHIC ASYMPTOTICS
PROOF. (Sketch; see [43, 206]) By deﬁnition, a nonrecursive class S is obtained
from 1 and Z by means of a ﬁnite number of union, product, sequence, set, and
cycle constructions. We have seen earlier, in Section IV. 4, an inductive algorithm that
determines radii of convergence. It is then easy to enrich that algorithm and determine
simultaneously (by induction on the speciﬁcation) the period of its GF and the set of
dominant directions.
The period is determined by simple rules. For instance, if S = T ⋆U (S = T ·U)
and T, U are inﬁnite series with respective periods p, q, one has the implication
Supp(T ) ⊆a + pZ,
Supp(U) ⊆b + qZ
=⇒
Supp(S) ⊆a + b + ξZ,
with ξ = gcd(p, q). Similarly, for S = SEQ(T ),
Supp(T ) ⊆a + pZ
=⇒
Supp(S) ⊆δZ,
where now δ = gcd(a, p).
Regarding dominant singularities, the case of a sequence construction is typical.
It corresponds to g(z) = (1 −f(z))−1. Assume that f(z) = zah(zp), with p the
maximal period, and let ρ > 0 be such that f(ρ) = 1. The equations determining
any dominant singularity ζ are f(ζ) = 1, |ζ| = ρ. In particular, the equations imply
|f(ζ)| = f(|ζ|), so that, by the Daffodil Lemma, the argument of ζ must be of the
form 2πr/s. An easy reﬁnement of the argument shows that, for δ = gcd(a, p), all the
dominant directions coincide with the multiples of 2π/δ. The discussion of cycles is
entirely similar since log(1 −f)−1 has the same dominant singularities as (1 −f)−1.
Finally, for exponentials, it sufﬁces to observe that ef does not modify the singularity
pattern of f, since exp(z) is an entire function.
□
 IV.32. Daffodil lemma and unlabelled classes. Proposition IV.3 applies to any unlabelled
class S that admits a nonrecursive speciﬁcation, provided its radius of convergence ρ satisﬁes
ρ < 1. (When ρ = 1, there is a possibility of having the unit circle as a natural boundary—a
property that is otherwise decidable.)

Exact formulæ. The error terms appearing in the asymptotic expansion of coef-
ﬁcients of meromorphic functions are already exponentially small. By peeling off the
singularities of a meromorphic function layer by layer, in order of increasing modulus,
one is led to extremely precise—or even exact—expansions for the coefﬁcients. Such
exact representations are found for Bernoulli numbers Bn, surjection numbers Rn, as
well as Secant numbers E2n and Tangent numbers E2n+1, deﬁned by
∞
X
n=0
Bn
zn
n!
=
z
ez −1
(Bernoulli numbers)
∞
X
n=0
Rn
zn
n!
=
1
2 −ez
(Surjection numbers)
∞
X
n=0
E2n
z2n
(2n)!
=
1
cos(z)
(Secant numbers)
∞
X
n=0
E2n+1
z2n+1
(2n + 1)!
=
tan(z)
(Tangent numbers).

IV.6. LOCALIZATION OF SINGULARITIES
255
Bernoulli numbers. These numbers traditionally written Bn can be deﬁned by their
EGF B(z) = z/(ez −1). The function B(z) has poles at the points χk = 2ikπ, with
k ∈Z \ {0}, and the residue at χk is equal to χk,
z
ez −1 ∼
χk
z −χk
(z →χk).
The expansion theorem for meromorphic functions is applicable here: start with the
Cauchy integral formula, and proceed as in the proof of Theorem IV.10, using as
external contours a large circle of radius R that passes half way between poles. As R
tends to inﬁnity, the integrand tends to 0 (as soon as n ≥2) because the Cauchy kernel
z−n−1 decreases as an inverse power of R while the EGF remains O(R). In the limit,
corresponding to an inﬁnitely large contour, the coefﬁcient integral becomes equal to
the sum of all residues of the meromorphic function over the whole of the complex
plane.
From this argument, we get the representation Bn = −n! P
k∈Z\{0} χ−n
k . This
veriﬁes that Bn = 0 if n is odd and n ≥3. If n is even, then grouping terms two by
two, we get the exact representation (which also serves as an asymptotic expansion):
(39)
B2n
(2n)! = (−1)n−121−2nπ−2n
∞
X
k=1
1
k2n .
Reverting the equality, we have also established that
ζ(2n) = (−1)n−122n−1π2n B2n
(2n)!
with
ζ(s) =
∞
X
k=1
1
ks ,
Bn = n![zn]
z
ez −1,
a well-known identity that provides values of the Riemann zeta function ζ(s) at even
integers as rational multiples of powers of π.
Surjection numbers. In the same vein, the surjection numbers have EGF R(z) =
(2 −ez)−1 with simple poles at
χk = log 2 + 2ikπ
where
R(z) ∼1
2
1
χk −z .
Since R(z) stays bounded on circles passing half way in between poles, we ﬁnd the
exact formula, Rn = 1
2n! P
k∈Z χ−n−1
k
. An equivalent real formulation is
(40) Rn
n! = 1
2

1
log 2
n+1
+
∞
X
k=1
cos((n + 1)θk)
(log2 2 + 4k2π2)(n+1)/2 ,
θk := arctan( 2kπ
log 2),
which exhibits inﬁnitely many harmonics of fast decaying amplitude.
 IV.33. Alternating permutations, tangent and secant numbers. The relation (39) also provides
a representation of the tangent numbers since E2n−1 = (−1)n−1B2n4n(4n −1)/(2n). The
secant numbers E2n satisfy
∞
X
k=1
(−1)k
(2k + 1)2n+1 = (π/2)2n+1
2 (2n)!
E2n,
which can be read either as providing an asymptotic expansion of E2n or as an evaluation of the
sums on the left (the values of a Dirichlet L-function) in terms of π. The asymptotic number of
alternating permutations (Chapter II) is consequently known to great accuracy.


256
IV. COMPLEX ANALYSIS, RATIONAL AND MEROMORPHIC ASYMPTOTICS
 IV.34. Solutions to the equation tan(x) = x. Let xn be the nth positive root of the equation
tan(x) = x. For any integer r ≥1, the sum S(r) := P
n x−2r
n
is a computable rational
number. [From folklore and The American Mathematical Monthly.]

IV. 6.2. Localization of zeros and poles. We gather here a few results that often
prove useful in determining the location of zeros of analytic functions, and hence of
poles of meromorphic functions. A detailed treatment of this topic may be found in
Henrici’s book [265].
Let f(z) be an analytic function in a region Ωand let γ be a simple closed curve
interior to Ω, and on which f is assumed to have no zeros. We claim that the quantity
(41)
N(f; γ) =
1
2iπ
Z
γ
f ′(z)
f(z) dz
exactly equals the number of zeros of f inside γ counted with multiplicity. [Proof: the
function f ′/f has its poles exactly at the zeros of f, and the residue at each pole α
equals the multiplicity of α as a root of f; the assertion then results from the residue
theorem.]
Since a primitive function of f ′/f is log f, the integral also represents the vari-
ation of log f along γ, which is written [log f]γ. This variation itself reduces to 2iπ
times the variation of the argument of f along γ, since log(reiθ) = log r + iθ and the
modulus r has variation equal to 0 along a closed contour ([log r]γ = 0). The quantity
[θ]γ is, by its deﬁnition, 2π multiplied by the number of times the transformed contour
f(γ) winds about the origin. This observation is known as the Argument Principle:
Argument Principle. The number of zeros of f(z) (counted with multiplic-
ities) inside γ equals the winding number of the transformed contour f(γ)
around the origin.
By the same argument, if f is meromorphic in Ω∋γ, then N(f; γ) equals the differ-
ence between the number of zeros and the number of poles of f inside γ, multiplicities
being taken into account. Figure 11 exempliﬁes the use of the argument principle in
localizing zeros of a polynomial.
By similar devices, we get Rouch´e’s theorem:
Rouch´e’s theorem. Let the functions f(z) and g(z) be analytic in a region
containing in its interior the closed simple curve γ. Assume that f and g
satisfy |g(z)| < |f(z)| on the curve γ. Then f(z) and f(z) + g(z) have the
same number of zeros inside the interior domain delimited by γ.
An intuitive way to visualize Rouch´e’s Theorem is as follows: since |g| < |f|, then
f(γ) and (f + g)(γ) must have the same winding number.
 IV.35. Proof of Rouch´e’s theorem. Under the hypothesis of Rouch´e’s theorem, for 0 ≤t ≤1
h(z) = f(z) + tg(z) is such that N(h; γ) is both an integer and an analytic, hence continuous,
function of t in the given range. The conclusion of the theorem follows.

 IV.36. The Fundamental Theorem of Algebra. Every complex polynomial p(z) of degree n
has exactly n roots. A proof follows by Rouch´e’s theorem from the fact that, for large enough
|z| = R, the polynomial assumed to be monic is a “perturbation” of its leading term, zn.


IV.6. LOCALIZATION OF SINGULARITIES
257
1.8
1.6
1.4
1.2
1
0.8
0.6
0.4
0.2
0
0.8
0.6
0.4
0.2
0
-0.2
-0.4
-0.6
-0.8
0
3
2.5
2
1.5
1
0.5
0
-0.5
0
1.5
1
0.5
0
-0.5
-1
-1.5
0
5
4
3
2
1
0
-1
-2
0
4
2
0
-2
-4
0
10
8
6
4
2
0
-2
-4
-6
-8
0
8
6
4
2
0
-2
-4
-6
-8
FIGURE IV.11. The transforms of γj = {|z| =
4j
10} by P4(z) = 1 −2z + z4, for
j = 1, 2, 3, 4, demonstrate that P4(z) has no zero inside |z| < 0.4, one zero inside
|z| < 0.8, two zeros inside |z| < 1.2 and four zeros inside |z| < 1.6. The actual zeros are
at ρ4 = 0.54368, 1 and 1.11514 ± 0.77184i.
 IV.37. Symmetric function of the zeros. Let Sk(f; γ) be the sum of the kth powers of the
roots of equation f(z) = 0 inside γ. One has
Sk(f; γ) =
1
2iπ
Z f ′(z)
f(z) zk dz,
by a variant of the proof of the Argument Principle.

These principles form the basis of numerical algorithms for locating zeros of ana-
lytic functions, in particular the ones closest to the origin, which are of most interest to
us. One can start from an initially large domain and recursively subdivide it until roots
have been isolated with enough precision—the number of roots in a subdomain being
at each stage determined by numerical integration; see Figure 11 and refer for instance
to [117] for a discussion. Such algorithms even acquire the status of full proofs if one
operates with guaranteed precision routines (using, e.g., careful implementations of
interval arithmetics).
IV. 6.3. Patterns in words: a case-study. Analysing the coefﬁcients of a single
generating function that is rational is a simple task, often even bordering on the trivial,

258
IV. COMPLEX ANALYSIS, RATIONAL AND MEROMORPHIC ASYMPTOTICS
Length (k)
Types
c(z)
ρ
k = 3
aab, abb, bba, baa
1
0.61803
aba, bab
1 + z2
0.56984
aaa, bbb
1 + z + z2
0.54368
k = 4
aaab, aabb, abbb,
bbba, bbaa, baaa
1
0.54368
aaba, abba, abaa,
bbab, baab, babb
1 + z3
0.53568
abab, baba
1 + z2
0.53101
aaaa, bbbb
1 + z + z2 + z3
0.51879
FIGURE IV.12. Patterns of length 3, 4: autocorrelation polynomial and dominant poles
of S(z).
granted the exponential-polynomial formula for coefﬁcients (Theorem IV.9). How-
ever, in analytic combinatorics, we are often confronted with problems that involve
an inﬁnite family of functions. In that case, Rouch´e’s Theorem and the Argument
Principle provide decisive tools for localizing poles, while Theorems IV.3 (Residue
Theorem) and IV.10 (Expansion of meromorphic functions) serve to determine effec-
tive error terms. An illustration of this situation is the analysis of patterns in words for
which GFs have been derived in Chapters I (p. 50) and III (p. 200).
All patterns are not born equal. Surprisingly, in a random sequence of coin toss-
ings, the pattern HTT is likely to occur much sooner (after 8 tosses on average) than the
pattern HHH (needing 14 tosses on average); see the preliminary discussion in Exam-
ple I.12 (p. 56). Questions of this sort are of obvious interest in the statistical analysis
of genetic sequences [338, 491]. Say you discover that a sequence of length 100,000
on the four letters A,G,C,T contains the pattern TACTAC twice. Can this be assigned
to chance or is this likely to be a meaningful signal of some yet unknown structure?
The difﬁculty here lies in quantifying precisely where the asymptotic regime starts,
since, by Borges’s Theorem (Note I.32, p. 58), sufﬁciently long texts will almost cer-
tainly contain any ﬁxed pattern. The analysis of rational generating functions sup-
plemented by Rouch´e’s theorem provides deﬁnite answers to such questions, under
Bernoulli models at least.
We consider here the class W of words over an alphabet A of cardinality m ≥2.
A pattern p of some length k is given. As seen in Chapters I and III, its autocorre-
lation polynomial is central to enumeration. This polynomial is deﬁned as c(z) =
Pk−1
j=0 cjzj, where cj is 1 if p coincides with its jth shifted version and 0 otherwise.
We consider here the enumeration of words containing the pattern p at least once, and
dually of words excluding the pattern p. In other words, we look at problems such as:
What is the probability that a random text of length n does (or does not) contain your
name as a block of consecutive letters?
The OGF of the class of words excluding p is, we recall,
(42)
S(z) =
c(z)
zk + (1 −mz)c(z).

IV.6. LOCALIZATION OF SINGULARITIES
259
1
0.5
0.5
-0.5
0
-0.5
-1
1
0
-1
1
0.5
0.5
-0.5
0
-0.5
-1
1
0
-1
FIGURE IV.13. Complex zeros of z31 + (1 −2z)c(z) represented as joined by a polyg-
onal line: (left) correlated pattern a(ba)15; (right) uncorrelated pattern a(ab)15.
(Proposition I.4, p. 57), and we shall start with the case m = 2 of a binary alphabet.
The function S(z) is simply a rational function, but the location and nature of its poles
is yet unknown. We only know a priori that it should have a pole in the positive inter-
val somewhere between 1
2 and 1 (by Pringsheim’s Theorem and since its coefﬁcients
are in the interval [1, 2n], for n large enough). Figure 12 gives a small list, for patterns
of length k = 3, 4, of the pole ρ of S(z) that is nearest to the origin. Inspection of the
ﬁgure suggests ρ to be close to 1
2 as soon as the pattern is long enough. We are going
to prove this fact, based on Rouch´e’s Theorem applied to the denominator of (42).
As regards termwise domination of coefﬁcients, the autocorrelation polynomial
lies between 1 (for less correlated patterns like aaa...b) and 1 + z + · · · + zk−1
(for the special case aaa...a). We set aside the special case of p having only equal
letters, i.e., a “maximal” autocorrelation polynomial—this case is discussed at length
in the next chapter. Thus, in this scenario, the autocorrelation polynomial starts as
1 + zℓ+ · · · for some ℓ≥2. Fix the number A = 0.6. On |z| = A, we have
(43)
|c(z)| ≥
1 −(A2 + A3 + · · · )
 =
1 −
A2
1 −A
 = 1
10.
In addition, the quantity (1 −2z) ranges over the circle of diameter [−0.2, 1.2] as
z varies along |z| = A, so that |1 −2z| ≥0.2. All in all, we have found that, for
|z| = A,
|(1 −2z)c(z)| ≥0.02.
On the other hand, for k > 7, we have |zk| < 0.017 on the circle |z| = A. Then,
amongst the two terms composing the denominator of (42), the ﬁrst is strictly dom-
inated by the second along |z| = A. By virtue of Rouch´e’s Theorem, the number
of roots of the denominator inside |z| ≤A is then same as the number of roots of
(1 −2z)c(z). The latter number is 1 (due to the root 1
2) since c(z) cannot be 0 by the
argument of (43). Figure 13 exempliﬁes the extremely well-behaved characters of the
complex zeros.

260
IV. COMPLEX ANALYSIS, RATIONAL AND MEROMORPHIC ASYMPTOTICS
In summary, we have found that for all patterns with at least two different letters
(ℓ≥2) and length k ≥8, the denominator has a unique root in |z| ≤A = 0.6.
The property for lengths k satisfying 4 ≤k ≤7 is then easily veriﬁed directly. The
case ℓ= 1 where we are dealing with long runs of identical letters can be subjected
to an entirely similar argument (see also Example V.2, p. 285, for details). Therefore,
unicity of a simple pole ρ of S(z) in the interval (0.5, 0.6) is granted.
It is then a simple matter to determine the local expansion of s(z) near z = ρ,
S(z) ∼
z→ρ
eΛ
ρ −z ,
eΛ :=
c(ρ)
2c(ρ) −(1 −2ρ)c′(ρ) −kρk−1 ,
from which a precise estimate for coefﬁcients derives by Theorems IV.9 and IV.10.
The computation ﬁnally extends almost verbatim to nonbinary alphabets, with ρ
being now close to
1
m. It sufﬁces to use the disc of radius A = 1.2/m. The Rouch´e
part of the argument grants us unicity of the dominant pole in the interval (1/m, A)
for k ≥5 when m = 3, and for k ≥4 and any m ≥4. (The remaining cases are
easily checked individually.)
Proposition IV.4. Consider an m-ary alphabet. Let p be a ﬁxed pattern of length k ≥
4, with autocorrelation polynomial c(z). Then the probability that a random word of
length n does not contain p as a pattern (a block of consecutive letters) satisﬁes
(44)
PWn(p does not occur) = Λp(mρ)−n−1 + O
 5
6
n

,
where ρ ≡ρp is the unique root in ( 1
m,
6
5m) of the equation zk + (1 −mz)c(z) = 0
and Λp := mc(ρ)/(mc(ρ) −c′(ρ)(1 −mρ) −kρk−1).
Despite their austere appearance, these formulæ have indeed a fairly concrete
content. First, the equation satisﬁed by ρ can be put under the form mz = 1+zk/c(z),
and, since ρ is close to
1
m, we may expect the approximation (remember the use of
“≈” as meaning “numerically approximately equal”)
mρ ≈1 +
1
γmk ,
where γ := c(m−1) satisﬁes 1 ≤γ < m/(m −1). By similar principles, the
probabilities in (44) should be approximately
PWn(p does not occur) ≈

1 +
1
γmk
−n
≈e−n/(γmk).
For a binary alphabet, this tells us that the occurrence of a pattern of length k starts
becoming likely when n is of the order of 2k, that is, when k is of the order of log2 n.
The more precise moment when this happens must depend (via γ) on the autocorrela-
tion of the pattern, with strongly correlated patterns having a tendency to occur a little
late. (This vastly generalizes our empirical observations of Chapter I.) However, the
mean number of occurrences of a pattern in a text of length n does not depend on the
shape of the pattern. The apparent paradox is easily resolved: correlated patterns tend
to occur late, while being prone to appear in clusters. For instance, the “late” pattern
aaa, when it occurs, still has probability 1
2 to occur at the next position as well and

IV. 7. SINGULARITIES AND FUNCTIONAL EQUATIONS
261
cash in another occurrence; in contrast no such possibility is available to the “early”
uncorrelated pattern aab, whose occurrences must be somewhat spread out.
Such analyses are important as they can be used to develop a precise understand-
ing of the behaviour of data compression algorithms (the Lempel–Ziv scheme); see
Julien Fayolle’s contribution [160] for details.
 IV.38. Multiple pattern occurrences.
A similar analysis applies to the generating func-
tion S⟨s⟩(z) of words containing a ﬁxed number s of occurrences of a pattern p. The OGF is
obtained by expanding (with respect to u) the BGF W (z, u) obtained in Chapter III by means
of an inclusion-exclusion argument. For s ≥1, one ﬁnds
S⟨s⟩(z) = zk N(z)s−1
D(z)s+1 ,
D(z) = zk+(1−mz)c(z),
N(z) = zk+(1−mz)(c(z)−1)),
which now has a pole of multiplicity s + 1 at z = ρ.

 IV.39. Patterns in Bernoulli sequences—asymptotics. Similar results hold when letters are
assigned nonuniform probabilities, pj = P(aj), for aj ∈A. The weighted autocorrelation
polynomial is then deﬁned by protrusions, as in Note III.38 (p. 202). Multiple pattern occur-
rences can be also analysed.

IV. 7. Singularities and functional equations
In the various combinatorial examples discussed so far in this chapter, we have
been dealing with functions that are given by explicit expressions. Such situations
essentially cover nonrecursive structures as well as the very simplest recursive ones,
like Catalan or Motzkin trees, whose generating functions are expressible in terms of
radicals. In fact, as will shall see extensively in this book, complex analytic methods
are instrumental in analysing coefﬁcients of functions implicitly speciﬁed by func-
tional equations. In other words: the nature of a functional equation can often provide
information regarding the singularities of its solution. Chapter V will illustrate this
philosophy in the case of rational functions deﬁned by systems of positive equations;
a very large number of examples will then be given in Chapters VI and VII, where
singularities much more general than poles are treated.
In this section, we discuss three representative functional equations,
f(z) = zef(z),
f(z) = z + f(z2 + z3),
f(z) =
1
1 −zf(z2).
that illustrate the use of fundamental inversion or iteration properties to locate domi-
nant singularities and derive exponential growth estimates for coefﬁcients.
IV. 7.1. Inverse functions. We start with a generic problem: given a function ψ
analytic at a point y0 with z0 = ψ(y0) what can be said about its inverse, namely the
solution(s) to the equation ψ(y) = z when z is near z0 and y near y0?
Let us examine what happens when ψ′(y0) ̸= 0, ﬁrst without paying attention to
analytic rigour. One has locally (‘≈’ means as usual ‘approximately equal’)
(45)
ψ(y) ≈ψ(y0) + ψ′(y0)(y −y0),
so that the equation ψ(y) = z should admit, for z near z0, a solution satisfying
(46)
y ≈y0 +
1
ψ′(y0)(z −z0).

262
IV. COMPLEX ANALYSIS, RATIONAL AND MEROMORPHIC ASYMPTOTICS
If this is granted, the solution being locally linear, it is differentiable, hence analytic.
The Analytic Inversion Lemma12 provides a ﬁrm foundation for this calculation.
Lemma IV.2 (Analytic Inversion). Let ψ(z) be analytic at y0, with ψ(y0) = z0.
Assume that ψ′(y0) ̸= 0. Then, for z in some small neighbourhood Ω0 of z0, there
exists an analytic function y(z) that solves the equation ψ(y) = z and is such that
y(z0) = y0.
PROOF. (Sketch) The proof involves ideas analogous to those used to establish Rouch´e’s
Theorem and the Argument Principle (see especially the argument justifying Equa-
tion (41), p. 256) As a preliminary step, deﬁne the integrals (j ∈Z≥0)
(47)
σj(z) :=
1
2iπ
Z
γ
ψ′(y)
ψ(y) −z yj dy,
where γ is a small enough circle centred at y0 in the y-plane.
First consider σ0. This function satisﬁes σ0(z0) = 1 [by the Residue Theorem]
and is a continuous function of z whose value can only be an integer, this value being
the number of roots of the equation ψ(y) = z. Thus, for z close enough to z0, one
must have σ0(z) ≡1. In other words, the equation ψ(y) = z has exactly one solution,
the function ψ is locally invertible and a solution y = y(z) that satisﬁes y(z0) = y0 is
well-deﬁned.
Next examine σ1. By the Residue Theorem once more, the integral deﬁning σ1(z)
is the sum of the roots of the equation ψ(y) = z that lie inside γ, that is, in our case,
the value of y(z) itself. (This is also a particular case of Note 37.) Thus, one has
σ1(z) ≡y(z). Since the integral deﬁning σ1(z) depends analytically on z for z close
enough to z0, analyticity of y(z) results.
□
 IV.40. Details. Let ψ be analytic in an open disc D centred at y0. Then, there exists a small
circle γ centred at y0 and contained in D such that ψ(y) ̸= y0 on γ. [Zeros of analytic functions
are isolated, a fact that results from the deﬁnition of an analytic expansion]. The integrals σj(z)
are thus well deﬁned for z restricted to be close enough to z0, which ensures that there exists
a δ > 0 such that |ψ(y) −z| > δ for all y ∈γ. One can then expand the integrand as a
power series in (z −z0), integrate the expansion termwise, and form in this way the analytic
expansions of σ0, σ1 at z0. [This line of proof follows [269, I, §9.4].]

 IV.41. Inversion and majorant series. The process corresponding to (45) and (46) can be
transformed into a sound proof: ﬁrst derive a formal power series solution, then verify that the
formal solution is locally convergent using the method of majorant series (p. 236).

The Analytic Inversion Lemma states the following: An analytic function locally
admits an analytic inverse near any point where its ﬁrst derivative is nonzero. How-
ever, as we see next, a function cannot be analytically inverted in a neighbourhood of
a point where its ﬁrst derivative vanishes.
Consider now a function ψ(y) such that ψ′(y0) = 0 but ψ′′(y0) ̸= 0, then, by the
Taylor expansion of ψ, one expects
(48)
ψ(y) ≈ψ(y0) + 1
2(y −y0)2ψ′′(y0).
12A more general statement and several proof techniques are also discussed in APPENDIX B: Implicit
Function Theorem, p. 698.

IV. 7. SINGULARITIES AND FUNCTIONAL EQUATIONS
263
Solving formally for y now indicates a locally quadratic dependency
(y −y0)2 ≈
2
ψ′′(y0)(z −z0),
and the inversion problem admits two solutions satisfying
(49)
y ≈y0 ±
s
2
ψ′′(y0)
√z −z0.
What this informal argument suggests is that the solutions have a singularity at z0, and,
in order for them to be suitably speciﬁed, one must somehow restrict their domain of
deﬁnition: the case of √z (the root(s) of y2 −z = 0) discussed on p. 217 is typical.
Given some point z0 and a neighbourhood Ω, the slit neighbourhood along direc-
tion θ, is the set
Ω\θ :=

z ∈Ω
 arg(z −z0) ̸≡θ mod 2π
	
.
We state:
Lemma IV.3 (Singular Inversion). Let ψ(y) be analytic at y0, with ψ(y0) = z0.
Assume that ψ′(y0) = 0 and ψ′′(y0) ̸= 0. There exists a small neighbourhood Ω0
such that the following holds: for any direction θ, there exist two functions, y1(z)
and y2(z) deﬁned on Ω\θ
0 that satisfy ψ(y(z)) = z; each is analytic in Ω\θ
0 , has a
singularity at the point z0, and satisﬁes limz→z0 y(z) = y0.
PROOF. (Sketch) Deﬁne the functions σj(z) as in the proof of the previous lemma,
Equation (47). One now has σ0(z) = 2, that is, the equation ψ(y) = z possesses two
roots near y0, when z is near z0. In other words ψ effects a double covering of a small
neighbourhood Ωof y0 onto the image neighbourhood Ω0 = ψ(Ω) ∋z0. By possibly
restricting Ω, we may furthermore assume that ψ′(y) only vanishes at y0 in Ω(zeros
of analytic functions are isolated) and that Ωis simply connected.
Fix any direction θ and consider the slit neighbourhood Ω\θ
0 . Fix a point ζ in
this slit domain; it has two preimages, η1, η2 ∈Ω. Pick up the one named η1. Since
ψ′(η1) is nonzero, the Analytic Inversion lemma applies: there is a local analytic
inverse y1(z) of ψ. This y1(z) can then be uniquely continued13 to the whole of Ω\θ
0 ,
and similarly for y2(z). We have thus obtained two distinct analytic inverses.
Assume a contrario that y1(z) can be analytically continued at z0. It would then
admit a local expansion
y1(z) =
X
n≥0
cn(z −z0)n,
while satisfying ψ(y1(z)) = z. But then, composing the expansions of ψ and y would
entail
ψ(y1(z)) = z0 + O
 (z −z0)2
(z →z0),
13The fact of slitting Ω0 makes the resulting domain simply connected, so that analytic continuation
becomes uniquely deﬁned. In contrast, the punctured domain Ω0 \ {z0} is not simply connected, so that
the argument cannot be applied to it. As a matter of fact, y1(z) gets continued to y2(z), when the ray of
angle θ is crossed: the point z0 where two determinations meet is a branch point.

264
IV. COMPLEX ANALYSIS, RATIONAL AND MEROMORPHIC ASYMPTOTICS
which cannot coincide with the identity function (z). A contradiction has been reached.
The point z0 is thus a singular point for y1 (as well as for y2).
□
 IV.42. Singular inversion and majorant series. In a way that parallels Note 41, the process
summarized by Equations (48) and (49) can be justiﬁed by the method of majorant series, which
leads to an alternative proof of the Singular Inversion Lemma.

 IV.43. Higher order branch points. If all derivatives of ψ till order r −1 inclusive vanish
at y0, there are r inverses, y1(z), . . . , yr(z), deﬁned over a slit neighbourhood of z0.

Tree enumeration. We can now consider the problem of obtaining information
on the coefﬁcients of a function y(z) deﬁned by an implicit equation
(50)
y(z) = zφ(y(z)),
when φ(u) is analytic at u = 0. In order for the problem to be well-posed (alge-
braically, in terms of formal power series, as well as analytically, near the origin), we
assume that φ(0) ̸= 0. Equation (50) may then be rephrased as
(51)
ψ(y(z)) = z
where
ψ(u) =
u
φ(u),
so that it is in fact an instance of the inversion problem for analytic functions.
Equation (50) occurs in the counting of various types of trees, as seen in Subsec-
tions I. 5.1 (p. 61), II. 5.1 (p. 116), and III.6.2 (p. 182). A typical case is φ(u) = eu,
which corresponds to labelled nonplane trees, known as Cayley trees. The function
φ(u) = (1 + u)2 is associated to unlabelled plane binary trees and φ(u) = 1 + u + u2
to unary–binary trees (Motzkin trees). A full analysis was developed by Meir and
Moon [356], themselves elaborating on earlier ideas of P´olya [395, 397] and Ot-
ter [382]. In all these cases, the exponential growth rate of the number of trees can be
automatically determined.
Proposition IV.5. Let φ be a function analytic at 0, having nonnegative Taylor coef-
ﬁcients, and such that φ(0) ̸= 0. Let R ≤+∞be the radius of convergence of the
series representing φ at 0. Under the condition,
(52)
lim
x→R−
xφ′(x)
φ(x)
> 1,
there exists a unique solution τ ∈(0, R) of the characteristic equation,
(53)
τφ′(τ)
φ(τ)
= 1.
Then, the formal solution y(z) of the equation y(z) = zφ(y(z)) is analytic at 0 and
its coefﬁcients satisfy the exponential growth formula:
[zn] y(z) ⊲⊳
1
ρ
n
where
ρ =
τ
φ(τ) =
1
φ′(τ).
Note that condition (52) is automatically realized as soon as φ(R−) = +∞, which
covers our earlier examples as well as all the cases where φ is an entire function (e.g.,
a polynomial). Figure 14 displays graphs of functions on the real line associated to a
typical inversion problem, that of Cayley trees, where φ(u) = eu.

IV. 7. SINGULARITIES AND FUNCTIONAL EQUATIONS
265
2
4
6
0
0.5
1
1.5
2
 u
φ(u)
0
0.1
0.2
0.3
0.5
1
1.5
2
 u
ψ(u)
0
0.5
1
1.5
2
y
0.1
0.2
0.3
 
z
y(z)
FIGURE IV.14. Singularities of inverse functions: φ(u) = eu (left); ψ(u) = u/φ(u)
(middle); y = Inv(ψ) (right).
PROOF. By Note 44 below, the function xφ′(x)/φ(x) is an increasing function of x
for x ∈(0, R). Condition (52) thus guarantees the existence and unicity of a solution
of the characteristic equation. (Alternatively, rewrite the characteristic equation as
φ0 = φ2τ 2 + 2φ3τ 3 + · · · , where the right side is clearly an increasing function.)
Next, we observe that the equation y = zφ(y) admits a unique formal power
series solution, which furthermore has nonnegative coefﬁcients. (This solution can for
instance be built by the method of indeterminate coefﬁcients.) The Analytic Inversion
Lemma (Lemma IV.2) then implies that this formal solution represents a function,
y(z), that is analytic at 0, where it satisﬁes y(0) = 0.
Now comes the hunt for singularities and, by Pringsheim’s Theorem, one may
restrict attention to the positive real axis. Let r ≤+∞be the radius of convergence
of y(z) at 0 and set y(r) := limx→r−y(x), which is well deﬁned (though possibly
inﬁnite), given positivity of coefﬁcients. Our goal is to prove that y(r) = τ.
— Assume a contrario that y(r) < τ. One would then have ψ′(y(r)) ̸= 0. By
the Analytic Inversion Lemma, y(z) would be analytic at r, a contradiction.
— Assume a contrario that y(r) > τ. There would then exist r∗∈(0, r) such
that ψ′(y(r∗)) = 0. But then y would be singular at r∗, by the Singular
Inversion Lemma, also a contradiction.
Thus, one has y(r) = τ, which is ﬁnite. Finally, since y and ψ are inverse functions,
one must have
r = ψ(τ) = τ/φ(τ) = ρ,
by continuity as x →r−, which completes the proof.
□
Proposition IV.5 thus yields an algorithm that produces the exponential growth
rate associated to tree functions. This rate is itself invariably a computable number as
soon as φ is computable (i.e., its sequence of coefﬁcients is computable). This com-
putability result complements Theorem IV.8 which is relative to nonrecursive struc-
tures only.
As an example of application of Proposition IV.5, general Catalan trees corre-
spond to φ(y) = (1−y)−1, whose radius of convergence is R = 1. The characteristic
equation is τ/(1 −τ) = 1, which implies τ =
1
2 and ρ =
1
4. We obtain (not a

266
IV. COMPLEX ANALYSIS, RATIONAL AND MEROMORPHIC ASYMPTOTICS
Type
φ(u)
(R)
τ
ρ
yn ⊲⊳ρ−n
binary tree
(1 + u)2
(∞)
1
1
4
yn ⊲⊳4n
Motzkin tree
1 + u + u2
(∞)
1
1
3
yn ⊲⊳3n
gen. Catalan tree
1
1 −u
(1)
1
2
1
4
yn ⊲⊳4n
Cayley tree
eu
(∞)
1
e−1
yn ⊲⊳en
FIGURE IV.15. Exponential growth for classical tree families.
suprise!) yn ⊲⊳4n, a weak asymptotic formula for the Catalan numbers. Similarly,
for Cayley trees, φ(u) = eu and R = +∞. The characteristic equation reduces to
(τ −1)eτ = 0, so that τ = 1 and ρ = e−1, giving a weak form of Stirling’s formula:
[zn]y(z) = nn−1
n!
⊲⊳en. Figure 15 summarizes the application of the method to a few
already encountered tree families.
As our previous discussion suggests, the dominant singularity of tree generating
functions is, under mild conditions, of the square-root type. Such a singular behaviour
can then be analysed by the methods of Chapter VI: the coefﬁcients admit an asymp-
totic form
[zn] y(z) ∼C · ρ−nn−3/2,
with a subexponential factor of the form n−3/2; see Section VI. 7, p. 385.
 IV.44. Convexity of GFs, Boltzmann models, and the Variance Lemma. Let φ(z) be a non-
constant analytic function with nonnegative coefﬁcients and a nonzero radius of convergence R,
such that φ(0) ̸= 0. For x ∈(0, R) a parameter, deﬁne the Boltzmann random variable Ξ (of
parameter x) by the property
(54)
P(Ξ = n) = φnxn
φ(x) ,
with
E(sΞ) = φ(sx)
φ(x)
the probability generating function of Ξ. By differentiation, the ﬁrst two moments of Ξ are
E(Ξ) = xφ′(x)
φ(x) ,
E(Ξ2) = x2φ′′(x)
φ(x)
+ xφ′(x)
φ(x) .
There results, for any nonconstant GF φ, the general convexity inequality valid for 0 < x < R:
(55)
d
dx
„xφ′(x)
φ(x)
«
> 0,
due to the fact that the variance of a nondegenerate random variable is always positive. Equiv-
alently, the function log(φ(et)) is convex for t ∈(−∞, log R). (In statistical physics, a Boltz-
mann model (of parameter x) corresponds to a class Φ (with OGF φ) from which elements
are drawn according to the size distribution (54). An alternative derivation of (55) is given in
Note VIII.4, p. 516.)

 IV.45. A variant form of the inversion problem. Consider the equation y = z+φ(y), where φ
is assumed to have nonegative coefﬁcients and be entire, with φ(u) = O(u2) at u = 0. This
corresponds to a simple variety of trees in which trees are counted by the number of their leaves
only. For instance, we have already encountered labelled hierarchies (phylogenetic trees in
Section II. 5, p. 119) corresponding to φ(u) = eu−1−u, which gives rise to one of “Schr¨oder’s
problems”. Let τ be the root of φ′(τ) = 1 and set ρ = τ −φ(τ). Then [zn]y(z) ⊲⊳ρ−n. For
the EGF L of labelled hierarchies (L = z + eL −1 −L), this gives Ln/n! ⊲⊳(2 log 2 −1)−n.
(Observe that Lagrange inversion also provides [zn]y(z) = 1
n[wn−1](1 −y−1φ(y))−n.)


IV. 7. SINGULARITIES AND FUNCTIONAL EQUATIONS
267
IV. 7.2. Iteration. The study of iteration of analytic functions was launched by
Fatou and Julia in the ﬁrst half of the twentieth century. Our reader is certainly aware
of the beautiful images associated with the name of Mandelbrot whose works have
triggered renewed interest in these questions now classiﬁed as resorting to the ﬁeld
of “complex dynamics” [24, 122, 362, 387]. In particular, the sets that appear in this
context are often of a fractal nature. Mathematical objects of this sort are occasionally
encountered in analytic combinatorics. We present here the ﬁrst steps of a classic
analysis of balanced trees published by Odlyzko [375] in 1982.
Consider the class E of balanced 2–3 trees deﬁned as trees whose node degrees
are restricted to the set {0, 2, 3}, with the additional property that all leaves are at the
same distance from the root (Note 57, p. 83). We adopt as notion of size the number
of leaves (also called external nodes), the list of all 4 trees of size 8 being:
Given an existing tree, a new tree is obtained by substituting in all possible ways to
each external node (2) either a pair (2, 2) or a triple (2, 2, 2), and symbolically,
one has
E[2] = 2 + E

2 →(22 + 222)

.
In accordance with the speciﬁcation, the OGF of E satisﬁes the functional equation
(56)
E(z) = z + E(z2 + z3),
corresponding to the seemingly innocuous recurrence
En =
n
X
k=0

k
n −2k

Ek
with
E0 = 0, E1 = 1.
Let σ(z) = z2 + z3. Equation (56) can be expanded by iteration in the ring of
formal power series,
(57)
E(z) = z + σ(z) + σ[2](z) + σ[3](z) + · · · ,
where σ[j](z) denotes the jth iterate of the polynomial σ: σ[0](z) = z, σ[h+1](z) =
σ[h](σ(z)) = σ(σ[h](z)). Thus, E(z) is nothing but the sum of all iterates of σ.
The problem is to determine the radius of convergence of E(z), and by Pringsheim’s
theorem, the quest for dominant singularities can be limited to the positive real line.
For z > 0, the polynomial σ(z) has a unique ﬁxed point, ρ = σ(ρ), at
ρ = 1
ϕ
where
ϕ = 1 +
√
5
2
is the golden ratio. Also, for any positive x satisfying x < ρ, the iterates σ[j](x)
do converge to 0; see Figure 16. Furthermore, since σ(z) ∼z2 near 0, these iterates
converge to 0 doubly exponentially fast (Note 46). By the triangle inequality, |σ(z)| ≤
σ(|z|), the sum in (57) is a normally converging sum of analytic functions, and is thus
itself analytic. Consequently E(z) is analytic in the whole of the open disk |z| < ρ.

268
IV. COMPLEX ANALYSIS, RATIONAL AND MEROMORPHIC ASYMPTOTICS
 
0
0.7
0.6
0.5
0.4
0.3
0.2
0.1
0
0
1
0.8
0.6
0.4
0.2
0
x0 = 0.6
x1 = 0.576
x2 = 0.522878976
x3
.= 0.416358802
x4
.= 0.245532388
x5
.= 0.075088357
x6
.= 0.006061629
x7
.= 0.000036966
x8
.= 0.000000001
x9
.= 1.867434390 × 10−18
x10 .= 3.487311201 × 10−36
FIGURE IV.16. The iterates of a point x0 ∈(0, 1
ϕ), here x0 = 0.6, by σ(z) = z2 + z3
converge fast to 0.
It remains to prove that the radius of convergence of E(z) is exactly equal to ρ.
To that purpose it sufﬁces to observe that E(z), as given by (57), satisﬁes
E(x) →+∞
as
x →ρ−.
Let N be an arbitrarily large but ﬁxed integer. It is possible to select a positive xN
sufﬁciently close to ρ with xN < ρ, such that the Nth iterate σ[N](xN) is larger than
1
2 (the function σ[N](x) admits ρ as a ﬁxed point and it is continuous and increasing at
ρ). Given the sum expression (57), this entails the lower bound E(xN) > N
2 for such
an xN < ρ. Thus E(x) is unbounded as x →ρ−and ρ is a singularity.
The dominant positive real singularity of E(z) is thus ρ = ϕ−1, and the Expo-
nential Growth Formula gives:
Proposition IV.6. The number of balanced 2–3 trees satisﬁes:
(58)
[zn] E(z) ⊲⊳
 1 +
√
5
2
n.
It is notable that this estimate could be established so simply by a purely qualita-
tive examination of the basic functional equation and of a ﬁxed point of the associated
iteration scheme.
The complete asymptotic analysis of the En requires the full power of singular-
ity analysis methods to be developed in Chapter VI. Equation (59) below states the
end result, which involves ﬂuctuations that are clearly visible on Figure 17. There is
overconvergence of the representation (57), that is, convergence in certain domains
beyond the disc of convergence of E(z). Figure 17 displays the domain of analyticity
of E(z) and reveals its fractal nature.
 IV.46. Quadratic convergence. First, for x ∈[0, 1
2], one has σ(x) ≤3
2x2, so that σ[j](x) ≤
(3/2)2j−1 x2j. Second, for x ∈[0, A], where A is any number < ρ, there is a number kA such
that σ[kA](x) < 1
2, so that σ[k](x) ≤(3/2) (3/4)2k−kA . Thus, for any A < ρ, the series of
iterates of σ is quadratically convergent when z ∈[0, A].


IV. 7. SINGULARITIES AND FUNCTIONAL EQUATIONS
269
0
-1
-1.5
-0.5
-1
0
0.5
0.5
1
-0.5
0.6
 
0.7
 
0.8
 
0.9
0
1
2
3
4
5
6
FIGURE IV.17. Left: the circle of convergence of E(z) and its fractal domain of ana-
lyticity (in gray with darker areas representing slower convergence of iterates of σ). Right:
the ratio En/(ϕnn−1) plotted against log n for n = 1 . . 500 conﬁrms that En ⊲⊳ϕn and
illustrates the periodic ﬂuctuations expressed by Equation (59).
 IV.47. The asymptotic number of 2–3 trees. This analysis is from [375, 377]. The number of
2–3 trees satisﬁes asymptotically
(59)
En = ϕn
n Ω(log n) + O
„ϕn
n2
«
,
where Ωis a periodic function with mean value (ϕ log(4 −ϕ))−1
.= 0.71208 and period
log(4 −ϕ) .= 0.86792. Thus oscillations are inherent in En. A plot of the ratio En/(ϕn/n) is
offered in Figure 17.

IV. 7.3. Complete asymptotics of a functional equation. George P´olya (1887–
1985) is mostly remembered by combinatorialists for being at the origin of P´olya
theory, a branch of combinatorics that deals with the enumeration of objects invariant
under symmetry groups. However, in his classic article [395, 397] which founded
this theory, P´olya discovered at the same time a number of startling applications of
complex analysis to asymptotic enumeration14 . We detail one of these now.
The combinatorial problem of interest here is the determination of the number Mn
of chemical isomeres of alcohols CnH2n+1OH without asymmetric carbon atoms.
The OGF M(z) = P
n Mnzn that starts as (EIS A000621)
(60) M(z) = 1 + z + z2 + 2z3 + 3z4 + 5z5 + 8z6 + 14z7 + 23z8 + 39z9 + · · · ,
is accessible through a functional equation:
(61)
M(z) =
1
1 −zM(z2).
14In many ways, P´olya can be regarded as the grand father of the ﬁeld of analytic combinatorics.

270
IV. COMPLEX ANALYSIS, RATIONAL AND MEROMORPHIC ASYMPTOTICS
Iteration of the functional equation leads to a continued fraction representation,
M(z) =
1
1 −
z
1 −
z2
1 −z4
...
,
from which P´olya found:
Proposition IV.7. Let M(z) be the solution analytic around 0 of the functional equa-
tion
M(z) =
1
1 −zM(z2).
Then, there exist constants K, β, and B > 1, such that
Mn = K · βn  1 + O(B−n)

,
β .= 1.68136 75244,
K .= 0.36071 40971.
PROOF. We offer two proofs. The ﬁrst one is based on direct consideration of the
functional equation and is of a fair degree of applicability. The second one, following
P´olya, makes explicit a special linear structure present in the problem. As suggested
by the main estimate, the dominant singularity of M(z) is a simple pole.
First proof.
By positivity of the functional equation, M(z) dominates coef-
ﬁcientwise any GF (1 −zM <m(z2))−1, where M <m(z) := P
0≤j<m Mnzn is
the mth truncation of M(z).
In particular, one has the domination relation (use
M <2(z) = 1 + z)
M(z) ⪰
1
1 −z −z3 .
Since the rational fraction has its dominant pole at z .= 0.68232, this implies that
the radius ρ of convergence of M(z) satisﬁes ρ < 0.69. In the other direction, since
M(z2) < M(z) for z ∈(0, ρ), then, one has the numerical inequality
M(z) ≤
1
1 −zM(z),
0 ≤z < ρ.
This can be used to show (Note 48) that the Catalan generating function C(z) = (1 −
√1 −4z)/(2z) is a majorant of M(z) on the interval (0, 1
4), which implies that M(z)
is well deﬁned and analytic for z ∈(0, 1
4). In other words, one has 1
4 ≤ρ < 0.69.
Altogether, the radius of convergence of M lies strictly between 0 and 1.
 IV.48. Alcohols, trees, and bootstrapping.
Since M(z) starts as 1 + z + z2 + · · · while
C(z) starts as 1 + z + 2z2 + · · · , there is a small interval (0, ǫ) such that M(z) ≤C(z). By
the functional equation of M(z), one has M(z) ≤C(z) for z in the larger interval (0, √ǫ).
Bootstrapping then shows that M(z) ≤C(z) for z ∈(0, 1
4).

Next, as z →ρ−, one must have zM(z2) →1. (Indeed, if this was not the
case, we would have zM(z2) < A < 1 for some A. But then, since ρ2 < ρ, the
quantity (1 −zM(z2))−1 would be analytic at z = ρ, a clear contradiction.) Thus, ρ
is determined implicitly by the equation
ρM(ρ2) = 1,
0 < ρ < 1.

IV. 7. SINGULARITIES AND FUNCTIONAL EQUATIONS
271
One can estimate ρ numerically (Note 49), and the statement follows with β = 1/ρ.
(P´olya determined ρ to ﬁve decimals by hand!)
The previous discussion also implies that ρ is a pole of M(z), which must be
simple (since ∂z(zM(z2)

z=ρ > 0). Thus
(62)
M(z) ∼
z→ρ K
1
1 −z/ρ,
K :=
1
ρM(ρ2) + 2ρ3M ′(ρ2).
The argument shows at the same time that M(z) is meromorphic in |z| < √ρ .= 0.77.
That ρ is the only pole of M(z) on |z| = ρ results from the fact that zM(z2) =
z +z3+· · · can be subjected to the type of argument encountered in the context of the
Daffodil Lemma (see the discussion of quasi-inverses in the proof of Proposition IV.3,
p. 253). The translation of the singular expansion (62) then yields the statement.
 IV.49. The growth constant of molecules. The quantity ρ can be obtained as the limit of
the ρm satisfying Pm
n=0 Mnρ2n+1
m
= 1, together with ρ ∈[ 1
4, 0.69]. In each case, only a
few of the Mn (provided by the functional equation) are needed. One obtains: ρ10 .= 0.595,
ρ20
.= 0.594756, ρ30
.= 0.59475397, ρ40
.= 0.594753964. This algorithms constitutes a
geometrically convergent scheme with limit ρ .= 0.59475 39639.

Second proof. First, a sequence of formal approximants follows from (61) starting
with
1,
1
1 −z ,
1
1 −
z
1 −z2
=
1 −z2
1 −z −z2 ,
1
1 −
z
1 −
z2
1 −z4
=
1 −z2 −z4
1 −z −z2 −z4 + z5 ,
which permits us to compute any number of terms of the series M(z). Closer exami-
nation of (61) suggests to set
M(z) = ψ(z2)
ψ(z) ,
where ψ(z) = 1 −z −z2 −z4 + z5 −z8 + z9 + z10 −z16 + · · · . Back substitution
into (61) yields
ψ(z2)
ψ(z) =
1
1 −z ψ(z4)
ψ(z2)
or ψ(z2)
ψ(z) =
ψ(z2)
ψ(z2) −zψ(z4),
which shows ψ(z) to be a solution of the functional equation
ψ(z) = ψ(z2) −zψ(z4),
ψ(0) = 1.
The coefﬁcients of ψ satisfy the recurrence
ψ4n = ψ2n,
ψ4n+1 = −ψn,
ψ4n+2 = ψ2n+1,
ψ4n+3 = 0,
which implies that their values are all contained in the set {0, −1, +1}.
Thus, M(z) appears to be the quotient of two function, ψ(z2)/ψ(z), each analytic
in the unit disc, and M(z) is meromorphic in the unit disc. A numerical evaluation
then shows that ψ(z) has its smallest positive real zero at ρ .= 0.59475, which is a

272
IV. COMPLEX ANALYSIS, RATIONAL AND MEROMORPHIC ASYMPTOTICS
simple root. The quantity ρ is thus a pole of M(z) (since, numerically, ψ(ρ2) ̸= 0).
Thus
M(z) ∼
ψ(ρ2)
(z −ρ)ψ′(ρ) =⇒Mn ∼−ψ(ρ2)
ρψ′(ρ)
1
ρ
n
.
Numerical computations then yield P´olya’s estimate. Et voil`a!
□
The example of P´olya’s alcohols is exemplary, both from a historical point of
view and from a methodological perspective. As the ﬁrst proof of Proposition IV.7
demonstrates, quite a lot of information can be pulled out of a functional equation
without solving it. (A similar situation will be encountered in relation to coin foun-
tains, Example V.7, p. 307.) Here, we have made great use of the fact that if f(z) is
analytic in |z| < r and some a priori bounds imply the strict inequalities 0 < r < 1,
then one can regard functions like f(z2), f(z3), and so on, as “known” since they are
analytic in the disc of convergence of f and even beyond, a situation also evocative
of our earlier discussion of P´olya operators in Subsection IV. 4. Globally, the lesson
is that functional equations, even complicated ones, can be used to bootstrap the local
singular behaviour of solutions, and one can often do so even in the absence of any
explicit generating function solution. The transition from singularities to coefﬁcient
asymptotics is then a simple jump.
 IV.50. An arithmetic exercise. The coefﬁcients ψn = [zn]ψ(z) can be characterized simply
in terms of the binary representation of n. Find the asymptotic proportion of the ψn for n ∈
[1 . . 2N] that assume each of the values 0, +1, and −1.

IV. 8. Perspective
In this chapter, we have started examining generating functions under a new light.
Instead of being merely formal algebraic objects—power series—that encode ex-
actly counting sequences, generating functions can be regarded as analytic objects—
transformations of the complex plane—whose singularities provide a wealth of infor-
mation concerning asymptotic properties of structures.
Singularities provide a royal road to coefﬁcient asymptotics. We could treat here,
with a relatively simple apparatus, singularities that are poles. In this perspective,
the two main statements of this chapter are the theorems relative to the expansion of
rational and meromorphic functions, (Theorems IV.9 and IV.10). These are classical
results of analysis. Issai Schur (1875–1941) is to be counted amongst the very ﬁrst
mathematicians who recognized their rˆole in combinatorial enumerations (denumer-
ants, Example 5, p. 244). The complex-analytic thread was developed much further by
George P´olya in his famous paper of 1937 (see [395, 397]), which Read in [397, p. 96]
describes as a “landmark in the history of combinatorial analysis”. There, P´olya laid
the groundwork of combinatorial chemistry, the enumeration of objects under group
actions, as well as the complex-asymptotic theory of graphs and trees.
The present chapter serves as the foundation stone of a rich theory to be devel-
oped in future chapters. In particular the method of singularity analysis exposed in
Chapter VI considerably extends the range of applicability of the Second Principle to
functions having singularities appreciably more complicated that poles (e.g., the ones
involving fractional powers, logarithms, iterated logarithms, and so on).

IV. 8. PERSPECTIVE
273
Basics. The theory of analytic functions beneﬁts from the equivalence between two no-
tions, analyticity and differentiability. It is the basis of a powerful integral calculus, much
different from its real variable counterpart. The following two results can serve as “axioms” of
the theory.
THEOREM IV.1 [Basic Equivalence Theorem] (p. 219): Two fundamental notions are equiv-
alent, namely, analyticity (deﬁned by convergent power series) and holomorphy (deﬁned by
differentiability). Combinatorial generating functions, a priori determined by their expansions
at 0 thus satisfy the rich set of properties associated with these two equivalent notions.
THEOREM IV.2 [Null Integral Property] (p. 221): The integral of an analytic function along a
simple loop (closed path that can be contracted to a single point) is 0. Consequently, integrals
are largely independent of particular details of the integration contour.
Residues. For meromorphic functions (functions with poles), residues are essential. Co-
efﬁcients of a function can be evaluated by means of integrals. The following two theorems
provide connections between local properties of a function (e.g., coefﬁcients at one point) and
global properties of the function elsewhere (e.g., an integral along a distant curve).
THEOREM IV.3 [Cauchy’s residue theorem] (p. 222): In the realm of meromorphic functions,
integrals of a function can be evaluated based on local properties of the function at a few speciﬁc
points, its poles.
THEOREM IV.4 [Cauchy’s Coefﬁcient Formula] (p. 224): This is an almost immediate conse-
quence of Cauchy’s residue theorem: The coefﬁcients of an analytic function admit of a repre-
sentation by a contour integral. Coefﬁcients can then be evaluated or estimated using properties
of the function at points away from the origin.
Singularities and growth. Singularities (places where analyticity stops), provide essential
information on the growth rate of a function’s coefﬁcients. The “First Principle” relates the
exponential growth rate of coefﬁcients to the location of singularities.
THEOREM IV.5 [Boundary singularities] (p. 227): A function (given by its series expansion
at 0) always has a singularity on the boundary of its disc of convergence.
THEOREM IV.6 [Pringsheim’s Theorem] (p. 229): This theorem reﬁnes the previous one for
functions with non-negative coefﬁcients. It implies that, in the case of combinatorial generating
functions, the search for a dominant singularity can be restricted to the positive real axis.
THEOREM IV.7 [Exponential Growth Formula] (p. 231): The exponential growth rate of co-
efﬁcients is dictated by the location of the singularities nearest to the origin—the dominant
singularities.
THEOREM IV.8 [Computability of growth] (p. 237): For any combinatorial class that is nonre-
cursive (iterative), the exponential growth rate of coefﬁcients is invariably a computable number.
This statement can be regarded as the ﬁrst general theorem of analytic combinatorics.
Coefﬁcient asymptotics. The “Second Principle” relates subexponential factors of coef-
ﬁcients to the nature of singularities. For rational and meromorphic functions, everything is
simple.
THEOREM IV.9 [Expansion of rational functions] (p. 243): Coefﬁcients of rational functions
are explicitly expressible in terms of the poles, given their location (values) and nature (multi-
plicity).
THEOREM IV.10 [Expansion of meromorphic functions] (p. 245): Coefﬁcients of meromorphic
functions admit of a precise asymptotic form with exponentially small error terms, given the
location and nature of the dominant poles.
FIGURE IV.18. A summary of the main results of Chapter IV.

274
IV. COMPLEX ANALYSIS, RATIONAL AND MEROMORPHIC ASYMPTOTICS
As we hope to convince our reader, a consequence of the theory developed in
Part B is that most combinatorial classes amenable to symbolic descriptions can be
thoroughly analysed, as regards their asymptotic properties, by means of a selected
collection of basic theorems of complex analysis. The case of structures like balanced
trees and molecules, where only a functional equation of sorts is available, is exem-
plary.
This chapter has been designed to serve as a refresher of basic complex analysis, with
special emphasis on methods relevant for analytic combinatorics. See Figure 18 for a concise
summary of results. References most useful for the discussion given here include the books of
Titchmarsh [469] (oriented towards classical analysis), Whittaker and Watson [492] (stressing
special functions), Dieudonn´e [129], Hille [269], and Knopp [299]. Henrici [265] presents com-
plex analysis under the perspective of constructive and numerical methods, a highly valuable
point of view for this book.
De Bruijn’s classic booklet [111] is a wonderfully concrete introduction to effective as-
ymptotic theory, and it contains many examples from discrete mathematics thoroughly worked
out using a complex-analytic approach. The use of such analytic methods in combinatorics
was pioneered in modern times by Bender and Odlyzko, whose ﬁrst publications in this area
go back to the 1970’s. The state of affairs in 1995 regarding analytic methods in combinatorial
enumeration is superbly summarized in Odlyzko’s scholarly chapter [377]. Wilf devotes his
Chapter 5 of Generatingfunctionoloy [496] to this question. The books by Hofri [270] and Sz-
pankowski [458] contain useful accounts in the perspective of analysis of algorithms. See also
our book [434] for a light introduction and the chapter by Vitter and Flajolet [486] for more on
this speciﬁc topic.

V
Applications of Rational and
Meromorphic Asymptotics
Analytic methods are extremely powerful and when they apply,
they often yield estimates of unparalleled precision.
— ANDREW ODLYZKO [377]
Contents
V. 1.
A roadmap to rational and meromorphic asymptotics
276
V. 2.
Regular speciﬁcation and languages
278
V. 3.
Nested sequences, lattice paths, and continued fractions.
295
V. 4.
The supercritical sequence and its applications
313
V. 5.
Paths in graphs and automata
320
V. 6.
Transfer matrix models
340
V. 7.
Perspective
356
The primary goal of this chapter is to provide combinatorial illustrations of the power
of complex analytic methods, and speciﬁcally of the rational-meromorphic frame-
work exposed in the previous chapter. At the same time, we shift gears and envisage
counting problems at a new level of generality. Precisely, we organize combinatorial
problems into wide families of combinatorial types amenable to a common treatment
and associated with a common collection of asymptotic properties. Without attempt-
ing a formal deﬁnition, we call schema any such family determined by combinatorial
and analytic conditions that covers an inﬁnity of combinatorial classes.
The ﬁrst schema comprises regular speciﬁcations and languages, which a priori
lead to rational generating functions and thus systematically resort to Theorem IV.9
(p. 243), to the effect that coefﬁcients are described as exponential-polynomials. In the
case of regular speciﬁcations, much additional structure is present, especially positiv-
ity. As a consequence, ﬂuctuations can be systematically circumvented. Applications
include the analysis of longest runs, corresponding to maximal sequences of good
(or bad) luck in games of chance, pure birth processes, and the occurrence of hidden
patterns (subsequences) in random texts.
We then consider an important subset of regular speciﬁcations, the ones that are
built on nested sequences and combinatorially correspond to a variety of lattice paths.
Such nested sequences naturally lead to nested quasi-inverses, which are none other
than continued fractions, A wealth of combinatorial, algebraic, and analytic properties
then surround such constructions. A prime illustration is the very explicit analysis of
height in Dyck paths and general Catalan trees; other interesting applications relate to
coin fountain and interconnection networks.
275

276
V. APPLICATIONS OF RATIONAL AND MEROMORPHIC ASYMPTOTICS
Next, we discuss a general schema of analytic combinatorics known as the su-
percritical sequence schema, which provides a neat illustration of the power of mero-
morphic asymptotics while being of a very wide applicability. For instance, one can
predict very precisely (and easily) the number of ways in which an integer can be
decomposed additively as a sum of primes (or twin primes), this even though many
details of the distribution of primes are still surrounded in mystery.
Finally, the last two sections examine positive linear systems of generating func-
tions, starting with the simplest case of graphs and automata and concluding with the
general framework of transfer matrices. Although the resulting generating functions
are once more bound to be rational, there is beneﬁt in examining them as deﬁned im-
plicitly (rather than solving explicitly) and work out singularities directly. The spec-
trum of matrices (the set of eigenvalues) then plays a central rˆole. Our treatment is
then close to the Perron-Frobenus theory of nonnegative matrices, whose importance
has been long recognized in the theory of ﬁnite Markov chains. A general discus-
sion of singularities can then be conducted, leading to valuable consequences on a
variety of models—paths in graphs, ﬁnite automata, and transfer matrices. The last
example discussed in this chapter treats locally constrained permutations, where ra-
tional functions combined with inclusion-exclusion provide an entry to the world of
value-constrained permutations.
In the various combinatorial examples encountered in this chapter, the generating
functions are generally meromorphic in some domain extending beyond their disc of
convergence at 0. As a consequence, the asymptotic estimates of coefﬁcients involve
main terms that are explicit exponential polynomials and error terms that are exponen-
tially smaller. This is a situation which is well summarized by Odlyzko’s aphorism:
“Analytic methods [...] often yield estimates of unparalleled precision”.
V. 1. A roadmap to rational and meromorphic asymptotics
The key character in this chapter is the combinatorial sequence construction SEQ.
Since its translation into generating functions involves a quasi-inverse, (1 −f)−1, the
construction should in many cases be expected to induce polar singularities. Also,
linear systems of equations, of which the simplest case is X = 1 + AX, are solvable
by means of inverses: the solution is X = (1−A)−1 in the scalar case, and it is other-
wise expressible as a quotient of determinants, by Cramer’s rule, in the vectorial case.
Consequently, linear systems of equations are also conducive to polar singularities.
This chapter accordingly develops along two main lines. First, we study non-
recursive families of combinatorial problems that are, in a suitable sense, driven by
a sequence construction. Second, we examine families of recursive problems that
are naturally described by linear systems of equations. Clearly, the general theorems
giving the asymptotic forms of coefﬁcients of rational and meromorphic functions
apply. As we see here, the additional positivity structure arising from combinatorics
often entails notable simpliﬁcations in the asymptotic form of counting sequences.
Regular speciﬁcation and languages. This topic is treated in Section V. 2. Reg-
ular speciﬁcations are non-recursive speciﬁcations that only involve the constructions
(+, ×, SEQ). In the unlabelled case, they can always be interpreted as describing a

V.1. A ROADMAP TO RATIONAL AND MEROMORPHIC ASYMPTOTICS
277
regular language in the sense of Chapter I. The main result here is the following:
given a regular speciﬁcation R, it is possible to determine constructively a number D,
so that an asymptotic estimate of the form
(1)
Rn = P(n)βn + O(Bn),
0 ≤B < β,
P a polynomial,
holds, once the index n is restricted to a ﬁxed congruence class modulo D. (Naturally,
the quantities P, β, B may depend on the particular congruence class considered.) In
other words, a “pure” exponential polynomial form holds for each of the D sections
of the counting sequence (Rn)n≥0. In particular, irregular ﬂuctuations, which might
otherwise arise from the existence of several dominant poles sharing the same modu-
lus but having incommensurable arguments (see the discussion in Subsection IV. 6.1,
p. IV. 6.1 dedicated to multiple singularities), are simply not present in regular speci-
ﬁcations and languages. Similar estimates hold for proﬁles of regular speciﬁcations,
where proﬁle of an object is understood as the number of times any ﬁxed construction
is employed.
Nested sequences, lattice paths, and continued fractions. What is considered
here could be termed the SEQ ◦· · ·◦SEQ schema, corresponding to nested sequences.
The resulting GFs are chains of quasi-inverses, that is, continued fractions. Though
the general theory of regular speciﬁcations applies, the additional structure resulting
from nested sequences implies in essence uniqueness and simplicity of the dominant
pole, resulting directly in an estimate of the form
(2)
Sn = cβn + O(Bn),
0 ≤B < β,
c ∈R>0,
for objects enumerated by nested sequences. This schema covers lattice paths of
bounded height, their weighted versions, as well as several other bijectively equivalent
classes, like interconnection networks. In each case, proﬁles can be fully character-
ized, the estimates being of a simple form.
The supercritical sequence. This is a schema of the general form F = SEQ(G)
with a simple analytic condition, “supercriticality”, attached to the generating func-
tion G(z) of G. Under this condition, the sequence (Fn) happens to be predictable
and an asymptotic estimate,
(3)
Fn = cSn + O(T n),
0 ≤T < S,
c ∈R>0,
applies with S such that G(1/S) = 1. Integer compositions, surjections, and align-
ments presented in Chapters I and II can then be treated in a uniﬁed manner. The
supercritical sequence schema even covers many situations where G is not necessarily
constructible—this includes compositions into summands that are prime numbers or
twin primes. Parameters, like the number of components and more generally proﬁles,
are under these circumstances governed by laws that hold with a high probability.
Paths in graphs and automata. The framework of paths in directed graphs is of
considerable generality. In particular, it covers the case of ﬁnite automata introduced
in Chapter I. Although, in the abstract, the descriptive power of this framework is
formally equivalent to the one of regular speciﬁcations (APPENDIX A: Regular lan-
guages, p. 678), there is great advantage in considering directly problems whose natu-
ral formulation is recursive and phrased in terms of graphs or automata. (The reduction

278
V. APPLICATIONS OF RATIONAL AND MEROMORPHIC ASYMPTOTICS
of automata to regular expressions is nontrivial so that it does not tend to preserve the
original combinatorial structure.) The algebraic theory is that of matrices of the form
(I −zT )−1, where T is a matrix with nonnegative entries. The analytic theory be-
hind the scene is now that of positive matrices and the companion Perron-Frobenius
theory. Uniqueness and simplicity of dominant poles of generating functions can be
guaranteed under easily testable structural conditions—principally, the condition of
irreducibility that corresponds to a strong connectedness of the system. Then a pure
exponential polynomial form of the simplest type holds,
(4)
Cn ∼c · λn
1 + O(Λn),
0 ≤Λ < λ1,
c ∈R>0,
where λ1 is the (unique) dominant eigenvalue of the transition matrix T . Applications
include walks over various types of graphs (the interval graph, the devil’s staircase)
and words excluding one or several patterns (walks on the De Bruijn graph).
Transfer matrices. This framework, whose origins lie in statistical physics, is an
extension of automata and paths in graphs. What is retained is the notion of a ﬁnite
state system, but transitions can now take place at different speeds. Algebraically,
one is dealing with matrices of the form (I −T (z))−1, where T is a matrix whose
entries are polynomials (in z) with nonnegative coefﬁcients. Perron-Frobenius theory
can be adapted to cover such cases, that, to a probabilist, involve a mixture of Markov
chain and renewal theory. The consequence is once more an estimate of the type (4)
for this category of models. A striking application of transfer matrices is a study,
with an experimental mathematics ﬂavour, of self-avoiding walks and polygons in the
plane: it turns out to be possible to predict, with a high degree of conﬁdence (but
no mathematical certainty), what the number of polygons is and which distribution
of area is to be expected. A combination of the transfer matrix approach with a suit-
able use of inclusion-exclusion ﬁnally provides (Subsection V. 6.4) a solution to the
classic m´enage problem of combinatorial theory as well as to many related questions
regarding value-constrained permutations.
Sections V. 2 to V. 6 are organized following a common pattern: ﬁrst, we discuss
“combinatorial aspects”, then “analytic aspects”, and ﬁnally “applications”. Each of
Sections V. 2 to V. 5 is furthermore centred around two analytic-combinatorial theo-
rems, one describing asymptotic enumeration, the other quantifying the asymptotic
proﬁles of combinatorial structures. The last section (Section V. 6) departs slightly
from this general pattern: transfer matrices are reducible rather simply to the frame-
work of paths in graphs and automata, presented in the immediately preceding section,
so that, in order to avoid redundancy, the corresponding theorems are not explicitly
stated.
V. 2. Regular speciﬁcation and languages
The purpose of this section is the general study of the (+, ×, SEQ) schema, which
covers all regular speciﬁcations. As we show here, pure exponential-polynomialforms
with a single dominating exponential can always be extracted. Theorems V.1 and V.2
thus provide a universal framework for the asymptotic analysis of regular classes.
Additional structural conditions to be introduced in later sections (nested sequences,

V.2. REGULAR SPECIFICATION AND LANGUAGES
279
irreducibility of the dependency graph and of transfer matrices) will then be seen to
induce further simpliﬁcations in asymptotic formuæ.
V. 2.1. Combinatorial aspects. For convenience and without loss of analytic
generality, we consider here unlabelled structures. According to Chapter I, a com-
binatorial speciﬁcation is regular if it is nonrecursive (“iterative”) and it involves only
the constructions of Atom, Union, Product, and Sequence. A language L is S-regular
if it is combinatorially isomorphic to a class M described by a regular speciﬁcation.
Alternatively, a language is S-regular if all the operations involved in its descrip-
tion (unions, catenation products and star operations) are unambiguous. See Deﬁni-
tion I.10 (p. 48) and the companion Proposition I.2 (p. 48).
The dictionary translating constructions into OGFs is
(5)
F + G 7→F + G,
F × G 7→F × G,
SEQ(F) 7→(1 −F)−1,
and for languages, under the essential condition of non-ambiguity,
(6)
L ∪M 7→L + M,
L · M 7→L × M,
L⋆7→(1 −L)−1.
The rules (5) and (6) then give rise to generating functions that are invariably rational
functions. Consequently, given a regular class C, the exponential-polynomial form of
coefﬁcients expressed by Theorem IV.9 systematically applies, and one has
(7)
Cn ≡[zn]C(z) =
m
X
j=1
Πj(n)α−n
j
,
for a family of algebraic numbers αj (the poles of C(z)) and a family of polynomi-
als Πj.
As we know from the discussion of periodicities in Section IV. 6.1 (p. 250, the
collective behaviour of the sum in (7) depends on whether or not a single α dominates
all others in modulus. In the case where several dominant singularities coexist, ﬂuc-
tuations of sorts (either periodic or irregular) may manifest themselves. In contrast, if
a single α dominates, then the exponential-polynomial formula acquires a transparent
asymptotic meaning. Accordingly, we set:
Deﬁnition V.1. An exponential-polynomial form Pm
j=1 Πj(n)α−n
j
is said to be pure
if |α1| < |αj|, for all j ≥2. In that case, a single exponential dominates all the other
ones.
As we see next for regular languages and speciﬁcations, the corresponding count-
ing coefﬁcients can always be described by a ﬁnite collection of pure exponential
polynomial forms. The fundamental reason is that we are dealing with a special sub-
set of rational functions, one that enjoys strong positivity properties.
 V.1. Positive rational functions. Deﬁne the class Rat+ of positive rational functions as
the smallest class containing polynomials with positive coefﬁcients (R≥0[z]) and closed under
sum, product, and quasi-inverse, where Q(f) = (1 −f)−1 is applied to elements f such that
f(0) = 0. The OGF of any regular class with positive weights attached to neutral structures
and atoms is in Rat+. Conversely, any function in Rat+ is the OGF of a positively weighted
regular class. The notion of a Rat+ function is for instance useful in the analysis of weighted
word models and Bernoulli trials, as discussed in Section III. 6.1, p. 178.


280
V. APPLICATIONS OF RATIONAL AND MEROMORPHIC ASYMPTOTICS
V. 2.2. Analytic aspects. First we need the notion of sections of a sequence.
Deﬁnition V.2. Let (fn) be a sequence of numbers. Its section of parameters D, r,
where D ∈Z>0 and r ∈Z≥0 is the subsequence (fnD+r). The numbers D and r are
referred to as the modulus and the base respectively.
The main theorem describing the asymptotic behaviour of regular classes is a
consequence of Proposition IV.3 (p. 253) and is originally due to Berstel. (See Soit-
tola’s article [442] as well as the books by Eilenberg [149, Ch VII] and Berstel–
Reutenauer [44] for context and proofs of some of the assertions below.)
Theorem V.1 (Asymptotics of regular classes). Let S be a class described by a regular
speciﬁcation. Then there exists an integer D such that each section of modulus D of
Sn that is not eventually 0 admits a pure exponential polynomial form: for n larger
than some n0, and any such section of base r, one has
Sn = Π(n)βn +
m
X
j=1
Pj(n)βn
j
n ≡r mod D,
where β > |βj|, and Π, Pj are polynomials that depend on the base r, with Π(x) ̸≡0.
PROOF. Let α1 be the dominant pole of S(z) that is positive. Proposition IV.3 as-
serts that any dominant pole, α is such that α/|α| is a root of unity. Let D0 be
such that the dominant singularities are all contained in the set {α1ωj−1}D0
j=1, where
ω = exp(2iπ/D0). By collecting all contributions arising from dominant poles in
the general expansion (7) and by restricting n to a ﬁxed congruence class modulo D0,
namely n = r + D0ν with 0 ≤r < D0, one gets
(8)
Sr+D0ν = Π[r](n)α−D0ν
1
+ O(A−n).
There Π[r] is a polynomial depending on r and the remainder term represents an ex-
ponential polynomial with growth at most O(A−n) for some A > α1.
The sections with modulus D0 that are not eventually 0 can be categorized into
two classes.
— Let R̸=0 be the set of those values of r such that Π[r] is not identically 0.
The set R̸=0 is nonempty (else the radius of convergence of S(z) would be
larger than α1.) For any base r ∈R̸=0, the assertion of the theorem is then
established with β = 1/α1.
— Let R0 be the set of those values of r such that Π[r](x) ≡0, with Π[r] as
given by (8). Then one needs to examine the next layer of poles of S(z), as
detailed below.
Consider a number r such that r ∈R0, so that the polynomial Π[r] is identically 0.
First, we isolate in the expansion of S(z) those indices that are congruent to r modulo
D0. This is achieved by means of a Hadamard product:
g(z) = S(z) ⊙

zr
1 −zD0

.
A classical theorem [47, 149] from the theory of positive rational functions in the
sense of Note 1 asserts that such functions are closed under Hadamard product. (A

V.2. REGULAR SPECIFICATION AND LANGUAGES
281
dedicated construction is also possible.) Then the resulting function G(z) is of the
form
g(z) = zrγ(zD0),
with the rational function γ(z) being analytic at 0. Note that we have [zν]γ(z) =
SνD0+r, so that γ is exactly the generating function of the section of base r of S(z).
One veriﬁes next that γ(z), which is obtained by the substitution z 7→z1/D0 in
g(z)z−r, is itself a positive rational function. Then, by a fresh application of Berstel’s
Theorem (Proposition IV.3, p. 253), this function, if not a polynomial, has a radius of
convergence ρ with all its dominant poles σ being such that σ/ρ is a D1 root of unity
for some D1 ≥1. The argument originally applied to S(z) can thus be repeated, with
γ(z) replacing S(z). In particular, one ﬁnds at least one section (of modulus D1) of
the coefﬁcients of γ(z) that admits a pure exponential-polynomial form. The other
sections of modulus D1 can themselves be further reﬁned, and so on
In other words, successive reﬁnements of the sectioning process provide at each
stage at least one pure exponential-polynomial form, possibly leaving a few congru-
ence classes open for further reﬁnements. Deﬁne the layer index of a rational function
f as the integer κ(f), such that
κ(f) = card

|ζ|
 f(ζ) = ∞
	
.
(This index is thus the number of different moduli of poles of f.) It is seen that each
successive reﬁnement step decreases by at least 1 the layer index of the rational func-
tion involved, thereby ensuring termination of the whole reﬁnement process. Finally,
the collection of the iterated sectionings obtained can be reduced to a single section-
ing according to a common modulus D, which is the least common multiple of the
collection of all the ﬁnite products D0D1 · · · that are generated by the algorithm.
□
For instance the coefﬁcients (Figure 1) of the function
(9)
F(z) =
1
(1 −z)(1 −z2 −z4) +
z
1 −3z3 ,
associated to the regular language a⋆(bb + cccc)⋆+ d(ddd + eee + fff)⋆, exhibit an
apparently irregular behaviour, with the expansion of F(z) starting as
1 + 2z + 2z2 + 2z3 + 7z4 + 4z5 + 7z6 + 16z7 + 12z8 + 12z9 + 47z10 + 20z11 + · · · .
However the sections modulo 6 each admit a pure exponential-polynomial form and
consequently become easy to describe.
 V.2. Extension to Rat+ functions. The conclusions of Theorem V.1 hold for any function
in Rat+ in the sense of Note 1.

 V.3. Soittola’s Theorem. This is a converse to Theorem V.1 proved in [442]. Assume that
coefﬁcients of an arbitrary rational function f(z) are nonnegative and that there exists a sec-
tioning such that each section admits a pure exponential-polynomial form. Then f(z) is in
Rat+ in the sense of Note 1; in particular, f is the OGF of a (weighted) regular class.

Theorem V.1 is useful for interpreting the enumeration of regular classes and
languages. It serves a similar purpose with regards to structural parameters of regular
classes. Consider a regular speciﬁcation C augmented with a mark u that is, as usual,
a neutral object of size 0 (see Chapter III). We let C(z, u) be the corresponding BGF

282
V. APPLICATIONS OF RATIONAL AND MEROMORPHIC ASYMPTOTICS
2
5
0
0
10
4
25
20
15
8
6
140
120
100
60
40
20
20
0
40
0
80
50
10
30
FIGURE V.1. Plots of log Fn with Fn = [zn]F(z) and F(z) as in (9) display ﬂuctua-
tions that disappear as soon as sections of modulus 6 are considered.
of C, so that Cn,k = [znuk]C(z, u) is the number of C-objects of size n that bear k
marks. A suitable placement of marks makes it possible to record the number of times
any given construction enters an object. For instance, in the augmented speciﬁcation
of binary words,
C = (SEQ<r(b) + u SEQ≥r(b)) SEQ(a(SEQ<r(b) + u SEQ≥r(b))),
all maximal runs of b having length at least r are marked by a u. There results the
following BGF for the corresponding parameter “number of b-runs of length ≥r”,
C(z, u) =
1 −zr
1 −z + uzr
1 −z

·
1
1 −z

1−zr
1−z + uzr
1−z
,
from which mean and variance can be determined. In a sense, marks make it possible
to analyse proﬁle, with respect to constructions entering the speciﬁcation, of a random
object.
Theorem V.2 (Proﬁle of regular classes). Consider a regular speciﬁcation C aug-
mented with a mark and let χ be the parameter corresponding to the number of occur-
rences of that mark. There exists a sectioning index d such that for any ﬁxed section
of (Cn) of modulus d, the following hold: Any moment of integral order s ≥1 of χ
satisﬁes an asymptotic formula
(10)
ECn[χs] = Q(n)βn + O(Gn),
where1 0 < β ≤1, Q(n) is a rational fraction, and G < β.
In this statement, it is tacitly assumed that only sections that are not eventually 0 are
considered.
1The quantities β, Q, G depend on the particular section considered.

V.2. REGULAR SPECIFICATION AND LANGUAGES
283
PROOF. The case of expectations sufﬁces to indicate the lines of a general proof. One
possible approach2is to build a derived speciﬁcation D such that
ECn[χ] = Dn
Cn
,
which is also a regular speciﬁcation. To this purpose, deﬁne a transformation on
speciﬁcations deﬁned inductively by the rules
∂(A + B) = ∂A + ∂B, ∂(A × B) = ∂A × B + A × ∂B, ∂SEQ(A) = SEQ(A) × ∂A × SEQ(A),
together with the initial conditions ∂u = 1 and ∂Z = ∅. This is a form of combina-
torial differentiation: an object γ ∈C corresponds to χ(γ) objects in D, namely, one
for each choice of an occurrence of the mark.
As a consequence, Dn is the cumulated value of χ over Cn, so that Dn/Cn =
ECn[χ]. On the other hand, D is a regular speciﬁcation to which Theorem V.1 ap-
plies. The result follows upon considering (if necessary) a sectioning that reﬁnes the
sectionings of both C and D. The argument extends easily to higher moments.
□
 V.4. An example. Consider the regular language C = a⋆(b + c)⋆d(b + c)⋆. Let χ be the
length of the initial run of a’s. Then one ﬁnds
C(z) =
z
(1 −z)(1 −2z)2 ,
D(z) =
z2
(1 −z)2(1 −2z)2 .
Thus the mean of χ satisﬁes
ECn[χ] = Dn
Cn = (n −3)2n + (n + 3)
(n −1)2n + 1
= n −3
n −1 + O
„„3
4
«n«
.
Generally, in the statement of Theorem V.2, let Q(n) = A(n)/B(n) with A, B polynomials
and a = deg(A), b = deg(B). The following combinations prove to be possible (for ﬁrst
moments): β = 1 and (a, b) any pair such that 0 ≤a ≤b + 1; β < 1 and (a, b) any pair of
elements ≥0.

 V.5. Shufﬂe products. Let L, M be two languages over two disjoint alphabets. Then, the
shufﬂe product S of L and M is such that bS(z) = bL(z) · c
M(z), where bS, bL, c
M are the
exponential generating functions of S, L, M. Accordingly, if the OGF L(z) and M(z) are
rational then the OGF S(z) is also rational. [This technique may be used to analyse generalized
birthday paradox and coupon collector problems; see [181].]

V. 2.3. Applications. This subsection details several examples that illustrate the
explicit determination of exponential-polynomial forms in regular speciﬁcations. Var-
ious types of estimates conforming to Theorems V.1 and V.2 are obtained.
— We start by recapitulating a collection of combinatorial problems (a “pot-
pourri”, Example 1) already encountered in Chapters I–III, where rational
function asymptotics has been used en passant .
— Next, we show how to develop a complete analysis of runs of consecutive
equal letters in random sequences (Example 2): this is in theory a special
case of the analysis of patterns in random texts (Section IV. 6.3, p. 257), but
the particular nature of the patterns makes it possible to derive much more
explicit results, including limit distributions for longest runs.
2Equivalently, one may operate at generating function level and observe that the derivative of a Rat+
function is Rat+; cf Notes 1 and 2.

284
V. APPLICATIONS OF RATIONAL AND MEROMORPHIC ASYMPTOTICS
Class
Asymptotics
Integer compositions
2n−1
— k summands
∼
nk−1
(k−1)!
(§I. 3.1, p. 42)
— summands ≤r
∼cβn
r
(§I. 3.1, p. 40)
Integer partitions
— k summands
∼
nk−1
k! (k−1)!
(§I. 3.1, p. 42)
— summands ≤r
∼
nr−1
r! (r−1)!
(§I. 3.1, p. 41)
Set partitions, k classes
∼kn
k!
(§I. 4.3, p. 58)
Words excluding a pattern p
∼cβn
p
(§IV. 6.3, p. 257)
FIGURE V.2. A potpourri of regular classes and their asymptotics.
— We then examine walks of the pure birth type (Example 3) that turn out to
have applications to the analysis of a probabilistic algorithm (Approximate
Counting, Example 4).
— Finally, we present a mean and variance analysis of the occurrence of hidden
patterns in random texts (subsequences, Example 5), which is sufﬁcient to
entail the concentration of distribution property.
EXAMPLE V.1.
A potpourri of regular speciﬁcations. We gather here a few combinatorial
problems to be found scattered across Chapters I–IV that are reducible to regular speciﬁcations;
see also Figure 2 for a summary.
Compositions of integers (Section I. 3, p. 37) are speciﬁed by C = SEQ(SEQ≥1(Z)),
whence the OGF (1 −z)/(1 −2z) and the closed form Cn = 2n−1, an especially trivial
exponential-polynomial form. Polar singularities are also present for compositions into k sum-
mands that are described by SEQk(SEQ≥1(Z)) and for compositions whose summands are
restricted to the interval [1 . . r] (i.e., SEQ(SEQ1 . . r(Z)), with corresponding generating func-
tions
zk
(1 −z)k ,
1 −z
1 −2z + zr+1 .
In the ﬁrst case, there is an explicit form for the coefﬁcients,
`n−1
k−1
´
, which constitutes a partic-
ular exponential-polynomial form (with the basis of the exponential being 1). The second case
requires a dedicated analysis of the dominant polar singularity. (Example 2 below treats the
closely related problem of determining longest runs in random binary words.)
Integer partitions involve the multiset construction. However, when summands are re-
stricted to the interval [1 . . r], the speciﬁcation and the OGF are given by
MSET(SEQ1 . . r(Z)) ≃SEQ(Z) × SEQ(Z2) × · · · SEQ(Zr)
=⇒
r
Y
j=1
1
1 −zj .
This case ﬁrst introduced in Section I. 3 (p. 37) has also served as a leading example in our
discussion of denumerants in Example IV.5 (p. 244), where the analysis of the pole at 1 fur-
nishes the dominant asymptotic behaviour, nr−1/(r!(r −1)!), for such special partitions. The
enumeration of partitions by number of parts then follows, by duality, from the staircase repre-
sentation.
Set partitions are typically labelled objects. However, when suitably constrained, they can
be encoded by regular expressions; see Section I. 4.3 (p. 58) for partitions into k classes, where

V.2. REGULAR SPECIFICATION AND LANGUAGES
285
the OGF found is
S(k)(z) =
zk
(1 −z)(1 −2z) · · · (1 −kz)
implying
S(k)
n
∼kn
k! ,
and the asymptotic estimate results from the partial fraction decompsoition and the dominant
pole at 1/k.
Words lead to many problems that are prototypical of the regular speciﬁcation framework.
In Section I. 4 (p. 47), we saw that one could give a regular expression describing the set of
words containing the pattern abb, from which the exact and asymptotic forms of counting coef-
ﬁcients derive. For a general pattern p, the generating functions of words constrained to include
(or dually exclude) p are rational. The corresponding asymptotic analysis has been given in
Section IV. 6.3 (p. 257).
Words can also be analysed under the Bernoulli model, where letter i is selected with
probability pi; cf Section III. 6.1 for a general discussion including the analysis of records in
random words (p. 179). . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE V.1. □
 V.6. Partially commutative monoids.
Let W = A⋆be the set of all words over a ﬁnite
alphabet A. Consider a collection C of commutation rules between pairs of elements of A. For
instance, if A = {a, b, c}, then C = {ab = ba, ac = ca} means that a commutes with both b
and c, but bc is not a commuting pair: bc ̸= cb. Let M = W/[C] be the set of equivalent
classes of words (monomials) under the rules induced by C. The set M is said to be a partially
commutative monoid or a trace monoid [80].
If A = {a, b}, then the two possibilities for C are C = ∅and C := {ab = ba}. Normal
forms for M are given by the regular expressions (a+b)⋆and a⋆b⋆corresponding to the OGFs
1
1 −a −b,
1
1 −a −b + ab.
If A = {a, b, c}, the possibilities for C, the corresponding normal forms, and the OGFs M are
as follows. If C = ∅, then M ≃(a + b + c)⋆with OGF (1 −a −b −c)−1; the other cases are
ab = ba
ab = ba, ac = ca
ab = ba, ac = ca, bc = cb
(a⋆b⋆c)⋆a⋆b⋆
a⋆(b + c)⋆
a⋆b⋆c⋆
1
1 −a −b −c + ab
1
1 −a −b −c + ab + ac
1
1 −a −b −c + ab + ac + bc −abc .
Cartier and Foata [80] have discovered the general form (based on extended M¨obius inversion),
M =
 X
F
(−1)|F |F
!−1
,
where the sum is over all monomials F composed of distinct letters that all commute pairwise.
Goldwurm and Santini [239] have shown that [zn]M(z) ∼K · αn for K, α > 0.

EXAMPLE V.2.
Longest runs in words Longest runs in words introduced in Section I. 4.1
(p. 47) provide an illustration of the technique of localizing dominant singularities in rational
functions and of the corresponding coefﬁcient extraction process. The probabilistic problem is a
famous one, discussed by Feller in [161], as it represents a basic question in the analysis of runs
of good (or bad) luck in a succession of independent events. Our presentation closely follows
an insightful note of Knuth [303] whose motivation was the analysis of carry propagation in
certain binary adders.
Start from the class W of all binary words over the alphabet {a, b}. Our interest lies in
the length L of the longest consecutive block of a’s in a word. For the property L < k, the

286
V. APPLICATIONS OF RATIONAL AND MEROMORPHIC ASYMPTOTICS
speciﬁcation and the corresponding OGF are
W⟨k⟩= SEQ<k(a) SEQ(b SEQ<k(a))
=⇒
W ⟨k⟩(z) = 1 −zk
1 −z ·
1
1 −z 1−zk
1−z
,
that is,
(11)
W ⟨k⟩(z) =
1 −zk
1 −2z + zk+1 .
This represents a collection of OGFs indexed by k, which contain all the information relative to
the distribution of longest runs in random words. We propose to prove:
Proposition V.1. The longest run parameter L taken over the set of binary words of length n
(endowed with the uniform distribution) satisﬁes the uniform estimate3
(12)
Pn (L < ⌊lg n⌋+ h) = e−α(n)2−h−1 + O
„log n
√n
«
,
α(n) := 2{lg n}.
In particular, the mean satisﬁes
En(L) = lg n +
γ
log 2 −3
2 + P(lg n) + O
„log2 n
√n
«
,
where P is a continuous periodic function whose Fourier expansion is given by (20). The
variance satisﬁes Vn(L) = O(1) and the distribution is concentrated around its mean.
The probability distributions appearing in (12) are known as double exponential distributions
(Figure 3). The formula (12) does not represent a single limit distribution in the usual sense of
Chapter IX, but rather a whole family of distributions indexed by the fractional part of lg n, thus
dictated by the way n places itself with respect to powers of 2.
PROOF. The proof consists of the following steps: locate the dominant pole; estimate the
corresponding contribution; separate the dominant pole from the other poles in order to derive
constructive error terms; ﬁnally approximate the main quantities of interest.
(i) Location of the dominant pole. The OGF W ⟨k⟩has, by the ﬁrst form of (11) a dominant
pole ρk which is a root of the equation 1 = s(ρk), where s(z) = z(1 −zk)/(1 −z). We
consider k ≥2. Since s(z) is an increasing polynomial and s(0) = 0, s( 1
2) < 1, s(1) = k, the
root ρk must lie in the open interval ( 1
2, 1). In fact, as one easily veriﬁes, the condition k ≥2
guarantees that s(0.6) > 1, hence the reﬁned estimate
(13)
1
2 < ρk < 3
5
(k ≥2).
It now becomes possible to derive very precise estimates by bootstrapping. (This technique is a
form of iteration for approaching a ﬁxed point—its use in the context of asymptotic expansions
is detailed in De Bruijn’s book [111].) Writing the deﬁning equation for ρk as a ﬁxed point
equation,
z = 1
2(1 + zk+1),
and making use of the rough estimates (13) yields next
(14)
1
2
„
1 + (1
2)k+1
«
< ρk < 1
2
„
1 + (3
5)k+1
«
.
Thus, ρk is exponentially close to 1
2, and further iteration from (14) shows
(15)
ρk = 1
2 +
1
2k+2 + O
„ k
22k
«
,
3The symbol lg x denotes the binary logarithm, lg x = log2 x.

V.2. REGULAR SPECIFICATION AND LANGUAGES
287
which constitutes a very precise estimate.
(ii) Contribution from the dominant pole. A straightforward calculation provides the value
of the residue,
(16)
Rn,k := −Res
h
W ⟨k⟩(z)z−n−1; z = ρk
i
=
1 −ρk
k
2 −(k + 1)ρk
k
ρ−n−1
k
,
which is expected to provide the main approximation to the coefﬁcients of W ⟨k⟩as n →∞.
The quantity in (16) is of the rough form 2ne−n/2k+1: we shall return to such approximations
shortly.
(iii) Separation of the subdominant poles. Consider the circle |z| = 3
4 and take the second
form of the denominator of W ⟨k⟩, namely,
1 −2z + zk+1.
In view of Rouch´e’s theorem, we may regard this polynomial as the sum f(z) + g(z), where
f(z) = 1−2z and g(z) = zk+1. The term f(z) has on the circle |z| = 3
4 a modulus that varies
between 1
2 and 5
2; the term g(z) is at most 27
64 for any k ≥2. Thus, on the circle |z| = 3
4, one
has |g(z)| < |f(z)|, so that f(z) and f(z) + g(z) have the same number of zeros inside the
circle. Since f(z) admits z = 1
2 as only zero there, the denominator must also have a unique
root in |z| ≤3
4, and that root must coincide with ρk.
Similar arguments also give bounds on the error term when the number of words w satis-
fying L(w) < k is estimated by the residue (16) at the dominant pole. On the circle |z| = 3
4,
the denominator of W ⟨k⟩stays bounded away from 0 (its modulus is at least
5
64 when k ≥2,
by previous considerations). Thus, the modulus of the remainder integral is O((4/3)n), and in
fact bounded from above by 35(4/3)n. In summary, letting qn,k represent the probability that
the longest run in a random word of length n is less than k, one obtains the main estimate
(17)
qn,k := Pn(L < k) =
1 −ρk
k
1 −(k + 1)ρk
k/2
„ 1
2ρk
«n+1
+ O
„
(2
3)n
«
,
which holds uniformly with respect to k. Here is table of the numerical values of the quantities
appearing in the approximation of qn,k when written under the form ck · (2ρk)−n:
k
ck · (2ρk)−n
2
1.17082 · 0.80901n
3
1.13745 · 0.91964n
4
1.09166 · 0.96378n
5
1.05753 · 0.98297n
10
1.00394 · 0.99950n
(iv) Final approximations. There only remains to transform the main estimate (17) into
the limit form asserted in the statement. First, the “tail inequalities” (lg x ≡log2 x)
(18)
Pn
„
L < 3
4 lg n
«
= O
“
e−1
2
4√n”
,
Pn (L ≥2 lg n + y) = O
„e−2y
n
«
,
describe the tail of the probability distribution of Ln. They derive from simple bounding tech-
niques applied to the main approximation (17) using (15). Thus, for asymptotic purposes, only
a small region around lg n needs to be considered.
Regarding the central regime, for k = lg n + x and x in [−1
4 lg n, lg n], the approxima-
tion (15) of ρk and related quantities applies, and one ﬁnds
(2ρk)−n = exp
“
−
n
2k+1 + O(kn2−2k)
”
= e−n/2k+1 „
1 + O(log n
√n )
«
.

288
V. APPLICATIONS OF RATIONAL AND MEROMORPHIC ASYMPTOTICS
–4
–3
–2
–1
1
2
3
4
x
0
0.05
0.1
0.15
0.2
0.25
2
4
6
8
10
12
14
0
0.05
0.1
0.15
0.2
2
4
6
8
10
12
14
FIGURE V.3. The double exponential laws: Left, histograms for n at 2p (black), 2p+1/3
(dark gray), and 2p+2/3 (light gray), where x = k −lg n. Right, empirical histograms for
1000 simulations with n = 100 (top) and n = 140 (bottom).
(This results from standard expansions like (1−a)n = e−na exp(O(na2)).) At the same time,
the coefﬁcient of this quantity in (17) is
1 + O(kρk
k) = 1 + O
„log n
√n
«
.
Thus a double exponential approximation holds (Figure 3): for k = lg n + x with x in
[−1
4 lg n, lg n], one has (uniformly)
(19)
qn,k = e−n/2k+1 „
1 + O
„log n
√n
««
.
In particular, upon setting k = ⌊lg n⌋+ h and making use of the tail inequalities (18), the ﬁrst
part of the statement, namely Equation (12), follows. (The ﬂoor function takes into account the
fact that k must be an integer.)
The mean and variance estimates derive from the fact that the distribution quickly decays
at values away from lg n (by (18)) while it satisﬁes Equation (19) in the central region. The
mean satisﬁes
En(L) :=
X
h≥1
[1 −Pn(L < h)] = Φ(n
2 )−1+O
„log2 n
n
«
,
Φ(x) :=
X
h≥0
h
1 −e−x/2hi
.
Consider the three cases h < h0, h ∈[h0, h1], and h > h1 with h0 = lg x −log log x and
h1 = lg x + log log x, where the general term is (respectively) close to 1, between 0 and 1, and
close to 0. By summing, one ﬁnds elementarily Φ(x) = lg x + O(log log x) as x →∞. (An
elementary way of catching the next O(1) term is discussed for instance in [434, p. 403].)
The method of choice for precise asymptotics is to treat Φ(x) as a harmonic sum and apply
Mellin transform techniques (APPENDIX B: Mellin Transform, p. 707). The Mellin transform
of Φ(x) is
Φ⋆(s) :=
Z ∞
0
Φ(x)xs−1 dx =
Γ(s)
1 −2s
ℜ(s) ∈(−1, 0).

V.2. REGULAR SPECIFICATION AND LANGUAGES
289
The double pole of Φ⋆at 0 and the simple poles at s =
2ikπ
log 2 are reﬂected by the asymptotic
expansion:
(20)
Φ(x) = lg x+
γ
log 2+1
2+P(lg x)+O(x−1),
P(w) := −
1
log 2
X
k∈Z\{0}
Γ
„2ikπ
log 2
«
e−2ikπw.
The oscillating function P(w) has amplitude of the order of 10−6. (See [184, 252, 303, 458]
for more on this topic.) The variance is similarly analysed. This concludes the proof of Propo-
sition V.1.
□
The double exponential approximation in (12) is typical of extremal statistics. What is
striking here is the existence of a family of distributions indexed by the fractional part of lg n.
This fact is then reﬂected by the presence of oscillating functions in moments of the random
variable L. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE V.2. □
 V.7. Longest runs in Bernoulli sequences. Consider an alphabet A = {aj} with letter aj
independently chosen with probability {pj}. The OGF of words where each run of equal letters
has length at most k derives from the construction of Smirnov words (pp. 193 and 249), and it
is found to be
W [k](z) =
 
1 −
X
i
piz 1 −(piz)k
1 −(piz)k+1
!−1
.
Let pmax be the largest of the pj. Then the expected length of the longest run of any letter is
log n/ log pmax + O(1), and precise quantitative information can be derived from the OGFs by
methods akin to Example IV.9 (Smirnov words and Carlitz compositions, p. 249).

Walks of the pure birth type. The next two examples develop the analysis of
walks in a special type of graphs. These examples serve two purposes: they illustrate
further cases of modelling by means of regular speciﬁcations, and, at the same time,
provide a bridge to the analysis of lattice paths in the next section.
EXAMPLE V.3.
Walks of the pure-birth type.
Consider a walk on the nonnegative integers
that starts at 0 and is only allowed either to stay at the same place or move by an increment
of +1. Our goal is to enumerate the walks that start from 0 and reach point m −1 in n steps. A
step from j to j + 1 will be encoded by a letter aj; a step from j to j will be encoded by cj, in
accordance with the following state diagram:
(21)
a
a
a
0
1
2
c0
c1
c2
The language encoding all legal walks from state 0 to state m can be described by a regular
expression,
H0,m = SEQ(c0)a0 SEQ(c1)a1 · · · SEQ(cm−1)am−1 SEQ(cm).
Symbolicly using letters as variables, the corresponding ordinary multivariate generating func-
tion is then
H0,m(⃗a,⃗c) =
a0a1 · · · am−1
(1 −c0)(1 −c1) · · · (1 −cm).
Assume now that the steps are assigned weights, with αj corresponding to aj and γj to cj.
Weights of letters are extended multiplicatively to words in the usual way (cf Section III. 6.1,
p. 178). In addition, upon taking γj = 1−αj, one obtains a probabilistic weighting: the walker

290
V. APPLICATIONS OF RATIONAL AND MEROMORPHIC ASYMPTOTICS
0
2
4
6
8
10
200
400
600
800
1000
FIGURE V.4. A simulation of 10 tra-
jectories of the pure-birth process till
n = 1024, with geometric probabili-
ties corresponding to q = 1/2, com-
pared to the curve log2 x.
starts from position 0, and, if at j, at each clock tick, she either stays at the same place with
probability 1 −αj or moves to the right with probability αj. The OGF of such weighted walks
then becomes
(22)
H0,m(z) =
α0α1 · · · αm−1zm
(1 −(1 −α0)z)(1 −(1 −α1)z) · · · (1 −(1 −αm)z),
and [zn]H0,m is the probability for the walker to be found at position m at (discrete) time n.
This walk process can be alternatively interpreted as a (discrete-time) pure-birth process4 in
the usual sense of probability theory: There is a population of individuals and, at each discrete
epoch, a new birth may take place, the probability of a birth being αj when the population is of
size j.
The form (22) readily lends itself to a partial fraction decomposition. Assume for simplic-
ity that the αj are all distinct. The poles of H0,m are at the points (1 −αj)−1 and one ﬁnds as
z →(1 −αj)−1:
H0,m(z) ∼
rj,m
1 −z(1 −αj)
where
rj,m :=
α0α1 · · · αm−1
Q
k∈[0,m], k̸=j (αk −αj).
Thus, the probability of being in state m at time n is given by a sum:
(23)
[zn]H0,m(z) =
m
X
j=0
rj,m(1 −αj)n.
An especially interesting case of the pure-birth walk is when the quantities αk are geomet-
ric: αk = qk for some q with 0 < q < 1. In that case, the probability of being in state m
after n transitions becomes (cf (23))
(24)
m
X
j=0
(−1)jq(j
2)
(q)j(q)m−j (1 −qm−j)n,
(q)j := (1 −q)(1 −q2) · · · (1 −qj).
This corresponds to a stochastic progression in a medium with exponentially increasing hard-
ness or, equivalently, to the growth of a population whose size adversely affects fertility in an
exponential manner. On intuitive grounds, we expect an evolution of the process to stay reason-
ably close to the curve y = log1/q x; see Figure 4 for a simulation conﬁrming this fact, which
can be justiﬁed by means of formula (24). This particular analysis is borrowed from [172],
where it was initially developed in connection with the “approximate counting” algorithm to be
studied next. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE V.3. □
4The theory of pure-birth processes is discussed under a calculational and non measure-theoretic an-
gle in the book by Bharucha-Reid [50]. See also the Course by Karlin and Taylor [290] for a concrete
presentation.

V.2. REGULAR SPECIFICATION AND LANGUAGES
291
EXAMPLE V.4.
Approximate Counting.
Assume you need to keep a counter that is able to
record the number of certain events (say impulses) and should have the capability of keeping
counts till a certain maximal value N. A standard information-theoretic argument (with ℓbits,
one can only keep track of 2ℓpossibilities) implies that one needs ⌈log2 N + 1⌉bits to perform
the task—a standard binary counter will indeed do the job. However, in 1977, Robert Morris has
proposed a way to maintain counters that only requires of the order of log log N bits. What’s
the catch?
Morris’ elegant idea consists in relaxing the constraint of exactness in the counting process
and, by playing with probabilities, tolerate a small error on the counts obtained. Precisely, his
solution maintains a random quantity Q which is initialized by Q = 0. Upon receiving an
impulse, one updates Q according to the following simple procedure (with q ∈(0, 1) a design
parameter):
procedure Update(Q);
with probability qQ+1 do Q := Q + 1 (else keep Q unchanged).
When asked the number of impulses (number of times the update procedure was called) at any
moment, simply use the following procedure to return an estimate:
procedure Answer(Q);
output X = q−Q −1
1 −q
.
Let Qn be the value of the random quantity Q after n executions of the update procedure
and Xn the corresponding estimate output by the algorithm. It is easy to verify (by recurrence
or by generating functions; see Note 8 below for higher moments) that
(25)
E(q−Qn) = n(1 −q) + 1,
so that
E(Xn) = n.
Thus the answer provided at any instant is an unbiased estimator (in a mean value sense) of
the actual count n. On the other hand, the analysis of the geometric pure-birth process in the
previous example applies. In particular, the exponential approximation (1 −α)n ≈e−nα
in conjunction with the basic formula (24) shows that for large n and m sufﬁciently near to
log1/q n, one has (asymptotically) the geometric-birth distribution
(26)
P (Qn = m) =
∞
X
j=0
(−1)jq(j+1
2 )
(q)j(q)∞
exp(−qx−j) + o(1),
x ≡m −log1/q n.
(We refer to [172] for details.) Such calculations imply that Qn is with high probability (w.h.p.)
close to log1/q n. Thus, if n ≤N, the value of Qn will be w.h.p. bounded from above by
(1 + ǫ) log1/q N, with ǫ a small constant. But this means that the integer Q, which can itself
be represented in binary, will only require
(27)
log2 log n + O(1)
bits for storage, for ﬁxed q.
A closer examination of the formulæ reveals that the accuracy of the estimate improves
considerably when q becomes close to 1. The standard error is deﬁned as 1
n
p
V(Xn) and it
measures (in a mean quadratic sense) the relative error likely to be made. The variance of Qn
is, like the mean, determined by recurrence or generating functions, and one ﬁnds
(28)
V(q−Qn) =
 
n + 1
2
!
(1 −q)3
q
,
1
n
p
V(Xn) ∼
r
1 −q
2q
(see also Note 8 below). This means that accuracy increases as q approaches 1 and, by suitably
dimensioning q, one can make it asymptotically as small as desired. In summary, (25), (28),

292
V. APPLICATIONS OF RATIONAL AND MEROMORPHIC ASYMPTOTICS
and (27) express the following property: Approximate counting makes it possible to count till N
using only about log log N bits of storage, while achieving a standard error that is asymptot-
ically a constant and can be set to any prescribed small value. Morris’ trick is now fully
understood.
For instance, with q = 2−1/16, it proves possible to count up to 216 = 65536 using only
8 bits (instead of 16), with an error likely not to exceed 20%. Naturally, there’s not too much
reason to appeal to the algorithm when a single counter needs to be managed. (Everybody can
afford a few bits!) Approximate Counting turns out to be useful when a very large number of
counts need to be kept simultaneously. It constitutes one of the early examples of a probabilistic
algorithm in the extraction of information from large volumes of data, an area also known as
data mining; see [177] for a review of connections with analytic combinatorics and references.
Functions akin to those of (26) also surface in other areas of probability theory. Guillemin,
Robert, and Zwart [255] have detected them in processes that combine an additive increase and
a multiplicative decrease (AIMD processes), in a context motivated by the adaptive transmis-
sion of “windows” of varying sizes in large communication networks (the TCP protocol of the
internet). Biane, Bertoin, and Yor [48] encountered a function identical to (26) in their study of
exponential functionals of Poisson processes. . . . . . . . . . . . . . . . . . . . END OF EXAMPLE V.4. □
 V.8. Moments of q−Qn. It is a perhaps surprising fact that any integral moment of q−Qn is a
polynomial in n and q, like in (25), (28). To see it, deﬁne
Φ(w) ≡Φ(w, ξ, q) :=
X
m≥0
qm(m+1)/2
ξmwm
(1 + ξq)(1 + ξq2) · · · (1 + ξqm+1).
By (22), one has
X
m≥0
H0,m(z)wm =
1
1 −z Φ
„
w;
z
1 −z , q
«
.
On the other hand, Φ satisﬁes Φ(w) = 1 −qξ(1 −w)Φ(qw), hence the q–identity,
Φ(w) =
X
j≥0
(−qξ)j h
(1 −w)(1 −qw) · · · (1 −qj−1w)
i
,
which resorts to q-calculus5. Thus Φ(q−r; ξ, q) is a polynomial for any r ∈Z≥0, as the ex-
pansion terminates. See Prodinger’s study [403] for connections with basic hypergeometric
functions and Heine’s transformation.

Hidden patterns: Regular expression modelling and moments. We return here
to the analysis of the number of occurrences of a pattern p as a subsequence in a
random text. The mean number of occurrences can be obtained by enumerating con-
texts of occurrences: in a sense we are then enumerating the language of all words by
means of a dedicated regular expression where the ambiguity coefﬁcient (the multi-
plicity) of a word is precisely equal to the number of occurrences of the pattern. This
technique, which gives an easy access to expectations, also works for higher moments.
It supplements the fact that there is no easy way to get a BGF in such cases.
EXAMPLE V.5. Occurrences of “hidden” patterns in texts. Fix an alphabet A = {a1, . . . , ar}
of cardinality r and assume a probability distribution on A to be given, with pj the probability
of letter aj. We consider the Bernoulli model on W = SEQ(A), where the probability of a word
5By q–calculus is roughly meant the collection of special function identities relating power series of
the form P an(q)zn, where an(q) is a rational fraction whose degree is quadratic in n. See [11, Ch. 10]
for basics and [230] for more advanced (q–hypergeometric) material.

V.2. REGULAR SPECIFICATION AND LANGUAGES
293
is the product of the probabilities of its letters (cf Section III. 6.1, 178). A word p = y1 · · · yk
called the pattern is ﬁxed. The problem is to gather information on the random variable X
representing the number of occurrences of p in the set Wn, where occurrences as a “hidden
pattern”, i.e., as a subsequence, are counted (Example I.11, p. 51).
The generating function associated to W endowed with its probabilistic weighting is
W (z) =
1
1 −P pjz =
1
1 −z .
The regular speciﬁcation
(29)
O = SEQ(A)y1 SEQ(A) · · · SEQ(A)yk−1 SEQ(A)yk SEQ(A)
describes all contexts of occurrences of p as a subsequence in all words. Graphically, this may
be rendered as follows for a pattern of length 3, p = y1y2y3:
(30)
y1
y2
y3
There the boxes indicate distinguished positions where letters of the pattern appear and the
horizontal lines represent arbitrary separating words (SEQ(A)). The corresponding OGF
(31)
O(z) =
π(p)zk
(1 −z)k+1 ,
π(p) := py1 · · · pyk−1pyk
counts elements of W with multiplicity6, where the multiplicity coefﬁcient λ(w) of a word w ∈
W is precisely equal to the number of occurrences of p as a subsequence in w:
O(z) ≡
X
w∈A⋆
λ(w)π(w)z|w|.
There results that the mean number of hidden occurrences of p in a random word of length n is
(32)
[zn]O(z) = π(p)
 
n
k
!
,
which is consistent with what a direct probabilistic reasoning would give.
We next proceed to determine the variance of X over Wn. In order to do so, we need
contexts in which pairs of occurrences appear. Let Q denote the set of all words in W with two
occurrences (i.e., an ordered pair of occurrences) of p as a subsequence being distinguished.
Then clearly [zn]Q(z) represents EWn[X2]. There are several cases to be considered. Graphi-
cally, a pair of occurrences may share no common position, like in what follows:
(33)
(
y1
y2
y3
y1
y2
y3
But they may also have one or several overlapping positions, like in
(34)
(
y1
y2
y3
y1
y2
y3
(35)
(
y1
y2
y3
y1
y2
y3
(This last situation necessitates y2 = y3, typical patterns being abb and aaa.)
6
In
language-theoretic
terms,
we
are
making
use
of
the
regular
expression
O
=
A⋆y1A⋆· · · yk−1A⋆ykA⋆, that describes a subset of A⋆in an ambiguous manner and take into account
the ambiguity coefﬁcients.

294
V. APPLICATIONS OF RATIONAL AND MEROMORPHIC ASYMPTOTICS
In the ﬁrst case corresponding to (33), where there are no overlapping positions, the con-
ﬁgurations of interest have OGF
(36)
Q[0](z) =
 
2k
k
!
π(p)2z2k
(1 −z)2k+1 .
There, the binomial coefﬁcient
`2k
k
´
counts the total number of ways of freely interleaving two
copies of p; the quantity π(p)2z2k takes into account the 2k distinct positions where the letters
of the two copies appear; the factor (1−z)−2k−1 corresponds to all the possible 2k + 1 ﬁllings
of the gaps between letters.
In the second case, let us start by considering pairs where exactly one position is overlap-
ping, like in (34). Say this position corresponds to the rth and sth letters of p (r and s may be
unequal). Obviously, we need yr = ys for this to be possible. The OGF of the conﬁgurations
is now
 
r + s −2
r −1
! 
2k −r −s
k −r
!
π(p)2(pyr)−1z2k−1
(1 −z)2k
.
There, the ﬁrst binomial coefﬁcient
`r+s−2
r−1
´
counts the total number of ways of interleaving
y1 · · · yr−1 and y1 · · · ys−1; the second binomial
`2k−r−s
k−r
´
is similarly associated to the inter-
leavings of yr+1 · · · yk and ys+1 · · · yk; the numerator takes into account the fact that 2k −1
positions are now occupied by predetermined letters; ﬁnally the factor (1 −z)−2k corresponds
to all the 2k ﬁllings of the gaps between letters. Summing over all possibilities for r, s gives the
OGF of pairs with one overlapping position as
(37)
Q[1](z) =
0
@
X
1≤r,s≤k
 
r + s −2
r −1
! 
2k −r −s
k −r
!
[[yr = ys]]
pyr
1
A π(p)2z2k−1
(1 −z)2k .
Similar arguments show that the OGF of pairs of occurrences with at least two shared
positions (see, e.g., 35)) is of the form, with P a polynomial,
(38)
Q[≥2](z) =
P(z)
(1 −z)2k−1 ,
for the essential reason that, in the ﬁnitely many remaining situations, there are at most (2k−1)
possible gaps.
We can now examine (36), (37), (38) in the light of singularities. The coefﬁcient [zn]Q[0](z)
is seen to cancel to ﬁrst asymptotic order with the square of the mean as given in (32). The
contribution of the coefﬁcient [zn]Q[≥2](z) appears to be negligible as it is O(n2k−2). The
coefﬁcient [zn]Q[1](z), which is O(n2k−1), is seen to contribute to the asymptotic growth of
the variance. In summary, after a trite calculation, we obtain:
Proposition V.2. The number X of occurrences of a hidden pattern p in a random text of size n
obeying a Bernoulli model satisﬁes
EWn[X] = π(p)
 
n
k
!
∼π(p)
k! nk,
VWn[X] = π(p)2κ(p)2
(2k −1)! n2k−1
„
1 + O( 1
n)
«
,
where the “correlation coefﬁcient” κ(p)2 is given by
κ(p)2 =
X
1≤r,s≤k
 
r + s −2
r −1
! 
2k −r −s
k −r
! „[[yr = ys]]
pyr
−1
«
.
In particular, the distribution of X is concentrated around its mean.

V.3. NESTED SEQUENCES, LATTICE PATHS, AND CONTINUED FRACTIONS.
295
This example is based on an article by Flajolet, Szpankowski, and Vall´ee [215]. There the
authors show further that the asymptotic behaviour of moments of higher order can be worked
out. By the moment convergence theorem, this calculation entails that the distribution of X
over Wn is asymptotically normal. The method also extends to a much more general notion
of “hidden” pattern, e.g., distances between letters of p can be constrained in various ways
so as to determine a valid occurrence in the text [215]. It also extends to the very general
framework of dynamical sources [65], which include Markov models as a special case. The
two references [65, 215] thus provide a set of analyses that interpolate between the two extreme
notions of pattern occurrence—as a block of consecutive symbols or as a subsequence (“hidden
pattern”). Such studies demonstrate that hidden patterns are with high probability bound to
occur an extremely large number of times in a long enough text—this might cast some doubts
on numerological interpretations encountered in various cultures: see in particular the critical
discussion of the “Bible Codes” by McKay et al. in [354]. . . . . . . . END OF EXAMPLE V.5. □
 V.9. Hidden patterns and shufﬂe relations.
To each pairs u, v of words over A associate
the weighted-shufﬂe polynomial in the indeterminates A denoted by
``u
v
´´
t and deﬁned by the
properties
8
>
>
>
>
<
>
>
>
>
:
  
xu
yv
!!
t
= x
  
u
yv
!!
t
+ y
  
xu
v
!!
t
+ t[[x = y]]x
  
u
v
!!
t
  
1
u
!!
t
=
  
u
1
!!
t
= u
where t is a parameter, x, y are elements of A, and 1 is the empty word. Then the OGF of Q(z)
above is
Q(z) = σ
»   
p
p
!!
(1−z)
–
1
(1 −z)2k+1 ,
where σ is the substitution aj 7→pjz.

V. 3. Nested sequences, lattice paths, and continued fractions.
This section treats nested sequence constructions corresponding to a schema in-
volving a cascade of sequences of the rough form SEQ ◦SEQ ◦· · · ◦SEQ. Such a
schema covers Dyck and Motzkin path, a particular type of Łukasiewicz paths al-
ready encountered in Section I. 5.3 (p. 68). Equipped with probabilistic weights, these
paths appear as trajectories of birth-and-death processes (the case of pure-birth pro-
cesses has already be dealt with in Example 3 above). They also have great descriptive
power since, once endowed with integer weights, they can encode a large variety of
combinatorial classes, including trees, permutations, set partitions, and surjections.
Since a combinatorial sequence translates into a quasi-inverse, Q(f) = (1−f)−1,
a class described by nested sequences has its generating function expressed by a cas-
cade of fractions, that is, a continued fraction7. Analytically, these GFs have at most
two dominant poles (the Dyck case) or a single pole (the Motzkin case) on their disc
of convergence, so that the implementation of the process underlying Theorem V.1
is easy: we encounter a pure polynomial form of the simplest type that describes all
7Characteristically, the German term for “continued fraction”, is “Kettenbruch”, literally “chain-
fraction”.

296
V. APPLICATIONS OF RATIONAL AND MEROMORPHIC ASYMPTOTICS
counting sequences of interest. The proﬁle of a nested sequence can also be easily
characterized.
This section starts with a statement of the “Continued Fraction Theorem” taken
from an old study of Flajolet [168], which provides the general set up for the rest of
the section. It then proceeds with the general analytic treatment of nested sequences.
A number of examples from various areas of discrete mathematics are then detailed.
Some of these make use of structures that are described as inﬁnitely nested sequences,
that is, inﬁnite continued fractions, to which the ﬁnite theory often extends—the anal-
ysis of coin fountains below is typical.
V. 3.1. Combinatorial aspects. We discuss here a special type of lattice paths
connecting points of the discrete Cartesian plane Z × Z.
Deﬁnition V.3 (Lattice path). A Motzkin path υ = (U0, U1, . . . , Un) is a sequence
of points in the discrete quarter plane Z≥0 × Z≥0 such that Uj = (j, yj), and the
jump condition |yj+1 −yj| ≤1 is satisﬁed. An edge ⟨Uj, Uj+1⟩is called an ascent if
yj+1 −yj = +1, a descent if yj+1 −yj = −1, and a level step if yj+1 −yj = 0. A
path that has no level steps is called a Dyck path.
The quantity n is the length of the path, ini(υ) := y0 is the initial altitude,
ﬁn(υ) := yn is the ﬁnal altitude.
A path is called an excursion if both its ini-
tial and ﬁnal altitudes are zero. The extremal quantities sup{υ} := maxj yj and
inf{υ} := minj yj are called the height and depth of the path.
A path can always be encoded by a word with a, b, c representing ascents, de-
scents, and level steps, respectively. What we call the standard encoding is such a
word in which each step a, b, c is (redundantly) subscripted by the value of the y-
coordinate of its initial point. For instance,
w = c0 a0 a1 a2 b3 c2 c2 a2 b3 b2 b1 a0 c1
encodes a path that connects the initial point (0, 0) to the point (13, 1). Such a path
can also be regarded as the evolution in discrete time of a walk over the integer line
with jumps restricted to {−1, 0, +1}, or equivalently as a path in the graph:
a0
a1
2
a
c0
c1
c2
1
2
b
b
· · · .
Lattice paths can also be interpreted as trajectories of birth-and-death processes, where
a population can evolve at any discrete time by a birth or a death. (Compare with the
pure-birth case in (21) above.)

V.3. NESTED SEQUENCES, LATTICE PATHS, AND CONTINUED FRACTIONS.
297
As a preparation for later developments, let us examine the description of the
class written H[<1]
0,0 of Motzkin excursions of height < 1. We have
H[<1]
0,0 ∼= SEQ(c0)
=⇒H[<1]
0,0 (z) =
1
1 −c0
.
The class of excursions of height < 2 is obtained from there by a substitution
c0 7→c0 + a0 SEQ(c1)b1,
to the effect that
H[<2] ∼= SEQ (c0 + a0 SEQ(c1)b1)
=⇒
H[<2](z) =
1
1 −c0 −a0b1
1 −c1
=
1 −c1
1 −c0 −c1 + c0c1 −a0b1
.
Iteration of this simple mechanism lies at the heart of the calculations performed be-
low. Clearly, generating functions written in this way are nothing but a concise de-
scription of usual counting generating functions: for instance if individual weights8
αj, βj, γj are assigned to the letters aj, bj, cj respectively, then the OGF of multi-
plicatively weighted paths with z marking length is obtained by setting
(39)
aj = αjz,
bj = βjz,
cj = γjz.
The general class of paths of interest in this subsection is deﬁned by arbitrary
combinations of ﬂooring (by m) ceiling (by h), as well as ﬁxing initial (k) and ﬁnal
(l) altitudes. Accordingly, we deﬁne the following subclasses of the class H of all
Motzkin paths:
H[m≤•<h]
k,l
:=
{w ∈H : ini(w) = k, ﬁn(w) = l, m ≤inf{w}, sup{w} < h}.
We shall also need the specializations,
H[<h]
k,l
= H[0≤•<h]
k,l
,
H[≥m]
k,l
= H[m≤•<∞]
k,l
,
Hk,l = H[0≤•<∞]
k,l
.
(Thus, the supercript indicates the condition that is to be satisﬁed by all abscissae of
vertices of the path.) Three simple combinatorial decompositions of paths (Figure 5)
then sufﬁce to derive all the basic formulæ.
— Arch decomposition: An excursion from and to level 0 consists of a sequence
of “arches”, each made of either a c0 or a a0H[≥1]
1,1 b1, so that
(40)
H0,0 = SEQ

c0 ∪a0H[≥1]
1,1 b1

,
which relativizes to height < h.
— Last passages decomposition.
Recording the times at which each level
0, . . . , k is last traversed gives
(41)
H0,k = H[≥0]
0,0 a0H[≥1]
1,1 a1 · · · ak−1H[≥k]
k,k
8Throughout this chapter, all weights are assumed to be nonnegative.

298
V. APPLICATIONS OF RATIONAL AND MEROMORPHIC ASYMPTOTICS
FIGURE V.5. The three major decompositions of lattice paths: the arch decomposition
(top), the last passages decomposition (bottom left), and the ﬁrst passage decomposition
(bottom right).
— First passage decomposition. The quantities Hk,l with k ≤l are implicitly
determined by the ﬁrst passage through k in a path connecting level 0 to l,
so that
(42)
H0,l
=
H[<k]
0,k−1ak−1Hk,l
(k ≤l),
(A dual decomposition holds when k ≥l.)
The basic results express the generating functions in terms of a fundamental con-
tinued fraction and its associated convergent polynomials. They involve the “numera-
tor” and “denominator” polynomials, denoted by Ph and Qh that are deﬁned as solu-
tions to the second order (or “three-term”) recurrence equation
(43)
Yh+1 = (1 −ch)Yh −ah−1bhYh−1, h ≥0,
together with the initial conditions (P−1, Q−1) = (−1, 0), (P0, Q0) = (0, 1), and
with the convention a−1b0 = 1. In other words, setting Cj = 1−cj and Aj = aj−1bj,
we have:
(44)
P0 = 0,
P1 = 1,
P2 = C1,
P3 = C1C2 −A2
Q0 = 1,
Q1 = C0,
Q2 = C0C1 −A1,
Q3 = C0C1C2 −C2A1 −C0A2.
These polynomials are also known as continuant polynomials [308, 489].
 V.10. Combinatorics of continuant polynomials. The polynomial Qh is obtained by the fol-
lowing process: start with the product Π := C0C1 · · · Ch−1; then cross out in all possible ways
pairs of adjacent elements Cj−1Cj, replacing each such crossed pair by −Aj. For instance, Q4
is obtained as
C0C1C2C3 +
−A1
z }| {
——
C0C1 C2C3 + C0
−A2
z }| {
——
C1C2 C3 + C0C1
−A3
z }| {
——
C2C3 +
−A1
z }| {
——
C0C1
−A3
z }| {
——
C2C3 .
The polynomials Ph are obtained similarly after a shift of indices. (These observations are due
to Euler; see [248, §6.7].)


V.3. NESTED SEQUENCES, LATTICE PATHS, AND CONTINUED FRACTIONS.
299
Proposition V.3 (Continued Fraction Theorem [168]). (i) The generating function
H0,0 of all excursions is represented by the fundamental continued fraction:
H0,0
=
1
1 −c0 −
a0b1
1 −c1 −
a1b2
1 −c2 −a2b3
...
.
(45)
(ii) The generating function of ceiled excursion H[<h]
0,0
is given by a convergent of the
fundamental continued fraction (45), with Ph, Qh as in Equation (43):
H[<h]
0,0
=
1
1 −c0 −
a0b1
1 −c1 −
a1b2
...
1 −ch−1
=
Ph
Qh
.
(46)
(iii) The generating function of ﬂoored excursions is given by a truncation of the
fundamental fraction:
H[≥h]
h,h
=
1
1 −ch −
ahbh+1
1 −ch+1 −ah+1bh+2
...
(47)
=
1
ah−1bh
QhH0,0 −Ph
Qh−1H0,0 −Ph−1
,
(48)
PROOF. Repeated use of the arch decomposition (40) provides a form of H[<h]
0,0
with
nested quasi-inverses (1 −f)−1 that is the ﬁnite fraction representation (46), for in-
stance,
H[<1]
00
∼= SEQ{c0},
H[<2]
00
∼= SEQ{c0 + a0 SEQ{c1}b1},
H[<3]
00
∼= SEQ{c0 + a0 SEQ{c1 + a1 SEQ{c2}b2}b1}.
The continued fraction representation for basic paths without height constraints (namely
H0,0) is then obtained by letting h →∞in (46). Finally, the continued fraction
form (47) for ceiled excursions is nothing but the fundamental form (45), when the
indices are shifted. The three continued fraction expansions (45), (46), (47) are hence
established.
Finding explicit expressions for the fractions H[<h]
0,0
and H[≥h]
h,h next requires de-
termining the polynomials that appear in the convergents of the basic fraction (45).
By deﬁnition, the convergent polynomials Ph and Qh are the numerator and denomi-
nator of the fraction H[<h]
0,0 . For the computation of H[<h]
0,0
and Ph, Qh, one classically

300
V. APPLICATIONS OF RATIONAL AND MEROMORPHIC ASYMPTOTICS
introduces the linear fractional transformations
gj(y) =
1
1 −cj −ajbj+1y,
so that
(49)
H[<h]
0,0
= g0 ◦g1 ◦g2 ◦· · · ◦gh−1(0) and H0,0 = g0 ◦g1 ◦g2 ◦· · · , .
Now, linear fractional transformations are representable by 2 × 2-matrices
(50)
ay + b
cy + d 7→
 a
b
c
d

,
in such a way that composition corresponds to matrix product. By induction on the
compositions that build up H[<h]
0,0 , there follows the equality
(51)
g0 ◦g1 ◦g2 ◦· · · ◦gh−1(y) = Ph −Ph−1ah−1bhy
Qh −Qh−1ah−1bhy ,
where Ph and Qh are seen to satisfy the recurrence (43). Setting y = 0 in (51)
proves (46).
Finally, H[≥h]
h,h
is determined implicitly as the root y of the equation g0 ◦· · · ◦
gh−1(y) = H0,0, an equation that, when solved using (51), yields the form (48).
□
A large number of generating functions can be derived by similar techniques. We
refer to the article [168], where this theory was ﬁrst systematically developed and
to the exposition given in [244, Chapter 5]. Our presentation also draws upon [188]
where the theory was put to use in order to develop a formal algebraic theory of general
birth-and-death processes in continuous time.
 V.11. Transitions and crossings. The lattice paths H0,l corresponding to the transitions from
altitude 0 to l and Hk,0 (from k to 0) have OGFs
H0,l = 1
Bl (QlH0,0 −Pl) ,
Hk,0 = 1
Ak (QkH0,0 −Pk).
The crossings H[<h]
0,h−1 and H[<h]
h−1,0 have OGFs,
H[<h]
0,h−1 = Ah−1
Qh
,
H[<h]
h−1,0 = Bh−1
Qh
.
(Abbreviations used here are: Am = a0 · · · am−1, Bm = b1 · · · bm.) These extensions pro-
vide combinatorial interpretations for fractions of the form 1/Q. They result from the basic
decompositions combined with Proposition V.3; see [168, 188] for details.

 V.12. Denominator polynomials and orthogonality.
Let Hn = [zn]H0,0(z) represent
the number of all excursions of length n equipped with nonnegative weights. Deﬁne a linear
functional L on the space C(z) of polynomials by L[zn] = Hn. Introduce the reciprocal
polynomials: Qh(z) = zhQ(1/z). The fact deducible from Note 11 that QlH0,0−Pl = O(zl)
corresponds to the property L[zjQl) = 0 for all 0 ≤j < l. In other words, the polynomials
Ql are orthogonal with respect to the special scalar product ⟨f, g⟩:= L[fg]. (Historically, the
theory of orthogonal polynomials evolved from the theory of continued fractions before living
a life of its own; see [88, 277, 457] for its many facets.)


V.3. NESTED SEQUENCES, LATTICE PATHS, AND CONTINUED FRACTIONS.
301
 V.13. Discrete time birth-and-death processes. Assume that, at discrete times n = 0, 1, 2, . . .,
a population of size j can grow by one element [a birth] with probability αj, decrease by one
element [a death] with probability βj, and stay the same with probability γj = 1 −αj −βj.
Let ωn be the probability that an initially empty population is again empty at time n. Then the
GF of the sequence (ωn) is
X
n≥0
ωnzn =
1
1 −γ0z −
α0β1z2
1 −γ1z −α1β2z2
· · ·
.
This result was found by I. J. Good in 1958: see [243].

 V.14. Continuous time birth-and-death processes. Consider a continuous time birth-and-
death process, where a transition from state j to j + 1 takes place according to an exponential
distribution of rate λj and a transition from j to j −1 has rate µj. Let ̟(t) be the probability
to be in state 0 at time t starting from state 0 at time 0. One has
Z ∞
0
e−st̟(t) dt =
1
s + λ0 −
λ0µ1
s + λ1 + µ1 −λ1µ2
· · ·
=
1
s +
λ0
1 +
µ1
s + λ1
· · ·
.
Thus, continued fractions and orthogonal polynomials may be used to analyse birth-and-death
processes. (This fact was originally discovered by Karlin and McGregor [289], with later ad-
ditions due to Jones and Magnus [285]. See [188] for a systematic discussion in relation to
combinatorial theory.)

V. 3.2. Analytic aspects. We now consider the general asymptotic properties of
lattice paths of height bounded from above by a ﬁxed integer h ≥1. Letters denoting
elementary steps are weighted, as previously indicated, with
aj = αjz,
bj = βjz,
cj = γjz,
the weights being invariably nonnegative. We shall limit the discussion to excursions,
which are often the most interesting objects from the combinatorial point of view.
As a preamble, in the Dyck case, where all γj are 0 (level steps are disallowed),
the GF H[<h] is a function of z2 only, since it takes an even number of steps to return
to altitude 0 when starting from altitude 0. In such a case, we shall systematically
assume that, when considering [zn]H[<h], the index n = 2ν is even. In order to
avoid trivialities, we also assume that none of the coefﬁcients attached to ascents and
descents are 0.
Theorem V.3 (Asymptotics of nested sequences). Consider the class H[<h]
0,0 of weighted
Motzkin excursions of height < h. Their number satisﬁes a pure exponential-polynomial
formula,
H[<h]
0,0,n = cBn + O(Cn),
where B > 0 and 0 ≤C < B. In the Dyck case, it is assumed furthermore that n ≡0
(mod 2).

302
V. APPLICATIONS OF RATIONAL AND MEROMORPHIC ASYMPTOTICS
PROOF. The proof9 proceeds by induction according to the depth of nesting of the
sequence constructions. Write
fj(z) := H[<h]
h−j−1,h−j−1(z),
and let ρj denote the dominant singularity of fj that is positive (existence is guaranteed
by Pringsheim’s Theorem).
For ease of discussion, we ﬁrst examine the case where all γj are nonzero. The
function f0(z) is
f0(z) =
1
1 −γh−1z ,
and one has ρ0 = 1/γh−1. The function f1 is given by
f1(z) =
1
1 −γh−2z −αh−2βh−1z2f0(z).
The quantity γh−2z + αh−2βh−1z2f0(z) in its denominator increases continuously
from 0 to +∞as z increases from 0 to ρ0; consequently, it crosses the value 1 at some
point which must be ρ1. In particular, one must have ρ1 < ρ0. Our assumption that
all the γj are nonzero implies the absence of periodicities, so that ρ1 is the unique
dominant singularity. The argument can be repeated, implying that the sequence of
radii is decreasing ρ0 > ρ1 > ρ2 > · · · , the corresponding poles are all simple, and
they are uniquely dominating. The statement is thus established in the case that all the
γj are nonzero.
Dually, in the Dyck case where all the γj are zero, one can reason in a similar
manner, operating with the collection of “condensed” series fj(√z), which are seen
to have a unique dominant singularity. This implies that fj(z) itself has exactly two
dominant singularities, namely ρh and −ρh, both being simple poles.
In the mixed case, the fj are initially of the Dyck type, till a certain γh−1−j0 ̸= 0
is encountered. In that case the function fj0 is aperiodic (its span in the sense of
Chapter IV is 1). The reasoning then continues like in the Motzkin case, with all the
subsequent fj (for j ≥j0) including fh−1(z) ≡H[<h]
0,0 (z) having a unique dominant
singularity.
□
Similar devices yield a characterization of the proﬁle of a random path, that is,
the number of times a given step appears in a random excursion.
Theorem V.4 (Proﬁle of nested sequences). Let Xn be the random variable repre-
senting the number of times a given step (of type aj, bj, or cj) with nonzero weight
appears in a random excursion of length n and height < h. The moments of Xn satisfy
E(Xn) = c1n + d1 + O(Dn),
V(Xn) = c2n + d2 + O(Dn),
for constants c1, c2, d1, d2, D, with c1, c2 > 0 and 0 ≤D < 1. In particular the
distribution of Xn is concentrated.
9The present discussion is also related to the analysis of the supercritical sequence schema in the next
section.

V.3. NESTED SEQUENCES, LATTICE PATHS, AND CONTINUED FRACTIONS.
303
PROOF. Introduce an auxiliary variable u with u marking the number of designated
steps, and form the corresponding BGF H(z, u). We only discuss the expectation.
The function H is a linear fractional transformation in u of the form
H(z, u) = A(z) +
1
C(z) + uD(z).
(The coefﬁcients A, B, C are a priori in C(z); they are in fact computable from Propo-
sition V.3.) Then, one has
∂
∂uH(z, u)

u=1
= −
D(z)
(C(z) + D(z))2 .
This function resembles H(z, 1)2. An application of the chain rule permits us to verify
that indeed
∂
∂uH(z, u)

u=1
= E(z)H(z, 1)2,
where E(z) is analytic in disc larger than the disc of analyticity of H(z, 1). The
analysis of the dominant double pole then yields the result. (The determination of the
second moment follows along similar lines, though the computations become more
intricate.)
□
 V.15. All poles are real. Assume again αjβj+1 > 0 and γj ≥0. By Note 12, the denomina-
tor polynomials Qh are reciprocals of a family of polynomials Qh that are formally orthogonal
with respect to a scalar product. Thus the zeros of any of the Qh are all real, and so are the
zeros of Qh. Consequently: The poles of the OGF of ceiled excursions H[<h]
0,0
are all real. (See
for instance [457, §3.3] for the basic argument.)

V. 3.3. Applications. Lattice paths corresponding to nested sequences have a
quite a wide range of descriptive power, especially when weights are allowed. We
illustrate this fact by three types of examples.
— Example 6 provides a complete analysis of height in Dyck paths and general
plane rooted trees, as regards moments as well as distribution. This is the
simplest case of a continued fraction with constant coefﬁcients attached to
the OGF of Catalan numbers and Fibonacci-Chebyshev polynomials.
— Example 7 discusses coin fountains. There, we are dealing with an inﬁnite
continued fraction to which the techniques of the previous subsection can be
extended. The developments also takes us close to the realm of q-calculus
and to the analysis of alcohols seen in Chapter IV.
— Example 8 constitutes a typical application of the possibility of encoding
combinatorial structures—here we examine interconnection networks—by
means of lattice path weighted by integers. The enumeration involves Her-
mite polynomials. Other examples related to set partitions and permutations
are described in the accompanying notes.
EXAMPLE V.6. Height of Dyck paths and plane rooted trees. In order to count lattice paths of
the Dyck (D) or Motzkin (M) type, it sufﬁces to effect one of the substitutions,
σM : aj 7→z, bj 7→z, cj 7→z;
σD : aj 7→z, bj 7→z, cj 7→0.

304
V. APPLICATIONS OF RATIONAL AND MEROMORPHIC ASYMPTOTICS
FIGURE V.6. Three random Dyck paths of length 2n = 500 have heights resp. 20, 31,
24: the distribution is spread, see Proposition V.4.
We henceforth restrict attention to the case of Dyck paths. See Figure 6 for three simulations
suggesting that the distribution of height is somewhat spread. Given the parenthesis system
representation (Note I.45, p.73), the height of a Dyck path automatically translates into as height
of the corresponding plane rooted tree.
The continued fraction expressing H0,0 results immediately from Proposition V.3 and is in
this case periodic (here, in the sense that its stages are all alike), so that it represents a quadratic
function,
H0,0(z) =
1
1 −
z2
1 −
z2
1 −...
=
1
2z2
“
1 −
p
1 −4z2
”
,
since H0,0 satisﬁes y = (1−z2y)−1. The families of polynomials Ph, Qh are in this case deter-
mined by a recurrence with constant coefﬁcients. Deﬁne classically the Fibonacci polynomials
by the recurrence
(52)
Fh+2(z) = Fh+1(z) −zFh(z),
F0(z) = 0,
F1(z) = 1.
One ﬁnds Qh = Fh+1(z2) and Ph = Fh(z2). (The Fibonacci polynomials are reciprocals of
Chebyshev polynomials; see Note 16.) By Proposition V.3, the GF of paths of height < h is
then
H[<h]
00
(z) =
Fh(z2)
Fh+1(z2).
(We get more and, for instance, the number of ways of crossing a strip of width h −1 is
H[<h]
0,h−1(z) = zh−1/Fh+1(z2).) Note that the polynomials have an explicit form,
Fh(z) =
⌊(h−1)/2⌋
X
k=0
 
h −1 −k
k
!
(−z)k,
as follows from the generating function expression: P
h Fh(z)yh = y/(1 −y + zy2).
The equivalence between Dyck paths and (general) plane tree traversals discussed in Chap-
ter I implies that trees of height at most h and size n + 1 are equinumerous with Dyck paths of
length 2n and height at most h. Set for convenience
G[h](z) = zH[<h+1]
00
(z1/2) = z Fh+1(z)
Fh+2(z),
which is precisely the OGF of general plane trees having height ≤h. (This is otherwise in
agreement with the continued fraction forms obtained directly in Chapter III: cf (52), p. 184
and (75), p. 205.) It is possible to go much further as ﬁrst shown by De Bruijn, Knuth, and Rice

V.3. NESTED SEQUENCES, LATTICE PATHS, AND CONTINUED FRACTIONS.
305
in a landmark paper [113], which also constitutes the historic application of Mellin transforms
in analytic combinatorics. (We refer to this paper for historical context and references.)
First, solving the linear recurrence (52) with z treated as a parameter yields the alternative
closed form expression
(53)
Fh(z) = Gh −G
h
G −G ,
G = 1 −√1 −4z
2
,
G = 1 + √1 −4z
2
.
There, G(z) is the OGF of all trees, and an equivalent form of G[h] is provided by
(54)
G −G[h−2] =
√
1 −4z
uh
1 −uh ,
where
u = 1 −√1 −4z
1 + √1 −4z = G2
z ,
as is easily veriﬁed. Thus G[h] can be expressed in terms of G(z) and z:
G −G[h−2] =
√
1 −4z
X
j≥1
z−jhG(z)2jh.
The Lagrange-B¨urmann inversion theorem then gives after a simple calculation
(55)
Gn+1 −G[h−2]
n+1 =
X
j≥1
∆2
 
2n
n −jh
!
,
where
∆2
 
2n
n −m
!
:=
 
2n
n + 1 −m
!
−2
 
2n
n −m
!
+
 
2n
n −1 −m
!
.
Consequently, the number of trees of height ≥h −1 admits a closed form: it is a “sampled”
sum, by steps of h, of the 2nth line of Pascal’s triangle (upon taking second order differences).
The relation (55) leads easily to the asymptotic distribution of height in random trees of
size n. Stirling’s formula yields the Gaussian approximation of binomial numbers: for k =
o(n3/4) and with w = k/√n, one ﬁnds
(56)
` 2n
n−k
´
`2n
n
´ ∼e−w2 „
1 −w4 −3w2
6n
+ 5w8 −54w6 + 135w4 −60w2
360n2
+ · · ·
«
.
The use of the Gaussian approximation (56) inside the exact formula (55) then implies: The
probability that a tree of size n + 1 has height at least h −1 satisﬁes uniformly for h ∈
[α√n, β√n] (for any α, β such that 0 < α < β < ∞) the estimate
(57)
Gn+1 −G[h−2]
n+1
Gn+1
= Θ
„ h
√n
«
+ O
„ 1
n
«
,
Θ(x) :=
X
j≥1
e−j2x2(4j2x2 −2).
The function Θ(x) is a “theta function” which classically arises in the theory of elliptic func-
tions [492]. Since binomial coefﬁcients decay fast away from the center, simple bounds also
show that the probability of height to be at least n1/2+ǫ decays like exp(−n2ǫ), hence is expo-
nentially small. Note also that the probability distribution of height H itself admits of an exact
expression obtained by differencing (55), which is reﬂected asymptotically by differentiation of
the estimate of (57):
(58)
PGn+1
ˆ
H = ⌊x√n⌋
˜
= −1
√nΘ′ (x)+O
„ 1
n
«
,
Θ′(x) :=
X
j≥1
e−j2x2(12j2x−8j4x3).

306
V. APPLICATIONS OF RATIONAL AND MEROMORPHIC ASYMPTOTICS
0
0.2
0.4
0.6
0.8
1
0.5
1
1.5
2
2.5
3
FIGURE V.7. The limit density of the distribution of height −Θ′(x).
The forms (57) and (58) also give access to moments of the distribution of height. We ﬁnd
EGn+1
ˆ
Hr˜
∼
1
√nSr
„ 1
√n
«
,
where
Sr(y) := −
X
h≥1
hrΘ′(hy).
The quantity yr+1Sr(y) is a Riemann sum relative to the function −xrΘ′(x), and the step
y = n−1/2 decreases to 0 as n →∞. Approximating the sum by the integral, one gets:
EGn+1
ˆ
Hr˜
∼nr/2µr
where
µr := −
Z ∞
0
xrΘ′(x) dx.
The integral giving µr is a Mellin transform in disguise (set s = r + 1) to which the treatment
of harmonic sums applies. We then get upon replacing n + 1 by n:
Proposition V.4. The expected height of a random plane rooted tree comprising n + 1 nodes is
(59)
√πn −3
2 + o(1).
More generally, the moment of order r of height is asymptotic to
(60)
µrnr/2
where
µr = r(r −1)Γ(r/2)ζ(r).
The random variable H/√n obeys asymptotically a Theta distribution, in the sense of both the
“central” estimate (57) and the “local” estimate (58). The same asymptotic estimates hold for
height of Dyck paths having length 2n.
The improved estimate of the mean (59) is from [113]. The general form of moments
in (60) is in fact valid for any real r (not just integers). An alternative formula for the Theta func-
tion appears in the Note below. Figure 7 plots the limit density −Θ′(x). END OF EXAMPLE V.6. □
 V.16. Height and Fibonacci–Chebyshev polynomials. The reciprocal polynomials F h(z) =
Fh−1(z) = zh−1Fh(1/z2) are related to the classical Chebyshev polynomials by F h(2z) =
Uh(z), where Uh(cos(θ)) = sin((h + 1)θ)/ sin(θ). (This is readily veriﬁed from the recur-
rence (52) and elementary trigonometry.) Thus, the roots of Fh(z) are (4 cos2 jπ/(h + 1))−1
and the partial fraction expansion of G[h](z) can be worked out explicitly [113]. There results,
for n ≥1,
(61)
G[h−2]
n+1 = 4n+1
h
X
1≤j<h/2
sin2 jπ
h cos2n jπ
h ,

V.3. NESTED SEQUENCES, LATTICE PATHS, AND CONTINUED FRACTIONS.
307
which provides in particular an asymptotic form for any ﬁxed h. (This formula can also be
found directly from the sampled sum (55) by multisection of series.) Asymptotic analysis of
this last expression when h = x√n yields the alternative expression
lim
n→∞PGn+1
ˆ
H ≤x√n
˜
= 4π5/2x−3 X
j≥0
j2e−j2π2/x2
( ≡1 −Θ(x)),
which, when compared with (57), reﬂects an important transformation formula of elliptic func-
tions [492]. See the study by Biane, Pitman, and Yor [52] for fascinating connections with
Brownian motion and the functional equation of the Riemann zeta function.

 V.17. Motzkin paths. The OGF of Motzkin paths of height < h is
1
1−z · DH[<h]
0,0
“
z
1−z
”
,
where DH[<h]
0,0
refers to Dyck paths. Therefore, such paths of length n can be enumerated
exactly by formulæ derived from (55–61). In particular, the mean height is ∼
p
πn/3.

 V.18. Height in simple varieties of trees. Consider a simple variety of trees corresponding
to the GF equation Y (z) = zφ(Y (z)) (see Chapter III) and values of n such that there exists
a tree of size n. Assume that there exists a positive τ strictly within the disc of convergence
of φ such that τφ′(τ) −φ(τ) = 0. Then, the rth moment of height (H) is asymptotically
ξr/2r(r −1)Γ(r/2)ζ(r)nr/2. The normalized quantity H = H/ξ obeys asymptotically a
Theta distribution in the sense of both the central estimate (57) and the local estimate (58).
[This is from [197] and [180] respectively.] For instance, ξ = 2 for plane binary trees and
ξ =
√
2 for Cayley trees.

EXAMPLE V.7. Area under Dyck path and coin fountains.
Consider Dyck paths and the
parameter equal to area below the path. Area under a lattice path is taken here as the sum of
the indices (i.e., the starting altitudes) of all the variables that enter the standard encoding of the
path. Thus, the BGF D(z, q) of Dyck path with z marking half-length and q marking area is
obtained by the substitution
aj 7→qjz,
bj 7→qj,
cj 7→0
inside the fundamental continued fraction (45). (We rederive here Equation (53) of Chapter III,
p. 184.) It proves convenient to operate with the continued fraction
(62)
F(z, q) =
1
1 −
zq
1 −zq2
...
,
so that D(z, q) = F(q−1z, q2). Since F and D satisfy difference equations, for instance,
(63)
F(z, q) =
1
1 −zqF(qz, q),
moments of area can be determined by differentiating and setting q = 1 (see Chapter III for
such a direct approach).
A general trick from q–calculus is effective for deriving an alternative form of F. Attempt
to express the continued fraction F of (62) as a quotient F(z, q) = A(z)/B(z). Then, the
relation (63) implies
A(z)
B(z) =
1
1 −qz A(qz)
B(qz)
,
hence A(z) = B(qz), B(z) = B(qz) −qzB(q2z),

308
V. APPLICATIONS OF RATIONAL AND MEROMORPHIC ASYMPTOTICS
where q is treated as a parameter. The difference equation satisﬁed by B(z) is then readily
solved by indeterminate coefﬁcients. (This classical technique was introduced in the theory of
integer partitions by Euler.) With B(z) = P bnzn, the coefﬁcients satisfy the recurrence
b0 = 1,
bn = qnbn −q2n−1bn−1.
This is a ﬁrst order recurrence on bn that unwinds to give
bn = (−1)n
qn2
(1 −q)(1 −q2) · · · (1 −qn).
In other words, introducing the “q-exponential function”,
(64)
E(z, q) =
∞
X
n=0
(−z)nqn2
(q)n
,
where
(q)n = (1 −q)(1 −q2) · · · (1 −qn),
one ﬁnds
(65)
F(z, q) = E(qz, q)
E(z, q) .
Given the importance of the functions under discussion in various branches of mathemat-
ics, we cannot resist a quick digression. The name of the q-exponential comes form the obvious
property that E(z(1 −q), q) reduces to e−z as q →1−. The explicit form (64) constitutes in
fact the “easy half” of the proof of the celebrated Rogers-Ramanujan identities, namely,
(66)
E(−1, q) =
∞
X
n=0
qn2
(q)n
=
∞
Y
n=0
(1 −q5n+1)−1(1 −q5n+4)−1
E(−q, q) =
∞
X
n=0
qn(n+1)
(q)n
=
∞
Y
n=0
(1 −q5n+2)−1(1 −q5n+3)−1,
that relate the q-exponential to modular forms. See Andrews’ book [10, Ch. 7] for context.
Here is ﬁnally a cute application of these ideas to the asymptotic enumeration of some
special polyominoes. Odlyzko and Wilf deﬁne in [377, 380] an (n, m) coin fountain as an
arrangement of n coins in rows in such a way that there are m coins in the bottom row, and
that each coin in a higher row touches exactly two coins in the next lower row. Let Cn,m be
the number of (n, m) fountains and C(z, q) be the corresponding BGF with q marking n and
z marking m. Set C(q) = C(1, q). The question is to determine the total number of coin
fountains of area n, [qn]C(q). The series starts as (this is EIS A005169)
C(q) = 1 + q + q2 + 2q3 + 3q4 + 5q5 + 9q6 + 15q7 + 26q8 + · · · ,
as results from inspection of the ﬁrst few cases.
There is a clear bijection with Dyck paths that takes area into account: a coin fountain of
size n with m coins on its base is equivalent to a Dyck path of length 2m and area 2n−m (with
our ealier deﬁnition of area of Dyck paths). From this bijection, one has C(z, q) = F(z, q)

V.3. NESTED SEQUENCES, LATTICE PATHS, AND CONTINUED FRACTIONS.
309
Objects
Weights (αj, βjγj)
Counting
Orth. pol.
Simple paths
1, 1, 0
Catalan #
Chebyshev
Permutations
j + 1, j, 2j + 1
Factorial #
Laguerre
Alternating perm.
j + 1, j, 0
Secant #
Meixner
Involutions
1, j, 0
Odd factorial #
Hermite
Set partition
1, j, j + 1
Bell #
Poisson-Charlier
Nonoverlap. set part.
1, 1, j + 1
Bessel #
Lommel
FIGURE V.8. Some special families of combinatorial objects together with correspond-
ing weights, counting sequences, and orthogonal polynomials. (See also Notes 20— 22.)
(with F as deﬁned earlier) and, in particular, C(q) = F(1, q). Consequently,
C(q) =
1
1 −
q
1 −
q2
1 −q3
...
,
which is (62) with z = 1. The identity (65) implies next:
C(q) = E(q, q)
E(1, q).
The rest of the discussion is analogous to Section IV. 7.3 (p. 269) relative to alcohols. The
function C(q) is a priori meromorphic in |q| < 1. An exponential lower bound of the form
1.6n holds for [qn]C(q), since (1 −q)/(1 −q −q2) is dominated by C(q) for q > 0. At the
same time, the number [qn]C(q) is majorized by the number of compositions, which is 2n−1.
Thus, the radius of convergence of C(q) has to lie somewhere between 0.5 and 0.61803 . . . . It
is then easy to check by numerical analysis the existence of a simple zero of the denominator,
E(1, q), near ρ .= 0.57614. Routine computations based on Rouch´e’s theorem then make it
possible to verify formally that ρ is the only pole in |q| ≤3/5 and that this pole is simple (the
process is detailed in [377]). Thus, singularity analysis of meromorphic functions applies:
Proposition V.5. The number of coin fountains made of n coins satisﬁes asymptotically
[qn]C(q) = cAn + O((5/3)n),
c .= 0.31236,
A = ρ−1 .= 1.73566.
This example illustrates the power of modelling by continued fractions as well as the
smooth articulation with meromorphic function asymptotics. . . . . . END OF EXAMPLE V.7. □
Lattice path encodings of classical structures. The systematic theory of lattice
path enumerations and continued fractions was developed initially because of the need
to count weighted lattice paths, notably in the context of the analysis of dynamic data
structures in computer science [179]. In this framework, a system of multiplicative
weights αj, βj, γj is associated with the steps aj, bj, cj, each weight being an integer
that represents a number of “possibilities” for the corresponding step type. A sys-
tem of weighted lattice paths has counting generating functions given by the usual
specialization of the corresponding multivariate expressions we have just developed,
namely,
(67)
aj 7→αjz,
bj 7→βjz,
cj 7→γjz,

310
V. APPLICATIONS OF RATIONAL AND MEROMORPHIC ASYMPTOTICS
FIGURE V.9. An interconnection network on 2n = 12 points.
where z marks the length of paths. One can then sometimes solve an enumeration
problem expressible in this way by reverse-engineering the known collection of con-
tinued fractions as found in a reference book like Wall’s treatise [489]. Next, for
general reasons, the polynomials P, Q are always elementary variants of a family of
orthogonal polynomials that is determined by the weights (see Note 12 and [88, 457]).
When the multiplicities have enough structural regularity, the weighted lattice paths
are likely to correspond to classical combinatorial objects and to classical families of
orthogonal polynomials; see [168, 179, 238, 244] and Figure 8 for an outline. We
illustrate this by a simple example due to Lagarias, Odlyzko, and Zagier [322], which
is relative to involutions without ﬁxed points.
EXAMPLE V.8. Interconnection networks and involutions.
The problem treated here has
been introduced by Lagarias, Odlyzko, and Zagier in [322]: There are 2n points on a line, with
n point-to-point connections between pairs of points. What is the probable behaviour of the
width of such an interconnection network? Imagine the points to be 1, . . . , 2n, the connections
as circular arcs between points, and let a vertical line sweep from left to right; width is deﬁned
as the maximum number of edges encountered by such a line. One may freely imagine a tunnel
of ﬁxed capacity (this corresponds to the width) inside which wires can be placed to connect
points pairwise. See Figure 9.
Let J2n be the class of all interconnection networks on 2n points, which is precisely
the collection of ways of grouping 2n elements into n pairs, or, equivalently, the class of all
involutions without ﬁxed points, i.e., permutations with cycles of length 2 only. The number
J2n equals the “odd factorial”,
J2n = 1 · 3 · 5 · · · (2n −1),
whose EGF is ez2/2 (see Chapter II, p. 113). The problem calls for determining the quantity
J[h]
2n that is the number of networks corresponding to a width ≤h.
The relation to lattice paths is as follows. First, when sweeping a vertical line across a
network, deﬁne an active arc at an abscissa as one that straddles that abscissa. Then build
the sequence of active arcs counts at half-integer positions 1
2, 3
2, . . . , 2n −1
2, 2n + 1
2. This
constitutes a sequence of integers where each member is ±1 the previous one, that is, a lattice
path without level steps. In other words, there is an ascent in the lattice path for each element
that is smaller in its cycle and a descent otherwise. One may view ascents as associated to
situations where a node “opens” a new cycle, while descents correspond to “closing” a cycle.
Involutions are much more numerous than lattice paths, so that the correspondence from
involutions to lattice paths has to be many-to-one. However, one can easily enrich lattice paths,
so that the enriched objects are in one-to-one correspondence with involutions. Consider again
a scanning position at a half-integer where the vertical line crosses ℓ(active) arcs. If the next
node is of the closing type, there are ℓpossibilities to choose from. If the next node is of
the opening type, then there is only one possibility, namely, to start a new cycle. A complete

V.3. NESTED SEQUENCES, LATTICE PATHS, AND CONTINUED FRACTIONS.
311
0
20
40
60
80
100
120
140
160
180
200
220
240
260
200
400
600
800
1000
x
0
20
40
60
80
100
120
140
160
180
200
220
240
260
200
400
600
800
1000
x
0
20
40
60
80
100
120
140
160
180
200
220
240
200
400
600
800
1000
x
FIGURE V.10. Three simulations of random networks with 2n = 1000 illustrate the
tendency of the proﬁle to conform to a parabola with height close to n/2 = 250.
encoding of a network is obtained by recording additionally the sequence of the n possible
choices corresponding to descents in the lattice path (some canonical order is ﬁxed, for instance,
oldest ﬁrst). If we write these choices as superscripts, this means that the set of all enriched
encodings of networks is obtained from the set of standard lattice path encodings by effecting
the substitutions
bj 7→
j
X
k=1
b(k)
j
.
The OGF of all involutions is obtained from the generic continued fraction of Proposi-
tion V.3 by the substitution
aj 7→z,
bj 7→j · z,
where z records the number of steps in the enriched lattice path, or equivalently, the number
of nodes in the network. In other words, we have obtained combinatorially a formal continued
fraction representation,
∞
X
n=0
(1 · 3 · · · (2n −1))z2n =
1
1 −
1 · z2
1 −
2 · z2
1 −3 · z2
...
,
which was originally discovered by Gauß [489]. Proposition V.3 also gives immediately the
OGF of involutions of width at most h as a quotient of polynomials. Deﬁne
J[h](z) :=
X
n≥0
J[h]
2n z2n.
One has
J[h](z) =
1
1 −
1 · z2
1 −
2 · z2
...
1 −h · z2
= Ph+1(z)
Qh+1(z)
where Ph and Qh satisfy the recurrence
Yh+1 = Yh −hz2Yh−1.
The polynomials are readily determined by their generating functions that satisﬁes a ﬁrst-order

312
V. APPLICATIONS OF RATIONAL AND MEROMORPHIC ASYMPTOTICS
linear differential equation reﬂecting the recurrence. In this way, the denominator polynomials
are identiﬁed to be reciprocals of the Hermite polynomials,
Hh(z) = (2z)hQh
„
1
z
√
2
«
,
themselves deﬁned classically [2, Ch. 22] as orthogonal with respect to the measure e−x2 dx
on (−∞, ∞) and expressible via
Hm(x) =
⌊m/2⌋
X
m=0
(−1)jm!
j!(m −2j)!(2x)m−2j,
X
m≥0
Hm(x)tm
m! = e2xt−t2.
In particular, one ﬁnds
J[0] = 1,
J[1] =
1
1 −z2 ,
J[2] = 1 −2z2
1 −3z2 ,
J[3] =
1 −5z2
1 −6z2 + 3z4 ,
&c.
The interesting analysis of the dominant poles of the rational GF’s, for any ﬁxed h, is
discussed in the paper [322]. Furthermore, simulations strongly suggest that the width of a
random interconnection network on 2n nodes is tightly concentrated around n/2; see Figure 10.
Louchard [341] succeeded in proving this fact and a good deal more: With high probability,
the altitude (the altitude is deﬁned here as the number of active arcs as time evolves) of a
random network conforms asymptotically to a deterministic parabola 2nx(1 −x) (with x ∈
[0, 1]) to which are superimposed random ﬂuctuations of a smaller amplitude, O(√n), well-
characterized by a Gaussian process. In particular, the width of a random network of 2n nodes
converges in probability to n
2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE V.8. □
 V.19. Bell numbers and continued fractions. With Sn = n![zn]eez−1 a Bell number:
X
n≥0
Snzn =
1
1 −1z −
1z2
1 −2z −2z2
· · ·
.
[Hint: Deﬁne an encoding like for networks, with level steps representing intermediate elements
of blocks [168].] Reﬁnements include Stirling partition numbers and involution numbers.

 V.20. Factorial numbers and continued fractions. One has
X
n≥0
n!zn =
1
1 −1z −
12z2
1 −3z −22z2
· · ·
.
Reﬁnements include tangent and secant numbers, as well as Stirling cycle numbers and Eulerian
numbers. (This continued fraction is due to Euler; see [168] for a proof based on a bijection of
Franc¸on and Viennot [221] and Biane’s paper [51] for alternative combinatorics.)

 V.21. Surjection numbers and continued fractions. Let Rn = n![zn](2 −ez)−1. Then
∞
X
n=0
Rnzn =
1
1 −1z −
2 · 12z2
1 −4z −
2 · 22z2
1 −7z −· · ·
.
This continued fraction is due to Flajolet [170].


V.4. SUPERCRITICAL SEQUENCE AND APPLICATIONS
313
 V.22. The Ehrenfest2 two-chambers model. See Note II.11, p. 109 for context. The OGF of
the number of evolutions that lead to chamber A full satisﬁes
X
n≥0
E[N]
n zn =
1
1 −
1Nz2
1 −2(N −1)z2
· · ·
=
1
2N
N
X
k=0
`N
k
´
1 −(N −2k)z .
This results from the EGF of Note II.11, the Continued Fraction Theorem, and basic properties
of the Laplace transform. (This continued fraction expansion is originally due to Stieltjes and
Rogers. See [245] for additional formulæ.)

V. 4. The supercritical sequence and its applications
This schema is combinatorially the simplest of all the ones treated in this chapter,
since it plainly deals with the sequence construction. An auxiliary analytic condition,
named “supercriticality” ensures that meromorphic asymptotics applies and entails
strong statistical regularities. This paradigm of supercritical sequences uniﬁes the as-
ymptotic properties of a number of seemingly different combinatorial types, including
integer compositions, surjections, and alignments.
V. 4.1. Combinatorial aspects. We consider a sequence construction, F = SEQ(G),
which may be taken in either the unlabelled or the labelled universe. In either case,
we have for the corresponding generating functions the relation
F(z) =
1
1 −G(z),
with as usual G(0) = 0. It will prove convenient to set
fn = [zn]F(z),
gn = [zn]G(z),
so that the number of Fn structures is fn in the unlabelled case and n!fn otherwise.
From Chapter III, the BGF of F-structures with u marking the number of G-
components is
(68)
F(z, u) =
1
1 −uG(z).
We also have access to the BGF of F with u marking the number of Gk-components:
(69)
F ⟨k⟩(z, u) =
1
1 −(G(z) + (u −1)gkzk).
V. 4.2. Analytic aspects. We restrict attention to the case where the radius of
convergence ρ of G(z) is nonzero, in which case, the radius of convergence of F(z)
is also nonzero by virtue of closure properties of analytic functions. Here is the basic
notion of this section.
Deﬁnition V.4. Let F, G be generating functions with nonnegative coefﬁcients that
are analytic at 0, with G(0) = 0. The analytic relation F(z) = (1 −G(z))−1 is said
to be supercritical if G(ρ) > 1, where ρ = ρG is the radius of convergence of G. A
combinatorial schema F = SEQ(G) is said to be supercritical if the relation F(z) =
(1 −G(z))−1 between the corresponding generating functions is supercritical.

314
V. APPLICATIONS OF RATIONAL AND MEROMORPHIC ASYMPTOTICS
Note that G(ρ) is well deﬁned in R ∪{+∞} as the limit limx→ρ−G(x) since
G(x) increases along the positive real axis, for x ∈(0, ρ). (The value G(ρ) corre-
sponds to what has been denoted earlier by τG when discussing “signatures” in Sec-
tion IV. 4, p. 236.) From now on we assume that G(z) is aperiodic in the sense that
there does not exist an integer d ≥2 such that G(z) = h(zd) for some h analytic at 0.
Put otherwise, the span of G(z) as deﬁned on p. 252 is equal to 1. (This condition
entails no loss of analytic generality.)
Theorem V.5 (Asymptotics of supercritical sequence). Let the schema F = SEQ(G)
be supercritical and assume that G(z) is aperiodic. Then, one has
[zn]F(z) =
1
σG′(σ) · σ−n (1 + O(An)) ,
where σ is the root in (0, ρG) of G(σ) = 1 and A is a number less than 1. The
number X of G–components in a random C–structure of size n has mean and variance
satisfying
En(X)
=
1
σG′(σ) · (n + 1) −1 + G′′(σ)
G′(σ)2 + O(An)
Vn(X)
=
σG′′(σ) + G′(σ) −σG′(σ)2
σ2G′(σ)3
· n + O(1).
In particular, the distribution of X on Fn is concentrated.
PROOF. See also [212, 443]. The basic observation is that G increases continuously
from G(0) = 0 to G(ρG) = τG (with τG > 1 by assumption) when x increases from
0 to ρG. Therefore, the positive number σ, which satisﬁes G(σ) = 1 is well deﬁned.
Then, F is analytic at all points of the interval (0, σ). The function G being analytic
at σ, satisﬁes, in a neighbourhood of σ
G(z) = 1 + G′(σ)(z −σ) + 1
2!G′′(σ)(z −σ)2 + · · · .
so that F(z) has a pole at z = σ; also, this pole is simple since G′(σ) > 0, by
positivity of the coefﬁcients of G. Pringsheim’s theorem then implies that the radius
of convergence of F must coincide with σ.
There remains to show that F(z) is meromorphic in a disc of some radius R > σ
with the point σ as the only singularity inside the disc. This results from the assump-
tion that G is aperiodic. In effect, by the Daffodil Lemma (Lemma IV.3, p. 253), one
has |G(σeiθ)| < 1 for all θ ̸≡0 (mod 2π) . Thus, by compactness, there exists a disc
of radius R > σ in which F is analytic except for a unique pole at σ. Take r such
that σ < r < R and apply the main theorem of meromorphic function asymptotics to
deduce the stated formula with A = σ/r.
Consider next the number of G-components in a random F structure of size n.
Bivariate generating functions give access to the expectation of this random variable:
En(X)
=
1
fn
[zn]
∂
∂u
1
1 −uG(z)

u=1
=
1
fn
[zn]
G(z)
(1 −G(z))2 .

V.4. SUPERCRITICAL SEQUENCE AND APPLICATIONS
315
The problem is now reduced to extracting coefﬁcients in a univariate generating func-
tion with a double pole at z = σ, and it sufﬁces to expand the GF locally at σ. The
variance calculation is similar though it involves a triple pole.
□
When a sequence construction is supercritical, the number of components is in
the mean of order n while its standard deviation is O(√n). Thus, the distribution is
concentrated (see Section III.2.2, p. 150). In fact, there results from a general theorem
of Bender [28] that the distribution of the number of components is asymptotically
Gaussian; see Chapter IX for details.
Proﬁles of supercritical sequences. We have seen in Chapter III that integer
compositions and integer partitions, when sampled at random, tend to assume rather
different aspects. Given a sequence construction, F = SEQ(G), the proﬁle of an
element α ∈F is the vector (X⟨1⟩, X⟨2⟩, . . .) where X⟨j⟩(α) is the number of G–
components in α that have size j. In the case of (unrestricted) integer compositions,
it could be proved elementarily that, on average and for size n, the number of 1 sum-
mands is ∼n/2, the number of 2 summands is ∼n/4, and so on. Now that mero-
morphic asymptotics is available, such a property can be placed in a much wider
perspective.
Theorem V.6 (Proﬁles of supercritical sequences). Consider a supercritical sequence
construction, F = SEQ(G), with the aperiodicity condition.
The number of G–
components of any ﬁxed size k in a random F–object of size n satisﬁes
(70)
En(X⟨k⟩) =
gkσk
σG′(σ)n + O(1),
Vn(X⟨k⟩) = O(n),
where σ in (0, σG) is such that G(σ) = 1, and gk = [zk]G(z).
PROOF. The bivariate GF with u marking the number of G–components of size k is
F(z, u) =
1
1 −(G(z) + (u −1)gkzk),
as results from the theory developed in Chapter III. The mean value is then given by a
quotient,
En(X⟨k⟩) = 1
fn
[zn] ∂
∂uF(z, u)

u=1
= 1
fn
[zn]
gkzk
(1 −G(z))2 .
The GF of cumulated values has a double pole at z = σ, and the estimate of the mean
value follows. The variance is estimated similarly, after two successive differentiations
and the analysis of a triple polar singularity.
□
The total number of components X satisﬁes X = P X⟨k⟩, and, by Theorem V.5,
its mean is asymptotic to n/(σG′(σ)). Thus, Equation (70) indicates that, at least
in some average-value sense, the “proportion” of components of size k amongst all
components is given by gkσk.
 V.23. Proportion of k–components and convergence in probability. For any ﬁxed k, the
random variable X⟨k⟩
n /Xn converges in probability to the value gkσk,
X⟨k⟩
n
Xn
P
−→gkσk,
i.e.,
lim
n→∞P
(
gkσk(1 −ǫ) ≤X⟨k⟩
n
Xn
≤gkσk(1 + ǫ)
)
= 1,

316
V. APPLICATIONS OF RATIONAL AND MEROMORPHIC ASYMPTOTICS
for any ǫ > 0. The proof is an easy consequence of the Chebyshev inequalities (the distributions
of Xn and X⟨k⟩
n
are both concentrated).

V. 4.3. Applications. We examine here two types of applications of the super-
critical sequence schema.
— Example 9 makes explicit the asymptotic enumeration and the analysis of
proﬁles of compositions, surjections and alignments. What stands out is the
way the mean proﬁle of a structure reﬂects the underlying inner construction
K in schemas of the form SEQ(K(Z)).
– Example 10 discusses compositions into restricted summands, including the
striking case of compositions into primes.
EXAMPLE V.9. Compositions, surjections, and alignments. The three classes of interest here
are integer compositions (C), surjections (R) and alignments (O), which are speciﬁed as
C = SEQ(SEQ≥1(Z)),
R = SEQ(SET≥1(Z)),
C = SEQ(CYC(Z))
and belong to either the labelled universe (C) or to the labelled universe (R and O). The
generating functions (of type OGF, EGF, and EGF, respectively) are
C(z) =
1
1 −
z
1−z
,
R(z) =
1
1 −(ez −1),
O(z) =
1
1 −log(1 −z)−1 .
A direct application of Theorem V.5 gives us the already known results
Cn = 2n−1,
1
n!Rn ∼1
2(log 2)−n−1,
1
n!On = e−1(1 −e−1)−n−1,
corresponding to σ equal to 1
2, log 2, and 1 −e−1, respectively.
Similarly, the expected number of summands in a random composition of the integer n
is ∼
n+1
2 . The expected cardinality of the range of a random surjection whose domain has
cardinality n is asymptotic to βn with β = 1/(2 log 2); The expected number of components
in a random alignment of size n is asymptotic to n/(e −1).
Theorem V.6 also applies and gives the mean number of components of size k in each case.
The following table summarizes the conclusions:
Structures
Specif.
Law (gkσk)
Type
σ
Compositions
SEQ(SEQ≥1(Z))
1
2k
Geometric
1
2
Surjections
SEQ(SET≥1(Z))
1
k!(log 2)k
Poisson
log 2
Alignments
SEQ(CYC(Z))
1
k (1 −e−1)k
Logarithmic
1 −e−1
Note that the stated laws necessitate k ≥1. The geometric and Poisson law are classical;
the logarithmic distribution (also called “logarithmic-series distribution”) of parameter λ is by
deﬁnition the law of a discrete random variable Y such that
P(Y = k) =
1
log(1 −λ)−1
λk
k ,
k ≥1.
The way the internal construction K in the schema SEQ(K(Z)) determines the law of compo-
nent sizes,
Sequence 7→Geometric;
Set 7→Poisson;
Cycle 7→Logarithmic,

V.4. SUPERCRITICAL SEQUENCE AND APPLICATIONS
317
FIGURE V.11. Proﬁle of structures drawn at random represented by the sizes of their
components in sorted order: (from left to right) a random surjection, alignment, and com-
position of size n = 100.
stands out. Figure 11 exempliﬁes the phenomenon by displaying components sorted by size and
represented by vertical segments of corresponding lengths for three randomly drawn objects of
size n = 100. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE V.9. □
EXAMPLE V.10.
Compositions with restricted summands, compositions into primes. Un-
restricted integer compositions are well understood as regards enumeration: their number is
exactly Cn = 2n−1, their OGF is C(z) = (1 −z)/(1 −2z), and compositions with k sum-
mands are enumerated by binomial coefﬁcients. Such simple exact formulæ disappear when
restricted compositions are considered, but, as we now show, asymptotics is much more robust
to changes in speciﬁcations.
Let S be a subset of the integers Z≥1 such that gcd(S) = 1, i.e., not all members of S
are multiples of a common divisor d ≥2. In order to avoid trivialities, we also assume that
S ̸= {1}. The class CS of compositions with summands constrained to the set S then satisﬁes:
Speciﬁcation:
CS = SEQ(SEQS(Z));
OGF:
CS(z) =
1
1 −S(z),
S(z) =
X
s∈S
zs.
By assumption, S(z) is aperiodic, so that Theorem V.5 applies directly. There is a well-deﬁned
number σ such that
S(σ) = 1,
0 < σ < 1,
and the number of S–restricted compositions satisﬁes
(71)
CS
n := [zn]CS(z) =
1
σS′(σ) · σ−n (1 + O(An)) .
Amongst the already discussed cases, S = {1, 2} gives rise to Fibonacci numbers and, more
generally, S = {1, . . . , r} corresponds to partitions with summands at most r. In this case, the
OGF,
C{1,...,r}(z) =
1
1 −z 1−zr
1−z
=
1 −z
1 −2z + zr+1
is a simple variant of the OGF associated to longest runs in strings. The treatment of the latter
can be copied almost verbatim to the effect that the largest component in a random composition
of n is found to be lg n + O(1), both on average and with high probability.

318
V. APPLICATIONS OF RATIONAL AND MEROMORPHIC ASYMPTOTICS
10
16 1 5
20
732 73 4
30
36039 360 57
40
1772207 17722 61
50
87109263 871092 48
60
4281550047 42815 49331
70
210444532770 21044453 0095
80
10343662267187 1034366226 5182
90
508406414757253 5084064147 81706
100
24988932929490838 24988932929 612479
FIGURE V.12. The pyramid relative to compositions into prime summands for n =
10 . . 100: (left: exact values; right: asymptotic formula rounded).
Here is a surprising application of the general theory. Consider the case where S is taken
to be the set of prime numbers, Prime = {2, 3, 5, 7, 11, . . .}, thereby deﬁning the class of
compositions into prime summands. The sequence starts as
1, 0, 1, 1, 1, 3, 2, 6, 6, 10, 16, 20, 35, 46, 72, 105,
corresponding to G(z) = z2 + z3 + z5 + · · · , and is EIS A023360 in Sloane’s encyclopedia.
The formula (71) provides the asymptotic form of the number of such compositions. It is also
worth noting that the constants appearing in (71) are easily determined to great accuracy, as we
now explain.
By (71) and the preceding equation, the dominant singularity of the OGF of compositions
into primes is the positive root σ < 1 of the characteristic equation
S(z) ≡
X
p Prime
zp = 1.
Fix a threshold value m0 (for instance m0 = 10 or 100) and introduce the two series
S−(z) :=
X
s∈S, s<m0
zs,
S+(z) :=
 
X
s∈S, s<m0
zs
!
+ zm0
1 −z .
Clearly, for x ∈(0, 1), one has S−(x) < S(x) < S+(x). Deﬁne then two constants σ−, σ+
by the conditions
S−(σ−) = 1,
S+(σ+) = 1,
0 < σ−, σ+ < 1.
These constants are algebraic numbers that are accessible to computation. At the same time,
they satisfy σ+ < σ < σ−. As the order of truncation, m0, increases, the values of σ+, σ−
provide better and better approximations to σ, together with an interval in which σ provably
lies. For instance, m0 = 10 is enough to determine that 0.66 < σ < 0.69, and the choice
m0 = 100 gives σ to 15 guaranteed digits of accuracy, namely, σ .= 0.67740 17761 30660.
Then, the asymptotic formula (71) instantiates as
(72)
CPrime
n
∼g(n),
g(n) := 0.30365 52633 · 1.47622 87836n.
The constant σ−1 .= 1.47622 is akin to the family of Backhouse constants described in [165].
Once more, the asymptotic approximation is very good as exempliﬁed by the pyramid of
Figure 12. The difference between CPrime
n
and its approximation g(n) from Eq. (72) is plotted
on the left of Figure 13. The seemingly haphazard oscillations that manifest themselves are well
explained by the principles discussed in Section IV. 6.1 (p. 250). It appears that the next poles

V.4. SUPERCRITICAL SEQUENCE AND APPLICATIONS
319
–120000
–100000
–80000
–60000
–40000
–20000
0
20000
40000
60000
80000
–120000
–100000
–80000
–60000
–40000
–20000
0
20000
40000
60000
80000
100000
FIGURE V.13. Errors in the approximation of the number of compositions into primes
for n = 70 . . 100: left, the values of CPrime
n
−g(n); right, the correction g2(n) arising
from the next two poles, which are complex conjugate and the continuous extrapolation of
this approximation.
of the OGF are complex conjugate and lie near −0.76 ± 0.44i, having modulus about 0.88.
The corresponding residues then jointly contribute a quantity of the form
g2(n) = c · An sin(ωn + ω0),
A .= 1.13290,
for some constants c, ω, ω0. Comparing the left and right parts of Figure 13, we see that this
next layer of poles explains quite well the residual error CPrime
n
−g(n).
Here is a ﬁnal example that demonstrates in a striking way the scope of the method. Deﬁne
the set Prime2 of “twinned primes” as the set of primes that belong to a twin prime pair, that is,
p ∈Prime2 if one of p−2, p+2 is prime. The set Prime2 starts as 3, 5, 7, 11, 13, 17, 19, 29, 31, . . .
(numbers like 23 or 37 are thus excluded). The asymptotic formula for the number of composi-
tions of the integer n into summands that are twinned primes, is
CPrime2
n
∼0.18937 · 1.29799n,
where the constants are found by methods analogous to the case of all primes. It is quite
remarkable that the constants involved are still computable real numbers (and of low complexity,
even), this despite the fact that it is not known whether the set of twinned primes is ﬁnite or
inﬁnite. Incidentally, a sequence that starts like CPrime2
n
,
1, 0, 0, 1, 0, 1, 1, 1, 2, 1, 3, 4, 3, 7, 7, 8, 14, 15, 21, 28, 33, 47, 58, . . .
and coincides till index 22 included (!), but not beyond, was encountered by P. A. MacMahon10,
as the authors discovered, much to their astonishment, from scanning Sloane’s Encyclopedia,
where it appears as EIS A002124.
. . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE V.10. □
10See “Properties of prime numbers deduced from the calculus of symmetric functions”, Proc. London
Math. Soc., 23 (1923), 290-316). MacMahon’s sequence corresponds to compositions into arbitrary odd
primes, and 23 is the ﬁrst such prime that is not twinned.

320
V. APPLICATIONS OF RATIONAL AND MEROMORPHIC ASYMPTOTICS
 V.24. Random generation of supercritical sequences. Let F = SEQ(G) be a supercritical
sequence scheme. Consider a sequence of i.i.d. (independently identically distributed) random
variables Y1, Y2, . . . each of them obeying the discrete law
P(Y = k) = gkσk,
k ≥1.
A sequence is said to be hitting n if Y1+· · ·+Yr = n for some r ≥1. The vector (Y1, . . . , Yr)
for a sequence conditioned to hit n has the same distribution as the sequence of the lengths of
components in a random F–object of size n.
For probabilists, this explains the shape of the formulæ in Theorem V.5, which resemble
renewal relations [161, Sec. XIII.10]. It also implies that, given a uniform random generator for
G–objects, one can generate a random F–object of size n in O(n) steps on average [139]. This
applies to surjections, alignments, and compositions in particular.

 V.25. Largest components in supercritical sequences. Let F = SEQ(G) be a supercritical
sequence. Assume that gk = [zk]G(z) satisﬁes the asymptotic “smoothness” condition
gk
∼
k→∞cρ−kkβ,
c, ρ ∈R>0, β ∈R.
Then the size L of the largest G component in a random F object satisﬁes, for size n,
EFn(X) =
1
log(ρ/σ) (log n + β log log n) + o(log log n).
This covers integer compositions (ρ = 1, β = 0) and alignments (ρ = 1, β = −1). [The anal-
ysis generalizes the case of longest runs in Example 2 and is based on similar principles. The
GF of F objects with L ≤m is F ⟨m⟩(z) =
“
1 −P
k≤m gkzk”−1
, according to Section III.7.
For m large enough, this has a dominant singularity which is a simple pole at σm such that
σm −σ ∼c1(σ/ρ)mmβ. There follows a double-exponential approximation
PFn(L ≤m) ≈exp
“
−c2nmβ(σ/ρ)m”
in the “central” region. See Gourdon’s study [246] for details.]

V. 5. Paths in graphs and automata
In this section, we develop the framework of paths in graphs: given a graph Γ,
a source node, and a destination node, the problem is to enumerate all paths from
the source to the destination. Nonnegative weights acting multiplicatively (probabil-
ities, multiplicities) may be attached to edges. Applications include the analysis of
walks in various types of graphs as well as languages described by ﬁnite automata.
Under a fundamental structural condition, known as irreducibility and correspond-
ing to strong-connectedness of the graph, generating functions of paths all have the
same dominant singularity, which is a simple pole. This essential property implies
simple exponential forms for the asymptotics of coefﬁcients (possibly tempered by
explicit congruence conditions in the periodic case). The corresponding results can
equivalently be formulated in terms of the set of eigenvalues (the spectrum) of the
corresponding adjacency matrix and are related to the classical Perron-Frobenius the-
ory of nonnegative matrices—under irreducibility, only the largest positive eigenvalue
matters asymptotically.

V.5. PATHS IN GRAPHS AND AUTOMATA
321
V. 5.1. Combinatorial aspects. A directed graph or digraph Γ is determined by
the pair (V, E) of its vertex set V and its edge set E ⊆V × V . Here, self loops
corresponding to edges of the form (v, v) are allowed. Given an edge, e = (a, b),
we denote its origin by orig(e) := a and its destination by destin(e) := b. For Γ a
digraph with vertex set identiﬁed to the set {1, . . . , m}, we allow each edge (a, b) to
be weighted by a quantity ga,b, which we may take as a formal indeterminate, and for
which allow ourselves to substitute positive weight values. The matrix G such that
(73)
Ga,b = ga,b if the edge (a, b) ∈Γ,
Ga,b = 0 otherwise,
is called the weighted adjacency matrix of the (weighted) graph Γ. The usual adja-
cency matrix of Γ is obtained by the substitution ga,b 7→0.
A path is a sequence of edges, ̟ = (e1, . . . , en), such that, for all j with 1 ≤
j < n, one has destin(ej) = orig(ej+1). The parameter n is called the length of the
path and we deﬁne: orig(̟) := orig(e1), destin(̟) := destin(en). A circuit is a
path whose origin and destination are the same vertex. Note that, with our deﬁnition,
a circuit has its origin that is distinguished. We do not identify here two circuits such
that one is obtained by circular permutation from the other and also refer to circuits
with such a root distinguished as rooted circuits.
From the standard deﬁnition of matrix products, the powers Gn have elements
that are path polynomials. More precisely, one has the simple but essential relation,
(74)
(G)n
i,j =
X
w∈F ⟨i,j⟩
n
w,
where F⟨i,j⟩
n
is the set of paths in Γ that connect i to j and have length n, and a path
w is identiﬁed with the monomial in indeterminates {gi,j} that represents multiplica-
tively the succession of its edges; for instance:
(G)3
i,j =
X
ν1=i,ν2,ν3,ν4=j
gν1,ν2gν2,ν3gν3,ν4.
In other words: powers of the matrix associated to a graph generate all paths in
graph, the weight of a path being the product of the weights of the individual edges
it comprises. (This fact probably constitutes the most basic result of algebraic graph
theory [53, p. 9].) One may then treat simultaneously all lengths of paths (and all
powers of matrices) by introducing the variable z to record length.
Proposition V.6. (i) Let Γ be a digraph and let G be the formal adjacency matrix
of Γ as given by (73). The OGF F ⟨i,j⟩(z) of the set of all paths from i to j in Γ, with
z marking length and ga,b the weight associated to edge (a, b), is the entry i, j of the
matrix (I −zG)−1, namely
(75)
F ⟨i,j⟩(z) =
 (I −zG)−1 
i,j = (−1)i+j ∆⟨i,j⟩(z)
∆(z)
,
where ∆(z) = det(I −zG) is the reciprocal polynomial of the characteristic poly-
nomial of G and ∆⟨j,i⟩(z) is the determinant of the minor of index j, i of I −zG.

322
V. APPLICATIONS OF RATIONAL AND MEROMORPHIC ASYMPTOTICS
(ii) The generating function of (rooted) circuits is expressible in terms of a loga-
rithmic derivative,
(76)
X
i
(F ⟨i,i⟩(z) −1) = −z ∆′(z)
∆(z) .
In this algebraic statement, if one takes the {ga,b} as formal indeterminates, then
F ⟨i,j⟩(z) is a multivariate GF of paths in z with the variable {ga,b} marking the num-
ber of occurrences of edge (a, b). The result specializes to the case where the ga,b are
assigned numerical values, in which case [zn]F ⟨i,j⟩(z) becomes the total weight of
paths of length n, which we also refer to as “number of paths” in the weighted graph.
PROOF. For the proof, it is convenient to assume that the quantities ga,b are assigned
arbitrary real numbers, so that usual matrix operations (triangularization, diagonaliza-
tion, and so on) can be easily applied. Since the properties expressed by the statement
are utimately equivalent to a collection of multivariate polynomial identities, their
general validity is implied by the fact that they hold for all real assignments of values.
Part (i) results from the fundamental equivalence between paths and matrix prod-
ucts (74), which implies
F ⟨i,j⟩(z) =
∞
X
n=0
zn (Gn)i,j =

(I −zG)−1
i,j ,
and from the cofactor formula of matrix inversion.
Part (ii) results from elementary properties of the matrix trace11 functional. With m
the dimension of G and {λ1, . . . , λm} the multiset of its eigenvalues, we have
(77)
m
X
i=1
F ⟨i,i⟩
n
= Tr Gn =
m
X
j=1
λn
j ,
where F ⟨i,j⟩
n
= [zn]F ⟨i,j⟩(z). Upon taking a generating function, there results that
(78)
m
X
i=1
∞
X
n=1
F ⟨i,i⟩
n
zn =
m
X
j=1
λjz
1 −λjz ,
which, up to a factor of −z, is none other than the logarithmic derivative of ∆(z). □
 V.26. Positivity of inverses of characteristic polynomials. Let G have nonnegative coefﬁ-
cients. Then, the rational function ZG(z) := 1/ det(I −zG) has nonnegative Taylor coef-
ﬁcients. More generally, if G = (ga,b) is a matrix in the formal indeterminates ga,b, then
[zn]ZG(z) is a polynomial in the ga,b with nonnegative coefﬁcients. (Hint: The proof proceeds
by integration from (76): we have, for 1/∆(z), the equivalent expressions
1
∆(z) ≡exp
„
−
Z z
0
∆′(t)
∆(t) dt
«
= exp
 Z z
0
m
X
i=1
(F ⟨i,i⟩(t) −1) dt
t
!
= exp
0
@X
n≥1
zn
n Tr Gn
1
A,
which ensure positivity of the coefﬁcients of ZG.)

11If H is an m × m matrix with multiset of eigenvalues {µ1, . . . , µm}, the trace is deﬁned by
Tr H := Pm
i=1(H)ii and, by triangularization (Jordan form), it satisﬁes Tr H = Pm
j=1 µj.

V.5. PATHS IN GRAPHS AND AUTOMATA
323
 V.27. MacMahon’s Master Theorem. Let J be the determinant
J(z1, . . . , zm) :=
˛˛˛˛˛˛˛˛
1 −z1g11
−z2g12
· · ·
−zmg1m
−z1g21
1 −z2g22
· · ·
−zmg2m
...
...
...
...
−zmgm1
−zmg2m
· · ·
1 −zmgmm
˛˛˛˛˛˛˛˛
.
MacMahon’s “Master Theorem” asserts the identity of coefﬁcients,
[zα1
1
· · · zαm
m ]
1
J(z1, . . . , zm) = [zα1
1
· · · zαm
m ]Y α1
1
· · · Y αm
m
,
where
Yj =
X
i
gijzj.
This result can be obtained by a simple change of variables in a multivariate Cauchy integral and
is related to multivariate Lagrange inversion [244, pp. 21–23]. Cartier and Foata [80] provide a
general combinatorial interpretation related to trace monoids of Note 6, p. 285.

 V.28. The Jacobi trace formula. Jacobi’s trace formula [244, p. 11] for square matrices is
(79)
det ◦exp(M) = exp ◦Tr(M)
or equivalently, with due care paid to determinations, log ◦det(M) = Tr ◦log(M)) which
generalizes the scalar identities eaeb = ea+b and log ab = log a + log b. (Hint: recycle the
computations of Note 26.)

 V.29. Fast computation of the characteristic polynomial. The following algorithm is due
to Leverrier (1811–1877), the astronomer and mathematician who, together with Adams, ﬁrst
predicted the position of the planet Neptune. Since, by (77) and (78), one has
X
n≥1
zn Tr Gn =
m
X
j=1
λz
1 −λjz ,
it is possible to deduce an algorithm that determines the characteristic polynomial of a matrix
of dimension m in O(m4) arithmetic operations. [Hint: computing the quantities Tr Gj for
j = 1, . . . , m is sufﬁcient and requires precisely m matrix multiplications.]

 V.30. The matrix tree theorem.
Let Γ be a directed graph without loops and associated
matrix G, with ga,b the weight of edge (a, b). The Laplacian matrix L[G] is deﬁned by
L[G]i,j = −gi,j + [[i = j]]δi,
where
δi :=
X
k
gi,k.
Let L1[G] be the matrix obtained by deleting the ﬁrst row and ﬁrst column of L[G]. Then, the
“tree polynomial”
T1[G] := det L1[G]
enumerates all (oriented) spanning trees of Γ rooted at node 1. [This classic result belongs to a
circle of ideas initiated by Kirchhoff, Sylvester, Borchardt and others in the 19th century. See,
e.g., the discussions by Knuth [306, p. 582–583] and Moon [364].]

Weighted graphs, word models, and ﬁnite automata. The numeric substitution
σ : ga,b 7→1 transforms the formal adjacency matrix G of Γ into the usual adjacency
matrix. In particular, the number of paths of length n is obtained, under this substitu-
tion, as [zn](1 −zG)−1. As already noted, it is possible to consider weighted graphs,
where the ga,b are assigned positive real-valued weights; with the weight of a path be-
ing deﬁned by the product of its edges weights. One ﬁnds that [zn](I −zG)−1 equals
the total weight of all paths of length n. If furthermore the assignment is made in
such a way that P
b ga,b = 1, for all a, then the matrix G, which is called a stochastic
matrix, can be interpreted as the transition matrix of a Markov chain. Naturally, the
formulae of Proposition V.6

324
V. APPLICATIONS OF RATIONAL AND MEROMORPHIC ASYMPTOTICS
Word problems corresponding to regular languages can be treated by the theory
of regular speciﬁcations whenever they have enough structure and an unambiguous
regular expression description is of tractable form. (This is the main theme that has
been pursued in Sections V. 2 and V. 3.) The dual point of view of automata theory
introduced in Section I. 4.2 (p. 52) proves useful whenever no such direct description
is in sight. Finite automata can resort to the theory of paths in graphs, so that Proposi-
tion V.6 is applicable to them. Indeed, the language L accepted by a ﬁnite automaton
A, with set of states Q, initial state q0, and Qf the set of ﬁnal states, decomposes as
L =
X
q∈Qf
F⟨q0,q,
where F⟨q0,q is the set of path from the initial state q0 to one of the ﬁnal state, q.
(The corresponding graph Γ is obtained from A by collapsing multiple edges between
any two vertices, i and j, into a single edge equipped with a weight that is the sum
of the weights of all the letters leading from i to j.) Proposition V.6 is then clearly
applicable.
Proﬁles. By proﬁle of a set of paths is meant here the collection of the m2 statis-
tics N = (N1,1, . . . , Nm,m) where Ni,j is the number of times the edge (i −→j) is
traversed. This notion is for instance consistent with the notion of proﬁle given earlier
for lattice paths in Section V. 3. It also contains the information regarding the letter
composition of words in a regular language and is thus compatible with the notion of
proﬁle introduced in Section V. 2.
Let Γ be a graph with edge (a, b) weighted by γa,b. Then, the BGF of paths with
u marking the number of times a particular edge (c, d) is traversed is in matrix form
(I −z eG)−1,
with
eG = G
h
ga,b 7→ga,bu[[(a,b)=(c,d)]]i
.
The entry (i, j) in this matrix gives the BGF of paths with origin i and destination j.
The GF of cumulated values (moments of order 1) is then obtained from there in the
usual way, by differentiation followed by the substitution u = 1. Higher moments are
similarly attainable by successive differentiations.
V. 5.2. Analytic aspects. In full generality, the components of a linear system
of equations may exhibit the whole variety of behaviours obtained for the OGFs of
regular languages in Section V. 2, p. 278. However, positivity coupled with some
simple ancillary conditions (irreducibility and aperiodicity deﬁned below) entails that
the GFs of interest closely resemble the extremely simple rational function,
1
1 −z/ρ ≡
1
1 −λ1z ,
where ρ is the dominant positive singularity and λ1 = 1/ρ is a well-characterized
eigenvalue of T . Accordingly, the asymptotic phenomena associated with such sys-
tems are highly predictable and coefﬁcients are of the pure exponential form c · ρ−n.
We propose to expose here the general theory and treat in the next section classical ap-
plications to statistics of paths in graphs and languages recognized by ﬁnite automata.

V.5. PATHS IN GRAPHS AND AUTOMATA
325
FIGURE V.14. Irreducibility conditions. Left: a strongly connected digraph. Right: a
weakly connected digraph that is not strongly connected is a collection of strongly con-
nected components linked by a directed acyclic graph.
Irreducibility and aperiodicity of matrices and graphs. From this point on in
this section, we consider matrices with nonnegative entries. Two notions are essential,
irreducibility and aperiodicity (the terms are borrowed from Markov chain theory and
matrix theory).
For A a scalar matrix of dimension m × m (with nonnegative entries), a crucial
rˆole is played by the dependency graph; this is the (directed) graph with vertex set
V = {1 . . m} and edge set containing the directed edge (a →b) iff Aa,b ̸= 0. The
reason for this terminology is the following: Let A represent the linear transformation
n
y⋆
i = P
j Ai,jyj
o
i; then, the fact that an entry Ai,j is nonzero means that y⋆
i depends
effectively on yj and is translated by the directed edge (i →j) in the dependency
graph.
Deﬁnition V.5. The nonnegative matrix A is called irreducible if its dependency graph
is strongly connected (i.e., any two vertices are connected by a directed path).
By considering only simple paths, it is then seen that irreducibility is equivalent
to the condition that (I +A)m has all its entries that are strictly positive. See Figure 14
for a graphical rendering of irreducibility and for the general structure of a (weakly
connected) digraph.
Deﬁnition V.6. A strongly connected digraph Γ is said to be periodic with parameter
d iff the vertex set V can be partitioned into d classes, V = V0 ∪· · · ∪Vd−1, in such a
way that any edge whose source is an element of a Vj has its destination in Vj+1 mod d.
The largest possible d is called the period. If no decomposition exists with d ≥2,
so that the period has the trivial value 1, then the graph and all the matrices that admit
it as their dependency graph are called aperiodic.
For instance, a directed 10-cycle is periodic with parameters d = 1, 2, 5, 10 and
the period is 10. Figure 15 illustrates the notion. Periodicity implies that the existence
of paths of length n between any two given nodes i, j is constrained by the congruence

326
V. APPLICATIONS OF RATIONAL AND MEROMORPHIC ASYMPTOTICS
V0
V1
V2
V3
FIGURE V.15. Periodicity notions: the overall structure of a periodic graph with d = 4
(left), an aperiodic graph (middle) and a periodic graph of period 2 (right).
class n mod d. Conversely, aperiodicity entails the existence, for all n sufﬁciently
large, of paths of length n connecting i, j.
From the deﬁnition, a matrix A with period d has, up to simultaneous permutation
of its rows and columns, a cyclic block structure










0
A0,1
0
· · ·
0
0
0
A1,2
· · ·
0
...
...
...
...
...
0
0
0
· · ·
Ad−2,d−1
Ad−1,0
0
0
· · ·
0










where the blocks Ai,i+1 are reﬂexes of the connectivity between Vi and Vi+1. In
the case of a period d, the matrix Ad admits a diagonal square block decomposition
where each of its diagonal block is aperiodic (and of a smaller dimension than the
original matrix). Then, the matrices Aνd can be analysed block by block, and the
analysis reduces to the aperiodic case. Similarly for powers Aνd+r for any ﬁxed r as
ν varies. In other words, the irreducible periodic case with period d ≥2 can always
be reduced to a collection of d irreducible aperiodic subproblems. For this reason, we
usually postulate in our statements both an irreducibility condition and an aperiodicity
condition.
 V.31. Sufﬁcient conditions for aperiodicity. Any one of the following conditions sufﬁces to
guarantee aperiodicity of the nonnegative matrix T:
(i)
T has (strictly) positive entries;
(ii)
some power T s has (strictly) positive entries;
(iii)
T is irreducible and at least one diagonal element of T is nonzero;
(iv)
T is irreducible and the dependency graph of T is such that there exist two circuits
(closed paths) that are of relatively prime lengths.
(Any such condition implies in turn the existence of a unique dominant eigenvalue of T, which
is simple, according to Theorem V.7 and Note 34 below.)

 V.32. Computability of the period. There exists a polynomial time algorithm that determines
the period of a matrix. (Hint: in order to verify that Γ is periodic with parameter d, develop a
breadth-ﬁrst search tree, label nodes by their level, and check that edges satisfy suitable con-
gruence conditions modulo d.)


V.5. PATHS IN GRAPHS AND AUTOMATA
327
Paths in strongly connected graphs. For analytic combinatorics, the importance
of irreducibility and aperiodicity conditions stems from the fact that they guarantee
uniqueness and simplicity of a dominant pole of path generating functions.
Theorem V.7 (Asymptotics of paths in graphs). Consider the matrix
F(z) = (I −zT )−1,
where T is a scalar nonnegative matrix, in particular, the adjacency matrix of a graph
Γ equipped with positive weights. Assume that T is irreducible. Then all entries
F ⟨i,j⟩(z) of F(z) have the same radius of convergence ρ, which can be deﬁned in two
equivalent ways:
(i) as ρ = λ−1
1
with λ1 the largest positive eigenvalue of T ;
(ii) as the smallest positive root of the determinantal equation: det(I−zT ) = 0.
Furthermore, the point ρ = λ−1
1
is a simple pole of each F ⟨i,j⟩(z).
If T is irreducible and aperiodic, then ρ = λ−1
1
is the unique dominant singularity
of each F ⟨i,j⟩(z), and
[zn]F ⟨i,j⟩(z) = ϕi.jλn
1 + O(Λn),
0 ≤Λ < λ1,
for computable constants ϕi,j > 0.
PROOF. The proof proceeds by stages, building up properties of the F ⟨i,j⟩by means
of the relations that bind them, with suitable exploitation of Proposition V.6, p. 321 in
conjunction with Pringsheim’s Theorem (p. 229). In Parts(i)–(v), we assume that the
matrix T is aperiodic. Periodicity is ﬁnally examined in Part (vi).
(i) All F ⟨i,j⟩have the same radius of convergence. Simple upper and lower
bounds show that each F ⟨i,j⟩has a ﬁnite nonzero radius of convergence ρi,j. By
Pringsheim’s Theorem, this ρi,j is necessarily a singularity of the function F ⟨i,j⟩.
Since each F ⟨i,j⟩is a rational function, it then has a pole at ρi,j, hence becomes inﬁ-
nite as z →ρi,j. Now, the matrix F satisﬁes the identities
(80)
F = I + zT F,
and
F = I + zFT.
Thus, given that T is irreducible, each F ⟨i,j⟩is positively linearly related to any other
F ⟨k,ℓ⟩. Thus, the F ⟨i,j⟩must all become inﬁnite as soon as one of them does. Conse-
quently, all the ρi,j are equal—we let ρ denote their common value.
(ii) All poles are of the same multiplicity. By a similar argument, we see that all
the F ⟨i,j⟩must have the same multiplicity κ of their common pole ρ, since otherwise,
one function would be of slower growth, and a contradiction would result with the
linear relations stemming from (80). We thus have, for some ϕi,j > 0:
F ⟨i,j⟩(z) ∼
z→ρ
ϕi,j
(1 −z/ρ)κ .
(iii) The common multiplicity of poles is κ = 1. This property results from
the expression of the GF of all rooted circuits (Proposition V.6, Part (ii)) in terms of a
logarithmic derivative, which has by construction only simple poles. Hence, a positive
linear combination of some of the F ⟨i,j⟩has only a simple pole, so that κ = 1 and
(81)
F ⟨i,j⟩(z) ∼
z→ρ
ϕi,j
1 −z/ρ.

328
V. APPLICATIONS OF RATIONAL AND MEROMORPHIC ASYMPTOTICS
Another consequence is that we have ρ = 1/λ1, where λ1 is an eigenvalue of matrix
T , which then satisﬁes the property that λ1 ≥|λ| for any eigenvalue λ of T : in matrix
theory terminology, such an eigenvalue is called “dominant”12.
(iv) There are positive dominant eigenvectors. From the relations (80) satisﬁed
by the F⟨i,j⟩(z) with j ﬁxed and from (81), one ﬁnds as z →ρ
(82)
ϕi,j
1 −z/ρ ∼ρ
X
k
ti,kϕk,j
1 −z/ρ,
where
T = (Ti,j).
This expresses the fact that the column vector (ϕ1,j, . . . , ϕm,j)t is a right eigenvector
corresponding to the eigenvalue λ1 = ρ−1. Similarly, for each ﬁxed i, the row vec-
tor (ϕi,1, . . . , ϕi,m) is found to be a left eigenvector. By Part (ii), these eigenvector
have all their components strictly positive.
(v) The eigenvalue λ1 is simple. This property is needed in order to identify the
ϕi,j coefﬁcients. We base our proof on the Jordan normal form and simple inequali-
ties.
Assume ﬁrst that there are two different Jordan blocks corresponding to the eigen-
value λ1. Then there exist two vectors, v = (v1, . . . , vm)t and w = (w1, . . . , wm)t,
such that
T v = λ1v,
T w = λ1w,
where we may assume that the eigenvector v has positive coordinates, given Part (iv).
Let j0 be an index such that
|wj0|
vj0
=
max
j=1 . . m
|wj|
vj
.
By possibly changing w to −w and by rescaling, we may freely assume that wj0 =
vj0. Also, since v and w are not collinear, there must exist j1 such that |wj1| < vj1.
In summary:
(83)
wj0 = vj0,
|wj1| < vj1,
∀j : |wj| ≤vj.
Consider ﬁnally the two relations T mv = λm
1 v and T mw = λm
1 w, and examine
consequences for the j0 components. One has
(84)
vj0 =
m
X
k=1
Uj0,kvk,
wj0 =
m
X
k=1
Uj0,kwk,
where each Uj,k, the (j, k) entry of T m, is positive, by the irreducibility and ape-
riodicity assumptions. But then, by the triangle inequality, there is a contradiction
between (84) and (83). Thus, there cannot be two distinct Jordan blocks correspond-
ing to λ1.
There only remains to exclude the existence of a Jordan block of dimension ≥2
associated to λ1. If such a Jordan block were present, there would exists a vector w
12In matrix theory, a dominant eigenvalue (λ1) is one that is largest in modulus, while, for an analytic
function, a dominant singularity (ρ) is one that is smallest in modulus. The two notions are reconciled by
the fact that here singularities are inverses of eigenvalues (ρ = 1/λ1).

V.5. PATHS IN GRAPHS AND AUTOMATA
329
such that
(85)

T v = λ1w
T w = λ1w + v
implying
T νmv = λνm
1
w,
T νmw = λνm
1
w + νmλνm−1
1
v.
By simple bounds obtained from comparing w to v componentwise, it is found that
the vector T νmw must have all its coordinates that are O(λνm
1
). Upon taking ν →∞,
a contradiction is reached with the last relation of (85), where the growth of these
coordinates is of the form νλνm
1
. Thus, a Jordan block of dimension ≥2 is also
excluded, and the eigenvalue λ1 is simple.
(vi) Aperiodicity of T is equivalent to the existence of a uniquely dominant eigen-
value. If λ1 uniquely dominates, meaning that λ1 > |λ| for all eigenvalues λ ̸= λ1,
then each F ⟨i,j⟩has a simple pole at ρ that is its unique dominant singularity. Hence
the coefﬁcients [zn]F ⟨i,j⟩(z) are nonzero for n large enough, since they are asymp-
totic to ϕi,jρ−n by (81). This last property ensures aperiodicity.
Conversely, if T is aperiodic, then λ1 uniquely dominates. Indeed, suppose that
µ be an eigenvalue of T such that |µ| = λ1, with w a corresponding eigenvector. We
would have T mv = λm
1 v and T mw = µmw. But then, by an argument similar to the
one used in Part (v), upon making use of inequalities (83), we would need to have w
and v collinear, which is absurd.
We leave it as an exercise to the reader to verify the stronger property that identi-
ﬁes the period with the number of dominant eigenvalues: see Note 33.
□
Several of these arguments will inspire the discussion, in Chapter VII, of the
harder problem of analysing coefﬁcients of algebraic functions deﬁned by positive
polynomial systems (Subsection VII. 6.3, p. 464).
 V.33. Periodicities. If T has period d, then the support of each F ⟨j,j⟩(z) is included in dZ,
hence there are at least d conjugate singularities, corresponding to eigenvalues of the form
λ1e2ikπ/d. There are no other eigenvalues since T d is built out of irreducible blocks, each with
the unique dominant eigenvalue λd
1.

 V.34. The classical Perron-Frobenius Theorem. The proof of Theorem V.7 immediately
gives:
Theorem. Let A be a matrix with nonnegative elements that is assumed to be irreducible.
The eigenvalues of A can be ordered in such a way that
λ1 = |λ2| = · · · = |λd| > |λd+1| ≥|λd+2| ≥· · · ,
and all the eigenvalues of largest modulus are simple. Furthermore, the quantity d is precisely
equal to the period of the dependency graph. In particular, in the aperiodic case d = 1, there
is unicity of the dominant eigenvalue. In the periodic case d ≥2, the whole spectrum has a
rotational symmetry: it is invariant under the set of transformations
λ 7→λe2ijπ/d,
j = 0, 1, . . . , d −1.
The properties of positive and of nonnegative matrices have been superbly elicited by Per-
ron [392] in 1907 and by Frobenius [222] in 1908–1912. The corresponding theory has far-
reaching implications: it lies at the basis of the theory of ﬁnite Markov chains and it extends
to positive operators in inﬁnite-dimensional spaces [318].
Excellent treatments of Perron-
Frobenius theory are to be found in the books of Bellman [26, Ch. 16], Gantmacher [225,
Ch. 13], as well as Karlin and Taylor [290, p. 536–551].

 V.35. Unrooted circuits.
Consider a strongly connected weighted graph Γ with adjacency
matrix G = (gi,j). Let RC be the class of all rooted circuits and PRC the subclass of those
that are primitive (i.e., they differ from all their cyclic shifts). Let also UC be the class of all

330
V. APPLICATIONS OF RATIONAL AND MEROMORPHIC ASYMPTOTICS
unrooted circuits (no origin distinguished) and PUC the subclass of those that are primitive.
Deﬁne the adjacency matrix G⊙s := ((gi,j)s) obtained by raising each entry of G to the sth
power. Set ﬁnally ∆G(z) := det(I −zG). We ﬁnd
8
>
>
<
>
>
:
RC(z, G)
=
X
k≥1
PRC(zk, G⊙k),
PUC(z, G)
=
Z z
0
PRC(t, G) dt
t ,
UC(z, G)
=
X
k≥1
PUC(zk, G⊙k),
upon mimicking the reasoning of APPENDIX A: Cycle construction, p. 674. This results in
UC(z) =
X
k≥1
ϕ(k)
k
log ∆G⊙k(z),
[zn]UC(z) = λn
1
n + O(Λn),
[zn]PUC(z) = λn
1
n + O(Λn),
where the two asymptotic estimates hold under irreducibility and aperiodicity conditions. These
estimates can be regarded as a Prime Number Theorem for walks in graphs. (See [450] for
related facts and zeta functions of graphs.)

Proﬁles. The proof of Theorem V.7 provides the form of a certain “residue ma-
trix”, from which several probabilistic properties of paths follow.
Lemma V.1 (Iteration of irreducible matrices). Let the nonnegative matrix T be ir-
reducible and aperiodic, with λ1 its dominant eigenvalue. Then the residue matrix Φ
such that
(86)
(I −zT )−1 =
Φ
1 −zλ1
+ O(1)
(z →λ−1
1 )
has entries given by (⟨x, y⟩represents the scalar product P
i xiyi)
ϕi,j = riℓj
⟨r, ℓ⟩,
where r and ℓare respectively right and left eigenvectors of T corresponding to the
eigenvalue λ1.
PROOF. We have seen that the matrix Φ = (ϕi,j) has its rows and columns respec-
tively proportional to right and left eigenvectors belonging to the eigenvalue λ1. Thus,
we have
ϕi,j
ϕ1,j
= ϕi,1
ϕ1,1
,
while the ϕ1,j (respectively, ϕi,1) are the coordinates of a left (respectively, right)
eigenvector. There results that there exists a normalization constant ξ such that
ϕi,j = ξriℓj.
That normalization constant is then determined by the fact that GF of circuits has
residue equal to ρ = λ−1
1
at z = ρ, so that P
i ϕj,j = 1, leading to
1 = ξ
X
j
rjℓj,
which implies the statement.
□
Equipped with the lemma, we can now state:

V.5. PATHS IN GRAPHS AND AUTOMATA
331
Theorem V.8 (Proﬁles of paths in graphs). Let G be a nonnegative matrix associ-
ated to a weighted digraph Γ, assumed to be irreducible and aperiodic. Let ℓ, r be
respectively the left and right eigenvectors corresponding to the dominant (Perron-
Frobenius) eigenvalue λ1. Consider the collection F⟨a,b⟩of (weighted) paths in Γ
with ﬁxed origin a and ﬁnal destination b. Then, the number of traversals of edge
(s, t) in a random element of F⟨a,b⟩
n
has mean
(87)
τs,tn + O(1)
where
τs,t := ℓsgs,trt
⟨ℓ, r⟩.
In other words, a long random path tends to spend asymptotically a ﬁxed (nonzero)
fraction of its time traversing any given edge. Accordingly, the number of visits to
vertex s is also proportional to n and obtained by summing the expression of (87)
according to all the possible values of t.
PROOF. First, the total weight (“number”) of paths in Fa,b satisﬁes
(88)
[zn]

(I −zG)−1
a,b ∼raℓb
⟨ℓ, r⟩,
as follows from Lemma V.1. Next, introduce the modiﬁed matrix H = (hi,j) deﬁned
by
hi,j = gi,j u[[i=s∧j=t]].
In other words, we mark each traversal of edge i, j by the variable u. Then, the
quantity
(89)
[zn]
 ∂
∂u(I −zH)−1

u=1

a,b
represents the total number of traversals of edge (s, t), with weights taken into ac-
count. Simple algebra13 shows that
(90)
∂
∂u(I −zH)−1

u=1
= (I −zG)−1 (zH′) (I −zG),
where H′ := (∂uH)u=1 has all its entries equal to 0, except for the s, t entry whose
value is gs,t. By the calculation of the residue matrix in Lemma V.1, the coefﬁcient
of (89) is then asymptotic to
(91)
[zn]
ϕa,s
1 −λ1z gs,tz
ϕt,b
1 −λ1z ∼υnλn
1 ,
υ := raℓsgs,trtℓb
⟨ℓ, r⟩2
.
Comparison of (91) and (88) ﬁnally yields the result since the relative error terms are
O(n−1) in each case.
□
Another consequence of this last proof and Equation (88) is that the numbers of
paths starting at a and ending at either b or c satisfy
(92)
lim
n→∞
F ⟨a,b⟩
n
F ⟨a,c⟩
n
= ℓb
ℓc
.
13If A is an operator depending on u, one has ∂u(A−1) = −A−1(∂uA)A−1, which is a noncom-
mutative generalization of the usual differentiation rule for inverses.

332
V. APPLICATIONS OF RATIONAL AND MEROMORPHIC ASYMPTOTICS
In other words, the quantity
ℓb
P
j ℓj
is the asymptotic probability that a random path with origin ﬁxed at some point a but
otherwise unconstrained will end up at point b after a large number of steps. Such
properties are strongly evocative of Markov chain theory discussed below in Exam-
ple 13.
 V.36. Residues and projections. Let E = Cm be the ambient space, where m is the dimen-
sion of T, assumed to be irreducible and aperiodic. There exists a direct sum decomposition
E = F1 + F2 where F1 is the 1-dimensional eigenspace generated by the eigenvector (r)
corresponding to eigenvalue λ1 and F2 is the supplementary space which is the direct sum of
characteristic spaces corresponding to the other eigenvalues λ2, . . . . (For the purposes of the
present discussion, one may freely think of the matrix as diagonalizable, with F2 the union of
eigenspaces associated to λ2, . . . .) Then T as a linear operator acting on F admits the decom-
position
T = λ1P + S,
where P is the projector on F1 and S acts on F2 with spectral radius |λ2|, as illustrated by the
diagram:
(93)
O
⃗v
P⃗v
(r)
F2
S⃗v
By standard properties of projections, P 2 = P and PS = SP = 0 so that T n = λn
1 P + Sn.
Consequently, there holds,
(94)
(I −zT)−1 =
X
n≥0
(znλn
1 P + znSn) =
P
1 −λ1z + (I −zS)−1.
Thus, the residue matrix Φ coincides with the projector P.
From there, one ﬁnds also
(95)
(I −zT)−1 =
Φ
1 −λ1z +
X
k≥0
Rk
`
z −λ−1
1
´k ,
Rk := Sk(I −λ−1
1 S)−k−1,
which provides a full expansion.

 V.37. Algebraicity of the residues. One only needs to solve one polynomial equation in order
to determine λ1. Then the entries of Φ and the Rk in (95) are all obtained by rational operations
in the ﬁeld generated by the entries of T extended by the algebraic quantity λ1: for instance, in
order to get an eigenvector, it sufﬁces to replace one of the equations of the system Tr = λ1r
by a normalization condition, like r1 + · · · + rm = 1. (Numerical procedures are likely to be
used instead for large matrices.)

Automata and words. By proposition V.6 (p. 321), the OGF of the language de-
ﬁned by a deterministic ﬁnite automaton is expressible in terms of the quasi-inverse
(1 −zT )−1, where the matrix T is a direct encoding of the automaton’s transitions.
Corollary V.7 and Lemma V.1 have been precisely custom-tailored for this situation.
As is by now usual, we shall allow weights on letters of the alphabet, corresponding to
a Bernoulli model on words. We say that an automaton is irreducible (resp. aperiodic)
if the underlying graph and the associated matrix are irreducible (resp. aperiodic).

V.5. PATHS IN GRAPHS AND AUTOMATA
333
Proposition V.7 (Random words and automata). Let L be a language recognized by
a deterministic ﬁnite automaton A whose graph is irreducible and aperiodic. The
number of words of L satisﬁes
Ln ∼cλn
1 + O(Λn),
where λ1 is the dominant (Perron-Frobenius) eigenvalue of the transition matrix of A
and c, Λ are real constants with c > 0 and 0 ≤Λ < λ1.
In a random word of Ln, the number of traversals of a designated vertex or edge
has a mean that is asymptotically linear in n and is given by Theorem V.8.
 V.38. Unambiguous automata. A nondeterministic ﬁnite state automaton is said to be un-
ambiguous if the set of accepting paths for any given words comprises at most one element.
The translation into generating function as described above also applies to such automata, even
though they are nondeterministic.

 V.39. Concentration of distribution for the number of passages. Under the conditions of
the theorem, the standard deviation of the number of traversals of a designated node or edge
is O(√n). Thus in a random long path, the distribution of the number of such traversals is
concentrated. [Compared to (90), the calculation of the second moment requires taking a further
derivative, which leads to a triple pole. The second moment and the square of the mean, which
are each O(n2), are then found to cancel to main asymptotic order.]

V. 5.3. Applications. We now provide a few application of Theorems V.7 and V.8.
— First, two simple applications are discussed. Example 11 studies brieﬂy the
case of words that are locally constrained in the sense that certain transitions
between letters are forbidden. Example 12 revisits walks on an interval and
develops an alternative matrix view of a problem otherwise amenable to
continued fraction theory.
— Example 13 makes explicit the way the fundamental theorem of ﬁnite Markov
chain theory can be derived effortlessly as a consequence of the more gen-
eral Theorem V.8. Example 14 compares on a simple problem, the devil’s
staircase, the combinatorial and the Markovian approaches.
— Example 15 comes back to words and develops simple consequence of an
important combinatorial construction, that of De Bruijn graphs. This graph
is precious in predicting in many cases the shape of the asymptotic results
that are to be expected when confronted with word problems. Example 16
concludes this section with a brief discussion of special case of words with
excluded patterns, thereby leading to a quantitative version of Borges’ The-
orem (Note I.32, p. 58).
In all these examples, the counting estimates are of the form cλn
1 , while the expecta-
tions of parameters of interest have a linear growth.
EXAMPLE V.11.
Locally constrained words. Consider a ﬁxed alphabet A = {a1, . . . , am}
and a set F ⊆A2 of forbidden transitions between consecutive letters. The set of words
over A with no such forbidden transition is denoted by L and is called a locally constrained
language. (The particular case where exactly all pairs of equal letters are forbidden corresponds
to Smirnov words and has been discussed on p. 249.)

334
V. APPLICATIONS OF RATIONAL AND MEROMORPHIC ASYMPTOTICS
0
@
1 1 0 0
1 0 1 1
1 0 0 0
0 0 1 1
1
A
a
b
a
a
b
a
d
c
d
c
c
d
FIGURE V.16. Locally constrained words: The transition matrix (T) associated to the
forbidden pairs F = {ac, ad, bb, cb, cc, cd, da, db}, the corresponding automaton, and the
graph with widths of vertices and edges drawn in proportion to their asymptotic frequen-
cies.
Clearly, the words of L are recognized by an automaton whose state space is isomorphic
to A: state q simply memorizes the fact that the last letter read was a q. The graph of the au-
tomaton is then obtained by the collection of allowed transitions (q, r) 7→a, with (q, r) ̸∈F.
(In other word, the graph of the automaton is the complete graph in which all edges that corre-
spond to forbidden transitions are deleted.) Consequently, the OGF of any locally constrained
language is a rational function. Its OGF is given by
(1, 1, . . . , 1)(I −zT)−1(1, 1, . . . , 1)t,
where Tij is 0 if (ai, aj) ∈F and 1 otherwise. If each letter can follow any other letter in an
accepted word, the automaton is irreducible. The graph is aperiodic except in a few degenerate
cases (e.g., in the case where the allowed transitions would be a →b, c, b →d, c →d, d →a).
Under irreducibility and aperiodicity, the number of words will be ∼cλn
1 and each letter will
have on average an asymptotic constant frequency. (See (34) and (35) of Chapter IV for the
case of Smirnov words.)
For the example of Figure 16, the alphabet is A = {a, b, c, d}. There are eight forbidden
transitions and the characteristic polynomial χG(λ) := det(λI −G) is found to be λ3(λ−2).
Thus, one has λ1 = 2. The right and left eigenvectors are found to be
r = (2, 2, 1, 1)t,
ℓ= (2, 1, 1, 1).
Then, the matrix τ, where τs,t represents the asymptotic frequency of transitions from letter s
to letter t, is found in accordance with Theorem V.8:
τ =
0
B
B
@
1
4
1
4
0
0
1
8
0
1
16
1
16
1
8
0
0
0
0
0
1
16
1
16
1
C
C
A .
This means that a random path spends a proportion equal to 1
4 of its time on a transition between
an a and a b, but much less ( 1
16) on transitions between pairs of letters bc, bd, cc, ca. The letter
frequencies in a random word of L are ( 1
2, 1
4, 1
8, 1
8), so that an a is four times more frequent
than a c or a d, and so on. See Figure 16 (right) for a rendering.
Various specializations, including multivariate GF’s and nonuniform letter models are
readily treated by this method. Bertoni et al. develop in [49] related variance and distribu-
tion calculations in the case of the number of occurrences of a symbol in an arbitrary regular
language. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE V.11. □

V.5. PATHS IN GRAPHS AND AUTOMATA
335
EXAMPLE V.12.
Walks on the interval revisited. As a direct illustration, consider the walks
associated to the graph Γ(5) with vertex set 1, . . . , 5 and edges being formed of all pairs (i, j)
such that |i −j| ≤1. The matrix is
G(5) =
0
B
@
1 1 0 0 0
1 1 1 0 0
0 1 1 1 0
0 0 1 1 1
0 0 0 1 1
1
C
A.
The characteristic polynomial χG(z) := det(zI −G) factorizes as
χG(5)(z) = z(z −1)(z −2)(z2 −2z −2),
and its dominant root is λ1 = 1 +
√
3. From there, one ﬁnds a left eigenvector (which is also a
right eigenvector since the matrix is symmetric):
r = ℓt = (1,
√
3, 2,
√
3, 1).
Thus a random path (with the uniform distribution over all paths corresponding to the weights
being equal to 1) visits nodes 1, . . . , 5 with frequencies proportional to
1,
1.732,
2,
1.732,
1,
implying that the non-extremal nodes are visited more often—such nodes have higher degrees
of freedom, so that there tend to be more paths that traverse them.
In fact, this example has structure. For instance, the graph Γ(11) deﬁned by an interval of
length 10, leads to a matrix with a highly factorable characteristic polynomial
χG(11) = z (z −1) (z −2)
`
z2 −2 z −2
´ `
z2 −2 z −1
´ `
z4 −4 z3 + 2 z2 + 4 z −2
´
.
The reader may have recognized a particular case of lattice paths which resort to the theory
exposed in Section V. 3. Indeed, according to Proposition V.3, the OGF of paths from vertex 1
to vertex 1 in the graph Γ(k) with vertex set {1, . . . , k} is given by the continued fraction
1
1 −z −
z2
1 −z −
z2
...
1 −z −
z2
1 −z
.
(The number of fraction bars is k.) From this it can be shown that the characteristic polynomial
of G is an elementary variant of the Fibonacci–Chebyshev polynomial of Example 6, p. 303.
The analysis based on Theorem V.8 is simpler, albeit more rudimentary, as it only provides a
ﬁrst-order asymptotic solution to the problem.
This example is typical: in many cases combinatorial problems have some amount of
regularity. In such situations, all the resources of linear algebra are available, including the
vast body of knowledge gathered over years on calculations of structured determinants; see for
instance Krattenthaler’s survey [319] and the book [483]. . . . . . . . END OF EXAMPLE V.12. □
EXAMPLE V.13. Elementary theory of ﬁnite Markov chains. Consider the case where the row
sums of matrix G are all equal to 1, that is, P
j gi,j = 1. Such a matrix is called a stochastic
matrix. The quantity gi,j can then be interpreted as the probability of leaving state i for state j,
assuming one is in state i. Assume that the matrix G is irreducible and aperiodic. Clearly, the
matrix G admits the column vector r = (1, 1, . . . , 1)t as a right eigenvector corresponding to

336
V. APPLICATIONS OF RATIONAL AND MEROMORPHIC ASYMPTOTICS
G =
0
B
B
@
1 1 0 0 0 0
1 0 1 0 0 0
1 0 0 1 0 0
1 0 0 0 1 0
1 0 0 0 0 1
1 0 0 0 0 0
1
C
C
A
eG =
0
B
B
B
B
B
@
1
2
1
2 0 0 0 0
1
2 0
1
2 0 0 0
1
2 0 0
1
2 0 0
1
2 0 0 0
1
2 0
1
2 0 0 0 0
1
2
1 0 0 0 0 0
1
C
C
C
C
C
A
FIGURE V.17. The devil’s staircase (m = 6) and the two matrices that can model it.
the dominant eigenvalue λ1 = 1. The left eigenvector ℓnormalized so that its elements sum
to 1 is called the (row) vector of stationary probabilities. It must be calculated by linear algebra
and its detrmination involves ﬁnding an element of the kernel of matrix I −G, which can be
done in a standard way.
Application of Theorem V.8 and Equation (88) shows immediately the following:
Proposition V.8 (Stationary probabilities of Markov chains). Consider a weighted graph cor-
responding to a stochastic matrix G which is irreducible and aperiodic. Let ℓbe the normalized
left eigenvector corresponding to the eigenvalue 1. A random (weighted) path of length n with
ﬁxed origin and destination visits node s a mean number of times asymptotic to ℓsn and tra-
verses edge (s, t) a mean number of times asymptotic to ℓsgs,tn. A random path of length n
with ﬁxed origin ends at vertex s with probability asymptotic to ℓs.
The vector ℓis also known as the vector of stationary probabilities. The ﬁrst-order asymp-
totic property expressed by Proposition V.8 certainly constitutes the most fundamental result in
the theory of ﬁnite Markov chains. . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE V.13. □
EXAMPLE V.14.
The devil’s staircase.
This example illustrates an elementary technique
often employed in calculations of eigenvalues and eigenvectors. It presupposes that the matrix
to be analysed can be reduced to a sparse form and has a regular enough structure.
You live in a house that has a staircase with m steps. You come back home a bit loaded
and at each second, you can either succeed in climbing a step or fall back all the way down. On
the last step, you always stumble and fall back down (Figure 17). Where are you likely to be
found at time n?
Precisely, two slightly different models correspond to this informally stated problem. The
probabilistic model views it as a Markov chain with equally likely possibilities at each step
and is reﬂected by matrix eG in Figure 17. The combinatorial model just assumes all possible
evolutions (“histories”) of the system as equally likely and it corresponds to matrix G. We opt
here for the latter, keeping in mind that the same method basically applies to both cases.
We ﬁrst write down the constraints expressing the joint properties of an eigenvalue λ and
its right eigenvector x = (x1, . . . , xm)t. The equations corresponding to (λI −G)x = 0 are
formed of a ﬁrst batch of m −1 relations,
(96)
(λ −1)x1 −x2 = 0,
−x1 + λx2 −x3 = 0,
· · · , −x1 + λxm−1 −xm = 0,
together with the additional relation (one cannot go higher than the last step):
(97)
−x1 + λxm = 0.

V.5. PATHS IN GRAPHS AND AUTOMATA
337
The solution to (96) is readily found by pulling out successively x2, . . . , xm as functions of x1:
(98) x2 = (λ−1)x1,
x3 = (λ2 −λ−1)x1,
· · · ,
xm = (λm−1 −λm−2 −· · ·−1)x1.
Combined with the special relation (97), this last relation shows that λ must satisfy the equation
(99)
1 −2λm + λm+1 = 0.
Let λ1 be the largest positive root of this equation, existence and dominance being guaranteed
by Perron-Frobenius properties. Note that the quantity ρ := 1/λ1 satisﬁes the characteristic
equation
1 −2ρ + ρm+1 = 0,
already encountered when discussing longest runs in words; the discussion of Example 2 then
grants us the existence of an isolated ρ near 1
2, hence the fact that λ1 is slightly less than 2.
Similar devices yield the left eigenvector y = (y1, . . . , ym). It is found easily that yj must
be proportional to λ−j
1 . We thus obtain from Theorem V.8 and Equation (92): The probability
of being in state j (i.e., being on step j of the stair) at time n tends to the limit
̟j = γλ−j
1
where λ1 is the root near 2 of the polynomial (99) and the normalization constant γ is deter-
mined by P
j ̟j = 1. In other words, the distribution of the altitude at time n is a truncated
geometric distribution with parameter 1/λ1. For instance, m = 6 leads to λ1 = 1.98358, and
the asymptotic probabilities of being in states 1, . . . , 6 are
(100)
0.50413,
0.25415,
0.12812,
0.06459,
0.03256,
0.01641,
exhibiting a clear geometric decay. Here is the simulation of a random trajectory for n = 100:
5
0
20
40
60
80
100
In this case, the frequencies observed are 0.44, 0.26, 0.17, 0.08, 0.04, 0.01, pretty much in
agreement with what is expected.
Finally, the similarity with the longest run problem is easily explained. Let u and d be
letters representing steps upwards and downwards respectively. The set of paths from state 1 to
state 1 is described by the regular expression
P1,1 =
`
d + ud + · · · + um−1d
´⋆,
corresponding to the generating function
P1,1(z) =
1
1 −z −z2 −· · · −zm ,
a variant of the OGF of words without m-runs of the letter u, which also corresponds to the
enumeration of compositions with summands ≤m. The case of the probabilistic transition
matrix eG is left as an exercise to the reader.
. . . . . . . . . . . . . . . . . . END OF EXAMPLE V.14. □
EXAMPLE V.15. De Bruijn graphs. Two thieves want to break into a house whose entrance is
protected by digital lock with an unknown four-digit code. As soon as the four digits of the code
are typed consecutively, the gate opens. The ﬁrst thief proposes to try in order all the four-digit
sequences, resulting in as much as 40,000 key strokes in the worst-case. The second thief, who
is a mathematician, says he can try all four-digit combinations with only 10,003 key strokes.
What is the mathematician’s trade secret?

338
V. APPLICATIONS OF RATIONAL AND MEROMORPHIC ASYMPTOTICS
000
001
010
011
100
101
110
111
1
0
1
1
0
0
1
0
1
1
0
1
0
0
1
0
FIGURE V.18. The de Bruijn graph: (left) ℓ= 3; (right) ℓ= 7.
Clearly certain optimizations are possible: for instance, for an alphabet of cardinality 2
and codes of 2 letters, the sequence 00110 is better than the na¨ıve one, 00 01 10 11, which
is redundant; a few more attempts will lead to an optimal solution for 3–digit codes that has
length 10 (rather than 24), for instance,
0001110100.
The general question is then: How far can one go and how to construct such sequences?
Fix an alphabet of cardinality m. A sequence that contains as factors (contiguous blocks)
all the k letter words is called a de Bruijn sequence.
Clearly, its length must be at least
δ(m, k) = mk + k −1, as it must have at least mk positions at distance at least k −1 from the
end. A sequence of smallest possible length δ(m, k) is called a minimal de Bruijn sequence.
Such sequences were discovered by N. G. de Bruijn [109] in 1946, in response to a question
coming from electrical engineering, where all possible reactions of a device presented as a black
box must be tested at minimal cost. We shall expose here the case of a binary alphabet, m = 2,
the generalization to m > 2 being obvious.
Let ℓ= k−1 and consider the automaton Bℓthat memorizes the last block of length ℓread
when scanning the input text from left to right. A state is thus assimilated to a string of length ℓ
and the total number of states is 2ℓ. The transitions are easily calculated: let q ∈{0, 1}ℓbe
a state and let σ(w) be the function that shifts all letters of a word w one position to the left,
dropping the ﬁrst letter of w in the process (thus σ maps {0, 1}ℓto {0, 1}ℓ−1); the transitions
are
q
07→σ(q)0,
q
17→σ(q)1.
If one further interprets a state q as the integer in the interval [0 . . 2ℓ−1] that it represents, then
the transition matrix assumes a remarkably simple form:
Ti,j = [[(j ≡2i mod 2ℓ) or (j ≡2i + 1 mod 2ℓ)]].
See Figure 18 for a rendering borrowed from [215].
Combinatorially, the de Bruijn graph is such that each node has indegree 2 and outdegree 2.
By a well known theorem going back to Euler: A necessary and sufﬁcient condition for an
undirected connected graph to have an Eulerian circuit (that is, a closed path that traverses
each vertex exactly once) is that every node has even degree. For a strongly connected digraph,
the condition is that each node has an outdegree equal to its indegree. This last condition is
obviously satisﬁed here. Take an Eulerian circuit starting and ending at node 0ℓ; its length is

V.5. PATHS IN GRAPHS AND AUTOMATA
339
2ℓ+1 = 2k. Then, clearly, the sequence of edge labels encountered when preﬁxed with the word
0k−1 = 0ℓconstitutes a minimal de Bruijn sequence. In general, the argument gives a de Brujin
sequence with minimal length mk +k−1. Et voil`a! The trade secret of the thief-mathematician
is exposed.
Back to enumeration. The de Bruijn matrix is irreducible since a path labelled by sufﬁ-
ciently many zeros always leads any state to the state 0ℓ, while a path ending with the letters
of w ∈{0, 1}ℓleads to state w. The matrix is aperiodic since it has a loop on states 0ℓand 1ℓ.
Thus, by Perron Frobenius properties, it has a unique dominant eigenvalue, and it is not hard to
check that its value is λ1 = 2, corresponding to the right eigenvector (1, 1, . . . , 1)t. If one ﬁxes
a pattern w ∈{0, 1}ℓ, Theorem V.8 yields back the known fact that a random word contains
on average ∼
n
2ℓoccurrences of pattern w, while Note 39 further implies that the distribution
of the number of occurrences is concentrated around the mean, as the variance is O(n). The
de Bruijn graph may be used to quantify many properties of occurrences of patterns in random
words: see for instance [35, 192, 215]. . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE V.15. □
EXAMPLE V.16. Words with excluded patterns. Fix a ﬁnite set of patterns Ω= {w1, . . . , wr},
where each wj is a word of A⋆. The language E ≡E Ωof words that contain no factor in Ωis
described by the extended regular expression
E = A⋆\
r[
j=1
(A⋆wjA⋆),
which constitutes a concise but highly ambiguous description. By closure properties of regular
languages, E is itself regular and there must exist a deterministic automaton that recognizes it.
An automaton recognizing E can be constructed starting from the de Bruijn automaton of
index k = −1 + max |wj| and deleting all the vertices and edges that correspond to a word
of Ω. Precisely, vertex q is deleted whenever q contains a factor in Ω; the transition (edge) from
q associated with letter α gets deleted whenever the word qα contains a factor in Ω. The pruned
de Bruijn automaton, call it B◦
k, accepts all words of 0kE, when it is equipped with the initial
state 0k and all states are ﬁnal. Thus, the OGF E(z) is in all cases a rational function.
The matrix of B◦
k is the matrix of Bk with some nonzero entries replaced by 0. Assume that
B◦
k is irreducible. This assumption only eliminates a few pathological cases (e.g., Ω= {01}
on the alphabet {0, 1}). Then, the matrix of B◦
k admits a simple Perron-Frobenius eigenvalue
λ1. By domination properties (Ω̸= ∅), we must have λ1 < m, where m is the cardinality
of the alphabet. Aperiodicity is automatically granted. We then get by a purely qualitative
argument: The number of words of length n excluding patterns from the ﬁnite set Ωis, under
the assumption of irreducibility, asymptotic to cλn
1 , for some c > 0 and λ1 < ||A||. This gives
us in a simple manner a strong version of what has been earlier nicknamed “Borges’s Theorem”
(Note 32, p. 58): Almost every sufﬁciently long text contains all patterns of some predetermined
length ℓ.
The construction of a pruned automaton is clearly a generalization of the case of words
obeying local constraints in Example 11 above. . . . . . . . . . . . . . . . END OF EXAMPLE V.16. □
 V.40. Walks on undirected graphs. Consider an undirected graph Γ, where one moves by fol-
lowing at each step a random edge of the graph, uniformly at random from the current position.
Then, the transition matrix P = (pij) of the associated Markov chain is: pi,j = 1/ deg(i) if
(i, j) is an edge, where deg(i) is the degree of vertex i. The stationary distribution is given by
πi = (deg(i))/(2||E||), where ||E|| is the number of edges of Γ. In particular, if the graph is
regular, the stationary distribution is uniform. (See Aldous and Fill’s forthcoming book [8] for
(much) more.)


340
V. APPLICATIONS OF RATIONAL AND MEROMORPHIC ASYMPTOTICS
 V.41. Words with excluded patterns and digital trees. Let S be a ﬁnite set of words. An
automaton recognizing S, considered as a ﬁnite language, can be constructed as a tree. The tree
obtained is akin to the classical digital tree or trie that serves as a data structure for maintaining
dictionaries [307].
A modiﬁcation of the construction yields an automaton of size linear in the total number of
characters that appear in words of S. [Hint. The construction can be based on the Aho–Corasick
automaton [4]).

V. 6. Transfer matrix models
There exists a cluster of applications of rational functions to problems that are nat-
urally described as paths in digraphs, but with edges that may be of different sizes. In
physics, such models lie at the heart of what is known as the “transfer matrix method”.
Technically, the theory is a simple extension of the standard case of paths in graphs
developed in the previous section to which it reduces when all edges have the same
length. Its main interest lies in its expressiveness as regards a number of combinato-
rial problems, including trees of bounded width, models of self-avoiding walks, and
certain constrained permutation problems.
V. 6.1. Combinatorial aspects. The transfer matrix method constitutes a variant
of the modelling by deterministic automata and by paths in standard graphs. The
general framework is summarized in Figure 19.
Usually, when setting up such a system, one has to invent a ﬁnite collection of
properties (“states”) describing the Cj, which are of the same nature as the original
class C. The combinatorial system (102) can be visualized as a graph with the objects
of the Ωj,k classes attached to edges (“transitions between states”) that are generally
of different sizes.
Deﬁnition V.7. Given a directed multigraph Γ with vertex set V and edge set E, a
size function on Γ is any function σ : E →Z≥1. A sized graph is a pair (G, σ), where
σ is a size function.
Paths are deﬁned in the same way as in Section V. 5. The length of a path is, as
usual, the number of edges it comprises; the size of a path is deﬁned to be the sum
of the sizes of its edges. Like in the basic case treated in the previous section, we
also allow edges to carry positive weights (multiplicities, probability coefﬁcients), the
weight of a path being the product of the weights of its edges.
Deﬁnition V.8. A matrix T (z) is a transfer matrix if each of its entries is a polynomial
in z with nonnegative coefﬁcients. A transfer matrix T (z) is said to be proper if T (0)
is nilpotent, that is, T (0)r = 0 for some r ≥1.
Examples of transfer matrices are
z

1
4
3
4
1
2
1
2

,
 0
1
z3
z + z2

,
and both are proper. For the graphs and automata considered in Section V. 5, all edges
were taken to be of unit size. In that case, the associated (weighted) adjacency matrices
are invariably of the form T (z) = zS, with S a scalar matrix having nonnegative
entries, and thus are very particular cases of proper transfer matrices.

V. 6. TRANSFER MATRIX MODELS
341
Transfer Matrix Method. Let C be a combinatorial class to be enumerated.
— Determine a collection C1, C2, . . . , Cm of classes, with C1 ≡C such that the following
system of equation holds:
(102)
Cj =
X
k∈{1,2,...,m}
Ωj,kCk + Ij,
j = 1, 2, . . . , m,
where each Ωj,k and each Ij is a ﬁnite class.
— The OGF C(z) ≡C1(z) is then given by the solution of the linear system
Cj(z) =
X
j
Ωj,k(z)Ck(z) + Ij(z),
j = 1, . . . , m,
where Ωj,k(z) and Ij(z) are the generating polynomials of Ωj,k and Ij, respectively. Accord-
ingly, C(z) is a linear combination of entries of the quasi-inverse matrix (I −Ω(z))−1.
FIGURE V.19. A Summary of the basic Transfer Matrix Method.
Given a sized graph Γ equipped with weight function w : E →R>0 (with
w(e) ≡1 in the pure enumerative case), we can associate to it a transfer matrix T (z)
as follows:
(101)
Ta,b(z) =
X
e∈Edge(a,b)
w(e)z|e|.
There, Edge(a, b) represents the set of all edges connecting a to b; w(e) and |e| ≡
σ(e) represent respectively the weight and the size of edge e. The matrix T (z) whose
a, b-entry is the polynomial Ta,b(z), as given in (101), is called the transfer matrix
of the (weighted, sized) graph. Clearly, the transfer matrix of a sized graph is always
proper. Since T (z)m describes all paths in the graph with z marking size, the proof
techniques of Proposition V.6 (p. 321) immediately provide:
Proposition V.9. Given a sized graph with associated transfer matrix T (z), the OGF
F ⟨i,j⟩(z) of the set of paths from i to j, where z marks size, is the entry i, j of the
matrix (I −T (z))−1:
F ⟨i,j⟩(z) =
 (I −T (z))−1
i,j .
V. 6.2. Analytic aspects. In order to apply the general results from the previous
section to transfer matrices, we must ﬁrst take note of an easy reduction of transfer
matrices to the standard case of paths in graphs where all edges have size 1.
Given a sized graph Γ, one can build as follows a standard graph bG where all
edges of bG have unit size. The set of vertices of bG is the set of vertices of Γ augmented
by additional vertices called relay nodes. For each edge e of size σ(e) = m in Γ,
introduce m −1 additional relay nodes and connect these in bG by a simple path from
a to b, with edges all of size 1. Here is for instance the transcription of an edge of
length 4 in Γ by means of three relay nodes in bG:
Clearly, the vertices of Γ are a subset of the vertices of bG and all paths of Γ correspond
to paths of bG. Let bT be the (scalar) adjacency matrix of Γ. Then, the quasi-inverse

342
V. APPLICATIONS OF RATIONAL AND MEROMORPHIC ASYMPTOTICS
(I −z bT)−1 describes all the paths in Γ, with size taken into account, in the sense that
the entry of index (i, j) in this quasi-inverse is the OGF of paths from node numbered i
to node numbered j in the sized graph Γ.
This construction permits us to apply the main results of Section V. 5 to transfer
matrices and sized graphs. Let us say that the sized graph Γ and its transfer matrix
T (z) are irreducible (respectively aperiodic) if bG and bT are irreducible (respectively
aperiodic). We can then transcribe immediately Theorems V.7 and V.8 as follows.
Corollary V.1. (i) Consider a sized graph Γ that is irreducible and aperiodic. Then,
there exist a computable constant λ1 and numbers ϕi,j such that the OGF of paths
from i to j in Γ satisﬁes
(103)
[zn]F ⟨i,j⟩(z) = ϕi,jλn
1 + O(Λn),
0 ≤Λ < λ1.
(ii) In a random path from a to b of large size, the number of occurrences of a
designated edge (s, t) is asymptotically
(104)
̟s,tn + O(1),
for a computable constant ̟s,t.
Thus, on general grounds, the behaviour of paths is predictable. The notes be-
low explore some further properties that make it possible to operate directly with the
transfer matrix and the sized graph, without necessitating the explicit construction of
bT and bG.
 V.42. Irreducibility for sized graphs. The sized graph Γ is irreducible (in the sense above) if
and only if the graph G1 where all edges of Γ are taken to be of size 1 is strongly connected. The
transfer matrix T(z) of Γ is irreducible (in the sense above) if and only if T(1) is irreducible in
the usual sense of scalar transfer matrices.

 V.43. Aperiodicity for sized graphs. A polynomial p(z) = P
j cjzej, with every cj ̸= 0,
is said to be primitive if the quantity δ = gcd({ej}) is equal to 1; it is imprimitive otherwise.
Equivalently, p(z) is imprimitive iff p(z) = q(zδ) for some bona ﬁde polynomial q and some
δ > 1. An irreducible sized graph is aperiodic (in the sense above) if and only if at least one
diagonal entry of some power T(z)e is a primitive polynomial. Equivalently: there exist two
circuits of the same length, whose sizes, s1, s2, satisfy gcd(s1, s2) = 1.

 V.44. Direct determination of the asymptotic growth constant. Let Γ be a sized graph as-
sumed to be irreducible and aperiodic. Then, one has λ1 = 1/ρ, where ρ is the smallest
positive root of det(I −T(z)) = 0, with T(z) the transfer matrix of Γ.

V. 6.3. Applications. The quantitative properties summarized by (103) and (104)
apply with full strength to classes that are amenable to the transfer matrix method. We
shall ﬁrst illustrate the situation by the width of trees following an early article by
Odlyzko and Wilf [379], then continue with an example that draws its inspiration
from the insightful exposition of domino tilings and generating functions in the book
of Graham, Knuth, and Patashnik [248], and conclude with an exactly solvable poly-
omino model.
EXAMPLE V.17. Width of trees. The width of a tree is deﬁned as the maximal number of nodes
that can appear on any layer at a ﬁxed distance from the root. If a tree is drawn in the plane,
then width and height can be seen as the horizontal and vertical dimensions of the bounding

V. 6. TRANSFER MATRIX MODELS
343
3
1
2
T [3](z) =
0
@
z
z2
z3
2z
3z2
4z3
3z
6z2
10z3
1
A .
FIGURE V.20. The sized graph corresponding to general plane trees of width at most 3
and its transfer matrix. (For readability, the transitions from a node to itself are omitted.)
rectangle. Also, width is an indicator of the complexity of traversing the tree in breadth-ﬁrst
search (by a queue), while height is associated to depth-ﬁrst search (by a stack).
Transfer matrices are ideally suited to the problem of analysing the number of trees of ﬁxed
width. Consider a simple variety of trees Y corresponding to the equation Y (z) = zφ(Y (z)),
where the “generator” φ describes the formation of trees. Let C := Y[w] be the subclass of
trees of width at most w. Such trees are easily built layer by layer. Indeed, with reference
to our general description of the transfer matrix method at the beginning of the section, let
us introduce a collection of classes Ck, where each Ck (k = 1, . . . , w) comprises all trees of
width ≤w having exactly k nodes at the deepest level. We then have C = Pw
k=1 Ck (this is a
trivial variant of the case considered in our general description). Thus the states of the transfer
matrix model, equivalently the nodes of the size graph, correspond to the number of nodes on
the deepest layer of the tree. The transition between conﬁgurations Cj corresponding to state
j and conﬁgurations Ck corresponding to state k is effected by grafting in all possible ways a
forest of j trees, of total height equal to 1, having k leaves. See Figure 20 for the case of width
w = 3.
The number of j-forests of depth 1 having k leaves is the quantity
tj,k = [uk]φ(y)j.
Let T be the w × w matrix with entry Tj,k = zktj,k. Then, clearly, the quantity zi(T h)i,j
(with 1 ≤i, j ≤w) is the number of i-forests of height h and width at most w, having j nodes
on level h. Thus, the GF of Y-trees having width at most w is
Y [w](z) = (z, 0, 0, . . .)(I −T)−1(1, 1, 1, . . .)t.
For instance, in the case of general Catalan trees, the matrix T has the shape,
T [w](z) =
0
B
B
@
z
`1
0
´
z2`2
0
´
z3`3
0
´
z4`4
0
´
z
`2
1
´
z2`3
1
´
z3`4
1
´
z4`5
1
´
z
`3
2
´
z2`4
2
´
z3`5
2
´
z4`6
2
´
z
`4
3
´
z2`5
3
´
z3`6
3
´
z4`7
3
´
1
C
C
A ,
for width 4. The analysis of dominant poles provides asymptotic formulae for [zn]Y [w](z):
w = 2
w = 3
w = 4
w = 5
w = 6
0.0085 · 2.1701n 0.0026 · 2.8050n 0.0012 · 3.1638n 0.0006 · 3.3829n 0.0004 · 3.5259n
Irreducibility is granted since all entries in the transfer matrix are nonzero. Aperiodicity derives
from aperiodicity of the generator φ, as veriﬁed by a simple argument (e.g., using Note 43).

344
V. APPLICATIONS OF RATIONAL AND MEROMORPHIC ASYMPTOTICS
Proposition V.10. The number of trees of width at most w in a simple family of trees satisﬁes
an asymptotic estimate of the form
Y [w]
n
= cwρ−n
w
+ O(n),
for some computable positive constants cw, ρw.
In addition, the exact distribution of height in trees of size n becomes computable in poly-
nomial time (though with a somewhat high exponent).
The character of these generating functions has not been investigated in detail since the
original work [379], so that, at the moment, analysis stops there. Fortunately, probability theory
can take over. Chassaing and Marckert [82] have shown, for Cayley trees, that the width satisﬁes
En(W ) =
r
πn
2 + O
“
n1/4p
log n
”
,
Pn(
√
2W ≤x) →1 −Θ(x),
where Θ(x) is the Theta function deﬁned in (57), p. 305. This answers very precisely an open
question of Odlyzko and Wilf [379]. The distributional results of [82] extend to trees in any
simple variety (under mild and natural analytic assumptions on the generator φ): see the paper
by Chassaing, Marckert, and Yor [83], which builds upon earlier results of Drmota and Gitten-
berger [136]. In essence, the conclusion of these works is that the breadth ﬁrst search traversal
of a large tree in a simple variety gives rise to a queue whose size ﬂuctuates asymptotically
like a Brownian excursion, and is thus, in a strong sense, of a complexity comparable to depth-
ﬁrst search: trees taken uniformly don’t have much of a preference as to the way they may be
traversed. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE V.17. □
 V.45. A question on width polynomials. It is unknown whether the following assertion is
true. The smallest positive root ρk of the denominator of Y [k](z) satisﬁes
ρk = ρ + c
k2 + o(k−2),
for some c > 0. If such an estimate holds together with suitable companion bounds, it would
yield a purely analytic proof of the fact that expected width of n–trees is Θ(√n), as well as
detailed probability estimates. (The classical theory of Fredholm equations may be useful in
this context.)

EXAMPLE V.18. Monomer-dimer tilings of a rectangle. Suppose one is given pieces that may
be one of the three forms: monomers (m) that are 1 × 1 squares, and dimers that are dominoes,
either vertically (v) oriented 1 × 2, or horizontally (h) oriented 2 × 1. In how many ways can
an n × 3 rectangle be covered completely and without overlap (‘tiled’) by such pieces?
The pieces are thus of the following types,
m =
,
h =
,
v =
,
and here is a particular tiling of a 5 × 3 rectangle:

V. 6. TRANSFER MATRIX MODELS
345
In order to approach this counting problem, one deﬁnes a class C of combinatorial objects
called conﬁgurations. A conﬁguration relative to an n × k rectangle is a partial tiling, such that
all the ﬁrst n −1 columns are entirely covered by dominoes while between zero and three unit
cells of the last column are covered. Here are for instance, conﬁgurations corresponding to the
example above.
These diagrams suggest the way conﬁgurations can be built by successive addition of
dominoes. Starting with the empty rectangle 0 × 3, one adds at each stage a collection of
at most three dominoes in such a way that there is no overlap. This creates a conﬁguration
where, like in the example above, the dominoes may not be aligned in a ﬂush-right manner.
Continue to add successively dominoes whose left border is at abscissa 1, 2, 3, etc, in a way
that creates no internal “holes”.
Depending on the state of ﬁlling of their last column, conﬁguration can thus be classiﬁed
into 8 classes that we may index in binary as C000, . . . , C111. For instance C001 represent con-
ﬁgurations such that the ﬁrst two cells (from top to bottom, by convention) are free, while the
third one is occupied. Then, a set of rules describes the new type of conﬁguration obtained,
when the sweep line is moved one position to the right and dominoes are added. For instance,
we have
C010
⊙
=⇒
C101.
In this way, one can set up a grammar (resembling a deterministic ﬁnite automaton) that
expresses all the possible constructions of longer rectangles from shorter ones according to the
last layer added. The grammar comprises productions like
C000
=
ǫ + mmmC000 + mvC000 + vmC000
+ ·mmC100 + m·mC010 + mm·C001 + v·C001 + ·vC100
+ m··C011 + ·m·C101 + ··mC110 + ···C111 .
In this grammar, a “letter” like mv represent the addition of dominoes, in top to bottom order,
of types m, v respectively; the letter m·m means adding two m-dominoes on the top and on the
bottom, etc.
The grammar transforms into a linear system of equations with polynomial coefﬁcients.
The substitution,
m 7→z,
h 7→z2,
v 7→z2,
then gives the generating functions of conﬁgurations with z marking the area covered:
C000(z) =
(1 −2z3 −z6)(1 + z3 −z6)
(1 + z3)(1 −5z3 −9z6 + 9z9 + z12 −z15).
In particular, the coefﬁcient [z3n]C000(z) is the number of tilings of an n × 3 rectangle:
C000(z) = 1 + 3z3 + 22z6 + 131z9 + 823z12 + 5096z15 + · · · .
The sequence grows like c αn (for n ≡0 (mod 3)) where α .= 1.83828 (α is the cube root
of an algebraic number of degree 5). (See [81] for a computer algebra session.) On average,
for large n, there is a ﬁxed proportion of monomers and the distribution of monomers in a

346
V. APPLICATIONS OF RATIONAL AND MEROMORPHIC ASYMPTOTICS
random tiling of a large rectangle is asymptotically normally distributed, as results from the
developments of Chapter IX. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE V.18. □
The tiling example is a typical illustration of the transfer matrix method as de-
scribed at the beginning of this section (p. 340). One seeks to enumerate a “special”
set of conﬁgurations Cf. (In the example above, this is C000 representing complete
rectangle coverings.) One determines an extended set of conﬁgurations C (the partial
coverings, in the example) such that: (i) C is partitioned into ﬁnitely many classes;
(ii) there is a ﬁnite set of “actions” that operate on the classes; (iii) size is affected
in a well-deﬁned additive way by the actions. The similarity with ﬁnite automata is
apparent: classes play the rˆole of states and actions the rˆole of letters.
Often, the method of transfer matrices is used to approximate a hard combinato-
rial problem that is not known to decompose, the approximation being by means of a
family of models of increasing “widths”. For instance, the enumeration of the number
Tn of tilings of an n × n square by monomers and dimers remains a famous unsolved
problem of statistical physics. Here, transfer matrix methods may be used to solve the
n × w version of the monomer–dimer coverings, in principle at least, for any ﬁxed
width w: the result will always be a rational function, though its degree, dictated by
the dimension of the transfer matrix, will grow exponentially with w. (The “diagonal”
sequence of the n × w rectangular models corresponds to the square model.) It has
been at least determined by computer search that the diagonal sequence Tn starts as
(this is EIS A028420):
1, 7, 131, 10012, 2810694, 2989126727, 11945257052321, . . . .
From this and other numerical data, one estimates numerically that (Tn)1/n2 →
1.94021 . . ., but no expression for the constant is known to exist. The difﬁculty of
coping with the ﬁnite-width models is that their complexity (as measured , e.g., by
the number of states) blows up exponentially with w—such models are best treated
by computer algebra; see [514]—and no law allowing to take a diagonal is visible.
However, the ﬁnite width models have the merit of providing at least provable upper
and lower bounds on the exponential growth rate of the hard “diagonal problem”.
In contrast, for coverings by dimers only, a strong algebraic structure is available
and the number of covers of an n×n square by horizontal and vertical dimers satisﬁes
a beautiful formula originally discovered by Kasteleyn (n even):
(105)
Un = 2n2/2
n/2
Y
j=1
n/2
Y
k=1

cos2
jπ
n + 1 + cos2
kπ
n + 1

.
This sequence is EIS A004003,
1, 2, 36, 6728, 12988816, 258584046368, 53060477521960000, . . . .
It is elementary to prove from (105) that
lim
n→+∞(Un)1/n2
= exp
 
1
π
∞
X
n=0
(−1)n
(2n + 1)2
!
= eG/π .= 1.33851 . . . ,

V. 6. TRANSFER MATRIX MODELS
347
FIGURE V.21. A self-avoiding polygon or SAP (left) and a self-avoiding walk or SAW
(right).
where G is Catalan’s constant. This means in substance that each cell has a number of
degrees of freedoms equivalent to 1.33851. See Percus’ monograph [391] for proofs
of this famous result and Finch’s book [165, Sec. 5.23] for context and references.
 V.46. Powers of Fibonacci numbers. Consider the OGFs
G(z) :=
1
1 −z −z2 =
X
n≥0
Fn+1zn,
G[k](z) :=
X
n≥0
(Fn+1)k zn,
where Fn is a Fibonacci number. The OGF of monomer–dimer placements on a k × n board
when only monomers (m) and horizontal dimers (h) are allowed is obviously G[k](z). On the
other hand, it is possible to set up a transfer matrix model with state i (0 ≤i ≤k) correspond-
ing to i positions of the current column occupied by a previous domino. Consequently,
G[k](z) = coeffk,k
`
(I −zT)−1´
,
where
Ti,j =
 
i
i + j −k
!
,
for 0 ≤i, j ≤k.
[The denominator of G[k](z) is otherwise known exactly: see [306,
Ex. 1.2.8.30].]

 V.47. Tours on chessboards. The OGF of Hamiltonian tours on an n×w rectangle is rational
(one is allowed to move from any cell to any other vertically or horizontally adjacent cell). The
same holds for king’s tours and knight’s tours.

 V.48. Cover time of graphs. Given a ﬁxed digraph Γ assumed to be strongly connected, and
a designated start vertex, one travels at random, moving at each time to any neighbour of the
current vertex, making choices with equal likelihood. The expectation of the time to visit all the
vertices is a rational number that is effectively (though perhaps not efﬁciently!) computable.
[Hint: set up a transfer matrix, a state of which is a subset of vertices representing those vertices
that have been already visited. For an interval [0, . . m], this can be treated by the dedicated
theory of walks on the integer interval, as in Section V. 3; for the complete graph, this is equiva-
lent to the coupon collector problem. Most other cases are “hard” to solve analytically and one
has to resort to probabilistic approximations; see Aldous and Fill’s forthcoming book [8] for a
probabilistic approach.]

EXAMPLE V.19. Self-avoiding walks and polygons. A long standing open problem shared by
statistical physics, combinatorics, and probability theory alike is that of quantifying properties
of self-avoiding conﬁgurations on the square lattice (Figure 21). Here we consider objects that,
starting from the origin (the “root”), follow a path, and are solely composed of horizontal and
vertical steps of length ±1. The self-avoiding walk or SAW can wander but is subject to the

348
V. APPLICATIONS OF RATIONAL AND MEROMORPHIC ASYMPTOTICS
condition that it never crosses nor touches itself. The self-avoiding polygons or SAPs, whose
class is denoted by P, are self-avoiding walks, with only an exception at the end, where the end-
point must coincide with the origin. We shall focus here on polygons. It proves convenient also
to consider unrooted polygons (also called simply-connected polyominoes), which are polygons
where the origin is discarded, so that they plainly represent the possible shapes of SAPs up to
translation. For length 2n, the number pn of unrooted polygons satisﬁes pn = Pn/(4n) since
the origin (2n possibilities) and the starting vertex (2 possibilities) of the corresponding SAPs
are disregarded in that case. Here is a table, for small values of n, listing polyominoes and the
corresponding counting sequences pn, Pn.
n:
2
3
4
5
6
7
8
9
10
pn (EIS A002931):
1
2
7
28
124
588
2938
15268
81826
Pn (EIS A010566):
8
24
112
560
2976
16464
94016
549648
3273040
Take the (widely open) problem of determining the number Pn of SAPs of perimeter 2n.
This (intractable) problem can be approached as a limit of the (tractable) problem14 that con-
sists in enumerating the collection P[w] of SAPs of width w, for increasing values of w. The
latter problem is amenable to the transfer matrix method, as ﬁrst discovered by Enting in 1980;
see [152]. Indeed, take a polygon and consider a sweepline that moves from its left to its right.
Once width is ﬁxed, there are at most 22w+2 possibilities for the ways a vertical sweepline
may intersect the polygon’s edges at half integer abscissæ. (There are w + 1 edges and for
each of these, one should “remember” whether they connect with the upper or lower boundary.)
The transitions are then themselves ﬁnitely described. In this way, it becomes possible to set
up a transfer matrix for any ﬁxed width w. For ﬁxed n, by computing values of P [w]
n
with
increasing w, one ﬁnally determines (in principle) the exact value of any Pn.
The program suggested above has been carried out to record values by the “Melbourne
School” under the impulse of Tony Guttmann. For instance, Jensen [284] found in 2003 that
the number of unrooted polygons of perimeter 100 is
p50 = 7545649677448506970646886033356862162.
Attaining such record values necessitates algorithms that are much more sophisticated than the
na¨ıve approach we have just described, as well as a number of highly ingenious programming
optimizations.
It is an equally open problem to estimate asymptotically the number of SAPs of perime-
ter n. Given the exact values till perimeter 100 or more, a battery of ﬁtting tests for asymptotic
formula can be applied, leading to highly convincing (though still heuristic) formulæ. Thanks
to several workers in this area, we can regard the ﬁnal answer as “known”. From the works of
Jensen and his predecessors, it results that a reliable empirical estimate is of the form
( pn = Bµ2n(2n)−β(1 + o(1)),
µ .= 2.63815 85303,
β = −5
2 ± 3 · 10−7,
B .= 0.5623013.
14In this version of the text, we limit ourselves to a succinct description and refer to the original
papers [152, 284] for details.

V. 6. TRANSFER MATRIX MODELS
349
FIGURE V.22. Five horizontally convex polyominoes of size n = 50 drawn uniformly
at random.
Thus, the answer is almost certainly of the form pn ≍µ2nn−5/2 for unrooted polygons and
Pn ≍µ2nn−3/2 for rooted polygons. It is believed that the same connective constant µ dictates
the exponential growth rate of self-avoiding walks. See Finch’s book [165, Sec. 5.10] for a
perspective and numerous references.
There is also great interest in the number pm,n of polyominoes with perimeter 2n and
area m, with area deﬁned as the number of square cells composing the polyomino. Studies
conducted by the Melbourne school yield numerical data that are consistent to an amazing
degree (e.g., moments till order ten and small–n corrections are considered) with the following
assumption: The distribution of area in a ﬁxed-perimeter polyomino obeys in the asymptotic
limit an “Airy area distribution”. This distribution is deﬁned as the limit distribution of the
area under Dyck paths, a problem that was brieﬂy discussed on p. 307 and to which we propose
to return in Chapter IX. See [284, 411] and references therein for a discussion of polyomino
area. It is ﬁnally of great interest to note that the interpretation of data was strongly guided by
what is already known for exactly solvable models of the type we are repeatedly considering in
this book.
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE V.19. □
EXAMPLE V.20.
Horizontally convex polyominoes. P´olya [396] and Temperley [466] inde-
pendently discovered an exactly solvable polyomino model. (See also the text by van Rens-
burg [482] for more.) Deﬁne as usual a polyomino as a collection of unit squares with vertices
in Z≥0 × Z≥0 that forms a connected set without articulation points. Such a polyomino is said
to be horizontally convex (H.C.) if its intersection with any horizontal line is either empty or
an interval. An H.C. polyomino is thus a stack of a certain number of rows of squares, where
each row has a segment of length ≥1 in common with the next row up. (We imagine H.C.
polyominoes growing from bottom to top.) The enumeration of such polyominoes, following
Temperley [466, p. 66] constitutes a nice illustration of the transfer matrix method in the case
when the set of states is inﬁnite.
Let T [k] be the class of polyominoes with exactly k square cells on their top row. Size of
a polyomino is its number of cells. We wish to enumerate the class T := S
k T [k]. In order to
do so, according to the transfer matrix method, one needs to relate the T [k] to one another. Let
z be the variable marking size and let x mark the size of the top row. The transition from one
T [k] to a T [ℓ] has a multiplicity equal to k +ℓ−1. Thus the generating functions tk := T [k](z)

350
V. APPLICATIONS OF RATIONAL AND MEROMORPHIC ASYMPTOTICS
satisfy the inﬁnite system of equations
(106)
t1
=
z + z (t1 + 2t2 + 3t3 + · · · )
t2
=
z2 + z2 (2t1 + 3t2 + 4t3 + · · · )
t3
=
z3 + z3 (3t1 + 4t2 + 5t3 + · · · )
This corresponds to an inﬁnite transfer matrix which is highly structured:
M(z)k,ℓ= (k + ℓ−1)zℓ,
and, as shown by Temperley [466, p. 66], the system can be solved by elementary manipula-
tions.
In a case like this, it is well worth trying a bivariate generating function. Deﬁne
T(z, u) =
X
n,k
T [k](z)uk.
The action of “adding a slice” on the top row of a polyomino is reﬂected by a linear operator
L that transforms uk representing the top row of the polyomino before addition into a sum of
monomials uℓzℓwith the proper multplicites:
L[uk] = k(uz)k + (k + 1)(uz)k+1 + · · · = (k −1)
uz
1 −uz +
uz
(1 −uz)2 .
A better formula results if one expresses more generally the quantity L[f(u)]:
(107)
L[f(u)] =
uz
(1 −uz)2 f(1) +
uz
1 −uz
`
f ′(1) −f(1)
´
.
Treat now the BGF T(z, u) as a function of u, keeping z as a parameter, and write for readability
τ(u) := T(z, u). A horizontally convex polyomino is obtained by starting from a bottom row
that can have any number of cells and repeatedly adding a slice15. This construction is thus
reﬂected by the main functional equation
(108)
τ(u)
=
zu
1 −zu + L[τ(u)]
=
zu
1 −zu +
zu
1 −zuτ ′(1) +
z2u2
(1 −zu)2 τ(1),
upon making use of (107). Instantiating at u = 1 provides the ﬁrst relation
(109)
τ(1) =
z
1 −z +
z
1 −z τ ′(1) +
z2
(1 −z)2 τ(1),
while differentation of (108) with respect to u followed by the specialization u = 1 provides
the second relation
(110)
τ ′(1) =
z
(1 −z)2 +
z
(1 −z)2 τ ′(1) + 2
z
(1 −z)3 τ(1).
We now have a linear system of two equations in two unknowns, resulting in an expression of
τ(1) = T(z) = T(z, 1), which enumerates all horizontally convex polyominoes:
(111)
T(z) =
z(1 −z)3
1 −5z + 7z2 −4z3 .
From (108) to (111), the whole calculation is barely three lines of code under a decent computer
algebra system. Note that, the original system being inﬁnite, it is far from obvious a priori that
the generating function should be rational. (In the present context, rationality devolves from the
very regular structure of the transfer matrix.)
15An earlier instance of the technique of “adding a slice” appears in the context of constrained com-
positions, Example III.21, p. 187.

V. 6. TRANSFER MATRIX MODELS
351
The counting sequence obtained by expansion,
T(z) = z + 2 z2 + 6 z3 + 19 z4 + 61 z5 + 196 z6 + 629 z7 + 2017 z8 + · · ·
is EIS A001169 (“Number of board-pile polyominoes with n cells”). The asymptotic form is
also easily obtained: we ﬁnd
Tn ∼CAn,
C .= 0.18091,
A .= 3.20556,
with A a cubic irrational.
An alternative derivation, which is more sophisticated, is due to Klarner and is presented
in Stanley’s book [447, §4.7]. Hickerson [267] has found a direct construction, which explains
the rationality of the GF by means of a regular language encoding. (The drawings of Figure 22
have been obtained by an application of the recursive method [216] to Hickerson’s speciﬁca-
tion.) Louchard [343] has conducted an in-depth study of probabilistic properties of several
parameters of H.C. polyominoes, using generating functions. . . . END OF EXAMPLE V.20. □
 V.49. Height of H.C. polyominoes. It is possible to introduce an extra variable v to encode
height. It is found that height grows on average linearly with n and that the distribution of height
is concentrated [343]. (This explains the skinny aspects of polyominoes drawn in Figure 22.)

 V.50. A transfer matrix model for lattice paths. Consider the general context of weighted
lattice paths in Section V. 3. Let αj, βj, γj be the weights of ascents, descents, and level steps
repsectively, when the starting altitude is j. The inﬁnite transfer matrix,
T =
0
B
B
@
γ0
α0
0
0
0
· · ·
β1
γ1
α1
0
0
· · ·
0
β2
γ2
α2
0
· · ·
...
...
...
...
...
...
1
C
C
A ,
which has a tridiagonal form, “generates” all lattice paths via the quasi-inverse (I −zT)−1.
In particular, any exactly solvable weighted lattice path model is equivalent to an explicit struc-
tured matrix inversion.

V. 6.4. Value-constrained permutations. We conclude this chapter with a dis-
cussion of a construction that combines transfer matrix methods with an inclusion-
exclusion argument. We treat a collection of constrained permutation problems whose
origin lies in nineteenth century recreational mathematics. For instance, the m´enage
problem solved and popularized by ´Edouard Lucas in 1891, see [98], has the following
quaint formulation: What is the number of possible ways one can arrange n married
couples (‘m´enages’) around a table in such a way that men and women alternate, but
no woman sits next to her husband?
The m´enage problem is equivalent to a permutation enumeration problem. Sit
ﬁrst conventionally the men at places numbered 1, 2, . . ., n and the wives at positions
3
2, 5
2, . . . , n + 1
2. Let σi be such that the ith wife is placed at σi + 1
2. Then, a m´enage
placement imposes the conditions σi ̸= i and σi ̸= i + 1 for each i. We consider here
a linearly arranged table (see remarks at the end for the other classical formulation
that considers a round table), so that the condition σi ̸= i + 1 becomes vacuous when

352
V. APPLICATIONS OF RATIONAL AND MEROMORPHIC ASYMPTOTICS
i = n. Here is a m´enage placement for n = 6 and its corresponding permutation
6
1
2
3
4
5
σ =
 1
2
3
4
5
6
4
5
6
2
1
3

Clearly, this is a generalization of the derangement problem (for which only the
weaker condition σi ̸= i is imposed), where the cycle decomposition of permutations
sufﬁces to provide a direct solution (see Example II.14, p. 113).
Deﬁnition V.9. Given a permutation σ = σ1 · · · σn, any quantity σi −i is called an
exceedance of σ. Given a ﬁnite set of integers Ω⊂Z≥0, a permutation is said to be
Ω-avoiding if none of its exceedances lies in Ω.
Inclusion-exclusion. The set Ωbeing ﬁxed, consider ﬁrst for all j the class of
augmented permutations Pn,j that are permutations of size n such that j of the po-
sitions are distinguished and the corresponding exceedances lie in Ω, the remaining
positions having arbitrary values (but with the permutation property being satisﬁed!).
Loosely speaking, the objects in Pn,j can be regarded as permutations with “at least”
j exceedances in Ω. For instance, with Ω= {1} and
σ =

1
2
3
4
5
6
7
8
9
2
3
4
8
6
7
1
5
9

,
there are 5 exceedances that lie in Ω(at positions 1, 2, 3, 5, 6) and with 3 of these
distinguished (say by enclosing them in a box), one obtains an element counted by
P9,3 like
2 3
4 8 6 7 1 5 9.
Let Pn,j be the cardinality of Pn,j. We claim that the number Qn = QΩ
n of Ω-avoiding
permutations of size n satisﬁes
(112)
Qn =
n
X
j=0
(−1)jPn,j.
Equation (112) is typically an inclusion-exclusion relation. To prove it formally16,
deﬁne the number Rn,k of permutations that have exactly k exceedances in Ωand the
generating polynomials
Pn(w) =
X
j
Pn,jwj,
Rn(w) =
X
k
Rn,kwk.
The GF’s are related by
Pn(w) = Rn(w + 1)
or
Rn(w) = Pn(w −1)..
16See also the discussion in Subsection III. 7.4, p. 195.

V. 6. TRANSFER MATRIX MODELS
353
FIGURE V.23. A graphical rendering of the legal template 20?02?11? relative to Ω=
{0, 1, 2}.
(The relation Pn(w) = Rn(w + 1) simply expresses symbolically the fact that each
Ω-exceedance in R may or may not be taken in when composing an element of P.) In
particular, we have Pn(−1) = Rn(0) = Rn,0 = Qn as was to be proved.
Transfer matrix model. The preceding discussion shows that everything relies on
the enumeration Pn,j of permutations with distinguished exceedances in Ω. Introduce
the alphabet A = Ω∪{‘?’}, where the symbol ‘?’ is called the ‘don’t-care symbol’.
A word on A, an instance with Ω= {0, 1, 2} being 20?02?11?, is called a template.
To an augmented permutation, one associates a template as follows: each exceedance
that is not distinguished is represented by a don’t care symbol; each distinguished
exceedance (thereby an exceedance with value in Ω) is represented by its value. A
template is said to be legal if it arises from an augmented permutation. For instance a
template 2 1 · · · cannot be legal since the corresponding constraints, namely σ1 −1 =
2, σ2 −2 = 1, are incompatible with the permutation structure (one would have
σ1 = σ2 = 3). In contrast, the template 20?02?11? is seen to be legal. Figure 23 is
a graphical rendering; there, letters of templates are represented by dominoes, with a
cross at the position of a numeric value in Ω, and with the domino being blank in the
case of a don’t-care symbol.
Let Tn,j be the set of legal templates relative to Ωthat have length n and comprise
j don’t care symbols. Any such legal template is associated to exactly j! permutations,
since n −j position-value pairs are ﬁxed in the permutation, while the j remaining
positions and values can be taken arbitrarily. There results that
(113)
Pn,n−j = j! Tn,j
and
Qn =
n
X
j=0
(−1)n−jj! Tn,j,
by (112). Thus, the enumeration of avoiding permutations rests entirely on the enu-
meration of legal templates.
The enumeration of legal templates is ﬁnally effected by means of a transfer ma-
trix method, or equivalently, by a ﬁnite automaton. If a template τ = τ1 · · · τn is legal,
then the following condition is met,
(114)
τj + j ̸= τi + i,

354
V. APPLICATIONS OF RATIONAL AND MEROMORPHIC ASYMPTOTICS
for all pairs (i, j) such that i < j and neither of τi, τj is the don’t-care symbol. (There
are additional conditions to characterize templates fully, but these only concern a few
letters at the end of templates and we may ignore them in this discussion.) In other
words, a τi with a numerical value preempts the value τi + i. Figure 23 exempliﬁes
the situation in the case Ω= {0, 1, 2}. The dominoes are shifted one position each
time (since it is the value of σ −i that is represented) and the compatibility con-
straint (114) is that no two crosses should be vertically aligned. More precisely the
constraints (114) are recognized by a deterministic ﬁnite automaton whose states are
indexed by subsets of {0, . . . , b −1} where the “span” b is deﬁned as b = maxω∈Ωω.
The initial state is the one associated with the empty set (no constraint is present ini-
tially), the transitions are of the form (j ∈{0, . . ., b}):
 (qS, j) 7→qS′
where S′ = ((S −1) ∪{j −1}) ∩{0, . . . , b −1}
(qS, ?) 7→qS′
where S′ = (S −1) ∩{0, . . ., b −1}.
The initial state (is q{} and it is equal to the ﬁnal state (this translates the fact that
no domino can protrude from the right, and is implied by the linear character of the
m´enage problem under consideration). In essence, the automaton only needs a ﬁnite
memory since the dominoes slide along the diagonal and, accordingly, constraints
older than the span can be forgotten. Notice that the complexity of the automaton, as
measured by its number of states, is 2b.
Here are the automata corresponding to Ω= {0} (derangements) and to Ω=
{0, 1} (m´enages).
{0}
 { }
{ }
For the m´enage problem, there are two states depending on whether or not the cur-
rently examined value has been preempted at the preceding step.
From the automaton construction, the bivariate GF T Ω(z, u) of legal templates,
with u marking the position of don’t care symbols, is a rational function that can
be determined in an automatic fashion from Ω. For the derangement and m´enage
problems, one ﬁnds
T {0}(z, u) =
1
1 −z(1 + u),
T {0,1}(z, u) =
1 −z
1 −z(2 + u) + z2 .
In general, this gives access to the OGF of the corresponding permutations. Consider
the partial expansion of T Ω(z, u) with respect to u, taken under the form
(115)
T Ω(z, u) =
X
r
cr(z)
1 −uur(z),

V. 6. TRANSFER MATRIX MODELS
355
assuming for simplicity only simple poles. There the sum is ﬁnite and it involves
algebraic functions cr and ur of the variable z. Finally, the OGF of Ω-avoiding per-
mutations is obtained from T Ωby the transformation
znuk
7→
(−z)nk!,
which is the transcription of (113). Deﬁne the (divergent) OGF of all permutations,
F(y) =
∞
X
n=0
n! yn = 2F0[1, 1; y],
in the terminology of hypergeometricfunctions. Then, by the remarks above and (115),
we ﬁnd
QΩ(z) =
X
r
cr(−z)F(−uj(−z)).
In other words, the OGF of Ω-avoiding permutations is a composition of the OGF of
the factorial series with algebraic functions.
The expressions simplify much in the case of m´enages and derangements where
the denominators of T are of degree 1 in u. One has
Q{0}(z) =
1
1 + z F(
z
1 + z ) = 1 + z2 + 2z3 + 9z4 + 44z5 + 265z6 + 1854z7 + · · · ,
for derangements, whence a new derivation of the known formula,
Q{0}
n
=
n
X
k=0
(−1)k
n
k

(n −k)!.
Similarly, for (linear) m´enage placements, one ﬁnds
Q{0,1}(z) =
1
1 + z F(
z
(1 + z)2 ) = 1 + z3 + 3z4 + 16z5 + 96z6 + 675z7 + · · · ,
which is EIS A00027 and corresponds to the formula
Q{0,1}
n
=
n
X
k=0
(−1)k
2n −k
k

(n −k)!.
Finally, the same techniques adapts to constraints that “wrap around”, that is, con-
straints taken modulo n. (This corresponds to a round table in the m´enage problem.)
In that case, what should be considered is the loops in the automaton recognizing tem-
plates (see also the discussion of the zeta function of graphs, p. 321). One ﬁnds in this
way the OGF of the circular (i.e., classical) m´enage problem to be EIS A000179,
bQ{0,1}(z) = 1 −z
1 + z F(
z
(1 + z)2 )+2z = 1+z+z3+2z4+13z5+80z6+579z7+· · · ,
which yields the classical solution of the (circular) m´enage problem,
bQ{0,1}
n
=
n
X
k=0
(−1)k
2n
2n −k
2n −k
k

(n −k)!,
a formula that is due to Touchard; see [98, p. 185] for pointers to the vast classical
literature on the subject. The algebraic part of the treatment above is close to the

356
V. APPLICATIONS OF RATIONAL AND MEROMORPHIC ASYMPTOTICS
inspiring discussion found in Stanley’s book [447]. An application to robustness of
interconnections in random graphs is presented in [190].
Asymptotic analysis. For asymptotic analysis purposes, the following general
property proves useful: Let F be the OGF of factorial numbers and assume that y(z)
is analytic at the origin where it satisﬁes y(z) = z −λz2 + O(z3); then the following
estimate holds:
(116)
[zn]F(y(z)) ∼[zn]F(z(1 −λz)) ∼n!e−λ.
(The proof results from simple manipulations of divergent series in the style of [29].)
This gives at sight the estimates
Q{0}
n
∼ne−1,
Q{0,1}
n
∼ne−2.
More generally, for any set Ωcontaining λ elements, one has
Q{Ω}
n
∼ne−λ.
Furthermore, the number RΩ
n,k of permutations having exactly k occurrences (k ﬁxed)
of an exceedance in Ωis asymptotic to
Q{Ω}
n
∼ne−λ λk
k! .
In other words, the rare event that an exceedance belongs to Ωobeys a Poisson distri-
bution with λ = |Ω|. These last two results are established by means of probabilistic
techniques in the book [23, Sec. 4.3]. The relation (116) provides a way of arriving at
such estimates by purely analytic-combinatorial techniques.
 V.51. Other constrained permutations. Given a permutation σ = σ1 · · · σn, a succession gap
is deﬁned as any difference σi+1 −σi. Discuss the counting of permutations whose succession
gaps are constrained to lie outside of a ﬁnite set Ω. In how many ways can a kangaroo pass
through all points of the integer interval [1, n] starting at 1 and ending at n while making hops
that belong to {−2, −1, 1, 2}?

V. 7. Perspective
The theorems in this chapter demonstrate the power of the fundamental tech-
niques developed in Chapter IV, which exploit classical theorems in complex analysis
to develop coefﬁcient asymptotics. As we start seeing it here, this approach applies
to many of the generating functions derived from the formal combinatorial techniques
of Part A of this book. By paying careful attention to the types of combinatorial con-
structions involved, we are able to identify abstract schemas that help us solve whole
classes of problems at once. Each schema connects a type of combinatorial construc-
tion to a complex asymptotic method. In this way, it becomes possible to discuss
properties shared by an inﬁnite collection of combinatorial classes. In this chapter,
we have presented the method in detail for classes that involve a sequence construc-
tion and classes recursively deﬁned by a linear system of equations (paths in graphs,
automata, transfer matrices).
In an ideal world, we might wish to have a direct correspondence between com-
binatorial constructions and analytic methods—a theory that would carry all the way
from combinatorial objects of any description to full analysis of all their properties.

V.7. PERSPECTIVE
357
The case of paths in graphs and automata, with its strong connectedness condition
leading to Perron-Frobenius theory, is an instance of this ideal situation. Reality is
however usually a bit more complex: theorems for deriving asymptotic results from
combinatorial speciﬁcations must often have some sort of analytic side conditions.
A typical example is the radius of convergence condition for supercritical sequences.
As soon as such conditions are satisﬁed, the asymptotic properties of large structures
become highly predictable. This is the very essence of analytic combinatorics.
In the next two chapters, we investigate generating functions whose singularities
are no longer poles—fractional exponents and logarithmic factors become allowed.
This ﬁrst necessitates investing in general methodology, a task undertaken in Chap-
ter VI where the method known as singularity analysis is developed. Then, a chapter
parallel to the present one, Chapter VII, will present a number of new schemas based
on the set and cyle constructions, as well as on recursion.
Applications of rational functions in discrete and continuous mathematics are in abun-
dance. Many examples are to be found in Goulden and Jackson’s book [244]. Stanley [447]
even devotes a full chapter of his book Enumerative Combinatorics, vol. I, to rational generating
functions. These two books push the theory further than we can do here, but the corresponding
asymptotic aspects which we expose lie outside of their scope. The analytic theory of posi-
tive rational functions starts with the works of Perron and Frobenius at the beginning of the
twentieth century and is explained in books on matrix theory likes those of Bellman [26] and
Gantmacher [225]. Its importance has been long recognized in the theory of ﬁnite Markov
chains, so that the basic theory of positive matrices is well developed in many elementary trea-
tises on probability theory. For such aspects, we refer for instance to the classic presentations
by Feller [161] or Karlin and Taylor [290].
The supercritical sequence schema is the ﬁrst in a list of abstract schemas that neatly exem-
plify the interplay between combinatorial, analytic, and probabilistic properties of large random
structures. The origins of this approach are to be traced to early works of Bender [28, 29] fol-
lowed by Soria and Flajolet [210, 212, 443].
Turning to more speciﬁc topics, we mention in relation to Section V. 3 the ﬁrst global at-
tempt at a combinatorial theory of continued fractions by Flajolet in [168] together with related
works of Jackson of which an exposition is to be found in [244, Ch. 5] and a synthesis in [188]
in relation to birth and death processes. Walks on graphs from an algebraic standpoint are well
discussed in Godsil’s book [238]; for inﬁnite graphs and groups, see Woess [500]. The discus-
sion of local constraints in permutations based on [190] combines some of the combinatorial
elements bound in Stanley’s book [447] with the general philosophy of analytic combinatorics.
Our treatment of words and languages largely draws its inspiration from the line of research
started by Sch¨utzenberger in the early 1960’s and on the subsequent account to be found in
Lothaire’s book [337]. A nice review of transfer matrix methods (including a discussion of
limit distributions) is offered by Bender, Richmond, and Williamson in [37].


VI
Singularity Analysis of Generating
Functions
Es ist eine Tatsache, daß die genauere Kenntnis
des Verhaltens einer analytischen Funktion
in der N¨ahe ihrer singul¨aren Stellen
eine Quelle von arithmetischen S¨atzen ist.1
— ERICH HECKE [264, Kap. VIII]
Contents
VI. 1.
A glimpse of basic singularity analysis theory
360
VI. 2.
Coefﬁcient asymptotics for the basic scale
364
VI. 3.
Transfers
372
VI. 4.
The process of singularity analysis
376
VI. 5.
Multiple singularities
381
VI. 6.
Intermezzo: functions of singularity analysis class
383
VI. 7.
Inverse functions
385
VI. 8.
Polylogarithms
390
VI. 9.
Functional composition
393
VI. 10.
Closure properties
399
VI. 11.
Tauberian theory and Darboux’s method
414
VI. 12.
Perspective
418
A function’s singularities are reﬂected in the function’s coefﬁcients. Chapters IV
and V have treated in detail rational fractions and meromorphic functions, where the
local analysis of polar singularities provides contributions to coefﬁcients in the form
of products of polynomials and simple exponentials. In this chapter, we present a
general approach to the analysis of coefﬁcients of generating functions that is not re-
stricted to polar singularities and extends to a very large class of functions that have
moderate growth or decay at their dominant singularities. The basic principle behind
this extension is the existence of a general correspondence between
the asymptotic expansion of a function near its dominant singularities
and
the asymptotic expansion of the function’s coefﬁcients.
This mapping essentially preserves orders of growth in the sense that larger functions
tend to have have larger coefﬁcients. It extends considerably the analysis of mero-
morphic functions in Chapters IV–V and further justiﬁes the Principles of Coefﬁcient
Asymptotics enounced in Chapter IV, p. 215.
1“It is a fact that the precise knowledge of the behaviour of an analytic function in the vicinity of its
singular points is a source of arithmetic properties.”
359

360
VI. SINGULARITY ANALYSIS OF GF’S
Precisely, the method of singularity analysis applies to functions whose singular
expansions involve fractional powers and logarithms—we refer to such singularities
as “algebraic–logarithmic” . It principally relies on two types of results.
— First, it is possible to set up a catalogue of asymptotic expansions for coef-
ﬁcients of the standard functions that occur in such singular expansions
— Second, transfer theorems allow us to extract the asymptotic order of coef-
ﬁcients of error terms from singular expansions with error terms.
The developments are based on Cauchy’s coefﬁcient formula, used in conjunction
with special contours of integration known as Hankel contours. The contours come
very close to the singularities then steer away: By design, they have the property of
capturing essential asymptotic informations contained in the functions’ singularities.
The method of singularity analysis is robust, so that functions amenable to it ben-
eﬁt of being closed under a variety of operations, including sum, product, integration,
differentiation, and composition. Another important feature of the method is that it
only necessitates local asymptotic properties of the function to be analysed. In this
way, it often proves instrumental in the case of functions that are only indirectly ac-
cessible through functional equations.
This chapter is meant to develop the basic technology of singularity analysis and,
like Chapter IV, it is largely of a methodological nature. We illustrate the approach by
a few combinatorial problems, including simple varieties of trees (e.g, unary-binary
trees), combinatorial sums, the supercritical cycle construction, supertrees, P´olya’s
drunkard walks, and tree recurrences. The next chapter, Chapter VII, will systemat-
ically explore combinatorial structures and schemas as well as functional equations
that can be asymptotically analysed by means of singularity analysis in a way that
parallels Chapter V regarding meromorphic asymptotics.
VI. 1. A glimpse of basic singularity analysis theory
Rational and meromorphicfunctions involve locally near a singularity elements of
the form (1−z/ω)−k. Accordingly their coefﬁcients involve asymptotically exponen-
tial polynomials, that is, ﬁnite linear combinations of elements of the type ω−nnk−1,
with k a positive integer. We examine here an approach that takes into account func-
tions whose singularities are of a richer nature than mere poles found in rational and
meromorphic functions. the method, called singularity analysis, applies to functions
whose expansion at a singularity ω involves elements of the form

1 −z
ω
−α 
log
1
1 −z
ω
β
.
Under suitable conditions to be discussed in detail in this chapter, any such element
contributes a term of the form
ω−nnα−1(log n)β.
Here, α and β can be arbitrary real (or even complex) numbers.

VI. 1. A GLIMPSE OF BASIC SINGULARITY ANALYSIS THEORY
361
Location of singularities and exponential factors. The exponential factor ω−n
present in earlier expansions is easily accounted for (see Chapter IV), as the location
of the dominant singularities always induces a multiplicative exponential factor for
coefﬁcients. Indeed, if f(z) is singular at z = ω, then g(z) ≡f(z/ω) satisﬁes, by the
scaling rule of Taylor expansions,
[zn] f(z) = ωn[zn] f( z
ω ) = ωn[zn] g(z),
and g(z) itself is singular on the unit circle, but not inside the disc. Consequently, in
most of the discussion that follows, we shall examine functions f(z) that are singular
at z = 1, a condition that entails no loss of generality.
Basic scale. Consider the following table of commonly encountered functions
that are singular at 1, together with their coefﬁcients:
(1)
Function
Coefﬁcient (exact)
Coefﬁcient (asymptotic)
(f1)
[zn] 1 −
√
1 −z
=
2
n4n
 
2n −2
n −1
!
∼
1
2
√
πn3
(f2)
[zn]
1
√1 −z
=
1
4n
 
2n
n
!
∼
1
√πn
(f3)
[zn]
1
1 −z
=
1
∼
1
(f4)
[zn]
1
1 −z log
1
1 −z
=
Hn
∼
log n
(f5)
[zn]
1
(1 −z)2
=
n + 1
∼
n.
Some structure is apparent in this table: a logarithmic factor in the function is reﬂected
by a similar factor in the coefﬁcients, square-roots somehow induce square-roots, and
functions involving larger powers have larger coefﬁcients.
It is easy to come up at least with a partial explanation of these observations.
Regarding basic functions such as f1, f2, f3, and f5, the Newton expansion
(1 −z)−α =
∞
X
n=0
n + α −1
n

zn
when specialized to an integer k immediately gives the asymptotic form of the coefﬁ-
cients involved,
(2)
[zn](1 −z)−k ≡(n + 1)(n + 2) · · · (n + k −1)
(k −1)!
=
nk−1
(k −1)!

1 + O( 1
n)

.
For general α, it is therefore natural to expect
(3)
[zn](1 −z)−α ≡
n + α −1
α −1

=
nα−1
(α −1)!

1 + O( 1
n)

.
It turns out that this asymptotic formula is valid for real or complex α, provided we
interpret (α −1)! suitably. We shall prove the estimate (see Section VI. 2 and Theo-
rem VI.1)
(4)
[zn](1 −z)−α ∼nα−1
Γ(α)

1 + α(α −1)
2n
+ · · ·

,

362
VI. SINGULARITY ANALYSIS OF GF’S
20
15
10
5
0
z
0.8
0.6
0.4
0.2
f1
f2
f3
f4
f5
8
6
4
2
0
n
12
10
8
6
4
2
f1,n
f2,n
f3,n
f4,n
f5,n
FIGURE VI.1. The ﬁve functions from Eq. (1) and a plot of their coefﬁcient sequences
illustrate the tendency of coefﬁcient extraction to be consistent with orders of growth of
functions.
where Γ(α) is the Euler Gamma function deﬁned as
(5)
Γ(α) :=
Z ∞
0
e−ttα−1 dt,
for ℜ(α) > 0, which coincides with (α −1)! whenever α is an integer. (Basic prop-
erties of this function are recalled in APPENDIX B: Gamma function, p. 689.)
We observe from the pair (2)–(3) that functions that are larger at the singularity
z = 1 have larger coefﬁcients (see Figure 1). The correspondence that this observation
suggests is very general as we are going to see repeatedly throughout this chapter. A
catalogue of exact or asymptotic forms for coefﬁcients of standard singular functions
is obtained in Section VI. 2 (see Theorem VI.1).
Transfer of error terms. An asymptotic expansion of a function f(z) that is sin-
gular at z = 1 is typically of the form
(6)
f(z) = σ(z) + O(τ(z)) where σ(z) ≫τ(z) as z →1,
with σ and τ belonging to an asymptotic scale of standard functions like the collec-
tion {(1 −z)−α}α∈R in simpler cases. Taking formally Taylor coefﬁcients in the
expansion (6), we arrive at
(7)
fn ≡[zn]f(z) = [zn]σ(z) + [zn]O(τ(z)).
The term [zn]σ(z) is described asymptotically by (4). Therefore, in order to extract
asymptotic informations on the coefﬁcients of f(z), one needs a way of extracting
coefﬁcients of functions known only by their order of growth around the singularity.
Such a translation of error terms from functions to coefﬁcients is achieved by transfer
theorems, which, under conditions of analytic continuation, guarantee that
[zn]O(τ(z)) = O([zn]τ(z)).
(See Section VI. 3 and Theorem VI.3.) This relation is much less trivial than its sym-
bolic form would seem to imply.

VI. 1. A GLIMPSE OF BASIC SINGULARITY ANALYSIS THEORY
363
In summary, it is the goal of this chapter to expose the (favorable) conditions un-
der which we have available the correspondence (cf. Section VI. 4 and Theorem VI.4)
(8)
f(z) = σ(z) + O(τ(z))
=⇒
fn = σn + O(τn).
This process of singularity analysis is then seen to parallel the analysis of coefﬁcients
of rational and meromorphic functions presented in the previous two chapters. We
describe the method for functions from the scale
1
(1 −z)α (log
1
1 −z )β
(z →1),
whose coefﬁcients have subexponential factors of the form
θ(n) = nα−1(log n)β.
The range of singular behaviours taken into account by singularity analysis is in fact
considerably larger: iterated logarithms (log log’s) and more exotic functions can be
encapsulated in the method.
EXAMPLE VI.1.
First asymptotics of 2-regular graphs.
As an illustration of the modus
operandi of singularity analysis, consider the function
f(z) = e−z−z2/2
√1 −z ,
which is the EGF of 2–regular graphs (or equivalently, “clouds”, see Note II.21, p. 124). Sin-
gularity analysis permits us to reason as follows. The function f(z) is only singular at z = 1
where it has a branch point. Expanding the numerator around z = 1, we have
(9)
f(z) = e−3/4
√1 −z + O((1 −z)1/2).
Therefore (see Theorems VI.1 and VI.3, as well as the discussion in Example VI.2 below,
p. 378), upon translating formally and term-by-term, one has
(10)
[zn]f(z) = e−3/4
 
n −1/2
n
!
+ O
 
n −3/2
n
!
= e−3/4
√πn + O(n−3/2).
Furthermore, a full asymptotic expansion into descending powers of n can be obtained in the
same way from a full expansion of the numerator e−z/2−z2/4. . . END OF EXAMPLE VI.1. □
Plan of this chapter. The ﬁrst part of this chapter, Sections VI. 2–VI.5, is dedi-
cated to the basic technology of singularity analysis along the lines of our foregoing
discussion, and including the case of functions with ﬁnitely many singularities on the
boundary of their disc of convergence. An “Intermezzo”, Section VI. 6, serves a pre-
lude to the second part of the chapter, where we investigate operations on generating
functions whose effect on singularities is predictable. The most important of these is
inversion, which, under a broad set of conditions, leads to square-root singularity and
provides a uniﬁed asymptotic theory of simple varieties of trees (Section VI. 7). Poly-
logarithms are proved to be amenabe to singularity analysis in Section VI. 8, a fact that
permits us to take into account weights like √n or log n in combinatorial sums. Com-
position of functions is studied in Section VI. 9. Then Section VI. 10 presents several
closure properties of functions of singularity analysis class, including differentiation,
integration, and Hadamard product. The chapter concludes with a brief presentation

364
VI. SINGULARITY ANALYSIS OF GF’S
of two classical alternatives to singularity analysis, Tauberian theory and Darboux’s
method.
VI. 2. Coefﬁcient asymptotics for the basic scale
This section and the next two present the fundamentals of singularity analysis, a
theory which was developed by Flajolet and Odlyzko in [199]. Technically the theory
relies on a systematic use of Hankel contours in Cauchy coefﬁcient integrals. Hankel
contours classically serve to express the Gamma function: see APPENDIX B: Gamma
function, p. 689. Here they are ﬁrst used to estimate coefﬁcients of a standard scale of
functions, and then to prove transfer theorems for error terms in Section VI. 3. With
this basic process, an asymptotic expansion of a function near a singularity is directly
mapped to a matching asymptotic expansion of its coefﬁcients.
Starting from the binomial expansion, we have for general α,
[zn](1 −z)−α = (−1)n
−α
n

=
n + α −1
n

= α(α + 1) · · · (α + n −1)
n!
.
This quantity is expressible in terms of Gamma factors, and
(11)
n + α −1
n

=
Γ(n + α)
Γ(α)Γ(n + 1),
provided α is neither 0 nor a negative integer. (When α ∈{0, −1, . . .}, the coefﬁcients
 n+α−1
n

eventually vanish, so that the asymptotic problem of estimating [zn](1 −
z)−α becomes void.) The asymptotic analysis of the coefﬁcients
 n+α−1
n

can be
carried out elementarily by means of Stirling’s formula and real integral estimates:
see Notes 1 and 2.
A method far more productive than elementary real analysis techniques consists
in analysing coefﬁcients of a function f(z) by means of Cauchy’s coefﬁcient formula,
[zn]f(z) =
1
2iπ
Z
γ
f(z) dz
zn+1 .
The basic principle is extremely simple: it consists in choosing a contour of integra-
tion γ that comes at distance 1
n of the singularity z = 1. Under the change of variables
z = 1 + t/n, the kernel z−n−1 in the integral transforms into an exponential, and the
function can be locally expanded, with the differential coefﬁcient only introducing a
rescaling factor of 1/n:
(12)
z
7→

1 + t
n

,
dz
7→
1
ndt
1
zn+1
7→
e−t,
(1 −z)−α
7→
nα(−t)−α.
This gives us for instance (precise justiﬁcation below):
[zn](1 −z)−α ∼gαnα−1,
gα :=
1
2iπ
Z
e−t(−t)−α dt.
The contour and the associated rescaling “capture” the behaviour of the function near
its singularity, thereby enabling coefﬁcient estimation.

VI. 2. COEFFICIENT ASYMPTOTICS FOR THE BASIC SCALE
365
0
2/n
1
0
1
1/2
R
FIGURE VI.2. The contours C0, C1, and C2 ≡H(n) used for estimating the coefﬁcients
of functions from the standard asymptotic scale.
Theorem VI.1 (Standard function scale). Let α be an arbitrary complex number in
C \ Z≤0. The coefﬁcient of zn in
f(z) = (1 −z)−α
admits for large n a full asymptotic expansion in descending powers of n,
[zn]f(z) ∼na−1
Γ(α)
 
1 +
∞
X
k=1
ek
nk
!
,
where ek is a polynomial in α of degree 2k. In particular:
(13)
[zn]f(z)
∼
nα−1
Γ(α)

1 + α (α −1)
2 n
+ α (α −1) (α −2) (3 α −1)
24 n2
+α2 (α −1)2 (α −2) (α −3)
48 n3
+ · · ·

.
The quantity ek is a polynomial in α that is divisible by (α−1) · · · (α−k), in accordance with
the fact that the asymptotic expansion terminates when α ∈Z≥1. The factor 1/Γ(α) vanishes
when α ∈Z≤0, in accordance with the fact that coefﬁcients are asymptotically 0 in that case.
PROOF. The ﬁrst step is to express the coefﬁcient [zn](1 −z)−α as a complex integral
by means of Cauchy’s coefﬁcient formula,
(14)
fn =
1
2iπ
Z
C
(1 −z)−α
dz
zn+1 ,
where C is a small enough contour that encircles the origin; see Figure 2. For instance,
we can start with C ≡C0, where C0 is the positively oriented circle C0 = {z, |z| = 1
2}.
The second step is to deform C0 into another simple closed curve C1 around the origin
that does not cross the half-line ℜ(z) ≥1: the contour C1 consists of a large circle
of radius R > 1 with a notch that comes back near and to the left of z = 1. Since
the integrand along large circles decreases as O(R−n−α), we can ﬁnally let R tend to
inﬁnity and are left with an integral representation for fn where C has been replaced
by a contour C2 that starts from +∞in the lower half plane, winds clockwise around
1, and ends at +∞in the upper half plane. This is a typical case of a Hankel contour.
A judicious choice of its distance to the half-line R≥1 yields the expansion.

366
VI. SINGULARITY ANALYSIS OF GF’S
To specify precisely the integration path, we particularize C2 to be the contour
H(n) that passes at a distance 1
n from the half line R≥1:
(15)
H(n) = H−(n) + H+(n) + H◦(n)
where
(16)



H−(n)
=
{z = w −i
n, w ≥1}
H+(n)
=
{z = w + i
n, w ≥1}
H◦(n)
=
{z = 1 −eiφ
n , φ ∈[−π
2 , π
2 ]}.
Now, a change of variable
(17)
z = 1 + t
n
in the integral (14) gives the form
(18)
fn = nα−1
2iπ
Z
H
(−t)−α

1 + t
n
−n−1
dt.
(The Hankel contour H is the same as in the proof of Theorem B.1, 691.)
We have the asymptotic expansion
(19)

1 + t
n
−n−1
= e−(n+1) log(1+t/n) = e−t

1 + t2 −2t
2n
+ 3t4 −20t3 + 24t2
24n2
+ · · ·

,
which tells us that the integrand in (18) converges pointwise (as well as uniformly
in any bounded domain of the t plane) to (−t)−αe−t. This quantity is precisely the
kernel that appears in Hankel’s formula for the Gamma function (p. 691). Substitution
of the asymptotic form

1 + t
n
−n−1
= e−t

1 + O( 1
n)

,
as n →∞inside the integral (18) suggests (formally) that
[zn](1 −z)−α = nα−1
Γ(α)

1 + O( 1
n)

.
To justify the formal argument outlined in the previous paragraph, we proceed as
follows:
(i) Split the contour according to ℜ(t) ≤log2 n and ℜ(t) ≥log2 n, as in the
corresponding diagram:
(20)
0
log2 n
2
.
(ii) Verify that the part corresponding to ℜ(t) ≥log2 n is negligible in the scale
of the problem. For instance, one has

1 + t
n
−n
= O(exp(−log2 n))
for ℜ(t) ≥log2 n.

VI. 2. COEFFICIENT ASYMPTOTICS FOR THE BASIC SCALE
367
n = 10
n = 20
n = 50
4n
√
πn3
`
1
1 8708
6 935533866
2022877684829178931751713264
−9
8 n−1
16 603
65 45410086
197 7362936920522405787299715
+ 145
128 n−2
16 815
656 5051735
19782 79553371460627490749710
−1155
1024 n−3
1679 4
6564 073885
1978261 300061101426696482732
+ 36939
32768 n−4
16796
656412 2750
19782616 64919884629357813591
−295911
262144 n−5
16796
6564120 303
1978261657 612856326190245636
+ 4735445
4194304 n−6
16796
656412042 6
197826165775 9023715384519184
−37844235
33554432 n−7´
16796
6564120420
19782616577561 03402179527600
Cn
16796
6564120420
1978261657756160653623774456
FIGURE VI.3. Improved approximations to the Catalan numbers obtained by successive
terms of their asymptotic expansion.
(iii) Use a terminating form of (19) to develop an expansion to any predeter-
mined order, with uniform error terms, for the part corresponding to ℜ(t) ≤
log2 n. (This is possible because t/n = O(log2 n/n) is small.)
These considerations validate term-by-term integration of expansion (19) within the
integral of (18), so that the full expansion of fn is determined as follows: A term of
the form tr/ns in the expansion (19) induces, by Hankel’s formula, a term of the form
n−s/Γ(α −r). (The expansion so obtained is nondegenerate provided α differs from
a negative integer or zero; see also Note 3 for details.) Since
1
Γ(α −k) =
1
Γ(α)(α −1)(α −2) · · · (α −k).
the expansion in the statement of the theorem eventually follows.
□
The asymptotic approximations obtained from Theorem VI.2 differ from the ones
that are associated with meromorphic asymptotics, (Chapter IV), where exponentially
small error terms could be derived. However, it is not uncommon to obtain results
with about 10−6 accuracy, already for values of n in the range 101–102 with just a few
terms of the asymptotic expansion. Figure 3 exempliﬁes this situation by displaying
the approximations obtained for the Catalan numbers,
Cn =
4n
n + 1[zn](1 −z)−1/2,
when C10, C20, C50 are considered and up to eight asymptotic terms are taken into
account.
 VI.1. Stirling’s formula and asymptotics of binomial coefﬁcients. The Gamma function
form (11) of the binomial coefﬁcients yields
[zn](1 −z)−α = nα−1
Γ(α)
„
1 + O( 1
n)
«
,
when Stirling’s formula is applied to the Gamma factors.


368
VI. SINGULARITY ANALYSIS OF GF’S
 VI.2. Beta integrals and asymptotics of binomial coefﬁcients. A direct way of obtaining the
general asymptotic form of
`n+α−1
n
´
bases itself on the Eulerian Beta integral (see [492, p.254]
and APPENDIX B: Gamma function, p. 689). Consider the quantity
φ(n, α) =
Z 1
0
tα−1(1 −t)n−1 dt =
(n −1)!
α(α + 1) · · · (α + n −1) ≡
1
n
`n+α−1
n
´,
where the second form results elementarily from successive integrations by parts. The change
of variables t = x/n yields
φ(n, α) = 1
nα
Z n
0
xα−1(1 −x/n)n−1 dt
∼
n→∞
1
nα
Z ∞
0
xα−1e−x dx ≡Γ(α)
nα ,
where the asymptotic form results from the standard limit formula of the exponential: exp(a) =
limn→∞(1 + a/n)n.

 VI.3. Computability of full expansions. The coefﬁcients ek of Theorem VI.1 satisfy
ek =
2k
X
ℓ=k
λk,ℓ(α −1)(α −2) · · · (α −ℓ),
where λk,ℓ:= [vktℓ]et(1 + vt)−1−1/v.

 VI.4. Oscillations and complex exponents. Oscillations occur in the case of singular expan-
sions involving complex exponents. From the consideration of [zn](1 −z)±i ≍n∓i−1, one
ﬁnds
[zn] cos
„
log
1
1 −z
«
= P(log n)
n
+ O( 1
n2 ),
where P(u) is a continuous and 1–periodic function. In general, such oscillations are present
in [zn](1 −z)−α for any nonreal α.

Logarithmic factors. The basic principle underlying the method of proof of The-
orem VI.1 (see also the summary Equation (12)) has the advantage of being easily
extended to a wide class of singular functions, most notably the ones that involve
logarithmic terms.
Theorem VI.2 (Standard function scale, logarithms). Let α be an arbitrary complex
number in C \ Z≤0. The coefﬁcient of zn in
f(z) = (1 −z)−α
1
z log
1
1 −z
β
admits for large n a full asymptotic expansion in descending powers of log n,
(21)
fn = [zn]f(z) ∼nα−1
Γ(α) (log n)β

1 + C1
log n +
C2
log2 n + · · ·

,
where Ck = (−1)k β
k

Γ(α) dk
dsk
1
Γ(s)

s=α.
A coefﬁcient of 1/z is introduced in front of the logarithm since log(1 −z)−1 =
z + O(z2). In this way, f(z) is a bona ﬁde power series in z, even in cases when β is
not a positive integer.

VI. 2. COEFFICIENT ASYMPTOTICS FOR THE BASIC SCALE
369
PROOF. The proof is a simple variant of that of Theorem VI.1 (see [199] for details).
The basic expansion used is now
f(1 + t
n)(1 + t
n)−n−1 ∼e−t
−n
t
α 
log
−n
t
β
∼e−t(−t)−αnα(log n)β

1 −log(−t)
log n
β
∼e−t(−t)−αnα(log n)β
 
1 −β log(−t)
log n
+ β(β −1)
2!
log(−t)
log n
2
+ · · ·
!
.
Again, we are justiﬁed in using this expansion inside Cauchy’s integral representation
of coefﬁcients. What comes out from term by term integration is a collection of Hankel
integrals of the form
−1
2iπ
Z (0)
+∞
(−t)−se−t(log(−t))k dt
which reduce to derivatives of 1/Γ(s), as is seen by differentiation with respect to s
under the integral sign.
□
A typical example of application of Theorem VI.2 is the estimate
[zn]
1
√1 −z
1
1
z log
1
1−z
=
1
√πn log n

1 −γ + 2 log 2
log n
+ O(
1
log2 n)

.
(Such singular functions do occur in combinatorics and the analysis of algorithms [209].)
 VI.5. Singularity analysis of slowly varying functions. A function M(u) is said to be slowly
varying towards inﬁnity (in the complex plane) if for any ﬁxed λ > 0 and all θ satisfying
|θ| ≤π −φ for some φ ∈(0, π
2 ), there holds
lim
u→+∞
M(λeiθu)
M(u)
= 1.
(Powers of logarithms and iterated logarithms are typically slowly varying functions.) Under
suitable uniformity assumptions, one has [199]
(22)
[zn]
1
(1 −z)α M
„
1
1 −z
«
∼nα−1
Γ(α) M(n).
For instance: [zn]
exp
“q
1
z log
1
1−z
”
√1 −z
∼exp
`√log n
´
√πn
. See also the discussion of Tauberian
theory, p. 416.

 VI.6. Iterated logarithms. For a general α ̸∈Z≤0, the relation (22) specializes to
[zn](1 −z)−α
„1
z log
1
1 −z
«β „1
z log
„1
z log
1
1 −z
««δ
∼nα−1
Γ(α) (log n)β(log log n)δ.
A full asymptotic expansion can be derived in this case.


370
VI. SINGULARITY ANALYSIS OF GF’S
α ̸∈{0, −1, −2, . . .}
(Eq.)
α ∈{0, −1, −2, . . .}
(Eq.)
β ̸∈Z≥0
nα−1
Γ(α) (log n)β
∞
X
j=0
Cj
(log n)j
(21)
fn ∼nα−1(log n)β
∞
X
j=1
Dj
(log n)j
(23)
β ∈Z≥0
nα−1
Γ(α)
∞
X
j=0
Ej(log n)
nj
(24)
nα−1
∞
X
j=0
Fj(log n)
nj
(26)
FIGURE VI.4. The general and special cases of fn ≡[zn]f(z) when f(z) is as in
Theorem VI.2.
Special cases. The conditions of Theorems VI.1 and VI.2 exclude explicitly the
case when α is a negative integer: the formulæ actually remain valid in this case,
provided one interprets them as limit cases, making use of 0 = 1/Γ(0) = 1/Γ(−1) =
· · · . Also, when β is a positive integer, the expansion of Theorem VI.2 terminates:
in that situation, stronger forms are valid. Such cases are summarized in Figure 4 and
discussed below.
The case of integral α ∈Z≤0 and general β ̸∈Z≥0. When α is a negative
integer, the coefﬁcients of f(z) = (1 −z)−α eventually reduce to zero, so that the
asymptotic coefﬁcient expansion becomes trivial: this situation is implicitly covered
by the statement of Theorem VI.1 since, in that case, 1/Γ(α) = 0. When logarithms
are present (with α ∈Z≤0 still), the expansion of Theorem VI.2 regarding
f(z) = (1 −z)−α
1
z log
1
1 −z
β
remains valid provided we again take into account the equality 1/Γ(α) = 0 in for-
mula (21) after effecting simpliﬁcations by Gamma factors: It is only the ﬁrst term
of (21) that vanishes, and one has
(23)
[zn]f(z) ∼nα−1 (log n)β
 D1
log n +
D2
log2 n + · · ·

,
where Dk is given by Dk = (−1)k
β
k
 dk
dsk
1
Γ(s)

s=α
. For instance, we ﬁnd
[zn]
z
log(1 −z)−1 = −
1
n log2 n +
2γ
n log3 n + O(
1
n log4 n).
The case of general α ̸∈Z≤0 and integral β ∈Z≥0. When β is a nonnegative
integer, the error terms can be further improved with respect to the ones predicted by
the general statement of Theorem VI.2. For instance, we have:
[zn]
1
1 −z log
1
1 −z
=
log n + γ + 1
2n −
1
12n2 + O( 1
n4 )
[zn]
1
√1 −z log
1
1 −z
∼
1
√πn

log n + γ + 2 log 2 + O(log n
n
)

.
(In such a case, the expansion of Theorem VI.2 terminates since only its ﬁrst (k +
1) terms are nonzero.) In fact, in the general case of nonintegral α, there exists an

VI. 2. COEFFICIENT ASYMPTOTICS FOR THE BASIC SCALE
371
expansion of the form
(24)
[zn](1 −z)−α logk
1
1 −z ∼nα−1
Γ(α)

E0(log n) + E1(log n)
n
+ · · ·

,
where the Ej are polynomials of degree k, as can be proved by adapting the argument
employed for general α (see also Note 8).
The joint case of integral α ∈Z≤0 and integral β ∈Z≥0. If α is a negative inte-
ger, the coefﬁcients appear as ﬁnite differences of coefﬁcients of logarithmic powers.
Explicit formulæ are then available elementarily from the calculus of ﬁnite differences
when β is a positive integer. For instance, with α = −r for r ∈Z≥0, one has
(25)
[zn](1 −z)r log
1
1 −z = (−1)r
r!
n(n −1) · · · (n −r).
The case α = −r and β = k (with r, k ∈Z≥0) is covered by (27) in Note 7 below:
there is a formula analogous to (24),
(26)
[zn](1 −z)r logk
1
1 −z ∼n−r−1

F0(log n) + F1(log n)
n
+ · · ·

,
but now with deg(Fj) = k −1.
A table of the asymptotic form of coefﬁcients of a few standard functions illus-
trating Theorems VI.1 and VI.2 as well as some of the “special cases” is given in
Figure 5.
 VI.7. The method of Frobenius and Jungen. This is an alternative approach to the case
β ∈Z≥0 (see [287]). Start from the observation that
(1 −z)−α
„
log
1
1 −z
«k
= ∂k
∂αk (1 −z)−α.
and allow the operators of differentiation ( ∂/∂α ) and coefﬁcient extraction ( [zn] ) to commute—
this can be justiﬁed by Cauchy’s coefﬁcient formula upon differentiating under the integral
sign—, which yields
(27)
[zn](1 −z)−α
„
log
1
1 −z
«k
= ∂k
∂αk
Γ(n + α)
Γ(α)Γ(n + 1),
and leads to an “exact” formula (Note 8 below).

 VI.8. Shifted harmonic numbers. Deﬁne the α-shifted harmonic number by
hn(α) :=
n−1
X
j=0
1
j + α.
Set L(z) := −log(1 −z). Then, one has
[zn](1 −z)−αL(z)
=
 
n + α −1
n
!
hn(α)
[zn](1 −z)−αL(z)2
=
 
n + α −1
n
!
`
h′
n(α) + hn(α)2´
.
(Note: hn(α) = ψ(α + n) −ψ(α), where ψ(s) := ∂s log Γ(s).) In particular,
[zn]
1
√1 −z log
1
1 −z = 1
4n
 
2n
n
!
[2H2n −Hn],

372
VI. SINGULARITY ANALYSIS OF GF’S
Function
Coefﬁcients
(1 −z)3/2
1
√
πn5 (3
4 + 45
32n + 1155
512n2 + O( 1
n3 ))
(1 −z)
(0)
(1 −z)1/2
−
1
√
πn3 (1
2 +
3
16n +
25
256n2 + O( 1
n3 ))
(1 −z)1/2L(z)
−
1
√
πn3 (1
2 log n + γ + 2 log 2 −2
2
+ O(log n
n
))
(1 −z)1/3
−
1
3Γ( 2
3)n4/3 (1 + 2
9n +
7
81n2 + O( 1
n3 ))
z/L(z)
1
n log2 n(−1 +
2γ
log n + π2 −6γ2
2 log2 n + O(
1
log3 n))
1
(0)
log(1 −z)−1
1
n
log2(1 −z)−1
1
n(2 log n + 2γ −1
n −
1
6n2 + O( 1
n4 ))
(1 −z)−1/3
1
Γ( 1
3)n2/3 (1 + O( 1
n))
(1 −z)−1/2
1
√πn(1 −1
8n +
1
128n2 +
5
1024n3 + O( 1
n4 ))
(1 −z)−1/2L(z)
1
√πn(log n + γ + 2 log 2 −log n + γ + 2 log 2
8n
+ O(log n
n2 ))
(1 −z)−1
1
(1 −z)−1L(z)
log n + γ + 1
2n −
1
12n2 +
1
120n4 + O( 1
n6 ))
(1 −z)−1L(z)2
log2 n + 2γ log n + γ2 −π2
6 + O(log n
n
)
(1 −z)−3/2
r
n
π (2 + 3
4n −
7
64n2 + O( 1
n3 ))
(1 −z)−3/2L(z)
r
n
π (2 log n + 2γ + 4 log 2 −4 + 3 log n
4n
+ O( 1
n))
(1 −z)−2
n + 1
(1 −z)−2L(z)
n log n + (γ −1)n + log n + 1
2 + γ + O( 1
n)
(1 −z)−2L(z)2
n(log2 n + 2(γ −1) log n + γ2 −2γ + 2 −π2
6 + O(log n
n
))
(1 −z)−3
1
2n2 + 3
2n + 1
FIGURE VI.5. A table of some commonly encountered functions (with L(z) :=
log(1/(1 −z))) and the asymptotic forms of their coefﬁcients.
where Hn ≡hn(1) is the usual harmonic number.

VI. 3. Transfers
Our general objective is to translate an approximation of a function near a sin-
gularity into an asymptotic approximation of its coefﬁcients. What is required at this
stage is a way to extract coefﬁcients of error terms (known usually in O(·) or o(·)

VI. 3. TRANSFERS
373
.............................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................
...............................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................
.......................................................................................................
0
1
φ
(∆)

R
...........................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................
..............................................................................................
................................
................................
....................
0
1
θ
γ

I

r
1/n
FIGURE VI.6. A ∆–domain and the contour used to establish Theorem VI.3.
form) in the expansion of a function near a singularity. This task is technically simple
as a fairly coarse analysis sufﬁces. Like in the previous section, it relies on contour
integration by means of Hankel-type paths; see for instance the summary in Eq. (12)
above.
A natural extension of the approach of the previous section is to assume the error
terms valid in the complex plane slit along the real half line R≥1. In fact weaker
conditions sufﬁce and any domain whose boundary makes an acute angle with the
half line R≥1 appears to be suitable.
Deﬁnition VI.1. Given two numbers φ, R with R > 1 and 0 < φ < π
2 , the open
domain ∆(φ, R) is deﬁned as
∆(φ, R) = {z
 |z| < R, z ̸= 1, | Arg(z −1)| > φ}.
A domain is a ∆–domain if it is a ∆(φ, R) for some R and φ. A function is ∆–analytic
if it is analytic in some ∆–domain.
Analyticity in a ∆–domain (Figure 6, left) is the basic condition for transfer to
coefﬁcients of error terms in asymptotic expansions.
Theorem VI.3 (Transfer, Big-Oh and little-oh). Let α, β be arbitrary real numbers,
α, β ∈R and let f(z) be a function that is ∆–analytic.
(i) Assume that f(z) satisﬁes in the intersection of a neighbourhood of 1 with its
∆–domain the condition
f(z) = O

(1 −z)−α(log
1
1 −z )β

.
Then one has:
[zn]f(z) = O(nα−1(log n)β).
(ii) Assume that f(z) satisﬁes in the intersection of a neighbourhood of 1 with its
∆–domain the condition
f(z) = o

(1 −z)−α(log
1
1 −z )β

.
Then one has:
[zn]f(z) = o(nα−1(log n)β).

374
VI. SINGULARITY ANALYSIS OF GF’S
PROOF. (i) The starting point is Cauchy’s coefﬁcient formula,
fn ≡[zn]f(z) =
1
2iπ
Z
γ
f(z) dz
zn+1 ,
where γ is any simple loop around the origin which is internal to the ∆–domain of f.
We choose the positively oriented contour (Figure 6, right) γ = γ1 ∪γ2 ∪γ3 ∪γ4,
with
8
>
>
>
>
>
<
>
>
>
>
>
:
γ1
=
{ z
˛˛ |z −1| = 1
n, | Arg(z −1)| ≥θ] }
(inner circle)
γ2
=
{ z
˛˛ 1
n ≤|z −1|, |z| ≤r, Arg(z −1) = θ }
(rectilinear part, top)
γ3
=
{ z
˛˛ |z| = r, | Arg(z −1)| ≥θ] }
(outer circle)
γ4
=
{ z
˛˛ 1
n ≤|z −1|, |z| ≤r, Arg(z −1) = −θ }
(rectilinear part, bottom).
If the ∆domain of f is ∆(φ, R), we assume that 1 < r < R, and φ < θ < π
2 , so that
the contour γ lies entirely inside the domain of analyticity of f.
For j = 1, 2, 3, 4, let
f (j)
n
=
1
2iπ
Z
γj
f(z) dz
zn+1 .
The analysis proceeds by bounding the absolute value of the integral along each of
the four parts. In order to keep notations simple, we detail the proof in the case where
β = 0.
(1) Inner circle (γ1). From trivial bounds, the contribution from γ1 satisﬁes
|f (1)
n | = O( 1
n) · O

( 1
n)−α

= O
 nα−1
,
as the function is O(nα) (by assumption on f(z)), the contour has length
O(n−1), and z−n−1 remains O(1) on this part of the contour.
(2) Rectilinear parts (γ2, γ4). Consider the contribution f (2)
n
arising from the
part γ2 of the contour. Setting ω = eiθ, and performing the change of
variable z = 1 + ωt
n , we ﬁnd
|f (2)
n | ≤1
2π
Z ∞
1
K
 t
n
−α 1 + ωt
n

−n−1
dt,
for some constant K > 0 such that |f(z)| < K(1 −z)−α over the ∆–
domain, which is granted by the growth assumption on f. From the relation
1 + ωt
n
 ≥1 + ℜ(ωt
n ) = 1 + t
n cos θ,
there results the inequality
|f (2)
n | ≤K
2π Jnnα−1,
where
Jn =
Z ∞
1
t−α

1 + t cos θ
n
−n
dt.

VI. 3. TRANSFERS
375
For a given α, the integrals Jn are all bounded above by some constant since
they admit a limit as n tends to inﬁnity:
Jn →
Z ∞
1
t−αe−t cos θ dt.
The condition on θ that 0 < θ < π
2 precisely ensures convergence of the
integral. Thus, globally, on the part γ2 of the contour, we have
|f (2)
n | = O(nα−1).
A similar bound holds for f (4)
n
relative to γ4.
(3) Outer circle (γ3). There, f(z) is bounded while z−n is of the order of r−n.
Thus, the integral f (3)
n
is exponentially small.
In summary, each of the four integrals of the split contour contributes O(nα−1). The
statement of Part (i) of the theorem thus follows.
(ii) An adaptation of the proof shows that o(.) error terms may be translated
similarly. All that is required is a further breakup of the rectilinear part at a distance
log2 n/n from 1 (see Equation (20) or [199] for details).
□
An immediate corollary of Theorem VI.3 is the possibility of transferring asymp-
totic equivalence from singular forms to coefﬁcients:
Corollary VI.1 (sim–transfer). Assume that f(z) is ∆–analytic and
f(z) ∼(1 −z)−α,
as z →1,
z ∈∆,
with α ̸∈{0, −1, −2, · · ·}. Then, the coefﬁcients of f satisfy
[zn]f(z) ∼nα−1
Γ(α) .
PROOF. It sufﬁces to observe that, with g(z) = (1 −z)−α, one has
f(z) ∼g(z)
iff
f(z) = g(z) + o(g(z)),
then apply Theorem VI.1 to the ﬁrst term, and Theorem VI.3 (little-oh transfer) to the
remainder.
□
 VI.9. Transfer of nearly polynomial functions. Let f(z) be ∆–singular and satisfy the singu-
lar expansion f(z) ∼(1 −z)r, where r ∈Z≥0. Then, fn = o(n−r−1). [This is also a direct
consequence of the little-oh transfer.]

 VI.10. Transfer of large negative exponents. The ∆–analyticity condition can be weakened
for functions that are large at their singularity. Assume that f(z) is analytic in the open disk
|z| < 1, and that in the whole of the open disk it satisﬁes
f(z) = O((1 −z)−α).
Then, provided α > 1, one has
[zn]f(z) = O(nα−1).
[Hint. Integrate on the circle of radius 1 −1
n; see also [199].]


376
VI. SINGULARITY ANALYSIS OF GF’S
VI. 4. The process of singularity analysis
In Sections VI. 2 and VI. 3, we have developed a collection of statements granting
the existence of correspondences between properties of a function f(z) singular at an
isolated point (z = 1) and the asymptotic behaviour of its coefﬁcients fn = [zn]f(z).
Using the symbol ‘•—◮’ to represent such a correspondence2, we can summarize some
of our results relative to the scale S = {(1 −z)−α, α ∈C \ Z≤0} as follows:















f(z) = (1 −z)−α
•——◮
fn = nα−1
Γ(α) + · · ·
(Theorem VI.1)
f(z) = O((1 −z)−α)
•——◮
fn = O(nα−1)
(Theorem VI.3 (i))
f(z) = o((1 −z)−α)
•——◮
fn = o(nα−1)
(Theorem VI.3 (ii))
f(z) ∼(1 −z)−α
•——◮
fn ∼nα−1
Γ(α)
(Cor. VI.1).
The important requirement is that the function should have an isolated singularity (the
condition of ∆–analyticity) and that the asymptotic property of the function near its
singularity should be valid in an area of the complex plane extending beyond the disk
of convergence of the original series, (in a ∆–domain). Extensions to logarithmic
powers and special cases like α ∈Z≤0 are also, as we know, available. We let S
denote the set of such singular functions:
(28)
S =

(1 −z)−αλ(z)β  α, β ∈C
	
,
λ(z) := 1
z log
1
1 −z .
At this stage, we thus have available tools by which, starting from the expansion
of a function at its singularity, also called singular expansion, one can justify the term-
by-term transfer from an approximation of the function to an asymptotic estimate of
the coefﬁcients. We state:
Theorem VI.4 (Singularity analysis, single singularity). Let f(z) be function analytic
at 0 with a singularity at ζ, such that f(z) can be continued to a domain of the form
ζ · ∆0, for a ∆-domain ∆0, where ζ · ∆0 is the image of ∆0 by the mapping z 7→ζz.
Assume that there exist two functions σ, τ, where σ is a (ﬁnite) linear combination of
functions in S and τ ∈S, so that
f(z) = σ (z/ζ) + O (τ (z/ζ))
as
z →ζ
in
ζ · ∆0.
Then, the coefﬁcients of f(z) satisfy the asymptotic estimate
fn = ζ−nσn + O(ζ−nτ ⋆
n),
where σn = [zn]σ(z) has its coefﬁcients determined by Theorems VI.1, VI.2 and
τ ⋆
n = na−1(log n)b, if τ(z) = (1 −z)−aλ(z)b.
We observe that the statement is equivalent to τ ⋆
n = [zn]τ(z), except when a ∈Z≤0 (when
the 1/Γ(a) factor should be omitted). Also, generically, we have τ ⋆
n = o(σn), so that orders of
growth of functions at singularities are mapped to orders of growth of coefﬁcients.
2The symbol ‘=⇒’ represents an unconditional logical implication and is accordingly used in this
book to represent the systematic correspondence between combinatorial speciﬁcations and generating func-
tion equations. In contrast, the symbol ‘•—◮’ represents a mapping from functions to coefﬁcients, under
suitable analytic conditions as stated in Theorems VI.1–VI.3.

VI. 4. THE PROCESS OF SINGULARITY ANALYSIS
377
Let f(z) be a function analytic at 0 whose coefﬁcients are to be asymptotically analysed.
1. Preparation. This consists in locating dominant singularities and checking analytic continu-
ation.
1a. Locate singularities. Determine the dominant singularities of f(z) (assumed not to
be entire). Check that f(z) has a single singularity ζ on its circle of convergence.
1b. Check continuation. Establish that f(z) is analytic in some domain of the form ζ∆0.
2. Singular expansion. Analyse the function f(z) as z →ζ in the domain ζ∆0 and determine
in that domain an expansion of the form
f(z) =
z→1 σ(z/ζ) + O(τ(z/ζ))
with
τ(z) ≪σ(z).
For the method to succeed, the functions σ and τ should belong to the standard scale of func-
tions S = {(1 −z)−αλ(z)β}, with λ(z) := z−1 log(1 −z)−1.
3. Transfer Translate the main term term σ(z) using the catalogues provided by TheoremsVI.1
and VI.2. Transfer the error term (Theorem VI.3) and conclude that
[zn]f(z)
=
n→+∞ζ−nσn + O
`
ζ−nτ ⋆
n
´
,
where σn = [zn]σ(z) and τ ⋆
n = [zn]τ(z) provided the corresponding exponent α ̸∈Z≤0
(otherwise, the factor 1/Γ(α) = 0 should be dropped).
FIGURE VI.7. A summary of the singularity analysis process (single dominant singularity).
PROOF. The normalized function g(z) = f(z/ζ) is singular at 1. It is ∆-analytic and
satisﬁes the relation g(z) = σ(z) + O(τ(z)) as z →1 within ∆0. Theorem VI.3, (i)
(the big-Oh transfer) applies to the O-error term. The statement follows ﬁnally since
[zn]f(z) = ζ−n[zn]g(z).
□
The statement of Theorem VI.4 can be concisely expressed by the correspon-
dence:
(29) f(z) =
z→1 σ(z/ζ)+O (τ(z/ζ))
•——◮
fn
=
n→∞ζ−nσn +O(ζ−nτ ⋆
n).
The conditions of analytic continuation and validity of the expansion in a ∆–domain
are essential. Similarly, we have
(30)
f(z) =
z→1 σ (z/ζ)) + o (τ (z/ζ))
•——◮
fn
=
n→∞ζ−nσn + O(ζ−nτ ⋆
n),
as a simple consequence of Theorem VI.3, part (ii) (little-oh transfer). The map-
pings (29) and (30) supplemented by the accompanying analysis constitute the heart
of the singularity analysis process summarized in Figure 7.
Many of the functions commonly encountered in analysis are found to be ∆–
continuable. This fact results from the property of the elementary functions (like √,
log, tan) to be continuable to larger regions than what their expansions imply, as well
as to the rich set of composition properties that analytic functions satisfy. Also, asymp-
totic expansions at a singularity initially determined along the real axis by elementary
real analysis often hold in much wider regions of the complex plane. The singularity
analysis process is then likely to be applicable to a large number of generating func-
tions that are provided by the symbolic method—most notably the iterative structures
described in Section IV. 4 (p. 236). In such cases, singularity analysis greatly reﬁnes

378
VI. SINGULARITY ANALYSIS OF GF’S
the exponential growth estimates obtained in Theorem IV.8 (p. 237). The condition is
that singular expansions should be of a suitably moderate3 growth. We illustrate this
situation now by treating combinatorial generating functions obtained by the symbolic
methods of Chapters I and II, for which explicit expressions are available.
EXAMPLE VI.2. Asymptotics of 2-regular graphs. This example completes the discussion of
Example 1, p. 363. The labelled class C of 2-regular graphs satisﬁes
C = SET(UCYC≥3(Z))
=⇒
C(z) = exp
„1
2
„
log(1 −z)−1 −z −z2
2
««
,
where UCYC is the undirected cycle construction (Note II.21, p. 124). For this example, we
follow step by step the singularity analysis process as summarized in Figure 7.
1. Preparation. The function C(z) being the product of e−z/2−z2/4 (that is entire) and
of (1 −z)−1/2 (that is analytic in the unit disk) is itself analytic in the unit disk. Also, since
(1 −z)−1/2 is ∆–analytic (it is well-deﬁned and analytic in the complex plane slit along R≥1),
C(z) is itself ∆–analytic, with a singularity at z = 1.
2. Singular expansion. The asymptotic expansion of C(z) near z = 1 is obtained starting
from the standard (analytic) expansion of e−z/2−z2/4 at z = 1,
e−z/2−z2/4 = e−3/4 + e−3/4(1 −z) + e−3/4
4
(1 −z)2 −e−3/4
12
(1 −z)3 + · · · .
The factor (1 −z)−1/2 is its own asymptotic expansion, clearly valid in any ∆–domain. Per-
forming the multiplication yields a complete expansion,
(31)
C(z) ∼e−3/4
√1 −z + e−3/4√
1 −z + e−3/4
4
(1 −z)3/2 −e−3/4
12
(1 −z)5/2 + · · · ,
out of which terminating forms can be extracted.
3. Transfer. Take for instance the expansion of (31) limited to two terms plus an error
term. The singularity analysis process allows the transfer of (31) to coefﬁcients, which we can
present in tabular form as follows:
˛˛˛˛˛˛˛˛˛˛˛˛˛˛˛
C(z)
cn ≡[zn]C(z)
e−3/4
1
√1 −z
e−3/4
 
n −1/2
−1/2
!
∼e−3/4
√πn
»
1 −1
8n +
1
128n2 + · · ·
–
+ e−3/4√
1 −z
+e−3/4
 
n −3/2
−3/2
!
∼−e−3/4
2
√
πn3
»
1 + 3
8n + · · ·
–
+ O((1 −z)3/2)
+O(
1
n5/2 ).
Terms are then collected with expansions suitably truncated to the coarsest error term, so that
here a 3–term expansion results. In the sequel, we shall no longer need to detail such compu-
tations and we shall content ourselves with putting in parallel the function’s expansion and the
coefﬁcient’s expansion like in the following correspondence:
C(z) = e−3/4
√1 −z +e−3/4√
1 −z+O((1−z)3/2)
•——◮
cn = e−3/4
√πn −5e−3/4
8
√
πn3 +O(
1
n5/2 ).
3For functions with fast growth at a singularity, the saddle-point method developed in Chapter VIII
becomes effectual.

VI. 4. THE PROCESS OF SINGULARITY ANALYSIS
379
Here is a numerical check. Set c(1)
n
:= e−3/4/√πn and let c(2)
n
represent the sum of the ﬁrst
two terms of the expansion of cn. One ﬁnds:
n
5
50
500
n!c(1)
n
14.30212
1.1462888618 · 1063
1.4542120372 · 101132
n!c(2)
n
12.51435
1.1319602511 · 1063
1.4523942721 · 101132
n!cn
12
1.1319677968 · 1063
1.4523943224 · 101132
Clearly, a complete asymptotic expansion in descending powers of n can be obtained in this
way. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE VI.2. □
EXAMPLE VI.3. Asymptotics of unary–binary trees and Motzkin numbers. Unary-binary trees
are unlabelled plane trees that admit the speciﬁcation and OGF:
U = Z(1 + U + U × U)
=⇒
U(z) = 1 −z −
p
(1 + z)(1 −3z)
2z
.
(See Note I.36 (p. 63) and Subsection V. 3 (p. 295) for the lattice path version.) The GF U(z)
is singular at z = −1 and z =
1
3, the dominant singularity being at z =
1
3. By branching
properties of the square-root function, U(z) is analytic in a ∆–domain like the one depicted
below:
0
−1
1
3
Around the point 1
3, a singular expansion is obtained by multiplying (1 −3z)1/2 and the
analytic expansion of the factor (1 + z)1/2/(2z). The singularity analysis process then applies
and yields automatically:
U(z) = 1 −31/2√
1 −3z + O((1 −3z))
•——◮
Un =
r
3
4πn3 3n + O(3nn−2).
Further terms in the singular expansion of U(z) at z =
1
3 provide additional terms in the
asymptotic expression of the Motzkin numbers Un, for instance,
Un =
r
3
4πn3 3n
„
1 −15
16 n +
505
512 n2 −
8085
8192 n3 +
505659
524288n4 + O
„ 1
n5
««
results from an expansion of U(z) till O((1 −3z)11/2). . . . . . . . END OF EXAMPLE VI.3. □
EXAMPLE VI.4.
Asymptotics of children’s rounds. Stanley [445] has introduced certain
combinatorial conﬁgurations that he has nicknamed “children’s rounds”: a round is a labelled
set of directed cycles, each of which has a center attached. The speciﬁcation and EGF are
R = SET(Z ⋆CYC(Z))
=⇒
R(z) = exp
„
z log
1
1 −z
«
= (1 −z)−z.

380
VI. SINGULARITY ANALYSIS OF GF’S
The function R(z) is analytic in the C-plane slit along R≥1, as is seen by elementary properties
of the composition of analytic functions. The singular expansion at z = 1 is then mapped to an
expansion for the coefﬁcients:
R(z) =
1
1 −z + log(1 −z) + O((1 −z)1/2)
•——◮
[zn]R(z) = 1 −1
n + O(n−3/2).
A more detailed analysis yields
[zn]R(z) = 1 −1
n −1
n2 (log n + γ −1) + O
„log2 n
n3
«
,
and an expansion to any order can be easily obtained. . . . . . . . . . . END OF EXAMPLE VI.4. □
 VI.11. The asymptotic shape of the rounds numbers. A complete asymptotic expansion has
the form
[zn]R(z) ∼1 −
X
j≥1
Pj(log n)
nj
,
where Pj is a polynomial of degree j −1. (The coefﬁcients of Pj are rational combinations of
powers of γ, ζ(2), . . . , ζ(j −1).) The successive terms in this expansion are easily obtained by
a computer algebra program.

EXAMPLE VI.5.
Asymptotics of coefﬁcients of an elementary function. Our ﬁnal example
is meant to show the way rather arbitrary compositions of basic functions can be treated by
singularity analysis. Let C = Z ⋆SEQ(C) be the class of general labelled plane trees. Consider
the labelled class deﬁned by substitution
F = C ◦CYC(CYC(Z))
=⇒
F(z) = C(L(L(z))).
There, C(z) = 1
2(1 −√1 −4z) and L(z) = log
1
1−z . Combinatorially, F is the class of trees
in which nodes are replaced by cycles of cycles, a rather artiﬁcial combinatorial object, and
F(z) = 1
2
»
1 −
s
1 −4 log
1
1 −log
1
1−z
–
.
The problem is ﬁrst to locate the dominant singularity of F(z), then to determine its nature,
which can be done inductively on the structure of F(z). The dominant positive singularity ρ of
F(z) satisﬁes L(L(ρ)) = 1
4 and one has
ρ = 1 −ee−1/4−1 .= 0.198443,
given that C(z) is singular at 1
4 and L(z) has positive coefﬁcients. Since L(L(z)) is analytic at
ρ, a local expansion of F(z) is obtained next by composition of the singular expansion of C(z)
at 1
4 with the standard Taylor expansion of L(L(z)) at ρ. We ﬁnd
F(z) = 1
2−C1(ρ−z)1/2+O((ρ−z)3/2)
•——◮
[zn]F(z) = C1ρ−n+1/2
2
√
πn3
»
1 + O( 1
n)
–
,
with C1 = e
5
8 −1
2 e−1/4 .= 1.26566. . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE VI.5. □
 VI.12. The asymptotic number of trains. Combinatorial trains have been introduced in Sec-
tion IV. 4 as a way to exemplify the power of complex asymptotic methods. One ﬁnds that, at its
dominant singularity ρ, the EGF Tr(z) is of the form Tr(z) ∼C/(1 −z/ρ), and, by singularity
analysis,
[zn]Tr(z) ∼0.11768 31406 15497 · 2.06131 73279 40138n.
(This asymptotic approximation is good to 15 signiﬁcant digits for n = 50, in accordance with
the fact that the dominant singularity is a simple pole.)


VI. 5. MULTIPLE SINGULARITIES
381
VI. 5. Multiple singularities
The previous section has described in detail the analysis of functions with a single
dominant singularity. The extension to functions that have ﬁnitely many (by necessity
isolated) singularities on their circle of convergence follows along entirely similar
lines. It parallels the situation of rational and meromorphic functions in Chapter IV
(p. 250) and is technically simple, the net result being:
In the case of multiple singularities, the separate contributions from each of
the singularities, as given by the basic singularity analysis process, must be
added up.
Like in (28), we let S be the standard scale of functions singular at 1, namely
S =

(1 −z)−αλ(z)β  α, β ∈C
	
,
λ(z) := 1
z log
1
1 −z .
Theorem VI.5 (Singularity analysis, multiple singularities). Let f(z) be analytic in
|z| < ρ and have a ﬁnite number of singularities on the circle |z| = ρ at points
ζj = ρeiθj, for j = 1 . . r. Assume that there exists a ∆–domain ∆0 such that f(z) is
analytic in the indented disc
D =
r\
j=1
(ζj · ∆0),
with ζ · ∆0 the image of ∆0 by the mapping z 7→ζz.
Assume that there exists r functions σ1, . . . , σr, each a linear combination of
elements from S and a function τ ∈S such that
f(z) = σj(z/ζj) + O (τ(z/ζj))
as z →ζj in D.
Then the coefﬁcients of f(z) satisfy the asymptotic estimate
fn =
r
X
j=1
ζ−n
j
σj,n + O
 ρ−nτ ⋆
n

,
where each σj,n = [zn]σj(z) has its coefﬁcients determined by Theorems VI.1, VI.2
and τ ∗
n = na−1(log n)b, if τ(z) = (1 −z)−aλ(z)b.
A function analytic in a domain like D is sometimes said to be star-continuable, a notion that
is the natural generalization of ∆–analyticity for functions with several dominant singularities.
Also, a similar statement holds with o-error terms replacing O’s.
PROOF. Like in the case of a single singularity, the proof bases itself on Cauchy’s
coefﬁcient formula
fn = [zn]
Z
γ
f(z) dz
zn+1 ,
where a composite contour γ depicted on Figure 8 is used. Estimates on each part of
the contour obey exactly the same principles as in the proof of Theorems VI.1–VI.3.
Let γ(j) be the open loop around ζj that comes from the outer circle, winds about ζj
and joins again the outer circle; let r be the radius of the outer circle.
— The contribution along the arcs of the outer circle is O(r−n), that is, expo-
nentially small.

382
VI. SINGULARITY ANALYSIS OF GF’S
γ
0
0
D:
FIGURE VI.8. Multiple singularities (r = 3): analyticity domain (D, left) and compos-
ite integration contour (γ, right).
— The contribution along the loop γ(1) (say) separates into
1
2iπ
Z
γ(1) f(z)
dz
zn+1 = I′ + I′′
I′ :=
1
2iπ
Z
γ(1) σ1(z/ζ1)
dz
zn+1 ,
I′′ :=
1
2iπ
Z
γ(1) (f(z) −σ1(z/ζ1))
dz
zn+1 .
The quantity I′ is estimated by extending the open loop to inﬁnity by the
same method as in the proof of Theorems VI.1 and VI.2: it is found to equal
ζ−n
1
σ1,n plus an exponentially small term. The quantity I′′, corresponding
to the error term, is estimated by the same bounding technique as in the
proof of Theorem VI.3 and is found to be O(ρnτ ⋆
n).
Collecting the various contributions completes the proof of the statement.
□
Theorem VI.5 expresses, that in the case of multiple singularities, each domi-
nant singularity can be analysed separately; the singular expansions are then each
transferred to coefﬁcients, and the corresponding asymptotic contributions are ﬁnally
collected. Two examples illustrating the process follow.
EXAMPLE VI.6. An artiﬁcial example. Let us demonstrate the modus operandi on the simple
function
(32)
g(z) =
ez
√
1 −z2 .
There are two singularities at z = +1 and z = −1, with
g(z) ∼
e
√
2√1 −z
z →+1
and
g(z) ∼
e−1
√
2√1 + z
z →−1.
The function is clearly star-continuable with the singular expansions valid in the star domain.
We have
[zn]
e
√
2√1 −z
∼
e
√
2πn
and
[zn]
e−1
√
2√1 + z
∼e−1(−1)n
√
2πn
.
To get the coefﬁcient [zn]g(z), it sufﬁces to add up these two contributions (by Theorem VI.5),
so that
[zn]g(z) ∼
1
√
2πn
[e + (−1)ne−1].

VI. 6. INTERMEZZO: FUNCTIONS OF SA-CLASS
383
If expansions at +1 (respectively −1) are written with an error term, which is of the form
O((z −1)1/2) (respectively, O((z + 1)1/2), there results an estimate of the coefﬁcients gn =
[zn]g(z), which can be put under the form
g2n = cosh(1)
√πn
+ O
“
n−3/2”
,
g2n+1 = sinh(1)
√πn
+ O
“
n−3/2”
.
This makes explicit the dependency of the asymptotic form of gn on the parity of the index n.
Clearly a full asymptotic expansion can be obtained. . . . . . . . . . . . END OF EXAMPLE VI.6. □
EXAMPLE VI.7. Permutations with cycles of odd length. Consider the speciﬁcation and EGF
F = SET(CYCodd(Z))
=⇒
F(z) = exp
„1
2 log 1 + z
1 −z
«
=
r
1 + z
1 −z .
The singularities of f are at z = +1 and z = −1, the function being obviously star-continuable.
By singularity analysis (Theorem VI.5), we have automatically:
F(z) =
8
>
<
>
:
21/2
√1 −z + O
“
(1 −z)1/2”
(z →1)
O
“
(1 + z)1/2”
(z →−1)
•——◮[zn]F(z) = 21/2
√πn+O
“
n−3/2”
.
For the next asymptotic order, the singular expansions
F(z) =
8
<
:
21/2
√1 −z −2−3/2√
1 −z + O((1 −z)3/2)
(z →1)
2−1/2√1 + z + O((1 + z)3/2)
(z →−1)
yield
[zn]F(z) = 21/2
√πn −(−1)n2−3/2
√
πn3
+ O(n−5/2).
This example illustrates the occurrence of singularities that have different weights, in the sense
of being associated with different exponents. . . . . . . . . . . . . . . . . . . END OF EXAMPLE VI.7. □
The discussion of multiple dominant singularities ties well with the earlier dis-
cussion of Subsection IV. 6.1, p. 250. In the periodic case where the dominant singu-
larities are at roots of unity, different regimes manifest themselves cyclically depend-
ing on congruence properties of the index n, like in the two examples above. When
the dominant singularities have arguments that are not commensurate to π (a com-
paratively rare situation), aperiodic ﬂuctuations appear, in which case the situation is
similar to what was already discussed, regarding rational and meromorphic functions,
in Subsection IV. 6.1.
VI. 6. Intermezzo: functions of singularity analysis class
Let us say that a function is of singularity analysis class, or SA-class for short,
if its satisﬁes the conditions of singularity analysis, as expressed by Theorem VI.4
(single dominant singularity) or Theorem VI.5 (multiple dominant singularities). The
property of being of SA-class is preserved by several basic operations of analysis: we
have already seen this feature in passing, when determining singular expansions of
functions obtained by sums, products, or compositions in Examples 2–5.

384
VI. SINGULARITY ANALYSIS OF GF’S
As a starting example, it is easily recognized that the assumptions of ∆-analyticity
for two functions f(z), g(z) accompanied by the singular expansions
f(z) ∼
z→1 c(1 −z)−α,
g(z) ∼
z→1 d(1 −z)−δ,
and the condition α, δ ̸∈Z≤0 imply for the coefﬁcients of the sum
[zn] (f(z) + g(z)) ∼















cnα−1
Γ(α)
α > δ
(c + d)nα−1
Γ(α)
α = δ,
c + d ̸= 0
dnδ−1
Γ(δ)
α < δ.
Similarly, for products, we have
[zn] (f(z)g(z)) ∼cd nα+δ−1
Γ(α + δ),
provided α + δ ̸∈Z≤0.
The simple considerations above illustrate the robustness of singularity analysis.
They also indicate that properties are easy to state in the generic case where no nega-
tive integral exponents are present. However, if all cases are to be covered, there can
easily be an explosion of the number of particular situations, which may render some-
what clumsy the enunciation of complete statements. Accordingly, in what follows,
we shall largely conﬁne ourselves to generic cases, as long as these sufﬁce to develop
the important mathematical technique at stake for each particular problem.
In the remainder of this chapter, we proceed to enlarge the class of functions
recognized to be of SA-class, keeping in mind the needs of analytic combinatorics.
The following types of functions are treated in later sections.
— Inverse functions (Section VI. 7). The inverse of an analytic function is, un-
der mild conditions, of SA-class. In the case of functions attached to simple
varieties of trees (corresponding to the inversion of y/φ(y)), the singular
expansion invariably has an exponent of 1
2 attached to it (a square-root sin-
gularity). This applies in particular to the Cayley tree function, in terms of
which many combinatorial structures and parameters can be analysed.
— Polylogarithms (Section VI. 8). These functions are the generating func-
tions of simple arithmetic sequences like (nθ) for an arbitrary θ ∈C. The
fact that polylogarithms are of SA-class opens the possibility of estimat-
ing a large number of sums, which involve both combinatorial terms (e.g.,
binomial coefﬁcients) and elements like √n and log n. Such sums appear
recurrently in the analysis of cost functionals of combinatorial structures
and algorithms.
— Composition (Section VI. 9). The composition of functions of SA-class of-
ten proves to be itself of SA-class. This fact has implications for the analysis
of composition schemas and makes possible a broad extension of the super-
critical sequence schema treated in Section V. 4, (p. 313).

VI. 7. INVERSE FUNCTIONS
385
— Differentiation, integration, and Hadamard products (Section VI. 10). These
are three operations on analytic function that preserve the property for a
function to be of SA-class. Applications are given to tree recurrences and to
multidimensional walk problems.
A main theme of this book is that elementary combinatorial classes tend to have
generating functions whose singularity structure is strongly constrained—in many
cases, singularities are isolated. The singularity analysis process is then a prime tech-
nique for extracting asymptotic information from such generating functions.
VI. 7. Inverse functions
Recursively deﬁned structures lead to functional equations whose solutions may
often be analysed locally near singularities. An important case is the one of func-
tions deﬁned by inversion. It includes the Cayley tree function as well as all generat-
ing functions associated to simple varieties of trees (Subsections I. 5.1 (p. 61), II.5.1
(p. 116), and III.6.2 (p. 182)). A common pattern in this context is the appearance
of singularities of the square-root type, which proves to be universal amongst a broad
class of problems involving trees and tree-like structures. Accordingly, by singularity
analysis, the square-root singularity induces subexponential factors of the asymptotic
form n−3/2 in coefﬁcients’ expansions.
Inverse functions. Singularities of functions deﬁned by inversion have been lo-
cated in Subsection IV. 7.1 (p. 261) and our treatment will proceed from there. The
goal is to estimate the coefﬁcients of a function deﬁned implicitly by an equation of
the form
(33)
y(z) = zφ(y(z))
or equivalently
z =
y(z)
φ(y(z)).
The problem of solving (33) is one of functional inversion: we have seen (Lem-
mas IV.2 and IV.3, pp. 262–263) that an analytic function admits locally an analytic
inverse if and only if its ﬁrst derivative is nonzero. We operate here under the following
assumptions:
— Condition (H1). The function φ(u) is analytic at u = 0 and satisﬁes
(34)
φ(0) ̸= 0,
[un]φ(u) ≥0,
φ(u) ̸≡φ0 + φ1u.
(As a consequence, the inversion problem is well deﬁned around 0. The
nonlinearity of φ only excludes the case φ(u) = φ0 + φ1u, corresponding
to y(z) = φ0z/(1 −φ1z).)
— Condition (H2). Within the open disc of convergence of φ at 0, |z| <
R, there exists a (necessarily unique) positive solution to the characteristic
equation:
(35)
∃τ, 0 < τ < R,
φ(τ) −τφ′(τ) = 0.
(Existence is granted as soon as lim xφ′(x)/φ(x) > 1 as x →R−,with R
the radius of convergence of φ at 0; see Proposition IV.5, p. 264.)

386
VI. SINGULARITY ANALYSIS OF GF’S
y :
1
0
0.5
-0.5
1
0.5
-1
0
-1
-0.5
−→
z :
-1
1
0.5
0
-0.5
1
0
-1
-1.5
0.5
-0.5
FIGURE VI.9. The images of concentric circles by the mapping y 7→z = ye−y. It
is seen that y 7→z = ye−y is injective on |y| ≤1 with an image extending beyond the
circle |z| = e−1 [in grey], so that the inverse function y(z) is analytically continuable in a
∆–domain around z = e−1. Since the direct mapping ye−y is quadratic at 1 (with value
e−1), the inverse function has a square-root singularity at e−1 (with value 1).
Then (by Proposition IV.5, p. 264), the radius of convergence of y(z) is the corre-
sponding positive value ρ of z such that y(ρ) = τ, that is to say,
(36)
ρ =
τ
φ(τ) =
1
φ′(τ).
We start with a calculation indicating in a plain context the occurrence of a square-root
singularity.
EXAMPLE VI.8. A simple analysis of the Cayley tree function.
The situation corresponding
to the function φ(u) = eu, so that y(z) = zey(z) (deﬁning the Cayley tree function T(z)), is
typical of general analytic inversion. From (35), the radius of convergence of y(z) is ρ = e−1
corresponding to τ = 1. The image of a circle in the y–plane, centered at the origin and having
radius r < 1, by the function ye−y is a curve of the z–plane that properly contains the circle
|z| = re−r (see Figure 9) as φ(y) = ey, which has nonnegative coefﬁcients, satisﬁes
˛˛˛φ(reiθ)
˛˛˛ ≤φ(r)
for all θ ∈[−π, +π],
the inequality being strict for all θ ̸= 0. The following observation is the key to analytic
continuation: Since the ﬁrst derivative of y/φ(y) vanishes at 1, the mapping y 7→y/φ(y)
is angle-doubling, so that the image of the circle of radius 1 is a curve C that has a cusp at
ρ = e−1. (See Figure 9; Notes 16 and 17 provide interesting generalizations.)
This geometry shows that the solution of z = ye−y is uniquely deﬁned for z inside C.
Thus, y(z) is ∆–analytic. A singular expansion for y(z) is then derived from reversion of the
power series expansion of z = ye−y. We have
ye−y = e−1 −e−1
2 (y −1)2 + e−1
3 (y −1)3 −e−1
8 (y −1)4 + · · · ,
so that solving for y gives
y −1 =
√
2(1 −ez)1/2 + 2
3(1 −ez) + O((1 −ez)3/2),

VI. 7. INVERSE FUNCTIONS
387
and a full expansion can be obtained. . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE VI.8. □
Analysis of inverse functions. The calculation of Example 8 now needs to be
extended to the general case, y = zφ(y). This involves three steps: (i) all the dom-
inant singularities are to be located; (ii) analyticity of y(z) in a ∆–domain must be
established; (iii) the singular expansion, obtained formally so far and involving a
square-root singularity, needs to be determined. Step (i) requires a special discussion
and is related to periodicities.
A simple example like φ(u) = 1 + u2 (binary trees), for which
y(z) = 1 −
√
1 −4z2
2z
,
shows that y(z) may have several dominant singularities—here, two conjugate singu-
larities at −1
2 and + 1
2. The conditions for this to happen are rather simple. Let us say
that a function analytic at 0, f(u), is p–periodic if f(u) = urg(up) for some power
series g (see p. 252). A function is called periodic if it is p–periodic from some p ≥2
and aperiodic otherwise. An elementary argument developed in Note 15 below shows
that that periodicity does not occur for y(z) unless φ(u) is itself periodic, a case which
turns out to be easily reducible to the aperiodic situation.
Theorem VI.6 (Singular Inversion). Let φ be a nonlinear function satisfying the con-
ditions (H1) and (H2) of Equations (34) and (35), and let y(z) be the solution of
y = zφ(y) satisfying y(0) = 0. Then, the quantity ρ = τ/φ(τ) is the radius of con-
vergence of y(z) at 0 (with τ the root of the characteristic equation), and the singular
expansion of y(z) near ρ is of the form
y(z) = τ −d1
p
1 −z/ρ +
X
j≥2
(−1)jdj(1 −z/ρ)j/2,
d1 :=
s
2φ(τ)
φ′′(τ),
with the dj being some computable constants.
Assume that, in addition, φ is aperiodic4. Then, one has
[zn]y(z) ∼
s
φ(τ)
2φ′′(τ)
ρ−n
√
πn3
 
1 +
∞
X
k=1
ek
nk
!
,
for a family ek of computable constants.
PROOF. Proposition IV.5, p. 264, shows that ρ is indeed the radius of convergence
of y(z). The Singular Inversion Lemma (Lemma IV.3, p. 263) also shows that y(z)
can be continued to a neighbourhood of ρ slit along the ray R≥ρ.
The singular expansion at ρ is determined like in Example 8. Indeed, the relation
between z and y, in the vicinity of (z, y) = (ρ, τ), may be put under the form
(37)
ρ −z = H(y),
where
H(y) :=

τ
φ(τ) −
y
φ(y)

,
4If φ has maximal period p, then one must restrict n to n ≡1 mod p; in that case, there is an extra
factor of p in the estimate of yn: see Note 15 and Equation (38).

388
VI. SINGULARITY ANALYSIS OF GF’S
the function H(y) in the right hand side being such that H(τ) = H′(τ) = 0. Thus,
the dependency between y and z is locally a quadratic one:
ρ −z = 1
2!H′′(τ)(y −τ)2 + 1
3!H′′′(τ)(y −τ)3 + · · · .
When this relation is locally inverted: a square-root appears:
−√ρ −z =
r
H′′(τ)
2
(y −τ)

1 + c1(y −τ) + c2(y −τ)2 + ...

.
The determination with a −√should be chosen there as y(z) increases to τ −as z →
ρ−. This implies, by solving with respect to y −τ, the relation
y −τ ∼−d⋆
1(ρ −z)1/2 + d⋆
2(ρ −z) −d⋆
3(ρ −z)3/2 + · · · ,
where d⋆
1 =
p
2/H′′(τ) with H′′(τ) = τφ′′(τ)/φ(τ)2. The singular expansion at ρ
results.
There now remains to exclude the possibility for y(z) to have singularities other
than ρ on the circle |z| = ρ. Observe that y(ρ) is well deﬁned (in fact y(ρ) = τ), so
that the series representing y(z) converges at ρ as well as on the whole circle (given
positivity of the coefﬁcients). If φ(z) is aperiodic, then so is y(z). Consider any point
ζ such that |ζ| = ρ and ζ ̸= ρ and set η = y(ζ). We then have |η| < τ (by the
Daffodil Lemma: Lemma IV.1, p. 253). The function y(z) is analytic at ζ by virtue of
the Analytic Inversion Lemma (Lemma IV.2, p. 262) and the property that
d
dy
y
φ(y)

y=η
̸= 0.
(This last property derives from the fact that the numerator of the quantity on the left,
φ(η) −ηφ′(η) = φ0 −φ2η2 −2φ3η3 −3φ4η4 −· · · ,
cannot vanish, by the triangle inequality since |η| < τ.) Thus, under the aperiodicity
assumption, y(z) is analytic on the circle |z| = ρ punctured at ρ. The expansion of
the coefﬁcients then results from basic singularity analysis.
□
Figure 10 provides a table of the most basic varieties of simple trees and the
corresponding asymptotic estimates. With Theorem VI.6, we now have available a
powerful method that permits us to analyse not only implicitly deﬁned functions but
also expressions built upon them. This fact will be put to good use in Chapter VII,
when analysing a number of parameters associated to simple varieties of trees.
 VI.13. Computability of singular expansions. Deﬁne
h(w) :=
s
τ/φ(τ) −w/φ(w)
(τ −w)2
,
so that y(z) satisﬁes √ρ −z = (τ −y)h(y). The singular expansion of y can then be deduced
by Lagrange inversion from the expansion of the negative powers of h(w) at w = τ. This
technique yields for instance explicit forms for coefﬁcients in the singular expansion of y =
zey.


VI. 7. INVERSE FUNCTIONS
389
Type
φ(u)
Sing. expansion of y(z)
Coeff. [zn]y(z)
binary
(1 + u)2
1 −4
q
1
4 −z + · · ·
4n
√
πn3 + O(n−5/2)
unary-binary
1 + u + u2
1 −3
q
1
3 −z + · · ·
3n+1/2
2
√
πn3 + O(n−5/2)
general
(1 −u)−1
1
2 −
q
1
4 −z
4n−1
√
πn3 + O(n−5/2)
Cayley
eu
1 −
√
2e
√
e−1 −z + · · ·
en
√
2πn3 + O(n−5/2)
FIGURE VI.10. Singularity analysis of some simple varieties of trees.
 VI.14. Stirling’s formula via singularity analysis. The solution to T = zeT analytic at 0 is
the Cayley tree function. It satisﬁes [zn] = nn−1/n! (by Lagrange inversion) and, at the same
time, its singularity is known from Theorem VI.6. As a consequence:
nn−1
n!
∼
en
√
2πn3
„
1 −1
12 n−1 +
1
288 n−2 +
139
51840 n−3 −· · ·
«
.
Thus Stirling’s formula also results from singularity analysis.

 VI.15. Periodicities. Assume that φ(u) = ψ(up)with ψ analytic at 0 and p ≥2. Let y =
y(z) be the root of y = zφ(y). Set Z = zp and let Y (Z) be the root of Y = Zψ(Y )p. One has
by construction y(z) = Y (zp)1/p, given that yp = zpφ(y)p. Since Y (Z) = Y1Z+Y2Z2+· · · ,
we verify that the nonzero coefﬁcients of y(z) are amongst those of index 1, 1 + p, 1 + 2p, . . . .
If p is chosen maximal, then ψ(u)p is aperiodic. Then Theorem VI.6 applies to Y (Z): the
function Y (Z) is analytically continuable beyond its dominant singularity at Z = ρp; it has a
square root singularity at ρp and no other singularity on |Z| = ρp. Also, since Y = Zψ(Y )p,
the function Y (Z) cannot vanish on |Z| ≤ρp, Z ̸= 0. Thus, Y (Z)1/p is analytic in |Z| ≤ρp,
except at ρp where it has a √branch point. All computations done, we ﬁnd that
(38)
[zn]y(z) ∼p · d1ρ−n
2
√
πn3
when
n ≡1
(mod p).
The argument also shows that y(z) has p conjugate roots on its circle of convergence. (This is
a kind of Perron-Frobenius property for periodic tree functions.)

 VI.16. Boundary cases I. The case when τ lies on the boundary of the disc of convergence
of φ may lead to asymptotic estimates differing from the usual ρ−nn−3/2 prototype. Without
loss of generality, take φ aperiodic to have radius of convergence equal to 1 and assume that φ
is of the form
(39)
φ(u) = u + c(1 −u)α + o((1 −u)α),
with
1 < α ≤2,
as u tends to 1 with |u| < 1. The solution of the characteristic equation φ(τ) −τφ′(τ) = 0 is
then τ = 1. The function y(z) deﬁned by y = zφ(y) is ∆–analytic (by a mapping argument
similar to the one exempliﬁed by Figure 9 and related to the fact that φ “multiplies” angles
near 1). The singular expansion of y(z) and the coefﬁcients then satisfy
(40) y(z) = 1 −c−1/α(1 −z)1/α + o
“
(1 −z)1/α”
•——◮
yn ∼c−1/α n−1/α−1
−Γ(−1/α).
[The case α = 2 was ﬁrst observed by Janson [281]. Trees with α ∈(1, 2) have been investi-
gated in connection with stable L´evy processes [141]. The singular exponent α = 3
2 occurs for

390
VI. SINGULARITY ANALYSIS OF GF’S
instance in planar maps (Chapter VII), so that GFs with coefﬁcients of the form ρ−nn−5/3 can
arise, when considering trees whose nodes are themselves maps.]

 VI.17. Boundary cases II. Let φ(u) be the probability generating function of a random
variable X with mean equal to 1 and such that φn ∼λn−α−1, with 1 < α < 2. Then,
by a complex version of an Abelian theorem (see, e.g., [56, §1.7] and [182]), the singular
expansion (39) holds when u →1, |u| < 1, within a cone, so that the conclusions of (40)
hold in that case. Similarly, if φ′′(1) exists, meaning that X has a second moment, then the
estimate (40) holds with α = 2, and then coincides with what Theorem VI.6 predicts [281]. (In
probabilistic terms, the condition of Theorem VI.6 is equivalent to postulating the existence of
exponential moments for the one-generation offspring distribution.)

VI. 8. Polylogarithms
Expressions involving sequences like (√n) or (log n) can be subjected to sin-
gularity analysis. The starting point is the deﬁnition of the generalized polyloga-
rithm Liα,r, where α is an arbitrary complex number and r a nonnegative integer:
Liα,r(z) :=
X
n≥1
(log n)r zn
nα ,
The series converges for |z| < 1, so that the function Liα,r is a priori analytic in
the unit disc. The quantity Li1,0(z) is the usual logarithm, log(1 −z)−1, hence the
established name, polylogarithm, assigned to these functions [331]. In what follows,
we make use of the abbreviation Liα,0(z) ≡Liα(z), so that Li1(z) ≡Li1,0(z) ≡
log(1 −z)−1 is the GF of the sequence (1/n). Similarly , Li0,1 is the GF of the
sequence (log n) and Li−1/2(z) is the GF of the sequence (√n).
Polylogarithms are continuable to the whole of the complex plane slit along the
ray R≥1, a fact established early in the twentieth century by Ford [220]. They are
of SA-class [176] and their singular expansions involve the Riemann zeta function
deﬁned by
ζ(s) =
∞
X
n=1
1
ns ,
for ℜ(s) > 1, and by analytic continuation elsewhere [470].
Theorem VI.7 (Singularities of polylogarithms). For all α ∈Z and r ∈Z≥0, the
function Liα,r(z) is analytic in the slit plane C\ R≥1. For α ̸∈{1, 2, . . .}, there exists
an inﬁnite singular expansion (with logarithmic terms when as r > 0) given by the
two rules:
(41)







Liα(z)
∼Γ(1 −α)wα−1 +
X
j≥0
(−1)j
j!
ζ(α −j)wj, w :=
∞
X
ℓ=1
(1 −z)ℓ
ℓ
Liα,r(z) = (−1)r ∂r
∂αr Liα(z)
(r ≥0).
The expansion of Liα is conveniently described by the composition of two expansions, with the
expansion of w = log z at z = 1, namely w = (1 −z) + 1
2(1 −z)2 + · · · , to be substituted

VI. 8. POLYLOGARITHMS
391
inside the expansion into powers of w. The exponents of (1 −z) involved in the resulting
expansion are {α −1, α, . . .} ∪{0, 1, . . .}. For α < 1, the main asymptotic term of Liα,r is
Liα,r ∼Γ(1 −α)(1 −z)α−1Lr(z),
L(z) := log
1
1 −z ,
while, for α > 1, we have Liα,r ∼ζ(r)(α), since the sum converges.
PROOF. The analysis crucially relies on the Mellin transform (see APPENDIX B:
Mellin transform, p. 707). We start with the case r = 0 and consider several ways in
which z may approach the singularity 1. Step (i) below describes the main ingredi-
ent needed in obtaining the expansion, the subsequent steps being only required for
justifying it in larger regions of the complex plane.
(i) When z →1−along the real line: Set w = −log z and introduce
(42)
Λ(w) := Liα(e−w) =
X
n≥1
e−nw
nα .
This is a harmonic sum in the sense of Mellin transform theory, so that the Mellin
transform of Λ satisﬁes (ℜ(s) > max(0, 1 −α))
(43)
Λ⋆(s) ≡
Z ∞
0
Λ(w)ws−1 dw = ζ(s + α)Γ(s).
The function Λ(w) can be recovered from the inverse Mellin integral,
(44)
Λ(w) =
1
2iπ
Z c+i∞
c−i∞
ζ(s + α)Γ(s)w−s ds,
with c taken in the half-plane in which Λ⋆(s) is deﬁned. There are poles at s =
0, −1, −2, . . . due to the Gamma factor and a pole at s = 1 −α due to the zeta
function. Take d to be of the form −m −1
2 and smaller than 1 −α. Then, a standard
residue calculation, taking into account poles to the left of c and based on
(45)
Λ(w)
=
X
s0∈{0,−1,...,−m}∪{1−α}
Res
 ζ(s + α)Γ(s)w−s
s=s0
+
1
2iπ
Z d+i∞
d−i∞
ζ(s + α)Γ(s)w−s ds,
then yields a ﬁnite form of the estimate (41) of Liα (as w →0, corresponding to
z →1−).
(ii) When z →1−in a cone of angle less than π inside the unit disc: In that case,
we observe that the identity in (44) remains valid by analytic continuation, since the
integral is still convergent (this property owes to the fast decay of Γ(s) towards ±i∞).
Then the residue calculation (45), on which the expansion of Λ(w) is based in the real
case w > 0, still makes sense. The extension of the asymptotic expansion of Liα from
within the unit disc is thus granted.
(iii) When z tends to 1 vertically’: Details of the proof are given in [176]. What
is needed is a justiﬁcation of the validity of expansion (41), when z is allowed to tend
to 1 from the exterior of the unit disc. The key to the analysis is a Lindel¨of integral

392
VI. SINGULARITY ANALYSIS OF GF’S
Li−1/2(z) =
X
n≥1
√nzn
=
√π
2(1 −z)3/2 −
3√π
8(1 −z)1/2 + ζ(−1
2) + O
“
(1 −z)1/2”
Li0(z)
=
X
n≥1
zn
≡
1
1 −z −1
Li0,1(z)
=
X
n≥1
log n zn = L(z) −γ
1 −z
−1
2L(z) + γ −1
2
+ log
√
2π + O ((1 −z)L(z))
Li1/2(z)
=
X
n≥1
zn
√n
=
r
π
1 −z + ζ(1
2) −1
4
√π
√
1 −z + O
“
(1 −z)3/2”
Li1/2,1(z) =
X
n≥1
log n
√n zn = √π L(z) −γ −2 log 2
√1 −z
−ζ(1
2)
“γ
2 + π
4 + log
√
8π
”
+ · · ·
Li1(z)
=
X
n≥1
zn
n
≡L(z)
Li2(z)
=
X
n≥1
zn
n2
= π2
6 −(L(z) + 1)(1 −z) −(1
4 + 1
2L(z))(1 −z)2 + · · ·
FIGURE VI.11.
Sample expansions of polylogarithms (L(z) := log(1 −z)−1).
representation of the polylogarithm (Notes IV.7 and IV.8, p. 225), which provides
analytic continuation. To wit:
Liα(−z) = −1
2iπ
Z 1/2+i∞
1/2−i∞
zs
sα
π
sin πs ds.
The proof then proceeds with the analysis of the polylogarithm when z = ei(w−π)
and s = 1/2 + it, the integral being estimated asymptotically as a harmonic integral
(a continuous analogue of harmonic sums [502]) by means of Mellin transforms. The
extension to a cone with vertex at 1, having a vertical symmetry and angle less than π,
then follows by an analytic continuation argument. By unicity of asymptotic expan-
sions (the horizontal cone of Parts (i) and (ii) and the vertical cone have a nonempty
intersection), the resulting expansion must coincide with the one calculated explicitly
in Part (i), above.
To conclude, regarding the general case r ≥0, we may proceed along similar
lines, with each log n factor introducing a derivative of the Riemann zeta function,
hence a multiple pole at s = 1. It can then be checked that the resulting expansion
coincides with what is given by formally differentiating the expansion of Liα a number
of times equal to r. (See also Note 18 below.)
□
Figure 11 provides a table of expansions relative to commonly encountered poly-
logarithms (the function Li2 is also known as a dilogarithm). Example 9 illustrates
the use of polylogarithms for establishing a class of asymptotic expansions of which
Stirling’s formula appears as a special case. Further uses of Theorem VI.7 will appear
in the next sections.

VI. 9. FUNCTIONAL COMPOSITION
393
EXAMPLE VI.9. Stirling’s formula, polylogarithms, and superfactorials. One has
X
n≥1
log n! zn = (1 −z)−1 Li0,1(z),
to which singularity analysis is applicable. Theorem VI.7 then yields the singular expansion
1
1 −z Li0,1(z) ∼L(z) −γ
(1 −z)2 + 1
2
−L(z) + γ −1 + log 2π
1 −z
+ · · · ,
from which Stirling’s formula reads off:
log n! ∼n log n −n + 1
2 log n + log
√
2π + · · · .
(Stirling’s constant log
√
2π comes out as neatly −ζ′(0).) Similarly, deﬁne the superfactorial
function to be 1122 · · · nn. One has
X
n≥1
log(1222 · · · nn)zn =
1
1 −z Li−1,1(z),
to which singularity analysis is mechanically applicable. The analogue of Stirling’s formula
then reads:
1122 · · · nn
∼
An
1
2 n2+ 1
2 n+ 1
12 e−1
4 n2,
A
=
exp
„ 1
12 −ζ′(−1)
«
= exp
„
−ζ′(2)
2π2 + log(2π) + γ
12
«
.
The constant A is known as the Glaisher-Kinkelin constant [165, p. 135]. Higher order factorials
can be treated similarly. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE VI.9. □
 VI.18. Polylogarithms of integral index and a general formula. Let α = m ∈Z≥1. Then:
Lim(z) =
(−1)m
(m −1)!wm−1(log w −Hm−1) +
X
j≥0,j̸=m−1
(−1)j
j!
ζ(m −j)wj,
where Hm is the harmonic number and w = −log z. [The line of proof is the same as in
Theorem VI.7, only the residue calculation at s = 1 differs.] The general formula,
Liα,r(z) ∼
z→1(−1)r ∂r
∂αr
X
s∈Z≥0∪{1−α}
Res
ˆ
ζ(s + α)Γ(s)w−s˜
,
w := −log z,
holds for all α ∈C and r ∈Z≥0 and is amenable to symbolic manipulation.

VI. 9. Functional composition
Let f and g be functions analytic at the origin that have nonnegative coefﬁcients.
We consider the composition
h = f ◦g,
h(z) = f(g(z)),
assuming g(0) = 0. Let ρf, ρg, ρh be the corresponding radii of convergence, and let
τf = f(ρf), and so on. We shall assume that f and g are ∆–continuable and that
they admit singular expansions in the scale of powers. There are three cases to be
distinguished depending on how τg compares to ρf. Clearly one has:

394
VI. SINGULARITY ANALYSIS OF GF’S
— Supercritical case5, when τg > ρf. In that case, when z increases from 0,
there is a value r strictly less than ρg such that g(r) attains the value ρf,
which triggers a singularity of f ◦g. In other words r ≡ρh = g(−1)(ρf).
Around this point, g is analytic and a singular expansion of f ◦g is obtained
by composing the singular expansion of f with the regular expansion of g
at r. The singularity type is that of the external function (f).
— Subcritical case, when τg < ρf. In this dual situation, the singularity of f ◦g
is driven by that of the inside function g. We have ρh = ρg, τh = f(ρg)
and the singular expansion of f ◦g is obtained by composing the regular
expansion of f with the singular expansion of g at ρg. The singularity type
is that of the internal function (g).
— Critical case, when τg = ρf. In this boundary case, there is a conﬂuence
of singularities. We have ρh = ρg, τh = τf, and the singular expansion is
obtained by composition rules of the singular expansions. The singularity
type is a mix of the types of the internal and external functions (f, g).
This terminology extends the notion of supercritical sequence schema introduced
in Chapter V, where we considered the case f(z) = (1 −z)−1 and discussed some
of the probabilistic consequences. Rather than stating general conditions that would
be unwieldy, it is better to discuss examples directly, referring to the above guide-
lines supplemented by the plain algebra of generalized power expansions, whenever
necessary.
EXAMPLE VI.10. “Supertrees”. Let G be the class of general Catalan trees:
G = Z × SEQ(G)
=⇒
G(z) = 1
2(1 −
√
1 −4z).
The radius of convergence of G(z) is 1
4 and the singular value is G( 1
4) =
1
2. The class ZG
consists of planted trees, which are such that to the root is attached a stem and an extra node,
with OGF equal to zG(z). We then introduce two classes of supertrees deﬁned by substitution:
H = G[ZG]
=⇒
H(z) = G(zG(z))
K = G[(Z + Z′)G]
=⇒
K(z) = G(2zG(z)).
These are “trees of trees”: the class H is formed of trees such that, on each node there is grafted
a planted tree (by the combinatorial substitution of Section I. 6, p. 77); the class K similarly
corresponds to the case when the stems can be of any two colours. Incidentally, combinatorial
sum expressions are available for the coefﬁcients,
Hn =
⌊n/2⌋
X
k=1
1
n −k
 
2k −2
k −1
! 
2n −3k −1
n −k −1
!
, Kn =
⌊n/2⌋
X
k=1
2k
n −k
 
2k −2
k −1
! 
2n −3k −1
n −k −1
!
,
the initial values being given by
H(z) = z2 +z3 +3z4 +7z5 +21z6 +· · · ,
K(z) = 2z2 +2z3 +8z4 +18z5 +64z6 +· · · .
Since ρG = 1
4 and τG = 1
2, the composition scheme is subcritical in the case of H and
critical in the case of K. In the ﬁrst case, the singularity is of square-root type and one ﬁnds
5This terminology is in accordance with the notion of supercritical sequence schema in Section V. 4
(p. 313), for which the external function is f(z) = (1 −z)−1, with ρf = 1.

VI. 9. FUNCTIONAL COMPOSITION
395
FIGURE VI.12. A binary supertree is a “tree of trees”, with component trees all binary.
The number of binary supertrees with 2n nodes has the unusual asymptotic form
c4nn−5/4.
easily:
H(z) ∼
z→1
4
2 −
√
2
4
−1
√
8
r
1
4 −z,
•——◮
Hn ∼
4n
8
√
2πn3/2 .
In the second case, the two square-roots combine to produce a fourth root:
K(z) ∼
z→1
4
1
2 −1
√
2
(1
4 −z)1/4
•——◮
Kn ∼
4n
8Γ( 3
4)n5/4 .
On a similar register, consider the class B of complete binary trees:
B = Z + Z × B × B
=⇒
B(z) = 1 −
√
1 −4z2
2z
,
and deﬁne the class of binary supertrees (Figure 12) by
S = B (Z × B)
=⇒
S(z) = 1 −
p
2
√
1 −4z2 −1 + 4z2
1 −
√
1 −4z2
.
The composition is critical since zB(z) = 1
2 at the dominant singularity z = 1
2. It is enough to
consider the reduced function
S(z) = S(√z) = z + z2 + 3z3 + 8z4 + 25z5 + 80z6 + 267z7 + 911z8 + · · · ,
whose coefﬁcients constitute EIS A101490 and occur in Bousquet-M´elou’s study of integrated
superbrownian excursion [67]. We ﬁnd
S(z) ∼1−
√
2(1−4z)1/4+(1−4z)1/2+· · · •——◮Sn =
4n
n5/4
„ √
2
4Γ( 3
4) −
1
2√πn1/4 + · · ·
«
.
For instance, a seven term expansion yields a relative accuracy of 10−4, already for n = 100,
so that such approximations are quite usable in practice.
The occurrence of the exponent −5
4 in the enumeration of bicoloured and binary supertrees
is striking. Related constructions have been considered by Kemp [291] who obtained more
generally exponents of the form −1 −2−d by iterating the substitution construction (this, in
connection with what he called “multidimensional trees”). It is signiﬁcant that asymptotic terms
of the form np/q with q ̸= 1, 2 can appear in elementary combinatorics, even in the context
of simple algebraic functions. Such exponents tend to be associated with nonstandard limit

396
VI. SINGULARITY ANALYSIS OF GF’S
Weights
(46)
fk
1
k
1
4k
`2k
k
´
1
Hk
k
k2
f(z)
log
1
1−z
1
√1−z
1
1−z
1
1−z log
1
1−z
z
(1−z)2
z+z2
(1−z)3 .
Triangular arrays
(47)
g(k)
n
`n−1
k−1
´
kn−k
(n−k)!
`
k
n−k
´
k
n
`2n−k−1
n−1
´
k
n
` 2n
n−k
´
k nn−k−1
(n−k)!
g(z)
z
1−z
zez
z(1 + z)
1−√1−4z
2
1−2z−√1−4z
2z
T(z)
FIGURE VI.13. Typical weights (top) and triangular arrays (bottom) illustrating the dis-
cussion of combinatorial sums Sn = Pn
k=1 fkg(k)
n .
laws, akin to the stable distributions of probability theory; see also our discussion at the end of
Chapter IX. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE VI.10. □
 VI.19. Supersupertrees. Deﬁne these by
S[2](z) = B(zB(zB(z))).
We ﬁnd automatically (with the help of B. Salvy’s program)
[z2n+1]S[2](z) ∼2−13/4Γ
„7
8
«−1
4nn−9/8,
and further extensions involving an asymptotic term n−1−2−d are possible (see [291] for similar
cases).

Combinatorial sums. Singularity analysis permits us to discuss the asymptotic
behaviour of entire classes of combinatorial sums at a fair level of generality, with
asymptotic estimates coming out rather automatically. We consider here combinatorial
sums of the form
Sn =
n
X
k=0
fkg(k)
n ,
where fk is a sequence of numbers, usually of a simple form and called the weights,
while the g(k)
n
are a triangular array of numbers, for instance Pascal’s triangle.
As weights fk we shall consider sequences such that f(z) is ∆–analytic with a
singular expansion involving functions of the standard scale of Theorems VI.1, VI.2,
VI.3. Typical examples for f(z) and (fk) are6 are displayed in Figure 13, Equation 46.
The triangular arrays discussed here are taken to be coefﬁcients of the powers of some
ﬁxed function, namely,
g(k)
n
= [zn](g(z))k
where
g(z) =
∞
X
n=1
gnzn,
with g(z) an analytic function at the origin having nonnegative coefﬁcients and satis-
fying g(0) = 0. Examples are given in Figure 13, Equation (47). An interesting class
6Weights like log k and
√
k, also satisfy these conditions, as seen in Section VI. 8.

VI. 9. FUNCTIONAL COMPOSITION
397
of such arrays arises from the Lagrange inversion theorem. Indeed, if g(z) is implic-
itly deﬁned by g(z) = zG(g(z)), one has gn,k = k
n[wn−k]G(w)n; the last three cases
of (47) are obtained in this way (by taking G(w) as 1/(1 −w), (1 + w)2, ew).
By design, the generating function of the Sn is simply
S(z) =
∞
X
n=0
Snzn = f(g(z))
with
f(z) =
∞
X
k=0
fkzk.
Consequently, the asymptotic analysis of Sn results by inspection from the way sin-
gularities of f(z) and g(z) get transformed by composition.
EXAMPLE VI.11. Bernoulli sums. Let φ be a function from Z≥0 to R and write fk := φ(k).
Consider the sums
Sn :=
n
X
k=0
φ(k) 1
2n
 
n
k
!
.
If Xn is a binomial random variable7, Xn ∈Bin(n, 1
2), then Sn = E(φ(Xn)) is exactly the
expectation of φ(Xn). Then, by the binomial theorem, the OGF of the sequence (Sn) is:
S(z) =
2
2 −z f
„
z
2 −z
«
.
Considering weights whose generating function has, like in (46) radius of convergence 1, what
we have is a variant of the composition schema, with an additional prefactor. The composition
scheme is of the supercritical type since the function g(z) = z/(2 −z), which has radius of
convergence equal to 2, satisﬁes τg = ∞. The singularities of S(z) are then of the same type as
those of the weight generating function f(z) and one veriﬁes, in all cases of (46), that, to ﬁrst
asymptotic order, Sn ∼φ(n/2): this is in agreement with the fact that the binomial distribution
is concentrated near its mean n
2 . Singularity analysis provides complete asymptotic expansions,
for instance,
E
„ 1
Xn
˛˛ Xn > 0
«
=
2
n + 2
n2 + 6
n3 + O(n−4)
E (HXn)
=
log n
2 + γ + 1
2n −
1
12n2 + O(n−3).
See [163, 176] for more along these lines. . . . . . . . . . . . . . . . . . . . END OF EXAMPLE VI.11. □
EXAMPLE VI.12.
Generalized Knuth–Ramanujan Q-functions. For reasons motivated by
analysis of algorithms, Knuth has encountered repeatedly sums of the form
Qn({fk}) = f0 + f1 n
n + f2 n(n −1)
n2
+ f3 n(n −1)(n −2)
n3
+ · · · .
(See, e.g., [312, pp. 305–307].) There (fk) is a sequence of coefﬁcients (usually of at most
polynomial growth). For instance, the case fk ≡1 yields the expected time till the ﬁrst collision
in the birthday paradox problem (Section II. 3, p. 105).
A closer examination shows that the analysis of such Qn is reducible to singularity analy-
sis. Writing
Qn({fk}) = f0 +
n!
nn−1
X
k≥1
fk nn−k−1
(n −k)!
7A binomial random variable is a sum of Bernoulli random variables: Xn = Pn
j=1 Yj where the Yj
are independent and distributed like a Bernoulli variable Y , with P(Y = 1) = p, P(Y = 0) = q = 1 −p.

398
VI. SINGULARITY ANALYSIS OF GF’S
reveals the closeness with the last column of (47). Indeed, setting
F(z) =
X
k≥1
fk
k zk,
one has (n ≥1)
Qn = f0 +
n!
nn−1 [zn]S(z)
where
S(z) = F(T(z)),
and T(z) is the Cayley tree function (T = zeT ).
For weights fk = φ(k) of polynomial growth, the schema is critical. Then, the singular
expansion of S is obtained by composing the singular expansion of f with the expansion of T,
namely, T(z) ∼1−
√
2√1 −ez as z →e−1. For instance, if φ(k) = kr for some integer r ≥
1 then F(z) has an rth order pole at z = 1. Then, the singularity type of F(T(z)) is Z−r/2
where Z = (1 −ez), which is reﬂected by Sn ≍ennr/2−1 (we use ‘≍’ to represent order-
of-growth information, disregarding multiplicative constants). After the ﬁnal normalization, we
see that Qn ≍n(r+1)/2. Globally, for many weights of the form fk = φ(k), we expect Qn to
be of the form √nφ(√n), in accordance with the fact that the expectation of the ﬁrst collision
in the birthday problem is on average near
p
πn/2. . . . . . . . . . . END OF EXAMPLE VI.12. □
 VI.20. General Bernoulli sums. Let Xn ∈Bin(n; p) be a binomial random variable with
general parameters p, q:
P(Xn = k) =
 
n
k
!
pkqn−k,
q = 1 −p.
Then with fk = φ(k), one has
E(φ(Xn)) = [zn]
1
1 −qz f
„
pz
1 −qz
«
,
so that the analysis develops as in the case Bin(n; 1
2).

 VI.21. Higher moments of the birthday problem. Take the model where there are n days
in the year and let B be the random variable representing the ﬁrst birthday collision. Then
Pn(B > k) = k!n−k`n
k
´
, and
En(Φ(B)) = Φ(1) + Qn({∆Φ(k)}),
where
∆Φ(k) := Φ(k + 1) −Φ(k).
For instance En(B) = 1 + Qn(⟨1, 1, . . .⟩). We thus get moments of various functionals (here
stated to two asymptotic terms):
Φ(x)
x
x2 + x
x3 + x2
x4 + x3
En(Φ(B))
p πn
2 + 2
3
2n + 2
3
q
πn3
2
−2n
8n2 −7
q
πn3
2
via singularity analysis.

 VI.22. How to weigh an urn? The “shake-and-paint” algorithm. You are given an urn
containing an unknown number N of identical looking balls. How to estimate this number in
much fewer than O(N) operations? A probabilistic solution due to Brassard and Bratley [71]
uses a brush and paint. Shake the urn, pull out a ball, then mark it with paint and replace it
into the urn. Repeat until you ﬁnd an already painted ball. Let X be the number of operations.
One has E(X) ∼
p
πN/2. Further more the quantity Y := X2/2 constitutes, by the previous
note, an asymptotically unbiased estimator of N, in the sense that E(Y ) ∼N. In other words,
count the time till an already painted ball is ﬁrst found, and return half of the square of this time.
One also has
p
V(Y ) ∼N. By performing the experiment m times (using m different colours
of paint) and by taking the arithmetic average of the m estimates, one obtains an unbiased

VI. 10. CLOSURE PROPERTIES
399
estimator whose typical accuracy is
p
1/m. For instance, m = 16 gives an expected accuracy
of 25%. (Similar principles are used in the design of data mining algorithms.)

 VI.23. Catalan sums. These are deﬁned by
Sn :=
X
k≥0
fk
 
2n
n −k
!
,
S(z) =
1
√1 −4z f
„1 −2z −√1 −4z
2z
«
.
The case when ρf = 1 corresponds to a critical composition, which can be discussed much in
the same way as Ramanujan sums.

Schemas. Singularity analysis also enables us to discuss at a fair level of gener-
ality the behaviour of schemas, in a way that parallels the discussion of the sequence
schema, based on a meromorphic analysis (Section V. 4, p. 313). We illustrate this
point here by means of the supercritical cycle schema. Deeper examples relative to
recursively deﬁned structures are developed in Chapter VII.
EXAMPLE VI.13.
Supercritical cycle schema. The schema H = CYC(G) forms labelled
cycles from basic components in G:
H = CYC(G)
=⇒
H(z) = log
1
1 −G(z) .
Consider the case where G attains the value 1 before becoming singular, that is, τG >
1. This corresponds to a supercritical composition schema, which can be discussed in a way
that closely parallels the supercritical sequence schema (Section V. 4, p. 313): a logarithmic
singularity replaces a polar singularity.
Let σ := ρH, which is determined by G(σ) = 1. First, one ﬁnds:
H(z) ∼
z→σ log
1
1 −z/σ −log(σG′(σ)) + A(z),
where A(z) is analytic at z = σ. Thus:
[zn]H(z) ∼σ−n
n .
(The error term implicit in this estimate is exponentially small).
The BGF H(z, u) = log(1 −uG(z))−1 has the variable u marking the number of com-
ponents in H-objects. In particular, the mean number of components in a random H-object of
size n is ∼λn, where λ = 1/(σG′(σ)), and the distribution is concentrated around its mean.
Similarly, the mean number of components with size k in a random Hn object is found to be
asymptotic to λgkσk, where gk = [zk]G(z). . . . . . . . . . . . . . . . . . END OF EXAMPLE VI.13. □
VI. 10. Closure properties
At this stage, we have available composition rules for singular expansions under
operations like ±, ×, ÷. These are induced by corresponding rules for extended
formal power series, where generalized exponents and logarithmic factors are allowed.
Also, from Section VI. 7, inversion of analytic functions normally gives rise to square-
root singularities and, from Section VI. 9, functions amenable to singularity analysis
are essentially closed under composition.

400
VI. SINGULARITY ANALYSIS OF GF’S
In this section8 we show that functions of singularity analysis class satisfy explicit
closure properties under differentiation, integration, and Hadamard product. In order
to keep the developments simple, we shall mostly restrict attention to functions that
are ∆–analytic and admit a simple singular expansion of the form
(48)
f(z) =
J
X
j=0
cj(1 −z)αj + O((1 −z)A),
or a simple singular expansion with logarithmic terms
(49)
f(z) =
J
X
j=0
cj (L(z)) (1 −z)αj + O((1 −z)A),
L(z) := log
1
1 −z .
where each cj is a polynomial. These are the most frequently occurring in applica-
tions, and the proof techniques are easily extended to deal with more general situation.
Subsection VI. 10.1 treats differentiation and integration; Subsection VI. 10.2 pre-
sents the closure of functions that admit simple expansions under Hadamard prod-
uct. Finally, Subsection VI. 10.3, concludes with an examination of several interesting
classes of tree recurrences, where all the closure properties previously established are
put to use in order to quantify precisely the asymptotic behaviour of recurrences that
are attached to tree models.
VI. 10.1. Differentiation and integration. Functions of singularity analysis class
are closed under differentiation, this is in sharp contrast with real analysis. In the sim-
ple cases9 of (48) and (49), closure under integration is also satisﬁed. The general
principle (Theorems VI.8 and VI.9 below) is the following: Derivatives and primi-
tives of functions that are of singularity analysis class admit singular expansions that
can be obtained term by term via formal differentiation and integration.
The following statement is a version tuned to our needs of well-known differen-
tiability properties of complex asymptotic expansions (see, e.g., Olver’s book [381,
p. 9]).
Theorem VI.8 (Singular differentiation). Let f(z) be ∆-analytic with a singular ex-
pansion near its singularity of the simple form
f(z) =
J
X
j=0
cj(1 −z)αj + O((1 −z)A).
Then, for each integer r > 0, the derivative
dr
dzr f(z) is ∆–analytic. The expansion of
the derivative at the singularity is obtained through term-by-term differentiation:
dr
dzr f(z) = (−1)r
J
X
j=0
cj
Γ(αj + 1)
Γ(αj + 1 −r)(1 −z)αj−r + O((1 −z)A−r).
8This section contains supplementary material that may be omitted on a ﬁrst reading. The contents
are liberally borrowed from an article of Fill, Flajolet, and Kapur [163].
9It would be possible but unwieldy to treat a larger class, which would have to include arbitrarily
nested logarithms, since, for instance, R dx/x = log x, R dx/(x log x) = log log x, and so on.

VI. 10. CLOSURE PROPERTIES
401
z
radius
1
κ | 1 − z |
φ
φ ’
FIGURE VI.14. The geometry of the contour γ(z) used in the proof of the differentia-
tion theorem.
PROOF. Clearly, all that is required is to establish the effect of differentiation on error
terms, which is expressed symbolically as
d
dz O((1 −z)A) = O((1 −z)A−1).
By bootstrapping, only the case of a single differentiation (r = 1) needs to be consid-
ered.
Let g(z) be a function that is regular in a domain ∆(φ, η) where it is assumed to
satisfy g(z) = O((1 −z)A) for z ∈∆. Choose a subdomain ∆′ := ∆(φ′, η′), where
φ < φ′ < π
2 and 0 < η′ < η. By elementary geometry, for a sufﬁciently small κ > 0,
the disc of radius κ|z −1| centered at a value z ∈∆′ lies entirely in ∆; see Figure 14.
We ﬁx such a small value κ and let γ(z) represent the boundary of that disc oriented
positively.
The starting point is Cauchy’s integral formula
(50)
g′(z) =
1
2πi
Z
C
g(w)
dw
(w −z)2 ,
a direct consequence of the residue theorem. Here C should encircle z while lying
inside the domain of regularity of g, and we opt for the choice C ≡γ(z). Then trivial
bounds applied to (50) give
|g′(z)|
=
O
 ||γ(z)|| · (1 −z)A|1 −z|−2
=
O
 |1 −z|A−1
.
The estimate involves the length of the contour, ||γ(z)||, which is O(1 −z) by con-
struction, as well as the bound on g itself, which is O((1 −z)A) since all points of the
contour are themselves at a distance exactly of the order of |1 −z| from 1.
□
 VI.24. Differentiation and logarithms. Let g(z) satisfy
g(z) = O
“
(1 −z)AL(z)k”
,
L(z) = log
1
1 −z ,
for k ∈Z≥0. Then, one has
dr
dzr g(z) = O
“
(1 −z)A−rL(z)k”
.
(The proof follows along the lines of Theorem VI.8.)


402
VI. SINGULARITY ANALYSIS OF GF’S
It is well known that integration of asymptotic expansions is usually easier than
differentiation. Here is a statement custom-tailored to our needs.
Theorem VI.9 (Singular integration). Let f(z) be ∆-analytic and admit a ∆-expansion
near its singularity of the form
f(z) =
J
X
j=0
cj(1 −z)αj + O((1 −z)A).
Then R z
0 f(t) dt is ∆–analytic. Assume further hat none of the quantities αj and A
equals −1.
(i) If A < −1, then the singular expansion of
R
f is
(51)
Z z
0
f(t) dt = −
J
X
j=0
cj
αj + 1(1 −z)αj+1 + O
 (1 −z)A+1
.
(ii) If A > −1, then the singular expansion of R f is
(52)
Z z
0
f(t) dt = −
J
X
j=0
cj
αj + 1(1 −z)αj+1 + L0 + O
 (1 −z)A+1
,
where the “integration constant” L0 has the value
L0 :=
X
αj<−1
cj
αj + 1 +
Z 1
0
h
f(t) −
X
αj<−1
cj(1 −t)αji
dt.
The case where either some αj or A is −1 is easily treated by the additional rules
Z z
0
(1 −t)−1 dt = L(z),
Z z
0
O((1 −t)−1) dt = O(L(z)).
that are consistent with elementary integration, and similar rules are easily derived for powers
of logarithms. Furthermore, the corresponding O–transfers hold true. (The proofs are simple
modiﬁcations of the one given below for the basic case.)
PROOF. The basic technique consists in integrating, term by term, the singular expan-
sion of f. We let r(z) be the remainder term in the expansion of f, that is,
r(z) := f(z) −
J
X
j=0
cj(1 −z)αj.
By assumption, throughout the ∆-domain one has, for some positive constant K,
|r(z)| ≤K|1 −z|A.
(i) Case A < −1. Straight-line integration between 0 and z, provides (51), as
soon as it has been established that
Z z
0
r(t) dt = O
 |1 −z|A+1
.

VI. 10. CLOSURE PROPERTIES
403
0
1
1 + η
φ
z
γ1
γ2
FIGURE VI.15. The contour used in the proof of the integration theorem.
By Cauchy’s integral formula, we can choose any path of integration that stays within
the region of analyticity of r. We choose the contour γ := γ1∪γ2, shown in Figure 15.
Then, one has

Z
γ
r(t) dt
 ≤

Z
γ1
r(t) dt
 +

Z
γ2
r(t) dt

≤K
Z
γ1
|1 −t|A |dt| + K
Z
γ2
|1 −t|A| |dt|
= O(|1 −z|A+1).
where the symbol |dt| designates the differential line-length element in the corre-
sponding curvilinear integral. Both integrals are O(|1 −z|A+1): for the integral
along γ1, this results from explicitly carrying out the integration; for the integral along
γ2, this results from the trivial bound O(||γ2||(1 −z)A).
(ii) Case A > −1. We let f−(z) represent the “divergence part” of f that gives
rise to nonintegrability:
f−(z) :=
X
αj<−1
cj(1 −z)αj.
Then with the decomposition f = [f −f−] + f−, integrations can be performed
separately. First, one ﬁnds
Z z
0
f−(t) dt = −
X
αj<−1
cj
αj + 1(1 −z)αj+1 +
X
αj<−1
cj
αj + 1.

404
VI. SINGULARITY ANALYSIS OF GF’S
Next, observe that the asymptotic condition guarantees the existence of
R 1
0 applied to
[f −f−], so that
Z z
0
[f(t) −f−(t)] dt =
Z 1
0
[f(t) −f−(t)] dt +
Z z
1
[f(t) −f−(t)] dt.
The ﬁrst of these two integrals is a constant that contributes to L0. As to the second
integral, term-by-term integration yields
Z z
1
[f(t) −f−(t)] dt = −
X
αj>−1
cj
αj + 1(1 −z)αj+1 +
Z z
1
r(t) dt.
The remainder integral is ﬁnite, given the growth condition on the remainder term,
and, upon carrying out the integration along the rectilinear segment joining 1 to z,
trivial bounds show that it is indeed O(|1 −z|A+1).
□
VI. 10.2. Hadamard Products. The Hadamard product of two functions f(z)
and g(z) analytic at the origin is deﬁned as their term-by-term product,
(53) f(z) ⊙g(z) =
X
n≥0
fngnzn,
where
f(z) =
X
n≥0
fnzn,
g(z) =
X
n≥0
gnzn.
We are going to see, following an article of Fill, Flajolet, and Kapur [163], that simple
functions of singularity analysis class are closed under Hadamard product. Establish-
ing such a closure property requires methods for composing functions from the basic
scale, namely (1 −z)a, as well as error terms of the form O((1 −z)A). We address
each problem in turn.
The expansion around the origin,
(54)
(1 −z)a = 1 + −a
1 z + (−a)(−a + 1)
2!
z2 + · · · ,
gives through term-by-term multiplication
(55)
(1 −z)a ⊙(1 −z)b = 2F1[−a, −b; 1; z].
Here 2F1 represents the classical hypergeometric function of Gauss deﬁned by
(56)
2F1[α, β; γ; z] = 1 + αβ
γ
z
1! + α(α + 1)β(β + 1)
γ(γ + 1)
z2
2! + · · · .
From their transformation theory, see for instance [492, Ch XIV], hypergeometric
functions can generally be expanded in the vicinity of z = 1 by means of the z 7→1−z
transformation. Instantiation of this transformation with γ = 1 yields
(57)
2F1[α, β; 1; z] =
Γ(1 −α −β)
Γ(1 −α)Γ(1 −β) 2F1[α, β; α + β; 1 −z]
+ Γ(α + β −1)
Γ(α)Γ(β)
(1 −z)−α−β+1 2F1[1 −α, 1 −β; 2 −α −β; 1 −z].
From there, we can state:

VI. 10. CLOSURE PROPERTIES
405
Theorem VI.10 (Hadamard Composition). When neither of a, b, a + b is an integer,
the Hadamard product (1 −z)a ⊙(1 −z)b has an inﬁnite ∆-expansion with exponent
scale {0, 1, 2, . . .} ∪{a + b + 1, a + b + 2, . . .}, namely,
(1 −z)a ⊙(1 −z)b ∼
X
k≥0
λ(a,b)
k
(1 −z)k
k!
+
X
k≥0
µ(a,b)
k
(1 −z)a+b+1+k
k!
,
where the coefﬁcients λ and µ are given by
λ(a,b)
k
=
Γ(1 + a + b)
Γ(1 + a)Γ(1 + b)
(−a)k(−b)k
(−a −b)k ,
µ(a,b)
k
= Γ(−a −b −1)
Γ(−a)Γ(−b)
(1 + a)k(1 + b)k
(2 + a + b)k
.
Here xk is deﬁned for k ∈Z≥0 by xk := x(x + 1) · · · (x + k −1).
 VI.25. Special cases. The case where either a or b is an integer poses no difﬁculty, since, for
m ∈Z≥0, the function (1 −z)m ⊙g(z) is a polynomial, while, (1 −z)−m ⊙g(z) is reducible
to a derivative of g, to which the Singular Differentiation Theorem can be applied.
The case a + b ∈Z needs transformation formulæ that extend (57): the principles (based
on a Lindel¨of integral representation and developed by Barnes) are described in [492, §14.53],
while the formulæ appear explicitly in [2, pp. 559–560].

 VI.26. Simple expansions with logarithmic terms. The technique of differentiation with
respect to a parameter,
ˆ
(1 −z)−αL(z)
˜
⊙(1 −z)−β = ∂
∂α
h
(1 −z)−α ⊙(1 −z)−βi
,
makes it possible to derive explicit composition rules for expansions involving logarithmic
terms.

Next, we address the Hadamard composition of error terms in singular expan-
sions. The way Hadamard products preserve ∆–analyticity and compose error terms
is summarized by the following statement.
Theorem VI.11 (Hadamard closure). (i) Assume that f(z) and g(z) are ∆-analytic
in ∆(ψ0, η). Then the Hadamard product (f ⊙g)(z) is analytic in a (possibly smaller)
∆-domain, call it ∆′.
(ii) Assume further that
f(z) = O((1 −z)a) and g(z) = O((1 −z)b),
z ∈∆(ψ0, η).
Then the Hadamard product (f ⊙g)(z) admits in ∆′ an expansion given by the fol-
lowing rules:
— If a + b + 1 < 0, then
(f ⊙g)(z) = O((1 −z)a+b+1).
— If k < a + b + 1 < k + 1, for some integer k ∈Z≥−1, then
(f ⊙g)(z) =
k
X
j=0
(−1)j
j!
(f ⊙g)(j) (1)(1 −z)j + O
 (1 −z)a+b+1
.
— If a + b + 1 is a nonnegative integer, then (with L(z) = log(1 −z)−1)
(f ⊙g)(z) =
k
X
j=0
(−1)j
j!
(f ⊙g)(j) (1)(1 −z)j + O
 (1 −z)a+b+1L(z)

.

406
VI. SINGULARITY ANALYSIS OF GF’S
PROOF. (Sketch) The starting point is an important formula due to Hadamard that
expresses Hadamard products as a contour integral:
(58)
f(z) ⊙g(z) =
1
2iπ
Z
γ
f(w)g
 z
w
 dw
w .
The contour γ in the w-plane should be chosen such that both factors, f(w) and
g(z/w) are analytic. In other words, given the domain ∆in which both f and g
are analytic, one should have γ ⊂∆∩(z∆−1).
In the ﬁrst case (a + b + 1 < 0), the precise geometry of a feasible contour γ
is described in [163], the principles being similar to those employed in the construc-
tion of Hankel contours elsewhere in this chapter. The integral giving the value of the
Hadamard product is ﬁnally estimated trivially, based on the order of growth assump-
tions on f and g, as z →1. This approach extends to the case a + b + 1 = 0, where a
logarithmic factor comes in,
For the remaining cases, the easy identity
ϑc+d(f ⊙g) = (ϑcf) ⊙
 ϑdg

,
where
ϑ ≡z d
dz ,
reduces the analysis to the situation where a + b + 1 < 0. It sufﬁces to differenti-
ate sufﬁciently many times and ﬁnally integrate back, as permitted by the Singular
Integration Theorem.
□
Globally, Theorems VI.10 and VI.11 establish the closure under Hadamard prod-
ucts of functions amenable to singularity analysis in the sense of (48). In practice,
in order to derive the singular expansion of a function at a singularity, one may con-
veniently appeal to the Zigzag Algorithm described in Figure 16, whose validity is
ensured by the a priori knowledge of the existence of an expansion guaranteed by
Theorems VI.10 and VI.11. A typical application of this algorithms appears in Equa-
tions (61) and (62) below, in the context of P´olya’s drunkard problem.
EXAMPLE VI.14.
P´olya’s drunkard problem. (This example is taken from [163].) In the
d–dimensional lattice Zd of points with integer coordinates, the drunkard performs a random
walk starting from the origin with steps in {−1, +1}d, each taken with equal likelihood. The
probability that the drunkard is back at the origin after 2n steps is
(59)
q(d)
n
=
 
1
22n
 
2n
n
!!d
,
since the walk is a product d independent 1–dimensional walks. The probability that 2n is the
epoch of the ﬁrst return to the origin is the quantity p(d)
n , which is determined implicitly by
(60)
 
1 −
∞
X
n=1
p(d)
n zn
!−1
=
∞
X
n=0
q(d)
n zn,
as results from the convolution equations expressing the decomposition of loops into primitive
loops. In terms of the associated ordinary generating functions P and Q, this relation thus reads
as (1 −P(z))−1 = Q(z).
The asymptotic analysis of the qn’s is straightforward; the one of the pn’s is more in-
volved and is of interest in connection with recurrence and transience of the random walk; see,

VI. 10. CLOSURE PROPERTIES
407
Let f(z) and g(z) be ∆–analytic and admit simple singular expansions of the form (48) or (49).
What is sought is the singular expansion of
h(z) := f(z) ⊙g(z).
Step 1. Determine the asymptotic expansions fn = [zn]f(z) and gn = [zn]g(z) induced by
the singular expansions of f and g in accordance with the singularity analysis process. Given
ﬁnite singular expansions of f and g, the order C of the error in the expansion of h is known a
priori by Theorem VI.11.
Step 2. Deduce from Step 1 an asymptotic expansion of hn = [zn]h(z) by usual multiplication
from the expansions of fn and gn.
Step 3. Reconstruct by singularity analysis a function H(z) that is singular at 1 and is such that
[zn]H(z) ∼[zn]h(z).
This can be done by using the expansions of basic functions, as provided by Theorems VI.1
and VI.2 in the reverse direction. By construction, H(z) is a sum of functions of the form
(1 −z)αL(z)k, which are all singular at 1.
Step 4. Output the singular expansion of f ⊙g as
h(z) = H(z) + P(z) + O
“
(1 −z)C”
,
where P is a polynomial of degree δ, which is the largest integer < C. The polynomial P(z)
is needed, since polynomials (and more generally functions analytic at 1) do not leave a trace
in asymptotic expansions of coefﬁcients. Since h(z) −H(z) is δ times differentiable at 1, one
must take
P(z) =
δ
X
j=0
(−1)j
j!
∂j
z (h(z) −H(z))z=1 (1 −z)j.
FIGURE VI.16.
The Zigzag algorithm for computing singular expansions of Hadamard
products.
e.g., [133, 329]. The Hadamard closure theorem provides a direct access to this problem. Deﬁne
λ(z) :=
X
n≥0
1
22n
 
2n
n
!
zn ≡
1
√1 −z .
Then, Equations (59) and (60) imply:
P(z) = 1 −
1
λ(z)⊙d ,
where
λ(z)⊙d := λ(z) ⊙· · · ⊙λ(z) (d times).
The singularities of P(z) are found to be as follows.
Case d = 1: No Hadamard product is involved and
P(z) = 1 −
√
1 −z,
implying
p(1)
n
=
1
n22n−1
 
2n −2
n −1
!
∼
1
2
√
πn3 .
(This agrees with the classical combinatorial solution expressed in terms of Catalan numbers.)
Case d = 2: By the Hadamard closure theorem, the function Q(z) = λ(z) ⊙λ(z) admits
a priori a singular expansion at z = 1 that is composed solely of elements of the form (1 −z)α
possibly multiplied by integral powers of the logarithmic function L(z). From a computational

408
VI. SINGULARITY ANALYSIS OF GF’S
standpoint (cf. the Zigzag Algorithm), it is then best to start from the coefﬁcients themselves,
(61)
q(2)
n
∼
„
1
√πn −
1
8
√
πn3 + · · ·
«2
∼1
π
„ 1
n −
1
4n2 + · · ·
«
,
and reconstruct the only singular expansion that is compatible, namely
(62)
Q(z) = 1
π L(z) + K + O((1 −z)1−ǫ),
where ǫ > 0 is an arbitrarily small constant and K is fully determined as the limit as z →
1 of Q(z) −π−1L(z). Then it can be seen that the function P is ∆–continuable. (Proof:
Otherwise, there would be complex poles arising from zeros of the function Q on the unit disc,
and this would entail in p(2)
n
the presence of terms oscillating around 0, a fact that contradicts
the necessary positivity of probabilities.) The singular expansion of P(z) at z = 1 results
immediately from that of Q(z):
P(z) ∼1 −
π
L(z) + π2K
L2(z) + · · · .
so that, by Theorems VI.2 and VI.3, one has
p(2)
n
=
π
n log2 n −2π γ + πK
n log3 n + O
„
1
n log4 n
«
K
=
1 +
∞
X
n=1
 
16−n
 
2n
n
!2
−1
πn
!
.=
0.8825424006106063735858257 .
(See the study by Louchard et al. [345, Sec. 4] for somewhat similar calculations.)
Case d = 3: This case is easy since Q(z) remains ﬁnite at its singularity z = 1 where it
admits an expansion in powers of (1 −z)1/2, to the effect that
q(3)
n
∼
„
1
√πn −
1
8
√
πn3 + · · ·
«3
∼
1
π3/2
„
1
n3/2 −
3
8n5/2 + · · ·
«
.
The function Q(z) is a priori ∆-continuable and its singular expansion can be reconstructed
from the form of coefﬁcients:
Q(z) ∼
z→1 Q(1) −2
π
√
1 −z + O(|1 −z|),
leading to
P(z) =
„
1 −
1
Q(1)
«
−
2
πQ2(1)
√
1 −z + O(|1 −z|).
By singularity analysis, the last expansion gives
p(3)
n
=
1
π3/2Q2(1)
1
n3/2 + O
„ 1
n2
«
Q(1)
=
π
Γ
` 3
4
´4
.= 1.3932039296856768591842463.
A complete asymptotic expansion in powers n−3/2, n−5/2, . . . can be obtained by the same de-
vices. In particular this improves the error term above to O(n−5/2). The explicit form of Q(1)
results from its expression as the generalized hypergeometric 3F2[ 1
2, 1
2, 1
2; 1, 1; 1], which eval-
uates by Clausen’s theorem and Kummer’s identity to the square of a complete elliptic integral.
(See the papers by Larry Glasser for context, for instance [236]; nowadays, several computer
algebra systems even provide this value automatically.)

VI. 10. CLOSURE PROPERTIES
409
Higher dimensions are treated similarly, with logarithmic terms surfacing in asymptotic
expansions for all even dimensions. . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE VI.14. □
VI. 10.3. Tree recurrences. To conclude with singularity analysis theory, we
present the general framework of tree recurrences, also known as probabilistic divide-
and-conquer recurrences, which are recurrences of the general form
(63)
fn = tn +
X
k
pn,k(fk + fn−a−k),
(n ≥n0).
There, (fn) is the sequence implicitly determined by the recurrence, assuming known
initial conditions f0, . . . , fn0−1; the sequence (tn) is known as the sequence of tolls;
the array (pn,k) is a triangular array of numbers that are probabilities in the sense that,
for each ﬁxed n ≥0, one has P
k pn,k = 1; the number a is a small ﬁxed integer
(usually 0 or 1).
The interpretation of the recurrence is in the form of a splitting process : a collec-
tion of n elements is given; a number a of these is put aside and the rest is partitioned
into two subgroups, a “left” subgroup of cardinality Kn and a “right” subgroup of
cardinality n −a −Kn. The quantity Kn is a random variable with probability distri-
bution
P(Kn = k) = pn,k.
The splitting is repeated recursively till only groups of size less than the threshold
n0 are obtained. Assuming stochastic independence of all the random variables K
involved, it is seen that fn represents the expectation of the (total) cost Cn of a random
(recursive) splitting, when a single stage involving n elements incurs a toll equal to tn.
In symbols:
fn = E(Cn),
Cn = tn + CKn + Cn−a−Kn.
Clearly, a particular realization of the splitting process can be represented by a
binary tree. With a suitable choice of probabilities, such processes can be used to anal-
yse cost functional of increasing binary trees, and binary Catalan trees, for instance.
A prime motivation is the analysis of divide-and-conquer algorithms in computer sci-
ence, like quicksort, mergesort, union-ﬁnd algorithms, and so on [101, 208, 433]. Our
treatment once more follows the article [163].
A general approach to the asymptotic solution of a tree recurrence goes as fol-
lows. First, introduce generating functions,
f(z) =
X
n
fnωnzn,
t(z) =
X
n
tnω′
nzn,
for some normalization sequences (ωn) and (ω′
n) that are problem-speciﬁc. (So, ωn ≡
1 gives rise to an OGF, ωn ≡1/n! to an EGF, with other normalizations being also
useful.) Then, by linearity of the original recurrence, there exists a linear operator L
on series (and functions), such that
f(z) = L[t(z)].
Provided the splitting probabilities pn,k have expressions of a tractable form, it is rea-
sonable to attempt expressing L in terms of the usual operations of analysis. One may
then investigate the way L affects singularities and deduce the asymptotic form of the

410
VI. SINGULARITY ANALYSIS OF GF’S
cost sequence (fn) from the singularities of its generating function, f(z). An inter-
esting feature of this approach is to allow for a powerful discussion of the relationship
between tolls and induced costs, in a way that parallels composition of singularities
in Section VI. 9. Closure properties discussed earlier in this section are naturally a
crucial ingredient in the intervening singularity analysis process.
The three examples that we present combine closure properties with the singu-
larity analysis of polylogarithms of Section VI. 8. Example 15 is relative to increas-
ing binary trees and binary search trees (Example II.17, p. 132). Example 16 dis-
cusses additive costs of random binary Catalan trees in the perspective of tree recur-
rences. Finally, Example 17 shows the applicability of singularity analysis to a basic
coalescence-fragmentation process.
EXAMPLE VI.15. The binary search tree recurrence. One of the simplest random tree models
is deﬁned as follows: a random binary tree of size n ≥1 is obtained by taking a root and
appending to it a left subtree of size Kn and a right subtree of size n −1 −Kn, where Kn is
uniformly distributed over the set of permissible values {0, 1, . . . , n −1}. A tree of size 0 is
the empty tree. In earlier notations, this process corresponds to
pn,k ≡P(Kn = k) = 1
n,
0 ≤k ≤n −1.
The associated tree recurrence is then
fn = tn + 2
n
n−1
X
k=0
fk,
f0 = t0,
which translates for OGFs,
f(z) :=
X
n≥0
fnzn,
t(z) =
X
n≥0
tnzn,
into a linear integral equation:
(64)
f(z) = t(z) + 2
Z z
0
f(w)
dw
1 −w .
Differentiation yields the ordinary differential equation
f ′(z) = t′(z) +
2
1 −z f(z),
f(0) = t0,
which is then solved by the variation-of-constants method. In this way, it is found that an
integral transform expresses the relation between the GF of tolls and the GF of total costs.
Assuming without loss of generality t0 = 0, we have (with ∂w ≡
d
dw )
(65)
f(z) = L[t(z)],
where
L[t(z)] =
1
(1 −z)2
Z z
0
(∂wt(w)) (1 −w)2 dw.
Simple toll sequences that admit generating functions of a simple form can then be em-
ployed to build a repertoire10 that already provides useful indications on the relations between
the orders of growth of (tn) and (fn). For instance, we ﬁnd, for the rising-factorial tolls
8
>
>
>
>
<
>
>
>
>
:
tα
n :=
 
n + α
α
!
,
tα(z) = (1 −z)−α−1,
f α(z) = α −1
α + 1
ˆ
(1 −z)−α−1 −(1 −z)−2˜
,
f α
n = α −1
α + 1
" 
n + α
α
!
−n −1
#
,
10The repertoire approach is developed in an attractive manner by Green and Knuth in [250].

VI. 10. CLOSURE PROPERTIES
411
Tolls (tn)
Costs (fn)
tn = nα
(2 < α)
fn = α + 1
α −1nα + O(nα−1)
tn = nα
(1 < α < 2)
fn = α + 1
α −1nα + O(n)
tn =
 
n + α
α
!
(α > 1)
α −1
α + 1
" 
n + α
α
!
−n + 1
#
∼α + 1
α −1
nα
Γ(α + 1)
tn =
 
n + α
α
!
(α < 1)
1 −α −1
1 + α
"
n + 1 −
 
n + α
α
!#
∼1 + α
1 −αn
tn = nα
(0 < α < 1)
Kαn + O(nα)
tn = log n
K′
0n −log n + O(1)
FIGURE VI.17. Tolls and costs for the binary search tree recurrence, assuming t0 = 0.
for α ̸= 1, while α = 1 corresponding to t1
n = n + 1 leads to
f 1(z) =
2
(1 −z)2 log
1
1 −z ,
f 1
n = 2(n + 1)(Hn+1 −1) = 2n log n + O(n),
with Hn a harmonic number. The emergence of an extra logarithmic factor for α = 1 is to
be noted: it corresponds to the fact that path length in a binary search tree or an increasing
binary tree of size n is ∼2n log n. These elementary techniques provide a ﬁrst set of entries
recapitulated in Figure 17.
Singularity analysis furthermore permits us to develop a complete asymptotic expansion
for tolls of the form √n, log n, and many others. Consider for instance the toll tα
n = nα,
for which the generating function, a polylogarithm, is known to admit a singular expansions in
terms of elements of the form (1 −z)β, with the main term corresponding to β = −α −1
when α > −1 (Theorem VI.7). The L transformation reads as a succession of operations,
”differentiate, multiply by (1 −z)2, integrate, multiply by (1 −z)−2”, which are covered by
Theorems VI.8 and VI.9. The chain on any particular element starts as
c(1 −z)β
∂
−→
cβ(1 −z)β−1
×(1−z)2
−→
cβ(1 −z)β+1,
at which stage integration intervenes. According to Theorem VI.9, assuming β ̸= −2 and
ignoring integration constants, integration gives
cβ(1 −z)β+1
R
−→
−c
β
β + 2(1 −z)β+2
×(1−z)−2
−→
−c
β
β + 2(1 −z)β.
Thus, the singular element (1 −z)β corresponds to a contribution
−c
β
β + 2
 
n −β −1
−β −1
!
,
which is of order O(n−β−1). It can be veriﬁed that this chain of operations sufﬁces to determine
the leading order of fn when tn = nα and α > 1.
The derivation above is representative of the main lines of the analysis, but it has left
aside the determination of integration constants, which play a dominant rˆole when tn = nα
and α < 1 (because a term of the form K/(1 −z)2 then dominates in f(z)). Introduce, in

412
VI. SINGULARITY ANALYSIS OF GF’S
accordance with the statement of the Singular Integration Theorem (Theorem VI.9) the quantity
K[t] :=
Z 1
0
h
t′(w)(1 −w)2 −
`
t′(w)(1 −w)2´
−
i
dw,
where f−represents the sum of singular terms of exponent < −1 in the singular expansion of
f(z). Then, for tn = nα with 0 < α < 1, taking into account the integration constant (which
gets multiplied by (1 −z)−2, given the shape of L), we ﬁnd for α < 1:
fn ∼Kαn,
Kα = K[Li−α] = 2
∞
X
n=1
nα
(n + 1)(n + 2).
Similarly, the toll tn = log n gives rise to
fn ∼K′
0n,
K′
0 = 2
∞
X
n=1
log n
(n + 1)(n + 2)
.= 1.2035649167.
This last estimate quantiﬁes the entropy of the distribution of binary search trees, which is stud-
ied by Fill in [164], and discussed in the reference book by Cover and Thomas on information
theory [103, p. 74-76]. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE VI.15. □
EXAMPLE VI.16.
The binary tree recurrence. Consider a procedure that on a binary tree
performs some calculation (without affecting the tree itself) at a cost of tn, then recursively
calls itself on the left and right subtrees. If the binary tree to which the procedure is applied
is drawn uniformly amongst all binary trees of size n the expectation of the total costs of the
procedure satisﬁes the recurrence
(66)
fn = tn +
n−1
X
k=0
CkCn−1−k
Cn
(fk + fn−k)
with
Cn =
1
n + 1
 
2n
n
!
.
Indeed, the quantity
pn,k = CkCn−1−k
Cn
represents the probability that a random tree of size n has a left subtree of size k and a right
subtree of size n −k. It is then natural to introduce the generating functions
t(z) =
X
n≥0
tnCnzn,
f(z) =
X
n≥0
fnCnzn,
and the recurrence (66) translates into a linear equation:
f(z) = t(z) + 2zC(z)f(z),
with C(z) the OGF of Catalan numbers. Now, given a toll sequence (tn) with ordinary gener-
ation function
τ(z) :=
X
n≥0
tnzn,
the function t(z) is a Hadamard product: t(z) = τ(z) ⊙C(z). Also, C(z) is well known, so
that the fundamental relation is
(67)
f(z) = L[τ(z)],
where
L[τ(z)] = τ(z) ⊙C(z)
√1 −4z
,
C(z) = 1 −√1 −4z
2z
.
This transform relates the ordinary generating function of tolls to the normalized generating
function of the total costs via a Hadamard product.

VI. 10. CLOSURE PROPERTIES
413
Tolls (tn)
Costs (fn)
nα
( 3
2 < α)
Γ(α −1
2)
Γ(α)
nα+1/2 + O(nα−1/2)
n3/2
2
√π n2 + O(n log n)
nα
( 1
2 < α < 3
2)
Γ(α −1
2)
Γ(α)
nα+1/2 + O(n)
n1/2
1
√π n log n + O(n)
nα
(0 < α < 1
2)
Kαn + O(1)
log n
K
′
0n + O(√n
FIGURE VI.18. Tolls and costs for the binary tree recurrence.
The calculation for simple tolls like nr with r ∈Z≥0 can be carried out elementarily. For
the tolls tα
n = nα what is required is the singular expansion of
τ(z) ⊙C
“z
4
”
= Li−α(z) ⊙C
“z
4
”
=
∞
X
n=1
nα
n + 1
 
2n
n
! “z
4
”n
.
This is precisely covered by Theorems VI.10 and VI.11. The results of Figure 18 follow, after
routine calculations. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE VI.16. □
EXAMPLE VI.17.
The Cayley tree recurrence. Consider n vertices labelled 1, . . . , n. There
are (n −1)!nn−2 sequences of edges,
⟨u1, v1, ⟩, ⟨u2, v2, ⟩, · · · ⟨un−1, vn−1, ⟩,
that give rise to a tree over {1, . . . , n}, and the number of such sequences is (n−1)!nn−2 since
there are nn−2 unrooted trees of size n. At each stage k, the edges numbered 1 to k determine a
forest. Each addition of an edge connects two trees and reduces the number of trees in the forest
by 1, so that the forest evolves from the totally disconnected graph (at time 0) to an unrooted
tree (at time n −1). If we consider each of the sequences to be equally likely, the probability
that un−1 and vn−1 belong to components of size k and (n −k) is
1
2(n −1)
 
n
k
!
kk−1nn−k−1
nn−2
.
(The reason is that there are nn−2 unrooted trees; the last added edge has n −1 possibilities
and 2 possible orientations.)
Assume that the aggregation of two trees into a tree of size equal to ℓincurs a toll of tℓ.
The total cost of the aggregation process for a ﬁnal tree of size n satisﬁes the recurrence
(68)
fn = tn +
X
0<k<n
pn,k(fk + fn−k),
pn,k =
1
2(n −1)
 
n
k
!
kk−1nn−k−1
nn−2
.
The recurrence (68) has been studied in detail by Knuth and Pittel [311], building upon earlier
works of Knuth and Sch¨onhage [312]. A prime motivation of the cited works is the importance
of this recurrence in algorithms that dynamically manage equivalence relations (the so-called
union-ﬁnd algorithm [312]).

414
VI. SINGULARITY ANALYSIS OF GF’S
Tolls (tn)
Costs (fn)
nα
( 3
2 < α)
Γ(α −1
2)
√
2Γ(α)
nα+1/2 + O(nα−1/2)
n3/2
r
2
π n2 + O(n log n)
nα
( 1
2 < α < 3
2)
Γ(α −1
2)
√
2Γ(α)
nα+1/2 + O(n)
n1/2
1
√
2π
n log n + O(n)
nα
(0 < α < 1
2)
b
Kαn + O(1)
log n
b
K′
0n + O(√n
FIGURE VI.19. Tolls and costs for the Cayley tree recurrence.
Given the sequence of tolls (tn), we introduce the generating function
τ(z) =
X
n≥1
tnzn,
and let T be the Cayley tree function (T = zeT ). For total costs, the generating function
adopted is
f(z) =
X
n≥1
fnnn−1zn.
The basic recurrence (68) can then be rephrased as an integral transform involving a Hadamard
product, namely,
(69)
f(z) = L[τ(z)],
with
L[τ](z) = 1
2
T(z)
1 −T(z)
Z z
0
∂w
`
τ(w) ⊙T(w)2´
dw
T(w).
Though the expression of the transform looks formidable at ﬁrst sight, it is really nothing but a
short sequence of basic operations, “Hadamard product, multiplication, differentiation, division,
integration, multiplication”, each of which has a quantiﬁable effect on functions of singularity
analysis class. (The singularity structure of T(z) is itself determined by the Singular Inversion
Theorem, Theorem VI.6.)
The net result is that the effect of tolls of the form nα, log n, and so on, can be analysed:
see Figure 19 for a listing of estimates. Details of the proof are left as an exercise to our
reader and are otherwise found in [163, §5.3]. The analogy of behaviour with the Catalan tree
recurrence stands out.
This example is also of interest since it furnishes an analytically tractable model of a
coalescence-fragmentation process. This is a topic of great interest in several areas of science,
for which we refer to Aldous’ survey [6]. . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE VI.17. □
VI. 11. Tauberian theory and Darboux’s method
There are several alternative approaches to the analysis of coefﬁcients of func-
tions, which are of moderate growth. Naturally, All methods provide estimates com-
patible with singularity analysis methods (Theorems VI.1, VI.2, and VI.3). Each one
requires some sort of “regularity condition” either on the part of the function or on the
part of the coefﬁcient sequence, the regularity condition of singularity analysis being
in essence analytic continuation.

VI. 11. TAUBERIAN THEORY AND DARBOUX’S METHOD
415
The methods brieﬂy surveyed here fall into three broad categories: (i) Elementary
real analytic methods; (ii) Tauberian theorems; (iii) Darboux’s method.
Elementary real analytic methods assume some a priori smoothness conditions on
the coefﬁcient sequence; they are included here for the sake of completeness, though
properly speaking they do not belong to the galaxy of complex asymptotic methods.
Their scope is mostly limited to the analysis of products while the other methods
permit to approach more general functional composition patterns. Tauberian theorems
belong to the category of advanced real analysis methods; they also needs some a
priori regularity on the coefﬁcients, typically positivity or monotonicity. Darboux’s
method requires some smoothness of the function on the closed unit disk, and, by its
techniques and scope, it is the closest to singularity analysis.
We content ourselves with a brief discussion of the main results. For more infor-
mation, the reader is referred to Odlyzko’s excellent survey [377].
Elementary real analytic methods. An asymptotic equivalent of the coefﬁcients
of a function can sometimes be worked out elementarily from simple properties of the
component functions. The regularity conditions are a smooth asymptotic behaviour of
the coefﬁcients of one of the two factors in a product of generating functions. A good
source for these techniques is Bender’s survey [29].
Theorem VI.12 (Bender’s method). Let a(z) = P anzn and b(z) = P bnzn be two
power series with radii of convergence α > β ≥0 respectively. Assume that b(z)
satisﬁes the ratio test,
bn−1
bn
→β
as
n →∞.
Then the coefﬁcients of the product f(z) = a(z) · b(z) satisfy, provided a(β) ̸= 0,
[zn]f(z) ∼a(β)bn
as
n →∞.
PROOF. (Sketch) The basis of the proof is the following chain:
fn
=
a0bn + a1bn−1 + a2bn−2 + · · · + anb0)
=
bn

a0 + a1
bn−1
bn
+ a2
bn−2
bn
+ · · · + an
b0
bn

=
bn

a0 + a1(bn−1
bn
) + a2(bn−2
bn−1
)(bn−1
bn
) + · · ·

∼
bn(a0 + a1β + a2β2 + · · · ).
There, only the last line requires a little elementary analysis that is left as an exercise
to the reader.
□
This theorem applies for instance to the EGF of 2–regular graphs:
f(z) = a(z) · b(z)
with
a(z) = e−z/2−z2/4,
b(z) =
1
√1 −z ,
fow which it gives fn ∼e−3/4 n−1/2
n

∼
e−3/4
√πn , in accordance with Example 2
(p. 378). Clearly, a whole collection of lemmas can be stated in the same vein. Sin-
gularity analysis usually provides more complete expansions, though Theorem VI.12
does apply to a few situations not covered by it.

416
VI. SINGULARITY ANALYSIS OF GF’S
Tauberian theory. Tauberian methods apply to functions whose growth is only
known along the positive real line. The regularity conditions are in the form of ad-
ditional assumptions on the coefﬁcients (positivity or monotonicity) known under the
name of Tauberian “side conditions”. An insightful introduction to the subject may
be found in Titchmarsh’s book [469], and a detailed exposition in Postnikov’s mono-
graph [399] and Korevaar’s compendium [317]. We cite the most famous of all Taube-
rian theorems due to Hardy, Littlewood, and Karamata. In this section, a function is
said to be slowly varying at inﬁnity iff, for any c > 0, one has L(cx)/L(x) →1 as
x →+∞; examples of slowly varying functions are provided by powers of logarithms
or iterated logarithms.
Theorem VI.13 (The HLK Tauberian theorem). Let f(z) be a power series with
radius of convergence equal to 1, satisfying
(70)
f(z) ∼
1
(1 −z)α L(
1
1 −z ),
for some α ≥0 with L a slowly varying function. Assume that the coefﬁcients fn =
[zn]f(z) are all non–negative (this is the “side condition”). Then
(71)
n
X
k=0
fk ∼
nα
Γ(α + 1)L(n).
The conclusion (71) is consistent with what singularity analysis gives: Under the
conditions, and if in addition analytic continuation is assumed, then
(72)
fn ∼nα−1
Γ(α) L(n),
which by summation yields the estimate (71).
It must be noted that a Tauberian theorem requires very little on the part of the
function. However, it gives less since it does not provide error estimates. Also, the
result it provides is valid in the more restrictive sense of mean values, or Ces`aro aver-
ages. (If further regularity conditions on the fn are available, for instance monotonic-
ity, then the conclusion of (72) can then be deduced from (71) by purely elementary
real analysis.) The method applies only to functions that are large enough at their
singularity, and despite numerous efforts to improve the conclusions, it is the case that
Tauberian theorems have little concrete to offer in terms of error estimates.
Appeal to a Tauberian theorem is justiﬁed when a function has, apart from the
positive half line, a very irregular behaviour near its circle of convergence, for in-
stance when each point of the unit circle is a singularity. (The function is then said to
admit the unit circle as a natural boundary.) An interesting example of this situation is
discussed by Greene and Knuth [249] who consider the function
(73)
f(z) =
∞
Y
k=1
(1 + zk
k )

VI. 11. TAUBERIAN THEORY AND DARBOUX’S METHOD
417
that is the EGF of permutations having cycles all of different lengths. A little compu-
tation shows that
log
∞
Y
k=1

1 + zk
k

=
∞
X
k=1
zk
k −1
2
∞
X
k=1
z2k
k2 + 1
3
∞
X
k=1
z3k
k3 −· · ·
∼
log
1
1 −z −γ + o(1).
(Only the last line requires some care, see [249].)
Thus, we have
f(z) ∼e−γ
1 −z
=⇒
1
n(f0 + f1 + · · · + fn) ∼e−γ,
by virtue of Theorem VI.12. In fact, Greene and Knuth were able to supplement this
argument by a “bootstrapping” technique and show a stronger result, namely
fn →e−γ.
Darboux’s method. The method of Darboux requires, as regularity condition,
that functions be smooth enough —i.e., sufﬁciently differentiable— on their circle of
convergence. What lies at the heart of this many–facetted method is a simple relation
between the smoothness of a function and the corresponding decrease of its Taylor
coefﬁcients.
Theorem VI.14 (Darboux’s method). Assume that f(z) is continuous in the closed
disk |z| ≤1, and is in addition k times continuously differentiable (k ≥0) on |z| = 1.
Then
(74)
[zn]f(z) = o
 1
nk

.
PROOF. Start from Cauchy’s coefﬁcient formula
fn =
1
2iπ
Z
C
f(z)
dz
zn+1 .
Because of the continuity assumption, one may take as integration contour C the unit
circle. Setting z = eiθ yields the Fourier version of Cauchy’s coefﬁcient formula,
(75)
fn = 1
2π
Z 2π
0
f(eiθ)e−niθ dθ.
The integrand in (75) is strongly oscillating and the Riemann–Lebesgue lemma of
classical analysis (see [469, p. 403]) shows that the integral giving fn tends to 0 as
n →∞.
This argument covers the case k = 0. The case of a general k is then derived
through successive integrations by parts, as
[zn]f(z) =
1
2π(in)k
Z 2π
0
f (k)(eiθ)e−niθ dθ.
□
Various consequences of Theorem VI.14 are given in reference texts also under
the name of Darboux’s method. See for instance [98, 249, 265, 496]. We shall only

418
VI. SINGULARITY ANALYSIS OF GF’S
illustrate the mechanism by rederiving in this framework the analysis of the EGF of
2–regular graphs. Clearly, we have
(76)
f(z) = e−z/2−z2/4
√1 −z
= e−3/4
√1 −z + e−3/4√
1 −z + R(z).
There R(z) is the product of (1 −z)3/2 with a function analytic at z = 1 that is a rest
in the Taylor expansion of e−z/2−z2/4. Thus, R(z) is of class C1, i.e., continuously
differentiable once. By Theorem VI.14, we have
[zn]R(z) = o
 1
n

,
so that
(77)
[zn]f(z) = e−3/4
√πn + o
 1
n

.
Darboux’s method bears some resemblance to singularity analysis in that the esti-
mates derive from translating error terms in expansions. However, smoothness condi-
tions, rather than plain order of growth information, are required by it. The method is
often applied in situations like in (76)–(77) to functions that are products of the type
h(z)(1−z)α with h(z) analytic at 1, or combinations thereof. In such particular cases,
Darboux’s method is however subsumed by singularity analysis.
It is inherent to Darboux’s method that it cannot be applied to functions whose
singular expansion only involves terms that become inﬁnite, while singularity analy-
sis can. A clear example arises in the analysis of the common subexpression prob-
lem [209] where there occurs a function with a singular expansion of the form
1
√1 −z
1
q
log
1
1−z
"
1 +
c1
log
1
1−z
+ · · ·
#
.
 VI.27. Darboux versus singularity analysis. This note provides an instance where Darboux’s
method applies whereas singularity analysis does not. Let
Fr(z) =
∞
X
n=0
z2n
(2n)r .
The function F0(z) is singular at every point of the unit circle, and the same property holds for
any Fr with r ∈Z≥0. [Hint: F0, which satisﬁes the functional equation F(z) = z + F(z2),
grows unboundedly near 2nth roots of unity.] Darboux’s method can be used to derive
[zn]
1
√1 −z F5(z) =
c
√πn + o
„ 1
n
«
,
c := 32
31.
What is the best error term that can be obtained?

VI. 12. Perspective
The method of singularity analysis expands our ability to extract coefﬁcient asymp-
totics, to a far wider class of functions than the meromorphic and rational functions
of Chapters IV and V. This ability is the fundamental tool for analysing many of

VI. 12. PERSPECTIVE
419
the generating functions of Chapters I–III, and is applicable at a considerable level of
generality.
The basic method is straightforward and appealing: we locate singularities, es-
tablish analyticity in a domain around them, expand the functions around the singular-
ities, and apply general transfer theorems to take each term in the function expansion
to a term in an asymptotic expansion of its coefﬁcients. The method applies directly
to a large variety of explicitly given functions, for instance combinations of ratio-
nal functions, square roots, and logarithms, as well as to functions that are implicitly
deﬁned, like generating functions for tree structures, which are obtained by analytic
inversion. Functions amenable to singularity analysis also enjoy rich closure prop-
erties, and the corresponding operations mirror the natural operations on generating
functions implied by the combinatorial constructions of Chapters I–III.
This approach again sets us in the direction of the ideal situation of having a
theory where combinatorial constructions and analytic methods fully correspond, but,
again, the very essence of analytic combinatorics is that the theorems that provide
asymptotic results cannot be so general as to be free of analytic side conditions. In
the case of singularity analysis, these side conditions have to do with establishing
analyticity in a domain around singularities. These conditions are automatically satis-
ﬁed by a large number of functions with moderate (at most polynomial) growth near
their dominant singularities (most notably a large subset of the generating functions
of combinatorial structures deﬁned by the constructions of Chapters I–III) justifying
precisely what we need: a term-by-term transfer from the expansion of a generating
function at its singularity to function coefﬁcients, including error terms. The calcula-
tions involved in singularity analysis are rather mechanical. Salvy [424] has indeed
succeeded in automating the analysis of a large class of generating functions in this
way.
Again, we can look carefully at speciﬁc combinatorial constructions and then ap-
ply singularity analysis to general abstract schemas, thereby solving whole classes of
combinatorial problems at once. This process (along with several important exam-
ples) is the topic of the next chapter. After that, we consider the saddle point method
(Chapter VIII), which is appropriate for functions with no singularities at a ﬁnite dis-
tance (entire functions) as well as those whose growth is rapid (exponential) near their
singularities. Singularity analysis will surface again in Chapter IX, given its crucial
technical rˆole in obtaining uniform expansions of multivariate generating functions
near singularities.
General surveys of asymptotic methods in enumeration have been given by Bender [29]
and more recently Odlyzko [377]. A general reference to asymptotic analysis that has a remark-
ably concrete approach is De Bruijn’s book [111]. Comtet’s [98] and Wilf’s [496] books each
devote a chapter to these questions.
This chapter is largely based on the theory developed by Flajolet and Odlyzko in [199],
where the term “singularity analysis” originates from. An important early (and unduly ne-
glected) reference is the study by Wong and Wyman [501]. The theory draws its inspiration
from classical analytic number theory, for instance the prime number theorem where similar
contours are used (see the discussion in [199] for sources). Another area where Hankel con-
tours are used is the inversion theory of integral transforms [131], in particular in the case of

420
VI. SINGULARITY ANALYSIS OF GF’S
algebraic and logarithmic singularities. Closure properties developed here are from the arti-
cles [163, 176] by Flajolet, Fill, and Kapur.
Darboux’s method can often be employed as an alternative to singularity analysis. It is still
the most widely used technique in the literature, though the direct mapping of asymptotic scales
afforded by singularity analysis appears to us much more transparent. Darboux’s method is well
explained in the books by Comtet [98], Henrici [265], Olver [381], and Wilf [496]. Tauberian
theory is treated in detail in Postnikov’s monograph [399] and Korevaar’s encyclopedic treat-
ment [317], with an excellent introduction to be found in Titchmarsh’s book [469].

VII
Applications of Singularity Analysis
Mathematics is being lazy. Mathematics is letting the principles do the work for you
so that you do not have to do the work for yourself.
— GEORGE P ´OLYA1
I wish to God these calculations had been executed by steam.
— CHARLES BABBAGE (1792-1871)
— The Bhagavad Gita XV.12
Contents
VII. 1.
A roadmap to singularity analysis asymptotics
423
VII. 2.
Sets and the exp–log schema
427
VII. 3.
Simple varieties of trees and inverse functions
434
VII. 4.
Tree-like structures and implicit functions
445
VII. 5.
Nonplane unlabelled trees and P´olya operators
453
VII. 6.
Irreducible context-free structures
460
VII. 7.
The general analysis of algebraic functions
469
VII. 8.
Combinatorial applications of algebraic functions
482
VII. 9.
Ordinary differential equations and systems
492
VII. 10.
Perspective
503
Singularity analysis paves the way to the analysis of a large quantity of generating
functions, as provided by the symbolic method exposed in Chapters I–III. In accor-
dance with P´olya’s aphorism, it makes it possible to “be lazy” and “let the principles
work for you”. In this chapter we illustrate this situation with numerous examples re-
lated to languages, permutations, trees, and graphs of various sorts. Like in Chapter V,
most analyses are organized into broad classes called schemas.
First, we develop the general exp–log schema, which covers the set construction,
either labelled or unlabelled, applied to generators whose dominant singularity is of
logarithmic type (Section VII.2). This typically nonrecursive schema parallels in gen-
erality the supercritical schema of Chapter V, which is relative to sequences. It permits
us to quantify various constructions of permutations, derangements, 2–regular graphs,
1Quoted in M Walter, T O’Brien, Memories of George P´olya, Mathematics Teaching 116 (1986)
2“There is an imperishable tree, it is said, that has its roots upward and its branches down and whose
leaves are the Hymns. He who knows it possesses knowledge.”
421

422
VII. APPLICATIONS OF SINGULARITY ANALYSIS
mappings, and functional graphs, and even gives access to factorization properties of
polynomials over ﬁnite ﬁelds.
Next, we deal with recursively deﬁned structures, whose study constitutes the
main theme of this chapter. In that case, generating functions are accessible by means
of equations or systems that implicitly deﬁne them. A distinctive feature of many such
combinatorial types is that their generating functions have a square-root singularity,
that is, the singular exponent equals 1
2. As a consequence, the counting sequences
characteristically involve asymptotic terms of the form Ann−3/2, where the latter
asymptotic exponent, −3
2, precisely reﬂects the singular exponent 1
2 in the function’s
singular expansion, in accordance with the principles of singularity analysis presented
in Chapter VI.
Trees are the prototypical recursively deﬁned combinatorial type. Square-root
singularities automatically arise for all varieties of trees constrained by a ﬁnite set of
allowed node degrees—binary trees, unary-binary trees, ternary trees, for instance—
and many more. The counting estimates involve the characteristic n−3
2 subexponen-
tial factor, a property that holds in the labelled and unlabelled frameworks alike (Sec-
tion VII.3).
Simple varieties of trees have many properties in common, beyond the subexpo-
nential growth factor of tree counts. Indeed, in a random tree of some large size n,
almost all nodes are found to be at level about √n, path length grows on average
like n√n, and height is of √n order with high probability. These results serve to
unify classical tree types—we say that such properties of random trees are univer-
sal3 amongst all simply generated families sharing the square-root singularity prop-
erty. (This notion of universality, borrowed from physics, is also nowadays ﬁnding
increasing popularity amongst probabilists, for reasons much similar to ours.) In this
perspective, the motivation for organizing the theory along the lines of major schemas
ﬁts perfectly with the quest of universal laws in analytic combinatorics.
In the context of simple varieties of trees, the square-root feature arises from
general properties of the inverse of an analytic function. Under suitable conditions,
this property can be extended to functions deﬁned implicitly by a functional equation.
Consequences are the general enumeration of nonplane unlabelled trees, including iso-
mers of alkanes in theoretical chemistry, as well as secondary structures of molecular
biology (Section VII.4).
Much of this chapter is devoted to context-free speciﬁcations and languages. In
that case, generating functions are a priori algebraic functions, meaning that they sat-
isfy a system of polynomial equations, itself optionally reducible (by elimination) to
a single equation. For solutions of positive polynomial systems, square-root singu-
larities are found to be the rule under a simple technical condition of irreducibility
(Section VII. 6) that is evocative of the Perron-Frobenius conditions encountered in
3“[. . . ] this echoes the notion of universality in statistical physics. Phenomena that appear at ﬁrst to be
unconnected, such as magnetism and the phase changes of liquids and gases, share some identical features.
This universal behaviour pays no heed to whether, say, the ﬂuid is argon or carbon dioxide. All that matters
are broad-brush characteristics such as whether the system is one-, two- or three-dimensional and whether
its component elements interact via long- or short-range forces. Universality says that sometimes the details
do not matter.” [From “Utopia Theory”, in Physics World, August 2003].

VII. 1. A ROADMAP TO SINGULARITY ANALYSIS ASYMPTOTICS
423
Chapter V in relation to ﬁnite-state and transfer-matrix models. As an illustration,
we show how to develop a coherent theory of topological conﬁgurations in the plane
(trees, forests, graphs) that satisfy a non-crossing constraint.
For arbitrary algebraic functions (the ones that are not necessarily associated to
positive coefﬁcients and equations, or irreducible positve systems), a richer set of sin-
gular behaviours becomes possible: singular expansions involve fractional exponents
(not just 1
2, corresponding to the square-root paradigm above). Singularity analy-
sis is invariably applicable (Section VII. 7). Algebraic functions are viewed as plane
algebraic curves and one can make use of the famous Newton-Puiseux theorem of
elementary algebraic geometry, which completely describes the types of singularities
thay may occur. Algebraic functions surface as solutions of various types of functional
equations: this turns out to be the case for many classes of walks that generalize Dyck
and Motzkin paths, via what is known as the kernel method, as well as for many types
of planar maps (embedded planar graphs), via the so-called quadratic method. In all
these cases, singular exponents of a predictable (rational) form are bound to occur,
implying in turn numerous quantitative properties of random discrete structures.
Differential equations and systems are associated to recursively deﬁned structure,
when either pointing constructions or order constraints appear. For counting gen-
erating functions, the equations are nonlinear, while the GFs associated to additive
parameters lead to linear versions. Differential equations are also central in connec-
tion with the holonomic framework4, which gives access to the enumeration of many
classes of “hard” objects, like regular graphs and Latin rectangles. Singularity analysis
is once more instrumental in working out precise asymptotic estimates. We examine
here (Section VII. 9) applications relative to quadtrees and to varieties of increasing
trees, some of which are closely related to permutations as well as to algorithms and
data structures for sorting and searching.
VII. 1. A roadmap to singularity analysis asymptotics
The singularity analysis theorems of Chapter VI, which may be coarsely summa-
rized by the correspondence
(1)
f(z) ∼(1 −z/ρ)−α
•——◮
fn ∼
1
Γ(α)ρ−nnα−1,
serve as our main asymptotic engine throughout this chapter. Singularity analysis
is instrumental in quantifying properties of nonrecursive as well as recursive struc-
tures. Our reader might be surprised not to encounter integration contours anymore
in this chapter: it now sufﬁces to work out the local analysis of functions at their
singularities, then the general theorems of singularity analysis (Chapter VI) effect the
translation to counting sequences and parameters automatically.
4Holonomic functions (APPENDIX B: Holonomic functions, p. 693) are deﬁned as solutions of linear
differential equations with coefﬁcients that are rational functions.

424
VII. APPLICATIONS OF SINGULARITY ANALYSIS
The exp–log schema. This schema is relative to the labelled set construction,
(2)
F = SET(G)
=⇒
F(z) = exp (G(z)) ,
as well as its unlabelled counterparts, MSET and PSET: an F-structure is thus con-
structed (nonrecursively) as an unordered assembly of G-components. In the case
where the GF of components is logarithmic at its dominant singularity,
(3)
G(z) ∼κ log
1
1 −z/ρ + λ,
an immediate computation shows that F(z) has a singularity of the power type,
F(z) ∼eλ (1 −z/ρ)−κ ,
which is clearly in the range of singularity analysis. The construction (2), supple-
mented by simple technical conditions of the form (3), deﬁnes the exp–log schema.
Then, for such F-structures that are deﬁnable as assemblies of logarithmic compo-
nents, the asymptotic counting problem is systematically solvable (Theorem VII.1,
p. 428); the number of G-components in a large random F-structure is O(log n), both
in the mean and in probability, while more reﬁned estimates describe precisely the
likely shape of proﬁles. This schema has a generality comparable to the supercriti-
cal schema examined in Section V. 4, p. 313, but the probabilistic phenomena at stake
appear to be in sharp contrast: the number of components is typically small, being log-
arithmic in n for exp-log sets, as opposed to a linear growth in the case of supercritical
sequences. The schema can be used to analyse properties of permutations, functional
graphs, mappings, and polynomial over ﬁnite ﬁelds.
Recursion and the universality of square-root singularity. A major theme of this
chapter is the study of asymptotic properties of recursive structures. In an amazingly
large number of cases, functions with a square root singularity are encountered, and
given the usual correspondence,
f(z) ∼−(1 −z)1/2
•——◮
fn ∼
1
2
√
πn3 ;
the corresponding coefﬁcients are of the asymptotic form Cρ−nn−3/2. Several schemas
can be described to capture this phenomenon; we develop here, in order of increas-
ing structural complexity, the ones corresponding to simple varieties of trees, implicit
structures, P´olya operators, and irreducible polynomial systems.
Simple varieties of trees and inverse functions. Our treatment of recursive combi-
natorial types starts with simple varieties of trees. In the basic situation, that of plane
unlabelled trees, the equation is
(4)
Y = Z × SEQΩ(Y)
=⇒
Y (z) = zφ(Y (z)),
with, as usual, φ(w) = P
ω∈Ωwω. Thus, the OGF Y (z) is determined as the inverse
of w/φ(w), where the function φ reﬂects the collection of all allowed node degrees
(Ω). From analytic function theory, we know that singularities of the inverse of an
analytic function are generically of the square-root type (Chapters IV and VI), and

VII. 1. A ROADMAP TO SINGULARITY ANALYSIS ASYMPTOTICS
425
such is the case whenever Ωis a “well behaved” set of integers, in particular, a ﬁnite
set. Then, the number of trees satisﬁes the estimate
(5)
Yn = [zn]Y (z) ∼CAnn−3/2.
Square-root singularity is also attached to several universality phenomena, as evoked
in the general introduction to this chapter.
Tree-like structures and implicit functions. Functions deﬁned implicitly by an
equation of the form
(6)
Y (z) = G(z, Y (z))
where G is bivariate analytic, has nonnegative coefﬁcients, and satisﬁes a natural
set of conditions (Theorem VII.3, p. 447) also lead to square-root singularity. The
schema (6) generalizes (4): simply take G(z, y) = zφ(y).
Trees under symmetries and P´olya operators. The analytic methods evoked above
can be further extended to P´olya operators, which translate unlabelled set and cycle
set constructions. A typical application is to the class nonplane unlabelled trees whose
OGF satisﬁes the inﬁnite functional equation,
H(z) = z exp
H(z)
1
+ H(z2)
2
+ · · ·

.
Singularity analysis applies more generally to varieties of nonplane unlabelled trees
(Theorem VII.4, p. 457), which covers the enumeration of various types of interesting
molecules in combinatorial chemistry.
Context-free structures and polynomial systems. The GF of any context-free class
or language is known to be a component of a system of positive polynomial equations





y1
=
P1(z, y1, . . . , yr)
...
...
...
yr
=
Pr(z, y1, . . . , yr).
The n−3/2 counting law is again universal amongst such combinatorial classes un-
der a basic condition of “irreducibility” (Theorem VII.5, p. 461). In that case, the
GFs are algebraic functions satisfying a strong positivity constraint, and the corre-
sponding analytic statement constitutes the important Drmota-Lalley-Woods Theorem
(Theorem VII.6, p. 466).
Note that there is a progression in the complexity of the schemas leading to
square-root singularity. From the analytic standpoint, this can be roughly rendered
by a chain
inverse functions −→implicit functions −→systems.
It is however often meaningful to treat each combinatorial problem at its minimal
level of generality, since results tend to become less and less explicit as complexity
increases.

426
VII. APPLICATIONS OF SINGULARITY ANALYSIS
rational
Irred. linear system
ζ−n
Perron-Frob., merom. fns,
Ch. V
—
General rational
ζ−nnℓ
meromorphic functions,
Ch. V
algebraic
Irred. positive sys.
ζ−nn−3/2
DLW Th., sing. analysis,
This chapter, §VII. 6, p. 460
—
General algebraic
ζ−nnr/s
Puiseux, sing. analysis,
This chapter, §VII. 7, p. 469
holonomic
Regular sing.
ζ−nnθ logℓn
ODE, sing. analysis,
This chapter, §VII. 9.1, p. 493
—
Irregular sing.
ζ−neP (n1/r)nθ logℓn
ODE, saddle-point,
Ch. VIII
FIGURE VII.1. A telegraphic summary of a hierarchy of special functions by increas-
ing level of generality: asymptotic elements composing coefﬁcients and the coefﬁcient
extraction method (with ℓ, r ∈Z≥0, p
q ∈Q, θ algebraic, and P a polynomial).
General algebraic functions. In essence, the coefﬁcients of all algebraic func-
tions can be analysed asymptotically. (There are only minor limitations arising from
the possible presence of several dominant singularities, like in the rational function
case.) The starting point is the characterization of the local behaviour of an algebraic
function at any of its singularities, which is provided by the Newton-Puiseux theorem:
if ζ is a singularity, then the branch Y (z) of an algebraic function admits near ζ a
representation of the form
(7)
Y (z) = Zp/q

X
k≥0
ckZk/q

,
Z := (1 −z/ζ),
for some r/s ∈Q, so that the singular exponent is invariably a rational number.
Singularity analysis is also systematically applicable, so that the nth coefﬁcient of Y
is expressible as a ﬁnite linear combination of terms, each of the asymptotic form
(8)
ζ−nnr/s,
r
s ∈Q;
see also Figure 1. The various quantities (like ζ, r, s) entering the asymptotic expan-
sion of the coefﬁcients of an algebraic function turn out to be effectively computable.
Beside providing a wide-encompassing conceptual framework of independent in-
terest, the general theory of algebraic coefﬁcient asymptotics is applicable whenever
the combinatorial problems considered is not amenable to any of the special schemas
previously described. For instance, certain kinds of “supertrees” (these are deﬁned
as trees composed with trees, Example 10, p. 394) lead to the singular type Z1/4,
which is reﬂected by an unusual subexponential factor of n−5/4 present in asymptotic
counts. Maps, which are planar graphs drawn in the plane (or on the sphere), satisfy a
universality law with a singular exponent equal to 3
2, which is associated to counting
sequences involving an asymptotic n−5/2 factor.

VII. 2. SETS AND THE EXP–LOG SCHEMA
427
Differential equations and systems. When recursion is combined with point-
ing or with order constraints, enumeration problems translate into integro-differential
equations. Section VII. 9 examines the types of singularities that may occur in two
important cases: (i) linear differential equations; (ii) nonlinear differential equations.
Linear differential equations arise from the analysis of parameters of splitting pro-
cesses that extend the framework of tree recurrences (Chapter VI), and we treat the
geometric quadtree structure in this perspective. Another especially important source
of linear differential equations is the class of holonomic functions (solutions of linear
equations with rational coefﬁcients, cf APPENDIX B: Holonomic functions, p. 693),
which includes GFs of Latin rectangles, regular graphs, permutations restricted by the
length of their longest increasing subsequence, Young tableaux and many more struc-
tures of combinatorial theory. In an important case, that of a “regular” singularity,
asymptotic forms can be systematically extracted. The singularities that may occur ex-
tend the algebraic ones (7), and the corresponding coefﬁcients are then asymptotically
composed of elements of the form
(9)
ζ−nnθ(log n)ℓ,
(θ an algebraic quantity, ℓ∈Z≥0), which is more general than (8).
Nonlinear differential equations are typically attached to the enumeration of trees
satisfying various kinds of order constraints. A general treatment is intrinsically not
possible, given the extreme diversity of singular types that may occur. Accordingly,
we restrict attention to ﬁrst-order nonlinear equations of the form
d
dz Y (z) = φ(Y (z)),
which covers varieties of increasing trees, including several models closely related to
permutations.
Figure 1 summarizes three classes of special functions encountered in this book,
namely, rational, algebraic, and holonomic. When structural complexity increases, a
richer set of asymptotic coefﬁcient behaviours becomes possible. (The complex as-
ymptotic methods employed extend much beyond the range suggested by the ﬁgure.
For instance, the class of irreducible positive systems of polynomial equations are part
of the general square-root singularity paradigm, also encountered with P´olya opera-
tors, as well as inverse and implicit functions in non-algebraic cases.)
VII. 2. Sets and the exp–log schema
In this section, we examine a schema that is structurally comparable to the super-
critical sequence schema of Section V. 4, p. 313, but that requires singularity analysis
for coefﬁcient extraction. The starting point is the construction of permutations (P) as
labelled sets of cyclic permutations (K):
(10) P = SET(K)
=⇒
P(z) = exp (K(z)) , where K(z) = log
1
1 −z ,
which gives rise to many easy explicit calculations. For instance the probability that
a random permutation consists of a unique cycle is 1
n (since it equals Kn/Pn); the
number of cycles is asymptotic to log n, both on average (p. 112) and in probability

428
VII. APPLICATIONS OF SINGULARITY ANALYSIS
(Example III.4, p. 148); the probability that a random permutation has no singleton
cycle is ∼e−1 (the derangement problem; see pp. 113 and 216).
Similar properties hold true under surprisingly general conditions. We start with
deﬁnitions that describe the combinatorial classes of interest.
Deﬁnition VII.1. A function G(z) analytic at 0, having nonnegative coefﬁcients and
ﬁnite radius of convergence ρ is said to be of (κ, λ)-logarithmic type, where κ ̸= 0, if
the following conditions hold:
(i) the number ρ is the unique singularity of G(z) on |z| = ρ;
(ii) G(z) is continuable to a ∆–domain at ρ;
(iii) G(z) satisﬁes,
G(z) = κ log
1
1 −z/ρ + λ + O

1
(log(1 −z/ρ))2

,
as z →ρ in ∆.
Deﬁnition VII.2. The labelled construction F = SET(G) is said to be a labelled
exp-log schema if the exponential generating function G(z) of G is of logarithmic
type.
The unlabelled construction F = MSET(G) is said to be an unlabelled exp-log
schema if the ordinary generating function G(z) of G is of logarithmic type.
By the fact that G(z) has positive coefﬁcients, we must have κ > 0, while the sign
of λ is arbitrary. The deﬁnitions and the main properties to be derived for unlabelled
multisets easily extend to the powerset construction: see Notes 1 and 5 below.
Theorem VII.1 (Exp–log schema). Consider an exp-log schema with parameters
(κ, λ).
(i) The counting sequences satisfy





[zn]G(z)
=
κ
nρ−n  1 + O
 (log n)−2
,
[zn]F(z)
=
eλ+r0
Γ(κ) nκ−1ρ−n  1 + O
 (log n)−2
,
where r0 = 0 in the labelled case and r0 = P
j≥2 G(ρj)/j in the case of unlabelled
multisets.
(ii) The number X of G–components in a random F–object satisﬁes
EFn(X)
=
κ(log n −ψ(κ)) + λ + r1 + O
 (log n)−1
(ψ(s) ≡
d
dsΓ(s)),
where r1 = 0 in the labelled case and r1 = P
j≥2 G(ρj) in the case of unlabelled
multisets. The variance satisﬁes VFn(X) = O(log n), and, in particular, the distri-
bution of X is concentrated around its mean.
We shall see in Chapter IX that, in addition, the asymptotic distribution of X is invariably
Gaussian under such exp-log conditions.
PROOF. This result is from an article by Flajolet and Soria [210], with a correction
to the logarithmic type condition given by Jennie Hansen [257]. We ﬁrst discuss the
labelled case, F = SET(G), so that F(z) = exp G(z).

VII. 2. SETS AND THE EXP–LOG SCHEMA
429
(i) The estimate for [zn]G(z) follows directly from singularity analysis with log-
arithmic terms (Theorem VI.4, p. 376). Regarding F(z), we ﬁnd, by exponentiation,
(11)
F(z) =
eλ
(1 −z/ρ)κ

1 + O

1
(log(1 −z/ρ))2

.
Like G, the function F = eG has an isolated singularity at ρ, and is continuable to
a ∆-domain, in which the expansion (11) is valid. The basic transfer theorem then
provides the estimate of [zn]F(z).
(ii) Regarding the number of components, the BGF of F with u marking the
number of G–components is F(z, u) = exp(uG(z)), in accordance with the general
developments of Chapter III. The function
f1(z) := ∂
∂uF(z, u)

u=1
= F(z)G(z),
is the EGF of the cumulated values of X. It satisﬁes near ρ
f1(z) =
eλ
(1 −z/ρ)κ

κ log
1
1 −z/ρ + λ
 
1 + O

1
(log(1 −z/ρ))2

,
whose translation, by singularity analysis theory is immediate:
[zn]f1(z) ≡EFn(X) =
eλ
Γ(κ)ρ−n  κ log n −κψ(κ) + λ + O
 (log n)−1
.
This provides the mean value estimate of X as [zn]f1(z)/[zn]F(z). The variance
analysis is conducted in the same way, using a second derivative.
For the unlabelled case, the analysis of [zn]G(z) can be recycled verbatim. First,
given the assumptions, we must have ρ < 1 (since otherwise [zn]G(z) could not be
an integer). The classical translation of multisets (Chapter I) rewrites as
F(z) = exp (G(z) + R(z)) ,
R(z) :=
∞
X
j=2
G(zj)
j
,
where R(z) involves terms of the form G(z2), . . ., each being analytic in |z| < ρ1/2.
Thus, R(z) is itself analytic, as a uniformly convergent sum of analytic functions, in
|z| < ρ1/2. (This follows the usual strategy for treating P´olya operators in asymptotic
theory.) Consequently, F(z) is ∆-analytic. As z →ρ, we then ﬁnd
(12)
F(z) =
eλ+r0
(1 −z/ρ)κ

1 + O

1
(log(1 −z/ρ))2

,
r0 ≡
∞
X
j=2
G(ρj)
j
.
The asymptotic expansion of [zn]F(z) then results from singularity analysis.
The BGF F(z, u) of F, with u marking the number of G–components, is
F(z, u) = exp
uG(z)
1
+ u2G(z2)
2
+ · · ·

.
Consequently,
f1(z) := ∂
∂uF(z, u)

u=1
= F(z) (G(z) + R1(z)) ,
R1(z) =
∞
X
j=2
G(zj).

430
VII. APPLICATIONS OF SINGULARITY ANALYSIS
F
κ
n = 100
n = 272
n = 739
Permutations
1
5.18737
6.18485
7.18319
Derangements
1
4.19732
5.18852
6.18454
2–regular
1
2
2.53439
3.03466
3.53440
Mappings
1
2
2.97898
3.46320
3.95312
FIGURE VII.2. Some exp–log structures (F) and the mean number of G–components
for n = 100, 272 ≡⌈100 · e⌋, 739 ≡⌈100 · e2⌋.
Again, the singularity type is that of F(z) multiplied by a logarithmic term,
(13)
f1(z) ∼
z→ρ F(z)(G(z) + r1),
r1 ≡
∞
X
j=2
G(ρj).
The mean value estimate results. Variance analysis follows similarly.
□
 VII.1. Unlabelled powersets. For the powerset construction F = PSET(G), the statement
of Theorem VII.1 holds with
r0 =
X
j≥2
(−1)j−1 G(ρj)
j
,
as seen by an easy adaptation of the proof techniques.

As we see below, beyond permutations, mappings, unlabelled functional graphs,
polynomials over ﬁnite ﬁelds, 2–regular graphs, and generalized derangements resort
to the exp-log schema; see Figure 2 for representative numerical data. Furthermore,
singularity analysis gives precise information on the decomposition of large F objects
into G components.
EXAMPLE VII.1.
Cycles in derangements. The case of permutations corresponds to radius
of convergence ρ = 1 and parameters F(κ, λ) = (1, 0), and is immediately seen to satisfy the
conditions of Theorem VII.1. Let Ωbe a ﬁnite set of the integers and consider next the class
D ≡DΩof permutations without any cycle of length in Ω. This includes standard derange-
ments (where Ω= {1}). The speciﬁcation is then

D
=
SET(K)
K
=
CYCZ>0\Ω(Z)
=⇒
8
<
:
D(z)
=
exp(K(z))
G(z)
=
log
1
1 −z −
X
ω∈Ω
zω
ω .
The theorem applies, with κ = 1, λ := −P
ω∈Ωω−1. In particular, the mean number of cycles
in a random generalized derangement of size n is log n + O(1). END OF EXAMPLE VII.1. □
EXAMPLE VII.2.
Connected components in 2-regular graphs. The class of (undirected) 2–
regular graphs is obtained by the set construction applied to components that are themselves
undirected cycles of length ≥3 (see p. 123 and Example VI.2, p. 378). In that case:
F
=
SET(G)
G
=
UCYC≥3(Z)
=⇒
8
<
:
F(z)
=
exp(G(z))
G(z)
=
1
2 log
1
1 −z −z
2 −z2
4 .
This is an exp–log scheme with κ = 1
2 and λ = −3
4. In particular the number of components
is asymptotic to 1
2 log n, both in the mean and in probability. . . END OF EXAMPLE VII.2. □

VII. 2. SETS AND THE EXP–LOG SCHEMA
431
EXAMPLE VII.3.
Connected components in mappings. The class F of mappings (functions
from a ﬁnite set to itself) has been introduced in Subsection II. 5.2, p. 119. The associated
digraphs are described as labelled sets of connected components (K), themselves (directed)
cycles of trees (T ), so that the class of all mappings has an EGF given by
F(z) = exp(K(z)),
K(z) = log
1
1 −T(z),
T(z) = zeT (z),
with T the Cayley tree function. The analysis of inverse functions (Section VI. 7 and Exam-
ple VI.8, p. 386) has shown that T(z) is singular at z = e−1, where it admits the singular
expansion T(z) ∼1 −
√
2√1 −ez. Thus G(z) is logarithmic with κ = 1
2 and λ = −log
√
2.
As a consequence, the number of connected mappings satisﬁes
Kn ≡n![zn]K(z) = nn
r
π
2n
“
1 + O(n−1/2)
”
.
In other words: the probability for a random mapping of size n to consist of a single component
is ∼p π
2n. Also, the mean number of components in a random mapping of size n is
1
2 log n + log
√
2eγ + O(n−1/2).
Similar properties hold for mappings without ﬁxed points that are analogous to derangements
and were discussed in Chapter II, p. 121. We shall establish below, p. 458, that unlabelled
functional graphs also adhere to the exp-log schema. . . . . . . . . . . END OF EXAMPLE VII.3. □
EXAMPLE VII.4.
Factors of polynomials over ﬁnite ﬁelds. Factorization properties of ran-
dom polynomials over ﬁnite ﬁelds are of importance in various areas of mathematics and have
applications to coding theory, symbolic computation, and cryptography [41, 487, 437]. (Exam-
ple I.18, p. 83, offers a preliminary discussion).
Let Fp be the ﬁnite ﬁeld with p elements and P = Fp[X] the set of monic polynomials with
coefﬁcients in the ﬁeld. We view these polynomials as (unlabelled) combinatorial objects with
size identiﬁed to degree. Since a polynomial is speciﬁed by the sequence of its coefﬁcients, one
has (with A the “alphabet” of coefﬁcients, A = Fp treated as a collection of atomic objects),
(14)
P = SEQ(A)
=⇒
P(z) =
1
1 −pz ,
and there are pn monic polynomials of degree n.
Polynomials are a unique factorization domain, since they can be subjected to Euclidean
division. A nonconstant polynomial that has no proper nonconstant divisor is termed irreducible
—irreducibles are the analogues of the primes in the integer realm. The unique factorization
property implies that the collection of all polynomials is combinatorially isomorphic to the
multiset class of the collection of irreducibles:
(15)
P ∼= MSET(I)
=⇒
P(z) = exp
„
I(z) + 1
2I(z2) + 1
3I(z3) + · · ·
«
.
The conjunction of (14) and (15) yields a functional relation determining I(z) implicitly, which
can be solved by taking logarithms and then making use of M¨obius inversion: we ﬁnd
I(z) =
X
k≥1
µ(k)
k
log
1
1 −pzk = log
1
1 −pz + R(z),
where R(z) is analytic in |z| < p−1/2. Thus I(z) is of logarithmic type with parameters
κ = 1,
λ =
X
k≥2
µ(k)
k
log
1
1 −p1−k .

432
VII. APPLICATIONS OF SINGULARITY ANALYSIS
(X + 1)
“
X10 + X9 + X8 + X6 + X4 + X3 + 1
” “
X14 + X11 + X10 + X3 + 1
”
X3 (X + 1)
“
X2 + X + 1
”2 “
X17 + X16 + X15 + X11 + X9 + X6 + X2 + X + 1
”
X5(X + 1)
“
X5 + X3 + X2 + X + 1
” “
X12 + X8 + X7 + X6 + X5 + X3 + X2 + X + 1
” “
X2 + X + 1
”
X2 “
X2 + X + 1
”2 “
X3 + X2 + 1
” “
X8 + X7 + X6 + X4 + X2 + X + 1
” “
X8 + X7 + X5 + X4 + 1
”
“
X7 + X6 + X5 + X3 + X2 + X + 1
” “
X18 + X17 + X13 + X9 + X8 + X7 + X6 + X4 + 1
”
FIGURE VII.3. The factorizations of ﬁve random polynomials of degree 25 over F2.
One out of ﬁve polynomials in this sample has no root in the base ﬁeld (the asymptotic
probability is 1
4 by Note 4).
There results that In ∼pn/n, which constitutes a “Prime Number Theorem” for polynomials
over ﬁnite ﬁelds: A fraction asymptotic to 1
n of the polynomials in Fp[X] are irreducible. This
says that a polynomial of degree n is roughly comparable to a number written in base p having n
digits: in effect, the proportion of prime numbers amongst numbers whose representation has
length n is asymptotic to 1/(n log p), by virtue of the classical Prime Number Theorem.
Since I(z) is logarithmic and P is obtained by a multiset construction, we have an exp-log
scheme and Theorem VII.1 applies. As a consequence: The number of factors of a random poly-
nomial of degree n is ∼log n on average and its distribution is concentrated. (See Figure 3.)
This and similar developments lead to a complete analysis of some of the basic algorithms
known for factoring polynomials over ﬁnite ﬁelds; see [186]. . . END OF EXAMPLE VII.4. □
 VII.2. The divisor function for polynomials. Let δ(̟) for ̟ ∈P be the total number of
monic polynomials (not necessarily irreducible) dividing ̟: if ̟ = ιe1
1 · · · ιek
k , where the ιj
are distinct irreducibles, then δ(̟) = (e1 + 1) · · · (ek + 1). One has
EPn(δ) =
[zn] Q
j≥1(1 + 2zj + 3z2j + · · · )
[zn] Q
j≥1(1 + zj + z2j + · · · )
= [zn]P(z)2
[zn]P(z) ,
so that the mean value of δ over Pn is exactly (n + 1). This evaluation is relevant to poly-
nomial factorization over Z since it gives an upper bound on the number of ireducible factor
combinations that need to be considered in order to lift a factorization from Fp(X) to Z(X);
see [308, 487].

 VII.3. The cost of ﬁnding irreducible polynomials. Assume that it takes expected time t(n)
to test a random polynomial of degree n for irreducibility. Then it takes expected time ∼nt(n)
to ﬁnd a random polynomial of degree n: simply draw a polynomial at random and test it for
irreducibility. Testing for ireducibility can be achieved by developing a polynomial factorization
algorithm which is stopped as soon as a nontrivial factor is found. See works by Panario et al.
for detailed analyses [383, 384].

Proﬁles of exp-log structures. Under the exp–log conditions, it is also possible
to analyse the proﬁle of structures, that is, the number of components of size r for
each ﬁxed r. We recall here that the Poisson distribution of parameter ν is the law of
a discrete random variable Y such that
E(uY ) = e−ν(1−u),
P(Y = k) = e−ν νk
k! .

VII. 2. SETS AND THE EXP–LOG SCHEMA
433
A variable Y is said to be a negative binomial of parameter (m, α) if its probability
generating function and its individual probabilities satisfy:
E(uY ) =
 1 −α
1 −αu
m
,
P(Y = k) =
m + k −1
k

αk(1 −α)m.
(The quantity P(Y = k) is the probability that the mth success in a sequence of
independent trials with individual success probability α occurs at time m+k; see [162,
p. 165].)
Proposition VII.1 (Proﬁles of exp–log structures). Assume the conditions of Theo-
rem VII.1 and let X(r) be the number of G-components of size r in an F-object. In the
labelled case, X(r) admits a limit distribution of the Poisson type: for any ﬁxed k,
(16)
lim
n→∞PFn(X(r) = k) = e−ν νk
k! ,
ν = grρr,
gr ≡[zr]G(z).
In the unlabelled case, X(r) admits a limit distribution of the negative binomial type:
for any ﬁxed k,
(17)
lim
n→∞PFn(X(r) = k) =
Gr + k −1
k

αk(1 −α)Gr,
α = ρr, Gr ≡[zr]G(z).
PROOF. In the labelled case, the BGF of F with u marking the number X(r) of r–
components is
F(z, u) = exp ((u −1)grzr) F(z).
Extracting the coefﬁcient of uk leads to
φk(z) := [uk]F(z, u) = exp (−grzr) (grzr)k
k!
F(z).
The singularity type of φk(z) is that of F(z) since the prefactor (an exponential mul-
tiplied by a polynomial) is entire, so that singularity analysis applies directly. As a
consequence, one ﬁnds
[zn]φk(z) ∼exp (−grρr) (grρr)k
k!
· ([zn]F(z)) ,
which provides the distribution of X(r) under the form stated in (16).
In the unlabelled case, the starting BGF equation is
F(z, u) =
 1 −zr
1 −uzr
Gr
F(z),
and the analytic reasoning is similar to the labelled case.
□
The unlabelled version of Proposition VII.1 covers in particular polynomials over
ﬁnite ﬁelds; see [186, 298] for related results.
 VII.4. Mean proﬁles. The mean value of X(r) satisﬁes
EFn(X(r)) ∼grρr,
EFn(X(r)) ∼Gr
ρr
1 −ρr ,
in the labelled and unlabelled (multiset) case respectively. In particular: the mean number of
roots of a random polynomial over Fp that lie in the base ﬁeld Fp is asymptotic to
p
p−1. Also:

434
VII. APPLICATIONS OF SINGULARITY ANALYSIS
Plane
Non-plane
Unlabelled (OGF)
V = Z × SΩ(V)
V (z) = zφ(V (z))
φ(u) := P
ω∈Ωuω
V = Z × MΩ(V)
V (z) = zΦ(V (z)))
(Φ a P´olya operator)
Labelled (EGF)
V = Z ⋆SΩ(V)
bV (z) = zφ(bV (z))
φ(u) := P
ω∈Ωuω
V = Z ⋆PΩ(V)
bV (z) = zφ(bV (z))
φ(u) := P
ω∈Ω
uω
ω!
FIGURE VII.4. Functional equations satisﬁed by generating functions of degree-
restricted families of trees.
the probability that a polynomial has no root in the base ﬁeld is asymptotic to (1 −1/p)p. (For
random polynomials with real coefﬁcients, a famous result of Kac (1943) asserts that the mean
number of real roots is ∼2
π log n; see [146].)

 VII.5. Proﬁles of powersets. In case of unlabelled powersets F = PSET(G) (no repetitions
of elements allowed), the distribution of X(r) satisﬁes
lim
n→∞PFn(X(r) = k) =
 
Gr
k
!
αk(1 −α)Gr−k,
α =
ρr
1 + ρr ,
i.e., the limit is a binomial law of parameters (Gr, ρr/(1 + ρr)).

VII. 3. Simple varieties of trees and inverse functions
A unifying theme in this chapter is the enumeration of rooted trees determined
by restrictions on the collection of allowed node degrees—some set Ω⊆Z≥0 con-
taining 0 (for leaves) and at least another number d ≥2 (to avoid trivialities) being
ﬁxed, all nodes outdegrees are constrained to lie in Ω. Corresponding to the four com-
binations, unlabelled/labelled and plane/nonplane, there are four types of functional
equations summarized by Figure 4. In three of the four cases, namely,
unlabelled plane, labelled plane, and labelled nonplane,
the generating function (OGF for unlabelled, EGF for labelled) satisﬁes an equation
of the form
(18)
y(z) = zφ(y(z)).
In accordance with earlier conventions (p. 182), we name simple variety of trees any
family of trees whose GF satisﬁes an equation of the form (18). (The functional equa-
tion satisﬁed by the OGF of a degree-restricted variety of nonplane unlabelled trees
furthermore involves a P´olya operator Φ, which implies the presence of terms of the
form y(z2), y(z3), . . .: such cases are discussed in Section VII. 5 below.)
The relation y = zφ(y) has already been examined in Section VI. 7, p. 385,
from the point of view of singularity analysis. For convenience, we encapsulate the
conditions of the main theorem of that section, Theorem VI.6, p. 387, into a deﬁnition.

VII. 3. SIMPLE VARIETIES OF TREES AND INVERSE FUNCTIONS
435
Deﬁnition VII.3. Let y(z) be a function analytic at 0. It is said to belong to the
smooth inverse-function schema if there exists a function φ(u) analytic at 0, such that
in a neighbourhood of 0 one has
y(z) = zφ(y(z)),
and φ(u) satisﬁes the following conditions.
— Condition (H1): The function φ(u) is such that
(19)
φ(0) ̸= 0,
[un]φ(u) ≥0,
φ(u) ̸≡φ0 + φ1u.
— Condition (H2): Within the open disc of convergence of φ at 0, |z| < R, there
exists a (necessarily unique) positive solution to the characteristic equation:
(20)
∃τ, 0 < τ < R,
φ(τ) −τφ′(τ) = 0.
A class Y whose generating function y(z) (either ordinary or exponential) satis-
ﬁes these conditions is also said to belong to the smooth inverse-function schema.
The schema is said to be aperiodic if φ(u) is an aperiodic function of u.
VII. 3.1. Asymptotic counting. As we saw on general grounds in Chapters IV
and VI, inversion fails to be analytic when the ﬁrst derivative of the function to be
inverted vanishes (hence the characteristic equation). The heart of the matter is that,
at the point of failure y = τ, corresponding to z = τ/φ(τ) (the radius of convergence
of y(z) at 0), the dependency y 7→z becomes quadratic, so that its inverse z 7→y
gives rise to a square-root singularity, from which the typical n−3/2 term in coefﬁcient
asymptotics results (Theorem VI.6, p. 387). In view of our needs in this chapter, we
rephrase Theorem VI.6 as follows.
Theorem VII.2. Let y(z) belong to the smooth inverse-function schema, in the sense
of Deﬁnition VII.3, and be aperiodic. Then, with τ the positive root of the characterstic
equation and ρ = τ/φ(τ), one has
[zn]y(z) ∼
s
φ(τ)
2φ′′(τ)
ρ−n
√
πn3

1 + O
 1
n

.
As we also know from Theorem VI.6, a full (locally convergent) expansion of
y(z) in powers of
p
1 −z/ρ exists, starting with
(21)
y(z) = τ −γ
p
1 −z/ρ + O (1 −z/ρ) ,
γ :=
s
2φ(τ)
φ′′(τ),
which implies a full asymptotic expansion for yn = [zn]y(z) in odd powers of 1/√n.
(The statement extends to the aperiodic case, with the necessary condition that n ≡1
mod p, when φ has period p.)
We have seen already that this framework covers binary, unary-binary, general
Catalan, as well as Cayley trees (Figure 10, p. 389). Here is another typical applica-
tion.

436
VII. APPLICATIONS OF SINGULARITY ANALYSIS
EXAMPLE VII.5.
Mobiles. A (labelled) mobile, as deﬁned by Bergeron, Labelle, and Ler-
oux [39, p. 240], is a (labelled) tree in which subtrees dangling from the root are taken up to
cyclic shift:
1
2
3! + 3 = 9
4! + 4 × 2 + 4 × 3 + 4 × 3 × 2 = 68
(Think of Alexander Calder’s creations.) The speciﬁcation and EGF equation are
M = Z ⋆(1 + CYC M)
=⇒
M(z) = z
„
1 + log
1
1 −M(z)
«
.
(By deﬁnition, cycles have at least one components, so that the neutral structure must be added
to allow for leaf creation.) The EGF starts as M(z) = z + 2 z2
2! + 9 z3
3! + 68 z4
4! + 730 z5
5! + · · · ,
whose coefﬁcients constitute EIS A038037.
The veriﬁcation of the conditions of the theorem are immediate. We have φ(u) = 1 +
log(1 −u)−1, whose radius of convergence is 1. The characteristic equation reads
1 + log
1
1 −τ −
τ
1 −τ = 0,
which has a unique positive root at τ .= 0.68215. (In fact, one has τ = 1 −1/T(e−2), with T
the Cayley tree function.) The radius of convergence is ρ ≡1/φ′(τ) = 1 −τ. The asymptotic
formula for the number of mobiles then results:
1
n!Mn ∼C · Ann−3/2,
where
C .= 0.18576, A .= 3.14461.
(This example is adapted from [39, p. 261], with corrections.) . . END OF EXAMPLE VII.5. □
 VII.6. Trees with node degrees that are prime numbers. Let P be the class of all plane un-
labelled trees such that the (out)degrees of internal nodes belong to the set of prime numbers,
{2, 3, 5, . . .}. One has P(z) = z + z3 + z4 + 2 z5 + 6 z6 + 8 z7 + 29 z8 + 50 z9 + · · · ,
and Pn ∼Cωnn−3/2, with ω .= 2.79256 84676. The asymptotic form “forgets” many de-
tails of the distribution of primes, so that it can be obtained to great accuracy. (Compare with
Example V.10, p. 317 and Note 23, p. 458.)

VII. 3.2. Basic tree parameters. Throughoutthis subsection, we consider a sim-
ple variety of trees V, whose generating function (OGF or EGF, as the case may be)
will be denoted by y(z), satisfying the inverse relation y = zφ(y). In order to place
all cases under a single umbrella, we shall write yn = [zn]y(z), so that the number of
trees of size n is either Vn = yn (unlabelled case) or Vn = n!yn (labelled case). We
postulate throughout that y(z) belongs to the smooth inverse-function schema and is
aperiodic.
As already seen on several occasions in Chapter III (Section III.5, p. 170), addi-
tive parameters lead to generating functions that are expressible in terms of the basic
tree generating function y(z). Now that singularity analysis is available, such gener-
ating functions can be exploited systematically, with a wealth of asymptotic estimates

VII. 3. SIMPLE VARIETIES OF TREES AND INVERSE FUNCTIONS
437
relative to trees of large sizes coming within easy reach. The universality of the square-
root singularity amongst varieties of trees that satisfy the smoothness assumption then
implies universal behaviour for many tree parameters, which we now list.
— Node degrees. The degree of the root in a large random tree is O(1) on
average and with high probability, and its asymptotic distribution can be
generally determined (Example 6). A similar property holds for the degree
of a random node in a random tree (Example 8).
— Level proﬁles can also be determined. The quantity of interest is the mean
number of nodes in the kth layer from the root in a random tree. It is seen
for instance that, near the root, a tree from a simple variety tends to grow lin-
early (Example 7), this in sharp contrast with other random tree models (for
instance, increasing trees, Subsection VII. 9.2, p. 500), where the growth is
exponential. This property is one of the numerous indications that random
trees taken from simple varieties are skinny and far from having perfectly
balanced shape. A related property is the fact that path length is on average
O(n√n) (Example 9), which means that the typical depth of a random node
in a random tree is O(√n).
These basic properties are ony the tip of an iceberg. Indeed, Meir and Moon, who
launched the study of simple varieties of trees (the seminal paper [356] can serve as a
good starting point) have worked out literaly several dozen analyses of parameters of
trees, using a strategy similar to the one exposed here5. We shall have occasion in later
chapters to return to probabilistic properties of simple varieties of trees satisfying the
smooth inverse-function schema—we only indicate here for completeness that height
is known generally to scale as √n and is associated to a limiting theta distribution (see
Proposition V.4, p. 306 for the special case of Catalan trees and [197, 180, 314] for
general results), with similar properties holding true for width as shown by Odlyzko–
Wilf and Chassaing-Marckert-Yor [83, 379].
EXAMPLE VII.6.
Root degrees in simple varieties.
Here is an immediate application of
singularity analysis, one that exempliﬁes the synthetic type of reasoning that goes along with
the method. Take for notational simplicity a simple family V that is unlabelled, with OGF
V (z) ≡y(z). Let V[k] be the subset of V composed of all trees whose root has degree equal
to k. Since a tree in V[k] is formed by appending a root to a collection of k trees, one has
V [k](z) = φkzy(z)k,
φk := [wk]φ(w).
For any ﬁxed k, a singular expansion results from raising both members of (21) to the kth power;
in particular,
(22)
V [k](z) = φkz
»
τ k −kγτ k−1
r
1 −z
ρ + O
„
1 −z
ρ
«–
.
This is to be compared to the basic estimate (21): the ratio V [k]
n /Vn is then asymptotic to the
ratio of the coefﬁcients of
p
1 −z/ρ in the corresponding generating functions, V [k](z) and
5The main difference is that Meir and Moon appeal to the Darboux-P´olya method discussed in Sec-
tion VI. 11 instead of singularity analysis.

438
VII. APPLICATIONS OF SINGULARITY ANALYSIS
Tree
φ(w)
τ, ρ
PGF of root degree
(type)
simple variety
uφ′(τu)/φ′(τ)
binary
(1 + w)2
1, 1
4
1
2u + 1
2u2
(Bernoulli)
unary-binary
1 + w + w2
1, 1
3
1
3u + 2
3u2
(Bernoulli)
general
(1 −w)−1
1
2, 1
4
u/(2 −u)2
(sum of two geometric)
Cayley
ew
1, e−1
ueu−1
(shifted Poisson)
FIGURE VII.5. The distribution of root degree in simple varieties of trees of the smooth
inverse-function schema.
V (z) ≡y(z). Thus, for any ﬁxed k, we have found that
(23)
V [k]
n
Vn = ρkφkτ k−1 + O(n−1/2).
(The error term is in fact of the form O(n−1), as seen when pushing the expansion one step
further.)
The ratio V [k]
n /Vn is the probability that the root of a random tree of size n has degree k.
Since ρ = 1/φ′(τ), one can rephrase (23) as follows: In a smooth simple variety of trees, the
random variable ∆representing root-degree admits a discrete limit distribution given by
(24)
lim
n→∞PVn(∆= k) = kφkτ k−1
φ′(τ)
.
(By general principles exposed in Chapter IX, convergence is uniform.) Accordingly, the prob-
ability generating function (PGF) of the limit law admits the simple expression
EVn
“
u∆”
= uφ′(τu)/φ′(τ).
The distribution is thus characterized by the fact that its PGF is a scaled version of the deriv-
ative of the basic tree constructor φ(w). Figure 5 summarizes this property together with its
specialization to our four pilot examples. . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE VII.6. □
Additive functionals. Singularity analysis gives access to many additive param-
eters of trees. Consider three tree parameters, ξ, η, σ satisfying the basic relation,
(25)
ξ(t) = η(t) +
deg(t)
X
j=1
σ(tj),
which can be taken to deﬁne ξ(t) in terms of the simpler parameter η(t) and the sum
of values of σ over the root subtrees of t (deg(t) is the degree of the root of t and tj is
the jth root subtree). As we are interested in average-case analysis, we introduce the
cumulative GFs,
(26)
Ξ(z) =
X
t
ξ(t)z|t|,
H(z) =
X
t
η(t)z|t|,
Σ(z) =
X
t
σ(t)z|t|,
assuming an unlabelled variety of trees for simplicity. We ﬁrst state a simple algebraic
result which formalizes several of the calculations of Section III. 5, p. 170.

VII. 3. SIMPLE VARIETIES OF TREES AND INVERSE FUNCTIONS
439
Lemma VII.1 (Iteration lemma for trees). For tree parameters from a simple variety
with GF y(z) that satisfy the additive relation (25), the cumulative generating func-
tions (26), are related by
(27)
Ξ(z) = H(z) + zφ′(y(z))Σ(z).
In particular, if ξ is deﬁned recursively in terms of η, that is, σ ≡ξ, one has
(28)
Ξ(z) =
H(z)
1 −zφ′(y(z)) = zy′(z)
y(z) H(z).
In the case of a recursive parameter, unwinding the recursion shows that ξ(t) := P
s⪯t η(s),
where the sum is extended to all subtrees s of t (written s ⪯t).
PROOF. We have
Ξ(z) = H(z) + eΞ(z),
where
eΞ(z) :=
X
t∈V

z|t|
deg(t)
X
j=1
σ(tj)

.
Spitting the expression of eΞ(z) according to the values r of root degree, we ﬁnd
eΞ(z)
=
X
r≥0
φrz1+|t1|+···+|tr| (σ(t1) + σ(t2) + · · · + σ(tr))
=
z
X
r≥0
φr
 Σ(z)y(z)r−1 + y(z)Σ(z)y(z)r−2 + · · · y(z)r−1Σ(z)

=
zΣ(z) ·
X
r≥0
 rφry(z)r−1
,
which yields the linear relation expressing Ξ in (27).
In the recursive case, the function Ξ is determined by a linear equation, namely
Ξ(z) = H(z) + zφ′(y(z))Ξ(z), which, once solved, provides the ﬁrst form of (28).
Differentiation of the fundamental relation y = zφ(y) yields the identity
y′(1 −zφ′(y)) = φ(y) = y
z ,
i.e.,
1 −zφ′(y) = y
zy′ ,
from which the second form results.
□
 VII.7. A combinatorial interpretation. For a recursive parameter, we can view Ξ(z) as the
GF of trees with one subtree marked, to which is attached a weight of η. Then (28) can be
interpreted as follows: point to an arbitrary node at a tree in V (the GF is zy′(z)), “subtract” the
tree attached to this node (a factor of y(z)−1), and replace it by the same tree but now weighted
by η (the GF is H(z)).

 VII.8. Labelled varieties. Formulae (27) and (28) hold verbatim for labelled trees (either
of the plane or nonplane type), provided we interpret y(z), Ξ(z), H(z) as EGFs: Ξ(z) :=
P
t∈V ξ(t)z|t|/|t|!, and so on.

EXAMPLE VII.7.
Mean level proﬁle in simple varieties. The question we address here is
that of determining the mean number of nodes at level k (i.e., at distance k from the root) in a
random tree of some large size n. An explicit expression for the joint distribution of nodes at
all levels has been developed in Subsection III. 6.2, p. 182, but this multivariate representation
is somewhat hard to interpret in concrete terms.

440
VII. APPLICATIONS OF SINGULARITY ANALYSIS
Let ξk(t) be the number of nodes at level k in tree t. Deﬁne the generating function of
cumulated values,
Xk(z) :=
X
t∈V
ξk(t)z|t|.
Clearly, X0(z) ≡y(z) since each tree has a unique root. Then, since the parameter ξk is
the sum over subtrees of parameter ξk−1, we are in a situation exactly covered by (27), with
η(t) ≡0. The relation Xk(z) = zφ′(y(z))Ξk−1(z), is then immediately solved by recurrence,
to the effect that
(29)
Xk(z) =
`
zφ′(y(z))
´k y(z).
Making use of the (analytic) expansion of φ′ at τ, namely, φ′(y) ∼φ′(τ) + φ′′(τ)(y −τ) and
of ρφ′(τ) = 1, one gets for any ﬁxed k
Xk(z) ∼
„
1 −kγρφ′′(τ)
r
1 −z
ρ
« „
τ −γ
r
1 −z
ρ
«
∼τ −γ(τρφ′′(τ)k + 1)
r
1 −z
ρ.
Thus comparing the singular part of Xk(z) to that of y(z), we ﬁnd: For ﬁxed k, the mean
number of nodes at level k in a tree is of the asymptotic form
EVn[ξk] ∼Ak + 1,
A := τρφ′′(τ).
This result was ﬁrst given by Meir and Moon [356]. The striking fact is that, although the
number of nodes at level k can at least double at each level, growth is only linear on average.
In ﬁgurative terms, the immediate vicinity of the root starts like a “cone”, and trees of simple
varieties tend to be rather skinny near their base.
When used in conjunction with saddle point bounds, the exact GF expression of (29) addi-
tionally provides a probabilistic upper bound on the height of trees of the form O(n1/2+δ) for
any δ > 0. Indeed restrict z to the interval (0, ρ) and assume that k = n1/2+δ. Let χ be the
height parameter. First, we have
(30)
PVn(χ ≥k) ≡EVn([[ξk ≥1]]) ≤EVn(ξk).
Next by saddle point bounds, for any legal positive x (0 < x < Rconv(φ)),
(31)
EVn(ξk) ≤
`
xφ′(y(x))
´k y(x)x−n ≤τ
`
xφ′(y(x))
´k x−n.
Fix now x = ρ −nδ
n . Local expansions then show that
(32)
log
“`
xφ′(y(x))
´k x−n”
≤−Kn3δ/2 + O
“
nδ”
,
for some positive constant K. Thus, by (30) and (32): In a smooth simple variety of trees,
the probability of height exceeding n1/2+δ is exponentially small, being of the rough form
exp(−n3δ/2).
Accordingly, the mean height is O(n1/2+δ) for any δ > 0.
Flajolet and
Odlyzko [197] have characterized the moments of height, the mean being in particular asymp-
totic to λ√n and the limit distribution being of the Theta type already encountered in Chapter V
in the particular case of general Catalan trees, where explicit expressions are available. (Further
local limit and large deviation estimates appear in [180].) Figure 6 displays three random trees
of size n = 500.
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE VII.7. □
 VII.9. The variance of level proﬁles. The BGF of trees with u marking nodes at level k
has an explicit expression, in accordance with the developments of Chapter III. For instance
for k = 3, this is zφ(zφ(zφ(uy(z)))). Double differentiation followed by singularity analysis
shows that
VVn[ξk] ∼1
2A2k2 −1
2A(3 −4A)k + τA −1,

VII. 3. SIMPLE VARIETIES OF TREES AND INVERSE FUNCTIONS
441
FIGURE VII.6. Three random 2–3 trees (Ω= {0, 2, 3}) of size n = 500 have height
respectively 48, 57, 47, in agreement with the fact that height is typicaly O(√n).
another result of Meir and Moon [356]. The precise analysis of the mean and variance in the
interesting regime where k ≍√n is also given in [356], but it requires the saddle point method
of Chapter VIII or the methods of Chapter IX.

EXAMPLE VII.8. Mean degree proﬁle. Let ξ(t) ≡ξk(t) be the number of nodes of degree k
in random tree of some variety V. The analysis extends that of the root degree seen earlier. The
parameter ξ is an additive functional induced by the basic parameter η(t) ≡ηk(t) deﬁned by
ηk(t) := [[deg(t) = k]]. By the analysis of root degree, we have for the GF of cumulated values
associated to η
H(z) = φkzy(z)k,
φk := [wk]φ(w),
so that, by the fundamental formula (28),
X(z) = φkzy(z)k zy′(z)
y(z)
= z2φky(z)k−1y′(z).
The singular expansion of zy′(z) results from that of y(z) by differentiation (Chapter VI),
zy′(z) = 1
2γ
1
p
1 −z/ρ
+ O(1),
and the corresponding coefﬁcient is [zn](zy′) = nyn. This gives immediately the singularity
type of X, which is of the form of an inverse square root. Thus,
X(z) ∼ρφkτ k−1(zy′(z))
implying (ρ = τ/φ(τ))
Xn
nyn ∼φkτ k
φ(τ) .
Consequently, one has:

442
VII. APPLICATIONS OF SINGULARITY ANALYSIS
Proposition VII.2. In a smooth simple variety of trees, the mean number of nodes of degree k
is asymptotic to λkn, where λk := φkτ k/φ(τ). Equivalently, the probability distribution of the
degree ∆′ of a random node in a random tree of size n satisﬁes
lim
n→∞Pn(∆′) = λk ≡φkτ k
φ(τ) ,
with PGF :
X
k
λkuk = φ(uτ)
φ(τ) .
For the usual tree varieties this gives:
Tree
φ(w)
τ, ρ
Probability distr.
(type)
binary
(1 + w)2
1, 1
4
PGF: 1
4 + 1
2u + 1
4u2
(Bernoulli)
unary-binary
1 + w + w2
1, 1
3
PGF: 1
3 + 1
3u + 1
3u2
(Bernoulli)
general
(1 −w)−1
1
2, 1
4
PGF: 1/(2 −u)
(Geometric)
Cayley
ew
1, e−1
PGF: eu−1
(Poisson)
For instance, asymptotically, a general Catalan tree has on average n
2 leaves, n
4 nodes of de-
gre 1 n
8 of degree 2, and so on; a Cayley tree has ∼ne−1/k! nodes of degree k; for bi-
nary (Catalan) trees, the four possible types of nodes each appear each with asymptotic fre-
quency 1
4. (These data agree with the fact that a random tree under Vn is distributed like a
branching process tree determined by the PGF φ(uτ)/φ(τ); see Subsection III. 6.2, p. 182.)
END OF EXAMPLE VII.8. □
 VII.10. Variances. The variance of the number of k-ary nodes is ∼νn, so that the distribu-
tion of the number of nodes of this type is concentrated, for each ﬁxed k. The starting point is
the BGF deﬁned implicitly by
Y (z, u) = z
“
φ(Y (z, u)) + φk(u −1)Y (z, u)k”
,
upon taking a double derivative with respect to u, setting u = 1, and ﬁnally performing singu-
larity analysis on the resulting GF of cumulated values.

 VII.11. The mother of a random node. The discrepancy in distributions between the root
degree and the degree of a random node deserves an explanation. Pick up a node distinct from
the root at random in a tree and look at the degree of its mother. The PGF of the law is in
the limit uφ′(uτ)/φ′(τ). Thus the degree of the root is asymptotically the same as that of the
mother of any non-root node.
More generally, let X have distribution pk := P(X = k). Construct a random variable Y
such that the probability qk := P(Y = k) is proportional both to k and pk. Then for the
associated PGFs, the relation q(u) = p′(u)/p′(1) holds. The law of Y is said to be the size-
biased version of the law of X. Here, a mother is picked up with an importance proportional to
its degree. In this perspective, Eve appears to be just like a random mother.

EXAMPLE VII.9. Path length. Path length of a tree is the sum of the distances of all nodes to
the root. It is deﬁned recursively by
ξ(t) = |t| −1 +
deg(t)
X
j=1
ξ(tj).
In this case, we have η(t) = |t| −1 corresponding to the GF of cumulated values H(z) =
zy′(z) −y(z), and the fundamental relation (28) gives
X(z) = (zy′(z) −y(z))zy′(z)
y(z)
= z2y′(z)2
y(z)
−zy′(z).
The type of y′(z) at its singularity is Z−1/2, where Z := (1 −z/ρ). The formula for X(z)
involves the square of y′, so that the singularity of X(z) is of type Z−1, resembling a simple

VII. 3. SIMPLE VARIETIES OF TREES AND INVERSE FUNCTIONS
443
pole. This means that the cumulated value Xn = [zn]X(z) grows like ρ−n, so that the mean
value of ξ over Vn has growth n3/2. Working out the constants, we ﬁnd
X(z) + zy′(z) ∼γ2
4τ
1
Z + O(Z−1/2).
As a consequence:
Proposition VII.3. In a random tree of size n from a smooth simple variety, the expectation of
path length satisﬁes
(33)
EVn(ξ) = λ
√
πn3 + O(n),
λ :=
s
φ(τ)
2τ 2φ′′(τ).
For our classical varieties, the main terms of (33) are then:
Binary
Unary-binary
General
Cayley
∼
√
πn3
∼1
2
√
3πn3
∼1
2
√
πn3
∼
q
1
2πn3
Observe that the quantity 1
nEVn(ξ) represents the expected depth of a random node in random
tree (the model is then [1 . . n] × Vn), which is thus ∼λ√n. (This result is consistent with
height of a tree being with high probability of order O(n1/2).) . END OF EXAMPLE VII.9. □
 VII.12. Variance of path length. Path length can be analysed starting from the bivariate gen-
erating function given by a functional equation of the difference type (see Chapter III, p. 174),
which allows for the computation of higher moments. The standard deviation is found to be
asymptotic to Λ2n3/2 for some computable constant Λ2 > 0, so that the distribution is spread.
(Louchard [339] and Tak´acs [460] have additionally worked out the asymptotic form of all mo-
ments, leading to a characterization of the limit law of path length that can be described in terms
of the Airy function and coincides with the Brownian excursion area.)

 VII.13. Generalizations of path length. Deﬁne the subtree size index of order α ∈R≥0 to
be ξ(t) ≡ξα(t) := P
s⪯t |s|α, where the sum is extended to all the subtrees s of t. This
corresponds to a recursively deﬁned parameter with η(t) = |t|α. The results of Section VI. 10
relative to Hadamard products and polylogarithms make it possible to analyse the singularities
of H(z) and X(z). It is found that there are three different regimes
α > 1
2
α = 1
2
α < 1
2
EVn(ξ) ∼Kαnα
EVn(ξ) ∼K1/2n log n
EVn(ξ) ∼Kαn
where each Kα is a computable constant. (This extends the results of Subsection VI. 10.3,
p. 409 to all simple varieties of trees that are smooth.)

VII. 3.3. Mappings. The basic construction of mappings,
(34)



F
=
SET(K)
K
=
CYC(T )
T
=
Z ⋆SET(T )
=⇒



F
=
exp(K)
K
=
log
1
1−T
T
=
zeT,
builds maps from Cayley trees, which constitute a smooth simple variety. The con-
struction lends itself to a number of multivariate extensions. For instance, the param-
eter χ(φ) equal to the number of cyclic points gives rise to the BGF
F(z, u) = exp

log
1
1 −uT

= (1 −uT )−1.

444
VII. APPLICATIONS OF SINGULARITY ANALYSIS
# components
∼1
2 log n
# cyclic nodes
∼
p
πn/2
# terminal nodes
∼ne−1
tail length (λ)
∼
p
πn/8
cycle length (µ)
∼
p
πn/8
tree size
∼n/3
component size
∼2n/3
FIGURE VII.7. Expectations of the main additive parameters of random mappings of size n.
The mean number of a cyclic points in a random mapping of size n is accordingly
µn ≡EFn[φ] = n!
nn [zn]
 ∂
∂uF(z, u)

u=1

= n!
nn [zn]
T
(1 −T )2 .
Singularity analysis is immediate as
T
(1 −T )2
∼
z→e−1
1
2
1
1 −ez
•——◮
[zn]
T
(1 −T )2
∼
n→∞
1
2en.
The mean number of cyclic points in a random n–mapping is asymptotic to
p
πn/2.
A large number of parameters can be analysed in this way systematically as shown in
the survey [198]: see Figure 7 for a summary of results whose proof we leave as an
exercise to the reader. The leftmost table describes global parameters of mappings;
the rightmost table is relative to properties of random point in random n-mapping: λ
is the distance to its cycle of a random point, µ the length of the cycle to which the
point leads, tree size and component size are respectively the size of the largest tree
containing the point and the size of its (weakly) connected component. In particular, a
random mapping of size n has relatively few components, some of which are expected
to be of a fairly large size.
The properties outlined above for the class of all maping also prove to be universal
for a wide varety of mappings deﬁned by degree restrictions of various sorts.
EXAMPLE VII.10.
Simple varieties of mappings. Let Ωbe a subset of the integers and
consider mappings φ ∈F such that the number of preimages of any point is constrained to lie
in Ω. Such special mappings may serve to model the behaviour of special classes of functions
under iteration, and are accordingly of interest in various areas of computational number theory
and cryptography. For instance the quadratic functions φ(x) = x2+a over Fp have the property
that each element y has either zero, one, or two preimages (depending on whether y −a is a
quadratic nonresidue, 0, or a quadratic residue).
The basic construction of mappings needs to be amended. Start with the family of trees T
that are the simple variety corresponding to Ω:
T = zφ(T),
φ(w) :=
X
ω∈Ω
uω
ω! .
At any vertex on a cycle, one must graft r trees with the constraint that r + 1 ∈Ω(since one
edge is coming from the cycle itself). Such legal tuples with a root appended are represented by
U = zφ′(T),
since φ is an exponential generating function and shift corresponds to differentiation. Then
connected components and components are formed in the usual way by
K = log
1
1 −U ,
F = exp(K) =
1
1 −U .

VII. 4. TREE-LIKE STRUCTURES AND IMPLICIT FUNCTIONS
445
We assume that φ (i.e., Ω) satisﬁes the general conditions of Theorem VII.2, with τ the charac-
teristic value. Then T(z) has a square-root singularity at ρ = τ/φ(τ). The same holds for U
which satisﬁes the singular expansion
(35)
U(z) ∼1 −ρφ′′(τ)γ
r
1 −z
ρ,
since U = zφ′(T). Thus, eventually,
F(z) ∼
λ
q
1 −z
ρ
.
There results the universality of an n−1/2 law in such constrained mappings,
1
n!Fn ∼
λ
√πnρ−n,
which nicely extends what is known to hold for unrestricted mappings. The analysis of additive
functionals can then proceed on lines very similar to the case of standard mappings, to the
effect that the estimates of Figure 7 hold, albeit with different multiplicative constants. The
programme just sketched has been carried out in a thorough way by Arney and Bender in [14]
to which we refer for a detailed treatment. . . . . . . . . . . . . . . . . . . END OF EXAMPLE VII.10. □
 VII.14. Probabilities of ﬁrst-order sentences. A beautiful theorem of Lynch [348], much in
line with the global aims of analytic combinatorics, gives a class of properties of random map-
pings for which asymptotic probabilities are systematically computable. In logics, a ﬁrst-order
sentence is built out of variables, equality, boolean connectives (∨, ∧, ¬, etc), and quantiﬁers
(∀, ∃). In addition, there is a function symbol ϕ, representing a generic mapping.
Theorem. Given a property P expressed by a ﬁrst-order sentence, let µn(P) be the
probability that P is satisﬁed by a random mapping ϕ of size n. Then the quantity
µ∞(P) = limn→∞µn(P) exists and its value is given by an expression consisting
of integer constants and the operators +, −, ×, ÷, and ex.
For instance:
P :
ϕ is perm.
ϕ without ﬁxed pt.
ϕ has #leaves ≥2
∀x∃yϕ(y) = x
∀x¬ϕ(x) = x
∃x, y [x ̸= y ∧∀z[ϕ(z) ̸= x ∧ϕ(z) ̸= y]]
µ∞(P)
0
e−1
1
One can express in this language a property like P12 : “all cycles of length 1 are attached to
trees of height at most 2”, for which the limit probability is e−1+e−1+e−1
. The proof of the theo-
rem is based on Ehrenfeucht games supplemented by ingenious inclusion-exclusion arguments.
(Most examples, like P12, can be directly treated by singularity analysis.) Compton [94, 95, 96]
has produced lucid surveys of this area of logics, known as ﬁnite model theory.

VII. 4. Tree-like structures and implicit functions
The goal of this section is to show that universality of the square-root singularity
type holds for classes of recursively deﬁned structures, which considerably extend
the case of (smooth) simple varieties of trees. The starting point is the investigation of
labelled recursive classes Y, with associated GF y(z), that are given by a construction,
(36)
Y = G[Z, Y]
=⇒
y(z) = G(z, y(z))

446
VII. APPLICATIONS OF SINGULARITY ANALYSIS
where G may be an arbitrary composition of basic constructors reﬂected by a bivari-
ate function G(z, w) in the labelled case. This situation covers for instance hierar-
chies (Chapter II), Schr¨oder’s generalized systems (Chapter I), paths with diagonal
steps, as well as trees with variable node sizes or edge lengths. The unlabelled uni-
verse also beneﬁts from the technology developed for functions implicitly deﬁned by
y = G(z, y). This technology then makes it possible to estimate counting sequences
and parameters of many recursive structures, when P´olya operators are involved (Sec-
tion VII.5, p. 453).
VII. 4.1. The smooth implicit-function schema. The investigation of (36) ne-
cessitates certain analytic conditions to be satisﬁed by the bivariate function G, which
we ﬁrst encapsulate into the deﬁnition of a schema.
Deﬁnition VII.4. Let y(z) be a function analytic at 0, y(z) = P
n≥0 ynzn, with
y0 = 0 and yn ≥0. The function is said to belong to the smooth implicit-function
schema if there exists a bivariate G(z, w) such that
y(z) = G(z, y(z)),
where G(z, w) satisﬁes the following conditions.
— (I1): G(z, w) = P
m,n≥0 gm,nzmwn is analytic in a domain |z| < R and
|w| < S, for some R, S > 0.
— (I2): The coefﬁcients of G satisfy
(37)
gm,n ≥0,
g0,0 = 0,
g0,1 ̸= 1,
gm,n > 0
for some m and for some n ≥2.
— (I3): There exist two numbers r, s, such that 0 < r < R and 0 < s < S, satisfying
the system of equations,
(38)
G(r, s) = s,
Gw(r, s) = 1,
with
r < R,
s < S,
which is called the characteristic system. A class Y with such a generating function
y(z) is also said to belong to the smooth implicit-function schema.
Postulating that G(z, w) is analytic and with nonnegativecoefﬁcients is a minimal
assumption in the context of analytic combinatorics. The problem is assumed to be
normalized, so that y(0) = 0 and G(0, 0) = 0, the condition g0,1 ̸= 1 being imposed
to avoid that the implicit equation be of the reducible form y = y + · · · (ﬁrst line
of (37)). The second condition of (37) means that in G(z, y), the dependency on y
is nonlinear (otherwise, the analysis resorts to rational and meromorphic asymptotic
methods of Chapter V). The major analytic condition is (I3), which postulates the
existence of positive solutions r, s to the characteristic system within the domain of
analyticity of G.
The main result6 due to Meir and Moon [360] expresses universality of the square-
root singularity together with its usual consequences regarding asymptotic counting.
6This theorem has an interesting history. An overly general version of it was ﬁrst stated by Bender in
1974 (Theorem 5 of [29]). Canﬁeld [77] pointed out ten years later that Bender’s conditions were not quite
sufﬁcient to grant square-root singularity. A corrected statement was given by Meir and Moon in [360]
with a further (minor) erratum in [359]. We follow here the form given in Theorem 10.13 of Odlyzko’s
survey [377] with the correction of another minor misprint (regarding g0,1 which should read g0,1 ̸=

VII. 4. TREE-LIKE STRUCTURES AND IMPLICIT FUNCTIONS
447
Theorem VII.3 (Smooth implicit-function schema). Let y(z) belong to the smooth
implicit-function schema deﬁned by G(z, w), with (r, s) the positive solution of the
characteristic system. Then, y(z) converges at z = r where it has a square-root
singularity,
y(z) =
z→r s −γ
p
1 −z/r + O(1 −z/r),
γ :=
s
2rGz(r, s)
Gww(r, s) ,
the expansion being valid in a ∆-domain. If, in addition, y(z) is aperiodic7, then r is
the unique dominant singularity of y and the coefﬁcients satisfy
[zn]y(z)
=
n→∞
γ
2
√
πn3 r−n  1 + O(n−1
.
Observe that the assumptions imply the existence of exactly one root of the char-
acteristic system within the part of the positive quadrant where G is analytic, since,
obviously, yn cannot admit two asymptotic expressions with different parameters. A
complete expansion exists in powers of (1 −z/r)1/2 (for y(z)) and in powers of 1/n
(for yn), while periodic cases can be treated by a simple extension of the technical
apparatus to be developed.
The proof of this theorem ﬁrst necessitates two statements of independent inter-
est: (i) Lemma VII.2 is logically equivalent to an analytic version of the classical Im-
plicit Function Theorem found in APPENDIX B: Implicit Function Theorem, p. 698.
(ii) Lemma VII.3 supplements this by describing what happens at a point where the
implicit function theorem “fails”. (These two statements extend the analytic and the
singular inversion lemma of Subsection IV. 7.1, p. 261.)
Lemma VII.2 (Analytic Implicit Functions). Let F(z, w) be z bivariate function
analytic at (z, w) = (z0, w0). Assume that F(z0, w0) = 0 and Fw(z0, w0) ̸= 0.
Then, there exists a unique function y(z) analytic in a neighbourhood of z0 such that
y(z0) = w0 and F(z, y(z)) = 0.
PROOF. This is a restatement of the Analytic Implicit Function Theorem of APPEN-
DIX B: Implicit Function Theorem, p. 698, upon effecting a translation z 7→z + z0,
w 7→w + w0. (This property extends the Analytic Inversion Lemma IV.2, p. 262.) □
Lemma VII.3 (Singular Implicit Functions). Let F(z, w) be a bivariate function an-
alytic at (z, w) = (z0, w0). Assume the conditions: F(z0, w0) = 0, Fz(z0, w0) ̸= 0,
Fw(z0, w0) = 0, and Fww(z0, w0) ̸= 0. Choose an arbitrary ray of angle θ emanat-
ing from z0. Then there exists a neighbourhood Ωof z0 such that at every point z of Ω
with z ̸= z0 and z not on the ray, the equation F(z, y) = 0 admits two solutions y1(z)
and y2(z) that are analytic in Ωslit along a ray and satisfy, as z →z0
y1(z) = y0 −γ
p
1 −z/z0 + O (1 −z/z0)) ,
γ :=
s
2z0Fz(z0, w0)
Fww(z0, w0) ,
1). A statement concerning a restricted class of functions (either polynomial or entire) already appears in
Hille book [268, p. 274].
7In the usual sense: f(z) = P
n fnzn is aperiodic if there exist three indices i < j < k such that
fifjfk ̸= 0 and gcd(j −i, k −i) = 1.

448
VII. APPLICATIONS OF SINGULARITY ANALYSIS
1.25
0.7
0.25
0.9
z
1.0
1.5
1.0
0.8
0.75
0.5
0.0
0.6
0.5
0.4
0.3
0.2
0.1
0.0
FIGURE VII.8. The connection problem for the equation w = 1
4z + w2 (with explicit
forms w = 1 ± √1 −z): the combinatorial solution y(z) near z = 0 and the two analytic
solutions y1(z), y2(z) near z = 1.
and similarly for y2 whose expansion is obtained by changing √to −√.
PROOF. Locally, near (r, s), the function F(z, w) behaves like
(39)
F + (w −s)Fw + (z −r)Fz + 1
2(w −s)2Fww,
(plus smaller order terms), where F and its derivatives are evaluated at the point (r, s).
Since F = Fw = 0, cancelling (39) suggests for the solutions of F(z, w) = 0 near
z = r the form
w −s = ±γ
√
r −z + O(z −r),
which is consistent with the statement. This informal argument can be justiﬁed by the
following steps (details omitted): (a) establish the existence of a formal solution in
powers of ±(1 −z/r)1/2; (b) prove, by the method of majorant series, that the formal
solutions also converge locally and provide a solution to the equation.
Alternatively, by the Weierstrass Preparation Theorem (see again APPENDIX B:
Implicit Function Theorem, p. 698) the two solutions y1(z), y2(z) that assume the
value s at z = r are solutions of a quadratic equation
(Y −s)2 + b(z)(Y −s) + c(z) = 0,
where b and c are analytic at z = r, with b(r) = c(r) = 0. The solutions are then
obtained by the usual formula for solving a quadratic equation,
Y −s = 1
2

−b(z) ±
p
b(z)2 −4c(z)

,
which provides for y1(z) an expression as the square-root of an analytic function and
yields the statement. (This property extends the Singular Inversion Theorem VI.6,
p. 387.)
□

VII. 4. TREE-LIKE STRUCTURES AND IMPLICIT FUNCTIONS
449
It is now possible to return to the proof of our main statement.
PROOF. [Theorem VII.3] Given the two lemmas, the general idea of the proof of The-
orem VII.3 can be easily grasped. Set F(z, w) = w −G(z, w). There exists a unique
analytic function y(z) satisfying y = G(z, y) near z = 0, by the analytic lemma.
On the other hand, by the singular lemma, near the point (z, w) = (r, s), there exist
two solutions y1, y2, both of which have a square root singularity. Given the positive
character of the coefﬁcients of G, it is not hard to see that, of y1, y2, the function y1(z)
is increasing as z approaches from the left (assuming the principal determination of
the square root in the deﬁnition of γ). A simple picture of the situation regarding the
solutions to the equation y = G(z, y) is exempliﬁed by Figure 8.
The problem is then to show that a smooth analytic curve (the dotted curve in
Figure 8) does connect the solution at 0 to the increasing branch solution at r. Pre-
cisely, one needs to check that y1(z) (deﬁned near r) is the analytic continuation of
y(z) (deﬁned near 0) as z increases along the positive real axis. This is indeed a deli-
cate connection problem whose technical proof is discussed in Note 15. Once this fact
is granted and it has been veriﬁed that r is the unique dominant singularity of y(z)
(Note 16), the statement of Theorem VII.3 follows directly by singularity analysis. □
 VII.15. The connection problem for implicit functions. A proof that y(z) and y1(z) are well
connected is given by Meir and Moon in [360] from which our description is adapted.
Let ρ be the radius of convergence of y(z) at 0 and τ = y(ρ). The point ρ is a singularity
of y(z) by Pringsheim’s Theorem. The goal is to establish that ρ = r and τ = s. Regarding
the curve
C =
˘
(z, y(z))
˛˛
0 ≤z ≤ρ
¯
,
this means that three cases are to be excluded:
(a) C stays entirely in the interior of the rectangle
R :=
˘
(z, y)
˛˛
0 ≤z ≤r, 0 ≤y ≤s
¯
.
(b) C intersects the upper side of the rectangle R at some point of abscissa r0 < r where
y(r0) = s.
(c) C intersects the rightmost side of the rectangle R at the point (r, y(r)) with y(r) < s.
Graphically, the three cases are depicted in Figure 9.
(a)
(b)
(c)
FIGURE VII.9. The three cases
(a), (b), and (c), to be excluded
(solid lines).
In the discussion, we make use of the fact that G(z, w), which has nonnegative coefﬁcients
is an increasing function in each of its argument. Also, the form
(40)
y′ =
Gz(z, y)
1 −Gw(z, y),

450
VII. APPLICATIONS OF SINGULARITY ANALYSIS
shows differentiability (hence analyticity) of the solution y as soon as Gz(z, y) ̸= 1.
—Case (a) is excluded. Assume that 0 < ρ < r and 0 < τ < s. Then, we have
Gw(r, s) = 1, and by monotonicity properties of Gw, the inequality Gw(ρ, τ) < 1 holds. But
then y(z) must be analytic at z = ρ, which contradicts the fact that ρ is a singularity.
—Case (b) is excluded. Assume that 0 < r0 < r and y(r0) = s. Then there are two
distinct points on the implicit curve y = G(z, y) at the same altitude, namely (r0, s) and (r, s),
implying the equalities
y(r0) = G(r0, y(r0)) = s = G(r, s),
which contradicts the monotonicity properties of G.
—Case (c) is excluded. Assume that y(r) < s. Let a < r be a point chosen close
enough to r.
Then above a, there are three branches of the curve y = G(z, y), namely
y(a), y1(a), y2(a), where the existence of y1, y2 results from Lemma VII.3. This means that
the function y 7→G(a, y) has a graph that intersects the main diagonal at three points, a con-
tradiction with the fact that G(a, y) is a convex function of y.

 VII.16. Unicity of the dominant singularity. From the previous note, we know that y(r) = s,
with r the radius of convergence of y. The aperiodicity of y implies that |y(ζ)| < y(r) for all
|ζ| such that |ζ| = r and |ζ| ̸= r (see the Daffodil Lemma IV.1, p. 253). One then has for any
such ζ the property: |Gw(ζ, y(ζ))| < G(r, s) = 1, by monotonicity of Gw. But then by (40)
above, this implies that y(ζ) is analytic at ζ.

The solutions to the characteristic system (38) can be regarded as the intersection
points of two curves, namely,
G(r, s) −s = 0,
Gw(r, s) = 1.
Here are plots in the case of two functions G: the ﬁrst one has nonnegative coefﬁcients
while the second one (corresponding to a counterexample of Canﬁeld [77]) involves
negative coefﬁcients. Positivity of coefﬁcients implies convexity properties that avoid
pathological situations.
G(z, y) =
1
1 −z −y −1 −y −y3
G(z, y) =
z
24 −9y + y2
(positive)
(not positive)
0
0.2
0.4
(s)
0.1
0.2
(r)
0
2
4
(s)
10
20
(r)
VII. 4.2. Combinatorial applications. Many combinatorial classes, which ad-
mit a recursive speciﬁcation of the form Y = G(Z, Y), with G a constructor of sorts,
can be subjected to Theorem VII.3. The resulting structures are, to varying degrees,
avatars of tree structures. In what follows, we describe a few instances where the
square-root universality holds.

VII. 4. TREE-LIKE STRUCTURES AND IMPLICIT FUNCTIONS
451
|===|===|===|German
|
|
|===|English
|
|
|===|Dutch
|
|
|
|===|===|Swedish
|
|===|Danish
|===|Greek
|
|===|===|===|Portuguese
|
|
|===|Spanish
|
|
|===|Italian
|
|
|===|French
|
|
|
|===|Romanian
|
|===|Armenian
FIGURE VII.10. A hierarchy placed on some of the modern Indoeuropean languages.
— Hierarchies are trees enumerated by the number of their leaves (Exam-
ples 11 and 12).
— Trees with variable node sizes generalize simple families of trees; they oc-
cur in particular as models of secondary structures in mathematical biology
(Example 13).
— Lattice paths with variable edge lengths are attached to some of the most
classical objects of combinatorial theory (Note 18).
EXAMPLE VII.11.
Labelled hierarchies. The class L of labelled hierarchies, as deﬁned in
Note II.18, p. 119, satisﬁes
L = Z + SET≥2(L)
=⇒
L = z + eL −1 −L.
These occur in statistical classiﬁcation theory: given a collection of n distinguished items,
Ln is the number of ways of superimposing a nontrivial classiﬁcation (cf Figure 10). Such
abstract classiﬁcations usually have no planar structure, hence our modelling by a labelled set
construction.
In the notations of Deﬁnition VII.4, p. 446, the basic function is G(z, w) = z+ew−1−w,
which is analytic in |z| < ∞, |w| < ∞. The characteristic system is
r + es −1 −s = s,
es −1 = 1,
which has a unique positive solution, s = log 2, r = 2 log 2−1, obtained by solving the second
equation for s, then propagating the solution to get r. Thus, hierarchies belong to the smooth
implicit-function schema, and, by Theorem VII.3, the EGF L(z) has a square-root singularity.
One then ﬁnds mechanically
1
n!Ln ∼
1
2
√
πn3 (2 log 2 −1)−n+1/2 .
(The unlabelled counterpart is the object of Note 22 below.) . . END OF EXAMPLE VII.11. □
 VII.17. The degree proﬁle of hierarchies. Combining BGF techniques and singularity anal-
ysis, it is found that a random hierarchy of some large size n has on average about 0.57n nodes

452
VII. APPLICATIONS OF SINGULARITY ANALYSIS
A fragment of RNA is, in ﬁrst approximation, a tree-like
structure with edges corresponding to bases pairs and
“loops” corresponding to leaves. There are constraints
on the sizes of leaves (taken here between 4 and 7) and
length of edges (here between 1 and 4 base pairs). We
model such an RNA fragment as a planted tree P at-
tached to a binary tree (Y) with equations:
P = AY,
Y = AY 2 + B,
A = z2 + z4 + z6 + z8, B = z4 + z5 + z6 + z7.
FIGURE VII.11. A simpliﬁed combinatorial model of RNA structures as considered by
Waterman et al. [271, 430, 453].
of degree 2, 0.18n nodes of degree 3, 0.04n nodes of degree 4, and less than 0.01n nodes of
degree 5 or higher.

EXAMPLE VII.12. Trees enumerated by leaves. For a (nonempty) set Ω⊂Z≥0 that does not
contain 0,1, it makes sense to consider the class of labelled trees,
C = Z + KΩ(C),
K = SEQ or SET.
(A totally similar discussion can be conducted for unlabelled plane trees, with OGFs replacing
EGFs.) These are rooted trees (plane or non-plane, respectively), with size determined by the
number of leaves and with degrees constrained to lie in Ω. The EGF is then of the form
C(z) = z + η(C(z)).
This variety of trees includes the labelled hierarchies, which correspond to η(w) = ew −1−w.
Assume for simplicity η here to be entire (possibly a polynomial). The base function is
G(z, w) = z+η(w), and the characteristic system is s = r+η(s), η′(s) = 1. Since η′(0) = 0
and η′(+∞) = +∞, this system always has a solution:
s = η[−1](1),
r = s −η(s).
Thus Theorem VII.3 applies, giving
(41)
[zn]C(z) ∼
γ
2
√
πn3 r−n,
γ =
r
1
2rη′′(s),
and a full expansion can be obtained. . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE VII.12. □
EXAMPLE VII.13. Trees with variable edge lengths and node sizes. Consider unlabelled plane
trees in which nodes can be of different sizes: what is given is a set bΩof ordered pairs (ω, σ),
where a value (ω, σ) means that a node of degree ω and size σ is allowed. Simple varieties
in their basic form correspond to σ ≡1; trees enumerated by leaves (including hierarchies)
correspond to σ ∈{0, 1} with σ = 1 iff ω = 0. Figure 11 indicates the way such trees can
model the self-bonding of single stranded nucleic acids like RNA, according to Waterman et
al. [271, 430, 453]. Clearly an extremely large number of variations are possible.
The fundamental equation in the case of a ﬁnite bΩis
Y (z) = P(z, Y (z)),
P(z, w) :=
X
(ω,σ)∈bΩ
zσwω,

VII. 5. NONPLANE UNLABELLED TREES AND P ´OLYA OPERATORS
453
with P a polynomial. In the aperiodic case, there is invariably a formula of the form
Yn ∼κ · Ann3/2,
corresponding to the universal square-root singularity. . . . . . . . END OF EXAMPLE VII.13. □
 VII.18. Schr¨oder numbers. Consider the class Y of unary-binary trees where unary nodes
have size 2, while leaves and binary nodes have the usual size 1. The GF satisﬁes Y = z +
z2Y + zY 2, so that
Y (z) = zD(z2),
D(z) = 1 −z −
√
1 −6z + z2
2z
.
We have D(z) = 1 + 2 z + 6 z2 + 22 z3 + 90 z4 + 394 z5 + · · · , which is EIS A006318
(“Large Schr¨oder numbers”). By the bijective correspondence between trees and lattice paths,
Y2n+1 is in correspondence with excursions of length n made of steps (1, 1), (2, 0), (1, −1).
Upon tilting by 45◦, this is equivalent to paths connecting the lower left corner to the upper
right corner of an (n × n) square that are made of horizontal, vertical, and diagonal steps, and
never go under the main diagonal. The series S = z
2(1+D) enumerates Schr¨oder’s generalized
parenthesis systems (Chapter I, p. 64): S := z + S2/(1 −S), and the asymptotic formula
Y2n−1 = Sn = 1
2Dn−1 ∼
1
4
√
πn3
“
3 −2
√
2
”−n+1/2
follows straightforwardly.

VII. 5. Nonplane unlabelled trees and P´olya operators
Essentially all the results obtained earlier for simple varieties of trees extend to
the case of nonplane unlabelled trees. P´olya operators are central, and their treatment
is typical of the asymptotic theory of unlabelled objects obeying symmetries (i.e.,
involving the unlabelled MSET, PSET, CYC constructions), as seen repeatedly in this
book.
Binary and general trees. We shall start the discussion by considering the enu-
meration of two classes of non-plane trees following P´olya [395, 397] and Otter [382],
whose articles are important historic sources for the asymptotic theory of nonplane
tree enumeration—a brief account also appears in [259]. (These authors used the
more traditional method of Darboux instead of singularity analysis, but this distinc-
tion is immaterial here as calculations develop under completely parallel lines under
both theories.) The two classes under consideration are those of general and binary
non-plane unlabelled trees. In both cases, there is a fairly direct reduction to the enu-
meration of Cayley trees and of binary trees, which renders explicit several steps of
the calculation. The trick is, as usual, to treat quantities f(z2), f(z3), . . . , as “known”
analytic quantities.
Proposition VII.4 (Special non-plane unlabelled trees). Consider the two classes of
non-plane unlabelled trees
H = Z × MSET(H),
W = Z × MSET{0,2}(W)
respectively of the general and binary type. Then, with constants γH, AH and γW , AW
given by Notes 20 and 21, one has
Hn ∼
γH
2
√
πn3 An
H,
W2n−1 ∼
γW
2
√
πn3 An
W .

454
VII. APPLICATIONS OF SINGULARITY ANALYSIS
PROOF. (i) General case. The OGF of nonplane unlabelled trees is the analytic
solution to the functional equation
(42)
H(z) = z exp
H(z)
1
+ H(z2)
2
+ · · ·

.
Let T be the solution to
(43)
T (z) = zeT (z),
that is to say, the Cayley function. The function H(z) has a radius of convergence ρ
strictly less than 1 as its coefﬁcients dominate those of T (z), the radius of convergence
of the latter being exactly e−1 .= 0.367. The radius ρ cannot be 0 since the number of
trees is bounded from above by the number of plane trees whose OGF has radius 1
4.
Thus, one has 1
4 ≤ρ ≤e−1.
Rewriting the deﬁning equation of H(z) as
H(z) = ζeH(z)
with
ζ := z exp
H(z2)
2
+ H(z3)
3
+ · · ·

,
we observe that ζ = ζ(z) is analytic for |z| < ρ1/2, that is to say in a disk that properly
contains the disk of convergence of H(z). We may thus rewrite H(z) as
H(z) = T (ζ(z)).
Since ζ(z) is analytic at z = ρ, a singular expansion of H(z) near z = ρ results from
composing the singular expansion of T at e−1 with the analytic expansion of ζ at ρ.
In this way, we get:
(44)
H(z) = 1 −γ(1 −z
ρ)1/2 + O((1 −z
ρ)), γ =
p
2eρζ′(ρ).
Thus,
[zn]H(z) ∼
γ
2
√
πn3 ρ−n.
(ii) Binary case. Consider the functional equation
(45)
f(z) = z + 1
2f(z)2 + 1
2f(z2).
This enumerates non-plane binary trees with size deﬁned as the number of external
nodes, so that W(z) = 1
zf(z2). Thus, it sufﬁces to analyse [zn]f(z), which dispenses
us from dealing with periodicity phenomena.
The OGF f(z) has a radius of convergence ρ that is at least 1
4 (since there are
fewer non-plane trees than plane ones). It is also at most 1
2 as results from comparison
of f with the solution to the equation g = z + 1
2g2. We may then proceed as before:
treat the term 1
2f(z2) as a function analytic in |z| < ρ1/2, as though it were known,
then solve. To this effect, set
ζ(z) := z + 1
2f(z2),

VII. 5. NONPLANE UNLABELLED TREES AND P ´OLYA OPERATORS
455
which exists in |z| < ρ1/2. Then, the equation (45) becomes a plain quadratic equa-
tion, f = ζ + 1
2f 2, with solution
f(z) = 1 −
p
1 −2ζ(z).
The singularity ρ is the smallest positive solution of ζ(ρ) = 1
2. The singular expansion
of f is obtained by composing the analytic expansion of ζ at ρ with √1 −2ζ. The
usual square-root singularity results:
f(z) ∼1 −γ
p
1 −z/ρ,
γ :=
p
2ρζ′(ρ).
This induces the ρ−nn−3/2 form for the coefﬁcients [zn]f(z) ≡[z2n−1]W(z).
□
 VII.19. Full asymptotic expansions for Hn, W2n−1. They can be determined since the OGFs
admit complete asymptotic expansions in powers of
p
1 −z/ρ.

The argument used in the proof of the proposition may seem partly nonconstruc-
tive. However, numerically, the values of ρ and C can be determined to great ac-
curacy. See the notes below as well as Finch’s section on “Otter’s tree enumeration
constants” [165, Sec. 5.6].
 VII.20. Numerical evaluation of constants I. Here is an unoptimized procedure controlled
by a parameter m ≥0 for general non-plane unlabelled trees.
Procedure Get value of ρ(m : integer);
1. Set up a procedure to compute and memorize the Hn on demand;
(this can be based on recurrence relations implied by H′(z); see [373])
2. Deﬁne f [m](z) := Pm
j=1 Hnzn;
3. Deﬁne ζ[m](z) := z exp
“Pm
k=2
1
kf [m](zk)
”
;
4. Solve numerically ζ[m](x) = e−1 for x ∈(0, 1) to max(m, 10) digits of accuracy;
5. Return x as an approximation to ρ.
For instance, a conservative estimate of the accuracy attained for m = 0, 10, . . . , 50 (in a few
billion machine instructions) is:
m = 0
m = 10
m = 20
m = 30
m = 40
m = 50
3 · 10−2
10−6
10−11
10−16
10−21
10−26
Accuracy appears to be a little better than 10−m/2. This yields to 25D:
ρ .= 0.3383218568992076951961126, AH ≡ρ−1 .= 2.955765285651994974714818,
γH .= 1.559490020374640885542206.
The formula of the Proposition estimates H100 with a relative error of 10−3.

 VII.21. Numerical evaluation of constants II. The procedure of the previous note adapts
easily to give:
ρ .= 0.4026975036714412909690453, AW ≡ρ−1 .= 2.483253536172636858562289,
γW .= 1.130033716398972007144137.
The formula of the Proposition estimates [z100]f(z) with a relative error of 7 · 10−3.

The two results, general and binary, are thus obtained by a modiﬁcation of the
method used for simple varieties of trees, upon treating the P´olya operator part as an
analytic variant of the corresponding equations of simple varieties of trees.

456
VII. APPLICATIONS OF SINGULARITY ANALYSIS
Alkanes, alcohols, and degree restrictions. The previous two examples sug-
gest that a general theory is possible, for varieties of unlabelled non-plane trees,
T = Z MSETΩ(T ), for some Ω⊂Z≥0. First, we examine the case of special regular
trees deﬁned by Ω= {0, 3}, which, when viewed as alkanes and alcohols, are of rele-
vance to combinatorial chemistry (Example 14). Indeed, the problem of enumerating
isomers of such chemical compounds has been at the origin of P´olya’s foundational
works [395, 397]. Then, we extend the method to the general situation of trees with
degrees constrained to some ﬁnite set Ω(Proposition VII.4).
EXAMPLE VII.14. Nonplane trees and alkanes. In chemistry, carbon atoms (C) are known to
have valency 4 while hydrogen (H) has valency 1. Alkanes, also known as parafﬁns (Figure 12),
are are acyclic molecules formed of carbon and hydrogen atoms according to this rule and
without multiple bonds; they are thus of the type CnH2n+2. In combinatorial terms, we are
talking of unrooted trees with (total) node degrees in {1, 4}. The rooted version of these trees
are determined by the fact that a root is chosen and (out)degrees of nodes lie in the set Ω=
{0, 3}; these are rooted ternary trees and they correspond to alcohols (with the OH group
marking one of the carbon atoms).
Alcohols (A) are the simplest to enumerate as they are rooted trees. The OGF starts as
(EIS A000598)
A(z) = 1 + z + z2 + z3 + 2 z4 + 4 z5 + 8 z6 + 17 z7 + 39 z8 + 89 z9 + · · · ,
with size being taken here as the number of internal nodes. The speciﬁcation is
A = {ǫ} + Z MSET3(A).
(Equivalently A+ := A \ {ǫ} satisﬁes A+ = Z MSET0,1,2,3(A+).) This implies that A(z)
satisﬁes the functional equation:
A(z) = 1 + z
„1
3A(z3) + 1
2A(z)A(z2) + 1
6A(z)3
«
.
In order to apply Theorem VII.3, introduce the function
G(z, w) = 1 + z
„1
3A(z3) + 1
2A(z2)w + 1
6w3
«
,
which exists in |z| < |ρ|1/2 and |w| < ∞, with ρ the (yet unknown) radius of convergence
of A. Like before, the P´olya terms A(z2), A(z3) are teated as known functions. By methods
similar to those used in the analysis of binary and general trees (Subsection VII. 5), we ﬁnd that
the characteristic system admits a solution,
r .= 0.3551817423143773928,
s .= 2.1174207009536310225,
so that ρ = r and y(ρ) = s. Thus the growth of the number of alcohols is of the form
κ · 2.81546nn−3/2.
Let B(z) be the OGF of alkanes (EIS A000602), which are unrooted trees:
B(z) = 1 + z + z2 + z3 + 2 z4 + 3 z5 + 5 z6 + 9 z7 + 18 z835 z9 + 75 z10 + · · · .
For instance, B6 = 5 because there are 5 isomers of hexane, C6H14, for which chemists had to
develop a nomenclature system, interestingly enough based on a diameter of the tree:

VII. 5. NONPLANE UNLABELLED TREES AND P ´OLYA OPERATORS
457
H
H
H
H
H
H
H
OH H
|
|
|
|
|
|
|
|
|
|
|
|
|
|
|
|
|
|
H--C--H
H--C--C--H
H--C--C--C--H
H--C--C--C--H
|
|
|
|
|
|
|
|
|
|
|
|
|
|
|
|
|
|
H
H
H
H
H
H
H
H
H
Methane
Ethane
Propane
Propanol
FIGURE VII.12.
A few examples of alkanes (CH4, C2H6, C3H8) and an alcohol.
Hexane
3-Methylpentane
2-Methylpentane
2,3-Dimethylbutane
2,2-Dimethylbutane
The number of structurally different alkanes can then be found by an adaptation of the
dissimilarity formula (Equation (48) and Note 25). This problem has served as a powerful
motivation for the enumeration of graphical trees and its fascinating history goes back to Cayley.
(See Rains and Sloane’s article [406] and [397]). The asymptotic formula of (unrooted) alkanes
is of the form Ann−5/2 term, which represents roughly a proportion 1/n of the number of
(rooted) alcohols. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE VII.14. □
The pattern of analysis should by now be clear, and we state:
Theorem VII.4 (Nonplane unlabelled trees). Let Ω∋0 be a ﬁnite subset of Z≥0
and consider the variety V of (rooted) nonplane unlabelled trees with outdegrees of
nodes in Ω. Assume aperiodicity (gcd(Ω) = 1) and the condition that Ωcontains at
least one element larger than 1. Then the number of trees of size n in V satisﬁes an
asymptotic formula:
Vn ∼C · Ann−3/2.
PROOF. The argument given for alcohols is transposed verbatim. Only the existence
of a root of the characteristic system needs to be established.
The radius of convergence of V (z) is a priori ≤1. The fact that ρ is strictly less
than 1 is established by means of an exponential lower bound, Vn > Bn, for some
B > 1 and inﬁnitely many values of n. To obtain this exponential variability, ﬁrst
choose an n0 such that Vn0 > 1, then build a perfect d-ary tree (for some d ∈Ω,
d ̸= 0, 1) tree of height h, and ﬁnally graft freely subtrees of size n0 at n/(4n0)
of the leaves of the perfect tree. Choosing d such that dh > n/(4n0) yields the
lower bound. That the radius of convergence is nonzero results from the upper bound
provided by corresponding plane trees whose growth is at least exponential. Thus, one
has 0 < ρ < 1.

458
VII. APPLICATIONS OF SINGULARITY ANALYSIS
By the translation of multisets of bounded cardinality, the function G is polyno-
mial in ﬁnitely many of the quantities {V (z), V (z2), . . .}. Thus the function G(z, w)
constructed like in the case of alcohols converges in |z| < ρ1/2, |w| < ∞. As
z →ρ−1, we must have τ := V (ρ) ﬁnite, since otherwise, there would be a con-
tradiction in orders of growth in the nonlinear equation V (z) = · · · + · · · V (z)d · · ·
as z →ρ. Thus (ρ, τ) satisﬁes τ = G(ρ, τ). For the derivative, one must have
Gw(ρ, τ) = 1 since: (i) a smaller value would mean that V is analytic at ρ (by the
Implicit Function Theorem); (ii) a larger value would mean that a singularity has
been encountered earlier (by the usual argument on failure of the Implicit Function
Theorem). Thus, Theorem VII.3 on positive implicit functions is applicable.
□
A large number of variations are clearly possible as evidenced by the title of an
article [258] published by Harary, Robinson, and Schwenk in 1975, namely, “Twenty-
step algorithm for determining the asymptotic number of trees of various species”.
 VII.22. Unlabelled hierarchies. The class H of unlabelled hierarchies is speciﬁed by H =
Z + MSET≥2(H) (see Note 42, p. 68). One has
e
Hn ∼
γ
2
√
πn3 ρ−n,
ρ .= 0.29224.
(Compare with the labelled case of Example 11.) What is the asymptotic proportion of internal
nodes of degree r, for a ﬁxed r > 0?

 VII.23. Trees with prime degrees and the BBY theory. Bell, Burris, and Yeats [25] develop
a general theory meant to account for the fact that, in their words, “almost any family of trees
deﬁned by a recursive equation that is nonlinear [. . . ] lead[s] to an asymptotic law of the
P´olya form t(n) ∼Cρ−nn−3/2”. Their most general result (Th. 75) implies for instance that
the number of nonplane unlabelled trees whose node degrees are restricted to be prime numbers
admits such a P´olya form (see also Note 6, p. 436).

Unlabelled functional graphs (mapping patterns). Unlabelled functional graphs,
also known as “mapping patterns” (F) are unlabelled digraphs in which each vertex
has outdegree equal to 1. Equivalently, they can be regarded as multisets of compo-
nents (L) that are cycles of nonplane unlabelled trees (H),
F = MSET(L);
L = CYC(H);
H = Z × MSET(H),
a speciﬁcation that entirely parallels that of mappings in Equation (34), p. 443.
The OGF H(z) has a square-root singularity by virtue of (44) above, with addi-
tionally H(ρ) = 1. The translation of the unlabelled cycle construction,
L(z) =
X
j≥1
ϕ(j)
j
log
1
1 −H(zj),
implies that L(z) is logarithmic, and F(z) has a singularity of type 1/
√
Z where
Z := 1 −z/ρ. Thus, unlabelled functional graphs constitute an exp-log structure
with κ = 1
2. The number of unlabelled functional graphs thus grows like Cρ−nn−1/2
and the mean number of components in a random functional graph is ∼1
2 log n, like
for the labelled mapping counterpart. See [357] for more on this topic.

VII. 5. NONPLANE UNLABELLED TREES AND P ´OLYA OPERATORS
459
 VII.24. An alternative form of F(z). Arithmetical simpliﬁcations associated with the Euler
totient function yield:
F(z) =
∞
Y
k=1
“
1 −H(zk)
”−1
.
A similar form applies generally to multisets of unlabelled cycles.

Unrooted trees. All the trees considered so far have been rooted and this version
is the one most useful in applications. An unrooted tree8 is by deﬁnition a connected
acyclic (undirected) graph. In that case, the tree is clearly non-plane and no special
root node is distinguished.
The counting of the class U of unrooted labelled trees is easy: there are plainly
Un = nn−2 of these, since each node is distinguished by its label, which entails that
nUn = Tn, with Tn = nn−1 by Cayley’s formula. Also, the EGF U(z) satisﬁes
(46)
U(z) =
Z z
0
T (y) dy
y = T (z) −1
2T (z)2,
as already seen when we discussed labelled graphs in Chapter II.
For unrooted unlabelled trees, symmetries are in the way and a tree can be rooted
in a number of ways that depends on its shape. For instance of star graph leads to a
number of different rooted trees that equals 2 (choose either the center or one of the
peripheral nodes), while a line graph gives rise to ⌈n/2⌉structurally different rooted
trees. With H the class of rooted unlabelled trees and I the class of unrooted trees,
we have at this stage only the general inequality
In ≤Hn ≤nIn.
A table of values of the ratio Hn/In suggests that the answer is closer to the upper
bound:
(47)
n
10
20
30
40
50
60
Hn/In
6.78
15.58
23.89
32.15
40.39
48.62
The solution is provided by a famous exact formula due to Otter (Note 25):
(48)
I(z) = H(z) −1
2
 H(z)2 −H(z2)

,
which gives in particular (EIS A000055) I(z) = z + z2 + z3 + 2 z4 + 3 z5 + 6 z6 +
11 z7 + 23 z8 + · · · . Given (48), it is child’s play to determine the singular expansion
of I knowing that of H. The radius of convergence of I is the same as that of H as
the term H(z2) only introduces exponentially small coefﬁcients. Thus, it sufﬁces to
analyse H −1
2H2:
H(z) −1
2H(z)2 ∼1
2 −δ2Z + δ3Z3/2 + O
 Z2
,
Z =

1 −z
ρ

.
What is noticeable is the cancellation in coefﬁcients for the term Z1/2 (since 1 −x −
1
2(1 −x)2 = 1
2 + O(x2)), so that Z3/2 is the actual singularity type of I. Clearly,
the constant δ3 is computable from the ﬁrst four terms in the singular expansion of H
8Unrooted trees are also called sometimes free trees.

460
VII. APPLICATIONS OF SINGULARITY ANALYSIS
at ρ. Then singularity analysis yields: The number of unrooted trees of size n satisﬁes
the formula
(49)
In ∼
3δ3
4
√
πn5 ρ−n,
In ∼0.5349496061 · 2.9955765856nn−5/2.
The numerical values are from [165] and the result is Otter’s original [382]: an un-
rooted tree of size n gives rise to about different 0.8n rooted trees on average. (The
formula (49) corresponds to an error slightly under 10−2 for n = 100.)
 VII.25. Dissimilarity theorem for trees.
Here is how combinatorics justiﬁes (48), follow-
ing [39, §4.1]. Let I• (and I•–•) be the class of unrooted trees with one vertex (respectively one
edge) distinguished. We have I• ∼= H (rooted trees) and I•–• ∼= SET2(H). The combinatorial
isomorphism claimed is
(50)
I• + I•–• ∼= I + (I × I) .
A diameter of an unrooted tree is a simple path of maximal length. If the length of any diameter
is even, call “centre” its mid-point; otherwise, call “bicentre” its mid-edge. (For each tree, there
is either one centre or one bicentre.) The left-hand side of (50) corresponds to trees that are
pointed either at a vertex (I•) or an edge (I•–•). The term I on the right-hand side corresponds
to cases where the pointing happens to coincide with the canonical centre or bicentre. If there
is not coincidence, then, an ordered pair of trees results from a suitable surgery of the pointed
tree. [Hint: cut in some canonical way near the pointed vertex or edge.]

VII. 6. Irreducible context-free structures
In this section, we discuss an important variety of context-free classes, one that
satisﬁes the universal law of square-root singularities, attached to counting sequences
that are of the asymptotic form Ann−3/2. (General algebraic functions are treated in
the next section.)
VII. 6.1. Context-free speciﬁcations and the irreducibility schema. We start
from the notion of a context-free class introduced in Subsection I. 5.4, p. 75. A class
is context-free if it is the ﬁrst component of a system of combinatorial equations
(51)





Y1
=
F1(Z, Y1, . . . , Yr)
...
...
...
Yr
=
Fr(Z, Y1, . . . , Yr),
where each Fj is a construction that only involves the combinatorial constructions of
disjoint union and cartesian product. (This repeats Equation (67) of Chapter I, p. 75.)
As seen in Subsection I. 5.4, binary and general trees, triangulations, as well a Dyck
and Łukasiewicz languages are typical instances of context-freee classes.
As a consequence of the symbolic rules of Chapter I, the OGF of a context-free
class C is the ﬁrst component (C(z) ≡y1(z)) of the solution of a polynomial system
of equations of the form
(52)





y1(z)
=
Φ1(z, y1(z), . . . , yr(z))
...
...
...
yr(z)
=
Φr(z, y1(z), . . . , yr(z)),

VII. 6. IRREDUCIBLE CONTEXT-FREE STRUCTURES
461
where the Φj are polynomials. By elimination (Cf APPENDIX B: Algebraic elimina-
tion, p. 685), it is always possible to ﬁnd a bivariate polynomial P(z, y) such that
(53)
P(z, C(z)) = 0,
and C(z) is an algebraic function. (Algebraic functions are discussed in all generality
in the next section.)
The case of linear systems has been dealt with in Chapter V, when examining
the transfer matrix method. Accordingly, we only need to consider here nonlinear
systems (of equations or speciﬁcations) deﬁned by the condition that at least one Φj
in (52) is a polynomial of degree 2 or more, corresponding to the fact that at least one
of the constructions Fj in (51) involves at least a product YkYℓ.
Deﬁnition VII.5. A well-founded context-free speciﬁcation (51) is said to belong to
the irreducible context-free schema if it is nonlinear and its dependency graph is
strongly connected. It is said to be aperiodic if all the yj(z) are aperiodic9.
Theorem VII.5 (Irreducible context-free schema). A class C that belongs to the irre-
ducible context-free schema has a generating function that has a square-root singu-
larity at its radius of convergence ρ:
C(z) = τ −γ
r
1 −z
ρ + O

1 −z
ρ

,
for computable algebraic numbers ρ, τ, γ. If, in addition, C(z) is aperiodic, then the
dominant singularity is unique and the counting sequence satisﬁes
(54)
Cn ∼
γ
2
√
πn3 ρ−n.
This theorem is none other than a transcription, at the combinatorial level, of a
remarkable analytic statement, Theorem VII.6, due to Drmota, Lalley, and Woods,
which is proved below (p. 466), is slightly stronger, and is of independent interest.
Computability issues. There are two possible approaches to the calculation of the
quantities that appear in (54), one based on the original system (52), the other based
on the single equation (53) that results from elimination.
— System: From the proof of Theorem VII.6, it sufﬁces to solve in positive real
numbers the polynomial system of m + 1 equations in the m + 1 unknowns
ρ, τ1, . . . , τm,
(55)
τ1 = Φ1(ρ, τ1, . . . , τm), · · · , τm = Φm(ρ, τ1, . . . , τm),
J(ρ, τ1, . . . , τm) = 0,
where J is the Jacobian determinant (δi,j ≡[[i = j]] represents Kronecker’s
symbol):
(56)
J(z, y1, . . . , ym) := det

δi,j −∂
∂yj
Φi(z, y1, . . . , ym)

.
In that case, ρ is the common radius of convergence of all the yj(z) and
τj = yj(ρ). The constant γ ≡γ1 is a component solution of a linear system
of equations with coefﬁcients in the ﬁeld generated by ρ, τj, which can be
9In the usual sense that the span of the coefﬁcient sequence is equal to 1. For an irreducible system,
all the yj are aperiodic if and only if at least one of the yj is aperiodic.

462
VII. APPLICATIONS OF SINGULARITY ANALYSIS
obtained by the method of undetermined coefﬁcients, knowing that yj is of
the form
(57)
yj(z) ∼τj −γj
p
1 −z/ρ,
z →ρ.
— Equation: The general techniques are described in the next section, §VII. 7.
They give rise to the following algorithm: (i) determine the exceptional set
and isolate the dominant positive singularity; (ii) identify the coefﬁcients in
the singular (Puiseux) expansion, knowing a priori that the singularity is of
the square-root type.
Whatever the adopted strategy is, symbolic algebra system proves invaluable in per-
forming the required algebraic eliminations.
 VII.26. Catalan and Jacobi. For the Catalan GF, deﬁned by y = 1 + zy2, the system of
Equation (55) instantiates to
τ −1 −ρτ 2 = 0,
1 −2ρτ = 0,
giving back as expected: ρ = 1
4, τ = 2.

VII. 6.2. Combinatorial applications. Random walks on free groups [323], di-
rected walks in the plane [21, 320, 323] (see also p. 482 below), coloured trees [503],
and boolean expression trees [85] are only some of the many combinatorial structures
resorting to the irreducible context-free schema. Stanley presents in his book [449,
Ch. 6] several examples of algebraic GFs, and an inspiring survey is provided by
Bousquet-M´elou in [68]. We limit ourselves here to a brief discussion of non-crossing
conﬁgurations.
EXAMPLE VII.15. Non-crossing conﬁgurations.
Context-free descriptions can model natu-
rally very diverse sorts of objects including particular topological-geometric conﬁgurations—
we examine here non-crossing planar conﬁgurations. The problems considered have their origin
in combinatorial musings of the Rev. T.P. Kirkman in 1857 and were revisited in 1974 by Domb
and Barett [132] for the purpose of investigating certain perturbative expansions of statistical
physics. Our presentation follows closely the synthesis offered by Flajolet and Noy in [196].
Consider, for each value of n, graphs built on vertices that are at the n complex roots
of unity, numbered 0, . . . , n −1. A non-crossing graph is a graph such that no two of its
edges cross. One can also deﬁne connected non-crossing graphs, non-crossing forests (acyclic
graphs), and non-crossing trees (acyclic connected graphs); see Figure 13. Note that the various
graphs considered can always be considered as rooted in some canonical way (e.g., at the vertex
of smallest index) .
Trees. A non-crossing tree is rooted at 0. To the root vertex is attached an ordered collec-
tion of vertices, each of which has an end-node ν that is the common root of two non-crossing
trees, one on the left of the edge (0, ν) the other on the right of (0, ν). Let T denote the class
of trees and U denote the class of trees whose root has been severed. With o denoting a generic
node, we have
T = o × U,
U = SEQ(U × o × U),

VII. 6. IRREDUCIBLE CONTEXT-FREE STRUCTURES
463
(connected graph)
(tree)
(forest)
(graph)
Conﬁguration / OGF
Coefﬁcients (exact / asymptotic)
Trees (EIS: A001764)
z + z2 + 3z3 + 12z4 + 55z5 + · · ·
T 3 −zT + z2 = 0
1
2n −1
 
3n −3
n −1
!
∼
√
3
27
√
πn3 (27
4 )n
Forests (EIS: A054727)
1 + z + 2z2 + 7z3 + 33z4 + 181z5 · · ·
F 3 + (z2 −z −3)F 2 + (z + 3)F −1 = 0
n
X
j=1
1
2n −j
 
n
j −1
! 
3n −2j −1
n −j
!
∼0.07465
√
πn3 (8.22469)n
Connected graphs (EIS: A007297)
z + z2 + 4z3 + 23z4 + 156z5 + · · ·
C3 + C2 −3zC + 2z2 = 0
1
n −1
2n−3
X
j=n−1
 
3n −3
n + j
! 
j −1
j −n + 1
!
∼2
√
6 −3
√
2
18
√
πn3
“
6
√
3
”n
Graphs (EIS: A054726)
1 + z + 2z2 + 8z3 + 48z4 + 352z5 + · · ·
G2 + (2z2 −3z −2)G + 3z + 1 = 0
1
n
n−1
X
j=0
(−1)j
 
n
j
! 
2n −2 −j
n −1 −j
!
2n−1−j
∼
p
140 −99
√
2
4
√
πn3
“
6 + 4
√
2
”n
FIGURE VII.13. (Top) Non-crossing graphs: a tree, a forest, a connected graph, and
a general graph. (Bottom) The enumeration of non-crossing conﬁgurations by algebraic
functions.

464
VII. APPLICATIONS OF SINGULARITY ANALYSIS
which corresponds graphically to the “butterﬂy decomposition”:
U
U
U
U
U
U = 
T = 
The reduction to a pure context-free form is obtained by noticing that U = SEQ(V) is
equivalent to U = 1 + UV: a speciﬁcation and the associated polynomial system are then
(58) {T = ZU, U = 1 + UV, V = ZUU}
=⇒
{T = zU, U = 1 + UV, V = zU 2}.
This system relating U and V is irreducible (then, T is immediately obtained from U), and
aperiodicity is obvious from the ﬁrst few values of the coefﬁcients. The Jacobian of the U, V –
system, cf (56) (obtained by z →ρ, U →υ, V →ν), is
˛˛˛˛
1 −ν
υ
2ρυ
1
˛˛˛˛ = 1 −ν −2ρυ2.
Thus, the system (55) giving the singularity of U, V is
{υ = 1 + υν, ν = ρυ2, 1 −ν −2ρυ2 = 0},
whose positive solution is ρ =
4
27, υ =
3
2, ν =
1
3. The complete asymptotic formula is
displayed in Figure 13. (In a simple case like this, we have more: T satisﬁes T 3 −zT +z2 = 0,
which by Lagrange inversion gives Tn =
1
2n−1
`3n−3
n−1
´
.)
Forests. A (non-crossing) forest is a non-crossing graph that is acyclic. In the present con-
text, it is not possible to express forests simply as sequences of trees, because of the geometry
of the problem.
Starting conventionally from the root vertex 0 and following all connected edges deﬁnes a
“backbone” tree. To the left of every vertex of the tree, a forest may be placed. There results
the decomposition (expressed directly in terms of OGFs),
(59)
F = 1 + T[z 7→zF],
where T is the OGF of trees and F is the OGF of forests. In (59), the term T[z 7→zF] denotes
a functional composition. A context-free speciﬁcation in standard form results mechanically
from (58) upon replacing z by zF, namely
(60)
F = 1 + T, T = zFU, U = 1 + UV, V = zFU 2.
This system is irreducible and aperiodic, so that the asymptotic shape of Fn is of the form
γωnn−3/2, as predicted by Theorem VII.5. (The values of constants are worked out in Exam-
ple 17 by means of the equational approach.)
Graphs. Similar constructions (see [196]) give the OGFs of connected and general graphs,
as summarized in Figure 13. Note the common shape of the asymptotic estimates and also the
fact that binomial expressions are available in each case. . . . . . END OF EXAMPLE VII.15. □
VII. 6.3. Analysis of irreducible polynomial systems. The analytic engine be-
hind Theorem VII.5 is a fundamental result, the “Drmota-Lalley-Woods” (DLW) The-
orem, due to independent research by several authors: Drmota [135] developed a ver-
sion of the theorem in the course of studies relative to limit laws in various families
of trees deﬁned by context-free grammars; Woods [503], motivated by questions of

VII. 6. IRREDUCIBLE CONTEXT-FREE STRUCTURES
465
Boolean complexity and ﬁnite model theory, gave a form expressed in terms of colour-
ing rules for trees; ﬁnally, Lalley [323] came across a similarly general result when
quantifying return probabilities for random walks on groups. Drmota and Lalley show
how to pull out limit Gaussian laws for simple parameters (by a perturbative analysis;
see Chapter IX); Woods shows how to deduce estimates of coefﬁcients even in some
periodic or non-irreducible cases.
In the treatment that follows we start from a polynomial system of equations,
{yj = Φj(z, y1, . . . , ym)} ,
j = 1, . . . , m,
in accordance with the notations adopted at the beginning of the section. We only con-
sider nonlinear systems deﬁned by the fact that at least one polynomial Φj is nonlinear
in some of the indeterminates y1, . . . , ym.
First, for combinatorial reasons, we deﬁne several possible attributes of a polyno-
mial system.
— Algebraic positivity (or a-positivity). A polynomial system is said to be a-
positive if all the component polynomials Φj have nonnegative coefﬁcients.
Next, we want to restrict consideration to systems that determine a unique solution
vector (y1, . . . , ym) ∈(C[[z]])m. Deﬁne the z-valuation val(⃗y) of a vector ⃗y ∈C[[z]]m
as the minimum over all j’s of the individual valuations10 val(yj). The distance be-
tween two vectors is deﬁned as usual by d(⃗y, ⃗y′) = 2−val(⃗y−⃗y′). Then, one has:
— Algebraic properness (or a-properness). A polynomial system is said to be
a-proper if it satisﬁes a Lipschitz condition
d(Φ(⃗y), Φ(⃗y ′)) < Kd(⃗y, ⃗y ′)
for some K < 1.
In that case, the transformation Φ is a contraction on the complete metric space of
formal power series and, by the general ﬁxed point theorem, the equation ⃗y = Φ(⃗y)
admits a unique solution. In passing, this solution may be obtained by the iterative
scheme,
⃗y(0) = (0, . . . , 0)t,
⃗y(h+1) = Φ(y(h)),
⃗y = lim
h→∞⃗y(h).
The key notion is irreducibility. To a polynomial system, ⃗y = Φ(⃗y), associate its
dependency graph deﬁned as a graph whose vertices are the numbers 1, . . . , m and
the edges ending at a vertex j are k →j, if yj ﬁgures in a monomial of Φk(j). (This
notion is reminiscent of the one already introduced for linear system on page 329.)
— Algebraic irreducibility (or a-irreducibility). A polynomial system is said to
be a-irreducible if its dependency graph is strongly connected.
Finally, one needs a technical notion of periodicity to dispose of cases like
y(z) = 1
2z
 1 −
√
1 −4z

= z + z3 + 2z5 + · · · ,
(the OGF of complete binary trees) where coefﬁcients are only nonzero for certain
residue classes of their index.
10Let f = P∞
n=β fnzn with fβ ̸= 0; the valuation of f is by deﬁnition val(f) = β.

466
VII. APPLICATIONS OF SINGULARITY ANALYSIS
— Algebraic aperiodicity (or a-aperiodicity). A power series is said to be aperi-
odic if it contains three monomials (with nonzero coefﬁcients), ze1, ze2, ze3,
such that e2 −e1 and e3 −e1 are relatively prime. A proper polynomial sys-
tem is said to be aperiodic if each of its component solutions yj is aperiodic.
Theorem VII.6 (Irreducible positive polynomial systems, DLW Theorem). Consider
a nonlinear polynomial system ⃗y = Φ(⃗y) that is a-proper, a-positive, and a-irreducible.
In that case, all component solutions yj have the same radius of convergence ρ < ∞.
Then, there exist functions hj analytic at the origin such that, in a neighbourhood
of ρ:
(61)
yj = hj
p
1 −z/ρ

.
In addition, all other dominant singularities are of the form ρω with ω a root
of unity. If furthermore the system is a-aperiodic, all yj have ρ as unique dominant
singularity. In that case, the coefﬁcients admit a complete asymptotic expansion of the
form
(62)
[zn]yj(z) ∼ρ−n

X
k≥0
dkn−3/2−k

.
PROOF. The proof consists in gathering by stages consequences of the assumptions.
It is essentially based on a close examination of “failure” of the mutivariate implicit
function theorem and the way this leads to square-root singularities.
(a) As a preliminary observation, we note that each component solution yj is
an algebraic function that has a nonzero radius of convergence. (This can be checked
directly by the method of majorant series or as a consequence of a multivariate version
of the implicit function theorem.)
(b) Properness together with the positivity of the system implies that each yj(z)
has nonnegative coefﬁcients in its expansion at 0, since it is a formal limit of approx-
imants that have nonnegative coefﬁcients. In particular, each power series yj has a
certain nonzero radius of convergence ρj. Also, by positivity, ρj is a singularity of yj
(by virtue of Pringsheim’s theorem). From the known nature of singularities of al-
gebraic functions (e.g., the Newton-Puiseux Theorem, recalled p. 474 below), there
must exist some order R ≥0 such that each Rth derivative ∂R
z yj(z) becomes inﬁnite
as z →ρ−
j .
We establish now that ρ1 = · · · = ρm. In effect, differentiation of the equations
composing the system implies that a derivative of arbitrary order r, ∂r
zyj(z), is a
linear form in other derivatives ∂r
zyj(z) of the same order (and a polynomial form in
lower order derivatives); also the linear combination and the polynomial form have
nonnegative coefﬁcients. Assume a contrario that the radii were not all equal, say
ρ1 = · · · = ρs, with the other radii ρs+1, . . . being strictly greater. Consider the
system differentiated a sufﬁciently large number of times, R. Then, as z →ρ1, we
must have ∂R
z yj tending to inﬁnity for j ≤s. On the other hand, the quantities ys+1,
etc., being analytic, their Rth derivatives that are analytic as well must tend to ﬁnite
limits. In other words, because of the irreducibility assumption (and again positivity),

VII. 6. IRREDUCIBLE CONTEXT-FREE STRUCTURES
467
inﬁnity has to propagate and we have reached a contradiction. Thus: all the yj have
the same radius of convergence. We let ρ denote this common value.
(c1) The key step consists in establishing the existence of a square-root singularity
at the common singularity ρ. Consider ﬁrst the scalar case, that is
(63)
y −φ(z, y) = 0,
where φ is assumed to be a nonlinear polynomial in y and have nonnegative coefﬁ-
cients. This case resorts to the smooth implict function schema, whose argument we
brieﬂy revisit under our present perspective.
Let y(z) be the unique branch of the algebraic function that is analytic at 0. Com-
parison of the asymptotic orders in y inside the equality y = φ(z, y) shows that (by
nonlinearity) we cannot have y →∞when z tends to a ﬁnite limit. Let now ρ be the
radius of convergence of y(z). Since y(z) is necessarily ﬁnite at its singularity ρ, we
set τ = y(ρ) and note that, by continuity, τ −φ(ρ, τ) = 0.
By the implicit function theorem, a solution (z0, y0) of (63) can be continued
analytically as (z, y0(z)) in the vicinity of z0 as long as the derivative with respect
to y (a simpliﬁed Jacobian),
J(z0, y0) := 1 −φ′
y(z0, y0)
remains nonzero. The quantity ρ being a singularity, we must thus have J(ρ, τ) = 0.
On the other hand, the second derivative −φ′′
yy is nonzero at (ρ, τ) (by nonlinearity
and positivity). Then, the local expansion of the deﬁning equation (63) at (ρ, τ) binds
(z, y) locally by
−(z −ρ)φ′
z(ρ, τ) −1
2(y −τ)2φ′′
yy(ρ, τ) + · · · = 0,
implying the singular expansion
y −τ = −γ(1 −z/ρ)1/2 + · · · .
This establishes the ﬁrst part of the assertion in the scalar case.
(c2) In the multivariate case, we graft an ingenious argument [323] that is based
on a linearized version of the system to which Perron-Frobenius theory is applicable.
First, irreducibility implies that any component solution yj depends positively and
nonlinearly on itself (by possibly iterating Φ), so that a contradiction in asymptotic
comportments would result, if we suppose that any yj tends to inﬁnity. Each yj(z)
remains ﬁnite at the positive dominant singularity ρ.
Now, the multivariate version of the implicit function theorem grants us locally
the analytic continuation of any solution y1, y2, . . . , ym at z0 provided there is no
vanishing of the Jacobian determinant
J(z0, y1, . . . , ym) := det

δi,j −∂
∂yj
Φi(z0, y1, . . . , ym)

,
where δi,j is Kronecker’s symbol. Thus, we must have
(64)
J(ρ, τ1, . . . , τm) = 0
where
τj := yj(ρ).

468
VII. APPLICATIONS OF SINGULARITY ANALYSIS
The next argument (we follow Lalley [323]) uses Perron-Frobenius theory and
linear algebra. Consider the Jacobian matrix
K(z0, y1, . . . , ym) :=
 ∂
∂yj
Φi(z0, y1, . . . , ym)

,
which represents the “linear part” of Φ. For z, y1, . . . , ym all nonnegative, the matrix
K has positive entries (by positivity of Φ) so that it is amenable to Perron-Frobenius
theory. In particular it has a positive eigenvalue λ(z, y1, . . . , ym) that dominates all
the other in modulus. The quantity
bλ(z) = λ(y1(z), . . . , ym(z))
is increasing as it is an increasing function of the matrix entries that themselves in-
crease with z for z ≥0.
We propose to prove that bλ(ρ) = 1, In effect, bλ(ρ) < 1 is excluded since other-
wise (I−K) would be invertible at z = ρ and this would imply J ̸= 0, thereby contra-
dicting the singular character of the yj(z) at ρ. Assume a contrario bλ(ρ) > 1 in order
to exclude the other case. Then, by the increasing property, there would exists ρ1 < ρ
such that bλ(ρ1) = 1. Let v1 be a left eigenvector of K(ρ1, y1(ρ1), . . . , ym(ρ1)) cor-
responding to the eigenvalue bλ(ρ1). Perron-Frobenius theory guarantees that such a
vector v1 has all its coefﬁcients that are positive. Then, upon multiplying on the left
by v1 the column vectors corresponding to y and Φ(y) (which are equal), one gets an
identity; this derived identity upon expanding near ρ1 gives
(65)
A(z −ρ1) = −
X
i,j
Bi,j(yi(z) −yi(ρ1))(yj(z) −yj(ρ1)) + · · · ,
where · · · hides lower order terms and the coefﬁcients A, Bi,j are nonnegative with
A > 0. There is a contradiction in the orders of growth if each yi is assumed to be
analytic at ρ1 since the left side of (65) is of exact order (z −ρ1) while the right side
is at least as small as to (z −ρ1)2. Thus, we must have bλ(ρ) = 1 and bλ(x) < 1 for
x ∈(0, ρ).
A calculation similar to (65) but with ρ1 replaced by ρ shows ﬁnally that, if
yi(z) −yi(ρ) ∼γi(ρ −z)α,
then consistency of asymptotic expansions implies 2α = 1, that is α = 1
2. We have
thus proved: All the component solutions yj(z) have a square-root singularity at ρ.
(The existence of a complete expansion in powers of (ρ −z)1/2 results from a reﬁne-
ment of this argument.) The proof of the general case (61) is thus complete.
(d) In the aperiodic case, we ﬁrst observe that each yj(z) cannot assume an
inﬁnite value on its circle of convergence |z| = ρ, since this would contradict the
boundedness of |yj(z)| in the open disk |z| < ρ (where yj(ρ) serves as an upper-
bound). Consequently, by singularity analysis, the Taylor coefﬁcients of any yj(z) are
O(n−1−η) for some η > 1 and the series representing yj at the origin converges on
|z| = ρ.
For the rest of the argument, we observe that if ⃗y = Φ(z, ⃗y), then ⃗y = Φ⟨m⟩(z, ⃗y)
where the superscript denotes iteration of the transformation Φ in the variables ⃗y =

VII. 7. THE GENERAL ANALYSIS OF ALGEBRAIC FUNCTIONS
469
(y1, . . . , ym). By irreducibility, Φ⟨m⟩is such that each of its component polynomials
involves all the variables.
Assume that there would exists a singularity ρ∗of some yj(z) on |z| = ρ. The
triangle inequality yields |yj(ρ∗)| < yj(ρ) where strictness is related to the general
aperiodicity argument encountered at several other places in this book. But then, the
modiﬁed Jacobian matrix K⟨m⟩of Φ⟨m⟩taken at the yj(ρ∗) has entries dominated
strictly by the entries of K⟨m⟩taken at the yj(ρ). There results that the dominant
eigenvalue of K⟨m⟩(z, ⃗yj(ρ∗)) must be strictly less than 1. But this would imply that
I −K⟨m⟩(z, ⃗yj(ρ∗)) is intervertible so that the yj(z) would be analytic at ρ∗. A
contradiction has been reached: ρ is the sole dominant singularity of each yj and this
concludes the argument.
□
Many extensions of the DLW Theorem are possible, as indicated by the notes and
references below—the underlying arguments are powerful, versatile, and highly gen-
eral. Consequences regarding limit distributions, as obtained by Drmota and Lalley,
are further explored in Chapter IX.
 VII.27. Analytic systems. Drmota [135] has shown that the conclusions of the DLW Theo-
rem regarding universality of the square-root singularity holds more generally for Φj that are
analytic functions of Cm+1 to C, provided there exists a positive solution of the characteristic
system within the domain of analyticity of the Φj. This extension then uniﬁes the DLW theorem
and Theorem VII.3 relative to the smooth implicit function schema.

 VII.28. P´olya systems. Woods [503] has shown that P´olya operators of the form MSETk
can also be treated by an extension of the DLW Theorem, which then uniﬁes this theorem and
Theorem VII.4.

 VII.29. Inﬁnite systems. Lalley [325] has extended the conclusions of the DLW Theorem to
certain inﬁnite systems of generating function equations. This makes it possible to quantify the
return probabilities of certain random walks on inﬁnite free products of ﬁnite groups.

The square-root singularity property ceases to be universal when the assumptions
of Theorems VII.5 and VII.6, namely, positivity and irreducibility, fail to be satisﬁed.
For instance, supertrees that are speciﬁed by a positive but reducible system have a
singularity of the fourth-root type (Example 10, p. 394 and Example 18, p. 479). We
discuss in the next section, §VII. 7, general methods that apply to any algebraic func-
tion and are based on the minimal polynomial equation (rather than system) satisﬁed
by the function. Note that the results there do not always subsume the present ones,
since structure is not preserved when a system is reduced, by elimination, to a single
equation. (It would be desirable to determine directly from the system itself the type
of singular behaviour of the solution, but the systematic research involved in such a
programme has not been yet been carried out.)
VII. 7. The general analysis of algebraic functions
Algebraic series and algebraic functions are simply deﬁned as solutions of a poly-
nomial equation or system. Their singularities are strongly constrained to be branch
points, with the local expansion at a singularity being a fractional power series known
as a Newton-Puiseux expansion; see Subsection VII. 7.1. Singularity analysis then
appears to be systematically applicable to algebraic functions, to the effect that their

470
VII. APPLICATIONS OF SINGULARITY ANALYSIS
coefﬁcients are asymptotically composed of elements of the form
(66)
C · ωnnp/q,
p
q ∈Q \ {−1, −2, . . .},
cf Subsection VII. 7.2. This last form includes as a special case the exponent p
q = −3
2,
that was encountered repeatedly, when dealing with inverse functions, implicit func-
tions, and irreducible systems. In this section, we develop the basic structural results
that lead to the asymptotic forms (66). Coming up however with effective solutions
(i.e., decision procedures) is not obvious in the algebraic case, and a number of al-
gorithms are described in order to locate and analyse singularities (Newton’s polygon
method). In particular, the multivalued character of algebraic functions creates a need
to solve connection problems.
Basics. We adopt as the starting point of the present discussion the following
deﬁnition of an algebraic function or series (see also Note 30 for a variant).
Deﬁnition VII.6. A function f(z) analytic in a neighbourhod V of a point z0 is said
to be algebraic if there exists a (nonzero) polynomial P(z, y) ∈C[z, y], such that
(67)
P(z, f(z)) = 0,
z ∈V.
A power series f ∈C[[z]] is said to be an algebraic power series if it coincides with
the expansion of an algebraic function at 0.
The degree of an algebraic series or function f is by deﬁnition the minimal value
of degy P(z, y) over all polynomials that are cancelled by f (so that rational series
are algebraic of degree 1). One can always assume P to be irreducible over C (that is
P = QR implies that one of Q or R is a scalar) and of minimal degree.
An algebraic function may also be deﬁned by starting with a polynomial system
of the form
(68)





P1(z, y1, . . . , ym)
=
0
...
...
...
Pm(z, y1, . . . , ym)
=
0,
where each Pj is a polynomial. A solution of the system (68) is by deﬁnition an m-
tuple (f1, . . . , fm) that cancels each Pj, that is, Pj(z, f1, . . . , fm) = 0. Any of the
fj is called a component solution. A basic but nontrivial result of elimination theory
is that any component solution of a nondegenerate polynomial system is an algebraic
series (APPENDIX B: Algebraic elimination, p. 685). In other words, one can elimi-
nate the auxiliary variables y2, . . . , ym and construct a single bivariate polynomial Q
such that Q(z, y1) = 0.
We stress the point that, in the deﬁnitions by equation (67) or system (68), no
positivity of any sort nor irreducibility is assumed. The foregoing treatment applies to
any algebraic function, whether or not it comes from combinatorics.
 VII.30. Algebraic deﬁnition of algebraic series. It is also customary to deﬁne f to be an
algebraic series if it satisﬁes P(z, f) = 0 in the sense of formal power series, without a priori
consideration of convergence issues. Then the technique of majorant series may be used to
prove that the coefﬁcients of f grow at most exponentially. Thus, the alternative deﬁnition is
indeed equivalent to Deﬁnition VII.6.


VII. 7. THE GENERAL ANALYSIS OF ALGEBRAIC FUNCTIONS
471
 VII.31. “Alg is in Diag of Rat”. Every algebraic function F(z) over C(z) is the diagonal of
a rational function G(x, y) = A(x, y)/B(x, y) ∈C(x, y). Precisely:
F(z) =
X
n≥0
Gn,nzn,
where
G(x, y) =
X
m,n≥0
Gm,nxmyn.
This is granted by a theorem of Denef and Lipshitz [120], which is related to the holonomic
framework (APPENDIX B: Holonomic functions, p. 693).

 VII.32. Multinomial sums and algebraic coefﬁcients. Let F(z) be an algebraic function.
Then Fn = [zn]F(z) is a (ﬁnite) linear combination of “multinomial forms” deﬁned as
Sn(C; h; c1, . . . , cr) :=
X
C
 
n0 + h
n1, . . . , nr
!
cn1
1 · · · cnr
r ,
where the summation is over all values of n0, n1, . . . , nr satisfying a collection of linear in-
equalities C involving n. [Hint: a consequence of Denef–Lipshitz.]

VII. 7.1. Singularities of general algebraic functions. Let P(z, y) be an irre-
ducible polynomial of C[z, y],
P(z, y) = p0(z)yd + p1(z)yd−1 + · · · + pd(z).
The solutions of the polynomial equation P(z, y) = 0 deﬁne a locus of points (z, y)
in C × C that is known as a complex algebraic curve. Let d be the y-degree of P.
Then, for each z there are at most d possible values of y. In fact, there exist d values
of y “almost always”, that is except for a ﬁnite number of cases:
— If z0 is such that p0(z0) = 0, then there is a reduction in the degree in y and
hence a reduction in the number of ﬁnite y-solutions for the particular value
of z = z0. One can conveniently regard the points that disappear as “points
at inﬁnity” (formally, one then operates in the projective plane).
— If z0 is such that P(z0, y) has a multiple root, then some of the values of y
will coalesce.
Deﬁne the exceptional set of P as the set (R is the resultant of APPENDIX B: Alge-
braic elimination, p. 685):
(69)
Ξ[P] := {z
 R(z) = 0}, R(z) := R(P(z, y), ∂yP(z, y), y).
The quantity R(z) is also known as the discriminant of P(z, y), with z taken as a
parameter. If z ̸∈Ξ[P], then we have a guarantee that there exist d distinct solutions
to P(z, y) = 0, since p0(z) ̸= 0 and ∂yP(z, y) ̸= 0. Then, by the Implicit Function
Theorem, each of the solutions yj lifts into a locally analytic function yj(z). A branch
of the algebraic curve P(z, y) = 0 is the choice of such a yj(z) together with a
simply connected region of the complex plane throughout which this particular yj(z)
is analytic.
Singularities of an algebraic function can thus only occur if z lies in the excep-
tional set Ξ[P]. At a point z0 such that p0(z0) = 0, some of the branches escape to
inﬁnity, thereby ceasing to be analytic. At a point z0 where the resultant polynomial
R(z) vanishes but p0(z) ̸= 0, then two or more branches collide. This can be either
a multiple point (two or more branches happen to assume the same value, but each
one exists as an analytic function around z0) or a branch point (some of the branches
actually cease to be analytic). An example of an exceptional point that is not a branch

472
VII. APPLICATIONS OF SINGULARITY ANALYSIS
1
0
-1
FIGURE VII.14. The real section of the lemniscate of Bernoulli deﬁned by P(z, y) =
(z2 + y2)2 −(z2 −y2) = 0: the origin is a double point where two analytic branches
meet.
point is provided by the classical lemniscate of Bernoulli: at the origin, two branches
meet while each one is analytic there (see Figure 14).
A partial knowledge of the topology of a complex algebraic curve may be gotten
by ﬁrst looking at its restriction to the reals. Consider for instance the polynomial
equation P(z, y) = 0, where
P(z, y) = y −1 −zy2,
which deﬁnes the OGF of the Catalan numbers. A rendering of the real part of the
curve is given in Figure 15. The complex aspect of the curve as given by ℑ(y) as a
function of z is also displayed there. In accordance with earlier observations, there are
normally two sheets (branches) above each point. The exceptional set is given by the
roots of the discriminant,
R = z(1 −4z),
that is, z = 0, 1
4. For z = 0, one of the branches escapes at inﬁnity, while for z = 1/4,
the two branches meet and there is a branch point; see Figure 15.
In summary the exceptional set provides a set of possible candidates for the sin-
gularities of an algebraic function.
Lemma VII.4 (Location of algebraic singularities). Let y(z), analytic at the origin,
satisfy a polynomial equation P(z, y) = 0. Then, y(z) can be analytically continued
along any simple path emanating from the origin that does not cross any point of the
exceptional set deﬁned in (69).
PROOF. At any z0 that is not exceptional and for a y0 satisfying P(z0, y0) = 0,
the fact that the discriminant is nonzero implies that P(z0, y) has only a simple root
at y0. Consequently, we have Py(z0, y0) ̸= 0. By the Implicit Function Theorem, the
algebraic function y(z) is analytic in a neighbourhood of z0.
□
Nature of singularities. We start the discussion with an exceptional point that
is placed at the origin (by a translation z 7→z + z0) and assume that the equation
P(0, y) = 0 has k equal roots y1, . . . , yk where y = 0 is this common value (by a
translation y 7→y + y1 or an inversion y 7→1/y, if points at inﬁnity are consid-
ered). Consider a punctured disk |z| < r that does not include any other exceptional

VII. 7. THE GENERAL ANALYSIS OF ALGEBRAIC FUNCTIONS
473
–10
–8
–6
–4
–2
0
2
4
6
8
10
y
–1
–0.8
–0.6
–0.4
–0.2
0.2
z
–1
0
1
Re(z)
–1
–0.8
–0.6
–0.4
–0.2
0
0.2
0.4
0.6
0.8
1
Im(z)
–2
0
2
4
y
0.15
0.2
0.25
0.3
0.35
Re(z)
–0.1
–0.05
0
0.05
0.1
Im(z)
–3
–2
–1
0
1
2
3
y
FIGURE VII.15. The real section of the Catalan curve (top). The complex Catalan curve
with a plot of ℑ(y) as a function of z = (ℜ(z), ℑ(z)) (bottom left); a blowup of ℑ(y)
near the branch point at z = 1
4 (bottom right).
point relative to P. In the argument that follows, we let y1, (z), . . . , yk(z) be analytic
determinations of the root that tend to 0 as z →0.
Start at some arbitrary value interior to the real interval (0, r), where the quantity
y1(z) is locally an analytic function of z. By the implicit function theorem, y1(z) can
be continued analytically along a circuit that starts from z and returns to z while simply
encircling the origin (and staying within the punctured disk). Then, by permanence of
analytic relations, y1(z) will be taken into another root, say, y(1)
1 (z). By repeating the
process, we see that after a certain number of times κ with 1 ≤κ ≤k, we will have
obtained a collection of roots y1(z) = y(0)
1 (z), . . . , y(κ)
1 (z) = y1(z) that form a set of
κ distinct values. Such roots are said to form a cycle. In this case, y1(tκ) is an analytic
function of t except possibly at 0 where it is continuous and has value 0. Thus, by
general principles (regarding removable singularities), it is in fact analytic at 0. This
in turn implies the existence of a convergent expansion near 0:
(70)
y1(tκ) =
∞
X
n=1
cntn.
(The parameter t is known as the local uniformizing parameter, as it reduces a multi-
valued function to a single value one.) This translates back into the world of z: each

474
VII. APPLICATIONS OF SINGULARITY ANALYSIS
determination of z1/κ yields one of the branches of the multivalued analytic function
as
(71)
y1(z) =
∞
X
n=1
cnzn/κ.
Alternatively, with ω = e2iπ/κ a root of unity, the κ determinations are obtained as
y(j)
1 (z) =
∞
X
n=1
cnωnzn/κ,
each being valid in a sector of opening < 2π. (The case κ = 1 corresponds to an
analytic branch.)
If r = k, then the cycle accounts for all the roots which tend to 0. Otherwise,
we repeat the process with another root and, in this fashion, eventually exhaust all
roots. Thus, all the k roots that have value 0 at z = 0 are grouped into cycles of size
κ1, . . . , κℓ. Finally, values of y at inﬁnity are brought to zero by means of the change
of variables y = 1/u, then leading to negative exponents in the expansion of y.
Theorem VII.7 (Newton–Puiseux expansions at a singularity). Let f(z) be a branch
of an algebraic function P(z, f(z)) = 0. In a circular neighbourhood of a singu-
larity ζ slit along a ray emanating from ζ, f(z) admits a fractional series expansion
(Puiseux expansion) that is locally convergent and of the form
f(z) =
X
k≥k0
ck(z −ζ)k/κ,
for a ﬁxed determination of (z −ζ)1/κ, where k0 ∈Z and κ is an integer ≥2, called
the “branching type”.
Newton (1643-1727) discovered the algebraic form of Theorem VII.7, published
it in his famous treatise De Methodis Serierum et Fluxionum (completed in 1671). This
method was subsequently developed by Victor Puiseux (1820–1883) so that the name
of Puiseux series is customarily attached to fractional series expansions. The argument
given above is taken from the neat exposition offered by Hille in [269, Ch. 12, vol. II].
It is known as a “monodromy argument”, meaning that it consists in following the
course of values of an analytic function along paths in the complex plane till it returns
to its original value.
Newton polygon. Newton also described a constructive approach to the deter-
mination of branching types near a point (z0, y0), that by means of the previous dis-
cussion can always be taken to be (0, 0). In order to introduce the discussion, let us
examine the Catalan generating function near z0 = 1/4. Elementary algebra gives the
explicit form of the two branches
y1(z) = 1
2z
 1 −
√
1 −4z

,
y2(z) = 1
2z
 1 +
√
1 −4z

,
whose forms are consistent with what Theorem VII.7 predicts. If however one starts
directly with the equation,
P(z, y) ≡y −1 −zy2 = 0

VII. 7. THE GENERAL ANALYSIS OF ALGEBRAIC FUNCTIONS
475
then, the translation z = 1/4 −Z (the minus sign is a mere notational convenience),
y = 2 + Y yields
(72)
Q(Z, Y ) ≡−1
4Y 2 + 4Z + 4ZY + ZY 2.
Look for solutions of the form Y = cZα(1+o(1)) with c ̸= 0, whose existence is a pri-
ori granted by the Newton-Puiseux Theorem. Each of the monomials in (72) gives rise
to a term of a well determined asymptotic order, respectively Z2α, Z1, Zα+1, Z2α+1.
If the equation is to be identically satisﬁed, then the main asymptotic order of Q(Z, Y )
should be 0. Since c ̸= 0, this can only happen if two or more of the exponents in
the sequence (2α, 1, α + 1, 2α + 1) coincide and the coefﬁcients of the correspond-
ing monomial in P(Z, Y ) is zero, a condition that is an algebraic constraint on the
constant c. Furthermore, exponents of all the remaining monomials have to be larger
since by assumption they represent terms of lower asymptotic order.
Examination of all the possible combinations of exponents leads one to discover
that the only possible combination arises from the cancellation of the ﬁrst two terms
of Q, namely −1
4Y 2 + 4Z, which corresponds to the set of constraints
2α = 1,
−1
4c2 + 4 = 0,
with the supplementary conditions α + 1 > 1 and 2α + 1 > 1 being satisﬁed by this
choice α = 1
2. We have thus discovered that Q(Z, Y ) = 0 is consistent asymptotically
with
Y ∼4Z1/2,
Y ∼−4Z1/2.
The process can be iterated upon subtracting dominant terms. It invariably gives
rise to complete formal asymptotic expansions that satisfy Q(Z, Y ) = 0 (in the Cata-
lan example, these are series in ±Z1/2). Furthermore, elementary majorizations estab-
lish that such formal asymptotic solutions represent indeed convergent series. Thus,
local expansions of branches have indeed been determined.
An algorithmic reﬁnement (also due to Newton) can be superimposed on the pre-
vious discussion and is known as the method of Newton polygons. Consider a general
polynomial
Q(Z, Y ) =
X
j∈J
ZajY bj,
and associate to it the ﬁnite set of points (aj, bj) in N×N, which is called the Newton
diagram. It is easily veriﬁed that the only asymptotic solutions of the form Y ∝Zτ
correspond to values of τ that are inverse slopes (i.e., ∆x/∆y) of lines connecting
two or more points of the Newton diagram (this expresses the cancellation condition
between two monomials of Q) and such that all other points of the diagram are on this
line or to the right of it. In other words:
Newton’s polygon method. Any possible exponent τ such that Y ∼cZτ is
a solution to a polynomial equation corresponds to one of the inverse slopes
of the leftmost convex envelope of the Newton diagram. For each viable τ,
a polynomial equation constrains the possible values of the corresponding
coefﬁcient c. Complete expansions are obtained by repeating the process,

476
VII. APPLICATIONS OF SINGULARITY ANALYSIS
–0.4
–0.2
0
0.2
0.4
y
–0.4
–0.2
0.2
0.4
x
 
 
 
 
  

 
 
               














 
5
                  





                                                      





                     


0
1
2
3
4
5
6
1
2
3
4
FIGURE VII.16. The real algebraic curve deﬁned by the equation P = (y −x2)(y2 −
x)(y2 −x3) −x3y3 near (0, 0) (left) and the corresponding Newton diagram (right).
which means deﬂating Y from its main term by way of the substitution Y 7→
Y −cZτ.
Figure 16 illustrates what goes on in the case of the curve P = 0 where
P(z, y)
=
(y −z2)(y2 −z)(y2 −z3) −z3y3
=
y5 −y3z −y4z2 + y2z3 −2 z3y3 + z4y + z5y2 −z6,
considered near the origin. As the partly factored form suggests, we expect the curve
to resemble the union of two orthogonal parabolas and of a curve y = ±z3/2 having a
cusp, i.e., the union of
y = z2,
y = ±√z,
y = ±z3/2,
respectively. It is visible on the Newton diagram of the expanded form that the possible
exponents y ∝zτ at the origin are the inverse slopes of the segments composing the
envelope, that is,
τ = 2,
τ = 1
2,
τ = 3
2.
For computational purposes, once determined the branching type κ, the value of
k0 that dictates where the expansion starts, and the ﬁrst coefﬁcient, the full expansion
can be recovered by deﬂating the function from its ﬁrst term and repeating the New-
ton diagram construction. In fact, after a few initial stages of iteration, the method
of indeterminate coefﬁcients can always be eventually applied11. Computer algebra
systems usually have this routine included as one of the standard packages; see [427].
11Bruno Salvy, private communication, August 2000

VII. 7. THE GENERAL ANALYSIS OF ALGEBRAIC FUNCTIONS
477
VII. 7.2. Asymptotic form of coefﬁcients. The Newton–Puiseux theorem de-
scribes precisely the local singular structure of an algebraic function. The expansions
are valid around a singularity and, in particular, they hold in indented disks of the type
required in order to apply the formal translation mechanisms of singularity analysis
(Chapter VI).
Theorem VII.8 (Algebraic asymptotics). Let f(z) = P
n fnzn be an algebraic se-
ries. Assume that the branch deﬁned by the series at the origin has a unique dominant
singularity at z = α1 on its circle of convergence. Then, the coefﬁcient fn satisﬁes
the asymptotic expansion,
(73)
fn ∼α−n
1

X
k≥k0
dkn−1−k/κ

,
where k0 ∈Z and κ is an integer ≥2.
If f(z) has several dominant singularities |α1| = |α2| = · · · = |αr|, then there
exists an asymptotic decomposition (where ǫ is some small ﬁxed number, ǫ > 0)
(74)
fn =
r
X
j=1
φ(j)(n) + O((|α1| + ǫ))−n,
where each φ(j)(n) admits a complete asymptotic expansion,
φ(j)(n) ∼α−n
j



X
k≥k(j)
0
d(j)
k n−1−k/κj


,
with k(j)
0
in Z, and κj an integer ≥2.
PROOF. An early version of this theorem apppears as [174, Th. D, p. 293]. The
expansions granted by Theorem VII.7 are of the exact type required by singularity
analysis (Theorem VI.4, p. 376). For multiple singularities, Theorem VI.5 (p. 381)
based on composite contours is to be used: in that case each φ(j)(n) is the contribution
obtained by transfer of the corresponding local singular element.
□
In the case of multiple singularities, partial cancellations may occur in some of
the dominant terms of (74): consider for instance the case of
1
q
1 −6
5z + z2
= 1 + 0.60z + 0.04z2 −0.36z3 −0.408z4 −· · · ,
where the function has two complex conjugate singularities with an argument not
commensurate to π, and refer to the corresponding discussion of rational coefﬁcients
asymptotics (Subsection IV. 6.1, p. 250). Fortunately, such delicate arithmetic situa-
tions tend not to arise in combinatorial situations.
EXAMPLE VII.16.
Branches of unary-binary trees. the generating function of unary binary
trees is deﬁned by P(z, f(z)) = 0 where
P(z, y) = y −z −zy −zy2,

478
VII. APPLICATIONS OF SINGULARITY ANALYSIS
0.5
0.6
0.7
0.8
0.9
1
1.1
1.2
y
–0.4
–0.2
0
0.2
z
FIGURE VII.17. The real algebraic curve corresponding to non-crossing forests.
so that
f(z) = 1 −z −
√
1 −2z −3z2
2z
= 1 −z −
p
(1 + z)(1 −3z)
2z
.
There exist only two branches: f and its conjugate ¯f that form a 2–cycle at z =
1
3. The
singularities of all branches are at 0, −1, 1
3 as is apparent from the explicit form of f or from
the deﬁning equation. The branch representing f(z) at the origin is analytic there (by a general
argument or by the combinatorial origin of the problem). Thus, the dominant singularity of f(z)
is at 1
3 and it is unique in its modulus class. The “easy” case of Theorem VII.6 then applies
once f(z) has been expanded near 1
3. As a rule, the organization of computations is simpler if
one makes use of the local uniformizing parameter with a choice of sign in accordance to the
direction along which the singularity is approached. In this case, we set z = 1
3 −δ2 and ﬁnd
f(z) = 1 −3 δ + 9
2δ2 −63
8 δ3 + 27
2 δ4 −2997
128 δ5 + · · · ,
δ = (1
3 −z)1/2.
This translates immediately into
fn ≡[zn]f(z) ∼3n+1/2
2
√
πn3
„
1 −15
16n +
505
512n2 −
8085
8192n3 + · · ·
«
.
The approximation provided by the ﬁrst three terms is quite good: for n = 10 already, it
estimates f10 = 835. with an error less than 1. . . . . . . . . . . . . . . END OF EXAMPLE VII.16. □
EXAMPLE VII.17. Branches of non-crossing forests. Consider the polynomial equation P(z, y) =
0, where
P(z, y) = y3 + (z2 −z −3)y2 + (z + 3)y −1,
and the combinatorial GF satisfying P(z, F) = 0 determined by the initial conditions,
F(z) = 1 + 2z + 7z2 + 33z3 + 181z4 + 1083z5 + · · · .
(EIS A054727). F(z) is the OGF of non-crossing forests deﬁned in Example 15, p. 462.
The exceptional set is mechanically computed: its elements are roots of the discriminant
R = −z3(5z3 −8z2 −32z + 4).

VII. 7. THE GENERAL ANALYSIS OF ALGEBRAIC FUNCTIONS
479
Newton’s algorithm shows that two of the branches at 0, say y0 and y2, form a cycle of length 2
with y0 = 1 −√z + O(z), y2 = 1 + √z + O(z) while it is the “middle branch” y1 =
1 + z + O(z2) that corresponds to the combinatorial GF F(z).
The nonzero exceptional points are the roots of the cubic factor of R, namely
Ω= {−1.93028, 0.12158, 3.40869}.
Let ξ
.= 0.1258 be the root in (0, 1). By Pringsheim’s theorem and the fact that the OGF
of an inﬁnite combinatorial class must have a positive dominant singularity in [0, 1], the only
possibility for the dominant singularity of y1(z) is ξ. (For a more general argument, see below.)
For z near ξ, the three branches of the cubic give rise to one branch that is analytic with
value approximately 0.67816 and a cycle of two conjugate branches with value near 1.21429
at z = ξ. The expansion of the two conjugate branches is of the singular type,
α ± β
p
1 −z/ξ,
where
α = 43
37 + 18
37ξ −35
74ξ2 .= 1.21429,
β = 1
37
p
228 −981ξ −5290ξ2 .= 0.14931.
The determination with a minus sign must be adopted for representing the combinatorial GF
when z →ξ−since otherwise one would get negative asymptotic estimates for the nonnegative
coefﬁcients. Alternatively, one may examine the way the three real branches along (0, ξ) match
with one another at 0 and at ξ−, then conclude accordingly.
Collecting partial results, we ﬁnally get by singularity analysis the estimate
Fn =
β
2
√
πn3 ωn
„
1 + O( 1
n)
«
,
ω = 1
ξ
.= 8.22469
with the cubic algebraic number ξ and the sextic β as above. . END OF EXAMPLE VII.17. □
The example above illustrates several important points in the analysis of coefﬁ-
cients of algebraic functions when there are no simple explicit radical forms. First of
all a given combinatorial problem determines a unique branch of an algebraic curve
at the origin. Next, the dominant singularity has to be identiﬁed by “connecting” the
combinatorial branch with the branches at every possible singularity of the curve. Fi-
nally, computations tend to take place over algebraic numbers and not simply rational
numbers.
So far, examples have illustrated the common situation where the exponent at the
dominant singularity is 1
2, which is reﬂected by a factor of n−3/2 in the asymptotic
form of coefﬁcients. Our last example shows a case where the exponent assumes a
different value, namely 1
4.
EXAMPLE VII.18. Branches of “supertrees”. Consider the quartic equation
y4 −2 y3 + (1 + 2 z) y2 −2 yz + 4 z3 = 0
and let K be the branch analytic at 0 determined by the initial conditions:
K(z) = 2 z2 + 2 z3 + 8 z4 + 18 z5 + +64 z6 + 188 z7 + · · · .
The OGF K corresponds to bicoloured “supertrees” of Example VI.10, p. 394.
The discriminant is found to be
R = 16 z4 `
16 z2 + 4 z −1
´
(−1 + 4 z)3 ,

480
VII. APPLICATIONS OF SINGULARITY ANALYSIS
–1
–0.5
0.5
1
1.5
2
k
–0.6
–0.4
–0.2
0.2
z
FIGURE VII.18. The real algebraic curve associated to the generating function of su-
pertrees of type K.
with roots at 1
4 and (−1 ±
√
5)/8. The dominant singularity of the branch of combinatorial
interest turns out to be at z = 1
4 where K( 1
4) = 1
2. The translation z = 1
4 + Z, y = 1
2 + Y
then transforms the basic equation into
4 Y 4 + 8 ZY 2 + 16 Z3 + 12 Z2 + Z = 0.
According to Newton’s polygon, the main cancellation arises from 4Y 4 + Z = 0: this cor-
responds to a segment of inverse slope 1/4 in the Newton diagram and accordingly to a cycle
formed with 4 conjugate branches, i.e., a fourth-root singularity. Thus, one has,
K(z) ∼
z→1
4
1/2−1
√
2
„1
4 −z
«1/4
−1
√
2
„1
4 −z
«3/4
+· · · ,
[zn]K(z)
∼
n→∞
4n
8Γ( 3
4)n5/4 ,
which is consistent with earlier found values (p. 394). . . . . . . . . END OF EXAMPLE VII.18. □
Computable coefﬁcient asymptotics. The previous discussion contains the germ
of a complete algorithm for deriving an asymptotic expansion of coefﬁcients of any
algebraic function. We sketch here the main principles leaving some of the details to
the reader. Observe that the problem is a connection problem: the “shapes” of the
various sheets around each point (including the exceptional points) are known, but
it remains to connect them together and see which ones are encountered ﬁrst when
starting from a given branch at the origin.
Algorithm ACA: Algebraic Coefﬁcient Asymptotics.
Input: A polynomial P(z, y) with d = degy P(z, y); a series Y (z) such that
P(z, Y ) = 0 and assumed to be speciﬁed by sufﬁciently many initial terms so as to
be distinguished from all other branches.
Output: The asymptotic expansion of [zn]Y (z) whose existence is granted by The-
orem VII.8.
The algorithm consists of three main steps: Preparation, Dominant singularities,
and Translation.

VII. 7. THE GENERAL ANALYSIS OF ALGEBRAIC FUNCTIONS
481
I. Preparation: Deﬁne the discriminant R(z) = R(P, P ′
y, y).
(P1) Compute the exceptional set Ξ = {z
˛˛ R(z) = 0} and the points of inﬁnity Ξ0 =
{z
˛˛ p0(z) = 0}, where p0(z) is the leading coefﬁcient of P(z, y) considered as a
function of y.
(P2) Determine the Puiseux expansions of all the d branches at each of the points of
Ξ ∪{0} (by Newton diagrams and/or indeterminate coefﬁcients). This includes the
expansion of analytic branches as well. Let {yα,j(z)}d
j=1 be the collection of all
such expansions at some α ∈Ξ ∪{0}.
(P3) Identify the branch at 0 that corresponds to Y (z).
II. Dominant singularities (Controlled approximate matching of branches). Let Ξ1, Ξ2, . . .
be a partition of the elements of Ξ ∪{0} sorted according to the increasing values of their
modulus: it is assumed that the numbering is such that if α ∈Ξi and β ∈Ξj, then |α| < |β| is
equivalent to i < j. Geometrically, the elements of Ξ have been grouped in concentric circles.
First, a preparation step is needed.
(D1) Determine a nonzero lower bound δ on the radius of convergence of any local Puiseux
expansion of any branch at any point of Ξ. Such a bound can be constructed from
the minimal distance between elements of Ξ and from the degree d of the equation.
The sets Ξj are to be examined in sequence until it is detected that one of them contains a sin-
gularity. At step j, let σ1, σ2, . . . , σs be an arbitrary listing of the elements of Ξj. The problem
is to determine whether any σk is a singularity and, in that event, to ﬁnd the right branch to
which it is associated. This part of the algorithm proceeds by controlled numerical approxima-
tions of branches and constructive bounds on the minimum separation distance between distinct
branches.
(D2) For each candidate singularity σk, with k ≥2, set ζk = σk(1 −δ/2). By assump-
tion, each ζk is in the domain of convergence of Y (z) and of any yσk,j.
(D3) Compute a nonzero lower bound ηk on the minimum distance between two roots of
P(ζk, y) = 0. This separation bound can be obtained from resultant computations.
(D4) Estimate Y (ζk) and each yσk,j(ζk) to an accuracy better than ηk/4. If two elements,
Y (z) and yσk,j(z) are (numerically) found to be at a distance less than ηk for z =
ζk, then they are matched: σk is a singularity and the corresponding yσk,j is the
corresponding singular element. Otherwise, σk is declared to be a regular point for
Y (z) and discarded as candidate singularity.
The main loop on j is repeated until a singularity has been detected, when j = j0, say. The
radius of convergence ρ is then equal to the common modulus of elements of Ξj0; the corre-
sponding singular elements are retained.
III. Coefﬁcient expansion. Collect the singular elements at all the points σ determined to
be a dominant singularity at Phase II. Translate termwise using the singularity analysis rule,
(σ −z)p/κ 7→σp/κ−n
Γ(−p/κ + n)
Γ(−p/κ)Γ(n + 1),
and reorganize into descending powers of n, if needed.
This algorithm vindicates the following assertion:
Proposition VII.5 (Decidability of algebraic connections.). The dominant singulari-
ties of a branch of an algebraic function can be determined by the algorithm ACA in
a ﬁnite number of operations.

482
VII. APPLICATIONS OF SINGULARITY ANALYSIS
VII. 8. Combinatorial applications of algebraic functions
The next two subsections introduce objects whose construction leads to algebraic
functions, in a way that extends the basic symbolic method. This includes: walks
with a ﬁnite number of allowed jumps (Subsection VII. 8.1) and planar maps (Subsec-
tion VII.8.2). In such cases, bivariate functional equations reﬂect the combinatorial
decompositions of objects. The common form of these functional equations is
(75)
Φ(z, u, F(z, u), h1(z), . . . , hr(z)) = 0,
where Φ is a known polynomial and the unknown functions are F and h1, . . . , hr.
Speciﬁc methods are needed in order to attain solutions to such functional equations
that would seem at ﬁrst glance to be grossly underdetermined. Random walks lead to
a linear version of (75) that is treated by the so-called “kernel method”. Maps lead
to nonlinear versions that are solved by means of Tutte’s “quadratic method”. In both
cases, the strategy consists in binding z and u by forcing them to lie on an algebraic
curve (suitably chosen in order to eliminate the dependency on F(z, u)), and then
pulling out algebraic consequences of such a specialization.
VII. 8.1. Walks and the kernel method. Start with a set Ωthat is a ﬁnite sub-
set of Z and is called the set of jumps. A walk (relative to Ω) is a sequence w =
(w0, w1, . . . , wn) such that w0 = 0 and wi+1 −wi ∈Ω, for all i, 0 ≤i < n. A
nonnegative walk (also known as a “meander”) satisﬁes wi ≥0 and an excursion is
a nonnegative walk such that, additionally, wn = 0. A bridge is a walk such that
wn = 0. The quantity n is called the length of the walk or the excursion. For in-
stance, Dyck paths and Motzkin paths analysed in Section V. 3, p. 295, are excursions
that correspond to Ω= {−1, +1} and Ω= {−1, 0, +1} respectively. (Walks and
excursions are also somewhat related to paths in graphs in the sense of Section V. 6,
p. 340.)
We let −c denote the smallest (negative) value of a jump, and d denote the largest
(positive) jump. A fundamental rˆole is played in this discussion by the characteristic
polynomial of the walk,
S(y) :=
X
ω∈Ω
yω =
d
X
j=−c
Sjyj,
which is a Laurent polynomial12, that is, it involves negative powers of the variable y.
.
Walks. Observe ﬁrst the rational character of the BGF of walks, with z marking
length and u marking ﬁnal altitude:
(76)
W(z, u) =
1
1 −zS(u).
Since walks may terminate at a negative altitude, this is a Laurent series in u.
12If Ωis a set, then the coefﬁcients of S lie in {0, 1}. The treatment above applies in all generality to
cases where the coefﬁcients are arbitrary positive real numbers. This accounts for probabilistic situations
as well as multisets of jump values.

VII. 8. APPLICATIONS OF ALGEBRAIC FUNCTIONS
483
Bridges. The GF of bridges is formally as [u0]W(z, u), since they correspond to
walks that end at altitude 0. Thus one has
B(z) =
1
2iπ
Z
γ
1
1 −zS(u)
du
u ,
upon integrating along a circle γ that separates the small and large branches. The
integral can then be evaluated by residues (details are in [21]).
Excursions and meanders. We propose next to determine the number Fn of ex-
cursions of length n and type Ω, via the corresponding OGF
F(z) =
∞
X
n=0
Fnzn.
In fact, we shall determine the more general BGF
F(z, u) :=
X
n,k
Fn,kukzn,
where Fn,k is the number of nonnegative walks (meanders) of length n and ﬁnal alti-
tude k (i.e., the value of wn in the deﬁnition of a walk is constrained to equal k). In
particular, one has F(z) = F(z, 0).
The main result to be proved below is the following: For each ﬁnite set Ω∈Z,
the generating function of excursions is an algebraic function that is explicitly com-
putable from Ω. There are many ways to view this result. The problem is usually
treated within probability theory by means of Wiener-Hopf factorizations [413], and
Lalley [324] offers an insightful analytic treatment under this angle. On another reg-
ister, Labelle and Yeh [320] show that an unambiguous context-free speciﬁcation of
excursions can be systematically constructed, a fact that is sufﬁcient to ensure the al-
gebraicity of the GF F(z). (Their approach is implicitly based on the construction of
a ﬁnite pushdown automaton itself equivalent, by general principles, to a context-free
grammar.) The Labelle-Yeh construction reduces the problem to a large, but somewhat
“blind”, combinatorial preprocessing. Accordingly, for analysts, it has the disadvan-
tage of not extracting a simpler analytic (and noncombinatorial) structure inherent in
the problem: the shape of the end result is predicted by the Drmota-Lalley-Woods
Theorem, but the nature of the constants is not accessible in this way.
The method described below is often known as the kernel method. It takes some
of its inspiration from exercises in the 1968 edition of Knuth’s book [300] (Ex. 2.2.1.4
and 2.2.1.11), where a new approach was proposed to the enumeration of Catalan and
Schr¨oder objects. The technique has since been extended and systematized by several
authors; see for instance [20, 21, 70, 158, 159] for relevant combinatorial works. Our
presentation below follows that of Lalley [324] and Banderier-Flajolet [21].
The polynomial fn(u) = [zn]F(z, u) is the generating function of nonnegative
walks of length n, with u recording ﬁnal altitude. A simple recurrence relates fn+1(u)
to fn(u), namely,
(77)
fn+1(u) = S(u) · fn(u) −rn(u),

484
VII. APPLICATIONS OF SINGULARITY ANALYSIS
where rn(u) is a Laurent polynomial consisting of the sum of all the monomials of
S(u)fn(u) that involve negative powers13 of u:
(78)
rn(u) :=
−1
X
j=−c
uj ([uj] S(u)fn(u)) = {u<0}S(u)fn(u).
The idea behind the formula is to subtract the effect of those steps that would take the
walk below the horizontal axis. For instance, one has
S(u) = S−1
u
+ O(1)
:
rn(u) = S−1
u fn(0)
S(u) = S−2
u2 + S−1
u
+ O(1)
:
rn(u) =
S−2
u2 + S−1
u

fn(0) + S−2
u f ′
n(0),
and generally,
(79)
λj(u) = 1
j!{u<0}ujS(u).
Thus, from (77) and (78) (multiply by zn+1 and sum), the generating function
F(z, u) satisﬁes the fundamental functional equation
(80)
F(z, u) = 1 + zS(u)F(z, u) −z{u<0} (S(u)F(z, u)) .
Explicitly, one has
(81)
F(z, u) = 1 + zS(u)F(z, u) −z
c−1
X
j=0
λj(u)
 ∂j
∂uj F(z, u)

u=0
,
for Laurent polynomials λj(u) that depend on S(u) in an effective way by (79).
The main equations (80) and (81) involve one unknown bivariate GF, F(z, u)
and c univariate GFs, the partial derivatives of F specialized at u = 0. It is true, but
not at all obvious, that the single functional equation (81) fully determines the c + 1
unknowns. The basic technique is known as “cancelling the kernel” and it relies on
strong analyticity properties; see the book by Fayolle et al. [159] for deep ramiﬁca-
tions in the study of 2-dimensional walks. The form of (81) to be employed for this
purpose starts by grouping on one side the terms involving F(z, u),
(82) F(z, u)(1 −zS(u)) = 1 −z
c−1
X
j=0
λj(u)Gj(z),
Gj(z) :=
 ∂j
∂uj F(z, u)

.
If the right side was not present, then the solution would reduce to (76). In the case at
hand, from the combinatorial origin of the problem and implied bounds, the quantity
F(z, u) is bivariate analytic at (z, u) = (0, 0) (by elementary exponential majoriza-
tions on the coefﬁcients). The main principle of the kernel method consists in coupling
the values of z and u in such a way that 1 −zS(u) = 0, so that F(z, u) disappears
from the picture. A condition is that both z and u should remain small (so that F re-
mains analytic). Relations between the partial derivatives are then obtained from such
a specialization, (z, u) 7→(z, u(z)), which happen to be just in the right number.
13The convenient notation {u<0} denotes the singular part of a Laurent expansion: {u<0}f(z) :=
P
j<0
`[uj]f(u)´ · uj.

VII. 8. APPLICATIONS OF ALGEBRAIC FUNCTIONS
485
Consequently, we consider the “kernel equation”,
(83)
1 −zS(u) = 0,
which is rewritten as
uc = z · (ucS(u)).
Under this form, it is clear that the kernel equation (83) deﬁnes c + d branches of an
algebraic function. A local analysis shows that, amongst these c + d branches, there
are c branches that tend to 0 as z →0 while the other d tend to inﬁnity as z →0. (The
idea is that, in the equation (83), either one of zu−c ≈1 or zud ≈1 predominates;
equivalently, a Newton polygon can be constructed.) Let u0(z), . . . , uc−1(z) be the
c branches that tend to 0, that we call “small” branches. In addition, we single out
u0(z), the “principal” solution, by the reality condition
u0(z) ∼γz1/c,
γ := (Sc)1/c ∈R>0
(z →0+).
By local uniformization (70), the conjugate branches are given locally by
uℓ(z) = u0(e2iℓπz)
(z →0+).
Coupling z and u by u = uℓ(z) produces interesting specializations of Equa-
tion (82). In that case, (z, u) is close to (0, 0) where F is bivariate analytic so that the
substitution is admissible. By substitution, we get
(84)
1 −z
c−1
X
j=0
λj(uℓ(z))
 ∂j
∂uj F(z, u)

u=0
,
ℓ= 0 . . c −1.
This is now a linear system of c equations in c unknowns (the partial derivatives) with
algebraic coefﬁcients that, in principle, determines F(z, 0).
A convenient approach to the solution of (84) is due to Mireille Bousquet-M´elou.
The argument goes as follows. The quantity
(85)
M(u) := uc −zuc
c−1
X
j=0
λj(u) ∂j
∂uj F(z, 0)
can be regarded as a polynomial in u. It is monic while it vanishes by construction at
the c small branches u0, . . . , uc−1. Consequently, one has the factorization,
(86)
M(u) =
c−1
Y
ℓ=0
(u −uℓ(z)).
Now, the constant term of M(u) is otherwise known to equal −zS−cF(z, 0), by the
deﬁnition (85) of M(u) and by Equation (79) specialized to λ0(u). Thus, the compar-
ison of constant terms between (85) and (86) provides us with an explicit form of the
OGF of excursions:
F(z, 0) = (−1)c−1
S−cz
c−1
Y
ℓ=0
uℓ(z).
One can then ﬁnally return to the original functional equation and pull the BGF F(z, u).
In summary:

486
VII. APPLICATIONS OF SINGULARITY ANALYSIS
Proposition VII.6. Let Ωbe a ﬁnite step of jumps and let S(u) be the characteristic
polynomial of Ω. Consider the c small branches of the “kernel” equation,
1 −zS(u) = 0,
denoted by u0(z), . . . , uc−1(z). The generating function of excursions is given by
F(z) = (−1)c−1
zS−c
c−1
Y
ℓ=0
uℓ(z),
where S−c = [u−c]S(u)
is the multiplicity (or weight) of the smallest element −c ∈Ω. More generally the
bivariate generating function of nonnegative walks (also known as meanders) with u
marking ﬁnal altitude is bivariate algebraic and given by
F(z, u) =
1
uc −zucS(u)
c−1
Y
ℓ=0
(u −uℓ(z)) .
The OGF of bridges is expressible in terms of the small branches, by
B(z) = z
c
X
j=1
u′
j(z)
uj(z) = z d
dz log (u1(z) · · · uc(z)) .
EXAMPLE VII.19.
Trees and Łukasiewicz codes. A particular class of walks is of special
interest; it corresponds to cases where c = 1, that is, the largest jump in the negative direction
has amplitude 1. Consequently, Ω+ 1 = {0, s1, s2, . . . , sd}. In that situation, combinatorial
theory teaches us the existence of fundamental isomorphisms between walks deﬁned by steps
Ωand trees whose degrees are constrained to lie in 1 + Ω. The correspondence is by way of
Łukasiewicz codes14, also known as ‘Polish” preﬁx codes introduced in Chapter I. From this
correspondence, we expect to ﬁnd tree GFs in such cases.
As regards generating functions, there now exists only one small branch, namely the so-
lution u0(z) to u0(z) = zφ(u0(z)) (where φ(u) = uS(u)) that is analytic at the origin. One
then has F(z) = F(z, 0) = 1
z u0(z), so that the walk GF is determined by
F(z, 0) = 1
z u0(z),
u0(z) = zφ(u0(z)),
φ(u) := uS(u).
This form is consistent with what is already known regarding the enumeration of simple families
of trees. In addition, one ﬁnds
F(z, u) = 1 −u−1u0(z)
1 −zS(u)
= u −u0(z)
u −zφ(u).
Classical specializations are rederived in this way:
— the Catalan walk (Dyck path), deﬁned by Ω= {−1, +1} and φ(u) = 1 + u2, has
u0(z) = 1
2z
“
1 −
p
1 −4z2
”
;
— the Motzkin walk, deﬁned by Ω= {−1, 0, +1} and φ(u) = 1 + u + u2 has
u0(z) = 1
2z
“
1 −z −
p
1 −2z −3z2
”
;
14Such a code (p. 70) is obtained by a preorder traversal of the tree, recording a jump of r −1 when a
node of outdegree r is encountered. The sequence of jumps gives rise to an excursion followed by an extra
−1 jump.

VII. 8. APPLICATIONS OF ALGEBRAIC FUNCTIONS
487
— the modiﬁed Catalan walk, deﬁned by Ω= {−1, 0, 0, +1} (with two steps of type 0)
and φ(u) = 1 + 2u + u2, has
u0(z) = 1
2z
`
1 −2z −
√
1 −4z
´
;
— the d-ary tree walk (the excursions encode d-ary trees) deﬁned by Ω= {−1, d−1},
has u0(z) that is deﬁned implicitly by u0(z) = z(1 + u0(z)d).
The kernel method thus provides a new perspective for the enumeration of Dyck paths and
related objects. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE VII.19. □
EXAMPLE VII.20. Walks with amplitude at most 2. Take Ω= {−2, −1, 1, 2}, so that
S(u) = u−2 + u−1 + u + u2.
Then, u0(z), u1(z) are the two branches that vanish as z →0 of the curve
y2 = z(1 + y + y3 + y4).
The linear system that determines F(z, 0) and F ′
u(z, 0) is
8
>
>
<
>
>
:
1 −
„
z
u0(z)2 +
z
u0(z)
«
F(z, 0) −
z
u0(z)F ′
u(z, 0)
=
0
1 −
„
z
u1(z)2 +
z
u1(z)
«
F(z, 0) −
z
u1(z)F ′
u(z, 0)
=
0
(derivatives are taken with respect to the second argument) and one ﬁnds
F(z, 0) = −1
z u0(z)u1(z),
F ′
u(z, 0) = 1
z (u0(z) + u1(z) + u0(z)u1(z)).
This gives the number of walks, through a combination of series expansions,
F(z) = 1 + 2z2 + 2z3 + 11z4 + 24z5 + 93z6 + 272z7 + 971z8 + 3194z9 + · · · .
A single algebraic equation for F(z) = F(z, 0) is then obtained by elimination (e.g., via
Groebner bases) from the system:
8
<
:
u2
0 −z(1 + u0 + u3
0 + u4
0)
=
0
u2
1 −z(1 + u1 + u3
1 + u4
1)
=
0
zF + u0u1
=
0
Elimination shows that F(z) is a root of the equation
z4y4 −z2(1 + 2z)y3 + z(2 + 3z)y2 −(1 + 2z)y + 1 = 0.
For Ω= {−2, −1, 0, 1, 2}, we ﬁnd similarly F(z) = −1
z u0(z)u1(z), where u0, u1 are
the small branches of y2 = z(1 + y + y2 + y3 + y4); the expansion starts as
F(z) = 1 + z + 3z2 + 9z3 + 32z4 + 120z5 + 473z6 + 1925z7 + 8034z8 + · · · ,
(EIS A104184), and F(z) is a root of the equation
z4y4 −z2(1 + z)y3 + z(2 + z)y2 −(1 + z)y + 1 = 0.
In such cases, the GFs are no longer of the simple tree type. . . END OF EXAMPLE VII.20. □

488
VII. APPLICATIONS OF SINGULARITY ANALYSIS
The singularities of the branches involved in the statement of Proposition VII.6
can be worked out in all generality [21, 324]. The roots of the kernel equation (83) are
singular at points z with value u satisfying the simultaneous set of equations,
1 −zS(u) = 0,
S′(u) = 0,
where the second equation corresponds to a place where the analytic implicit function
theorem “fails” to deﬁne u as an analytic function of z. The second equation always
has a positive root τ, corresponding to a positive value of z, which is ρ = 1/S(τ). It
is then natural to suspect ρ to be radius of convergence of F(z) and the singularity to
be of the square-root type (Z1/2), this for reasons seen in the proof of Theorem VII.3
(the smooth implicit-function schema). These properties are shown in complete detail
in the article [21], where it is also established that the GF of bridges is of singular type
Z−1/2, just like for Dyck bridges.
Proposition VII.7. Deﬁne the structural constant τ by S′(τ) = 0, τ > 0. Then
assuming aperiodicity, the number of bridges (Bn) and the number of excursions (Fn)
satisfy
Bn ∼β0
S(τ)n
√
2πn,
Fn ∼ǫ0
S(τ)n
2
√
πn3 ,
where
β0 = 1
τ
s
S(τ)
S′′(τ),
ǫ0 = (−1)c−1
S−c
s
2S(τ)3
S′′(τ)
c−1
Y
j=1
uj

1
S(τ)

.
There, the uj represent the small branches and u0 is the branch that is real positive
as z →0.
Proposition VII.7 expresses a universal law of type n−3/2 for excursions and
n−1/2 for bridges, a fact otherwise at least partly accessible to classical probability
theory (e.g., via a local limit theorem for bridges and via Brownian motion for ex-
cursions). Basic parameters of walks, excursions, bridges, and meanders can then be
analysed in a uniform fashion [21].
VII. 8.2. Maps and the quadratic method. A (planar) map is a connected pla-
nar graph together with an embedding into the plane. In all generality, loops and
multiple edges are allowed. A planar map therefore separates the plane into regions
called faces (Figure 19). The maps considered here are in addition rooted, meaning
that a face, an incident edge, and an incident vertex are distinguished. In this section,
only rooted maps are considered15. When representing rooted maps, we shall agree
to draw the root edge with an arrow pointing away from the root node, and to take
the root face as that face lying to the left of the directed edge (represented in grey on
Figure 19).
15Nothing is lost regarding asymptotic properties of random structures when a rooting is imposed.
The reason is that a map has, with probability exponentially close to 1, a trivial automorphism group; con-
sequently, almost all maps of m edges can be rooted in 2m ways (by choosing an edge, and an orientation
of this edge), and there is an almost uniform 2m-to-1 correspondence between unrooted maps and rooted
ones.

VII. 8. APPLICATIONS OF ALGEBRAIC FUNCTIONS
489
FIGURE VII.19.
A planar map.
Tutte launched in the 1960’s a large census of planar maps, with the intention
of attacking the four-colour problem by enumerative techniques16; see [73, 471, 472,
473, 474]. There exists in fact an entire zoo of maps deﬁned by various degree or con-
nectivity constraints. In this chapter, we shall limit ourselves to conveying a ﬂavour
of this vast theory, with the goal of showing how algebraic functions arise. The pre-
sentation takes its inspiration from the book of Goulden and Jackson [244, Sec. 2.9]
Let M be the class of all maps where size is taken to be the number of edges. Let
M(z, u) be the BGF of maps with u marking the number of edges on the outside face.
The basic surgery performed on maps distinguishes two cases based upon the nature
of the root edge. A rooted map will be declared to be isthmic if the root edge r of map
µ is an “isthmus” whose deletion would disconnect the graph. Clearly, one has,
(87)
M = o + M(i) + M(n),
where M(i) (resp. M(n)) represent the class of isthmic (resp. non-isthmic) maps and
‘o’ is the graph consisting of a single vertex and no edge. There are accordingly two
ways to build maps from smaller ones by adding a new edge.
(i) The class of all isthmic maps is constructed by taking two arbitrary maps and
joining them together by a new root edge, as shown below:
16The four-colour theorem to the effect that every planar graph can be coloured using only four colours
was eventually proved by Appel and Haken in 1976, using structural graph theory methods supplemented
by extensive computer search.

490
VII. APPLICATIONS OF SINGULARITY ANALYSIS
The effect is to increase the number of edges by 1 (the new root edge) and have the
root face degree become 2 (the two sides of the new root edge) plus the sum of the
root face degrees of the component maps. The construction is clearly revertible. In
other words, the BGF of M(i) is
(88)
M (i)(z, u) = zu2M(z, u)2.
(ii) The class of non-isthmic maps is obtained by taking an already existing map
and adding an edge that preserves its root node and “cuts across” its root face in some
unambiguous fashion (so that the construction should be revertible). This operation
will therefore result in a new map with an essentially smaller root-face degree. For
instance, there are 5 ways to cut across a root face of degree 4, namely,
                                                







                                          






                                          






                                          






            





         


This corresponds to the linear transformation
u4
7→
zu5
+
zu4
+
zu3
+
zu2
+
zu1.
In general the effect on a map with root face of degree k is described by the trans-
formation uk 7→zu(1 −uk+1)/(1 −u); equivalently, each monomial g(u) = uk
is transformed into zu(g(1) −ug(u))/(1 −u). Thus, the OGF of M(n) involves a
discrete difference operator:
(89)
M (n)(z, u) = zuM(z, 1) −uM(z, u)
1 −u
.
Collecting the contributions from (88) and (89) in (87) then yields the basic func-
tional equation,
(90)
M(z, u) = 1 + u2zM(z, u)2 + uz M(z, 1) −uM(z, u)
1 −u
.
The functional equation (90) binds two unknown functions, M(z, u) and M(z, 1).
Much like in the case of walks, it would seem to be underdetermined. Now, a method
due to Tutte and known as the quadratic method provides solutions. Following Tutte
and the account in [244, p. 138], we consider momentarily the more general equation
(91)
(g1F(z, u) + g2)2 = g3,
where gj = Gj(z, u, h(z)) and the Gj are explicit functions—here the unknown func-
tions are F(z, u) and h(z) (cf. M(z, u) and M(z, 1) in (90)). Bind u and z in such
a way that the left side of (91) vanishes, that is, substitute u = u(z) (a yet unknown
function) so that g1F + g2 = 0. Since the left-hand side of (91) now has a double root
in u, so must the right-hand side, which implies
(92)
g3 = 0,
∂g3
∂u

u=u(z)
= 0.

VII. 8. APPLICATIONS OF ALGEBRAIC FUNCTIONS
491
The original equation has become a system of two equations in two unknowns that de-
termines implicitly h(z) and u(z). From there, elimination provides individual equa-
tions for u(z) and for h(z). (If needed, F(z, u) can then be recovered by solving a
quadratic equation.) It will be recognized that, if the quantities g1, g2, g3 are polyno-
mials, then the process invariably yields solutions that are algebraic functions.
We now carry out this programme in the case of maps and Equation (90). First,
isolate M(z, u) by completing the square, giving
(93)

M(z, u) −1
2
1 −u + u2z
u2z(1 −u)
2
= Q(z, u) + M(z, 1)
u(1 −u),
where
Q(z, u) = z2u4 −2zu2(u −1)(2u −1) + (1 −u2)
4u4z2(1 −u)2
.
Next, the condition expressing the existence of a double root is
Q(z, u) +
1
u(1 −u)M(z, 1) = 0,
Q′
u(z, u) +
2u −1
u2(1 −u)2 M(z, 1) = 0.
It is now easy to eliminate M(z, 1), since the dependency in M is linear, and a
straightforward calculation shows that u = u(z) should satisfy
 u2z + (u −1)
  u2z + (u −1)(2u −3)

= 0.
The ﬁrst parameterization would lead to M(z, 1) = 1/z which is not acceptable.
Thus, u(z) is to be taken as the root of the second factor, with M(z, 1) being deﬁned
parametrically by
(94)
z = (1 −u)(2u −3)
u2
,
M(z, 1) = −u 3u −4
(2u −3)2 .
We can then eliminate u and get an explicit equation for M, which turns out to be ex-
plicitly solvable. In summary, we obtain one of the very ﬁrst results of the enumerative
theory of maps:
Proposition VII.8. The OGF of maps admits the explicit form
(95)
M(z) ≡M(z, 1) = −
1
54 z2

1 −18z −(1 −12z)3/2
,
and the number of maps with n edges, Mn = [zn]M(z, 1), is
(96)
Mn = 2 (2n)!3n
n!(n + 2)!,
which satisﬁes asymptotically Mn ∼
2
√
πn5 12n.
The sequence of coefﬁcients is EIS A000168:
(97) M(z, 1) = 1+2z+9z2+54z3+378z4+2916z5+24057z6+208494z7+· · · .
We refer to [244, Sec. 2.9] for detailed calculations (that are nowadays routinely per-
formed with assistance of a computer algebra system). Currently, there exist many
applications of the quadratic method to maps satisfying all sorts of combinatorial
constraints, in particular multiconnectivity; see [429] for a panorama. Interestingly

492
VII. APPLICATIONS OF SINGULARITY ANALYSIS
enough, the singular exponent of maps is universally 3
2, a fact further reﬂected by
the n−5/2 factor in the asymptotic form of coefﬁcients. Accordingly, randomness
properties of maps are appreciably different from what is observed in trees and many
commonly encountered context-free objects (e.g., irreducible ones).
 VII.33. Lagrangean parametrization of general maps. The change of parameter u = 1−1/w
reduces (94) to the “Lagrangean form”,
(98)
z =
w
1 −3w ,
M(z, 1) =
1 −4w
(1 −3w)2 ,
to which the Lagrange Inversion Theorem can be applied, giving back (96).

 VII.34. The number of planar graphs. The asymptotic number of labelled planar graphs
with n vertices was determined by Gim´enez and Noy [235] to be of the form
Gn ∼g · γnn−7/2n!,
g .= 0.4970 04399,
γ .= 27.22687 77685 .
This spectacular result, which settled a long standing open question, is obtained by a succes-
sion of combinatorial-analytic steps based on: (i) the enumeration of 3–connected maps (these
are the same as graphs, due to unique embeddability), which can be performed by the qua-
dratic method; (ii) the enumeration of 2–connected graphs by Bender, Gao, and Wormald [33];
(iii) the integro-differential relations that relate the GFs of 2-connected and 1-connected graphs.
The authors of [235] also show that a random planar graph is connected with probability as-
ymptotic to e−ν .= 0.96325 and the mean number of connected components is asymptotic to
1 + ν .= 1.03743.

VII. 9. Ordinary differential equations and systems
In Part A of this book relative to Symbolic Methods, we have encountered differ-
ential relations attached to several combinatorial constructions.
— Pointing: the operation of pointing a speciﬁc atom in an object of a combi-
natorial class C produces a pointed class D = ΘC. If the generating function
of C is C(z) (an OGF in the unlabelled case, an EGF in the labelled case),
then one has
(99)
D = ΘC
=⇒
D(z) = z d
dz C(z).
See Subsections I. 6.2 (p. 79) and II. 6.1 (p. 126).
— Order constraints: in Subsection II. 6.3 (p. 129), we have deﬁned the boxed
product A = (B2 ⋆C) to be the modiﬁed labelled product comprised of
pairs of elements such that the smallest label is constrained to lie in the B
component. The translation over OGFs is
(100)
A = (B2 ⋆C)
=⇒
A(z) =
Z z
0
(∂tB(t)) · C(t) dt.
Thus pointing and order constraints systematically lead to integro-differential relation,
which transform into ordinary differential equations (ODEs) and systems. Another
rich source of differential equations in combinatorics is provided by the holonomic
framework (APPENDIX B: Holonomic functions, p. 693). We summarize below some
of the major methods that can be used to analyse the corresponding generating func-
tions. Our analytic arguments largely follow the accessible introductions found in the

VII. 9. ORDINARY DIFFERENTIAL EQUATIONS AND SYSTEMS
493
books by Henrici [265] and Wasow [490]. Linear equations are examined in Subsec-
tion VII. 9.1, some simple nonlinear ODEs in Subsection VII. 9.2. The main applica-
tions discussed here are relative to trees associated to ordered structures—quadtrees
and increasing trees principally.
VII. 9.1. Singularity analysis of linear differential equations. Linear differ-
ential equations with analytic coefﬁcients have solutions that, near a reasonably well-
behaved singularity ζ, are of the form
Zθ(log Z)kH(Z),
Z := z −ζ,
with β ∈C an algebraic number, k ∈Z≥0, and H a locally analytic function. The
coefﬁcients of such equations are composed of elements that are asymptotically of the
form
nβ(log n)k,
β = −θ −1,
in accordance with the general correspondence provided by singularity analysis. For
instance, a naturally occurring combinatorial structure, the quadtree, gives rise to a
number sequence that, surprisingly, turns out to be asymptotic to n(
√
17−3)/2.
Regular singularities. Our starting point is a linear ordinary differential equa-
tion (linear ODE), which we take to be of the form
(101)
c0(z)∂rY (z) + c1(z)∂r−1Y (z) + · · · + crY (z) = 0,
∂≡d
dz .
The integer r is the order. We assume that there exists a simply connected domain Ω
in which the coefﬁcients cj ≡cj(z) are analytic. At a point z0 where c0(z0) ̸= 0, a
classical existence theorem (Note 35 and [490, p. 3]) guarantees that, in a neighbour-
hood of z0, there exist r linearly independent analytic solutions of the equation. Thus,
singularities can only occur at points ζ that are roots of the leading coefﬁcient c0(z).
 VII.35. Analytic solutions. Consider the ODE (101) near z0 = 0 and assume c0(0) ̸= 0.
Then, a formal solution Y (z) can be determined, given any set of initial conditions Y (j)(0) =
wj, by the method of indeterminate coefﬁcients. The coefﬁcients can be constructed recurrently,
and simple bounds show that they are of at most exponential growth.

To proceed, we rewrite Equation (101) as
(102)
∂rY (z) + d1(z)∂r−1Y (z) + · · · + dr(z)Y (z) = 0,
where dj = cj/c0. Under our assumptions, the functions dj(z) are now meromorphic
in Ω. Given a meromorphic function f(z), we deﬁne ωζ(f) to be the order of the pole
of f at ζ, and ωζ(f) = 0 means that f(z) is analytic at ζ.
Deﬁnition VII.7. The differential equations (101) and (102) are said to have a sin-
gularity at ζ if at least one of the ωζ(dj) is positive. The point ζ is said to be a regular
singularity if
ωζ(d1) ≤1,
ωζ(d2) ≤2,
. . . ,
ωζ(dr) ≤r,
an irregular singularity otherwise.
For instance, the second-order ODE
(103)
Y ′′ + z−1 sin(z)Y ′ −z−2 cos(z)Y = 0,

494
VII. APPLICATIONS OF SINGULARITY ANALYSIS
has a regular singular point at z = 0, since the orders are 0, 2, respectively. It is a
notable fact that, even though we do not know how to solve explicitly the equation in
terms of usual special functions, the asymptotic form of its solutions can be precisely
determined.
Let ζ be a regular singular point, and say we attempt to solve (103) by trying
a solution of the form zθ + · · · . For instance, proceeding somewhat optimistically
with (103) at ζ = 0, we may expect the left hand side of the equation to be of the form

θ(θ −1)zθ−2 + · · ·

+

θzθ−1 + · · ·

−

zθ−2 + · · ·

= 0.
In order to obtain cancellation to main asymptotic order (zθ−2), we must then assume
that the coefﬁcient of zθ−2 vanishes; then, θ solves an algebraic equation of degree 2,
namely, θ(θ −1) −1 = 0, which suggests the possibility of two solutions of the form
zθ near 0, with θ = (1 ±
√
5)/2. This informal discussion motivates the following
deﬁnition.
Deﬁnition VII.8. Given an equation of the form (102) and a regular singular point ζ,
the indicial polynomial I(θ) at ζ is deﬁned to be
I(θ) = θr + δ1θr−1 + · · · + δr,
θℓ:= θ(θ −1) · · · (θ + ℓ−1),
where δj := limz→ζ(z −ζ)jdj(z). The indicial equation (at ζ) is the algebraic
equation I(θ) = 0.
If we let L denote the differential operator corresponding to the left hand side
of (102), we have formally, at a regular singular point
L

Zθ
= I(θ)Zθ−r + O
 Zθ−r−1
,
Z = (z −ζ),
which justiﬁes the rˆole of the indicial polynomial. (The process used to determine
the solutions by restricting attention to dominant asymptotic terms is analogous to
the Newton polygon construction for algebraic equations.) An important structure
theorem describes the possible types of solutions of a meromorphic ODE at a regular
singularity.
Theorem VII.9 (Regular singularities of ODEs). Consider a meromorphic differen-
tial equation (102) and a regular singular point ζ. Assume that the indicial equation
at ζ, I(θ) = 0, is such that no two roots differ by an integer (in particular, all roots
are distinct). Then, in a slit neighbourhood of ζ, there exists a linear basis of all the
solutions that is comprised of functions of the form
(104)
(z −ζ)θjHj(z −ζ),
where θ1, . . . , θr are the roots of the indicial polynomial and each Hj is analytic at 0.
In the case of roots differing by an integer (or multiple roots), the solutions (104) may
include additional logarithmic terms involving nonnegative powers of log(z −ζ).
A description of the logarithmic cases is best based on a matrix treatment of the
ﬁrst-order linear system that is equivalent to the ODE [265, 490]. Note 37 discusses
the representative case of Euler systems, which is explicitly solvable.
 VII.36. Singular solutions. In the ﬁrst case (no two roots differing by an integer), it sufﬁces
to work out the modiﬁed differential equation satisﬁed by Z−θj Y (z) and verify that one of

VII. 9. ORDINARY DIFFERENTIAL EQUATIONS AND SYSTEMS
495
its solutions is analytic at ζ: the coefﬁcients of Hj satisfy a solvable recurrence, like in the
nonsingular case, and their growth is veriﬁed to be at most exponential.

 VII.37. Euler equations and systems. An equation of the form,
∂rY + e1Z−1∂r−1Y + · · · + erZ−rY = 0,
ej ∈C,
Z := (z −ζ),
is known as an Euler equation. In the case where all roots of the indicial equation are simple,
a basis of solutions is exactly of the form Zθj . When θ is a root of multiplicity m, the set of
solutions includes Zθ(log Z)p, for p = 0, . . . , m −1. [Euler equations appear for instance in
the median-of-three quicksort algorithm [307, 434]. See [87] for several applications to random
tree models and the analysis of algorithms.]
Euler systems are ﬁrst order systems of the form
d
dz Y(z) =
A
z −ζ Y(z),
where A ∈Cr×r is a scalar matrix and Y = (Y1, . . . , Yr)T is a vector of functions. A formal
solution is provided by
(z −ζ)A = exp (A log(z −ζ)) ,
which indicates that the Jordan block decomposition of A plays a rˆole in the occurrence of
logarithmic factors of solutions.

 VII.38. Irregular singularities. The equation
(1 −z)2Y ′ −Y = 0,
Y (0) = 1
has Y (z) = exp(z/(1 −z)) as its solution. The point ζ = 1 is a singularity, but not one
of the regular type: the solution blows up exponentially near this point. See [265, 490] for
a general treatment. (The function Y (z) occurs as the EGF of “fragmented permutations” in
Subsection II. 4.2, p. 115.) The analysis of coefﬁcients in such cases resorts to the saddle point
method exposed in Chapter VIII.

Theorem VII.10 (Coefﬁcient asymptotics for meromorphic ODEs). Let f(z) be an-
alytic at 0 and satisfy a linear differential equation
dr
dzr f(z) + c1(z) dr−1
dzr−1 f(z) + · · · + cr(z)f(z) = 0,
where the coefﬁcients cj(z) are analytic in |z| < ρ1, except for possibly a pole at
some ζ satisfying |ζ| < ρ1, ζ ̸= 0. Assume that ζ is a regular singular point and no
two roots of the indicial equation at ζ differ by an integer. Then, there exist scalar
constants λ1, . . . , λr ∈C such that for any ρ0 with |ζ| < ρ0 < ρ1, one has
(105)
[zn]f(z) =
r
X
j=1
λj∆j(n) + O
 ρ−n
0

,
where the ∆j(n) are of the asymptotic form
(106)
∆j(n) ∼n−θj−1
Γ(−θj)ζ−n
"
1 +
∞
X
k=1
si,j
ni
#
,
and the θj are the roots of the indicial equation at ζ.
PROOF. The coefﬁcients λj relate the particular solution f(z) to the basis of solu-
tions (104). The rest, by singularity analysis, is nothing but a direct transcription to
coefﬁcients of the solutions provided by the structure theorem, Theorem VII.9, with
∆j(n) = [zn](z −ζ)θjHj(z −ζ).
□

496
VII. APPLICATIONS OF SINGULARITY ANALYSIS
Taking into account multiple roots (as in Note 37) and roots differing by as inte-
ger, we see that solutions to meromorphic linear ODEs, in the regular case at least, are
only composed of linear combinations of asymptotic elements of the form17
(107)
ζ−nnβ(log n)ℓ,
where ζ is determined as root of a (possibly transcendental) equation, c0(ζ) = 0, the
number β is an algebraic quantity (over the ﬁeld of constants δj) determined by the
polynomial equation I(−β −1) = 0, and ℓis an integer.
The coefﬁcients λj serve to “connect” the particular function of interest, f(z)
to the local basis of singular solutions (104). Their determination thus represents a
connection problem (see pp. 448 and 481). However, contrary to what happens for
algebraic equations, the determination of the λj can only be approached in all gen-
erality by numerical methods [203]. (Even when the coefﬁcients dj(z) ∈Q(z) are
rational fractions, no decision procedure is available to decide, from an f(z) ∈Q[[z]]
determined by initial conditions at 0, which of the connection coefﬁcients λj may
vanish.) In many combinatorial applications the calculations can be carried out ex-
plicitly, in which case the forms (107) serve as a beacon of what to expect asymptot-
ically. (Once existence of such forms is granted, e.g., by Theorems VII.9 and VII.10,
it is often possible to identify coefﬁcients and/or exponents in asymptotic expansions
directly.) Similar considerations apply to functions deﬁned by systems of linear dif-
ferential equations (Note 41 below).
 VII.39. Multiple singularities. In the case of several singularities ζ1, . . . , ζs, a sum of s
terms, each of the form (106) with ζ →ζi, expresses [zn]f(z). [The structure theorem applies
at each ζi and singularity analysis is known to adapt to multiple singularities, Section VI. 5,
p. 381.]

 VII.40. A relaxation. In Theorem VII.10, one may allow the equation to have a singularity
of any kind at 0. [Only properties of the basis of solutions near ζ are used.]

 VII.41. Equivalence between equations and systems. A (ﬁrst-order) linear differential system
is by deﬁnition
d
dz Y (z) = A(z)Y (z),
where Y = (Y1, . . . , Ym)T is an m-dimensional column vector and A is an m × m coefﬁcient
matrix. A differential equation of order m can always be reduced to a system of dimension m,
and conversely. Only rational operations and derivatives are involved in each of the conver-
sions: technically, coefﬁcient manipulations take place in a differential ﬁeld K that contains
coefﬁcients of recurrences and systems. (For instance, the set of rational functions C(z) and
the set of meromorphic functions in an open set Ωare differential ﬁelds.)
The proofs are simple extensions of the case m = 2. Starting from the equation y′′ +by′+
cy = 0, one sets Y1 = y, Y2 = y′ to get the system
{∂Y1 = Y2,
∂Y2 = −cY1 −bY2}.
Conversely, given the system
{∂Y1 = a11Y1 + a12Y2,
∂Y2 = a21Y1 + a22Y2},
17The forms (107) are appreciably more general than the corresponding ones arising in algebraic
coefﬁcient asymptotics (Theorem VII.8, p. 477), since, there, no logarithmic term can be present and the
exponents are constrained to be rational numbers only, reﬂecting the Newton-Puiseux expansion.

VII. 9. ORDINARY DIFFERENTIAL EQUATIONS AND SYSTEMS
497
FIGURE VII.20. The quadtree splitting process (left); a hierarchical partition associated
to n = 50 random points.
let E = VS[Y1, Y2] be the vector space over K spanned by Y1, Y2, which is of dimension ≤2.
Differentiation of the relation ∂Y1 = a11Y1 + a12Y2 shows that ∂2Y1 can be expressed as
combination of Y1, Y2,
∂2Y1 = a′
11Y1 + a′
12Y2 + a11(a11Y1 + a12Y2) + a12(a21Y1 + a22Y2),
hence ∂2Y1 lies in E. Thus, the system {Y1, ∂Y1, ∂Y 2
1 } is bound, which corresponds to a
differential equation of order 2 being satisﬁed by Y1. (In the case where the coefﬁcient matrix A
has a simple pole at ζ, singularities of solutions can be studied by matrix methods akin to those
of Note 37.

Combinatorial applications. The quadtree is a tree structure, discovered by Fin-
kel and Bentley [166], that can be superimposed on any sequence of points in some
Euclidean space Rd. In computer science, it forms the basis of several algorithms for
maintaining and searching dynamically varying geometric objects [428]. Quadtrees
are associated to differential equations, whose order is equal to the dimension of the
underlying space. Some of their major characteristics can be determined via singular-
ity analysis of these equations [183, 194].
EXAMPLE VII.21.
The plain quadtree.
Start from the unit square Q = [0, 1]2 and
let p = (P1, . . . , Pn), where Pj = (xj, yj), be a sequence of n points drawn uniformly
and independently from Q. A quaternary tree, called the quadtree and noted QT(p), is built
recursively from p as follows:
— if p is the empty sequence (n = 0), then QT(p) = ∅is the empty tree;
— otherwise, let pNW , pNE, pSW , pSE be the four subsequences of points of p that lie
respectively North-West, North-East, South-West, South-East of P1. For instance
pSW is pSW = (Pj1, Pj2, . . . , Pjk), where 1 < j1 < j2, · · · < jk ≤n, and the
Pjℓ= (xℓ, yℓ) are those points, which satisfy the predicate xjℓ< x1 and yjℓ< y1.
Then QT(p) is
QT(p) = ⟨P1; QT(pNW ), QT(pNE), QT(pSW ), QT(pSE)⟩.
In other words, the sequence of points induces a hierarchical partition of the space QT; see
Figure 20. (For simplicity, the tree is only deﬁned here for points having different x and y co-
ordinates, an event that has probability 1.)

498
VII. APPLICATIONS OF SINGULARITY ANALYSIS
Quadtrees are used for searching in two related ways: (i) given a point P0 = (x0, y0),
exact search aims at determining whether P0 occurs in p; (ii) given a coordinate x0 ∈[0, 1], a
partial-match query asks for the set of points P = (x, y) occurring in p such that x = x0 (irre-
spective of the values of y). Both types are accommodated by the quadtree structure: an exact
search corresponds to descending in the tree, following a branch guided by the coordinates of
the point P0 that is sought; partial match is implemented by recursive descents into two subtrees
(either the pair NW, SW or NE, SE) based on the way x0 compares to the x coordinate of
the root point. In an ideal world for computers, trees are perfectly balanced, in which case the
search costs satisfy the approximate recurrences,
(108)
fn = 1 + fn/4,
gn = 1 + 2gn/4,
for exact search and partial match respectively. The solutions of these recurrences are ≈log4 n
and ≈√n, respectively.
To what extent do randomly grown quadtrees differ from the perfect shape, and what is the
growth of the cost functions on average? The answer lies in the singularities of certain linear
differential equations.
Our purpose is to set up tree recurrences in the spirit of Subsection VI. 10.3, p. 409. We
need the probability πn,k that a quadtree of size n gives rise to a NW root-subtree of size k and
claim that
(109)
πn,k = 1
n (Hn −Hk) ,
Hn = 1 + 1
2 + · · · + 1
n.
Indeed, the probability that ℓelements are West of the root and k are North-West is
(110)
̟n,ℓ,k =
 
n −1
k, ℓ−k, n −1 −ℓ
! Z 1
0
Z 1
0
(xy)k(x(1 −y))ℓ−k(1 −x)n−1−ℓdx dy.
(The double integral is the probability that the ﬁrst k elements fall NW , the next ℓ−k fall SW ,
the rest fall E; the integrand corresponds to a conditioning upon the coordinates (x, y) of the
root; the multinomial coefﬁcient takes into account the possible shufﬂings.) The Eulerian Beta
integral (p. 693) simpliﬁes the integrals to ̟n,ℓ,k = 1/(n(ℓ+1)), from which the claimed (109)
follows by summation over ℓ. (It is also possible, though less convenient, to develop equations
starting from basic principles of the symbolic method.)
Given (109), the recurrence
(111)
Pn = n + 4
n−1
X
k=0
πn,kPk,
P0 = 0,
with πn,k as in (109), determines the sequence of expected value of path length. This recurrence
translates into the integral equation,
(112)
P(z) =
z
(1 −z)2 + 4
Z z
0
dt
t(1 −t)
Z t
0
P(u)
du
1 −u),
itself equivalent to the linear differential equation of order 2,
z(1 −z)4P ′′(z) + (1 −2z)(1 −z)3P ′(z) −4(1 −z)2P(z) = 1 + 3z.
The homogeneous equation has a regular singularity at z = 1. In such a simple case, it is not
difﬁcult to guess the “right” solution, which can then be veriﬁed by substitution:
P(z) = 1
3
1 + 2z
(1 −z)2 log
1
1 −z + 1
6
4z + z2
(1 −z)2 ,
Pn =
„
n + 1
3
«
Hn −n + 1
6n .
The ratio Pn/n represents the mean level of a random node in a randomly grown quadtree, a
quantity which is thus log n + O(1). Accordingly, quadtrees are on average fairly balanced,

VII. 9. ORDINARY DIFFERENTIAL EQUATIONS AND SYSTEMS
499
the expected level being within a factor log 4 .= 1.38 of the corresponding quantity in a perfect
tree.
The analysis of partial match reveals a curious consequence of the imbalance of quadtrees,
where the order of growth differs from what the perfect tree model (108) predicts. The recur-
rence satisﬁed by the expected cost of a partial match query is determined by methods similar
to pathlength [183]. One ﬁnds, by a computation similar to (110),
(113)
Qn = 1 +
4
n(n + 1)
n−1
X
k=0
(n −k)Qk,
Q0 = 0,
corresponding, for the GF Q(z) = P Qnzn, to the inhomogeneous differential equation,
L[Q(z)] = 2/(1 −z), where the differential operator L is
(114)
L[f] = z(1 −z)2∂2f + 2(1 −z)2∂f −4f.
A particular solution of the inhomogeneous equation is −1/(1 −z), so that y(z) := Q(z) +
1/(1 −z) satisﬁes the homogeneous equation L[y] = 0.
The differential equation L[y] = 0 is singular at z = 0, 1, +∞and it has a regular sin-
gularity at z = 1. Since one has yn = O(n), by the origin of the problem, the singularity
at z = 1 is the one that matters. The indicial polynomial can be computed from its deﬁnition
or, equivalently, by simply substituting y = (z −1)θ in the deﬁnition of L and discarding lower
order terms. One ﬁnds, with Z = z −1:
L[Zθ] = θ(θ −1)Zθ −4Zθ + O
“
Zθ−1”
.
The roots of the indicial equations are then
θ1 = 1
2
“
1 −
√
17
”
,
θ2 = 1
2
“
1 +
√
17
”
.
Theorem VII.9 guarantees that y(z) admits, near z = 1 a representation of the form
(115)
y(z) = λ1(1 −z)θ1H1(z −1) + (1 −z)θ2H2(z −1),
with H1, H2 analytic at 0.
In order to complete the analysis, we still have to verify that the coefﬁcient λ1, which
multiplies the singular element that dominates as z →1 is nonzero. Indeed, if we had λ1 = 0,
then, one would have y(z) →0 as z →1, which contradicts the fact that yn ≥1. In other
words, here: the connection problem is solved by means of bounds that are available from the
combinatorial origin of the problem. Singularity analysis then yields the asymptotic form of
yn, hence of Qn. Summarizing , we have:
Proposition VII.9. Path length in a randomly grown quadtree of size n is on average n log n+
O(n). The expected cost of a partial match query satisﬁes
(116)
Qn ∼κ · nα−1,
α =
√
17 −1
2
.= 1.56155.
The analysis extends [183] to quadtrees of higher dimensions [183]. In general dimen-
sion d, pathlength is on average 2
dn log n + O(n). The cost of a partial match query is of the
order of nβ, where β is an algebraic number of degree d. . . . . . END OF EXAMPLE VII.21. □
 VII.42. Quadtrees and hypergeometric functions. For the plain quadtree (d = 2), the change
of variables y = (1 −z)−θη(z) reduces the differential equation L[y] = 0 to hypergeometric
form. The constant κ in (116) is then found to satisfy
κ = 1
2
Γ(2α)
Γ(α)3 ,
α =
√
17 −1
2
.

500
VII. APPLICATIONS OF SINGULARITY ANALYSIS
Hypergeometric solutions (Note 15, p. 696) are available for d ≥2 [86, 183, 194]

 VII.43. Closed meanders.
A closed meander of size n is a topological conﬁguration de-
scribing the way a loop can cross a road 2n times. The sequence starts as 1, 1, 2, 8, 42, 262
(EIS A005315). For instance, here is a meander of size 5:
There are good reasons to believe that the number Mn of meanders satisﬁes
Mn ∼CAnn−β,
with
β = 29 +
√
145
12
,
based on analogies with well-established models of statistical physics [127].

VII. 9.2. Nonlinear differential equations. Solutions to nonlinear equations do
not necessarily have singularities that arise from the equation itself (as in the linear
case). Even the simplest nonlinear equation,
Y ′(z) = Y (z)2,
Y (0) = a,
has a solution Y (z) = 1/(a −z) whose singularity depends on the initial condition
and is not visible on the equation itself. The problem of determining the location of
singularities is nonobvious in the case of a nonlinear ODE. Furthermore, the problem
of determining the nature of singularities for nonlinear equations deﬁes classiﬁcation
in the general case [417, 418]. In this section, we thus limit ourselves to examining
a few examples where enough structure is present in the combinatorics, so that fairly
explicit solutions are available, which are then amenable to singularity analysis.
EXAMPLE VII.22. Increasing varieties of trees. Consider a labelled class deﬁned by either of
(117)
Y = Z2 ⋆SEQΩ(Y),
Y = Z2 ⋆SETΩ(Y),
where a set of integers Ω⊆Z≥0 has been ﬁxed. This deﬁnes trees that are either plane (SEQ)
or nonplane (SET) and increasing, in the sense that labels go in increasing order along any
branch stemming from the root. Such trees have been encountered in Subsection II. 6.3 (p. 129)
in relation to alternating permutations, general permutations, and regressive mappings. By
the symbolic translation of the boxed product, the EGF of Y satisﬁes a nonlinear differential
equation
(118)
Y (z) =
Z z
0
φ(Y (w)) dw,
where the structure function φ is
φ(y) =
X
ω∈Ω
yω
(case SEQ),
φ(y) =
X
ω∈Ω
yω
ω!
(case SET).
The integral equation (118) is our starting point; in order to unify both cases, we set φω :=
[yω]φ(y). The discussion below is excerpted from the paper [40].
First note that (118) is equivalent to the nonlinear differential equation
(119)
Y ′(z) = φ(Y (z)),
Y (0) = 0,

VII. 9. ORDINARY DIFFERENTIAL EQUATIONS AND SYSTEMS
501
Diff. eq.
EGF
ρ
Sing. type
Coeff..
A :
Y ′ = (1 + Y )2
z
1 −z
1
Z−1
Yn = n!
B :
Y ′ = 1 + Y 2
tan z
π
2
Z−1
Y2n+1
(2n+1)! ≍( 2
π )2n+1
C:
Y ′ = eY
log[(1 −z)−1]
1
log Z
Yn = (n −1)!
D :
Y ′ =
1
1 −Y
1 −√1 −2z
1
2
Z1/2
Yn = (2n −3)!!
FIGURE VII.21. Some classical varieties of increasing trees: (A) plane binary; (B) strict
plane binary; (C) increasing Cayley; (D) increasing plane.
which implies that Y ′/φ(Y ) = 1 and, upon integrating back,
(120)
Z Y (z)
0
dη
φ(η) = z,
i.e.,
K(Y (z)) = z,
K(y) :=
Z y
0
dη
φ(η).
Thus, the EGF Y (z) is the compositional inverse of the integral of the multiplicative inverse of
the structure function. We can visualize this chain of transformation as follows:
(121)
Y = Inv
◦
Z
◦
1
( · )
◦
φ.
In simpler situations, the integration deﬁning K(y) in (120) can be carried out explicitly
and explicit expressions may become available for Y (z). Figure 21 displays data relative to
four such classes, the ﬁrst three of which already encountered in Chapter II. In each case, there
is listed: the differential equation (from which the deﬁnition of the trees and the form of φ are
apparent), the dominant positive singularity, the singularity type, and the corresponding form
of coefﬁcients. The general analytic expressions of (120) contain much more: they allow for a
general discussion of singularity types and permit us to analyse asymptotically classes that do
not admit of an explicit GF.
Assume for simplicity φ to be an aperiodic entire function (possibly a polynomial). Let
ρ be the radius of convergence of Y (z), which is a singular point (by Pringsheim’s Theorem).
Consider the limiting value Y (ρ). One cannot have Y (ρ) < ∞since then K(z) being analytic
at Y (ρ) would be analytically invertible (by the implicit functions theorem). Thus, one must
have Y (ρ) = +∞and, since Y and K are inverses of each other, we get K(+∞) = ρ. The
radius of convergence of Y (z) is accordingly determined as
ρ =
Z ∞
0
dη
φ(η).
The singularity type of Y (z) is then systematically determined by the rules (121). For a general
polynomial of degree d ≥2, we have (ignoring coefﬁcients)
K(+∞) −K(y) ≈
Z ∞
y
dη
ηd ≈y−d+1,
Y (z) ≈Z−1/(d−1),
with Z := (ρ −z).
This back-of-the-envelope calculation shows that
(122)
for φ a polynomial of degree d :
Yn ∼Cn!nf,
with f = 2−d
1−d.
In the same vein, the logarithmic singularity of the EGF of increasing Cayley trees (Case C of
Figure 21) appears as eventually reﬂecting the inverse of the exponential singularity of φ(y) =
ey. Such a singularity type must then be systematically present when considering increasing

502
VII. APPLICATIONS OF SINGULARITY ANALYSIS
nonplane trees (increasing Cayley trees) with a ﬁnite collection of node degrees excluded—
in other words, whenever the SET constructor is used in (117) and Ωis a coﬁnite set. This
observation “explains” and extends an analysis of [358].
Consider next an additive parameter of trees18 deﬁned by a recurrence,
(123)
s(τ) = t|τ| +
X
υ∝τ
s(υ),
where (tn) is a numeric sequence of “tolls” with t0 = 0, and the summation υ ∝τ is carried
out over all root subtrees υ of τ. Introduce the two functions (of cumulated values)
S(z) =
X
τ∈Y
s(τ)z|τ|
|τ|! ,
T(z) =
X
n≥0
tnYn zn
n! ,
so that the ratio [zn]S(z)
[zn]Y (z) equals the mean value of parameter s taken over all increasing trees of
size n. By simple algebra similar to Lemma VII.1 (p. 439), it is found that the GF S(z) is
(124)
S(z) = Y ′(z)
Z z
0
T ′(w)
Y ′(w) dw.
The relation (117) deﬁnes an integral transform T 7→S, which can be viewed as a singularity
transformer. Thanks to the methods of Subsection VI. 10.3, p. 409, its systematic study is
doable, once the singularity type of Y (z) is known.
The discussion of path length (tn = n corresponding to T(z) = zY ′(z)) is conducted
in the present perspective as follows. For polynomial varieties of increasing trees, we have
Y (z) ≈Z−δ with δ = 1/(d −1), so that
T ≈Y ′ ≈Z−δ−1, T ′ ≈Z−δ−2, T ′
Y ′ ≈Z−1,
Z T ′
Y ′ ≈
Z
1
Z ≈log Z.
Thus, the relation between Y and S is of the simpliﬁed form S ≈Y ′ log Z. Singularity
analysis, then implies that average path length is of order n log n. Working out the constants
gives:
Proposition VII.10. Let Y be an increasing variety of trees deﬁned by a function φ that is an
aperiodic polynomial of degree d ≥2 and let δ = 1/(d −1). The number of trees of size n
satisﬁes
Yn ∼
n!
Γ(δ)
„ δ
ρφd
«δ
ρ−nn−1+δ,
ρ :=
Z ∞
0
dη
φ(η).
The expected value of path length on a tree of Yn is (δ + 1)n log n + O(n).
For naturally occurring models like those of Figure 21 and more, many parameters of in-
creasing tree varieties can be analysed in a synthetic way (e.g., the degree proﬁle, the level
proﬁle [40]). What stands out is the type of conceptual reasoning afforded by singularity anal-
ysis, which provides a direct path to the right order of magnitude of both combinatorial counts
and basic parameters of structures. After this, it sufﬁces to do the bookkeeping and get the
constants right! . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE VII.22. □
It is of interest to compare the properties of increasing trees and of simple vari-
eties of trees (examined in Subsection VII. 3.2, p. 436). The conclusion is that simple
trees are of the “square-root” type, in the sense that the typical depth of a node and
the expected height are of order √n. By contrast, increasing trees, which are strongly
18Such parameters have been investigated in Subsection VI. 10.3 (p. 409), and the binary search tree
recurrence there corresponds exacty to the case φ(w) = (1 + w)2 here.

VII. 10. PERSPECTIVE
503
bound by an order constraint, have logarithmic depth and height [123, 124, 126]—they
belong to a “logarithmic” type. From a singular perspective, simple trees are associ-
ated to the universal Z1/2 law, while increasing trees exhibit a divergence behaviour
(Z−1/(d−1) in the polynomial case). Tolls then affect singularities of GFs in rather
different ways: through a factor Z−1/2 for simple trees, through a factor log Z in the
case of increasing trees. Such abstract observations are typical of the spirit of analytic
combinatorics.
An interesting example of the joint use of nonlinear ODEs and singularity analy-
sis is provided by urn processes of probability theory. There, an urn may contain balls
of different colours. A ﬁxed set of replacement rules is given (one for each colour). At
any discrete instant, a ball is chosen uniformly at random, its colour is inspected, and
the corresponding replacement rule is applied. The problem is to determine the evolu-
tion of the urn at a large instant n. In the case of two colours and urns called balanced,
it is shown in [99, 178] that the generating function of urn histories is determined by
a nonlinear ﬁrst-order autonomous equation, from which many characteristics of the
urn can be effectively analysed.
A spectacular result in the general area of random discrete structures and nonlin-
ear differential equations is the discovery by Baik, Deift, and Johansson (Note VIII.20,
p. 540) of the law governing the longest increasing subsequence in a random permu-
tation. There, the solutions of the nonlinear Painlev´e equation
u′′(x) = 2u(x)3 + xu(x)
play a central rˆole.
VII. 10. Perspective
The theorems in this chapter demonstrate the central rˆole of the singularity anal-
ysis theory developed in Chapter VI, this in a way that parallels what Chapter V did
for Chapter IV with meromorphic function analysis. Exploiting properties of complex
functions to develop coefﬁcient asymptotics for abstract schemas help us solve whole
classes of combinatorial constructions at once.
Within the context of analytic combinatorics, the results in this chapter have broad
reach, and bring us closer to our ideal of a theory covering full analysis of combi-
natorial objects of any “reasonable” description. Analytic side conditions deﬁning
schemas often play a signiﬁcant rˆole. Adding in this chapter the mathematical support
for handling set constructions (with the exp-log schema) and context-free construc-
tions (with coefﬁcient asymptotics of algebraic functions) to the support developed
in Chapter V to handle the sequence construction (with the supercritical sequence
schema) and regular constructions (with coefﬁcient asymptotics of rational functions)
gives us general methods encompassing a broad swath of combinatorial analysis, with
a great many applications (Figure 22).
Together, the methods covered in Chapter V, this chapter, and, next, Chapter VIII
(relative to the saddle point method) apply to virtually all of the generating functions
derived in Part A of this book by means of the symbolic techniques deﬁned there.
The SEQ construction and regular speciﬁcations lead to poles; the SET construction
leads to algebraic singularities (in the case of logarithmic generators discussed here) or

504
VII. APPLICATIONS OF SINGULARITY ANALYSIS
Combinatorial Type
Coeff. asymptotics (subexp. term)
Rooted maps
n−5/2
§VII. 8.2
Unrooted trees
n−5/2
§VII. 5
Rooted trees
n−3/2
§VII. 3, §VII. 4
Excursions
n−3/2
§VII. 8.1
Bridges
n−1/2
§VII. 8.1
Mappings
n−1/2
§VII. 3.3
Exp-log sets
nκ−1
§VII. 2
Increasing d-ary trees
n−(d−2)/(d−1)
§VII. 9.2
Analytic form
Singularity type
Coeff. asymptotics
Positive irred. (polynomial syst.)
Z1/2
ζ−nn−3/2
§VII. 6
General algebraic
Zp/q
ζ−nn−p/q−1
§VII. 7
Regular singularity (ODE)
Zθ(log Z)ℓ
ζ−nn−θ−1(log n)ℓ
§VII. 9.1
FIGURE VII.22. A collection of universality laws summarized by the subexponential
factors involved in the asymptotics of counting sequences (top). A summary of the main
singularity types and corresponding asymptotic coefﬁcient forms of this chapter (bottom).
to essential singularities (in most of the remaining cases discussed in Chapter VIII);
recursive (context-free) constructions lead to square-root singularities. The surpris-
ing end result is that the asymptotic counting sequences from all of these generating
functions have one of just a few functional forms. This universality means that com-
parisons of methods, ﬁnding optimal values of parameters, and many other outgrowths
of analysis can be very effective in practical situations. Indeed, because of the nature
of the asymptotic forms, the results are often exceedingly accurate, as we have seen
repeatedly.
The general theory of coefﬁcient asymptotics based on singularities has many ap-
plications outside of analytic combinatorics (see the notes below). The broad reach of
the theory provides strong indications that universal laws hold for many combinatorial
constructions and schemas yet to be discovered.
The exp-log schema, like its companion, the supercritical-sequence schema, illustrates the
level of generality that can be attained by singularity analysis techniques. Reﬁnements of the
results we have given can be found in the book by Arratia, Barbour, and Tavar´e [16], which
develops a stochastic process approach to these questions; see also [15] by the same authors for
an accessible introduction.
The rest of the chapter deals in an essential manner with recursively deﬁned structures. As
noted repeatedly in the course of this chapter, this is often conducive to square-root singularity
and universal behaviours of the form n−3/2. Simple varieties of trees have been introduced
in an important paper of Meir and Moon [356], that bases itself on methods developed earlier
by P´olya [395, 397] and Otter [382]. One of the merits of [356] is to demonstrate that a high
level of generality is attainable when discussing properties of trees. A similar treatment can be
inﬂicted more generally to recursively deﬁned structures when their generating function satisﬁes

VII. 10. PERSPECTIVE
505
an implicit equation. In this way, nonplane unlabelled trees are shown to exhibit properties very
similar to their plane counterparts. It is of interest to note that some of the enumerative questions
in this area had been initially motivated by problems of theoretical chemistry: see the colourful
account of Cayley and Sylvester’s works in [54], the reference books by Harary–Palmer [259]
and Finch [165], as well as P´olya’s original studies [395, 397].
Algebraic functions are the modern counterpart of the study of curves by classical Greek
mathematicians. They are either approached by algebraic methods (this is the core of algebraic
geometry) or by transcendental methods. For our purposes, however, only rudiments of the
theory of curves are needed. For this, there exist several excellent introductory books, of which
we recommend the ones by Abhyankar [1], Fulton [223], and Kirwan [292]. On the algebraic
side, we have striven to provide an introduction to algebraic functions that requires minimal
apparatus. At the same time the emphasis has been put somewhat on algorithmic aspects, since
most algebraic models are nowadays likely to be treated with the help of computer algebra.
As regards symbolic computational aspects, we recommend the treatise by von zur Gathen and
J¨urgen [487] for background, while polynomial systems are excellently reviewed in the book
by Cox, Little, and O’Shea [104].
In the combinatorial domain, algebraic functions have been used early: in Euler and Seg-
ner’s enumeration of triangulations (1753) as well as in Schr¨oder’s famous “Vier combina-
torische Probleme” described by Stanley in [449, p. 177]. A major advance was the realization
by Chomsky and Sch¨utzenberger that algebraic functions are the “exact” counterpart of context-
free grammars and languages (see their historic paper [89]). A masterful summary of the early
theory appears in the proceedings edited by Berstel [45] while a modern and precise exposi-
tion forms the subject of Chapter 6 of Stanley’s book [449]. On the analytic-asymptotic side,
many researchers have long been aware of the power of Puiseux expansions in conjunction with
some version of singularity analysis (often in the form of the Darboux–P´olya method: see [397]
based on P´olya’s classic paper [395] of 1937). However, there appeared to be difﬁculties in cop-
ing with the fully general problem of algebraic coefﬁcient asymptotics [77, 361]. We believe
that Section VII. 7 sketches the ﬁrst complete theory (though most ingredients are of folklore
knowledge). In the case of positive systems, the “Drmota-Lalley-Woods” theorem is the key to
most problems encountered in practice—its importance should be clear from the developments
of Section VII. 6.
The applications of algebraic functions to context-free languages have been known for
some time (e.g., [174]). Our presentation of 1-dimensional walks of a general type follows
a recent article by Banderier and Flajolet [21], whch can be regarded as the analytic pendant
of algebraic studies by Gessel [231, 232]. The kernel method has its origins in problems of
queueing theory and random walks [158, 159] and is further explored in an article by Bousquet-
M´elou and Petkovˇsek [70]. The algebraic treatment of random maps by the quadratic method
is due to brilliant studies of Tutte in the 1960’s: see for instance his census [471] and the
account in the book by Jackson and Goulden [244]. A combinatorial-analytic treatment of
multiconnectivity issues is given in [22], where the possibility of treating in a uniﬁed manner
about a dozen families of maps appears clearly.
Regarding differential equations, an early (and at the time surprising) occurrence of terms
of the form nα, with α an algebraic number, in an asymptotic expansion is found in the
study [203], dedicated to multidimensional search trees. The asymptotic analysis of coefﬁ-
cients of solutions to linear differential equations can also, in principle, be approached from the
recurrences that these coefﬁcients satisfy. Wimp and Zeilberger [498] propose an interesting
approach based on results by George Birkhoff and his school (e.g., [57]), which are relative to

506
VII. APPLICATIONS OF SINGULARITY ANALYSIS
difference equations in the complex plane. There are however some doubts amongst special-
ists regarding the completeness of Birkhoff’s programme. By contrast, the (easier) singularity
theory of linear ODEs is well established, and, as we showed in this chapter, it is possible—
in the regular singular case at least—to base on it a sound method for asymptotic coefﬁcient
extraction.

VIII
Saddle Point Asymptotics
Like a lazy hiker, the path crosses the ridge at a low point;
but unlike the hiker, the best path takes the steepest ascent to the ridge.
[· · · ] The integral will then be concentrated in a small interval.
— DANIEL GREENE AND DONALD KNUTH [250, sec. 4.3.3]
Contents
VIII. 1.
Landscapes of analytic functions and saddle points
508
VIII. 2.
Saddle point bounds
512
VIII. 3.
Overview of the saddle point method
516
VIII. 4.
Three combinatorial examples
522
VIII. 5.
Admissibility
528
VIII. 6.
Integer partitions
540
VIII. 7.
Large powers
547
VIII. 8.
Saddle points and probability distributions
556
VIII. 9.
Multiple saddle points
558
VIII. 10.
Perspective
564
A saddle point of a surface is a point reminiscent of the inner part of a saddle or of a
geographical pass between two mountains. If the surface represents the modulus of an
analytic function, saddle points are simply determined as the zeros of the derivative of
the function.
In order to estimate complex integrals of an analytic function, it is often a good
strategy to adopt as contour of integration a curve that “crosses” one or several of
the saddle points of the integrand. When applied to integrals depending on a large
parameter, this strategy provides in many cases accurate asymptotic information. In
this book, we are primarily concerned with Cauchy integrals expressing coefﬁcients of
generating functions of large index. The implementation of the method is then fairly
simple, since integration can be performed along a circle centred at the origin.
The saddle point method can lead to accurate asymptotic estimates, including
complete asymptotic expansions. Its principle is to use a saddle point crossing path,
then estimate the integrand locally near this saddle point (where the modulus of the
integrand achieves its maximum on the contour), and deduce, by local approximations
and termwise integration, an asymptotic expansion of the integral itself. Some sort of
“localization” or “concentration” property is required to ensure that the contribution
near the saddle point captures the essential part of the integral. A simpliﬁed form of
the method provides what are known as saddle point bounds—these are useful and
507

508
VIII. SADDLE POINT ASYMPTOTICS
technically simple upper bounds obtained by applying trivial bounds to an integral
relative to a saddle point crossing path.
In the context of analytic combinatorics, the method applies well to Cauchy coef-
ﬁcient integr als, in the case of rapidly varying functions: typical instances are entire
functions as well as functions with singularities at a ﬁnite distance that exhibit some
form of exponential growth. Saddle point analysis then complements singularity anal-
ysis whose scope is essentially the category of functions having only moderate (i.e.,
polynomial) growth at their singularities. The saddle point method is also a method of
choice for the analysis of coefﬁcients of “large powers” of some ﬁxed function and,
in this context, it paves the way to the study of multivariate asymptotics and limiting
distributions developed in the next chapter.
Applications are given here to Stirling’s formula, as well as the asymptotics of
the central binomial coefﬁcients, the involution numbers and the Bell numbers asso-
ciated to set partitions. The asymptotic enumeration of integer partitions is one of the
jewels of classical analysis and we provide an introduction to this rich topic where
saddle points give access to effective estimates of an amazingly good quality. Other
combinatorial applications include balls-in-bins models and capacity, the number of
increasing subsequences in permutations, and blocks in set partitions. The counting
of acyclic graphs (equivalently forests of unrooted trees), takes us beyond the basic
paradigm of simple saddle points by making use of so-called “monkey saddles”.
The plan of this chapter is as follows. First, we examine the surface determined by the
modulus of an analytic function and give a classiﬁcation of points into three kinds: ordinary
points, zeros, and saddle points (Section VIII. 1). Next we develop general purpose saddle
point bounds in Section VIII. 2, which also serves to discuss the properties of saddle point
crossing paths. The saddle point method per se is presented in Section VIII. 3, both in its most
general form and in the way it specializes to Cauchy coefﬁcient integrals. Section VIII. 4 then
discusses three examples, involutions, set partitions, and fragmented permutations, which help
us get further familiarized with the method. We next jump to a new level of generality and in-
troduce in Section VIII. 5 the abstract concept of admissibility—this approach has the merit of
providing easily testable conditions, while opening the possibility of determining broad classes
of functions to which the saddle point method is applicable. In particular, many combinatorial
types whose leading construction is a SET operation are seen to be “automatically” amenable
to saddle point analysis. The case of integer partitions, which is technically more advanced,
is treated in a separate section, Section VIII. 6. The framework of “large powers”, developed
in Section VIII. 7 constitutes a combinatorial counterpart of the central limit theorem of proba-
bility theory, and as such it provides a bridge to the study of limit distributions in Chapter IX.
Other applications to discrete probability distributions are quickly examined in Section VIII. 8.
Finally, Section VIII. 9 serves as a brief introduction to the rich subject of multiple saddle points
and coalescence.
VIII. 1. Landscapes of analytic functions and saddle points
This section introduces a well-known classiﬁcation of points on the surface rep-
resenting the modulus of an analytic function. In particular, as we are going to see,

VIII. 1. LANDSCAPES OF ANALYTIC FUNCTIONS AND SADDLE POINTS
509
Ordinary point
Zero
Saddle point
                                                                                                                                                                                                                                                                                                

















                                                                                                                                                      









                                                                                                                                                








FIGURE VIII.1. The different types of points on a surface |f(z)|: an ordinary point, a
zero, a simple saddle point. Top: a diagram showing the local structure of level curves (in
solid lines), steepest descent lines (dashed with arrows pointing towards the direction of
increase) and regions (hashed) where the surface lies below the reference value |f(z0)|.
Bottom: the function f(z) = cosh z and the local shape of |f(z)| near an ordinary point
(iπ/4), a zero (iπ/2), and a saddle point (0), with level lines shown on the surfaces.
saddle points, which are determined by roots of the function’s derivative, are associ-
ated with a simple geometric property that gives them their name.
Consider any function f(z) analytic for z ∈Ω, where Ωis some domain of C. Its
modulus |f(x+iy)| can be regarded as a function of the two real quantities, x = ℜ(z)
and y = ℑ(z). As such, it can be represented as a surface in three dimensional space.
This surface is smooth (because analytic functions are inﬁnitely differentiable), but far
from being arbitrary.
Let z0 be an interior point of Ω. The local shape of the surface |f(z)| for z near
z0 depends on which of the initial elements in the sequence f(z0), f ′(z0), f ′′(z0), . . .,
vanish. As we are going to see, its points can be of only one of three types: ordinary
points (the generic case), zeros, and saddle points; see Figure 1. The classiﬁcation of
points is conveniently obtained by considering polar coordinates, writing z = z0 +
reiθ, with r small.
An ordinary point is such that f(z0) ̸= 0, f ′(z0) ̸= 0. This is clearly the generic
situation as analytic functions have only isolated zeros. In that case, one has for small
r > 0:
(1)
|f(z)| =
f(z0) + reiθf ′(z0) + O(r2)
 = |f(z0)|
1 + λrei(θ+φ) + O(r2)
 ,

510
VIII. SADDLE POINT ASYMPTOTICS
where we have set f ′(z0)/f(z0) = λeiφ. The modulus then satisﬁes
|f(z)| = |f(z0)|
 1 + λr cos(θ + φ) + O(r2)

.
Thus, for r kept small enough and ﬁxed, as θ varies, |f(z)| is maximum when θ = −φ
(where it is ∼1 + r), and minimum when θ = −φ + π (where it is ∼1 −r). When
θ = −φ ± π
2 , one has |f(z)| = |f(z0)| + o(r), which means that |f(z)| is essentially
constant. This is easily interpreted: the line θ ≡−φ (mod π) is (locally) a steepest
descent line; the perpendicular line θ ≡−φ + π
2 (mod π) is locally a level line.
In particular, near an ordinary point, the surface |f(z)| has neither a minimum nor a
maximum. In ﬁgurative terms, this is like standing on the ﬂank of a mountain.
A zero is by deﬁnition a point such that f(z0) = 0. In this case, the function |f(z)|
attains its minimum value 0 at z0. Locally, to ﬁrst order, one has |f(z)| ∼|f ′(z0)|r.
A zero is thus like a sink or the bottom of a lake, save that, in the landscape of an
analytic function, all lakes are at see level.
A saddle point is a point such that f(z0) ̸= 0, f ′(z0) = 0. It is said to be a simple
saddle point if furthermore f ′′(z0) ̸= 0. In that case, a calculation similar to (1),
(2)
|f(z)| =
f(z0) + 1
2r2e2iθf ′′(z0) + O(r3)
 = |f(z0)|
1 + λr2ei(2θ+φ) + O(r3)
 ,
where we have set 1
2f ′′(z0)/f(z0) = λeiφ, shows that the modulus satisﬁes
|f(z)| = |f(z0)|
 1 + λr2 cos(2θ + φ) + O(r3)

.
Thus, starting at the direction θ = −φ/2 and turning around z0, the following se-
quence of events regarding the modulus |f(z)| = |f(z)| is observed: it is maximal
(θ = −φ/2), stationary (θ = −φ/2 + π
2 ), minimal (θ = −φ/2 + π), stationary,
(θ = −φ/2 + 3π
2 ), maximal again (θ = −φ/2 + π), and so on. The pattern, symbol-
ically ‘+ = – =’, repeats itself twice. This is superﬁcially similar to an ordinary point,
save for the important fact that changes are observed at twice the angular speed. Ac-
cordingly, the shape of the surface looks quite different; it is like the central part of a
saddle. Two level curves cross at a right angle: one steepest descent line (away from
the saddle point) is perpendicular to another steepest descent line (towards the saddle
point). In a mountain landscape, this is thus much like a pass between two mountains.
The two regions on each side corresponding to points with an altitude below a simple
saddle point are often referred to as “valleys”.
Generally, a multiple saddle point has multiplicity p if f(z0) ̸= 0 and all deriva-
tives f ′(z0), . . . , f (p)(z0) are equal to zero while f (p+1)(z0) ̸= 0. In that case, the
basic pattern ‘+ = – =’ repeats itself p + 1 times. For instance, from a double saddle
point (p = 2), three roads go down to three different valleys separated by the ﬂanks of
three mountains. A double saddle point is also called a “monkey saddle” since it can
be visualized as a saddle having places for the legs and the tail: see Figure 11 (p. 559)
and Figure 13 (p. 562).
Theorem VIII.1 (Classiﬁcation of points on modulus surfaces). A surface |f(z)| at-
tached to the modulus of a function analytic over an open set Ωhas points of only

VIII. 1. LANDSCAPES OF ANALYTIC FUNCTIONS AND SADDLE POINTS
511
0.0
x
−1.0
−0.5
0.0
y
0.5
−1.0
−0.5
−1.5
1.0
FIGURE VIII.2. The “tripod”: two views of |1 + z + z2 + z3| as function of x = ℜ(z),
y = ℑ(z): (left) the modulus as a surface in R3; (right) the projection of level lines on
the z-plane.
three possible types: (i) ordinary points, (ii) zeros, (iii) saddle points. Under projec-
tion on the complex plane, a simple saddle point is locally the common apex of two
curvilinear sectors with angle π
2 , referred to as “valleys”, where the modulus of the
function is smaller than at the saddle point.
As a consequence, the surface deﬁned by the modulus of an analytic function has
no maximum: this property is known as the Maximum Modulus Principle. It has no
minimum either, apart from zeros. It is therefore a peakless landscape in de Bruijn’s
words [111]. Accordingly, for a meromorphic function, peaks are at ∞and minima
are at 0, the other points being either ordinary or saddle points.
EXAMPLE VIII.1. The tripod: a cubic polynomial. An idea of the typical shape of the surface
representing the modulus of an analytic function can be obtained by examining Figure 2 relative
to the third degree polynomial f(z) = 1 + z + z2 + z3. Since f(z) = (1 −z4)/(1 −z), the
zeros are at
−1,
i,
−i.
There are saddle points at its derivative has zeros at the zeros of the derivative f ′(z) = 1 +
2z + 3z2, that is, at the points
ζ := 1
3 + i
3
√
2,
ζ′ = 1
3 −i
3
√
2.
The diagram below summarizes the position of these “interesting” points:
(3)
−1 (zero)
i (zero)
−i (zero)
−1
3 −i
3
√
2 (saddle point)
−1
3 −i
3
√
2 (saddle point)
(0)

512
VIII. SADDLE POINT ASYMPTOTICS
The three zeros are especially noticeable on Figure 2 (left), where they appear at the end of the
three “legs”. The two saddle points are visible on Figure 2 (right) as intersection points of level
curves. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE VIII.1. □
 VIII.1. The Fundamental Theorem of Algebra. This theorem asserts that a polynomial has at
least one root (hence n roots if its degree is n). Let P(z) = 1+a1z +· · · anzn be a polynomial
of degree n. Consider f(z) = 1/P(z). By basic analysis, one can take R sufﬁciently large, so
that on |z| = R, one has |f(z)| < 1
2. Assume a contrario that P(z) has no zero. Then, f(z)
which is analytic in |z| ≤R should attain its maximum at an interior point (since f(0) = 1),
so that a contradiction has been reached.

 VIII.2. Saddle points of polynomials and the convex hull of zeros. Let P be a polynomial
and H the convex hull of its zeros. Then any root of P ′(z) lies in H. (Proof: assume distinct
zeros and consider
φ(z) := P ′(z)
P(z) =
X
α : P (α)=0
1
z −α.
If z lies outside H, then z sees all zeros α in a half-plane, this by elementary geometry. By
projection on the normal to the half plane boundary, there results that, for some θ, one has
ℜ(eiθφ(z)) < 0, so that P ′(z) ̸= 0.)

VIII. 2. Saddle point bounds
Saddle point analysis is a general method suited to the estimation of integrals of
analytic functions F(z),
(4)
I =
Z B
A
F(z) dz,
where F(z) ≡Fn(z) involves some large parameter n. The method is instrumental
when the integrand F is subject to rather violent variations, typically when there oc-
curs in it some exponential or some ﬁxed function raised to a large power n →+∞.
In this section, we discuss some of the global properties of saddle point contours, then
specialize the discussion to Cauchy coefﬁcient integrals. General bounds, known as
saddle point bounds, which are easy to derive, result from simple geometric consider-
ations.
Starting from the general form (4), we let C be a contour joining A and B and
taken in a domain of the complex plane where F(z) is analytic. By standard inequal-
ities, we have
(5)
|I| ≤||C|| · sup
z∈C
|F(z)|,
with ||C|| representing the length of C. This is the common trivial bound from integra-
tion theory applied to a ﬁxed contour C.
For an analytic integrand F with A and B inside the domain of analyticity, there
is an inﬁnite class P of acceptable paths to choose from, all in the analyticity domain
of F. Thus, by optimizing the bound (5), we may write
(6)
|I| ≤inf
C∈P

||C|| · sup
z∈C
|F(z)|

,

VIII. 2. SADDLE POINT BOUNDS
513
where the inﬁmum is taken over all paths C ∈P. Broadly speaking, a bound of this
type is called a saddle point bound1.
The length factor ||C|| usually turns out to be unimportant for asymptotic bound-
ing purposes—this is for instance the case when paths remain in ﬁnite regions of the
complex plane. If there happens to be a path C from A to B such that no point is
at an altitude higher than sup(|F(A)|, |F(B)|), then a simple bound results, namely,
|I| ≤||C||·sup(|F(A)|, |F(B)|): this is in a sense the uninteresting case. The common
situation, typical of Cauchy coefﬁcient integrals of combinatorics, is that paths have
to go at some higher altitude than the end points. A path C that traverses a saddle point
by connecting two points at a lower altitude on the surface |F(z)| and by following
two steepest descent lines across the saddle point is clearly a local minimum for the
path functional
Φ(C) = sup
z∈C
|F(z)|,
as neighbouring paths must possess a higher maximum. Such a path is called a saddle–
point path or steepest descent path. Then, the search for a path minimizing
inf
C

sup
z∈C
|F(z)|

(a simpliﬁcation of (6) to its essential feature) naturally leads to considering saddle
points and saddle-point paths. This leads to the variant of (6),
(7)
|I| ≤||C0|| · sup
z∈C0
|F(z)|,
C0 minimizes sup
z∈C
|F(z)|,
also referred to as a saddle point bound.
We can summarize this stage of the discussion by a simple generic statement.
Theorem VIII.2 (General saddle point bounds). Let F(z) be a function analytic in
a domain Ω. Consider the class of integral
R
γ F(z) dz where the contour γ connects
two points A, B and is constrained to a class P of allowable paths in Ω(e.g., the ones
that encircle 0). Then one has the saddle point bounds2:
(8)

Z
γ
F(z) dz

≤
||C0|| · sup
z∈C0
|F(z)|,
where C0 is any path that minimizes sup
z∈C
|F(z)|.
If A and B lie in opposite valleys of a saddle point z0, then the minimization problem
is solved by saddle point paths C0 made of arcs connecting A to B through z0.
Borrowing a metaphor of de Bruijn [111], the situation may be described as fol-
lows. Estimating a path integral is like estimating the difference of altitude between
two villages in a mountain range. If the two villages are in different valleys, the best
strategy (this is what road networks often do) consists in following paths that cross
boundaries between valleys at passes, i.e., through saddle points.
1Notice additionally that the optimization problem need not be solved exactly, as any approximate
solution to (6) still furnishes a valid upper bound because of the universal character of the trivial bound (5).
2The form given by (8) is in principle weaker than the form (6), since it does not take into account the
length of the contour itself, but the difference is immaterial in practically all our asymptotic problems.

514
VIII. SADDLE POINT ASYMPTOTICS
The statement of Theorem VIII.2 does no ﬁx all details of the contour, when
there are several saddle points “separating” A and B—the problem is like ﬁnding the
most economical route across a whole mountain range. But at least its suggests the
construction of a composite contour made of connected arcs crossing saddle points
from valley to valley. Furthermore, in cases of combinatorial interest some strong
positivity is present and the selection of the suitable saddle point contour is normally
greatly simpliﬁed, as we explain next.
 VIII.3. An integral of powers. Consider the polynomial P(z) = 1+z+z2+z3 of Example 1.
Deﬁne the line integral
In =
Z +i
−1
P(z)n dz.
On the segment connecting the end point, the maximum of |P(z)| is 0.63831, giving the weak
trivial bound In = O(0.63831n). In contrast, there is a saddle point at ζ = 1
3 + i
3
√
2 where
|P(ζ)| = 1
3, resulting in the bound
|In| ≤λ
„1
3
«n
,
λ := |ζ + 1| + |i −ζ| .= 1.44141,
as follows from adopting a contour made of two segments connecting −1 to i through ζ. Discuss
further the bounds on
R α′
α , when (α, α′) ranges over all pairs of roots of P.

Saddle point bounds for Cauchy coefﬁcient integrals. Saddle point bounds can
be applied to Cauchy coefﬁcient integrals,
(9)
gn ≡[zn]G(z) =
1
2iπ
I
G(z)
dz
zn+1 ,
for which we can avail ourselves of the previous discussion, with Fn(z) = G(z)z−n−1.
In (9) the symbol
H
indicates that the allowable paths are constrained to encircle the
origin (the domain of deﬁnition of the integrand is a subset of C\{0}; the points A, B
can then be seen as coinciding and taken somewhere along the negative real line).
In the particular case where G(z) is a function with nonnegativecoefﬁcients, there
is usually a saddle point on the positive real axis. Indeed, assume that G(z), which has
radius of convergenceR with 0 < R ≤+∞, satisﬁes G(x) →+∞as x →R−. Then
the integrand F(z) := G(z)z−n−1 satisﬁes F(0+) = F(R−) = +∞. This means
that there exists at least one local minimum, hence, at least one positive value ζ such
that the derivative F ′(x) of the real function F(x) vanishes in (0, R). (Actually, there
can be only one such point; see Note 4, p. 516.) But this point ζ is also a derivative
of the complex function F(z). Since ζ is a local minimum, we have additionally
F ′′(ζ) < 0, and the saddle point is crossed transversally by a circle of radius ζ. Thus,
the saddle point bound, specialized to circles centred at the origin, becomes:
Corollary VIII.1 (Saddle point bounds for generating functions). Let G(z) be ana-
lytic at 0 with nonnegative coefﬁcients and radius of convergence R ≤+∞. Assume
that G(R−) = +∞. Then one has
(10)
[zn]G(z) ≤G(ζ)
ζn ,
with ζ ∈(0, R) the unique root of ζ G′(ζ)
G(ζ) = n + 1.

VIII. 2. SADDLE POINT BOUNDS
515
FIGURE VIII.3. The modulus of the integrands of Jn (central binomials) and Kn (in-
verse factorials) for n = 5 and the corresponding saddle point contours.
This corollary is very similar to Proposition IV.1, p. 233, on which it sheds a new
light, while paving the way to the full saddle-point method to be developed in the next
section.
We examine below two particular cases related to the central binomial and the
inverse factorial. The corresponding landscapes in Figure 3 which bear a surprising
resemblance to one another are, by the previous discussion, instances of a general
pattern for functions with nonnegative coefﬁcients. It is seen on these two examples
that the saddle point bounds already catch the proper exponential growths, being off
only by a factor of O(n−1/2).
EXAMPLE VIII.2. Saddle point bounds for central binomials and inverse factorials. Consider
the two contour integrals around the origin,
(11)
Jn =
1
2iπ
I
(1 + z)2n
dz
zn+1 ,
Kn =
1
2iπ
I
ez
dz
zn+1 ,
whose values are otherwise known, by virtue of Cauchy’s coefﬁcient formula, to be Jn =
`2n
n
´
and Kn = 1/n!. In that case, one can think of the end points A and B as coinciding and taken
somewhat arbitrarily on the negative real axis, while the contour has to encircle the origin once
and counter-clockwise.
The landscapes of the two integrands are represented on Figure 3. The saddle point equa-
tions are respectively
2n
1 + z −n + 1
z
= 0,
1 −n + 1
z
= 0,

516
VIII. SADDLE POINT ASYMPTOTICS
the corresponding saddle points being ζ = n + 1
n −1 and ζ′ = n + 1. This provides the upper
bounds
(12)
Jn =
 
2n
n
!
≤
„ 4n2
n2 −1
«n
≤4
94n,
Kn = 1
n! ≤
en+1
(n + 1)n ,
which are valid for all values n ≥2. . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE VIII.2. □
 VIII.4.Upward convexity of G(x)x−n. For G(z) having nonnegative coefﬁcients at the
origin, the quantity G(x)x−n is upward convex for x > 0, so that the saddle point equation for
ζ can have at most one root. Indeed, the second derivative
(13)
d2
dx2
G(x)
xn
= x2G′′(x) −2nxG′(x) + n(n + 1)G(x)
xn+2
,
is positive for x > 0 since its numerator,
X
k≥0
(n + 1 −k)(n −k)gkxk,
gk := [zk]G(z),
has only nonnegative coefﬁcients. (See Note IV.44, p. 266, for an alternative derivation.)

 VIII.5. A minor optimization. The bounds of Eq. (6), p. 512, which take the length of the
contour into account, lead to estimates that closely resemble Eq. (10). Indeed, we have
[zn]G(z) ≤G(ζ)
ζ
n ,
ζ root of ζ G′(ζ)
G(ζ)
= n,
when optimization is carried out over circles centred at the origin.

VIII. 3. Overview of the saddle point method
Given a complex integral with a contour traversing a simple saddle point, the
saddle point corresponds locally to a maximum of the integrand along the path. It is
then natural to expect that a small neighbourhood of the saddle point might provide the
dominant contribution to the integral. The saddle point method is applicable precisely
when this is the case and when this dominant contribution can be estimated by means
of local expansions. The method then constitutes the complex-analytic counterpart of
the method of Laplace (APPENDIX B: Laplace’s method, p. 700) for the evaluation of
real integrals depending on a large parameter, and we can regard it as being
Saddle Point Method = Choice of Contour + Laplace’s Method.
Like its real-variable counterpart, the saddle point method is a general strategy rather
than a completely deterministic algorithm, since many choices are left open in the
implementation of the method concerning details of the contour and choices of its
splitting into pieces.
To proceed, it is convenient to set F(z) = ef(z) and consider
(14)
I =
Z B
A
ef(z) dz,
where f(z) ≡fn(z), like F(z) ≡Fn(z), involves some large parameter n. Follow-
ing possibly some preparation based on Cauchy’s theorem, we may assume that the

VIII. 3. OVERVIEW OF THE SADDLE POINT METHOD
517
Goal: Estimate
Z B
A
F(z) dz, setting F = ef.
— A contour C through a saddle point ζ such that f ′(ζ) = 0 has been chosen.
— The contour is split as C = C(0) ∪C(1).
The following conditions are to be veriﬁed.
SP1: Tails pruning. On the contour C(1), the tails integral
R
C(1) is negligible:
Z
C(1) F(z) dz = o
„Z
C
F(z) dz
«
.
SP2: Central approximation. Along C(0), a quadratic expansion,
f(z) = f(ζ) + 1
2f ′′(ζ)(z −ζ) + O(ηn),
is valid, with ηn →0 as n →∞, uniformly with respect to z ∈C(0).
SP3: Tails completion. The incomplete Gaussian integral taken over the central range is asymp-
totically equivalent to a complete Gaussian integral (with ǫ = ±1):
Z
C(0) e
1
2 f′′(ζ)(z−ζ)2 dz ∼εi
Z ∞
−∞
e−|f′′(ζ)|x2/2 dx ≡εi
s
2π
|f ′′(ζ)|.
Result: Assuming SP1, SP2, and SP3, one has, with ε = ±1:
1
2iπ
Z B
A
ef(z) dz ∼ε
ef(ζ)
p
2π|f ′′(ζ)|
.
FIGURE VIII.4.
The saddle point strategy.
contour C connects two end points A and B lying in opposite valleys of the saddle
point ζ. The saddle point equation is F ′(ζ) = 0, or equivalently since F = ef:
f ′(ζ) = 0.
The saddle point method, of which a summary is given in Figure 4, is based on
a fundamental splitting of the integration contour. We decompose C = C(0) ∪C(1),
where C(0) called the “central part” contains ζ (or passes very near to it) and C(1)
is formed of the two remaining “tails”. This splitting has to be determined in each
case in accordance with the growth of the integrand. The basic principle rests on two
major conditions: the contributions of the two tails should be asymptotically negligible
(condition SP1); in the central region, the quantity f(z) in the integrand should be
asymptotically well approximated by a quadratic function (condition SP2). Under
these conditions, the integral is asymptotically equivalent to an incomplete Gaussian
integral. It then sufﬁces to verify—this is condition SP3, usually a minor a posteriori
technical veriﬁcation—that tails can be completed back, introducing only negligible
error terms. By this sequence of steps, the original integral is asymptotically reduced
to a complete Gaussian integral, which evaluates in closed form.
Speciﬁcally, the three steps of the saddle method involve checking conditions
expressed by Equations (15), (16), and (18) below.

518
VIII. SADDLE POINT ASYMPTOTICS
SP1: Tails pruning. On the contour C(1), the tail integral
R
C(1) is negligible:
(15)
Z
C(1) F(z) dz = o
Z
C
F(z) dz

.
This condition is usually established by proving that F(z) remains small enough (e.g.,
exponentially small in the scale of the problem) away from ζ, for z ∈C(1).
SP2: Central approximation. Along C(0), a quadratic expansion,
(16)
f(z) = f(ζ) + 1
2f ′′(ζ)(z −ζ) + O(ηn),
is valid, with ηn →0 as n →∞, uniformly for z ∈C(0). This guarantees that
R
ef is
well-approximated by an incomplete Gaussian integral:
(17)
Z
C(0) ef(z) dz ∼ef(ζ)
Z
C(0) e
1
2 f ′′(ζ)(z−ζ)2 dz.
SP3: Tails completion. The tails can be completed back, at the expense of asymp-
totically negligible terms, meaning that the incomplete Gaussian integral is asymptot-
ically equivalent to a complete one,
(18)
Z
C(0) e
1
2 f ′′(ζ)(z−ζ)2 dz ∼εi
Z ∞
−∞
e−|f ′′(ζ)|x2/2 dx ≡εi
s
2π
|f ′′(ζ)|.
where ε = ±1 is determined by the orientation of the original contour C. This last step
deserves a word of explanation. Along a steepest descent curve across ζ, the quantity
f ′′(ζ)(z−ζ)2 is real and negative, as we saw when discussing saddle point landscapes.
Indeed, if f ′′(ζ) = eiφ|f ′′(ζ)|, one has arg(z −ζ) ≡−φ (mod π). Thus, the change
of variables x = ±i(z −ζ)eiφ/2 reduces the left side of (18) to an integral taken along
(or close to) the real line. The condition (18) then demands that this integral can be
completed to a complete Gaussian integral, which itself evaluates in closed form.
If these conditions are granted, one has the chain
Z
C
ef dz ∼
Z
C(0) ef dz ∼ef(ζ)
Z
C(0) e
1
2 f ′′(ζ)(z−ζ) dz ∼±ief(ζ)
s
2π
|f ′′(ζ),
by virtue of Equations (15), (17), (18). In summary:
Theorem VIII.3 (Saddle Point Algorithm). Consider an integral R B
A F(z) dz, where
the integrand F = ef is an analytic function depending on a large parameter and
A, B lie in opposite valleys across a saddle point ζ, which is a root of the saddle point
equation
f ′(ζ) = 0,
or, equivalently, F ′(ζ) = 0. Assume that the contour C connecting A to B can be split
into C = C(0) ∪C(1) in such a way that the following conditions are satisﬁed:
(i) tails are negligible, in the sense of Equation (15) of SP1,
(ii) a central approximation hold, in the sense of Equation (16) of SP2,
(iii) tails can be completed back, in the sense of Equation (18) of SP3.

VIII. 3. OVERVIEW OF THE SADDLE POINT METHOD
519
Then one has, with ε ∈{−1 + 1} reﬂecting orientation:
(19)
1
2iπ
Z B
A
ef(z) dz ∼ε
ef(ζ)
p
2π|f ′′(ζ)|
.
It can be veriﬁed at once that a blind application of the formula to the two integrals
of Example 19 produces the correct asymptotic estimates
(20)
Jn ≡
2n
n

∼
4n
√πn
and
Kn ≡1
n! ∼
1
nne−n√
2πn.
The complete justiﬁcation in the case of Kn is given in Example 3 below. The case
of Jn is treated by the general theory of “large powers” of Section VIII. 7, p. 547.
In order for the saddle point method to work, conﬂicting requirements regard-
ing the dimensioning of C(0) and C(1) must be satisﬁed. The tails pruning and tails
completion conditions, SP1 and SP3, force C(0) to be chosen large enough, so as
to capture the main contribution to the integral; the central approximation condition
SP2 requires C(0) to be small enough, to the effect that f(z) can be suitably reduced
to its quadratic expansion. Usually, one has to take ||C(0)||/||C|| →0, and the following
observation may help make the right choices. The error in the two-term expansion be-
ing likely given by the next term, which involves a third derivative, it is a good guess
to dimension C(0) so that it be of length δ ≡δ(n) chosen in such a way that
(21)
f ′′(ζ)δ2 →∞,
f ′′′(ζ)δ3 →0,
so that both tail and central approximation conditions can be satisﬁed. We call this
choice the saddle point dimensioning heuristic.
On another register, it often proves convenient to adopt integration paths that
come close enough to the saddle point but need not pass exactly through it. In the same
vein, a steepest descent curve may be followed only approximately. Such choices
will still lead to valid conclusions, as long as the conditions of Theorem VIII.3 are
veriﬁed. (Note carefully that these conditions neither impose that the contour should
pass strictly through the saddle point, nor that a steepest descent curve should be
exactly followed.)
Saddle point method for Cauchy coefﬁcient integrals. For the purposes of an-
alytic combinatorics, the general saddle point method specializes. We are given a
generating function G(z), assumed to be analytic at the origin and with nonnegative
coefﬁcients, and seek an asymptotic form of the coefﬁcients, given in integral form by
[zn]G(z) =
1
2iπ
Z
C
G(z) dz
zn+1 .
There, C encircles the origin, lies within the domain where G is analytic, and is posi-
tively oriented. This is a particular case of the general integral (14) considered earlier,
with the integrand being now F(z) = G(z)z−n−1.
The geometry of the problem is simple, and, for reasons seen in the previous
section, it sufﬁces to consider as integration contour a circle centred at the origin and

520
VIII. SADDLE POINT ASYMPTOTICS
passing through (or very near) a saddle point present on the positive real line. It is
then natural to make use of polar coordinates and set
z = reiθ,
where the radius r of the circle is chosen equal to (or close to) the saddle point value ζ.
Under the circumstances, the basic split of the contour C = C(0) ∪C(1) involves
a central part C(0), which is an arc of the circle of radius r determined by |θ| ≤θ0 for
some suitably chosen θ0. On C(0), a quadratic approximation should hold, according
to SP2 [central approximation]. On the rest C(1) of the contour the function G(z)
should be small in comparison to its value G(r), according to SP1 [tails pruning].
(Observe that |z−n−1| remains constant along any circle centred at the origin.) The
choice of the angle θ0 often turns out to be successful, when one follows the dimen-
sioning heuristic of (21). In this range of problems, checking the condition SP3 [tail
completion] is normally a mere formality.
The example below details the main steps of the saddle point analysis of inverse
factorials, based on the foregoing principles.
EXAMPLE VIII.3. Saddle point analysis of the exponential and the inverse factorial. The goal
is to estimate
1
n! = [zn]ez, the starting point being
Kn =
1
2iπ
Z
|z|=r
ez
dz
zn+1 ,
where integration is performed along a circle of radius r. The landscape of the modulus of the
integrand has been already displayed in Figure 3, p. 515—there is a saddle point of G(z)z−n−1
at ζ = n + 1 with an axis perpendicular to the real line. We thus expect an asymptotic estimate
to derive from adopting a circle passing though the saddle point, or about. In our treatment, we
ﬁx the choice r = n, by which calculations develop somewhat more smoothly.
We switch to polar coordinates and set z = neiθ. The original integral becomes, in polar
coordinates,
(22)
Kn = en
nn · 1
2π
Z +π
−π
en(eiθ−1−iθ) dθ,
where, for readability, we have taken out the factor G(r)/rn ≡en/nn. Set h(θ) = eiθ−1−iθ.
The function |eh(θ)| = ecos θ−1 is unimodal with its peak at θ = 0 and the same property holds
for |enh(θ)|, representing the modulus of the integrand in (22), which gets more and more
strongly peaked at θ = 0, as n →+∞; see Figure 5.
In agreement with the saddle point strategy, the estimation of Kn proceeds by isolating a
small portion of the contour, corresponding to z near the real axis. We thus introduce
K(0)
n
=
Z +θ0
−θ0
enh(θ) dθ,
K(1)
n
=
Z 2π−θ0
θ0
enh(θ) dθ,
and choose θ0 in accordance with the general heuristic of Equation (21), which instantiates to
the two conditions nθ2
0 →∞, and nθ3
0 →0 . One way of realizing the compromise is to adopt
θ0 = na, where a is any number between −1
2 and −1
3. We hence ﬁx, rather arbitrarily,
(23)
θ0 ≡θ0(n) = n−2/5.
In particular, the angle of the central region tends to zero.

VIII. 3. OVERVIEW OF THE SADDLE POINT METHOD
521
FIGURE VIII.5. Plots of |ezz−n−1| for n = 3 and n = 30 (scaled according to the
value of the saddle point) illustrate the essential concentration condition as higher values
of n produce steeper saddle point paths.
(i) Tails pruning. For z = neiθ one has |ez| = en cos θ, and, by unimodality properties of
the cosine, the tail integral K(1) satisﬁes
(24)
˛˛˛K(1)
n
˛˛˛ = O
“
e−n cos θ0”
= O
“
exp
“
−Cn1/5””
,
for some C > 0. The tail integral is thus is exponentially small.
(ii) Central approximation. Near θ = 0, one has h(θ) ≡eiθ −1 −iθ = −1
2θ2 + O(θ3),
so that, for |θ| ≤θ0,
enh(θ) = e−nθ2/2 `
1 + O(nθ3
0)
´
.
Since θ0 = n−2/5, we have
(25)
K(0)
n
=
Z +n−2/5
−n−2/5 e−nθ2/2 dθ
“
1 + O(n−1/5)
”
,
which, by the change of variables t = θ√n, is conveniently rewritten as
(26)
K(0)
n
=
1
√n
Z +n1/10
−n1/10 e−t2/2 dt
“
1 + O(n−1/5)
”
.
The central integral is thus asymptotic to an incomplete Gaussian integral.
(iii) Tails completion. Given (26), the task is now easy. We have, elementarily, for a > 0,
(27)
Z +∞
a
e−t2/2 dt = O
“
e−a2/2”
,
which expresses the exponential smallness of Gaussian tails. As a consequence,
(28)
K(0)
n
∼
1
√n
Z +∞
−∞
e−t2/2 dt ≡
r
2π
n .
Assembling (24) and (28), we obtain
K(0)
n
+ K(1)
n
∼
r
2π
n ,
i.e.,
Kn = 1
2π
en
nn
“
K(0)
n
+ K(1)
n
”
∼
en
nn√
2πn
.
The proof also provides a relative error term of O(n−1/5). Stirling’s formula is thus seen to be
(inter alia!) a consequence the saddle point method. . . . . . . . . . END OF EXAMPLE VIII.3. □

522
VIII. SADDLE POINT ASYMPTOTICS
Complete asymptotic expansions. Just like Laplace’s method, the saddle point
method can be made to provide full asymptotic expansions. The idea is still to localize
the main contribution in the central region, but now take into account corrections terms
to the quadratic approximation. As an illustration of these general principles, we make
explicit here the calculations relative to the inverse factorial.
It sufﬁces to revisit the estimation of K(0) since K(1) is exponentially small. One
ﬁrst rewrites
K(0)
n
=
Z θ0
−θ0
e−nθ2/2en(cos θ−1−1
2 θ2) dθ
=
1
√n
Z θ0
√n
−θ0
√n
e−w2/2enξ(w/√n) dw,
ξ(θ) := cos θ −1 −1
2θ2.
The calculation proceeds exactly in the same way as for the Laplace method (APPEN-
DIX B: Laplace’s method, p. 700). It sufﬁces to expand h(θ) to any ﬁxed order, which
is legitimate in the central region. In this way, a representation of the form,
K(0)
n
=
1
√n
Z θ0
√n
−θ0
√n
e−w2/2
 
1 +
M−1
X
k=1
Ek(w)
nk/2
+ O
1 + w3M
nM/2
!
dw,
is obtained, where the Ek(w) are computable polynomials of degree 3k. Distributing
the integral operator over terms in the asymptotic expansion and completing the tails
yields an expansion of the form
K(0)
n
∼
1
√n
 M−1
X
k=0
dk
nk/2 + O(n−M/2)
!
,
where d0 =
√
2π,
dk :=
Z +∞
−∞
e−w2/2Ek(w) dw.
All odd terms disappear by parity. The net result is then:
Proposition VIII.1 (Stirling’s formula). The factorial numbers satisfy
1
n! ∼enn−n
√
2πn

1 −
1
12n +
1
288 n2 +
139
51840 n3 −
571
2488320 n4 + · · ·

.
Notice the amazing similarity with the form obtained directly for n! in APPEN-
DIX B: Laplace’s method, p. 700.
 VIII.6. A factorial surprise. Why is it that the expansion of n! and 1/n! involve the same
set of coefﬁcients, up to sign?

VIII. 4. Three combinatorial examples
The saddle point method gives access to a number of asymptotic problems coming
from analytic combinatorics. In this section, we further illustrate its use by treating in
some detail3 three combinatorial examples:
3The purpose of these examples is to get some familiarity with the practice of the saddle point method
in analytic combinatorics. The impatient reader can jump directly to the next section, where she will ﬁnd a
general theory that covers these and many more cases.

VIII. 4. THREE COMBINATORIAL EXAMPLES
523
Involutions (I), Set partitions (S), Fragmented permutations (F).
These are all labelled structures introduced in Chapter II. Their speciﬁcations and
EGFs are
(29)



Involutions :
I = SET(SET1,2(Z))
=⇒
I(z) = ez+z2/2
Set Partition :
S = SET(SET≥1(Z))
=⇒
S(z) = eez−1
Fragmented perms :
F = SET(SEQ≥1(Z))
=⇒
F(z) = ez/(1−z).
The ﬁrst two are entire functions (i.e., they only have a singularity at ∞), while the
last one has a singularity at z = 1. Each of these functions exhibits a fairly vio-
lent growth—of an exponential type—near its positive singularity, at either a ﬁnite or
inﬁnite distance. As the reader will have noticed, all three combinatorial types are
structurally characterized by a set construction applied to some simpler structure.
Each example is treated, starting from the easier saddle point bounds and pro-
ceeding with the saddle point method. The procedure, which follows the treatment of
the function ez, is rather systematic. For Cauchy coefﬁcient integrals, the saddle point
is best carried out in polar coordinates, which calls for evaluating
(30)
[zn]G(z) =
1
2iπ
I
G(z)
dz
zn+1 = G(r)r−n
2π
Z +π
−π
G(reiθ)e−niθ dθ.
Under the trigonometrical form, it is seen that the best bound of type (6) is
(31)
[zn]G(z) ≤G(r)
rn ,
where
rG′(r)
G(r) = n.
We shall also refer to the equation deﬁning r as the saddle point equation. (The
bound (31) is almost the same as the bound provided by Theorem VIII.2, which is
G(ζ)ζ−n−1, where ζG′(ζ)/G(ζ) = n + 1.) Setting
(32)
f(z) := log G(z) −n log z
we see that, locally, a quadratic approximation without linear terms holds, namely,
with β(r) a computable quantity (in terms of f(r), f ′(r), f ′′(r))
(33)
f(reiθ) −f(r) = −1
2β(r)θ2 + o(θ3),
for ﬁxed r (i.e., ﬁxed n), as θ →0.
It then sufﬁces to choose a cutoff angle θ0, then carry out a veriﬁcation of the
validity of the three conditions of the saddle point method, SP1, SP2, and SP3 of
Theorem VIII.3, p. 518, adjusted to take into account polar coordinate notations. The
cutoff angle θ0 is chosen as a function of n (or, equivalently, r) in accordance with the
saddle point heuristic (21).
The example of involutions treats a problem that is only a little more complicated
than inverse factorials. The case of set partitions (Bell numbers) illustrates the need in
general of a good asymptotic technology for implicitly deﬁned saddle points. Finally,
fragmented permutations, with their singularity at a ﬁnite distance, pave the way for
the (harder) analysis of integer partitions in Section VIII.6.

524
VIII. SADDLE POINT ASYMPTOTICS
EXAMPLE VIII.4. Involutions. A permutation τ such that τ 2 is the identity is an involution
(p. 113). The corresponding EGF is I(z) = ez+z2/2. We have in the notation of (32)
f(z) = z + z2
2 −n log z,
and the saddle point equation is
r(1 + r) = n,
implying
r = −1
2 + 1
2
√
4n + 1 ∼√n −1
2 +
1
8√n + O(n−3/2).
The use of the saddle point bound (31) then gives mechanically
(34)
In
n! ≤e−1/4 en/2+√n
nn/2
(1 + o(1)),
In ≤e−1/4√
2πne−n/2+√nn−n/2(1 + o(1)).
(Notice that if we use instead the approximate saddle point value, √n, we only lose a factor
e−1/4 .= 0.77880.)
The cutoff point between the central and noncentral regions is determined, in agreement
with (21), by the fact that the length δ of the contour (in z coordinates) should satisfy f ′′(r)δ2 →
∞and f ′′′(r)δ3 →0. In terms of angles, this means that we should use a cutoff angle θ0 that
satisﬁes
r2f ′′(r)θ2
0 →∞,
r3f ′′′(r)θ3
0 →0.
Here, we have f ′′(r) = O(1) and f ′′′(r) = O(n−1/2). Thus, θ0 should be chosen of an order
somewhere in between n−1/2 and n−1/3, and we ﬁx here
θ0 = n−2/5.
(i) Tails pruning. First, some general considerations are in order regarding the behaviour
of |I(z)| along large circles, z = reiθ. One has
log |I(reiθ)| = r cos θ + r2
2 cos 2θ.
As a function of θ, this function decreases on (0, π
2 ) as it is the sum of two decreasing functions.
Thus, |I(z)| attains its maximum (er+r2/2) at r and its minimum (e−r2/2) at z = ri. In the
left half plane, ﬁrst for θ ∈( π
2 , 3π
4 ), the modulus |I(z)| is at most er since cos 2θ < 0. Finally,
for θ ∈( 3π
4 , π) smallness is granted by the fact that cos θ < −1/
√
2 resulting in the bound
|I(z)| ≤er2/2−r/
√
2. The same argument applies to the lower half plane ℑ(z) < 0. As
a consequence of these bounds, I(z)/I(√n) is strongly peaked at z = r; in particular, it is
exponentially small away from the positive real axis, in the sense that
(35)
I(reiθ)
I(r)
= O
„I(reiθ0)
I(r)
«
= O (exp(−nα)) ,
θ ̸∈[−θ0, θ0],
for some α > 0.
(ii) Central approximation. We then proceed and consider the central integral
J(0)
n
= ef(r)
2π
Z +θ0
−θ0
exp
“
f(reiθ) −f(r)
”
dθ.
What is required is a Taylor expansion with remainder near the point r ∼√n. In the central
region, the relations f ′(r) = 0 f ′′(r) = 2 + O(1/n), and f ′′′(z) = O(n−1/2) yield
f(reiθ) −f(r) = r2
2 f ′′(r)(eiθ −1)2 + O
“
n−1/2r3θ3
0
”
= −r2θ2 + O(n−1/5).

VIII. 4. THREE COMBINATORIAL EXAMPLES
525
This is enough to guarantee that
(36)
J(0)
n
= ef(r)
2π
Z +θ0
−θ0
e−r2θ2 dθ
“
1 + O(n−1/5)
”
.
(iii) Tails completion. Since r ∼√n and θ0 = n−2/5, we have
(37)
Z +θ0
−θ0
e−r2θ2 dθ = 1
r
Z +θ0r
−θ0r
e−t2 dt =
1
√r
„Z +∞
−∞
e−t2 dt + O
“
e−n1/5”«
.
Finally, Equations (35), (36), and (37) give:
Proposition VIII.2. The number In of involutions satisﬁes
(38)
In
n! = e−1/4
2√πnn−n/2en/2+√n
„
1 + O(
1
n1/5 )
«
.
Comparing the saddle point bound (34) to the true asymptotic form (38), we see that the
former is only off by a factor of O(n1/2). Here is a table further comparing the asymptotic
estimate I◦
n provided by the right side of (38) to the exact value of In:
n = 10
n = 100
n = 1000
I10 = 9496
I100 = 2.40533 · 1082
I1000 = 2.14392 · 101296
I◦
10 = 8839
I◦
100 = 2.34149 · 1082
I◦
1000 = 2.12473 · 101296.
The relative error is empirically close to 0.3/√n, a fact that could be proved by developing a
complete asymptotic expansion along the lines exposed in the previous section, p. 522.
The estimate (38) of In is given by Knuth in [302], whose derivation is carried out by
means of the Laplace method applied to the binomial sum that expresses In. Our derivation
here follows Moser and Wyman’s in [367].
. . . . . . . . . . . . . . . . . END OF EXAMPLE VIII.4. □
EXAMPLE VIII.5.
Set partitions and Bell numbers. The number of partitions of a set of n
elements deﬁnes the Bell number Sn (p. 100) and one has
Sn = n!e−1[zn]G(z)
where
G(z) = eez.
The saddle point equation relative to G(z)z−n−1 is
ζeζ = n + 1.
This famous equation admits an asymptotic solution obtained by iteration (or “bootstrapping”):
it sufﬁces to write ζ = log(n+1)−log ζ, and iterate (say, starting from ζ = 1), which provides
the solution,
(39)
ζ ≡ζ(n) = log n −log log n + log log n
log n
+ O
„log2 log n
log2 n
«
(see [111, p. 26] for a detailed discussion). The corresponding saddle point bound reads
Sn ≤n!eeζ−1
ζn
.
The approximate solution bζ = log n provides in particular the simpliﬁed upper bound
Sn ≤n!
en−1
(log n)n .
which is enough to check that there are much fewer set partitions than permutations, the ratio
being bounded from above by a quantity e−n log log n+O(n).

526
VIII. SADDLE POINT ASYMPTOTICS
In order to implement the saddle point strategy, integration will be carried out over a circle
of radius r = ζ. We then set
f(z) = log
„G(z)
zn+1
«
= ez −(n + 1) log z,
and proceed to estimate the integral,
Jn =
1
2iπ
Z
γ
G(z)
dz
zn+1 ,
along the circle γ of radius r. The usual saddle point heuristic suggests to deﬁne the range of
the saddle point by a quantity θ0 ≡θ0(n) such that the quadratic terms in the expansion of h
at r tend to inﬁnity, while the cubic terms tend to zero. In order to carry out the calculations,
it is convenient to express all quantities in terms of r alone, which is possible since n can be
disposed of by means of the relation n + 1 = rer. We ﬁnd:
f ′′(r) = er(1 + r−1),
f ′′′(r) = er(1 −2r2).
Thus, θ0 should be chosen such that r2erθ2
0 →∞, r3erθ3
0 →0, and the choice rθ0 = e−2r/5
is suitable.
(i) Tails pruning. First, observe that the function G(z) is strongly concentrated near the
real axis since, with z = reiθ, there holds
(40)
|ez| = er cos θ,
˛˛˛eez˛˛˛ ≤eer cos θ.
In particular G(reiθ) is exponentially smaller than G(r) for any ﬁxed θ ̸= 0, when r gets large.
(ii) Central approximation. One then considers the central contribution,
J(0)
n
:=
1
2iπ
Z
γ0
G(z)
dz
zn+1 ,
where γ0 is the part of the circle z = reiθ such that |θ| ≤θ0 ≡e−2r/5r−1. Since on γ0, the
third derivative is uniformly O(er), one has there
f(reiθ) = f(r) −1
2r2θ2f ′′(r) + O(r3θ3er).
This approximation can then be transported into the integral J(0)
n .
(iii) Tails completion. Tails can be completed in the usual way. The net effect is the
estimate
[zn]G(z) =
ef(r)
p
2πf ′′(r)
`
1 + O
`
r3θ3er´´
,
which, upon making the error term explicit rephrases, as follows.
Proposition VIII.3. The number Sn of set partitions of size n satisﬁes
(41)
Sn = n!
eeζ−1
ζnp
2πζ(ζ + 1)eζ
“
1 + O(e−ζ/5)
”
,
where ζ is deﬁned implicitly by ζeζ = n + 1, so that ζ = log n −log log n + o(1).
Here is a numerical table of the exact values Sn compared to the main term S◦
n of the
approximation (41):
n = 10
n = 100
n = 1000
S10 = 115975
S100 .= 4.75853 · 10115
S1000 .= 2.98990 · 101927
S◦
10 .= 114204
I◦
100 .= 4.75537 · 10115
S◦
1000 .= 2.99012 · 101927.

VIII. 4. THREE COMBINATORIAL EXAMPLES
527
The error is about 1.5% for n = 10, less than 10−3 and 10−4 for n = 100 and n = 1, 000.
The asymptotic form in terms of ζ itself is the proper one as no back substitution of an
asymptotic expansion of ζ (in terms of n and log n) can provide an asymptotic expansion for
Sn solely in terms of n. Regarding explicit representations in terms of n, it is only log Sn that
can be expanded as
1
n log Sn = log n −log log n −1 + log log n
log n
+
1
log n + O
 „log log n
log n
«2!
.
(Saddle point estimates of coefﬁcient integrals often involve such implicitly deﬁned quantities.)
This example probably constitutes the most famous application of saddle point techniques
to combinatorial enumeration. The ﬁrst correct treatment by means of the saddle point method
is due to Moser and Wyman [366]. It is used for instance by de Bruijn in [111, p. 104–108] as
a lead example of the method. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE VIII.5. □
EXAMPLE VIII.6. Fragmented permutations. These correspond to F(z) = exp(z/(1 −z)).
The example now illustrates the case of a singularity at a ﬁnite distance. We set as usual
f(z) =
z
1 −z −(n + 1) log z,
and start with saddle point bounds. The saddle point equation is
(42)
ζ
(1 −ζ)2 = n + 1,
so that ζ comes close to the singularity at 1 as n gets large:
ζ = 2n + 3 −√4n + 5
2n + 2
= 1 −
1
√n + 1
2n + O(n−3/2).
Here, the approximation bζ(n) = 1 −1/√n, leads to
[zn]F(z) ≤e−1/2e2√n(1 + o(1)).
The saddle point method is then applied with integration along a circle of radius r = ζ.
The saddle point heuristic suggests to localize the integral to a small sector of angle 2θ0 and
since f ′′(r) = O(n3/2) while f ′′′(r) = O(n2), this means taking θ0 such that n3/4θ0 →∞
and n2/3θ0 →0. For instance, the choice θ0 = n−7/10 is suitable. Concentration is easily
veriﬁed: we have
˛˛˛e1/(1−z)˛˛˛
z=reiθ = e · exp
„
1 −r cos θ
1 −2r cos θ + r2
«
,
which is a unimodal function of θ for θ ∈(−π, π). (The maximum of this function of θ is of
order exp((1 −r)−1) attained at θ = 0; the minimum is O(1) attained at θ = π.) In particular,
along the noncentral part |θ| ≥θ0 of the saddle point circle, one has
(43)
˛˛˛e1/(1−z)˛˛˛
z=reiθ = O(exp
“√n −n1/10”
,
so that tails are exponentially small. Local expansions then enable us to justify the use of the
general saddle point formula (Theorem VIII.3) in this case. The net result is:
Proposition VIII.4. The number of fragmented permutations, Fn = n![zn]F(z), satisﬁes
(44)
Fn
n! ∼e−1/2e2√n
2√πn3/4 .

528
VIII. SADDLE POINT ASYMPTOTICS
The estimate (44) is only O(n−3/4) off the corresponding saddle point bound. The relative
error of the approximation is about 4%, 1%, 0.3% for n = 10, 100, 1000, respectively.
The expansion above has been extended by E. Maitland Wright [505, 506] to several
classes of functions with a singularity whose type is an exponential of a function of the form
(1 −z)−ρ. (For the case of (44), Wright [505] refers to an earlier article of Perron published in
1914.) His interest was due, at least partly, to applications to generalized partition asymptotics,
of which the basic cases are discussed in Section VIII. 6, p. 540. END OF EXAMPLE VIII.6. □
 VIII.7. Wright’s expansions. Here is a special case. Consider the function
F(z) = (1 −z)−β exp
„
A
(1 −z)ρ
«
,
A > 0,
ρ > 0.
Then, a saddle point analysis yields, e.g., when ρ < 1,
[zn]F(z) ∼N β−1−ρ/2 exp (A(ρ + 1)N ρ)
p
2πAρ(ρ + 1)
,
N :=
„ n
Aρ
«
1
ρ+1
.
(The case ρ ≥1 involves more terms of the asymptotic expansion of the saddle point.) The
method generalizes to analytic and logarithmic multipliers, as well as to a sum of terms of the
form A(1 −z)−ρ inside the exponential. See [505, 506] for details.

 VIII.8. Some oscillating coefﬁcients. Deﬁne the function
s(z) = sin
„
z
1 −z
«
.
The coefﬁcients sn = [zn]s(z) are seen to change sign at n = 6, 21, 46, 81, 125, 180, . . . . Do
signs change inﬁnitely many times? (Hint: Yes. there are two complex conjugate saddle points
and their asymptotic form combine a growth of the form naeb√n with an oscillating factor
similar to sin √n.) The sum
Un =
n
X
k=0
 
n
k
!
(−1)k
k!
exhibits similar ﬂuctuations.

VIII. 5. Admissibility
The saddle point method is a versatile approach to the analysis of coefﬁcients
of fast-growing generating functions, but one which is often cumbersome to apply
step-by-step. Fortunately, it proves possible to encapsulate the conditions encoun-
tered in the analysis of our previous examples into a general framework. This leads
to the notion of an admissible function presented in Subsection VIII.5.1. By design,
saddle point analysis applies to such functions and asymptotic forms for their coef-
ﬁcients can be systematically determined, following an approach initiated by Hay-
man in 1956. A great merit of abstraction in this context is that admissible functions
satisfy useful closure properties, so that an inﬁnite class of admissible functions of
relevance to combinatorial applications can be determined—we develop this theme
in Subsection VIII. 5.2, relative to enumeration, and VIII.5.3, relative to moments of
combinatorial parameters.

VIII. 5. ADMISSIBILITY
529
VIII. 5.1. Admissibility theory. The notion of admissibility is in essence an ax-
iomatization of the conditions underlying Theorem VIII.3 specialized to the case of
Cauchy coefﬁcient integrals. In this section, we base our discussion on H–admis-
sibility, the preﬁx H being a token of Hayman’s original contribution [263]. A crisp
account of the theory is given in Section II.7 of Wong’s book [502] and in Odlyzko’s
authoritative survey [377, Sec. 12].
We consider here a function G(z) that is analytic at the origin and whose coef-
ﬁcients [zn]G(z), not necessary all nonnegative, are to be estimated. The switch to
polar coordinates is natural, and the expansion of G(reiθ) for small θ should play a
central rˆole. With r a positive real number lying within the disc of analyticity of G(z),
the fundamental expansion is then
(45)
log G(reiθ) = log G(r) +
∞
X
ν=1
αν(r)(iθ)ν
ν! .
Not surprisingly, the most important quantities are the ﬁrst two terms, and once G(z)
has been put into exponential form, G(z) = eh(z), a simple computation yields
(46)

a(r)
:=
α1(r)
=
rh′(r)
b(r)
:=
α2(r)
=
r2h′′(r) + rh′(r),
with
h(z) := log G(z).
In terms of G, itself, one has
(47)
a(r) = rG′(r)
G(r) ,
b(r) = rG′(r)
G(r) + r2 G′′(r)
G(r) −r2
G′(r)
G(r)
2
.
Whenever G(z) has nonnegative Taylor coefﬁcients at the origin, b(r) is positive for
r > 0 and a(r) increases unboundedly as r →ρ. (This follows from the argument
encountered in Note 4, p. 516.)
Deﬁnition VIII.1 (Hayman–admissibility). Let G(z) have radius of convergence ρ
with 0 < ρ ≤+∞and be always positive on some subinterval (R0, ρ) of (0, ρ). The
function G(z) is said to be admissible if it satisﬁes the following three conditions.
H1. [Capture condition] lim
r→ρ b(r) = +∞.
H2. [Locality condition] For some function θ0(r) deﬁned over (R0, ρ) and sat-
isfying 0 < θ0 < π, one has
G(reiθ) ∼G(r)eiθa(r)−θ2b(r)/2
as r →R0,
uniformly in |θ| ≤θ0(r).
H3. [Decay condition] Uniformly in θ0(r) ≤|θ| < π
G(reiθ) = o
 
G(r)
p
b(r)
!
.
Admissible functions in the above sense are also called Hayman admissible or H–
admissible.
Note that the conditions in the deﬁnition are intrinsic to the function: they only
make reference to the function’s values along circles, no parameter n being involved
yet. It can be easily veriﬁed that the functions ez, eez−1, and ez+z2/2 are admissible

530
VIII. SADDLE POINT ASYMPTOTICS
with ρ = +∞, and that the function ez/(1−z) is admissible with ρ = 1. On the
negative side, functions like ez2 and ez2 + ez are not admissible since they attain
values that are too large when arg(z) is near π.
Coefﬁcients of H–admissible functions can be systematically analysed to ﬁrst
asymptotic order, as expressed by the following theorem. The proof simply amounts
to transcribing the deﬁnition of admissibility into the conditions of Theorem VIII.3.
Theorem VIII.4 (Coefﬁcients of admissible functions). Let G(z) be an H–admissible
function and ζ ≡ζ(n) be the unique solution in the interval (R0, ρ) of the the saddle
point equation
(48)
ζ G′(ζ)
G(ζ) = n.
The Taylor coefﬁcients of G(z) satisfy
(49)
gn ≡[zn]G(z) ∼
G(ζ)
ζnp
2πb(ζ)
as n →∞
with b(z) = z2h′′(z) + zh′(z) and h(z) = log G(z).
PROOF. Integration is carried out over a circle centred at the origin, of some radius r
to be speciﬁed shortly. Under the change of variables z = reiθ, the Cauchy coefﬁcient
formula becomes
(50)
gn ≡[zn]G(z) = r−n
2π
Z +π
−π
G(reiθ)e−niθ dθ.
In order to obtain a quadratic approximation without a linear term, one chooses
the radius of the circle as the positive solution ζ of the equation a(ζ) = n, that is,
a solution of Equation (48). (Thus ζ is a saddle point of G(z)z−n.) By the remarks
accompanying (47), we have ζ →ρ−as n →+∞. Following the general saddle
point strategy, we decompose the integration domain and set
J(0) =
Z +θ0
−θ0
G(ζeiθ)e−niθ dθ,
J(1) =
Z 2π−θ0
θ0
G(ζeiθ)e−niθ dθ.
(i) Tails pruning. By the capture condition H1 and the decay condition H3, we
have the trivial bound, which proves sufﬁcient for our purposes:
(51)
J(1) = o
 
f(ζ)
p
b(ζ)
!
,
(ii) Central approximation. The uniformity of locality condition H2 implies
(52)
J(0) ∼f(ζ)
Z +θ0
−θ0
e−θ2b(ζ)/2 dθ.
(iii) Tails completion. A combination of the locality condition H2 and the decay
condition H3 instantiated at θ = θ0, shows that b(ζ)θ2 →+∞as n →+∞. There

VIII. 5. ADMISSIBILITY
531
0
60
20
0.06
0.05
80
0.03
120
0.02
0.04
0.01
40
0
100
0.06
0.04
0
0.05
0.03
120
0.01
0.02
60
20
80
0
100
40
FIGURE VIII.6. The families of Boltzmann distributions associated with involutions
(G(z) = ez+z2/2 with r = 4 . . 8) and set partitions (G(z) = eez−1 with r = 2 . . 3) obey
an approximate Gaussian proﬁle.
results that tails can be completed back, and
(53)Z +θ0
−θ0
e−b(r)θ2/2 dθ ∼
1
p
b(r)
Z +θ0/√
b(ζ)
−θ0/√
b(ζ)
e−t2/2 dt ∼
1
p
b(r)
Z +∞
−∞
e−t2/2 dt.
From (51), (52), and (53) (or equivalently via an application of Theorem VIII.3),
the conclusion of the theorem follows.
□
The usual comments regarding the choice of the function θ0(r) apply. Consider-
ing the expansion (45), we must have α2(r)θ2
0 →∞and α3(r)θ3
0 →0. Thus, in order
to succeed, the method necessitates a priori α3(r)2/α2(r)3 →0. Then, θ0 should be
taken according to the saddle point heuristic,
(54)
1
α1/2
2
≪θ0 ≪
1
α1/3
3
,
a possible choice being the geometric mean of the two bounds θ0(r) = α−1/4
2
α−1/6
3
.
The original proof by Hayman [263] contains in fact a general result that describes
the shape of the individual terms gnrn in the Taylor expansion of G(z) as r gets
closer to its limit value ρ: it appears that the terms gnrn exhibit a bell-shaped proﬁle.
Precisely, deﬁne a family of discrete random variables X(r) indexed by r ∈(0, R) as
follows:
P(X(r) = n) = gnrn
G(r).
The model in which a random F structure with GF G(z) is drawn with its size being
the random value X(r) is known as a Boltzmann model. Then:
Proposition VIII.5. The Boltzmann probabilities associated to an admissible function
G(z) satisfy, as r →ρ−, the Gaussian estimate,
(55)
gnrn =
G(r)
p
2πb(r)

exp

−(a(r) −n)2
b(r)

+ ǫn

,

532
VIII. SADDLE POINT ASYMPTOTICS
where the error term satisﬁes ǫn = o(1) as r →ρ uniformly with respect to integers
n, i.e., limr→ρ supn |ǫn| = 0.
The proof is entirely similar to that of Theorem VIII.4; see Note 9.
 VIII.9. Admissibility and Boltzmann models. The Boltzmann distribution is accessible from
gnrn = 1
2π
Z 2π−θ0
−θ0
G(reiθ)e−inθ dθ.
The estimation of this integral is once more based on a fundamental split
gnrn = J(0) + J(1)
where
J(0) = 1
2π
Z +θ0
−θ0
,
J(1) = 1
2π
Z 2π−θ0
+θ0
,
and θ0 = θ0(n) is as speciﬁed by the admissibility deﬁnition. Only the central approximation
and tails completion deserve a adjustments. The “locality” condition H2 gives uniformly in n,
(56)
J(0)
=
G(r)
2π
Z +θ0
−θ0
ei(a(r)−n)θ−1
2 b(r)θ2(1 + o(1)) dθ
=
G(r)
2π
»Z +θ0
−θ0
ei(a(r)−n)θ−1
2 b(r)θ2 dθ + o
„Z +∞
−∞
e−1
2 b(r)θ2«–
.
and setting (a(r) −n)(2/b(r))1/2 = c, we obtain
(57)
J(0) =
G(r)
π
p
2b(r)
"Z +θ0
√
b(r)/2
−θ0
√
b(r)/2
e−t2+ict + o(1)
#
.
The integral in (57) can then be routinely extended to a complete Gaussian integral, introducing
only o(1) error terms,
(58)
J(0) =
G(r)
π
p
2b(r)
»Z +∞
−∞
e−t2+ict + o(1)
–
.
The Gaussian integral evaluates to √πe−c2/4, as is seen by completing the square and shifting
vertically the integration line.

 VIII.10. Non-admissible functions. singularity analysis and H–admissibility conditions are
in a sense complementary. Indeed, the function G(z) = (1 −z)−1 fails to be be admissible
as the asymptotic form that Theorem VIII.4 would imply is the erroneous [zn]
1
1 −z
!!∼e−1
√
2π
,
corresponding to a saddle point near 1−n−1. The explanation of the discrepancy is as follows:
Expansion (45) has αν(r) of the order of (1−r)−ν, so that the locality condition and the decay
condition cannot be simultaneously satisﬁed.
Singularity analysis salvages the situation by using a larger part of the contour and by
normalizing to a global Hankel Gamma integral instead of a more “local” Gaussian integral.
This is also in accordance with the fact that the saddle point formula gives in the case of [zn](1−
z)−1 a fraction 0.14676 of the true value, namely, 1. (More generally, functions of the form
(1 −z)−β are typical instances with too slow a growth to be admissible.)

Closure properties. An important characteristic of Hayman’s work is that it leads
to general theorems, which guarantee that large classes of functions are admissible.
Theorem VIII.5 (Closure of H–admissible functions). Let G(z) and H(z) be admis-
sible functions and let P(z) be a polynomial with real coefﬁcients. Then:
• (i) The product G(z)H(z) and the exponential eG(z) are admissible func-
tions.

VIII. 5. ADMISSIBILITY
533
• (ii) The sum G(z) + P(z) is admissible. If the leading coefﬁcient of P(z) is
positive then G(z)P(z) and P(G(z)) are admissible.
• (iii) If the Taylor coefﬁcients of eP (z) are eventually positive, then eP (z) is
admissible.
PROOF. The easy proofs essentially reduce to making an inspired guess for the choice
of the θ0 function, which may be guided by Equation (54) in the usual way, and
then routinely checking the conditions of the admissibility deﬁnition. For instance,
in the case of the exponential, K(z) = eG(z), the conditions H1, H2, H3 of Deﬁ-
nition VIII.1 are satisﬁed if one takes θ0(r) = (G(r))−2/5. We refer to Hayman’s
original paper [263] for details.
□
Exponentials of polynomials. The closure theorem also implies as a very special
case that any GF of the form eP (z) with P(z) a polynomial with positive coefﬁcients
can be subjected to saddle point analysis, a fact noted by Moser and Wyman [368,
369].
Corollary VIII.2 (Exponentials of polynomials). Let P(z) = Pm
j=1 ajzj have non-
negative coefﬁcients and be aperiodic in the sense that gcd{j | aj ̸= 0} = 1. Let
f(z) = eP (z). Then, one has
fn ≡[zn]f(z) ∼
1
√
2πλ
eP (r)
rn ,
where
λ =

r d
dr
2
P(r),
and r is a function of n given implicitly by r d
drP(r) = n.
The computations are in this case purely mechanical, since they only involve the
asymptotic expansion (with respect to n) of an algebraic equation.
Granted the basic admissibility theorem and closures properties, many functions
are immediately seen to be admissible, including
ez,
eez−1,
ez+z2/2,
which have previously served as lead examples for illustrating the saddle point method.
Corollary VIII.2 also covers involutions, permutations of a ﬁxed order in the symmet-
ric group, permutations with cycles of bounded length, as well as set partitions with
bounded block sizes: see Note 11 below. More generally, Call orollary VIII.2 applies
to any labelled set construction, F = SET(G), when the sizes of G–components are
restricted to a ﬁnite set, in which case one has
F[m] = SET
 ∪r
j=1Gj

,
=⇒
F [m](z) = exp


m
X
j=1
Gj
zj
j!

.
This covers all sorts of graphs (plain or functional) whose connected components are
of bounded size.
 VIII.11. Applications of “exponentials of polynomials”. Corollary VIII.2 applies to the
following combinatorial situations:
Permutations of order p (σp = 1)
f(z) = exp
“P
j | p
zj
j
”
Permutations with longest cycle ≤p
f(z) = exp
“Pp
j=1
zj
j
”
Partitions of sets with largest block ≤p
f(z) = exp
“Pp
j=1
zj
j!
”
.

534
VIII. SADDLE POINT ASYMPTOTICS
For instance, the number of solutions of σp = 1 in the symmetric group satisﬁes
fn ∼
“n
e
”n(1−1/p)
p−1/2 exp(n1/p),
for any ﬁxed prime p ≥3 (Moser and Wyman [368, 369]).

Complete asymptotic expansions. Harris and Schoenfeld have introduced in [261]
a technical condition of admissibility that is stronger than Hayman admissibility and
is called HS-admissibility. Under such HS-admissibility, a complete asymptotic ex-
pansion can be obtained. We omit the deﬁnition here due to its technical character but
refer instead to the original paper [261] and to Odlyzko’s survey [377]. Odlyzko and
Richmond [378] later showed that, if g(z) is H–admissible, then f(z) = eg(z) is HS–
admissible. Thus, taking H–admissibility to mean at least exponential growth, full
asymptotic expansions are to be systematically expected at double exponential growth
and beyond. The principles of developing full asymptotic expansions are essentially
the same as the ones explained on p. 522—only the discussion of the asymptotic scales
involved becomes a bit technical at this level of generality.
VIII. 5.2. Higher level structures and admissibility. The concept of admissi-
bility and its surrounding properties (Theorems VIII.4 and VIII.5, Corollary VIII.2)
afford a neat discussion of which combinatorial classes should lead to counting se-
quences that are amenable to the saddle point method. For simplicity, we restrict
ourselves here to the labelled universe.
Start from the ﬁrst level structures, namely
SEQ(Z),
CYC(Z),
SET(Z),
corresponding respectively to permutations, circular graphs, and urns, with EGFs
1
1 −z ,
log
1
1 −z ,
ez.
The ﬁrst two are of singularity analysis class; the last one resorts, as we saw, to the
saddle point method and is H-admissible.
Next consider second level structures deﬁned by arbitrary composition of two
constructions K ◦K′ applied to the atomic class Z, where K and K′ taken amongst
the three constructions SEQ, CYC, SET; see Subsection II. 4.2, p. 115 for a discussion
(In the case of the internal construction K′ it is understood that, for deﬁniteness, the
number of components is constrained to be ≥1.) There are three structures whose
external construction is of the sequence type, namely,
SEQ ◦SEQ,
SEQ ◦CYC,
SEQ ◦SET,
corresponding respectively to “labelled compositions”, alignments, and surjections.
All three have a dominant singularity that is a pole; hence they are amenable to mero-
morphic coefﬁcient asymptotics (Chapters IV and V), or, with resulting weaker esti-
mates, to singularity analysis.
Similarly there are three structures whose external construction is of the cycle
type, namely,
CYC ◦SEQ,
CYC ◦CYC,
CYC ◦SET,

VIII. 5. ADMISSIBILITY
535
corresponding to cyclic versions of the previous ones. In that case, the EGFs have a
logarithmic singularity; hence they are amenable to singularity analysis (Chapters VI
and VII), or, after differentiation, to meromorphic coefﬁcient asymptotics again.
The case of an external set construction is of interest. It gives rise to
SET ◦SEQ,
SET ◦CYC,
SET ◦SET,
corresponding respectively to fragmented permutations, usual permutations, and set
partitions. The composition SET ◦CYC appears to be special, because of the general
isomorphism, valid for any class C,
SET(CYC(C)) ∼= SEQ(C),
corresponding to the unicity of the decomposition of a permutation of C-objects into
cycles. Accordingly, at generating function level, an exponential singularity “simpli-
ﬁes”, when combined with a logarithmic singularity, giving rise to an algebraic (here
polar) singularity. The remaining two cases, namely, fragmented permutations and set
partitions, characteristically come under the saddle point method and admissibility, as
we have seen already.
Closure properties then make it possible to consider structures deﬁned by an arbi-
trary nesting of the constructions in {SEQ, CYC, SET}. For instance, “superpartitions”
deﬁned by
S = SET(SET≥1(SET≥1(Z))),
=⇒
S(z) = eeez−1−1,
are third level structures. They can be subjected to admissibility theory and saddle
point estimates apply a priori. Notes 13 and 14 further discuss such third level struc-
tures.
 VIII.12. Idempotent mappings. Consider functions from a ﬁnite set to itself (“mappings”
or “functional graphs” in the terminology of Chapter II) that are idempotent, i.e., φ ◦φ =
φ. The EGF is I(z) = exp(zez) since cycles are constrained to have length 1 exactly. The
function I(z) is admissible and
In ∼
n!
√2πnζ ζ−ne(n+1)/(ζ+1),
where ζ is the positive solution of ζ(ζ + 1)eζ = n + 1. This example is discussed by Harris
and Schoenfeld in [261].

 VIII.13. The number of societies. A society on n distinguished individuals is deﬁned by
Sloane and Wieder [441] as follows: ﬁrst partition the n individuals into nonempty subsets and
then form an ordered set partition [preferential arrangement] into each subset. The class of
societies is thus a “third level” (labelled) structure, with speciﬁcation and EGF
S = SET
`
SEQ≥1(SET≥1(Z))
´
=⇒
S(z) = exp
„
1
2 −ez −1
«
.
The counting sequence starts as 1, 1, 4, 23, 173, 1602 (EIS 75729); asymptotically
Sn ∼C e
√
2n/ log 2
n3/4(log 2)n ,
for some computable C. (The singularity is of the type “exponential-of-pole” at log 2.)


536
VIII. SADDLE POINT ASYMPTOTICS
 VIII.14. Third level classes. Consider labelled classes deﬁned from atoms (Z) by three
nested constructions of the form K ◦K′
≥1 ◦K′′
≥1, where each K, K′, K′′ is either a sequence
(abbreviated S) or a set (P) construction. All cases can be analysed, either by saddle point
and admissibility (SP) or by singularity analysis (SA). Here is a table recapitulating structures,
together with their EGF, radius of convergence (ρ), and analytic type.
PPP
eeez−1−1
ρ = ∞
(SP)
SPP
1
2−eez −1
ρ = 1 + log log 2
(SA)
PPS
eez/(1−z)−1
ρ = 1
(SP)
SPS
1
2−ez/(1−z)
ρ =
log 2
1+log 2
(SA)
PSP
exp(
1
2−ez )
ρ = log 2
(SP)
SSP
2−ez
3−2ez
ρ = log 3
2
(SA)
PSS
ez/(1−2z)
ρ = 1
2
(SP)
SSS
1−2z
1−3z
ρ = 1
3
(SA)
The outermost construction dictates the analytic type and precise asymptotic equivalents can be
developed in all cases.

VIII. 5.3. Moment analyses. Univariate applications of admissibility include
the analysis of generating functions relative to moments of distributions, which are
obtained by differentiation and specialization of corresponding multivariate generat-
ing functions. In the context of saddle point analyses, the dominant asymptotic form
of the mean value as well as bounds on the variance usually result, often leading to
concentration of distribution (convergence in probability) properties.
The situation of interest here is that of a counting generating function G(z), cor-
responding to a class G, which is amenable to the saddle point method. A parameter χ
on G gives rise to a bivariate GF G(z, u), which is a deformation of G(z, u) when u
is close to 1. Then the GFs
∂uG(z, u)|u=1 ,
, ∂2
uG(z, u)

u=1 , . . . ,
relative to successive (factorial) moments, in many cases, amenable to an analysis
that closely resembles that of G(z) itself. In this way, moments can be estimated
asymptotically.
We illustrate the analysis of moments by means of two examples:
— Example 7 provides an analysis of the mean number of blocks in a random
set partition by means of bivariate generating functions.
— Example 8 estimates the mean number of increasing subsequences in a ran-
dom permutation by means of a direct generating function construction.
EXAMPLE VIII.7. Blocks in random set partitions. The function
G(z, u) = eu(ez−1)
is the bivariate generating function of set partitions with u marking the number of blocks (or
parts). We set G(z) = G(z, 1) and deﬁne
M(z) =
∂
∂uG(z, u)
˛˛˛˛
u=1
= eez+z−1.
Thus, the quantity
mn
gn = [zn]M(z)
[zn]G(z)
represents the mean number of parts in a random partition of [1 . . n]. We already know that
G(z) is admissible and so is M(z) by closure properties. The saddle point for the coefﬁcient

VIII. 5. ADMISSIBILITY
537
integral of G(z) occurs at ζ such that ζeζ = n, and it is already known that ζ = log n −
log log n + o(1).
It would be possible to analyze M(z) by means of Theorem VIII.4 directly: the analysis
then involves a saddle point ζ1 ̸= ζ that is relative to M(z). An analysis of the mean would
then follow, albeit at some computational effort. It is however more transparent to appeal to
Lemma VIII.5 and analyse the coefﬁcients of M(z) at the saddle point of G(z).
Let a(r), b(r) and a1(r), b1(r) be the functions of Eq. (46) relative to G(z) and M(z)
respectively:
log G(z)
=
ez −1
log M(z)
=
ez + z −1
a(r)
=
rer
a1(r)
=
rer + r = a(r) + r
b(r)
=
(r2 + r)er
b1(r)
=
(r2 + r)er + r = b(r) + r.
Thus, estimating mn by Lemma VIII.5 with the formula taken at r = ζ, one ﬁnds
mn =
eζG(ζ)
p
2πb1(ζ)
»
exp
„
−ζ2
b1(ζ)
«
+ o(1)
–
,
while the corresponding estimate for gn is
gn =
G(ζ)
p
2πb(ζ)
[1 + o(1)].
Given that b1(ζ) ∼b(ζ) and that ζ2 is of smaller order than b1(ζ), one has
mn
gn = eζ(1 + o(1)) =
n
log n(1 + o(1)).
A similar computation applies to the second moment of the number of parts which is
found to be asymptotic to e2ζ (the computation involves taking a second derivative). Thus, the
standard deviation of the number of parts is of an order o(eζ) that is smaller than the mean.
This implies a concentration property for the distribution of the number of parts.
Proposition VIII.6. The variable Xn equal to the number of parts in a random partition of the
set [1 . . n] has expectation
E{Xn} =
n
log n(1 + o(1)).
The distribution satisﬁes a “concentration” property: for any ǫ > 0, one has
P
˛˛˛˛
Xn
E{Xn} −1
˛˛˛˛ > ǫ
ﬀ
→0
as n →+∞.
The calculations are not difﬁcult (see Note 15 for details) but they require care in the
manipulation of asymptotic expansions: for instance, Salvy and Shackell [426] who “do it
right” report that two discrepant estimates (differing by a factor of e−1) had been previously
published regarding the value of the mean. . . . . . . . . . . . . . . . . . . END OF EXAMPLE VIII.7. □
 VIII.15. Higher moments of the number of blocks in set partitions. Let Xn be the number
of blocks in a random partition of n elements. Then, one has
E(Xn) =
n
log n + n log log n (1 + o(1))
log2 n
,
V(Xn) =
n
log2 n + n(2 log log n −1 + o(1))
log2 n
,
which proves concentration. The calculation is best performed in terms of the saddle point ζ,
then converted in terms of n. [See Salvy’s ´etude [425] and [426].]


538
VIII. SADDLE POINT ASYMPTOTICS
 VIII.16. The shape of random involutions. Consider a random involution of size n, the EGF
of involutions being ez+z2/2. Then the mean number of 1-cycles and 2-cycles satisfy
E(# 1-cycles) = √n + O(1),
E(# 2-cycles) = 1
2n −√n + O(1).
In addition, the corresponding distributions are concentrated.

EXAMPLE VIII.8. Increasing subsequences in permutations. Given a permutation written in
linear notation as σ = σ1 · · · σn, an increasing subsequence is a subsequence σi1 · · · σik which
is in increasing order, i.e., i1 < · · · < ik and σi1 < · · · σik. The question asked is: What is the
mean number of increasing subsequences in a random permutation?
The problem has a ﬂavour analogous to that of “hidden” patterns in random words, which
was tackled in Chapter V, p. 292, and indeed similar methods are applicable here. Deﬁne a
tagged permutation as a permutation together with one of its increasing subsequence distin-
guished. (We also consider the null subsequence as an increasing subsequence.) For instance,
7 |3 5 2 |6 4 1 |8 9
is a tagged permutation with the increasing subsequence 3 6 8 that is distinguished. The vertical
bars are used to identify the tagged elements, but they may also be interpreted as decomposing
the permutation into subpermutation fragments. We let T be the class of tagged permutations,
T(z) be the corresponding EGF, and set Tn = n![zn]T(z). The mean number of increasing
subsequences in a random permutation of size n is clearly tn = Tn/n!.
In order to enumerate T , we let P be the class of all permutations and P+ the subclass of
non empty permutations. Then, one has up to isomorphism,
T = P ⋆SET(P+),
since a tagged permutation can be reconstructed from its initial fragment and the set of its
fragments (by ordering the set according to increasing values of initial elements). This combi-
natorial argument gives the EGF T(z) as
T(z) =
1
1 −z exp
„
z
1 −z
«
.
The generating function T(z) can be expanded, so that the quantity Tn admits a closed
form,
Tn =
n
X
k=0
 
n
k
!
n!
k! .
From there it is possible to analyse Tn asymptotically by means of the Laplace method for
sums, as was done by Lifschitz and Pittel in [332]. However, analytically, the function T(z) is
a mere variant of the EGF of fragmented permutations. Saddle point conditions are again easily
checked, either directly or via admissibility, to the effect that
(59)
tn ≡Tn
n! ∼e−1/2e2√n
2√πn1/4 .
(Compare with the closely related estimate (44) on p. 527.)
The estimate (59) has the great advantage of providing information about an important and
much less accessible parameter. Indeed, let λ(σ), represent the length of the longest increasing
subsequence in σ With ι(σ) is the number of increasing subsequences, one has the general
inequality,
2λ(σ) ≤ι(σ),

VIII. 5. ADMISSIBILITY
539
since the number of increasing subsequences of σ is at least as large as the number of subse-
quences contained in the longest increasing subsequence. Let now ℓn be the expectation of λ
over permutations of size n. Then, convexity of the function 2x implies
(60)
2ℓn ≤tn,
so that
ℓn ≤
2
log 2
√n(1 + o(1)).
In summary:
Proposition VIII.7. The mean number of increasing subsequences in a random permutation
of n elements is asymptotically
e−1/2e2√n
2√πn1/4 (1 + o(1)) .
Accordingly, the expected length of the longest increasing subsequence in a random permutation
of size n satisﬁes the inequality
ℓn ≤
2
log 2
√n(1 + o(1)).
The upper bound obtained on the expected length ℓn of the longest increasing sequence
is of the form 2.89√n while Note 19 describes a lower bound of the form ℓn ≥
1
2
√n. In
fact, Logan and Shepp [336] independently of Vershik and Kerov [485] have succeeded in
establishing the much more difﬁcult result
ℓn ∼2√n.
Their proof is based on a detailed analysis of the proﬁle of a random Young tableau. (The bound
obtained here by a simple mixture of saddle point estimates and combinatorial approximations
at least provides the right order of magnitude.) This has led in turn to attempts at characterizing
the asymptotic distribution of the length of the longest increasing subsequence. The problem
remained unsolved for two decades, despite many tangible progresses. J. Baik, P. A. Deift,
and K. Johansson [19] eventually obtained a solution (in a publication dated 1999) by relating
longest increasing subsequences to eigenvalues of random matrix ensembles. We regretfully
redirect the reader to relevant presentations of the beautiful theory surrounding this sensational
result, for instance [7, 114]. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE VIII.8. □
 VIII.17. A useful recurrence. A decomposition according to the location of n yields for tn
in (60) the recurrence
tn = tn−1 + 1
n
n−1
X
k=0
tk,
t0 = 1.
Hence T(z) satisﬁes the ordinary differential equation,
(1 −z)2 d
dz T(z) = (2 −z)T(z),
T(0) = 1,
which can be solved explicitly. Also the differential equation gives rise to the recurrence
tn+1 = 2tn −
n
n + 1tn−1,
t0 = 0,
t1 = 2,
by which tn can be computed efﬁciently in a linear number of operations.

 VIII.18. Related combinatorics. The sequence of values of Tn starts as 1, 2, 7, 34, 209, 1546,
and is EIS A002720. It counts the following equivalent objects: (i) the n × n binary matrices
with at most one entry 1 in each column; (ii) the partial matchings of the complete bipartite
graph Kn,n; (iii) the injective partial mappings of [1 . . n] to itself.


540
VIII. SADDLE POINT ASYMPTOTICS
 VIII.19. A simple probabilistic lower bound. Elementary probability theory provides a sim-
ple lower bound on ℓn. Let X1, . . . , Xn be independent random variables uniformly distributed
over [0, 1]. Assume n = m2. Partition [0, 1[ into m subintervals each of the form [ j−1
m , j
m[
and X1, . . . , Xn into m blocks, each of the form X(k−1)m+1, . . . , Xkm. There is a probability
1−(1−m−1)m ∼1−e−1 that block numbered 1 contains an element of subinterval numbered
1, block numbered 2 contains an element of subinterval numbered 2, and so on. Then, with high
probability, at least m
2 of the blocks contain an element in their matching subinterval. Conse-
quently, ℓn ≥
1
2
√n, for n large enough. (The factor 1
2 can even be improved a little.) The
crisp booklet by Steele [451] describes many similar as well as more advanced applications to
combinatorial optimization. See also the book of Motwani and Raghavan [370] for applications
to randomized algorithms in computer science.

 VIII.20. The Baik–Deift-Johansson Theorem. Consider the Painlev´e II equation u′′(x) =
2u(x)3 + xu(x), and the particular solution u0(x) that is asymptotic to −Ai(x) as x →+∞,
with Ai(x) the Airy function, which solves y′′ −xy = 0. Deﬁne the Tracy-Widom distribution
(arising in random matrix theory)
F(t) = exp
„Z ∞
t
(x −t)u0(x)2 dx
«
.
The distribution of the length of the longest increasing subsequence, Ln satisﬁes
lim
n→∞P
“
Ln ≤2√n + tn1/6”
= F(t),
for any ﬁxed t. Thus the discrete random variable Ln converges to a well-characterized distri-
bution [19]. (An exact formula for associated GFs is due to Gessel; see p. 698.)

VIII. 6. Integer partitions
We examine the asymptotic enumeration of partitions, where the saddle point
method serves as the main asymptotic engine. The corresponding generating function
enjoys rich properties, and the analysis, which goes back to Hardy and Ramanujan in
1917, constitutes, as we pointed out in the introduction, a jewel of classical analysis.
Integer partitions represent additive decompositions of integers, when the order
of summands is not taken into account. When all summands are allowed, the speciﬁ-
cation and ordinary generating function are (Section I. 3, p. 37)
(61)
P = MSET(SEQ≥1(Z))
=⇒
P(z) =
∞
Y
m=1
1
1 −zm ,
which, by the exp-log transformation admits the equivalent form
(62)
P(z)
=
exp
∞
X
m=1
log(1 −zm)−1
=
exp

z
1 −z + 1
2
z2
1 −z2 + 1
3
z3
1 −z3 · · ·

.
From either of these two forms, it can be seen that the unit circle is natural boundary,
beyond which the function cannot be continued. The second form, which involves the
quantity exp(z/(1 −z)) is reminiscent of the EGF of fragmented permutations, ex-
amined in Example 6, p. 527, to which the saddle point method could be successfully
applied.

VIII. 6. INTEGER PARTITIONS
541
Summands
Speciﬁcation
Asymptotics
All, Z≥1
MSET(SEQ≥1(Z))
1
4n
√
3
eπ√
2n/3
Ex. 2, p. 541
All distinct, Z≥1
PSET(SEQ≥1(Z))
1
4 · 31/4n3/4 eπ√
n/3
Note 25, p. 546
Squares, 1, 4, 9, 16, · · ·
—
Cn−7/6eKn1/3
Note 25, p. 546
Primes, 2, 3, 5, 7, . . .
—
log P (Π)
n
∼c
r
n
log n
Note 27, p. 546
Powers of two, 1, 2, 4, . . .
—
log M2n ∼(log n)2
2 log 2
Note 28, p. 547
Plane
—
c1n−25/36ec2n2/3
Note 26, p. 546
FIGURE VIII.7. Asymptotic enumeration of various types of partitions.
In what follows, we show (Example 9) that the saddle pont method is applicable,
though the analysis of P(z) near the unit circle is delicate (and pregnant with deep
properties). The accompanying notes point to similar methods being applicable to a
variety of similar-looking generating functions, including those relative to partitions
into primes, squares, and distinct summands, as well as plane partitions: see Figure 7
for a summary of some of the asymptotic results known.
EXAMPLE VIII.9. Integer partitions. We are dealing here with a famous chapter of both as-
ymptotic combinatorics and additive number theory. A problem similar to that of asymptotically
enumerating partitions was ﬁrst raised by Ramanujan in a letter to Hardy in 1913, and subse-
quently developed in a famous joint work of Hardy and Ramanujan (see the account in Hardy’s
Lectures [260]). The Hardy–Ramanujan expansion was later perfected by Rademacher [18]
who, in a sense, gave an “exact” formula for the partition numbers Pn.
A complete derivation with all details would consume more space than what we can devote
to this questions. We outline here the proof strategy in such a way that, hopefully, the reader
can supply the missing details by herself. (The cited references provide a complete treatment).
Like before, we start with simple saddle point bounds. Let Pn denote the number of
integer partitions of n, with OGF as stated in (61). A form amenable to bounds derives from
the exp–log reorganization (62), which yields
P(z) exp
„„
1
1 −z
«
·
„z
1 +
z2
2(1 + z) +
z3
3(1 + z + z2) + · · ·
««
.
The denominator of the general term in the exponential satisﬁes, for x ∈(0, 1), mxm−1 <
1 + x + · · · + xm−1 < m, so that
(63)
1
1 −x
X
m≥1
x
m2 < log P(x) <
1
1 −x
X
m≥1
xm
m2 .
This proves for real x →1 that
(64)
P(x) = exp
„
π2
6(1 −x)(1 + o(1)
«
,

542
VIII. SADDLE POINT ASYMPTOTICS
given the elementary identity P m−2 = π2/6. The singularity type at z = 1 resembles that
of fragmented permutations (p. 527), and at least the growth along the real axis is similar. An
approximate saddle point is then
(65)
bζ(n) = 1 −
π
√
6n
,
which gives a saddle point bound
Pn ≤exp
`
K√n(1 + o(1)
´
,
K = π
r
2
3.
Proceeding further involves transforming the saddle point bounds into a complete sad-
dle point analysis. Based on previous experience, we shall integrate along a circle of radius
r = bζ(n). To do so, two ingredients are needed: (i) an approximation in the central range;
(ii) bounds establishing that the function P(z) is small away from the central range so that
tails can be ﬁrst neglected, then completed back. Assuming the expansion (63) to lift to an area
of the complex plane near the real axis, the range of the saddle point should be analogous to
what was found already for exp(z/(1−z)), so that θ0 = n−7/10 will be adopted. Accordingly,
we choose to integrate along a circle of radius r = bζ(n) given by (65) and deﬁne the central
region by θ0 = n−7/10. Under these conditions, the central region is seen under an angle that
is O(n−1/5) from the point z = 1.
(i) Central approximation. This requires a reﬁnement of (63) till o(1) terms as well as an
argument establishing a lifting to a region near the real axis. We set z = e−t and start with
t > 0. The function
L(t) := log P(e−t) =
X
m≥1
e−mt
m(1 −e−mt)
is a harmonic sum which is amenable to Mellin transform techniques (as described in APPEN-
DIX B: Mellin transform, p. 707). The base function is e−t/(1 −e−t), the amplitudes are
the coefﬁcients 1/m and the frequencies are the quantities m ﬁguring in the exponents. The
Mellin transform of the base function, as given in the appendix, is Γ(s)ζ(s). The Dirichlet
series associated to the amplitude frequency pairs is P m−1m−s = ζ(s + 1), so that
L⋆(s) = ζ(s)ζ(s + 1)Γ(s).
Thus L(t) is amenable to Mellin asymptotics and one ﬁnds
(66)
L(t) = π2
6t + 1
2 log t −log
√
2π −1
24t + O(t2),
t →0+,
from the poles of L⋆(s) at s = 1, 0, −1. This corresponds to an improved form of (64):
(67)
log P(z) =
π2
6(1 −z) + 1
2 log(1 −z) −π2
12 −log
√
2π + O(1 −z).
At this stage, we make a crucial observation: The precise estimate (66) extends when t lies
in any sector symmetric about the real axis, situated in the half-plane ℜ(t) > 0, and with
an opening angle of the form π −δ for an arbitrary δ > 0. This derives from the fact that
the Mellin inversion integral and the companion residue calculations giving rise to (66) extend
to the complex realm as long as | Arg(t)| <
π
2 −1
2δ. (See the appendix on Mellin or the
article [184].) Thus, the expansion (67) holds throughout the central region given our choice
of the angle θ0. The analysis in the central region is then practically isomorphic to the one of
exp(z/(1 −z)) in the previous example, and it presents no special difﬁculty.
(ii) Bounds in the noncentral region. This is here a nontrivial task since half of the factors
entering the product form (61) of P(z) are inﬁnite at z = −1, one third are inﬁnite at z =

VIII. 6. INTEGER PARTITIONS
543
1
0.5
y
0
-0.5
-1
0
-0.5
-1
0.5
0
1
x
1
2
3
4
5
20
10
15
5
th
2
-2
-3
-1
0
3
1
FIGURE VIII.8. Integer partitions. (Left) The surface |P(z)| with P(z) the OGF of
integer partitions. The plot shows the major singularity at z = 1 and smaller peaks cor-
responding to singularities at z = −1, e±2iπ/3 and other roots of unity. (Right) A plot
of P(reiθ) for varying θ and r = 0.5, . . . , 0.75 illustrates the increasing concentration
property of P(z) near the real axis.
e±2iπ/3, and so on. Accordingly, the landscape of |P(z)| along a circle of radius r that tends
to 1 is quite chaotic: see Figure 8 for a rendering. It is possible to extend the analysis of
log P(z) near the real axis by way of the Mellin transform to the case z = e−t−iφ as t →0
and φ = 2π p
q is commensurate to 2π. In that case, one must operate with
Lφ(t) =
X
m≥1
1
m
e−m(t+iφ)
1 −e−m(t+iφ) =
X
m≥1
X
k≥1
1
me−mk(t+iφ),
which is yet another harmonic sum. The net result is that when |z| tends radially towards e2πi p
q ,
then P(z) behaves roughly like
(68)
exp
„
π2
6q2(1 −|z|)
«
,
which is a power 1/q2 of the exponential growth as z →1−1. This analysis extends next to
a small arc. Finally, consider a complete covering of the circle by arcs whose centres are of
argument 2π j
N , j = 1, . . . , N −1, with N chosen large enough. A uniform version of the
bound (68) makes it possible to bound the contribution of the noncentral region and prove it
to be exponentially small. There are several technical details to be ﬁlled in order to justify this
approach, so that we switch to a more synthetic one based on transformation properties of P(z),
following [10, 13, 18, 260]. (Such properties also enter the Hardy-Ramanujan-Rademacher
formula for Pn in an essential way.)

544
VIII. SADDLE POINT ASYMPTOTICS
The fundamental identity satisﬁed by P(z) reads
(69)
P(e−2πτ) = √τ exp
„ π
12
„ 1
τ −τ
««
P(e−2π/τ),
which is valid when ℜ(τ) > 0. The proof is a simple rephrasing of a transformation formula of
Dedekind’s η (eta) function, summarized in Note 21 below.
 VIII.21. Modular transformation for the Dedekind eta function. Consider
η(τ) := q1/24
∞
Y
m=1
(1 −qm),
q = e2πiτ,
with ℑ(τ) > 0. Then η(τ) satisﬁes the “modular transformation” formula,
(70)
η
„
−1
τ
« r
τ
i η(τ).
This transformation property is ﬁrst proved when τ is purely imaginary τ = it, then extended
by analytic continuation. Its logarithmic form results from a residue evaluation of the integral
1
2πi
Z
γ
cot πs cot π s
τ
ds
s ,
with γ a large contour avoiding poles. (This elementary derivation is due to C. L. Siegel. The
function η(τ) satisﬁes transformation formulæ under S : τ 7→τ +1 and T : τ 7→−1/τ, which
generate the group of modular (in fact “unimodular”) transformations τ 7→(aτ + b)/(cτ + d)
with ad −bc = 1. Such functions are called modular forms.)

Given (69), the behaviour of P(z) away from the positive real axis and near the unit
circle can now be quantiﬁed. Here, we content ourselves with a representative special case, the
situation when z →−1. Consider thus P(z) with z = e−2πt+iπ, where, for our purposes, we
may take t =
1
√
24n. Then, Equation (69) relates P(z) to P(z′), with τ = t −i/2 and
z′ = e−2π/τ = exp
„
−2πt
t2 + 1
4
«
eiφ,
φ = −
π
t2 + 1
4
.
Thus |z′| →1 as t →0 with the important condition that |z′| −1 = O
`
(|z| −1)1/4´
. In other
words, z′ has moved away from the unit circle. Thus, since |P(z′)| < P(|z′|), we may apply
the estimate (67) to P(|z′|) to the effect that
log |P(z)| ≤
π
24(1 −|z|)(1 + o(1),
(z →−1+).
This is an instance of what was announced in (68) and is in agreement with the surface plot of
Figure 8. The extension to an arbitrary angle presents no major difﬁculty.
The two properties developed in (i) and (ii) above guarantee that the approximation (67)
can be used and that tails can be completed. We ﬁnd accordingly that
Pn ∼[zn]e−π2/12
√1 −z exp
„
π2
6(1 −z)
«
.
All computations done, this provides:
Proposition VIII.8. The number pn of partitions of integer n satisﬁes
(71)
pn ≡[zn]
∞
Y
k=1
1
1 −zk ∼
1
4n
√
3
eπ√
2n/3
The singular behaviour along and near the real line is comparable to that of exp((1−z)−1),
which explains a growth of the form e
√n. . . . . . . . . . . . . . . . . . . . END OF EXAMPLE VIII.9. □

VIII. 6. INTEGER PARTITIONS
545
The asymptotic formula (71) is only the ﬁrst term of a complete expansion involv-
ing decreasing exponentials that was discovered by Hardy and Ramanujan in 1917 and
later perfected by Rademacher (see Note 23 below). While the full Hardy–Ramanujan
expansion necessitates considering inﬁnitely many saddle–points near the unit circle
and requires the modular transformation of Note 21, the main term of (71) only re-
quires the asymptotic expansion of the partition generating function near z = 1.
The principles underlying the partition example have been made into a general
method by Meinardus [355] in 1954. Meinardus’ method abstracts the essential fea-
tures of the proof and singles out sufﬁcient conditions under which the analysis of an
inﬁnite product generating function can be achieved. The conditions, in agreement
with the Mellin treatment of harmonic sums, requires analytic continuation of the
Dirichlet series involved in log P(z) (or its analogue), as well as smallness towards
inﬁnity of that same Dirichlet series. A summary of Meinardus’ method constitutes
Chapter 6 of Andrews treatise on partitions [10] to which the reader is referred. The
method applies to many cases where the summands and their multiplicities have a
regular enough arithmetic structure.
 VIII.22. A simple yet powerful formula. Deﬁne (cf [260, p. 118])
P ◦
n =
1
2π
√
2
d
dn
„eKλn
λn
«
,
K = π
r
2
3,
λn :=
r
n −1
24.
Then P ◦
n approximates Pn with a relative precision of order e−c√n for some c > 0. For
instance, the error is less than 3·10−8 for n = 1000. [Hint: The transformation formula makes
it possible to evaluate the central part of the integral very precisely.]

 VIII.23. The Hardy–Ramanujan–Rademacher expansion. The number of integer partitions
satisﬁes the exact formula
Pn =
1
π
√
2
∞
X
k=1
Ak(n)
√
k d
dn
sinh( π
k
q
2
3(n −
1
24))
q
n −
1
24
,
where
Ak(n) =
X
h mod k,gcd(h,k)=1
ωh,ke−2iπh/k,
ωh,k is a 24th root of unity, ωh,k = exp(πis(h, k)), and sh,k =
k−1
X
µ=1
{{µ
k }} {{hµ
k }} is known
as a Dedekind sum, with {{x}} = x −⌊x⌋−1
2. Proofs are found in [10, 13, 18, 260].

 VIII.24. Meinardus’ theorem. Consider the inﬁnite product (an ≥0)
f(z) =
∞
Y
n=1
(1 −zn)−an.
The associated Dirichlet series is α(s) =
X
n≥1
an
ns . Assume that α(s) is continuable into a
meromorphic function to ℜ(s) ≥−C0 for some C0 > 0, with only a simple pole at some
ρ > 0 and corresponding residue A; assume also that α(s) is of moderate growth in the half-
plane, namely, α(s) = O(|s|C1), for some C1 > 0 (as |s| →∞in ℜ(s) ≥−C0). Let
g(z) = P
n≥1 anzn and assume a concentration condition of the form
ℜg(e−t−2iπy) −g(e−t) ≤−C2y−ǫ.

546
VIII. SADDLE POINT ASYMPTOTICS
Then the coefﬁcient fn = [zn]f(z) satisﬁes
fn = Cnκ exp
“
Knρ/(ρ+1)”
,
K = (1 + ρ−1)
ˆ
AΓ(ρ + 1)ζ(ρ + 1)
˜1/(ρ+1).
The constants C, κ are:
C = eα′(0)(2π(1 + ρ))−1/2 [AΓ(ρ + 1)ζ(ρ + 1)](1−2α(0))/(2ρ+2) ,
κ = α(0) −1 −1
2ρ
1 + ρ
.
Details of the concentration condition, and error terms are found in [10, Ch 6].

 VIII.25. Various types of partitions. The number of partitions into distinct odd summands,
squares, cubes, triangular numbers, are cases of application of Meinardus’ method. For instance
the method provides, for the number Qn of partitions into distinct summands, the asymptotic
form
Qn ∼
eπ√
n/3
4 · 31/4n3/4 .
The central approximation is obtained by a Mellin analysis from
L(t) := log Q(et) =
∞
X
m=1
(−1)m
m
e−mt
1 −e−mt ,
L⋆(s) = −Γ(s)ζ(s)ζ(s + 1)(1 −2−s),
L(t) ∼π2
12t −log
√
2 + 1
24t..
(See the already cited references [10, 13, 18, 260].)

 VIII.26. Plane partitions. A plane partition of a given number n is a two-dimensional array
of integers ni,j that are nonincreasing both from left to right and top to bottom and that add up
to n. The ﬁrst few terms (EIS A000219) are 1, 1, 3, 6, 13, 24, 48, 86, 160, 282, 500, 859 and P.
A. MacMahon proved that the OGF is
R(z) =
∞
Y
m=1
(1 −zm)−m.
Meinardus’ method applies to give
Rn ∼(ζ(3)2−11)1/36n−25/36 exp
“
3 · 2−2/3ζ(3)1/3n2/3 + 2c
”
,
where c = −
e
4π2 (log(2π) + γ −1).
(See [10, p. 199] for this result due to Wright [504] in 1931.)

 VIII.27. Partitions into primes. Let P (Π)
n
be the number of partitions of n into summands
that are all prime numbers,
P (Π)(z) =
∞
Y
m=1
(1 −z)−pm,
where pm is the mth prime (p1 = 2, p2 = 3, . . . ). The sequence starts as (EIS A000607):
1, 0, 1, 1, 1, 2, 2, 3, 3, 4, 5, 6, 7, 9, 10, 12, 14, 17, 19, 23, 26, 30, 35, 40.
Then
(72)
log P (Π)
n
∼
„2
3
«1/2
π
„
n
log n
«1/2
(1 + o(1)) .
An upper bound of a form consistent with (72) can be derived elementarily as a saddle point
bound based on the property
X
n≥1
e−tpn ∼
t
log t,
t →0.

VIII. 7. LARGE POWERS
547
This last fact results either from the Prime Number Theorem or from a Mellin analysis based
on the fact that Π(s) := P p−s
n
satisﬁes, with µ(m) the M¨obius function,
Π(s) =
∞
X
m=1
µ(m) log ζ(ms).
(See Roth and Szekeres’ study [415] as well as Yang’s article [512] for relevant references and
recent technology.) This is in sharp contrast with compositions into primes (Chapter V, p. 317)
whose analysis turned out to be especially easy.

 VIII.28. Partitions into powers of 2. Let Mn be the number of partitions of integer n into
summands that are powers of 2. Thus M(z) = Q
m≥0(1 −z2m)−1. The sequence (Mn) starts
as 1, 1, 2, 2, 4, 4, 6, 6, 10 (EIS A018819). One has
log M2n =
1
2 log 2
„
log
n
log n
«2
+
„1
2 +
1
log 2 + log log 2
log 2
«
log n + O(log log n).
De Bruijn [110] determined the precise asymptotic form of M2n. (See also [140] for related
problems.)

Averages and moments. Based on the foregoing analysis, it is possible to per-
form the analysis of several parameters of integer partitions in a way parallel to our
discussion of moments in Subsection VIII. 5.3. In particular, it becomes possible to
justify the empirical observations regarding the proﬁle of partitions made in the course
of Example III.6, p. 160.
 VIII.29. Mean number of parts in integer partitions. The mean number of parts (or sum-
mands) in a random integer partition of size n is
1
K
√n log n + O(n1/2),
K = π
r
2
3.
For a partition into distinct part, the mean number of parts is
2
√
3 log 2
π
√n + o(n1/2).
The complex-analytic proof only requires the central estimates of log P(e−t) and log Q(e−t),
given the concentration properties, as well as the estimates
X
m≥1
e−mt
1 −e−mt ∼−log t + γ
t
+ 1
4,
X
m≥1
(−1)m−1
e−mt
1 −e−mt ∼log 2
t
−1
4,
which result from a standard Mellin analysis, the respective transforms being
Γ(s)ζ(s)2,
Γ(s)(1 −21−s)ζ(s)2.
Full asymptotic expansions of the mean and of moments of any order can be determined. In
addition, the distributions are concentrated around their mean. (The ﬁrst order estimates are
due to Erd˝os and Lehner [155] who gave an elementary derivation and also obtained the limit
distribution of the number of summands in both cases: they are a double exponential (for P)
and a Gaussian (for Q).)

VIII. 7. Large powers
The extraction of coefﬁcients in powers of a ﬁxed function and more generally
in functions of the form A(z)B(z)n constitutes a prototypical and easy application of

548
VIII. SADDLE POINT ASYMPTOTICS
the saddle point method. We will accordingly be concerned here with the problem of
estimating
(73)
[zN]A(z) · B(z)n =
1
2iπ
I
A(z)B(z)n
dz
zn+1 ,
as both n and N get large. This situation generalizes directly the example of inverse
factorials and the exponential, where we have dealt with a coefﬁcient extraction equiv-
alent to [zn](ez)n (see pp. 515 and 520), as well as the case of the central binomial
coefﬁcients, where an estimate of [zn](1 + z)2n is wanted (p. 515). General estimates
relative to (73) are derived in Subsections VIII. 7.1 (bounds) and VIII. 7.2 (asymp-
totics). We ﬁnally discuss perturbations of the basic saddle point paradigm in the case
of large powers (Subsection VIII.7.3): Gaussian approximations are obtained in a
way that generalizes “local” versions of the Central Limit Theorem for sums of dis-
crete random variables. This last subsection paves the way for the analysis of limit
laws in the next chapter, where the rich framework of “quasi-powers” will be shown
to play a central rˆole in so many combinatorial applications.
VIII. 7.1. Large powers: saddle-point bounds. We consider throughout this
section two ﬁxed functions, A(z) and B(z) satisfying the following conditions:
L1: The functions A(z) = P
j≥0 ajzj and B(z) = P
j≥0 bjzj are analytic at 0
and have nonnegative coefﬁcients; furthermore it is assumed (without loss
of generality) that B(0) ̸= 0.
L2: The function B(z) is aperiodic in the sense that gcd

j
 bj > 0
	
= 1.
(Thus B(z) is not a function of the form β(zp) for some integer p > 0 and
some β analytic at 0.)
L3: Let R ≤∞be the radius of convergence of B(z); the radius of convergence
of A(z) is at least as large as R.
Deﬁne the quantity T called the spread:
(74)
T :=
lim
x→R−
xB′(x)
B(x) .
Our purpose is to analyse the coefﬁcients
[zn] A(z) · B(z)n,
when N and n are linearly related. The condition N < T n will be imposed: it is both
technically needed in our proof and inherent in the nature of the problem. (For B a
polynomial of degree d, the spread is T = d; for a function B whose derivative at
its dominant positive singularity remains bounded, the spread is ﬁnite; for B(z) = ez
and more generally for entire functions, the spread is T = ∞.)
Saddle point bounds result almost immediately from the previous assumptions.
Proposition VIII.9 (Saddle point bounds for large powers). Consider functions A(z)
and B(z) satisfying the conditions L1, L2, L3 above. Let λ be ﬁxed a positive number
with 0 < λ < T and let ζ be the unique positive root of the equation
ζ B′(ζ)
B(ζ) = λ.

VIII. 7. LARGE POWERS
549
Then, with N = λn an integer, one has
[zN]A(z) · B(z)n ≤A(ζ)B(ζ)nζ−N.
PROOF. The existence and unicity of ζ is guaranteed by an argument already encoun-
tered several times (Note 44, p. 266, and Note 4, p. 516). The conclusion then follows
by an application of general saddle point bounds (Corollary VIII.1, p. 514).
□
EXAMPLE VIII.10.
Entropy bounds for binomial coefﬁcients. Consider the problem of esti-
mating the binomial coefﬁcients
` n
λn
´
for some λ with 0 < λ < 1. It is assumed that N = λn
is an integer. Proposition VIII.9 provides
 
n
λn
!
= [zN](1 + z)n ≤(1 + ζ)nζ−N,
where
ζ
1+ζ = λ, i.e., ζ =
λ
1−λ. A simple computation then shows that
2−n
 
n
λn
!
≤exp(nH(λ)),
where
H(λ) = −λ log λ −(1 −λ) log(1 −λ)
is the entropy function. Thus, for λ ̸=
1
2, the binomial coefﬁcients
` n
λn
´
are exponentially
smaller than the central coefﬁcient
` n
n/2
´
, and the entropy function precisely quantiﬁes this
exponential gap. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE VIII.10. □
 VIII.30. Anomalous dice games. The probability of a score equal to λn in n casts of an
unbiased die is bounded from above by a quantity of the form e−nK where
K = −6 + log
„1 −ζ6
1 −ζ
«
−(λ −1) log ζ,
and ζ is an algebraic function of λ determined by P5
j=0(λ −j)ζj = 0.

 VIII.31. Large deviation bounds for sums of random variables. Let g(u) = E(uX) be the
probability generating function of a discrete random variable X ≥0 and let µ = g′(1) be the
corresponding mean (assume µ < ∞). Set N = λn and let ζ be the root of ζg′(ζ)/g(ζ) = λ
assumed to exist within the domain of analyticity of g. Then, for λ < µ, one has
X
k≤N
[uk]g(u)n ≤
1
1 −ζ g(ζ)nζ−N.
Dually, for λ > µ, one ﬁnds
X
k≥N
[uk]g(u)n ≤
ζ
ζ −1g(ζ)nζ−N.
These are exponential bounds on the probability that n copies of the variable X have a sum
deviating substantially from the expected value.

VIII. 7.2. Large powers: saddle point analysis. The saddle point bounds for
large powers are technically shallow but useful, whenever only rough order of magni-
tude estimates are sought. In fact, the full saddle point method is applicable under the
very conditions of the preceding proposition.

550
VIII. SADDLE POINT ASYMPTOTICS
Theorem VIII.6 (Saddle point analysis for large powers). Under the conditions of
Proposition VIII.9, one has
(75)
[zN]A(z) · B(z)n = A(ζ)
B(ζ)n
ζN+1√2πnξ (1 + o(1)).
where ζ is the unique root of ζB′(ζ)/B(ζ) = λ and
ξ = d2
dζ2 (log B(ζ) −λ log z) .
In addition, a full expansion in descending powers of n exists.
These estimates hold uniformly for λ in any compact interval of (0, T ), i.e., any
interval [λ′, λ′′] with 0 < λ′ < λ′′ < T , where T is the spread.
PROOF. We discuss the analysis corresponding to a ﬁxed λ. For any ﬁxed r such that
0 < r < R, the function |B(reiθ)| is, by positivity of coefﬁcients and aperiodicity,
uniquely maximal at θ = 0 (see The Daffodil Lemma on p. 253). It is also inﬁnitely
differentiable at 0. Consequently there exists a (small) angle θ1 ∈(0, π) such that
|B(reiθ)| ≤|B(reiθ1)|
for all θ ∈[θ1, π],
and at the same time, |B(reiθ)| is strictly decreasing for θ ∈[0, θ1] (it is given by a
Taylor expansion without linear term).
We carry out the integration along the saddle point circle, z = ζeiθ, where the
previous inequalities on |B(z)| hold. The contribution for |θ| > θ1 is exponentially
negligible. Thus, up to exponentially small terms, the sought coefﬁcient is given
asymptotically by J(θ1), where
J(φ) = 1
2π
Z φ1
−φ1
A(ζeiφ)B(ζeiφ)eniφ dφ.
It is then possible to impose a second restriction on θ, by introducing θ0 according to
the general heuristic, namely, nθ2
0 →∞, nθ3
0 →0. We ﬁx here
θ0 ≡θ0(n) = n−2/5.
By the decrease of |B(ζeiθ)| on [θ0, θ1] and by local expansions, the quantity J(θ1)−
J(θ0) is of the form exp(−cn1/5) for some c > 0, that is, exponentially small.
Finally, local expansion are valid in the central range since θ0 tends to 0 as n →
∞. One ﬁnds for z = ζeiθ and |θ| ≤θ0,
A(z)B(z)n ∼A(ζ)B(ζ)nζ−N exp(−nξθ2/2).
Then the usual process applies upon completing the tails, resulting in the stated esti-
mate. A complete expansion in powers of n−1/2 is obtained by extending the expan-
sion of log B(z) to an arbitrary order (like in the case of Stirling’s formula, p. 522).
Furthermore, by parity, all the involved integrals of odd order vanish so that the ex-
pansion turns out to be in powers of 1/n (rather than 1/√n).
□

VIII. 7. LARGE POWERS
551
EXAMPLE VIII.11.
Central binomials and trinomials, Motzkin numbers. An automatic ap-
plication of Theorem VIII.6 is to the central binomial coefﬁcient
`2n
n
´
= [zn](1 + z)2n. In the
same way, one gets an estimate of the central trinomial number,
Tn := [zn](1 + z + z2)n
shown to satisfy
Tn ∼3n+1/2
2√πn .
The Motzkin numbers count unary-binary trees,
Mn = [zn]M(z)
where
M = z(1 + M + M 2).
The standard approach is the one seen earlier based on singularity analysis as the implicitly
deﬁned function M(z) has an algebraic singularity of the √-type, but the Lagrange inversion
formula provides an equally workable route. It gives
Mn+1 =
1
n + 1[zn](1 + z + z2)n+1,
which is amenable to saddle point analysis via Theorem VIII.6, leading to
Mn ∼3n+1/2
2
√
πn3 .
See below p. 552 for more on this theme. . . . . . . . . . . . . . . . . . . END OF EXAMPLE VIII.11. □
We have opted for a basic formulation of the theorem with conditions on A and B
that are not minimal. It is easily recognized that the estimates of Theorem VIII.6
continue to hold, provided that the function |B(reiθ)| attains a unique maximum on
the positive real axis, when r ∈(0, T ) is ﬁxed and θ varies on [−π, π]. Also, in order
for the statement to hold true, it is only required that the function A(z) does not vanish
on (0, T ), and A(z) or B(z) could then well be allowed to have negative coefﬁcients:
see Note 35. Finally, if A(ζ) = 0, then a simple modiﬁcation of the argument still
provides precise estimates in this vanishing case; see Note 34 below.
 VIII.32. Central Stirling numbers. The central Stirling numbers of both kinds satisfy
n!
(2n)!
"
2n
n
#
∼c1An
1 n−1/2 `
1 + O(n−1)
´
,
n!
(2n)!
(
2n
n
)
∼c2An
2 n−1/2 `
1 + O(n−1)
´
,
where A1 .= 2.45540, A2 .= 1.54413, and A1, A2 are expressible in terms of special values of
the Cayley tree function. Similar estimates hold for
ˆαn
βn
˜
and
˘αn
βn
¯
.

 VIII.33. Integral points on high-dimensional spheres. This note is based on an article by
Mazo and Odlyzko [353]. Let L(n, α) be the number of lattice points (i.e., points with integer
coordinates) in n-dimensional space that lie on the sphere of radius N = √αn assumed to be
an integer. Then,
L(n, α) = [zN]Θ(z)n,
where
Θ(z) :=
X
n∈Z
zn2 = 1 + 2
∞
X
n=1
zn2.
Thus, there are computable constants C, D depending on a such that L(n, α) ∼Cn−1/2Dn.
The number of lattice points inside the sphere can be similarly estimated. (Such bounds are
useful in coding theory, combinatorial optimization, especially the knapsack problem, and cryp-
tography.)


552
VIII. SADDLE POINT ASYMPTOTICS
 VIII.34. Coalescence of a saddle point with roots of the multiplier.
Fix ζ and take a
multiplier A(z) in Theorem VIII.6 such that A(ζ) = 0, but A′(ζ) ̸= 0. The formula (75) is
then to be modiﬁed as follows:
[zN]A(z) · B(z)n =
ˆ
A′(ζ) + ζA′′(ζ)
˜
B(ζ)n
ζN+1p
2πn3ξ3 (1 + o(1)).
Higher order cancellations can also be taken into account.

 VIII.35. A function with negative coefﬁcients that is minimal along the positive axis. Take
B(z) = 1 + z −z10 with |z| ≤
1
10. By design, B(z) has negative Taylor coefﬁcients. On the
other hand, |B(reiθ)| for ﬁxed r ≤
1
10 (say) attains its unique maximum at θ = 0. The saddle
point method still applies and an estimate of [zn]B(z)n is obtained by (75).

Large powers: saddle points versus singularity analysis. In general, the La-
grange inversion formula establishes an exact correspondence between two a priori
different problems, namely,
— the estimation of coefﬁcients of large order in large powers, and
— the estimation of coefﬁcients of implicitly deﬁned functions.
In one direction, the Lagrange Inversion Theorem has the capacity of bringing
the evaluation of coefﬁcients of implicit functions into the orbit of the saddle point
method. Indeed, let Y be deﬁned implicitly by Y = zφ(Y ), where φ is analytic at 0
and aperiodic. One has, by Lagrange,
[zn+1]Y (z) =
1
n + 1[wn]φ(w)n+1,
which is of the type (75). Then, under the assumption that the characteristic equa-
tion φ(τ) −τφ′(τ) has a positive root within the disc of convergence of φ, a direct
application of Theorem VIII.6 yields
[zn]Y (z) ∼γ
ρ−n
2
√
πn3 ,
ρ :=
τ
φ(τ),
γ :=
s
2φ(τ)
φ′′(τ).
This last estimate is equivalent to the statement of Theorem VII.2 on page 435, ob-
tained there by singularity analysis. (As we know from Chapter VII, this provides
the number of trees in a simple variety, with φ being the degree generating function
of the variety.) This approach is in a few cases more convenient to work with than
singularity analysis, especially when explicit or uniform upper bounds are required,
since constructive bounds tend to be more easily obtained on circles than on variable
Hankel contours (Note 36).
Conversely, the Lagrange Inversion Theorem makes it possible to approach large
powers problems by means of singularity analysis of an implicitly deﬁned function4.
This mode of operation can prove quite useful when there occurs a coalescence be-
tween saddle points and singularities of the integrand (Note 37).
4This is in essence an approach suggested by several sections of the original memoir of Darboux[106,
§3–§5], in which “Darboux’s method” discussed in Chapter VI was ﬁrst proposed. It is also of interest to
note that a Lagrangean change of variables transforms a saddle point circe into a contour whose geometry
is of the type used in singularity analysis.

VIII. 7. LARGE POWERS
553
 VIII.36. An assertion of Ramanujan. In his ﬁrst letter to Hardy, Ramanujan (1913) an-
nounced that
1
2en = 1 + n
1! + n2
2! + · · · +
nn−1
(n −1)! + nn
n! θ,
where
θ = 1
3 +
4
135(n + k),
and k lies between
8
45 and
2
21. Ramanujan’s assertion indeed holds for all n ≥1; see [187] for
a proof based on saddle points and effective bounds.

 VIII.37. Coalescence between a saddle-point and a singularity. The integral in
In := [yn](1 + y)2n(1 −y)−α =
1
2iπ
Z
0+
(1 + y)2n
(1 −y)α
dy
yn+1 ,
can be treated directly, but this requires a suitable adaptation of the saddle-point method, given
the coalescence between a saddle point at 1 [the part without the (1 −y)α factor] and a
singularity at that same point. Alternatively, it can be subjected to the change of variables
z = y/(1 + y)2. Then y is deﬁned implicitly by y = z(1 + y)2, so that
In =
1
2iπ
Z
0+
1 + y
(1 −y)1+α
dz
zn+1 = [zn]
1 + y
(1 −y)1+α .
Since y(z) has a square-root singularity at z = 1/4, the integrand is of type Z−(1+α)/2, and
In ∼22n−α
Γ( α+1
2 )n(α−1)/2.
In general, for φ(y) satisfying the assumptions (relative to B) of Theorem VIII.6, one
ﬁnds, with τ : φ(τ) −τφ′(τ) = 0),
1
2iπ
Z
0+
φ(y)n
(φ(τ) −φ(y))α
dy
yn ∼c
„φ(τ)
τ
«n n(α−1)/2
Γ( α+1
2 ) .
Van der Waerden discuses this problem systematically in [479]. See also Section VIII. 9 below
for other coalescence situations.

VIII. 7.3. Large powers: Gaussian forms. Saddle point analysis has conse-
quences for multivariate asymptotics and it constitutes a direct way of establishing
that many discrete distributions tend to the Gaussian law in the asymptotic limit. For
large powers, this property derives painlessly from our earlier developments, espe-
cially Theorem VIII.6, by means of a “perturbation” analysis.
First, let us examine a particularly easy problem: How do the coefﬁcients of
[zN]enz vary as a function of N when n is some large but ﬁxed number? These
coefﬁcients are
C(n)
N
= [zN]enz = nN
N! .
By the ratio test, they have a maximum when N ≈n and are small when N differs
signiﬁcantly from n; see Figure 9. The bell-shaped proﬁle is also apparent on the ﬁg-
ure and is easily veriﬁed by elementary real analysis. The situation is then parallel to
what is already known of the binomial coefﬁcients on the nth line of Pascal’s triangle,
corresponding to [zN](1 + z)n with N varying.
The asymptotically Gaussian character of coefﬁcients of large powers is actually
universal amongst a wide class of analytic functions. We prove this within the frame-
work of large powers already investigated in Subsection VIII.7.1 and consider the

554
VIII. SADDLE POINT ASYMPTOTICS
200
0.04
0.03
100
0
50
0.01
0.02
0
150
FIGURE VIII.9. The coefﬁcients [zN]enz, when n = 100 is ﬁxed and N = 0 . . 200
varies, have a bell-shaped aspect. (The coefﬁcients are normalized by e−n.)
general problem of estimating the coefﬁcients [zN] (A(z) · B(z)n) as N varies. In ac-
cordance with the conditions on p. 548, we postulate the following: (L1): A(z), B(z)
are analytic at 0, have nonnegative coefﬁcients, and are such that B(0) ̸= 0; (L2):
B(z) is aperiodic; (L3) The radius of convergence R of B(z) is a minorant of the
radius of convergence of A(z). We also recall that the spread has been deﬁned as
T := limx→R−xB′(x)/B(x).
Theorem VIII.7 (Large powers and Gaussian forms). Consider the “large powers”
coefﬁcients:
(76)
C(n)
N
:= [zN] (A(z) · B(z)n) .
Assume that the two analytic functions A(z), B(z) satisfy the conditions (L1), (L2),
and (L3) above. Assume also that the radius of convergence of B satisﬁes R > 1.
Deﬁne the two constants:
µ = B′(1)
B(1) ,
σ2 = B′′(1)
B(1) + B′(1)
B(1) −
B′(1)
B(1)
2
(σ > 0).
Then the coefﬁcients C(n)
N
for ﬁxed n as N varies have an asymptotically Gaussian
proﬁle in the precise sense that for N = µn + x√n, there holds (as n →∞)
(77)
1
A(1)B(1)n C(n)
N
=
1
σ
√
2πne−x2/(2σ2) 
1 + O(n−1/2)

,
uniformly with respect to x, when x belongs to a ﬁnite interval of the real line.
PROOF. We start with a few easy observation that shed light on the global behaviour
of the coefﬁcients. First, since R > 1, we have the exact summation,
∞
X
N=0
C(n)
N
= A(1)B(1)n,

VIII. 7. LARGE POWERS
555
which explains the normalization factor in the estimate (77). Next, by deﬁnition of the
spread and since R > 1, one has
µ = B′(1)
B(1) < T =
lim
x→R−
xB′(x)
B(x) ,
given the general property that xB′(x)/B(x) is increasing. Thus, the estimation of
the coefﬁcients in the range N = µn ± O(√n) falls into the orbit of Theorem VIII.6
which expresses the results of the saddle point analysis in the case of large powers.
Referring to the statement of Theorem VIII.6, the saddle point equation is
ζ B′(ζ)
B(ζ) = B′(1)
B(1) + x
√n,
with ζ a function of x and n. For x in a bounded set, we thus have ζ ∼1 as n →∞. It
then sufﬁces to effect an asymptotic expansion of the quantities ζ, A(ζ), B(ζ), ξ in the
saddle point formula of Equation (75). In other words, the fact that N is close to µn
induces for ζ a small perturbation with respect to the value 1. With aj := A(j)(1) and
bj := B(j)(1), one ﬁnds mechanically
ζ
=
1 +
b2
0
b0b2 + b0b1 −b1
2
x
√n + O(n−1)
B(ζ)
ζµ
=
b0 + x2
2n
b3
0
b0b2 + b0b1 −b1
2 + O(n−3/2),
and so on. The statement follows.
□
Take ﬁrst A(z) ≡1. In the particular case when B(z) is the probability generating
function of a discrete random variable Y , one has B(1) = 1, and the coefﬁcient
µ = B′(1) is the mean of the distribution. The function B(z)n is then the probability
generating function (PGF) of a sum of n independent copies of Y . Theorem VIII.7
then describes a Gaussian approximation of the distribution of the sum near the mean.
Such an approximation is called a local limit law, where the epithet “local” refers
to the fact that the estimate applies to the coefﬁcients themselves. (In contrast, an
approximation of the partial sums of the coefﬁcients by the Gaussian error function
is known as a central limit law or as an integral limit law.) In the more general
case where A(z) is also a probability generating function of a nondegenerate random
variable (i.e., A(z) ̸= 1), similar properties hold and one has:
Corollary VIII.3 (Local limit law for sums). Let X be a random variable with prob-
ability generating function (PGF) A(z) and Y1, . . . , Yn be independent variables with
PGF B(z), where it is assumed that X and the Yj are supported on Z≥0. Assume that
A(z) and B(z) are analytic in some disc that contains the unit disc in its interior and
that B(z) is aperiodic. Then the sum,
Sn := X + Y1 + Y2 + · · · + Yn,
satisﬁes a local limit law of the Gaussian type: For x in any ﬁnite interval, one has
P
 Sn = ⌊µn + tσ√n⌋

= e−t2/2
√
2πn

1 + O(n−1/2)

.

556
VIII. SADDLE POINT ASYMPTOTICS
PROOF. This is just a restatement of Theorem VIII.7, setting x = tσ and taking into
account A(1) = B(1) = 1.
□
Gaussian forms for large powers admit many variants. As already pointed out
in Section VIII.4, the positivity conditions can be greatly relaxed. Also, estimates
for partial sums of the coefﬁcients are possible by similar techniques. The asymp-
totic expansions can be extended to any order. Finally, suitable adaptations of The-
orems VIII.6 and VIII.7 make it possible to allow x to tend slowly to inﬁnity and
manage what is known as a “moderate deviation” regime. We do not pursue these as-
pects here since we shall develop a more general framework, that of “Quasi-Powers”
in the next chapter.
 VIII.38. An alternative proof of Corollary VIII.3. The saddle point ζ is near 1 when N is near
the centre N ≈µn. It is alternatively possible to recover the C(N)
n
by Cauchy’s formula upon
integrating along the circle |z| = 1, which is then only an approximate saddle point contour.
This convenient variant is often used in the literature, but one needs to take care of linear terms
in expansions. Its origins go back to Laplace himself in his ﬁrst proof of the local limit theorem
(which was expressed however in the language of Fourier series as Cauchy’s theory was yet
to be born). See Laplace’s treatise Th´eorie Analytique des Probabilit´es [328] ﬁrst published in
1812 for much fascinating mathematics.

VIII. 8. Saddle points and probability distributions
Saddle point methods are useful not only for estimating combinatorial counts, but
also for extracting probabilistic characteristics of large combinatorial structures. In the
previous section, we have already encountered the large powers framework, giving rise
to Gaussian laws. In this section, we further examine the way a saddle point analysis
can serve to quantify properties of random structures. There is an extreme diversity of
possible situations, which partly defy classiﬁcation. so that we must content ourselves
with the discussion of a single representative example. (A good rule of thumb is once
more that the saddle point method is likely to succeed in cases involving some sort
of exponential growth of GFs.) Note that problems of a true multivariate nature will
be examined in the next chapter speciﬁcally dedicated to multivariate asymptotics and
limit distributions.
EXAMPLE VIII.12.
Capacity in occupancy problems. This example is relative to random
allocations, occupancy statistics, and balls-in-bin models, as already introduced in Chapter II.
We limit ourselves here to saddle point bounds. (The various regimes of the distribution are
well covered in [316, pp. 94–115].)
Assume that n balls are thrown into n bins, uniformly at random. How many balls does the
most ﬁlled bin contain? We shall in fact deal with a generalized version of the problem where
n balls are thrown into m bins, in the regime n = αm for some ﬁxed α in (0, +∞). The size
of the most ﬁlled bin will be called the capacity and we let Cn,m denote the random variable,
when all mn tables are taken equally likely. Under our conditions a random bin contains on
average a constant number, α, of balls. The proposition below proves that the most ﬁlled bin
has somewhat more, as exempliﬁed by Figure 10.
Proposition VIII.10. Let n and m tend simultaneously to inﬁnity, with the constraint that
n
m = α remains constant. Then, the expected capacity satisﬁes
1
2
log n
log log n(1 + o(1)) ≤E{Cn,m} ≤2
log n
log log n(1 + o(1)).

VIII. 8. SADDLE POINTS AND PROBABILITY DISTRIBUTIONS
557
FIGURE VIII.10. Three random allocations of n = 50 balls in m = 50 bins.
In addition, the probability of capacity to lie outside the interval determined by the lower and
upper bounds tends to 0 as m, n →∞.
PROOF. We detail the proof when α = 1 and abbreviate Cn = Cn,m, the generalization to
α ̸= 1 requiring only simple adjustments. From Chapter II, we know that
(78)
8
>
<
>
:
P{Cn ≤b}
=
n!
nn [zb](eb(z))n
P{Cn > b}
=
n!
nn (enz −(eb(z))n),
where eb(z) is the truncated exponential:
eb(z) =
b
X
j=0
zj
j! .
The two equalities of (78) permit us to bound the left and right tails of the distribution. As
suggested by the Poisson approximation of balls-in-bins model, we decide to adopt saddle point
bounds based on z = 1. This gives
(79)
8
>
>
<
>
>
:
P{Cn ≤b}
≤
n!en
nn
„eb(1)
e
«n
P{Cn > b}
≤
n!en
nn
„
1 −
„eb(1)
e
«n«
.
We set
(80)
ρb(n) =
„eb(1)
e
«n
.
This quantity represents the probability that n Poisson variables of rate 1 all have value b or less.
(We know for elementary probability theory that this should be a reasonable approximation of
the problem at hand.) A weak form of Stirling’s formula, namely, n!en
nn < 2√πn
(n ≥1),
then yields an alternative version of (79),
(81)
P{Cn ≤b}
≤
2√πnρb(n)
P{Cn > b}
≤
2√πn (1 −ρb(n)).
For ﬁxed n, the function ρb(n) increases steadily from e−n to 1 as b varies from 0 to ∞.
In particular, the “transition region” where ρb(n) stays away from both 0 and 1 is expected to
play a rˆole. This suggests deﬁning b0 ≡b0(n) such that
b0! ≤n < (b0 + 1)!,
so that
b0(n) =
log n
log log n(1 + o(1)).

558
VIII. SADDLE POINT ASYMPTOTICS
We also observe that, as n, b →∞, there holds
(82)
ρb(n)
=
(e−1eb(1))n =
„
1 −
e−1
(b + 1)! + O(
1
(b + 2)!)
«n
=
exp
„
−ne−1
(b + 1)! + O(
n
(b + 2)!)
«
.
Left tail. We take b = ⌊1
2b0⌋and a simple computation from (82) shows that for n large
enough, ρb(n) ≤exp(−3√n). Thus, by the ﬁrst inequality of (81), the probability that the
capacity be less than 1
2b0 is exponentially small:
(83)
P{Cn ≤1
2b0(n)} ≤2√πn exp(−3√n).
Right tail. Take b = 2b0. Then, again from (82), for n large enough, one has 1 −ρb(n) ≤
1 −exp(−1
n) = 1
n(1 + o(1)). Thus, the probability of observing a capacity that exceeds 2b0
is vanishingly small, and is O(n−1/2). Taking next b = 2b0 + r with r > 0, similarly gives the
bound
(84)
P{Cn > 2b0(n) + r} ≤2
r
π
n
„
1
b0(n)
«r
.
The analysis of the left and right tails in Equations (83) and (84) now implies
(85)
8
>
>
>
>
<
>
>
>
>
:
E {Cn}
≤
2b0(n) +
∞
X
r=0
2
r
π
n(b0(n))−r = 2b0(n)(1 + o(1))
E {Cn}
≥
⌊1
2 b0(n)⌋
X
r=0
ˆ
1 −2√πn exp(−3√n)
˜
= 1
2b0(n)(1 + o(1)).
This justiﬁes the claim of the proposition when α = 1. The general case (α ̸= 1) follows
similarly from saddle point bounds taken at z = α.
□
The saddle point bounds described above are obviously not tight: with some care in deriva-
tions, one can show by the same means that the distribution is tightly concentrated around its
mean, itself asymptotic to log n/ log log n. In addition, the saddle point method may be used
instead of crude bounds. These results, in the context of longest probe sequences in hashing,
were obtained by Gonnet [242] under the Poisson model. Many key estimates regarding random
allocations (including capacity) are to be found in the book by Kolchin et al. [316]. Analyses of
this type are also useful in evaluating various dynamic hashing algorithms by means of saddle
point methods [171, 408]. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE VIII.12. □
VIII. 9. Multiple saddle points
We conclude this chapter with a discussion of higher order saddle points, ac-
companied by brief indications on what are known as phase transitions or critical
phenomena in the applied sciences.
Multiple saddle point formula. All the analyses carried out so far have been in
terms of simple saddle points, which represent by far the most common situation. In
order to get a feel of what to expect in the case of multiple saddle points, consider ﬁrst
the problem of estimating the two real integrals,
In :=
Z 1
0
(1 −x2)n dx,
Jn :=
Z 1
0
(1 −x3)n dx.

VIII. 9. MULTIPLE SADDLE POINTS
559
FIGURE VIII.11. Two views of a double saddle point also known as “monkey saddle”.
(For the purpose of this discussion, we ignore the fact that the integrals can be eval-
uated in closed form by way of the Beta function.) The contribution of any interval
[x0, 1] is exponentially small, and the ranges to be considered on the right of 0 are
about n−1/2 and n−1/3, respectively. One thus sets
x =
t
2√n
for In,
x =
t
3√n
for Jn.
Then local expansions apply, tails can be completed in the usual way, to the effect that
In ∼
1
2√n
Z ∞
0
e−t2 dt,
Jn ∼
1
3√n
Z ∞
0
e−t3 dt.
The integrals reduce to the Gamma function integral, which provides
In ∼1
2
Γ( 1
2)
n
1
2 ,
Jn ∼1
3
Γ( 1
3)
n
1
3 .
The repeated occurrences of 1
2 in the quadratic case and of 1
3 in the cubic case stand
out. The situation in the cubic case corresponds to the Laplace method for integrals
being used when a multiple critical point is present.
What has been just encountered in the case of real integrals is typical of what to
expect for complex integrals and saddle points of higher orders. Consider, for simplic-
ity, the case of a double saddle point of an analytic function F(z). At such a point ζ,
we have F(ζ) ̸= 0, F ′(ζ) = F ′′(ζ) = 0, and F ′′′(ζ) ̸= 0. Then, there are three
steepest descent lines emanating from the saddle point and three steepest ascent lines.
Accordingly, one should think of the landscape of |F(z)| as formed of three “valleys”
separated by three mountains and meeting at the common point ζ. The characteristic
aspect is that of of a “monkey saddle” (comparable to a saddle with places for two
legs and a tail) and is displayed in Figure 11. We can then enounce a modiﬁed form
of the saddle point formula of Theorem VIII.3.
Theorem VIII.8. Consider an integral
R B
A F(z) dz, where the integrand F = ef is
an analytic function depending on a large parameter and A, B lie in adjacent valleys

560
VIII. SADDLE POINT ASYMPTOTICS
across a double saddle point ζ, which is a root of the saddle point equation
f ′(ζ) = f ′′(ζ) = 0,
or, equivalently, F ′(ζ) = F ′′(ζ) = 0. Assume that the contour C connecting A to B
can be split into C = C(0) ∪C(1) in such a way that the following conditions are
satisﬁed: (i) the tail integral
R
C(1) is negligible; (ii) in the central domain C(0), a
cubic approximation holds,
f(z) = f(ζ) + 1
3!f ′′′(ζ)(z −ζ) + O(ηn), ;
with ηn →0 as n →∞uniformly; (iii) tails can be completed back. Then one has
(86)
1
2iπ
Z B
A
ef(z) dz ∼±ω Γ( 1
3)
2iπ
ef(ζ)
3p
|f ′′′(ζ)|
,
where ω is a cube root of unity (ω3 = 1) dependent upon the position of the valleys
of A and B, while the sign ± depends on orientation.
PROOF. The proof is a simple adaptation of that of Theorem VIII.3. The heart of the
matter is now the integration of
Z
C
exp
 1
3!f ′′′(ζ)(z −ζ)3

dz,
with C composed of the two rays te2ijπ/3 and te2i(j+1)π/3, for t ∈R≥0.
□
 VIII.39. Higher-order saddle points. For a saddle point of order p + 1, the saddle point
formula reads
1
2iπ
Z B
A
ef(z) dz ∼±ω
Γ( 1
p)
2iπ
ef(ζ)
pp
|f(p)(ζ)|
,
where ωp = 1.

 VIII.40. Vanishing multipliers and multiple saddle points. This note supplements Note 39.
For a saddle point of order p + 1 and an integrand of the form (z −ζ)b · ef(z), the saddle point
formula must be modiﬁed according to
Z ∞
0
xbe−axp/p! dx = 1
p
„ a
p!
«b+1
p!Γ
„b + 1
p!
«
.
Thus, the argument of the Γ factor is changed from 1
p to b+1
p , as is the exponent of |f (p)(ζ)|
and of n in the case of large power estimates.

Forests and coalescence of saddle points. We give below an application to the
counting of forests of unrooted trees made of a large number of trees. The analysis
precisely involves a double saddle point in a certain critical region. The problem is
in particular relevant to the analysis of random graphs during the phase where a giant
component has not yet emerged.
EXAMPLE VIII.13.
Forests of unrooted trees. The problem here consists in determining the
number Fm,n of ordered forests, i.e., sequences, made of m (labelled, nonplane) unrooted trees
and comprised of n nodes in total. The number of unrooted trees of size n is, by virtue of

VIII. 9. MULTIPLE SADDLE POINTS
561
0.2
0
0.4
0.6
0.2
1
a
0
0.8
1
0.8
0.6
0.4
0.4
0.6
0.2
0
0.4
0.2
1
0.8
0.8
0.6
FIGURE VIII.12. The function H governing the exponential rate of the number of
forests exhibits a “phase transition” at α =
1
2 (left); the quantity
1
n log(Fm,n/n!) as a
function of α = m/n for n = 200 (right).
Cayley’s formula, nn−2 and its EGF is expressed as U = T −T 2/2, where T is the Cayley
tree function satisfying T = zeT . Consequently, we have
1
n!Fm,n = [zn]
„
T(z) −T(z)2
2
«m
=
1
2iπ
Z
0+
„
T −T 2
2
«m
dz
zn+1 .
Like in the analytic proof of the Lagrange Inversion Theorem it proves convenient to adopt
t = T as an independent variable, so that z = te−t becomes a dependent variable. Since
dz = (1 −t)e−t, this provides the integral representation:
1
n!Fm,n =
1
2iπ
Z
0+
„
t −1
2t2
«m
ent(1 −t)
dt
tn+1 .
The case of interest here is when m and n are linearly related. We thus set m = αn, where a
priori α ∈(0, 1). Then, the integral representation of Fm,n becomes
(87)
1
n!Fm,n =
1
2iπ
Z
C
enhα(t)(1 −t) dt
t ,
hα(t) := α log(1 −t
2) + t + (α −1) log t,
where C encircles 0. This has the form of a “large power” integral. Saddle points are found as
usual as zeros of the derivative h′
α; there are two of them given by
ζ0 = 2 −2α,
ζ1 = 1.
For α < 1
2, one has ζ0 > ζ1 while for α > 1
2 the inequality is reversed and ζ0 < ζ1. In both
cases, a simple saddle point analysis succeeds, based on the saddle point nearer to the origin;
see Note 41 below. In contrast, when α =
1
2, the points ζ0 and ζ1 coalesce to the common
value 1. In this last case, we have h′
1
2 (1) = h′′
1
2 (1) = 0 while h′′′
1
2 (1) = −2 is nonzero: there is
a double saddle point at 1.
The number of forests thus presents two different regimes depending on whether α < 1
2
or α >
1
2, and there is a discontinuity of the analytic form of the estimates at α =
1
2. The
situation is reminiscent of “critical phenomena” and phase transitions (e.g., from solid to liquid
to gas) in physics, where such discontinuities are encountered. This provides a good motivation
to study what happens right at the “critical” value α = 1
2.

562
VIII. SADDLE POINT ASYMPTOTICS
1.5
1
0.5
y
0
-0.5
-1
-1.5
2
1.5
1
0.5
0
-0.5
x
-1
-1.5
0.5
1
1.5
2
2.5
3
x
y
1.5
0
1
1
1.5
-0.5
-1
-1.5
-1
0.5
-1.5
0.5
-0.5
0
FIGURE VIII.13.
A plot of eh with the double saddle point at 1 (left). The
level lines of eh with valleys (the region higher than eh(1) is darkened) and a legal
integration contour (right).
We thus consider the special value α = 1
2 and set h ≡h 1
2 . What is to be determined is
therefore the number of forests of total size n that are made of n/2 trees, assuming naturally n
even. Bearing in mind that the double saddle point is at ζ = ζ0 = ζ1 = 1, one has
h(z) = 1 −1
3(z −1)3 + O((z −1)4)
(z →1).
Thus, upon neglecting the tails and localizing the integral to a disc centred at 1 with radius δ ≡
δ(n) such that
nδ3 →∞,
nδ4 →0
(δ = n−3/10 is suitable), we have the asymptotic equivalence (with y representing z −1)
(88)
1
n!Fm,n = −en(1−1
2 log 2)
2iπ
Z
D
e−ny3/3y dy + exponentially small,
where D is a certain (small) contour containing 0 obtained by transformation from C.
The discussion so far has left aside the choice of the contour C in (87), hence of the
geometric aspect of D near 0, which is needed in order to fully specify (88). Because of the
minus sign in the third derivative, h′′′(1) = −2, the three steepest descent half lines stemming
from 1 have angles 0, e2iπ/3, e−2iπ/3. This suggest to adopt as original contour C in (87) two
symmetric segments stemming from 1 connected by a loop left of 0; see Figure 13. Elementary
calculations justify that the contour can be suitably dimensioned so as to remain always below
level h(1). See also the right drawing of Figure 13 where the level curves of the valleys below
the saddle point are drawn together with a legal contour of integration that winds about 0.
Once the original contour of integration has been ﬁxed, the orientation of D in (88) is fully
determined. After effecting the further change of variables y = wn−1/3 and completing the

VIII. 9. MULTIPLE SADDLE POINTS
563
tails, we ﬁnd
(89)
1
n!Fm,n ∼
λ
n2/3 en(1−1
2 log 2),
λ = −1
2iπ
Z
E
e−y3/3y dy,
where E connects ∞e−2iπ/3 to 0 then to ∞e2iπ/3. The evaluation of the integral giving λ is
now straightforward (in terms of the Gamma function), which gives:
Proposition VIII.11. The number of forests of total size n comprised of n/2 unrooted Cayley
trees satisﬁes
1
n!Fn/2,n ∼2 · 3−1/3
Γ( 2
3)
en(1−1
2 log 2)n−2/3.
The number three is characteristically ubiquitous in the formula. (Furthermore, the formula
displays the exponent 2
3 instead of 1
3 in the general case (88) because of the additional factor
(1 −z) present in the integral representation (87), which vanishes at the saddle point 1; see
Note 40.) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE VIII.13. □
The problem of analysing random forests composed of a large number of trees has
been ﬁrst addressed by the Russian School, most notably Kolchin and Britikov. We
refer the reader to Kolchin’s book [315, Ch. I] where nearly thirty pages are devoted
to a deeper study of the number of forests and of associated parameters. Kolchin’s
approach is however based on an alternative presentation in terms of sums of indepen-
dent random variables and stable laws of index 3
2. As it turns out there is a striking
parallel with the analysis of the growth of the random graph in the critical region,
when the random graph stops resembling a large collection of disconnected tree com-
ponents.
An almost sure sign of (hidden or explicit) monkey saddles is the occurrence of
Γ( 1
3) factors in the ﬁnal formulæ and cube roots in exponents of powers of n. It is in
fact possible to go much further than we have done here with the analysis of forests
(where we have stayed right at the critical point) and provide asymptotic expressions
that describe the transition between regimes, here from Ann−1/2, to Bnn−2/3, then
to Cnn−1/2. The analysis then appeals to the theory of coalescent saddle points well
developed by applied mathematicians (see, e.g., the exposition in [59, 381, 502]) and
the already evoked rˆole of the Airy function. We do not pursue this thread further since
it properly belongs to multivariate asymptotics. It is exposed in a detailed manner in
an article of Banderier, Flajolet, Schaeffer, and Soria [22] relative to the size of the
core in a random map from, on which our presentation of forests has been modelled.
The results of several studies conducted towards the end of the previous millen-
nium do suggest that, amongst threshold phenomena and phase changes, there is a fair
amount of universality in descriptions of combinatorial and probabilistic problems by
means of multiple and coalescing saddle points. In particular Γ( 1
3) factors and the
Airy function surface recurrently in the works of Flajolet, Janson, Knuth, Łuczak and
Pittel [193, 282], which are relative to the Erd˝os–Renyi random graph model in its
critical phase; see also [205] for a partial explanation. The occurrence of the Airy area
distribution (in the context of certain polygon models related to random walks) can be
related to this orbit of techniques, as ﬁrst shown by Prellberg [401], and strong nu-
merical evidence evoked in Chapter V (p. 349) suggests that this might extend to the
difﬁcult problem of self-avoiding walks [411]. Airy-related distributions also appear

564
VIII. SADDLE POINT ASYMPTOTICS
in problems relative to the satisﬁability of random boolean expressions [61], the path
length of trees [461, 459, 460], as well as cost functionals of random allocations[200].
The reasons are sometimes well understood in separate contexts by probabilists, statis-
tical physicists, combinatorialist, and analysts, but a global framework is still missing.
 VIII.41. Forests and simple saddle points.
When 0 < α <
1
2, the number of forests
satisﬁes, for some computable C−(α).
1
n!Fn,m ∼C−(α)eH−(α)
n1/2 ,
H−(α) = 1 −α log 2.
When 1
2 < α < 1, the number of forests satisﬁes, for some computable C+(α),
1
n!Fn,m ∼C+(α)eH+(α)
n1/2 ,
H+(α) = α log α + 2 −2α + (α −1) log(2 −2α).
This results from a routine simple saddle point analysis at ζ1 and ζ0 respectively.

VIII. 10. Perspective
One of the pillars of classical analysis, the saddle-point method plays a major
rˆole in analytic combinatorics. It provides an approach to coefﬁcient asymptotics and
can handle combinatorial classes, which are not amenable to singularity analysis. The
simplest case is that of urns, whose generating function ez has no singularities at a
ﬁnite distance. Similar functions commonly arise as composed SET constructions.
Broadly speaking, for the class of generating functions that arise from the combinato-
rial constructions of Part A of this book, singularity analysis is effective for functions
that have moderate growth at their singularities; the saddle point method is effective
otherwise.
The essential idea behind the saddle point method is simple, and it is very easy
to get good bounds on coefﬁcient growth. In effect, the Cauchy coefﬁcient integral
deﬁnes a surface with a well-deﬁned saddle point somewhere along the positive real
axis, and choosing a circle centred at the origin and passing through the saddle point
already provides useful bounds by elementary arguments. The essence of the full
saddle point method is the development of more precise bounds, which are obtained
by splitting the contour into two parts and balancing the associated errors.
Combinatorial classes that are amenable to saddle-point analysis have so far only
been incorporated into relatively few schemas, compared to what we saw for singu-
larity analysis. The consistency of the approach certainly argues for the existence of
many more such schemas. A positive signal in that direction is the fact that several
researchers have developed concepts of admissibility that serve to delineate classes of
function for which the saddle point method boils down to verifying simple conditions.
The saddle point method also provides insights in more general contexts. Most
notably, the general results on analysis of large powers lay the groundwork for distri-
butional analyses and limit laws, which are the subject of the next chapter.
Saddle point methods take their sources in applied mathematics, one of them being the
asymptotic analysis by Debye (1909) of Bessel functions of large order. Saddle point analy-
sis is sometimes called steepest descent analysis, especially when integration contours strictly
coincide with steepest descent paths. Saddle points themselves are also called critical points
(i.e., points where a ﬁrst derivative vanishes). Because of its roots in applied mathematics, the

VIII. 10. PERSPECTIVE
565
method is well covered by the literature in this area, and we refer to the books by Olver [381],
Henrici [265], or Wong [502] for extensive discussions. A vivid introduction to the subject is to
be found in De Bruijn’s book [111]. We also recommend Odlyzko’s impressive survey [376].
To a large extent, saddle point methods have made an irruption in combinatorial enumera-
tions in the 1950’s. Early combinatorial papers were concerned with permutations (involutions)
or set partitions: this includes works by Moser and Wyman [367, 368, 369] that are mostly
directed towards entire functions.
Hayman’s approach [263] which we have exposed here (see also [502]) is notable in its
generality as it envisions saddle point analysis in an abstract perspective, which makes it possi-
ble to develop general closure theorems. A similar thread was followed by Harris and Schoen-
feld who gave stronger conditions then allowing full asymptotic expansions [261]; Odlyzko
and Richmond [378] were successful in connecting these conditions with Hayman admissibil-
ity. Another valuable work is Wyman’s extension to nonpositive functions [511].
Interestingly enough, developments that parallel the ones in analytic combinatorics have
taken place in other regions of mathematics. Erwin Schr¨odinger introduced saddle point meth-
ods in his lectures [431] at Dublin in 1944 in order to provide a rigorous foundation to some
models of statistical physics that closely resemble balls-in-bins models.
Daniels’ publica-
tion [105] of 1954 is a historical source for saddle point techniques in probability and statistics,
where reﬁned versions of the central limit theorem can be obtained. (See for instance the de-
scription in Greene and Knuth’s book [250].) Since then, the saddle point method has proved a
useful tool for deriving Gaussian limiting distributions. We have given here some idea of this
approach which is to be developed further in a later chapter, where we shall discuss some of
Canﬁeld’s results [76]. Analytic number theory also makes a heavy use of saddle point analysis.
In additive number theory, the works by Hardy, Littlewood, and Ramanujan relative to integer
partitions have been especially inﬂuential, see for instance Andrews’ book [10] and Hardy’s
Lectures on Ramanujan [260] for a fascinating perspective. In multiplicative number theory,
generating functions take the form of Dirichlet series while Perron’s formula replaces Cauchy’s
formula. For saddle point methods in this context, we refer to Tenenbaum’s book [468] and his
seminar survey [467].
A more global perspective on limit probability distributions and saddle point techniques
will be given in the next chapter as there are strong relations to the quasi-powers framework de-
veloped there, to local limit laws, and to large deviation estimates. General references for some
of these aspects of the saddle point method are the articles of Bender–Richmond [27], Can-
ﬁeld [76], and Gardy [227, 228, 229]. Regarding multiple saddle points and phase transitions,
we refer the reader to references provided at the end of Section VIII. 9.


Part C
RANDOM STRUCTURES


IX
Multivariate Asymptotics and Limit
Distributions
Un probl`eme relatif aux jeux du hasard,
propos´e `a un aust`ere janseniste par un homme du monde,
a ´et´e `a l’origine du Calcul des Probabilit´es1.
— SIM´EON–DENIS POISSON
Contents
IX. 1.
Limit laws and combinatorial structures
571
IX. 2.
Discrete limit laws
577
IX. 3.
Combinatorial instances of discrete laws
584
IX. 4.
Continuous limit laws
595
IX. 5.
Quasi-powers and Gaussian limits
600
IX. 6.
Perturbation of meromorphic asymptotics
605
IX. 7.
Perturbation of singularity analysis asymptotics
618
IX. 8.
Perturbation of saddle point asymptotics
638
IX. 9.
Local limit laws
642
IX. 10.
Large deviations
647
IX. 11.
Non-Gaussian continuous limits
650
IX. 12.
Multivariate limit laws
661
IX. 13.
Notes
662
Analytic combinatorics2 deals with the enumeration of combinatorial structures
in relation to algebraic and analytic properties of generating functions. The most ba-
sic cases are the enumeration of combinatorial classes and the analysis of moments of
combinatorial parameters. These involve generating functions in one (formal or com-
plex) variable as discussed extensively in previous chapters. They are consequently
essentially univariate problems.
Many applications, in combinatorics as well as in the applied sciences, require
quantifying the behaviour of parameters of combinatorial structures. It is typically
useful to know that a random permutation of size n has a number of runs whose
average (mean) equals to (n+1)/2, but it may be equally important to know to which
1“A problem relative to games of chance proposed to an austere Jansenist by a man of the world has
been at the origin of the calculus of probabilities.” Poisson refers here to the fact that questions of betting
and gambling posed by the Chevalier de M´er´e (who was both a gambler and a philosopher) led Pascal (an
austere religious man) to develop some the ﬁrst foundations of probability theory.
2Warning: This chapter is still in a very preliminary state (November 2004). It is only included at
this stage in order to illsutrate the global architecture of Analytic Combinatorics.
569

570
IX. MULTIVARIATE ASYMPTOTICS
extent such an average is representative of what occurs in simulations or on actual
data that obey the randomness model. As a matter if fact, in a random permutation of
size n = 1, 000, it is found that there are about 70% chances that the number of runs
be in the interval 990 . . 1010. Even more dramatically, for runs and a permutation of
size n = 1, 000 still, there is probability less than 10−6 to observe a case that deviates
by more than 10% from the mean value; this probability decreases to about 10−65 for
n = 10, 000, and is even less than 10−653 for n = 100, 000. As illustrated by such
numeric data, there is obvious interest in analysing the “central” region near the mean,
as well as in quantifying the risk of ﬁnding instances that deviate appreciably from the
expected value. These are now typically bivariate problems.
It is frequently observed that the histograms of the distribution of a combinatorial
parameter (for varying size values) exhibit a common characteristic “shape”. In this
case, we say that there exists a limit law, which may be of the discrete or the continu-
ous type. Our aim here is to detect such limit laws, and a few examples have already
appeared scattered in this book, in the case where they can be reduced to a collection
of univariate analyses. This chapter provides a coherent set of analytic techniques
dedicated to extracting coefﬁcients of bivariate analytic functions. The mathematics
combine methods of complex asymptotic analysis as previously exposed with a small
selection of fundamental theorems from the analytic side of classical probability the-
ory.
In simpler cases, limit laws are discrete and, when this happens, they often belong
to the geometric or Poisson type. In many other cases, limit laws are continuous, a
prime example being the Gaussian law associated with the famous bell-shaped curve,
which surfaces so frequently in elementary combinatorial structures. The goal of this
chapter is to offer a fundamental analytic framework for extracting limit laws from
combinatorics.
Symbolic methods provide bivariate generating functions for many natural pa-
rameters of combinatorial structures. Analytically, the auxiliary variable marking the
combinatorial parameter under study then induces a deformation of the (univariate)
counting generating function. This deformation may affect the type of singularity that
the counting generating function presents in various ways. A perturbation of univari-
ate singularity analysis is then often sufﬁcient to derive an asymptotic estimate of the
probability generating function of a given parameter, when taken over objects of some
large size. Continuity theorems from probability theory ﬁnally allow us to conclude
on the existence of a limit law.
An especially important component of this paradigm is the framework of “Quasi-
Powers”. Large powers tend to occur for coefﬁcients of generating functions (think
of quantities of the form ≈ρ−n that arise from radius of convergence bounds). The
collection of deformations of a single counting generating function is then likely to
induce for the corresponding coefﬁcients a collection of approximations that involve
large powers together with small error terms—these are referred to as quasi-powers.
From there, a Gaussian laws is derived along lines that are somewhat reminiscent of
the classical central limit theorem of probability theory (expressing the asymptotically
Gaussian character of sums of independent random variables).

IX. 1. LIMIT LAWS AND COMBINATORIAL STRUCTURES
571
The direct relation that can be established between combinatorial speciﬁcations
and asymptotic properties, in the form of limit laws, is especially striking, and it is
a characteristic feature of analytic combinatorics. In fact, almost any classical law
of probability theory and statistics is likely to occur somewhere in analytic combina-
torics. Conversely, almost any simple combinatorial parameter is likely to be governed
by an asymptotic law.
IX. 1. Limit laws and combinatorial structures
What is given is a combinatorial class C, labelled or unlabelled, and an integer
valued combinatorial parameter χ. There results both a family of probabilistic models,
namely for each n the uniform distribution over Cn that assigns to any γ ∈Cn the
probability
P(γ) = 1
Cn
,
with
Cn = card(Cn),
and a corresponding family of random variables obtained by restricting χ to Cn. Under
the uniform distribution over Cn, we then have
PCn(χ = k) = 1
Cn
card

γ ∈Cn
 χ(γ) = k
	
.
We write PCn to indicate the probabilistic model relative to Cn, but also freely abbre-
viate it to Pn or write P(χn) whenever C is clear in context.
As n increases, the histograms of the distributions of χ often share a common
proﬁle; see Figure 1 for two characteristic examples that we discuss next. Our purpose
is to relate such phenomena to the analysis of bivariate generating functions provided
by the symbolic method.
Binary words. Let us start by discussing the case of binary words with two simple
parameters, one leading to a discrete law, the other to a continuous limit. The ex-
ample is purposely chosen simple enough that explicit expressions are available for
the probability distributions at stake. Nonetheless, it is typical of the approach taken
in this chapter, and, once equipped with suitably general theorems, it is hardly more
difﬁcult to discuss the number of leaves in a nonplane unlabelled tree or the number
of summands in a composition into prime summands.
Take the class Wn of binary words of length n over the alphabet {a, b} and con-
sider the two parameters for w ∈W:
χ(w) := number of initial a’s in w,
ξ(w) := total number of a’s in w.
Explicit expressions are available for the counts and
PWn(χ = k)
=
1
2k+1 [[0 ≤k < n]] + 1
2n [[k = n]],
PWn(ξ = k)
=
1
2n
n
k

.
The probabilities relative to χ then resemble, in the asymptotic limit of large n, the

572
IX. MULTIVARIATE ASYMPTOTICS
0
0.1
0.2
0.3
0.4
0.5
2
4
6
8
10
0
0.05
0.1
0.15
0.2
0.25
0.3
0.35
0.2
0.4
0.6
0.8
1
FIGURE IX.1.
Histograms of probability distributions for the number of initial
a’s in a random binary string (parameter χ, left) and the total number of a’s
(parameter ξ, right). The histogram corresponding to χ is not normalized and
direct convergence to a discrete geometric law is apparent; for ξ, the horizontal
axis is scaled to n, and the histograms quickly conform to the bell-shaped curve
that is characteristic of a continuous gaussian limit.
geometric distribution. One has, for each k,
lim
n→∞PWn(χ = k) = 1
2k .
(In this simple case, it is even true that the limit is exactly attained as soon as n >
k.) We say that there is a limit law of the discrete type for χ, this limit law being a
geometric.
In contrast, the parameter ξ has mean µn := n/2 and a standard deviation σn :=
1
2
√n. One should then centre and scale the parameter χ, introducing (over Wn) the
“standardized” (or “normalized”) random variable
X⋆
n := ξ −n/2
1
2
√n ,
which can be considered to lie in a ﬁxed scale. It then becomes possible to examine
the behaviour of the (cumulative) distribution function P(X⋆
n ≤y) for some ﬁxed y.
In terms of χ itself, this means that we are considering P(ξ ≤µn + yσn) for real
values of y. Then, the classical approximation of the binomial coefﬁcients yields the
approximation:
(1)
lim
n→∞P(ξ ≤µn + yσn) =
1
√
2π
Z y
−∞
e−t2/2 dt,
which can be derived by summation from the “local” approximation
(2)
1
2n

n
1
2n + 1
2y√n

∼e−y2/2
√πn .
We now say that there is a limit law of the continuous type for ξ, this limit law being a
Gaussian.

IX. 1. LIMIT LAWS AND COMBINATORIAL STRUCTURES
573
Though cases mixing the discrete and the continuous are theoretically conceivable
(a rare instance arises in the theory of map enumerations and “cores”, see [22]), the
discrete–continuous dichotomy applies to most combinatorial cases of interest.
Distributional properties. As illustrated by the previous discussion, there are two
major types of convergence that the discrete distribution of a combinatorial parameter
may satisfy:
Discrete −→Discrete
and
Discrete −→Continuous .
In accordance with the general notion of convergence in distribution (or weak con-
vergence, see APPENDIX C: Convergence in law, p. 722), we shall say that a limit
law exists for a parameter if there is convergence of the corresponding family of (cu-
mulative) distribution functions. In the broad context of convergence of probability
laws, one also speaks of a central limit law when such a convergence holds. In the
discrete-to-discrete case, convergence is established without standardizing the random
variables involved. In the discrete-to-continuous case, the parameter should be centred
at its mean and scaled by its standard deviation, like in (1).
There is also interest in obtaining a local limit law, which, when available, quan-
tiﬁes individual probabilities and probability densities, like in (2).
The distinction
between local and central limits is immaterial in the discrete-to-discrete case, where
the existence of one type of law implies the other. In the discrete-to-continuous case,
it is technically more demanding to derive a local limit law than a central one, as
stronger analytic properties are required.
The speed of convergence in a limit law describes the way the ﬁnite combinatorial
distributions approach their asymptotic limit. It provides useful information on the
quality of asymptotic approximations for ﬁnite n models.
Finally, quantifying the “risk” of extreme conﬁgurations necessitates estimates on
the tails of the distributions, that is, the behaviour of the probability distribution far
away from its mean. Such estimates are also called large deviation estimates. Large
deviation theory constitutes a useful complement to the study of central and local
limits, as exempliﬁed by the discussion of runs in the introduction to this chapter.
In the remainder of the this chapter, we shall ﬁrst examine the situation of dis-
crete limits. After this, several sections will be dedicated to the case of continuous
limits, with special emphasis on limit laws of the Gaussian type. In each of the two
cases, the discussion of central laws starts with a continuity theorem, which states
conditions under which convergence in law can be established from convergence of
transforms. (The transforms in question are probability generating functions for the
discrete case, characteristic functions or Laplace transforms otherwise). Reﬁnements,
known as the Berry-Esseen inequalities when the limit law is continuous, then re-
late speed of convergence of the combinatorial distributions to their limit on the one
hand, a distance between transforms on the other hand. Put otherwise, distributions
are close if their transforms are close. Large deviation estimates are often obtained
by a technique of “shifting the mean”, which is familiar in probability and statistics.
The last section gives brief indications on the occurrence of non-Gaussian laws in the
discrete-to-continuous scenario.

574
IX. MULTIVARIATE ASYMPTOTICS
Limit laws and bivariate generating functions. In this chapter, the starting point of
a distributional analysis is invariably a bivariate generating function
F(z, u) =
X
n,k
fn,kukzn,
where fn,k represents (up to a possible normalization factor) the number of structures
of size n in some class F. What is sought is asymptotic information relative to the
array of coefﬁcients
fn,k = [znuk]F(z, u),
which could in principle be approached by an iterated use of Cauchy’s coefﬁcient
formula,
[znuk]F(z, u) =
 1
2iπ
2 Z
γ
Z
γ′ F(z, u) dz
zn+1
du
uk+1 .
Thus, a double coefﬁcient extraction is to be effected. It turns out that it is in general
arduous if not unfeasible to approach a bivariate counting problem in this way, so that
another route is explored throughout this chapter3.
First, observe that the specialization at u = 1 of F(z, u) gives the counting gen-
erating function of F, that is, F(z) = F(z, 1). Next, as seen repeatedly starting
from Chapter III, the moments of the combinatorial distribution {fn,k} for ﬁxed n
and varying k are attainable through the partial derivatives at u = 1, namely
ﬁrst moment ↔
∂
∂uF(z, u)

u=1
,
second moment ↔
∂2
∂u2 F(z, u)

u=1
,
· · · .
In summary: Counting is provided by the bivariate generating function F(z, u) taken
at u = 1; moments result from the bivariate generating function taken in an inﬁnites-
imal neighbourhood of u = 1.
Our approach to limit laws will be as follows.
Estimate the (unormalized) probability generating function
fn(u) :=
X
k
fn,kuk ≡[zn]F(z, u).
This is viewed a single coefﬁcient extraction (extracting the coefﬁcient
of zn) but parameterized by u. Thanks to the availability of continuity the-
orems, the following can be proved for a great many cases of combinatorial
interest: The existence and the shape of the limit law derive from an analysis
of the bivariate generating function F(z, u) taken in a ﬁxed neighbourhood
of u = 1. In addition, thanks to Berry–Esseeen inequalities, the quality
of an asymptotic estimate for fn(u) translates into a speed of convergence
estimate for the corresponding laws. Also, for the discrete-to-continuous
case, local limit laws derive from consideration of the bivariate generating
function F(z, u) taken on the whole of the unit circle, |u| = 1. Finally,
large deviation estimates are seen to arise from estimates of fn(u) when u
3A collection of recent works by Pemantle and coauthors [388, 389, 390] shows however that a well-
deﬁned class of bivariate asymptotic problems can be attacked by the theory of functions of several complex
variables and a detailed study of the geometry of a singular variety.

IX. 1. LIMIT LAWS AND COMBINATORIAL STRUCTURES
575
0
         (right)
           (left)
Local Limit
Moments
Counting
Large deviations
Central Limit
Large deviations
1
Region
Property
u = 1
Counting
u = 1 ± ǫ
Moments
u ∈V(1) (neighb.)
Central Limit Law
|u| = 1
Local Limit Law
u ∈[α, β]
Large deviations
FIGURE IX.2.
The correspondence between regions of the u–plane and asymp-
totic properties of combinatorial distributions.
is real and u < 1 (left tail) or u > 1 (right tail). This is to large extent
a reﬂection of saddle point bounds. In summary: Large deviations are re-
lated to the behaviour of F(z, u) for real values of u in an interval [α, β]
containing u = 1.
The correspondence between u-domains and properties of laws is summarized in Fig-
ure 2.
Singularity perturbation. As seen throughout Chapters IV–VIII, analytic combina-
torics approaches the univariate problem of counting objects of size n starting from
the Cauchy coefﬁcient integral,
[zn]F(z) =
1
2iπ
Z
γ
F(z)
dz
zn+1 .
The singularities of F(z) can be exploited, whether they are of a polar type (Chap-
ters IV and V), algebraic-logarithmic (Chapters VI and VII) or essential and amenable
to saddle point methods (Chapter VIII). It is in this way that asymptotic forms of
[zn]F(z) are derived.
From the discussion above, crucial information on combinatorial distributions
is accessible from the bivariate generating function F(z, u) when u varies in some
domain containing 1. This suggests to consider F(z, u) not so much as an analytic
function of two complex variables, where z and u would play a symmetric rˆole, but
rather as a collection of functions of z indexed by a secondary parameter u. In other
words, F(z, u) is considered as a deformation of F() ≡F(z, 1) when u varies in a
domain containing u = 1. Cauchy’s coefﬁcient integral gives
fn(u) ≡[zn]F(z, u) =
1
2iπ
Z
γ
F(z, u) dz
zn+1 .
We can then examine the way the parameter u affects the analysis of singularities
performed in the aymptotic counting problem of estimating [zn]F(z, 1). Such an
approach is called a singularity perturbation analysis. It consists in tracing the effect
of a perturbation by u on the standard singularity analysis assocaited to the univariate
problem.

576
IX. MULTIVARIATE ASYMPTOTICS
The essential feature of the analysis of coefﬁcients by means of complex tech-
niques as seen in Chapters IV–VIII is to be “robust”. Being based on explicit estimates
of contour integrals, it is usually amenable to smooth perturbations whose effect can
be traced throughout calculations. Explicit estimates normally result (though added
care in estimations is needed to ensure uniformity). In this chapter, we are going to
see many applications of this strategy.
Regarding binary words and the two parameters χ (initial run of a’s) and ξ (total
number of a’s), the general strategy of singularity perturbation instantiates as follows.
In the case of Wχ, there are two components in the BGF
Wχ(z, u0) =
1
1 −u0z ·
1 −z
1 −2z ,
and, in essence, the dominant singular part—a simple pole at z = 1/2—arises from
the second component, which does not change when u0 varies. Accordingly, one has
Wχ(z, u0) ∼
z→1
1
2
1 −u0
2
W(z),
[zn]Wχ(z, u0) ∼
1
2
1 −u0
2
2n.
The probability generating function of χ over Wn is then obtained upon dividing by
2−n, and
1
2n [zn]Wχ(z, u0) ∼
1
2
1 −u0
2
=
∞
X
k=0
1
2k+1 uk
0,
where the last expression is none other than the probability generating function of
a discrete law, namely, the geometric distribution of parameter 1
2. As we shall see
in section IX. 2 where we enounce a continuity theorem for probability generating
functions, this is enough to conclude that the distribution of χ convergesto a geometric
law.
In the second case, that of Wξ, the auxiliary parameter modiﬁes the location of
the singularity,
Wξ(z, u0) =
1
1 −z (1 + u0)
.
Then, the singular behaviour is strongly dependent upon a singularity at
ρ(u0) =
1
(1 + u0)
that moves as k varies, while the type of singularity (here a simple pole) remains the
same. Accordingly, the coefﬁcients obey a “large power law” (here of an exact type)
and, as regards the probability generating function of ξ over Wn, one has
1
2n [zn]Wξ(z, u0) =

1
2ρ(u0)
n
,
This analytical form is reminiscent of the central limit theorem of probability theory
after which large powers, corresponding to sums of a large number of independent
random variables, entail convergence to a Gaussian law. By continuity theorems for
integral transforms exposed in Sections IX. 4, there results a continuous limit law of
the Gaussian type in this case.

IX. 2. DISCRETE LIMIT LAWS
577
F(z, u) when u ≈1
Type of law
Method and classes
Sing. + expo. ﬁxed
Discrete limit
Subcritical composition
§ xxx
(Neg. binom, Poisson, . . . )
Subcritical Seq., Set, . . .
§ xxx
Sing. moves, expo. ﬁxed
Gaussian(n, n)
Supercritical composition
§ xxx
—
—
Meromorphic perturb.
§ xxx
—
—
(Rational fns)
§ xxx
—
—
Sing. Analysis pertub.
§ xxx
—
—
(Alg., implicit fns)
§ xxx
Sing. ﬁxed, expo. moves
Gaussian(log n, log n)
Exp-log struct.
§ xxx
—
—
(Differential eq.)
§ xxx
Sing. + expo. move
Gaussian
[Gao-Richmond [226]]
Essential singularity
often Gaussian
Saddle point perturbation
§ xxx
Discontinuous singular type
non-Gaussian
(Various cases)
§ xxx
—
Stable
Critical composition
§ xxx
FIGURE IX.3.
A rough typology of bivariate generating functions F(z, u) and
limit laws.
The foregoing discussion suggests that a “minor” perturbation of bivariate gener-
ating function that affects neither the location nor the nature of the singularity could
lead to a discrete limit law. A “major” change in exponent or even like here in loca-
tion is likely to be conducive to a continuous limit law, of which the prime example
is the normal distribution. Figure 3 outlines a typology of limit laws in the context
of bivariate asymptotics. A bivariate generating function F(z, u) is to be analysed.
The deformation induced by u may affect the type of singularity that F(z, u) has in
various ways. An adapted complex coefﬁcient extraction then provides various types
of limit laws.
IX. 2. Discrete limit laws
Take a class C on which a parameter χ is deﬁned. This determines for each n
a random variable Xn, which is χ restricted to Cn, where Cn is endowed with the
uniform probability distribution. In this section, we give the general deﬁnitions and
results that are suitable for the discrete-to-discrete situation, where a discrete parame-
ter tends without normalization to a discrete distribution. The corresponding notion of
convergence is given in Subsection IX. 2.1. Probability generating functions (PGFs)
are important since, by virtue of a continuity theorem stated in Subsection IX. 2.2,
convergence in law results from convergence of PGFs. At the same time, the fact that
PGFs of two distributions are close entails that the original distribution functions are
close. Finally, large deviation estimates for a distribution can be easily related to an-
alytic continuation of its PGFs, a fact introduced in Subsection IX. 2.3. This section
organizes some general tools and accordingly we limit ourselves to a single combina-
torial application, that of the number of cycles of some small ﬁxed size in a random
permutation. The next section will provide a number of deeper applications to random
combinatorial structures.

578
IX. MULTIVARIATE ASYMPTOTICS
IX. 2.1. Convergence to a discrete law. In order to specify precisely what a
limit law is, we base ourselves on the general context described in APPENDIX C:
Convergence in law, p. 722. The principles exposed there provide for what should be
the “right” notion convergence of a family of discrete distributions to a limit discrete
distribution. Here is a self-standing deﬁnition.
Deﬁnition IX.1 (Discrete-to-discrete convergence). The random variable Xn (su-
ported by Z≥0) is said to converge in law to a discrete variable Y supported by Z≥0
if for each k ≥0, one has
(3)
lim
n→∞P(Xn ≤k) = P(Y ≤k),
i.e.,
lim
n→∞
X
j=k
pn,j =
X
j≤k
qj,
where pn,k = P(Xn ≤k) and qk := P(X = k). One also says that the parameter χ
on C admits a limit law of type X.
Convergence is said to take place at speed ǫn if
(4)
sup
k

X
j≤k
P(Xn = j) −
X
j≤k
qj

≤ǫn,
The condition in (3) can be rewritten in terms of the distribution functions Fn, G
of Xn, Y as
lim Fn(k) = G(k),
pointwise for each k. When such a property of type (3) relative to distribution func-
tions holds, it is also called a “central” limit law. (One good reason for this termi-
nology is that convergence of distribution functions is principally informative in the
“central part” of the distribution, where a fair proportion of the probability mass lies.)
By differencing, the condition of (3) is clearly equivalent to the condition that, for
each k,
(5)
lim
n pn,k = qk,
and δn is called a local speed of convergence if
sup
k
|pn,k −qk| ≤δn.
The property (5) is said to constitute a local limit law, as probabilities pn,k are esti-
mated “locally”. Thus: For the convergence of a discrete law to a discrete law, there
is complete equivalence between the existence of central and local limits. Note 1
below shows elementarily that there always exists a speed of convergence that tends
to 0 as n tends to inﬁnity. In other words, plain convergence of distribution functions
or of individual probabilities implies uniform convergence (this is in fact a general
phenomenon).
 IX.1. Uniform convergence. Local and central convergences to a discrete limit law are always
uniform. In other words, there always exists speeds ǫn, δn tending to 0 as n →∞.
Assume simply the condition (3) and its equivalent form (5). Fix a small ǫ > 0. First
dispose of the tails: there exists a k0 such that P
k≥k0 qk ≤ǫ, so that P
k<k0 qk > 1−ǫ. Now,
by simple convergence, there exists an n0 such that, for all n larger than n0 and each k < k0,
|pn,k −qk| < ǫ/k0. Thus, we have P
k<k0 pn,k > 1 −2ǫ, hence P
k≥k0 pn,k ≤2ǫ. In
other words, P
k≥k0 qk and P
k≥k0 pn,k are both in [0, 2ǫ]. There results that convergece of

IX. 2. DISCRETE LIMIT LAWS
579
distribution functions is uniform, with speed 5ǫ at most. At the same time, the local speed δn is
at most 4ǫ.

 IX.2. Speed in local and central estimates. Let Mn be the spread of χ on Cn deﬁned as
Mn := maxγ∈Cn χ(γ). Then, a speed of convergence in (4) is given by
ǫn := Mnδn +
X
k>Mn
pk.
(Reﬁnements of these inequalities can obtained from tail estimates detailed below.)

 IX.3. Total variation distance. The total variation distance between X and Y is classically
dT V (X, Y ) :=
sup
E⊆Z≥0
|PY (E) −PX(E)| = 1
2
X
k≥0
|P(Y = k) −P(X = k)| .
(Equivalence between the two forms is established elementarily by considering the particular
E for which the supremum is attained.) The argument of Note 1 shows that convergence in
distribution also implies that the total variation distance between Xn and X tends to 0. In
addition, by Note 2, one has dT V (Xn, X) ≤Mnδn + P
k>Mn pk.

 IX.4. Escape to inﬁnity. The sequence Xn, where
P{Xn = 0} = 1
3,
P{Xn = 1} = 1
3,
P{Xn = n} = 1
3,
does not satisfy a discrete limit law in the sense above, although limn P{Xn = k} exists for
each k. Some of the probability mass escapes to inﬁnity and, in a way, convergence takes place
in Z ∪{+∞}.

A highly plausible indication of the occurrence of a discrete law is the fact that
µn = O(1), σn = O(1). Examination of initial entries in the table of values of the
probabilities will then normally permit one to decide whether a limit law holds.
EXAMPLE IX.1. Singleton cycles in permutations. The case of the number of singleton cycles
(cycles of length 1) in a random permutation of size n illustrates the basic deﬁnitions and it can
be analysed with minimal analytic apparatus. The exponential BGF is
P(z, u) = exp(z(u −1))
1 −z
,
which determines the mean µn = 1 and the standard deviation σn = 1 (for n ≥2). The table
of numerical values of the probabilities pn,k = [znuk]P(z, u) immediately tells what goes on.
k = 0
k = 1
k = 2
k = 3
k = 4
k = 5
n = 4
0.375
0.333
0.250
0.000
0.041
n = 5
0.366
0.375
0.166
0.083
0.000
0.008
n = 10
0.367
0.367
0.183
0.061
0.015
0.003
n = 20
0.367
0.367
0.183
0.061
0.015
0.003
The exact distribution is easily extracted from the bivariate GF,
pn,k := [znuk]P(z, u) = 1
k![zn−k] e−z
1 −z = dn−k
k! ,
where n!dn is the number of derangements of size n, that is,
dn = [zn] e−z
1 −z =
n
X
j=0
(−1)j
j!
Asymptotically, one has dn ∼e−1. Thus, for ﬁxed k, we have
lim
n→∞pn,k = pk,
pk = e−1
k! .

580
IX. MULTIVARIATE ASYMPTOTICS
As a consequence, the distribution of singleton cycles in a random permutation of large size
tends to a Poisson law of rate λ = 1.
Convergence is quite fast. Here is a table of differences, δn,k = pn,k −e−1
k! :
k = 0
k = 1
k = 2
k = 3
k = 4
k = 5
n = 10
2.3 10−8
−2.5 10−7
1.2 10−6
−3.7 10−6
7.3 10−6
1.0 10−5
n = 20
1.8 10−20
−3.9 10−19
3.9 10−18
−2.4 10−17
1.1 10−16
−3.7 10−16
The speed of convergence is easily bounded. One has dn = e−1 + O(1/n!), by the alternating
series property, so that
pn,k = e−1
k! + O
„
1
k! (n −k)!
«
= e−1
k! + O
 
1
n!
 
n
k
!!
= e−1
k! + O
„2n
n!
«
.
As a consequence, one obtains local (δn) and central (ǫn) speed estimates
δn = O
„2n
n!
«
,
ǫn = O
„n2n
n!
«
.
These bounds are quite tight. For instance one computes that δ50 .= 1.5 10−52 while the quan-
tity 2n/n! evaluates to 3.7 10−50. . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE IX.1. □
IX. 2.2. Continuity theorem for PGFs. A higher level approach to discrete
limit laws in analytic combinatorics is based on asymptotic estimates of pn(u), the
PGF of the random variable Xn. If, for sufﬁciently many values of u, one has
pn(u) →q(u)
(n →+∞),
one can infer that the coefﬁcients pn,k = [uk]pn(u) (for any ﬁxed k) tend to the limit
qk with generating function q(u). A continuity theorem for characteristic functions
describes precisely sets of conditions under which convergence of probability gener-
ating functions to a limit entails convergence of coefﬁcients to a limit, that is to say
the occurrence of a discrete limit law. We state here a continuity theorem with very
general analytic conditions.
Theorem IX.1 (Continuity Theorem, discrete laws). Let Ωbe an arbitrary set con-
tained in the unit disc and having at least one accumulation point in the interior of the
disc. Assume that the PGFs pn(u) = P
k≥0 pn,kuk and q(u) = P
k≥0 qkuk are such
that there is convergence,
lim
n→+∞pn(u) = q(u),
pointwise for each u in Ω. Then a discrete limit law holds in the sense that, for each k,
lim
n→+∞
X
j≤k
pn,j =
X
j≤k
qj.
PROOF. The pn(u) are a priori analytic in |u| < 1 and uniformly bounded by 1 in
modulus throughout |u| ≤1. Vitali’s Theorem is a classical result of analysis whose
statement (see [469, p. 168] or [265, p. 566]) is as follows:
Vitali’s theorem. Let F be a family of analytic functions deﬁned in a re-
gion S (i.e., an open connected set) and uniformly bounded on every com-
pact subset of S. Let {fn} be a sequence of functions of F that converges

IX. 2. DISCRETE LIMIT LAWS
581
-3
-2
-1
0
1
2
3
x
-3
-2
-1
0
1
2
3
y
0
0.5
1
1.5
2
2.5
3
-3
-2
-1
0
1
2
3
x
-3
-2
-1
0
1
2
3
y
0
0.5
1
1.5
2
2.5
3
-3
-2
-1
0
1
2
3
x
-3
-2
-1
0
1
2
3
y
0
0.5
1
1.5
2
2.5
3
-3
-2
-1
0
1
2
3
x
-3
-2
-1
0
1
2
3
y
0
0.5
1
1.5
2
2.5
3
FIGURE IX.4. The PGFs of singleton cycles in random permutations of size n =
4, 8, 12 (left to right and top to bottom) illustrate convergence to the limit PGF of
the Poisson(1) distribution (bottom right). Here the modulus of each PGF for
|ℜ(u)|, |ℑ(u)| ≤3 is displayed.
on a set Ω⊂S having a point of accumulation q ∈S. Then {fn} converges
in all of S, uniformly on every compact subset T ⊂S.
Here, S is the open unit disc on which all the pn(u) are bounded. The sequence in
question is {pn(u)}. By assumption, there is convergence of pn(u) to q(u) on Ω.
Vitali’s theorem implies that this convergence is uniform in any compact subdisc of

582
IX. MULTIVARIATE ASYMPTOTICS
the unit disc, for instance, |u| ≤1
2. Then, Cauchy’s coefﬁcient formula provides
(6)
qk
=
1
2iπ
Z
|u|=1/2
q(u) du
uk+1
=
lim
n→∞
1
2iπ
Z
|u|=1/2
pn(u) du
uk+1
=
lim
n→∞pn,k.
Uniformity granted by Vitali’s theorem combined with continuity of the contour inte-
gral (with respect to the integrand) establishes the statement.
□
Feller gives the sufﬁcient set of conditions: pn(u) →q(u) pointwise for all real
u ∈]0, 1[; see [161, p. 280] for a proof that only involves elementary real analysis. It
is perhaps surprising that very different sets can be taken, for instance,
Ω=

−1
3, −1
2

,
Ω= { 1
n},
Ω=
n √−1
2
+
1
2n
o
.
The next statement relates a measure of distance between two PGFS, p(u) and
q(u) to the distance betwen distributions. It is naturally of interest when quantifying
speed of convergence to the limit in the discrete-to-discrete case.
Theorem IX.2 (Speed of convergence, discrete laws). Consider two discrete laws
supported by Z≥0, with corresponding distribution functions F(x), G(x) and proba-
bility generating functions p(u), q(u).
(i) Assume that the laws have ﬁrst moments. Then, for any T ∈(0, π), one has,
for some absolute constants c = 1
4,
(7)
sup
k
|F(k) −G(k)| ≤c
Z +T
−T
|p(eit) −q(eit)|
t
dt + c
T
sup
T ≤|t|≤π
p(eit) −q(eit)
 .
(ii) Assume that p(u) and q(u) are analytic in |u| < ρ for some ρ > 1. Then, for
any r satisfying 1 < r < ρ, one has
sup
k
|F(k) −G(k)| ≤c(r) sup
|u|=r
|p(u) −q(u)| ,
c(r) :=
1
r(r −1).
PROOF. (i) Observe ﬁrst that p(1) = q(1) = 1, so that the integrand is of the form
0
0 at u = 1. By APPENDIX C: Transforms of distributions, p. 718, the existence
of ﬁrst moments, say µ and ν, implies that, for small t, one has p(eit) −q(eit) =
(µ −ν)t + o(t), so that the integral is well deﬁned.
For any given k, Cauchy’s coefﬁcient formula provides
(8)
F(k) −G(k) =
1
2iπ
Z
γ
p(u) −q(u)
1 −u
du
uk+1 ,
where γ is the circle |u| = 1. (The factor (1 −u)−1 sums coefﬁcients.) Set u = eit
and split the interval of integration accordingly. For all t, one has

t
eit −1
 ≤π
2 .

IX. 2. DISCRETE LIMIT LAWS
583
This makes it possible to replace (1 −u)−1 by 1/t, up to a constant multiplier. The
statement follows upon splitting the interval of integration according to |t| ≤T and
|t| > T , and then applying trivial bounds.
(ii) Start again from (8), but integrate along |u| = r. Trivial bounds provide the
statement.
□The ﬁrst form is universal holds with
strictly minimal assumptions (existence of expectations); the second form is a priori
only usable for distributions that have exponential tails. In the context of limit laws,
the ﬁrst form of the theorem serves to relate the distance on the unit circle between
the PGF pn(u) of a combinatorial parameter and the limit PGF q(u) to the speed of
convergence to the limit law. (In this sense, it preﬁgures the Berry-Esseen inequalities
discussed in the continuous context below.)
EXAMPLE IX.2. Cycles of length m in permutations. Let us ﬁrst revisit the case of singleton
cycles, m = 1, in this new light. The BGF P(z, u) = ez(u−1)/(1 −z) has for each u a simple
pole at z = 1 and is otherwise analytic in C \ {1}. Thus, a meromorphic analysis provides
instantly, pointwise for any ﬁxed u,
[zn]F(z, u) = e(u−1) + O(R−n),
with any R > 1. This, by the continuity theorem, Theorem IX.1, implies convergence to a
Poisson law.
Next, one should estimate a distance between characteristic functions over the unit circle.
One has (for u = eit)
pn(u) −q(u) = [zn]ez(u−1) −e(u−1)
1 −z
.
There is a removable singularity at z = 1. Thus, integration over the circle |z| = 2 in the
z-plane coupled with trivial bounds yields
|pn(u) −q(u)| ≤2−n sup
|z|=2
˛˛˛ez(u−1) −e(u−1)˛˛˛ = O
`
2−n|1 −u|
´
.
One can then apply Theorem IX.2 with an arbitrary choice of T to the effect that a speed of
convergence to the limit is O(2−n). (Any O(R−n) is possible by the same argument.)
This approach generalizes to the number of m–cycles in a random permutation. The ex-
ponential BGF is
F(z, u) = e(u−1)zm/m
1 −z
.
Then, singularity analysis of the meromorphic function of z (for u ﬁxed) gives immediately
lim
n→∞[zn]F(z, u) = e(u−1)/m.
The right side of this equality is none other than the PGF of a Poisson law of rate λ =
1
m. The
continuity theorem and the ﬁrst form of the speed of convergence theorem then imply:
Proposition IX.1 (m-Cycles in permutations). The number of m–cycles in a random permuta-
tion of large size converges in law to a Poisson distribution of rate 1/m with speed of conver-
gence O(R−n) for any R > 1.
This
vastly
generalizes
our
previous
observations
on
singleton
cycles.
END OF EXAMPLE IX.2. □

584
IX. MULTIVARIATE ASYMPTOTICS
 IX.5. Poisson law for rare events. Consider the Bernoulli distribution with PGF (p + qu)n.
If q depends on n in such a way that q = λ/n for some ﬁxed λ, then the limit law of the
Bernoulli random variable is Poisson of rate λ. (This “law of small numbers” explains the
Poisson character of activity in radioactive decay as well as the probability of accidental deaths
of soldiers in the Prussian army resulting from the kick of a horse [Bortkiewicz, 1898].)

IX. 2.3. Large deviations. In the case of discrete limit laws, the study of large
deviations is related to saddle-point bounds and is consequently often quite easy. We
give with a general statement which is nothing but a rephrasing of saddle point bounds
(Chapter IV) in the context of discrete probability distributions.
Theorem IX.3 (Large deviations, discrete laws). Let p(u) = E(uX) be a probability
generating function that is analytic for |u| ≤r where r is some number satisfying
r > 1. Then, the following “local” and “central” large deviation bounds hold:
P(X = k) ≤p(r)
rk ,
P(X > k) ≤
p(r)
rk(r −1).
PROOF. The local bound is a direct consequence of saddle point bounds given in
Chapter IV. The central bound derives from the equality
P(X > k) =
1
2iπ
Z
|u|=r
p(u)

1 + 1
u + 1
u2 + · · ·

du
uk+2 =
1
2iπ
Z
|u|=r
p(u)
du
uk+1(u −1),
upon applying trivial bounds.
□
In accordance with this theorem and as is easily checked directly, the geometric
and the negative binomial laws have exponential tails; the Poisson law has a “super-
exponential” tail, being O(r−k) for any r > 1, as the PGF is entire. (See deﬁnitions
in APPENDIX C: Special distributions, p. 720.) By their nature, the bounds can be
simultaneously applied to a whole family of probability generating functions. Hence
their use in obtaining uniform estimates in the context of limit laws. The bound pro-
vided always exhibits a geometric decay in the value of k—this is both a stength and
a limitation on the method.
IX. 3. Combinatorial instances of discrete laws
In this section, we focus our attention on a general analytic schema based on com-
positions. The subcritical case of this schema is such that the perturbations induced
by the secondary variable (u) affect neither the location nor the nature of the basic
singularity involved in the univariate counting problem. The limit laws are then of the
discrete type: for sequences, labelled sets, and labelled cycles, theese limit laws are in-
variably of the negative binomial (NB[2]), Poisson, and geometric type, respectively.
Additionally, it is easy to describe the proﬁles of combinatorial objects resulting from
such subcritical constructions.
First, we consider the general composition schema,
F(z, u) = g(uh(z)).
This schema expresses over generating functions the combinatorial operation G[H] of
substitution of components H enumerated by h(z) inside “templates” G enumerated

IX. 3. COMBINATORIAL INSTANCES OF DISCRETE LAWS
585
by g(z). (See Chapters I and II for the unalabelled and labelled versions.) The variable
z marks size as usual, and the variable marks the size of the G template.
We assume globally that g and h have nonnegative coefﬁcients and that h(0) = 0
so that the composition g(h(z)) is well-deﬁned. We let ρg and ρh denote the radii of
convergence of f and g, and deﬁne
(9)
τg = lim
x→ρ−
g
g(x)
and
τh = lim
x→ρ−
h
h(x).
The (possibly inﬁnite) limits exist due to nonnegativity of coefﬁcients. As already
seen in Chapter VI, three cases are to be distinguished.
Deﬁnition IX.2. The composition schema g(uh(z)) is said to be: subcritical if τh <
ρg, critical if τh = ρg, supercritical if τh > ρg.
In terms of singularities, the behaviour of g(h(z)) at its dominant singularity
is dictated by the dominant singularity of g (subcritical case), or by the dominant
singularity of f (supercritical case), or it should involve a mixture of the two (critical
case). This section discusses the subcritical case. First, a general statement about
subcritical compositions:
Proposition IX.2 (Subcritical composition). Consider the bivariate composition
scheme F(z, u) = g(uh(z)). Assume that g(z) and h(z) satisfy the subcriticality
condition τh < ρg, and that h(z) has a unique singularity at ρ = ρh on its disc of
convergence, which is of the algebraic–logarithmic type
h(z) = τ −c(1 −z
ρ)λ + o

(1 −z
ρ)λ

,
where τ = τh, c ∈R+, 0 < λ < 1. Then, a discrete limit law holds,
lim
n→∞
fn,k
fn
= qk,
qk = kgkτ k−1
g′(τ)
,
with probability generating function q(u) = ug′(τu)
g′(τ) .
What stands out is that, via its PGF, the limit law is a direct reﬂection of the derivative
of the outer function involved in the composition.
PROOF. First, for the univariate problem, since g(z) is analytic at τ, the function
g(h(z)) is singular at ρh and is analytic in a ∆–domain. Its singular expansion is
obtained by composing the regular expansion of g(z) at τ with the singular expansion
of h(z) at ρh:
F(z) ≡g(h(z)) = g(τ) −cg′(τ)(1 −z/ρ)λ(1 + o(1)).
Thus, F(z) satisﬁes the conditions of singularity analysis, and
(10)
fn ≡[zn]F(z) = −cg′(τ)
Γ(−λ)n−λ−1(1 + o(1)).
Also, the mean and variance of the distribution are clearly O(1).

586
IX. MULTIVARIATE ASYMPTOTICS
Next, for the bivariate problem, ﬁx any u with, say, u ∈(0, 1). The BGF F(z, u)
is still singular at z = ρ, and its singular expansion obtained from F(z, u) = g(uh(z))
by composition, is
F(z, u) = g(uh(z))
=
g(uτ −cu(1 −z/ρ)λ + o((1 −z/ρ)λ))
=
g(uτ) −cug′(uτ)(1 −z/ρ)λ + o((1 −z/ρ)λ).
Thus, singularity analysis implies immediately:
lim
n→∞
[zn]F(z, u)
[zn]F(z, 1) = ug′(uτ)
g′(τ) .
By the continuity theorem for PGFs, this is enough to imply convergence to the dis-
crete limit law with PGF ug′(τu)/g′(τ), and the proposition is established.
□
Under the subcritical composition scheme, it is also true that the tails have a
uniformly geometric decay. Let u0 be any number of the interval (1, ρg/τh). Then
f(z, u0) a a function of z is analytic near the origin with a dominant singularity at ρh
obtained by composing the regular expansion of g with the singular expansion of h:
f(z, u0) = h(u0τh) −ch′(u0τh)(1 −z/ρ)λ + o((1 −z/ρ)λ).
There results the asymptotic estimate
pn,k = [zn]f(z, u0)
[zn]f(z, 1) ∼h′(u0τh).
Thus, for some constant K ≡K(u0), one has
pn(u0) < K.
It is easy also to verify that pn(u) is analytic at u0, so that, by Theorem IX.3,
pn,k < K(u0) · u−k
0 ,
X
j>k
pj,k < K(u0)
u0 −1u−k
0 .
Thus the combinatorial distributions satisfy uniformly (with respect to n) a large de-
viations bound. In particular the probability that there are more than a logarithmic
number of components satisﬁes
(11)
Pn(χ > log n) = O(n−θ),
θ = log u0.
Such tail estimates may additionally serve to evaluate the speed of convergence to the
limit law (as well as the total variation distance) in the subcritical composition schema.
 IX.6. Semi-small powers and singularity analysis. Let h(z) satisfy the stronger singular
expansion
h(z) = τ −c(1 −z/ρ)λ + O(1 −z/ρ)ν,
for 0 < λ < ν < 1. Then, for k ≤C log n (some C > 0), the results of singularity analysis
can be extended (as stated and proved in Chapter VI, they are only valid for ﬁxed k)
[zn]h(z)k = kcρ−nn−λ−1 “
1 + O(n−θ1)
”
,
for some θ1 > 0, uniformly with respect to k. [The proof recycles all the ideas of Chapter VI
and only needs some care in checking uniformity with respect to k of the major steps.]


IX. 3. COMBINATORIAL INSTANCES OF DISCRETE LAWS
587
 IX.7. Speed of convergence in subscritical compositions. Combining the exponential tail
estimate (11) and local estimates deriving from the singularity analysis of “semi-small” powers
in the previous notes, one obtains for the distribution functions associated with pn,k and pk the
speed estimate
sup
k
|Fn(k) −F(k)| ≤
L
nθ2 .
There, L and θ2 are two positive constants.

In the labelled universe, the functional composition schema encompasses the se-
quence, set, and cycle constructions. It sufﬁces to take for the outer function g in the
composition g ◦h the quantities
(12)
Q(w) =
1
1 −w ,
E(w) = ew,
L(w) = log
1
1 −w.
We state:
Proposition IX.3 (Subcritical constructions). Consider the constructions of sequence
S(H), whether labelled or not, labelled set P(H) and labelled cycle C(H) Assume
the subcriticality conditions of the previous proposition, namely τ < 1, τ < ∞,
τ < 1, respectively, where τ is the singular value of h(z). Then, the distribution of
the number χ of components determined by fn,k/fn, is such that χ = 1 + Y admits a
discrete limit law that is of type, respectively: negative binomial NB[2], Poisson, and
geometric. For k ≥1, the limit form for qk = limn P(Y = k) are respectively
qS
k = (1 −τ)2(k + 1)τk,
qP
k = e−τ τ k
(k)!,
qC
k = (1 −τ)τ k.
In an object of positive size, the number of components is always ≥1. In terms of
the standard deﬁnition of the three laws (APPENDIX C: Special distributions, p. 720)
the distribution of the number of components is χ = 1 + Y where Y is supported by
Z≥0.
PROOF. In accordance with Proposition IX.2 and Equation (12), the PGF of the dis-
crete limit law involves the derivatives
Q′(w) =
1
(1 −w)2 ,
E′(w) = ew,
L′(w) =
1
1 −w.
The last two cases precisely give rise to the classical Poisson and geometric law. The
ﬁrst case gives rise to the negative binomial law NB[2] which also appears in this
form as a sum of two geometricly distributed random variables.
□
The technical simplicity with which limit laws are pulled out of combinatorics is
worthy of note.
EXAMPLE IX.3. Root degrees in trees. Consider ﬁrst the number of components in a sequence
(ordered forest) of general Catalan trees. The bivariate OGF is
F(z, u) =
1
1 −uh(z),
h(z) = 1
2
`
1 −
√
1 −4z
´
.
We have τh = 1/2 < ρg = 1, so that the composition schema is subcritical. Thus, for a forest
of total size n, the number Xn of tree components satisﬁes
lim
n→∞P{Xn = k} =
k
2k+1
(k ≥1).

588
IX. MULTIVARIATE ASYMPTOTICS
Since a tree is equivalent to a node appended to a forest, this asymptotic estimate also holds for
the root degree of a general Catalan tree.
Consider next the number of components in a set (unordered forest) of Cayley trees. The
bivariate EGF is
F(z, u) = euh(z),
h(z) = zeh(z).
We have τh = 1 < ρg = +∞, again a subcritical composition schema. Thus the number Xn
of tree components in a random unordered forest of size n admits the limit distribution
lim
n→∞P{Xn = k} = e−1/(k −1)!,
(k ≥1),
a shifted Poisson law of parameter 1; asymptotically, the same property also holds for the root
degree of a random Cayley tree
The same method applies more generally to a simple variety of trees V (see Chapter VII)
with generator φ, under the condition of the existence of a root τ of the characteristic equation
φ(τ) −τφ′(τ) = 0 at a point interior to the disc of convergence of φ. The BGF satisﬁes
V (z, u) = zφ(uV (z)),
V (z) = 1 −γ
p
1 −/zρ + O(1 −z/ρ).
so that
V (z, u) ∼
z→ρ ρφ(uτ) −γ uφ′(uτ)
φ′(τ)
p
1 −/zρ.
The PGF of the distribution of root degree is accordingly
uφ′(τu)
φ′(τ)
=
X
k≥1
kφkτ k
φ′(τ) uk.
(A limit law was
established directly under
its local
form
in Chapter
VII.)
END OF EXAMPLE IX.3. □
The root degree in a random labelled nonplane tree (Cayley tree) admits in the
asymptotic limit a Poisson law, while the root degree of a large plane tree (a Catalan
tree) tends to a negative binomial (NB[2]) distribution. Proposition IX.2 shows, in
a precise technical sense, that the negative binomial law for Catalan trees is a direct
reﬂection of planarity speciﬁed by a sequence construction, while the Poisson law
arises from the set construction attached to nonplanarity.
 IX.8. Bell number distributions. Consider the “set-of-sets” schema
F(z, u) = exp(euh(z) −1),
assuming subcriticality. This corresponds to a scheme F = P(P≥1(H)). Then the number χ
of components satisﬁes asymptotically a “derivative Bell” law:
P(χ = k) = 1
K
kSkτ k
k!
,
K = e−eτ −τ−1,
where Sn = n![zn]eez−1 is a Bell number. There exists parellel results: for sequence-of-sets,
involving the surjection numbers; for set-of-sequences involving the fragmented permutation
numbers.

 IX.9. High levels in Cayley trees. The number of nodes at level 5 (i.e., at distance 5 from the
root) in a Cayley tree has the nice PGF
u d
du
0
B
B
@e−1 + e−1 + e−1 + e−1 + e−1+u 1
C
C
A ,

IX. 3. COMBINATORIAL INSTANCES OF DISCRETE LAWS
589
and thus involves “super Bell” numbers.

A further direct application of continuity of PGFs is the distribution of the number
of H-components of a ﬁxed size m in a composition Γ[H] with GF g(h(z)), again
under the subcriticality condition. In the terminology of Chapter III, we are thus
characterizing the proﬁle of combinatorial objects, at least as regards components of
some ﬁxed size. The bivariate GF is then
F(z, u) = g(h(z) + (u −1)hmzm),
with hm = [zm]h(z). The singular expansion at z = ρ is
F(z, u) = g(τ +(u−1)hmρm)−cg′(τ +(u−1)hmρm)(1−z/ρ)λ)+o((1−z/ρ)λ).
Thus, the PGF pn(u) for objects of size n satisﬁes
(13)
lim
n→∞pn(u) = g′(τ + (u −1)hmρm)
g′(τ)
.
Like before this specializes in the case of sequences, sets, and cycles giving a result
analogous to Proposition IX.2.
Proposition IX.4 (Fixed size components). Under the subcriticality conditions of
Propositions IX.2 and IX.3, the number of components of a ﬁxed size m in a random
sequence, set, or cycle construction applied to a class with GF h(z) admits a discrete
limit law. With hm := [zm]h(z), ρ the radius of convergence of h(z), and τ := h(ρ),
the distributions are as follows:
For sequences, the limit law is a negative binomial (NB[2]) of parameter a =
hmρm
1 −τ + hmρm . For sets, the limit law is Poisson with parameter λ = hmρm. For
cycles, the limit is geometric of parameter a =
hmρm
1 −τ + hmρm .
EXAMPLE IX.4.
Root subtrees of size m. In a Cayley tree, the number of root subtrees of
some ﬁxed size m has, in the limit, a Poisson distribution,
pk = e−λ λk
k! ,
λ = mm−1e−m
m!
.
In a general Catalan tree, the distribution is a negative binomial NB[2]
pk = (1 −a)2(k + 1)ak,
a−1 = 1 + m22m−1
`2m−2
m−1
´ .
Generally, for a simple variety of trees under the usual conditions of existence of a solution to
the characteristic equation, V = zφ(V ), one ﬁnds “en deux coups de cuill`ere `a pot”,
V (z, u)
=
zφ(V (z) + Vmzm(u −1))
V (z, u)
∼
ρφ(τ + Vmρm(u −1)) −ργφ′(τ + Vmρm(u −1))
p
1 −z/ρ
limit PGF
=
φ′(τ + Vmρm(u −1))
φ′(τ)
.
(Notations are the same as in Example 3.) . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE IX.4. □

590
IX. MULTIVARIATE ASYMPTOTICS
Arbitrarily many schemas leading to discrete limit laws could be listed. Roughly,
conditions are that the auxiliary variable u does not affect the location nor the nature
of the dominant singularity of F(z, u). Such conditions are met by the subcritical
schemas, since eventually the auxiliary variable only appears as a multiplicative coef-
ﬁcient in a local singular expansion.
 IX.10. The product schema. Deﬁne
F(z, u) = A(uz) · B(z),
that corresponds to a product construction, F = A × B, with u marking the size of the A–
component in the product. Assume that the radii of convergence satisfy ρA > ρB and that
B(z) has a unique dominant singularity of the algebraic-logarithmic type. Then, the size of the
A component in arandom F structure has a discrete limit law with PGF,
p(u) = A(ρu)
A(ρ) .
The proof results directly from singularity analysis. Alternatively, an elementary proof can be
given based on the weaker requirement that the coefﬁcient of B satisfy bn+1/bn →ρ−1.

Regarding the number of components, the case of a supercritical composition
leads to continuous limit laws of the Gaussian type, as we shall see in the next sec-
tions. The critical case may lead to a variety of probabilistic laws due to the conﬂuence
of singularities that then manisfests itself. In the example that follows, we show that a
particular critical composition scheme already studied in Chapter VII leads to a collec-
tion of Poisson laws describing the small component proﬁle of composite structures.
EXAMPLE IX.5.
Small components in sets of logarithmic structures. Consider ﬁrst the exp–
log schema in the simpler labelled case: it is corresponds to the construction F = P(G),
that is, F(z, u) = exp(uG(z)) under the assumption that G(z) is logarithmic. This means
(Chapter VII) that G(z) is ∆-singular and satisﬁes locally
G(z) = κL(z/ρ) + λ + η(z),
where
L(z) := log(1 −z)−1,
and η(z) = O(1/L(z/ρ)2) as z →ρ in a ∆domain. We already know from Chapter VII
that the number of components has mean and variance each of the order of log n, so that a
discrete limit law is not to be expected for the total number of components. However, the
situation becomes quite different if ﬁxed size components are considered. A limit distribution
has already been obtained in Chapter VII under its local form and it may be revisited in the light
of methods of the present chapter as follows. Let m be a ﬁxed integer larger than 1. The BGF
of F objects with u marking the number of m components is
F(z, u) = exp ((u −1)grzr) .
Under the logarithmic assumption, one has for any u in a small neighbourhood of 1 as z →ρ
in a ∆-domain:
F(z, u) ∼eλw(u)(1 −z/ρ)−κ,
w(u) = exp ((u −1)grρr) .
By singularity analysis, this tells us that the number of m–components in a random F–structure
of large size tends to a Poisson distribution with parameter λ := grρr.
This result applies for any m less than some arbitrary ﬁxed bound B. In addition, tru-
ely multivariate methods discused at the end of this chapter enable one to prove that the
the number of components of sizes 1, 2, . . . , B are asymptotically independent. This gives a
very precise model of the probabilistic proﬁle of small components in random F–objects as
a product of independent Poisson laws of parameter grρr for r = 1, . . . , B. Similar results

IX. 3. COMBINATORIAL INSTANCES OF DISCRETE LAWS
591
FIGURE IX.5.
Small components of size ≤20 in random permutations (left)
and random mappings (right) of size 1,000: each object corresponds to a line and
each component is represented by a square of proportional area.
hold for unlabelled multisets, but with the negative binomial law replacing the Poisson law.
END OF EXAMPLE IX.5. □
The previous example covers well known exp-log structures introduced by Flajo-
let and Soria in [210]. In the labelled case, we have permutations (as sets of cycles),
random mappings and 2–regular graphs (as sets of connected components). A render-
ing of the cycle structure of random permutations already appears in Chapter III; see
also Figure 5. In the unlabelled case, the prime example is that of polynomials over
ﬁnite ﬁelds to which we return later in this chapter.
In contrast, large component sizes cannot be independently distributed. (E.g., a
permutation can have only cycle one larger than n/2, two cycles larger than n/3, etc.)
A general probabilistic theory of the joint distribution of largest components in exp–
log structures has been developed by Arratia, Barbour, and Tavar´e [16] and some of its
developments draw their inspiration from earlier studies conducted under the analytic
combinatorial angle. This joint distribution of large components can be characterized
in terms of what is known as the Poisson–Dirichlet process. For instance, as shown by
Gourdon [246], the largest component itself involves the Dickmann function otherwise
known to describe the distribution of the largest prime divisor of a random integer over
a large interval of the form [1 . . N].
 IX.11. Random mappings. The number of components of some ﬁxed size m in a large
random mapping (functional graph) is asymptotically Poisson(λ) where λ = Kme−m/m! and
Km = m![zm] log(1 −T)−1 enumerates connected mappings. (There T is the Cayley tree
function.) The fact that Kme−m/m! ≈1/(2m) explains the fact that small compoents are
somewhat sparser for mappings than for permutations.


592
IX. MULTIVARIATE ASYMPTOTICS
FIGURE IX.6.
Walks, excursions, bridges, and meanders: random samples of
length 50.
As a last example here, we discuss the length of the longest initial run of a’s in
random binary words satisfying various types of constraints. This discussion com-
pletes the informal presentation of Section IX. 1. The basic combinatorial objects are
the set W = {a, b}⋆of binary words. A word w ∈{W} can also be viewed as de-
scribing a walk in the plane, provided one interprets a and b as the vectors (+1, +1)
and (+1, −1) respectively. Such walks in turn describe ﬂuctuations in coin tossing
games, as described by Feller [161]. What is especially interesting here is to observe
the complete chain where a speciﬁc constraint leads in succession to a combinatorial
decomposition, a speciﬁc analytic type of BGF, and a local singular structure that is
then reﬂected by a particular limit law.
EXAMPLE IX.6. Initial runs in random walks. We consider here walks in the right half plane
that start from the origin and are made of steps a = (1, 1), b = (1, −1). According to the
discussion of Chapters V and VII, one can distinguish four major types of walks (Figure 6).
• Unconstrained walks (W) corresponding to words and freely described by W =
S(a, b);
• Dyck paths (D) that always have a nonnegative ordinate and end at level 0; the
closely related class G = Db represents the collection of gambler’s ruin sequences.
In probability theory, Dyck paths are also refereed to as excursions.
• Bridges (B) that are walks that may have negative ordinates but must ﬁnish at level 0.
• Meanders (M) which have have always a nonnegative altitude and may end at an
arbitrary nonnegative altitude.
The parameter χ of interest is in all cases the length of the longest initial run of a’s.
First, the unconstrained walks obey the decomposition
W = S(a)S(bS(a)),
already employed in Chapters I and IV. Thus, the BGF is
W (z, u) =
1
1 −zu
1
1 −z(1 −z)−1 .
By singularity analysis of the pole at ρ = 1/2, the PGF of χ on random words of Wn satisﬁes
pn(u) ∼
1
2
1 −u
2
,

IX. 3. COMBINATORIAL INSTANCES OF DISCRETE LAWS
593
and, as expected, this corresponds to a limit geometric law of parameter 1
2. This is the ﬁrst
example presented (Section IX. 1) in order to introduce discrete limit laws.
As it is well-known, Dyck paths D play an important rˆole in combinatorial constructions
related to lattice paths (Chapters I and V). A sequence decomposes into “arches” that are
themselves Dyck paths encapsulated by a pair a, b,
D = S(aDb),
which yields a GF of the Catalan domain,
D(z) =
1
1 −z2D(z),
D(z) = 1 −
√
1 −4z2
2z2
.
In order to extract the initial run of a’s, we observe that a word whose initial a-run is ak con-
tains k components of the form bD. This corresponds to a decomposition in terms of the ﬁrst
traversals of altitudes k −1, . . . , 1, 0,
D =
X
k≥0
ak(bD)k,
illustrated by the following diagram:
Thus, the BGF is
D(z, u) =
1
1 −z2uD(z).
This is an even function of z. In terms of the singular element, δ = (1 −4z)1/2, one ﬁnds
F1(z1/2, u) =
2
2 −u −
2u
(2 −u)2 δ + O(δ2),
as z →1/4. Thus, the PGF of χ on random words of D2n satisﬁes
p2n(u) ∼
u
(2 −u)2 ,
which is the PGF of a negative binomial NB[2] of parameter 1
2 shifted by 1. (Naturally, in this
case, explicit expressions for the combinatorial distribution are available, as this is equivalent
to the classical ballot problem.)
A bridge decomposes into a sequence of arches, either positive or negative,
B = S(aDb + bDa),
where D is like D, but with the rˆoles of a and b interchanged. In terms of OGFs, this gives
B(z) =
1
1 −2z2D(z) =
1
√
1 −4z2 .
The set B+ of nonempty walks that start with at least one a admits a decomposition similar to
that D,
B+(z) =
0
@X
k≥1
akb(Db)k−1
1
A · B,

594
IX. MULTIVARIATE ASYMPTOTICS
since the paths factor uniquely as a D component that hits 0 for the ﬁrst time followed by a B
oscillation. Thus,
B+(z) =
z2
1 −z2D(z)B(z).
The remaining cases B−= B\B+ consist of either the empty word or of a sequence of positive
or negative arches starting with a negative arch, so that
B−(z) = 1 +
z2D(z)
1 −2z2D(z).
The BGF results from these decompositions:
B(z, u) =
z2u
1 −z2uD(z)B(z) + 1 +
z2D(z)
1 −2z2D(z).
Again, the singular expansion is obtained mechanically,
B(z1/2, u) =
1
2 −u
1
δ + O(1),
where δ = (1 −4z)1/2. Thus, the PGF of χ on random words of B2n satisﬁes
p2n(u) ∼
1
2 −u.
The limit law is geometric of parameter 1/2.
A meander decomposes into an initial run ak, a succession of descents with their compan-
ion (positive) arches in some number ℓ≤k, and a succession of ascents with their correspond-
ing (positive) arches. The computations are similar to the previous cases, more intricate, but
still “automatic”. One ﬁnds that
M(z, u) =
„
XY
(1 −X)(1 −Y ) −
XY 2
(1 −XY )(1 −Y )
«
1
1 −Y +
1
1 −X ,
with X = zu, Y = zW1(z), so that
M(z, u) = 2
1 −u −2 z + 2 uz2 + (u −1)
√
1 −4 z2
(1 −zu)
`
1 −2 z −
√
1 −4 z2´ `
2 −u + u
√
1 −4 z2´.
There are now two singularities at z = ± 1
2, with singular expansions,
M(z, u)
=
z→1/2
u
√
2
(2 −u)2
1
√1 −2z + O(1),
M(z, u)
=
z→−1/2
4 −u
4 −u2 + o(1),
so that only the singularity at 1/2 matters asymptotically. Then, we have
pn(u) ∼
u
(2 −u)2 ,
and the limit law is a shifted negative binomial NB[2] of parameter 1/2. In summary:
Proposition IX.5. The length of the initial run of a’s in unconstrained walks and bridges is
asymptotically distributed like a geometric; in Dyck excursions and meanders like a negative
binomial NB[2].
Similar
analyses
can
be
applied
to
walks
with
a
ﬁnite
set
of
steps
[21].
END OF EXAMPLE IX.6. □

IX. 4. CONTINUOUS LIMIT LAWS
595
 IX.12. The number of meanders.
A meander uniquely decomposes into an excursion
followed by a (possibly empty) sequence of elements of the form aD.
There results that
M(z) = D(z)/(1 −zD(z)), and
M(z) =
√
1 −4z2 −1 + 2z
2z(1 −2z)
,
so that Mn =
`
n
⌊n/2⌋
´
.

 IX.13. Leftmost branch of a unary-binary (Motzkin) tree. The class of unary-binary trees
(or Motkzkin trees) is deﬁned as the class of unlabelled rooted plane trees where (out)degrees
of nodes are restricted to the set {0, 1, 2}. The parameter χ under consideration is the length
of the lefmost branch measured by the number of nodes it contains. A tree can be viewed as
a leftmost branch at each node of which is grafted either nothing (the node has degree 1) or a
tree, except for the last node on the branch. Hence the decomposition and the BGF:
M(z) =
X
k≥1
zkM(z)k−1,
M(z, u) =
z
1 −zuM(z).
The ﬁrst equation corresponds to M = z(1 + M + M 2) as it should. The dominant singularity
is at z = 1/3 where M( 1
3) = 1. There results that the limit PGF of χ is 4u/(3 −u)2. The
limit distribution is a negative binomial NB[2] with parameter 1
3, shifted by 1.

IX. 4. Continuous limit laws
Throughout this chapter, our goal is to quantify sequences of random variables
Xn that arise from an integer valued combinatorial parameter χ deﬁned on a combi-
natorial class F. It is a fact that, when the mean µn and the standard deviation σn of χ
on Fn tend to inﬁnity as n gets large, then a continuous limit law usually holds. That
limit law arises not from the Xn themselves (as was the case for discrete-to-discrete
convergence in the previous section) but from their standardized versions:
X⋆
n = Xn −µn
σn
.
In this section, we provide deﬁnitions and major theorems needed to deal with the
discrete-to-continuous situation.
A random variable Y speciﬁed by its distribution function,
P{Y ≤x} = F(x),
is said to be continuous if F(x) is continuous (see APPENDIX C: Random variables,
p. 717). In that case, F(x) has no jump, and there is no single value in the range of Y
that bears a nonzero probability mass. If in addition F(x) is differentiable, the random
variable Y is said to have a density, g(x) = F ′(x), so that
P(Y ≤x) =
Z x
−∞
g(x) dx,
P{x < Y ≤x + dx} = g(x) dx.
A particularly important case for us here is the standard Gaussian or normal distribu-
tion function,
Φ(x) =
1
√
2π
Z x
−∞
e−w2/2 dw,

596
IX. MULTIVARIATE ASYMPTOTICS
also called the error function (erf), the corresponding density being
ξ(x) ≡Φ′(x) =
1
√
2πe−x2/2.
This section and the next ones are relative to the existence of limit laws of the con-
tinuous type, with Gaussian limits playing a prominent rˆole. The general deﬁnitions
of convergence in law (or in distribution) and of weak convergence (see APPENDIX C:
Convergence in law, p. 722) instantiate as follows.
Deﬁnition IX.3 (Discrete-to-continuousconvergence). Let Y be a continuous random
variable with distribution function FY (x). A sequence of random variables Yn with
distribution functions FYn(x) is said to converge in distribution to Y if, pointwise, for
each x,
lim
n→∞FYn(x) = FY (x).
In that case, one writes Yn
D
=⇒Y and FYn
D
=⇒FY .
Convergence is said to take place at speed ǫn if
sup
x∈R
|FYn(x) −FY (x)| ≤ǫn.
The deﬁnition does not a priori require uniform convergence. It is a known fact
that convergence to a continuous limit is always uniform. This uniformity means that
there always exists a speed ǫn that tends to 0 as n →∞.
Discrete limit laws can be established via convergence of probability generating
functions to a common limit, as asserted by the continuity theorem for PGFs, Theo-
rem IX.1. In the case of continuous limit laws, one has to resort to integral transforms
(see APPENDIX C: Transforms of distributions, p. 718), whose deﬁnitions we now
recall.
— The Laplace transform —also called the moment generating function—
λY (s) is deﬁned by
λY (s) := E{esY } =
Z +∞
−∞
esx dF(x).
— the Fourier transform —also called the characteristic function— φY (t) is
deﬁned by
φY (t) := E{eitY } =
Z +∞
−∞
eitx dF(x).
(Integrals are taken in the sense of Lebesgue-Stieltjes or Riemann-Stieltjes; cf AP-
PENDIX C: Probability spaces and measure, p. 715.)
There are two classical versions of the continuity theorem, one for characteris-
tic functions, the other for Laplace transforms. Both may be viewed as extensions
of the continuity theorem for PGF’s. Characteristic functions always exist and the
corresponding continuity theorem gives a necessary and sufﬁcient condition for con-
vergence of distributions. As they are a universal tool, characteristic functions are
therefore often favoured in the probabilistic literature. In the context of this book,

IX. 4. CONTINUOUS LIMIT LAWS
597
strong analyticity properties go along with combinatorial constructions so that both
transforms usually exist and can be put to good use.
Theorem IX.4 (Continuity of integral transforms). Let Y, Yn be random variables
with Fourier transforms (characteristic functions) φ(t), φn(t), and assume that Y has
a continuous distribution function. A necessary and sufﬁcient condition for the con-
vergence in distribution, Yn
D
=⇒Y , is that, pointwise, for each real t,
lim
n→∞φn(t) = φ(t).
Let Y, Yn be random variables with Laplace transforms λ(s), λn(s) that exist in
a common interval [−s0, s0]. If, pointwise for each real s ∈[−s0, s0],
lim
n→∞λn(s) = λ(s),
then the Yn converge in distribution to Y : Yn
D
=⇒Y .
The ﬁrst part of this thorem is also known as L´evy’s continuity theorem for char-
acteristic functions.
PROOF. See Billingsley’s book [55, Sec. 26], for Fourier transforms, and [55, p. 408],
for Laplace transforms.
□
 IX.14. Laplace transforms need not exists. Let Yn be a mixture of a Gaussian and a Cauchy
distribution:
P(Yn ≤x) =
„
1 −1
n
« Z x
−∞
e−w2/2
√
2π
dw + 1
πn
Z x
−∞
dw
1 + w2 .
Then Yn convergences in distribution to a standard Gaussian limit Y , though λn(s) only exists
for ℜ(s) = 0.

The continuity theorem for PGFs eventually relies on continuity of the Cauchy
coefﬁcient formula that realizes the inversion needed in recovering coefﬁcients from
PGFs. Similarly, the continuity theorem for integral transforms may be viewed as
expressing the continuity of inverse Laplace or Fourier transforms, this in the speciﬁc
context of probability distribution functions.
The next theorem is an effective version of the Fourier inversion theorem that
proves especially useful for characterizing speeds of convergence. It bounds in a
constructive manner the sup-norm distance between two distribution functions by a
special metric distance between their characteristic functions. Recall that ||f||∞:=
supx∈R |f(x)|.
Theorem IX.5 (Berry-Esseen inequality). Let F, G be distribution functions with
characteristic functions φ(t), γ(t). Assume that G has a bounded derivative. There
exist absolute constants c1, c2 such that for any T > 0,
||F −G||∞≤c1
Z +T
−T

φ(t) −γ(t)
t
 dt + c2
||G′||∞
T
.
PROOF. See Feller [162, p. 538] who gives
c1 = 1
π ,
c2 = 24
π
as possible values for the constants. 2

598
IX. MULTIVARIATE ASYMPTOTICS
0
0.2
0.4
0.6
0.8
1
-3
-2
-1
1
2
3
x
-0.1
0
0.1
0.2
0.3
0.4
-4
-2
2
4
t
1
2
3
4
5
6
-2
-1
0
1
2
t
FIGURE IX.7.
The standardized distribution functions of the binomial law
(top), the corresponding Fourier transforms (middle), and the Laplace trans-
forms (bottom), for n = 3, 6, 9, 12, 15.
The distribution functions centred
around the mean µn
= n/2 and scaled according to the standard devia-
tion σn = n1/2/2 converge to a limit which is the Gaussian error function,
Φ(x) =
1
√
2π
Z x
−∞
e−w2/2 dw. Accordingly, the corresponding Fourier trans-
forms —or characteristic functions— converge to φ(t) = e−t2/2, while the
Laplace transforms —or moment generating functions— converge to λ(s) =
es2/2.
This theorem is typically used with G being the limit distribution function (often
a Gaussian for which ||G′||∞= (2π)−1/2) and F = Fn a distribution that belongs to
a sequence converging to G. The quantity T may be assigned an arbitrary value; the
one giving the best bound in a speciﬁc application context is then normally chosen.
 IX.15. A general version of Berry–Esseen. Let F, G be two distributions functions. Deﬁne
L´evy’s “concentration function”, QG(h) := supx(G(x+h)−G(x)),
h > 0. There exists

IX. 4. CONTINUOUS LIMIT LAWS
599
an absolute constant C such that
||F −G||∞≤CQG( 1
T ) + C
Z +T
−T
˛˛˛˛
φ(t) −γ(t)
t
˛˛˛˛ dt.
See Elliott’s book [151, Lemma 1.47] and the article by Stef and Tenenbaum for a discus-
sion [452]. The latter provides inequalities analogous to Berry-Esseen, but relative to Laplace
transforms on the real line (bounds tend to be much weaker due to the smoothing nature of the
Laplace transform).

Large powers and the central limit theorem. The binomial distribution is deﬁned
as the distribution of a random variable Xn with PGF
pn(u) =
1
2 + u
2
n
,
and characteristic function, φn(t) = pn(eit). The mean is µn = n/2 and the vari-
ance is σ2
n = n/4. Therefore, the standardized variable X∗
n = (Xn −µn)/σn has
characteristic function
(14)
φ∗
n(t) ≡E(eitX⋆
n) =

cosh( it
√n
n
.
The asymptotic form is directly found by taking logarithms, and one ﬁnds
(15)
log φ∗
n(t) = n log

1 −t2
2n + t4
6n2 + · · ·

= −t2
2 + O( 1
n),
pointwise, for any ﬁxed t, as n →∞. This establishes convergence to the Gaussian
limit. In addition, the Berry-Esseen inequalities show that the speed of convergence is
O(n−1/2), a fact that is otherwise easily veriﬁed directly using Stirling’s formula.
 IX.16. De Moivre’s Central Limit Theorem. Characteristic functions extend the normal limit
law for unbiased Bernoulli distributions to the general case with PGF (p + qu)n, for ﬁxed p, q
with p + q = 1. (The result is accessible directly from Stirling’s formula, which constitutes De
Moivre’s original derivation.)

The central limit theorem (CLT, then term was coined by P´olya in 1920, originally
because of its “zentralle Rolle” in probability theory) of probability theory expresses
the Gaussian character of sums of random variables. It was ﬁrst discovered4 in the
particular case of Bernoulli variables by De Moivre. The general version is due to
Gauss (who, around 1809, had realized from his works on geodesy and astronomy
the universality of the “Gaussian” law but had only unsatisfactory arguments) and to
Laplace (in the period 1812–1820). Laplace in particular uses Fourier methods and his
formulation of the CLT is fully general, though some of the precise validity conditions
of his arguments only became apparent a century later.
Theorem IX.6 (Basic CLT). Let Tj be independent random variables supported by
Z≥0 with a common distribution of (ﬁnite) mean µ and (ﬁnite) standard deviation σ.
4For a perspective on historical aspects of CLT, we refer to Hans Fischer’s well-informed mono-
graph [167].

600
IX. MULTIVARIATE ASYMPTOTICS
Let Sn := T1 + · · · + Tn. Then the standardized sum S⋆
n converges to the standard
normal distribution,
S⋆
n ≡Sn −µn
σ√n
D
=⇒N(0, 1).
PROOF. The proof is based on local expansions of characteristic functions. First, by a
general theorem, the existence of the ﬁrst two moments implies that
φT (t) = 1 + iµt −1
2(µ2 + σ2)t2 + o(t2),
t →0.
By shifting, it sufﬁces to consider the case of zero-mean variables (µ = 0). We then
have, pointwise for each t as n →∞,
φT

t
σ√n
n
=

1 −t2
2n + o( t2
2n)
n
→e−t2/2,
like in Equations (14) and (15). The conclusion follows from the continuity theorem.
(This theorem is in virtually any basic book on probability theory, e.g., [162, p. 259]
or [55, Sec. 27].)
□
The central limit theorem in the independent case is the subject of Petrov’s com-
prehensive monograph [394]. There are many extensions of the CLT, to variables that
are independent but not necessarily identically distributed (the Lindeberg–Lyapunov
conditions) or variables that are only dependent in some weak sense (mixing condi-
tions); see the discussion by Billingsley [55, Sec. 27]. In the particular case where the
T ’s are discrete, a stronger “local” form of the Theorem results from the saddle point
method; see our discussion in Chapter VIII, the classic treatment by Gnedenko and
Kolmogorov [237], and extensions in Section IX. 9.
 IX.17. Poisson distributions of large parameter. Let Xλ be Poisson with rate λ. As λ tends to
inﬁnity, Stirling’s formula provides easily convergence to a Gaussian limit. The error terms can
then be compared to what the Berry-Esseen bounds provide. (In terms of speed of convergence,
such Poisson approximations to combinatorial distributions are sometimes of a better quality
than the standard Gaussian law; see Hwang’s comprehensive study [276] for a general analytic
approach.)

IX. 5. Quasi-powers and Gaussian limits
The central limit theorem of probability theory admits a fruitful extension in the
context of analytic combinatorics. As we now show, it sufﬁces that the PGF of a
combinatorial parameter behaves nearly like a large power of a ﬁxed function to en-
sure convergence to a Gaussian limit. We ﬁrst illustrate this point by considering the
Stirling cycle distribution.
EXAMPLE IX.7. The Stirling cycle distribution. Consider the Stirling cycle numbers
ˆn
k
˜
, and
let Xn be the corresponding random variable with probability distribution
ˆ 1
n!
nk
˜
, with PGF,
pn(u) =
 
n + u −1
n
!
= u(u + 1)(u + 2) · · · (u + n −1)
n!
=
Γ(u + n)
Γ(u)Γ(n + 1).
We have for ﬁxed u near 1,
(16)
pn(u) = nu−1
Γ(u)
„
1 + O( 1
n)
«
=
1
Γ(u)
“
e(u−1)”log n „
1 + O( 1
n)
«
.

IX. 5. QUASI-POWERS AND GAUSSIAN LIMITS
601
As results from Stirling’s formula for the Gamma function (or from singularity analysis of
[zn](1 −z)−u, Chapter VI), the error term in (16) is O(n−1) when u stays in a small enough
neighbourhhod of 1, for instance |u −1| ≤1
2. Thus, as n →+∞, pn(u) is approximately a
“large power” of eu−1 taken with exponent log n, multiplied by a ﬁxed function, (Γ(u))−1. By
analogy to the central limit theorem, we may expect a Gaussian law.
The mean satisﬁes µn = log n+γ +o(1), the standard deviation satisﬁes σn = √log n+
o(1). We thus consider the standardized random variable,
X∗
n = Xn −L −γ
√
L
,
L = log n,
whose characteristic function is
φ∗
n(t) = e−it(L1/2+γL−1/2)
Γ(eit/
√
L)
exp
“
L(eit/
√
L −1)
” „
1 + O( 1
n)
«
.
For ﬁxed t, with L →∞, the logarithm is then found mechanically to satisfy
log φ∗
n(t) = −t2
2 + O((log n)−1/2).
This is sufﬁcient to establish a Gaussian limit law,
(17)
lim
n→∞P
n
Xn ≤log n + γ + x
p
log n
o
=
1
√
2π
Z x
−∞
e−w2/2 dw.
Proposition IX.6 (Goncharov’s Theorem). The Stirling cycle distribution, P(Xn = k) =
1
n!
ˆn
k
˜
, describing the number of cycles and the number of records in a random permutation of
size n is asymptotically normal.
This result was obtained by Goncharov as early as 1944, see [240], albeit without an error
term as his investigations predate the Berry-Esseen inequalities.
END OF EXAMPLE IX.7. □
The cycle example is characteristic of the occurrence of Gaussian laws in analytic
combinatorics. What happens is that the approximation (16) by a power with “large”
exponent βn = log n leads after normalization, to the characteristic function of a
Gaussian variable, namely e−t2/2. From there, the limit distribution (17) results by
the continuity theorem. This is in fact a very general phenomenon, as demonstrated
by a theorem of Hsien-Kuei Hwang [272, 275] that we state next and that builds upon
earlier statements of Bender and Richmond [36].
The following notations prove especially convenient: given a function f(u) ana-
lytic at u = 1, we set
(18)
m(f) = f ′(1)
f(1) ,
v(f) = f ′′(1)
f(1) + f ′(1)
f(1) −
f ′(1)
f(1)
2
.
The notations m, v suggest their probabilistic counterparts while neatly distinguishing
between the analytic and probabilistic realms: If f is the PGF of a random variable X,
then f(1) = 1 and m(f), the mean, coincides with the expectation E(X); the quantity
v(f) then coincides with the variance V(X).
Theorem IX.7 (Quasi-Powers, Central law). Let the Xn be nonnegative discrete ran-
dom variables with probability generating function pn(u). Assume that, uniformly in

602
IX. MULTIVARIATE ASYMPTOTICS
a ﬁxed complex neighbourhood of u = 1, for sequences βn, κn →+∞, there holds
(19)
pn(u) = A(u) (B(u))βn

1 + O( 1
κn
)

,
where A(u), B(u) are analytic at u = 1 and A(1) = B(1) = 1. Assume ﬁnally that
B(u) satisﬁes the so-called “variability condition”,
v(B(u)) ≡B′′(1) + B′(1) −B′(1) ̸= 0.
Under these conditions, the distribution of Xn is asymptotically Gaussian, and the
speed of convergence to the Gaussian limit is O(κ−1
n
+ β−1/2
n
):
P
(
Xn −βnU ′(0)
p
βnU ′′(0)
≤x
)
= Φ(x) + O
 1
κn
+
1
√βn

.
The mean and variance of Xn satisfy
(20)
µn
≡
E(Xn)
=
βn m(B(u)) + m(A(u)) + O( 1
κn
)
σ2
n
≡
V(Xn)
=
βn v(B(u)) + v(A(u)) + O( 1
κn
)
This theorem is a direct application of the following lemma, also due to Hwang,
that applies more generally to arbitrary discrete or continuous distributions, and is thus
entirely phrased in terms of integral transforms.
Lemma IX.1 (Quasi-Powers, general distributions). Assume that the Laplace trans-
forms λn(s) = E{esXn} of a sequence of random variables Xn are analytic in a disc
|s| < ρ, for some ρ > 0, and satisfy there an expansion of the form
(21)
λn(s) = eβnU(s)+V (s)

1 + O( 1
κn
)

,
with βn, κn →+∞as n →+∞, and U(s), V (s) analytic in |s| ≤ρ. Assume also
the variability condition,
U ′′(0) ̸= 0.
Under these assumptions, the mean and variance of Xn satisfy
(22)
E{Xn}
=
βnU ′(0) + V ′(0) + O(κ−1
n ),
V{Xn}
=
βnU ′′(0) + V ′′(0) + O(κ−1
n ).
The distribution of Xn is asymptotically Gaussian and the speed of convergence to the
Gaussian limit is O(κ−1
n
+ β−1/2
n
).
PROOF. This closely follows the lines of Hwang’s works [272, 275]. First, we estimate
the mean and variance. The variable s is a priori restricted to a small neighbourhood
of 0. By assumption, the function log λn(s) is analytic at 0 and it satisﬁes
log λn(s) = βnU(s) + V (s) + O( 1
κn
)

IX. 5. QUASI-POWERS AND GAUSSIAN LIMITS
603
This asymptotic expansion carries over, with the same type of error term, to deriva-
tives at 0 because of analyticity: this can be checked directly from Cauchy integral
representations,
1
k!
dr
dsr log λn(s)

s=0
=
1
2iπ
Z
γ
log λn(s) ds
sr+1 ,
upon using a small but ﬁxed integration contour γ and taking advantage of the basic
expansion of log λn(s). In particular, the mean and variance satisfy the estimates
of (22).
Next, we consider the standardized variable,
X⋆
n = Xn −βnU ′(0)
p
βnU ′′(0)
,
λ⋆
n(s) = E{esX⋆
n}.
We have
log λ⋆
n(s) = −βnU ′(0)
p
βnU ′′(0)
s + log λn(
s
p
βnU ′′(0)
).
Local expansions to third order based on the assumption (21) show that
(23)
log λ⋆
n(s) = s2
2 + O(|s| + |s|3
β1/2
n
) + O( 1
κn
),
uniformly with respect to s in a disc of radius O(β1/2
n
), and in particular in any ﬁxed
neighbourhood of 0. This is enough to conclude as regards convergence in distribution
to a Gaussian limit, by the continuity theorem of either Laplace transforms (restrict-
ing s to be real) or of Fourier transforms (taking s = it).
Finally, the speed of convergenceresults from the Berry-Esseen inequalities. Take
T ≡Tn = cβ1/2
n
, where c is taken sufﬁciently small but nonzero, in such a way that
the local expansion of λn(s) at 0 applies. Then, the expansion (23) instantiated at
s = it entails that the quantity
∆n :=
Z Tn
−Tn

λ⋆
n(it) −e−t2/2
t
 dt + 1
Tn
satisﬁes
∆n = O(β−1/2
n
+ κ−1
n ),
and the statement follows by the Berry-Esseen theorem.
□
Theorem IX.7 applies immediately to the Stirling cycle distribution for which
the estimate (16) was derived. It shows in addition that the speed of convergence is
O((log n)−1/2) for this distribution.
The Quasi-Powers Theorem under either form (19) or (21) can be read formally
as expressing the distribution of a (pseudo)random variable
Z = Y0 + W1 + W2 + · · · + Wβn,
where Y0 “corresponds” to eV (s) (or A(u)) and each Wj to eU(s) (or B(u)). However,
there is no a priori requirement that βn should be an integer, nor that eU(s), eV (s)
be Laplace transforms of probability distribution functions. In a way, the theorem
recycles the intuition that underlies the central limit theorem and makes use of the

604
IX. MULTIVARIATE ASYMPTOTICS
analytic machinery behind it. But, in applications, functions like eU(s), eV (s) do not
necessarily admit a direct probabilistic interpretation.
It is of particular importance to note that the conditions of Theorem IX.7 and
Lemma IX.1 are purely local: what is required is local analyticity of the quasi-power
approximation at u = 1 for PGF’s or, equivalently, s = 0 for Laplace-Fourier trans-
forms. This important feature is ultimately due the normalization of random variables
and transforms that goes along with continuous limit laws
 IX.18. Higher moments under Quasi-powers. Following Hwang [275], one has under the
conditions of the Quasi-Powers Theorem, Lemma IX.1, and for each ﬁxed k,
E(Xk
n) = k!̟k(βn) + O
„βk
n
κn
«
,
̟k(s) := [sk]eβnU(s)+V (s).
(̟k is a polynomial of degree k, which describes precisely the behaviour of higher moments.)

Singularity perturbation and Gaussian laws. The main thread of this chapter is
bivariate generating functions. In general, we are given a BGF F(z, u) and aim at
extracting a limit distribution from it. The quasi-power paradigm in the form (19) is
what one should look for, in the case where the mean and the standard deviation both
tend to inﬁnity with the size n of the model.
We proceed heuristically in this informal discussion. Start from the BGF and
consider u as a parameter. If singularity analysis applies to the counting generating
function F(z, 1), it leads to an approximation,
fn ≈C · ρ−nnα,
where ρ is the dominant singularity of F(z, 1) and α is related to the critical exponent
of F(z, 1) at ρ. A similar type of analysis is often applicable to F(z, u) for u near 1.
Then, it is reasonable to expect an approximation for the z-coefﬁcients of the bivariate
GF,
fn(u) ≈C(u)ρ(u)−nnα(u).
In this perspective, the corresponding PGF is of the form
pn(u) ≈C(u)
C(1)
ρ(u)
ρ(1)
−n
nα(u)−α(1).
The strategy envisioned here is thus a perturbation analysis of singular expansions
with the auxiliary parameter u being restricted to a small neighbourhood of 1.
In particular if only the dominant singularity moves with u, we have a rough form
pn(u) ≈C(u)
C(1)
ρ(u)
ρ(1)
−n
,
suggesting a Gaussian law with mean and variance that are both O(n). If only the
exponent moves, then
pn(u) ≈C(u)
C(1) nα(u)−α(1),
suggests again a Gaussian law, but with mean and variance that are both O(log n).

IX. 6. PERTURBATION OF MEROMORPHIC ASYMPTOTICS
605
These cases point to the fact that a rather simple perturbation of a univariate
analysis may yield limiting Gaussian distributions. Each major coefﬁcient extrac-
tion method of Chapters IV–VIII plays a rˆole, and the present chapter illustrates this
important point in the following contexts:
— meromorphic analysis for functions with polar singularities (Section IX. 6
below, based on a perturbation of methods of Chapters IV and V);
— singularity analysis for functions with algebraic–logarithmic singularity
(Section IX. 7 below, based on a perturbation of methods of Chapters VI
and VII);
— saddle point analysis for functions with fast growth at their singularity (Sec-
tion IX. 8 below, based on a perturbation of methods of Chapters VIII).
Roughly, the decomposable character of many elementary combinatorial struc-
tures is reﬂected by strong analyticity properties of bivariate GF’s that, after perturba-
tion analysis, lead, via the Quasi-Powers Theorem (Theorem IX.7), to Gausssain laws.
The coefﬁcient extraction methods being based on contour integration supply the nec-
essary uniformity conditions. (In contrast, Darboux’s method or Tauberian theorems,
being nonconstructive, are not normally applicable in this context.)
IX. 6. Perturbation of meromorphic asymptotics
This section discusses schemas that rely on the analysis of coefﬁcients of mero-
morphic functions, as discussed in Chapters IV and V. It is largely based on works
of Bender who, starting with his seminal article [28], was the ﬁrst to propose abstract
analytic schemas leading to Gaussian laws in analytic combinatorics. Our presenta-
tion also follows subsequent works of Bender, Flajolet, Hwang, Richmond, and So-
ria [36, 210, 212, 272, 273, 274, 275, 443].
EXAMPLE IX.8. The surjection distribution. We revisit the distribution of image cardinality in
surjections for which the concentration property has been established in Chapter V. This exam-
ple serves to introduce bivariate asymptotics in the meromorphic case. Consider the distribution
of image cardinality in surjections, with BGF
F(z, u) =
1
1 −u(ez −1).
Restrict u near 1, for instance |u −1| ≤
1
10. The function F(z, u), as a function of z, is
meromorphic with singularities at
ρ(u) + 2ikπ,
ρ(u) = log(1 + 1
u).
The principal determination of the logarithm is used (with ρ(u) near log 2 when u is near 1). It
is then seen that ρ(u) stays within 0.06 from log 2, for |u −1| ≤
1
10. Thus ρ(u) is the unique
dominant singularity of F, the next nearest one being ρ(u) ± 2iπ with modulus certainly larger
than 6.
From the coefﬁcient analysis of meromorphic functions (Chapter IV), the quantities
fn(u) = [zn]F(z, u) are estimated as follows,
(24)
fn(u)
=
Res
`
F(z, u)z−n−1´
z=ρ(u) +
1
2iπ
Z
|z|=5
F(z, u)
dz
zn+1
=
1
uρ(u)eρ(u) ρ(u)−n + O(5−n).

606
IX. MULTIVARIATE ASYMPTOTICS
It is important to note that the error term is uniform with respect to u, once u has been con-
strained to satisfy |u −1| ≤0.1. This fact derives from the coefﬁcient extraction method,
since, in the remainder Cauchy integral of (24), the denominator of F(z, u) stays bounded
away from 0.
The second estimate in Equation (24), constitutes a prototypical case of application of the
quasi-power schema. Thus, the number Xn of image points in a random surjection of size n
obeys in the limit a Gaussian law. The local expansion of ρ(u),
ρ(u) ≡log(1 + u−1) = log 2 −1
2(u −1) + 3
8(u −1)2 + · · · ,
yields
ρ(1)
ρ(u) = 1 +
1
2 log 2 (u −1) −3 ln(2) −2
8(log 2)2 (u −1)2 + O
`
(u −1)3´
,
so that the mean and standard deviation satisfy
µn ∼C1n,
σn ∼
√
C2 n,
C1 :=
1
2 log 2,
C2 := 1 −log 2
4(log 2)2 .
In particular, the variability condition is satisﬁed. Finally, one obtains, with Φ the Gaussian
error function,
P{Xn ≤C1n + x
√
C2n} = Φ(x) + O
„ 1
√n
«
.
This estimate can alternatively be viewed as a purely asymptotic statement regarding Stirling
partition numbers.
Proposition IX.7. The surjection distribution deﬁned as
1
Sn
˘n
k
¯
, with Sn = P
k k!
˘n
k
¯
the
normalizing factor (the surjection number), satisﬁes uniformly for all real x,
1
Sn
X
k≤C1n+x√C2n
k!
(
n
k
)
=
1
√
2π
Z x
−∞
e−w2/2 dw + O
„ 1
√n
«
.
This result already appears in Bender’s foundational study [28], . END OF EXAMPLE IX.8. □
The following analytic schema vastly generalizes the case of surjections. It is
again strongly inspired by the works of Bender [28].
Theorem IX.8 (Meromorphic schema). Let F(z, u) be a bivariate function that is
bivariate analytic at (z, u) = (0, 0) and has nonnegative coefﬁcients there. Assume
that F(z, 1) is meromorphic in z ≤r with only a simple pole at z = ρ for some
positive ρ < r. Assume also the following conditions.
(i) Meromorphic perturbation: there exists ǫ > 0 and r > ρ such that in the
domain, D = {|z| ≤r} × {|u −1| < ǫ} , the function F(z, u) admits the
representation
F(z, u) = B(z, u)
C(z, u),
where B(z, u), C(z, u) are analytic for (z, u) ∈D with B(ρ, 1) ̸= 0. (Thus
ρ is a simple zero of C(z, 1).)
(ii) Nondegeneracy: one has ∂zC(ρ, 1) · ∂uC(ρ, 1) ̸= 0, ensuring the existence
of a nonconstant ρ(u) analytic at u = 1, such that C(ρ(u), u) = and ρ(1) =
ρ.

IX. 6. PERTURBATION OF MEROMORPHIC ASYMPTOTICS
607
(iii) Variability: one has
v
 ρ
ρ(u)

̸= 0.
Then, the random variable with probability generating function
pn(u) = [zn]F(z, u)
[zn]F(z, 1)
converges in distribution to a Gaussian variable with a speed of convergence that is
O(n−1/2). The mean and the standard deviation of Xn are asymptotically linear in n.
First we offer a few comments. Given the analytic solution ρ(u) of the implicit
equation C(ρ(u), u) = 0, the PGF E(uXn) satisﬁes a quasi-powers approximation of
the form A(u)(ρ(1)/ρ(u))n, as we prove below. The mean µn and variance σ2
n are
then of the form
(25)
µn = m
 ρ(1)
ρ(u)

n + O(1),
σ2
n = v
 ρ(1)
ρ(u)

n + O(1).
The variability condition of the Quasi-Powers Theorem is precisely ensured by condi-
tion (iii). Set
ci,j :=
∂i+j
∂zi∂uj C(z, u)

(ρ,1)
.
The numerical coefﬁcients in (25) can themselves be solely expressed in terms of
partial derivatives of C(z, u) by series reversion,
(26)
ρ(u) = ρ −c0,1
c1,0
(u −1) −c2
1,0c0,2 −2c1,0c1,1c0,1 + c2,0c2
0,1
2c3
1,0
(u −1)2 + O((u −1)3).
In particular the fact that ρ(u) is nonconstant, analytic, and a simple root corresponds
to c0,1c1,0 ̸= 0 (by the analytic Implicit Function Theorem). The variance condition
is then computed to be equivalent to the cubic inequality in the ci,j:
(27)
ρ c1,0
2c0,2 −ρ c1,0c1,1c0,1 + ρ c2,0c0,1
2 + c0,1
2c1,0 + c0,1c1,0
2ρ ̸= 0.
PROOF. We can now proceed with asymptotic estimates. Consider a domain |u−1| ≤
δ inside the region of analyticity of B, C. Then, one has
fn(u) := [zn]F(z, u) =
1
2iπ
I
F(z, u) dz
zn+1 ,
where the integral is taken along a small enough contour encircling the origin. We
use the analysis of polar singularities described in Chapter IV, exactly like in (24). As
F(z, u) has at most one (simple) pole in |z| ≤r, we have
(28)
fn(u) = Res
B(z, u)
C(z, u)z−n−1

z=ρ(u)
+
1
2iπ
Z
|z|=r
F(z, u) dz
zn+1 ,
where we may assume u suitably restricted by |u −1| < δ in such a way that |r −
ρ(u)| < 1
2(r −ρ).

608
IX. MULTIVARIATE ASYMPTOTICS
The modulus of the second term in (28) is bounded from above by
(29)
K
rn
where
K =
sup|z|=r,|u−1|≤δ |B(z, u)|
inf|z|=r,|u−1|≤δ |C(z, u)| .
Since the domain |z| = r, |u −1| ≤δ is closed, C(z, u) attains its minimum that must
be nonzero, given the unicity of the zero of C. At the same time, B(z, u) being
analytic, its modulus is bounded from above. Thus, the constant K in (29) is ﬁnite.
A residue computation of the ﬁrst term, in accordance with the analysis of mero-
morphic functions, then yields
fn(u) = B(ρ(u), u)
C′(ρ(u), u)ρ(u)−n−1 + O(r−n),
uniformly for u in a small enough ﬁxed neighbourhood of 1. The mean and variance
then satisfy (25), with the coefﬁcient in the leading term of the variance term that is,
by assumption, nonzero. Thus, the conditions of the Quasi-Powers Theorem in the
form (19) are satisﬁed, and the law is Gaussian in the asymptotic limit.
□
Some form of condition regarding nondegeneracy is a necessity. For instance, the
functions
1
1 −z ,
1
1 −zu,
1
1 −zu2 ,
1
1 −z2u,
each fail to satisfy the nondegeneracy and the variability condition, and the variance
of the corresponding discrete distribution is identically 0. The combinatorial variance
is O(1) for a related function like
F(z, u) =
1
1 −z(u + 2) + 2z2u =
1
(1 −2z)(1 −zu),
which is excluded by the variability condition of the theorem—there a discrete limit
law, a geometric, is known to hold; see page 572. Yet another situation arises when
considering
F(z, u) =
1
(1 −z)(1 −zu).
There is now a double pole at 1 when u = 1 that arises from “conﬂuence” at u = 1 of
two analytic branches ρ1(u) = 1 and ρ2(u) = 1/u. In this particular case, the limit
law is continuous but non-Gaussian; in fact, this limit is the uniform distribution over
the interval [0, 1], since
F(z, u) = 1 + z(1 + u) + z2(1 + u + u2) + z3(1 + u + u2 + u3) + · · · .
In addition, for this case, the mean is O(n) but the variance is O(n2). Such situations
are brieﬂy examined in Section IX. 11 at the end of this Chapter.
 IX.19. Higher order poles. Under the conditions of Theorem IX.8, a limit Gaussian law holds
for the distributions generated by the BGF F(z, u)m, which has an mth order pole. See [28].

EXAMPLE IX.9.
The Central Limit Theorem and discrete renewal theory. Let g(u) be any
PGF (g(1) = 1) of a random variable supported by Z≥0 that is analytic at 1 and nondegenerate
(i.e., v(g) > 0). Then
F(z, u) =
1
1 −zg(u)

IX. 6. PERTURBATION OF MEROMORPHIC ASYMPTOTICS
609
has a singularity at 1/g(u) that is a simple pole,
ρ(u) =
1
g(u).
Theorem IX.8 then applies to give a weak form of the central limit theorem for discrete prob-
ability distributions with PGFs that are analytic at 1. (In such a case, a reﬁned Gaussian con-
vergence property—a local limit law, see Chapter VIII and Section IX. 9 below—also derives
from the saddle point method.)
Under the same analytic assumptions on g, consider now the “dual” BGF,
G(z, u) =
1
1 −ug(z),
where the rˆoles of z and u have been interchanged. In addition, we must impose for consis-
tency that g(0) = 0. There is a simple probabilistic interpretation in terms of renewal processes
of classical probability theory. Assume a light bulb has a lifetime of m days with probabil-
ity gm = [zm]g(z) and is replaced as soon as it ceases to function. Let Xn be the number
of light bulbs consumed in n days assuming independence, conditioned upon the fact that a
replacement takes place on the nth day. Then the PGF of Xn is [zn]G(z, u)/[zn]G(z, 1).
(The normalizing quantity [zn]G(z, 1) is precisely the probability that a renewal takes place on
day n.) Theorem IX.8 applies. The function G has a simple dominant pole at z = ρ(u) such
that g(ρ(u)) = 1/u, with ρ(1) = 1 since g is by asumption a PGF. One ﬁnds
1
ρ(u) = 1 +
1
g′(1)(u −1) + 1
2
g′′(1) + 2g′(1) −2g′(1)2
g′(1)3
(u −1)2 + · · · .
Thus the limit distribution of Xn is normal with mean and variance satisfying
E(Xn) ∼n
µ,
V(Xn) ∼nσ2
µ3 ,
where µ := m(g) and σ2 := v(g) are the mean and variance attached to g. (This calcula-
tion checks the variability condition en passant.) The mean value result certainly conforms to
probabilistic intuition. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE IX.9. □
 IX.20. Renewals every day. In the renewal scenario, no longer condition on the fact that a
bulb breaks down on day n. Let Yn be the number of bulbs consumed so far. Then the BGF of
Yn is found by expressing that there is a sequence of renewals followed by a last renewal that is
to be credited to all intermediate epochs:
X
n≥1
E(uY
n )zn =
1
1 −ug(z)
g(u) −g(zu)
1 −z
.
A Gaussian limit also holds for Yn.

 IX.21. A mixed CLT–renewal scenario. Consider G(z, u) = 1/(1 −g(z, u)) where g has
nonnegative coefﬁcients, satisﬁes g(1, 1) = 1, and is analytic at (z, u) = (1, 1). This models
the situation where bulbs are replaced but a random cost is incurred, depending on the duration
of the bulb. Under general conditions, a limit law holds and it is Gaussian. This applies for
instance to H(z, u) = 1/(1 −a(z)b(u)), where a and b are nondegenerate PGFs (a random
repairman is called).

The preceding discussion of renewal processes also brings us extremely close
analytically to a sequence schema F = S(G) and
F(z, u) =
1
1 −ug(z),

610
IX. MULTIVARIATE ASYMPTOTICS
0.7
0.6
0.5
0.4
0.3
4
0.2
0.1
2
5
0
3
1
0
0.5
0.4
5
0.3
4
3
0.2
2
1
0.1
0
0
0
0.2
0.1
0
5
4
0.4
3
2
1
0.3
FIGURE IX.8.
When components are sorted by size and represented by vertical
segment of corresponding length, supercritical sequences present various proﬁles
described by Proposition IX.8. The diagrams display the mean proﬁles of large
surjections, alignments, and compositions for component sizes ≤5.
in the case where the schema is critical. It is then possible to reﬁne the moment
estinmates of Chapter V and obtain the probabilistic proﬁle of supercritical sequences.
Proposition IX.8 (Supercritical sequences). Consider a sequence schema that is su-
percritical, i.e., the value of g at its dominant positive singularity satisﬁes τg > 1.
Assuming g to be aperiodic and g(0) = 0, the number Xn of G–components in a
random Fn structure of some large size n is asymptotically Gaussian with
E(Xn) ∼
n
g′(σ),
V(Xn) ∼ng′′(σ) + g′(σ) −g′(σ)2
g′(σ)3
,
where σ is the radius of convergence of g.
The number X(m)
n
of components
of some ﬁxed size m is asymptotically normal with mean ∼θmn, where θm =
gmσm/(σg′(σ)).
PROOF. The ﬁrst part is a direct consequence of Theorem IX.8 and of the previous
calculations with ρ replacing 1. The second part results from the BGF
1
1 −(u −1)gmzm −g(z),
and from the fact that u = 1 induces a smooth perturbation of the pole at ρ corre-
sponding to u = 1.
□
This proposition aplies to alignments, surjections, compositions of various
sorts—including compositions into prime summands. The proﬁle of supercritical se-
quences is then appreciably different from what was obtained in the subcritical case,
where discrete limit laws prevail. Fundamentally, the proportion of ﬁxed size com-
ponents is close to θm, up to Gaussian ﬂuctuations. The diagrams of Chapter V and
Figure 8 clearly illustrate this situation.

IX. 6. PERTURBATION OF MEROMORPHIC ASYMPTOTICS
611
 IX.22. Alignments and Stirling cycle numbers. Alignments are sequences of cycles (Chap-
ter II), corresponding to S(C≥1(Z)), with exponential BGF
F(z, u) =
1
1 −u log(1 −z)−1 .
The function ρ(u) is explicit, ρ(u) = 1 −e−1/u, and the number of cycles in a random align-
ment is asymptotically Gaussian. This yields an asymptotic statement on Stirling cycle num-
bers: Uniformly for all real x, with On = P
k k!
ˆn
k
˜
the alignment number, there holds
1
On
X
k≤C1n+x√C2n
k!
"
n
k
#
=
1
√
2π
Z x
−∞
e−w2/2 dw + O
„ 1
√n
«
,
where the two constants C1, C2 are C1 =
1
e −1, C2 =
1
(e −1)2 .

 IX.23. Summands in constrained integer compositions. Consider integer compositions where
the summands are constrained to belong to a set Γ ⊆N+, and let Xn be the number of sum-
mands in a random composition of integer n. The ordinary BGF is
F(z, u) =
1
1 −ug(z),
g(z) =
X
γ∈Γ
zγ.
Assume that Γ contains at least two relatively prime elements, so that g(z) is aperiodic. The
radius of convergence of g(z) can only be ∞(when g(z) is a polynomial) or 1 (when g(z)
comprises inﬁnitely many terms but is dominated by (1−z)−1). At any rate, the sequence con-
struction is supercritical, so that the distribution of Xn is asymptotically normal. For instance, a
Gaussian limit holds for compositions into prime or even twin-prime summands of Chapter V.

The next two examples are relative to runs in permutations and patterns in words.
They do not resort to a supercritical sequence but their analytic structure is very much
similar. It is of interest to note that the BGFs were each deduced in Chapter III by an
inclusion-exclusion argument that involves sequences in an essential way.
EXAMPLE IX.10.
Ascending runs in permutations and Eulerian numbers. The exponential
BGF of Eulerian numbers (that count runs in permutations) is
F(z, u) =
u(1 −u)
e(u−1)z −u,
where, for u = 1, we have F(z, 1) = (1 −z)−1. The roots of the denominator are then
ρk(u) := ρ(u) + 2ikπ
u −1,
ρ(u) = log u
u −1,
where k is an arbitrary element of Z. As u is close to 1, ρ(u) is close to 1, while the other
poles ρk(u) with k ̸= 0 escape to inﬁnity. This fact is also consistent with the limit form
F(z, 1) = (1 −z)−1 which has only one pole at 1. If one restricts u to |u| ≤2, there is clearly
at most one root of the denominator in |z| ≤2 that is given by ρ(u). Thus, we have for u close
enough to 1,
F(z, u) =
1
ρ(u) −z + R(z, u),
with R(z, u) analytic in |z| ≤2, and
[zn]F(z, u) = ρ(u)−n−1 + O(2−n).

612
IX. MULTIVARIATE ASYMPTOTICS
-2
-1
0
1
2
y
-2
-1
1
2
x
FIGURE IX.9.
The diagrams of poles of the BGF F(z, u) associated to the
pattern abaa with correlation polynomial c(z) = 1+z3 when u varies on the unit
circle. The denominator is of degree 4 in z: one branch, ρ(u) clusters near the
dominant singularity ρ = 1
2 of F(z, 1) while three other singularities stay away
from the disc |z| ≤1
2 and escape to inﬁnity as u →1.
The variability conditions are satisﬁed since
ρ(u) =
log u
(u −1) = 1 −1
2(u −1) + 1
3(u −1)2 + · · · ,
so that v(1/ρ(u)) =
1
12 is nonzero.
Proposition IX.9. The Eulerian distribution is asymptotically Gaussian, with mean and vari-
ance given by µn = n+1
2 , σ2
n = n+1
12 .
This example is a famous one and our derivation follows Bender’s paper [28]. The Gauss-
ian character of the distribution has been known for a long time; it is for instance to be found in
David and Barton’s Combinatorial Chance [108] published in 1962. There are in this case inter-
esting connections with elementary probability theory: if Uj are independent random variables
that are uniformly distributed over the interval [0, 1], then one has
[znuk]F(z, u) = P{⌊U1 + · · · + Un⌋< k}.
Because of this fact, the normal limit is thus often derived a consequence of the central limit
theorem of probability theory, after one takes care of unimportant details relative to the integer
part ⌊·⌋function; see [108, 422]. . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE IX.10. □
EXAMPLE IX.11.
Patterns in strings. Consider the class F of binary strings (the “texts”),
and ﬁx a “pattern” w of length k. Let χ be the number of (possibly overlapping) occurrences
of w. (The pattern w occurs if it is a factor, i.e., if its letters occur contiguously in the text.) Let

IX. 6. PERTURBATION OF MEROMORPHIC ASYMPTOTICS
613
F(z, u) be the BGF relative to the pair (F, χ). The Guibas-Odlyzko correlation polynomial5
c(z) ≡cw(z) relative to w is deﬁned for instance in [434], where it is shown that the OGF of
words with pattern w excluded is
F(z, 0) =
c(z)
zk + (1 −2z)c(z).
By similar string decompositions, the full BGF is found to be [192, p. 145]
F(z, u) =
1 −(c(z) −1)(u −1)
1 −2z −(u −1)(zk + (1 −2z)(c(z) −1)).
Let D(z, u) be the denominator. Then D(z, u) depends analytically on z, for u near 1 and
z near 1/2. In addition, the partial derivative D′
z( 1
2, 1) is nonzero. Thus, ρ(u) is analytic
at u = 1, with ρ(1) = 1/2. The local expansion of the root ρ(u) of D(ρ(u), u) follows from
local series reversion,
2ρ(u) = (1 −2−k(u −1) + (k2−2k −2−kc(1
2)) (u −1)2 + O((u −1)3).
Theorem IX.8 applies.
Proposition IX.10. The number of occurrences of a ﬁxed pattern in a random large string is
asymptotically normal. The number of occurrences has mean and variance σ2
n that satisfy
n
2k + O(1),
σ2
n =
„
2−k(1 + 2c(1
2)) + 2−2k(1 −2k)
«
n + O(1).
The mean does not depend on the order of letters, only on the length of the pattern.
END OF EXAMPLE IX.11. □
 IX.24. Patterns in Bernoulli texts. Asymptotic normality also holds when letters in strings
are chosen independently but with an arbitrary probability distribution. It sufﬁces to use the
weighted correlation polynomial described in a note of Chapter III.

EXAMPLE IX.12.
Parallelogram polyominoes. Polyominoes are plane diagrams that are
closely related to models of statistical physics, while having been the subject of a vast com-
binatorial literature. This example has the merit of illustrating a level of difﬁculty somewhat
higher than in previous examples and typical of many “real–life” applications. Our presentation
follows an early article of [30] and a more recent paper of Louchard [342]. We consider here
the variety of polyominoes called parallelograms. A parallelogram is a sequence of segments,
[a1, b1], [a2, b2], . . . , [am, bm],
a1 ≤a2 · · · ≤am, b1 ≤b2 ≤· · · ≤bm,
where the aj and bj are integers with bj −aj ≥1, and one takes a1 = 0 for deﬁniteness. A
parallelogram can thus be viewed as a stack of segments (with [aj+1, bj+1] placed on top of
[aj, bj]) that leans smoothly to the right:
5The correlation polynomial, as deﬁned in Chapter I, has coefﬁcients in {0, 1}, with [zj]c(z) = 1 iff
w matches its left shifted image by j positions.

614
IX. MULTIVARIATE ASYMPTOTICS
(This instance has area 39, width 13, height 9, and perimeter 13 + 9 = 22.)
The quantity m is called the height, the quantity bm −a1 the width, their sum is called
the (semi)perimeter, and the grand total P
j(bj −aj) is called the area. We examine paral-
lelograms of ﬁxed area and investigate the distribution of the perimeter. The ordinary BGF of
parallelograms, with z marking area and u marking perimeter turns out to be
(30)
F(z, u) = uJ1(z, u)
J0(z, u),
where J0, J1 belong to the realm of “q–analogues” and generalize the classical Bessel functions,
J0(q, u) :=
X
n≥0
(−1)nunqn(n+1)/2
(q; q)n(uq; q)n
,
J1(q, u) :=
X
n≥1
(−1)n−1unqn(n+1)/2
(q; q)n−1(uq; q)n
,
with the “q–factorial” notation being used:
(a; q)n = (1 −a)(1 −aq) · · · (1 −aqn−1).
The expression (30) of the BGF results from a simple construction: a parallelogram is
either an interval, or it is derived from an existing parallelogram by stacking on top a new
interval. Let G(w) ≡G(x, y, z, w) be the OGF with x, y, z, w marking width, height, area,
and length of top segment, respectively. The GF of a parallelogram made of a single nonzero
interval is
a(w) ≡a(x, y, z, w) =
xyzw
1 −xzw .
The operation of piling up a new segment on top of a segment of length m that is represented
by a term wm is described by
y
„ zmwm
1 −xzw + · · · +
zw
1 −xzw
«
= xyzw
1 −xmwm
(1 −zw)(1 −xzw).
Thus, G satisﬁes the functional equation,
(31)
G(w) =
xyzw
1 −xzw +
xyzw
(1 −zw)(1 −xzw) [G(1) −G(xzw)] .
This is the method of “adding a slice” already employed in Chapter III. and reﬂected by the
relation (31). Now, an equation of the form,
G(w) = a(w) + b(w)[G(1) −G(λw)],
is solved by iteration:
G(w)
=
a(w) + b(w)G(1) −b(w)G(λ(w))
=
`
a(w) −b(w)a(λw) + b(w)b(λw)a(λ2w) −· · ·
´
+G(1)
`
b(w) −b(w)b(λw) + b(w)b(λw)b(λ2w) −· · ·
´
.
One then isolates G(1) by setting w = 1. This expresses G(1) as the quotient of two similar
looking series (formed with sums of products of b–values). Here, this gives G(x, y, z, 1), from
which the form (30) of F(z, u) derives, since F(z, u) = G(u, u, z, 1).
In such a seemingly difﬁcult situation, one should ﬁrst estimate [zn]F(z, 1), the number
of parallelogram of “size” (i.e., area) equal to n. We have F(z, 1) = J1(z, 1)/J0(z, 1), where
the denominator is
J0(z, 1) = 1 −
z
(1 −z)2 +
z3
(1 −z)2(1 −z2)2 −
z6
(1 −z)2(1 −z2)2(1 −z3)2 + · · · .
Clearly, J0(z, 1) and J1(z, 1) are analytic in |z| < 1, and it is not hard to see that J0(z, 1)
decreases from 1 to about −0.24 when z varies between 0 and 1
2, with a root at
ρ .= 0.43306 19231 29252,

IX. 6. PERTURBATION OF MEROMORPHIC ASYMPTOTICS
615
where J′
0(ρ, 1) .= −3.76 ̸= 0, so that the zero is simple6. Since F(z, 1) is by construction
meromorphic in the unit disc, and J1(ρ, 1) .= 0.48 ̸= 0, the number of parallelograms satisﬁes
[zn]F(z, 1) ∼J1(ρ, 1)
ρJ′
0(ρ, 1)
„1
ρ
«n
= α1 · αn
2 ,
where
α1 .= 0.29745 35058 07786,
α2 .= 2.30913 85933 31230.
As is common in meromorphic analyses, the approximation of coefﬁcients is quite good; for
instance, the relative error is only about 10−8 for n = 35.
We are now ready for bivariate asymptotics. Take |z| ≤r =
7
10 and |u| ≤11
10. Because
of the form of their general terms that involve zn2/2un in the numerators while the denomi-
nators stay bounded away from 0, the functions J0(z, u) and J1(z, u) remain analytic there.
Thus, ρ(u) exists and is analytic for u in a sufﬁciently small neighbourhood of 1 (by Weier-
strass preparation or implicit functions). The nondegeneracy conditions are easily veriﬁed by
numerical computations. There results that Theorem IX.8 applies.
Proposition IX.11. The perimeter of a random parallelogram polyomino of area n admits a
limit law that is Gaussian with mean and variance that satisfy: µn ∼µn, σn ∼σ√n, with
µ .= 0.84176 20156,
σ .= 0.42420 65326.
This indicates that a random parallelogram is most likely to resemble a slanted stack of
fairly short segments. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE IX.12. □
 IX.25. Width and height of parallelogram polyominoes are normal. Similar perturbation
methods show that the expected height and width are each O(n) on average, again with Gauss-
ian limits.

 IX.26. The base of a coin fountain. A coin fountain (Chapter IV) is deﬁned as a vector
v = (v0, v1, . . . , vℓ), such that v0 = 0, vj ≥0 is an integer, vℓ= 0 and |vj+1 −vj| = 1. Take
as size the area, n = P vj. Then the distribution of the base length ℓin a random coin fountain
of size n is asymptotically normal. (This amounts to considering all ruin sequences of a ﬁxed
area as equally likely, and considering the number of steps in the game as a random variable.)
Similarly the number of vector entries equal to 0 is asymptotically Gaussian.

Perturbation of systems of linear equations. There is usually a fairly transparent
approach to the analysis of BGFs deﬁned implicitly as solutions of functional equa-
tions. One should start with the analysis at u = 1 and then examine the effect on
singularities when u varies in a very small neighbourhood of 1. In accordance with
what we have already seen many times, the process is a perturbation analysis of the
solution to a functional equation near a singularity, here one that moves.
We illustrate, mostly by way of examples, the application of Theorem to functions
deﬁned implicitly by a linear system of positive equations. Positive rational functions
arise in connection with problems that can be equivalently described by ﬁnite state
devices, by paths in graphs, and by Markov chains. The bivariate problem is then
expressed by a linear equation
(32)
Y (z, u) = V (z, u) + T (z, u) · Y (z, u),
6As usual, such computations can be easily validated by carefully controlled numerical evaluations
coupled with Rouch´e’s theorem (see Chapter IV).

616
IX. MULTIVARIATE ASYMPTOTICS
where T (z, u) is an m × m matrix with polynomial entries in z, u having nonnegative
coefﬁcients, Y (z, u) is an m×1 column vector of unknowns, and V (z, u) is a column
vector of nonnegative initial conditions.
Regarding the univariate problem,
(33)
Y (z) = V (z) + T (z) · Y (z).
, where Y (z) = Y (z, 1) and so on, we place ourselves under the assumptions of
Corollary V.1 of Chapter V. This means that properness, positivity, irreducibility, and
aperiodicity are assumed throughout. In this case (see the developments of Chapter V),
Perron-Frobenius theory applies to the univariate matrix T (z). In other words, the
function
C(z) = det(I −T (z))
has a unique dominant root ρ > 0 that is a simple zero. Accordingly, any component
F(z) = Yi(z) of a solution to the system (32) has a unique dominant singularity
at z = ρ that is a simple pole,
F(z) = B(z)
C(z),
with B(ρ) ̸= 0.
In the bivariate case, each component of the solution to the system (32) can be
put under the form
F(z, u) = B(z, u)
C(z, u),
C(z, u) = det(I −T (z, u)).
Since B(z, u) is a polynomial, it does not vanish for (z, u) in a sufﬁciently small
neighbourhood of (ρ, 1). Similarly, by the analytic Implicit Function Theorem, there
exists a function ρ(u) locally analytic near u = 1, such that
C(ρ(u), u) = 0,
ρ(1) = ρ.
Thus, it is sufﬁcient that the variability conditions (26) be satisﬁed to infer a limit
Gaussian distribution.
Theorem IX.9 (Positive rational systems). Let F(z, u) be a bivariate function that
is analytic at (0, 0) and has nonnegative coefﬁcients. Assume that F(z, u) coincides
with the component Y1 of a system of linear equations in Y = (Y1, . . . , Ym)T ,
Y = V + T · Y,
where V = (V1(z, u), . . . , Vm(z, u)), T = (Ti,j(z, u))m
i,j=1, and each of Vj, Ti,j
is a polynomial in z, u with nonnegative coefﬁcients. Assume also that T (z, 1) is
transitive, proper, and primitive, and let ρ(u) be the unique solution of
det(I −T (ρ(u), u)) = 0,
assumed to be analytic at 1, such that ρ(1) = ρ. Then, provided the variability condi-
tion,
v
 ρ(1)
ρ(u)

> 0,
is satisﬁed, a Gaussian Limit Law holds for the coefﬁcients of F(z, u) with mean and
variance that are O(n) and speed of convergence that is O(n−1/2).

IX. 6. PERTURBATION OF MEROMORPHIC ASYMPTOTICS
617
The constants µ, σ involved in estimates of the mean and standard deviation,
µn ∼µn, σn ∼σ√n, are then determined from C(z, u) = det(I −T (z, u)) by
Eq. (26). Thus, in any particular application, one can determine by computation
whether the variability condition is satisﬁed. It may be however more difﬁcult to
check these conditions for a whole classes of problems.
EXAMPLE IX.13.
Limit theorem for Markov chains. Assume that M is the transition matrix
of an irreducible aperiodic Markov chain, and consider the parameter χ that records the number
of passages through state 1 in a path of length n that starts in state 1. Then, the theorem applies
with
V = (1, 0, . . . , 0)T , Ti,j(z, u) = zMi,j + z(u −1)Mi,0δj,0.
We therefore derive a classical limit theorem for Markov chains:
Proposition IX.12. In an irreducible and aperiodic (ﬁnite) Markov chain, the number of times
that a designated state is reached when n transitions are effected is asymptotically Gaussian.
The conclusion also applies to paths in any strongly connected aperiodic digraph as well
as to paths conditioned by their source and/or destination. . . . . . END OF EXAMPLE IX.13. □
 IX.27. Sets of patterns in words. This note extends Example 11 relative to the occurrence of
a single pattern in a random text. Given the class W = S(A) of words over a ﬁnite alphabet A,
ﬁx a ﬁnite set of “patterns” S ⊂W and deﬁne the parameter χ(w) as the total number of
occurrences of members of S in the word w ∈W. It is possible to build ﬁnite automaton
(essentially a digital tree built on S equipped with return edges) that records simultaneously the
number of partial occurrences of each pattern. Then, the limit law of χ is Gaussian; see Bender
and Kochman’s paper [35] and [189, 192] for an approach based on the de Bruin graph.

Virtually all of the combinatorial classes that resort to transfer matrix methods
exposed in Chapter V lead to Gaussian laws in the asymptotic limit.
EXAMPLE IX.14.
Tilings. (See Bender [37].) Take an (2 × n) chessboard of 2 rows and n
columns, and consider coverings with “monomer tiles” that are (1×1)-pieces, and “dimer tiles”
that are either of the horizontal (1×2) or vertical (2×1) type. The parameter of interest is here
the number of tiles. Consider next the collection of all “partial coverings” in which each column
is covered exactly, except possibly for the last one. The partial coverings are of one of 4 types
and the legal transitions are described by a compatibility graph. For instance, if the previous
column started with one horizontal dimer and contained one monomer, the current column has
one occupied cell, and one free cell that may then be occupied either by a monomer or a dimer.
This ﬁnite state description corresponds to a set of linear equations over BGFs (with z marking
the area covered and u marking the total number of tiles), with the transition matrix found to be
T(z, u) = z
0
B
B
@
u
u2
u2
u2
1
0
0
0
u
0
0
0
u
0
0
0
1
C
C
A .
In particular, we have
det(I −T(z, u)) = 1 −zu −z2(u2 + u3).
Then, Theorem IX.9 applies: the number of tiles is asymptotically normal. The method clearly
extends to (k × n) chessboards, for any ﬁxed k. . . . . . . . . . . . . . END OF EXAMPLE IX.14. □
 IX.28. Succession-constrained integer compositions. Consider integer compositions where
consecutive summands add up to at least 4. The number of summands in such a composition of
large size is asymptotically normal. [Hint: see Bender and Richmond [37]]


618
IX. MULTIVARIATE ASYMPTOTICS
 IX.29. Height in trees of bounded width. Consider general Catalan trees of width less than a
ﬁxed bound w. (The width is the maximum number of nodes at any level in the tree.) In such
trees, the distribution of height is asymptotically Gaussian.

IX. 7. Perturbation of singularity analysis asymptotics
In this section, we examine schemes that arises when generating functions con-
tain algebraic-logarithmic singularities. For instance, trees often lead to singularities
that are of the square-root type and such a singular behaviour persists for a num-
ber of bivariate generating functions associated to aditively inherited parameters. In
such cases, the underlying machinery is the method of singularity analysis detailed in
Chapter VI, on which suitable perturbative developments are applied.
An especially important feature of the method of singularity analysis and of the
associated Hankel contours is the fact that it preserves uniformity of expansions7.
This feature is crucial in translating bivariate expansion, where we need to estimate
uniformly a coefﬁcient fn(u) = [zn]F(z, u) that depends on the parameter u, given
some (uniform) knowledge on the singular structure of F(z, u) in terms of z. We state
here an easy but crucial lemma that takes care of remainder terms in expansions and
hence enables the use of singularity analysis in a perturbed context.
Lemma IX.2 (Uniformity lemma, singularity analysis). Let fu(z) be a family of func-
tions analytic in a common ∆-domain ∆, with u a parameter taken in a bounded set U.
Suppose that there holds
|fu(z)| < K(u)|1 −z|−α(u),
where K(u) is uniformly bounded, K(u) < K for u ∈U, and α(u) is such that
−ℜ(α(u) > B for some ﬁnite real B. Then, there exists a constant eK (computable
from ∆, K, B such that
|[zn]fu(z)| < eKnB−1.
PROOF. It sufﬁces to revisit the proof of the Big-Oh transfer (O-transfer) theorem
of Chapter VI, paying due attention to uniformity. The proof proceeds by Cauchy’s
formula,
fu, n ≡[zn]fu(z) =
1
2iπ
Z
γfu(z)
dz
zn+1 ,
where γ = ∪jγj is the contour used earlier. Accordingly, we let f (j)
u,n be the contribu-
tion in Cauchy’s integral arising from part γj of the contour. Let r be the radius of the
circular part of the contour, corresponding in earlier notations to γ3. Without loss of
generality, we may assume |r −1| < 1. Trivial bounds imply when B > 0 that that
|f (3)
u,n| ≤
K
(r −1)B+1 r−n,
7For instance, Darboux’s method only provides non-constructive error terms, as it is based on the
Riemann-Lebesgue lemma; it cannot be employed for bivariate asymptotics. A similar comment applies to
most Tauberian theorems.

IX. 7. PERTURBATION OF SINGULARITY ANALYSIS ASYMPTOTICS
619
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
0.1
0.15
0.2
0.25
0.3
0.35
FIGURE IX.10.
A display of the family of GF’s F(z, u0) corresponding to
leaves in general Catalan trees when u0 ∈[ 1
2, 3
2]. It is seen that the singularities
are all of the square root type (dashed line), with a movable singularity at eρ(u) =
(1 + u1/2)−2.
with an analogous formula if B < 0. The part γ1 corresponding to the small circular
arc at distance 1/n from 1 is similarly dealt with by trivial bounds to the effect that
|f (1)
u,n| ≤KnB−1.
The two conjugate rectlinear parts corresponding to γ2, γ4 each lead to
|fu,n(2)| = |f (4)
u,n| ≤K
2πJnnB−1,
Jn :=
Z ∞
1
t−B

1 + 1
nt cos θ
n
.
Combining the four majorizations yields the result.
□What this lemma expresses
is more general than the meromorphic scheme; only the error terms in estimates of
PGFs tend to be naturally less good as we replace an exponentially small error term
inherent to meromorphic functions by a term that is usually O(n−β) in the context of
singularity analysis. (Note that the proof above also supplies the uniformity estimates
needed in the proof of the little-oh transfer (o-transfer) of Chapter VI.)
 IX.30. Uniformity in the presence of lagarithmic multipliers. Similar estimates hold when
f(z) is multiplied by a power of L(z) = −log(1 −z).

EXAMPLE IX.15. Leaves in general Catalan trees. As an introductory example, let us brieﬂy
revisit the analysis of the number of leaves in general Catalan trees, a problem already treated
in Chapter III. where an explicit expression (a product of two binomial coefﬁcients) has been

620
IX. MULTIVARIATE ASYMPTOTICS
derived. The computations are a little simpler if we adopt as BGF
G(z, u) = F(z, u2) = 1
2
“
1 + (u2 −1)z −
p
1 −2(u2 + 1)z + (u2 −1)2z2
”
,
so that we consider a parameter equal to twice the number of leaves. In this case, the discrimi-
nant factors nicely:
1 −2(u2 + 1)z + (u2 −1)2z2 = (1 −z(1 + u)2)(1 −z(1 −u)2),
which leads to the expression
(34)
G(z, u) = A(z, u) + B(z, u)
p
C(z, u),
with
A(z, u) = 1
2(1 + (u2 −1)z),
B(z, u) = −1
2
p
1 −z(1 −u)2,
C(z, u) = 1
2
`
1 −z(1 + u)2´
.
This decomposition clearly shows that, when u is close enough to 1, the function G(z, u) has a
dominant singularity of the square-root type at
ρ(u) =
1
(1 + u)2 .
At the same time, if u is kept such that |1 −u| ≤1
2, then B(z, u) remains analytic in both of
its arguments for |z| < 2. For any such ﬁxed u, we have for the BGF, by (34),
(35) G(z, u) = a0(u) + b(u)
p
1 −z/ρ(u) + a1(u)(1 −z/ρ(u)) + O((1 −z/ρ(u))3/2),
for some computable coefﬁcients a0, a1, b, c that depend on u and are in fact analytic in u near
u = 1. Singularity analysis then provides, pointwise for each u,
(36)
[zn]G(z, u) = −2
√π B(ρ(u), u) ρ(u)−nn−3/2
„
1 + O( 1
n)
«
.
The expansion (35) is uniform when u lies in a sufﬁciently small complex neighbourhood of 1.
It can be seen (details below) that the expansion of the coefﬁcient in (36) is also uniform by
virtue of of the general uniformity preserving property of the singularity analysis process,
as expressed by Lemma IX.2.
We are thus exactly in a case of application of the Quasi-
Powers Theorem, so that the limit law for the number of leaves is asymptotically Gaussian.
END OF EXAMPLE IX.15. □
IX. 7.1. General algebraic-logarithmic conditions. The example of leaves in
tres leads to simple computations, but is is characteristic of the machinery needed in
more general cases. The theorem that follows is relative to any singular exponent α
not in Z≤0.
Theorem IX.10 (Algebraic singularity schema). Let F(z, u) be a bivariate function
that is bivariate analytic at (z, u) = (0, 0) and has nonnegative coefﬁcients there.
Assume the following conditions:
(i) Algebraic perturbation: there exist three functions A, B, C, analytic in a
domain D = {|z| ≤r} × {|u −1| < ǫ}, for some r > 0 and ǫ > 0, such
that the following representation holds,
(37)
F(z, u) = A(z, u) + B(z, u)C(z, u)−α,

IX. 7. PERTURBATION OF SINGULARITY ANALYSIS ASYMPTOTICS
621
that ρ < r is the unique (simple) root in |z| ≤r of the equation C(z, 1) = 0,
and that B(ρ, 1) ̸= 0.
(ii) Nondegeneracy: one has ∂zC(ρ, 1) · ∂uC(ρ, 1) ̸= 0, ensuring the existence
of a nonconstant ρ(u) analytic at u = 1, such that C(ρ(u), u) = 0 and
ρ(1) = ρ.
(iii) Variability: one has
v
 ρ
ρ(1)

̸= 0.
Then, the random variable with probability generating function
pn(u) = [zn]F(z, u)
[zn]F(z, 1)
converges in distribution to a Gaussian variable with a speed of convergence that is
O(n−1/2). The mean µn and the standard deviation σn are asymptotically linear in n.
The remarks following the statement of Theorem IX.8 apply. Accordingly, the
mean µn and variance σ2
n are computable by the general formula (25), and the vari-
ability condition is expressible in terms of the values of C and its derivatives at (ρ, 1)
by means of Equation (27).
PROOF. Observe ﬁrst that one does not need to worry about the a priori domain of
existence of F(z, u) since Equation (37) provides automatically analytic continuation
to a collection of ∆–domains at ρ(u) when u varies. Thus, it sufﬁces that the repre-
sentation (37) be established initially in some open domain of {|z| < ρ} × {|u| < 1},
by unicity of analytic continuation.
By the assumptions made, the function F(z, 1) admits a singular expansion of the
form
(38)
F(z, 1)
=
(a0 + a1(z −ρ) + · · · )
+ (b0 + b1(z −ρ) + · · · )
 c1(z −ρ) + c2(z −ρ)2 + · · ·
−α .
There, the aj, bj, cj represent the coefﬁcients of the expansion in z of A, B, C for
z near ρ when u is instantiated at 1. (We may consider C(z, u) normalized by the
condition that c1 is positive real, and take, e.g., c1 = 1.) Singularity analysis then
implies the estimate
(39)
[zn]F(z, 1) = b0(−c1ρ)−αρ−n nα−1
Γ(α)

1 + O( 1
n)

.
All that is needed now is a “lifting” of relations (38) and (39), for u in a small
neighbourhood of 1. First, we observe that by the analyticity assumption on A, the
coefﬁcient [zn]A(z, u) is exponentially small compared to ρ−n, for u close enough
to 1. Thus, for our purposes, we may freely restrict attention to B(z, u)C(z, u)−α.
(The function A is only needed in some cases so as to ensure nonnegativity of the
ﬁrst few coefﬁcients of F.) Next, it is convenient to operate with a ﬁxed rather than
movable singularity. This is simply achieved by considering the normalized function
Φ(z, u) := B
 z
ρ(u), u

C

z
ρ(u), u
−α
.

622
IX. MULTIVARIATE ASYMPTOTICS
Provided u is restricted to a suitably small neighbourhood of 1 and z to |z| < R for
some R >′, the functions B(z/ρ(u), u) and C(z/ρ(u), u) are analytic in both z and u,
with C(z, u) having a ﬁxed simple zero at z = 1. There results that the function
1
1 −z C

z
ρ(u), u

has a removable singularity at z = 1 and is in fact analytic in |z| < r, |u −1| < δ.
Thus, Φ satisﬁes an expansion of the form
Φ(z, u) = (1 −z)−α X
n≥0
φn(u)(1 −z)n,
that is convergent and such that each coefﬁcient φj(u) is an analytic function of u for
|u −1| < δ.
We may restrict this neighbourhood as we please, with |u −1| ≤δ provided we
keep ǫ ≥δ > 0. First, by Weierstrass preparation, there is for u sufﬁciently near to 1,
a unique simple root ρ(u) near ρ of the equation
C(ρ(u), u) = 0.
We have ρ(1) = ρ with ρ(u) being locally analytic at 1. One can then expand A, B, C
near (ρ(u), u). This gives the bivariate expansion
(40)
F(z, u)
=
(a0(u) + a1(z −ρ(u)) + · · · )
+ (b0(u) + b1(u)(z −ρ(u)) + · · · )
 c1(u)(z −ρ(u)) + c2(u)(z −ρ(u))2 + · · ·
−α .
There, by assumption, we have that aj(u), bj(u), cj(u) are analytic in |u −1| ≤ǫ,
and are each O(r−n). In addition, ρ(u)α and (−c1(u))α are well-deﬁned by principal
values, since their specializations at u = 1 are positive. Thus, we have a singular
expansion for F(z, u); for instance, when α ∈] −1, 0[,
(41)
F(z, u)
=
a0(u) + a1(u)(z −ρ(u))
+ b0(u)(−c1(u)ρ(u))−α(1 −z/ρ(u))−α + R(z),
where
R(z) = O
 (1 −z/ρ(u))α+1
,
and the O–error term is uniform for |u −1| < δ:
|R(z)| ≤K · |1 −z/ρ(u)|,
for some absolute constant K. We thus have
(42)
[zn]F(z, u) = b0(u)(−c1(u)ρ(u))−αρ(u)−n nα−1
Γ(α)

1 + O( 1
n)

.
where the error term is again uniform. An especially important fact for this argument
is the following: the singularity analysis process is a uniform coefﬁcient extraction
method. This is precisely provided by Lemma IX.2.
Equation (42) shows that fn(u) = [zn]F(z, u) satisﬁes precisely the conditions
of the Quasi-Powers Theorem. Therefore, the law with PGF fn(u)/fn(1) is asymptot-
ically normal with a mean and a standard deviation that are both O(n). Since the error

IX. 7. PERTURBATION OF SINGULARITY ANALYSIS ASYMPTOTICS
623
term in (42) is O(1/n), the speed of convergence to the Gaussian limit is O(1/√n).
□
 IX.31. Logarithmic multipliers. The conclusions of Theorem IX.10 extend to functions
representable under the more general form
F(z, u) = A(z, u) + B(z, u)C(z, u)−α (log C(z, u))k .
(The proof follows exactly the same pattern.)

EXAMPLE IX.16. Leaves in classical varieties of trees. We start with binary Catalan trees and
with the BGF
F(z, u) = z(u + 2zF(z, u) + F(z, u)2),
so that
F(z, u2) = 1
2z
“
1 −2z −
p
(1 −2z(1 + u))(1 −2z(1 −u))
”
.
This is almost the same as the BGF of leaves in general Catalan trees. The dominant singularity
is at ρ(u) =
1
2(1+u), and the limit law is Gaussian. The asymptotic form of the mean and
variance are immediately derived from ρ, and we ﬁnd that the number of leaves Xn in a binary
Catalan tree satisﬁes
E{Xn} = n
4 + O(1),
σ{Xn} =
√n
4
+ O(n−1/2).
In the case of Cayley trees, the BGF equation8 is
F(z, u) = z(u −1 + eF (z,u)).
By Lagrange inversion, the distribution is related to the Stirling partition numbers. The func-
tional equation admits an explicit solution in terms of Lambert’s “W -function”, which is such
that z = W eW, with the branch choice that W = 0 when z = 0. Thus, W (z) = −T(−z),
where T = zeT is the classical “Cayley tree function”. Here, we have
F(z, u) = z(u −1) −W (−zez(u−1)).
The function W has a dominant singularity of the square-root type at −e−1. Thus, one can
solve for ρ(u), again in terms of the W function. Here, we ﬁnd
ρ(u) =
1
u −1W (e−1(u −1)).
In particular, we get ρ(1) = e−1, as we should. The expansion near u = 1 then comes
automatically
ρ(u)
ρ(1) = 1 −e−1(u −1) + 3
2e−2(u −1)2 + O((u −1)3).
Hence the mean and the variance of the number Xn of leaves in a random tree of size n satisfy:
E{Xn} ∼e−1 n ≈0.36787 n,
σ2{Xn} ∼e−2(e −2) n ≈0.09720 n,
and the limit law is a Gaussian. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE IX.16. □
 IX.32. Leaves in Motzkin trees. The number of leaves in a unary-binary (Motzkin) tree is
asymptotically Gaussian.

8This example constitutes a typical application of symbolic manipulation systems.

624
IX. MULTIVARIATE ASYMPTOTICS
EXAMPLE IX.17.
Patterns in binary Catalan trees. We develop here a more sophisticated
example coming from the analysis of pattern matching in trees [456, 209] that generalizes the
problem of leaves. Fix a nonempty binary tree w and let ω[t] ≡ωw[t] be the number of
occurrences of pattern w in tree t. By this, we mean the number of internal nodes ν in t such
that the subtree of t rooted at ν is isomorphic to w. The problem is of interest in the analysis
of some symbolic manipulation algorithms and of “sharing” strategies; see [456, 209] for the
algorithmic context.
A pattern occurs either in the left root subtree t0 or in the right root subtree t1 or at the
root iself if t coincides with w. This gives rise to the recursive deﬁnition
ω[t] = ω[t0] + ω[t1] + [[t = w]],
ω[∅] = 0,
where [[P]] denotes the indicator function of P whose value is 1 if P is true, and 0 otherwise.
The function uω[t] is almost multiplicative, and
uω[t] = u[[t=w]]uω[t0]uω[t1] = uω[t0]uω[t1] + [[t = w]] · (u −1).
Thus, the bivariate generating function F(z, u) where z marks internal nodes and u marks the
number of occurrences of w,
F(z, u) :=
X
t
z|t|uω[t],
satisﬁes the algebraic equation,
F(z, u) = 1 + (u −1)zm + zF(z, u)2,
with m = |w| the number of internal nodes of w.
The quadratic equation for F leads to
F(z, u) = 1
2z
“
1 −
p
1 −4z −4zm+1(u −1)
”
.
The discriminant has a unique root ρ = 1/4 when u = 1, while it has m + 1 roots for u ̸= 1.
By general properties of implicit and algebraic functions (implicit function theorem, Weierstrass
preparation), as u tends to 1, one of these roots, call it ρ(u) tends to 1/4 while all the other ones
{ρj(u)}m
j=1 escape to inﬁnity. We have
H(z, u) := 1 −4z −4zm+1(u −1)
1 −z/ρ(u)
=
m
Y
j=1
(1 −z/ρj(u)),
which is an analytic function in (z, u) for (z, u) in a complex neighbourhood of (1/4, 1). This
results from the fact that the algebraic function 1/ρ(u) is analytic at u = 1. It gives the singular
expansion of G(z, u) = zF(z, u):
G(z, u) = 1
2 −1
2
p
H(z, u)
p
1 −z/ρ(u).
Thus, we are exactly under the conditions of the theorem. The quantity ω taken over a random
binary tree of size n + 1 has mean and variance given asymptotically by
m
„
1
4ρ(u)
«
n,
v
„
1
4ρ(u)
«
n.
The expansion of ρ(u) at 1 is computed easily by iteration of the deﬁning equation:
z = 1
4 −zm+1(u −1) = 1
4 −(1
4 −zm+1(u −1))m+1(u −1) + · · · .
Thus,
ρ(u) = 1
4 −
1
4m+1 (u −1) + m + 1
42m+1 (u −1)2 + · · · .

IX. 7. PERTURBATION OF SINGULARITY ANALYSIS ASYMPTOTICS
625
This shows that the mean µn and the variance σ2
n of the number of occurrences of a pattern
of size m in a random binary tree of size n satisfy
µn ∼n
4m ,
σ2
n ∼n( 1
4m −2m + 1
42m
);
also, the distribution is asymptotically Gaussian. In particular, the probability of occurrence of
a pattern at a random node of a random trees decreases fast (the factor of 4−m in the estimate of
averages) with the size of the pattern, a property that was to be expected and that also holds for
strings. The paper of Steyaert and Flajolet [456] shows that similar properties (equivalent to the
mean value analysis) hold for any simply generated family. The expression of the BGF F(z, u)
is given by Flajolet, Sipala, and Steyaert in [209], where similar developments are used to show
that the minimal “dag representation” of a random tree —identical subtrees are “shared” and
represented only once— is of average size O(n(log n)−1/2). . . END OF EXAMPLE IX.17. □
 IX.33. Patterns in classical varieties of trees. Patterns in general Catalan trees and Cayley
trees can be similarly analysed.

We shall see later that such laws, established here via explicit representations of
the BGFs, extend to varieties of trees whose generating functions are only accessible
implicitly via functional equations (Subsection IX. 7.3).
IX. 7.2. The exponential–logarithmic schema. So far, the occurrence of a
Gaussian law has been related to a movable singularity that causes coefﬁcients of
a bivariate generating function F(z, u) to obey a rough power law of the form
fn(u) = [zn]F(z, u) ≈ρ(u)−n,
so that the Quasi-Powers Theorem applies with a scaling factor βn = n. In this
section, we discuss the situation of a ﬁxed singularity and variable exponent in sin-
gular expansions. This means a somewhat stronger decomposition property for a
BGF as the singularity remains constant when the auxiliary parameter u varies, as
in F(z, u) = C(z)−α(u). Typical cases of application are to the set constructions,
where the analysis of number of components can be rephrased as the estimation of
coefﬁcients in
F(z, u) = exp (uG(z)) ,
when G(z) is, roughly speaking, logarithmic. In this case, we have parameters whose
mean and variance grow logarithmically, a typical instance being the number of cycles
in permutations. Analytically, this comes from an approximate form
F(z, u) ≈(1 −z/ρ)−α(u),
so that
fn(u) = [zn]F(z, u) ≈ρ−nnα(u)−1 ≡ρ−n
n
exp(α(u) log n).
This is again a case of application of the Quasi-Powers Theorem, but now with a
scaling factor βn = log n. The developments in this section are inspired by a paper
of Flajolet and Soria [210] who ﬁrst extracted certain universally valid laws for such
assemblies of logarithmic structures.

626
IX. MULTIVARIATE ASYMPTOTICS
Theorem IX.11 (General variable exponent schema). Let F(z, u) be a bivariate func-
tion that is analytic at (z, u) = (0, 0) and has nonnegative coefﬁcients there. Assume
the following conditions.
(i) Exponent perturbation. Assume that there exist ǫ > 0 and r > ρ such that
in the domain,
D =

(z, u)
 |z| ≤r, |u −1| ≤ǫ
	
,
the function F(z, u) admits the representation
(43)
F(z, u) = A(z, u) + B(z, u)C(z)−α(u)
where A(z, u), B(z, u) are analytic for (z, u) ∈D, the function α(u) is
analytic in |u −1| ≤ǫ with α(1) ̸∈{0, −1, −2, . . .}, and C(z) is analytic
for |z| ≤r, the equation C(ζ) = 0 having a unique root ζ = ρ in |z| ≤r
that is simple, with B(ρ, 1) ̸= 0.
(ii) Variability: one has
α′(1) + α′′(1) ̸= 0.
Then the variable with probability generating function
pn(u) = [zn]F(z, u)
[zn]F(z, 1)
converges in distribution to a Gaussian variable and the speed of convergence is
O((log n)−1/2). The corresponding mean µn and variance σ2
n satisfy
µn ∼α′(1) log n,
σ2
n ∼α′′(1) log n.
PROOF. Clearly, for the univariate problem, by singularity analysis, one has
[zn]F(z, 1) = B(ρ, 1)(−ρC′(ρ))−α(1)ρ−n nα(1)−1
Γ(α(1))

1 + O( 1
n

.
For the bivariate problem, the contribution arising from [zn]A(z, u) is exponentially
small, since A(z, u) is z-analytic in |z| ≤r.
Write next
B(z, u) = (B(z, u) −B(ρ, u)) + B(ρ, u).
The ﬁrst term satisﬁes
B(z, u) −B(ρ, u) = O((z −ρ)),
uniformly with respect to u, since
B(z, u) −B(ρ, u)
z −ρ
is analytic in z and u, by division of power series representations. Let A be an upper
bound on α(u) on |u −1| ≤ǫ. Then, by singularity analysis and its companion
uniformity,
[zn](B(z, u) −B(ρ, u))C(z)−α(u) = O(ρ−nnA−2).
By suitably restricting the domain of u to |u −1| ≤δ, one may freely assume that
A −2 < α(1) −7
4. Thus, the contribution from this part is small.

IX. 7. PERTURBATION OF SINGULARITY ANALYSIS ASYMPTOTICS
627
It only remains to analyse
[zn]B(ρ, u)C(z)−α(u).
This is done exactly like in the univariate case, again taking advantage of the unifor-
mity afforded by singularity analysis. We ﬁnd, uniformly for u in a small neighbour-
hood of 1,
[zn]F(z, u) = B(ρ, u)ρ−n
nΓ(α(u)) (−ρC′(ρ))−α(u)eα(u) log n 
1 + O(n−1/2)

.
Thus, the Quasi-Powers Theorem applies and the law is Gaussian in the limit.
□
The next proposition covers a scheme closely related to the exponential logarith-
mic setting. Its proof only requires a slight modiﬁcation of the calculations involved
in the error terms. It complements Example 5 where the number of small components
has been found to be Poisson.
Proposition IX.13 (Sets of labelled logarithmic structures). Consider the labelled
set construction F = P(G). Assume that G(z) has radius of convergence ρ and is
∆-continuable with a singular expansion of the form
G(z) = κ log
1
1 −z/ρ + λ + O

1
log2(1 −z/rho)

.
Then, the limit law of the number of G-components in a large F-structure is asymp-
totically Gaussian with mean and variance both asymptotic to κ log n.
The bivariate EGF for permutations with u marking the number of cycles is
F(z, u) =
X n
k

uk zn
n! = (1 −z)−u = exp

u log
1
1 −z

·,
so that we are in the simplest case of an exponential-logarithmic schema. Theo-
rem IX.11 implies that the number of cycles in a random permutation of size n con-
verges to a Gaussian limiting distribution. This classical result stating the asymptot-
ically normal distribution of the Stirling numbers (of the ﬁrst kind) constitutes Gon-
charov’s Theorem. It has already been stated with a direct proof in Proposition IX.6,
thanks to the explicit character of the “horizontal” generating functions (the Stirling
polynomials) in this particular case.
EXAMPLE IX.18. Cycles in derangements. The number of cycles is asymptotically normal
in generalized derangements where a ﬁnite set S of cycle lengths are forbidden. This results
immediately from the BGF
F(z, u) = exp(uG(z)),
G(z) = log
1
1 −z −
X
s∈S
zs
s .
The
classical
derangement
problem
corresponds
to
S
=
{1};
see
[98].
END OF EXAMPLE IX.18. □
EXAMPLE IX.19. Clouds and 2-regular graphs. “Clouds” are deﬁned in [98, p. 274] and they
have already been encountered in Chapters II and VI: let n straight lines in the plane be given
in general position, so that there are
`n
2
´
intersecting points; a cloud of size n is a (maximal)
set of n intersection points, no three of which are collinear. By duality, there is a one–to–
one correspondence between clouds and 2–regular graphs. A 2–regular graph of size n is an

628
IX. MULTIVARIATE ASYMPTOTICS
undirected graph with n edges, such that each vertex has degree exactly 2. Any 2–regular graph
may be decomposed into a product of connected components that are (undirected) cycles of
length at least 3. Hence the bivariate EGF for 2–regular graphs, with u marking the number of
connected components, is:
F(z, u) = exp
„
u(1
2 log
1
1 −z −z
2 −z2
4 )
«
= e−uz/2−uz2/4
(1 −z)u/2
.
The function exp(u(z/2 + z2/4)) is entire, so that the conditions of Theorem IX.11
are satisﬁed.
Thus, the number of connected components in a 2–regular graph, (this is
equivalent to the number of polygons in a cloud) has a Gaussian limiting distribution.
END OF EXAMPLE IX.19. □
EXAMPLE IX.20.
Random mappings.
Let f denote a function that maps the set N =
{1, 2, · · · , n} into itself. Such a function f may be represented by a directed graph Gf with
vertex set N and edge set {(i, f(i)); i ∈N}. Such graphs, in which every point has out–degree
one, are called functional digraphs; see [259, p. 68]. A functional digraph may be viewed as
a set of components that are themselves cycles of rooted labelled trees. The bivariate EGF for
functional digraphs with u marking connected components is
F(z, u) = exp
`
u(log
1
1 −T(z))
´
,
where the generating function of rooted labelled trees T(z) is the Cayley tree function deﬁned
implicitly by the relation T(z) = z exp(T(z)). By the inversion theorem for implicit functions
we have
T(z) = 1 −
p
2(1 −ez) +
X
k≥2
ck(1 −ez)k/2.
Thus,
F(z, u) = exp
n
u
„1
2 log
1
1 −ez + H((1 −ez)1/2)
«o
,
where H(v) is analytic at v = 0. From this form and Theorem IX.11, we obtain a theorem
of Stepanov [454]: The number of components in functional digraphs has a limiting Gaussian
distribution.
This approach extends to functional digraphs satisfying various degree constraints as con-
sidered in [14]. This analysis and similar ones are relevant to integer factorization, using Pol-
lard’s “rho” method [198, 304, 434]. . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE IX.20. □
Unlabelled constructions. In the case of unlabelled structures, the class F of multi-
sets over a class G have OGF,
X
n≥0
Fnzn =
Y
n≥1
(1 −zn)−Gn.
By taking logarithms and reorganizing the corresponding series, we get the alternative
form
F(z) = exp
G(z)
1
+ G(z2)
2
+ G(z3)
3
+ · · ·

.

IX. 7. PERTURBATION OF SINGULARITY ANALYSIS ASYMPTOTICS
629
Similarly, in the bivariate case, where u marks the number of components, the bivari-
ate GF is (see Chapter III),
F(z, u) =
X
n,k≥0
Fn,kukzn = exp
u
1 G(z) + u2
2 G(z2) + u3
3 G(z3) + · · ·

,
which is of the form exp(G(z))u · B(z, u). Here, we are interested in structures such
that G(z) has a logarithmic singularity, in which case Theorem IX.11 applies, as soon
as G(z) has radius of convergence ρ < 1.
EXAMPLE IX.21. Polynomial factorization. Fix a ﬁnite ﬁeld K = GF(q) and consider the
class P of monic polynomials (having leading coefﬁcient 1) in K[z], with I the subclass of
irreducible polynomials. Obviously, Pn = qn, so that
P(z) = (1 −qz)−1.
Because of the unique factorization property, a polynomial is a multiset of irreducible polyno-
mial, whence the relation
P(z) = exp
„I(z)
1
+ I(z2)
2
+ I(z3)
3
+ · · ·
«
.
The preceding relation can be inverted using M¨obius inversion. If we set L(z) = log P(z),
then we have
I(z) =
X
k≥1
µ(k)L(zk)
k
= log
1
1 −qz +
X
k≥2
µ(k)L(zk)
k
,
where µ is the M¨bius function.
Since L(zk) is analytic for |z| < q−1/2 whenever k ≥2, and |L(zk)| < cst|z|k, the
sum P
k≥2 µ(k)L(zk)/k is analytic for |z| ≤τ, with q−1 < τ < q−1/2. Hence I(z) has an
isolated singularity of logarithmic type at z = q−1 < 1.
Thus the average number of irreducible factors in a polynomial, and its variance, are both
asymptotically log n + O(1) (this result appears in [304, Ex. 4.6.2.5]). Let Ωn be the random
variable representing the number of irreducible factors of a random polynomial of degree n over
GF(q), each factor being counted with its order of multiplicity. Then as n tends to inﬁnity, for
any two real constants λ < µ, we have
P{log n + λ
p
log n < Ωn < log n + µ
p
log n} →
1
√
2π
Z µ
λ
e−t2/2 dt.
This statement [210] is a counterpart of the famous Erd¨os–Kac Theorem (1940) for the number
of prime divisors of natural numbers (with here log n that replaces log log n when dealing with
integers at most n). A similar result holds for the parameter ωn that represents the number of
distinct irreducible factors in a random polynomial of degree n. END OF EXAMPLE IX.21. □
It is perhaps instructive to re-examine this last example at an abstract level, in the
light of general principles of analytic combinatorics.
A polynomial over a ﬁnite ﬁeld is determined by the sequence
of its coefﬁcients. Hence, the class of all polynomials, as a se-
quence class, has a polar singularity. On the other hand, unique
factorization entails that a polynomial is also a multiset of irre-
ducible factors (“primes”). Thus, the class of irreducible poly-
nomials, that is implicitly determined, is logarithmic, since the

630
IX. MULTIVARIATE ASYMPTOTICS
multiset construction to be inverted is in essence an exponential
operator. Consequently, the number of irreducible factors obeys
the exponential-logarithmic scheme, so that it is asymptotically
Gaussian.
Eventually, the limit law arises because of the purely analytic character of the gener-
ating functions involved, together with permanence of analytic relations implied by
combinatorial constructions.
EXAMPLE IX.22.
Mapping patterns.
Let f and g be two functions mapping the set
{1, 2, · · · , n} into itself. Mappings f and g are said to be equivalent if there exists a permutation
π of {1, 2, · · · , n} such that f(i) = j iff g(π(i)) = π(j). Mapping patterns are thus equiv-
alence classes of mapping functions, or equivalently functional digraphs on unlabelled points.
They correspond to multisets of cycles of rooted unlabelled trees. The OGF for rooted unla-
belled trees satisﬁes the implicit relation A(z) = z exp(P 1
kA(zk)), and Otter [382] proved
that
A(z) = 1 −c1
p
(1 −z/η) +
X
k≥2
ck(1 −z/η)k.
for some η < 1: see our detailed account in Chapter VII.
On the other hand, by the translation of the cycle construction, if G is the unlabelled cycle
construction applied to A, then (see Chapter III),
G(z) =
X
k≥1
φ(k)
k
log
1
1 −A(zk),
where φ(k) is the Euler totient function. In the present context, since A(z) has radius of con-
vergence η strictly less than 1,
G(z) = log
1
1 −A(z) + S(z),
where S(z) is analytic at η. Finally the bivariate OGF for random mapping patterns satisﬁes
F(z, u)
=
exp
` X
k≥1
uk G(zk)
k
´
=
exp
`
u log
1
1 −A(z) + uS(z) + T(z, u)
´
=
exp
„u
2 log
1
1 −z/η + u
`
(1 −z/η)1/2´
+ uS(z) + T(z, u)
«
,
where S(z) is analytic at η, T(z, u) is analytic for z = η and u = 1, and H is analytic around
0, with H(0) = 0. Thus conditions for applying Theorem IX.11 are satisﬁed and the number
of components in random mapping patterns has a Gaussian limiting distribution. The mean
value is asymptotic to 1
2 log n (this result appears in [357] and the variance is 1
2 log n + O(1).
END OF EXAMPLE IX.22. □
EXAMPLE IX.23. Arithmetical semigroups. Knopfmacher [297] deﬁnes an arithmetical semi-
group as a semigroup with unique factorization, and a size function (or degree) such that
|xy| = |x| + |y|,
where the number of elements of a ﬁxed size is ﬁnite. If P is an arithmetical semigroup and I
its set of ‘primes’ (irreducible elements), axiom A# of Knopfmacher asserts the condition
card{x ∈P / |x| = n} = cqn + O(qαn) (α < 1).

IX. 7. PERTURBATION OF SINGULARITY ANALYSIS ASYMPTOTICS
631
It is shown by Knopfmacher that several algebraic structures forming arithmetical semigroups
satisfy axiom A#, and thus the conditions of Theorem IX.11 are automatically satisﬁed. There-
fore, the results deriving from Theorem IX.11 ﬁt into the framework of Knopfmacher’s “ab-
stract analytic number theory”, since they provide general conditions under which theorems of
the Erd¨os–Kac type must hold true. Examples of application are Galois polynomial rings (the
example of polynomial factorization), ﬁnite modules or semisimple ﬁnite algebras over a ﬁnite
ﬁeld K = GF(q), integral divisors in algebraic function ﬁelds, ideals in the principal order of
a algebraic function ﬁeld, ﬁnite modules, or semisimple ﬁnite algebras over a ring of integral
functions. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE IX.23. □
IX. 7.3. Algebraic and implicit functions. Many combinatorial problems, es-
pecially as regards paths and trees, lead to descriptions by context–free languages.
Accordingly, the GF’s are algebraic functions. The most frequent situation is that of
univariate GF’s having singularities of the square-root type.
Corollary IX.1 (Algebraic functions). Let F(z, u) be a bivariate function that is an-
alytic at (0, 0) and has nonnegative coefﬁcients. Assume that F(z, u) is one of the
solutions y of a polynomial equation
Φ(z, u, y) = 0,
where Φ is an irreducible polynomial of total degree m, of degree d ≥2 in y. Assume
that F(z, 1) is has a unique dominant singularity at ρ > 0, with a singular behaviour
of the square-root type there. Deﬁne the resultant polynomial,
∆(z, u) = result y

Φ(z, u, y), ∂
∂y Φ(z, u, y)

,
and assume that ρ is a simple root of ∆(z, 1). Let ρ(u) be the unique root of the
equation
∆(ρ(u), u),
analytic at 1, such that ρ(1) = ρ. Then, provided the variability condition
v
 ρ(1)
ρ(u)

> 0,
is satisﬁed, a Gaussian Limit Law holds for the coefﬁcients of F(z, u).
PROOF.
The assumption of a square-root singularity (see Chapters VI and VII)
means that the polynomial Φ(ρ, 1, y) has a double zero at y = τ, where τ =
limz→ρ−F(z, 1). Equivalently, we have
 ∂
∂yΦ(ρ, 1, y)

y=τ
= 0,
 ∂2
∂y2 Φ(ρ, 1, y)

y=τ
̸= 0.
Thus, Weierstrass preparation gives the local factorization
Φ(z, u, y) = (y2 + c1(z, u)y + c2(z, u))H(z, u, y),
where H(z, u, y) is analytic and nonzero at (ρ, 1, τ) while c1(z, u), c2(z, u) are ana-
lytic at (z, u) = (ρ, τ).

632
IX. MULTIVARIATE ASYMPTOTICS
From the solution of the quadratic equation, we must have locally
y = 1
2

−c1(z, u) ±
p
c1(z, u)2 −4c2(z, u)

.
Consider ﬁrst (z, u) restricted by 0 ≤z < ρ and 0 ≤u < 1. Since F(z, u) is real
there, we must have c1(z, u)2 −4c2(a, u) also real and nonnegative. Since F(z, u) is
continuous and increasing with z for ﬁxed u, and since the discriminant c1(z, u)2 −
4c2(a, u) vanishes at 0, the determination with the minus sign has to be constantly
taken. In summary, we have
F(z, u) = 1
2

−c1(z, u) −
p
c1(z, u)2 −4c2(z, u)

.
The function C(z, u) = c2
1(z, u) −4c2(z, u) has a simple real zero at (ρ, 1).
Thus there is locally a unique analytic branch of the solution to C(ρ(u), u) = 0 such
that ρ(1) = ρ.. This branch is also by necessity a root of the resultant equation
∆(ρ(u), u) = 0. The conditions of Theorem IX.10 therefore apply and the Gaussian
law follows. 2
This theorem asserts that, under suitable conditions, the only possible dominant
singularity of the BGF is a “lifting” of the singularity of the univariate GF F(z, 1)
and the nature of the singularity —the square-root type— does not change. The result
generalizes to the case of a function Φ that is analytic in sufﬁciently large bounded
domains, e.g., an entire function. The condition is that the analytic curves
Φ(z, u, y) = 0,
∂
∂y Φ(z, u, y) = 0
have an intersection that “moves analytically” and nontrivially for u near 1, and a
sufﬁcient condition for this is the nonvanishing of the Jacobian determinant
(44)
J(z, u, y) :=

∂
∂z Φ(z, u, y)
∂
∂yΦ(z, u, y)
∂2
∂zyΦ(z, u, y)
∂2
∂y2 Φ(z, u, y)

and its ﬁrst derivative with respect to u at (ρ, 1, τ),
(45)
J(ρ, 1, τ) ̸= 0,
∂
∂uJ(z, u, y)

(ρ,1,τ)
̸= 0.
In the case of Corollary IX.1 and of these extensions, the expansion of ρ(u) at u = 1,
hence the mean and variance of the distribution, are computable explicitly from Φ, its
derivatives, and the quantities ρ and τ = F(ρ, 1).
The corollary applies to a great variety of decomposable parameters of context–
free languages, tree like objects, and more generally many recursively deﬁned com-
binatorial types. Examples of parameters covered are leaves, node types, and various
sorts of patterns in combinatorial tree models. Drmota has worked out a different
set of conditions for asymptotic normality. In particular, one of Drmota’s important
results [135] yields asymptotic normality, under minor technical restrictions, for a
polynomial system with positive coefﬁcients that is “irreducible”, meaning that the
dependency graph between nonterminals is strongly connected.

IX. 7. PERTURBATION OF SINGULARITY ANALYSIS ASYMPTOTICS
633
 IX.34. Nodes of degree k in simple varieties of trees. Their distribution is asymptotically
Gaussian.

 IX.35. Leaves in nonplane unlabelled trees. Their distribution is asymptotically Gaussian.

IX. 7.4. Differential equations. Ordinary differential equations (ODE’s, for
short) in one variable, when linear and with analytic coefﬁcients, have solutions whose
singularities occur at well-deﬁned places, namely those that entail a reduction of order.
The possible singular exponents of solutions are then obtained as roots of a polyno-
mial equation, the indicial equation. Such ordinary differential equations are usually
a reﬂection of a combinatorial decomposition and suitably parametrized versions then
open access to a number of combinatorial parameters. In this case, the ODE normally
remains an ODE in the main variable z that records size, while the auxiliary variable u
only affects the coefﬁcients but not the global shape of the original ODE.
Three cases may then occur for a linear ODE parametrized by u.
• Movable singularity: the location of the dominant singularity ρ(u) changes
with u but the singular exponent does not change; the analysis is then similar
to that of algebraic-logarithmic singularities.
• Movable exponent: the dominant singularity does not move but the sin-
gular exponent α(u) changes; the analysis then resorts to the exponential-
logarithmic schema.
• Movable singularity and movable exponent: in this case, the singular be-
haviour is essentially dictated by the movable singularity but with an aux-
iliary contribution arising from the movable exponent; the analysis of this
mixed case then requires an extension of the quasi-power framework, as
developed by Gao in Richmond in [226].
Here, we focus on the important case of a ﬁxed singularity and a movable exponent.
The required singularity perturbation analysis is inspired by the treatment of Flajolet
and Lafforgue in [195]. The corresponding univariate problems resort to holonomic
asymptotics.
Linear differential equations. The example of the distribution of levels of nodes
in random binary search trees or heap–ordered trees illustrates well the situation of
a ﬁxed singularity and movable exponent. A heap–ordered tree (HOT) is a plane
binary increasing tree. HOTs constitute an unambiguous tree representation of per-
mutations [434]. The EGF of HOTs is
F(z) =
1
1 −z =
X
n≥0
n! zn
n! ,
as results either from the combinatorial bijection with permutations or from the root
decomposition of increasing trees that translates into the functional equation,
(46)
F(z) = 1 +
Z z
0
F 2(t) dt,
a Riccati equation in disguise. Let F(z, u) be the BGF of HOT’s where u records the
depth of external nodes. In other words, fn,k = [znuk]F(z, u) is such that 1
nfnn, k

634
IX. MULTIVARIATE ASYMPTOTICS
represents the probability that a random external node in a random tree of size n is at
depth k in a random tree. The probability space is then a product set of cardinality
(n + 1) · n!, as there are n! trees each containing (n + 1) external nodes. By a
standard equivalence principle, the quantities 1
nfnn, k also give the probability that a
random unsuccessful search in a random binary search tree of size n necessitates k
comparisons.
Since the depth of a node is inherited from subtrees, the function F(z, u) satisﬁes
the linear integral equation,
(47)
F(z, u) = 1 + 2u
Z z
0
F(t, u)
dt
1 −t,
or, after differentiation,
∂
∂zF(z, u) =
2u
1 −z F(z, u),
F(0, u) = 1.
This equation is in fact a linear ODE with u entering as a parameter,
d
dz y(z) −
2u
1 −z y(z) = 0,
y(0) = 0.
The solution of any separable ﬁrst-oder ODE is obtained by quadratures, here,
F(z, u) =
1
(1 −z)2u .
From singularity analysis, provided u avoids {0, −1
2, −1, . . .}, we have
fn(u) := [zn]F(z, u) = n2u−1
Γ(2u)

1 + O( 1
n)

,
and the error term is uniform in u provided, say, |u −1| ≤1
4. Thus, Theorem IX.11
applies, and the law with PGF fn(u)/fn(1) converges to a Gaussian limit.
A similar result holds for levels of internal nodes, and is proved by similar de-
vices. The Gaussian proﬁle is even perceptible on single instance (see the particular
ﬁgure in Chapter III), which actually suggests a stronger “functional limit theorem”
for these objects: this has been proved by Chauvin and Jabbour [84] using martingale
theory.
Naturally, explicit expressions are available in such a simple case,
fn(u)
fn(1) = 2u · (2u + 1) · · · (2u + n −1)
(n + 1)!
,
so a direct proof of the Gaussian limit in the line of Goncharov’s theorem is clearly
possible; see Mahmoud’s book [351, Ch. 2], for this result originally due to Louchard.
What is interesting here is the fact that F(z, u) viewed as a function of z has a singu-
larity at z = 1 that does not move and, in a way, originates in the combinatorics of
the problem—the EGF (1 −z)−1 of permutations. The auxiliary parameter u appears
here directly in the exponent, so that the application of singularity analysis or of the
more sophisticated Theorem IX.11 is immediate.

IX. 7. PERTURBATION OF SINGULARITY ANALYSIS ASYMPTOTICS
635
Corollary IX.2 (Linear differential equations). Let F(z, u) be a bivariate generating
function with nonnegative coefﬁcients that satisﬁes a linear differential equation
a0(z, u)∂rF
∂zr + a1(z, u)
(ρ −z)
∂r−1F
∂zr−1 + · · · + ar(z, u)
(ρ −z)r F = 0,
with aj(z, u) analytic at ρ, and a0(ρ, 1) ̸= 0. Let fn(u) = [zn]F(z, u), and assume
the following conditions:
• [Nonconﬂuence] The indicial polynomial
(48)
J(α) = a0(ρ, 1)(α)(r) + a1(ρ, 1)(α)(r−1) + · · · + ar(ρ, 1)
has a unique root σ > 0 which is simple and such that all other roots α ̸= σ
satisfy ℜ(α) < σ;
• [Dominant growth] fn(1) ∼C · ρ−nnσ−1, for some C > 0.
• [Variability condition]
sup v(fn(u))
log n
> 0.
Then the coefﬁcients of F(z, u) admit a limit Gaussian law.
PROOF. (See the paper by Flajolet and Lafforgue [195] for a detailed example or the
books by Henrici [265] and Wasow [490] for a general treatment of singularities of lin-
ear ODEs.) We assume in this proof that no two roots of the indicial polynomial (48)
differ by an integer. Consider ﬁrst the univariate problem. A differential equation,
(49)
a0(z)drF
dzr + a1(z)
(ρ −z)
dr−1F
dzr−1 + · · · +
ar(z)
(ρ −z)r F = 0,
with the aj(z) analytic at ρ and a1(ρ) ̸= 0 has a basis of local singular solutions
obtained by substituting (ρ −z)−α and cancelling the terms of maximum order of
growth. The candidate exponents are thus roots of the indicial equation,
J(α) ≡a0(ρ)(α)(r) + a1(ρ)(α)(r−1) + · · · + ar(ρ) = 0.
If there is a unique (simple) root of maximum real part, α1, then there exists a solution
to (49) of the form
Y1(z) = (ρ −z)−α1h1(ρ −z),
where h1(w) is analytic at 0 and h1(0) = 1. (This results easily from a solution by
indeterminate coefﬁcients.) All other solutions are then of smaller growth and of the
form
Yj(z) = (ρ −z)−αjhj(ρ −z) (log(z −ρ))kj ,
for some integers kj and some functions hj(w) analytic and nonzero at w = 0. Then,
F(z) has the form
F(z) =
r
X
j=1
cjYj(z).
Then, provided c1 ̸= 0,
[zn]F(z) =
c1
Γ(σ)ρ−nnα1−1(1 + o(1)).

636
IX. MULTIVARIATE ASYMPTOTICS
Under the assumptions of the theorem, we must have σ = α1, and c1 ̸= 0. The reality
assumption is natural for a series F(z) that has real coefﬁcients.
When u varies in a neighbourhood of 1, we have a uniform expansion
(50)
F(z, u) = c1(u)(ρ −z)−σ(u)H1(ρ −z, u)(1 + o(1)),
for some bivariate analytic function H1(w, u) with H1(0, u) = 1, where σ(u) is the
algebraic branch that is a root of
J(α, u) ≡a0(ρ, u)(α)(r) + a1(ρ, u)(α)(r−1) + · · · + ar(ρ, u) = 0,
and coincides with σ at u = 1. By singularity analysis, this entails
(51)
[zn]F(z, u) = c1(u)
Γ(σ) ρ−nnα1(u)−1(1 + o(1)),
uniformly for u in a small neighbourhood of 1, with the error term being O(n−a) for
some a > 0. Thus Theorem IX.11 applies and the limit law is Gaussian.
The crucial point in (50,51) is the uniform character of expansions with respect
to u. This results from two facts: (i) the solution to (49) may be speciﬁed by analytic
conditions at a point z0 such that z0 < ρ and there are no singularities of the equation
between z0 and ρ. (ii) there is a suitable set of solutions with an analytic component
in z and u and singular parts of the form (ρ −z)−αj(u), as results from the matrix
theory of differential systems and majorant series. (This last point is easily veriﬁed if
no two roots of the indicial equation differ by an integer; otherwise, see [195] for an
alternative basis of solutions for u near 1, u ̸= 1.) 2
EXAMPLE IX.24. Node levels in quadtrees. This example is taken from [195]. Quadtrees are
one of the most versatile data structure for managing a collection of points in multidimensional
space. They are based on a recursive decomposition similar to that of BSTs.
Here d is the dimension of the data space. Let fn,k be the number of external nodes at level
k in a quadtree of size n grown by random insertions, and let F(z, u) be the corresponding BGF.
Two integral operators play an essential rˆole,
I g(z) =
Z z
0
g(t)
dt
1 −t
J g(z) =
Z z
0
g(t)
dt
t(1 −t).
The basic equation that reﬂects the recursive splitting process of quadtrees is then
(52)
F(z, u) = 1 + 2duJd−1I F(z, u).
The integral equation (52) satisﬁed by F then transforms into a differential equation of order d,
I−1J1−d F(z, u) = 2duF(z, u),
where
I−1g(z) = (1 −z)g′(z),
J−1g(z) = z(1 −z)g′(z).
The linear ODE version of (52) has an indicial polynomial that is easily determined by
examination of the reduced form of the ODE (52) at z = 1. There, one has
J−1g(z) = I−1g(z) −(z −1)2g′(z) ≈(1 −z)g′(z).
Thus,
I−1J1−d(1 −z)−θ = θd(1 −z)−θ + O((1 −z)−θ+1),
and the indicial polynomial is
J(α, u) = αd −2du.

IX. 7. PERTURBATION OF SINGULARITY ANALYSIS ASYMPTOTICS
637
In the univariate case, the root of largest real part is α1 = 2; in the bivariate case, we have
α1(u) = 2u1/d,
where the principal branch is chosen. Thus,
fn(u) = γ(u)nα1(u)(1 + o(1)).
By the combinatorial origin of the problem, F(z, 1) = (1 −z)−2, so that the coefﬁcient γ(1)
is nonzero. Thus, the conditions of the corollary are satisﬁed. The law is Gaussian in the limit,
with mean and variance
µn ∼2
d log n,
σ2
n ∼2
d log n.
The same result applies to the cost of a random search, either successful or not, as shown
in [195] by an easy combinatorial argument. . . . . . . . . . . . . . . . . . END OF EXAMPLE IX.24. □
Nonlinear differential equations. Though nonlinear differential equations do not
obey a simple classiﬁcation of singularities, there are a few examples in analytic com-
binatorics that can be treated by singularity perturbation methods. We detail here
typical analysis of properties of binary search trees (BSTs), equivalently HOTs, that is
taken from [185]. The Riccati equation involved reduces, by classical techniques, to
a linear second order equation whose perturbation analysis is particularly transparent
and akin to earlier analyses of ODEs. In this problem, the auxiliary parameter induces
a movable singularity that directly resorts to the Quasi-Powers Theorem.
EXAMPLE IX.25. Paging of binary search trees. Fix a “bucket size” parameter b ≥2. Given
a binary search tree t, its b-index is a tree that is constructed by retaining only those internal
nodes of t which correspond to subtrees of size > b. As a data structure, such an index is well-
suited to “paging”, where one has a two-level hierarchical memory structure: the index resides
in main memory and the rest of the tree is kept in pages of capacity b on peripheral storage, see
for instance [351]. We let ι[t] = ιb[t] denote the size —number of nodes— of the b-index of t.
Like in Eq. (46), the bivariate generating function
F(z, u) :=
X
t
λ(t)uι[t]z|t|
satisﬁes a Riccati equation that reﬂects the root decomposition of trees,
(53)
∂
∂z F(z, u) = uF 2(z, u) + (1 −u) d
dz
„1 −zb+1
1 −z
«
,
F(0, u) = 1,
where the general quadratic relation (46) has to be corrected in its low order terms.
The GFs of moments are rational functions with a denominator that is a power of (1 −z),
as results from differentiation at u = 1. Mean and variance follow:
µn = 2(n + 1)
b + 2
−1,
σ2
n = 2
3
(b −1)b(b + 1)
(b + 2)2
(n + 1).
(The result for the mean is well-known, refer to quantity An in the analysis of quicksort on
p. 122 of [302].)
Multiplying both sides of (53) by u now gives an equation satisﬁed by H(z, u) :=
uF(z, u),
∂
∂z H(z, u) = H2(z, u) + u(1 −u) d
dz
„1 −zb+1
1 −z
«
,

638
IX. MULTIVARIATE ASYMPTOTICS
that may as well be taken as a starting point since H(z, u) is the bivariate GF of parameter 1+ιb
(a quantity also equal to the number of external pages). The classical linearization transforma-
tion of Riccati equations,
H(z, u) = −X′
z(z, u)
X(z, u) ,
yields
(54)
∂2
∂z2 X(z, u) + u(u −1)A(z)X(z, u) = 0,
A(z) = d
dz
„1 −zb+1
1 −z
«
,
with X(0, u) = 1, X′
z(0, u) = −u. By the classical existence theorem of Cauchy, the solution
of (54) is an entire function of z for each ﬁxed u, as the linear differential equation has no
singularity at a ﬁnite distance. Furthermore, the dependency of X on u is also everywhere
analytic; see the remarks of [490, Sec. 24], for which a proof derives by inspection of the
classical existence proof based on indeterminate coefﬁcients and majorant series. Thus, X(z, u)
is actually an entire function of both complex variables z and u. As a consequence, for any ﬁxed
u = u0, the function H(z, u0) is a meromorphic function of z whose coefﬁcients are amenable
to singularity analysis.
In order to proceed further, we need to prove that, in a sufﬁciently small neighbourhood of
u = 1, X(z, u) has only one simple root, corresponding for H(z, u) to a unique dominant and
simple pole. This fact itself derives from general considerations surrounding the Preparation
Theorem of Weierstrass: in the vicinity of any point (z0, u0) with X(z0, u0) = 0, the roots
of the bivariate analytic equation X(z, u) = 0 are locally branches of an algebraic function.
Here, we have X(z, 1) ≡1 −z. Thus, as u tends to 1, all solutions of X(z, u) must escape to
inﬁnity except for one branch ρ(u) that satisﬁes ρ(1) = 1. By the nonvanishing of X′
u(z, 1) and
the implicit function theorem, the function ρ(u) is additionally an analytic function about u =
1.
The argument is now complete: for u in a sufﬁciently complex neighbourhood of 1, we
have a Quasi-Powers approximation,
[zn]H(z, u) = ρ(u)−n−1 `
1 + O(K−n)
´
,
for some ﬁxed constant K > 0. The Gaussian limit results. . . . END OF EXAMPLE IX.25. □
As shown in [185], a similar analysis applies to patterns in binary search trees
and heap–ordered trees. This is related to the analysis of local order patterns in per-
mutations, for which gaussian limit laws have been obtained by Devroye [125] using
extensions of the central limit theorem to weakly dependent random variables.
Similar displacements of singularity arise for node types in varieties of increasing
trees, extending the case of HOTs that are binary. This is discussed in [40]. For
instance, if φ(w) is the degree generator a family of increasing trees, the nonlinear
ODE satisﬁed by the BGF of leaves is
∂
∂z F(z, u) = (u −1)φ(0) + φ(F(z, u)).
Whenever φ is a polynomial, there is a spontaneous singularity at some ρ(u) that
depends analytically on u. Thus, again the Quasi-Powers Theorem applies; see [40].
IX. 8. Perturbation of saddle point asymptotics
We shall be brief here, as the subject is excellently covered in Sachkov’s book to
which we refer for details. Entire functions and functions with a fast growth at their

IX. 8. PERTURBATION OF SADDLE POINT ASYMPTOTICS
639
singularity do not in general lead to quasi-power expansions. As we known from uni-
variate asymptotics (Chapter VIII), the coefﬁcient expansions involve a combination
of large powers (that arise from the Cauchy kernel) and of the very fast singular be-
haviour of the function under consideration. Accordingly, bivariate asymptotic studies
necessitate a perturbation of saddle point expansions. A framework more ﬂexible than
the Quasi-Powers Theorem is then needed.
Here, we base our brief discussion on a theorem taken from Sachkov’s book [422].
Theorem IX.12 (Generalized quasi-powers). Assume that the generating function
pn(u) of a discrete random variable Xn has a representation of the form
pn(u) = exp (hn(u)) (1 + o(1)) ,
that holds uniformly, where each hn(u) is analytic in a ﬁxed neighbourhood Ωof 1.
Assume also the condition,
(55)
h′′′
n (u)
(h′n(1) + h′′n(1))3/2 →0,
uniformly for u ∈Ω. Then, the random variable
X∗
n =
Xn −h′
n(1)
(h′n(1) + h′′n(1))1/2
converges in distribution to a normal law with parameters (0, 1).
PROOF. See [422, Sec. 1.4] for details. Set σ2 = h′
n(1) + h′′
n(1), and expand the
Laplace transform of Xn at t/σ. This gives
hn(et/σ) = h′
n(1) t
σ + (h′
n(1) + h′′
n(1)) t2
2σ + o(1).
Thus, the Laplace transform of X∗
n converges to the transform of a standard Gauss-
ian. 2
This theorem extends the quasi-power scheme. In effect, if
hn(u) = βn log B(u) + A(u),
then the quantity (55) is O(β−1/2
n
), uniformly. The application of this theorem to
saddle point integrals is in principle routine, though the manipulation of asymptotic
scales associated with expressions involving the saddle point value may become cum-
bersome. We detail here the case of singletons in random involutions for which the
saddle point is an algebraic function of n and u.
 IX.36. Effective speed bounds. A metric version of the theorem, with error terms, cane be
developed assuming suitable error bounds.

EXAMPLE IX.26.
Singletons in random involutions. This example is again borrowed from
Sachkov’s book [422]. The BGF is
F(z, u) = exp
„
zu + z2
2
«
.
The saddle point equation (see Chapter VIII) is then
„ d
dz uz + z2
2 −(n + 1) log z
«
z=ζ
= 0.

640
IX. MULTIVARIATE ASYMPTOTICS
This deﬁnes the saddle point ζ ≡ζ(n, u),
ζ(n, u)
=
−u
2 + 1
2
p
4n + 4 + u2
=
√n −u
2 + u2 + 4
8
1
√n + O(n−1),
where the error term is uniform for u near 1. By the saddle point formula, one has
[zn]F(z, u) =
1
p
2πD(n, u)
F(ζ(n, u), u)ζ(n, u)−n.
The denominator is determined in terms of second derivatives, according to the classical saddle
point formula (Chapter VIII),
D(n, u) =
„
z2 ∂2
∂z2 + z ∂2
∂z2
»
uz + z2
2
–«
z=ρ
,
and its main asymptotic order does not change when u varies in a sufﬁciently small neighbour-
hood of 1,
D(n, u) = 2n −u√n + O(1),
again uniformly. Thus, the PGF of the number of singleton cycles satisﬁes
pn(u) = F(ζ(n, u), u)
F(ζ(n, 1), 1)
„ζ(n, u)
ζ(n, 1)
«−n
(1 + o(1)),
uniformly, for u near 1. This is of the form
pn(u) = exp (hn(u)) (1 + o(1)),
and local expansions then yield the centering constants
an := h′
n(1) = √n −1
2 + O(n−1/2),
b2
n := h′
n(1) + h′′
n(1) = √n −1 + O(n−1/2).
The theorem applies directly to this case and the variable
1
bn (Xn −an)
is asymptotic to a standard normal.
A little care with the error terms in the asymptotic expansions shows that the mean and
standard deviation µn, σn are asymptotic to an, bn, respectively. Therefore, the number of
singletons in a random involution of size n has mean µn and standard deviation σn that satisfy
µn ∼n1/2,
σn ∼n1/4.
This computation also determines the law of doubleton cycles and of all cycles, that are given
by
1
2(n −Xn),
1
2(n + Xn),
respectively.
In particular,
the
number
of
doubleton
cycles
has
average
1
2n −
1
2n1/2.
Thus, a random involution has a relatively small number of singleton cycles.
END OF EXAMPLE IX.26. □

IX. 8. PERTURBATION OF SADDLE POINT ASYMPTOTICS
641
EXAMPLE IX.27. The Stirling partition numbers. The numbers
˘n
k
¯
correspond to the BGF
F(z, u) = exp (u(ez −1)) .
The saddle point ζ ≡ζ(n, u) is the positive root near n/ log n of the equation
ζeζ = n + 1
u
.
The theorem applies:
Proposition IX.14. The Stirling partition distribution deﬁned by
1
Sn
˘n
2
¯
, with Sn a Bell num-
ber, is asymptotically normal, with mean and variance that satisfy
µn ∼
n
log n,
σ2
n ∼
n
(log n)2 .
We
refer
once
more
to
Sachkov’s
book
for
computational
details.
END OF EXAMPLE IX.27. □
Summarizing the last example as well as earlier results, we now have the fact that
all four Stirling-related distributions,
1
n!
n
k

,
k!
On
n
k

,
1
Sn
n
k

,
k!
Rn
n
k

,
associated to permutations, alignments, set partitions, and surjections are asymptoti-
cally Gaussian.
Saddle point and functional equations. The average-case analysis of the number of
nodes in random digital trees or “tries” can be carried out using the Mellin transform
technology. The corresponding distributional analysis is appreciably harder and due
to Jacquet and R´egnier [278]. A complete description is offered in Section 5.4 of
Mahmoud’s book which we follow. What is required is to analyse the BGF
F(z, u) = ezT (z, u),
where the Poisson generating function T (z, u) satisﬁes the nonlinear difference equa-
tion,
T (z, u) = uT 2(z
2, u) + (1 −u)(1 + z)e−z.
This equation is a direct reﬂection of the problem speciﬁcation. At u = 1, one has
T (z, 1) = 1, F(z, 1) = ez. The idea is thus to analyse [zn]F(z, u) by the saddle point
method.
The saddle point analysis of F requires asymptotic information on T (z, u) for
u = eit (the original treatment of [278] is based on characteristic functions). There,
the main idea is to “quais-linearize” the problem, setting
L(z, u) = log T (z, u),
with u a parameter.
This function satisﬁes the approximate relation L(z, u) ≈
2L(z/2, u), and a bootstrapping argument shows that, in suitable regions of the com-
plex plane, L(z, u) = O(|z|), uniformly with respect to u. The function L(z, u) is
then expanded with respect to u = eit at u = 1, i.e., t = 0, using a Taylor expansion,

642
IX. MULTIVARIATE ASYMPTOTICS
its companion integral representation, and the bootstrapping bounds. The moment-
like quantities,
Lj(z) = ∂j
∂tj L(z, eit)

t=0
,
can be subjected to Mellin analysis for j = 1, 2 and bounded for j ≥3. In this way,
there results that
L(z, eit) = L1(z)t + 1
2L2(z)t2 + O(zt3),
uniformly. The Gaussian law under a Poisson model immediately results from the
continuity theorem of characteristic functions. Under the original Bernoulli model,
the Gaussian limit follows from a saddle point analysis of
F(z, eit) = ezeL(z,eit).
An even more delicate analysis has been carried out by Jacquet and Szpankowski
in [279]. It is relative to path length in digital search trees and involves the formidable
non-linear bivariate difference-differential equation
∂
∂z F(z, u) = F 2(z
2, u).
IX. 9. Local limit laws
Under conditions similar to those of the Quasi-Powers Theorem, a cluster of con-
clusions may be drawn regarding densities of distributions and probabilities of large
deviations from the mean. We examine here the occurrence of local limit laws, which
corresponds to convergence of a discrete probability distribution to the Gaussian den-
sity function rather than convergence of distribution functions to the Gaussian error
function, as we have seen so far. Such local laws hold very frequently, but their proofs
require some sort of additional “smoothness” assumptions, either a combinatorial or
analytic. Under assumptions of the Quasi-Powers Theorem, it is also possible to quan-
tify precisely the exponential rate of decay for probabilities of rare events, far away
from the center of the distribution. This section explores both aspects that ﬁt well
withing the general framework of quasi-powers. One aspects provides precise asymp-
totic information on values of the individual probabilities, especially near the mean;
the other aspect quantiﬁes the smallness of probabilities far away from the mean and,
when conditions apply, it provides sharp quantitative versions of the concentration of
distribution discussed at the beginning of this chapter.
So far, we have examined the occurrence of continuous limit laws in the sense of
convergence of distribution functions. Thus, a standardized Yn converges in distribu-
tion to Y , if
P{Yn ≤x} →P{Y ≤x}.
In the case of a Gaussian limit that arises from a sequence of discrete distributions of
variables Xn with mean and variance µn, σ2
n, such a property quantiﬁes the probabil-
ities over any nonempty interval scaled according to σn,
(56)
Pr{µn + aσn < Xn ≤µn + bσn} =
1
√
2π
Z b
a
e−x2/2 dx + o(1),

IX. 9. LOCAL LIMIT LAWS
643
0
0.1
0.2
0.3
0.4
0.5
0.6
0.2
0.4
0.6
0.8
1
FIGURE IX.11. The histogram of the Eulerian distribution scaled to (n + 1) on
the horizontal axis, for n = 3 . . 60. The distribution is seen to quickly converge
to a bell-shaped curve corresponding to the Gaussian density e−x2/2/(2π)1/2.
for any a, b with a < b. From there, it is however in general not possible to draw
information on any individual probability,
pn,k = P{Xn = k},
by differencing, since the error terms in (56) will usually hide any nontrivial asymp-
totic information on individual pn,k.
On the other hand, numerical examination of discrete probability distributions
reveals that the histograms of the pn,k often assume a bell-shape proﬁle in the asymp-
totic limit. For instance Figure 11, borrowed from our book [434], displays the pn,k
that correspond to the Eulerian numbers. For a given value of n, the maximum proba-
bility pn,k is seen to occur “in the middle”, near the mean, and to obey an approximate
law,
p2n,n ≈1.35
√
2n,
for values near n = 60. The standard deviation of the distribution is otherwise known
to be ∼
p
n/12. Thus, the we expect an approximate formula of the form
pn,n/2+x√
n/12 ≈C
√ne−x2/2,
for integral values of the argument k = n/2 + x
p
n/12, with some constant C about
1.35.
Deﬁnition IX.4. A sequence of discrete probability distributions, pn,k = P{Xn =
k}, with mean µn and standard deviation σn is said to obey a local limit law of the

644
IX. MULTIVARIATE ASYMPTOTICS
Gaussian type if, for some set S of real numbers, and a sequence ǫ →0,
sup
σnpn,⌊µn+xσn⌋−
1
√
2π
e−x2/2
 ≤ǫn.
The local limit law is said to hold on S and the law is said to hold with relative speed
of convergence ǫn.
When such a local limit law exists, it usually holds on arbitrary bounded intervals
of the real line.
Theorem IX.13 (Local limit law). Let Xn be a sequence of nonnegative discrete
random variables with probability generating function pn(u). Assume that uniformly
in an annulus,
1 −ǫ ≤u ≤1 + ǫ,
ǫ > 0
the PGFs satisfy
(57)
pn(u) = A(u) (B(u))βn

1 + O( 1
κn
)

,
where A(u), B(u) are analytic in the annulus and A(1) = B(1) = 1, v(B(u)) =
B′′(1) + B′(1) −B′(1) ̸= 0. Assume also that B(u) attains uniquely in maximum on
|u| = 1 at u = 1: for all v, with |v| = 1 and v ̸= 1, one has |B(v)| < 1.
Under these conditions, the distribution of Xn satisﬁes a local limit law of the
Gaussian type on arbitrary bounded intervals of the real line.
Note that the mean and variance of Xn are given by Eq. (20).
PROOF.
A direct application of the saddle point method, as developed in Chap-
ter VIII. 2
This theorem applies in particular to quasi-power expansions, whenever the dom-
inant singularity ρ(u), that is a perturbation of the dominant singularity ρ of the uni-
variate problem, is analytic at all points of |u| = 1 and uniquely attains its minimum
at u = 1.
EXAMPLE IX.28.
Local laws for sums of RV’s. The simplest application is to the binomial
distribution, for which
B(u) = 1 + u
2
.
In a precise technical sense, the local limit arises in the BGF,
F(z, u) =
1
1 −z(1 + u)/2,
because the dominant singularity ρ(u) = 2/(1+u) exists on the whole of the unit circle, |u| =
1, and it attains uniquely its minimum modulus at u = 1; accordingly, B(u) = ρ(1)/ρ(u) is
uniquely maximal at u = 1.
More generally, the theorem applies to any sum Sn = T1 + · · · + Tn of independent,
identically, random variables whose maximal span is equal to 1 and whose PGF is analytic on
the unit circle. In that case, the BGF is
F(z, u) =
1
1 −zB(u),
the PGF of Sn is a pure power,
pn(u) = B(u)n,

IX. 9. LOCAL LIMIT LAWS
645
-1
-0.5
0
0.5
1
-1
-0.5
0.5
1
FIGURE IX.12. The values of the function B(u) for the Eulerian distribution
when |u| = 1, represented by a polar plot of |B(eiθ)| on the ray of angle θ
(right). (The dashed contours represent the relevant parts of the unit circle, for
comparison.) The maximum is uniquely attained at u = 1, where B(1) = 1. This
entails a local limit law for the Eulerian distribution.
and the fact that the minimal span of the Xj is 1 entails that B(u) attains uniquely its maximum
at 1. Such cases have been known for a long time in probability theory. See Chapter 9 of [237].
END OF EXAMPLE IX.28. □
At this stage, it is worth pointing an example not leading to a local law. Consider
the binomial distribution restricted to even values,
pn,2k = 2
2n
 n
2k

,
pn,2k+1 = 0.
The BGF is
F(z, u) =
1
1 −z(1 + u)/2 +
1
1 −z(1 −u)/2 −1.
This has two poles,
ρ1(u) =
2
1 + u,
ρ2(u) =
2
1 −u,
and it is clearly not true that a single one dominates throughout the domain |u| = 1.
Accordingly, the PGF satisﬁes
pn(u) = (1 + u)n + (1 −u)n,
and no quasi-power law, with a unique analytic B(u), holds uniformly for u on the
unit circle. In essence, a local limit law will be likely to hold when a PGF has a sharp
peak near 1 and stays much smaller in modulus along the rest of the unit circle. In
contrast, for the even binomial distribution, one has pn(1) = pn(−1).

646
IX. MULTIVARIATE ASYMPTOTICS
EXAMPLE IX.29.
Local law for the Eulerian distribution. For Eulerian numbers, we have
derived the approximate expression,
pn(u) = B(u)−n−1 + O(2−n),
when u is close enough to 1, with
B(u) = ρ(u)−1 = u −1
log u .
The plot of the function B(u) when u varies over |u| = 1 is then displayed in Fig. 12.
This case requires in fact a minor extension of Theorem IX.13 since the principal deter-
mination of the logarithm cannot be extended to the whole of the unit circle, in particular at
u = −1. However, it is easily realized that the quasi-power expansion holds with the pos-
sible exception of a small segment of the integration contour near u = −1. However, there,
the integrand is anyway exponentially smaller than on the rest of the contour, and the proof of
Theorem IX.13 is easily adjusted to cover such case.
From this enhanced argument, there results that a local limit law of the Gauss-
ian type holds for the Eulerian distribution on any compact subset of the real line.
END OF EXAMPLE IX.29. □
With a similar care to be exercised regarding principal determinations and dom-
inant singularities, many of our earlier analyses can be turned into local limit laws.
What is needed is a dominant singularity ρ(u) that yields the main asymptotic form of
the PGF’s on most of the unit disc and that achieves uniquely its minimum at 1, while
the rest of the unit disc contributes negligibly. For instance, this covers the surjection
distribution, for which
ρ(u) = log(1 + u−1),
B(u) =
log 2
log(1 + u−1),
leaves in general Catalan trees, where
B(u) = (1 + √u)2
4
,
or in binary Catalan trees.
The Stirling cycle distribution satisﬁes
pn(u) = e(u−1) log n
Γ(u)

1 + O( 1
n)

.
This approximation remains uniform as long as u avoids −1, but, there, pn(u) is small
anyway (being O(n−2)), so that again an extended form of Theorem IX.13 applies
and a local limit law holds. The same argument applies to node levels in quadtrees of
Example 24.
 IX.37. Peaks of distributions. It is possible to analyse asymptotically in detail the values of
the peak of the Eulerian and Stirling cycle distributions. (For the Eulerian distribution, see, e.g.,
the study of Lesieur and Nicolas [330].)


IX. 10. LARGE DEVIATIONS
647
-100
-80
-60
-40
-20
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
FIGURE IX.13. The quantities log pn,k relative to the Eulerian numbers illus-
trate an extremely fast decay of the distribution away from the mean. Here, the
diagrams corresponding to n = 10, 20, 30, 40 (top to bottom) are plotted. The
common shape of the curves indicates a large deviation property.
IX. 10. Large deviations
Moment inequalities constrain the shape of a distribution given its mean and vari-
ance. In particular, if σn/µn →1, the concentration property holds. This property
comes from Chebyshev’s inequality according to which the probability of observing
a value that deviates by more than x standard deviations from the mean is O(x−2).
Such general bounds, though sufﬁcient to establish a concentration property, are much
weaker than what holds under conditions of the quasi-power type, where the probabil-
ities of deviation are in fact exponentially decreasing with in x.
Figure 13 displays the logarithms of the Eulerian distribution. As logarithms of
probabilities are plotted, the distribution is seen to decay very rapidly away from the
mean µn ∼n/2. Consider for instance extreme cases. Clearly, there is a unique
permutation that has a minimal number of rises, namely the fully sorted permutation
with probability
pn,1 = 1
n!.
In contrast, since µn ∼n/2 and σ2
n ∼n/12, this extreme case is roughly at x =
√
3n
from the mean; thus, the Chebyshev inequalities only provides the very weak upper
bound of ∼
1
3n for this extreme case. For n = 40, the Chebyshev upper bound on the
probability is thus about 0.008 while the exact value 1/40! is of the order of 10−48.
Extensions of the quasi-power framework are once more well-suited to prove such
exponentially small tails, as we now explain. It turns out that the ubiquitous functions
ρ(u), B(u) are directly related to large deviation estimates. Such estimates nicely
supplement the already known limit laws, either central or local.
Deﬁnition IX.5. A sequence of discrete random variables {Xn} with pn,k = P{Xn =
k}, satisﬁes a local large deviation property of type (βn, W(x)) over the interval

648
IX. MULTIVARIATE ASYMPTOTICS
[x0, x1], if for any x ∈[x0, x1],
(58)
1
βn
log pn,xβn ≤W(x) + O(β−1
n ).
The function W(x) is called a large deviation function and βn is the scaling factor.
The inequality (58) is a priori only meaningful if xβn is an integer, but it makes
sense as well if it is understood that pn,w = 0 for nonintegral values of w and log 0 =
−∞. Of course, the large deviation property is nontrivial only when W(x) ≤0, with
W(x) not identically 0. A global (and marginally stronger) form of large deviations
can also be deﬁned when local probabilities are replaced by corresponding values of
the cumulative distribution function. Large deviation theory is introduced nicely in
the book of den Hollander [119].
Theorem IX.14 (Quasi-powers, large deviations). Consider a sequence of dis-
crete random variables {Xn} with PGF pn(u).
Assume that there exist a func-
tions A(u), B(u), analytic in some interval [u0, u1] with 0 < u0 < 1 < u1, such
that a quasi-power expansion holds,
(59)
pn(u) = A(u)B(u)βn  1 + O(κ−1
n

,
uniformly. Then the Xn satisfy a large deviation property,
(60)
1
βn
log pn,xβn ≤W(x) + O(β−1
n ),
where the large deviation function W(x) is given by
(61)
W(x) =
min
u∈[u0,u1] log
B(u)
ux

.
PROOF. The basic observation is that if f(u) = P
n fnun is an analytic function with
nonnegative coefﬁcients, then, for positive u,
(62)
fk := [uk]f(u) ≤f(u)
uk
≤min
u>0
f(u)
uk .
The ﬁrst inequality holds for any positive u in the disc of analyticity of f(u); the
second bound, with a similar condition, consists in taking the best possible value of u.
See our earlier discussion of saddle point bounds.
The combination of the principle (62) applied to f(u) = pn(u), and of the as-
sumption of the theorem (59) yields
log pn,xβn ≤βn
min
u∈[u0,u1] log
B(u)
ux

+ O(1).
Thus, a large deviation property holds with W(x) given by (61). 2
In general, the function W(x) is computable from B(u) and its derivatives. The
minimum is attained at either an end-point or a point such that
d
du (log B(u) −x log u) = 0.

IX. 10. LARGE DEVIATIONS
649
-0.25
-0.2
-0.15
-0.1
-0.05
0
0.3
0.4
0.5
0.6
0.7
x
FIGURE IX.14. The large deviation function relative to the Eulerian distribution,
for u ∈[0.3, 0.7].
Let η(x) be a value of u ∈[u0, u1] that cancels this derivative. Thus, η is an inverse
function of uB′(u)/B(u),
η(x)B′(η(x))
B(η(x) = x.
Then, a large deviation function is
(63)
W(x) = log B(η(x)) −x log η(x).
 IX.38. Prove similar types of bounds for the cumulative quantities
Pn,k =
X
j≤k
pn,j,
Qn,k =
X
j≥k
pn,j.

EXAMPLE IX.30.
Large deviations for the Eulerian distribution. In this case, the BGF has
a unique dominant singularity for u with ǫ < u < 1/ǫ, and any ǫ > 0. Thus, there is a
quasi-power expansion with
B(u) = (u −1)
log u ,
on any interval [ǫ, 1/ǫ]. Then η(x) is computable as the inverse function of
h(u) =
u
u −1 −
1
log u.
This function increases from 0 to 1 as u increases from 0 to 1, so that the inverse function is
well deﬁned over any closed interval [ǫ, 1 −ǫ]. The function W (x) is then determined by (63);
see Figure 14 for a plot of W (x) that “explains” the data of Figure 13.
We ﬁnd that
W (0.3) = W (0.7) = −0.252, W (0.4) = W (0.6) = −0.061,
W (0.45) = W (0.55) = −0.015,
and W (0.5) = 0, as expected. For instance, the probability of deviating by 20% from the mean
value µn ∼0.5n is approximately exp(−0.061 n). For n = 100, this upper bound is about
e−6.07, while the exact value of the probability gives p100,60 .= e−8.58. In the same vein, there

650
IX. MULTIVARIATE ASYMPTOTICS
is probability less than 10−6 of deviating by 10% from the mean, when n = 1, 000; the upper
bound becomes less than 10−65, for n = 10, 000, less than 10−653, for n = 100, 000. (These
are the estimates stated at the very beginning of this chapter.) . . END OF EXAMPLE IX.30. □
 IX.39. Quasi-Powers and large deviations. Under the Quasi-Powers assumption, it is usually
possible to convert the upperbound into an equality. This has been done by Hwang [272, 273,
274], who bases himself on a technique of Cram´er. Roughly, by shiting the mean, the main
Quasi-Powers Theorem can be applied at some u = u0 with u0 ̸= 1.

IX. 11. Non-Gaussian continuous limits
Previous sections of this chapter have developed two basic paradigms for bivariate
asymptotics (see also Figure 3):
— a “minor” singularity perturbation mode leading to discrete laws,
— a “major” singularity perturbation mode leading to continuous laws.
However, in both cases, the assumption has been made so far that the collection of sin-
gular expansions parameterized by the auxiliary variable all belong to a common ana-
lytic class and exhibit no sharp discontinuity when the secondary parameter traverses
the value u = 1. In this section we brieﬂy explore by means of examples the way dis-
continuities in singular behaviour induce no-Gaussian laws (Subsection IX. 11.1), then
conclude with a fairly general discussion of the critical composition schema (Subsec-
tion IX. 11.2), thereby completing the classiﬁcation of analytic composition schemes.
The discontuities observed in the cases discussed here are reminiscent of what is
known as phase transition phenomena in statistical physics, and we ﬁnd it suggestive
to borrow this terminology here.
IX. 11.1. Phase transition diagrams. Perhaps the simplest case of discontinuity
in singular behaviour is the already discussed BGF,
F(z, u) =
1
(1 −z)(1 −zu),
where u records the number of a’s in a random word of a⋆b⋆. The limit law is clearly
the continuous uniform distribution over the interval [0, 1]. From the point of view of
the singular structure of F(z, u), as a function of z, three distinct cases arise depending
on the values of u:
• u < 1: simple pole at ρ(u) = 1;
• u = 1: double pole at ρ(1) = 1;
• u > 1: simple pole at ρ(u) = 1/u.
Thus both the singularity location at ρ(u) and the singular exponent α(u) experience
a nonanalytic transition at u = 1. This arises from a “conﬂuence” of two singular
terms when u = 1.
To visualize such cases, it is useful to introduce a simpliﬁed diagram representa-
tion, called a phase transition diagram and deﬁned as follows. Write Z = ρ(u) −z
and reduce the singular expansion to its dominant singular term Zα(u). Then, the
diagram representing F(z, u) above is

IX. 11. NON-GAUSSIAN CONTINUOUS LIMITS
651
0.2
0
0.8
0.05
0.25
0.1
0.15
1
0.2
0.4
0.6
2
0.8
x
0.6
4
5
0.4
3
0.2
6
FIGURE IX.15.
Histograms of the distribution of the maximum of a random
walk for n = 10 . . 60 (left) and the density of the arcsine law (right).
u = 1 −ǫ
u = 1
u = 1 + ǫ
ρ(u) = 1
ρ(1) = 1
ρ(u) = 1/u
Z−1
Z−2
Z−1
A complete classiﬁcation of such conﬂuences and discontinuities is still lack-
ing (see however Marianne Durand’s thesis [142] for interesting fragments), and is
perhaps beyond reach given the vast diversity of situations encountered in a combina-
torialist’s practice.
EXAMPLE IX.31.
Arcsine law for unbiased random walks. This problem is studied in detail
by Feller [161, p. 94] who notes: “Contrary to intuition, the maximum accumulated gain is
much more likely to occur towards the very beginning or the very end of a coin-tossing game
than somewhere in the middle.” See Figure 15. In fact, if Xn is the time of the ﬁrst occurrence
of the maximum in a random game (walk with ±1 steps) of duration n, one has
P{Xn < xn} ∼2
π arcsin √x,
a distribution function with density
f(x) =
1
π
p
x(1 −x)
.
The BGF results from the standard decomposition of positive walks. Roughly, there is a
sequence of steps ascending to the (nonnegative) maximum accompanied by “arches” (the left
factor) followed by an excursion below than back to the maximum, followed by a sequence of
descending steps with their companion arches. This translates directly into an equation satisﬁed

652
IX. MULTIVARIATE ASYMPTOTICS
0.2
0.1
0
0.48
z
0.54
0.5
0.46
0.4
0.42
0.3
0.52
0.44
-0.1
-1
1.2
1
0.8
0.6
-0.5
u
1.2
1.1
1
0.9
0.8
0.46
0.7
0.6
0.5
0.42
0.48
0.5
0.44
0.4
FIGURE IX.16.
A plot of 1/F(z, u) for z ∈[0.4, 0.55] when u is assigned
values between 1
2 and 5
4 (left). The exponent function α(u) and the singular value
ρ(u) for u ∈[1/2, 3/2] (right).
by the BGF F(z, u) of the location of the ﬁrst maximum.
(64)
F(z, u)
=
1
1 −zuD(zu)
·
D(z)
·
1
1 −zD(z),
which involves the GF of gambler’s ruin sequences (Example 6),
D(z) = 1 −
√
1 −4z2
2z
.
In such a simple case, explicit expressions are available from (64), as it sufﬁces to expand ﬁrst
with respect to u, then to z. We obtain in this way the ultra-classical result:
Proposition IX.15 (Arc sine law). Set u2ν := 2−2ν`2ν
ν
´
. The probability that the ﬁrst maxi-
mum in a random walk of length n = 2ν occurs at k = 2ρ or k = 2ρ + 1 is 1
2u2ρu2ν−2ρ, for
0 < k < 2ν. For any x ∈(0, 1), the position Tn of the ﬁrst maximum satisﬁes
lim
n→∞Pn(Xn < xn) = 2
π arcsin √x.
(The asymptotic form reﬂects by summation that of u2ν since u2ν ∼(πnu)−1/2.)

IX. 11. NON-GAUSSIAN CONTINUOUS LIMITS
653
It is instructive to compare this to the way singularities evolve as u crosses the value 1.
The dominant positive singularity is at ρ(u) = 1/2 if u < 1, while ρ(u) = 1/(2u), if u > 1.
Local expansions show that, with c<(u), c(u) > two computable functions, there holds:
F(z, u) ∼c<(u)
1
√1 −2z ,
F(z, u) ∼c>(u)
1
√1 −2z .
Naturally, at u = 1, all words are counted and
F(z, 1) =
1
1 −2z .
Thus, the corresponding phase transition diagram is (see Figure 16):
u = 1 −ǫ
u = 1
u = 1 + ǫ
ρ(u) = 1
2
ρ(1) = 1
2
ρ(u) =
1
2u
Z−1/2
Z−1
Z−1/2
(Negative
singularities
have
a
smaller
weight
and
may
be
discarded.)
END OF EXAMPLE IX.31. □
In this particular case, elementary combinatorics yields the arcsine distribution
without the need of a recourse to singularities. The point to be made here is that
the arcsine law could be expected when a similar phase transition diagram occurs.
There is of course universality in this singular view of the arcsine law, which can be
extended to walks with zero drift (Chapter VII). This kind of universality is a parallel
to the universality of Brownian motion, which is otherwise familiar to probabilists.
 IX.40. Number of maxima and other stories. The construction underlying (64) also serves
to analyse; (i) the number of times the maximum is attained. (ii) the difference between the
maximum and the ﬁnal altitude of the walk; (iii) the duration of the period following the last
occurrence of the maximum.

EXAMPLE IX.32.
Path length in trees. A ﬁnal example is the distribution of path length
in trees, which has been studied by Louchard, Takacs and others [339, 340, 461, 462]. The
distribution is known not to be Gaussian as results from computation of the ﬁrst few moments.
In the case of general Catalan trees, the analysis reduces to that of the functional equation
F(z, u) =
1
1 −zF(zu, u).
This deﬁnes F(z, u) as a formal continued fraction, which suggests setting (cf Chapters III
and V as well as our discussion of coin fountains and polyomino models)
F(z, u) = A(z)
B(z),
the variable u being viewed as a parameter. From the basic functional equation, there results
A(z) = B(zu),
B(z) = B(zu) −zB(zu2).
The functional equation for B may now be solved by indeterminate coefﬁcients:
B(z) = 1 +
∞
X
n=1
(−1)n
un(n−1)zn
(1 −u)(1 −u2) · · · (1 −un).
Because of the quadratic exponents involved, the functions B(z) and F(z, u) have radius of
convergence 0 when u > 1, and are thus nonanalytic. In contrast, when u < 1, then B(z, u) is
an entire function of z, so that F(z, u) is meromorphic in z. Hence the singularity diagram:

654
IX. MULTIVARIATE ASYMPTOTICS
u = 1 −ǫ
u = 1
u = 1 + ǫ
ρ(u) > 1
4
ρ(1) = 1
4
ρ(u) = 0
Z−1
Z1/2
—
The limit law is the Airy area distribution, that is related to the Airy function [340, 339, 461,
462]. By an analytical tour de force, Prellberg [401] has developed a method based on cintegral
representations and oalescing saddle points (Chapter VIII) that permits us to extract the phase
transition diagram above, together with precise uniform asymptotic expansions. As similar
problems occur in relation to connectivity of random graphs [205], future years should see
more applications of Prellberg’s method. . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE IX.32. □
IX. 11.2. Semi-large powers, critical compositions, and stable laws. We con-
clude this section by a discussion of critical compositions that typically involve con-
ﬂuences of singularities and lead to a general class of continuous distributions closely
related to stable laws of probability theory. We start with an example where every-
thing is explicit, that of zero contacts in random bridges, then state a general theorem
on “semi-large” powers of functions of singularity analysis type, and ﬁnally discuss
combinatorial applications.
EXAMPLE IX.33. Zero-contacts in bridges. Consider once more ﬂuctuations in coin tossings,
and speciﬁcally bridges, corresponding to a conditioning of the game by the fact that the ﬁnal
gain is 0 (negative capitals are allowed). These are sequences of arbitrary positive or negative
“arches”, and the number of arches in a bridge is exactly equal to the number of intermedaite
steps at which the capital is 0. From the arch decomposition, theer results that the ordinary BGF
of bridges with z marking length and u marking zero-contacts is
B(z, u) =
1
1 −2uz2D(z).
Analysing this function is conveniently done by introducing
F(z, u) ≡B
„1
2
√z, u
«
=
1
1 −u(1 −√1 −z).
The phase transition diagram is then easily found to be:
u = 1 −ǫ
u = 1
u = 1 + ǫ
ρ(u) = 1
ρ(1) = 1
ρ(u) = 1 −(1 −u−1)2
Z1/2
Z−1/2
Z−1
Thus, there are discontinuities, both in the location of the singularity and the exponent. But
these are of a type different from what gave rise to the arcsine law of random walks.
The problem of the limit law is here easily solved since explicit expressions are provided
by the Lagrange Inversion Theorem. One ﬁnds:
[uk][zn]F(z, u)
=
[zn]
`
1 −
√
1 −z
´k
=
k
n[wn−k](2 −w)−n
=
2k−2n k
n
 
2n −k −1
n −1
!
.
Then Stirling’s formula provides:
Proposition IX.16. The number Xn of zero-contacts of a random bridge of size 2n satisﬁes,
as →∞the local limit law,
lim
n→∞P(Xn = x√n) =
x
2√ne−x2/4,

IX. 11. NON-GAUSSIAN CONTINUOUS LIMITS
655
0
0.2
0.4
0.6
0.8
0.5
1
1.5
2
2.5
x
0.1
0.2
0.3
0.4
0.5
0.6
0.7
–2
–1
0
1
2
x
FIGURE IX.17.
The G-functions for λ = 0.1 . .0.8 (left; from bottom to top)
and for λ = 1.2 . . 1.9 (right; from top to bottom); the thicker curves represent the
Rayleigh law (left, λ = 1
2) and the Airy law (right, λ = 3
2).
for x in any compact set of [0, +∞[.
A random variable with density and distribution function given by
(65)
r(x) = x
2 e−x2/4,
R(x) = 1 −ex2/4,
is called a Rayleigh law. Thus the number of zero contacts obeys a Rayleigh law in the asymp-
totic limit. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE IX.33. □
 IX.41. Cyclic points in mappings. The number of cyclic points in mappings has exponential
BGF (1 −uT(z))−1, with T the Cayley tree function. The singularity diagram is of the same
form as in Example 33. Explicit forms are available by Lagrange inversion, and the limit law is
again Rayleigh. (Note: This has been vastly generalized by Drmota and Soria [137, 138].) 
Both Example 33 and Note 41 exemplify the situation of an analytic composition
scheme of the form (1 −uf(z))−1 which is critical, since in each case f assumes
value 1 at its singularity. Both can be treated elementarily since they involve powers
that are amenable to Lagrange inversion, eventually resulting in a Rayleigh law. As
we now explain, there is a family of functions that appear to play a universal rˆole
in problems sharing such singular types. What follows is taken from an article by
Banderier et al. [22].
We ﬁrst introduce a function G that otherwise naturally surfaces in the study of
stable9 distributions in probability theory. For any parameter λ ∈(0, 2), deﬁne the
entire function
9In probability theory, stable laws are deﬁned as the possible limit laws of sums of independent iden-
tically distributed random variables. The function G is a trivial variant of the density of the stable law of
index λ; see Feller’s book [162, p. 581–583]. Valuable informations regarding stable laws may be found in
the books by Breiman [72, Sec. 9.8], Durett [143, Sec. 2.7], and Zolotarev [516].

656
IX. MULTIVARIATE ASYMPTOTICS
(66)
G(x, λ) :=









1
π
X
k≥1
(−1)k−1xk Γ(1 + λk)
Γ(1 + k) sin(πkλ)
(0 < λ < 1)
1
πx
X
k≥1
(−1)k−1xk Γ(1 + k/λ)
Γ(1 + k)
sin(πk/λ)
(1 < λ < 2)
The function G(x; 1
2) is a normalized variant of the Rayleigh distribution (65). The
function G(x; 3
2) constitutes the density of the “Airy map” distribution found in ran-
dom maps as well as in other colascence phenomena and discussed in detail below,
see (73).
Theorem IX.15 (Semi-large powers). The coefﬁcient of zn in a power H(z)k of a ∆-
continuable function H(z) with singular exponent λ admits the following asymptotic
estimates.
(i) For 0 < λ < 1, that is, H(z) = σ −hλ(1 −z/ρ)λ + O(1 −z/ρ), and when
k = xnλ, with x in any compact subinterval of (0, +∞), there holds
(67)
[zn]Hk(z) ∼σkρ−n 1
n G
xhλ
σ , λ

.
(ii) For 1 < λ < 2, that is, H(z) = σ −h1(1 −z/ρ) + hλ(1 −z/ρ)λ + O((1 −
z/ρ)2), when k =
σ
h1 n + xn1/λ, with x in any compact subinterval of (−∞, +∞),
there holds
(68)
[zn]Hk(z) ∼σkρ−n
1
n1/λ (h1/hλ)1/λG
 
xh1+1/λ
1
σh1/λ
λ
, λ
!
.
(iii) For λ > 2, a Gaussian approximation holds. In particular, for 2 < λ < 3,
that is, H(z) = σ −h1(1 −z/ρ) + h2(1 −z/ρ)2 −hλ(1 −z/ρ)λ + O((1 −z/ρ)3) ,
when k =
σ
h1 n + x√n, with x in any compact subinterval of (−∞, +∞), there holds
(69)
[zn]Hk(z) ∼σkρ−n 1
√n
σ/h1
a
√
2π e−x2/2a2
with a = 2( h2
h1 −h1
2σ)σ2/h2
1.
The term “semi-large” refers to the fact that the exponents k in case (i) are of the
form O(nθ) for some θ < 1 chosen in accordance with the region where an “interest-
ing” renormalization takes place and dependent on each particular singular exponent.
When the interesting region reaches the O(n) range in case (iii), the analysis of large
powers, as detailed in Chapter IX, starts to apply and Gaussian forms results.
PROOF. The proofs are somewhat similar to the basic ones in singularity analysis, but
they require a suitable adjustment of the geometry of the Hankel contour and of the
corresponding scaling.
Case (i). A classical Hankel contour, with the change of variable z = ρ(1−t/n),
yields the approximation
[zn]Hk(z) ∼−σkρ−n
2iπn
Z
et−
hλx
σ tλ dt

IX. 11. NON-GAUSSIAN CONTINUOUS LIMITS
657
The integral is then simply estimated by expanding exp(−hλx
σ tλ) and integrating
termwise
(70)
[zn]Hk(z) ∼−σkρ−n
n
X
k≥1
(−x)k
k!
hλ
σ
k
1
Γ(−λk) ,
which is equivalent to Equation (67), by virtue of the complement formula for the
Gamma function.
Case (ii). When 1 < λ < 2, the contour of integration in the z-plane is chosen
to be a positively oriented loop, made of two rays of angle π/(2λ) and −π/(2λ) that
intersect on the real axis at a distance 1/n1/λ left of the singularity. The coefﬁcient
integral of Hk is rescaled by setting z = ρ(1 −t/n1/λ), and one has
[zn]Hk(z) ∼−σkρ−n
2iπn1/λ
Z
e
hλ
h1 tλe−xh1
σ t dt.
There, the contour of integration in the t-plane comprises two rays of angle π/λ and
−π/λ, intersecting at −1. Setting u = tλhλ/h1, the contour transforms into a clas-
sical Hankel contour, starting from −∞over the real axis, winding about the origin,
and returning to −∞. So, with α = 1/λ, one has
[zn]Hk(z) ∼−σkρ−n
2iπnα α
 h1
hλ
α Z
eu e
−
xhα+1
1
σhα
λ
uα
uα−1 du .
Expanding the exponential, integrating termwise, and appealing to the complement
formula for the Gamma function ﬁnally reduces this last form to (68).
Case (iii). This case is only included here for comparison purposes, but, as
recalled before the proof, it is essentially implied by the developments of Chapter IX
based on the saddle point method. When 2 < λ < 3, the angle φ of the contour of
integration in the z–plane is chosen to be π/2, and the scaling is √n: under the change
of variable z = ρ(1 −t/√n), the contour is transformed into two rays of angle π/2
and −π/2 (i.e., a vertical line), intersecting at −1, and
[zn]Hk(z) ∼−σkρ−n
2iπ√n
Z
ept2−h1x
σ t dt ,
with p = h2
h1 −h1
2σ . Complementing the square, and letting u = t −h1x
2pσ , we get
[zn]Hk(z) ∼−σkρ−n
2iπ√ne−
h2
1
4pσ2 x2 Z
epu2 du ,
which gives Equation (69). By similar means, such a Gaussian approximation can be
shown to hold for any non-integral singular exponent λ > 2.
□
 IX.42. Zipf laws. Zipf’s law, named after the Harvard linguistic professor George Kingsley
Zipf (1902–1950), is the observation that, in a language like English, the frequency with which
a word occurs is roughly inversely proportional to its rank—the kth most frequent word has
frequency proportional to 1/k. The generalized Zipf distribution of parameter α > 1 is the law
of a variable Z such that
P(Z = k) =
1
ζ(α)
1
kα .
It has inﬁnite mean for α ≤2 and inﬁnite variance for α ≤3. It was proved in Chapter VI that
polylogarithms are amenable to singularity analysis. Consequently, the sum of a large number

658
IX. MULTIVARIATE ASYMPTOTICS
of independent Zipf variables satisﬁes a local limit law of the stable type with index α −1
(α ̸= 2).

EXAMPLE IX.34.
Mean level proﬁles of trees. Consider the depth of a random node in
a random tree taken from a simple variety Y that satisﬁes the usual analytic assumptions of
Chapter VII. The problem of quantifying this distribution is equivalent to that of determining
the mean level proﬁle, that is the sequence of numbers Mn,k representing the mean number of
nodes at distance k from the root. (The probability that a random node lies at level k is then
Mn,k/n.) The ﬁrst few levels have been characterized in Chapter VII, and the analysis of that
chapter can now be completed thanks to Theorem IX.15. The problem was solved by Meir
and Moon [356] in an important article that launched the analytic study of simple varieties of
trees. As usual, we let φ(w) be the generator of the simple variety Y, with Y (z) satisfying
Y = zφ(Y ), and we designate by τ the positive root of the characteristic equation:
τφ′(τ) −φ(τ) = 0.
It is known from Chapter VII that the GF Y (z) has a square root singularity at ρ = τ/φ(τ).
We also assume aperiodicity of φ. Then Meir and Moon’s major result (Theorem 4.3 of [356])
is as follows
Proposition IX.17 (Mean level proﬁles). The mean proﬁle of a large tree in a simple variety
obeys a Rayleigh law in the asymptotic limit: for k/√n in any bounded interval of R≥0, the
mean number of nodes at altitude k satisﬁes asymptotically
Mn,k ∼AkeAk2/(2n),
where A = τφ′′(τ).
(Note: Meir and Moon base their analysis on a Lagrangean change of variable and on the
saddle point method.)
PROOF. For each k, deﬁne Yk(z, u) to be the BGF with u marking the number of nodes at
depth k. Then, the root decomposition of trees translates into the recurrence:
Yk(z, u) = zφ(Yk−1(z, u)),
Y0(z, u) = zuφ(Y (z)) = uY (z).
By construction, we have
Mn,k = 1
Yn [zn]
„ ∂
∂uYk(z, u)
«
u=1
.
On the other hand, the fundamental recurrence yields
„ ∂
∂uYk(z, u)
«
u=1
=
`
zφ′(Y (z))
´k Y (z).
Now, φ′(Y ) has, like Y , a square root singularity. The semi-large powers theorem applies
with λ = 1
2, and the result follows.
□The same method of gives access to the
variance of the number of nodes at any depth k. The variance of the altitude of a random node
is also easily computed [356]. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . END OF EXAMPLE IX.34. □
 IX.43. The number of cyclic points in mappings. In the basic case of random mapping, we
are dealing with F(z, u) = (1 −uT(z))−1, and a Rayleigh law holds. This extends to the
number of cyclic points in a simple variety of mappings (e.g., mappings deﬁned by a ﬁnite
constraint on degrees).


IX. 11. NON-GAUSSIAN CONTINUOUS LIMITS
659
 IX.44. The width of trees. The expectation of the width W of a tree in a simple variety
satisﬁes
C1
√n ≤EYn(W ) ≤C2
p
n log n,
for some C1, C2 > 0. This is due to Odlyzko and Wilf [379] in 1987. (Better bounds are
now known, since Wn/√n has been later recognized to be related to Brownian excursion. In
particular, the expected width is ∼c√n.)

The results of Theorem IX.15 provide in addition useful information on compo-
sition schemas of the form
M(z, u) = C(uH(z)),
provided C and H are algebraic-logarithmic in the sense above. Combinatorially,
this represents a substitution between structures, M = C ◦H, and the coefﬁcient
[znuk]M(z, u) counts the number of M-structures of size n whose C-componnet,
also called core in what follows, has size k. Then the probability distribution of core-
size Xn in M-structures of size n is given by
P(Xn = k) =
[zk]C(z)
[zn]C(H(z)) [zn]H(z)k.
The case where the schema is critical, in the sense that H(rH) = rG with rH, rC
the radii of convergence of H, G, follows as a direct consequence of Theorem IX.15.
What comes out is the following informally stated general principle (details would
closely mimic the statement of Theorem IX.15 and are omitted).
Proposition IX.18 (Critical compositions). In a composition schema G(uH(z))
where H and G have singular exponents λ, λ′ with λ′ ≤λ:
(i) for 0 < λ < 1, the normalized core-size Xn/nλ is spread over (0, +∞)
and it satisﬁes a local limit law whose density involves the stable law of index λ; in
particular, λ = 1
2 corresponds to a Rayleigh law.
(ii) for 1 < λ < 2, the distribution of Xn is bimodal and the “large region”
Xn = cn + xn1/λ leads to a stable law of index λ;
(iii) for 2 < λ, the standardized version of Xn admits a local limit law that is of
Gaussian type.
Similar phenomena occur when λ′ > λ, but with a greater preponderance of
the “small” region. Many instances have already appeared scattered in the literature.
especially in connection with rooted trees. For instance, this proposition explains well
the occurrence of the Rayleigh law (λ =
1
2) as the distribution of cyclic points in
random mappings and of zero-contacts in random bridges. The case λ = 3/2 appears
in forests of unrooted trees (see the discussion in Chapter VIII for a complementary
approach based on coalescing saddle points) and it is ubiquitous in planar maps, as
attested by the article of Banderier et al. on which this subsection is largely based [22].
We detail one of the cases in the following example, which explains the meaning of
the term “large region” in Proposition IX.18.
EXAMPLE IX.35.
Biconnected cores of planar maps. The OGF of rooted planar maps, with
size determined by the number of edges, is by Chapter VII,
(71)
M(z) = −
1
54z2
“
1 −18z −(1 −12z)3/2”
,

660
IX. MULTIVARIATE ASYMPTOTICS
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
–4
–3
–2
–1
1
2
              x
0
0.0005
0.001
0.0015
0.002
0.0025
200
400
600
800
1000
k
FIGURE IX.18.
Left: The standard Airy distribution. Right: Observed frequen-
cies of core-sizes k ∈[20; 1000] in 50,000 random maps of size 2,000, showing
the bimodal character of the distribution.
with a characteristic 3
2 exponent. Deﬁne a separating vertex or articulation point in a map to
be a vertex whose removal disconnects the graph. Let C denote the class of nonseparable maps,
that is, maps without an articulation point (also known as biconnected maps). Starting from
the root edge, any map decomposes into a nonseparable map, called the “core” on which are
grafted arbitrary maps, as illustrated by the following diagram:
There results the equation:
(72)
M(z) = C(H(z)),
H(z) = z(1 + M(z))2.
This gives in passing the OGF of nonseparable maps as the algebraic function of degree 3
speciﬁed implicitly by the equation
C3 + 2C2 + (1 −18z)C + 27z2 −2z = 0,
with expansion at the origin (EIS A000139):
C(z) = 2 z + z2 + 2 z3 + 6 z4 + 22 z5 + 91 z6 + · · · ,
Ck = 2
(3k)!
(k + 1)!(2k + 1)!.
(The closed form results from a Lagrangean parameterization.) Now the singularity of C is also
of the Z3/2 type as seen by inversion of (72) or from the Newton diagram attached to the cubic
equation. We ﬁnd in particular
C(z) = 1
3 −4
9(1 −27z/4) + 8
√
3
81 (1 −27z/4)3/2 + O((1 −27z/4)2),
which is reﬂected by the asymptotic estimate,
Ck ∼2
27
√
3
π
„17
4
«k
k−5/2.

IX. 12. MULTIVARIATE LIMIT LAWS
661
The parameter considered here is the distribution of the size Xn of the core (containing
the root) in a random map of size n. The composition relation is M = C ◦H, where H =
Z(1 + M)2. The BGF is thus M(z, u) = C(uH(z)) where the composition C ◦H is of the
singular type Z3/2 ◦Z3/2. What is peculiar here is the “bimodal” caracter of the distribution
of core-size (see Figure 18 borrowed from [22]), which we now detail.
First straight singularity analysis shows that, for ﬁxed k,
P(Xn = k) = Ck [zn]H(z)k
Mn
∼
n→∞kCkhk−1
0
,
where h0 =
4
27 is the value of H(z) at its singularity. In other words, there is local convergence
of the probabilities to a ﬁxed discrete law. The estimate above can be proved to remain uniform
as long as k tends to inﬁnity sufﬁciently slowly. We shall call this the “small range” of k values.
Now, summing the probabilities associated to this small range gives the value C(h0) =
1
3.
Thus, one-third of the probability mass of core-size arises from the small range, where a discrete
limit law is observed.
The other part of the distribution constitutes the “large range” to which Theorem IX.15
applies. This contains asymptotically 2
3 of the probability mass of the distribution of Xn. In
that case, the limit law is given by a G(x; 3
2) law, also known as “map Airy” law and one ﬁnds
for k = 1
3n + xn2/3, the continuous local limit:
(73)
P(Xn) ∼1
3A(3
422/3x),
A(x) = 2e−2x2/3 `
x Ai(x2) −Ai′(x2)
´
.
There Ai(x) is the Airy function , and A(x) deﬁnes the map Airy distribution displayed in
Figure 18, a variant of the stable law of index 3
2. . . . . . . . . . . . . . END OF EXAMPLE IX.35. □
The bimodal character of the law can now be bettler understood following [22].
A random maps decomposes completely into biconnected components and the largest
biconnected component has, with high probability, a size that is O(n). There are also a
large number (O(n)) “dangling” biconnected components. In a rooted map, the root is
in a sense placed “at random”. Then, with a ﬁxed probability is either lies in the large
compoent (in which case, the distribution of that large component is observed, this is
the continuous part of the distribution given by the Airy map law), or else one of the
small components is picked up by the root (this is the discrete part of the distribution).
 IX.45. Critical cycles. The theory adapts to logarithmic factors. For instance the critical
composition F(z, u) = −log(1 −ug(z)) leads to developments similar to those of the critical
sequence. In this way, it becomes possible for instance to analyse the number of cyclic points
in a random connected mapping.

 IX.46. The base of supertrees. Supertrees deﬁned in Chapter VI are trees rooted on trees.
Here we consider the bicoloured variant K = G(2ZG), with G the class of general Catalan
trees. Then, the law of the external G-component is related to a stable law of index 1
4.

IX. 12. Multivariate limit laws
There exist natural extensions of continuity theorems, both for PGFs and for inte-
gral transforms. Consider for instance the joint distribution of the numbers χ1, χ2 of
singletons and doubletons in random permutations. Then, the parameter χ = (χ1, χ2)
has a trivariate EGF
F(z, u1, u2) = exp((u1 −1)z + (u2 −1)z2/2)
1 −z
.

662
IX. MULTIVARIATE ASYMPTOTICS
Thus, the bivariate PGF satisﬁes, by meromorphic analysis,
pn(u1, u2) = [zn]F(z, u1, u2) ∼e(u1−1) e(u2−1)/2.
The joint distribution of (χ1, χ2) is then a product of a Poisson(1) and a Poisson(1/2)
distribution; in particular χ1 and χ2 are asymptotically independent. Such a fact
results from an extension of the continuity theorem (Theorem IX.1) to multivariate
PGF’s that is proved by multiple Cauchy integration.
Consider next the joint distribution of χ = (χ1, χ2), where χj is the number of
j-summands in a random integer composition. Each parameter individually obeys a
limit Gaussian law, since the sequence construction is supercritical. The trivariate GF
is
F(z, u1, u2) =
1
1 −z(1 −z)−1 −(u1 −1)z −(u2 −1)z2 .
By meromorphic analysis, a higher dimensional quasi-power approximation may be
derived:
[zn]F(z, u1, u2) ∼c(u1, u2)ρ(u1, u2)−n,
for some 3rd degree algebraic function ρ(u1, u2). In such cases, multivariate versions
of the continuity theorem for integral transforms can be applied. See the book by Gne-
denko and Kolmogorov [237], and especially the treatment of Bender and Richmond
in [36]. As a result, the joint distribution is, in the asymptotic limit, a bivariate Gauss-
ian distribution. Such generalizations are typical and involve essentially no radically
new concept, just natural technical adaptations.
A highly interesting approach to multivariate problems is that of functional limit
theorems. There the goal is to characterize the joint distribution of a potentially in-
ﬁnite collections of parameters. The limit process is then a stochastic process. For
instance, the joint distribution of all altitudes in random walks gives rise to Brownian
motion. The joint distribution of all cycle lengths in random permutations is described
explicitly by Cauchy’s formula (Chapter III), and DeLaurentis and Pittel [115] have
also shown convergence to the standard Brownian motion process. A rather spec-
tacular application of this context of ideas was provided in 1977 by Logan, Shepp,
Vershik and Kerov [336, 485]. These authors show that the shape of the pair of Young
tableaux [302] associated to a random permutation conforms, in the asymptotic limit
and with high probability, to a deterministic trajectory deﬁned as the solution to a
variational problem. In particular, the width of a Young tableau associated to a per-
mutation gives the length of the longest increasing sequence of the permutation. By
specializing their results, the authors were able to show that the expected length in a
random permutation of size n is asymptotic to 2√n, a long standing conjecture at the
time.
IX. 13. Notes
This chapter is primarily inspired by the works of Bender and Richmond [28, 36,
37], Canﬁeld [76], Flajolet, Soria, and Drmota [134, 135, 137, 138, 210, 212, 443] as
well as Hwang [272].
Bender’s seminal paper [28] initiated the study of bivariate analytic schemes that
lead to Gaussian laws and the paper [28] may rightly be considered to be at the origin

IX. 13. NOTES
663
of the ﬁeld. Canﬁeld [76], building upon earlier works showed the approach to extend
to saddle point schemas.
Tangible progress was next made possible by the development of the singular-
ity analysis method [199]. Earlier works were mostly restricted to methods based on
subtraction of singularities, as in [28], which is in particular effective for meromor-
phic cases. The extension to algebraic–logarithmic singularities was however difﬁcult
given that the classical method of Darboux does not provide for uniform error terms.
In contrast, singularity analysis does apply to classes of analytic functions, since it al-
lows for uniformity of estimates. The papers by Flajolet and Soria [210, 212] were the
ﬁrst to make clear the impact of singularity analysis on bivariate asymptotics. Gao and
Richmond [226] were then able to extend the theory to cases where both a singularity
and its singular exponent are allowed to vary.
From there, Soria developed considerably the framework of schemas in her doc-
torate [443]. Hwang extracted the very important concept of “quasi-powers” in his
thesis [272] together with a wealth of properties like full asymptotic expansions,
speed of convergence, and large deviations. Drmota established general existence
conditions leading to Gaussian laws in the case of implicit, especially algebraic, func-
tions [134, 135]. The “singularity perturbation” framework for solutions of linear
differential equations ﬁrst appears under that name in [195]. The presentation in
this chapter is very liberally based on the survey paper [191]. Finally, the books
by Sachkov, see [420] and especially [422], offer a modern perspective on bivariate
asymptotics applied to classical combinatorial structures.
As pointed out in the introduction, the way combinatorial constructions induce
limit laws via schemas based on a purely local perturbation of a singular structure
is quite striking. Take for instance the principle that any ﬁxed pattern occurs almost
surely in a large random object and its number of occurrences is governed by Gaussian
ﬂuctuations. We have shown this property to hold true for strings, uniform tree models,
and search trees. In a context that involves either a rational function, an algebraic
function, or a solution to a nonlinear differential equation, it eventually reduces to a
very simple property, a singularity that smoothly moves. . .
I can see looming ahead one of those terrible exercises in probability where
six men have white hats and six men have black hats and you have to
work it out by mathematics how likely it is that the hats will get
mixed up and in what proportion. If you start thinking about
things like that, you would go round the bend. Let me assure you of that!
—AGATHA CHRISTIE
(The Mirror Crack’d. Toronto, Bantam Books, 1962.)


Part D
APPENDICES


APPENDIX A
Auxiliary Elementary Notions
This appendix contains entries arranged in alphabetical order regarding the following topics:
Arithmetical functions; Asymptotic Notations; Combinatorial probability; Cycle
construction; Formal power series; Lagrange Inversion; Regular languages; Stir-
ling numbers; Tree concepts.
The corresponding notions and results are used throughout the book, and in particular in Part A
relative to Symbolic Methods.
1. Arithmetical functions. A general reference for this section is Apostol’s book [12].
First, the Euler totient function ϕ(k) intervenes in the unlabelled cycle construction.
It is deﬁned as the number of integers in [1, k] that are relatively prime to k. Thus,
one has ϕ(p) = p −1 if p ∈{2, 3, 5, . . .} is a prime. More generally when the prime
number decomposition of k is k = pα1
1 · · · pαr
r , then
ϕ(k) = pα1−1
1
(p1 −1) · · · pαr
r (pr −1).
A number is squarefree if it is not divisible by the square of a prime. The M¨obius
function µ(n) is deﬁned to be 0 if n is not squarefree and otherwise is (−1)r if n =
p1 · · · pr is a product of r distinct primes.
Many elementary properties of arithmetical functions are easily established by
means of a Dirichlet generating functions (DGF). Let (an)n≥1 be a sequence; its
DGF formally deﬁned by
α(s) =
∞
X
n=1
an
ns .
In particular, the DGF of the sequence an = 1 is the Riemann zeta function, ζ(s) =
P
n≥1 n−s. The fact that every number uniquely decomposes into primes is reﬂected
by Euler’s formula,
(1)
ζ(s) =
Y
p∈P

1 −1
ps
−1
,
where p ranges over the set P of all primes. (As observed by Euler, the fact that
ζ(1) = ∞in conjunction with (1) provides a simple analytic proof that there are
inﬁnitely many primes! See Note IV.1, p. 215)
Equation (1) implies elementarily that
(2)
M(s) :=
X
n≥1
µ(n)
ns
=
Y
p∈P

1 −1
ps

=
1
ζ(s),
where µ(n) is the M¨obius coefﬁcient deﬁned above.
667

668
A. AUXILIARY ELEMENTARY NOTIONS
Finally, if (an), (bn), (cn) have DGF α(s), β(s), γ(s), then one has the equiva-
lence
α(s) = β(s)γ(s)
⇐⇒
an =
X
d | n
bdcn/d.
In particular, taking cn = 1 (γ(s) = ζ(s)) and solving for β(s) shows (using (2)) the
implication
an =
X
d | n
bd
⇐⇒
bn =
X
d | n
µ(d)an/d,
which is known as M¨obius inversion. This relation is used in the enumeration of
irreducible polynomials (Section I. 6.3).
2. Asymptotic Notations.
Let S be a set and s0 ∈S a particular element of S. We
assume a notion of neighbourhood to exist on S. Examples are S = Z>0∪{+∞} with
s0 = +∞, S = R with s0 any point in R, and S = C or a subset of C with s0 = 0,
and so on. Two functions φ and g from S \ {s0} to C are given.
— O–notation: write
φ(s) =
s→s0 O(g(s))
if the ratio φ(s)/g(s) stays bounded as s →s0 in S. In other words, there
exists a neighbourhood V of s0 and a constant C > 0 such that
|φ(s)| ≤C |g(s)| ,
s ∈V,
s ̸= s0.
One also says that “φ is of order at most g, or φ is big–Oh of g (as s tends
to s0)”.
— ∼–notation: write
φ(s) ∼
s→s0 g(s)
if the ratio φ(s)/g(s) tends to 1 as s →s0 in S. One also says that “φ and g
are asymptotically equivalent (as s tends to s0)”.
— o–notation: write
φ(s) =
s→s0 o(g(s))
if the ratio φ(s)/g(s) tends to 0 as s →s0 in S. In other words, for any
(arbitrarily small) ε > 0, there exists a neighbourhood Vε of s0 (depending
on ε), such that
|φ(s)| ≤ε |g(s)| ,
s ∈Vε,
s ̸= s0.
One also says that “φ is of order smaller than g, or φ is little–oh of g (as s
tends to s0)”.
These notations are due to Bachmann and Landau towards the end of the nineteenth
century. See Knuth’s note for a historical discussion [309, Ch. 4].
Related notations, of which however we only make scanty use, are
— Ω-notation: write
φ(s) =
s→s0 Ω(g(s))
if the ratio φ(s)/g(s) stays bounded from below in modulus by a nonzero
quantity, as s →s0 in S. One then says that φ is of order at least g.

A. AUXILIARY ELEMENTARY NOTIONS
669
— Θ-notation: write
φ(s) =
s→s0 Θ(g(s))
if φ(s) = O(s) and φ(s) = Ω(s). One then says that φ is of order exactly g.
For instance, one has as n →+∞in Z>0:
sin n = o(log n);
log n = O(√n);
log n = o(√n);
 n
2

= Ω(n√n);
πn + √n = Θ(n).
As x →1 in R≤1, one has
√
1 −x = o(1);
ex = O(sin x);
log x = Θ(x −1).
We take as granted in this book the elementary asymptotic calculus with such no-
tations (see, e.g., [434, Ch. 4] for a smooth introduction close to the needs of analytic
combinatorics and de Bruijn’s classic [111] for a beautiful presentation.). We shall
retain here in particular the fact that Taylor expansions imply asymptotic expansions;
for instance, the convergent expansions valid for |u| < 1,
log(1+u) =
∞
X
k=1
(−1)k
k
uk, exp(u) =
X
k≥0
1
k!uk, (1−u)−α =
X
k≥0
k + α −1
k

uk,
imply (as u →0)
log(1+u) = u+O(u2), exp(u) = 1+u+ u2
2 +O(u3), (1−u)1/2 = 1−u
2 +O(u2),
and, in turn, (as n →+∞)
log

1 + 1
n

= 1
n + O
 1
n2

,

1 −
1
log n
1/2
= 1 −
1
2 log n + o

1
log n

.
Two important asymptotic expansions are Stirling’s formula for factorials and the
harmonic number approximation, valid for n ≥1,
(3)
n!
=
nne−n√
2πn (1 + ǫn) ,
0 < ǫn <
1
12n
Hn
=
log n + γ + 1
2n −
1
12n2 + ηn
ηn = O
 n−4
,
γ .= 0.57721,
that are best established as consequences of the Euler–Maclaurin summation formula
(see [111, 434] as well as APPENDIX B: Mellin transform, p. 707).
Asymptotic scales. An important notion due to Henri Poincar´e is that of an as-
ymptotic scale. A sequence of functions ω0, ω1, . . . is said to constitute an asymptotic
scale if all functions ωj exist in a common neighbourhood of s0 ∈S and if they satisfy
there, for all j ≥0:
ωj+1(s) = o(ωj(s)),
i.e.,
lim
s→s0
ωj+1(s)
ωj(s)
= 0.
Examples at 0 are the scales: uj(x) = xj; v2j(x) = xj log x and v2j+1(x) = xj;
wj(x) = xj/2. Examples at inﬁnity are tj(n) = n−j, and so on. Given a scale
Φ = (ωj(s))j≥0, a function f is said to admit an asymptotic expansion in the scale Φ

670
A. AUXILIARY ELEMENTARY NOTIONS
if there exists a family of complex coefﬁcients (λj) (the family is then necessarily
unique) such that, for each integer m:
(4)
f(s) =
m
X
j=0
λjωj(s) + O(ωm+1(s))
(s →s0).
In this case, one writes
(5)
f(s) ∼
∞
X
j=0
λjωj(s),
(s →s0)
with an extension of the symbol ‘∼’. (Some authors prefer the notation ‘≈”.) The
scale may be ﬁnite and in most cases, we do not need to specify it as it clear from
context. For instance, one can write
Hn ∼log n + γ +
1
12n,
tan x ∼x + 1
3x3 + 2
15x5.
In the ﬁrst case, it is understood that n →∞and the scale is log n, 1, n−1, n−2, . . . .
In the second case, x →0 and the scale is x, x3, x5, . . . . Note that in the case of an
inﬁnite expansion, convergence of the inﬁnite sum is not implied in (5): the relation is
to be interpreted literaly in the sense of (4) as a collection of more and more precise
descriptions of f as s becomes closer and closer to s0.
 I.1. Simpliﬁcation rules for the asymptotic calculus. Some of them are
O(λf)
−→
O(f)
(λ ̸= 0)
O(f) ± O(g)
−→
O(|f| + |g|)
−→
O(f)
if g = O(f)
O(f · g)
−→
O(f)O(g).
Similar rules apply for o(·).

 I.2. Harmonics of harmonics. The harmonic numbers are readily extended to non-integral
index by (cf also the ψ function p. 692)
Hx :=
∞
X
k=1
„ 1
k −
1
k + x
«
.
For instance, H1/2 = 2 −2 log 2. This extension is related to the Gamma function [492], and it
can be proved that the asymptotic estimate (3), with x replacing n, remains valid as x →+∞.
A typical asymptotic calculation shows that
HHn = log log n + γ + γ + 1
2
log n + O
„
1
log2 n
«
.
What is the shape of an asymptotic expansion of HHHn ?


A. AUXILIARY ELEMENTARY NOTIONS
671
 I.3. Stackings of dominos. A stock of dominos of length 1cm is given. It is well known that
one can stack up dominos in a harmonic mode:
1/2
1/3
1/4
Estimate within 1% the minimal number of dominos needed to achieve a horizontal span of
1m (=100cm). [Hint: about 1.50926 1043 dominos!] Set up a scheme to evaluate this integer
exactly, and do it!

 I.4. High precision fraud. Why is it that, to forty decimal places, one ﬁnds
4
500,000
X
k=1
(−1)k−1
2k −1
.=
3.141590653589793240462643383269502884197
π
.=
3.141592653589793238462643383279502884197,
with only four “wrong” digits in the ﬁrst sum? (Hint: consider the simpler problem
1
9801
.= 0.00 01 02 03 04 05 06 07 08 09 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 · · · .)
Many fascinating facts of this kind are found in works by Jon and Peter Borwein [63, 64]. 
Uniform asymptotic expansions. The notions previously introduced admit of
uniform versions in the case of families dependent on a secondary parameter [111,
pp. 7–9]. Let {fu(s)}u∈U be a family of functions indexed by U. An asymptotic
equivalence like
fu(s) = O (g(s))
(s →s0),
is said to be uniform with respect to u if there exists an absolute constant K (indepen-
dent of u ∈U) and a ﬁxed neighbourhood V of s0 such that
∀u ∈U, ∀s ∈V :
|fu(s)| ≤K|g(s)|.
This deﬁnition in turn gives rise to the notion of a uniform asymptotic expansion: it
sufﬁces that, for each m, the O error term in (4) be uniform in the sense above. Such
notions are central for the determination of limit laws in Chapter IX, where a uniform
expansion of a class of generating functions near a singularity is usually required.
 I.5. Examples of uniform asymptotics. One has uniformly, for u ∈R and u ∈[0, 1] respec-
tively:
sin(ux)
=
x→∞O(1),
„
1 + 1
n
«u
=
n→∞1 + u
n + O
„ 1
n2
«
.
However, the second expansion no longer holds uniformly with respect to u when u ∈R (take
u = ±n), though it holds pointwise (non-uniformly) for any ﬁxed u ∈R. What about the
assertion
„
1 + 1
n
«u
=
n→∞1 + u
n + O
„u2
n2
«
for u ∈R?

3. Combinatorial probability. This entry gathers elementary concepts from proba-
bility theory specialized to the discrete case and used in Chapter III. A more elaborate
discussion of probability theory forms the subject of Appendix C.

672
A. AUXILIARY ELEMENTARY NOTIONS
Given a ﬁnite set S, the uniform probability measure assigns to any σ ∈S the
probability mass
P(σ) =
1
card(S).
The probability of any set, also known as event, E ⊆S, is then measured by
P{E} := card(E)
card(S) =
X
σ∈E
P(σ)
(“the number of favorable cases over the total number of cases”).
Given a combinatorial class A, we make extensive use of this notion with the
choice of S = An. This deﬁnes a probability model (indexed by n), in which of ele-
ments of the size n in A are taken with equal likelihood. For this uniform probabilistic
model, we write
Pn
and
PAn,
whenever the size and the type of combinatorial structure considered need to be em-
phasized.
Next consider a parameter χ, which is a function from S to Z≥0. We regard such
a parameter as a random variable, determined by its probability distribution,
P(χ = k) = card ({σ | χ(σ) = k})
card(S)
.
The notions above extend gracefully to nonuniform probability models that are deter-
mined by a family of nonnegative numbers (pσ)σ∈S which add up to 1:
P(σ) = pσ,
P(E) :=
X
σ∈E
pσ,
P(χ = k) =
X
χ(σ)=k
pσ.
Moments. An important information on a distribution is provided by its moments.
We state here the deﬁnitions for an arbitrary discrete random variable supported by Z
and determined by its probability distribution, P(X = k) = pk where the (pk)k∈Z
are nonnegative numbers that add up to 1. The expectation of f(X) is deﬁned as the
linear functional
E(f(X)) =
X
k
P{X = k} · f(k).
In particular, the (power) moment of order r is deﬁned as the expectation:
E(Xr) =
X
k
P{X = k} · kr.
Of special importance are the ﬁrst two moments of the random variable X. The
expectation (also mean or average) E(X) is
E(X) =
X
k
P{X = k} · k.
The second moment E(X2) gives rise to the variance,
V(X) = E
 (X −E(X))2
= E(X2) −E(X)2,

A. AUXILIARY ELEMENTARY NOTIONS
673
and, in turn, to the standard deviation
σ(X) =
p
V(X).
The mean deserves its name as ﬁrst observed by Galileo Galilei (1564–1642): if a large
number of draws are effected and values of X are observed, then the arithmetical mean
of the observed values will normally be close to the expectation E(X). The standard
deviation measures in a mean quadratic sense the dispersion of values around the
expectation E(X).
 I.6. The weak law of large numbers.
Let (Xk) be a sequence of mutually independent
random variables with a common distribution. If the expectation µ = E(Xk) exists, then for
every ǫ:
lim
n→∞P
„˛˛˛˛
1
n(X1 + · · · + Xn) −µ
˛˛˛˛ > ǫ
«
= 0.
(See [161, Ch X] for a proof.) Note that the property does not require ﬁnite variance.

Probability generating function. The probability generating function (PGF) of
X is by deﬁnition:
p(u) :=
X
k
P(X = k)uk,
and an alternative expression is pn(u) = E(uX). Moments can be recovered from the
PGF by differentiation at 1, for instance:
E(X) = d
dup(u)

u=1
,
E(X(X −1)) = d2
du2 p(u)

u=1
.
More generally, the quantity,
E(X(X −1) · · · (X −k + 1)) =
dk
duk p(u)

u=1
,
is known as the kth factorial moment.
 I.7. Relations between factorial and power moments. Let X be a discrete random variable
with PGF p(u); denote by µr = E(Xr) its rth moment and by φr its factorial moment. One
has
µr = ∂r
t p(et)
˛˛
t=0 ,
φr = ∂r
up(u)|u=1 .
Consequently, with
˘n
k
¯
and
ˆn
k
˜
the Stirling numbers of both kinds (APPENDIX A: Stirling
numbers, p. 680),
φr =
X
j
(−1)r−j
"
r
j
#
µj;
µr =
X
j
(
r
j
)
φj.
(Hint: for φr →µr, expand the Stirling polynomial deﬁned in (12) below; in the converse
direction, write p(et) = p(1 + (et −1)).)


674
A. AUXILIARY ELEMENTARY NOTIONS
Markov-Chebyshev inequalities. These are fundamental inequalities that apply
equally well to discrete and to continuous random variables (see Appendix C for the
latter).
Theorem A.1 (Markov-Chebyshev inequalities). Let X be a nonnegative random
variable and Y an arbitrary real random variable. One has for an arbitrary t > 0:
P {X ≥tE(X)}
≤
1
t
(Markov inequality)
P {|Y −E(Y )| ≥tσ(Y )}
≤
1
t2
(Chebyshev inequality).
PROOF. Without loss of generality, one may assume that x has been scaled in such
a way that E(X) = 1. Deﬁne the function f(x) whose value is 1 if x ≥t, and 0
otherwise. Then
P{X ≥t} = E(f(X)).
Since f(x) ≤x/t, the expectation on the right is less than 1/t. Markov’s inequality
follows. Chebyshev’s inequality then results from Markov’s inequality applied to X =
|Y −E(Y )|2.
□
Theorem A.1 informs us that the probability of being much larger than the mean
must decay (Markov) and that an upperbound on the decay is measured in units given
by the standard deviation (Chebyshev).
Moment inequalities are discussed for instance in Billingsley’s reference trea-
tise [55, p. 74]. They are of great importance in discrete mathematics where they
have been put to use in order to show the existence of surprising conﬁgurations. This
ﬁeld was pioneered by Erd˝os and is often known as the “probabilistic method” [in
combinatorics]; see the book by Alon and Spencer [9] for many examples. Moment
inequalities can also be used to estimate the probabilities of complex events by reduc-
ing the problems to moment estimates for occurrences of simpler conﬁgurations—this
is one of the bases of the “ﬁrst and second moment methods”, again pioneered by
Erd˝os, which are central in the theory of random graphs [60, 283]. Finally, moment
inequalities serve to design, analyse, and optimize randomized algorithms, a theme
excellently covered in the book by Motwani and Raghavan [370].
4. Cycle construction. The unlabelled cycle construction is introduced in Chapter I
and is classically obtained within the framework of P´olya theory [98, 395, 397]. The
derivation given here is based on an elementary use of symbolic methods that fol-
lows [211]. It relies on bivariate GF’s developed in Chapter III, with z marking size
and u marking the number of components. Consider a class A and the sequence class
S = SEQ≥1(A). A sequence σ ∈S is primitive (or aperiodic) if it is not the repetition
of another sequence (e.g., αββαα is primitive, but αβαβ = (αβ)2 is not). The class
PS of primitive sequences is determined implicitly,
S(z, u) ≡
uA(z)
1 −uA(z) =
X
k≥1
PS(zk, uk),

A. AUXILIARY ELEMENTARY NOTIONS
675
which expresses that every sequence possesses a “root” that is primitive. M¨obius
inversion then gives
PS(z, u) =
X
k≥1
µ(k)S(zk, uk) =
X
k≥1
µ(k)
ukA(zk)
1 −ukA(zk).
A cycle is primitive if all of its linear representations are primitive. There is an
exact one-to-ℓcorrespondence between primitive ℓ-cycles and primitive ℓ-sequences.
Thus, the BGF PC(z, u) of primitive cycles is obtained by effecting the transforma-
tion uℓ7→1
ℓuℓon PS(z, u), which means
PC(z, u) =
Z u
0
P(z, v) dv
v ,
giving after term-wise integration,
PC(z, u) =
X
k≥1
µ(k)
k
log
1
1 −ukA(zk).
Finally, cycles can be composed from arbitrary repetitions of primitive cycles
(each cycle has a primitive “root”), which yields for C = CYC(A):
C(z, u) =
X
k≥1
PC(zk, uk).
The arithmetical identity P
d | k µ(d)/d = ϕ(k)/k gives eventually
(6)
C(z, u) =
X
k≥1
ϕ(k)
k
log
1
1 −ukA(zk).
Formula (6) specializes to the one that appears in the translation of the cycle
construction in the unlabelled case (Theorem I.1), upon setting u = 1; this formula
also coincides the statement of Proposition III.5 regarding the number of components
in cycles, and it yields the general multivariate version (Theorem III.1) by a simple
adaptation of the argument.
 I.8. Around the cycle construction. Similar methods yield the BGFs of multisets of cycles
and multisets of aperiodic cycles as
Y
k≥1
1
1 −ukA(zk)
and
1
1 −uA(z),
respectively [112]. (The latter fact corresponds to the property that any word can be written
as a decreasing product of Lyndon words. Notably, it serves to construct bases of free Lie
algebras [337, Ch. 5].)

 I.9. Aperiodic words. An aperiodic word is a primitive sequence of letters. The number of
aperiodic words of length n over an m-ary alphabet corresponds to primitive sequences with
A(z) = mz and is
PW (m)
n
=
X
d | n
µ(d)mn/d.
For m = 2, the sequence starts as 2, 2, 6, 12, 30, 54, 126, 240, 504, 990 (EIS A027375).


676
A. AUXILIARY ELEMENTARY NOTIONS
5. Formal power series. Formal power series extend the usual operations on polyno-
mials to inﬁnite series of the form
(7)
f =
X
n≥0
fnzn,
where z is a formal indeterminate. The notation f(z) is also employed. Let K be a
ring of coefﬁcients (usually we shall take one of the ﬁelds Q, R, C); the ring of formal
power series is denoted by K[[z]] and it is the set KN (of inﬁnite sequences of elements
of K) written as inﬁnite power series (7) and endowed with the operations of sum and
product,
 X
n
fnzn
!
+
 X
n
gnzn
!
:=
X
n
(fn + gn) zn
 X
n
fnzn
!
×
 X
n
gnzn
!
:=
X
n
 n
X
k=0
fkgn−k
!
zn.
A topology, known as the formal topology, is put on K[[z]] by which two se-
ries f, g are “close” if they coincide to a large number terms. First, the valuation of
a formal power series f = P
n fnzn is the smallest r such that fr ̸= 0 and is de-
noted by val(f). (One sets val(0) = +∞.) Given two power series f and g, their
distance d(f, g) is then deﬁned as 2−val(f−g). With this distance (in fact an ultramet-
ric distance), the space of all formal power series becomes a complete metric space.
Roughly, the limit of a sequence of series {f (j)} exists if, for each n, the coefﬁcient
of order n in f (j) eventually stabilizes to a ﬁxed value as j →∞. In this way formal
convergence can be deﬁned for inﬁnite sums: it sufﬁces that the general term of the
sum should tend to 0 in the formal topology, i.e., the valuation of the general term
should tend to ∞. Similarly for inﬁnite products, where Q(1 + u(j)) converges as
soon as u(j) tends to 0 in the topology of formal power series.
It is then a simple exercise to prove that the sum Q(f) := P
k≥0 f k exists (the
sum convergerges in the formal topology) whenever f0 = 0; the quantity then de-
ﬁnes the quasi-inverse written (1 −f)−1, with the implied properties with respect to
multiplication (namely, Q(f)(1 −f) = 1). In the same way one deﬁnes formally
logarithms and exponentials, primitives and derivatives, etc. Also, the composition
f ◦g is deﬁned whenever g0 = 0 by substitution of formal power series. More gen-
erally, any (possibly inﬁnitary) process on series that involves at each coefﬁcient only
ﬁnitely many operations is well-deﬁned and is accordingly a continuous functional in
the formal topology.
 I.10. The OGF of permutations. The ordinary generating function of permutations,
P(z) :=
∞
X
n=0
n!zn = 1 + z + 2z2 + 6z3 + 24z4 + 120z5 + 720z6 + 5040z7 + · · ·
exists as an element of C[[z]], although the series has radius of convergence 0. The quantity
1/P(z) is for instance well-deﬁned (via the quasi-inverse) and one can compute legitimately
and effectively 1−1/P(z) whose coefﬁcients enumerate indecomposable permutations (p. 82).
The formal series P(z) can even be made sense of analytically as an asymptotic series (Euler),

A. AUXILIARY ELEMENTARY NOTIONS
677
since
Z ∞
0
e−t
1 + tz dt ∼1 −z + 2!z2 −3!z3 + 4!z4 −· · ·
(z →0+).
Thus, the OGF of permutations is also representable as the (formal, divergent) asymptotic series
associated to an integral.

It can be proved that the usual functional properties of analysis extend to formal
power series provided they make sense formally. The extension to multivariate formal
power series follows along entirely similar lines.
6. Lagrange Inversion. Lagrange inversion (Lagrange, 1770) relates the coefﬁcients
of the inverse of a function to coefﬁcients of the powers of the function itself. It
thus establishes a fundamental correspondence between functional composition and
standard multiplication of series. Although the proof is technically simple, the result
is altogether non-elementary.
The inversion problem z = h(y) is solved by the Lagrange series given below. It
is assumed that [y0]h(z) = 0, so that inversion is formally well deﬁned and analyt-
ically local, and [y1]h(y) ̸= 0. The problem is is then conveniently standardized by
setting h(y) = y/φ(y).
Theorem A.2. Let φ(u) = P
k≥0 φkuk be a power series of C[[z]] with φ0 ̸= 0.
Then, the equation y = zφ(y) admits a unique solution in C[[z]] whose coefﬁcients
are given by (Lagrange form)
(8)
y(z) =
∞
X
n=1
ynzn,
where
yn = 1
n [un−1] φ(u)n.
Furthermore, one has for k > 0 (B¨urmann form)
(9)
y(z)k =
∞
X
n=1
y(k)
n zn,
where
y(k)
n
= k
n [un−k] φ(u)n.
By linearity, a form equivalent to Burmann’s (9), with H an arbitrary function, is
[zn]H(y(z)) = 1
n[un−1] (H′(u)φ(u)n) .
PROOF. The method of indeterminates coefﬁcients provides a system of polynomial
equations for {yn} that is seen to admit a unique solution:
y1 = φ0,
y2 = φ0φ1,
y3 = φ0φ2
1 + φ2
0φ2, . . . .
Since yn only depends polynomially on the coefﬁcients of φ(u) till order n, one may
assume without loss of generality, in order to establish (8) and (9) that φ is a poly-
nomial. Then, by general properties of analytic functions, y(z) is analytic at 0 (see
Chapter IV and APPENDIX B: Equivalent deﬁnitions of analyticity, p. 687 for def-
initions) and it maps conformally a neighborhood of 0 into another neighbourhood
of 0. Accordingly, the quantity nyn = [zn−1]y′(z) can be estimated by Cauchy’s

678
A. AUXILIARY ELEMENTARY NOTIONS
coefﬁcient formula:
(10)
nyn
=
1
2iπ
Z
0+
y′(z) dz
zn
(Direct coefﬁcient formula for y′(z))
=
1
2iπ
Z
0+
dy
(y/φ(y))n
(Change of variable z 7→y)
=
[yn−1] φ(y)n
(Reverse coefﬁcient formula for φ(y)n).
In the context of complex analysis, this useful result appears as nothing but an avatar
of the change-of-variable formula. The proof of B¨urmann’s form is similar.
□
There exist instructive (but longer) combinatorial proofs based on what is known
as the “cyclic lemma” or “conjugacy principle” [407] for Łukasiewicz words. (See
also Note 44 in Chapter I.) Another classical proof due to Henrici relies on properties
of iteration matrices [266, §1.9]; see also Comtet’s book for related formulations [98].
Lagrange inversion serves most notably to develop explicit formulæ for simple
families of trees (Chapters I and II), random mappings (Chapter II), and more gener-
ally for problems involving coefﬁcients of powers of functions.
 I.11. Lagrange–B¨urmann inversion for fractional powers. The formula
[zn]
„y(z)
z
«α
=
α
n + α[un]φ(u)n+α
holds for any real or complex exponent α, and hence generalizes B¨urmann’s form. One can
similarly expand log(y(z)/z).

 I.12. Abel’s identity. By computing in two different ways the coefﬁcient
[zn]e(α+β)y = [zn]eαy · eβy,
where y = zey is the Cayley tree function, one derives Abel’s identity
(α + β)(n + α + β)n−1 = αβ
n
X
k=0
 
n
k
!
(k + α)k−1(n −k + β)n−k−1.

7. Regular languages. A language is a set of words over some ﬁxed alphabet A. The
structurally simplest (yet nontrivial) languages are the regular languages that, as as-
serted on p. 54, can be deﬁned in a variety of equivalent ways (see [3, Ch. 3] or [149]):
by regular expressions, either ambiguous or not, and by ﬁnite automata, either deter-
ministic or nondeterministic. Our deﬁnitions of S-regularity (S as in speciﬁcation)
and A-regularity (A as in automaton) from Chapter I correspond to deﬁnability by
unambiguous regular expression and deterministic automaton, respectively.
Regular expressions and ambiguity. Here is ﬁrst the classical deﬁnition of a
regular language in formal language theory.
Deﬁnition A.1. The category RegExp of regular expressions is deﬁned inductively
by the property that it contains all the letters of the alphabet (a ∈A) as well as the
empty symbol ǫ, and is such that, if R1, R2 ∈RegExp, then the formal expressions
R1 ∪R2, R1 · R2 and R⋆
1 are regular expressions.
Regular expressions are meant to denote languages. The language L(R) asso-
ciated to R is obtained by interpreting ‘∪’ as set-theoretic union, ‘·’ as catenation
product extended to sets and ‘⋆’ as the star operation: L(R⋆) := {ǫ} ∪L(R) ∪

A. AUXILIARY ELEMENTARY NOTIONS
679
(L(R) · L(R)) ∪· · · . These operations rely on set-theoretic operations and place no
condition on multiplicities (a word may be obtained in several different ways). Ac-
cordingly, the notions of a regular expression and a regular language are useful when
studying structural properties of languages, but they must be adapted for enumeration
purposes, where unambiguous speciﬁcations are needed.
A word w ∈L(R) may be parsable in several ways according to R: the ambiguity
coefﬁcient (or multiplicity) of w with respect to the regular expression R is deﬁned1
as the number of parsings and written κ(w) = κR(w).
A regular expression R is said to be unambiguous if for all w, we have κR(w) ∈
{0, 1}, ambiguous otherwise. In the unambiguous case, if L = L(R), then L is S-
regular in the sense of Chapter I, a speciﬁcation being obtained by the translation
rules:
(11)
∪7→+,
· 7→×,
( )⋆7→SEQ,
and the translation mechanism afforded by Proposition I.2 p. 48 applies. (Use of the
general mechanism (11) in the ambiguous case would imply that we enumerate words
with multiplicity (ambiguity) coefﬁcients taken into account.)
A-regularity implies S-regularity. This construction is due to Kleene [294]
whose interest had its origin in the formal expressive power of nerve nets. Within
the classical framework of the theory of regular languages, it produces from an au-
tomaton (possibly nondeterministic) a regular expression (possibly ambiguous).
For our purposes, let a deterministic automaton a be given, with alphabet A, set
of states Q, with q0 and Q the initial state and the set of ﬁnal states respectively.
The idea consists in constructing inductively the family of languages L(r)
i,j of words
that connect state qi to state qj passing only through states q0, . . . , qr in between qi
and qj. We initialize the data with L(−1)
i,j
to be the singleton set {a} if the transition
(qi ◦a) = qj exists, and the emptyset (∅) otherwise. The fundamental recursion
L(r)
i,j = L(r−1)
i,j
+ L(r−1)
i,r
SEQ(S){L(r−1)
r,r
}L(r−1)
r,j
,
incrementally takes into account the possibility of traversing the “new” state qr. (The
unions are clearly disjoint and the segmentation of words according to passages
through state qr is unambiguously deﬁned, hence the validity of the sequence con-
struction.) The language L accepted by a is then given by the regular speciﬁcation
L =
X
qj∈Q
L||Q||
0,j ,
that describes the set of all words leading from the initial state q0 to any of the ﬁnal
states while passing freely through any intermediate state of the automaton.
1 For instance if R = (a ∪aa)⋆and w = aaaa, then κ(w) = 5 corresponding to the ﬁve parsings:
a · a · a · a, a · a · aa, a · aa · a, aa · a · a, aa · aa.

680
A. AUXILIARY ELEMENTARY NOTIONS
S-regularity
≡
Unambiguous
RegExp
−→
General
RegExp
↑K
↓I
A-regularity
≡
Deterministic
FA
RS
←−
Nondeterministic
FA
FIGURE I.1. Equivalence between various notions of regularity: K is Kleene’s construc-
tion; RS is Rabin-Scott’s reduction; I is the inductive construction of the text.
S-regularity implies A-regularity. An object described by a regular speciﬁcation
r can be ﬁrst encoded as a word, with separators indicating the way the word should be
parsed unambiguously. These encodings are then describable by a regular expression
using the correspondenceof (11). Next any language described by a regular expression
is recognizable by an automaton (possibly nondeterministic) as shown by an inductive
construction. (We only state the principles informally here.) Let →• r •→represent
symbolically the automaton recognizing the regular expression r, with the initial state
on the left and the ﬁnal state(s) on the right. Then, the rules are schematically
→• r + s •→
=
ր
ց
→• r •→
→• s •→
→• r × s •→
=
→• r •→→• s •→
→• r⋆•→
=
↓→• r •→↑.
Finally, a standard result of the theory, the Rabin-Scott theorem, asserts that any non-
deterministic ﬁnite automaton can be emulated by a deterministic one. (Note: this
general reduction produces a deterministic automaton whose set of states is the pow-
erset of the set of states of the original automaton; it may consequently involve an
exponential blow-up in the size of descriptions.)
8. Stirling numbers.. These numbers count amongst the most famous ones of com-
binatorial analysis. They appear in two kinds:
• the Stirling cycle number (also called ‘of the ﬁrst kind’)
n
k

enumerates
permutations of size n having k cycles;
• the Stirling partition number (also called ‘of the second kind’)
n
k
	
enumer-
ates partitions of an n-set into k nonempty equivalence classes.
The notations
n
k

and
n
k
	
proposed by Knuth (himself anticipated by Karamata) are
nowadays most widespread; see [248].
The most natural way to deﬁne Stirling numbers is in terms of the “vertical” EGFs
when the value of k is kept ﬁxed:
X
n≥0
n
k
zn
n!
=
1
k!

log
1
1 −z
k
X
n≥0
n
k
zn
n!
=
1
k! (ez −1)k .

A. AUXILIARY ELEMENTARY NOTIONS
681
From there, the bivariate EGFs follow straightforwardly:
X
n,k≥0
n
k

uk zn
n!
=
exp

u log
1
1 −z

= (1 −z)−u
X
n,k≥0
n
k

uk zn
n!
=
exp (u(ez −1)) .
Stirling numbers and their cognates satisfy a host of algebraic relations. For in-
stance, the differential relations of the EGFs imply recurrences reminiscent of the
binomial recurrence
n
k

=
n −1
k −1

+ (n −1)
n −1
k

,
n
k

=
n −1
k −1

+ k
n −1
k

.
By expanding the powers in the vertical EGF of the Stirling partition numbers or by
techniques akin to Lagrange inversion, one ﬁnds explicit forms
n
k

=
X
0≤j≤h≤n−k
(−1)j+h
h
j
n −1 + h
n −k + h
 2n −k
n −k −h
(h −j)n−k+h
h!
n
k

=
1
k!
r
X
j=0
k
j

(−1)j(k −j)n.
Though comforting, these forms are not too useful in general. (The one relative to
Stirling cycle numbers was obtained by Schl¨omilch in 1852 [98, p. 216].)
A more important relation is that of the generating polynomials of the
n
r

for
ﬁxed n,
(12)
Pn(u) ≡
n
X
r=0
n
r

ur = u · (u + 1) · (u + 2) · · · (u + n −1).
This nicely parallels the OGF for the
n
r
	
for ﬁxed r
∞
X
n=0
n
r

zn =
zr
(1 −z)(1 −2z) · · ·(1 −kz).
 I.13. Schl¨omilch’s formula. It is established starting from
k!
n!
"
n
k
#
=
1
2iπ
I
logk
1
1 −z
dz
zn+1 ,
via the change of variable a la Lagrange: z = 1 −e−t. See [98, p.216] and [202].

9. Tree concepts. In the abstract graph-theoretic sense, a forest is an acyclic (undi-
rected) graph and a tree is a forest that consists of just one connected component. A
rooted tree is a tree in which a speciﬁc node is distinguished, the root. Rooted trees
are drawn with the root either below (the mathematician’s and botanists’s convention)
or on top (the genealogist’s and computer scientist’s convention), and in this book, we

682
A. AUXILIARY ELEMENTARY NOTIONS
employ both conventions indifferently. Here are then two planar representations of the
same rooted tree
(13)
a∗
b
c
d
e
f
g
h
i
j
k
l
a∗
b
d
j
e
k
l
f
i
g
h
c
where the star distinguishes the root. (Tags on nodes, a, b, c, etc, are not part of the tree
structure but only meant to discriminate nodes here.) A tree whose nodes are labelled
by distinct integers then becomes a labelled tree, this in the precise technical sense of
Chapter II. Size is deﬁned by the number of nodes (vertices). Here is for instance a
labelled tree of size 9:
(14)
5
9
6
4
3
8
1
7
2
In a rooted tree, the outdegree of a node is the number of its descendants; with the
sole exception of the root, outdeegree is thus equal to degree (in the graph-theoretic
sense, i.e., the number of neighbours) minus 1. Once this convention is clear, one
usually abbreviates “outdegree” by “degree” when speaking of rooted trees. A leaf is
a node without descendant, that is, a node of (out)degree equal to 0. For instance the
tree in (14) has 5 leaves. Non-leaf nodes are also called internal nodes.
Many applications from genealogy to computer science require superimposing
an additional structure on a graph-theoretic tree. A plane tree (sometimes also called
a planar tree) is deﬁned as a tree in which subtrees dangling from a common node
are ordered between themselves and represented from left to right in order. Thus, the
two representations in (13) are equivalent as graph-theoretic trees, but they become
distinct objects when regarded as plane trees.
Binary trees play a special role in combinatorics. These are rooted trees in which
every nonleaf node has degree 2 exactly as, for instance, in the ﬁrst two drawings
below:

A. AUXILIARY ELEMENTARY NOTIONS
683
In the second case, the leaves have been distinguished by ‘2’. The pruned binary tree
(third representation) is obtained from a regular binary tree by removing the leaves. A
binary tree can be fully reconstructed from its pruned version, and a tree of size 2n+1
always expands a pruned tree of size n.
A few major classes are encountered throughout this book. Here is a summary2.
General plane trees (Catalan trees)
G = Z × SEQ{G}
(unlabelled)
Binary trees
A = Z + (Z × A × A)
(unlabelled)
Nonempty pruned binary trees
B = Z + 2(Z × B) + (Z × B × B)
(unlabelled)
Pruned binary trees
C = 1 + (Z × B × B)
(unlabelled)
General nonplane trees (Cayley trees)
T = Z × SET{T }
(labelled)
The corresponding GFs are respectively
G(z) = 1 −√1 −4z
2
,
A(z) = 1 −
√
1 −4z2
2z
,
B(z) = 1 −2z −√1 −4z
2z
,
C(z) = 1 −√1 −4z
2z
,
T (z) = zeT (z),
being respectively of type OGF for the ﬁrst four and EGF for the last one. The corre-
sponding counts are
Gn = 1
n
2n −2
n −1

,
A2ν+1 =
1
ν + 1
2ν
ν

,
Bn =
1
n + 1
2n
n

(n ≥1),
Cn =
1
n + 1
2n
n

,
Tn = nn−1.
The common occurrence of the Catalan numbers, (Cn = Bn = A2n+1 = Gn+1) is
explained by pruning and by the rotation correspondence described on p. 69.
2 The term “general” refers to the fact that no degree constraint is imposed.


APPENDIX B
Basic Complex Analysis
This appendix contains entries arranged in alphabetical order regarding the following topics:
Algebraic elimination; Equivalent deﬁnitions of analyticity; Gamma function; Holo-
nomic functions; Implicit Function Theorem; Laplace’s method; Mellin transform;
Several complex variables.
The corresponding notions and results are used in particular starting with Part B, which is
relative to Complex Asymptotics.
1. Algebraic elimination.
Auxiliary quantities can be eliminated from systems of
polynomial equations. In essence, elimination is achieved by suitable combinations of
the equations themselves. One of the best strategies is based on Gr¨obner bases and is
presented in the excellent book of Cox, Little, and O’Shea [104]. This entry develops
a more elementary approach based on resultants.
Resultants. Consider a ﬁeld of coefﬁcients K which may be specialized as
Q, C, C(z), . . ., as the need arises. A polynomial of degree d in K[x] has at most
d roots in K and exactly d roots in the algebraic closure ¯K of K. Given two polyno-
mials,
P(x) =
ℓ
X
j=0
ajxℓ−j,
Q(x) =
m
X
k=0
bkxm−k,
their resultant (with respect to the variable x) is the determinant of order (ℓ+ m),
(1)
R(P, Q, x) = det

a0
a1
a2
· · ·
0
0
0
a0
a1
· · ·
0
0
...
...
...
...
...
...
0
0
0
· · ·
aℓ−1
aℓ
b0
b1
b2
· · ·
0
0
0
b0
b1
· · ·
0
0
...
...
...
...
...
...
0
0
0
· · ·
bm−1
bm

,
also called the Sylvester determinant. By its deﬁnition, the resultant is a polynomial
form in the coefﬁcients of P and Q. The main property of resultants is the follow-
ing: (i) If P(x), Q(x) ∈K[x] have a common root in the algebraic closure ¯K of K,
then R(P(x), Q(x), x) = 0. (ii) Conversely, if R(P(x), Q(x), x) = 0 holds, then
either a0 = b0 = 0 or else P(x), Q(x) have a common root in ¯K. [The idea of the
proof of (i) is as follows. Let S be the matrix in (1). Then the homogeneous linear
system Sw = 0 admits a solution w = (ξℓ+m−1, . . . , ξ2, ξ, 1) where ξ is a common
root of P and Q; this is only possible if det(S) ≡R vanishes.] See especially van
der Waerden’s crips treatment in [480] and Lang’s treatise [327, V.10] for a detailed
presentation of resultants
685

686
B. BASIC COMPLEX ANALYSIS
Equating the resultant to 0 thus provides a necessary condition for the existence
of common roots, but not always a sufﬁcient one. This has implications in situations
where the coefﬁcients aj, bk depend on one or several parameters. In that case, the
condition R(P, Q, x) = 0 will certainly capture all the situations where P and Q have
a common root, but it may also include some situations where there is a reduction in
degree, although the polynomials have no common root. For instance, take P(x) =
tx −2 and Q(x) = tx2 −4 (with t a parameter); the resultant with respect to x is
found to be
R = 4t(1 −t).
Indeed, the condition R = 0 corresponds to either a common root (t = 1 for which
P(2) = Q(2) = 0) or to some degeneracy in degree (t = 0 for which P(x) = −2 and
Q(x) = −4 have no common zero).
Systems of equations. Given a system
(2)
{Pj(z, y1, y2, . . . , ym) = 0},
j = 1 . . m,
deﬁning an algebraic curve, we can then proceed as follows in order to extract a sin-
gle equation satisﬁed by one of the indeterminates. By taking resultants with Pm,
eliminate all occurrences of the variable ym from the ﬁrst m −1 equations, thereby
obtaining a new system of m −1 equations in m −1 variables (with z kept as a pa-
rameter, so that the base ﬁeld is C(z)). Repeat the process and successively eliminate
ym−1, . . . , y2. The strategy (in the simpler case where variables are eliminated in
succession exactly one at a time) is summarized in the skeletton procedure Eliminate:
procedure Eliminate (P1, . . . , Pm, y1, y2, . . . ym);
{Elimination of y2, . . . , ym by resultants}
(A1, . . . , Am) := (P1, . . . , Pm);
for j from m by −1 to 2 do
for k from j −1 by −1 to 1 do
Ak := R(Ak, Aj, yj);
return(A1).
The polynomials obtained need not be minimal, in which case, one should appeal
to multivariate polynomial factorization in order to select the relevant factors at each
stage. (Groebner bases provide a neater alternative to these questions, see [104].)
Computer algebra systems usually provide implementations of both resultants and
Groebner bases. The complexity of elimination is however exponential in the worst-
case: degrees essentially multiply, which is somewhat intrinsic as y0 in the quadratic
system of k equations
y0 −z −yk = 0, yk −y2
k−1 = 0, . . . , y1 −y2
0 = 0
(determining the OGF of regular trees of degree 2k) represents an algebraic function
of degree 2k and no less.
 II.1. Resultant and roots. Let P, Q ∈C[x] have sets of roots {αj} and {βk} respectively.
Then
R(P, Q, x) = aℓ
0bm
0
ℓ
Y
i=1
m
Y
j=1
(αi −βj) = aℓ
0
m
Y
i=1
Q(αi).

B. BASIC COMPLEX ANALYSIS
687
The discriminant of P classically deﬁned by D(P) := a−1
0
R(P(x), P ′(x), x) satisﬁes
D(P) ≡a−1
0
R(P(x), P ′(x), x) = a2ℓ−2
0
Y
i̸=j
(αi −αj).
Given the coefﬁcients of P and the value of D(P), there results an effectively computable
bound on the minimal separation distance δ between any two roots of P.
[Hint.
Let
A = 1 + maxj(|aj/a0|).
Then each αj satisﬁes |αj| < mA.
Set L =
`ℓ
2
´
.
Then
δ ≥|a0|2−2ℓ|D(P)|(2A)L−1.]

2. Equivalent deﬁnitions of analyticity. Two parallel notions are introduced at the
beginning of Chapter IV: analyticity (deﬁned by power series expansions) and holo-
morphy (deﬁned as complex differentiability). As is known from any textbook on
complex analysis, these notions are equivalent. Given their importance for analytic
combinatorics, this appendix entry sketches a proof of the equivalence, which is sum-
marized by the following diagram:
Analyticity
[A]
−→
←−
[C]
C-differentiability
↓[B]
Null integral Property
A. Analyticity implies complex-differentiability. Let f(z) be analytic in the disc
D(z0; R). We may assume without loss of generality that z0 = 0 and R = 1 (else
effect a linear transformation on the argument z). According to the deﬁnition of ana-
lyticity, the series representation
(3)
f(z) =
∞
X
n=0
fnzn,
converges for all z with |z| < 1. Elementary series rearrangements ﬁrst entail that
f(z) given by this representation is analytic at any z1 interior to D(0; 1). Similar
techniques then show the existence of the derivative as well as the fact that the deriv-
ative can be obtained by term-wise differentiation of (3).
 II.2. Proof of [A]: Analyticity implies differentiability. First, formally, the binomial theorem
provides
(4)
f(z)
=
X
n≥0
fnzn
=
X
n≥0
fn(z1 + z −z1)n
=
X
n≥0
n
X
k=0
 
n
k
!
fnzk
1(z −z1)n−k
=
X
m≥0
cm(z −z1)m,
cm :=
X
k≥0
 
m + k
k
!
fm+kzk
1.
Let r1 be any number smaller than 1 −|z1|. We observe that (4) makes analytic sense. Indeed,
one has the bound |fn| ≤CAn, valid for any A > 1 and some C > 0. Thus, the terms in (4)
are dominated in absolute value by those of the double series
(5)
X
n≥0
n
X
k=0
 
n
k
!
CAn|z1|krn−k
1
= C
X
n≥0
An(|z1| + r1)n =
C
1 −A(|z1| + r1),
which is absolutely convergent as soon as A is chosen such that A < (|z1| + r1)−1.

688
B. BASIC COMPLEX ANALYSIS
Complex differentiability of at any z1 ∈D(0; 1) derives from the analogous calculation,
valid for small enough δ,
(6)
1
δ (f(z1 + δ) −f(z1)))
=
X
n≥0
nfnzn−1
1
+ δ
X
n≥0
n
X
k=2
 
n
k
!
fnzk
1δn−k−2
=
X
n≥0
nfnzn−1
1
+ O(δ),
where boundedness of the coefﬁcient of δ results from an argument analogous to (5).

The argument of Note 2 has shown that the derivative of f at z1 is obtained by
differentiating termwise the series representing f. More generally derivatives of all
orders exist and can be obtained in a similar fashion. In view of this fact, the equalities
of (4) can also be interpreted as the Taylor expansion (by grouping terms according to
values of k ﬁrst):
(7)
f(z1 + δ) = f(z1) + δf ′(z1) + δ2
2! f ′′(z1) + · · · ,
which is thus generally valid for analytic functions.
B. Complex differentiability implies the “Null Integral” Property. The Null Inte-
gral Property relative to a domain Ωis the property:
Z
λ
f = 0
for any loop λ ⊂Ω.
(A loop is a closed path that can be contracted to a single point in the domain Ω, cf
Chapter IV). Its proof results simply from the Cauchy-Riemann equations and from
Green’s formula.
 II.3. Proof of [B]: the Null Integral Property. This starts from the Cauchy–Riemann equa-
tions. Let P(x, y) = ℜf(x + iy) and Q(x, y) = ℑf(x + iy). By adopting successively in the
deﬁnition of complex differentiability δ = h and δ = ih, one ﬁnds P ′
x + iQ′
x = Q′
y −iP ′
y,
implying
(8)
∂P
∂x = ∂Q
∂y
and
∂P
∂y = −∂Q
∂x ,
known as the Cauchy–Riemann equations. (The functions P and Q satisfy the partial differ-
ential equations ∆f = 0, where ∆is the 2-dimensional Laplacian ∆:=
∂2
∂x2 +
∂2
∂y2 ; such
functions are known as harmonic functions.)
The Null Integral Property, given differentiabil-
ity, results from the Cauchy–Riemann equations, upon taking into account Green’s theorem of
multivariate calculus,
Z
∂K
Adx + Bdy =
Z Z
K
„∂B
∂x −∂A
∂y
«
dx dy,
which is valid for any (compact) domain K enclosed by a simple curve ∂K.

C. Complex differentiability implies analyticity. The starting point is the formula
(9)
f(a) =
1
2iπ
Z
γ
f(z)
z −a dz,
knowing only differentiability of f and its consequence, the Null Integral Property
(but precisely not postulating the existence of an analytic expansion). There γ is a
simple positive loop encircling a inside a region where f is analytic.

B. BASIC COMPLEX ANALYSIS
689
 II.4. Proof of [C]: the integral representation. The proof of (9) is obtained by decomposing
f(z) in the original integral as f(z) = f(z) −f(a) + f(a). Deﬁne accordingly
g(z) =

f(z)−f(a)
z−a
for
z ̸= a
f ′(a)
for
z = a.
By the differentiability assumption, g is continuous and holomorphic (differentiable) at any
point other than a. Its integral is thus 0 along γ. On the other hand, we have
Z
γ
1
z −a dz = 2iπ,
by a simple computation: deform γ to a small circle along a and evaluate the integral directly
by setting z −a = reiθ.

Once (9) is granted, it sufﬁces to write, e.g., for an expansion at 0,
f(z)
=
1
2iπ
Z
γ
f(t)
dt
t −z
=
1
2iπ
Z
γ
f(t)

1 + z
t + z2
t2 + · · ·
 dt
t
=
X
n≥0
fnzn,
fn :=
1
2iπ
Z
γ
f(t)
dt
tn+1 .
(Exchanges of integration and summation are justiﬁed by normal convergence.) An-
alyticity is thus proved from complex-differentiability and its consequence the Null
Integral Property.
 II.5. Cauchy’s formula for derivatives. One has
f (n)(a) = n!
2iπ
Z
γ
f(z)
(z −a)n+1 dz.
This follows from (9) by differentiation under the integral sign.

 II.6. Morera’s Theorem. Suppose that f is continuous [but not a priori known to be differ-
entiable] in an open set Ωand that its integral along any triangle in Ωis 0. Then, f is analytic
(hence holomorphic) in Ω. [For a proof, see, e.g, [402, p. 68].]

3. Gamma function. The formulæ of singularity analysis in Chapter IV involve the
Gamma function in an essential manner. The Gamma function extends to nonintegral
arguments the factorial function and we collect in this appendix a few classical facts
regarding it. Proofs may be found in classic treatises like Henrici’s [265] or Whittaker
and Watson’s [492].
Basic properties. Euler introduced the Gamma function as
(10)
Γ(s) =
Z ∞
0
e−tts−1 dt,
where the integral converges provided ℜ(s) > 0. Through integration by parts, one
immediately derives the basic functional equation of the Gamma function,
(11)
Γ(s + 1) = sΓ(s).

690
B. BASIC COMPLEX ANALYSIS
s
0
4
2
0
-2
-4
y
0
6
4
2
0
-2
-4
-6
FIGURE II.1.
A plot of Γ(s) for real s.
Since Γ(1) = 1, one has Γ(n + 1) = n!, so that the Gamma function serves to
extend the factorial function for nonintegral arguments. For combinatorial purposes,
the special value,
(12)
Γ
1
2

:=
Z ∞
0
e−t dt
√
t = 2
Z ∞
0
e−x2 dx = √π,
proves to be quite important. It implies in turn Γ(−1
2) = −2√π.
From (11), the Gamma function can be analytically continued to the whole of C
with the exception of poles at 0, −1, −2, . . .. The functional equation used backwards
yields
Γ(s) ∼(−1)m
m!
1
s + m
(s →−m) ,
so that the residue of Γ(s) at s = −m is (−1)m/m!. Figure 1 depicts the graph of
Γ(s) for real values of s.
 II.7. Evaluation of the Gaussian integral.
Deﬁne J :=
R ∞
0
e−x2 dx. The idea is to
evaluate J2:
J2 =
Z ∞
0
Z ∞
0
e−(x2+y2) dxdy.
Going to polar coordinates, (x2 + y2)1/2 = ρ, x = ρ cos θ, y = ρ sin θ yields, via the standard
change of variables formula:
J2 =
Z ∞
0
Z
π
2
0
e−ρ2 ρdρdθ.
The equality J2 = π/4 results.

Hankel contour representation. Euler’s integral representation of Γ(s) used in
conjunction with the functional equation permits us to continue Γ(s) to the whole of
the complex plane. A direct approach due to Hankel provides an alternative integral
representation valid for all values of s.

B. BASIC COMPLEX ANALYSIS
691
Theorem B.1 (Hankel’s contour integral). Let
R (0)
+∞denote an integral taken along
a contour starting at +∞in the upper plane, winding counterclockwise around the
origin, and proceeding towards +∞in the lower half plane. Then, for all s ∈C,
(13)
1
π sin(πs)Γ(1 −s) =
1
Γ(s) = −1
2iπ
Z (0)
+∞
(−t)−se−t dt.
In (13), (−t)−s is assumed to have its principal determination when t is negative real,
and this determination is then extended uniquely by continuity throughout the contour.
The integral then closely resembles the deﬁnition of Γ(1 −s). The ﬁrst form of (13)
can also be rewritten as
1
Γ(s), by virtue of the complement formula given below.
 II.8. Proof of Hankel’s representation. We refer to volume 2 of Henrici’s book [265, p. 35]
or Whittaker and Watson’s treatise [492, p. 245] for a detailed proof.
A contour of integration that fulﬁlls the conditions of the theorem is typically the contour
H that is at distance 1 of the positive real axis comprising three parts: a line parallel to the
positive real axis in the upper half–plane; a connecting semi–circle centered at the origin; a line
parallel to the positive real axis in the lower half–plane. More precisely, H = H−∪H+ ∪H◦,
where
(14)
8
<
:
H−
=
{z = w −i, w ≥0}
H+
=
{z = w + i, w ≥0}
H◦
=
{z = −eiφ, φ ∈[−π
2 , π
2 ]}.
Let ǫ be a small positive real number, and denote by ǫ · H the image of H by the trans-
formation z 7→ǫz. By analyticity, for the integral representation, we can equally well adopt as
integration path the contour ǫ · H, for any ǫ > 0. The main idea is then to let ǫ tend to 0.
Assume momentarily that s < 0. (The extension to arbitrary s then follows by analytic
continuation.) The integral along ǫ · H decomposes into three parts:
The integral along the semi–circle is 0 if we take the circle of a vanishing small
radius, since −s > 0.
The contributions from the upper and lower lines give, as ǫ →0
Z (0)
+∞
(−t)−se−t dt = (−U + L)
Z ∞
0
t−se−t dt
where U and L denote the determinations of (−1)−s on the half-lines lying in the
upper and lower half planes respectively.
By continuity of determinations, U = (e−iπ)−s and L = (e+iπ)−s. Therefore, the right hand
side of (13) is equal to
−(−eiπs + e−iπs)
2iπ
Γ(1 −s) = sin(πs)
π
Γ(1 −s),
which completes the proof of the theorem.

Expansions. The Gamma function has poles at the nonpositive integers but has
no zeros. Accordingly, 1/Γ(s) is an entire function with zeros at 0, −1, . . ., and the
position of the zeros is reﬂected by the product decomposition,
(15)
1
Γ(s) = seγs
∞
Y
n=1
h
(1 + s
n)e−s/ni
(of the so–called Weierstraß type). There γ = 0.57721 denotes Euler’s constant
γ = lim
n→∞(Hn −log n) ≡
∞
X
n=1
 1
n −log(1 + 1
n)

.

692
B. BASIC COMPLEX ANALYSIS
The logarithmic derivative of the Gamma function is classically known as the psi
function and is denoted by ψ(s):
ψ(s) := d
ds log Γ(s) = Γ′(s)
Γ(s) .
In accordance with (15), ψ(s) admits a partial fraction decomposition
(16)
ψ(s + 1) = −γ −
∞
X
n=1

1
n + s −1
n

.
From (16), there results that the Taylor expansion of ψ(s + 1), hence of Γ(s + 1),
involves values of the Riemann zeta function,
ζ(s) =
∞
X
n=1
1
ns ,
at the positive integers: for |s| < 1,
ψ(s + 1) = −γ +
∞
X
n=2
(−1)nζ(n)sn−1.
so that the coefﬁcients in the expansion of Γ(s) around any integer are polynomi-
ally expressible in terms of Euler’s constant γ and values of the zeta function at the
integers. For instance, as s →0,
Γ(s + 1) = 1 −γ s +
π2
12 + γ2
2

s2 +

−ζ(3)
3
−π2γ
12 −γ3
6

s3 + O(s4).
Another direct consequence of the inﬁnite product formulæ for Γ(s) and sin πs is
the complement formula for the Gamma function,
(17)
Γ(s)Γ(−s) = −
π
s sin πs,
which directly results from the factorization of the sine function (due to Euler),
sin s = s
∞
Y
n=1

1 −
s2
n2π2

.
In particular, Equation (17) gives back the special value (cf (12)): Γ( 1
2) = √π.
 II.9. The duplication formula. This is
22s−1Γ(s)Γ(s + 1
2) = π1/2Γ(2s),
which provides the expansion of Γ near 1/2:
Γ(s + 1
2) = π1/2 −(γ + 2 log 2) π1/2s +
„π5/2
4
+ (γ + 2 log 2)2 π1/2
2
«
s2 + O(s3).
The coefﬁcients now involve log 2 as well as zeta values.

Finally, a famous and absolutely fundamental asymptotic formula is Stirling’s
approximation, familiarly known as “Stirling’s formula”:
Γ(s + 1) = sΓ(s) ∼sse−s√
2πs

1 +
1
12s +
1
288s2 −
139
51840s3 + · · ·

.

B. BASIC COMPLEX ANALYSIS
693
It is valid for (large) real s > 0, and more generally for all s →∞in | Arg(s)| < π−δ
(any δ > 0). For the purpose of obtaining effective bounds, the following quantitative
relation [492, p. 253] often proves useful,
Γ(s + 1) = sse−s(2πs)1/2eθ/(12s),
where 0 < θ ≡θ(s) < 1,
an equality that holds now for all s ≥1. Stirling’s formula is usually proved by
appealing to the method of Laplace applied to the integral representation for Γ(s +
1), see APPENDIX B: Laplace’s method, p. 700, or by Euler-Maclaurin summation
(Note 10). It is derived by different means in APPENDIX B: Mellin transform, p. 707.
 II.10. Stirling’s formula via Euler-Maclaurin summation. Stirling’s formula can be derived
from Euler–Maclaurin summation applied to log Γ(s). [See: [248, Sec. 9.6].]

 II.11. The Eulerian Beta function. It is deﬁned for ℜ(p), ℜ(q) > 0 by any of the following
integrals,
B(p, q) :=
Z 1
0
xp−1(1 −x)q−1 dx =
Z ∞
0
yp−1
(1 + y)p+q dy = 2
Z
π
2
0
cos2p−1 θ sin2q−1 θ dθ,
where the last form is known as a Wallis integral. It satisﬁes:
B(p, q) = Γ(p)Γ(q)
Γ(p + q) .
[See [492, p. 254] for a proof generalizing that of Note 7.]

4. Holonomic functions. Doron Zeilberger [513] has introduced discrete mathemati-
cians to a powerful framework, the holonomic framework, which takes its roots in
classical differential algebra [58, 102] and has found innumerable applications in the
theory of special functions and symbolic computation [393], combinatorial identi-
ties, and combinatorial enumeration. In these pages, we can only offer a (too) brief
orientation tour of this wonderful theory. Major contributions in the perspective of
Analytic Combinatorics are due to Stanley [446], Zeilberger [513], Gessel [234], and
Lipshitz [334, 335]. As we shall see there is a chain of growing generality and power,
rational
→
algebraic
→
holonomic.
The associated asymptotic problems are examined in Subsection VII. 9.1, p. 493.
Univariate holonomic functions. Holonomic fuctions1 are solutions of linear
differential equations or systems whose coefﬁcients are rational functions. The uni-
variate theory is elementary.
Deﬁnition B.1. A formal power series (or function) f(z) is said to be holonomic if it
satisﬁes a linear differential equation,
(18)
c0(z) dr
dzr f(z) + c1(z) dr−1
dzr−1 f(z) + · · · + cr(z)f(z) = 0,
where the coefﬁcients cj(z) lie in the ﬁeld C(z) of rational functions. Equivalently,
f(z) is holonomic if the vector space over C(z) spanned by the set of all its derivatives
{∂jf(z)}∞
j=0 is ﬁnite dimensional.
1A synonymous name is ∂-ﬁnite or D-ﬁnite.

694
B. BASIC COMPLEX ANALYSIS
By clearing denominators, we can assume, if needed, the quantities cj(z) in (18)
to be polynomials.
It then follows that the coefﬁcient sequence (fn) of a holo-
nomic f(z) satisﬁes a recurrence,
(19)
bcs(n)fn+s + bcs−1(n)fn+s−1 + · · · + bc0(n)fn = 0,
for some polynomials bcj(n), provided n ≥n0 (some n0). Such a recurrence (19) is
known as a P-recurrence. (The two properties of sequences, to be the coefﬁcients of
a holonomic function and to be P-recursive, are equivalent.)
Functions like ez, log z, cos(z), arcsin(z), √1 + z, and Li2(z) := P
n≥1 zn/n2
are holonomic. Formal power series like P zn/(n!)2 and P n!zn are holonomic.
Sequences like
1
n+1
 2n
n

, 2n/(n2 + 1) are coefﬁcients of holonomic functions and are
P-recursive. However, sequences like √n, log n are not P-recursive, a fact that can be
proved by an examination of singularities2 of associated generating functions [182].
For similar reasons, tan z and sec z that have inﬁnitely many singularities are not
holonomic.
Holonomic functions enjoy a rich set of closure properties. Deﬁne the Hadamard
product of two functions h = f ⊙g to be the termwise product of series: [zn]h(z) =
([zn]f(z)) · ([zn]g(z)). We have:
Theorem B.2 (Univariate holonomic closure). The class of univariate holonomic
functions is closed under the following operations: sum (+), product (×), Hadamard
product (⊙), differentiation (∂z), indeﬁnite integration (
R z), and algebraic substitu-
tion (z 7→y(z) for some algebraic function y(z)).
PROOF.
An exercise in vector space manipulations.
For instance, let VS(∂⋆f)
be the vector space over C(z) spanned by the {∂j
zf}.
If h = f + g (or h =
f · g), then VS(∂⋆h) is ﬁnite dimensional since it is included in the direct sum
VS(∂⋆f) ⊕VS(∂⋆g) (respectively the tensor product VS(∂⋆f) ⊗VS(∂⋆g)). For
Hadamard products, if hn = fngn, then a system of P-recurrences can be obtained
for the quantities h(i,j)
n
= fn+ign+j from the recurrences satisﬁed by fn, gn, and
then a single P-recurrence can be obtained. Closure under algebraic substitution re-
sults from the methods of Note 12. See Stanley’s historic paper [446] and the book
chapter [449, Ch. 6] for details.
□
 II.12. Algebraic functions are holonomic. Let y(z) satisfy P(z, y(z)) = 0, with P a poly-
nomial. Any nondegenerate rational fraction Q(z, y(z)) can be expressed as a polynomial
in y(z) with coefﬁcients in C(z). [Proof: let D be the denominator of Q; the Bezout relation
AP −BD = 1 (in C(x)[y]), obtained by a gcd calculation between polynomials (in y), ex-
presses 1/D as a polynomial in y.] Then, all derivatives of y live in the space spanned over
C(z) by 1, y, . . . , yd−1, with d = degy P(z, y). (The fact that algebraic functions are holo-
nomic was known to Abel, and an algorithm has been described in recent times by Comtet [97].)
The closure under algebraic substitutions (y 7→y(z)) asserted in Theorem B.2 can be estab-
lished along similar lines.

Zeilberger observed that holonomic functions with coefﬁcients in Q can be spec-
iﬁed by a ﬁnite amount of information. Equality is this subclass is then decidable:
2Singularities of holonomic functions, and more generally of solutions to meromorphic differential
equations are studied in Subection VII. 9.1, p. 493.

B. BASIC COMPLEX ANALYSIS
695
Algorithm Z: Decide whether two holonomic functions A(z), B(z) are equal
Let Σ, T be holonomic descriptions of A, B (by equations or systems);
Compute a holonomic differential equation Υ for h := A −B;
(Or simply determine an upperbound e on the order of Υ.)
Output ‘equal’ iff h(0) = h′(0) = · · · = h(e−1)(0) = 0, with e the order of Υ.
The book titled “A = B” by Petkovˇsek, Wilf, and Zeilberger [393] abundantly il-
lustrates this method to combinatorial and special function identities. Interest in the
approach is reinforced by the existence of powerful symbolic manipulation systems:
Salvy and Zimmermann [427] have implemented univariate algebraic closure oper-
ations; Chyzak and Salvy [90, 92] have developed algorithms for multivariate holo-
nomicity discussed below.
EXAMPLE II.1.
The Euler-Landen identities for dilogarithms.
Let as usual Lir(z) :=
P
n≥1 zn/n2 represent the polylogarithm function. Around 1760, Landen and Euler discov-
ered the dilogarithmic identity [42, p. 247],
(20)
Li2
„
−
z
1 −z
«
= −1
2 log2(1 −z) −Li2(z),
which corresponds to the (easy) identity on coefﬁcients (extract [zn])
(21)
n
X
k=1
 
n −1
k −1
!
(−1)k
k2
= −1
n2 −
n−1
X
k=1
1
k(n −k),
and specializes (at z = 1
2) to the inﬁnite series evaluation
Li2
„1
2
«
≡
X
n≥1
1
n22n = π2
12 −1
2 log2 2.
Write A and B for the left and right sides of (20), respectively. The differential equations for
A, B are built in stages, according to closure properties:
(22)
Li1(z) :
(1 −z)∂2y −∂y = 0
Li1(z)2 :
(1 −z)2∂3y + 3(1 −z)∂2y + ∂y = 0
Li2(z) :
z(1 −z)∂3y + (2 −3z)∂2y −∂y = 0
B(z) :
z3(36z5 + · · · −880)(1 −z)6∂9y + · · · −48(225z5 + · · · + 1240)∂y = 0
A(z) :
z(1 −z)2∂3y + (1 −z)(2 −5z)∂2y −(3 −4z)∂y = 0
Thus, A −B lives a priori in a vector space of dimension 12 = 3 + 9. It thus sufﬁces to check
the coincidence of the expansions of both members of (20) till order 12 in order to prove the
identity A = B. (An upper bound on the dimension of the vector space is actually enough.)
Equivalently, given the automatic computations of (22), it sufﬁces to verify the particular cases
of the identity (21) in order to have a complete proof of it. . . . . . . END OF EXAMPLE II.1. □
 II.13. Holonomic functions as solutions of systems. (This is a simple outcome of Note 41,
p. 496.) A holonomic function y(z) which satisﬁes a linear differential equation of order m with
coefﬁcients in C(z) is also the ﬁrst component of a ﬁrst-order differential system of order m
with rational coefﬁcients: y(z) = Y1(z), where
(23)
8
>
>
>
>
<
>
>
>
>
:
d
dz Y1(z)
=
a11(z)Y1 + · · · + a1m(z)Ym(z)
...
...
...
d
dz Ym(z)
=
am1(z)Y1 + · · · + amm(z)Ym(z),

696
B. BASIC COMPLEX ANALYSIS
where each ai,j(z) is a rational function. Conversely, any solution of a system (23) with the
ai,j ∈C(z) is holonomic.

 II.14. The Laplace transform. Let f(z) = P
n≥0 fnzn be a formal power series. Its Laplace
transform g = L[f] is deﬁned as the formal power series:
L[f](x) =
∞
X
n=0
n!fnzn.
(Thus Laplace transforms convert EGFs into OGFs.) Under suitable convergence conditions,
the Laplace transform is analytically representable by
L[f](x) =
Z ∞
0
f(xz)e−z dz.
The following property holds: A series is holonomic if and only if its Laplace transform is
holomic. [Hint: use P-recurrences (19).]

 II.15. Hypergeometric functions. Let (a)n represent the falling factorial a(a −1) · · · (a −
n + 1). The function of one variable, z, and three parameters, a, b, c, deﬁned by
(24)
F[a, b; c; z] = 1 +
∞
X
n=1
(a)n(bn)
(c)n
zn
n! ,
is known as a hypergeometric function. It satisﬁes the differential equation
(25)
z(1 −z)d2y
dz2 + (c −(a + b + 1)z) dy
dz −aby = 0,
and is consequently a holonomic function. An accessible introduction appears in [492, Ch XIV].
The generalized hypergeometric function (or series) depends on p + q parameters
a1, . . . , ap and c1, . . . , cq, and is deﬁned by
(26)
pFq[a1, . . . , ap; c1, . . . , cq; z] = 1 +
∞
X
n=1
(a1)n · · · (ap)n
(c1)n · · · (cq)n
zn
n! ,
so that F in (24) is a 2F1. Hypergeometric functions satisfy a rich set of identities [153, 438],
many of which can be veriﬁed (though not discovered) by Algorithm Z.

Multivariate holonomic functions. Let z = (z1, . . . , zm) be a collection of
variables and C(z) the ﬁeld of all rational fractions in the variables z. For n =
(n1, . . . , nm) a vector of integers, we deﬁne zn to be zn1
1 · · · znm
m
and let ∂n repre-
sent ∂zn1
1 · · · ∂znm
m .
Deﬁnition B.2. A multivariate formal power series (or function) f(z) is said to be
holonomic if the vector space over C(z) spanned by the set of all derivatives {∂nf(z)}
is ﬁnite dimensional.
Since the partial derivatives ∂j
z1f are bound, a multivariate holonomic function
satisﬁes a differential equation of the form
c10(z) ∂r1
∂zr1
1
f(z) + · · · + c1r1(z)f(z) = 0,
and similarly for z2, . . . , zm. (Any system of equations with possibly mixed partial
derivatives that allows one to determine all partial derivatives in terms of a ﬁnite num-
ber of them serves to deﬁne a multivariate holonomic function.) Denominators can be
cleared, upon multiplication by the l.c.m of all the denominators that ﬁgure in the sys-
tem of deﬁning equations. There results that coefﬁcients of multivariate holonomic

B. BASIC COMPLEX ANALYSIS
697
functions satisfy particular systems of recurrence equations with polynomial coefﬁ-
cients, which are characterized in [335].
Given f(z) viewed as a function of z1, z2 (with the remaining variables treated
as parameters) and abbreviated as f(z1, z2), we deﬁne the diagonal with respect to
variables z1, z2 as
Diagz1,z2[f(z1, z2)] =
X
ν
fν,νzν
1,
where
f(z1, z2) =
X
n1,n2
fn1,n2zn1
1 zn2
2 .
The Hadamard product is deﬁned like in the univariate case, with respect to a speciﬁc
variable (e.g., z1).
Theorem B.3 (Multivariate holonomic closure). The class of multiivariate holonomic
functions is closed under the following operations: sum (+), product (×), Hadamard
product (⊙), differentiation (∂), indeﬁnite integration (R ), algebraic substitution, spe-
cialization (setting some variable to a constant), and diagonal.
An elementary proof of this remarkable theorem (in the sense that it does not
appeal to higher concepts of differential algebra) is given by Lipshitz in [334, 335].
The closure theorem and its companion algorithms [90, 463] make it possible to prove,
or verify, automatically identities, many of which are nontrivial. For instance, in his
proof of the irrationality of the number ζ(3) = P
n≥1 1/n3, Ap´ery introduced the
combinatorial sequence,
(27)
An =
n
X
k=0
n
k
2n + k
k
2
,
for which a proof was needed [478] of the fact that it satisﬁes the recurrence
(28)
(n + 1)3Bn + (n + 2)3Bn+2 −(2n + 3)(17n2 + 51n + 39)Bn+1 = 0,
with B1 = 5, B2 = 73. Obviously, the generating function B(z) of the sequence
(Bn) as deﬁned by the P-recurrence (28) is univariate holonomic. Repeated use of
the multivariate closure theorem shows that the ordinary generating function A(z) of
the sequence An of (28) is holonomic. (Indeed, start from the explicit
X
n1,n2
 
n1
n2
!
zn1
1 zn2
2
=
1
1 −z1(1 + z2),
X
n1,n2
 
n1 + n2
n2
!
zn1
1 zn2
2
=
1
1 −z1 −z2 ,
and apply suitable Hadamard products and diagonal operations.) This gives an ordi-
nary differential equation satisﬁed by A(z). The proof is then completed by checking
that An and Bn coincide for enough initial values of n.
Holonomic functions in inﬁnitely many variables. Let f be a power series in
inﬁnitely many variables x1, x2, . . .. Let S ⊂Z≥1 be a subset of indices. We write
fS for the specialization of f in which all the variables whose indices do not belong
to S are set to 0. Following Gessel [234], we say that the series f in inﬁnitely many
variables is holonomic if, for each ﬁnite S, the specialization fS is holonomic (in the
variables xs for s ∈S). Gessel has developed a powerful calculus in the case of
series f that are symmetric functions, with stunning consequences for combinatorial
enumeration.

698
B. BASIC COMPLEX ANALYSIS
An undirected graph is called k-regular if every vertex has exact degree k.
A
standard Young tableau is the Ferrers diagram of an integer partition, ﬁlled with con-
secutive integers in a way that is increasing along rows and columns. The classical
Robinson-Schensted-Knuth correspondence establishes a bijection between permuta-
tions of size n and pairs of Young tableaus of size n having the same shape. The
common height of the tableaus in the pair associated to a permutation σ coincides
with the length of the longest increasing subsequence of σ. A k × n Latin rectangle
is a k × n matrix with elements in the set {1, 2, . . ., n} such that entries in each row
and column are distinct. (It is thus a k-tuple of “discordant” permutations.)
Gessel’s calculus [233, 234] provides a uniﬁed approach to establishing the holo-
nomic character of many generating functions associated with combinatorial struc-
tures like: Young tableaus, permutations of uniform multisets, increasing subse-
quences in permutations, Latin rectangles, regular graphs, marices with ﬁxed row and
matrix sum, and so on. For instance: the generating functions of Latin rectangles and
Young tableaux of height at most k, of k-regular graphs, and of permutations whose
longest increasing subsequence is of length k are holonomic functions. In particular,
the number Yn,k of permutations of size n with longest increasing subsequence ≤k
satisﬁes
(29)
X
n≥0
Yn,k
z2n
(n!)2 = det

I|i−j|(2z)

1≤i,j≤k , where Iν(2z) =
∞
X
n=0
x2n+ν
n!(n + ν)!,
that is, a corresponding GF is expressible as a determinant of Bessel functions. Other
applications are described in [91, 363].
5. Implicit Function Theorem. In its real variable version, the implicit function
theorem asserts that, for a sufﬁciently smooth function F(z, w) of two variables, a
solution to the the equation F(z, w) = 0 exists in the vicinity of a solution point
(z0, w0) (therefore satisfying F(z0, w0) = 0) provided the partial derivative satisﬁes
F ′
w(z0, w0) ̸= 0. This theorem admits a complex-analytic extension, which is essen-
tial for the analysis of recursive structures.
Without loss of generality, one restricts attention to (z0, w0) = (0, 0). We con-
sider here a function F(z, w) that is analytic in two complex variables in the sense
that it admits a convergent representation valid in a polydisc,
(30)
F(z, w) =
X
m,n≥0
fm,nzmwn,
|z| < R,
|w| < S.
for some R, S > 0 (cf APPENDIX B: Several complex variables., p. 712).
Theorem B.4 (Analytic Implicit Functions). Let F be bivariate analytic near (0, 0).
Assume that F(0, 0) ≡f0,0 = 0 and F ′
w(0, 0) ≡f0,1 ̸= 0. Then, there exists a unique
function f(z) analytic in a neighbourhood |z| < ρ of 0 such that f(0) = 0 and
F(z, f(z)) = 0,
|z| < ρ.
 II.16. Proofs of the Implicit Function Theorem. See Hille’s book [269] for details.
(i) Proof by residues. Make use of the principle of the argument and Rouch´e’s Theorem
to see that the equation F(z, w) has a unique solution near 0 for |z| small enough. Appeal then
to the related result of Chapter IV (based on the residue theorem) that expresses the sum of the

B. BASIC COMPLEX ANALYSIS
699
solutions to an equation as a contour integral. Here, this expresses the solution as (C a small
enough contour around 0 in the w–plane)
f(z) =
1
2iπ
Z
C
w F ′
w(z, w)
F(z, w) dw,
which is checked to represent an analytic function of z.
(ii) Proof by majorant series. Set G(z, w) := w −f −1
0,1F(z, w). The equation F(z, w) =
0 becomes the ﬁxed-point equation w = G(z, w). The bivariate series G has its coefﬁcients
dominated termwise by those of
bG(z, w) =
A
(1 −z/R)(1 −w/S) −A −Aw
S .
The equation w = bG(z, w) is quadratic. It admits a solution bf(z) analytic at 0,
bf(z) = A z
R + A(A2 + AS + S2)
S2
z2
R2 + · · · ,
whose coefﬁcients dominate termwise those of f.
(iii) Proof by Picard’s method of successive approximants. With G like before, deﬁne the
sequence of functions
φ0(z) := 0;
φj+1(z) = G(z, φj(z)),
each analytic in a small neighbourhood of 0. Then f(z) can be obtained as
f(z) = lim
j→∞φj(z) ≡φ0(z) −
∞
X
j=0
(φj(z) −φj+1(z)) ,
which is itself checked to be analytic near 0 by the geometric convergence of the series.

Weierstrass Preparation. The Weierstrass Preparation Theorem (WPT) also
known as Vorbereitungssatz is a useful complement to the Implicit Function Theo-
rem.
Given a collection Z = (z1, . . . , zm) of variables, we designate as usual by C[[Z]]
the ring of formal power series in indeterminates Z. We let C{Z} denote the subset
of these that are convergent in a neighbourhood of (0, . . . , 0), i.e., analytic (cf AP-
PENDIX B: Several complex variables., p. 712).
Theorem B.5 (Weierstraß Preparation). Let F = F(z1, . . . , zm) in C[[Z]] (respec-
tively C{Z}) be such that F(0, . . . , 0) = 0 and F depends on at least one of the zj
with j ≥2 (i.e., f(0, z2, . . . , zm) is not identically 0). Deﬁne a Weierstraß polynomial
to be a polynomial of the form
W(z) = zd + g1zd−1 + · · · + gd,
where gj ∈C[[z2, . . . , zm]] (respectively gj ∈C{z2, . . . , zm}), with gj(0, . . . , 0) =
0. Then, F admits a unique factorization
F(z1, z2, . . . , zm) = W(z1) · X(z1, . . . , zm),
where W(z) is a Weierstraß polynomial and X is an element of C[[z1, . . . , zm]] (re-
spectively C{z1, . . . , zm}) satisfying X(0, 0 . . ., 0) ̸= 0.
PROOF.[Sketch] An accessible proof and a discussion of the formal algebraic result
are found in Abhyankar’s lecture notes [1, Ch. 16].

700
B. BASIC COMPLEX ANALYSIS
The analytic version of the theorem is the one of use to us in this book. We prove
it in the representative case where m = 2 and write F(z, w) for F(z1, z2). First, the
number of roots of the equation F(z, w) = 0 is given by the integral formula
(31)
1
2iπ
Z
γ
F ′
w(z, w)
F(z, w) dw,
where γ is a small contour encircling 0 in the w-plane. There exists a sufﬁciently small
open set Ωcontaining 0 such that the quantity (31), which is an analytic function of z
while being an integer, is constant, and thus equal to its value at z = 0, which we
call d. The quantity d is the multiplicity of 0 as a root of the equation F(0, w) = 0.
In other words, we have shown that if F(0, w) = 0 has d roots equal to 0, then there
are d values of w near 0 (within γ) such that F(z, w) = 0, provided z remains small
enough (within Ω).
Let y1, . . . , yd be these d roots. Then, we have for the power sum symmetric
functions,
yr
1 + · · · + yd
r =
1
2iπ
Z
γ
F ′
w(z, w)
F(z, w) wrdw,
which are analytic functions of z when z is sufﬁciently near to 0. There results from
relations between symmetric functions (Note III.24, p. 177) that y1, . . . , yr are the
solutions of a polynomial with analytic coefﬁcients, W, which is a uniquely deﬁned
Weierstrass polynomial. The factorization ﬁnally results from the fact that F/W has
removable singularities.
□
In essence, Theorem B.5 implies that functions implicitly deﬁned by a transcen-
dental equation (an equation F = 0) are locally of the same nature as algebraic func-
tions (corresponding to the equation W = 0). In particular, for m = 2, when the
solutions have singularities, these singularities can only be branch points and com-
panion Puiseux expansions hold (Chapter VII). The theorem acquires even greater
importance when perturbative singular expansions (corresponding to m ≥3) become
required for the purpose of extracting limit laws (Chapter IX).
6. Laplace’s method. The method of Laplace serves to estimate asymptotically real
integrals depending on a large parameter n (which may be a positive integer or real
number). Though it is primarily a real analysis technique, we present it in detail in
this appendix given its relevance to the saddle point method, which deals instead with
complex contour integrals.
Case study: a Wallis integral. In order to demonstrate the essence of the method,
consider ﬁrst the problem of estimating asymptotically the Wallis integral
(32)
In :=
Z π/2
−π/2
(cos x)n dx,
as n →+∞. The cosine attains its maximum at x = 0 (where its value is 1), and
since the integrand of In is a large power, the contribution to the integral outside any
ﬁxed segment containing 0 is exponentially small and can consequently be discarded
for all asymptotic purposes. A glance at the plot of cosn x as n varies (Figure 2) also

B. BASIC COMPLEX ANALYSIS
701
suggests that the integrand tends to conform to a bell-shaped proﬁle near the centre as
n increases. This is not hard to verify: set x = w/√n, then a local expansion yields
(33)
cosn x ≡exp(n log cos(x)) = exp

−w2
2 + O(n−1w4)

,
the approximation being valid as long as w = O(n1/4). Accordingly, we choose
(somewhat arbitrarily)
κn := n1/10,
and deﬁne the central range by |w| ≤κn. These considerations suggest to rewrite the
integral In as
In =
1
√n
Z +π√n/2
−π√n/2

cos w
√n
n
dw,
and expect under this new form an approximation by a Gaussian integral arising from
the central range.
Laplace’s method proceeds in three steps:
(i) Neglect the tails of the original integral;
(ii) Centrally approximate the integrand by a Gaussian;
(iii) Complete the tails of the Gaussian integral.
In the case of the cosine integral (32), the chain is summarized in Figure 3. Details of
the analysis follow.
(i) Neglect the tails of the original integral: By (33), we have
cosn
 κn
√n

∼exp

−1
2n1/5

,
and, as the integrand is unimodal, this exponentially small quantity bounds the inte-
grand throughout |w| > κn, that is, on a large part of the integration interval. This
0
0.2
0.4
0.6
0.8
1
–1.5
–1
–0.5
0.5
1
1.5
x
1
0.6
0.8
0.4
0
w
0.2
0
-2
-4
4
2
6
-6
FIGURE II.2.
Plots of cosn x [left] and cosn(w/√n) [right], for n = 1 . .. 20.

702
B. BASIC COMPLEX ANALYSIS
Z π/2
−π/2
cosn x dx
=
1
√n
Z
π
2
√n
−π
2
√n
„
cos w
√n
«n
dw
Set x = w/√n; choose κn = n1/10
∼
1
√n
Z κn
−κn
„
cos w
√n
«n
dw
[Neglect the tails]
∼
1
√n
Z κn
−κn
e−w2/2dw
[Central approxim.]
∼
1
√n
Z ∞
−∞
e−w2/2dw
[Complete the tails]
∼
r
2π
n .
FIGURE II.3.
A typical application of the Laplace method.
gives
(34)
In =
1
√n
Z +κn/√n
−κn/√n
cosn x dx + O

exp

−1
2κ2
n

,
and the error term is of the order of exp(−1
2n1/5).
(ii) Centrally approximate the integrand by a Gaussian: In the central region, we
have
(35)
I(1)
n
:=
Z +κn/√n
−κn/√n
cosn x dx
=
1
√n
Z +κn
−κn
e−w2/2 exp
 O(n−1w4)

dw
=
1
√n
Z +κn
−κn
e−w2/2  1 + O(n−1w4)

dw
=
1
√n
Z +κn
−κn
e−w2/2 dw + O(n−3/2),
given the uniformity of approximation (33) for w in the integration interval.
(iii) Complete the tails of the Gaussian integral: The incomplete Gaussian inte-
gral in (35) can be easily estimated once it is observed that its tails are small. Precisely,
one has, for W ≥0,
Z ∞
W
e−w2/2 dw ≤e−W 2/2
Z ∞
0
e−h2/2 dh ≡
rπ
2 e−W 2/2
(by the change of variable w = W + h). Thus,
(36)
Z +κn
−κn
e−w2/2 dw =
Z +∞
−∞
e−w2/2 dw + O

exp

−1
2κ2
n

.
It now sufﬁces to collect the three approximations, (34), (35), and (36): we have
obtained in this way.
(37)
In =
1
√n
Z +∞
−∞
e−w2/2 dw + O(n−3/2) ≡
r
2π
n + O(n−3/2).

B. BASIC COMPLEX ANALYSIS
703
These three steps are the heart of Laplace’s method.
In the asymptotic scale of the problem, the exponentially small errors in the tails
can be completely neglected. The error in (37) then arises from the central approxi-
mation (33), and its companion O(w4n−1) term. This can easily be improved and it
sufﬁces to appeal to further terms in the expansion of log cos x near 0. For instance,
one has (x = w/√n):
(38)
cosn x = e−w2/2

1 −w4
12n + O(n−2w8)

.
Proceeding like before, we ﬁnd that a further term in the expansion of In is obtained
by considering the additive correction
ǫn := −1
√n
Z +∞
−∞
e−w2/2
 w4
12n

dw ≡−
r π
8n3 ,
so that
In =
r
2π
n −
r π
8n3 + O(n−5/2).
Clearly, a full asymptotic expansion can be obtained in this manner.
 II.17. Wallis integrals and central binomials. The integral In is an integral considered by
John Wallis (1616–1703). It can be evaluated through partial integration or by its relation to the
Beta integral (Note 11) as In = Γ( 1
2)Γ( n
2 + 1
2)/Γ( n
2 + 1). There results (n 7→2n)
 
2n
n
!
∼22n
√πn
„
1 −1
8n +
1
128n2 +
5
1024n3 −· · ·
«
,
which is yet another avatar of Stirling’s formula.

General case of large powers. Laplace’s method applies under very general con-
ditions to integrals involving large powers of a ﬁxed function.
Theorem B.6 (Laplace’s method). Let f and g be indeﬁnitely differentiable real val-
ued functions deﬁned over some compact interval I of the real line. Assume that |g(x)|
attains its maximum at a unique point x0 interior to I and that f(x0), g(x0), g′′(x0) ̸=
0. Then, the integral
In :=
Z
I
f(x)g(x)n dx
admits a full asymptotic expansion:
(39)
In ∼
r
2π
λnf(x0)g(x0)n

1 +
X
j≥1
δj
nj

,
λ := −g′′(x0)
g(x0) .
 II.18. Proof of Laplace’s Theorem. It follows exactly the steps explained above. Let us
asume ﬁrst that f(x) ≡1. Then, one chooses κn as a function tending slowly to inﬁnity like
before (κn = n1/10 is suitable). It sufﬁces to expand
I(1)
n
:=
Z x0+κn/√n
x0−κn/√n
en log g(x) dx,

704
B. BASIC COMPLEX ANALYSIS
as the difference In −I(1)
n
is exponentially small. Set ﬁrst x = x0 + X and
L(X) := log g(x0 + X) −log g(x0) + λX2
2 ,
so that, with w = X√n, the central contribution becomes:
I(1)
n
= g(x0)n
√n
Z κn
−κn
e−λw2/2enL(w/√n) dw.
Then, it is possible to expand L(X) to any order M,
L(X) =
M−1
X
j=3
ℓjXj + O(XM),
and enL(w/√n) admits a full expansion in descending powers of √n:
enL(w/√n) ∼1 + ℓ3w3
√n + 2ℓ4w4 + ℓ2
3w6
2n
+ · · · .
There, by construction, the coefﬁcient of n−k/2 is a polynomial Ek(w) of degree 3k. This
expression can be truncated to any order, resulting in
I(1)
n
= g(x0)n
√n
Z κn
−κn
e−λw2/2
 
1 +
M−1
X
k=1
Ek(w)
nk/2
+ O
„1 + w3M
nM/2
«!
dw.
One can then complete the tails at the expense of exponentially small terms since the Gaussian
tails are exponentially small.
The full asymptotic expansion is revealed by the following device: for any power series
h(w), introduce the Gaussian transform,
G[f] :=
Z ∞
0
e−w2/2f(w) dw,
which is understood to operate by linearity on integral powers of w,
G[w2r] = 1 · 3 · · · (2r −1)
√
2π,
G[w2r+1] = 0.
Then, the complete asymptotic expansion of In is obtained by the formal expansion
(40)
g(x0)n
√
nλ
· G
h
exp
“
λ−3/2w3yeL(λ−1/2wy)
”i
,
eL(X) :=
1
X3 L(X),
y 7→
1
√n.
The addition of the prefactor f(x) (omitted so far) induces a factor f(x0) in the in the main
term of the ﬁnal result and it affects the coefﬁcients in the smaller order terms in a computable
manner. Details are left as an exercise to the reader.

 II.19. The next term? One has (with fj := f (j)(x0), etc):
In
√
λn
√
2πg(x0)n = f0 + −9λ3f0 + 12λ2f2 + 12λf1g3 + 3λf0g4 + 5g2
3f0
24λ3n
+ O(n−2),
which is best determined using a symbolic manipulation system.

The method is susceptible of a large number of extensions. Roughly it requires
a point where the integrand is maximized, which induces some sort of exponential
behaviour, local expansions then allowing for a replacement by standard integrals.
 II.20. Special cases of Laplace’s method. When f(x0) = 0, the integral normalizes to an
integral of the form
R
w2e−w2/2. If g′′(x0) = 0 but g(iv)(x0) ̸= 0 then a factor Γ( 1
4) replaces
the characteristic √π ≡Γ( 1
2). [Hint:
R ∞
0
exp(−wβ)wα dw = β−1Γ((α + 1)β−1).] If the
maximum is attained at one end of the interval I = [a, b] while g′(x0) = 0, g′′(x0) ̸= 0, then
the estimate (39) must be multiplied by a factor of 1
2. If the maximum is attained at one end of

B. BASIC COMPLEX ANALYSIS
705
the interval I while g′(x0) ̸= 0, then the right normalization is w = x/n and the integrand is
reducible to an exponential e−w. Here are some dominant asymptotic terms:
x0 ̸= a, b
g′′(x0) ̸= 0, f(x0) = 0
p
π
2λ5n3 g(x0)n(λf ′′(x0) + f ′(x0)g′′′(x0))
x0 ̸= a, b
g′′(x0) = 0, g(iv)(x0) ̸= 0
Γ( 1
4) 4q
3
2λ⋆nf(x0)g(x0)n
“
λ⋆= −g(iv)(x0)
g(x0)
”
x0 = a
f(x0) ̸= 0, g′(x0) ̸= 0
−
1
ng′(x0)f(x0)g(x0)n+1 .
A similar analysis is employed in Chapter VIII, when we discuss coalscence cases of the saddle-
point method.

EXAMPLE II.2. Stirling’s formula via Laplace’s method. Start from an integral representation
involving n!, namely,
In :=
Z ∞
0
e−nxxn dx =
n!
nn+1 .
This is a direct case of application of the theorem, except for the fact that the integration interval
is not compact. The integrand attains its maximum at x0 = 1 and the remainder integral
R ∞
2
is
accordingly exponentially small as proved by the chain
Z ∞
2
e−nxxn dx
=
(2e−2)n
Z ∞
0
“
1 + x
2
”n
e−nx dx
[x 7→x + 2]
<
(2e−2)n
Z ∞
0
enx/2e−nx dx = 2
n(2e−2)n
[log(1 + x/2) < x/2].
Then the integral from 0 to 2 is amenable to the standard version of Laplace’s method as stated
in Theorem B.6 to the effect that
n! = nne−n√
2πn
„
1 + O
„ 1
n
««
.
The asymptotic expansion of In derives from (40) and involves the combinatorial GF
(41)
H(z, u) := exp
„
u
„
log(1 −z)−1 −z −z2
2
««
.
The noticeable fact is that H(z, u) is the exponential BGF of permutations that are generalized
derangements involving no cycles of length 1 or 2, with z marking size and u marking the
number of cycles:
H(z, u) =
X
n,k≥0
hn,kuk zn
n! = 1+ 1
3uz3+ 1
4 uz4+ 1
5 uz5+( 1
6u+ 1
18u2)z6+( 1
7u+ 1
12u2)z7+· · · .
Then, a full asymptotic expansion of In is obtained by applying the Gaussian transform G to
H(wy, −y−2) (with y = n−1/2), resulting in
n! ∼nne−n√
2πn
„
1 +
1
12n +
1
288n2 −
139
51840n3 −· · ·
«
.
Proposition B.1 (Stirling’s formula). The factorial function admits the complete asymptotic
expansion as x →+∞:
x! ≡Γ(x + 1) ∼xxe−x√
2πx
0
@1 +
X
q≥1
cq
xq
1
A .
The coefﬁcients satisfy cq =
2q
X
k=1
(−1)k
2q+k(q + k)!h2q+2k,k, where hn,k counts the number of
permutations of size n having k cycles, all of length ≥3.
The derivation above is due to Wrench (see [98, p. 267]). . . . . . . . . END OF EXAMPLE II.2. □

706
B. BASIC COMPLEX ANALYSIS
The scope of the method goes much beyond the case of integrals of large pow-
ers. Roughly, what is needed is a localization of the main contribution of an integral
to a smaller range (“Neglect the tails”) where local approximations can be applied
(“Centrally approximate”) . The approximate integral is then ﬁnally estimated by
completing back the tails (“Complete the tails”).
The Laplace method is excellently described in books by de Bruijn [111] and
Henrici [265]. A thorough discussion of special cases and multidimensional integrals
is found in the book by Bleistein and Handelsman [59]. Its principles are fundamental
to the development of the saddle point method in Chapter VIII.
 II.21. The classical proof of Stirling’s formula. This proceeds from the integral
Jn :=
Z ∞
0
e−xxn dx
( = n!)
The maximum of the integrand is at x0 = n and the central range is now now n ± κn
√n.
Reduction to a Gaussian integral follows, though the estimate is no longer an immediate case
of application of Theorem B.6.

Laplace’s method for sums. The basic principles of the method of Laplace (for
integrals) can are often be recycled for the asymptotic evaluation of discrete sums.
Take a ﬁnite or inﬁnite sum Sn deﬁned by
Sn :=
X
k
t(n, k).
A preliminary task consists in working out the general aspect of the family of num-
bers {t(n, k)} for ﬁxed (but large) n as k varies. In particular, one should locate the
value k0 ≡k0(n) of k for which t(n, k) is maximal. In a vast number of cases, tails
can be neglected; a central approximation bt(n, k) of t(n, k) for k in the “central” re-
gion near k0 can be determined, frequently under the form [remember that we use in
this book ‘≈’ in the loose sense of ’approximately equal’]
bt(n, k) ≈s(n)φ
k −k0
σn

.
There φ is some simple smooth function while s(n) and σn are scaling constants. The
quantity σn indicates the range of the asymptotically signiﬁcant terms. One may then
expect
Sn ≈s(n)
X
k
φ
k −k0
σn

.
Then provided σn →∞, one may further expect to approximate the sum by an inte-
gral, which after completing the tails, gives
Sn ≈s(n)σn
Z ∞
−∞
φ(t) dt.

B. BASIC COMPLEX ANALYSIS
707
Case study: Sums of powers of binomial coefﬁcients. Here is, in telegraphic
style, an application to sums of powers of binomial coefﬁcients:
S(r)
n
=
+n
X
k=−n
 2n
n + k
r
.
The largest term arises at k0 = 0. Also, one has elementarily
  2n
n+k

 2n
n
 =
 1 −1
n

· · ·
 1 −k−1
n

 1 + 1
n

· · ·
 1 + k
n
 .
Upon taking logarithms, using approximations of log(1±x), and exponentiating back,
one ﬁnds
(42)
  2n
n+k

 2n
n
 = exp

−k2
n + O(k3n−2)

.
This approximation holds for k = o(n2/3), where it provides a gaussian approxima-
tion (φ(x) = e−rx2) with a span of σn = √n. Tails can be neglected to the effect
that
1
 2n
n
r S(r)
n
∼
X
k
exp

−rk2
n

,
say with |k| < n1/2κn where κn = n1/10. Then approximating the Riemann sum by
an integral and completing the tails, one gets
Sr
n ∼
2n
n
r√n
Z ∞
−∞
e−rw2 dw,
that is,
Sr
n ∼22rn
√r (πn)−(r−1)/2,
which is our ﬁnal estimate. l
 II.22. Elementary approximation of Bell numbers. The Bell numbers counting set partitions
are
Bn = n![zn]eez−1 = e−1
∞
X
k=0
kn
k! .
The largest term occurs for k near eu where u is the positive root of the equation ueu = n + 1;
the central terms are approximately Gaussian. There results the estimate,
(43)
Bn = n!e−1(2π)−1/2(1 + u−1)−1/2 exp
„
eu(1 −u log u) −1
2u
« `
1 + O(e−u)
´
.
This example is taken from de Bruijn’s book [111, p. 108].

7. Mellin transform. The Mellin transform of a function f deﬁned over R>0 is the
complex-variable function f ⋆(s) deﬁned by the integral
(44)
f ⋆(s) :=
Z ∞
0
f(x)xs−1 dx.
This transform is also occasionally denoted by M[f] or M[f(x); s]. Its importance
devolves from two properties: (i) it maps asymptotic expansions of a function at 0
and +∞to singularities of the transform; (ii) it factorizes harmonic sums (deﬁned
below). The conjunction of the mapping property and the harmonic sum property
makes it possible to analyse asymptotically rather complicated sums arising from a

708
B. BASIC COMPLEX ANALYSIS
linear superposition of models taken at different scales. Major properties are summa-
rized in Figure 4. In this brief review, detailed analytic conditions must be omitted:
see [184] as well as comments and references at the end of this entry.
It is assumed that f is locally integrable. Then, the two conditions,
f(x)
=
x→0+ O(xu),
f(x)
=
x→+∞O(xv),
guarantee that f ∗exists for s in a strip,
s ∈⟨−u, −v⟩,
i.e.,
−u < ℜ(s) < −v.
Thus existence of the transform is granted provided v < u. The prototypical Mellin
transform is the Gamma function discussed earlier in this appendix:
Γ(s) :=
Z ∞
0
e−xxs−1 dx = M[e−x; s],
0 < ℜ(s) < ∞.
Similarly f(x) = (1 + x)−1 is O(x0) at 0 and O(x−1) at inﬁnity, and hence its
transform exists in the strip ⟨0, 1⟩; it is in fact π/ sin πs, as a consequence of the
Eulerian Beta integral. The Heaviside function deﬁned by H(x) := [[0 ≤x < 1]]
exists in ⟨0, +∞⟩and has transform 1/s.
Harmonic sum propery. The Mellin transform is a linear transform. In addition,
it satisﬁes the simple but important rescaling rule:
f(x)
M
7→f ⋆(s)
implies
f(µx)
M
7→µ−sf ⋆(s),
for any µ > 0. Linearity then entails the derived rule
(45)
X
k
λkf(µkx)
M
7→
 λkµ−s
k

· f ⋆(s),
valid a priori for any ﬁnite set of pairs (λk, µk) and extending to inﬁnite sums when-
ever the interchange of
R
and P is permissible. A sum of the form (45) is called
a harmonic sum, the function f is the “base function”, the λ’s are the “amplitudes”
and the µ’s the “frequencies”. Equation (45) then yields the “harmonic sum rule”:
The Mellin transform of a harmonic sum factorizes as the product of the transform of
the base function and a generalized Dirichlet series associated to amplitudes and fre-
quencies. Harmonic sums surface recurrently in the context of analytic combinatorics
and Mellin transforms are a method of choice for coping with them.
Here are a few examples of application of the rule (45):
X
k≥1
e−k2x2
7→
ℜ(s)>1
1
2Γ(s/2)ζ(s)
X
k≥0
e−x2k
7→
ℜ(s)>0
Γ(s)
1 −2−s
X
k≥0
(log k)e−
√
kx
7→
ℜ(s)>2 −ζ′(s/2)Γ(s)
X
k≥1
1
k(k + x)
7→
0<ℜ(s)<1 ζ(2 −s)
π
sin πs .
 II.23. Connection between power series and Dirichlet series. Let (fn) be a sequence of
numbers with at most polynomial growth, fn = O(nr), and with OGF f(z). Then, one has
X
n≥1
fn
ns =
1
Γ(s)
Z ∞
0
f
`
e−x´
xs−1 dx,
ℜ(s) > r + 1.

B. BASIC COMPLEX ANALYSIS
709
Function (f(x))
Mellin transform (f ⋆(s))
f(x)
Z ∞
0
f(x)xs−1 dx
deﬁnition, s ∈⟨−u, −v⟩
1
2iπ
Z c+i∞
c−i∞
f ⋆(s)x−s ds
f ⋆(s)
inversion th., −u < c < −v
X
i
λifi(x)
X
i
λif ⋆
i (s)
linearity
f(µx)
µ−sf ⋆(s)
scaling rule (µ > 0)
xρf(xθ)
1
θ f ⋆“s + ρ
θ
”
power rule
X
i
λif(µix)
 X
i
λiµ−s
i
!
· f ⋆(s)
harmonic sum rule (µi > 0)
Z ∞
0
λ(t)f(tx) dt
Z ∞
0
λ(t)t−s dt · f ⋆(s)
harmonic integral rule
f(x) logk x
∂k
s f ⋆(s)
diff. I, k ∈Z≥0, ∂s :=
d
ds
∂k
xf(x)
(−1)kΓ(s)
Γ(s −k) f ⋆(s −k)
diff. II, k ∈Z≥0, ∂x :=
d
dx
∼
x→0 xα(log x)k
∼
s→−α
(−1)kk!
(s + α)k+1
mapping: x →0, left poles
∼
x→+∞xβ(log x)k
∼
s→−β
(−1)k−1k!
(s + β)k+1
mapping: x →∞, right poles
FIGURE II.4.
A summary of major properties of Mellin transforms.
For instance, one obtains the Mellin pairs
e−x
1 −e−x
M
7→ζ(s)Γ(s)
(ℜ(s) > 1),
log
1
1 −e−x
M
7→ζ(s + 1)Γ(s)
(ℜ(s) > 0).
These serve to analyse sums or, conversely, deduce analytic properties of Dirichlet series.

Mapping properties. Mellin transfoms map asymptotic terms in the expansions
of a function f at 0 and +∞onto singular terms of the transform f ⋆. This property
stems from the basic identities
H(x)xα M
7→
1
s + α (s ∈⟨−α, +∞⟩),
(1−H(x))xβ M
7→
1
s + β (s ∈⟨−∞, −β⟩),
as well as what one obtains by differentiation with respect to α, β.
The converse mapping property also holds. Like for other integral transforms,
there is an inversion formula: if f is continuous in an interval containing x, then
(46)
f(x) =
1
2iπ
Z c+i∞
c−i∞
f ⋆(s)x−s ds,
where the abscissa c should be chosen in the “fundamental strip” of f; for instance
any c satisfying −u < c < −v with u, v as above is suitable.

710
B. BASIC COMPLEX ANALYSIS
In many cases of practical interest, f ⋆is continuable as a meromorphic function
to the whole of C. If the continuation of f ⋆does not grow too fast along vertical lines,
then one can estimate the inverse Mellin integral of (46) by residues. This corresponds
to shifting the line of integration to some d ̸= c and taking poles into account by the
residue theorem. Since the residue at a pole s0 of f ⋆involves a factor of x−s0, the
contribution of s0 will give useful information on f(x) as x →∞if s0 lies to the
right of c, and on f(x) as x →0 if s0 lies to the left. Higher order poles introduce
additional logarithmic factors. The “dictionary” is simply
(47)
1
(s −s0)k+1
M−1
−→
±(−1)k
k!
x−s0(log x)k,
where the sign is ‘+’ for a pole on the left of the fundamental strip and ‘−’ for a pole
on the right.
Mellin asymptotic summation. The combination of mapping properties and the
harmonic sum property constitutes a powerful tool of asymptotic analysis. As an
example, let us ﬁrst investigate the pair
F(x) :=
X
k≥1
1
1 + k2x2 ,
F ⋆(s) = 1
2
π
sin 1
2πsζ(s),
where F ⋆results from the harmonic sum rule and is is originally deﬁned in the strip
⟨1, 2⟩. The function is meromorphically continuable to the whole of C with poles at
the points 0, 1, 2 and 4, 6, 8, . . .. The transform F ⋆is small towards inﬁnity, so that
application of the dictionary (47) is justiﬁed. One then ﬁnds mechanically:
F(x)
∼
x→0+
π
2x −1
2 + O(xM),
F(x)
∼
x→+∞
π2
6x2 −
π4
90x4 + · · · ,
for any M > 0.
A particularly important quantity in analytic combinatorics is the harmonic sum
Φ(x) :=
∞
X
k=0

1 −e−x/2k
.
It occurs for instance in the analysis of longest runs in words (p. 288). By the harmonic
sum rule, one ﬁnds
Φ⋆(s) = −Γ(s)
1 −2s ,
s ∈⟨−1, 0⟩
(The transform of e−x −1 is also Γ(s), but in the shifted strip ⟨−1, 0⟩.) The singu-
larities of Φ⋆are at s = 0, where there is a double pole, at s = −1, −2, . . . which are
simple poles, but also at the complex points
χk = 2ikπ
log 2.
The Mellin dictionary (47) can still be applied provided one integrates along a long
rectangular contour that passes in-between poles. The salient feature is here the pres-
ence of ﬂuctuations induced by the imaginary poles, since
x−χk = exp (−2ikπ log2 x) ,

B. BASIC COMPLEX ANALYSIS
711
and each pole induces a Fourier element. All in all, one ﬁnds (any M > 0):
(48)







Φ(x)
∼
x→+∞
log2 x +
γ
log 2 + 1
2 + P(x) + O(xM)
P(x) :=
1
log 2
X
k∈Z\{0}
Γ
2ikπ
log 2

e−2ikπ log2 x.
The analysis for x →0 is also possible: in this particular case, it yields
Φ(x) ∼
x→0
X
n≥1
(−1)n−1
1 −2−n
xn
n! ,
which is what would result from expanding the exponential in Φ(x) and reorganiz-
ing the terms, and consequently constitutes an exact representation (i.e., ‘∼’ can be
replaced by ‘=’).
 II.24. Mellin-type derivation of Stirling’s formula. One has the Mellin pair
L(x) =
X
k≥1
log
“
1 + x
k
”
−x
k ,
L⋆(s) =
π
s sin πsζ(−s),
s ∈⟨−2, −1⟩.
Note that L(x) = log(e−γx/Γ(1 + x)). Mellin asymptotics provides
L(x)
∼
x→+∞−x log x −(γ −1)x −1
2 log x −log
√
2π −
1
12x +
1
360x3 −
1
1260x5 + · · · ,
where one recognizes Stirling’s expansion of x!,
log x!
∼
x→+∞log
“
xxe−x√
2πx
”
+
X
n≥1
B2n
2n(2n −1)x1−2n,
with Bn the Bernoulli numbers.

 II.25. Mellin-type analysis of the harmonic numbers. For a parameter α > 0, one has the
Mellin pair:
Kα(x) =
X
k≥1
„ 1
kα −
1
(k + x)α
«
,
K⋆
α(s) = −ζ(α −s)Γ(s)Γ(α −s)
Γ(α)
.
This serves to estimate harmonic numbers and their generalisations, for instance
Hn
∼
n→∞log n + γ −1
2n −
X
k≥2
Bk
k n−k ∼log n + γ + 1
2n −
1
12n2 +
1
120n4 −· · · ,
since K1(n) = Hn.

EXAMPLE II.3.
Euler-Maclaurin summation via Mellin analysis. Let f be continuous on
(0, +∞) and satisfy f(x) =x→+∞O(x−1−δ), for some δ > 0, and
f(x)
∼
x→0+
∞
X
k=0
fkxk.
The summatory function F(x) satisﬁes
F(x) :=
X
n≥1
f(nx),
F ⋆(s) = ζ(s)f ⋆(s),

712
B. BASIC COMPLEX ANALYSIS
by the harmonic sum rule. The collection of (trimmed) singular expansions of f ⋆at s =
0, −1, −2, . . . is summarized by the formal sum
f ⋆(s) ≍
„f0
s
«
s=0
+
„ f1
s + 1
«
s=1
+
„ f2
s + 2
«
s=1
+ · · · .
Thus, by the mapping properties, provided F ⋆(s) is small towards ±i∞in ﬁnite strips, one has
F(x) ∼
x→0
1
x
Z ∞
0
f(t) dt +
∞
X
j=0
fjζ(−j)xj,
where the main term is associated to the singularity of F ⋆at 1 and arises from the pole of ζ(s),
with f ⋆(1) giving the integral of f. The interest of this approach is that it is very versatile and
allows for various forms of asymptotic expansions of f at 0 as well as multipliers like (−1)k,
log k, and so on; see [184] for details and Gonnet’s note [241] for alternative approaches.
END OF EXAMPLE II.3. □
General references on Mellin transforms are the books by Doetsch [131] and
Widder [493]. The term “harmonic sum” and some of the corresponding technol-
ogy originates with the abstract [204]. This brief presentation is based on the survey
article [184] to which we refer for a detailed treatment. Mellin analysis of “harmonic
integrals” is a classical topic of applied mathematics for which we refer to the books
by Wong [502] and Paris–Kaminski [386]. Useful treatments of properties of use in
discrete mathematics and analysis of algorithms appear in the books by Hofri [270],
Mahmoud [351], and Szpankowski [458].
8. Several complex variables.. The theory of analytic (or holomorphic) functions of
one complex variables extends nontrivially to several complex variables. This pro-
found theory has been largely developed in the course of the twentieth century. Here
we shall only need the most basic concepts, not the deeper results, of the theory.
Consider the space Cm endowed with the metric
|z| = |(z1, . . . , zm)| =
m
X
j=1
|zj|2,
under which it is isomorphic to the Euclidean space R2m. A function f from Cm to C
is said to be analytic at some point a if in a neighbourhood of a it can be represented
by a convergent power series,
(49)
f(z) ≡f(z1, · · · , zm) =
X
n
fn(z−a)n ≡
X
n1,...,nm
fn1,...,nm(z1−a1)n1 · · · (zm−am)nm.
There and throughout the theory extensive use is made of multi-index conventions, as
encountered in Chapter III.
An expansion (49) converges in a polydisc Q
j{|zj −aj| < rj}, for some rj > 0.
A convergent expansion at (0, . . . , 0) has its coefﬁcients majorized in absolute value
by those of a series of the form
m
Y
j=1
1
1 −zj/Rj
=
X
n
R−nzn ≡
X
n1,...,nm
R−n1
1
· · · R−nm
m
zn1
1 · · · znm
m .

B. BASIC COMPLEX ANALYSIS
713
From there, closure of analytic functions under sums, products, and compositions re-
sult from standard manipulations of majorant series (see Chapter IV for the univariate
case). Finally, a function is analytic in an open set Ω⊆Cm iff it is analytic at each
a ∈Ω.
A remarkable theorem of Hartogs asserts that f(z) with z ∈Cm is analytic jointly
in all the zj (in the sense of (49)) if it is analytic separately in each variable zj. (The
version of the theorem that postulates a priori continuity is elementary.)
Like in the one-dimensional case, analytic functions can be equivalently deﬁned
by means of differentiability conditions. A function is C-differentiable or holomorphic
at a if as ∆z →0 in Cm, one has
f(a + ∆z) −f(a) =
m
X
j=1
cj∆zj + o (|∆z|) .
The coefﬁcients cj are the partial derivatives, cj = ∂zjf(a). The fact that this relation
does not depend on the way ∆z tends to 0 implies the Cauchy-Riemann equations.
In a way that parallels the single variable case, it is proved that two conditions are
equivalent: f is analytic; f is complex differentiable.
Iterated integrals are deﬁned in the natural way and one ﬁnds, by a repeated use
of calculus in a single variable,
(50)
f(z) =
1
(2iπ)n
Z
C1
· · ·
Z
Cm
f(ζ)
(ζ1 −z1) · · · (ζm −zm) dζ1 · · · dζm,
where Cj is a small circle surrounding zj in the zj–plane. By differentiation under the
integral sign, Equation (50) also provides an integral formula for the partial derivatives
of f, which is the analogue of Cauchy’s coefﬁcient formula. Iterated integrals are
independent of details of the “polypath” on which they are taken, and uniqueness of
analytic continuation holds.
The theory of functions of several complex variables develops in the direction of
an integral calculus that is much more powerful than the iterated integrals mentioned
above; see for instance the book by A˘ızenberg and Yuzhakov [5] for a multidimen-
sional residue approach. Egorychev’s monograph [147] develops systematic applica-
tions of the theory of functions of one or several complex variables to the evaluation
of combinatorial sums. Pemantle together with several coauthors [388, 389, 390] has
launched an ambitious research programme meant to extract the coefﬁcients of mero-
morphic multivariate generating functions by means of this theory, with the ultimate
goal of obtaining systematically asymptotics from multivariate generating functions.
In contrast, see especially Chapter IX, we can limit ourselves to developing a pertur-
bative theory of one-variable complex function theory.
In the context of this book, the basic notion of analyticity in several complex vari-
ables serves to confer a bona ﬁde analytic meaning to multivariate generating func-
tions. Basic deﬁnitions are also needed in the context of functions f deﬁned implicitly
by functional relations of the form H(z, f) = 0 or H(z, u, f) = 0, where analytic
functions of two or more complex variables (like H) make an appearance. (See in
particular the discussion of the analytic Implicit Function Theorem and the Weierstraß
Preparation Theorem in this Appendix.)


APPENDIX C
Complements of Probability Theory
This appendix contains entries arranged in logical order regarding the following topics:
Probability spaces and measure; Random variables; Transforms of distributions;
Special distributions; Convergence in law.
In this book we start from probability spaces that are ﬁnite, since they arise from objects of a
ﬁxed size in some combinatorial class (see Chapter III of Part A and APPENDIX A: Combi-
natorial probability, p. 671 for elementary aspects), then need basic properties of continuous
distributions in order to characterize asymptotic limit laws. The entries in this appendix are
used principally in Chapter IX of Part C relative to Random Structures. They present a uniﬁed
framework that encompasses discrete and continuous probability distributions alike.
1. Probability spaces and measure. An axiomatization of probability theory1 was
discovered in the 1930s by Kolmogorov. A measurable space consists of a set Ω,
called the set of elementary events or the sample set and a σ-algebra A of subsets of Ω
called events (that is, a collection of sets containing ∅and closed under complement
and denumerable unions). A measure space is a measurable space endowed with a
measure µ : A 7→R≥0 that is additive over ﬁnite or denumerable unions of disjoint
sets; in that case, elements of A are called measurable sets. A probability space is a
measure space for which the measure satisﬁes the further normalization µ(Ω) = 1; in
that case, we also write P for µ. Any set S ⊆Ωsuch that µ(S) = 1 is called a support
of the probability measure.
The deﬁnitions given above cover several important cases.
(i) Finite sets with the uniform measure also known as “counting” measure. In
this case, Ωis ﬁnite, all sets are in A (i.e., are measurable), and (|| · || denotes cardinal-
ity)
µ(E) := ||E||
||S|| .
Nonuniform measures over a ﬁnite set Ωare determined by assigning a nonnegative
weight p(ω) to each element of Ω(with P
ω∈Ωp(ω) = 1) and setting
µ(E) :=
X
e∈E
p(e).
(We also write P(e) for P({e}) ≡µ({e}) = p(e).) In this book, Ωis usually the sub-
class Cn formed by the objects of size n in some combinatorial class C. The uniform
probability is normally assumed, although sometimes weighted models are consid-
ered: see for instance in Chapter III the discussion of weighted word models and
Bernoulli trials as well as the case of weighted tree models and branching processes.
1For this entry we refer to the vivid and well motivated presentation in Williams’ book [497] or to
many classical treatises like the ones by Billingley [55] and Feller [161].
715

716
C. COMPLEMENTS OF PROBABILITY THEORY
(ii) Discrete probability measures over the integers (supported by Z or Z≥0). In
this case the measure is determined by a function p : Z 7→R≥0 and
µ(E) :=
X
e∈E
p(e),
with µ(Z) = 1. (All sets are measurable.) More general discrete measures supported
by denumerable sets of R can be similarly deﬁned.
(iii) The real line R equipped with the σ-algebra generated by the open intervals
constitutes a standard example of a measurable space; in that case, any member of
the σ-algebra is known as a Borel set. The measure, denoted by λ, that assigns to an
interval (a, b) the value λ(a, b) = b −a (and is extended nontrivially to all Borel sets
by additivity) is known as the Lebesgue measure. The interval [0, 1] endowed with λ
is a probability space. The line R itself is not a probability space since λ(R) = +∞.
In the measure-theoretic framework, a random variable is a mapping X from
a probability space Ω(equipped with its σ-algebra A and its measure PΩ) to R
(equipped with its Borel sets B) such that the preimage X−1(B) of any B ∈B lies
in A. For B ∈B, the probability that X lies in B is then deﬁned as
P(X ∈B) := PΩ(X−1(B)).
Since the Borel sets can be generated by the semi-inﬁnite intervals (−∞, x], this prob-
ability is equivalently determined by the function
F(x) := P(X ≤x),
which is called the distribution function or cumulative distribution function of X.
It is then possible to introduce random variables directly by means of distribution
functions, see the next entry below, Random variables.
The next step is to go from measures of sets to integrals of (real valued) func-
tions. Lebesgue integrals are constructed, ﬁrst for indicator functions of intervals,
then for simple (staircase) functions, then for nonnegative functions, ﬁnally for inte-
grable functions. One deﬁnes in this way, for an arbitrary measure µ, the Lebesgue
integral
(1)
Z
fdµ,
also written
Z
f(x)dµ(x)
or
Z
f(x)µ(dx),
where the last notation is often preferred by probabilists. The basic idea is to decom-
pose the domain of values of f into ﬁnitely many measurable sets (Ai) and, for a
positive function f, consider the supremum over all ﬁnite decompositions (Ai)
(2)
Z
f dµ := sup
(Ai)
X
i

inf
ω∈Ai f(ω)

µ(Ai).
(Thus Riemman integration proceeds by decomposing the domain of the function’s
arguments while Lebesgue integrals decomposes the domain of values and appeals to
a richer notion of measure.)
In (1) and (2), the possibility exists that µ assigns a nonzero measure to cer-
tain individual points. In such a context, the integral is sometimes referred to as
the Lebesgue-Stieltjes integral. It suitably generalizes the Riemann-Stieltjes integral

C. COMPLEMENTS OF PROBABILITY THEORY
717
which, given a real valued function M, deﬁnes the following extension of the standard
Riemann integral:
(3)
Z
f(x) dM(x) = lim
(Bk)
X
k
f(xk)∆Bk(M).
There the Bk form a ﬁnite partition of the domain in which the argument of f ranges,
the limit is taken as the largest Bk tends to 0, each xk lies in Bk, and ∆Bk(M) is
the variation of M on Bk. The great advantage of Stieltjes (hence automatically of
Lebesgue) integrals is to unify many of the formulæ relative to discrete and continuous
probability distributions while providing a simple framework adapted to mixed cases.
2. Random variables. A real random variable X is fully characterized by its (cumu-
lative) distribution function
FX(x) := P(X ≤x),
which is a nondecreasing right-continuous function satisfying F(−∞)
=
0,
F(+∞) = 1.
A variable is discrete if it is supported by a ﬁnite or denumerable set.
Almost
all discrete distributions in this book are supported by Z or Z≥0. (An interesting
exception is the collection of limit distributions occurring in longest runs of words;
see Chapter IV.)
A variable X is continuous if it assigns zero probability mass to any ﬁnite or
denumerable set. In particular, it has no jump. An easy theorem states that any distri-
bution function can be decomposed into a discrete and a continuous part,
F(x) = c1F d(x) + c2F c(x),
c1 + c2 = 1.
(The jumps must sum to at most 1, hence their set is at most denumerable.) A variable
is absolutely continuous if it assigns zero probability mass to any Borel set of mea-
sure 0. In that case, the Radon Nikodym Theorem asserts that there exists a function
w such that
FX(x) =
Z x
−∞
w(y) dy.
(There, in all generality, the Lebesgue integral is required but the Riemann integral is
sufﬁcient for all practical purposes in this book.) The function w(x) is called a density
of the random variable X (or of its distribution function). When FX is differentiable
everywhere it admits the density
w(x) = d
dxFX(x),
by the Fundamental Theorem of Calculus.
 III.1. The Lebesgue decomposition theorem. It states that any distribution function F(x)
decomposes as
F(x) = c1F d(x) + c2F ac + c3F s(x),
c1 + c2 + c3 = 1,
where F d is discrete, F ac is absolutely continuous, and F s is continuous but singular, i.e., it
is supported by a Borel set of Lebesgue measure 0. Singular random variables are constructed,
e.g., from the Cantor set.


718
C. COMPLEMENTS OF PROBABILITY THEORY
In this book, all combinatorial distributions are discrete (and then usually sup-
ported by Z≥0). All continuous distributions obtained as limits of discrete ones are,
in our context, absolutely continuous and the qualiﬁer “absolutely” is globally under-
stood when discussing continuous distributions.
If X is a random variable, the expectation of a function g(X) is deﬁned
E (g(X)) =
Z
Ω
g(X)dP =
Z
R
g(x)dF(x),
where the latter form involves the distribution function F of X. In particular the
expectation or mean of X is E(X), and generally its moment of order r is
µ(r) = E(Xr).
(These quantities may not exist for r ̸= 0.)
 III.2. Alternative formulæ for expectations. If X is supported by R≥0 and has a density:
E(X) =
Z ∞
0
(1 −F(x)) dx.
If X is supported by Z≥0:
E(X) =
X
k≥0
P(X > k).
Prrofs are by partial integration and summation: for instance with pk = P(X = k),
E(X) =
X
k≥1
kpk = (p1 + p2 + p3 + · · · ) + (p2 + p3 + · · · ) + (p3 + · · · ) + · · · .
Similar formulæ hold for higher moments.

3. Transforms of distributions. The Laplace transform of X (or of its distribution
function F) is deﬁned2 by
λX(s) := E
 esX
=
Z +∞
−∞
esx dF(x),
and is also known as the moment generating function (see below for an existential
discussion). The characteristic function is deﬁned by
φX(t) = E
 eitX
=
Z +∞
−∞
eitx dF(x),
and it is a Fourier transform. Both transforms are formal variants of one another and
φX(t) = λX(it).
If X is discrete and supported by Z, then its probability generating function (PGF)
is deﬁned as
PX(u) := E(uX) =
X
k∈Z
P(X = k)uk.
As an analytic object this always exists when X is nonnegative (supported by Z≥0),
in which case the PGF is analytic at least in the open disc |u| < 1. If X assumes
arbitrarily large negative values, then the PGF certainly exists on the unit circle, but
2If F has a discrete component, then integration is to be taken in the sense of Lebesgue-Stieltjes or
Riemann-Stieltjes.

C. COMPLEMENTS OF PROBABILITY THEORY
719
sometimes not on a larger domain. The precise domain of existence of the PGF as an
analytic function depends on the geometric rate of decay of the left and right tails of
the distribution, that is, of P(X = k) as k →±∞. The characteristic function of the
variable X (and of its distribution function FX) is
φX(t) := E(eitX) = PX(eit) =
X
k∈Z
P(X = k)eikt.
It always exists for real values of t. The Laplace transform of a discrete distribution is
λX(s) := E(esX) = PX(es) =
X
k∈Z
P(X = k)eks.
If X is a continuous random variable with distribution function F(x) and density
w(x), then the characteristic function is expressed as
φX(t) := E(eitX) =
Z
R
eitxw(x) dx.
and the Laplace transform is
λX(s) := E(esX) =
Z
R
esxw(x) dx.
The Fourier transform always exists for real arguments (by integrability of the Fourier
kernel eit whose modulus is 1). The Laplace transform, when it exists in a strip,
extends analytically the characteristic function via the equality φX(t) = λX(it). The
Laplace transform is also called the moment generating function since an alternative
formulation of its deﬁnition, valid for discrete and continuous cases alike, is
λX(s) :=
X
k≥0
E(Xk)sk
k! ,
which indeed represents the exponential generating function of moments. (We prefer
not to use this terminology so as to avoid a possible confusion with the many other
types generating functions employed in this book.)
 III.3. Centring, scaling, and standardization.
Let X be a random variable.
Deﬁne
Y =
X−µ
σ
. The representations as expectations of the Laplace transform of the characteris-
tic function make it obvious that
φY (t) = e−µitφX
„ t
σ
«
,
λY (s) = e−µsλX
“ s
σ
”
.
One says that Y is obtained from X by centring (by a shift of µ) and scaling (by a factor of σ).
If µ and σ are the mean and standard deviation of X, then one says that Y is a standardized
version of X.

 III.4. Moments and transforms. The moments are accessible from either transform,
µ(r) := E{Y r} = dr
dsr λ(s)
˛˛˛˛
s=0
= (−i)r dr
dtr φ(t)
˛˛˛˛
t=0
.

720
C. COMPLEMENTS OF PROBABILITY THEORY
In particular, we have
(4)
µ
=
d
dsλ(s)
˛˛˛˛
s=0
= −i d
dtφ(t)
˛˛˛˛
t=0
µ(2)
=
d2
ds2 λ(s)
˛˛˛˛
s=0
= −d
dtφ(t)
˛˛˛˛
t=0
σ2
=
d2
ds2 log λ(s)
˛˛˛˛
s=0
= −d2
dt2 log φ(t)
˛˛˛˛
t=0
.
The direct expression of the standard deviation in terms of log λ(s), called the cumulant gener-
ating function, often proves computationally handy.

 III.5. Mellin transforms of distributions. The quantity M(s) := E(Xs−1) is called the
Mellin transform of X (or of its distribution function F), when X is supported by R≥0. In
particular, if X admits a density, then this notion coincides with the usual deﬁnition of a Mellin
transform. When it exists, the value of the Mellin transform at an integer s = k provides the
moment of order k −1. At other points, the Mellin transform provides moments of fractional
order.

 III.6. A “symbolic” fragment of probability theory. Consider discrete random variables
supported by Z≥0. Let X, X1, . . . be random variables with PGF p(u) and let Y have PGF
q(u). Then, certain natural operations admit a translation into PGFs:
Operation
PGF
Switch
(Bern(λ) ⇒X | Y )
λp(u) + (1 −λ)q(u)
Sum
X + Y
p(u) · q(u)
X1 + · · · + Xn
p(u)n
Random sum
X + 1 + · · · + XY
q(p(u))
Size bias
∂X
up′(u)
p′(1)
(“Bern” means a Bernoulli {0, 1} variable B and the switch is interpreted as BX + (1 −B)Y .
Size-biased distributions occur in Chapter VII.)

The importance of these transforms derives from the existence of continuity the-
orem by which convergence of distributions can be established via convergence of
transforms.
4. Special distributions. A compendium of special distribution is provided by Fig-
ure 1.
A Bernoulli trial of parameter q is an event that has probability q of having value 0
(interpreted as “failure”) and probability p of having value 1 (interpreted as “success”),
with p+q = 1. Formally, this is the set Ω= {0, 1} endowed with the probability mea-
sure P(0) = q, P(1) = p. The binomial distribution (also called Bernoulli distribu-
tion) of parameters n, q is the random variable that represents the number of successes
in n independent Bernoulli trials. This is the probability distribution associated with
the game of heads-and-tails. The geometric distribution is the distribution of a ran-
dom variable X that records the number of failures till the ﬁrst success is encountered
in a potentially arbitrarily long sequence of Bernoulli trials. By extension, one also
refers to independent experiments with ﬁnitely many possible outcomes as Bernoulli
trials. In that sense, the model of words of some ﬁxed length over a ﬁnite alphabet and
nonuniform letter weights (or probabilities) belongs to the category of Bernoulli mod-
els; see Chapter III. The negative binomial distribution of index m (written NB[m])

C. COMPLEMENTS OF PROBABILITY THEORY
721
Distrib.
Prob. (D), density (C)
PGF(D), Char. function (C)
D
Binomial (n, p)
 
n
k
!
pk(1 −p)n−k
(q + pz)n
D
Geometric (q)
(1 −q)qk
1 −q
1 −qz
D
Neg. binomial[m] (q)
 
m + k −1
k
!
qk(1 −q)m
„ 1 −q
1 −qz
«m
D
Log. series (λ)
1
−log(1 −λ)
λk
k!
log(1 −λz)
log(1 −λ)
D
Poisson (λ)
e−λ λk
k!
eλ(1−z)
C
Gaussian or Normal, N(0, 1)
e−x2/2
√
2π
e−t2/2
C
Exponential
e−x
1
1 −it
C
Uniform [−1
2, + 1
2]
[[−1
2 ≤x ≤+ 1
2]]
sin(t/2)
(t/2)
FIGURE III.1.
A list of commonly encountered discrete (D) and continuous
(C) probability distributions: type, name, probabilities or density, probability
generating function or characteristic function.
and parameter q corresponds to the number of failures before m successes are en-
countered. We have found in Chapter VII that it is systematically associated with the
number of r–components in an unlabelled multiset schema F = M(G) whose com-
position of singularities is of the exp-log type. The geometric distribution appears
in several schemas related to sequences while the logarithmic series distribution is
closely tied to cycles (Chapter V).
The Poisson distribution counts amongst the most important distributions of prob-
ability theory. Its essential properties are recalled in Figure 1. It occurs for instance in
the distribution of singleton cycles and of r-cycles in a random permutation and more
generally in labelled composition schemes (Chapter IX).
In this book all probability distributions arising directly from combinatorics are a
priori discrete as they are deﬁned on ﬁnite sets—typically a certain subclass Cn of a
combinatorial class C. However, as the size n of the objects considered grows, these
ﬁnite distributions may approach a continuous limit. In this context, by far the most
important law is the Gaussian law also known as normal law, which is deﬁned by its
density and its distribution function:
(5)
g(x) = e−x2/2
√
2π
,
Φ(x) =
1
√
2π
Z x
−∞
e−y2/2 dy.
The corresponding Laplace transform is then evaluated by completing the square:
λ(s) =
1
√
2π
Z +∞
−∞
e−y2/2+sy dy. = es2/2,

722
C. COMPLEMENTS OF PROBABILITY THEORY
Characteristic function (φ(t))
Distribution function (F(x))
φ(0) = 1
F(−∞) = 0, F(+∞) = 1
|φ(t0)| = 1 for some t0 ̸= 0
Lattice distribution, span 2π
t0
φ(t) =
t→0 1 + iµt + o(t)
E(X) = µ < ∞
φ(t) =
t→0 1 + iµt −ν t2
2 + o(t2)
E(X2) = ν < ∞
log φ(t) = −t2
2
X
d= N(0, 1)
φ(t) →0 as t →∞
X is continuous
φ(t) integrable (is in L1)
X is absolutely continuous
density is w(x) = 1
2π
Z +∞
−∞
e−itxφ(t) dt.
λ(s) := φ(−is) exists in α < ℜ(s) < β
Exponential tails
limT →∞
1
2T
R +T
−T |φ(t)|2 dt
equals P
i(pi)2; the pi are the jumps
φn(t) →φ(t) (point conv.)
Fn
D
=⇒F (weak conv.)
Xn
D
=⇒X (conv. in distribution)
φn “close” to φ
Fn “close” to F (Berry-Esseen)
FIGURE III.2.
The correspondence between properties of the distribution func-
tion (F) of a random variable (X) and properties of the corresponding character-
istic functions (φ).
and, similarly, the characteristic function is φ(t) = e−t2/2. The distribution of (5) is
referred to as the standard normal distribution, N(0, 1); if X is N(0, 1), the variable
Y = µ + σX deﬁnes the normal distribution with mean µ and standard deviation σ,
denoted N(µ, σ).
Amongst other continuous distributions appearing in this book, we mention the
theta distributions associated to the height of trees and Dyck paths (Chapter V) and
the stable laws alluded to in Chapter VI.
5. Convergence in law. Let Fn be a family of distribution functions Fn. We say
generally that the Fn converge weakly to a distribution function F if pointwise
(6)
lim
n Fn(x) = F(x),
for every continuity point x of F. This is expressed by writing Fn ⇒F as well
as Xn
D
=⇒X, if Xn, X are random variables corresponding to Fn, F. We say that
Xn converges in distribution or converges in law to X. For discrete distributions
supported by Z, and equivalent form of (6) is limn Fn(k) = F(k) for each k ∈Z;
for continuous distributions, Equation (6) just means that limn Fn(x) = F(x) for
all x ∈R. Although in all generality anything can tend to anything else, due to the
ﬁnite nature of combinatorics, we shall only need in this book the convergences
Discrete ⇒Discrete,
Discrete ⇒Continuous (after standardization).

C. COMPLEMENTS OF PROBABILITY THEORY
723
Properties of random variables are reﬂected by probabilities of characteristic
functions and Figure 2 offers an aperc¸u. Most important for us is the Continuity
Theorem of characteristic functions due to L´evy and stated in Chapter IX. The Berry–
Esseen inequalities also stated in Chapter IX lie at the origin of precise speed of con-
vergence estimates to asymptotic limits.


Bibliography
1. S.-S. Abhyankar, Algebraic geometry for scientists and engineers, American Mathematical Society,
1990.
2. Milton Abramowitz and Irene A. Stegun, Handbook of mathematical functions, Dover, 1973, A reprint
of the tenth National Bureau of Standards edition, 1964.
3. A. V. Aho and J. D. Ullman, Principles of compiler design, Addison-Wesley, 1977.
4. Alfred V. Aho and Margaret J. Corasick, Efﬁcient string matching: an aid to bibliographic search,
Communications of the ACM 18 (1975), 333–340.
5. I. A. A˘ızenberg and A. P. Yuzhakov, Integral representations and residues in multidimensional com-
plex analysis, Translations of Mathematical Monographs, vol. 58, American Mathematical Society,
Providence, RI, 1983.
6. David Aldous, Deterministic and stochastic models for coalescence (aggregation and coagulation):
a review of the mean-ﬁeld theory for probabilists, Bernoulli 5 (1999), no. 1, 3–48.
7. David Aldous and Persi Diaconis, Longest increasing subsequences: from patience sorting to the
Baik-Deift-Johansson theorem, American Mathematical Society. Bulletin. New Series 36 (1999),
no. 4, 413–432.
8. David Aldous and James A. Fill, Reversible Markov chains and random walks on graphs, 2003, Book
in preparation; mansucript available electronically.
9. Noga Alon and Joel H. Spencer, The probabilistic method, John Wiley & Sons Inc., New York, 1992.
10. George E. Andrews, The theory of partitions, Encyclopedia of Mathematics and its Applications,
vol. 2, Addison–Wesley, 1976.
11. George E. Andrews, Richard Askey, and Ranjan Roy, Special functions, Encyclopedia of Mathematics
and its Applications, vol. 71, Cambridge University Press, 1999.
12. Tom M. Apostol, Introduction to analytic number theory, Springer-Verlag, 1976.
13.
, Modular functions and Dirichlet series in number theory, Springer-Verlag, New York, 1976,
Graduate Texts in Mathematics, No. 41.
14. J. Arney and E. D. Bender, Random mappings with constraints on coalescence and number of origins,
Paciﬁc Journal of Mathematics 103 (1982), 269–294.
15. Richard Arratia, A. D. Barbour, and Simon Tavar´e, Random combinatorial structures and prime fac-
torizations, Notices of the American Mathematical Society 44 (1997), no. 8, 903–910.
16.
, Logarithmic combinatorial structures: a probabilistic approach, EMS Monographs in Math-
ematics, European Mathematical Society (EMS), Z¨urich, 2003.
17. Krishna B. Athreya and Peter E. Ney, Branching processes, Springer-Verlag, New York, 1972, Die
Grundlehren der mathematischen Wissenschaften, Band 196.
18. Raymond Ayoub, An introduction to the analytic theory of numbers, Mathematical Surveys, No. 10,
American Mathematical Society, Providence, R.I., 1963.
19. Jinho Baik, Percy Deift, and Kurt Johansson, On the distribution of the length of the longest increasing
subsequence of random permutations, Journal of the American Mathematical Society 12 (1999), no. 4,
1119–1178.
20. Cyril Banderier, Mireille Bousquet-M´elou, Alain Denise, Philippe Flajolet, Dani`ele Gardy, and Do-
minique Gouyou-Beauchamps, Generating functions of generating trees, Discrete Mathematics 246
(2002), no. 1-3, 29–55.
21. Cyril Banderier and Philippe Flajolet, Basic analytic combinatorics of directed lattice paths, Theoret-
ical Computer Science 281 (2002), no. 1-2, 37–80.
22. Cyril Banderier, Philippe Flajolet, Gilles Schaeffer, and Mich`ele Soria, Random maps, coalescing sad-
dles, singularity analysis, and Airy phenomena, Random Structures & Algorithms 19 (2001), no. 3/4,
194–246.
725

726
BIBLIOGRAPHY
23. A. D. Barbour, Lars Holst, and Svante Janson, Poisson approximation, The Clarendon Press Oxford
University Press, New York, 1992, Oxford Science Publications.
24. Alan F. Beardon, Iteration of rational functions, Graduate Texts in Mathematics, Springer Verlag,
1991.
25. Jason P. Bell, Stanley N. Burris, and Karen A. Yeats, Counting rooted trees: The universal law t(n) ∼
Cρ−nn−3/2, Electronic Journal of Combinatorics 13 (2006), no. R63, 1–64.
26. Richard Bellman, Matrix analysis, S.I.A.M. Press, Philadelphia, Pa, 1997, A reprint of the second
edition, ﬁrst published by McGraw-Hill, New York, 1970.
27. E. A. Bender and L. B. Richmond, Multivariate asymptotics for products of large powers with appli-
cation to Lagrange inversion, Electronic Journal of Combinatorics 6 (1999), R8, 21pp.
28. Edward A. Bender, Central and local limit theorems applied to asymptotic enumeration, Journal of
Combinatorial Theory 15 (1973), 91–111.
29.
, Asymptotic methods in enumeration, SIAM Review 16 (1974), no. 4, 485–515.
30.
, Convex n–ominoes, Discrete Mathematics 8 (1974), 219–226.
31. Edward A. Bender and E. Rodney Canﬁeld, The asymptotic number of labeled graphs with given
degree sequences, Journal of Combinatorial Theory, Series A 24 (1978), 296–307.
32. Edward A. Bender, E. Rodney Canﬁeld, and Brendan D. McKay, Asymptotic properties of labeled
connected graphs, Random Structures & Algorithms 3 (1992), no. 2, 183–202.
33. Edward A. Bender, Zhicheng Gao, and Nicholas C. Wormald, The number of labeled 2-connected
planar graphs, Electronic Journal of Combinatorics 9 (2002), no. 1, Research Paper 43, 13 pp.
34. Edward A. Bender and Jay R. Goldman, Enumerative uses of generating functions, Indiana University
Mathematical Journal (1971), 753–765.
35. Edward A. Bender and Fred Kochman, The distribution of subword counts is usually normal, Euro-
pean Journal of Combinatorics 14 (1993), 265–275.
36. Edward A. Bender and L. Bruce Richmond, Central and local limit theorems applied to asymptotic
enumeration II: Multivariate generating functions, Journal of Combinatorial Theory, Series A 34
(1983), 255–265.
37. Edward A. Bender, L. Bruce Richmond, and S. G. Williamson, Central and local limit theorems
applied to asymptotic enumeration. III. Matrix recursions, Journal of Combinatorial Theory, Series A
35 (1983), no. 3, 264–278.
38. Jon Bentley and Robert Sedgewick, Fast algorithms for sorting and searching strings, Eighth Annual
ACM-SIAM Symposium on Discrete Algorithms, SIAM Press, 1997.
39. F. Bergeron, G. Labelle, and P. Leroux, Combinatorial species and tree-like structures, Cambridge
University Press, Cambridge, 1998.
40. Franc¸ois Bergeron, Philippe Flajolet, and Bruno Salvy, Varieties of increasing trees, CAAP’92 (J.-C.
Raoult, ed.), Lecture Notes in Computer Science, vol. 581, 1992, Proceedings of the 17th Colloquium
on Trees in Algebra and Programming, Rennes, France, February 1992., pp. 24–48.
41. Elwyn R. Berlekamp, Algebraic coding theory, Mc Graw-Hill, 1968, Revised edition, 1984.
42. Bruce C. Berndt, Ramanujan’s notebooks, part I, Springer Verlag, 1985.
43. J. Berstel, Sur les pˆoles et le quotient de Hadamard de s´eries n-rationnelles, Comptes–Rendus de
l’Acad´emie des Sciences 272 (1971), no. S´erie A, 1079–1081.
44. J. Berstel and C. Reutenauer, Recognizable formal power series on trees, Theoretical Computer Sci-
ence 18 (1982), 115–148.
45. Jean Berstel (ed.), S´eries formelles, LITP, University of Paris, 1978, (Proceedings of a School, Vieux–
Boucau, France, 1977).
46. Jean Berstel and Dominique Perrin, Theory of codes, Academic Press Inc., Orlando, Fla., 1985.
47. Jean Berstel and Christophe Reutenauer, Les s´eries rationnelles et leurs langages, Masson, Paris,
1984.
48. Jean Bertoin, Philippe Biane, and Marc Yor, Poissonian exponential functionals, q-series, q-integrals,
and the moment problem for log-normal distributions, Tech. Report PMA-705, Laboratoire de Proba-
bilit´s et Mod`eles Al´eatoires, Universit´e Paris VI, 2002.
49. Alberto Bertoni, Christian Choffrut, Massimiliano Goldwurm Goldwurm, and Violetta Lonati, On the
number of occurrences of a symbol in words of regular languages, Theoretical Computer Science 302
(2003), no. 1–3, 431–456.
50. A. T. Bharucha-Reid, Elements of the theory of Markov processes and their applications, Dover, 1997,
A reprint of the original McGraw-Hill edition, 1960.
51. Philippe Biane, Permutations suivant le type d’excedance et le nombre d’inversions et interpr´etation
combinatoire d’une fraction continue de Heine, European Journal of Combinatorics 14 (1993), 277–
284.

BIBLIOGRAPHY
727
52. Philippe Biane, Jim Pitman, and Marc Yor, Probability laws related to the Jacobi theta and Riemann
zeta functions, and Brownian excursions, Bulletin of the American Mathematical Society (N.S.) 38
(2001), no. 4, 435–465.
53. Norman L. Biggs, Algebraic graph theory, Cambridge University Press, 1974.
54. Norman L. Biggs, E. Keith Lloyd, and Robin Wilson, Graph theory, 1736–1936, Oxford University
Press, 1974.
55. Patrick Billingsley, Probability and measure, 2nd ed., John Wiley & Sons, 1986.
56. N. H. Bingham, C. M. Goldie, and J. L. Teugels, Regular variation, Encyclopedia of Mathematics
and its Applications, vol. 27, Cambridge University Press, Cambridge, 1989.
57. G. D. Birkhoff, Formal theory of irregular linear difference equations, Acta Mathematica 54 (1930),
205–246.
58. J. E. Bj¨ork, Rings of differential operators, North Holland P. C., Amsterdam, 1979.
59. Norman Bleistein and Richard A. Handelsman, Asymptotic expansions of integrals, Dover, New York,
1986, A reprint of the second Holt, Rinehart and Winston edition, 1975.
60. B´ela Bollob´as, Random graphs, Academic Press, 1985.
61. B´ela Bollob´as, Christian Borgs, Jennifer T. Chayes, Jeong Han Kim, and David B. Wilson, The scaling
window of the 2-SAT transition, Random Structures & Algorithms 18 (2001), no. 3, 201–256.
62. D. Borwein, S. Rankin, and L. Renner, Enumeration of injective partial transformations, Discrete
Mathematics 73 (1989), 291–296.
63. Jonathan M. Borwein and Peter B. Borwein, Strange series and high precision fraud, American Math-
ematical Monthly 99 (1992), no. 7, 622–640.
64. Jonathan M. Borwein, Peter B. Borwein, and Karl Dilcher, Pi, Euler numbers and asymptotic expan-
sions, American Mathematical Monthly 96 (1989), no. 8, 681–687.
65. J´er´emie Bourdon and Brigitte Vall´ee, Generalized pattern matching statistics, Mathematics and com-
puter science, II (Versailles, 2002) (B. Chauvin et al., ed.), Trends Math., Birkh¨auser, Basel, 2002,
pp. 249–265.
66. Mireille Bousquet-M´elou, A method for the enumeration of various classes of column-convex poly-
gons, Discrete Math. 154 (1996), no. 1-3, 1–25.
67.
, Limit laws for embedded trees. applications to the integrated superbrownian excursion,
ArXiv, 2005, Preprint math.CO/0501266. To appear in Random Structures and Algorithms.
68.
, Rational and algebraic series in combinatorial enumeration, Preprint, 2006, Based on the
author’s presentation at ICM 2006, Madrid, 38 pages.
69. Mireille Bousquet-M´elou and Anthony J. Guttmann, Enumeration of three-dimensional convex poly-
gons, Annals of Combinatorics 1 (1997), 27–53.
70. Mireille Bousquet-M´elou and Marko Petkovˇsek, Linear recurrences with constant coefﬁcients: the
multivariate case, Discrete Mathematics 225 (2000), no. 1-3, 51–75.
71. Gilles Brassard and Paul Bratley, Algorithmique: conception et analyse, Masson, Paris, 1987.
72. Leo Breiman, Probability, Society for Industrial and Applied Mathematics (SIAM), Philadelphia, PA,
1992, Corrected reprint of the 1968 original.
73. W. G. Brown and W. T. Tutte, On the enumeration of rooted non-separable planar maps, Canadian
Journal of Mathematics 16 (1964), 572–577.
74. W. H. Burge, An analysis of binary search trees formed from sequences of nondistinct keys, JACM 23
(1976), no. 3, 451–454.
75. Stanley N. Burris, Number theoretic density and logical limit laws, Mathematical Surveys and Mono-
graphs, vol. 86, American Mathematical Society, Providence, RI, 2001.
76. E. Rodney Canﬁeld, Central and local limit theorems for the coefﬁcients of polynomials of binomial
type, Journal of Combinatorial Theory, Series A 23 (1977), 275–290.
77.
, Remarks on an asymptotic method in combinatorics, Journal of Combinatorial Theory, Series
A 37 (1984), 348–352.
78. L. Carlitz, Permutations, sequences and special functions, S.I.A.M. Review 17 (1975), 298–322.
79. Henri Cartan, Th´eorie ´el´ementaire des fonctions analytiques d’une ou plusieurs variables complexes,
Hermann, 1961.
80. Pierre Cartier and Dominique Foata, Probl`emes combinatoires de commutation et r´earrangements,
Lecture Notes in Mathematics, vol. 85, Springer Verlag, 1969.
81. Fr´ed´eric Cazals, Monomer-dimer tilings, Studies in Automatic Combinatorics 2 (1997), Electronic
publication http://algo.inria.fr/libraries/autocomb/autocomb.html.
82. Philippe Chassaing and Jean-Franc¸ois Marckert, Parking functions, empirical processes, and the width
of rooted labeled trees, Electronic Journal of Combinatorics 8 (2001), no. 1, Research Paper 14, 19
pp. (electronic).

728
BIBLIOGRAPHY
83. Philippe Chassaing, Jean-Franc¸ois Marckert, and Marc Yor, The height and width of simple trees,
Mathematics and computer science (Versailles, 2000), Trends Math., Birkh¨auser, Basel, 2000, pp. 17–
30.
84. Brigitte Chauvin, Michael Drmota, and Jean Jabbour-Hattab, The proﬁle of binary search trees, The
Annals of Applied Probability 11 (2001), no. 4, 1042–1062.
85. Brigitte Chauvin, Philippe Flajolet, Dani`ele Gardy, and Bernhard Gittenberger, And/Or Trees Re-
visited, Combinatorics, Probability and Computing 13 (2004), no. 4–5, 501–513, Special issue on
Analysis of Algorithms.
86. Hua-Huai Chern and Hsien-Kuei Hwang, Partial match queries in random quadtrees, SIAM Journal
on Computing 32 (2003), no. 4, 904–915.
87. Hua-Huai Chern, Hsien-Kuei Hwang, and Tsung-Hsi Tsai, An asymptotic theory for Cauchy-Euler
differential equations with applications to the analysis of algorithms, Journal of Algorithms 44 (2002),
no. 1, 177–225.
88. T. S. Chihara, An introduction to orthogonal polynomials, Gordon and Breach, New York, 1978.
89. Noam Chomsky and Marcel Paul Sch¨utzenberger, The algebraic theory of context–free languages,
Computer Programing and Formal Languages (P. Braffort and D. Hirschberg, eds.), North Holland,
1963, pp. 118–161.
90. Fr´ed´eric Chyzak, Gr¨obner bases, symbolic summation and symbolic integration, Gr¨obner Bases and
Applications (B. Buchberger and F. Winkler, eds.), London Mathematical Society Lecture Notes
Series, vol. 251, Cambridge University Press, 1998, In Proceedings of the Conference 33 Years of
Gr¨obner Bases, pp. 32–60.
91. Fr´ed´eric Chyzak, Marni Mishna, and Bruno Salvy, Effective scalar products of D-ﬁnite symmetric
functions, Journal of Combinatorial Theory, Series A 112 (2005), no. 1, 1–43.
92. Fr´ed´eric Chyzak and Bruno Salvy, Non-commutative elimination in Ore algebras proves multivariate
identities, Journal of Symbolic Computation 26 (1998), no. 2, 187–227.
93. Julien Cl´ement, Philippe Flajolet, and Brigitte Vall´ee, Dynamical sources in information theory: A
general analysis of trie structures, Algorithmica 29 (2001), no. 1/2, 307–369.
94. Kevin J. Compton, A logical approach to asymptotic combinatorics. I. First order properties, Ad-
vances in Mathematics 65 (1987), 65–96.
95.
, A logical approach to asymptotic combinatorics. II. Second–order properties, Journal of
Combinatorial Theory, Series A 50 (1987), 110–131.
96.
, 0–1 laws in logic and combinatorics, Proceedings NATO Advanced Study Institute on Al-
gorithms and Order (Dordrecht) (I. Rival, ed.), Reidel, 1988, pp. 353–383.
97. Louis Comtet, Calcul pratique des coefﬁcients de Taylor d’une fonction alg´ebrique, Enseignement
Math´ematique. 10 (1964), 267–270.
98.
, Advanced combinatorics, Reidel, Dordrecht, 1974.
99. Eric van Fossen Conrad and Philippe Flajolet, The Fermat cubic, elliptic functions, continued frac-
tions, and a combinatorial excursion, S´eminaire Lotharingien de Combinatoire 54 (2006), no. B54g,
1–44.
100. Robert M. Corless, G. H. Gonnet, D. E. G. Hare, D. J. Jeffrey, and D. E. Knuth, On the Lambert W
function, Advances in Computational Mathematics 5 (1996), 329–359.
101. T. H. Cormen, C. E. Leiserson, and R. L. Rivest, Introduction to Algorithms, MIT Press, New York,
1990.
102. S. C. Coutinho, A primer of algebraic D-modules, London Mathematical Society Student Texts,
vol. 33, Cambridge University Press, Cambridge, 1995.
103. Thomas M. Cover and Joy A. Thomas, Elements of information theory, John Wiley & Sons Inc., New
York, 1991, A Wiley-Interscience Publication.
104. David Cox, John Little, and Donal O’Shea, Ideals, varieties, and algorithms: an introduction to
computational algebraic geometry and commutative algebra, 2nd ed., Springer, 1997.
105. H. E. Daniels, Saddlepoint approximations in statistics, Annals of Mathematical Statistics 25 (1954),
631–650.
106. Gaston Darboux, M´emoire sur l’approximation des fonctions de tr`es grands nombres, et sur une
classe ´etendue de d´eveloppements en s´erie, Journal de Math´ematiques Pures et Appliqu´ees (1878),
5–56,377–416.
107. H. Davenport, Multiplicative Number Theory, revised by H. L. Montgomery, second ed., Springer-
Verlag, New York, 1980.
108. F. N. David and D. E. Barton, Combinatorial chance, Charles Grifﬁn, London, 1962.
109. N. G. de Bruijn, A combinatorial problem, Nederl. Akad. Wetensch., Proc. 49 (1946), 758–764, Also
in Indagationes Math. 8, 461–467 (1946).

BIBLIOGRAPHY
729
110.
, On Mahler’s partition problem, Indagationes Mathematicae X (1948), 210–220, Reprinted
from Koninklijke Nederlansche Akademie Wetenschappen.
111.
, Asymptotic methods in analysis, Dover, 1981, A reprint of the third North Holland edition,
1970 (ﬁrst edition, 1958).
112. N. G. de Bruijn and D. A. Klarner, Multisets of aperiodic cycles, SIAM Journal on Algebraic and
Discrete Methods 3 (1982), 359–368.
113. N. G. de Bruijn, D. E. Knuth, and S. O. Rice, The average height of planted plane trees, Graph Theory
and Computing (R. C. Read, ed.), Academic Press, 1972, pp. 15–22.
114. Percy Deift, Integrable systems and combinatorial theory, Notices of the American Mathematical
Society 47 (2000), no. 6, 631–640.
115. J. M. DeLaurentis and B. G. Pittel, Random permutations and brownian motion, Paciﬁc Journal of
Mathematics 119 (1985), no. 2, 287–301.
116. Marie-Pierre Delest and G´erard Viennot, Algebraic languages and polyominoes enumeration, Theo-
retical Computer Science 34 (1984), 169–206.
117. Michael Dellnitz, Oliver Sch¨utze, and Qinghua Zheng, Locating all the zeros of an analytic function
in one complex variable, J. Comput. Appl. Math. 138 (2002), no. 2, 325–333.
118. A. Dembo, A. Vershik, and O. Zeitouni, Large deviations for integer partitions, Markov Processes
and Related Fields 6 (2000), no. 2, 147–179.
119. Frank den Hollander, Large deviations, American Mathematical Society, Providence, RI, 2000.
120. J. Denef and L. Lipshitz, Algebraic power series and diagonals, Journal of Number Theory 26 (1987),
46–67.
121. Nachum Dershowitz and Shmuel Zaks, The cycle lemma and some applications, European Journal of
Combinatorics 11 (1990), 35–40.
122. Robert L. Devaney, A ﬁrst course in chaotic dynamical systems, Addison-Wesley Studies in Nonlin-
earity, Addison-Wesley Publishing Company Advanced Book Program, Reading, MA, 1992, Theory
and experiment, With a separately available computer disk.
123. Luc Devroye, A note on the expected height of binary search trees, Journal of the ACM 33 (1986),
489–498.
124.
, Branching processes in the analysis of the heights of trees, Acta Informatica 24 (1987),
277–298.
125.
, Limit laws for local counters in random binary search trees, Random Structures & Algo-
rithms 2 (1991), no. 3, 302–315.
126.
, Universal limit laws for depths in random trees, SIAM Journal on Computing 28 (1999),
no. 2, 409–432.
127. Philippe Di Francesco, Folding and coloring problems in mathematics and physics, Bull. Amer. Math.
Soc. (N.S.) 37 (2000), no. 3, 251–307.
128. P. Dienes, The Taylor series, Dover, New York, 1958, A reprint of the ﬁrst Oxford University Press
edition, 1931.
129. Jean Dieudonn´e, Calcul inﬁnit´esimal, Hermann, Paris, 1968.
130. J. D. Dixon, Asymptotics of generating the symmetric and alternating groups, Electronic Journal of
Combinatorics 12 (2005), no. R56, 1–5.
131. G. Doetsch, Handbuch der Laplace-Transformation, vol. 1–3, Birkh¨auser Verlag, Basel, 1955.
132. C. Domb and A.J. Barrett, Enumeration of ladder graphs, Discrete Mathematics 9 (1974), 341–358.
133. Peter G. Doyle and J. Laurie Snell, Random walks and electric networks, Mathematical Association
of America, Washington, DC, 1984.
134. Michael Drmota, Asymptotic distributions and a multivariate Darboux method in enumeration prob-
lems, Manuscript, November 1990.
135.
, Systems of functional equations, Random Structures & Algorithms 10 (1997), no. 1–2, 103–
124.
136. Michael Drmota and Bernhard Gittenberger, On the proﬁle of random trees, Random Structures &
Algorithms 10 (1997), no. 4, 421–451.
137. Michael Drmota and Mich`ele Soria, Marking in combinatorial constructions: Generating functions
and limiting distributions, Theoretical Computer Science 144 (1995), no. 1–2, 67–99.
138. Michael Drmota and Mich`ele Soria, Images and preimages in random mappings, SIAM Journal on
Discrete Mathematics 10 (1997), no. 2, 246–269.
139. Philippe Duchon, Philippe Flajolet, Guy Louchard, and Gilles Schaeffer, Boltzmann samplers for
the random generation of combinatorial structures, Combinatorics, Probability and Computing 13
(2004), no. 4–5, 577–625, Special issue on Analysis of Algorithms.

730
BIBLIOGRAPHY
140. Philippe Dumas and Philippe Flajolet, Asymptotique des r´ecurrences mahleriennes: le cas cyclo-
tomique, Journal de Th´eorie des Nombres de Bordeaux 8 (1996), no. 1, 1–30.
141. Thomas Duquesne and Jean-Francc¸ois Le Gall, Random Trees, Levy Processes and Spatial Branching
Processes, arXiv:math.PR/0509558, 2005.
142. Marianne Durand, Combinatoire analytique et algorithmique des ensembles de donn´ees, Ph.D. thesis,
´Ecole Polytechnique, France, 2004.
143. Richard Durrett, Probability: theory and examples, second ed., Duxbury Press, Belmont, CA, 1996.
144. Isabelle Dutour and Jean-Marc F´edou, Object grammars and random generation, Discrete Mathemat-
ics and Theoretical Computer Science 2 (1998), 47–61.
145. A. Dvoretzky and Th. Motzkin, A problem of arrangements, Duke Mathematical Journal 14 (1947),
305–313.
146. Alan Edelman and Eric Kostlan, How many zeros of a random polynomial are real?, Bull. Amer.
Math. Soc. (N.S.) 32 (1995), no. 1, 1–37.
147. G. P. Egorychev, Integral representation and the computation of combinatorial sums, Translations of
Mathematical Monographs, vol. 59, American Mathematical Society, Providence, RI, 1984, Trans-
lated from the Russian by H. H. McFadden, Translation edited by Lev J. Leifman.
148. Paul Ehrenfest and Tatiana Ehrenfest, ¨Uber zwei bekannte Einw¨ande gegen das Boltzmannsche H-
Theorem, Physikalische Zeitschrift 8 (1907), no. 9, 311–314.
149. Samuel Eilenberg, Automata, languages, and machines, vol. A, Academic Press, 1974.
150. S. Elizalde and M. Noy, Consecutive patterns in permutations, Advances in Applied Mathematics 30
(2003), no. 1-2, 110–125.
151. P. D. T. A. Elliott, Probabilistic number theory. I, Grundlehren der Mathematischen Wissenschaften
[Fundamental Principles of Mathematical Science], vol. 239, Springer-Verlag, New York, 1979,
Mean-value theorems.
152. I. G. Enting, Generating functions for enumerating self-avoiding rings on the square lattice, Journal
of Physics A: Mathematical and General 18 (1980), 3713–3722.
153. A. Erd´elyi, Higher transcendental functions, second ed., vol. 1-2-3, R. E. Krieger publishing Com-
pany, Inc., Malabar, Florida, 1981.
154. P. Erd˝os and A. R´enyi, On a classical problem of probability theory, Magyar Tud. Akad. Mat. Kutat´o
Int. K¨ozl. 6 (1961), 215–220.
155. Paul Erd˝os and Joseph Lehner, The distribution of the number of summands in the partitions of a
positive integer, Duke Mathematical Journal 8 (1941), 335–345.
156. Leonhard Euler, Letter to goldbach, dated september 4, 1751, Published as “Lettre CXL, Euler `a
Goldbach”.
157. H. M. Farkas and I. Kra, Riemann surfaces, second ed., Graduate Texts in Mathematics, vol. 71,
Springer-Verlag, New York, 1992.
158. Guy Fayolle and Roudolf Iasnogorodski, Two coupled processors: the reduction to a Riemann-Hilbert
problem, Zeitschrift f¨ur Wahrscheinlichkeitstheorie und Verwandte Gebiete 47 (1979), no. 3, 325–351.
159. Guy Fayolle, Roudolf Iasnogorodski, and Vadim Malyshev, Random walks in the quarter-plane,
Springer-Verlag, Berlin, 1999.
160. Julien Fayolle, An average-case analysis of basic parameters of the sufﬁx tree, Mathematics and
Computer Science III: Algorithms, Trees, Combinatorics and Probabilities (M. Drmota et al., ed.),
Trends in Mathematics, Birkh¨auser Verlag, 2004, pp. 217–227.
161. W. Feller, An introduction to probability theory and its applications, third ed., vol. 1, John Wiley,
1968.
162.
, An introduction to probability theory and its applications, vol. 2, John Wiley, 1971.
163. James A. Fill, Philippe Flajolet, and Nevin Kapur, Singularity analysis, Hadamard products, and tree
recurrences, Journal of Computational and Applied Mathematics 174 (2005), 271–313.
164. James Allen Fill, On the distribution of binary search trees under the random permutation model,
Random Structures & Algorithms 8 (1996), no. 1, 1–25.
165. Steven Finch, Mathematical constants, Cambridge University Press, New-York, 2003.
166. R. A. Finkel and J. L. Bentley, Quad trees, a data structure for retrieval on composite keys, Acta
Informatica 4 (1974), 1–9.
167. Hans Fischer, Die verschiedenen Formen und Funktionen des zentralen Grenzwertsatzes in der En-
twicklung von der klassischen zur modernen Wahrscheinlichkeitsrechnung, Shaker Verlag, Aachen,
2000, 318 p. (ISBN: 3-8265-7767-1).
168. Philippe Flajolet, Combinatorial aspects of continued fractions, Discrete Mathematics 32 (1980),
125–161, Reprinted in the 35th Special Anniversary Issue of Discrete Mathematics, Volume 306,
Issue 10–11, Pages 992-1021 (2006).

BIBLIOGRAPHY
731
169.
, Analyse d’algorithmes de manipulation d’arbres et de ﬁchiers, Cahiers du Bureau Univer-
sitaire de Recherche Op´erationnelle, vol. 34–35, Universit´e Pierre et Marie Curie, Paris, 1981, 209
pages.
170.
, On congruences and continued fractions for some classical combinatorial quantities, Dis-
crete Mathematics 41 (1982), 145–153.
171.
, On the performance evaluation of extendible hashing and trie searching, Acta Informatica
20 (1983), 345–369.
172.
, Approximate counting: A detailed analysis, BIT 25 (1985), 113–134.
173.
, Elements of a general theory of combinatorial structures, Fundamentals of Computation
Theory (Lothar Budach, ed.), Lecture Notes in Computer Science, vol. 199, Springer Verlag, 1985,
Proceedings of FCT’85, Cottbus, GDR, September 1985 (Invited Lecture), pp. 112–127.
174.
, Analytic models and ambiguity of context–free languages, Theoretical Computer Science 49
(1987), 283–309.
175.
, Mathematical methods in the analysis of algorithms and data structures, Trends in Theo-
retical Computer Science (Egon B¨orger, ed.), Computer Science Press, Rockville, Maryland, 1988,
(Lecture Notes for A Graduate Course in Computation Theory, Udine, 1984), pp. 225–304.
176.
, Singularity analysis and asymptotics of Bernoulli sums, Theoretical Computer Science 215
(1999), no. 1-2, 371–381.
177.
, Counting by coin tossings, Proceedings of ASIAN’04 (Ninth Asian Computing Science Con-
ference) (M. Maher, ed.), Lecture Notes in Computer Science, vol. 3321, 2004, (Text of Opening
Keynote Address.), pp. 1–12.
178. Philippe Flajolet, Philippe Dumas, and Vincent Puyhaubert, Some exactly solvable models of urn
process theory, Discrete Mathematics & Theoretical Computer Science (Proceedings) AG (2006),
59–118.
179. Philippe Flajolet, Jean Franc¸on, and Jean Vuillemin, Sequence of operations analysis for dynamic
data structures, Journal of Algorithms 1 (1980), 111–141.
180. Philippe Flajolet, Zhicheng Gao, Andrew Odlyzko, and Bruce Richmond, The distribution of heights
of binary trees and other simple trees, Combinatorics, Probability and Computing 2 (1993), 145–156.
181. Philippe Flajolet, Dani`ele Gardy, and Lo¨ys Thimonier, Birthday paradox, coupon collectors, caching
algorithms, and self–organizing search, Discrete Applied Mathematics 39 (1992), 207–229.
182. Philippe Flajolet, Stefan Gerhold, and Bruno Salvy, On the non-holonomic character of logarithms,
powers, and the nth prime function, Electronic Journal of Combinatorics 11(2) (2005), no. A1, 1–16.
183. Philippe Flajolet, Gaston Gonnet, Claude Puech, and J. M. Robson, Analytic variations on quadtrees,
Algorithmica 10 (1993), no. 7, 473–500.
184. Philippe Flajolet, Xavier Gourdon, and Philippe Dumas, Mellin transforms and asymptotics: Har-
monic sums, Theoretical Computer Science 144 (1995), no. 1–2, 3–58.
185. Philippe Flajolet, Xavier Gourdon, and Conrado Mart´ınez, Patterns in random binary search trees,
Random Structures & Algorithms 11 (1997), no. 3, 223–244.
186. Philippe Flajolet, Xavier Gourdon, and Daniel Panario, The complete analysis of a polynomial factor-
ization algorithm over ﬁnite ﬁelds, Journal of Algorithms 40 (2001), no. 1, 37–81.
187. Philippe Flajolet, Peter Grabner, Peter Kirschenhofer, and Helmut Prodinger, On Ramanujan’s Q–
function, Journal of Computational and Applied Mathematics 58 (1995), no. 1, 103–116.
188. Philippe Flajolet and Fabrice Guillemin, The formal theory of birth-and-death processes, lattice path
combinatorics, and continued fractions, Advances in Applied Probability 32 (2000), 750–778.
189. Philippe Flajolet, Yves Guivarc’h, Wojtek Szpankowski, and Brigitte Vall´ee, Hidden pattern statistics,
Automata, Languages, and Programming (F. Orejas, P. Spirakis, and J. van Leeuwen, eds.), Lecture
Notes in Computer Science, no. 2076, Springer Verlag, 2001, Proceedings of the 28th ICALP Con-
ference, Crete, July 2001., pp. 152–165.
190. Philippe Flajolet, Kostas Hatzis, Sotiris Nikoletseas, and Paul Spirakis, On the robustness of intercon-
nections in random graphs: A symbolic approach, Theoretical Computer Science 287 (2002), no. 2,
513–534.
191. Philippe Flajolet, Hsien-Kuei Hwang, and Mich`ele Soria, The ubiquitous Gaussian law in analytic
combinatorics, 1997, In preparation.
192. Philippe Flajolet, Peter Kirschenhofer, and Robert F. Tichy, Deviations from uniformity in random
strings, Probability Theory and Related Fields 80 (1988), 139–150.
193. Philippe Flajolet, Donald E. Knuth, and Boris Pittel, The ﬁrst cycles in an evolving graph, Discrete
Mathematics 75 (1989), 167–215.
194. Philippe Flajolet, Gilbert Labelle, Louise Laforest, and Bruno Salvy, Hypergeometrics and the cost
structure of quadtrees, Random Structures & Algorithms 7 (1995), no. 2, 117–144.

732
BIBLIOGRAPHY
195. Philippe Flajolet and Thomas Lafforgue, Search costs in quadtrees and singularity perturbation
asymptotics, Discrete and Computational Geometry 12 (1994), no. 4, 151–175.
196. Philippe Flajolet and Marc Noy, Analytic combinatorics of non-crossing conﬁgurations, Discrete
Mathematics 204 (1999), no. 1-3, 203–229, (Selected papers in honor of Henry W. Gould).
197. Philippe Flajolet and Andrew M. Odlyzko, The average height of binary trees and other simple trees,
Journal of Computer and System Sciences 25 (1982), 171–213.
198.
, Random mapping statistics, Advances in Cryptology (J-J. Quisquater and J. Vandewalle,
eds.), Lecture Notes in Computer Science, vol. 434, Springer Verlag, 1990, Proceedings of EURO-
CRYPT’89, Houtalen, Belgium, April 1989, pp. 329–354.
199.
, Singularity analysis of generating functions, SIAM Journal on Algebraic and Discrete Meth-
ods 3 (1990), no. 2, 216–240.
200. Philippe Flajolet, Patricio Poblete, and Alfredo Viola, On the analysis of linear probing hashing,
Algorithmica 22 (1998), no. 4, 490–515.
201. Philippe Flajolet and Helmut Prodinger, Level number sequences for trees, Discrete Mathematics 65
(1987), 149–156.
202.
, On Stirling numbers for complex argument and Hankel contours, SIAM Journal on Discrete
Mathematics 12 (1999), no. 2, 155–159.
203. Philippe Flajolet and Claude Puech, Partial match retrieval of multidimensional data, Journal of the
ACM 33 (1986), no. 2, 371–407.
204. Philippe Flajolet, Mireille R´egnier, and Robert Sedgewick, Some uses of the Mellin integral transform
in the analysis of algorithms, Combinatorial Algorithms on Words (A. Apostolico and Z. Galil, eds.),
NATO Advance Science Institute Series. Series F: Computer and Systems Sciences, vol. 12, Springer
Verlag, 1985, (Invited Lecture), pp. 241–254.
205. Philippe Flajolet, Bruno Salvy, and Gilles Schaeffer, Airy phenomena and analytic combinatorics of
connected graphs, Electronic Journal of Combinatorics 11 (2004), no. 2:#R34, 1–30.
206. Philippe Flajolet, Bruno Salvy, and Paul Zimmermann, Automatic average–case analysis of algo-
rithms, Theoretical Computer Science 79 (1991), no. 1, 37–109.
207. Philippe Flajolet and Robert Sedgewick, Mellin transforms and asymptotics: ﬁnite differences and
Rice’s integrals, Theoretical Computer Science 144 (1995), no. 1–2, 101–124.
208.
, The average case analysis of algorithms: Mellin transform asymptotics, Research Report
2956, Institut National de Recherche en Informatique et en Automatique, 1996, 93 pages.
209. Philippe Flajolet, Paolo Sipala, and Jean-Marc Steyaert, Analytic variations on the common subex-
pression problem, Automata, Languages, and Programming (M. S. Paterson, ed.), Lecture Notes in
Computer Science, vol. 443, 1990, Proceedings of the 17th ICALP Conference, Warwick, July 1990,
pp. 220–234.
210. Philippe Flajolet and Mich`ele Soria, Gaussian limiting distributions for the number of components in
combinatorial structures, Journal of Combinatorial Theory, Series A 53 (1990), 165–182.
211.
, The cycle construction, SIAM Journal on Discrete Mathematics 4 (1991), no. 1, 58–60.
212.
, General combinatorial schemas: Gaussian limit distributions and exponential tails, Discrete
Mathematics 114 (1993), 159–180.
213. Philippe Flajolet and Jean-Marc Steyaert, A complexity calculus for classes of recursive search pro-
grams over tree structures, Proceedings of the 22nd Annual Symposium on Foundations of Computer
Science, IEEE Computer Society Press, 1981, pp. 386–393.
214.
, A complexity calculus for recursive tree algorithms, Mathematical Systems Theory 19
(1987), 301–331.
215. Philippe Flajolet, Wojciech Szpankowski, and Brigitte Vall´ee, Hidden word statistics, Journal of the
ACM 53 (2006), no. 1, 147–183.
216. Philippe Flajolet, Paul Zimmerman, and Bernard Van Cutsem, A calculus for the random generation
of labelled combinatorial structures, Theoretical Computer Science 132 (1994), no. 1-2, 1–35.
217. Dominique Foata, La s´erie g´en´eratrice exponentielle dans les probl`emes d’´enum´eration, S.M.S, Mon-
treal University Press, 1974.
218. Dominique Foata, Bodo Lass, and Guo-Niu Han, Les nombres hyperharmoniques et la fratrie du
collectionneur de vignettes, Seminaire Lotharingien de Combinatoire 47 (2001), no. B47a, 1–20.
219. Dominique Foata and Marcel-P. Sch¨utzenberger, Th´eorie g´eom´etrique des polynˆomes Euleriens, Lec-
ture Notes in Mathematics, vol. 138, Springer Verlag, 1970.
220. W. B. Ford, Studies on divergent series and summability and the asymptotic developments of functions
deﬁned by Maclaurin series, 3rd ed., Chelsea Publishing Company, New York, 1960, (From two books
originally published in 1916 and 1936.).

BIBLIOGRAPHY
733
221. Jean Franc¸on and G´erard Viennot, Permutations selon leurs pics, creux, doubles mont´ees et doubles
descentes, nombres d’Euler et de Genocchi, Discrete Mathematics 28 (1979), 21–35.
222. G. Frobenius, ¨Uber Matrizen aus nicht negativen Elementen, Sitz.-Ber. Akad. Wiss., Phys-Math
Klasse, Berlin (1912), 456–477.
223. William Fulton, Algebraic curves, W.A. Benjamin, Inc., New York, Amsterdam, 1969.
224. Anna G´al and Peter Bro Miltersen, The cell probe complexity of succinct data structures, Automata,
Languages and Programming, Lecture Notes in Computer Science, vol. 2719, Springer Berlin–
Heidelberg, 2003, Proceedings of ICALP 2003, pp. 332–344.
225. F. R. Gantmacher, Matrizentheorie, Deutscher Verlag der Wissenschaften, Berlin, 1986, A translation
of the Russian original Teoria Matriz, Nauka, Moscow, 1966.
226. Zhicheng Gao and L. Bruce Richmond, Central and local limit theorems applied to asymptotic enu-
merations IV: Multivariate generating functions, Journal of Computational and Applied Mathematics
41 (1992), 177–186.
227. Dani`ele Gardy, M´ethode de col et lois limites en analyse combinatoire, Theoretical Computer Science
92 (1992), no. 2, 261–280.
228.
, Normal limiting distributions for projection and semijoin sizes, SIAM Journal on Discrete
Mathematics 5 (1992), no. 2, 219–248.
229.
, Some results on the asymptotic behaviour of coefﬁcients of large powers of functions, Dis-
crete Mathematics 139 (1995), no. 1-3, 189–217.
230. George Gasper and Mizan Rahman, Basic hypergeometric series, Encyclopedia of Mathematics and
its Applications, vol. 35, Cambridge University Press, 1990.
231. Ira M. Gessel, A factorization for formal Laurent series and lattice path enumeration, J. Combin.
Theory Ser. A 28 (1980), no. 3, 321–337.
232.
, A noncommutative generalization and q–analog of the Lagrange inversion formula, Trans-
actions of the American Mathematical Society 257 (1980), no. 2, 455–482.
233.
, Enumerative applications of symmetric functions, Actes du 17i`eme S´eminaire Lotharingien
de Combinatoire (Strasbourg) (Publications IRMA, ed.), 1988, pp. 5–21.
234.
, Symmetric functions and P –recursiveness, Journal of Combinatorial Theory, Series A 53
(1990), 257–285.
235. Omer Gim´enez and Marc Noy, The number of planar graphs and properties of random planar graphs,
Discrete Mathematics and Theoretical Computer Science Proceedings AD (2005), 147–156.
236. M. L. Glasser, A Watson sum for a cubic lattice, Journal of Mathematical Physics 13 (1972), 1145–
1146.
237. B. V. Gnedenko and A. N. Kolmogorov, Limit distributions for sums of independent random variables,
Addison-Wesley, 1968, Translated from the Russian original (1949).
238. C. D. Godsil, Algebraic combinatorics, Chapman and Hall, 1993.
239. Massimiliano Goldwurm and Massimo Santini, Clique polynomials have a unique root of smallest
modulus, Information Processing Letters 75 (2000), no. 3, 127–132.
240. V. Goncharov, On the ﬁeld of combinatory analysis, Soviet Math. Izv., Ser. Math. 8 (1944), 3–48, In
Russian.
241. Gaston H. Gonnet, Notes on the derivation of asymptotic expressions from summations, Information
Processing Letters 7 (1978), no. 4, 165–169.
242.
, Expected length of the longest probe sequence in hash code searching, Journal of the ACM
28 (1981), no. 2, 289–304.
243. I. J. Good, Random motion and analytic continued fractions, Proceedings of the Cambridge Philo-
sophical Society 54 (1958), 43–47.
244. Ian P. Goulden and David M. Jackson, Combinatorial enumeration, John Wiley, New York, 1983.
245.
, Distributions, continued fractions, and the Ehrenfest urn model, Journal of Combinatorial
Theory. Series A 41 (1986), no. 1, 21–31.
246. Xavier Gourdon, Largest component in random combinatorial structures, Discrete Mathematics 180
(1998), no. 1-3, 185–209.
247. Xavier Gourdon and Bruno Salvy, Asymptotics of linear recurrences with rational coefﬁcients, Tech.
Report 1887, INRIA, March 1993, To appear in Proceedings FPACS’93.
248. Ronald L. Graham, Donald E. Knuth, and Oren Patashnik, Concrete mathematics, Addison Wesley,
1989.
249. D. H. Greene and D. E. Knuth, Mathematics for the analysis of algorithms, Birkh¨auser, Boston, 1981.
250.
, Mathematics for the analysis of algorithms, second ed., Birkhauser, Boston, 1982.
251. Daniel Hill Greene, Labelled formal languages and their uses, Ph.D. thesis, Stanford University, June
1983, Available as Report STAN-CS-83-982.

734
BIBLIOGRAPHY
252. L. J. Guibas and A. M. Odlyzko, Long repetitive patterns in random sequences, Zeitschrift f¨ur
Wahrscheinlichkeitstheorie und Verwandte Gebiete 53 (1980), no. 3, 241–262.
253.
, String overlaps, pattern matching, and nontransitive games, Journal of Combinatorial The-
ory. Series A 30 (1981), no. 2, 183–208.
254. Leo J. Guibas and Andrew M. Odlyzko, Periods in strings, Journal of Combinatorial Theory, Series
A 30 (1981), 19–42.
255. Fabrice Guillemin, Philippe Robert, and Bert Zwart, AIMD algorithms and exponential functionals,
Annals of Applied Probability 14 (2004), no. 1, 90–117.
256. Laurent Habsieger, Maxime Kazarian, and Sergei Lando, On the second number of Plutarch, Ameri-
can Mathematical Monthly 105 (1998), 446–447.
257. Jennie C. Hansen, A functional central limit theorem for random mappings, Annals of Probability 17
(1989), no. 1, 317–332.
258. F. Harary, R. W. Robinson, and A. J. Schwenk, Twenty-step algorithm for determining the asymptotic
number of trees of various species, Journal of the Australian Mathematical Society (Series A) 20
(1975), 483–503.
259. Frank Harary and Edgar M. Palmer, Graphical enumeration, Academic Press, 1973.
260. G. H. Hardy, Ramanujan: Twelve lectures on subjects suggested by his life and work, third ed.,
Chelsea Publishing Company, New-York, 1978, Reprinted and Corrected from the First Edition, Cam-
bridge, 1940.
261. Bernard Harris and Lowell Schoenfeld, Asymptotic expansions for the coefﬁcients of analytic func-
tions, Illinois Journal of Mathematics 12 (1968), 264–277.
262. Theodore E. Harris, The theory of branching processes, Dover Publications, 1989, A reprint of the
1963 edition.
263. W. K. Hayman, A generalization of Stirling’s formula, Journal f¨ur die reine und angewandte Mathe-
matik 196 (1956), 67–95.
264. Erich Hecke, Vorlesungen ¨uber die Theorie der algebraischen Zahlen, Akademische Verlagsge-
sellschaft, Leipzig, 1923.
265. Peter Henrici, Applied and computational complex analysis, vol. 2, John Wiley, New York, 1974.
266.
, Applied and computational complex analysis, vol. 1, John Wiley, New York, 1974.
267. Dean Hickerson, Counting horizontally convex polyominoes, Journal of Integer Sequences 2 (1999),
Electronic.
268. E. Hille, Analytic function theory, vol. 1, Blaisdell Publishing Company, Waltham, 1959.
269.
, Analytic function theory, Blaisdell Publishing Company, Waltham, 1962, 2 Volumes.
270. Micha Hofri, Analysis of algorithms: Computational methods and mathematical tools, Oxford Uni-
versity Press, 1995.
271. J. A. Howell, T. F. Smith, and M. S. Waterman, Computation of generating functions for biological
molecules, SIAM Journal on Applied Mathematics 39 (1980), no. 1, 119–133.
272. Hsien-Kuei Hwang, Th´eor`emes limites pour les structures combinatoires et les fonctions arithme-
tiques, Ph.D. thesis, ´Ecole Polytechnique, December 1994.
273.
, Large deviations for combinatorial distributions. I. Central limit theorems, The Annals of
Applied Probability 6 (1996), no. 1, 297–319.
274.
, Large deviations of combinatorial distributions. II. Local limit theorems, The Annals of
Applied Probability 8 (1998), no. 1, 163–181.
275.
, On convergence rates in the central limit theorems for combinatorial structures, European
Journal of Combinatorics 19 (1998), no. 3, 329–343.
276.
, Asymptotics of Poisson approximation to random discrete distributions: an analytic ap-
proach, Advances in Applied Probability 31 (1999), no. 2, 448–491.
277. Mourad E. H. Ismail, Classical and quantum orthogonal polynomials in one variable, Encyclopedia
of Mathematics and its Applications, no. 98, Cambridge University Press, 2005.
278. Philippe Jacquet and Mireille R´egnier, Trie partitioning process: Limiting distributions, CAAP’86
(P. Franchi-Zanetacchi, ed.), Lecture Notes in Computer Science, vol. 214, 1986, Proceedings of the
11th Colloquium on Trees in Algebra and Programming, Nice France, March 1986., pp. 196–210.
279. Philippe Jacquet and Wojciech Szpankowski, Asymptotic behavior of the Lempel-Ziv parsing scheme
and digital search trees, Theoretical Computer Science 144 (1995), no. 1–2, 161–197.
280.
, Analytic approach to pattern matching., Applied Combinatorics on Words (M. Lothaire, ed.),
Encycl. of Mathematics and Its Applications, vol. 105, Cambridge University Press, 2004, Chapter 7,
pp. 353–429.
281. Svante Janson, Random cutting and records in deterministic and random trees, Technical Report,
2004, Random Structures & Algorithms, 42 pages, to appear.

BIBLIOGRAPHY
735
282. Svante Janson, Donald E. Knuth, Tomasz Łuczak, and Boris Pittel, The birth of the giant component,
Random Structures & Algorithms 4 (1993), no. 3, 233–358.
283. Svante Janson, Tomasz Łuczak, and Andrzej Rucinski, Random graphs, Wiley-Interscience, New
York, 2000.
284. Iwan Jensen, A parallel algorithm for the enumeration of self-avoiding polygons on the square lattice,
Journal of Physics A: Mathematical and General 36 (2003), 5731–5745.
285. William B. Jones and Arne Magnus, Application of Stieltjes fractions to birth-death processes, Pad´e
and rational approximation (New York) (E. B. Saff and Richard S. Varga, eds.), Academic Press Inc.,
1977, Proceedings of an International Symposium held at the University of South Florida, Tampa,
Fla., December 15-17, 1976, pp. 173–179.
286. Andr´e Joyal, Une th´eorie combinatoire des s´eries formelles, Advances in Mathematics 42 (1981),
no. 1, 1–82.
287. R. Jungen, Sur les s´eries de Taylor n’ayant que des singularit´es alg´ebrico-logarithmiques sur leur
cercle de convergence, Commentarii Mathematici Helvetici 3 (1931), 266–306.
288. Mark Kac, Random walk and the theory of Brownian motion, American Mathematical Monthly 54
(1947), 369–391.
289. Samuel Karlin and James McGregor, The classiﬁcation of birth and death processes, Transactions of
the American Mathematical Society 86 (1957), 366–400.
290. Samuel Karlin and Howard Taylor, A ﬁrst course in stochastic processes, second ed., Academic Press,
1975.
291. Rainer Kemp, Random multidimensional binary trees, Journal of Information Processing and Cyber-
netics (EIK) 29 (1993), 9–36.
292. Frances Kirwan, Complex algebraic curves, London Mathematical Society Student Texts, no. 23,
Cambridge University Press, 1992.
293. M. S. Klamkin and D. J. Newman, Extensions of the birthday surprise, Journal of Combinatorial
Theory 3 (1967), 279–282.
294. S. C. Kleene, Representation of events in nerve nets and ﬁnite automata, Automata studies, Princeton
University Press, Princeton, N. J., 1956, pp. 3–41.
295. A. Knopfmacher, A. M. Odlyzko, B. Pittel, L. B. Richmond, D. Stark, G. Szekeres, and N. C.
Wormald, The asymptotic number of set partitions with unequal block sizes, Electronic Journal of
Combinatorics 6 (1999), no. 1, R2:1–37.
296. Arnold Knopfmacher and Helmut Prodinger, On Carlitz compositions, European Journal of Combi-
natorics 19 (1998), no. 5, 579–589.
297. John Knopfmacher, Abstract analytic number theory, Dover, 1990.
298. John Knopfmacher and Arnold Knopfmacher, Counting irreducible factors of polynomials over a
ﬁnite ﬁeld, Discrete Mathematics 112 (1993), 103–118.
299. K. Knopp, Theory of functions, Dover Publications, New York, 1945.
300. Donald E. Knuth, The art of computer programming, vol. 1: Fundamental Algorithms, Addison-
Wesley, 1968.
301.
, Mathematical analysis of algorithms, Information Processing 71, North Holland Publishing
Company, 1972, Proceedings of IFIP Congress, Ljubljana, 1971, pp. 19–27.
302.
, The art of computer programming, vol. 3: Sorting and Searching, Addison-Wesley, 1973.
303.
, The average time for carry propagation, Indagationes Mathematicae 40 (1978), 238–242.
304.
, The art of computer programming, 2nd ed., vol. 2: Seminumerical Algorithms, Addison-
Wesley, 1981.
305.
, Bracket notation for the ‘coefﬁcient of’ operator, E-print arXiv:math/9402216, Febru-
ary 1994.
306.
, The art of computer programming, 3rd ed., vol. 1: Fundamental Algorithms, Addison-
Wesley, 1997.
307.
, The art of computer programming, 2nd ed., vol. 3: Sorting and Searching, Addison-Wesley,
1998.
308.
, The art of computer programming, 3rd ed., vol. 2: Seminumerical Algorithms, Addison-
Wesley, 1998.
309.
, Selected papers on analysis of algorithms, CSLI Publications, Stanford, CA, 2000.
310. Donald E. Knuth, James H. Morris, Jr., and Vaughan R. Pratt, Fast pattern matching in strings, SIAM
Journal on Computing 6 (1977), no. 2, 323–350.
311. Donald E. Knuth and Boris Pittel, A recurrence related to trees, Proceedings of the American Mathe-
matical Society 105 (1989), no. 2, 335–349.

736
BIBLIOGRAPHY
312. Donald E. Knuth and Arnold Sch¨onhage, The expected linearity of a simple equivalence algorithm,
Theoretical Computer Science 6 (1978), 281–315.
313. Donald E. Knuth and Ilan Vardi, Problem 6581 (the asymptotic expansion of 2n choose n), American
Mathematical Monthly 95 (1988), 774.
314. Valentin F. Kolchin, Random mappings, Optimization Software Inc., New York, 1986, Translated
from Sluˇcajnye Otobraˇzenija, Nauka, Moscow, 1984.
315.
, Random graphs, Encyclopedia of Mathematics and its Applications, vol. 53, Cambridge
University Press, Cambridge, U.K., 1999.
316. Valentin F. Kolchin, Boris A. Sevastyanov, and Vladimir P. Chistyakov, Random allocations, John
Wiley and Sons, New York, 1978, Translated from the Russian original Sluˇcajnye Razmeˇsˇceniya.
317. Jacob Korevaar, Tauberian theory, Grundlehren der Mathematischen Wissenschaften [Fundamental
Principles of Mathematical Sciences], vol. 329, Springer-Verlag, Berlin, 2004, A century of develop-
ments.
318. M. Krasnoselskii, Positive solutions of operator equations, P. Noordhoff, Groningen, 1964.
319. Christian Krattenthaler, Advanced determinant calculus, Seminaire Lotharingien de Combinatoire 42
(1999), Paper B42q, 66 pp.
320. Jacques Labelle and Yeong Nan Yeh, Generalized Dyck paths, Discrete Mathematics 82 (1990), 1–6.
321. J. C. Lagarias and A. M. Odlyzko, Solving low-density subset sum problems, JACM 32 (1985), no. 1,
229–246.
322. J. C. Lagarias, A. M. Odlyzko, and D. B. Zagier, On the capacity of disjointly shared networks,
Computer Networks 10 (1985), no. 5, 275–285.
323. Steven P. Lalley, Finite range random walk on free groups and homogeneous trees, The Annals of
Probability 21 (1993), no. 4, 2087–2130.
324.
, Return probabilities for random walk on a half-line, Journal of Theoretical Probability 8
(1995), no. 3, 571–599.
325.
, Algebraic systems of generating functions and return probabilities for random walks, Dy-
namics and randomness II, Nonlinear Phenom. Complex Systems, vol. 10, Kluwer Acad. Publ., Dor-
drecht, 2004, pp. 81–122.
326. S. K. Lando, Lectures on generating functions, Student Mathematical Library, vol. 23, American
Mathematical Society, Providence, RI, 2003, Translated from the 2002 Russian original by the author.
327. Serge Lang, Linear algebra, Addison-Wesley, Reading, Mass., 1966.
328. Pierre-Simon Laplace, Th´eorie analytique des probabilit´es. Vol. I, II, ´Editions Jacques Gabay, Paris,
1995, Reprint of the 1819 and 1820 editions.
329. Gregory F. Lawler, Intersections of random walks, Birkh¨auser Boston Inc., Boston, MA, 1991.
330. L´eonce Lesieur and Jean-Louis Nicolas, On the Eulerian numbers Mn = max An,k, European Jour-
nal of Combinatorics 13 (1992), 379–399.
331. L. Lewin (ed.), Structural properties of polylogarithms, American Mathematical Society, 1991.
332. V. Lifschitz and B. Pittel, The number of increasing subsequences of the random permutation, Journal
of Combinatorial Theory, Series A 31 (1981), 1–20.
333. Ernst Lindel¨of, Le calcul des r´esidus et ses applications `a la th´eorie des fonctions, Collection de
monographies sur la th´eorie des fonctions, publi´ee sous la direction de M. ´Emile Borel, Gauthier-
Villars, Paris, 1905, Reprinted by Gabay, Paris, 1989.
334. L. Lipshitz, The diagonal of a D-ﬁnite power series is D-ﬁnite, J. Algebra 113 (1988), 373–378.
335.
, D-ﬁnite power series, J. Algebra 122 (1989), 353–373.
336. B. F. Logan and L. A. Shepp, A variational problem for random Young tableaux, Advances in Math-
ematics 26 (1977), 206–222.
337. M. Lothaire, Combinatorics on words, Encyclopedia of Mathematics and its Applications, vol. 17,
Addison–Wesley, 1983.
338.
, Applied combinatorics on words, Encyclopedia of Mathematics and its Applications, Cam-
bridge University Press, Cambridge, 2005, (A collective work edited by Jean Berstel and Dominique
Perrin).
339. Guy Louchard, The Brownian excursion: a numerical analysis, Computers and Mathematics with
Applications 10 (1984), no. 6, 413–417.
340.
, Kac’s formula, L´evy’s local time and Brownian excursion, Journal of Applied Probability 21
(1984), 479–499.
341.
, Random walks, Gaussian processes and list structures, Theoretical Computer Science 53
(1987), no. 1, 99–124.
342.
, Probabilistic analysis of some (un)directed animals, Theoretical Computer Science 159
(1996), no. 1, 65–79.

BIBLIOGRAPHY
737
343.
, Probabilistic analysis of column-convex and directed diagonally-convex animals, Random
Structures & Algorithms 11 (1997), no. 2, 151–178.
344. Guy Louchard and Helmut Prodinger, Probabilistic analysis of Carlitz compositions, Discrete Math-
ematics & Theoretical Computer Science 5 (2002), no. 1, 71–96.
345. Guy Louchard, R. Schott, M. Tolley, and P. Zimmermann, Random walks, heat equations and dis-
tributed algorithms, Journal of Computational and Applied Mathematics 53 (1994), 243–274.
346. E. Lucas, Th´eorie des Nombres, Gauthier-Villard, Paris, 1891, Reprinted by A. Blanchard, Paris 1961.
347. V. Y. Lum, P. S. T. Yuen, and M. Dodd, Key to address transformations: A fundamental study based
on large existing format ﬁles, Communications of the ACM 14 (1971), 228–239.
348. James F. Lynch, Probabilities of ﬁrst-order sentences about unary functions, Transactions of the
American Mathematical Society 287 (1985), no. 2, 543–568.
349. David J. C. MacKay, Information theory, inference and learning algorithms, Cambridge University
Press, New York, 2003.
350. P. A. MacMahon, Introduction to combinatory analysis, Chelsea Publishing Co., New York, 1955, A
reprint of the ﬁrst edition, Cambridge, 1920.
351. Hosam M. Mahmoud, Evolution of random search trees, John Wiley, New York, 1992.
352. Conrado Mart´ınez and Xavier Molinero, A generic approach for the unranking of labeled combina-
torial classes, Random Structures & Algorithms 19 (2001), no. 3-4, 472–497, Analysis of algorithms
(Krynica Morska, 2000).
353. J. E. Mazo and A. M. Odlyzko, Lattice points in high-dimensional spheres, Monatshefte f¨ur Mathe-
matik 110 (1990), no. 1, 47–61.
354. B. D. McKay, D. Bar-Natan, M. Bar-Hillel, and G. Kalai, Solving the bible code puzzle, Statistical
Science 14 (1999), 150–173.
355. G¨unter Meinardus, Asymptotische Aussagen ¨uber Partitionen, Mathematische Zeitschrift 59 (1954),
388–398.
356. A. Meir and J. W. Moon, On the altitude of nodes in random trees, Canadian Journal of Mathematics
30 (1978), 997–1015.
357.
, On random mapping patterns, Combinatorica 4 (1984), no. 1, 61–70.
358.
, Recursive trees with no nodes of out-degree one, Congressus Numerantium 66 (1988), 49–
62.
359.
, Erratum: “On an asymptotic method in enumeration”, J. Combin. Theory Ser. A 52 (1989),
no. 1, 163.
360.
, On an asymptotic method in enumeration, Journal of Combinatorial Theory, Series A 51
(1989), no. 1, 77–89.
361.
, The asymptotic behaviour of coefﬁcients of powers of certain generating functions, European
Journal of Combinatorics 11 (1990), 581–587.
362. John Milnor, Dynamics in one complex variable, Friedr. Vieweg & Sohn, Braunschweig, 1999.
363. Marni Mishna, Automatic enumeration of regular objects, Preprint available on ArXiv, 2005,
ArXiv:CO/0507249.
364. J. W. Moon, Counting labelled trees, Canadian Mathematical Monographs N.1, William Clowes and
Sons, 1970.
365. Macdonald Morris, Gabriel Schachtel, and Samuel Karlin, Exact formulas for multitype run statistics
in a random ordering, SIAM Journal on Discrete Mathematics 6 (1993), no. 1, 70–86.
366. Leo Moser and Max Wyman, An asymptotic formula for the Bell numbers, Transactions of the Royal
Society of Canada XLIX (1955).
367.
, On the solution of xd = 1 in symmetric groups, Canadian Journal of Mathematics 7 (1955),
159–168.
368.
, Asymptotic expansions, Canadian Journal of Mathematics 8 (1956), 225–233.
369.
, Asymptotic expansions II, Canadian Journal of Mathematics (1957), 194–209.
370. Rajeev Motwani and Prabhakar Raghavan, Randomized algorithms, Cambridge University Press,
1995.
371. G. Myerson and A. J. van der Poorten, Some problems concerning recurrence sequences, The Ameri-
can Mathematical Monthly 102 (1995), no. 8, 698–705.
372. Donald J. Newman and Lawrence Shepp, The double dixie cup problem, American Mathematical
Monthly 67 (1960), 58–61.
373. Albert Nijenhuis and Herbert S. Wilf, Combinatorial algorithms, second ed., Academic Press, 1978.
374. Niels Erik N¨orlund, Vorlesungen ¨uber Differenzenrechnung, Chelsea Publishing Company, New York,
1954.

738
BIBLIOGRAPHY
375. A. M. Odlyzko, Periodic oscillations of coefﬁcients of power series that satisfy functional equations,
Advances in Mathematics 44 (1982), 180–205.
376.
, Explicit Tauberian estimates for functions with positive coefﬁcients, Journal of Computa-
tional and Applied Mathematics 41 (1992), 187–197.
377.
, Asymptotic enumeration methods, Handbook of Combinatorics (R. Graham, M. Gr¨otschel,
and L. Lov´asz, eds.), vol. II, Elsevier, Amsterdam, 1995, pp. 1063–1229.
378. A. M. Odlyzko and L. B. Richmond, Asymptotic expansions for the coefﬁcients of analytic generating
functions, Aequationes Mathematicae 28 (1985), 50–63.
379. A. M. Odlyzko and H. S. Wilf, Bandwidths and proﬁles of trees, Journal of Combinatorial Theory,
Series B 42 (1987), 348–370.
380.
, The editor’s corner: n coins in a fountain, American Matematical Monthly 95 (1988), 840–
843.
381. F. W. J. Olver, Asymptotics and special functions, Academic Press, 1974.
382. Richard Otter, The number of trees, Annals of Mathematics 49 (1948), no. 3, 583–599.
383. Daniel Panario, Boris Pittel, Bruce Richmond, and Alfredo Viola, Analysis of Rabin’s irreducibility
test for polynomials over ﬁnite ﬁelds, Random Structures Algorithms 19 (2001), no. 3-4, 525–551,
Analysis of algorithms (Krynica Morska, 2000).
384. Daniel Panario and Bruce Richmond, Analysis of Ben-Or’s polynomial irreducibility test, Proceedings
of the Eighth International Conference “Random Structures and Algorithms” (Poznan, 1997), vol. 13,
1998, pp. 439–456.
385.
, Exact largest and smallest size of components, Algorithmica 31 (2001), no. 3, 413–432.
386. R. B. Paris and D. Kaminski, Asymptotics and Mellin-Barnes integrals, Encyclopedia of Mathematics
and its Applications, vol. 85, Cambridge University Press, Cambridge, 2001.
387. H.-O. Peitgen and P. H. Richter, The beauty of fractals, Springer-Verlag, Berlin, 1986, Images of
complex dynamical systems.
388. Robin Pemantle, Generating functions with high-order poles are nearly polynomial, Mathematics and
computer science (Versailles, 2000), Birkh¨auser, Basel, 2000, pp. 305–321.
389. Robin Pemantle and Mark C. Wilson, Asymptotics of multivariate sequences. I. Smooth points of the
singular variety, Journal of Combinatorial Theory. Series A 97 (2002), no. 1, 129–161.
390.
, Asymptotics of multivariate sequences, Part II: Multiple points of the singular variety, Com-
binatorics, Probability and Computing 13 (2004), no. 4–5, 735–761.
391. J. K. Percus, Combinatorial Methods, Applied Mathematical Sciences, vol. 4, Springer-Verlag, 1971.
392. Oskar Perron, ¨Uber Matrizen, Mathematische Annalen 64 (1907), 248–263.
393. Marko Petkovˇsek, Herbert S. Wilf, and Doron Zeilberger, A = B, A. K. Peters Ltd., Wellesley, MA,
1996.
394. Valentin V. Petrov, Limit theorems of probability theory, Oxford Studies in Probability, vol. 4, The
Clarendon Press Oxford University Press, New York, 1995, Sequences of independent random vari-
ables, Oxford Science Publications.
395. G. P´olya, Kombinatorische Anzahlbestimmungen f¨ur Gruppen, Graphen und chemische Verbindun-
gen, Acta Mathematica 68 (1937), 145–254.
396.
, On the number of certain lattice polygons, Journal of Combinatorial Theory, Series A 6
(1969), 102–105.
397. G. P´olya and R. C. Read, Combinatorial enumeration of groups, graphs and chemical compounds,
Springer Verlag, New York, 1987.
398. George P´olya, Robert E. Tarjan, and Donald R. Woods, Notes on introductory combinatorics, Progress
in Computer Science, Birkh¨auser, 1983.
399. A. G. Postnikov, Tauberian theory and its applications, Proceedings of the Steklov Institute of Math-
ematics, vol. 144, American Mathematical Society, 1980.
400. Nicolas Pouyanne, On the number of permutations admitting an mth root, Electronic Journal of Com-
binatorics 9 (2002), no. 1:R3, 1–12.
401. Thomas Prellberg, Uniform q-series asymptotics for staircase polygons, Journal of Physics A: Math.
Gen. 28 (1995), 1289–1304.
402. H. A. Priestley, Introduction to complex analysis, Oxford University Press, Oxford, 1985.
403. Helmut Prodinger, Approximate counting via Euler transform, Mathematica Slovaka 44 (1994), 569–
574.
404.
, A note on the distribution of the three types of nodes in uniform binary trees, S´eminaire
Lotharingien de Combinatoire 38 (1996), Paper B38b, 5 pages.

BIBLIOGRAPHY
739
405. Andrzej Proskurowski, Frank Ruskey, and Malcolm Smith, Analysis of algorithms for listing equiv-
alence classes of k-ary strings, SIAM Journal on Discrete Mathematics 11 (1998), no. 1, 94–109
(electronic).
406. E. M. Rains and N. J. A. Sloane, On Cayley’s enumeration of alkanes (or 4-valent trees), Journal of
Integer Sequences 2 (1999), Article 99.1.1; avilable electronically.
407. G. N. Raney, Functional composition patterns and power series reversion, Transactions of the Amer-
ican Mathematical Society 94 (1960), 441–451.
408. Mireille R´egnier, Analysis of grid ﬁle algorithms, BIT 25 (1985), 335–357.
409. A. R´enyi and G. Szekeres, On the height of trees, Australian Journal of Mathematics 7 (1967), 497–
507.
410. P. R´ev´esz, Strong theorems on coin tossing, Proceedings of the International Congress of Mathemati-
cians (Helsinki, 1978) (Helsinki), Acad. Sci. Fennica, 1980, pp. 749–754.
411. Christoph Richard, Scaling behaviour of two-dimensional polygon models, Journal of Statistical
Physics 108 (2002), no. 3/4, 459–493.
412. Igor Rivin, Growth in free groups (and other stories), ArXiv, 1999, arXv:math.CO/9911076v2, 31
pages.
413. Philippe Robert, R´eseaux et ﬁles d’attente: m´ethodes probabilistes, Math´ematiques & Applications,
vol. 35, Springer, Paris, 2000.
414. Gian-Carlo Rota, Finite operator calculus, Academic Press, 1975.
415. K. F. Roth and G. Szekeres, Some asymptotic formulae in the theory of partitions, Quart. J. Math.,
Oxford Ser. (2) 5 (1954), 241–259.
416. Salvador Roura and Conrado Mart´ınez, Randomization of search trees by subtree size, Algorithms—
ESA’96 (Josep Diaz and Maria Serna, eds.), Lecture Notes in Computer Science, no. 1136, 1996,
Proceedings of the Fourth European Symposium on Algorithms, Barcelona, September 1996., pp. 91–
106.
417. Lee A. Rubel, Some research problems about algebraic differential equations, Transactions of the
American Mathematical Society 280 (1983), no. 1, 43–52.
418.
, Some research problems about algebraic differential equations II, Illinois Journal of Mathe-
matics 36 (1992), no. 4, 659–680.
419. Walter Rudin, Real and complex analysis, third ed., McGraw-Hill Book Co., New York, 1987.
420. Vladimir N. Sachkov, Combinatorial methods in discrete mathematics, Encyclopedia of Mathematics
and its Applications, vol. 55, Cambridge University Press, 1996.
421.
, Probabilistic methods in combinatorial analysis, Cambridge University Press, Cambridge,
1997, Translated and adapted from the Russian original edition, Nauka, Moscow, 1978.
422. V.N. Sachkov, Verojatnostnye metody v kombinatornom analize, Nauka, Moscow, 1978.
423. Arto Salomaa and Matti Soittola, Automata-theoretic aspects of formal power series, Springer, Berlin,
1978.
424. Bruno Salvy, Asymptotique automatique et fonctions g´en´eratrices, Ph. D. thesis, ´Ecole Polytechnique,
1991.
425.
, Asymptotics of the Stirling numbers of the second kind, Studies in Automatic Combinatorics
II (1997), Published electronically.
426. Bruno Salvy and John Shackell, Symbolic asymptotics: Multiseries of inverse functions, Journal of
Symbolic Computation 27 (1999), no. 6, 543–563.
427. Bruno Salvy and Paul Zimmermann, GFUN: a Maple package for the manipulation of generating and
holonomic functions in one variable, ACM Transactions on Mathematical Software 20 (1994), no. 2,
163–167.
428. Hanan Samet, The design and analysis of spatial data structures, Addison–Wesley, 1990.
429. Gilles Schaeffer, Conjugaison d’arbres et cartes combinatoires al´eatoires, Ph.d. thesis, Universit´e de
Bordeaux I, December 1998.
430. William R. Schmitt and Michael S. Waterman, Linear trees and RNA secondary structure, Discrete
Applied Mathematics. Combinatorial Algorithms, Optimization and Computer Science 51 (1994),
no. 3, 317–323.
431. Erwin Schr¨odinger, Statistical thermodynamics, A course of seminar lectures delivered in January-
March 1944, at the School of Theoretical Physics, Dublin Institute for Advanced Studies. Second
edition, reprinted, Cambridge University Press, New York, 1962.
432. Robert Sedgewick, Quicksort with equal keys, SIAM Journal on Computing 6 (1977), no. 2, 240–267.
433.
, Algorithms, second ed., Addison–Wesley, Reading, Mass., 1988.
434. Robert Sedgewick and Philippe Flajolet, An introduction to the analysis of algorithms, Addison-
Wesley Publishing Company, 1996.

740
BIBLIOGRAPHY
435. Richard Sharp, Local limit theorems for free groups, Mathematische Annalen 321 (2001), 889–904.
436. L. A. Shepp and S. P. Lloyd, Ordered cycle lengths in a random permutation, Transactions of the
American Mathematical Society 121 (1966), 340–357.
437. Igor E. Shparlinski, Finite ﬁelds: theory and computation, Mathematics and its Applications, vol.
477, Kluwer Academic Publishers, Dordrecht, 1999, The meeting point of number theory, computer
science, coding theory and cryptography.
438. Lucy Joan Slater, Generalized hypergeometric functions, Cambridge University Press, 1966.
439. N. J. A. Sloane, The On-Line Encyclopedia of Integer Sequences, 2006, Published electronically at
www.research.att.com/˜njas/sequences/.
440. N. J. A. Sloane and Simon Plouffe, The encyclopedia of integer sequences, Academic Press, 1995.
441. Neil J. A. Sloane and Thomas Wider, The number of hierarchical orderings, Order ?? (2003), ??–??,
In print.
442. M. Soittola, Positive rational sequences, Theoretical Computer Science 2 (1976), 317–322.
443. Mich`ele Soria-Cousineau, M´ethodes d’analyse pour les constructions combinatoires et les algo-
rithmes, Doctorat `es sciences, Universit´e de Paris–Sud, Orsay, July 1990.
444. George Springer, Introduction to Riemann surfaces, Addison-Wesley Publishing Company, Inc.,
Reading, Mass., 1957, Reprinted by Chelsea, New York.
445. Richard P. Stanley, Generating functions, Studies in Combinatorics, M.A.A. Studies in Mathematics,
Vol. 17. (G-C. Rota, ed.), The Mathematical Association of America, 1978, pp. 100–141.
446.
, Differentiably ﬁnite power series, European Journal of Combinatorics 1 (1980), 175–188.
447.
, Enumerative combinatorics, vol. I, Wadsworth & Brooks/Cole, 1986.
448.
, Hipparchus, Plutarch, Schr¨oder and Hough, American Mathematical Monthly 104 (1997),
344–350.
449.
, Enumerative combinatorics, vol. II, Cambridge University Press, 1999.
450. H. M. Stark and A. A. Terras, Zeta functions of ﬁnite graphs and coverings, Advances in Mathematics
121 (1996), no. 1, 124–165.
451. J. Michael Steele, Probability theory and combinatorial optimization, Society for Industrial and Ap-
plied Mathematics (SIAM), Philadelphia, PA, 1997.
452. Andr´e Stef and G´erald Tenenbaum, Inversion de Laplace effective, Ann. Probab. 29 (2001), no. 1,
558–575.
453. P. R. Stein and M. S. Waterman, On some new sequences generalizing the Catalan and Motzkin
numbers, Discrete Mathematics 26 (1979), no. 3, 261–272.
454. V. E. Stepanov, On the distribution of the number of vertices in strata of a random tree, Theory of
Probability and Applications 14 (1969), no. 1, 65–78.
455. Jean-Marc Steyaert, Structure et complexit´e des algorithmes, Doctorat d’´etat, Universit´e Paris VII,
April 1984.
456. Jean-Marc Steyaert and Philippe Flajolet, Patterns and pattern-matching in trees: an analysis, Infor-
mation and Control 58 (1983), no. 1–3, 19–58.
457. Gabor Szeg˝o, Orthogonal polynomials, American Mathematical Society Colloquium Publications,
vol. XXIII, A.M.S, Providence, 1989.
458. Wojciech Szpankowski, Average-case analysis of algorithms on sequences, John Wiley, New York,
2001.
459. Lajos Tak´acs, A Bernoulli excursion and its various applications, Advances in Applied Probability 23
(1991), 557–585.
460.
, Conditional limit theorems for branching processes, Journal of Applied Mathematics and
Stochastic Analysis 4 (1991), no. 4, 263–292.
461.
, On a probability problem connected with railway trafﬁc, Journal of Applied Mathematics
and Stochastic Analysis 4 (1991), no. 1, 1–27.
462.
, The asymptotic distribution of the total heights of random rooted trees, Acta Scientiﬁca
Mathematica (Szeged) 57 (1993), 613–625.
463. Nobuki Takayama, An approach to the zero recognition problem by Buchberger algorithm, Journal of
Symbolic Computation 14 (1992), no. 2-3, 265–282.
464. Martin C. Tangora, Level number sequences of trees and the lambda algebra, European Journal of
Combinatorics 12 (1991), 433–443.
465. H. N. V. Temperley, On the enumeration of the Mayer cluster integrals, Proc. Phys. Soc. Sect. B. 72
(1959), 1141–1144.
466.
, Graph theory and applications, Ellis Horwood Ltd., Chichester, 1981.
467. G´erald Tenenbaum, La m´ethode du col en th´eorie analytique des nombres, S´eminaire de Th´eorie des
Nombres, Paris 1985–1986 (C. Goldstein, ed.), Birkhauser, 1988, pp. 411–441.

BIBLIOGRAPHY
741
468.
, Introduction to analytic and probabilistic number theory, Cambridge University Press, Cam-
bridge, 1995, Translated from the second French edition (1995) by C. B. Thomas.
469. E. C. Titchmarsh, The theory of functions, second ed., Oxford University Press, 1939.
470. E. C. Titchmarsh and D. R. Heath-Brown, The theory of the Riemann zeta-function, second ed., Oxford
Science Publications, 1986.
471. W. T. Tutte, A census of planar maps, Canadian Journal of Mathematics 15 (1963), 249–271.
472.
, On the enumeration of planar maps, Bull. Amer. Math. Soc. 74 (1968), 64–74.
473.
, On the enumeration of four-colored maps, SIAM Journal on Applied Mathematics 17 (1969),
454–460.
474.
, Planar enumeration, Graph theory and combinatorics (Cambridge, 1983), Academic Press,
London, 1984, pp. 315–319.
475. Bernard Van Cutsem, Combinatorial structures and structures for classiﬁcation, Computational Sta-
tistics & Data Analysis 23 (1996), no. 1, 169–188.
476. Bernard Van Cutsem and Bernard Ycart, Indexed dendrograms on random dissimilarities, Journal of
Classiﬁcation 15 (1998), no. 1, 93–127.
477. Joris van der Hoeven, Majorants for formal power series, Preprint, 2003, 29 pages. Available from
author’s webpage.
478. Alfred van der Poorten, A proof that Euler missed . . . Ap´ery’s proof of the irrationality of ζ(3),
Mathematical Intelligencer 1 (1979), 195–203.
479. B. L. Van der Waerden, On the method of saddle points, Applied Scientiﬁc Research 2 (1951), 33–45.
480. B. L. van der Waerden, Algebra. Vol. I, Springer-Verlag, New York, 1991, Based in part on lectures
by E. Artin and E. Noether, Translated from the seventh German edition by Fred Blum and John R.
Schulenberger. MR MR1080172 (91h:00009a)
481. J. van Leeuwen (ed.), Handbook of theoretical computer science, vol. A: Algorithms and Complexity,
North Holland, 1990.
482. E. J. Janse van Rensburg, The statistical mechanics of interacting walks, polygons, animals and vesi-
cles, Oxford University Press, Oxford, 2000.
483. Robert Vein and Paul Dale, Determinants and their applications in mathematical physics, Applied
Mathematical Sciences, vol. 134, Springer-Verlag, 1998.
484. A. M. Vershik, Statistical mechanics of combinatorial partitions, and their limit conﬁgurations, Funk-
tsional’ny˘ı Analiz i ego Prilozheniya 30 (1996), no. 2, 19–39.
485. A. M. Vershik and S. V. Kerov, Asymptotics of the Plancherel measure of the symmetric group and the
limiting form of Young tables, Soviet Mathematical Doklady 18 (1977), 527–531.
486. Jeffrey Scott Vitter and Philippe Flajolet, Analysis of algorithms and data structures, Handbook of
Theoretical Computer Science (J. van Leeuwen, ed.), vol. A: Algorithms and Complexity, North Hol-
land, 1990, pp. 431–524.
487. Joachim von zur Gathen and J¨urgen Gerhard, Modern computer algebra, Cambridge University Press,
New York, 1999.
488. J. Vuillemin, A unifying look at data structures, Communications of the ACM 23 (1980), no. 4, 229–
239.
489. H. S. Wall, Analytic theory of continued fractions, Chelsea Publishing Company, 1948.
490. W. Wasow, Asymptotic expansions for ordinary differential equations, Dover, 1987, A reprint of the
John Wiley edition, 1965.
491. Michael S. Waterman, Introduction to computational biology, Chapman & Hall, 1995.
492. E. T. Whittaker and G. N. Watson, A course of modern analysis, fourth ed., Cambridge University
Press, 1927, Reprinted 1973.
493. David Vernon Widder, The Laplace transform, Princeton University Press, 1941.
494. Herbert S. Wilf, Some examples of combinatorial averaging, American Mathematical Monthly 92
(1985), 250–261.
495.
, Combinatorial algorithms: An update, CBMS–NSF Regional Conference Series, no. 55,
Society for Industrial and Applied Mathematics, Philadelphia, 1989.
496.
, Generatingfunctionology, Academic Press, 1990.
497. David Williams, Probability with martingales, Cambridge Mathematical Textbooks, Cambridge Uni-
versity Press, Cambridge, 1991.
498. Jet Wimp and Doron Zeilberger, Resurrecting the asymptotics of linear recurrences, Journal of Math-
ematical Analysis and Applications 111 (1985), 162–176.
499. Peter Winkler, Seven puzzles you think you must not have heard correctly, Preprint, 2006, paper
presented at the Seventh Gathering for Gardner (in honour of Martin Gardner).

742
BIBLIOGRAPHY
500. Wolfgang Woess, Random walks on inﬁnite graphs and groups, Cambridge Tracts in Mathematics,
vol. 138, Cambridge University Press, Cambridge, 2000.
501. R. Wong and M. Wyman, The method of Darboux, J. Approximation Theory 10 (1974), 159–171.
502. Roderick Wong, Asymptotic approximations of integrals, Academic Press, 1989.
503. Alan R. Woods, Coloring rules for ﬁnite trees, and probabilities of monadic second order sentences,
Random Structures Algorithms 10 (1997), no. 4, 453–485.
504. E. Maitland Wright, Asymptotic partition formulae: I plane partitions, Quarterly Journal of Mathe-
matics, Oxford Series II (1931), 177–189.
505.
, The coefﬁcients of a certain power series, Journal of the London Mathematical Society 7
(1932), 256–262.
506.
, The coefﬁcients of a certain power series, Journal of the London Mathematical Society 7
(1932), 304–309.
507.
, The number of connected sparsely edged graphs, Journal of Graph Theory 1 (1977), 317–
330.
508.
, The number of connected sparsely edged graphs. II. Smooth graphs, Journal of Graph Theory
2 (1978), 299–305.
509.
, The number of connected sparsely edged graphs. III. Asymptotic results, Journal of Graph
Theory 4 (1980), 393–407.
510. Robert Alan Wright, Bruce Richmond, Andrew Odlyzko, and Brendan McKay, Constant time gener-
ation of free trees, SIAM Journal on Computing 15 (1985), no. 2, 540–548.
511. Max Wyman, The asymptotic behavior of the Laurent coefﬁcients, Canadian Journal of Mathematics
11 (1959), 534–555.
512. Yifan Yang, Partitions into primes, Transactions of the American Mathematical Society 352 (2000),
no. 6, 2581–2600.
513. Doron Zeilberger, A holonomic approach to special functions identities, Journal of Computational and
Applied Mathematics 32 (1990), 321–368.
514.
,
Symbol-crunching
with
the
transfer-matrix
method
in
order
to
count
skinny
physical
creatures,
Integers
0
(2000),
Paper
A9,
Published
electronically
at
http://www.integers-ejcnt.org/vol0.html.
515. Paul Zimmermann, S´eries g´en´eratrices et analyse automatique d’algorithmes, Ph. d. thesis, ´Ecole
Polytechnique, 1991.
516. V. M. Zolotarev, One-dimensional stable distributions, American Mathematical Society, Providence,
RI, 1986, Translated from the Russian by H. H. McFaden, Translation edited by Ben Silver.

Index
R (resultant notation), 685
[zn] (coefﬁcient extractor), 19
.= (numeric approximation), 1
E (expectation), 104, 672, 718
ℑ(imaginary part), 217
Ω(asymptotic notation), 668
P (probability), 104, 145
ℜ(real part), 217
Θ (asymptotic notation), 668
V (variance), 672
≈(asymptotic notation), 670
⊲⊳(exponential order), 230
O (asymptotic notation), 668
◦(substitution), 79
∼
= (combinatorial isomorphism), 18
m (analytic mean), 601
v (analytic variance), 601
⟨·⟩(strip of C), 708
⌈·⌋(nearest integer function), 41
⌈· ⌋(rounding notation), 246
H
(contour integral), 514
∂(derivative), 80
σ (standard deviation), 673
∼(asymptotic notation), 668
⋆(labelled product), 92
lg (binary logarithm), 286
o (asymptotic notation), 668
Rconv (radius of convergence), 218
Res (residue operator), 221
+, see disjoint union
[[·]] (Iverson’s notation), 54
CYC (cycle construction), 24, 95
MSET (multiset construction), 25
PSET (powerset construction), 25
SEQ (sequence construction), 24, 94
SET (set construction), 94
Θ (pointing), 79
Abel identity, 678
Abel–Plana summation, 226
adjacency matrix (of graph), 321
admissibility (of function), 528–540
admissible construction, 21, 91
Airy area distribution, 349
Airy function, 540, 563, 654, 661
alcohol, 270, 456
algebraic curve, 471
algebraic function, 492, 505
asymptotic, 492
branch, 471
coefﬁcient, 477–492
elimination, 685–687
Newton polygon, 474–476
Puiseux expansion, 474–476
singularities, 471–492
algebraic topology, 189
algorithm
approximate counting, 291–292
balanced tree, 84, 267
binary adder, 285
binary search tree, 192, 410–412
digital tree (trie), 340
hashing, 103, 167, 558
irreducible polynomials, 432
polynomial factorization, 432
shake and paint, 398
TCP protocol, 292
alignment, 110–316
alkanes, 456–458
allocation, see balls-in-bins model, 103–110
alphabet, 47
ambiguity
context-free grammar, 76
regular expression, 293, 679
analytic continuation, 226
analytic function, 218–226
equivalent deﬁnitions, 687–689
composition, 393–399
differentiation, 400–404
Hadamard product, 404–409
integration, 400–404
inversion, 236, 261–266, 385–390
iteration, 267–269
Lindel¨of integrals, 225
aperiodic, 461
aperiodic (GF), 314
approximate counting, 291–292
area (of Dyck path), 307
argument principle, 256
arithmetical functions, 667
arithmetical semigroups, 83
arrangement, 104, 105
asymptotic
743

744
INDEX
algebraic, 492
expansion, 669
notations, 668–671
scale, 669–670
atom, 23, 90
autocorrelation (in words), 56, 257
automaton
ﬁnite, 52
average, see expectation
balanced tree, see tree
ballot numbers, 63
ballot problem, 72
balls-in-bins model, 104, 165–167
capacity, 556–558
Poisson law, 166
Bell numbers, 101
asymptotics, 525–527, 707
Bell polynomials, 177
Bernoulli numbers, 254
Bernoulli trial, 179, 285, 720
Beta function (B), 693
BGF, see bivariate generating function
bijective equivalence (∼
=), 18
binary decision tree (BDT), 74
binary search tree, 410–412
binary search tree (BST), 192
binary tree, 682
binomial coefﬁcient, 92
asymptotics, 364–368
central approximation, 706–707
sum of powers, 706–707
binomial convolution, 92
binomial distribution, 720
birth and death process, 296
birth process, 290
birthday paradox, 105–110, 180, 181, 397
bivariate generating function (BGF), 145
Boltzmann model, 266, 531
boolean function, 73
bootstrapping, 286
bordering condition (permutation), 191
Borges, Jorge Luis, 58
boxed product, 129–132
branch (of curve), 471
branch point (analytic function), 263
branch point (function), 218
branching processes, 185–186
bridge (lattice path), 73, 482–488
Brownian motion, 174, 344, 395, 443, 653
B¨urmann inversion, see Lagrange inversion
canonicalization, 80
cartesian product construction (×), 22
Catalan numbers (Cn), 17, 33–34, 36, 63, 68–
74, 683
asymptotics, 367
generating function, 33
Catalan sum., 399
Catalan tree, 33, 162
Cauchy’s residue theorem, 222
Cauchy–Riemann equations, 688
Cayley tree, 117–119, 168
Cayley tree function, see Tree function (T)
central limit law, 573
centring (random variable), 719
Chebyshev inequalities, 150, 674
Chebyshev polynomial, 304
circuit (in graph), 321, 329
circular graph, 91
class (labelled), 87–138
class (of combinatorial structures), 16
cloud, 627
cluster, 198, 200
coalescence of saddle point
with other saddle point, 563
with roots, 552
with singularity, 552–553
code (words), 58
coding theory, 37, 50, 58, 233
coefﬁcient extractor ([zn]), 19
coin fountain, 308, 615
combination, 48
combinatorial
class, 16, 88
isomorphism (∼
=), 18
parameter, 139–208
sums, 396–399
combinatorial chemistry, 452–458
combinatorial identities, 693–698
combinatorial probability, 671–674
combinatorial schema, see schema
complete generating function, 174–187
complex differentiability, 219
complex dynamics, 267
complexity theory, 73
composition (of integer), 37–46
Carlitz type, 190, 195, 249
complete GF, 176
cyclic (wheel), 45
largest summand, 158, 317, 320
local constraints, 187–189, 249
number of summands, 42, 156–157
prime summands, 41, 317–319
proﬁle, 158, 316
r-parts, 157
restricted summands, 317–319
composition (singular), 393–399
computable numbers, 237
computer algebra, see symbolic manipulation
concentration (of probability distribution), 150–
151
conformal map, 219
conjugacy principle (paths), 71
connection problem, 480, 481, 496, 499
constructible class, 237–242
construction
cartesian product (×), 22
cycle (CYC), 24, 154, 674–676

INDEX
745
labelled, 95, 163
disjoint union (+), 24
implicit, 81–84
labelled product (⋆), 92–94
multiset (MSET), 25, 154
pointing(Θ), 79–81, 187
powerset (PSET), 25, 154
labelled, 163
sequence (SEQ), 24, 154
labelled, 94, 163
set (SET)
labelled, 94
substitution (◦), 79–81, 187–190
context-free
asymptotics, 423, 460–462
language, 76–77, 460
speciﬁcation, 74–77, 460–464
continuant polynomial, 298
continuation (analytic), 226
continued fraction, 184, 205, 270, 295–313
continuous random variable, 717
contour integral (H ), 514
convergence in probability, 150
convexity (of GFs), 266
convexity inequalities, 516
correlation, see atocorealtion1
coupon collector problem, 105–110, 180
cover time (walk), 347
covering (of interval), 25
cumulant generating function, 720
cumulated value (of parameter), 147
cumulative generating function, 147
cycle construction (CYC), 24, 154, 674–676
labelled, 95, 163
undirected, labelled, 123
cycle lemma (paths), 71
cyclic permutation, 91
Daffodil Lemma, 253
Darboux’s method, 417
data compression, 261
data mining, 399
de Bruijn graph, 337–339
Dedekind η function, 544
degree (of tree node), 682
density (random variable), 717
denumerant, 41, 244–245
dependency graph, 325
derangement, 113, 196, 248, 352, 430
derivative (∂), 80
devil’s staircase, 336–337
dice games, 549
Dickman function, 591
differential equations, 492–503, 693–698
differential ﬁeld, 496
differentiation (singular), 400–404
digital tree (trie), 340
digraph, see graph, 321
dilogarithm, 392
directed graph, 321
Dirichlet generating function (DGF), 667
disc of convergence (series), 218
discrete random variable, 717
discriminant (of a polynomial), 471
discriminant (of polynomial), 687
disjoint union construction (+), 24, 91
distribution, see probability distribution
distribution function (random variable), 717
divergent series, 82, 128, 676
dominant singularity, 230
double exponential distribution, 286
Drmota-Lalley-Woods Theorem, 464
drunkard problem, 82, 406–409
Dyck path, 73, 486
area, 307
height, 303–307
dynamical source, 295
EGF, see exponential generating function
Ehrenfest urn model, 109, 313
eigenvalue, see matrix
EIS (Sloane’s Encyclopedia), 17
elimination (algebraic function), 685–687
elliptic function, 307
entire function, 230
entropy, 549
Euler numbers, 134
Euler’s constant (γ), 108, 691
Euler–Maclaurin summation, 226, 711
Eulerian numbers, 198, 612
Eulerian tour (in graph), 338
exceedances (in permutations), 352
excursion (lattice path), 73, 296, 482–488
exp-log transformation, 27, 79
expectation (or mean, average), E, 104, 146,
672, 718
exponential families (of functions), 186
exponential generating function
deﬁnition, 89
product, 92
exponential growth formula, 230–236
exponential order (⊲⊳), 230
exponential polynomial, 242, 276–278
Fa`a di Bruno’s formula, 177
factorial moment, 673
factorial moments, 147
factorial, falling, 494, 696
Ferrers diagram, 38
Fibonacci numbers, 40, 55
Fibonacci polynomial, 304
ﬁnite automaton, 52, 323–340
ﬁnite ﬁeld, 83
ﬁnite language, 61
ﬁnite state model, 334, 342–351
forest (of trees), 62, 119, 681
formal language, see language
formal power series, see power series
formal topology (power series), 676
four-colour theorem, 489

746
INDEX
Fourier transform, 718
fractals, 269
fragmented permutation, 115
asymptotics, 234, 527–528
free group, 194–195
free tree, see tree, unrooted
function (of complex variable)
analytic, 218–226
differentiable, 219
entire, 219, 230
holomorphic, 219
meromorphic, 220
functional equation, 261–272
kernel method, 483
quadratic method, 490
functional graph, 119–122, 458–459
Fundamental Theorem of Algebra, 256, 512
Galton-Watson process, 185
gambler ruin sequence, 72
Gamma function (Γ), 362, 689–693
Gaussian binomial, 43
Gaussian distribution, 555–556, 721
Gaussian integral, 690
general tree, 683
generating function
algebraic, 492
complete, 174–187
exponential, 87–138
multivariate, 139–208
ordinary, 15–86
geometric distribution, 720
Gessel’s calculus, 697–698
GF, see generating function
golden ratio (ϕ), 40, 84
graph
acyclic, 122
adjacency matrix, 321
aperiodic, 325
bipartite, 128
circuit, 321, 329
circular, 91
colouring, 489
connected, 127–129
de Bruijn, 337–339
directed, 321
enumeration, 96–97
excess, 123
functional, 119–122, 458–459
labelled, 88–89, 96–97, 122–125
map, 488–492
non-crossing, 462–464, 478–479
path, 320–340
periodic, 1, 325
random, 124–125
regular, 124, 177, 363, 430, 698
spanning tree, 323
strongly connected, 325
unlabelled, 96–97
Green’s formula, 688
Groebner basis, 76, 685
group
free, 194–195
symmetric, 128–129
Hadamard product, 280, 404–409, 694
Hamlet, 51
Hankel contour, 365, 690
Hardy–Ramanujan–Rademacher
expansion,
545
harmonic function, 688
harmonic number (Hn), 108, 149, 371, 669
asymptotics, 711
generating function, 149
harmonic sum, 708
Hartogs’ Theorem, 713
hashing algorithm, 103, 167, 558
Hayman admissibility, 528–540
Heaviside function, 708
height (of tree), 304–307
Hermite polynomial, 312
hidden pattern, 292–295
hierarchy, 119, 266, 451–452
Hipparchus, 64
histograms, 146
holomorphic function, 219
holonomic functions, 426, 471, 492, 693–698
homotopy (of paths), 221
horse kicks, 584
hypergeometric function
basic, 292
hypergeometric function (2F1), 404, 500, 696
implicit construction, 81–84, 127–129, 192–195
Implicit Function Theorem, 698–700
inclusion-exclusion, 195–202, 352
increasing tree, 132–136, 191–192, 500–502
Indoeuropean languages, 451
inheritance (of parameters), 151, 163
integer composition, see composition (of inte-
ger)
integer partition, see partition (of integer)
integration (singular), 400–404
interconnection network, 310
inversion (analytic), 236, 385–390
inversion table (permutation), 135
involution, 310
involution (permutation), 113
involution (permutation), 524–525
irregular singularity (ODE), 493
isomorphism (combinatorial, ∼
=), 18
iteration, 267
iteration (of analytic function), 267–269
iterative speciﬁcation, 30–32, 237–242
Iverson’s notation ([[·]]), 54
Jacobi trace formula, 323
kernel method (functional equation), 483
Knuth–Ramanujan function, see Ramanujan’s
Q-function

INDEX
747
labelled class, object, 87–138, 163–170
labelled construction, 92–98
labelled product (⋆), 92
Lagrange inversion, 62–66, 118, 677–678
Lambert W –function, 118
language, 678
context-free, 76–77, 460
formal, 47
regular, 356, 678–680
Laplace transform, 696
Laplace’s method, 559, 700–707
for sums, 706–707
Laplacian, 688
of graph, 323
large deviations, 549
large powers, 547–556
largest components, 320
Latin rectangle, 698
lattice path, 72–73, 295–313, 482–488
decompositions, 297
lattice points, 46
Laurent series, 482
law of large numbers, 147, 673
law of small numbers, 584
leaf (of tree), 170, 682
Lebesgue integral, 716
Lebesgue measure, 716
letter (of alphabet), 47
light bulb, 609
limit law, 569–663
Lindel¨of integrals, 225
linear fractional transformation, 300
Liouville’s theorem, 225
local limit law, 555, 573
localization (of zeros and poles), 256
logarithm, binary (lg), 286
logarithmic-series distribution, 316
logic (ﬁrst-order), 445
logics, 445
longest run (in word), 285–289
loop (in complex region), 221
Łukasiewicz codes, 71, 486–487
Lyndon words, 675
MacMahon’s Master Theorem, 323
magic duality, 225
majorant series, 236–237
map, 488–492, 659–661
mapping, 119–122, 431, 443–445, 658
idempotent, 535
regressive, 135
mapping pattern, see functional graph
mark (in combinatorial speciﬁcation), 156
marking variable, 19, 152
Markov chain, 53, 323, 617
Markov-Chebyshev inequalities, 150, 674
Master Theorem (of MacMahon), 323
matrix
aperiodic, 325
irreducible, 325
nonnegative, 326
Perron Frobenius theory, 325–326, 329
positive, 326
spectrum, 276
stochastic, 323, 335
trace, 323
transfer, 342–351
tridiagonal, 351
matrix tree theorem, 323
Maximum Modulus Principle, 511
mean, see expectation
meander (lattice path), 73, 482–488, 594–595
meander (topology), 500
measure theory, 715–717
Meinardus’ method (integer partitions), 545–
546
Mellin transform, 288, 306, 707–712
m´enage problem, 351
meromorphic function, 220
MGF, see multivariate generating function
mobile (tree), 436
M¨obius function (µ), 667
M¨obius inversion, 81, 431, 668
modular form, 544
moment inequalities, 150–151, 674
moment method, 295
moments (of random variable), 146, 672, 718
monkey saddle, 510, 558–564
monodromy, 474
Motzkin numbers, 63, 73, 81
asymptotics, 379, 478
Motzkin path, 73, 303, 307, 486
multinomial coefﬁcient, 92, 175
multiset construction (MSET), see construction,
multiset, 154
multiset construction (mset), 25
Multiset construction., 25
multivariate generating function (MGF), 139–
208
naming convention, 19, 90
Narayana numbers, 171
natural boundary, 236
nearest integer function (⌈·⌋), 41
necklace, 18, 60
negative binomial distribution, 433, 721
network, 310
neutral object, 23, 90
Newton polygon, 474–476
Newton’s binomial expansion, 33
nicotine, 20
non-crossing conﬁguration, 462–464, 478–479
nonplane tree, 66–68, 117
N¨orlund-Rice integrals, 226
normal distribution, see Gaussian distribution
numeric approximation ( .=), 1
numerology, 295
O (asymptotic notation), 668
o (asymptotic notation), 668

748
INDEX
ODE (ordinary differential equation), see differ-
ential equations
OGF, see ordinary generating function
order constraints (in constructions), 129–136,
190–192
ordinary generating function (OGF), 18
ordinary point (analytic function), 509
orthogonal polynomials, 300, 309
oscillations (of coefﬁcients), 251, 269, 368
outdegree, see degree (of tree node)
pairing (permutation), 113
parameter (combinatorial), 139–208
cumulated value, 147
inherited, 151–154
recursive, 170–174
parenthesis system, 73
parse tree, 76
partially commutative monoid, 285
partition
of sets, see set partition
partition (of integer), 37–46
asymptotics, 235
denumerant, 41, 244–245
distinct summands, 546
Durfee square, 43
Ferrers diagram, 38
Hardy–Ramanujan–Rademacher
expansion,
545
largest summand, 42
Meinardus’ method, 545–546
number of parts, 547
number of summands, 42, 160
plane, 546
prime summands, 546–547
proﬁle, 160
r-parts, 161
partition of set, see set partition
path (in graph), 321
path (in complex region), 221
path length, see tree
patterns
in permutations, 200
in trees, 202
in words, 50–52, 55–58, 200, 257–261, 292–
295, 612–613, 617
pentagonal numbers, 46
period (of sequence, GF), 252
periodicity (of coefﬁcients), 250
periodicity (of GF), 314
permutation, 90, 110–114
alternating, 132–134, 255
ascending runs, 197–200, 611–612
bordering condition, 191
cycles, 110–114, 143, 164–165, 430, 600–
601
cycles of length m, 583
cyclic, 91
derangement, 113, 196, 248, 352, 430
exceedances, 352
ﬁxed order, 533
increasing subsequences, 538–540
indecomposable, 82, 129
inversion table, 135
involution, 113, 235, 310, 524–525, 538
local order types, 191
longest cycle, 113, 533
longest increasing subsequence, 200, 538–
540, 698
m´enage, 351
pairing, 113
pattern, 200
proﬁle, 164
record, 130–131
records, 600–601
rises, 197–200
shortest cycle, 113, 248
singletons, 579–580
tree decomposition, 132–134
Perron Frobenius theory, 325–326, 329
perturbation theory, 553
PGF, see probability generating function
phase transition, 650
phase transition diagram, 650
phylogenetic trees, 119
Picard approximants, 699
Plana’s summation, 226
plane partition (of integer), 546
plane tree, 61–66
pointing construction (Θ), 79–81, 126–127, 187
Poisson distribution, 721
Poisson law, 165, 432
Poisson-Dirichlet process, 591
P´olya operators, 32
P´olya operators, 239, 429
P´olya–Carlson Theorem, 240
polydisc, 712
polylogarithm, 225, 390–393, 695
polynomial
primitive, 342
polynomial (ﬁnite ﬁeld), 83, 431–432
polynomial system, 465, 470
polyomino, 43, 189, 190, 308, 348–351, 613–
615
power series, 15, 18, 89, 141, 152, 176, 676–677
convergence, 676
divergent, 82, 128, 676
formal topology, 676
product, 676
quasi-inverse, 676
sum, 676
powerset construction (PSET), 25, 154
labelled, 163
powerset construction (SET), see construction,
powerset
preferential arrangement numbers, 100
prime number, 215–216
principal determination (function), 217
Pringsheim’s theorem, 227

INDEX
749
prisoners, 114, 165
probabilistic method, 674
probability (P), 104, 145
probability distribution
Airy area, 349
Bernoulli, 720
binomial, 720
double exponential, 109, 286–289
Gaussian, 555–556, 721
geometric, 720
geometric–birth, 291
logarithmic series, 316
negative binomial, 433, 721
Poisson, 432, 721
Rayleigh, 107, 655
stable laws, 395
theta function, 305, 344
Tracy–Widom, 540
Zipf laws, 657
probability generating function, 673
probability space, 715
proﬁle (of objects), 158, 432–434
pruned binary tree, 683
psi function (ψ), 692
Puiseux expansion (algebraic function), 474–
476
q–calculus, 292, 308
q–calculus, 46
quadratic method (functional equation), 490
quadtree, 497–500
quasi-inverse, 32
R (resultant notation), 685
radioactive decay, 584
radius of convergence (series), 218, 231
Ramanujan’s Q-function, 106, 120, 397–399
random generation, 73, 320
random matrix, 539
random variable, 672, 715–723
continuous, 717
density, 717
discrete, 717
random variable (discrete), 145
random walk, see walk
rational function, 224, 242–245, 256–257
positive, 340, 341
Rayleigh distribution, 655
record
in permutation, 130–131
in word, 178
recurrence
tree, 409–414
recursion (semantics of), 31
recursive parameter, 170–174
recursive speciﬁcation, 30–32
region (of complex plane), 217
regular
expression, 356, 678–680
language, 278–285, 356, 678–680
speciﬁcation, 278–285
regular point (analytic function), 227
regular singularity (ODE), 493–500
relabelling, 92
renewal process, 320, 609
Res (residue operator), 221
residue, 221–226
Cauchy’s theorem, 222
resultant (R), 76, 685–687
Rice integrals, see N¨orlund-Rice integrals
Riemann surface, 227
Rogers-Ramanujan identities, 308
rotation correspondence (tree), 69
Rouch´e’s theorem, 256
round (children’s), 379
rounding notation (⌈· ⌋), 246
RV, see random variable
SA-class (singularity analysis), 383
saddle point
analytic function, 510–512
bounds, 233, 512–516, 548
large powers, 547–556
method, 507–565
multiple, 558–564
scaling (random variable), 719
schema (combinatorial-analytic), 159–160, 167,
169–170
exp–log, 427–434
supercritical sequence, 313–320
Schr¨oder’s problems, 64, 119, 453
self-avoiding conﬁgurations, 347–349
semantics of recursion, 31
sequence construction (SEQ), 24, 154
labelled, 94, 163
series
algebraic, 492
series-parallel network, 64, 65, 68
set construction (SET), see construction, set
labelled, 94
set partition, 59–60, 98–110, 167
asymptotics, 235, 525–527
block, 100
largest block, 533
number of blocks, 167, 536–537
several complex variables, 712–713
shufﬂe product, 283
sieve formula, see inclusion-exclusion
Simon Newcomb’s problem, 181–182
simple variety (of trees), 182, 307, 434
singular expansion (function), 376
singularity
regular (ODE), 493–500
singularity (of function), 226–230
dominant, 230
singularity analysis, 359–420
applications, 421–506
size (of combinatorial object), 16, 88
size-biased (probability), 442
Skolem-Mahler-Lerch Theorem, 252

750
INDEX
slow variation, 416
Smirnov word, 193, 249, 289, 333
society (combinatorial class), 535
spacings, 48
span (of sequence, GF), 252
spanning tree, 323
special functions, 693–698
species, 29, 86, 127, 137
speciﬁcation, 31
iterative, 30–32
recursive, 30–32
spectrum, see matrix
stable laws, see probability distribution
standard deviation, (σ), 673
standardization (random variable), 572, 719
statistical physics, 44, 189, 346–347, 422, 500,
650
steepest descent, 509, 513
Stieltjes integral, 716–717
Stirling numbers, 680–681
cycle (1st kind), 111, 144, 600
partition (2nd kind), 59–60, 100, 168
Stirling’s approximation, 36, 389, 393, 520–
522, 692–693, 705–706, 711
strip (⟨·⟩), 708
subcrititical composition schema, 585–590
subexponential factor, 231
subsequence statistics,
see hidden patterns,
words
substitution construction (◦), 79–81, 187–190
supercritical cycle, 399
supercritical sequence, 313–320, 394
supernecklaces, 115
supertree, 394–396, 479, 661
support (of probability measure), 715
support (of sequence, GF), 252
surjection, 98–110, 316
asymptotics, 246
complete GF, 176
surjection numbers, 101, 254
symbolic manipulation, 240
symbolic methods, 15
symmetric functions, 177, 697–698
Tauberian theory, 416
Taylor expansion, 190, 688
theory of species, 127
theta function, 305–307, 344
threshold phenomenon, 199
tiling, 344–347, 617
total variation distance (probability), 579
totient function (ϕ), 26, 667
trace monoid, see partially commutative monoid
trains, 240–242, 380
transfer matrix, 342–351
transfer theorem, 372–375
tree, 30, 61–68, 116–125, 681
additive functional, 438–443
balanced, 83, 267–269
binary, 63, 682
branching processes, 185–186
Catalan, 33
Cayley, 117–119
degree proﬁle, 182–183, 441–442
exponential bounds, 264–266
forests, 62
general, 30, 683
height, 205, 304–307, 440
increasing, 132–136, 191, 500–502
leaf, 170, 619, 682
level proﬁle, 183–184, 439–440
Łukasiewicz codes, 71
mobile, 436
non-crossing, 462–464, 478–479
nonplane, 66–68, 443, 453
nonplane, labelled, 117
parse tree, 76
path length, 172–174, 184, 442–443
pattern, 202
plane, 61–66, 682
plane, labelled, 117
quadtree, 497–500
regular, 63
root subtrees, 589
root-degree, 162, 168, 437–438, 587–588
rooted, 681
search, 192
simple variety, 182, 307, 387–390, 434–445,
552
supertree, 394–396, 479
t-ary, 63
unary-binary, 63, 81
unrooted, 459–460
width, 342–344, 659
tree concepts, 681–683
Tree function (T), 386–389
tree recurrence, 409–414
triangulation (of polygon), 19, 33–34, 75
tridiagonal matrix, 351
trinomial numbers, 551
truncated exponential, 102
unambiguous, see ambiguity
uniform expansions
singularity analysis, 618–619
uniform probability measure, 672
uniformity (asymptotic expansions), 671
uniformization (algebraic function), 473
universality, 563
unlabelled structures, 151–163
urn, 91
urn model, 109, 313, 503
Vall´ee’s identity, 29
valley (saddle point), 510
variance (V), 672
Vitali’s theorem (analytic functions), 580
w.h.p. (with high probability), 125, 150
walk, 351

INDEX
751
birth type, 289–292
cover time, 347
devil’s staircase, 336–337
ﬁrst return, 82
in graphs, 320–340
integer line, 296–301
interval, 296–307
lattice path, 72–73, 295–313, 482–488
self-avoiding, 347–349
Wallis integral, 693, 703
Weierstrass Preparation Theorem (WPT), 699–
700
wheel, 45
width (of tree), 342–344
winding number, 256
word, 47–61, 103–110
aperiodic, 675
code, 58
excluded patterns, 339
language, 47, 678
local constraints, 333
longest run, 285–289
pattern, 50–52, 55–58, 200, 257–261, 292–
295, 612–613, 617
record, 178
runs, 48–50, 193
Smirnov, 193, 249, 289, 333
Young tableau, 698
zeta function of graphs, 330
zeta function, Riemann (ζ), 215, 255, 390, 692,
697

